Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

*   The vulnerability stems from the "custom script" functionality within ManageEngine ADSelfService Plus, where administrators could configure scripts to execute after password resets.
*   The application passed user-provided passwords as arguments to these custom scripts without proper sanitization.

**Weaknesses/Vulnerabilities Present:**

*   **Unsanitized Input:** The primary vulnerability lies in the lack of input sanitization of the password field. This allows an attacker to inject arbitrary commands into the password field, which are then executed by the system when the password reset script is triggered.
*   **Arbitrary Command Execution:** The ability to execute arbitrary OS commands via the custom script functionality.
*  **Default Credentials:** The default admin password "admin" was often not changed, providing a direct attack vector

**Impact of Exploitation:**

*   **Remote Command Execution (RCE):** An authenticated user, potentially even an end-user triggering a password reset, can execute arbitrary commands on the machine hosting the ADSelfService Plus server.
*   **System Compromise:** Attackers can use the vulnerability to gain persistence on the underlying system and pivot further into the environment.
*   **Credential Theft:** The vulnerability could be used to exfiltrate user passwords through the custom script functionality.

**Attack Vectors:**

*   **Authenticated User:** Attackers need a valid user account on the ADSelfService Plus system. This can be an administrator account (often with default credentials) or a standard user who can trigger a password reset.
*   **Password Reset Trigger:** The attack is initiated through a password reset or a password change by an authenticated user.
*   **Custom Script Configuration:**  The vulnerable "custom script" functionality must be enabled by an administrator and configured to use the password as a script argument.

**Required Attacker Capabilities/Position:**

*   **Access to ADSelfService Plus:** The attacker requires network access to the ADSelfService Plus web interface.
*   **Valid Credentials:** The attacker needs valid credentials for a user within the ADSelfService Plus environment. This could be the default "admin" account or any account that can trigger a password reset.
*   **Knowledge of Vulnerability:** The attacker needs to know that the custom script functionality is configured to pass the password as an argument and is not properly sanitized.

**Additional Details:**

*   The vulnerability is identified as CVE-2022-28810.
*   The vulnerability was fixed in ADSelfService Plus build 6122.
*   The vulnerability was actively exploited in the wild, as observed by Rapid7 MDR.
*   The fix involves limiting custom script types to VBScript and PowerShell, storing scripts in a specific directory, encoding the passwords, and using string literals instead of arguments.
*   The provided content includes a Metasploit module for exploiting this vulnerability.