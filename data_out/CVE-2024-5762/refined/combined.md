=== Content from www.zerodayinitiative.com_e1dd72bd_20250111_023139.html ===

[![thezdi](/images/logo.svg)](/)

Menu

* [PRIVACY](https://www.trendmicro.com/privacy)
* [WHO WE ARE](/about/)
* [HOW IT WORKS](/about/benefits/)
* [BLOG](/blog/)
* [ADVISORIES](/advisories/)
* [LOG IN](/portal/)
  [SIGN UP](/portal/register/)

Menu

* [PRIVACY](https://www.trendmicro.com/privacy/)
* [WHO WE ARE](/about/)
* [HOW IT WORKS](/about/benefits/)
* [BLOG](/blog/)
* [ADVISORIES](/advisories/)
* [LOG IN](/portal/)
* [SIGN UP](/portal/register/)

* [![thezdi](/images/logo.svg)](/)
* [Trend Micro](https://www.trendmicro.com/)

# Advisory Details

June 26th, 2024
## Zen Cart findPluginAdminPage Local File Inclusion Remote Code Execution Vulnerability

### ZDI-24-883ZDI-CAN-21408

| CVE ID | [CVE-2024-5762](https://www.cve.org/CVERecord?id=CVE-2024-5762) |
| --- | --- |
| CVSS SCORE | 8.1, [AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H](http://nvd.nist.gov/cvss.cfm?calculator&version=3.0&vector=AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H) |
| AFFECTED VENDORS | [Zen Cart](https://www.zen-cart.com/) |
| AFFECTED PRODUCTS | [Zen Cart](https://www.zen-cart.com/) |
| VULNERABILITY DETAILS | This vulnerability allows remote attackers to execute arbitrary code on affected installations of Zen Cart. Authentication is not required to exploit this vulnerability.  The specific flaw exists within the findPluginAdminPage function. The issue results from the lack of proper validation of user-supplied data prior to passing it to a PHP include function. An attacker can leverage this in conjunction with other vulnerabilities to execute arbitrary code in the context of the service account. |
| ADDITIONAL DETAILS | Zen Cart has issued an update to correct this vulnerability. More details can be found at: |
| DISCLOSURE TIMELINE | * 2023-08-28 - Vulnerability reported to vendor * 2024-06-26 - Coordinated public release of advisory * 2024-08-15 - Advisory Updated |
| CREDIT | Anonymous |

[BACK TO ADVISORIES](/advisories/)

### General Inquiries

zdi@trendmicro.com

### Find us on X

[@thezdi](https://twitter.com/thezdi)

### Find us on Mastodon

[Mastodon](https://infosec.exchange/%40thezdi)

### Media Inquiries

media\_relations@trendmicro.com

### Sensitive Email Communications

[PGP Key](https://www.zerodayinitiative.com/documents/zdi-pgp-key.asc)

[WHO WE ARE](/about/)

* [Our Mission](/about/)
* [Trend Micro](https://www.trendmicro.com)
* [TippingPoint IPS](https://www.trendmicro.com/en_us/business/products/network/integrated-atp/next-gen-intrusion-prevention-system.html)

[HOW IT WORKS](/about/benefits/)

* [Process](/about/benefits/#process)
* [Researcher Rewards](/about/benefits/#researcher-rewards)
* [FAQS](/about/faq/)
* [Privacy](https://www.trendmicro.com/privacy/)

[ADVISORIES](/advisories)

* [Published Advisories](/advisories/published)
* [Upcoming Advisories](/advisories/upcoming)
* [RSS Feeds](/rss)

[BLOG](/blog)

[![thezdi](/images/logo-footer.svg)](/)



=== Content from docs.zen-cart.com_4a3f1ff2_20250111_023137.html ===

[![Zen Cart®](https://www.zen-cart.com/images/styles/zencart/style/zen-cart-logo.png "Zen Cart®")](/release/)

[Release Documentation](/release/)

# Welcome to Zen Cart™

*Dear Zen Cart User*,

Zen Cart is made available to you for your use, addition, changes, modification, etc. without charge, under Version 2 of the GNU General Public License.

While we do not charge for this software, we greatly appreciate donations to help cover the expenses of maintenance, upgrades, updates, the free support forum and the continued development of this software for your online E-Commerce store. Please consider making a donation each time you install a new version.

Donations can be made on the [Zen Cart Team Page](https://www.zen-cart.com/donate)

We appreciate your support.

*The Zen Cart Team*

# About PHP versions

Zen Cart v2.0.x is designed for PHP 8.0 to 8.3, with MySQL 5.7.8+ (or MariaDB 10.2.7+) and Apache 2.2/2.4.

# Upgrade Instructions

See the online docs for upgrading advice, including Release-Specific considerations to note regarding this version. <https://docs.zen-cart.com/user/upgrading/>

This document only mentions the actual changes specific to v2.0.x since v1.5.8a.

## All Versions

If you are upgrading from the prior release, please do a [standard site upgrade](https://docs.zen-cart.com/user/upgrading/detailed_upgrading/).

If you are upgrading from a release which is older than the prior release, you may wish to consider starting again using a [database only upgrade](https://docs.zen-cart.com/user/upgrading/db_only_upgrade/).

Many older templates are going to be difficult to bring forward. If you are using an older template - especially one that is not [responsive](https://docs.zen-cart.com/user/template/responsive/) - you may wish to consider migrating to [Responsive Classic](https://docs.zen-cart.com/user/template/responsive_classic/) or [Bootstrap](https://docs.zen-cart.com/user/template/bootstrap/).

Be sure to review all the links in this article, including tips on staging the upgrade in a separate directory/folder.

If you are using Addons/Plugins that use modified versions of core Zen Cart files, you must compare those plugin files to the original Zen Cart files of the version for which those plugins were built, to identify the modifications. Subsequently you must replicate those modifications in the release version of the file. Be sure to check the plugin's support thread to see if a new version has been released since the one you installed before.

Always review the [Release Specific Upgrade Considerations](https://docs.zen-cart.com/user/upgrading/release_specific_upgrade_considerations/) for the release you are upgrading to all the way back to the release you are upgrading from.

# CHANGELOG - List of Changed Files

For a list of files that have been changed since v1.5.8a, see the [changed\_files-v2.0.0.html](/release/changed_files-v2-0-0) document.

# Upgrading to a Responsive Template

If your site doesn't look good on a mobile phone or a tablet, it's likely because it's using an older non-responsive template. You can read about [Responsive Templates](https://docs.zen-cart.com/user/template/responsive/) on the help site to learn more.

If you are upgrading an older site, we recommend that you use a responsive template (rather than template\_default or any older non-responsive template) as the starting point for your upgraded site. Both the [Responsive Classic](https://docs.zen-cart.com/user/template/responsive_classic/) and [Bootstrap](https://docs.zen-cart.com/user/template/bootstrap/) templates are good candidates.

# Upgrader Notes About Changes to template\_default

Upgraders should make sure they update *\*BOTH\** template\_default *\*AND\** their custom templates as described here

In Zen Cart the *template\_default* directory contains the master copy of all storefront page templates.

The normal procedure for customizing template files for use in your own personalized template is to make a copy of the corresponding file from template\_default, put it into your own template folder (and matching folder structure), and make your customizations in that copy of the file.

This way the only files you need in your personalized template folder are those that you have altered in some way from template\_default.

With that explained, it is important that whenever you upgrade your site, you should also inspect ALL the template\_default files to determine which changes in those files need to be replicated in your customized files.
Comparison/Merging Tools are essential for this process; see the [Zen Cart Developer Tools](https://docs.zen-cart.com/user/first_steps/useful_tools/) for recommendations.

The process is simple: compare the template\_default directory files from your *\*old\** version to the template\_default files in the *\*new\** version, and replicate any differences in the files in your custom/personalized template in your store. If you based your template on responsive\_classic, you should also compare and merge any changes from that template.

Then, and only after you have done all those comparisons and updated your customized files in your custom template folder, you will copy the template\_default files from the new version into the template\_default directory of your store.

This way you will be left with updated personalized files *\*and\** updated template\_default files.

# Language Files in Zen Cart 1.5.8 and above

Upgraders from prior versions of Zen Cart will notice a signficant change to the language files in this version. Because of new stricter PHP standards, simply doing a *define* on language file constants (with multiple define operations being done when overrides were present) was not an approach that could be used.

Zen Cart now uses [Array based language files](https://docs.zen-cart.com/user/localization/158_language_files/). For plugins with language files which are not overridden, the older style may still be used.

If you're doing an upgrade from a pre-1.5.8 Zen Cart version and are worried about all the language file changes you'll have to figure out, there is another option. Rather than porting \*all\* your customizations, you may want to start small and add customizations as they are needed. Many older templates made unnecessary changes which you will not want to carry forward. See [basic language file customizations](https://docs.zen-cart.com/user/localization/basic_158_language_customizations/) for a minimal starting list.

For developers with language skills wishing to provide a translation, [developer information on Array based language files](https://docs.zen-cart.com/dev/languages/158_language_files/) is provided.

# What's New ... Changes from prior versions

## The improvements in v2.0.1 since 2.0.0 include:

* (Note: no database changes between 2.0.0/2.0.1, so no need to run zc\_install again if 2.0.0 is already installed.)
* Admin: NOTIFY\_ADMIN\_CUSTOMERS\_LISTING\_ELEMENT notifier enhanced to pass entire customer query result.
* Admin: For stores with large numbers of coupons, selecting coupons on page 2+ can wind up showing a blank infoBox and the wrong coupon records.
* Admin: Allow customization of dashboard widget display; see [Admin Dashboard - Customizing](/user/admin_pages/admin_dashboard/#customizing).
* Admin: Show two whois links if two IP addresses associated with an order.
* Core: Improve encapsulated plugin management.
* Core: Many PHP8 logs have been fixed.
* Storefront: Fix template HTML issues.
* Storefront: New Products listing now shows new products as configured.
* Storefront: Shopping Cart class in\_cart\_check() function fixed.
* Storefront: Notifiers added to shipping modules so storeowners can implement their own exception rules. See [this page](/user/shipping/exceptions/).
* Storefront: Notifier added to coupon module so storeowners can implement their own exception rules (disabling specific coupons under certain conditions).
* Storefront: Notifiers added so storeowners can add to Information, More Information and EZ-Pages sideboxes. See [this page](/user/sideboxes/add_link_information_sidebox/#using-an-observer).

## The improvements in v2.0.0 since v1.5.8a include:

* New Feature: Wholesale pricing is now built-in (based on the Dual Pricing plugin). This feature allows storeowners to set price tiers on products, and assign customers to those tiers. See [Wholesale Pricing](https://docs.zen-cart.com/user/products/wholesale_pricing/).
* New Feature: Coupons can be added to URLs and automatically applied. This feature allows storeowners to advertise URLs that automatically result in discounts for the customer. See [Coupon Referrers](https://docs.zen-cart.com/user/order_total/coupons/#coupon-referrers).
* New Feature: Responsive Classic template product images (main and additional) now shown in a modal dialog rather than a popup when clicked. This feature modernizes the display of images. See [Popups](https://docs.zen-cart.com/user/images/popups/).
* Admin: All Products, New Products, Featured Products and Specials pages are now configured the same way as product listing pages. See [New/Featured/All Listing Configuration Settings](https://docs.zen-cart.com/user/template/new_featured_all_listing_page_configuration/).
  (Note: this means the menu items "All Listing," "New Listing" and "Featured Listing" under the Configuration Menu are no longer there; go to the Configuration > Product Listing menu instead.)
* Admin: Product pages now have a show/hide image option.
* Admin: Consolidated product-type modules to reduce code duplication. Now, per-product-type specific files are only required if they differ from the main file.
* Admin: Corrected display of Who's Online.
* Admin: Corrected handling of salemaker start date/end date.
* Admin: Coupon Restrict dropdown only shows products not already selected.
* Admin: Customers default address id bug fix.
* Admin: Customers list will now show registration IP. This behavior may also be disabled; see [admin specific overrides](https://docs.zen-cart.com/user/admin/site_specific_overrides/).
* Admin: Delete product checks to ensure product exists first.
* Admin: Developers now have a [template settings](https://docs.zen-cart.com/dev/code/template_settings/) file to facilitate template switching.
* Admin: Orders listing sidebox provides direct link to customer account.
* Admin: Order details page provides a direct link to customer account.
* Admin: Handle emails with embedded '+' signs.
* Admin: Improve layout of search box.
* Admin: Manufacturers page now has insert button when list is empty.
* Admin: Manufacturers image is now properly scaled when displayed.
* Admin: More pages converted to HTML5.
* Admin: Orders screen now uses ipdata.co for IP Address information retrieval.
* Admin: Order details page shows currency value for orders placed in non-default currency.
* Admin: Order details page shows weight for each product in an order.
* Admin: Order details page allows the user to copy addresses to the clipboard.
* Admin: Payment module "retirement" allows storeowners to continue using older payment modules for processing existing orders but not offer them for new orders. See [Payment Module Retirement](https://docs.zen-cart.com/user/payment/retirement/) for details.
* Admin: PCI defined constants consolidated in a single file.
* Admin: Deprecated files superceded by admin/includes/admin\_html\_head.php. Plugin authors please see [Admin Head Content](https://docs.zen-cart.com/dev/plugins/admin_head_content/) for details.
* Admin: Search improvements for customers, coupons, developer's toolkit.
* Admin: Shipping modules may now access per-product dimension information. See  [Shipping Dimensions](https://docs.zen-cart.com/user/shipping/shipping_dimensions/).
* Admin: Sort improvements for Specials and Featured pages.
* Admin: Zero valued database server settings were displayed as blanks on Admin > Version > "View the database configuration variables". They are now shown as zeroes.
* Core: Addition of manufacturer's part number (MPN) to the products table.
* Core: Addition of shipping tax rate to the orders table.
* Core: CrowdIn support for language translations.
* Core: Updates to international zones and country names.
* Core: Numerous updates for PHP 8.1 and 8.2 to resolve debug logs created by those newer PHP versions.
* Core: Dependency update - Updating to Font Awesome 6 (from 4.7). See [Font Awesome](https://docs.zen-cart.com/user/template/font_awesome/) for details.
* Core: Improved tax calculation accuracy throughout the cart.
* Core: When $db connection is down, generate fewer logs.
* Core: Performance improvements for stores with large databases.
* Core: Improve multi-currency handling throughout cart.
* Core: Fixes for PayPal constant MODULE\_PAYMENT\_PAYPALDP\_MERCHANT\_COUNTRY undefined.
* Database: Correction of known issues with zones.
* Storefront: On listing pages, the dropdown sort is now the primary sorting mechanism. PRODUCT\_LISTING\_DEFAULT\_SORT\_ORDER may only be numeric; alphanumeric settings are deprecated. See [Sort Order for listing pages](https://docs.zen-cart.com/user/customizing/sort_order/).
* Storefront: Ability to compute category counts by distinct products, to avoid double-counting linked products. Users wishing this behavior should see [site specific overrides](https://docs.zen-cart.com/user/customizing/site_specific_overrides/).
* Storefront: Accessibility improvements.
* Storefront: An [Accessibility page](https://docs.zen-cart.com/user/storefront_pages/accessibility/) for storeowners to talk about what they have done to make their store accessible.
* Storefront: Additional Images are only shown if there is a main image. Users of the Additional Product Images plugin who wish to disable this behavior, see [site specific overrides](https://docs.zen-cart.com/user/customizing/site_specific_overrides/).
* Storefront: All Products, New Products, Featured Products and Specials pages are now laid out the same way as product listing pages. See [New/Featured/All Listing Configuration Settings](https://docs.zen-cart.com/user/template/new_featured_all_listing_page_configuration/).
* Storefront: Category pages now support fluid listing format. See [Columnar Layout for Category Listing pages](https://docs.zen-cart.com/user/template/listing_columns_categories/).
* Storefront: Group Discount tax calculation fixes.
* Storefront: Coupon with excluded products tax calculation fixes.
* Storefront: Manufacturers sidebox shows scaled images.
* Storefront: PayPal date handling standardized.
* Storefront: PayPal Express Checkout zone and country correctly set for tax handling.
* Storefront: Shipping modules now visible in Shipping Estimator when zone restriction and non-pulldown state setting is used.
* Storefront: State dropdowns are now sorted alphabetically for all countries.
* System: All "extra" folders are now loaded alphabetically. In prior releases, they were loaded in filesystem order, which would sometimes result in system-dependent issues.
* System: The issue that caused the Uncaught IntlException: datefmt\_create: invalid locale: U\_ILLEGAL\_ARGUMENT\_ERROR problem for users running PHP 8.1/8.2 no longer requires configure.php changes.
* Upgrade: Improved UI and progress reporting in zc\_install.
* All known v1.5.8/v1.5.8a bugfixes and security fixes are included in v2.0.0.
* ... and many other incremental improvements to make Zen Cart more efficient, more robust and easier to use.

A detailed list of all edits to all files can be seen on Github at: [v1.5.8a...v2.0.0](https://github.com/zencart/zencart/compare/v1.5.8a...v2.0.0)

^^ [Back to Top](#pageHeader) ^^

# Help and Support

For additional help and support, visit the [Zen Cart Docs](https://docs.zen-cart.com/) and the [Zen Cart Support Forum](https://www.zen-cart.com/forum.php).

Zen Cart is derived from: Copyright 2003 osCommerce

This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;

without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE

and is redistributable under Version 2 of the GNU General Public License.

![O S I Certified](osi-certified-120x100.png)

This software is OSI Certified Open Source Software.

OSI Certified is a certification mark of the Open Source Initiative.

Copyright 2003 - 2024 Zen Ventures, LLC

Zen Cart

[www.zen-cart.com](https://www.zen-cart.com)


