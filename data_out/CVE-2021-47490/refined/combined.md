=== Content from git.kernel.org_d6250025_20250111_195502.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=bbc920fb320f1c241cc34ac85edaa0058922246a)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=bbc920fb320f1c241cc34ac85edaa0058922246a)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=bbc920fb320f1c241cc34ac85edaa0058922246a)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=bbc920fb320f1c241cc34ac85edaa0058922246a)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-11-04 09:35:57 +0100 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-11-06 14:10:09 +0100 |
| commit | [bbc920fb320f1c241cc34ac85edaa0058922246a](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=bbc920fb320f1c241cc34ac85edaa0058922246a) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=bbc920fb320f1c241cc34ac85edaa0058922246a)) | |
| tree | [e9785393dcb83fe2f7a929f837954629cf441cba](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=bbc920fb320f1c241cc34ac85edaa0058922246a) | |
| parent | [6d67b2a73b8e3a079c355bab3c1aef7d85a044b8](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=6d67b2a73b8e3a079c355bab3c1aef7d85a044b8) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=bbc920fb320f1c241cc34ac85edaa0058922246a&id2=6d67b2a73b8e3a079c355bab3c1aef7d85a044b8)) | |
| download | [linux-bbc920fb320f1c241cc34ac85edaa0058922246a.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-bbc920fb320f1c241cc34ac85edaa0058922246a.tar.gz) | |

Revert "drm/ttm: fix memleak in ttm\_transfered\_destroy"This reverts commit c21b4002214c1c7e7b627b9b53375612f7aab6db which is
commit 0db55f9a1bafbe3dac750ea669de9134922389b5 upstream.
Seems that the older kernels can not handle this fix because, to quote
Christian:
The problem is this memory leak could potentially happen with
5.10 as wel, just much much much less likely.
But my guess is that 5.10 is so buggy that when the leak does
NOT happen we double free and obviously causing a crash.
So it needs to be reverted.
Link: [https://lore.kernel.org/r/1a1cc125-9314-f569-a6c4-40fc4509a377@amd.com](https://lore.kernel.org/r/1a1cc125-9314-f569-a6c4-40fc4509a377%40amd.com)
Cc: Christian König <christian.koenig@amd.com>
Cc: Erhard F. <erhard\_f@mailbox.org>
Cc: Erhard F. <erhard\_f@mailbox.org>
Cc: Huang Rui <ray.huang@amd.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=bbc920fb320f1c241cc34ac85edaa0058922246a)

| -rw-r--r-- | [drivers/gpu/drm/ttm/ttm\_bo\_util.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/gpu/drm/ttm/ttm_bo_util.c?id=bbc920fb320f1c241cc34ac85edaa0058922246a) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 0 insertions, 1 deletions

| diff --git a/drivers/gpu/drm/ttm/ttm\_bo\_util.c b/drivers/gpu/drm/ttm/ttm\_bo\_util.cindex 8fba425a762688..fb2a25f8408fc8 100644--- a/[drivers/gpu/drm/ttm/ttm\_bo\_util.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/ttm/ttm_bo_util.c?id=6d67b2a73b8e3a079c355bab3c1aef7d85a044b8)+++ b/[drivers/gpu/drm/ttm/ttm\_bo\_util.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/ttm/ttm_bo_util.c?id=bbc920fb320f1c241cc34ac85edaa0058922246a)@@ -322,7 +322,6 @@ static void ttm\_transfered\_destroy(struct ttm\_buffer\_object \*bo) struct ttm\_transfer\_obj \*fbo;  fbo = container\_of(bo, struct ttm\_transfer\_obj, base);- dma\_resv\_fini(&fbo->base.base.\_resv); ttm\_bo\_put(fbo->bo); kfree(fbo); } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 19:53:39 +0000



=== Content from git.kernel.org_0deab05f_20250111_195458.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=0db55f9a1bafbe3dac750ea669de9134922389b5)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=0db55f9a1bafbe3dac750ea669de9134922389b5)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0db55f9a1bafbe3dac750ea669de9134922389b5)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=0db55f9a1bafbe3dac750ea669de9134922389b5)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Christian König <christian.koenig@amd.com> | 2021-10-20 19:19:46 +0200 |
| --- | --- | --- |
| committer | Christian König <christian.koenig@amd.com> | 2021-10-21 15:27:21 +0200 |
| commit | [0db55f9a1bafbe3dac750ea669de9134922389b5](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0db55f9a1bafbe3dac750ea669de9134922389b5) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=0db55f9a1bafbe3dac750ea669de9134922389b5)) | |
| tree | [f8397a3dc990bd16b462fa243882b9c6204203c7](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=0db55f9a1bafbe3dac750ea669de9134922389b5) | |
| parent | [74056092ff415e7e20ce2544689b32ee811c4f0b](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=74056092ff415e7e20ce2544689b32ee811c4f0b) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=0db55f9a1bafbe3dac750ea669de9134922389b5&id2=74056092ff415e7e20ce2544689b32ee811c4f0b)) | |
| download | [linux-0db55f9a1bafbe3dac750ea669de9134922389b5.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-0db55f9a1bafbe3dac750ea669de9134922389b5.tar.gz) | |

drm/ttm: fix memleak in ttm\_transfered\_destroyWe need to cleanup the fences for ghost objects as well.
Signed-off-by: Christian König <christian.koenig@amd.com>
Reported-by: Erhard F. <erhard\_f@mailbox.org>
Tested-by: Erhard F. <erhard\_f@mailbox.org>
Reviewed-by: Huang Rui <ray.huang@amd.com>
Bug: https://bugzilla.kernel.org/show\_bug.cgi?id=214029
Bug: https://bugzilla.kernel.org/show\_bug.cgi?id=214447
CC: <stable@vger.kernel.org>
Link: [https://patchwork.freedesktop.org/patch/msgid/20211020173211.2247-1-christian.koenig@amd.com](https://patchwork.freedesktop.org/patch/msgid/20211020173211.2247-1-christian.koenig%40amd.com)
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=0db55f9a1bafbe3dac750ea669de9134922389b5)

| -rw-r--r-- | [drivers/gpu/drm/ttm/ttm\_bo\_util.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/gpu/drm/ttm/ttm_bo_util.c?id=0db55f9a1bafbe3dac750ea669de9134922389b5) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 0 deletions

| diff --git a/drivers/gpu/drm/ttm/ttm\_bo\_util.c b/drivers/gpu/drm/ttm/ttm\_bo\_util.cindex 1c5ffe2935af55..abf2d7a4fdf1ac 100644--- a/[drivers/gpu/drm/ttm/ttm\_bo\_util.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/ttm/ttm_bo_util.c?id=74056092ff415e7e20ce2544689b32ee811c4f0b)+++ b/[drivers/gpu/drm/ttm/ttm\_bo\_util.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/ttm/ttm_bo_util.c?id=0db55f9a1bafbe3dac750ea669de9134922389b5)@@ -190,6 +190,7 @@ static void ttm\_transfered\_destroy(struct ttm\_buffer\_object \*bo) struct ttm\_transfer\_obj \*fbo;  fbo = container\_of(bo, struct ttm\_transfer\_obj, base);+ dma\_resv\_fini(&fbo->base.base.\_resv); ttm\_bo\_put(fbo->bo); kfree(fbo); } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 19:53:35 +0000



=== Content from git.kernel.org_96a645b8_20250111_195500.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=960b1fdfc39aba8f41e9e27b2de0c925c74182d9)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=960b1fdfc39aba8f41e9e27b2de0c925c74182d9)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=960b1fdfc39aba8f41e9e27b2de0c925c74182d9)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=960b1fdfc39aba8f41e9e27b2de0c925c74182d9)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-11-04 09:35:57 +0100 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-11-06 13:59:45 +0100 |
| commit | [960b1fdfc39aba8f41e9e27b2de0c925c74182d9](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=960b1fdfc39aba8f41e9e27b2de0c925c74182d9) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=960b1fdfc39aba8f41e9e27b2de0c925c74182d9)) | |
| tree | [71039bcd8a20f5fb22a5a5e72a8d86e3e956c268](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=960b1fdfc39aba8f41e9e27b2de0c925c74182d9) | |
| parent | [a73ebe514a60262e528386b87cf74492fb1ed843](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a73ebe514a60262e528386b87cf74492fb1ed843) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=960b1fdfc39aba8f41e9e27b2de0c925c74182d9&id2=a73ebe514a60262e528386b87cf74492fb1ed843)) | |
| download | [linux-960b1fdfc39aba8f41e9e27b2de0c925c74182d9.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-960b1fdfc39aba8f41e9e27b2de0c925c74182d9.tar.gz) | |

Revert "drm/ttm: fix memleak in ttm\_transfered\_destroy"This reverts commit bd99782f3ca491879e8524c89b1c0f40071903bd which is
commit 0db55f9a1bafbe3dac750ea669de9134922389b5 upstream.
Seems that the older kernels can not handle this fix because, to quote
Christian:
The problem is this memory leak could potentially happen with
5.10 as wel, just much much much less likely.
But my guess is that 5.10 is so buggy that when the leak does
NOT happen we double free and obviously causing a crash.
So it needs to be reverted.
Link: [https://lore.kernel.org/r/1a1cc125-9314-f569-a6c4-40fc4509a377@amd.com](https://lore.kernel.org/r/1a1cc125-9314-f569-a6c4-40fc4509a377%40amd.com)
Cc: Christian König <christian.koenig@amd.com>
Cc: Erhard F. <erhard\_f@mailbox.org>
Cc: Erhard F. <erhard\_f@mailbox.org>
Cc: Huang Rui <ray.huang@amd.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=960b1fdfc39aba8f41e9e27b2de0c925c74182d9)

| -rw-r--r-- | [drivers/gpu/drm/ttm/ttm\_bo\_util.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/gpu/drm/ttm/ttm_bo_util.c?id=960b1fdfc39aba8f41e9e27b2de0c925c74182d9) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 0 insertions, 1 deletions

| diff --git a/drivers/gpu/drm/ttm/ttm\_bo\_util.c b/drivers/gpu/drm/ttm/ttm\_bo\_util.cindex a7b88ca8b97b3b..fe81c565e7ef88 100644--- a/[drivers/gpu/drm/ttm/ttm\_bo\_util.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/ttm/ttm_bo_util.c?id=a73ebe514a60262e528386b87cf74492fb1ed843)+++ b/[drivers/gpu/drm/ttm/ttm\_bo\_util.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/ttm/ttm_bo_util.c?id=960b1fdfc39aba8f41e9e27b2de0c925c74182d9)@@ -463,7 +463,6 @@ static void ttm\_transfered\_destroy(struct ttm\_buffer\_object \*bo) struct ttm\_transfer\_obj \*fbo;  fbo = container\_of(bo, struct ttm\_transfer\_obj, base);- dma\_resv\_fini(&fbo->base.base.\_resv); ttm\_bo\_put(fbo->bo); kfree(fbo); } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 19:53:38 +0000



=== Content from git.kernel.org_26196d80_20250111_195503.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=bd99782f3ca491879e8524c89b1c0f40071903bd)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=bd99782f3ca491879e8524c89b1c0f40071903bd)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=bd99782f3ca491879e8524c89b1c0f40071903bd)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=bd99782f3ca491879e8524c89b1c0f40071903bd)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Christian König <christian.koenig@amd.com> | 2021-10-20 19:19:46 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-11-02 19:46:13 +0100 |
| commit | [bd99782f3ca491879e8524c89b1c0f40071903bd](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=bd99782f3ca491879e8524c89b1c0f40071903bd) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=bd99782f3ca491879e8524c89b1c0f40071903bd)) | |
| tree | [fd1fe3bce37f3c67bf010332a60ddfde23beee45](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=bd99782f3ca491879e8524c89b1c0f40071903bd) | |
| parent | [d2c64ebcc76a3fba35a45f8ba1193adceeb75d83](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d2c64ebcc76a3fba35a45f8ba1193adceeb75d83) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=bd99782f3ca491879e8524c89b1c0f40071903bd&id2=d2c64ebcc76a3fba35a45f8ba1193adceeb75d83)) | |
| download | [linux-bd99782f3ca491879e8524c89b1c0f40071903bd.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-bd99782f3ca491879e8524c89b1c0f40071903bd.tar.gz) | |

drm/ttm: fix memleak in ttm\_transfered\_destroycommit 0db55f9a1bafbe3dac750ea669de9134922389b5 upstream.
We need to cleanup the fences for ghost objects as well.
Signed-off-by: Christian König <christian.koenig@amd.com>
Reported-by: Erhard F. <erhard\_f@mailbox.org>
Tested-by: Erhard F. <erhard\_f@mailbox.org>
Reviewed-by: Huang Rui <ray.huang@amd.com>
Bug: https://bugzilla.kernel.org/show\_bug.cgi?id=214029
Bug: https://bugzilla.kernel.org/show\_bug.cgi?id=214447
CC: <stable@vger.kernel.org>
Link: [https://patchwork.freedesktop.org/patch/msgid/20211020173211.2247-1-christian.koenig@amd.com](https://patchwork.freedesktop.org/patch/msgid/20211020173211.2247-1-christian.koenig%40amd.com)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=bd99782f3ca491879e8524c89b1c0f40071903bd)

| -rw-r--r-- | [drivers/gpu/drm/ttm/ttm\_bo\_util.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/gpu/drm/ttm/ttm_bo_util.c?id=bd99782f3ca491879e8524c89b1c0f40071903bd) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 0 deletions

| diff --git a/drivers/gpu/drm/ttm/ttm\_bo\_util.c b/drivers/gpu/drm/ttm/ttm\_bo\_util.cindex fe81c565e7ef88..a7b88ca8b97b3b 100644--- a/[drivers/gpu/drm/ttm/ttm\_bo\_util.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/ttm/ttm_bo_util.c?id=d2c64ebcc76a3fba35a45f8ba1193adceeb75d83)+++ b/[drivers/gpu/drm/ttm/ttm\_bo\_util.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/ttm/ttm_bo_util.c?id=bd99782f3ca491879e8524c89b1c0f40071903bd)@@ -463,6 +463,7 @@ static void ttm\_transfered\_destroy(struct ttm\_buffer\_object \*bo) struct ttm\_transfer\_obj \*fbo;  fbo = container\_of(bo, struct ttm\_transfer\_obj, base);+ dma\_resv\_fini(&fbo->base.base.\_resv); ttm\_bo\_put(fbo->bo); kfree(fbo); } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 19:53:40 +0000



=== Content from git.kernel.org_ab3b5667_20250111_195504.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=c21b4002214c1c7e7b627b9b53375612f7aab6db)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=c21b4002214c1c7e7b627b9b53375612f7aab6db)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c21b4002214c1c7e7b627b9b53375612f7aab6db)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c21b4002214c1c7e7b627b9b53375612f7aab6db)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Christian König <christian.koenig@amd.com> | 2021-10-20 19:19:46 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-11-02 19:48:20 +0100 |
| commit | [c21b4002214c1c7e7b627b9b53375612f7aab6db](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c21b4002214c1c7e7b627b9b53375612f7aab6db) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=c21b4002214c1c7e7b627b9b53375612f7aab6db)) | |
| tree | [67ab60a69a2369eced89f7211b25f25284344252](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=c21b4002214c1c7e7b627b9b53375612f7aab6db) | |
| parent | [69a7fa5cb0de06c8956b040f19a7248c8c8308ca](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=69a7fa5cb0de06c8956b040f19a7248c8c8308ca) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c21b4002214c1c7e7b627b9b53375612f7aab6db&id2=69a7fa5cb0de06c8956b040f19a7248c8c8308ca)) | |
| download | [linux-c21b4002214c1c7e7b627b9b53375612f7aab6db.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-c21b4002214c1c7e7b627b9b53375612f7aab6db.tar.gz) | |

drm/ttm: fix memleak in ttm\_transfered\_destroycommit 0db55f9a1bafbe3dac750ea669de9134922389b5 upstream.
We need to cleanup the fences for ghost objects as well.
Signed-off-by: Christian König <christian.koenig@amd.com>
Reported-by: Erhard F. <erhard\_f@mailbox.org>
Tested-by: Erhard F. <erhard\_f@mailbox.org>
Reviewed-by: Huang Rui <ray.huang@amd.com>
Bug: https://bugzilla.kernel.org/show\_bug.cgi?id=214029
Bug: https://bugzilla.kernel.org/show\_bug.cgi?id=214447
CC: <stable@vger.kernel.org>
Link: [https://patchwork.freedesktop.org/patch/msgid/20211020173211.2247-1-christian.koenig@amd.com](https://patchwork.freedesktop.org/patch/msgid/20211020173211.2247-1-christian.koenig%40amd.com)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c21b4002214c1c7e7b627b9b53375612f7aab6db)

| -rw-r--r-- | [drivers/gpu/drm/ttm/ttm\_bo\_util.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/gpu/drm/ttm/ttm_bo_util.c?id=c21b4002214c1c7e7b627b9b53375612f7aab6db) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 0 deletions

| diff --git a/drivers/gpu/drm/ttm/ttm\_bo\_util.c b/drivers/gpu/drm/ttm/ttm\_bo\_util.cindex fb2a25f8408fc8..8fba425a762688 100644--- a/[drivers/gpu/drm/ttm/ttm\_bo\_util.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/ttm/ttm_bo_util.c?id=69a7fa5cb0de06c8956b040f19a7248c8c8308ca)+++ b/[drivers/gpu/drm/ttm/ttm\_bo\_util.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/ttm/ttm_bo_util.c?id=c21b4002214c1c7e7b627b9b53375612f7aab6db)@@ -322,6 +322,7 @@ static void ttm\_transfered\_destroy(struct ttm\_buffer\_object \*bo) struct ttm\_transfer\_obj \*fbo;  fbo = container\_of(bo, struct ttm\_transfer\_obj, base);+ dma\_resv\_fini(&fbo->base.base.\_resv); ttm\_bo\_put(fbo->bo); kfree(fbo); } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 19:53:41 +0000



=== Content from git.kernel.org_600ba7ea_20250111_195459.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=132a3d998d6753047f22152731fba2b0d6b463dd)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=132a3d998d6753047f22152731fba2b0d6b463dd)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=132a3d998d6753047f22152731fba2b0d6b463dd)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=132a3d998d6753047f22152731fba2b0d6b463dd)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Christian König <christian.koenig@amd.com> | 2021-10-20 19:19:46 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-11-02 19:50:54 +0100 |
| commit | [132a3d998d6753047f22152731fba2b0d6b463dd](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=132a3d998d6753047f22152731fba2b0d6b463dd) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=132a3d998d6753047f22152731fba2b0d6b463dd)) | |
| tree | [7167dedad2503b6f60254086c5d4cc501665627e](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=132a3d998d6753047f22152731fba2b0d6b463dd) | |
| parent | [15a4f2bdbdfd7bbe89dec23da01c706a31623f09](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=15a4f2bdbdfd7bbe89dec23da01c706a31623f09) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=132a3d998d6753047f22152731fba2b0d6b463dd&id2=15a4f2bdbdfd7bbe89dec23da01c706a31623f09)) | |
| download | [linux-132a3d998d6753047f22152731fba2b0d6b463dd.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-132a3d998d6753047f22152731fba2b0d6b463dd.tar.gz) | |

drm/ttm: fix memleak in ttm\_transfered\_destroycommit 0db55f9a1bafbe3dac750ea669de9134922389b5 upstream.
We need to cleanup the fences for ghost objects as well.
Signed-off-by: Christian König <christian.koenig@amd.com>
Reported-by: Erhard F. <erhard\_f@mailbox.org>
Tested-by: Erhard F. <erhard\_f@mailbox.org>
Reviewed-by: Huang Rui <ray.huang@amd.com>
Bug: https://bugzilla.kernel.org/show\_bug.cgi?id=214029
Bug: https://bugzilla.kernel.org/show\_bug.cgi?id=214447
CC: <stable@vger.kernel.org>
Link: [https://patchwork.freedesktop.org/patch/msgid/20211020173211.2247-1-christian.koenig@amd.com](https://patchwork.freedesktop.org/patch/msgid/20211020173211.2247-1-christian.koenig%40amd.com)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=132a3d998d6753047f22152731fba2b0d6b463dd)

| -rw-r--r-- | [drivers/gpu/drm/ttm/ttm\_bo\_util.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/gpu/drm/ttm/ttm_bo_util.c?id=132a3d998d6753047f22152731fba2b0d6b463dd) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 0 deletions

| diff --git a/drivers/gpu/drm/ttm/ttm\_bo\_util.c b/drivers/gpu/drm/ttm/ttm\_bo\_util.cindex 1c5ffe2935af55..abf2d7a4fdf1ac 100644--- a/[drivers/gpu/drm/ttm/ttm\_bo\_util.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/ttm/ttm_bo_util.c?id=15a4f2bdbdfd7bbe89dec23da01c706a31623f09)+++ b/[drivers/gpu/drm/ttm/ttm\_bo\_util.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/ttm/ttm_bo_util.c?id=132a3d998d6753047f22152731fba2b0d6b463dd)@@ -190,6 +190,7 @@ static void ttm\_transfered\_destroy(struct ttm\_buffer\_object \*bo) struct ttm\_transfer\_obj \*fbo;  fbo = container\_of(bo, struct ttm\_transfer\_obj, base);+ dma\_resv\_fini(&fbo->base.base.\_resv); ttm\_bo\_put(fbo->bo); kfree(fbo); } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 19:53:36 +0000


