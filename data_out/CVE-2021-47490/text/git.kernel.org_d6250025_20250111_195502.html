

| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=bbc920fb320f1c241cc34ac85edaa0058922246a)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=bbc920fb320f1c241cc34ac85edaa0058922246a)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=bbc920fb320f1c241cc34ac85edaa0058922246a)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=bbc920fb320f1c241cc34ac85edaa0058922246a)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-11-04 09:35:57 +0100 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-11-06 14:10:09 +0100 |
| commit | [bbc920fb320f1c241cc34ac85edaa0058922246a](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=bbc920fb320f1c241cc34ac85edaa0058922246a) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=bbc920fb320f1c241cc34ac85edaa0058922246a)) | |
| tree | [e9785393dcb83fe2f7a929f837954629cf441cba](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=bbc920fb320f1c241cc34ac85edaa0058922246a) | |
| parent | [6d67b2a73b8e3a079c355bab3c1aef7d85a044b8](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=6d67b2a73b8e3a079c355bab3c1aef7d85a044b8) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=bbc920fb320f1c241cc34ac85edaa0058922246a&id2=6d67b2a73b8e3a079c355bab3c1aef7d85a044b8)) | |
| download | [linux-bbc920fb320f1c241cc34ac85edaa0058922246a.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-bbc920fb320f1c241cc34ac85edaa0058922246a.tar.gz) | |

Revert "drm/ttm: fix memleak in ttm\_transfered\_destroy"This reverts commit c21b4002214c1c7e7b627b9b53375612f7aab6db which is
commit 0db55f9a1bafbe3dac750ea669de9134922389b5 upstream.
Seems that the older kernels can not handle this fix because, to quote
Christian:
The problem is this memory leak could potentially happen with
5.10 as wel, just much much much less likely.
But my guess is that 5.10 is so buggy that when the leak does
NOT happen we double free and obviously causing a crash.
So it needs to be reverted.
Link: [https://lore.kernel.org/r/1a1cc125-9314-f569-a6c4-40fc4509a377@amd.com](https://lore.kernel.org/r/1a1cc125-9314-f569-a6c4-40fc4509a377%40amd.com)
Cc: Christian KÃ¶nig <christian.koenig@amd.com>
Cc: Erhard F. <erhard\_f@mailbox.org>
Cc: Erhard F. <erhard\_f@mailbox.org>
Cc: Huang Rui <ray.huang@amd.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=bbc920fb320f1c241cc34ac85edaa0058922246a)

| -rw-r--r-- | [drivers/gpu/drm/ttm/ttm\_bo\_util.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/gpu/drm/ttm/ttm_bo_util.c?id=bbc920fb320f1c241cc34ac85edaa0058922246a) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 0 insertions, 1 deletions

| diff --git a/drivers/gpu/drm/ttm/ttm\_bo\_util.c b/drivers/gpu/drm/ttm/ttm\_bo\_util.cindex 8fba425a762688..fb2a25f8408fc8 100644--- a/[drivers/gpu/drm/ttm/ttm\_bo\_util.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/ttm/ttm_bo_util.c?id=6d67b2a73b8e3a079c355bab3c1aef7d85a044b8)+++ b/[drivers/gpu/drm/ttm/ttm\_bo\_util.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/ttm/ttm_bo_util.c?id=bbc920fb320f1c241cc34ac85edaa0058922246a)@@ -322,7 +322,6 @@ static void ttm\_transfered\_destroy(struct ttm\_buffer\_object \*bo) struct ttm\_transfer\_obj \*fbo;  fbo = container\_of(bo, struct ttm\_transfer\_obj, base);- dma\_resv\_fini(&fbo->base.base.\_resv); ttm\_bo\_put(fbo->bo); kfree(fbo); } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 19:53:39 +0000

