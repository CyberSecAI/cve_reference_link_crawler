

| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=cb88cb53badb8aeb3955ad6ce80b07b598e310b8)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=cb88cb53badb8aeb3955ad6ce80b07b598e310b8)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=cb88cb53badb8aeb3955ad6ce80b07b598e310b8)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=cb88cb53badb8aeb3955ad6ce80b07b598e310b8)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Eric Dumazet <edumazet@google.com> | 2024-02-05 17:10:04 +0000 |
| --- | --- | --- |
| committer | Jakub Kicinski <kuba@kernel.org> | 2024-02-06 18:45:52 -0800 |
| commit | [cb88cb53badb8aeb3955ad6ce80b07b598e310b8](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=cb88cb53badb8aeb3955ad6ce80b07b598e310b8) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=cb88cb53badb8aeb3955ad6ce80b07b598e310b8)) | |
| tree | [719c801c05bfef4ea58d52661dadc06051c3da9c](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=cb88cb53badb8aeb3955ad6ce80b07b598e310b8) | |
| parent | [58086721b7781c3e35b19c9b78c8f5a791070ba3](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=58086721b7781c3e35b19c9b78c8f5a791070ba3) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=cb88cb53badb8aeb3955ad6ce80b07b598e310b8&id2=58086721b7781c3e35b19c9b78c8f5a791070ba3)) | |
| download | [linux-cb88cb53badb8aeb3955ad6ce80b07b598e310b8.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-cb88cb53badb8aeb3955ad6ce80b07b598e310b8.tar.gz) | |

ppp\_async: limit MRU to 64Ksyzbot triggered a warning [1] in \_\_alloc\_pages():
WARN\_ON\_ONCE\_GFP(order > MAX\_PAGE\_ORDER, gfp)
Willem fixed a similar issue in commit c0a2a1b0d631 ("ppp: limit MRU to 64K")
Adopt the same sanity check for ppp\_async\_ioctl(PPPIOCSMRU)
[1]:
WARNING: CPU: 1 PID: 11 at mm/page\_alloc.c:4543 \_\_alloc\_pages+0x308/0x698 mm/page\_alloc.c:4543
Modules linked in:
CPU: 1 PID: 11 Comm: kworker/u4:0 Not tainted 6.8.0-rc2-syzkaller-g41bccc98fb79 #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 11/17/2023
Workqueue: events\_unbound flush\_to\_ldisc
pstate: 204000c5 (nzCv daIF +PAN -UAO -TCO -DIT -SSBS BTYPE=--)
pc : \_\_alloc\_pages+0x308/0x698 mm/page\_alloc.c:4543
lr : \_\_alloc\_pages+0xc8/0x698 mm/page\_alloc.c:4537
sp : ffff800093967580
x29: ffff800093967660 x28: ffff8000939675a0 x27: dfff800000000000
x26: ffff70001272ceb4 x25: 0000000000000000 x24: ffff8000939675c0
x23: 0000000000000000 x22: 0000000000060820 x21: 1ffff0001272ceb8
x20: ffff8000939675e0 x19: 0000000000000010 x18: ffff800093967120
x17: ffff800083bded5c x16: ffff80008ac97500 x15: 0000000000000005
x14: 1ffff0001272cebc x13: 0000000000000000 x12: 0000000000000000
x11: ffff70001272cec1 x10: 1ffff0001272cec0 x9 : 0000000000000001
x8 : ffff800091c91000 x7 : 0000000000000000 x6 : 000000000000003f
x5 : 00000000ffffffff x4 : 0000000000000000 x3 : 0000000000000020
x2 : 0000000000000008 x1 : 0000000000000000 x0 : ffff8000939675e0
Call trace:
\_\_alloc\_pages+0x308/0x698 mm/page\_alloc.c:4543
\_\_alloc\_pages\_node include/linux/gfp.h:238 [inline]
alloc\_pages\_node include/linux/gfp.h:261 [inline]
\_\_kmalloc\_large\_node+0xbc/0x1fc mm/slub.c:3926
\_\_do\_kmalloc\_node mm/slub.c:3969 [inline]
\_\_kmalloc\_node\_track\_caller+0x418/0x620 mm/slub.c:4001
kmalloc\_reserve+0x17c/0x23c net/core/skbuff.c:590
\_\_alloc\_skb+0x1c8/0x3d8 net/core/skbuff.c:651
\_\_netdev\_alloc\_skb+0xb8/0x3e8 net/core/skbuff.c:715
netdev\_alloc\_skb include/linux/skbuff.h:3235 [inline]
dev\_alloc\_skb include/linux/skbuff.h:3248 [inline]
ppp\_async\_input drivers/net/ppp/ppp\_async.c:863 [inline]
ppp\_asynctty\_receive+0x588/0x186c drivers/net/ppp/ppp\_async.c:341
tty\_ldisc\_receive\_buf+0x12c/0x15c drivers/tty/tty\_buffer.c:390
tty\_port\_default\_receive\_buf+0x74/0xac drivers/tty/tty\_port.c:37
receive\_buf drivers/tty/tty\_buffer.c:444 [inline]
flush\_to\_ldisc+0x284/0x6e4 drivers/tty/tty\_buffer.c:494
process\_one\_work+0x694/0x1204 kernel/workqueue.c:2633
process\_scheduled\_works kernel/workqueue.c:2706 [inline]
worker\_thread+0x938/0xef4 kernel/workqueue.c:2787
kthread+0x288/0x310 kernel/kthread.c:388
ret\_from\_fork+0x10/0x20 arch/arm64/kernel/entry.S:860
Fixes: 1da177e4c3f4 ("Linux-2.6.12-rc2")
Reported-and-tested-by: syzbot+c5da1f087c9e4ec6c933@syzkaller.appspotmail.com
Signed-off-by: Eric Dumazet <edumazet@google.com>
Reviewed-by: Willem de Bruijn <willemb@google.com>
Link: [https://lore.kernel.org/r/20240205171004.1059724-1-edumazet@google.com](https://lore.kernel.org/r/20240205171004.1059724-1-edumazet%40google.com)
Signed-off-by: Jakub Kicinski <kuba@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=cb88cb53badb8aeb3955ad6ce80b07b598e310b8)

| -rw-r--r-- | [drivers/net/ppp/ppp\_async.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/ppp/ppp_async.c?id=cb88cb53badb8aeb3955ad6ce80b07b598e310b8) | 4 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 0 deletions

| diff --git a/drivers/net/ppp/ppp\_async.c b/drivers/net/ppp/ppp\_async.cindex 840da924708b39..125793d8aefa77 100644--- a/[drivers/net/ppp/ppp\_async.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/ppp/ppp_async.c?id=58086721b7781c3e35b19c9b78c8f5a791070ba3)+++ b/[drivers/net/ppp/ppp\_async.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/ppp/ppp_async.c?id=cb88cb53badb8aeb3955ad6ce80b07b598e310b8)@@ -460,6 +460,10 @@ ppp\_async\_ioctl(struct ppp\_channel \*chan, unsigned int cmd, unsigned long arg) case PPPIOCSMRU: if (get\_user(val, p)) break;+ if (val > U16\_MAX) {+ err = -EINVAL;+ break;+ } if (val < PPP\_MRU) val = PPP\_MRU; ap->mru = val; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 17:09:51 +0000

