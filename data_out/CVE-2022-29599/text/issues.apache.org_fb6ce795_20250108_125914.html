

[Log in](/jira/login.jsp?os_destination=%2Fbrowse%2FMSHARED-297)[Skip to main content](#main)[Skip to sidebar](#sidebar)Linked ApplicationsLoadingâ€¦[![ASF JIRA](/jira/s/xd97tr/820010/13pdxe5/_/jira-logo-scaled.png)](https://issues.apache.org/jira/secure/MyJiraHome.jspa)

* [Dashboards](/jira/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/jira/browse/MSHARED "View recent projects and browse a list of projects")
* [Issues](/jira/issues/ "Search for issues and view recent issues")

* [Help](https://docs.atlassian.com/jira/jcore-docs-0820/ "Help")
  + [Jira Core help](https://docs.atlassian.com/jira/jcore-docs-0820/ "Go to the online documentation for Jira Core")
  + [Keyboard Shortcuts](/jira/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [About Jira](/jira/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/jira/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/jira/login.jsp?os_destination=%2Fbrowse%2FMSHARED-297)

Public signup for this instance is **disabled**. Go to our [Self serve sign up page](https://selfserve.apache.org/jira-account.html) to request an account. Report potential security issues [privately](https://apache.org/security/#reporting-a-vulnerability)

![Uploaded image for project: 'Maven Shared Components'](https://issues.apache.org/jira/secure/projectavatar?pid=12317922&avatarId=10011)

1. [Maven Shared Components](/jira/browse/MSHARED)
2. [MSHARED-297](/jira/browse/MSHARED-297)

# Commandline class shell injection vulnerabilities

[Log In](/jira/login.jsp?os_destination=%2Fbrowse%2FMSHARED-297 "Log In")Export

XMLWordPrintableJSON
#### Details

* **Type:**
  ![](/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.") Bug
* **Status:**
  Closed
* **Priority:**
  ![](/jira/images/icons/priorities/critical.svg "Critical - Crashes, loss of data, severe memory leak.") Critical
* **Resolution:**
  Fixed
* **Affects Version/s:**
  None
* **Fix Version/s:**
  [maven-shared-utils-3.3.3](/jira/issues/?jql=project+%3D+MSHARED+AND+fixVersion+%3D+maven-shared-utils-3.3.3 "maven-shared-utils-3.3.3 ")
* **Component/s:**
  [maven-shared-utils](/jira/issues/?jql=project+%3D+MSHARED+AND+component+%3D+maven-shared-utils "maven-shared-utils lots of util code without any external dependencies")
* **Labels:**
  + [SECURITY](/jira/issues/?jql=labels+%3D+SECURITY "SECURITY")

* **External issue URL:**
  <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-29599>

#### Description

The Commandline class can emit double-quoted strings without proper escaping, allowing shell injection attacks.

The BourneShell class should unconditionally single-quote emitted strings (including the name of the command itself being quoted), with '"'"' used for embedded single quotes, for maximum safety across shells implementing a superset of POSIX quoting rules.

An appropriate fix has been built and applied against PLXUTILS; that patch is submitted here in the hope that it will be useful, though it is not expected to apply to the maven-shared-utils codebase without modification.

See PLXUTILS-161 for history/discussion.

#### Attachments

#### Attachments

* Options
  + [Sort By Name](/jira/browse/MSHARED-297?attachmentSortBy=fileName#attachmentmodule "viewissue.subtasks.tab.show.all.name")
  + [Sort By Date](/jira/browse/MSHARED-297?attachmentSortBy=dateTime#attachmentmodule "Sort By Date")
  + [Ascending](/jira/browse/MSHARED-297?attachmentOrder=asc#attachmentmodule "Ascending")
  + [Descending](/jira/browse/MSHARED-297?attachmentOrder=desc#attachmentmodule "Descending")

1. [use-no-shell-r2.patch](/jira/secure/attachment/12719165/use-no-shell-r2.patch "Latest  23/Oct/13 15:49 - Charles Duffy")23/Oct/13 15:4921 kBCharles Duffy
#### Issue Links

relates to

![Bug - A problem which impairs or prevents the functions of the product.](/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[MSHARED-431](/jira/browse/MSHARED-431)
# (Hash-Sign) should trigger quoting in BourneShell.java

* ![Major - Major loss of function.](/jira/images/icons/priorities/major.svg "Major - Major loss of function.")
* Closed

links to

![Web Link](https://github.com/favicon.ico "Web Link")
[GitHub Pull Request #40](https://github.com/apache/maven-shared-utils/pull/40)

#### Activity

#### People

Assignee:

![slachiewicz](https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452)
Sylwester Lachiewicz

Reporter:

![charles@dyfis.net](https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452)
Charles Duffy

Votes:
0
Vote for this issue

Watchers:
4
Start watching this issue

#### Dates

Created:

23/Oct/13 15:49

Updated:

23/May/22 14:52

Resolved:

20/Jul/20 12:47

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/jira/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/jira/secure/CreateIssue%21default.jspa)

Powered by a free Atlassian [Jira](http://www.atlassian.com/software/jira) open source license for Apache Software Foundation. Try Jira - [bug tracking software](http://www.atlassian.com/software/jira) for *your* team.

[Atlassian](http://www.atlassian.com/)

