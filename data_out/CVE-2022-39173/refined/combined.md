=== Content from packetstormsecurity.com_99ecf3d7_20250108_131946.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from github.com_dc80b2be_20250108_131949.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FwolfSSL%2Fwolfssl%2Freleases)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FwolfSSL%2Fwolfssl%2Freleases)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Findex&source=header-repo&source_repo=wolfSSL%2Fwolfssl)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[wolfSSL](/wolfSSL)
/
**[wolfssl](/wolfSSL/wolfssl)**
Public

* [Notifications](/login?return_to=%2FwolfSSL%2Fwolfssl) You must be signed in to change notification settings
* [Fork
  837](/login?return_to=%2FwolfSSL%2Fwolfssl)
* [Star
   2.4k](/login?return_to=%2FwolfSSL%2Fwolfssl)

* [Code](/wolfSSL/wolfssl)
* [Issues
  93](/wolfSSL/wolfssl/issues)
* [Pull requests
  50](/wolfSSL/wolfssl/pulls)
* [Actions](/wolfSSL/wolfssl/actions)
* [Projects
  0](/wolfSSL/wolfssl/projects)
* [Wiki](/wolfSSL/wolfssl/wiki)
* [Security](/wolfSSL/wolfssl/security)
* [Insights](/wolfSSL/wolfssl/pulse)

Additional navigation options

* [Code](/wolfSSL/wolfssl)
* [Issues](/wolfSSL/wolfssl/issues)
* [Pull requests](/wolfSSL/wolfssl/pulls)
* [Actions](/wolfSSL/wolfssl/actions)
* [Projects](/wolfSSL/wolfssl/projects)
* [Wiki](/wolfSSL/wolfssl/wiki)
* [Security](/wolfSSL/wolfssl/security)
* [Insights](/wolfSSL/wolfssl/pulse)

# Releases: wolfSSL/wolfssl

[Releases](/wolfSSL/wolfssl/releases)
[Tags](/wolfSSL/wolfssl/tags)

Releases · wolfSSL/wolfssl
## wolfSSL Release 5.7.6 (Dec 31, 2024)

31 Dec 22:36

![@JacobBarthelmeh](https://avatars.githubusercontent.com/u/7565298?s=40&v=4)
[JacobBarthelmeh](/JacobBarthelmeh)

[v5.7.6-stable](/wolfSSL/wolfssl/tree/v5.7.6-stable)

[`239b85c`](/wolfSSL/wolfssl/commit/239b85c80438bf60d9a5b9e0ebe9ff097a760d0d)

This commit was created on GitHub.com and signed with GitHub’s **verified signature**.

GPG key ID: B5690EEEBB952194

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/wolfSSL/wolfssl/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v5.7.6-stable)

 Loading

[View all tags](/wolfSSL/wolfssl/tags)

[wolfSSL Release 5.7.6 (Dec 31, 2024)](/wolfSSL/wolfssl/releases/tag/v5.7.6-stable)
[Latest](/wolfSSL/wolfssl/releases/latest)

[Latest](/wolfSSL/wolfssl/releases/latest)

# To download the release bundle of wolfSSL visit the download page at [www.wolfssl.com/download/](http://www.wolfssl.com/download/)

NOTE:

* --enable-heapmath is deprecated.
* In this release, the default cipher suite preference is updated to prioritize

  TLS\_AES\_256\_GCM\_SHA384 over TLS\_AES\_128\_GCM\_SHA256 when enabled.
* This release adds a sanity check for including wolfssl/options.h or

  user\_settings.h.

PR stands for Pull Request, and PR references a GitHub pull request

number where the code change was added.

## Vulnerabilities

* [Med] An OCSP (non stapling) issue was introduced in wolfSSL version 5.7.4

  when performing OCSP requests for intermediate certificates in a certificate

  chain. This affects only TLS 1.3 connections on the server side. It would not

  impact other TLS protocol versions or connections that are not using the

  traditional OCSP implementation. (Fix in pull request 8115)

## New Feature Additions

* Add support for RP2350 and improve RP2040 support, both with RNG optimizations

  (PR 8153)
* Add support for STM32MP135F, including STM32CubeIDE support and HAL support

  for SHA2/SHA3/AES/RNG/ECC optimizations. (PR 8223, 8231, 8241)
* Implement Renesas TSIP RSA Public Enc/Private support (PR 8122)
* Add support for Fedora/RedHat system-wide crypto-policies (PR 8205)
* Curve25519 generic keyparsing API added with wc\_Curve25519KeyToDer and

  wc\_Curve25519KeyDecode (PR 8129)
* CRL improvements and update callback, added the functions

  wolfSSL\_CertManagerGetCRLInfo and wolfSSL\_CertManagerSetCRLUpdate\_Cb (PR 8006)
* For DTLS, add server-side stateless and CID quality-of-life API. (PR 8224)

## Enhancements and Optimizations

* Add a CMake dependency check for pthreads when required. (PR 8162)
* Update OS\_Seed declarations for legacy compilers and FIPS modules (boundary

  not affected). (PR 8170)
* Enable WOLFSSL\_ALWAYS\_KEEP\_SNI by default when using --enable-jni. (PR 8283)
* Change the default cipher suite preference, prioritizing

  TLS\_AES\_256\_GCM\_SHA384 over TLS\_AES\_128\_GCM\_SHA256. (PR 7771)
* Add SRTP-KDF (FIPS module v6.0.0) to checkout script for release bundling

  (PR 8215)
* Make library build when no hardware crypto available for Aarch64 (PR 8293)
* Update assembly code to avoid `uint*_t` types for better compatibility with

  older C standards. (PR 8133)
* Add initial documentation for writing ASN template code to decode BER/DER.

  (PR 8120)
* Perform full reduction in sc\_muladd for EdDSA with Curve448 (PR 8276)
* Allow SHA-3 hardware cryptography instructions to be explicitly not used in

  MacOS builds (PR 8282)
* Make Kyber and ML-KEM available individually and together. (PR 8143)
* Update configuration options to include Kyber/ML-KEM and fix defines used in

  wolfSSL\_get\_curve\_name. (PR 8183)
* Make GetShortInt available with WOLFSSL\_ASN\_EXTRA (PR 8149)
* Improved test coverage and minor improvements of X509 (PR 8176)
* Add sanity checks for configuration methods, ensuring the inclusion of

  wolfssl/options.h or user\_settings.h. (PR 8262)
* Enable support for building without TLS (NO\_TLS). Provides reduced code size

  option for non-TLS users who want features like the certificate manager or

  compatibility layer. (PR 8273)
* Exposed get\_verify functions with OPENSSL\_EXTRA. (PR 8258)
* ML-DSA/Dilithium: obtain security level from DER when decoding (PR 8177)
* Implementation for using PKCS11 to retrieve certificate for SSL CTX (PR 8267)
* Add support for the RFC822 Mailbox attribute (PR 8280)
* Initialize variables and adjust types resolve warnings with Visual Studio in

  Windows builds. (PR 8181)
* Refactors and expansion of opensslcoexist build (PR 8132, 8216, 8230)
* Add DTLS 1.3 interoperability, libspdm and DTLS CID interoperability tests

  (PR 8261, 8255, 8245)
* Remove trailing error exit code in wolfSSL install setup script (PR 8189)
* Update Arduino files for wolfssl 5.7.4 (PR 8219)
* Improve Espressif SHA HW/SW mutex messages (PR 8225)
* Apply post-5.7.4 release updates for Espressif Managed Component examples

  (PR 8251)
* Expansion of c89 conformance (PR 8164)
* Added configure option for additional sanity checks with --enable-faultharden

  (PR 8289)
* Aarch64 ASM additions to check CPU features before hardware crypto instruction

  use (PR 8314)

## Fixes

* Fix a memory issue when using the compatibility layer with

  WOLFSSL\_GENERAL\_NAME and handling registered ID types. (PR 8155)
* Fix a build issue with signature fault hardening when using public key

  callbacks (HAVE\_PK\_CALLBACKS). (PR 8287)
* Fix for handling heap hint pointer properly when managing multiple WOLFSSL\_CTX

  objects and free’ing one of them (PR 8180)
* Fix potential memory leak in error case with Aria. (PR 8268)
* Fix Set\_Verify flag behaviour on Ada wrapper. (PR 8256)
* Fix a compilation error with the NO\_WOLFSSL\_DIR flag. (PR 8294)
* Resolve a corner case for Poly1305 assembly code on Aarch64. (PR 8275)
* Fix incorrect version setting in CSRs. (PR 8136)
* Correct debugging output for cryptodev. (PR 8202)
* Fix for benchmark application use with /dev/crypto GMAC auth error due to size

  of AAD (PR 8210)
* Add missing checks for the initialization of sp\_int/mp\_int with DSA to free

  memory properly in error cases. (PR 8209)
* Fix return value of wolfSSL\_CTX\_set\_tlsext\_use\_srtp (8252)
* Check Root CA by Renesas TSIP before adding it to ca-table (PR 8101)
* Prevent adding a certificate to the CA cache for Renesas builds if it does not

  set CA:TRUE in basic constraints. (PR 8060)
* Fix attribute certificate holder entityName parsing. (PR 8166)
* Resolve build issues for configurations without any wolfSSL/openssl

  compatibility layer headers. (PR 8182)
* Fix for building SP RSA small and RSA public only (PR 8235)
* Fix for Renesas RX TSIP RSA Sign/Verify with wolfCrypt only (PR 8206)
* Fix to ensure all files have settings.h included (like wc\_lms.c) and guards

  for building all `*.c` files (PR 8257 and PR 8140)
* Fix x86 target build issues in Visual Studio for non-Windows operating

  systems. (PR 8098)
* Fix wolfSSL\_X509\_STORE\_get0\_objects to handle no CA (PR 8226)
* Properly handle reference counting when adding to the X509 store. (PR 8233)
* Fix for various typos and improper size used with FreeRTOS\_bind in the Renesas

  example. Thanks to Hongbo for the report on example issues. (PR 7537)
* Fix for potential heap use after free with wolfSSL\_PEM\_read\_bio\_PrivateKey.

  Thanks to Peter for the issue reported. (PR 8139)

 Assets
4

 Loading

All reactions

## wolfSSL Release 5.7.4 (Oct 24, 2024)

25 Oct 22:00

![@JacobBarthelmeh](https://avatars.githubusercontent.com/u/7565298?s=40&v=4)
[JacobBarthelmeh](/JacobBarthelmeh)

[v5.7.4-stable](/wolfSSL/wolfssl/tree/v5.7.4-stable)

[`bdd6231`](/wolfSSL/wolfssl/commit/bdd62314f00fca0e216bf8c963c8eeff6327e0cb)

This commit was created on GitHub.com and signed with GitHub’s **verified signature**.

GPG key ID: B5690EEEBB952194

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/wolfSSL/wolfssl/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v5.7.4-stable)

 Loading

[View all tags](/wolfSSL/wolfssl/tags)

[wolfSSL Release 5.7.4 (Oct 24, 2024)](/wolfSSL/wolfssl/releases/tag/v5.7.4-stable)

# To download the release bundle of wolfSSL visit the download page at [www.wolfssl.com/download/](http://www.wolfssl.com/download/)

## Vulnerabilities

* [Low] When the OpenSSL compatibility layer is enabled, certificate

  verification behaved differently in wolfSSL than OpenSSL, in the

  X509\_STORE\_add\_cert() and X509\_STORE\_load\_locations() implementations.

  Previously, in cases where an application explicitly loaded an intermediate

  certificate, wolfSSL was verifying only up to that intermediate certificate,

  rather than verifying up to the root CA. This only affects use cases where the

  API is called directly, and does not affect TLS connections. Users that call

  the API X509\_STORE\_add\_cert() or X509\_STORE\_load\_locations() directly in their

  applications are recommended to update the version of wolfSSL used or to have

  additional sanity checks on certificates loaded into the X509\_STORE when

  verifying a certificate. ([#8087](https://github.com/wolfSSL/wolfssl/pull/8087))

## PQC TLS Experimental Build Fix

* When using TLS with post quantum algorithms enabled, the connection uses a

  smaller EC curve than agreed on. Users building with --enable-experimental and

  enabling PQC cipher suites with TLS connections are recommended to update the

  version of wolfSSL used. Thanks to Daniel Correa for the report.

  ([#8084](https://github.com/wolfSSL/wolfssl/pull/8084))

## New Feature Additions

* RISC-V 64 new assembly optimizations added for SHA-256, SHA-512, ChaCha20,

  Poly1305, and SHA-3 (PR 7758,7833,7818,7873,7916)
* Implement support for Connection ID (CID) with DTLS 1.2 (PR 7995)
* Add support for (DevkitPro)libnds (PR 7990)
* Add port for Mosquitto OSP (Open Source Project) (PR 6460)
* Add port for init sssd (PR 7781)
* Add port for eXosip2 (PR 7648)
* Add support for STM32G4 (PR 7997)
* Add support for MAX32665 and MAX32666 TPU HW and ARM ASM Crypto Callback

  Support (PR 7777)
* Add support for building wolfSSL to be used in libspdm (PR 7869)
* Add port for use with Nucleus Plus 2.3 (PR 7732)
* Initial support for RFC5755 x509 attribute certificates (acerts). Enabled with

  --enable-acert (PR 7926)
* PKCS#11 RSA Padding offload allows tokens to perform CKM\_RSA\_PKCS

  (sign/encrypt), CKM\_RSA\_PKCS\_PSS (sign), and CKM\_RSA\_PKCS\_OAEP (encrypt).

  (PR 7750)
* Added “new” and “delete” style functions for heap/pool allocation and freeing

  of low level crypto structures (PR 3166 and 8089)

## Enhancements and Optimizations

* Increase default max alt. names from 128 to 1024 (PR 7762)
* Added new constant time DH agree function wc\_DhAgree\_ct (PR 7802)
* Expanded compatibility layer with the API EVP\_PKEY\_is\_a (PR 7804)
* Add option to disable cryptocb test software test using

  --disable-cryptocb-sw-test (PR 7862)
* Add a call to certificate verify callback before checking certificate dates

  (PR 7895)
* Expanded algorithms supported with the wolfCrypt CSharp wrapper. Adding

  support for RNG, ECC(ECIES and ECDHE), RSA, ED25519/Curve25519, AES-GCM, and

  Hashing (PR 3166)
* Expand MMCAU support for use with DES ECB (PR 7960)
* Update AES SIV to handle multiple associated data inputs (PR 7911)
* Remove HAVE\_NULL\_CIPHER from --enable-openssh (PR 7811)
* Removed duplicate if(NULL) checks when calling XFREE (macro does) (PR 7839)
* Set RSA\_MIN\_SIZE default to 2048 bits (PR 7923)
* Added support for wolfSSL to be used as the default TLS in the zephyr kernel

  (PR 7731)
* Add enable provider build using --enable-wolfprovider with autotools (PR 7550)
* Renesas RX TSIP ECDSA support (PR 7685)
* Support DTLS1.3 downgrade when the server supports CID (PR 7841)
* Server-side checks OCSP even if it uses v2 multi (PR 7828)
* Add handling of absent hash params in PKCS7 bundle parsing and creation

  (PR 7845)
* Add the use of w64wrapper for Poly1305, enabling Poly1305 to be used in

  environments that do not have a word64 type (PR 7759)
* Update to the maxq10xx support (PR 7824)
* Add support for parsing over optional PKCS8 attributes (PR 7944)
* Add support for either side method with DTLS 1.3 (PR 8012)
* Added PKCS7 PEM support for parsing PEM data with BEGIN/END PKCS7 (PR 7704)
* Add CMake support for WOLFSSL\_CUSTOM\_CURVES (PR 7962)
* Add left-most wildcard matching support to X509\_check\_host() (PR 7966)
* Add option to set custom SKID with PKCS7 bundle creation (PR 7954)
* Building wolfSSL as a library with Ada and corrections to Alire manifest

  (PR 7303,7940)
* Renesas RX72N support updated (PR 7849)
* New option WOLFSSL\_COPY\_KEY added to always copy the key to the SSL object

  (PR 8005)
* Add the new option WOLFSSL\_COPY\_CERT to always copy the cert buffer for each

  SSL object (PR 7867)
* Add an option to use AES-CBC with HMAC for default session ticket enc/dec.

  Defaults to AES-128-CBC with HMAC-SHA256 (PR 7703)
* Memory usage improvements in wc\_PRF, sha256 (for small code when many

  registers are available) and sp\_int objects (PR 7901)
* Change in the configure script to work around ">>" with no command. In older

  /bin/sh it can be ambiguous, as used in OS’s such as FreeBSD 9.2 (PR 7876)
* Don't attempt to include system headers when not required (PR 7813)
* Certificates: DER encoding of ECC signature algorithm parameter is now

  allowed to be NULL with a define (PR 7903)
* SP x86\_64 asm: check for AVX2 support for VMs (PR 7979)
* Update rx64n support on gr-rose (PR 7889)
* Update FSP version to v5.4.0 for RA6M4 (PR 7994)
* Update TSIP driver version to v1.21 for RX65N RSK (PR 7993)
* Add a new crypto callback for RSA with padding (PR 7907)
* Replaced the use of pqm4 with wolfSSL implementations of Kyber/MLDSA

  (PR 7924)
* Modernized memory fence support for C11 and clang (PR 7938)
* Add a CRL error override callback (PR 7986)
* Extend the X509 unknown extension callback for use with a user context

  (PR 7730)
* Additional debug error tracing added with TLS (PR 7917)
* Added runtime support for library call stack traces with

  –enable-debug-trace-errcodes=backtrace, using libbacktrace (PR 7846)
* Expanded C89 conformance (PR 8077)
* Expanded support for WOLFSSL\_NO\_MALLOC (PR 8065)
* Added support for cross-compilation of Linux kernel module (PR 7746)
* Updated Linux kernel module with support for kernel 6.11 and 6.12 (PR 7826)
* Introduce WOLFSSL\_ASN\_ALLOW\_0\_SERIAL to allow parsing of certificates with a

  serial number of 0 (PR 7893)
* Add conditional repository\_owner to all wolfSSL GitHub workflows (PR 7871)

### Espressif / Arduino Updates

* Update wolfcrypt settings.h for Espressif ESP-IDF, template update (PR 7953)
* Update Espressif sha, util, mem, time helpers (PR 7955)
* Espressif \_thread\_local\_start and \_thread\_local\_end fix (PR 8030)
* Improve benchmark for Espressif devices (PR 8037)
* Introduce Espressif common CONFIG\_WOLFSSL\_EXAMPLE\_NAME, Kconfig (PR 7866)
* Add wolfSSL esp-tls and Certificate Bundle Support for Espressif ESP-IDF

  (PR 7936)
* Update wolfssl Release for Arduino (PR 7775)

### Post Quantum Crypto Updates

* Dilithium: support fixed size arrays in dilithium\_key (PR 7727)
* Dilithium: add option to use precalc with small sign (PR 7744)
* Allow Kyber to be built with FIPS (PR 7788)
* Allow Kyber asm to be used in the Linux kernel module (PR 7872)
* Dilithium, Kyber: Update to final specification (PR 7877)
* Dilithium: Support FIPS 204 Draft and Final Draft (PR 7909,8016)

### ARM Assembly Optimizations

* ARM32 assembly optimizations added for ChaCha20 and Poly1305 (PR 8020)
* Poly1305 assembly optimizations improvements for Aarch64 (PR 7859)
* Poly1305 assembly optimizations added for Thumb-2 (PR 7939)
* Adding ARM ASM build option to STM32CubePack (PR 7747)
* Add ARM64 to Visual Studio Project (PR 8010)
* Kyber assembly optimizations for ARM32 and Aarch64 (PR 8040,7998)
* Kyber assembly optimizations for ARMv7E-M/ARMv7-M (PR 7706)

## Fixes

* ECC key load: fixes for certificates with parameters that are not default for

  size (PR 7751)
* Fixes for building x86 in Visual Studio for non-windows OS (PR 7884)
* Fix for TLS v1.2 secret callback, incorrectly detecting bad master secret

  (PR 7812)
* Fixes for PowerPC assembly use with Darwin and SP math all (PR 7931)
* Fix for detecting older versions of Mac OS when trying to link with

  libdispatch (PR 7932)
* Fix for DTLS1.3 downgrade to DTLS1.2 when the server sends multiple handshake

  packets combined into a single transmission. (PR 7840)
* Fix for OCSP to save the request if it was stored in ssl->ctx->certOcspRequest

  (PR 7779)
* Fix to OCSP for searching for CA by key hash instead of ext. key id (PR 7934)
* Fix for staticmemory and singlethreaded build (PR 7737)
* Fix to not allow Shake128/256 with Xilinx AFALG (PR 7708)
* Fix to support PKCS11 without RSA key generation (PR 7738)
* Fix not calling the signing callback when using PK callbacks + TLS 1.3

  (PR 7761)
* Cortex-M/Thumb2 ASM fix label for IAR compiler (PR 7753)
* Fix with PKCS11 to iterate correctly over slotId (PR 7736)
* Stop stripping out the sequence header on the AltSigAlg extension (PR 7710)
* Fix ParseCRL\_AuthKeyIdExt with ASN template to set extAuthKeyIdSet value

  (PR 7742)
* Use max key length for PSK encrypt buffer size (PR 7707)
* DTLS 1.3 fix for size check to include headers and CID fixes (PR 7912,7951)
* Fix STM32 Hash FIFO and add support for STM32U5A9xx (PR 7787)
* Fix CMake build error for curl builds (PR 8021)
* SP Maths: PowerPC ASM fix to use XOR instead of LI (PR 8038)
* SSL loading of keys/certs: testing and fixes (PR 7789)
* Misc. fixes for Dilithium and Kyber (PR 7721,7765,7803,8027,7904)
* Fixes for building wolfBoot sources for PQ LMS/XMSS (PR 7868)
* Fixes for building with Kyber enabled using CMake and zephyr port (PR 7773)
* Fix for edge cases with session resumption with TLS 1.2 (PR 8097)
* Fix issue with ARM ASM with AES CFB/OFB not initializing the "left" member

  (PR 8099)

 Assets
4

 Loading

 👍
3
 Safari77, Megamouse, and HarbingerOfFire reacted with thumbs up emoji

All reactions

* 👍
  3 reactions

 3 people reacted

## wolfSSL Release 5.7.2 (July 8, 2024)

09 Jul 16:10

![@JacobBarthelmeh](https://avatars.githubusercontent.com/u/7565298?s=40&v=4)
[JacobBarthelmeh](/JacobBarthelmeh)

[v5.7.2-stable](/wolfSSL/wolfssl/tree/v5.7.2-stable)

[`00e4215`](/wolfSSL/wolfssl/commit/00e42151ca061463ba6a95adb2290f678cbca472)

This commit was created on GitHub.com and signed with GitHub’s **verified signature**.

GPG key ID: B5690EEEBB952194

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/wolfSSL/wolfssl/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v5.7.2-stable)

 Loading

[View all tags](/wolfSSL/wolfssl/tags)

[wolfSSL Release 5.7.2 (July 8, 2024)](/wolfSSL/wolfssl/releases/tag/v5.7.2-stable)

NOTE: \* --enable-heapmath is being deprecated and will be removed by end of 2024

## Vulnerabilities

* [Medium] [CVE-2024-1544](https://github.com/advisories/GHSA-grjj-54gm-q5vf "CVE-2024-1544")

  Potential ECDSA nonce side channel attack in versions of wolfSSL before 5.6.6 with wc\_ecc\_sign\_hash calls. Generating the ECDSA nonce k samples a random number r and then truncates this randomness with a modular reduction mod n where n is the order of the elliptic curve. Analyzing the division through a control-flow revealing side-channel reveals a bias in the most significant bits of k. Depending on the curve this is either a negligible bias or a significant bias large enough to reconstruct k with lattice reduction methods. Thanks to Luca Wilke, Florian Sieck and Thomas Eisenbarth (University of Lübeck) for reporting the vulnerability. Details will appear in the proceedings of CCS 24.

  Fixed [#7020](https://github.com/wolfSSL/wolfssl/pull/7020)
* [Medium] [CVE-2024-5288](https://github.com/advisories/GHSA-rrg9-cmw9-3pwx "CVE-2024-5288")

  A private key blinding operation, enabled by defining the macro WOLFSSL\_BLIND\_PRIVATE\_KEY, was added to mitigate a potential row hammer attack on ECC operations. If performing ECC private key operations in an environment where a malicious user could gain fine control over the device and perform row hammer style attacks it is recommended to update the version of wolfSSL used and to build with WOLFSSL\_BLIND\_PRIVATE\_KEY defined. Thanks to Kemal Derya, M. Caner Tol, Berk Sunar for the report (Vernam Applied Cryptography and Cybersecurity Lab at Worcester Polytechnic Institute)

  Fixed in github pull request [#7416](https://github.com/wolfSSL/wolfssl/pull/7416)
* [Low] When parsing a provided maliciously crafted certificate directly using wolfSSL API, outside of a TLS connection, a certificate with an excessively large number of extensions could lead to a potential DoS. There are existing sanity checks during a TLS handshake with wolfSSL which mitigate this issue. Thanks to Bing Shi for the report.

  Fixed in github pull request [#7597](https://github.com/wolfSSL/wolfssl/pull/7597)
* [Low] [CVE-2024-5991](https://github.com/advisories/GHSA-jwjf-h4v6-qrpp "CVE-2024-5991")

  In the function MatchDomainName(), input param str is treated as a NULL terminated string despite being user provided and unchecked. Specifically, the Openssl compatibility function X509\_check\_host() takes in a pointer and length to check against, with no requirements that it be NULL terminated. While calling without a NULL terminated string is very uncommon, it is still technically allowed. If a caller was attempting to do a name check on a non\*NULL terminated buffer, the code would read beyond the bounds of the input array until it found a NULL terminator.

  Fixed in github pull request [#7604](https://github.com/wolfSSL/wolfssl/pull/7604)
* [Medium] [CVE-2024-5814](https://github.com/advisories/GHSA-8cr7-x5g8-m3f3 "CVE-2024-5814")

  A malicious TLS1.2 server can force a TLS1.3 client with downgrade capability to use a ciphersuite that it did not agree to and achieve a successful connection. This is because, aside from the extensions, the client was skipping fully parsing the server hello when downgrading from TLS 1.3.

  Fixed in github pull request [#7619](https://github.com/wolfSSL/wolfssl/pull/7619)
* [Medium] OCSP stapling version 2 response verification bypass issue when a crafted response of length 0 is received. Found with internal testing.

  Fixed in github pull request [#7702](https://github.com/wolfSSL/wolfssl/pull/7702)
* [Medium] OCSP stapling version 2 revocation bypass with a retry of a TLS connection attempt. A revoked CA certificate could incorrectly be loaded into the trusted signers list and used in a repeat connection attempt. Found with internal testing.

  Fixed in github pull request [#7702](https://github.com/wolfSSL/wolfssl/pull/7702)

## New Feature Additions

* Added Dilithium/ML-DSA: Implementation of ML-DSA-44/65/87 (PR 7622)
* AES RISC-V 64-bit ASM: ECB/CBC/CTR/GCM/CCM (PR 7569)
* Added CUDA support for AES encryption (PR 7436)
* Added support for gRPC (PR 7445)
* Added function wc\_RsaPrivateKeyDecodeRaw to import raw RSA private keys (PR 7608)
* Added crypto callback for SHA-3 (PR 7670)
* Support for Infineon Modus Toolbox with wolfSSL (PR 7369)
* Allow user to send a user\_canceled alert by calling wolfSSL\_SendUserCanceled (PR 7590)
* C# wrapper SNI support added (PR 7610)
* Quantum-safe algorithm support added to the Linux kernel module (PR 7574)
* Support for NIST 800-56C Option 1 KDF, using the macro WC\_KDF\_NIST\_SP\_800\_56C added (PR 7589)
* AES-XTS streaming mode added, along with hardware acceleration and kernel module use (PR 7522, 7560, 7424)
* PlatformIO FreeRTOS with ESP build and addition of benchmark and test example applications (PR 7528, 7413, 7559, 7542)

## Enhancements and Optimizations

* Expanded STM32 AES hardware acceleration support for use with STM32H5 (PR 7578)
* Adjusted wc\_xmss and wc\_lms settings to support use with wolfBoot (PR 7393)
* Added the --enable-rpk option to autotools build for using raw public key support (PR 7379)
* SHA-3 Thumb2, ARM32 assembly implementation added (PR 7667)
* Improvements to RSA padding to expose Pad/Unpad APIs (PR 7612)
* Updates and API additions for supporting socat version 1.8.0.0 (PR 7594)
* cmake build improvements, expanding build options with SINGLE\_THREADED and post-quantum algorithms, adjusting the generation of options.h file and using “yes;no” boolean instead of strings (PR 7611, 7546, 7479, 7480, 7380)
* Improvements for Renesas RZ support (PR 7474)
* Improvements to dual algorithm certificates for post-quantum keys (PR 7286)
* Added wolfSSL\_SessionIsSetup so the user can check if a session ticket has been sent by the server (PR 7430)
* hostap updates: Implement PACs for EAP-FAST and filter cipher list on TLS version change (PR 7446)
* Changed subject name comparison to match different upper and lower cases (PR 7420)
* Support for DTLS 1.3 downgrade when using PSK (PR 7367)
* Update to static memory build for more generic memory pools used (PR 7418)
* Improved performance of Kyber C implementation (PR 7654)
* Support for ECC\_CACHE\_CURVE with no malloc (PR 7490)
* Added the configure option --enable-debug-trace-errcodes (macro WOLFSSL\_DEBUG\_TRACE\_ERROR\_CODES) which enables more debug tracking of error code values (PR 7634)
* Enhanced wc\_MakeRsaKey and wc\_RsaKeyToDer to work with WOLFSSL\_NO\_MALLOC (PR 7362)
* Improvements to assembly implementations of ChaCha20 and Poly1305 ASM for use with MSVC (PR 7319)
* Cortex-M inline assembly labels with unique number appended (PR 7649)
* Added secret logging callback to TLS <= 1.2, enabled with the macro HAVE\_SECRET\_CALLBACK (PR 7372)
* Made wc\_RNG\_DRBG\_Reseed() a public wolfCrypt API (PR 7386)
* Enabled DES3 support without the DES3 ciphers. To re-enable DES3 cipher suites, use the configure flag --enable-des3-tls-suites (PR 7315)
* Added stubs required for latest nginx (1.25.5) (PR 7449)
* Added option for using a custom salt with the function wc\_ecc\_ctx\_set\_own\_salt (PR 7552)
* Added PQ files for Windows (PR 7419)
* Enhancements to static memory feature, adding the option for a global heap hint (PR 7478) and build options for a lean or debug setting, enabled with --enable-staticmemory=small or --enable-staticmemory=debug (PR 7597)
* Updated --enable-jni to define SESSION\_CERTS for wolfJSSE (PR 7557)
* Exposed DTLS in Ada wrapper and updated examples (PR 7397)
* Added additional minimum TLS extension size sanity checks (PR 7602)
* ESP improvements: updating the examples and libraries, updates for Apple HomeKit SHA/SRP, and fix for endianness with SHA512 software fallback (PR 7607, 7392, 7505, 7535)
* Made the wc\_CheckCertSigPubKey API publicly available with the define of the macro WOLFSSL\_SMALL\_CERT\_VERIFY (PR 7599)
* Added an alpha/preview of additional FIPS 140-3 full submission, bringing additional algorithms such as SRTP-KDF, AES-XTS, GCM streaming, AES-CFB, ED25519, and ED448 into the FIPS module boundary (PR 7295)
* XCODE support for v5.2.3 of the FIPS module (PR 7140)
* Expanded OpenSSL compatibility layer and added EC\_POINT\_hex2point (PR 7191)

## Fixes

* Fixed Kyber control-flow timing leak. Thanks to Antoon Purnal from PQShield for the report.
* Fixed the NXP MMCAU HW acceleration for SHA-256 (PR 7389)
* Fixed AES-CFB1 encrypt/decrypt on size (8\*x-1) bits (PR 7431)
* Fixed use of %rip with SHA-256 x64 assembly (PR 7409)
* Fixed OCSP response message build for DTLS (PR 7671)
* Handled edge case in wc\_ecc\_mulmod() with zero (PR 7532)
* Fixed RPK (Raw Public Key) to follow certificate use correctly (PR 7375)
* Added sanity check on record header with QUIC use (PR 7638)
* Added sanity check for empty directory strings in X.509 when parsing (PR 7669)
* Added sanity check on non-conforming serial number of 0 in certificates being parsed (PR 7625)
* Fixed wolfSSL\_CTX\_set1\_sigalgs\_list() to make the TLS connection conform to the selected sig hash algorithm (PR 7693)
* Various fixes for dual algorithm certificates including small stack use and support for Certificate Signing Requests (PR 7577)
* Added sanity check for critical policy extension when wolfSSL is built without policy extension support enabled (PR 7388)
* Added sanity check that the ed25519 signature is smaller than the order (PR 7513)
* Fixed Segger emNet to handle non-blocking want read/want write (PR 7581)

 Assets
4

 Loading

 👍
8
 Burnett01, Safari77, xplshn, M0nteCarl0, nevmerzhitsky, rdmark, petecooper, and aidangarske reacted with thumbs up emoji

All reactions

* 👍
  8 reactions

 8 people reacted

## wolfSSL Release 5.7.0 (Mar 20, 2024)

21 Mar 14:54

![@JacobBarthelmeh](https://avatars.githubusercontent.com/u/7565298?s=40&v=4)
[JacobBarthelmeh](/JacobBarthelmeh)

[v5.7.0-stable](/wolfSSL/wolfssl/tree/v5.7.0-stable)

[`8970ff4`](/wolfSSL/wolfssl/commit/8970ff4c34034dbb3594943d11f8c9d4c5512bd5)

This commit was created on GitHub.com and signed with GitHub’s **verified signature**.

GPG key ID: B5690EEEBB952194

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/wolfSSL/wolfssl/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v5.7.0-stable)

 Loading

[View all tags](/wolfSSL/wolfssl/tags)

[wolfSSL Release 5.7.0 (Mar 20, 2024)](/wolfSSL/wolfssl/releases/tag/v5.7.0-stable)

NOTE: \* --enable-heapmath is being deprecated and will be removed by end of 2024

NOTE: In future releases, --enable-des3 (which is disabled by default) will be insufficient in itself to enable DES3 in TLS cipher suites. A new option, --enable-des3-tls-suites, will need to be supplied in addition. This option should only be used in backward compatibility scenarios, as it is inherently insecure.

NOTE: This release switches the default ASN.1 parser to the new ASN template code. If the original ASN.1 code is preferred define `WOLFSSL_ASN_ORIGINAL` to use it. See PR [#7199](https://github.com/wolfSSL/wolfssl/pull/7199).

## Vulnerabilities

* [High] [CVE-2024-0901](https://github.com/advisories/GHSA-qrv4-68mg-fv43 "CVE-2024-0901") Potential denial of service and out of bounds read. Affects TLS 1.3 on the server side when accepting a connection from a malicious TLS 1.3 client. If using TLS 1.3 on the server side it is recommended to update the version of wolfSSL used. Fixed in this GitHub pull request [#7099](https://github.com/wolfSSL/wolfssl/pull/7099)
* [Med] [CVE-2024-1545](https://github.com/advisories/GHSA-9chr-m38j-w26g "CVE-2024-1545") Fault Injection vulnerability in RsaPrivateDecryption function that potentially allows an attacker that has access to the same system with a victims process to perform a Rowhammer fault injection. Thanks to Junkai Liang, Zhi Zhang, Xin Zhang, Qingni Shen for the report (Peking University, The University of Western Australia)."

  Fixed in this GitHub pull request [#7167](https://github.com/wolfSSL/wolfssl/pull/7167)
* [Med] Fault injection attack with EdDSA signature operations. This affects ed25519 sign operations where the system could be susceptible to Rowhammer attacks. Thanks to Junkai Liang, Zhi Zhang, Xin Zhang, Qingni Shen for the report (Peking University, The University of Western Australia).

  Fixed in this GitHub pull request [#7212](https://github.com/wolfSSL/wolfssl/pull/7212)

## New Feature Additions

* Added --enable-experimental configure flag to gate out features that are currently experimental. Now liboqs, kyber, lms, xmss, and dual-alg-certs require the --enable-experimental flag.

### POST QUANTUM SUPPORT ADDITIONS

* Experimental framework for using wolfSSL’s XMSS implementation (PR 7161)
* Experimental framework for using wolfSSL’s LMS implementation (PR 7283)
* Experimental wolfSSL Kyber implementation and assembly optimizations, enabled with --enable-experimental --enable-kyber (PR 7318)
* Experimental support for post quantum dual key/signature certificates. A few known issues and sanitizer checks are in progress with this feature. Enabled with the configure flags --enable-experimental --enable-dual-alg-certs (PR 7112)
* CryptoCb support for PQC algorithms (PR 7110)

### OTHER FEATURE ADDITIONS

* The Linux kernel module now supports registration of AES-GCM, AES-XTS, AES-CBC, and AES-CFB with the kernel cryptosystem through the new --enable-linuxkm-lkcapi-register option, enabling automatic use of wolfCrypt implementations by the dm-crypt/luks and ESP subsystems. In particular, wolfCrypt AES-XTS with –enable-aesni is faster than the native kernel implementation.
* CryptoCb hook to one-shot CMAC functions (PR 7059)
* BER content streaming support for PKCS7\_VerifySignedData and sign/encrypt operations (PR 6961 & 7184)
* IoT-Safe SHA-384 and SHA-512 support (PR 7176)
* I/O callbacks for content and output with PKCS7 bundle sign/encrypt to reduce peak memory usage (PR 7272)
* Microchip PIC24 support and example project (PR 7151)
* AutoSAR shim layer for RNG, SHA256, and AES (PR 7296)
* wolfSSL\_CertManagerUnloadIntermediateCerts API to clear intermediate certs added to certificate store (PR 7245)
* Implement SSL\_get\_peer\_signature\_nid and SSL\_get\_peer\_signature\_type\_nid (PR 7236)

## Enhancements and Optimizations

* Remove obsolete user-crypto functionality and Intel IPP support (PR 7097)
* Support for RSA-PSS signatures with CRL use (PR 7119)
* Enhancement for AES-GCM use with Xilsecure on Microblaze (PR 7051)
* Support for crypto cb only build with ECC and NXP CAAM (PR 7269)
* Improve liboqs integration adding locking and init/cleanup functions (PR 7026)
* Prevent memory access before clientSession->serverRow and clientSession->serverIdx are sanitized (PR 7096)
* Enhancements to reproducible build (PR 7267)
* Update Arduino example TLS Client/Server and improve support for ESP32 (PR 7304 & 7177)
* XC32 compiler version 4.x compatibility (PR 7128)
* Porting for build on PlayStation 3 and 4 (PR 7072)
* Improvements for Espressif use; SHA HW/SW selection and use on ESP32-C2/ESP8684, wolfSSL\_NewThread() type, component cmake fix, and update TLS client example for ESP8266 (PR 7081, 7173, 7077, 7148, 7240)
* Allow crypto callbacks with SHA-1 HW (PR 7087)
* Update OpenSSH port to version 9.6p1(PR 7203)
* ARM Thumb2 enhancements, AES-GCM support for GCM\_SMALL, alignment fix on key, fix for ASM clobber list (PR 7291,7301,7221)
* Expand heap hint support for static memory build with more x509 functions (PR 7136)
* Improving ARMv8 ChaCha20 ASM (alignment) (PR 7182)
* Unknown extension callback wolfSSL\_CertManagerSetUnknownExtCallback added to CertManager (PR 7194)
* Implement wc\_rng\_new\_ex for use with devID’s with crypto callback (PR 7271)
* Allow reading 0-RTT data after writing 0.5-RTT data (PR 7102)
* Send alert on bad PSK binder error (PR 7235)
* Enhancements to CMake build files for use with cross compiling (PR 7188)

## Fixes

* Fix for checking result of MAC verify when no AAD is used with AES-GCM and Xilinx Xilsecure (PR 7051)
* Fix for Aria sign use (PR 7082)
* Fix for invalid `dh_ffdhe_test` test case using Intel QuickAssist (PR 7085)
* Fixes for TI AES and SHA on TM4C with HW acceleration and add full AES GCM and CCM support with TLS (PR 7018)
* Fixes for STM32 PKA use with ECC (PR 7098)
* Fixes for TLS 1.3 with crypto callbacks to offload KDF / HMAC operation (PR 7070)
* Fix include path for FSP 3.5 on Renesas RA6M4 (PR 7101)
* Siphash x64 asm fix for use with older compilers (PR 7299)
* Fix for SGX build with SP (PR 7308)
* Fix to Make it mandatory that the cookie is sent back in new ClientHello when seen in a HelloRetryRequest with (PR 7190)
* Fix for wrap around behavior with BIO pairs (PR 7169)
* OCSP fixes for parsing of response correctly when there was a revocation reason and returning correct error value with date checks (PR 7241 & 7255)
* Fix build with `NO_STDIO_FILESYSTEM` and improve checks for `XGETENV` (PR 7150)
* Fix for DTLS sequence number and cookie when downgrading DTLS version (PR 7214)
* Fix for write\_dup use with chacha-poly cipher suites (PR 7206)
* Fix for multiple handshake messages in one record failing with OUT\_OF\_ORDER\_E when downgrading from TLS 1.3 to TLS 1.2 (PR 7141)
* Fix for AES ECB build with Thumb and alignment (PR 7094)
* Fix for negotiate handshake until the end in wolfSSL\_read/wolfSSL\_write if hitting an edge case with want read/write (PR 7237)

 Assets
3

 Loading

 👍
3
 Safari77, Irvise, and bondolo reacted with thumbs up emoji
 🚀
4
 vaygr, blunext, omasanori, and ZDibLO reacted with rocket emoji

All reactions

* 👍
  3 reactions
* 🚀
  4 reactions

 7 people reacted

## wolfSSL Release 5.6.6 (Dec 19, 2023)

19 Dec 22:08

![@cconlon](https://avatars.githubusercontent.com/u/302241?s=40&v=4)
[cconlon](/cconlon)

[v5.6.6-stable](/wolfSSL/wolfssl/tree/v5.6.6-stable)

[`66596ad`](/wolfSSL/wolfssl/commit/66596ad9e1d7efa8479656872cf09c9c1870a02e)

This commit was created on GitHub.com and signed with GitHub’s **verified signature**.
The key has expired.

GPG key ID: 4AEE18F83AFDEB23
Expired

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/wolfSSL/wolfssl/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v5.6.6-stable)

 Loading

[View all tags](/wolfSSL/wolfssl/tags)

[wolfSSL Release 5.6.6 (Dec 19, 2023)](/wolfSSL/wolfssl/releases/tag/v5.6.6-stable)

NOTE: \* --enable-heapmath is being deprecated and will be removed by 2024

REMINDER: When working with AES Block Cipher algorithms, `wc_AesInit()` should always be called first to initialize the `Aes` structure, before calling other Aes API functions. Recently we found several places in our documentation, comments, and codebase where this pattern was not observed. We have since fixed this omission in several PRs for this release.

## Vulnerabilities

* [Medium] [CVE-2023-6935](https://github.com/advisories/GHSA-r36f-f47x-637q "CVE-2023-6935"): After review of the previous RSA timing fix in wolfSSL 5.6.4, additional changes were found to be required. A complete resistant change is delivered in this release. This fix is for the Marvin attack, leading to being able to decrypt a saved TLS connection and potentially forge a signature after probing with a very large number of trial connections. This issue is around RSA decryption and affects the optional static RSA cipher suites on the server side, which are considered weak, not recommended to be used and are off by default in wolfSSL (even with `--enable-all`). Static RSA cipher suites were also removed from the TLS 1.3 protocol and are only present in TLS 1.2 and lower. All padding versions of RSA decrypt are affected since the code under review is outside of the padding processing. Information about the private keys is NOT compromised in affected code. It is recommended to disable static RSA cipher suites and update the version of wolfSSL used if using RSA private decryption alone outside of TLS. Thanks to Hubert Kario for the report. The fix for this issue is located in the following GitHub Pull Request: [#6955](https://github.com/wolfSSL/wolfssl/pull/6955).
* [Low] [CVE-2023-6936](https://github.com/advisories/GHSA-cwpg-8775-j56v "CVE-2023-6936"): A potential heap overflow read is possible in servers connecting over TLS 1.3 when the optional `WOLFSSL_CALLBACKS` has been defined. The out of bounds read can occur when a server receives a malicious malformed ClientHello. Users should either discontinue use of `WOLFSSL_CALLBACKS` on the server side or update versions of wolfSSL to 5.6.6. Thanks to the tlspuffin fuzzer team for the report which was designed and developed by; Lucca Hirschi (Inria, LORIA), Steve Kremer (Inria, LORIA), and Max Ammann (Trail of Bits). The fix for this issue is located in the following GitHub Pull Request: [#6949](https://github.com/wolfSSL/wolfssl/pull/6949).
* [Low] A side channel vulnerability with AES T-Tables is possible in a very controlled environment where precision sub-cache-line inspection can happen, such as inside an Intel SGX enclave. This can lead to recovery of the AES key. To prevent this type of attack, wolfSSL added an AES bitsliced implementation which can be enabled with the “`--enable-aes-bitsliced`” configure option. Thanks to Florian Sieck, Zhiyuan Zhang, Sebastian Berndt, Chitchanok Chuengsatiansup, Thomas Eisenbarth, and Yuval Yarom for the report (Universities of Lübeck, Melbourne, Adelaide and Bochum). The fix for this issue is located in the following GitHub Pull Request: [#6854](https://github.com/wolfSSL/wolfssl/pull/6854).
* [Low] [CVE-2023-6937](https://github.com/advisories/GHSA-ff3x-q8pg-rh37 "CVE-2023-6937"): wolfSSL prior to 5.6.6 did not check that messages in a single (D)TLS record do not span key boundaries. As a result, it was possible to combine (D)TLS messages using different keys into one (D)TLS record. The most extreme edge case is that, in (D)TLS 1.3, it was possible that an unencrypted (D)TLS 1.3 record from the server containing first a ServerHello message and then the rest of the first server flight would be accepted by a wolfSSL client. In (D)TLS 1.3 the handshake is encrypted after the ServerHello but a wolfSSL client would accept an unencrypted flight from the server. This does not compromise key negotiation and authentication so it is assigned a low severity rating. Thanks to Johannes Wilson for the report (Sectra Communications and Linköping University). The fix for this issue is located in the following GitHub Pull Request: [#7029](https://github.com/wolfSSL/wolfssl/pull/7029).

## New Feature Additions

* Build option for disabling CRL date checks (`WOLFSSL_NO_CRL_DATE_CHECK`) (PR 6927)
* Support for STM32WL55 and improvements to PKA ECC support (PR 6937)
* Add option to skip cookie exchange on DTLS 1.3 session resumption (PR 6929)
* Add implementation of SRTP KDF and SRTCP KDF (`--enable-srtp-kdf`) (PR 6888)
* Add `wolfSSL_EXTENDED_KEY_USAGE_free()` (PR 6916)
* Add AES bitsliced implementation that is cache attack safe (`--enable-aes-bitsliced`) (PR 6854)
* Add memcached support and automated testing (PR 6430, 7022)
* Add Hardware Encryption Acceleration for ESP32-C3, ESP32-C6, and ESP32-S2 (PR 6990)
* Add (D)TLS 1.3 support for 0.5-RTT data (PR 7010)

## Enhancements and Optimizations

* Better built in testing of “`--sys-ca-certs`” configure option (PR 6910)
* Updated CMakeLists.txt for Espressif wolfSSL component usage (PR 6877)
* Disable TLS 1.1 by default (unless SSL 3.0 or TLS 1.0 is enabled) (PR 6946)
* Add “`--enable-quic`” to “`--enable-all`” configure option (PR 6957)
* Add support to SP C implementation for RSA exponent up to 64-bits (PR 6959)
* Add result of “`HAVE___UINT128_T`” to options.h for CMake builds (PR 6965)
* Add optimized assembly for AES-GCM on ARM64 using hardware crypto instructions (PR 6967)
* Add built-in cipher suite tests for DTLS 1.3 PQC (PR 6952)
* Add wolfCrypt test and unit test to ctest (PR 6977)
* Move OpenSSL compatibility crypto APIs into `ssl_crypto.c` file (PR 6935)
* Validate time generated from XGMTIME() (PR 6958)
* Allow wolfCrypt benchmark to run with microsecond accuracy (PR 6868)
* Add GitHub Actions testing with nginx 1.24.0 (PR 6982)
* Allow encoding of CA:FALSE BasicConstraint during cert generation (PR 6953)
* Add CMake option to enable DTLS-SRTP (PR 6991)
* Add CMake options for enabling QUIC and cURL (PR 7049)
* Improve RSA blinding to make code more constant time (PR 6955)
* Refactor AES-NI implementation macros to allow dynamic fallback to C (PR 6981)
* Default to native Windows threading API on MinGW (PR 7015)
* Return better error codes from OCSP response check (PR 7028)
* Updated Espressif ESP32 TLS client and server examples (PR 6844)
* Add/clean up support for ESP-IDF v5.1 for a variety of ESP32 chips (PR 7035, 7037)
* Add API to choose dynamic certs based on client ciphers/sigalgs (PR 6963)
* Improve Arduino IDE 1.5 project file to match recursive style (PR 7007)
* Simplify and improve apple-universal build script (PR 7025)

## Fixes

* Fix for async edge case with Intel QuickAssist/Cavium Nitrox (PR 6931)
* Fix for building PKCS#7 with RSA disabled (PR 6902)
* Fix for advancing output pointer in `wolfSSL_i2d_X509()` (PR 6891)
* Fix for `EVP_EncodeBlock()` appending a newline (PR 6900)
* Fix for `wolfSSL_RSA_verify_PKCS1_PSS()` with `RSA_PSS_SALTLEN_AUTO` (PR 6938)
* Fixes for CODESonar reports around `isalpha()` and `isalnum()` calls (PR 6810)
* Fix for SP ARM64 integer math to avoid compiler optimization issues (PR 6942)
* Fix for SP Thumb2 inline assembly to add IAR build support (PR 6943, 6971)
* Fix for SP Thumb2 to make functions not inlined (PR 6993)
* Fix for SP Cortex-M assembly large build with IAR (PR 6954)
* Fix for SP ARM64 assembly montgomery reduction by 4 (PR 6947)
* Fix for SP ARM64 P-256 for not inlining functions for iOS compatibility (PR 6979)
* Fix for `WOLFSSL_CALLBACKS` and potential memory error (PR 6949)
* Fixes for wolfSSL’s Zephyr OS port (PR 6930)
* Fix for build errors when building for NXP mmCAU (`FREESCALE_MMCAU`) (PR 6970)
* Fix for TLS 1.3 `SendBuffered()` return code in non-blocking mode (PR 7001)
* Fix for TLS `Hmac_UpdateFinal()` when padding byte is invalid (PR 6998)
* Fix for ARMv8 AES-GCM streaming to check size of IV before storing (PR 6996)
* Add missing calls to `wc_AesInit()` before `wc_AesSetKey()` (PR 7011)
* Fix build errors with DTLS 1.3 enabled but TLS 1.2 disabled (PR 6976)
* Fixes for building wolfSSL in Visual Studio (PR 7040)

 Assets
6

 Loading

 👍
4
 Safari77, Keinahas, shove70, and petecooper reacted with thumbs up emoji

All reactions

* 👍
  4 reactions

 4 people reacted

## wolfSSL Release 5.6.4 (October 30, 2023)

30 Oct 19:20

![@JacobBarthelmeh](https://avatars.githubusercontent.com/u/7565298?s=40&v=4)
[JacobBarthelmeh](/JacobBarthelmeh)

[v5.6.4-stable](/wolfSSL/wolfssl/tree/v5.6.4-stable)

[`37884f8`](/wolfSSL/wolfssl/commit/37884f864d6fd9b04f44677cb04da15d0c9d6526)

This commit was created on GitHub.com and signed with GitHub’s **verified signature**.
The key has expired.

GPG key ID: 4AEE18F83AFDEB23
Expired

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/wolfSSL/wolfssl/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v5.6.4-stable)

 Loading

[View all tags](/wolfSSL/wolfssl/tags)

[wolfSSL Release 5.6.4 (October 30, 2023)](/wolfSSL/wolfssl/releases/tag/v5.6.4-stable)

NOTE: \* --enable-heapmath is being deprecated and will be removed by 2024

\* Old CyaSSL/CtaoCrypt shim layer was removed in this release (5.6.4)

## Vulnerabilities

* [Medium] A fix was added, but still under review for completeness, for a Bleichenbacher style attack, leading to being able to decrypt a saved TLS connection and potentially forge a signature after probing with a large number of trial connections. This issue is around RSA decryption and affects static RSA cipher suites on the server side, which are not recommended to be used and are off by default. Static RSA cipher suites were also removed from the TLS 1.3 protocol and only present in TLS 1.2 and lower. All padding versions of RSA decrypt are affected since the code under review is outside of the padding processing. Information about the private keys is NOT compromised in affected code. It's recommended to disable static RSA cipher suites and update the version of wolfSSL used if using RSA private decryption alone outside of TLS. The fix is located in this pull request ([#6896](https://github.com/wolfSSL/wolfssl/pull/6896))

## New Feature Additions

* DTLS 1.3 PQC: support fragmenting the second ClientHello message. This allows arbitrarily long keys to be used, opening up support for all PQC ciphersuites in DTLS 1.3.
* SM2/SM3/SM4: Chinese cipher support including TLS 1.3 and 1.2 cipher suites. SM2 SP implementation available.
* Ability to parse ASN1 only with SMIME\_read\_PKCS7
* Added support for MemUse Entropy on Windows
* Added Ada Bindings for wolfSSL
* Added a PEM example that converts to and from DER/PEM.
* Added LMS/HSS and XMSS/XMSS^MT wolfcrypt hooks, both normal and verify-only options.
* Added support for the AES EAX mode of operation
* Port for use with Hitch (<https://github.com/varnish/hitch>) added
* Add XTS API's to handle multiple sectors in new port ot VeraCrypt

## Enhancements and Optimizations

* Turned on SNI by default on hosts with resources
* Improved support for Silicon Labs Simplicity Studio and the ERF32 Gecko SDK
* Thumb-2 and ARM32 Curve25519 and Ed25519 assembly have significantly improved performance.
* Thumb-2 AES assembly code added.
* Thumb-2 and ARM32 SP implementations of RSA, DH and ECC have significantly improved performance.
* Minor performance improvements to SP ECC for Intel x64.
* AES-XTS assembly code added for Intel x64, Aarch64 and ARM32.
* Added support for X963 KDFs to ECIES.
* Added 32-bit type only implementation of AES GMULT using tables.
* Add support for nginx version 1.25.0
* Add support for Kerberos version 5 1.21.1
* Check all CRL entries in case a single issuer has multiple CRL's loaded
* CRL verify the entire chain including loaded CA's
* Added example for building wolfSSL as an Apple universal binary framework using configure
* Sniffer tool now supports decrypting TLS sessions using secrets obtained from a SSLKEYLOGFILE
* Updates made for EBSNET port
* Update "--enable-jni" to include additional defines for expanded JNI support. Also includes JCE and JSSE builds under the single enable option now.

## Fixes

* Fixed error handling when decrypted pre-master secret is too long when using static RSA.
* Added a fix for keymod use with i.MX RT1170 CAAM blobs
* Added a fix for AES-GCM use with Petalinux Xilinx
* Fixed `wc_SignatureGenerate_ex` to not call verify twice
* Fixed wolfCrypt FIPS DLL on Win32
* Fixed TFM math library big-endian reading implementation when a zero length buffer is passed in.
* Fixed NO\_CERT configurations to build correctly.
* Fixed ARM AES-GCM streaming assembly when –enable-opensslextra defined.
* Added modulus checks to heap math implementation of mp\_exptmod().
* Fixed Windows assembly code to handle that certain XMM registers are non-volatile.
* Aarch64 SP ECC implementation of sp\_256\_mont\_dbl\_4 has the register list for the assembly code fixed to include all used registers.
* mp\_sqrt\_mod\_prime fixed to limit the number of iterations of a loop to handle malicious non-prime values being passed in.
* Ignore session ID's shorter than 32 bytes instead of erroring out

 Assets
10

 Loading

 👍
4
 Safari77, dBarmpxkos, tamasan238, and 1756816846 reacted with thumbs up emoji
 🎉
2
 iyanmv and Keinahas reacted with hooray emoji

All reactions

* 👍
  4 reactions
* 🎉
  2 reactions

 6 people reacted

## wolfSSL Release 5.6.3 (June 20, 2023)

21 Jun 01:04

![@ejohnstown](https://avatars.githubusercontent.com/u/896278?s=40&v=4)
[ejohnstown](/ejohnstown)

[v5.6.3-stable](/wolfSSL/wolfssl/tree/v5.6.3-stable)

This tag was signed with the committer’s **verified signature**.

[![](https://avatars.githubusercontent.com/u/896278?s=64&v=4)](/ejohnstown)
[ejohnstown](/ejohnstown)
John Safranek

GPG key ID: 8CE817DE0D3CCB4A

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

[`3b3c175`](/wolfSSL/wolfssl/commit/3b3c175af0e993ffaae251871421e206cc41963f)

This commit was created on GitHub.com and signed with GitHub’s **verified signature**.
The key has expired.

GPG key ID: 4AEE18F83AFDEB23
Expired

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/wolfSSL/wolfssl/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v5.6.3-stable)

 Loading

[View all tags](/wolfSSL/wolfssl/tags)

[wolfSSL Release 5.6.3 (June 20, 2023)](/wolfSSL/wolfssl/releases/tag/v5.6.3-stable)

Release 5.6.3 of wolfSSL embedded TLS has 4 bug fixes:

* Fix for setting the atomic macro options introduced in release 5.6.2. This issue affects GNU gcc autoconf builds. The fix resolves a potential mismatch of the generated macros defined in options.h file and the macros used when the wolfSSL library is compiled. In version 5.6.2 this mismatch could result in unstable runtime behavior.
* Fix for invalid suffix error with Windows build using the macro GCM\_TABLE\_4BIT.
* Improvements to Encrypted Memory support (WC\_PROTECT\_ENCRYPTED\_MEM) implementations for modular exponentiation in SP math-all (sp\_int.c) and TFM (tfm.c).
* Improvements to SendAlert for getting output buffer.

 Assets
4

 Loading

 👍
7
 houseme, Safari77, SilmorSenedlen, shove70, julek-wolfssl, Keinahas, and Integral-07 reacted with thumbs up emoji

All reactions

* 👍
  7 reactions

 7 people reacted

## wolfSSL Release 5.6.2 (Jun 09, 2023)

09 Jun 20:13

![@JacobBarthelmeh](https://avatars.githubusercontent.com/u/7565298?s=40&v=4)
[v5.6.2-stable](/wolfSSL/wolfssl/tree/v5.6.2-stable)

[`9ffa9fa`](/wolfSSL/wolfssl/commit/9ffa9faecda87a7c0ce7521c83996c65d4e86943)

This commit was created on GitHub.com and signed with GitHub’s **verified signature**.
The key has expired.

GPG key ID: 4AEE18F83AFDEB23
Expired

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/wolfSSL/wolfssl/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v5.6.2-stable)

 Loading

[View all tags](/wolfSSL/wolfssl/tags)

[wolfSSL Release 5.6.2 (Jun 09, 2023)](/wolfSSL/wolfssl/releases/tag/v5.6.2-stable)

Release 5.6.2 has been developed according to wolfSSL's development and QA process (see link below) and successfully passed the quality criteria.

<https://www.wolfssl.com/about/wolfssl-software-development-process-quality-assurance>

NOTE: \* --enable-heapmath is being deprecated and will be removed by 2024

Release 5.6.2 of wolfSSL embedded TLS has bug fixes and new features including:

## Vulnerabilities

* [Low] In cases where a malicious agent could analyze cache timing at a very detailed level, information about the AES key used could be leaked during T/S Box lookups. One such case was shown on RISC-V hardware using the MicroWalk tool (<https://github.com/microwalk-project/Microwalk>). A hardened version of T/S Box lookups was added in wolfSSL to help mitigate this potential attack and is now on by default with RISC-V builds and can be enabled on other builds if desired by compiling wolfSSL with the macro WOLFSSL\_AES\_TOUCH\_LINES. Thanks to Jan Wichelmann, Christopher Peredy, Florian Sieck, Anna Pätschke, Thomas Eisenbarth (University of Lübeck): MAMBO-V: Dynamic Side-Channel Leakage Analysis on RISC-V. Fixed in the following GitHub pull request [#6309](https://github.com/wolfSSL/wolfssl/pull/6309)
* [High] In previous versions of wolfSSL if a TLS 1.3 client gets neither a PSK (pre shared key) extension nor a KSE (key share extension) when connecting to a malicious server, a default predictable buffer gets used for the IKM value when generating the session master secret. Using a potentially known IKM value when generating the session master secret key compromises the key generated, allowing an eavesdropper to reconstruct it and potentially allowing surreptitious access to or meddling with message contents in the session. This issue does not affect client validation of connected servers, nor expose private key information, but could result in an insecure TLS 1.3 session when not controlling both sides of the connection. We recommend that TLS 1.3 client side users update the version of wolfSSL used. Thanks to Johannes from Sectra Communications and Linköping University for the report. Fixed in the following GitHub pull request [#6412](https://github.com/wolfSSL/wolfssl/pull/6412)

## New Feature Additions

### New Ports and Expansions

* Add support for STM32H5
* Add support for Renesas TSIP v1.17
* Add Renesas SCE RSA crypto-only support
* STARCORE DSP port and example builds added
* Add the function wc\_PKCS7\_SetDefaultSignedAttribs for setting PKCS7 signed attributes to use with PKCS7 bundle creation
* NXP IMX6Q CAAM port with QNX and performance optimizations for AES-CTR

### New Build Options

* ASN.1 print utility to decode ASN.1 syntax and print out human readable text --enable-asn-print. Utility app is located in the directory ./examples/asn1/
* Add introspection for math build, wc\_GetMathInfo() to get information about the math library compiled into the linked wolfSSL library
* Implement TLS recommendations from RFC 9325 for hardening TLS/DTLS security. Enabled with the autoconf flag --enable-harden-tls.
* Add option to support disabling thread local storage, --disable-threadlocal
* Added wc\_DsaSign\_ex() and wc\_DsaVerify\_ex() for handling alternative digest algorithms with DSA Sign/Verify
* Implement atomic operations interface. Macros auto-detect if atomic operations are expected to be available, can be turned off with the macro WOLFSSL\_NO\_ATOMICS
* Added support for DTLS 1.3 Authentication and Integrity-Only Cipher Suites
* Expand crypto callback to have a device ID find callback function with wc\_CryptoCb\_SetDeviceFindCb. Enabled with the macro WOLF\_CRYPTO\_CB\_FIND

## Enhancements and Optimizations

### Optimizations

* Increased performance with ChaCha20 C implementation and general XOR operations
* Added integer type to the ASN.1 sequencing with ASN.1 Integer sequence
* With wolfSSL\_get\_x509\_next\_altname reset alt name list to head once cycled through if compiling with the macro WOLFSSL\_MULTICIRCULATE\_ALTNAMELIST
* Additional key validity sanity checks on input to wolfSSL\_EC\_KEY\_set\_private\_key
* adds support for TLSv1.3 stateful session tickets when using SSL\_OP\_NO\_TICKET

### Memory Optimizations

* Improvements to stack usage and management with SP int math library
* Optimization to TLS 1.3 server to remove caching messages for Ed25519/Ed448
* Added a HAVE\_CURL macro build for building a subset of the wolfSSL library when linking with cURL
* Memory usage improvement with reducing the size of alignment needed with AES
* Reduce run time memory used with ECC operations and ALT\_ECC\_SIZE
* Fixes and improvements for building edge cases such as crypto callback without hash-drbg with low footprint options
* Support HAVE\_SESSION\_TICKET build option without depending on realloc

### Documentation

* Instructions for GPDMA on STM32 configuration added
* Add in instructions for compiling with zephyr on STM32
* Documentation fixup for wolfSSL\_get\_chain\_cert()
* Fix the file pointed to in the TI RTOS documentation that we maintain
* Documentation for wolfSSL\_CertManagerFreeCRL
* Updates made to AES and Chacha documentation
* Update Japanese comments for Ed25519, AES, and other miscellaneous items

### Tests

* Add in an option for easily testing malloc failures when building with WOLFSSL\_MEM\_FAIL\_COUNT macro
* Updated in process for using Expect vs Assert to facilitate more malloc failure tests
* Enhance wolfCrypt test for builds that do not have ECC SECP curves enabled
* ESP32 platform-specific VisualGDB test & benchmark projects
* Update to dependencies in docker container file used for tests
* Fix up for base 10 output with bundled benchmark application

### Port Updates

* Zephyr port update, compile time warning fixes, misc. fixes when used with TLS and update of includes
* Update RIOT-OS to not compile out use of writev by default
* Update Micrium port to enable use of STM32\_RNG
* Micrium updates for XMEMOVE and XSTRTOK use
* Various Espressif HW crypto, SHA2, AES, MP updates
* Added in ASIO build option with CMake builds

### General Enhancements

* Global codebase cleanup for C89 compliance and wolfCrypt -Wconversion hygiene
* PKCS#11 enhancement adding a callback for RSA key size when using a hardware key, by default 2048 bit key is used
* Allow for unknown OIDs in extensions in wolfSSL\_X509\_set\_ext()
* Allow user to override XSTAT by defining the macro XSTAT when compiling
* Support UPN and SID with x509 certificate extensions and custom OID build
* Write next IV in wolfSSL\_DES\_ede3\_cbc\_encrypt for better handling of inline encryption
* Adding NO\_ASN\_TIME\_CHECK build option for compiling out certificate before/after checks
* Improve different peer recvfrom handling and error reporting with ipv4 vs ipv6

## Fixes

* Fix for STM32 ECC sign and verify out of bounds buffer write when the hash length passed in is larger than the key size. Thanks to Maximilian for the report.
* Fix to skip Async\_DevCtxInit when using init rsa/ecc label/id api's
* Revert WOLFSSL\_NO\_ASN\_STRICT macro guard around alternate names directory list
* In async mode, don't retry decrypting if a valid error is encountered on a packet parse attempt
* Add additional sanity check on PKCS7 index value in wc\_PKCS7\_DecryptKekri
* Fix for padding when using an AuthEnvelope PKCS7 type with GCM/CCM stream ciphers
* Fix siphash assembly so that no register is left behind
* Fix to not send a TLS 1.3 session ID resume response when resuming and downgrading to a protocol less than TLS 1.3
* Fix overwriting serialNumber by favouriteDrink when generating a certificate using Cert struct
* Fix for the default realloc used with EspressIf builds
* Track SetDigest usage to avoid invalid free under error conditions
* DTLS v1.3 fix for epoch 0 check on plaintext message
* Fix for session ticket memory leak in wolfSSL\_Cleanup
* Fixes for propagating SendAlert errors when the peer disconnects
* Replace XMEMCPY with XMEMMOVE to fix valgrind-3.15.0 reports "Source and destination overlap in memcpy" when using --enable-aesgcm-stream
* Fix for potential out-of-bounds write edge case in fp\_mod\_2d with --enable-fastmath math library
* Fix getting ECC key size in stm32\_ecc\_sign\_hash\_ex
* Fix for case where wc\_PeekErrorNodeLineData was not unlocking error queue on error
* Fix for async ECC shared secret state
* Fix for better error checking with sp\_gcd with SP int math library
* Fix memory leak in TLSX\_KeyShare\_Setup when handling an error case
* Fix for double free edge case in InitOCSPRequest when handling a memory allocation failure
* X509 NAME Entry fix for leaking memory on error case
* Fix wolfssl\_asn1\_time\_to\_tm setting unexpected fields in tm struct
* Fix for FIPS ECC integrity check with crypto callback set
* BN\_to\_ASN1\_INTEGER fix for handling leading zero byte padding when needed
* Fix a typo in PP macro and add a ceiling to guard against implementation bugs
* DTLS 1.3 fix for using the correct label when deriving the resumption key
* OCSP fix for GetDateInfo edge case with non ASN template builds
* Allow a user set certificate callback function to override the skipAddCA flag when parsing a certificate
* SP int: sp\_radix\_size when radix 10 fix temp size for handling edge case
* Fixes and improvements for handling failures with memory allocations
* Fix for DecodeECC\_DSA\_Sig to handle r and s being initialized
* Fix for wc\_ecc\_is\_point to ensure that the x and y are in range [0, p-1] and z is one (affine ordinates)

### Build Fixes

* Fix for building on Windows with CMake and using USER\_SETTINGS and fix for options.h creation with CMake when using USER\_SETTINGS
* CMake fixes and improvements for use with mingw32
* Fix for building with wpas and x509 small options
* Check if colrm is available for options.h creation when using autoconf
* Clean up NO\_BIG\_INT build, removing WOLFSSL\_SP\_MATH macro and heapmath compile
* Fix PKCS#7 build with NO\_PKCS7\_STREAM
* ...

[Read more](/wolfSSL/wolfssl/releases/tag/v5.6.2-stable)

 Assets
4

 Loading

 👍
1
 SilmorSenedlen reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

 1 person reacted

## wolfSSL Release 5.6.0 (Mar 24, 2023)

24 Mar 22:14

![@JacobBarthelmeh](https://avatars.githubusercontent.com/u/7565298?s=40&v=4)
[JacobBarthelmeh](/JacobBarthelmeh)

[v5.6.0-stable](/wolfSSL/wolfssl/tree/v5.6.0-stable)

[`9797073`](/wolfSSL/wolfssl/commit/979707380c677dfa65e3ba48f19e149773a4a32d)

This commit was created on GitHub.com and signed with GitHub’s **verified signature**.
The key has expired.

GPG key ID: 4AEE18F83AFDEB23
Expired

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/wolfSSL/wolfssl/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v5.6.0-stable)

 Loading

[View all tags](/wolfSSL/wolfssl/tags)

[wolfSSL Release 5.6.0 (Mar 24, 2023)](/wolfSSL/wolfssl/releases/tag/v5.6.0-stable)

Release 5.6.0 has been developed according to wolfSSL's development and QA process (see link below) and successfully passed the quality criteria.

<https://www.wolfssl.com/about/wolfssl-software-development-process-quality-assurance>

NOTE: \* --enable-heapmath is being deprecated and will be removed by 2024

\* This release makes ASN Template the default with ./configure, the previous ASN parsing can be built with --enable-asn=original

Release 5.6.0 of wolfSSL embedded TLS has bug fixes and new features including:

## New Feature Additions

* ASN template is now the default ASN parsing implementation when compiling with configure
* Added in support for TLS v1.3 Encrypted Client Hello (ECH) and HPKE (Hybrid Public Key Encryption)
* DTLS 1.3 stateless server ClientHello parsing support added

### Ports

* Add RX64/RX71 SHA hardware support
* Port to RT1170 and expand NXP CAAM driver support
* Add NuttX integration files for ease of use
* Updated Stunnel support for version 5.67

  Compatibility Layer
* Add in support for AES-CCM with EVP
* BN compatibility API refactoring and separate API created
* Expanding public key type cipher suite list strings support

### Misc.

* Support pthread\_rwlock and add enable option
* Add wolfSSL\_CertManagerLoadCABuffer\_ex() that takes a user certificate chain flag and additional verify flag options
* Docker build additions for wolfSSL library and wolfCLU application
* Add favorite drink pilot attribute type to get it from the encoding
* Added in support for indefinite length BER parsing with PKCS12
* Add dynamic session cache which allocates sessions from the heap with macro SESSION\_CACHE\_DYNAMIC\_MEM

## Improvements / Optimizations

### Tests

* Additional CI (continuous integration) testing and leveraging of GitHub workflows
* Add CI testing for wpa\_supplicant, OpenWrt and OpenVPN using GitHub workflows
* Add compilation of Espressif to GitHub workflows tests
* Refactoring and improving error results with wolfCrypt unit test application
* Minor warning fixes from Coverity static analysis scan
* Add new SHA-512/224 and SHA-512/256 tests
* Used codespell and fixed some minor typos

### Ports

* Improve TLS1.2 client authentication to use TSIP
* Updated Kyber macro to be WOLFSSL\_HAVE\_KYBER and made changes that make Kyber work on STM32
* AES-GCM Windows assembly additions
* CRLF line endings, trailing spaces for C# Wrapper Projects

  Compatibility Layer
* Update `PubKey` and `Key` PEM-to-DER APIs to support return of needed DER size
* Allow reading ENC EC PRIVATE KEY as well via wolfSSL\_PEM\_read\_bio\_ECPrivateKey
* Improve wolfSSL\_EC\_POINT\_cmp to handle Jacobian ordinates
* Fix issue with BIO\_reset() and add BIO\_FLAGS\_MEM\_RDONLY flag support for read only BIOs

### SP

* In SP math library rework mod 3 and use count leading zero instruction
* Fix with SP ECC sign to reject the random k generated when r is 0
* With SP math add better detection of when add won't work and double is needed with point\_add\_qz1 internal function
* With SP int fail when buffer writing to is too small for number rather than discarding the extra values

### Builds

* Define WOLFSSL\_SP\_SMALL\_STACK if wolfSSL is build with --enable-smallstack
* Fix CMake to exclude libm when DH is not enabled
* Allow building of SAKKE as external non-FIPS algorithm with wolfmikey product
* Add option to add library suffix, --with-libsuffix
* ASN template compile option WOLFSSL\_ASN\_INT\_LEAD\_0\_ANY to allow leading zeros
* Add user\_settings.h template for wolfTPM to examples/configs/user\_settings\_wolftpm.h
* Purge the AES variant of Dilithium
* Expand WOLFSSL\_NO\_ASN\_STRICT to allow parsing of explicit ECC public key
* Remove relocatable text in ARMv7a AES assembly for use with FIPS builds
* Expand checking for hardware that supports ARMv7a neon with autotools configure
* Sanity check on allocation fails with DSA and FP\_ECC build when zeroizing internal buffer
* Additional TLS alerts sent when compiling with WOLFSSL\_EXTRA\_ALERTS macro defined

### Benchmarking

* Update wolfCrypt benchmark Windows build files to support x64 Platform
* Add SHA512/224 and SHA512/256 benchmarks, fixed CVS macro and display sizes
* Separate AES-GCM streaming runs when benchmarked
* No longer call external implementation of Kyber from benchmark
* Fix for benchmarking shake with custom block size
* Fixes for benchmark help `-alg` list and block format

  Documentation/Examples
* Document use of wc\_AesFree() and update documentation of Ed25519 with Doxygen
* Move the wolfSSL Configuration section higher in QUIC.md
* Add Japanese Doxygen documentation for cmac.h, quic.h and remove incomplete Japanese doxygen in asn\_public.h
* Espressif examples run with local wolfSSL now with no additional setup needed
* Added a fix for StartTLS use In the example client
* Add a base-line user\_settings.h for use with FIPS 140-3 in XCode example app

### Optimizations

* AES-NI usage added for AES modes ECB/CTR/XTS

### Misc

* Update AES-GCM stream decryption to allow long IVs
* Internal refactor to use wolfSSL\_Ref functions when incrementing or decrementing the structures reference count and fixes for static analysis reports
* Cleanup function logging making adjustments to the debug log print outs
* Remove realloc dependency in DtlsMsgCombineFragBuckets function
* Refactor to use WOLFSSL\_CTX’s cipher suite list when possible
* Update internal padding of 0’s with DSA sign and additional tests with mp\_to\_unsigned\_bin\_len function
* With DTLS SRTP use wolfSSL\_export\_keying\_material instead of wc\_PRF\_TLS
* Updated macro naming from HAVE\_KYBER to be WOLFSSL\_HAVE\_KYBER
* Update AES XTS encrypt to handle in-place encryption properly
* With TLS 1.3 add option to require only PSK with DHE

## Fixes

### Ports

* Fix for AES use with CAAM on imx8qxp with SECO builds
* Fix for PIC32 crypto HW and unused `TLSX_SetResponse`
* Fix warning if ltime is unsigned seen with QNX build
* Updates and fix for Zephyr project support
* Include sys/time.h for WOLFSSL\_RIOT\_OS
* Move X509\_V errors from enums to defines for use with HAProxy CLI
* Fix IAR compiler warnings resolved
* Fix for STM32 Hash peripherals (like on F437) with FIFO depth = 1
* ESP32 fix for SHA384 init with hardware acceleration

### Builds

* Add WOLFSSL\_IP\_ALT\_NAME macro define to --enable-curl
* Fixes for building with C++17 and avoiding clashing with byte naming
* Fixes SP math all build issue with small-stack and no hardening
* Fix for building with ASN template with `NO_ASN_TIME` defined
* Fix building FIPSv2 with WOLFSSL\_ECDSA\_SET\_K defined
* Don't allow aesgcm-stream option with kcapi
* Fix DTLS test case for when able to read peers close notify alert on FreeBSD systems
* Fix for "expression must have a constant value" in tls13.c with Green Hills compiler
* Fixes for building KCAPI with opensslextra enabled
* Fix warnings of shadows min and subscript with i486-netbsd-gcc compiler
* Fix issue with async and `WOLFSSL_CHECK_ALERT_ON_ERR`
* Fix for PKCS7 with asynchronous crypto enabled

### Math Library

* SP Aarch64 fix for conditional changed in asm needing "cc" and fix for ECC P256 mont reduce
* In SP builds add sanity check with DH exp. to check the output length for minimum size
* In SP math fix scalar length check with EC scalar multiply
* With SP int fix handling negative character properly with read radix
* Add error checks before setting variable err in SP int with the function sp\_invmod\_mont\_ct
* Fix to add sanity check for malloc of zero size in fastmath builds
* In fastmath fix a possible overflow in fp\_to\_unsigned\_bin\_len length check
* Heapmath fast mod. reduce fix

### Compatibility Layer

* Fixes for encoding/decoding ecc public keys and ensure i2d public key functions do not include any private key information
* Fix for EVP\_EncryptUpdate to update outl on empty input
* Fix SE050 RSA public key loading and RSA/ECC SE050 TLS Compatibility
* Rework EC API and validate point after setting it
* Fix for X509 RSA PSS with compatibility layer functions
* Fix size of structures used with SHA operations when built with opensslextra for Espressif hardware accelerated hashing
* Added sanity check on key length with wolfSSL\_CMAC\_Init function
* Fix for return value type conversion of bad mutex error in logging function
* Fix NID conflict NID\_givenName and NID\_md5WithRSAEncryption
* Fix unguarded XFPRINTF calls with opensslextra build
* Fix wolfSSL\_ASN1\_INTEGER\_to\_BN for negative values
* Fix for potential ASN1\_STRING leak in wolfSSL\_X509\_NAME\_ENTRY\_create\_by\_txt and wolfSSL\_X509\_NAME\_ENTRY\_create\_by\_NID when memory allocation fails

### Misc.

* Add sanity check to prevent an out of bounds read with OCSP response decoding
* Sanity check to not allow 0 length with bit string and integer when parsing ASN1 syntax
* Adjust RNG sanity checks and remove error prone first byte comparison
* With PKCS7 add a fix for GetAsnTimeString() to correctly increment internal data pointer
* PKCS7 addition of sequence around algo parameters with authenvelop
* DSA fixes for clearing mp\_int before re-reading data and avoid mp\_clear without first calling mp\_init
* Fix for SRTP setting bitfield when it is encoded for the TLS extension
* Fix for handling small http headers when doing CRL verification
* Fix for ECCSI hash function to validate the output size and curve size
* Fix for value of givenName and name being reversed with CSR generation
* Fix for error type returned (OCSP\_CERT\_UNKNOWN) with OCSP verification
* Fix for a potential memory leak with ProcessCSR when handling OCSP responses
* Fix for VERIFY\_SKIP\_DATE flag not ignoring date errors when set
* Fix for zlib decompression buffer issue with PKCS7
* Fix for DTLS message pool send size used and DTLS server saving of the handshake sequence
* Fix to propagate WOLFSSL\_TICKET\_RET\_CREATE error return value from DoDecryptTicket()

  ...

[Read more](/wolfSSL/wolfssl/releases/tag/v5.6.0-stable)

 Assets
4

 Loading

 👍
3
 Safari77, SilmorSenedlen, and M0nteCarl0 reacted with thumbs up emoji

All reactions

* 👍
  3 reactions

 3 people reacted

## wolfSSL Release 5.5.4 (Dec 21, 2022)

21 Dec 18:05

![@JacobBarthelmeh](https://avatars.githubusercontent.com/u/7565298?s=40&v=4)
[JacobBarthelmeh](/JacobBarthelmeh)

[v5.5.4-stable](/wolfSSL/wolfssl/tree/v5.5.4-stable)

[`4fbd4fd`](/wolfSSL/wolfssl/commit/4fbd4fd36a21efd9d1a7e17aba390e91c78693b1)

This commit was created on GitHub.com and signed with GitHub’s **verified signature**.
The key has expired.

GPG key ID: 4AEE18F83AFDEB23
Expired

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/wolfSSL/wolfssl/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v5.5.4-stable)

 Loading

[View all tags](/wolfSSL/wolfssl/tags)

[wolfSSL Release 5.5.4 (Dec 21, 2022)](/wolfSSL/wolfssl/releases/tag/v5.5.4-stable)

## New Feature Additions

* QUIC related changes for HAProxy integration and config option
* Support for Analog Devices MAXQ1080 and MAXQ1065
* Testing and build of wolfSSL with NuttX
* New software based entropy gatherer with configure option --enable-entropy-memuse
* NXP SE050 feature expansion and fixes, adding in RSA support and conditional compile of AES and CMAC
* Support for multi-threaded sniffer

## Improvements / Optimizations

### Benchmark and Tests

* Add alternate test case for unsupported static memory API when testing mutex allocations
* Additional unit test cases added for AES CCM 256-bit
* Initialize and free AES object with benchmarking AES-OFB
* Kyber with DTLS 1.3 tests added
* Tidy up Espressif ESP32 test and benchmark examples
* Rework to be able to run API tests individually and add display of time taken per test

### Build and Port Improvements

* Add check for 64-bit ABI on MIPS64 before declaring a 64-bit CPU
* Add support to detect SIZEOF\_LONG in armclang and diab
* Added in a simple example working on Rx72n
* Update azsphere support to prevent compilation of file included inline
* --enable-brainpool configure option added and default to on when custom curves are also on
* Add RSA PSS salt defines to engine builds if not FIPS v2

### Post Quantum

* Remove kyber-90s and route all Kyber through wolfcrypt
* Purge older version of NTRU and SABER from wolfSSL

### SP Math

* Support static memory build with sp-math
* SP C, SP int: improve performance
* SP int: support mingw64 again
* SP int: enhancements to guess 64-bit type and check on NO\_64BIT macro set before using long long
* SP int: check size required when using sp\_int on stack
* SP: --enable-sp-asm now enables SP by default if not set
* SP: support aarch64 big endian

### DTLS

* Allow DTLS 1.3 to compile when FIPS is enabled
* Allow for stateless DTLS client hello parsing

### Misc.

* Easier detection of DRBG health when using Intel’s RDRAND by updating the structures status value
* Detection of duplicate known extensions with TLS
* PKCS#11 handle a user PIN that is a NULL\_PTR, compile time check in finding keys, add initialization API
* Update max Cert Policy size based on RFC 5280
* Add Android CA certs path for wolfSSL\_CTX\_load\_system\_CA\_certs()
* Improve logic for enabling system CA certs on Apple devices
* Stub functions to allow for cpuid public functions with non-intel builds
* Increase RNG\_SECURITY\_STRENGTH for FIPS
* Improvements in OpenSSL Compat ERR Queue handling
* Support ASN1/DER CRLs in LoadCertByIssuer
* Expose more ECC math functions and improve async shared secret
* Improvement for sniffer error messages
* Warning added that renegotiation in TLS 1.3 requires session ticket
* Adjustment for TLS 1.3 post auth support
* Rework DH API and improve PEM read/write

## Fixes

### Build Fixes

* Fix --enable-devcrypto build error for sys without u\_int8\_t type
* Fix casts in evp.c and build issue in ParseCRL
* Fixes for compatibility layer building with heap hint and OSSL callbacks
* fix compile error due to Werro=undef on gcc-4.8
* Fix mingw-w64 build issues on windows
* Xcode project fixes for different build settings
* Initialize variable causing failures with gcc-11 and gcc-12 with a unique wolfSSL build configuration
* Prevent WOLFSSL\_NO\_MALLOC from breaking RSA certificate verification
* Fixes for various tests that do not properly handle `WC_PENDING_E` with async. builds
* Fix for misc `HashObject` to be excluded for `WOLFCRYPT_ONLY`

### OCSP Fixes

* Correctly save next status with OCSP response verify
* When the OCSP responder returns an unknown exception, continue through to checking the CRL

### Math Fixes

* Fix for implicit conversion with 32-bit in SP math
* Fix for error checks when modulus is even with SP int build
* Fix for checking of err in \_sp\_exptmod\_nct with SP int build
* ECC cofactor fix when checking scalar bits
* ARM32 ASM: don't use ldrd on user data
* SP int, fix when ECC specific size code included

### Port Fixes

* Fixes for STM32 PKA ECC (not 256-bit) and improvements for AES-GCM
* Fix for cryptocell signature verification with ECC
* Benchmark devid changes, CCM with SECO fix, set IV on AES import into SECO

### Compat. Layer Fixes

* Fix for handling DEFAULT:... cipher suite list
* Fix memory leak in wolfSSL\_X509\_NAME\_ENTRY\_get\_object
* Set alt name type to V\_ASN1\_IA5STRING
* Update name hash functions wolfSSL\_X509\_subject\_name\_hash and wolfSSL\_X509\_issuer\_name\_hash to hash the canonical form of subject
* Fix wolfSSL\_set\_SSL\_CTX() to be usable during handshake
* Fix X509\_get1\_ocsp to set num of elements in stack
* X509v3 EXT d2i: fix freeing of aia
* Fix to remove recreation of certificate with wolfSSL\_PEM\_write\_bio\_X509()
* Link newly created x509 store's certificate manager to self by default to assist with CRL verification
* Fix for compatibility `EC_KEY_new_by_curve_name` to not create a key if the curve is not found

### Misc.

* Free potential signer malloc in a fail case
* fix other name san parsing and add RID cert to test parsing
* WOLFSSL\_OP\_NO\_TICKET fix for TLSv1.2
* fix ASN template parsing of X509 subject directory attribute
* Fix the wrong IV size with the cipher suite TLS\_ECDHE\_PSK\_WITH\_AES\_128\_GCM\_SHA256
* Fix incorrect self signed error return when compiled with certreq and certgen.
* Fix wrong function name in debug comment with wolfSSL\_X509\_get\_name\_oneline()
* Fix for decryption after second handshake with async sniffer
* Allow session tickets to properly resume when using PQ KEMs
* Add sanity overflow check to DecodeAltNames input buffer access

 Assets
4

 Loading

 👍
3
 Safari77, SilmorSenedlen, and vaygr reacted with thumbs up emoji

All reactions

* 👍
  3 reactions

 3 people reacted

Previous *1* [2](/wolfSSL/wolfssl/releases?page=2) [3](/wolfSSL/wolfssl/releases?page=3) [4](/wolfSSL/wolfssl/releases?page=4) [5](/wolfSSL/wolfssl/releases?page=5) [Next](/wolfSSL/wolfssl/releases?page=2)

Previous [Next](/wolfSSL/wolfssl/releases?page=2)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from blog.trailofbits.com_22ee56b7_20250108_131947.html ===

# [Trail of Bits Blog](https://blog.trailofbits.com/ "Trail of Bits Blog")

##

# Menu

[Skip to content](#content "Skip to content")

* [Home](https://blog.trailofbits.com/)

# Keeping the wolves out of wolfSSL

* Post
* [January 12, 2023](https://blog.trailofbits.com/2023/01/12/wolfssl-vulnerabilities-tlspuffin-fuzzing-ssh/ "8:00 am")
* [Leave a comment](https://blog.trailofbits.com/2023/01/12/wolfssl-vulnerabilities-tlspuffin-fuzzing-ssh/#respond)

***By Max Ammann***

Trail of Bits is publicly disclosing four vulnerabilities that affect wolfSSL: [CVE-2022-38152](https://www.cve.org/CVERecord?id=CVE-2022-38152), [CVE-2022-38153](https://www.cve.org/CVERecord?id=CVE-2022-38153), [CVE-2022-39173](https://www.cve.org/CVERecord?id=CVE-2022-39173), and [CVE-2022-42905](https://www.cve.org/CVERecord?id=CVE-2022-42905). The four issues, which have CVSS scores ranging from medium to critical, can all result in a denial of service (DoS). These vulnerabilities have been discovered automatically using the novel protocol fuzzer [tlspuffin](https://github.com/tlspuffin/tlspuffin). This blog post will explore these vulnerabilities, then provide an in-depth overview of the fuzzer.

tlspuffin is a fuzzer inspired by formal protocol verification. Initially developed as part of my internship at [LORIA, INRIA, France](https://www.loria.fr/en/), it is especially targeted against cryptographic protocols like TLS or SSH.

During my internship at Trail of Bits, we pushed protocol fuzzing even further by supporting a new protocol (SSH), adding more fuzzing targets, and (re)discovering vulnerabilities. This work represents a milestone in the development of the first [Dolev-Yao model](https://en.wikipedia.org/wiki/Dolev%E2%80%93Yao_model)-guided fuzzer. By supporting an additional protocol, we proved that our fuzzing approach is agnostic with respect to the protocol. Going forward, we aim to support other protocols such as QUIC, OpenVPN, and WireGuard.

## Targeting wolfSSL

During my internship at Trail of Bits, we added several versions of wolfSSL as fuzzing targets. The wolfSSL library was an ideal choice because it was affected by two authentication vulnerabilities that were discovered in early 2022 ([CVE-2022-25640](https://www.cve.org/CVERecord?id=CVE-2022-25640) and [CVE-2022-25638](https://www.cve.org/CVERecord?id=CVE-2022-25638)). That meant we could verify that tlspuffin works by using it to rediscover the known vulnerabilities.

As tlspuffin is written in Rust, we first had to write bindings to wolfSSL. While the bindings were being implemented, several bugs were discovered in the OpenSSL compatibility layer that have also been reported to the wolfSSL team. With the bindings ready, we were ready to let the fuzzer do its job: discovering weird states within wolfSSL.

## Discovered Vulnerabilities

During my internship, I discovered several vulnerabilities in wolfSSL, which can result in a denial of service (DoS).

* **DOSC:** [CVE-2022-38153](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-38153) allows MitM actors or malicious servers to perform a DoS attack against TLS 1.2 clients by intercepting and modifying a TLS packet. This vulnerability affects wolfSSL 5.3.0.
* **DOSS:** [CVE-2022-38152](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-38152) is a DoS vulnerability against wolfSSL servers that use the `wolfSSL_clear` function instead of the sequence `wolfSSL_free; wolfSSL_new`. Resuming a session causes the server to crash with a NULL-pointer dereference. This vulnerability affects wolfSSL 5.3.0 to 5.4.0.
* **BUF:** [CVE-2022-39173](https://www.cve.org/CVERecord?id=CVE-2022-39173) is caused by a buffer overflow and causes a DoS of wolfSSL servers. It is caused by pretending to resume a session, and sending duplicate cipher suites in the Client Hello. It might allow an attacker to gain RCE on certain architectures or targets; however, this has not yet been confirmed. Versions of wolfSSL before 5.5.1 are affected.
* **HEAP:** [CVE-2022-42905](https://www.cve.org/CVERecord?id=CVE-2022-42905) is caused by a buffer overread while parsing TLS record headers. Versions of wolfSSL before 5.5.2 are affected.

### “A few CVEs for wolfSSL, one giant leap for tlspuffin.”

The vulnerabilities mark a milestone for the fuzzer: They are the first vulnerabilities found using this tool that have a far-reaching impact. We can also confidently say that this vulnerability would not have been easy to find with classical bit-level fuzzers. It’s especially intriguing that on average, the fuzzer took less than one hour to discover a vulnerability and crash.

While preparing the fuzzing setup for wolfSSL, we also discovered a severe memory leak that was caused by misuse of the wolfSSL API. This issue was reported to the wolfSSL team, [changed their documentation](https://github.com/wolfSSL/wolfssl/pull/5483) to help users avoid the leak. Additionally, several other code-quality issues have been reported to wolfSSL, and their team fixed all of our findings within one week of disclosure. If a “best coordinated disclosure” award existed, the wolfSSL team would definitely win it.

The following sections will focus on two of the vulnerabilities because of their higher impact and expressive attack traces.

### **DOSC:** Denial of service against clients

In wolfSSL 5.3.0, MiTM attackers or malicious servers can crash TLS clients. The bug lives in the `AddSessionToCache` function, which is called when the client receives a new session ticket from the server.

Let’s assume that each bucket of the session cache of wolfSSL contains at least one entry. As soon as a new session ticket arrives, the client will reuse a previously stored cache entry to try to cache it in the session cache. Additionally, because the new session ticket is quite large at 700 bytes, it will be allocated on the heap using `XMALLOC`.

In the following example, `SESSION_TICKET_LEN` is 256:

```
if (ticLen > SESSION_TICKET_LEN) {
    ticBuff = (byte*)XMALLOC(ticLen, NULL,
            DYNAMIC_TYPE_SESSION_TICK);
    …
}

```

[ssl.c:13442](https://github.com/wolfSSL/wolfssl/blob/e722c15be860794179082a05d09e6a90dc77ccf0/src/ssl.c)

This allocation leads to the initialization of `cacheTicBuff`, as `ticBuff` is already initialized, `cacheSession->ticketLenAlloc` is 0, and `ticLen` is 700:

```
if (ticBuff != NULL && cacheSession->ticketLenAlloc < ticLen) {
    cacheTicBuff = cacheSession->ticket;
    …
}

```

[ssl.c:13500](https://github.com/wolfSSL/wolfssl/blob/e722c15be860794179082a05d09e6a90dc77ccf0/src/ssl.c)

The `cacheTicBuff` is set to the ticket of a previous session, `cacheSession->ticket`. The memory to which `cacheTicBuff` points is not allocated on the heap; in fact, `cacheTicBuff` points to `cacheSession->_staticTicket`. This is problematic because the `cacheTicBuff` is later freed if it is not null.

```
if (cacheTicBuff != NULL)
     XFREE(cacheTicBuff, NULL, DYNAMIC_TYPE_SESSION_TICK);

```

[ssl.c:13557](https://github.com/wolfSSL/wolfssl/blob/e722c15be860794179082a05d09e6a90dc77ccf0/src/ssl.c)

The process terminates by executing the `XFREE` function, as the passed pointer is not allocated on the heap.

Note that the ticket length in itself is not the cause of the crash. This vulnerability is quite different to [Heartbleed](https://heartbleed.com/), the buffer over-read vulnerability discovered in OpenSSL. With wolfSSL, a crash is caused not by overflowing buffers but by a logical bug.

### Finding weird states

The fuzzer discovered the vulnerability in about one hour. The fuzzer modified the `NewSessionTicket` (`new_message_ticket`) message by replacing an actual ticket with a large array of 700 bytes (`large_bytes_vec`). This mutation of an otherwise-sane trace leads to a call of `XFREE` on a non-allocated value. This eventually leads to a crash of the client that receives such a large ticket.

[![](https://blog.trailofbits.com/wp-content/uploads/2023/01/Screenshot-2023-01-09-at-2.15.34-PM-1024x520.png)](https://blog.trailofbits.com/wp-content/uploads/2023/01/Screenshot-2023-01-09-at-2.15.34-PM.png)

Visualized exploit for DOSC ([CVE-2022-38153](https://www.cve.org/CVERecord?id=CVE-2022-38153)). Each box represents a TLS message. Each message is composed of different fields like a protocol version or a vector of cipher suites. The visualization was generated using the tlspuffin fuzzer and mirrors the structure of the DY attacker traces which will be introduced in the next section.

A single execution of the above trace is not enough to reach the vulnerable code. As the bug resides in the session cache of wolfSSL, we need to let the client cache fill up in order to trigger the crash. Empirically, we discovered that about 30 prior connections are needed to reliably crash them. The reason for the random behavior is that the cache consists of multiple rows or buckets; the default compilation configuration of wolfSSL contains 11 buckets. Based on the hash of the TLS session ID, sessions are stored in one of these buckets. The DoS is triggered only if the current bucket already contains a previous session.

Reproducing this vulnerability is difficult, as a prepared state is required to reach the behavior. In general, a global state such as the wolfSSL cache makes fuzzing more difficult to apply. Ideally, one might assume that each execution of a program yields the same outputs given the identical inputs. Reproduction and debugging become more challenging if this assumption is violated because the program uses a global state; this represents a general challenge when fuzzing unknown targets.

Fortunately, tlspuffin allows researchers to recreate a program state that is similar to the one that was present when the fuzzer observed a crash. We were able to re-execute all the traces that the fuzzer rated as interesting, which allowed us to observe the crash of wolfSSL in a more controlled environment and to debug wolfSSL using GDB. After analyzing the call stack that led to the invalid free, it was clear that the bug was related to the session cache.

The root cause for **DOSC** lies in the usage of a shared global state. It was very surprising to find that wolfSSL shares the state between multiple invocations of the library. Conceptually, the lifetime of the session cache should be bound to the TLS context, which already serves as a container for TLS session. Each SSL session shares the state with the TLS context. The addition of maintaining a global mutable state increases complexity throughout a codebase. Therefore, it should be used only when absolutely necessary.

## **BUF:** Buffer overflow on servers

In versions of wolfSSL before 5.5.1, malicious clients can cause a buffer overflow during a resumed TLS 1.3 handshake. If an attacker resumes or pretends to resume a previous TLS session by sending a maliciously crafted Client Hello followed by another maliciously crafted Client Hello, then a buffer overflow is possible. A minimum of two Client Hellos must be sent: one that pretends to resume a previous session, and a second as a response to a Hello Retry Request message.

The malicious Client Hellos contain a list of supported cipher suites, which contain at least `⌊sqrt(150)⌋ + 1 = 13` duplicates and fewer than 150 ciphers in total. The buffer overflow occurs in the second invocation `RefineSuites` function during a handshake.

```

/* Refine list of supported cipher suites to those common to server and
client.
*
* ssl         SSL/TLS object.
* peerSuites  The peer's advertised list of supported cipher suites.
*/
static void RefineSuites(WOLFSSL* ssl, Suites* peerSuites)
{
    byte   suites[WOLFSSL_MAX_SUITE_SZ];
    word16 suiteSz = 0;
    word16 i, j;

  XMEMSET(suites, 0, WOLFSSL_MAX_SUITE_SZ);

  for (i = 0; i < ssl->suites->suiteSz; i += 2) {
      for (j = 0; j < peerSuites->suiteSz; j += 2) {
          if (ssl->suites->suites[i+0] == peerSuites->suites[j+0] &&
              ssl->suites->suites[i+1] == peerSuites->suites[j+1]) {
              suites[suiteSz++] = peerSuites->suites[j+0];
              suites[suiteSz++] = peerSuites->suites[j+1];
          }
      }
  }

  ssl->suites->suiteSz = suiteSz;
  XMEMCPY(ssl->suites->suites, &suites, sizeof(suites));
#ifdef WOLFSSL_DEBUG_TLS
[...]
#endif
}
```

[tls13.c:4355](https://raw.githubusercontent.com/wolfSSL/wolfssl/v5.4.0-stable/src/ssl.c)

The `RefineSuites` function expects a `struct WOLFSSL` that contains a list of acceptable ciphers suites at `ssl->suites`, as well as an array of peer cipher suites. Both inputs are bounded by `WOLFSSL_MAX_SUITE_SZ`, which is equal to 150 cipher suites or 300 bytes.

Let us assume that `ssl->suites` consists of a single cipher suite like `TLS_AES_256_GCM_SHA384` and that the user-controllable `peerSuites` list contains the same cipher repeated 13 times. The `RefineSuites` function will iterate for each suite in `ssl->suites` over `peerSuites` and append the suite to the `suites` array if it is a match. The suites array has a maximum length of `WOLFSSL_MAX_SUITE_SZ` suites.

With the just-mentioned input, the length of `suites` equals now 13. The suites array is now copied to the struct `WOLFSSL` in the last line of the listing above. Therefore, the `ssl->suites` array now contains 13 `TLS_AES_256_GCM_SHA384` cipher suites.

During a presumably resumed TLS handshake, the `RefineSuites` function is called again if a Hello Retry Request is triggered by the client. The `struct WOLFSSL` is not reset in between and keeps the previous suites of 13 cipher suites. Because the TLS peer controls the `peerSuites` array, we assume that it again contains 13 duplicate cipher suites.

The `RefineSuites` function will iterate for each element in `ssl->suites` over `peerSuites` and append the suite to suites if it is a match. Because the `ssl->suites`

array contains already `13 TLS_AES_256_GCM_SHA384` cipher suites, in total 13 x 13 = 169 cipher suites are written to suites. The 169 cipher suites exceed the allocated maximum allowed `WOLFSSL_MAX_SUITE_SZ` cipher suites. The `suites` buffer overflows on the stack.

So far, we have been unable to exploit this bug and, for example, gain remote code execution because the set of bytes that can overflow the suites buffer is small. Only valid cipher suite values can overflow the buffer.

Because of space constraints, we are not providing a detailed review of the mutations that are required in order to mutate a sane trace to an attack trace, as we did with **DOSC**.

To understand how we found these vulnerabilities, it is worth examining how tlspuffin was developed.

## Next Generation Protocol Fuzzing

History has proven that the implementation of cryptographic protocols is prone to errors. It’s easy to introduce logical flaws when translating specifications like RFC or scientific articles to actual program code. In 2017, researchers discovered that the well-known WPA2 protocol suffered severe flaws ([KRACK](https://www.krackattacks.com/)). Vulnerabilities like [FREAK](https://freakattack.com/), or authentication vulnerabilities like the wolfSSL bugs found in early 2022 ([CVE-2022-25640](https://www.cve.org/CVERecord?id=CVE-2022-25640) and [CVE-2022-25638](https://www.cve.org/CVERecord?id=CVE-2022-25638)), support this idea.

It is challenging to fuzz implementations of cryptographic protocols. Unlike traditional fuzzing of file formats, cryptographic protocols require a specific flow of cryptographic and mutually dependent messages to reach deep protocol states.

Additionally, detecting logical bugs is a challenge on its own. The AddressSanitizer enables security researchers to reliably find memory-related issues. For logical bugs like authentication bypasses or loss of confidentiality no automated detectors exist.

These challenges are why I and Inria set out to design tlspuffin. The fuzzer is guided by the so-called Dolev-Yao model, which has been used in formal protocol verification since the 1980s.

## The Dolev-Yao Model

Formal methods have become an essential tool in the security analysis of cryptographic protocols. Modern tools like [ProVerif](https://bblanche.gitlabpages.inria.fr/proverif/) or [Tamarin](https://tamarin-prover.github.io/) feature a fully automated framework to model and verify security protocols. The [ProVerif manual](https://bblanche.gitlabpages.inria.fr/proverif/manual.pdf) and [DEEPSEC paper](https://ieeexplore.ieee.org/document/8418623) provide a good introduction to protocol verification. The underlying theory of these tools uses a symbolic model—the Dolev-Yao model—that originates from the work of [Dolev and Yao](https://doi.org/10.1109/TIT.1983.1056650).

With Dolev-Yao models, attackers have full control over the messages being sent within the communication network. Messages are modeled symbolically using a term algebra, which consists of a set of function symbols and variables. This means that messages can be represented by applying functions over variables and other functions.

An adversary can eavesdrop on, inject, or manipulate messages; the Dolev-Yao model is meant to simulate real-world attacks on these protocols, such as Man-in-the-Middle (MitM)-style attacks. The cryptographic primitives are modeled through abstracted semantics because the Dolev-Yao model focuses on finding logical protocol flaws and is not concerned with correctness of cryptographic primitives. Because the primitives are described through an abstract semantic, there is no real implementation of, for example, RSA or AES defined in the Dolev-Yao model.

It was already possible to find attacks in the cryptographic protocols using this model. The TLS specification has already undergone various analyses by these tools in [2006](https://doi.org/10.1145/1455770.1455828) and [2017](https://doi.org/10.1109/SP.2017.26), which led to fixes in RFC drafts. But in order to fuzz implementations of protocols, instead of verifying their specification, we need to do things slightly differently. We chose to replace the abstract semantics with a more concrete one which includes implementations of primitives.

The tlspuffin fuzzer was designed based on the Dolev-Yao model and guided by the symbolic formal model, which means that it can execute any protocol flow that is representable in the Dolev-Yao model. It can also generate previously unseen protocol executions. The following section explains the notion of Dolev-Yao traces, which are loosely based on the Dolev-Yao model.

## Dolev-Yao Traces

Dolev-Yao traces build on top of the Dolev-Yao model and also use a term algebra to represent messages symbolically. Just like in the Dolev-Yao model, the cryptographic primitives are treated as black boxes. This allows the fuzzer to focus on logical bugs, instead of testing cryptographic primitives for their correctness.

Let’s start with an example of the infamous Needham-Schröder protocol. If you aren’t familiar, Needham-Schröder is an authentication protocol that allows two parties to establish a shared secret through a trusted server; however, its asymmetric version is infamous for being susceptible to an MitM attack.

The protocol allows Alice and Bob to create a shared secret through a trusted third-party server. The protocol works by requesting a shared secret from the server that is encrypted once for Bob and once for Alice. Alice can request a fresh secret from the server and will receive an encrypted message that contains the shared secret and a further encrypted message addressed to Bob. Alice will forward the message to Bob. Bob can now decrypt the message and also has access to the shared secret.

The flaw in the protocol allows an imposter to impersonate Alice by first initiating a connection with Alice and then forwarding the received data to Bob. (For a deeper understanding of the protocol, we suggest reading its [Wikipedia article](https://en.wikipedia.org/wiki/Needham%E2%80%93Schroeder_protocol#The_public-key_protocol).)

In the below Dolev-Yao trace T, we model one specific execution of the Needham-Schröder protocol between the two agents with the names a and b. Each agent has an underlying implementation. The trace consists of a concatenation of steps that are delimited by a dot. There are two kinds of steps: input and output. Output steps are denoted by a bar above the agent name.

[![](https://blog.trailofbits.com/wp-content/uploads/2023/01/Screenshot-2023-01-09-at-2.51.04-PM-1024x383.png)](https://blog.trailofbits.com/wp-content/uploads/2023/01/Screenshot-2023-01-09-at-2.51.04-PM.png)

Dolev-Yao attack trace for the Needham-Schröder protocol

Let’s now describe the semantics of trace `T`. (A deep understanding of the steps of this protocol is not needed. This example should just give you a feeling about the expressiveness of the Dolev-Yao model and what a Dolev-Yao trace is.)

In the first step, we send the term `pk(sk_E)` to agent `a`. Agent `a` will serialize the term and provide it to its underlying implementation of Needham-Schröder.

Next, we let the agent a output a bitstring and bind it to `h_1`. By following the steps in the Dolev-Yao trace, we can observe that we now send the term `aenc(adec(h_1, sk_E), pk(sk_B))` to agent `b`.

Next, we let agent `b`’s underlying implementation output a bitstring and bind it to `h_2`. The next two steps forward the message `h_2` to agent a and bind its new output to `h_3`. Finally, we repeat the third and fourth step for a different input, namely `h_3`, and send the term `h_3` to agent `a`.

Such traces allow us to model arbitrary execution flows of cryptographic protocols. The trace above models an MitM attack, originally discovered by Gavin Lowe. A fixed version of the protocol is known as the Needham-Schroeder-Lowe protocol.

### TLS 1.3 Handshake Protocol

Before providing an example for a modern cryptographic protocol, I quickly want to explain the different phases of a TLS handshake.

[![](https://blog.trailofbits.com/wp-content/uploads/2023/01/Screenshot-2023-01-09-at-2.56.40-PM-735x1024.png)](https://blog.trailofbits.com/wp-content/uploads/2023/01/Screenshot-2023-01-09-at-2.56.40-PM.png)

Overview of the phases of a TLS handshake

1. **Key exchange**: Establish shared keys and select the cryptographic methods and parameters. Both messages in this phase are not encrypted.- **Server parameters**: Exchange further parameters that are no longer sent in plaintext.- **Server authentication**: Authenticate the server by confirming keys and handshake integrity.- **Client authentication**: Optionally, authenticate the client by confirming keys and handshake integrity.

Just like in the Needham-Schröder example, each message of the TLS handshake can be represented by a symbolic term. For example, the first Client Hello message can be represented as the term `fn_client_hello(fn_key_share, fn_signature_algorithm, psk)`. In this example, `fn_key_share`, `fn_signature_algorithm`, and `psk` are constants.

For a more in-depth review of the handshake message, [Section 2 of RFC 8446](https://datatracker.ietf.org/doc/html/rfc8446#section-2) explains each message in more detail.

## Fuzzing Dolev-Yao Traces

The tlspuffin fuzzer implements Dolev-Yao traces and allows their execution in concrete fuzzing targets like OpenSSL, wolfSSL, and libssh.

[![](https://blog.trailofbits.com/wp-content/uploads/2023/01/Screenshot-2023-01-09-at-3.02.50-PM-1024x733.png)](https://blog.trailofbits.com/wp-content/uploads/2023/01/Screenshot-2023-01-09-at-3.02.50-PM.png)

Structure of tlspuffin. It follows the best-practices defined by [LibAFL](https://github.com/AFLplusplus/LibAFL).

The design of tlspuffin is based on the evolutionary fuzzer [LibAFL](https://github.com/AFLplusplus/LibAFL). The fuzzer uses several concepts, which are illustrated in the following sections. We will follow traces on their journey from being picked from a **seed corpus** until they are **mutated, executed, observed**, and eventually become an attack trace.

### Seed Corpus

Initially, the seed corpus contains some handcrafted traces that represent some common attack scenarios (e.g., client/server is the attacker or the MitM is the attacker).

### Scheduler and Mutational Stage

The scheduler picks seeds based on a heuristic; for example, the scheduler might prefer shorter and more minimal traces. After that, the picked traces are mutated. This means that messages are skipped or repeated or their contents are changed. Because we are using a Dolev-Yao model to represent messages, we can change fields of messages by swapping sub terms or changing function symbols.

### Executor, Feedback, and Objectives

After the traces have been mutated, they are sent to the executor. The executor is responsible for executing the traces in actual implementations such as OpenSSL or wolfSSL, where they are executed in either the same process or a fork for each input. The executor is also responsible for collecting observations about the execution. An observation is classified as feedback if it contains information about newly discovered code edges in terms of coverage. For example, if the trace made the fuzzing target crash or an authentication bypass was witnessed, the trace is classified as an objective. The observation is then either added to the seed corpus or the objective corpus based on how it was classified.

Finally, we can repeat the process and start picking new traces from the seed corpus. This algorithm is quite common in fuzzing and is closely related to the approach of the classical [AFL](https://lcamtuf.coredump.cx/afl/) fuzzer. (For a more in-depth explanation of this particular algorithm, refer to the preprint [LibAFL: A Framework to Build Modular and Reusable Fuzzers](https://www.s3.eurecom.fr/docs/ccs22_fioraldi.pdf).)

## Internship Highlights

During my internship, we added several new features to tlspuffin that extended the tool in several dimensions, which are:

* Protocol implementations,* Cryptographic protocols,* Detection of security violations, and* Reproducibility of vulnerabilities.

### Toward more Fuzzing Targets

Before my internship at Trail of Bits, tlspuffin already supported fuzzing several versions of OpenSSL (including the version 1.0.1, which is vulnerable to Heartbleed) and LibreSSL. We designed an interface that added the capability to fuzz arbitrary protocol libraries. By implementing the interface for wolfSSL, we were able to add support for fuzzing wolfSSL 4.3.0 to 5.4.0, even though wolfSSL is not ABI compatible with OpenSSL or LibreSSL. Because the interface is written in Rust, implementing it for wolfSSL required us to create Rust bindings. The great thing about this is that the wolfSSL bindings could be reused outside of tlspuffin for embedded software projects. We released open-source wolfSSL bindings on [GitHub](https://github.com/trailofbits/rust-wolfssl).

This represents a milestone in library support. Previously, the tlspuffin was bound to the OpenSSL API, which is supported only by LibreSSL and OpenSSL. With this interface, it will be possible to support arbitrary future fuzzing targets.

### Toward more Protocols

Although tlspuffin was specifically designed for the TLS protocol, it has the capability to support other formats. In fact, any protocol that is formalized in the Dolev-Yao model should also be fuzzable with tlspuffin. We added support for SSH, which required us to abstract over certain protocol primitives such as messages, message parsing, the term algebra, and knowledge queries. The same abstraction we choose for TLS also, for the most part, works for SSH. However, the SSH protocol required a few adjustments because of a stateful serialization of protocol packets.

In order to test the SSH abstractions, we added support for fuzzing libssh (not to be confused with libssh2). As with wolfSSL, one of our first tasks was to create Rust bindings, which we plan to release separately as open-source software in the future.

### Toward a better Security Violation Oracle

Detecting security violations other than segmentation faults, buffer overflows, or use-after-free is essential for protocol fuzzers. In the world of fuzzers, an oracle decides whether a specific execution of the program under test reached some objective.

When using sanitizers like AddressSanitizer, buffer overflows or over-reads can make the program crash. In traditional fuzzing, the oracle decides whether the classical objective “program crashed” is fulfilled. This allows oracles to detect not only program crashes caused by segmentation faults, but also memory-related issues.

Many security issues like authentication bypasses or protocol downgrades in TLS libraries do not make themselves obvious by crashing. To address this, tlspuffin features a more sophisticated oracle that can detect protocol-specific problems. This allowed tlspuffin to rediscover not just vulnerabilities like [Heartbleed](https://heartbleed.com/) or [CVE-2021-3449](https://www.cve.org/CVERecord?id=CVE-2021-3449), but also logical vulnerabilities like [FREAK](https://www.cve.org/CVERecord?id=CVE-2015-0204). During my internship, we extended the capabilities of the security violation oracle to include authentication checks, which led us to rediscover two authentication bugs in wolfSSL ([CVE-2022-25640](https://www.cve.org/CVERecord?id=CVE-2022-25640) and [CVE-2022-25638](https://www.cve.org/CVERecord?id=CVE-2022-25638)). This indicates that tlspuffin automatically discovered these vulnerabilities without human interaction.

### Toward better Reproducibility

If the fuzzer discovers an alleged attack trace, then we as security researchers have to validate the finding. A good way to verify results is to execute them against an actual target like a TLS server or client over TCP. By using default settings, we can ensure that the setup of the fuzzing target is not causing false positives.

During the internship, we worked on a feature that allows users to execute a Dolev-Yao trace against clients or servers over TCP, which allows us to test attack traces against targets in isolation. One of these targets could be an OpenSSL server that is reachable over TCP. Every OpenSSL installation comes with such a server, which can be started using `openssl s_server -key key.pem -cert cert.pem`. A similar test server exists for wolfSSL. We can now execute traces through tlspuffin and see if the server crashes, misbehaves, or simply errors.

As described above, this enabled us to verify [CVE-2022-38153](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-38153) and to determine that a crash happens only when using a specific setup of the wolfSSL library.

## Conclusion

### Considerations for implementation

Despite this work, Dolev-Yao model-guided fuzzing also has drawbacks. Significant effort is required to integrate new fuzzing targets or protocols. Adding support for SSH took roughly five to six weeks, and adding a new fuzzing target took between one and two weeks. Finally, the fuzzer needed to be tested, bugs in the test harness needed to be resolved, and the fuzzer needed to be run for a reasonable length of time; in our case, finding bugs took another week. Note that letting a single instance of the fuzzer run for a long time might not be the best approach. Restarting the fuzzer every few days is a good approach to avoid that the fuzzer gets stuck in a “local minima” with respect to coverage.

Therefore, the overall process of applying Dolev-Yao model-guided fuzzing to an arbitrary cryptographic protocol and arbitrary implementation takes a few months. Based on these estimates, the fuzzing technique is best suited for ubiquitous protocols with multiple implementations like TLS or SSH, where the benefits outweigh the effort.

We noticed that protocol-specific features can increase the complexity of integration. For example, TLS uses transcripts, which can significantly increase the size of protocol messages. We applied a workaround for large transcripts in tlspuffin. In the case of SSH, we observed that message encoding and decoding is stateful, which means that messages are encoded differently based on the protocol state (a different MAC algorithm is used based on negotiated parameters).

On the contrary, testing existing or future TLS or SSH implementations through Dolev-Yao model-guided fuzzing is very promising. Investing a couple of weeks seems reasonable given that once a library is integrated into tlspuffin, it can be fuzzed continuously over many versions.

### Usage in test-suites

Developers can also use tlspuffin for writing test suites. It is possible to run traces against libraries, which test for the absence of specific authentication bugs. This allows for the implementation of regression tests to ensure that previous bugs do not occur again. In other words, tlspuffin can be used for the same tasks for which [TLS-Attacker](https://github.com/tls-attacker/TLS-Attacker) is currently used.

### Summary

To summarize, Dolev-Yao model-guided fuzzing is a novel and promising technique to fuzz test cryptographic protocols. It has proved its feasibility by rediscovering already-known authentication vulnerabilities and finding new DoS attacks in wolfSSL.

tlspuffin is a good fit for high-impact and widely used protocols like TLS or SSH. Integrating a new protocol into tlspuffin takes significant effort and requires an in-depth understanding of the protocol. In traditional fuzzing, domain-specific knowledge is sometimes relatively unimportant because simple fuzzers in a standard configuration can yield strong results. This advantage is lost if tlspuffin is used for protocols that are not yet supported.

Despite this, tlspuffin shines when it is used on an already-supported protocol. The internet heavily depends on the TLS and SSH protocols, and security issues affecting them have far-reaching implications. If TLS or SSH breaks, then the internet breaks. Luckily, this has not happened yet due to the great work of security researchers around the world. Let’s keep it that way by verifying, testing, and fuzzing cryptographic protocols!

I would like to wholeheartedly thank my mentor, Opal Wright. She supported me throughout my internship and motivated me by giving me plenty of praise for my work. I’d also like to give a great thanks to the entire cryptography team, who provided me with valuable feedback. Last but not least, I would like to thank my friends at INRIA for hosting me last year for my master thesis, which led to the development of tlspuffin. Without their mentorship and fundamental research, this work would not have been possible.

## Coordinated disclosure timeline

As part of the disclosure process, we reported four vulnerabilities in total to WolfSSL. The timeline of disclosure and remediation is provided below:

* August 12, 2022: Contacted wolfSSL support to set up a secure channel.* August 12, 2022: Reported CVE-2022-38152 and CVE-2022-38153 to wolfSSL.

### For CVE-2022-38152:

* August 12, 2022: wolfSSL maintainers confirmed and fixed the vulnerability.

### For CVE-2022-38153:

* August 16, 2022: wolfSSL maintainers confirmed the vulnerability.* August 17, 2022: wolfSSL maintainers fixed the vulnerability.

* August 30, 2022: wolfSSL released a fixed version, 5.5.0.* September 12, 2022: Reported CVE-2022-39173 to wolfSSL.

### For CVE-2022-39173:

* September 12, 2022: wolfSSL maintainers confirmed and fixed the vulnerability.* September 28, 2022: wolfSSL released a fixed version, 5.5.1.* October 09, 2022: Reported CVE-2022-42905 to wolfSSL.

### For CVE-2022-42905:

* October 10, 2022: wolfSSL maintainers confirmed and fixed the vulnerability.* October 28, 2022: wolfSSL released a fixed version, 5.5.2.

We would like to thank the team at wolfSSL for working swiftly with us to address these issues; they fixed one of the vulnerabilities on the same day it was submitted to them. The people involved at INRIA and Trail of Bits even got some swag delivered in appreciation of the disclosure.

[![](https://blog.trailofbits.com/wp-content/uploads/2023/01/Screenshot-2023-01-09-at-4.28.35-PM.png)](https://blog.trailofbits.com/wp-content/uploads/2023/01/Screenshot-2023-01-09-at-4.28.35-PM.png)

### Share this:

* [Twitter](https://blog.trailofbits.com/2023/01/12/wolfssl-vulnerabilities-tlspuffin-fuzzing-ssh/?share=twitter "Click to share on Twitter")
* [LinkedIn](https://blog.trailofbits.com/2023/01/12/wolfssl-vulnerabilities-tlspuffin-fuzzing-ssh/?share=linkedin "Click to share on LinkedIn")
* [Reddit](https://blog.trailofbits.com/2023/01/12/wolfssl-vulnerabilities-tlspuffin-fuzzing-ssh/?share=reddit "Click to share on Reddit")
* [Telegram](https://blog.trailofbits.com/2023/01/12/wolfssl-vulnerabilities-tlspuffin-fuzzing-ssh/?share=telegram "Click to share on Telegram")
* [Facebook](https://blog.trailofbits.com/2023/01/12/wolfssl-vulnerabilities-tlspuffin-fuzzing-ssh/?share=facebook "Click to share on Facebook")
* [Pocket](https://blog.trailofbits.com/2023/01/12/wolfssl-vulnerabilities-tlspuffin-fuzzing-ssh/?share=pocket "Click to share on Pocket")
* Email
* [Print](https://blog.trailofbits.com/2023/01/12/wolfssl-vulnerabilities-tlspuffin-fuzzing-ssh/#print "Click to print")
### Like this:

Like Loading...
### *Related*

By Trail of Bits

Posted in [Cryptography](https://blog.trailofbits.com/category/cryptography/), [Fuzzing](https://blog.trailofbits.com/category/fuzzing/), [Internship Projects](https://blog.trailofbits.com/category/internship-projects/), [Vulnerability Disclosure](https://blog.trailofbits.com/category/vulnerability-disclosure/)

# Post navigation

[← Another prolific year of open-source contributions](https://blog.trailofbits.com/2023/01/10/open-source-contributions-2022/) [Announcing a stable release of sigstore-python →](https://blog.trailofbits.com/2023/01/13/sigstore-python/)

### Leave a Reply[Cancel reply](/2023/01/12/wolfssl-vulnerabilities-tlspuffin-fuzzing-ssh/#respond)

Search

# About Us

Since 2012, Trail of Bits has helped secure some of the world’s most targeted organizations and products. We combine high-­end security research with a real­ world attacker mentality to reduce risk and fortify code.

Read more at [www.trailofbits.com](https://www.trailofbits.com)

# Subscribe via RSS

[![RSS feed](https://blog.trailofbits.com/wp-content/plugins/jetpack/images/rss/red-small.png) RSS - Posts](https://blog.trailofbits.com/feed/ "Subscribe to posts")

# Recent Posts

* [Auditing the Ruby ecosystem’s central package repository](https://blog.trailofbits.com/2024/12/11/auditing-the-ruby-ecosystems-central-package-repository/)
* [35 more Semgrep rules: infrastructure, supply chain, and Ruby](https://blog.trailofbits.com/2024/12/09/35-more-semgrep-rules-infrastructure-supply-chain-and-ruby/)
* [Evaluating Solidity support in AI coding assistants](https://blog.trailofbits.com/2024/11/19/evaluating-solidity-support-in-ai-coding-assistants/)
* [Attestations: A new generation of signatures on PyPI](https://blog.trailofbits.com/2024/11/14/attestations-a-new-generation-of-signatures-on-pypi/)
* [Killing Filecoin nodes](https://blog.trailofbits.com/2024/11/13/killing-filecoin-nodes/)
* [Fuzzing between the lines in popular barcode software](https://blog.trailofbits.com/2024/10/31/fuzzing-between-the-lines-in-popular-barcode-software/)
* [A deep dive into Linux’s new mseal syscall](https://blog.trailofbits.com/2024/10/25/a-deep-dive-into-linuxs-new-mseal-syscall/)
* [Auditing Gradio 5, Hugging Face’s ML GUI framework](https://blog.trailofbits.com/2024/10/10/auditing-gradio-5-hugging-faces-ml-gui-framework/)
* [Securing the software supply chain with the SLSA framework](https://blog.trailofbits.com/2024/10/01/securing-the-software-supply-chain-with-the-slsa-framework/)
* [A few notes on AWS Nitro Enclaves: Attack surface](https://blog.trailofbits.com/2024/09/24/notes-on-aws-nitro-enclaves-attack-surface/)
* [Announcing the Trail of Bits and Semgrep partnership](https://blog.trailofbits.com/2024/09/19/announcing-the-trail-of-bits-and-semgrep-partnership/)
* [Inside DEF CON: Michael Brown on how AI/ML is revolutionizing cybersecurity](https://blog.trailofbits.com/2024/09/17/inside-def-con-michael-brown-on-how-ai-ml-is-revolutionizing-cybersecurity/)
* [Friends don’t let friends reuse nonces](https://blog.trailofbits.com/2024/09/13/friends-dont-let-friends-reuse-nonces/)
* [Sanitize your C++ containers: ASan annotations step-by-step](https://blog.trailofbits.com/2024/09/10/sanitize-your-c-containers-asan-annotations-step-by-step/)
* [“Unstripping” binaries: Restoring debugging information in GDB with Pwndbg](https://blog.trailofbits.com/2024/09/06/unstripping-binaries-restoring-debugging-information-in-gdb-with-pwndbg/)
# Yearly Archive

* [2023](https://blog.trailofbits.com/2023)
* [2022](https://blog.trailofbits.com/2022)
* [2021](https://blog.trailofbits.com/2021)
* [2020](https://blog.trailofbits.com/2020)
* [2019](https://blog.trailofbits.com/2019)
* [2018](https://blog.trailofbits.com/2018)
* [2017](https://blog.trailofbits.com/2017)
* [2016](https://blog.trailofbits.com/2016)
* [2015](https://blog.trailofbits.com/2015)
* [2014](https://blog.trailofbits.com/2014)
* [2013](https://blog.trailofbits.com/2013)
* [2012](https://blog.trailofbits.com/2012)

# Categories

* [AIxCC](https://blog.trailofbits.com/category/aixcc/) (6)
* [Apple](https://blog.trailofbits.com/category/apple/) (13)
* [Application Security](https://blog.trailofbits.com/category/application-security/) (15)
* [Artificial Intelligence](https://blog.trailofbits.com/category/artificial-intelligence/) (1)
* [Attacks](https://blog.trailofbits.com/category/attacks/) (13)
* [Audits](https://blog.trailofbits.com/category/audits/) (11)
* [Authentication](https://blog.trailofbits.com/category/authentication/) (6)
* [Binary Ninja](https://blog.trailofbits.com/category/binary-ninja/) (15)
* [Blockchain](https://blog.trailofbits.com/category/blockchain/) (69)
* [C/C++](https://blog.trailofbits.com/category/c-c/) (1)
* [Capture the Flag](https://blog.trailofbits.com/category/capture-the-flag/) (11)
* [Careers](https://blog.trailofbits.com/category/careers/) (2)
* [CodeQL](https://blog.trailofbits.com/category/codeql/) (6)
* [Compilers](https://blog.trailofbits.com/category/compilers/) (30)
* [Conferences](https://blog.trailofbits.com/category/conferences/) (33)
* [Confidential Computing](https://blog.trailofbits.com/category/confidential-computing/) (1)
* [Containers](https://blog.trailofbits.com/category/containers/) (3)
* [Cryptography](https://blog.trailofbits.com/category/cryptography/) (68)
* [Crytic](https://blog.trailofbits.com/category/crytic/) (4)
* [Cyber Grand Challenge](https://blog.trailofbits.com/category/cyber-grand-challenge/) (8)
* [DARPA](https://blog.trailofbits.com/category/darpa/) (25)
* [Design Review](https://blog.trailofbits.com/category/design-review/) (1)
* [Dynamic Analysis](https://blog.trailofbits.com/category/dynamic-analysis/) (14)
* [eBPF](https://blog.trailofbits.com/category/ebpf/) (6)
* [Echidna](https://blog.trailofbits.com/category/echidna/) (1)
* [Ecosystem Security](https://blog.trailofbits.com/category/ecosystem-security/) (5)
* [Education](https://blog.trailofbits.com/category/education/) (17)
* [Empire Hacking](https://blog.trailofbits.com/category/empire-hacking/) (7)
* [Engineering Practice](https://blog.trailofbits.com/category/engineering-practice/) (16)
* [Events](https://blog.trailofbits.com/category/events/) (8)
* [Exploits](https://blog.trailofbits.com/category/exploits/) (30)
* [Fuzzing](https://blog.trailofbits.com/category/fuzzing/) (45)
* [Go](https://blog.trailofbits.com/category/go/) (8)
* [Guides](https://blog.trailofbits.com/category/guides/) (15)
* [Internship Projects](https://blog.trailofbits.com/category/internship-projects/) (38)
* [Invariant Development](https://blog.trailofbits.com/category/invariant-development/) (1)
* [iVerify](https://blog.trailofbits.com/category/iverify/) (5)
* [Kubernetes](https://blog.trailofbits.com/category/kubernetes/) (3)
* [Linux](https://blog.trailofbits.com/category/linux/) (8)
* [LLVM](https://blog.trailofbits.com/category/llvm/) (4)
* [Machine Learning](https://blog.trailofbits.com/category/machine-learning/) (27)
* [Malware](https://blog.trailofbits.com/category/malware/) (7)
* [Manticore](https://blog.trailofbits.com/category/manticore/) (17)
* [McSema](https://blog.trailofbits.com/category/mcsema/) (11)
* [Memory Safety](https://blog.trailofbits.com/category/memory-safety/) (2)
* [Meta](https://blog.trailofbits.com/category/meta/) (12)
* [Mitigations](https://blog.trailofbits.com/category/mitigations/) (11)
* [MLIR](https://blog.trailofbits.com/category/mlir/) (2)
* [Open Source](https://blog.trailofbits.com/category/open-source/) (14)
* [osquery](https://blog.trailofbits.com/category/osquery/) (23)
* [Paper Review](https://blog.trailofbits.com/category/paper-review/) (11)
* [People](https://blog.trailofbits.com/category/people/) (6)
* [Podcast](https://blog.trailofbits.com/category/podcast/) (1)
* [Policy](https://blog.trailofbits.com/category/policy/) (11)
* [Press Release](https://blog.trailofbits.com/category/press-release/) (30)
* [Privacy](https://blog.trailofbits.com/category/privacy/) (9)
* [Products](https://blog.trailofbits.com/category/products/) (8)
* [Program Analysis](https://blog.trailofbits.com/category/program-analysis/) (18)
* [Recruitment](https://blog.trailofbits.com/category/recruitment/) (1)
* [Remote Work](https://blog.trailofbits.com/category/remote-work/) (1)
* [Research Practice](https://blog.trailofbits.com/category/research-practice/) (30)
* [Reversing](https://blog.trailofbits.com/category/reversing/) (16)
* [Rust](https://blog.trailofbits.com/category/rust/) (7)
* [SafeDocs](https://blog.trailofbits.com/category/safedocs/) (1)
* [Semgrep](https://blog.trailofbits.com/category/semgrep/) (9)
* [Sinter](https://blog.trailofbits.com/category/sinter/) (1)
* [Slither](https://blog.trailofbits.com/category/slither/) (4)
* [Sponsorships](https://blog.trailofbits.com/category/sponsorships/) (12)
* [Static Analysis](https://blog.trailofbits.com/category/static-analysis/) (34)
* [Supply Chain](https://blog.trailofbits.com/category/supply-chain/) (3)
* [Symbolic Execution](https://blog.trailofbits.com/category/symbolic-execution/) (18)
* [Testing Handbook](https://blog.trailofbits.com/category/testing-handbook/) (5)
* [Threshold Signatures](https://blog.trailofbits.com/category/threshold-signatures/) (1)
* [Tool Release](https://blog.trailofbits.com/category/tool-release/) (5)
* [Training](https://blog.trailofbits.com/category/training/) (3)
* [Uncategorized](https://blog.trailofbits.com/category/uncategorized/) (33)
* [VAST](https://blog.trailofbits.com/category/vast/) (2)
* [Vulnerability Disclosure](https://blog.trailofbits.com/category/vulnerability-disclosure/) (20)
* [Windows](https://blog.trailofbits.com/category/windows/) (3)
* [Working at Trail of Bits](https://blog.trailofbits.com/category/working-at-trail-of-bits/) (2)
* [Year in Review](https://blog.trailofbits.com/category/year-in-review/) (6)
* [Zero Knowledge](https://blog.trailofbits.com/category/zero-knowledge/) (11)
[My Tweets](https://twitter.com/trailofbits)

## Discover more from Trail of Bits Blog

Subscribe now to keep reading and get access to the full archive.

Type your email…

Subscribe

Continue reading

##

##

Loading Comments...

Write a Comment...

Email (Required)

Name (Required)

Website

###

%d



=== Content from seclists.org_17de8431_20250108_131947.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](23)
[By Date](date.html#24)
[![Next](/images/right-icon-16x16.png)](25)

[![Previous](/images/left-icon-16x16.png)](23)
[By Thread](index.html#24)
[![Next](/images/right-icon-16x16.png)](25)

![](/shared/images/nst-icons.svg#search)

# wolfssl before 5.5.1: CVE-2022-39173 Buffer overflow when refining cipher suites

---

*From*: Maximilian Ammann via Fulldisclosure <fulldisclosure () seclists org>

*Date*: Wed, 26 Oct 2022 11:50:27 +0200

---

```
# wolfssl before 5.5.1: CVE-2022-39173 Buffer overflow when refining
cipher suites
==================================================================================

## INFO
=======

The CVE project has assigned the id CVE-2022-39173 to this issue.

Severity: high 7.5
Affected version: before 5.5.1
End of embargo: The embargo for this vulnerability ended 29th of September, 2022

## SUMMARY
==========

In wolfSSL before 5.5.1 malicious clients can cause a buffer-overflow
during a resumed TLS 1.3 handshake. If an attacker resumes a previous
TLS session by sending a maliciously crafted Client Hello, followed by
another maliciously crafted Client Hello. In total 2 Client Hellos
have to be sent. One which pretends to resume a previous session and a
second one as a response to a Hello Retry Request message.

The malicious Client Hellos contain a list of supported cipher suites,
which contain at least `⌊sqrt(150)⌋ + 1 = 13` duplicates and less than
150 ciphers in total. The buffer-overflow occurs in the `RefineSuites`
function. An overflow of 44700 bytes has been confirmed. Therefore,
large portions of the stack can get overwritten, including return
addresses.

We confirmed the vulnerability by sending packets over TCP to a
Wolfssl server, freshly built from the sources with the
`--enable-session-ticket` flags (or simply `--enable-all`). We can
provide sources for our software (tlspuffin) that produce those
packets (and that automatically found the attack trace). The command
given at the end of this document triggers the buffer overflow.

It is very likely that there is a way to craft an exploit which can
cause a RCE. We have not yet created such an exploit as it would
likely depend on the memory layout of the binary which uses wolfSSL.

Moreover, the size of the overflow can be fine-tuned in order to not
smash the stack and continue the execution with a too large length of
suites buffer and that will cause other routines that iterate over
thus buffer (e.g., `FindSuiteSSL`) to misbehave. Hypothetically, this
might be exploited to make the server use a cipher it should not
accept such as `nullcipher` that would open up new attack vectors such
as downgrade attacks.
While this has not been confirmed yet, the buffer overflow itself has
been confirmed.

## DETAILS
==========

Line numbers below are valid for the wolfSSL Git tag
[v5.4.0-stable](<https://github.com/wolfSSL/wolfssl/tree/v5.4.0-stable>).

The bug we found is in the `RefineSuites` function. In the following
we want to explain why the function is able to overflow the `suites`
array.
```c
/* Refine list of supported cipher suites to those common to server and client.
 *
 * ssl         SSL/TLS object.
 * peerSuites  The peer's advertised list of supported cipher suites.
 */
static void RefineSuites(WOLFSSL* ssl, Suites* peerSuites)
{
    byte   suites[WOLFSSL_MAX_SUITE_SZ];
    word16 suiteSz = 0;
    word16 i, j;

    XMEMSET(suites, 0, WOLFSSL_MAX_SUITE_SZ);

    for (i = 0; i < ssl->suites->suiteSz; i += 2) {
        for (j = 0; j < peerSuites->suiteSz; j += 2) {
            if (ssl->suites->suites[i+0] == peerSuites->suites[j+0] &&
                ssl->suites->suites[i+1] == peerSuites->suites[j+1]) {
                suites[suiteSz++] = peerSuites->suites[j+0];
                suites[suiteSz++] = peerSuites->suites[j+1];
            }
        }
    }

    ssl->suites->suiteSz = suiteSz;
    XMEMCPY(ssl->suites->suites, &suites, sizeof(suites));
#ifdef WOLFSSL_DEBUG_TLS
    [...]
#endif
}
```
tls13.c:4355

The `RefineSuites` function expects a `WOLFSSL` struct which contains
a list of acceptable ciphers suites (`ssl->suites->suites`), as well
as an array of peer cipher suites (`peerSuites`). Both inputs are
bounded by `WOLFSSL_MAX_SUITE_SZ`, which is equal to 300 bytes or 150
cipher suites.

Let us assume that `ssl->suites` consists of a single cipher suite
like `TLS_AES_256_GCM_SHA384` and the `peerSuites` list contains the
same cipher repeated thirteen times. The `RefineSuites` function will
iterate for each element in `ssl->suites` over `peerSuites` and append
the suite to `suites` if it is a match. The `suites` array has a
maximum length of `WOLFSSL_MAX_SUITE_SZ == 300 bytes == 150 suites`.

With the just mentioned example input, the length of `suites` will now
equal thirteen. The `suites` array is now copied to the `WOLFSSL`
struct in the last line of the listing above. Therefore, `ssl->suites`
contains now thirteen times the `TLS_AES_256_GCM_SHA384` cipher suite.

Let us now call the same `RefineSuites` function again on the modified
`WOLFSSL` struct and the same `peerSuites` list. The `RefineSuites`
function will iterate for each element in `ssl->suites` over
`peerSuites` and append the suite to `suites` if it is a match.
Because `ssl->suites` contains already 13 times the
`TLS_AES_256_GCM_SHA384` cipher suite, in total 13 x 13 = 169 cipher
suites are written to `suites`. 169 cipher suites require 338 bytes,
which is more than what's available on the stack. The `suites` buffer
overflows.

The maximum size of `peerSuites` is 150 cipher suites. Therefore, an
overflow of 44700 bytes is possible and has been confirmed.

The buffer `ssl->suites->suites` is supposed to be reset to only
contain the acceptable ciphers at each session start, and thus
initially contains no duplicate. However, by provoking a `HELLO CLIENT
RETRY REQUEST`, it is possible to make the server call `RefineSuites`
twice as explained next.

## TRIGGERING THE BUFFER OVERFLOW
=================================

In order to cause the above buffer-overflow, it is required to call
`RefineSuites` twice. Malicious clients need to perform the handshake
in a certain way to reach this situation.
The buffer overflow at the attacked server can be obtained at least in
the following situation:

1. Resume the previous session by sending a second Client Hello
(`CH2`) with the following criteria:
   - Exclude the `support_group_extension`, to cause a Hello Retry Request
   - Include a binder which cryptographically binds this session to
the previous one.
   - Include a list of cipher suites that contains a repetition of `n`
times the same cipher `c` with `13 <= n < 150`, deemed acceptable by
the server.

   The server will parse this message, enters the state
`SERVER_HELLO_RETRY_REQUEST_COMPLETE` and stores at least `n` times
the cipher `c` in `ssl->suites->suites` by calling `RefineSuites`.

2. Sending a third Client Hello (`CH3`) with the same criteria as in step 2.
   The server will parse this message and because
`ssl->suites->suites` already contains `n` times the cipher `c`,
`RefineSuites` will write in `suites` at least until `suites[nˆ2]`
which overflows since `nˆ2 > 300`.

## DETAILS ABOUT STEP 1.
========================

During step 2., we want to cause the server to perform a Hello Retry Request.

This is possible by not sending a supported group in the `CH2`. By not
sending a support group extension, the function
`TLSX_SupportedGroups_Find` will return false.

```c
static int TLSX_SupportedGroups_Find(WOLFSSL* ssl, word16 name)
{
    ...
        /* Check consistency now - extensions in any order. */
        if (!TLSX_SupportedGroups_Find(ssl, clientKSE->group))
            continue;
    ...
```
tls.c:8374

This will cause clientKSE to be `NULL` and `doHelloRetry` will be set to 1.

```c
int TLSX_KeyShare_Establish(WOLFSSL *ssl, int* doHelloRetry)
{
    ...
    /* No supported group found - send HelloRetryRequest. */
    if (clientKSE == NULL) {
        /* Set KEY_SHARE_ERROR to indicate HelloRetryRequest required. */
        *doHelloRetry = 1;
        return TLSX_KeyShare_SetSupported(ssl);
    }
    ...
```
tls.c:9273

Finally, the server enters the state
`SERVER_HELLO_RETRY_REQUEST_COMPLETE` in the function
`VerifyServerSuite` while verifying the server suite when processing
`CH2`.

```c
    /* Make sure server cert/key are valid for this suite, true on success
     * Returns 1 for valid server suite or 0 if not found
     * For asynchronous this can return WC_PENDING_E
     */
    static int VerifyServerSuite(WOLFSSL* ssl, word16 idx)
    {
        ...
        if (IsAtLeastTLSv1_3(ssl->version) &&
                                      ssl->options.side == WOLFSSL_SERVER_END) {
            int doHelloRetry = 0;
            /* Try to establish a key share. */
            int ret = TLSX_KeyShare_Establish(ssl, &doHelloRetry);
            if (doHelloRetry) {
                ssl->options.serverState = SERVER_HELLO_RETRY_REQUEST_COMPLETE;
            }

            ...
        }
        ...
```
tls.c:30688

## DETAILS ABOUT STEP 2.
====================

The server is now in a state in which it expects another Client Hello
(`CH3`) from the client.

The server is now in the state `SERVER_HELLO_RETRY_REQUEST_COMPLETE`
and will process the third ClientHello (`CH3`) with the call of
`ProcessReply` before reaching the `TLS13_ACCEPT_SECOND_REPLY_DONE`
state.

```c
int wolfSSL_accept_TLSv13(WOLFSSL* ssl)
{
    ...
        case TLS13_ACCEPT_FIRST_REPLY_DONE :
            if (ssl->options.serverState ==
                                          SERVER_HELLO_RETRY_REQUEST_COMPLETE) {
                ssl->options.clientState = CLIENT_HELLO_RETRY;
                while (ssl->options.clientState < CLIENT_HELLO_COMPLETE) {
                    if ((ssl->error = ProcessReply(ssl)) < 0) {
                        WOLFSSL_ERROR(ssl->error);
                        return WOLFSSL_FATAL_ERROR;
                    }
                }
            }

            ssl->options.acceptState = TLS13_ACCEPT_SECOND_REPLY_DONE;
            WOLFSSL_MSG("accept state ACCEPT_SECOND_REPLY_DONE");
            FALL_THROUGH;
    ...
```
tls13.c:10909

## VULNERABILITY VARIANTS
=========================

### Adjusting the overflow
Note that the length of the list of ciphers in `CH2` does not
necessarily have to be the same as the one of `CH1` and can be
adjusted to fine-tune the size of the overflow.

### Make the server parse `CH2`
Note also that, on the contrary to `CH1`, `CH2` does not necessarily
have to put the server in the `SERVER_HELLO_RETRY_REQUEST_COMPLETE`
state (which should be forbidden by the TLS 1.3 RFC) or make it return
an error, and can thus contain a supported group, which could be
included to possibly make the server continue the processing of `CH2`
without returning an error.
We have confirmed that we can make the server parses `CH2` until the
end and starts computing a Server Hello with `ssl->suites->suiteSz`
that exceeds 300.

### Resuming an existent session
It is also possible to trigger the vulnerability by trying to resume
an existent and genuine session established through a full initial
handshake (step 0.):
0. Sending an initial genuine Client Hello (`CH1`) to the server and
then completing a full handshake, thus establishing a PSK.

## EXPLOITATION
===============

We suspect that it is possible to craft an exploit which could lead to
RCE if any of the above bytes coincides with the memory address of
executable code. Depending on the memory layout of the binary it could
be possible to gain RCE.
More bytes could be used to overflow `suites` if more ciphers were
configured to be accepted with the server, e.g., with options like
`--enable-blake2`.

We confirmed that this could also be exploited to smash the stack and
cause the server to crash with a segmentation fault by using a large
list of ciphers.

Finally, by fine-tuning the length of the overflow and by including
the supported group in `CH3`, it could be possible to make the server
process `CH3` with a `ssl->suites->suites->suiteSz` value that exceeds
300. This way, routines like `FindSuiteSSL` that will iterate over
`ssl->suites->suites` (allocated on 300 bytes) until
`ssl->suites->suiteSz` (>300) will also iterate over bytes that
contain other fields such as `ssl->suites->hashSigAlgo`. It is likely
that this could be exploited to make such routines return arbitrary
values. For example, it might be exploited to make the server use a
cipher it should not accept such as `nullcipher`; thus breaking
confidentiality.

## FURTHER CONCERNS
==================

We observed that the server is accepting the `CH2` Client Hello
message and issues a Hello Retry Request, even though `CH2` does not
contain supported groups. Clients are not allowed to add the supported
groups extension in the retry Client Hello (`CH3`) according to the
RFC 8446 in section
[4.1.2](<https://www.rfc-editor.org/rfc/rfc8446#section-4.1.2>). The
addition of supported groups is not allowed when retrying the Client
Hello.
We suggest aborting the handshake when receiving `CH2` instead of
offering the client a retry.
_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <https://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](23)
[By Date](date.html#24)
[![Next](/images/right-icon-16x16.png)](25)

[![Previous](/images/left-icon-16x16.png)](23)
[By Thread](index.html#24)
[![Next](/images/right-icon-16x16.png)](25)

### Current thread:

* **wolfssl before 5.5.1: CVE-2022-39173 Buffer overflow when refining cipher suites** *Maximilian Ammann via Fulldisclosure (Oct 30)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from www.wolfssl.com_68cc31e8_20250108_131949.html ===

[Skip to content](#content)

* Questions? [Contact Us](https://www.wolfssl.com/contact/)
* [Support Forums](https://www.wolfssl.com/products/support-and-maintenance/)
* [![wolfSSL Japan](/wordpress/wp-content/uploads/2017/11/japan-site.png)](https://www.wolfssl.jp)

[Home![](https://www.wolfssl.com/wordpress/wp-content/uploads/2020/12/wolfssl_logo_300px.png)](https://www.wolfssl.com/)
[Menu Menu](#menu)

* [Home](https://www.wolfssl.com/)
* [About](https://www.wolfssl.com/about/)
  + [Contact Us](https://www.wolfssl.com/contact/)
  + [wolfSSL Software Development Process and Quality Assurance](https://www.wolfssl.com/about/wolfssl-software-development-process-quality-assurance/)
* [Products](https://www.wolfssl.com/products/)
  + [Post Quantum](https://www.wolfssl.com/products/wolfcrypt-post-quantum/)
  + [wolfSSL / wolfCrypt](https://www.wolfssl.com/products/wolfssl/)
  + [wolfCrypt FIPS 140-2/3](https://www.wolfssl.com/license/fips/)
  + [wolfHSM](https://www.wolfssl.com/products/wolfhsm/)
  + [DO-178](https://www.wolfssl.com/wolfssl-support-178-dal/)
  + [wolfTPM](https://www.wolfssl.com/products/wolftpm/)
  + [wolfMQTT](https://www.wolfssl.com/products/wolfmqtt/)
  + [wolfSSH](https://www.wolfssl.com/products/wolfssh/)
  + [wolfBoot](https://www.wolfssl.com/products/wolfboot/)
  + [wolfSentry IDPS](https://www.wolfssl.com/products/wolfsentry/)
  + [curl / tinycurl](https://www.wolfssl.com/products/curl/)
  + [wolfSSL JNI and JSSE Provider](https://www.wolfssl.com/products/wolfssl-jni-jsse/)
  + [wolfCrypt JNI and JCE Provider](https://www.wolfssl.com/products/wolfcrypt-jni-jce/)
  + [wolfCLU](https://www.wolfssl.com/products/wolfclu/)
* [Download](/download)
* [License](https://www.wolfssl.com/license/)
  + [Support and Maintenance](https://www.wolfssl.com/products/support-and-maintenance/)
  + [Consulting Services](https://www.wolfssl.com/docs/consulting/)
  + [FIPS 140-2 and FIPS 140-3](https://www.wolfssl.com/license/fips/)
  + [DO-178](https://www.wolfssl.com/wolfssl-support-178-dal/)
* [Blog](https://www.wolfssl.com/blog/)
* [Docs](https://www.wolfssl.com/docs/)
  + [FAQ](https://www.wolfssl.com/docs/frequently-asked-questions-faq/)
  + [wolfSSL Manual](https://www.wolfssl.com/documentation/manuals/wolfssl/index.html)
  + [YouTube Videos](https://www.youtube.com/wolfssl)
  + [Benchmarks](https://www.wolfssl.com/docs/benchmarks/)
  + [Case Studies](https://www.wolfssl.com/docs/case-studies/)
  + [White Papers](https://www.wolfssl.com/docs/wolfssl-white-papers/)
  + [Vulnerability Info](https://www.wolfssl.com/docs/security-vulnerabilities/)
* [Community](https://www.wolfssl.com/community/)
  + [Events / Webinars](https://www.wolfssl.com/events/)
  + [Forums](https://www.wolfssl.com/forums/)
* [Partners](https://www.wolfssl.com/community/partner-network/)
* Search for:

  *Search*

# WOLFSSL SECURITY VULNERABILITIES

This page lists known vulnerabilities for the wolfSSL embedded SSL/TLS library, wolfCrypt embedded crypto engine, and other wolfSSL products. Each vulnerability is linked to the description and CVE if available. Please [contact us](https://www.wolfssl.com/contact/) with any questions or concerns.

### Known wolfSSL Vulnerabilities

The SSL/TLS protocol is documented and under constant scrutiny by the top experts in security and cryptography. SSL was quickly adopted as a standard world wide. SSL and TLS together secure communications between billions of computers, servers, Internet of Things (IoT) devices, and embedded systems. The security provided by an SSL/TLS Library depends on the underlying strength of its cryptography which is used to encrypt communications.

| INFO | CVE ID | SEVERITY | DESCRIPTION | TIME TO FIX | FIXED IN VERSION |
| --- | --- | --- | --- | --- | --- |
| [LINK](https://github.com/wolfSSL/wolfssl/blob/master/ChangeLog.md) | N/A | Low | When the OpenSSL compatibility layer is enabled, certificate verification behaved differently in wolfSSL than OpenSSL, in the X509\_STORE\_add\_cert() and X509\_STORE\_load\_locations() implementations. Previously, in cases where an application explicitly loaded an intermediate certificate, wolfSSL was verifying only up to that intermediate certificate, rather than verifying up to the root CA. This only affects use cases where the API is called directly, and does not affect TLS connections. Users that call the API X509\_STORE\_add\_cert() or X509\_STORE\_load\_locations() directly in their applications are recommended to update the version of wolfSSL used or to have additional sanity checks on certificates loaded into the X509\_STORE when verifying a certificate. Fixed in GitHub PR #8087. | TBD | 5.7.4 |
| [LINK](https://github.com/wolfSSL/wolfssl/blob/master/ChangeLog.md) | [CVE-2024-5288](https://www.cve.org/cverecord?id=CVE-2024-5288) | Medium | A private key blinding operation, enabled by defining the macro WOLFSSL\_BLIND\_PRIVATE\_KEY, was added to mitigate a potential row hammer attack on ECC operations. If performing ECC private key operations in an environment where a malicious user could gain fine control over the device and perform row hammer style attacks it is recommended to update the version of wolfSSL used and to build with WOLFSSL\_BLIND\_PRIVATE\_KEY defined. Thanks to Kemal Derya, M. Caner Tol, Berk Sunar for the report (Vernam Applied Cryptography and Cybersecurity Lab at Worcester Polytechnic Institute) Fixed in github pull request #7416 | 8 days | 5.7.2 |
| [LINK](https://github.com/wolfSSL/wolfssl/blob/master/ChangeLog.md) | N/A | Low | When parsing a provided maliciously crafted certificate directly using wolfSSL API, outside of a TLS connection, a certificate with an excessively large number of extensions could lead to a potential DoS. There are existing sanity checks during a TLS handshake with wolfSSL which mitigate this issue. Thanks to Bing Shi for the report. Fixed in github pull request #7597 | 5 days | 5.7.2 |
| [LINK](https://github.com/wolfSSL/wolfssl/blob/master/ChangeLog.md) | [CVE-2024-5991](https://www.cve.org/cverecord?id=CVE-2024-5991) | Low | In the function MatchDomainName(), input param str is treated as a NULL terminated string despite being user provided and unchecked. Specifically, the Openssl compatibility function X509\_check\_host() takes in a pointer and length to check against, with no requirements that it be NULL terminated. While calling without a NULL terminated string is very uncommon, it is still technically allowed. If a caller was attempting to do a name check on a non\*NULL terminated buffer, the code would read beyond the bounds of the input array until it found a NULL terminator. Fixed in github pull request #7604 | 17 days | 5.7.2 |
| [LINK](https://github.com/wolfSSL/wolfssl/blob/master/ChangeLog.md) | [CVE-2024-5814](https://www.cve.org/cverecord?id=CVE-2024-5814) | Medium | A malicious TLS1.2 server can force a TLS1.3 client with downgrade capability to use a ciphersuite that it did not agree to and achieve a successful connection. This is because, aside from the extensions, the client was skipping fully parsing the server hello when downgrading from TLS 1.3. Fixed in github pull request #7619 | 5 days | 5.7.2 |
| [LINK](https://github.com/wolfSSL/wolfssl/blob/master/ChangeLog.md) | N/A | Medium | OCSP stapling version 2 response verification bypass issue when a crafted response of length 0 is received. Found with internal testing. Fixed in github pull request #7702 | 12 days | 5.7.2 |
| [LINK](https://github.com/wolfSSL/wolfssl/blob/master/ChangeLog.md) | N/A | Medium | OCSP stapling version 2 revocation bypass with a retry of a TLS connection attempt. A revoked CA certificate could incorrectly be loaded into the trusted signers list and used in a repeat connection attempt. Found with internal testing. Fixed in github pull request #7702 | 5 days | 5.7.2 |
| [LINK](https://github.com/wolfSSL/wolfssl/blob/master/ChangeLog.md) | [CVE-2024-2881](https://www.cve.org/cverecord?id=CVE-2024-2881) | Medium | Fault injection attack with EdDSA signature operations. This affects ed25519 sign operations where the system could be susceptible to Rowhammer attacks. Thanks to Junkai Liang, Zhi Zhang, Xin Zhang, Qingni Shen for the report (Peking University, The University of Western Australia). Fixed in this GitHub pull request #7212 | 0 days | 5.7.0 |
| [LINK](https://github.com/wolfSSL/wolfssl/blob/master/ChangeLog.md) | [CVE-2024-1545](https://www.cve.org/cverecord?id=CVE-2024-1545) | Medium | Fault Injection vulnerability in RsaPrivateDecryption function that potentially allows an attacker that has access to the same system with a victims process to perform a Rowhammer fault injection. Thanks to Junkai Liang, Zhi Zhang, Xin Zhang, Qingni Shen for the report (Peking University, The University of Western Australia)." Fixed in this GitHub pull request #7167 | 9 days | 5.7.0 |
| [LINK](https://github.com/wolfSSL/wolfssl/blob/master/ChangeLog.md) | [CVE-2024-0901](https://www.cve.org/cverecord?id=CVE-2024-0901) | High | Potential denial of service and out of bounds read. Affects TLS 1.3 on the server side when accepting a connection from a malicious TLS 1.3 client. If using TLS 1.3 on the server side it is recommended to update the version of wolfSSL used. Fixed in this GitHub pull request #7099 | 5 days | 5.7.0 |
| [LINK](https://github.com/wolfSSL/wolfssl/blob/master/ChangeLog.md) | [CVE-2024-1544](https://www.cve.org/cverecord?id=CVE-2024-1544) | Medium | Potential ECDSA nonce side channel attack in versions of wolfSSL before 5.6.6 with wc\_ecc\_sign\_hash calls. Generating the ECDSA nonce k samples a random number r and then truncates this randomness with a modular reduction mod n where n is the order of the elliptic curve. Analyzing the division through a control-flow revealing side-channel reveals a bias in the most significant bits of k. Depending on the curve this is either a negligible bias or a significant bias large enough to reconstruct k with lattice reduction methods. Thanks to Luca Wilke, Florian Sieck and Thomas Eisenbarth (University of Lübeck) for reporting the vulnerability. Details will appear in the proceedings of CCS 24. Fixed #7020 | 0 days | 5.6.6 |
| [LINK](https://github.com/wolfSSL/wolfssl/blob/master/ChangeLog.md) | [CVE-2023-6935](https://www.cve.org/cverecord?id=CVE-2023-6935) | Medium | After review of the previous RSA timing fix in wolfSSL 5.6.4, additional changes were found to be required. A complete resistant change is delivered in this release. This fix is for the Marvin attack, leading to being able to decrypt a saved TLS connection and potentially forge a signature after probing with a very large number of trial connections. This issue is around RSA decryption and affects the optional static RSA cipher suites on the server side, which are considered weak, not recommended to be used and are off by default in wolfSSL (even with –enable-all). Static RSA cipher suites were also removed from the TLS 1.3 protocol and are only present in TLS 1.2 and lower. All padding versions of RSA decrypt are affected since the code under review is outside of the padding processing. Information about the private keys is NOT compromised in affected code. It is recommended to disable static RSA cipher suites and update the version of wolfSSL used if using RSA private decryption alone outside of TLS. Thanks to Hubert Kario for the report. The fix for this issue is located in the following GitHub Pull Request: https://github.com/wolfSSL/wolfssl/pull/6955. | 8 days | 5.6.6 |
| [LINK](https://github.com/wolfSSL/wolfssl/blob/master/ChangeLog.md) | [CVE-2023-6936](https://www.cve.org/cverecord?id=CVE-2023-6936) | Low | A potential heap overflow read is possible in servers connecting over TLS 1.3 when the optional WOLFSSL\_CALLBACKS has been defined. The out of bounds read can occur when a server receives a malicious malformed ClientHello. Users should either discontinue use of WOLFSSL\_CALLBACKS on the server side or update versions of wolfSSL to 5.6.6. Thanks to the tlspuffin fuzzer team for the report which was designed and developed by; Lucca Hirschi (Inria, LORIA), Steve Kremer (Inria, LORIA), and Max Ammann (Trail of Bits). The fix for this issue is located in the following GitHub Pull Request: https://github.com/wolfSSL/wolfssl/pull/6949. | 8 days | 5.6.6 |
| [LINK](https://github.com/wolfSSL/wolfssl/blob/master/ChangeLog.md) | [CVE-2024-1543](https://www.cve.org/cverecord?id=CVE-2024-1543) | Low | A side channel vulnerability with AES T-Tables is possible in a very controlled environment where precision sub-cache-line inspection can happen, such as inside an Intel SGX enclave. This can lead to recovery of the AES key. To prevent this type of attack, wolfSSL added an AES bitsliced implementation which can be enabled with the “--enable-aes-bitsliced” configure option. Thanks to Florian Sieck, Zhiyuan Zhang, Sebastian Berndt, Chitchanok Chuengsatiansup, Thomas Eisenbarth, and Yuval Yarom for the report (Universities of Lübeck, Melbourne, Adelaide and Bochum). The fix for this issue is located in the following GitHub Pull Request: https://github.com/wolfSSL/wolfssl/pull/6854. | 11 days | 5.6.6 |
| [LINK](https://github.com/wolfSSL/wolfssl/blob/master/ChangeLog.md) | [CVE-2023-6937](https://www.cve.org/cverecord?id=CVE-2023-6937) | Low | wolfSSL prior to 5.6.6 did not check that messages in a single (D)TLS record do not span key boundaries. As a result, it was possible to combine (D)TLS messages using different keys into one (D)TLS record. The most extreme edge case is that, in (D)TLS 1.3, it was possible that an unencrypted (D)TLS 1.3 record from the server containing first a ServerHello message and then the rest of the first server flight would be accepted by a wolfSSL client. In (D)TLS 1.3 the handshake is encrypted after the ServerHello but a wolfSSL client would accept an unencrypted flight from the server. This does not compromise key negotiation and authentication so it is assigned a low severity rating. Thanks to Johannes Wilson for the report (Sectra Communications and Linköping University). The fix for this issue is located in the following GitHub Pull Request: https://github.com/wolfSSL/wolfssl/pull/7029. | 12 days | 5.6.6 |
| [LINK](https://github.com/wolfSSL/wolfssl/blob/master/ChangeLog.md) | [CVE-2023-3724](https://www.cve.org/cverecord?id=CVE-2023-3724) | High | In previous versions of wolfSSL if a TLS 1.3 client gets neither a PSK (pre shared key) extension nor a KSE (key share extension) when connecting to a malicious server, a default predictable buffer gets used for the IKM value when generating the session master secret. Using a potentially known IKM value when generating the session master secret key compromises the key generated, allowing an eavesdropper to reconstruct it and potentially allowing surreptitious access to or meddling with message contents in the session. This issue does not affect client validation of connected servers, nor expose private key information, but could result in an insecure TLS 1.3 session when not controlling both sides of the connection. We recommend that TLS 1.3 client side users update the version of wolfSSL used. Thanks to Johannes from Sectra Communications and Linköping University for the report. Fixed in the following GitHub pull request #6412 | 5 days | 5.6.2 |
| [LINK](https://github.com/wolfSSL/wolfssl/blob/master/ChangeLog.md) | N/A | Low | In cases where a malicious agent could analyze cache timing at a very detailed level, information about the AES key used could be leaked during T/S Box lookups. One such case was shown on RISC-V hardware using the MicroWalk tool (https://github.com/microwalk-project/Microwalk). A hardened version of T/S Box lookups was added in wolfSSL to help mitigate this potential attack and is now on by default with RISC-V builds and can be enabled on other builds if desired by compiling wolfSSL with the macro WOLFSSL\_AES\_TOUCH\_LINES. Thanks to Jan Wichelmann, Christopher Peredy, Florian Sieck, Anna Pätschke, Thomas Eisenbarth (University of Lübeck): MAMBO-V: Dynamic Side-Channel Leakage Analysis on RISC-V. Fixed in the following GitHub pull request #6309 | 4 days | 5.6.2 |
| [LINK](https://github.com/wolfSSL/wolfssl/blob/master/ChangeLog.md) | [CVE-2022-42905](https://www.cve.org/CVERecord?id=CVE-2022-42905) | Medium | In the case that the WOLFSSL\_CALLBACKS macro is set when building wolfSSL, there is a potential heap over read of 5 bytes when handling TLS 1.3 client connections. This heap over read is limited to wolfSSL builds explicitly setting the macro WOLFSSL\_CALLBACKS, the feature does not get turned on by any other build options. The macro WOLFSSL\_CALLBACKS is intended for debug use only, but if having it enabled in production, users are recommended to disable WOLFSSL\_CALLBACKS. Users enabling WOLFSSL\_CALLBACKS are recommended to update their version of wolfSSL. Thanks to Lucca Hirschi and Steve Kremer from LORIA, Inria and Max Ammann from Trail of Bits for finding and reporting the bug with the tlspuffin tool developed partly at LORIA and Trail of Bits. | 1 day | 5.5.2 |
| [LINK](https://github.com/wolfSSL/wolfssl/blob/master/ChangeLog.md) | [CVE-2022-39173](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-39173) | Medium | Denial of service attack and buffer overflow against TLS 1.3 servers using session ticket resumption. When built with --enable-session-ticket and making use of TLS 1.3 server code in wolfSSL, there is the possibility of a malicious client to craft a malformed second ClientHello packet that causes the server to crash. This issue is limited to when using both --enable-session-ticket and TLS 1.3 on the server side. Users with TLS 1.3 servers, and having --enable-session-ticket, should update to the latest version of wolfSSL. Thanks to Max at Trail of Bits for the report, found by Lucca Hirschi from LORIA, Inria, France with the tlspuffin tool developed partly at LORIA and Trail of Bits. | 0 days | 5.5.1 |
| [LINK](https://github.com/wolfSSL/wolfssl/blob/master/ChangeLog.md) | [CVE-2022-42961](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-42961) | Low | Fault injection attack on RAM via Rowhammer leads to ECDSA key disclosure. Users doing operations with private ECC keys such as server side TLS connections and creating ECC signatures, who also have hardware that could be targeted with a sophisticated Rowhammer attack should update the version of wolfSSL and compile using the macro WOLFSSL\_CHECK\_SIG\_FAULTS. Thanks to Yarkin Doroz, Berk Sunar, Koksal Must, Caner Tol, and Kristi Rahman all affiliated with the Vernam Applied Cryptography and Cybersecurity Lab at Worcester Polytechnic Institute for the report. | 5 days | 5.5.0 |
| [LINK](https://github.com/wolfSSL/wolfssl/blob/master/ChangeLog.md) | [CVE-2022-38153](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-38153) | Low | In wolfSSL version 5.3.0 if compiled with --enable-session-ticket and the client has non-empty session cache, with TLS 1.2 there is the possibility of a man in the middle passing a large session ticket to the client and causing a crash due to an invalid free. There is also the potential for a malicious TLS 1.3 server to crash a client in a similar manner except in TLS 1.3 it is not susceptible to a man in the middle attack. Users on the client side with –enable-session-ticket compiled in and using wolfSSL version 5.3.0 should update their version of wolfSSL. Thanks to Max at Trail of Bits for the report and "LORIA, INRIA, France" for research on tlspuffin. | 5 days | 5.5.0 |
| [LINK](https://github.com/wolfSSL/wolfssl/blob/master/ChangeLog.md) | [CVE-2022-38152](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-38152) | Low | If using wolfSSL\_clear to reset a WOLFSSL object (vs the normal wolfSSL\_free/wolfSSL\_new) it can result in runtime issues. This exists with builds using the wolfSSL compatibility layer (--enable-opnesslextra) and only when the application is making use of wolfSSL\_clear instead of SSL\_free/SSL\_new. In the case of a TLS 1.3 resumption, after continuing to use the WOLFSSH object after having called wolfSSL\_clear, an application could crash. It is suggested that users calling wolfSSL\_clear update the version of wolfSSL used. Thanks to Max at Trail of Bits for the report and "LORIA, INRIA, France" for research on tlspuffin. | 2 days | 5.5.0 |
| [LINK](https://github.com/wolfSSL/wolfssl/blob/master/ChangeLog.md) | N/A | Medium | Potential DoS attack on DTLS 1.2. In the case of receiving a malicious plaintext handshake message at epoch 0 the connection will enter an error state reporting a duplicate message. This affects both server and client side. Users that have DTLS enabled and in use should update their version of wolfSSL to mitigate the potential for a DoS attack. | 0 days | 5.5.0 |
| [LINK](https://github.com/wolfSSL/wolfssl/blob/master/ChangeLog.md) | [CVE-2022-34293](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-34293) | High | Potential for DTLS DoS attack. In wolfSSL versions before 5.4.0 the return-routability check is wrongly skipped in a specific edge case. The check on the return-routability is there for stopping attacks that either consume excessive resources on the server, or try to use the server as an amplifier sending an excessive amount of messages to a victim IP. If using DTLS 1.0/1.2 on the server side users should update to avoid the potential DoS attack. | 4 days | 5.4.0 |
| [LINK](https://github.com/wolfSSL/wolfssl/blob/master/ChangeLog.md) | N/A | Medium | Ciphertext side channel attack on ECC and DH operations. Users on systems where rogue agents can monitor memory use should update the version of wolfSSL and change private ECC keys. Thanks to Sen Deng from Southern University of Science and Technology (SUSTech) for the report. | 6 days | 5.4.0 |
| [LINK](https://github.com/wolfSSL/wolfssl/blob/master/ChangeLog.md) | [CVE-2022-25640](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-25640) | High | A TLS v1.3 server who requires mutual authentication can be bypassed. If a malicious client does not send the certificate\_verify message a client can connect without presenting a certificate even if the server requires one. Thank you to Aina Toky Rasoamanana and Olivier Levillain of Télécom SudParis. | 11 days | 5.2.0 |
| [LINK](https://github.com/wolfSSL/wolfssl/blob/master/ChangeLog.md) | [CVE-2022-25638](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-25638) | High | A TLS v1.3 client attempting to authenticate a TLS v1.3 server can have its certificate check bypassed. If the sig\_algo in the certificate\_verify message is different than the certificate message checking may be bypassed. Thank you to Aina Toky Rasoamanana and Olivier Levillain of Télécom SudParis. | 6 days | 5.2.0 |
| [LINK](https://github.com/wolfSSL/wolfssl/blob/master/ChangeLog.md) | [CVE-2022-23408](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-23408) | High | In connections using AES-CBC or DES3 with TLS/DTLS 1.2 or 1.1 the IV being used is not random. Users using wolfSSL version 5.0.0 or 5.1.0 doing TLS/DTLS 1.2 or 1.1 connections, without AEAD only, should update the version of wolfSSL used. | 0 days | 5.1.1 |
| [LINK](https://github.com/wolfSSL/wolfssl/blob/master/ChangeLog.md) | [CVE-2020-12966](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-12966) [CVE-2021-46744](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-46744) | Medium | Public disclosure of a side channel vulnerability that has been fixed since wolfSSL version 5.1.0. When running on AMD there is the potential to leak private key information with ECDSA operations due to a ciphertext side channel attack. Users on AMD doing ECDSA operations with wolfSSL versions less than 5.1.0 should update their wolfSSL version used. Thanks to professor Yinqian Zhang from Southern University of Science and Technology (SUSTech), his Ph.D. student Mengyuan Li from The Ohio State University, and his M.S students Sen Deng and Yining Tang from SUStech along with other collaborators; Luca Wilke, Jan Wichelmann and Professor Thomas Eisenbarth from the University of Lubeck, Professor Shuai Wang from Hong Kong University of Science and Technology, Professor Radu Teodorescu from The Ohio State University, Huibo Wang, Kang Li and Yueqiang Cheng from Baidu Security and Shoumeng Yang from Ant Financial Services Group. | Fixed 107 days prior to CVE issuance. | 5.1.0 |
| [LINK](https://github.com/wolfSSL/wolfssl/blob/master/ChangeLog.md) | CVE-2021-44718 | Low | Potential for DoS attack on a wolfSSL client due to processing hello packets of the incorrect side. This affects only connections using TLS v1.2 or less that have also been compromised by a man in the middle attack. Thanks to James Henderson, Mathy Vanhoef, Chris M. Stone, Sam L. Thomas, Nicolas Bailleut, and Tom Chothia (University of Birmingham, KU Leuven, ENS Rennes for the report. | 0 days | 5.1.0 |
| [LINK](https://github.com/wolfSSL/wolfssl/blob/master/ChangeLog.md) | N/A | Low | Client side session resumption issue once the session resumption cache has been filled up. The hijacking of a session resumption has been demonstrated so far with only non verified peer connections. That is where the client is not verifying the server’s CA that it is connecting to. There is the potential though for other cases involving proxies that are verifying the server to be at risk, if using wolfSSL in a case involving proxies use wolfSSL\_get1\_session and then wolfSSL\_SESSION\_free when done where possible. If not adding in the session get/free function calls we recommend that users of wolfSSL that are resuming sessions update to the latest version (wolfSSL version 5.1.0 or later). Thanks to the UK's National Cyber Security Centre (NCSC) for the report. | 6 days | 5.1.0 |
| [LINK](https://github.com/wolfSSL/wolfssl/blob/master/ChangeLog.md) | N/A | Low | Hang with DSA signature creation when a specific q value is used in a maliciously crafted key. If a DSA key with an invalid q value of either 1 or 0 was decoded and used for creating a signature, it would result in a hang in wolfSSL. Users that are creating signatures with DSA and are using keys supplied from an outside source are affected. | 3 days | 5.0.0 |
| [LINK](https://github.com/wolfSSL/wolfssl/blob/master/ChangeLog.md) | N/A | Low | Issue with incorrectly validating a certificate that has multiple subject alternative names when given a name constraint. In the case where more than one subject alternative name is used in the certificate, previous versions of wolfSSL could incorrectly validate the certificate. Users verifying certificates with multiple alternative names and name constraints, are recommended to either use the certificate verify callback to check for this case or update the version of wolfSSL used. Thanks to Luiz Angelo Daros de Luca for the report. | 2 days | 5.0.0 |
| [LINK](https://github.com/wolfSSL/wolfssl/blob/master/ChangeLog.md) | [CVE-2021-38597](https://nvd.nist.gov/vuln/detail/CVE-2021-38597) | High | OCSP verification issue when response is for a certificate with no relation to the chain in question BUT that response contains the NoCheck extension which effectively disables ALL verification of that one cert. Users who should upgrade to 4.8.1 are TLS client users doing OCSP, TLS server users doing mutual auth with OCSP, and CertManager users doing OCSP independent of TLS. Thanks to Jan Nauber, Marco Smeets, Werner Rueschenbaum and Alissa Kim for the report. | 8 days | 4.8.1 |
| [LINK](https://github.com/wolfSSL/wolfssl/blob/master/ChangeLog.md) | N/A | Low | OCSP request/response verification issue. In the case that the serial number in the OCSP request differs from the serial number in the OCSP response the error from the comparison was not resulting in a failed verification. We recommend users that have wolfSSL version 4.6.0 and 4.7.0 with OCSP enabled update their version of wolfSSL. Version 4.5.0 and earlier are not affected by this report. Thanks to Rainer, Roee, Barak, Hila and Shoshi (from Cymotive and CARIAD) for the report. | 2 days | 4.8.0 |
| [LINK](https://github.com/wolfSSL/wolfssl/blob/master/ChangeLog.md) | [CVE-2021-3336](https://nvd.nist.gov/vuln/detail/CVE-2021-3336) | High | In earlier versions of wolfSSL there exists a potential man in the middle attack on TLS 1.3 clients. Malicious attackers with a privileged network position can impersonate TLS 1.3 servers and bypass authentication. Users that have applications with client side code and have TLS 1.3 turned on, should update to the latest version of wolfSSL. Users that do not have TLS 1.3 turned on, or that are server side only, are NOT affected by this report. For the code change see https://github.com/wolfSSL/wolfssl/pull/3676. Thanks to Aina Toky Rasoamanana and Olivier Levillain from Télécom SudParis for the report. | Fixed 12 days prior to CVE issuance | 4.7.0 |
| [LINK](https://github.com/wolfSSL/wolfssl/blob/master/ChangeLog.md) | N/A | Low | In the case of using custom ECC curves there is the potential for a crafted compressed ECC key that has a custom prime value to cause a hang when imported. This only affects applications that are loading in ECC keys with wolfSSL builds that have compressed ECC keys and custom ECC curves enabled. | 1 day | 4.7.0 |
| [LINK](https://github.com/wolfSSL/wolfssl/blob/master/ChangeLog.md) | N/A | Low | With TLS 1.3 authenticated-only ciphers a section of the server hello could contain 16 bytes of uninitialized data when sent to the connected peer. This affects only a specific build of wolfSSL with TLS 1.3 early data enabled and using authenticated-only ciphers with TLS 1.3. | 12 days | 4.7.0 |
| [LINK](https://github.com/wolfSSL/wolfssl/blob/master/ChangeLog.md) | [CVE-2021-24116](https://nvd.nist.gov/vuln/detail/CVE-2021-24116) | Low | Side-Channel cache look up vulnerability in base64 PEM decoding for versions of wolfSSL 4.5.0 and earlier. Versions 4.6.0 and up contain a fix and do not need to be updated for this report. If decoding a PEM format private key using version 4.5.0 and older of wolfSSL then we recommend updating the version of wolfSSL used. Thanks to Florian Sieck, Jan Wichelmann, Sebastian Berndt and Thomas Eisenbarth for the report. | Fixed 7 months prior to CVE issuance | 4.6.0 |
| [LINK](https://github.com/wolfSSL/wolfssl/blob/master/ChangeLog.md) | [CVE-2020-36177](https://nvd.nist.gov/vuln/detail/CVE-2020-36177) | High | RsaPad\_PSS in wolfcrypt/src/rsa.c in wolfSSL before 4.6.0 has an out-of-bounds write for certain relationships between key size and digest size. | 1 day | 4.6.0 |
| [LINK](https://research.nccgroup.com/2020/08/24/technical-advisory-wolfssl-tls-1-3-client-man-in-the-middle-attack/) | [CVE-2020-24613](https://nvd.nist.gov/vuln/detail/CVE-2020-24613) | High | In wolfSSL versions prior to 4.5.0 there exists a potential man in the middle attack on TLS 1.3 clients. Malicious attackers with a privileged network position can impersonate TLS 1.3 servers and bypass authentication. Users that have applications with client side code and have TLS 1.3 turned on, should update to the latest version of wolfSSL. Users that do not have TLS 1.3 turned on, or that are server side only, are NOT affected by this report. Thanks to Gerald Doussot from NCC group for the report. | 2 days | 4.5.0 |
| [LINK](https://www.wolfssl.com/wolfssl-4-5-0-now-available/) | [CVE-2020-12457](https://nvd.nist.gov/vuln/detail/CVE-2020-12457) | Low | In wolfSSL versions prior to 4.5.0, a denial of service attack on TLS 1.3 servers from repetitively sending ChangeCipherSpecs messages is possible. This denial of service results from the relatively low effort of sending a ChangeCipherSpecs message versus the effort of the server to process that message. Users with TLS 1.3 servers are recommended to update to the most recent version of wolfSSL which limits the number of TLS 1.3 ChangeCipherSpecs that can be received in order to avoid this DoS attack. CVE-2020-12457 was reserved for the report. Thanks to Lenny Wang of Tencent Security Xuanwu LAB. | Fixed 114 days prior to CVE issuance | 4.5.0 |
| [LINK](https://www.wolfssl.com/wolfssl-4-5-0-now-available/) | [CVE-2020-15309](https://nvd.nist.gov/vuln/detail/CVE-2020-15309) | Low | wolfSSL versions prior to 4.5.0 included a potential cache timing attack on public key operations in builds that are not using SP (single precision). Users that have a system where malicious agents could execute code on the system, are not using the SP build with wolfSSL, and are doing private key operations on the system (such as signing with a private key) are recommended to regenerate private keys and update to the most recent version of wolfSSL. CVE-2020-15309 is reserved for this issue. Thanks to Ida Bruhns from Universität zu Lübeck for the report. | Fixed 57 days prior to CVE issuance | 4.5.0 |
| [LINK](https://www.wolfssl.com/wolfssl-4-5-0-now-available/) | N/A | Low | In wolfSSL versions prior to 4.5.0, when using SGX with EC scalar multiplication the possibility of side-channel attacks are present. To mitigate the risk of side channel attacks wolfSSL’s single precision EC operations should be used instead. Release 4.5.0 turns this on be default now with SGX builds and in previous versions of wolfSSL this can be turned on by using the WOLFSSL\_SP macros. Thank you to Alejandro Cabrera Aldaya, Cesar Pereida García and Billy Bob Brumley from the Network and Information Security Group (NISEC) at Tampere University for the report. | 1 day | 4.5.0 |
| [LINK](https://www.wolfssl.com/wolfssl-4-5-0-now-available/) | N/A | High | wolfSSL versions prior to 4.5.0 may leak the private key in the case that PEM format private keys are bundled in with PEM certificates into a single file. This is due to the misclassification of certificate type versus private key type when parsing through the PEM file. To be affected, wolfSSL would need to have been built with OPENSSL\_EXTRA (--enable-opensslextra). Some build variants such as --enable-all and --enable-opensslall also turn on this code path, checking wolfssl/options.h for OPENSSL\_EXTRA will show if the macro was used with the build. If having built with the opensslextra enable option and having placed PEM certificates with PEM private keys in the same file when loading up the certificate file, then we recommend updating wolfSSL for this use case and also recommend regenerating any private keys in the file. | 1 day | 4.5.0 |
| [LINK](https://www.wolfssl.com/wolfssl-4-5-0-now-available/) | N/A | Low | In wolfSSL versions prior to 4.5.0, during the handshake, clear application\_data messages in epoch 0 are processed and returned to the application. Fixed by dropping received application\_data messages in epoch 0. Thank you to Paul Fiterau of Uppsala University and Robert Merget of Ruhr-University Bochum for the report. | 0 days | 4.5.0 |
| [LINK](https://www.wolfssl.com/wolfssl-version-4-4-0-now-available/) | [CVE-2020-11713](https://nvd.nist.gov/vuln/detail/CVE-2020-11713) | Low | wolfSSL versions prior to 4.4.0 have mulmod code in wc\_ecc\_mulmod\_ex in ecc.c that does not properly resist timing side-channel attacks. Version 4.4.0 fixes this to be constant time and cache resistant. Thank you to Pietro Borrello at Sapienza University of Rome. | Fixed 4 days prior to CVE issuance | 4.4.0 |
| [LINK](https://www.wolfssl.com/wolfssl-version-4-4-0-now-available/) | [CVE-2020-11735](https://nvd.nist.gov/vuln/detail/CVE-2020-11735) | Low | wolfSSL versions prior to 4.4.0 using fast math do not use a constant-time modular inverse when mapping to affine coordinates. Version 4.4.0 uses a constant time modular inverse when mapping to affine when operation involves a private key - keygen, calc shared secret, sign. Thank you to Alejandro Cabrera Aldaya, Cesar Pereida García and Billy Bob Brumley from the Network and Information Security Group (NISEC) at Tampere University for the report. | Fixed 36 days prior to CVE issuance | 4.4.0 |
|  | [CVE-2019-18840](https://nvd.nist.gov/vuln/detail/CVE-2019-18840) | High | In wolfSSL 4.1.0 through 4.2.0c, there are missing sanity checks of memory accesses in parsing ASN.1 certificate data while handshaking. Specifically, there is a one-byte heap-based buffer overflow inside the DecodedCert structure in GetName in wolfcrypt/src/asn.c because the domain name location index is mishandled. Because a pointer is overwritten, there is an invalid free | 0 days | 4.3.0 |
| [LINK](https://www.wolfssl.com/wolfssl-version-4-2-0-now-available/) | N/A | Low | In wolfSSL versions prior to 4.2.0, there is a potential program hang when ocspstapling2 is enabled. This is a moderate level fix that affects users who have ocspstapling2 enabled(off by default) and are on the server side. In parsing a CSR2 (Certificate Status Request v2 ) on the server side, there was the potential for a malformed extension to cause a program hang. Discovered by Robert Hoerr. | 5 days | 4.2.0 |
| [LINK](https://www.wolfssl.com/wolfssl-version-4-2-0-now-available/) | [CVE-2019-16748](https://nvd.nist.gov/vuln/detail/CVE-2019-16748) | High | In wolfSSL through 4.1.0, there is a missing sanity check of memory accesses in parsing ASN.1 certificate data while handshaking. Specifically, there is a one-byte heap-based buffer over-read in CheckCertSignature\_ex in wolfcrypt/src/asn.c. | 1 days | 4.2.0 |
| [LINK](https://www.wolfssl.com/wolfssl-version-4-2-0-now-available/) | [CVE-2019-15651](https://nvd.nist.gov/vuln/detail/CVE-2019-15651) | High | wolfSSL 4.1.0 has a one-byte heap-based buffer over-read in DecodeCertExtensions in wolfcrypt/src/asn.c because reading the ASN\_BOOLEAN byte is mishandled for a crafted DER certificate in GetLength\_ex. | 1 days | 4.2.0 |
| [LINK](https://www.wolfssl.com/wolfssl-version-4-2-0-now-available/) | N/A | Low | wolfSSL versions before 4.2.0 have potential for an invalid read when TLS 1.3 and pre-shared keys is enabled. Users without TLS 1.3 enabled are unaffected. Users with TLS 1.3 enabled and HAVE\_SESSION\_TICKET defined or NO\_PSK not defined should update wolfSSL versions. Discovered by Robert Hoerr. | 0 days | 4.2.0 |
| [LINK](https://www.wolfssl.com/wolfssl-version-4-2-0-now-available/) | CVE-2019-14317 | Low | Versions of wolfSSL before 4.2.0 are vulnerable to DSA operations involving an attack on recovering DSA private keys. This affects users that have DSA enabled and are performing DSA operations (off by default). ECDSA is NOT affected by this and TLS code is NOT affected by this issue. Discovered by Ján Jančár at Masaryk University. | 0 days | 4.2.0 |
| [LINK](https://www.wolfssl.com/vulnerability-disclosure-ecdsa-signing-operations-nonce-size-leaks/) | [CVE-2019-13628](https://nvd.nist.gov/vuln/detail/CVE-2019-13628) | Medium | Versions of wolfSSL before 4.1.0 are vulnerable to the potential leak of nonce sizes when performing ECDSA signing operations. The leak is considered to be difficult to exploit but it could potentially be used maliciously to perform a lattice based timing attack against previous wolfSSL versions. Discovered by Ján Jančár at Masaryk University. | 5 days | 4.1.0 |
| [LINK](https://www.wolfssl.com/vulnerability-disclosure-tlsv1-3-psk-extension-parsing-potential-buffer-overflow/) | [CVE-2019-11873](https://nvd.nist.gov/vuln/detail/CVE-2019-11873) | High | In wolfSSL version 4.0.0, there is a potential buffer overflow case with the TLSv1.3 PSK extension parsing. This affects users that are enabling TLSv1.3 (--enable-tls13). Discovered by Robert Hoerr. | 0 days | 4.1.0 |
| [LINK](https://www.wolfssl.com/wolfssl-3-15-7-now-available/) | [CVE-2018-16870](https://nvd.nist.gov/vuln/detail/CVE-2018-16870) | Medium | Versions of wolfSSL prior to 3.15.7 are vulnerable to a new variant of the Bleichenbacher attack to perform downgrade attacks against TLS, which may lead to leakage of sensible data. | 0 days | 3.15.7 |
| [LINK](https://www.wolfssl.com/wolfssh-and-rohnp/) | [CVE-2018-12436](https://nvd.nist.gov/vuln/detail/CVE-2018-12436) | Medium | Versions of wolfSSL up to and including 3.15.0 are vulnerable to a Key Extraction Side Channel Attack. A patch (wolfssl-3.15.1.patch) is available for download now on our website and a full release will be available next week containing the patch. | 0 days | 3.15.3 |
| [LINK](https://robotattack.org/) | [CVE-2017-13099](https://nvd.nist.gov/vuln/detail/CVE-2017-13099) | Medium | Versions of wolfSSL up to 3.12.2 have a weak Bleichenbacher vulnerability with suites that use an RSA-encrypted premaster secret. Discovered by Hanno Böck, Juraj Somorovsky, Craig Young. | 9 days | 3.13.0 |
| [LINK](https://github.com/wolfSSL/wolfssl/blob/master/ChangeLog.md) | [CVE-2017-2800](https://nvd.nist.gov/vuln/detail/CVE-2017-2800) | Critical | Versions of wolfSSL before 3.11.0 have a possible out-of-bounds write by one from a crafted certificate being passed to the function wolfSSL\_X509\_NAME\_get\_text\_by\_NID. Discovered by Aleksandar Nikolic of Cisco Talos. | Fixed 20 days prior to CVE issuance | 3.11.0 |
| [LINK](https://github.com/wolfSSL/wolfssl/blob/master/ChangeLog.md) | [CVE-2017-8855](https://nvd.nist.gov/vuln/detail/CVE-2017-8855) | High | In versions of wolfSSL before 3.11.0 there are cases where a malformed DH key is not rejected by the function wc\_DhAgree. Thanks to Yueh-Hsun Lin and Peng Li at KNOX Security at Samsung Research America. | Fixed 5 days prior to CVE issuance | 3.11.0 |
| [LINK](https://github.com/wolfSSL/wolfssl/blob/master/ChangeLog.md) | [CVE-2017-8854](https://nvd.nist.gov/vuln/detail/CVE-2017-8854) | High | Versions of wolfSSL before 3.10.2 have a possible out-of-bounds memory access when loading crafted DH parameters. Thanks to Yueh-Hsun Lin and Peng Li at KNOX Security at Samsung Research America. | Fixed 88 days prior to CVE issuance | 3.10.2 |
| [LINK](https://www.wolfssl.com/wolfSSL/Blog/Entries/2016/9/26_wolfSSL_3.9.10_Vulnerability_Fixes.html) | [CVE-2017-6076](https://nvd.nist.gov/vuln/detail/CVE-2017-6076) | Medium | In versions of wolfSSL before 3.10.2 the software implementation makes it easier to extract RSA key information for a malicious user who has access to view the cache on a machine. | Fixed 13 days prior to CVE issuance | 3.10.2 |
| [LINK](https://www.wolfssl.com/wolfSSL/Blog/Entries/2016/9/26_wolfSSL_3.9.10_Vulnerability_Fixes.html) | [CVE-2016-7440](https://nvd.nist.gov/vuln/detail/CVE-2016-7440) | Medium | Software AES table lookups do not properly consider cache-bank access times | Fixed 81 days prior to CVE issuance | 3.9.10 |
| [LINK](https://www.wolfssl.com/wolfSSL/Blog/Entries/2016/9/26_wolfSSL_3.9.10_Vulnerability_Fixes.html) | [CVE-2016-7439](https://nvd.nist.gov/vuln/detail/CVE-2016-7439) | Medium | Software RSA does not properly consider cache-bank monitoring | Fixed 81 days prior to CVE issuance | 3.9.10 |
| [LINK](https://www.wolfssl.com/wolfSSL/Blog/Entries/2015/9/17_Two_Vulnerabilities_Recently_Found%2C_An_Attack_on_RSA_using_CRT_and_DoS_Vulnerability_With_DTLS.html) | [CVE-2016-7438](https://nvd.nist.gov/vuln/detail/CVE-2016-7438) | Medium | Software ECC does not properly consider cache-bank monitoring | Fixed 81 days prior to CVE issuance | 3.9.10 |
| [LINK](https://www.wolfssl.com/wolfSSL/Blog/Entries/2015/9/17_Two_Vulnerabilities_Recently_Found%2C_An_Attack_on_RSA_using_CRT_and_DoS_Vulnerability_With_DTLS.html) | [CVE-2015-6925](https://nvd.nist.gov/vuln/detail/CVE-2015-6925) | High | Potential DOS attack when using DTLS on the server side | Fixed 127 days prior to CVE issuance | 3.6.8 |
| [LINK](https://www.wolfssl.com/wolfSSL/Blog/Entries/2015/9/17_Two_Vulnerabilities_Recently_Found%2C_An_Attack_on_RSA_using_CRT_and_DoS_Vulnerability_With_DTLS.html) | [CVE-2015-7744](https://nvd.nist.gov/vuln/detail/CVE-2015-6925) | Medium | TLS servers using RSA with ephemeral keys may leak key bits on signature faults | Fixed 127 days prior to CVE issuance | 3.6.8 |
| [LINK](https://www.wolfssl.com/wolfSSL/Blog/Entries/2014/4/11_wolfSSL_Security_Advisory__April_9%2C_2014.html) | [CVE-2014-2903](https://nvd.nist.gov/vuln/detail/CVE-2014-2903) | Medium | Server certificate not authorized for use in SSL/TLS handshake. CyaSSL does not check the key usage extension in leaf certificates. | Fixed 13 days prior to issuance | 2.9.4 |
| [LINK](https://www.wolfssl.com/wolfSSL/Blog/Entries/2014/4/11_wolfSSL_Security_Advisory__April_9%2C_2014.html) | [CVE-2014-2900](https://nvd.nist.gov/vuln/detail/CVE-2014-2900) | Medium | Unknown critical certificate extension allowed | Fixed 13 days prior to issuance | 2.9.4 |
| [LINK](https://www.wolfssl.com/wolfSSL/Blog/Entries/2014/4/11_wolfSSL_Security_Advisory__April_9%2C_2014.html) | [CVE-2014-2899](https://nvd.nist.gov/vuln/detail/CVE-2014-2899) | Medium | NULL pointer dereference on peer cert request after certificate parsing failure | Fixed 13 days prior to issuance | 2.9.4 |
| [LINK](https://www.wolfssl.com/wolfSSL/Blog/Entries/2014/4/11_wolfSSL_Security_Advisory__April_9%2C_2014.html) | [CVE-2014-2898](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-2898) | Low | Out of bounds read on repeated calls to CyaSSL\_read(), memory access error. | Fixed 13 days prior to issuance | 2.9.4 |
| [LINK](https://www.wolfssl.com/wolfSSL/Blog/Entries/2014/4/11_wolfSSL_Security_Advisory__April_9%2C_2014.html) | [CVE-2014-2897](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-2897) | High | Out of bounds read, SSL 3.0 HMAC doesn't check padding length for verify failure | Fixed 13 days prior to issuance | 2.9.4 |
| [LINK](https://www.wolfssl.com/wolfSSL/Blog/Entries/2014/4/11_wolfSSL_Security_Advisory__April_9%2C_2014.html) | [CVE-2014-2896](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-2896) | N/A | Memory corruption, possible out of bounds read on length check in DoAlert() | Fixed 13 days prior to issuance | 2.9.4 |

### Known SSL/TLS Protocol Attacks

As researchers and security professionals release new attacks against SSL/TLS protocol versions, algorithms, or cryptographic modes, we want to keep our users informed if wolfSSL is vulnerable or safe to such attacks.

| DATE | NAME | SEVERITY | WOLFSSL AFFECTED | ADDRESSED |
| --- | --- | --- | --- | --- |
| 09.09.2020 | [Raccoon Attack](https://raccoon-attack.com/) | Low | [NO](https://www.wolfssl.com/wolfssl-raccoon-attack/) | N/A |
| 12.08.2017 | [The ROBOT Attack](https://robotattack.org/) | Medium | [YES](https://nvd.nist.gov/vuln/detail/CVE-2017-13099) | [YES](https://github.com/wolfSSL/wolfssl/pull/1229) |
| 08.24.2016 | [SWEET32 Attack](https://sweet32.info/) | TLS & SSH - High OpenVPN - Medium | [YES](https://www.wolfssl.com/wolfSSL/Blog/Entries/2016/9/28_SWEET32_-_3DES_disabled_by_default_in_wolfSSL_3.9.10.html) | YES |
| 03.01.2016 | [DROWN Attack](https://drownattack.com/) | Medium | [NO](https://www.wolfssl.com/wolfSSL/Blog/Entries/2016/3/1_wolfSSL_and_CyaSSL_are_Not_Vulnerable_to_DROWN_Attack.html) | N/A |
| 01.07.2016 | [SLOTH Attack](http://www.mitls.org/pages/attacks/SLOTH) | Medium | [NO](https://www.wolfssl.com/wolfSSL/Blog/Entries/2016/1/9_wolfSSL_Safe_from_SLOTH_Attack.html) | N/A |
| 08.11.2015 | [Pandora's Box Attack](https://www.usenix.org/system/files/conference/woot15/woot15-paper-hlauschek.pdf) | N/A | [NO](https://www.wolfssl.com/wolfSSL/Blog/Entries/2015/8/11_wolfSSL_Not_Vulnerable_to_Pandoras_Box_Attack.html) | N/A |
| 07.09.2015 | [Logjam Attack](https://weakdh.org/) | Critical | [NO](https://www.wolfssl.com/wolfSSL/Blog/Entries/2015/5/20_wolfSSL_and_CyaSSL_are_Not_Vulnerable_to_the_Recent_Logjam_Attack.html) | N/A |
| 03.30.2015 | [Bar Mitzvah Attack](https://www.blackhat.com/docs/asia-15/materials/asia-15-Mantin-Bar-Mitzvah-Attack-Breaking-SSL-With-13-Year-Old-RC4-Weakness-wp.pdf) | Medium | [YES](https://www.wolfssl.com/wolfSSL/Blog/Entries/2015/3/30_What_does_the_Bar_Mitzvah_Attack_mean_for_wolfSSL_users.html) | YES |
| 03.04.2015 | [FREAK Attack](https://www.smacktls.com/#freak) | Medium for all implementations | [YES](https://www.wolfssl.com/wolfSSL/Blog/Entries/2015/3/4_wolfSSL_and_CyaSSL_are_not_vulnerable_to_the_recent_FREAK_attack.html) | N/A |
| 12.12.2014 | [POODLE Bites Again](https://www.imperialviolet.org/2014/12/08/poodleagain.html) | Medium | [NO](https://www.wolfssl.com/wolfSSL/Blog/Entries/2014/12/12_wolfSSL_and_CyaSSL_Users_SAFE_from_POODLE_bites_again_attacks.html) | N/A |
| 10.14.2014 | [POODLE:](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566) Padding Oracle On Downgraded Legacy Encryption | Medium | [YES](https://www.wolfssl.com/wolfSSL/Blog/Entries/2014/10/19_POODLE_%28An_SSL_3.0_Vulnerability%29.html) | YES |
| 04.09.2014 | [Heartbleed Bug](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0160) | Medium | [NO](https://www.wolfssl.com/wolfSSL/Blog/Entries/2014/4/9_wolfSSL_and_CyaSSL_Users_SAFE_from_Heartbleed_Bug.html) | N/A |
| 02.05.2014 | [Lucky 13 Attack](http://www.isg.rhul.ac.uk/tls/Lucky13.html) | Low | [YES](https://www.wolfssl.com/wolfSSL/Blog/Entries/2013/2/5_WolfSSL%2C_provider_of_CyaSSL_Embedded_SSL%2C_releases_first_embedded_TLS_and_DTLS_protocol_fix_for_Lucky_Thirteen_Attack.html) | YES |
| 09.24.2012 | [CRIME Attack](https://en.wikipedia.org/wiki/CRIME) | Low | [YES](https://www.wolfssl.com/wolfSSL/Blog/Entries/2012/9/24_The_CRIME_attack_and_CyaSSL_embedded_SSL.html) | YES |
| 05.13.2011 | [BEAST Attack](https://bug665814.bmoattachments.org/attachment.cgi?id=540839) | Medium | [YES](https://www.wolfssl.com/wolfSSL/Blog/Entries/2012/9/20_Avoid_BEAST_attack_when_using_CyaSSL_lightweight_SSL_implementation.html) | YES |

### Known wolfSSH Vulnerabilities

The SSH protocol is well documented and under constant scrutiny by the top experts in security and cryptography. SSH was quickly adopted as a standard world wide. SSH secures connections between billions of users to their shell accounts, and allows for secure file transfers between billions of computers, servers, Internet of Things (IoT) devices, and embedded systems. The security provided by an SSH Library depends on the underlying strength of its cryptography which is used to encrypt communications.

| INFO | CVE ID | SEVERITY | DESCRIPTION | TIME TO FIX | FIXED IN VERSION |
| --- | --- | --- | --- | --- | --- |
| [LINK](https://www.wolfssl.com/docs/wolfssh-changelog) | [CVE-2024-2873](https://www.cve.org/cverecord?id=CVE-2024-2873) | High | A properly crafted SSH client can bypass user authentication in the wolfSSH server code. The added fix filters the messages that are allowed during different operational states. | 0 days | 1.4.17 |
| [LINK](https://www.wolfssl.com/docs/wolfssh-changelog) | N/A | High | wolfSSHd would allow users without passwords to log in with any password. This is fixed as of this version. The return value of crypt() was not correctly checked. This issue was introduced in v1.4.11 and only affects wolfSSHd when using the default authentication callback provided with wolfSSHd. Anyone using wolfSSHd should upgrade to v1.4.13. | 18 days | 1.4.13 |
| [LINK](https://www.wolfssl.com/docs/wolfssh-changelog) | N/A | Low | When processing SFTP messages, wolfSSH isn't checking data lengths against the size of the message and is potentially under-allocating, over-reading, and over-writing buffers. | 4 days | 1.4.8 |
| [LINK](https://eprint.iacr.org/2023/1711) | N/A | Low | When signing with RSA, wolfSSH wasn't checking if the signature succeeds. We added verify step to generating an RSA signature. There is a potential chance to analyze a bad signature to get the private key from it. | 2 days | 1.4.15 |

### Contact Us

Email: facts@wolfssl.com
 Phone: +1 (425) 245-8247

[# wolfSSL FAQ](https://www.wolfssl.com/frequently-asked-questions-faq/)

[# wolfSSL curl](https://www.wolfssl.com/products/curl/)

[![](/wordpress/wp-content/uploads/2018/08/TLS13-now-avail.png)](https://www.wolfssl.com/docs/tls13/)
[# Upcoming Events](https://www.wolfssl.com/events/)

[# wolfSSL Partners](https://www.wolfssl.com/community/partner-network/)

[## wolfSSL SSL/TLS Library

The wolfSSL lightweight TLS library supports TLS 1.3 and DTLS 1.3 on both client and server sides, features progressive algorithm support, is optimized for footprint and runtime memory use, and more!](/products/wolfssl/)
[## wolfCrypt Crypto Engine

The wolfCrypt Crypto engine is a lightweight, embeddable, and easy-to-configure crypto library with a strong focus on portability, modularity, security, and feature set. FIPS 140-3 and MISRA available.](/products/wolfcrypt/)

[## Case Studies

Through use in games, databases, sensors, VoIP application, and more there is over 1 Billion copies of wolfSSL products in production environments today. Click to view all wolfSSL case studies.](/docs/case-studies/)

[## wolfCrypt FIPS Module

The Cryptographic Module Validation Program (CMVP) has issued FIPS 140-3 Certificate #4718 for the wolfCrypt Module developed by wolfSSL Inc, the world's first SP800-140Br1 validated certificate. Click to read more.](/license/fips/)

Product Information

[* wolfSSL TLS Library](/products/wolfssl/)
[* wolfCrypt Crypto Engine](/products/wolfcrypt/)
[* wolfCrypt FIPS](/license/fips/)
[* wolfTPM Portable TPM 2.0 Library](/products/wolftpm/)
[* wolfMQTT Client Library](/products/wolfmqtt/)
[* wolfSSH SSH Library](/products/wolfssh/)
[* wolfBoot Secure Bootloader](/products/wolfboot/)
[* cURL](/products/curl/)
[* wolfSSL JNI](/products/wolfssl-jni/)
[* wolfCrypt JNI and JCE Provider](/products/wolfcrypt-jni-jce/)
[* License Information](/license/)

Documentation

[* wolfSSL Manual](/documentation/manuals/wolfssl/)
[* wolfSSL API Reference](/docs/wolfssl-manual/ch17/)
[* Doxygen API Reference](/doxygen/index.html)
[* Building wolfSSL](/docs/wolfssl-manual/ch2/)
[* SSL Tutorial](/docs/wolfssl-manual/ch11/)
[* Case Studies](/docs/case-studies/)
[* Additional Documentation](/docs/)

Copyright © 2025 wolfSSL Inc.
All rights reserved.

[![X](/wordpress/wp-content/uploads/2023/08/x.png)](https://twitter.com/wolfssl)
[![Facebook](https://www.wolfssl.com/wordpress/wp-content/uploads/2018/06/facebook-icon.png)](https://www.facebook.com/wolfssl)
[![Github](/wordpress/wp-content/uploads/2018/06/github-icon.png)](https://www.github.com/wolfssl)
[![Linkedin](/wordpress/wp-content/uploads/2020/12/linkedin_50_50.png)](https://www.linkedin.com/company/wolfssl/)
[![Flickr](/wordpress/wp-content/uploads/2018/06/flickr-icon.png)](https://www.flickr.com/photos/54654493%40N05/)

![Made in the USA](/wordpress/wp-content/uploads/2020/12/madeInUsa_100px.png)

Help and Support

[* FAQ Page](https://www.wolfssl.com/frequently-asked-questions-faq/)
[* Support Forum](https://www.wolfssl.com/products/support-and-maintenance/)
[* Support Blog](/support-blog/)
[* Support and Maintenance](/products/support-and-maintenance/)
[* Consulting Services](/docs/consulting/)
[* Vulnerability Info](/docs/security-vulnerabilities/)
[* Contact Us](/contact/)
[* Partners](/community/partner-network/)

Reference

[* Algorithm/Protocol Reference](/docs/wolfssl-manual/appendix-b/)
[* Presentations](/docs/media/)
[* Upcoming Events](/events/)
[* Site Directory](/directory/)


