```
{
  "vulnerability": {
    "cve_id": "CVE-2022-39173",
    "description": "In wolfSSL before 5.5.1 malicious clients can cause a buffer-overflow during a resumed TLS 1.3 handshake. If an attacker resumes a previous TLS session by sending a maliciously crafted Client Hello, followed by another maliciously crafted Client Hello, a buffer overflow occurs in the `RefineSuites` function.",
    "affected_versions": [
      "before 5.5.1"
    ],
    "root_cause": "The vulnerability is due to insufficient bounds checking when refining cipher suites during a resumed TLS 1.3 handshake. The `RefineSuites` function does not properly handle duplicate cipher suites in the client's ClientHello message, leading to a buffer overflow on the stack.",
     "weaknesses": [
        "CWE-120"
      ],
    "impact": "A successful exploit can lead to a denial-of-service (DoS) due to the buffer overflow. It's also suspected to cause remote code execution, depending on the memory layout of the binary.",
    "attack_vector": "The attack vector involves a malicious TLS client sending crafted ClientHello messages to a vulnerable TLS 1.3 server. The client initiates a session, then sends a ClientHello to trigger a Hello Retry Request, followed by another ClientHello to trigger the overflow. The crafted messages include duplicate cipher suites, which cause the `RefineSuites` function to write beyond the allocated buffer.",
    "attacker_capabilities": "The attacker needs to be able to establish a TLS connection with a vulnerable server and manipulate the TLS handshake messages. The attacker also needs to be able to craft a client hello with repeated cipher suites."
  }
}
```