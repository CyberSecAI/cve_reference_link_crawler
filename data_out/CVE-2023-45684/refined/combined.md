=== Content from cfengine.com_87575c1a_20250111_015435.html ===


* [GitHub](https://github.com/cfengine)
* [Blog](/blog/)
* [Docs](https://docs.cfengine.com)
* [Developers](/developers/)
* [Customer support](https://support.northern.tech/hc/en-us)

[![CFEngine](/images/cfengine-logo.svg)](/)

* Product
  ![](/images/arrow-down.svg)
  + [Overview](/product-overview/)
  + [Features](/features/)
  + [Community vs Enterprise](/community-vs-enterprise-comparison/)
* Solutions
  ![](/images/arrow-down.svg)
  + [Infrastructure automation](/solutions/infrastructure-automation/)
  + [Security automation](/solutions/security-automation/)
  + [Compliance automation](/solutions/compliance-automation/)
* Resources
  ![](/images/arrow-down.svg)
  + [Case studies](/case-studies/)
  + [White papers](/white-papers/)
  + [Videos](/videos/)
  + [Webinars](/webinars/)
  + [Developers](/developers/)
  + Downloads
    ![](/images/arrow-down.svg)
    - [Quick install](/downloads/quick-install/)
    - [Enterprise](/downloads/cfengine-enterprise/)
    - [Community](/downloads/cfengine-community/)
    - [Nightly packages](/downloads/cfengine-community-nightly/)
  ![CFEngine Build logo](/developers/cfengine_build_logo.svg)
* [Support & services](/support-services/)
* [Contact us](/contact/)

[Try for free](/download/)

![](/images/closed-menu.svg)

[<The CFEngine Blog](/blog/)
# CVE-2023-45684 - Mission Portal SQL injection vulnerability

* [cve](/tags/cve/)
* [security](/tags/security/)

![](https://www.gravatar.com/avatar/fb1f7bb1d847583db37fa9d3fb57debd?s=100&d=identicon)

Posted by [Lars Erik Wik](/author/lars-erik-wik/)
November 13, 2023

![](/images/line-gradient.svg)

Share this

[![Twitter](/images/twitter-share-icon.svg)](//twitter.com/share?url=https://cfengine.com%2fblog%2f2023%2fcve-2023-45684%2f&text=CVE-2023-45684%20-%20Mission%20Portal%20SQL%20injection%20vulnerability&via=CFEngine)

[![LinkedIn](/images/linkedin-share-icon.svg)](//www.linkedin.com/shareArticle?url=https://cfengine.com%2fblog%2f2023%2fcve-2023-45684%2f&title=CVE-2023-45684%20-%20Mission%20Portal%20SQL%20injection%20vulnerability)

[![Facebook](/images/facebook-share-icon.svg)](//www.facebook.com/sharer/sharer.php?u=https://cfengine.com%2fblog%2f2023%2fcve-2023-45684%2f)

We want to bring to your attention a critical security matter recently
identified in CFEngine Enterprise version 3.6.0 and subsequent releases. This
vulnerability pertains to a [A03:2021 -
Injection](https://owasp.org/Top10/A03_2021-Injection/) flaw within the CFEngine
Enterprise web UI, Mission Portal, which can lead to unauthorized access to the
underlying database. The CVE identifier `CVE-2023-45684` has been assigned to
this issue. At present, there is no evidence to suggest that this vulnerability
has been exploited or that it was known beyond the CFEngine development team and
the customer who brought it to our attention.

## Explanation

Our vigilant CFEngine customers, Chad DeGuira and Jim Trater at the Oak Ridge
National Laboratory, recently uncovered a vulnerability while scanning their
attack surface. During their scan, they identified an unusual delay in the
response time from the CFEngine Mission Portal login page. This delay raised
concerns that an attacker might have the potential to manipulate the
application’s behavior and gain direct access to the underlying database.

## Impact

In response to this discovery, we conducted an internal penetration test to
assess the severity of the vulnerability. Our testing confirmed that the Mission
Portal login page was indeed susceptible to SQL injection, specifically of the
time-based variety. This means that you cannot send queries to dump the database
tables directly (with the common `SELECT <column> FROM <table>` statement). This
is due to the fact that the queried results are not relayed in the servers
response to the API request.

However, since the input is not properly sanitized, you can still craft special
queries, testing for logical conditions `AND`‘ed with a call to the `PG_SLEEP ( interval )`, a function designed to delay the execution. By observing the time
it takes for the server to respond, we can determine whether the first condition
was true. This way we can slowly deduct the contents of the database, usually
done one character at the time, making it a really slow process.

By utilizing this vulnerability we were able to dump the contents of the entire
underlying database, including tables storing confidential information such as
access tokens and salted password hashes. Thus, we consider this vulnerability a
significant concern that warrants immediate attention and remediation. An
overall severity score of 7.5 (high severity) has been calculated using the
following severity vector (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N).

## Remediation

To mitigate this risk, we strongly recommend installing one of the latest
versions of the CFEngine hub packages as listed on our [download
pages](https://cfengine.com/downloads/cfengine-enterprise/). The recently
released CFEngine Enterprise versions 3.18.6 and 3.21.3 include the necessary
fixes to address this vulnerability. It’s important to note that this issue
exclusively affects the CFEngine hub. Thus, by installing the updated hub
package, you can effectively remediate the issue. For more information on how to
upgrade an existing CFEngine installation, please see [our
documentation](https://docs.cfengine.com/docs/3.21/getting-started-installation-upgrading.html).

We appreciate your continued trust in CFEngine, and we are committed to ensuring
the security and reliability of our software. If you have any questions or
require further assistance, please don’t hesitate to reach out to our [support
team](https://support.northern.tech/).

### Explore posts by tags

* [announcements](/tags/announcements/)
* [ansible](/tags/ansible/)
* [api](/tags/api/)
* [bash](/tags/bash/)
* [c](/tags/c/)
* [case-studies](/tags/case-studies/)
* [cf-remote](/tags/cf-remote/)
* [cf-runagent](/tags/cf-runagent/)
* [cf-secret](/tags/cf-secret/)
* [change-in-behavior](/tags/change-in-behavior/)
* [cmdb](/tags/cmdb/)
* [community](/tags/community/)
* [compliance](/tags/compliance/)
* [containers](/tags/containers/)
* [custom-promise-types](/tags/custom-promise-types/)
* [cve](/tags/cve/)
* [design](/tags/design/)
* [developers](/tags/developers/)
* [docker](/tags/docker/)
* [feature-friday](/tags/feature-friday/)
* [git](/tags/git/)
* [guest-blog-posts](/tags/guest-blog-posts/)
* [holiday](/tags/holiday/)
* [inventory](/tags/inventory/)
* [mission-portal](/tags/mission-portal/)
* [modules](/tags/modules/)
* [monthly-module-monday](/tags/monthly-module-monday/)
* [open-source](/tags/open-source/)
* [performance](/tags/performance/)
* [policy-analyzer](/tags/policy-analyzer/)
* [policy-language](/tags/policy-language/)
* [python](/tags/python/)
* [releases](/tags/releases/)
* [reporting](/tags/reporting/)
* [scalability](/tags/scalability/)
* [security](/tags/security/)
* [services](/tags/services/)
* [tooling](/tags/tooling/)
* [troubleshooting](/tags/troubleshooting/)
* [webinars](/tags/webinars/)
* [white-papers](/tags/white-papers/)
* [windows](/tags/windows/)

### Recent posts

* [CFEngine 3.25 released - Auditability](/blog/2025/cfengine-3-25-released-auditability/)
  January 6, 2025
* [See what services are running on your hosts](/blog/2024/inventory-running-services/)
  January 6, 2025
* [Feature Friday #42: ob-cfengine3](/blog/2024/feature-friday-42-ob-cfengine3/)
  December 27, 2024

## Try CFEngine Enterprise for free

Sign up for CFEngine Enterprise and connect up to 25
hosts for free. No credit card required. Get started in
minutes.

[Try enterprise for free](/download/)
![](/images/features/sla-background.svg)

![](/images/comments.svg)
Get in touch with us
 to discuss how we can help!

[Contact us](/contact/)

![](/images/mail.svg)
Sign up for
 our newsletter

Sign up

By signing up, you agree to your email address being stored and used to receive newsletters about CFEngine.
We use tracking in our newsletter emails to improve our marketing content.

![CFEngine](/images/cfengine-logo-white.svg)

* ![](/images/line-gradient.svg)
  About CFEngine
  + [Overview](/product-overview/)
  + [Features](/features/)
  + [Community vs Enterprise](/community-vs-enterprise-comparison/)
* ![](/images/line-gradient.svg)
  Community
  + [GitHub](https://github.com/cfengine)
  + [Matrix](https://matrix.to/#/#CFEngine:matrix.org)
  + [CFEngine Build](https://build.cfengine.com/)
* ![](/images/line-gradient.svg)
  Resources
  + [Developer resources](/developers/)
  + [Downloads](/downloads/quick-install/)
  + [Blog](/blog/)
* ![](/images/line-gradient.svg)
  Get started
  + [Try for free](/free-download/)
  + [Documentation](https://docs.cfengine.com/docs)
* ![](/images/line-gradient.svg)
  Company
  + [About us](https://northern.tech/about-us/mission-strategy)
  + [Legal](https://northern.tech/legal)
  + [Careers](https://northern.tech/careers/open-positions)
  + [Contact us](/contact/)

![](/images/footer-background-right.svg)

![](/images/footer-background-left.svg)

![Northern.tech logo](/images/northern-tech-logo.svg)
CFEngine is developed and maintained by [Northern.tech](https://northern.tech/).
[Career](https://northern.tech/careers/our-mission)
[Legal](https://northern.tech/legal)

© 2025 [Northern.tech](https://northern.tech) AS


