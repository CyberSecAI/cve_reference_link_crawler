Based on the provided content, here's an analysis of the vulnerability described:

**Root Cause of Vulnerability:**

The vulnerability stems from a lack of proper permission checks in the Canvas LMS API (v1). Specifically, the `canvadoc_session_url` generated by the API grants access to files through DocViewer, regardless of the user's role (student, teacher, TA) or the file's publication status (unpublished, locked).

**Weaknesses/Vulnerabilities Present:**

*   **Insufficient Access Control:** The API fails to enforce proper access controls when generating the `canvadoc_session_url`.  It does not check if a student should have access to a file based on the file's publication status or module locks.
*   **Non-discriminatory Access Token:** The access token generated by Canvas LMS does not distinguish between roles, allowing students to retrieve the `canvadoc_session_url` for any file within a course they are enrolled in.
*   **`canvadoc_session_url` bypasses access controls:** The URL can be accessed by any user (even students) to view a file regardless of its status.

**Impact of Exploitation:**

*   **Unauthorized Access to Files:** Students can gain access to files that are not meant to be visible to them. This includes files within unpublished modules, locked files, and files within locked and unpublished modules.
*   **Information Disclosure:** Sensitive information contained within these files can be exposed to unauthorized users.
*   **Circumvention of Course Content Restrictions:** Students can bypass course restrictions and access materials that are intended to be released at a later time.

**Attack Vectors:**

*   **Direct API Access:** Attackers use the Canvas LMS API to request the file information, specifically targeting the `canvadoc_session_url`.
*   **Brute-Force File ID:** Attackers can brute-force file IDs to discover hidden files.
*   **Accessing `canvadoc_session_url`:** An attacker can use a valid `canvadoc_session_url` to directly access a document via a DocViewer page.

**Required Attacker Capabilities/Position:**

*   **Canvas LMS Account:** The attacker needs a valid student account in the target Canvas LMS course.
*   **API Access:** The attacker needs API access to Canvas LMS.
*   **Basic knowledge of API:** The attacker has to be able to craft API requests to access file information and use `canvadoc_session_url`.

**Additional Notes:**

*   The vulnerability was reported by `gaukas` on GitHub.
*   The exploit is described as being actively exploited and potentially used in the wild.
*   The vulnerability has been patched by Instructure, the company behind Canvas LMS, as of 10/15/2022. However, institutions may not have updated to the patched version, making them vulnerable.
*   The `poc_bruteforce.py` mentioned in the repository is a proof of concept for exploiting the vulnerability by brute-forcing file IDs.
*   The `canvadoc_session_url` redirects to a DocViewer page, allowing the student to view file contents.
*   The file ID is serialized, which means the attack could be optimized with an educated guess based on previous file IDs.
*   The GitHub issue also mentions that the exploit was discovered in a discussion with  `@yl4579`.

This information provides more detail than the generic description of CVE-2021-36539, outlining the specific technical details of the vulnerability and its exploit.