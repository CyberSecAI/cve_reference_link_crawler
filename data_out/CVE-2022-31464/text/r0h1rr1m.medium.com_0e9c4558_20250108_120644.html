[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F44d0eeb6c933&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fr0h1rr1m.medium.com%2Fadaware-protect-local-privilege-escalation-through-insecure-service-permissions-44d0eeb6c933&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fr0h1rr1m.medium.com%2Fadaware-protect-local-privilege-escalation-through-insecure-service-permissions-44d0eeb6c933&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# Adaware Protect Local Privilege Escalation through Insecure Service Permissions (CVE-2022–31464)

[![Furkan Göksel](https://miro.medium.com/v2/resize:fill:88:88/1*V7FgynBucXFGCaaNm2oJ8w.jpeg)](/?source=post_page---byline--44d0eeb6c933--------------------------------)

[Furkan Göksel](/?source=post_page---byline--44d0eeb6c933--------------------------------)

·

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fff0f68c88db0&operation=register&redirect=https%3A%2F%2Fr0h1rr1m.medium.com%2Fadaware-protect-local-privilege-escalation-through-insecure-service-permissions-44d0eeb6c933&user=Furkan+G%C3%B6ksel&userId=ff0f68c88db0&source=post_page-ff0f68c88db0--byline--44d0eeb6c933---------------------post_header-----------)

2 min read·Jun 14, 2022

--

Listen

Share

# Introduction

> Adaware Protect has a service called Adaware Protect Service which runs as the Local System Account. Since **Everyone** has **Full Control** over this service, a low privilege user can escalate his/her privileges to the **SYSTEM** level.
>
> I’m disclosing this vulnerability after waiting them for 60 days.

# Description of the Vulnerability

1. Title: Adaware Protect Local Privilege Escalation through Insecure Service Permissions
2. Product: Adaware Protect
3. Version: 1.2.495.4325 (Latest Version on 14 June 2022)
4. Homepage: [https://www.adaware.com](https://www.adaware.com/)
5. Test Platform: Windows 10 19044

During the installation of Adaware Antivirus, you can also install Adaware Protect as you can see from the screenshot below.

![]()

After the installation, I realized that a new service is created whose name is Adaware Protect Service which executes AdawareProtectService.exe, and the process which is created by this service is running as SYSTEM privileges which is the highest privilege on Windows Systems.

![]()

I checked the permissions for this service and saw that EVERYONE has full control of that service configuration which may lead to escalate privileges from low privileged to SYSTEM level privilege.

![]()

From a low privileged account, you can change the service binary path to any binary that you want. In this way, you can execute this binary as the SYSTEM.

![]()

You can also confirm this change from the Services GUI.

![]()

After changing its startup type to Disable and rebooting the computer (because you cannot stop the service directly), you can see that your selected binary is executed as SYSTEM (in our case it’s notepad.exe).

![]()

By following the same steps, anyone can take any permissions that he/she wants over an executable from a low privilege account.

[Adaware](https://medium.com/tag/adaware?source=post_page-----44d0eeb6c933--------------------------------)[Adaware Protect](https://medium.com/tag/adaware-protect?source=post_page-----44d0eeb6c933--------------------------------)[Vulnerability](https://medium.com/tag/vulnerability?source=post_page-----44d0eeb6c933--------------------------------)[Cve](https://medium.com/tag/cve?source=post_page-----44d0eeb6c933--------------------------------)[Zero Day](https://medium.com/tag/zero-day?source=post_page-----44d0eeb6c933--------------------------------)

--

--

[![Furkan Göksel](https://miro.medium.com/v2/resize:fill:96:96/1*V7FgynBucXFGCaaNm2oJ8w.jpeg)](/?source=post_page---post_author_info--44d0eeb6c933--------------------------------)[![Furkan Göksel](https://miro.medium.com/v2/resize:fill:128:128/1*V7FgynBucXFGCaaNm2oJ8w.jpeg)](/?source=post_page---post_author_info--44d0eeb6c933--------------------------------)Follow[## Written by Furkan Göksel](/?source=post_page---post_author_info--44d0eeb6c933--------------------------------)[6 Followers](/followers?source=post_page---post_author_info--44d0eeb6c933--------------------------------)·[3 Following](/following?source=post_page---post_author_info--44d0eeb6c933--------------------------------)

Requiem for a dream

Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----44d0eeb6c933--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----44d0eeb6c933--------------------------------)[About](https://medium.com/about?autoplay=1&source=post_page-----44d0eeb6c933--------------------------------)[Careers](https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----44d0eeb6c933--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----44d0eeb6c933--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----44d0eeb6c933--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----44d0eeb6c933--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----44d0eeb6c933--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----44d0eeb6c933--------------------------------)[Teams](https://medium.com/business?source=post_page-----44d0eeb6c933--------------------------------)

