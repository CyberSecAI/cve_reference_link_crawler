=== Content from github.com_92fed2e4_20250108_124309.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjavadelight%2Fdelight-nashorn-sandbox%2Fissues%2F117)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjavadelight%2Fdelight-nashorn-sandbox%2Fissues%2F117)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=javadelight%2Fdelight-nashorn-sandbox)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[javadelight](/javadelight)
/
**[delight-nashorn-sandbox](/javadelight/delight-nashorn-sandbox)**
Public

* [Notifications](/login?return_to=%2Fjavadelight%2Fdelight-nashorn-sandbox) You must be signed in to change notification settings
* [Fork
  83](/login?return_to=%2Fjavadelight%2Fdelight-nashorn-sandbox)
* [Star
   270](/login?return_to=%2Fjavadelight%2Fdelight-nashorn-sandbox)

* [Code](/javadelight/delight-nashorn-sandbox)
* [Issues
  54](/javadelight/delight-nashorn-sandbox/issues)
* [Pull requests
  2](/javadelight/delight-nashorn-sandbox/pulls)
* [Actions](/javadelight/delight-nashorn-sandbox/actions)
* [Projects
  0](/javadelight/delight-nashorn-sandbox/projects)
* [Wiki](/javadelight/delight-nashorn-sandbox/wiki)
* [Security](/javadelight/delight-nashorn-sandbox/security)
* [Insights](/javadelight/delight-nashorn-sandbox/pulse)

Additional navigation options

* [Code](/javadelight/delight-nashorn-sandbox)
* [Issues](/javadelight/delight-nashorn-sandbox/issues)
* [Pull requests](/javadelight/delight-nashorn-sandbox/pulls)
* [Actions](/javadelight/delight-nashorn-sandbox/actions)
* [Projects](/javadelight/delight-nashorn-sandbox/projects)
* [Wiki](/javadelight/delight-nashorn-sandbox/wiki)
* [Security](/javadelight/delight-nashorn-sandbox/security)
* [Insights](/javadelight/delight-nashorn-sandbox/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fjavadelight%2Fdelight-nashorn-sandbox%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fjavadelight%2Fdelight-nashorn-sandbox%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# A ReDoS vulnerability can be exploited after version 0.2.0 #117

Closed

[SugarP1g](/SugarP1g) opened this issue
Aug 30, 2021
¬∑ 29 comments
 ¬∑ Fixed by [#139](https://github.com/javadelight/delight-nashorn-sandbox/pull/139)

Closed

# [A ReDoS vulnerability can be exploited after version 0.2.0](#top) #117

[SugarP1g](/SugarP1g) opened this issue
Aug 30, 2021
¬∑ 29 comments
 ¬∑ Fixed by [#139](https://github.com/javadelight/delight-nashorn-sandbox/pull/139)

## Comments

[![@SugarP1g](https://avatars.githubusercontent.com/u/9649416?s=80&u=e6a3aaf8cd73513b4ef22a5c4e167d7e6599877a&v=4)](/SugarP1g)

Copy link

### **[SugarP1g](/SugarP1g)** commented [Aug 30, 2021](#issue-982291630)

| There is a weak expression can be exploited to launch a DOS attack.  [image](https://user-images.githubusercontent.com/9649416/131274228-5f17da61-b9ba-451e-9e42-21cd87ec9360.png)  Execution stack is as follow:  [image](https://user-images.githubusercontent.com/9649416/131274299-e8274d18-5b0d-4f10-a428-616bb1d9dd5d.png)  POC:  [image](https://user-images.githubusercontent.com/9649416/131274320-4ba977bd-8cf7-4353-94e4-6c3ccc862355.png)  Run result:  [image](https://user-images.githubusercontent.com/9649416/131274356-e3fe98d9-6198-48a3-b3ad-5a3360ab72d7.png) |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[mxro](/mxro)
added a commit
that referenced
this issue
[Sep 3, 2021](#ref-commit-9c8c3f3)
[![@mxro](https://avatars.githubusercontent.com/u/1448524?s=40&u=e1efc1ed9f62499a694436d5626f9bc1b4ff5c9c&v=4)](/mxro)

`[Adding security issue](/javadelight/delight-nashorn-sandbox/commit/9c8c3f3afca35e4dd176c959e1c2c5514c9d3131 "Adding security issue #117 to Readme") [#117](https://github.com/javadelight/delight-nashorn-sandbox/issues/117) [to Readme](/javadelight/delight-nashorn-sandbox/commit/9c8c3f3afca35e4dd176c959e1c2c5514c9d3131 "Adding security issue #117 to Readme")`

`[9c8c3f3](/javadelight/delight-nashorn-sandbox/commit/9c8c3f3afca35e4dd176c959e1c2c5514c9d3131)`

[![@mxro](https://avatars.githubusercontent.com/u/1448524?s=80&u=e1efc1ed9f62499a694436d5626f9bc1b4ff5c9c&v=4)](/mxro)

Copy link

Collaborator

### **[mxro](/mxro)** commented [Sep 3, 2021](#issuecomment-912799625)

| Thank you for raising this issue. Have added this to the Readme for the project until it is resolved.  Any ideas for resolving thie welcome.  I assume this can still be caught when setting an executor and max CPU time? |
| --- |

All reactions

Sorry, something went wrong.

[![@SugarP1g](https://avatars.githubusercontent.com/u/9649416?s=80&u=e6a3aaf8cd73513b4ef22a5c4e167d7e6599877a&v=4)](/SugarP1g)

Copy link

Author

### **[SugarP1g](/SugarP1g)** commented [Sep 4, 2021](#issuecomment-912900838) ‚Ä¢ edited Loading

| Thank you for raising this issue. Have added this to the Readme for the project until it is resolved.  Any ideas for resolving thie welcome.  I assume this can still be caught when setting an executor and max CPU time?  Yes.  The cause of the problem is the defect of the regular engine.  This link can be referenced: <https://checkmarx.com/wp-content/uploads/2015/03/ReDoS-Attacks.pdf> |
| --- |

All reactions

Sorry, something went wrong.

[![@junweili](https://avatars.githubusercontent.com/u/12969536?s=80&v=4)](/junweili)

Copy link

### **[junweili](/junweili)** commented [Aug 9, 2022](#issuecomment-1209585668)

| Hi [@mxro](https://github.com/mxro) , is there any plan to fix this in near term? It is listed under <https://nvd.nist.gov/vuln/detail/CVE-2021-40660#match-8086489>  Thank you |
| --- |

All reactions

Sorry, something went wrong.

[![@mxro](https://avatars.githubusercontent.com/u/1448524?s=80&u=e1efc1ed9f62499a694436d5626f9bc1b4ff5c9c&v=4)](/mxro)

Copy link

Collaborator

### **[mxro](/mxro)** commented [Aug 9, 2022](#issuecomment-1209833275)

| Thanks for reaching out!  I guess the way forward here would be to replace the RegEx with more deterministic logic? |
| --- |

All reactions

Sorry, something went wrong.

[![@junweili](https://avatars.githubusercontent.com/u/12969536?s=80&v=4)](/junweili)

Copy link

### **[junweili](/junweili)** commented [Aug 9, 2022](#issuecomment-1209940769)

| Yes, such complex RegEx is vulnerable. Out of curiosity about the reason of injecting interruption call by using POISON\_PILLS, is this for the purpose of terminating script execution to cap cpu time? |
| --- |

All reactions

Sorry, something went wrong.

[![@mxro](https://avatars.githubusercontent.com/u/1448524?s=80&u=e1efc1ed9f62499a694436d5626f9bc1b4ff5c9c&v=4)](/mxro)

Copy link

Collaborator

### **[mxro](/mxro)** commented [Aug 9, 2022](#issuecomment-1209943591)

| Yes, it's injecting a bit of code that triggers the test for how much CPU time is used.  However, there is an additional fallback the sandbox provides, in that it can do a hard shutdown of the thread as well. But using the injected statements should be smoother. |
| --- |

All reactions

Sorry, something went wrong.

[![@asilism](https://avatars.githubusercontent.com/u/77270499?s=80&v=4)](/asilism)

Copy link

### **[asilism](/asilism)** commented [Oct 19, 2022](#issuecomment-1283565551)

| [@mxro](https://github.com/mxro) How about remove all comment lines before run jsSanitizer? I have commented on a similar issue in the past. ( [#108](https://github.com/javadelight/delight-nashorn-sandbox/issues/108) )  I didn't know the exact reason such as ReDoS, but I knew that "POISONPIL + Comments" was the cause. So, I am using the logic to remove all comments in the code before eval(), and there has been no slowdown since then.  I don't know this approach is a real solution to this vulnerability, but I'm leaving a post in case it helps. |
| --- |

All reactions

Sorry, something went wrong.

[![@mxro](https://avatars.githubusercontent.com/u/1448524?s=80&u=e1efc1ed9f62499a694436d5626f9bc1b4ff5c9c&v=4)](/mxro)

Copy link

Collaborator

### **[mxro](/mxro)** commented [Oct 20, 2022](#issuecomment-1286172489)

| [@asilism](https://github.com/asilism) Thank you for the idea!  So that would mean moving  <https://github.com/javadelight/delight-nashorn-sandbox/blob/master/src/main/java/delight/nashornsandbox/internal/JsSanitizer.java#L201>  to     [delight-nashorn-sandbox/src/main/java/delight/nashornsandbox/internal/JsSanitizer.java](https://github.com/javadelight/delight-nashorn-sandbox/blob/23ba3d7013528d1eafcc5123507b3a3f71ab07d5/src/main/java/delight/nashornsandbox/internal/JsSanitizer.java#L279)  Line 279 in [23ba3d7](/javadelight/delight-nashorn-sandbox/commit/23ba3d7013528d1eafcc5123507b3a3f71ab07d5)   |  | final String beautifiedJs = beautifyJs(js); | | --- | --- |      ? |
| --- | --- | --- |

All reactions

Sorry, something went wrong.

[![@asilism](https://avatars.githubusercontent.com/u/77270499?s=80&v=4)](/asilism)

Copy link

### **[asilism](/asilism)** commented [Oct 24, 2022](#issuecomment-1288373868)

| [@mxro](https://github.com/mxro) Yes, before call beautifyJs. but 2 Things must be clear. I think.  1 ) Does RemoveComments function completely remove all of comments line ? 2 ) it is necessary to confirm whether there is a need to change POISON\_PIL regular expression. |
| --- |

All reactions

Sorry, something went wrong.

[![@huzongxin1994](https://avatars.githubusercontent.com/u/40710427?s=80&v=4)](/huzongxin1994)

Copy link

### **[huzongxin1994](/huzongxin1994)** commented [Dec 19, 2022](#issuecomment-1357162421)

| [@mxro](https://github.com/mxro) I found that this issue was not resolved in version 0.2.4.Excuse me, when will the problem be solved? If multiple lines of non-function code are transferred, \n is not added to the end of the line after beautifyJs processing. |
| --- |

All reactions

Sorry, something went wrong.

[![@mxro](https://avatars.githubusercontent.com/u/1448524?s=80&u=e1efc1ed9f62499a694436d5626f9bc1b4ff5c9c&v=4)](/mxro)

Copy link

Collaborator

### **[mxro](/mxro)** commented [Dec 24, 2022](#issuecomment-1364592130)

| 1 ) Does RemoveComments function completely remove all of comments line ?  I think it should!  2 ) it is necessary to confirm whether there is a need to change POISON\_PIL regular expression.  Pretty sure the RegEx would need to be changed. |
| --- |

All reactions

Sorry, something went wrong.

[![@mxro](https://avatars.githubusercontent.com/u/1448524?s=80&u=e1efc1ed9f62499a694436d5626f9bc1b4ff5c9c&v=4)](/mxro)

Copy link

Collaborator

### **[mxro](/mxro)** commented [Dec 24, 2022](#issuecomment-1364592181)

| [@huzongxin1994](https://github.com/huzongxin1994) Yes, this issue is still open.  Looking for good ideas to fix the Regex or avoid the problem altogether! |
| --- |

All reactions

Sorry, something went wrong.

[![@huzongxin1994](https://avatars.githubusercontent.com/u/40710427?s=80&v=4)](/huzongxin1994)

Copy link

### **[huzongxin1994](/huzongxin1994)** commented [Dec 28, 2022](#issuecomment-1366299780)

| Modify the regular expression or split the regular logic, I think it's a better solution.Can you tell me more about what this regularity \n(?![\W]\*(//.+[\W]+)*else) means, and then we're trying to deal with it together?The \n(?![\W]*(//.+[\W]+)\*else) regular expression triggers a backtracking trap. |
| --- |

All reactions

Sorry, something went wrong.

[![@mxro](https://avatars.githubusercontent.com/u/1448524?s=80&u=e1efc1ed9f62499a694436d5626f9bc1b4ff5c9c&v=4)](/mxro)

Copy link

Collaborator

### **[mxro](/mxro)** commented [Dec 30, 2022](#issuecomment-1368072740)

| [@huzongxin1994](https://github.com/huzongxin1994) This link [@SugarP1g](https://github.com/SugarP1g) shared earlier describes the backtracking vulnerability: <https://checkmarx.com/wp-content/uploads/2015/03/ReDoS-Attacks.pdf>  By avoiding it altogether, I was thinking of if there could be a solution that doesn't use a regular expression at all! |
| --- |

All reactions

Sorry, something went wrong.

[![@lgtest1789](https://avatars.githubusercontent.com/u/46701428?s=80&v=4)](/lgtest1789)

Copy link

### **[lgtest1789](/lgtest1789)** commented [Jan 9, 2023](#issuecomment-1375284002)

| [@huzongxin1994](https://github.com/huzongxin1994) This link [@SugarP1g](https://github.com/SugarP1g) shared earlier describes the backtracking vulnerability: <https://checkmarx.com/wp-content/uploads/2015/03/ReDoS-Attacks.pdf>  By avoiding it altogether, I was thinking of if there could be a solution that doesn't use a regular expression at all!  When can this question be updated? Thank you. |
| --- |

All reactions

Sorry, something went wrong.

[![@MrLi2018](https://avatars.githubusercontent.com/u/39287657?s=80&v=4)](/MrLi2018)

Copy link

### **[MrLi2018](/MrLi2018)** commented [May 16, 2023](#issuecomment-1549574596)

| [@mxro](https://github.com/mxro) Hello, sorry to interrupt, I think if this problem can not change the regular expression in the short term, removing the comment may be a good way, I am removing the comment, dos attack no longer exists. |
| --- |

All reactions

Sorry, something went wrong.

[![@MrLi2018](https://avatars.githubusercontent.com/u/39287657?s=80&v=4)](/MrLi2018)

Copy link

### **[MrLi2018](/MrLi2018)** commented [May 16, 2023](#issuecomment-1549576639)

| You can also set timeout limits for regular expressions and ask users to modify the corresponding JS code. |
| --- |

All reactions

Sorry, something went wrong.

[![@MrLi2018](https://avatars.githubusercontent.com/u/39287657?s=80&v=4)](/MrLi2018)

Copy link

### **[MrLi2018](/MrLi2018)** commented [May 16, 2023](#issuecomment-1549578986)

| Like this: static class InterruptibleCharSequence implements CharSequence { CharSequence inner = "";  ```     public InterruptibleCharSequence(CharSequence inner) {         super();         this.inner = inner;     }      @Override     public char charAt(int index) {         if (Thread.currentThread().isInterrupted()) {             throw new ScriptCPUAbuseException("compile timeout Interrupted!",true,null);         }         return inner.charAt(index);     }      @Override     public int length() {         return inner.length();     }      @Override     public CharSequence subSequence(int start, int end) {         return new InterruptibleCharSequence(inner.subSequence(start, end));     }      @Override     public String toString() {         return inner.toString();     } }  ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@mxro](https://avatars.githubusercontent.com/u/1448524?s=80&u=e1efc1ed9f62499a694436d5626f9bc1b4ff5c9c&v=4)](/mxro)

Copy link

Collaborator

### **[mxro](/mxro)** commented [May 20, 2023](#issuecomment-1555595782)

| [@MrLi2018](https://github.com/MrLi2018) Thank you for your suggestion. That looks promising. Could you provide a few more details? Where would we use the new class? |
| --- |

All reactions

Sorry, something went wrong.

[![@MrLi2018](https://avatars.githubusercontent.com/u/39287657?s=80&v=4)](/MrLi2018)

Copy link

### **[MrLi2018](/MrLi2018)** commented [May 20, 2023](#issuecomment-1555894609) ‚Ä¢ edited by mxro Loading

| [@mxro](https://github.com/mxro) Hello, I'm sorry I won't submit open source code on GitHub. I can only communicate in this way.The above class can be used to break the infinite backtracking of regular expressions, and I've written a simple example you can refer to, and I think it can solve this problem.  ```     private static ThreadLocal<Integer> matchCount = ThreadLocal.withInitial(() -> 0);  	String injectInterruptionCalls(final String str) { 		String perform = RemoveComments.perform(str); 		try { 			String current = perform; 			for (final PoisonPil pp : POISON_PILLS) { 				final StringBuffer sb = new StringBuffer(); 				final Matcher matcher = pp.pattern.matcher(new SecuInterruptibleCharSequence(current)); 				while (matcher.find()) { 					matcher.appendReplacement(sb, ("$1" + pp.replacement)); 				} 				matcher.appendTail(sb); 				current = sb.toString(); 			} 			return current; 		} catch (Exception exp) { 			return perform; 		} 	}  	static class SecuInterruptibleCharSequence implements CharSequence { 		CharSequence inner = "";  		public SecuInterruptibleCharSequence(CharSequence inner) { 			super(); 			this.inner = inner; 		}  		@Override 		public char charAt(int index) { 			matchCount.set(matchCount.get()+1); 			if (matchCount.get()>10000){ 				Thread thread = Thread.currentThread(); 				thread.interrupt(); 			} 			if (Thread.currentThread().isInterrupted()) { 				throw new ScriptCPUAbuseException("compile timeout Interrupted!", true, null); 			} 			return inner.charAt(index); 		}  		@Override 		public int length() { 			return inner.length(); 		}  		@Override 		public CharSequence subSequence(int start, int end) { 			return new SecuInterruptibleCharSequence(inner.subSequence(start, end)); 		}  		@Override 		public String toString() { 			return inner.toString(); 		} 	}  ```  Or you can use a separate thread, but I think you can use the sandbox to set the thread pool at build time.As follows:  ```     private static ExecutorService executorService = Executors.newSingleThreadExecutor();  	String injectInterruptionCalls(final String str) { 		AtomicReference<String> current = new AtomicReference<>(RemoveComments.perform(str)); 		Future<String> submit = executorService.submit(() -> { 			for (final PoisonPil pp : POISON_PILLS) { 				final StringBuffer sb = new StringBuffer(); 				final Matcher matcher = pp.pattern.matcher(new SecuInterruptibleCharSequence(current)); 				while (matcher.find()) { 					matcher.appendReplacement(sb, ("$1" + pp.replacement)); 				} 				matcher.appendTail(sb); 				current.set(sb.toString()); 			} 			return current.get(); 		}); 		String result = null; 		try { 			result = submit.get(10, TimeUnit.MILLISECONDS); 		} catch (Exception exp) { 			submit.cancel(true); 			result = current.get(); 		} 		return result; 	}  	static class SecuInterruptibleCharSequence implements CharSequence { 		CharSequence inner = "";  		public SecuInterruptibleCharSequence(CharSequence inner) { 			super(); 			this.inner = inner; 		}  		@Override 		public char charAt(int index) { 		 			if (Thread.currentThread().isInterrupted()) { 				throw new ScriptCPUAbuseException("compile timeout Interrupted!", true, null); 			} 			return inner.charAt(index); 		}  		@Override 		public int length() { 			return inner.length(); 		}  		@Override 		public CharSequence subSequence(int start, int end) { 			return new SecuInterruptibleCharSequence(inner.subSequence(start, end)); 		}  		@Override 		public String toString() { 			return inner.toString(); 		} 	}  ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@mxro](https://avatars.githubusercontent.com/u/1448524?s=40&u=e1efc1ed9f62499a694436d5626f9bc1b4ff5c9c&v=4)](/mxro)
[mxro](/mxro)
mentioned this issue
[May 21, 2023](#ref-pullrequest-1718349146)

[Protect against RegEx attacks in santising script input
#139](/javadelight/delight-nashorn-sandbox/pull/139)
 Merged

[![@mxro](https://avatars.githubusercontent.com/u/1448524?s=80&u=e1efc1ed9f62499a694436d5626f9bc1b4ff5c9c&v=4)](/mxro)

Copy link

Collaborator

### **[mxro](/mxro)** commented [May 21, 2023](#issuecomment-1556067830)

| Thank you [@MrLi2018](https://github.com/MrLi2018) for the further clarifications!  I've included this in PR [#139](https://github.com/javadelight/delight-nashorn-sandbox/pull/139). I would be very grateful for one or more reviews confirming this addresses the identified security issues. Thanks for [@SugarP1g](https://github.com/SugarP1g) for initially identifying this - I've tried to model the [unit test](https://github.com/javadelight/delight-nashorn-sandbox/pull/139/files#diff-c20d8172389408961754c6acd450a56d16b629accfbbe24f65008c9a5b065b96) as closely as possible to what you have submitted. |
| --- |

All reactions

Sorry, something went wrong.

[![@MrLi2018](https://avatars.githubusercontent.com/u/39287657?s=80&v=4)](/MrLi2018)

Copy link

### **[MrLi2018](/MrLi2018)** commented [May 22, 2023](#issuecomment-1556431357)

| Thank you for your contribution to the sandbox, but another way is to use Hyperscan to parse regulars, because it's not a backtracking mechanism, but it seems that you need to modify the regulars, and if you want to remove the regulars, it seems that unless we can get involved in the JS loop itself. [@mxro](https://github.com/mxro) |
| --- |

All reactions

Sorry, something went wrong.

[![@mxro](https://avatars.githubusercontent.com/u/1448524?s=40&u=e1efc1ed9f62499a694436d5626f9bc1b4ff5c9c&v=4)](/mxro)
[mxro](/mxro)
closed this as [completed](/javadelight/delight-nashorn-sandbox/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
in
[#139](/javadelight/delight-nashorn-sandbox/pull/139)
[May 26, 2023](#event-9354608075)

[![@mxro](https://avatars.githubusercontent.com/u/1448524?s=80&u=e1efc1ed9f62499a694436d5626f9bc1b4ff5c9c&v=4)](/mxro)

Copy link

Collaborator

### **[mxro](/mxro)** commented [May 26, 2023](#issuecomment-1564983722)

| Fix released to Maven central with version `0.3.1`. |
| --- |

All reactions

Sorry, something went wrong.

[![@gregorywaynepower](https://avatars.githubusercontent.com/u/31050507?s=80&u=a0fa43b2cf7316e58f6a36df52e42e129124de4b&v=4)](/gregorywaynepower)

Copy link

### **[gregorywaynepower](/gregorywaynepower)** commented [Jan 2, 2024](#issuecomment-1874426291)

| Fix released to Maven central with version `0.3.1`.  [@mxro](https://github.com/mxro) Does this mean that there *is* a fix to [CVE-2021-40660](https://osv.dev/vulnerability/CVE-2021-40660)? |
| --- |

All reactions

Sorry, something went wrong.

[![@mxro](https://avatars.githubusercontent.com/u/1448524?s=80&u=e1efc1ed9f62499a694436d5626f9bc1b4ff5c9c&v=4)](/mxro)

Copy link

Collaborator

### **[mxro](/mxro)** commented [Jan 2, 2024](#issuecomment-1874460768)

| [@gregorywaynepower](https://github.com/gregorywaynepower) Yes, absolutely!  Not sure how I can get the CVE closed though?! |
| --- |

All reactions

Sorry, something went wrong.

[![@gregorywaynepower](https://avatars.githubusercontent.com/u/31050507?s=80&u=a0fa43b2cf7316e58f6a36df52e42e129124de4b&v=4)](/gregorywaynepower)

Copy link

### **[gregorywaynepower](/gregorywaynepower)** commented [Jan 2, 2024](#issuecomment-1874573835) ‚Ä¢ edited Loading

| [@gregorywaynepower](https://github.com/gregorywaynepower) Yes, absolutely!  Not sure how I can get the CVE closed though?!  I can do some digging on how to update an existing [GitHub Security Advisory Contribution](https://github.com/github/advisory-database#contributions).  Edit: Looks like you can make a pull request to [this file](https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/06/GHSA-38j3-6fm8-pfgc/GHSA-38j3-6fm8-pfgc.json) and add a `fixed` tag using [the Open Source Vulnerability format](https://ossf.github.io/osv-schema/#format-overview). |
| --- |

All reactions

Sorry, something went wrong.

[mxro](/mxro)
added a commit
to mxro/advisory-database
that referenced
this issue
[Jan 3, 2024](#ref-commit-4894169)
[![@mxro](https://avatars.githubusercontent.com/u/1448524?s=40&u=e1efc1ed9f62499a694436d5626f9bc1b4ff5c9c&v=4)](/mxro)

`[Providing patched version](/mxro/advisory-database/commit/489416982d2104e553483a93143c0a409b01a0c4 "Providing patched version

Fixed with 0.3.1 https://github.com/javadelight/delight-nashorn-sandbox/issues/117#issuecomment-1564983722")`
‚Ä¶

`[4894169](/mxro/advisory-database/commit/489416982d2104e553483a93143c0a409b01a0c4)`

```
Fixed with 0.3.1 [javadelight/delight-nashorn-sandbox#117 (comment)](https://github.com/javadelight/delight-nashorn-sandbox/issues/117#issuecomment-1564983722)
```

[![@mxro](https://avatars.githubusercontent.com/u/1448524?s=40&u=e1efc1ed9f62499a694436d5626f9bc1b4ff5c9c&v=4)](/mxro)
[mxro](/mxro)
mentioned this issue
[Jan 3, 2024](#ref-pullrequest-2063370587)

[[GHSA-38j3-6fm8-pfgc.json] Providing patched version tag
github/advisory-database#3256](/github/advisory-database/pull/3256)
 Merged

[![@mxro](https://avatars.githubusercontent.com/u/1448524?s=80&u=e1efc1ed9f62499a694436d5626f9bc1b4ff5c9c&v=4)](/mxro)

Copy link

Collaborator

### **[mxro](/mxro)** commented [Jan 3, 2024](#issuecomment-1874937658)

| Thanks heaps for the information ‚ù§ - submitted a PR üëÜ |
| --- |

All reactions

Sorry, something went wrong.

[![@mxro](https://avatars.githubusercontent.com/u/1448524?s=80&u=e1efc1ed9f62499a694436d5626f9bc1b4ff5c9c&v=4)](/mxro)

Copy link

Collaborator

### **[mxro](/mxro)** commented [Jan 9, 2024](#issuecomment-1883759358)

| Please note this has been merged in the advisory database - thanks for your help [@gregorywaynepower](https://github.com/gregorywaynepower) [github/advisory-database#3256](https://github.com/github/advisory-database/pull/3256) |
| --- |

 üéâ
1
 gregorywaynepower reacted with hooray emoji

All reactions

* üéâ
  1 reaction

Sorry, something went wrong.

[![@gregorywaynepower](https://avatars.githubusercontent.com/u/31050507?s=80&u=a0fa43b2cf7316e58f6a36df52e42e129124de4b&v=4)](/gregorywaynepower)

Copy link

### **[gregorywaynepower](/gregorywaynepower)** commented [Jan 9, 2024](#issuecomment-1883762248)

| Fantastic news [@mxro](https://github.com/mxro) ! Thanks for taking this on. |
| --- |

 ‚ù§Ô∏è
1
 mxro reacted with heart emoji

All reactions

* ‚ù§Ô∏è
  1 reaction

Sorry, something went wrong.

[mxro](/mxro)
added a commit
that referenced
this issue
[Jul 27, 2024](#ref-commit-46928cd)
[![@mxro](https://avatars.githubusercontent.com/u/1448524?s=40&u=e1efc1ed9f62499a694436d5626f9bc1b4ff5c9c&v=4)](/mxro)

`[Ensuring test for](/javadelight/delight-nashorn-sandbox/commit/46928cd8c4b07fbc9e5f7f27b2b58308aeaa821e "Ensuring test for #117 works with new limits") [#117](https://github.com/javadelight/delight-nashorn-sandbox/issues/117) [works with new limits](/javadelight/delight-nashorn-sandbox/commit/46928cd8c4b07fbc9e5f7f27b2b58308aeaa821e "Ensuring test for #117 works with new limits")`

`[46928cd](/javadelight/delight-nashorn-sandbox/commit/46928cd8c4b07fbc9e5f7f27b2b58308aeaa821e)`

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fjavadelight%2Fdelight-nashorn-sandbox%2Fissues%2F117)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging a pull request may close this issue.

 [Protect against RegEx attacks in santising script input](/javadelight/delight-nashorn-sandbox/pull/139)
 [javadelight/delight-nashorn-sandbox](/javadelight/delight-nashorn-sandbox)

8 participants

[![@mxro](https://avatars.githubusercontent.com/u/1448524?s=52&v=4)](/mxro) [![@SugarP1g](https://avatars.githubusercontent.com/u/9649416?s=52&v=4)](/SugarP1g) [![@junweili](https://avatars.githubusercontent.com/u/12969536?s=52&v=4)](/junweili) [![@gregorywaynepower](https://avatars.githubusercontent.com/u/31050507?s=52&v=4)](/gregorywaynepower) [![@MrLi2018](https://avatars.githubusercontent.com/u/39287657?s=52&v=4)](/MrLi2018) [![@huzongxin1994](https://avatars.githubusercontent.com/u/40710427?s=52&v=4)](/huzongxin1994) [![@lgtest1789](https://avatars.githubusercontent.com/u/46701428?s=52&v=4)](/lgtest1789) [![@asilism](https://avatars.githubusercontent.com/u/77270499?s=52&v=4)](/asilism)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


