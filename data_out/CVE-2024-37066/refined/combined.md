=== Content from hiddenlayer.com_8ca66ca6_20250111_201143.html ===


* [Platform](https://hiddenlayer.com/aisec-platform/)
  + [AISec Platform](https://hiddenlayer.com/aisec-platform/)
  + [Automated Red Teaming for AI](https://hiddenlayer.com/autortai/)
  + [AI Detection & Response](https://hiddenlayer.com/aidr/)
  + [Model Scanner](https://hiddenlayer.com/model-scanner/)
* [Solutions](https://hiddenlayer.com/solutions/)
  + [Finance](https://hiddenlayer.com/solutions/finance/)
  + [Public Sector](https://hiddenlayer.com/solutions/publicsector/)
  + [Tech](https://hiddenlayer.com/solutions/tech/)
* [Services](https://hiddenlayer.com/services/)
* [Learn](https://hiddenlayer.com/innovation-hub/)
  + [Innovation Hub](https://hiddenlayer.com/innovation-hub/)
  + [Insights](https://hiddenlayer.com/innovation-hub/category/insights/)
  + [Research](https://hiddenlayer.com/innovation-hub/category/research/)
  + [Reports and Guides](https://hiddenlayer.com/innovation-hub/category/reports-and-guides/)
  + [SAI Security Advisory](/sai-security-advisory/)
* [Partner](https://hiddenlayer.com/partner/)
  + [Go-To-Market Partner](https://hiddenlayer.com/gtm-partner/)
  + [Technology Alliance](https://hiddenlayer.com/tech-alliance/)
  + [Apply](https://hiddenlayer.com/reseller-application/)
* [Company](https://hiddenlayer.com/company/)
  + [About](https://hiddenlayer.com/company/)
  + [In the News](https://hiddenlayer.com/innovation-hub/category/in-the-news/)
* [Book a Demo](https://hiddenlayer.com/book-a-demo/)

* [Platform](https://hiddenlayer.com/aisec-platform/)
  + [AISec Platform](https://hiddenlayer.com/aisec-platform/)
  + [Automated Red Teaming for AI](https://hiddenlayer.com/autortai/)
  + [AI Detection & Response](https://hiddenlayer.com/aidr/)
  + [Model Scanner](https://hiddenlayer.com/model-scanner/)
* [Solutions](https://hiddenlayer.com/solutions/)
  + [Finance](https://hiddenlayer.com/solutions/finance/)
  + [Public Sector](https://hiddenlayer.com/solutions/publicsector/)
  + [Tech](https://hiddenlayer.com/solutions/tech/)
* [Services](https://hiddenlayer.com/services/)
* [Learn](https://hiddenlayer.com/innovation-hub/)
  + [Innovation Hub](https://hiddenlayer.com/innovation-hub/)
  + [Insights](https://hiddenlayer.com/innovation-hub/category/insights/)
  + [Research](https://hiddenlayer.com/innovation-hub/category/research/)
  + [Reports and Guides](https://hiddenlayer.com/innovation-hub/category/reports-and-guides/)
  + [SAI Security Advisory](/sai-security-advisory/)
* [Partner](https://hiddenlayer.com/partner/)
  + [Go-To-Market Partner](https://hiddenlayer.com/gtm-partner/)
  + [Technology Alliance](https://hiddenlayer.com/tech-alliance/)
  + [Apply](https://hiddenlayer.com/reseller-application/)
* [Company](https://hiddenlayer.com/company/)
  + [About](https://hiddenlayer.com/company/)
  + [In the News](https://hiddenlayer.com/innovation-hub/category/in-the-news/)
* [Book a Demo](https://hiddenlayer.com/book-a-demo/)

# Wyze Cam V4 Vulnerability Report

###### Jul 19, 2024

## Crafted WiFI network name (SSID) leads to arbitrary command injection

#### CVE Number

CVE-2024-37066

#### Summary

The *net\_service\_thread*function in *libwyzeUtilsPlatform.so* spawns a shell command containing a user-specified WiFi network name (SSID) in an unsafe way, which can lead to arbitrary command injection as root during the camera setup process.

#### Products Impacted

This vulnerability is present in *Wyze Cam V4* firmware versions up to and including 4.52.4.9887.

#### CVSS Score: 6.8

AV:P/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

#### CWE Categorization

CWE-78: Improper Neutralization of Special Elements used in an OS Command (‘OS Command Injection’)

#### Details

This vulnerability is caused by the net\_service\_thread function in the */system/lib/libwyzeUtilsPlatform.so* library.

```
00004604 snprintf(&str, 0x3fb, "iwlist wlan0 scan | grep \'ESSID:\"%s\"\'", 0x18054, var_938, var_934, var_930, err_21, var_928);
00004618 int32_t $v0_6 = exec_shell_sync(&str, &var_918);
```

The *net\_service\_thread* function is used by the *init\_net\_service* function which is invoked by */system/bin/iCamera* during the camera setup process. The purpose of this function is to initialize the camera’s wireless networking.

The user-specified WiFi network name (SSID) provided during the camera setup is passed to a shell command without sanitization. An attacker within Bluetooth range of the camera can exploit this by specifying a network name containing a command enclosed in single quotes followed by a semicolon.

To replicate this vulnerability, the Wyze app can send the camera a crafted WiFi network name containing the command to execute.

![](data:image/svg+xml... "Wyze_CraftedWIFIname1_300w")![](https://hiddenlayer.com/wp-content/uploads/Wyze_CraftedWIFIname1_300w.png "Wyze_CraftedWIFIname1_300w")

After hitting the Connect button, the command will be sent to the camera over Bluetooth and executed through the *exec\_shell\_exec*function. In the example pictured above, the command *whoami* is executed, and the output is piped to a file named pwned.txt on the root of the camera’s SD card.

The command injection is saved to the camera’s config and persists across reboots. During our testing, we found that it was possible to brick the camera by providing it with a WiFi network name containing the reboot command.

![](data:image/svg+xml... "Wyze_CraftedWIFIname2_300w")![](https://hiddenlayer.com/wp-content/uploads/Wyze_CraftedWIFIname2_300w.png "Wyze_CraftedWIFIname2_300w")

This resulted in the camera going into an endless reboot loop that we could not exit.

HiddenLayer, a Gartner recognized Cool Vendor for AI Security, is the leading provider of Security for AI. Its security platform helps enterprises safeguard the machine learning models behind their most important products. HiddenLayer is the only company to offer turnkey security for AI that does not add unnecessary complexity to models and does not require access to raw data and algorithms. Founded by a team with deep roots in security and ML, HiddenLayer aims to protect enterprise’s AI from inference, bypass, extraction attacks, and model theft. The company is backed by a group of strategic investors, including M12, Microsoft’s Venture Fund, Moore Strategic Ventures, Booz Allen Ventures, IBM Ventures, and Capital One Ventures.

[Book a Demo](https://hiddenlayer.com/book-a-demo/)

* [Platform](https://hiddenlayer.com/aisec-platform/)
* [Solutions](https://hiddenlayer.com/solutions/)
* [Services](https://hiddenlayer.com/services/)
* [Learn](https://hiddenlayer.com/innovation-hub/)
* [Partner](https://hiddenlayer.com/partner/)
* [Company](https://hiddenlayer.com/company/)
* [Careers](https://hiddenlayer.com/careers/)
* [Contact](https://hiddenlayer.com/contact/)

© 2025 HiddenLayer

![AICPA SOC logo](data:image/svg+xml... "21972-312_SOC_NonCPA")![AICPA SOC logo](https://hiddenlayer.com/wp-content/uploads/21972-312_SOC_NonCPA-80x80.png "21972-312_SOC_NonCPA")

[Security](https://hiddenlayer.com/security/) [Privacy Policy](https://hiddenlayer.com/privacy/)  [Vulnerability Disclosure Policy](https://hiddenlayer.com/vulnerability-disclosure-policy/) [Sitemap](https://hiddenlayer.com/sitemap/)

* [Twitter](https://twitter.com/hiddenlayersec "Twitter")
* [Linkedin](https://www.linkedin.com/company/hiddenlayersec/ "Linkedin")

[Scroll to top](#top "Scroll to top")

![](https://px.ads.linkedin.com/collect/?pid=5765668&fmt=gif)



=== Content from forums.wyze.com_db4399e6_20250111_201143.html ===


[Wyze Forum](/)

# [Security-advisory](/t/security-advisory/289256)

[Wyze News](/c/news/21)

[WyzeCybersecurity](https://forums.wyze.com/u/WyzeCybersecurity)

February 12, 2024, 9:34pm

1

**Wyze Cam v4:**

4.52.7.0367 - release: 07/11/2024

• Fixed command injection

**Wyze Cam v3:**

4.36.11.7095 - release: 10/25/2023

• Fixed authentication bypass

• Fixed stack buffer overflow in IOCTL

4.36.11.8391 - release : 1/18/2024

• Fixed Wi-Fi SSID command injection

• Fixed leaking Authkey

• Fixed stack buffer overflow memcpy

• Fixed stack buffer overflow in command handler

• Fixed buffer overflow in RealTek driver

• Fixed Realtek 802.11 header fragmentation security issue

• Fixed stack buffer overflow in JSON unpacking

**Wyze Cam Pan v2:**

4.49.11.7095 - release: 10/31/2023

• Fixed authentication bypass

• Fixed stack buffer overflow in IOCTL

4.49.11.8391 - release: 1/22/2024

• Fixed Wi-Fi SSID command injection

• Fixed leaking Authkey

• Fixed stack buffer overflow memcpy

• Fixed stack buffer overflow in command handler

• Fixed buffer overflow in RealTek driver

• Fixed Realtek 802.11 header fragmentation security issue

• Fixed stack buffer overflow in JSON unpacking

**Wyze Cam v3 Pro:**

4.58.11.7357 - release: 11/08/2023

• Fixed authentication bypass

• Fixed stack buffer overflow in IOCTL

4.58.11.8391 - release: 1/22/2024

• Fixed Wi-Fi SSID command injection

• Fixed leaking Authkey

• Fixed stack buffer overflow memcpy

• Fixed stack buffer overflow in command handler

• Fixed buffer overflow in RealTek driver

• Fixed Realtek 802.11 header fragmentation security issue

• Fixed stack buffer overflow in JSON unpacking

**Wyze Cam v2:**

4.9.9.2847 - 100% public release: 11/06/2023

• Fixed authentication bypass

• Fixed stack buffer overflow in IOCTL

4.9.9.3006 - release : 1/23/2024

• Fixed Wi-Fi SSID command injection

• Fixed leaking Authkey

• Fixed stack buffer overflow memcpy

• Fixed stack buffer overflow in command handler

• Fixed buffer overflow in RealTek driver

• Fixed Realtek 802.11 header fragmentation security issue

• Fixed stack buffer overflow in JSON unpacking

**Wyze Cam Pan v1:**

4.10.9.2847 - release: 11/06/2023

• Fixed authentication bypass

• Fixed stack buffer overflow in IOCTL

4.10.9.3006 - release : 1/23/2024

• Fixed Wi-Fi SSID command injection

• Fixed leaking Authkey

• Fixed stack buffer overflow memcpy

• Fixed stack buffer overflow in command handler

• Fixed buffer overflow in RealTek driver

• Fixed Realtek 802.11 header fragmentation security issue

• Fixed stack buffer overflow in JSON unpacking

**Wyze Cam Pan v3:**

4.50.4.7252 - release: 11/02/2023

• Fixed authentication bypass

• Fixed stack buffer overflow in IOCTL

4.50.4.8409 - release: 1/23/2024

• Fixed Wi-Fi SSID command injection

• Fixed leaking Authkey

• Fixed stack buffer overflow memcpy

• Fixed stack buffer overflow in command handler

• Fixed stack buffer overflow in JSON unpacking

**Wyze Cam Outdoor Base Station:**

4.16.4.512 - release: 11/06/2023

• Fixed authentication bypass

4.16.4.523 - release: 1/24/2024

• Fixed leaking Authkey

• Fixed stack buffer overflow memcpy

• Fixed stack buffer overflow in command handler

**Wyze Cam Outdoor v1:**

4.17.4.427 - release: 11/06/2023

• Fixed stack buffer overflow in IOCTL

Wyze Cam Outdoor v2:

4.48.4.427 - release: 11/06/2023

• Fixed stack buffer overflow in IOCTL

**Wyze Video Doorbell v1:**

4.25.1.316 - release: 11/02/2023

• Fixed authentication bypass

• Fixed stack buffer overflow in IOCTL

4.25.1.333 - release: 1/24/2024

• Fixed leaking Authkey

• Fixed stack buffer overflow memcpy

• Fixed stack buffer overflow in command handler

• Fixed buffer overflow in RealTek driver

• Fixed Realtek 802.11 header fragmentation security issue

**Wyze Video Doorbell v2:**

4.51.1.7518 - release: 11/06/2023

• Fixed authentication bypass

• Fixed stack buffer overflow in ioctl

4.51.1.8444 - release: 1/24/2024

• Fixed Wi-Fi SSID command injection

• Fixed leaking Authkey

• Fixed stack buffer overflow memcpy

• Fixed stack buffer overflow in command handler

• Fixed stack buffer overflow in JSON unpacking

**Wyze Floodlight v2:**

4.53.2.8430 - release : 1/23/2024

• Fixed leaking Authkey

• Fixed stack buffer overflow memcpy

• Fixed stack buffer overflow in command handler

• Fixed stack buffer overflow in JSON unpacking

10 Likes

[carverofchoice](https://forums.wyze.com/u/carverofchoice)

February 12, 2024, 9:58pm

2

WOW! I honestly never expected this much transparency on which security improvements were made in the firmware! I like that you waited a while to post it all so that most people will have had the time to update to the new firmware first, and then revealed how busy you’ve been making improvements since way back in November. Sounds like Wyze has made a lot of active effort in looking for more and more things to improve security constantly as promised. I just never expected you’d be transparent about so many of the things you’ve been working on that weren’t public yet. This is great!

6 Likes

[IEatBeans](https://forums.wyze.com/u/IEatBeans)

February 12, 2024, 10:28pm

3

Wow, that’s a lot of fixes, and it’s cool to see how much work is being done on these issues.

It also goes to show how important it is to keep your devices up to date.

5 Likes

[muerte33](https://forums.wyze.com/u/muerte33)

February 12, 2024, 10:30pm

4

Thanks for this list, and thanks for not releasing it till we got updated!

![:slight_smile:](https://emoji.discourse-cdn.com/facebook_messenger/slight_smile.png?v=12 ":slight_smile:")

I noticed the Video Doorbell Pro has not gotten an update in a while 1.0.73 3/1/2023.

Hopefully it is OK!

4 Likes

[spamoni](https://forums.wyze.com/u/spamoni)

February 12, 2024, 11:29pm

5

The is amazing. Thanks for the information and transparency.

You all have been busy. ![:slight_smile:](https://emoji.discourse-cdn.com/facebook_messenger/slight_smile.png?v=12 ":slight_smile:")

5 Likes

[Omgitstony](https://forums.wyze.com/u/Omgitstony)

February 13, 2024, 12:06am

6

I don’t know what most of this means but judging by all the acronyms it’s serious! ![:slight_smile:](https://emoji.discourse-cdn.com/facebook_messenger/slight_smile.png?v=12 ":slight_smile:")

4 Likes

[jozefd14](https://forums.wyze.com/u/jozefd14)

February 13, 2024, 1:15am

7

Great for the WCO updates in November that were security updates… however bring back “no cooldown” for cam plus please lol

2 Likes

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [Update Your Wyze Cam v3 Firmware For Latest Security Updates 10/30/23](https://forums.wyze.com/t/update-your-wyze-cam-v3-firmware-for-latest-security-updates-10-30-23/279553)  [Wyze News](/c/news/21) | 55 | 11200 | January 31, 2024 |
| [I found a potential security & stability flaw in Beta Firmware for Cam v2 (4.9.6.104) and Pan (4.10.6.104)](https://forums.wyze.com/t/i-found-a-potential-security-stability-flaw-in-beta-firmware-for-cam-v2-4-9-6-104-and-pan-4-10-6-104/109862)  [Beta](/c/beta/31) [cam-pan-v1](https://forums.wyze.com/tag/cam-pan-v1) ,  [cam-v1-v2](https://forums.wyze.com/tag/cam-v1-v2) ,  [important](https://forums.wyze.com/tag/important) | 5 | 535 | January 26, 2021 |
| [Wyze Video Doorbell v1 and Wyze Cam Pan v3 firmware updates - Released 11/2/2023](https://forums.wyze.com/t/wyze-video-doorbell-v1-and-wyze-cam-pan-v3-firmware-updates-released-11-2-2023/279876)  [Wyze News](/c/news/21) [firmware](https://forums.wyze.com/tag/firmware) ,  [update](https://forums.wyze.com/tag/update) | 39 | 2560 | November 17, 2023 |
| [Firmware Versions 4.9.4.169 and 4.10.3.169 Released!](https://forums.wyze.com/t/firmware-versions-4-9-4-169-and-4-10-3-169-released/57753)  [Wyze News](/c/news/21) [update](https://forums.wyze.com/tag/update) | 86 | 10070 | October 24, 2019 |
| [Productive concern. Informed complaint](https://forums.wyze.com/t/productive-concern-informed-complaint/224194)  [Cameras](/c/cameras/20) [cam-pan-v1](https://forums.wyze.com/tag/cam-pan-v1) ,  [cam-v1-v2](https://forums.wyze.com/tag/cam-v1-v2) ,  [bug](https://forums.wyze.com/tag/bug) ,  [cam-v3](https://forums.wyze.com/tag/cam-v3) ,  [cam-pan-v2](https://forums.wyze.com/tag/cam-pan-v2) | 2 | 589 | April 3, 2022 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](https://www.wyzecam.com/term-conditions/)
* [Privacy Policy](https://www.wyze.com/policies/privacy-policy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled


