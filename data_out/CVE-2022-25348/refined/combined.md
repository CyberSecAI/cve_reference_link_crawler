=== Content from jvn.jp_28304ef6_20250108_125610.html ===


![Japan Vulnerability Notes](/common/img/note_logo.gif)

Published:2022/03/30  Last Updated:2022/03/30
# JVN#10140834 AttacheCase may insecurely load Dynamic Link Libraries

## Overview

AttacheCase may insecurely load Dynamic Link Libraries.

## Products Affected

* AttacheCase ver.3.6.1.0 and earlier - CVE-2022-28128
* AttacheCase ver.4.0.2.7 and earlier - CVE-2022-25348

## Description

AttacheCase is an open source file encryption software provided by HiBARA Software.

AttacheCase contains an issue with the DLL search path, which may lead to insecurely loading Dynamic Link Libraries ([CWE-427](https://cwe.mitre.org/data/definitions/427.html)).

## Impact

Arbitrary code may be executed with the privilege to run the software.

## Solution

**Update the software**

Update the software to the latest version according to the information provided by the developer.

## Vendor Status

| Vendor | Status | Last Update | Vendor Notes |
| --- | --- | --- | --- |
| HiBARA Software | [Vulnerable](995196/index.html) | 2022/03/30 | [HiBARA Software website](https://hibara.org/software/attachecase/?lang=en) |

## References

1. [Japan Vulnerability Notes JVNTA#91240916](https://jvn.jp/en/ta/JVNTA91240916/)
   Insecure DLL Loading and Command Execution Issues on Many Windows Application Programs

## JPCERT/CC Addendum

## Vulnerability Analysis by JPCERT/CC

CVSS v3
CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
Base Score:
7.8

| Attack Vector(AV) | Physical (P) | Local (L) | Adjacent (A) | Network (N) |
| --- | --- | --- | --- | --- |
| Attack Complexity(AC) | High (H) | Low (L) |
| Privileges Required(PR) | High (H) | Low (L) | None (N) |
| User Interaction(UI) | Required (R) | None (N) |
| Scope(S) | Unchanged (U) | Changed (C) |
| Confidentiality Impact(C) | None (N) | Low (L) | High (H) |
| Integrity Impact(I) | None (N) | Low (L) | High (H) |
| Availability Impact(A) | None (N) | Low (L) | High (H) |

CVSS v2
AV:N/AC:M/Au:N/C:P/I:P/A:P
Base Score:
6.8

| Access Vector(AV) | Local (L) | Adjacent Network (A) | Network (N) |
| --- | --- | --- | --- |
| Access Complexity(AC) | High (H) | Medium (M) | Low (L) |
| Authentication(Au) | Multiple (M) | Single (S) | None (N) |
| Confidentiality Impact(C) | None (N) | Partial (P) | Complete (C) |
| Integrity Impact(I) | None (N) | Partial (P) | Complete (C) |
| Availability Impact(A) | None (N) | Partial (P) | Complete (C) |

## Credit

Taizoh Tsukamoto of Mitsui Bussan Secure Directions, Inc. reported this vulnerability to IPA.

JPCERT/CC coordinated with the developer under Information Security Early Warning Partnership.

## Other Information

| JPCERT Alert |  |
| --- | --- |
| JPCERT Reports |  |
| CERT Advisory |  |
| CPNI Advisory |  |
| TRnotes |  |
| CVE | [CVE-2022-28128](https://www.cve.org/CVERecord?id=CVE-2022-28128) |
|  | [CVE-2022-25348](https://www.cve.org/CVERecord?id=CVE-2022-25348) |
| JVN iPedia | [JVNDB-2022-000022](https://jvndb.jvn.jp/jvndb/JVNDB-2022-000022) |

* JVN
* [HOME](/en/index.html)
* [What is JVN ?](/en/nav/jvn.html)
* [Instructions](/en/nav/jvnhelp.html)
* [List of Vulnerability Report](/en/report/index.html)
* [VN\_JP](/en/jp/index.html)
* [VN\_JP(Unreachable)](/en/adj/index.html)
* [VN\_VU](/en/vu/index.html)
* [TA](/en/ta/index.html)
* [TRnotes](/en/tr/index.html)
* [JVN iPedia](http://jvndb.jvn.jp/en/)
* [MyJVN](http://jvndb.jvn.jp/en/apis/myjvn/index.html)
* [JVNJS/RSS](/en/rss/index.html)
* [Vendor List](/en/nav/index.html)
* [List of unreachable developers](/en/reply/index.html)
* [Contact](/en/contact/index.html)

Copyright (c) 2000-2022 JPCERT/CC and IPA. All rights reserved.



=== Content from hibara.org_4f027d91_20250108_125608.html ===


[![logo](https://hibara.org/img/logo.png)](https://hibara.org)

* [Home](https://hibara.org/)
* [Software](https://hibara.org/)
  + [![アタッシェケースアイコン](https://hibara.org/img/attachecase-icon-36x36.png)
    ##### AttachéCase

    File encryption tool (Windows)](https://hibara.org/software/attachecase/)
  + [![アタッシェケースアイコン](https://hibara.org/img/rhymingtool-icon-36x36.png)
    ##### RhymingTool

    Creating lyrics & rhyming in Japanese (Windows)](https://hibara.org/software/rhymingtool/)
  + [![MarkDown#Editorアイコン](https://hibara.org/img/markdownsharpeditor-icon-36x36.png)
    ##### MarkDown#Editor

    Markdown dual editor (Windows)](https://hibara.org/software/markdownsharpeditor/)
  + [![OutlineTextアイコン](https://hibara.org/img/bosscoming-icon-36x36.png)
    ##### BossComing

    Replace by a fake desktop in an instant(Windows)](https://hibara.org/software/bosscoming/)
  + [![たまさぼアイコン](https://hibara.org/img/tamasabo-icon-36x36.png)
    ##### "Tamasabo" Growth Simulation Game

    Smart phone app（iOS）](https://tamasabo.com/)
* Web App
  + [![AttacheCase.NETアイコン](https://hibara.org/img/attachecase-net-icon-32x32.png)
    ##### AttacheCase.NET

    Secure key exchange and encryption support services](https://attachecase.net/)
  + [![i18n.pageアイコン](https://hibara.org/img/i18n-page-icon.svg)
    ##### i18n.page

    Easy website translation tool（Web service）](https://i18n.page/)
* Development tools
  + [![](https://hibara.org/img/png2winico-icon-36x36.png)
    ##### Png2WinIco

    PNG to Windows ICO file generation(Windows)](https://hibara.org/software/png2winico/)
  + [![](https://hibara.org/img/shcode-jp-zen-haku-icon-36x36.png)
    ##### SHCode-JP-Zen-Haku

    Monospaced font for programming(Windows, macOS, Linux)](https://github.com/hibara/SHCode-JP-Zen-Haku)
  + [![](https://hibara.org/img/hidemaru-macro-icon-36x36.png)
    ##### Hidemaru Editor Date Insert Macro

    A macro for the "Hidemaru Editor" that allows flexible date insertion.](https://hide.maruo.co.jp/lib/macro/insdate102.html)
  + [![](https://hibara.org/img/hidemaru-highlighter-icon-36x36.png)
    ##### Hidemaru Editor Markdown highlighting definition file

    Highlighting definition file for the "Hidemaru Editor"](https://hide.maruo.co.jp/lib/hilight/mrkdwn102.html)
* [About](https://hibara.org/about.php)

### Index   ( [ja](./?lang=ja) / **en** )

* [Introduction](#introduction)

  + [Encypted executable file](#exe-out)
  + [Supports both Windows and macOS](#both-win-mac)
  + [Advanced Encryption Standard](#aes)
  + [CBC Encryption mode](#aes)
  + [RFC2898 key derivation](#rfc2898)
  + [New data spec](#new-data)
  + [Loadmap](#loadmap)
* [Commercial use](#commercial-use)
* [Download](#download)

  + [Ver.4](#v4)
  + [Ver.3](#v3)
  + [Ver.2](#v2)
* [Oneline Help](#online-help)
* [Contact me (Support)](#contact-me)

![AttachéCase icon](img/main_icon_128x128.png)
#### AttachéCase ( Current Version )

##### Windows10, 11 / macOS

![Windows 10 logo](img/Windows_10_Logo.svg)
![Apple logo](img/apple-logo.svg)

> "AttachéCase4" is a powerful file/folder encryption software that
> uses the world's standard encryption algorithm,
> while focusing on simplicity and ease of use for daily use.

> ###### Important Notice（2022/03/30）
>
> A vulnerability in loading DLL was discovered in "AttacheCase4" for Windows.
> Placing a maliciously modified "dwmapi.dll"
> in the directory containing the executable file (AttacheCase.exe)
> may allow arbitrary code to be executed.
>
>
>
> This vulnerability have been confirmed in **ver. 4.0.2.7 or earlier**.
> If you are using these versions of "AttacheCase4",
> please update to the [latest version](#download) as soon as possible.
>
>
>
> More information on this vulnerability can be found at the following page.
>
> [https://hibara.org/software/attachecase/vulnerability/](vulnerability/)
>
>
>
> JVN#10140834
>
> **AttacheCase may insecurely load Dynamic Link Libraries**
>
> <https://jvn.jp/jp/JVN10140834/>
>
>
>
> By countermeasuring of this vulnerability,
> the previous vulnerability in the older version of the "
> [AttacheCase#3](#v3)
> " is also fixed.
>
>
>
> If you are using this version, please update to the latest version as soon as possible.

"[AttacheCase.NET](https://attachecase.net/)",
a key exchange and encryption support service
using AttacheCase public key cryptosystem, is now available.
Please make use of it if you like.

![Main Window](img/main_window_en.png)

アタッシェケースは、ver.4から**商用利用にかぎり、有償**となりました。
詳しくは後述の「[商用利用は有償](#commercial-use)」をご覧ください。

スポンサー・リンク

## Introduction

#### Encryption is just three steps

Encryption is just three steps.
You can easily encrypt files by simply dragging and dropping them,
or if you drag and drop the entire folder,
it will create one encrypted file (pack the entire folder).

![File encryption in just 3 steps](img/3-steps-horizontal_en.png)

![large](img/3-steps-horizontal_en.png)

In addition, the data will be compressed during the encryption process,
making it compact in size.

Decrypting is also as easy as dragging and dropping,
or double-clicking and entering the password to restore the original files and folders.

#### Output in self-executable format

The encrypted file can also be output as an executable (\*.exe) file,
so it can be passed to someone who does not have an AttachéCase and can be decrypted.

![Output in self-executable format](img/exeout_en.png)

![large](img/exeout.png)

The Mac version cannot output in self-executable format,
but it can decrypt executable files (\*.exe) generated by the Windows version.

#### Supports both Windows and macOS

Enables data exchange on Windows and macOS.

![AttcheCase for Mac](img/attachecase_mac.png)

At present, the macOS version is inferior to the Windows version in terms of functionality,
but I plan to bring the functionality closer to the Windows version in the future.

#### Public key cryptography

From ver.4, public key cryptography (RSA) is also supported.
By exchanging public and private keys,
it is no longer necessary to exchange ZIP passwords,
making it possible to exchange data more securely.

![Sending the public key](img/public_key_en.png)

![Decrypting with a private key](img/private_key_en.png)

![RSA Cryption](img/rsa_crypt_en.png)
#### Cryptographic algorithms are global standards

The encryption algorithm is based on the Advanced Encryption Standard (AES),
the next-generation encryption standard chosen by the U.S. Government's
[National Institute of Standards and Technology (NIST)](http://www.nist.gov/)
in October 2000. Also, the encryption mode used is CBC mode.

![CBC暗号化モード](img/cbc-mode_en.png)

![large](img/cbc-mode_en.png)

#### Key derivation according to RFC2898

![Key derivation according to RFC2898](img/rfc2898derive_bytes_en.png)

![large](img/rfc2898derive_bytes_en.png)

Based on "PKCS #5: Password-Based Cryptography Specification Version 2.0" by
[RFC2898](https://tools.ietf.org/html/rfc2898),
the derived key and initialization vector after
1,000 iterations of password-based key derivation mixed with random numbers
as salt are output one after another, and each is used as the key
and initialization vector for encryption.

## New data format (Current version)

Starting from ver.4, a new data format has been introduced,
which enables more efficient encryption and decryption based on
the know-how accumulated in the development up to ver.3.
Note that ver.4 can decrypt data of ver.3 and 2,
but ver.3 and 2 cannot decrypt data of ver.4. For details on data formats,
please refer to "
[here](data/data_structure.pdf)
".

The old version is [below](#v3).

## Development Roadmap

Microsoft's development environment has been slower to go cross-platform than we expected. And macOS applications are not suitable for cross-platform development when they are desktop applications such as file encryption applications, not web-based.

Therefore, I am revising our development roadmap and extending support for AttacheCase4, which is currently available, to **2026/01/12**, the expiration date of Microsoft's library support.

The macOS version, which inevitably has data compatibility, shall have the same support period.

It cannot be said that vulnerabilities will not be discovered in the AES algorithm in the future, and standardization work on "Post-Quantum Cryptography" which will replace the current public key cryptography or Digital Signature Algorithms,
is in progress in [NIST](https://csrc.nist.gov/Projects/post-quantum-cryptography).
We will consider developing the next version of "AttacheCase5" when such new technologies emerge. Therefore, the release date is undecided.

In the future, we will focus on more stable operation of the current "AttacheCase4" and additional functions to make it even easier to use.

![Development Roadmap](img/roadmap_en.png)

![large](img/roadmap_en.png)

## Starting from ver.4, commercial use will be charged.

#### Windows

I also set the "trial period" as one month,
but there is no limit to how long you can continue using the app.

The price is **550 yen (tax included) per 1 user**.

Note that

* For home and personal use
* Students and educational institutions

can use it free of charge as a free license version.

You have free personal use,
but if you would like to support us in the form of "support" or "donation",
you are welcome to pay so. In that case, you will be issued a registration code,
just like a commercial user.

* [**How to register your registration code.pdf**](data/How%20to%20register%20your%20registration%20code.pdf)

As a result, support for the previous ver. 3 and 2 is no longer available.
However, the previous versions will continue to be available free of charge for
both personal and commercial use.

[Go to purchase page

(Google Pay and credit card payment)](buy/)

[Transfer from a bank

If you would like to make a deposit from a bank transfer,

please click here.](bank/)
#### macOS

As for the macOS version,
anyone (regardless of personal or commercial use) can use it free of charge.

However, that is only for downloads from this website,
and any future downloads handled by the App Store will be paid for
(whether for personal or commercial use).

The reason why downloads from this website,
including the macOS version, are free of charge,
while downloads from the App Store are paid for, is explained in the next section.

#### Why commercial use is now paid for?

There are many reasons for this,
including the cost of managing and maintaining websites,
the cost of continuing software development,
especially the cost of "code signing certificates"
that are added to executable files to prove that they are safe on Windows
and can be installed without warning messages,
and, for macOS, the Apple Developer registration fee etc.
has become very difficult to cover with the decrease in advertising revenue.

I get a lot of emails about bugs and complaints,
but other than that, I don't know what kind of people are using it,
and to be honest, I'm loss of motivation.

The source code is released under the GPLv3 license (the macOS version is not open to the public),
so there are no restrictions on using it as a stray build.
You will only be charged for downloading the software from this official website or
the App Store (\* Currently under review).
In other words, please think of it as the cost of the distributed product,
including development and maintenance costs, code signing certificate fees, etc.

スポンサー・リンク

## Download

#### Ver.4

![Windows10 logo](img/Windows_10_Logo.svg)
![Apple logo](img/apple-logo.svg)

##### Hash value

MD5:

SHA-1:

SHA-256:

MD5:

SHA-1:

SHA-256:

MD5:

SHA-1:

SHA-256:

## Update history for Windows version

[View more updates](history/)

## Update history for macOS version

[View more updates](history/?platform=mac)

#### Old Ver.3

> ###### Important Notice（2022/03/30）
>
> A previously reported vulnerability allows "AttacheCase#3"
> to be DLL hijacked (DLL preloaded) by placing certain DLL files
> in the location where the output self-extracting archive file
> and the main body "AttacheCase.exe" are located.
>
>
>
> Please update to the latest version "AttacheCase#3" as soon as possible.
>
> JVN#61502349
>
> **Self-Extracting Encrypted Files created by AttacheCase may insecurely load Dynamic Link Libraries**
>
> <https://jvn.jp/en/jp/JVN61502349/>

![Windows10 logo](img/Windows_10_Logo.svg)

* Although support for this software has been discontinued by Microsoft,
  it also will work on Windows XP.
* [.NET Framework 4](https://www.microsoft.com/ja-jp/download/details.aspx?id=17851)
  or higher is required for operation.

##### Hash value

MD5:

SHA-1:

MD5:

SHA-1:

## Update history

[View more updates](history/)

#### Old Ver.2

![WindowsXP logo](img/windows_xp.svg)

##### Hash value

MD5:

SHA-1:

MD5:

SHA-1:

[View more updates](history/)

## Open source license

#### GPLv3 license

![GPLv3ライセンス・ロゴ](img/gplv3-127x51.png)

For the AttachéCase (ver. 4, 3), the
[GPLv3 license](https://www.gnu.org/licenses/gpl-3.0.html)
applies.

> Copyright (C) 2020 M.Hibara
>
> This program is free software: you can redistribute it and/or modify
> it under the terms of the GNU General Public License as published
> by the Free Software Foundation, either version 3 of the License,
> or (at your option) any later version.
>
> This program is distributed in the hope that it will be useful,
> but WITHOUT ANY WARRANTY; without even the implied warranty of
> MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
> See the GNU General Public License for more details.
>
> You should have received a copy of the GNU General Public License
> along with this program. If not, see <http://www.gnu.org/licenses/>.

Ver. 2 is distributed under the
[BSD license](https://opensource.org/licenses/BSD-3-Clause)
.
Please note that the license type differs depending on the version.

Libraries by other authors that are used in the AttachéCase should follow their respective licenses.

## Source code

##### [hibara - GitHub](https://github.com/hibara/)

It has been built and tested with
[Microsoft Visual Studio 2019.](https://visualstudio.microsoft.com/ja/downloads/)
It includes everything you need to build, including resource files.
You are welcome to report bugs and requests to Issue, pull requests, forks, etc.

The MacOS version is not open source due to Apple's terms and conditions.
However, the classes required for encryption and decryption
(specifically, Encrypt4.cs and Decrypt4.cs) are the same.

![GitHubロゴ](img/github-octcat.png)

## Data specification

Starting from ver.4, the cryptographic algorithm has been changed to
AES 256bit CBC mode for ease of porting.
I keep that .NET is moving in the direction of cutting off Rijindael 256 support
for in the future in mind.

In addition, I used to use SHA-1 for checksums,
which is a heavy load. MD5 is now sufficient for this purpose.

The file information stored in the data is now stored serially as
binary data instead of character strings.
For details, please see the following PDF file.

[Download data specification](data/data_structure.pdf)

To learn more about the data structure, including previous versions (ver.3 and 2),
please download the PDF data above and check it out.

## オンラインヘルプ

[![answer action](img/help-icon.png)

## AttachéCase Online Help

Click here for details on how to operate,
each operation setting, and encryption specifications.

[Open page](help/)](help/)

## Support

For inquiries (support), please contact us by e-mail.
Please contact us at the following address

> Mitsuhiro Hibara

If you would like to report a problem,
please specify your OS version (Windows, macOS, and its version),
the version of the AttachéCase you are using,
and describe a situation that I can reproduce.
If I can't reproduce the problem, I can't fix it.

If possible, please attach reproducible files and passwords
(dummy data and dummy passwords are fine) so that I can make revisions smoothly.

> ###### Improvements, bug reports, and pull requests from GitHub are most welcome!
>
> If possible, please use the
> [GitHub repository](https://github.com/hibara/AttacheCase4)
> instead of your email address,
> and send improvements and bug reports to
> [Issues](https://github.com/hibara/AttacheCase4/issues)
> , or
> [Pull Requests](https://github.com/hibara/AttacheCase4/pulls)
> if you can fix the code directly.

© 2011-2025 M.Hibara

[Privacy Policy](../../privacy-policy.html) /
[Software commercial license agreement](../../software-commercial-license-agreement.html)

[![Facebook icon](../../img/social-icon/facebook-icon.png)](https://www.facebook.com/hibara.mitsuhiro)

[![Twitter icon](../../img/social-icon/twitter_icon.png)](https://twitter.com/hibara_org)

[![GitHub icon](../../img/social-icon/github-icon.png)](https://github.com/hibara)

[![Qiita icon](../../img/social-icon/qiita-icon.png)](http://qiita.com/hibara)


