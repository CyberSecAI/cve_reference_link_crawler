

[Log in](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-16544)[Skip to main content](#main)[Skip to sidebar](#sidebar)Linked ApplicationsLoadingâ€¦[![XWiki.org JIRA](/s/-65z3d2/930000/8ws80b/_/jira-logo-scaled.png)](https://jira.xwiki.org/secure/MyJiraHome.jspa)

* [Dashboards](/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/secure/BrowseProjects.jspa "View recent projects and browse a list of projects")
* [Issues](/issues/ "Search for issues and view recent issues")

* Give feedback to Atlassian
* [Help](https://docs.atlassian.com/jira/jcore-docs-093/ "Help")
  + [Jira Core help](https://docs.atlassian.com/jira/jcore-docs-093/ "Go to the online documentation for Jira Core")
  + [Keyboard Shortcuts](/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [About Jira](/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-16544)

![Uploaded image for project: 'XWiki Platform'](https://jira.xwiki.org/secure/projectavatar?pid=10010&avatarId=13602)

1. [XWiki Platform](/browse/XWIKI)
2. [XWIKI-16544](/browse/XWIKI-16544)

# Unauthenticated user can retrieve the list of users through getdocuments.vm

[Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-16544 "Log In")ClosedExportnull

XMLWordPrintable
#### Details

* **Type:**
  ![](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.") Bug
* **Resolution:**
  Fixed
* **Priority:**
  ![](/images/icons/priorities/minor.svg "Minor - Minor loss of function, or other problem where easy workaround is present.") Minor
* **Fix Version/s:**
  [12.10.11](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+12.10.11 "12.10.11 "), [13.9-rc-1](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+13.9-rc-1 "13.9-rc-1 "), [13.4.4](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+13.4.4 "13.4.4 ")
* **Affects Version/s:**
  8.4.5, 10.11.8, 11.3.1, 13.6-rc-1
* **Component/s:**
  [Like](/issues/?jql=project+%3D+XWIKI+AND+component+%3D+%22Like%22 "Like "), [LiveTable](/issues/?jql=project+%3D+XWIKI+AND+component+%3D+LiveTable "LiveTable "), [Web - Templates & Resources](/issues/?jql=project+%3D+XWIKI+AND+component+%3D+%22Web+-+Templates+%26+Resources%22 "Web - Templates & Resources ")
* **Labels:**
  + [attack\_dataleak](/issues/?jql=labels+%3D+attack_dataleak "attack_dataleak")
  + [attacker\_guest](/issues/?jql=labels+%3D+attacker_guest "attacker_guest")
  + [security](/issues/?jql=labels+%3D+security "security")

* **Tests:**
  Unit
* **Development Priority:**
  Low
* **Difficulty:**
  Hard
* **Documentation:**
  N/A
* **Documentation in Release Notes:**
  N/A
* **Similar issues:**

#### Description

An unauthenticated user can retrieve the list of users through a public accessible URL

Note: the dataleak is only true in case of a closed wiki, with specific rights to allow the usage of ForgotUsername/ResetPassword pages.

Note: a "closed wiki" is when "Prevent unregistered users from viewing pages, regardless of the page rights in the User" is checked in the admin (XWiki.XWikiPreference.authenticate\_view = true)

To reproduce this access one of the following:

```

<server>/xwiki/bin/get/XWiki/ForgotUsername?xpage=getdocuments&childrenOf=XWiki&exclude=XWiki.ForgotUsername&queryFilters=unique,hidden&offset=1&limit=100&reqNo=2
```

```

<server>/xwiki/bin/get/XWiki/ResetPassword?xpage=getdocuments&childrenOf=XWiki&exclude=XWiki.ResetPassword&queryFilters=unique,hidden&offset=1&limit=100&reqNo=2
```

```

<server>/xwiki/bin/login/XWikiLogin?xpage=getdocuments&limit=10000
```

Note: ForgotUsername/ResetPassword are not accessible anymore, but the issue is still true for XWikiLogin, and needs to be solved in a general way.

II managed to make them inaccessible by removing the XwikiGuest user from objects of these pages:

* <server>/xwiki/bin/edit/XWiki/ResetPassword
* <server>/xwiki/bin/edit/XWiki/ForgotUsername

  But this makes the Reset password / username unusable.

Note that this issue is not directly related to ResetPassword / ForgotUsername pages: it exists for any page of the wiki available for guest user.

In addition to getdocuments from the examples above, the following templates could also be used in the same way, and have been fixed accordingly:

* getdeleteddocuments.vm
* getgroupmembers.vm
* getgroups.vm
* getusers.vm

#### Attachments

#### Issue Links

causes

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[XWIKI-19755](/browse/XWIKI-19755)
Changing the pagination page when all the results are already fetched empties the livetable

* ![Blocker - Blocks development and/or testing work, production could not run.](/images/icons/priorities/blocker.svg "Blocker - Blocks development and/or testing work, production could not run.")
* Closed

depends on

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[XWIKI-11205](/browse/XWIKI-11205)
If view rights are not allowed for guest users then ResetPassword doesn't work

* ![Major - Major loss of function.](/images/icons/priorities/major.svg "Major - Major loss of function.")
* Closed

is related to

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[XWIKI-18851](/browse/XWIKI-18851)
Unauthenticated user can retrieve user information through getdeleteddocuments.vm

* ![Blocker - Blocks development and/or testing work, production could not run.](/images/icons/priorities/blocker.svg "Blocker - Blocks development and/or testing work, production could not run.")
* Closed

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[XWIKI-16610](/browse/XWIKI-16610)
Forgot Username and Reset Password are not available in closed wiki

* ![Major - Major loss of function.](/images/icons/priorities/major.svg "Major - Major loss of function.")
* Closed

relates to

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[XWIKI-18849](/browse/XWIKI-18849)
Private user data are accessible through suggest.vm

* ![Blocker - Blocks development and/or testing work, production could not run.](/images/icons/priorities/blocker.svg "Blocker - Blocks development and/or testing work, production could not run.")
* Closed

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[XWIKI-18851](/browse/XWIKI-18851)
Unauthenticated user can retrieve user information through getdeleteddocuments.vm

* ![Blocker - Blocks development and/or testing work, production could not run.](/images/icons/priorities/blocker.svg "Blocker - Blocks development and/or testing work, production could not run.")
* Closed

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[XWIKI-9069](/browse/XWIKI-9069)
Private document name leak in document index

* ![Major - Major loss of function.](/images/icons/priorities/major.svg "Major - Major loss of function.")
* Closed

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[XWIKI-18768](/browse/XWIKI-18768)
Copy and delete actions are proposed to the user even when she can't perform them

* ![Major - Major loss of function.](/images/icons/priorities/major.svg "Major - Major loss of function.")
* Closed

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[XWIKI-18850](/browse/XWIKI-18850)
Unauthenticated user can retrieve the list of users through uorgsuggest.vm

* ![Minor - Minor loss of function, or other problem where easy workaround is present.](/images/icons/priorities/minor.svg "Minor - Minor loss of function, or other problem where easy workaround is present.")
* Closed

![Improvement - An improvement or enhancement to an existing feature or task.](/secure/viewavatar?size=xsmall&avatarId=13510&avatarType=issuetype "Improvement - An improvement or enhancement to an existing feature or task.")
[XWIKI-9649](/browse/XWIKI-9649)
Don't display not viewable documents in livetable

* ![Minor - Minor loss of function, or other problem where easy workaround is present.](/images/icons/priorities/minor.svg "Minor - Minor loss of function, or other problem where easy workaround is present.")
* Open

links to

![Web Link](https://github.com/favicon.ico "Web Link")
[GHSA-qpp2-2mcp-2wm5](https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-qpp2-2mcp-2wm5)

Show 6 more links (5 relates to, 1 links to)

#### Activity

#### People

Assignee:

![mleduc](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Manuel Leduc

Reporter:

![andreic](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Camelia Andrei

Votes:
0
Vote for this issue

Watchers:
6
Start watching this issue

#### Dates

Created:

28/Jun/19 12:13

Updated:

08/Feb/24 09:38

Resolved:

15/Oct/21 10:55

Date of First Response:

25/Jul/19 2:24 PM

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/secure/CreateIssue%21default.jspa)

Powered by a free Atlassian [Jira](http://www.atlassian.com/software/jira) open source license for XWiki.org. Try Jira - [bug tracking software](http://www.atlassian.com/software/jira) for *your* team.

[Atlassian](http://www.atlassian.com/)

