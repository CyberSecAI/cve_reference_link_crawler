





<!DOCTYPE html>
<html class="gl-light ui-neutral with-top-bar with-header " lang="en">
<head prefix="og: http://ogp.me/ns#">
<meta charset="utf-8">
<meta content="IE=edge" http-equiv="X-UA-Compatible">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>Regex backtracking vulnerability with `commit_trailers_filter.rb` allows an attacker to exploit ReDoS through the `Commit message` field (#363734) · Issues · GitLab.org / GitLab · GitLab</title>
<script nonce="V8CVyrDQZPR8KOxxYquPbQ==">
//<![CDATA[
window.gon={};gon.api_version="v4";gon.default_avatar_url="https://gitlab.com/assets/no_avatar-849f9c04a3a0d0cea2424ae97b27447dc64a7dbfae83c036c45b403392f0e8ba.png";gon.max_file_size=100;gon.asset_host=null;gon.webpack_public_path="/assets/webpack/";gon.relative_url_root="";gon.user_color_mode="gl-light";gon.user_color_scheme="white";gon.markdown_surround_selection=null;gon.markdown_automatic_lists=null;gon.math_rendering_limits_enabled=true;gon.analytics_url="https://collector.prd-278964.gl-product-analytics.com";gon.analytics_id="715db59f-f350-4bfd-aef8-e7a7f0c023f0";gon.sentry_dsn="https://f5573e26de8f4293b285e556c35dfd6e@new-sentry.gitlab.net/4";gon.sentry_environment="gprd";gon.sentry_clientside_traces_sample_rate=0.05;gon.recaptcha_api_server_url="https://www.recaptcha.net/recaptcha/api.js";gon.recaptcha_sitekey="6LfAERQTAAAAAL4GYSiAMGLbcLyUIBSfPrDNJgeC";gon.gitlab_url="https://gitlab.com";gon.promo_url="https://about.gitlab.com";gon.forum_url="https://forum.gitlab.com";gon.docs_url="https://docs.gitlab.com";gon.revision="3d54f902af4";gon.feature_category="team_planning";gon.gitlab_logo="/assets/gitlab_logo-2957169c8ef64c58616a1ac3f4fc626e8a35ce4eb3ed31bb0d873712f2a041a0.png";gon.secure=true;gon.sprite_icons="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg";gon.sprite_file_icons="/assets/file_icons/file_icons-7cd3d6c3b29a6d972895f36472978a4b5adb4b37f9b5d0716a380e82389f7e0e.svg";gon.emoji_sprites_css_path="/assets/emoji_sprites-bd26211944b9d072037ec97cb138f1a52cd03ef185cd38b8d1fcc963245199a1.css";gon.emoji_backend_version=4;gon.gridstack_css_path="/assets/lazy_bundles/gridstack-5fcfd4ffbea1db04eaf7f16521bcab19ae3af042c8b4afe8d16781eda5a70799.css";gon.test_env=false;gon.disable_animations=null;gon.suggested_label_colors={"#cc338b":"Magenta-pink","#dc143c":"Crimson","#c21e56":"Rose red","#cd5b45":"Dark coral","#ed9121":"Carrot orange","#eee600":"Titanium yellow","#009966":"Green-cyan","#8fbc8f":"Dark sea green","#6699cc":"Blue-gray","#e6e6fa":"Lavender","#9400d3":"Dark violet","#330066":"Deep violet","#36454f":"Charcoal grey","#808080":"Gray"};gon.first_day_of_week=0;gon.time_display_relative=true;gon.time_display_format=0;gon.ee=true;gon.jh=false;gon.dot_com=true;gon.uf_error_prefix="UF";gon.pat_prefix="glpat-";gon.keyboard_shortcuts_enabled=true;gon.diagramsnet_url="https://embed.diagrams.net";gon.features={"sourceEditorToolbar":false,"vscodeWebIde":true,"uiForOrganizations":false,"organizationSwitching":false,"findAndReplace":false,"removeMonitorMetrics":true,"workItemsViewPreference":false,"searchButtonTopRight":false,"duoChatDynamicDimension":false,"advancedContextResolver":true,"preserveMarkdown":true,"issuesGridView":false,"serviceDeskTicket":false,"issuesListDrawer":false,"notificationsTodosButtons":false,"glqlIntegration":true,"workItemsBeta":true,"workItemsAlpha":false,"workItems":true,"epicWidgetEditConfirmation":false,"namespaceLevelWorkItems":false,"okrsMvc":false,"workItemEpics":true};gon.roadmap_epics_limit=1000;gon.subscriptions_url="https://customers.gitlab.com";gon.subscriptions_legacy_sign_in_url="https://customers.gitlab.com/customers/sign_in?legacy=true";gon.billing_accounts_url="https://customers.gitlab.com/billing_accounts";gon.payment_form_url="https://customers.gitlab.com/payment_forms/cc_validation";gon.payment_validation_form_id="payment_method_validation";gon.licensed_features={"escalationPolicies":true,"okrs":true};gon.abilities={"summarizeComments":false,"measureCommentTemperature":false};
//]]>
</script>


<script nonce="V8CVyrDQZPR8KOxxYquPbQ==">
//<![CDATA[
var gl = window.gl || {};
gl.startup_calls = {"/gitlab-org/gitlab/-/issues/363734/related_branches":{},"/gitlab-org/gitlab/-/issues/363734/discussions.json?per_page=20":{},"/gitlab-org/gitlab/-/issues/363734.json?serializer=sidebar_extras":{}};
gl.startup_graphql_calls = [{"query":"query getDesignList($fullPath: ID!, $iid: String!, $atVersion: DesignManagementVersionID) {\n  project(fullPath: $fullPath) {\n    __typename\n    id\n    issue(iid: $iid) {\n      __typename\n      id\n      designCollection {\n        __typename\n        copyState\n        designs(atVersion: $atVersion) {\n          __typename\n          nodes {\n            __typename\n            id\n            event\n            filename\n            notesCount\n            image\n            imageV432x230\n            currentUserTodos(state: pending) {\n              __typename\n              nodes {\n                __typename\n                id\n              }\n            }\n          }\n        }\n        versions {\n          __typename\n          nodes {\n            __typename\n            id\n            sha\n            createdAt\n            author {\n              __typename\n              id\n              name\n              avatarUrl\n            }\n          }\n        }\n      }\n    }\n  }\n}\n","variables":{"fullPath":"gitlab-org/gitlab","iid":"363734","atVersion":null}},{"query":"query permissions($fullPath: ID!, $iid: String!) {\n  project(fullPath: $fullPath) {\n    __typename\n    id\n    issue(iid: $iid) {\n      __typename\n      id\n      userPermissions {\n        __typename\n        createDesign\n      }\n    }\n  }\n}\n","variables":{"fullPath":"gitlab-org/gitlab","iid":"363734"}}];

if (gl.startup_calls && window.fetch) {
  Object.keys(gl.startup_calls).forEach(apiCall => {
   gl.startup_calls[apiCall] = {
      fetchCall: fetch(apiCall, {
        // Emulate XHR for Rails AJAX request checks
        headers: {
          'X-Requested-With': 'XMLHttpRequest'
        },
        // fetch won’t send cookies in older browsers, unless you set the credentials init option.
        // We set to `same-origin` which is default value in modern browsers.
        // See https://github.com/whatwg/fetch/pull/585 for more information.
        credentials: 'same-origin'
      })
    };
  });
}
if (gl.startup_graphql_calls && window.fetch) {
  const headers = {"X-CSRF-Token":"WeN73wCZ6ob_YSSQ7RGOi0vZKvon5FvvMrLzpx-q-KwumxQirR6tdDM7ewlm_L0wjNtD8FFLXhlTz8JLdKRcnA","x-gitlab-feature-category":"team_planning"};
  const url = `https://gitlab.com/api/graphql`

  const opts = {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      ...headers,
    }
  };

  gl.startup_graphql_calls = gl.startup_graphql_calls.map(call => ({
    ...call,
    fetchCall: fetch(url, {
      ...opts,
      credentials: 'same-origin',
      body: JSON.stringify(call)
    })
  }))
}


//]]>
</script>



<link rel="stylesheet" href="/assets/application-9de688b302d723d15d70ba51a5410625092e3bc978dbb160cc523f86c4807968.css" />
<link rel="stylesheet" href="/assets/page_bundles/design_management-f20ae9b5b8c9a0f793e3ffa2ddc13953bfd683e1d351c8e6cc75e0fcd4ddde90.css" /><link rel="stylesheet" href="/assets/page_bundles/incidents-b9f383aefa56f0a72990496e4a4b3aaf2c525843283a1c0c3d85876537187397.css" /><link rel="stylesheet" href="/assets/page_bundles/issuable-e25480d2326300d5c49ad31dbd847a53e39fc33a5fd595a961dd7238e411b558.css" /><link rel="stylesheet" href="/assets/page_bundles/notes_shared-7e727ab1e91b421915feadeb04a1b9d57213cb1b2f8f56f4d894b34d6b42e9b3.css" /><link rel="stylesheet" href="/assets/page_bundles/issues_show-785541c300108b8ecf7c08fd02bd67f4d6b9d59c86918ecfbf91bae5e1c8ffa8.css" /><link rel="stylesheet" href="/assets/page_bundles/work_items-22a76cdd1fe2ae5431b7ff603f86212acaf81b49c4a932f19e3b3222dc1881ee.css" /><link rel="stylesheet" href="/assets/page_bundles/labels-3508460b8d6f839e9d60de1f2065fdaf7f057efab04cf71966acef6a86fe9b41.css" /><link rel="stylesheet" href="/assets/page_bundles/commit_description-1e2cba4dda3c7b30dd84924809020c569f1308dea51520fe1dd5d4ce31403195.css" />
<link rel="stylesheet" href="/assets/application_utilities-73b9a1c83703ccfccd0e1e418c7d8dc606fcac533fa38b9fa86792f098db0f9a.css" />
<link rel="stylesheet" href="/assets/tailwind-284f33824923c600abd24d7884ff853fd38734b17a1441a1b7e31d4aa365acc2.css" />


<link rel="stylesheet" href="/assets/fonts-fae5d3f79948bd85f18b6513a025f863b19636e85b09a1492907eb4b1bb0557b.css" />
<link rel="stylesheet" href="/assets/highlight/themes/white-e31d355458ead69f8798dbb62f54c60c4ccc7db35289cbbd2353ddfdf5109aac.css" />

<script src="/assets/webpack/runtime.f0860ff2.bundle.js" defer="defer" nonce="V8CVyrDQZPR8KOxxYquPbQ=="></script>
<script src="/assets/webpack/main.78bd52ff.chunk.js" defer="defer" nonce="V8CVyrDQZPR8KOxxYquPbQ=="></script>
<script src="/assets/webpack/tracker.868aa839.chunk.js" defer="defer" nonce="V8CVyrDQZPR8KOxxYquPbQ=="></script>
<script src="/assets/webpack/analytics.cb60a77a.chunk.js" defer="defer" nonce="V8CVyrDQZPR8KOxxYquPbQ=="></script>
<script nonce="V8CVyrDQZPR8KOxxYquPbQ==">
//<![CDATA[
window.snowplowOptions = {"namespace":"gl","hostname":"snowplowprd.trx.gitlab.net","cookieDomain":".gitlab.com","appId":"gitlab","formTracking":true,"linkClickTracking":true}

gl = window.gl || {};
gl.snowplowStandardContext = {"schema":"iglu:com.gitlab/gitlab_standard/jsonschema/1-1-1","data":{"environment":"production","source":"gitlab-rails","correlation_id":"01JGW9W0WAEPXRR5R362XR9E3T","plan":"gold","extra":{},"user_id":null,"global_user_id":null,"is_gitlab_team_member":null,"namespace_id":9970,"project_id":278964,"feature_enabled_by_namespace_ids":null,"realm":"saas","instance_id":"ea8bf810-1d6f-4a6a-b4fd-93e8cbd8b57f","host_name":"gitlab-cny-webservice-web-7b99886bd6-8ww8g","instance_version":"17.8.0","context_generated_at":"2025-01-05T22:37:47.503Z"}}
gl.snowplowPseudonymizedPageUrl = "https://gitlab.com/namespace9970/project278964/-/issues/363734";
gl.maskedDefaultReferrerUrl = null;
gl.ga4MeasurementId = 'G-ENFH3X7M5Y';


//]]>
</script>
<link rel="preload" href="/assets/application_utilities-73b9a1c83703ccfccd0e1e418c7d8dc606fcac533fa38b9fa86792f098db0f9a.css" as="style" type="text/css" nonce="0T2Xl9gpC/ofqKaGTlR++g==">
<link rel="preload" href="/assets/application-9de688b302d723d15d70ba51a5410625092e3bc978dbb160cc523f86c4807968.css" as="style" type="text/css" nonce="0T2Xl9gpC/ofqKaGTlR++g==">
<link rel="preload" href="/assets/highlight/themes/white-e31d355458ead69f8798dbb62f54c60c4ccc7db35289cbbd2353ddfdf5109aac.css" as="style" type="text/css" nonce="0T2Xl9gpC/ofqKaGTlR++g==">
<link crossorigin="" href="https://snowplowprd.trx.gitlab.net" rel="preconnect">
<link as="font" crossorigin="" href="/assets/gitlab-sans/GitLabSans-1e0a5107ea3bbd4be93e8ad2c503467e43166cd37e4293570b490e0812ede98b.woff2" rel="preload">
<link as="font" crossorigin="" href="/assets/gitlab-sans/GitLabSans-Italic-38eaf1a569a54ab28c58b92a4a8de3afb96b6ebc250cf372003a7b38151848cc.woff2" rel="preload">
<link as="font" crossorigin="" href="/assets/gitlab-mono/GitLabMono-08d2c5e8ff8fd3d2d6ec55bc7713380f8981c35f9d2df14e12b835464d6e8f23.woff2" rel="preload">
<link as="font" crossorigin="" href="/assets/gitlab-mono/GitLabMono-Italic-38e58d8df29485a20c550da1d0111e2c2169f6dcbcf894f2cd3afbdd97bcc588.woff2" rel="preload">
<link rel="preload" href="/assets/fonts-fae5d3f79948bd85f18b6513a025f863b19636e85b09a1492907eb4b1bb0557b.css" as="style" type="text/css" nonce="0T2Xl9gpC/ofqKaGTlR++g==">



<script src="/assets/webpack/sentry.907cf3e4.chunk.js" defer="defer" nonce="V8CVyrDQZPR8KOxxYquPbQ=="></script>

<script src="/assets/webpack/9.49e5c3e3.chunk.js" defer="defer" nonce="V8CVyrDQZPR8KOxxYquPbQ=="></script>
<script src="/assets/webpack/11.e2e145a2.chunk.js" defer="defer" nonce="V8CVyrDQZPR8KOxxYquPbQ=="></script>
<script src="/assets/webpack/13.3d62f21f.chunk.js" defer="defer" nonce="V8CVyrDQZPR8KOxxYquPbQ=="></script>
<script src="/assets/webpack/commons-pages.groups.analytics.dashboards-pages.groups.harbor.repositories-pages.groups.iteration_ca-b07ae190.ba6536d6.chunk.js" defer="defer" nonce="V8CVyrDQZPR8KOxxYquPbQ=="></script>
<script src="/assets/webpack/commons-pages.groups.new-pages.import.gitlab_projects.new-pages.import.manifest.new-pages.projects.n-44c6c18e.3be560a5.chunk.js" defer="defer" nonce="V8CVyrDQZPR8KOxxYquPbQ=="></script>
<script src="/assets/webpack/commons-pages.search.show-super_sidebar.ca4ee38a.chunk.js" defer="defer" nonce="V8CVyrDQZPR8KOxxYquPbQ=="></script>
<script src="/assets/webpack/super_sidebar.14e23139.chunk.js" defer="defer" nonce="V8CVyrDQZPR8KOxxYquPbQ=="></script>
<script src="/assets/webpack/commons-pages.projects-pages.projects.activity-pages.projects.alert_management.details-pages.project-bce54798.cf2cb6b5.chunk.js" defer="defer" nonce="V8CVyrDQZPR8KOxxYquPbQ=="></script>
<script src="/assets/webpack/pages.projects.issues.show.779fd13b.chunk.js" defer="defer" nonce="V8CVyrDQZPR8KOxxYquPbQ=="></script>

<meta content="object" property="og:type">
<meta content="GitLab" property="og:site_name">
<meta content="Regex backtracking vulnerability with `commit_trailers_filter.rb` allows an attacker to exploit ReDoS through the `Commit message` field (#363734) · Issues · GitLab.org / GitLab · GitLab" property="og:title">
<meta content="HackerOne report #1584156 by ryhmnlfj on 2022-05-28, assigned to @cmaxim:..." property="og:description">
<meta content="https://gitlab.com/uploads/-/system/project/avatar/278964/project_avatar.png" property="og:image">
<meta content="64" property="og:image:width">
<meta content="64" property="og:image:height">
<meta content="https://gitlab.com/gitlab-org/gitlab/-/issues/363734" property="og:url">
<meta content="summary" property="twitter:card">
<meta content="Regex backtracking vulnerability with `commit_trailers_filter.rb` allows an attacker to exploit ReDoS through the `Commit message` field (#363734) · Issues · GitLab.org / GitLab · GitLab" property="twitter:title">
<meta content="HackerOne report #1584156 by ryhmnlfj on 2022-05-28, assigned to @cmaxim:..." property="twitter:description">
<meta content="https://gitlab.com/uploads/-/system/project/avatar/278964/project_avatar.png" property="twitter:image">
<meta property="twitter:label1" content="Author"><meta property="twitter:data1" content="GitLab SecurityBot"><meta property="twitter:label2" content="Assignee"><meta property="twitter:data2" content="Igor Drozdov">
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="ph0CKQO_GcE8NM2Otu2P1xCtkXuPsNMpLDequJT-JVrRZW3UrjheM_Bukhc9ALxs16_4cfkf1t9NSptU__CBag" />
<meta name="csp-nonce" content="V8CVyrDQZPR8KOxxYquPbQ==" />
<meta name="action-cable-url" content="/-/cable" />
<link href="/-/manifest.json" rel="manifest">
<link rel="icon" type="image/png" href="/assets/favicon-yellow-018213ceb87b472388095d0264be5b4319ef47471dacea03c83ecc233ced2fd5.png" id="favicon" data-original-href="/assets/favicon-yellow-018213ceb87b472388095d0264be5b4319ef47471dacea03c83ecc233ced2fd5.png" />
<link rel="apple-touch-icon" type="image/x-icon" href="/assets/apple-touch-icon-b049d4bc0dd9626f31db825d61880737befc7835982586d015bded10b4435460.png" />
<link href="/search/opensearch.xml" rel="search" title="Search GitLab" type="application/opensearchdescription+xml">




<meta content="HackerOne report #1584156 by ryhmnlfj on 2022-05-28, assigned to @cmaxim:..." name="description">
<meta content="#ececef" name="theme-color">
</head>

<body class="tab-width-8 gl-browser-chrome gl-platform-windows" data-group="gitlab-org" data-group-full-path="gitlab-org" data-namespace-id="9970" data-page="projects:issues:show" data-page-type-id="363734" data-project="gitlab" data-project-full-path="gitlab-org/gitlab" data-project-id="278964">
<script nonce="V8CVyrDQZPR8KOxxYquPbQ==">
//<![CDATA[
gl = window.gl || {};
gl.GfmAutoComplete = gl.GfmAutoComplete || {};
gl.GfmAutoComplete.dataSources = {"epics":"/gitlab-org/gitlab/-/autocomplete_sources/epics","iterations":"/gitlab-org/gitlab/-/autocomplete_sources/iterations","vulnerabilities":"/gitlab-org/gitlab/-/autocomplete_sources/vulnerabilities","members":"/gitlab-org/gitlab/-/autocomplete_sources/members?type=Issue\u0026type_id=363734","issues":"/gitlab-org/gitlab/-/autocomplete_sources/issues","mergeRequests":"/gitlab-org/gitlab/-/autocomplete_sources/merge_requests","labels":"/gitlab-org/gitlab/-/autocomplete_sources/labels?type=Issue\u0026type_id=363734","milestones":"/gitlab-org/gitlab/-/autocomplete_sources/milestones","commands":"/gitlab-org/gitlab/-/autocomplete_sources/commands?type=Issue\u0026type_id=363734","snippets":"/gitlab-org/gitlab/-/autocomplete_sources/snippets","contacts":"/gitlab-org/gitlab/-/autocomplete_sources/contacts?type=Issue\u0026type_id=363734","wikis":null};


//]]>
</script>
<script nonce="V8CVyrDQZPR8KOxxYquPbQ==">
//<![CDATA[
gl = window.gl || {};
gl.client = {"isChrome":true,"isWindows":true};


//]]>
</script>


<header class="header-logged-out" data-testid="navbar">
<a class="gl-sr-only gl-accessibility" href="#content-body">Skip to content</a>
<div class="container-fluid">
<nav aria-label="Explore GitLab" class="header-logged-out-nav gl-flex gl-gap-3 gl-justify-between">
<div class="gl-flex gl-items-center gl-gap-1">
<span class="gl-sr-only">GitLab</span>
<a title="Homepage" id="logo" class="header-logged-out-logo has-tooltip" aria-label="Homepage" data-track-label="main_navigation" data-track-action="click_gitlab_logo_link" data-track-property="navigation_top" href="/"><svg aria-hidden="true" role="img" class="tanuki-logo" width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path class="tanuki-shape tanuki" d="m24.507 9.5-.034-.09L21.082.562a.896.896 0 0 0-1.694.091l-2.29 7.01H7.825L5.535.653a.898.898 0 0 0-1.694-.09L.451 9.411.416 9.5a6.297 6.297 0 0 0 2.09 7.278l.012.01.03.022 5.16 3.867 2.56 1.935 1.554 1.176a1.051 1.051 0 0 0 1.268 0l1.555-1.176 2.56-1.935 5.197-3.89.014-.01A6.297 6.297 0 0 0 24.507 9.5Z"
        fill="#E24329"/>
  <path class="tanuki-shape right-cheek" d="m24.507 9.5-.034-.09a11.44 11.44 0 0 0-4.56 2.051l-7.447 5.632 4.742 3.584 5.197-3.89.014-.01A6.297 6.297 0 0 0 24.507 9.5Z"
        fill="#FC6D26"/>
  <path class="tanuki-shape chin" d="m7.707 20.677 2.56 1.935 1.555 1.176a1.051 1.051 0 0 0 1.268 0l1.555-1.176 2.56-1.935-4.743-3.584-4.755 3.584Z"
        fill="#FCA326"/>
  <path class="tanuki-shape left-cheek" d="M5.01 11.461a11.43 11.43 0 0 0-4.56-2.05L.416 9.5a6.297 6.297 0 0 0 2.09 7.278l.012.01.03.022 5.16 3.867 4.745-3.584-7.444-5.632Z"
        fill="#FC6D26"/>
</svg>

</a><a class="gl-badge badge badge-pill badge-success canary-badge" data-testid="canary_badge_link" href="https://next.gitlab.com" rel="noopener noreferrer" target="_blank"><span class="gl-badge-content">Next
</span></a></div>
<ul class="gl-list-none gl-p-0 gl-m-0 gl-flex gl-gap-3 gl-items-center gl-grow">
<li class="header-logged-out-nav-item header-logged-out-dropdown md:gl-hidden">
<button class="header-logged-out-toggle" data-toggle="dropdown" type="button">
<span class="gl-sr-only">
Menu
</span>
<svg class="s16" data-testid="hamburger-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#hamburger"></use></svg>
</button>
<div class="dropdown-menu">
<ul>
<li>
<a href="https://about.gitlab.com/why-gitlab">Why GitLab
</a></li>
<li>
<a href="https://about.gitlab.com/pricing">Pricing
</a></li>
<li>
<a href="https://about.gitlab.com/sales">Contact Sales
</a></li>
<li>
<a href="/explore">Explore</a>
</li>
</ul>
</div>
</li>
<li class="header-logged-out-nav-item gl-hidden md:gl-inline-block">
<a href="https://about.gitlab.com/why-gitlab">Why GitLab
</a></li>
<li class="header-logged-out-nav-item gl-hidden md:gl-inline-block">
<a href="https://about.gitlab.com/pricing">Pricing
</a></li>
<li class="header-logged-out-nav-item gl-hidden gl-inline-block">
<a href="https://about.gitlab.com/sales">Contact Sales
</a></li>
<li class="header-logged-out-nav-item gl-hidden md:gl-inline-block">
<a class="" href="/explore">Explore</a>
</li>
</ul>
<ul class="gl-list-none gl-p-0 gl-m-0 gl-flex gl-gap-3 gl-items-center gl-justify-end">
<li class="header-logged-out-nav-item">
<a href="/users/sign_in?redirect_to_referer=yes">Sign in</a>
</li>
<li class="header-logged-out-nav-item">
<a class="gl-button btn btn-md btn-confirm !gl-inline-flex" href="/users/sign_up"><span class="gl-button-text">
Get free trial

</span>

</a></li>
</ul>
</nav>
</div>
</header>

<div class="layout-page page-gutter right-sidebar-expanded page-with-super-sidebar">
<aside class="js-super-sidebar super-sidebar super-sidebar-loading" data-command-palette="{&quot;project_files_url&quot;:&quot;/gitlab-org/gitlab/-/files/master?format=json&quot;,&quot;project_blob_url&quot;:&quot;/gitlab-org/gitlab/-/blob/master&quot;}" data-force-desktop-expanded-sidebar="" data-is-saas="true" data-root-path="/" data-sidebar="{&quot;whats_new_most_recent_release_items_count&quot;:6,&quot;whats_new_version_digest&quot;:&quot;c955dbe1b30a1468b032fe6896086eda50f884ff9559d966e5ef75c34eee3ff0&quot;,&quot;is_logged_in&quot;:false,&quot;context_switcher_links&quot;:[{&quot;title&quot;:&quot;Explore&quot;,&quot;link&quot;:&quot;/explore&quot;,&quot;icon&quot;:&quot;compass&quot;}],&quot;current_menu_items&quot;:[{&quot;id&quot;:&quot;project_overview&quot;,&quot;title&quot;:&quot;GitLab&quot;,&quot;avatar&quot;:&quot;/uploads/-/system/project/avatar/278964/project_avatar.png&quot;,&quot;entity_id&quot;:278964,&quot;link&quot;:&quot;/gitlab-org/gitlab&quot;,&quot;link_classes&quot;:&quot;shortcuts-project&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;manage_menu&quot;,&quot;title&quot;:&quot;Manage&quot;,&quot;icon&quot;:&quot;users&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/activity&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;activity&quot;,&quot;title&quot;:&quot;Activity&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/activity&quot;,&quot;link_classes&quot;:&quot;shortcuts-project-activity&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;members&quot;,&quot;title&quot;:&quot;Members&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/project_members&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;labels&quot;,&quot;title&quot;:&quot;Labels&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/labels&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;plan_menu&quot;,&quot;title&quot;:&quot;Plan&quot;,&quot;icon&quot;:&quot;planning&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/issues&quot;,&quot;is_active&quot;:true,&quot;items&quot;:[{&quot;id&quot;:&quot;project_issue_list&quot;,&quot;title&quot;:&quot;Issues&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/issues&quot;,&quot;pill_count_field&quot;:&quot;openIssuesCount&quot;,&quot;link_classes&quot;:&quot;shortcuts-issues has-sub-items&quot;,&quot;is_active&quot;:true},{&quot;id&quot;:&quot;boards&quot;,&quot;title&quot;:&quot;Issue boards&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/boards&quot;,&quot;link_classes&quot;:&quot;shortcuts-issue-boards&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;milestones&quot;,&quot;title&quot;:&quot;Milestones&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/milestones&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;iterations&quot;,&quot;title&quot;:&quot;Iterations&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/cadences&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;requirements&quot;,&quot;title&quot;:&quot;Requirements&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/requirements_management/requirements&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;code_menu&quot;,&quot;title&quot;:&quot;Code&quot;,&quot;icon&quot;:&quot;code&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/merge_requests&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;project_merge_request_list&quot;,&quot;title&quot;:&quot;Merge requests&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/merge_requests&quot;,&quot;pill_count_field&quot;:&quot;openMergeRequestsCount&quot;,&quot;link_classes&quot;:&quot;shortcuts-merge_requests&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;files&quot;,&quot;title&quot;:&quot;Repository&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/tree/master&quot;,&quot;link_classes&quot;:&quot;shortcuts-tree&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;branches&quot;,&quot;title&quot;:&quot;Branches&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/branches&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;commits&quot;,&quot;title&quot;:&quot;Commits&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/commits/master?ref_type=heads&quot;,&quot;link_classes&quot;:&quot;shortcuts-commits&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;tags&quot;,&quot;title&quot;:&quot;Tags&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/tags&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;graphs&quot;,&quot;title&quot;:&quot;Repository graph&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/network/master?ref_type=heads&quot;,&quot;link_classes&quot;:&quot;shortcuts-network&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;compare&quot;,&quot;title&quot;:&quot;Compare revisions&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/compare?from=master\u0026to=master&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;project_snippets&quot;,&quot;title&quot;:&quot;Snippets&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/snippets&quot;,&quot;link_classes&quot;:&quot;shortcuts-snippets&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;file_locks&quot;,&quot;title&quot;:&quot;Locked files&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/path_locks&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;build_menu&quot;,&quot;title&quot;:&quot;Build&quot;,&quot;icon&quot;:&quot;rocket&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/pipelines&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;pipelines&quot;,&quot;title&quot;:&quot;Pipelines&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/pipelines&quot;,&quot;link_classes&quot;:&quot;shortcuts-pipelines&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;jobs&quot;,&quot;title&quot;:&quot;Jobs&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/jobs&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;pipeline_schedules&quot;,&quot;title&quot;:&quot;Pipeline schedules&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/pipeline_schedules&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;test_cases&quot;,&quot;title&quot;:&quot;Test cases&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/quality/test_cases&quot;,&quot;link_classes&quot;:&quot;shortcuts-test-cases&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;artifacts&quot;,&quot;title&quot;:&quot;Artifacts&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/artifacts&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;deploy_menu&quot;,&quot;title&quot;:&quot;Deploy&quot;,&quot;icon&quot;:&quot;deployments&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/releases&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;releases&quot;,&quot;title&quot;:&quot;Releases&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/releases&quot;,&quot;link_classes&quot;:&quot;shortcuts-deployments-releases&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;packages_registry&quot;,&quot;title&quot;:&quot;Package Registry&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/packages&quot;,&quot;link_classes&quot;:&quot;shortcuts-container-registry&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;container_registry&quot;,&quot;title&quot;:&quot;Container Registry&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/container_registry&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;model_registry&quot;,&quot;title&quot;:&quot;Model registry&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/ml/models&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;operations_menu&quot;,&quot;title&quot;:&quot;Operate&quot;,&quot;icon&quot;:&quot;cloud-pod&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/environments&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;environments&quot;,&quot;title&quot;:&quot;Environments&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/environments&quot;,&quot;link_classes&quot;:&quot;shortcuts-environments&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;infrastructure_registry&quot;,&quot;title&quot;:&quot;Terraform modules&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/terraform_module_registry&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;monitor_menu&quot;,&quot;title&quot;:&quot;Monitor&quot;,&quot;icon&quot;:&quot;monitor&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/incidents&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;incidents&quot;,&quot;title&quot;:&quot;Incidents&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/incidents&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;service_desk&quot;,&quot;title&quot;:&quot;Service Desk&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/issues/service_desk&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;analyze_menu&quot;,&quot;title&quot;:&quot;Analyze&quot;,&quot;icon&quot;:&quot;chart&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/value_stream_analytics&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;cycle_analytics&quot;,&quot;title&quot;:&quot;Value stream analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/value_stream_analytics&quot;,&quot;link_classes&quot;:&quot;shortcuts-project-cycle-analytics&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;contributors&quot;,&quot;title&quot;:&quot;Contributor analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/graphs/master?ref_type=heads&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;ci_cd_analytics&quot;,&quot;title&quot;:&quot;CI/CD analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/pipelines/charts&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;repository_analytics&quot;,&quot;title&quot;:&quot;Repository analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/graphs/master/charts&quot;,&quot;link_classes&quot;:&quot;shortcuts-repository-charts&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;code_review&quot;,&quot;title&quot;:&quot;Code review analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/analytics/code_reviews&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;issues&quot;,&quot;title&quot;:&quot;Issue analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/analytics/issues_analytics&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;insights&quot;,&quot;title&quot;:&quot;Insights&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/insights/&quot;,&quot;link_classes&quot;:&quot;shortcuts-project-insights&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;model_experiments&quot;,&quot;title&quot;:&quot;Model experiments&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/ml/experiments&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false}],&quot;current_context_header&quot;:&quot;Project&quot;,&quot;support_path&quot;:&quot;https://about.gitlab.com/get-help/&quot;,&quot;docs_path&quot;:&quot;/help/docs&quot;,&quot;display_whats_new&quot;:true,&quot;show_version_check&quot;:null,&quot;search&quot;:{&quot;search_path&quot;:&quot;/search&quot;,&quot;issues_path&quot;:&quot;/dashboard/issues&quot;,&quot;mr_path&quot;:&quot;/dashboard/merge_requests&quot;,&quot;autocomplete_path&quot;:&quot;/search/autocomplete&quot;,&quot;settings_path&quot;:&quot;/search/settings&quot;,&quot;search_context&quot;:{&quot;group&quot;:{&quot;id&quot;:9970,&quot;name&quot;:&quot;GitLab.org&quot;,&quot;full_name&quot;:&quot;GitLab.org&quot;},&quot;group_metadata&quot;:{&quot;issues_path&quot;:&quot;/groups/gitlab-org/-/issues&quot;,&quot;mr_path&quot;:&quot;/groups/gitlab-org/-/merge_requests&quot;},&quot;project&quot;:{&quot;id&quot;:278964,&quot;name&quot;:&quot;GitLab&quot;},&quot;project_metadata&quot;:{&quot;mr_path&quot;:&quot;/gitlab-org/gitlab/-/merge_requests&quot;,&quot;issues_path&quot;:&quot;/gitlab-org/gitlab/-/issues&quot;},&quot;code_search&quot;:false,&quot;scope&quot;:&quot;issues&quot;,&quot;for_snippets&quot;:null}},&quot;panel_type&quot;:&quot;project&quot;,&quot;shortcut_links&quot;:[{&quot;title&quot;:&quot;Snippets&quot;,&quot;href&quot;:&quot;/explore/snippets&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-snippets&quot;},{&quot;title&quot;:&quot;Groups&quot;,&quot;href&quot;:&quot;/explore/groups&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-groups&quot;},{&quot;title&quot;:&quot;Projects&quot;,&quot;href&quot;:&quot;/explore/projects/starred&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-projects&quot;}],&quot;terms&quot;:&quot;/-/users/terms&quot;}"></aside>

<div class="content-wrapper">
<div class="broadcast-wrapper">




</div>
<div class="alert-wrapper alert-wrapper-top-space gl-flex gl-flex-col gl-gap-3 container-fluid container-limited">






























</div>
<div class="top-bar-fixed container-fluid" data-testid="top-bar">
<div class="top-bar-container gl-flex gl-items-center gl-gap-2">
<div class="gl-grow gl-basis-0 gl-flex gl-items-center gl-justify-start">
<button class="gl-button btn btn-icon btn-md btn-default btn-default-tertiary js-super-sidebar-toggle-expand super-sidebar-toggle -gl-ml-3" aria-controls="super-sidebar" aria-expanded="false" aria-label="Primary navigation sidebar" type="button"><svg class="s16 gl-icon gl-button-icon " data-testid="sidebar-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#sidebar"></use></svg>

</button>
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"GitLab.org","item":"https://gitlab.com/gitlab-org"},{"@type":"ListItem","position":2,"name":"GitLab","item":"https://gitlab.com/gitlab-org/gitlab"},{"@type":"ListItem","position":3,"name":"Issues","item":"https://gitlab.com/gitlab-org/gitlab/-/issues"},{"@type":"ListItem","position":4,"name":"#363734","item":"https://gitlab.com/gitlab-org/gitlab/-/issues/363734"}]}


</script>
<div data-testid="breadcrumb-links" id="js-vue-page-breadcrumbs-wrapper">
<div data-breadcrumbs-json="[{&quot;text&quot;:&quot;GitLab.org&quot;,&quot;href&quot;:&quot;/gitlab-org&quot;,&quot;avatarPath&quot;:&quot;/uploads/-/system/group/avatar/9970/project_avatar.png&quot;},{&quot;text&quot;:&quot;GitLab&quot;,&quot;href&quot;:&quot;/gitlab-org/gitlab&quot;,&quot;avatarPath&quot;:&quot;/uploads/-/system/project/avatar/278964/project_avatar.png&quot;},{&quot;text&quot;:&quot;Issues&quot;,&quot;href&quot;:&quot;/gitlab-org/gitlab/-/issues&quot;,&quot;avatarPath&quot;:null},{&quot;text&quot;:&quot;#363734&quot;,&quot;href&quot;:&quot;/gitlab-org/gitlab/-/issues/363734&quot;,&quot;avatarPath&quot;:null}]" id="js-vue-page-breadcrumbs"></div>
<div id="js-injected-page-breadcrumbs"></div>
</div>


</div>
<div class="gl-flex-none gl-flex gl-items-center gl-justify-center">
<div id="js-advanced-search-modal"></div>

</div>
<div class="gl-grow gl-basis-0 gl-flex gl-items-center gl-justify-end">
<div id="js-work-item-feedback"></div>


</div>
</div>
</div>

<div class="container-fluid container-limited limit-container-width project-highlight-puc">
<main class="content" id="content-body" itemscope itemtype="http://schema.org/SoftwareSourceCode">
<div class="flash-container flash-container-page sticky" data-testid="flash-container">
<div id="js-global-alerts"></div>
</div>







<div class="issue-details issuable-details js-issue-details">
<div class="detail-page-description content-block js-detail-page-description gl-pt-3 gl-pb-0 gl-border-none">
<div data-header-actions-data="{&quot;can_create_issue&quot;:&quot;true&quot;,&quot;can_create_incident&quot;:&quot;false&quot;,&quot;can_destroy_issue&quot;:&quot;false&quot;,&quot;can_reopen_issue&quot;:&quot;false&quot;,&quot;can_report_spam&quot;:&quot;&quot;,&quot;can_update_issue&quot;:&quot;false&quot;,&quot;is_issue_author&quot;:&quot;false&quot;,&quot;issue_path&quot;:&quot;/gitlab-org/gitlab/-/issues/363734&quot;,&quot;new_issue_path&quot;:&quot;/gitlab-org/gitlab/-/issues/new?add_related_issue=363734&quot;,&quot;project_path&quot;:&quot;gitlab-org/gitlab&quot;,&quot;report_abuse_path&quot;:&quot;/-/abuse_reports/add_category&quot;,&quot;reported_user_id&quot;:2741139,&quot;reported_from_url&quot;:&quot;https://gitlab.com/gitlab-org/gitlab/-/issues/363734&quot;,&quot;submit_as_spam_path&quot;:&quot;/gitlab-org/gitlab/-/issues/363734/mark_as_spam&quot;,&quot;issuable_email_address&quot;:null,&quot;can_promote_to_epic&quot;:&quot;false&quot;}" data-initial="{&quot;endpoint&quot;:&quot;/gitlab-org/gitlab/-/issues/363734&quot;,&quot;updateEndpoint&quot;:&quot;/gitlab-org/gitlab/-/issues/363734.json&quot;,&quot;canUpdate&quot;:false,&quot;canDestroy&quot;:false,&quot;issuableRef&quot;:&quot;#363734&quot;,&quot;imported&quot;:false,&quot;markdownPreviewPath&quot;:&quot;/gitlab-org/gitlab/-/preview_markdown?target_id=363734\u0026target_type=Issue&quot;,&quot;markdownDocsPath&quot;:&quot;/help/user/markdown.md&quot;,&quot;lockVersion&quot;:0,&quot;issuableTemplateNamesPath&quot;:&quot;/gitlab-org/gitlab/description_templates/names/issue&quot;,&quot;initialTitleHtml&quot;:&quot;Regex backtracking vulnerability with `commit_trailers_filter.rb` allows an attacker to exploit ReDoS through the `Commit message` field&quot;,&quot;initialTitleText&quot;:&quot;Regex backtracking vulnerability with `commit_trailers_filter.rb` allows an attacker to exploit ReDoS through the `Commit message` field&quot;,&quot;initialDescriptionHtml&quot;:&quot;\u003cp data-sourcepos=\&quot;1:1-1:120\&quot; dir=\&quot;auto\&quot;\u003e\u003cstrong data-sourcepos=\&quot;1:1-1:70\&quot;\u003e\u003ca data-sourcepos=\&quot;1:3-1:68\&quot; href=\&quot;https://hackerone.com/reports/1584156\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003eHackerOne report #1584156\u003c/a\u003e\u003c/strong\u003e by \u003ccode data-sourcepos=\&quot;1:76-1:83\&quot;\u003eryhmnlfj\u003c/code\u003e on 2022-05-28, assigned to \u003ca href=\&quot;/cmaxim\&quot; data-reference-type=\&quot;user\&quot; data-user=\&quot;4086191\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; class=\&quot;gfm gfm-project_member js-user-link\&quot; title=\&quot;Costel Maxim\&quot;\u003e@cmaxim\u003c/a\u003e:\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;3:1-3:87\&quot; dir=\&quot;auto\&quot;\u003e\u003ca data-sourcepos=\&quot;3:1-3:17\&quot; href=\&quot;#report\&quot;\u003eReport\u003c/a\u003e | \u003ca data-sourcepos=\&quot;3:21-3:47\&quot; href=\&quot;#attachments\&quot;\u003eAttachments\u003c/a\u003e | \u003ca data-sourcepos=\&quot;3:51-3:87\&quot; href=\&quot;#how-to-reproduce\&quot;\u003eHow To Reproduce\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;5:1-5:9\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-report\&quot; class=\&quot;anchor\&quot; href=\&quot;#report\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eReport\u003c/h2\u003e\u0026#x000A;\u003ch4 data-sourcepos=\&quot;7:1-7:13\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-summary\&quot; class=\&quot;anchor\&quot; href=\&quot;#summary\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eSummary\u003c/h4\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;9:1-11:193\&quot; dir=\&quot;auto\&quot;\u003eI found server-side ReDoS vulnerability on commit trailer.\u003cbr data-sourcepos=\&quot;9:61-9:61\&quot;\u003e\u0026#x000A;This ReDoS vulnerability can be persisted as \u003cstrong data-sourcepos=\&quot;10:46-10:61\&quot;\u003eStored ReDoS\u003c/strong\u003e that can be retriggered by requesting to GET endpoint(\u003ccode data-sourcepos=\&quot;10:118-10:173\&quot;\u003e/[PROJECT_NAMESPACE]/-/commits/[BRANCH_CONTAINING_REDOS]\u003c/code\u003e).\u003cbr data-sourcepos=\&quot;10:179-10:179\&quot;\u003e\u0026#x000A;Normally, CSRFs to GET endpoint do not pose a security risk, but \u003cstrong data-sourcepos=\&quot;11:66-11:89\&quot;\u003eCSRF to Stored ReDoS\u003c/strong\u003e allows an attacker to expand the attackable scopes and force other users to attack the GitLab instance.\u003c/p\u003e\u0026#x000A;\u003ch4 data-sourcepos=\&quot;13:1-13:24\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-steps-to-reproduce\&quot; class=\&quot;anchor\&quot; href=\&quot;#steps-to-reproduce\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eSteps to reproduce\u003c/h4\u003e\u0026#x000A;\u003col data-sourcepos=\&quot;15:1-18:0\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;15:1-15:32\&quot;\u003eSign in to GitLab instance.\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;16:1-16:37\&quot;\u003eCreate a new \u003cstrong data-sourcepos=\&quot;16:17-16:26\&quot;\u003epublic\u003c/strong\u003e project.\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;17:1-18:0\&quot;\u003eClick the \&quot;\u003ccode data-sourcepos=\&quot;17:16-17:16\&quot;\u003e+\u003c/code\u003e\&quot; button on the top page of the created project and select \&quot;New file\&quot;.\u003c/li\u003e\u0026#x000A;\u003c/ol\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;19:1-19:128\&quot; dir=\&quot;auto\&quot;\u003e\u003ca class=\&quot;no-attachment-icon\&quot; href=\&quot;https://user-content.gitlab-static.net/5c9058428549e2ab13c147c4585cfe0b925c8f68/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f63376165376236352d323035302d343331342d383930362d3634356361333139656632662f706c75735f6e65775f66696c655f6f6e5f746f705f706167652e706e67\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/c7ae7b65-2050-4314-8906-645ca319ef2f/plus_new_file_on_top_page.png\&quot;\u003e\u003cimg data-sourcepos=\&quot;19:1-19:128\&quot; src=\&quot;data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\&quot; alt=\&quot;plus_new_file_on_top_page.png\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/c7ae7b65-2050-4314-8906-645ca319ef2f/plus_new_file_on_top_page.png\&quot; decoding=\&quot;async\&quot; class=\&quot;lazy\&quot; data-src=\&quot;https://user-content.gitlab-static.net/5c9058428549e2ab13c147c4585cfe0b925c8f68/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f63376165376236352d323035302d343331342d383930362d3634356361333139656632662f706c75735f6e65775f66696c655f6f6e5f746f705f706167652e706e67\&quot;\u003e\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003col data-sourcepos=\&quot;21:1-22:0\&quot; start=\&quot;4\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;21:1-22:0\&quot;\u003eAdd and commit the file with the following contents to the repository in the created project.\u003c/li\u003e\u0026#x000A;\u003c/ol\u003e\u0026#x000A;\u003cul data-sourcepos=\&quot;23:1-26:0\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;23:1-23:25\&quot;\u003eFile name: \u003ccode data-sourcepos=\&quot;23:15-23:22\&quot;\u003enew_file\u003c/code\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;24:1-24:109\&quot;\u003eCommit message: Copy and paste the contents of the attached file \u003cstrong data-sourcepos=\&quot;24:68-24:106\&quot;\u003e\&quot;commit_trailers_ReDoS_payload.txt\&quot;\u003c/strong\u003e.\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;25:1-26:0\&quot;\u003eTarget Branch: \u003ccode data-sourcepos=\&quot;25:19-25:23\&quot;\u003eredos\u003c/code\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003c/ul\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;27:1-27:124\&quot; dir=\&quot;auto\&quot;\u003e\u003ca class=\&quot;no-attachment-icon\&quot; href=\&quot;https://user-content.gitlab-static.net/2bd72d4a5d1304e04c820455aaf8ce8da3a9ebfa/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f36636161383637312d366565652d343737362d393265622d6538633834356337356630302f6164645f616e645f636f6d6d69745f6e65775f66696c652e706e67\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/6caa8671-6eee-4776-92eb-e8c845c75f00/add_and_commit_new_file.png\&quot;\u003e\u003cimg data-sourcepos=\&quot;27:1-27:124\&quot; src=\&quot;data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\&quot; alt=\&quot;add_and_commit_new_file.png\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/6caa8671-6eee-4776-92eb-e8c845c75f00/add_and_commit_new_file.png\&quot; decoding=\&quot;async\&quot; class=\&quot;lazy\&quot; data-src=\&quot;https://user-content.gitlab-static.net/2bd72d4a5d1304e04c820455aaf8ce8da3a9ebfa/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f36636161383637312d366565652d343737362d393265622d6538633834356337356630302f6164645f616e645f636f6d6d69745f6e65775f66696c652e706e67\&quot;\u003e\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;29:1-29:181\&quot; dir=\&quot;auto\&quot;\u003e\u003cem data-sourcepos=\&quot;29:1-29:181\&quot;\u003eNOTE: The important input items for reproducing the bug are \u003cstrong data-sourcepos=\&quot;29:62-29:109\&quot;\u003ethe \&quot;Commit message\&quot; and the \&quot;Target Branch\&quot;\u003c/strong\u003e. You can set the \&quot;File name\&quot; and the contents of the file as you like.\u003c/em\u003e\u003c/p\u003e\u0026#x000A;\u003col data-sourcepos=\&quot;31:1-32:0\&quot; start=\&quot;5\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;31:1-32:0\&quot;\u003eAfter you commit the file, confirm the CPU usage of the server hosting the instance rise to 100%.\u003c/li\u003e\u0026#x000A;\u003c/ol\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;33:1-33:120\&quot; dir=\&quot;auto\&quot;\u003e\u003ca class=\&quot;no-attachment-icon\&quot; href=\&quot;https://user-content.gitlab-static.net/ee49c590302022c9ae16d68b4105b7d8c821da78/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f65643362346566322d656336662d346435302d383734302d3738616465656336633531642f68746f705f315f636f72655f6578686175737465642e706e67\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/ed3b4ef2-ec6f-4d50-8740-78adeec6c51d/htop_1_core_exhausted.png\&quot;\u003e\u003cimg data-sourcepos=\&quot;33:1-33:120\&quot; src=\&quot;data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\&quot; alt=\&quot;htop_1_core_exhausted.png\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/ed3b4ef2-ec6f-4d50-8740-78adeec6c51d/htop_1_core_exhausted.png\&quot; decoding=\&quot;async\&quot; class=\&quot;lazy\&quot; data-src=\&quot;https://user-content.gitlab-static.net/ee49c590302022c9ae16d68b4105b7d8c821da78/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f65643362346566322d656336662d346435302d383734302d3738616465656336633531642f68746f705f315f636f72655f6578686175737465642e706e67\&quot;\u003e\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;35:1-35:322\&quot; dir=\&quot;auto\&quot;\u003e\u003cem data-sourcepos=\&quot;35:1-35:322\&quot;\u003eNOTE: For each 1 request that triggers the ReDoS, the usage of 1 CPU core rises to 100% until 60 seconds timeout. Though it looks like a slightly unsatisfactory load, it is a sufficient load for 1 request. In the first place, similar ReDoS vulnerabilities on GitLab in the past can only give the same load per 1 request.\u003c/em\u003e\u003c/p\u003e\u0026#x000A;\u003col data-sourcepos=\&quot;37:1-39:0\&quot; start=\&quot;6\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;37:1-37:142\&quot;\u003eAfter confirming for 500 or 502 error, go back to the project top page and go to the \&quot;Repository \u0026gt; Commits\&quot; page from the left side menu.\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;38:1-39:0\&quot;\u003eSelect \u003ccode data-sourcepos=\&quot;38:12-38:16\&quot;\u003eredos\u003c/code\u003e from the \&quot;Switch branch/tag\&quot; drop-down menu to confirm that the \u003ccode data-sourcepos=\&quot;38:84-38:88\&quot;\u003eredos\u003c/code\u003e branch you created works as the stored ReDoS.\u003c/li\u003e\u0026#x000A;\u003c/ol\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;40:1-40:136\&quot; dir=\&quot;auto\&quot;\u003e\u003ca class=\&quot;no-attachment-icon\&quot; href=\&quot;https://user-content.gitlab-static.net/4a2e1630f3c947f5c2cd0e4b390149ee14bcca56/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f32336162383234392d623861622d343665312d623230372d3337373064356464343336342f73656c6563745f6272616e63685f6f6e5f636f6d6d6974735f706167652e706e67\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/23ab8249-b8ab-46e1-b207-3770d5dd4364/select_branch_on_commits_page.png\&quot;\u003e\u003cimg data-sourcepos=\&quot;40:1-40:136\&quot; src=\&quot;data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\&quot; alt=\&quot;select_branch_on_commits_page.png\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/23ab8249-b8ab-46e1-b207-3770d5dd4364/select_branch_on_commits_page.png\&quot; decoding=\&quot;async\&quot; class=\&quot;lazy\&quot; data-src=\&quot;https://user-content.gitlab-static.net/4a2e1630f3c947f5c2cd0e4b390149ee14bcca56/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f32336162383234392d623861622d343665312d623230372d3337373064356464343336342f73656c6563745f6272616e63685f6f6e5f636f6d6d6974735f706167652e706e67\&quot;\u003e\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003col data-sourcepos=\&quot;42:1-43:0\&quot; start=\&quot;8\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;42:1-43:0\&quot;\u003eAfter confirming for 500 or 502 error, make a note of \u003ccode data-sourcepos=\&quot;42:59-42:76\&quot;\u003e[STORED_REDOS_URL]\u003c/code\u003e from the address bar of browser.\u003c/li\u003e\u0026#x000A;\u003c/ol\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;44:1-44:120\&quot; dir=\&quot;auto\&quot;\u003e\u003ca class=\&quot;no-attachment-icon\&quot; href=\&quot;https://user-content.gitlab-static.net/be0b69f044754e72158b7e97a5fa7e80ffe851c7/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f62346337653535372d663832372d346637392d626263622d3466383032653838353433312f6572726f725f6f6e5f7265646f735f6272616e63682e706e67\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/b4c7e557-f827-4f79-bbcb-4f802e885431/error_on_redos_branch.png\&quot;\u003e\u003cimg data-sourcepos=\&quot;44:1-44:120\&quot; src=\&quot;data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\&quot; alt=\&quot;error_on_redos_branch.png\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/b4c7e557-f827-4f79-bbcb-4f802e885431/error_on_redos_branch.png\&quot; decoding=\&quot;async\&quot; class=\&quot;lazy\&quot; data-src=\&quot;https://user-content.gitlab-static.net/be0b69f044754e72158b7e97a5fa7e80ffe851c7/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f62346337653535372d663832372d346637392d626263622d3466383032653838353433312f6572726f725f6f6e5f7265646f735f6272616e63682e706e67\&quot;\u003e\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003col data-sourcepos=\&quot;46:1-49:69\&quot; start=\&quot;9\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;46:1-47:0\&quot;\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;46:4-46:100\&quot;\u003eGo back to the top page of the project again and go to the \&quot;Issues\&quot; page from the left side menu.\u003c/p\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;48:1-49:69\&quot;\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;48:5-49:69\&quot;\u003ePrepare the description of new issue by replacing the string below.\u003cbr data-sourcepos=\&quot;48:74-48:74\&quot;\u003e\u0026#x000A;Replace \u003ccode data-sourcepos=\&quot;49:14-49:31\&quot;\u003e[STORED_REDOS_URL]\u003c/code\u003e with the values you got in \u003cstrong data-sourcepos=\&quot;49:61-49:70\&quot;\u003estep 8\u003c/strong\u003e.\u003c/p\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003c/ol\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;50:1-52:5\&quot; class=\&quot;code highlight js-syntax-highlight language-plaintext\&quot; lang=\&quot;plaintext\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u0026lt;img src=\&quot;[STORED_REDOS_URL]\&quot;\u0026gt;  \u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;53:1-53:58\&quot; dir=\&quot;auto\&quot;\u003eAfter replacing, create a new issue with this description.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;55:1-55:110\&quot; dir=\&quot;auto\&quot;\u003e\u003ca class=\&quot;no-attachment-icon\&quot; href=\&quot;https://user-content.gitlab-static.net/ca0392469c9b900e3124ae38dd740fe268d1a530/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f65633033663938332d666565632d346364662d393961342d6566313439653430323862382f6372656174655f6e65775f69737375652e706e67\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/ec03f983-feec-4cdf-99a4-ef149e4028b8/create_new_issue.png\&quot;\u003e\u003cimg data-sourcepos=\&quot;55:1-55:110\&quot; src=\&quot;data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\&quot; alt=\&quot;create_new_issue.png\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/ec03f983-feec-4cdf-99a4-ef149e4028b8/create_new_issue.png\&quot; decoding=\&quot;async\&quot; class=\&quot;lazy\&quot; data-src=\&quot;https://user-content.gitlab-static.net/ca0392469c9b900e3124ae38dd740fe268d1a530/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f65633033663938332d666565632d346364662d393961342d6566313439653430323862382f6372656174655f6e65775f69737375652e706e67\&quot;\u003e\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003col data-sourcepos=\&quot;57:1-62:0\&quot; start=\&quot;11\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;57:1-59:0\&quot;\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;57:5-58:152\&quot;\u003eConfirm that the new issue you created also works as CSRF to stored ReDoS.\u003cbr data-sourcepos=\&quot;57:81-57:81\&quot;\u003e\u0026#x000A;The use of \&quot;Issue\&quot; feature is just one example, and \u003cstrong data-sourcepos=\&quot;58:57-58:97\&quot;\u003ethis CSRF works in any markdown field\u003c/strong\u003e in your GitLab instance or \u003cstrong data-sourcepos=\&quot;58:126-58:155\&quot;\u003ein other external websites\u003c/strong\u003e.\u003c/p\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;60:1-62:0\&quot;\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;60:5-61:70\&quot;\u003eEach time a \u003ccode data-sourcepos=\&quot;60:18-60:20\&quot;\u003eGET\u003c/code\u003e request is sent to the endpoint created in step 8, the CPU resources of the server are wasted significantly.\u003cbr data-sourcepos=\&quot;60:133-60:133\&quot;\u003e\u0026#x000A;If you send two requests, the usage of the two CPU cores will be 100%.\u003c/p\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003c/ol\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;63:1-63:122\&quot; dir=\&quot;auto\&quot;\u003e\u003ca class=\&quot;no-attachment-icon\&quot; href=\&quot;https://user-content.gitlab-static.net/0507752263a6f43637f73205ef61cfbaa48d93e5/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f33643066346533622d313337642d343834312d623137642d6139633139353031363636322f68746f705f325f636f7265735f6578686175737465642e706e67\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/3d0f4e3b-137d-4841-b17d-a9c195016662/htop_2_cores_exhausted.png\&quot;\u003e\u003cimg data-sourcepos=\&quot;63:1-63:122\&quot; src=\&quot;data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\&quot; alt=\&quot;htop_2_cores_exhausted.png\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/3d0f4e3b-137d-4841-b17d-a9c195016662/htop_2_cores_exhausted.png\&quot; decoding=\&quot;async\&quot; class=\&quot;lazy\&quot; data-src=\&quot;https://user-content.gitlab-static.net/0507752263a6f43637f73205ef61cfbaa48d93e5/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f33643066346533622d313337642d343834312d623137642d6139633139353031363636322f68746f705f325f636f7265735f6578686175737465642e706e67\&quot;\u003e\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;65:1-65:97\&quot; dir=\&quot;auto\&quot;\u003eThe GitLab instance can easily be taken down with repeated requests about once every few seconds.\u003c/p\u003e\u0026#x000A;\u003ch4 data-sourcepos=\&quot;68:1-68:39\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-what-is-the-current-bug-behavior\&quot; class=\&quot;anchor\&quot; href=\&quot;#what-is-the-current-bug-behavior\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eWhat is the current bug behavior?\u003c/h4\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;70:1-70:43\&quot; dir=\&quot;auto\&quot;\u003eThe vulnerable code location is as follows.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;72:1-72:107\&quot; dir=\&quot;auto\&quot;\u003e\u003ca href=\&quot;https://gitlab.com/gitlab-org/gitlab/-/blob/v15.0.0-ee/lib/banzai/filter/commit_trailers_filter.rb#L20-27\&quot;\u003ehttps://gitlab.com/gitlab-org/gitlab/-/blob/v15.0.0-ee/lib/banzai/filter/commit_trailers_filter.rb#L20-27\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;73:1-82:3\&quot; data-canonical-lang=\&quot;ruby\&quot; class=\&quot;code highlight js-syntax-highlight language-ruby\&quot; lang=\&quot;ruby\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;ruby\&quot;\u003e      \u003cspan class=\&quot;no\&quot;\u003eTRAILER_REGEXP\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;sr\&quot;\u003e/(?\u0026lt;label\u0026gt;[[:alpha:]-]+-by:)/i\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nf\&quot;\u003efreeze\u003c/span\u003e  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;ruby\&quot;\u003e      \u003cspan class=\&quot;no\&quot;\u003eAUTHOR_REGEXP\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;sr\&quot;\u003e/(?\u0026lt;author_name\u0026gt;.+)/\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nf\&quot;\u003efreeze\u003c/span\u003e  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;ruby\&quot;\u003e      \u003cspan class=\&quot;c1\&quot;\u003e# Devise.email_regexp wouldn&#39;t work here since its designed to match  \u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;ruby\&quot;\u003e      \u003cspan class=\&quot;c1\&quot;\u003e# against strings that only contains email addresses; the \\A and \\z  \u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC5\&quot; class=\&quot;line\&quot; lang=\&quot;ruby\&quot;\u003e      \u003cspan class=\&quot;c1\&quot;\u003e# around the expression will only match if the string being matched  \u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC6\&quot; class=\&quot;line\&quot; lang=\&quot;ruby\&quot;\u003e      \u003cspan class=\&quot;c1\&quot;\u003e# contains just the email nothing else.  \u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC7\&quot; class=\&quot;line\&quot; lang=\&quot;ruby\&quot;\u003e      \u003cspan class=\&quot;no\&quot;\u003eMAIL_REGEXP\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;sr\&quot;\u003e/\u0026amp;lt;(?\u0026lt;author_email\u0026gt;[^@\\s]+@[^@\\s]+)\u0026amp;gt;/\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nf\&quot;\u003efreeze\u003c/span\u003e  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC8\&quot; class=\&quot;line\&quot; lang=\&quot;ruby\&quot;\u003e      \u003cspan class=\&quot;no\&quot;\u003eFILTER_REGEXP\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;sr\&quot;\u003e/(?\u0026lt;trailer\u0026gt;^\\s*\u003c/span\u003e\u003cspan class=\&quot;si\&quot;\u003e#{\u003c/span\u003e\u003cspan class=\&quot;no\&quot;\u003eTRAILER_REGEXP\u003c/span\u003e\u003cspan class=\&quot;si\&quot;\u003e}\u003c/span\u003e\u003cspan class=\&quot;sr\&quot;\u003e\\s*\u003c/span\u003e\u003cspan class=\&quot;si\&quot;\u003e#{\u003c/span\u003e\u003cspan class=\&quot;no\&quot;\u003eAUTHOR_REGEXP\u003c/span\u003e\u003cspan class=\&quot;si\&quot;\u003e}\u003c/span\u003e\u003cspan class=\&quot;sr\&quot;\u003e\\s+\u003c/span\u003e\u003cspan class=\&quot;si\&quot;\u003e#{\u003c/span\u003e\u003cspan class=\&quot;no\&quot;\u003eMAIL_REGEXP\u003c/span\u003e\u003cspan class=\&quot;si\&quot;\u003e}\u003c/span\u003e\u003cspan class=\&quot;sr\&quot;\u003e$)/mi\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nf\&quot;\u003efreeze\u003c/span\u003e  \u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;84:1-85:82\&quot; dir=\&quot;auto\&quot;\u003eThe matching \u003ccode data-sourcepos=\&quot;84:15-84:27\&quot;\u003eFILTER_REGEXP\u003c/code\u003e with the crafted string such as contents of \u003cstrong data-sourcepos=\&quot;84:74-84:112\&quot;\u003e\&quot;commit_trailers_ReDoS_payload.txt\&quot;\u003c/strong\u003e will cause catastrophic backtracking.\u003cbr data-sourcepos=\&quot;84:153-84:153\&quot;\u003e\u0026#x000A;The \u003ccode data-sourcepos=\&quot;85:6-85:18\&quot;\u003eAUTHOR_REGEXP\u003c/code\u003e and its surroundings make up the dangerous regex \u003ccode data-sourcepos=\&quot;85:71-85:80\&quot;\u003e\\s*(.+)\\s+\u003c/code\u003e.\u003c/p\u003e\u0026#x000A;\u003ch4 data-sourcepos=\&quot;87:1-87:44\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-what-is-the-expected-correct-behavior\&quot; class=\&quot;anchor\&quot; href=\&quot;#what-is-the-expected-correct-behavior\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eWhat is the expected correct behavior?\u003c/h4\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;89:1-89:81\&quot; dir=\&quot;auto\&quot;\u003eThe \u003ccode data-sourcepos=\&quot;89:6-89:18\&quot;\u003eFILTER_REGEXP\u003c/code\u003e should be fixed so as not to cause catastrophic backtracking.\u003c/p\u003e\u0026#x000A;\u003ch4 data-sourcepos=\&quot;91:1-91:40\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-relevant-logs-andor-screenshots\&quot; class=\&quot;anchor\&quot; href=\&quot;#relevant-logs-andor-screenshots\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eRelevant logs and/or screenshots\u003c/h4\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;92:1-92:77\&quot; dir=\&quot;auto\&quot;\u003eI put references to the screenshots at the appropriate places in this report.\u003c/p\u003e\u0026#x000A;\u003ch4 data-sourcepos=\&quot;94:1-94:24\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-output-of-checks\&quot; class=\&quot;anchor\&quot; href=\&quot;#output-of-checks\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eOutput of checks\u003c/h4\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;95:1-96:80\&quot; dir=\&quot;auto\&quot;\u003eThis bug happens on the official Docker installation of GitLab Enterprise Edition \u003ccode data-sourcepos=\&quot;95:84-95:92\&quot;\u003e15.0.0-ee\u003c/code\u003e.\u003cbr data-sourcepos=\&quot;95:97-95:97\&quot;\u003e\u0026#x000A;I used \u003ccode data-sourcepos=\&quot;96:9-96:20\&quot;\u003eChromium 101\u003c/code\u003e and \u003ccode data-sourcepos=\&quot;96:28-96:38\&quot;\u003eFirefox 100\u003c/code\u003e on Xubuntu 20.04 LTS to verify this bug.\u003c/p\u003e\u0026#x000A;\u003ch6 data-sourcepos=\&quot;98:1-98:44\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-results-of-gitlab-environment-info\&quot; class=\&quot;anchor\&quot; href=\&quot;#results-of-gitlab-environment-info\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eResults of GitLab environment info\u003c/h6\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;99:1-99:47\&quot; dir=\&quot;auto\&quot;\u003eOutput of \u003ccode data-sourcepos=\&quot;99:12-99:43\&quot;\u003esudo gitlab-rake gitlab:env:info\u003c/code\u003e:\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;100:1-134:3\&quot; class=\&quot;code highlight js-syntax-highlight language-plaintext\&quot; lang=\&quot;plaintext\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eSystem information  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eSystem:\t\t  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eProxy:\t\tno  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eCurrent User:\tgit  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC5\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eUsing RVM:\tno  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC6\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eRuby Version:\t2.7.5p203  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC7\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eGem Version:\t3.1.4  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC8\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eBundler Version:2.2.33  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC9\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eRake Version:\t13.0.6  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC10\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eRedis Version:\t6.2.6  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC11\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eSidekiq Version:6.4.0  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC12\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eGo Version:\tunknown\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC13\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC14\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eGitLab information  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC15\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eVersion:\t15.0.0-ee  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC16\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eRevision:\t3b397c17532  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC17\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eDirectory:\t/opt/gitlab/embedded/service/gitlab-rails  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC18\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eDB Adapter:\tPostgreSQL  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC19\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eDB Version:\t12.10  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC20\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eURL:\t\thttp://my-gitlab-h1.test  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC21\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eHTTP Clone URL:\thttp://my-gitlab-h1.test/some-group/some-project.git  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC22\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eSSH Clone URL:\tgit@my-gitlab-h1.test:some-group/some-project.git  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC23\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eElasticsearch:\tno  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC24\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eGeo:\t\tno  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC25\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eUsing LDAP:\tno  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC26\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eUsing Omniauth:\tyes  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC27\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eOmniauth Providers: \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC28\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC29\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eGitLab Shell  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC30\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eVersion:\t14.3.0  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC31\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eRepository storage paths:  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC32\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e- default: \t/var/opt/gitlab/git-data/repositories  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC33\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eGitLab Shell path:\t\t/opt/gitlab/embedded/service/gitlab-shell  \u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003ch4 data-sourcepos=\&quot;136:1-136:12\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-impact\&quot; class=\&quot;anchor\&quot; href=\&quot;#impact\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eImpact\u003c/h4\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;138:1-139:373\&quot; dir=\&quot;auto\&quot;\u003eThis Stored ReDoS can be retriggered by simply sending the \u003cstrong data-sourcepos=\&quot;138:60-138:93\&quot;\u003eunauthenticated \u003ccode data-sourcepos=\&quot;138:79-138:81\&quot;\u003eGET\u003c/code\u003e requests\u003c/strong\u003e.\u003cbr data-sourcepos=\&quot;138:97-138:97\&quot;\u003e\u0026#x000A;Since an attacker can exploit this to significantly impact the availability of the GitLab instance, the CVSS scores except Scope (\u003ccode data-sourcepos=\&quot;139:132-139:162\&quot;\u003eAV:N/AC:L/PR:L/UI:N/C:N/I:N/A:H\u003c/code\u003e) are the same as \u003ca data-sourcepos=\&quot;139:182-139:372\&quot; href=\&quot;https://about.gitlab.com/releases/2022/05/02/security-release-gitlab-14-10-1-released/#redos-on-ci-editor-and-ci-pipeline-detail-pages\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003ethe scores of the most recently ReDoS (CVE-2022-1510)\u003c/a\u003e.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;141:1-142:131\&quot; dir=\&quot;auto\&quot;\u003eIn addition, an attacker can use CSRF together to expand the attackable scope beyond the vulnerable endpoints.\u003cbr data-sourcepos=\&quot;141:113-141:113\&quot;\u003e\u0026#x000A;Scope is Changed (\u003ccode data-sourcepos=\&quot;142:20-142:22\&quot;\u003eS:C\u003c/code\u003e) because this CSRF allows to \u003cstrong data-sourcepos=\&quot;142:54-142:130\&quot;\u003etrigger the ReDoS from any Markdown field or from other external websites\u003c/strong\u003e.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;144:1-144:201\&quot; dir=\&quot;auto\&quot;\u003eWhen \u003ca data-sourcepos=\&quot;144:6-144:168\&quot; href=\&quot;https://gitlab-com.gitlab.io/gl-security/appsec/cvss-calculator/#vector=CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:N/I:N/A:H\u0026amp;range=new\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003ecalculated by combining the above\u003c/a\u003e, the CVSS score is as follows:\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;145:1-148:5\&quot; class=\&quot;code highlight js-syntax-highlight language-plaintext\&quot; lang=\&quot;plaintext\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eCVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:N/I:N/A:H  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e7.7 (High)  \u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;149:1-149:243\&quot; dir=\&quot;auto\&quot;\u003eThis CVSS score is same as \u003ca data-sourcepos=\&quot;149:28-149:174\&quot; href=\&quot;https://about.gitlab.com/releases/2021/09/30/security-release-gitlab-14-3-1-released/#denial-of-service-attack-in-markdown-parser\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003eCVE-2021-39877\u003c/a\u003e, which could be triggered by the \u003cstrong data-sourcepos=\&quot;149:209-149:242\&quot;\u003eunauthenticated \u003ccode data-sourcepos=\&quot;149:228-149:230\&quot;\u003eGET\u003c/code\u003e requests\u003c/strong\u003e.\u003c/p\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;151:1-151:14\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-attachments\&quot; class=\&quot;anchor\&quot; href=\&quot;#attachments\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eAttachments\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;153:1-153:77\&quot; dir=\&quot;auto\&quot;\u003e\u003cstrong data-sourcepos=\&quot;153:1-153:12\&quot;\u003eWarning:\u003c/strong\u003e Attachments received through HackerOne, please exercise caution!\u003c/p\u003e\u0026#x000A;\u003cul data-sourcepos=\&quot;155:1-163:0\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;155:1-155:137\&quot;\u003e\u003ca data-sourcepos=\&quot;155:3-155:137\&quot; href=\&quot;https://h1.sec.gitlab.net/a/67abeb50-0ccc-427f-9e06-417c56364a8f/commit_trailers_ReDoS_payload.txt\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003ecommit_trailers_ReDoS_payload.txt\u003c/a\u003e\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;156:1-156:129\&quot;\u003e\u003ca data-sourcepos=\&quot;156:3-156:129\&quot; href=\&quot;https://h1.sec.gitlab.net/a/c7ae7b65-2050-4314-8906-645ca319ef2f/plus_new_file_on_top_page.png\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003eplus_new_file_on_top_page.png\u003c/a\u003e\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;157:1-157:125\&quot;\u003e\u003ca data-sourcepos=\&quot;157:3-157:125\&quot; href=\&quot;https://h1.sec.gitlab.net/a/6caa8671-6eee-4776-92eb-e8c845c75f00/add_and_commit_new_file.png\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003eadd_and_commit_new_file.png\u003c/a\u003e\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;158:1-158:121\&quot;\u003e\u003ca data-sourcepos=\&quot;158:3-158:121\&quot; href=\&quot;https://h1.sec.gitlab.net/a/ed3b4ef2-ec6f-4d50-8740-78adeec6c51d/htop_1_core_exhausted.png\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003ehtop_1_core_exhausted.png\u003c/a\u003e\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;159:1-159:137\&quot;\u003e\u003ca data-sourcepos=\&quot;159:3-159:137\&quot; href=\&quot;https://h1.sec.gitlab.net/a/23ab8249-b8ab-46e1-b207-3770d5dd4364/select_branch_on_commits_page.png\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003eselect_branch_on_commits_page.png\u003c/a\u003e\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;160:1-160:121\&quot;\u003e\u003ca data-sourcepos=\&quot;160:3-160:121\&quot; href=\&quot;https://h1.sec.gitlab.net/a/b4c7e557-f827-4f79-bbcb-4f802e885431/error_on_redos_branch.png\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003eerror_on_redos_branch.png\u003c/a\u003e\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;161:1-161:111\&quot;\u003e\u003ca data-sourcepos=\&quot;161:3-161:111\&quot; href=\&quot;https://h1.sec.gitlab.net/a/ec03f983-feec-4cdf-99a4-ef149e4028b8/create_new_issue.png\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003ecreate_new_issue.png\u003c/a\u003e\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;162:1-163:0\&quot;\u003e\u003ca data-sourcepos=\&quot;162:3-162:123\&quot; href=\&quot;https://h1.sec.gitlab.net/a/3d0f4e3b-137d-4841-b17d-a9c195016662/htop_2_cores_exhausted.png\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003ehtop_2_cores_exhausted.png\u003c/a\u003e\u003c/li\u003e\u0026#x000A;\u003c/ul\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;164:1-164:19\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-how-to-reproduce\&quot; class=\&quot;anchor\&quot; href=\&quot;#how-to-reproduce\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eHow To Reproduce\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;166:1-166:57\&quot; dir=\&quot;auto\&quot;\u003ePlease add \u003ca data-sourcepos=\&quot;166:12-166:40\&quot; href=\&quot;https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003ereproducibility information\u003c/a\u003e to this section:\u003c/p\u003e\u0026#x000A;\u003col data-sourcepos=\&quot;168:1-171:0\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;168:1-168:2\&quot;\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;169:1-169:2\&quot;\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;170:1-170:2\&quot;\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003c/ol\u003e&quot;,&quot;initialDescriptionText&quot;:&quot;**[HackerOne report #1584156](https://hackerone.com/reports/1584156)** by `ryhmnlfj` on 2022-05-28, assigned to @cmaxim:\n\n[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)\n\n## Report\n\n####  Summary\n\nI found server-side ReDoS vulnerability on commit trailer.  \nThis ReDoS vulnerability can be persisted as **Stored ReDoS** that can be retriggered by requesting to GET endpoint(`/[PROJECT_NAMESPACE]/-/commits/[BRANCH_CONTAINING_REDOS]`).  \nNormally, CSRFs to GET endpoint do not pose a security risk, but **CSRF to Stored ReDoS** allows an attacker to expand the attackable scopes and force other users to attack the GitLab instance.\n\n####  Steps to reproduce\n\n1. Sign in to GitLab instance.  \n2. Create a new **public** project.  \n3. Click the \&quot;`+`\&quot; button on the top page of the created project and select \&quot;New file\&quot;.\n\n![plus_new_file_on_top_page.png](https://h1.sec.gitlab.net/a/c7ae7b65-2050-4314-8906-645ca319ef2f/plus_new_file_on_top_page.png)\n\n4. Add and commit the file with the following contents to the repository in the created project.\n\n* File name: `new_file`  \n* Commit message: Copy and paste the contents of the attached file **\&quot;commit_trailers_ReDoS_payload.txt\&quot;**.  \n* Target Branch: `redos`\n\n![add_and_commit_new_file.png](https://h1.sec.gitlab.net/a/6caa8671-6eee-4776-92eb-e8c845c75f00/add_and_commit_new_file.png)\n\n_NOTE: The important input items for reproducing the bug are **the \&quot;Commit message\&quot; and the \&quot;Target Branch\&quot;**. You can set the \&quot;File name\&quot; and the contents of the file as you like._\n\n5. After you commit the file, confirm the CPU usage of the server hosting the instance rise to 100%.\n\n![htop_1_core_exhausted.png](https://h1.sec.gitlab.net/a/ed3b4ef2-ec6f-4d50-8740-78adeec6c51d/htop_1_core_exhausted.png)\n\n_NOTE: For each 1 request that triggers the ReDoS, the usage of 1 CPU core rises to 100% until 60 seconds timeout. Though it looks like a slightly unsatisfactory load, it is a sufficient load for 1 request. In the first place, similar ReDoS vulnerabilities on GitLab in the past can only give the same load per 1 request._\n\n6. After confirming for 500 or 502 error, go back to the project top page and go to the \&quot;Repository \u003e Commits\&quot; page from the left side menu.  \n7. Select `redos` from the \&quot;Switch branch/tag\&quot; drop-down menu to confirm that the `redos` branch you created works as the stored ReDoS.\n\n![select_branch_on_commits_page.png](https://h1.sec.gitlab.net/a/23ab8249-b8ab-46e1-b207-3770d5dd4364/select_branch_on_commits_page.png)\n\n8. After confirming for 500 or 502 error, make a note of `[STORED_REDOS_URL]` from the address bar of browser.\n\n![error_on_redos_branch.png](https://h1.sec.gitlab.net/a/b4c7e557-f827-4f79-bbcb-4f802e885431/error_on_redos_branch.png)\n\n9. Go back to the top page of the project again and go to the \&quot;Issues\&quot; page from the left side menu.\n\n10. Prepare the description of new issue by replacing the string below.  \nReplace `[STORED_REDOS_URL]` with the values you got in **step 8**.  \n```  \n\u003cimg src=\&quot;[STORED_REDOS_URL]\&quot;\u003e  \n```  \nAfter replacing, create a new issue with this description.\n\n![create_new_issue.png](https://h1.sec.gitlab.net/a/ec03f983-feec-4cdf-99a4-ef149e4028b8/create_new_issue.png)\n\n11. Confirm that the new issue you created also works as CSRF to stored ReDoS.  \nThe use of \&quot;Issue\&quot; feature is just one example, and **this CSRF works in any markdown field** in your GitLab instance or **in other external websites**.\n\n12. Each time a `GET` request is sent to the endpoint created in step 8, the CPU resources of the server are wasted significantly.  \nIf you send two requests, the usage of the two CPU cores will be 100%.\n\n![htop_2_cores_exhausted.png](https://h1.sec.gitlab.net/a/3d0f4e3b-137d-4841-b17d-a9c195016662/htop_2_cores_exhausted.png)\n\nThe GitLab instance can easily be taken down with repeated requests about once every few seconds.\n\n\n####  What is the current bug behavior?\n\nThe vulnerable code location is as follows.\n\nhttps://gitlab.com/gitlab-org/gitlab/-/blob/v15.0.0-ee/lib/banzai/filter/commit_trailers_filter.rb#L20-27  \n```ruby  \n      TRAILER_REGEXP = /(?\u003clabel\u003e[[:alpha:]-]+-by:)/i.freeze  \n      AUTHOR_REGEXP = /(?\u003cauthor_name\u003e.+)/.freeze  \n      # Devise.email_regexp wouldn&#39;t work here since its designed to match  \n      # against strings that only contains email addresses; the \\A and \\z  \n      # around the expression will only match if the string being matched  \n      # contains just the email nothing else.  \n      MAIL_REGEXP = /\u0026lt;(?\u003cauthor_email\u003e[^@\\s]+@[^@\\s]+)\u0026gt;/.freeze  \n      FILTER_REGEXP = /(?\u003ctrailer\u003e^\\s*#{TRAILER_REGEXP}\\s*#{AUTHOR_REGEXP}\\s+#{MAIL_REGEXP}$)/mi.freeze  \n```\n\nThe matching `FILTER_REGEXP` with the crafted string such as contents of **\&quot;commit_trailers_ReDoS_payload.txt\&quot;** will cause catastrophic backtracking.  \nThe `AUTHOR_REGEXP` and its surroundings make up the dangerous regex `\\s*(.+)\\s+`.\n\n####  What is the expected correct behavior?\n\nThe `FILTER_REGEXP` should be fixed so as not to cause catastrophic backtracking.\n\n####  Relevant logs and/or screenshots  \nI put references to the screenshots at the appropriate places in this report.\n\n####  Output of checks  \nThis bug happens on the official Docker installation of GitLab Enterprise Edition `15.0.0-ee`.  \nI used `Chromium 101` and `Firefox 100` on Xubuntu 20.04 LTS to verify this bug.\n\n######  Results of GitLab environment info  \nOutput of `sudo gitlab-rake gitlab:env:info`:  \n```  \nSystem information  \nSystem:\t\t  \nProxy:\t\tno  \nCurrent User:\tgit  \nUsing RVM:\tno  \nRuby Version:\t2.7.5p203  \nGem Version:\t3.1.4  \nBundler Version:2.2.33  \nRake Version:\t13.0.6  \nRedis Version:\t6.2.6  \nSidekiq Version:6.4.0  \nGo Version:\tunknown\n\nGitLab information  \nVersion:\t15.0.0-ee  \nRevision:\t3b397c17532  \nDirectory:\t/opt/gitlab/embedded/service/gitlab-rails  \nDB Adapter:\tPostgreSQL  \nDB Version:\t12.10  \nURL:\t\thttp://my-gitlab-h1.test  \nHTTP Clone URL:\thttp://my-gitlab-h1.test/some-group/some-project.git  \nSSH Clone URL:\tgit@my-gitlab-h1.test:some-group/some-project.git  \nElasticsearch:\tno  \nGeo:\t\tno  \nUsing LDAP:\tno  \nUsing Omniauth:\tyes  \nOmniauth Providers: \n\nGitLab Shell  \nVersion:\t14.3.0  \nRepository storage paths:  \n- default: \t/var/opt/gitlab/git-data/repositories  \nGitLab Shell path:\t\t/opt/gitlab/embedded/service/gitlab-shell  \n```\n\n####  Impact\n\nThis Stored ReDoS can be retriggered by simply sending the **unauthenticated `GET` requests**.  \nSince an attacker can exploit this to significantly impact the availability of the GitLab instance, the CVSS scores except Scope (`AV:N/AC:L/PR:L/UI:N/C:N/I:N/A:H`) are the same as [the scores of the most recently ReDoS (CVE-2022-1510)](https://about.gitlab.com/releases/2022/05/02/security-release-gitlab-14-10-1-released/#redos-on-ci-editor-and-ci-pipeline-detail-pages).\n\nIn addition, an attacker can use CSRF together to expand the attackable scope beyond the vulnerable endpoints.  \nScope is Changed (`S:C`) because this CSRF allows to **trigger the ReDoS from any Markdown field or from other external websites**.\n\nWhen [calculated by combining the above](https://gitlab-com.gitlab.io/gl-security/appsec/cvss-calculator/#vector=CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:N/I:N/A:H\u0026range=new), the CVSS score is as follows:  \n```  \nCVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:N/I:N/A:H  \n7.7 (High)  \n```  \nThis CVSS score is same as [CVE-2021-39877](https://about.gitlab.com/releases/2021/09/30/security-release-gitlab-14-3-1-released/#denial-of-service-attack-in-markdown-parser), which could be triggered by the **unauthenticated `GET` requests**.\n\n## Attachments\n\n**Warning:** Attachments received through HackerOne, please exercise caution!\n\n* [commit_trailers_ReDoS_payload.txt](https://h1.sec.gitlab.net/a/67abeb50-0ccc-427f-9e06-417c56364a8f/commit_trailers_ReDoS_payload.txt)\n* [plus_new_file_on_top_page.png](https://h1.sec.gitlab.net/a/c7ae7b65-2050-4314-8906-645ca319ef2f/plus_new_file_on_top_page.png)\n* [add_and_commit_new_file.png](https://h1.sec.gitlab.net/a/6caa8671-6eee-4776-92eb-e8c845c75f00/add_and_commit_new_file.png)\n* [htop_1_core_exhausted.png](https://h1.sec.gitlab.net/a/ed3b4ef2-ec6f-4d50-8740-78adeec6c51d/htop_1_core_exhausted.png)\n* [select_branch_on_commits_page.png](https://h1.sec.gitlab.net/a/23ab8249-b8ab-46e1-b207-3770d5dd4364/select_branch_on_commits_page.png)\n* [error_on_redos_branch.png](https://h1.sec.gitlab.net/a/b4c7e557-f827-4f79-bbcb-4f802e885431/error_on_redos_branch.png)\n* [create_new_issue.png](https://h1.sec.gitlab.net/a/ec03f983-feec-4cdf-99a4-ef149e4028b8/create_new_issue.png)\n* [htop_2_cores_exhausted.png](https://h1.sec.gitlab.net/a/3d0f4e3b-137d-4841-b17d-a9c195016662/htop_2_cores_exhausted.png)\n\n## How To Reproduce\n\nPlease add [reproducibility information] to this section:\n\n1.\n1.\n1.\n\n[reproducibility information]: https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues&quot;,&quot;initialTaskCompletionStatus&quot;:{&quot;count&quot;:0,&quot;completed_count&quot;:0},&quot;canCreateIncident&quot;:false,&quot;fullPath&quot;:&quot;gitlab-org/gitlab&quot;,&quot;iid&quot;:363734,&quot;issuableId&quot;:109299332,&quot;issueType&quot;:&quot;issue&quot;,&quot;isHidden&quot;:false,&quot;zoomMeetingUrl&quot;:null,&quot;authorId&quot;:2741139,&quot;authorName&quot;:&quot;GitLab SecurityBot&quot;,&quot;authorUsername&quot;:&quot;gitlab-securitybot&quot;,&quot;authorWebUrl&quot;:&quot;/gitlab-securitybot&quot;,&quot;createdAt&quot;:&quot;2022-05-30T09:08:02+00:00&quot;,&quot;isFirstContribution&quot;:false,&quot;serviceDeskReplyTo&quot;:null,&quot;registerPath&quot;:&quot;/users/sign_up?redirect_to_referer=yes&quot;,&quot;signInPath&quot;:&quot;/users/sign_in?redirect_to_referer=yes&quot;,&quot;publishedIncidentUrl&quot;:null,&quot;slaFeatureAvailable&quot;:&quot;false&quot;,&quot;uploadMetricsFeatureAvailable&quot;:&quot;false&quot;,&quot;projectId&quot;:278964,&quot;projectPath&quot;:&quot;gitlab&quot;,&quot;projectNamespace&quot;:&quot;gitlab-org&quot;,&quot;canAdmin&quot;:false,&quot;hasIssueWeightsFeature&quot;:true,&quot;hasIterationsFeature&quot;:true,&quot;canAdminRelation&quot;:false}" id="js-issuable-app">
<div class="title-container">
<h1 class="gl-heading-1 !gl-m-0">Regex backtracking vulnerability with `commit_trailers_filter.rb` allows an attacker to exploit ReDoS through the `Commit message` field</h1>
</div>
<div class="description">
<div class="md"><p data-sourcepos="1:1-1:120" dir="auto"><strong data-sourcepos="1:1-1:70"><a data-sourcepos="1:3-1:68" href="https://hackerone.com/reports/1584156" rel="nofollow noreferrer noopener" target="_blank">HackerOne report #1584156</a></strong> by <code data-sourcepos="1:76-1:83">ryhmnlfj</code> on 2022-05-28, assigned to <a href="/cmaxim" data-reference-type="user" data-user="4086191" data-container="body" data-placement="top" class="gfm gfm-project_member js-user-link" title="Costel Maxim">@cmaxim</a>:</p>&#x000A;<p data-sourcepos="3:1-3:87" dir="auto"><a data-sourcepos="3:1-3:17" href="#report">Report</a> | <a data-sourcepos="3:21-3:47" href="#attachments">Attachments</a> | <a data-sourcepos="3:51-3:87" href="#how-to-reproduce">How To Reproduce</a></p>&#x000A;<h2 data-sourcepos="5:1-5:9" dir="auto">&#x000A;<a id="user-content-report" class="anchor" href="#report" aria-hidden="true"></a>Report</h2>&#x000A;<h4 data-sourcepos="7:1-7:13" dir="auto">&#x000A;<a id="user-content-summary" class="anchor" href="#summary" aria-hidden="true"></a>Summary</h4>&#x000A;<p data-sourcepos="9:1-11:193" dir="auto">I found server-side ReDoS vulnerability on commit trailer.<br data-sourcepos="9:61-9:61">&#x000A;This ReDoS vulnerability can be persisted as <strong data-sourcepos="10:46-10:61">Stored ReDoS</strong> that can be retriggered by requesting to GET endpoint(<code data-sourcepos="10:118-10:173">/[PROJECT_NAMESPACE]/-/commits/[BRANCH_CONTAINING_REDOS]</code>).<br data-sourcepos="10:179-10:179">&#x000A;Normally, CSRFs to GET endpoint do not pose a security risk, but <strong data-sourcepos="11:66-11:89">CSRF to Stored ReDoS</strong> allows an attacker to expand the attackable scopes and force other users to attack the GitLab instance.</p>&#x000A;<h4 data-sourcepos="13:1-13:24" dir="auto">&#x000A;<a id="user-content-steps-to-reproduce" class="anchor" href="#steps-to-reproduce" aria-hidden="true"></a>Steps to reproduce</h4>&#x000A;<ol data-sourcepos="15:1-18:0" dir="auto">&#x000A;<li data-sourcepos="15:1-15:32">Sign in to GitLab instance.</li>&#x000A;<li data-sourcepos="16:1-16:37">Create a new <strong data-sourcepos="16:17-16:26">public</strong> project.</li>&#x000A;<li data-sourcepos="17:1-18:0">Click the "<code data-sourcepos="17:16-17:16">+</code>" button on the top page of the created project and select "New file".</li>&#x000A;</ol>&#x000A;<p data-sourcepos="19:1-19:128" dir="auto"><a class="no-attachment-icon" href="https://user-content.gitlab-static.net/5c9058428549e2ab13c147c4585cfe0b925c8f68/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f63376165376236352d323035302d343331342d383930362d3634356361333139656632662f706c75735f6e65775f66696c655f6f6e5f746f705f706167652e706e67" target="_blank" rel="nofollow noreferrer noopener" data-canonical-src="https://h1.sec.gitlab.net/a/c7ae7b65-2050-4314-8906-645ca319ef2f/plus_new_file_on_top_page.png"><img data-sourcepos="19:1-19:128" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="plus_new_file_on_top_page.png" data-canonical-src="https://h1.sec.gitlab.net/a/c7ae7b65-2050-4314-8906-645ca319ef2f/plus_new_file_on_top_page.png" decoding="async" class="lazy" data-src="https://user-content.gitlab-static.net/5c9058428549e2ab13c147c4585cfe0b925c8f68/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f63376165376236352d323035302d343331342d383930362d3634356361333139656632662f706c75735f6e65775f66696c655f6f6e5f746f705f706167652e706e67"></a></p>&#x000A;<ol data-sourcepos="21:1-22:0" start="4" dir="auto">&#x000A;<li data-sourcepos="21:1-22:0">Add and commit the file with the following contents to the repository in the created project.</li>&#x000A;</ol>&#x000A;<ul data-sourcepos="23:1-26:0" dir="auto">&#x000A;<li data-sourcepos="23:1-23:25">File name: <code data-sourcepos="23:15-23:22">new_file</code>&#x000A;</li>&#x000A;<li data-sourcepos="24:1-24:109">Commit message: Copy and paste the contents of the attached file <strong data-sourcepos="24:68-24:106">"commit_trailers_ReDoS_payload.txt"</strong>.</li>&#x000A;<li data-sourcepos="25:1-26:0">Target Branch: <code data-sourcepos="25:19-25:23">redos</code>&#x000A;</li>&#x000A;</ul>&#x000A;<p data-sourcepos="27:1-27:124" dir="auto"><a class="no-attachment-icon" href="https://user-content.gitlab-static.net/2bd72d4a5d1304e04c820455aaf8ce8da3a9ebfa/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f36636161383637312d366565652d343737362d393265622d6538633834356337356630302f6164645f616e645f636f6d6d69745f6e65775f66696c652e706e67" target="_blank" rel="nofollow noreferrer noopener" data-canonical-src="https://h1.sec.gitlab.net/a/6caa8671-6eee-4776-92eb-e8c845c75f00/add_and_commit_new_file.png"><img data-sourcepos="27:1-27:124" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="add_and_commit_new_file.png" data-canonical-src="https://h1.sec.gitlab.net/a/6caa8671-6eee-4776-92eb-e8c845c75f00/add_and_commit_new_file.png" decoding="async" class="lazy" data-src="https://user-content.gitlab-static.net/2bd72d4a5d1304e04c820455aaf8ce8da3a9ebfa/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f36636161383637312d366565652d343737362d393265622d6538633834356337356630302f6164645f616e645f636f6d6d69745f6e65775f66696c652e706e67"></a></p>&#x000A;<p data-sourcepos="29:1-29:181" dir="auto"><em data-sourcepos="29:1-29:181">NOTE: The important input items for reproducing the bug are <strong data-sourcepos="29:62-29:109">the "Commit message" and the "Target Branch"</strong>. You can set the "File name" and the contents of the file as you like.</em></p>&#x000A;<ol data-sourcepos="31:1-32:0" start="5" dir="auto">&#x000A;<li data-sourcepos="31:1-32:0">After you commit the file, confirm the CPU usage of the server hosting the instance rise to 100%.</li>&#x000A;</ol>&#x000A;<p data-sourcepos="33:1-33:120" dir="auto"><a class="no-attachment-icon" href="https://user-content.gitlab-static.net/ee49c590302022c9ae16d68b4105b7d8c821da78/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f65643362346566322d656336662d346435302d383734302d3738616465656336633531642f68746f705f315f636f72655f6578686175737465642e706e67" target="_blank" rel="nofollow noreferrer noopener" data-canonical-src="https://h1.sec.gitlab.net/a/ed3b4ef2-ec6f-4d50-8740-78adeec6c51d/htop_1_core_exhausted.png"><img data-sourcepos="33:1-33:120" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="htop_1_core_exhausted.png" data-canonical-src="https://h1.sec.gitlab.net/a/ed3b4ef2-ec6f-4d50-8740-78adeec6c51d/htop_1_core_exhausted.png" decoding="async" class="lazy" data-src="https://user-content.gitlab-static.net/ee49c590302022c9ae16d68b4105b7d8c821da78/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f65643362346566322d656336662d346435302d383734302d3738616465656336633531642f68746f705f315f636f72655f6578686175737465642e706e67"></a></p>&#x000A;<p data-sourcepos="35:1-35:322" dir="auto"><em data-sourcepos="35:1-35:322">NOTE: For each 1 request that triggers the ReDoS, the usage of 1 CPU core rises to 100% until 60 seconds timeout. Though it looks like a slightly unsatisfactory load, it is a sufficient load for 1 request. In the first place, similar ReDoS vulnerabilities on GitLab in the past can only give the same load per 1 request.</em></p>&#x000A;<ol data-sourcepos="37:1-39:0" start="6" dir="auto">&#x000A;<li data-sourcepos="37:1-37:142">After confirming for 500 or 502 error, go back to the project top page and go to the "Repository &gt; Commits" page from the left side menu.</li>&#x000A;<li data-sourcepos="38:1-39:0">Select <code data-sourcepos="38:12-38:16">redos</code> from the "Switch branch/tag" drop-down menu to confirm that the <code data-sourcepos="38:84-38:88">redos</code> branch you created works as the stored ReDoS.</li>&#x000A;</ol>&#x000A;<p data-sourcepos="40:1-40:136" dir="auto"><a class="no-attachment-icon" href="https://user-content.gitlab-static.net/4a2e1630f3c947f5c2cd0e4b390149ee14bcca56/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f32336162383234392d623861622d343665312d623230372d3337373064356464343336342f73656c6563745f6272616e63685f6f6e5f636f6d6d6974735f706167652e706e67" target="_blank" rel="nofollow noreferrer noopener" data-canonical-src="https://h1.sec.gitlab.net/a/23ab8249-b8ab-46e1-b207-3770d5dd4364/select_branch_on_commits_page.png"><img data-sourcepos="40:1-40:136" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="select_branch_on_commits_page.png" data-canonical-src="https://h1.sec.gitlab.net/a/23ab8249-b8ab-46e1-b207-3770d5dd4364/select_branch_on_commits_page.png" decoding="async" class="lazy" data-src="https://user-content.gitlab-static.net/4a2e1630f3c947f5c2cd0e4b390149ee14bcca56/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f32336162383234392d623861622d343665312d623230372d3337373064356464343336342f73656c6563745f6272616e63685f6f6e5f636f6d6d6974735f706167652e706e67"></a></p>&#x000A;<ol data-sourcepos="42:1-43:0" start="8" dir="auto">&#x000A;<li data-sourcepos="42:1-43:0">After confirming for 500 or 502 error, make a note of <code data-sourcepos="42:59-42:76">[STORED_REDOS_URL]</code> from the address bar of browser.</li>&#x000A;</ol>&#x000A;<p data-sourcepos="44:1-44:120" dir="auto"><a class="no-attachment-icon" href="https://user-content.gitlab-static.net/be0b69f044754e72158b7e97a5fa7e80ffe851c7/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f62346337653535372d663832372d346637392d626263622d3466383032653838353433312f6572726f725f6f6e5f7265646f735f6272616e63682e706e67" target="_blank" rel="nofollow noreferrer noopener" data-canonical-src="https://h1.sec.gitlab.net/a/b4c7e557-f827-4f79-bbcb-4f802e885431/error_on_redos_branch.png"><img data-sourcepos="44:1-44:120" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="error_on_redos_branch.png" data-canonical-src="https://h1.sec.gitlab.net/a/b4c7e557-f827-4f79-bbcb-4f802e885431/error_on_redos_branch.png" decoding="async" class="lazy" data-src="https://user-content.gitlab-static.net/be0b69f044754e72158b7e97a5fa7e80ffe851c7/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f62346337653535372d663832372d346637392d626263622d3466383032653838353433312f6572726f725f6f6e5f7265646f735f6272616e63682e706e67"></a></p>&#x000A;<ol data-sourcepos="46:1-49:69" start="9" dir="auto">&#x000A;<li data-sourcepos="46:1-47:0">&#x000A;<p data-sourcepos="46:4-46:100">Go back to the top page of the project again and go to the "Issues" page from the left side menu.</p>&#x000A;</li>&#x000A;<li data-sourcepos="48:1-49:69">&#x000A;<p data-sourcepos="48:5-49:69">Prepare the description of new issue by replacing the string below.<br data-sourcepos="48:74-48:74">&#x000A;Replace <code data-sourcepos="49:14-49:31">[STORED_REDOS_URL]</code> with the values you got in <strong data-sourcepos="49:61-49:70">step 8</strong>.</p>&#x000A;</li>&#x000A;</ol>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="50:1-52:5" class="code highlight js-syntax-highlight language-plaintext" lang="plaintext" v-pre="true"><code><span id="LC1" class="line" lang="plaintext">&lt;img src="[STORED_REDOS_URL]"&gt;  </span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<p data-sourcepos="53:1-53:58" dir="auto">After replacing, create a new issue with this description.</p>&#x000A;<p data-sourcepos="55:1-55:110" dir="auto"><a class="no-attachment-icon" href="https://user-content.gitlab-static.net/ca0392469c9b900e3124ae38dd740fe268d1a530/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f65633033663938332d666565632d346364662d393961342d6566313439653430323862382f6372656174655f6e65775f69737375652e706e67" target="_blank" rel="nofollow noreferrer noopener" data-canonical-src="https://h1.sec.gitlab.net/a/ec03f983-feec-4cdf-99a4-ef149e4028b8/create_new_issue.png"><img data-sourcepos="55:1-55:110" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="create_new_issue.png" data-canonical-src="https://h1.sec.gitlab.net/a/ec03f983-feec-4cdf-99a4-ef149e4028b8/create_new_issue.png" decoding="async" class="lazy" data-src="https://user-content.gitlab-static.net/ca0392469c9b900e3124ae38dd740fe268d1a530/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f65633033663938332d666565632d346364662d393961342d6566313439653430323862382f6372656174655f6e65775f69737375652e706e67"></a></p>&#x000A;<ol data-sourcepos="57:1-62:0" start="11" dir="auto">&#x000A;<li data-sourcepos="57:1-59:0">&#x000A;<p data-sourcepos="57:5-58:152">Confirm that the new issue you created also works as CSRF to stored ReDoS.<br data-sourcepos="57:81-57:81">&#x000A;The use of "Issue" feature is just one example, and <strong data-sourcepos="58:57-58:97">this CSRF works in any markdown field</strong> in your GitLab instance or <strong data-sourcepos="58:126-58:155">in other external websites</strong>.</p>&#x000A;</li>&#x000A;<li data-sourcepos="60:1-62:0">&#x000A;<p data-sourcepos="60:5-61:70">Each time a <code data-sourcepos="60:18-60:20">GET</code> request is sent to the endpoint created in step 8, the CPU resources of the server are wasted significantly.<br data-sourcepos="60:133-60:133">&#x000A;If you send two requests, the usage of the two CPU cores will be 100%.</p>&#x000A;</li>&#x000A;</ol>&#x000A;<p data-sourcepos="63:1-63:122" dir="auto"><a class="no-attachment-icon" href="https://user-content.gitlab-static.net/0507752263a6f43637f73205ef61cfbaa48d93e5/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f33643066346533622d313337642d343834312d623137642d6139633139353031363636322f68746f705f325f636f7265735f6578686175737465642e706e67" target="_blank" rel="nofollow noreferrer noopener" data-canonical-src="https://h1.sec.gitlab.net/a/3d0f4e3b-137d-4841-b17d-a9c195016662/htop_2_cores_exhausted.png"><img data-sourcepos="63:1-63:122" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="htop_2_cores_exhausted.png" data-canonical-src="https://h1.sec.gitlab.net/a/3d0f4e3b-137d-4841-b17d-a9c195016662/htop_2_cores_exhausted.png" decoding="async" class="lazy" data-src="https://user-content.gitlab-static.net/0507752263a6f43637f73205ef61cfbaa48d93e5/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f33643066346533622d313337642d343834312d623137642d6139633139353031363636322f68746f705f325f636f7265735f6578686175737465642e706e67"></a></p>&#x000A;<p data-sourcepos="65:1-65:97" dir="auto">The GitLab instance can easily be taken down with repeated requests about once every few seconds.</p>&#x000A;<h4 data-sourcepos="68:1-68:39" dir="auto">&#x000A;<a id="user-content-what-is-the-current-bug-behavior" class="anchor" href="#what-is-the-current-bug-behavior" aria-hidden="true"></a>What is the current bug behavior?</h4>&#x000A;<p data-sourcepos="70:1-70:43" dir="auto">The vulnerable code location is as follows.</p>&#x000A;<p data-sourcepos="72:1-72:107" dir="auto"><a href="https://gitlab.com/gitlab-org/gitlab/-/blob/v15.0.0-ee/lib/banzai/filter/commit_trailers_filter.rb#L20-27">https://gitlab.com/gitlab-org/gitlab/-/blob/v15.0.0-ee/lib/banzai/filter/commit_trailers_filter.rb#L20-27</a></p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="73:1-82:3" data-canonical-lang="ruby" class="code highlight js-syntax-highlight language-ruby" lang="ruby" v-pre="true"><code><span id="LC1" class="line" lang="ruby">      <span class="no">TRAILER_REGEXP</span> <span class="o">=</span> <span class="sr">/(?&lt;label&gt;[[:alpha:]-]+-by:)/i</span><span class="p">.</span><span class="nf">freeze</span>  </span>&#x000A;<span id="LC2" class="line" lang="ruby">      <span class="no">AUTHOR_REGEXP</span> <span class="o">=</span> <span class="sr">/(?&lt;author_name&gt;.+)/</span><span class="p">.</span><span class="nf">freeze</span>  </span>&#x000A;<span id="LC3" class="line" lang="ruby">      <span class="c1"># Devise.email_regexp wouldn't work here since its designed to match  </span></span>&#x000A;<span id="LC4" class="line" lang="ruby">      <span class="c1"># against strings that only contains email addresses; the \A and \z  </span></span>&#x000A;<span id="LC5" class="line" lang="ruby">      <span class="c1"># around the expression will only match if the string being matched  </span></span>&#x000A;<span id="LC6" class="line" lang="ruby">      <span class="c1"># contains just the email nothing else.  </span></span>&#x000A;<span id="LC7" class="line" lang="ruby">      <span class="no">MAIL_REGEXP</span> <span class="o">=</span> <span class="sr">/&amp;lt;(?&lt;author_email&gt;[^@\s]+@[^@\s]+)&amp;gt;/</span><span class="p">.</span><span class="nf">freeze</span>  </span>&#x000A;<span id="LC8" class="line" lang="ruby">      <span class="no">FILTER_REGEXP</span> <span class="o">=</span> <span class="sr">/(?&lt;trailer&gt;^\s*</span><span class="si">#{</span><span class="no">TRAILER_REGEXP</span><span class="si">}</span><span class="sr">\s*</span><span class="si">#{</span><span class="no">AUTHOR_REGEXP</span><span class="si">}</span><span class="sr">\s+</span><span class="si">#{</span><span class="no">MAIL_REGEXP</span><span class="si">}</span><span class="sr">$)/mi</span><span class="p">.</span><span class="nf">freeze</span>  </span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<p data-sourcepos="84:1-85:82" dir="auto">The matching <code data-sourcepos="84:15-84:27">FILTER_REGEXP</code> with the crafted string such as contents of <strong data-sourcepos="84:74-84:112">"commit_trailers_ReDoS_payload.txt"</strong> will cause catastrophic backtracking.<br data-sourcepos="84:153-84:153">&#x000A;The <code data-sourcepos="85:6-85:18">AUTHOR_REGEXP</code> and its surroundings make up the dangerous regex <code data-sourcepos="85:71-85:80">\s*(.+)\s+</code>.</p>&#x000A;<h4 data-sourcepos="87:1-87:44" dir="auto">&#x000A;<a id="user-content-what-is-the-expected-correct-behavior" class="anchor" href="#what-is-the-expected-correct-behavior" aria-hidden="true"></a>What is the expected correct behavior?</h4>&#x000A;<p data-sourcepos="89:1-89:81" dir="auto">The <code data-sourcepos="89:6-89:18">FILTER_REGEXP</code> should be fixed so as not to cause catastrophic backtracking.</p>&#x000A;<h4 data-sourcepos="91:1-91:40" dir="auto">&#x000A;<a id="user-content-relevant-logs-andor-screenshots" class="anchor" href="#relevant-logs-andor-screenshots" aria-hidden="true"></a>Relevant logs and/or screenshots</h4>&#x000A;<p data-sourcepos="92:1-92:77" dir="auto">I put references to the screenshots at the appropriate places in this report.</p>&#x000A;<h4 data-sourcepos="94:1-94:24" dir="auto">&#x000A;<a id="user-content-output-of-checks" class="anchor" href="#output-of-checks" aria-hidden="true"></a>Output of checks</h4>&#x000A;<p data-sourcepos="95:1-96:80" dir="auto">This bug happens on the official Docker installation of GitLab Enterprise Edition <code data-sourcepos="95:84-95:92">15.0.0-ee</code>.<br data-sourcepos="95:97-95:97">&#x000A;I used <code data-sourcepos="96:9-96:20">Chromium 101</code> and <code data-sourcepos="96:28-96:38">Firefox 100</code> on Xubuntu 20.04 LTS to verify this bug.</p>&#x000A;<h6 data-sourcepos="98:1-98:44" dir="auto">&#x000A;<a id="user-content-results-of-gitlab-environment-info" class="anchor" href="#results-of-gitlab-environment-info" aria-hidden="true"></a>Results of GitLab environment info</h6>&#x000A;<p data-sourcepos="99:1-99:47" dir="auto">Output of <code data-sourcepos="99:12-99:43">sudo gitlab-rake gitlab:env:info</code>:</p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="100:1-134:3" class="code highlight js-syntax-highlight language-plaintext" lang="plaintext" v-pre="true"><code><span id="LC1" class="line" lang="plaintext">System information  </span>&#x000A;<span id="LC2" class="line" lang="plaintext">System:		  </span>&#x000A;<span id="LC3" class="line" lang="plaintext">Proxy:		no  </span>&#x000A;<span id="LC4" class="line" lang="plaintext">Current User:	git  </span>&#x000A;<span id="LC5" class="line" lang="plaintext">Using RVM:	no  </span>&#x000A;<span id="LC6" class="line" lang="plaintext">Ruby Version:	2.7.5p203  </span>&#x000A;<span id="LC7" class="line" lang="plaintext">Gem Version:	3.1.4  </span>&#x000A;<span id="LC8" class="line" lang="plaintext">Bundler Version:2.2.33  </span>&#x000A;<span id="LC9" class="line" lang="plaintext">Rake Version:	13.0.6  </span>&#x000A;<span id="LC10" class="line" lang="plaintext">Redis Version:	6.2.6  </span>&#x000A;<span id="LC11" class="line" lang="plaintext">Sidekiq Version:6.4.0  </span>&#x000A;<span id="LC12" class="line" lang="plaintext">Go Version:	unknown</span>&#x000A;<span id="LC13" class="line" lang="plaintext"></span>&#x000A;<span id="LC14" class="line" lang="plaintext">GitLab information  </span>&#x000A;<span id="LC15" class="line" lang="plaintext">Version:	15.0.0-ee  </span>&#x000A;<span id="LC16" class="line" lang="plaintext">Revision:	3b397c17532  </span>&#x000A;<span id="LC17" class="line" lang="plaintext">Directory:	/opt/gitlab/embedded/service/gitlab-rails  </span>&#x000A;<span id="LC18" class="line" lang="plaintext">DB Adapter:	PostgreSQL  </span>&#x000A;<span id="LC19" class="line" lang="plaintext">DB Version:	12.10  </span>&#x000A;<span id="LC20" class="line" lang="plaintext">URL:		http://my-gitlab-h1.test  </span>&#x000A;<span id="LC21" class="line" lang="plaintext">HTTP Clone URL:	http://my-gitlab-h1.test/some-group/some-project.git  </span>&#x000A;<span id="LC22" class="line" lang="plaintext">SSH Clone URL:	git@my-gitlab-h1.test:some-group/some-project.git  </span>&#x000A;<span id="LC23" class="line" lang="plaintext">Elasticsearch:	no  </span>&#x000A;<span id="LC24" class="line" lang="plaintext">Geo:		no  </span>&#x000A;<span id="LC25" class="line" lang="plaintext">Using LDAP:	no  </span>&#x000A;<span id="LC26" class="line" lang="plaintext">Using Omniauth:	yes  </span>&#x000A;<span id="LC27" class="line" lang="plaintext">Omniauth Providers: </span>&#x000A;<span id="LC28" class="line" lang="plaintext"></span>&#x000A;<span id="LC29" class="line" lang="plaintext">GitLab Shell  </span>&#x000A;<span id="LC30" class="line" lang="plaintext">Version:	14.3.0  </span>&#x000A;<span id="LC31" class="line" lang="plaintext">Repository storage paths:  </span>&#x000A;<span id="LC32" class="line" lang="plaintext">- default: 	/var/opt/gitlab/git-data/repositories  </span>&#x000A;<span id="LC33" class="line" lang="plaintext">GitLab Shell path:		/opt/gitlab/embedded/service/gitlab-shell  </span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<h4 data-sourcepos="136:1-136:12" dir="auto">&#x000A;<a id="user-content-impact" class="anchor" href="#impact" aria-hidden="true"></a>Impact</h4>&#x000A;<p data-sourcepos="138:1-139:373" dir="auto">This Stored ReDoS can be retriggered by simply sending the <strong data-sourcepos="138:60-138:93">unauthenticated <code data-sourcepos="138:79-138:81">GET</code> requests</strong>.<br data-sourcepos="138:97-138:97">&#x000A;Since an attacker can exploit this to significantly impact the availability of the GitLab instance, the CVSS scores except Scope (<code data-sourcepos="139:132-139:162">AV:N/AC:L/PR:L/UI:N/C:N/I:N/A:H</code>) are the same as <a data-sourcepos="139:182-139:372" href="https://about.gitlab.com/releases/2022/05/02/security-release-gitlab-14-10-1-released/#redos-on-ci-editor-and-ci-pipeline-detail-pages" rel="nofollow noreferrer noopener" target="_blank">the scores of the most recently ReDoS (CVE-2022-1510)</a>.</p>&#x000A;<p data-sourcepos="141:1-142:131" dir="auto">In addition, an attacker can use CSRF together to expand the attackable scope beyond the vulnerable endpoints.<br data-sourcepos="141:113-141:113">&#x000A;Scope is Changed (<code data-sourcepos="142:20-142:22">S:C</code>) because this CSRF allows to <strong data-sourcepos="142:54-142:130">trigger the ReDoS from any Markdown field or from other external websites</strong>.</p>&#x000A;<p data-sourcepos="144:1-144:201" dir="auto">When <a data-sourcepos="144:6-144:168" href="https://gitlab-com.gitlab.io/gl-security/appsec/cvss-calculator/#vector=CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:N/I:N/A:H&amp;range=new" rel="nofollow noreferrer noopener" target="_blank">calculated by combining the above</a>, the CVSS score is as follows:</p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="145:1-148:5" class="code highlight js-syntax-highlight language-plaintext" lang="plaintext" v-pre="true"><code><span id="LC1" class="line" lang="plaintext">CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:N/I:N/A:H  </span>&#x000A;<span id="LC2" class="line" lang="plaintext">7.7 (High)  </span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<p data-sourcepos="149:1-149:243" dir="auto">This CVSS score is same as <a data-sourcepos="149:28-149:174" href="https://about.gitlab.com/releases/2021/09/30/security-release-gitlab-14-3-1-released/#denial-of-service-attack-in-markdown-parser" rel="nofollow noreferrer noopener" target="_blank">CVE-2021-39877</a>, which could be triggered by the <strong data-sourcepos="149:209-149:242">unauthenticated <code data-sourcepos="149:228-149:230">GET</code> requests</strong>.</p>&#x000A;<h2 data-sourcepos="151:1-151:14" dir="auto">&#x000A;<a id="user-content-attachments" class="anchor" href="#attachments" aria-hidden="true"></a>Attachments</h2>&#x000A;<p data-sourcepos="153:1-153:77" dir="auto"><strong data-sourcepos="153:1-153:12">Warning:</strong> Attachments received through HackerOne, please exercise caution!</p>&#x000A;<ul data-sourcepos="155:1-163:0" dir="auto">&#x000A;<li data-sourcepos="155:1-155:137"><a data-sourcepos="155:3-155:137" href="https://h1.sec.gitlab.net/a/67abeb50-0ccc-427f-9e06-417c56364a8f/commit_trailers_ReDoS_payload.txt" rel="nofollow noreferrer noopener" target="_blank">commit_trailers_ReDoS_payload.txt</a></li>&#x000A;<li data-sourcepos="156:1-156:129"><a data-sourcepos="156:3-156:129" href="https://h1.sec.gitlab.net/a/c7ae7b65-2050-4314-8906-645ca319ef2f/plus_new_file_on_top_page.png" rel="nofollow noreferrer noopener" target="_blank">plus_new_file_on_top_page.png</a></li>&#x000A;<li data-sourcepos="157:1-157:125"><a data-sourcepos="157:3-157:125" href="https://h1.sec.gitlab.net/a/6caa8671-6eee-4776-92eb-e8c845c75f00/add_and_commit_new_file.png" rel="nofollow noreferrer noopener" target="_blank">add_and_commit_new_file.png</a></li>&#x000A;<li data-sourcepos="158:1-158:121"><a data-sourcepos="158:3-158:121" href="https://h1.sec.gitlab.net/a/ed3b4ef2-ec6f-4d50-8740-78adeec6c51d/htop_1_core_exhausted.png" rel="nofollow noreferrer noopener" target="_blank">htop_1_core_exhausted.png</a></li>&#x000A;<li data-sourcepos="159:1-159:137"><a data-sourcepos="159:3-159:137" href="https://h1.sec.gitlab.net/a/23ab8249-b8ab-46e1-b207-3770d5dd4364/select_branch_on_commits_page.png" rel="nofollow noreferrer noopener" target="_blank">select_branch_on_commits_page.png</a></li>&#x000A;<li data-sourcepos="160:1-160:121"><a data-sourcepos="160:3-160:121" href="https://h1.sec.gitlab.net/a/b4c7e557-f827-4f79-bbcb-4f802e885431/error_on_redos_branch.png" rel="nofollow noreferrer noopener" target="_blank">error_on_redos_branch.png</a></li>&#x000A;<li data-sourcepos="161:1-161:111"><a data-sourcepos="161:3-161:111" href="https://h1.sec.gitlab.net/a/ec03f983-feec-4cdf-99a4-ef149e4028b8/create_new_issue.png" rel="nofollow noreferrer noopener" target="_blank">create_new_issue.png</a></li>&#x000A;<li data-sourcepos="162:1-163:0"><a data-sourcepos="162:3-162:123" href="https://h1.sec.gitlab.net/a/3d0f4e3b-137d-4841-b17d-a9c195016662/htop_2_cores_exhausted.png" rel="nofollow noreferrer noopener" target="_blank">htop_2_cores_exhausted.png</a></li>&#x000A;</ul>&#x000A;<h2 data-sourcepos="164:1-164:19" dir="auto">&#x000A;<a id="user-content-how-to-reproduce" class="anchor" href="#how-to-reproduce" aria-hidden="true"></a>How To Reproduce</h2>&#x000A;<p data-sourcepos="166:1-166:57" dir="auto">Please add <a data-sourcepos="166:12-166:40" href="https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues" rel="nofollow noreferrer noopener" target="_blank">reproducibility information</a> to this section:</p>&#x000A;<ol data-sourcepos="168:1-171:0" dir="auto">&#x000A;<li data-sourcepos="168:1-168:2">&#x000A;</li>&#x000A;<li data-sourcepos="169:1-169:2">&#x000A;</li>&#x000A;<li data-sourcepos="170:1-170:2">&#x000A;</li>&#x000A;</ol></div>
</div>

</div>
<div class="js-issue-widgets">
<div class="emoji-block emoji-block-sticky">
<div class="row gl-m-0 gl-justify-between">
<div class="js-noteable-awards">
<div class="gl-flex gl-flex-wrap gl-justify-between gl-pt-3">
<div data-can-award-emoji="false" data-path="/api/v4/projects/278964/issues/363734/award_emoji" data-show-default-award-emojis="true" id="js-vue-awards-block"></div>

</div>

</div>
<div class="new-branch-col gl-font-size-0 gl-my-2">

</div>
</div>
</div>

</div>
</div>
<div class="js-issue-widgets">

<div class="js-design-management" data-issue-iid="363734" data-issue-path="/gitlab-org/gitlab/-/issues/363734" data-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-project-path="gitlab-org/gitlab" data-register-path="/users/sign_up?redirect_to_referer=yes" data-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>

<div class="js-work-item-links-root" data-full-path="gitlab-org/gitlab" data-issuable-id="109299332" data-issuable-iid="363734" data-register-path="/users/sign_up?redirect_to_referer=yes" data-sign-in-path="/users/sign_in?redirect_to_referer=yes" data-wi-autocomplete-award-emojis-path="/-/autocomplete/award_emojis" data-wi-can-admin-label="false" data-wi-can-bulk-edit-epics="false" data-wi-can-create-projects="false" data-wi-default-branch="master" data-wi-epics-list-path="/groups/gitlab/-/epics" data-wi-full-path="gitlab-org/gitlab" data-wi-group-id="9970" data-wi-group-issues-path="/groups/gitlab/-/issues" data-wi-group-path="gitlab-org" data-wi-has-epics-feature="true" data-wi-has-issuable-health-status-feature="true" data-wi-has-issue-weights-feature="true" data-wi-has-iterations-feature="true" data-wi-has-linked-items-epics-feature="true" data-wi-has-okrs-feature="true" data-wi-has-quality-management-feature="true" data-wi-has-scoped-labels-feature="true" data-wi-has-subepics-feature="true" data-wi-is-signed-in="false" data-wi-issues-list-path="/gitlab-org/gitlab/-/issues" data-wi-labels-fetch-path="/groups/gitlab/-/labels.json?include_ancestor_groups=true&amp;only_group_labels=true" data-wi-labels-manage-path="/gitlab-org/gitlab/-/labels" data-wi-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-wi-new-project-path="/projects/new?namespace_id=9970" data-wi-register-path="/users/sign_up?redirect_to_referer=yes" data-wi-report-abuse-path="/-/abuse_reports/add_category" data-wi-show-new-issue-link="false" data-wi-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>


<div class="js-related-issues-root" data-can-add-related-issues="false" data-endpoint="/gitlab-org/gitlab/-/issues/363734/links" data-full-path="gitlab-org/gitlab" data-has-issue-weights-feature="true" data-has-iterations-feature="true" data-help-path="/help/user/project/issues/related_issues.md" data-is-group="false" data-issuable-type="issue" data-show-categorized-issues="true" data-wi-autocomplete-award-emojis-path="/-/autocomplete/award_emojis" data-wi-can-admin-label="false" data-wi-can-bulk-edit-epics="false" data-wi-can-create-projects="false" data-wi-default-branch="master" data-wi-epics-list-path="/groups/gitlab/-/epics" data-wi-full-path="gitlab-org/gitlab" data-wi-group-id="9970" data-wi-group-issues-path="/groups/gitlab/-/issues" data-wi-group-path="gitlab-org" data-wi-has-epics-feature="true" data-wi-has-issuable-health-status-feature="true" data-wi-has-issue-weights-feature="true" data-wi-has-iterations-feature="true" data-wi-has-linked-items-epics-feature="true" data-wi-has-okrs-feature="true" data-wi-has-quality-management-feature="true" data-wi-has-scoped-labels-feature="true" data-wi-has-subepics-feature="true" data-wi-is-signed-in="false" data-wi-issues-list-path="/gitlab-org/gitlab/-/issues" data-wi-labels-fetch-path="/groups/gitlab/-/labels.json?include_ancestor_groups=true&amp;only_group_labels=true" data-wi-labels-manage-path="/gitlab-org/gitlab/-/labels" data-wi-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-wi-new-project-path="/projects/new?namespace_id=9970" data-wi-register-path="/users/sign_up?redirect_to_referer=yes" data-wi-report-abuse-path="/-/abuse_reports/add_category" data-wi-show-new-issue-link="false" data-wi-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>

<div data-has-closing-merge-request="false" data-iid="363734" data-project-path="gitlab-org/gitlab" id="js-related-merge-requests"></div>
<div data-url="/gitlab-org/gitlab/-/issues/363734/related_branches" id="related-branches">
</div>
</div>
<div class="js-issue-widgets">
<section class="issuable-discussion js-vue-notes-event">
<div data-can-add-timeline-events="false" data-current-user-data="null" data-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-noteable-data="{&quot;id&quot;:109299332,&quot;iid&quot;:363734,&quot;description&quot;:&quot;**[HackerOne report #1584156](https://hackerone.com/reports/1584156)** by `ryhmnlfj` on 2022-05-28, assigned to @cmaxim:\n\n[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)\n\n## Report\n\n####  Summary\n\nI found server-side ReDoS vulnerability on commit trailer.  \nThis ReDoS vulnerability can be persisted as **Stored ReDoS** that can be retriggered by requesting to GET endpoint(`/[PROJECT_NAMESPACE]/-/commits/[BRANCH_CONTAINING_REDOS]`).  \nNormally, CSRFs to GET endpoint do not pose a security risk, but **CSRF to Stored ReDoS** allows an attacker to expand the attackable scopes and force other users to attack the GitLab instance.\n\n####  Steps to reproduce\n\n1. Sign in to GitLab instance.  \n2. Create a new **public** project.  \n3. Click the \&quot;`+`\&quot; button on the top page of the created project and select \&quot;New file\&quot;.\n\n![plus_new_file_on_top_page.png](https://h1.sec.gitlab.net/a/c7ae7b65-2050-4314-8906-645ca319ef2f/plus_new_file_on_top_page.png)\n\n4. Add and commit the file with the following contents to the repository in the created project.\n\n* File name: `new_file`  \n* Commit message: Copy and paste the contents of the attached file **\&quot;commit_trailers_ReDoS_payload.txt\&quot;**.  \n* Target Branch: `redos`\n\n![add_and_commit_new_file.png](https://h1.sec.gitlab.net/a/6caa8671-6eee-4776-92eb-e8c845c75f00/add_and_commit_new_file.png)\n\n_NOTE: The important input items for reproducing the bug are **the \&quot;Commit message\&quot; and the \&quot;Target Branch\&quot;**. You can set the \&quot;File name\&quot; and the contents of the file as you like._\n\n5. After you commit the file, confirm the CPU usage of the server hosting the instance rise to 100%.\n\n![htop_1_core_exhausted.png](https://h1.sec.gitlab.net/a/ed3b4ef2-ec6f-4d50-8740-78adeec6c51d/htop_1_core_exhausted.png)\n\n_NOTE: For each 1 request that triggers the ReDoS, the usage of 1 CPU core rises to 100% until 60 seconds timeout. Though it looks like a slightly unsatisfactory load, it is a sufficient load for 1 request. In the first place, similar ReDoS vulnerabilities on GitLab in the past can only give the same load per 1 request._\n\n6. After confirming for 500 or 502 error, go back to the project top page and go to the \&quot;Repository \u003e Commits\&quot; page from the left side menu.  \n7. Select `redos` from the \&quot;Switch branch/tag\&quot; drop-down menu to confirm that the `redos` branch you created works as the stored ReDoS.\n\n![select_branch_on_commits_page.png](https://h1.sec.gitlab.net/a/23ab8249-b8ab-46e1-b207-3770d5dd4364/select_branch_on_commits_page.png)\n\n8. After confirming for 500 or 502 error, make a note of `[STORED_REDOS_URL]` from the address bar of browser.\n\n![error_on_redos_branch.png](https://h1.sec.gitlab.net/a/b4c7e557-f827-4f79-bbcb-4f802e885431/error_on_redos_branch.png)\n\n9. Go back to the top page of the project again and go to the \&quot;Issues\&quot; page from the left side menu.\n\n10. Prepare the description of new issue by replacing the string below.  \nReplace `[STORED_REDOS_URL]` with the values you got in **step 8**.  \n```  \n\u003cimg src=\&quot;[STORED_REDOS_URL]\&quot;\u003e  \n```  \nAfter replacing, create a new issue with this description.\n\n![create_new_issue.png](https://h1.sec.gitlab.net/a/ec03f983-feec-4cdf-99a4-ef149e4028b8/create_new_issue.png)\n\n11. Confirm that the new issue you created also works as CSRF to stored ReDoS.  \nThe use of \&quot;Issue\&quot; feature is just one example, and **this CSRF works in any markdown field** in your GitLab instance or **in other external websites**.\n\n12. Each time a `GET` request is sent to the endpoint created in step 8, the CPU resources of the server are wasted significantly.  \nIf you send two requests, the usage of the two CPU cores will be 100%.\n\n![htop_2_cores_exhausted.png](https://h1.sec.gitlab.net/a/3d0f4e3b-137d-4841-b17d-a9c195016662/htop_2_cores_exhausted.png)\n\nThe GitLab instance can easily be taken down with repeated requests about once every few seconds.\n\n\n####  What is the current bug behavior?\n\nThe vulnerable code location is as follows.\n\nhttps://gitlab.com/gitlab-org/gitlab/-/blob/v15.0.0-ee/lib/banzai/filter/commit_trailers_filter.rb#L20-27  \n```ruby  \n      TRAILER_REGEXP = /(?\u003clabel\u003e[[:alpha:]-]+-by:)/i.freeze  \n      AUTHOR_REGEXP = /(?\u003cauthor_name\u003e.+)/.freeze  \n      # Devise.email_regexp wouldn&#39;t work here since its designed to match  \n      # against strings that only contains email addresses; the \\A and \\z  \n      # around the expression will only match if the string being matched  \n      # contains just the email nothing else.  \n      MAIL_REGEXP = /\u0026lt;(?\u003cauthor_email\u003e[^@\\s]+@[^@\\s]+)\u0026gt;/.freeze  \n      FILTER_REGEXP = /(?\u003ctrailer\u003e^\\s*#{TRAILER_REGEXP}\\s*#{AUTHOR_REGEXP}\\s+#{MAIL_REGEXP}$)/mi.freeze  \n```\n\nThe matching `FILTER_REGEXP` with the crafted string such as contents of **\&quot;commit_trailers_ReDoS_payload.txt\&quot;** will cause catastrophic backtracking.  \nThe `AUTHOR_REGEXP` and its surroundings make up the dangerous regex `\\s*(.+)\\s+`.\n\n####  What is the expected correct behavior?\n\nThe `FILTER_REGEXP` should be fixed so as not to cause catastrophic backtracking.\n\n####  Relevant logs and/or screenshots  \nI put references to the screenshots at the appropriate places in this report.\n\n####  Output of checks  \nThis bug happens on the official Docker installation of GitLab Enterprise Edition `15.0.0-ee`.  \nI used `Chromium 101` and `Firefox 100` on Xubuntu 20.04 LTS to verify this bug.\n\n######  Results of GitLab environment info  \nOutput of `sudo gitlab-rake gitlab:env:info`:  \n```  \nSystem information  \nSystem:\t\t  \nProxy:\t\tno  \nCurrent User:\tgit  \nUsing RVM:\tno  \nRuby Version:\t2.7.5p203  \nGem Version:\t3.1.4  \nBundler Version:2.2.33  \nRake Version:\t13.0.6  \nRedis Version:\t6.2.6  \nSidekiq Version:6.4.0  \nGo Version:\tunknown\n\nGitLab information  \nVersion:\t15.0.0-ee  \nRevision:\t3b397c17532  \nDirectory:\t/opt/gitlab/embedded/service/gitlab-rails  \nDB Adapter:\tPostgreSQL  \nDB Version:\t12.10  \nURL:\t\thttp://my-gitlab-h1.test  \nHTTP Clone URL:\thttp://my-gitlab-h1.test/some-group/some-project.git  \nSSH Clone URL:\tgit@my-gitlab-h1.test:some-group/some-project.git  \nElasticsearch:\tno  \nGeo:\t\tno  \nUsing LDAP:\tno  \nUsing Omniauth:\tyes  \nOmniauth Providers: \n\nGitLab Shell  \nVersion:\t14.3.0  \nRepository storage paths:  \n- default: \t/var/opt/gitlab/git-data/repositories  \nGitLab Shell path:\t\t/opt/gitlab/embedded/service/gitlab-shell  \n```\n\n####  Impact\n\nThis Stored ReDoS can be retriggered by simply sending the **unauthenticated `GET` requests**.  \nSince an attacker can exploit this to significantly impact the availability of the GitLab instance, the CVSS scores except Scope (`AV:N/AC:L/PR:L/UI:N/C:N/I:N/A:H`) are the same as [the scores of the most recently ReDoS (CVE-2022-1510)](https://about.gitlab.com/releases/2022/05/02/security-release-gitlab-14-10-1-released/#redos-on-ci-editor-and-ci-pipeline-detail-pages).\n\nIn addition, an attacker can use CSRF together to expand the attackable scope beyond the vulnerable endpoints.  \nScope is Changed (`S:C`) because this CSRF allows to **trigger the ReDoS from any Markdown field or from other external websites**.\n\nWhen [calculated by combining the above](https://gitlab-com.gitlab.io/gl-security/appsec/cvss-calculator/#vector=CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:N/I:N/A:H\u0026range=new), the CVSS score is as follows:  \n```  \nCVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:N/I:N/A:H  \n7.7 (High)  \n```  \nThis CVSS score is same as [CVE-2021-39877](https://about.gitlab.com/releases/2021/09/30/security-release-gitlab-14-3-1-released/#denial-of-service-attack-in-markdown-parser), which could be triggered by the **unauthenticated `GET` requests**.\n\n## Attachments\n\n**Warning:** Attachments received through HackerOne, please exercise caution!\n\n* [commit_trailers_ReDoS_payload.txt](https://h1.sec.gitlab.net/a/67abeb50-0ccc-427f-9e06-417c56364a8f/commit_trailers_ReDoS_payload.txt)\n* [plus_new_file_on_top_page.png](https://h1.sec.gitlab.net/a/c7ae7b65-2050-4314-8906-645ca319ef2f/plus_new_file_on_top_page.png)\n* [add_and_commit_new_file.png](https://h1.sec.gitlab.net/a/6caa8671-6eee-4776-92eb-e8c845c75f00/add_and_commit_new_file.png)\n* [htop_1_core_exhausted.png](https://h1.sec.gitlab.net/a/ed3b4ef2-ec6f-4d50-8740-78adeec6c51d/htop_1_core_exhausted.png)\n* [select_branch_on_commits_page.png](https://h1.sec.gitlab.net/a/23ab8249-b8ab-46e1-b207-3770d5dd4364/select_branch_on_commits_page.png)\n* [error_on_redos_branch.png](https://h1.sec.gitlab.net/a/b4c7e557-f827-4f79-bbcb-4f802e885431/error_on_redos_branch.png)\n* [create_new_issue.png](https://h1.sec.gitlab.net/a/ec03f983-feec-4cdf-99a4-ef149e4028b8/create_new_issue.png)\n* [htop_2_cores_exhausted.png](https://h1.sec.gitlab.net/a/3d0f4e3b-137d-4841-b17d-a9c195016662/htop_2_cores_exhausted.png)\n\n## How To Reproduce\n\nPlease add [reproducibility information] to this section:\n\n1.\n1.\n1.\n\n[reproducibility information]: https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues&quot;,&quot;title&quot;:&quot;Regex backtracking vulnerability with `commit_trailers_filter.rb` allows an attacker to exploit ReDoS through the `Commit message` field&quot;,&quot;time_estimate&quot;:0,&quot;total_time_spent&quot;:0,&quot;human_time_estimate&quot;:null,&quot;human_total_time_spent&quot;:null,&quot;state&quot;:&quot;closed&quot;,&quot;milestone_id&quot;:2453026,&quot;updated_by_id&quot;:4086191,&quot;created_at&quot;:&quot;2022-05-30T09:08:02Z&quot;,&quot;updated_at&quot;:&quot;2022-10-06T13:42:42Z&quot;,&quot;milestone&quot;:{&quot;id&quot;:2453026,&quot;iid&quot;:76,&quot;group_id&quot;:9970,&quot;title&quot;:&quot;15.4&quot;,&quot;description&quot;:&quot;[GitLab 15.4 Release](https://gitlab.com/gitlab-org/gitlab/-/releases/v15.4.0-ee)&quot;,&quot;state&quot;:&quot;closed&quot;,&quot;created_at&quot;:&quot;2022-02-03T22:29:22.015Z&quot;,&quot;updated_at&quot;:&quot;2024-01-11T08:44:10.042Z&quot;,&quot;due_date&quot;:&quot;2022-09-17&quot;,&quot;start_date&quot;:&quot;2022-08-18&quot;,&quot;expired&quot;:true,&quot;web_url&quot;:&quot;https://gitlab.com/groups/gitlab-org/-/milestones/76&quot;},&quot;labels&quot;:[{&quot;id&quot;:11469047,&quot;title&quot;:&quot;Category:Source Code Management&quot;,&quot;color&quot;:&quot;#428BCA&quot;,&quot;description&quot;:&quot;Category vision in Create stage: https://gitlab.com/groups/gitlab-org/-/epics/687&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2019-07-25T19:15:39.531Z&quot;,&quot;updated_at&quot;:&quot;2019-08-27T17:08:57.741Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:992791,&quot;title&quot;:&quot;Deliverable&quot;,&quot;color&quot;:&quot;#428BCA&quot;,&quot;description&quot;:&quot;Issues scheduled for the current milestone.&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2016-11-18T17:02:50.145Z&quot;,&quot;updated_at&quot;:&quot;2019-04-17T18:49:16.998Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3417347,&quot;title&quot;:&quot;HackerOne&quot;,&quot;color&quot;:&quot;#0033CC&quot;,&quot;description&quot;:&quot;&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-01-31T13:53:42.609Z&quot;,&quot;updated_at&quot;:&quot;2019-01-09T12:13:21.325Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:17006635,&quot;title&quot;:&quot;Weakness::CWE-400&quot;,&quot;color&quot;:&quot;#7F8C8D&quot;,&quot;description&quot;:&quot;Denial of Service&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2020-11-09T22:14:41.441Z&quot;,&quot;updated_at&quot;:&quot;2020-11-09T22:14:41.441Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:4107753,&quot;title&quot;:&quot;bug::vulnerability&quot;,&quot;color&quot;:&quot;#CC0000&quot;,&quot;description&quot;:&quot;A security vulnerability&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-05-22T15:15:09.960Z&quot;,&quot;updated_at&quot;:&quot;2022-03-16T11:32:16.336Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3103452,&quot;title&quot;:&quot;devops::create&quot;,&quot;color&quot;:&quot;#E44D2A&quot;,&quot;description&quot;:&quot;Issues for the Create stage of the DevOps lifecycle (e.g. Source Code Management, Design Management, Web IDE, Code Review, Gitter)&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-12-01T19:01:03.585Z&quot;,&quot;updated_at&quot;:&quot;2022-07-04T07:09:55.759Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:10309854,&quot;title&quot;:&quot;group::source code&quot;,&quot;color&quot;:&quot;#A8D695&quot;,&quot;description&quot;:&quot;Issues belonging to the Source Code group of the Create stage of the DevOps lifecycle. See https://about.gitlab.com/handbook/product/categories/#source-code-group&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2019-04-17T13:57:02.280Z&quot;,&quot;updated_at&quot;:&quot;2019-05-23T09:26:35.519Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3857529,&quot;title&quot;:&quot;priority::3&quot;,&quot;color&quot;:&quot;#fff600&quot;,&quot;description&quot;:&quot;We want to address this but may have other higher priority items. See https://handbook.gitlab.com/handbook/engineering/infrastructure/engineering-productivity/issue-triage/#priority&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2018-04-13T08:02:52.659Z&quot;,&quot;updated_at&quot;:&quot;2024-04-01T13:23:53.318Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:14918378,&quot;title&quot;:&quot;section::dev&quot;,&quot;color&quot;:&quot;#F0AD4E&quot;,&quot;description&quot;:&quot;Issues related to the Dev section&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2020-05-11T22:11:57.167Z&quot;,&quot;updated_at&quot;:&quot;2020-05-11T22:11:57.167Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:2779335,&quot;title&quot;:&quot;security&quot;,&quot;color&quot;:&quot;#d9534f&quot;,&quot;description&quot;:&quot;Issues related to the security of GitLab or its dependencies. Please report vulnerabilities responsibly per https://about.gitlab.com/security/disclosure/&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-10-05T14:36:39.341Z&quot;,&quot;updated_at&quot;:&quot;2023-05-24T20:20:05.269Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3713901,&quot;title&quot;:&quot;severity::3&quot;,&quot;color&quot;:&quot;#fff600&quot;,&quot;description&quot;:&quot;Major - applies to bugs and bug categories of availability, performance, security and ux. See https://handbook.gitlab.com/handbook/engineering/infrastructure/engineering-productivity/issue-triage/#severity&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2018-03-23T14:46:22.464Z&quot;,&quot;updated_at&quot;:&quot;2024-04-01T13:12:27.359Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:2278648,&quot;title&quot;:&quot;type::bug&quot;,&quot;color&quot;:&quot;#cc0000&quot;,&quot;description&quot;:&quot;Issues that report undesirable or incorrect behavior. See https://handbook.gitlab.com/handbook/product/groups/product-analysis/engineering/metrics/#work-type-classification&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-07-07T20:20:34.868Z&quot;,&quot;updated_at&quot;:&quot;2024-11-08T09:52:16.699Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:22408318,&quot;title&quot;:&quot;workflow::awaiting security release&quot;,&quot;color&quot;:&quot;#6699cc&quot;,&quot;description&quot;:&quot;This is a security issue that is ready to be deployed but awaiting a security release&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2021-11-02T16:15:28.794Z&quot;,&quot;updated_at&quot;:&quot;2021-11-02T16:15:28.794Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false}],&quot;lock_version&quot;:0,&quot;author_id&quot;:2741139,&quot;confidential&quot;:false,&quot;discussion_locked&quot;:null,&quot;assignees&quot;:[{&quot;id&quot;:1161495,&quot;username&quot;:&quot;igor.drozdov&quot;,&quot;name&quot;:&quot;Igor Drozdov&quot;,&quot;state&quot;:&quot;active&quot;,&quot;locked&quot;:false,&quot;avatar_url&quot;:&quot;https://gitlab.com/uploads/-/system/user/avatar/1161495/avatar.png&quot;,&quot;web_url&quot;:&quot;https://gitlab.com/igor.drozdov&quot;}],&quot;due_date&quot;:&quot;2022-08-26&quot;,&quot;project_id&quot;:278964,&quot;moved_to_id&quot;:null,&quot;duplicated_to_id&quot;:null,&quot;web_url&quot;:&quot;/gitlab-org/gitlab/-/issues/363734&quot;,&quot;current_user&quot;:{&quot;can_create_note&quot;:false,&quot;can_create_confidential_note&quot;:false,&quot;can_update&quot;:false,&quot;can_set_issue_metadata&quot;:false,&quot;can_award_emoji&quot;:false},&quot;create_note_path&quot;:&quot;/gitlab-org/gitlab/notes?target_id=109299332\u0026target_type=issue&quot;,&quot;preview_note_path&quot;:&quot;/gitlab-org/gitlab/-/preview_markdown?target_id=363734\u0026target_type=Issue&quot;,&quot;is_project_archived&quot;:false,&quot;issue_email_participants&quot;:[],&quot;type&quot;:&quot;ISSUE&quot;,&quot;weight&quot;:null,&quot;blocked&quot;:false,&quot;blocked_by_issues&quot;:[]}" data-noteable-type="Issue" data-notes-data="{&quot;noteableType&quot;:&quot;issue&quot;,&quot;noteableId&quot;:109299332,&quot;projectId&quot;:278964,&quot;groupId&quot;:null,&quot;discussionsPath&quot;:&quot;/gitlab-org/gitlab/-/issues/363734/discussions.json&quot;,&quot;registerPath&quot;:&quot;/users/sign_up?redirect_to_referer=yes&quot;,&quot;newSessionPath&quot;:&quot;/users/sign_in?redirect_to_referer=yes&quot;,&quot;markdownDocsPath&quot;:&quot;/help/user/markdown.md&quot;,&quot;quickActionsDocsPath&quot;:&quot;/help/user/project/quick_actions.md&quot;,&quot;closePath&quot;:&quot;/gitlab-org/gitlab/-/issues/363734.json?issue%5Bstate_event%5D=close&quot;,&quot;reopenPath&quot;:&quot;/gitlab-org/gitlab/-/issues/363734.json?issue%5Bstate_event%5D=reopen&quot;,&quot;notesPath&quot;:&quot;/gitlab-org/gitlab/noteable/issue/109299332/notes&quot;,&quot;prerenderedNotesCount&quot;:10,&quot;lastFetchedAt&quot;:1736116667000000,&quot;notesFilter&quot;:null}" data-notes-filters="{&quot;Show all activity&quot;:0,&quot;Show comments only&quot;:1,&quot;Show history only&quot;:2}" data-report-abuse-path="/-/abuse_reports/add_category" data-show-timeline-view-toggle="false" data-target-type="issue" id="js-vue-notes"></div>
</section>

</div>
</div>
<aside aria-label="issue" aria-live="polite" class="right-sidebar js-right-sidebar js-issuable-sidebar right-sidebar-expanded" data-always-show-toggle data-auto-collapse data-issuable-type="issue">
<div class="issuable-sidebar">
<div class="issuable-sidebar-header">
<button class="gl-button btn btn-md btn-default gutter-toggle gl-float-right js-sidebar-toggle has-tooltip !gl-border-0" type="button" aria-label="Toggle sidebar" title="Collapse sidebar" data-container="body" data-placement="left" data-boundary="viewport" type="button"><span class="gl-button-text">
<span class="js-sidebar-toggle-container gl-button-text" data-is-expanded="true"><svg class="s16 js-sidebar-expand hidden" data-testid="chevron-double-lg-left-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#chevron-double-lg-left"></use></svg><svg class="s16 js-sidebar-collapse " data-testid="chevron-double-lg-right-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#chevron-double-lg-right"></use></svg></span>

</span>

</button></div>
<form class="issuable-context-form inline-update js-issuable-update " action="/gitlab-org/gitlab/-/issues/363734.json" accept-charset="UTF-8" data-remote="true" method="post"><div class="block assignee gl-mt-3" data-testid="assignee-block-container">
<div class="js-sidebar-assignees-root" data-field="issue" data-max-assignees="200">
<div class="title hide-collapsed gl-flex gl-justify-between gl-items-center !gl-mb-0">
<span class="gl-font-bold">Assignee</span>
<span class="gl-spinner-container" role="status"><span aria-hidden class="gl-spinner gl-spinner-sm gl-spinner-dark !gl-align-text-bottom"></span><span class="gl-sr-only !gl-absolute">Loading</span>
</span>
</div>
</div>

</div>
<div class="block epic" data-testid="sidebar-epic">
<div class="js-sidebar-epic-widget-root" data-can-edit="false" data-group-path="gitlab-org" data-issue-id="109299332" data-issue-iid="363734" data-project-path="gitlab-org/gitlab"></div>
</div>

<div class="js-sidebar-labels-widget-root" data-allow-label-create="" data-allow-scoped-labels="true" data-can-edit="" data-iid="363734" data-issuable-type="issue" data-labels-fetch-path="/gitlab-org/gitlab/-/labels.json?include_ancestor_groups=true" data-labels-manage-path="/gitlab-org/gitlab/-/labels" data-project-issues-path="/gitlab-org/gitlab/-/issues" data-project-path="gitlab-org/gitlab" data-selected-labels="[{&quot;id&quot;:11469047,&quot;title&quot;:&quot;Category:Source Code Management&quot;,&quot;color&quot;:&quot;#428BCA&quot;,&quot;description&quot;:&quot;Category vision in Create stage: https://gitlab.com/groups/gitlab-org/-/epics/687&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2019-07-25T19:15:39.531Z&quot;,&quot;updated_at&quot;:&quot;2019-08-27T17:08:57.741Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:992791,&quot;title&quot;:&quot;Deliverable&quot;,&quot;color&quot;:&quot;#428BCA&quot;,&quot;description&quot;:&quot;Issues scheduled for the current milestone.&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2016-11-18T17:02:50.145Z&quot;,&quot;updated_at&quot;:&quot;2019-04-17T18:49:16.998Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3417347,&quot;title&quot;:&quot;HackerOne&quot;,&quot;color&quot;:&quot;#0033CC&quot;,&quot;description&quot;:&quot;&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-01-31T13:53:42.609Z&quot;,&quot;updated_at&quot;:&quot;2019-01-09T12:13:21.325Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:17006635,&quot;title&quot;:&quot;Weakness::CWE-400&quot;,&quot;color&quot;:&quot;#7F8C8D&quot;,&quot;description&quot;:&quot;Denial of Service&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2020-11-09T22:14:41.441Z&quot;,&quot;updated_at&quot;:&quot;2020-11-09T22:14:41.441Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:4107753,&quot;title&quot;:&quot;bug::vulnerability&quot;,&quot;color&quot;:&quot;#CC0000&quot;,&quot;description&quot;:&quot;A security vulnerability&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-05-22T15:15:09.960Z&quot;,&quot;updated_at&quot;:&quot;2022-03-16T11:32:16.336Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3103452,&quot;title&quot;:&quot;devops::create&quot;,&quot;color&quot;:&quot;#E44D2A&quot;,&quot;description&quot;:&quot;Issues for the Create stage of the DevOps lifecycle (e.g. Source Code Management, Design Management, Web IDE, Code Review, Gitter)&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-12-01T19:01:03.585Z&quot;,&quot;updated_at&quot;:&quot;2022-07-04T07:09:55.759Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:10309854,&quot;title&quot;:&quot;group::source code&quot;,&quot;color&quot;:&quot;#A8D695&quot;,&quot;description&quot;:&quot;Issues belonging to the Source Code group of the Create stage of the DevOps lifecycle. See https://about.gitlab.com/handbook/product/categories/#source-code-group&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2019-04-17T13:57:02.280Z&quot;,&quot;updated_at&quot;:&quot;2019-05-23T09:26:35.519Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3857529,&quot;title&quot;:&quot;priority::3&quot;,&quot;color&quot;:&quot;#fff600&quot;,&quot;description&quot;:&quot;We want to address this but may have other higher priority items. See https://handbook.gitlab.com/handbook/engineering/infrastructure/engineering-productivity/issue-triage/#priority&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2018-04-13T08:02:52.659Z&quot;,&quot;updated_at&quot;:&quot;2024-04-01T13:23:53.318Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:14918378,&quot;title&quot;:&quot;section::dev&quot;,&quot;color&quot;:&quot;#F0AD4E&quot;,&quot;description&quot;:&quot;Issues related to the Dev section&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2020-05-11T22:11:57.167Z&quot;,&quot;updated_at&quot;:&quot;2020-05-11T22:11:57.167Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:2779335,&quot;title&quot;:&quot;security&quot;,&quot;color&quot;:&quot;#d9534f&quot;,&quot;description&quot;:&quot;Issues related to the security of GitLab or its dependencies. Please report vulnerabilities responsibly per https://about.gitlab.com/security/disclosure/&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-10-05T14:36:39.341Z&quot;,&quot;updated_at&quot;:&quot;2023-05-24T20:20:05.269Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3713901,&quot;title&quot;:&quot;severity::3&quot;,&quot;color&quot;:&quot;#fff600&quot;,&quot;description&quot;:&quot;Major - applies to bugs and bug categories of availability, performance, security and ux. See https://handbook.gitlab.com/handbook/engineering/infrastructure/engineering-productivity/issue-triage/#severity&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2018-03-23T14:46:22.464Z&quot;,&quot;updated_at&quot;:&quot;2024-04-01T13:12:27.359Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:2278648,&quot;title&quot;:&quot;type::bug&quot;,&quot;color&quot;:&quot;#cc0000&quot;,&quot;description&quot;:&quot;Issues that report undesirable or incorrect behavior. See https://handbook.gitlab.com/handbook/product/groups/product-analysis/engineering/metrics/#work-type-classification&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-07-07T20:20:34.868Z&quot;,&quot;updated_at&quot;:&quot;2024-11-08T09:52:16.699Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:22408318,&quot;title&quot;:&quot;workflow::awaiting security release&quot;,&quot;color&quot;:&quot;#6699cc&quot;,&quot;description&quot;:&quot;This is a security issue that is ready to be deployed but awaiting a security release&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2021-11-02T16:15:28.794Z&quot;,&quot;updated_at&quot;:&quot;2021-11-02T16:15:28.794Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false}]"></div>
<div class="block milestone" data-testid="sidebar-milestones">
<div class="js-sidebar-milestone-widget-root" data-can-edit="" data-issue-iid="363734" data-project-path="gitlab-org/gitlab"></div>
</div>
<div class="block" data-testid="iteration-container"><div class="js-sidebar-iteration-widget-root" data-can-edit="" data-group-path="gitlab-org" data-issue-id="109299332" data-issue-iid="363734" data-project-path="gitlab-org/gitlab"></div>
</div>
<div class="js-sidebar-weight-widget-root" data-can-edit="" data-issue-iid="363734" data-project-path="gitlab-org/gitlab"></div>

<div class="js-sidebar-due-date-widget-root"></div>
<div class="js-sidebar-time-tracking-root block">
<!-- / Fallback while content is loading -->
<div class="title hide-collapsed gl-flex gl-justify-between gl-items-center !gl-mb-0">
<span class="gl-font-bold">Time tracking</span>
<span class="gl-spinner-container" role="status"><span aria-hidden class="gl-spinner gl-spinner-sm gl-spinner-dark !gl-align-text-bottom"></span><span class="gl-sr-only !gl-absolute">Loading</span>
</span>
</div>
</div>
<div class="js-sidebar-health-status-widget-root" data-can-edit="" data-full-path="gitlab-org/gitlab" data-iid="363734" data-issuable-type="issue"></div>
<script id="js-confidential-issue-data" type="application/json">{"is_confidential":false,"is_editable":null}</script>
<div class="block">
<div class="hide-collapsed gl-flex gl-items-center gl-font-bold gl-leading-20 gl-text-default">
Confidentiality
</div>
<div class="hide-collapsed gl-text-subtle">
Confidentiality controls have moved to the issue actions menu (<svg class="s12 gl-align-middle" data-testid="ellipsis_v-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#ellipsis_v"></use></svg>) at the top of the page.
</div>
</div>

<div class="js-sidebar-participants-widget-root"></div>
</form><script class="js-sidebar-options" type="application/json">{"endpoint":"/gitlab-org/gitlab/-/issues/363734.json?serializer=sidebar_extras","toggleSubscriptionEndpoint":"/gitlab-org/gitlab/-/issues/363734/toggle_subscription","moveIssueEndpoint":"/gitlab-org/gitlab/-/issues/363734/move","projectsAutocompleteEndpoint":"/-/autocomplete/projects?project_id=278964","editable":"","currentUser":{},"rootPath":"/","fullPath":"gitlab-org/gitlab","iid":363734,"id":109299332,"severity":"unknown","timeTrackingLimitToHours":true,"canCreateTimelogs":null,"createNoteEmail":null,"issuableType":"issue","directlyInviteMembers":"false","weightOptions":["None","Any",0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],"weightNoneValue":"None","multipleApprovalRulesAvailable":null}</script>
</div>
</aside>



</main>
</div>


</div>
</div>


<script nonce="V8CVyrDQZPR8KOxxYquPbQ==">
//<![CDATA[
if ('loading' in HTMLImageElement.prototype) {
  document.querySelectorAll('img.lazy').forEach(img => {
    img.loading = 'lazy';
    let imgUrl = img.dataset.src;
    // Only adding width + height for avatars for now
    if (imgUrl.indexOf('/avatar/') > -1 && imgUrl.indexOf('?') === -1) {
      const targetWidth = img.getAttribute('width') || img.width;
      imgUrl += `?width=${targetWidth}`;
    }
    img.src = imgUrl;
    img.removeAttribute('data-src');
    img.classList.remove('lazy');
    img.classList.add('js-lazy-loaded');
    img.dataset.testid = 'js-lazy-loaded-content';
  });
}

//]]>
</script>
<script nonce="V8CVyrDQZPR8KOxxYquPbQ==">
//<![CDATA[
gl = window.gl || {};
gl.experiments = {};


//]]>
</script>

</body>
</html>

