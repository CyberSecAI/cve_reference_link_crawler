```
{
  "vulnerability": {
    "root_cause": "The vulnerability is caused by a double free issue in the AMDGPU display driver when unloading the module. Flexible endpoints were using DIGs (Digital Interface Gateways) from available inflexible endpoints, and the code was incorrectly freeing encoders of both flexible and inflexible links. This caused a double free when the module was unloaded, because the flexible endpoint encoders were also being freed when the inflexible endpoints were released.",
    "weaknesses": [
      "Double free vulnerability"
    ],
    "impact": "The double free can lead to a kernel crash, resulting in a denial of service.",
     "attack_vectors": [
      "Unloading the amdgpu kernel module"
    ],
    "required_capabilities": "The attacker must have the ability to unload the amdgpu kernel module (typically root privileges). No other special capabilities are needed."
  },
  "fixes": [
    {
      "description": "The fix ensures that only the encoders of inflexible links are freed. A condition is added to check if a link is a flexible DIG mapping, and if so, the encoder is not freed during link destruction. This prevents double freeing of link encoders.",
      "commit_details": [
        {
          "commit_id": "20b5a8f9f4670a8503aa9fa95ca632e77c6bf55d",
          "file_changes": {
            "drivers/gpu/drm/amd/display/dc/link/link_factory.c": "- if (link->link_enc) {\n+ if (link->link_enc && !link->is_dig_mapping_flexible) {"
          }
        },
        {
          "commit_id": "7af9e6fa63dbd43a61d4ecc8f59426596a75e507",
           "file_changes": {
            "drivers/gpu/drm/amd/display/dc/link/link_factory.c": "- if (link->link_enc) {\n+ if (link->link_enc && !link->is_dig_mapping_flexible) {"
          }
        },
        {
          "commit_id": "3c0ff4de45ce2c5f7997a1ffa6eefee4b79e6b58",
           "file_changes": {
             "drivers/gpu/drm/amd/display/dc/link/link_factory.c": "- if (link->link_enc) {\n+ if (link->link_enc && !link->is_dig_mapping_flexible) {"
          }
        },
         {
          "commit_id": "cf6f3ebd6312d465fee096d1f58089b177c7c67f",
          "file_changes": {
             "drivers/gpu/drm/amd/display/dc/link/link_factory.c": "- if (link->link_enc) {\n+ if (link->link_enc && !link->is_dig_mapping_flexible) {"
          }
        }
      ]
    }
  ]
}
```