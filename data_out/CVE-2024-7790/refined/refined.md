Based on the provided content, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2024-7790

**Root Cause of Vulnerability:**
The vulnerability stems from insufficient sanitization of user-provided input combined with the capabilities of Large Language Models (LLMs) in DevikaAI. While user input is sanitized using DOMPurify to prevent direct injection of HTML, the LLM can be prompted to generate encoded character strings (e.g., Base64) that, when decoded by the application, can result in the execution of malicious scripts.

**Weaknesses/Vulnerabilities Present:**
- Stored Cross-Site Scripting (XSS): The application stores user input processed by the LLM. If crafted with specific prompts, an encoded malicious payload will be stored. Upon display, the payload is decoded and executed in the context of a user's browser.
- Insufficient Output Sanitization: While DOMPurify filters initial user input, it does not filter the output from the LLM. This allows the injection of malicious content via encoded strings.
- Unpredictable LLM Behavior: The vulnerability depends on the capabilities of the LLM and the prompts used by the attacker. This introduces unpredictability but doesn't eliminate the vulnerability.

**Impact of Exploitation:**
- Arbitrary Code Execution: The XSS vulnerability allows an attacker to execute arbitrary JavaScript code in the victim's browser.
- Account Takeover: By executing malicious JavaScript, an attacker can potentially steal session cookies or other sensitive information, leading to account takeover.
- Data theft: Malicious scripts can steal data, potentially leading to unauthorized access to confidential information.
- Defacement: The vulnerability could be exploited to change the appearance of the DevikaAI interface.
- Redirect users: Redirect user to another malicious page.

**Attack Vectors:**
- Crafted Prompts to LLM: The attacker crafts specific prompts to the LLM that cause it to generate a base64 encoded string containing malicious Javascript.
- Stored XSS: The encoded output from the LLM is stored. When the stored output is displayed by the application the string is decoded and the malicious script will be executed.
- Web Browser: The user's browser interprets and executes the malicious javascript.

**Required Attacker Capabilities/Position:**
- Access to DevikaAI: The attacker must be able to interact with the DevikaAI application, either directly or through a compromised user account.
- Ability to Craft Prompts: The attacker needs to be able to construct prompts that will cause the LLM to generate the malicious encoded output.
- No authentication/privileges required: The vulnerability is not dependent on user privileges and can be executed even by unauthenticated users.

**Additional Notes:**
- This vulnerability can be executed even without authentication.
- The vendor has not released a patch at the time of advisory.
- This vulnerability was identified in DevikaAI version released on June 8, 2024.
- The CVSS score is 6.5 base/5.9 temporal. The vector is AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H