=== Content from www.nlnetlabs.nl_7c051d41_20250110_233446.html ===
The CVE number for this vulnerability is CVE-2024-8508.
A vulnerability has been discovered in Unbound when handling replies
with very large RRsets that Unbound needs to perform name compression
for.
== Summary
Malicious upstreams responses with very large RRsets can cause Unbound
to spend a considerable time applying name compression to downstream
replies. This can lead to degraded performance and eventually denial of
service in well orchestrated attacks.
Unbound 1.21.1 includes a fix to limit time spent on name compression.
== Affected products
Unbound up to and including 1.21.0.
== Description
The vulnerability can be exploited by a malicious actor querying Unbound
for the specially crafted contents of a malicious zone with very large
RRsets.
Before Unbound replies to the query it will try to apply name
compression which was an unbounded operation that could lock the CPU
until the whole packet was complete.
Unbound version 1.21.1 introduces a hard limit on the number of name
compression calculations it is willing to do per packet.
Packets that need more compression will result in semi-compressed
packets or truncated packets, even on TCP for huge messages, to avoid
locking the CPU for long.
This change should not affect normal DNS traffic.
== Solution
Apply the attached patch using:
patch -p1 < patch\_CVE-2024-8508.diff
then run 'make install' to install Unbound.
The patch is tested to work on Unbound 1.21.0.
== Acknowledgments
We would like to thank Toshifumi Sakaguchi for discovering and
responsibly disclosing the vulnerability.


=== Content from lists.debian.org_58efa7da_20250110_233446.html ===


---

[[Date Prev](msg00008.html)][[Date Next](msg00010.html)]
[[Thread Prev](msg00008.html)][[Thread Next](msg00010.html)]
[[Date Index](maillist.html#00009)]
[[Thread Index](threads.html#00009)]

# [SECURITY] [DLA 3952-1] unbound security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3952-1] unbound security update
* *From*: Daniel Leidert <dleidert@debian.org>
* *Date*: Thu, 14 Nov 2024 19:58:58 +0100
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/25e294a59269779c454b3155b9276f71075f7a1e.camel%40debian.org)Â [25e294a59269779c454b3155b9276f71075f7a1e.camel@debian.org](msg00009.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-3952-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                       Daniel Leidert
November 14, 2024                             <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : unbound
Version        : 1.13.1-1+deb11u4
CVE ID         : CVE-2024-8508
Debian Bug     : 1083282

A vulnerability has been discovered in unbound, a validating,
recursive, caching DNS resolver. Malicious upstreams responses with
very large RRsets can cause Unbound to spend a considerable time
applying name compression to downstream replies. This can lead to
degraded performance and eventually denial of service in well
orchestrated attacks. The vulnerability can be exploited by a malicious
actor querying Unbound for the specially crafted contents of a
malicious zone with very large RRsets.

For Debian 11 bullseye, this problem has been fixed in version
1.13.1-1+deb11u4.

We recommend that you upgrade your unbound packages.

For the detailed security status of unbound please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/unbound>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgpt5b94caqVM.pgp)**

*Description:* This is a digitally signed message part

---



=== Content from www.openwall.com_991c561a_20250110_233446.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux Â  *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper Â  *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists Â  *for password cracking*](/wordlists/)+ [passwdqc Â  *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt Â  *KDF & password hashing*](/yescrypt/)+ [yespower Â  *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish Â  *password hashing*](/crypt/)+ [phpass Â  *ditto in PHP*](/phpass/)+ [tcb Â  *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd Â  *port scan detector*](/scanlogd/)+ [popa3d Â  *tiny POP3 daemon*](/popa3d/)+ [blists Â  *web interface to mailing lists*](/blists/)+ [msulogin Â  *single user mode login*](/msulogin/)+ [php\_mt\_seed Â  *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](4) [[next>]](../../../2024/10/05/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <49ccdfbc-8518-4e9f-9e2a-b9837af147d1@oracle.com>
Date: Fri, 4 Oct 2024 14:17:44 -0700
From: Alan Coopersmith <alan.coopersmith@...cle.com>
To: oss-security@...ts.openwall.com
Subject: CVE-2024-8508 in Unbound DNS server prior to 1.21.1

<https://nlnetlabs.nl/downloads/unbound/CVE-2024-8508.txt> states:

> The CVE number for this vulnerability is CVE-2024-8508.
>
> A vulnerability has been discovered in Unbound when handling replies
> with very large RRsets that Unbound needs to perform name compression
> for.
>
>
> == Summary
> Malicious upstreams responses with very large RRsets can cause Unbound
> to spend a considerable time applying name compression to downstream
> replies. This can lead to degraded performance and eventually denial of
> service in well orchestrated attacks.
>
> Unbound 1.21.1 includes a fix to limit time spent on name compression.
>
>
> == Affected products
> Unbound up to and including 1.21.0.
>
>
> == Description
> The vulnerability can be exploited by a malicious actor querying Unbound
> for the specially crafted contents of a malicious zone with very large
> RRsets.
> Before Unbound replies to the query it will try to apply name
> compression which was an unbounded operation that could lock the CPU
> until the whole packet was complete.
>
> Unbound version 1.21.1 introduces a hard limit on the number of name
> compression calculations it is willing to do per packet.
> Packets that need more compression will result in semi-compressed
> packets or truncated packets, even on TCP for huge messages, to avoid
> locking the CPU for long.
>
> This change should not affect normal DNS traffic.
>
>
> == Solution
> Apply the attached patch using:
>
>      patch -p1 < patch_CVE-2024-8508.diff
>
> then run 'make install' to install Unbound.
>
> The patch is tested to work on Unbound 1.21.0.
>
>
> == Acknowledgments
> We would like to thank Toshifumi Sakaguchi for discovering and
> responsibly disclosing the vulnerability.

The patch is available from
<https://nlnetlabs.nl/downloads/unbound/patch_CVE-2024-8508.diff>

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


