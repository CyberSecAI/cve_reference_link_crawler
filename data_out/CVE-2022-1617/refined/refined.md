The provided content relates to CVE-2022-1617.

**Root cause of vulnerability:**
The WordPress plugin "WP-Invoice" lacks CSRF protection when updating its settings. Additionally, it does not properly sanitize or escape user-supplied data in some of the settings fields.

**Weaknesses/vulnerabilities present:**
- Cross-Site Request Forgery (CSRF) vulnerability: An attacker can trick a logged-in administrator into unintentionally submitting a crafted request that modifies the plugin's settings.
- Stored Cross-Site Scripting (XSS) vulnerability: Due to the lack of sanitization and escaping, a malicious payload can be injected into plugin settings, which will be stored in the database and executed in the context of a user's browser when the settings are displayed on the page, allowing an attacker to execute arbitrary javascript.

**Impact of exploitation:**
- An attacker can inject arbitrary JavaScript code into the settings of the plugin.
- This allows the attacker to perform actions within the context of the logged-in administratorâ€™s browser, potentially leading to full site compromise, including privilege escalation and data theft.

**Attack vectors:**
- The attacker crafts a malicious HTML form that is submitted via a CSRF attack.
- The form injects an XSS payload into the `business_name` setting.

**Required attacker capabilities/position:**
- The attacker needs to trick a logged-in administrator into submitting the malicious form.
- The attacker does not need any access to the WordPress backend other than the ability to induce the admin into clicking a crafted link or visiting a webpage with the malicious form.