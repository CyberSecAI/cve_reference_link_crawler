The provided content relates to CVE-2024-27019.

**Root cause of vulnerability:**
A data race can occur in the `__nft_obj_type_get()` function when it iterates over the `nf_tables_objects` list concurrently with `nft_unregister_obj()`. The `nf_tables_objects` list is not protected during iteration in `__nft_obj_type_get()`.

**Weaknesses/vulnerabilities present:**
- Data race: The concurrent access to the `nf_tables_objects` list without proper locking mechanisms can lead to inconsistent data access, potentially causing crashes or undefined behavior.

**Impact of exploitation:**
- Potential for crashes or undefined behavior due to the data race.

**Attack vectors:**
- Concurrent execution of `nft_unregister_obj()` and `__nft_obj_type_get()` on the same list.

**Required attacker capabilities/position:**
- The attacker needs to be able to trigger both `nft_unregister_obj()` and `__nft_obj_type_get()` concurrently, potentially by manipulating netfilter rules.

**Additional details:**

The fix involves two key changes:
1.  Using `list_for_each_entry_rcu()` to iterate over the `nf_tables_objects` list in `__nft_obj_type_get()`. This ensures thread-safe access to the list using RCU (Read-Copy-Update) mechanisms.
2.  Employing `rcu_read_lock()` in the caller function, `nft_obj_type_get()`, to protect the entire object type query process. This ensures that the list is not modified while being read.

The vulnerability is located in the `net/netfilter/nf_tables_api.c` file of the Linux kernel, specifically around the `__nft_obj_type_get()` and `nft_obj_type_get()` functions. The fix addresses a race condition that was introduced by commit `e50092404c1b` ("netfilter: nf_tables: add stateful objects").