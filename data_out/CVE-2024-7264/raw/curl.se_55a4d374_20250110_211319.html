<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head> <title>curl - ASN.1 date parser overread - CVE-2024-7264</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<link rel="stylesheet" type="text/css" href="/curl.css">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="icon" href="/logo/curl-symbol.svg" type="image/svg+xml">
<link rel="alternate" type="application/rss+xml" title="cURL Releases" href="https://github.com/curl/curl/releases.atom">
<link rel="stylesheet" type="text/css" href="/manpage.css">
<style>
code {
    padding: 0px 4px 0px 4px;
    background-color: #f0f0f0;
}
 (prefers-color-scheme: dark) {
    code {
        padding: 0px 4px 0px 4px;
        background-color: #101010;
    }
}
</style>
</head>
<body>
<div class="main">
<div class="menu">
<a href="/docs/" class="menuitem" title="Documentation Overview">Docs Overview</a>
<div class="dropdown">
  <a class="dropbtn" href="/docs/projdocs.html">Project</a>
  <div class="dropdown-content">
    <a href="/docs/bugbounty.html">Bug Bounty</a>
    <a href="/docs/bugs.html">Bug Report</a>
    <a href="/docs/code-of-conduct.html">Code of conduct</a>
    <a href="/docs/libs.html">Dependencies</a>
    <a href="/donation.html">Donate</a>
    <a href="/docs/faq.html">FAQ</a>
    <a href="/docs/features.html">Features</a>
    <a href="/docs/governance.html">Governance</a>
    <a href="/docs/history.html">History</a>
    <a href="/docs/install.html">Install</a>
    <a href="/docs/knownbugs.html">Known Bugs</a>
    <a href="/logo/">Logo</a>
    <a href="/docs/todo.html">TODO</a>
    <a href="/about.html">website Info</a>
  </div>
</div>
<div class="dropdown">
  <a class="dropbtn" href="/docs/protdocs.html">Protocols</a>
  <div class="dropdown-content">
    <a href="/docs/caextract.html">CA Extract</a>
    <a href="/docs/http-cookies.html">HTTP cookies</a>
    <a href="/docs/http3.html">HTTP/3</a>
    <a href="/docs/mqtt.html">MQTT</a>
    <a href="/docs/sslcerts.html">SSL certs</a>
    <a href="/docs/ssl-compared.html">SSL libs compared</a>
    <a href="/docs/url-syntax.html">URL syntax</a>
    <a href="/docs/websocket.html">WebSocket</a>
  </div>
</div>
<div class="dropdown">
  <a class="dropbtn" href="/docs/reldocs.html">Releases</a>
  <div class="dropdown-content">
    <a href="/ch/">Changelog</a>
    <a href="/docs/security.html">curl CVEs</a>
    <a href="/docs/releases.html">Release Table</a>
    <a href="/docs/versions.html">Version Numbering</a>
    <a href="/docs/vulnerabilities.html">Vulnerabilities</a>
  </div>
</div>
<div class="dropdown">
  <a class="dropbtn" href="/docs/tooldocs.html">Tool</a>
  <div class="dropdown-content">
    <a href="/docs/comparison-table.html">Comparison Table</a>
    <a href="/docs/manpage.html">curl man page</a>
    <a href="/docs/httpscripting.html">HTTP Scripting</a>
    <a href="/docs/mk-ca-bundle.html">mk-ca-bundle</a>
    <a href="/docs/tutorial.html">Tutorial</a>
    <a href="optionswhen.html">When options were added</a>
  </div>
</div>
<div class="dropdown">
  <a class="dropbtn" href="/docs/whodocs.html">Who and Why</a>
  <div class="dropdown-content">
    <a href="/docs/companies.html">Companies</a>
    <a href="/docs/copyright.html">Copyright</a>
    <a href="/sponsors.html">Sponsors</a>
    <a href="/docs/thanks.html">Thanks</a>
    <a href="/docs/thename.html">The name</a>
  </div>
</div>
</div>
<div class="contents">
<div class="where"><a href="/">curl</a> / <a href="/docs/">Docs</a> / <a href="/docs/security.html">curl CVEs</a> / <b>ASN.1 date parser overread</b></div>
<div class="relatedbox">
<b>Related:</b>
<br><a href="audits.html">Audits</a>
<br><a href="/docs/bugbounty.html">Bug Bounty</a>
<br><a href="/ch/">Changelog</a>
<br><a href="security.html">curl CVEs</a>
<br><a href="CVE-2024-7264.json">JSON metadata</a>
<br><a href="https://hackerone.com/reports/2629968">Original report</a>
<br><a href="/dev/vuln-disclosure.html">Vulnerability Disclosure</a>
<br><a href="vulnerabilities.html">Vulnerabilities Table</a>
</div>
<div class="relatedbox">
Awarded 540 USD<br>
</div>
<h2>CVE-2024-7264</h2>
<h1 id="asn1-date-parser-overread">ASN.1 date parser overread</h1>
<p>Project curl Security Advisory, July 31st 2024 - <a
href="https://curl.se/docs/CVE-2024-7264.html">Permalink</a></p>
<h2 id="vulnerability">VULNERABILITY</h2>
<p>libcurl's ASN1 parser code has the <code>GTime2str()</code> function,
used for parsing an ASN.1 Generalized Time field. If given an
syntactically incorrect field, the parser might end up using -1 for the
length of the <em>time fraction</em>, leading to a <code>strlen()</code>
getting performed on a pointer to a heap buffer area that is not
(purposely) null terminated.</p>
<p>This flaw most likely leads to a crash, but can also lead to heap
contents getting returned to the application when <a
href="https://curl.se/libcurl/c/CURLINFO_CERTINFO.html">CURLINFO_CERTINFO</a>
is used.</p>
<h2 id="info">INFO</h2>
<p>The ASN.1 parsing is done <em>after</em> a successful TLS handshake,
which then also means that the used TLS library has parsed the
certificate. If the TLS library rejects the bad date string, then it
cannot reach and trigger libcurl's bug. We can however not be sure that
there are not circumstances in which the bad data still gets parsed by
libcurl.</p>
<p>This bug is considered a <em>C mistake</em> (likely to have been
avoided had we not been using C).</p>
<p>This flaw also affects the curl command line tool.</p>
<p>The Common Vulnerabilities and Exposures (CVE) project has assigned
the name CVE-2024-7264 to this issue.</p>
<p>CWE-125: Out-of-bounds Read</p>
<p>Severity: Low</p>
<h2 id="affected-versions">AFFECTED VERSIONS</h2>
<p>The vulnerable code can only be reached when curl is built to use
GnuTLS, Schannel, Secure Transport or mbedTLS. Builds using other TLS
backends are not vulnerable.</p>
<ul>
<li>Affected versions: curl <a href="vuln-7.32.0.html">7.32.0</a> to and including <a href="vuln-8.9.0.html">8.9.0</a></li>
<li>Not affected versions: curl &lt; <a href="vuln-7.32.0.html">7.32.0</a> and &gt;= <a href="vuln-8.9.1.html">8.9.1</a></li>
<li>Introduced-in: <a
href="https://github.com/curl/curl/commit/3a24cb7bc45">https://github.com/curl/curl/commit/3a24cb7bc45</a></li>
</ul>
<p>libcurl is used by many applications, but not always advertised as
such!</p>
<p>This parser bug was actually introduced in curl <a href="vuln-7.32.0.html">7.32.0</a> but was then
used only by the GSKit TLS backend which is no longer supported. The
functionality was later brought to other TLS backends in different
versions, so this bug affects curl built with different backends
starting in different versions:</p>
<ul>
<li>GnuTLS since <a href="vuln-7.42.0.html">7.42.0</a></li>
<li>Schannel since <a href="vuln-7.50.0.html">7.50.0</a></li>
<li>Secure Transport since <a href="vuln-7.79.0.html">7.79.0</a></li>
<li>mbedTLS since <a href="vuln-8.9.0.html">8.9.0</a></li>
</ul>
<h2 id="solution">SOLUTION</h2>
<ul>
<li>Fixed-in: <a
href="https://github.com/curl/curl/commit/27959ecce75cdb2">https://github.com/curl/curl/commit/27959ecce75cdb2</a></li>
</ul>
<p>Note that this fixing commit was a follow-up to this previous
incomplete fix: <a
href="https://github.com/curl/curl/commit/3c914bc680155b321">https://github.com/curl/curl/commit/3c914bc680155b321</a></p>
<h2 id="recommendations">RECOMMENDATIONS</h2>
<p>We suggest you take one of the following actions immediately, in
order of preference:</p>
<p>A - Upgrade curl and libcurl to version <a href="vuln-8.9.1.html">8.9.1</a></p>
<p>B - Apply the patch to your version and rebuild</p>
<p>C - Build your libcurl with an unaffected TLS backend</p>
<h2 id="timeline">TIMELINE</h2>
<p>This issue was reported to the curl project on July 30, 2024. We
contacted distros@openwall on July 30, 2024.</p>
<p>curl <a href="vuln-8.9.1.html">8.9.1</a> was released on July 31 2024 around 06:00 UTC, coordinated
with the publication of this advisory.</p>
<h2 id="credits">CREDITS</h2>
<ul>
<li>Reported-by: Dov Murik (Transmit Security)</li>
<li>Patched-by: Daniel Stenberg</li>
<li>Patched-by: Stefan Eissing</li>
</ul>
<p>Thanks a lot!</p>
</div>
</div>
</body> </html>
