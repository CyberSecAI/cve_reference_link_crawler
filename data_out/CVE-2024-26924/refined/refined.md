```
{
  "vulnerability": {
    "root_cause": "The `nft_pipapo_remove` function in the Linux kernel's netfilter subsystem incorrectly handles the removal of elements from a set when multiple elements share the same key. This occurs when an element is added to a set that already holds an element with the same key but the existing element has timed out or is inactive in the next generation. The removal process involves a lookup and deactivation in one step and the actual removal in the second step. The vulnerability stems from the first step of the removal process failing to ensure the found key maps to the deactivated element. This leads to the potential removal of the wrong element.",
    "weaknesses": [
      "Incorrect element removal logic when multiple elements share the same key.",
      "Potential for double free or use-after-free due to freeing live elements."
    ],
    "impact": "This can lead to a crash due to a use-after-free scenario when the element is accessed in a subsequent lookup. Additionally, this can cause memory leaks by making elements unreachable.",
    "attack_vectors": [
      "By adding and removing elements rapidly to an nft set, exploiting a race condition where an old element with the same key is still present but inactive.",
      "Specifically, a back-to-back add/remove pattern of elements with the same key."
    ],
     "required_attacker_capabilities": "An attacker needs the ability to create and manipulate nftables sets and rules to trigger the vulnerable code path."
  }
}
```