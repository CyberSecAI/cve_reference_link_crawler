

| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=85702fddba70d2b63f5646793d77de2ad4fc3784)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=85702fddba70d2b63f5646793d77de2ad4fc3784)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=85702fddba70d2b63f5646793d77de2ad4fc3784)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=85702fddba70d2b63f5646793d77de2ad4fc3784)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Jing Zhang <renyu.zj@linux.alibaba.com> | 2024-08-22 11:33:31 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-10-04 16:37:20 +0200 |
| commit | [85702fddba70d2b63f5646793d77de2ad4fc3784](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=85702fddba70d2b63f5646793d77de2ad4fc3784) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=85702fddba70d2b63f5646793d77de2ad4fc3784)) | |
| tree | [1c4c76e4826362a76383c5ba6249bfb319f086aa](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=85702fddba70d2b63f5646793d77de2ad4fc3784) | |
| parent | [86aedfbc90407920f862955cf527e6cf8f867867](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=86aedfbc90407920f862955cf527e6cf8f867867) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=85702fddba70d2b63f5646793d77de2ad4fc3784&id2=86aedfbc90407920f862955cf527e6cf8f867867)) | |
| download | [linux-85702fddba70d2b63f5646793d77de2ad4fc3784.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-85702fddba70d2b63f5646793d77de2ad4fc3784.tar.gz) | |

drivers/perf: Fix ali\_drw\_pmu driver interrupt status clearing[ Upstream commit a3dd920977dccc453c550260c4b7605b280b79c3 ]
The alibaba\_uncore\_pmu driver forgot to clear all interrupt status
in the interrupt processing function. After the PMU counter overflow
interrupt occurred, an interrupt storm occurred, causing the system
to hang.
Therefore, clear the correct interrupt status in the interrupt handling
function to fix it.
Fixes: cf7b61073e45 ("drivers/perf: add DDR Sub-System Driveway PMU driver for Yitian 710 SoC")
Signed-off-by: Jing Zhang <renyu.zj@linux.alibaba.com>
Reviewed-by: Shuai Xue <xueshuai@linux.alibaba.com>
Acked-by: Mark Rutland <mark.rutland@arm.com>
Link: [https://lore.kernel.org/r/1724297611-20686-1-git-send-email-renyu.zj@linux.alibaba.com](https://lore.kernel.org/r/1724297611-20686-1-git-send-email-renyu.zj%40linux.alibaba.com)
Signed-off-by: Will Deacon <will@kernel.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=85702fddba70d2b63f5646793d77de2ad4fc3784)

| -rw-r--r-- | [drivers/perf/alibaba\_uncore\_drw\_pmu.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/perf/alibaba_uncore_drw_pmu.c?id=85702fddba70d2b63f5646793d77de2ad4fc3784) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 1 deletions

| diff --git a/drivers/perf/alibaba\_uncore\_drw\_pmu.c b/drivers/perf/alibaba\_uncore\_drw\_pmu.cindex 38a2947ae8130c..c6ff1bc7d336b8 100644--- a/[drivers/perf/alibaba\_uncore\_drw\_pmu.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/perf/alibaba_uncore_drw_pmu.c?id=86aedfbc90407920f862955cf527e6cf8f867867)+++ b/[drivers/perf/alibaba\_uncore\_drw\_pmu.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/perf/alibaba_uncore_drw_pmu.c?id=85702fddba70d2b63f5646793d77de2ad4fc3784)@@ -400,7 +400,7 @@ static irqreturn\_t ali\_drw\_pmu\_isr(int irq\_num, void \*data) }  /\* clear common counter intr status \*/- clr\_status = FIELD\_PREP(ALI\_DRW\_PMCOM\_CNT\_OV\_INTR\_MASK, 1);+ clr\_status = FIELD\_PREP(ALI\_DRW\_PMCOM\_CNT\_OV\_INTR\_MASK, status); writel(clr\_status, drw\_pmu->cfg\_base + ALI\_DRW\_PMU\_OV\_INTR\_CLR); } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 12:47:09 +0000

