

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3115018)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Changeset](/changeset/3115017 "Changeset 3115017")
* [Next Changeset](/changeset/3115019 "Changeset 3115019") →

---

# Changeset 3115018

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
07/09/2024 01:10:19 PM
([6 months](/timeline?from=2024-07-09T13%3A10%3A19Z&precision=second "See timeline at 07/09/2024 01:10:19 PM") ago)

Author:
sirv
Message:

Release 7.2.8

Location:
[sirv/trunk](/browser/sirv/trunk?rev=3115018)
Files:

11 edited

* [plugdata/htmlBuilders/elementor/SirvControl.php](/browser/sirv/trunk/plugdata/htmlBuilders/elementor/SirvControl.php?rev=3115018 "Show entry in browser")
  (modified)
  ([1 diff](#file0 "Show differences"))
* [plugdata/includes/classes/resize.class.php](/browser/sirv/trunk/plugdata/includes/classes/resize.class.php?rev=3115018 "Show entry in browser")
  (modified)
  ([1 diff](#file1 "Show differences"))
* [plugdata/includes/classes/woo.class.php](/browser/sirv/trunk/plugdata/includes/classes/woo.class.php?rev=3115018 "Show entry in browser")
  (modified)
  ([1 diff](#file2 "Show differences"))
* [plugdata/js/wp-options.js](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3115018 "Show entry in browser")
  (modified)
  ([42 diffs](#file3 "Show differences"))
* [plugdata/js/wp-sirv-shortcodes-page.js](/browser/sirv/trunk/plugdata/js/wp-sirv-shortcodes-page.js?rev=3115018 "Show entry in browser")
  (modified)
  ([4 diffs](#file4 "Show differences"))
* [plugdata/js/wp-sirv.js](/browser/sirv/trunk/plugdata/js/wp-sirv.js?rev=3115018 "Show entry in browser")
  (modified)
  ([4 diffs](#file5 "Show differences"))
* [plugdata/options.php](/browser/sirv/trunk/plugdata/options.php?rev=3115018 "Show entry in browser")
  (modified)
  ([2 diffs](#file6 "Show differences"))
* [plugdata/submenu\_pages/feedback.php](/browser/sirv/trunk/plugdata/submenu_pages/feedback.php?rev=3115018 "Show entry in browser")
  (modified)
  ([1 diff](#file7 "Show differences"))
* [plugdata/submenu\_pages/settings.php](/browser/sirv/trunk/plugdata/submenu_pages/settings.php?rev=3115018 "Show entry in browser")
  (modified)
  ([1 diff](#file8 "Show differences"))
* [readme.txt](/browser/sirv/trunk/readme.txt?rev=3115018 "Show entry in browser")
  (modified)
  ([2 diffs](#file9 "Show differences"))
* [sirv.php](/browser/sirv/trunk/sirv.php?rev=3115018 "Show entry in browser")
  (modified)
  ([43 diffs](#file10 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [sirv/trunk/plugdata/htmlBuilders/elementor/SirvControl.php](/changeset/3115018/sirv/trunk/plugdata/htmlBuilders/elementor/SirvControl.php "Show the changeset 3115018 restricted to sirv/trunk/plugdata/htmlBuilders/elementor/SirvControl.php")

  | [r3039643](/browser/sirv/trunk/plugdata/htmlBuilders/elementor/SirvControl.php?rev=3039643#L50 "Show revision 3039643 of this file in browser") | [r3115018](/browser/sirv/trunk/plugdata/htmlBuilders/elementor/SirvControl.php?rev=3115018#L50 "Show revision 3115018 of this file in browser") |  |
  | --- | --- | --- |
  | 50 | 50 | 'woo\_media\_add\_url' => SIRV\_PLUGIN\_SUBDIR\_URL\_PATH . 'templates/woo\_media\_add.html', |
  | 51 | 51 | 'isNotEmptySirvOptions' => $isNotEmptySirvOptions, |
  | 52 |  | 'sirv\_cdn\_url' => get\_option('SIRV\_CDN\_URL'))); |
  | 53 |  | wp\_enqueue\_script('sirv-shortcodes-page', SIRV\_PLUGIN\_SUBDIR\_URL\_PATH . 'js/wp-sirv-shortcodes-page.js', array( 'jquery'), false); |
  |  | 52 | 'sirv\_cdn\_url' => get\_option('SIRV\_CDN\_URL')) |
  |  | 53 | ); |
  |  | 54 |  |
  |  | 55 | wp\_register\_script('sirv-shortcodes-page', SIRV\_PLUGIN\_SUBDIR\_URL\_PATH . 'js/wp-sirv-shortcodes-page.js', array('jquery'), false); |
  |  | 56 | wp\_localize\_script('sirv-shortcodes-page', 'sirv\_shortcodes\_page\_data', array( |
  |  | 57 | 'ajaxnonce' => wp\_create\_nonce('sirv\_shortcodes\_page\_ajax\_validation\_nonce'), |
  |  | 58 | )); |
  |  | 59 | wp\_enqueue\_script('sirv-shortcodes-page'); |
  | 54 | 60 |  |
  | 55 | 61 | wp\_enqueue\_script( 'sirv\_control\_manager', plugins\_url('/assets/js/sirvControlManager.js', \_\_FILE\_\_), array('jquery'), false, true); |
* ## [sirv/trunk/plugdata/includes/classes/resize.class.php](/changeset/3115018/sirv/trunk/plugdata/includes/classes/resize.class.php "Show the changeset 3115018 restricted to sirv/trunk/plugdata/includes/classes/resize.class.php")

  | [r2934979](/browser/sirv/trunk/plugdata/includes/classes/resize.class.php?rev=2934979#L31 "Show revision 2934979 of this file in browser") | [r3115018](/browser/sirv/trunk/plugdata/includes/classes/resize.class.php?rev=3115018#L31 "Show revision 3115018 of this file in browser") |  |
  | --- | --- | --- |
  | 31 | 31 | public static function deleteThumbs($attachment\_id){ |
  | 32 | 32 |  |
  |  | 33 | $files = array(); |
  | 33 | 34 | $fullFilePath = get\_attached\_file($attachment\_id); |
  | 34 | 35 | $fileMeta = wp\_get\_attachment\_metadata($attachment\_id); |
  | 35 | 36 | $pathToImg = pathinfo($fullFilePath, PATHINFO\_DIRNAME); |
  | 36 | 37 | $preventedSizes = self::getPreventSizes(); |
  | 37 |  | $files = self::getImagesToDelete($fileMeta['sizes'], $preventedSizes, $pathToImg); |
  |  | 38 |  |
  |  | 39 | if(isset($fileMeta['sizes'])){ |
  |  | 40 | $files = self::getImagesToDelete($fileMeta['sizes'], $preventedSizes, $pathToImg); |
  |  | 41 | } |
  |  | 42 |  |
  | 38 | 43 | $count = 0; |
  | 39 | 44 | $filesize = 0; |
* ## [sirv/trunk/plugdata/includes/classes/woo.class.php](/changeset/3115018/sirv/trunk/plugdata/includes/classes/woo.class.php "Show the changeset 3115018 restricted to sirv/trunk/plugdata/includes/classes/woo.class.php")

  | [r3103410](/browser/sirv/trunk/plugdata/includes/classes/woo.class.php?rev=3103410#L366 "Show revision 3103410 of this file in browser") | [r3115018](/browser/sirv/trunk/plugdata/includes/classes/woo.class.php?rev=3115018#L366 "Show revision 3115018 of this file in browser") |  |
  | --- | --- | --- |
  | 366 | 366 | protected static function save\_sirv\_data($product\_id, $post\_type = 'product') |
  | 367 | 367 | { |
  | 368 |  | $product\_id = ~~$post\_type == 'product' ? $\_POST['post\_ID~~'] : $product\_id; |
  |  | 368 | $product\_id = ( isset($\_POST['post\_id']) &&  $post\_type == 'product' )? $\_POST['post\_id'] : $product\_id; |
  | 369 | 369 |  |
  | 370 | 370 | if (!empty($\_REQUEST['action']) && ($\_REQUEST['action'] == 'editpost' || $\_REQUEST['action'] == 'woocommerce\_save\_variations')) { |
* ## [sirv/trunk/plugdata/js/wp-options.js](/changeset/3115018/sirv/trunk/plugdata/js/wp-options.js "Show the changeset 3115018 restricted to sirv/trunk/plugdata/js/wp-options.js")

  | [r3039643](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3039643#L178 "Show revision 3039643 of this file in browser") | [r3115018](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3115018#L178 "Show revision 3115018 of this file in browser") |  |
  | --- | --- | --- |
  | 178 | 178 | let data = {}; |
  | 179 | 179 | data['action'] = 'sirv\_init\_account'; |
  |  | 180 | data['\_ajax\_nonce'] = sirv\_options\_data.ajaxnonce, |
  | 180 | 181 | data['email'] = $('input[name=SIRV\_EMAIL]').val().trim(); |
  | 181 | 182 | data['pass'] = $('input[name=SIRV\_PASSWORD]').val().trim(); |
  | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3039643#L352) | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3115018#L353) |  |
  | 352 | 353 |  |
  | 353 | 354 | data['action'] = 'sirv\_get\_users\_list'; |
  |  | 355 | data['\_ajax\_nonce'] = sirv\_options\_data.ajaxnonce; |
  | 354 | 356 | data["email"] = $("input[name=SIRV\_EMAIL]").val().trim(); |
  | 355 | 357 | data["pass"] = $("input[name=SIRV\_PASSWORD]").val().trim(); |
  | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3039643#L387) | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3115018#L389) |  |
  | 387 | 389 |  |
  | 388 | 390 | if( !!res && !!res.error ){ |
  | 389 |  | showMessage('.sirv-error', res.error, 'sirv-init-account'); |
  |  | 391 | showMessage('.sirv-error', res.error, 'sirv-init-account', 'error'); |
  | 390 | 392 | }else if(!!res && !!res.allow\_users){ |
  | 391 | 393 | showUsersList(res); |
  | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3039643#L408) | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3115018#L410) |  |
  | 408 | 410 |  |
  | 409 | 411 | data['action'] = 'sirv\_setup\_credentials'; |
  |  | 412 | data['\_ajax\_nonce'] = sirv\_options\_data.ajaxnonce; |
  | 410 | 413 | data['email'] = $('input[name=SIRV\_EMAIL]').val(); |
  | 411 | 414 | data['sirv\_account'] = selectedValue; |
  | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3039643#L532) | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3115018#L535) |  |
  | 532 | 535 | data: { |
  | 533 | 536 | action: 'sirv\_clear\_cache', |
  |  | 537 | \_ajax\_nonce: sirv\_options\_data.ajaxnonce, |
  | 534 | 538 | clean\_cache\_type: cacheType, |
  | 535 | 539 | }, |
  | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3039643#L544) | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3115018#L548) |  |
  | 544 | 548 | //debug |
  | 545 | 549 | //console.log(data); |
  |  | 550 |  |
  |  | 551 | if(!!data.error){ |
  |  | 552 | showMessage('.sirv-sync-messages', data.error, 'sirv-sync-message', 'error'); |
  |  | 553 | } |
  | 546 | 554 |  |
  | 547 | 555 | updateCacheInfo(data); |
  | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3039643#L692) | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3115018#L700) |  |
  | 692 | 700 | let name = $('#sirv-writer-name').val(); |
  | 693 | 701 | let contactEmail = $('#sirv-writer-contact-email').val(); |
  | 694 |  | ~~//let priority = $('#sirv-priority').val();~~ |
  | 695 | 702 | let summary = $('#sirv-summary').val(); |
  | 696 | 703 | let messageText = $('#sirv-text').val(); |
  | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3039643#L699) | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3115018#L706) |  |
  | 699 | 706 | let proccessingSendMessage = '<span class="sirv-traffic-loading-ico sirv-no-lmargin"></span> Sending message. This may take some time...'; |
  | 700 | 707 | let messageSent = 'Your message has been sent.'; |
  | 701 |  | let ajaxError = 'Error during AJAX request. Please try to send the message again or use the <a target="\_blank" href="https://sirv.com/contact/">Sirv contact form here</a> ~~Error: <br/>~~'; |
  |  | 708 | let ajaxError = 'Error during AJAX request. Please try to send the message again or use the <a target="\_blank" href="https://sirv.com/contact/">Sirv contact form here</a> <br><br>Error Message: '; |
  | 702 | 709 | let sendingError = 'Something went wrong. The most likely reason is that Sendmail is not installed/configured. Please try to send the message again or use the <a target="\_blank" href="https://sirv.com/contact/">Sirv contact form here</a>'; |
  | 703 | 710 | //form messages |
  | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3039643#L723) | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3115018#L730) |  |
  | 723 | 730 | } |
  | 724 | 731 |  |
  | 725 |  | $.post(ajaxurl, { |
  | 726 |  | action: 'sirv\_send\_message', |
  | 727 |  | name: name, |
  | 728 |  | emailFrom: contactEmail, |
  | 729 |  | //priority: priority + ' (via WP)', |
  | 730 |  | summary: summary, |
  | 731 |  | text: 'Contact name: ' + name + '\n' + 'Contact Email: ' + contactEmail + '\n\n' + messageText + generatedViaWP, |
  |  | 732 | $.ajax({ |
  |  | 733 | url: ajaxurl, |
  |  | 734 | data: { |
  |  | 735 | action: 'sirv\_send\_message', |
  |  | 736 | \_ajax\_nonce: sirv\_options\_data.ajaxnonce, |
  |  | 737 | name: name, |
  |  | 738 | emailFrom: contactEmail, |
  |  | 739 | summary: summary, |
  |  | 740 | text: `Contact name: ${name}\nContact Email: ${contactEmail}\n\n${messageText} ${generatedViaWP}`, |
  |  | 741 | }, |
  |  | 742 | type: 'POST', |
  |  | 743 | dataType: "json", |
  | 732 | 744 | beforeSend: function () { |
  | 733 | 745 | $('.sirv-show-result').html(proccessingSendMessage); |
  | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3039643#L737) | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3115018#L749) |  |
  | 737 | 749 | //console.log(data); |
  | 738 | 750 |  |
  | 739 |  | if (data == '1') { |
  | 740 |  | $('.sirv-show-result').html(messageSent); |
  |  | 751 | $(".sirv-show-result").hide(); |
  |  | 752 |  |
  |  | 753 | if(data.error){ |
  |  | 754 | showMessage(".sirv-feedback-msg", data.error, '.feedback-msg'); |
  |  | 755 | } |
  |  | 756 |  |
  |  | 757 | if (data.result == '1') { |
  |  | 758 | showMessage(".sirv-feedback-msg", messageSent, '.feedback-msg', 'ok'); |
  | 741 | 759 | } else { |
  | 742 |  | ~~$('.sirv-show-result').html(sendingError~~); |
  |  | 760 | showMessage(".sirv-feedback-msg", sendingError, '.feedback-msg'); |
  | 743 | 761 | } |
  | 744 | 762 |  |
  | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3039643#L750) | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3115018#L768) |  |
  | 750 | 768 |  |
  | 751 | 769 | }).fail(function (jqXHR, status, error) { |
  | 752 |  | console.log("Error during ajax request: " + error); |
  | 753 |  | $('.sirv-show-result').html(ajaxError + error); |
  |  | 770 | $(".sirv-show-result").hide(); |
  |  | 771 | console.error("Error during ajax request: " + error); |
  |  | 772 | showMessage(".sirv-feedback-msg", ajaxError + error, ".feedback-msg"); |
  | 754 | 773 | }); |
  | 755 | 774 |  |
  | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3039643#L793) | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3115018#L812) |  |
  | 793 | 812 |  |
  | 794 | 813 |  |
  | 795 |  | ~~$('.tst').on('click', tst);~~ |
  | 796 |  | ~~function tst() {~~ |
  | 797 |  | ~~$.ajax({~~ |
  | 798 |  | ~~url: ajaxurl,~~ |
  | 799 |  | ~~data: {~~ |
  | 800 |  | ~~action: 'sirv\_tst',~~ |
  | 801 |  | ~~},~~ |
  | 802 |  | ~~type: 'POST',~~ |
  | 803 |  | ~~dataType: "json",~~ |
  | 804 |  | ~~beforeSend: function () {~~ |
  | 805 |  |  |
  | 806 |  | ~~},~~ |
  | 807 |  | ~~}).done(function (data) {~~ |
  | 808 |  | ~~//debug~~ |
  | 809 |  | ~~console.log(data);~~ |
  | 810 |  |  |
  | 811 |  | ~~}).fail(function (jqXHR, status, error) {~~ |
  | 812 |  | ~~console.error("Error during ajax request: " + error);~~ |
  | 813 |  | ~~});~~ |
  | 814 |  | ~~}~~ |
  | 815 |  |  |
  | 816 |  |  |
  | 817 | 814 | $(".sirv-sync-images").on("click", initializeMassSync); |
  | 818 | 815 | function initializeMassSync(){ |
  | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3039643#L821) | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3115018#L818) |  |
  | 821 | 818 | data: { |
  | 822 | 819 | action: 'sirv\_initialize\_process\_sync\_images', |
  |  | 820 | \_ajax\_nonce: sirv\_options\_data.ajaxnonce, |
  | 823 | 821 | sirv\_initialize\_sync: true, |
  | 824 | 822 | }, |
  | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3039643#L842) | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3115018#L840) |  |
  | 842 | 840 | //debug |
  | 843 | 841 | //console.log(data); |
  |  | 842 | if(!!data && !!data.error){ |
  |  | 843 | showMessage('.sirv-sync-messages', data.error, 'sirv-sync-message', 'error'); |
  |  | 844 | } |
  |  | 845 |  |
  | 844 | 846 | if (!!data && data.folders\_calc\_finished){ |
  | 845 | 847 | $('.sirv-queue').html('Processing (2/3): calculating images in queue...'); |
  | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3039643#L873) | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3115018#L875) |  |
  | 873 | 875 | data: { |
  | 874 | 876 | action: 'sirv\_process\_sync\_images', |
  |  | 877 | \_ajax\_nonce: sirv\_options\_data.ajaxnonce, |
  | 875 | 878 | sirv\_sync\_uncached\_images: true, |
  | 876 | 879 | }, |
  | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3039643#L885) | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3115018#L888) |  |
  | 885 | 888 |  |
  | 886 | 889 | if (!!data) { |
  |  | 890 | if(!!data.error){ |
  |  | 891 | showMessage('.sirv-sync-messages', data.error, 'sirv-sync-message', 'error'); |
  |  | 892 | } |
  |  | 893 |  |
  | 887 | 894 | $('.sirv-progress-data\_\_complited--text').html(data.q\_s); |
  | 888 | 895 | $('.sirv-progress-data\_\_complited--size').html(data.size\_s); |
  | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3039643#L1031) | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3115018#L1038) |  |
  | 1031 | 1038 | data: { |
  | 1032 | 1039 | action: 'sirv\_get\_error\_data', |
  |  | 1040 | \_ajax\_nonce: sirv\_options\_data.ajaxnonce, |
  | 1033 | 1041 | error\_id: errorId, |
  | 1034 | 1042 | report\_type: reportType, |
  | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3039643#L1047) | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3115018#L1055) |  |
  | 1047 | 1055 |  |
  | 1048 | 1056 | if (!!data) { |
  |  | 1057 | if(!!data.error){ |
  |  | 1058 | showMessage('.sirv-sync-messages', data.error, 'sirv-get-failed-message', 'error'); |
  |  | 1059 | } |
  |  | 1060 |  |
  | 1049 | 1061 | if(reportType == 'html'){ |
  | 1050 | 1062 | $link.text('Open HTML report'); |
  | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3039643#L1092) | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3115018#L1104) |  |
  | 1092 | 1104 | data: { |
  | 1093 | 1105 | action: 'sirv\_get\_errors\_info', |
  |  | 1106 | \_ajax\_nonce: sirv\_options\_data.ajaxnonce, |
  | 1094 | 1107 | }, |
  | 1095 | 1108 | type: 'POST', |
  | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3039643#L1106) | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3115018#L1119) |  |
  | 1106 | 1119 |  |
  | 1107 | 1120 | if (!!data) { |
  |  | 1121 | if(!!data.error){ |
  |  | 1122 | showMessage('.sirv-sync-messages', data.error, 'sirv-get-failed-message', 'error'); |
  |  | 1123 | } |
  |  | 1124 |  |
  | 1108 | 1125 | let documentFragment = $(document.createDocumentFragment()); |
  | 1109 | 1126 | for (let i in data) { |
  | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3039643#L1244) | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3115018#L1261) |  |
  | 1244 | 1261 | if ($curButton.attr("data-type") === "regenerate"){ |
  | 1245 | 1262 | let sizesCount = $(".sirv-thumbs-sizes .sirv-crop-row\_\_checkboxes").length; |
  | 1246 |  | ~~console.log(sizesCount);~~ |
  | 1247 |  | ~~console.log(Object.keys(preventedSizesObj).length);~~ |
  | 1248 | 1263 | if(Object.keys(preventedSizesObj).length === sizesCount){ |
  | 1249 | 1264 | hideMessage("sirv-thumbs-message"); |
  | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3039643#L1291) | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3115018#L1306) |  |
  | 1291 | 1306 | data: { |
  | 1292 | 1307 | action: 'sirv\_save\_prevented\_sizes', |
  |  | 1308 | \_ajax\_nonce: sirv\_options\_data.ajaxnonce, |
  | 1293 | 1309 | sizes: preventedSizesStr, |
  | 1294 | 1310 | }, |
  | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3039643#L1304) | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3115018#L1320) |  |
  | 1304 | 1320 | //debug |
  | 1305 | 1321 | //console.log(data); |
  |  | 1322 |  |
  |  | 1323 | if(!!data.error){ |
  |  | 1324 | showMessage('.sirv-thumb-messages', data.error, 'sirv-thumbs-message', 'error'); |
  |  | 1325 | } |
  | 1306 | 1326 |  |
  | 1307 | 1327 | if(data.status == 'saved'){ |
  | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3039643#L1328) | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3115018#L1348) |  |
  | 1328 | 1348 | url: ajaxurl, |
  | 1329 | 1349 | data: { |
  | 1330 |  | action: 'sirv\_cancel\_thumbs\_process' |
  |  | 1350 | action: 'sirv\_cancel\_thumbs\_process', |
  |  | 1351 | \_ajax\_nonce:sirv\_options\_data.ajaxnonce, |
  | 1331 | 1352 | }, |
  | 1332 | 1353 | type: 'POST', |
  | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3039643#L1341) | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3115018#L1362) |  |
  | 1341 | 1362 | //debug |
  | 1342 | 1363 | //console.log(data); |
  |  | 1364 | if(data.error){ |
  |  | 1365 | showMessage('.sirv-thumb-messages', data.error, 'sirv-thumbs-message', 'error'); |
  |  | 1366 | } |
  | 1343 | 1367 |  |
  | 1344 | 1368 | if(data.status == 'canceled'){ |
  | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3039643#L1378) | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3115018#L1402) |  |
  | 1378 | 1402 | data: { |
  | 1379 | 1403 | action: 'sirv\_thumbs\_process', |
  |  | 1404 | \_ajax\_nonce: sirv\_options\_data.ajaxnonce, |
  | 1380 | 1405 | type: type, |
  | 1381 | 1406 | pause: isPause, |
  | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3039643#L1401) | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3115018#L1426) |  |
  | 1401 | 1426 | //debug |
  | 1402 | 1427 | //console.log(data); |
  |  | 1428 | if(data.error){ |
  |  | 1429 | showMessage('.sirv-thumb-messages', data.error, 'sirv-thumbs-message', 'error'); |
  |  | 1430 | } |
  | 1403 | 1431 |  |
  | 1404 | 1432 | if(data.status == 'processing'){ |
  | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3039643#L1484) | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3115018#L1512) |  |
  | 1484 | 1512 | data: { |
  | 1485 | 1513 | action: 'sirv\_empty\_view\_cache', |
  |  | 1514 | \_ajax\_nonce: sirv\_options\_data.ajaxnonce, |
  | 1486 | 1515 | type: type, |
  | 1487 | 1516 | }, |
  | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3039643#L1498) | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3115018#L1527) |  |
  | 1498 | 1527 | //console.log(data); |
  | 1499 | 1528 |  |
  |  | 1529 | if(data.error){ |
  |  | 1530 | showMessage('.sirv-sync-messages', data.error, 'sirv-sync-message', 'error'); |
  |  | 1531 | } |
  |  | 1532 |  |
  | 1500 | 1533 | //showMessage('.sirv-sync-messages', getMessage(type), 'sirv-sync-message', 'ok'); |
  | 1501 | 1534 | $('.sirv-clear-view-cache').siblings('span.sirv-traffic-loading-ico').hide(); |
  | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3039643#L1539) | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3115018#L1572) |  |
  | 1539 | 1572 | data: { |
  | 1540 | 1573 | action: 'sirv\_empty\_view\_cache', |
  |  | 1574 | \_ajax\_nonce: sirv\_options\_data.ajaxnonce, |
  | 1541 | 1575 | type: type, |
  | 1542 | 1576 | }, |
  | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3039643#L1551) | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3115018#L1585) |  |
  | 1551 | 1585 | //debug |
  | 1552 | 1586 | //console.log(data); |
  |  | 1587 |  |
  |  | 1588 | if(data.error){ |
  |  | 1589 | showMessage('.sirv-sync-messages', data.error, 'sirv-sync-message', 'error'); |
  |  | 1590 | } |
  | 1553 | 1591 |  |
  | 1554 | 1592 | //showMessage('.sirv-sync-messages', getMessage(type), 'sirv-sync-message', 'ok'); |
  | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3039643#L1602) | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3115018#L1640) |  |
  | 1602 | 1640 | data: { |
  | 1603 | 1641 | "action": 'sirv\_css\_images\_prepare\_process', |
  |  | 1642 | "\_ajax\_nonce": sirv\_options\_data.ajaxnonce, |
  | 1604 | 1643 | "custom\_path": custom\_path |
  | 1605 | 1644 | }, |
  | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3039643#L1650) | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3115018#L1689) |  |
  | 1650 | 1689 | url: ajaxurl, |
  | 1651 | 1690 | data: { |
  | 1652 |  | "action": 'sirv\_css\_images\_proccess', |
  |  | 1691 | action: 'sirv\_css\_images\_proccess', |
  |  | 1692 | \_ajax\_nonce: sirv\_options\_data.ajaxnonce, |
  | 1653 | 1693 | }, |
  | 1654 | 1694 | type: 'POST', |
  | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3039643#L1700) | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3115018#L1740) |  |
  | 1700 | 1740 | url: ajaxurl, |
  | 1701 | 1741 | data: { |
  | 1702 |  | "action": 'sirv\_css\_images\_processing', |
  |  | 1742 | action: 'sirv\_css\_images\_processing', |
  |  | 1743 | \_ajax\_nonce: sirv\_options\_data.ajaxnonce, |
  | 1703 | 1744 | }, |
  | 1704 | 1745 | type: 'POST', |
  | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3039643#L1743) | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3115018#L1784) |  |
  | 1743 | 1784 | url: ajaxurl, |
  | 1744 | 1785 | data: { |
  | 1745 |  | "action": 'sirv\_css\_images\_get\_data', |
  |  | 1786 | action: 'sirv\_css\_images\_get\_data', |
  |  | 1787 | \_ajax\_nonce: sirv\_options\_data.ajaxnonce, |
  | 1746 | 1788 | }, |
  | 1747 | 1789 | type: 'POST', |
  | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3039643#L1755) | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3115018#L1797) |  |
  | 1755 | 1797 | //debug |
  | 1756 | 1798 | //console.log(response); |
  |  | 1799 |  |
  |  | 1800 | if(response.error){ |
  |  | 1801 | $('.sync-css').siblings('span.sirv-traffic-loading-ico').hide(); |
  |  | 1802 | $('.sync-css').siblings('span.sirv-show-empty-view-result').text(response.error); |
  |  | 1803 | $('.sync-css').siblings('span.sirv-show-empty-view-result').show(); |
  |  | 1804 | return; |
  |  | 1805 | } |
  | 1757 | 1806 |  |
  | 1758 | 1807 | $('.sync-css').siblings('span.sirv-traffic-loading-ico').hide(); |
  | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3039643#L1884) | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3115018#L1933) |  |
  | 1884 | 1933 | data: { |
  | 1885 | 1934 | action: 'sirv\_refresh\_stats', |
  |  | 1935 | \_ajax\_nonce: sirv\_options\_data.ajaxnonce, |
  | 1886 | 1936 | }, |
  | 1887 | 1937 | type: 'POST', |
  | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3039643#L1897) | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3115018#L1947) |  |
  | 1897 | 1947 | $('.sirv-stats-container').removeClass('sirv-loading'); |
  | 1898 | 1948 | if (!!data) { |
  |  | 1949 | if(data.error){ |
  |  | 1950 | showMessage('.sirv-stats-messages', error, 'sirv-get-failed-message', error); |
  |  | 1951 | } |
  |  | 1952 |  |
  | 1899 | 1953 | window.abc = data.traffic.traffic; |
  | 1900 | 1954 | $('.sirv-stat-last-update').html(data.lastUpdate); |
  | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3039643#L2183) | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3115018#L2237) |  |
  | 2183 | 2237 |  |
  | 2184 | 2238 |  |
  | 2185 |  |  |
  | 2186 |  | ~~$('.debug-button').on('click', function () {~~ |
  | 2187 |  | ~~let data = {}~~ |
  | 2188 |  | ~~data['action'] = 'sirv\_debug';~~ |
  | 2189 |  |  |
  | 2190 |  | ~~$.ajax({~~ |
  | 2191 |  | ~~url: ajaxurl,~~ |
  | 2192 |  | ~~type: 'POST',~~ |
  | 2193 |  | ~~data: data,~~ |
  | 2194 |  | ~~beforeSend: function () {~~ |
  | 2195 |  | ~~console.log('-----------------------------------DEBUG START-----------------------------------')~~ |
  | 2196 |  | ~~}~~ |
  | 2197 |  | ~~}).done(function (response) {~~ |
  | 2198 |  | ~~console.log(response);~~ |
  | 2199 |  | ~~console.log('-----------------------------------DEBUG END-----------------------------------')~~ |
  | 2200 |  | ~~}).fail(function (jqXHR, status, error) {~~ |
  | 2201 |  | ~~console.log("Error during ajax request: " + error + ' ' + status);~~ |
  | 2202 |  | ~~console.log('-----------------------------------DEBUG END-----------------------------------')~~ |
  | 2203 |  | ~~});~~ |
  | 2204 |  | ~~});~~ |
  | 2205 |  |  |
  | 2206 | 2239 | //$('.sirv-switch').on('change', function () { |
  | 2207 | 2240 | $('.sirv-switch-acc-login').on('click', switchAccLogin); |
  | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3039643#L2237) | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3115018#L2270) |  |
  | 2237 | 2270 | $.ajax({ |
  | 2238 | 2271 | url: ajaxurl, |
  | 2239 |  | data: {action: 'sirv\_images\_storage\_size'}, |
  |  | 2272 | data: { |
  |  | 2273 | action: 'sirv\_images\_storage\_size', |
  |  | 2274 | \_ajax\_nonce: sirv\_options\_data.ajaxnonce, |
  |  | 2275 | }, |
  | 2240 | 2276 | type: 'POST', |
  | 2241 | 2277 | dataType: "json", |
  | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3039643#L2248) | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3115018#L2284) |  |
  | 2248 | 2284 | //debug |
  | 2249 | 2285 | //console.log(res); |
  |  | 2286 |  |
  |  | 2287 | if(res.error){ |
  |  | 2288 | console.error(res.error); |
  |  | 2289 | } |
  | 2250 | 2290 |  |
  | 2251 | 2291 | $('.v-time').text(res.microtime + ' ms ( '+ res.time + ' sec )'); |
  | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3039643#L2555) | […](/browser/sirv/trunk/plugdata/js/wp-options.js?rev=3115018#L2595) |  |
  | 2555 | 2595 | //console.log(res); |
  | 2556 | 2596 |  |
  |  | 2597 | if(res.error){ |
  |  | 2598 | console.error(res.error); |
  |  | 2599 | } |
  |  | 2600 |  |
  | 2557 | 2601 | $(".sirv-compressed-js-spinner").hide(); |
  | 2558 | 2602 |  |
* ## [sirv/trunk/plugdata/js/wp-sirv-shortcodes-page.js](/changeset/3115018/sirv/trunk/plugdata/js/wp-sirv-shortcodes-page.js "Show the changeset 3115018 restricted to sirv/trunk/plugdata/js/wp-sirv-shortcodes-page.js")

  | [r3047104](/browser/sirv/trunk/plugdata/js/wp-sirv-shortcodes-page.js?rev=3047104#L7 "Show revision 3047104 of this file in browser") | [r3115018](/browser/sirv/trunk/plugdata/js/wp-sirv-shortcodes-page.js?rev=3115018#L7 "Show revision 3115018 of this file in browser") |  |
  | --- | --- | --- |
  | 7 | 7 | window['sirvGetShortcodesData'] = function(offset, itemsOnPage, doneFunc){ |
  | 8 | 8 | $.post(ajaxurl, { |
  | 9 |  | action: 'sirv\_get\_shortcodes\_data', |
  | 10 |  | shortcodes\_page: parseInt(offset), |
  | 11 |  | itemsPerPage: parseInt(itemsOnPage), |
  | 12 |  | beforeSend: function(){ |
  | 13 |  | $('.loading-ajax').show(); |
  | 14 |  | }, |
  | 15 |  | }).done(function(data){ |
  | 16 |  | //debug |
  | 17 |  | //console.log(data); |
  | 18 |  | itemsPerPage = itemsOnPage; |
  | 19 |  |  |
  | 20 |  | data = JSON.parse(data); |
  | 21 |  | doneFunc(data, offset); |
  | 22 |  | if(window.isSirvGutenberg && window.isSirvGutenberg == true){ |
  | 23 |  | checkAndRestoreSelection(); |
  | 24 |  | } |
  | 25 |  |  |
  | 26 |  | $('.loading-ajax').hide(); |
  | 27 |  |  |
  | 28 |  | }).fail(function(qXHR, status, error){ |
  | 29 |  | console.log(status, error); |
  | 30 |  | $('.loading-ajax').hide(); |
  | 31 |  | }); |
  |  | 9 | action: 'sirv\_get\_shortcodes\_data', |
  |  | 10 | \_ajax\_nonce: sirv\_shortcodes\_page\_data.ajaxnonce, |
  |  | 11 | shortcodes\_page: parseInt(offset), |
  |  | 12 | itemsPerPage: parseInt(itemsOnPage), |
  |  | 13 | beforeSend: function(){ |
  |  | 14 | $('.loading-ajax').show(); |
  |  | 15 | }, |
  |  | 16 | }).done(function(data){ |
  |  | 17 | //debug |
  |  | 18 | //console.log(data); |
  |  | 19 |  |
  |  | 20 | data = JSON.parse(data); |
  |  | 21 |  |
  |  | 22 | if(data.error){ |
  |  | 23 | console.log(data.error); |
  |  | 24 | return; |
  |  | 25 | } |
  |  | 26 |  |
  |  | 27 | itemsPerPage = itemsOnPage; |
  |  | 28 |  |
  |  | 29 | doneFunc(data, offset); |
  |  | 30 | if(window.isSirvGutenberg && window.isSirvGutenberg == true){ |
  |  | 31 | checkAndRestoreSelection(); |
  |  | 32 | } |
  |  | 33 |  |
  |  | 34 | $('.loading-ajax').hide(); |
  |  | 35 |  |
  |  | 36 | }).fail(function(qXHR, status, error){ |
  |  | 37 | console.log(status, error); |
  |  | 38 | $('.loading-ajax').hide(); |
  |  | 39 | }); |
  | 32 | 40 | } |
  | 33 | 41 |  |
  | […](/browser/sirv/trunk/plugdata/js/wp-sirv-shortcodes-page.js?rev=3047104#L263) | […](/browser/sirv/trunk/plugdata/js/wp-sirv-shortcodes-page.js?rev=3115018#L271) |  |
  | 263 | 271 |  |
  | 264 | 272 | $.post(ajaxurl, { |
  | 265 |  | action: 'sirv\_duplicate\_shortcodes\_data', |
  | 266 |  | shortcode\_id: id, |
  | 267 |  | beforeSend: function(){ |
  | 268 |  | $('.loading-ajax').show(); |
  | 269 |  | } |
  |  | 273 | action: 'sirv\_duplicate\_shortcodes\_data', |
  |  | 274 | \_ajax\_nonce: sirv\_shortcodes\_page\_data.ajaxnonce, |
  |  | 275 | shortcode\_id: id, |
  |  | 276 | beforeSend: function(){ |
  |  | 277 | $('.loading-ajax').show(); |
  |  | 278 | } |
  | 270 | 279 | }).done(function(response){ |
  | 271 | 280 | //debug |
  | 272 | 281 | //console.log(response); |
  | 273 | 282 |  |
  |  | 283 | if(response.error){ |
  |  | 284 | console.error(response.error); |
  |  | 285 | return; |
  |  | 286 | } |
  |  | 287 |  |
  | 274 | 288 | let curPage = parseInt($('.sirv-cur-page').attr('data-page')); |
  | 275 | 289 | sirvGetShortcodesData(curPage, itemsPerPage, renderShortcodesByType); |
  | […](/browser/sirv/trunk/plugdata/js/wp-sirv-shortcodes-page.js?rev=3047104#L280) | […](/browser/sirv/trunk/plugdata/js/wp-sirv-shortcodes-page.js?rev=3115018#L294) |  |
  | 280 | 294 | $('.loading-ajax').hide(); |
  | 281 | 295 | }); |
  | 282 |  |  |
  | 283 |  |  |
  | 284 |  |  |
  | 285 | 296 | } |
  | 286 | 297 |  |
  | […](/browser/sirv/trunk/plugdata/js/wp-sirv-shortcodes-page.js?rev=3047104#L295) | […](/browser/sirv/trunk/plugdata/js/wp-sirv-shortcodes-page.js?rev=3115018#L306) |  |
  | 295 | 306 |  |
  | 296 | 307 | $.post(ajaxurl, { |
  | 297 |  | action: 'sirv\_delete\_shortcodes', |
  | 298 |  | shortcode\_ids: JSON.stringify(checkedIds), |
  | 299 |  | beforeSend: function(){ |
  | 300 |  | $('.loading-ajax').show(); |
  | 301 |  | } |
  |  | 308 | action: 'sirv\_delete\_shortcodes', |
  |  | 309 | \_ajax\_nonce: sirv\_shortcodes\_page\_data.ajaxnonce, |
  |  | 310 | shortcode\_ids: JSON.stringify(checkedIds), |
  |  | 311 | beforeSend: function(){ |
  |  | 312 | $('.loading-ajax').show(); |
  |  | 313 | } |
  | 302 | 314 | }).done(function(response){ |
  | 303 | 315 | //debug |
  | 304 | 316 | //console.log(response); |
  |  | 317 |  |
  |  | 318 | if(response.error){ |
  |  | 319 | console.error(response.error); |
  |  | 320 | return; |
  |  | 321 | } |
  | 305 | 322 |  |
  | 306 | 323 | let curPage = parseInt($('.sirv-cur-page').attr('data-page')) || 1; |
* ## [sirv/trunk/plugdata/js/wp-sirv.js](/changeset/3115018/sirv/trunk/plugdata/js/wp-sirv.js "Show the changeset 3115018 restricted to sirv/trunk/plugdata/js/wp-sirv.js")

  | [r3103410](/browser/sirv/trunk/plugdata/js/wp-sirv.js?rev=3103410#L2173 "Show revision 3103410 of this file in browser") | [r3115018](/browser/sirv/trunk/plugdata/js/wp-sirv.js?rev=3115018#L2173 "Show revision 3115018 of this file in browser") |  |
  | --- | --- | --- |
  | 2173 | 2173 | let data = { |
  | 2174 | 2174 | action: 'sirv\_get\_image\_uploading\_status', |
  |  | 2175 | \_ajax\_nonce: sirv\_ajax\_object.ajaxnonce, |
  | 2175 | 2176 | sirv\_get\_image\_uploading\_status: true |
  | 2176 | 2177 | } |
  | […](/browser/sirv/trunk/plugdata/js/wp-sirv.js?rev=3103410#L2182) | […](/browser/sirv/trunk/plugdata/js/wp-sirv.js?rev=3115018#L2183) |  |
  | 2182 | 2183 | sendAjaxRequest(ajaxData, processingOverlay=false, showingArea=false, isdebug=false, |
  | 2183 | 2184 | doneFn=function(response){ |
  | 2184 |  | let json\_obj = JSON.parse(response); |
  | 2185 |  | if(json\_obj.processedImage!== null || json\_obj.count !== null){ |
  | 2186 |  | $('.sirv-progress-bar').css('width', json\_obj.percent + '%'); |
  | 2187 |  | $('.sirv-progress-text').html(json\_obj.percent + '%' + ' ('+ json\_obj.processedImage +' of '+ json\_obj.count +')'); |
  | 2188 |  |  |
  | 2189 |  | if (json\_obj.percent == 100) { |
  | 2190 |  | window.clearInterval(uploadTimer); |
  |  | 2185 |  |
  |  | 2186 | if(response.error){ |
  |  | 2187 | console.error(response.error); |
  |  | 2188 | return; |
  | 2191 | 2189 | } |
  | 2192 |  | }else{ |
  | 2193 |  | if(json\_obj.isPartFileUploading){ |
  | 2194 |  | $('.sirv-progress-text').html('<span class="sirv-traffic-loading-ico sirv-no-lmargin"></span>processing upload big files by chunks...'); |
  |  | 2190 |  |
  |  | 2191 | let json\_obj = JSON.parse(response); |
  |  | 2192 | if(json\_obj.processedImage!== null || json\_obj.count !== null){ |
  |  | 2193 | $('.sirv-progress-bar').css('width', json\_obj.percent + '%'); |
  |  | 2194 | $('.sirv-progress-text').html(json\_obj.percent + '%' + ' ('+ json\_obj.processedImage +' of '+ json\_obj.count +')'); |
  |  | 2195 |  |
  |  | 2196 | if (json\_obj.percent == 100) { |
  |  | 2197 | window.clearInterval(uploadTimer); |
  |  | 2198 | } |
  | 2195 | 2199 | }else{ |
  | 2196 |  | //$('.sirv-progress-text').html('processing...'); |
  | 2197 |  | if(FirstImageUploadDelay == 0){ |
  | 2198 |  | window.clearInterval(uploadTimer); |
  | 2199 |  | FirstImageUploadDelay = 50; |
  |  | 2200 | if(json\_obj.isPartFileUploading){ |
  |  | 2201 | $('.sirv-progress-text').html('<span class="sirv-traffic-loading-ico sirv-no-lmargin"></span>processing upload big files by chunks...'); |
  |  | 2202 | }else{ |
  |  | 2203 | //$('.sirv-progress-text').html('processing...'); |
  |  | 2204 | if(FirstImageUploadDelay == 0){ |
  |  | 2205 | window.clearInterval(uploadTimer); |
  |  | 2206 | FirstImageUploadDelay = 50; |
  |  | 2207 | } |
  |  | 2208 | FirstImageUploadDelay--; |
  | 2200 | 2209 | } |
  | 2201 |  | ~~FirstImageUploadDelay--;~~ |
  | 2202 | 2210 | } |
  | 2203 |  | ~~}~~ |
  | 2204 | 2211 | }); |
  | 2205 | 2212 | } |
  | […](/browser/sirv/trunk/plugdata/js/wp-sirv.js?rev=3103410#L3188) | […](/browser/sirv/trunk/plugdata/js/wp-sirv.js?rev=3115018#L3195) |  |
  | 3188 | 3195 | let id; |
  | 3189 | 3196 | let data = { |
  | 3190 |  | action: action, |
  | 3191 |  | shortcode\_data: getShortcodeData() |
  |  | 3197 | action: action, |
  |  | 3198 | \_ajax\_nonce: sirv\_ajax\_object.ajaxnonce, |
  |  | 3199 | shortcode\_data: getShortcodeData() |
  | 3192 | 3200 | }; |
  | 3193 | 3201 |  |
  | […](/browser/sirv/trunk/plugdata/js/wp-sirv.js?rev=3103410#L3205) | […](/browser/sirv/trunk/plugdata/js/wp-sirv.js?rev=3115018#L3213) |  |
  | 3205 | 3213 | //processingOverlay='.loading-ajax' |
  | 3206 | 3214 | sendAjaxRequest(ajaxData, processingOverlay = '.loading-ajax', showingArea=false, isdebug=false, doneFn=function(response){ |
  |  | 3215 | if(response.error){ |
  |  | 3216 | console.error(response.error); |
  |  | 3217 | } |
  |  | 3218 |  |
  | 3207 | 3219 | id = response; |
  | 3208 | 3220 | }); |
* ## [sirv/trunk/plugdata/options.php](/changeset/3115018/sirv/trunk/plugdata/options.php "Show the changeset 3115018 restricted to sirv/trunk/plugdata/options.php")

  | [r3023399](/browser/sirv/trunk/plugdata/options.php?rev=3023399#L145 "Show revision 3023399 of this file in browser") | [r3115018](/browser/sirv/trunk/plugdata/options.php?rev=3115018#L145 "Show revision 3115018 of this file in browser") |  |
  | --- | --- | --- |
  | 145 | 145 | <form action="options.php" method="post" id="sirv-save-options"> |
  | 146 | 146 | <?php |
  | 147 |  | wp\_nonce\_field('update-options'); |
  |  | 147 | //settings\_fields('sirv-settings-group'); |
  |  | 148 | //do\_settings\_sections( 'sirv-settings-group' ); |
  |  | 149 | //wp\_nonce\_field('update-options'); |
  |  | 150 | wp\_nonce\_field('sirv-settings-group-options'); |
  |  | 151 | wp\_nonce\_field('options-options'); |
  | 148 | 152 |  |
  | 149 | 153 | $active\_tab = (isset($\_POST['active\_tab'])) ? $\_POST['active\_tab'] : '#sirv-settings'; |
  | […](/browser/sirv/trunk/plugdata/options.php?rev=3023399#L202) | […](/browser/sirv/trunk/plugdata/options.php?rev=3115018#L206) |  |
  | 202 | 206 |  |
  | 203 | 207 | <input type="hidden" name="active\_tab" id="active\_tab" value="#settings" /> |
  |  | 208 | <!-- <input type='hidden' name='option\_page' value="sirv-settings-group" /> --> |
  |  | 209 | <input type='hidden' name='option\_page' value="options" /> |
  | 204 | 210 | <input type="hidden" name="action" value="update" /> |
  | 205 | 211 | <input type="hidden" name="page\_options" value="<?php echo implode(', ', $options\_names); ?>" /> |
* ## [sirv/trunk/plugdata/submenu\_pages/feedback.php](/changeset/3115018/sirv/trunk/plugdata/submenu_pages/feedback.php "Show the changeset 3115018 restricted to sirv/trunk/plugdata/submenu_pages/feedback.php")

  | [r2929636](/browser/sirv/trunk/plugdata/submenu_pages/feedback.php?rev=2929636#L4 "Show revision 2929636 of this file in browser") | [r3115018](/browser/sirv/trunk/plugdata/submenu_pages/feedback.php?rev=3115018#L4 "Show revision 3115018 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | <div class="sirv-optiontable-holder"> |
  | 5 | 5 | <table class="optiontable form-table"> |
  |  | 6 | <tr class="sirv-feedback-msg"> |
  |  | 7 |  |
  |  | 8 | </tr> |
  | 6 | 9 | <tr> |
  | 7 | 10 | <td> |
* ## [sirv/trunk/plugdata/submenu\_pages/settings.php](/changeset/3115018/sirv/trunk/plugdata/submenu_pages/settings.php "Show the changeset 3115018 restricted to sirv/trunk/plugdata/submenu_pages/settings.php")

  | [r3039643](/browser/sirv/trunk/plugdata/submenu_pages/settings.php?rev=3039643#L98 "Show revision 3039643 of this file in browser") | [r3115018](/browser/sirv/trunk/plugdata/submenu_pages/settings.php?rev=3115018#L98 "Show revision 3115018 of this file in browser") |  |
  | --- | --- | --- |
  | 98 | 98 | <p class="sirv-viewble-option"><span class="sirv--grey"><?php echo htmlspecialchars($sirvCDNurl); ?>/</span><?php echo htmlspecialchars($sirv\_folder); ?>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="sirv-option-edit" href="#">Change</a></p> |
  | 99 | 99 | <p class="sirv-editable-option" style="display: none;"> |
  | 100 |  | <span class="sirv--grey"><?php echo htmlspecialchars($sirvCDNurl); ?>/</span><input class="regular-text" type="text" name="SIRV\_FOLDER" value="<?php echo ~~$sirv\_folder~~; ?>"> |
  |  | 100 | <span class="sirv--grey"><?php echo htmlspecialchars($sirvCDNurl); ?>/</span><input class="regular-text" type="text" name="SIRV\_FOLDER" value="<?php echo htmlspecialchars($sirv\_folder); ?>"> |
  | 101 | 101 | </p> |
  | 102 | 102 | <br> |
* ## [sirv/trunk/readme.txt](/changeset/3115018/sirv/trunk/readme.txt "Show the changeset 3115018 restricted to sirv/trunk/readme.txt")

  | [r3103410](/browser/sirv/trunk/readme.txt?rev=3103410#L5 "Show revision 3103410 of this file in browser") | [r3115018](/browser/sirv/trunk/readme.txt?rev=3115018#L5 "Show revision 3115018 of this file in browser") |  |
  | --- | --- | --- |
  | 5 | 5 | Requires PHP: 5.6 |
  | 6 | 6 | Requires at least: 3.0.1 |
  | 7 |  | Tested up to: 6.~~5.4~~ |
  | 8 |  | Stable tag: ~~4.7.1~~ |
  |  | 7 | Tested up to: 6.6 |
  |  | 8 | Stable tag: 7.2.0 |
  | 9 | 9 | License: GPLv2 or later |
  | 10 | 10 | License URI: http://www.gnu.org/licenses/gpl-2.0.html |
  | […](/browser/sirv/trunk/readme.txt?rev=3103410#L240) | […](/browser/sirv/trunk/readme.txt?rev=3115018#L240) |  |
  | 240 | 240 | == Changelog == |
  | 241 | 241 |  |
  |  | 242 | = 7.2.8 = |
  |  | 243 | \* Plugin tested with the latest WordPress version 6.6. |
  |  | 244 | \* Potentially fixed a warning for deprecated options. |
  |  | 245 | \* Security fixes. |
  |  | 246 | \* Small fixes and optimizations. |
  |  | 247 |  |
  |  | 248 |  |
  | 242 | 249 | = 7.2.7 = |
  | 243 | 250 | \* Plugin tested with the latest WordPress version 6.5.4. |
* ## [sirv/trunk/sirv.php](/changeset/3115018/sirv/trunk/sirv.php "Show the changeset 3115018 restricted to sirv/trunk/sirv.php")

  | [r3103410](/browser/sirv/trunk/sirv.php?rev=3103410#L5 "Show revision 3103410 of this file in browser") | [r3115018](/browser/sirv/trunk/sirv.php?rev=3115018#L5 "Show revision 3115018 of this file in browser") |  |
  | --- | --- | --- |
  | 5 | 5 | \* Plugin URI: http://sirv.com |
  | 6 | 6 | \* Description: Fully-automatic image optimization, next-gen formats (WebP), responsive resizing, lazy loading and CDN delivery. Every best-practice your website needs. Use "Add Sirv Media" button to embed images, galleries, zooms, 360 spins and streaming videos in posts / pages. Stunning media viewer for WooCommerce. Watermarks, text titles... every WordPress site deserves this plugin! <a href="admin.php?page=sirv/data/options.php">Settings</a> |
  | 7 |  | \* Version:           7.2.~~7~~ |
  |  | 7 | \* Version:           7.2.8 |
  | 8 | 8 | \* Requires PHP:      5.6 |
  | 9 | 9 | \* Requires at least: 3.0.1 |
  | […](/browser/sirv/trunk/sirv.php?rev=3103410#L16) | […](/browser/sirv/trunk/sirv.php?rev=3115018#L16) |  |
  | 16 | 16 |  |
  | 17 | 17 |  |
  | 18 |  | define('SIRV\_PLUGIN\_VERSION', '7.2.~~7~~'); |
  |  | 18 | define('SIRV\_PLUGIN\_VERSION', '7.2.8'); |
  | 19 | 19 | define('SIRV\_PLUGIN\_DIR', 'sirv'); |
  | 20 | 20 | define('SIRV\_PLUGIN\_SUBDIR', 'plugdata'); |
  | […](/browser/sirv/trunk/sirv.php?rev=3103410#L1363) | […](/browser/sirv/trunk/sirv.php?rev=3115018#L1363) |  |
  | 1363 | 1363 | 'isNotEmptySirvOptions' => $isNotEmptySirvOptions |
  | 1364 | 1364 | )); |
  | 1365 |  | wp\_enqueue\_script('sirv-shortcodes-page', SIRV\_PLUGIN\_SUBDIR\_URL\_PATH . 'js/wp-sirv-shortcodes-page.js', array('jquery'), false); |
  |  | 1365 |  |
  |  | 1366 | wp\_register\_script('sirv-shortcodes-page', SIRV\_PLUGIN\_SUBDIR\_URL\_PATH . 'js/wp-sirv-shortcodes-page.js', array('jquery'), false); |
  |  | 1367 | wp\_localize\_script('sirv-shortcodes-page', 'sirv\_shortcodes\_page\_data', array( |
  |  | 1368 | 'ajaxnonce' => wp\_create\_nonce('sirv\_shortcodes\_page\_ajax\_validation\_nonce'), |
  |  | 1369 | )); |
  |  | 1370 | wp\_enqueue\_script('sirv-shortcodes-page'); |
  | 1366 | 1371 |  |
  | 1367 | 1372 | echo '<a href="#" class="button sirv-modal-click" title="Sirv add/insert images"><span class="dashicons dashicons-format-gallery" style="padding-top: 2px;"></span> Add Sirv Media</a><div class="sirv-modal"><div class="modal-content"></div></div>'; |
  | […](/browser/sirv/trunk/sirv.php?rev=3103410#L1455) | […](/browser/sirv/trunk/sirv.php?rev=3115018#L1460) |  |
  | 1455 | 1460 | ) |
  | 1456 | 1461 | ); |
  | 1457 |  | wp\_enqueue\_script('sirv-shortcodes-page', SIRV\_PLUGIN\_SUBDIR\_URL\_PATH . 'js/wp-sirv-shortcodes-page.js', array('jquery'), false); |
  |  | 1462 |  |
  |  | 1463 | wp\_register\_script('sirv-shortcodes-page', SIRV\_PLUGIN\_SUBDIR\_URL\_PATH . 'js/wp-sirv-shortcodes-page.js', array('jquery'), false); |
  |  | 1464 | wp\_localize\_script('sirv-shortcodes-page', 'sirv\_shortcodes\_page\_data', array( |
  |  | 1465 | 'ajaxnonce' => wp\_create\_nonce('sirv\_shortcodes\_page\_ajax\_validation\_nonce'), |
  |  | 1466 | )); |
  |  | 1467 | wp\_enqueue\_script('sirv-shortcodes-page'); |
  | 1458 | 1468 | } |
  | 1459 | 1469 | } |
  | […](/browser/sirv/trunk/sirv.php?rev=3103410#L1470) | […](/browser/sirv/trunk/sirv.php?rev=3115018#L1480) |  |
  | 1470 | 1480 | wp\_enqueue\_script('sirv\_ui-js', SIRV\_PLUGIN\_SUBDIR\_URL\_PATH . 'js/wp-sirv-ui.js', array('jquery', 'jquery-ui-sortable', 'sirv\_modal'), false); |
  | 1471 | 1481 |  |
  | 1472 |  | wp\_~~enqueue~~\_script('sirv\_options', SIRV\_PLUGIN\_SUBDIR\_URL\_PATH . 'js/wp-options.js', array('jquery', 'jquery-ui-sortable', 'sirv\_ui-js'), false, true); |
  |  | 1482 | wp\_register\_script('sirv\_options', SIRV\_PLUGIN\_SUBDIR\_URL\_PATH . 'js/wp-options.js', array('jquery', 'jquery-ui-sortable', 'sirv\_ui-js'), false, true); |
  | 1473 | 1483 | wp\_localize\_script('sirv\_options', 'sirv\_options\_data', array( |
  | 1474 | 1484 | 'ajaxurl' => admin\_url('admin-ajax.php'), |
  | 1475 | 1485 | 'ajaxnonce' => wp\_create\_nonce('ajax\_validation\_nonce'), |
  | 1476 | 1486 | )); |
  |  | 1487 | wp\_enqueue\_script('sirv\_options'); |
  | 1477 | 1488 | } |
  | 1478 | 1489 |  |
  | […](/browser/sirv/trunk/sirv.php?rev=3103410#L1480) | […](/browser/sirv/trunk/sirv.php?rev=3115018#L1491) |  |
  | 1480 | 1491 | wp\_register\_style('sirv\_options\_style', SIRV\_PLUGIN\_SUBDIR\_URL\_PATH . 'css/wp-options.css'); |
  | 1481 | 1492 | wp\_enqueue\_style('sirv\_options\_style'); |
  | 1482 |  | wp\_enqueue\_script('sirv\_options', SIRV\_PLUGIN\_SUBDIR\_URL\_PATH . 'js/wp-options.js', array('jquery', 'jquery-ui-sortable'), false, true); |
  |  | 1493 |  |
  |  | 1494 | wp\_register\_script('sirv\_options', SIRV\_PLUGIN\_SUBDIR\_URL\_PATH . 'js/wp-options.js', array('jquery', 'jquery-ui-sortable'), false, true); |
  | 1483 | 1495 | wp\_localize\_script('sirv\_options', 'sirv\_options\_data', array( |
  | 1484 | 1496 | 'ajaxurl' => admin\_url('admin-ajax.php'), |
  | 1485 | 1497 | 'ajaxnonce' => wp\_create\_nonce('ajax\_validation\_nonce'), |
  | 1486 | 1498 | )); |
  |  | 1499 | wp\_enqueue\_script('sirv\_options'); |
  | 1487 | 1500 | } |
  | 1488 | 1501 |  |
  | […](/browser/sirv/trunk/sirv.php?rev=3103410#L1499) | […](/browser/sirv/trunk/sirv.php?rev=3115018#L1512) |  |
  | 1499 | 1512 | wp\_localize\_script('sirv\_logic', 'sirv\_ajax\_object', array( |
  | 1500 | 1513 | 'ajaxurl' => admin\_url('admin-ajax.php'), |
  | 1501 |  | 'ajaxnonce' => wp\_create\_nonce('sirv\_logic\_ajax\_validation\_nonce'), |
  |  | 1514 | 'ajaxnonce' => wp\_create\_nonce('sirv\_logic\_ajax\_validation\_nonce'), |
  | 1502 | 1515 | 'assets\_path' => SIRV\_PLUGIN\_SUBDIR\_URL\_PATH . 'assets') |
  | 1503 | 1516 | ); |
  | […](/browser/sirv/trunk/sirv.php?rev=3103410#L1513) | […](/browser/sirv/trunk/sirv.php?rev=3115018#L1526) |  |
  | 1513 | 1526 |  |
  | 1514 | 1527 | wp\_register\_script('sirv-shortcodes-page', SIRV\_PLUGIN\_SUBDIR\_URL\_PATH . 'js/wp-sirv-shortcodes-page.js', array('jquery'), false); |
  |  | 1528 | wp\_localize\_script('sirv-shortcodes-page', 'sirv\_shortcodes\_page\_data', array( |
  |  | 1529 | 'ajaxnonce' => wp\_create\_nonce('sirv\_shortcodes\_page\_ajax\_validation\_nonce'), |
  |  | 1530 | )); |
  | 1515 | 1531 | wp\_enqueue\_script('sirv-shortcodes-page'); |
  | 1516 | 1532 | wp\_localize\_script('sirv-shortcodes-page', 'sirvShortcodeObject', array('isShortcodesPage' => true)); |
  | […](/browser/sirv/trunk/sirv.php?rev=3103410#L3750) | […](/browser/sirv/trunk/sirv.php?rev=3115018#L3766) |  |
  | 3750 | 3766 |  |
  | 3751 | 3767 | return $foldersData; |
  | 3752 |  | ~~}~~ |
  | 3753 |  |  |
  | 3754 |  |  |
  | 3755 |  | ~~add\_action('wp\_ajax\_sirv\_tst', 'sirv\_tst');~~ |
  | 3756 |  | ~~function sirv\_tst(){~~ |
  | 3757 |  | ~~if (!(is\_array($\_POST) && defined('DOING\_AJAX') && DOING\_AJAX)) {~~ |
  | 3758 |  | ~~return;~~ |
  | 3759 |  | ~~}~~ |
  | 3760 |  |  |
  | 3761 |  | ~~echo json\_encode(array('done' => true));~~ |
  | 3762 |  |  |
  | 3763 |  | ~~wp\_die();~~ |
  | 3764 | 3768 | } |
  | 3765 | 3769 |  |
  | […](/browser/sirv/trunk/sirv.php?rev=3103410#L4105) | […](/browser/sirv/trunk/sirv.php?rev=3115018#L4109) |  |
  | 4105 | 4109 | } |
  | 4106 | 4110 |  |
  |  | 4111 | if (!sirv\_is\_allow\_ajax\_connect('ajax\_validation\_nonce', 'manage\_options')) { |
  |  | 4112 | echo json\_encode(array('error' => 'Access to the requested resource is forbidden')); |
  |  | 4113 | wp\_die(); |
  |  | 4114 | } |
  |  | 4115 |  |
  | 4107 | 4116 | $errors = FetchError::get\_errors\_from\_db(); |
  | 4108 | 4117 | //$file\_size\_fetch\_limit = empty((int) get\_option('SIRV\_FETCH\_MAX\_FILE\_SIZE')) ?  '' : ' (' . Utils::getFormatedFileSize(get\_option('SIRV\_FETCH\_MAX\_FILE\_SIZE')) . ')'; |
  | […](/browser/sirv/trunk/sirv.php?rev=3103410#L4243) | […](/browser/sirv/trunk/sirv.php?rev=3115018#L4252) |  |
  | 4243 | 4252 |  |
  | 4244 | 4253 |  |
  | 4245 |  | ~~//use ajax to clean 30 rows in table. For test purpose.~~ |
  | 4246 |  | ~~add\_action('wp\_ajax\_sirv\_delete\_thirty\_rows', 'sirv\_delete\_thirty\_rows\_callback');~~ |
  | 4247 |  | ~~function sirv\_delete\_thirty\_rows\_callback(){~~ |
  | 4248 |  | ~~if (!(is\_array($\_POST) && isset($\_POST['sirv\_delete\_thirty\_rows']) && defined('DOING\_AJAX') && DOING\_AJAX)) {~~ |
  | 4249 |  | ~~return;~~ |
  | 4250 |  | ~~}~~ |
  | 4251 |  | ~~global $wpdb;~~ |
  | 4252 |  |  |
  | 4253 |  | ~~$table\_name = $wpdb->prefix . 'sirv\_images';~~ |
  | 4254 |  | ~~$result = $wpdb->query("DELETE FROM $table\_name WHERE id > 0 LIMIT 30");~~ |
  | 4255 |  |  |
  | 4256 |  | ~~echo $result;~~ |
  | 4257 |  |  |
  | 4258 |  |  |
  | 4259 |  | ~~wp\_die();~~ |
  | 4260 |  | ~~}~~ |
  | 4261 |  |  |
  | 4262 |  |  |
  | 4263 | 4254 | add\_action('wp\_ajax\_sirv\_initialize\_process\_sync\_images', 'sirv\_initialize\_process\_sync\_images'); |
  | 4264 | 4255 | function sirv\_initialize\_process\_sync\_images(){ |
  | […](/browser/sirv/trunk/sirv.php?rev=3103410#L4267) | […](/browser/sirv/trunk/sirv.php?rev=3115018#L4258) |  |
  | 4267 | 4258 | } |
  | 4268 | 4259 |  |
  |  | 4260 | if (!sirv\_is\_allow\_ajax\_connect('ajax\_validation\_nonce', 'manage\_options')) { |
  |  | 4261 | echo json\_encode(array('error' => 'Access to the requested resource is forbidden')); |
  |  | 4262 | wp\_die(); |
  |  | 4263 | } |
  |  | 4264 |  |
  | 4269 | 4265 | global $overheadLimit; |
  | 4270 | 4266 |  |
  | […](/browser/sirv/trunk/sirv.php?rev=3103410#L4281) | […](/browser/sirv/trunk/sirv.php?rev=3115018#L4277) |  |
  | 4281 | 4277 | if (!(is\_array($\_POST) && isset($\_POST['sirv\_sync\_uncached\_images']) && defined('DOING\_AJAX') && DOING\_AJAX)) { |
  | 4282 | 4278 | return; |
  |  | 4279 | } |
  |  | 4280 |  |
  |  | 4281 | if (!sirv\_is\_allow\_ajax\_connect('ajax\_validation\_nonce', 'manage\_options')) { |
  |  | 4282 | echo json\_encode(array('error' => 'Access to the requested resource is forbidden')); |
  |  | 4283 | wp\_die(); |
  | 4283 | 4284 | } |
  | 4284 | 4285 |  |
  | […](/browser/sirv/trunk/sirv.php?rev=3103410#L4400) | […](/browser/sirv/trunk/sirv.php?rev=3115018#L4401) |  |
  | 4400 | 4401 | } |
  | 4401 | 4402 |  |
  |  | 4403 | if (!sirv\_is\_allow\_ajax\_connect('ajax\_validation\_nonce', 'manage\_options')) { |
  |  | 4404 | echo json\_encode(array('error' => 'Access to the requested resource is forbidden')); |
  |  | 4405 | wp\_die(); |
  |  | 4406 | } |
  |  | 4407 |  |
  | 4402 | 4408 | echo json\_encode(sirv\_getStorageInfo(true)); |
  | 4403 | 4409 | wp\_die(); |
  | […](/browser/sirv/trunk/sirv.php?rev=3103410#L4410) | […](/browser/sirv/trunk/sirv.php?rev=3115018#L4416) |  |
  | 4410 | 4416 | if (!(is\_array($\_POST) && isset($\_POST['clean\_cache\_type']) && defined('DOING\_AJAX') && DOING\_AJAX)) { |
  | 4411 | 4417 | return; |
  |  | 4418 | } |
  |  | 4419 |  |
  |  | 4420 | if (!sirv\_is\_allow\_ajax\_connect('ajax\_validation\_nonce', 'manage\_options')) { |
  |  | 4421 | echo json\_encode(array('error' => 'Access to the requested resource is forbidden')); |
  |  | 4422 | wp\_die(); |
  | 4412 | 4423 | } |
  | 4413 | 4424 |  |
  | […](/browser/sirv/trunk/sirv.php?rev=3103410#L4499) | […](/browser/sirv/trunk/sirv.php?rev=3115018#L4510) |  |
  | 4499 | 4510 |  |
  | 4500 | 4511 | foreach ($data as $file) { |
  |  | 4512 | $file->filename = htmlspecialchars($file->filename); |
  | 4501 | 4513 | if ($file->isDirectory) { |
  | 4502 | 4514 | if ( !in\_array($file->filename, $restricted\_folders) ) $content['dirs'][] = $file; |
  | […](/browser/sirv/trunk/sirv.php?rev=3103410#L4764) | […](/browser/sirv/trunk/sirv.php?rev=3115018#L4776) |  |
  | 4764 | 4776 | } |
  | 4765 | 4777 |  |
  |  | 4778 | if (!sirv\_is\_allow\_ajax\_connect('sirv\_logic\_ajax\_validation\_nonce', 'edit\_posts')) { |
  |  | 4779 | echo json\_encode(array('error' => 'Access to the requested resource is forbidden')); |
  |  | 4780 | wp\_die(); |
  |  | 4781 | } |
  |  | 4782 |  |
  | 4766 | 4783 | session\_id('image-uploading-status'); |
  | 4767 | 4784 | session\_start(); |
  | […](/browser/sirv/trunk/sirv.php?rev=3103410#L4794) | […](/browser/sirv/trunk/sirv.php?rev=3115018#L4811) |  |
  | 4794 | 4811 | } |
  | 4795 | 4812 |  |
  |  | 4813 | if (!sirv\_is\_allow\_ajax\_connect('sirv\_logic\_ajax\_validation\_nonce', 'edit\_posts')) { |
  |  | 4814 | echo json\_encode(array('error' => 'Access to the requested resource is forbidden')); |
  |  | 4815 | wp\_die(); |
  |  | 4816 | } |
  |  | 4817 |  |
  | 4796 | 4818 | global $base\_prefix; |
  | 4797 | 4819 | global $wpdb; |
  | […](/browser/sirv/trunk/sirv.php?rev=3103410#L4826) | […](/browser/sirv/trunk/sirv.php?rev=3115018#L4848) |  |
  | 4826 | 4848 | } |
  | 4827 | 4849 |  |
  |  | 4850 | if(!current\_user\_can("edit\_posts")){ |
  |  | 4851 | echo json\_encode(array('error' => 'Access to the requested resource is forbidden')); |
  |  | 4852 | wp\_die(); |
  |  | 4853 | } |
  |  | 4854 |  |
  |  | 4855 |  |
  |  | 4856 |  |
  | 4828 | 4857 | global $base\_prefix; |
  | 4829 | 4858 | global $wpdb; |
  | […](/browser/sirv/trunk/sirv.php?rev=3103410#L4854) | […](/browser/sirv/trunk/sirv.php?rev=3115018#L4883) |  |
  | 4854 | 4883 | if (!(is\_array($\_POST) && isset($\_POST['shortcodes\_page']) && defined('DOING\_AJAX') && DOING\_AJAX)) { |
  | 4855 | 4884 | return; |
  |  | 4885 | } |
  |  | 4886 |  |
  |  | 4887 | if (!sirv\_is\_allow\_ajax\_connect('sirv\_shortcodes\_page\_ajax\_validation\_nonce', 'edit\_posts')) { |
  |  | 4888 | echo json\_encode(array('error' => 'Access to the requested resource is forbidden')); |
  |  | 4889 | wp\_die(); |
  | 4856 | 4890 | } |
  | 4857 | 4891 |  |
  | […](/browser/sirv/trunk/sirv.php?rev=3103410#L4904) | […](/browser/sirv/trunk/sirv.php?rev=3115018#L4938) |  |
  | 4904 | 4938 | } |
  | 4905 | 4939 |  |
  |  | 4940 | if (!sirv\_is\_allow\_ajax\_connect('sirv\_shortcodes\_page\_ajax\_validation\_nonce', 'edit\_posts')) { |
  |  | 4941 | echo json\_encode(array('error' => 'Access to the requested resource is forbidden')); |
  |  | 4942 | wp\_die(); |
  |  | 4943 | } |
  |  | 4944 |  |
  | 4906 | 4945 | $sh\_id = intval($\_POST['shortcode\_id']); |
  | 4907 | 4946 |  |
  | […](/browser/sirv/trunk/sirv.php?rev=3103410#L4939) | […](/browser/sirv/trunk/sirv.php?rev=3115018#L4978) |  |
  | 4939 | 4978 | } |
  | 4940 | 4979 |  |
  |  | 4980 | if (!sirv\_is\_allow\_ajax\_connect('sirv\_shortcodes\_page\_ajax\_validation\_nonce', 'edit\_posts')) { |
  |  | 4981 | echo json\_encode(array('error' => 'Access to the requested resource is forbidden')); |
  |  | 4982 | wp\_die(); |
  |  | 4983 | } |
  |  | 4984 |  |
  | 4941 | 4985 | global $base\_prefix; |
  | 4942 | 4986 | global $wpdb; |
  | […](/browser/sirv/trunk/sirv.php?rev=3103410#L4975) | […](/browser/sirv/trunk/sirv.php?rev=3115018#L5019) |  |
  | 4975 | 5019 | } |
  | 4976 | 5020 |  |
  | 4977 |  | ~~global $base\_prefix;~~ |
  | 4978 |  | ~~global $wpdb;~~ |
  | 4979 |  |  |
  | 4980 |  | ~~$table\_name = $base\_prefix . 'sirv\_shortcodes';~~ |
  | 4981 |  |  |
  | 4982 |  | ~~$id = intval($\_POST['row\_id']);~~ |
  | 4983 |  | ~~$data = $\_POST['shortcode\_data'];~~ |
  | 4984 |  |  |
  | 4985 |  | ~~unset($data['isAltCaption']);~~ |
  | 4986 |  |  |
  | 4987 |  | ~~$data['images'] = serialize($data['images']);~~ |
  | 4988 |  | ~~$data['shortcode\_options'] = serialize($data['shortcode\_options']);~~ |
  | 4989 |  |  |
  | 4990 |  |  |
  | 4991 |  | ~~$row =  $wpdb->update($table\_name, $data, array('ID' => $id));~~ |
  | 4992 |  |  |
  | 4993 |  | ~~echo $row;~~ |
  | 4994 |  |  |
  | 4995 |  |  |
  | 4996 |  | ~~wp\_die();~~ |
  | 4997 |  | ~~}~~ |
  | 4998 |  |  |
  | 4999 |  |  |
  | 5000 |  | ~~//use ajax to add new folder in sirv~~ |
  | 5001 |  | ~~add\_action('wp\_ajax\_sirv\_add\_folder', 'sirv\_add\_folder');~~ |
  | 5002 |  |  |
  | 5003 |  | ~~function sirv\_add\_folder(){~~ |
  | 5004 |  |  |
  | 5005 |  | ~~if (!(is\_array($\_POST) && defined('DOING\_AJAX') && DOING\_AJAX)) {~~ |
  | 5006 |  | ~~return;~~ |
  | 5007 |  | ~~}~~ |
  | 5008 |  |  |
  | 5009 | 5021 | if (!sirv\_is\_allow\_ajax\_connect('sirv\_logic\_ajax\_validation\_nonce', 'edit\_posts')) { |
  | 5010 | 5022 | echo json\_encode(array('error' => 'Access to the requested resource is forbidden')); |
  | […](/browser/sirv/trunk/sirv.php?rev=3103410#L5012) | […](/browser/sirv/trunk/sirv.php?rev=3115018#L5024) |  |
  | 5012 | 5024 | } |
  | 5013 | 5025 |  |
  |  | 5026 | global $base\_prefix; |
  |  | 5027 | global $wpdb; |
  |  | 5028 |  |
  |  | 5029 | $table\_name = $base\_prefix . 'sirv\_shortcodes'; |
  |  | 5030 |  |
  |  | 5031 | $id = intval($\_POST['row\_id']); |
  |  | 5032 | $data = $\_POST['shortcode\_data']; |
  |  | 5033 |  |
  |  | 5034 | unset($data['isAltCaption']); |
  |  | 5035 |  |
  |  | 5036 | $data['images'] = serialize($data['images']); |
  |  | 5037 | $data['shortcode\_options'] = serialize($data['shortcode\_options']); |
  |  | 5038 |  |
  |  | 5039 |  |
  |  | 5040 | $row =  $wpdb->update($table\_name, $data, array('ID' => $id)); |
  |  | 5041 |  |
  |  | 5042 | echo $row; |
  |  | 5043 |  |
  |  | 5044 |  |
  |  | 5045 | wp\_die(); |
  |  | 5046 | } |
  |  | 5047 |  |
  |  | 5048 |  |
  |  | 5049 | //use ajax to add new folder in sirv |
  |  | 5050 | add\_action('wp\_ajax\_sirv\_add\_folder', 'sirv\_add\_folder'); |
  |  | 5051 |  |
  |  | 5052 | function sirv\_add\_folder(){ |
  |  | 5053 |  |
  |  | 5054 | if (!(is\_array($\_POST) && defined('DOING\_AJAX') && DOING\_AJAX)) { |
  |  | 5055 | return; |
  |  | 5056 | } |
  |  | 5057 |  |
  |  | 5058 | if (!sirv\_is\_allow\_ajax\_connect('sirv\_logic\_ajax\_validation\_nonce', 'edit\_posts')) { |
  |  | 5059 | echo json\_encode(array('error' => 'Access to the requested resource is forbidden')); |
  |  | 5060 | wp\_die(); |
  |  | 5061 | } |
  |  | 5062 |  |
  | 5014 | 5063 |  |
  | 5015 | 5064 | $path = $\_POST['current\_dir'] . $\_POST['new\_dir']; |
  | […](/browser/sirv/trunk/sirv.php?rev=3103410#L5025) | […](/browser/sirv/trunk/sirv.php?rev=3115018#L5074) |  |
  | 5025 | 5074 |  |
  | 5026 | 5075 | //use ajax to check customer login details |
  | 5027 |  | add\_action('wp\_ajax\_sirv\_check\_connection', 'sirv\_check\_connection', 10, 1); |
  |  | 5076 | //add\_action('wp\_ajax\_sirv\_check\_connection', 'sirv\_check\_connection', 10, 1); |
  | 5028 | 5077 | function sirv\_check\_connection(){ |
  | 5029 | 5078 |  |
  | […](/browser/sirv/trunk/sirv.php?rev=3103410#L5054) | […](/browser/sirv/trunk/sirv.php?rev=3115018#L5103) |  |
  | 5054 | 5103 | } |
  | 5055 | 5104 |  |
  | 5056 |  | if (!sirv\_is\_allow\_ajax\_connect('sirv\_rewiew\_ajax\_validation\_nonce', '~~edit~~\_options')) { |
  |  | 5105 | if (!sirv\_is\_allow\_ajax\_connect('sirv\_rewiew\_ajax\_validation\_nonce', 'manage\_options')) { |
  | 5057 | 5106 | echo json\_encode(array('error' => 'Access to the requested resource is forbidden')); |
  | 5058 | 5107 | wp\_die(); |
  | […](/browser/sirv/trunk/sirv.php?rev=3103410#L5120) | […](/browser/sirv/trunk/sirv.php?rev=3115018#L5169) |  |
  | 5120 | 5169 |  |
  | 5121 | 5170 | //use ajax to check if options is empty or not |
  | 5122 |  | add\_action('wp\_ajax\_sirv\_check\_empty\_options', 'sirv\_check\_empty\_options'); |
  |  | 5171 | //add\_action('wp\_ajax\_sirv\_check\_empty\_options', 'sirv\_check\_empty\_options'); |
  | 5123 | 5172 | function sirv\_check\_empty\_options(){ |
  | 5124 | 5173 | $account\_name = getValue::getOption('SIRV\_ACCOUNT\_NAME'); |
  | […](/browser/sirv/trunk/sirv.php?rev=3103410#L5192) | […](/browser/sirv/trunk/sirv.php?rev=3115018#L5241) |  |
  | 5192 | 5241 | } |
  | 5193 | 5242 |  |
  |  | 5243 | if (!sirv\_is\_allow\_ajax\_connect('ajax\_validation\_nonce', 'manage\_options')) { |
  |  | 5244 | echo json\_encode(array('error' => 'Access to the requested resource is forbidden')); |
  |  | 5245 | wp\_die(); |
  |  | 5246 | } |
  |  | 5247 |  |
  | 5194 | 5248 | $summary = stripcslashes($\_POST['summary']); |
  | 5195 | 5249 | $text = stripcslashes($\_POST['text']); |
  | […](/browser/sirv/trunk/sirv.php?rev=3103410#L5208) | […](/browser/sirv/trunk/sirv.php?rev=3115018#L5262) |  |
  | 5208 | 5262 | ); |
  | 5209 | 5263 |  |
  | 5210 |  | echo wp\_mail('support@sirv.com', $summary, $text, $headers); |
  |  | 5264 | $result = wp\_mail('support@sirv.com', $summary, $text, $headers); |
  |  | 5265 |  |
  |  | 5266 | echo json\_encode(array('result' => $result)); |
  | 5211 | 5267 |  |
  | 5212 | 5268 | wp\_die(); |
  | […](/browser/sirv/trunk/sirv.php?rev=3103410#L5219) | […](/browser/sirv/trunk/sirv.php?rev=3115018#L5275) |  |
  | 5219 | 5275 | if (!(is\_array($\_POST) && defined('DOING\_AJAX') && DOING\_AJAX)) { |
  | 5220 | 5276 | return; |
  |  | 5277 | } |
  |  | 5278 |  |
  |  | 5279 | if (!sirv\_is\_allow\_ajax\_connect('ajax\_validation\_nonce', 'manage\_options')) { |
  |  | 5280 | echo json\_encode(array('error' => 'Access to the requested resource is forbidden')); |
  |  | 5281 | wp\_die(); |
  | 5221 | 5282 | } |
  | 5222 | 5283 |  |
  | […](/browser/sirv/trunk/sirv.php?rev=3103410#L5275) | […](/browser/sirv/trunk/sirv.php?rev=3115018#L5336) |  |
  | 5275 | 5336 | } |
  | 5276 | 5337 |  |
  |  | 5338 | if (!sirv\_is\_allow\_ajax\_connect('ajax\_validation\_nonce', 'manage\_options')) { |
  |  | 5339 | echo json\_encode(array('error' => 'Access to the requested resource is forbidden')); |
  |  | 5340 | wp\_die(); |
  |  | 5341 | } |
  |  | 5342 |  |
  | 5277 | 5343 | $response = array(); |
  | 5278 | 5344 |  |
  | […](/browser/sirv/trunk/sirv.php?rev=3103410#L5361) | […](/browser/sirv/trunk/sirv.php?rev=3115018#L5427) |  |
  | 5361 | 5427 | return; |
  | 5362 | 5428 | } |
  |  | 5429 |  |
  |  | 5430 | if (!sirv\_is\_allow\_ajax\_connect('ajax\_validation\_nonce', 'manage\_options')) { |
  |  | 5431 | echo json\_encode(array('error' => 'Access to the requested resource is forbidden')); |
  |  | 5432 | wp\_die(); |
  |  | 5433 | } |
  |  | 5434 |  |
  | 5363 | 5435 |  |
  | 5364 | 5436 | $email = trim(strtolower($\_POST['email'])); |
  | […](/browser/sirv/trunk/sirv.php?rev=3103410#L5438) | […](/browser/sirv/trunk/sirv.php?rev=3115018#L5510) |  |
  | 5438 | 5510 | } |
  | 5439 | 5511 |  |
  |  | 5512 | if (!sirv\_is\_allow\_ajax\_connect('ajax\_validation\_nonce', 'manage\_options')) { |
  |  | 5513 | echo json\_encode(array('error' => 'Access to the requested resource is forbidden')); |
  |  | 5514 | wp\_die(); |
  |  | 5515 | } |
  |  | 5516 |  |
  | 5440 | 5517 | global $wpdb; |
  | 5441 | 5518 | $table\_name = $wpdb->prefix . 'sirv\_images'; |
  | […](/browser/sirv/trunk/sirv.php?rev=3103410#L5603) | […](/browser/sirv/trunk/sirv.php?rev=3115018#L5680) |  |
  | 5603 | 5680 | if (!(is\_array($\_POST) && isset($\_POST['type']) && defined('DOING\_AJAX') && DOING\_AJAX)) { |
  | 5604 | 5681 | return; |
  |  | 5682 | } |
  |  | 5683 |  |
  |  | 5684 | if (!sirv\_is\_allow\_ajax\_connect('ajax\_validation\_nonce', 'manage\_options')) { |
  |  | 5685 | echo json\_encode(array('error' => 'Access to the requested resource is forbidden')); |
  |  | 5686 | wp\_die(); |
  | 5605 | 5687 | } |
  | 5606 | 5688 |  |
  | […](/browser/sirv/trunk/sirv.php?rev=3103410#L5700) | […](/browser/sirv/trunk/sirv.php?rev=3115018#L5782) |  |
  | 5700 | 5782 | add\_action('wp\_ajax\_sirv\_images\_storage\_size', 'sirv\_images\_storage\_size'); |
  | 5701 | 5783 | function sirv\_images\_storage\_size(){ |
  |  | 5784 | if (!(is\_array($\_POST) && defined('DOING\_AJAX') && DOING\_AJAX)) { |
  |  | 5785 | return; |
  |  | 5786 | } |
  |  | 5787 |  |
  |  | 5788 | if (!sirv\_is\_allow\_ajax\_connect('ajax\_validation\_nonce', 'manage\_options')) { |
  |  | 5789 | echo json\_encode(array('error' => 'Access to the requested resource is forbidden')); |
  |  | 5790 | wp\_die(); |
  |  | 5791 | } |
  |  | 5792 |  |
  | 5702 | 5793 | $start\_time = time(); |
  | 5703 | 5794 | $start\_microtime = microtime(true); |
  | […](/browser/sirv/trunk/sirv.php?rev=3103410#L5755) | […](/browser/sirv/trunk/sirv.php?rev=3115018#L5846) |  |
  | 5755 | 5846 | add\_action('wp\_ajax\_sirv\_css\_images\_processing', 'sirv\_css\_images\_processing'); |
  | 5756 | 5847 | function sirv\_css\_images\_processing(){ |
  | 5757 |  | //echo sirv\_get\_css\_backimgs\_sync\_data(); |
  |  | 5848 | if (!(is\_array($\_POST) && defined('DOING\_AJAX') && DOING\_AJAX)) { |
  |  | 5849 | return; |
  |  | 5850 | } |
  |  | 5851 |  |
  |  | 5852 | if (!sirv\_is\_allow\_ajax\_connect('ajax\_validation\_nonce', 'manage\_options')) { |
  |  | 5853 | echo json\_encode(array('error' => 'Access to the requested resource is forbidden')); |
  |  | 5854 | wp\_die(); |
  |  | 5855 | } |
  |  | 5856 |  |
  | 5758 | 5857 | echo json\_encode(sirv\_get\_session\_data('sirv-css-sync-images', 'css\_sync\_data')); |
  | 5759 | 5858 |  |
  | […](/browser/sirv/trunk/sirv.php?rev=3103410#L5764) | […](/browser/sirv/trunk/sirv.php?rev=3115018#L5863) |  |
  | 5764 | 5863 | add\_action('wp\_ajax\_sirv\_css\_images\_get\_data', 'sirv\_css\_images\_get\_data'); |
  | 5765 | 5864 | function sirv\_css\_images\_get\_data(){ |
  |  | 5865 | if (!(is\_array($\_POST) && defined('DOING\_AJAX') && DOING\_AJAX)) { |
  |  | 5866 | return; |
  |  | 5867 | } |
  |  | 5868 |  |
  |  | 5869 | if (!sirv\_is\_allow\_ajax\_connect('ajax\_validation\_nonce', 'manage\_options')) { |
  |  | 5870 | echo json\_encode(array('error' => 'Access to the requested resource is forbidden')); |
  |  | 5871 | wp\_die(); |
  |  | 5872 | } |
  |  | 5873 |  |
  | 5766 | 5874 | echo json\_encode(array('css\_data' => get\_option('SIRV\_CSS\_BACKGROUND\_IMAGES'))); |
  | 5767 | 5875 |  |
  | […](/browser/sirv/trunk/sirv.php?rev=3103410#L5774) | […](/browser/sirv/trunk/sirv.php?rev=3115018#L5882) |  |
  | 5774 | 5882 | if (!(is\_array($\_POST) && defined('DOING\_AJAX') && DOING\_AJAX)) { |
  | 5775 | 5883 | return; |
  |  | 5884 | } |
  |  | 5885 |  |
  |  | 5886 | if (!sirv\_is\_allow\_ajax\_connect('ajax\_validation\_nonce', 'manage\_options')) { |
  |  | 5887 | echo json\_encode(array('error' => 'Access to the requested resource is forbidden')); |
  |  | 5888 | wp\_die(); |
  | 5776 | 5889 | } |
  | 5777 | 5890 |  |
  | […](/browser/sirv/trunk/sirv.php?rev=3103410#L5818) | […](/browser/sirv/trunk/sirv.php?rev=3115018#L5931) |  |
  | 5818 | 5931 | add\_action('wp\_ajax\_sirv\_css\_images\_proccess', 'sirv\_css\_images\_proccess'); |
  | 5819 | 5932 | function sirv\_css\_images\_proccess(){ |
  |  | 5933 | if (!(is\_array($\_POST) && defined('DOING\_AJAX') && DOING\_AJAX)) { |
  |  | 5934 | return; |
  |  | 5935 | } |
  |  | 5936 |  |
  |  | 5937 | if (!sirv\_is\_allow\_ajax\_connect('ajax\_validation\_nonce', 'manage\_options')) { |
  |  | 5938 | echo json\_encode(array('error' => 'Access to the requested resource is forbidden')); |
  |  | 5939 | wp\_die(); |
  |  | 5940 | } |
  | 5820 | 5941 |  |
  | 5821 | 5942 | $css\_sync\_data = sirv\_get\_session\_data('sirv-css-sync-images', 'css\_sync\_data'); |
  | […](/browser/sirv/trunk/sirv.php?rev=3103410#L6162) | […](/browser/sirv/trunk/sirv.php?rev=3115018#L6283) |  |
  | 6162 | 6283 |  |
  | 6163 | 6284 |  |
  | 6164 |  | add\_action('wp\_ajax\_sirv\_update\_smv\_cache\_data', 'sirv\_update\_smv\_cache\_data', 10); |
  | 6165 |  | add\_action('wp\_ajax\_nopriv\_sirv\_update\_smv\_cache\_data', 'sirv\_update\_smv\_cache\_data', 10); |
  |  | 6285 | //add\_action('wp\_ajax\_sirv\_update\_smv\_cache\_data', 'sirv\_update\_smv\_cache\_data', 10); |
  |  | 6286 | //add\_action('wp\_ajax\_nopriv\_sirv\_update\_smv\_cache\_data', 'sirv\_update\_smv\_cache\_data', 10); |
  | 6166 | 6287 |  |
  | 6167 | 6288 | function sirv\_update\_smv\_cache\_data(){ |
  | […](/browser/sirv/trunk/sirv.php?rev=3103410#L6226) | […](/browser/sirv/trunk/sirv.php?rev=3115018#L6347) |  |
  | 6226 | 6347 | if (!(is\_array($\_POST) && defined('DOING\_AJAX') && DOING\_AJAX)) { |
  | 6227 | 6348 | return; |
  |  | 6349 | } |
  |  | 6350 |  |
  |  | 6351 | if (!sirv\_is\_allow\_ajax\_connect('ajax\_validation\_nonce', 'manage\_options')) { |
  |  | 6352 | echo json\_encode(array('error' => 'Access to the requested resource is forbidden')); |
  |  | 6353 | wp\_die(); |
  | 6228 | 6354 | } |
  | 6229 | 6355 |  |
  | […](/browser/sirv/trunk/sirv.php?rev=3103410#L6302) | […](/browser/sirv/trunk/sirv.php?rev=3115018#L6428) |  |
  | 6302 | 6428 | } |
  | 6303 | 6429 |  |
  |  | 6430 | if (!sirv\_is\_allow\_ajax\_connect('ajax\_validation\_nonce', 'manage\_options')) { |
  |  | 6431 | echo json\_encode(array('error' => 'Access to the requested resource is forbidden')); |
  |  | 6432 | wp\_die(); |
  |  | 6433 | } |
  |  | 6434 |  |
  | 6304 | 6435 | $response = array('error' => '', 'status' => '', 'type' => ''); |
  | 6305 | 6436 |  |
  | […](/browser/sirv/trunk/sirv.php?rev=3103410#L6334) | […](/browser/sirv/trunk/sirv.php?rev=3115018#L6465) |  |
  | 6334 | 6465 | } |
  | 6335 | 6466 |  |
  |  | 6467 | if (!sirv\_is\_allow\_ajax\_connect('ajax\_validation\_nonce', 'manage\_options')) { |
  |  | 6468 | echo json\_encode(array('error' => 'Access to the requested resource is forbidden')); |
  |  | 6469 | wp\_die(); |
  |  | 6470 | } |
  |  | 6471 |  |
  | 6336 | 6472 | $prevented\_sizes = stripslashes($\_POST['sizes']); |
  | 6337 | 6473 |  |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3115018)
* [Zip Archive](?format=zip&new=3115018)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

