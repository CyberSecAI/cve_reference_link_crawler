

[HashiCorp Discuss](/)

# [HCSEC-2022-25 - Nomad’s Workload Identity Token Can List Non-sensitive Metadata For nomad/ Paths](/t/hcsec-2022-25-nomad-s-workload-identity-token-can-list-non-sensitive-metadata-for-nomad-paths/46167)

[Security](/c/security/52)

[security-nomad](https://discuss.hashicorp.com/tag/security-nomad)

[jfinnigan](https://discuss.hashicorp.com/u/jfinnigan)

October 28, 2022, 3:57pm

1

**Bulletin ID:** HCSEC-2022-25

**Affected Products / Versions:** Nomad and Nomad Enterprise 1.4.0 up to 1.4.1; fixed in 1.4.2.

**Publication Date:** October 28, 2022

**Summary**

A vulnerability was identified in Nomad and Nomad Enterprise (“Nomad”) such that a workload identity token can list non-sensitive metadata for paths under nomad/ that belong to other jobs in the same namespace.This vulnerability, CVE-2022-3866, was fixed in Nomad 1.4.2.

**Background**

Nomad’s [workload identity](https://developer.hashicorp.com/nomad/docs/concepts/workload-identity), introduced in Nomad 1.4, is a JWT signed by the leader’s keyring that is currently only used for template access to [Variables](https://developer.hashicorp.com/nomad/docs/concepts/variables), and not exposed outside of Nomad.

**Details**

During internal testing it was observed that a workload identity token can be used to list non-sensitive metadata for paths under nomad/ that belong to other jobs in the same namespace. The metadata consists only of the path (job/group/task name) and create/modify timestamps.

This behavior may be used by a malicious operator or third party with authenticated access to access non-sensitive information which may provide context they otherwise might not have. Nomad’s authorization logic has been modified to prevent this potential abuse scenario.

**Remediation**

Customers should evaluate the risk associated with this issue and consider upgrading to Nomad 1.4.2, or newer.

See Nomad’s [Upgrading](https://www.nomadproject.io/docs/upgrade) for general guidance on this process.

**Acknowledgement**

This issue was identified internally by the Nomad engineering team.

*We deeply appreciate any effort to coordinate disclosure of security vulnerabilities. For information about security at HashiCorp and the reporting of security vulnerabilities, please see <https://hashicorp.com/security>.*

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [HCSEC-2024-29 - Nomad Allocations Vulnerable To Privilege Escalation Within A Namespace Using Unredacted Workload Identity Token](https://discuss.hashicorp.com/t/hcsec-2024-29-nomad-allocations-vulnerable-to-privilege-escalation-within-a-namespace-using-unredacted-workload-identity-token/72119)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 159 | December 20, 2024 |
| [HCSEC-2023-08 - Nomad Job Submitter Privilege Escalation Using Workload Identity](https://discuss.hashicorp.com/t/hcsec-2023-08-nomad-job-submitter-privilege-escalation-using-workload-identity/51389)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 5257 | March 13, 2023 |
| [Workload Identity with parameterized job params?](https://discuss.hashicorp.com/t/workload-identity-with-parameterized-job-params/63495)  [Nomad](/c/nomad/28) | 0 | 110 | March 8, 2024 |
| [HCSEC-2023-09 - Nomad ACLs Can Not Deny Access to Workload's Own Variables](https://discuss.hashicorp.com/t/hcsec-2023-09-nomad-acls-can-not-deny-access-to-workloads-own-variables/51390)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 5253 | March 13, 2023 |
| [HCSEC-2024-15 - Nomad Vulnerable to Allocation Directory Path Escape Through Archive Unpacking](https://discuss.hashicorp.com/t/hcsec-2024-15-nomad-vulnerable-to-allocation-directory-path-escape-through-archive-unpacking/68781)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 1018 | July 22, 2024 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](https://meta.discourse.org/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled

