=== Content from rustsec.org_0db913e7_20250111_135354.html ===


RUSTSEC-2020-0036: failure: failure is officially deprecated/unmaintained › RustSec Advisory Database

#

[About](/)
[Advisories](/advisories/)
[Report Vulnerabilities](/contributing.html)

[History](https://github.com/RustSec/advisory-db/commits/main/crates/failure/RUSTSEC-2020-0036.md) ⋅
[Edit](https://github.com/RustSec/advisory-db/edit/main/crates/failure/RUSTSEC-2020-0036.md) ⋅
[JSON (OSV)](https://api.osv.dev/v1/vulns/RUSTSEC-2020-0036)

# RUSTSEC-2020-0036

failure is officially deprecated/unmaintained

Reported
May 2, 2020

Issued
October 1, 2020

(last modified: February 10, 2024)

Package
[failure](/packages/failure.html)
([crates.io](https://crates.io/crates/failure))

Type
INFO
Unmaintained

Aliases

* [CVE-2019-25010](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-25010)
* [CVE-2020-25575](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-25575)
* [GHSA-jq66-xh47-j9f3](https://github.com/advisories/GHSA-jq66-xh47-j9f3)
* [GHSA-r98r-j25q-rmpr](https://github.com/advisories/GHSA-r98r-j25q-rmpr)

References

* <https://github.com/rust-lang-nursery/failure/pull/347>

CVSS Score
9.8
CRITICAL

CVSS Details
Attack vectorNetwork
Attack complexityLow
Privileges requiredNone
User interactionNone
ScopeUnchanged
ConfidentialityHigh
IntegrityHigh
AvailabilityHigh

CVSS Vector
[CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)
Patched
no patched versions

### Description

The `failure` crate is officially end-of-life: it has been marked as deprecated
by the former maintainer, who has announced that there will be no updates or
maintenance work on it going forward.

The following are some suggested actively developed alternatives to switch to:

* [`anyhow`](https://crates.io/crates/anyhow)
* [`eyre`](https://crates.io/crates/eyre)
* [`fehler`](https://crates.io/crates/fehler)
* [`snafu`](https://crates.io/crates/snafu)
* [`thiserror`](https://crates.io/crates/thiserror)

Advisory available under [CC0-1.0](https://spdx.org/licenses/CC0-1.0.html)
license.



=== Content from github.com_a9420949_20250111_135353.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frust-lang-deprecated%2Ffailure%2Fissues%2F336)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frust-lang-deprecated%2Ffailure%2Fissues%2F336)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fissues%2Fshow&source=header-repo&source_repo=rust-lang-deprecated%2Ffailure)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on Aug 16, 2021. It is now read-only.

[rust-lang-deprecated](/rust-lang-deprecated)
/
**[failure](/rust-lang-deprecated/failure)**
Public archive

* [Notifications](/login?return_to=%2Frust-lang-deprecated%2Ffailure) You must be signed in to change notification settings
* [Fork
  137](/login?return_to=%2Frust-lang-deprecated%2Ffailure)
* [Star
   1.4k](/login?return_to=%2Frust-lang-deprecated%2Ffailure)

* [Code](/rust-lang-deprecated/failure)
* [Issues
  91](/rust-lang-deprecated/failure/issues)
* [Pull requests
  18](/rust-lang-deprecated/failure/pulls)
* [Actions](/rust-lang-deprecated/failure/actions)
* [Projects
  0](/rust-lang-deprecated/failure/projects)
* [Security](/rust-lang-deprecated/failure/security)
* [Insights](/rust-lang-deprecated/failure/pulse)

Additional navigation options

* [Code](/rust-lang-deprecated/failure)
* [Issues](/rust-lang-deprecated/failure/issues)
* [Pull requests](/rust-lang-deprecated/failure/pulls)
* [Actions](/rust-lang-deprecated/failure/actions)
* [Projects](/rust-lang-deprecated/failure/projects)
* [Security](/rust-lang-deprecated/failure/security)
* [Insights](/rust-lang-deprecated/failure/pulse)

# Memory safe violation by abusing `__private_get_type_id__` #336

Open

[Qwaz](/Qwaz) opened this issue
Nov 13, 2019
· 1 comment

Open

# [Memory safe violation by abusing `__private_get_type_id__`](#top) #336

[Qwaz](/Qwaz) opened this issue
Nov 13, 2019
· 1 comment

## Comments

[![@Qwaz](https://avatars.githubusercontent.com/u/5073807?s=80&u=2ce3c5e94d4fa1db409878d8812e2dfe6cb164bf&v=4)](/Qwaz)

Copy link

### **[Qwaz](/Qwaz)** commented [Nov 13, 2019](#issue-522487156)

| I noticed that it is possible to cause type confusion in downcast by manually implementing `__private_get_type_id__`.  <https://play.rust-lang.org/?version=stable&mode=debug&edition=2018&gist=ad66fe439660eb8373996bfd6bd7a835>  Although the name of the function clearly shows that it is a private API, I believe a safe Rust program should not violate the memory safety guaranteed by Rust type system. |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@Qwaz](https://avatars.githubusercontent.com/u/5073807?s=80&u=2ce3c5e94d4fa1db409878d8812e2dfe6cb164bf&v=4)](/Qwaz)

Copy link

Author

### **[Qwaz](/Qwaz)** commented [Nov 13, 2019](#issuecomment-553629161)

| Actually, the bug here looks very similar to what happened to the standard library: <https://rustsec.org/advisories/CVE-2019-12083.html> |
| --- |

All reactions

Sorry, something went wrong.

[Qwaz](/Qwaz)
added a commit
to Qwaz/advisory-db
that referenced
this issue
[Jun 28, 2020](#ref-commit-07b145d)
[![@Qwaz](https://avatars.githubusercontent.com/u/5073807?s=40&u=2ce3c5e94d4fa1db409878d8812e2dfe6cb164bf&v=4)](/Qwaz)

`[Informational advisory for](/Qwaz/advisory-db/commit/07b145d26c49873034ddfc03cacbea7bcbddf907 "Informational advisory for rust-lang-nursery/failure#336") [rust-lang-deprecated/failure#336](https://github.com/rust-lang-deprecated/failure/issues/336)`

`[07b145d](/Qwaz/advisory-db/commit/07b145d26c49873034ddfc03cacbea7bcbddf907)`

[Qwaz](/Qwaz)
added a commit
to Qwaz/advisory-db
that referenced
this issue
[Jun 28, 2020](#ref-commit-f81972e)
[![@Qwaz](https://avatars.githubusercontent.com/u/5073807?s=40&u=2ce3c5e94d4fa1db409878d8812e2dfe6cb164bf&v=4)](/Qwaz)

`[Informational advisory for](/Qwaz/advisory-db/commit/f81972e8c465a3a205bd58f2062d06c48258942d "Informational advisory for rust-lang-nursery/failure#336") [rust-lang-deprecated/failure#336](https://github.com/rust-lang-deprecated/failure/issues/336)`

`[f81972e](/Qwaz/advisory-db/commit/f81972e8c465a3a205bd58f2062d06c48258942d)`

[![@Qwaz](https://avatars.githubusercontent.com/u/5073807?s=40&u=2ce3c5e94d4fa1db409878d8812e2dfe6cb164bf&v=4)](/Qwaz)
[Qwaz](/Qwaz)
mentioned this issue
[Jun 29, 2020](#ref-pullrequest-647121056)

[Informational advisory for rust-lang-nursery/failure#336
rustsec/advisory-db#318](/rustsec/advisory-db/pull/318)
 Merged

[Shnatsel](/Shnatsel)
added a commit
to rustsec/advisory-db
that referenced
this issue
[Aug 14, 2020](#ref-commit-1837ccc)
[![@Shnatsel](https://avatars.githubusercontent.com/u/291257?s=40&u=6d52ad6b671a922da249dd410c15ba2634eee3a4&v=4)](/Shnatsel)

`[Merge pull request](/rustsec/advisory-db/commit/1837ccc396b2a6274edb3e1342fc733f38019437 "Merge pull request #318 from Qwaz/failure-336

Informational advisory for rust-lang-nursery/failure#336") [#318](https://github.com/rustsec/advisory-db/pull/318) [from Qwaz/failure-336](/rustsec/advisory-db/commit/1837ccc396b2a6274edb3e1342fc733f38019437 "Merge pull request #318 from Qwaz/failure-336

Informational advisory for rust-lang-nursery/failure#336")`
…

`[1837ccc](/rustsec/advisory-db/commit/1837ccc396b2a6274edb3e1342fc733f38019437)`

```
Informational advisory for [rust-lang-deprecated/failure#336](https://github.com/rust-lang-deprecated/failure/issues/336)
```

This was referenced Mar 10, 2021

[address issues related to third-party library: proc-maps
microsoft/onefuzz#655](/microsoft/onefuzz/issues/655)

Closed

[ignore RUSTSEC-2019-0036
microsoft/onefuzz#656](/microsoft/onefuzz/pull/656)
 Merged

[![@roblabla](https://avatars.githubusercontent.com/u/1069318?s=40&v=4)](/roblabla)
[roblabla](/roblabla)
mentioned this issue
[Aug 27, 2021](#ref-issue-981068971)

[Release new version without failure dep
aisk/rust-ping#2](/aisk/rust-ping/issues/2)

Closed

This was referenced Jun 10, 2022

[Remove 'failure' dep in favor of 'thiserror'
japaric/rustc-cfg#15](/japaric/rustc-cfg/pull/15)
 Merged

[Replace 'failure' dep with 'thiserror'
japaric/cargo-project#13](/japaric/cargo-project/pull/13)
 Merged

[![@8573](https://avatars.githubusercontent.com/u/3662816?s=40&v=4)](/8573)
[8573](/8573)
mentioned this issue
[Jun 26, 2022](#ref-issue-1284847596)

[RUSTSEC-2020-0036 is informational. Is it really also "CRITICAL"?
rustsec/advisory-db#1270](/rustsec/advisory-db/issues/1270)

Closed

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
mentioned this issue
[May 27, 2023](#ref-issue-1728448677)

[RUSTSEC-2019-0036: Type confusion if \_\_private\_get\_type\_id\_\_ is overridden
stackabletech/zookeeper-operator#690](/stackabletech/zookeeper-operator/issues/690)

Open

[![@Allen-Webb](https://avatars.githubusercontent.com/u/35739080?s=40&v=4)](/Allen-Webb)
[Allen-Webb](/Allen-Webb)
mentioned this issue
[Jun 22, 2023](#ref-issue-1248232265)

[dependency failure is deprecated
mtp401/protoc-grpcio#40](/mtp401/protoc-grpcio/issues/40)

Open

[![@tamird](https://avatars.githubusercontent.com/u/1535036?s=40&v=4)](/tamird)
[tamird](/tamird)
mentioned this issue
[Aug 9, 2023](#ref-pullrequest-1843970388)

[Remove 'failure' in favor of 'anyhow'
aya-rs/rustc-llvm-proxy#21](/aya-rs/rustc-llvm-proxy/pull/21)
 Merged

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
mentioned this issue
[Nov 26, 2023](#ref-issue-2010836589)

[RUSTSEC-2019-0036: Type confusion if \_\_private\_get\_type\_id\_\_ is overridden
Wenzel/xenctrl#54](/Wenzel/xenctrl/issues/54)

Open

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
mentioned this issue
[Nov 9, 2024](#ref-issue-2645430980)

[RUSTSEC-2019-0036: Type confusion if \_\_private\_get\_type\_id\_\_ is overridden
witnet/witnet-rust#2511](/witnet/witnet-rust/issues/2511)

Open

[Sign up for free](/join?source=comment-repo)
**to subscribe to this conversation on GitHub**.
Already have an account?
[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frust-lang-deprecated%2Ffailure%2Fissues%2F336).

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

1 participant

[![@Qwaz](https://avatars.githubusercontent.com/u/5073807?s=52&v=4)](/Qwaz)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from boats.gitlab.io_ad8f47a0_20250111_135352.html ===

Toggle navigation

[withoutblogs](https://boats.gitlab.io/blog/)

* [Blog](/blog/ "Blog")
* [About](/blog/page/about/ "About")
* [Tags](/blog/tags "Tags")

# From failure to Fehler

Posted on April 6, 2020

About two and a half years ago I wrote a Rust library called [`failure`](https://crates.io/crates/failure), which quickly became one of
the most popular error handling libraries in Rust. This week, its current maintainer decided to
deprecate it, a decision I strongly support. This week, I also released a new and very different
error-handling library, called [`fehler`](https://crates.io/crates/fehler). I wanted to discuss these two libraries briefly.

# A brief history of failure

When I released failure, the most popular error handling library by far was [`error-chain`](https://crates.io/crates/error-chain).
The only other major error handling library at the time really was a library called
[`quick-error`](https://crates.io/crates/quick-error). Both of these libraries had the same basic API: using a macro\_rules
macro, the user could enumerate all of the different kinds of errors that occur in their program to
create a big error enum.

For me, the syntax of error-chain was quite confusing, and I found it verbose and overly complex for
the kinds of code I was writing. My experience was that at the application level, most users are not
using errors in a way in which they frequently need to match on them and handle each case
differently. Instead, my experience was that most applications followed a common pattern:

* Fallible code is very common, but errors are not (that is, the code that returns `Result` may be
  in your hot path, but the `Error` branch will not be)
* Many different kinds of errors can occur during program execution, all of them are handled in the
  same way
* The way that they are handled is completely agnostic to the kind error, usually some kind of
  reporting mechanism is involved, perhaps some sort of backpressure (in network applications).

The central idea of `failure` then was to use a trait object to model the error type, instead of
enum. I’m not the person who came up with this: it was how the `Error` trait in std was always
intended to be used. All I did was investigate why people weren’t already using the Error trait in
its intended way. I came up with these conclusions:

* People often want their errors to contain backtraces, because they may need to debug the condition
  if it represents a programmer mistake.
* The `Error::description` method had almost no utility.
* People often need their errors to be Send, Sync, and ‘static.
* People sometimes do need to examine the specific error type, which requires downcasting, which
  also requires `'static`. The `Error::cause` method, for example, returns an object which cannot be
  downcast because it isn’t bound by `'static`.
* No one feels good writing `-> Result<(), Box<dyn Error + Send + Sync + 'static>>`.

Thus was born the `Fail` trait, a “fixed” Error trait. At the same time, failure provided an
`Error` type which was essentially a `Box<dyn Fail>` with some special features. A quick and easy
derive for `Fail` was provided to avoid the complex macro syntax of earlier libraries. Adoption was
widespread and rapid.

## Failure’s fatal flaw

The big problem with failure was that it required that everyone buy into a new error trait,
`failure::Fail`. This created compatibility hazards with people who weren’t using failure, resulting
in various frustrating experiences. When I wrote failure, I expected a “fixed” error trait to be
added to std somewhere, that would be identical to failure, so that failure could ultimately just
re-export that trait as `failure::Fail`.

However, in the long run, things turned out differently. In the end, I made changes to the `Error`
trait itself, as described in [RFC 2504](https://github.com/rust-lang/rfcs/blob/master/text/2504-fix-error.md). This meant there was no story for making failure
compatible with the std ecosystem.

In the end, many more error libraries have arisen since failure. [snafu](https://crates.io/crates/snafu) for example is a bit
of a spiritual successor to error-chain, but using proc macros. The crate I would recommend to
anyone who likes failure’s API is [anyhow](https://crates.io/crates/anyhow), which basically provides the `failure::Error`
type (a fancy trait object), but based on the std `Error` trait instead of on.

In general, for most libraries I would recommend just manually creating error types and implementing
the Error trait for them. If this is too complicated, consider why your API is throwing so many
different kinds of errors, and whether your library is doing too many things.

For applications, I recommend using a trait object, rather than an enum, to manage your many kinds
of errors. I believe that usually trying to enumerate all of the errors every library you use can
throw is more trouble than its worth, and I still assert that for most applications this will lead
to higher performance by keeping the happy path less pessimized. I recommend `anyhow::Error` as a
strictly better trait object than `Box<dyn Error + Send + Sync + 'static>`, not to mention one that
is much easier to deal with.

## But about Fehler

When I wrote failure, I also had a vision for syntactic changes to Rust that would make error
handling more lightweight. What I like about the `Result` type in Rust is that any function which
can raise an error must be annotated as such, at both the definition side *and* the call site. This
is a great feature, that I would never want to lose, because it allows users to identify all points
of early return in their functions (i.e. marking fallible function calls with `?` is an amazing
feature).

What I don’t like about Rust’s error handling story is the impact writing a fallible function has on
all of the unfallible return paths. I do not find that I benefit from writing loads of boilerplate
`Ok()` expressions. I would prefer a syntax in which I could treat functions as existing only in the
happy path *until I need to inspect their fallibility*.

This viewpoint is very controversial, and I have no capacity to debate it with anyone who disagrees
with me. But Rust has a very powerful macro system, so I don’t have to.

Fehler is a library which provides two macros: an attribute called `#[throws]` and an expression
macro called `throw!()`. In functions annotated with `throws`, all returns are on the “Ok” happy
path:

```
#[throws(io::Error)]
fn read_to_string(path: &impl AsRef<Path>) -> String {
    let mut file = File::open(path)?:
    let mut string = String::new();
    file.read_to_string(&mut string)?;
    string // Ok wrapping not necessary
}

```

If you do want to raise an error in this context, you can, using the `throw` macro:

```
#[throws(io::Error)]
fn read_to_string(path: &impl AsRef<Path>) -> String {
    let mut file = File::open(path)?:
    let mut string = String::new();
    file.read_to_string(&mut string)?;

    if string.len() == 0 {
        throw!(io::Error::new(io::ErrorKind::Other, "empty file"));
    }

    string
}

```

This syntax also supports functions that return Option and some other features, if you want to know
more you can [read the docs](https://docs.rs/fehler/1.0.0/fehler/).

I’ve been using Fehler in a personal project for the last two months, and I love it. My only issue
with it has been some bad error messages on parse errors that aren’t processed well because it’s a
proc macro. I am as convinced as I ever have been that this would be a great addition to Rust. I
would encourage anyone else who would like to try writing Rust with syntax like this to use this
library and get a feel for how it works. So much of the discussion around error-handling in Rust has
been deeply ideological and ungrounded in specific experience: this library provides a way to get an
understanding beyond that.

Besides, I have no interest in pushing any further improvement to Rust’s error handling syntax,
because of what an enormous drain every attempt to improve that feature has ever been. So I’m very
happy to have fehler, which I will keep using in all of my projects, without having to convince
anyone else that it’s a good idea.

* [← Previous Post](https://boats.gitlab.io/blog/post/vulnerabilities/ "What constitutes a vulnerability?")
* [Next Post →](https://boats.gitlab.io/blog/post/why-ok-wrapping/ "A brief apology of Ok-Wrapping")

boats
 •
2020
 •
[withoutblogs](https://boats.gitlab.io/blog/)

[Hugo v0.26](http://gohugo.io) powered  •  Theme by [Beautiful Jekyll](http://deanattali.com/beautiful-jekyll/) adapted to [Beautiful Hugo](https://github.com/halogenica/beautifulhugo)


