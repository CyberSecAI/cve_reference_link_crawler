
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flouislam%2Fuptime-kuma%2Fsecurity%2Fadvisories%2FGHSA-g9v2-wqcj-j99g)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flouislam%2Fuptime-kuma%2Fsecurity%2Fadvisories%2FGHSA-g9v2-wqcj-j99g)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=louislam%2Fuptime-kuma)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[louislam](/louislam)
/
**[uptime-kuma](/louislam/uptime-kuma)**
Public

* [Notifications](/login?return_to=%2Flouislam%2Fuptime-kuma) You must be signed in to change notification settings
* [Fork
  5.6k](/login?return_to=%2Flouislam%2Fuptime-kuma)
* [Star
   62.4k](/login?return_to=%2Flouislam%2Fuptime-kuma)

* [Code](/louislam/uptime-kuma)
* [Issues
  667](/louislam/uptime-kuma/issues)
* [Pull requests
  100](/louislam/uptime-kuma/pulls)
* [Actions](/louislam/uptime-kuma/actions)
* [Wiki](/louislam/uptime-kuma/wiki)
* [Security](/louislam/uptime-kuma/security)
* [Insights](/louislam/uptime-kuma/pulse)

Additional navigation options

* [Code](/louislam/uptime-kuma)
* [Issues](/louislam/uptime-kuma/issues)
* [Pull requests](/louislam/uptime-kuma/pulls)
* [Actions](/louislam/uptime-kuma/actions)
* [Wiki](/louislam/uptime-kuma/wiki)
* [Security](/louislam/uptime-kuma/security)
* [Insights](/louislam/uptime-kuma/pulse)

# Persistentent User Sessions

Moderate

[louislam](/louislam)
published
GHSA-g9v2-wqcj-j99g
Oct 9, 2023

## Package

docker

louislam/uptime-kuma
([Docker](/advisories?query=ecosystem%3Adocker))

## Affected versions

<= v1.23.2

## Patched versions

v1.23.3

louislam/uptime-kuma
(Node.js)

<= v1.23.2

v1.23.3

## Description

# Summary

Attackers with access to a users' device can gain persistent account access.

This is caused by missing verification of Session Tokens after password changes and/or elapsed inactivity-periods.

# Details

`uptime-kuma` sets JWT tokens for users after successful authentication.

These tokens have the following design flaws:

* After successful login, a JWT token and it is stored in `sessionStorage` or `localStorage`.

  Which of the two is decided based on the `Remember Me` button.

  The users' token is valid without any time limitation, even after long periods of inactivity.

  This increases the risk of session hijacking if, for example, a user forgets to log off and leaves the PC.
* sessions are only deleted on the client side after a user loggs out, meaning a local attacker could reuse said token with deep system access over the browser
* If a user changes a password
  + any previously logged in clients are not logged out
  + previously issued tokens remained valid forever

These flaws allow user cookies to remain valid even after changing passwords or being inactive, posing a high security risk.

# POC

### Password resets not deactivating cookies

* Log in.
* Note the user cookie.
* Change your password.
* Attempt to log in again with the same cookie.
* The cookie remains valid despite the password change.

### Inactivity not deactivating sessions

In testing, even after a period of over a day of inactivity, the session was still valid

# Impact

Another person with local access to the device could take over the session permanently, even after hours of previous inactivity or a password change.

Such activity would not be obvious to the user (see [#3481](https://github.com/louislam/uptime-kuma/issues/3481) if you want to help with this).

With this gained account access, an attacker can cause:

## confidentially loss

* monitors (including private ones not shared on public status pages)
* notification providers
* settings like `api-keys` (only used for accessing `/metrics`)
* settings like secrets like the `Steam API Key`
* maintenance periods

## availability loss

* by creating a lot of monitors and setting the retention policy very high leading to degraded database performance or out of storage
* by creating a lot of `HTTP(s) - Browser Engine (Chrome/Chromium) (Beta)` leading to RAM exhaustion

## integrity loss

* by the attacker deleting a monitor
* by the attacker deleting a monitor's history
* by the atacker changing the meaning of a monitor (changing where it points)

## scope creep

If operated in some restricted network, access to monitors may provide the ability to change the scope of the attack to a different piece of infrastructure, for example via SQL commands to a database server.

We have not classified this as `changed scope` because credentials stored in the application for accessing other systems are existing valid paths across the trust boundary, and the user should be aware of that.

### Severity

Moderate

6.7

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Local

Attack complexity
Low

Privileges required
High

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H

### CVE ID

CVE-2023-44400

### Weaknesses

[CWE-565](/advisories?query=cwe%3A565) [CWE-602](/advisories?query=cwe%3A602) [CWE-784](/advisories?query=cwe%3A784)

### Credits

* [![@Nansess](https://avatars.githubusercontent.com/u/75940580?s=40&v=4)](/Nansess)
  [Nansess](/Nansess)
  Reporter
* [![@dj4oC](https://avatars.githubusercontent.com/u/115982880?s=40&v=4)](/dj4oC)
  [dj4oC](/dj4oC)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

