- **Root cause of vulnerability:** The user interface displays HTML logs of synthetic tests, which are generated on the host where the test is executed. This allows an attacker with access to the host to inject malicious JavaScript code into these logs.
- **Weaknesses/vulnerabilities present:** Cross-Site Scripting (XSS) vulnerability due to unsanitized display of HTML logs.
- **Impact of exploitation:** An attacker could inject malicious JavaScript code into the logs, which could then be executed in the context of a user's browser when viewing the logs through the Checkmk UI. This could allow the attacker to hijack the log to display a fake login page or perform other malicious actions, though the logs are now rendered sandboxed to prevent direct access to the surrounding Checkmk site.
- **Attack vectors:** A malicious actor with access to the host where the synthetic test is executed injects malicious code into the HTML logs before they are transferred to the monitoring server.
- **Required attacker capabilities/position:** The attacker needs access to the host where the synthetic test is executed to manipulate the generated HTML logs.