

| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=c8ffe2d4d37a05ce18c71b87421443c16f8475e5)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=c8ffe2d4d37a05ce18c71b87421443c16f8475e5)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c8ffe2d4d37a05ce18c71b87421443c16f8475e5)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c8ffe2d4d37a05ce18c71b87421443c16f8475e5)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Jeongjun Park <aha310510@gmail.com> | 2024-08-31 14:47:02 +0900 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-09-12 11:12:58 +0200 |
| commit | [c8ffe2d4d37a05ce18c71b87421443c16f8475e5](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c8ffe2d4d37a05ce18c71b87421443c16f8475e5) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=c8ffe2d4d37a05ce18c71b87421443c16f8475e5)) | |
| tree | [5555eb40661d3237c640528d658fab11ba92a2eb](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=c8ffe2d4d37a05ce18c71b87421443c16f8475e5) | |
| parent | [e454476c44524024fd98e3fea1a488c8fca45bea](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e454476c44524024fd98e3fea1a488c8fca45bea) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c8ffe2d4d37a05ce18c71b87421443c16f8475e5&id2=e454476c44524024fd98e3fea1a488c8fca45bea)) | |
| download | [linux-c8ffe2d4d37a05ce18c71b87421443c16f8475e5.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-c8ffe2d4d37a05ce18c71b87421443c16f8475e5.tar.gz) | |

bpf: add check for invalid name in btf\_name\_valid\_section()[ Upstream commit bb6705c3f93bed2af03d43691743d4c43e3c8e6f ]
If the length of the name string is 1 and the value of name[0] is NULL
byte, an OOB vulnerability occurs in btf\_name\_valid\_section() and the
return value is true, so the invalid name passes the check.
To solve this, you need to check if the first position is NULL byte and
if the first character is printable.
Suggested-by: Eduard Zingerman <eddyz87@gmail.com>
Fixes: bd70a8fb7ca4 ("bpf: Allow all printable characters in BTF DATASEC names")
Signed-off-by: Jeongjun Park <aha310510@gmail.com>
Link: [https://lore.kernel.org/r/20240831054702.364455-1-aha310510@gmail.com](https://lore.kernel.org/r/20240831054702.364455-1-aha310510%40gmail.com)
Signed-off-by: Alexei Starovoitov <ast@kernel.org>
Acked-by: Eduard Zingerman <eddyz87@gmail.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c8ffe2d4d37a05ce18c71b87421443c16f8475e5)

| -rw-r--r-- | [kernel/bpf/btf.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/kernel/bpf/btf.c?id=c8ffe2d4d37a05ce18c71b87421443c16f8475e5) | 4 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 3 insertions, 1 deletions

| diff --git a/kernel/bpf/btf.c b/kernel/bpf/btf.cindex fe360b5b211d11..2f157ffbc67cea 100644--- a/[kernel/bpf/btf.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/kernel/bpf/btf.c?id=e454476c44524024fd98e3fea1a488c8fca45bea)+++ b/[kernel/bpf/btf.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/kernel/bpf/btf.c?id=c8ffe2d4d37a05ce18c71b87421443c16f8475e5)@@ -817,9 +817,11 @@ static bool btf\_name\_valid\_section(const struct btf \*btf, u32 offset) const char \*src = btf\_str\_by\_offset(btf, offset); const char \*src\_limit; + if (!\*src)+ return false;+ /\* set a limit on identifier length \*/ src\_limit = src + KSYM\_NAME\_LEN;- src++; while (\*src && src < src\_limit) { if (!isprint(\*src)) return false; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 13:59:30 +0000

