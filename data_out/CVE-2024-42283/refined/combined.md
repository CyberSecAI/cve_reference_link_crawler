=== Content from git.kernel.org_172c5337_20250110_104819.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=7704460acd7f5d35eb07c52500987dc9b95313fb)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=7704460acd7f5d35eb07c52500987dc9b95313fb)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=7704460acd7f5d35eb07c52500987dc9b95313fb)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=7704460acd7f5d35eb07c52500987dc9b95313fb)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Petr Machata <petrm@nvidia.com> | 2024-07-23 18:04:16 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-08-03 08:54:38 +0200 |
| commit | [7704460acd7f5d35eb07c52500987dc9b95313fb](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=7704460acd7f5d35eb07c52500987dc9b95313fb) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=7704460acd7f5d35eb07c52500987dc9b95313fb)) | |
| tree | [461f45185e4c8a4445b5cd4696669ae7250d6959](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=7704460acd7f5d35eb07c52500987dc9b95313fb) | |
| parent | [4384135d22174c3e52a3947f3f1e520bfa82fe79](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=4384135d22174c3e52a3947f3f1e520bfa82fe79) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=7704460acd7f5d35eb07c52500987dc9b95313fb&id2=4384135d22174c3e52a3947f3f1e520bfa82fe79)) | |
| download | [linux-7704460acd7f5d35eb07c52500987dc9b95313fb.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-7704460acd7f5d35eb07c52500987dc9b95313fb.tar.gz) | |

net: nexthop: Initialize all fields in dumped nexthops[ Upstream commit 6d745cd0e9720282cd291d36b9db528aea18add2 ]
struct nexthop\_grp contains two reserved fields that are not initialized by
nla\_put\_nh\_group(), and carry garbage. This can be observed e.g. with
strace (edited for clarity):
# ip nexthop add id 1 dev lo
# ip nexthop add id 101 group 1
# strace -e recvmsg ip nexthop get id 101
...
recvmsg(... [{nla\_len=12, nla\_type=NHA\_GROUP},
[{id=1, weight=0, resvd1=0x69, resvd2=0x67}]] ...) = 52
The fields are reserved and therefore not currently used. But as they are, they
leak kernel memory, and the fact they are not just zero complicates repurposing
of the fields for new ends. Initialize the full structure.
Fixes: 430a049190de ("nexthop: Add support for nexthop groups")
Signed-off-by: Petr Machata <petrm@nvidia.com>
Reviewed-by: Ido Schimmel <idosch@nvidia.com>
Reviewed-by: Eric Dumazet <edumazet@google.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=7704460acd7f5d35eb07c52500987dc9b95313fb)

| -rw-r--r-- | [net/ipv4/nexthop.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/ipv4/nexthop.c?id=7704460acd7f5d35eb07c52500987dc9b95313fb) | 7 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 3 deletions

| diff --git a/net/ipv4/nexthop.c b/net/ipv4/nexthop.cindex bbff68b5b5d4a1..8d41b039421976 100644--- a/[net/ipv4/nexthop.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ipv4/nexthop.c?id=4384135d22174c3e52a3947f3f1e520bfa82fe79)+++ b/[net/ipv4/nexthop.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ipv4/nexthop.c?id=7704460acd7f5d35eb07c52500987dc9b95313fb)@@ -676,9 +676,10 @@ static int nla\_put\_nh\_group(struct sk\_buff \*skb, struct nh\_group \*nhg)  p = nla\_data(nla); for (i = 0; i < nhg->num\_nh; ++i) {- p->id = nhg->nh\_entries[i].nh->id;- p->weight = nhg->nh\_entries[i].weight - 1;- p += 1;+ \*p++ = (struct nexthop\_grp) {+ .id = nhg->nh\_entries[i].nh->id,+ .weight = nhg->nh\_entries[i].weight - 1,+ }; }  if (nhg->resilient && nla\_put\_nh\_group\_res(skb, nhg)) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 10:46:56 +0000



=== Content from git.kernel.org_f8ab1cf5_20250110_104817.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=1377de719652d868f5317ba8398b7e74c5f0430b)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=1377de719652d868f5317ba8398b7e74c5f0430b)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=1377de719652d868f5317ba8398b7e74c5f0430b)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=1377de719652d868f5317ba8398b7e74c5f0430b)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Petr Machata <petrm@nvidia.com> | 2024-07-23 18:04:16 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-08-03 08:49:50 +0200 |
| commit | [1377de719652d868f5317ba8398b7e74c5f0430b](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=1377de719652d868f5317ba8398b7e74c5f0430b) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=1377de719652d868f5317ba8398b7e74c5f0430b)) | |
| tree | [af86ebfe86f4d3ddce10f19fd9bb043ed8b5f1ea](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=1377de719652d868f5317ba8398b7e74c5f0430b) | |
| parent | [34e8acc92699b6e4e949f27936cdbc22447286c0](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=34e8acc92699b6e4e949f27936cdbc22447286c0) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=1377de719652d868f5317ba8398b7e74c5f0430b&id2=34e8acc92699b6e4e949f27936cdbc22447286c0)) | |
| download | [linux-1377de719652d868f5317ba8398b7e74c5f0430b.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-1377de719652d868f5317ba8398b7e74c5f0430b.tar.gz) | |

net: nexthop: Initialize all fields in dumped nexthops[ Upstream commit 6d745cd0e9720282cd291d36b9db528aea18add2 ]
struct nexthop\_grp contains two reserved fields that are not initialized by
nla\_put\_nh\_group(), and carry garbage. This can be observed e.g. with
strace (edited for clarity):
# ip nexthop add id 1 dev lo
# ip nexthop add id 101 group 1
# strace -e recvmsg ip nexthop get id 101
...
recvmsg(... [{nla\_len=12, nla\_type=NHA\_GROUP},
[{id=1, weight=0, resvd1=0x69, resvd2=0x67}]] ...) = 52
The fields are reserved and therefore not currently used. But as they are, they
leak kernel memory, and the fact they are not just zero complicates repurposing
of the fields for new ends. Initialize the full structure.
Fixes: 430a049190de ("nexthop: Add support for nexthop groups")
Signed-off-by: Petr Machata <petrm@nvidia.com>
Reviewed-by: Ido Schimmel <idosch@nvidia.com>
Reviewed-by: Eric Dumazet <edumazet@google.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=1377de719652d868f5317ba8398b7e74c5f0430b)

| -rw-r--r-- | [net/ipv4/nexthop.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/ipv4/nexthop.c?id=1377de719652d868f5317ba8398b7e74c5f0430b) | 7 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 3 deletions

| diff --git a/net/ipv4/nexthop.c b/net/ipv4/nexthop.cindex be5498f5dd3192..bba955d82f7230 100644--- a/[net/ipv4/nexthop.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ipv4/nexthop.c?id=34e8acc92699b6e4e949f27936cdbc22447286c0)+++ b/[net/ipv4/nexthop.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ipv4/nexthop.c?id=1377de719652d868f5317ba8398b7e74c5f0430b)@@ -676,9 +676,10 @@ static int nla\_put\_nh\_group(struct sk\_buff \*skb, struct nh\_group \*nhg)  p = nla\_data(nla); for (i = 0; i < nhg->num\_nh; ++i) {- p->id = nhg->nh\_entries[i].nh->id;- p->weight = nhg->nh\_entries[i].weight - 1;- p += 1;+ \*p++ = (struct nexthop\_grp) {+ .id = nhg->nh\_entries[i].nh->id,+ .weight = nhg->nh\_entries[i].weight - 1,+ }; }  if (nhg->resilient && nla\_put\_nh\_group\_res(skb, nhg)) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 10:46:54 +0000



=== Content from git.kernel.org_d4b5aa7b_20250110_104818.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=5cc4d71dda2dd4f1520f40e634a527022e48ccd8)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=5cc4d71dda2dd4f1520f40e634a527022e48ccd8)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=5cc4d71dda2dd4f1520f40e634a527022e48ccd8)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=5cc4d71dda2dd4f1520f40e634a527022e48ccd8)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Petr Machata <petrm@nvidia.com> | 2024-07-23 18:04:16 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-08-19 05:41:04 +0200 |
| commit | [5cc4d71dda2dd4f1520f40e634a527022e48ccd8](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=5cc4d71dda2dd4f1520f40e634a527022e48ccd8) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=5cc4d71dda2dd4f1520f40e634a527022e48ccd8)) | |
| tree | [6e524271db90245699047d92811bba958da85c04](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=5cc4d71dda2dd4f1520f40e634a527022e48ccd8) | |
| parent | [dc2a655437c47c53373c4b6970ecaf2aa32d07cd](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=dc2a655437c47c53373c4b6970ecaf2aa32d07cd) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=5cc4d71dda2dd4f1520f40e634a527022e48ccd8&id2=dc2a655437c47c53373c4b6970ecaf2aa32d07cd)) | |
| download | [linux-5cc4d71dda2dd4f1520f40e634a527022e48ccd8.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-5cc4d71dda2dd4f1520f40e634a527022e48ccd8.tar.gz) | |

net: nexthop: Initialize all fields in dumped nexthops[ Upstream commit 6d745cd0e9720282cd291d36b9db528aea18add2 ]
struct nexthop\_grp contains two reserved fields that are not initialized by
nla\_put\_nh\_group(), and carry garbage. This can be observed e.g. with
strace (edited for clarity):
# ip nexthop add id 1 dev lo
# ip nexthop add id 101 group 1
# strace -e recvmsg ip nexthop get id 101
...
recvmsg(... [{nla\_len=12, nla\_type=NHA\_GROUP},
[{id=1, weight=0, resvd1=0x69, resvd2=0x67}]] ...) = 52
The fields are reserved and therefore not currently used. But as they are, they
leak kernel memory, and the fact they are not just zero complicates repurposing
of the fields for new ends. Initialize the full structure.
Fixes: 430a049190de ("nexthop: Add support for nexthop groups")
Signed-off-by: Petr Machata <petrm@nvidia.com>
Reviewed-by: Ido Schimmel <idosch@nvidia.com>
Reviewed-by: Eric Dumazet <edumazet@google.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=5cc4d71dda2dd4f1520f40e634a527022e48ccd8)

| -rw-r--r-- | [net/ipv4/nexthop.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/ipv4/nexthop.c?id=5cc4d71dda2dd4f1520f40e634a527022e48ccd8) | 7 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 3 deletions

| diff --git a/net/ipv4/nexthop.c b/net/ipv4/nexthop.cindex 7a0102a4b1de7e..a508fd94b8be0b 100644--- a/[net/ipv4/nexthop.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ipv4/nexthop.c?id=dc2a655437c47c53373c4b6970ecaf2aa32d07cd)+++ b/[net/ipv4/nexthop.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ipv4/nexthop.c?id=5cc4d71dda2dd4f1520f40e634a527022e48ccd8)@@ -210,9 +210,10 @@ static int nla\_put\_nh\_group(struct sk\_buff \*skb, struct nh\_group \*nhg)  p = nla\_data(nla); for (i = 0; i < nhg->num\_nh; ++i) {- p->id = nhg->nh\_entries[i].nh->id;- p->weight = nhg->nh\_entries[i].weight - 1;- p += 1;+ \*p++ = (struct nexthop\_grp) {+ .id = nhg->nh\_entries[i].nh->id,+ .weight = nhg->nh\_entries[i].weight - 1,+ }; }  return 0; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 10:46:55 +0000



=== Content from git.kernel.org_9f36d8a8_20250110_104820.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=a13d3864b76ac87085ec530b2ff8e37482a63a96)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=a13d3864b76ac87085ec530b2ff8e37482a63a96)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a13d3864b76ac87085ec530b2ff8e37482a63a96)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=a13d3864b76ac87085ec530b2ff8e37482a63a96)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Petr Machata <petrm@nvidia.com> | 2024-07-23 18:04:16 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-08-03 09:01:03 +0200 |
| commit | [a13d3864b76ac87085ec530b2ff8e37482a63a96](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a13d3864b76ac87085ec530b2ff8e37482a63a96) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=a13d3864b76ac87085ec530b2ff8e37482a63a96)) | |
| tree | [43c2478af008ab924b94f629efa3559175c7908d](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=a13d3864b76ac87085ec530b2ff8e37482a63a96) | |
| parent | [fa938b04359f0f292f0d3ba26f508d8dcbbeb672](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=fa938b04359f0f292f0d3ba26f508d8dcbbeb672) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=a13d3864b76ac87085ec530b2ff8e37482a63a96&id2=fa938b04359f0f292f0d3ba26f508d8dcbbeb672)) | |
| download | [linux-a13d3864b76ac87085ec530b2ff8e37482a63a96.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-a13d3864b76ac87085ec530b2ff8e37482a63a96.tar.gz) | |

net: nexthop: Initialize all fields in dumped nexthops[ Upstream commit 6d745cd0e9720282cd291d36b9db528aea18add2 ]
struct nexthop\_grp contains two reserved fields that are not initialized by
nla\_put\_nh\_group(), and carry garbage. This can be observed e.g. with
strace (edited for clarity):
# ip nexthop add id 1 dev lo
# ip nexthop add id 101 group 1
# strace -e recvmsg ip nexthop get id 101
...
recvmsg(... [{nla\_len=12, nla\_type=NHA\_GROUP},
[{id=1, weight=0, resvd1=0x69, resvd2=0x67}]] ...) = 52
The fields are reserved and therefore not currently used. But as they are, they
leak kernel memory, and the fact they are not just zero complicates repurposing
of the fields for new ends. Initialize the full structure.
Fixes: 430a049190de ("nexthop: Add support for nexthop groups")
Signed-off-by: Petr Machata <petrm@nvidia.com>
Reviewed-by: Ido Schimmel <idosch@nvidia.com>
Reviewed-by: Eric Dumazet <edumazet@google.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=a13d3864b76ac87085ec530b2ff8e37482a63a96)

| -rw-r--r-- | [net/ipv4/nexthop.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/ipv4/nexthop.c?id=a13d3864b76ac87085ec530b2ff8e37482a63a96) | 7 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 3 deletions

| diff --git a/net/ipv4/nexthop.c b/net/ipv4/nexthop.cindex 535856b0f0edce..6b9787ee860175 100644--- a/[net/ipv4/nexthop.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ipv4/nexthop.c?id=fa938b04359f0f292f0d3ba26f508d8dcbbeb672)+++ b/[net/ipv4/nexthop.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ipv4/nexthop.c?id=a13d3864b76ac87085ec530b2ff8e37482a63a96)@@ -888,9 +888,10 @@ static int nla\_put\_nh\_group(struct sk\_buff \*skb, struct nexthop \*nh,  p = nla\_data(nla); for (i = 0; i < nhg->num\_nh; ++i) {- p->id = nhg->nh\_entries[i].nh->id;- p->weight = nhg->nh\_entries[i].weight - 1;- p += 1;+ \*p++ = (struct nexthop\_grp) {+ .id = nhg->nh\_entries[i].nh->id,+ .weight = nhg->nh\_entries[i].weight - 1,+ }; }  if (nhg->resilient && nla\_put\_nh\_group\_res(skb, nhg)) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 10:46:57 +0000



=== Content from git.kernel.org_26bd3fa9_20250110_104819.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=9e8f558a3afe99ce51a642ce0d3637ddc2b5d5d0)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=9e8f558a3afe99ce51a642ce0d3637ddc2b5d5d0)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=9e8f558a3afe99ce51a642ce0d3637ddc2b5d5d0)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=9e8f558a3afe99ce51a642ce0d3637ddc2b5d5d0)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Petr Machata <petrm@nvidia.com> | 2024-07-23 18:04:16 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-08-19 05:45:24 +0200 |
| commit | [9e8f558a3afe99ce51a642ce0d3637ddc2b5d5d0](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=9e8f558a3afe99ce51a642ce0d3637ddc2b5d5d0) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=9e8f558a3afe99ce51a642ce0d3637ddc2b5d5d0)) | |
| tree | [7fcc0e17d201ca593ba83d5779c8f42893911129](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=9e8f558a3afe99ce51a642ce0d3637ddc2b5d5d0) | |
| parent | [c56abfb6c27a3b6c66ee399f88c7e35daf57cb28](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c56abfb6c27a3b6c66ee399f88c7e35daf57cb28) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=9e8f558a3afe99ce51a642ce0d3637ddc2b5d5d0&id2=c56abfb6c27a3b6c66ee399f88c7e35daf57cb28)) | |
| download | [linux-9e8f558a3afe99ce51a642ce0d3637ddc2b5d5d0.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-9e8f558a3afe99ce51a642ce0d3637ddc2b5d5d0.tar.gz) | |

net: nexthop: Initialize all fields in dumped nexthops[ Upstream commit 6d745cd0e9720282cd291d36b9db528aea18add2 ]
struct nexthop\_grp contains two reserved fields that are not initialized by
nla\_put\_nh\_group(), and carry garbage. This can be observed e.g. with
strace (edited for clarity):
# ip nexthop add id 1 dev lo
# ip nexthop add id 101 group 1
# strace -e recvmsg ip nexthop get id 101
...
recvmsg(... [{nla\_len=12, nla\_type=NHA\_GROUP},
[{id=1, weight=0, resvd1=0x69, resvd2=0x67}]] ...) = 52
The fields are reserved and therefore not currently used. But as they are, they
leak kernel memory, and the fact they are not just zero complicates repurposing
of the fields for new ends. Initialize the full structure.
Fixes: 430a049190de ("nexthop: Add support for nexthop groups")
Signed-off-by: Petr Machata <petrm@nvidia.com>
Reviewed-by: Ido Schimmel <idosch@nvidia.com>
Reviewed-by: Eric Dumazet <edumazet@google.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=9e8f558a3afe99ce51a642ce0d3637ddc2b5d5d0)

| -rw-r--r-- | [net/ipv4/nexthop.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/ipv4/nexthop.c?id=9e8f558a3afe99ce51a642ce0d3637ddc2b5d5d0) | 7 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 3 deletions

| diff --git a/net/ipv4/nexthop.c b/net/ipv4/nexthop.cindex c140a36bd1e65e..633eab6ff55dd7 100644--- a/[net/ipv4/nexthop.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ipv4/nexthop.c?id=c56abfb6c27a3b6c66ee399f88c7e35daf57cb28)+++ b/[net/ipv4/nexthop.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ipv4/nexthop.c?id=9e8f558a3afe99ce51a642ce0d3637ddc2b5d5d0)@@ -675,9 +675,10 @@ static int nla\_put\_nh\_group(struct sk\_buff \*skb, struct nh\_group \*nhg)  p = nla\_data(nla); for (i = 0; i < nhg->num\_nh; ++i) {- p->id = nhg->nh\_entries[i].nh->id;- p->weight = nhg->nh\_entries[i].weight - 1;- p += 1;+ \*p++ = (struct nexthop\_grp) {+ .id = nhg->nh\_entries[i].nh->id,+ .weight = nhg->nh\_entries[i].weight - 1,+ }; }  if (nhg->resilient && nla\_put\_nh\_group\_res(skb, nhg)) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 10:46:56 +0000



=== Content from git.kernel.org_2ebfc44d_20250110_104820.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=fd06cb4a5fc7bda3dea31712618a62af72a1c6cb)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=fd06cb4a5fc7bda3dea31712618a62af72a1c6cb)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=fd06cb4a5fc7bda3dea31712618a62af72a1c6cb)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=fd06cb4a5fc7bda3dea31712618a62af72a1c6cb)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Petr Machata <petrm@nvidia.com> | 2024-07-23 18:04:16 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-08-19 05:33:41 +0200 |
| commit | [fd06cb4a5fc7bda3dea31712618a62af72a1c6cb](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=fd06cb4a5fc7bda3dea31712618a62af72a1c6cb) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=fd06cb4a5fc7bda3dea31712618a62af72a1c6cb)) | |
| tree | [52c6d7a1379dd1ba37aca53bd82999e7890f1165](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=fd06cb4a5fc7bda3dea31712618a62af72a1c6cb) | |
| parent | [253405541be2f15ffebdeac2f4cf4b7e9144d12f](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=253405541be2f15ffebdeac2f4cf4b7e9144d12f) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=fd06cb4a5fc7bda3dea31712618a62af72a1c6cb&id2=253405541be2f15ffebdeac2f4cf4b7e9144d12f)) | |
| download | [linux-fd06cb4a5fc7bda3dea31712618a62af72a1c6cb.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-fd06cb4a5fc7bda3dea31712618a62af72a1c6cb.tar.gz) | |

net: nexthop: Initialize all fields in dumped nexthops[ Upstream commit 6d745cd0e9720282cd291d36b9db528aea18add2 ]
struct nexthop\_grp contains two reserved fields that are not initialized by
nla\_put\_nh\_group(), and carry garbage. This can be observed e.g. with
strace (edited for clarity):
# ip nexthop add id 1 dev lo
# ip nexthop add id 101 group 1
# strace -e recvmsg ip nexthop get id 101
...
recvmsg(... [{nla\_len=12, nla\_type=NHA\_GROUP},
[{id=1, weight=0, resvd1=0x69, resvd2=0x67}]] ...) = 52
The fields are reserved and therefore not currently used. But as they are, they
leak kernel memory, and the fact they are not just zero complicates repurposing
of the fields for new ends. Initialize the full structure.
Fixes: 430a049190de ("nexthop: Add support for nexthop groups")
Signed-off-by: Petr Machata <petrm@nvidia.com>
Reviewed-by: Ido Schimmel <idosch@nvidia.com>
Reviewed-by: Eric Dumazet <edumazet@google.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=fd06cb4a5fc7bda3dea31712618a62af72a1c6cb)

| -rw-r--r-- | [net/ipv4/nexthop.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/ipv4/nexthop.c?id=fd06cb4a5fc7bda3dea31712618a62af72a1c6cb) | 7 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 3 deletions

| diff --git a/net/ipv4/nexthop.c b/net/ipv4/nexthop.cindex 0137854a7faaa9..388f5773b88d21 100644--- a/[net/ipv4/nexthop.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ipv4/nexthop.c?id=253405541be2f15ffebdeac2f4cf4b7e9144d12f)+++ b/[net/ipv4/nexthop.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ipv4/nexthop.c?id=fd06cb4a5fc7bda3dea31712618a62af72a1c6cb)@@ -201,9 +201,10 @@ static int nla\_put\_nh\_group(struct sk\_buff \*skb, struct nh\_group \*nhg)  p = nla\_data(nla); for (i = 0; i < nhg->num\_nh; ++i) {- p->id = nhg->nh\_entries[i].nh->id;- p->weight = nhg->nh\_entries[i].weight - 1;- p += 1;+ \*p++ = (struct nexthop\_grp) {+ .id = nhg->nh\_entries[i].nh->id,+ .weight = nhg->nh\_entries[i].weight - 1,+ }; }  return 0; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 10:46:57 +0000



=== Content from git.kernel.org_2d4f606c_20250110_104818.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=6d745cd0e9720282cd291d36b9db528aea18add2)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=6d745cd0e9720282cd291d36b9db528aea18add2)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=6d745cd0e9720282cd291d36b9db528aea18add2)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=6d745cd0e9720282cd291d36b9db528aea18add2)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Petr Machata <petrm@nvidia.com> | 2024-07-23 18:04:16 +0200 |
| --- | --- | --- |
| committer | David S. Miller <davem@davemloft.net> | 2024-07-24 15:13:43 +0100 |
| commit | [6d745cd0e9720282cd291d36b9db528aea18add2](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=6d745cd0e9720282cd291d36b9db528aea18add2) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=6d745cd0e9720282cd291d36b9db528aea18add2)) | |
| tree | [2ec6ea8e2d02084a4bf81655b6e586e9d5fcf9a1](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=6d745cd0e9720282cd291d36b9db528aea18add2) | |
| parent | [e9dbebae2e3c338122716914fe105458f41e3a4a](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e9dbebae2e3c338122716914fe105458f41e3a4a) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=6d745cd0e9720282cd291d36b9db528aea18add2&id2=e9dbebae2e3c338122716914fe105458f41e3a4a)) | |
| download | [linux-6d745cd0e9720282cd291d36b9db528aea18add2.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-6d745cd0e9720282cd291d36b9db528aea18add2.tar.gz) | |

net: nexthop: Initialize all fields in dumped nexthopsstruct nexthop\_grp contains two reserved fields that are not initialized by
nla\_put\_nh\_group(), and carry garbage. This can be observed e.g. with
strace (edited for clarity):
# ip nexthop add id 1 dev lo
# ip nexthop add id 101 group 1
# strace -e recvmsg ip nexthop get id 101
...
recvmsg(... [{nla\_len=12, nla\_type=NHA\_GROUP},
[{id=1, weight=0, resvd1=0x69, resvd2=0x67}]] ...) = 52
The fields are reserved and therefore not currently used. But as they are, they
leak kernel memory, and the fact they are not just zero complicates repurposing
of the fields for new ends. Initialize the full structure.
Fixes: 430a049190de ("nexthop: Add support for nexthop groups")
Signed-off-by: Petr Machata <petrm@nvidia.com>
Reviewed-by: Ido Schimmel <idosch@nvidia.com>
Reviewed-by: Eric Dumazet <edumazet@google.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=6d745cd0e9720282cd291d36b9db528aea18add2)

| -rw-r--r-- | [net/ipv4/nexthop.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/ipv4/nexthop.c?id=6d745cd0e9720282cd291d36b9db528aea18add2) | 7 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 3 deletions

| diff --git a/net/ipv4/nexthop.c b/net/ipv4/nexthop.cindex 535856b0f0edce..6b9787ee860175 100644--- a/[net/ipv4/nexthop.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ipv4/nexthop.c?id=e9dbebae2e3c338122716914fe105458f41e3a4a)+++ b/[net/ipv4/nexthop.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ipv4/nexthop.c?id=6d745cd0e9720282cd291d36b9db528aea18add2)@@ -888,9 +888,10 @@ static int nla\_put\_nh\_group(struct sk\_buff \*skb, struct nexthop \*nh,  p = nla\_data(nla); for (i = 0; i < nhg->num\_nh; ++i) {- p->id = nhg->nh\_entries[i].nh->id;- p->weight = nhg->nh\_entries[i].weight - 1;- p += 1;+ \*p++ = (struct nexthop\_grp) {+ .id = nhg->nh\_entries[i].nh->id,+ .weight = nhg->nh\_entries[i].weight - 1,+ }; }  if (nhg->resilient && nla\_put\_nh\_group\_res(skb, nhg)) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 10:46:55 +0000


