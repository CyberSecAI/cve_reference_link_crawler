
[skip to content](#content)

 /
[Security Lab](/ "Security Lab")
[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Events](/events/ "Events")

[Get Involved](/get-involved/)

* Resources
* [Open Source Community](/open-source "Home")
* [Enterprise](/enterprise "Home")

 /
[Security Lab](/ "Security Lab")

[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Open Source Community](/open-source "Open Source Community")
[Enterprise](/enterprise "Enterprise")

[Events](/events/ "Events")
[Get Involved](/get-involved/ "Events")

April 18, 2024
# GHSL-2023-250: Unauthenticated limited file write in DocsGPT - CVE-2024-31451

[![Author avatar](https://avatars.githubusercontent.com/u/102833689)
Sylwia Budzynska](https://github.com/sylwia-budzynska)

## Coordinated Disclosure Timeline

* 2023-11-28: Sent the report via GitHub Private Vulnerability Reporting (PVR).
* 2023-12-27: Sent a follow up message.
* 2024-01-04: Created an [issue](https://github.com/arc53/DocsGPT/issues/815) in the repository asking for a contact.
* 2024-01-16: The PVR report is accepted.
* 2024-02-12: Sent a reminder about the deadline for fixing the issue.
* 2024-02-27: Reminder about the deadline.
* 2024-03-02: Maintainer answered they are working on a fix.
* 2024-04-08: Wrote a message via PVR informing that GitHub Security Lab will be requesting a CVE for this vulnerability.
* 2024-04-08: Fix is created and a new version with a fix is released. CVE-2024-31451 is assigned.
* 2024-08-12: [Advisory](https://github.com/arc53/DocsGPT/security/advisories/GHSA-p5qc-vj2x-9rjp) is published.

## Summary

DocsGPT is vulnerable to unauthenticated limited file write.

## Project

DocsGPT

## Tested Version

[v0.5.0](https://github.com/arc53/DocsGPT/releases/tag/0.5.0)

## Details

### limited file write in `routes.py` (`GHSL-2023-250`)

The [check\_docs](https://github.com/arc53/DocsGPT/blob/95fdedf12e4b938744055bf2bc2e4bbff66d3c28/application/api/user/routes.py#L195) endpoint concatenates user-controlled [POST data with a URL](https://github.com/arc53/DocsGPT/blob/95fdedf12e4b938744055bf2bc2e4bbff66d3c28/application/api/user/routes.py#L201-L202), which allows for traversing the URL and changing the repository the files are downloaded from. The files are then saved on the server on lines as shown on line [214](https://github.com/arc53/DocsGPT/blob/95fdedf12e4b938744055bf2bc2e4bbff66d3c28/application/api/user/routes.py#L214) and [219](https://github.com/arc53/DocsGPT/blob/95fdedf12e4b938744055bf2bc2e4bbff66d3c28/application/api/user/routes.py#L219).

```
def check_docs():
    # check if docs exist in a vectorstore folder
    data = request.get_json()
    # split docs on / and take first part
    if data["docs"].split("/")[0] == "local":
        return {"status": "exists"}
    vectorstore = "vectors/" + data["docs"]
    base_path = "https://raw.githubusercontent.com/arc53/DocsHUB/main/"
    if os.path.exists(vectorstore) or data["docs"] == "default":
        return {"status": "exists"}
    else:
        r = requests.get(base_path + vectorstore + "index.faiss")

        if r.status_code != 200:
            return {"status": "null"}
        else:
            if not os.path.exists(vectorstore):
                os.makedirs(vectorstore)
            with open(vectorstore + "index.faiss", "wb") as f:
                f.write(r.content)

            # download the store
            r = requests.get(base_path + vectorstore + "index.pkl")
            with open(vectorstore + "index.pkl", "wb") as f:
                f.write(r.content)

```

The vulnerability was found with the help of [CodeQL](https://codeql.github.com/codeql-query-help/python/py-full-ssrf/).

#### Impact

This issue may lead to `limited file write`.

## CVE

* CVE-2024-31451

## Credit

This issue was discovered and reported by GHSL team member [@sylwia-budzynska (Sylwia Budzynska)](https://github.com/sylwia-budzynska).

## Contact

You can contact the GHSL team at `securitylab@github.com`, please include a reference to `GHSL-2023-250` in any communication regarding this issue.

## Product

* [Features](https://github.com/features)
* [Security](https://github.com/security)
* [Team](https://github.com/team)
* [Enterprise](https://github.com/enterprise)
* [Customer stories](https://github.com/customer-stories?type=enterprise)
* [The ReadME Project](https://github.com/readme)
* [Pricing](https://github.com/pricing)
* [Resources](https://resources.github.com)
* [Roadmap](https://github.com/github/roadmap)
* [Compare GitHub](https://resources.github.com/devops/tools/compare/)

## Platform

* [Developer API](https://developer.github.com)
* [Partners](http://partner.github.com/)
* [Atom](https://atom.io)
* [Electron](http://electron.atom.io/)
* [GitHub Desktop](https://desktop.github.com/)

## Support

* [Docs](https://docs.github.com)
* [Community Forum](https://github.community)
* [Professional Services](https://services.github.com/)
* [GitHub Skills](https://skills.github.com/)
* [Status](https://githubstatus.com/)
* [Contact GitHub](https://support.github.com)

## Company

* [About](https://github.com/about)
* [Blog](https://github.blog)
* [Careers](https://github.com/about/careers)
* [Press](https://github.com/about/press)
* [Inclusion](https://github.com/about/careers)
* [Social Impact](https://github.com/about/press)
* [Shop](https://shop.github.com)

* GitHub Inc. Â©
  2024
* [Terms](https://docs.github.com/en/github/site-policy/github-terms-of-service)
* [Privacy](https://docs.github.com/en/github/site-policy/github-privacy-statement)
* Sitemap
* [What is Git?](https://github.com/git-guides)
* Manage Cookies
* Do not share my personal information

