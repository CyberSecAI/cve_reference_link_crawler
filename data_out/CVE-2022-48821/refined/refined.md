The provided content relates to CVE-2022-48821.

**Root cause of vulnerability:**
The vulnerability is caused by a double free in the `fastrpc_dmabuf_alloc` function within the Linux kernel's `drivers/misc/fastrpc.c` file. This occurs when the `copy_to_user()` function fails after a dma buffer file descriptor has been installed.

**Weaknesses/vulnerabilities present:**
- **Use-after-free:** The vulnerability is specifically a use-after-free. When `copy_to_user` fails the code incorrectly calls `dma_buf_put` on an already released 'file' object.
- **Double fput():** The core issue is a double free or double put of the dma_buf. The `dma_buf_fd()` function calls `fd_install()` which consumes a reference to the dma_buf. If `copy_to_user()` fails, the code was still trying to release the `dma_buf` with `dma_buf_put()` which leads to the double free on the file object.

**Impact of exploitation:**
- A use-after-free can be exploited to achieve arbitrary code execution in the kernel context.
- A successful exploit would lead to a system crash and potential privilege escalation.

**Attack vectors:**
- The vulnerability is triggered through the `FASTRPC_IOCTL_ALLOC_DMA_BUFF` ioctl.
- An attacker needs to trigger the allocation of the dma buffer with this ioctl and then force the `copy_to_user()` operation to fail.

**Required attacker capabilities/position:**
- The attacker must be able to make the `FASTRPC_IOCTL_ALLOC_DMA_BUFF` ioctl call to trigger the vulnerable code path.
- The attacker needs to cause the `copy_to_user` operation to fail, which might involve crafting specific inputs.