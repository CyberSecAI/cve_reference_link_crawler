=== Content from github.com_6adfd912_20250110_175742.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpython%2Fcpython%2Fissues%2F113171)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpython%2Fcpython%2Fissues%2F113171)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=python%2Fcpython)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[python](/python)
/
**[cpython](/python/cpython)**
Public

* [Notifications](/login?return_to=%2Fpython%2Fcpython) You must be signed in to change notification settings
* [Fork
  30.8k](/login?return_to=%2Fpython%2Fcpython)
* [Star
   64.7k](/login?return_to=%2Fpython%2Fcpython)

* [Code](/python/cpython)
* [Issues
  5k+](/python/cpython/issues)
* [Pull requests
  1.8k](/python/cpython/pulls)
* [Actions](/python/cpython/actions)
* [Projects
  28](/python/cpython/projects)
* [Security](/python/cpython/security)
* [Insights](/python/cpython/pulse)

Additional navigation options

* [Code](/python/cpython)
* [Issues](/python/cpython/issues)
* [Pull requests](/python/cpython/pulls)
* [Actions](/python/cpython/actions)
* [Projects](/python/cpython/projects)
* [Security](/python/cpython/security)
* [Insights](/python/cpython/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fpython%2Fcpython%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fpython%2Fcpython%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# ipaddress considers some not globally reachable addresses global and vice versa #113171

Closed

[jstasiak](/jstasiak) opened this issue
Dec 15, 2023
· 9 comments

Closed

# [ipaddress considers some not globally reachable addresses global and vice versa](#top) #113171

[jstasiak](/jstasiak) opened this issue
Dec 15, 2023
· 9 comments

Assignees
[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&v=4)](/encukou)

Labels
[type-bug](/python/cpython/labels/type-bug)
An unexpected behavior, bug, or error
[type-security](/python/cpython/labels/type-security)
A security issue

## Comments

[![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=80&v=4)](/jstasiak)

Copy link

Contributor

### **[jstasiak](/jstasiak)** commented [Dec 15, 2023](#issue-2043777514) • edited by bedevere-app bot Loading

| Bug reportBug description: Judging by what the `is_private` and `is_global` implementations in the `ipaddress` module do[1], everything that IANA special-purpose address registries[2][3] considers globally reachable should result in `is_global == True`, the rest should be `is_global = True`.  `is_private` is almost always the opposite of `is_global` (`100.64.0.0/10` is special).  The problem is the ranges present in the code (in the `_private_networks` variables) are not quite right:   * There are some ranges missing (so we incorrectly treat them as globally reachable) * Some of the ranges fail to account for more specific allocations defined as globally reachable (so we incorrectly treat them as not globally reachable)   This is what I have right now and I'll submit that as a PR:  ``` diff --git a/Lib/ipaddress.py b/Lib/ipaddress.py index 5b5520b92bde..3ee565bcd30b 100644 --- a/Lib/ipaddress.py +++ b/Lib/ipaddress.py @@ -1558,13 +1558,18 @@ class _IPv4Constants:        _public_network = IPv4Network('100.64.0.0/10')   +    # Not globally reachable address blocks listed on +    # https://www.iana.org/assignments/iana-ipv4-special-registry/iana-ipv4-special-registry.xhtml      _private_networks = [          IPv4Network('0.0.0.0/8'),          IPv4Network('10.0.0.0/8'), +        # 100.64.0.0/10 missing          IPv4Network('127.0.0.0/8'),          IPv4Network('169.254.0.0/16'),          IPv4Network('172.16.0.0/12'), +        # Incomplete. Should be 192.0.0.0/24 - (192.0.0.9/32 + 192.0.0.10/32)          IPv4Network('192.0.0.0/29'), +        # 192.0.0.8/32 missing          IPv4Network('192.0.0.170/31'),          IPv4Network('192.0.2.0/24'),          IPv4Network('192.168.0.0/16'), @@ -2306,15 +2311,31 @@ class _IPv6Constants:        _multicast_network = IPv6Network('ff00::/8')   +    # Not globally reachable address blocks listed on +    # https://www.iana.org/assignments/iana-ipv6-special-registry/iana-ipv6-special-registry.xhtml      _private_networks = [          IPv6Network('::1/128'),          IPv6Network('::/128'),          IPv6Network('::ffff:0:0/96'), +        # 64:ff9b:1::/48 missing          IPv6Network('100::/64'), +        # Not quite right as there are multiple more specific allocations that are globally +        # reachable. Should be: +        # 2001::/23 - ( +        #     2001:1::1/128 +        #     + 2001:1::2/128 +        #     + 2001:3::/32 +        #     + 2001:4:112::/48 +        #     + 2001:20::/28 +        #     + 2001:30::/28 +        # )          IPv6Network('2001::/23'), +        # Unnecessary, covered by 2001::/23          IPv6Network('2001:2::/48'),          IPv6Network('2001:db8::/32'), +        # Unnecessary, covered by 2001::/23          IPv6Network('2001:10::/28'), +        # Potentially 2002::/16 missing? IANA says N/A, there is no true/false value          IPv6Network('fc00::/7'),          IPv6Network('fe80::/10'),          ] ```  [1] And which should really be documented per [#65056](https://github.com/python/cpython/issues/65056) – a separate issue though [2] <https://www.iana.org/assignments/iana-ipv4-special-registry/iana-ipv4-special-registry.xhtml> [3] <https://www.iana.org/assignments/iana-ipv6-special-registry/iana-ipv6-special-registry.xhtml> CPython versions tested on: CPython main branch Operating systems tested on: *No response* Linked PRs  * [GH-113171: Fix "private" (non-global) IP address ranges #113179](https://github.com/python/cpython/pull/113179) * [[3.12] gh-113171: gh-65056: Fix "private" (non-global) IP address ranges (GH-113179) (GH-113186) #118177](https://github.com/python/cpython/pull/118177) * [[3.11] gh-113171: gh-65056: Fix "private" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177) #118227](https://github.com/python/cpython/pull/118227) * [[3.10] gh-113171: gh-65056: Fix "private" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177) #118229](https://github.com/python/cpython/pull/118229) * [[3.9] gh-113171: gh-65056: Fix "private" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177) #118472](https://github.com/python/cpython/pull/118472) * [[3.8] gh-113171: gh-65056: Fix "private" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177) #118479](https://github.com/python/cpython/pull/118479) |
| --- |
| The text was updated successfully, but these errors were encountered: |

 👍
1
 dtolnay reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

[![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak)
[jstasiak](/jstasiak)
added
the
[type-bug](/python/cpython/labels/type-bug)
An unexpected behavior, bug, or error
label
[Dec 15, 2023](#event-11259939523)

[jstasiak](/jstasiak)
added a commit
to jstasiak/cpython
that referenced
this issue
[Dec 15, 2023](#ref-commit-9bfb09f)
[![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak)

`[pythonGH-113171](https://github.com/python/cpython/issues/113171)[: Fix "private" (really non-global) IP address ranges](/jstasiak/cpython/commit/9bfb09f7dbb23add6ccf2878a914f14e49de76d0 "GH-113171: Fix \"private\" (really non-global) IP address ranges

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

A _address_exclude_many() helper function is created to calculate
the necessary network ranges in the trickier cases.

I left 100.64.0.0/10 alone, for now, as it's been made special in [1]
and I'm not sure if we want to undo that as I don't quite understand the
motivation behind it.

Additionally I mainly focused on adding tests for IP*Address.is_global
and I left IP*Network.is_global alone. The reasons for that are:

* I don't think it makes much sense to have properties like is_global,
  is_private etc. on networks, where there are more than two
  possibilities (can be global, can be non-global, can be partially global).
* The properties aren't documented for network objects in the first
  place so it's unclear what the semantics are

[1] https://github.com/python/cpython/issues/61602")`
…

`[9bfb09f](/jstasiak/cpython/commit/9bfb09f7dbb23add6ccf2878a914f14e49de76d0)`

```
The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

A _address_exclude_many() helper function is created to calculate
the necessary network ranges in the trickier cases.

I left 100.64.0.0/10 alone, for now, as it's been made special in [1]
and I'm not sure if we want to undo that as I don't quite understand the
motivation behind it.

Additionally I mainly focused on adding tests for IP*Address.is_global
and I left IP*Network.is_global alone. The reasons for that are:

* I don't think it makes much sense to have properties like is_global,
  is_private etc. on networks, where there are more than two
  possibilities (can be global, can be non-global, can be partially global).
* The properties aren't documented for network objects in the first
  place so it's unclear what the semantics are

[1] [python#61602](https://github.com/python/cpython/issues/61602)
```

[jstasiak](/jstasiak)
added a commit
to jstasiak/cpython
that referenced
this issue
[Dec 15, 2023](#ref-commit-b83b987)
[![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak)

`[pythonGH-113171](https://github.com/python/cpython/issues/113171)[: Fix "private" (really non-global) IP address ranges](/jstasiak/cpython/commit/b83b9874a5bcfe6eb3233849371fb35ccf2fa60f "GH-113171: Fix \"private\" (really non-global) IP address ranges

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

A _address_exclude_many() helper function is created to calculate
the necessary network ranges in the trickier cases.

I left 100.64.0.0/10 alone, for now, as it's been made special in [1]
and I'm not sure if we want to undo that as I don't quite understand the
motivation behind it.

Additionally I mainly focused on adding tests for IP*Address.is_global
and I left IP*Network.is_global alone. The reasons for that are:

* I don't think it makes much sense to have properties like is_global,
  is_private etc. on networks, where there are more than two
  possibilities (can be global, can be non-global, can be partially global).
* The properties aren't documented for network objects in the first
  place so it's unclear what the semantics are

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602")`
…

`[b83b987](/jstasiak/cpython/commit/b83b9874a5bcfe6eb3233849371fb35ccf2fa60f)`

```
The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

A _address_exclude_many() helper function is created to calculate
the necessary network ranges in the trickier cases.

I left 100.64.0.0/10 alone, for now, as it's been made special in [1]
and I'm not sure if we want to undo that as I don't quite understand the
motivation behind it.

Additionally I mainly focused on adding tests for IP*Address.is_global
and I left IP*Network.is_global alone. The reasons for that are:

* I don't think it makes much sense to have properties like is_global,
  is_private etc. on networks, where there are more than two
  possibilities (can be global, can be non-global, can be partially global).
* The properties aren't documented for network objects in the first
  place so it's unclear what the semantics are

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] [python#61602](https://github.com/python/cpython/issues/61602)
```

[![@bedevere-app](https://avatars.githubusercontent.com/in/388350?s=40&v=4)](/apps/bedevere-app)
[bedevere-app](/apps/bedevere-app)
bot
mentioned this issue
[Dec 15, 2023](#ref-pullrequest-2044004062)

[GH-113171: Fix "private" (non-global) IP address ranges
#113179](/python/cpython/pull/113179)
 Merged

[![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=80&v=4)](/jstasiak)

Copy link

Contributor

Author

### **[jstasiak](/jstasiak)** commented [Dec 15, 2023](#issuecomment-1858139918)

| [#61602](https://github.com/python/cpython/issues/61602) ([e5019d5](https://github.com/python/cpython/commit/e5019d5183041f4f75cf4a30b2dc84eed347425e)) made `100.64.0.0/10` special and I'm not sure what to do about it. |
| --- |

All reactions

Sorry, something went wrong.

[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou)
[encukou](/encukou)
mentioned this issue
[Mar 18, 2024](#ref-issue-1198916652)

[ipaddress "is\_private" and "is\_global" are insufficiently documented and is\_global probably has a bug
#65056](/python/cpython/issues/65056)

Closed

[encukou](/encukou)
pushed a commit
that referenced
this issue
[Mar 22, 2024](#ref-commit-40d75c2)
[![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak)

`[GH-113171](https://github.com/python/cpython/issues/113171)[: Fix "private" (non-global) IP address ranges (](/python/cpython/commit/40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f "GH-113171: Fix \"private\" (non-global) IP address ranges (GH-113179)

* GH-113171: Fix \"private\" (really non-global) IP address ranges

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

I left 100.64.0.0/10 alone, for now, as it's been made special in [1]
and I'm not sure if we want to undo that as I don't quite understand the
motivation behind it.

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602")[GH-113179](https://github.com/python/cpython/pull/113179)[)](/python/cpython/commit/40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f "GH-113171: Fix \"private\" (non-global) IP address ranges (GH-113179)

* GH-113171: Fix \"private\" (really non-global) IP address ranges

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

I left 100.64.0.0/10 alone, for now, as it's been made special in [1]
and I'm not sure if we want to undo that as I don't quite understand the
motivation behind it.

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602")`
…

`[40d75c2](/python/cpython/commit/40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f)`

```
* [GH-113171](https://github.com/python/cpython/issues/113171): Fix "private" (really non-global) IP address ranges

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

I left 100.64.0.0/10 alone, for now, as it's been made special in [1]
and I'm not sure if we want to undo that as I don't quite understand the
motivation behind it.

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] [#61602](https://github.com/python/cpython/issues/61602)
```

[![@encukou](https://avatars.githubusercontent.com/u/302922?s=80&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou)

Copy link

Member

### **[encukou](/encukou)** commented [Mar 22, 2024](#issuecomment-2015506754)

| Thank you for the PR! That leaves the `100.64.0.0/10` range. |
| --- |

All reactions

Sorry, something went wrong.

[adorilson](/adorilson)
pushed a commit
to adorilson/cpython
that referenced
this issue
[Mar 25, 2024](#ref-commit-364f3b0)
[![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak) [![@adorilson](https://avatars.githubusercontent.com/u/169837?s=40&v=4)](/adorilson)

`[pythonGH-113171](https://github.com/python/cpython/issues/113171)[: Fix "private" (non-global) IP address ranges (](/adorilson/cpython/commit/364f3b020ffde37fbd69c452215fa84e746cc06e "GH-113171: Fix \"private\" (non-global) IP address ranges (GH-113179)

* GH-113171: Fix \"private\" (really non-global) IP address ranges

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

I left 100.64.0.0/10 alone, for now, as it's been made special in [1]
and I'm not sure if we want to undo that as I don't quite understand the
motivation behind it.

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602")[python…](https://github.com/python/cpython/pull/113179)`
…

`[364f3b0](/adorilson/cpython/commit/364f3b020ffde37fbd69c452215fa84e746cc06e)`

```
[…GH-113179](https://github.com/python/cpython/pull/113179))

* [pythonGH-113171](https://github.com/python/cpython/issues/113171): Fix "private" (really non-global) IP address ranges

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

I left 100.64.0.0/10 alone, for now, as it's been made special in [1]
and I'm not sure if we want to undo that as I don't quite understand the
motivation behind it.

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] [python#61602](https://github.com/python/cpython/issues/61602)
```

[NGRsoftlab](/NGRsoftlab)
pushed a commit
to NGRsoftlab/cpython
that referenced
this issue
[Apr 2, 2024](#ref-commit-1b5fe4c)
[![@ngr-ilmarh](https://avatars.githubusercontent.com/u/161701313?s=40&v=4)](/ngr-ilmarh)

`[Squashed commit of the following:](/NGRsoftlab/cpython/commit/1b5fe4cad096e32efee3a0477ef6f277ec2a2b96 "Squashed commit of the following:

commit 9dae05ee59eeba0e67af2a46f2a2907c9f8d7e4a
Author: Moshe Kaplan <mosheekaplan@gmail.com>
Date:   Mon Apr 1 15:53:00 2024 -0400

    Docs: specify XML document name in xml.etree.elementtree example (#24223)

commit fc2071687b708598264a3403b7f9104667c1092f
Author: Matthew Davis <7035647+mdavis-xyz@users.noreply.github.com>
Date:   Mon Apr 1 21:49:14 2024 +0200

    Docs: add more links to PIPE in subprocess docs (#25416)

commit fc8007ee3635db6ab73e132ebff987c910b6d538
Author: Barney Gale <barney.gale@gmail.com>
Date:   Mon Apr 1 20:37:41 2024 +0100

    GH-117337: Deprecate `glob.glob0()` and `glob.glob1()`. (#117371)

    These undocumented functions are no longer used by `msilib`, so there's no
    reason to keep them around.

commit c741ad3537193c63fe697a8f0316aecd45eeb9ba
Author: Justin Turner Arthur <justinarthur@gmail.com>
Date:   Mon Apr 1 12:07:29 2024 -0500

    gh-77714: Provide an async iterator version of as_completed (GH-22491)

    * as_completed returns object that is both iterator and async iterator
    * Existing tests adjusted to test both the old and new style
    * New test to ensure iterator can be resumed
    * New test to ensure async iterator yields any passed-in Futures as-is

    Co-authored-by: Serhiy Storchaka <storchaka@gmail.com>
    Co-authored-by: Guido van Rossum <gvanrossum@gmail.com>

commit ddf814db744006e0f42328aa15ace97c9d8ad681
Author: Guido van Rossum <guido@python.org>
Date:   Mon Apr 1 09:13:38 2024 -0700

    Silence compiler warnings in gc.c (#117422)

commit 179869af922252a0c1cef65fd2923856895e7d1b
Author: Petr Viktorin <encukou@gmail.com>
Date:   Mon Apr 1 17:01:22 2024 +0200

    gh-94808: Fix refcounting in PyObject_Print tests (GH-117421)

commit dd44ab994b7262f0704d64996e0a1bc37b233407
Author: neonene <53406459+neonene@users.noreply.github.com>
Date:   Mon Apr 1 22:28:14 2024 +0900

    gh-117142: ctypes: Unify meta tp slot functions (GH-117143)

    Integrates the following ctypes meta tp slot functions:
    * `CDataType_traverse()` into `CType_Type_traverse()`.
    * `CDataType_clear()` into `CType_Type_clear()`.
    * `CDataType_dealloc()` into `CType_Type_dealloc()`.
    * `CDataType_repeat()` into `CType_Type_repeat()`.

commit 3de09cadde788065a4f2d45117e789c9353bbd12
Author: Steve (Gadget) Barnes <gadgetsteve@hotmail.com>
Date:   Mon Apr 1 14:02:07 2024 +0100

    gh-91565: Replace bugs.python.org links with Devguide/GitHub ones  (GH-91568)

    Co-authored-by: Hugo van Kemenade <hugovk@users.noreply.github.com>
    Co-authored-by: Oleg Iarygin <oleg@arhadthedev.net>
    Co-authored-by: Petr Viktorin <encukou@gmail.com>
    Co-authored-by: Ezio Melotti <ezio.melotti@gmail.com>

commit 90c3c68a658db6951b77a5be50088ec2f6adc8eb
Author: MonadChains <monadchains@gmail.com>
Date:   Mon Apr 1 13:52:25 2024 +0100

    gh-94808:Improve coverage of PyObject_Print (GH-98749)

commit 348cf6e0078eae156c503e8f61ef5e27ae28e57b
Author: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Date:   Mon Apr 1 11:14:37 2024 +0000

    Bump mypy from 1.8.0 to 1.9.0 in /Tools (#117418)

    Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
    Co-authored-by: Alex Waygood <Alex.Waygood@Gmail.com>

commit 9b403fb559bfce93a478937e0ef7e539a9a95283
Author: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Date:   Mon Apr 1 11:05:14 2024 +0000

    build(deps-dev): bump types-psutil from 5.9.5.20240205 to 5.9.5.20240316 in /Tools (#117417)

    Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
    Co-authored-by: Alex Waygood <Alex.Waygood@Gmail.com>

commit 93c7d9d17b571b6a181af7c02830d29819535c35
Author: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Date:   Mon Apr 1 11:38:38 2024 +0100

    build(deps-dev): bump types-setuptools from 69.1.0.20240301 to 69.2.0.20240317 in /Tools (#117419)

    Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

commit 3bb12e407c183946471272f8aee098e54e62a333
Author: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Date:   Mon Apr 1 09:54:33 2024 +0000

    build(deps): bump actions/add-to-project from 0.6.0 to 1.0.0 (#117415)

    Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

commit 56e99307c49adcc6df355f8070229371c97d654f
Author: Adorilson Bezerra <adorilson@gmail.com>
Date:   Sun Mar 31 23:34:54 2024 +0100

    Doc: printf-style library/stdtype improvements (#16741)

commit 18e12641a61a88f7d08b2114ebe965892c6661c5
Author: Raymond Hettinger <rhettinger@users.noreply.github.com>
Date:   Sun Mar 31 16:09:22 2024 -0500

    gh-117387 Remove hash mark from introductory text (#117409)

commit a32d6939486d7f90ee57e215077f6116e19de24d
Author: Deborah <32307299+dlwrnc@users.noreply.github.com>
Date:   Sun Mar 31 22:11:48 2024 +0200

    gh-102190: Add additional zipfile `pwd=` arg docstrings (gh-102195)

    This just documents the parameter that already exists.

    ---------

    Co-authored-by: Gregory P. Smith <greg@krypto.org>
    Co-authored-by: Erlend E. Aasland <erlend.aasland@protonmail.com>

commit 262445358e21c56d7c68e3ee76c13e469d2ea348
Author: Shantanu <12621235+hauntsaninja@users.noreply.github.com>
Date:   Sun Mar 31 12:02:48 2024 -0700

    Link to the Python type system specification (#117400)

commit 752e18389ed03087b51b38eac9769ef8dfd167b7
Author: Barney Gale <barney.gale@gmail.com>
Date:   Sun Mar 31 19:14:48 2024 +0100

    GH-114575: Rename `PurePath.pathmod` to `PurePath.parser` (#116513)

    And rename the private base class from `PathModuleBase` to `ParserBase`.

commit bfc57d43d8766120ba0c8f3f6d7b2ac681a81d8a
Author: Sam Gross <colesbury@gmail.com>
Date:   Fri Mar 29 18:58:08 2024 -0400

    gh-117303: Don't detach in `PyThreadState_DeleteCurrent()` (#117304)

    This fixes a crash in `test_threading.test_reinit_tls_after_fork()` when
    running with the GIL disabled. We already properly handle the case where
    the thread state is `_Py_THREAD_ATTACHED` in `tstate_delete_common()` --
    we just need to remove an assertion.

    Keeping the thread attached means that a stop-the-world pause, such as
    for a `fork()`, won't commence until we remove our thread state from the
    interpreter's linked list. This prevents a crash when the child process
    tries to clean up the dead thread states.

commit 05e0b67a43c5c1778dc2643c8b7c12864e135999
Author: Erlend E. Aasland <erlend@python.org>
Date:   Fri Mar 29 21:23:28 2024 +0100

    gh-116664: In _warnings.c, make filters_version access thread-safe (#117374)

    - assert that the lock is held in already_warned()
    - protect 'filters_version' increment in warnings_filters_mutated_impl()

commit 019143fecbfc26e69800d28d2a9e3392a051780b
Author: Jason R. Coombs <jaraco@jaraco.com>
Date:   Fri Mar 29 16:06:09 2024 -0400

    gh-117348: Refactored RawConfigParser._read for similicity and comprehensibility (#117372)

    * Extract method for _read_inner, reducing complexity and indentation by 1.

    * Extract method for _raise_all and yield ParseErrors from _read_inner.

    Reduces complexity by 1 and reduces touch points for handling errors in _read_inner.

    * Prefer iterators to splat expansion and literal indexing.

    * Extract method for _strip_comments. Reduces complexity by 7.

    * Model the file lines in a class to encapsulate the comment status and cleaned value.

    * Encapsulate the read state as a dataclass

    * Extract _handle_continuation_line and _handle_rest methods. Reduces complexity by 8.

    * Reindent

    * At least for now, collect errors in the ReadState

    * Check for missing section header separately.

    * Extract methods for _handle_header and _handle_option. Reduces complexity by 6.

    * Remove unreachable code. Reduces complexity by 4.

    * Remove unreachable branch

    * Handle error condition early. Reduces complexity by 1.

    * Add blurb

    * Move _raise_all to ParsingError, as its behavior is most closely related to the exception class and not the reader.

    * Split _strip* into separate methods.

    * Refactor _strip_full to compute the strip just once and use 'not any' to determine the factor.

    * Replace use of 'sys.maxsize' with direct computation of the stripped value.

    * Extract has_comments as a dynamic property.

    * Implement clean as a cached property.

    * Model comment prefixes in the RawConfigParser within a prefixes namespace.

    * Use a regular expression to search for the first match.

    Avoids mutating variables and tricky logic and over-computing all of the starts when only the first is relevant.

commit 01bd74eadbc4ff839d39762fae6366f50c1e116e
Author: Sam Gross <colesbury@gmail.com>
Date:   Fri Mar 29 15:33:06 2024 -0400

    gh-117300: Use stop the world to make `sys._current_frames` and `sys._current_exceptions` thread-safe. (#117301)

    This adds a stop the world pause to make the two functions thread-safe
    when the GIL is disabled in the free-threaded build.

    Additionally, the main test thread may call `sys._current_exceptions()` as
    soon as `g_raised.set()` is called. The background thread may not yet reach
    the `leave_g.wait()` line.

commit 94c97423a9c4969f8ddd4a3aa4aacb99c4d5263d
Author: Guido van Rossum <guido@python.org>
Date:   Fri Mar 29 11:31:09 2024 -0700

    Fix broken format in error for bad input in summarize_stats.py (#117375)

    When you pass the script a non-existent input file, you get a TypeError instead of the intended ValueError.

commit 5d21d884b6ffa45dac50a5f9a07c41356a8478b4
Author: mpage <mpage@meta.com>
Date:   Fri Mar 29 10:42:02 2024 -0700

    gh-111926: Avoid locking in PyType_IsSubtype (#117275)

    Read the MRO in a thread-unsafe way in `PyType_IsSubtype` to avoid locking. Fixing this is tracked in #117306.

    The motivation for this change is in support of making weakrefs thread-safe in free-threaded builds:

    `WeakValueDictionary` uses a special dictionary function, `_PyDict_DelItemIf`
    to remove dead weakrefs from the dictionary. `_PyDict_DelItemIf` removes a key
    if a user supplied predicate evaluates to true for the value associated with
    the key. Crucially for the `WeakValueDictionary` use case, the predicate
    evaluation + deletion sequence is atomic, provided that the predicate doesn’t
    suspend. The predicate used by `WeakValueDictionary` includes a subtype check,
    which we must ensure doesn't suspend in free-threaded builds.

commit 19c1dd60c5b53fb0533610ad139ef591294f26e8
Author: Sam Gross <colesbury@gmail.com>
Date:   Fri Mar 29 13:35:43 2024 -0400

    gh-117323: Make `cell` thread-safe in free-threaded builds (#117330)

    Use critical sections to lock around accesses to cell contents. The critical sections are no-ops in the default (with GIL) build.

commit 397d88db5e9ab2a43de3fdf5f8b973a949edc405
Author: Sam Gross <colesbury@gmail.com>
Date:   Fri Mar 29 13:34:04 2024 -0400

    gh-117344: Skip flaky tests in free-threaded build (#117355)

    The tests are not reliable with the GIL disabled. In theory, they can
    fail with the GIL enabled too, but the failures are much more likely
    with the GIL disabled.

commit f05fb2e65c2dffdfae940f2707765c4994925205
Author: Sam Gross <colesbury@gmail.com>
Date:   Fri Mar 29 13:33:04 2024 -0400

    gh-112529: Don't untrack tuples or dicts with zero refcount (#117370)

    The free-threaded GC sometimes sees objects with zero refcount. This can
    happen due to the delay in merging biased reference counting fields,
    and, in the future, due to deferred reference counting. We should not
    untrack these objects or they will never be collected.

    This fixes the refleaks in the free-threaded build.

commit ddf95b5f16031cdbd0d728e55eb06dff002a8678
Author: Erlend E. Aasland <erlend@python.org>
Date:   Fri Mar 29 18:26:06 2024 +0100

    gh-116664: Fix unused var warnings in _warnings.c in non-free-threaded builds (#117373)

    The warnings were introduced by commit c1712ef06.

commit 0fa571dbcdf19b541276cb00bb929381930467b2
Author: Tian Gao <gaogaotiantian@hotmail.com>
Date:   Fri Mar 29 09:02:01 2024 -0700

    Refactor pdb executable targets (#112570)

    Co-authored-by: Jason R. Coombs <jaraco@jaraco.com>

commit 54f7e14500471d1c46fb553adb3ca24cd1fef084
Author: Pedro Lacerda <pslacerda@users.noreply.github.com>
Date:   Fri Mar 29 12:05:00 2024 -0300

    gh-66449: configparser: Add support for unnamed sections (#117273)

    Co-authored-by: Jason R. Coombs <jaraco@jaraco.com>

commit d9cfe7e565a6e2dc15747a904736264e31a10be4
Author: Nikita Sobolev <mail@sobolevn.me>
Date:   Fri Mar 29 14:14:25 2024 +0300

    gh-117166: Ignore empty and temporary dirs in `test_makefile` (#117190)

commit 35b6c4a4da201a947b2ceb96ae4c0d83d4d2df4f
Author: Victor Stinner <vstinner@python.org>
Date:   Fri Mar 29 11:25:17 2024 +0100

    gh-117347: Fix test_clinic side effects (#117363)

    Save/restore converters in ClinicWholeFileTest and
    ClinicExternalTest.

commit 7e2fef865899837c47e91ef0180fa59eb03e840b
Author: neonene <53406459+neonene@users.noreply.github.com>
Date:   Fri Mar 29 18:40:48 2024 +0900

    gh-117142: ctypes: Migrate global vars to module state (GH-117189)

commit 2e9be80c99f635c2f7761e8356b0260922d6e7a6
Author: Gregory P. Smith <greg@krypto.org>
Date:   Thu Mar 28 17:58:37 2024 -0700

    Fix reversed assertRegex checks in test_ssl. (#117351)

commit 8eec7ed714e65d616573b7331780b0aa43c6ed6a
Author: 傅立业（Chris Fu） <17433201@qq.com>
Date:   Fri Mar 29 08:19:20 2024 +0800

    gh-117110: Fix subclasses of typing.Any with custom constructors (#117111)

commit a17f313e3958e825db9a83594c8471a984316536
Author: Christopher Chianelli <christopher@timefold.ai>
Date:   Thu Mar 28 18:26:56 2024 -0400

    gh-117339: Use NULL instead of None for LOAD_SUPER_ATTR in dis docs (GH-117343)

commit 26d328b2ba26374fb8d9ffe8215ecef7c5e3f7a2
Author: Michael Droettboom <mdboom@gmail.com>
Date:   Thu Mar 28 18:23:08 2024 -0400

    GH-117121: Add pystats to JIT builds (GH-117346)

commit 14f1ca7d5363386163839b31ce987423daecc3de
Author: Nice Zombies <nineteendo19d0@gmail.com>
Date:   Thu Mar 28 22:20:08 2024 +0100

    gh-117335: Handle non-iterables for `ntpath.commonpath` (GH-117336)

commit 18cf239e39e25e6cef50ecbb7f197a82f8920ff5
Author: Brandt Bucher <brandtbucher@microsoft.com>
Date:   Thu Mar 28 14:02:34 2024 -0700

    Increase the JIT CI timeouts to 75 minutes (GH-117342)

commit 29829b58a8328a7c2ccacaa74c1d7d120a5e5ca5
Author: Malcolm Smith <smith@chaquo.com>
Date:   Thu Mar 28 19:59:12 2024 +0000

    gh-117294: Report DocTestCase as skipped if all examples in the doctest are skipped (GH-117297)

commit efcc96844e7c66fcd6c23ac2d557ca141614ce9a
Author: Tian Gao <gaogaotiantian@hotmail.com>
Date:   Thu Mar 28 11:23:29 2024 -0700

    gh-69201: Separate stdout and stderr stream in test_pdb (#117308)

commit 6702d2bf6edcd5b5415e17837383623b9d76a5b8
Author: Victor Stinner <vstinner@python.org>
Date:   Thu Mar 28 17:40:58 2024 +0100

    gh-114331: Skip decimal test_maxcontext_exact_arith on s390x (#117326)

commit c1712ef066321c01bf09cba3f22fc474b5b8dfa7
Author: Erlend E. Aasland <erlend@python.org>
Date:   Thu Mar 28 16:05:08 2024 +0100

    gh-116664: Make module state Py_SETREF's in _warnings thread-safe (#116959)

    Mark the swap operations as critical sections.

    Add an internal Py_BEGIN_CRITICAL_SECTION_MUT API that takes a PyMutex
    pointer instead of a PyObject pointer.

commit 9a388b9a64927c372d85f0eaec3de9b7320a6fb5
Author: Joachim Wuttke <j.wuttke@fz-juelich.de>
Date:   Thu Mar 28 14:43:07 2024 +0100

    bpo-43848: explain optional argument mtime in gzip.py. (GH-25410)

    Co-authored-by: Jelle Zijlstra <jelle.zijlstra@gmail.com>

commit 8dbfdb2957a7baade3a88661517f163ad694c39f
Author: Sam Gross <colesbury@gmail.com>
Date:   Thu Mar 28 09:28:39 2024 -0400

    gh-110481: Fix biased reference counting queue initialization. (#117271)

    The biased reference counting queue must be initialized from the bound
    (active) thread because it uses `_Py_ThreadId()` as the key in a hash
    table.

commit 9a1e55b8c5723206116f7016921be3937ef2f4e5
Author: Chris Markiewicz <effigies@gmail.com>
Date:   Thu Mar 28 06:59:31 2024 -0400

    gh-117178: Recover lazy loading of self-referential modules (#117179)

commit 4c71d51a4b7989fc8754ba512c40e21666f9db0d
Author: Jelle Zijlstra <jelle.zijlstra@gmail.com>
Date:   Thu Mar 28 04:30:31 2024 -0600

    gh-117266: Fix crashes on user-created AST subclasses (GH-117276)

    Fix crashes on user-created AST subclasses

commit 8cb7d7ff86a1a2d41195f01ba4f218941dd7308c
Author: Gregory P. Smith <greg@krypto.org>
Date:   Thu Mar 28 03:11:58 2024 -0700

    gh-117310: Remove extra DECREF on \"no ciphers\" error path in `_ssl._SSLContext` constructor (#117309)

    Remove extra self DECREF on ssl \"no ciphers\" error path.

    This doesn't come up in practice because nobody links against a broken
    OpenSSL library that provides nothing.

commit 6c8ac8a32fd6de1960526561c44bc5603fab0f3e
Author: Erlend E. Aasland <erlend@python.org>
Date:   Thu Mar 28 09:40:37 2024 +0100

    gh-116303: Handle disabled test modules in test.support helpers (#116482)

    Make sure test.support helpers skip iso. failing if test extension
    modules are disabled. Also log TEST_MODULES in test.pythoninfo.

commit 0f27672c5002de96c9f1228b12460d5ce3f1d190
Author: Russell Keith-Magee <russell@keith-magee.com>
Date:   Thu Mar 28 16:13:13 2024 +0800

    gh-114099: Add documentation for iOS platform (GH-117057)

    Co-authored-by: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>
    Co-authored-by: Jacob Coffee <jacob@z7x.org>
    Co-authored-by: Malcolm Smith <smith@chaquo.com>
    Co-authored-by: Ned Deily <nad@python.org>

commit f006338017cfbf846e8f7391b9ee5f69df8dc620
Author: Russell Keith-Magee <russell@keith-magee.com>
Date:   Thu Mar 28 15:59:33 2024 +0800

    gh-114099: Additions to standard library to support iOS (GH-117052)

    Co-authored-by: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>
    Co-authored-by: Malcolm Smith <smith@chaquo.com>
    Co-authored-by: Ned Deily <nad@python.org>

commit b44898299a2ed97045c270f6474785da2ff07ced
Author: Tim Hatch <tim@timhatch.com>
Date:   Wed Mar 27 23:54:51 2024 -0700

    gh-89739: gh-77140: Support zip64 in zipimport (GH-94146)

    * Reads zip64 files as produced by the zipfile module
    * Include tests (somewhat slow, however, because of the need to create \"large\" zips)
    * About the same amount of strictness reading invalid zip files as zipfile has
    * Still works on files with prepended data (like pex)

    There are a lot more test cases at https://github.com/thatch/zipimport64/ that give me confidence that this works for real-world files.

    Fixes #89739 and #77140.

    ---------

    Co-authored-by: Itamar Ostricher <itamarost@gmail.com>
    Reviewed-by: Gregory P. Smith <greg@krypto.org>

commit 2cedd25c14d3acfdcb5e8ee55132ce3e334ab8fe
Author: Illia Volochii <illia.volochii@gmail.com>
Date:   Thu Mar 28 08:46:01 2024 +0200

    Revert \"gh-116886: Temporarily disable CIfuzz (memory) (GH-117018)\" (GH-117289)

    This reverts commit 1ab0d0b1167d78bf19661a3b5e533a2b68a57604.

    This reverts #117018.

    I expect the issue to be fixed based on https://github.com/google/oss-fuzz/pull/11708#issuecomment-2006442396 and https://github.com/actions/runner-images/issues/9491.

commit eefff682f09394fe4f18b7d7c6ac4c635caadd02
Author: Malcolm Smith <smith@chaquo.com>
Date:   Wed Mar 27 22:11:44 2024 +0000

    gh-108277: Make test_os tolerate 10 ms diff for timerfd on Android emulators (#117223)

commit 7aa89bc43e0bcf49eee5a39b5a7ba8f996f20d00
Author: Victor Stinner <vstinner@python.org>
Date:   Wed Mar 27 23:10:14 2024 +0100

    gh-113317: Change how Argument Clinic lists converters (#116853)

    * Add a new create_parser_namespace() function for
      PythonParser to pass objects to executed code.
    * In run_clinic(), list converters using 'converters' and
      'return_converters' dictionarties.
    * test_clinic: add 'object()' return converter.
    * Use also create_parser_namespace() in eval_ast_expr().

    Co-authored-by: Erlend E. Aasland <erlend@python.org>

commit 669ef49c7d42f35da6f7ee280102353b9b37f83e
Author: Seth Michael Larson <seth@python.org>
Date:   Wed Mar 27 16:56:14 2024 -0500

    gh-99108: Update and check HACL* version information (GH-117295)

    * Update and check HACL* version information

commit 262fb911ab7df8e890ebd0efb0773c3e0b5a757f
Author: Irit Katriel <1055913+iritkatriel@users.noreply.github.com>
Date:   Wed Mar 27 17:38:19 2024 +0000

    gh-117288: Allocate fewer label IDs in _PyCfg_ToInstructionSequence (#117290)

commit 74c8568d07719529b874897598d8b3bc25ff0434
Author: Malcolm Smith <smith@chaquo.com>
Date:   Wed Mar 27 16:53:27 2024 +0000

    gh-71042: Add `platform.android_ver` (#116674)

commit ce00de4c8cd39816f992e749c1074487d93abe9d
Author: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>
Date:   Wed Mar 27 16:46:35 2024 +0200

    gh-117225: doctest: only print \"and X failed\" when non-zero, don't pluralise \"1 items\" (#117228)

commit 92397d5ead38dde4154e70d00f24973bcf2a925a
Author: Raymond Hettinger <rhettinger@users.noreply.github.com>
Date:   Wed Mar 27 09:04:32 2024 -0500

    Add statistics recipe for sampling from an estimated probability density distribution (#117221)

commit b3e8c78ed7aa9bbd1084375587b99200c687cec9
Author: Tian Gao <gaogaotiantian@hotmail.com>
Date:   Tue Mar 26 18:20:12 2024 -0700

    gh-113548: Allow CLI arguments to `pdb -m` (#113557)

commit 48c0b05cf0dd2db275bd4653f84aa36c22bddcd2
Author: Adorilson Bezerra <adorilson@gmail.com>
Date:   Tue Mar 26 19:08:08 2024 +0000

    Change links on the index page (#117230)

commit af1b0e94400d1bf732466d675054df8cf7dfb62d
Author: AN Long <aisk@users.noreply.github.com>
Date:   Wed Mar 27 02:26:48 2024 +0800

    gh-104242: Enable test_is_char_device_true in pathlib test on all platform (GH-116983)

commit 79be75735c9d77972112cecc8d7e1af28c176ed0
Author: Irit Katriel <1055913+iritkatriel@users.noreply.github.com>
Date:   Tue Mar 26 15:18:17 2024 +0000

    gh-115775: Compiler adds __static_attributes__ field to classes (#115913)

commit 70969d53a77a8a190c40a30419e772bc874a4f62
Author: Antonio <57417288+amaddio@users.noreply.github.com>
Date:   Tue Mar 26 15:10:29 2024 +0100

    gh-97901 add missing text/rtf to mimetypes (GH-97902)

    Co-authored-by: Noam Cohen <noam@noam.me>

commit 4ec347760f98b156c6a2d42ca397af6b0b6ecc50
Author: AN Long <aisk@users.noreply.github.com>
Date:   Tue Mar 26 22:09:57 2024 +0800

    gh-115538: Use isolate mode when running venv test_multiprocessing_recursion() (#117116)

    Co-authored-by: Victor Stinner <vstinner@python.org>

commit 743f2c68f478279e1e56577fe95a0ed112b9abc5
Author: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>
Date:   Tue Mar 26 16:09:09 2024 +0200

    pre-commit: add `check-case-conflict` and `check-merge-conflict` (#117259)

commit 4abca7e1e7e2764faf20c7e677ea5c9ea9dbffe2
Author: Paulo Neves <ptsneves@users.noreply.github.com>
Date:   Tue Mar 26 13:37:50 2024 +0100

    gh-98966: Handle stdout=subprocess.STDOUT (GH-98967)

    Explicitly handle the case where stdout=STDOUT
    as otherwise the existing error handling gets
    confused and reports hard to understand errors.

    Signed-off-by: Paulo Neves <ptsneves@gmail.com>

commit 9654daf793b534b44a831c80f43505ab9e380f1f
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Tue Mar 26 13:26:45 2024 +0200

    gh-66543: Fix mimetype.guess_type() (GH-117217)

    Fix parsing of the following corner cases:

    * URLs with only a host name
    * URLs containing a fragment
    * URLs containing a query
    * filenames with only a UNC sharepoint on Windows

    Co-authored-by: Dong-hee Na <donghee.na92@gmail.com>

commit 8bef34f625e21886b1c64544c060e19ee2e229bf
Author: Mark Shannon <mark@hotpy.org>
Date:   Tue Mar 26 11:11:42 2024 +0000

    GH-117108: Set the \"old space bit\" to \"visited\" for all young objects  (#117213)

    Change old space bit of young objects from 0 to gcstate->visited_space.
    This ensures that any object created *and* collected during cycle GC has the bit set correctly.

commit bf82f77957a31c3731b4ec470c406f5708ca9ba3
Author: Mark Shannon <mark@hotpy.org>
Date:   Tue Mar 26 09:35:11 2024 +0000

    GH-116422: Tier2 hot/cold splitting (GH-116813)

    Splits the \"cold\" path, deopts and exits, from the \"hot\" path, reducing the size of most jitted instructions, at the cost of slower exits.

commit 61599a48f52e951d8813877ee311d2a830ba2cd8
Author: Pablo Galindo Salgado <Pablogsal@gmail.com>
Date:   Tue Mar 26 09:30:46 2024 +0000

    bpo-24612: Improve syntax error for 'not' after an operator (GH-28170)

    Co-authored-by: Lysandros Nikolaou <lisandrosnik@gmail.com>

commit 771902c257372e6c4df1ead4e8c46308561db7a7
Author: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>
Date:   Tue Mar 26 11:13:32 2024 +0200

    gh-83845: Add tests for operator module (#115883)

    Co-authored-by: Karthikeyan Singaravelan <tir.karthi@gmail.com>

commit ea9a296fce2f786b4cf43c7924e5de01061f27ca
Author: yevgeny hong <hongyevgeny@gmail.com>
Date:   Tue Mar 26 16:45:43 2024 +0900

    gh-115627: Fix PySSL_SetError handling SSL_ERROR_SYSCALL (GH-115628)

    Python 3.10 changed from using SSL_write() and SSL_read() to SSL_write_ex() and
    SSL_read_ex(), but did not update handling of the return value.

    Change error handling so that the return value is not examined.
    OSError (not EOF) is now returned when retval is 0.

    According to *recent* man pages of all functions for which we call
    PySSL_SetError, (in OpenSSL 3.0 and 1.1.1), their return value should
    be used to determine whether an error happened (i.e. if PySSL_SetError
    should be called), but not what kind of error happened (so,
    PySSL_SetError shouldn't need retval). To get the error,
    we need to use SSL_get_error.

    Co-authored-by: Serhiy Storchaka <storchaka@gmail.com>
    Co-authored-by: Petr Viktorin <encukou@gmail.com>

commit d52bdfb19fadd7614a0e5abaf68525fc7300e841
Author: Victor Stinner <vstinner@python.org>
Date:   Tue Mar 26 08:35:59 2024 +0100

    gh-83434: Disable XML in regrtest when -R option is used (#117232)

commit 9f74e86c78853c101a23e938f8e32ea838d8f62e
Author: Sebastian Pipping <sebastian@pipping.org>
Date:   Tue Mar 26 02:48:27 2024 +0100

    gh-117187: Fix XML tests for vanilla Expat <2.6.0 (GH-117203)

    This fixes XML unittest fallout from the https://github.com/python/cpython/issues/115398 security fix.  When configured using `--with-system-expat` on systems with older pre 2.6.0 versions of libexpat, our unittests were failing.

    * sax|etree: Simplify Expat version guard where simplifiable

    Idea by Matěj Cepl

    * sax|etree: Fix reparse deferral tests for vanilla Expat <2.6.0

    This *does not fix* the case of distros with an older version of libexpat with the 2.6.0 feature backported as a security fix.  (Ubuntu is a known example of this with its libexpat1 2.5.0-2ubunutu0.1 package)

commit 872e212378ef86392069034afd80bb53896fd93d
Author: Jonathan Protzenko <protz@microsoft.com>
Date:   Mon Mar 25 17:35:26 2024 -0700

    gh-99108: Refresh HACL*; update modules accordingly; fix namespacing (GH-117237)

    Pulls in a new update from https://github.com/hacl-star/hacl-star and fixes our C \"namespacing\" done by `Modules/_hacl/refresh.sh`.

commit 8945b7ff55b87d11c747af2dad0e3e4d631e62d6
Author: Eric V. Smith <ericvsmith@users.noreply.github.com>
Date:   Mon Mar 25 19:59:14 2024 -0400

    gh-109870: Dataclasses: batch up exec calls (gh-110851)

    Instead of calling `exec()` once for each function added to a dataclass, only call `exec()` once per dataclass. This can lead to speed improvements of up to 20%.

commit 7ebad77ad65ab4d5d8d0c333256a882262cec189
Author: Raymond Hettinger <rhettinger@users.noreply.github.com>
Date:   Mon Mar 25 18:49:44 2024 -0500

    Sync main docs and docstring for median_grouped(). (gh-117214)

commit 0821923aa979a72464c5da8dfa53a719bba5801c
Author: Nice Zombies <nineteendo19d0@gmail.com>
Date:   Mon Mar 25 23:55:11 2024 +0100

    gh-117114: Make os.path.isdevdrive available on all platforms (GH-117115)

commit c2276176d543a2fc2d57709c2787f99850fbb073
Author: Adorilson Bezerra <adorilson@gmail.com>
Date:   Mon Mar 25 22:34:20 2024 +0000

    Add information about negative  indexes to sequence datamodel doc (#110903)

    Co-authored by Terry Jan Reedy

commit 23e4f80ce2a2bac50acd1785e791316d5b578b8d
Author: Mark Shannon <mark@hotpy.org>
Date:   Mon Mar 25 20:43:51 2024 +0000

    A few minor tweaks to get stats working and compiling cleanly. (#117219)

    Fixes a compilation error when configured with `--enable-pystats`,
    an array size issue, and an unused variable.

commit 507896d97dcff2d7999efa264b29d9003c525c49
Author: Victor Stinner <vstinner@python.org>
Date:   Mon Mar 25 17:32:20 2024 +0100

    gh-116936: Add PyType_GetModuleByDef() to the limited C API (#116937)

commit 0c1a42cf9c8cd0d4534d5c1d58f118ce7c5c446e
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Mon Mar 25 17:32:11 2024 +0200

    gh-87193: Support bytes objects with refcount > 1 in _PyBytes_Resize() (GH-117160)

    Create a new bytes object and destroy the old one if it has refcount > 1.

commit 01e7405da400e8997f8964d06cc414045e144681
Author: Tian Gao <gaogaotiantian@hotmail.com>
Date:   Mon Mar 25 08:18:09 2024 -0700

    gh-112948: Make pdb completion similar to repl completion (#112950)

commit 9db2a8f914ad59019d448cecc43b6d45f46424a0
Author: Raymond Hettinger <rhettinger@users.noreply.github.com>
Date:   Mon Mar 25 09:26:42 2024 -0500

    Minor markup and grammar fixes in the statistics docs (gh-117216)

commit eebea7e515462b503632ada74923ec3246599c9c
Author: Kirill Podoprigora <kirill.bast9@mail.ru>
Date:   Sun Mar 24 20:34:55 2024 +0200

    gh-117176: Fix compiler warning in Python/optimizer_bytecodes.c (GH-117199)

commit 83485a095363dad6c97b19af2826ca0c34343bfc
Author: Totally a booplicate <53382877+Booplicate@users.noreply.github.com>
Date:   Sun Mar 24 18:48:40 2024 +0300

    gh-112571: Move fish venv activation script into the common folder (GH-117169)

    pythongh-112571: allow using fish venv activation script on windows

    The fish shell can be used on windows under cygwin or msys2.
    This change moves the script to the common folder
    so the venv module will install it on both posix and nt systems (like the bash script).

commit 78a651fd7fbe7a3d1702e40f4cbfa72d87241ef0
Author: Terry Jan Reedy <tjreedy@udel.edu>
Date:   Sun Mar 24 11:38:34 2024 -0400

    gh-117194: Properly format 'base64' header in What's New (#117198)

    It needs 6, not 3, '-'s.

commit f267d5bf2a99fbeb26a720d1c87c1f0557424b14
Author: Kerim Kabirov <the.privat33r+gh@pm.me>
Date:   Sun Mar 24 14:59:14 2024 +0100

    GH-115986 Docs: promote pprint.pp usage as a default (#116614)

    Co-authored-by: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>

commit 39df7732178c8e8f75b12f069a3dbc1715c99995
Author: LilKS <1244886+LilKS@users.noreply.github.com>
Date:   Sun Mar 24 11:01:07 2024 +0100

    gh-101760: Improve the imaplib.IMAP4 example (#101764)

    Co-authored-by: Adam Turner <9087854+AA-Turner@users.noreply.github.com>

commit a1e948edba9ec6ba61365429857f7a087c5edf51
Author: Raymond Hettinger <rhettinger@users.noreply.github.com>
Date:   Sun Mar 24 11:35:58 2024 +0200

    Add cumulative option for the new statistics.kde() function. (#117033)

commit d610d821fd210dce63a1132c274ffdf8acc510bc
Author: Irit Katriel <1055913+iritkatriel@users.noreply.github.com>
Date:   Sat Mar 23 22:32:33 2024 +0000

    gh-112383: teach dis how to interpret ENTER_EXECUTOR (#117171)

commit 6c83352bfe78a7d567c8d76257df6eb91d5a7245
Author: Ken Jin <kenjin@python.org>
Date:   Sun Mar 24 06:19:17 2024 +0800

    gh-117180: Complete call sequence when trace stack overflow (GH-117184)

    ---------

    Co-authored-by: Peter Lazorchak <lazorchakp@gmail.com>
    Co-authored-by: Guido van Rossum <gvanrossum@users.noreply.github.com>
    Co-authored-by: Guido van Rossum <gvanrossum@gmail.com>

commit f11d0d8be8af28e1368c3c7c116218cf65ddf93e
Author: Erik Soma <stillusingirc@gmail.com>
Date:   Sat Mar 23 11:39:35 2024 -0400

    gh-91227: Ignore ERROR_PORT_UNREACHABLE in proactor recvfrom() (#32011)

commit 9967b568edd2e35b0415c14c7242f3ca2c0dc03d
Author: Victor Stinner <vstinner@python.org>
Date:   Sat Mar 23 13:01:20 2024 +0100

    gh-117008: Fix functools test_recursive_pickle() (#117009)

    Use support.infinite_recursion() in test_recursive_pickle() of
    test_functools to prevent a stack overflow on \"ARM64 Windows
    Non-Debug\" buildbot.

    Lower Py_C_RECURSION_LIMIT to 1,000 frames on Windows ARM64.

commit 72eea512b88f8fd68b7258242c37da963ad87360
Author: Barney Gale <barney.gale@gmail.com>
Date:   Fri Mar 22 19:14:09 2024 +0000

    GH-106747: Document another difference between `glob` and `pathlib`. (#116518)

    Document that `path.glob()` might return *path*, whereas
    `glob.glob(root_dir=path)` will never return an empty string corresponding
    to *path*.

commit e28477f214276db941e715eebc8cdfb96c1207d9
Author: Mark Shannon <mark@hotpy.org>
Date:   Fri Mar 22 18:43:25 2024 +0000

    GH-117108: Change the size of the GC increment to about 1% of the total heap size. (GH-117120)

commit e2e0b4b4b92694ba894e02b4a66fd87c166ed10f
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Fri Mar 22 20:19:10 2024 +0200

    gh-113024: C API: Add PyObject_GenericHash() function (GH-113025)

commit 567ab3bd15398c8c7b791f3e376ae3e3c0bbe079
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Fri Mar 22 20:08:00 2024 +0200

    gh-117084: Fix ZIP file extraction for directory entry names with backslashes on Windows (GH-117129)

commit 5a78f6e798d5c2af1dba2df6c9f1f1e5aac02a86
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Fri Mar 22 20:03:48 2024 +0200

    gh-117134: Microoptimize glob() for include_hidden=True (GH-117135)

commit 00baaa21de229a6db80ff2b84c2fd6ad1999a24c
Author: Vinay Sajip <vinay_sajip@yahoo.co.uk>
Date:   Fri Mar 22 17:25:51 2024 +0000

    [docs] Fix typo in docstring and add example to logging cookbook. (GH-117157)

commit 40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f
Author: Jakub Stasiak <jakub@stasiak.at>
Date:   Fri Mar 22 17:49:56 2024 +0100

    GH-113171: Fix \"private\" (non-global) IP address ranges (GH-113179)

    * GH-113171: Fix \"private\" (really non-global) IP address ranges

    The _private_networks variables, used by various is_private
    implementations, were missing some ranges and at the same time had
    overly strict ranges (where there are more specific ranges considered
    globally reachable by the IANA registries).

    This patch updates the ranges with what was missing or otherwise
    incorrect.

    I left 100.64.0.0/10 alone, for now, as it's been made special in [1]
    and I'm not sure if we want to undo that as I don't quite understand the
    motivation behind it.

    The _address_exclude_many() call returns 8 networks for IPv4, 121
    networks for IPv6.

    [1] https://github.com/python/cpython/issues/61602

commit 3be9b9d8722696b95555937bb211dc4cda714d56
Author: Steve Dower <steve.dower@python.org>
Date:   Fri Mar 22 15:00:50 2024 +0000

    Fix get_packagefamilyname helper function on Windows 32-bit (GH-117153)

commit 63d6f2623ef2aa90f51c6a928b96845b9b380d89
Author: NGRsoftlab <78017794+NGRsoftlab@users.noreply.github.com>
Date:   Fri Mar 22 14:25:38 2024 +0300

    gh-117068: Remove useless code in bytesio.c:resize_buffer() (GH-117069)

    Co-authored-by: i.khabibulin <i.khabibulin@ngrsoftlab.ru>

commit 42ae924d278c48a719fb0ab86357f3235a9f7ab9
Author: Petr Viktorin <encukou@gmail.com>
Date:   Fri Mar 22 10:42:18 2024 +0100

    gh-117127: glob tests: Reopen dir_fd to pick up directory changes (GH-117128)

commit 8383915031942f441f435a5ae800790116047b80
Author: Tim Peters <tim.peters@gmail.com>
Date:   Thu Mar 21 22:27:25 2024 -0500

    GH-116939: Rewrite binarysort() (#116940)

    Rewrote binarysort() for clarity.

    Also changed the signature to be more coherent (it was mixing sortslice with raw pointers).

    No change in method or functionality. However, I left some experiments in, disabled for now
    via `#if` tricks. Since this code was first written, some kinds of comparisons have gotten
    enormously faster (like for lists of floats), which changes the tradeoffs.

    For example, plain insertion sort's simpler innermost loop and highly predictable branches
    leave it very competitive (even beating, by a bit) binary insertion when comparisons are
    very cheap, despite that it can do many more compares. And it wins big on runs that
    are already sorted (moving the next one in takes only 1 compare then).

    So I left code for a plain insertion sort, to make future experimenting easier.

    Also made the maximum value of minrun a `#define` (``MAX_MINRUN`) to make
    experimenting with that easier too.

    And another bit of `#if``-disabled code rewrites binary insertion's innermost loop to
    remove its unpredictable branch. Surprisingly, this doesn't really seem to help
    overall. I'm unclear on why not. It certainly adds more instructions, but they're very
    simple, and it's hard to be believe they cost as much as a branch miss.

commit 97ba910e47ad298114800587979ce7beb0a705a3
Author: Guido van Rossum <guido@python.org>
Date:   Thu Mar 21 18:27:48 2024 -0700

    gh-108716:: Remove _PyStaticCode_Init/Fini (#117141)

    More deepfreeze cleanup.

commit b3d25df8d38b79310587da54dbd88b06a16d4904
Author: Eric Snow <ericsnowcurrently@gmail.com>
Date:   Thu Mar 21 18:20:20 2024 -0600

    gh-105716: Fix _PyInterpreterState_IsRunningMain() For Embedders (gh-117140)

    When I added _PyInterpreterState_IsRunningMain() and friends last year, I tried to accommodate applications that embed Python but don't call _PyInterpreterState_SetRunningMain() (not that they're expected to).  That mostly worked fine until my recent changes in gh-117049, where the subtleties with the fallback code led to failures; the change ended up breaking test_tools.test_freeze, which exercises a basic embedding situation.

    The simplest fix is to drop the fallback code I originally added to _PyInterpreterState_IsRunningMain() (and later to _PyThreadState_IsRunningMain()).  I've kept the fallback in the _xxsubinterpreters module though.  I've also updated Py_FrozenMain() to call _PyInterpreterState_SetRunningMain().

commit c4bf58a14f162557038a1535ca22c52b49d81d7b
Author: Thomas A Caswell <tcaswell@gmail.com>
Date:   Thu Mar 21 19:54:50 2024 -0400

    gh-116745: Remove all internal usage of @LIBPYTHON@ (#116746)

    Replace with MODULE_LDFLAGS.

commit 3ec57307e70ee6f42410e844d3399bbd598917ba
Author: Malcolm Smith <smith@chaquo.com>
Date:   Thu Mar 21 23:52:29 2024 +0000

    gh-71052: Add Android build script and instructions (#116426)

commit 50f9b0b1e0fb181875751cef951351ed007b6397
Author: Victor Stinner <vstinner@python.org>
Date:   Thu Mar 21 23:17:09 2024 +0100

    gh-117061: Fix test_posix.test_sched_setaffinity() on RHEL9 (#117126)

    On RHEL9, sched_setaffinity(0, []) does not fail.

commit 0907871d43bffb613cbd560224e1a9db13d06c06
Author: Ned Batchelder <ned@nedbatchelder.com>
Date:   Thu Mar 21 15:47:09 2024 -0400

    docs: fix over-linking in dataclasses.rst (#117005)

commit 570a82d46abfebb9976961113fb0f8bb400ad182
Author: Guido van Rossum <guido@python.org>
Date:   Thu Mar 21 12:37:41 2024 -0700

    gh-117045: Add code object to function version cache (#117028)

    Changes to the function version cache:

    - In addition to the function object, also store the code object,
      and allow the latter to be retrieved even if the function has been evicted.
    - Stop assigning new function versions after a critical attribute (e.g. `__code__`)
      has been modified; the version is permanently reset to zero in this case.
    - Changes to `__annotations__` are no longer considered critical. (This fixes gh-109998.)

    Changes to the Tier 2 optimization machinery:

    - If we cannot map a function version to a function, but it is still mapped to a code object,
      we continue projecting the trace.
      The operand of the `_PUSH_FRAME` and `_POP_FRAME` opcodes can be either NULL,
      a function object, or a code object with the lowest bit set.

    This allows us to trace through code that calls an ephemeral function,
    i.e., a function that may not be alive when we are constructing the executor,
    e.g. a generator expression or certain nested functions.
    We will lose globals removal inside such functions,
    but we can still do other peephole operations
    (and even possibly [call inlining](https://github.com/python/cpython/pull/116290),
    if we decide to do it), which only need the code object.
    As before, if we cannot retrieve the code object from the cache, we stop projecting.

commit c85d84166a84a5cb2d724012726bad34229ad24e
Author: Will Childs-Klein <willck93@gmail.com>
Date:   Thu Mar 21 14:16:36 2024 -0500

    gh-116333: Relax error string text expectations in SSL-related tests (GH-116334)

    * Relax error string text expectations in SSL-related tests

    As suggested [here][1], this change relaxes the OpenSSL error string
    text expectations in a number of tests. This was specifically done in
    support of more easily building CPython [AWS-LC][2], but because AWS-LC
    is a fork of [BoringSSL][3], it should increase compatibility with that
    library as well.

    In addition to the error string relaxations, we also add some guards
    around the `tls-unique` channel binding being used with TLSv1.3, as that
    feature (described in [RFC 6929][4]) is [not defined][5] for TLSv1.3.

    [1]: https://discuss.python.org/t/support-building-ssl-and-hashlib-modules-against-aws-lc/44505/4
    [2]: https://github.com/aws/aws-lc
    [3]: https://github.com/google/boringssl
    [4]: https://datatracker.ietf.org/doc/html/rfc5929#section-3
    [5]: https://datatracker.ietf.org/doc/html/rfc8446#appendix-C.5

commit 1f72fb5447ef3f8892b4a7a6213522579c618e8e
Author: Sam Gross <colesbury@gmail.com>
Date:   Thu Mar 21 14:21:02 2024 -0400

    gh-116522: Refactor `_PyThreadState_DeleteExcept` (#117131)

    Split `_PyThreadState_DeleteExcept` into two functions:

    - `_PyThreadState_RemoveExcept` removes all thread states other than one
      passed as an argument. It returns the removed thread states as a
      linked list.

    - `_PyThreadState_DeleteList` deletes those dead thread states. It may
      call destructors, so we want to \"start the world\" before calling
      `_PyThreadState_DeleteList` to avoid potential deadlocks.

commit 50369e6c34d05222e5a0ec9443a9f7b230e83112
Author: Michael Droettboom <mdboom@gmail.com>
Date:   Thu Mar 21 13:27:46 2024 -0400

    gh-116996: Add pystats about _Py_uop_analyse_and_optimize (GH-116997)

commit 617158e07811edfd6fd552a3d84b0beedd8f1d18
Author: Eric Snow <ericsnowcurrently@gmail.com>
Date:   Thu Mar 21 11:15:02 2024 -0600

    gh-76785: Drop PyInterpreterID_Type (gh-117101)

    I added it quite a while ago as a strategy for managing interpreter lifetimes relative to the PEP 554 (now 734) implementation.  Relatively recently I refactored that implementation to no longer rely on InterpreterID objects.  Thus now I'm removing it.

commit abdd1f938f08e536864532b2071f144515ecc88b
Author: Victor Stinner <vstinner@python.org>
Date:   Thu Mar 21 17:45:43 2024 +0100

    gh-85283: Build _testconsole extension with limited C API (#117125)

commit 8bea6c411d65cd987616b4ecdb86373e4f21f1c6
Author: Victor Stinner <vstinner@python.org>
Date:   Thu Mar 21 17:07:00 2024 +0100

    gh-115754: Add Py_GetConstant() function (#116883)

    Add Py_GetConstant() and Py_GetConstantBorrowed() functions.

    In the limited C API version 3.13, getting Py_None, Py_False,
    Py_True, Py_Ellipsis and Py_NotImplemented singletons is now
    implemented as function calls at the stable ABI level to hide
    implementation details. Getting these constants still return borrowed
    references.

    Add _testlimitedcapi/object.c and test_capi/test_object.py to test
    Py_GetConstant() and Py_GetConstantBorrowed() functions.

commit 5a76d1be8ef371b75ca65166726923c249b5f615
Author: Eric Snow <ericsnowcurrently@gmail.com>
Date:   Thu Mar 21 10:06:35 2024 -0600

    gh-105716: Update interp->threads.main After Fork (gh-117049)

    I missed this in gh-109921.

    We also update Py_Exit() to call _PyInterpreterState_SetNotRunningMain(), if necessary.

commit bbee57fa8c318cb26d6c8651254927a1972c9738
Author: Eric Snow <ericsnowcurrently@gmail.com>
Date:   Thu Mar 21 09:56:12 2024 -0600

    gh-76785: Clean Up Interpreter ID Conversions (gh-117048)

    Mostly we unify the two different implementations of the conversion code (from PyObject * to int64_t.  We also drop the PyArg_ParseTuple()-style converter function, as well as rename and move PyInterpreterID_LookUp().

commit e728303532168efab7694c55c82ea19b18bf8385
Author: Sam Gross <colesbury@gmail.com>
Date:   Thu Mar 21 10:01:16 2024 -0400

    gh-116522: Stop the world before fork() and during shutdown (#116607)

    This changes the free-threaded build to perform a stop-the-world pause
    before deleting other thread states when forking and during shutdown.
    This fixes some crashes when using multiprocessing and during shutdown
    when running with `PYTHON_GIL=0`.

    This also changes `PyOS_BeforeFork` to acquire the runtime lock
    (i.e., `HEAD_LOCK(&_PyRuntime)`) before forking to ensure that data
    protected by the runtime lock (and not just the GIL or stop-the-world)
    is in a consistent state before forking.

commit 1f8b24ef69896680d6ba6005e75e1cc79a744f9e
Author: Malcolm Smith <smith@chaquo.com>
Date:   Thu Mar 21 13:20:57 2024 +0000

    gh-71052: Implement `ctypes.util.find_library` on Android (GH-116379)

commit d16c9d1278164f04778861814ebc87ed087511fc
Author: Tian Gao <gaogaotiantian@hotmail.com>
Date:   Thu Mar 21 03:30:10 2024 -0700

    gh-116987: Support class code objects in inspect.findsource() (GH-117025)

commit 6547330f4e896c6748da23704b617e060e6cc68e
Author: Adam Turner <9087854+AA-Turner@users.noreply.github.com>
Date:   Thu Mar 21 03:49:10 2024 +0000

    GH-109653: Defer import of ``importlib.metadata._adapters`` (#109829)

    * adapters

    * Add comments for deferred imports with links to rationale.

    * Add blurb

    ---------

    Co-authored-by: Jason R. Coombs <jaraco@jaraco.com>

commit 667294d5b2ee812ebe0c9c1efd58e2006b61f827
Author: Jason R. Coombs <jaraco@jaraco.com>
Date:   Wed Mar 20 23:01:24 2024 -0400

    gh-117089: Apply changes from importlib_metadata 7.1.0 (#117094)

    * Apply changes from importlib_metadata 7.1.0

    * Include the data sources in the makefile (even though they're not needed)

commit f4cc77d494ee0e10ed84ce369f0910c70a2f6d44
Author: Victor Stinner <vstinner@python.org>
Date:   Thu Mar 21 00:06:24 2024 +0100

    gh-116869: Enable -Werror in test_cext for Free Threading (#117106)

    Check for warnings, but don't enable the compiler flag
    -Werror=declaration-after-statement.

commit 104602a6078564765b7b8f42888f8eaa37b129b1
Author: Victor Stinner <vstinner@python.org>
Date:   Wed Mar 20 23:52:23 2024 +0100

    gh-105927: Limit PyWeakref_GetRef() to limited C API 3.13 (#117091)

commit 8ad88984200b2ccddc0a08229dd2f4c14d1a71fc
Author: Jason R. Coombs <jaraco@jaraco.com>
Date:   Wed Mar 20 17:11:00 2024 -0400

    gh-117089: Move importlib.metadata tests to their own package (#117092)

    * Ensure importlib.metadata tests do not leak references in sys.modules.

    * Move importlib.metadata tests to their own package for easier syncing with importlib_metadata.

    * Update owners and makefile for new directories.

    * Add blurb

commit 7d446548ef53f6c3de1097c6d44cada6642ddc85
Author: Carol Willing <carolcode@willingconsulting.com>
Date:   Wed Mar 20 14:00:59 2024 -0700

    Fix sort order for \"locale encoding\" glossary item (#115794)

    Co-authored-by: C.A.M. Gerlach <CAM.Gerlach@Gerlach.CAM>

commit 63289b9dfbc7d87e81f1517422ee91b6b6d19531
Author: Mark Shannon <mark@hotpy.org>
Date:   Wed Mar 20 18:24:02 2024 +0000

    GH-117066: Tier 2 optimizer: Don't throw away good traces if we can't optimize them perfectly. (GH-117067)

commit dcaf33a41d5d220523d71c9b35bc08f5b8405dac
Author: Petr Viktorin <encukou@gmail.com>
Date:   Wed Mar 20 17:33:08 2024 +0100

    gh-114314: ctypes: remove stgdict and switch to heap types (GH-116458)

    Before this change, ctypes classes used a custom dict subclass, `StgDict`,
    as their `tp_dict`. This acts like a regular dict but also includes extra information
    about the type.

    This replaces stgdict by `StgInfo`, a C struct on the type, accessed by
    `PyObject_GetTypeData()` (PEP-697).
    All usage of `StgDict` (mainly variables named `stgdict`, `dict`, `edict` etc.) is
    converted to `StgInfo` (named `stginfo`, `info`, `einfo`, etc.).
    Where the dict is actually used for class attributes (as a regular PyDict), it's now
    called `attrdict`.

    This change -- not overriding `tp_dict` -- is made to make me comfortable with
    the next part of this PR: moving the initialization logic from `tp_new` to `tp_init`.

    The `StgInfo` is set up in `__init__` of each class, with a guard that prevents
    calling `__init__` more than once. Note that abstract classes (like `Array` or
    `Structure`) are created using `PyType_FromMetaclass` and do not have
    `__init__` called.
    Previously, this was done in `__new__`, which also wasn't called for abstract
    classes.
    Since `__init__` can be called from Python code or skipped, there is a tested
    guard to ensure `StgInfo` is initialized exactly once before it's used.

    Co-authored-by: neonene <53406459+neonene@users.noreply.github.com>
    Co-authored-by: Erlend E. Aasland <erlend.aasland@protonmail.com>

commit 44fbab43d8f3f2df07091d237824cf4fa1f6c57c
Author: Russell Keith-Magee <russell@keith-magee.com>
Date:   Wed Mar 20 23:32:56 2024 +0800

    gh-117058: Update GUI and packaging recommendations for macOS. (#117059)

commit 9221ef2d8cb7f4cf37592eb650d4c8f972033000
Author: Brett Simmers <swtaarrs@users.noreply.github.com>
Date:   Wed Mar 20 08:18:26 2024 -0700

    gh-116908: Only write to `_pending_calls.calls_to_do` with atomic operations (#117044)

    These writes to `pending->calls_to_do` need to be atomic, because other threads
    can read (atomically) from `calls_to_do` without holding `pending->mutex`.

commit fc4599800778f9b130d5e336deadbdeb5bd3e5ee
Author: jkriegshauser <jkriegshauser@gmail.com>
Date:   Wed Mar 20 07:33:28 2024 -0700

    gh-116773: Ensure overlapped objects on Windows are not deallocated too early by asyncio (GH-116774)

commit 519b2ae22b54760475bbf62b9558d453c703f9c6
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Wed Mar 20 15:39:53 2024 +0200

    gh-117021: Fix integer overflow in PyLong_AsPid() on non-Windows 64-bit platforms (GH-117064)")`
…

`[1b5fe4c](/NGRsoftlab/cpython/commit/1b5fe4cad096e32efee3a0477ef6f277ec2a2b96)`

```
commit 9dae05ee59eeba0e67af2a46f2a2907c9f8d7e4a
Author: Moshe Kaplan <mosheekaplan@gmail.com>
Date:   Mon Apr 1 15:53:00 2024 -0400

    Docs: specify XML document name in xml.etree.elementtree example (#24223)

commit fc2071687b708598264a3403b7f9104667c1092f
Author: Matthew Davis <7035647+mdavis-xyz@users.noreply.github.com>
Date:   Mon Apr 1 21:49:14 2024 +0200

    Docs: add more links to PIPE in subprocess docs (#25416)

commit fc8007ee3635db6ab73e132ebff987c910b6d538
Author: Barney Gale <barney.gale@gmail.com>
Date:   Mon Apr 1 20:37:41 2024 +0100

    GH-117337: Deprecate `glob.glob0()` and `glob.glob1()`. (#117371)

    These undocumented functions are no longer used by `msilib`, so there's no
    reason to keep them around.

commit c741ad3537193c63fe697a8f0316aecd45eeb9ba
Author: Justin Turner Arthur <justinarthur@gmail.com>
Date:   Mon Apr 1 12:07:29 2024 -0500

    gh-77714: Provide an async iterator version of as_completed (GH-22491)

    * as_completed returns object that is both iterator and async iterator
    * Existing tests adjusted to test both the old and new style
    * New test to ensure iterator can be resumed
    * New test to ensure async iterator yields any passed-in Futures as-is

    Co-authored-by: Serhiy Storchaka <storchaka@gmail.com>
    Co-authored-by: Guido van Rossum <gvanrossum@gmail.com>

commit ddf814db744006e0f42328aa15ace97c9d8ad681
Author: Guido van Rossum <guido@python.org>
Date:   Mon Apr 1 09:13:38 2024 -0700

    Silence compiler warnings in gc.c (#117422)

commit 179869af922252a0c1cef65fd2923856895e7d1b
Author: Petr Viktorin <encukou@gmail.com>
Date:   Mon Apr 1 17:01:22 2024 +0200

    gh-94808: Fix refcounting in PyObject_Print tests (GH-117421)

commit dd44ab994b7262f0704d64996e0a1bc37b233407
Author: neonene <53406459+neonene@users.noreply.github.com>
Date:   Mon Apr 1 22:28:14 2024 +0900

    gh-117142: ctypes: Unify meta tp slot functions (GH-117143)

    Integrates the following ctypes meta tp slot functions:
    * `CDataType_traverse()` into `CType_Type_traverse()`.
    * `CDataType_clear()` into `CType_Type_clear()`.
    * `CDataType_dealloc()` into `CType_Type_dealloc()`.
    * `CDataType_repeat()` into `CType_Type_repeat()`.

commit 3de09cadde788065a4f2d45117e789c9353bbd12
Author: Steve (Gadget) Barnes <gadgetsteve@hotmail.com>
Date:   Mon Apr 1 14:02:07 2024 +0100

    gh-91565: Replace bugs.python.org links with Devguide/GitHub ones  (GH-91568)

    Co-authored-by: Hugo van Kemenade <hugovk@users.noreply.github.com>
    Co-authored-by: Oleg Iarygin <oleg@arhadthedev.net>
    Co-authored-by: Petr Viktorin <encukou@gmail.com>
    Co-authored-by: Ezio Melotti <ezio.melotti@gmail.com>

commit 90c3c68a658db6951b77a5be50088ec2f6adc8eb
Author: MonadChains <monadchains@gmail.com>
Date:   Mon Apr 1 13:52:25 2024 +0100

    gh-94808:Improve coverage of PyObject_Print (GH-98749)

commit 348cf6e0078eae156c503e8f61ef5e27ae28e57b
Author: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Date:   Mon Apr 1 11:14:37 2024 +0000

    Bump mypy from 1.8.0 to 1.9.0 in /Tools (#117418)

    Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
    Co-authored-by: Alex Waygood <Alex.Waygood@Gmail.com>

commit 9b403fb559bfce93a478937e0ef7e539a9a95283
Author: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Date:   Mon Apr 1 11:05:14 2024 +0000

    build(deps-dev): bump types-psutil from 5.9.5.20240205 to 5.9.5.20240316 in /Tools (#117417)

    Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
    Co-authored-by: Alex Waygood <Alex.Waygood@Gmail.com>

commit 93c7d9d17b571b6a181af7c02830d29819535c35
Author: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Date:   Mon Apr 1 11:38:38 2024 +0100

    build(deps-dev): bump types-setuptools from 69.1.0.20240301 to 69.2.0.20240317 in /Tools (#117419)

    Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

commit 3bb12e407c183946471272f8aee098e54e62a333
Author: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Date:   Mon Apr 1 09:54:33 2024 +0000

    build(deps): bump actions/add-to-project from 0.6.0 to 1.0.0 (#117415)

    Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

commit 56e99307c49adcc6df355f8070229371c97d654f
Author: Adorilson Bezerra <adorilson@gmail.com>
Date:   Sun Mar 31 23:34:54 2024 +0100

    Doc: printf-style library/stdtype improvements (#16741)

commit 18e12641a61a88f7d08b2114ebe965892c6661c5
Author: Raymond Hettinger <rhettinger@users.noreply.github.com>
Date:   Sun Mar 31 16:09:22 2024 -0500

    gh-117387 Remove hash mark from introductory text (#117409)

commit a32d6939486d7f90ee57e215077f6116e19de24d
Author: Deborah <32307299+dlwrnc@users.noreply.github.com>
Date:   Sun Mar 31 22:11:48 2024 +0200

    gh-102190: Add additional zipfile `pwd=` arg docstrings (gh-102195)

    This just documents the parameter that already exists.

    ---------

    Co-authored-by: Gregory P. Smith <greg@krypto.org>
    Co-authored-by: Erlend E. Aasland <erlend.aasland@protonmail.com>

commit 262445358e21c56d7c68e3ee76c13e469d2ea348
Author: Shantanu <12621235+hauntsaninja@users.noreply.github.com>
Date:   Sun Mar 31 12:02:48 2024 -0700

    Link to the Python type system specification (#117400)

commit 752e18389ed03087b51b38eac9769ef8dfd167b7
Author: Barney Gale <barney.gale@gmail.com>
Date:   Sun Mar 31 19:14:48 2024 +0100

    GH-114575: Rename `PurePath.pathmod` to `PurePath.parser` (#116513)

    And rename the private base class from `PathModuleBase` to `ParserBase`.

commit bfc57d43d8766120ba0c8f3f6d7b2ac681a81d8a
Author: Sam Gross <colesbury@gmail.com>
Date:   Fri Mar 29 18:58:08 2024 -0400

    gh-117303: Don't detach in `PyThreadState_DeleteCurrent()` (#117304)

    This fixes a crash in `test_threading.test_reinit_tls_after_fork()` when
    running with the GIL disabled. We already properly handle the case where
    the thread state is `_Py_THREAD_ATTACHED` in `tstate_delete_common()` --
    we just need to remove an assertion.

    Keeping the thread attached means that a stop-the-world pause, such as
    for a `fork()`, won't commence until we remove our thread state from the
    interpreter's linked list. This prevents a crash when the child process
    tries to clean up the dead thread states.

commit 05e0b67a43c5c1778dc2643c8b7c12864e135999
Author: Erlend E. Aasland <erlend@python.org>
Date:   Fri Mar 29 21:23:28 2024 +0100

    gh-116664: In _warnings.c, make filters_version access thread-safe (#117374)

    - assert that the lock is held in already_warned()
    - protect 'filters_version' increment in warnings_filters_mutated_impl()

commit 019143fecbfc26e69800d28d2a9e3392a051780b
Author: Jason R. Coombs <jaraco@jaraco.com>
Date:   Fri Mar 29 16:06:09 2024 -0400

    gh-117348: Refactored RawConfigParser._read for similicity and comprehensibility (#117372)

    * Extract method for _read_inner, reducing complexity and indentation by 1.

    * Extract method for _raise_all and yield ParseErrors from _read_inner.

    Reduces complexity by 1 and reduces touch points for handling errors in _read_inner.

    * Prefer iterators to splat expansion and literal indexing.

    * Extract method for _strip_comments. Reduces complexity by 7.

    * Model the file lines in a class to encapsulate the comment status and cleaned value.

    * Encapsulate the read state as a dataclass

    * Extract _handle_continuation_line and _handle_rest methods. Reduces complexity by 8.

    * Reindent

    * At least for now, collect errors in the ReadState

    * Check for missing section header separately.

    * Extract methods for _handle_header and _handle_option. Reduces complexity by 6.

    * Remove unreachable code. Reduces complexity by 4.

    * Remove unreachable branch

    * Handle error condition early. Reduces complexity by 1.

    * Add blurb

    * Move _raise_all to ParsingError, as its behavior is most closely related to the exception class and not the reader.

    * Split _strip* into separate methods.

    * Refactor _strip_full to compute the strip just once and use 'not any' to determine the factor.

    * Replace use of 'sys.maxsize' with direct computation of the stripped value.

    * Extract has_comments as a dynamic property.

    * Implement clean as a cached property.

    * Model comment prefixes in the RawConfigParser within a prefixes namespace.

    * Use a regular expression to search for the first match.

    Avoids mutating variables and tricky logic and over-computing all of the starts when only the first is relevant.

commit 01bd74eadbc4ff839d39762fae6366f50c1e116e
Author: Sam Gross <colesbury@gmail.com>
Date:   Fri Mar 29 15:33:06 2024 -0400

    gh-117300: Use stop the world to make `sys._current_frames` and `sys._current_exceptions` thread-safe. (#117301)

    This adds a stop the world pause to make the two functions thread-safe
    when the GIL is disabled in the free-threaded build.

    Additionally, the main test thread may call `sys._current_exceptions()` as
    soon as `g_raised.set()` is called. The background thread may not yet reach
    the `leave_g.wait()` line.

commit 94c97423a9c4969f8ddd4a3aa4aacb99c4d5263d
Author: Guido van Rossum <guido@python.org>
Date:   Fri Mar 29 11:31:09 2024 -0700

    Fix broken format in error for bad input in summarize_stats.py (#117375)

    When you pass the script a non-existent input file, you get a TypeError instead of the intended ValueError.

commit 5d21d884b6ffa45dac50a5f9a07c41356a8478b4
Author: mpage <mpage@meta.com>
Date:   Fri Mar 29 10:42:02 2024 -0700

    gh-111926: Avoid locking in PyType_IsSubtype (#117275)

    Read the MRO in a thread-unsafe way in `PyType_IsSubtype` to avoid locking. Fixing this is tracked in #117306.

    The motivation for this change is in support of making weakrefs thread-safe in free-threaded builds:

    `WeakValueDictionary` uses a special dictionary function, `_PyDict_DelItemIf`
    to remove dead weakrefs from the dictionary. `_PyDict_DelItemIf` removes a key
    if a user supplied predicate evaluates to true for the value associated with
    the key. Crucially for the `WeakValueDictionary` use case, the predicate
    evaluation + deletion sequence is atomic, provided that the predicate doesn’t
    suspend. The predicate used by `WeakValueDictionary` includes a subtype check,
    which we must ensure doesn't suspend in free-threaded builds.

commit 19c1dd60c5b53fb0533610ad139ef591294f26e8
Author: Sam Gross <colesbury@gmail.com>
Date:   Fri Mar 29 13:35:43 2024 -0400

    gh-117323: Make `cell` thread-safe in free-threaded builds (#117330)

    Use critical sections to lock around accesses to cell contents. The critical sections are no-ops in the default (with GIL) build.

commit 397d88db5e9ab2a43de3fdf5f8b973a949edc405
Author: Sam Gross <colesbury@gmail.com>
Date:   Fri Mar 29 13:34:04 2024 -0400

    gh-117344: Skip flaky tests in free-threaded build (#117355)

    The tests are not reliable with the GIL disabled. In theory, they can
    fail with the GIL enabled too, but the failures are much more likely
    with the GIL disabled.

commit f05fb2e65c2dffdfae940f2707765c4994925205
Author: Sam Gross <colesbury@gmail.com>
Date:   Fri Mar 29 13:33:04 2024 -0400

    gh-112529: Don't untrack tuples or dicts with zero refcount (#117370)

    The free-threaded GC sometimes sees objects with zero refcount. This can
    happen due to the delay in merging biased reference counting fields,
    and, in the future, due to deferred reference counting. We should not
    untrack these objects or they will never be collected.

    This fixes the refleaks in the free-threaded build.

commit ddf95b5f16031cdbd0d728e55eb06dff002a8678
Author: Erlend E. Aasland <erlend@python.org>
Date:   Fri Mar 29 18:26:06 2024 +0100

    gh-116664: Fix unused var warnings in _warnings.c in non-free-threaded builds (#117373)

    The warnings were introduced by commit c1712ef06.

commit 0fa571dbcdf19b541276cb00bb929381930467b2
Author: Tian Gao <gaogaotiantian@hotmail.com>
Date:   Fri Mar 29 09:02:01 2024 -0700

    Refactor pdb executable targets (#112570)

    Co-authored-by: Jason R. Coombs <jaraco@jaraco.com>

commit 54f7e14500471d1c46fb553adb3ca24cd1fef084
Author: Pedro Lacerda <pslacerda@users.noreply.github.com>
Date:   Fri Mar 29 12:05:00 2024 -0300

    gh-66449: configparser: Add support for unnamed sections (#117273)

    Co-authored-by: Jason R. Coombs <jaraco@jaraco.com>

commit d9cfe7e565a6e2dc15747a904736264e31a10be4
Author: Nikita Sobolev <mail@sobolevn.me>
Date:   Fri Mar 29 14:14:25 2024 +0300

    gh-117166: Ignore empty and temporary dirs in `test_makefile` (#117190)

commit 35b6c4a4da201a947b2ceb96ae4c0d83d4d2df4f
Author: Victor Stinner <vstinner@python.org>
Date:   Fri Mar 29 11:25:17 2024 +0100

    gh-117347: Fix test_clinic side effects (#117363)

    Save/restore converters in ClinicWholeFileTest and
    ClinicExternalTest.

commit 7e2fef865899837c47e91ef0180fa59eb03e840b
Author: neonene <53406459+neonene@users.noreply.github.com>
Date:   Fri Mar 29 18:40:48 2024 +0900

    gh-117142: ctypes: Migrate global vars to module state (GH-117189)

commit 2e9be80c99f635c2f7761e8356b0260922d6e7a6
Author: Gregory P. Smith <greg@krypto.org>
Date:   Thu Mar 28 17:58:37 2024 -0700

    Fix reversed assertRegex checks in test_ssl. (#117351)

commit 8eec7ed714e65d616573b7331780b0aa43c6ed6a
Author: 傅立业（Chris Fu） <17433201@qq.com>
Date:   Fri Mar 29 08:19:20 2024 +0800

    gh-117110: Fix subclasses of typing.Any with custom constructors (#117111)

commit a17f313e3958e825db9a83594c8471a984316536
Author: Christopher Chianelli <christopher@timefold.ai>
Date:   Thu Mar 28 18:26:56 2024 -0400

    gh-117339: Use NULL instead of None for LOAD_SUPER_ATTR in dis docs (GH-117343)

commit 26d328b2ba26374fb8d9ffe8215ecef7c5e3f7a2
Author: Michael Droettboom <mdboom@gmail.com>
Date:   Thu Mar 28 18:23:08 2024 -0400

    GH-117121: Add pystats to JIT builds (GH-117346)

commit 14f1ca7d5363386163839b31ce987423daecc3de
Author: Nice Zombies <nineteendo19d0@gmail.com>
Date:   Thu Mar 28 22:20:08 2024 +0100

    gh-117335: Handle non-iterables for `ntpath.commonpath` (GH-117336)

commit 18cf239e39e25e6cef50ecbb7f197a82f8920ff5
Author: Brandt Bucher <brandtbucher@microsoft.com>
Date:   Thu Mar 28 14:02:34 2024 -0700

    Increase the JIT CI timeouts to 75 minutes (GH-117342)

commit 29829b58a8328a7c2ccacaa74c1d7d120a5e5ca5
Author: Malcolm Smith <smith@chaquo.com>
Date:   Thu Mar 28 19:59:12 2024 +0000

    gh-117294: Report DocTestCase as skipped if all examples in the doctest are skipped (GH-117297)

commit efcc96844e7c66fcd6c23ac2d557ca141614ce9a
Author: Tian Gao <gaogaotiantian@hotmail.com>
Date:   Thu Mar 28 11:23:29 2024 -0700

    gh-69201: Separate stdout and stderr stream in test_pdb (#117308)

commit 6702d2bf6edcd5b5415e17837383623b9d76a5b8
Author: Victor Stinner <vstinner@python.org>
Date:   Thu Mar 28 17:40:58 2024 +0100

    gh-114331: Skip decimal test_maxcontext_exact_arith on s390x (#117326)

commit c1712ef066321c01bf09cba3f22fc474b5b8dfa7
Author: Erlend E. Aasland <erlend@python.org>
Date:   Thu Mar 28 16:05:08 2024 +0100

    gh-116664: Make module state Py_SETREF's in _warnings thread-safe (#116959)

    Mark the swap operations as critical sections.

    Add an internal Py_BEGIN_CRITICAL_SECTION_MUT API that takes a PyMutex
    pointer instead of a PyObject pointer.

commit 9a388b9a64927c372d85f0eaec3de9b7320a6fb5
Author: Joachim Wuttke <j.wuttke@fz-juelich.de>
Date:   Thu Mar 28 14:43:07 2024 +0100

    bpo-43848: explain optional argument mtime in gzip.py. (GH-25410)

    Co-authored-by: Jelle Zijlstra <jelle.zijlstra@gmail.com>

commit 8dbfdb2957a7baade3a88661517f163ad694c39f
Author: Sam Gross <colesbury@gmail.com>
Date:   Thu Mar 28 09:28:39 2024 -0400

    gh-110481: Fix biased reference counting queue initialization. (#117271)

    The biased reference counting queue must be initialized from the bound
    (active) thread because it uses `_Py_ThreadId()` as the key in a hash
    table.

commit 9a1e55b8c5723206116f7016921be3937ef2f4e5
Author: Chris Markiewicz <effigies@gmail.com>
Date:   Thu Mar 28 06:59:31 2024 -0400

    gh-117178: Recover lazy loading of self-referential modules (#117179)

commit 4c71d51a4b7989fc8754ba512c40e21666f9db0d
Author: Jelle Zijlstra <jelle.zijlstra@gmail.com>
Date:   Thu Mar 28 04:30:31 2024 -0600

    gh-117266: Fix crashes on user-created AST subclasses (GH-117276)

    Fix crashes on user-created AST subclasses

commit 8cb7d7ff86a1a2d41195f01ba4f218941dd7308c
Author: Gregory P. Smith <greg@krypto.org>
Date:   Thu Mar 28 03:11:58 2024 -0700

    gh-117310: Remove extra DECREF on "no ciphers" error path in `_ssl._SSLContext` constructor (#117309)

    Remove extra self DECREF on ssl "no ciphers" error path.

    This doesn't come up in practice because nobody links against a broken
    OpenSSL library that provides nothing.

commit 6c8ac8a32fd6de1960526561c44bc5603fab0f3e
Author: Erlend E. Aasland <erlend@python.org>
Date:   Thu Mar 28 09:40:37 2024 +0100

    gh-116303: Handle disabled test modules in test.support helpers (#116482)

    Make sure test.support helpers skip iso. failing if test extension
    modules are disabled. Also log TEST_MODULES in test.pythoninfo.

commit 0f27672c5002de96c9f1228b12460d5ce3f1d190
Author: Russell Keith-Magee <russell@keith-magee.com>
Date:   Thu Mar 28 16:13:13 2024 +0800

    gh-114099: Add documentation for iOS platform (GH-117057)

    Co-authored-by: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>
    Co-authored-by: Jacob Coffee <jacob@z7x.org>
    Co-authored-by: Malcolm Smith <smith@chaquo.com>
    Co-authored-by: Ned Deily <nad@python.org>

commit f006338017cfbf846e8f7391b9ee5f69df8dc620
Author: Russell Keith-Magee <russell@keith-magee.com>
Date:   Thu Mar 28 15:59:33 2024 +0800

    gh-114099: Additions to standard library to support iOS (GH-117052)

    Co-authored-by: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>
    Co-authored-by: Malcolm Smith <smith@chaquo.com>
    Co-authored-by: Ned Deily <nad@python.org>

commit b44898299a2ed97045c270f6474785da2ff07ced
Author: Tim Hatch <tim@timhatch.com>
Date:   Wed Mar 27 23:54:51 2024 -0700

    gh-89739: gh-77140: Support zip64 in zipimport (GH-94146)

    * Reads zip64 files as produced by the zipfile module
    * Include tests (somewhat slow, however, because of the need to create "large" zips)
    * About the same amount of strictness reading invalid zip files as zipfile has
    * Still works on files with prepended data (like pex)

    There are a lot more test cases at https://github.com/thatch/zipimport64/ that give me confidence that this works for real-world files.

    Fixes #89739 and #77140.

    ---------

    Co-authored-by: Itamar Ostricher <itamarost@gmail.com>
    Reviewed-by: Gregory P. Smith <greg@krypto.org>

commit 2cedd25c14d3acfdcb5e8ee55132ce3e334ab8fe
Author: Illia Volochii <illia.volochii@gmail.com>
Date:   Thu Mar 28 08:46:01 2024 +0200

    Revert "gh-116886: Temporarily disable CIfuzz (memory) (GH-117018)" (GH-117289)

    This reverts commit 1ab0d0b1167d78bf19661a3b5e533a2b68a57604.

    This reverts #117018.

    I expect the issue to be fixed based on https://github.com/google/oss-fuzz/pull/11708#issuecomment-2006442396 and https://github.com/actions/runner-images/issues/9491.

commit eefff682f09394fe4f18b7d7c6ac4c635caadd02
Author: Malcolm Smith <smith@chaquo.com>
Date:   Wed Mar 27 22:11:44 2024 +0000

    gh-108277: Make test_os tolerate 10 ms diff for timerfd on Android emulators (#117223)

commit 7aa89bc43e0bcf49eee5a39b5a7ba8f996f20d00
Author: Victor Stinner <vstinner@python.org>
Date:   Wed Mar 27 23:10:14 2024 +0100

    gh-113317: Change how Argument Clinic lists converters (#116853)

    * Add a new create_parser_namespace() function for
      PythonParser to pass objects to executed code.
    * In run_clinic(), list converters using 'converters' and
      'return_converters' dictionarties.
    * test_clinic: add 'object()' return converter.
    * Use also create_parser_namespace() in eval_ast_expr().

    Co-authored-by: Erlend E. Aasland <erlend@python.org>

commit 669ef49c7d42f35da6f7ee280102353b9b37f83e
Author: Seth Michael Larson <seth@python.org>
Date:   Wed Mar 27 16:56:14 2024 -0500

    gh-99108: Update and check HACL* version information (GH-117295)

    * Update and check HACL* version information

commit 262fb911ab7df8e890ebd0efb0773c3e0b5a757f
Author: Irit Katriel <1055913+iritkatriel@users.noreply.github.com>
Date:   Wed Mar 27 17:38:19 2024 +0000

    gh-117288: Allocate fewer label IDs in _PyCfg_ToInstructionSequence (#117290)

commit 74c8568d07719529b874897598d8b3bc25ff0434
Author: Malcolm Smith <smith@chaquo.com>
Date:   Wed Mar 27 16:53:27 2024 +0000

    gh-71042: Add `platform.android_ver` (#116674)

commit ce00de4c8cd39816f992e749c1074487d93abe9d
Author: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>
Date:   Wed Mar 27 16:46:35 2024 +0200

    gh-117225: doctest: only print "and X failed" when non-zero, don't pluralise "1 items" (#117228)

commit 92397d5ead38dde4154e70d00f24973bcf2a925a
Author: Raymond Hettinger <rhettinger@users.noreply.github.com>
Date:   Wed Mar 27 09:04:32 2024 -0500

    Add statistics recipe for sampling from an estimated probability density distribution (#117221)

commit b3e8c78ed7aa9bbd1084375587b99200c687cec9
Author: Tian Gao <gaogaotiantian@hotmail.com>
Date:   Tue Mar 26 18:20:12 2024 -0700

    gh-113548: Allow CLI arguments to `pdb -m` (#113557)

commit 48c0b05cf0dd2db275bd4653f84aa36c22bddcd2
Author: Adorilson Bezerra <adorilson@gmail.com>
Date:   Tue Mar 26 19:08:08 2024 +0000

    Change links on the index page (#117230)

commit af1b0e94400d1bf732466d675054df8cf7dfb62d
Author: AN Long <aisk@users.noreply.github.com>
Date:   Wed Mar 27 02:26:48 2024 +0800

    gh-104242: Enable test_is_char_device_true in pathlib test on all platform (GH-116983)

commit 79be75735c9d77972112cecc8d7e1af28c176ed0
Author: Irit Katriel <1055913+iritkatriel@users.noreply.github.com>
Date:   Tue Mar 26 15:18:17 2024 +0000

    gh-115775: Compiler adds __static_attributes__ field to classes (#115913)

commit 70969d53a77a8a190c40a30419e772bc874a4f62
Author: Antonio <57417288+amaddio@users.noreply.github.com>
Date:   Tue Mar 26 15:10:29 2024 +0100

    gh-97901 add missing text/rtf to mimetypes (GH-97902)

    Co-authored-by: Noam Cohen <noam@noam.me>

commit 4ec347760f98b156c6a2d42ca397af6b0b6ecc50
Author: AN Long <aisk@users.noreply.github.com>
Date:   Tue Mar 26 22:09:57 2024 +0800

    gh-115538: Use isolate mode when running venv test_multiprocessing_recursion() (#117116)

    Co-authored-by: Victor Stinner <vstinner@python.org>

commit 743f2c68f478279e1e56577fe95a0ed112b9abc5
Author: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>
Date:   Tue Mar 26 16:09:09 2024 +0200

    pre-commit: add `check-case-conflict` and `check-merge-conflict` (#117259)

commit 4abca7e1e7e2764faf20c7e677ea5c9ea9dbffe2
Author: Paulo Neves <ptsneves@users.noreply.github.com>
Date:   Tue Mar 26 13:37:50 2024 +0100

    gh-98966: Handle stdout=subprocess.STDOUT (GH-98967)

    Explicitly handle the case where stdout=STDOUT
    as otherwise the existing error handling gets
    confused and reports hard to understand errors.

    Signed-off-by: Paulo Neves <ptsneves@gmail.com>

commit 9654daf793b534b44a831c80f43505ab9e380f1f
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Tue Mar 26 13:26:45 2024 +0200

    gh-66543: Fix mimetype.guess_type() (GH-117217)

    Fix parsing of the following corner cases:

    * URLs with only a host name
    * URLs containing a fragment
    * URLs containing a query
    * filenames with only a UNC sharepoint on Windows

    Co-authored-by: Dong-hee Na <donghee.na92@gmail.com>

commit 8bef34f625e21886b1c64544c060e19ee2e229bf
Author: Mark Shannon <mark@hotpy.org>
Date:   Tue Mar 26 11:11:42 2024 +0000

    GH-117108: Set the "old space bit" to "visited" for all young objects  (#117213)

    Change old space bit of young objects from 0 to gcstate->visited_space.
    This ensures that any object created *and* collected during cycle GC has the bit set correctly.

commit bf82f77957a31c3731b4ec470c406f5708ca9ba3
Author: Mark Shannon <mark@hotpy.org>
Date:   Tue Mar 26 09:35:11 2024 +0000

    GH-116422: Tier2 hot/cold splitting (GH-116813)

    Splits the "cold" path, deopts and exits, from the "hot" path, reducing the size of most jitted instructions, at the cost of slower exits.

commit 61599a48f52e951d8813877ee311d2a830ba2cd8
Author: Pablo Galindo Salgado <Pablogsal@gmail.com>
Date:   Tue Mar 26 09:30:46 2024 +0000

    bpo-24612: Improve syntax error for 'not' after an operator (GH-28170)

    Co-authored-by: Lysandros Nikolaou <lisandrosnik@gmail.com>

commit 771902c257372e6c4df1ead4e8c46308561db7a7
Author: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>
Date:   Tue Mar 26 11:13:32 2024 +0200

    gh-83845: Add tests for operator module (#115883)

    Co-authored-by: Karthikeyan Singaravelan <tir.karthi@gmail.com>

commit ea9a296fce2f786b4cf43c7924e5de01061f27ca
Author: yevgeny hong <hongyevgeny@gmail.com>
Date:   Tue Mar 26 16:45:43 2024 +0900

    gh-115627: Fix PySSL_SetError handling SSL_ERROR_SYSCALL (GH-115628)

    Python 3.10 changed from using SSL_write() and SSL_read() to SSL_write_ex() and
    SSL_read_ex(), but did not update handling of the return value.

    Change error handling so that the return value is not examined.
    OSError (not EOF) is now returned when retval is 0.

    According to *recent* man pages of all functions for which we call
    PySSL_SetError, (in OpenSSL 3.0 and 1.1.1), their return value should
    be used to determine whether an error happened (i.e. if PySSL_SetError
    should be called), but not what kind of error happened (so,
    PySSL_SetError shouldn't need retval). To get the error,
    we need to use SSL_get_error.

    Co-authored-by: Serhiy Storchaka <storchaka@gmail.com>
    Co-authored-by: Petr Viktorin <encukou@gmail.com>

commit d52bdfb19fadd7614a0e5abaf68525fc7300e841
Author: Victor Stinner <vstinner@python.org>
Date:   Tue Mar 26 08:35:59 2024 +0100

    gh-83434: Disable XML in regrtest when -R option is used (#117232)

commit 9f74e86c78853c101a23e938f8e32ea838d8f62e
Author: Sebastian Pipping <sebastian@pipping.org>
Date:   Tue Mar 26 02:48:27 2024 +0100

    gh-117187: Fix XML tests for vanilla Expat <2.6.0 (GH-117203)

    This fixes XML unittest fallout from the https://github.com/python/cpython/issues/115398 security fix.  When configured using `--with-system-expat` on systems with older pre 2.6.0 versions of libexpat, our unittests were failing.

    * sax|etree: Simplify Expat version guard where simplifiable

    Idea by Matěj Cepl

    * sax|etree: Fix reparse deferral tests for vanilla Expat <2.6.0

    This *does not fix* the case of distros with an older version of libexpat with the 2.6.0 feature backported as a security fix.  (Ubuntu is a known example of this with its libexpat1 2.5.0-2ubunutu0.1 package)

commit 872e212378ef86392069034afd80bb53896fd93d
Author: Jonathan Protzenko <protz@microsoft.com>
Date:   Mon Mar 25 17:35:26 2024 -0700

    gh-99108: Refresh HACL*; update modules accordingly; fix namespacing (GH-117237)

    Pulls in a new update from https://github.com/hacl-star/hacl-star and fixes our C "namespacing" done by `Modules/_hacl/refresh.sh`.

commit 8945b7ff55b87d11c747af2dad0e3e4d631e62d6
Author: Eric V. Smith <ericvsmith@users.noreply.github.com>
Date:   Mon Mar 25 19:59:14 2024 -0400

    gh-109870: Dataclasses: batch up exec calls (gh-110851)

    Instead of calling `exec()` once for each function added to a dataclass, only call `exec()` once per dataclass. This can lead to speed improvements of up to 20%.

commit 7ebad77ad65ab4d5d8d0c333256a882262cec189
Author: Raymond Hettinger <rhettinger@users.noreply.github.com>
Date:   Mon Mar 25 18:49:44 2024 -0500

    Sync main docs and docstring for median_grouped(). (gh-117214)

commit 0821923aa979a72464c5da8dfa53a719bba5801c
Author: Nice Zombies <nineteendo19d0@gmail.com>
Date:   Mon Mar 25 23:55:11 2024 +0100

    gh-117114: Make os.path.isdevdrive available on all platforms (GH-117115)

commit c2276176d543a2fc2d57709c2787f99850fbb073
Author: Adorilson Bezerra <adorilson@gmail.com>
Date:   Mon Mar 25 22:34:20 2024 +0000

    Add information about negative  indexes to sequence datamodel doc (#110903)

    Co-authored by Terry Jan Reedy

commit 23e4f80ce2a2bac50acd1785e791316d5b578b8d
Author: Mark Shannon <mark@hotpy.org>
Date:   Mon Mar 25 20:43:51 2024 +0000

    A few minor tweaks to get stats working and compiling cleanly. (#117219)

    Fixes a compilation error when configured with `--enable-pystats`,
    an array size issue, and an unused variable.

commit 507896d97dcff2d7999efa264b29d9003c525c49
Author: Victor Stinner <vstinner@python.org>
Date:   Mon Mar 25 17:32:20 2024 +0100

    gh-116936: Add PyType_GetModuleByDef() to the limited C API (#116937)

commit 0c1a42cf9c8cd0d4534d5c1d58f118ce7c5c446e
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Mon Mar 25 17:32:11 2024 +0200

    gh-87193: Support bytes objects with refcount > 1 in _PyBytes_Resize() (GH-117160)

    Create a new bytes object and destroy the old one if it has refcount > 1.

commit 01e7405da400e8997f8964d06cc414045e144681
Author: Tian Gao <gaogaotiantian@hotmail.com>
Date:   Mon Mar 25 08:18:09 2024 -0700

    gh-112948: Make pdb completion similar to repl completion (#112950)

commit 9db2a8f914ad59019d448cecc43b6d45f46424a0
Author: Raymond Hettinger <rhettinger@users.noreply.github.com>
Date:   Mon Mar 25 09:26:42 2024 -0500

    Minor markup and grammar fixes in the statistics docs (gh-117216)

commit eebea7e515462b503632ada74923ec3246599c9c
Author: Kirill Podoprigora <kirill.bast9@mail.ru>
Date:   Sun Mar 24 20:34:55 2024 +0200

    gh-117176: Fix compiler warning in Python/optimizer_bytecodes.c (GH-117199)

commit 83485a095363dad6c97b19af2826ca0c34343bfc
Author: Totally a booplicate <53382877+Booplicate@users.noreply.github.com>
Date:   Sun Mar 24 18:48:40 2024 +0300

    gh-112571: Move fish venv activation script into the common folder (GH-117169)

    pythongh-112571: allow using fish venv activation script on windows

    The fish shell can be used on windows under cygwin or msys2.
    This change moves the script to the common folder
    so the venv module will install it on both posix and nt systems (like the bash script).

commit 78a651fd7fbe7a3d1702e40f4cbfa72d87241ef0
Author: Terry Jan Reedy <tjreedy@udel.edu>
Date:   Sun Mar 24 11:38:34 2024 -0400

    gh-117194: Properly format 'base64' header in What's New (#117198)

    It needs 6, not 3, '-'s.

commit f267d5bf2a99fbeb26a720d1c87c1f0557424b14
Author: Kerim Kabirov <the.privat33r+gh@pm.me>
Date:   Sun Mar 24 14:59:14 2024 +0100

    GH-115986 Docs: promote pprint.pp usage as a default (#116614)

    Co-authored-by: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>

commit 39df7732178c8e8f75b12f069a3dbc1715c99995
Author: LilKS <1244886+LilKS@users.noreply.github.com>
Date:   Sun Mar 24 11:01:07 2024 +0100

    gh-101760: Improve the imaplib.IMAP4 example (#101764)

    Co-authored-by: Adam Turner <9087854+AA-Turner@users.noreply.github.com>

commit a1e948edba9ec6ba61365429857f7a087c5edf51
Author: Raymond Hettinger <rhettinger@users.noreply.github.com>
Date:   Sun Mar 24 11:35:58 2024 +0200

    Add cumulative option for the new statistics.kde() function. (#117033)

commit d610d821fd210dce63a1132c274ffdf8acc510bc
Author: Irit Katriel <1055913+iritkatriel@users.noreply.github.com>
Date:   Sat Mar 23 22:32:33 2024 +0000

    gh-112383: teach dis how to interpret ENTER_EXECUTOR (#117171)

commit 6c83352bfe78a7d567c8d76257df6eb91d5a7245
Author: Ken Jin <kenjin@python.org>
Date:   Sun Mar 24 06:19:17 2024 +0800

    gh-117180: Complete call sequence when trace stack overflow (GH-117184)

    ---------

    Co-authored-by: Peter Lazorchak <lazorchakp@gmail.com>
    Co-authored-by: Guido van Rossum <gvanrossum@users.noreply.github.com>
    Co-authored-by: Guido van Rossum <gvanrossum@gmail.com>

commit f11d0d8be8af28e1368c3c7c116218cf65ddf93e
Author: Erik Soma <stillusingirc@gmail.com>
Date:   Sat Mar 23 11:39:35 2024 -0400

    gh-91227: Ignore ERROR_PORT_UNREACHABLE in proactor recvfrom() (#32011)

commit 9967b568edd2e35b0415c14c7242f3ca2c0dc03d
Author: Victor Stinner <vstinner@python.org>
Date:   Sat Mar 23 13:01:20 2024 +0100

    gh-117008: Fix functools test_recursive_pickle() (#117009)

    Use support.infinite_recursion() in test_recursive_pickle() of
    test_functools to prevent a stack overflow on "ARM64 Windows
    Non-Debug" buildbot.

    Lower Py_C_RECURSION_LIMIT to 1,000 frames on Windows ARM64.

commit 72eea512b88f8fd68b7258242c37da963ad87360
Author: Barney Gale <barney.gale@gmail.com>
Date:   Fri Mar 22 19:14:09 2024 +0000

    GH-106747: Document another difference between `glob` and `pathlib`. (#116518)

    Document that `path.glob()` might return *path*, whereas
    `glob.glob(root_dir=path)` will never return an empty string corresponding
    to *path*.

commit e28477f214276db941e715eebc8cdfb96c1207d9
Author: Mark Shannon <mark@hotpy.org>
Date:   Fri Mar 22 18:43:25 2024 +0000

    GH-117108: Change the size of the GC increment to about 1% of the total heap size. (GH-117120)

commit e2e0b4b4b92694ba894e02b4a66fd87c166ed10f
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Fri Mar 22 20:19:10 2024 +0200

    gh-113024: C API: Add PyObject_GenericHash() function (GH-113025)

commit 567ab3bd15398c8c7b791f3e376ae3e3c0bbe079
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Fri Mar 22 20:08:00 2024 +0200

    gh-117084: Fix ZIP file extraction for directory entry names with backslashes on Windows (GH-117129)

commit 5a78f6e798d5c2af1dba2df6c9f1f1e5aac02a86
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Fri Mar 22 20:03:48 2024 +0200

    gh-117134: Microoptimize glob() for include_hidden=True (GH-117135)

commit 00baaa21de229a6db80ff2b84c2fd6ad1999a24c
Author: Vinay Sajip <vinay_sajip@yahoo.co.uk>
Date:   Fri Mar 22 17:25:51 2024 +0000

    [docs] Fix typo in docstring and add example to logging cookbook. (GH-117157)

commit 40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f
Author: Jakub Stasiak <jakub@stasiak.at>
Date:   Fri Mar 22 17:49:56 2024 +0100

    GH-113171: Fix "private" (non-global) IP address ranges (GH-113179)

    * GH-113171: Fix "private" (really non-global) IP address ranges

    The _private_networks variables, used by various is_private
    implementations, were missing some ranges and at the same time had
    overly strict ranges (where there are more specific ranges considered
    globally reachable by the IANA registries).

    This patch updates the ranges with what was missing or otherwise
    incorrect.

    I left 100.64.0.0/10 alone, for now, as it's been made special in [1]
    and I'm not sure if we want to undo that as I don't quite understand the
    motivation behind it.

    The _address_exclude_many() call returns 8 networks for IPv4, 121
    networks for IPv6.

    [1] https://github.com/python/cpython/issues/61602

commit 3be9b9d8722696b95555937bb211dc4cda714d56
Author: Steve Dower <steve.dower@python.org>
Date:   Fri Mar 22 15:00:50 2024 +0000

    Fix get_packagefamilyname helper function on Windows 32-bit (GH-117153)

commit 63d6f2623ef2aa90f51c6a928b96845b9b380d89
Author: NGRsoftlab <78017794+NGRsoftlab@users.noreply.github.com>
Date:   Fri Mar 22 14:25:38 2024 +0300

    gh-117068: Remove useless code in bytesio.c:resize_buffer() (GH-117069)

    Co-authored-by: i.khabibulin <i.khabibulin@ngrsoftlab.ru>

commit 42ae924d278c48a719fb0ab86357f3235a9f7ab9
Author: Petr Viktorin <encukou@gmail.com>
Date:   Fri Mar 22 10:42:18 2024 +0100

    gh-117127: glob tests: Reopen dir_fd to pick up directory changes (GH-117128)

commit 8383915031942f441f435a5ae800790116047b80
Author: Tim Peters <tim.peters@gmail.com>
Date:   Thu Mar 21 22:27:25 2024 -0500

    GH-116939: Rewrite binarysort() (#116940)

    Rewrote binarysort() for clarity.

    Also changed the signature to be more coherent (it was mixing sortslice with raw pointers).

    No change in method or functionality. However, I left some experiments in, disabled for now
    via `#if` tricks. Since this code was first written, some kinds of comparisons have gotten
    enormously faster (like for lists of floats), which changes the tradeoffs.

    For example, plain insertion sort's simpler innermost loop and highly predictable branches
    leave it very competitive (even beating, by a bit) binary insertion when comparisons are
    very cheap, despite that it can do many more compares. And it wins big on runs that
    are already sorted (moving the next one in takes only 1 compare then).

    So I left code for a plain insertion sort, to make future experimenting easier.

    Also made the maximum value of minrun a `#define` (``MAX_MINRUN`) to make
    experimenting with that easier too.

    And another bit of `#if``-disabled code rewrites binary insertion's innermost loop to
    remove its unpredictable branch. Surprisingly, this doesn't really seem to help
    overall. I'm unclear on why not. It certainly adds more instructions, but they're very
    simple, and it's hard to be believe they cost as much as a branch miss.

commit 97ba910e47ad298114800587979ce7beb0a705a3
Author: Guido van Rossum <guido@python.org>
Date:   Thu Mar 21 18:27:48 2024 -0700

    gh-108716:: Remove _PyStaticCode_Init/Fini (#117141)

    More deepfreeze cleanup.

commit b3d25df8d38b79310587da54dbd88b06a16d4904
Author: Eric Snow <ericsnowcurrently@gmail.com>
Date:   Thu Mar 21 18:20:20 2024 -0600

    gh-105716: Fix _PyInterpreterState_IsRunningMain() For Embedders (gh-117140)

    When I added _PyInterpreterState_IsRunningMain() and friends last year, I tried to accommodate applications that embed Python but don't call _PyInterpreterState_SetRunningMain() (not that they're expected to).  That mostly worked fine until my recent changes in gh-117049, where the subtleties with the fallback code led to failures; the change ended up breaking test_tools.test_freeze, which exercises a basic embedding situation.

    The simplest fix is to drop the fallback code I originally added to _PyInterpreterState_IsRunningMain() (and later to _PyThreadState_IsRunningMain()).  I've kept the fallback in the _xxsubinterpreters module though.  I've also updated Py_FrozenMain() to call _PyInterpreterState_SetRunningMain().

commit c4bf58a14f162557038a1535ca22c52b49d81d7b
Author: Thomas A Caswell <tcaswell@gmail.com>
Date:   Thu Mar 21 19:54:50 2024 -0400

    gh-116745: Remove all internal usage of @LIBPYTHON@ (#116746)

    Replace with MODULE_LDFLAGS.

commit 3ec57307e70ee6f42410e844d3399bbd598917ba
Author: Malcolm Smith <smith@chaquo.com>
Date:   Thu Mar 21 23:52:29 2024 +0000

    gh-71052: Add Android build script and instructions (#116426)

commit 50f9b0b1e0fb181875751cef951351ed007b6397
Author: Victor Stinner <vstinner@python.org>
Date:   Thu Mar 21 23:17:09 2024 +0100

    gh-117061: Fix test_posix.test_sched_setaffinity() on RHEL9 (#117126)

    On RHEL9, sched_setaffinity(0, []) does not fail.

commit 0907871d43bffb613cbd560224e1a9db13d06c06
Author: Ned Batchelder <ned@nedbatchelder.com>
Date:   Thu Mar 21 15:47:09 2024 -0400

    docs: fix over-linking in dataclasses.rst (#117005)

commit 570a82d46abfebb9976961113fb0f8bb400ad182
Author: Guido van Rossum <guido@python.org>
Date:   Thu Mar 21 12:37:41 2024 -0700

    gh-117045: Add code object to function version cache (#117028)

    Changes to the function version cache:

    - In addition to the function object, also store the code object,
      and allow the latter to be retrieved even if the function has been evicted.
    - Stop assigning new function versions after a critical attribute (e.g. `__code__`)
      has been modified; the version is permanently reset to zero in this case.
    - Changes to `__annotations__` are no longer considered critical. (This fixes gh-109998.)

    Changes to the Tier 2 optimization machinery:

    - If we cannot map a function version to a function, but it is still mapped to a code object,
      we continue projecting the trace.
      The operand of the `_PUSH_FRAME` and `_POP_FRAME` opcodes can be either NULL,
      a function object, or a code object with the lowest bit set.

    This allows us to trace through code that calls an ephemeral function,
    i.e., a function that may not be alive when we are constructing the executor,
    e.g. a generator expression or certain nested functions.
    We will lose globals removal inside such functions,
    but we can still do other peephole operations
    (and even possibly [call inlining](https://github.com/python/cpython/pull/116290),
    if we decide to do it), which only need the code object.
    As before, if we cannot retrieve the code object from the cache, we stop projecting.

commit c85d84166a84a5cb2d724012726bad34229ad24e
Author: Will Childs-Klein <willck93@gmail.com>
Date:   Thu Mar 21 14:16:36 2024 -0500

    gh-116333: Relax error string text expectations in SSL-related tests (GH-116334)

    * Relax error string text expectations in SSL-related tests

    As suggested [here][1], this change relaxes the OpenSSL error string
    text expectations in a number of tests. This was specifically done in
    support of more easily building CPython [AWS-LC][2], but because AWS-LC
    is a fork of [BoringSSL][3], it should increase compatibility with that
    library as well.

    In addition to the error string relaxations, we also add some guards
    around the `tls-unique` channel binding being used with TLSv1.3, as that
    feature (described in [RFC 6929][4]) is [not defined][5] for TLSv1.3.

    [1]: https://discuss.python.org/t/support-building-ssl-and-hashlib-modules-against-aws-lc/44505/4
    [2]: https://github.com/aws/aws-lc
    [3]: https://github.com/google/boringssl
    [4]: https://datatracker.ietf.org/doc/html/rfc5929#section-3
    [5]: https://datatracker.ietf.org/doc/html/rfc8446#appendix-C.5

commit 1f72fb5447ef3f8892b4a7a6213522579c618e8e
Author: Sam Gross <colesbury@gmail.com>
Date:   Thu Mar 21 14:21:02 2024 -0400

    gh-116522: Refactor `_PyThreadState_DeleteExcept` (#117131)

    Split `_PyThreadState_DeleteExcept` into two functions:

    - `_PyThreadState_RemoveExcept` removes all thread states other than one
      passed as an argument. It returns the removed thread states as a
      linked list.

    - `_PyThreadState_DeleteList` deletes those dead thread states. It may
      call destructors, so we want to "start the world" before calling
      `_PyThreadState_DeleteList` to avoid potential deadlocks.

commit 50369e6c34d05222e5a0ec9443a9f7b230e83112
Author: Michael Droettboom <mdboom@gmail.com>
Date:   Thu Mar 21 13:27:46 2024 -0400

    gh-116996: Add pystats about _Py_uop_analyse_and_optimize (GH-116997)

commit 617158e07811edfd6fd552a3d84b0beedd8f1d18
Author: Eric Snow <ericsnowcurrently@gmail.com>
Date:   Thu Mar 21 11:15:02 2024 -0600

    gh-76785: Drop PyInterpreterID_Type (gh-117101)

    I added it quite a while ago as a strategy for managing interpreter lifetimes relative to the PEP 554 (now 734) implementation.  Relatively recently I refactored that implementation to no longer rely on InterpreterID objects.  Thus now I'm removing it.

commit abdd1f938f08e536864532b2071f144515ecc88b
Author: Victor Stinner <vstinner@python.org>
Date:   Thu Mar 21 17:45:43 2024 +0100

    gh-85283: Build _testconsole extension with limited C API (#117125)

commit 8bea6c411d65cd987616b4ecdb86373e4f21f1c6
Author: Victor Stinner <vstinner@python.org>
Date:   Thu Mar 21 17:07:00 2024 +0100

    gh-115754: Add Py_GetConstant() function (#116883)

    Add Py_GetConstant() and Py_GetConstantBorrowed() functions.

    In the limited C API version 3.13, getting Py_None, Py_False,
    Py_True, Py_Ellipsis and Py_NotImplemented singletons is now
    implemented as function calls at the stable ABI level to hide
    implementation details. Getting these constants still return borrowed
    references.

    Add _testlimitedcapi/object.c and test_capi/test_object.py to test
    Py_GetConstant() and Py_GetConstantBorrowed() functions.

commit 5a76d1be8ef371b75ca65166726923c249b5f615
Author: Eric Snow <ericsnowcurrently@gmail.com>
Date:   Thu Mar 21 10:06:35 2024 -0600

    gh-105716: Update interp->threads.main After Fork (gh-117049)

    I missed this in gh-109921.

    We also update Py_Exit() to call _PyInterpreterState_SetNotRunningMain(), if necessary.

commit bbee57fa8c318cb26d6c8651254927a1972c9738
Author: Eric Snow <ericsnowcurrently@gmail.com>
Date:   Thu Mar 21 09:56:12 2024 -0600

    gh-76785: Clean Up Interpreter ID Conversions (gh-117048)

    Mostly we unify the two different implementations of the conversion code (from PyObject * to int64_t.  We also drop the PyArg_ParseTuple()-style converter function, as well as rename and move PyInterpreterID_LookUp().

commit e728303532168efab7694c55c82ea19b18bf8385
Author: Sam Gross <colesbury@gmail.com>
Date:   Thu Mar 21 10:01:16 2024 -0400

    gh-116522: Stop the world before fork() and during shutdown (#116607)

    This changes the free-threaded build to perform a stop-the-world pause
    before deleting other thread states when forking and during shutdown.
    This fixes some crashes when using multiprocessing and during shutdown
    when running with `PYTHON_GIL=0`.

    This also changes `PyOS_BeforeFork` to acquire the runtime lock
    (i.e., `HEAD_LOCK(&_PyRuntime)`) before forking to ensure that data
    protected by the runtime lock (and not just the GIL or stop-the-world)
    is in a consistent state before forking.

commit 1f8b24ef69896680d6ba6005e75e1cc79a744f9e
Author: Malcolm Smith <smith@chaquo.com>
Date:   Thu Mar 21 13:20:57 2024 +0000

    gh-71052: Implement `ctypes.util.find_library` on Android (GH-116379)

commit d16c9d1278164f04778861814ebc87ed087511fc
Author: Tian Gao <gaogaotiantian@hotmail.com>
Date:   Thu Mar 21 03:30:10 2024 -0700

    gh-116987: Support class code objects in inspect.findsource() (GH-117025)

commit 6547330f4e896c6748da23704b617e060e6cc68e
Author: Adam Turner <9087854+AA-Turner@users.noreply.github.com>
Date:   Thu Mar 21 03:49:10 2024 +0000

    GH-109653: Defer import of ``importlib.metadata._adapters`` (#109829)

    * adapters

    * Add comments for deferred imports with links to rationale.

    * Add blurb

    ---------

    Co-authored-by: Jason R. Coombs <jaraco@jaraco.com>

commit 667294d5b2ee812ebe0c9c1efd58e2006b61f827
Author: Jason R. Coombs <jaraco@jaraco.com>
Date:   Wed Mar 20 23:01:24 2024 -0400

    gh-117089: Apply changes from importlib_metadata 7.1.0 (#117094)

    * Apply changes from importlib_metadata 7.1.0

    * Include the data sources in the makefile (even though they're not needed)

commit f4cc77d494ee0e10ed84ce369f0910c70a2f6d44
Author: Victor Stinner <vstinner@python.org>
Date:   Thu Mar 21 00:06:24 2024 +0100

    gh-116869: Enable -Werror in test_cext for Free Threading (#117106)

    Check for warnings, but don't enable the compiler flag
    -Werror=declaration-after-statement.

commit 104602a6078564765b7b8f42888f8eaa37b129b1
Author: Victor Stinner <vstinner@python.org>
Date:   Wed Mar 20 23:52:23 2024 +0100

    gh-105927: Limit PyWeakref_GetRef() to limited C API 3.13 (#117091)

commit 8ad88984200b2ccddc0a08229dd2f4c14d1a71fc
Author: Jason R. Coombs <jaraco@jaraco.com>
Date:   Wed Mar 20 17:11:00 2024 -0400

    gh-117089: Move importlib.metadata tests to their own package (#117092)

    * Ensure importlib.metadata tests do not leak references in sys.modules.

    * Move importlib.metadata tests to their own package for easier syncing with importlib_metadata.

    * Update owners and makefile for new directories.

    * Add blurb

commit 7d446548ef53f6c3de1097c6d44cada6642ddc85
Author: Carol Willing <carolcode@willingconsulting.com>
Date:   Wed Mar 20 14:00:59 2024 -0700

    Fix sort order for "locale encoding" glossary item (#115794)

    Co-authored-by: C.A.M. Gerlach <CAM.Gerlach@Gerlach.CAM>

commit 63289b9dfbc7d87e81f1517422ee91b6b6d19531
Author: Mark Shannon <mark@hotpy.org>
Date:   Wed Mar 20 18:24:02 2024 +0000

    GH-117066: Tier 2 optimizer: Don't throw away good traces if we can't optimize them perfectly. (GH-117067)

commit dcaf33a41d5d220523d71c9b35bc08f5b8405dac
Author: Petr Viktorin <encukou@gmail.com>
Date:   Wed Mar 20 17:33:08 2024 +0100

    gh-114314: ctypes: remove stgdict and switch to heap types (GH-116458)

    Before this change, ctypes classes used a custom dict subclass, `StgDict`,
    as their `tp_dict`. This acts like a regular dict but also includes extra information
    about the type.

    This replaces stgdict by `StgInfo`, a C struct on the type, accessed by
    `PyObject_GetTypeData()` (PEP-697).
    All usage of `StgDict` (mainly variables named `stgdict`, `dict`, `edict` etc.) is
    converted to `StgInfo` (named `stginfo`, `info`, `einfo`, etc.).
    Where the dict is actually used for class attributes (as a regular PyDict), it's now
    called `attrdict`.

    This change -- not overriding `tp_dict` -- is made to make me comfortable with
    the next part of this PR: moving the initialization logic from `tp_new` to `tp_init`.

    The `StgInfo` is set up in `__init__` of each class, with a guard that prevents
    calling `__init__` more than once. Note that abstract classes (like `Array` or
    `Structure`) are created using `PyType_FromMetaclass` and do not have
    `__init__` called.
    Previously, this was done in `__new__`, which also wasn't called for abstract
    classes.
    Since `__init__` can be called from Python code or skipped, there is a tested
    guard to ensure `StgInfo` is initialized exactly once before it's used.

    Co-authored-by: neonene <53406459+neonene@users.noreply.github.com>
    Co-authored-by: Erlend E. Aasland <erlend.aasland@protonmail.com>

commit 44fbab43d8f3f2df07091d237824cf4fa1f6c57c
Author: Russell Keith-Magee <russell@keith-magee.com>
Date:   Wed Mar 20 23:32:56 2024 +0800

    gh-117058: Update GUI and packaging recommendations for macOS. (#117059)

commit 9221ef2d8cb7f4cf37592eb650d4c8f972033000
Author: Brett Simmers <swtaarrs@users.noreply.github.com>
Date:   Wed Mar 20 08:18:26 2024 -0700

    gh-116908: Only write to `_pending_calls.calls_to_do` with atomic operations (#117044)

    These writes to `pending->calls_to_do` need to be atomic, because other threads
    can read (atomically) from `calls_to_do` without holding `pending->mutex`.

commit fc4599800778f9b130d5e336deadbdeb5bd3e5ee
Author: jkriegshauser <jkriegshauser@gmail.com>
Date:   Wed Mar 20 07:33:28 2024 -0700

    gh-116773: Ensure overlapped objects on Windows are not deallocated too early by asyncio (GH-116774)

commit 519b2ae22b54760475bbf62b9558d453c703f9c6
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Wed Mar 20 15:39:53 2024 +0200

    gh-117021: Fix integer overflow in PyLong_AsPid() on non-Windows 64-bit platforms (GH-117064)
```

[NGRsoftlab](/NGRsoftlab)
pushed a commit
to NGRsoftlab/cpython
that referenced
this issue
[Apr 2, 2024](#ref-commit-a016a54)
[![@ngr-ilmarh](https://avatars.githubusercontent.com/u/161701313?s=40&v=4)](/ngr-ilmarh)

`[Squashed commit of the following:](/NGRsoftlab/cpython/commit/a016a5413a6d8bd02939a6fb9afef90dbbb2fb54 "Squashed commit of the following:

commit 9dae05ee59eeba0e67af2a46f2a2907c9f8d7e4a
Author: Moshe Kaplan <mosheekaplan@gmail.com>
Date:   Mon Apr 1 15:53:00 2024 -0400

    Docs: specify XML document name in xml.etree.elementtree example (#24223)

commit fc2071687b708598264a3403b7f9104667c1092f
Author: Matthew Davis <7035647+mdavis-xyz@users.noreply.github.com>
Date:   Mon Apr 1 21:49:14 2024 +0200

    Docs: add more links to PIPE in subprocess docs (#25416)

commit fc8007ee3635db6ab73e132ebff987c910b6d538
Author: Barney Gale <barney.gale@gmail.com>
Date:   Mon Apr 1 20:37:41 2024 +0100

    GH-117337: Deprecate `glob.glob0()` and `glob.glob1()`. (#117371)

    These undocumented functions are no longer used by `msilib`, so there's no
    reason to keep them around.

commit c741ad3537193c63fe697a8f0316aecd45eeb9ba
Author: Justin Turner Arthur <justinarthur@gmail.com>
Date:   Mon Apr 1 12:07:29 2024 -0500

    gh-77714: Provide an async iterator version of as_completed (GH-22491)

    * as_completed returns object that is both iterator and async iterator
    * Existing tests adjusted to test both the old and new style
    * New test to ensure iterator can be resumed
    * New test to ensure async iterator yields any passed-in Futures as-is

    Co-authored-by: Serhiy Storchaka <storchaka@gmail.com>
    Co-authored-by: Guido van Rossum <gvanrossum@gmail.com>

commit ddf814db744006e0f42328aa15ace97c9d8ad681
Author: Guido van Rossum <guido@python.org>
Date:   Mon Apr 1 09:13:38 2024 -0700

    Silence compiler warnings in gc.c (#117422)

commit 179869af922252a0c1cef65fd2923856895e7d1b
Author: Petr Viktorin <encukou@gmail.com>
Date:   Mon Apr 1 17:01:22 2024 +0200

    gh-94808: Fix refcounting in PyObject_Print tests (GH-117421)

commit dd44ab994b7262f0704d64996e0a1bc37b233407
Author: neonene <53406459+neonene@users.noreply.github.com>
Date:   Mon Apr 1 22:28:14 2024 +0900

    gh-117142: ctypes: Unify meta tp slot functions (GH-117143)

    Integrates the following ctypes meta tp slot functions:
    * `CDataType_traverse()` into `CType_Type_traverse()`.
    * `CDataType_clear()` into `CType_Type_clear()`.
    * `CDataType_dealloc()` into `CType_Type_dealloc()`.
    * `CDataType_repeat()` into `CType_Type_repeat()`.

commit 3de09cadde788065a4f2d45117e789c9353bbd12
Author: Steve (Gadget) Barnes <gadgetsteve@hotmail.com>
Date:   Mon Apr 1 14:02:07 2024 +0100

    gh-91565: Replace bugs.python.org links with Devguide/GitHub ones  (GH-91568)

    Co-authored-by: Hugo van Kemenade <hugovk@users.noreply.github.com>
    Co-authored-by: Oleg Iarygin <oleg@arhadthedev.net>
    Co-authored-by: Petr Viktorin <encukou@gmail.com>
    Co-authored-by: Ezio Melotti <ezio.melotti@gmail.com>

commit 90c3c68a658db6951b77a5be50088ec2f6adc8eb
Author: MonadChains <monadchains@gmail.com>
Date:   Mon Apr 1 13:52:25 2024 +0100

    gh-94808:Improve coverage of PyObject_Print (GH-98749)

commit 348cf6e0078eae156c503e8f61ef5e27ae28e57b
Author: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Date:   Mon Apr 1 11:14:37 2024 +0000

    Bump mypy from 1.8.0 to 1.9.0 in /Tools (#117418)

    Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
    Co-authored-by: Alex Waygood <Alex.Waygood@Gmail.com>

commit 9b403fb559bfce93a478937e0ef7e539a9a95283
Author: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Date:   Mon Apr 1 11:05:14 2024 +0000

    build(deps-dev): bump types-psutil from 5.9.5.20240205 to 5.9.5.20240316 in /Tools (#117417)

    Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
    Co-authored-by: Alex Waygood <Alex.Waygood@Gmail.com>

commit 93c7d9d17b571b6a181af7c02830d29819535c35
Author: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Date:   Mon Apr 1 11:38:38 2024 +0100

    build(deps-dev): bump types-setuptools from 69.1.0.20240301 to 69.2.0.20240317 in /Tools (#117419)

    Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

commit 3bb12e407c183946471272f8aee098e54e62a333
Author: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Date:   Mon Apr 1 09:54:33 2024 +0000

    build(deps): bump actions/add-to-project from 0.6.0 to 1.0.0 (#117415)

    Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

commit 56e99307c49adcc6df355f8070229371c97d654f
Author: Adorilson Bezerra <adorilson@gmail.com>
Date:   Sun Mar 31 23:34:54 2024 +0100

    Doc: printf-style library/stdtype improvements (#16741)

commit 18e12641a61a88f7d08b2114ebe965892c6661c5
Author: Raymond Hettinger <rhettinger@users.noreply.github.com>
Date:   Sun Mar 31 16:09:22 2024 -0500

    gh-117387 Remove hash mark from introductory text (#117409)

commit a32d6939486d7f90ee57e215077f6116e19de24d
Author: Deborah <32307299+dlwrnc@users.noreply.github.com>
Date:   Sun Mar 31 22:11:48 2024 +0200

    gh-102190: Add additional zipfile `pwd=` arg docstrings (gh-102195)

    This just documents the parameter that already exists.

    ---------

    Co-authored-by: Gregory P. Smith <greg@krypto.org>
    Co-authored-by: Erlend E. Aasland <erlend.aasland@protonmail.com>

commit 262445358e21c56d7c68e3ee76c13e469d2ea348
Author: Shantanu <12621235+hauntsaninja@users.noreply.github.com>
Date:   Sun Mar 31 12:02:48 2024 -0700

    Link to the Python type system specification (#117400)

commit 752e18389ed03087b51b38eac9769ef8dfd167b7
Author: Barney Gale <barney.gale@gmail.com>
Date:   Sun Mar 31 19:14:48 2024 +0100

    GH-114575: Rename `PurePath.pathmod` to `PurePath.parser` (#116513)

    And rename the private base class from `PathModuleBase` to `ParserBase`.

commit bfc57d43d8766120ba0c8f3f6d7b2ac681a81d8a
Author: Sam Gross <colesbury@gmail.com>
Date:   Fri Mar 29 18:58:08 2024 -0400

    gh-117303: Don't detach in `PyThreadState_DeleteCurrent()` (#117304)

    This fixes a crash in `test_threading.test_reinit_tls_after_fork()` when
    running with the GIL disabled. We already properly handle the case where
    the thread state is `_Py_THREAD_ATTACHED` in `tstate_delete_common()` --
    we just need to remove an assertion.

    Keeping the thread attached means that a stop-the-world pause, such as
    for a `fork()`, won't commence until we remove our thread state from the
    interpreter's linked list. This prevents a crash when the child process
    tries to clean up the dead thread states.

commit 05e0b67a43c5c1778dc2643c8b7c12864e135999
Author: Erlend E. Aasland <erlend@python.org>
Date:   Fri Mar 29 21:23:28 2024 +0100

    gh-116664: In _warnings.c, make filters_version access thread-safe (#117374)

    - assert that the lock is held in already_warned()
    - protect 'filters_version' increment in warnings_filters_mutated_impl()

commit 019143fecbfc26e69800d28d2a9e3392a051780b
Author: Jason R. Coombs <jaraco@jaraco.com>
Date:   Fri Mar 29 16:06:09 2024 -0400

    gh-117348: Refactored RawConfigParser._read for similicity and comprehensibility (#117372)

    * Extract method for _read_inner, reducing complexity and indentation by 1.

    * Extract method for _raise_all and yield ParseErrors from _read_inner.

    Reduces complexity by 1 and reduces touch points for handling errors in _read_inner.

    * Prefer iterators to splat expansion and literal indexing.

    * Extract method for _strip_comments. Reduces complexity by 7.

    * Model the file lines in a class to encapsulate the comment status and cleaned value.

    * Encapsulate the read state as a dataclass

    * Extract _handle_continuation_line and _handle_rest methods. Reduces complexity by 8.

    * Reindent

    * At least for now, collect errors in the ReadState

    * Check for missing section header separately.

    * Extract methods for _handle_header and _handle_option. Reduces complexity by 6.

    * Remove unreachable code. Reduces complexity by 4.

    * Remove unreachable branch

    * Handle error condition early. Reduces complexity by 1.

    * Add blurb

    * Move _raise_all to ParsingError, as its behavior is most closely related to the exception class and not the reader.

    * Split _strip* into separate methods.

    * Refactor _strip_full to compute the strip just once and use 'not any' to determine the factor.

    * Replace use of 'sys.maxsize' with direct computation of the stripped value.

    * Extract has_comments as a dynamic property.

    * Implement clean as a cached property.

    * Model comment prefixes in the RawConfigParser within a prefixes namespace.

    * Use a regular expression to search for the first match.

    Avoids mutating variables and tricky logic and over-computing all of the starts when only the first is relevant.

commit 01bd74eadbc4ff839d39762fae6366f50c1e116e
Author: Sam Gross <colesbury@gmail.com>
Date:   Fri Mar 29 15:33:06 2024 -0400

    gh-117300: Use stop the world to make `sys._current_frames` and `sys._current_exceptions` thread-safe. (#117301)

    This adds a stop the world pause to make the two functions thread-safe
    when the GIL is disabled in the free-threaded build.

    Additionally, the main test thread may call `sys._current_exceptions()` as
    soon as `g_raised.set()` is called. The background thread may not yet reach
    the `leave_g.wait()` line.

commit 94c97423a9c4969f8ddd4a3aa4aacb99c4d5263d
Author: Guido van Rossum <guido@python.org>
Date:   Fri Mar 29 11:31:09 2024 -0700

    Fix broken format in error for bad input in summarize_stats.py (#117375)

    When you pass the script a non-existent input file, you get a TypeError instead of the intended ValueError.

commit 5d21d884b6ffa45dac50a5f9a07c41356a8478b4
Author: mpage <mpage@meta.com>
Date:   Fri Mar 29 10:42:02 2024 -0700

    gh-111926: Avoid locking in PyType_IsSubtype (#117275)

    Read the MRO in a thread-unsafe way in `PyType_IsSubtype` to avoid locking. Fixing this is tracked in #117306.

    The motivation for this change is in support of making weakrefs thread-safe in free-threaded builds:

    `WeakValueDictionary` uses a special dictionary function, `_PyDict_DelItemIf`
    to remove dead weakrefs from the dictionary. `_PyDict_DelItemIf` removes a key
    if a user supplied predicate evaluates to true for the value associated with
    the key. Crucially for the `WeakValueDictionary` use case, the predicate
    evaluation + deletion sequence is atomic, provided that the predicate doesn’t
    suspend. The predicate used by `WeakValueDictionary` includes a subtype check,
    which we must ensure doesn't suspend in free-threaded builds.

commit 19c1dd60c5b53fb0533610ad139ef591294f26e8
Author: Sam Gross <colesbury@gmail.com>
Date:   Fri Mar 29 13:35:43 2024 -0400

    gh-117323: Make `cell` thread-safe in free-threaded builds (#117330)

    Use critical sections to lock around accesses to cell contents. The critical sections are no-ops in the default (with GIL) build.

commit 397d88db5e9ab2a43de3fdf5f8b973a949edc405
Author: Sam Gross <colesbury@gmail.com>
Date:   Fri Mar 29 13:34:04 2024 -0400

    gh-117344: Skip flaky tests in free-threaded build (#117355)

    The tests are not reliable with the GIL disabled. In theory, they can
    fail with the GIL enabled too, but the failures are much more likely
    with the GIL disabled.

commit f05fb2e65c2dffdfae940f2707765c4994925205
Author: Sam Gross <colesbury@gmail.com>
Date:   Fri Mar 29 13:33:04 2024 -0400

    gh-112529: Don't untrack tuples or dicts with zero refcount (#117370)

    The free-threaded GC sometimes sees objects with zero refcount. This can
    happen due to the delay in merging biased reference counting fields,
    and, in the future, due to deferred reference counting. We should not
    untrack these objects or they will never be collected.

    This fixes the refleaks in the free-threaded build.

commit ddf95b5f16031cdbd0d728e55eb06dff002a8678
Author: Erlend E. Aasland <erlend@python.org>
Date:   Fri Mar 29 18:26:06 2024 +0100

    gh-116664: Fix unused var warnings in _warnings.c in non-free-threaded builds (#117373)

    The warnings were introduced by commit c1712ef06.

commit 0fa571dbcdf19b541276cb00bb929381930467b2
Author: Tian Gao <gaogaotiantian@hotmail.com>
Date:   Fri Mar 29 09:02:01 2024 -0700

    Refactor pdb executable targets (#112570)

    Co-authored-by: Jason R. Coombs <jaraco@jaraco.com>

commit 54f7e14500471d1c46fb553adb3ca24cd1fef084
Author: Pedro Lacerda <pslacerda@users.noreply.github.com>
Date:   Fri Mar 29 12:05:00 2024 -0300

    gh-66449: configparser: Add support for unnamed sections (#117273)

    Co-authored-by: Jason R. Coombs <jaraco@jaraco.com>

commit d9cfe7e565a6e2dc15747a904736264e31a10be4
Author: Nikita Sobolev <mail@sobolevn.me>
Date:   Fri Mar 29 14:14:25 2024 +0300

    gh-117166: Ignore empty and temporary dirs in `test_makefile` (#117190)

commit 35b6c4a4da201a947b2ceb96ae4c0d83d4d2df4f
Author: Victor Stinner <vstinner@python.org>
Date:   Fri Mar 29 11:25:17 2024 +0100

    gh-117347: Fix test_clinic side effects (#117363)

    Save/restore converters in ClinicWholeFileTest and
    ClinicExternalTest.

commit 7e2fef865899837c47e91ef0180fa59eb03e840b
Author: neonene <53406459+neonene@users.noreply.github.com>
Date:   Fri Mar 29 18:40:48 2024 +0900

    gh-117142: ctypes: Migrate global vars to module state (GH-117189)

commit 2e9be80c99f635c2f7761e8356b0260922d6e7a6
Author: Gregory P. Smith <greg@krypto.org>
Date:   Thu Mar 28 17:58:37 2024 -0700

    Fix reversed assertRegex checks in test_ssl. (#117351)

commit 8eec7ed714e65d616573b7331780b0aa43c6ed6a
Author: 傅立业（Chris Fu） <17433201@qq.com>
Date:   Fri Mar 29 08:19:20 2024 +0800

    gh-117110: Fix subclasses of typing.Any with custom constructors (#117111)

commit a17f313e3958e825db9a83594c8471a984316536
Author: Christopher Chianelli <christopher@timefold.ai>
Date:   Thu Mar 28 18:26:56 2024 -0400

    gh-117339: Use NULL instead of None for LOAD_SUPER_ATTR in dis docs (GH-117343)

commit 26d328b2ba26374fb8d9ffe8215ecef7c5e3f7a2
Author: Michael Droettboom <mdboom@gmail.com>
Date:   Thu Mar 28 18:23:08 2024 -0400

    GH-117121: Add pystats to JIT builds (GH-117346)

commit 14f1ca7d5363386163839b31ce987423daecc3de
Author: Nice Zombies <nineteendo19d0@gmail.com>
Date:   Thu Mar 28 22:20:08 2024 +0100

    gh-117335: Handle non-iterables for `ntpath.commonpath` (GH-117336)

commit 18cf239e39e25e6cef50ecbb7f197a82f8920ff5
Author: Brandt Bucher <brandtbucher@microsoft.com>
Date:   Thu Mar 28 14:02:34 2024 -0700

    Increase the JIT CI timeouts to 75 minutes (GH-117342)

commit 29829b58a8328a7c2ccacaa74c1d7d120a5e5ca5
Author: Malcolm Smith <smith@chaquo.com>
Date:   Thu Mar 28 19:59:12 2024 +0000

    gh-117294: Report DocTestCase as skipped if all examples in the doctest are skipped (GH-117297)

commit efcc96844e7c66fcd6c23ac2d557ca141614ce9a
Author: Tian Gao <gaogaotiantian@hotmail.com>
Date:   Thu Mar 28 11:23:29 2024 -0700

    gh-69201: Separate stdout and stderr stream in test_pdb (#117308)

commit 6702d2bf6edcd5b5415e17837383623b9d76a5b8
Author: Victor Stinner <vstinner@python.org>
Date:   Thu Mar 28 17:40:58 2024 +0100

    gh-114331: Skip decimal test_maxcontext_exact_arith on s390x (#117326)

commit c1712ef066321c01bf09cba3f22fc474b5b8dfa7
Author: Erlend E. Aasland <erlend@python.org>
Date:   Thu Mar 28 16:05:08 2024 +0100

    gh-116664: Make module state Py_SETREF's in _warnings thread-safe (#116959)

    Mark the swap operations as critical sections.

    Add an internal Py_BEGIN_CRITICAL_SECTION_MUT API that takes a PyMutex
    pointer instead of a PyObject pointer.

commit 9a388b9a64927c372d85f0eaec3de9b7320a6fb5
Author: Joachim Wuttke <j.wuttke@fz-juelich.de>
Date:   Thu Mar 28 14:43:07 2024 +0100

    bpo-43848: explain optional argument mtime in gzip.py. (GH-25410)

    Co-authored-by: Jelle Zijlstra <jelle.zijlstra@gmail.com>

commit 8dbfdb2957a7baade3a88661517f163ad694c39f
Author: Sam Gross <colesbury@gmail.com>
Date:   Thu Mar 28 09:28:39 2024 -0400

    gh-110481: Fix biased reference counting queue initialization. (#117271)

    The biased reference counting queue must be initialized from the bound
    (active) thread because it uses `_Py_ThreadId()` as the key in a hash
    table.

commit 9a1e55b8c5723206116f7016921be3937ef2f4e5
Author: Chris Markiewicz <effigies@gmail.com>
Date:   Thu Mar 28 06:59:31 2024 -0400

    gh-117178: Recover lazy loading of self-referential modules (#117179)

commit 4c71d51a4b7989fc8754ba512c40e21666f9db0d
Author: Jelle Zijlstra <jelle.zijlstra@gmail.com>
Date:   Thu Mar 28 04:30:31 2024 -0600

    gh-117266: Fix crashes on user-created AST subclasses (GH-117276)

    Fix crashes on user-created AST subclasses

commit 8cb7d7ff86a1a2d41195f01ba4f218941dd7308c
Author: Gregory P. Smith <greg@krypto.org>
Date:   Thu Mar 28 03:11:58 2024 -0700

    gh-117310: Remove extra DECREF on \"no ciphers\" error path in `_ssl._SSLContext` constructor (#117309)

    Remove extra self DECREF on ssl \"no ciphers\" error path.

    This doesn't come up in practice because nobody links against a broken
    OpenSSL library that provides nothing.

commit 6c8ac8a32fd6de1960526561c44bc5603fab0f3e
Author: Erlend E. Aasland <erlend@python.org>
Date:   Thu Mar 28 09:40:37 2024 +0100

    gh-116303: Handle disabled test modules in test.support helpers (#116482)

    Make sure test.support helpers skip iso. failing if test extension
    modules are disabled. Also log TEST_MODULES in test.pythoninfo.

commit 0f27672c5002de96c9f1228b12460d5ce3f1d190
Author: Russell Keith-Magee <russell@keith-magee.com>
Date:   Thu Mar 28 16:13:13 2024 +0800

    gh-114099: Add documentation for iOS platform (GH-117057)

    Co-authored-by: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>
    Co-authored-by: Jacob Coffee <jacob@z7x.org>
    Co-authored-by: Malcolm Smith <smith@chaquo.com>
    Co-authored-by: Ned Deily <nad@python.org>

commit f006338017cfbf846e8f7391b9ee5f69df8dc620
Author: Russell Keith-Magee <russell@keith-magee.com>
Date:   Thu Mar 28 15:59:33 2024 +0800

    gh-114099: Additions to standard library to support iOS (GH-117052)

    Co-authored-by: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>
    Co-authored-by: Malcolm Smith <smith@chaquo.com>
    Co-authored-by: Ned Deily <nad@python.org>

commit b44898299a2ed97045c270f6474785da2ff07ced
Author: Tim Hatch <tim@timhatch.com>
Date:   Wed Mar 27 23:54:51 2024 -0700

    gh-89739: gh-77140: Support zip64 in zipimport (GH-94146)

    * Reads zip64 files as produced by the zipfile module
    * Include tests (somewhat slow, however, because of the need to create \"large\" zips)
    * About the same amount of strictness reading invalid zip files as zipfile has
    * Still works on files with prepended data (like pex)

    There are a lot more test cases at https://github.com/thatch/zipimport64/ that give me confidence that this works for real-world files.

    Fixes #89739 and #77140.

    ---------

    Co-authored-by: Itamar Ostricher <itamarost@gmail.com>
    Reviewed-by: Gregory P. Smith <greg@krypto.org>

commit 2cedd25c14d3acfdcb5e8ee55132ce3e334ab8fe
Author: Illia Volochii <illia.volochii@gmail.com>
Date:   Thu Mar 28 08:46:01 2024 +0200

    Revert \"gh-116886: Temporarily disable CIfuzz (memory) (GH-117018)\" (GH-117289)

    This reverts commit 1ab0d0b1167d78bf19661a3b5e533a2b68a57604.

    This reverts #117018.

    I expect the issue to be fixed based on https://github.com/google/oss-fuzz/pull/11708#issuecomment-2006442396 and https://github.com/actions/runner-images/issues/9491.

commit eefff682f09394fe4f18b7d7c6ac4c635caadd02
Author: Malcolm Smith <smith@chaquo.com>
Date:   Wed Mar 27 22:11:44 2024 +0000

    gh-108277: Make test_os tolerate 10 ms diff for timerfd on Android emulators (#117223)

commit 7aa89bc43e0bcf49eee5a39b5a7ba8f996f20d00
Author: Victor Stinner <vstinner@python.org>
Date:   Wed Mar 27 23:10:14 2024 +0100

    gh-113317: Change how Argument Clinic lists converters (#116853)

    * Add a new create_parser_namespace() function for
      PythonParser to pass objects to executed code.
    * In run_clinic(), list converters using 'converters' and
      'return_converters' dictionarties.
    * test_clinic: add 'object()' return converter.
    * Use also create_parser_namespace() in eval_ast_expr().

    Co-authored-by: Erlend E. Aasland <erlend@python.org>

commit 669ef49c7d42f35da6f7ee280102353b9b37f83e
Author: Seth Michael Larson <seth@python.org>
Date:   Wed Mar 27 16:56:14 2024 -0500

    gh-99108: Update and check HACL* version information (GH-117295)

    * Update and check HACL* version information

commit 262fb911ab7df8e890ebd0efb0773c3e0b5a757f
Author: Irit Katriel <1055913+iritkatriel@users.noreply.github.com>
Date:   Wed Mar 27 17:38:19 2024 +0000

    gh-117288: Allocate fewer label IDs in _PyCfg_ToInstructionSequence (#117290)

commit 74c8568d07719529b874897598d8b3bc25ff0434
Author: Malcolm Smith <smith@chaquo.com>
Date:   Wed Mar 27 16:53:27 2024 +0000

    gh-71042: Add `platform.android_ver` (#116674)

commit ce00de4c8cd39816f992e749c1074487d93abe9d
Author: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>
Date:   Wed Mar 27 16:46:35 2024 +0200

    gh-117225: doctest: only print \"and X failed\" when non-zero, don't pluralise \"1 items\" (#117228)

commit 92397d5ead38dde4154e70d00f24973bcf2a925a
Author: Raymond Hettinger <rhettinger@users.noreply.github.com>
Date:   Wed Mar 27 09:04:32 2024 -0500

    Add statistics recipe for sampling from an estimated probability density distribution (#117221)

commit b3e8c78ed7aa9bbd1084375587b99200c687cec9
Author: Tian Gao <gaogaotiantian@hotmail.com>
Date:   Tue Mar 26 18:20:12 2024 -0700

    gh-113548: Allow CLI arguments to `pdb -m` (#113557)

commit 48c0b05cf0dd2db275bd4653f84aa36c22bddcd2
Author: Adorilson Bezerra <adorilson@gmail.com>
Date:   Tue Mar 26 19:08:08 2024 +0000

    Change links on the index page (#117230)

commit af1b0e94400d1bf732466d675054df8cf7dfb62d
Author: AN Long <aisk@users.noreply.github.com>
Date:   Wed Mar 27 02:26:48 2024 +0800

    gh-104242: Enable test_is_char_device_true in pathlib test on all platform (GH-116983)

commit 79be75735c9d77972112cecc8d7e1af28c176ed0
Author: Irit Katriel <1055913+iritkatriel@users.noreply.github.com>
Date:   Tue Mar 26 15:18:17 2024 +0000

    gh-115775: Compiler adds __static_attributes__ field to classes (#115913)

commit 70969d53a77a8a190c40a30419e772bc874a4f62
Author: Antonio <57417288+amaddio@users.noreply.github.com>
Date:   Tue Mar 26 15:10:29 2024 +0100

    gh-97901 add missing text/rtf to mimetypes (GH-97902)

    Co-authored-by: Noam Cohen <noam@noam.me>

commit 4ec347760f98b156c6a2d42ca397af6b0b6ecc50
Author: AN Long <aisk@users.noreply.github.com>
Date:   Tue Mar 26 22:09:57 2024 +0800

    gh-115538: Use isolate mode when running venv test_multiprocessing_recursion() (#117116)

    Co-authored-by: Victor Stinner <vstinner@python.org>

commit 743f2c68f478279e1e56577fe95a0ed112b9abc5
Author: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>
Date:   Tue Mar 26 16:09:09 2024 +0200

    pre-commit: add `check-case-conflict` and `check-merge-conflict` (#117259)

commit 4abca7e1e7e2764faf20c7e677ea5c9ea9dbffe2
Author: Paulo Neves <ptsneves@users.noreply.github.com>
Date:   Tue Mar 26 13:37:50 2024 +0100

    gh-98966: Handle stdout=subprocess.STDOUT (GH-98967)

    Explicitly handle the case where stdout=STDOUT
    as otherwise the existing error handling gets
    confused and reports hard to understand errors.

    Signed-off-by: Paulo Neves <ptsneves@gmail.com>

commit 9654daf793b534b44a831c80f43505ab9e380f1f
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Tue Mar 26 13:26:45 2024 +0200

    gh-66543: Fix mimetype.guess_type() (GH-117217)

    Fix parsing of the following corner cases:

    * URLs with only a host name
    * URLs containing a fragment
    * URLs containing a query
    * filenames with only a UNC sharepoint on Windows

    Co-authored-by: Dong-hee Na <donghee.na92@gmail.com>

commit 8bef34f625e21886b1c64544c060e19ee2e229bf
Author: Mark Shannon <mark@hotpy.org>
Date:   Tue Mar 26 11:11:42 2024 +0000

    GH-117108: Set the \"old space bit\" to \"visited\" for all young objects  (#117213)

    Change old space bit of young objects from 0 to gcstate->visited_space.
    This ensures that any object created *and* collected during cycle GC has the bit set correctly.

commit bf82f77957a31c3731b4ec470c406f5708ca9ba3
Author: Mark Shannon <mark@hotpy.org>
Date:   Tue Mar 26 09:35:11 2024 +0000

    GH-116422: Tier2 hot/cold splitting (GH-116813)

    Splits the \"cold\" path, deopts and exits, from the \"hot\" path, reducing the size of most jitted instructions, at the cost of slower exits.

commit 61599a48f52e951d8813877ee311d2a830ba2cd8
Author: Pablo Galindo Salgado <Pablogsal@gmail.com>
Date:   Tue Mar 26 09:30:46 2024 +0000

    bpo-24612: Improve syntax error for 'not' after an operator (GH-28170)

    Co-authored-by: Lysandros Nikolaou <lisandrosnik@gmail.com>

commit 771902c257372e6c4df1ead4e8c46308561db7a7
Author: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>
Date:   Tue Mar 26 11:13:32 2024 +0200

    gh-83845: Add tests for operator module (#115883)

    Co-authored-by: Karthikeyan Singaravelan <tir.karthi@gmail.com>

commit ea9a296fce2f786b4cf43c7924e5de01061f27ca
Author: yevgeny hong <hongyevgeny@gmail.com>
Date:   Tue Mar 26 16:45:43 2024 +0900

    gh-115627: Fix PySSL_SetError handling SSL_ERROR_SYSCALL (GH-115628)

    Python 3.10 changed from using SSL_write() and SSL_read() to SSL_write_ex() and
    SSL_read_ex(), but did not update handling of the return value.

    Change error handling so that the return value is not examined.
    OSError (not EOF) is now returned when retval is 0.

    According to *recent* man pages of all functions for which we call
    PySSL_SetError, (in OpenSSL 3.0 and 1.1.1), their return value should
    be used to determine whether an error happened (i.e. if PySSL_SetError
    should be called), but not what kind of error happened (so,
    PySSL_SetError shouldn't need retval). To get the error,
    we need to use SSL_get_error.

    Co-authored-by: Serhiy Storchaka <storchaka@gmail.com>
    Co-authored-by: Petr Viktorin <encukou@gmail.com>

commit d52bdfb19fadd7614a0e5abaf68525fc7300e841
Author: Victor Stinner <vstinner@python.org>
Date:   Tue Mar 26 08:35:59 2024 +0100

    gh-83434: Disable XML in regrtest when -R option is used (#117232)

commit 9f74e86c78853c101a23e938f8e32ea838d8f62e
Author: Sebastian Pipping <sebastian@pipping.org>
Date:   Tue Mar 26 02:48:27 2024 +0100

    gh-117187: Fix XML tests for vanilla Expat <2.6.0 (GH-117203)

    This fixes XML unittest fallout from the https://github.com/python/cpython/issues/115398 security fix.  When configured using `--with-system-expat` on systems with older pre 2.6.0 versions of libexpat, our unittests were failing.

    * sax|etree: Simplify Expat version guard where simplifiable

    Idea by Matěj Cepl

    * sax|etree: Fix reparse deferral tests for vanilla Expat <2.6.0

    This *does not fix* the case of distros with an older version of libexpat with the 2.6.0 feature backported as a security fix.  (Ubuntu is a known example of this with its libexpat1 2.5.0-2ubunutu0.1 package)

commit 872e212378ef86392069034afd80bb53896fd93d
Author: Jonathan Protzenko <protz@microsoft.com>
Date:   Mon Mar 25 17:35:26 2024 -0700

    gh-99108: Refresh HACL*; update modules accordingly; fix namespacing (GH-117237)

    Pulls in a new update from https://github.com/hacl-star/hacl-star and fixes our C \"namespacing\" done by `Modules/_hacl/refresh.sh`.

commit 8945b7ff55b87d11c747af2dad0e3e4d631e62d6
Author: Eric V. Smith <ericvsmith@users.noreply.github.com>
Date:   Mon Mar 25 19:59:14 2024 -0400

    gh-109870: Dataclasses: batch up exec calls (gh-110851)

    Instead of calling `exec()` once for each function added to a dataclass, only call `exec()` once per dataclass. This can lead to speed improvements of up to 20%.

commit 7ebad77ad65ab4d5d8d0c333256a882262cec189
Author: Raymond Hettinger <rhettinger@users.noreply.github.com>
Date:   Mon Mar 25 18:49:44 2024 -0500

    Sync main docs and docstring for median_grouped(). (gh-117214)

commit 0821923aa979a72464c5da8dfa53a719bba5801c
Author: Nice Zombies <nineteendo19d0@gmail.com>
Date:   Mon Mar 25 23:55:11 2024 +0100

    gh-117114: Make os.path.isdevdrive available on all platforms (GH-117115)

commit c2276176d543a2fc2d57709c2787f99850fbb073
Author: Adorilson Bezerra <adorilson@gmail.com>
Date:   Mon Mar 25 22:34:20 2024 +0000

    Add information about negative  indexes to sequence datamodel doc (#110903)

    Co-authored by Terry Jan Reedy

commit 23e4f80ce2a2bac50acd1785e791316d5b578b8d
Author: Mark Shannon <mark@hotpy.org>
Date:   Mon Mar 25 20:43:51 2024 +0000

    A few minor tweaks to get stats working and compiling cleanly. (#117219)

    Fixes a compilation error when configured with `--enable-pystats`,
    an array size issue, and an unused variable.

commit 507896d97dcff2d7999efa264b29d9003c525c49
Author: Victor Stinner <vstinner@python.org>
Date:   Mon Mar 25 17:32:20 2024 +0100

    gh-116936: Add PyType_GetModuleByDef() to the limited C API (#116937)

commit 0c1a42cf9c8cd0d4534d5c1d58f118ce7c5c446e
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Mon Mar 25 17:32:11 2024 +0200

    gh-87193: Support bytes objects with refcount > 1 in _PyBytes_Resize() (GH-117160)

    Create a new bytes object and destroy the old one if it has refcount > 1.

commit 01e7405da400e8997f8964d06cc414045e144681
Author: Tian Gao <gaogaotiantian@hotmail.com>
Date:   Mon Mar 25 08:18:09 2024 -0700

    gh-112948: Make pdb completion similar to repl completion (#112950)

commit 9db2a8f914ad59019d448cecc43b6d45f46424a0
Author: Raymond Hettinger <rhettinger@users.noreply.github.com>
Date:   Mon Mar 25 09:26:42 2024 -0500

    Minor markup and grammar fixes in the statistics docs (gh-117216)

commit eebea7e515462b503632ada74923ec3246599c9c
Author: Kirill Podoprigora <kirill.bast9@mail.ru>
Date:   Sun Mar 24 20:34:55 2024 +0200

    gh-117176: Fix compiler warning in Python/optimizer_bytecodes.c (GH-117199)

commit 83485a095363dad6c97b19af2826ca0c34343bfc
Author: Totally a booplicate <53382877+Booplicate@users.noreply.github.com>
Date:   Sun Mar 24 18:48:40 2024 +0300

    gh-112571: Move fish venv activation script into the common folder (GH-117169)

    pythongh-112571: allow using fish venv activation script on windows

    The fish shell can be used on windows under cygwin or msys2.
    This change moves the script to the common folder
    so the venv module will install it on both posix and nt systems (like the bash script).

commit 78a651fd7fbe7a3d1702e40f4cbfa72d87241ef0
Author: Terry Jan Reedy <tjreedy@udel.edu>
Date:   Sun Mar 24 11:38:34 2024 -0400

    gh-117194: Properly format 'base64' header in What's New (#117198)

    It needs 6, not 3, '-'s.

commit f267d5bf2a99fbeb26a720d1c87c1f0557424b14
Author: Kerim Kabirov <the.privat33r+gh@pm.me>
Date:   Sun Mar 24 14:59:14 2024 +0100

    GH-115986 Docs: promote pprint.pp usage as a default (#116614)

    Co-authored-by: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>

commit 39df7732178c8e8f75b12f069a3dbc1715c99995
Author: LilKS <1244886+LilKS@users.noreply.github.com>
Date:   Sun Mar 24 11:01:07 2024 +0100

    gh-101760: Improve the imaplib.IMAP4 example (#101764)

    Co-authored-by: Adam Turner <9087854+AA-Turner@users.noreply.github.com>

commit a1e948edba9ec6ba61365429857f7a087c5edf51
Author: Raymond Hettinger <rhettinger@users.noreply.github.com>
Date:   Sun Mar 24 11:35:58 2024 +0200

    Add cumulative option for the new statistics.kde() function. (#117033)

commit d610d821fd210dce63a1132c274ffdf8acc510bc
Author: Irit Katriel <1055913+iritkatriel@users.noreply.github.com>
Date:   Sat Mar 23 22:32:33 2024 +0000

    gh-112383: teach dis how to interpret ENTER_EXECUTOR (#117171)

commit 6c83352bfe78a7d567c8d76257df6eb91d5a7245
Author: Ken Jin <kenjin@python.org>
Date:   Sun Mar 24 06:19:17 2024 +0800

    gh-117180: Complete call sequence when trace stack overflow (GH-117184)

    ---------

    Co-authored-by: Peter Lazorchak <lazorchakp@gmail.com>
    Co-authored-by: Guido van Rossum <gvanrossum@users.noreply.github.com>
    Co-authored-by: Guido van Rossum <gvanrossum@gmail.com>

commit f11d0d8be8af28e1368c3c7c116218cf65ddf93e
Author: Erik Soma <stillusingirc@gmail.com>
Date:   Sat Mar 23 11:39:35 2024 -0400

    gh-91227: Ignore ERROR_PORT_UNREACHABLE in proactor recvfrom() (#32011)

commit 9967b568edd2e35b0415c14c7242f3ca2c0dc03d
Author: Victor Stinner <vstinner@python.org>
Date:   Sat Mar 23 13:01:20 2024 +0100

    gh-117008: Fix functools test_recursive_pickle() (#117009)

    Use support.infinite_recursion() in test_recursive_pickle() of
    test_functools to prevent a stack overflow on \"ARM64 Windows
    Non-Debug\" buildbot.

    Lower Py_C_RECURSION_LIMIT to 1,000 frames on Windows ARM64.

commit 72eea512b88f8fd68b7258242c37da963ad87360
Author: Barney Gale <barney.gale@gmail.com>
Date:   Fri Mar 22 19:14:09 2024 +0000

    GH-106747: Document another difference between `glob` and `pathlib`. (#116518)

    Document that `path.glob()` might return *path*, whereas
    `glob.glob(root_dir=path)` will never return an empty string corresponding
    to *path*.

commit e28477f214276db941e715eebc8cdfb96c1207d9
Author: Mark Shannon <mark@hotpy.org>
Date:   Fri Mar 22 18:43:25 2024 +0000

    GH-117108: Change the size of the GC increment to about 1% of the total heap size. (GH-117120)

commit e2e0b4b4b92694ba894e02b4a66fd87c166ed10f
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Fri Mar 22 20:19:10 2024 +0200

    gh-113024: C API: Add PyObject_GenericHash() function (GH-113025)

commit 567ab3bd15398c8c7b791f3e376ae3e3c0bbe079
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Fri Mar 22 20:08:00 2024 +0200

    gh-117084: Fix ZIP file extraction for directory entry names with backslashes on Windows (GH-117129)

commit 5a78f6e798d5c2af1dba2df6c9f1f1e5aac02a86
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Fri Mar 22 20:03:48 2024 +0200

    gh-117134: Microoptimize glob() for include_hidden=True (GH-117135)

commit 00baaa21de229a6db80ff2b84c2fd6ad1999a24c
Author: Vinay Sajip <vinay_sajip@yahoo.co.uk>
Date:   Fri Mar 22 17:25:51 2024 +0000

    [docs] Fix typo in docstring and add example to logging cookbook. (GH-117157)

commit 40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f
Author: Jakub Stasiak <jakub@stasiak.at>
Date:   Fri Mar 22 17:49:56 2024 +0100

    GH-113171: Fix \"private\" (non-global) IP address ranges (GH-113179)

    * GH-113171: Fix \"private\" (really non-global) IP address ranges

    The _private_networks variables, used by various is_private
    implementations, were missing some ranges and at the same time had
    overly strict ranges (where there are more specific ranges considered
    globally reachable by the IANA registries).

    This patch updates the ranges with what was missing or otherwise
    incorrect.

    I left 100.64.0.0/10 alone, for now, as it's been made special in [1]
    and I'm not sure if we want to undo that as I don't quite understand the
    motivation behind it.

    The _address_exclude_many() call returns 8 networks for IPv4, 121
    networks for IPv6.

    [1] https://github.com/python/cpython/issues/61602

commit 3be9b9d8722696b95555937bb211dc4cda714d56
Author: Steve Dower <steve.dower@python.org>
Date:   Fri Mar 22 15:00:50 2024 +0000

    Fix get_packagefamilyname helper function on Windows 32-bit (GH-117153)

commit 63d6f2623ef2aa90f51c6a928b96845b9b380d89
Author: NGRsoftlab <78017794+NGRsoftlab@users.noreply.github.com>
Date:   Fri Mar 22 14:25:38 2024 +0300

    gh-117068: Remove useless code in bytesio.c:resize_buffer() (GH-117069)

    Co-authored-by: i.khabibulin <i.khabibulin@ngrsoftlab.ru>

commit 42ae924d278c48a719fb0ab86357f3235a9f7ab9
Author: Petr Viktorin <encukou@gmail.com>
Date:   Fri Mar 22 10:42:18 2024 +0100

    gh-117127: glob tests: Reopen dir_fd to pick up directory changes (GH-117128)

commit 8383915031942f441f435a5ae800790116047b80
Author: Tim Peters <tim.peters@gmail.com>
Date:   Thu Mar 21 22:27:25 2024 -0500

    GH-116939: Rewrite binarysort() (#116940)

    Rewrote binarysort() for clarity.

    Also changed the signature to be more coherent (it was mixing sortslice with raw pointers).

    No change in method or functionality. However, I left some experiments in, disabled for now
    via `#if` tricks. Since this code was first written, some kinds of comparisons have gotten
    enormously faster (like for lists of floats), which changes the tradeoffs.

    For example, plain insertion sort's simpler innermost loop and highly predictable branches
    leave it very competitive (even beating, by a bit) binary insertion when comparisons are
    very cheap, despite that it can do many more compares. And it wins big on runs that
    are already sorted (moving the next one in takes only 1 compare then).

    So I left code for a plain insertion sort, to make future experimenting easier.

    Also made the maximum value of minrun a `#define` (``MAX_MINRUN`) to make
    experimenting with that easier too.

    And another bit of `#if``-disabled code rewrites binary insertion's innermost loop to
    remove its unpredictable branch. Surprisingly, this doesn't really seem to help
    overall. I'm unclear on why not. It certainly adds more instructions, but they're very
    simple, and it's hard to be believe they cost as much as a branch miss.

commit 97ba910e47ad298114800587979ce7beb0a705a3
Author: Guido van Rossum <guido@python.org>
Date:   Thu Mar 21 18:27:48 2024 -0700

    gh-108716:: Remove _PyStaticCode_Init/Fini (#117141)

    More deepfreeze cleanup.

commit b3d25df8d38b79310587da54dbd88b06a16d4904
Author: Eric Snow <ericsnowcurrently@gmail.com>
Date:   Thu Mar 21 18:20:20 2024 -0600

    gh-105716: Fix _PyInterpreterState_IsRunningMain() For Embedders (gh-117140)

    When I added _PyInterpreterState_IsRunningMain() and friends last year, I tried to accommodate applications that embed Python but don't call _PyInterpreterState_SetRunningMain() (not that they're expected to).  That mostly worked fine until my recent changes in gh-117049, where the subtleties with the fallback code led to failures; the change ended up breaking test_tools.test_freeze, which exercises a basic embedding situation.

    The simplest fix is to drop the fallback code I originally added to _PyInterpreterState_IsRunningMain() (and later to _PyThreadState_IsRunningMain()).  I've kept the fallback in the _xxsubinterpreters module though.  I've also updated Py_FrozenMain() to call _PyInterpreterState_SetRunningMain().

commit c4bf58a14f162557038a1535ca22c52b49d81d7b
Author: Thomas A Caswell <tcaswell@gmail.com>
Date:   Thu Mar 21 19:54:50 2024 -0400

    gh-116745: Remove all internal usage of @LIBPYTHON@ (#116746)

    Replace with MODULE_LDFLAGS.

commit 3ec57307e70ee6f42410e844d3399bbd598917ba
Author: Malcolm Smith <smith@chaquo.com>
Date:   Thu Mar 21 23:52:29 2024 +0000

    gh-71052: Add Android build script and instructions (#116426)

commit 50f9b0b1e0fb181875751cef951351ed007b6397
Author: Victor Stinner <vstinner@python.org>
Date:   Thu Mar 21 23:17:09 2024 +0100

    gh-117061: Fix test_posix.test_sched_setaffinity() on RHEL9 (#117126)

    On RHEL9, sched_setaffinity(0, []) does not fail.

commit 0907871d43bffb613cbd560224e1a9db13d06c06
Author: Ned Batchelder <ned@nedbatchelder.com>
Date:   Thu Mar 21 15:47:09 2024 -0400

    docs: fix over-linking in dataclasses.rst (#117005)

commit 570a82d46abfebb9976961113fb0f8bb400ad182
Author: Guido van Rossum <guido@python.org>
Date:   Thu Mar 21 12:37:41 2024 -0700

    gh-117045: Add code object to function version cache (#117028)

    Changes to the function version cache:

    - In addition to the function object, also store the code object,
      and allow the latter to be retrieved even if the function has been evicted.
    - Stop assigning new function versions after a critical attribute (e.g. `__code__`)
      has been modified; the version is permanently reset to zero in this case.
    - Changes to `__annotations__` are no longer considered critical. (This fixes gh-109998.)

    Changes to the Tier 2 optimization machinery:

    - If we cannot map a function version to a function, but it is still mapped to a code object,
      we continue projecting the trace.
      The operand of the `_PUSH_FRAME` and `_POP_FRAME` opcodes can be either NULL,
      a function object, or a code object with the lowest bit set.

    This allows us to trace through code that calls an ephemeral function,
    i.e., a function that may not be alive when we are constructing the executor,
    e.g. a generator expression or certain nested functions.
    We will lose globals removal inside such functions,
    but we can still do other peephole operations
    (and even possibly [call inlining](https://github.com/python/cpython/pull/116290),
    if we decide to do it), which only need the code object.
    As before, if we cannot retrieve the code object from the cache, we stop projecting.

commit c85d84166a84a5cb2d724012726bad34229ad24e
Author: Will Childs-Klein <willck93@gmail.com>
Date:   Thu Mar 21 14:16:36 2024 -0500

    gh-116333: Relax error string text expectations in SSL-related tests (GH-116334)

    * Relax error string text expectations in SSL-related tests

    As suggested [here][1], this change relaxes the OpenSSL error string
    text expectations in a number of tests. This was specifically done in
    support of more easily building CPython [AWS-LC][2], but because AWS-LC
    is a fork of [BoringSSL][3], it should increase compatibility with that
    library as well.

    In addition to the error string relaxations, we also add some guards
    around the `tls-unique` channel binding being used with TLSv1.3, as that
    feature (described in [RFC 6929][4]) is [not defined][5] for TLSv1.3.

    [1]: https://discuss.python.org/t/support-building-ssl-and-hashlib-modules-against-aws-lc/44505/4
    [2]: https://github.com/aws/aws-lc
    [3]: https://github.com/google/boringssl
    [4]: https://datatracker.ietf.org/doc/html/rfc5929#section-3
    [5]: https://datatracker.ietf.org/doc/html/rfc8446#appendix-C.5

commit 1f72fb5447ef3f8892b4a7a6213522579c618e8e
Author: Sam Gross <colesbury@gmail.com>
Date:   Thu Mar 21 14:21:02 2024 -0400

    gh-116522: Refactor `_PyThreadState_DeleteExcept` (#117131)

    Split `_PyThreadState_DeleteExcept` into two functions:

    - `_PyThreadState_RemoveExcept` removes all thread states other than one
      passed as an argument. It returns the removed thread states as a
      linked list.

    - `_PyThreadState_DeleteList` deletes those dead thread states. It may
      call destructors, so we want to \"start the world\" before calling
      `_PyThreadState_DeleteList` to avoid potential deadlocks.

commit 50369e6c34d05222e5a0ec9443a9f7b230e83112
Author: Michael Droettboom <mdboom@gmail.com>
Date:   Thu Mar 21 13:27:46 2024 -0400

    gh-116996: Add pystats about _Py_uop_analyse_and_optimize (GH-116997)

commit 617158e07811edfd6fd552a3d84b0beedd8f1d18
Author: Eric Snow <ericsnowcurrently@gmail.com>
Date:   Thu Mar 21 11:15:02 2024 -0600

    gh-76785: Drop PyInterpreterID_Type (gh-117101)

    I added it quite a while ago as a strategy for managing interpreter lifetimes relative to the PEP 554 (now 734) implementation.  Relatively recently I refactored that implementation to no longer rely on InterpreterID objects.  Thus now I'm removing it.

commit abdd1f938f08e536864532b2071f144515ecc88b
Author: Victor Stinner <vstinner@python.org>
Date:   Thu Mar 21 17:45:43 2024 +0100

    gh-85283: Build _testconsole extension with limited C API (#117125)

commit 8bea6c411d65cd987616b4ecdb86373e4f21f1c6
Author: Victor Stinner <vstinner@python.org>
Date:   Thu Mar 21 17:07:00 2024 +0100

    gh-115754: Add Py_GetConstant() function (#116883)

    Add Py_GetConstant() and Py_GetConstantBorrowed() functions.

    In the limited C API version 3.13, getting Py_None, Py_False,
    Py_True, Py_Ellipsis and Py_NotImplemented singletons is now
    implemented as function calls at the stable ABI level to hide
    implementation details. Getting these constants still return borrowed
    references.

    Add _testlimitedcapi/object.c and test_capi/test_object.py to test
    Py_GetConstant() and Py_GetConstantBorrowed() functions.

commit 5a76d1be8ef371b75ca65166726923c249b5f615
Author: Eric Snow <ericsnowcurrently@gmail.com>
Date:   Thu Mar 21 10:06:35 2024 -0600

    gh-105716: Update interp->threads.main After Fork (gh-117049)

    I missed this in gh-109921.

    We also update Py_Exit() to call _PyInterpreterState_SetNotRunningMain(), if necessary.

commit bbee57fa8c318cb26d6c8651254927a1972c9738
Author: Eric Snow <ericsnowcurrently@gmail.com>
Date:   Thu Mar 21 09:56:12 2024 -0600

    gh-76785: Clean Up Interpreter ID Conversions (gh-117048)

    Mostly we unify the two different implementations of the conversion code (from PyObject * to int64_t.  We also drop the PyArg_ParseTuple()-style converter function, as well as rename and move PyInterpreterID_LookUp().

commit e728303532168efab7694c55c82ea19b18bf8385
Author: Sam Gross <colesbury@gmail.com>
Date:   Thu Mar 21 10:01:16 2024 -0400

    gh-116522: Stop the world before fork() and during shutdown (#116607)

    This changes the free-threaded build to perform a stop-the-world pause
    before deleting other thread states when forking and during shutdown.
    This fixes some crashes when using multiprocessing and during shutdown
    when running with `PYTHON_GIL=0`.

    This also changes `PyOS_BeforeFork` to acquire the runtime lock
    (i.e., `HEAD_LOCK(&_PyRuntime)`) before forking to ensure that data
    protected by the runtime lock (and not just the GIL or stop-the-world)
    is in a consistent state before forking.

commit 1f8b24ef69896680d6ba6005e75e1cc79a744f9e
Author: Malcolm Smith <smith@chaquo.com>
Date:   Thu Mar 21 13:20:57 2024 +0000

    gh-71052: Implement `ctypes.util.find_library` on Android (GH-116379)

commit d16c9d1278164f04778861814ebc87ed087511fc
Author: Tian Gao <gaogaotiantian@hotmail.com>
Date:   Thu Mar 21 03:30:10 2024 -0700

    gh-116987: Support class code objects in inspect.findsource() (GH-117025)

commit 6547330f4e896c6748da23704b617e060e6cc68e
Author: Adam Turner <9087854+AA-Turner@users.noreply.github.com>
Date:   Thu Mar 21 03:49:10 2024 +0000

    GH-109653: Defer import of ``importlib.metadata._adapters`` (#109829)

    * adapters

    * Add comments for deferred imports with links to rationale.

    * Add blurb

    ---------

    Co-authored-by: Jason R. Coombs <jaraco@jaraco.com>

commit 667294d5b2ee812ebe0c9c1efd58e2006b61f827
Author: Jason R. Coombs <jaraco@jaraco.com>
Date:   Wed Mar 20 23:01:24 2024 -0400

    gh-117089: Apply changes from importlib_metadata 7.1.0 (#117094)

    * Apply changes from importlib_metadata 7.1.0

    * Include the data sources in the makefile (even though they're not needed)

commit f4cc77d494ee0e10ed84ce369f0910c70a2f6d44
Author: Victor Stinner <vstinner@python.org>
Date:   Thu Mar 21 00:06:24 2024 +0100

    gh-116869: Enable -Werror in test_cext for Free Threading (#117106)

    Check for warnings, but don't enable the compiler flag
    -Werror=declaration-after-statement.

commit 104602a6078564765b7b8f42888f8eaa37b129b1
Author: Victor Stinner <vstinner@python.org>
Date:   Wed Mar 20 23:52:23 2024 +0100

    gh-105927: Limit PyWeakref_GetRef() to limited C API 3.13 (#117091)

commit 8ad88984200b2ccddc0a08229dd2f4c14d1a71fc
Author: Jason R. Coombs <jaraco@jaraco.com>
Date:   Wed Mar 20 17:11:00 2024 -0400

    gh-117089: Move importlib.metadata tests to their own package (#117092)

    * Ensure importlib.metadata tests do not leak references in sys.modules.

    * Move importlib.metadata tests to their own package for easier syncing with importlib_metadata.

    * Update owners and makefile for new directories.

    * Add blurb

commit 7d446548ef53f6c3de1097c6d44cada6642ddc85
Author: Carol Willing <carolcode@willingconsulting.com>
Date:   Wed Mar 20 14:00:59 2024 -0700

    Fix sort order for \"locale encoding\" glossary item (#115794)

    Co-authored-by: C.A.M. Gerlach <CAM.Gerlach@Gerlach.CAM>

commit 63289b9dfbc7d87e81f1517422ee91b6b6d19531
Author: Mark Shannon <mark@hotpy.org>
Date:   Wed Mar 20 18:24:02 2024 +0000

    GH-117066: Tier 2 optimizer: Don't throw away good traces if we can't optimize them perfectly. (GH-117067)

commit dcaf33a41d5d220523d71c9b35bc08f5b8405dac
Author: Petr Viktorin <encukou@gmail.com>
Date:   Wed Mar 20 17:33:08 2024 +0100

    gh-114314: ctypes: remove stgdict and switch to heap types (GH-116458)

    Before this change, ctypes classes used a custom dict subclass, `StgDict`,
    as their `tp_dict`. This acts like a regular dict but also includes extra information
    about the type.

    This replaces stgdict by `StgInfo`, a C struct on the type, accessed by
    `PyObject_GetTypeData()` (PEP-697).
    All usage of `StgDict` (mainly variables named `stgdict`, `dict`, `edict` etc.) is
    converted to `StgInfo` (named `stginfo`, `info`, `einfo`, etc.).
    Where the dict is actually used for class attributes (as a regular PyDict), it's now
    called `attrdict`.

    This change -- not overriding `tp_dict` -- is made to make me comfortable with
    the next part of this PR: moving the initialization logic from `tp_new` to `tp_init`.

    The `StgInfo` is set up in `__init__` of each class, with a guard that prevents
    calling `__init__` more than once. Note that abstract classes (like `Array` or
    `Structure`) are created using `PyType_FromMetaclass` and do not have
    `__init__` called.
    Previously, this was done in `__new__`, which also wasn't called for abstract
    classes.
    Since `__init__` can be called from Python code or skipped, there is a tested
    guard to ensure `StgInfo` is initialized exactly once before it's used.

    Co-authored-by: neonene <53406459+neonene@users.noreply.github.com>
    Co-authored-by: Erlend E. Aasland <erlend.aasland@protonmail.com>

commit 44fbab43d8f3f2df07091d237824cf4fa1f6c57c
Author: Russell Keith-Magee <russell@keith-magee.com>
Date:   Wed Mar 20 23:32:56 2024 +0800

    gh-117058: Update GUI and packaging recommendations for macOS. (#117059)

commit 9221ef2d8cb7f4cf37592eb650d4c8f972033000
Author: Brett Simmers <swtaarrs@users.noreply.github.com>
Date:   Wed Mar 20 08:18:26 2024 -0700

    gh-116908: Only write to `_pending_calls.calls_to_do` with atomic operations (#117044)

    These writes to `pending->calls_to_do` need to be atomic, because other threads
    can read (atomically) from `calls_to_do` without holding `pending->mutex`.

commit fc4599800778f9b130d5e336deadbdeb5bd3e5ee
Author: jkriegshauser <jkriegshauser@gmail.com>
Date:   Wed Mar 20 07:33:28 2024 -0700

    gh-116773: Ensure overlapped objects on Windows are not deallocated too early by asyncio (GH-116774)

commit 519b2ae22b54760475bbf62b9558d453c703f9c6
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Wed Mar 20 15:39:53 2024 +0200

    gh-117021: Fix integer overflow in PyLong_AsPid() on non-Windows 64-bit platforms (GH-117064)")`
…

`[a016a54](/NGRsoftlab/cpython/commit/a016a5413a6d8bd02939a6fb9afef90dbbb2fb54)`

```
commit 9dae05ee59eeba0e67af2a46f2a2907c9f8d7e4a
Author: Moshe Kaplan <mosheekaplan@gmail.com>
Date:   Mon Apr 1 15:53:00 2024 -0400

    Docs: specify XML document name in xml.etree.elementtree example (#24223)

commit fc2071687b708598264a3403b7f9104667c1092f
Author: Matthew Davis <7035647+mdavis-xyz@users.noreply.github.com>
Date:   Mon Apr 1 21:49:14 2024 +0200

    Docs: add more links to PIPE in subprocess docs (#25416)

commit fc8007ee3635db6ab73e132ebff987c910b6d538
Author: Barney Gale <barney.gale@gmail.com>
Date:   Mon Apr 1 20:37:41 2024 +0100

    GH-117337: Deprecate `glob.glob0()` and `glob.glob1()`. (#117371)

    These undocumented functions are no longer used by `msilib`, so there's no
    reason to keep them around.

commit c741ad3537193c63fe697a8f0316aecd45eeb9ba
Author: Justin Turner Arthur <justinarthur@gmail.com>
Date:   Mon Apr 1 12:07:29 2024 -0500

    gh-77714: Provide an async iterator version of as_completed (GH-22491)

    * as_completed returns object that is both iterator and async iterator
    * Existing tests adjusted to test both the old and new style
    * New test to ensure iterator can be resumed
    * New test to ensure async iterator yields any passed-in Futures as-is

    Co-authored-by: Serhiy Storchaka <storchaka@gmail.com>
    Co-authored-by: Guido van Rossum <gvanrossum@gmail.com>

commit ddf814db744006e0f42328aa15ace97c9d8ad681
Author: Guido van Rossum <guido@python.org>
Date:   Mon Apr 1 09:13:38 2024 -0700

    Silence compiler warnings in gc.c (#117422)

commit 179869af922252a0c1cef65fd2923856895e7d1b
Author: Petr Viktorin <encukou@gmail.com>
Date:   Mon Apr 1 17:01:22 2024 +0200

    gh-94808: Fix refcounting in PyObject_Print tests (GH-117421)

commit dd44ab994b7262f0704d64996e0a1bc37b233407
Author: neonene <53406459+neonene@users.noreply.github.com>
Date:   Mon Apr 1 22:28:14 2024 +0900

    gh-117142: ctypes: Unify meta tp slot functions (GH-117143)

    Integrates the following ctypes meta tp slot functions:
    * `CDataType_traverse()` into `CType_Type_traverse()`.
    * `CDataType_clear()` into `CType_Type_clear()`.
    * `CDataType_dealloc()` into `CType_Type_dealloc()`.
    * `CDataType_repeat()` into `CType_Type_repeat()`.

commit 3de09cadde788065a4f2d45117e789c9353bbd12
Author: Steve (Gadget) Barnes <gadgetsteve@hotmail.com>
Date:   Mon Apr 1 14:02:07 2024 +0100

    gh-91565: Replace bugs.python.org links with Devguide/GitHub ones  (GH-91568)

    Co-authored-by: Hugo van Kemenade <hugovk@users.noreply.github.com>
    Co-authored-by: Oleg Iarygin <oleg@arhadthedev.net>
    Co-authored-by: Petr Viktorin <encukou@gmail.com>
    Co-authored-by: Ezio Melotti <ezio.melotti@gmail.com>

commit 90c3c68a658db6951b77a5be50088ec2f6adc8eb
Author: MonadChains <monadchains@gmail.com>
Date:   Mon Apr 1 13:52:25 2024 +0100

    gh-94808:Improve coverage of PyObject_Print (GH-98749)

commit 348cf6e0078eae156c503e8f61ef5e27ae28e57b
Author: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Date:   Mon Apr 1 11:14:37 2024 +0000

    Bump mypy from 1.8.0 to 1.9.0 in /Tools (#117418)

    Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
    Co-authored-by: Alex Waygood <Alex.Waygood@Gmail.com>

commit 9b403fb559bfce93a478937e0ef7e539a9a95283
Author: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Date:   Mon Apr 1 11:05:14 2024 +0000

    build(deps-dev): bump types-psutil from 5.9.5.20240205 to 5.9.5.20240316 in /Tools (#117417)

    Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
    Co-authored-by: Alex Waygood <Alex.Waygood@Gmail.com>

commit 93c7d9d17b571b6a181af7c02830d29819535c35
Author: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Date:   Mon Apr 1 11:38:38 2024 +0100

    build(deps-dev): bump types-setuptools from 69.1.0.20240301 to 69.2.0.20240317 in /Tools (#117419)

    Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

commit 3bb12e407c183946471272f8aee098e54e62a333
Author: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Date:   Mon Apr 1 09:54:33 2024 +0000

    build(deps): bump actions/add-to-project from 0.6.0 to 1.0.0 (#117415)

    Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

commit 56e99307c49adcc6df355f8070229371c97d654f
Author: Adorilson Bezerra <adorilson@gmail.com>
Date:   Sun Mar 31 23:34:54 2024 +0100

    Doc: printf-style library/stdtype improvements (#16741)

commit 18e12641a61a88f7d08b2114ebe965892c6661c5
Author: Raymond Hettinger <rhettinger@users.noreply.github.com>
Date:   Sun Mar 31 16:09:22 2024 -0500

    gh-117387 Remove hash mark from introductory text (#117409)

commit a32d6939486d7f90ee57e215077f6116e19de24d
Author: Deborah <32307299+dlwrnc@users.noreply.github.com>
Date:   Sun Mar 31 22:11:48 2024 +0200

    gh-102190: Add additional zipfile `pwd=` arg docstrings (gh-102195)

    This just documents the parameter that already exists.

    ---------

    Co-authored-by: Gregory P. Smith <greg@krypto.org>
    Co-authored-by: Erlend E. Aasland <erlend.aasland@protonmail.com>

commit 262445358e21c56d7c68e3ee76c13e469d2ea348
Author: Shantanu <12621235+hauntsaninja@users.noreply.github.com>
Date:   Sun Mar 31 12:02:48 2024 -0700

    Link to the Python type system specification (#117400)

commit 752e18389ed03087b51b38eac9769ef8dfd167b7
Author: Barney Gale <barney.gale@gmail.com>
Date:   Sun Mar 31 19:14:48 2024 +0100

    GH-114575: Rename `PurePath.pathmod` to `PurePath.parser` (#116513)

    And rename the private base class from `PathModuleBase` to `ParserBase`.

commit bfc57d43d8766120ba0c8f3f6d7b2ac681a81d8a
Author: Sam Gross <colesbury@gmail.com>
Date:   Fri Mar 29 18:58:08 2024 -0400

    gh-117303: Don't detach in `PyThreadState_DeleteCurrent()` (#117304)

    This fixes a crash in `test_threading.test_reinit_tls_after_fork()` when
    running with the GIL disabled. We already properly handle the case where
    the thread state is `_Py_THREAD_ATTACHED` in `tstate_delete_common()` --
    we just need to remove an assertion.

    Keeping the thread attached means that a stop-the-world pause, such as
    for a `fork()`, won't commence until we remove our thread state from the
    interpreter's linked list. This prevents a crash when the child process
    tries to clean up the dead thread states.

commit 05e0b67a43c5c1778dc2643c8b7c12864e135999
Author: Erlend E. Aasland <erlend@python.org>
Date:   Fri Mar 29 21:23:28 2024 +0100

    gh-116664: In _warnings.c, make filters_version access thread-safe (#117374)

    - assert that the lock is held in already_warned()
    - protect 'filters_version' increment in warnings_filters_mutated_impl()

commit 019143fecbfc26e69800d28d2a9e3392a051780b
Author: Jason R. Coombs <jaraco@jaraco.com>
Date:   Fri Mar 29 16:06:09 2024 -0400

    gh-117348: Refactored RawConfigParser._read for similicity and comprehensibility (#117372)

    * Extract method for _read_inner, reducing complexity and indentation by 1.

    * Extract method for _raise_all and yield ParseErrors from _read_inner.

    Reduces complexity by 1 and reduces touch points for handling errors in _read_inner.

    * Prefer iterators to splat expansion and literal indexing.

    * Extract method for _strip_comments. Reduces complexity by 7.

    * Model the file lines in a class to encapsulate the comment status and cleaned value.

    * Encapsulate the read state as a dataclass

    * Extract _handle_continuation_line and _handle_rest methods. Reduces complexity by 8.

    * Reindent

    * At least for now, collect errors in the ReadState

    * Check for missing section header separately.

    * Extract methods for _handle_header and _handle_option. Reduces complexity by 6.

    * Remove unreachable code. Reduces complexity by 4.

    * Remove unreachable branch

    * Handle error condition early. Reduces complexity by 1.

    * Add blurb

    * Move _raise_all to ParsingError, as its behavior is most closely related to the exception class and not the reader.

    * Split _strip* into separate methods.

    * Refactor _strip_full to compute the strip just once and use 'not any' to determine the factor.

    * Replace use of 'sys.maxsize' with direct computation of the stripped value.

    * Extract has_comments as a dynamic property.

    * Implement clean as a cached property.

    * Model comment prefixes in the RawConfigParser within a prefixes namespace.

    * Use a regular expression to search for the first match.

    Avoids mutating variables and tricky logic and over-computing all of the starts when only the first is relevant.

commit 01bd74eadbc4ff839d39762fae6366f50c1e116e
Author: Sam Gross <colesbury@gmail.com>
Date:   Fri Mar 29 15:33:06 2024 -0400

    gh-117300: Use stop the world to make `sys._current_frames` and `sys._current_exceptions` thread-safe. (#117301)

    This adds a stop the world pause to make the two functions thread-safe
    when the GIL is disabled in the free-threaded build.

    Additionally, the main test thread may call `sys._current_exceptions()` as
    soon as `g_raised.set()` is called. The background thread may not yet reach
    the `leave_g.wait()` line.

commit 94c97423a9c4969f8ddd4a3aa4aacb99c4d5263d
Author: Guido van Rossum <guido@python.org>
Date:   Fri Mar 29 11:31:09 2024 -0700

    Fix broken format in error for bad input in summarize_stats.py (#117375)

    When you pass the script a non-existent input file, you get a TypeError instead of the intended ValueError.

commit 5d21d884b6ffa45dac50a5f9a07c41356a8478b4
Author: mpage <mpage@meta.com>
Date:   Fri Mar 29 10:42:02 2024 -0700

    gh-111926: Avoid locking in PyType_IsSubtype (#117275)

    Read the MRO in a thread-unsafe way in `PyType_IsSubtype` to avoid locking. Fixing this is tracked in #117306.

    The motivation for this change is in support of making weakrefs thread-safe in free-threaded builds:

    `WeakValueDictionary` uses a special dictionary function, `_PyDict_DelItemIf`
    to remove dead weakrefs from the dictionary. `_PyDict_DelItemIf` removes a key
    if a user supplied predicate evaluates to true for the value associated with
    the key. Crucially for the `WeakValueDictionary` use case, the predicate
    evaluation + deletion sequence is atomic, provided that the predicate doesn’t
    suspend. The predicate used by `WeakValueDictionary` includes a subtype check,
    which we must ensure doesn't suspend in free-threaded builds.

commit 19c1dd60c5b53fb0533610ad139ef591294f26e8
Author: Sam Gross <colesbury@gmail.com>
Date:   Fri Mar 29 13:35:43 2024 -0400

    gh-117323: Make `cell` thread-safe in free-threaded builds (#117330)

    Use critical sections to lock around accesses to cell contents. The critical sections are no-ops in the default (with GIL) build.

commit 397d88db5e9ab2a43de3fdf5f8b973a949edc405
Author: Sam Gross <colesbury@gmail.com>
Date:   Fri Mar 29 13:34:04 2024 -0400

    gh-117344: Skip flaky tests in free-threaded build (#117355)

    The tests are not reliable with the GIL disabled. In theory, they can
    fail with the GIL enabled too, but the failures are much more likely
    with the GIL disabled.

commit f05fb2e65c2dffdfae940f2707765c4994925205
Author: Sam Gross <colesbury@gmail.com>
Date:   Fri Mar 29 13:33:04 2024 -0400

    gh-112529: Don't untrack tuples or dicts with zero refcount (#117370)

    The free-threaded GC sometimes sees objects with zero refcount. This can
    happen due to the delay in merging biased reference counting fields,
    and, in the future, due to deferred reference counting. We should not
    untrack these objects or they will never be collected.

    This fixes the refleaks in the free-threaded build.

commit ddf95b5f16031cdbd0d728e55eb06dff002a8678
Author: Erlend E. Aasland <erlend@python.org>
Date:   Fri Mar 29 18:26:06 2024 +0100

    gh-116664: Fix unused var warnings in _warnings.c in non-free-threaded builds (#117373)

    The warnings were introduced by commit c1712ef06.

commit 0fa571dbcdf19b541276cb00bb929381930467b2
Author: Tian Gao <gaogaotiantian@hotmail.com>
Date:   Fri Mar 29 09:02:01 2024 -0700

    Refactor pdb executable targets (#112570)

    Co-authored-by: Jason R. Coombs <jaraco@jaraco.com>

commit 54f7e14500471d1c46fb553adb3ca24cd1fef084
Author: Pedro Lacerda <pslacerda@users.noreply.github.com>
Date:   Fri Mar 29 12:05:00 2024 -0300

    gh-66449: configparser: Add support for unnamed sections (#117273)

    Co-authored-by: Jason R. Coombs <jaraco@jaraco.com>

commit d9cfe7e565a6e2dc15747a904736264e31a10be4
Author: Nikita Sobolev <mail@sobolevn.me>
Date:   Fri Mar 29 14:14:25 2024 +0300

    gh-117166: Ignore empty and temporary dirs in `test_makefile` (#117190)

commit 35b6c4a4da201a947b2ceb96ae4c0d83d4d2df4f
Author: Victor Stinner <vstinner@python.org>
Date:   Fri Mar 29 11:25:17 2024 +0100

    gh-117347: Fix test_clinic side effects (#117363)

    Save/restore converters in ClinicWholeFileTest and
    ClinicExternalTest.

commit 7e2fef865899837c47e91ef0180fa59eb03e840b
Author: neonene <53406459+neonene@users.noreply.github.com>
Date:   Fri Mar 29 18:40:48 2024 +0900

    gh-117142: ctypes: Migrate global vars to module state (GH-117189)

commit 2e9be80c99f635c2f7761e8356b0260922d6e7a6
Author: Gregory P. Smith <greg@krypto.org>
Date:   Thu Mar 28 17:58:37 2024 -0700

    Fix reversed assertRegex checks in test_ssl. (#117351)

commit 8eec7ed714e65d616573b7331780b0aa43c6ed6a
Author: 傅立业（Chris Fu） <17433201@qq.com>
Date:   Fri Mar 29 08:19:20 2024 +0800

    gh-117110: Fix subclasses of typing.Any with custom constructors (#117111)

commit a17f313e3958e825db9a83594c8471a984316536
Author: Christopher Chianelli <christopher@timefold.ai>
Date:   Thu Mar 28 18:26:56 2024 -0400

    gh-117339: Use NULL instead of None for LOAD_SUPER_ATTR in dis docs (GH-117343)

commit 26d328b2ba26374fb8d9ffe8215ecef7c5e3f7a2
Author: Michael Droettboom <mdboom@gmail.com>
Date:   Thu Mar 28 18:23:08 2024 -0400

    GH-117121: Add pystats to JIT builds (GH-117346)

commit 14f1ca7d5363386163839b31ce987423daecc3de
Author: Nice Zombies <nineteendo19d0@gmail.com>
Date:   Thu Mar 28 22:20:08 2024 +0100

    gh-117335: Handle non-iterables for `ntpath.commonpath` (GH-117336)

commit 18cf239e39e25e6cef50ecbb7f197a82f8920ff5
Author: Brandt Bucher <brandtbucher@microsoft.com>
Date:   Thu Mar 28 14:02:34 2024 -0700

    Increase the JIT CI timeouts to 75 minutes (GH-117342)

commit 29829b58a8328a7c2ccacaa74c1d7d120a5e5ca5
Author: Malcolm Smith <smith@chaquo.com>
Date:   Thu Mar 28 19:59:12 2024 +0000

    gh-117294: Report DocTestCase as skipped if all examples in the doctest are skipped (GH-117297)

commit efcc96844e7c66fcd6c23ac2d557ca141614ce9a
Author: Tian Gao <gaogaotiantian@hotmail.com>
Date:   Thu Mar 28 11:23:29 2024 -0700

    gh-69201: Separate stdout and stderr stream in test_pdb (#117308)

commit 6702d2bf6edcd5b5415e17837383623b9d76a5b8
Author: Victor Stinner <vstinner@python.org>
Date:   Thu Mar 28 17:40:58 2024 +0100

    gh-114331: Skip decimal test_maxcontext_exact_arith on s390x (#117326)

commit c1712ef066321c01bf09cba3f22fc474b5b8dfa7
Author: Erlend E. Aasland <erlend@python.org>
Date:   Thu Mar 28 16:05:08 2024 +0100

    gh-116664: Make module state Py_SETREF's in _warnings thread-safe (#116959)

    Mark the swap operations as critical sections.

    Add an internal Py_BEGIN_CRITICAL_SECTION_MUT API that takes a PyMutex
    pointer instead of a PyObject pointer.

commit 9a388b9a64927c372d85f0eaec3de9b7320a6fb5
Author: Joachim Wuttke <j.wuttke@fz-juelich.de>
Date:   Thu Mar 28 14:43:07 2024 +0100

    bpo-43848: explain optional argument mtime in gzip.py. (GH-25410)

    Co-authored-by: Jelle Zijlstra <jelle.zijlstra@gmail.com>

commit 8dbfdb2957a7baade3a88661517f163ad694c39f
Author: Sam Gross <colesbury@gmail.com>
Date:   Thu Mar 28 09:28:39 2024 -0400

    gh-110481: Fix biased reference counting queue initialization. (#117271)

    The biased reference counting queue must be initialized from the bound
    (active) thread because it uses `_Py_ThreadId()` as the key in a hash
    table.

commit 9a1e55b8c5723206116f7016921be3937ef2f4e5
Author: Chris Markiewicz <effigies@gmail.com>
Date:   Thu Mar 28 06:59:31 2024 -0400

    gh-117178: Recover lazy loading of self-referential modules (#117179)

commit 4c71d51a4b7989fc8754ba512c40e21666f9db0d
Author: Jelle Zijlstra <jelle.zijlstra@gmail.com>
Date:   Thu Mar 28 04:30:31 2024 -0600

    gh-117266: Fix crashes on user-created AST subclasses (GH-117276)

    Fix crashes on user-created AST subclasses

commit 8cb7d7ff86a1a2d41195f01ba4f218941dd7308c
Author: Gregory P. Smith <greg@krypto.org>
Date:   Thu Mar 28 03:11:58 2024 -0700

    gh-117310: Remove extra DECREF on "no ciphers" error path in `_ssl._SSLContext` constructor (#117309)

    Remove extra self DECREF on ssl "no ciphers" error path.

    This doesn't come up in practice because nobody links against a broken
    OpenSSL library that provides nothing.

commit 6c8ac8a32fd6de1960526561c44bc5603fab0f3e
Author: Erlend E. Aasland <erlend@python.org>
Date:   Thu Mar 28 09:40:37 2024 +0100

    gh-116303: Handle disabled test modules in test.support helpers (#116482)

    Make sure test.support helpers skip iso. failing if test extension
    modules are disabled. Also log TEST_MODULES in test.pythoninfo.

commit 0f27672c5002de96c9f1228b12460d5ce3f1d190
Author: Russell Keith-Magee <russell@keith-magee.com>
Date:   Thu Mar 28 16:13:13 2024 +0800

    gh-114099: Add documentation for iOS platform (GH-117057)

    Co-authored-by: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>
    Co-authored-by: Jacob Coffee <jacob@z7x.org>
    Co-authored-by: Malcolm Smith <smith@chaquo.com>
    Co-authored-by: Ned Deily <nad@python.org>

commit f006338017cfbf846e8f7391b9ee5f69df8dc620
Author: Russell Keith-Magee <russell@keith-magee.com>
Date:   Thu Mar 28 15:59:33 2024 +0800

    gh-114099: Additions to standard library to support iOS (GH-117052)

    Co-authored-by: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>
    Co-authored-by: Malcolm Smith <smith@chaquo.com>
    Co-authored-by: Ned Deily <nad@python.org>

commit b44898299a2ed97045c270f6474785da2ff07ced
Author: Tim Hatch <tim@timhatch.com>
Date:   Wed Mar 27 23:54:51 2024 -0700

    gh-89739: gh-77140: Support zip64 in zipimport (GH-94146)

    * Reads zip64 files as produced by the zipfile module
    * Include tests (somewhat slow, however, because of the need to create "large" zips)
    * About the same amount of strictness reading invalid zip files as zipfile has
    * Still works on files with prepended data (like pex)

    There are a lot more test cases at https://github.com/thatch/zipimport64/ that give me confidence that this works for real-world files.

    Fixes #89739 and #77140.

    ---------

    Co-authored-by: Itamar Ostricher <itamarost@gmail.com>
    Reviewed-by: Gregory P. Smith <greg@krypto.org>

commit 2cedd25c14d3acfdcb5e8ee55132ce3e334ab8fe
Author: Illia Volochii <illia.volochii@gmail.com>
Date:   Thu Mar 28 08:46:01 2024 +0200

    Revert "gh-116886: Temporarily disable CIfuzz (memory) (GH-117018)" (GH-117289)

    This reverts commit 1ab0d0b1167d78bf19661a3b5e533a2b68a57604.

    This reverts #117018.

    I expect the issue to be fixed based on https://github.com/google/oss-fuzz/pull/11708#issuecomment-2006442396 and https://github.com/actions/runner-images/issues/9491.

commit eefff682f09394fe4f18b7d7c6ac4c635caadd02
Author: Malcolm Smith <smith@chaquo.com>
Date:   Wed Mar 27 22:11:44 2024 +0000

    gh-108277: Make test_os tolerate 10 ms diff for timerfd on Android emulators (#117223)

commit 7aa89bc43e0bcf49eee5a39b5a7ba8f996f20d00
Author: Victor Stinner <vstinner@python.org>
Date:   Wed Mar 27 23:10:14 2024 +0100

    gh-113317: Change how Argument Clinic lists converters (#116853)

    * Add a new create_parser_namespace() function for
      PythonParser to pass objects to executed code.
    * In run_clinic(), list converters using 'converters' and
      'return_converters' dictionarties.
    * test_clinic: add 'object()' return converter.
    * Use also create_parser_namespace() in eval_ast_expr().

    Co-authored-by: Erlend E. Aasland <erlend@python.org>

commit 669ef49c7d42f35da6f7ee280102353b9b37f83e
Author: Seth Michael Larson <seth@python.org>
Date:   Wed Mar 27 16:56:14 2024 -0500

    gh-99108: Update and check HACL* version information (GH-117295)

    * Update and check HACL* version information

commit 262fb911ab7df8e890ebd0efb0773c3e0b5a757f
Author: Irit Katriel <1055913+iritkatriel@users.noreply.github.com>
Date:   Wed Mar 27 17:38:19 2024 +0000

    gh-117288: Allocate fewer label IDs in _PyCfg_ToInstructionSequence (#117290)

commit 74c8568d07719529b874897598d8b3bc25ff0434
Author: Malcolm Smith <smith@chaquo.com>
Date:   Wed Mar 27 16:53:27 2024 +0000

    gh-71042: Add `platform.android_ver` (#116674)

commit ce00de4c8cd39816f992e749c1074487d93abe9d
Author: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>
Date:   Wed Mar 27 16:46:35 2024 +0200

    gh-117225: doctest: only print "and X failed" when non-zero, don't pluralise "1 items" (#117228)

commit 92397d5ead38dde4154e70d00f24973bcf2a925a
Author: Raymond Hettinger <rhettinger@users.noreply.github.com>
Date:   Wed Mar 27 09:04:32 2024 -0500

    Add statistics recipe for sampling from an estimated probability density distribution (#117221)

commit b3e8c78ed7aa9bbd1084375587b99200c687cec9
Author: Tian Gao <gaogaotiantian@hotmail.com>
Date:   Tue Mar 26 18:20:12 2024 -0700

    gh-113548: Allow CLI arguments to `pdb -m` (#113557)

commit 48c0b05cf0dd2db275bd4653f84aa36c22bddcd2
Author: Adorilson Bezerra <adorilson@gmail.com>
Date:   Tue Mar 26 19:08:08 2024 +0000

    Change links on the index page (#117230)

commit af1b0e94400d1bf732466d675054df8cf7dfb62d
Author: AN Long <aisk@users.noreply.github.com>
Date:   Wed Mar 27 02:26:48 2024 +0800

    gh-104242: Enable test_is_char_device_true in pathlib test on all platform (GH-116983)

commit 79be75735c9d77972112cecc8d7e1af28c176ed0
Author: Irit Katriel <1055913+iritkatriel@users.noreply.github.com>
Date:   Tue Mar 26 15:18:17 2024 +0000

    gh-115775: Compiler adds __static_attributes__ field to classes (#115913)

commit 70969d53a77a8a190c40a30419e772bc874a4f62
Author: Antonio <57417288+amaddio@users.noreply.github.com>
Date:   Tue Mar 26 15:10:29 2024 +0100

    gh-97901 add missing text/rtf to mimetypes (GH-97902)

    Co-authored-by: Noam Cohen <noam@noam.me>

commit 4ec347760f98b156c6a2d42ca397af6b0b6ecc50
Author: AN Long <aisk@users.noreply.github.com>
Date:   Tue Mar 26 22:09:57 2024 +0800

    gh-115538: Use isolate mode when running venv test_multiprocessing_recursion() (#117116)

    Co-authored-by: Victor Stinner <vstinner@python.org>

commit 743f2c68f478279e1e56577fe95a0ed112b9abc5
Author: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>
Date:   Tue Mar 26 16:09:09 2024 +0200

    pre-commit: add `check-case-conflict` and `check-merge-conflict` (#117259)

commit 4abca7e1e7e2764faf20c7e677ea5c9ea9dbffe2
Author: Paulo Neves <ptsneves@users.noreply.github.com>
Date:   Tue Mar 26 13:37:50 2024 +0100

    gh-98966: Handle stdout=subprocess.STDOUT (GH-98967)

    Explicitly handle the case where stdout=STDOUT
    as otherwise the existing error handling gets
    confused and reports hard to understand errors.

    Signed-off-by: Paulo Neves <ptsneves@gmail.com>

commit 9654daf793b534b44a831c80f43505ab9e380f1f
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Tue Mar 26 13:26:45 2024 +0200

    gh-66543: Fix mimetype.guess_type() (GH-117217)

    Fix parsing of the following corner cases:

    * URLs with only a host name
    * URLs containing a fragment
    * URLs containing a query
    * filenames with only a UNC sharepoint on Windows

    Co-authored-by: Dong-hee Na <donghee.na92@gmail.com>

commit 8bef34f625e21886b1c64544c060e19ee2e229bf
Author: Mark Shannon <mark@hotpy.org>
Date:   Tue Mar 26 11:11:42 2024 +0000

    GH-117108: Set the "old space bit" to "visited" for all young objects  (#117213)

    Change old space bit of young objects from 0 to gcstate->visited_space.
    This ensures that any object created *and* collected during cycle GC has the bit set correctly.

commit bf82f77957a31c3731b4ec470c406f5708ca9ba3
Author: Mark Shannon <mark@hotpy.org>
Date:   Tue Mar 26 09:35:11 2024 +0000

    GH-116422: Tier2 hot/cold splitting (GH-116813)

    Splits the "cold" path, deopts and exits, from the "hot" path, reducing the size of most jitted instructions, at the cost of slower exits.

commit 61599a48f52e951d8813877ee311d2a830ba2cd8
Author: Pablo Galindo Salgado <Pablogsal@gmail.com>
Date:   Tue Mar 26 09:30:46 2024 +0000

    bpo-24612: Improve syntax error for 'not' after an operator (GH-28170)

    Co-authored-by: Lysandros Nikolaou <lisandrosnik@gmail.com>

commit 771902c257372e6c4df1ead4e8c46308561db7a7
Author: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>
Date:   Tue Mar 26 11:13:32 2024 +0200

    gh-83845: Add tests for operator module (#115883)

    Co-authored-by: Karthikeyan Singaravelan <tir.karthi@gmail.com>

commit ea9a296fce2f786b4cf43c7924e5de01061f27ca
Author: yevgeny hong <hongyevgeny@gmail.com>
Date:   Tue Mar 26 16:45:43 2024 +0900

    gh-115627: Fix PySSL_SetError handling SSL_ERROR_SYSCALL (GH-115628)

    Python 3.10 changed from using SSL_write() and SSL_read() to SSL_write_ex() and
    SSL_read_ex(), but did not update handling of the return value.

    Change error handling so that the return value is not examined.
    OSError (not EOF) is now returned when retval is 0.

    According to *recent* man pages of all functions for which we call
    PySSL_SetError, (in OpenSSL 3.0 and 1.1.1), their return value should
    be used to determine whether an error happened (i.e. if PySSL_SetError
    should be called), but not what kind of error happened (so,
    PySSL_SetError shouldn't need retval). To get the error,
    we need to use SSL_get_error.

    Co-authored-by: Serhiy Storchaka <storchaka@gmail.com>
    Co-authored-by: Petr Viktorin <encukou@gmail.com>

commit d52bdfb19fadd7614a0e5abaf68525fc7300e841
Author: Victor Stinner <vstinner@python.org>
Date:   Tue Mar 26 08:35:59 2024 +0100

    gh-83434: Disable XML in regrtest when -R option is used (#117232)

commit 9f74e86c78853c101a23e938f8e32ea838d8f62e
Author: Sebastian Pipping <sebastian@pipping.org>
Date:   Tue Mar 26 02:48:27 2024 +0100

    gh-117187: Fix XML tests for vanilla Expat <2.6.0 (GH-117203)

    This fixes XML unittest fallout from the https://github.com/python/cpython/issues/115398 security fix.  When configured using `--with-system-expat` on systems with older pre 2.6.0 versions of libexpat, our unittests were failing.

    * sax|etree: Simplify Expat version guard where simplifiable

    Idea by Matěj Cepl

    * sax|etree: Fix reparse deferral tests for vanilla Expat <2.6.0

    This *does not fix* the case of distros with an older version of libexpat with the 2.6.0 feature backported as a security fix.  (Ubuntu is a known example of this with its libexpat1 2.5.0-2ubunutu0.1 package)

commit 872e212378ef86392069034afd80bb53896fd93d
Author: Jonathan Protzenko <protz@microsoft.com>
Date:   Mon Mar 25 17:35:26 2024 -0700

    gh-99108: Refresh HACL*; update modules accordingly; fix namespacing (GH-117237)

    Pulls in a new update from https://github.com/hacl-star/hacl-star and fixes our C "namespacing" done by `Modules/_hacl/refresh.sh`.

commit 8945b7ff55b87d11c747af2dad0e3e4d631e62d6
Author: Eric V. Smith <ericvsmith@users.noreply.github.com>
Date:   Mon Mar 25 19:59:14 2024 -0400

    gh-109870: Dataclasses: batch up exec calls (gh-110851)

    Instead of calling `exec()` once for each function added to a dataclass, only call `exec()` once per dataclass. This can lead to speed improvements of up to 20%.

commit 7ebad77ad65ab4d5d8d0c333256a882262cec189
Author: Raymond Hettinger <rhettinger@users.noreply.github.com>
Date:   Mon Mar 25 18:49:44 2024 -0500

    Sync main docs and docstring for median_grouped(). (gh-117214)

commit 0821923aa979a72464c5da8dfa53a719bba5801c
Author: Nice Zombies <nineteendo19d0@gmail.com>
Date:   Mon Mar 25 23:55:11 2024 +0100

    gh-117114: Make os.path.isdevdrive available on all platforms (GH-117115)

commit c2276176d543a2fc2d57709c2787f99850fbb073
Author: Adorilson Bezerra <adorilson@gmail.com>
Date:   Mon Mar 25 22:34:20 2024 +0000

    Add information about negative  indexes to sequence datamodel doc (#110903)

    Co-authored by Terry Jan Reedy

commit 23e4f80ce2a2bac50acd1785e791316d5b578b8d
Author: Mark Shannon <mark@hotpy.org>
Date:   Mon Mar 25 20:43:51 2024 +0000

    A few minor tweaks to get stats working and compiling cleanly. (#117219)

    Fixes a compilation error when configured with `--enable-pystats`,
    an array size issue, and an unused variable.

commit 507896d97dcff2d7999efa264b29d9003c525c49
Author: Victor Stinner <vstinner@python.org>
Date:   Mon Mar 25 17:32:20 2024 +0100

    gh-116936: Add PyType_GetModuleByDef() to the limited C API (#116937)

commit 0c1a42cf9c8cd0d4534d5c1d58f118ce7c5c446e
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Mon Mar 25 17:32:11 2024 +0200

    gh-87193: Support bytes objects with refcount > 1 in _PyBytes_Resize() (GH-117160)

    Create a new bytes object and destroy the old one if it has refcount > 1.

commit 01e7405da400e8997f8964d06cc414045e144681
Author: Tian Gao <gaogaotiantian@hotmail.com>
Date:   Mon Mar 25 08:18:09 2024 -0700

    gh-112948: Make pdb completion similar to repl completion (#112950)

commit 9db2a8f914ad59019d448cecc43b6d45f46424a0
Author: Raymond Hettinger <rhettinger@users.noreply.github.com>
Date:   Mon Mar 25 09:26:42 2024 -0500

    Minor markup and grammar fixes in the statistics docs (gh-117216)

commit eebea7e515462b503632ada74923ec3246599c9c
Author: Kirill Podoprigora <kirill.bast9@mail.ru>
Date:   Sun Mar 24 20:34:55 2024 +0200

    gh-117176: Fix compiler warning in Python/optimizer_bytecodes.c (GH-117199)

commit 83485a095363dad6c97b19af2826ca0c34343bfc
Author: Totally a booplicate <53382877+Booplicate@users.noreply.github.com>
Date:   Sun Mar 24 18:48:40 2024 +0300

    gh-112571: Move fish venv activation script into the common folder (GH-117169)

    pythongh-112571: allow using fish venv activation script on windows

    The fish shell can be used on windows under cygwin or msys2.
    This change moves the script to the common folder
    so the venv module will install it on both posix and nt systems (like the bash script).

commit 78a651fd7fbe7a3d1702e40f4cbfa72d87241ef0
Author: Terry Jan Reedy <tjreedy@udel.edu>
Date:   Sun Mar 24 11:38:34 2024 -0400

    gh-117194: Properly format 'base64' header in What's New (#117198)

    It needs 6, not 3, '-'s.

commit f267d5bf2a99fbeb26a720d1c87c1f0557424b14
Author: Kerim Kabirov <the.privat33r+gh@pm.me>
Date:   Sun Mar 24 14:59:14 2024 +0100

    GH-115986 Docs: promote pprint.pp usage as a default (#116614)

    Co-authored-by: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>

commit 39df7732178c8e8f75b12f069a3dbc1715c99995
Author: LilKS <1244886+LilKS@users.noreply.github.com>
Date:   Sun Mar 24 11:01:07 2024 +0100

    gh-101760: Improve the imaplib.IMAP4 example (#101764)

    Co-authored-by: Adam Turner <9087854+AA-Turner@users.noreply.github.com>

commit a1e948edba9ec6ba61365429857f7a087c5edf51
Author: Raymond Hettinger <rhettinger@users.noreply.github.com>
Date:   Sun Mar 24 11:35:58 2024 +0200

    Add cumulative option for the new statistics.kde() function. (#117033)

commit d610d821fd210dce63a1132c274ffdf8acc510bc
Author: Irit Katriel <1055913+iritkatriel@users.noreply.github.com>
Date:   Sat Mar 23 22:32:33 2024 +0000

    gh-112383: teach dis how to interpret ENTER_EXECUTOR (#117171)

commit 6c83352bfe78a7d567c8d76257df6eb91d5a7245
Author: Ken Jin <kenjin@python.org>
Date:   Sun Mar 24 06:19:17 2024 +0800

    gh-117180: Complete call sequence when trace stack overflow (GH-117184)

    ---------

    Co-authored-by: Peter Lazorchak <lazorchakp@gmail.com>
    Co-authored-by: Guido van Rossum <gvanrossum@users.noreply.github.com>
    Co-authored-by: Guido van Rossum <gvanrossum@gmail.com>

commit f11d0d8be8af28e1368c3c7c116218cf65ddf93e
Author: Erik Soma <stillusingirc@gmail.com>
Date:   Sat Mar 23 11:39:35 2024 -0400

    gh-91227: Ignore ERROR_PORT_UNREACHABLE in proactor recvfrom() (#32011)

commit 9967b568edd2e35b0415c14c7242f3ca2c0dc03d
Author: Victor Stinner <vstinner@python.org>
Date:   Sat Mar 23 13:01:20 2024 +0100

    gh-117008: Fix functools test_recursive_pickle() (#117009)

    Use support.infinite_recursion() in test_recursive_pickle() of
    test_functools to prevent a stack overflow on "ARM64 Windows
    Non-Debug" buildbot.

    Lower Py_C_RECURSION_LIMIT to 1,000 frames on Windows ARM64.

commit 72eea512b88f8fd68b7258242c37da963ad87360
Author: Barney Gale <barney.gale@gmail.com>
Date:   Fri Mar 22 19:14:09 2024 +0000

    GH-106747: Document another difference between `glob` and `pathlib`. (#116518)

    Document that `path.glob()` might return *path*, whereas
    `glob.glob(root_dir=path)` will never return an empty string corresponding
    to *path*.

commit e28477f214276db941e715eebc8cdfb96c1207d9
Author: Mark Shannon <mark@hotpy.org>
Date:   Fri Mar 22 18:43:25 2024 +0000

    GH-117108: Change the size of the GC increment to about 1% of the total heap size. (GH-117120)

commit e2e0b4b4b92694ba894e02b4a66fd87c166ed10f
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Fri Mar 22 20:19:10 2024 +0200

    gh-113024: C API: Add PyObject_GenericHash() function (GH-113025)

commit 567ab3bd15398c8c7b791f3e376ae3e3c0bbe079
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Fri Mar 22 20:08:00 2024 +0200

    gh-117084: Fix ZIP file extraction for directory entry names with backslashes on Windows (GH-117129)

commit 5a78f6e798d5c2af1dba2df6c9f1f1e5aac02a86
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Fri Mar 22 20:03:48 2024 +0200

    gh-117134: Microoptimize glob() for include_hidden=True (GH-117135)

commit 00baaa21de229a6db80ff2b84c2fd6ad1999a24c
Author: Vinay Sajip <vinay_sajip@yahoo.co.uk>
Date:   Fri Mar 22 17:25:51 2024 +0000

    [docs] Fix typo in docstring and add example to logging cookbook. (GH-117157)

commit 40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f
Author: Jakub Stasiak <jakub@stasiak.at>
Date:   Fri Mar 22 17:49:56 2024 +0100

    GH-113171: Fix "private" (non-global) IP address ranges (GH-113179)

    * GH-113171: Fix "private" (really non-global) IP address ranges

    The _private_networks variables, used by various is_private
    implementations, were missing some ranges and at the same time had
    overly strict ranges (where there are more specific ranges considered
    globally reachable by the IANA registries).

    This patch updates the ranges with what was missing or otherwise
    incorrect.

    I left 100.64.0.0/10 alone, for now, as it's been made special in [1]
    and I'm not sure if we want to undo that as I don't quite understand the
    motivation behind it.

    The _address_exclude_many() call returns 8 networks for IPv4, 121
    networks for IPv6.

    [1] https://github.com/python/cpython/issues/61602

commit 3be9b9d8722696b95555937bb211dc4cda714d56
Author: Steve Dower <steve.dower@python.org>
Date:   Fri Mar 22 15:00:50 2024 +0000

    Fix get_packagefamilyname helper function on Windows 32-bit (GH-117153)

commit 63d6f2623ef2aa90f51c6a928b96845b9b380d89
Author: NGRsoftlab <78017794+NGRsoftlab@users.noreply.github.com>
Date:   Fri Mar 22 14:25:38 2024 +0300

    gh-117068: Remove useless code in bytesio.c:resize_buffer() (GH-117069)

    Co-authored-by: i.khabibulin <i.khabibulin@ngrsoftlab.ru>

commit 42ae924d278c48a719fb0ab86357f3235a9f7ab9
Author: Petr Viktorin <encukou@gmail.com>
Date:   Fri Mar 22 10:42:18 2024 +0100

    gh-117127: glob tests: Reopen dir_fd to pick up directory changes (GH-117128)

commit 8383915031942f441f435a5ae800790116047b80
Author: Tim Peters <tim.peters@gmail.com>
Date:   Thu Mar 21 22:27:25 2024 -0500

    GH-116939: Rewrite binarysort() (#116940)

    Rewrote binarysort() for clarity.

    Also changed the signature to be more coherent (it was mixing sortslice with raw pointers).

    No change in method or functionality. However, I left some experiments in, disabled for now
    via `#if` tricks. Since this code was first written, some kinds of comparisons have gotten
    enormously faster (like for lists of floats), which changes the tradeoffs.

    For example, plain insertion sort's simpler innermost loop and highly predictable branches
    leave it very competitive (even beating, by a bit) binary insertion when comparisons are
    very cheap, despite that it can do many more compares. And it wins big on runs that
    are already sorted (moving the next one in takes only 1 compare then).

    So I left code for a plain insertion sort, to make future experimenting easier.

    Also made the maximum value of minrun a `#define` (``MAX_MINRUN`) to make
    experimenting with that easier too.

    And another bit of `#if``-disabled code rewrites binary insertion's innermost loop to
    remove its unpredictable branch. Surprisingly, this doesn't really seem to help
    overall. I'm unclear on why not. It certainly adds more instructions, but they're very
    simple, and it's hard to be believe they cost as much as a branch miss.

commit 97ba910e47ad298114800587979ce7beb0a705a3
Author: Guido van Rossum <guido@python.org>
Date:   Thu Mar 21 18:27:48 2024 -0700

    gh-108716:: Remove _PyStaticCode_Init/Fini (#117141)

    More deepfreeze cleanup.

commit b3d25df8d38b79310587da54dbd88b06a16d4904
Author: Eric Snow <ericsnowcurrently@gmail.com>
Date:   Thu Mar 21 18:20:20 2024 -0600

    gh-105716: Fix _PyInterpreterState_IsRunningMain() For Embedders (gh-117140)

    When I added _PyInterpreterState_IsRunningMain() and friends last year, I tried to accommodate applications that embed Python but don't call _PyInterpreterState_SetRunningMain() (not that they're expected to).  That mostly worked fine until my recent changes in gh-117049, where the subtleties with the fallback code led to failures; the change ended up breaking test_tools.test_freeze, which exercises a basic embedding situation.

    The simplest fix is to drop the fallback code I originally added to _PyInterpreterState_IsRunningMain() (and later to _PyThreadState_IsRunningMain()).  I've kept the fallback in the _xxsubinterpreters module though.  I've also updated Py_FrozenMain() to call _PyInterpreterState_SetRunningMain().

commit c4bf58a14f162557038a1535ca22c52b49d81d7b
Author: Thomas A Caswell <tcaswell@gmail.com>
Date:   Thu Mar 21 19:54:50 2024 -0400

    gh-116745: Remove all internal usage of @LIBPYTHON@ (#116746)

    Replace with MODULE_LDFLAGS.

commit 3ec57307e70ee6f42410e844d3399bbd598917ba
Author: Malcolm Smith <smith@chaquo.com>
Date:   Thu Mar 21 23:52:29 2024 +0000

    gh-71052: Add Android build script and instructions (#116426)

commit 50f9b0b1e0fb181875751cef951351ed007b6397
Author: Victor Stinner <vstinner@python.org>
Date:   Thu Mar 21 23:17:09 2024 +0100

    gh-117061: Fix test_posix.test_sched_setaffinity() on RHEL9 (#117126)

    On RHEL9, sched_setaffinity(0, []) does not fail.

commit 0907871d43bffb613cbd560224e1a9db13d06c06
Author: Ned Batchelder <ned@nedbatchelder.com>
Date:   Thu Mar 21 15:47:09 2024 -0400

    docs: fix over-linking in dataclasses.rst (#117005)

commit 570a82d46abfebb9976961113fb0f8bb400ad182
Author: Guido van Rossum <guido@python.org>
Date:   Thu Mar 21 12:37:41 2024 -0700

    gh-117045: Add code object to function version cache (#117028)

    Changes to the function version cache:

    - In addition to the function object, also store the code object,
      and allow the latter to be retrieved even if the function has been evicted.
    - Stop assigning new function versions after a critical attribute (e.g. `__code__`)
      has been modified; the version is permanently reset to zero in this case.
    - Changes to `__annotations__` are no longer considered critical. (This fixes gh-109998.)

    Changes to the Tier 2 optimization machinery:

    - If we cannot map a function version to a function, but it is still mapped to a code object,
      we continue projecting the trace.
      The operand of the `_PUSH_FRAME` and `_POP_FRAME` opcodes can be either NULL,
      a function object, or a code object with the lowest bit set.

    This allows us to trace through code that calls an ephemeral function,
    i.e., a function that may not be alive when we are constructing the executor,
    e.g. a generator expression or certain nested functions.
    We will lose globals removal inside such functions,
    but we can still do other peephole operations
    (and even possibly [call inlining](https://github.com/python/cpython/pull/116290),
    if we decide to do it), which only need the code object.
    As before, if we cannot retrieve the code object from the cache, we stop projecting.

commit c85d84166a84a5cb2d724012726bad34229ad24e
Author: Will Childs-Klein <willck93@gmail.com>
Date:   Thu Mar 21 14:16:36 2024 -0500

    gh-116333: Relax error string text expectations in SSL-related tests (GH-116334)

    * Relax error string text expectations in SSL-related tests

    As suggested [here][1], this change relaxes the OpenSSL error string
    text expectations in a number of tests. This was specifically done in
    support of more easily building CPython [AWS-LC][2], but because AWS-LC
    is a fork of [BoringSSL][3], it should increase compatibility with that
    library as well.

    In addition to the error string relaxations, we also add some guards
    around the `tls-unique` channel binding being used with TLSv1.3, as that
    feature (described in [RFC 6929][4]) is [not defined][5] for TLSv1.3.

    [1]: https://discuss.python.org/t/support-building-ssl-and-hashlib-modules-against-aws-lc/44505/4
    [2]: https://github.com/aws/aws-lc
    [3]: https://github.com/google/boringssl
    [4]: https://datatracker.ietf.org/doc/html/rfc5929#section-3
    [5]: https://datatracker.ietf.org/doc/html/rfc8446#appendix-C.5

commit 1f72fb5447ef3f8892b4a7a6213522579c618e8e
Author: Sam Gross <colesbury@gmail.com>
Date:   Thu Mar 21 14:21:02 2024 -0400

    gh-116522: Refactor `_PyThreadState_DeleteExcept` (#117131)

    Split `_PyThreadState_DeleteExcept` into two functions:

    - `_PyThreadState_RemoveExcept` removes all thread states other than one
      passed as an argument. It returns the removed thread states as a
      linked list.

    - `_PyThreadState_DeleteList` deletes those dead thread states. It may
      call destructors, so we want to "start the world" before calling
      `_PyThreadState_DeleteList` to avoid potential deadlocks.

commit 50369e6c34d05222e5a0ec9443a9f7b230e83112
Author: Michael Droettboom <mdboom@gmail.com>
Date:   Thu Mar 21 13:27:46 2024 -0400

    gh-116996: Add pystats about _Py_uop_analyse_and_optimize (GH-116997)

commit 617158e07811edfd6fd552a3d84b0beedd8f1d18
Author: Eric Snow <ericsnowcurrently@gmail.com>
Date:   Thu Mar 21 11:15:02 2024 -0600

    gh-76785: Drop PyInterpreterID_Type (gh-117101)

    I added it quite a while ago as a strategy for managing interpreter lifetimes relative to the PEP 554 (now 734) implementation.  Relatively recently I refactored that implementation to no longer rely on InterpreterID objects.  Thus now I'm removing it.

commit abdd1f938f08e536864532b2071f144515ecc88b
Author: Victor Stinner <vstinner@python.org>
Date:   Thu Mar 21 17:45:43 2024 +0100

    gh-85283: Build _testconsole extension with limited C API (#117125)

commit 8bea6c411d65cd987616b4ecdb86373e4f21f1c6
Author: Victor Stinner <vstinner@python.org>
Date:   Thu Mar 21 17:07:00 2024 +0100

    gh-115754: Add Py_GetConstant() function (#116883)

    Add Py_GetConstant() and Py_GetConstantBorrowed() functions.

    In the limited C API version 3.13, getting Py_None, Py_False,
    Py_True, Py_Ellipsis and Py_NotImplemented singletons is now
    implemented as function calls at the stable ABI level to hide
    implementation details. Getting these constants still return borrowed
    references.

    Add _testlimitedcapi/object.c and test_capi/test_object.py to test
    Py_GetConstant() and Py_GetConstantBorrowed() functions.

commit 5a76d1be8ef371b75ca65166726923c249b5f615
Author: Eric Snow <ericsnowcurrently@gmail.com>
Date:   Thu Mar 21 10:06:35 2024 -0600

    gh-105716: Update interp->threads.main After Fork (gh-117049)

    I missed this in gh-109921.

    We also update Py_Exit() to call _PyInterpreterState_SetNotRunningMain(), if necessary.

commit bbee57fa8c318cb26d6c8651254927a1972c9738
Author: Eric Snow <ericsnowcurrently@gmail.com>
Date:   Thu Mar 21 09:56:12 2024 -0600

    gh-76785: Clean Up Interpreter ID Conversions (gh-117048)

    Mostly we unify the two different implementations of the conversion code (from PyObject * to int64_t.  We also drop the PyArg_ParseTuple()-style converter function, as well as rename and move PyInterpreterID_LookUp().

commit e728303532168efab7694c55c82ea19b18bf8385
Author: Sam Gross <colesbury@gmail.com>
Date:   Thu Mar 21 10:01:16 2024 -0400

    gh-116522: Stop the world before fork() and during shutdown (#116607)

    This changes the free-threaded build to perform a stop-the-world pause
    before deleting other thread states when forking and during shutdown.
    This fixes some crashes when using multiprocessing and during shutdown
    when running with `PYTHON_GIL=0`.

    This also changes `PyOS_BeforeFork` to acquire the runtime lock
    (i.e., `HEAD_LOCK(&_PyRuntime)`) before forking to ensure that data
    protected by the runtime lock (and not just the GIL or stop-the-world)
    is in a consistent state before forking.

commit 1f8b24ef69896680d6ba6005e75e1cc79a744f9e
Author: Malcolm Smith <smith@chaquo.com>
Date:   Thu Mar 21 13:20:57 2024 +0000

    gh-71052: Implement `ctypes.util.find_library` on Android (GH-116379)

commit d16c9d1278164f04778861814ebc87ed087511fc
Author: Tian Gao <gaogaotiantian@hotmail.com>
Date:   Thu Mar 21 03:30:10 2024 -0700

    gh-116987: Support class code objects in inspect.findsource() (GH-117025)

commit 6547330f4e896c6748da23704b617e060e6cc68e
Author: Adam Turner <9087854+AA-Turner@users.noreply.github.com>
Date:   Thu Mar 21 03:49:10 2024 +0000

    GH-109653: Defer import of ``importlib.metadata._adapters`` (#109829)

    * adapters

    * Add comments for deferred imports with links to rationale.

    * Add blurb

    ---------

    Co-authored-by: Jason R. Coombs <jaraco@jaraco.com>

commit 667294d5b2ee812ebe0c9c1efd58e2006b61f827
Author: Jason R. Coombs <jaraco@jaraco.com>
Date:   Wed Mar 20 23:01:24 2024 -0400

    gh-117089: Apply changes from importlib_metadata 7.1.0 (#117094)

    * Apply changes from importlib_metadata 7.1.0

    * Include the data sources in the makefile (even though they're not needed)

commit f4cc77d494ee0e10ed84ce369f0910c70a2f6d44
Author: Victor Stinner <vstinner@python.org>
Date:   Thu Mar 21 00:06:24 2024 +0100

    gh-116869: Enable -Werror in test_cext for Free Threading (#117106)

    Check for warnings, but don't enable the compiler flag
    -Werror=declaration-after-statement.

commit 104602a6078564765b7b8f42888f8eaa37b129b1
Author: Victor Stinner <vstinner@python.org>
Date:   Wed Mar 20 23:52:23 2024 +0100

    gh-105927: Limit PyWeakref_GetRef() to limited C API 3.13 (#117091)

commit 8ad88984200b2ccddc0a08229dd2f4c14d1a71fc
Author: Jason R. Coombs <jaraco@jaraco.com>
Date:   Wed Mar 20 17:11:00 2024 -0400

    gh-117089: Move importlib.metadata tests to their own package (#117092)

    * Ensure importlib.metadata tests do not leak references in sys.modules.

    * Move importlib.metadata tests to their own package for easier syncing with importlib_metadata.

    * Update owners and makefile for new directories.

    * Add blurb

commit 7d446548ef53f6c3de1097c6d44cada6642ddc85
Author: Carol Willing <carolcode@willingconsulting.com>
Date:   Wed Mar 20 14:00:59 2024 -0700

    Fix sort order for "locale encoding" glossary item (#115794)

    Co-authored-by: C.A.M. Gerlach <CAM.Gerlach@Gerlach.CAM>

commit 63289b9dfbc7d87e81f1517422ee91b6b6d19531
Author: Mark Shannon <mark@hotpy.org>
Date:   Wed Mar 20 18:24:02 2024 +0000

    GH-117066: Tier 2 optimizer: Don't throw away good traces if we can't optimize them perfectly. (GH-117067)

commit dcaf33a41d5d220523d71c9b35bc08f5b8405dac
Author: Petr Viktorin <encukou@gmail.com>
Date:   Wed Mar 20 17:33:08 2024 +0100

    gh-114314: ctypes: remove stgdict and switch to heap types (GH-116458)

    Before this change, ctypes classes used a custom dict subclass, `StgDict`,
    as their `tp_dict`. This acts like a regular dict but also includes extra information
    about the type.

    This replaces stgdict by `StgInfo`, a C struct on the type, accessed by
    `PyObject_GetTypeData()` (PEP-697).
    All usage of `StgDict` (mainly variables named `stgdict`, `dict`, `edict` etc.) is
    converted to `StgInfo` (named `stginfo`, `info`, `einfo`, etc.).
    Where the dict is actually used for class attributes (as a regular PyDict), it's now
    called `attrdict`.

    This change -- not overriding `tp_dict` -- is made to make me comfortable with
    the next part of this PR: moving the initialization logic from `tp_new` to `tp_init`.

    The `StgInfo` is set up in `__init__` of each class, with a guard that prevents
    calling `__init__` more than once. Note that abstract classes (like `Array` or
    `Structure`) are created using `PyType_FromMetaclass` and do not have
    `__init__` called.
    Previously, this was done in `__new__`, which also wasn't called for abstract
    classes.
    Since `__init__` can be called from Python code or skipped, there is a tested
    guard to ensure `StgInfo` is initialized exactly once before it's used.

    Co-authored-by: neonene <53406459+neonene@users.noreply.github.com>
    Co-authored-by: Erlend E. Aasland <erlend.aasland@protonmail.com>

commit 44fbab43d8f3f2df07091d237824cf4fa1f6c57c
Author: Russell Keith-Magee <russell@keith-magee.com>
Date:   Wed Mar 20 23:32:56 2024 +0800

    gh-117058: Update GUI and packaging recommendations for macOS. (#117059)

commit 9221ef2d8cb7f4cf37592eb650d4c8f972033000
Author: Brett Simmers <swtaarrs@users.noreply.github.com>
Date:   Wed Mar 20 08:18:26 2024 -0700

    gh-116908: Only write to `_pending_calls.calls_to_do` with atomic operations (#117044)

    These writes to `pending->calls_to_do` need to be atomic, because other threads
    can read (atomically) from `calls_to_do` without holding `pending->mutex`.

commit fc4599800778f9b130d5e336deadbdeb5bd3e5ee
Author: jkriegshauser <jkriegshauser@gmail.com>
Date:   Wed Mar 20 07:33:28 2024 -0700

    gh-116773: Ensure overlapped objects on Windows are not deallocated too early by asyncio (GH-116774)

commit 519b2ae22b54760475bbf62b9558d453c703f9c6
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Wed Mar 20 15:39:53 2024 +0200

    gh-117021: Fix integer overflow in PyLong_AsPid() on non-Windows 64-bit platforms (GH-117064)
```

[diegorusso](/diegorusso)
pushed a commit
to diegorusso/cpython
that referenced
this issue
[Apr 17, 2024](#ref-commit-c08ada7)
[![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak) [![@diegorusso](https://avatars.githubusercontent.com/u/342108?s=40&v=4)](/diegorusso)

`[pythonGH-113171](https://github.com/python/cpython/issues/113171)[: Fix "private" (non-global) IP address ranges (](/diegorusso/cpython/commit/c08ada70ffdded9f68ab7366d081c1803548872d "GH-113171: Fix \"private\" (non-global) IP address ranges (GH-113179)

* GH-113171: Fix \"private\" (really non-global) IP address ranges

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

I left 100.64.0.0/10 alone, for now, as it's been made special in [1]
and I'm not sure if we want to undo that as I don't quite understand the
motivation behind it.

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602")[python…](https://github.com/python/cpython/pull/113179)`
…

`[c08ada7](/diegorusso/cpython/commit/c08ada70ffdded9f68ab7366d081c1803548872d)`

```
[…GH-113179](https://github.com/python/cpython/pull/113179))

* [pythonGH-113171](https://github.com/python/cpython/issues/113171): Fix "private" (really non-global) IP address ranges

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

I left 100.64.0.0/10 alone, for now, as it's been made special in [1]
and I'm not sure if we want to undo that as I don't quite understand the
motivation behind it.

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] [python#61602](https://github.com/python/cpython/issues/61602)
```

[![@gpshead](https://avatars.githubusercontent.com/u/68491?s=40&v=4)](/gpshead)
[gpshead](/gpshead)
assigned [encukou](/encukou)
[Apr 22, 2024](#event-12563199621)

[![@gpshead](https://avatars.githubusercontent.com/u/68491?s=40&v=4)](/gpshead)
[gpshead](/gpshead)
added
the
[type-security](/python/cpython/labels/type-security)
A security issue
label
[Apr 22, 2024](#event-12563200974)

[![@gpshead](https://avatars.githubusercontent.com/u/68491?s=80&v=4)](/gpshead)

Copy link

Member

### **[gpshead](/gpshead)** commented [Apr 22, 2024](#issuecomment-2070280424)

| Per a PSRT discussion, lets backport this as a security fix [@encukou](https://github.com/encukou). ([@sethmlarson](https://github.com/sethmlarson) & [@ambv](https://github.com/ambv) who were in that conversation FYI) |
| --- |

 👍
2
 sethmlarson and encukou reacted with thumbs up emoji

All reactions

* 👍
  2 reactions

Sorry, something went wrong.

[encukou](/encukou)
pushed a commit
to encukou/cpython
that referenced
this issue
[Apr 23, 2024](#ref-commit-a74a45b)
[![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak) [![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&v=4)](/encukou)

`[[3.12]](/encukou/cpython/commit/a74a45b36b790954af39a3b5a8de766879d778e8 "[3.12] GH-113171: Fix \"private\" (non-global) IP address ranges (GH-113179)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

I left 100.64.0.0/10 alone, for now, as it's been made special in [1]
and I'm not sure if we want to undo that as I don't quite understand the
motivation behind it.

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

(cherry picked from commit 40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f)") [pythonGH-113171](https://github.com/python/cpython/issues/113171)[: Fix "private" (non-global) IP address ranges (](/encukou/cpython/commit/a74a45b36b790954af39a3b5a8de766879d778e8 "[3.12] GH-113171: Fix \"private\" (non-global) IP address ranges (GH-113179)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

I left 100.64.0.0/10 alone, for now, as it's been made special in [1]
and I'm not sure if we want to undo that as I don't quite understand the
motivation behind it.

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

(cherry picked from commit 40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f)")[p…](https://github.com/python/cpython/pull/113179)`
…

`[a74a45b](/encukou/cpython/commit/a74a45b36b790954af39a3b5a8de766879d778e8)`

```
[…ythonGH-113179](https://github.com/python/cpython/pull/113179))

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

I left 100.64.0.0/10 alone, for now, as it's been made special in [1]
and I'm not sure if we want to undo that as I don't quite understand the
motivation behind it.

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] [python#61602](https://github.com/python/cpython/issues/61602)

(cherry picked from commit [40d75c2](https://github.com/encukou/cpython/commit/40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f))
```

[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou)
[encukou](/encukou)
mentioned this issue
[Apr 23, 2024](#ref-pullrequest-2258711236)

[[3.12] gh-113171: gh-65056: Fix "private" (non-global) IP address ranges (GH-113179) (GH-113186)
#118177](/python/cpython/pull/118177)
 Merged

[![@encukou](https://avatars.githubusercontent.com/u/302922?s=80&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou)

Copy link

Member

### **[encukou](/encukou)** commented [Apr 23, 2024](#issuecomment-2072151045)

| OK. I assume docs fixes from [GH-113186](https://github.com/python/cpython/pull/113186) should be backported as well. |
| --- |

 👍
1
 gpshead reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@gpshead](https://avatars.githubusercontent.com/u/68491?s=80&v=4)](/gpshead)

Copy link

Member

### **[gpshead](/gpshead)** commented [Apr 23, 2024](#issuecomment-2072855518)

| I assume docs fixes from [GH-113186](https://github.com/python/cpython/pull/113186) should be backported as well.  agreed, that makes sense. |
| --- |

 👍
1
 sethmlarson reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[encukou](/encukou)
added a commit
that referenced
this issue
[Apr 24, 2024](#ref-commit-f86b17a)
[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou) [![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak)

`[[3.12]](/python/cpython/commit/f86b17ac511e68192ba71f27e752321a3252cee3 "[3.12] gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177)

* GH-113171: Fix \"private\" (non-global) IP address ranges (GH-113179)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

* GH-65056: Improve the IP address' is_global/is_private documentation (GH-113186)

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit 2a4cbf17af19a01d942f9579342f77c39fbd23c4)
(cherry picked from commit 40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f)

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>") [gh-113171](https://github.com/python/cpython/issues/113171)[:](/python/cpython/commit/f86b17ac511e68192ba71f27e752321a3252cee3 "[3.12] gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177)

* GH-113171: Fix \"private\" (non-global) IP address ranges (GH-113179)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

* GH-65056: Improve the IP address' is_global/is_private documentation (GH-113186)

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit 2a4cbf17af19a01d942f9579342f77c39fbd23c4)
(cherry picked from commit 40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f)

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>") [gh-65056](https://github.com/python/cpython/issues/65056)[: Fix "private" (non-global) IP address ran…](/python/cpython/commit/f86b17ac511e68192ba71f27e752321a3252cee3 "[3.12] gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177)

* GH-113171: Fix \"private\" (non-global) IP address ranges (GH-113179)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

* GH-65056: Improve the IP address' is_global/is_private documentation (GH-113186)

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit 2a4cbf17af19a01d942f9579342f77c39fbd23c4)
(cherry picked from commit 40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f)

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>")`
…

`[f86b17a](/python/cpython/commit/f86b17ac511e68192ba71f27e752321a3252cee3)`

```
…ges ([GH-113179](https://github.com/python/cpython/pull/113179)) ([GH-113186](https://github.com/python/cpython/pull/113186)) ([GH-118177](https://github.com/python/cpython/pull/118177))

* [GH-113171](https://github.com/python/cpython/issues/113171): Fix "private" (non-global) IP address ranges ([GH-113179](https://github.com/python/cpython/pull/113179))

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] [#61602](https://github.com/python/cpython/issues/61602)

* [GH-65056](https://github.com/python/cpython/issues/65056): Improve the IP address' is_global/is_private documentation ([GH-113186](https://github.com/python/cpython/pull/113186))

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit [2a4cbf1](https://github.com/python/cpython/commit/2a4cbf17af19a01d942f9579342f77c39fbd23c4))
(cherry picked from commit [40d75c2](https://github.com/python/cpython/commit/40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f))

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
```

[encukou](/encukou)
added a commit
to encukou/cpython
that referenced
this issue
[Apr 24, 2024](#ref-commit-b47c766)
[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou) [![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak)

`[pythongh-113171](https://github.com/python/cpython/issues/113171)[:](/encukou/cpython/commit/b47c766d6085d7918edd7715750d135868fdafd6 "gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177)

* GH-113171: Fix \"private\" (non-global) IP address ranges (GH-113179)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

* GH-65056: Improve the IP address' is_global/is_private documentation (GH-113186)

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit 2a4cbf17af19a01d942f9579342f77c39fbd23c4)
(cherry picked from commit 40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f)

---------

(cherry picked from commit f86b17ac511e68192ba71f27e752321a3252cee3)

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>") [pythongh-65056](https://github.com/python/cpython/issues/65056)[: Fix "private" (non-global) IP addres…](/encukou/cpython/commit/b47c766d6085d7918edd7715750d135868fdafd6 "gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177)

* GH-113171: Fix \"private\" (non-global) IP address ranges (GH-113179)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

* GH-65056: Improve the IP address' is_global/is_private documentation (GH-113186)

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit 2a4cbf17af19a01d942f9579342f77c39fbd23c4)
(cherry picked from commit 40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f)

---------

(cherry picked from commit f86b17ac511e68192ba71f27e752321a3252cee3)

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>")`
…

`[b47c766](/encukou/cpython/commit/b47c766d6085d7918edd7715750d135868fdafd6)`

```
…s ranges ([pythonGH-113179](https://github.com/python/cpython/pull/113179)) ([pythonGH-113186](https://github.com/python/cpython/pull/113186)) ([pythonGH-118177](https://github.com/python/cpython/pull/118177))

* [pythonGH-113171](https://github.com/python/cpython/issues/113171): Fix "private" (non-global) IP address ranges ([pythonGH-113179](https://github.com/python/cpython/pull/113179))

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] [python#61602](https://github.com/python/cpython/issues/61602)

* [pythonGH-65056](https://github.com/python/cpython/issues/65056): Improve the IP address' is_global/is_private documentation ([pythonGH-113186](https://github.com/python/cpython/pull/113186))

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit [2a4cbf1](https://github.com/encukou/cpython/commit/2a4cbf17af19a01d942f9579342f77c39fbd23c4))
(cherry picked from commit [40d75c2](https://github.com/encukou/cpython/commit/40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f))

---------

(cherry picked from commit [f86b17a](https://github.com/encukou/cpython/commit/f86b17ac511e68192ba71f27e752321a3252cee3))

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
```

[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou)
[encukou](/encukou)
mentioned this issue
[Apr 24, 2024](#ref-pullrequest-2261276804)

[[3.11] gh-113171: gh-65056: Fix "private" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177)
#118227](/python/cpython/pull/118227)
 Merged

[encukou](/encukou)
added a commit
to encukou/cpython
that referenced
this issue
[Apr 24, 2024](#ref-commit-0740166)
[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou) [![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak)

`[pythongh-113171](https://github.com/python/cpython/issues/113171)[:](/encukou/cpython/commit/0740166e60b8cdae9448220beb28721f0126ee03 "gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177)

* GH-113171: Fix \"private\" (non-global) IP address ranges (GH-113179)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

* GH-65056: Improve the IP address' is_global/is_private documentation (GH-113186)

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit 2a4cbf17af19a01d942f9579342f77c39fbd23c4)
(cherry picked from commit 40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f)

---------

(cherry picked from commit f86b17ac511e68192ba71f27e752321a3252cee3)

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>") [pythongh-65056](https://github.com/python/cpython/issues/65056)[: Fix "private" (non-global) IP addres…](/encukou/cpython/commit/0740166e60b8cdae9448220beb28721f0126ee03 "gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177)

* GH-113171: Fix \"private\" (non-global) IP address ranges (GH-113179)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

* GH-65056: Improve the IP address' is_global/is_private documentation (GH-113186)

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit 2a4cbf17af19a01d942f9579342f77c39fbd23c4)
(cherry picked from commit 40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f)

---------

(cherry picked from commit f86b17ac511e68192ba71f27e752321a3252cee3)

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>")`
…

`[0740166](/encukou/cpython/commit/0740166e60b8cdae9448220beb28721f0126ee03)`

```
…s ranges ([pythonGH-113179](https://github.com/python/cpython/pull/113179)) ([pythonGH-113186](https://github.com/python/cpython/pull/113186)) ([pythonGH-118177](https://github.com/python/cpython/pull/118177))

* [pythonGH-113171](https://github.com/python/cpython/issues/113171): Fix "private" (non-global) IP address ranges ([pythonGH-113179](https://github.com/python/cpython/pull/113179))

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] [python#61602](https://github.com/python/cpython/issues/61602)

* [pythonGH-65056](https://github.com/python/cpython/issues/65056): Improve the IP address' is_global/is_private documentation ([pythonGH-113186](https://github.com/python/cpython/pull/113186))

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit [2a4cbf1](https://github.com/encukou/cpython/commit/2a4cbf17af19a01d942f9579342f77c39fbd23c4))
(cherry picked from commit [40d75c2](https://github.com/encukou/cpython/commit/40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f))

---------

(cherry picked from commit [f86b17a](https://github.com/encukou/cpython/commit/f86b17ac511e68192ba71f27e752321a3252cee3))

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
```

[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou)
[encukou](/encukou)
mentioned this issue
[Apr 24, 2024](#ref-pullrequest-2261310382)

[[3.10] gh-113171: gh-65056: Fix "private" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177)
#118229](/python/cpython/pull/118229)
 Merged

[![@encukou](https://avatars.githubusercontent.com/u/302922?s=80&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou)

Copy link

Member

### **[encukou](/encukou)** commented [Apr 24, 2024](#issuecomment-2074973785)

| I don't quite understand security aspect here, so I'd appreciate if someone from the PSRT checked this part of the 3.10 backport: [554b28c](https://github.com/python/cpython/commit/554b28c1df7da88e46b9b72d6d2c4a309f04cb5e) |
| --- |

All reactions

Sorry, something went wrong.

[![@sethmlarson](https://avatars.githubusercontent.com/u/18519037?s=80&u=41090cc65ae0a34aee49c7a35cfbd40e2e12eb53&v=4)](/sethmlarson)

Copy link

Contributor

### **[sethmlarson](/sethmlarson)** commented [Apr 24, 2024](#issuecomment-2075660714)

| [@encukou](https://github.com/encukou) Sure! "is\_private" value should correspond with negation of the "Globally Reachable" value in IP special purpose address registries for [IPv4](https://www.iana.org/assignments/iana-ipv4-special-registry/iana-ipv4-special-registry.xhtml) and [IPv6](https://www.iana.org/assignments/iana-ipv6-special-registry/iana-ipv6-special-registry.xhtml). From the IPv4 table `0.0.0.0/8` is marked as not globally reachable so `is_private` should be `True`. |
| --- |

All reactions

Sorry, something went wrong.

[![@encukou](https://avatars.githubusercontent.com/u/302922?s=80&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou)

Copy link

Member

### **[encukou](/encukou)** commented [Apr 25, 2024](#issuecomment-2076497415)

| The 3.10-/3.11+ beahviour difference is about *networks*. The test checks `0.0.0.0/0`: the network containing all IPv4 addresses. Some are private, some not, but `is_private` is just a boolean. |
| --- |

All reactions

Sorry, something went wrong.

[pablogsal](/pablogsal)
pushed a commit
that referenced
this issue
[Apr 25, 2024](#ref-commit-ba43157)
[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou)

`[[3.11]](/python/cpython/commit/ba431579efdcbaed7a96f2ac4ea0775879a332fb "[3.11] gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177) (#118227)") [gh-113171](https://github.com/python/cpython/issues/113171)[:](/python/cpython/commit/ba431579efdcbaed7a96f2ac4ea0775879a332fb "[3.11] gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177) (#118227)") [gh-65056](https://github.com/python/cpython/issues/65056)[: Fix "private" (non-global) IP address ran…](/python/cpython/commit/ba431579efdcbaed7a96f2ac4ea0775879a332fb "[3.11] gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177) (#118227)")`
…

`[ba43157](/python/cpython/commit/ba431579efdcbaed7a96f2ac4ea0775879a332fb)`

```
…ges ([GH-113179](https://github.com/python/cpython/pull/113179)) ([GH-113186](https://github.com/python/cpython/pull/113186)) ([GH-118177](https://github.com/python/cpython/pull/118177)) ([#118227](https://github.com/python/cpython/pull/118227))
```

[encukou](/encukou)
added a commit
to encukou/cpython
that referenced
this issue
[May 1, 2024](#ref-commit-5e58376)
[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou) [![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak)

`[pythongh-113171](https://github.com/python/cpython/issues/113171)[:](/encukou/cpython/commit/5e58376d424fb951966277e5d46cf0b11d860ef3 "gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177)

* GH-113171: Fix \"private\" (non-global) IP address ranges (GH-113179)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

* GH-65056: Improve the IP address' is_global/is_private documentation (GH-113186)

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit 2a4cbf17af19a01d942f9579342f77c39fbd23c4)
(cherry picked from commit 40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f)

---------

(cherry picked from commit f86b17ac511e68192ba71f27e752321a3252cee3)

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>") [pythongh-65056](https://github.com/python/cpython/issues/65056)[: Fix "private" (non-global) IP addres…](/encukou/cpython/commit/5e58376d424fb951966277e5d46cf0b11d860ef3 "gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177)

* GH-113171: Fix \"private\" (non-global) IP address ranges (GH-113179)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

* GH-65056: Improve the IP address' is_global/is_private documentation (GH-113186)

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit 2a4cbf17af19a01d942f9579342f77c39fbd23c4)
(cherry picked from commit 40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f)

---------

(cherry picked from commit f86b17ac511e68192ba71f27e752321a3252cee3)

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>")`
…

`[5e58376](/encukou/cpython/commit/5e58376d424fb951966277e5d46cf0b11d860ef3)`

```
…s ranges ([pythonGH-113179](https://github.com/python/cpython/pull/113179)) ([pythonGH-113186](https://github.com/python/cpython/pull/113186)) ([pythonGH-118177](https://github.com/python/cpython/pull/118177))

* [pythonGH-113171](https://github.com/python/cpython/issues/113171): Fix "private" (non-global) IP address ranges ([pythonGH-113179](https://github.com/python/cpython/pull/113179))

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] [python#61602](https://github.com/python/cpython/issues/61602)

* [pythonGH-65056](https://github.com/python/cpython/issues/65056): Improve the IP address' is_global/is_private documentation ([pythonGH-113186](https://github.com/python/cpython/pull/113186))

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit [2a4cbf1](https://github.com/encukou/cpython/commit/2a4cbf17af19a01d942f9579342f77c39fbd23c4))
(cherry picked from commit [40d75c2](https://github.com/encukou/cpython/commit/40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f))

---------

(cherry picked from commit [f86b17a](https://github.com/encukou/cpython/commit/f86b17ac511e68192ba71f27e752321a3252cee3))

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
```

[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou)
[encukou](/encukou)
mentioned this issue
[May 1, 2024](#ref-pullrequest-2273419331)

[[3.9] gh-113171: gh-65056: Fix "private" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177)
#118472](/python/cpython/pull/118472)
 Merged

[encukou](/encukou)
added a commit
to encukou/cpython
that referenced
this issue
[May 1, 2024](#ref-commit-05a1467)
[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou) [![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak)

`[pythongh-113171](https://github.com/python/cpython/issues/113171)[:](/encukou/cpython/commit/05a14677846ed0a35773cd2ba582f9a65a3dfa48 "gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177)

* GH-113171: Fix \"private\" (non-global) IP address ranges (GH-113179)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

* GH-65056: Improve the IP address' is_global/is_private documentation (GH-113186)

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit 2a4cbf17af19a01d942f9579342f77c39fbd23c4)
(cherry picked from commit 40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f)

---------

(cherry picked from commit f86b17ac511e68192ba71f27e752321a3252cee3)

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>") [pythongh-65056](https://github.com/python/cpython/issues/65056)[: Fix "private" (non-global) IP addres…](/encukou/cpython/commit/05a14677846ed0a35773cd2ba582f9a65a3dfa48 "gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177)

* GH-113171: Fix \"private\" (non-global) IP address ranges (GH-113179)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

* GH-65056: Improve the IP address' is_global/is_private documentation (GH-113186)

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit 2a4cbf17af19a01d942f9579342f77c39fbd23c4)
(cherry picked from commit 40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f)

---------

(cherry picked from commit f86b17ac511e68192ba71f27e752321a3252cee3)

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>")`
…

`[05a1467](/encukou/cpython/commit/05a14677846ed0a35773cd2ba582f9a65a3dfa48)`

```
…s ranges ([pythonGH-113179](https://github.com/python/cpython/pull/113179)) ([pythonGH-113186](https://github.com/python/cpython/pull/113186)) ([pythonGH-118177](https://github.com/python/cpython/pull/118177))

* [pythonGH-113171](https://github.com/python/cpython/issues/113171): Fix "private" (non-global) IP address ranges ([pythonGH-113179](https://github.com/python/cpython/pull/113179))

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] [python#61602](https://github.com/python/cpython/issues/61602)

* [pythonGH-65056](https://github.com/python/cpython/issues/65056): Improve the IP address' is_global/is_private documentation ([pythonGH-113186](https://github.com/python/cpython/pull/113186))

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit [2a4cbf1](https://github.com/encukou/cpython/commit/2a4cbf17af19a01d942f9579342f77c39fbd23c4))
(cherry picked from commit [40d75c2](https://github.com/encukou/cpython/commit/40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f))

---------

(cherry picked from commit [f86b17a](https://github.com/encukou/cpython/commit/f86b17ac511e68192ba71f27e752321a3252cee3))

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
```

[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou)
[encukou](/encukou)
mentioned this issue
[May 1, 2024](#ref-pullrequest-2273732677)

[[3.8] gh-113171: gh-65056: Fix "private" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177)
#118479](/python/cpython/pull/118479)
 Merged

[ambv](/ambv)
pushed a commit
that referenced
this issue
[May 7, 2024](#ref-commit-c62c9e5)
[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou) [![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak)

`[[3.10]](/python/cpython/commit/c62c9e518b784fe44432a3f4fc265fb95b651906 "[3.10] gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177) (GH-118229)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 (\"This network\") and the other in
255.255.255.255/32 (\"Limited broadcast\").

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>") [gh-113171](https://github.com/python/cpython/issues/113171)[:](/python/cpython/commit/c62c9e518b784fe44432a3f4fc265fb95b651906 "[3.10] gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177) (GH-118229)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 (\"This network\") and the other in
255.255.255.255/32 (\"Limited broadcast\").

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>") [gh-65056](https://github.com/python/cpython/issues/65056)[: Fix "private" (non-global) IP address ran…](/python/cpython/commit/c62c9e518b784fe44432a3f4fc265fb95b651906 "[3.10] gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177) (GH-118229)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 (\"This network\") and the other in
255.255.255.255/32 (\"Limited broadcast\").

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>")`
…

`[c62c9e5](/python/cpython/commit/c62c9e518b784fe44432a3f4fc265fb95b651906)`

```
…ges ([GH-113179](https://github.com/python/cpython/pull/113179)) ([GH-113186](https://github.com/python/cpython/pull/113186)) ([GH-118177](https://github.com/python/cpython/pull/118177)) ([GH-118229](https://github.com/python/cpython/pull/118229))

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] [#61602](https://github.com/python/cpython/issues/61602)

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 ("This network") and the other in
255.255.255.255/32 ("Limited broadcast").

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
```

[ambv](/ambv)
pushed a commit
that referenced
this issue
[May 7, 2024](#ref-commit-22adf29)
[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou) [![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak)

`[[3.9]](/python/cpython/commit/22adf29da8d99933ffed8647d3e0726edd16f7f8 "[3.9] gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177) (GH-118472)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 (\"This network\") and the other in
255.255.255.255/32 (\"Limited broadcast\").

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>") [gh-113171](https://github.com/python/cpython/issues/113171)[:](/python/cpython/commit/22adf29da8d99933ffed8647d3e0726edd16f7f8 "[3.9] gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177) (GH-118472)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 (\"This network\") and the other in
255.255.255.255/32 (\"Limited broadcast\").

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>") [gh-65056](https://github.com/python/cpython/issues/65056)[: Fix "private" (non-global) IP address rang…](/python/cpython/commit/22adf29da8d99933ffed8647d3e0726edd16f7f8 "[3.9] gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177) (GH-118472)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 (\"This network\") and the other in
255.255.255.255/32 (\"Limited broadcast\").

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>")`
…

`[22adf29](/python/cpython/commit/22adf29da8d99933ffed8647d3e0726edd16f7f8)`

```
…es ([GH-113179](https://github.com/python/cpython/pull/113179)) ([GH-113186](https://github.com/python/cpython/pull/113186)) ([GH-118177](https://github.com/python/cpython/pull/118177)) ([GH-118472](https://github.com/python/cpython/pull/118472))

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] [#61602](https://github.com/python/cpython/issues/61602)

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 ("This network") and the other in
255.255.255.255/32 ("Limited broadcast").

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
```

[ambv](/ambv)
pushed a commit
that referenced
this issue
[May 7, 2024](#ref-commit-895f7e2)
[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou) [![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak)

`[[3.8]](/python/cpython/commit/895f7e2ac23eff4743143beef0f0c5ac71ea27d3 "[3.8] gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177) (GH-118479)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 (\"This network\") and the other in
255.255.255.255/32 (\"Limited broadcast\").

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>") [gh-113171](https://github.com/python/cpython/issues/113171)[:](/python/cpython/commit/895f7e2ac23eff4743143beef0f0c5ac71ea27d3 "[3.8] gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177) (GH-118479)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 (\"This network\") and the other in
255.255.255.255/32 (\"Limited broadcast\").

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>") [gh-65056](https://github.com/python/cpython/issues/65056)[: Fix "private" (non-global) IP address rang…](/python/cpython/commit/895f7e2ac23eff4743143beef0f0c5ac71ea27d3 "[3.8] gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177) (GH-118479)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 (\"This network\") and the other in
255.255.255.255/32 (\"Limited broadcast\").

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>")`
…

`[895f7e2](/python/cpython/commit/895f7e2ac23eff4743143beef0f0c5ac71ea27d3)`

```
…es ([GH-113179](https://github.com/python/cpython/pull/113179)) ([GH-113186](https://github.com/python/cpython/pull/113186)) ([GH-118177](https://github.com/python/cpython/pull/118177)) ([GH-118479](https://github.com/python/cpython/pull/118479))

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] [#61602](https://github.com/python/cpython/issues/61602)

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 ("This network") and the other in
255.255.255.255/32 ("Limited broadcast").

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
```

[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou)
[encukou](/encukou)
closed this as [completed](/python/cpython/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[May 10, 2024](#event-12770414117)

[![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak)
[jstasiak](/jstasiak)
mentioned this issue
[May 30, 2024](#ref-issue-2326617768)

[ipaddress: Shared Address Space (100.64.0.0/10) is neither private nor global
#119812](/python/cpython/issues/119812)

Open

[![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=80&v=4)](/jstasiak)

Copy link

Contributor

Author

### **[jstasiak](/jstasiak)** commented [May 30, 2024](#issuecomment-2140964542)

| I created a ticket to handle the `100.64.0.0/10` situation: [GH-119812](https://github.com/python/cpython/issues/119812). |
| --- |

All reactions

Sorry, something went wrong.

[mcepl](/mcepl)
pushed a commit
to openSUSE-Python/cpython
that referenced
this issue
[Jun 26, 2024](#ref-commit-2976e94)
[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou) [![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak) [![@mcepl](https://avatars.githubusercontent.com/u/198999?s=40&v=4)](/mcepl)

`[[](/openSUSE-Python/cpython/commit/2976e945b18210945d0f71395342f115eaf657bd "[CVE-2024-4032] Fix \"private\" (non-global) IP address ranges

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special
in (gh#python/cpython#61602).

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 (\"This network\") and the other in
255.255.255.255/32 (\"Limited broadcast\").

Add IPv6 addresses to suspignore.csv

That's a lot of semicolons!

Fixes: gh#python/cpython#113171
Fixes: bsc#1226448 (CVE-2024-4032)
From-PR: gh#python/cpython!113179
From-PR: gh#python/cpython!113186
From-PR: gh#python/cpython!118177
Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
Patch: CVE-2024-4032-private-IP-addrs.patch")[CVE-2024-4032](https://github.com/advisories/GHSA-mh6q-v4mp-2cc7 "CVE-2024-4032")[] Fix "private" (non-global) IP address ranges](/openSUSE-Python/cpython/commit/2976e945b18210945d0f71395342f115eaf657bd "[CVE-2024-4032] Fix \"private\" (non-global) IP address ranges

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special
in (gh#python/cpython#61602).

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 (\"This network\") and the other in
255.255.255.255/32 (\"Limited broadcast\").

Add IPv6 addresses to suspignore.csv

That's a lot of semicolons!

Fixes: gh#python/cpython#113171
Fixes: bsc#1226448 (CVE-2024-4032)
From-PR: gh#python/cpython!113179
From-PR: gh#python/cpython!113186
From-PR: gh#python/cpython!118177
Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
Patch: CVE-2024-4032-private-IP-addrs.patch")`
…

`[2976e94](/openSUSE-Python/cpython/commit/2976e945b18210945d0f71395342f115eaf657bd)`

```
The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special
in (gh#[python#61602](https://github.com/python/cpython/issues/61602)).

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 ("This network") and the other in
255.255.255.255/32 ("Limited broadcast").

Add IPv6 addresses to suspignore.csv

That's a lot of semicolons!

Fixes: gh#[python#113171](https://github.com/python/cpython/issues/113171)
Fixes: bsc#1226448 ([CVE-2024-4032](https://github.com/advisories/GHSA-mh6q-v4mp-2cc7 "CVE-2024-4032"))
From-PR: gh#python/cpython!113179
From-PR: gh#python/cpython!113186
From-PR: gh#python/cpython!118177
Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
Patch: [CVE-2024-4032](https://github.com/advisories/GHSA-mh6q-v4mp-2cc7 "CVE-2024-4032")-private-IP-addrs.patch
```

[smoser](/smoser)
added a commit
to smoser/wolfi-os
that referenced
this issue
[Jun 27, 2024](#ref-commit-1485d2b)
[![@smoser](https://avatars.githubusercontent.com/u/18865?s=40&u=3c22b9455cf60a01bfcee3ea2fc95d215b9dff9c&v=4)](/smoser)

`[python-3.10 - address](/smoser/wolfi-os/commit/1485d2b05c8068989e6f5f14ece5fbfd532db292 "python-3.10 - address CVE-2024-4032

https://github.com/python/cpython/issues/113171") [CVE-2024-4032](https://github.com/advisories/GHSA-mh6q-v4mp-2cc7 "CVE-2024-4032")`
…

`[1485d2b](/smoser/wolfi-os/commit/1485d2b05c8068989e6f5f14ece5fbfd532db292)`

```
[python/cpython#113171](https://github.com/python/cpython/issues/113171)
```

[![@smoser](https://avatars.githubusercontent.com/u/18865?s=40&u=3c22b9455cf60a01bfcee3ea2fc95d215b9dff9c&v=4)](/smoser)
[smoser](/smoser)
mentioned this issue
[Jun 27, 2024](#ref-pullrequest-2378854669)

[python-3.10 - address CVE-2024-4032
wolfi-dev/os#22798](/wolfi-dev/os/pull/22798)
 Merged

[smoser](/smoser)
added a commit
to smoser/wolfi-os
that referenced
this issue
[Jun 27, 2024](#ref-commit-3f8caf6)
[![@smoser](https://avatars.githubusercontent.com/u/18865?s=40&u=3c22b9455cf60a01bfcee3ea2fc95d215b9dff9c&v=4)](/smoser)

`[python-3.10 - address](/smoser/wolfi-os/commit/3f8caf6dfd8d66a423481de6097ab235de9c702d "python-3.10 - address CVE-2024-4032

https://github.com/python/cpython/issues/113171") [CVE-2024-4032](https://github.com/advisories/GHSA-mh6q-v4mp-2cc7 "CVE-2024-4032")`
…

`[3f8caf6](/smoser/wolfi-os/commit/3f8caf6dfd8d66a423481de6097ab235de9c702d)`

```
[python/cpython#113171](https://github.com/python/cpython/issues/113171)
```

[frenzymadness](/frenzymadness)
pushed a commit
to frenzymadness/cpython
that referenced
this issue
[Jul 2, 2024](#ref-commit-27b5160)
[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou) [![@frenzymadness](https://avatars.githubusercontent.com/u/5688939?s=40&v=4)](/frenzymadness)

`[00431:](/frenzymadness/cpython/commit/27b5160757ff9a7b2f025b1b6433c41106434b18 "00431: CVE-2024-4032

Upstream issue: https://github.com/python/cpython/issues/113171

Backported from 3.8.") [CVE-2024-4032](https://github.com/advisories/GHSA-mh6q-v4mp-2cc7 "CVE-2024-4032")`
…

`[27b5160](/frenzymadness/cpython/commit/27b5160757ff9a7b2f025b1b6433c41106434b18)`

```
Upstream issue: [python#113171](https://github.com/python/cpython/issues/113171)

Backported from 3.8.
```

[![@frenzymadness](https://avatars.githubusercontent.com/u/5688939?s=40&u=0612ccdf7151f383ab84f1c4ddb9e7bb3e92b6bd&v=4)](/frenzymadness)
[frenzymadness](/frenzymadness)
mentioned this issue
[Jul 2, 2024](#ref-pullrequest-2386817899)

[00431: CVE-2024-4032
fedora-python/cpython#79](/fedora-python/cpython/pull/79)
 Merged

[frenzymadness](/frenzymadness)
pushed a commit
to frenzymadness/cpython
that referenced
this issue
[Jul 3, 2024](#ref-commit-b137e12)
[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou) [![@frenzymadness](https://avatars.githubusercontent.com/u/5688939?s=40&v=4)](/frenzymadness)

`[00431:](/frenzymadness/cpython/commit/b137e1234a83af8e492986735df4ba31540b55d0 "00431: CVE-2024-4032: incorrect IPv4 and IPv6 private ranges

Upstream issue: https://github.com/python/cpython/issues/113171

Backported from 3.8.") [CVE-2024-4032](https://github.com/advisories/GHSA-mh6q-v4mp-2cc7 "CVE-2024-4032")[: incorrect IPv4 and IPv6 private ranges](/frenzymadness/cpython/commit/b137e1234a83af8e492986735df4ba31540b55d0 "00431: CVE-2024-4032: incorrect IPv4 and IPv6 private ranges

Upstream issue: https://github.com/python/cpython/issues/113171

Backported from 3.8.")`
…

`[b137e12](/frenzymadness/cpython/commit/b137e1234a83af8e492986735df4ba31540b55d0)`

```
Upstream issue: [python#113171](https://github.com/python/cpython/issues/113171)

Backported from 3.8.
```

[rickprice](/rickprice)
pushed a commit
to ActiveState/cpython
that referenced
this issue
[Jul 3, 2024](#ref-commit-677b465)
[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou) [![@rickprice](https://avatars.githubusercontent.com/u/1013454?s=40&v=4)](/rickprice)

`[CVE-2024-4032](https://github.com/advisories/GHSA-mh6q-v4mp-2cc7 "CVE-2024-4032") [Fix "private" (non-global) IP address ranges (](/ActiveState/cpython/commit/677b465a1adfe546a49548d010d06da321d129cd "CVE-2024-4032 Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177)

(cherry picked from commit f86b17ac511e68192ba71f27e752321a3252cee3)

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
(cherry picked from commit 05a14677846ed0a35773cd2ba582f9a65a3dfa48)

gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177)

* GH-113171: Fix \"private\" (non-global) IP address ranges (GH-113179)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

* GH-65056: Improve the IP address' is_global/is_private documentation (GH-113186)

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit 2a4cbf17af19a01d942f9579342f77c39fbd23c4)
(cherry picked from commit 40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f)

---------

(cherry picked from commit f86b17ac511e68192ba71f27e752321a3252cee3)

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
(cherry picked from commit 05a14677846ed0a35773cd2ba582f9a65a3dfa48)

Add IPv6 addresses to suspignore.csv

That's a lot of semicolons!

(cherry picked from commit e366724f6e290b71ec49005079e8472c3cac2594)

Add notable changes")[pythonGH-…](https://github.com/python/cpython/pull/113179)`
…

`[677b465](/ActiveState/cpython/commit/677b465a1adfe546a49548d010d06da321d129cd)`

```
[…113179](https://github.com/python/cpython/pull/113179)) ([pythonGH-113186](https://github.com/python/cpython/pull/113186)) ([pythonGH-118177](https://github.com/python/cpython/pull/118177))

(cherry picked from commit [f86b17a](https://github.com/ActiveState/cpython/commit/f86b17ac511e68192ba71f27e752321a3252cee3))

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
(cherry picked from commit [05a1467](https://github.com/ActiveState/cpython/commit/05a14677846ed0a35773cd2ba582f9a65a3dfa48))

[pythongh-113171](https://github.com/python/cpython/issues/113171): [pythongh-65056](https://github.com/python/cpython/issues/65056): Fix "private" (non-global) IP address ranges ([pythonGH-113179](https://github.com/python/cpython/pull/113179)) ([pythonGH-113186](https://github.com/python/cpython/pull/113186)) ([pythonGH-118177](https://github.com/python/cpython/pull/118177))

* [pythonGH-113171](https://github.com/python/cpython/issues/113171): Fix "private" (non-global) IP address ranges ([pythonGH-113179](https://github.com/python/cpython/pull/113179))

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] [python#61602](https://github.com/python/cpython/issues/61602)

* [pythonGH-65056](https://github.com/python/cpython/issues/65056): Improve the IP address' is_global/is_private documentation ([pythonGH-113186](https://github.com/python/cpython/pull/113186))

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit [2a4cbf1](https://github.com/ActiveState/cpython/commit/2a4cbf17af19a01d942f9579342f77c39fbd23c4))
(cherry picked from commit [40d75c2](https://github.com/ActiveState/cpython/commit/40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f))

---------

(cherry picked from commit [f86b17a](https://github.com/ActiveState/cpython/commit/f86b17ac511e68192ba71f27e752321a3252cee3))

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
(cherry picked from commit [05a1467](https://github.com/ActiveState/cpython/commit/05a14677846ed0a35773cd2ba582f9a65a3dfa48))

Add IPv6 addresses to suspignore.csv

That's a lot of semicolons!

(cherry picked from commit [e366724](https://github.com/ActiveState/cpython/commit/e366724f6e290b71ec49005079e8472c3cac2594))

Add notable changes
```

[![@rickprice](https://avatars.githubusercontent.com/u/1013454?s=40&u=0ee5f0661235b463155f59dd127e785840c2813d&v=4)](/rickprice)
[rickprice](/rickprice)
mentioned this issue
[Jul 3, 2024](#ref-pullrequest-2388873959)

[CVE-2024-4032 Fix "private" (non-global) IP address ranges (GH-113179…
ActiveState/cpython#57](/ActiveState/cpython/pull/57)
 Merged

[rickprice](/rickprice)
pushed a commit
to ActiveState/cpython
that referenced
this issue
[Jul 4, 2024](#ref-commit-6e7c097)
[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou) [![@rickprice](https://avatars.githubusercontent.com/u/1013454?s=40&v=4)](/rickprice)

`[CVE-2024-4032](https://github.com/advisories/GHSA-mh6q-v4mp-2cc7 "CVE-2024-4032") [Fix "private" (non-global) IP address ranges (](/ActiveState/cpython/commit/6e7c0970b4cf80f7b94cd9c7d77b99e9f0172818 "CVE-2024-4032 Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177)

* Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186)
(GH-118177)

(cherry picked from commit f86b17ac511e68192ba71f27e752321a3252cee3)

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
(cherry picked from commit 05a14677846ed0a35773cd2ba582f9a65a3dfa48)

gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges
(GH-113179) (GH-113186) (GH-118177)

* GH-113171: Fix \"private\" (non-global) IP address ranges (GH-113179)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

* GH-65056: Improve the IP address' is_global/is_private documentation (GH-113186)

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit 2a4cbf17af19a01d942f9579342f77c39fbd23c4)
(cherry picked from commit 40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f)

---------

(cherry picked from commit f86b17ac511e68192ba71f27e752321a3252cee3)

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
(cherry picked from commit 05a14677846ed0a35773cd2ba582f9a65a3dfa48)

Add IPv6 addresses to suspignore.csv

That's a lot of semicolons!

(cherry picked from commit e366724f6e290b71ec49005079e8472c3cac2594)")[pythonGH-…](https://github.com/python/cpython/pull/113179)`
…

`[6e7c097](/ActiveState/cpython/commit/6e7c0970b4cf80f7b94cd9c7d77b99e9f0172818)`

```
[…113179](https://github.com/python/cpython/pull/113179)) ([pythonGH-113186](https://github.com/python/cpython/pull/113186)) ([pythonGH-118177](https://github.com/python/cpython/pull/118177))

* Fix "private" (non-global) IP address ranges ([pythonGH-113179](https://github.com/python/cpython/pull/113179)) ([pythonGH-113186](https://github.com/python/cpython/pull/113186))
([pythonGH-118177](https://github.com/python/cpython/pull/118177))

(cherry picked from commit [f86b17a](https://github.com/ActiveState/cpython/commit/f86b17ac511e68192ba71f27e752321a3252cee3))

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
(cherry picked from commit [05a1467](https://github.com/ActiveState/cpython/commit/05a14677846ed0a35773cd2ba582f9a65a3dfa48))

[pythongh-113171](https://github.com/python/cpython/issues/113171): [pythongh-65056](https://github.com/python/cpython/issues/65056): Fix "private" (non-global) IP address ranges
([pythonGH-113179](https://github.com/python/cpython/pull/113179)) ([pythonGH-113186](https://github.com/python/cpython/pull/113186)) ([pythonGH-118177](https://github.com/python/cpython/pull/118177))

* [pythonGH-113171](https://github.com/python/cpython/issues/113171): Fix "private" (non-global) IP address ranges ([pythonGH-113179](https://github.com/python/cpython/pull/113179))

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] [python#61602](https://github.com/python/cpython/issues/61602)

* [pythonGH-65056](https://github.com/python/cpython/issues/65056): Improve the IP address' is_global/is_private documentation ([pythonGH-113186](https://github.com/python/cpython/pull/113186))

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit [2a4cbf1](https://github.com/ActiveState/cpython/commit/2a4cbf17af19a01d942f9579342f77c39fbd23c4))
(cherry picked from commit [40d75c2](https://github.com/ActiveState/cpython/commit/40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f))

---------

(cherry picked from commit [f86b17a](https://github.com/ActiveState/cpython/commit/f86b17ac511e68192ba71f27e752321a3252cee3))

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
(cherry picked from commit [05a1467](https://github.com/ActiveState/cpython/commit/05a14677846ed0a35773cd2ba582f9a65a3dfa48))

Add IPv6 addresses to suspignore.csv

That's a lot of semicolons!

(cherry picked from commit [e366724](https://github.com/ActiveState/cpython/commit/e366724f6e290b71ec49005079e8472c3cac2594))
```

[frenzymadness](/frenzymadness)
pushed a commit
to fedora-python/cpython
that referenced
this issue
[Jul 4, 2024](#ref-commit-a03f753)
[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou) [![@frenzymadness](https://avatars.githubusercontent.com/u/5688939?s=40&v=4)](/frenzymadness)

`[00431:](/fedora-python/cpython/commit/a03f753f171cafae4319ab2480a2b6f04484f33f "00431: CVE-2024-4032: incorrect IPv4 and IPv6 private ranges

Upstream issue: https://github.com/python/cpython/issues/113171

Backported from 3.8.") [CVE-2024-4032](https://github.com/advisories/GHSA-mh6q-v4mp-2cc7 "CVE-2024-4032")[: incorrect IPv4 and IPv6 private ranges](/fedora-python/cpython/commit/a03f753f171cafae4319ab2480a2b6f04484f33f "00431: CVE-2024-4032: incorrect IPv4 and IPv6 private ranges

Upstream issue: https://github.com/python/cpython/issues/113171

Backported from 3.8.")`
…

`[a03f753](/fedora-python/cpython/commit/a03f753f171cafae4319ab2480a2b6f04484f33f)`

```
Upstream issue: [python#113171](https://github.com/python/cpython/issues/113171)

Backported from 3.8.
```

[rickprice](/rickprice)
pushed a commit
to ActiveState/cpython
that referenced
this issue
[Jul 8, 2024](#ref-commit-89f48de)
[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou) [![@rickprice](https://avatars.githubusercontent.com/u/1013454?s=40&v=4)](/rickprice)

`[CVE-2024-4032](https://github.com/advisories/GHSA-mh6q-v4mp-2cc7 "CVE-2024-4032") [Fix "private" (non-global) IP address ranges (](/ActiveState/cpython/commit/89f48de7b775d1d137587d644834e69aba716f4d "CVE-2024-4032 Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177)

* Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186)
(GH-118177)

(cherry picked from commit f86b17ac511e68192ba71f27e752321a3252cee3)

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
(cherry picked from commit 05a14677846ed0a35773cd2ba582f9a65a3dfa48)

gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges
(GH-113179) (GH-113186) (GH-118177)

* GH-113171: Fix \"private\" (non-global) IP address ranges (GH-113179)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

* GH-65056: Improve the IP address' is_global/is_private documentation (GH-113186)

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit 2a4cbf17af19a01d942f9579342f77c39fbd23c4)
(cherry picked from commit 40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f)

---------

(cherry picked from commit f86b17ac511e68192ba71f27e752321a3252cee3)

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
(cherry picked from commit 05a14677846ed0a35773cd2ba582f9a65a3dfa48)

Add IPv6 addresses to suspignore.csv

That's a lot of semicolons!

(cherry picked from commit e366724f6e290b71ec49005079e8472c3cac2594)")[pythonGH-…](https://github.com/python/cpython/pull/113179)`
…

`[89f48de](/ActiveState/cpython/commit/89f48de7b775d1d137587d644834e69aba716f4d)`

```
[…113179](https://github.com/python/cpython/pull/113179)) ([pythonGH-113186](https://github.com/python/cpython/pull/113186)) ([pythonGH-118177](https://github.com/python/cpython/pull/118177))

* Fix "private" (non-global) IP address ranges ([pythonGH-113179](https://github.com/python/cpython/pull/113179)) ([pythonGH-113186](https://github.com/python/cpython/pull/113186))
([pythonGH-118177](https://github.com/python/cpython/pull/118177))

(cherry picked from commit [f86b17a](https://github.com/ActiveState/cpython/commit/f86b17ac511e68192ba71f27e752321a3252cee3))

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
(cherry picked from commit [05a1467](https://github.com/ActiveState/cpython/commit/05a14677846ed0a35773cd2ba582f9a65a3dfa48))

[pythongh-113171](https://github.com/python/cpython/issues/113171): [pythongh-65056](https://github.com/python/cpython/issues/65056): Fix "private" (non-global) IP address ranges
([pythonGH-113179](https://github.com/python/cpython/pull/113179)) ([pythonGH-113186](https://github.com/python/cpython/pull/113186)) ([pythonGH-118177](https://github.com/python/cpython/pull/118177))

* [pythonGH-113171](https://github.com/python/cpython/issues/113171): Fix "private" (non-global) IP address ranges ([pythonGH-113179](https://github.com/python/cpython/pull/113179))

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] [python#61602](https://github.com/python/cpython/issues/61602)

* [pythonGH-65056](https://github.com/python/cpython/issues/65056): Improve the IP address' is_global/is_private documentation ([pythonGH-113186](https://github.com/python/cpython/pull/113186))

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit [2a4cbf1](https://github.com/ActiveState/cpython/commit/2a4cbf17af19a01d942f9579342f77c39fbd23c4))
(cherry picked from commit [40d75c2](https://github.com/ActiveState/cpython/commit/40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f))

---------

(cherry picked from commit [f86b17a](https://github.com/ActiveState/cpython/commit/f86b17ac511e68192ba71f27e752321a3252cee3))

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
(cherry picked from commit [05a1467](https://github.com/ActiveState/cpython/commit/05a14677846ed0a35773cd2ba582f9a65a3dfa48))

Add IPv6 addresses to suspignore.csv

That's a lot of semicolons!

(cherry picked from commit [e366724](https://github.com/ActiveState/cpython/commit/e366724f6e290b71ec49005079e8472c3cac2594))
```

[rickprice](/rickprice)
pushed a commit
to ActiveState/cpython
that referenced
this issue
[Jul 12, 2024](#ref-commit-0a34c66)
[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou) [![@rickprice](https://avatars.githubusercontent.com/u/1013454?s=40&v=4)](/rickprice)

`[CVE-2024-4032](https://github.com/advisories/GHSA-mh6q-v4mp-2cc7 "CVE-2024-4032") [Fix "private" (non-global) IP address ranges (](/ActiveState/cpython/commit/0a34c661c0415d9fe38608a704f8b88614d15f8e "CVE-2024-4032 Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177)

* Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186)
(GH-118177)

(cherry picked from commit f86b17ac511e68192ba71f27e752321a3252cee3)

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
(cherry picked from commit 05a14677846ed0a35773cd2ba582f9a65a3dfa48)

gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges
(GH-113179) (GH-113186) (GH-118177)

* GH-113171: Fix \"private\" (non-global) IP address ranges (GH-113179)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

* GH-65056: Improve the IP address' is_global/is_private documentation (GH-113186)

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit 2a4cbf17af19a01d942f9579342f77c39fbd23c4)
(cherry picked from commit 40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f)

---------

(cherry picked from commit f86b17ac511e68192ba71f27e752321a3252cee3)

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
(cherry picked from commit 05a14677846ed0a35773cd2ba582f9a65a3dfa48)

Add IPv6 addresses to suspignore.csv

That's a lot of semicolons!

(cherry picked from commit e366724f6e290b71ec49005079e8472c3cac2594)")[pythonGH-…](https://github.com/python/cpython/pull/113179)`
…

`[0a34c66](/ActiveState/cpython/commit/0a34c661c0415d9fe38608a704f8b88614d15f8e)`

```
[…113179](https://github.com/python/cpython/pull/113179)) ([pythonGH-113186](https://github.com/python/cpython/pull/113186)) ([pythonGH-118177](https://github.com/python/cpython/pull/118177))

* Fix "private" (non-global) IP address ranges ([pythonGH-113179](https://github.com/python/cpython/pull/113179)) ([pythonGH-113186](https://github.com/python/cpython/pull/113186))
([pythonGH-118177](https://github.com/python/cpython/pull/118177))

(cherry picked from commit [f86b17a](https://github.com/ActiveState/cpython/commit/f86b17ac511e68192ba71f27e752321a3252cee3))

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
(cherry picked from commit [05a1467](https://github.com/ActiveState/cpython/commit/05a14677846ed0a35773cd2ba582f9a65a3dfa48))

[pythongh-113171](https://github.com/python/cpython/issues/113171): [pythongh-65056](https://github.com/python/cpython/issues/65056): Fix "private" (non-global) IP address ranges
([pythonGH-113179](https://github.com/python/cpython/pull/113179)) ([pythonGH-113186](https://github.com/python/cpython/pull/113186)) ([pythonGH-118177](https://github.com/python/cpython/pull/118177))

* [pythonGH-113171](https://github.com/python/cpython/issues/113171): Fix "private" (non-global) IP address ranges ([pythonGH-113179](https://github.com/python/cpython/pull/113179))

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] [python#61602](https://github.com/python/cpython/issues/61602)

* [pythonGH-65056](https://github.com/python/cpython/issues/65056): Improve the IP address' is_global/is_private documentation ([pythonGH-113186](https://github.com/python/cpython/pull/113186))

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit [2a4cbf1](https://github.com/ActiveState/cpython/commit/2a4cbf17af19a01d942f9579342f77c39fbd23c4))
(cherry picked from commit [40d75c2](https://github.com/ActiveState/cpython/commit/40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f))

---------

(cherry picked from commit [f86b17a](https://github.com/ActiveState/cpython/commit/f86b17ac511e68192ba71f27e752321a3252cee3))

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
(cherry picked from commit [05a1467](https://github.com/ActiveState/cpython/commit/05a14677846ed0a35773cd2ba582f9a65a3dfa48))

Add IPv6 addresses to suspignore.csv

That's a lot of semicolons!

(cherry picked from commit [e366724](https://github.com/ActiveState/cpython/commit/e366724f6e290b71ec49005079e8472c3cac2594))
```

[frenzymadness](/frenzymadness)
pushed a commit
to frenzymadness/cpython
that referenced
this issue
[Aug 13, 2024](#ref-commit-7ef313f)
[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou) [![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak) [![@frenzymadness](https://avatars.githubusercontent.com/u/5688939?s=40&v=4)](/frenzymadness)

`[00431:](/frenzymadness/cpython/commit/7ef313f659ac6f2ad213615e6454abc20e7c518b "00431: gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177) (GH-118472)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 (\"This network\") and the other in
255.255.255.255/32 (\"Limited broadcast\").

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>") [pythongh-113171](https://github.com/python/cpython/issues/113171)[:](/frenzymadness/cpython/commit/7ef313f659ac6f2ad213615e6454abc20e7c518b "00431: gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177) (GH-118472)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 (\"This network\") and the other in
255.255.255.255/32 (\"Limited broadcast\").

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>") [pythongh-65056](https://github.com/python/cpython/issues/65056)[: Fix "private" (non-global) IP…](/frenzymadness/cpython/commit/7ef313f659ac6f2ad213615e6454abc20e7c518b "00431: gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177) (GH-118472)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 (\"This network\") and the other in
255.255.255.255/32 (\"Limited broadcast\").

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>")`
…

`[7ef313f](/frenzymadness/cpython/commit/7ef313f659ac6f2ad213615e6454abc20e7c518b)`

```
… address ranges ([pythonGH-113179](https://github.com/python/cpython/pull/113179)) ([pythonGH-113186](https://github.com/python/cpython/pull/113186)) ([pythonGH-118177](https://github.com/python/cpython/pull/118177)) ([pythonGH-118472](https://github.com/python/cpython/pull/118472))

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] [python#61602](https://github.com/python/cpython/issues/61602)

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 ("This network") and the other in
255.255.255.255/32 ("Limited broadcast").

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
```

[frenzymadness](/frenzymadness)
pushed a commit
to fedora-python/cpython
that referenced
this issue
[Aug 15, 2024](#ref-commit-71337f4)
[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou) [![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak) [![@frenzymadness](https://avatars.githubusercontent.com/u/5688939?s=40&v=4)](/frenzymadness)

`[00431:](/fedora-python/cpython/commit/71337f4081170c2d712ddea9b8eaad5a5734fee1 "00431: gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177) (GH-118472)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 (\"This network\") and the other in
255.255.255.255/32 (\"Limited broadcast\").

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>") [pythongh-113171](https://github.com/python/cpython/issues/113171)[:](/fedora-python/cpython/commit/71337f4081170c2d712ddea9b8eaad5a5734fee1 "00431: gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177) (GH-118472)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 (\"This network\") and the other in
255.255.255.255/32 (\"Limited broadcast\").

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>") [pythongh-65056](https://github.com/python/cpython/issues/65056)[: Fix "private" (non-global) IP…](/fedora-python/cpython/commit/71337f4081170c2d712ddea9b8eaad5a5734fee1 "00431: gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177) (GH-118472)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 (\"This network\") and the other in
255.255.255.255/32 (\"Limited broadcast\").

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>")`
…

`[71337f4](/fedora-python/cpython/commit/71337f4081170c2d712ddea9b8eaad5a5734fee1)`

```
… address ranges ([pythonGH-113179](https://github.com/python/cpython/pull/113179)) ([pythonGH-113186](https://github.com/python/cpython/pull/113186)) ([pythonGH-118177](https://github.com/python/cpython/pull/118177)) ([pythonGH-118472](https://github.com/python/cpython/pull/118472))

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] [python#61602](https://github.com/python/cpython/issues/61602)

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 ("This network") and the other in
255.255.255.255/32 ("Limited broadcast").

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
```

[stratakis](/stratakis)
pushed a commit
to stratakis/cpython
that referenced
this issue
[Aug 15, 2024](#ref-commit-234aea1)
[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou) [![@stratakis](https://avatars.githubusercontent.com/u/14812606?s=40&v=4)](/stratakis)

`[00431:](/stratakis/cpython/commit/234aea11c762ef701283e9dec9fcb9282b0b8f64 "00431: gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177) (GH-118472)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 (\"This network\") and the other in
255.255.255.255/32 (\"Limited broadcast\").") [pythongh-113171](https://github.com/python/cpython/issues/113171)[:](/stratakis/cpython/commit/234aea11c762ef701283e9dec9fcb9282b0b8f64 "00431: gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177) (GH-118472)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 (\"This network\") and the other in
255.255.255.255/32 (\"Limited broadcast\").") [pythongh-65056](https://github.com/python/cpython/issues/65056)[: Fix "private" (non-global) IP…](/stratakis/cpython/commit/234aea11c762ef701283e9dec9fcb9282b0b8f64 "00431: gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177) (GH-118472)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 (\"This network\") and the other in
255.255.255.255/32 (\"Limited broadcast\").")`
…

`[234aea1](/stratakis/cpython/commit/234aea11c762ef701283e9dec9fcb9282b0b8f64)`

```
… address ranges ([pythonGH-113179](https://github.com/python/cpython/pull/113179)) ([pythonGH-113186](https://github.com/python/cpython/pull/113186)) ([pythonGH-118177](https://github.com/python/cpython/pull/118177)) ([pythonGH-118472](https://github.com/python/cpython/pull/118472))

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] [python#61602](https://github.com/python/cpython/issues/61602)

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 ("This network") and the other in
255.255.255.255/32 ("Limited broadcast").
```

[![@vEpiphyte](https://avatars.githubusercontent.com/u/26100278?s=40&v=4)](/vEpiphyte)
[vEpiphyte](/vEpiphyte)
mentioned this issue
[Sep 24, 2024](#ref-pullrequest-2514425821)

[Vendor ipaddress and email.utils; renorm ipv4 and ipv6 types based on updated ipaddress corrections (SYN-5490, SYN-7937)
vertexproject/synapse#3902](/vertexproject/synapse/pull/3902)
 Merged

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fpython%2Fcpython%2Fissues%2F113171)

Assignees

[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&v=4)](/encukou) [encukou](/encukou)

Labels

[type-bug](/python/cpython/labels/type-bug)
An unexpected behavior, bug, or error
[type-security](/python/cpython/labels/type-security)
A security issue

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

4 participants

[![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=52&v=4)](/jstasiak) [![@gpshead](https://avatars.githubusercontent.com/u/68491?s=52&v=4)](/gpshead) [![@encukou](https://avatars.githubusercontent.com/u/302922?s=52&v=4)](/encukou) [![@sethmlarson](https://avatars.githubusercontent.com/u/18519037?s=52&v=4)](/sethmlarson)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_c0a12787_20250110_175745.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpython%2Fcpython%2Fpull%2F113179)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpython%2Fcpython%2Fpull%2F113179)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=python%2Fcpython)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[python](/python)
/
**[cpython](/python/cpython)**
Public

* [Notifications](/login?return_to=%2Fpython%2Fcpython) You must be signed in to change notification settings
* [Fork
  30.8k](/login?return_to=%2Fpython%2Fcpython)
* [Star
   64.7k](/login?return_to=%2Fpython%2Fcpython)

* [Code](/python/cpython)
* [Issues
  5k+](/python/cpython/issues)
* [Pull requests
  1.8k](/python/cpython/pulls)
* [Actions](/python/cpython/actions)
* [Projects
  28](/python/cpython/projects)
* [Security](/python/cpython/security)
* [Insights](/python/cpython/pulse)

Additional navigation options

* [Code](/python/cpython)
* [Issues](/python/cpython/issues)
* [Pull requests](/python/cpython/pulls)
* [Actions](/python/cpython/actions)
* [Projects](/python/cpython/projects)
* [Security](/python/cpython/security)
* [Insights](/python/cpython/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fpython%2Fcpython%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fpython%2Fcpython%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# GH-113171: Fix "private" (non-global) IP address ranges #113179

 Merged

[encukou](/encukou)
merged 9 commits into
[python:main](/python/cpython/tree/main "python/cpython:main")
from
[jstasiak:fix-ipaddress-private-ranges](/jstasiak/cpython/tree/fix-ipaddress-private-ranges "jstasiak/cpython:fix-ipaddress-private-ranges")

Mar 22, 2024

 Merged

# [GH-113171: Fix "private" (non-global) IP address ranges](#top) #113179

[encukou](/encukou)
merged 9 commits into
[python:main](/python/cpython/tree/main "python/cpython:main")
from
[jstasiak:fix-ipaddress-private-ranges](/jstasiak/cpython/tree/fix-ipaddress-private-ranges "jstasiak/cpython:fix-ipaddress-private-ranges")

Mar 22, 2024

[Conversation
20](/python/cpython/pull/113179)
[Commits
9](/python/cpython/pull/113179/commits)
[Checks
35](/python/cpython/pull/113179/checks)
[Files changed](/python/cpython/pull/113179/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![jstasiak](https://avatars.githubusercontent.com/u/36209?s=60&v=4)](/jstasiak)

Copy link

Contributor

### @jstasiak **[jstasiak](/jstasiak)** commented [Dec 15, 2023](#issue-2044004062) • edited Loading

The \_private\_networks variables, used by various is\_private implementations, were missing some ranges and at the same time had overly strict ranges (where there are more specific ranges considered globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise incorrect.

I left 100.64.0.0/10 alone, for now, as it's been made special in [1] and I'm not sure if we want to undo that as I don't quite understand the motivation behind it.

Additionally I mainly focused on adding tests for IP*Address.is\_global and I left IP*Network.is\_global alone. The reasons for that are:

* I don't think it makes much sense to have properties like is\_global, is\_private etc. on networks, where there are more than two possibilities (can be global, can be non-global, can be partially global).
* The properties aren't documented for network objects in the first place so it's unclear what the semantics are

[1] [#61602](https://github.com/python/cpython/issues/61602)

* Issue: [ipaddress considers some not globally reachable addresses global and vice versa #113171](https://github.com/python/cpython/issues/113171)

Sorry, something went wrong.

 👍
1
 dtolnay reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

[![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak)

`[pythonGH-113171](https://github.com/python/cpython/issues/113171)[: Fix "private" (really non-global) IP address ranges](/python/cpython/pull/113179/commits/b83b9874a5bcfe6eb3233849371fb35ccf2fa60f "GH-113171: Fix \"private\" (really non-global) IP address ranges

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

A _address_exclude_many() helper function is created to calculate
the necessary network ranges in the trickier cases.

I left 100.64.0.0/10 alone, for now, as it's been made special in [1]
and I'm not sure if we want to undo that as I don't quite understand the
motivation behind it.

Additionally I mainly focused on adding tests for IP*Address.is_global
and I left IP*Network.is_global alone. The reasons for that are:

* I don't think it makes much sense to have properties like is_global,
  is_private etc. on networks, where there are more than two
  possibilities (can be global, can be non-global, can be partially global).
* The properties aren't documented for network objects in the first
  place so it's unclear what the semantics are

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602")`
 …

`[b83b987](/python/cpython/pull/113179/commits/b83b9874a5bcfe6eb3233849371fb35ccf2fa60f)`

```
The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

A _address_exclude_many() helper function is created to calculate
the necessary network ranges in the trickier cases.

I left 100.64.0.0/10 alone, for now, as it's been made special in [1]
and I'm not sure if we want to undo that as I don't quite understand the
motivation behind it.

Additionally I mainly focused on adding tests for IP*Address.is_global
and I left IP*Network.is_global alone. The reasons for that are:

* I don't think it makes much sense to have properties like is_global,
  is_private etc. on networks, where there are more than two
  possibilities (can be global, can be non-global, can be partially global).
* The properties aren't documented for network objects in the first
  place so it's unclear what the semantics are

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] [python#61602](https://github.com/python/cpython/issues/61602)
```

[![@bedevere-app](https://avatars.githubusercontent.com/in/388350?s=40&v=4)](/apps/bedevere-app)
[bedevere-app](/apps/bedevere-app)
bot
added
the
[awaiting review](/python/cpython/labels/awaiting%20review)
label
[Dec 15, 2023](#event-11261369400)

[![@bedevere-app](https://avatars.githubusercontent.com/in/388350?s=40&v=4)](/apps/bedevere-app)
[bedevere-app](/apps/bedevere-app)
bot
mentioned this pull request
[Dec 15, 2023](#ref-issue-2043777514)

[ipaddress considers some not globally reachable addresses global and vice versa
#113171](/python/cpython/issues/113171)

Closed

[![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=80&v=4)](/jstasiak)

Copy link

Contributor

Author

### **[jstasiak](/jstasiak)** commented [Dec 15, 2023](#issuecomment-1858142401)

| Two concerns to resolve:   1. What to do about 100.64.0.0/10? 2. Should I add a news entry for this? It's both a fix and a somewhat breaking change. |
| --- |

All reactions

Sorry, something went wrong.

[![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak)
[jstasiak](/jstasiak)
changed the title
~~GH-113171: Fix "private" (really non-global) IP address ranges~~
GH-113171: Fix "private" (non-global) IP address ranges
[Dec 15, 2023](#event-11261525317)

[![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak)
[jstasiak](/jstasiak)
mentioned this pull request
[Dec 15, 2023](#ref-pullrequest-2044108910)

[GH-65056: Improve the IP address' is\_global/is\_private documentation
#113186](/python/cpython/pull/113186)
 Merged

[![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=80&v=4)](/jstasiak)

Copy link

Contributor

Author

### **[jstasiak](/jstasiak)** commented [Dec 15, 2023](#issuecomment-1858383563)

| I thought about it a little bit and I'll have a much simpler implementations of this, not today though |
| --- |

All reactions

Sorry, something went wrong.

[![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak)
[jstasiak](/jstasiak)
mentioned this pull request
[Dec 16, 2023](#ref-issue-100595518)

[Tracking issue for Ipv{4,6}Addr convenience methods
rust-lang/rust#27709](/rust-lang/rust/issues/27709)

Open

28 tasks

 [jstasiak](/jstasiak)
added 2 commits
[January 9, 2024 20:38](#commits-pushed-2a8d49b)

[![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak)

`[Simplify](/python/cpython/pull/113179/commits/2a8d49b30b9f8f41f7ddab2d067101bf83e91bce "Simplify")`

`[2a8d49b](/python/cpython/pull/113179/commits/2a8d49b30b9f8f41f7ddab2d067101bf83e91bce)`

[![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak)

`[Remove an unnecessary import](/python/cpython/pull/113179/commits/7c9235e5d41737cf07bf485d88ebba2bced52bd1 "Remove an unnecessary import")`

`[7c9235e](/python/cpython/pull/113179/commits/7c9235e5d41737cf07bf485d88ebba2bced52bd1)`

[![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=80&v=4)](/jstasiak)

Copy link

Contributor

Author

### **[jstasiak](/jstasiak)** commented [Jan 9, 2024](#issuecomment-1883670808)

| Simplified. I continue to be unsure about the semantics of these properties for *networks*, I left them alone (for now at least). |
| --- |

All reactions

Sorry, something went wrong.

[![@encukou](https://avatars.githubusercontent.com/u/302922?s=80&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou)

Copy link

Member

### **[encukou](/encukou)** commented [Mar 13, 2024](#issuecomment-1994231578)

| IMO:  What to do about 100.64.0.0/10?  Keep it as it is, and document it? I see you did that in [#113186](https://github.com/python/cpython/pull/113186).  Should I add a news entry for this? It's both a fix and a somewhat breaking change.  Yes, and also add it to What's New.  unsure about the semantics of these properties for networks  It would probably be best to document that if not all addresses in the network share a single value, the result is unspecified. That's the case now, too. However, if *all* of the network is in an exception, I think that should be honored. |
| --- |

All reactions

Sorry, something went wrong.

 [jstasiak](/jstasiak)
added 4 commits
[March 14, 2024 01:01](#commits-pushed-d87ac9e)

[![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak)

`[Update IP networks too](/python/cpython/pull/113179/commits/d87ac9eb379b4ddd20a8696b24d36e3e6c80cb54 "Update IP networks too")`

`[d87ac9e](/python/cpython/pull/113179/commits/d87ac9eb379b4ddd20a8696b24d36e3e6c80cb54)`

[![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak)

`[Merge remote-tracking branch 'origin/main' into fix-ipaddress-private…](/python/cpython/pull/113179/commits/e2d4582904389331a851127d794d7e1247041082 "Merge remote-tracking branch 'origin/main' into fix-ipaddress-private-ranges")`
 …

`[e2d4582](/python/cpython/pull/113179/commits/e2d4582904389331a851127d794d7e1247041082)`

```
…-ranges
```

[![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak)

`[Add documentation](/python/cpython/pull/113179/commits/f031f6e0643bf07283f5280cb709694e43275240 "Add documentation")`

`[f031f6e](/python/cpython/pull/113179/commits/f031f6e0643bf07283f5280cb709694e43275240)`

[![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak)

`[Actually fix the shared address space too](/python/cpython/pull/113179/commits/d3ee80d34bbac907e96b37ed64ae9252c71f36a0 "Actually fix the shared address space too")`

`[d3ee80d](/python/cpython/pull/113179/commits/d3ee80d34bbac907e96b37ed64ae9252c71f36a0)`

[![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=80&v=4)](/jstasiak)

Copy link

Contributor

Author

### **[jstasiak](/jstasiak)** commented [Mar 18, 2024](#issuecomment-2005153135)

| Thank you for your feedback [@encukou](https://github.com/encukou).  To address your points in reverse order:  unsure about the semantics of these properties for networks  It would probably be best to document that if not all addresses in the network share a single value, the result is unspecified. That's the case now, too. However, if *all* of the network is in an exception, I think that should be honored.  Agreed and done (as far as I can tell).  Should I add a news entry for this? It's both a fix and a somewhat breaking change.  Yes, and also add it to What's New.  Done. Feedback very much appreciated, especially regarding the wording and verbosity (I opted to be verbose in the news entry but terse in the What's new entry per the "Rules for maintenance" listed in the file, I expect it'll be overwritten by an editor or a maintainer).  IMO:  What to do about 100.64.0.0/10?  Keep it as it is, and document it? I see you did that in [#113186](https://github.com/python/cpython/pull/113186).  Here's the thing: after some thinking I realized I actually would like to fix that one too – [#113186](https://github.com/python/cpython/pull/113186) documents the status quo but I believe we can (and IMO should) still improve it.  So I went ahead and fixed it as well. I don't think it deserves the kind of special, not quite consistent treatment it's been getting.  The fix is self-contained in a single commit which can be reverted away if you (or any else) tell me it doesn't belong in this PR or it otherwise becomes a blocker – I'd rather have this PR merged without the shared address space fix than not have it merged at all.  Happy to update the PR description to reflect the above when we know the final shape of this change. |
| --- |

All reactions

Sorry, something went wrong.

[![@encukou](https://avatars.githubusercontent.com/u/302922?s=80&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou)

Copy link

Member

### **[encukou](/encukou)** commented [Mar 20, 2024](#issuecomment-2009610277)

| Thank you! This looks great. (I haven't checked details like the individual numbers in this pass.)  Feedback [for changelogs] very much appreciated, especially regarding the wording and verbosity  It looks fine, but it would be even better to you can link from the less-verbose docs to the details. Then the details only need to be in one place.  The fix is self-contained in a single commit which can be reverted away if you (or any else) tell me it doesn't belong in this PR or it otherwise becomes a blocker  Yup, I'll be the one to tell you. Please don't do that in this PR. We squash every PR into a single commit; this change would be better as its own revertable commit. Also, I'm not really an expert on ipaddress, and I don't feel as comfortable reviewing this change. |
| --- |

All reactions

Sorry, something went wrong.

[![encukou](https://avatars.githubusercontent.com/u/302922?s=60&v=4)](/encukou)

**[encukou](/encukou)**
reviewed
[Mar 20, 2024](#pullrequestreview-1948937367)

 [View reviewed changes](/python/cpython/pull/113179/files/d3ee80d34bbac907e96b37ed64ae9252c71f36a0)

[Misc/NEWS.d/next/Library/2024-03-14-01-38-44.gh-issue-113171.VFnObz.rst](/python/cpython/pull/113179/files/d3ee80d34bbac907e96b37ed64ae9252c71f36a0#diff-2d6ca0985b215bccb49c607530d008bc3014490e8ac3d6b3e51f32aa94f2c1d7)
Outdated

Show resolved

Hide resolved

 [jstasiak](/jstasiak)
added 2 commits
[March 22, 2024 01:10](#commits-pushed-965e3a0)

[![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak)

`[Revert "Actually fix the shared address space too"](/python/cpython/pull/113179/commits/965e3a0ef9b5c28c4fcefbd3c0160b641cfe565e "Revert \"Actually fix the shared address space too\"

Leaving this for a separate PR (possibly).

This reverts commit d3ee80d34bbac907e96b37ed64ae9252c71f36a0.")`
 …

`[965e3a0](/python/cpython/pull/113179/commits/965e3a0ef9b5c28c4fcefbd3c0160b641cfe565e)`

```
Leaving this for a separate PR (possibly).

This reverts commit [d3ee80d](https://github.com/jstasiak/cpython/commit/d3ee80d34bbac907e96b37ed64ae9252c71f36a0).
```

[![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak)

`[Make the news entry nicer](/python/cpython/pull/113179/commits/5f41fffb6837307c83fa214039d93c4b54fb9ecd "Make the news entry nicer")`

`[5f41fff](/python/cpython/pull/113179/commits/5f41fffb6837307c83fa214039d93c4b54fb9ecd)`

[![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=80&v=4)](/jstasiak)

Copy link

Contributor

Author

### **[jstasiak](/jstasiak)** commented [Mar 22, 2024](#issuecomment-2014091135)

| Done and done. |
| --- |

All reactions

Sorry, something went wrong.

 Hide details
View details

[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou)
[encukou](/encukou)
merged commit [`40d75c2`](/python/cpython/commit/40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f)
into
python:main

[Mar 22, 2024](https://github.com/python/cpython/pull/113179#event-12218366249)
33 checks passed

[![@encukou](https://avatars.githubusercontent.com/u/302922?s=80&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou)

Copy link

Member

### **[encukou](/encukou)** commented [Mar 22, 2024](#issuecomment-2015499016)

| Looks good, thank you! |
| --- |

 🚀
1
 jstasiak reacted with rocket emoji

All reactions

* 🚀
  1 reaction

Sorry, something went wrong.

[![@bedevere-app](https://avatars.githubusercontent.com/in/388350?s=40&v=4)](/apps/bedevere-app)
[bedevere-app](/apps/bedevere-app)
bot
removed
the
[awaiting review](/python/cpython/labels/awaiting%20review)
label
[Mar 22, 2024](#event-12218366715)

[adorilson](/adorilson)
pushed a commit
to adorilson/cpython
that referenced
this pull request
[Mar 25, 2024](#ref-commit-364f3b0)
[![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak) [![@adorilson](https://avatars.githubusercontent.com/u/169837?s=40&v=4)](/adorilson)

`[pythonGH-113171](https://github.com/python/cpython/issues/113171)[: Fix "private" (non-global) IP address ranges (](/adorilson/cpython/commit/364f3b020ffde37fbd69c452215fa84e746cc06e "GH-113171: Fix \"private\" (non-global) IP address ranges (GH-113179)

* GH-113171: Fix \"private\" (really non-global) IP address ranges

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

I left 100.64.0.0/10 alone, for now, as it's been made special in [1]
and I'm not sure if we want to undo that as I don't quite understand the
motivation behind it.

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602")[python…](https://github.com/python/cpython/pull/113179)`
…

`[364f3b0](/adorilson/cpython/commit/364f3b020ffde37fbd69c452215fa84e746cc06e)`

```
[…GH-113179](https://github.com/python/cpython/pull/113179))

* [pythonGH-113171](https://github.com/python/cpython/issues/113171): Fix "private" (really non-global) IP address ranges

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

I left 100.64.0.0/10 alone, for now, as it's been made special in [1]
and I'm not sure if we want to undo that as I don't quite understand the
motivation behind it.

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] [python#61602](https://github.com/python/cpython/issues/61602)
```

[NGRsoftlab](/NGRsoftlab)
pushed a commit
to NGRsoftlab/cpython
that referenced
this pull request
[Apr 2, 2024](#ref-commit-1b5fe4c)
[![@ngr-ilmarh](https://avatars.githubusercontent.com/u/161701313?s=40&v=4)](/ngr-ilmarh)

`[Squashed commit of the following:](/NGRsoftlab/cpython/commit/1b5fe4cad096e32efee3a0477ef6f277ec2a2b96 "Squashed commit of the following:

commit 9dae05ee59eeba0e67af2a46f2a2907c9f8d7e4a
Author: Moshe Kaplan <mosheekaplan@gmail.com>
Date:   Mon Apr 1 15:53:00 2024 -0400

    Docs: specify XML document name in xml.etree.elementtree example (#24223)

commit fc2071687b708598264a3403b7f9104667c1092f
Author: Matthew Davis <7035647+mdavis-xyz@users.noreply.github.com>
Date:   Mon Apr 1 21:49:14 2024 +0200

    Docs: add more links to PIPE in subprocess docs (#25416)

commit fc8007ee3635db6ab73e132ebff987c910b6d538
Author: Barney Gale <barney.gale@gmail.com>
Date:   Mon Apr 1 20:37:41 2024 +0100

    GH-117337: Deprecate `glob.glob0()` and `glob.glob1()`. (#117371)

    These undocumented functions are no longer used by `msilib`, so there's no
    reason to keep them around.

commit c741ad3537193c63fe697a8f0316aecd45eeb9ba
Author: Justin Turner Arthur <justinarthur@gmail.com>
Date:   Mon Apr 1 12:07:29 2024 -0500

    gh-77714: Provide an async iterator version of as_completed (GH-22491)

    * as_completed returns object that is both iterator and async iterator
    * Existing tests adjusted to test both the old and new style
    * New test to ensure iterator can be resumed
    * New test to ensure async iterator yields any passed-in Futures as-is

    Co-authored-by: Serhiy Storchaka <storchaka@gmail.com>
    Co-authored-by: Guido van Rossum <gvanrossum@gmail.com>

commit ddf814db744006e0f42328aa15ace97c9d8ad681
Author: Guido van Rossum <guido@python.org>
Date:   Mon Apr 1 09:13:38 2024 -0700

    Silence compiler warnings in gc.c (#117422)

commit 179869af922252a0c1cef65fd2923856895e7d1b
Author: Petr Viktorin <encukou@gmail.com>
Date:   Mon Apr 1 17:01:22 2024 +0200

    gh-94808: Fix refcounting in PyObject_Print tests (GH-117421)

commit dd44ab994b7262f0704d64996e0a1bc37b233407
Author: neonene <53406459+neonene@users.noreply.github.com>
Date:   Mon Apr 1 22:28:14 2024 +0900

    gh-117142: ctypes: Unify meta tp slot functions (GH-117143)

    Integrates the following ctypes meta tp slot functions:
    * `CDataType_traverse()` into `CType_Type_traverse()`.
    * `CDataType_clear()` into `CType_Type_clear()`.
    * `CDataType_dealloc()` into `CType_Type_dealloc()`.
    * `CDataType_repeat()` into `CType_Type_repeat()`.

commit 3de09cadde788065a4f2d45117e789c9353bbd12
Author: Steve (Gadget) Barnes <gadgetsteve@hotmail.com>
Date:   Mon Apr 1 14:02:07 2024 +0100

    gh-91565: Replace bugs.python.org links with Devguide/GitHub ones  (GH-91568)

    Co-authored-by: Hugo van Kemenade <hugovk@users.noreply.github.com>
    Co-authored-by: Oleg Iarygin <oleg@arhadthedev.net>
    Co-authored-by: Petr Viktorin <encukou@gmail.com>
    Co-authored-by: Ezio Melotti <ezio.melotti@gmail.com>

commit 90c3c68a658db6951b77a5be50088ec2f6adc8eb
Author: MonadChains <monadchains@gmail.com>
Date:   Mon Apr 1 13:52:25 2024 +0100

    gh-94808:Improve coverage of PyObject_Print (GH-98749)

commit 348cf6e0078eae156c503e8f61ef5e27ae28e57b
Author: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Date:   Mon Apr 1 11:14:37 2024 +0000

    Bump mypy from 1.8.0 to 1.9.0 in /Tools (#117418)

    Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
    Co-authored-by: Alex Waygood <Alex.Waygood@Gmail.com>

commit 9b403fb559bfce93a478937e0ef7e539a9a95283
Author: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Date:   Mon Apr 1 11:05:14 2024 +0000

    build(deps-dev): bump types-psutil from 5.9.5.20240205 to 5.9.5.20240316 in /Tools (#117417)

    Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
    Co-authored-by: Alex Waygood <Alex.Waygood@Gmail.com>

commit 93c7d9d17b571b6a181af7c02830d29819535c35
Author: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Date:   Mon Apr 1 11:38:38 2024 +0100

    build(deps-dev): bump types-setuptools from 69.1.0.20240301 to 69.2.0.20240317 in /Tools (#117419)

    Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

commit 3bb12e407c183946471272f8aee098e54e62a333
Author: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Date:   Mon Apr 1 09:54:33 2024 +0000

    build(deps): bump actions/add-to-project from 0.6.0 to 1.0.0 (#117415)

    Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

commit 56e99307c49adcc6df355f8070229371c97d654f
Author: Adorilson Bezerra <adorilson@gmail.com>
Date:   Sun Mar 31 23:34:54 2024 +0100

    Doc: printf-style library/stdtype improvements (#16741)

commit 18e12641a61a88f7d08b2114ebe965892c6661c5
Author: Raymond Hettinger <rhettinger@users.noreply.github.com>
Date:   Sun Mar 31 16:09:22 2024 -0500

    gh-117387 Remove hash mark from introductory text (#117409)

commit a32d6939486d7f90ee57e215077f6116e19de24d
Author: Deborah <32307299+dlwrnc@users.noreply.github.com>
Date:   Sun Mar 31 22:11:48 2024 +0200

    gh-102190: Add additional zipfile `pwd=` arg docstrings (gh-102195)

    This just documents the parameter that already exists.

    ---------

    Co-authored-by: Gregory P. Smith <greg@krypto.org>
    Co-authored-by: Erlend E. Aasland <erlend.aasland@protonmail.com>

commit 262445358e21c56d7c68e3ee76c13e469d2ea348
Author: Shantanu <12621235+hauntsaninja@users.noreply.github.com>
Date:   Sun Mar 31 12:02:48 2024 -0700

    Link to the Python type system specification (#117400)

commit 752e18389ed03087b51b38eac9769ef8dfd167b7
Author: Barney Gale <barney.gale@gmail.com>
Date:   Sun Mar 31 19:14:48 2024 +0100

    GH-114575: Rename `PurePath.pathmod` to `PurePath.parser` (#116513)

    And rename the private base class from `PathModuleBase` to `ParserBase`.

commit bfc57d43d8766120ba0c8f3f6d7b2ac681a81d8a
Author: Sam Gross <colesbury@gmail.com>
Date:   Fri Mar 29 18:58:08 2024 -0400

    gh-117303: Don't detach in `PyThreadState_DeleteCurrent()` (#117304)

    This fixes a crash in `test_threading.test_reinit_tls_after_fork()` when
    running with the GIL disabled. We already properly handle the case where
    the thread state is `_Py_THREAD_ATTACHED` in `tstate_delete_common()` --
    we just need to remove an assertion.

    Keeping the thread attached means that a stop-the-world pause, such as
    for a `fork()`, won't commence until we remove our thread state from the
    interpreter's linked list. This prevents a crash when the child process
    tries to clean up the dead thread states.

commit 05e0b67a43c5c1778dc2643c8b7c12864e135999
Author: Erlend E. Aasland <erlend@python.org>
Date:   Fri Mar 29 21:23:28 2024 +0100

    gh-116664: In _warnings.c, make filters_version access thread-safe (#117374)

    - assert that the lock is held in already_warned()
    - protect 'filters_version' increment in warnings_filters_mutated_impl()

commit 019143fecbfc26e69800d28d2a9e3392a051780b
Author: Jason R. Coombs <jaraco@jaraco.com>
Date:   Fri Mar 29 16:06:09 2024 -0400

    gh-117348: Refactored RawConfigParser._read for similicity and comprehensibility (#117372)

    * Extract method for _read_inner, reducing complexity and indentation by 1.

    * Extract method for _raise_all and yield ParseErrors from _read_inner.

    Reduces complexity by 1 and reduces touch points for handling errors in _read_inner.

    * Prefer iterators to splat expansion and literal indexing.

    * Extract method for _strip_comments. Reduces complexity by 7.

    * Model the file lines in a class to encapsulate the comment status and cleaned value.

    * Encapsulate the read state as a dataclass

    * Extract _handle_continuation_line and _handle_rest methods. Reduces complexity by 8.

    * Reindent

    * At least for now, collect errors in the ReadState

    * Check for missing section header separately.

    * Extract methods for _handle_header and _handle_option. Reduces complexity by 6.

    * Remove unreachable code. Reduces complexity by 4.

    * Remove unreachable branch

    * Handle error condition early. Reduces complexity by 1.

    * Add blurb

    * Move _raise_all to ParsingError, as its behavior is most closely related to the exception class and not the reader.

    * Split _strip* into separate methods.

    * Refactor _strip_full to compute the strip just once and use 'not any' to determine the factor.

    * Replace use of 'sys.maxsize' with direct computation of the stripped value.

    * Extract has_comments as a dynamic property.

    * Implement clean as a cached property.

    * Model comment prefixes in the RawConfigParser within a prefixes namespace.

    * Use a regular expression to search for the first match.

    Avoids mutating variables and tricky logic and over-computing all of the starts when only the first is relevant.

commit 01bd74eadbc4ff839d39762fae6366f50c1e116e
Author: Sam Gross <colesbury@gmail.com>
Date:   Fri Mar 29 15:33:06 2024 -0400

    gh-117300: Use stop the world to make `sys._current_frames` and `sys._current_exceptions` thread-safe. (#117301)

    This adds a stop the world pause to make the two functions thread-safe
    when the GIL is disabled in the free-threaded build.

    Additionally, the main test thread may call `sys._current_exceptions()` as
    soon as `g_raised.set()` is called. The background thread may not yet reach
    the `leave_g.wait()` line.

commit 94c97423a9c4969f8ddd4a3aa4aacb99c4d5263d
Author: Guido van Rossum <guido@python.org>
Date:   Fri Mar 29 11:31:09 2024 -0700

    Fix broken format in error for bad input in summarize_stats.py (#117375)

    When you pass the script a non-existent input file, you get a TypeError instead of the intended ValueError.

commit 5d21d884b6ffa45dac50a5f9a07c41356a8478b4
Author: mpage <mpage@meta.com>
Date:   Fri Mar 29 10:42:02 2024 -0700

    gh-111926: Avoid locking in PyType_IsSubtype (#117275)

    Read the MRO in a thread-unsafe way in `PyType_IsSubtype` to avoid locking. Fixing this is tracked in #117306.

    The motivation for this change is in support of making weakrefs thread-safe in free-threaded builds:

    `WeakValueDictionary` uses a special dictionary function, `_PyDict_DelItemIf`
    to remove dead weakrefs from the dictionary. `_PyDict_DelItemIf` removes a key
    if a user supplied predicate evaluates to true for the value associated with
    the key. Crucially for the `WeakValueDictionary` use case, the predicate
    evaluation + deletion sequence is atomic, provided that the predicate doesn’t
    suspend. The predicate used by `WeakValueDictionary` includes a subtype check,
    which we must ensure doesn't suspend in free-threaded builds.

commit 19c1dd60c5b53fb0533610ad139ef591294f26e8
Author: Sam Gross <colesbury@gmail.com>
Date:   Fri Mar 29 13:35:43 2024 -0400

    gh-117323: Make `cell` thread-safe in free-threaded builds (#117330)

    Use critical sections to lock around accesses to cell contents. The critical sections are no-ops in the default (with GIL) build.

commit 397d88db5e9ab2a43de3fdf5f8b973a949edc405
Author: Sam Gross <colesbury@gmail.com>
Date:   Fri Mar 29 13:34:04 2024 -0400

    gh-117344: Skip flaky tests in free-threaded build (#117355)

    The tests are not reliable with the GIL disabled. In theory, they can
    fail with the GIL enabled too, but the failures are much more likely
    with the GIL disabled.

commit f05fb2e65c2dffdfae940f2707765c4994925205
Author: Sam Gross <colesbury@gmail.com>
Date:   Fri Mar 29 13:33:04 2024 -0400

    gh-112529: Don't untrack tuples or dicts with zero refcount (#117370)

    The free-threaded GC sometimes sees objects with zero refcount. This can
    happen due to the delay in merging biased reference counting fields,
    and, in the future, due to deferred reference counting. We should not
    untrack these objects or they will never be collected.

    This fixes the refleaks in the free-threaded build.

commit ddf95b5f16031cdbd0d728e55eb06dff002a8678
Author: Erlend E. Aasland <erlend@python.org>
Date:   Fri Mar 29 18:26:06 2024 +0100

    gh-116664: Fix unused var warnings in _warnings.c in non-free-threaded builds (#117373)

    The warnings were introduced by commit c1712ef06.

commit 0fa571dbcdf19b541276cb00bb929381930467b2
Author: Tian Gao <gaogaotiantian@hotmail.com>
Date:   Fri Mar 29 09:02:01 2024 -0700

    Refactor pdb executable targets (#112570)

    Co-authored-by: Jason R. Coombs <jaraco@jaraco.com>

commit 54f7e14500471d1c46fb553adb3ca24cd1fef084
Author: Pedro Lacerda <pslacerda@users.noreply.github.com>
Date:   Fri Mar 29 12:05:00 2024 -0300

    gh-66449: configparser: Add support for unnamed sections (#117273)

    Co-authored-by: Jason R. Coombs <jaraco@jaraco.com>

commit d9cfe7e565a6e2dc15747a904736264e31a10be4
Author: Nikita Sobolev <mail@sobolevn.me>
Date:   Fri Mar 29 14:14:25 2024 +0300

    gh-117166: Ignore empty and temporary dirs in `test_makefile` (#117190)

commit 35b6c4a4da201a947b2ceb96ae4c0d83d4d2df4f
Author: Victor Stinner <vstinner@python.org>
Date:   Fri Mar 29 11:25:17 2024 +0100

    gh-117347: Fix test_clinic side effects (#117363)

    Save/restore converters in ClinicWholeFileTest and
    ClinicExternalTest.

commit 7e2fef865899837c47e91ef0180fa59eb03e840b
Author: neonene <53406459+neonene@users.noreply.github.com>
Date:   Fri Mar 29 18:40:48 2024 +0900

    gh-117142: ctypes: Migrate global vars to module state (GH-117189)

commit 2e9be80c99f635c2f7761e8356b0260922d6e7a6
Author: Gregory P. Smith <greg@krypto.org>
Date:   Thu Mar 28 17:58:37 2024 -0700

    Fix reversed assertRegex checks in test_ssl. (#117351)

commit 8eec7ed714e65d616573b7331780b0aa43c6ed6a
Author: 傅立业（Chris Fu） <17433201@qq.com>
Date:   Fri Mar 29 08:19:20 2024 +0800

    gh-117110: Fix subclasses of typing.Any with custom constructors (#117111)

commit a17f313e3958e825db9a83594c8471a984316536
Author: Christopher Chianelli <christopher@timefold.ai>
Date:   Thu Mar 28 18:26:56 2024 -0400

    gh-117339: Use NULL instead of None for LOAD_SUPER_ATTR in dis docs (GH-117343)

commit 26d328b2ba26374fb8d9ffe8215ecef7c5e3f7a2
Author: Michael Droettboom <mdboom@gmail.com>
Date:   Thu Mar 28 18:23:08 2024 -0400

    GH-117121: Add pystats to JIT builds (GH-117346)

commit 14f1ca7d5363386163839b31ce987423daecc3de
Author: Nice Zombies <nineteendo19d0@gmail.com>
Date:   Thu Mar 28 22:20:08 2024 +0100

    gh-117335: Handle non-iterables for `ntpath.commonpath` (GH-117336)

commit 18cf239e39e25e6cef50ecbb7f197a82f8920ff5
Author: Brandt Bucher <brandtbucher@microsoft.com>
Date:   Thu Mar 28 14:02:34 2024 -0700

    Increase the JIT CI timeouts to 75 minutes (GH-117342)

commit 29829b58a8328a7c2ccacaa74c1d7d120a5e5ca5
Author: Malcolm Smith <smith@chaquo.com>
Date:   Thu Mar 28 19:59:12 2024 +0000

    gh-117294: Report DocTestCase as skipped if all examples in the doctest are skipped (GH-117297)

commit efcc96844e7c66fcd6c23ac2d557ca141614ce9a
Author: Tian Gao <gaogaotiantian@hotmail.com>
Date:   Thu Mar 28 11:23:29 2024 -0700

    gh-69201: Separate stdout and stderr stream in test_pdb (#117308)

commit 6702d2bf6edcd5b5415e17837383623b9d76a5b8
Author: Victor Stinner <vstinner@python.org>
Date:   Thu Mar 28 17:40:58 2024 +0100

    gh-114331: Skip decimal test_maxcontext_exact_arith on s390x (#117326)

commit c1712ef066321c01bf09cba3f22fc474b5b8dfa7
Author: Erlend E. Aasland <erlend@python.org>
Date:   Thu Mar 28 16:05:08 2024 +0100

    gh-116664: Make module state Py_SETREF's in _warnings thread-safe (#116959)

    Mark the swap operations as critical sections.

    Add an internal Py_BEGIN_CRITICAL_SECTION_MUT API that takes a PyMutex
    pointer instead of a PyObject pointer.

commit 9a388b9a64927c372d85f0eaec3de9b7320a6fb5
Author: Joachim Wuttke <j.wuttke@fz-juelich.de>
Date:   Thu Mar 28 14:43:07 2024 +0100

    bpo-43848: explain optional argument mtime in gzip.py. (GH-25410)

    Co-authored-by: Jelle Zijlstra <jelle.zijlstra@gmail.com>

commit 8dbfdb2957a7baade3a88661517f163ad694c39f
Author: Sam Gross <colesbury@gmail.com>
Date:   Thu Mar 28 09:28:39 2024 -0400

    gh-110481: Fix biased reference counting queue initialization. (#117271)

    The biased reference counting queue must be initialized from the bound
    (active) thread because it uses `_Py_ThreadId()` as the key in a hash
    table.

commit 9a1e55b8c5723206116f7016921be3937ef2f4e5
Author: Chris Markiewicz <effigies@gmail.com>
Date:   Thu Mar 28 06:59:31 2024 -0400

    gh-117178: Recover lazy loading of self-referential modules (#117179)

commit 4c71d51a4b7989fc8754ba512c40e21666f9db0d
Author: Jelle Zijlstra <jelle.zijlstra@gmail.com>
Date:   Thu Mar 28 04:30:31 2024 -0600

    gh-117266: Fix crashes on user-created AST subclasses (GH-117276)

    Fix crashes on user-created AST subclasses

commit 8cb7d7ff86a1a2d41195f01ba4f218941dd7308c
Author: Gregory P. Smith <greg@krypto.org>
Date:   Thu Mar 28 03:11:58 2024 -0700

    gh-117310: Remove extra DECREF on \"no ciphers\" error path in `_ssl._SSLContext` constructor (#117309)

    Remove extra self DECREF on ssl \"no ciphers\" error path.

    This doesn't come up in practice because nobody links against a broken
    OpenSSL library that provides nothing.

commit 6c8ac8a32fd6de1960526561c44bc5603fab0f3e
Author: Erlend E. Aasland <erlend@python.org>
Date:   Thu Mar 28 09:40:37 2024 +0100

    gh-116303: Handle disabled test modules in test.support helpers (#116482)

    Make sure test.support helpers skip iso. failing if test extension
    modules are disabled. Also log TEST_MODULES in test.pythoninfo.

commit 0f27672c5002de96c9f1228b12460d5ce3f1d190
Author: Russell Keith-Magee <russell@keith-magee.com>
Date:   Thu Mar 28 16:13:13 2024 +0800

    gh-114099: Add documentation for iOS platform (GH-117057)

    Co-authored-by: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>
    Co-authored-by: Jacob Coffee <jacob@z7x.org>
    Co-authored-by: Malcolm Smith <smith@chaquo.com>
    Co-authored-by: Ned Deily <nad@python.org>

commit f006338017cfbf846e8f7391b9ee5f69df8dc620
Author: Russell Keith-Magee <russell@keith-magee.com>
Date:   Thu Mar 28 15:59:33 2024 +0800

    gh-114099: Additions to standard library to support iOS (GH-117052)

    Co-authored-by: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>
    Co-authored-by: Malcolm Smith <smith@chaquo.com>
    Co-authored-by: Ned Deily <nad@python.org>

commit b44898299a2ed97045c270f6474785da2ff07ced
Author: Tim Hatch <tim@timhatch.com>
Date:   Wed Mar 27 23:54:51 2024 -0700

    gh-89739: gh-77140: Support zip64 in zipimport (GH-94146)

    * Reads zip64 files as produced by the zipfile module
    * Include tests (somewhat slow, however, because of the need to create \"large\" zips)
    * About the same amount of strictness reading invalid zip files as zipfile has
    * Still works on files with prepended data (like pex)

    There are a lot more test cases at https://github.com/thatch/zipimport64/ that give me confidence that this works for real-world files.

    Fixes #89739 and #77140.

    ---------

    Co-authored-by: Itamar Ostricher <itamarost@gmail.com>
    Reviewed-by: Gregory P. Smith <greg@krypto.org>

commit 2cedd25c14d3acfdcb5e8ee55132ce3e334ab8fe
Author: Illia Volochii <illia.volochii@gmail.com>
Date:   Thu Mar 28 08:46:01 2024 +0200

    Revert \"gh-116886: Temporarily disable CIfuzz (memory) (GH-117018)\" (GH-117289)

    This reverts commit 1ab0d0b1167d78bf19661a3b5e533a2b68a57604.

    This reverts #117018.

    I expect the issue to be fixed based on https://github.com/google/oss-fuzz/pull/11708#issuecomment-2006442396 and https://github.com/actions/runner-images/issues/9491.

commit eefff682f09394fe4f18b7d7c6ac4c635caadd02
Author: Malcolm Smith <smith@chaquo.com>
Date:   Wed Mar 27 22:11:44 2024 +0000

    gh-108277: Make test_os tolerate 10 ms diff for timerfd on Android emulators (#117223)

commit 7aa89bc43e0bcf49eee5a39b5a7ba8f996f20d00
Author: Victor Stinner <vstinner@python.org>
Date:   Wed Mar 27 23:10:14 2024 +0100

    gh-113317: Change how Argument Clinic lists converters (#116853)

    * Add a new create_parser_namespace() function for
      PythonParser to pass objects to executed code.
    * In run_clinic(), list converters using 'converters' and
      'return_converters' dictionarties.
    * test_clinic: add 'object()' return converter.
    * Use also create_parser_namespace() in eval_ast_expr().

    Co-authored-by: Erlend E. Aasland <erlend@python.org>

commit 669ef49c7d42f35da6f7ee280102353b9b37f83e
Author: Seth Michael Larson <seth@python.org>
Date:   Wed Mar 27 16:56:14 2024 -0500

    gh-99108: Update and check HACL* version information (GH-117295)

    * Update and check HACL* version information

commit 262fb911ab7df8e890ebd0efb0773c3e0b5a757f
Author: Irit Katriel <1055913+iritkatriel@users.noreply.github.com>
Date:   Wed Mar 27 17:38:19 2024 +0000

    gh-117288: Allocate fewer label IDs in _PyCfg_ToInstructionSequence (#117290)

commit 74c8568d07719529b874897598d8b3bc25ff0434
Author: Malcolm Smith <smith@chaquo.com>
Date:   Wed Mar 27 16:53:27 2024 +0000

    gh-71042: Add `platform.android_ver` (#116674)

commit ce00de4c8cd39816f992e749c1074487d93abe9d
Author: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>
Date:   Wed Mar 27 16:46:35 2024 +0200

    gh-117225: doctest: only print \"and X failed\" when non-zero, don't pluralise \"1 items\" (#117228)

commit 92397d5ead38dde4154e70d00f24973bcf2a925a
Author: Raymond Hettinger <rhettinger@users.noreply.github.com>
Date:   Wed Mar 27 09:04:32 2024 -0500

    Add statistics recipe for sampling from an estimated probability density distribution (#117221)

commit b3e8c78ed7aa9bbd1084375587b99200c687cec9
Author: Tian Gao <gaogaotiantian@hotmail.com>
Date:   Tue Mar 26 18:20:12 2024 -0700

    gh-113548: Allow CLI arguments to `pdb -m` (#113557)

commit 48c0b05cf0dd2db275bd4653f84aa36c22bddcd2
Author: Adorilson Bezerra <adorilson@gmail.com>
Date:   Tue Mar 26 19:08:08 2024 +0000

    Change links on the index page (#117230)

commit af1b0e94400d1bf732466d675054df8cf7dfb62d
Author: AN Long <aisk@users.noreply.github.com>
Date:   Wed Mar 27 02:26:48 2024 +0800

    gh-104242: Enable test_is_char_device_true in pathlib test on all platform (GH-116983)

commit 79be75735c9d77972112cecc8d7e1af28c176ed0
Author: Irit Katriel <1055913+iritkatriel@users.noreply.github.com>
Date:   Tue Mar 26 15:18:17 2024 +0000

    gh-115775: Compiler adds __static_attributes__ field to classes (#115913)

commit 70969d53a77a8a190c40a30419e772bc874a4f62
Author: Antonio <57417288+amaddio@users.noreply.github.com>
Date:   Tue Mar 26 15:10:29 2024 +0100

    gh-97901 add missing text/rtf to mimetypes (GH-97902)

    Co-authored-by: Noam Cohen <noam@noam.me>

commit 4ec347760f98b156c6a2d42ca397af6b0b6ecc50
Author: AN Long <aisk@users.noreply.github.com>
Date:   Tue Mar 26 22:09:57 2024 +0800

    gh-115538: Use isolate mode when running venv test_multiprocessing_recursion() (#117116)

    Co-authored-by: Victor Stinner <vstinner@python.org>

commit 743f2c68f478279e1e56577fe95a0ed112b9abc5
Author: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>
Date:   Tue Mar 26 16:09:09 2024 +0200

    pre-commit: add `check-case-conflict` and `check-merge-conflict` (#117259)

commit 4abca7e1e7e2764faf20c7e677ea5c9ea9dbffe2
Author: Paulo Neves <ptsneves@users.noreply.github.com>
Date:   Tue Mar 26 13:37:50 2024 +0100

    gh-98966: Handle stdout=subprocess.STDOUT (GH-98967)

    Explicitly handle the case where stdout=STDOUT
    as otherwise the existing error handling gets
    confused and reports hard to understand errors.

    Signed-off-by: Paulo Neves <ptsneves@gmail.com>

commit 9654daf793b534b44a831c80f43505ab9e380f1f
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Tue Mar 26 13:26:45 2024 +0200

    gh-66543: Fix mimetype.guess_type() (GH-117217)

    Fix parsing of the following corner cases:

    * URLs with only a host name
    * URLs containing a fragment
    * URLs containing a query
    * filenames with only a UNC sharepoint on Windows

    Co-authored-by: Dong-hee Na <donghee.na92@gmail.com>

commit 8bef34f625e21886b1c64544c060e19ee2e229bf
Author: Mark Shannon <mark@hotpy.org>
Date:   Tue Mar 26 11:11:42 2024 +0000

    GH-117108: Set the \"old space bit\" to \"visited\" for all young objects  (#117213)

    Change old space bit of young objects from 0 to gcstate->visited_space.
    This ensures that any object created *and* collected during cycle GC has the bit set correctly.

commit bf82f77957a31c3731b4ec470c406f5708ca9ba3
Author: Mark Shannon <mark@hotpy.org>
Date:   Tue Mar 26 09:35:11 2024 +0000

    GH-116422: Tier2 hot/cold splitting (GH-116813)

    Splits the \"cold\" path, deopts and exits, from the \"hot\" path, reducing the size of most jitted instructions, at the cost of slower exits.

commit 61599a48f52e951d8813877ee311d2a830ba2cd8
Author: Pablo Galindo Salgado <Pablogsal@gmail.com>
Date:   Tue Mar 26 09:30:46 2024 +0000

    bpo-24612: Improve syntax error for 'not' after an operator (GH-28170)

    Co-authored-by: Lysandros Nikolaou <lisandrosnik@gmail.com>

commit 771902c257372e6c4df1ead4e8c46308561db7a7
Author: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>
Date:   Tue Mar 26 11:13:32 2024 +0200

    gh-83845: Add tests for operator module (#115883)

    Co-authored-by: Karthikeyan Singaravelan <tir.karthi@gmail.com>

commit ea9a296fce2f786b4cf43c7924e5de01061f27ca
Author: yevgeny hong <hongyevgeny@gmail.com>
Date:   Tue Mar 26 16:45:43 2024 +0900

    gh-115627: Fix PySSL_SetError handling SSL_ERROR_SYSCALL (GH-115628)

    Python 3.10 changed from using SSL_write() and SSL_read() to SSL_write_ex() and
    SSL_read_ex(), but did not update handling of the return value.

    Change error handling so that the return value is not examined.
    OSError (not EOF) is now returned when retval is 0.

    According to *recent* man pages of all functions for which we call
    PySSL_SetError, (in OpenSSL 3.0 and 1.1.1), their return value should
    be used to determine whether an error happened (i.e. if PySSL_SetError
    should be called), but not what kind of error happened (so,
    PySSL_SetError shouldn't need retval). To get the error,
    we need to use SSL_get_error.

    Co-authored-by: Serhiy Storchaka <storchaka@gmail.com>
    Co-authored-by: Petr Viktorin <encukou@gmail.com>

commit d52bdfb19fadd7614a0e5abaf68525fc7300e841
Author: Victor Stinner <vstinner@python.org>
Date:   Tue Mar 26 08:35:59 2024 +0100

    gh-83434: Disable XML in regrtest when -R option is used (#117232)

commit 9f74e86c78853c101a23e938f8e32ea838d8f62e
Author: Sebastian Pipping <sebastian@pipping.org>
Date:   Tue Mar 26 02:48:27 2024 +0100

    gh-117187: Fix XML tests for vanilla Expat <2.6.0 (GH-117203)

    This fixes XML unittest fallout from the https://github.com/python/cpython/issues/115398 security fix.  When configured using `--with-system-expat` on systems with older pre 2.6.0 versions of libexpat, our unittests were failing.

    * sax|etree: Simplify Expat version guard where simplifiable

    Idea by Matěj Cepl

    * sax|etree: Fix reparse deferral tests for vanilla Expat <2.6.0

    This *does not fix* the case of distros with an older version of libexpat with the 2.6.0 feature backported as a security fix.  (Ubuntu is a known example of this with its libexpat1 2.5.0-2ubunutu0.1 package)

commit 872e212378ef86392069034afd80bb53896fd93d
Author: Jonathan Protzenko <protz@microsoft.com>
Date:   Mon Mar 25 17:35:26 2024 -0700

    gh-99108: Refresh HACL*; update modules accordingly; fix namespacing (GH-117237)

    Pulls in a new update from https://github.com/hacl-star/hacl-star and fixes our C \"namespacing\" done by `Modules/_hacl/refresh.sh`.

commit 8945b7ff55b87d11c747af2dad0e3e4d631e62d6
Author: Eric V. Smith <ericvsmith@users.noreply.github.com>
Date:   Mon Mar 25 19:59:14 2024 -0400

    gh-109870: Dataclasses: batch up exec calls (gh-110851)

    Instead of calling `exec()` once for each function added to a dataclass, only call `exec()` once per dataclass. This can lead to speed improvements of up to 20%.

commit 7ebad77ad65ab4d5d8d0c333256a882262cec189
Author: Raymond Hettinger <rhettinger@users.noreply.github.com>
Date:   Mon Mar 25 18:49:44 2024 -0500

    Sync main docs and docstring for median_grouped(). (gh-117214)

commit 0821923aa979a72464c5da8dfa53a719bba5801c
Author: Nice Zombies <nineteendo19d0@gmail.com>
Date:   Mon Mar 25 23:55:11 2024 +0100

    gh-117114: Make os.path.isdevdrive available on all platforms (GH-117115)

commit c2276176d543a2fc2d57709c2787f99850fbb073
Author: Adorilson Bezerra <adorilson@gmail.com>
Date:   Mon Mar 25 22:34:20 2024 +0000

    Add information about negative  indexes to sequence datamodel doc (#110903)

    Co-authored by Terry Jan Reedy

commit 23e4f80ce2a2bac50acd1785e791316d5b578b8d
Author: Mark Shannon <mark@hotpy.org>
Date:   Mon Mar 25 20:43:51 2024 +0000

    A few minor tweaks to get stats working and compiling cleanly. (#117219)

    Fixes a compilation error when configured with `--enable-pystats`,
    an array size issue, and an unused variable.

commit 507896d97dcff2d7999efa264b29d9003c525c49
Author: Victor Stinner <vstinner@python.org>
Date:   Mon Mar 25 17:32:20 2024 +0100

    gh-116936: Add PyType_GetModuleByDef() to the limited C API (#116937)

commit 0c1a42cf9c8cd0d4534d5c1d58f118ce7c5c446e
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Mon Mar 25 17:32:11 2024 +0200

    gh-87193: Support bytes objects with refcount > 1 in _PyBytes_Resize() (GH-117160)

    Create a new bytes object and destroy the old one if it has refcount > 1.

commit 01e7405da400e8997f8964d06cc414045e144681
Author: Tian Gao <gaogaotiantian@hotmail.com>
Date:   Mon Mar 25 08:18:09 2024 -0700

    gh-112948: Make pdb completion similar to repl completion (#112950)

commit 9db2a8f914ad59019d448cecc43b6d45f46424a0
Author: Raymond Hettinger <rhettinger@users.noreply.github.com>
Date:   Mon Mar 25 09:26:42 2024 -0500

    Minor markup and grammar fixes in the statistics docs (gh-117216)

commit eebea7e515462b503632ada74923ec3246599c9c
Author: Kirill Podoprigora <kirill.bast9@mail.ru>
Date:   Sun Mar 24 20:34:55 2024 +0200

    gh-117176: Fix compiler warning in Python/optimizer_bytecodes.c (GH-117199)

commit 83485a095363dad6c97b19af2826ca0c34343bfc
Author: Totally a booplicate <53382877+Booplicate@users.noreply.github.com>
Date:   Sun Mar 24 18:48:40 2024 +0300

    gh-112571: Move fish venv activation script into the common folder (GH-117169)

    pythongh-112571: allow using fish venv activation script on windows

    The fish shell can be used on windows under cygwin or msys2.
    This change moves the script to the common folder
    so the venv module will install it on both posix and nt systems (like the bash script).

commit 78a651fd7fbe7a3d1702e40f4cbfa72d87241ef0
Author: Terry Jan Reedy <tjreedy@udel.edu>
Date:   Sun Mar 24 11:38:34 2024 -0400

    gh-117194: Properly format 'base64' header in What's New (#117198)

    It needs 6, not 3, '-'s.

commit f267d5bf2a99fbeb26a720d1c87c1f0557424b14
Author: Kerim Kabirov <the.privat33r+gh@pm.me>
Date:   Sun Mar 24 14:59:14 2024 +0100

    GH-115986 Docs: promote pprint.pp usage as a default (#116614)

    Co-authored-by: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>

commit 39df7732178c8e8f75b12f069a3dbc1715c99995
Author: LilKS <1244886+LilKS@users.noreply.github.com>
Date:   Sun Mar 24 11:01:07 2024 +0100

    gh-101760: Improve the imaplib.IMAP4 example (#101764)

    Co-authored-by: Adam Turner <9087854+AA-Turner@users.noreply.github.com>

commit a1e948edba9ec6ba61365429857f7a087c5edf51
Author: Raymond Hettinger <rhettinger@users.noreply.github.com>
Date:   Sun Mar 24 11:35:58 2024 +0200

    Add cumulative option for the new statistics.kde() function. (#117033)

commit d610d821fd210dce63a1132c274ffdf8acc510bc
Author: Irit Katriel <1055913+iritkatriel@users.noreply.github.com>
Date:   Sat Mar 23 22:32:33 2024 +0000

    gh-112383: teach dis how to interpret ENTER_EXECUTOR (#117171)

commit 6c83352bfe78a7d567c8d76257df6eb91d5a7245
Author: Ken Jin <kenjin@python.org>
Date:   Sun Mar 24 06:19:17 2024 +0800

    gh-117180: Complete call sequence when trace stack overflow (GH-117184)

    ---------

    Co-authored-by: Peter Lazorchak <lazorchakp@gmail.com>
    Co-authored-by: Guido van Rossum <gvanrossum@users.noreply.github.com>
    Co-authored-by: Guido van Rossum <gvanrossum@gmail.com>

commit f11d0d8be8af28e1368c3c7c116218cf65ddf93e
Author: Erik Soma <stillusingirc@gmail.com>
Date:   Sat Mar 23 11:39:35 2024 -0400

    gh-91227: Ignore ERROR_PORT_UNREACHABLE in proactor recvfrom() (#32011)

commit 9967b568edd2e35b0415c14c7242f3ca2c0dc03d
Author: Victor Stinner <vstinner@python.org>
Date:   Sat Mar 23 13:01:20 2024 +0100

    gh-117008: Fix functools test_recursive_pickle() (#117009)

    Use support.infinite_recursion() in test_recursive_pickle() of
    test_functools to prevent a stack overflow on \"ARM64 Windows
    Non-Debug\" buildbot.

    Lower Py_C_RECURSION_LIMIT to 1,000 frames on Windows ARM64.

commit 72eea512b88f8fd68b7258242c37da963ad87360
Author: Barney Gale <barney.gale@gmail.com>
Date:   Fri Mar 22 19:14:09 2024 +0000

    GH-106747: Document another difference between `glob` and `pathlib`. (#116518)

    Document that `path.glob()` might return *path*, whereas
    `glob.glob(root_dir=path)` will never return an empty string corresponding
    to *path*.

commit e28477f214276db941e715eebc8cdfb96c1207d9
Author: Mark Shannon <mark@hotpy.org>
Date:   Fri Mar 22 18:43:25 2024 +0000

    GH-117108: Change the size of the GC increment to about 1% of the total heap size. (GH-117120)

commit e2e0b4b4b92694ba894e02b4a66fd87c166ed10f
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Fri Mar 22 20:19:10 2024 +0200

    gh-113024: C API: Add PyObject_GenericHash() function (GH-113025)

commit 567ab3bd15398c8c7b791f3e376ae3e3c0bbe079
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Fri Mar 22 20:08:00 2024 +0200

    gh-117084: Fix ZIP file extraction for directory entry names with backslashes on Windows (GH-117129)

commit 5a78f6e798d5c2af1dba2df6c9f1f1e5aac02a86
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Fri Mar 22 20:03:48 2024 +0200

    gh-117134: Microoptimize glob() for include_hidden=True (GH-117135)

commit 00baaa21de229a6db80ff2b84c2fd6ad1999a24c
Author: Vinay Sajip <vinay_sajip@yahoo.co.uk>
Date:   Fri Mar 22 17:25:51 2024 +0000

    [docs] Fix typo in docstring and add example to logging cookbook. (GH-117157)

commit 40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f
Author: Jakub Stasiak <jakub@stasiak.at>
Date:   Fri Mar 22 17:49:56 2024 +0100

    GH-113171: Fix \"private\" (non-global) IP address ranges (GH-113179)

    * GH-113171: Fix \"private\" (really non-global) IP address ranges

    The _private_networks variables, used by various is_private
    implementations, were missing some ranges and at the same time had
    overly strict ranges (where there are more specific ranges considered
    globally reachable by the IANA registries).

    This patch updates the ranges with what was missing or otherwise
    incorrect.

    I left 100.64.0.0/10 alone, for now, as it's been made special in [1]
    and I'm not sure if we want to undo that as I don't quite understand the
    motivation behind it.

    The _address_exclude_many() call returns 8 networks for IPv4, 121
    networks for IPv6.

    [1] https://github.com/python/cpython/issues/61602

commit 3be9b9d8722696b95555937bb211dc4cda714d56
Author: Steve Dower <steve.dower@python.org>
Date:   Fri Mar 22 15:00:50 2024 +0000

    Fix get_packagefamilyname helper function on Windows 32-bit (GH-117153)

commit 63d6f2623ef2aa90f51c6a928b96845b9b380d89
Author: NGRsoftlab <78017794+NGRsoftlab@users.noreply.github.com>
Date:   Fri Mar 22 14:25:38 2024 +0300

    gh-117068: Remove useless code in bytesio.c:resize_buffer() (GH-117069)

    Co-authored-by: i.khabibulin <i.khabibulin@ngrsoftlab.ru>

commit 42ae924d278c48a719fb0ab86357f3235a9f7ab9
Author: Petr Viktorin <encukou@gmail.com>
Date:   Fri Mar 22 10:42:18 2024 +0100

    gh-117127: glob tests: Reopen dir_fd to pick up directory changes (GH-117128)

commit 8383915031942f441f435a5ae800790116047b80
Author: Tim Peters <tim.peters@gmail.com>
Date:   Thu Mar 21 22:27:25 2024 -0500

    GH-116939: Rewrite binarysort() (#116940)

    Rewrote binarysort() for clarity.

    Also changed the signature to be more coherent (it was mixing sortslice with raw pointers).

    No change in method or functionality. However, I left some experiments in, disabled for now
    via `#if` tricks. Since this code was first written, some kinds of comparisons have gotten
    enormously faster (like for lists of floats), which changes the tradeoffs.

    For example, plain insertion sort's simpler innermost loop and highly predictable branches
    leave it very competitive (even beating, by a bit) binary insertion when comparisons are
    very cheap, despite that it can do many more compares. And it wins big on runs that
    are already sorted (moving the next one in takes only 1 compare then).

    So I left code for a plain insertion sort, to make future experimenting easier.

    Also made the maximum value of minrun a `#define` (``MAX_MINRUN`) to make
    experimenting with that easier too.

    And another bit of `#if``-disabled code rewrites binary insertion's innermost loop to
    remove its unpredictable branch. Surprisingly, this doesn't really seem to help
    overall. I'm unclear on why not. It certainly adds more instructions, but they're very
    simple, and it's hard to be believe they cost as much as a branch miss.

commit 97ba910e47ad298114800587979ce7beb0a705a3
Author: Guido van Rossum <guido@python.org>
Date:   Thu Mar 21 18:27:48 2024 -0700

    gh-108716:: Remove _PyStaticCode_Init/Fini (#117141)

    More deepfreeze cleanup.

commit b3d25df8d38b79310587da54dbd88b06a16d4904
Author: Eric Snow <ericsnowcurrently@gmail.com>
Date:   Thu Mar 21 18:20:20 2024 -0600

    gh-105716: Fix _PyInterpreterState_IsRunningMain() For Embedders (gh-117140)

    When I added _PyInterpreterState_IsRunningMain() and friends last year, I tried to accommodate applications that embed Python but don't call _PyInterpreterState_SetRunningMain() (not that they're expected to).  That mostly worked fine until my recent changes in gh-117049, where the subtleties with the fallback code led to failures; the change ended up breaking test_tools.test_freeze, which exercises a basic embedding situation.

    The simplest fix is to drop the fallback code I originally added to _PyInterpreterState_IsRunningMain() (and later to _PyThreadState_IsRunningMain()).  I've kept the fallback in the _xxsubinterpreters module though.  I've also updated Py_FrozenMain() to call _PyInterpreterState_SetRunningMain().

commit c4bf58a14f162557038a1535ca22c52b49d81d7b
Author: Thomas A Caswell <tcaswell@gmail.com>
Date:   Thu Mar 21 19:54:50 2024 -0400

    gh-116745: Remove all internal usage of @LIBPYTHON@ (#116746)

    Replace with MODULE_LDFLAGS.

commit 3ec57307e70ee6f42410e844d3399bbd598917ba
Author: Malcolm Smith <smith@chaquo.com>
Date:   Thu Mar 21 23:52:29 2024 +0000

    gh-71052: Add Android build script and instructions (#116426)

commit 50f9b0b1e0fb181875751cef951351ed007b6397
Author: Victor Stinner <vstinner@python.org>
Date:   Thu Mar 21 23:17:09 2024 +0100

    gh-117061: Fix test_posix.test_sched_setaffinity() on RHEL9 (#117126)

    On RHEL9, sched_setaffinity(0, []) does not fail.

commit 0907871d43bffb613cbd560224e1a9db13d06c06
Author: Ned Batchelder <ned@nedbatchelder.com>
Date:   Thu Mar 21 15:47:09 2024 -0400

    docs: fix over-linking in dataclasses.rst (#117005)

commit 570a82d46abfebb9976961113fb0f8bb400ad182
Author: Guido van Rossum <guido@python.org>
Date:   Thu Mar 21 12:37:41 2024 -0700

    gh-117045: Add code object to function version cache (#117028)

    Changes to the function version cache:

    - In addition to the function object, also store the code object,
      and allow the latter to be retrieved even if the function has been evicted.
    - Stop assigning new function versions after a critical attribute (e.g. `__code__`)
      has been modified; the version is permanently reset to zero in this case.
    - Changes to `__annotations__` are no longer considered critical. (This fixes gh-109998.)

    Changes to the Tier 2 optimization machinery:

    - If we cannot map a function version to a function, but it is still mapped to a code object,
      we continue projecting the trace.
      The operand of the `_PUSH_FRAME` and `_POP_FRAME` opcodes can be either NULL,
      a function object, or a code object with the lowest bit set.

    This allows us to trace through code that calls an ephemeral function,
    i.e., a function that may not be alive when we are constructing the executor,
    e.g. a generator expression or certain nested functions.
    We will lose globals removal inside such functions,
    but we can still do other peephole operations
    (and even possibly [call inlining](https://github.com/python/cpython/pull/116290),
    if we decide to do it), which only need the code object.
    As before, if we cannot retrieve the code object from the cache, we stop projecting.

commit c85d84166a84a5cb2d724012726bad34229ad24e
Author: Will Childs-Klein <willck93@gmail.com>
Date:   Thu Mar 21 14:16:36 2024 -0500

    gh-116333: Relax error string text expectations in SSL-related tests (GH-116334)

    * Relax error string text expectations in SSL-related tests

    As suggested [here][1], this change relaxes the OpenSSL error string
    text expectations in a number of tests. This was specifically done in
    support of more easily building CPython [AWS-LC][2], but because AWS-LC
    is a fork of [BoringSSL][3], it should increase compatibility with that
    library as well.

    In addition to the error string relaxations, we also add some guards
    around the `tls-unique` channel binding being used with TLSv1.3, as that
    feature (described in [RFC 6929][4]) is [not defined][5] for TLSv1.3.

    [1]: https://discuss.python.org/t/support-building-ssl-and-hashlib-modules-against-aws-lc/44505/4
    [2]: https://github.com/aws/aws-lc
    [3]: https://github.com/google/boringssl
    [4]: https://datatracker.ietf.org/doc/html/rfc5929#section-3
    [5]: https://datatracker.ietf.org/doc/html/rfc8446#appendix-C.5

commit 1f72fb5447ef3f8892b4a7a6213522579c618e8e
Author: Sam Gross <colesbury@gmail.com>
Date:   Thu Mar 21 14:21:02 2024 -0400

    gh-116522: Refactor `_PyThreadState_DeleteExcept` (#117131)

    Split `_PyThreadState_DeleteExcept` into two functions:

    - `_PyThreadState_RemoveExcept` removes all thread states other than one
      passed as an argument. It returns the removed thread states as a
      linked list.

    - `_PyThreadState_DeleteList` deletes those dead thread states. It may
      call destructors, so we want to \"start the world\" before calling
      `_PyThreadState_DeleteList` to avoid potential deadlocks.

commit 50369e6c34d05222e5a0ec9443a9f7b230e83112
Author: Michael Droettboom <mdboom@gmail.com>
Date:   Thu Mar 21 13:27:46 2024 -0400

    gh-116996: Add pystats about _Py_uop_analyse_and_optimize (GH-116997)

commit 617158e07811edfd6fd552a3d84b0beedd8f1d18
Author: Eric Snow <ericsnowcurrently@gmail.com>
Date:   Thu Mar 21 11:15:02 2024 -0600

    gh-76785: Drop PyInterpreterID_Type (gh-117101)

    I added it quite a while ago as a strategy for managing interpreter lifetimes relative to the PEP 554 (now 734) implementation.  Relatively recently I refactored that implementation to no longer rely on InterpreterID objects.  Thus now I'm removing it.

commit abdd1f938f08e536864532b2071f144515ecc88b
Author: Victor Stinner <vstinner@python.org>
Date:   Thu Mar 21 17:45:43 2024 +0100

    gh-85283: Build _testconsole extension with limited C API (#117125)

commit 8bea6c411d65cd987616b4ecdb86373e4f21f1c6
Author: Victor Stinner <vstinner@python.org>
Date:   Thu Mar 21 17:07:00 2024 +0100

    gh-115754: Add Py_GetConstant() function (#116883)

    Add Py_GetConstant() and Py_GetConstantBorrowed() functions.

    In the limited C API version 3.13, getting Py_None, Py_False,
    Py_True, Py_Ellipsis and Py_NotImplemented singletons is now
    implemented as function calls at the stable ABI level to hide
    implementation details. Getting these constants still return borrowed
    references.

    Add _testlimitedcapi/object.c and test_capi/test_object.py to test
    Py_GetConstant() and Py_GetConstantBorrowed() functions.

commit 5a76d1be8ef371b75ca65166726923c249b5f615
Author: Eric Snow <ericsnowcurrently@gmail.com>
Date:   Thu Mar 21 10:06:35 2024 -0600

    gh-105716: Update interp->threads.main After Fork (gh-117049)

    I missed this in gh-109921.

    We also update Py_Exit() to call _PyInterpreterState_SetNotRunningMain(), if necessary.

commit bbee57fa8c318cb26d6c8651254927a1972c9738
Author: Eric Snow <ericsnowcurrently@gmail.com>
Date:   Thu Mar 21 09:56:12 2024 -0600

    gh-76785: Clean Up Interpreter ID Conversions (gh-117048)

    Mostly we unify the two different implementations of the conversion code (from PyObject * to int64_t.  We also drop the PyArg_ParseTuple()-style converter function, as well as rename and move PyInterpreterID_LookUp().

commit e728303532168efab7694c55c82ea19b18bf8385
Author: Sam Gross <colesbury@gmail.com>
Date:   Thu Mar 21 10:01:16 2024 -0400

    gh-116522: Stop the world before fork() and during shutdown (#116607)

    This changes the free-threaded build to perform a stop-the-world pause
    before deleting other thread states when forking and during shutdown.
    This fixes some crashes when using multiprocessing and during shutdown
    when running with `PYTHON_GIL=0`.

    This also changes `PyOS_BeforeFork` to acquire the runtime lock
    (i.e., `HEAD_LOCK(&_PyRuntime)`) before forking to ensure that data
    protected by the runtime lock (and not just the GIL or stop-the-world)
    is in a consistent state before forking.

commit 1f8b24ef69896680d6ba6005e75e1cc79a744f9e
Author: Malcolm Smith <smith@chaquo.com>
Date:   Thu Mar 21 13:20:57 2024 +0000

    gh-71052: Implement `ctypes.util.find_library` on Android (GH-116379)

commit d16c9d1278164f04778861814ebc87ed087511fc
Author: Tian Gao <gaogaotiantian@hotmail.com>
Date:   Thu Mar 21 03:30:10 2024 -0700

    gh-116987: Support class code objects in inspect.findsource() (GH-117025)

commit 6547330f4e896c6748da23704b617e060e6cc68e
Author: Adam Turner <9087854+AA-Turner@users.noreply.github.com>
Date:   Thu Mar 21 03:49:10 2024 +0000

    GH-109653: Defer import of ``importlib.metadata._adapters`` (#109829)

    * adapters

    * Add comments for deferred imports with links to rationale.

    * Add blurb

    ---------

    Co-authored-by: Jason R. Coombs <jaraco@jaraco.com>

commit 667294d5b2ee812ebe0c9c1efd58e2006b61f827
Author: Jason R. Coombs <jaraco@jaraco.com>
Date:   Wed Mar 20 23:01:24 2024 -0400

    gh-117089: Apply changes from importlib_metadata 7.1.0 (#117094)

    * Apply changes from importlib_metadata 7.1.0

    * Include the data sources in the makefile (even though they're not needed)

commit f4cc77d494ee0e10ed84ce369f0910c70a2f6d44
Author: Victor Stinner <vstinner@python.org>
Date:   Thu Mar 21 00:06:24 2024 +0100

    gh-116869: Enable -Werror in test_cext for Free Threading (#117106)

    Check for warnings, but don't enable the compiler flag
    -Werror=declaration-after-statement.

commit 104602a6078564765b7b8f42888f8eaa37b129b1
Author: Victor Stinner <vstinner@python.org>
Date:   Wed Mar 20 23:52:23 2024 +0100

    gh-105927: Limit PyWeakref_GetRef() to limited C API 3.13 (#117091)

commit 8ad88984200b2ccddc0a08229dd2f4c14d1a71fc
Author: Jason R. Coombs <jaraco@jaraco.com>
Date:   Wed Mar 20 17:11:00 2024 -0400

    gh-117089: Move importlib.metadata tests to their own package (#117092)

    * Ensure importlib.metadata tests do not leak references in sys.modules.

    * Move importlib.metadata tests to their own package for easier syncing with importlib_metadata.

    * Update owners and makefile for new directories.

    * Add blurb

commit 7d446548ef53f6c3de1097c6d44cada6642ddc85
Author: Carol Willing <carolcode@willingconsulting.com>
Date:   Wed Mar 20 14:00:59 2024 -0700

    Fix sort order for \"locale encoding\" glossary item (#115794)

    Co-authored-by: C.A.M. Gerlach <CAM.Gerlach@Gerlach.CAM>

commit 63289b9dfbc7d87e81f1517422ee91b6b6d19531
Author: Mark Shannon <mark@hotpy.org>
Date:   Wed Mar 20 18:24:02 2024 +0000

    GH-117066: Tier 2 optimizer: Don't throw away good traces if we can't optimize them perfectly. (GH-117067)

commit dcaf33a41d5d220523d71c9b35bc08f5b8405dac
Author: Petr Viktorin <encukou@gmail.com>
Date:   Wed Mar 20 17:33:08 2024 +0100

    gh-114314: ctypes: remove stgdict and switch to heap types (GH-116458)

    Before this change, ctypes classes used a custom dict subclass, `StgDict`,
    as their `tp_dict`. This acts like a regular dict but also includes extra information
    about the type.

    This replaces stgdict by `StgInfo`, a C struct on the type, accessed by
    `PyObject_GetTypeData()` (PEP-697).
    All usage of `StgDict` (mainly variables named `stgdict`, `dict`, `edict` etc.) is
    converted to `StgInfo` (named `stginfo`, `info`, `einfo`, etc.).
    Where the dict is actually used for class attributes (as a regular PyDict), it's now
    called `attrdict`.

    This change -- not overriding `tp_dict` -- is made to make me comfortable with
    the next part of this PR: moving the initialization logic from `tp_new` to `tp_init`.

    The `StgInfo` is set up in `__init__` of each class, with a guard that prevents
    calling `__init__` more than once. Note that abstract classes (like `Array` or
    `Structure`) are created using `PyType_FromMetaclass` and do not have
    `__init__` called.
    Previously, this was done in `__new__`, which also wasn't called for abstract
    classes.
    Since `__init__` can be called from Python code or skipped, there is a tested
    guard to ensure `StgInfo` is initialized exactly once before it's used.

    Co-authored-by: neonene <53406459+neonene@users.noreply.github.com>
    Co-authored-by: Erlend E. Aasland <erlend.aasland@protonmail.com>

commit 44fbab43d8f3f2df07091d237824cf4fa1f6c57c
Author: Russell Keith-Magee <russell@keith-magee.com>
Date:   Wed Mar 20 23:32:56 2024 +0800

    gh-117058: Update GUI and packaging recommendations for macOS. (#117059)

commit 9221ef2d8cb7f4cf37592eb650d4c8f972033000
Author: Brett Simmers <swtaarrs@users.noreply.github.com>
Date:   Wed Mar 20 08:18:26 2024 -0700

    gh-116908: Only write to `_pending_calls.calls_to_do` with atomic operations (#117044)

    These writes to `pending->calls_to_do` need to be atomic, because other threads
    can read (atomically) from `calls_to_do` without holding `pending->mutex`.

commit fc4599800778f9b130d5e336deadbdeb5bd3e5ee
Author: jkriegshauser <jkriegshauser@gmail.com>
Date:   Wed Mar 20 07:33:28 2024 -0700

    gh-116773: Ensure overlapped objects on Windows are not deallocated too early by asyncio (GH-116774)

commit 519b2ae22b54760475bbf62b9558d453c703f9c6
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Wed Mar 20 15:39:53 2024 +0200

    gh-117021: Fix integer overflow in PyLong_AsPid() on non-Windows 64-bit platforms (GH-117064)")`
…

`[1b5fe4c](/NGRsoftlab/cpython/commit/1b5fe4cad096e32efee3a0477ef6f277ec2a2b96)`

```
commit 9dae05ee59eeba0e67af2a46f2a2907c9f8d7e4a
Author: Moshe Kaplan <mosheekaplan@gmail.com>
Date:   Mon Apr 1 15:53:00 2024 -0400

    Docs: specify XML document name in xml.etree.elementtree example (#24223)

commit fc2071687b708598264a3403b7f9104667c1092f
Author: Matthew Davis <7035647+mdavis-xyz@users.noreply.github.com>
Date:   Mon Apr 1 21:49:14 2024 +0200

    Docs: add more links to PIPE in subprocess docs (#25416)

commit fc8007ee3635db6ab73e132ebff987c910b6d538
Author: Barney Gale <barney.gale@gmail.com>
Date:   Mon Apr 1 20:37:41 2024 +0100

    GH-117337: Deprecate `glob.glob0()` and `glob.glob1()`. (#117371)

    These undocumented functions are no longer used by `msilib`, so there's no
    reason to keep them around.

commit c741ad3537193c63fe697a8f0316aecd45eeb9ba
Author: Justin Turner Arthur <justinarthur@gmail.com>
Date:   Mon Apr 1 12:07:29 2024 -0500

    gh-77714: Provide an async iterator version of as_completed (GH-22491)

    * as_completed returns object that is both iterator and async iterator
    * Existing tests adjusted to test both the old and new style
    * New test to ensure iterator can be resumed
    * New test to ensure async iterator yields any passed-in Futures as-is

    Co-authored-by: Serhiy Storchaka <storchaka@gmail.com>
    Co-authored-by: Guido van Rossum <gvanrossum@gmail.com>

commit ddf814db744006e0f42328aa15ace97c9d8ad681
Author: Guido van Rossum <guido@python.org>
Date:   Mon Apr 1 09:13:38 2024 -0700

    Silence compiler warnings in gc.c (#117422)

commit 179869af922252a0c1cef65fd2923856895e7d1b
Author: Petr Viktorin <encukou@gmail.com>
Date:   Mon Apr 1 17:01:22 2024 +0200

    gh-94808: Fix refcounting in PyObject_Print tests (GH-117421)

commit dd44ab994b7262f0704d64996e0a1bc37b233407
Author: neonene <53406459+neonene@users.noreply.github.com>
Date:   Mon Apr 1 22:28:14 2024 +0900

    gh-117142: ctypes: Unify meta tp slot functions (GH-117143)

    Integrates the following ctypes meta tp slot functions:
    * `CDataType_traverse()` into `CType_Type_traverse()`.
    * `CDataType_clear()` into `CType_Type_clear()`.
    * `CDataType_dealloc()` into `CType_Type_dealloc()`.
    * `CDataType_repeat()` into `CType_Type_repeat()`.

commit 3de09cadde788065a4f2d45117e789c9353bbd12
Author: Steve (Gadget) Barnes <gadgetsteve@hotmail.com>
Date:   Mon Apr 1 14:02:07 2024 +0100

    gh-91565: Replace bugs.python.org links with Devguide/GitHub ones  (GH-91568)

    Co-authored-by: Hugo van Kemenade <hugovk@users.noreply.github.com>
    Co-authored-by: Oleg Iarygin <oleg@arhadthedev.net>
    Co-authored-by: Petr Viktorin <encukou@gmail.com>
    Co-authored-by: Ezio Melotti <ezio.melotti@gmail.com>

commit 90c3c68a658db6951b77a5be50088ec2f6adc8eb
Author: MonadChains <monadchains@gmail.com>
Date:   Mon Apr 1 13:52:25 2024 +0100

    gh-94808:Improve coverage of PyObject_Print (GH-98749)

commit 348cf6e0078eae156c503e8f61ef5e27ae28e57b
Author: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Date:   Mon Apr 1 11:14:37 2024 +0000

    Bump mypy from 1.8.0 to 1.9.0 in /Tools (#117418)

    Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
    Co-authored-by: Alex Waygood <Alex.Waygood@Gmail.com>

commit 9b403fb559bfce93a478937e0ef7e539a9a95283
Author: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Date:   Mon Apr 1 11:05:14 2024 +0000

    build(deps-dev): bump types-psutil from 5.9.5.20240205 to 5.9.5.20240316 in /Tools (#117417)

    Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
    Co-authored-by: Alex Waygood <Alex.Waygood@Gmail.com>

commit 93c7d9d17b571b6a181af7c02830d29819535c35
Author: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Date:   Mon Apr 1 11:38:38 2024 +0100

    build(deps-dev): bump types-setuptools from 69.1.0.20240301 to 69.2.0.20240317 in /Tools (#117419)

    Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

commit 3bb12e407c183946471272f8aee098e54e62a333
Author: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Date:   Mon Apr 1 09:54:33 2024 +0000

    build(deps): bump actions/add-to-project from 0.6.0 to 1.0.0 (#117415)

    Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

commit 56e99307c49adcc6df355f8070229371c97d654f
Author: Adorilson Bezerra <adorilson@gmail.com>
Date:   Sun Mar 31 23:34:54 2024 +0100

    Doc: printf-style library/stdtype improvements (#16741)

commit 18e12641a61a88f7d08b2114ebe965892c6661c5
Author: Raymond Hettinger <rhettinger@users.noreply.github.com>
Date:   Sun Mar 31 16:09:22 2024 -0500

    gh-117387 Remove hash mark from introductory text (#117409)

commit a32d6939486d7f90ee57e215077f6116e19de24d
Author: Deborah <32307299+dlwrnc@users.noreply.github.com>
Date:   Sun Mar 31 22:11:48 2024 +0200

    gh-102190: Add additional zipfile `pwd=` arg docstrings (gh-102195)

    This just documents the parameter that already exists.

    ---------

    Co-authored-by: Gregory P. Smith <greg@krypto.org>
    Co-authored-by: Erlend E. Aasland <erlend.aasland@protonmail.com>

commit 262445358e21c56d7c68e3ee76c13e469d2ea348
Author: Shantanu <12621235+hauntsaninja@users.noreply.github.com>
Date:   Sun Mar 31 12:02:48 2024 -0700

    Link to the Python type system specification (#117400)

commit 752e18389ed03087b51b38eac9769ef8dfd167b7
Author: Barney Gale <barney.gale@gmail.com>
Date:   Sun Mar 31 19:14:48 2024 +0100

    GH-114575: Rename `PurePath.pathmod` to `PurePath.parser` (#116513)

    And rename the private base class from `PathModuleBase` to `ParserBase`.

commit bfc57d43d8766120ba0c8f3f6d7b2ac681a81d8a
Author: Sam Gross <colesbury@gmail.com>
Date:   Fri Mar 29 18:58:08 2024 -0400

    gh-117303: Don't detach in `PyThreadState_DeleteCurrent()` (#117304)

    This fixes a crash in `test_threading.test_reinit_tls_after_fork()` when
    running with the GIL disabled. We already properly handle the case where
    the thread state is `_Py_THREAD_ATTACHED` in `tstate_delete_common()` --
    we just need to remove an assertion.

    Keeping the thread attached means that a stop-the-world pause, such as
    for a `fork()`, won't commence until we remove our thread state from the
    interpreter's linked list. This prevents a crash when the child process
    tries to clean up the dead thread states.

commit 05e0b67a43c5c1778dc2643c8b7c12864e135999
Author: Erlend E. Aasland <erlend@python.org>
Date:   Fri Mar 29 21:23:28 2024 +0100

    gh-116664: In _warnings.c, make filters_version access thread-safe (#117374)

    - assert that the lock is held in already_warned()
    - protect 'filters_version' increment in warnings_filters_mutated_impl()

commit 019143fecbfc26e69800d28d2a9e3392a051780b
Author: Jason R. Coombs <jaraco@jaraco.com>
Date:   Fri Mar 29 16:06:09 2024 -0400

    gh-117348: Refactored RawConfigParser._read for similicity and comprehensibility (#117372)

    * Extract method for _read_inner, reducing complexity and indentation by 1.

    * Extract method for _raise_all and yield ParseErrors from _read_inner.

    Reduces complexity by 1 and reduces touch points for handling errors in _read_inner.

    * Prefer iterators to splat expansion and literal indexing.

    * Extract method for _strip_comments. Reduces complexity by 7.

    * Model the file lines in a class to encapsulate the comment status and cleaned value.

    * Encapsulate the read state as a dataclass

    * Extract _handle_continuation_line and _handle_rest methods. Reduces complexity by 8.

    * Reindent

    * At least for now, collect errors in the ReadState

    * Check for missing section header separately.

    * Extract methods for _handle_header and _handle_option. Reduces complexity by 6.

    * Remove unreachable code. Reduces complexity by 4.

    * Remove unreachable branch

    * Handle error condition early. Reduces complexity by 1.

    * Add blurb

    * Move _raise_all to ParsingError, as its behavior is most closely related to the exception class and not the reader.

    * Split _strip* into separate methods.

    * Refactor _strip_full to compute the strip just once and use 'not any' to determine the factor.

    * Replace use of 'sys.maxsize' with direct computation of the stripped value.

    * Extract has_comments as a dynamic property.

    * Implement clean as a cached property.

    * Model comment prefixes in the RawConfigParser within a prefixes namespace.

    * Use a regular expression to search for the first match.

    Avoids mutating variables and tricky logic and over-computing all of the starts when only the first is relevant.

commit 01bd74eadbc4ff839d39762fae6366f50c1e116e
Author: Sam Gross <colesbury@gmail.com>
Date:   Fri Mar 29 15:33:06 2024 -0400

    gh-117300: Use stop the world to make `sys._current_frames` and `sys._current_exceptions` thread-safe. (#117301)

    This adds a stop the world pause to make the two functions thread-safe
    when the GIL is disabled in the free-threaded build.

    Additionally, the main test thread may call `sys._current_exceptions()` as
    soon as `g_raised.set()` is called. The background thread may not yet reach
    the `leave_g.wait()` line.

commit 94c97423a9c4969f8ddd4a3aa4aacb99c4d5263d
Author: Guido van Rossum <guido@python.org>
Date:   Fri Mar 29 11:31:09 2024 -0700

    Fix broken format in error for bad input in summarize_stats.py (#117375)

    When you pass the script a non-existent input file, you get a TypeError instead of the intended ValueError.

commit 5d21d884b6ffa45dac50a5f9a07c41356a8478b4
Author: mpage <mpage@meta.com>
Date:   Fri Mar 29 10:42:02 2024 -0700

    gh-111926: Avoid locking in PyType_IsSubtype (#117275)

    Read the MRO in a thread-unsafe way in `PyType_IsSubtype` to avoid locking. Fixing this is tracked in #117306.

    The motivation for this change is in support of making weakrefs thread-safe in free-threaded builds:

    `WeakValueDictionary` uses a special dictionary function, `_PyDict_DelItemIf`
    to remove dead weakrefs from the dictionary. `_PyDict_DelItemIf` removes a key
    if a user supplied predicate evaluates to true for the value associated with
    the key. Crucially for the `WeakValueDictionary` use case, the predicate
    evaluation + deletion sequence is atomic, provided that the predicate doesn’t
    suspend. The predicate used by `WeakValueDictionary` includes a subtype check,
    which we must ensure doesn't suspend in free-threaded builds.

commit 19c1dd60c5b53fb0533610ad139ef591294f26e8
Author: Sam Gross <colesbury@gmail.com>
Date:   Fri Mar 29 13:35:43 2024 -0400

    gh-117323: Make `cell` thread-safe in free-threaded builds (#117330)

    Use critical sections to lock around accesses to cell contents. The critical sections are no-ops in the default (with GIL) build.

commit 397d88db5e9ab2a43de3fdf5f8b973a949edc405
Author: Sam Gross <colesbury@gmail.com>
Date:   Fri Mar 29 13:34:04 2024 -0400

    gh-117344: Skip flaky tests in free-threaded build (#117355)

    The tests are not reliable with the GIL disabled. In theory, they can
    fail with the GIL enabled too, but the failures are much more likely
    with the GIL disabled.

commit f05fb2e65c2dffdfae940f2707765c4994925205
Author: Sam Gross <colesbury@gmail.com>
Date:   Fri Mar 29 13:33:04 2024 -0400

    gh-112529: Don't untrack tuples or dicts with zero refcount (#117370)

    The free-threaded GC sometimes sees objects with zero refcount. This can
    happen due to the delay in merging biased reference counting fields,
    and, in the future, due to deferred reference counting. We should not
    untrack these objects or they will never be collected.

    This fixes the refleaks in the free-threaded build.

commit ddf95b5f16031cdbd0d728e55eb06dff002a8678
Author: Erlend E. Aasland <erlend@python.org>
Date:   Fri Mar 29 18:26:06 2024 +0100

    gh-116664: Fix unused var warnings in _warnings.c in non-free-threaded builds (#117373)

    The warnings were introduced by commit c1712ef06.

commit 0fa571dbcdf19b541276cb00bb929381930467b2
Author: Tian Gao <gaogaotiantian@hotmail.com>
Date:   Fri Mar 29 09:02:01 2024 -0700

    Refactor pdb executable targets (#112570)

    Co-authored-by: Jason R. Coombs <jaraco@jaraco.com>

commit 54f7e14500471d1c46fb553adb3ca24cd1fef084
Author: Pedro Lacerda <pslacerda@users.noreply.github.com>
Date:   Fri Mar 29 12:05:00 2024 -0300

    gh-66449: configparser: Add support for unnamed sections (#117273)

    Co-authored-by: Jason R. Coombs <jaraco@jaraco.com>

commit d9cfe7e565a6e2dc15747a904736264e31a10be4
Author: Nikita Sobolev <mail@sobolevn.me>
Date:   Fri Mar 29 14:14:25 2024 +0300

    gh-117166: Ignore empty and temporary dirs in `test_makefile` (#117190)

commit 35b6c4a4da201a947b2ceb96ae4c0d83d4d2df4f
Author: Victor Stinner <vstinner@python.org>
Date:   Fri Mar 29 11:25:17 2024 +0100

    gh-117347: Fix test_clinic side effects (#117363)

    Save/restore converters in ClinicWholeFileTest and
    ClinicExternalTest.

commit 7e2fef865899837c47e91ef0180fa59eb03e840b
Author: neonene <53406459+neonene@users.noreply.github.com>
Date:   Fri Mar 29 18:40:48 2024 +0900

    gh-117142: ctypes: Migrate global vars to module state (GH-117189)

commit 2e9be80c99f635c2f7761e8356b0260922d6e7a6
Author: Gregory P. Smith <greg@krypto.org>
Date:   Thu Mar 28 17:58:37 2024 -0700

    Fix reversed assertRegex checks in test_ssl. (#117351)

commit 8eec7ed714e65d616573b7331780b0aa43c6ed6a
Author: 傅立业（Chris Fu） <17433201@qq.com>
Date:   Fri Mar 29 08:19:20 2024 +0800

    gh-117110: Fix subclasses of typing.Any with custom constructors (#117111)

commit a17f313e3958e825db9a83594c8471a984316536
Author: Christopher Chianelli <christopher@timefold.ai>
Date:   Thu Mar 28 18:26:56 2024 -0400

    gh-117339: Use NULL instead of None for LOAD_SUPER_ATTR in dis docs (GH-117343)

commit 26d328b2ba26374fb8d9ffe8215ecef7c5e3f7a2
Author: Michael Droettboom <mdboom@gmail.com>
Date:   Thu Mar 28 18:23:08 2024 -0400

    GH-117121: Add pystats to JIT builds (GH-117346)

commit 14f1ca7d5363386163839b31ce987423daecc3de
Author: Nice Zombies <nineteendo19d0@gmail.com>
Date:   Thu Mar 28 22:20:08 2024 +0100

    gh-117335: Handle non-iterables for `ntpath.commonpath` (GH-117336)

commit 18cf239e39e25e6cef50ecbb7f197a82f8920ff5
Author: Brandt Bucher <brandtbucher@microsoft.com>
Date:   Thu Mar 28 14:02:34 2024 -0700

    Increase the JIT CI timeouts to 75 minutes (GH-117342)

commit 29829b58a8328a7c2ccacaa74c1d7d120a5e5ca5
Author: Malcolm Smith <smith@chaquo.com>
Date:   Thu Mar 28 19:59:12 2024 +0000

    gh-117294: Report DocTestCase as skipped if all examples in the doctest are skipped (GH-117297)

commit efcc96844e7c66fcd6c23ac2d557ca141614ce9a
Author: Tian Gao <gaogaotiantian@hotmail.com>
Date:   Thu Mar 28 11:23:29 2024 -0700

    gh-69201: Separate stdout and stderr stream in test_pdb (#117308)

commit 6702d2bf6edcd5b5415e17837383623b9d76a5b8
Author: Victor Stinner <vstinner@python.org>
Date:   Thu Mar 28 17:40:58 2024 +0100

    gh-114331: Skip decimal test_maxcontext_exact_arith on s390x (#117326)

commit c1712ef066321c01bf09cba3f22fc474b5b8dfa7
Author: Erlend E. Aasland <erlend@python.org>
Date:   Thu Mar 28 16:05:08 2024 +0100

    gh-116664: Make module state Py_SETREF's in _warnings thread-safe (#116959)

    Mark the swap operations as critical sections.

    Add an internal Py_BEGIN_CRITICAL_SECTION_MUT API that takes a PyMutex
    pointer instead of a PyObject pointer.

commit 9a388b9a64927c372d85f0eaec3de9b7320a6fb5
Author: Joachim Wuttke <j.wuttke@fz-juelich.de>
Date:   Thu Mar 28 14:43:07 2024 +0100

    bpo-43848: explain optional argument mtime in gzip.py. (GH-25410)

    Co-authored-by: Jelle Zijlstra <jelle.zijlstra@gmail.com>

commit 8dbfdb2957a7baade3a88661517f163ad694c39f
Author: Sam Gross <colesbury@gmail.com>
Date:   Thu Mar 28 09:28:39 2024 -0400

    gh-110481: Fix biased reference counting queue initialization. (#117271)

    The biased reference counting queue must be initialized from the bound
    (active) thread because it uses `_Py_ThreadId()` as the key in a hash
    table.

commit 9a1e55b8c5723206116f7016921be3937ef2f4e5
Author: Chris Markiewicz <effigies@gmail.com>
Date:   Thu Mar 28 06:59:31 2024 -0400

    gh-117178: Recover lazy loading of self-referential modules (#117179)

commit 4c71d51a4b7989fc8754ba512c40e21666f9db0d
Author: Jelle Zijlstra <jelle.zijlstra@gmail.com>
Date:   Thu Mar 28 04:30:31 2024 -0600

    gh-117266: Fix crashes on user-created AST subclasses (GH-117276)

    Fix crashes on user-created AST subclasses

commit 8cb7d7ff86a1a2d41195f01ba4f218941dd7308c
Author: Gregory P. Smith <greg@krypto.org>
Date:   Thu Mar 28 03:11:58 2024 -0700

    gh-117310: Remove extra DECREF on "no ciphers" error path in `_ssl._SSLContext` constructor (#117309)

    Remove extra self DECREF on ssl "no ciphers" error path.

    This doesn't come up in practice because nobody links against a broken
    OpenSSL library that provides nothing.

commit 6c8ac8a32fd6de1960526561c44bc5603fab0f3e
Author: Erlend E. Aasland <erlend@python.org>
Date:   Thu Mar 28 09:40:37 2024 +0100

    gh-116303: Handle disabled test modules in test.support helpers (#116482)

    Make sure test.support helpers skip iso. failing if test extension
    modules are disabled. Also log TEST_MODULES in test.pythoninfo.

commit 0f27672c5002de96c9f1228b12460d5ce3f1d190
Author: Russell Keith-Magee <russell@keith-magee.com>
Date:   Thu Mar 28 16:13:13 2024 +0800

    gh-114099: Add documentation for iOS platform (GH-117057)

    Co-authored-by: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>
    Co-authored-by: Jacob Coffee <jacob@z7x.org>
    Co-authored-by: Malcolm Smith <smith@chaquo.com>
    Co-authored-by: Ned Deily <nad@python.org>

commit f006338017cfbf846e8f7391b9ee5f69df8dc620
Author: Russell Keith-Magee <russell@keith-magee.com>
Date:   Thu Mar 28 15:59:33 2024 +0800

    gh-114099: Additions to standard library to support iOS (GH-117052)

    Co-authored-by: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>
    Co-authored-by: Malcolm Smith <smith@chaquo.com>
    Co-authored-by: Ned Deily <nad@python.org>

commit b44898299a2ed97045c270f6474785da2ff07ced
Author: Tim Hatch <tim@timhatch.com>
Date:   Wed Mar 27 23:54:51 2024 -0700

    gh-89739: gh-77140: Support zip64 in zipimport (GH-94146)

    * Reads zip64 files as produced by the zipfile module
    * Include tests (somewhat slow, however, because of the need to create "large" zips)
    * About the same amount of strictness reading invalid zip files as zipfile has
    * Still works on files with prepended data (like pex)

    There are a lot more test cases at https://github.com/thatch/zipimport64/ that give me confidence that this works for real-world files.

    Fixes #89739 and #77140.

    ---------

    Co-authored-by: Itamar Ostricher <itamarost@gmail.com>
    Reviewed-by: Gregory P. Smith <greg@krypto.org>

commit 2cedd25c14d3acfdcb5e8ee55132ce3e334ab8fe
Author: Illia Volochii <illia.volochii@gmail.com>
Date:   Thu Mar 28 08:46:01 2024 +0200

    Revert "gh-116886: Temporarily disable CIfuzz (memory) (GH-117018)" (GH-117289)

    This reverts commit 1ab0d0b1167d78bf19661a3b5e533a2b68a57604.

    This reverts #117018.

    I expect the issue to be fixed based on https://github.com/google/oss-fuzz/pull/11708#issuecomment-2006442396 and https://github.com/actions/runner-images/issues/9491.

commit eefff682f09394fe4f18b7d7c6ac4c635caadd02
Author: Malcolm Smith <smith@chaquo.com>
Date:   Wed Mar 27 22:11:44 2024 +0000

    gh-108277: Make test_os tolerate 10 ms diff for timerfd on Android emulators (#117223)

commit 7aa89bc43e0bcf49eee5a39b5a7ba8f996f20d00
Author: Victor Stinner <vstinner@python.org>
Date:   Wed Mar 27 23:10:14 2024 +0100

    gh-113317: Change how Argument Clinic lists converters (#116853)

    * Add a new create_parser_namespace() function for
      PythonParser to pass objects to executed code.
    * In run_clinic(), list converters using 'converters' and
      'return_converters' dictionarties.
    * test_clinic: add 'object()' return converter.
    * Use also create_parser_namespace() in eval_ast_expr().

    Co-authored-by: Erlend E. Aasland <erlend@python.org>

commit 669ef49c7d42f35da6f7ee280102353b9b37f83e
Author: Seth Michael Larson <seth@python.org>
Date:   Wed Mar 27 16:56:14 2024 -0500

    gh-99108: Update and check HACL* version information (GH-117295)

    * Update and check HACL* version information

commit 262fb911ab7df8e890ebd0efb0773c3e0b5a757f
Author: Irit Katriel <1055913+iritkatriel@users.noreply.github.com>
Date:   Wed Mar 27 17:38:19 2024 +0000

    gh-117288: Allocate fewer label IDs in _PyCfg_ToInstructionSequence (#117290)

commit 74c8568d07719529b874897598d8b3bc25ff0434
Author: Malcolm Smith <smith@chaquo.com>
Date:   Wed Mar 27 16:53:27 2024 +0000

    gh-71042: Add `platform.android_ver` (#116674)

commit ce00de4c8cd39816f992e749c1074487d93abe9d
Author: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>
Date:   Wed Mar 27 16:46:35 2024 +0200

    gh-117225: doctest: only print "and X failed" when non-zero, don't pluralise "1 items" (#117228)

commit 92397d5ead38dde4154e70d00f24973bcf2a925a
Author: Raymond Hettinger <rhettinger@users.noreply.github.com>
Date:   Wed Mar 27 09:04:32 2024 -0500

    Add statistics recipe for sampling from an estimated probability density distribution (#117221)

commit b3e8c78ed7aa9bbd1084375587b99200c687cec9
Author: Tian Gao <gaogaotiantian@hotmail.com>
Date:   Tue Mar 26 18:20:12 2024 -0700

    gh-113548: Allow CLI arguments to `pdb -m` (#113557)

commit 48c0b05cf0dd2db275bd4653f84aa36c22bddcd2
Author: Adorilson Bezerra <adorilson@gmail.com>
Date:   Tue Mar 26 19:08:08 2024 +0000

    Change links on the index page (#117230)

commit af1b0e94400d1bf732466d675054df8cf7dfb62d
Author: AN Long <aisk@users.noreply.github.com>
Date:   Wed Mar 27 02:26:48 2024 +0800

    gh-104242: Enable test_is_char_device_true in pathlib test on all platform (GH-116983)

commit 79be75735c9d77972112cecc8d7e1af28c176ed0
Author: Irit Katriel <1055913+iritkatriel@users.noreply.github.com>
Date:   Tue Mar 26 15:18:17 2024 +0000

    gh-115775: Compiler adds __static_attributes__ field to classes (#115913)

commit 70969d53a77a8a190c40a30419e772bc874a4f62
Author: Antonio <57417288+amaddio@users.noreply.github.com>
Date:   Tue Mar 26 15:10:29 2024 +0100

    gh-97901 add missing text/rtf to mimetypes (GH-97902)

    Co-authored-by: Noam Cohen <noam@noam.me>

commit 4ec347760f98b156c6a2d42ca397af6b0b6ecc50
Author: AN Long <aisk@users.noreply.github.com>
Date:   Tue Mar 26 22:09:57 2024 +0800

    gh-115538: Use isolate mode when running venv test_multiprocessing_recursion() (#117116)

    Co-authored-by: Victor Stinner <vstinner@python.org>

commit 743f2c68f478279e1e56577fe95a0ed112b9abc5
Author: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>
Date:   Tue Mar 26 16:09:09 2024 +0200

    pre-commit: add `check-case-conflict` and `check-merge-conflict` (#117259)

commit 4abca7e1e7e2764faf20c7e677ea5c9ea9dbffe2
Author: Paulo Neves <ptsneves@users.noreply.github.com>
Date:   Tue Mar 26 13:37:50 2024 +0100

    gh-98966: Handle stdout=subprocess.STDOUT (GH-98967)

    Explicitly handle the case where stdout=STDOUT
    as otherwise the existing error handling gets
    confused and reports hard to understand errors.

    Signed-off-by: Paulo Neves <ptsneves@gmail.com>

commit 9654daf793b534b44a831c80f43505ab9e380f1f
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Tue Mar 26 13:26:45 2024 +0200

    gh-66543: Fix mimetype.guess_type() (GH-117217)

    Fix parsing of the following corner cases:

    * URLs with only a host name
    * URLs containing a fragment
    * URLs containing a query
    * filenames with only a UNC sharepoint on Windows

    Co-authored-by: Dong-hee Na <donghee.na92@gmail.com>

commit 8bef34f625e21886b1c64544c060e19ee2e229bf
Author: Mark Shannon <mark@hotpy.org>
Date:   Tue Mar 26 11:11:42 2024 +0000

    GH-117108: Set the "old space bit" to "visited" for all young objects  (#117213)

    Change old space bit of young objects from 0 to gcstate->visited_space.
    This ensures that any object created *and* collected during cycle GC has the bit set correctly.

commit bf82f77957a31c3731b4ec470c406f5708ca9ba3
Author: Mark Shannon <mark@hotpy.org>
Date:   Tue Mar 26 09:35:11 2024 +0000

    GH-116422: Tier2 hot/cold splitting (GH-116813)

    Splits the "cold" path, deopts and exits, from the "hot" path, reducing the size of most jitted instructions, at the cost of slower exits.

commit 61599a48f52e951d8813877ee311d2a830ba2cd8
Author: Pablo Galindo Salgado <Pablogsal@gmail.com>
Date:   Tue Mar 26 09:30:46 2024 +0000

    bpo-24612: Improve syntax error for 'not' after an operator (GH-28170)

    Co-authored-by: Lysandros Nikolaou <lisandrosnik@gmail.com>

commit 771902c257372e6c4df1ead4e8c46308561db7a7
Author: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>
Date:   Tue Mar 26 11:13:32 2024 +0200

    gh-83845: Add tests for operator module (#115883)

    Co-authored-by: Karthikeyan Singaravelan <tir.karthi@gmail.com>

commit ea9a296fce2f786b4cf43c7924e5de01061f27ca
Author: yevgeny hong <hongyevgeny@gmail.com>
Date:   Tue Mar 26 16:45:43 2024 +0900

    gh-115627: Fix PySSL_SetError handling SSL_ERROR_SYSCALL (GH-115628)

    Python 3.10 changed from using SSL_write() and SSL_read() to SSL_write_ex() and
    SSL_read_ex(), but did not update handling of the return value.

    Change error handling so that the return value is not examined.
    OSError (not EOF) is now returned when retval is 0.

    According to *recent* man pages of all functions for which we call
    PySSL_SetError, (in OpenSSL 3.0 and 1.1.1), their return value should
    be used to determine whether an error happened (i.e. if PySSL_SetError
    should be called), but not what kind of error happened (so,
    PySSL_SetError shouldn't need retval). To get the error,
    we need to use SSL_get_error.

    Co-authored-by: Serhiy Storchaka <storchaka@gmail.com>
    Co-authored-by: Petr Viktorin <encukou@gmail.com>

commit d52bdfb19fadd7614a0e5abaf68525fc7300e841
Author: Victor Stinner <vstinner@python.org>
Date:   Tue Mar 26 08:35:59 2024 +0100

    gh-83434: Disable XML in regrtest when -R option is used (#117232)

commit 9f74e86c78853c101a23e938f8e32ea838d8f62e
Author: Sebastian Pipping <sebastian@pipping.org>
Date:   Tue Mar 26 02:48:27 2024 +0100

    gh-117187: Fix XML tests for vanilla Expat <2.6.0 (GH-117203)

    This fixes XML unittest fallout from the https://github.com/python/cpython/issues/115398 security fix.  When configured using `--with-system-expat` on systems with older pre 2.6.0 versions of libexpat, our unittests were failing.

    * sax|etree: Simplify Expat version guard where simplifiable

    Idea by Matěj Cepl

    * sax|etree: Fix reparse deferral tests for vanilla Expat <2.6.0

    This *does not fix* the case of distros with an older version of libexpat with the 2.6.0 feature backported as a security fix.  (Ubuntu is a known example of this with its libexpat1 2.5.0-2ubunutu0.1 package)

commit 872e212378ef86392069034afd80bb53896fd93d
Author: Jonathan Protzenko <protz@microsoft.com>
Date:   Mon Mar 25 17:35:26 2024 -0700

    gh-99108: Refresh HACL*; update modules accordingly; fix namespacing (GH-117237)

    Pulls in a new update from https://github.com/hacl-star/hacl-star and fixes our C "namespacing" done by `Modules/_hacl/refresh.sh`.

commit 8945b7ff55b87d11c747af2dad0e3e4d631e62d6
Author: Eric V. Smith <ericvsmith@users.noreply.github.com>
Date:   Mon Mar 25 19:59:14 2024 -0400

    gh-109870: Dataclasses: batch up exec calls (gh-110851)

    Instead of calling `exec()` once for each function added to a dataclass, only call `exec()` once per dataclass. This can lead to speed improvements of up to 20%.

commit 7ebad77ad65ab4d5d8d0c333256a882262cec189
Author: Raymond Hettinger <rhettinger@users.noreply.github.com>
Date:   Mon Mar 25 18:49:44 2024 -0500

    Sync main docs and docstring for median_grouped(). (gh-117214)

commit 0821923aa979a72464c5da8dfa53a719bba5801c
Author: Nice Zombies <nineteendo19d0@gmail.com>
Date:   Mon Mar 25 23:55:11 2024 +0100

    gh-117114: Make os.path.isdevdrive available on all platforms (GH-117115)

commit c2276176d543a2fc2d57709c2787f99850fbb073
Author: Adorilson Bezerra <adorilson@gmail.com>
Date:   Mon Mar 25 22:34:20 2024 +0000

    Add information about negative  indexes to sequence datamodel doc (#110903)

    Co-authored by Terry Jan Reedy

commit 23e4f80ce2a2bac50acd1785e791316d5b578b8d
Author: Mark Shannon <mark@hotpy.org>
Date:   Mon Mar 25 20:43:51 2024 +0000

    A few minor tweaks to get stats working and compiling cleanly. (#117219)

    Fixes a compilation error when configured with `--enable-pystats`,
    an array size issue, and an unused variable.

commit 507896d97dcff2d7999efa264b29d9003c525c49
Author: Victor Stinner <vstinner@python.org>
Date:   Mon Mar 25 17:32:20 2024 +0100

    gh-116936: Add PyType_GetModuleByDef() to the limited C API (#116937)

commit 0c1a42cf9c8cd0d4534d5c1d58f118ce7c5c446e
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Mon Mar 25 17:32:11 2024 +0200

    gh-87193: Support bytes objects with refcount > 1 in _PyBytes_Resize() (GH-117160)

    Create a new bytes object and destroy the old one if it has refcount > 1.

commit 01e7405da400e8997f8964d06cc414045e144681
Author: Tian Gao <gaogaotiantian@hotmail.com>
Date:   Mon Mar 25 08:18:09 2024 -0700

    gh-112948: Make pdb completion similar to repl completion (#112950)

commit 9db2a8f914ad59019d448cecc43b6d45f46424a0
Author: Raymond Hettinger <rhettinger@users.noreply.github.com>
Date:   Mon Mar 25 09:26:42 2024 -0500

    Minor markup and grammar fixes in the statistics docs (gh-117216)

commit eebea7e515462b503632ada74923ec3246599c9c
Author: Kirill Podoprigora <kirill.bast9@mail.ru>
Date:   Sun Mar 24 20:34:55 2024 +0200

    gh-117176: Fix compiler warning in Python/optimizer_bytecodes.c (GH-117199)

commit 83485a095363dad6c97b19af2826ca0c34343bfc
Author: Totally a booplicate <53382877+Booplicate@users.noreply.github.com>
Date:   Sun Mar 24 18:48:40 2024 +0300

    gh-112571: Move fish venv activation script into the common folder (GH-117169)

    pythongh-112571: allow using fish venv activation script on windows

    The fish shell can be used on windows under cygwin or msys2.
    This change moves the script to the common folder
    so the venv module will install it on both posix and nt systems (like the bash script).

commit 78a651fd7fbe7a3d1702e40f4cbfa72d87241ef0
Author: Terry Jan Reedy <tjreedy@udel.edu>
Date:   Sun Mar 24 11:38:34 2024 -0400

    gh-117194: Properly format 'base64' header in What's New (#117198)

    It needs 6, not 3, '-'s.

commit f267d5bf2a99fbeb26a720d1c87c1f0557424b14
Author: Kerim Kabirov <the.privat33r+gh@pm.me>
Date:   Sun Mar 24 14:59:14 2024 +0100

    GH-115986 Docs: promote pprint.pp usage as a default (#116614)

    Co-authored-by: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>

commit 39df7732178c8e8f75b12f069a3dbc1715c99995
Author: LilKS <1244886+LilKS@users.noreply.github.com>
Date:   Sun Mar 24 11:01:07 2024 +0100

    gh-101760: Improve the imaplib.IMAP4 example (#101764)

    Co-authored-by: Adam Turner <9087854+AA-Turner@users.noreply.github.com>

commit a1e948edba9ec6ba61365429857f7a087c5edf51
Author: Raymond Hettinger <rhettinger@users.noreply.github.com>
Date:   Sun Mar 24 11:35:58 2024 +0200

    Add cumulative option for the new statistics.kde() function. (#117033)

commit d610d821fd210dce63a1132c274ffdf8acc510bc
Author: Irit Katriel <1055913+iritkatriel@users.noreply.github.com>
Date:   Sat Mar 23 22:32:33 2024 +0000

    gh-112383: teach dis how to interpret ENTER_EXECUTOR (#117171)

commit 6c83352bfe78a7d567c8d76257df6eb91d5a7245
Author: Ken Jin <kenjin@python.org>
Date:   Sun Mar 24 06:19:17 2024 +0800

    gh-117180: Complete call sequence when trace stack overflow (GH-117184)

    ---------

    Co-authored-by: Peter Lazorchak <lazorchakp@gmail.com>
    Co-authored-by: Guido van Rossum <gvanrossum@users.noreply.github.com>
    Co-authored-by: Guido van Rossum <gvanrossum@gmail.com>

commit f11d0d8be8af28e1368c3c7c116218cf65ddf93e
Author: Erik Soma <stillusingirc@gmail.com>
Date:   Sat Mar 23 11:39:35 2024 -0400

    gh-91227: Ignore ERROR_PORT_UNREACHABLE in proactor recvfrom() (#32011)

commit 9967b568edd2e35b0415c14c7242f3ca2c0dc03d
Author: Victor Stinner <vstinner@python.org>
Date:   Sat Mar 23 13:01:20 2024 +0100

    gh-117008: Fix functools test_recursive_pickle() (#117009)

    Use support.infinite_recursion() in test_recursive_pickle() of
    test_functools to prevent a stack overflow on "ARM64 Windows
    Non-Debug" buildbot.

    Lower Py_C_RECURSION_LIMIT to 1,000 frames on Windows ARM64.

commit 72eea512b88f8fd68b7258242c37da963ad87360
Author: Barney Gale <barney.gale@gmail.com>
Date:   Fri Mar 22 19:14:09 2024 +0000

    GH-106747: Document another difference between `glob` and `pathlib`. (#116518)

    Document that `path.glob()` might return *path*, whereas
    `glob.glob(root_dir=path)` will never return an empty string corresponding
    to *path*.

commit e28477f214276db941e715eebc8cdfb96c1207d9
Author: Mark Shannon <mark@hotpy.org>
Date:   Fri Mar 22 18:43:25 2024 +0000

    GH-117108: Change the size of the GC increment to about 1% of the total heap size. (GH-117120)

commit e2e0b4b4b92694ba894e02b4a66fd87c166ed10f
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Fri Mar 22 20:19:10 2024 +0200

    gh-113024: C API: Add PyObject_GenericHash() function (GH-113025)

commit 567ab3bd15398c8c7b791f3e376ae3e3c0bbe079
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Fri Mar 22 20:08:00 2024 +0200

    gh-117084: Fix ZIP file extraction for directory entry names with backslashes on Windows (GH-117129)

commit 5a78f6e798d5c2af1dba2df6c9f1f1e5aac02a86
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Fri Mar 22 20:03:48 2024 +0200

    gh-117134: Microoptimize glob() for include_hidden=True (GH-117135)

commit 00baaa21de229a6db80ff2b84c2fd6ad1999a24c
Author: Vinay Sajip <vinay_sajip@yahoo.co.uk>
Date:   Fri Mar 22 17:25:51 2024 +0000

    [docs] Fix typo in docstring and add example to logging cookbook. (GH-117157)

commit 40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f
Author: Jakub Stasiak <jakub@stasiak.at>
Date:   Fri Mar 22 17:49:56 2024 +0100

    GH-113171: Fix "private" (non-global) IP address ranges (GH-113179)

    * GH-113171: Fix "private" (really non-global) IP address ranges

    The _private_networks variables, used by various is_private
    implementations, were missing some ranges and at the same time had
    overly strict ranges (where there are more specific ranges considered
    globally reachable by the IANA registries).

    This patch updates the ranges with what was missing or otherwise
    incorrect.

    I left 100.64.0.0/10 alone, for now, as it's been made special in [1]
    and I'm not sure if we want to undo that as I don't quite understand the
    motivation behind it.

    The _address_exclude_many() call returns 8 networks for IPv4, 121
    networks for IPv6.

    [1] https://github.com/python/cpython/issues/61602

commit 3be9b9d8722696b95555937bb211dc4cda714d56
Author: Steve Dower <steve.dower@python.org>
Date:   Fri Mar 22 15:00:50 2024 +0000

    Fix get_packagefamilyname helper function on Windows 32-bit (GH-117153)

commit 63d6f2623ef2aa90f51c6a928b96845b9b380d89
Author: NGRsoftlab <78017794+NGRsoftlab@users.noreply.github.com>
Date:   Fri Mar 22 14:25:38 2024 +0300

    gh-117068: Remove useless code in bytesio.c:resize_buffer() (GH-117069)

    Co-authored-by: i.khabibulin <i.khabibulin@ngrsoftlab.ru>

commit 42ae924d278c48a719fb0ab86357f3235a9f7ab9
Author: Petr Viktorin <encukou@gmail.com>
Date:   Fri Mar 22 10:42:18 2024 +0100

    gh-117127: glob tests: Reopen dir_fd to pick up directory changes (GH-117128)

commit 8383915031942f441f435a5ae800790116047b80
Author: Tim Peters <tim.peters@gmail.com>
Date:   Thu Mar 21 22:27:25 2024 -0500

    GH-116939: Rewrite binarysort() (#116940)

    Rewrote binarysort() for clarity.

    Also changed the signature to be more coherent (it was mixing sortslice with raw pointers).

    No change in method or functionality. However, I left some experiments in, disabled for now
    via `#if` tricks. Since this code was first written, some kinds of comparisons have gotten
    enormously faster (like for lists of floats), which changes the tradeoffs.

    For example, plain insertion sort's simpler innermost loop and highly predictable branches
    leave it very competitive (even beating, by a bit) binary insertion when comparisons are
    very cheap, despite that it can do many more compares. And it wins big on runs that
    are already sorted (moving the next one in takes only 1 compare then).

    So I left code for a plain insertion sort, to make future experimenting easier.

    Also made the maximum value of minrun a `#define` (``MAX_MINRUN`) to make
    experimenting with that easier too.

    And another bit of `#if``-disabled code rewrites binary insertion's innermost loop to
    remove its unpredictable branch. Surprisingly, this doesn't really seem to help
    overall. I'm unclear on why not. It certainly adds more instructions, but they're very
    simple, and it's hard to be believe they cost as much as a branch miss.

commit 97ba910e47ad298114800587979ce7beb0a705a3
Author: Guido van Rossum <guido@python.org>
Date:   Thu Mar 21 18:27:48 2024 -0700

    gh-108716:: Remove _PyStaticCode_Init/Fini (#117141)

    More deepfreeze cleanup.

commit b3d25df8d38b79310587da54dbd88b06a16d4904
Author: Eric Snow <ericsnowcurrently@gmail.com>
Date:   Thu Mar 21 18:20:20 2024 -0600

    gh-105716: Fix _PyInterpreterState_IsRunningMain() For Embedders (gh-117140)

    When I added _PyInterpreterState_IsRunningMain() and friends last year, I tried to accommodate applications that embed Python but don't call _PyInterpreterState_SetRunningMain() (not that they're expected to).  That mostly worked fine until my recent changes in gh-117049, where the subtleties with the fallback code led to failures; the change ended up breaking test_tools.test_freeze, which exercises a basic embedding situation.

    The simplest fix is to drop the fallback code I originally added to _PyInterpreterState_IsRunningMain() (and later to _PyThreadState_IsRunningMain()).  I've kept the fallback in the _xxsubinterpreters module though.  I've also updated Py_FrozenMain() to call _PyInterpreterState_SetRunningMain().

commit c4bf58a14f162557038a1535ca22c52b49d81d7b
Author: Thomas A Caswell <tcaswell@gmail.com>
Date:   Thu Mar 21 19:54:50 2024 -0400

    gh-116745: Remove all internal usage of @LIBPYTHON@ (#116746)

    Replace with MODULE_LDFLAGS.

commit 3ec57307e70ee6f42410e844d3399bbd598917ba
Author: Malcolm Smith <smith@chaquo.com>
Date:   Thu Mar 21 23:52:29 2024 +0000

    gh-71052: Add Android build script and instructions (#116426)

commit 50f9b0b1e0fb181875751cef951351ed007b6397
Author: Victor Stinner <vstinner@python.org>
Date:   Thu Mar 21 23:17:09 2024 +0100

    gh-117061: Fix test_posix.test_sched_setaffinity() on RHEL9 (#117126)

    On RHEL9, sched_setaffinity(0, []) does not fail.

commit 0907871d43bffb613cbd560224e1a9db13d06c06
Author: Ned Batchelder <ned@nedbatchelder.com>
Date:   Thu Mar 21 15:47:09 2024 -0400

    docs: fix over-linking in dataclasses.rst (#117005)

commit 570a82d46abfebb9976961113fb0f8bb400ad182
Author: Guido van Rossum <guido@python.org>
Date:   Thu Mar 21 12:37:41 2024 -0700

    gh-117045: Add code object to function version cache (#117028)

    Changes to the function version cache:

    - In addition to the function object, also store the code object,
      and allow the latter to be retrieved even if the function has been evicted.
    - Stop assigning new function versions after a critical attribute (e.g. `__code__`)
      has been modified; the version is permanently reset to zero in this case.
    - Changes to `__annotations__` are no longer considered critical. (This fixes gh-109998.)

    Changes to the Tier 2 optimization machinery:

    - If we cannot map a function version to a function, but it is still mapped to a code object,
      we continue projecting the trace.
      The operand of the `_PUSH_FRAME` and `_POP_FRAME` opcodes can be either NULL,
      a function object, or a code object with the lowest bit set.

    This allows us to trace through code that calls an ephemeral function,
    i.e., a function that may not be alive when we are constructing the executor,
    e.g. a generator expression or certain nested functions.
    We will lose globals removal inside such functions,
    but we can still do other peephole operations
    (and even possibly [call inlining](https://github.com/python/cpython/pull/116290),
    if we decide to do it), which only need the code object.
    As before, if we cannot retrieve the code object from the cache, we stop projecting.

commit c85d84166a84a5cb2d724012726bad34229ad24e
Author: Will Childs-Klein <willck93@gmail.com>
Date:   Thu Mar 21 14:16:36 2024 -0500

    gh-116333: Relax error string text expectations in SSL-related tests (GH-116334)

    * Relax error string text expectations in SSL-related tests

    As suggested [here][1], this change relaxes the OpenSSL error string
    text expectations in a number of tests. This was specifically done in
    support of more easily building CPython [AWS-LC][2], but because AWS-LC
    is a fork of [BoringSSL][3], it should increase compatibility with that
    library as well.

    In addition to the error string relaxations, we also add some guards
    around the `tls-unique` channel binding being used with TLSv1.3, as that
    feature (described in [RFC 6929][4]) is [not defined][5] for TLSv1.3.

    [1]: https://discuss.python.org/t/support-building-ssl-and-hashlib-modules-against-aws-lc/44505/4
    [2]: https://github.com/aws/aws-lc
    [3]: https://github.com/google/boringssl
    [4]: https://datatracker.ietf.org/doc/html/rfc5929#section-3
    [5]: https://datatracker.ietf.org/doc/html/rfc8446#appendix-C.5

commit 1f72fb5447ef3f8892b4a7a6213522579c618e8e
Author: Sam Gross <colesbury@gmail.com>
Date:   Thu Mar 21 14:21:02 2024 -0400

    gh-116522: Refactor `_PyThreadState_DeleteExcept` (#117131)

    Split `_PyThreadState_DeleteExcept` into two functions:

    - `_PyThreadState_RemoveExcept` removes all thread states other than one
      passed as an argument. It returns the removed thread states as a
      linked list.

    - `_PyThreadState_DeleteList` deletes those dead thread states. It may
      call destructors, so we want to "start the world" before calling
      `_PyThreadState_DeleteList` to avoid potential deadlocks.

commit 50369e6c34d05222e5a0ec9443a9f7b230e83112
Author: Michael Droettboom <mdboom@gmail.com>
Date:   Thu Mar 21 13:27:46 2024 -0400

    gh-116996: Add pystats about _Py_uop_analyse_and_optimize (GH-116997)

commit 617158e07811edfd6fd552a3d84b0beedd8f1d18
Author: Eric Snow <ericsnowcurrently@gmail.com>
Date:   Thu Mar 21 11:15:02 2024 -0600

    gh-76785: Drop PyInterpreterID_Type (gh-117101)

    I added it quite a while ago as a strategy for managing interpreter lifetimes relative to the PEP 554 (now 734) implementation.  Relatively recently I refactored that implementation to no longer rely on InterpreterID objects.  Thus now I'm removing it.

commit abdd1f938f08e536864532b2071f144515ecc88b
Author: Victor Stinner <vstinner@python.org>
Date:   Thu Mar 21 17:45:43 2024 +0100

    gh-85283: Build _testconsole extension with limited C API (#117125)

commit 8bea6c411d65cd987616b4ecdb86373e4f21f1c6
Author: Victor Stinner <vstinner@python.org>
Date:   Thu Mar 21 17:07:00 2024 +0100

    gh-115754: Add Py_GetConstant() function (#116883)

    Add Py_GetConstant() and Py_GetConstantBorrowed() functions.

    In the limited C API version 3.13, getting Py_None, Py_False,
    Py_True, Py_Ellipsis and Py_NotImplemented singletons is now
    implemented as function calls at the stable ABI level to hide
    implementation details. Getting these constants still return borrowed
    references.

    Add _testlimitedcapi/object.c and test_capi/test_object.py to test
    Py_GetConstant() and Py_GetConstantBorrowed() functions.

commit 5a76d1be8ef371b75ca65166726923c249b5f615
Author: Eric Snow <ericsnowcurrently@gmail.com>
Date:   Thu Mar 21 10:06:35 2024 -0600

    gh-105716: Update interp->threads.main After Fork (gh-117049)

    I missed this in gh-109921.

    We also update Py_Exit() to call _PyInterpreterState_SetNotRunningMain(), if necessary.

commit bbee57fa8c318cb26d6c8651254927a1972c9738
Author: Eric Snow <ericsnowcurrently@gmail.com>
Date:   Thu Mar 21 09:56:12 2024 -0600

    gh-76785: Clean Up Interpreter ID Conversions (gh-117048)

    Mostly we unify the two different implementations of the conversion code (from PyObject * to int64_t.  We also drop the PyArg_ParseTuple()-style converter function, as well as rename and move PyInterpreterID_LookUp().

commit e728303532168efab7694c55c82ea19b18bf8385
Author: Sam Gross <colesbury@gmail.com>
Date:   Thu Mar 21 10:01:16 2024 -0400

    gh-116522: Stop the world before fork() and during shutdown (#116607)

    This changes the free-threaded build to perform a stop-the-world pause
    before deleting other thread states when forking and during shutdown.
    This fixes some crashes when using multiprocessing and during shutdown
    when running with `PYTHON_GIL=0`.

    This also changes `PyOS_BeforeFork` to acquire the runtime lock
    (i.e., `HEAD_LOCK(&_PyRuntime)`) before forking to ensure that data
    protected by the runtime lock (and not just the GIL or stop-the-world)
    is in a consistent state before forking.

commit 1f8b24ef69896680d6ba6005e75e1cc79a744f9e
Author: Malcolm Smith <smith@chaquo.com>
Date:   Thu Mar 21 13:20:57 2024 +0000

    gh-71052: Implement `ctypes.util.find_library` on Android (GH-116379)

commit d16c9d1278164f04778861814ebc87ed087511fc
Author: Tian Gao <gaogaotiantian@hotmail.com>
Date:   Thu Mar 21 03:30:10 2024 -0700

    gh-116987: Support class code objects in inspect.findsource() (GH-117025)

commit 6547330f4e896c6748da23704b617e060e6cc68e
Author: Adam Turner <9087854+AA-Turner@users.noreply.github.com>
Date:   Thu Mar 21 03:49:10 2024 +0000

    GH-109653: Defer import of ``importlib.metadata._adapters`` (#109829)

    * adapters

    * Add comments for deferred imports with links to rationale.

    * Add blurb

    ---------

    Co-authored-by: Jason R. Coombs <jaraco@jaraco.com>

commit 667294d5b2ee812ebe0c9c1efd58e2006b61f827
Author: Jason R. Coombs <jaraco@jaraco.com>
Date:   Wed Mar 20 23:01:24 2024 -0400

    gh-117089: Apply changes from importlib_metadata 7.1.0 (#117094)

    * Apply changes from importlib_metadata 7.1.0

    * Include the data sources in the makefile (even though they're not needed)

commit f4cc77d494ee0e10ed84ce369f0910c70a2f6d44
Author: Victor Stinner <vstinner@python.org>
Date:   Thu Mar 21 00:06:24 2024 +0100

    gh-116869: Enable -Werror in test_cext for Free Threading (#117106)

    Check for warnings, but don't enable the compiler flag
    -Werror=declaration-after-statement.

commit 104602a6078564765b7b8f42888f8eaa37b129b1
Author: Victor Stinner <vstinner@python.org>
Date:   Wed Mar 20 23:52:23 2024 +0100

    gh-105927: Limit PyWeakref_GetRef() to limited C API 3.13 (#117091)

commit 8ad88984200b2ccddc0a08229dd2f4c14d1a71fc
Author: Jason R. Coombs <jaraco@jaraco.com>
Date:   Wed Mar 20 17:11:00 2024 -0400

    gh-117089: Move importlib.metadata tests to their own package (#117092)

    * Ensure importlib.metadata tests do not leak references in sys.modules.

    * Move importlib.metadata tests to their own package for easier syncing with importlib_metadata.

    * Update owners and makefile for new directories.

    * Add blurb

commit 7d446548ef53f6c3de1097c6d44cada6642ddc85
Author: Carol Willing <carolcode@willingconsulting.com>
Date:   Wed Mar 20 14:00:59 2024 -0700

    Fix sort order for "locale encoding" glossary item (#115794)

    Co-authored-by: C.A.M. Gerlach <CAM.Gerlach@Gerlach.CAM>

commit 63289b9dfbc7d87e81f1517422ee91b6b6d19531
Author: Mark Shannon <mark@hotpy.org>
Date:   Wed Mar 20 18:24:02 2024 +0000

    GH-117066: Tier 2 optimizer: Don't throw away good traces if we can't optimize them perfectly. (GH-117067)

commit dcaf33a41d5d220523d71c9b35bc08f5b8405dac
Author: Petr Viktorin <encukou@gmail.com>
Date:   Wed Mar 20 17:33:08 2024 +0100

    gh-114314: ctypes: remove stgdict and switch to heap types (GH-116458)

    Before this change, ctypes classes used a custom dict subclass, `StgDict`,
    as their `tp_dict`. This acts like a regular dict but also includes extra information
    about the type.

    This replaces stgdict by `StgInfo`, a C struct on the type, accessed by
    `PyObject_GetTypeData()` (PEP-697).
    All usage of `StgDict` (mainly variables named `stgdict`, `dict`, `edict` etc.) is
    converted to `StgInfo` (named `stginfo`, `info`, `einfo`, etc.).
    Where the dict is actually used for class attributes (as a regular PyDict), it's now
    called `attrdict`.

    This change -- not overriding `tp_dict` -- is made to make me comfortable with
    the next part of this PR: moving the initialization logic from `tp_new` to `tp_init`.

    The `StgInfo` is set up in `__init__` of each class, with a guard that prevents
    calling `__init__` more than once. Note that abstract classes (like `Array` or
    `Structure`) are created using `PyType_FromMetaclass` and do not have
    `__init__` called.
    Previously, this was done in `__new__`, which also wasn't called for abstract
    classes.
    Since `__init__` can be called from Python code or skipped, there is a tested
    guard to ensure `StgInfo` is initialized exactly once before it's used.

    Co-authored-by: neonene <53406459+neonene@users.noreply.github.com>
    Co-authored-by: Erlend E. Aasland <erlend.aasland@protonmail.com>

commit 44fbab43d8f3f2df07091d237824cf4fa1f6c57c
Author: Russell Keith-Magee <russell@keith-magee.com>
Date:   Wed Mar 20 23:32:56 2024 +0800

    gh-117058: Update GUI and packaging recommendations for macOS. (#117059)

commit 9221ef2d8cb7f4cf37592eb650d4c8f972033000
Author: Brett Simmers <swtaarrs@users.noreply.github.com>
Date:   Wed Mar 20 08:18:26 2024 -0700

    gh-116908: Only write to `_pending_calls.calls_to_do` with atomic operations (#117044)

    These writes to `pending->calls_to_do` need to be atomic, because other threads
    can read (atomically) from `calls_to_do` without holding `pending->mutex`.

commit fc4599800778f9b130d5e336deadbdeb5bd3e5ee
Author: jkriegshauser <jkriegshauser@gmail.com>
Date:   Wed Mar 20 07:33:28 2024 -0700

    gh-116773: Ensure overlapped objects on Windows are not deallocated too early by asyncio (GH-116774)

commit 519b2ae22b54760475bbf62b9558d453c703f9c6
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Wed Mar 20 15:39:53 2024 +0200

    gh-117021: Fix integer overflow in PyLong_AsPid() on non-Windows 64-bit platforms (GH-117064)
```

[NGRsoftlab](/NGRsoftlab)
pushed a commit
to NGRsoftlab/cpython
that referenced
this pull request
[Apr 2, 2024](#ref-commit-a016a54)
[![@ngr-ilmarh](https://avatars.githubusercontent.com/u/161701313?s=40&v=4)](/ngr-ilmarh)

`[Squashed commit of the following:](/NGRsoftlab/cpython/commit/a016a5413a6d8bd02939a6fb9afef90dbbb2fb54 "Squashed commit of the following:

commit 9dae05ee59eeba0e67af2a46f2a2907c9f8d7e4a
Author: Moshe Kaplan <mosheekaplan@gmail.com>
Date:   Mon Apr 1 15:53:00 2024 -0400

    Docs: specify XML document name in xml.etree.elementtree example (#24223)

commit fc2071687b708598264a3403b7f9104667c1092f
Author: Matthew Davis <7035647+mdavis-xyz@users.noreply.github.com>
Date:   Mon Apr 1 21:49:14 2024 +0200

    Docs: add more links to PIPE in subprocess docs (#25416)

commit fc8007ee3635db6ab73e132ebff987c910b6d538
Author: Barney Gale <barney.gale@gmail.com>
Date:   Mon Apr 1 20:37:41 2024 +0100

    GH-117337: Deprecate `glob.glob0()` and `glob.glob1()`. (#117371)

    These undocumented functions are no longer used by `msilib`, so there's no
    reason to keep them around.

commit c741ad3537193c63fe697a8f0316aecd45eeb9ba
Author: Justin Turner Arthur <justinarthur@gmail.com>
Date:   Mon Apr 1 12:07:29 2024 -0500

    gh-77714: Provide an async iterator version of as_completed (GH-22491)

    * as_completed returns object that is both iterator and async iterator
    * Existing tests adjusted to test both the old and new style
    * New test to ensure iterator can be resumed
    * New test to ensure async iterator yields any passed-in Futures as-is

    Co-authored-by: Serhiy Storchaka <storchaka@gmail.com>
    Co-authored-by: Guido van Rossum <gvanrossum@gmail.com>

commit ddf814db744006e0f42328aa15ace97c9d8ad681
Author: Guido van Rossum <guido@python.org>
Date:   Mon Apr 1 09:13:38 2024 -0700

    Silence compiler warnings in gc.c (#117422)

commit 179869af922252a0c1cef65fd2923856895e7d1b
Author: Petr Viktorin <encukou@gmail.com>
Date:   Mon Apr 1 17:01:22 2024 +0200

    gh-94808: Fix refcounting in PyObject_Print tests (GH-117421)

commit dd44ab994b7262f0704d64996e0a1bc37b233407
Author: neonene <53406459+neonene@users.noreply.github.com>
Date:   Mon Apr 1 22:28:14 2024 +0900

    gh-117142: ctypes: Unify meta tp slot functions (GH-117143)

    Integrates the following ctypes meta tp slot functions:
    * `CDataType_traverse()` into `CType_Type_traverse()`.
    * `CDataType_clear()` into `CType_Type_clear()`.
    * `CDataType_dealloc()` into `CType_Type_dealloc()`.
    * `CDataType_repeat()` into `CType_Type_repeat()`.

commit 3de09cadde788065a4f2d45117e789c9353bbd12
Author: Steve (Gadget) Barnes <gadgetsteve@hotmail.com>
Date:   Mon Apr 1 14:02:07 2024 +0100

    gh-91565: Replace bugs.python.org links with Devguide/GitHub ones  (GH-91568)

    Co-authored-by: Hugo van Kemenade <hugovk@users.noreply.github.com>
    Co-authored-by: Oleg Iarygin <oleg@arhadthedev.net>
    Co-authored-by: Petr Viktorin <encukou@gmail.com>
    Co-authored-by: Ezio Melotti <ezio.melotti@gmail.com>

commit 90c3c68a658db6951b77a5be50088ec2f6adc8eb
Author: MonadChains <monadchains@gmail.com>
Date:   Mon Apr 1 13:52:25 2024 +0100

    gh-94808:Improve coverage of PyObject_Print (GH-98749)

commit 348cf6e0078eae156c503e8f61ef5e27ae28e57b
Author: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Date:   Mon Apr 1 11:14:37 2024 +0000

    Bump mypy from 1.8.0 to 1.9.0 in /Tools (#117418)

    Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
    Co-authored-by: Alex Waygood <Alex.Waygood@Gmail.com>

commit 9b403fb559bfce93a478937e0ef7e539a9a95283
Author: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Date:   Mon Apr 1 11:05:14 2024 +0000

    build(deps-dev): bump types-psutil from 5.9.5.20240205 to 5.9.5.20240316 in /Tools (#117417)

    Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
    Co-authored-by: Alex Waygood <Alex.Waygood@Gmail.com>

commit 93c7d9d17b571b6a181af7c02830d29819535c35
Author: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Date:   Mon Apr 1 11:38:38 2024 +0100

    build(deps-dev): bump types-setuptools from 69.1.0.20240301 to 69.2.0.20240317 in /Tools (#117419)

    Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

commit 3bb12e407c183946471272f8aee098e54e62a333
Author: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Date:   Mon Apr 1 09:54:33 2024 +0000

    build(deps): bump actions/add-to-project from 0.6.0 to 1.0.0 (#117415)

    Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

commit 56e99307c49adcc6df355f8070229371c97d654f
Author: Adorilson Bezerra <adorilson@gmail.com>
Date:   Sun Mar 31 23:34:54 2024 +0100

    Doc: printf-style library/stdtype improvements (#16741)

commit 18e12641a61a88f7d08b2114ebe965892c6661c5
Author: Raymond Hettinger <rhettinger@users.noreply.github.com>
Date:   Sun Mar 31 16:09:22 2024 -0500

    gh-117387 Remove hash mark from introductory text (#117409)

commit a32d6939486d7f90ee57e215077f6116e19de24d
Author: Deborah <32307299+dlwrnc@users.noreply.github.com>
Date:   Sun Mar 31 22:11:48 2024 +0200

    gh-102190: Add additional zipfile `pwd=` arg docstrings (gh-102195)

    This just documents the parameter that already exists.

    ---------

    Co-authored-by: Gregory P. Smith <greg@krypto.org>
    Co-authored-by: Erlend E. Aasland <erlend.aasland@protonmail.com>

commit 262445358e21c56d7c68e3ee76c13e469d2ea348
Author: Shantanu <12621235+hauntsaninja@users.noreply.github.com>
Date:   Sun Mar 31 12:02:48 2024 -0700

    Link to the Python type system specification (#117400)

commit 752e18389ed03087b51b38eac9769ef8dfd167b7
Author: Barney Gale <barney.gale@gmail.com>
Date:   Sun Mar 31 19:14:48 2024 +0100

    GH-114575: Rename `PurePath.pathmod` to `PurePath.parser` (#116513)

    And rename the private base class from `PathModuleBase` to `ParserBase`.

commit bfc57d43d8766120ba0c8f3f6d7b2ac681a81d8a
Author: Sam Gross <colesbury@gmail.com>
Date:   Fri Mar 29 18:58:08 2024 -0400

    gh-117303: Don't detach in `PyThreadState_DeleteCurrent()` (#117304)

    This fixes a crash in `test_threading.test_reinit_tls_after_fork()` when
    running with the GIL disabled. We already properly handle the case where
    the thread state is `_Py_THREAD_ATTACHED` in `tstate_delete_common()` --
    we just need to remove an assertion.

    Keeping the thread attached means that a stop-the-world pause, such as
    for a `fork()`, won't commence until we remove our thread state from the
    interpreter's linked list. This prevents a crash when the child process
    tries to clean up the dead thread states.

commit 05e0b67a43c5c1778dc2643c8b7c12864e135999
Author: Erlend E. Aasland <erlend@python.org>
Date:   Fri Mar 29 21:23:28 2024 +0100

    gh-116664: In _warnings.c, make filters_version access thread-safe (#117374)

    - assert that the lock is held in already_warned()
    - protect 'filters_version' increment in warnings_filters_mutated_impl()

commit 019143fecbfc26e69800d28d2a9e3392a051780b
Author: Jason R. Coombs <jaraco@jaraco.com>
Date:   Fri Mar 29 16:06:09 2024 -0400

    gh-117348: Refactored RawConfigParser._read for similicity and comprehensibility (#117372)

    * Extract method for _read_inner, reducing complexity and indentation by 1.

    * Extract method for _raise_all and yield ParseErrors from _read_inner.

    Reduces complexity by 1 and reduces touch points for handling errors in _read_inner.

    * Prefer iterators to splat expansion and literal indexing.

    * Extract method for _strip_comments. Reduces complexity by 7.

    * Model the file lines in a class to encapsulate the comment status and cleaned value.

    * Encapsulate the read state as a dataclass

    * Extract _handle_continuation_line and _handle_rest methods. Reduces complexity by 8.

    * Reindent

    * At least for now, collect errors in the ReadState

    * Check for missing section header separately.

    * Extract methods for _handle_header and _handle_option. Reduces complexity by 6.

    * Remove unreachable code. Reduces complexity by 4.

    * Remove unreachable branch

    * Handle error condition early. Reduces complexity by 1.

    * Add blurb

    * Move _raise_all to ParsingError, as its behavior is most closely related to the exception class and not the reader.

    * Split _strip* into separate methods.

    * Refactor _strip_full to compute the strip just once and use 'not any' to determine the factor.

    * Replace use of 'sys.maxsize' with direct computation of the stripped value.

    * Extract has_comments as a dynamic property.

    * Implement clean as a cached property.

    * Model comment prefixes in the RawConfigParser within a prefixes namespace.

    * Use a regular expression to search for the first match.

    Avoids mutating variables and tricky logic and over-computing all of the starts when only the first is relevant.

commit 01bd74eadbc4ff839d39762fae6366f50c1e116e
Author: Sam Gross <colesbury@gmail.com>
Date:   Fri Mar 29 15:33:06 2024 -0400

    gh-117300: Use stop the world to make `sys._current_frames` and `sys._current_exceptions` thread-safe. (#117301)

    This adds a stop the world pause to make the two functions thread-safe
    when the GIL is disabled in the free-threaded build.

    Additionally, the main test thread may call `sys._current_exceptions()` as
    soon as `g_raised.set()` is called. The background thread may not yet reach
    the `leave_g.wait()` line.

commit 94c97423a9c4969f8ddd4a3aa4aacb99c4d5263d
Author: Guido van Rossum <guido@python.org>
Date:   Fri Mar 29 11:31:09 2024 -0700

    Fix broken format in error for bad input in summarize_stats.py (#117375)

    When you pass the script a non-existent input file, you get a TypeError instead of the intended ValueError.

commit 5d21d884b6ffa45dac50a5f9a07c41356a8478b4
Author: mpage <mpage@meta.com>
Date:   Fri Mar 29 10:42:02 2024 -0700

    gh-111926: Avoid locking in PyType_IsSubtype (#117275)

    Read the MRO in a thread-unsafe way in `PyType_IsSubtype` to avoid locking. Fixing this is tracked in #117306.

    The motivation for this change is in support of making weakrefs thread-safe in free-threaded builds:

    `WeakValueDictionary` uses a special dictionary function, `_PyDict_DelItemIf`
    to remove dead weakrefs from the dictionary. `_PyDict_DelItemIf` removes a key
    if a user supplied predicate evaluates to true for the value associated with
    the key. Crucially for the `WeakValueDictionary` use case, the predicate
    evaluation + deletion sequence is atomic, provided that the predicate doesn’t
    suspend. The predicate used by `WeakValueDictionary` includes a subtype check,
    which we must ensure doesn't suspend in free-threaded builds.

commit 19c1dd60c5b53fb0533610ad139ef591294f26e8
Author: Sam Gross <colesbury@gmail.com>
Date:   Fri Mar 29 13:35:43 2024 -0400

    gh-117323: Make `cell` thread-safe in free-threaded builds (#117330)

    Use critical sections to lock around accesses to cell contents. The critical sections are no-ops in the default (with GIL) build.

commit 397d88db5e9ab2a43de3fdf5f8b973a949edc405
Author: Sam Gross <colesbury@gmail.com>
Date:   Fri Mar 29 13:34:04 2024 -0400

    gh-117344: Skip flaky tests in free-threaded build (#117355)

    The tests are not reliable with the GIL disabled. In theory, they can
    fail with the GIL enabled too, but the failures are much more likely
    with the GIL disabled.

commit f05fb2e65c2dffdfae940f2707765c4994925205
Author: Sam Gross <colesbury@gmail.com>
Date:   Fri Mar 29 13:33:04 2024 -0400

    gh-112529: Don't untrack tuples or dicts with zero refcount (#117370)

    The free-threaded GC sometimes sees objects with zero refcount. This can
    happen due to the delay in merging biased reference counting fields,
    and, in the future, due to deferred reference counting. We should not
    untrack these objects or they will never be collected.

    This fixes the refleaks in the free-threaded build.

commit ddf95b5f16031cdbd0d728e55eb06dff002a8678
Author: Erlend E. Aasland <erlend@python.org>
Date:   Fri Mar 29 18:26:06 2024 +0100

    gh-116664: Fix unused var warnings in _warnings.c in non-free-threaded builds (#117373)

    The warnings were introduced by commit c1712ef06.

commit 0fa571dbcdf19b541276cb00bb929381930467b2
Author: Tian Gao <gaogaotiantian@hotmail.com>
Date:   Fri Mar 29 09:02:01 2024 -0700

    Refactor pdb executable targets (#112570)

    Co-authored-by: Jason R. Coombs <jaraco@jaraco.com>

commit 54f7e14500471d1c46fb553adb3ca24cd1fef084
Author: Pedro Lacerda <pslacerda@users.noreply.github.com>
Date:   Fri Mar 29 12:05:00 2024 -0300

    gh-66449: configparser: Add support for unnamed sections (#117273)

    Co-authored-by: Jason R. Coombs <jaraco@jaraco.com>

commit d9cfe7e565a6e2dc15747a904736264e31a10be4
Author: Nikita Sobolev <mail@sobolevn.me>
Date:   Fri Mar 29 14:14:25 2024 +0300

    gh-117166: Ignore empty and temporary dirs in `test_makefile` (#117190)

commit 35b6c4a4da201a947b2ceb96ae4c0d83d4d2df4f
Author: Victor Stinner <vstinner@python.org>
Date:   Fri Mar 29 11:25:17 2024 +0100

    gh-117347: Fix test_clinic side effects (#117363)

    Save/restore converters in ClinicWholeFileTest and
    ClinicExternalTest.

commit 7e2fef865899837c47e91ef0180fa59eb03e840b
Author: neonene <53406459+neonene@users.noreply.github.com>
Date:   Fri Mar 29 18:40:48 2024 +0900

    gh-117142: ctypes: Migrate global vars to module state (GH-117189)

commit 2e9be80c99f635c2f7761e8356b0260922d6e7a6
Author: Gregory P. Smith <greg@krypto.org>
Date:   Thu Mar 28 17:58:37 2024 -0700

    Fix reversed assertRegex checks in test_ssl. (#117351)

commit 8eec7ed714e65d616573b7331780b0aa43c6ed6a
Author: 傅立业（Chris Fu） <17433201@qq.com>
Date:   Fri Mar 29 08:19:20 2024 +0800

    gh-117110: Fix subclasses of typing.Any with custom constructors (#117111)

commit a17f313e3958e825db9a83594c8471a984316536
Author: Christopher Chianelli <christopher@timefold.ai>
Date:   Thu Mar 28 18:26:56 2024 -0400

    gh-117339: Use NULL instead of None for LOAD_SUPER_ATTR in dis docs (GH-117343)

commit 26d328b2ba26374fb8d9ffe8215ecef7c5e3f7a2
Author: Michael Droettboom <mdboom@gmail.com>
Date:   Thu Mar 28 18:23:08 2024 -0400

    GH-117121: Add pystats to JIT builds (GH-117346)

commit 14f1ca7d5363386163839b31ce987423daecc3de
Author: Nice Zombies <nineteendo19d0@gmail.com>
Date:   Thu Mar 28 22:20:08 2024 +0100

    gh-117335: Handle non-iterables for `ntpath.commonpath` (GH-117336)

commit 18cf239e39e25e6cef50ecbb7f197a82f8920ff5
Author: Brandt Bucher <brandtbucher@microsoft.com>
Date:   Thu Mar 28 14:02:34 2024 -0700

    Increase the JIT CI timeouts to 75 minutes (GH-117342)

commit 29829b58a8328a7c2ccacaa74c1d7d120a5e5ca5
Author: Malcolm Smith <smith@chaquo.com>
Date:   Thu Mar 28 19:59:12 2024 +0000

    gh-117294: Report DocTestCase as skipped if all examples in the doctest are skipped (GH-117297)

commit efcc96844e7c66fcd6c23ac2d557ca141614ce9a
Author: Tian Gao <gaogaotiantian@hotmail.com>
Date:   Thu Mar 28 11:23:29 2024 -0700

    gh-69201: Separate stdout and stderr stream in test_pdb (#117308)

commit 6702d2bf6edcd5b5415e17837383623b9d76a5b8
Author: Victor Stinner <vstinner@python.org>
Date:   Thu Mar 28 17:40:58 2024 +0100

    gh-114331: Skip decimal test_maxcontext_exact_arith on s390x (#117326)

commit c1712ef066321c01bf09cba3f22fc474b5b8dfa7
Author: Erlend E. Aasland <erlend@python.org>
Date:   Thu Mar 28 16:05:08 2024 +0100

    gh-116664: Make module state Py_SETREF's in _warnings thread-safe (#116959)

    Mark the swap operations as critical sections.

    Add an internal Py_BEGIN_CRITICAL_SECTION_MUT API that takes a PyMutex
    pointer instead of a PyObject pointer.

commit 9a388b9a64927c372d85f0eaec3de9b7320a6fb5
Author: Joachim Wuttke <j.wuttke@fz-juelich.de>
Date:   Thu Mar 28 14:43:07 2024 +0100

    bpo-43848: explain optional argument mtime in gzip.py. (GH-25410)

    Co-authored-by: Jelle Zijlstra <jelle.zijlstra@gmail.com>

commit 8dbfdb2957a7baade3a88661517f163ad694c39f
Author: Sam Gross <colesbury@gmail.com>
Date:   Thu Mar 28 09:28:39 2024 -0400

    gh-110481: Fix biased reference counting queue initialization. (#117271)

    The biased reference counting queue must be initialized from the bound
    (active) thread because it uses `_Py_ThreadId()` as the key in a hash
    table.

commit 9a1e55b8c5723206116f7016921be3937ef2f4e5
Author: Chris Markiewicz <effigies@gmail.com>
Date:   Thu Mar 28 06:59:31 2024 -0400

    gh-117178: Recover lazy loading of self-referential modules (#117179)

commit 4c71d51a4b7989fc8754ba512c40e21666f9db0d
Author: Jelle Zijlstra <jelle.zijlstra@gmail.com>
Date:   Thu Mar 28 04:30:31 2024 -0600

    gh-117266: Fix crashes on user-created AST subclasses (GH-117276)

    Fix crashes on user-created AST subclasses

commit 8cb7d7ff86a1a2d41195f01ba4f218941dd7308c
Author: Gregory P. Smith <greg@krypto.org>
Date:   Thu Mar 28 03:11:58 2024 -0700

    gh-117310: Remove extra DECREF on \"no ciphers\" error path in `_ssl._SSLContext` constructor (#117309)

    Remove extra self DECREF on ssl \"no ciphers\" error path.

    This doesn't come up in practice because nobody links against a broken
    OpenSSL library that provides nothing.

commit 6c8ac8a32fd6de1960526561c44bc5603fab0f3e
Author: Erlend E. Aasland <erlend@python.org>
Date:   Thu Mar 28 09:40:37 2024 +0100

    gh-116303: Handle disabled test modules in test.support helpers (#116482)

    Make sure test.support helpers skip iso. failing if test extension
    modules are disabled. Also log TEST_MODULES in test.pythoninfo.

commit 0f27672c5002de96c9f1228b12460d5ce3f1d190
Author: Russell Keith-Magee <russell@keith-magee.com>
Date:   Thu Mar 28 16:13:13 2024 +0800

    gh-114099: Add documentation for iOS platform (GH-117057)

    Co-authored-by: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>
    Co-authored-by: Jacob Coffee <jacob@z7x.org>
    Co-authored-by: Malcolm Smith <smith@chaquo.com>
    Co-authored-by: Ned Deily <nad@python.org>

commit f006338017cfbf846e8f7391b9ee5f69df8dc620
Author: Russell Keith-Magee <russell@keith-magee.com>
Date:   Thu Mar 28 15:59:33 2024 +0800

    gh-114099: Additions to standard library to support iOS (GH-117052)

    Co-authored-by: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>
    Co-authored-by: Malcolm Smith <smith@chaquo.com>
    Co-authored-by: Ned Deily <nad@python.org>

commit b44898299a2ed97045c270f6474785da2ff07ced
Author: Tim Hatch <tim@timhatch.com>
Date:   Wed Mar 27 23:54:51 2024 -0700

    gh-89739: gh-77140: Support zip64 in zipimport (GH-94146)

    * Reads zip64 files as produced by the zipfile module
    * Include tests (somewhat slow, however, because of the need to create \"large\" zips)
    * About the same amount of strictness reading invalid zip files as zipfile has
    * Still works on files with prepended data (like pex)

    There are a lot more test cases at https://github.com/thatch/zipimport64/ that give me confidence that this works for real-world files.

    Fixes #89739 and #77140.

    ---------

    Co-authored-by: Itamar Ostricher <itamarost@gmail.com>
    Reviewed-by: Gregory P. Smith <greg@krypto.org>

commit 2cedd25c14d3acfdcb5e8ee55132ce3e334ab8fe
Author: Illia Volochii <illia.volochii@gmail.com>
Date:   Thu Mar 28 08:46:01 2024 +0200

    Revert \"gh-116886: Temporarily disable CIfuzz (memory) (GH-117018)\" (GH-117289)

    This reverts commit 1ab0d0b1167d78bf19661a3b5e533a2b68a57604.

    This reverts #117018.

    I expect the issue to be fixed based on https://github.com/google/oss-fuzz/pull/11708#issuecomment-2006442396 and https://github.com/actions/runner-images/issues/9491.

commit eefff682f09394fe4f18b7d7c6ac4c635caadd02
Author: Malcolm Smith <smith@chaquo.com>
Date:   Wed Mar 27 22:11:44 2024 +0000

    gh-108277: Make test_os tolerate 10 ms diff for timerfd on Android emulators (#117223)

commit 7aa89bc43e0bcf49eee5a39b5a7ba8f996f20d00
Author: Victor Stinner <vstinner@python.org>
Date:   Wed Mar 27 23:10:14 2024 +0100

    gh-113317: Change how Argument Clinic lists converters (#116853)

    * Add a new create_parser_namespace() function for
      PythonParser to pass objects to executed code.
    * In run_clinic(), list converters using 'converters' and
      'return_converters' dictionarties.
    * test_clinic: add 'object()' return converter.
    * Use also create_parser_namespace() in eval_ast_expr().

    Co-authored-by: Erlend E. Aasland <erlend@python.org>

commit 669ef49c7d42f35da6f7ee280102353b9b37f83e
Author: Seth Michael Larson <seth@python.org>
Date:   Wed Mar 27 16:56:14 2024 -0500

    gh-99108: Update and check HACL* version information (GH-117295)

    * Update and check HACL* version information

commit 262fb911ab7df8e890ebd0efb0773c3e0b5a757f
Author: Irit Katriel <1055913+iritkatriel@users.noreply.github.com>
Date:   Wed Mar 27 17:38:19 2024 +0000

    gh-117288: Allocate fewer label IDs in _PyCfg_ToInstructionSequence (#117290)

commit 74c8568d07719529b874897598d8b3bc25ff0434
Author: Malcolm Smith <smith@chaquo.com>
Date:   Wed Mar 27 16:53:27 2024 +0000

    gh-71042: Add `platform.android_ver` (#116674)

commit ce00de4c8cd39816f992e749c1074487d93abe9d
Author: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>
Date:   Wed Mar 27 16:46:35 2024 +0200

    gh-117225: doctest: only print \"and X failed\" when non-zero, don't pluralise \"1 items\" (#117228)

commit 92397d5ead38dde4154e70d00f24973bcf2a925a
Author: Raymond Hettinger <rhettinger@users.noreply.github.com>
Date:   Wed Mar 27 09:04:32 2024 -0500

    Add statistics recipe for sampling from an estimated probability density distribution (#117221)

commit b3e8c78ed7aa9bbd1084375587b99200c687cec9
Author: Tian Gao <gaogaotiantian@hotmail.com>
Date:   Tue Mar 26 18:20:12 2024 -0700

    gh-113548: Allow CLI arguments to `pdb -m` (#113557)

commit 48c0b05cf0dd2db275bd4653f84aa36c22bddcd2
Author: Adorilson Bezerra <adorilson@gmail.com>
Date:   Tue Mar 26 19:08:08 2024 +0000

    Change links on the index page (#117230)

commit af1b0e94400d1bf732466d675054df8cf7dfb62d
Author: AN Long <aisk@users.noreply.github.com>
Date:   Wed Mar 27 02:26:48 2024 +0800

    gh-104242: Enable test_is_char_device_true in pathlib test on all platform (GH-116983)

commit 79be75735c9d77972112cecc8d7e1af28c176ed0
Author: Irit Katriel <1055913+iritkatriel@users.noreply.github.com>
Date:   Tue Mar 26 15:18:17 2024 +0000

    gh-115775: Compiler adds __static_attributes__ field to classes (#115913)

commit 70969d53a77a8a190c40a30419e772bc874a4f62
Author: Antonio <57417288+amaddio@users.noreply.github.com>
Date:   Tue Mar 26 15:10:29 2024 +0100

    gh-97901 add missing text/rtf to mimetypes (GH-97902)

    Co-authored-by: Noam Cohen <noam@noam.me>

commit 4ec347760f98b156c6a2d42ca397af6b0b6ecc50
Author: AN Long <aisk@users.noreply.github.com>
Date:   Tue Mar 26 22:09:57 2024 +0800

    gh-115538: Use isolate mode when running venv test_multiprocessing_recursion() (#117116)

    Co-authored-by: Victor Stinner <vstinner@python.org>

commit 743f2c68f478279e1e56577fe95a0ed112b9abc5
Author: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>
Date:   Tue Mar 26 16:09:09 2024 +0200

    pre-commit: add `check-case-conflict` and `check-merge-conflict` (#117259)

commit 4abca7e1e7e2764faf20c7e677ea5c9ea9dbffe2
Author: Paulo Neves <ptsneves@users.noreply.github.com>
Date:   Tue Mar 26 13:37:50 2024 +0100

    gh-98966: Handle stdout=subprocess.STDOUT (GH-98967)

    Explicitly handle the case where stdout=STDOUT
    as otherwise the existing error handling gets
    confused and reports hard to understand errors.

    Signed-off-by: Paulo Neves <ptsneves@gmail.com>

commit 9654daf793b534b44a831c80f43505ab9e380f1f
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Tue Mar 26 13:26:45 2024 +0200

    gh-66543: Fix mimetype.guess_type() (GH-117217)

    Fix parsing of the following corner cases:

    * URLs with only a host name
    * URLs containing a fragment
    * URLs containing a query
    * filenames with only a UNC sharepoint on Windows

    Co-authored-by: Dong-hee Na <donghee.na92@gmail.com>

commit 8bef34f625e21886b1c64544c060e19ee2e229bf
Author: Mark Shannon <mark@hotpy.org>
Date:   Tue Mar 26 11:11:42 2024 +0000

    GH-117108: Set the \"old space bit\" to \"visited\" for all young objects  (#117213)

    Change old space bit of young objects from 0 to gcstate->visited_space.
    This ensures that any object created *and* collected during cycle GC has the bit set correctly.

commit bf82f77957a31c3731b4ec470c406f5708ca9ba3
Author: Mark Shannon <mark@hotpy.org>
Date:   Tue Mar 26 09:35:11 2024 +0000

    GH-116422: Tier2 hot/cold splitting (GH-116813)

    Splits the \"cold\" path, deopts and exits, from the \"hot\" path, reducing the size of most jitted instructions, at the cost of slower exits.

commit 61599a48f52e951d8813877ee311d2a830ba2cd8
Author: Pablo Galindo Salgado <Pablogsal@gmail.com>
Date:   Tue Mar 26 09:30:46 2024 +0000

    bpo-24612: Improve syntax error for 'not' after an operator (GH-28170)

    Co-authored-by: Lysandros Nikolaou <lisandrosnik@gmail.com>

commit 771902c257372e6c4df1ead4e8c46308561db7a7
Author: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>
Date:   Tue Mar 26 11:13:32 2024 +0200

    gh-83845: Add tests for operator module (#115883)

    Co-authored-by: Karthikeyan Singaravelan <tir.karthi@gmail.com>

commit ea9a296fce2f786b4cf43c7924e5de01061f27ca
Author: yevgeny hong <hongyevgeny@gmail.com>
Date:   Tue Mar 26 16:45:43 2024 +0900

    gh-115627: Fix PySSL_SetError handling SSL_ERROR_SYSCALL (GH-115628)

    Python 3.10 changed from using SSL_write() and SSL_read() to SSL_write_ex() and
    SSL_read_ex(), but did not update handling of the return value.

    Change error handling so that the return value is not examined.
    OSError (not EOF) is now returned when retval is 0.

    According to *recent* man pages of all functions for which we call
    PySSL_SetError, (in OpenSSL 3.0 and 1.1.1), their return value should
    be used to determine whether an error happened (i.e. if PySSL_SetError
    should be called), but not what kind of error happened (so,
    PySSL_SetError shouldn't need retval). To get the error,
    we need to use SSL_get_error.

    Co-authored-by: Serhiy Storchaka <storchaka@gmail.com>
    Co-authored-by: Petr Viktorin <encukou@gmail.com>

commit d52bdfb19fadd7614a0e5abaf68525fc7300e841
Author: Victor Stinner <vstinner@python.org>
Date:   Tue Mar 26 08:35:59 2024 +0100

    gh-83434: Disable XML in regrtest when -R option is used (#117232)

commit 9f74e86c78853c101a23e938f8e32ea838d8f62e
Author: Sebastian Pipping <sebastian@pipping.org>
Date:   Tue Mar 26 02:48:27 2024 +0100

    gh-117187: Fix XML tests for vanilla Expat <2.6.0 (GH-117203)

    This fixes XML unittest fallout from the https://github.com/python/cpython/issues/115398 security fix.  When configured using `--with-system-expat` on systems with older pre 2.6.0 versions of libexpat, our unittests were failing.

    * sax|etree: Simplify Expat version guard where simplifiable

    Idea by Matěj Cepl

    * sax|etree: Fix reparse deferral tests for vanilla Expat <2.6.0

    This *does not fix* the case of distros with an older version of libexpat with the 2.6.0 feature backported as a security fix.  (Ubuntu is a known example of this with its libexpat1 2.5.0-2ubunutu0.1 package)

commit 872e212378ef86392069034afd80bb53896fd93d
Author: Jonathan Protzenko <protz@microsoft.com>
Date:   Mon Mar 25 17:35:26 2024 -0700

    gh-99108: Refresh HACL*; update modules accordingly; fix namespacing (GH-117237)

    Pulls in a new update from https://github.com/hacl-star/hacl-star and fixes our C \"namespacing\" done by `Modules/_hacl/refresh.sh`.

commit 8945b7ff55b87d11c747af2dad0e3e4d631e62d6
Author: Eric V. Smith <ericvsmith@users.noreply.github.com>
Date:   Mon Mar 25 19:59:14 2024 -0400

    gh-109870: Dataclasses: batch up exec calls (gh-110851)

    Instead of calling `exec()` once for each function added to a dataclass, only call `exec()` once per dataclass. This can lead to speed improvements of up to 20%.

commit 7ebad77ad65ab4d5d8d0c333256a882262cec189
Author: Raymond Hettinger <rhettinger@users.noreply.github.com>
Date:   Mon Mar 25 18:49:44 2024 -0500

    Sync main docs and docstring for median_grouped(). (gh-117214)

commit 0821923aa979a72464c5da8dfa53a719bba5801c
Author: Nice Zombies <nineteendo19d0@gmail.com>
Date:   Mon Mar 25 23:55:11 2024 +0100

    gh-117114: Make os.path.isdevdrive available on all platforms (GH-117115)

commit c2276176d543a2fc2d57709c2787f99850fbb073
Author: Adorilson Bezerra <adorilson@gmail.com>
Date:   Mon Mar 25 22:34:20 2024 +0000

    Add information about negative  indexes to sequence datamodel doc (#110903)

    Co-authored by Terry Jan Reedy

commit 23e4f80ce2a2bac50acd1785e791316d5b578b8d
Author: Mark Shannon <mark@hotpy.org>
Date:   Mon Mar 25 20:43:51 2024 +0000

    A few minor tweaks to get stats working and compiling cleanly. (#117219)

    Fixes a compilation error when configured with `--enable-pystats`,
    an array size issue, and an unused variable.

commit 507896d97dcff2d7999efa264b29d9003c525c49
Author: Victor Stinner <vstinner@python.org>
Date:   Mon Mar 25 17:32:20 2024 +0100

    gh-116936: Add PyType_GetModuleByDef() to the limited C API (#116937)

commit 0c1a42cf9c8cd0d4534d5c1d58f118ce7c5c446e
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Mon Mar 25 17:32:11 2024 +0200

    gh-87193: Support bytes objects with refcount > 1 in _PyBytes_Resize() (GH-117160)

    Create a new bytes object and destroy the old one if it has refcount > 1.

commit 01e7405da400e8997f8964d06cc414045e144681
Author: Tian Gao <gaogaotiantian@hotmail.com>
Date:   Mon Mar 25 08:18:09 2024 -0700

    gh-112948: Make pdb completion similar to repl completion (#112950)

commit 9db2a8f914ad59019d448cecc43b6d45f46424a0
Author: Raymond Hettinger <rhettinger@users.noreply.github.com>
Date:   Mon Mar 25 09:26:42 2024 -0500

    Minor markup and grammar fixes in the statistics docs (gh-117216)

commit eebea7e515462b503632ada74923ec3246599c9c
Author: Kirill Podoprigora <kirill.bast9@mail.ru>
Date:   Sun Mar 24 20:34:55 2024 +0200

    gh-117176: Fix compiler warning in Python/optimizer_bytecodes.c (GH-117199)

commit 83485a095363dad6c97b19af2826ca0c34343bfc
Author: Totally a booplicate <53382877+Booplicate@users.noreply.github.com>
Date:   Sun Mar 24 18:48:40 2024 +0300

    gh-112571: Move fish venv activation script into the common folder (GH-117169)

    pythongh-112571: allow using fish venv activation script on windows

    The fish shell can be used on windows under cygwin or msys2.
    This change moves the script to the common folder
    so the venv module will install it on both posix and nt systems (like the bash script).

commit 78a651fd7fbe7a3d1702e40f4cbfa72d87241ef0
Author: Terry Jan Reedy <tjreedy@udel.edu>
Date:   Sun Mar 24 11:38:34 2024 -0400

    gh-117194: Properly format 'base64' header in What's New (#117198)

    It needs 6, not 3, '-'s.

commit f267d5bf2a99fbeb26a720d1c87c1f0557424b14
Author: Kerim Kabirov <the.privat33r+gh@pm.me>
Date:   Sun Mar 24 14:59:14 2024 +0100

    GH-115986 Docs: promote pprint.pp usage as a default (#116614)

    Co-authored-by: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>

commit 39df7732178c8e8f75b12f069a3dbc1715c99995
Author: LilKS <1244886+LilKS@users.noreply.github.com>
Date:   Sun Mar 24 11:01:07 2024 +0100

    gh-101760: Improve the imaplib.IMAP4 example (#101764)

    Co-authored-by: Adam Turner <9087854+AA-Turner@users.noreply.github.com>

commit a1e948edba9ec6ba61365429857f7a087c5edf51
Author: Raymond Hettinger <rhettinger@users.noreply.github.com>
Date:   Sun Mar 24 11:35:58 2024 +0200

    Add cumulative option for the new statistics.kde() function. (#117033)

commit d610d821fd210dce63a1132c274ffdf8acc510bc
Author: Irit Katriel <1055913+iritkatriel@users.noreply.github.com>
Date:   Sat Mar 23 22:32:33 2024 +0000

    gh-112383: teach dis how to interpret ENTER_EXECUTOR (#117171)

commit 6c83352bfe78a7d567c8d76257df6eb91d5a7245
Author: Ken Jin <kenjin@python.org>
Date:   Sun Mar 24 06:19:17 2024 +0800

    gh-117180: Complete call sequence when trace stack overflow (GH-117184)

    ---------

    Co-authored-by: Peter Lazorchak <lazorchakp@gmail.com>
    Co-authored-by: Guido van Rossum <gvanrossum@users.noreply.github.com>
    Co-authored-by: Guido van Rossum <gvanrossum@gmail.com>

commit f11d0d8be8af28e1368c3c7c116218cf65ddf93e
Author: Erik Soma <stillusingirc@gmail.com>
Date:   Sat Mar 23 11:39:35 2024 -0400

    gh-91227: Ignore ERROR_PORT_UNREACHABLE in proactor recvfrom() (#32011)

commit 9967b568edd2e35b0415c14c7242f3ca2c0dc03d
Author: Victor Stinner <vstinner@python.org>
Date:   Sat Mar 23 13:01:20 2024 +0100

    gh-117008: Fix functools test_recursive_pickle() (#117009)

    Use support.infinite_recursion() in test_recursive_pickle() of
    test_functools to prevent a stack overflow on \"ARM64 Windows
    Non-Debug\" buildbot.

    Lower Py_C_RECURSION_LIMIT to 1,000 frames on Windows ARM64.

commit 72eea512b88f8fd68b7258242c37da963ad87360
Author: Barney Gale <barney.gale@gmail.com>
Date:   Fri Mar 22 19:14:09 2024 +0000

    GH-106747: Document another difference between `glob` and `pathlib`. (#116518)

    Document that `path.glob()` might return *path*, whereas
    `glob.glob(root_dir=path)` will never return an empty string corresponding
    to *path*.

commit e28477f214276db941e715eebc8cdfb96c1207d9
Author: Mark Shannon <mark@hotpy.org>
Date:   Fri Mar 22 18:43:25 2024 +0000

    GH-117108: Change the size of the GC increment to about 1% of the total heap size. (GH-117120)

commit e2e0b4b4b92694ba894e02b4a66fd87c166ed10f
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Fri Mar 22 20:19:10 2024 +0200

    gh-113024: C API: Add PyObject_GenericHash() function (GH-113025)

commit 567ab3bd15398c8c7b791f3e376ae3e3c0bbe079
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Fri Mar 22 20:08:00 2024 +0200

    gh-117084: Fix ZIP file extraction for directory entry names with backslashes on Windows (GH-117129)

commit 5a78f6e798d5c2af1dba2df6c9f1f1e5aac02a86
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Fri Mar 22 20:03:48 2024 +0200

    gh-117134: Microoptimize glob() for include_hidden=True (GH-117135)

commit 00baaa21de229a6db80ff2b84c2fd6ad1999a24c
Author: Vinay Sajip <vinay_sajip@yahoo.co.uk>
Date:   Fri Mar 22 17:25:51 2024 +0000

    [docs] Fix typo in docstring and add example to logging cookbook. (GH-117157)

commit 40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f
Author: Jakub Stasiak <jakub@stasiak.at>
Date:   Fri Mar 22 17:49:56 2024 +0100

    GH-113171: Fix \"private\" (non-global) IP address ranges (GH-113179)

    * GH-113171: Fix \"private\" (really non-global) IP address ranges

    The _private_networks variables, used by various is_private
    implementations, were missing some ranges and at the same time had
    overly strict ranges (where there are more specific ranges considered
    globally reachable by the IANA registries).

    This patch updates the ranges with what was missing or otherwise
    incorrect.

    I left 100.64.0.0/10 alone, for now, as it's been made special in [1]
    and I'm not sure if we want to undo that as I don't quite understand the
    motivation behind it.

    The _address_exclude_many() call returns 8 networks for IPv4, 121
    networks for IPv6.

    [1] https://github.com/python/cpython/issues/61602

commit 3be9b9d8722696b95555937bb211dc4cda714d56
Author: Steve Dower <steve.dower@python.org>
Date:   Fri Mar 22 15:00:50 2024 +0000

    Fix get_packagefamilyname helper function on Windows 32-bit (GH-117153)

commit 63d6f2623ef2aa90f51c6a928b96845b9b380d89
Author: NGRsoftlab <78017794+NGRsoftlab@users.noreply.github.com>
Date:   Fri Mar 22 14:25:38 2024 +0300

    gh-117068: Remove useless code in bytesio.c:resize_buffer() (GH-117069)

    Co-authored-by: i.khabibulin <i.khabibulin@ngrsoftlab.ru>

commit 42ae924d278c48a719fb0ab86357f3235a9f7ab9
Author: Petr Viktorin <encukou@gmail.com>
Date:   Fri Mar 22 10:42:18 2024 +0100

    gh-117127: glob tests: Reopen dir_fd to pick up directory changes (GH-117128)

commit 8383915031942f441f435a5ae800790116047b80
Author: Tim Peters <tim.peters@gmail.com>
Date:   Thu Mar 21 22:27:25 2024 -0500

    GH-116939: Rewrite binarysort() (#116940)

    Rewrote binarysort() for clarity.

    Also changed the signature to be more coherent (it was mixing sortslice with raw pointers).

    No change in method or functionality. However, I left some experiments in, disabled for now
    via `#if` tricks. Since this code was first written, some kinds of comparisons have gotten
    enormously faster (like for lists of floats), which changes the tradeoffs.

    For example, plain insertion sort's simpler innermost loop and highly predictable branches
    leave it very competitive (even beating, by a bit) binary insertion when comparisons are
    very cheap, despite that it can do many more compares. And it wins big on runs that
    are already sorted (moving the next one in takes only 1 compare then).

    So I left code for a plain insertion sort, to make future experimenting easier.

    Also made the maximum value of minrun a `#define` (``MAX_MINRUN`) to make
    experimenting with that easier too.

    And another bit of `#if``-disabled code rewrites binary insertion's innermost loop to
    remove its unpredictable branch. Surprisingly, this doesn't really seem to help
    overall. I'm unclear on why not. It certainly adds more instructions, but they're very
    simple, and it's hard to be believe they cost as much as a branch miss.

commit 97ba910e47ad298114800587979ce7beb0a705a3
Author: Guido van Rossum <guido@python.org>
Date:   Thu Mar 21 18:27:48 2024 -0700

    gh-108716:: Remove _PyStaticCode_Init/Fini (#117141)

    More deepfreeze cleanup.

commit b3d25df8d38b79310587da54dbd88b06a16d4904
Author: Eric Snow <ericsnowcurrently@gmail.com>
Date:   Thu Mar 21 18:20:20 2024 -0600

    gh-105716: Fix _PyInterpreterState_IsRunningMain() For Embedders (gh-117140)

    When I added _PyInterpreterState_IsRunningMain() and friends last year, I tried to accommodate applications that embed Python but don't call _PyInterpreterState_SetRunningMain() (not that they're expected to).  That mostly worked fine until my recent changes in gh-117049, where the subtleties with the fallback code led to failures; the change ended up breaking test_tools.test_freeze, which exercises a basic embedding situation.

    The simplest fix is to drop the fallback code I originally added to _PyInterpreterState_IsRunningMain() (and later to _PyThreadState_IsRunningMain()).  I've kept the fallback in the _xxsubinterpreters module though.  I've also updated Py_FrozenMain() to call _PyInterpreterState_SetRunningMain().

commit c4bf58a14f162557038a1535ca22c52b49d81d7b
Author: Thomas A Caswell <tcaswell@gmail.com>
Date:   Thu Mar 21 19:54:50 2024 -0400

    gh-116745: Remove all internal usage of @LIBPYTHON@ (#116746)

    Replace with MODULE_LDFLAGS.

commit 3ec57307e70ee6f42410e844d3399bbd598917ba
Author: Malcolm Smith <smith@chaquo.com>
Date:   Thu Mar 21 23:52:29 2024 +0000

    gh-71052: Add Android build script and instructions (#116426)

commit 50f9b0b1e0fb181875751cef951351ed007b6397
Author: Victor Stinner <vstinner@python.org>
Date:   Thu Mar 21 23:17:09 2024 +0100

    gh-117061: Fix test_posix.test_sched_setaffinity() on RHEL9 (#117126)

    On RHEL9, sched_setaffinity(0, []) does not fail.

commit 0907871d43bffb613cbd560224e1a9db13d06c06
Author: Ned Batchelder <ned@nedbatchelder.com>
Date:   Thu Mar 21 15:47:09 2024 -0400

    docs: fix over-linking in dataclasses.rst (#117005)

commit 570a82d46abfebb9976961113fb0f8bb400ad182
Author: Guido van Rossum <guido@python.org>
Date:   Thu Mar 21 12:37:41 2024 -0700

    gh-117045: Add code object to function version cache (#117028)

    Changes to the function version cache:

    - In addition to the function object, also store the code object,
      and allow the latter to be retrieved even if the function has been evicted.
    - Stop assigning new function versions after a critical attribute (e.g. `__code__`)
      has been modified; the version is permanently reset to zero in this case.
    - Changes to `__annotations__` are no longer considered critical. (This fixes gh-109998.)

    Changes to the Tier 2 optimization machinery:

    - If we cannot map a function version to a function, but it is still mapped to a code object,
      we continue projecting the trace.
      The operand of the `_PUSH_FRAME` and `_POP_FRAME` opcodes can be either NULL,
      a function object, or a code object with the lowest bit set.

    This allows us to trace through code that calls an ephemeral function,
    i.e., a function that may not be alive when we are constructing the executor,
    e.g. a generator expression or certain nested functions.
    We will lose globals removal inside such functions,
    but we can still do other peephole operations
    (and even possibly [call inlining](https://github.com/python/cpython/pull/116290),
    if we decide to do it), which only need the code object.
    As before, if we cannot retrieve the code object from the cache, we stop projecting.

commit c85d84166a84a5cb2d724012726bad34229ad24e
Author: Will Childs-Klein <willck93@gmail.com>
Date:   Thu Mar 21 14:16:36 2024 -0500

    gh-116333: Relax error string text expectations in SSL-related tests (GH-116334)

    * Relax error string text expectations in SSL-related tests

    As suggested [here][1], this change relaxes the OpenSSL error string
    text expectations in a number of tests. This was specifically done in
    support of more easily building CPython [AWS-LC][2], but because AWS-LC
    is a fork of [BoringSSL][3], it should increase compatibility with that
    library as well.

    In addition to the error string relaxations, we also add some guards
    around the `tls-unique` channel binding being used with TLSv1.3, as that
    feature (described in [RFC 6929][4]) is [not defined][5] for TLSv1.3.

    [1]: https://discuss.python.org/t/support-building-ssl-and-hashlib-modules-against-aws-lc/44505/4
    [2]: https://github.com/aws/aws-lc
    [3]: https://github.com/google/boringssl
    [4]: https://datatracker.ietf.org/doc/html/rfc5929#section-3
    [5]: https://datatracker.ietf.org/doc/html/rfc8446#appendix-C.5

commit 1f72fb5447ef3f8892b4a7a6213522579c618e8e
Author: Sam Gross <colesbury@gmail.com>
Date:   Thu Mar 21 14:21:02 2024 -0400

    gh-116522: Refactor `_PyThreadState_DeleteExcept` (#117131)

    Split `_PyThreadState_DeleteExcept` into two functions:

    - `_PyThreadState_RemoveExcept` removes all thread states other than one
      passed as an argument. It returns the removed thread states as a
      linked list.

    - `_PyThreadState_DeleteList` deletes those dead thread states. It may
      call destructors, so we want to \"start the world\" before calling
      `_PyThreadState_DeleteList` to avoid potential deadlocks.

commit 50369e6c34d05222e5a0ec9443a9f7b230e83112
Author: Michael Droettboom <mdboom@gmail.com>
Date:   Thu Mar 21 13:27:46 2024 -0400

    gh-116996: Add pystats about _Py_uop_analyse_and_optimize (GH-116997)

commit 617158e07811edfd6fd552a3d84b0beedd8f1d18
Author: Eric Snow <ericsnowcurrently@gmail.com>
Date:   Thu Mar 21 11:15:02 2024 -0600

    gh-76785: Drop PyInterpreterID_Type (gh-117101)

    I added it quite a while ago as a strategy for managing interpreter lifetimes relative to the PEP 554 (now 734) implementation.  Relatively recently I refactored that implementation to no longer rely on InterpreterID objects.  Thus now I'm removing it.

commit abdd1f938f08e536864532b2071f144515ecc88b
Author: Victor Stinner <vstinner@python.org>
Date:   Thu Mar 21 17:45:43 2024 +0100

    gh-85283: Build _testconsole extension with limited C API (#117125)

commit 8bea6c411d65cd987616b4ecdb86373e4f21f1c6
Author: Victor Stinner <vstinner@python.org>
Date:   Thu Mar 21 17:07:00 2024 +0100

    gh-115754: Add Py_GetConstant() function (#116883)

    Add Py_GetConstant() and Py_GetConstantBorrowed() functions.

    In the limited C API version 3.13, getting Py_None, Py_False,
    Py_True, Py_Ellipsis and Py_NotImplemented singletons is now
    implemented as function calls at the stable ABI level to hide
    implementation details. Getting these constants still return borrowed
    references.

    Add _testlimitedcapi/object.c and test_capi/test_object.py to test
    Py_GetConstant() and Py_GetConstantBorrowed() functions.

commit 5a76d1be8ef371b75ca65166726923c249b5f615
Author: Eric Snow <ericsnowcurrently@gmail.com>
Date:   Thu Mar 21 10:06:35 2024 -0600

    gh-105716: Update interp->threads.main After Fork (gh-117049)

    I missed this in gh-109921.

    We also update Py_Exit() to call _PyInterpreterState_SetNotRunningMain(), if necessary.

commit bbee57fa8c318cb26d6c8651254927a1972c9738
Author: Eric Snow <ericsnowcurrently@gmail.com>
Date:   Thu Mar 21 09:56:12 2024 -0600

    gh-76785: Clean Up Interpreter ID Conversions (gh-117048)

    Mostly we unify the two different implementations of the conversion code (from PyObject * to int64_t.  We also drop the PyArg_ParseTuple()-style converter function, as well as rename and move PyInterpreterID_LookUp().

commit e728303532168efab7694c55c82ea19b18bf8385
Author: Sam Gross <colesbury@gmail.com>
Date:   Thu Mar 21 10:01:16 2024 -0400

    gh-116522: Stop the world before fork() and during shutdown (#116607)

    This changes the free-threaded build to perform a stop-the-world pause
    before deleting other thread states when forking and during shutdown.
    This fixes some crashes when using multiprocessing and during shutdown
    when running with `PYTHON_GIL=0`.

    This also changes `PyOS_BeforeFork` to acquire the runtime lock
    (i.e., `HEAD_LOCK(&_PyRuntime)`) before forking to ensure that data
    protected by the runtime lock (and not just the GIL or stop-the-world)
    is in a consistent state before forking.

commit 1f8b24ef69896680d6ba6005e75e1cc79a744f9e
Author: Malcolm Smith <smith@chaquo.com>
Date:   Thu Mar 21 13:20:57 2024 +0000

    gh-71052: Implement `ctypes.util.find_library` on Android (GH-116379)

commit d16c9d1278164f04778861814ebc87ed087511fc
Author: Tian Gao <gaogaotiantian@hotmail.com>
Date:   Thu Mar 21 03:30:10 2024 -0700

    gh-116987: Support class code objects in inspect.findsource() (GH-117025)

commit 6547330f4e896c6748da23704b617e060e6cc68e
Author: Adam Turner <9087854+AA-Turner@users.noreply.github.com>
Date:   Thu Mar 21 03:49:10 2024 +0000

    GH-109653: Defer import of ``importlib.metadata._adapters`` (#109829)

    * adapters

    * Add comments for deferred imports with links to rationale.

    * Add blurb

    ---------

    Co-authored-by: Jason R. Coombs <jaraco@jaraco.com>

commit 667294d5b2ee812ebe0c9c1efd58e2006b61f827
Author: Jason R. Coombs <jaraco@jaraco.com>
Date:   Wed Mar 20 23:01:24 2024 -0400

    gh-117089: Apply changes from importlib_metadata 7.1.0 (#117094)

    * Apply changes from importlib_metadata 7.1.0

    * Include the data sources in the makefile (even though they're not needed)

commit f4cc77d494ee0e10ed84ce369f0910c70a2f6d44
Author: Victor Stinner <vstinner@python.org>
Date:   Thu Mar 21 00:06:24 2024 +0100

    gh-116869: Enable -Werror in test_cext for Free Threading (#117106)

    Check for warnings, but don't enable the compiler flag
    -Werror=declaration-after-statement.

commit 104602a6078564765b7b8f42888f8eaa37b129b1
Author: Victor Stinner <vstinner@python.org>
Date:   Wed Mar 20 23:52:23 2024 +0100

    gh-105927: Limit PyWeakref_GetRef() to limited C API 3.13 (#117091)

commit 8ad88984200b2ccddc0a08229dd2f4c14d1a71fc
Author: Jason R. Coombs <jaraco@jaraco.com>
Date:   Wed Mar 20 17:11:00 2024 -0400

    gh-117089: Move importlib.metadata tests to their own package (#117092)

    * Ensure importlib.metadata tests do not leak references in sys.modules.

    * Move importlib.metadata tests to their own package for easier syncing with importlib_metadata.

    * Update owners and makefile for new directories.

    * Add blurb

commit 7d446548ef53f6c3de1097c6d44cada6642ddc85
Author: Carol Willing <carolcode@willingconsulting.com>
Date:   Wed Mar 20 14:00:59 2024 -0700

    Fix sort order for \"locale encoding\" glossary item (#115794)

    Co-authored-by: C.A.M. Gerlach <CAM.Gerlach@Gerlach.CAM>

commit 63289b9dfbc7d87e81f1517422ee91b6b6d19531
Author: Mark Shannon <mark@hotpy.org>
Date:   Wed Mar 20 18:24:02 2024 +0000

    GH-117066: Tier 2 optimizer: Don't throw away good traces if we can't optimize them perfectly. (GH-117067)

commit dcaf33a41d5d220523d71c9b35bc08f5b8405dac
Author: Petr Viktorin <encukou@gmail.com>
Date:   Wed Mar 20 17:33:08 2024 +0100

    gh-114314: ctypes: remove stgdict and switch to heap types (GH-116458)

    Before this change, ctypes classes used a custom dict subclass, `StgDict`,
    as their `tp_dict`. This acts like a regular dict but also includes extra information
    about the type.

    This replaces stgdict by `StgInfo`, a C struct on the type, accessed by
    `PyObject_GetTypeData()` (PEP-697).
    All usage of `StgDict` (mainly variables named `stgdict`, `dict`, `edict` etc.) is
    converted to `StgInfo` (named `stginfo`, `info`, `einfo`, etc.).
    Where the dict is actually used for class attributes (as a regular PyDict), it's now
    called `attrdict`.

    This change -- not overriding `tp_dict` -- is made to make me comfortable with
    the next part of this PR: moving the initialization logic from `tp_new` to `tp_init`.

    The `StgInfo` is set up in `__init__` of each class, with a guard that prevents
    calling `__init__` more than once. Note that abstract classes (like `Array` or
    `Structure`) are created using `PyType_FromMetaclass` and do not have
    `__init__` called.
    Previously, this was done in `__new__`, which also wasn't called for abstract
    classes.
    Since `__init__` can be called from Python code or skipped, there is a tested
    guard to ensure `StgInfo` is initialized exactly once before it's used.

    Co-authored-by: neonene <53406459+neonene@users.noreply.github.com>
    Co-authored-by: Erlend E. Aasland <erlend.aasland@protonmail.com>

commit 44fbab43d8f3f2df07091d237824cf4fa1f6c57c
Author: Russell Keith-Magee <russell@keith-magee.com>
Date:   Wed Mar 20 23:32:56 2024 +0800

    gh-117058: Update GUI and packaging recommendations for macOS. (#117059)

commit 9221ef2d8cb7f4cf37592eb650d4c8f972033000
Author: Brett Simmers <swtaarrs@users.noreply.github.com>
Date:   Wed Mar 20 08:18:26 2024 -0700

    gh-116908: Only write to `_pending_calls.calls_to_do` with atomic operations (#117044)

    These writes to `pending->calls_to_do` need to be atomic, because other threads
    can read (atomically) from `calls_to_do` without holding `pending->mutex`.

commit fc4599800778f9b130d5e336deadbdeb5bd3e5ee
Author: jkriegshauser <jkriegshauser@gmail.com>
Date:   Wed Mar 20 07:33:28 2024 -0700

    gh-116773: Ensure overlapped objects on Windows are not deallocated too early by asyncio (GH-116774)

commit 519b2ae22b54760475bbf62b9558d453c703f9c6
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Wed Mar 20 15:39:53 2024 +0200

    gh-117021: Fix integer overflow in PyLong_AsPid() on non-Windows 64-bit platforms (GH-117064)")`
…

`[a016a54](/NGRsoftlab/cpython/commit/a016a5413a6d8bd02939a6fb9afef90dbbb2fb54)`

```
commit 9dae05ee59eeba0e67af2a46f2a2907c9f8d7e4a
Author: Moshe Kaplan <mosheekaplan@gmail.com>
Date:   Mon Apr 1 15:53:00 2024 -0400

    Docs: specify XML document name in xml.etree.elementtree example (#24223)

commit fc2071687b708598264a3403b7f9104667c1092f
Author: Matthew Davis <7035647+mdavis-xyz@users.noreply.github.com>
Date:   Mon Apr 1 21:49:14 2024 +0200

    Docs: add more links to PIPE in subprocess docs (#25416)

commit fc8007ee3635db6ab73e132ebff987c910b6d538
Author: Barney Gale <barney.gale@gmail.com>
Date:   Mon Apr 1 20:37:41 2024 +0100

    GH-117337: Deprecate `glob.glob0()` and `glob.glob1()`. (#117371)

    These undocumented functions are no longer used by `msilib`, so there's no
    reason to keep them around.

commit c741ad3537193c63fe697a8f0316aecd45eeb9ba
Author: Justin Turner Arthur <justinarthur@gmail.com>
Date:   Mon Apr 1 12:07:29 2024 -0500

    gh-77714: Provide an async iterator version of as_completed (GH-22491)

    * as_completed returns object that is both iterator and async iterator
    * Existing tests adjusted to test both the old and new style
    * New test to ensure iterator can be resumed
    * New test to ensure async iterator yields any passed-in Futures as-is

    Co-authored-by: Serhiy Storchaka <storchaka@gmail.com>
    Co-authored-by: Guido van Rossum <gvanrossum@gmail.com>

commit ddf814db744006e0f42328aa15ace97c9d8ad681
Author: Guido van Rossum <guido@python.org>
Date:   Mon Apr 1 09:13:38 2024 -0700

    Silence compiler warnings in gc.c (#117422)

commit 179869af922252a0c1cef65fd2923856895e7d1b
Author: Petr Viktorin <encukou@gmail.com>
Date:   Mon Apr 1 17:01:22 2024 +0200

    gh-94808: Fix refcounting in PyObject_Print tests (GH-117421)

commit dd44ab994b7262f0704d64996e0a1bc37b233407
Author: neonene <53406459+neonene@users.noreply.github.com>
Date:   Mon Apr 1 22:28:14 2024 +0900

    gh-117142: ctypes: Unify meta tp slot functions (GH-117143)

    Integrates the following ctypes meta tp slot functions:
    * `CDataType_traverse()` into `CType_Type_traverse()`.
    * `CDataType_clear()` into `CType_Type_clear()`.
    * `CDataType_dealloc()` into `CType_Type_dealloc()`.
    * `CDataType_repeat()` into `CType_Type_repeat()`.

commit 3de09cadde788065a4f2d45117e789c9353bbd12
Author: Steve (Gadget) Barnes <gadgetsteve@hotmail.com>
Date:   Mon Apr 1 14:02:07 2024 +0100

    gh-91565: Replace bugs.python.org links with Devguide/GitHub ones  (GH-91568)

    Co-authored-by: Hugo van Kemenade <hugovk@users.noreply.github.com>
    Co-authored-by: Oleg Iarygin <oleg@arhadthedev.net>
    Co-authored-by: Petr Viktorin <encukou@gmail.com>
    Co-authored-by: Ezio Melotti <ezio.melotti@gmail.com>

commit 90c3c68a658db6951b77a5be50088ec2f6adc8eb
Author: MonadChains <monadchains@gmail.com>
Date:   Mon Apr 1 13:52:25 2024 +0100

    gh-94808:Improve coverage of PyObject_Print (GH-98749)

commit 348cf6e0078eae156c503e8f61ef5e27ae28e57b
Author: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Date:   Mon Apr 1 11:14:37 2024 +0000

    Bump mypy from 1.8.0 to 1.9.0 in /Tools (#117418)

    Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
    Co-authored-by: Alex Waygood <Alex.Waygood@Gmail.com>

commit 9b403fb559bfce93a478937e0ef7e539a9a95283
Author: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Date:   Mon Apr 1 11:05:14 2024 +0000

    build(deps-dev): bump types-psutil from 5.9.5.20240205 to 5.9.5.20240316 in /Tools (#117417)

    Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
    Co-authored-by: Alex Waygood <Alex.Waygood@Gmail.com>

commit 93c7d9d17b571b6a181af7c02830d29819535c35
Author: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Date:   Mon Apr 1 11:38:38 2024 +0100

    build(deps-dev): bump types-setuptools from 69.1.0.20240301 to 69.2.0.20240317 in /Tools (#117419)

    Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

commit 3bb12e407c183946471272f8aee098e54e62a333
Author: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Date:   Mon Apr 1 09:54:33 2024 +0000

    build(deps): bump actions/add-to-project from 0.6.0 to 1.0.0 (#117415)

    Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

commit 56e99307c49adcc6df355f8070229371c97d654f
Author: Adorilson Bezerra <adorilson@gmail.com>
Date:   Sun Mar 31 23:34:54 2024 +0100

    Doc: printf-style library/stdtype improvements (#16741)

commit 18e12641a61a88f7d08b2114ebe965892c6661c5
Author: Raymond Hettinger <rhettinger@users.noreply.github.com>
Date:   Sun Mar 31 16:09:22 2024 -0500

    gh-117387 Remove hash mark from introductory text (#117409)

commit a32d6939486d7f90ee57e215077f6116e19de24d
Author: Deborah <32307299+dlwrnc@users.noreply.github.com>
Date:   Sun Mar 31 22:11:48 2024 +0200

    gh-102190: Add additional zipfile `pwd=` arg docstrings (gh-102195)

    This just documents the parameter that already exists.

    ---------

    Co-authored-by: Gregory P. Smith <greg@krypto.org>
    Co-authored-by: Erlend E. Aasland <erlend.aasland@protonmail.com>

commit 262445358e21c56d7c68e3ee76c13e469d2ea348
Author: Shantanu <12621235+hauntsaninja@users.noreply.github.com>
Date:   Sun Mar 31 12:02:48 2024 -0700

    Link to the Python type system specification (#117400)

commit 752e18389ed03087b51b38eac9769ef8dfd167b7
Author: Barney Gale <barney.gale@gmail.com>
Date:   Sun Mar 31 19:14:48 2024 +0100

    GH-114575: Rename `PurePath.pathmod` to `PurePath.parser` (#116513)

    And rename the private base class from `PathModuleBase` to `ParserBase`.

commit bfc57d43d8766120ba0c8f3f6d7b2ac681a81d8a
Author: Sam Gross <colesbury@gmail.com>
Date:   Fri Mar 29 18:58:08 2024 -0400

    gh-117303: Don't detach in `PyThreadState_DeleteCurrent()` (#117304)

    This fixes a crash in `test_threading.test_reinit_tls_after_fork()` when
    running with the GIL disabled. We already properly handle the case where
    the thread state is `_Py_THREAD_ATTACHED` in `tstate_delete_common()` --
    we just need to remove an assertion.

    Keeping the thread attached means that a stop-the-world pause, such as
    for a `fork()`, won't commence until we remove our thread state from the
    interpreter's linked list. This prevents a crash when the child process
    tries to clean up the dead thread states.

commit 05e0b67a43c5c1778dc2643c8b7c12864e135999
Author: Erlend E. Aasland <erlend@python.org>
Date:   Fri Mar 29 21:23:28 2024 +0100

    gh-116664: In _warnings.c, make filters_version access thread-safe (#117374)

    - assert that the lock is held in already_warned()
    - protect 'filters_version' increment in warnings_filters_mutated_impl()

commit 019143fecbfc26e69800d28d2a9e3392a051780b
Author: Jason R. Coombs <jaraco@jaraco.com>
Date:   Fri Mar 29 16:06:09 2024 -0400

    gh-117348: Refactored RawConfigParser._read for similicity and comprehensibility (#117372)

    * Extract method for _read_inner, reducing complexity and indentation by 1.

    * Extract method for _raise_all and yield ParseErrors from _read_inner.

    Reduces complexity by 1 and reduces touch points for handling errors in _read_inner.

    * Prefer iterators to splat expansion and literal indexing.

    * Extract method for _strip_comments. Reduces complexity by 7.

    * Model the file lines in a class to encapsulate the comment status and cleaned value.

    * Encapsulate the read state as a dataclass

    * Extract _handle_continuation_line and _handle_rest methods. Reduces complexity by 8.

    * Reindent

    * At least for now, collect errors in the ReadState

    * Check for missing section header separately.

    * Extract methods for _handle_header and _handle_option. Reduces complexity by 6.

    * Remove unreachable code. Reduces complexity by 4.

    * Remove unreachable branch

    * Handle error condition early. Reduces complexity by 1.

    * Add blurb

    * Move _raise_all to ParsingError, as its behavior is most closely related to the exception class and not the reader.

    * Split _strip* into separate methods.

    * Refactor _strip_full to compute the strip just once and use 'not any' to determine the factor.

    * Replace use of 'sys.maxsize' with direct computation of the stripped value.

    * Extract has_comments as a dynamic property.

    * Implement clean as a cached property.

    * Model comment prefixes in the RawConfigParser within a prefixes namespace.

    * Use a regular expression to search for the first match.

    Avoids mutating variables and tricky logic and over-computing all of the starts when only the first is relevant.

commit 01bd74eadbc4ff839d39762fae6366f50c1e116e
Author: Sam Gross <colesbury@gmail.com>
Date:   Fri Mar 29 15:33:06 2024 -0400

    gh-117300: Use stop the world to make `sys._current_frames` and `sys._current_exceptions` thread-safe. (#117301)

    This adds a stop the world pause to make the two functions thread-safe
    when the GIL is disabled in the free-threaded build.

    Additionally, the main test thread may call `sys._current_exceptions()` as
    soon as `g_raised.set()` is called. The background thread may not yet reach
    the `leave_g.wait()` line.

commit 94c97423a9c4969f8ddd4a3aa4aacb99c4d5263d
Author: Guido van Rossum <guido@python.org>
Date:   Fri Mar 29 11:31:09 2024 -0700

    Fix broken format in error for bad input in summarize_stats.py (#117375)

    When you pass the script a non-existent input file, you get a TypeError instead of the intended ValueError.

commit 5d21d884b6ffa45dac50a5f9a07c41356a8478b4
Author: mpage <mpage@meta.com>
Date:   Fri Mar 29 10:42:02 2024 -0700

    gh-111926: Avoid locking in PyType_IsSubtype (#117275)

    Read the MRO in a thread-unsafe way in `PyType_IsSubtype` to avoid locking. Fixing this is tracked in #117306.

    The motivation for this change is in support of making weakrefs thread-safe in free-threaded builds:

    `WeakValueDictionary` uses a special dictionary function, `_PyDict_DelItemIf`
    to remove dead weakrefs from the dictionary. `_PyDict_DelItemIf` removes a key
    if a user supplied predicate evaluates to true for the value associated with
    the key. Crucially for the `WeakValueDictionary` use case, the predicate
    evaluation + deletion sequence is atomic, provided that the predicate doesn’t
    suspend. The predicate used by `WeakValueDictionary` includes a subtype check,
    which we must ensure doesn't suspend in free-threaded builds.

commit 19c1dd60c5b53fb0533610ad139ef591294f26e8
Author: Sam Gross <colesbury@gmail.com>
Date:   Fri Mar 29 13:35:43 2024 -0400

    gh-117323: Make `cell` thread-safe in free-threaded builds (#117330)

    Use critical sections to lock around accesses to cell contents. The critical sections are no-ops in the default (with GIL) build.

commit 397d88db5e9ab2a43de3fdf5f8b973a949edc405
Author: Sam Gross <colesbury@gmail.com>
Date:   Fri Mar 29 13:34:04 2024 -0400

    gh-117344: Skip flaky tests in free-threaded build (#117355)

    The tests are not reliable with the GIL disabled. In theory, they can
    fail with the GIL enabled too, but the failures are much more likely
    with the GIL disabled.

commit f05fb2e65c2dffdfae940f2707765c4994925205
Author: Sam Gross <colesbury@gmail.com>
Date:   Fri Mar 29 13:33:04 2024 -0400

    gh-112529: Don't untrack tuples or dicts with zero refcount (#117370)

    The free-threaded GC sometimes sees objects with zero refcount. This can
    happen due to the delay in merging biased reference counting fields,
    and, in the future, due to deferred reference counting. We should not
    untrack these objects or they will never be collected.

    This fixes the refleaks in the free-threaded build.

commit ddf95b5f16031cdbd0d728e55eb06dff002a8678
Author: Erlend E. Aasland <erlend@python.org>
Date:   Fri Mar 29 18:26:06 2024 +0100

    gh-116664: Fix unused var warnings in _warnings.c in non-free-threaded builds (#117373)

    The warnings were introduced by commit c1712ef06.

commit 0fa571dbcdf19b541276cb00bb929381930467b2
Author: Tian Gao <gaogaotiantian@hotmail.com>
Date:   Fri Mar 29 09:02:01 2024 -0700

    Refactor pdb executable targets (#112570)

    Co-authored-by: Jason R. Coombs <jaraco@jaraco.com>

commit 54f7e14500471d1c46fb553adb3ca24cd1fef084
Author: Pedro Lacerda <pslacerda@users.noreply.github.com>
Date:   Fri Mar 29 12:05:00 2024 -0300

    gh-66449: configparser: Add support for unnamed sections (#117273)

    Co-authored-by: Jason R. Coombs <jaraco@jaraco.com>

commit d9cfe7e565a6e2dc15747a904736264e31a10be4
Author: Nikita Sobolev <mail@sobolevn.me>
Date:   Fri Mar 29 14:14:25 2024 +0300

    gh-117166: Ignore empty and temporary dirs in `test_makefile` (#117190)

commit 35b6c4a4da201a947b2ceb96ae4c0d83d4d2df4f
Author: Victor Stinner <vstinner@python.org>
Date:   Fri Mar 29 11:25:17 2024 +0100

    gh-117347: Fix test_clinic side effects (#117363)

    Save/restore converters in ClinicWholeFileTest and
    ClinicExternalTest.

commit 7e2fef865899837c47e91ef0180fa59eb03e840b
Author: neonene <53406459+neonene@users.noreply.github.com>
Date:   Fri Mar 29 18:40:48 2024 +0900

    gh-117142: ctypes: Migrate global vars to module state (GH-117189)

commit 2e9be80c99f635c2f7761e8356b0260922d6e7a6
Author: Gregory P. Smith <greg@krypto.org>
Date:   Thu Mar 28 17:58:37 2024 -0700

    Fix reversed assertRegex checks in test_ssl. (#117351)

commit 8eec7ed714e65d616573b7331780b0aa43c6ed6a
Author: 傅立业（Chris Fu） <17433201@qq.com>
Date:   Fri Mar 29 08:19:20 2024 +0800

    gh-117110: Fix subclasses of typing.Any with custom constructors (#117111)

commit a17f313e3958e825db9a83594c8471a984316536
Author: Christopher Chianelli <christopher@timefold.ai>
Date:   Thu Mar 28 18:26:56 2024 -0400

    gh-117339: Use NULL instead of None for LOAD_SUPER_ATTR in dis docs (GH-117343)

commit 26d328b2ba26374fb8d9ffe8215ecef7c5e3f7a2
Author: Michael Droettboom <mdboom@gmail.com>
Date:   Thu Mar 28 18:23:08 2024 -0400

    GH-117121: Add pystats to JIT builds (GH-117346)

commit 14f1ca7d5363386163839b31ce987423daecc3de
Author: Nice Zombies <nineteendo19d0@gmail.com>
Date:   Thu Mar 28 22:20:08 2024 +0100

    gh-117335: Handle non-iterables for `ntpath.commonpath` (GH-117336)

commit 18cf239e39e25e6cef50ecbb7f197a82f8920ff5
Author: Brandt Bucher <brandtbucher@microsoft.com>
Date:   Thu Mar 28 14:02:34 2024 -0700

    Increase the JIT CI timeouts to 75 minutes (GH-117342)

commit 29829b58a8328a7c2ccacaa74c1d7d120a5e5ca5
Author: Malcolm Smith <smith@chaquo.com>
Date:   Thu Mar 28 19:59:12 2024 +0000

    gh-117294: Report DocTestCase as skipped if all examples in the doctest are skipped (GH-117297)

commit efcc96844e7c66fcd6c23ac2d557ca141614ce9a
Author: Tian Gao <gaogaotiantian@hotmail.com>
Date:   Thu Mar 28 11:23:29 2024 -0700

    gh-69201: Separate stdout and stderr stream in test_pdb (#117308)

commit 6702d2bf6edcd5b5415e17837383623b9d76a5b8
Author: Victor Stinner <vstinner@python.org>
Date:   Thu Mar 28 17:40:58 2024 +0100

    gh-114331: Skip decimal test_maxcontext_exact_arith on s390x (#117326)

commit c1712ef066321c01bf09cba3f22fc474b5b8dfa7
Author: Erlend E. Aasland <erlend@python.org>
Date:   Thu Mar 28 16:05:08 2024 +0100

    gh-116664: Make module state Py_SETREF's in _warnings thread-safe (#116959)

    Mark the swap operations as critical sections.

    Add an internal Py_BEGIN_CRITICAL_SECTION_MUT API that takes a PyMutex
    pointer instead of a PyObject pointer.

commit 9a388b9a64927c372d85f0eaec3de9b7320a6fb5
Author: Joachim Wuttke <j.wuttke@fz-juelich.de>
Date:   Thu Mar 28 14:43:07 2024 +0100

    bpo-43848: explain optional argument mtime in gzip.py. (GH-25410)

    Co-authored-by: Jelle Zijlstra <jelle.zijlstra@gmail.com>

commit 8dbfdb2957a7baade3a88661517f163ad694c39f
Author: Sam Gross <colesbury@gmail.com>
Date:   Thu Mar 28 09:28:39 2024 -0400

    gh-110481: Fix biased reference counting queue initialization. (#117271)

    The biased reference counting queue must be initialized from the bound
    (active) thread because it uses `_Py_ThreadId()` as the key in a hash
    table.

commit 9a1e55b8c5723206116f7016921be3937ef2f4e5
Author: Chris Markiewicz <effigies@gmail.com>
Date:   Thu Mar 28 06:59:31 2024 -0400

    gh-117178: Recover lazy loading of self-referential modules (#117179)

commit 4c71d51a4b7989fc8754ba512c40e21666f9db0d
Author: Jelle Zijlstra <jelle.zijlstra@gmail.com>
Date:   Thu Mar 28 04:30:31 2024 -0600

    gh-117266: Fix crashes on user-created AST subclasses (GH-117276)

    Fix crashes on user-created AST subclasses

commit 8cb7d7ff86a1a2d41195f01ba4f218941dd7308c
Author: Gregory P. Smith <greg@krypto.org>
Date:   Thu Mar 28 03:11:58 2024 -0700

    gh-117310: Remove extra DECREF on "no ciphers" error path in `_ssl._SSLContext` constructor (#117309)

    Remove extra self DECREF on ssl "no ciphers" error path.

    This doesn't come up in practice because nobody links against a broken
    OpenSSL library that provides nothing.

commit 6c8ac8a32fd6de1960526561c44bc5603fab0f3e
Author: Erlend E. Aasland <erlend@python.org>
Date:   Thu Mar 28 09:40:37 2024 +0100

    gh-116303: Handle disabled test modules in test.support helpers (#116482)

    Make sure test.support helpers skip iso. failing if test extension
    modules are disabled. Also log TEST_MODULES in test.pythoninfo.

commit 0f27672c5002de96c9f1228b12460d5ce3f1d190
Author: Russell Keith-Magee <russell@keith-magee.com>
Date:   Thu Mar 28 16:13:13 2024 +0800

    gh-114099: Add documentation for iOS platform (GH-117057)

    Co-authored-by: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>
    Co-authored-by: Jacob Coffee <jacob@z7x.org>
    Co-authored-by: Malcolm Smith <smith@chaquo.com>
    Co-authored-by: Ned Deily <nad@python.org>

commit f006338017cfbf846e8f7391b9ee5f69df8dc620
Author: Russell Keith-Magee <russell@keith-magee.com>
Date:   Thu Mar 28 15:59:33 2024 +0800

    gh-114099: Additions to standard library to support iOS (GH-117052)

    Co-authored-by: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>
    Co-authored-by: Malcolm Smith <smith@chaquo.com>
    Co-authored-by: Ned Deily <nad@python.org>

commit b44898299a2ed97045c270f6474785da2ff07ced
Author: Tim Hatch <tim@timhatch.com>
Date:   Wed Mar 27 23:54:51 2024 -0700

    gh-89739: gh-77140: Support zip64 in zipimport (GH-94146)

    * Reads zip64 files as produced by the zipfile module
    * Include tests (somewhat slow, however, because of the need to create "large" zips)
    * About the same amount of strictness reading invalid zip files as zipfile has
    * Still works on files with prepended data (like pex)

    There are a lot more test cases at https://github.com/thatch/zipimport64/ that give me confidence that this works for real-world files.

    Fixes #89739 and #77140.

    ---------

    Co-authored-by: Itamar Ostricher <itamarost@gmail.com>
    Reviewed-by: Gregory P. Smith <greg@krypto.org>

commit 2cedd25c14d3acfdcb5e8ee55132ce3e334ab8fe
Author: Illia Volochii <illia.volochii@gmail.com>
Date:   Thu Mar 28 08:46:01 2024 +0200

    Revert "gh-116886: Temporarily disable CIfuzz (memory) (GH-117018)" (GH-117289)

    This reverts commit 1ab0d0b1167d78bf19661a3b5e533a2b68a57604.

    This reverts #117018.

    I expect the issue to be fixed based on https://github.com/google/oss-fuzz/pull/11708#issuecomment-2006442396 and https://github.com/actions/runner-images/issues/9491.

commit eefff682f09394fe4f18b7d7c6ac4c635caadd02
Author: Malcolm Smith <smith@chaquo.com>
Date:   Wed Mar 27 22:11:44 2024 +0000

    gh-108277: Make test_os tolerate 10 ms diff for timerfd on Android emulators (#117223)

commit 7aa89bc43e0bcf49eee5a39b5a7ba8f996f20d00
Author: Victor Stinner <vstinner@python.org>
Date:   Wed Mar 27 23:10:14 2024 +0100

    gh-113317: Change how Argument Clinic lists converters (#116853)

    * Add a new create_parser_namespace() function for
      PythonParser to pass objects to executed code.
    * In run_clinic(), list converters using 'converters' and
      'return_converters' dictionarties.
    * test_clinic: add 'object()' return converter.
    * Use also create_parser_namespace() in eval_ast_expr().

    Co-authored-by: Erlend E. Aasland <erlend@python.org>

commit 669ef49c7d42f35da6f7ee280102353b9b37f83e
Author: Seth Michael Larson <seth@python.org>
Date:   Wed Mar 27 16:56:14 2024 -0500

    gh-99108: Update and check HACL* version information (GH-117295)

    * Update and check HACL* version information

commit 262fb911ab7df8e890ebd0efb0773c3e0b5a757f
Author: Irit Katriel <1055913+iritkatriel@users.noreply.github.com>
Date:   Wed Mar 27 17:38:19 2024 +0000

    gh-117288: Allocate fewer label IDs in _PyCfg_ToInstructionSequence (#117290)

commit 74c8568d07719529b874897598d8b3bc25ff0434
Author: Malcolm Smith <smith@chaquo.com>
Date:   Wed Mar 27 16:53:27 2024 +0000

    gh-71042: Add `platform.android_ver` (#116674)

commit ce00de4c8cd39816f992e749c1074487d93abe9d
Author: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>
Date:   Wed Mar 27 16:46:35 2024 +0200

    gh-117225: doctest: only print "and X failed" when non-zero, don't pluralise "1 items" (#117228)

commit 92397d5ead38dde4154e70d00f24973bcf2a925a
Author: Raymond Hettinger <rhettinger@users.noreply.github.com>
Date:   Wed Mar 27 09:04:32 2024 -0500

    Add statistics recipe for sampling from an estimated probability density distribution (#117221)

commit b3e8c78ed7aa9bbd1084375587b99200c687cec9
Author: Tian Gao <gaogaotiantian@hotmail.com>
Date:   Tue Mar 26 18:20:12 2024 -0700

    gh-113548: Allow CLI arguments to `pdb -m` (#113557)

commit 48c0b05cf0dd2db275bd4653f84aa36c22bddcd2
Author: Adorilson Bezerra <adorilson@gmail.com>
Date:   Tue Mar 26 19:08:08 2024 +0000

    Change links on the index page (#117230)

commit af1b0e94400d1bf732466d675054df8cf7dfb62d
Author: AN Long <aisk@users.noreply.github.com>
Date:   Wed Mar 27 02:26:48 2024 +0800

    gh-104242: Enable test_is_char_device_true in pathlib test on all platform (GH-116983)

commit 79be75735c9d77972112cecc8d7e1af28c176ed0
Author: Irit Katriel <1055913+iritkatriel@users.noreply.github.com>
Date:   Tue Mar 26 15:18:17 2024 +0000

    gh-115775: Compiler adds __static_attributes__ field to classes (#115913)

commit 70969d53a77a8a190c40a30419e772bc874a4f62
Author: Antonio <57417288+amaddio@users.noreply.github.com>
Date:   Tue Mar 26 15:10:29 2024 +0100

    gh-97901 add missing text/rtf to mimetypes (GH-97902)

    Co-authored-by: Noam Cohen <noam@noam.me>

commit 4ec347760f98b156c6a2d42ca397af6b0b6ecc50
Author: AN Long <aisk@users.noreply.github.com>
Date:   Tue Mar 26 22:09:57 2024 +0800

    gh-115538: Use isolate mode when running venv test_multiprocessing_recursion() (#117116)

    Co-authored-by: Victor Stinner <vstinner@python.org>

commit 743f2c68f478279e1e56577fe95a0ed112b9abc5
Author: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>
Date:   Tue Mar 26 16:09:09 2024 +0200

    pre-commit: add `check-case-conflict` and `check-merge-conflict` (#117259)

commit 4abca7e1e7e2764faf20c7e677ea5c9ea9dbffe2
Author: Paulo Neves <ptsneves@users.noreply.github.com>
Date:   Tue Mar 26 13:37:50 2024 +0100

    gh-98966: Handle stdout=subprocess.STDOUT (GH-98967)

    Explicitly handle the case where stdout=STDOUT
    as otherwise the existing error handling gets
    confused and reports hard to understand errors.

    Signed-off-by: Paulo Neves <ptsneves@gmail.com>

commit 9654daf793b534b44a831c80f43505ab9e380f1f
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Tue Mar 26 13:26:45 2024 +0200

    gh-66543: Fix mimetype.guess_type() (GH-117217)

    Fix parsing of the following corner cases:

    * URLs with only a host name
    * URLs containing a fragment
    * URLs containing a query
    * filenames with only a UNC sharepoint on Windows

    Co-authored-by: Dong-hee Na <donghee.na92@gmail.com>

commit 8bef34f625e21886b1c64544c060e19ee2e229bf
Author: Mark Shannon <mark@hotpy.org>
Date:   Tue Mar 26 11:11:42 2024 +0000

    GH-117108: Set the "old space bit" to "visited" for all young objects  (#117213)

    Change old space bit of young objects from 0 to gcstate->visited_space.
    This ensures that any object created *and* collected during cycle GC has the bit set correctly.

commit bf82f77957a31c3731b4ec470c406f5708ca9ba3
Author: Mark Shannon <mark@hotpy.org>
Date:   Tue Mar 26 09:35:11 2024 +0000

    GH-116422: Tier2 hot/cold splitting (GH-116813)

    Splits the "cold" path, deopts and exits, from the "hot" path, reducing the size of most jitted instructions, at the cost of slower exits.

commit 61599a48f52e951d8813877ee311d2a830ba2cd8
Author: Pablo Galindo Salgado <Pablogsal@gmail.com>
Date:   Tue Mar 26 09:30:46 2024 +0000

    bpo-24612: Improve syntax error for 'not' after an operator (GH-28170)

    Co-authored-by: Lysandros Nikolaou <lisandrosnik@gmail.com>

commit 771902c257372e6c4df1ead4e8c46308561db7a7
Author: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>
Date:   Tue Mar 26 11:13:32 2024 +0200

    gh-83845: Add tests for operator module (#115883)

    Co-authored-by: Karthikeyan Singaravelan <tir.karthi@gmail.com>

commit ea9a296fce2f786b4cf43c7924e5de01061f27ca
Author: yevgeny hong <hongyevgeny@gmail.com>
Date:   Tue Mar 26 16:45:43 2024 +0900

    gh-115627: Fix PySSL_SetError handling SSL_ERROR_SYSCALL (GH-115628)

    Python 3.10 changed from using SSL_write() and SSL_read() to SSL_write_ex() and
    SSL_read_ex(), but did not update handling of the return value.

    Change error handling so that the return value is not examined.
    OSError (not EOF) is now returned when retval is 0.

    According to *recent* man pages of all functions for which we call
    PySSL_SetError, (in OpenSSL 3.0 and 1.1.1), their return value should
    be used to determine whether an error happened (i.e. if PySSL_SetError
    should be called), but not what kind of error happened (so,
    PySSL_SetError shouldn't need retval). To get the error,
    we need to use SSL_get_error.

    Co-authored-by: Serhiy Storchaka <storchaka@gmail.com>
    Co-authored-by: Petr Viktorin <encukou@gmail.com>

commit d52bdfb19fadd7614a0e5abaf68525fc7300e841
Author: Victor Stinner <vstinner@python.org>
Date:   Tue Mar 26 08:35:59 2024 +0100

    gh-83434: Disable XML in regrtest when -R option is used (#117232)

commit 9f74e86c78853c101a23e938f8e32ea838d8f62e
Author: Sebastian Pipping <sebastian@pipping.org>
Date:   Tue Mar 26 02:48:27 2024 +0100

    gh-117187: Fix XML tests for vanilla Expat <2.6.0 (GH-117203)

    This fixes XML unittest fallout from the https://github.com/python/cpython/issues/115398 security fix.  When configured using `--with-system-expat` on systems with older pre 2.6.0 versions of libexpat, our unittests were failing.

    * sax|etree: Simplify Expat version guard where simplifiable

    Idea by Matěj Cepl

    * sax|etree: Fix reparse deferral tests for vanilla Expat <2.6.0

    This *does not fix* the case of distros with an older version of libexpat with the 2.6.0 feature backported as a security fix.  (Ubuntu is a known example of this with its libexpat1 2.5.0-2ubunutu0.1 package)

commit 872e212378ef86392069034afd80bb53896fd93d
Author: Jonathan Protzenko <protz@microsoft.com>
Date:   Mon Mar 25 17:35:26 2024 -0700

    gh-99108: Refresh HACL*; update modules accordingly; fix namespacing (GH-117237)

    Pulls in a new update from https://github.com/hacl-star/hacl-star and fixes our C "namespacing" done by `Modules/_hacl/refresh.sh`.

commit 8945b7ff55b87d11c747af2dad0e3e4d631e62d6
Author: Eric V. Smith <ericvsmith@users.noreply.github.com>
Date:   Mon Mar 25 19:59:14 2024 -0400

    gh-109870: Dataclasses: batch up exec calls (gh-110851)

    Instead of calling `exec()` once for each function added to a dataclass, only call `exec()` once per dataclass. This can lead to speed improvements of up to 20%.

commit 7ebad77ad65ab4d5d8d0c333256a882262cec189
Author: Raymond Hettinger <rhettinger@users.noreply.github.com>
Date:   Mon Mar 25 18:49:44 2024 -0500

    Sync main docs and docstring for median_grouped(). (gh-117214)

commit 0821923aa979a72464c5da8dfa53a719bba5801c
Author: Nice Zombies <nineteendo19d0@gmail.com>
Date:   Mon Mar 25 23:55:11 2024 +0100

    gh-117114: Make os.path.isdevdrive available on all platforms (GH-117115)

commit c2276176d543a2fc2d57709c2787f99850fbb073
Author: Adorilson Bezerra <adorilson@gmail.com>
Date:   Mon Mar 25 22:34:20 2024 +0000

    Add information about negative  indexes to sequence datamodel doc (#110903)

    Co-authored by Terry Jan Reedy

commit 23e4f80ce2a2bac50acd1785e791316d5b578b8d
Author: Mark Shannon <mark@hotpy.org>
Date:   Mon Mar 25 20:43:51 2024 +0000

    A few minor tweaks to get stats working and compiling cleanly. (#117219)

    Fixes a compilation error when configured with `--enable-pystats`,
    an array size issue, and an unused variable.

commit 507896d97dcff2d7999efa264b29d9003c525c49
Author: Victor Stinner <vstinner@python.org>
Date:   Mon Mar 25 17:32:20 2024 +0100

    gh-116936: Add PyType_GetModuleByDef() to the limited C API (#116937)

commit 0c1a42cf9c8cd0d4534d5c1d58f118ce7c5c446e
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Mon Mar 25 17:32:11 2024 +0200

    gh-87193: Support bytes objects with refcount > 1 in _PyBytes_Resize() (GH-117160)

    Create a new bytes object and destroy the old one if it has refcount > 1.

commit 01e7405da400e8997f8964d06cc414045e144681
Author: Tian Gao <gaogaotiantian@hotmail.com>
Date:   Mon Mar 25 08:18:09 2024 -0700

    gh-112948: Make pdb completion similar to repl completion (#112950)

commit 9db2a8f914ad59019d448cecc43b6d45f46424a0
Author: Raymond Hettinger <rhettinger@users.noreply.github.com>
Date:   Mon Mar 25 09:26:42 2024 -0500

    Minor markup and grammar fixes in the statistics docs (gh-117216)

commit eebea7e515462b503632ada74923ec3246599c9c
Author: Kirill Podoprigora <kirill.bast9@mail.ru>
Date:   Sun Mar 24 20:34:55 2024 +0200

    gh-117176: Fix compiler warning in Python/optimizer_bytecodes.c (GH-117199)

commit 83485a095363dad6c97b19af2826ca0c34343bfc
Author: Totally a booplicate <53382877+Booplicate@users.noreply.github.com>
Date:   Sun Mar 24 18:48:40 2024 +0300

    gh-112571: Move fish venv activation script into the common folder (GH-117169)

    pythongh-112571: allow using fish venv activation script on windows

    The fish shell can be used on windows under cygwin or msys2.
    This change moves the script to the common folder
    so the venv module will install it on both posix and nt systems (like the bash script).

commit 78a651fd7fbe7a3d1702e40f4cbfa72d87241ef0
Author: Terry Jan Reedy <tjreedy@udel.edu>
Date:   Sun Mar 24 11:38:34 2024 -0400

    gh-117194: Properly format 'base64' header in What's New (#117198)

    It needs 6, not 3, '-'s.

commit f267d5bf2a99fbeb26a720d1c87c1f0557424b14
Author: Kerim Kabirov <the.privat33r+gh@pm.me>
Date:   Sun Mar 24 14:59:14 2024 +0100

    GH-115986 Docs: promote pprint.pp usage as a default (#116614)

    Co-authored-by: Hugo van Kemenade <1324225+hugovk@users.noreply.github.com>

commit 39df7732178c8e8f75b12f069a3dbc1715c99995
Author: LilKS <1244886+LilKS@users.noreply.github.com>
Date:   Sun Mar 24 11:01:07 2024 +0100

    gh-101760: Improve the imaplib.IMAP4 example (#101764)

    Co-authored-by: Adam Turner <9087854+AA-Turner@users.noreply.github.com>

commit a1e948edba9ec6ba61365429857f7a087c5edf51
Author: Raymond Hettinger <rhettinger@users.noreply.github.com>
Date:   Sun Mar 24 11:35:58 2024 +0200

    Add cumulative option for the new statistics.kde() function. (#117033)

commit d610d821fd210dce63a1132c274ffdf8acc510bc
Author: Irit Katriel <1055913+iritkatriel@users.noreply.github.com>
Date:   Sat Mar 23 22:32:33 2024 +0000

    gh-112383: teach dis how to interpret ENTER_EXECUTOR (#117171)

commit 6c83352bfe78a7d567c8d76257df6eb91d5a7245
Author: Ken Jin <kenjin@python.org>
Date:   Sun Mar 24 06:19:17 2024 +0800

    gh-117180: Complete call sequence when trace stack overflow (GH-117184)

    ---------

    Co-authored-by: Peter Lazorchak <lazorchakp@gmail.com>
    Co-authored-by: Guido van Rossum <gvanrossum@users.noreply.github.com>
    Co-authored-by: Guido van Rossum <gvanrossum@gmail.com>

commit f11d0d8be8af28e1368c3c7c116218cf65ddf93e
Author: Erik Soma <stillusingirc@gmail.com>
Date:   Sat Mar 23 11:39:35 2024 -0400

    gh-91227: Ignore ERROR_PORT_UNREACHABLE in proactor recvfrom() (#32011)

commit 9967b568edd2e35b0415c14c7242f3ca2c0dc03d
Author: Victor Stinner <vstinner@python.org>
Date:   Sat Mar 23 13:01:20 2024 +0100

    gh-117008: Fix functools test_recursive_pickle() (#117009)

    Use support.infinite_recursion() in test_recursive_pickle() of
    test_functools to prevent a stack overflow on "ARM64 Windows
    Non-Debug" buildbot.

    Lower Py_C_RECURSION_LIMIT to 1,000 frames on Windows ARM64.

commit 72eea512b88f8fd68b7258242c37da963ad87360
Author: Barney Gale <barney.gale@gmail.com>
Date:   Fri Mar 22 19:14:09 2024 +0000

    GH-106747: Document another difference between `glob` and `pathlib`. (#116518)

    Document that `path.glob()` might return *path*, whereas
    `glob.glob(root_dir=path)` will never return an empty string corresponding
    to *path*.

commit e28477f214276db941e715eebc8cdfb96c1207d9
Author: Mark Shannon <mark@hotpy.org>
Date:   Fri Mar 22 18:43:25 2024 +0000

    GH-117108: Change the size of the GC increment to about 1% of the total heap size. (GH-117120)

commit e2e0b4b4b92694ba894e02b4a66fd87c166ed10f
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Fri Mar 22 20:19:10 2024 +0200

    gh-113024: C API: Add PyObject_GenericHash() function (GH-113025)

commit 567ab3bd15398c8c7b791f3e376ae3e3c0bbe079
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Fri Mar 22 20:08:00 2024 +0200

    gh-117084: Fix ZIP file extraction for directory entry names with backslashes on Windows (GH-117129)

commit 5a78f6e798d5c2af1dba2df6c9f1f1e5aac02a86
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Fri Mar 22 20:03:48 2024 +0200

    gh-117134: Microoptimize glob() for include_hidden=True (GH-117135)

commit 00baaa21de229a6db80ff2b84c2fd6ad1999a24c
Author: Vinay Sajip <vinay_sajip@yahoo.co.uk>
Date:   Fri Mar 22 17:25:51 2024 +0000

    [docs] Fix typo in docstring and add example to logging cookbook. (GH-117157)

commit 40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f
Author: Jakub Stasiak <jakub@stasiak.at>
Date:   Fri Mar 22 17:49:56 2024 +0100

    GH-113171: Fix "private" (non-global) IP address ranges (GH-113179)

    * GH-113171: Fix "private" (really non-global) IP address ranges

    The _private_networks variables, used by various is_private
    implementations, were missing some ranges and at the same time had
    overly strict ranges (where there are more specific ranges considered
    globally reachable by the IANA registries).

    This patch updates the ranges with what was missing or otherwise
    incorrect.

    I left 100.64.0.0/10 alone, for now, as it's been made special in [1]
    and I'm not sure if we want to undo that as I don't quite understand the
    motivation behind it.

    The _address_exclude_many() call returns 8 networks for IPv4, 121
    networks for IPv6.

    [1] https://github.com/python/cpython/issues/61602

commit 3be9b9d8722696b95555937bb211dc4cda714d56
Author: Steve Dower <steve.dower@python.org>
Date:   Fri Mar 22 15:00:50 2024 +0000

    Fix get_packagefamilyname helper function on Windows 32-bit (GH-117153)

commit 63d6f2623ef2aa90f51c6a928b96845b9b380d89
Author: NGRsoftlab <78017794+NGRsoftlab@users.noreply.github.com>
Date:   Fri Mar 22 14:25:38 2024 +0300

    gh-117068: Remove useless code in bytesio.c:resize_buffer() (GH-117069)

    Co-authored-by: i.khabibulin <i.khabibulin@ngrsoftlab.ru>

commit 42ae924d278c48a719fb0ab86357f3235a9f7ab9
Author: Petr Viktorin <encukou@gmail.com>
Date:   Fri Mar 22 10:42:18 2024 +0100

    gh-117127: glob tests: Reopen dir_fd to pick up directory changes (GH-117128)

commit 8383915031942f441f435a5ae800790116047b80
Author: Tim Peters <tim.peters@gmail.com>
Date:   Thu Mar 21 22:27:25 2024 -0500

    GH-116939: Rewrite binarysort() (#116940)

    Rewrote binarysort() for clarity.

    Also changed the signature to be more coherent (it was mixing sortslice with raw pointers).

    No change in method or functionality. However, I left some experiments in, disabled for now
    via `#if` tricks. Since this code was first written, some kinds of comparisons have gotten
    enormously faster (like for lists of floats), which changes the tradeoffs.

    For example, plain insertion sort's simpler innermost loop and highly predictable branches
    leave it very competitive (even beating, by a bit) binary insertion when comparisons are
    very cheap, despite that it can do many more compares. And it wins big on runs that
    are already sorted (moving the next one in takes only 1 compare then).

    So I left code for a plain insertion sort, to make future experimenting easier.

    Also made the maximum value of minrun a `#define` (``MAX_MINRUN`) to make
    experimenting with that easier too.

    And another bit of `#if``-disabled code rewrites binary insertion's innermost loop to
    remove its unpredictable branch. Surprisingly, this doesn't really seem to help
    overall. I'm unclear on why not. It certainly adds more instructions, but they're very
    simple, and it's hard to be believe they cost as much as a branch miss.

commit 97ba910e47ad298114800587979ce7beb0a705a3
Author: Guido van Rossum <guido@python.org>
Date:   Thu Mar 21 18:27:48 2024 -0700

    gh-108716:: Remove _PyStaticCode_Init/Fini (#117141)

    More deepfreeze cleanup.

commit b3d25df8d38b79310587da54dbd88b06a16d4904
Author: Eric Snow <ericsnowcurrently@gmail.com>
Date:   Thu Mar 21 18:20:20 2024 -0600

    gh-105716: Fix _PyInterpreterState_IsRunningMain() For Embedders (gh-117140)

    When I added _PyInterpreterState_IsRunningMain() and friends last year, I tried to accommodate applications that embed Python but don't call _PyInterpreterState_SetRunningMain() (not that they're expected to).  That mostly worked fine until my recent changes in gh-117049, where the subtleties with the fallback code led to failures; the change ended up breaking test_tools.test_freeze, which exercises a basic embedding situation.

    The simplest fix is to drop the fallback code I originally added to _PyInterpreterState_IsRunningMain() (and later to _PyThreadState_IsRunningMain()).  I've kept the fallback in the _xxsubinterpreters module though.  I've also updated Py_FrozenMain() to call _PyInterpreterState_SetRunningMain().

commit c4bf58a14f162557038a1535ca22c52b49d81d7b
Author: Thomas A Caswell <tcaswell@gmail.com>
Date:   Thu Mar 21 19:54:50 2024 -0400

    gh-116745: Remove all internal usage of @LIBPYTHON@ (#116746)

    Replace with MODULE_LDFLAGS.

commit 3ec57307e70ee6f42410e844d3399bbd598917ba
Author: Malcolm Smith <smith@chaquo.com>
Date:   Thu Mar 21 23:52:29 2024 +0000

    gh-71052: Add Android build script and instructions (#116426)

commit 50f9b0b1e0fb181875751cef951351ed007b6397
Author: Victor Stinner <vstinner@python.org>
Date:   Thu Mar 21 23:17:09 2024 +0100

    gh-117061: Fix test_posix.test_sched_setaffinity() on RHEL9 (#117126)

    On RHEL9, sched_setaffinity(0, []) does not fail.

commit 0907871d43bffb613cbd560224e1a9db13d06c06
Author: Ned Batchelder <ned@nedbatchelder.com>
Date:   Thu Mar 21 15:47:09 2024 -0400

    docs: fix over-linking in dataclasses.rst (#117005)

commit 570a82d46abfebb9976961113fb0f8bb400ad182
Author: Guido van Rossum <guido@python.org>
Date:   Thu Mar 21 12:37:41 2024 -0700

    gh-117045: Add code object to function version cache (#117028)

    Changes to the function version cache:

    - In addition to the function object, also store the code object,
      and allow the latter to be retrieved even if the function has been evicted.
    - Stop assigning new function versions after a critical attribute (e.g. `__code__`)
      has been modified; the version is permanently reset to zero in this case.
    - Changes to `__annotations__` are no longer considered critical. (This fixes gh-109998.)

    Changes to the Tier 2 optimization machinery:

    - If we cannot map a function version to a function, but it is still mapped to a code object,
      we continue projecting the trace.
      The operand of the `_PUSH_FRAME` and `_POP_FRAME` opcodes can be either NULL,
      a function object, or a code object with the lowest bit set.

    This allows us to trace through code that calls an ephemeral function,
    i.e., a function that may not be alive when we are constructing the executor,
    e.g. a generator expression or certain nested functions.
    We will lose globals removal inside such functions,
    but we can still do other peephole operations
    (and even possibly [call inlining](https://github.com/python/cpython/pull/116290),
    if we decide to do it), which only need the code object.
    As before, if we cannot retrieve the code object from the cache, we stop projecting.

commit c85d84166a84a5cb2d724012726bad34229ad24e
Author: Will Childs-Klein <willck93@gmail.com>
Date:   Thu Mar 21 14:16:36 2024 -0500

    gh-116333: Relax error string text expectations in SSL-related tests (GH-116334)

    * Relax error string text expectations in SSL-related tests

    As suggested [here][1], this change relaxes the OpenSSL error string
    text expectations in a number of tests. This was specifically done in
    support of more easily building CPython [AWS-LC][2], but because AWS-LC
    is a fork of [BoringSSL][3], it should increase compatibility with that
    library as well.

    In addition to the error string relaxations, we also add some guards
    around the `tls-unique` channel binding being used with TLSv1.3, as that
    feature (described in [RFC 6929][4]) is [not defined][5] for TLSv1.3.

    [1]: https://discuss.python.org/t/support-building-ssl-and-hashlib-modules-against-aws-lc/44505/4
    [2]: https://github.com/aws/aws-lc
    [3]: https://github.com/google/boringssl
    [4]: https://datatracker.ietf.org/doc/html/rfc5929#section-3
    [5]: https://datatracker.ietf.org/doc/html/rfc8446#appendix-C.5

commit 1f72fb5447ef3f8892b4a7a6213522579c618e8e
Author: Sam Gross <colesbury@gmail.com>
Date:   Thu Mar 21 14:21:02 2024 -0400

    gh-116522: Refactor `_PyThreadState_DeleteExcept` (#117131)

    Split `_PyThreadState_DeleteExcept` into two functions:

    - `_PyThreadState_RemoveExcept` removes all thread states other than one
      passed as an argument. It returns the removed thread states as a
      linked list.

    - `_PyThreadState_DeleteList` deletes those dead thread states. It may
      call destructors, so we want to "start the world" before calling
      `_PyThreadState_DeleteList` to avoid potential deadlocks.

commit 50369e6c34d05222e5a0ec9443a9f7b230e83112
Author: Michael Droettboom <mdboom@gmail.com>
Date:   Thu Mar 21 13:27:46 2024 -0400

    gh-116996: Add pystats about _Py_uop_analyse_and_optimize (GH-116997)

commit 617158e07811edfd6fd552a3d84b0beedd8f1d18
Author: Eric Snow <ericsnowcurrently@gmail.com>
Date:   Thu Mar 21 11:15:02 2024 -0600

    gh-76785: Drop PyInterpreterID_Type (gh-117101)

    I added it quite a while ago as a strategy for managing interpreter lifetimes relative to the PEP 554 (now 734) implementation.  Relatively recently I refactored that implementation to no longer rely on InterpreterID objects.  Thus now I'm removing it.

commit abdd1f938f08e536864532b2071f144515ecc88b
Author: Victor Stinner <vstinner@python.org>
Date:   Thu Mar 21 17:45:43 2024 +0100

    gh-85283: Build _testconsole extension with limited C API (#117125)

commit 8bea6c411d65cd987616b4ecdb86373e4f21f1c6
Author: Victor Stinner <vstinner@python.org>
Date:   Thu Mar 21 17:07:00 2024 +0100

    gh-115754: Add Py_GetConstant() function (#116883)

    Add Py_GetConstant() and Py_GetConstantBorrowed() functions.

    In the limited C API version 3.13, getting Py_None, Py_False,
    Py_True, Py_Ellipsis and Py_NotImplemented singletons is now
    implemented as function calls at the stable ABI level to hide
    implementation details. Getting these constants still return borrowed
    references.

    Add _testlimitedcapi/object.c and test_capi/test_object.py to test
    Py_GetConstant() and Py_GetConstantBorrowed() functions.

commit 5a76d1be8ef371b75ca65166726923c249b5f615
Author: Eric Snow <ericsnowcurrently@gmail.com>
Date:   Thu Mar 21 10:06:35 2024 -0600

    gh-105716: Update interp->threads.main After Fork (gh-117049)

    I missed this in gh-109921.

    We also update Py_Exit() to call _PyInterpreterState_SetNotRunningMain(), if necessary.

commit bbee57fa8c318cb26d6c8651254927a1972c9738
Author: Eric Snow <ericsnowcurrently@gmail.com>
Date:   Thu Mar 21 09:56:12 2024 -0600

    gh-76785: Clean Up Interpreter ID Conversions (gh-117048)

    Mostly we unify the two different implementations of the conversion code (from PyObject * to int64_t.  We also drop the PyArg_ParseTuple()-style converter function, as well as rename and move PyInterpreterID_LookUp().

commit e728303532168efab7694c55c82ea19b18bf8385
Author: Sam Gross <colesbury@gmail.com>
Date:   Thu Mar 21 10:01:16 2024 -0400

    gh-116522: Stop the world before fork() and during shutdown (#116607)

    This changes the free-threaded build to perform a stop-the-world pause
    before deleting other thread states when forking and during shutdown.
    This fixes some crashes when using multiprocessing and during shutdown
    when running with `PYTHON_GIL=0`.

    This also changes `PyOS_BeforeFork` to acquire the runtime lock
    (i.e., `HEAD_LOCK(&_PyRuntime)`) before forking to ensure that data
    protected by the runtime lock (and not just the GIL or stop-the-world)
    is in a consistent state before forking.

commit 1f8b24ef69896680d6ba6005e75e1cc79a744f9e
Author: Malcolm Smith <smith@chaquo.com>
Date:   Thu Mar 21 13:20:57 2024 +0000

    gh-71052: Implement `ctypes.util.find_library` on Android (GH-116379)

commit d16c9d1278164f04778861814ebc87ed087511fc
Author: Tian Gao <gaogaotiantian@hotmail.com>
Date:   Thu Mar 21 03:30:10 2024 -0700

    gh-116987: Support class code objects in inspect.findsource() (GH-117025)

commit 6547330f4e896c6748da23704b617e060e6cc68e
Author: Adam Turner <9087854+AA-Turner@users.noreply.github.com>
Date:   Thu Mar 21 03:49:10 2024 +0000

    GH-109653: Defer import of ``importlib.metadata._adapters`` (#109829)

    * adapters

    * Add comments for deferred imports with links to rationale.

    * Add blurb

    ---------

    Co-authored-by: Jason R. Coombs <jaraco@jaraco.com>

commit 667294d5b2ee812ebe0c9c1efd58e2006b61f827
Author: Jason R. Coombs <jaraco@jaraco.com>
Date:   Wed Mar 20 23:01:24 2024 -0400

    gh-117089: Apply changes from importlib_metadata 7.1.0 (#117094)

    * Apply changes from importlib_metadata 7.1.0

    * Include the data sources in the makefile (even though they're not needed)

commit f4cc77d494ee0e10ed84ce369f0910c70a2f6d44
Author: Victor Stinner <vstinner@python.org>
Date:   Thu Mar 21 00:06:24 2024 +0100

    gh-116869: Enable -Werror in test_cext for Free Threading (#117106)

    Check for warnings, but don't enable the compiler flag
    -Werror=declaration-after-statement.

commit 104602a6078564765b7b8f42888f8eaa37b129b1
Author: Victor Stinner <vstinner@python.org>
Date:   Wed Mar 20 23:52:23 2024 +0100

    gh-105927: Limit PyWeakref_GetRef() to limited C API 3.13 (#117091)

commit 8ad88984200b2ccddc0a08229dd2f4c14d1a71fc
Author: Jason R. Coombs <jaraco@jaraco.com>
Date:   Wed Mar 20 17:11:00 2024 -0400

    gh-117089: Move importlib.metadata tests to their own package (#117092)

    * Ensure importlib.metadata tests do not leak references in sys.modules.

    * Move importlib.metadata tests to their own package for easier syncing with importlib_metadata.

    * Update owners and makefile for new directories.

    * Add blurb

commit 7d446548ef53f6c3de1097c6d44cada6642ddc85
Author: Carol Willing <carolcode@willingconsulting.com>
Date:   Wed Mar 20 14:00:59 2024 -0700

    Fix sort order for "locale encoding" glossary item (#115794)

    Co-authored-by: C.A.M. Gerlach <CAM.Gerlach@Gerlach.CAM>

commit 63289b9dfbc7d87e81f1517422ee91b6b6d19531
Author: Mark Shannon <mark@hotpy.org>
Date:   Wed Mar 20 18:24:02 2024 +0000

    GH-117066: Tier 2 optimizer: Don't throw away good traces if we can't optimize them perfectly. (GH-117067)

commit dcaf33a41d5d220523d71c9b35bc08f5b8405dac
Author: Petr Viktorin <encukou@gmail.com>
Date:   Wed Mar 20 17:33:08 2024 +0100

    gh-114314: ctypes: remove stgdict and switch to heap types (GH-116458)

    Before this change, ctypes classes used a custom dict subclass, `StgDict`,
    as their `tp_dict`. This acts like a regular dict but also includes extra information
    about the type.

    This replaces stgdict by `StgInfo`, a C struct on the type, accessed by
    `PyObject_GetTypeData()` (PEP-697).
    All usage of `StgDict` (mainly variables named `stgdict`, `dict`, `edict` etc.) is
    converted to `StgInfo` (named `stginfo`, `info`, `einfo`, etc.).
    Where the dict is actually used for class attributes (as a regular PyDict), it's now
    called `attrdict`.

    This change -- not overriding `tp_dict` -- is made to make me comfortable with
    the next part of this PR: moving the initialization logic from `tp_new` to `tp_init`.

    The `StgInfo` is set up in `__init__` of each class, with a guard that prevents
    calling `__init__` more than once. Note that abstract classes (like `Array` or
    `Structure`) are created using `PyType_FromMetaclass` and do not have
    `__init__` called.
    Previously, this was done in `__new__`, which also wasn't called for abstract
    classes.
    Since `__init__` can be called from Python code or skipped, there is a tested
    guard to ensure `StgInfo` is initialized exactly once before it's used.

    Co-authored-by: neonene <53406459+neonene@users.noreply.github.com>
    Co-authored-by: Erlend E. Aasland <erlend.aasland@protonmail.com>

commit 44fbab43d8f3f2df07091d237824cf4fa1f6c57c
Author: Russell Keith-Magee <russell@keith-magee.com>
Date:   Wed Mar 20 23:32:56 2024 +0800

    gh-117058: Update GUI and packaging recommendations for macOS. (#117059)

commit 9221ef2d8cb7f4cf37592eb650d4c8f972033000
Author: Brett Simmers <swtaarrs@users.noreply.github.com>
Date:   Wed Mar 20 08:18:26 2024 -0700

    gh-116908: Only write to `_pending_calls.calls_to_do` with atomic operations (#117044)

    These writes to `pending->calls_to_do` need to be atomic, because other threads
    can read (atomically) from `calls_to_do` without holding `pending->mutex`.

commit fc4599800778f9b130d5e336deadbdeb5bd3e5ee
Author: jkriegshauser <jkriegshauser@gmail.com>
Date:   Wed Mar 20 07:33:28 2024 -0700

    gh-116773: Ensure overlapped objects on Windows are not deallocated too early by asyncio (GH-116774)

commit 519b2ae22b54760475bbf62b9558d453c703f9c6
Author: Serhiy Storchaka <storchaka@gmail.com>
Date:   Wed Mar 20 15:39:53 2024 +0200

    gh-117021: Fix integer overflow in PyLong_AsPid() on non-Windows 64-bit platforms (GH-117064)
```

[![@paravoid](https://avatars.githubusercontent.com/u/1330796?s=40&u=b2d84c11c7521df68878b1b217d2ec61f9e8dd05&v=4)](/paravoid)
[paravoid](/paravoid)
mentioned this pull request
[Apr 5, 2024](#ref-pullrequest-2228076670)

[Clean util/network to further align with stdlib
home-assistant/core#114941](/home-assistant/core/pull/114941)
 Draft

20 tasks

[paravoid](/paravoid)
added a commit
to paravoid/home-assistant-core
that referenced
this pull request
[Apr 11, 2024](#ref-commit-3072189)
[![@paravoid](https://avatars.githubusercontent.com/u/1330796?s=40&u=b2d84c11c7521df68878b1b217d2ec61f9e8dd05&v=4)](/paravoid)

`[util/network: cleanup, further alignment with stdlib](/paravoid/home-assistant-core/commit/30721897103a12b19204b89c71a3c437073ed08a "util/network: cleanup, further alignment with stdlib

* Remove the constants LINK_LOCAL_NETWORKS and LOOPBACK_NETWORKS, as
  they are currently unreferenced, due to the changes made by PR#102019.

* Replace the PRIVATE_NETWORKS check with stdlib's is_private() method.
  Besides a reduction of code, this results in a more comprehensive
  check, as stdlib includes additional address spaces that were not
  covered before, and is ever evolving (see, for example,
  python/cpython#113179).

* In contrast with CPython, loopbacks and link-locals are NOT included
  in our definition of \"private\", so adjust the code to keep the
  existing semantics

* However, this *does* change the semantics for some address spaces to
  follow Python's interpretation of IANA, such as marking reserved
  documentation spaces as \"local\". Invert the test cases for
  198.51.100.0/24 (TEST-NET-2) and 2001:db8::/32 (Documentation)
  accordingly.

* We now need a new globally reachable IP space to use as
  EXTERNAL_ADDRESSES in test_auth. Use AS112's address space, as it is
  reserved by IANA, but marked as Globally Reachable.

* Finally, inline the last remaining constant IPV6_IPV4_LOOPBACK, and
  leave a comment that work is underway in CPython by yours truly to
  reduce the need for it and have is_loopback() subsume it.

Further work is required to align the semantics of e.g. what \"private\"
means with stdlib, and replace these seldomly used util functions with
stdlib properties across the tree (as is already the case in several
integrations), but hopefully this provides a stepping stone towards this
direction.")`
…

`[3072189](/paravoid/home-assistant-core/commit/30721897103a12b19204b89c71a3c437073ed08a)`

```
* Remove the constants LINK_LOCAL_NETWORKS and LOOPBACK_NETWORKS, as
  they are currently unreferenced, due to the changes made by PR#102019.

* Replace the PRIVATE_NETWORKS check with stdlib's is_private() method.
  Besides a reduction of code, this results in a more comprehensive
  check, as stdlib includes additional address spaces that were not
  covered before, and is ever evolving (see, for example,
  [python/cpython#113179](https://github.com/python/cpython/pull/113179)).

* In contrast with CPython, loopbacks and link-locals are NOT included
  in our definition of "private", so adjust the code to keep the
  existing semantics

* However, this *does* change the semantics for some address spaces to
  follow Python's interpretation of IANA, such as marking reserved
  documentation spaces as "local". Invert the test cases for
  198.51.100.0/24 (TEST-NET-2) and 2001:db8::/32 (Documentation)
  accordingly.

* We now need a new globally reachable IP space to use as
  EXTERNAL_ADDRESSES in test_auth. Use AS112's address space, as it is
  reserved by IANA, but marked as Globally Reachable.

* Finally, inline the last remaining constant IPV6_IPV4_LOOPBACK, and
  leave a comment that work is underway in CPython by yours truly to
  reduce the need for it and have is_loopback() subsume it.

Further work is required to align the semantics of e.g. what "private"
means with stdlib, and replace these seldomly used util functions with
stdlib properties across the tree (as is already the case in several
integrations), but hopefully this provides a stepping stone towards this
direction.
```

19 hidden items

Load more…

[![@miss-islington-app](https://avatars.githubusercontent.com/in/409059?s=80&v=4)](/apps/miss-islington-app)

Copy link

### **[miss-islington-app](/apps/miss-islington-app) bot** commented [Apr 23, 2024](#issuecomment-2072017940)

| Sorry, [@jstasiak](https://github.com/jstasiak) and [@encukou](https://github.com/encukou), I could not cleanly backport this to `3.11` due to a conflict. Please backport using [cherry\_picker](https://pypi.org/project/cherry-picker/) on command line.  ``` cherry_picker 40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f 3.11  ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@miss-islington-app](https://avatars.githubusercontent.com/in/409059?s=80&v=4)](/apps/miss-islington-app)

Copy link

### **[miss-islington-app](/apps/miss-islington-app) bot** commented [Apr 23, 2024](#issuecomment-2072018334)

| Sorry, [@jstasiak](https://github.com/jstasiak) and [@encukou](https://github.com/encukou), I could not cleanly backport this to `3.12` due to a conflict. Please backport using [cherry\_picker](https://pypi.org/project/cherry-picker/) on command line.  ``` cherry_picker 40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f 3.12  ``` |
| --- |

All reactions

Sorry, something went wrong.

[encukou](/encukou)
pushed a commit
to encukou/cpython
that referenced
this pull request
[Apr 23, 2024](#ref-commit-a74a45b)
[![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak) [![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&v=4)](/encukou)

`[[3.12]](/encukou/cpython/commit/a74a45b36b790954af39a3b5a8de766879d778e8 "[3.12] GH-113171: Fix \"private\" (non-global) IP address ranges (GH-113179)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

I left 100.64.0.0/10 alone, for now, as it's been made special in [1]
and I'm not sure if we want to undo that as I don't quite understand the
motivation behind it.

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

(cherry picked from commit 40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f)") [pythonGH-113171](https://github.com/python/cpython/issues/113171)[: Fix "private" (non-global) IP address ranges (](/encukou/cpython/commit/a74a45b36b790954af39a3b5a8de766879d778e8 "[3.12] GH-113171: Fix \"private\" (non-global) IP address ranges (GH-113179)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

I left 100.64.0.0/10 alone, for now, as it's been made special in [1]
and I'm not sure if we want to undo that as I don't quite understand the
motivation behind it.

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

(cherry picked from commit 40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f)")[p…](https://github.com/python/cpython/pull/113179)`
…

`[a74a45b](/encukou/cpython/commit/a74a45b36b790954af39a3b5a8de766879d778e8)`

```
[…ythonGH-113179](https://github.com/python/cpython/pull/113179))

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

I left 100.64.0.0/10 alone, for now, as it's been made special in [1]
and I'm not sure if we want to undo that as I don't quite understand the
motivation behind it.

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] [python#61602](https://github.com/python/cpython/issues/61602)

(cherry picked from commit [40d75c2](https://github.com/encukou/cpython/commit/40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f))
```

[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou)
[encukou](/encukou)
mentioned this pull request
[Apr 23, 2024](#ref-pullrequest-2258711236)

[[3.12] gh-113171: gh-65056: Fix "private" (non-global) IP address ranges (GH-113179) (GH-113186)
#118177](/python/cpython/pull/118177)
 Merged

[![@encukou](https://avatars.githubusercontent.com/u/302922?s=80&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou)

Copy link

Member

### **[encukou](/encukou)** commented [Apr 23, 2024](#issuecomment-2072134857)

| [#118177](https://github.com/python/cpython/pull/118177) is a backport of this pull request to the [3.12 branch](https://github.com/python/cpython/tree/3.12). |
| --- |

All reactions

Sorry, something went wrong.

[encukou](/encukou)
added a commit
that referenced
this pull request
[Apr 24, 2024](#ref-commit-f86b17a)
[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou) [![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak)

`[[3.12]](/python/cpython/commit/f86b17ac511e68192ba71f27e752321a3252cee3 "[3.12] gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177)

* GH-113171: Fix \"private\" (non-global) IP address ranges (GH-113179)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

* GH-65056: Improve the IP address' is_global/is_private documentation (GH-113186)

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit 2a4cbf17af19a01d942f9579342f77c39fbd23c4)
(cherry picked from commit 40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f)

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>") [gh-113171](https://github.com/python/cpython/issues/113171)[:](/python/cpython/commit/f86b17ac511e68192ba71f27e752321a3252cee3 "[3.12] gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177)

* GH-113171: Fix \"private\" (non-global) IP address ranges (GH-113179)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

* GH-65056: Improve the IP address' is_global/is_private documentation (GH-113186)

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit 2a4cbf17af19a01d942f9579342f77c39fbd23c4)
(cherry picked from commit 40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f)

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>") [gh-65056](https://github.com/python/cpython/issues/65056)[: Fix "private" (non-global) IP address ran…](/python/cpython/commit/f86b17ac511e68192ba71f27e752321a3252cee3 "[3.12] gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177)

* GH-113171: Fix \"private\" (non-global) IP address ranges (GH-113179)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

* GH-65056: Improve the IP address' is_global/is_private documentation (GH-113186)

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit 2a4cbf17af19a01d942f9579342f77c39fbd23c4)
(cherry picked from commit 40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f)

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>")`
…

`[f86b17a](/python/cpython/commit/f86b17ac511e68192ba71f27e752321a3252cee3)`

```
…ges ([GH-113179](https://github.com/python/cpython/pull/113179)) ([GH-113186](https://github.com/python/cpython/pull/113186)) ([GH-118177](https://github.com/python/cpython/pull/118177))

* [GH-113171](https://github.com/python/cpython/issues/113171): Fix "private" (non-global) IP address ranges ([GH-113179](https://github.com/python/cpython/pull/113179))

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] [#61602](https://github.com/python/cpython/issues/61602)

* [GH-65056](https://github.com/python/cpython/issues/65056): Improve the IP address' is_global/is_private documentation ([GH-113186](https://github.com/python/cpython/pull/113186))

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit [2a4cbf1](https://github.com/python/cpython/commit/2a4cbf17af19a01d942f9579342f77c39fbd23c4))
(cherry picked from commit [40d75c2](https://github.com/python/cpython/commit/40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f))

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
```

[encukou](/encukou)
added a commit
to encukou/cpython
that referenced
this pull request
[Apr 24, 2024](#ref-commit-b47c766)
[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou) [![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak)

`[pythongh-113171](https://github.com/python/cpython/issues/113171)[:](/encukou/cpython/commit/b47c766d6085d7918edd7715750d135868fdafd6 "gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177)

* GH-113171: Fix \"private\" (non-global) IP address ranges (GH-113179)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

* GH-65056: Improve the IP address' is_global/is_private documentation (GH-113186)

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit 2a4cbf17af19a01d942f9579342f77c39fbd23c4)
(cherry picked from commit 40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f)

---------

(cherry picked from commit f86b17ac511e68192ba71f27e752321a3252cee3)

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>") [pythongh-65056](https://github.com/python/cpython/issues/65056)[: Fix "private" (non-global) IP addres…](/encukou/cpython/commit/b47c766d6085d7918edd7715750d135868fdafd6 "gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177)

* GH-113171: Fix \"private\" (non-global) IP address ranges (GH-113179)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

* GH-65056: Improve the IP address' is_global/is_private documentation (GH-113186)

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit 2a4cbf17af19a01d942f9579342f77c39fbd23c4)
(cherry picked from commit 40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f)

---------

(cherry picked from commit f86b17ac511e68192ba71f27e752321a3252cee3)

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>")`
…

`[b47c766](/encukou/cpython/commit/b47c766d6085d7918edd7715750d135868fdafd6)`

```
…s ranges ([pythonGH-113179](https://github.com/python/cpython/pull/113179)) ([pythonGH-113186](https://github.com/python/cpython/pull/113186)) ([pythonGH-118177](https://github.com/python/cpython/pull/118177))

* [pythonGH-113171](https://github.com/python/cpython/issues/113171): Fix "private" (non-global) IP address ranges ([pythonGH-113179](https://github.com/python/cpython/pull/113179))

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] [python#61602](https://github.com/python/cpython/issues/61602)

* [pythonGH-65056](https://github.com/python/cpython/issues/65056): Improve the IP address' is_global/is_private documentation ([pythonGH-113186](https://github.com/python/cpython/pull/113186))

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit [2a4cbf1](https://github.com/encukou/cpython/commit/2a4cbf17af19a01d942f9579342f77c39fbd23c4))
(cherry picked from commit [40d75c2](https://github.com/encukou/cpython/commit/40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f))

---------

(cherry picked from commit [f86b17a](https://github.com/encukou/cpython/commit/f86b17ac511e68192ba71f27e752321a3252cee3))

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
```

[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou)
[encukou](/encukou)
mentioned this pull request
[Apr 24, 2024](#ref-pullrequest-2261276804)

[[3.11] gh-113171: gh-65056: Fix "private" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177)
#118227](/python/cpython/pull/118227)
 Merged

[encukou](/encukou)
added a commit
to encukou/cpython
that referenced
this pull request
[Apr 24, 2024](#ref-commit-0740166)
[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou) [![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak)

`[pythongh-113171](https://github.com/python/cpython/issues/113171)[:](/encukou/cpython/commit/0740166e60b8cdae9448220beb28721f0126ee03 "gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177)

* GH-113171: Fix \"private\" (non-global) IP address ranges (GH-113179)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

* GH-65056: Improve the IP address' is_global/is_private documentation (GH-113186)

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit 2a4cbf17af19a01d942f9579342f77c39fbd23c4)
(cherry picked from commit 40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f)

---------

(cherry picked from commit f86b17ac511e68192ba71f27e752321a3252cee3)

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>") [pythongh-65056](https://github.com/python/cpython/issues/65056)[: Fix "private" (non-global) IP addres…](/encukou/cpython/commit/0740166e60b8cdae9448220beb28721f0126ee03 "gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177)

* GH-113171: Fix \"private\" (non-global) IP address ranges (GH-113179)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

* GH-65056: Improve the IP address' is_global/is_private documentation (GH-113186)

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit 2a4cbf17af19a01d942f9579342f77c39fbd23c4)
(cherry picked from commit 40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f)

---------

(cherry picked from commit f86b17ac511e68192ba71f27e752321a3252cee3)

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>")`
…

`[0740166](/encukou/cpython/commit/0740166e60b8cdae9448220beb28721f0126ee03)`

```
…s ranges ([pythonGH-113179](https://github.com/python/cpython/pull/113179)) ([pythonGH-113186](https://github.com/python/cpython/pull/113186)) ([pythonGH-118177](https://github.com/python/cpython/pull/118177))

* [pythonGH-113171](https://github.com/python/cpython/issues/113171): Fix "private" (non-global) IP address ranges ([pythonGH-113179](https://github.com/python/cpython/pull/113179))

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] [python#61602](https://github.com/python/cpython/issues/61602)

* [pythonGH-65056](https://github.com/python/cpython/issues/65056): Improve the IP address' is_global/is_private documentation ([pythonGH-113186](https://github.com/python/cpython/pull/113186))

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit [2a4cbf1](https://github.com/encukou/cpython/commit/2a4cbf17af19a01d942f9579342f77c39fbd23c4))
(cherry picked from commit [40d75c2](https://github.com/encukou/cpython/commit/40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f))

---------

(cherry picked from commit [f86b17a](https://github.com/encukou/cpython/commit/f86b17ac511e68192ba71f27e752321a3252cee3))

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
```

[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou)
[encukou](/encukou)
mentioned this pull request
[Apr 24, 2024](#ref-pullrequest-2261310382)

[[3.10] gh-113171: gh-65056: Fix "private" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177)
#118229](/python/cpython/pull/118229)
 Merged

[pablogsal](/pablogsal)
pushed a commit
that referenced
this pull request
[Apr 25, 2024](#ref-commit-ba43157)
[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou)

`[[3.11]](/python/cpython/commit/ba431579efdcbaed7a96f2ac4ea0775879a332fb "[3.11] gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177) (#118227)") [gh-113171](https://github.com/python/cpython/issues/113171)[:](/python/cpython/commit/ba431579efdcbaed7a96f2ac4ea0775879a332fb "[3.11] gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177) (#118227)") [gh-65056](https://github.com/python/cpython/issues/65056)[: Fix "private" (non-global) IP address ran…](/python/cpython/commit/ba431579efdcbaed7a96f2ac4ea0775879a332fb "[3.11] gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177) (#118227)")`
…

`[ba43157](/python/cpython/commit/ba431579efdcbaed7a96f2ac4ea0775879a332fb)`

```
…ges ([GH-113179](https://github.com/python/cpython/pull/113179)) ([GH-113186](https://github.com/python/cpython/pull/113186)) ([GH-118177](https://github.com/python/cpython/pull/118177)) ([#118227](https://github.com/python/cpython/pull/118227))
```

[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou)
[encukou](/encukou)
mentioned this pull request
[Apr 29, 2024](#ref-issue-2227937400)

[ipaddress.IPv6Address.is\_loopback broken for IPv4-mapped addresses
#117566](/python/cpython/issues/117566)

Closed

[encukou](/encukou)
added a commit
to encukou/cpython
that referenced
this pull request
[May 1, 2024](#ref-commit-5e58376)
[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou) [![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak)

`[pythongh-113171](https://github.com/python/cpython/issues/113171)[:](/encukou/cpython/commit/5e58376d424fb951966277e5d46cf0b11d860ef3 "gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177)

* GH-113171: Fix \"private\" (non-global) IP address ranges (GH-113179)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

* GH-65056: Improve the IP address' is_global/is_private documentation (GH-113186)

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit 2a4cbf17af19a01d942f9579342f77c39fbd23c4)
(cherry picked from commit 40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f)

---------

(cherry picked from commit f86b17ac511e68192ba71f27e752321a3252cee3)

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>") [pythongh-65056](https://github.com/python/cpython/issues/65056)[: Fix "private" (non-global) IP addres…](/encukou/cpython/commit/5e58376d424fb951966277e5d46cf0b11d860ef3 "gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177)

* GH-113171: Fix \"private\" (non-global) IP address ranges (GH-113179)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

* GH-65056: Improve the IP address' is_global/is_private documentation (GH-113186)

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit 2a4cbf17af19a01d942f9579342f77c39fbd23c4)
(cherry picked from commit 40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f)

---------

(cherry picked from commit f86b17ac511e68192ba71f27e752321a3252cee3)

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>")`
…

`[5e58376](/encukou/cpython/commit/5e58376d424fb951966277e5d46cf0b11d860ef3)`

```
…s ranges ([pythonGH-113179](https://github.com/python/cpython/pull/113179)) ([pythonGH-113186](https://github.com/python/cpython/pull/113186)) ([pythonGH-118177](https://github.com/python/cpython/pull/118177))

* [pythonGH-113171](https://github.com/python/cpython/issues/113171): Fix "private" (non-global) IP address ranges ([pythonGH-113179](https://github.com/python/cpython/pull/113179))

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] [python#61602](https://github.com/python/cpython/issues/61602)

* [pythonGH-65056](https://github.com/python/cpython/issues/65056): Improve the IP address' is_global/is_private documentation ([pythonGH-113186](https://github.com/python/cpython/pull/113186))

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit [2a4cbf1](https://github.com/encukou/cpython/commit/2a4cbf17af19a01d942f9579342f77c39fbd23c4))
(cherry picked from commit [40d75c2](https://github.com/encukou/cpython/commit/40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f))

---------

(cherry picked from commit [f86b17a](https://github.com/encukou/cpython/commit/f86b17ac511e68192ba71f27e752321a3252cee3))

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
```

[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou)
[encukou](/encukou)
mentioned this pull request
[May 1, 2024](#ref-pullrequest-2273419331)

[[3.9] gh-113171: gh-65056: Fix "private" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177)
#118472](/python/cpython/pull/118472)
 Merged

[encukou](/encukou)
added a commit
to encukou/cpython
that referenced
this pull request
[May 1, 2024](#ref-commit-05a1467)
[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou) [![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak)

`[pythongh-113171](https://github.com/python/cpython/issues/113171)[:](/encukou/cpython/commit/05a14677846ed0a35773cd2ba582f9a65a3dfa48 "gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177)

* GH-113171: Fix \"private\" (non-global) IP address ranges (GH-113179)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

* GH-65056: Improve the IP address' is_global/is_private documentation (GH-113186)

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit 2a4cbf17af19a01d942f9579342f77c39fbd23c4)
(cherry picked from commit 40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f)

---------

(cherry picked from commit f86b17ac511e68192ba71f27e752321a3252cee3)

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>") [pythongh-65056](https://github.com/python/cpython/issues/65056)[: Fix "private" (non-global) IP addres…](/encukou/cpython/commit/05a14677846ed0a35773cd2ba582f9a65a3dfa48 "gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177)

* GH-113171: Fix \"private\" (non-global) IP address ranges (GH-113179)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

* GH-65056: Improve the IP address' is_global/is_private documentation (GH-113186)

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit 2a4cbf17af19a01d942f9579342f77c39fbd23c4)
(cherry picked from commit 40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f)

---------

(cherry picked from commit f86b17ac511e68192ba71f27e752321a3252cee3)

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>")`
…

`[05a1467](/encukou/cpython/commit/05a14677846ed0a35773cd2ba582f9a65a3dfa48)`

```
…s ranges ([pythonGH-113179](https://github.com/python/cpython/pull/113179)) ([pythonGH-113186](https://github.com/python/cpython/pull/113186)) ([pythonGH-118177](https://github.com/python/cpython/pull/118177))

* [pythonGH-113171](https://github.com/python/cpython/issues/113171): Fix "private" (non-global) IP address ranges ([pythonGH-113179](https://github.com/python/cpython/pull/113179))

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] [python#61602](https://github.com/python/cpython/issues/61602)

* [pythonGH-65056](https://github.com/python/cpython/issues/65056): Improve the IP address' is_global/is_private documentation ([pythonGH-113186](https://github.com/python/cpython/pull/113186))

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit [2a4cbf1](https://github.com/encukou/cpython/commit/2a4cbf17af19a01d942f9579342f77c39fbd23c4))
(cherry picked from commit [40d75c2](https://github.com/encukou/cpython/commit/40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f))

---------

(cherry picked from commit [f86b17a](https://github.com/encukou/cpython/commit/f86b17ac511e68192ba71f27e752321a3252cee3))

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
```

[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou)
[encukou](/encukou)
mentioned this pull request
[May 1, 2024](#ref-pullrequest-2273732677)

[[3.8] gh-113171: gh-65056: Fix "private" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177)
#118479](/python/cpython/pull/118479)
 Merged

[ambv](/ambv)
pushed a commit
that referenced
this pull request
[May 7, 2024](#ref-commit-c62c9e5)
[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou) [![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak)

`[[3.10]](/python/cpython/commit/c62c9e518b784fe44432a3f4fc265fb95b651906 "[3.10] gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177) (GH-118229)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 (\"This network\") and the other in
255.255.255.255/32 (\"Limited broadcast\").

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>") [gh-113171](https://github.com/python/cpython/issues/113171)[:](/python/cpython/commit/c62c9e518b784fe44432a3f4fc265fb95b651906 "[3.10] gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177) (GH-118229)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 (\"This network\") and the other in
255.255.255.255/32 (\"Limited broadcast\").

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>") [gh-65056](https://github.com/python/cpython/issues/65056)[: Fix "private" (non-global) IP address ran…](/python/cpython/commit/c62c9e518b784fe44432a3f4fc265fb95b651906 "[3.10] gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177) (GH-118229)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 (\"This network\") and the other in
255.255.255.255/32 (\"Limited broadcast\").

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>")`
…

`[c62c9e5](/python/cpython/commit/c62c9e518b784fe44432a3f4fc265fb95b651906)`

```
…ges ([GH-113179](https://github.com/python/cpython/pull/113179)) ([GH-113186](https://github.com/python/cpython/pull/113186)) ([GH-118177](https://github.com/python/cpython/pull/118177)) ([GH-118229](https://github.com/python/cpython/pull/118229))

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] [#61602](https://github.com/python/cpython/issues/61602)

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 ("This network") and the other in
255.255.255.255/32 ("Limited broadcast").

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
```

[ambv](/ambv)
pushed a commit
that referenced
this pull request
[May 7, 2024](#ref-commit-22adf29)
[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou) [![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak)

`[[3.9]](/python/cpython/commit/22adf29da8d99933ffed8647d3e0726edd16f7f8 "[3.9] gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177) (GH-118472)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 (\"This network\") and the other in
255.255.255.255/32 (\"Limited broadcast\").

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>") [gh-113171](https://github.com/python/cpython/issues/113171)[:](/python/cpython/commit/22adf29da8d99933ffed8647d3e0726edd16f7f8 "[3.9] gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177) (GH-118472)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 (\"This network\") and the other in
255.255.255.255/32 (\"Limited broadcast\").

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>") [gh-65056](https://github.com/python/cpython/issues/65056)[: Fix "private" (non-global) IP address rang…](/python/cpython/commit/22adf29da8d99933ffed8647d3e0726edd16f7f8 "[3.9] gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177) (GH-118472)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 (\"This network\") and the other in
255.255.255.255/32 (\"Limited broadcast\").

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>")`
…

`[22adf29](/python/cpython/commit/22adf29da8d99933ffed8647d3e0726edd16f7f8)`

```
…es ([GH-113179](https://github.com/python/cpython/pull/113179)) ([GH-113186](https://github.com/python/cpython/pull/113186)) ([GH-118177](https://github.com/python/cpython/pull/118177)) ([GH-118472](https://github.com/python/cpython/pull/118472))

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] [#61602](https://github.com/python/cpython/issues/61602)

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 ("This network") and the other in
255.255.255.255/32 ("Limited broadcast").

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
```

[ambv](/ambv)
pushed a commit
that referenced
this pull request
[May 7, 2024](#ref-commit-895f7e2)
[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou) [![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak)

`[[3.8]](/python/cpython/commit/895f7e2ac23eff4743143beef0f0c5ac71ea27d3 "[3.8] gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177) (GH-118479)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 (\"This network\") and the other in
255.255.255.255/32 (\"Limited broadcast\").

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>") [gh-113171](https://github.com/python/cpython/issues/113171)[:](/python/cpython/commit/895f7e2ac23eff4743143beef0f0c5ac71ea27d3 "[3.8] gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177) (GH-118479)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 (\"This network\") and the other in
255.255.255.255/32 (\"Limited broadcast\").

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>") [gh-65056](https://github.com/python/cpython/issues/65056)[: Fix "private" (non-global) IP address rang…](/python/cpython/commit/895f7e2ac23eff4743143beef0f0c5ac71ea27d3 "[3.8] gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177) (GH-118479)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 (\"This network\") and the other in
255.255.255.255/32 (\"Limited broadcast\").

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>")`
…

`[895f7e2](/python/cpython/commit/895f7e2ac23eff4743143beef0f0c5ac71ea27d3)`

```
…es ([GH-113179](https://github.com/python/cpython/pull/113179)) ([GH-113186](https://github.com/python/cpython/pull/113186)) ([GH-118177](https://github.com/python/cpython/pull/118177)) ([GH-118479](https://github.com/python/cpython/pull/118479))

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] [#61602](https://github.com/python/cpython/issues/61602)

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 ("This network") and the other in
255.255.255.255/32 ("Limited broadcast").

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
```

 [![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak)
[jstasiak](/jstasiak)
deleted the
fix-ipaddress-private-ranges

branch
[May 30, 2024 18:39](#event-12990309830)

[rickprice](/rickprice)
pushed a commit
to ActiveState/cpython
that referenced
this pull request
[Jul 3, 2024](#ref-commit-677b465)
[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou) [![@rickprice](https://avatars.githubusercontent.com/u/1013454?s=40&v=4)](/rickprice)

`[CVE-2024-4032](https://github.com/advisories/GHSA-mh6q-v4mp-2cc7 "CVE-2024-4032") [Fix "private" (non-global) IP address ranges (](/ActiveState/cpython/commit/677b465a1adfe546a49548d010d06da321d129cd "CVE-2024-4032 Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177)

(cherry picked from commit f86b17ac511e68192ba71f27e752321a3252cee3)

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
(cherry picked from commit 05a14677846ed0a35773cd2ba582f9a65a3dfa48)

gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177)

* GH-113171: Fix \"private\" (non-global) IP address ranges (GH-113179)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

* GH-65056: Improve the IP address' is_global/is_private documentation (GH-113186)

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit 2a4cbf17af19a01d942f9579342f77c39fbd23c4)
(cherry picked from commit 40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f)

---------

(cherry picked from commit f86b17ac511e68192ba71f27e752321a3252cee3)

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
(cherry picked from commit 05a14677846ed0a35773cd2ba582f9a65a3dfa48)

Add IPv6 addresses to suspignore.csv

That's a lot of semicolons!

(cherry picked from commit e366724f6e290b71ec49005079e8472c3cac2594)

Add notable changes")[pythonGH-…](https://github.com/python/cpython/pull/113179)`
…

`[677b465](/ActiveState/cpython/commit/677b465a1adfe546a49548d010d06da321d129cd)`

```
[…113179](https://github.com/python/cpython/pull/113179)) ([pythonGH-113186](https://github.com/python/cpython/pull/113186)) ([pythonGH-118177](https://github.com/python/cpython/pull/118177))

(cherry picked from commit [f86b17a](https://github.com/ActiveState/cpython/commit/f86b17ac511e68192ba71f27e752321a3252cee3))

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
(cherry picked from commit [05a1467](https://github.com/ActiveState/cpython/commit/05a14677846ed0a35773cd2ba582f9a65a3dfa48))

[pythongh-113171](https://github.com/python/cpython/issues/113171): [pythongh-65056](https://github.com/python/cpython/issues/65056): Fix "private" (non-global) IP address ranges ([pythonGH-113179](https://github.com/python/cpython/pull/113179)) ([pythonGH-113186](https://github.com/python/cpython/pull/113186)) ([pythonGH-118177](https://github.com/python/cpython/pull/118177))

* [pythonGH-113171](https://github.com/python/cpython/issues/113171): Fix "private" (non-global) IP address ranges ([pythonGH-113179](https://github.com/python/cpython/pull/113179))

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] [python#61602](https://github.com/python/cpython/issues/61602)

* [pythonGH-65056](https://github.com/python/cpython/issues/65056): Improve the IP address' is_global/is_private documentation ([pythonGH-113186](https://github.com/python/cpython/pull/113186))

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit [2a4cbf1](https://github.com/ActiveState/cpython/commit/2a4cbf17af19a01d942f9579342f77c39fbd23c4))
(cherry picked from commit [40d75c2](https://github.com/ActiveState/cpython/commit/40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f))

---------

(cherry picked from commit [f86b17a](https://github.com/ActiveState/cpython/commit/f86b17ac511e68192ba71f27e752321a3252cee3))

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
(cherry picked from commit [05a1467](https://github.com/ActiveState/cpython/commit/05a14677846ed0a35773cd2ba582f9a65a3dfa48))

Add IPv6 addresses to suspignore.csv

That's a lot of semicolons!

(cherry picked from commit [e366724](https://github.com/ActiveState/cpython/commit/e366724f6e290b71ec49005079e8472c3cac2594))

Add notable changes
```

[![@rickprice](https://avatars.githubusercontent.com/u/1013454?s=40&u=0ee5f0661235b463155f59dd127e785840c2813d&v=4)](/rickprice)
[rickprice](/rickprice)
mentioned this pull request
[Jul 3, 2024](#ref-pullrequest-2388873959)

[CVE-2024-4032 Fix "private" (non-global) IP address ranges (GH-113179…
ActiveState/cpython#57](/ActiveState/cpython/pull/57)
 Merged

[rickprice](/rickprice)
pushed a commit
to ActiveState/cpython
that referenced
this pull request
[Jul 4, 2024](#ref-commit-6e7c097)
[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou) [![@rickprice](https://avatars.githubusercontent.com/u/1013454?s=40&v=4)](/rickprice)

`[CVE-2024-4032](https://github.com/advisories/GHSA-mh6q-v4mp-2cc7 "CVE-2024-4032") [Fix "private" (non-global) IP address ranges (](/ActiveState/cpython/commit/6e7c0970b4cf80f7b94cd9c7d77b99e9f0172818 "CVE-2024-4032 Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177)

* Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186)
(GH-118177)

(cherry picked from commit f86b17ac511e68192ba71f27e752321a3252cee3)

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
(cherry picked from commit 05a14677846ed0a35773cd2ba582f9a65a3dfa48)

gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges
(GH-113179) (GH-113186) (GH-118177)

* GH-113171: Fix \"private\" (non-global) IP address ranges (GH-113179)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

* GH-65056: Improve the IP address' is_global/is_private documentation (GH-113186)

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit 2a4cbf17af19a01d942f9579342f77c39fbd23c4)
(cherry picked from commit 40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f)

---------

(cherry picked from commit f86b17ac511e68192ba71f27e752321a3252cee3)

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
(cherry picked from commit 05a14677846ed0a35773cd2ba582f9a65a3dfa48)

Add IPv6 addresses to suspignore.csv

That's a lot of semicolons!

(cherry picked from commit e366724f6e290b71ec49005079e8472c3cac2594)")[pythonGH-…](https://github.com/python/cpython/pull/113179)`
…

`[6e7c097](/ActiveState/cpython/commit/6e7c0970b4cf80f7b94cd9c7d77b99e9f0172818)`

```
[…113179](https://github.com/python/cpython/pull/113179)) ([pythonGH-113186](https://github.com/python/cpython/pull/113186)) ([pythonGH-118177](https://github.com/python/cpython/pull/118177))

* Fix "private" (non-global) IP address ranges ([pythonGH-113179](https://github.com/python/cpython/pull/113179)) ([pythonGH-113186](https://github.com/python/cpython/pull/113186))
([pythonGH-118177](https://github.com/python/cpython/pull/118177))

(cherry picked from commit [f86b17a](https://github.com/ActiveState/cpython/commit/f86b17ac511e68192ba71f27e752321a3252cee3))

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
(cherry picked from commit [05a1467](https://github.com/ActiveState/cpython/commit/05a14677846ed0a35773cd2ba582f9a65a3dfa48))

[pythongh-113171](https://github.com/python/cpython/issues/113171): [pythongh-65056](https://github.com/python/cpython/issues/65056): Fix "private" (non-global) IP address ranges
([pythonGH-113179](https://github.com/python/cpython/pull/113179)) ([pythonGH-113186](https://github.com/python/cpython/pull/113186)) ([pythonGH-118177](https://github.com/python/cpython/pull/118177))

* [pythonGH-113171](https://github.com/python/cpython/issues/113171): Fix "private" (non-global) IP address ranges ([pythonGH-113179](https://github.com/python/cpython/pull/113179))

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] [python#61602](https://github.com/python/cpython/issues/61602)

* [pythonGH-65056](https://github.com/python/cpython/issues/65056): Improve the IP address' is_global/is_private documentation ([pythonGH-113186](https://github.com/python/cpython/pull/113186))

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit [2a4cbf1](https://github.com/ActiveState/cpython/commit/2a4cbf17af19a01d942f9579342f77c39fbd23c4))
(cherry picked from commit [40d75c2](https://github.com/ActiveState/cpython/commit/40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f))

---------

(cherry picked from commit [f86b17a](https://github.com/ActiveState/cpython/commit/f86b17ac511e68192ba71f27e752321a3252cee3))

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
(cherry picked from commit [05a1467](https://github.com/ActiveState/cpython/commit/05a14677846ed0a35773cd2ba582f9a65a3dfa48))

Add IPv6 addresses to suspignore.csv

That's a lot of semicolons!

(cherry picked from commit [e366724](https://github.com/ActiveState/cpython/commit/e366724f6e290b71ec49005079e8472c3cac2594))
```

[rickprice](/rickprice)
pushed a commit
to ActiveState/cpython
that referenced
this pull request
[Jul 8, 2024](#ref-commit-89f48de)
[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou) [![@rickprice](https://avatars.githubusercontent.com/u/1013454?s=40&v=4)](/rickprice)

`[CVE-2024-4032](https://github.com/advisories/GHSA-mh6q-v4mp-2cc7 "CVE-2024-4032") [Fix "private" (non-global) IP address ranges (](/ActiveState/cpython/commit/89f48de7b775d1d137587d644834e69aba716f4d "CVE-2024-4032 Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177)

* Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186)
(GH-118177)

(cherry picked from commit f86b17ac511e68192ba71f27e752321a3252cee3)

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
(cherry picked from commit 05a14677846ed0a35773cd2ba582f9a65a3dfa48)

gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges
(GH-113179) (GH-113186) (GH-118177)

* GH-113171: Fix \"private\" (non-global) IP address ranges (GH-113179)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

* GH-65056: Improve the IP address' is_global/is_private documentation (GH-113186)

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit 2a4cbf17af19a01d942f9579342f77c39fbd23c4)
(cherry picked from commit 40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f)

---------

(cherry picked from commit f86b17ac511e68192ba71f27e752321a3252cee3)

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
(cherry picked from commit 05a14677846ed0a35773cd2ba582f9a65a3dfa48)

Add IPv6 addresses to suspignore.csv

That's a lot of semicolons!

(cherry picked from commit e366724f6e290b71ec49005079e8472c3cac2594)")[pythonGH-…](https://github.com/python/cpython/pull/113179)`
…

`[89f48de](/ActiveState/cpython/commit/89f48de7b775d1d137587d644834e69aba716f4d)`

```
[…113179](https://github.com/python/cpython/pull/113179)) ([pythonGH-113186](https://github.com/python/cpython/pull/113186)) ([pythonGH-118177](https://github.com/python/cpython/pull/118177))

* Fix "private" (non-global) IP address ranges ([pythonGH-113179](https://github.com/python/cpython/pull/113179)) ([pythonGH-113186](https://github.com/python/cpython/pull/113186))
([pythonGH-118177](https://github.com/python/cpython/pull/118177))

(cherry picked from commit [f86b17a](https://github.com/ActiveState/cpython/commit/f86b17ac511e68192ba71f27e752321a3252cee3))

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
(cherry picked from commit [05a1467](https://github.com/ActiveState/cpython/commit/05a14677846ed0a35773cd2ba582f9a65a3dfa48))

[pythongh-113171](https://github.com/python/cpython/issues/113171): [pythongh-65056](https://github.com/python/cpython/issues/65056): Fix "private" (non-global) IP address ranges
([pythonGH-113179](https://github.com/python/cpython/pull/113179)) ([pythonGH-113186](https://github.com/python/cpython/pull/113186)) ([pythonGH-118177](https://github.com/python/cpython/pull/118177))

* [pythonGH-113171](https://github.com/python/cpython/issues/113171): Fix "private" (non-global) IP address ranges ([pythonGH-113179](https://github.com/python/cpython/pull/113179))

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] [python#61602](https://github.com/python/cpython/issues/61602)

* [pythonGH-65056](https://github.com/python/cpython/issues/65056): Improve the IP address' is_global/is_private documentation ([pythonGH-113186](https://github.com/python/cpython/pull/113186))

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit [2a4cbf1](https://github.com/ActiveState/cpython/commit/2a4cbf17af19a01d942f9579342f77c39fbd23c4))
(cherry picked from commit [40d75c2](https://github.com/ActiveState/cpython/commit/40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f))

---------

(cherry picked from commit [f86b17a](https://github.com/ActiveState/cpython/commit/f86b17ac511e68192ba71f27e752321a3252cee3))

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
(cherry picked from commit [05a1467](https://github.com/ActiveState/cpython/commit/05a14677846ed0a35773cd2ba582f9a65a3dfa48))

Add IPv6 addresses to suspignore.csv

That's a lot of semicolons!

(cherry picked from commit [e366724](https://github.com/ActiveState/cpython/commit/e366724f6e290b71ec49005079e8472c3cac2594))
```

[icanhasmath](/icanhasmath)
added a commit
to ActiveState/cpython
that referenced
this pull request
[Jul 8, 2024](#ref-commit-2cd349a)
[![@icanhasmath](https://avatars.githubusercontent.com/u/43051639?s=40&v=4)](/icanhasmath)

`[Merge pull request](/ActiveState/cpython/commit/2cd349a7aff7c8bc68a116d853ce8786e4dd8b2d "Merge pull request #57 from ActiveState/BE-4055-cve-2024-4032-for-3-7

CVE-2024-4032 Fix \"private\" (non-global) IP address ranges (GH-113179…") [#57](https://github.com/ActiveState/cpython/pull/57) [from ActiveState/BE-4055-](/ActiveState/cpython/commit/2cd349a7aff7c8bc68a116d853ce8786e4dd8b2d "Merge pull request #57 from ActiveState/BE-4055-cve-2024-4032-for-3-7

CVE-2024-4032 Fix \"private\" (non-global) IP address ranges (GH-113179…")[cve-2024-4032](https://github.com/advisories/GHSA-mh6q-v4mp-2cc7 "CVE-2024-4032")[-for-3-7](/ActiveState/cpython/commit/2cd349a7aff7c8bc68a116d853ce8786e4dd8b2d "Merge pull request #57 from ActiveState/BE-4055-cve-2024-4032-for-3-7

CVE-2024-4032 Fix \"private\" (non-global) IP address ranges (GH-113179…")`
…

`[2cd349a](/ActiveState/cpython/commit/2cd349a7aff7c8bc68a116d853ce8786e4dd8b2d)`

```
[CVE-2024-4032](https://github.com/advisories/GHSA-mh6q-v4mp-2cc7 "CVE-2024-4032") Fix "private" (non-global) IP address ranges ([pythonGH-113179](https://github.com/python/cpython/pull/113179)…
```

[rickprice](/rickprice)
pushed a commit
to ActiveState/cpython
that referenced
this pull request
[Jul 12, 2024](#ref-commit-0a34c66)
[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou) [![@rickprice](https://avatars.githubusercontent.com/u/1013454?s=40&v=4)](/rickprice)

`[CVE-2024-4032](https://github.com/advisories/GHSA-mh6q-v4mp-2cc7 "CVE-2024-4032") [Fix "private" (non-global) IP address ranges (](/ActiveState/cpython/commit/0a34c661c0415d9fe38608a704f8b88614d15f8e "CVE-2024-4032 Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177)

* Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186)
(GH-118177)

(cherry picked from commit f86b17ac511e68192ba71f27e752321a3252cee3)

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
(cherry picked from commit 05a14677846ed0a35773cd2ba582f9a65a3dfa48)

gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges
(GH-113179) (GH-113186) (GH-118177)

* GH-113171: Fix \"private\" (non-global) IP address ranges (GH-113179)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

* GH-65056: Improve the IP address' is_global/is_private documentation (GH-113186)

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit 2a4cbf17af19a01d942f9579342f77c39fbd23c4)
(cherry picked from commit 40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f)

---------

(cherry picked from commit f86b17ac511e68192ba71f27e752321a3252cee3)

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
(cherry picked from commit 05a14677846ed0a35773cd2ba582f9a65a3dfa48)

Add IPv6 addresses to suspignore.csv

That's a lot of semicolons!

(cherry picked from commit e366724f6e290b71ec49005079e8472c3cac2594)")[pythonGH-…](https://github.com/python/cpython/pull/113179)`
…

`[0a34c66](/ActiveState/cpython/commit/0a34c661c0415d9fe38608a704f8b88614d15f8e)`

```
[…113179](https://github.com/python/cpython/pull/113179)) ([pythonGH-113186](https://github.com/python/cpython/pull/113186)) ([pythonGH-118177](https://github.com/python/cpython/pull/118177))

* Fix "private" (non-global) IP address ranges ([pythonGH-113179](https://github.com/python/cpython/pull/113179)) ([pythonGH-113186](https://github.com/python/cpython/pull/113186))
([pythonGH-118177](https://github.com/python/cpython/pull/118177))

(cherry picked from commit [f86b17a](https://github.com/ActiveState/cpython/commit/f86b17ac511e68192ba71f27e752321a3252cee3))

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
(cherry picked from commit [05a1467](https://github.com/ActiveState/cpython/commit/05a14677846ed0a35773cd2ba582f9a65a3dfa48))

[pythongh-113171](https://github.com/python/cpython/issues/113171): [pythongh-65056](https://github.com/python/cpython/issues/65056): Fix "private" (non-global) IP address ranges
([pythonGH-113179](https://github.com/python/cpython/pull/113179)) ([pythonGH-113186](https://github.com/python/cpython/pull/113186)) ([pythonGH-118177](https://github.com/python/cpython/pull/118177))

* [pythonGH-113171](https://github.com/python/cpython/issues/113171): Fix "private" (non-global) IP address ranges ([pythonGH-113179](https://github.com/python/cpython/pull/113179))

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] [python#61602](https://github.com/python/cpython/issues/61602)

* [pythonGH-65056](https://github.com/python/cpython/issues/65056): Improve the IP address' is_global/is_private documentation ([pythonGH-113186](https://github.com/python/cpython/pull/113186))

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit [2a4cbf1](https://github.com/ActiveState/cpython/commit/2a4cbf17af19a01d942f9579342f77c39fbd23c4))
(cherry picked from commit [40d75c2](https://github.com/ActiveState/cpython/commit/40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f))

---------

(cherry picked from commit [f86b17a](https://github.com/ActiveState/cpython/commit/f86b17ac511e68192ba71f27e752321a3252cee3))

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
(cherry picked from commit [05a1467](https://github.com/ActiveState/cpython/commit/05a14677846ed0a35773cd2ba582f9a65a3dfa48))

Add IPv6 addresses to suspignore.csv

That's a lot of semicolons!

(cherry picked from commit [e366724](https://github.com/ActiveState/cpython/commit/e366724f6e290b71ec49005079e8472c3cac2594))
```

[frenzymadness](/frenzymadness)
pushed a commit
to frenzymadness/cpython
that referenced
this pull request
[Aug 13, 2024](#ref-commit-7ef313f)
[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou) [![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak) [![@frenzymadness](https://avatars.githubusercontent.com/u/5688939?s=40&v=4)](/frenzymadness)

`[00431:](/frenzymadness/cpython/commit/7ef313f659ac6f2ad213615e6454abc20e7c518b "00431: gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177) (GH-118472)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 (\"This network\") and the other in
255.255.255.255/32 (\"Limited broadcast\").

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>") [pythongh-113171](https://github.com/python/cpython/issues/113171)[:](/frenzymadness/cpython/commit/7ef313f659ac6f2ad213615e6454abc20e7c518b "00431: gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177) (GH-118472)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 (\"This network\") and the other in
255.255.255.255/32 (\"Limited broadcast\").

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>") [pythongh-65056](https://github.com/python/cpython/issues/65056)[: Fix "private" (non-global) IP…](/frenzymadness/cpython/commit/7ef313f659ac6f2ad213615e6454abc20e7c518b "00431: gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177) (GH-118472)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 (\"This network\") and the other in
255.255.255.255/32 (\"Limited broadcast\").

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>")`
…

`[7ef313f](/frenzymadness/cpython/commit/7ef313f659ac6f2ad213615e6454abc20e7c518b)`

```
… address ranges ([pythonGH-113179](https://github.com/python/cpython/pull/113179)) ([pythonGH-113186](https://github.com/python/cpython/pull/113186)) ([pythonGH-118177](https://github.com/python/cpython/pull/118177)) ([pythonGH-118472](https://github.com/python/cpython/pull/118472))

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] [python#61602](https://github.com/python/cpython/issues/61602)

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 ("This network") and the other in
255.255.255.255/32 ("Limited broadcast").

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
```

[frenzymadness](/frenzymadness)
pushed a commit
to fedora-python/cpython
that referenced
this pull request
[Aug 15, 2024](#ref-commit-71337f4)
[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou) [![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak) [![@frenzymadness](https://avatars.githubusercontent.com/u/5688939?s=40&v=4)](/frenzymadness)

`[00431:](/fedora-python/cpython/commit/71337f4081170c2d712ddea9b8eaad5a5734fee1 "00431: gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177) (GH-118472)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 (\"This network\") and the other in
255.255.255.255/32 (\"Limited broadcast\").

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>") [pythongh-113171](https://github.com/python/cpython/issues/113171)[:](/fedora-python/cpython/commit/71337f4081170c2d712ddea9b8eaad5a5734fee1 "00431: gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177) (GH-118472)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 (\"This network\") and the other in
255.255.255.255/32 (\"Limited broadcast\").

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>") [pythongh-65056](https://github.com/python/cpython/issues/65056)[: Fix "private" (non-global) IP…](/fedora-python/cpython/commit/71337f4081170c2d712ddea9b8eaad5a5734fee1 "00431: gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177) (GH-118472)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 (\"This network\") and the other in
255.255.255.255/32 (\"Limited broadcast\").

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>")`
…

`[71337f4](/fedora-python/cpython/commit/71337f4081170c2d712ddea9b8eaad5a5734fee1)`

```
… address ranges ([pythonGH-113179](https://github.com/python/cpython/pull/113179)) ([pythonGH-113186](https://github.com/python/cpython/pull/113186)) ([pythonGH-118177](https://github.com/python/cpython/pull/118177)) ([pythonGH-118472](https://github.com/python/cpython/pull/118472))

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] [python#61602](https://github.com/python/cpython/issues/61602)

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 ("This network") and the other in
255.255.255.255/32 ("Limited broadcast").

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
```

[stratakis](/stratakis)
pushed a commit
to stratakis/cpython
that referenced
this pull request
[Aug 15, 2024](#ref-commit-234aea1)
[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&u=7f95514f77f2141670224b63de2bec2c9d7d514f&v=4)](/encukou) [![@stratakis](https://avatars.githubusercontent.com/u/14812606?s=40&v=4)](/stratakis)

`[00431:](/stratakis/cpython/commit/234aea11c762ef701283e9dec9fcb9282b0b8f64 "00431: gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177) (GH-118472)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 (\"This network\") and the other in
255.255.255.255/32 (\"Limited broadcast\").") [pythongh-113171](https://github.com/python/cpython/issues/113171)[:](/stratakis/cpython/commit/234aea11c762ef701283e9dec9fcb9282b0b8f64 "00431: gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177) (GH-118472)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 (\"This network\") and the other in
255.255.255.255/32 (\"Limited broadcast\").") [pythongh-65056](https://github.com/python/cpython/issues/65056)[: Fix "private" (non-global) IP…](/stratakis/cpython/commit/234aea11c762ef701283e9dec9fcb9282b0b8f64 "00431: gh-113171: gh-65056: Fix \"private\" (non-global) IP address ranges (GH-113179) (GH-113186) (GH-118177) (GH-118472)

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] https://github.com/python/cpython/issues/61602

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 (\"This network\") and the other in
255.255.255.255/32 (\"Limited broadcast\").")`
…

`[234aea1](/stratakis/cpython/commit/234aea11c762ef701283e9dec9fcb9282b0b8f64)`

```
… address ranges ([pythonGH-113179](https://github.com/python/cpython/pull/113179)) ([pythonGH-113186](https://github.com/python/cpython/pull/113186)) ([pythonGH-118177](https://github.com/python/cpython/pull/118177)) ([pythonGH-118472](https://github.com/python/cpython/pull/118472))

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] [python#61602](https://github.com/python/cpython/issues/61602)

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 ("This network") and the other in
255.255.255.255/32 ("Limited broadcast").
```

[![@vEpiphyte](https://avatars.githubusercontent.com/u/26100278?s=40&v=4)](/vEpiphyte)
[vEpiphyte](/vEpiphyte)
mentioned this pull request
[Aug 30, 2024](#ref-pullrequest-2497675611)

[Pin Python3.11 package to 3.11.2-6+deb12u2 to avoid changes from CVE-2024-4032
vertexproject/vtx-base-image#716](/vertexproject/vtx-base-image/pull/716)
 Merged

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fpython%2Fcpython%2Fpull%2F113179)

Reviewers

[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&v=4)](/encukou) [encukou](/encukou)

encukou left review comments

Assignees

[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&v=4)](/encukou) [encukou](/encukou)

Labels

[needs backport to 3.9](/python/cpython/labels/needs%20backport%20to%203.9)
only security fixes
[needs backport to 3.10](/python/cpython/labels/needs%20backport%20to%203.10)
only security fixes
[needs backport to 3.11](/python/cpython/labels/needs%20backport%20to%203.11)
only security fixes
[needs backport to 3.12](/python/cpython/labels/needs%20backport%20to%203.12)
bug and security fixes

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

2 participants

[![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=52&v=4)](/jstasiak) [![@encukou](https://avatars.githubusercontent.com/u/302922?s=52&v=4)](/encukou)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.iana.org_1c3f2e6a_20250110_175747.html ===

[![Internet Assigned Numbers Authority](https://www.iana.org/_img/2022/iana-logo-header.svg)](/)

# IANA IPv6 Special-Purpose Address Registry

Created
2006-01-10
Last Updated
2024-10-22
Available Formats
[![](/_img/icons/text-xml.png)
XML](iana-ipv6-special-registry.xml)
[![](/_img/icons/text-html.png)
HTML](iana-ipv6-special-registry.xhtml)
[![](/_img/icons/text-plain.png)
Plain text](iana-ipv6-special-registry.txt)

**Registry included below**

* [IANA IPv6 Special-Purpose Address Registry](#iana-ipv6-special-registry-1)

## IANA IPv6 Special-Purpose Address Registry

Registration Procedure(s)
```
IETF Review
```

Reference
[[RFC4773](https://www.iana.org/go/rfc4773)][[RFC6890](https://www.iana.org/go/rfc6890)][[RFC8190](https://www.iana.org/go/rfc8190)]
Note
```
Address prefixes listed in the Special-Purpose Address Registry are
not guaranteed routability in any particular local or global context.

The IPv4 and IPv6 Special-Purpose Address Registries maintain the following
information regarding each entry:

   o  Address Block - A block of IPv4 or IPv6 addresses that has been
      registered for a special purpose.

   o  Name - A descriptive name for the special-purpose address block.

   o  RFC - The RFC through which the special-purpose address block was
      requested.

   o  Allocation Date - The date upon which the special-purpose address
      block was allocated.

   o  Termination Date - The date upon which the allocation is to be
      terminated.  This field is applicable for limited-use allocations
      only.

   o  Source - A boolean value indicating whether an address from the
      allocated special-purpose address block is valid when used as the
      source address of an IP datagram that transits two devices.

   o  Destination - A boolean value indicating whether an address from
      the allocated special-purpose address block is valid when used as
      the destination address of an IP datagram that transits two
      devices.

   o  Forwardable - A boolean value indicating whether a router may
      forward an IP datagram whose destination address is drawn from the
      allocated special-purpose address block between external
      interfaces.

   o  Globally Reachable - A boolean value indicating whether an IP
      datagram whose destination address is drawn from the allocated
      special-purpose address block is forwardable beyond a specified
      administrative domain.

   o  Reserved-by-Protocol - A boolean value indicating whether the
      special-purpose address block is reserved by IP, itself.  This
      value is "TRUE" if the RFC that created the special-purpose
      address block requires all compliant IP implementations to behave
      in a special way when processing packets either to or from
      addresses contained by the address block.

If the value of "Destination" is FALSE, the values of "Forwardable" and
"Globally Reachable" must also be false.

```

Available Formats
[![](/_img/icons/text-csv.png)
CSV](iana-ipv6-special-registry-1.csv)

| Address Block | Name | RFC | Allocation Date | Termination Date | Source | Destination | Forwardable | Globally Reachable | Reserved-by-Protocol |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| ::1/128 | Loopback Address | [[RFC4291](https://www.iana.org/go/rfc4291)] | 2006-02 | N/A | False | False | False | False | True |
| ::/128 | Unspecified Address | [[RFC4291](https://www.iana.org/go/rfc4291)] | 2006-02 | N/A | True | False | False | False | True |
| ::ffff:0:0/96 | IPv4-mapped Address | [[RFC4291](https://www.iana.org/go/rfc4291)] | 2006-02 | N/A | False | False | False | False | True |
| 64:ff9b::/96 | IPv4-IPv6 Translat. | [[RFC6052](https://www.iana.org/go/rfc6052)] | 2010-10 | N/A | True | True | True | True | False |
| 64:ff9b:1::/48 | IPv4-IPv6 Translat. | [[RFC8215](https://www.iana.org/go/rfc8215)] | 2017-06 | N/A | True | True | True | False | False |
| 100::/64 | Discard-Only Address Block | [[RFC6666](https://www.iana.org/go/rfc6666)] | 2012-06 | N/A | True | True | True | False | False |
| 2001::/23 | IETF Protocol Assignments | [[RFC2928](https://www.iana.org/go/rfc2928)] | 2000-09 | N/A | False [[1](#note1)] | False [[1](#note1)] | False [[1](#note1)] | False [[1](#note1)] | False |
| 2001::/32 | TEREDO | [[RFC4380](https://www.iana.org/go/rfc4380)] [[RFC8190](https://www.iana.org/go/rfc8190)] | 2006-01 | N/A | True | True | True | N/A [[2](#note2)] | False |
| 2001:1::1/128 | Port Control Protocol Anycast | [[RFC7723](https://www.iana.org/go/rfc7723)] | 2015-10 | N/A | True | True | True | True | False |
| 2001:1::2/128 | Traversal Using Relays around NAT Anycast | [[RFC8155](https://www.iana.org/go/rfc8155)] | 2017-02 | N/A | True | True | True | True | False |
| 2001:1::3/128 | DNS-SD Service Registration Protocol Anycast | [[RFC-ietf-dnssd-srp-25](https://www.iana.org/go/draft-ietf-dnssd-srp-25)] | 2024-04 | N/A | True | True | True | True | False |
| 2001:2::/48 | Benchmarking | [[RFC5180](https://www.iana.org/go/rfc5180)][[RFC Errata 1752](http://www.rfc-editor.org/errata_search.php?eid=1752)] | 2008-04 | N/A | True | True | True | False | False |
| 2001:3::/32 | AMT | [[RFC7450](https://www.iana.org/go/rfc7450)] | 2014-12 | N/A | True | True | True | True | False |
| 2001:4:112::/48 | AS112-v6 | [[RFC7535](https://www.iana.org/go/rfc7535)] | 2014-12 | N/A | True | True | True | True | False |
| 2001:10::/28 | Deprecated (previously ORCHID) | [[RFC4843](https://www.iana.org/go/rfc4843)] | 2007-03 | 2014-03 |  |  |  |  |  |
| 2001:20::/28 | ORCHIDv2 | [[RFC7343](https://www.iana.org/go/rfc7343)] | 2014-07 | N/A | True | True | True | True | False |
| 2001:30::/28 | Drone Remote ID Protocol Entity Tags (DETs) Prefix | [[RFC9374](https://www.iana.org/go/rfc9374)] | 2022-12 | N/A | True | True | True | True | False |
| 2001:db8::/32 | Documentation | [[RFC3849](https://www.iana.org/go/rfc3849)] | 2004-07 | N/A | False | False | False | False | False |
| 2002::/16 [[3](#note3)] | 6to4 | [[RFC3056](https://www.iana.org/go/rfc3056)] | 2001-02 | N/A | True | True | True | N/A [[3](#note3)] | False |
| 2620:4f:8000::/48 | Direct Delegation AS112 Service | [[RFC7534](https://www.iana.org/go/rfc7534)] | 2011-05 | N/A | True | True | True | True | False |
| 3fff::/20 | Documentation | [[RFC9637](https://www.iana.org/go/rfc9637)] | 2024-07 | N/A | False | False | False | False | False |
| 5f00::/16 | Segment Routing (SRv6) SIDs | [[RFC9602](https://www.iana.org/go/rfc9602)] | 2024-04 | N/A | True | True | True | False | False |
| fc00::/7 | Unique-Local | [[RFC4193](https://www.iana.org/go/rfc4193)] [[RFC8190](https://www.iana.org/go/rfc8190)] | 2005-10 | N/A | True | True | True | False [[4](#note4)] | False |
| fe80::/10 | Link-Local Unicast | [[RFC4291](https://www.iana.org/go/rfc4291)] | 2006-02 | N/A | True | True | False | False | True |

# Footnotes

| [1] | ``` Unless allowed by a more specific allocation. ``` |
| --- | --- |
| [2] | ``` See Section 5 of [[RFC4380](https://www.iana.org/go/rfc4380)] for details. ``` |
| [3] | ``` See [[RFC3056](https://www.iana.org/go/rfc3056)] for details. ``` |
| [4] | ``` See [[RFC4193](https://www.iana.org/go/rfc4193)] for more details on the routability of Unique-Local addresses.  The Unique-Local prefix is  drawn from the IPv6 Global Unicast Address range, but is specified as not globally routed. ``` |

[Licensing Terms](https://www.iana.org/help/licensing-terms)



=== Content from mail.python.org_cd763e52_20250110_175746.html ===


[Mailman 3 python.org](/archives/)

[Sign In](/accounts/login/?next=/archives/list/security-announce%40python.org/thread/NRUHDUS2IV2USIZM2CVMSFL6SCKU3RZA/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40python.org/thread/NRUHDUS2IV2USIZM2CVMSFL6SCKU3RZA/)

[Manage this list](/mailman3/lists/security-announce.python.org/)
[Sign In](/accounts/login/?next=/archives/list/security-announce%40python.org/thread/NRUHDUS2IV2USIZM2CVMSFL6SCKU3RZA/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40python.org/thread/NRUHDUS2IV2USIZM2CVMSFL6SCKU3RZA/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[newer](/archives/list/security-announce%40python.org/thread/BMAK5BCGKYWNJOACVUSLUF6SFGBIM4VP/ "[CVE-2024-0397] Memory race condition in ssl.SSLContext certificate store methods")

[[CVE-2024-0397] Memory race...](/archives/list/security-announce%40python.org/thread/BMAK5BCGKYWNJOACVUSLUF6SFGBIM4VP/ "[CVE-2024-0397] Memory race condition in ssl.SSLContext certificate store methods")

### [CVE-2024-4032] Incorrect IPv4 and IPv6 private ranges

[older](/archives/list/security-announce%40python.org/thread/PRGS5OR3N3PNPT4BMV2VAGN5GMUI5636/ "[CVE-2024-4030] tempfile.mkdtemp() may be readable and writeable by all users on Windows")

[[CVE-2024-4030] tempfile.mkdtemp()...](/archives/list/security-announce%40python.org/thread/PRGS5OR3N3PNPT4BMV2VAGN5GMUI5636/ "[CVE-2024-4030] tempfile.mkdtemp() may be readable and writeable by all users on Windows")

![](https://secure.gravatar.com/avatar/b5a0900288ad3a29fd4a5ef260486055.jpg?s=120&d=mm&r=g)

## [Seth Larson](/archives/users/eb0c073014124400ac984fd5e76d1f7e/ "See the profile for Seth Larson")

17 Jun
2024

17 Jun
'24

7:01 a.m.

The “ipaddress” module contained incorrect information about whether
certain IPv4 and IPv6 addresses were designated as “globally reachable” or
“private”. This affected the 'is\_private' and 'is\_global' properties of the
ipaddress.IPv4Address, ipaddress.IPv4Network, ipaddress.IPv6Address, and
ipaddress.IPv6Network classes, where values wouldn’t be returned in
accordance with the latest information from the IANA Special-Purpose
Address Registries.

CPython 3.12.4 and 3.13.0a6 contain updated information from these
registries and thus have the intended behavior.

Severity: Medium

References

* <https://github.com/python/cpython/issues/113171>
* <https://github.com/python/cpython/pull/113179>
* [https://www.iana.org/assignments/iana-ipv4-special-registry/iana-ipv4-specia...](https://www.iana.org/assignments/iana-ipv4-special-registry/iana-ipv4-special-registry.xhtml)
* [https://www.iana.org/assignments/iana-ipv6-special-registry/iana-ipv6-specia...](https://www.iana.org/assignments/iana-ipv6-special-registry/iana-ipv6-special-registry.xhtml)

Attachments:

* [attachment.html](/archives/list/security-announce%40python.org/message/NRUHDUS2IV2USIZM2CVMSFL6SCKU3RZA/attachment/2/attachment.html)
  (text/html — 1.3 KB)

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/security-announce%40python.org/thread/NRUHDUS2IV2USIZM2CVMSFL6SCKU3RZA/)
Use email software

[Show replies by date](/archives/list/security-announce%40python.org/thread/NRUHDUS2IV2USIZM2CVMSFL6SCKU3RZA/?sort=date)

![Loading...](/static/hyperkitty/img/ajax-loader.gif)
[Visit here for a non-javascript version of this page.](/archives/list/security-announce%40python.org/thread/NRUHDUS2IV2USIZM2CVMSFL6SCKU3RZA/?noscript)

207
Age (days ago)

207
Last active (days ago)

[List overview](/archives/list/security-announce%40python.org/)

[Download](/archives/list/security-announce%40python.org/export/security-announce%40python.org-NRUHDUS2IV2USIZM2CVMSFL6SCKU3RZA.mbox.gz?thread=NRUHDUS2IV2USIZM2CVMSFL6SCKU3RZA "This thread in gzipped mbox format")

0 comments

1 participants

[Add to favorites](#AddFav "You must be logged-in to have favorites.")
[Remove from favorites](#RmFav)

### tags

### participants (1)

* ![](https://secure.gravatar.com/avatar/b5a0900288ad3a29fd4a5ef260486055.jpg?s=48&d=mm&r=g)
  Seth Larson

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from github.com_c7ff7a44_20250110_175733.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpython%2Fcpython%2Fcommit%2F895f7e2ac23eff4743143beef0f0c5ac71ea27d3)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpython%2Fcpython%2Fcommit%2F895f7e2ac23eff4743143beef0f0c5ac71ea27d3)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=python%2Fcpython)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[python](/python)
/
**[cpython](/python/cpython)**
Public

* [Notifications](/login?return_to=%2Fpython%2Fcpython) You must be signed in to change notification settings
* [Fork
  30.8k](/login?return_to=%2Fpython%2Fcpython)
* [Star
   64.7k](/login?return_to=%2Fpython%2Fcpython)

* [Code](/python/cpython)
* [Issues
  5k+](/python/cpython/issues)
* [Pull requests
  1.8k](/python/cpython/pulls)
* [Actions](/python/cpython/actions)
* [Projects
  28](/python/cpython/projects)
* [Security](/python/cpython/security)
* [Insights](/python/cpython/pulse)

Additional navigation options

* [Code](/python/cpython)
* [Issues](/python/cpython/issues)
* [Pull requests](/python/cpython/pulls)
* [Actions](/python/cpython/actions)
* [Projects](/python/cpython/projects)
* [Security](/python/cpython/security)
* [Insights](/python/cpython/pulse)

## Commit

[Permalink](/python/cpython/commit/895f7e2ac23eff4743143beef0f0c5ac71ea27d3)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

[3.8] [gh-113171](https://github.com/python/cpython/issues/113171): [gh-65056](https://github.com/python/cpython/issues/65056): Fix "private" (non-global) IP address rang…

[Browse files](/python/cpython/tree/895f7e2ac23eff4743143beef0f0c5ac71ea27d3)
Browse the repository at this point in the history

```
…es ([GH-113179](https://github.com/python/cpython/pull/113179)) ([GH-113186](https://github.com/python/cpython/pull/113186)) ([GH-118177](https://github.com/python/cpython/pull/118177)) ([GH-118479](https://github.com/python/cpython/pull/118479))

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] [#61602](https://github.com/python/cpython/issues/61602)

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 ("This network") and the other in
255.255.255.255/32 ("Limited broadcast").

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
```

* Loading branch information

[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&v=4)](/encukou) [![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak)

[encukou](/python/cpython/commits?author=encukou "View all commits by encukou")
and
[jstasiak](/python/cpython/commits?author=jstasiak "View all commits by jstasiak")
authored
May 7, 2024

1 parent
[f791cda](/python/cpython/commit/f791cda79331f64e46b5e561f2f85f116aa5c494)

commit 895f7e2

 Show file tree

 Hide file tree

Showing
**6 changed files**
with
**195 additions**
and
**21 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* Doc

  + library

    - Doc/library/ipaddress.rst
      [ipaddress.rst](#diff-d9c61a8ece8cc31330309c90fc34330e1c21bc615ad0941aac8ca6af36f99568)
  + tools

    - Doc/tools/susp-ignored.csv
      [susp-ignored.csv](#diff-f2d07d8e818b46b42f9fff17a09058c554e8cb6baa7fbfbdf77b266c97155f4e)
  + whatsnew

    - Doc/whatsnew/3.8.rst
      [3.8.rst](#diff-fc26ec44ce02bff5ba0fc0c1c750748ff5dea3bec156c6fdf3f666d943e81992)
* Lib

  + Lib/ipaddress.py
    [ipaddress.py](#diff-f67a8b5be6bdc48383d2ab907325a4c75ef998fa7cd0bba382ec2efa7e4f00b5)
  + test

    - Lib/test/test\_ipaddress.py
      [test\_ipaddress.py](#diff-75d091371807896a8a66871de0fae89ad932066b2c4b73f9278e549ef25826c7)
* Misc/NEWS.d/next/Library

  + Misc/NEWS.d/next/Library/2024-03-14-01-38-44.gh-issue-113171.VFnObz.rst
    [2024-03-14-01-38-44.gh-issue-113171.VFnObz.rst](#diff-2d6ca0985b215bccb49c607530d008bc3014490e8ac3d6b3e51f32aa94f2c1d7)

## There are no files selected for viewing

43 changes: 39 additions & 4 deletions

43
[Doc/library/ipaddress.rst](#diff-d9c61a8ece8cc31330309c90fc34330e1c21bc615ad0941aac8ca6af36f99568 "Doc/library/ipaddress.rst")

Show comments

[View file](/python/cpython/blob/895f7e2ac23eff4743143beef0f0c5ac71ea27d3/Doc/library/ipaddress.rst)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -179,18 +179,53 @@ write code that handles both IP versions correctly. Address objects are |
|  |  |  |
|  |  | .. attribute:: is\_private |
|  |  |  |
|  |  | ``True`` if the address is allocated for private networks. See |
|  |  | ``True`` if the address is defined as not globally reachable by |
|  |  | iana-ipv4-special-registry\_ (for IPv4) or iana-ipv6-special-registry\_ |
|  |  | (for IPv6). |
|  |  | (for IPv6) with the following exceptions: |
|  |  |  |
|  |  | \* ``is\_private`` is ``False`` for the shared address space (``100.64.0.0/10``) |
|  |  | \* For IPv4-mapped IPv6-addresses the ``is\_private`` value is determined by the |
|  |  | semantics of the underlying IPv4 addresses and the following condition holds |
|  |  | (see :attr:`IPv6Address.ipv4\_mapped`):: |
|  |  |  |
|  |  | address.is\_private == address.ipv4\_mapped.is\_private |
|  |  |  |
|  |  | ``is\_private`` has value opposite to :attr:`is\_global`, except for the shared address space |
|  |  | (``100.64.0.0/10`` range) where they are both ``False``. |
|  |  |  |
|  |  | .. versionchanged:: 3.8.20 |
|  |  |  |
|  |  | Fixed some false positives and false negatives. |
|  |  |  |
|  |  | \* ``192.0.0.0/24`` is considered private with the exception of ``192.0.0.9/32`` and |
|  |  | ``192.0.0.10/32`` (previously: only the ``192.0.0.0/29`` sub-range was considered private). |
|  |  | \* ``64:ff9b:1::/48`` is considered private. |
|  |  | \* ``2002::/16`` is considered private. |
|  |  | \* There are exceptions within ``2001::/23`` (otherwise considered private): ``2001:1::1/128``, |
|  |  | ``2001:1::2/128``, ``2001:3::/32``, ``2001:4:112::/48``, ``2001:20::/28``, ``2001:30::/28``. |
|  |  | The exceptions are not considered private. |
|  |  |  |
|  |  | .. attribute:: is\_global |
|  |  |  |
|  |  | ``True`` if the address is allocated for public networks. See |
|  |  | ``True`` if the address is defined as globally reachable by |
|  |  | iana-ipv4-special-registry\_ (for IPv4) or iana-ipv6-special-registry\_ |
|  |  | (for IPv6). |
|  |  | (for IPv6) with the following exception: |
|  |  |  |
|  |  | For IPv4-mapped IPv6-addresses the ``is\_private`` value is determined by the |
|  |  | semantics of the underlying IPv4 addresses and the following condition holds |
|  |  | (see :attr:`IPv6Address.ipv4\_mapped`):: |
|  |  |  |
|  |  | address.is\_global == address.ipv4\_mapped.is\_global |
|  |  |  |
|  |  | ``is\_global`` has value opposite to :attr:`is\_private`, except for the shared address space |
|  |  | (``100.64.0.0/10`` range) where they are both ``False``. |
|  |  |  |
|  |  | .. versionadded:: 3.4 |
|  |  |  |
|  |  | .. versionchanged:: 3.8.20 |
|  |  |  |
|  |  | Fixed some false positives and false negatives, see :attr:`is\_private` for details. |
|  |  |  |
|  |  | .. attribute:: is\_unspecified |
|  |  |  |
|  |  | ``True`` if the address is unspecified. See :RFC:`5735` (for IPv4) |
| Expand Down | |  |

8 changes: 8 additions & 0 deletions

8
[Doc/tools/susp-ignored.csv](#diff-f2d07d8e818b46b42f9fff17a09058c554e8cb6baa7fbfbdf77b266c97155f4e "Doc/tools/susp-ignored.csv")

Show comments

[View file](/python/cpython/blob/895f7e2ac23eff4743143beef0f0c5ac71ea27d3/Doc/tools/susp-ignored.csv)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -158,6 +158,14 @@ library/ipaddress,,:db00,2001:db00::0/24 |
|  |  | library/ipaddress,,::,2001:db00::0/24 |
|  |  | library/ipaddress,,:db00,2001:db00::0/ffff:ff00:: |
|  |  | library/ipaddress,,::,2001:db00::0/ffff:ff00:: |
|  |  | library/ipaddress,,:ff9b,64:ff9b:1::/48 |
|  |  | library/ipaddress,,::,64:ff9b:1::/48 |
|  |  | library/ipaddress,,::,2001:: |
|  |  | library/ipaddress,,::,2001:1:: |
|  |  | library/ipaddress,,::,2001:3:: |
|  |  | library/ipaddress,,::,2001:4:112:: |
|  |  | library/ipaddress,,::,2001:20:: |
|  |  | library/ipaddress,,::,2001:30:: |
|  |  | library/itertools,,:step,elements from seq[start:stop:step] |
|  |  | library/itertools,,:stop,elements from seq[start:stop:step] |
|  |  | library/logging.handlers,,:port,host:port |
| Expand Down | |  |

9 changes: 9 additions & 0 deletions

9
[Doc/whatsnew/3.8.rst](#diff-fc26ec44ce02bff5ba0fc0c1c750748ff5dea3bec156c6fdf3f666d943e81992 "Doc/whatsnew/3.8.rst")

Show comments

[View file](/python/cpython/blob/895f7e2ac23eff4743143beef0f0c5ac71ea27d3/Doc/whatsnew/3.8.rst)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -2355,3 +2355,12 @@ tarfile |
|  |  | :exc:`DeprecationWarning`. |
|  |  | In Python 3.14, the default will switch to ``'data'``. |
|  |  | (Contributed by Petr Viktorin in :pep:`706`.) |
|  |  |  |
|  |  | Notable changes in 3.8.20 |
|  |  | ========================= |
|  |  |  |
|  |  | ipaddress |
|  |  | --------- |
|  |  |  |
|  |  | \* Fixed ``is\_global`` and ``is\_private`` behavior in ``IPv4Address``, |
|  |  | ``IPv6Address``, ``IPv4Network`` and ``IPv6Network``. |

95 changes: 78 additions & 17 deletions

95
[Lib/ipaddress.py](#diff-f67a8b5be6bdc48383d2ab907325a4c75ef998fa7cd0bba382ec2efa7e4f00b5 "Lib/ipaddress.py")

Show comments

[View file](/python/cpython/blob/895f7e2ac23eff4743143beef0f0c5ac71ea27d3/Lib/ipaddress.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1275,18 +1275,41 @@ def is\_reserved(self): |
|  |  | @property |
|  |  | @functools.lru\_cache() |
|  |  | def is\_private(self): |
|  |  | """Test if this address is allocated for private networks. |
|  |  | """``True`` if the address is defined as not globally reachable by |
|  |  | iana-ipv4-special-registry\_ (for IPv4) or iana-ipv6-special-registry\_ |
|  |  | (for IPv6) with the following exceptions: |
|  |  |  |
|  |  | Returns: |
|  |  | A boolean, True if the address is reserved per |
|  |  | iana-ipv4-special-registry. |
|  |  | \* ``is\_private`` is ``False`` for ``100.64.0.0/10`` |
|  |  | \* For IPv4-mapped IPv6-addresses the ``is\_private`` value is determined by the |
|  |  | semantics of the underlying IPv4 addresses and the following condition holds |
|  |  | (see :attr:`IPv6Address.ipv4\_mapped`):: |
|  |  |  |
|  |  | address.is\_private == address.ipv4\_mapped.is\_private |
|  |  |  |
|  |  | ``is\_private`` has value opposite to :attr:`is\_global`, except for the ``100.64.0.0/10`` |
|  |  | IPv4 range where they are both ``False``. |
|  |  | """ |
|  |  | return any(self in net for net in self.\_constants.\_private\_networks) |
|  |  | return ( |
|  |  | any(self in net for net in self.\_constants.\_private\_networks) |
|  |  | and all(self not in net for net in self.\_constants.\_private\_networks\_exceptions) |
|  |  | ) |
|  |  |  |
|  |  | @property |
|  |  | @functools.lru\_cache() |
|  |  | def is\_global(self): |
|  |  | """``True`` if the address is defined as globally reachable by |
|  |  | iana-ipv4-special-registry\_ (for IPv4) or iana-ipv6-special-registry\_ |
|  |  | (for IPv6) with the following exception: |
|  |  |  |
|  |  | For IPv4-mapped IPv6-addresses the ``is\_private`` value is determined by the |
|  |  | semantics of the underlying IPv4 addresses and the following condition holds |
|  |  | (see :attr:`IPv6Address.ipv4\_mapped`):: |
|  |  |  |
|  |  | address.is\_global == address.ipv4\_mapped.is\_global |
|  |  |  |
|  |  | ``is\_global`` has value opposite to :attr:`is\_private`, except for the ``100.64.0.0/10`` |
|  |  | IPv4 range where they are both ``False``. |
|  |  | """ |
|  |  | return self not in self.\_constants.\_public\_network and not self.is\_private |
|  |  |  |
|  |  | @property |
| Expand Down  Expand Up | | @@ -1490,13 +1513,15 @@ class \_IPv4Constants: |
|  |  |  |
|  |  | \_public\_network = IPv4Network('100.64.0.0/10') |
|  |  |  |
|  |  | # Not globally reachable address blocks listed on |
|  |  | # https://www.iana.org/assignments/iana-ipv4-special-registry/iana-ipv4-special-registry.xhtml |
|  |  | \_private\_networks = [ |
|  |  | IPv4Network('0.0.0.0/8'), |
|  |  | IPv4Network('10.0.0.0/8'), |
|  |  | IPv4Network('127.0.0.0/8'), |
|  |  | IPv4Network('169.254.0.0/16'), |
|  |  | IPv4Network('172.16.0.0/12'), |
|  |  | IPv4Network('192.0.0.0/29'), |
|  |  | IPv4Network('192.0.0.0/24'), |
|  |  | IPv4Network('192.0.0.170/31'), |
|  |  | IPv4Network('192.0.2.0/24'), |
|  |  | IPv4Network('192.168.0.0/16'), |
| Expand All | | @@ -1507,6 +1532,11 @@ class \_IPv4Constants: |
|  |  | IPv4Network('255.255.255.255/32'), |
|  |  | ] |
|  |  |  |
|  |  | \_private\_networks\_exceptions = [ |
|  |  | IPv4Network('192.0.0.9/32'), |
|  |  | IPv4Network('192.0.0.10/32'), |
|  |  | ] |
|  |  |  |
|  |  | \_reserved\_network = IPv4Network('240.0.0.0/4') |
|  |  |  |
|  |  | \_unspecified\_address = IPv4Address('0.0.0.0') |
| Expand Down  Expand Up | | @@ -1897,23 +1927,42 @@ def is\_site\_local(self): |
|  |  | @property |
|  |  | @functools.lru\_cache() |
|  |  | def is\_private(self): |
|  |  | """Test if this address is allocated for private networks. |
|  |  | """``True`` if the address is defined as not globally reachable by |
|  |  | iana-ipv4-special-registry\_ (for IPv4) or iana-ipv6-special-registry\_ |
|  |  | (for IPv6) with the following exceptions: |
|  |  |  |
|  |  | Returns: |
|  |  | A boolean, True if the address is reserved per |
|  |  | iana-ipv6-special-registry. |
|  |  | \* ``is\_private`` is ``False`` for ``100.64.0.0/10`` |
|  |  | \* For IPv4-mapped IPv6-addresses the ``is\_private`` value is determined by the |
|  |  | semantics of the underlying IPv4 addresses and the following condition holds |
|  |  | (see :attr:`IPv6Address.ipv4\_mapped`):: |
|  |  |  |
|  |  | address.is\_private == address.ipv4\_mapped.is\_private |
|  |  |  |
|  |  | ``is\_private`` has value opposite to :attr:`is\_global`, except for the ``100.64.0.0/10`` |
|  |  | IPv4 range where they are both ``False``. |
|  |  | """ |
|  |  | return any(self in net for net in self.\_constants.\_private\_networks) |
|  |  | ipv4\_mapped = self.ipv4\_mapped |
|  |  | if ipv4\_mapped is not None: |
|  |  | return ipv4\_mapped.is\_private |
|  |  | return ( |
|  |  | any(self in net for net in self.\_constants.\_private\_networks) |
|  |  | and all(self not in net for net in self.\_constants.\_private\_networks\_exceptions) |
|  |  | ) |
|  |  |  |
|  |  | @property |
|  |  | def is\_global(self): |
|  |  | """Test if this address is allocated for public networks. |
|  |  | """``True`` if the address is defined as globally reachable by |
|  |  | iana-ipv4-special-registry\_ (for IPv4) or iana-ipv6-special-registry\_ |
|  |  | (for IPv6) with the following exception: |
|  |  |  |
|  |  | Returns: |
|  |  | A boolean, true if the address is not reserved per |
|  |  | iana-ipv6-special-registry. |
|  |  | For IPv4-mapped IPv6-addresses the ``is\_private`` value is determined by the |
|  |  | semantics of the underlying IPv4 addresses and the following condition holds |
|  |  | (see :attr:`IPv6Address.ipv4\_mapped`):: |
|  |  |  |
|  |  | address.is\_global == address.ipv4\_mapped.is\_global |
|  |  |  |
|  |  | ``is\_global`` has value opposite to :attr:`is\_private`, except for the ``100.64.0.0/10`` |
|  |  | IPv4 range where they are both ``False``. |
|  |  | """ |
|  |  | return not self.is\_private |
|  |  |  |
| Expand Down  Expand Up | | @@ -2154,19 +2203,31 @@ class \_IPv6Constants: |
|  |  |  |
|  |  | \_multicast\_network = IPv6Network('ff00::/8') |
|  |  |  |
|  |  | # Not globally reachable address blocks listed on |
|  |  | # https://www.iana.org/assignments/iana-ipv6-special-registry/iana-ipv6-special-registry.xhtml |
|  |  | \_private\_networks = [ |
|  |  | IPv6Network('::1/128'), |
|  |  | IPv6Network('::/128'), |
|  |  | IPv6Network('::ffff:0:0/96'), |
|  |  | IPv6Network('64:ff9b:1::/48'), |
|  |  | IPv6Network('100::/64'), |
|  |  | IPv6Network('2001::/23'), |
|  |  | IPv6Network('2001:2::/48'), |
|  |  | IPv6Network('2001:db8::/32'), |
|  |  | IPv6Network('2001:10::/28'), |
|  |  | # IANA says N/A, let's consider it not globally reachable to be safe |
|  |  | IPv6Network('2002::/16'), |
|  |  | IPv6Network('fc00::/7'), |
|  |  | IPv6Network('fe80::/10'), |
|  |  | ] |
|  |  |  |
|  |  | \_private\_networks\_exceptions = [ |
|  |  | IPv6Network('2001:1::1/128'), |
|  |  | IPv6Network('2001:1::2/128'), |
|  |  | IPv6Network('2001:3::/32'), |
|  |  | IPv6Network('2001:4:112::/48'), |
|  |  | IPv6Network('2001:20::/28'), |
|  |  | IPv6Network('2001:30::/28'), |
|  |  | ] |
|  |  |  |
|  |  | \_reserved\_networks = [ |
|  |  | IPv6Network('::/8'), IPv6Network('100::/8'), |
|  |  | IPv6Network('200::/7'), IPv6Network('400::/6'), |
| Expand Down | |  |

52 changes: 52 additions & 0 deletions

52
[Lib/test/test\_ipaddress.py](#diff-75d091371807896a8a66871de0fae89ad932066b2c4b73f9278e549ef25826c7 "Lib/test/test_ipaddress.py")

Show comments

[View file](/python/cpython/blob/895f7e2ac23eff4743143beef0f0c5ac71ea27d3/Lib/test/test_ipaddress.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1761,6 +1761,10 @@ def testReservedIpv4(self): |
|  |  | self.assertEqual(True, ipaddress.ip\_address( |
|  |  | '172.31.255.255').is\_private) |
|  |  | self.assertEqual(False, ipaddress.ip\_address('172.32.0.0').is\_private) |
|  |  | self.assertFalse(ipaddress.ip\_address('192.0.0.0').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('192.0.0.9').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('192.0.0.10').is\_global) |
|  |  | self.assertFalse(ipaddress.ip\_address('192.0.0.255').is\_global) |
|  |  |  |
|  |  | self.assertEqual(True, |
|  |  | ipaddress.ip\_address('169.254.100.200').is\_link\_local) |
| Expand All | | @@ -1776,6 +1780,40 @@ def testReservedIpv4(self): |
|  |  | self.assertEqual(False, ipaddress.ip\_address('128.0.0.0').is\_loopback) |
|  |  | self.assertEqual(True, ipaddress.ip\_network('0.0.0.0').is\_unspecified) |
|  |  |  |
|  |  | def testPrivateNetworks(self): |
|  |  | self.assertEqual(True, ipaddress.ip\_network("0.0.0.0/0").is\_private) |
|  |  | self.assertEqual(False, ipaddress.ip\_network("1.0.0.0/8").is\_private) |
|  |  |  |
|  |  | self.assertEqual(True, ipaddress.ip\_network("0.0.0.0/8").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("10.0.0.0/8").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("127.0.0.0/8").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("169.254.0.0/16").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("172.16.0.0/12").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("192.0.0.0/29").is\_private) |
|  |  | self.assertEqual(False, ipaddress.ip\_network("192.0.0.9/32").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("192.0.0.170/31").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("192.0.2.0/24").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("192.168.0.0/16").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("198.18.0.0/15").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("198.51.100.0/24").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("203.0.113.0/24").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("240.0.0.0/4").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("255.255.255.255/32").is\_private) |
|  |  |  |
|  |  | self.assertEqual(False, ipaddress.ip\_network("::/0").is\_private) |
|  |  | self.assertEqual(False, ipaddress.ip\_network("::ff/128").is\_private) |
|  |  |  |
|  |  | self.assertEqual(True, ipaddress.ip\_network("::1/128").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("::/128").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("::ffff:0:0/96").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("100::/64").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("2001:2::/48").is\_private) |
|  |  | self.assertEqual(False, ipaddress.ip\_network("2001:3::/48").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("2001:db8::/32").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("2001:10::/28").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("fc00::/7").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("fe80::/10").is\_private) |
|  |  |  |
|  |  | def testReservedIpv6(self): |
|  |  |  |
|  |  | self.assertEqual(True, ipaddress.ip\_network('ffff::').is\_multicast) |
| Expand Down  Expand Up | | @@ -1849,6 +1887,20 @@ def testReservedIpv6(self): |
|  |  | self.assertEqual(True, ipaddress.ip\_address('0::0').is\_unspecified) |
|  |  | self.assertEqual(False, ipaddress.ip\_address('::1').is\_unspecified) |
|  |  |  |
|  |  | self.assertFalse(ipaddress.ip\_address('64:ff9b:1::').is\_global) |
|  |  | self.assertFalse(ipaddress.ip\_address('2001::').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('2001:1::1').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('2001:1::2').is\_global) |
|  |  | self.assertFalse(ipaddress.ip\_address('2001:2::').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('2001:3::').is\_global) |
|  |  | self.assertFalse(ipaddress.ip\_address('2001:4::').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('2001:4:112::').is\_global) |
|  |  | self.assertFalse(ipaddress.ip\_address('2001:10::').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('2001:20::').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('2001:30::').is\_global) |
|  |  | self.assertFalse(ipaddress.ip\_address('2001:40::').is\_global) |
|  |  | self.assertFalse(ipaddress.ip\_address('2002::').is\_global) |
|  |  |  |
|  |  | # some generic IETF reserved addresses |
|  |  | self.assertEqual(True, ipaddress.ip\_address('100::').is\_reserved) |
|  |  | self.assertEqual(True, ipaddress.ip\_network('4000::1/128').is\_reserved) |
| Expand Down | |  |

9 changes: 9 additions & 0 deletions

9
[Misc/NEWS.d/next/Library/2024-03-14-01-38-44.gh-issue-113171.VFnObz.rst](#diff-2d6ca0985b215bccb49c607530d008bc3014490e8ac3d6b3e51f32aa94f2c1d7 "Misc/NEWS.d/next/Library/2024-03-14-01-38-44.gh-issue-113171.VFnObz.rst")

Show comments

[View file](/python/cpython/blob/895f7e2ac23eff4743143beef0f0c5ac71ea27d3/Misc/NEWS.d/next/Library/2024-03-14-01-38-44.gh-issue-113171.VFnObz.rst)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -0,0 +1,9 @@ |
|  |  | Fixed various false positives and false negatives in |
|  |  |  |
|  |  | \* :attr:`ipaddress.IPv4Address.is\_private` (see these docs for details) |
|  |  | \* :attr:`ipaddress.IPv4Address.is\_global` |
|  |  | \* :attr:`ipaddress.IPv6Address.is\_private` |
|  |  | \* :attr:`ipaddress.IPv6Address.is\_global` |
|  |  |  |
|  |  | Also in the corresponding :class:`ipaddress.IPv4Network` and :class:`ipaddress.IPv6Network` |
|  |  | attributes. |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `895f7e2`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpython%2Fcpython%2Fcommit%2F895f7e2ac23eff4743143beef0f0c5ac71ea27d3) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_e246a851_20250110_175731.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpython%2Fcpython%2Fcommit%2F22adf29da8d99933ffed8647d3e0726edd16f7f8)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpython%2Fcpython%2Fcommit%2F22adf29da8d99933ffed8647d3e0726edd16f7f8)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=python%2Fcpython)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[python](/python)
/
**[cpython](/python/cpython)**
Public

* [Notifications](/login?return_to=%2Fpython%2Fcpython) You must be signed in to change notification settings
* [Fork
  30.8k](/login?return_to=%2Fpython%2Fcpython)
* [Star
   64.7k](/login?return_to=%2Fpython%2Fcpython)

* [Code](/python/cpython)
* [Issues
  5k+](/python/cpython/issues)
* [Pull requests
  1.8k](/python/cpython/pulls)
* [Actions](/python/cpython/actions)
* [Projects
  28](/python/cpython/projects)
* [Security](/python/cpython/security)
* [Insights](/python/cpython/pulse)

Additional navigation options

* [Code](/python/cpython)
* [Issues](/python/cpython/issues)
* [Pull requests](/python/cpython/pulls)
* [Actions](/python/cpython/actions)
* [Projects](/python/cpython/projects)
* [Security](/python/cpython/security)
* [Insights](/python/cpython/pulse)

## Commit

[Permalink](/python/cpython/commit/22adf29da8d99933ffed8647d3e0726edd16f7f8)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

[3.9] [gh-113171](https://github.com/python/cpython/issues/113171): [gh-65056](https://github.com/python/cpython/issues/65056): Fix "private" (non-global) IP address rang…

[Browse files](/python/cpython/tree/22adf29da8d99933ffed8647d3e0726edd16f7f8)
Browse the repository at this point in the history

```
…es ([GH-113179](https://github.com/python/cpython/pull/113179)) ([GH-113186](https://github.com/python/cpython/pull/113186)) ([GH-118177](https://github.com/python/cpython/pull/118177)) ([GH-118472](https://github.com/python/cpython/pull/118472))

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] [#61602](https://github.com/python/cpython/issues/61602)

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 ("This network") and the other in
255.255.255.255/32 ("Limited broadcast").

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
```

* Loading branch information

[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&v=4)](/encukou) [![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak)

[encukou](/python/cpython/commits?author=encukou "View all commits by encukou")
and
[jstasiak](/python/cpython/commits?author=jstasiak "View all commits by jstasiak")
authored
May 7, 2024

1 parent
[7db40cd](/python/cpython/commit/7db40cd3a9b7b197c0f69179246f3bbe9de72372)

commit 22adf29

 Show file tree

 Hide file tree

Showing
**6 changed files**
with
**195 additions**
and
**21 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* Doc

  + library

    - Doc/library/ipaddress.rst
      [ipaddress.rst](#diff-d9c61a8ece8cc31330309c90fc34330e1c21bc615ad0941aac8ca6af36f99568)
  + tools

    - Doc/tools/susp-ignored.csv
      [susp-ignored.csv](#diff-f2d07d8e818b46b42f9fff17a09058c554e8cb6baa7fbfbdf77b266c97155f4e)
  + whatsnew

    - Doc/whatsnew/3.9.rst
      [3.9.rst](#diff-ec874d66bbcf13046b9928aa3716d14a93632f568b914eba32baf46ff4c9eb36)
* Lib

  + Lib/ipaddress.py
    [ipaddress.py](#diff-f67a8b5be6bdc48383d2ab907325a4c75ef998fa7cd0bba382ec2efa7e4f00b5)
  + test

    - Lib/test/test\_ipaddress.py
      [test\_ipaddress.py](#diff-75d091371807896a8a66871de0fae89ad932066b2c4b73f9278e549ef25826c7)
* Misc/NEWS.d/next/Library

  + Misc/NEWS.d/next/Library/2024-03-14-01-38-44.gh-issue-113171.VFnObz.rst
    [2024-03-14-01-38-44.gh-issue-113171.VFnObz.rst](#diff-2d6ca0985b215bccb49c607530d008bc3014490e8ac3d6b3e51f32aa94f2c1d7)

## There are no files selected for viewing

43 changes: 39 additions & 4 deletions

43
[Doc/library/ipaddress.rst](#diff-d9c61a8ece8cc31330309c90fc34330e1c21bc615ad0941aac8ca6af36f99568 "Doc/library/ipaddress.rst")

Show comments

[View file](/python/cpython/blob/22adf29da8d99933ffed8647d3e0726edd16f7f8/Doc/library/ipaddress.rst)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -188,18 +188,53 @@ write code that handles both IP versions correctly. Address objects are |
|  |  |  |
|  |  | .. attribute:: is\_private |
|  |  |  |
|  |  | ``True`` if the address is allocated for private networks. See |
|  |  | ``True`` if the address is defined as not globally reachable by |
|  |  | iana-ipv4-special-registry\_ (for IPv4) or iana-ipv6-special-registry\_ |
|  |  | (for IPv6). |
|  |  | (for IPv6) with the following exceptions: |
|  |  |  |
|  |  | \* ``is\_private`` is ``False`` for the shared address space (``100.64.0.0/10``) |
|  |  | \* For IPv4-mapped IPv6-addresses the ``is\_private`` value is determined by the |
|  |  | semantics of the underlying IPv4 addresses and the following condition holds |
|  |  | (see :attr:`IPv6Address.ipv4\_mapped`):: |
|  |  |  |
|  |  | address.is\_private == address.ipv4\_mapped.is\_private |
|  |  |  |
|  |  | ``is\_private`` has value opposite to :attr:`is\_global`, except for the shared address space |
|  |  | (``100.64.0.0/10`` range) where they are both ``False``. |
|  |  |  |
|  |  | .. versionchanged:: 3.9.20 |
|  |  |  |
|  |  | Fixed some false positives and false negatives. |
|  |  |  |
|  |  | \* ``192.0.0.0/24`` is considered private with the exception of ``192.0.0.9/32`` and |
|  |  | ``192.0.0.10/32`` (previously: only the ``192.0.0.0/29`` sub-range was considered private). |
|  |  | \* ``64:ff9b:1::/48`` is considered private. |
|  |  | \* ``2002::/16`` is considered private. |
|  |  | \* There are exceptions within ``2001::/23`` (otherwise considered private): ``2001:1::1/128``, |
|  |  | ``2001:1::2/128``, ``2001:3::/32``, ``2001:4:112::/48``, ``2001:20::/28``, ``2001:30::/28``. |
|  |  | The exceptions are not considered private. |
|  |  |  |
|  |  | .. attribute:: is\_global |
|  |  |  |
|  |  | ``True`` if the address is allocated for public networks. See |
|  |  | ``True`` if the address is defined as globally reachable by |
|  |  | iana-ipv4-special-registry\_ (for IPv4) or iana-ipv6-special-registry\_ |
|  |  | (for IPv6). |
|  |  | (for IPv6) with the following exception: |
|  |  |  |
|  |  | For IPv4-mapped IPv6-addresses the ``is\_private`` value is determined by the |
|  |  | semantics of the underlying IPv4 addresses and the following condition holds |
|  |  | (see :attr:`IPv6Address.ipv4\_mapped`):: |
|  |  |  |
|  |  | address.is\_global == address.ipv4\_mapped.is\_global |
|  |  |  |
|  |  | ``is\_global`` has value opposite to :attr:`is\_private`, except for the shared address space |
|  |  | (``100.64.0.0/10`` range) where they are both ``False``. |
|  |  |  |
|  |  | .. versionadded:: 3.4 |
|  |  |  |
|  |  | .. versionchanged:: 3.9.20 |
|  |  |  |
|  |  | Fixed some false positives and false negatives, see :attr:`is\_private` for details. |
|  |  |  |
|  |  | .. attribute:: is\_unspecified |
|  |  |  |
|  |  | ``True`` if the address is unspecified. See :RFC:`5735` (for IPv4) |
| Expand Down | |  |

8 changes: 8 additions & 0 deletions

8
[Doc/tools/susp-ignored.csv](#diff-f2d07d8e818b46b42f9fff17a09058c554e8cb6baa7fbfbdf77b266c97155f4e "Doc/tools/susp-ignored.csv")

Show comments

[View file](/python/cpython/blob/22adf29da8d99933ffed8647d3e0726edd16f7f8/Doc/tools/susp-ignored.csv)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -169,6 +169,14 @@ library/ipaddress,,:db00,2001:db00::0/24 |
|  |  | library/ipaddress,,::,2001:db00::0/24 |
|  |  | library/ipaddress,,:db00,2001:db00::0/ffff:ff00:: |
|  |  | library/ipaddress,,::,2001:db00::0/ffff:ff00:: |
|  |  | library/ipaddress,,:ff9b,64:ff9b:1::/48 |
|  |  | library/ipaddress,,::,64:ff9b:1::/48 |
|  |  | library/ipaddress,,::,2001:: |
|  |  | library/ipaddress,,::,2001:1:: |
|  |  | library/ipaddress,,::,2001:3:: |
|  |  | library/ipaddress,,::,2001:4:112:: |
|  |  | library/ipaddress,,::,2001:20:: |
|  |  | library/ipaddress,,::,2001:30:: |
|  |  | library/itertools,,:step,elements from seq[start:stop:step] |
|  |  | library/itertools,,:stop,elements from seq[start:stop:step] |
|  |  | library/itertools,,::,kernel = tuple(kernel)[::-1] |
| Expand Down | |  |

9 changes: 9 additions & 0 deletions

9
[Doc/whatsnew/3.9.rst](#diff-ec874d66bbcf13046b9928aa3716d14a93632f568b914eba32baf46ff4c9eb36 "Doc/whatsnew/3.9.rst")

Show comments

[View file](/python/cpython/blob/22adf29da8d99933ffed8647d3e0726edd16f7f8/Doc/whatsnew/3.9.rst)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -1616,3 +1616,12 @@ tarfile |
|  |  | :exc:`DeprecationWarning`. |
|  |  | In Python 3.14, the default will switch to ``'data'``. |
|  |  | (Contributed by Petr Viktorin in :pep:`706`.) |
|  |  |  |
|  |  | Notable changes in 3.9.20 |
|  |  | ========================= |
|  |  |  |
|  |  | ipaddress |
|  |  | --------- |
|  |  |  |
|  |  | \* Fixed ``is\_global`` and ``is\_private`` behavior in ``IPv4Address``, |
|  |  | ``IPv6Address``, ``IPv4Network`` and ``IPv6Network``. |

95 changes: 78 additions & 17 deletions

95
[Lib/ipaddress.py](#diff-f67a8b5be6bdc48383d2ab907325a4c75ef998fa7cd0bba382ec2efa7e4f00b5 "Lib/ipaddress.py")

Show comments

[View file](/python/cpython/blob/22adf29da8d99933ffed8647d3e0726edd16f7f8/Lib/ipaddress.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1322,18 +1322,41 @@ def is\_reserved(self): |
|  |  | @property |
|  |  | @functools.lru\_cache() |
|  |  | def is\_private(self): |
|  |  | """Test if this address is allocated for private networks. |
|  |  | """``True`` if the address is defined as not globally reachable by |
|  |  | iana-ipv4-special-registry\_ (for IPv4) or iana-ipv6-special-registry\_ |
|  |  | (for IPv6) with the following exceptions: |
|  |  |  |
|  |  | Returns: |
|  |  | A boolean, True if the address is reserved per |
|  |  | iana-ipv4-special-registry. |
|  |  | \* ``is\_private`` is ``False`` for ``100.64.0.0/10`` |
|  |  | \* For IPv4-mapped IPv6-addresses the ``is\_private`` value is determined by the |
|  |  | semantics of the underlying IPv4 addresses and the following condition holds |
|  |  | (see :attr:`IPv6Address.ipv4\_mapped`):: |
|  |  |  |
|  |  | address.is\_private == address.ipv4\_mapped.is\_private |
|  |  |  |
|  |  | ``is\_private`` has value opposite to :attr:`is\_global`, except for the ``100.64.0.0/10`` |
|  |  | IPv4 range where they are both ``False``. |
|  |  | """ |
|  |  | return any(self in net for net in self.\_constants.\_private\_networks) |
|  |  | return ( |
|  |  | any(self in net for net in self.\_constants.\_private\_networks) |
|  |  | and all(self not in net for net in self.\_constants.\_private\_networks\_exceptions) |
|  |  | ) |
|  |  |  |
|  |  | @property |
|  |  | @functools.lru\_cache() |
|  |  | def is\_global(self): |
|  |  | """``True`` if the address is defined as globally reachable by |
|  |  | iana-ipv4-special-registry\_ (for IPv4) or iana-ipv6-special-registry\_ |
|  |  | (for IPv6) with the following exception: |
|  |  |  |
|  |  | For IPv4-mapped IPv6-addresses the ``is\_private`` value is determined by the |
|  |  | semantics of the underlying IPv4 addresses and the following condition holds |
|  |  | (see :attr:`IPv6Address.ipv4\_mapped`):: |
|  |  |  |
|  |  | address.is\_global == address.ipv4\_mapped.is\_global |
|  |  |  |
|  |  | ``is\_global`` has value opposite to :attr:`is\_private`, except for the ``100.64.0.0/10`` |
|  |  | IPv4 range where they are both ``False``. |
|  |  | """ |
|  |  | return self not in self.\_constants.\_public\_network and not self.is\_private |
|  |  |  |
|  |  | @property |
| Expand Down  Expand Up | | @@ -1537,13 +1560,15 @@ class \_IPv4Constants: |
|  |  |  |
|  |  | \_public\_network = IPv4Network('100.64.0.0/10') |
|  |  |  |
|  |  | # Not globally reachable address blocks listed on |
|  |  | # https://www.iana.org/assignments/iana-ipv4-special-registry/iana-ipv4-special-registry.xhtml |
|  |  | \_private\_networks = [ |
|  |  | IPv4Network('0.0.0.0/8'), |
|  |  | IPv4Network('10.0.0.0/8'), |
|  |  | IPv4Network('127.0.0.0/8'), |
|  |  | IPv4Network('169.254.0.0/16'), |
|  |  | IPv4Network('172.16.0.0/12'), |
|  |  | IPv4Network('192.0.0.0/29'), |
|  |  | IPv4Network('192.0.0.0/24'), |
|  |  | IPv4Network('192.0.0.170/31'), |
|  |  | IPv4Network('192.0.2.0/24'), |
|  |  | IPv4Network('192.168.0.0/16'), |
| Expand All | | @@ -1554,6 +1579,11 @@ class \_IPv4Constants: |
|  |  | IPv4Network('255.255.255.255/32'), |
|  |  | ] |
|  |  |  |
|  |  | \_private\_networks\_exceptions = [ |
|  |  | IPv4Network('192.0.0.9/32'), |
|  |  | IPv4Network('192.0.0.10/32'), |
|  |  | ] |
|  |  |  |
|  |  | \_reserved\_network = IPv4Network('240.0.0.0/4') |
|  |  |  |
|  |  | \_unspecified\_address = IPv4Address('0.0.0.0') |
| Expand Down  Expand Up | | @@ -1995,23 +2025,42 @@ def is\_site\_local(self): |
|  |  | @property |
|  |  | @functools.lru\_cache() |
|  |  | def is\_private(self): |
|  |  | """Test if this address is allocated for private networks. |
|  |  | """``True`` if the address is defined as not globally reachable by |
|  |  | iana-ipv4-special-registry\_ (for IPv4) or iana-ipv6-special-registry\_ |
|  |  | (for IPv6) with the following exceptions: |
|  |  |  |
|  |  | Returns: |
|  |  | A boolean, True if the address is reserved per |
|  |  | iana-ipv6-special-registry. |
|  |  | \* ``is\_private`` is ``False`` for ``100.64.0.0/10`` |
|  |  | \* For IPv4-mapped IPv6-addresses the ``is\_private`` value is determined by the |
|  |  | semantics of the underlying IPv4 addresses and the following condition holds |
|  |  | (see :attr:`IPv6Address.ipv4\_mapped`):: |
|  |  |  |
|  |  | address.is\_private == address.ipv4\_mapped.is\_private |
|  |  |  |
|  |  | ``is\_private`` has value opposite to :attr:`is\_global`, except for the ``100.64.0.0/10`` |
|  |  | IPv4 range where they are both ``False``. |
|  |  | """ |
|  |  | return any(self in net for net in self.\_constants.\_private\_networks) |
|  |  | ipv4\_mapped = self.ipv4\_mapped |
|  |  | if ipv4\_mapped is not None: |
|  |  | return ipv4\_mapped.is\_private |
|  |  | return ( |
|  |  | any(self in net for net in self.\_constants.\_private\_networks) |
|  |  | and all(self not in net for net in self.\_constants.\_private\_networks\_exceptions) |
|  |  | ) |
|  |  |  |
|  |  | @property |
|  |  | def is\_global(self): |
|  |  | """Test if this address is allocated for public networks. |
|  |  | """``True`` if the address is defined as globally reachable by |
|  |  | iana-ipv4-special-registry\_ (for IPv4) or iana-ipv6-special-registry\_ |
|  |  | (for IPv6) with the following exception: |
|  |  |  |
|  |  | Returns: |
|  |  | A boolean, true if the address is not reserved per |
|  |  | iana-ipv6-special-registry. |
|  |  | For IPv4-mapped IPv6-addresses the ``is\_private`` value is determined by the |
|  |  | semantics of the underlying IPv4 addresses and the following condition holds |
|  |  | (see :attr:`IPv6Address.ipv4\_mapped`):: |
|  |  |  |
|  |  | address.is\_global == address.ipv4\_mapped.is\_global |
|  |  |  |
|  |  | ``is\_global`` has value opposite to :attr:`is\_private`, except for the ``100.64.0.0/10`` |
|  |  | IPv4 range where they are both ``False``. |
|  |  | """ |
|  |  | return not self.is\_private |
|  |  |  |
| Expand Down  Expand Up | | @@ -2252,19 +2301,31 @@ class \_IPv6Constants: |
|  |  |  |
|  |  | \_multicast\_network = IPv6Network('ff00::/8') |
|  |  |  |
|  |  | # Not globally reachable address blocks listed on |
|  |  | # https://www.iana.org/assignments/iana-ipv6-special-registry/iana-ipv6-special-registry.xhtml |
|  |  | \_private\_networks = [ |
|  |  | IPv6Network('::1/128'), |
|  |  | IPv6Network('::/128'), |
|  |  | IPv6Network('::ffff:0:0/96'), |
|  |  | IPv6Network('64:ff9b:1::/48'), |
|  |  | IPv6Network('100::/64'), |
|  |  | IPv6Network('2001::/23'), |
|  |  | IPv6Network('2001:2::/48'), |
|  |  | IPv6Network('2001:db8::/32'), |
|  |  | IPv6Network('2001:10::/28'), |
|  |  | # IANA says N/A, let's consider it not globally reachable to be safe |
|  |  | IPv6Network('2002::/16'), |
|  |  | IPv6Network('fc00::/7'), |
|  |  | IPv6Network('fe80::/10'), |
|  |  | ] |
|  |  |  |
|  |  | \_private\_networks\_exceptions = [ |
|  |  | IPv6Network('2001:1::1/128'), |
|  |  | IPv6Network('2001:1::2/128'), |
|  |  | IPv6Network('2001:3::/32'), |
|  |  | IPv6Network('2001:4:112::/48'), |
|  |  | IPv6Network('2001:20::/28'), |
|  |  | IPv6Network('2001:30::/28'), |
|  |  | ] |
|  |  |  |
|  |  | \_reserved\_networks = [ |
|  |  | IPv6Network('::/8'), IPv6Network('100::/8'), |
|  |  | IPv6Network('200::/7'), IPv6Network('400::/6'), |
| Expand Down | |  |

52 changes: 52 additions & 0 deletions

52
[Lib/test/test\_ipaddress.py](#diff-75d091371807896a8a66871de0fae89ad932066b2c4b73f9278e549ef25826c7 "Lib/test/test_ipaddress.py")

Show comments

[View file](/python/cpython/blob/22adf29da8d99933ffed8647d3e0726edd16f7f8/Lib/test/test_ipaddress.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2263,6 +2263,10 @@ def testReservedIpv4(self): |
|  |  | self.assertEqual(True, ipaddress.ip\_address( |
|  |  | '172.31.255.255').is\_private) |
|  |  | self.assertEqual(False, ipaddress.ip\_address('172.32.0.0').is\_private) |
|  |  | self.assertFalse(ipaddress.ip\_address('192.0.0.0').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('192.0.0.9').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('192.0.0.10').is\_global) |
|  |  | self.assertFalse(ipaddress.ip\_address('192.0.0.255').is\_global) |
|  |  |  |
|  |  | self.assertEqual(True, |
|  |  | ipaddress.ip\_address('169.254.100.200').is\_link\_local) |
| Expand All | | @@ -2278,6 +2282,40 @@ def testReservedIpv4(self): |
|  |  | self.assertEqual(False, ipaddress.ip\_address('128.0.0.0').is\_loopback) |
|  |  | self.assertEqual(True, ipaddress.ip\_network('0.0.0.0').is\_unspecified) |
|  |  |  |
|  |  | def testPrivateNetworks(self): |
|  |  | self.assertEqual(True, ipaddress.ip\_network("0.0.0.0/0").is\_private) |
|  |  | self.assertEqual(False, ipaddress.ip\_network("1.0.0.0/8").is\_private) |
|  |  |  |
|  |  | self.assertEqual(True, ipaddress.ip\_network("0.0.0.0/8").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("10.0.0.0/8").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("127.0.0.0/8").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("169.254.0.0/16").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("172.16.0.0/12").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("192.0.0.0/29").is\_private) |
|  |  | self.assertEqual(False, ipaddress.ip\_network("192.0.0.9/32").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("192.0.0.170/31").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("192.0.2.0/24").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("192.168.0.0/16").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("198.18.0.0/15").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("198.51.100.0/24").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("203.0.113.0/24").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("240.0.0.0/4").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("255.255.255.255/32").is\_private) |
|  |  |  |
|  |  | self.assertEqual(False, ipaddress.ip\_network("::/0").is\_private) |
|  |  | self.assertEqual(False, ipaddress.ip\_network("::ff/128").is\_private) |
|  |  |  |
|  |  | self.assertEqual(True, ipaddress.ip\_network("::1/128").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("::/128").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("::ffff:0:0/96").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("100::/64").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("2001:2::/48").is\_private) |
|  |  | self.assertEqual(False, ipaddress.ip\_network("2001:3::/48").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("2001:db8::/32").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("2001:10::/28").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("fc00::/7").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("fe80::/10").is\_private) |
|  |  |  |
|  |  | def testReservedIpv6(self): |
|  |  |  |
|  |  | self.assertEqual(True, ipaddress.ip\_network('ffff::').is\_multicast) |
| Expand Down  Expand Up | | @@ -2351,6 +2389,20 @@ def testReservedIpv6(self): |
|  |  | self.assertEqual(True, ipaddress.ip\_address('0::0').is\_unspecified) |
|  |  | self.assertEqual(False, ipaddress.ip\_address('::1').is\_unspecified) |
|  |  |  |
|  |  | self.assertFalse(ipaddress.ip\_address('64:ff9b:1::').is\_global) |
|  |  | self.assertFalse(ipaddress.ip\_address('2001::').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('2001:1::1').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('2001:1::2').is\_global) |
|  |  | self.assertFalse(ipaddress.ip\_address('2001:2::').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('2001:3::').is\_global) |
|  |  | self.assertFalse(ipaddress.ip\_address('2001:4::').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('2001:4:112::').is\_global) |
|  |  | self.assertFalse(ipaddress.ip\_address('2001:10::').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('2001:20::').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('2001:30::').is\_global) |
|  |  | self.assertFalse(ipaddress.ip\_address('2001:40::').is\_global) |
|  |  | self.assertFalse(ipaddress.ip\_address('2002::').is\_global) |
|  |  |  |
|  |  | # some generic IETF reserved addresses |
|  |  | self.assertEqual(True, ipaddress.ip\_address('100::').is\_reserved) |
|  |  | self.assertEqual(True, ipaddress.ip\_network('4000::1/128').is\_reserved) |
| Expand Down | |  |

9 changes: 9 additions & 0 deletions

9
[Misc/NEWS.d/next/Library/2024-03-14-01-38-44.gh-issue-113171.VFnObz.rst](#diff-2d6ca0985b215bccb49c607530d008bc3014490e8ac3d6b3e51f32aa94f2c1d7 "Misc/NEWS.d/next/Library/2024-03-14-01-38-44.gh-issue-113171.VFnObz.rst")

Show comments

[View file](/python/cpython/blob/22adf29da8d99933ffed8647d3e0726edd16f7f8/Misc/NEWS.d/next/Library/2024-03-14-01-38-44.gh-issue-113171.VFnObz.rst)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -0,0 +1,9 @@ |
|  |  | Fixed various false positives and false negatives in |
|  |  |  |
|  |  | \* :attr:`ipaddress.IPv4Address.is\_private` (see these docs for details) |
|  |  | \* :attr:`ipaddress.IPv4Address.is\_global` |
|  |  | \* :attr:`ipaddress.IPv6Address.is\_private` |
|  |  | \* :attr:`ipaddress.IPv6Address.is\_global` |
|  |  |  |
|  |  | Also in the corresponding :class:`ipaddress.IPv4Network` and :class:`ipaddress.IPv6Network` |
|  |  | attributes. |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `22adf29`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpython%2Fcpython%2Fcommit%2F22adf29da8d99933ffed8647d3e0726edd16f7f8) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.iana.org_779ac590_20250110_175747.html ===

[![Internet Assigned Numbers Authority](https://www.iana.org/_img/2022/iana-logo-header.svg)](/)

# IANA IPv4 Special-Purpose Address Registry

Created
2009-08-19
Last Updated
2021-02-04
Available Formats
[![](/_img/icons/text-xml.png)
XML](iana-ipv4-special-registry.xml)
[![](/_img/icons/text-html.png)
HTML](iana-ipv4-special-registry.xhtml)
[![](/_img/icons/text-plain.png)
Plain text](iana-ipv4-special-registry.txt)

**Registry included below**

* [IANA IPv4 Special-Purpose Address Registry](#iana-ipv4-special-registry-1)

## IANA IPv4 Special-Purpose Address Registry

Registration Procedure(s)
```
IETF Review
```

Reference
[[RFC5736](https://www.iana.org/go/rfc5736)][[RFC6890](https://www.iana.org/go/rfc6890)][[RFC Errata 6404](http://www.rfc-editor.org/errata_search.php?eid=6404)][[RFC8190](https://www.iana.org/go/rfc8190)]
Note
```
The IETF has reserved the address block of 192.0.0.0/24 for use for
special purposes relating to protocol assignments. This registry
contains the current assignments made by the IETF from this address
block.

Address prefixes listed in the Special-Purpose Address Registry are
not guaranteed routability in any particular local or global context.

The IPv4 and IPv6 Special-Purpose Address Registries maintain the
following information regarding each entry:

   o  Address Block - A block of IPv4 or IPv6 addresses that has been
      registered for a special purpose.

   o  Name - A descriptive name for the special-purpose address block.

   o  RFC - The RFC through which the special-purpose address block was
      requested.

   o  Allocation Date - The date upon which the special-purpose address
      block was allocated.

   o  Termination Date - The date upon which the allocation is to be
      terminated.  This field is applicable for limited-use allocations
      only.

   o  Source - A boolean value indicating whether an address from the
      allocated special-purpose address block is valid when used as the
      source address of an IP datagram that transits two devices.

   o  Destination - A boolean value indicating whether an address from
      the allocated special-purpose address block is valid when used as
      the destination address of an IP datagram that transits two
      devices.

   o  Forwardable - A boolean value indicating whether a router may
      forward an IP datagram whose destination address is drawn from the
      allocated special-purpose address block between external
      interfaces.

   o  Globally Reachable - A boolean value indicating whether an IP
      datagram whose destination address is drawn from the allocated
      special-purpose address block is forwardable beyond a specified
      administrative domain.

   o  Reserved-by-Protocol - A boolean value indicating whether the
      special-purpose address block is reserved by IP, itself.  This
      value is "TRUE" if the RFC that created the special-purpose
      address block requires all compliant IP implementations to behave
      in a special way when processing packets either to or from
      addresses contained by the address block.

   If the value of "Destination" is FALSE, the values of "Forwardable"
   and "Globally Reachable" must also be false.

```

Available Formats
[![](/_img/icons/text-csv.png)
CSV](iana-ipv4-special-registry-1.csv)

| Address Block | Name | RFC | Allocation Date | Termination Date | Source | Destination | Forwardable | Globally Reachable | Reserved-by-Protocol |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 0.0.0.0/8 | "This network" | [[RFC791](https://www.iana.org/go/rfc791)], Section 3.2 | 1981-09 | N/A | True | False | False | False | True |
| 0.0.0.0/32 | "This host on this network" | [[RFC1122](https://www.iana.org/go/rfc1122)], Section 3.2.1.3 | 1981-09 | N/A | True | False | False | False | True |
| 10.0.0.0/8 | Private-Use | [[RFC1918](https://www.iana.org/go/rfc1918)] | 1996-02 | N/A | True | True | True | False | False |
| 100.64.0.0/10 | Shared Address Space | [[RFC6598](https://www.iana.org/go/rfc6598)] | 2012-04 | N/A | True | True | True | False | False |
| 127.0.0.0/8 | Loopback | [[RFC1122](https://www.iana.org/go/rfc1122)], Section 3.2.1.3 | 1981-09 | N/A | False [[1](#note1)] | False [[1](#note1)] | False [[1](#note1)] | False [[1](#note1)] | True |
| 169.254.0.0/16 | Link Local | [[RFC3927](https://www.iana.org/go/rfc3927)] | 2005-05 | N/A | True | True | False | False | True |
| 172.16.0.0/12 | Private-Use | [[RFC1918](https://www.iana.org/go/rfc1918)] | 1996-02 | N/A | True | True | True | False | False |
| 192.0.0.0/24 [[2](#note2)] | IETF Protocol Assignments | [[RFC6890](https://www.iana.org/go/rfc6890)], Section 2.1 | 2010-01 | N/A | False | False | False | False | False |
| 192.0.0.0/29 | IPv4 Service Continuity Prefix | [[RFC7335](https://www.iana.org/go/rfc7335)] | 2011-06 | N/A | True | True | True | False | False |
| 192.0.0.8/32 | IPv4 dummy address | [[RFC7600](https://www.iana.org/go/rfc7600)] | 2015-03 | N/A | True | False | False | False | False |
| 192.0.0.9/32 | Port Control Protocol Anycast | [[RFC7723](https://www.iana.org/go/rfc7723)] | 2015-10 | N/A | True | True | True | True | False |
| 192.0.0.10/32 | Traversal Using Relays around NAT Anycast | [[RFC8155](https://www.iana.org/go/rfc8155)] | 2017-02 | N/A | True | True | True | True | False |
| 192.0.0.170/32, 192.0.0.171/32 | NAT64/DNS64 Discovery | [[RFC8880](https://www.iana.org/go/rfc8880)][[RFC7050](https://www.iana.org/go/rfc7050)], Section 2.2 | 2013-02 | N/A | False | False | False | False | True |
| 192.0.2.0/24 | Documentation (TEST-NET-1) | [[RFC5737](https://www.iana.org/go/rfc5737)] | 2010-01 | N/A | False | False | False | False | False |
| 192.31.196.0/24 | AS112-v4 | [[RFC7535](https://www.iana.org/go/rfc7535)] | 2014-12 | N/A | True | True | True | True | False |
| 192.52.193.0/24 | AMT | [[RFC7450](https://www.iana.org/go/rfc7450)] | 2014-12 | N/A | True | True | True | True | False |
| 192.88.99.0/24 | Deprecated (6to4 Relay Anycast) | [[RFC7526](https://www.iana.org/go/rfc7526)] | 2001-06 | 2015-03 |  |  |  |  |  |
| 192.168.0.0/16 | Private-Use | [[RFC1918](https://www.iana.org/go/rfc1918)] | 1996-02 | N/A | True | True | True | False | False |
| 192.175.48.0/24 | Direct Delegation AS112 Service | [[RFC7534](https://www.iana.org/go/rfc7534)] | 1996-01 | N/A | True | True | True | True | False |
| 198.18.0.0/15 | Benchmarking | [[RFC2544](https://www.iana.org/go/rfc2544)] | 1999-03 | N/A | True | True | True | False | False |
| 198.51.100.0/24 | Documentation (TEST-NET-2) | [[RFC5737](https://www.iana.org/go/rfc5737)] | 2010-01 | N/A | False | False | False | False | False |
| 203.0.113.0/24 | Documentation (TEST-NET-3) | [[RFC5737](https://www.iana.org/go/rfc5737)] | 2010-01 | N/A | False | False | False | False | False |
| 240.0.0.0/4 | Reserved | [[RFC1112](https://www.iana.org/go/rfc1112)], Section 4 | 1989-08 | N/A | False | False | False | False | True |
| 255.255.255.255/32 | Limited Broadcast | [[RFC8190](https://www.iana.org/go/rfc8190)] [[RFC919](https://www.iana.org/go/rfc919)], Section 7 | 1984-10 | N/A | False | True | False | False | True |

# Footnotes

| [1] | ``` Several protocols have been granted exceptions to this rule.  For examples, see [[RFC8029](https://www.iana.org/go/rfc8029)] and [[RFC5884](https://www.iana.org/go/rfc5884)]. ``` |
| --- | --- |
| [2] | ``` Not useable unless by virtue of a more specific reservation. ``` |

[Licensing Terms](https://www.iana.org/help/licensing-terms)



=== Content from security.netapp.com_d15d1357_20250110_175746.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
æ¥æ¬èª

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [CVE-2024-4032 Python Vulnerability in NetApp Products](https://security.netapp.com/advisory/ntap-20240726-0004)

## CVE-2024-4032 Python Vulnerability in NetApp Products

circle-info

NetApp will continue to update this advisory as additional information becomes available.

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close ×

#### Subscribe to NTAP-20240726-0004 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20240726-0004 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close ×

#### Unsubscribe from NTAP-20240726-0004 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20240726-0004 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20240726-0004
**Version:**
7.0

**Last updated:**
12/13/2024

**Status:**
Interim.

**CVEs:** CVE-2024-4032

Overview
#### Summary

Multiple NetApp products incorporate Python. Certain versions of Python (CPython) are susceptible to a vulnerability which when successfully exploited could lead to disclosure of sensitive information.

#### Impact

Successful exploitation of this vulnerability could lead to disclosure of sensitive information.

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2024-4032](https://nvd.nist.gov/vuln/detail/CVE-2024-4032) | 7.5 (HIGH) | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

#### References

* <https://github.com/advisories/GHSA-mh6q-v4mp-2cc7>

Affected Products
#### Affected Products

* Active IQ Unified Manager for Microsoft Windows
* Active IQ Unified Manager for VMware vSphere
* Management Services for Element Software and NetApp HCI
* ONTAP 9
* ONTAP tools for VMware vSphere 10

#### Products Under Investigation

* NetApp HCI Compute Node (Bootstrap OS)
* NetApp SolidFire & HCI Storage Node (Element Software)
* NetApp XCP NFS
* NetApp XCP SMB

#### Products Not Affected

* AFF BIOS - A1K/A70/A90
* AFF BIOS - A700s
* AFF Baseboard Management Controller (BMC) - A1K/A70/A90
* AFF Baseboard Management Controller (BMC) - A700s
* AFF LOADER- A1K/A70/A90
* ATTO FibreBridge - 7600N
* Active IQ Unified Manager for Linux
* Active IQ mobile app
* Astra Control Center
* Astra Control Center - NetApp Kubernetes Monitoring Operator
* Astra Control Provisioner
* Astra Trident
* Astra Trident Autosupport
* BlueXP Classification
* Brocade Fabric Operating System Firmware
* Brocade SAN Navigator (SANnav)
* Cloud Volumes ONTAP Mediator
* Data Infrastructure Insights Acquisition Unit (formerly Cloud Insights Acquisition Unit)
* Data Infrastructure Insights Storage Workload Security Agent (formerly Cloud Insights Storage Workload Security Agent)
* Data Infrastructure Insights Telegraf Agent (formerly Cloud Insights Telegraf Agent)
* E-Series BIOS
* E-Series SANtricity OS Controller Software 11.x
* E-Series SANtricity Unified Manager and Web Services Proxy
* Element .NET SDK
* Element HealthTools
* Element JAVA SDK
* Element Plug-in for vCenter Server
* Element Powershell Tools
* Element Python SDK
* FAS/AFF BIOS - 2820
* FAS/AFF BIOS - 8300/8700/A400/C400
* FAS/AFF BIOS - A250/500f/C250
* FAS/AFF BIOS - A300/8200/C190/A220/2720/2750/A150
* FAS/AFF BIOS - A320
* FAS/AFF BIOS - A700/9000
* FAS/AFF BIOS - A800/C800
* FAS/AFF BIOS - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400/C400
* FAS/AFF Baseboard Management Controller (BMC) - A250/500f/C250
* FAS/AFF Baseboard Management Controller (BMC) - A320
* FAS/AFF Baseboard Management Controller (BMC) - A800/C800
* FAS/AFF Baseboard Management Controller (BMC) - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - C190/A150/A220/FAS2720/FAS2750
* FAS/AFF Baseboard Management Controller (BMC) - FAS2820
* FAS/AFF Service Processor - A300/8200
* FAS/AFF Service Processor - A700/9000
* Global File Cache
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* IOM12 SAS Disk Shelf Firmware
* IOM12B SAS Disk Shelf Firmware
* IOM12E SAS Disk Shelf Firmware
* IOM12F SAS Disk Shelf Firmware
* IOM12G SAS Disk Shelf Firmware
* IOM6 SAS Disk Shelf Firmware
* IOM6E SAS Disk Shelf Firmware
* MetroCluster DataCollector
* MetroCluster Tiebreaker
* Multipath I/O (SANtricity DSM for Windows MPIO)
* NetApp BlueXP
* NetApp Converged Systems Advisor Agent
* NetApp DataOps Toolkit
* NetApp E-Series Host Collection
* NetApp E-Series SANtricity Collection
* NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S
* NetApp HCI Baseboard Management Controller (BMC) - H410C
* NetApp HCI Baseboard Management Controller (BMC) - H610C
* NetApp HCI Baseboard Management Controller (BMC) - H610S
* NetApp HCI Baseboard Management Controller (BMC) - H615C
* NetApp HCI Compute Node BIOS
* NetApp HCI Storage Node BIOS
* NetApp Kubernetes Monitoring Operator
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp ONTAP PowerShell Toolkit (PSTK)
* NetApp SolidFire & HCI Management Node
* NetApp SolidFire Plug-in for vRealize Orchestrator (SolidFire vRO)
* ONTAP Antivirus Connector
* ONTAP Mediator
* ONTAP Select Deploy administration utility
* ONTAP tools for VMware vSphere 9
* OnCommand Insight
* OnCommand Workflow Automation
* RcfFileGenerator for MetroCluster IP
* SANtricity Storage Plugin for vCenter
* SRA Plugin for Linux
* SRA Plugin for Windows
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapCenter Plug-in for VMware vSphere/BlueXP backup and Recovery for Virtual Machine
* SnapGathers
* SnapManager for Hyper-V
* SolidFire Storage Replication Adapter
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID BIOS SG1000/SG100/SG1100/SG110
* StorageGRID BIOS SG5660/SG5612/SG5760/SG5712
* StorageGRID BIOS SG5812/SG5860
* StorageGRID BIOS SG6060/SGF6024/SGF6112/SG6160
* StorageGRID Baseboard Management Controller (BMC) - SG6060/SG6160/SGF6024/SGF6112/SG100/SG110/SG1000/SG1100
* StorageGRID Baseboard Management Controller (BMC) SG5812/SG5860
* System Manager 9.x
* Terraform Provider for ONTAP
* Workload Factory for VMware

Remediation
#### Software Versions and Fixes

NetApp's currently available patches are listed below.

| **Product** | **First Fixed in Release** |
| --- | --- |
| **Management Services for Element Software and NetApp HCI** | <https://mysupport.netapp.com/site/products/all/details/mgmtservices/downloads-tab/download/63086/2.26.30> |

#### Workarounds

None at this time.

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

**Technical Support**

Revision History
#### Status of This Notice

**Interim.**

NetApp will continue to update this advisory as additional information becomes available.

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20240726-0004>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20240726 | Initial Public Release |
| 2.0 | 20240801 | FAS/AFF Baseboard Management Controller (BMC) - A900/9500 moved to Products Not Affected |
| 3.0 | 20240814 | ONTAP Mediator moved to Products Not Affected |
| 4.0 | 20240920 | Active IQ Unified Manager for VMware vSphere moved to Affected Products |
| 5.0 | 20241024 | Active IQ Unified Manager for Microsoft Windows moved to Affected Products |
| 6.0 | 20241129 | Management Services for Element Software and NetApp HCI added to Software Versions and Fixes |
| 7.0 | 20241213 | ONTAP tools for VMware vSphere 10 moved to Affected Products |

This document is provided solely for informational purposes. All information is based upon NetAppâs current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. Â© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 ©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from github.com_de659fd9_20250110_175732.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpython%2Fcpython%2Fcommit%2F40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpython%2Fcpython%2Fcommit%2F40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=python%2Fcpython)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[python](/python)
/
**[cpython](/python/cpython)**
Public

* [Notifications](/login?return_to=%2Fpython%2Fcpython) You must be signed in to change notification settings
* [Fork
  30.8k](/login?return_to=%2Fpython%2Fcpython)
* [Star
   64.7k](/login?return_to=%2Fpython%2Fcpython)

* [Code](/python/cpython)
* [Issues
  5k+](/python/cpython/issues)
* [Pull requests
  1.8k](/python/cpython/pulls)
* [Actions](/python/cpython/actions)
* [Projects
  28](/python/cpython/projects)
* [Security](/python/cpython/security)
* [Insights](/python/cpython/pulse)

Additional navigation options

* [Code](/python/cpython)
* [Issues](/python/cpython/issues)
* [Pull requests](/python/cpython/pulls)
* [Actions](/python/cpython/actions)
* [Projects](/python/cpython/projects)
* [Security](/python/cpython/security)
* [Insights](/python/cpython/pulse)

## Commit

[Permalink](/python/cpython/commit/40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

[GH-113171](https://github.com/python/cpython/issues/113171): Fix "private" (non-global) IP address ranges ([GH-113179](https://github.com/python/cpython/pull/113179))

[Browse files](/python/cpython/tree/40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f)
Browse the repository at this point in the history

```
* [GH-113171](https://github.com/python/cpython/issues/113171): Fix "private" (really non-global) IP address ranges

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

I left 100.64.0.0/10 alone, for now, as it's been made special in [1]
and I'm not sure if we want to undo that as I don't quite understand the
motivation behind it.

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] [#61602](https://github.com/python/cpython/issues/61602)
```

* Loading branch information

[![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak)

[jstasiak](/python/cpython/commits?author=jstasiak "View all commits by jstasiak")
authored
Mar 22, 2024

1 parent
[3be9b9d](/python/cpython/commit/3be9b9d8722696b95555937bb211dc4cda714d56)

commit 40d75c2

 Show file tree

 Hide file tree

Showing
**5 changed files**
with
**82 additions**
and
**7 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* Doc

  + library

    - Doc/library/ipaddress.rst
      [ipaddress.rst](#diff-d9c61a8ece8cc31330309c90fc34330e1c21bc615ad0941aac8ca6af36f99568)
  + whatsnew

    - Doc/whatsnew/3.13.rst
      [3.13.rst](#diff-0eef04c1aae0cf8389945464f271ff6789259ef8985f5fdbb21c9a99c4b5021f)
* Lib

  + Lib/ipaddress.py
    [ipaddress.py](#diff-f67a8b5be6bdc48383d2ab907325a4c75ef998fa7cd0bba382ec2efa7e4f00b5)
  + test

    - Lib/test/test\_ipaddress.py
      [test\_ipaddress.py](#diff-75d091371807896a8a66871de0fae89ad932066b2c4b73f9278e549ef25826c7)
* Misc/NEWS.d/next/Library

  + Misc/NEWS.d/next/Library/2024-03-14-01-38-44.gh-issue-113171.VFnObz.rst
    [2024-03-14-01-38-44.gh-issue-113171.VFnObz.rst](#diff-2d6ca0985b215bccb49c607530d008bc3014490e8ac3d6b3e51f32aa94f2c1d7)

## There are no files selected for viewing

16 changes: 16 additions & 0 deletions

16
[Doc/library/ipaddress.rst](#diff-d9c61a8ece8cc31330309c90fc34330e1c21bc615ad0941aac8ca6af36f99568 "Doc/library/ipaddress.rst")

Show comments

[View file](/python/cpython/blob/40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f/Doc/library/ipaddress.rst)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -192,6 +192,18 @@ write code that handles both IP versions correctly. Address objects are |
|  |  | ``is\_private`` has value opposite to :attr:`is\_global`, except for the shared address space |
|  |  | (``100.64.0.0/10`` range) where they are both ``False``. |
|  |  |  |
|  |  | .. versionchanged:: 3.13 |
|  |  |  |
|  |  | Fixed some false positives and false negatives. |
|  |  |  |
|  |  | \* ``192.0.0.0/24`` is considered private with the exception of ``192.0.0.9/32`` and |
|  |  | ``192.0.0.10/32`` (previously: only the ``192.0.0.0/29`` sub-range was considered private). |
|  |  | \* ``64:ff9b:1::/48`` is considered private. |
|  |  | \* ``2002::/16`` is considered private. |
|  |  | \* There are exceptions within ``2001::/23`` (otherwise considered private): ``2001:1::1/128``, |
|  |  | ``2001:1::2/128``, ``2001:3::/32``, ``2001:4:112::/48``, ``2001:20::/28``, ``2001:30::/28``. |
|  |  | The exceptions are not considered private. |
|  |  |  |
|  |  | .. attribute:: is\_global |
|  |  |  |
|  |  | ``True`` if the address is defined as globally reachable by |
| Expand All | | @@ -209,6 +221,10 @@ write code that handles both IP versions correctly. Address objects are |
|  |  |  |
|  |  | .. versionadded:: 3.4 |
|  |  |  |
|  |  | .. versionchanged:: 3.13 |
|  |  |  |
|  |  | Fixed some false positives and false negatives, see :attr:`is\_private` for details. |
|  |  |  |
|  |  | .. attribute:: is\_unspecified |
|  |  |  |
|  |  | ``True`` if the address is unspecified. See :RFC:`5735` (for IPv4) |
| Expand Down | |  |

2 changes: 2 additions & 0 deletions

2
[Doc/whatsnew/3.13.rst](#diff-0eef04c1aae0cf8389945464f271ff6789259ef8985f5fdbb21c9a99c4b5021f "Doc/whatsnew/3.13.rst")

Show comments

[View file](/python/cpython/blob/40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f/Doc/whatsnew/3.13.rst)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -401,6 +401,8 @@ ipaddress |
|  |  |  |
|  |  | \* Add the :attr:`ipaddress.IPv4Address.ipv6\_mapped` property, which returns the IPv4-mapped IPv6 address. |
|  |  | (Contributed by Charles Machalow in :gh:`109466`.) |
|  |  | \* Fix ``is\_global`` and ``is\_private`` behavior in ``IPv4Address``, ``IPv6Address``, ``IPv4Network`` |
|  |  | and ``IPv6Network``. |
|  |  |  |
|  |  | itertools |
|  |  | --------- |
| Expand Down | |  |

41 changes: 35 additions & 6 deletions

41
[Lib/ipaddress.py](#diff-f67a8b5be6bdc48383d2ab907325a4c75ef998fa7cd0bba382ec2efa7e4f00b5 "Lib/ipaddress.py")

Show comments

[View file](/python/cpython/blob/40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f/Lib/ipaddress.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1086,7 +1086,11 @@ def is\_private(self): |
|  |  | """ |
|  |  | return any(self.network\_address in priv\_network and |
|  |  | self.broadcast\_address in priv\_network |
|  |  | for priv\_network in self.\_constants.\_private\_networks) |
|  |  | for priv\_network in self.\_constants.\_private\_networks) and all( |
|  |  | self.network\_address not in network and |
|  |  | self.broadcast\_address not in network |
|  |  | for network in self.\_constants.\_private\_networks\_exceptions |
|  |  | ) |
|  |  |  |
|  |  | @property |
|  |  | def is\_global(self): |
| Expand Down  Expand Up | | @@ -1347,7 +1351,10 @@ def is\_private(self): |
|  |  | ``is\_private`` has value opposite to :attr:`is\_global`, except for the ``100.64.0.0/10`` |
|  |  | IPv4 range where they are both ``False``. |
|  |  | """ |
|  |  | return any(self in net for net in self.\_constants.\_private\_networks) |
|  |  | return ( |
|  |  | any(self in net for net in self.\_constants.\_private\_networks) |
|  |  | and all(self not in net for net in self.\_constants.\_private\_networks\_exceptions) |
|  |  | ) |
|  |  |  |
|  |  | @property |
|  |  | @functools.lru\_cache() |
| Expand Down  Expand Up | | @@ -1578,13 +1585,15 @@ class \_IPv4Constants: |
|  |  |  |
|  |  | \_public\_network = IPv4Network('100.64.0.0/10') |
|  |  |  |
|  |  | # Not globally reachable address blocks listed on |
|  |  | # https://www.iana.org/assignments/iana-ipv4-special-registry/iana-ipv4-special-registry.xhtml |
|  |  | \_private\_networks = [ |
|  |  | IPv4Network('0.0.0.0/8'), |
|  |  | IPv4Network('10.0.0.0/8'), |
|  |  | IPv4Network('127.0.0.0/8'), |
|  |  | IPv4Network('169.254.0.0/16'), |
|  |  | IPv4Network('172.16.0.0/12'), |
|  |  | IPv4Network('192.0.0.0/29'), |
|  |  | IPv4Network('192.0.0.0/24'), |
|  |  | IPv4Network('192.0.0.170/31'), |
|  |  | IPv4Network('192.0.2.0/24'), |
|  |  | IPv4Network('192.168.0.0/16'), |
| Expand All | | @@ -1595,6 +1604,11 @@ class \_IPv4Constants: |
|  |  | IPv4Network('255.255.255.255/32'), |
|  |  | ] |
|  |  |  |
|  |  | \_private\_networks\_exceptions = [ |
|  |  | IPv4Network('192.0.0.9/32'), |
|  |  | IPv4Network('192.0.0.10/32'), |
|  |  | ] |
|  |  |  |
|  |  | \_reserved\_network = IPv4Network('240.0.0.0/4') |
|  |  |  |
|  |  | \_unspecified\_address = IPv4Address('0.0.0.0') |
| Expand Down  Expand Up | | @@ -2086,7 +2100,10 @@ def is\_private(self): |
|  |  | ipv4\_mapped = self.ipv4\_mapped |
|  |  | if ipv4\_mapped is not None: |
|  |  | return ipv4\_mapped.is\_private |
|  |  | return any(self in net for net in self.\_constants.\_private\_networks) |
|  |  | return ( |
|  |  | any(self in net for net in self.\_constants.\_private\_networks) |
|  |  | and all(self not in net for net in self.\_constants.\_private\_networks\_exceptions) |
|  |  | ) |
|  |  |  |
|  |  | @property |
|  |  | def is\_global(self): |
| Expand Down  Expand Up | | @@ -2342,19 +2359,31 @@ class \_IPv6Constants: |
|  |  |  |
|  |  | \_multicast\_network = IPv6Network('ff00::/8') |
|  |  |  |
|  |  | # Not globally reachable address blocks listed on |
|  |  | # https://www.iana.org/assignments/iana-ipv6-special-registry/iana-ipv6-special-registry.xhtml |
|  |  | \_private\_networks = [ |
|  |  | IPv6Network('::1/128'), |
|  |  | IPv6Network('::/128'), |
|  |  | IPv6Network('::ffff:0:0/96'), |
|  |  | IPv6Network('64:ff9b:1::/48'), |
|  |  | IPv6Network('100::/64'), |
|  |  | IPv6Network('2001::/23'), |
|  |  | IPv6Network('2001:2::/48'), |
|  |  | IPv6Network('2001:db8::/32'), |
|  |  | IPv6Network('2001:10::/28'), |
|  |  | # IANA says N/A, let's consider it not globally reachable to be safe |
|  |  | IPv6Network('2002::/16'), |
|  |  | IPv6Network('fc00::/7'), |
|  |  | IPv6Network('fe80::/10'), |
|  |  | ] |
|  |  |  |
|  |  | \_private\_networks\_exceptions = [ |
|  |  | IPv6Network('2001:1::1/128'), |
|  |  | IPv6Network('2001:1::2/128'), |
|  |  | IPv6Network('2001:3::/32'), |
|  |  | IPv6Network('2001:4:112::/48'), |
|  |  | IPv6Network('2001:20::/28'), |
|  |  | IPv6Network('2001:30::/28'), |
|  |  | ] |
|  |  |  |
|  |  | \_reserved\_networks = [ |
|  |  | IPv6Network('::/8'), IPv6Network('100::/8'), |
|  |  | IPv6Network('200::/7'), IPv6Network('400::/6'), |
| Expand Down | |  |

21 changes: 20 additions & 1 deletion

21
[Lib/test/test\_ipaddress.py](#diff-75d091371807896a8a66871de0fae89ad932066b2c4b73f9278e549ef25826c7 "Lib/test/test_ipaddress.py")

Show comments

[View file](/python/cpython/blob/40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f/Lib/test/test_ipaddress.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2288,6 +2288,10 @@ def testReservedIpv4(self): |
|  |  | self.assertEqual(True, ipaddress.ip\_address( |
|  |  | '172.31.255.255').is\_private) |
|  |  | self.assertEqual(False, ipaddress.ip\_address('172.32.0.0').is\_private) |
|  |  | self.assertFalse(ipaddress.ip\_address('192.0.0.0').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('192.0.0.9').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('192.0.0.10').is\_global) |
|  |  | self.assertFalse(ipaddress.ip\_address('192.0.0.255').is\_global) |
|  |  |  |
|  |  | self.assertEqual(True, |
|  |  | ipaddress.ip\_address('169.254.100.200').is\_link\_local) |
| Expand All | | @@ -2313,6 +2317,7 @@ def testPrivateNetworks(self): |
|  |  | self.assertEqual(True, ipaddress.ip\_network("169.254.0.0/16").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("172.16.0.0/12").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("192.0.0.0/29").is\_private) |
|  |  | self.assertEqual(False, ipaddress.ip\_network("192.0.0.9/32").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("192.0.0.170/31").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("192.0.2.0/24").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("192.168.0.0/16").is\_private) |
| Expand All | | @@ -2329,8 +2334,8 @@ def testPrivateNetworks(self): |
|  |  | self.assertEqual(True, ipaddress.ip\_network("::/128").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("::ffff:0:0/96").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("100::/64").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("2001::/23").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("2001:2::/48").is\_private) |
|  |  | self.assertEqual(False, ipaddress.ip\_network("2001:3::/48").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("2001:db8::/32").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("2001:10::/28").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("fc00::/7").is\_private) |
| Expand Down  Expand Up | | @@ -2409,6 +2414,20 @@ def testReservedIpv6(self): |
|  |  | self.assertEqual(True, ipaddress.ip\_address('0::0').is\_unspecified) |
|  |  | self.assertEqual(False, ipaddress.ip\_address('::1').is\_unspecified) |
|  |  |  |
|  |  | self.assertFalse(ipaddress.ip\_address('64:ff9b:1::').is\_global) |
|  |  | self.assertFalse(ipaddress.ip\_address('2001::').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('2001:1::1').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('2001:1::2').is\_global) |
|  |  | self.assertFalse(ipaddress.ip\_address('2001:2::').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('2001:3::').is\_global) |
|  |  | self.assertFalse(ipaddress.ip\_address('2001:4::').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('2001:4:112::').is\_global) |
|  |  | self.assertFalse(ipaddress.ip\_address('2001:10::').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('2001:20::').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('2001:30::').is\_global) |
|  |  | self.assertFalse(ipaddress.ip\_address('2001:40::').is\_global) |
|  |  | self.assertFalse(ipaddress.ip\_address('2002::').is\_global) |
|  |  |  |
|  |  | # some generic IETF reserved addresses |
|  |  | self.assertEqual(True, ipaddress.ip\_address('100::').is\_reserved) |
|  |  | self.assertEqual(True, ipaddress.ip\_network('4000::1/128').is\_reserved) |
| Expand Down | |  |

9 changes: 9 additions & 0 deletions

9
[Misc/NEWS.d/next/Library/2024-03-14-01-38-44.gh-issue-113171.VFnObz.rst](#diff-2d6ca0985b215bccb49c607530d008bc3014490e8ac3d6b3e51f32aa94f2c1d7 "Misc/NEWS.d/next/Library/2024-03-14-01-38-44.gh-issue-113171.VFnObz.rst")

Show comments

[View file](/python/cpython/blob/40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f/Misc/NEWS.d/next/Library/2024-03-14-01-38-44.gh-issue-113171.VFnObz.rst)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -0,0 +1,9 @@ |
|  |  | Fixed various false positives and false negatives in |
|  |  |  |
|  |  | \* :attr:`ipaddress.IPv4Address.is\_private` (see these docs for details) |
|  |  | \* :attr:`ipaddress.IPv4Address.is\_global` |
|  |  | \* :attr:`ipaddress.IPv6Address.is\_private` |
|  |  | \* :attr:`ipaddress.IPv6Address.is\_global` |
|  |  |  |
|  |  | Also in the corresponding :class:`ipaddress.IPv4Network` and :class:`ipaddress.IPv6Network` |
|  |  | attributes. |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `40d75c2`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpython%2Fcpython%2Fcommit%2F40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_4680811d_20250110_175738.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpython%2Fcpython%2Fcommit%2Ff86b17ac511e68192ba71f27e752321a3252cee3)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpython%2Fcpython%2Fcommit%2Ff86b17ac511e68192ba71f27e752321a3252cee3)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=python%2Fcpython)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[python](/python)
/
**[cpython](/python/cpython)**
Public

* [Notifications](/login?return_to=%2Fpython%2Fcpython) You must be signed in to change notification settings
* [Fork
  30.8k](/login?return_to=%2Fpython%2Fcpython)
* [Star
   64.7k](/login?return_to=%2Fpython%2Fcpython)

* [Code](/python/cpython)
* [Issues
  5k+](/python/cpython/issues)
* [Pull requests
  1.8k](/python/cpython/pulls)
* [Actions](/python/cpython/actions)
* [Projects
  28](/python/cpython/projects)
* [Security](/python/cpython/security)
* [Insights](/python/cpython/pulse)

Additional navigation options

* [Code](/python/cpython)
* [Issues](/python/cpython/issues)
* [Pull requests](/python/cpython/pulls)
* [Actions](/python/cpython/actions)
* [Projects](/python/cpython/projects)
* [Security](/python/cpython/security)
* [Insights](/python/cpython/pulse)

## Commit

[Permalink](/python/cpython/commit/f86b17ac511e68192ba71f27e752321a3252cee3)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

[3.12] [gh-113171](https://github.com/python/cpython/issues/113171): [gh-65056](https://github.com/python/cpython/issues/65056): Fix "private" (non-global) IP address ran…

[Browse files](/python/cpython/tree/f86b17ac511e68192ba71f27e752321a3252cee3)
Browse the repository at this point in the history

```
…ges ([GH-113179](https://github.com/python/cpython/pull/113179)) ([GH-113186](https://github.com/python/cpython/pull/113186)) ([GH-118177](https://github.com/python/cpython/pull/118177))

* [GH-113171](https://github.com/python/cpython/issues/113171): Fix "private" (non-global) IP address ranges ([GH-113179](https://github.com/python/cpython/pull/113179))

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] [#61602](https://github.com/python/cpython/issues/61602)

* [GH-65056](https://github.com/python/cpython/issues/65056): Improve the IP address' is_global/is_private documentation ([GH-113186](https://github.com/python/cpython/pull/113186))

It wasn't clear what the semantics of is_global/is_private are and, when
one gets to the bottom of it, it's not quite so simple (hence the
exceptions listed).

(cherry picked from commit [2a4cbf1](https://github.com/python/cpython/commit/2a4cbf17af19a01d942f9579342f77c39fbd23c4))
(cherry picked from commit [40d75c2](https://github.com/python/cpython/commit/40d75c2b7f5c67e254d0a025e0f2e2c7ada7f69f))

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
```

* Loading branch information

[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&v=4)](/encukou) [![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak)

[encukou](/python/cpython/commits?author=encukou "View all commits by encukou")
and
[jstasiak](/python/cpython/commits?author=jstasiak "View all commits by jstasiak")
authored
Apr 24, 2024

1 parent
[2eaf9ba](/python/cpython/commit/2eaf9ba9ceb4a9d1595b1413bf872db0a4978b13)

commit f86b17a

 Show file tree

 Hide file tree

Showing
**5 changed files**
with
**157 additions**
and
**24 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* Doc

  + library

    - Doc/library/ipaddress.rst
      [ipaddress.rst](#diff-d9c61a8ece8cc31330309c90fc34330e1c21bc615ad0941aac8ca6af36f99568)
  + whatsnew

    - Doc/whatsnew/3.12.rst
      [3.12.rst](#diff-0f2c1763c64530268325a0ee2dfaa4f5d555c4ac27deb78bd77102c8ce1b886b)
* Lib

  + Lib/ipaddress.py
    [ipaddress.py](#diff-f67a8b5be6bdc48383d2ab907325a4c75ef998fa7cd0bba382ec2efa7e4f00b5)
  + test

    - Lib/test/test\_ipaddress.py
      [test\_ipaddress.py](#diff-75d091371807896a8a66871de0fae89ad932066b2c4b73f9278e549ef25826c7)
* Misc/NEWS.d/next/Library

  + Misc/NEWS.d/next/Library/2024-03-14-01-38-44.gh-issue-113171.VFnObz.rst
    [2024-03-14-01-38-44.gh-issue-113171.VFnObz.rst](#diff-2d6ca0985b215bccb49c607530d008bc3014490e8ac3d6b3e51f32aa94f2c1d7)

## There are no files selected for viewing

43 changes: 39 additions & 4 deletions

43
[Doc/library/ipaddress.rst](#diff-d9c61a8ece8cc31330309c90fc34330e1c21bc615ad0941aac8ca6af36f99568 "Doc/library/ipaddress.rst")

Show comments

[View file](/python/cpython/blob/f86b17ac511e68192ba71f27e752321a3252cee3/Doc/library/ipaddress.rst)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -178,18 +178,53 @@ write code that handles both IP versions correctly. Address objects are |
|  |  |  |
|  |  | .. attribute:: is\_private |
|  |  |  |
|  |  | ``True`` if the address is allocated for private networks. See |
|  |  | ``True`` if the address is defined as not globally reachable by |
|  |  | iana-ipv4-special-registry\_ (for IPv4) or iana-ipv6-special-registry\_ |
|  |  | (for IPv6). |
|  |  | (for IPv6) with the following exceptions: |
|  |  |  |
|  |  | \* ``is\_private`` is ``False`` for the shared address space (``100.64.0.0/10``) |
|  |  | \* For IPv4-mapped IPv6-addresses the ``is\_private`` value is determined by the |
|  |  | semantics of the underlying IPv4 addresses and the following condition holds |
|  |  | (see :attr:`IPv6Address.ipv4\_mapped`):: |
|  |  |  |
|  |  | address.is\_private == address.ipv4\_mapped.is\_private |
|  |  |  |
|  |  | ``is\_private`` has value opposite to :attr:`is\_global`, except for the shared address space |
|  |  | (``100.64.0.0/10`` range) where they are both ``False``. |
|  |  |  |
|  |  | .. versionchanged:: 3.12.4 |
|  |  |  |
|  |  | Fixed some false positives and false negatives. |
|  |  |  |
|  |  | \* ``192.0.0.0/24`` is considered private with the exception of ``192.0.0.9/32`` and |
|  |  | ``192.0.0.10/32`` (previously: only the ``192.0.0.0/29`` sub-range was considered private). |
|  |  | \* ``64:ff9b:1::/48`` is considered private. |
|  |  | \* ``2002::/16`` is considered private. |
|  |  | \* There are exceptions within ``2001::/23`` (otherwise considered private): ``2001:1::1/128``, |
|  |  | ``2001:1::2/128``, ``2001:3::/32``, ``2001:4:112::/48``, ``2001:20::/28``, ``2001:30::/28``. |
|  |  | The exceptions are not considered private. |
|  |  |  |
|  |  | .. attribute:: is\_global |
|  |  |  |
|  |  | ``True`` if the address is allocated for public networks. See |
|  |  | ``True`` if the address is defined as globally reachable by |
|  |  | iana-ipv4-special-registry\_ (for IPv4) or iana-ipv6-special-registry\_ |
|  |  | (for IPv6). |
|  |  | (for IPv6) with the following exception: |
|  |  |  |
|  |  | For IPv4-mapped IPv6-addresses the ``is\_private`` value is determined by the |
|  |  | semantics of the underlying IPv4 addresses and the following condition holds |
|  |  | (see :attr:`IPv6Address.ipv4\_mapped`):: |
|  |  |  |
|  |  | address.is\_global == address.ipv4\_mapped.is\_global |
|  |  |  |
|  |  | ``is\_global`` has value opposite to :attr:`is\_private`, except for the shared address space |
|  |  | (``100.64.0.0/10`` range) where they are both ``False``. |
|  |  |  |
|  |  | .. versionadded:: 3.4 |
|  |  |  |
|  |  | .. versionchanged:: 3.12.4 |
|  |  |  |
|  |  | Fixed some false positives and false negatives, see :attr:`is\_private` for details. |
|  |  |  |
|  |  | .. attribute:: is\_unspecified |
|  |  |  |
|  |  | ``True`` if the address is unspecified. See :RFC:`5735` (for IPv4) |
| Expand Down | |  |

9 changes: 9 additions & 0 deletions

9
[Doc/whatsnew/3.12.rst](#diff-0f2c1763c64530268325a0ee2dfaa4f5d555c4ac27deb78bd77102c8ce1b886b "Doc/whatsnew/3.12.rst")

Show comments

[View file](/python/cpython/blob/f86b17ac511e68192ba71f27e752321a3252cee3/Doc/whatsnew/3.12.rst)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -2457,3 +2457,12 @@ Removed |
|  |  |  |
|  |  | \* Remove the ``PyUnicode\_InternImmortal()`` function macro. |
|  |  | (Contributed by Victor Stinner in :gh:`85858`.) |
|  |  |  |
|  |  | Notable changes in 3.12.4 |
|  |  | ========================= |
|  |  |  |
|  |  | ipaddress |
|  |  | --------- |
|  |  |  |
|  |  | \* Fixed ``is\_global`` and ``is\_private`` behavior in ``IPv4Address``, |
|  |  | ``IPv6Address``, ``IPv4Network`` and ``IPv6Network``. |

99 changes: 80 additions & 19 deletions

99
[Lib/ipaddress.py](#diff-f67a8b5be6bdc48383d2ab907325a4c75ef998fa7cd0bba382ec2efa7e4f00b5 "Lib/ipaddress.py")

Show comments

[View file](/python/cpython/blob/f86b17ac511e68192ba71f27e752321a3252cee3/Lib/ipaddress.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1086,7 +1086,11 @@ def is\_private(self): |
|  |  | """ |
|  |  | return any(self.network\_address in priv\_network and |
|  |  | self.broadcast\_address in priv\_network |
|  |  | for priv\_network in self.\_constants.\_private\_networks) |
|  |  | for priv\_network in self.\_constants.\_private\_networks) and all( |
|  |  | self.network\_address not in network and |
|  |  | self.broadcast\_address not in network |
|  |  | for network in self.\_constants.\_private\_networks\_exceptions |
|  |  | ) |
|  |  |  |
|  |  | @property |
|  |  | def is\_global(self): |
| Expand Down  Expand Up | | @@ -1333,18 +1337,41 @@ def is\_reserved(self): |
|  |  | @property |
|  |  | @functools.lru\_cache() |
|  |  | def is\_private(self): |
|  |  | """Test if this address is allocated for private networks. |
|  |  | """``True`` if the address is defined as not globally reachable by |
|  |  | iana-ipv4-special-registry\_ (for IPv4) or iana-ipv6-special-registry\_ |
|  |  | (for IPv6) with the following exceptions: |
|  |  |  |
|  |  | Returns: |
|  |  | A boolean, True if the address is reserved per |
|  |  | iana-ipv4-special-registry. |
|  |  | \* ``is\_private`` is ``False`` for ``100.64.0.0/10`` |
|  |  | \* For IPv4-mapped IPv6-addresses the ``is\_private`` value is determined by the |
|  |  | semantics of the underlying IPv4 addresses and the following condition holds |
|  |  | (see :attr:`IPv6Address.ipv4\_mapped`):: |
|  |  |  |
|  |  | address.is\_private == address.ipv4\_mapped.is\_private |
|  |  |  |
|  |  | ``is\_private`` has value opposite to :attr:`is\_global`, except for the ``100.64.0.0/10`` |
|  |  | IPv4 range where they are both ``False``. |
|  |  | """ |
|  |  | return any(self in net for net in self.\_constants.\_private\_networks) |
|  |  | return ( |
|  |  | any(self in net for net in self.\_constants.\_private\_networks) |
|  |  | and all(self not in net for net in self.\_constants.\_private\_networks\_exceptions) |
|  |  | ) |
|  |  |  |
|  |  | @property |
|  |  | @functools.lru\_cache() |
|  |  | def is\_global(self): |
|  |  | """``True`` if the address is defined as globally reachable by |
|  |  | iana-ipv4-special-registry\_ (for IPv4) or iana-ipv6-special-registry\_ |
|  |  | (for IPv6) with the following exception: |
|  |  |  |
|  |  | For IPv4-mapped IPv6-addresses the ``is\_private`` value is determined by the |
|  |  | semantics of the underlying IPv4 addresses and the following condition holds |
|  |  | (see :attr:`IPv6Address.ipv4\_mapped`):: |
|  |  |  |
|  |  | address.is\_global == address.ipv4\_mapped.is\_global |
|  |  |  |
|  |  | ``is\_global`` has value opposite to :attr:`is\_private`, except for the ``100.64.0.0/10`` |
|  |  | IPv4 range where they are both ``False``. |
|  |  | """ |
|  |  | return self not in self.\_constants.\_public\_network and not self.is\_private |
|  |  |  |
|  |  | @property |
| Expand Down  Expand Up | | @@ -1548,13 +1575,15 @@ class \_IPv4Constants: |
|  |  |  |
|  |  | \_public\_network = IPv4Network('100.64.0.0/10') |
|  |  |  |
|  |  | # Not globally reachable address blocks listed on |
|  |  | # https://www.iana.org/assignments/iana-ipv4-special-registry/iana-ipv4-special-registry.xhtml |
|  |  | \_private\_networks = [ |
|  |  | IPv4Network('0.0.0.0/8'), |
|  |  | IPv4Network('10.0.0.0/8'), |
|  |  | IPv4Network('127.0.0.0/8'), |
|  |  | IPv4Network('169.254.0.0/16'), |
|  |  | IPv4Network('172.16.0.0/12'), |
|  |  | IPv4Network('192.0.0.0/29'), |
|  |  | IPv4Network('192.0.0.0/24'), |
|  |  | IPv4Network('192.0.0.170/31'), |
|  |  | IPv4Network('192.0.2.0/24'), |
|  |  | IPv4Network('192.168.0.0/16'), |
| Expand All | | @@ -1565,6 +1594,11 @@ class \_IPv4Constants: |
|  |  | IPv4Network('255.255.255.255/32'), |
|  |  | ] |
|  |  |  |
|  |  | \_private\_networks\_exceptions = [ |
|  |  | IPv4Network('192.0.0.9/32'), |
|  |  | IPv4Network('192.0.0.10/32'), |
|  |  | ] |
|  |  |  |
|  |  | \_reserved\_network = IPv4Network('240.0.0.0/4') |
|  |  |  |
|  |  | \_unspecified\_address = IPv4Address('0.0.0.0') |
| Expand Down  Expand Up | | @@ -2007,27 +2041,42 @@ def is\_site\_local(self): |
|  |  | @property |
|  |  | @functools.lru\_cache() |
|  |  | def is\_private(self): |
|  |  | """Test if this address is allocated for private networks. |
|  |  | """``True`` if the address is defined as not globally reachable by |
|  |  | iana-ipv4-special-registry\_ (for IPv4) or iana-ipv6-special-registry\_ |
|  |  | (for IPv6) with the following exceptions: |
|  |  |  |
|  |  | Returns: |
|  |  | A boolean, True if the address is reserved per |
|  |  | iana-ipv6-special-registry, or is ipv4\_mapped and is |
|  |  | reserved in the iana-ipv4-special-registry. |
|  |  | \* ``is\_private`` is ``False`` for ``100.64.0.0/10`` |
|  |  | \* For IPv4-mapped IPv6-addresses the ``is\_private`` value is determined by the |
|  |  | semantics of the underlying IPv4 addresses and the following condition holds |
|  |  | (see :attr:`IPv6Address.ipv4\_mapped`):: |
|  |  |  |
|  |  | address.is\_private == address.ipv4\_mapped.is\_private |
|  |  |  |
|  |  | ``is\_private`` has value opposite to :attr:`is\_global`, except for the ``100.64.0.0/10`` |
|  |  | IPv4 range where they are both ``False``. |
|  |  | """ |
|  |  | ipv4\_mapped = self.ipv4\_mapped |
|  |  | if ipv4\_mapped is not None: |
|  |  | return ipv4\_mapped.is\_private |
|  |  | return any(self in net for net in self.\_constants.\_private\_networks) |
|  |  | return ( |
|  |  | any(self in net for net in self.\_constants.\_private\_networks) |
|  |  | and all(self not in net for net in self.\_constants.\_private\_networks\_exceptions) |
|  |  | ) |
|  |  |  |
|  |  | @property |
|  |  | def is\_global(self): |
|  |  | """Test if this address is allocated for public networks. |
|  |  | """``True`` if the address is defined as globally reachable by |
|  |  | iana-ipv4-special-registry\_ (for IPv4) or iana-ipv6-special-registry\_ |
|  |  | (for IPv6) with the following exception: |
|  |  |  |
|  |  | Returns: |
|  |  | A boolean, true if the address is not reserved per |
|  |  | iana-ipv6-special-registry. |
|  |  | For IPv4-mapped IPv6-addresses the ``is\_private`` value is determined by the |
|  |  | semantics of the underlying IPv4 addresses and the following condition holds |
|  |  | (see :attr:`IPv6Address.ipv4\_mapped`):: |
|  |  |  |
|  |  | address.is\_global == address.ipv4\_mapped.is\_global |
|  |  |  |
|  |  | ``is\_global`` has value opposite to :attr:`is\_private`, except for the ``100.64.0.0/10`` |
|  |  | IPv4 range where they are both ``False``. |
|  |  | """ |
|  |  | return not self.is\_private |
|  |  |  |
| Expand Down  Expand Up | | @@ -2268,19 +2317,31 @@ class \_IPv6Constants: |
|  |  |  |
|  |  | \_multicast\_network = IPv6Network('ff00::/8') |
|  |  |  |
|  |  | # Not globally reachable address blocks listed on |
|  |  | # https://www.iana.org/assignments/iana-ipv6-special-registry/iana-ipv6-special-registry.xhtml |
|  |  | \_private\_networks = [ |
|  |  | IPv6Network('::1/128'), |
|  |  | IPv6Network('::/128'), |
|  |  | IPv6Network('::ffff:0:0/96'), |
|  |  | IPv6Network('64:ff9b:1::/48'), |
|  |  | IPv6Network('100::/64'), |
|  |  | IPv6Network('2001::/23'), |
|  |  | IPv6Network('2001:2::/48'), |
|  |  | IPv6Network('2001:db8::/32'), |
|  |  | IPv6Network('2001:10::/28'), |
|  |  | # IANA says N/A, let's consider it not globally reachable to be safe |
|  |  | IPv6Network('2002::/16'), |
|  |  | IPv6Network('fc00::/7'), |
|  |  | IPv6Network('fe80::/10'), |
|  |  | ] |
|  |  |  |
|  |  | \_private\_networks\_exceptions = [ |
|  |  | IPv6Network('2001:1::1/128'), |
|  |  | IPv6Network('2001:1::2/128'), |
|  |  | IPv6Network('2001:3::/32'), |
|  |  | IPv6Network('2001:4:112::/48'), |
|  |  | IPv6Network('2001:20::/28'), |
|  |  | IPv6Network('2001:30::/28'), |
|  |  | ] |
|  |  |  |
|  |  | \_reserved\_networks = [ |
|  |  | IPv6Network('::/8'), IPv6Network('100::/8'), |
|  |  | IPv6Network('200::/7'), IPv6Network('400::/6'), |
| Expand Down | |  |

21 changes: 20 additions & 1 deletion

21
[Lib/test/test\_ipaddress.py](#diff-75d091371807896a8a66871de0fae89ad932066b2c4b73f9278e549ef25826c7 "Lib/test/test_ipaddress.py")

Show comments

[View file](/python/cpython/blob/f86b17ac511e68192ba71f27e752321a3252cee3/Lib/test/test_ipaddress.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2269,6 +2269,10 @@ def testReservedIpv4(self): |
|  |  | self.assertEqual(True, ipaddress.ip\_address( |
|  |  | '172.31.255.255').is\_private) |
|  |  | self.assertEqual(False, ipaddress.ip\_address('172.32.0.0').is\_private) |
|  |  | self.assertFalse(ipaddress.ip\_address('192.0.0.0').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('192.0.0.9').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('192.0.0.10').is\_global) |
|  |  | self.assertFalse(ipaddress.ip\_address('192.0.0.255').is\_global) |
|  |  |  |
|  |  | self.assertEqual(True, |
|  |  | ipaddress.ip\_address('169.254.100.200').is\_link\_local) |
| Expand All | | @@ -2294,6 +2298,7 @@ def testPrivateNetworks(self): |
|  |  | self.assertEqual(True, ipaddress.ip\_network("169.254.0.0/16").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("172.16.0.0/12").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("192.0.0.0/29").is\_private) |
|  |  | self.assertEqual(False, ipaddress.ip\_network("192.0.0.9/32").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("192.0.0.170/31").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("192.0.2.0/24").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("192.168.0.0/16").is\_private) |
| Expand All | | @@ -2310,8 +2315,8 @@ def testPrivateNetworks(self): |
|  |  | self.assertEqual(True, ipaddress.ip\_network("::/128").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("::ffff:0:0/96").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("100::/64").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("2001::/23").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("2001:2::/48").is\_private) |
|  |  | self.assertEqual(False, ipaddress.ip\_network("2001:3::/48").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("2001:db8::/32").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("2001:10::/28").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("fc00::/7").is\_private) |
| Expand Down  Expand Up | | @@ -2390,6 +2395,20 @@ def testReservedIpv6(self): |
|  |  | self.assertEqual(True, ipaddress.ip\_address('0::0').is\_unspecified) |
|  |  | self.assertEqual(False, ipaddress.ip\_address('::1').is\_unspecified) |
|  |  |  |
|  |  | self.assertFalse(ipaddress.ip\_address('64:ff9b:1::').is\_global) |
|  |  | self.assertFalse(ipaddress.ip\_address('2001::').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('2001:1::1').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('2001:1::2').is\_global) |
|  |  | self.assertFalse(ipaddress.ip\_address('2001:2::').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('2001:3::').is\_global) |
|  |  | self.assertFalse(ipaddress.ip\_address('2001:4::').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('2001:4:112::').is\_global) |
|  |  | self.assertFalse(ipaddress.ip\_address('2001:10::').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('2001:20::').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('2001:30::').is\_global) |
|  |  | self.assertFalse(ipaddress.ip\_address('2001:40::').is\_global) |
|  |  | self.assertFalse(ipaddress.ip\_address('2002::').is\_global) |
|  |  |  |
|  |  | # some generic IETF reserved addresses |
|  |  | self.assertEqual(True, ipaddress.ip\_address('100::').is\_reserved) |
|  |  | self.assertEqual(True, ipaddress.ip\_network('4000::1/128').is\_reserved) |
| Expand Down | |  |

9 changes: 9 additions & 0 deletions

9
[Misc/NEWS.d/next/Library/2024-03-14-01-38-44.gh-issue-113171.VFnObz.rst](#diff-2d6ca0985b215bccb49c607530d008bc3014490e8ac3d6b3e51f32aa94f2c1d7 "Misc/NEWS.d/next/Library/2024-03-14-01-38-44.gh-issue-113171.VFnObz.rst")

Show comments

[View file](/python/cpython/blob/f86b17ac511e68192ba71f27e752321a3252cee3/Misc/NEWS.d/next/Library/2024-03-14-01-38-44.gh-issue-113171.VFnObz.rst)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -0,0 +1,9 @@ |
|  |  | Fixed various false positives and false negatives in |
|  |  |  |
|  |  | \* :attr:`ipaddress.IPv4Address.is\_private` (see these docs for details) |
|  |  | \* :attr:`ipaddress.IPv4Address.is\_global` |
|  |  | \* :attr:`ipaddress.IPv6Address.is\_private` |
|  |  | \* :attr:`ipaddress.IPv6Address.is\_global` |
|  |  |  |
|  |  | Also in the corresponding :class:`ipaddress.IPv4Network` and :class:`ipaddress.IPv6Network` |
|  |  | attributes. |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `f86b17a`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpython%2Fcpython%2Fcommit%2Ff86b17ac511e68192ba71f27e752321a3252cee3) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_b94a43f8_20250110_175735.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpython%2Fcpython%2Fcommit%2Fba431579efdcbaed7a96f2ac4ea0775879a332fb)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpython%2Fcpython%2Fcommit%2Fba431579efdcbaed7a96f2ac4ea0775879a332fb)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=python%2Fcpython)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[python](/python)
/
**[cpython](/python/cpython)**
Public

* [Notifications](/login?return_to=%2Fpython%2Fcpython) You must be signed in to change notification settings
* [Fork
  30.8k](/login?return_to=%2Fpython%2Fcpython)
* [Star
   64.7k](/login?return_to=%2Fpython%2Fcpython)

* [Code](/python/cpython)
* [Issues
  5k+](/python/cpython/issues)
* [Pull requests
  1.8k](/python/cpython/pulls)
* [Actions](/python/cpython/actions)
* [Projects
  28](/python/cpython/projects)
* [Security](/python/cpython/security)
* [Insights](/python/cpython/pulse)

Additional navigation options

* [Code](/python/cpython)
* [Issues](/python/cpython/issues)
* [Pull requests](/python/cpython/pulls)
* [Actions](/python/cpython/actions)
* [Projects](/python/cpython/projects)
* [Security](/python/cpython/security)
* [Insights](/python/cpython/pulse)

## Commit

[Permalink](/python/cpython/commit/ba431579efdcbaed7a96f2ac4ea0775879a332fb)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

[3.11] [gh-113171](https://github.com/python/cpython/issues/113171): [gh-65056](https://github.com/python/cpython/issues/65056): Fix "private" (non-global) IP address ran…

[Browse files](/python/cpython/tree/ba431579efdcbaed7a96f2ac4ea0775879a332fb)
Browse the repository at this point in the history

```
…ges ([GH-113179](https://github.com/python/cpython/pull/113179)) ([GH-113186](https://github.com/python/cpython/pull/113186)) ([GH-118177](https://github.com/python/cpython/pull/118177)) ([#118227](https://github.com/python/cpython/pull/118227))
```

* Loading branch information

[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&v=4)](/encukou)

[encukou](/python/cpython/commits?author=encukou "View all commits by encukou")
authored
Apr 25, 2024

1 parent
[8133285](/python/cpython/commit/8133285c139c88d432587480c82a5872e163e87c)

commit ba43157

 Show file tree

 Hide file tree

Showing
**5 changed files**
with
**157 additions**
and
**24 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* Doc

  + library

    - Doc/library/ipaddress.rst
      [ipaddress.rst](#diff-d9c61a8ece8cc31330309c90fc34330e1c21bc615ad0941aac8ca6af36f99568)
  + whatsnew

    - Doc/whatsnew/3.11.rst
      [3.11.rst](#diff-78f24041d66ab8ed2ae1aee94bcd42396d27af833cb96a3c506294c6d6dce82d)
* Lib

  + Lib/ipaddress.py
    [ipaddress.py](#diff-f67a8b5be6bdc48383d2ab907325a4c75ef998fa7cd0bba382ec2efa7e4f00b5)
  + test

    - Lib/test/test\_ipaddress.py
      [test\_ipaddress.py](#diff-75d091371807896a8a66871de0fae89ad932066b2c4b73f9278e549ef25826c7)
* Misc/NEWS.d/next/Library

  + Misc/NEWS.d/next/Library/2024-03-14-01-38-44.gh-issue-113171.VFnObz.rst
    [2024-03-14-01-38-44.gh-issue-113171.VFnObz.rst](#diff-2d6ca0985b215bccb49c607530d008bc3014490e8ac3d6b3e51f32aa94f2c1d7)

## There are no files selected for viewing

43 changes: 39 additions & 4 deletions

43
[Doc/library/ipaddress.rst](#diff-d9c61a8ece8cc31330309c90fc34330e1c21bc615ad0941aac8ca6af36f99568 "Doc/library/ipaddress.rst")

Show comments

[View file](/python/cpython/blob/ba431579efdcbaed7a96f2ac4ea0775879a332fb/Doc/library/ipaddress.rst)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -178,18 +178,53 @@ write code that handles both IP versions correctly. Address objects are |
|  |  |  |
|  |  | .. attribute:: is\_private |
|  |  |  |
|  |  | ``True`` if the address is allocated for private networks. See |
|  |  | ``True`` if the address is defined as not globally reachable by |
|  |  | iana-ipv4-special-registry\_ (for IPv4) or iana-ipv6-special-registry\_ |
|  |  | (for IPv6). |
|  |  | (for IPv6) with the following exceptions: |
|  |  |  |
|  |  | \* ``is\_private`` is ``False`` for the shared address space (``100.64.0.0/10``) |
|  |  | \* For IPv4-mapped IPv6-addresses the ``is\_private`` value is determined by the |
|  |  | semantics of the underlying IPv4 addresses and the following condition holds |
|  |  | (see :attr:`IPv6Address.ipv4\_mapped`):: |
|  |  |  |
|  |  | address.is\_private == address.ipv4\_mapped.is\_private |
|  |  |  |
|  |  | ``is\_private`` has value opposite to :attr:`is\_global`, except for the shared address space |
|  |  | (``100.64.0.0/10`` range) where they are both ``False``. |
|  |  |  |
|  |  | .. versionchanged:: 3.11.10 |
|  |  |  |
|  |  | Fixed some false positives and false negatives. |
|  |  |  |
|  |  | \* ``192.0.0.0/24`` is considered private with the exception of ``192.0.0.9/32`` and |
|  |  | ``192.0.0.10/32`` (previously: only the ``192.0.0.0/29`` sub-range was considered private). |
|  |  | \* ``64:ff9b:1::/48`` is considered private. |
|  |  | \* ``2002::/16`` is considered private. |
|  |  | \* There are exceptions within ``2001::/23`` (otherwise considered private): ``2001:1::1/128``, |
|  |  | ``2001:1::2/128``, ``2001:3::/32``, ``2001:4:112::/48``, ``2001:20::/28``, ``2001:30::/28``. |
|  |  | The exceptions are not considered private. |
|  |  |  |
|  |  | .. attribute:: is\_global |
|  |  |  |
|  |  | ``True`` if the address is allocated for public networks. See |
|  |  | ``True`` if the address is defined as globally reachable by |
|  |  | iana-ipv4-special-registry\_ (for IPv4) or iana-ipv6-special-registry\_ |
|  |  | (for IPv6). |
|  |  | (for IPv6) with the following exception: |
|  |  |  |
|  |  | For IPv4-mapped IPv6-addresses the ``is\_private`` value is determined by the |
|  |  | semantics of the underlying IPv4 addresses and the following condition holds |
|  |  | (see :attr:`IPv6Address.ipv4\_mapped`):: |
|  |  |  |
|  |  | address.is\_global == address.ipv4\_mapped.is\_global |
|  |  |  |
|  |  | ``is\_global`` has value opposite to :attr:`is\_private`, except for the shared address space |
|  |  | (``100.64.0.0/10`` range) where they are both ``False``. |
|  |  |  |
|  |  | .. versionadded:: 3.4 |
|  |  |  |
|  |  | .. versionchanged:: 3.11.10 |
|  |  |  |
|  |  | Fixed some false positives and false negatives, see :attr:`is\_private` for details. |
|  |  |  |
|  |  | .. attribute:: is\_unspecified |
|  |  |  |
|  |  | ``True`` if the address is unspecified. See :RFC:`5735` (for IPv4) |
| Expand Down | |  |

9 changes: 9 additions & 0 deletions

9
[Doc/whatsnew/3.11.rst](#diff-78f24041d66ab8ed2ae1aee94bcd42396d27af833cb96a3c506294c6d6dce82d "Doc/whatsnew/3.11.rst")

Show comments

[View file](/python/cpython/blob/ba431579efdcbaed7a96f2ac4ea0775879a332fb/Doc/whatsnew/3.11.rst)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -2727,3 +2727,12 @@ OpenSSL |
|  |  | \* Windows builds and macOS installers from python.org now use OpenSSL 3.0. |
|  |  |  |
|  |  | .. \_libb2: https://www.blake2.net/ |
|  |  |  |
|  |  | Notable changes in 3.11.10 |
|  |  | ========================== |
|  |  |  |
|  |  | ipaddress |
|  |  | --------- |
|  |  |  |
|  |  | \* Fixed ``is\_global`` and ``is\_private`` behavior in ``IPv4Address``, |
|  |  | ``IPv6Address``, ``IPv4Network`` and ``IPv6Network``. |

99 changes: 80 additions & 19 deletions

99
[Lib/ipaddress.py](#diff-f67a8b5be6bdc48383d2ab907325a4c75ef998fa7cd0bba382ec2efa7e4f00b5 "Lib/ipaddress.py")

Show comments

[View file](/python/cpython/blob/ba431579efdcbaed7a96f2ac4ea0775879a332fb/Lib/ipaddress.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1086,7 +1086,11 @@ def is\_private(self): |
|  |  | """ |
|  |  | return any(self.network\_address in priv\_network and |
|  |  | self.broadcast\_address in priv\_network |
|  |  | for priv\_network in self.\_constants.\_private\_networks) |
|  |  | for priv\_network in self.\_constants.\_private\_networks) and all( |
|  |  | self.network\_address not in network and |
|  |  | self.broadcast\_address not in network |
|  |  | for network in self.\_constants.\_private\_networks\_exceptions |
|  |  | ) |
|  |  |  |
|  |  | @property |
|  |  | def is\_global(self): |
| Expand Down  Expand Up | | @@ -1333,18 +1337,41 @@ def is\_reserved(self): |
|  |  | @property |
|  |  | @functools.lru\_cache() |
|  |  | def is\_private(self): |
|  |  | """Test if this address is allocated for private networks. |
|  |  | """``True`` if the address is defined as not globally reachable by |
|  |  | iana-ipv4-special-registry\_ (for IPv4) or iana-ipv6-special-registry\_ |
|  |  | (for IPv6) with the following exceptions: |
|  |  |  |
|  |  | Returns: |
|  |  | A boolean, True if the address is reserved per |
|  |  | iana-ipv4-special-registry. |
|  |  | \* ``is\_private`` is ``False`` for ``100.64.0.0/10`` |
|  |  | \* For IPv4-mapped IPv6-addresses the ``is\_private`` value is determined by the |
|  |  | semantics of the underlying IPv4 addresses and the following condition holds |
|  |  | (see :attr:`IPv6Address.ipv4\_mapped`):: |
|  |  |  |
|  |  | address.is\_private == address.ipv4\_mapped.is\_private |
|  |  |  |
|  |  | ``is\_private`` has value opposite to :attr:`is\_global`, except for the ``100.64.0.0/10`` |
|  |  | IPv4 range where they are both ``False``. |
|  |  | """ |
|  |  | return any(self in net for net in self.\_constants.\_private\_networks) |
|  |  | return ( |
|  |  | any(self in net for net in self.\_constants.\_private\_networks) |
|  |  | and all(self not in net for net in self.\_constants.\_private\_networks\_exceptions) |
|  |  | ) |
|  |  |  |
|  |  | @property |
|  |  | @functools.lru\_cache() |
|  |  | def is\_global(self): |
|  |  | """``True`` if the address is defined as globally reachable by |
|  |  | iana-ipv4-special-registry\_ (for IPv4) or iana-ipv6-special-registry\_ |
|  |  | (for IPv6) with the following exception: |
|  |  |  |
|  |  | For IPv4-mapped IPv6-addresses the ``is\_private`` value is determined by the |
|  |  | semantics of the underlying IPv4 addresses and the following condition holds |
|  |  | (see :attr:`IPv6Address.ipv4\_mapped`):: |
|  |  |  |
|  |  | address.is\_global == address.ipv4\_mapped.is\_global |
|  |  |  |
|  |  | ``is\_global`` has value opposite to :attr:`is\_private`, except for the ``100.64.0.0/10`` |
|  |  | IPv4 range where they are both ``False``. |
|  |  | """ |
|  |  | return self not in self.\_constants.\_public\_network and not self.is\_private |
|  |  |  |
|  |  | @property |
| Expand Down  Expand Up | | @@ -1548,13 +1575,15 @@ class \_IPv4Constants: |
|  |  |  |
|  |  | \_public\_network = IPv4Network('100.64.0.0/10') |
|  |  |  |
|  |  | # Not globally reachable address blocks listed on |
|  |  | # https://www.iana.org/assignments/iana-ipv4-special-registry/iana-ipv4-special-registry.xhtml |
|  |  | \_private\_networks = [ |
|  |  | IPv4Network('0.0.0.0/8'), |
|  |  | IPv4Network('10.0.0.0/8'), |
|  |  | IPv4Network('127.0.0.0/8'), |
|  |  | IPv4Network('169.254.0.0/16'), |
|  |  | IPv4Network('172.16.0.0/12'), |
|  |  | IPv4Network('192.0.0.0/29'), |
|  |  | IPv4Network('192.0.0.0/24'), |
|  |  | IPv4Network('192.0.0.170/31'), |
|  |  | IPv4Network('192.0.2.0/24'), |
|  |  | IPv4Network('192.168.0.0/16'), |
| Expand All | | @@ -1565,6 +1594,11 @@ class \_IPv4Constants: |
|  |  | IPv4Network('255.255.255.255/32'), |
|  |  | ] |
|  |  |  |
|  |  | \_private\_networks\_exceptions = [ |
|  |  | IPv4Network('192.0.0.9/32'), |
|  |  | IPv4Network('192.0.0.10/32'), |
|  |  | ] |
|  |  |  |
|  |  | \_reserved\_network = IPv4Network('240.0.0.0/4') |
|  |  |  |
|  |  | \_unspecified\_address = IPv4Address('0.0.0.0') |
| Expand Down  Expand Up | | @@ -2010,27 +2044,42 @@ def is\_site\_local(self): |
|  |  | @property |
|  |  | @functools.lru\_cache() |
|  |  | def is\_private(self): |
|  |  | """Test if this address is allocated for private networks. |
|  |  | """``True`` if the address is defined as not globally reachable by |
|  |  | iana-ipv4-special-registry\_ (for IPv4) or iana-ipv6-special-registry\_ |
|  |  | (for IPv6) with the following exceptions: |
|  |  |  |
|  |  | Returns: |
|  |  | A boolean, True if the address is reserved per |
|  |  | iana-ipv6-special-registry, or is ipv4\_mapped and is |
|  |  | reserved in the iana-ipv4-special-registry. |
|  |  | \* ``is\_private`` is ``False`` for ``100.64.0.0/10`` |
|  |  | \* For IPv4-mapped IPv6-addresses the ``is\_private`` value is determined by the |
|  |  | semantics of the underlying IPv4 addresses and the following condition holds |
|  |  | (see :attr:`IPv6Address.ipv4\_mapped`):: |
|  |  |  |
|  |  | address.is\_private == address.ipv4\_mapped.is\_private |
|  |  |  |
|  |  | ``is\_private`` has value opposite to :attr:`is\_global`, except for the ``100.64.0.0/10`` |
|  |  | IPv4 range where they are both ``False``. |
|  |  | """ |
|  |  | ipv4\_mapped = self.ipv4\_mapped |
|  |  | if ipv4\_mapped is not None: |
|  |  | return ipv4\_mapped.is\_private |
|  |  | return any(self in net for net in self.\_constants.\_private\_networks) |
|  |  | return ( |
|  |  | any(self in net for net in self.\_constants.\_private\_networks) |
|  |  | and all(self not in net for net in self.\_constants.\_private\_networks\_exceptions) |
|  |  | ) |
|  |  |  |
|  |  | @property |
|  |  | def is\_global(self): |
|  |  | """Test if this address is allocated for public networks. |
|  |  | """``True`` if the address is defined as globally reachable by |
|  |  | iana-ipv4-special-registry\_ (for IPv4) or iana-ipv6-special-registry\_ |
|  |  | (for IPv6) with the following exception: |
|  |  |  |
|  |  | Returns: |
|  |  | A boolean, true if the address is not reserved per |
|  |  | iana-ipv6-special-registry. |
|  |  | For IPv4-mapped IPv6-addresses the ``is\_private`` value is determined by the |
|  |  | semantics of the underlying IPv4 addresses and the following condition holds |
|  |  | (see :attr:`IPv6Address.ipv4\_mapped`):: |
|  |  |  |
|  |  | address.is\_global == address.ipv4\_mapped.is\_global |
|  |  |  |
|  |  | ``is\_global`` has value opposite to :attr:`is\_private`, except for the ``100.64.0.0/10`` |
|  |  | IPv4 range where they are both ``False``. |
|  |  | """ |
|  |  | return not self.is\_private |
|  |  |  |
| Expand Down  Expand Up | | @@ -2271,19 +2320,31 @@ class \_IPv6Constants: |
|  |  |  |
|  |  | \_multicast\_network = IPv6Network('ff00::/8') |
|  |  |  |
|  |  | # Not globally reachable address blocks listed on |
|  |  | # https://www.iana.org/assignments/iana-ipv6-special-registry/iana-ipv6-special-registry.xhtml |
|  |  | \_private\_networks = [ |
|  |  | IPv6Network('::1/128'), |
|  |  | IPv6Network('::/128'), |
|  |  | IPv6Network('::ffff:0:0/96'), |
|  |  | IPv6Network('64:ff9b:1::/48'), |
|  |  | IPv6Network('100::/64'), |
|  |  | IPv6Network('2001::/23'), |
|  |  | IPv6Network('2001:2::/48'), |
|  |  | IPv6Network('2001:db8::/32'), |
|  |  | IPv6Network('2001:10::/28'), |
|  |  | # IANA says N/A, let's consider it not globally reachable to be safe |
|  |  | IPv6Network('2002::/16'), |
|  |  | IPv6Network('fc00::/7'), |
|  |  | IPv6Network('fe80::/10'), |
|  |  | ] |
|  |  |  |
|  |  | \_private\_networks\_exceptions = [ |
|  |  | IPv6Network('2001:1::1/128'), |
|  |  | IPv6Network('2001:1::2/128'), |
|  |  | IPv6Network('2001:3::/32'), |
|  |  | IPv6Network('2001:4:112::/48'), |
|  |  | IPv6Network('2001:20::/28'), |
|  |  | IPv6Network('2001:30::/28'), |
|  |  | ] |
|  |  |  |
|  |  | \_reserved\_networks = [ |
|  |  | IPv6Network('::/8'), IPv6Network('100::/8'), |
|  |  | IPv6Network('200::/7'), IPv6Network('400::/6'), |
| Expand Down | |  |

21 changes: 20 additions & 1 deletion

21
[Lib/test/test\_ipaddress.py](#diff-75d091371807896a8a66871de0fae89ad932066b2c4b73f9278e549ef25826c7 "Lib/test/test_ipaddress.py")

Show comments

[View file](/python/cpython/blob/ba431579efdcbaed7a96f2ac4ea0775879a332fb/Lib/test/test_ipaddress.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2269,6 +2269,10 @@ def testReservedIpv4(self): |
|  |  | self.assertEqual(True, ipaddress.ip\_address( |
|  |  | '172.31.255.255').is\_private) |
|  |  | self.assertEqual(False, ipaddress.ip\_address('172.32.0.0').is\_private) |
|  |  | self.assertFalse(ipaddress.ip\_address('192.0.0.0').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('192.0.0.9').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('192.0.0.10').is\_global) |
|  |  | self.assertFalse(ipaddress.ip\_address('192.0.0.255').is\_global) |
|  |  |  |
|  |  | self.assertEqual(True, |
|  |  | ipaddress.ip\_address('169.254.100.200').is\_link\_local) |
| Expand All | | @@ -2294,6 +2298,7 @@ def testPrivateNetworks(self): |
|  |  | self.assertEqual(True, ipaddress.ip\_network("169.254.0.0/16").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("172.16.0.0/12").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("192.0.0.0/29").is\_private) |
|  |  | self.assertEqual(False, ipaddress.ip\_network("192.0.0.9/32").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("192.0.0.170/31").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("192.0.2.0/24").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("192.168.0.0/16").is\_private) |
| Expand All | | @@ -2310,8 +2315,8 @@ def testPrivateNetworks(self): |
|  |  | self.assertEqual(True, ipaddress.ip\_network("::/128").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("::ffff:0:0/96").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("100::/64").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("2001::/23").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("2001:2::/48").is\_private) |
|  |  | self.assertEqual(False, ipaddress.ip\_network("2001:3::/48").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("2001:db8::/32").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("2001:10::/28").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("fc00::/7").is\_private) |
| Expand Down  Expand Up | | @@ -2390,6 +2395,20 @@ def testReservedIpv6(self): |
|  |  | self.assertEqual(True, ipaddress.ip\_address('0::0').is\_unspecified) |
|  |  | self.assertEqual(False, ipaddress.ip\_address('::1').is\_unspecified) |
|  |  |  |
|  |  | self.assertFalse(ipaddress.ip\_address('64:ff9b:1::').is\_global) |
|  |  | self.assertFalse(ipaddress.ip\_address('2001::').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('2001:1::1').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('2001:1::2').is\_global) |
|  |  | self.assertFalse(ipaddress.ip\_address('2001:2::').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('2001:3::').is\_global) |
|  |  | self.assertFalse(ipaddress.ip\_address('2001:4::').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('2001:4:112::').is\_global) |
|  |  | self.assertFalse(ipaddress.ip\_address('2001:10::').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('2001:20::').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('2001:30::').is\_global) |
|  |  | self.assertFalse(ipaddress.ip\_address('2001:40::').is\_global) |
|  |  | self.assertFalse(ipaddress.ip\_address('2002::').is\_global) |
|  |  |  |
|  |  | # some generic IETF reserved addresses |
|  |  | self.assertEqual(True, ipaddress.ip\_address('100::').is\_reserved) |
|  |  | self.assertEqual(True, ipaddress.ip\_network('4000::1/128').is\_reserved) |
| Expand Down | |  |

9 changes: 9 additions & 0 deletions

9
[Misc/NEWS.d/next/Library/2024-03-14-01-38-44.gh-issue-113171.VFnObz.rst](#diff-2d6ca0985b215bccb49c607530d008bc3014490e8ac3d6b3e51f32aa94f2c1d7 "Misc/NEWS.d/next/Library/2024-03-14-01-38-44.gh-issue-113171.VFnObz.rst")

Show comments

[View file](/python/cpython/blob/ba431579efdcbaed7a96f2ac4ea0775879a332fb/Misc/NEWS.d/next/Library/2024-03-14-01-38-44.gh-issue-113171.VFnObz.rst)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -0,0 +1,9 @@ |
|  |  | Fixed various false positives and false negatives in |
|  |  |  |
|  |  | \* :attr:`ipaddress.IPv4Address.is\_private` (see these docs for details) |
|  |  | \* :attr:`ipaddress.IPv4Address.is\_global` |
|  |  | \* :attr:`ipaddress.IPv6Address.is\_private` |
|  |  | \* :attr:`ipaddress.IPv6Address.is\_global` |
|  |  |  |
|  |  | Also in the corresponding :class:`ipaddress.IPv4Network` and :class:`ipaddress.IPv6Network` |
|  |  | attributes. |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `ba43157`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpython%2Fcpython%2Fcommit%2Fba431579efdcbaed7a96f2ac4ea0775879a332fb) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.openwall.com_b527244d_20250110_175729.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](../../../2024/06/20/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <b5876539-f429-4fd9-9efb-4da4b1c72d24@oracle.com>
Date: Mon, 17 Jun 2024 09:32:12 -0700
From: Alan Coopersmith <alan.coopersmith@...cle.com>
To: oss-security@...ts.openwall.com
Subject: Fwd: [Security-announce][CVE-2024-4032] Incorrect IPv4 and IPv6
 private ranges

-------- Forwarded Message --------
Subject: 	[Security-announce][CVE-2024-4032] Incorrect IPv4 and IPv6 private ranges
Date: 	Mon, 17 Jun 2024 09:01:18 -0500
From: 	Seth Larson <seth@...hon.org>
Reply-To: 	security-sig@...hon.org
To: 	security-announce@...hon.org

The “ipaddress” module contained incorrect information about whether certain IPv4 and IPv6 addresses were designated as “globally reachable” or “private”. This affected the 'is_private' and 'is_global' properties of the ipaddress.IPv4Address, ipaddress.IPv4Network, ipaddress.IPv6Address, and ipaddress.IPv6Network classes, where values wouldn’t be returned in accordance with the latest information from the IANA Special-Purpose Address Registries.

CPython 3.12.4 and 3.13.0a6 contain updated information from these registries and thus have the intended behavior.

Severity: Medium

References

   * <https://github.com/python/cpython/issues/113171>
   * <https://github.com/python/cpython/pull/113179>
   * <https://www.iana.org/assignments/iana-ipv4-special-registry/iana-ipv4-special-registry.xhtml>
   * <https://www.iana.org/assignments/iana-ipv6-special-registry/iana-ipv6-special-registry.xhtml>

View attachment "[Attached Message Part](3/1)" of type "text/plain" (292 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from github.com_2797a070_20250110_175736.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpython%2Fcpython%2Fcommit%2Fc62c9e518b784fe44432a3f4fc265fb95b651906)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpython%2Fcpython%2Fcommit%2Fc62c9e518b784fe44432a3f4fc265fb95b651906)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=python%2Fcpython)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[python](/python)
/
**[cpython](/python/cpython)**
Public

* [Notifications](/login?return_to=%2Fpython%2Fcpython) You must be signed in to change notification settings
* [Fork
  30.8k](/login?return_to=%2Fpython%2Fcpython)
* [Star
   64.7k](/login?return_to=%2Fpython%2Fcpython)

* [Code](/python/cpython)
* [Issues
  5k+](/python/cpython/issues)
* [Pull requests
  1.8k](/python/cpython/pulls)
* [Actions](/python/cpython/actions)
* [Projects
  28](/python/cpython/projects)
* [Security](/python/cpython/security)
* [Insights](/python/cpython/pulse)

Additional navigation options

* [Code](/python/cpython)
* [Issues](/python/cpython/issues)
* [Pull requests](/python/cpython/pulls)
* [Actions](/python/cpython/actions)
* [Projects](/python/cpython/projects)
* [Security](/python/cpython/security)
* [Insights](/python/cpython/pulse)

## Commit

[Permalink](/python/cpython/commit/c62c9e518b784fe44432a3f4fc265fb95b651906)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

[3.10] [gh-113171](https://github.com/python/cpython/issues/113171): [gh-65056](https://github.com/python/cpython/issues/65056): Fix "private" (non-global) IP address ran…

[Browse files](/python/cpython/tree/c62c9e518b784fe44432a3f4fc265fb95b651906)
Browse the repository at this point in the history

```
…ges ([GH-113179](https://github.com/python/cpython/pull/113179)) ([GH-113186](https://github.com/python/cpython/pull/113186)) ([GH-118177](https://github.com/python/cpython/pull/118177)) ([GH-118229](https://github.com/python/cpython/pull/118229))

The _private_networks variables, used by various is_private
implementations, were missing some ranges and at the same time had
overly strict ranges (where there are more specific ranges considered
globally reachable by the IANA registries).

This patch updates the ranges with what was missing or otherwise
incorrect.

100.64.0.0/10 is left alone, for now, as it's been made special in [1].

The _address_exclude_many() call returns 8 networks for IPv4, 121
networks for IPv6.

[1] [#61602](https://github.com/python/cpython/issues/61602)

In 3.10 and below, is_private checks whether the network and broadcast
address are both private.
In later versions (where the test wss backported from), it checks
whether they both are in the same private network.

For 0.0.0.0/0, both 0.0.0.0 and 255.225.255.255 are private,
but one is in 0.0.0.0/8 ("This network") and the other in
255.255.255.255/32 ("Limited broadcast").

---------

Co-authored-by: Jakub Stasiak <jakub@stasiak.at>
```

* Loading branch information

[![@encukou](https://avatars.githubusercontent.com/u/302922?s=40&v=4)](/encukou) [![@jstasiak](https://avatars.githubusercontent.com/u/36209?s=40&v=4)](/jstasiak)

[encukou](/python/cpython/commits?author=encukou "View all commits by encukou")
and
[jstasiak](/python/cpython/commits?author=jstasiak "View all commits by jstasiak")
authored
May 7, 2024

1 parent
[2ec7018](/python/cpython/commit/2ec701819134c351fc58582271771b2ef5895896)

commit c62c9e5

 Show file tree

 Hide file tree

Showing
**5 changed files**
with
**184 additions**
and
**22 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* Doc

  + library

    - Doc/library/ipaddress.rst
      [ipaddress.rst](#diff-d9c61a8ece8cc31330309c90fc34330e1c21bc615ad0941aac8ca6af36f99568)
  + whatsnew

    - Doc/whatsnew/3.10.rst
      [3.10.rst](#diff-a68d5b2117cfed2ddb0b199e367c22ce9c1427d4a016277eafddb551ca4f250c)
* Lib

  + Lib/ipaddress.py
    [ipaddress.py](#diff-f67a8b5be6bdc48383d2ab907325a4c75ef998fa7cd0bba382ec2efa7e4f00b5)
  + test

    - Lib/test/test\_ipaddress.py
      [test\_ipaddress.py](#diff-75d091371807896a8a66871de0fae89ad932066b2c4b73f9278e549ef25826c7)
* Misc/NEWS.d/next/Library

  + Misc/NEWS.d/next/Library/2024-03-14-01-38-44.gh-issue-113171.VFnObz.rst
    [2024-03-14-01-38-44.gh-issue-113171.VFnObz.rst](#diff-2d6ca0985b215bccb49c607530d008bc3014490e8ac3d6b3e51f32aa94f2c1d7)

## There are no files selected for viewing

43 changes: 39 additions & 4 deletions

43
[Doc/library/ipaddress.rst](#diff-d9c61a8ece8cc31330309c90fc34330e1c21bc615ad0941aac8ca6af36f99568 "Doc/library/ipaddress.rst")

Show comments

[View file](/python/cpython/blob/c62c9e518b784fe44432a3f4fc265fb95b651906/Doc/library/ipaddress.rst)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -188,18 +188,53 @@ write code that handles both IP versions correctly. Address objects are |
|  |  |  |
|  |  | .. attribute:: is\_private |
|  |  |  |
|  |  | ``True`` if the address is allocated for private networks. See |
|  |  | ``True`` if the address is defined as not globally reachable by |
|  |  | iana-ipv4-special-registry\_ (for IPv4) or iana-ipv6-special-registry\_ |
|  |  | (for IPv6). |
|  |  | (for IPv6) with the following exceptions: |
|  |  |  |
|  |  | \* ``is\_private`` is ``False`` for the shared address space (``100.64.0.0/10``) |
|  |  | \* For IPv4-mapped IPv6-addresses the ``is\_private`` value is determined by the |
|  |  | semantics of the underlying IPv4 addresses and the following condition holds |
|  |  | (see :attr:`IPv6Address.ipv4\_mapped`):: |
|  |  |  |
|  |  | address.is\_private == address.ipv4\_mapped.is\_private |
|  |  |  |
|  |  | ``is\_private`` has value opposite to :attr:`is\_global`, except for the shared address space |
|  |  | (``100.64.0.0/10`` range) where they are both ``False``. |
|  |  |  |
|  |  | .. versionchanged:: 3.10.15 |
|  |  |  |
|  |  | Fixed some false positives and false negatives. |
|  |  |  |
|  |  | \* ``192.0.0.0/24`` is considered private with the exception of ``192.0.0.9/32`` and |
|  |  | ``192.0.0.10/32`` (previously: only the ``192.0.0.0/29`` sub-range was considered private). |
|  |  | \* ``64:ff9b:1::/48`` is considered private. |
|  |  | \* ``2002::/16`` is considered private. |
|  |  | \* There are exceptions within ``2001::/23`` (otherwise considered private): ``2001:1::1/128``, |
|  |  | ``2001:1::2/128``, ``2001:3::/32``, ``2001:4:112::/48``, ``2001:20::/28``, ``2001:30::/28``. |
|  |  | The exceptions are not considered private. |
|  |  |  |
|  |  | .. attribute:: is\_global |
|  |  |  |
|  |  | ``True`` if the address is allocated for public networks. See |
|  |  | ``True`` if the address is defined as globally reachable by |
|  |  | iana-ipv4-special-registry\_ (for IPv4) or iana-ipv6-special-registry\_ |
|  |  | (for IPv6). |
|  |  | (for IPv6) with the following exception: |
|  |  |  |
|  |  | For IPv4-mapped IPv6-addresses the ``is\_private`` value is determined by the |
|  |  | semantics of the underlying IPv4 addresses and the following condition holds |
|  |  | (see :attr:`IPv6Address.ipv4\_mapped`):: |
|  |  |  |
|  |  | address.is\_global == address.ipv4\_mapped.is\_global |
|  |  |  |
|  |  | ``is\_global`` has value opposite to :attr:`is\_private`, except for the shared address space |
|  |  | (``100.64.0.0/10`` range) where they are both ``False``. |
|  |  |  |
|  |  | .. versionadded:: 3.4 |
|  |  |  |
|  |  | .. versionchanged:: 3.10.15 |
|  |  |  |
|  |  | Fixed some false positives and false negatives, see :attr:`is\_private` for details. |
|  |  |  |
|  |  | .. attribute:: is\_unspecified |
|  |  |  |
|  |  | ``True`` if the address is unspecified. See :RFC:`5735` (for IPv4) |
| Expand Down | |  |

9 changes: 9 additions & 0 deletions

9
[Doc/whatsnew/3.10.rst](#diff-a68d5b2117cfed2ddb0b199e367c22ce9c1427d4a016277eafddb551ca4f250c "Doc/whatsnew/3.10.rst")

Show comments

[View file](/python/cpython/blob/c62c9e518b784fe44432a3f4fc265fb95b651906/Doc/whatsnew/3.10.rst)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -2348,3 +2348,12 @@ tarfile |
|  |  | :exc:`DeprecationWarning`. |
|  |  | In Python 3.14, the default will switch to ``'data'``. |
|  |  | (Contributed by Petr Viktorin in :pep:`706`.) |
|  |  |  |
|  |  | Notable changes in 3.10.15 |
|  |  | ========================== |
|  |  |  |
|  |  | ipaddress |
|  |  | --------- |
|  |  |  |
|  |  | \* Fixed ``is\_global`` and ``is\_private`` behavior in ``IPv4Address``, |
|  |  | ``IPv6Address``, ``IPv4Network`` and ``IPv6Network``. |

93 changes: 75 additions & 18 deletions

93
[Lib/ipaddress.py](#diff-f67a8b5be6bdc48383d2ab907325a4c75ef998fa7cd0bba382ec2efa7e4f00b5 "Lib/ipaddress.py")

Show comments

[View file](/python/cpython/blob/c62c9e518b784fe44432a3f4fc265fb95b651906/Lib/ipaddress.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1323,18 +1323,41 @@ def is\_reserved(self): |
|  |  | @property |
|  |  | @functools.lru\_cache() |
|  |  | def is\_private(self): |
|  |  | """Test if this address is allocated for private networks. |
|  |  | """``True`` if the address is defined as not globally reachable by |
|  |  | iana-ipv4-special-registry\_ (for IPv4) or iana-ipv6-special-registry\_ |
|  |  | (for IPv6) with the following exceptions: |
|  |  |  |
|  |  | Returns: |
|  |  | A boolean, True if the address is reserved per |
|  |  | iana-ipv4-special-registry. |
|  |  | \* ``is\_private`` is ``False`` for ``100.64.0.0/10`` |
|  |  | \* For IPv4-mapped IPv6-addresses the ``is\_private`` value is determined by the |
|  |  | semantics of the underlying IPv4 addresses and the following condition holds |
|  |  | (see :attr:`IPv6Address.ipv4\_mapped`):: |
|  |  |  |
|  |  | address.is\_private == address.ipv4\_mapped.is\_private |
|  |  |  |
|  |  | ``is\_private`` has value opposite to :attr:`is\_global`, except for the ``100.64.0.0/10`` |
|  |  | IPv4 range where they are both ``False``. |
|  |  | """ |
|  |  | return any(self in net for net in self.\_constants.\_private\_networks) |
|  |  | return ( |
|  |  | any(self in net for net in self.\_constants.\_private\_networks) |
|  |  | and all(self not in net for net in self.\_constants.\_private\_networks\_exceptions) |
|  |  | ) |
|  |  |  |
|  |  | @property |
|  |  | @functools.lru\_cache() |
|  |  | def is\_global(self): |
|  |  | """``True`` if the address is defined as globally reachable by |
|  |  | iana-ipv4-special-registry\_ (for IPv4) or iana-ipv6-special-registry\_ |
|  |  | (for IPv6) with the following exception: |
|  |  |  |
|  |  | For IPv4-mapped IPv6-addresses the ``is\_private`` value is determined by the |
|  |  | semantics of the underlying IPv4 addresses and the following condition holds |
|  |  | (see :attr:`IPv6Address.ipv4\_mapped`):: |
|  |  |  |
|  |  | address.is\_global == address.ipv4\_mapped.is\_global |
|  |  |  |
|  |  | ``is\_global`` has value opposite to :attr:`is\_private`, except for the ``100.64.0.0/10`` |
|  |  | IPv4 range where they are both ``False``. |
|  |  | """ |
|  |  | return self not in self.\_constants.\_public\_network and not self.is\_private |
|  |  |  |
|  |  | @property |
| Expand Down  Expand Up | | @@ -1538,13 +1561,15 @@ class \_IPv4Constants: |
|  |  |  |
|  |  | \_public\_network = IPv4Network('100.64.0.0/10') |
|  |  |  |
|  |  | # Not globally reachable address blocks listed on |
|  |  | # https://www.iana.org/assignments/iana-ipv4-special-registry/iana-ipv4-special-registry.xhtml |
|  |  | \_private\_networks = [ |
|  |  | IPv4Network('0.0.0.0/8'), |
|  |  | IPv4Network('10.0.0.0/8'), |
|  |  | IPv4Network('127.0.0.0/8'), |
|  |  | IPv4Network('169.254.0.0/16'), |
|  |  | IPv4Network('172.16.0.0/12'), |
|  |  | IPv4Network('192.0.0.0/29'), |
|  |  | IPv4Network('192.0.0.0/24'), |
|  |  | IPv4Network('192.0.0.170/31'), |
|  |  | IPv4Network('192.0.2.0/24'), |
|  |  | IPv4Network('192.168.0.0/16'), |
| Expand All | | @@ -1555,6 +1580,11 @@ class \_IPv4Constants: |
|  |  | IPv4Network('255.255.255.255/32'), |
|  |  | ] |
|  |  |  |
|  |  | \_private\_networks\_exceptions = [ |
|  |  | IPv4Network('192.0.0.9/32'), |
|  |  | IPv4Network('192.0.0.10/32'), |
|  |  | ] |
|  |  |  |
|  |  | \_reserved\_network = IPv4Network('240.0.0.0/4') |
|  |  |  |
|  |  | \_unspecified\_address = IPv4Address('0.0.0.0') |
| Expand Down  Expand Up | | @@ -1996,27 +2026,42 @@ def is\_site\_local(self): |
|  |  | @property |
|  |  | @functools.lru\_cache() |
|  |  | def is\_private(self): |
|  |  | """Test if this address is allocated for private networks. |
|  |  | """``True`` if the address is defined as not globally reachable by |
|  |  | iana-ipv4-special-registry\_ (for IPv4) or iana-ipv6-special-registry\_ |
|  |  | (for IPv6) with the following exceptions: |
|  |  |  |
|  |  | Returns: |
|  |  | A boolean, True if the address is reserved per |
|  |  | iana-ipv6-special-registry, or is ipv4\_mapped and is |
|  |  | reserved in the iana-ipv4-special-registry. |
|  |  | \* ``is\_private`` is ``False`` for ``100.64.0.0/10`` |
|  |  | \* For IPv4-mapped IPv6-addresses the ``is\_private`` value is determined by the |
|  |  | semantics of the underlying IPv4 addresses and the following condition holds |
|  |  | (see :attr:`IPv6Address.ipv4\_mapped`):: |
|  |  |  |
|  |  | address.is\_private == address.ipv4\_mapped.is\_private |
|  |  |  |
|  |  | ``is\_private`` has value opposite to :attr:`is\_global`, except for the ``100.64.0.0/10`` |
|  |  | IPv4 range where they are both ``False``. |
|  |  | """ |
|  |  | ipv4\_mapped = self.ipv4\_mapped |
|  |  | if ipv4\_mapped is not None: |
|  |  | return ipv4\_mapped.is\_private |
|  |  | return any(self in net for net in self.\_constants.\_private\_networks) |
|  |  | return ( |
|  |  | any(self in net for net in self.\_constants.\_private\_networks) |
|  |  | and all(self not in net for net in self.\_constants.\_private\_networks\_exceptions) |
|  |  | ) |
|  |  |  |
|  |  | @property |
|  |  | def is\_global(self): |
|  |  | """Test if this address is allocated for public networks. |
|  |  | """``True`` if the address is defined as globally reachable by |
|  |  | iana-ipv4-special-registry\_ (for IPv4) or iana-ipv6-special-registry\_ |
|  |  | (for IPv6) with the following exception: |
|  |  |  |
|  |  | Returns: |
|  |  | A boolean, true if the address is not reserved per |
|  |  | iana-ipv6-special-registry. |
|  |  | For IPv4-mapped IPv6-addresses the ``is\_private`` value is determined by the |
|  |  | semantics of the underlying IPv4 addresses and the following condition holds |
|  |  | (see :attr:`IPv6Address.ipv4\_mapped`):: |
|  |  |  |
|  |  | address.is\_global == address.ipv4\_mapped.is\_global |
|  |  |  |
|  |  | ``is\_global`` has value opposite to :attr:`is\_private`, except for the ``100.64.0.0/10`` |
|  |  | IPv4 range where they are both ``False``. |
|  |  | """ |
|  |  | return not self.is\_private |
|  |  |  |
| Expand Down  Expand Up | | @@ -2257,19 +2302,31 @@ class \_IPv6Constants: |
|  |  |  |
|  |  | \_multicast\_network = IPv6Network('ff00::/8') |
|  |  |  |
|  |  | # Not globally reachable address blocks listed on |
|  |  | # https://www.iana.org/assignments/iana-ipv6-special-registry/iana-ipv6-special-registry.xhtml |
|  |  | \_private\_networks = [ |
|  |  | IPv6Network('::1/128'), |
|  |  | IPv6Network('::/128'), |
|  |  | IPv6Network('::ffff:0:0/96'), |
|  |  | IPv6Network('64:ff9b:1::/48'), |
|  |  | IPv6Network('100::/64'), |
|  |  | IPv6Network('2001::/23'), |
|  |  | IPv6Network('2001:2::/48'), |
|  |  | IPv6Network('2001:db8::/32'), |
|  |  | IPv6Network('2001:10::/28'), |
|  |  | # IANA says N/A, let's consider it not globally reachable to be safe |
|  |  | IPv6Network('2002::/16'), |
|  |  | IPv6Network('fc00::/7'), |
|  |  | IPv6Network('fe80::/10'), |
|  |  | ] |
|  |  |  |
|  |  | \_private\_networks\_exceptions = [ |
|  |  | IPv6Network('2001:1::1/128'), |
|  |  | IPv6Network('2001:1::2/128'), |
|  |  | IPv6Network('2001:3::/32'), |
|  |  | IPv6Network('2001:4:112::/48'), |
|  |  | IPv6Network('2001:20::/28'), |
|  |  | IPv6Network('2001:30::/28'), |
|  |  | ] |
|  |  |  |
|  |  | \_reserved\_networks = [ |
|  |  | IPv6Network('::/8'), IPv6Network('100::/8'), |
|  |  | IPv6Network('200::/7'), IPv6Network('400::/6'), |
| Expand Down | |  |

52 changes: 52 additions & 0 deletions

52
[Lib/test/test\_ipaddress.py](#diff-75d091371807896a8a66871de0fae89ad932066b2c4b73f9278e549ef25826c7 "Lib/test/test_ipaddress.py")

Show comments

[View file](/python/cpython/blob/c62c9e518b784fe44432a3f4fc265fb95b651906/Lib/test/test_ipaddress.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2263,6 +2263,10 @@ def testReservedIpv4(self): |
|  |  | self.assertEqual(True, ipaddress.ip\_address( |
|  |  | '172.31.255.255').is\_private) |
|  |  | self.assertEqual(False, ipaddress.ip\_address('172.32.0.0').is\_private) |
|  |  | self.assertFalse(ipaddress.ip\_address('192.0.0.0').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('192.0.0.9').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('192.0.0.10').is\_global) |
|  |  | self.assertFalse(ipaddress.ip\_address('192.0.0.255').is\_global) |
|  |  |  |
|  |  | self.assertEqual(True, |
|  |  | ipaddress.ip\_address('169.254.100.200').is\_link\_local) |
| Expand All | | @@ -2278,6 +2282,40 @@ def testReservedIpv4(self): |
|  |  | self.assertEqual(False, ipaddress.ip\_address('128.0.0.0').is\_loopback) |
|  |  | self.assertEqual(True, ipaddress.ip\_network('0.0.0.0').is\_unspecified) |
|  |  |  |
|  |  | def testPrivateNetworks(self): |
|  |  | self.assertEqual(True, ipaddress.ip\_network("0.0.0.0/0").is\_private) |
|  |  | self.assertEqual(False, ipaddress.ip\_network("1.0.0.0/8").is\_private) |
|  |  |  |
|  |  | self.assertEqual(True, ipaddress.ip\_network("0.0.0.0/8").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("10.0.0.0/8").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("127.0.0.0/8").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("169.254.0.0/16").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("172.16.0.0/12").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("192.0.0.0/29").is\_private) |
|  |  | self.assertEqual(False, ipaddress.ip\_network("192.0.0.9/32").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("192.0.0.170/31").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("192.0.2.0/24").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("192.168.0.0/16").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("198.18.0.0/15").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("198.51.100.0/24").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("203.0.113.0/24").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("240.0.0.0/4").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("255.255.255.255/32").is\_private) |
|  |  |  |
|  |  | self.assertEqual(False, ipaddress.ip\_network("::/0").is\_private) |
|  |  | self.assertEqual(False, ipaddress.ip\_network("::ff/128").is\_private) |
|  |  |  |
|  |  | self.assertEqual(True, ipaddress.ip\_network("::1/128").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("::/128").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("::ffff:0:0/96").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("100::/64").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("2001:2::/48").is\_private) |
|  |  | self.assertEqual(False, ipaddress.ip\_network("2001:3::/48").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("2001:db8::/32").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("2001:10::/28").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("fc00::/7").is\_private) |
|  |  | self.assertEqual(True, ipaddress.ip\_network("fe80::/10").is\_private) |
|  |  |  |
|  |  | def testReservedIpv6(self): |
|  |  |  |
|  |  | self.assertEqual(True, ipaddress.ip\_network('ffff::').is\_multicast) |
| Expand Down  Expand Up | | @@ -2351,6 +2389,20 @@ def testReservedIpv6(self): |
|  |  | self.assertEqual(True, ipaddress.ip\_address('0::0').is\_unspecified) |
|  |  | self.assertEqual(False, ipaddress.ip\_address('::1').is\_unspecified) |
|  |  |  |
|  |  | self.assertFalse(ipaddress.ip\_address('64:ff9b:1::').is\_global) |
|  |  | self.assertFalse(ipaddress.ip\_address('2001::').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('2001:1::1').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('2001:1::2').is\_global) |
|  |  | self.assertFalse(ipaddress.ip\_address('2001:2::').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('2001:3::').is\_global) |
|  |  | self.assertFalse(ipaddress.ip\_address('2001:4::').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('2001:4:112::').is\_global) |
|  |  | self.assertFalse(ipaddress.ip\_address('2001:10::').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('2001:20::').is\_global) |
|  |  | self.assertTrue(ipaddress.ip\_address('2001:30::').is\_global) |
|  |  | self.assertFalse(ipaddress.ip\_address('2001:40::').is\_global) |
|  |  | self.assertFalse(ipaddress.ip\_address('2002::').is\_global) |
|  |  |  |
|  |  | # some generic IETF reserved addresses |
|  |  | self.assertEqual(True, ipaddress.ip\_address('100::').is\_reserved) |
|  |  | self.assertEqual(True, ipaddress.ip\_network('4000::1/128').is\_reserved) |
| Expand Down | |  |

9 changes: 9 additions & 0 deletions

9
[Misc/NEWS.d/next/Library/2024-03-14-01-38-44.gh-issue-113171.VFnObz.rst](#diff-2d6ca0985b215bccb49c607530d008bc3014490e8ac3d6b3e51f32aa94f2c1d7 "Misc/NEWS.d/next/Library/2024-03-14-01-38-44.gh-issue-113171.VFnObz.rst")

Show comments

[View file](/python/cpython/blob/c62c9e518b784fe44432a3f4fc265fb95b651906/Misc/NEWS.d/next/Library/2024-03-14-01-38-44.gh-issue-113171.VFnObz.rst)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -0,0 +1,9 @@ |
|  |  | Fixed various false positives and false negatives in |
|  |  |  |
|  |  | \* :attr:`ipaddress.IPv4Address.is\_private` (see these docs for details) |
|  |  | \* :attr:`ipaddress.IPv4Address.is\_global` |
|  |  | \* :attr:`ipaddress.IPv6Address.is\_private` |
|  |  | \* :attr:`ipaddress.IPv6Address.is\_global` |
|  |  |  |
|  |  | Also in the corresponding :class:`ipaddress.IPv4Network` and :class:`ipaddress.IPv6Network` |
|  |  | attributes. |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `c62c9e5`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpython%2Fcpython%2Fcommit%2Fc62c9e518b784fe44432a3f4fc265fb95b651906) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


