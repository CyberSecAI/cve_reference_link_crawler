Based on the provided information, here's an analysis of CVE-2024-8662:

**Root Cause of Vulnerability:**

- The vulnerability is a Reflected Cross-Site Scripting (XSS) issue.
- The plugin uses `add_query_arg` without proper output escaping when constructing URLs, specifically within the `settings-page.php` file.

**Weaknesses/Vulnerabilities Present:**

- **Reflected XSS:** The plugin fails to sanitize or escape user-controlled input (specifically via the query arguments added by `add_query_arg`) before including it in the HTML output. This allows an attacker to inject malicious JavaScript code into the page.
- **Lack of Output Escaping:** The use of `add_query_arg` to construct URLs without escaping the result leads to the injection of arbitrary HTML or JavaScript.

**Impact of Exploitation:**

- An attacker can inject malicious scripts into the page that is rendered to a user.
- If a user clicks a crafted link (or navigates to a page with a crafted URL), the injected script will execute in the user's browser within the context of the vulnerable website.
- This could lead to various impacts, such as:
  - Stealing cookies or session tokens
  - Redirecting users to malicious websites
  - Defacing the website
  - Performing actions on behalf of the user.

**Attack Vectors:**

- The primary attack vector is through crafted URLs containing malicious JavaScript code within the query string.
- The attacker has to trick a user into clicking a malicious link that includes the crafted URL with the malicious payload.

**Required Attacker Capabilities/Position:**

- **Unauthenticated:** The attacker doesn't need to have an account or any special privileges on the website.
- **User Interaction:** The attacker needs to convince a user to click a malicious link or visit a specifically crafted URL.

**Additional Details:**

- The vulnerable code is found in `koko-analytics/tags/1.3.12/src/views/settings-page.php`
- Specifically, the following lines are vulnerable:
    - `$public_dashboard_url = add_query_arg(array('koko-analytics-dashboard' => 1), home_url());`
    - `<form method="POST" action="<?php echo add_query_arg(array('koko_analytics_action' => 'save_settings')); ?>">`
    - `<?php echo sprintf(__('Set to "yes" if you want your dashboard to be publicly accessible. With this setting enabled, you can <a href="%s">find your public dashboard here</a>.', 'koko-analytics'), $public_dashboard_url); ?>`
- The fix for this vulnerability is included in version 1.3.13 of the plugin.
- The fix involves using `esc_html` or `esc_attr` to properly escape the output of the add_query_arg function.

The vulnerability was fixed by escaping the output of `add_query_arg` and by escaping variables used within the HTML markup, like `$key` and `$value` used within the `<option>` tag in the `select` element.