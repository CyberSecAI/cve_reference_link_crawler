- **Root cause of vulnerability:** The plugin does not properly sanitize and escape some of its settings. This allows high privilege users to inject malicious scripts into the plugin's settings.
- **Weaknesses/vulnerabilities present:** Stored Cross-Site Scripting (XSS). Input fields for "Title", "Label Show", and "Label Hide" are not sanitized or escaped allowing the injection of arbitrary HTML and JavaScript code.
- **Impact of exploitation:** An attacker can execute arbitrary JavaScript code in the context of the victim's browser. This could lead to session hijacking, defacement, or redirection to malicious websites.
- **Attack vectors:** The attacker needs to be a high privilege user (such as admin) and needs access to the plugin settings page.  The attacker injects the XSS payload into the plugin settings fields. The XSS is triggered when a page containing a table of content block is rendered.
- **Required attacker capabilities/position:** The attacker needs to have administrator-level access or similar high-privilege access to the WordPress site to modify plugin settings.