
Commit Information:
------------------
Author: Shruti Bihani  1689239948 +0000
Date: Android Build Coastguard Worker  1694123677 +0000
Bug ID: Bug: 243381410
Commit Message:
--------------
Fix heap-use-after-free issue flagged by fuzzer test.A data member of class MtpFfsHandle is being accessed after the class object has been freed in the fuzzer. The method accessing the data member is running in a separate thread that gets detached from its parent. Using a conditional variable with an atomic int predicate in the close() function to ensure the detached thread's execution has completed before freeing the object fixes the issue without blocking the processing mid-way.Bug: 243381410Test: Build mtp\_handle\_fuzzer and run on the target device(cherry picked from commit 50bf46a3f62136386548a9187a749936bda3ee8f)(cherry picked from https://googleplex-android-review.googlesource.com/q/commit:05dc1c083095ebee0faa20498153eb466082ace0)Merged-In: I41dde165a5eba151c958b81417d9e1065af1b411Change-Id: I41dde165a5eba151c958b81417d9e1065af1b411
