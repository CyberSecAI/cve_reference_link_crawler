[Skip to main content](#main)Why Spring

* [Overview](/why-spring)
* [Microservices](/microservices)
* [Reactive](/reactive)
* [Event Driven](/event-driven)
* [Cloud](/cloud)
* [Web Applications](/web-applications)
* [Serverless](/serverless)
* [Batch](/batch)
Learn

* [Overview](/learn)
* [Quickstart](/quickstart)
* [Guides](/guides)
* [Blog](/blog)
Projects

* [Overview](/projects)
* [Spring Boot](/projects/spring-boot)
* [Spring Framework](/projects/spring-framework)
* [Spring Cloud](/projects/spring-cloud)
* [Spring Cloud Data Flow](/projects/spring-cloud-dataflow)
* [Spring Data](/projects/spring-data)
* [Spring Integration](/projects/spring-integration)
* [Spring Batch](/projects/spring-batch)
* [Spring Security](/projects/spring-security)
* [Spring AI](/projects/spring-ai)
* [View all projects](/projects)
* [Release Calendar](/projects#release-calendar)
* DEVELOPMENT TOOLS
* [Spring Tools 4](/tools)
* [Spring Initializr](https://start.spring.io/)
Academy

* [Courses](https://spring.academy/courses)
* [Get Certified](https://spring.academy/learning-path)
Solutions

* [Overview](/solutions)
* [Tanzu Spring](/support)
* [Spring Consulting](/consulting)
* [Spring Academy](https://spring.academy/)
* [Security Advisories](/security)
Community

* [Overview](/community)
* [Events](/events)
* [Authors](/authors)
# [Spring Security Advisories](/security)

[RSS feed](/security.atom)
# CVE-2022-31690: Privilege Escalation in spring-security-oauth2-client

HIGH | OCTOBER 31, 2022 | CVE-2022-31690
# Description

Spring Security, versions **5.7** prior to **5.7.5**, and **5.6** prior to **5.6.9**, and older unsupported versions could be susceptible to a privilege escalation under certain conditions. A malicious user or attacker can modify a request initiated by the Client (via the browser) to the Authorization Server which can lead to a privilege escalation on the subsequent approval. This scenario can happen if the Authorization Server responds with an OAuth2 Access Token Response containing an empty scope list (per [RFC 6749, Section 5.1](https://www.rfc-editor.org/rfc/rfc6749#section-5.1)) on the subsequent request to the token endpoint to obtain the access token.

This vulnerability exposes applications that meet all of the following requirements:

* Act in the role of a Login Client (e.g. `http.oauth2Login()`)
* Use one or more authorization rules with authorities mapped from authorized scopes (e.g. `anyRequest().hasAuthority("SCOPE_message.write")`) in the client application
* Register an authorization server that responds with empty scopes list (per RFC 6749, Section 5.1)

This vulnerability **does not** expose applications that:

* Act in the role of a Resource Server only (e.g. `http.oauth2ResourceServer()`)
* Use authorization rules with authorities not mapped from authorized scopes (e.g. `anyRequest().hasAuthority("ROLE_USER")`) in the client application

# Affected Spring Products and Versions

* Spring Security
  + 5.7 to 5.7.4
  + 5.6 to 5.6.8
  + Older, unsupported versions are also affected

# Mitigation

Users of affected versions should apply the following mitigation: Spring Security 5.7 to 5.7.5, Spring Security 5.6 to 5.6.9. Older versions should upgrade to a supported branch. There are no other mitigation steps required. Releases that have fixed this issue include:

* Spring Security
  + 5.7.5
  + 5.6.9

# Credit

This issue was identified and responsibly reported by Tobias Soloschenko (@klopfdreh) from Apache Software Foundation.

# References

* <https://docs.spring.io/spring-security/reference/servlet/oauth2/login/index.html>
* <https://docs.spring.io/spring-security/reference/reactive/oauth2/login/index.html>
* <https://github.com/spring-projects/spring-security-samples/blob/4638e1e428ee2ddab234199eb3b67b9c94dfa08b/servlet/spring-boot/java/oauth2/webclient/src/main/java/example/SecurityConfiguration.java#L48>
* <https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N/E:P/RL:O/RC:C/CR:M/IR:M/AR:X/MAV:N/MAC:L/MPR:L/MUI:N/MS:U/MC:H/MI:H/MA:N&version=3.1>

# History

* 2022-10-31: Initial vulnerability report published.
## Reporting a vulnerability

To report a security vulnerability for a project within the Spring portfolio, see the [Security Policy](/security-policy)

![](/img/extra/footer.svg)
## Get ahead

VMware offers training and certification to turbo-charge your progress.

[Learn more](https://spring.academy/)
## Get support

Tanzu Spring offers support and binaries for OpenJDK™, Spring, and Apache Tomcat® in one simple subscription.

[Learn more](/support)
## Upcoming events

Check out all the upcoming events in the Spring community.

[View all](/events)[Why Spring](/why-spring)[Microservices](/microservices)[Reactive](/reactive)[Event Driven](/event-driven)[Cloud](/cloud)[Web Applications](/web-applications)[Serverless](/serverless)[Batch](/batch)[Learn](/learn)[Quickstart](/quickstart)[Guides](/guides)[Blog](/blog)[Community](/community)[Events](/events)[Authors](/authors)[Solutions](/overview)[Tanzu Spring](/support)[Spring Consulting](/consulting)[Spring Academy](https://spring.academy/)[Spring Advisories](/security)[Projects](/projects)[Thank You](/thank-you)
## Get the Spring newsletter

Stay connected with the Spring newsletter

[Subscribe](https://go-vmware.broadcom.com/tnz-spring-newsletter-subscribe)

Copyright © 2005 - 2025 Broadcom. All Rights Reserved. The term "Broadcom" refers to Broadcom Inc. and/or its subsidiaries.
[Terms of Use](https://www.vmware.com/help/legal.html) • [Privacy](https://www.vmware.com/help/privacy.html) • [Trademark Guidelines](/trademarks) • [Your California Privacy Rights](https://www.vmware.com/help/privacy/california-privacy-rights.html)

Apache®, Apache Tomcat®, Apache Kafka®, Apache Cassandra™, and Apache Geode™ are trademarks or registered trademarks of the Apache Software Foundation in the United States and/or other countries. Java™, Java™ SE, Java™ EE, and OpenJDK™ are trademarks of Oracle and/or its affiliates. Kubernetes® is a registered trademark of the Linux Foundation in the United States and other countries. Linux® is the registered trademark of Linus Torvalds in the United States and other countries. Windows® and Microsoft® Azure are registered trademarks of Microsoft Corporation. “AWS” and “Amazon Web Services” are trademarks or registered trademarks of Amazon.com Inc. or its affiliates. All other trademarks and copyrights are property of their respective owners and are only mentioned for informative purposes. Other names may be trademarks of their respective owners.

