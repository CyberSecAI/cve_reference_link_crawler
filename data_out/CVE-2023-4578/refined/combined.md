=== Content from www.mozilla.org_8ea4e939_20250111_043127.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-38

## Security Vulnerabilities fixed in Thunderbird 115.2

Announced
August 29, 2023
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 115.2

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2023-4573: Memory corruption in IPC CanvasTranslator](#CVE-2023-4573)

Reporter
sonakkbi
Impact
high
##### Description

When receiving rendering data over IPC `mStream` could have been destroyed when initialized, which could have led to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1846687](https://bugzilla.mozilla.org/show_bug.cgi?id=1846687)

#### [#CVE-2023-4574: Memory corruption in IPC ColorPickerShownCallback](#CVE-2023-4574)

Reporter
sonakkbi
Impact
high
##### Description

When creating a callback over IPC for showing the Color Picker window, multiple of the same callbacks could have been created at a time and eventually all simultaneously destroyed as soon as one of the callbacks finished. This could have led to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1846688](https://bugzilla.mozilla.org/show_bug.cgi?id=1846688)

#### [#CVE-2023-4575: Memory corruption in IPC FilePickerShownCallback](#CVE-2023-4575)

Reporter
sonakkbi
Impact
high
##### Description

When creating a callback over IPC for showing the File Picker window, multiple of the same callbacks could have been created at a time and eventually all simultaneously destroyed as soon as one of the callbacks finished. This could have led to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1846689](https://bugzilla.mozilla.org/show_bug.cgi?id=1846689)

#### [#CVE-2023-4576: Integer Overflow in RecordedSourceSurfaceCreation](#CVE-2023-4576)

Reporter
fffvr
Impact
high
##### Description

On Windows, an integer overflow could occur in `RecordedSourceSurfaceCreation` which resulted in a heap buffer overflow potentially leaking sensitive data that could have led to a sandbox escape.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1846694](https://bugzilla.mozilla.org/show_bug.cgi?id=1846694)

#### [#CVE-2023-4577: Memory corruption in JIT UpdateRegExpStatics](#CVE-2023-4577)

Reporter
Lukas Bernhard
Impact
high
##### Description

When `UpdateRegExpStatics` attempted to access `initialStringHeap` it could already have been garbage collected prior to entering the function, which could potentially have led to an exploitable crash.

##### References

* [Bug 1847397](https://bugzilla.mozilla.org/show_bug.cgi?id=1847397)

#### [#CVE-2023-4051: Full screen notification obscured by file open dialog](#CVE-2023-4051)

Reporter
Hafiizh
Impact
moderate
##### Description

A website could have obscured the full screen notification by using the file open dialog. This could have led to user confusion and possible spoofing attacks.

##### References

* [Bug 1821884](https://bugzilla.mozilla.org/show_bug.cgi?id=1821884)

#### [#CVE-2023-4578: Error reporting methods in SpiderMonkey could have triggered an Out of Memory Exception](#CVE-2023-4578)

Reporter
Irvan Kurniawan (@sourc7)
Impact
moderate
##### Description

When calling `JS::CheckRegExpSyntax` a Syntax Error could have been set which would end in calling `convertToRuntimeErrorAndClear`. A path in the function could attempt to allocate memory when none is available which would have caused a newly created Out of Memory exception to be mishandled as a Syntax Error.

##### References

* [Bug 1839007](https://bugzilla.mozilla.org/show_bug.cgi?id=1839007)

#### [#CVE-2023-4053: Full screen notification obscured by external program](#CVE-2023-4053)

Reporter
Umar Farooq
Impact
moderate
##### Description

A website could have obscured the full screen notification by using a URL with a scheme handled by an external program, such as a mailto URL. This could have led to user confusion and possible spoofing attacks.

##### References

* [Bug 1839079](https://bugzilla.mozilla.org/show_bug.cgi?id=1839079)

#### [#CVE-2023-4580: Push notifications saved to disk unencrypted](#CVE-2023-4580)

Reporter
Harveer Singh
Impact
moderate
##### Description

Push notifications stored on disk in private browsing mode were not being encrypted potentially allowing the leak of sensitive information.

##### References

* [Bug 1843046](https://bugzilla.mozilla.org/show_bug.cgi?id=1843046)

#### [#CVE-2023-4581: XLL file extensions were downloadable without warnings](#CVE-2023-4581)

Reporter
Umar Farooq (@Puf)
Impact
moderate
##### Description

Excel `.xll` add-in files did not have a blocklist entry in Firefox's executable blocklist which allowed them to be downloaded without any warning of their potential harm.

##### References

* [Bug 1843758](https://bugzilla.mozilla.org/show_bug.cgi?id=1843758)

#### [#CVE-2023-4582: Buffer Overflow in WebGL glGetProgramiv](#CVE-2023-4582)

Reporter
Dohyun Lee (@l33d0hyun) of SSD-Disclosure Labs & DNSLab, Korea Univ.
Impact
low
##### Description

Due to large allocation checks in Angle for glsl shaders being too lenient a buffer overflow could have occured when allocating too much private shader memory on mac OS.
*This bug only affects Firefox on macOS. Other operating systems are unaffected.*

##### References

* [Bug 1773874](https://bugzilla.mozilla.org/show_bug.cgi?id=1773874)

#### [#CVE-2023-4583: Browsing Context potentially not cleared when closing Private Window](#CVE-2023-4583)

Reporter
Thejaka Maldeniya
Impact
low
##### Description

When checking if the Browsing Context had been discarded in `HttpBaseChannel`, if the load group was not available then it was assumed to have already been discarded which was not always the case for private channels after the private session had ended.

##### References

* [Bug 1842030](https://bugzilla.mozilla.org/show_bug.cgi?id=1842030)

#### [#CVE-2023-4584: Memory safety bugs fixed in Firefox 117, Firefox ESR 102.15, Firefox ESR 115.2, Thunderbird 102.15, and Thunderbird 115.2](#CVE-2023-4584)

Reporter
Randell Jesup, Andrew McCreight, the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 116, Firefox ESR 102.14, Firefox ESR 115.1, Thunderbird 102.14, and Thunderbird 115.1. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 117, Firefox ESR 102.15, Firefox ESR 115.2, Thunderbird 102.15, and Thunderbird 115.2](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1843968%2C1845205%2C1846080%2C1846526%2C1847529)

#### [#CVE-2023-4585: Memory safety bugs fixed in Firefox 117, Firefox ESR 115.2, and Thunderbird 115.2](#CVE-2023-4585)

Reporter
Donal Meehan, Sebastian Hengst, and the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 116, Firefox ESR 115.1, and Thunderbird 115.1. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 117, Firefox ESR 115.2, and Thunderbird 115.2](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1751583%2C1833504%2C1841082%2C1847904%2C1848999)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_61f780b1_20250111_043125.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-34

## Security Vulnerabilities fixed in Firefox 117

Announced
August 29, 2023
Impact
high
Products
Firefox
Fixed in

* Firefox 117

This advisory was updated October 24, 2023 to add CVE-2023-5732 which was included in the original release of Firefox 117, but did not appear in the advisory published at that time.

#### [#CVE-2023-4573: Memory corruption in IPC CanvasTranslator](#CVE-2023-4573)

Reporter
sonakkbi
Impact
high
##### Description

When receiving rendering data over IPC `mStream` could have been destroyed when initialized, which could have led to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1846687](https://bugzilla.mozilla.org/show_bug.cgi?id=1846687)

#### [#CVE-2023-4574: Memory corruption in IPC ColorPickerShownCallback](#CVE-2023-4574)

Reporter
sonakkbi
Impact
high
##### Description

When creating a callback over IPC for showing the Color Picker window, multiple of the same callbacks could have been created at a time and eventually all simultaneously destroyed as soon as one of the callbacks finished. This could have led to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1846688](https://bugzilla.mozilla.org/show_bug.cgi?id=1846688)

#### [#CVE-2023-4575: Memory corruption in IPC FilePickerShownCallback](#CVE-2023-4575)

Reporter
sonakkbi
Impact
high
##### Description

When creating a callback over IPC for showing the File Picker window, multiple of the same callbacks could have been created at a time and eventually all simultaneously destroyed as soon as one of the callbacks finished. This could have led to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1846689](https://bugzilla.mozilla.org/show_bug.cgi?id=1846689)

#### [#CVE-2023-4576: Integer Overflow in RecordedSourceSurfaceCreation](#CVE-2023-4576)

Reporter
fffvr
Impact
high
##### Description

On Windows, an integer overflow could occur in `RecordedSourceSurfaceCreation` which resulted in a heap buffer overflow potentially leaking sensitive data that could have led to a sandbox escape.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1846694](https://bugzilla.mozilla.org/show_bug.cgi?id=1846694)

#### [#CVE-2023-4577: Memory corruption in JIT UpdateRegExpStatics](#CVE-2023-4577)

Reporter
Lukas Bernhard
Impact
high
##### Description

When `UpdateRegExpStatics` attempted to access `initialStringHeap` it could already have been garbage collected prior to entering the function, which could potentially have led to an exploitable crash.

##### References

* [Bug 1847397](https://bugzilla.mozilla.org/show_bug.cgi?id=1847397)

#### [#CVE-2023-5732: Address bar spoofing via bidirectional characters](#CVE-2023-5732)

Reporter
Armin Ebert
Impact
moderate
##### Description

An attacker could have created a malicious link using bidirectional characters to spoof the location in the address bar when visited.

##### References

* [Bug 1690979](https://bugzilla.mozilla.org/show_bug.cgi?id=1690979)
* [Bug 1836962](https://bugzilla.mozilla.org/show_bug.cgi?id=1836962)

#### [#CVE-2023-4578: Error reporting methods in SpiderMonkey could have triggered an Out of Memory Exception](#CVE-2023-4578)

Reporter
Irvan Kurniawan (@sourc7)
Impact
moderate
##### Description

When calling `JS::CheckRegExpSyntax` a Syntax Error could have been set which would end in calling `convertToRuntimeErrorAndClear`. A path in the function could attempt to allocate memory when none is available which would have caused a newly created Out of Memory exception to be mishandled as a Syntax Error.

##### References

* [Bug 1839007](https://bugzilla.mozilla.org/show_bug.cgi?id=1839007)

#### [#CVE-2023-4579: Persisted search terms were formatted as URLs](#CVE-2023-4579)

Reporter
Malte Jürgens
Impact
moderate
##### Description

Search queries in the default search engine could appear to have been the currently navigated URL if the search query itself was a well formed URL. This could have led to a site spoofing another if it had been maliciously set as the default search engine.

##### References

* [Bug 1842766](https://bugzilla.mozilla.org/show_bug.cgi?id=1842766)

#### [#CVE-2023-4580: Push notifications saved to disk unencrypted](#CVE-2023-4580)

Reporter
Harveer Singh
Impact
moderate
##### Description

Push notifications stored on disk in private browsing mode were not being encrypted potentially allowing the leak of sensitive information.

##### References

* [Bug 1843046](https://bugzilla.mozilla.org/show_bug.cgi?id=1843046)

#### [#CVE-2023-4581: XLL file extensions were downloadable without warnings](#CVE-2023-4581)

Reporter
Umar Farooq (@Puf)
Impact
moderate
##### Description

Excel `.xll` add-in files did not have a blocklist entry in Firefox's executable blocklist which allowed them to be downloaded without any warning of their potential harm.

##### References

* [Bug 1843758](https://bugzilla.mozilla.org/show_bug.cgi?id=1843758)

#### [#CVE-2023-4582: Buffer Overflow in WebGL glGetProgramiv](#CVE-2023-4582)

Reporter
Dohyun Lee (@l33d0hyun) of SSD-Disclosure Labs & DNSLab, Korea Univ.
Impact
low
##### Description

Due to large allocation checks in Angle for glsl shaders being too lenient a buffer overflow could have occured when allocating too much private shader memory on mac OS.
*This bug only affects Firefox on macOS. Other operating systems are unaffected.*

##### References

* [Bug 1773874](https://bugzilla.mozilla.org/show_bug.cgi?id=1773874)

#### [#CVE-2023-4583: Browsing Context potentially not cleared when closing Private Window](#CVE-2023-4583)

Reporter
Thejaka Maldeniya
Impact
low
##### Description

When checking if the Browsing Context had been discarded in `HttpBaseChannel`, if the load group was not available then it was assumed to have already been discarded which was not always the case for private channels after the private session had ended.

##### References

* [Bug 1842030](https://bugzilla.mozilla.org/show_bug.cgi?id=1842030)

#### [#CVE-2023-4584: Memory safety bugs fixed in Firefox 117, Firefox ESR 102.15, Firefox ESR 115.2, Thunderbird 102.15, and Thunderbird 115.2](#CVE-2023-4584)

Reporter
Randell Jesup, Andrew McCreight, the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 116, Firefox ESR 102.14, Firefox ESR 115.1, Thunderbird 102.14, and Thunderbird 115.1. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 117, Firefox ESR 102.15, Firefox ESR 115.2, Thunderbird 102.15, and Thunderbird 115.2](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1843968%2C1845205%2C1846080%2C1846526%2C1847529)

#### [#CVE-2023-4585: Memory safety bugs fixed in Firefox 117, Firefox ESR 115.2, and Thunderbird 115.2](#CVE-2023-4585)

Reporter
Donal Meehan, Sebastian Hengst, and the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 116, Firefox ESR 115.1, and Thunderbird 115.1. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 117, Firefox ESR 115.2, and Thunderbird 115.2](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1751583%2C1841082%2C1847904%2C1848999)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_e6b091cb_20250111_043126.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-36

## Security Vulnerabilities fixed in Firefox ESR 115.2

Announced
August 29, 2023
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 115.2

#### [#CVE-2023-4573: Memory corruption in IPC CanvasTranslator](#CVE-2023-4573)

Reporter
sonakkbi
Impact
high
##### Description

When receiving rendering data over IPC `mStream` could have been destroyed when initialized, which could have led to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1846687](https://bugzilla.mozilla.org/show_bug.cgi?id=1846687)

#### [#CVE-2023-4574: Memory corruption in IPC ColorPickerShownCallback](#CVE-2023-4574)

Reporter
sonakkbi
Impact
high
##### Description

When creating a callback over IPC for showing the Color Picker window, multiple of the same callbacks could have been created at a time and eventually all simultaneously destroyed as soon as one of the callbacks finished. This could have led to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1846688](https://bugzilla.mozilla.org/show_bug.cgi?id=1846688)

#### [#CVE-2023-4575: Memory corruption in IPC FilePickerShownCallback](#CVE-2023-4575)

Reporter
sonakkbi
Impact
high
##### Description

When creating a callback over IPC for showing the File Picker window, multiple of the same callbacks could have been created at a time and eventually all simultaneously destroyed as soon as one of the callbacks finished. This could have led to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1846689](https://bugzilla.mozilla.org/show_bug.cgi?id=1846689)

#### [#CVE-2023-4576: Integer Overflow in RecordedSourceSurfaceCreation](#CVE-2023-4576)

Reporter
fffvr
Impact
high
##### Description

On Windows, an integer overflow could occur in `RecordedSourceSurfaceCreation` which resulted in a heap buffer overflow potentially leaking sensitive data that could have led to a sandbox escape.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1846694](https://bugzilla.mozilla.org/show_bug.cgi?id=1846694)

#### [#CVE-2023-4577: Memory corruption in JIT UpdateRegExpStatics](#CVE-2023-4577)

Reporter
Lukas Bernhard
Impact
high
##### Description

When `UpdateRegExpStatics` attempted to access `initialStringHeap` it could already have been garbage collected prior to entering the function, which could potentially have led to an exploitable crash.

##### References

* [Bug 1847397](https://bugzilla.mozilla.org/show_bug.cgi?id=1847397)

#### [#CVE-2023-4051: Full screen notification obscured by file open dialog](#CVE-2023-4051)

Reporter
Hafiizh
Impact
moderate
##### Description

A website could have obscured the full screen notification by using the file open dialog. This could have led to user confusion and possible spoofing attacks.

##### References

* [Bug 1821884](https://bugzilla.mozilla.org/show_bug.cgi?id=1821884)

#### [#CVE-2023-4578: Error reporting methods in SpiderMonkey could have triggered an Out of Memory Exception](#CVE-2023-4578)

Reporter
Irvan Kurniawan (@sourc7)
Impact
moderate
##### Description

When calling `JS::CheckRegExpSyntax` a Syntax Error could have been set which would end in calling `convertToRuntimeErrorAndClear`. A path in the function could attempt to allocate memory when none is available which would have caused a newly created Out of Memory exception to be mishandled as a Syntax Error.

##### References

* [Bug 1839007](https://bugzilla.mozilla.org/show_bug.cgi?id=1839007)

#### [#CVE-2023-4053: Full screen notification obscured by external program](#CVE-2023-4053)

Reporter
Umar Farooq
Impact
moderate
##### Description

A website could have obscured the full screen notification by using a URL with a scheme handled by an external program, such as a mailto URL. This could have led to user confusion and possible spoofing attacks.

##### References

* [Bug 1839079](https://bugzilla.mozilla.org/show_bug.cgi?id=1839079)

#### [#CVE-2023-4580: Push notifications saved to disk unencrypted](#CVE-2023-4580)

Reporter
Harveer Singh
Impact
moderate
##### Description

Push notifications stored on disk in private browsing mode were not being encrypted potentially allowing the leak of sensitive information.

##### References

* [Bug 1843046](https://bugzilla.mozilla.org/show_bug.cgi?id=1843046)

#### [#CVE-2023-4581: XLL file extensions were downloadable without warnings](#CVE-2023-4581)

Reporter
Umar Farooq (@Puf)
Impact
moderate
##### Description

Excel `.xll` add-in files did not have a blocklist entry in Firefox's executable blocklist which allowed them to be downloaded without any warning of their potential harm.

##### References

* [Bug 1843758](https://bugzilla.mozilla.org/show_bug.cgi?id=1843758)

#### [#CVE-2023-4582: Buffer Overflow in WebGL glGetProgramiv](#CVE-2023-4582)

Reporter
Dohyun Lee (@l33d0hyun) of SSD-Disclosure Labs & DNSLab, Korea Univ.
Impact
low
##### Description

Due to large allocation checks in Angle for glsl shaders being too lenient a buffer overflow could have occured when allocating too much private shader memory on mac OS.
*This bug only affects Firefox on macOS. Other operating systems are unaffected.*

##### References

* [Bug 1773874](https://bugzilla.mozilla.org/show_bug.cgi?id=1773874)

#### [#CVE-2023-4583: Browsing Context potentially not cleared when closing Private Window](#CVE-2023-4583)

Reporter
Thejaka Maldeniya
Impact
low
##### Description

When checking if the Browsing Context had been discarded in `HttpBaseChannel`, if the load group was not available then it was assumed to have already been discarded which was not always the case for private channels after the private session had ended.

##### References

* [Bug 1842030](https://bugzilla.mozilla.org/show_bug.cgi?id=1842030)

#### [#CVE-2023-4584: Memory safety bugs fixed in Firefox 117, Firefox ESR 102.15, Firefox ESR 115.2, Thunderbird 102.15, and Thunderbird 115.2](#CVE-2023-4584)

Reporter
Randell Jesup, Andrew McCreight, the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 116, Firefox ESR 102.14, Firefox ESR 115.1, Thunderbird 102.14, and Thunderbird 115.1. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 117, Firefox ESR 102.15, Firefox ESR 115.2, Thunderbird 102.15, and Thunderbird 115.2](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1843968%2C1845205%2C1846080%2C1846526%2C1847529)

#### [#CVE-2023-4585: Memory safety bugs fixed in Firefox 117, Firefox ESR 115.2, and Thunderbird 115.2](#CVE-2023-4585)

Reporter
Donal Meehan, Sebastian Hengst, and the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 116, Firefox ESR 115.1, and Thunderbird 115.1. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 117, Firefox ESR 115.2, and Thunderbird 115.2](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1751583%2C1833504%2C1841082%2C1847904%2C1848999)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_34671575_20250111_043124.html ===


![](/static/v20250108.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1839007)
* [XML](/show_bug.cgi?ctype=xml&id=1839007)

Closed
[Bug 1839007](/show_bug.cgi?id=1839007)
(CVE-2023-4578)

Opened 2 years ago
Closed 1 years ago

# Access Violation on IsPatternMatching -> JS\_GetProperty -> JS\_ForwardGetPropertyTo

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Access Violation on IsPatternMatching -> JS\_GetProperty -> JS\_ForwardGetPropertyTo

## Categories

### (Core :: JavaScript Engine, defect, P2)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=JavaScript%20Engine#JavaScript%20Engine)

JavaScript Engine
▾

Core :: JavaScript Engine
The interpreter engine for the core JavaScript language, independent of the browser's object model. File ONLY core JavaScript language bugs in this category. For bugs involving browser objects such as "window" and "document", use the "DOM" component. For bugs involving calls between JavaScript and C++, use the "XPConnect" component.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=JavaScript%20Engine)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P2

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

117 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Webcompat Score | --- |
| a11y-review | --- |
| Accessibility Severity | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr102 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=wontfix) |
| firefox-esr115 | [117+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=117%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed) |
| firefox115 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=wontfix) |
| firefox116 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=wontfix) |
| firefox117 | [+](/buglist.cgi?f1=cf_tracking_firefox117&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr102 |  | wontfix |
| firefox-esr115 | 117+ | fixed |
| firefox-esr128 | --- | --- |
| firefox115 |  | wontfix |
| firefox116 |  | wontfix |
| firefox117 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: sourc7, Assigned: bthrall)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/86b82435598015dc99964078767079a5?d=mm&size=40)  [bthrall](/user_profile?user_id=700441)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/1f6e740893c5a41879a277dd0b0a0c4a?d=mm&size=40)  [sourc7](/user_profile?user_id=537720)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/4fe52ee1503aecf7b6c976b8eb7c1753?d=mm&size=40)  [willyelm](/user_profile?user_id=714609)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

11 people

## References

### (Blocks 2 open bugs)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[sm-frontend](/show_bug.cgi?id=1729506 "NEW - [meta] SpiderMonkey Frontend"), [sm-runtime](/show_bug.cgi?id=1729514 "NEW - [meta] SpiderMonkey Runtime"), [1845132](/show_bug.cgi?id=1845132 "RESOLVED FIXED - Land tests for bug 1839007")

Dependency [tree](/showdependencytree.cgi?id=1839007&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1839007)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-oom, reporter-external, sec-moderate, Whiteboard: [reporter-external] [client-bounty-form] [verif?] [adv-main117+] [adv-esr115.2+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2023-4578

[Keywords:](/describekeywords.cgi)

[csectype-oom](/buglist.cgi?keywords=csectype-oom&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?] [adv-main117+] [adv-esr115.2+]

QA Whiteboard:

[post-critsmash-triage][qa-triaged]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a3314649_1689 "2 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | [in-testsuite](#c34 "1 year ago") | + |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (9 files)

| [testcase.html](/attachment.cgi?id=9339698)  [2 years ago](#c0)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   735.62 KB, text/html |  | [Details](/attachment.cgi?id=9339698&action=edit) |
| --- | --- | --- |
| [firefox-114.0.1-32-minidump.txt](/attachment.cgi?id=9339699)  [2 years ago](#c1)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   8.36 KB, text/plain |  | [Details](/attachment.cgi?id=9339699&action=edit) |
| [firefox-114.0.1-64-minidump.txt](/attachment.cgi?id=9339701)  [2 years ago](#c2)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   3.37 KB, text/plain |  | [Details](/attachment.cgi?id=9339701&action=edit) |
| [firefox-116.0a1-20230616-64-minidump.txt](/attachment.cgi?id=9339702)  [2 years ago](#c3)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   3.57 KB, text/plain |  | [Details](/attachment.cgi?id=9339702&action=edit) |
| [Bug 1839007 - Return bool from ErrorToException r=arai](/attachment.cgi?id=9344931)  [1 years ago](#c15)  [Bryan Thrall [:bthrall]](/user_profile?user_id=700441)   48 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-esr115+](#c28 "1 years ago") | [Details](/attachment.cgi?id=9344931&action=edit) | [Review](/attachment.cgi?id=9344931) |
| [Bug 1839007 - Return bool from FrontendContext::convertToRuntimeErrorAndClear r=arai](/attachment.cgi?id=9344932)  [1 years ago](#c16)  [Bryan Thrall [:bthrall]](/user_profile?user_id=700441)   48 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-esr115+](#a5045322_75935 "1 years ago") | [Details](/attachment.cgi?id=9344932&action=edit) | [Review](/attachment.cgi?id=9344932) |
| [Bug 1839007 - Return false if converting to a runtime error triggers OOM r=arai](/attachment.cgi?id=9344933)  [1 years ago](#c17)  [Bryan Thrall [:bthrall]](/user_profile?user_id=700441)   48 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-esr115+](#a5045324_75935 "1 years ago") | [Details](/attachment.cgi?id=9344933&action=edit) | [Review](/attachment.cgi?id=9344933) |
| [Bug 1839007 - Add CheckRegExpSyntax jit-test r=arai](/attachment.cgi?id=9345111)  [1 years ago](#c18)  [Bryan Thrall [:bthrall]](/user_profile?user_id=700441)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9345111&action=edit) | [Review](/attachment.cgi?id=9345111) |
| [advisory.txt](/attachment.cgi?id=9350223)  [1 year ago](#c32)  [June Wilde (she/her) [:jewilde]](/user_profile?user_id=626341)   430 bytes, text/plain |  | [Details](/attachment.cgi?id=9350223&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1839007#c0)• 2 years ago |
|  | |

Attached file
[testcase.html](attachment.cgi?id=9339698)
— [Details](attachment.cgi?id=9339698&action=edit)

After allocate memory to exhaust the process virtual memory and execute invalid JS function inside try {} catch() {} and input pattern. On Firefox 32-bit it able to crash on JS\_GetProperty on address 0x000083d8, more interestingly on Firefox 64-bit it able to crash on dynamic (changing) address including 0x00050512fab2b080, 0x000514975972b080, 0x000526aa3e72b080, and more..

Currently the testcase.html is fine-tuned to make it very reliably to reproduce on Firefox 114.0.1 (32-bit) on Windows 11, I tested this very reliably crash on JS\_GetProperty on both my machine Intel i9-13900k and AMD Ryzen 7 5700G, it still able to crash on Firefox Nightly 116.0a1 (2023-06-16) (32-bit), but reduced success rate and have to adjust fillMemory code to make it very reliably on Nightly. For now I decided to submit this report and adjust that later.

## Tested on:

* Firefox 114.0.1 (32-bit)
* Firefox 114.0.1 (64-bit)
* Firefox Nightly 116.0a1 (2023-06-16) (32-bit)
* Firefox Nightly 116.0a1 (2023-06-16) (64-bit)

## Steps to reproduce:

1. Open Firefox 114.0.1 (32-bit)
2. Visit attached testcase.html
3. Wait ~20 seconds
4. Firefox tab crashed
5. Analyze the minidump using WinDbg
6. Firefox crash on JS\_GetProperty -> JS\_ForwardGetPropertyTo
Flags: sec-bounty?

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1839007#c1)• 2 years ago |
|  | |

Attached file
[firefox-114.0.1-32-minidump.txt](attachment.cgi?id=9339699)
— [Details](attachment.cgi?id=9339699&action=edit)

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1839007#c2)• 2 years ago |
|  | |

Attached file
[firefox-114.0.1-64-minidump.txt](attachment.cgi?id=9339701)
— [Details](attachment.cgi?id=9339701&action=edit)

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1839007#c3)• 2 years ago |
|  | |

Attached file
[firefox-116.0a1-20230616-64-minidump.txt](attachment.cgi?id=9339702)
— [Details](attachment.cgi?id=9339702&action=edit)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1839007#a173958_159069)• 2 years ago |

Group: firefox-core-security → javascript-core-securityComponent: Security → JavaScript EngineProduct: Firefox → Core

|  | [Nicolas B. Pierron [:nbp]](/user_profile?user_id=422187) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1839007#a282358_422187)• 2 years ago |

Component: JavaScript Engine → DOM: Forms

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1839007#a294268_406194)• 2 years ago |

Group: javascript-core-security → dom-core-security

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1839007#c4)• 2 years ago |
|  | |

Looking at the attached stacks, nsContentUtils::IsPatternMatching() is here:

`ReportPatternCompileFailure(aPattern, aDocument, &error, cx);`

I'm guessing that is on this line, because that's the only call to `JS_GetProperty` in the file:

`if (!JS_GetProperty(cx, exnObj, "message", &messageVal)) {`

I'm not sure how we're getting into IsPatternMatching, though.

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1839007#c5)• 2 years ago |
|  | |

Because of the testcase setting inputElement.pattern, so when then later value is updated using setRangeText, that triggers HasPatternMismatch() call, I believe through <https://searchfox.org/mozilla-central/rev/4e8f62a231e71dc53eb50b6d74afca21d6b254e9/dom/html/HTMLInputElement.cpp#6800,6814>

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1839007#c6)• 2 years ago |
|  | |

Isn't this more a JS engine issue. I don't immediately see anything unusual on the DOM side.

Flags: needinfo?(nicolas.b.pierron)Flags: needinfo?(continuation)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1839007#c7)• 2 years ago |
|  | |

I have no idea.

Flags: needinfo?(continuation)

|  | [Nicolas B. Pierron [:nbp]](/user_profile?user_id=422187) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1839007#c8)• 2 years ago |
|  | |

(In reply to Olli Pettay [:smaug][bugs@pettay.fi] from [comment #6](/show_bug.cgi?id=1839007#c6 "VERIFIED FIXED - Access Violation on IsPatternMatching -> JS_GetProperty -> JS_ForwardGetPropertyTo"))

> Isn't this more a JS engine issue. I don't immediately see anything unusual on the DOM side.

If this is unrelated to the DOM, would there be a way to convert the failing test case into one which does not rely on the DOM?

Flags: needinfo?(nicolas.b.pierron)

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1839007#c9)• 2 years ago |
|  | |

Ok great! I got the root cause of memory allocation failure that cause the access violation, I'll post the detail soon.

Flags: needinfo?(susah.yak)

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1839007#c10)• 2 years ago |
|  | |

The testcase.html is set `inputElement.pattern` that invoke[`nsContentUtils::IsPatternMatching`](https://searchfox.org/mozilla-central/source/dom/base/nsContentUtils.cpp#7077) to do `JS::CheckRegExpSyntax` -> `js::FrontendContext::convertToRuntimeError` -> [`js::ErrorToException`](https://searchfox.org/mozilla-central/source/js/src/jsexn.cpp#350) -> [`js::CopyErrorReport`](https://searchfox.org/mozilla-central/source/js/src/jsexn.cpp#208)

On [`CopyErrorHelper`](https://searchfox.org/mozilla-central/source/js/src/jsexn.cpp#163) it do `calloc` to allocate the `uint8_t* cursor` using `cx->pod_calloc<uint8_t>(mallocSize);` then when `calloc` failure, the `cursor` is set to `null` then as `if (!cursor) {` the function will [`return nullptr;`](https://searchfox.org/mozilla-central/source/js/src/jsexn.cpp#165)

When the `calloc` is failure at first try, it look like the [`js::CopyErrorReport`](https://searchfox.org/mozilla-central/source/js/src/jsexn.cpp#208) is also call to [`JSRuntime::onOutOfMemory`](https://searchfox.org/mozilla-central/source/js/src/vm/Runtime.cpp#669) to try do GC, but it still return the `nullptr` for the `uint8_t* cursor`. Then [`js::ErrorToException`](https://searchfox.org/mozilla-central/source/js/src/jsexn.cpp#350) check `if (!report) {` it will call `return`

After the [`fc.convertToRuntimeErrorAndClear();`](https://searchfox.org/mozilla-central/source/js/src/vm/RegExpObject.cpp#1245) function is called, then the [`JS::CheckRegExpSyntax`](https://searchfox.org/mozilla-central/source/js/src/vm/RegExpObject.cpp#1251) will `return true;` cause [`nsContentUtils::IsPatternMatching`](https://searchfox.org/mozilla-central/source/dom/base/nsContentUtils.cpp#7054) to pass the [`return Nothing()`](https://searchfox.org/mozilla-central/source/dom/base/nsContentUtils.cpp#7079) so it go inside `if (!error.isUndefined()) {` to call [`ReportPatternCompileFailure(aPattern, aDocument, &error, cx);`](https://searchfox.org/mozilla-central/source/dom/base/nsContentUtils.cpp#7035), the function call [`JS_GetProperty(cx, exnObj, "message", &messageVal)`](https://searchfox.org/mozilla-central/source/js/src/vm/PropertyAndElement.cpp#627) -> [`JS_ForwardGetPropertyTo`](https://searchfox.org/mozilla-central/source/js/src/vm/PropertyAndElement.cpp#595) -> `check` -> `checkImpl` -> `check` -> `compartment` -> `shape` -> [`headerPtr`](https://searchfox.org/mozilla-central/source/js/src/gc/Cell.h#833) then crash at [`get`](https://searchfox.org/mozilla-central/source/js/src/gc/Cell.h#141)

Flags: needinfo?(susah.yak)

|  | [Nicolas B. Pierron [:nbp]](/user_profile?user_id=422187) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1839007#c11)• 2 years ago |
|  | |

Thanks for the report!

This indeed sounds like a JS engine issue then, and now I know who to forward it to.

Bryan it sounds like [`JS::CheckRegExpSyntax`](https://searchfox.org/mozilla-central/rev/4e8f62a231e71dc53eb50b6d74afca21d6b254e9/js/public/RegExp.h#93-102) does not behave as described in its declaration, by [discarding the error and returning true](https://searchfox.org/mozilla-central/rev/4e8f62a231e71dc53eb50b6d74afca21d6b254e9/js/src/vm/RegExpObject.cpp#1245-1251).

I suspect the problem comes from either not setting or clearing the [FrontendContext OutOfMemory flag](https://searchfox.org/mozilla-central/rev/4e8f62a231e71dc53eb50b6d74afca21d6b254e9/js/src/vm/RegExpObject.cpp#1241-1242) ahead of returning into `JS::CheckRegExpSyntax`.

Component: DOM: Forms → JavaScript EngineFlags: needinfo?(bthrall)Priority: -- → P2

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1839007#a368882_406194)• 2 years ago |

Group: dom-core-security → javascript-core-security

|  | [Nicolas B. Pierron [:nbp]](/user_profile?user_id=422187) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1839007#a368970_422187)• 2 years ago |

Blocks: [sm-frontend](/show_bug.cgi?id=1729506 "NEW - [meta] SpiderMonkey Frontend"), [sm-runtime](/show_bug.cgi?id=1729514 "NEW - [meta] SpiderMonkey Runtime")Severity: -- → S2

|  | [Bryan Thrall [:bthrall]](/user_profile?user_id=700441)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1839007#c12)• 2 years ago |
|  | |

I'll take a look!

Assignee: nobody → bthrallStatus: NEW → ASSIGNEDFlags: needinfo?(bthrall)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1839007#a994241_1689)• 2 years ago |

Keywords: [csectype-oom](/buglist.cgi?keywords=csectype-oom&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1839007#c13)• 1 years ago |
|  | |

(In reply to Irvan Kurniawan (:sourc7) from [comment #0](/show_bug.cgi?id=1839007#c0 "VERIFIED FIXED - Access Violation on IsPatternMatching -> JS_GetProperty -> JS_ForwardGetPropertyTo"))

> it still able to crash on Firefox Nightly 116.0a1 (2023-06-16) (32-bit), but reduced success rate and have to adjust fillMemory code to make it very reliably on Nightly.

Ok, after testing for a while, the attached testcase.html is also very reliable on Firefox Nightly 117.0a1 (2023-07-13) (32-bit), when testing 20 times on ffpuppet launcher I can get 20 times success, 0 failure on Intel i9-13900k and AMD Ryzen 7 5700G.

When attach the process with WinDbg, I able to capture the access-violation crash, on crash stack index `[0xb]` the `xul!ReportPatternCompileFailure` code `if (!JS_GetProperty(cx, exnObj, "message", &messageVal)) {` the `exnObj` variable `exnObj->ptr->header_->value_` value already set to `0x83d8`, then on stack `[0x0]` the `xul!js::gc::HeaderWord::get` code `uintptr_t value = value_;` the `this` local name is set to `0x83d8` which is the crash address.

|  | [Bryan Thrall [:bthrall]](/user_profile?user_id=700441)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1839007#c14)• 1 years ago |
|  | |

It looks like the problem is that `fc.convertToRuntimeErrorAndClear();` allocates memory, so it can trigger OOM.

This can cause `JS::CheckRegExpSyntax()` to return true when it should return false in the following scenario:

1. `JS::CheckRegExpSyntax()` is called with a string that has invalid syntax
2. `irregexp::CheckPatternSyntax()` returns false and sets SyntaxError on the FrontendContext
3. `JS::CheckRegExpSyntax()` follows the failure path and [calls fc.convertToRuntimeErrorAndClear()](https://searchfox.org/mozilla-central/source/js/src/vm/RegExpObject.cpp#1245)
4. `convertToRuntimeErrorAndClear()` triggers OOM and sets a pending OOM exception on the JSContext
5. `JS::CheckRegExpSyntax()` extracts the OOM exception, thinking it is the SyntaxError, and returns true

I should have a patch to correctly check for OOM in `convertToRuntimeErrorAndClear()` soon.

Thanks for the detailed analysis, :sourc7, it was really helpful in diagnosing the problem!

|  | [Bryan Thrall [:bthrall]](/user_profile?user_id=700441)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1839007#c15)• 1 years ago |
|  | |

Attached file
[Bug 1839007 - Return bool from ErrorToException r=arai](attachment.cgi?id=9344931)
— [Details](attachment.cgi?id=9344931&action=edit)

It is simpler to think about ErrorToException returning true when the error is

correctly converted, which is why it returns false on recursion even though you

could argue that nothing went wrong in that case.

|  | [Bryan Thrall [:bthrall]](/user_profile?user_id=700441)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1839007#c16)• 1 years ago |
|  | |

Attached file
[Bug 1839007 - Return bool from FrontendContext::convertToRuntimeErrorAndClear r=arai](attachment.cgi?id=9344932)
— [Details](attachment.cgi?id=9344932&action=edit)

Depends on D184160

|  | [Bryan Thrall [:bthrall]](/user_profile?user_id=700441)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1839007#c17)• 1 years ago |
|  | |

Attached file
[Bug 1839007 - Return false if converting to a runtime error triggers OOM r=arai](attachment.cgi?id=9344933)
— [Details](attachment.cgi?id=9344933&action=edit)

In that case, the error stored in cx is an OOM rather than the expected

SyntaxError. CheckRegExpSyntax should return false in that case.

Depends on D184161

|  | [Bryan Thrall [:bthrall]](/user_profile?user_id=700441)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1839007#c18)• 1 years ago |
|  | |

Attached file
[Bug 1839007 - Add CheckRegExpSyntax jit-test r=arai](attachment.cgi?id=9345111)
— [Details](attachment.cgi?id=9345111&action=edit)

Depends on D184162

|  | [Bryan Thrall [:bthrall]](/user_profile?user_id=700441)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1839007#c19)• 1 years ago |
|  | |

Landing patches D184160, D184161, and D184162 without sec-approval because this is marked sec-moderate.

Patch D184254 contains tests and will be landed at a later time, according to security procedure.

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1839007#c20)• 1 years ago |
|  | |

Pushed by bthrall@mozilla.com:
<https://hg.mozilla.org/integration/autoland/rev/599e241178d6>
Return bool from ErrorToException r=arai
<https://hg.mozilla.org/integration/autoland/rev/880d3a8b52ba>
Return bool from FrontendContext::convertToRuntimeErrorAndClear r=arai
<https://hg.mozilla.org/integration/autoland/rev/ea812280de66>
Return false if converting to a runtime error triggers OOM r=arai

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1839007#c21)• 1 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/599e241178d6>

<https://hg.mozilla.org/mozilla-central/rev/880d3a8b52ba>

<https://hg.mozilla.org/mozilla-central/rev/ea812280de66>

Group: javascript-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 1 years ago
[status-firefox117](/buglist.cgi?f1=cf_status_firefox117&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 117 Branch

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1839007#a3167031_75935)• 1 years ago |

[status-firefox115](/buglist.cgi?f1=cf_status_firefox115&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=wontfix)
[status-firefox116](/buglist.cgi?f1=cf_status_firefox116&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=wontfix)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=wontfix)
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected)
[tracking-firefox117](/buglist.cgi?f1=cf_tracking_firefox117&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox117&o1=equals&v1=%2B)
[tracking-firefox-esr115](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=isnotempty):
--- → [117+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=117%2B)

|  | [Bryan Thrall [:bthrall]](/user_profile?user_id=700441)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1839007#a3217478_700441)• 1 years ago |

Blocks: [1845132](/show_bug.cgi?id=1845132 "RESOLVED FIXED - Land tests for bug 1839007")

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1839007#c22)• 1 years ago |
|  | |

Comment on [attachment 9345111](/attachment.cgi?id=9345111 "Bug 1839007 - Add CheckRegExpSyntax jit-test r=arai") [[details]](/attachment.cgi?id=9345111&action=edit "Bug 1839007 - Add CheckRegExpSyntax jit-test r=arai")

[Bug 1839007](/show_bug.cgi?id=1839007 "VERIFIED FIXED - Access Violation on IsPatternMatching -> JS_GetProperty -> JS_ForwardGetPropertyTo") - Add CheckRegExpSyntax jit-test r=arai

Revision D184254 was moved to [bug 1845132](/show_bug.cgi?id=1845132 "RESOLVED FIXED - Land tests for bug 1839007"). Setting [attachment 9345111](/attachment.cgi?id=9345111 "Bug 1839007 - Add CheckRegExpSyntax jit-test r=arai") [[details]](/attachment.cgi?id=9345111&action=edit "Bug 1839007 - Add CheckRegExpSyntax jit-test r=arai") to obsolete.

[Attachment #9345111](/attachment.cgi?id=9345111&action=edit "Bug 1839007 - Add CheckRegExpSyntax jit-test r=arai") -
Attachment is obsolete: true

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1839007#a3314649_1689)• 1 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1839007#c23)• 1 years ago |
|  | |

We're going to leave the severity at moderate because so far the read access violation is only for a fixed offset (slightly varying with the base allocation pointer in 64 bits, but that doesn't appear to be under your control). If there's a way to get more control over the read address we'd consider raising the severity.

|  | [Camelia Badau [:cbadau], Desktop Test Engineering](/user_profile?user_id=500622) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1839007#a4053985_500622)• 1 years ago |

Flags: qe-verify+

|  | [Bryan Thrall [:bthrall]](/user_profile?user_id=700441)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1839007#c24)• 1 years ago |
|  | |

Comment on [attachment 9344931](/attachment.cgi?id=9344931 "Bug 1839007 - Return bool from ErrorToException r=arai") [[details]](/attachment.cgi?id=9344931&action=edit "Bug 1839007 - Return bool from ErrorToException r=arai")

[Bug 1839007](/show_bug.cgi?id=1839007 "VERIFIED FIXED - Access Violation on IsPatternMatching -> JS_GetProperty -> JS_ForwardGetPropertyTo") - Return bool from ErrorToException r=arai

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: This is a small change that improves content tab stability in low-memory situations and there is a low risk of applying it.
* **User impact if declined**: There is a chance of crashing the content tab in low-memory situations when the JavaScript executes an invalid regular expression.
* **Fix Landed on Version**: 117
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: The change only effects the code path in the case of an invalid regular expression, so only websites with broken regular expressions could potentially see any change in behavior. The change is also isolated to a small number of files and applies cleanly to the esr115 release commit.
[Attachment #9344931](/attachment.cgi?id=9344931&action=edit "Bug 1839007 - Return bool from ErrorToException r=arai") -
Flags: approval-mozilla-esr115?

|  | [Bryan Thrall [:bthrall]](/user_profile?user_id=700441)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1839007#a4101300_700441)• 1 years ago |

[Attachment #9344932](/attachment.cgi?id=9344932&action=edit "Bug 1839007 - Return bool from FrontendContext::convertToRuntimeErrorAndClear r=arai") -
Flags: approval-mozilla-esr115?
[Attachment #9344933](/attachment.cgi?id=9344933&action=edit "Bug 1839007 - Return false if converting to a runtime error triggers OOM r=arai") -
Flags: approval-mozilla-esr115?

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1839007#a4127646_488993)• 1 years ago |

QA Whiteboard: [post-critsmash-triage]

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1839007#a4149091_553429)• 1 years ago |

QA Whiteboard: [post-critsmash-triage] → [post-critsmash-triage][qa-triaged]

|  | [Hani Yacoub, Desktop QA](/user_profile?user_id=583007) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1839007#c25)• 1 years ago |
|  | |

Managed to reproduce the crash on Firefox Firefox 114.0.1 (32-bit) and on Firefox Nightly 116.0a1 (2023-06-16) (32-bit) on Windows 11 and Windows 10.

The crash is still reproducible on the latest Firefox Nightly 118.0a1 (2023-08-04) x32 on both Windows 11/10.

Bryan, could you please take a look at this to see if it's also reproducible on your side?

Thanks.

Flags: needinfo?(bthrall)

|  | [Bryan Thrall [:bthrall]](/user_profile?user_id=700441)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1839007#c26)• 1 year ago |
|  | |

Unfortunately, the testcase for this bug eats up all the memory available to the tab, so the tab will crash even if the bug is fixed. I'm sorry for not making that clear earlier!

Does Firefox have different behavior if a tab crashes because of OOM vs. other crashes? That might be one way to verify the bug is fixed.

I'm also looking at verifying that the code behaves as I expect on current mozilla-central using a debugger.

Flags: needinfo?(bthrall)

|  | [Hani Yacoub, Desktop QA](/user_profile?user_id=583007) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1839007#c27)• 1 year ago |
|  | |

I didn't see any different behavior between the two builds, they even crashed at approximative the same time.

Could you please mark this bug as verified after verifying that the code behaves as I expect on current mozilla-central using a debugger?

Thanks.

Flags: needinfo?(bthrall)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1839007#c28)• 1 year ago |
|  | |

Comment on [attachment 9344931](/attachment.cgi?id=9344931 "Bug 1839007 - Return bool from ErrorToException r=arai") [[details]](/attachment.cgi?id=9344931&action=edit "Bug 1839007 - Return bool from ErrorToException r=arai")

[Bug 1839007](/show_bug.cgi?id=1839007 "VERIFIED FIXED - Access Violation on IsPatternMatching -> JS_GetProperty -> JS_ForwardGetPropertyTo") - Return bool from ErrorToException r=arai

Approved for 115.2esr.

[Attachment #9344931](/attachment.cgi?id=9344931&action=edit "Bug 1839007 - Return bool from ErrorToException r=arai") -
Flags: approval-mozilla-esr115? → approval-mozilla-esr115+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1839007#a5045322_75935)• 1 year ago |

[Attachment #9344932](/attachment.cgi?id=9344932&action=edit "Bug 1839007 - Return bool from FrontendContext::convertToRuntimeErrorAndClear r=arai") -
Flags: approval-mozilla-esr115? → approval-mozilla-esr115+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1839007#a5045324_75935)• 1 year ago |

[Attachment #9344933](/attachment.cgi?id=9344933&action=edit "Bug 1839007 - Return false if converting to a runtime error triggers OOM r=arai") -
Flags: approval-mozilla-esr115? → approval-mozilla-esr115+

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1839007#c29)• 1 year ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr115/rev/e2eaa313a346>
<https://hg.mozilla.org/releases/mozilla-esr115/rev/f03409ee57eb>
<https://hg.mozilla.org/releases/mozilla-esr115/rev/301266ba9108>

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1839007#a5046260_75935)• 1 year ago |

[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed)

|  | [Bryan Thrall [:bthrall]](/user_profile?user_id=700441)  Assignee |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1839007#c30)• 1 year ago |
|  | |

I couldn't get the attached testcase to reproduce the same memory failure as it originally did, but I was able to use a debugger to do so and verify that mozilla-central, including the patches for this bug, handles the OOM correctly now.

Specifically, when an OOM happens while converting the FrontendContext error to a JSContext error, `JS::CheckRegExpSyntax()` returns false, which is the documented behavior.

Status: RESOLVED → VERIFIEDFlags: needinfo?(bthrall)

|  | [Hani Yacoub, Desktop QA](/user_profile?user_id=583007) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1839007#c31)• 1 year ago |
|  | |

Removing qa-verify+ since we couldn't verify this issue on our end.

Flags: qe-verify+

|  | [June Wilde (she/her) [:jewilde]](/user_profile?user_id=626341) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1839007#c32)• 1 year ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9350223)
— [Details](attachment.cgi?id=9350223&action=edit)

|  | [June Wilde (she/her) [:jewilde]](/user_profile?user_id=626341) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1839007#a5946728_626341)• 1 year ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?] [adv-main117+]

|  | [June Wilde (she/her) [:jewilde]](/user_profile?user_id=626341) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1839007#a5949207_626341)• 1 year ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] [adv-main117+] → [reporter-external] [client-bounty-form] [verif?] [adv-main117+] [adv-esr115+]

|  | [June Wilde (she/her) [:jewilde]](/user_profile?user_id=626341) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1839007#a5949268_626341)• 1 year ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] [adv-main117+] [adv-esr115+] → [reporter-external] [client-bounty-form] [verif?] [adv-main117+] [adv-esr115.2+]

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1839007#a8661067_600971)• 1 year ago |

[Attachment #9345111](/attachment.cgi?id=9345111&action=edit "Bug 1839007 - Add CheckRegExpSyntax jit-test r=arai") -
Attachment is obsolete: false

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1839007#c33)• 1 year ago |
|  | |

Pushed by bthrall@mozilla.com:
<https://hg.mozilla.org/integration/autoland/rev/e55f2c5a7f0b>
Add CheckRegExpSyntax jit-test r=arai

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1839007#c34)• 1 year ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/e55f2c5a7f0b>

Flags: in-testsuite+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1839007#a17356579_1689)• 1 year ago |

Group: core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1839007#a17362400_1689)• 1 year ago |

Alias: CVE-2023-4578

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1839007#a30095507_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1839007&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


