=== Content from github.com_6749379c_20250111_102737.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenfga%2Fopenfga%2Fsecurity%2Fadvisories%2FGHSA-8cph-m685-6v6r)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenfga%2Fopenfga%2Fsecurity%2Fadvisories%2FGHSA-8cph-m685-6v6r)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=openfga%2Fopenfga)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[openfga](/openfga)
/
**[openfga](/openfga/openfga)**
Public

* [Notifications](/login?return_to=%2Fopenfga%2Fopenfga) You must be signed in to change notification settings
* [Fork
  220](/login?return_to=%2Fopenfga%2Fopenfga)
* [Star
   3.1k](/login?return_to=%2Fopenfga%2Fopenfga)

* [Code](/openfga/openfga)
* [Issues
  110](/openfga/openfga/issues)
* [Pull requests
  17](/openfga/openfga/pulls)
* [Actions](/openfga/openfga/actions)
* [Projects
  1](/openfga/openfga/projects)
* [Security](/openfga/openfga/security)
* [Insights](/openfga/openfga/pulse)

Additional navigation options

* [Code](/openfga/openfga)
* [Issues](/openfga/openfga/issues)
* [Pull requests](/openfga/openfga/pulls)
* [Actions](/openfga/openfga/actions)
* [Projects](/openfga/openfga/projects)
* [Security](/openfga/openfga/security)
* [Insights](/openfga/openfga/pulse)

# OpenFGA Authorization Bypass

High

[miparnisari](/miparnisari)
published
GHSA-8cph-m685-6v6r
Apr 16, 2024

## Package

gomod

openfga/openfga
([Go](/advisories?query=ecosystem%3Ago))

## Affected versions

>1.5.0, <1.5.3

## Patched versions

1.5.3

## Description

# Overview

Some end users of OpenFGA v1.5.0 or later are vulnerable to authorization bypass when calling Check or ListObjects APIs.

# Am I Affected?

You are very likely affected if your model involves exclusion (e.g. `a but not b`) or intersection (e.g. `a and b`) and you have any cyclical relationships. If you are using these, please update as soon as possible.

# Fix

Update to v1.5.3

# Backward Compatibility

This update is backward compatible.

### Severity

High

### CVE ID

CVE-2024-31452

### Weaknesses

No CWEs

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_b96bd5b8_20250111_102736.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenfga%2Fopenfga%2Fcommit%2Fb6a6d99b2bdbf8c3781503989576076289f48ed2)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenfga%2Fopenfga%2Fcommit%2Fb6a6d99b2bdbf8c3781503989576076289f48ed2)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=openfga%2Fopenfga)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[openfga](/openfga)
/
**[openfga](/openfga/openfga)**
Public

* [Notifications](/login?return_to=%2Fopenfga%2Fopenfga) You must be signed in to change notification settings
* [Fork
  220](/login?return_to=%2Fopenfga%2Fopenfga)
* [Star
   3.1k](/login?return_to=%2Fopenfga%2Fopenfga)

* [Code](/openfga/openfga)
* [Issues
  110](/openfga/openfga/issues)
* [Pull requests
  17](/openfga/openfga/pulls)
* [Actions](/openfga/openfga/actions)
* [Projects
  1](/openfga/openfga/projects)
* [Security](/openfga/openfga/security)
* [Insights](/openfga/openfga/pulse)

Additional navigation options

* [Code](/openfga/openfga)
* [Issues](/openfga/openfga/issues)
* [Pull requests](/openfga/openfga/pulls)
* [Actions](/openfga/openfga/actions)
* [Projects](/openfga/openfga/projects)
* [Security](/openfga/openfga/security)
* [Insights](/openfga/openfga/pulse)

## Commit

[Permalink](/openfga/openfga/commit/b6a6d99b2bdbf8c3781503989576076289f48ed2)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-8cph-m685-6v6r](https://github.com/advisories/GHSA-8cph-m685-6v6r "GHSA-8cph-m685-6v6r")

[Browse files](/openfga/openfga/tree/b6a6d99b2bdbf8c3781503989576076289f48ed2)
Browse the repository at this point in the history

```
* fix: error handling leading to false positives

* test: add a failing test due to Check and ListObjects differences

* test: change test expectation for ListObjects assertion

* fix: union CheckFuncReducer and associated tests

* fix: intersection CheckFuncReducer

* fix: exclusion CheckFuncReducer

* fix: rewire the cycle detection mechanics to avoid error propagation

* test: add more edge case tests for cyclical evaluations

* test: rename new test that was poorly named

* chore: revert minor change that was unintended

* chore: tidy up changes and drop commented out code

* chore: minor touchups based on some feedback

* test: add test for CloneResolveCheckResponse

* test: add more tests for error around intersection

* test: more test assertions around cloned cached response

* test: add unit test to make sure we cache CycleDetected

* test: add more assertions around CycleDetected field

* chore: rename test names

* chore: fix datastore query count under reporting in intersection reducer
```

* Loading branch information

[![@jon-whit](https://avatars.githubusercontent.com/u/2899204?s=40&v=4)](/jon-whit)

[jon-whit](/openfga/openfga/commits?author=jon-whit "View all commits by jon-whit")
authored
Apr 16, 2024

1 parent
[6829520](/openfga/openfga/commit/68295205b6e6a3fbbc3ffc0c420b7f4b4c69f914)

commit b6a6d99

 Show file tree

 Hide file tree

Showing
**11 changed files**
with
**1,253 additions**
and
**281 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* assets/tests

  + assets/tests/consolidated\_1\_1\_tests.yaml
    [consolidated\_1\_1\_tests.yaml](#diff-1d77257dd9e1a0e76a719b659c451b109c9c9cfb2247b56f9f20b7bd9b8d5cee)
* internal/graph

  + internal/graph/cached\_resolver.go
    [cached\_resolver.go](#diff-f8bf9e51b59704261dbd69c1f9b025fa4f7bc85e39e59ad1c0b7d599ba53c056)
  + internal/graph/cached\_resolver\_test.go
    [cached\_resolver\_test.go](#diff-5ac0186ec907348790029698bb5941d39c2fde1b03986442cb8601ea77af2d08)
  + internal/graph/check.go
    [check.go](#diff-5074b7eeccca5be19ff0fa2a8f712335a6ed075628b66a46697ca9d8ca99fbe0)
  + internal/graph/check\_test.go
    [check\_test.go](#diff-8063580889b0a01d574cf47d97f9483543d3ba0f972058199fd3a836e861d48c)
  + internal/graph/cycle\_check\_resolver.go
    [cycle\_check\_resolver.go](#diff-241e6df24d1caddeda0568f978b330d558a5370caef4533597033cc060df1436)
  + internal/graph/cycle\_check\_resolver\_test.go
    [cycle\_check\_resolver\_test.go](#diff-776e361c2378e18707a64f046b3c521cef20715b75c7133b23c98b2b07af718c)
  + internal/graph/graph.go
    [graph.go](#diff-a918a3cf9f028a70ef671823b8aab0bd9c7862aa755f4486a1c2aac013cc497b)
* pkg/server

  + commands

    - pkg/server/commands/list\_objects.go
      [list\_objects.go](#diff-3d643ca7a6f151d55dd056d3d26661f96663b6d56a3a6054a33e6440283cb29e)
  + pkg/server/server.go
    [server.go](#diff-104a11712684e520f0affa95e6a053faeb713306a10f69ee99b9729cc9dd1996)
  + pkg/server/server\_test.go
    [server\_test.go](#diff-fe7a244e18e92d8f347af17363209172e1d79224f086b0585a1bbeef3b626c4e)

## There are no files selected for viewing

361 changes: 361 additions & 0 deletions

361
[assets/tests/consolidated\_1\_1\_tests.yaml](#diff-1d77257dd9e1a0e76a719b659c451b109c9c9cfb2247b56f9f20b7bd9b8d5cee "assets/tests/consolidated_1_1_tests.yaml")

Show comments

[View file](/openfga/openfga/blob/b6a6d99b2bdbf8c3781503989576076289f48ed2/assets/tests/consolidated_1_1_tests.yaml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -5295,3 +5295,364 @@ tests: |
|  |  | relation: viewer |
|  |  | expectation: |
|  |  | - document:1 |
|  |  | - name: cycle\_or\_cycle\_return\_false |
|  |  | stages: |
|  |  | - model: | |
|  |  | model |
|  |  | schema 1.1 |
|  |  | type user |
|  |  |  |
|  |  | type document |
|  |  | relations |
|  |  | define editor: [user, document#viewer] |
|  |  | define viewer: [document#editor] or editor |
|  |  | tuples: |
|  |  | - user: document:1#viewer |
|  |  | relation: editor |
|  |  | object: document:1 |
|  |  | - user: document:1#editor |
|  |  | relation: viewer |
|  |  | object: document:1 |
|  |  | checkAssertions: |
|  |  | - tuple: |
|  |  | object: document:1 |
|  |  | relation: viewer |
|  |  | user: user:jon |
|  |  | expectation: false |
|  |  | listObjectsAssertions: |
|  |  | - request: |
|  |  | user: user:jon |
|  |  | type: document |
|  |  | relation: viewer |
|  |  | expectation: |
|  |  | - name: immediate\_cycle\_through\_computed\_userset |
|  |  | stages: |
|  |  | - model: | |
|  |  | model |
|  |  | schema 1.1 |
|  |  | type user |
|  |  |  |
|  |  | type document |
|  |  | relations |
|  |  | define editor: [user, document#viewer] |
|  |  | define viewer: editor |
|  |  | tuples: |
|  |  | - user: document:1#viewer |
|  |  | relation: editor |
|  |  | object: document:1 |
|  |  | checkAssertions: |
|  |  | - tuple: |
|  |  | object: document:1 |
|  |  | relation: viewer |
|  |  | user: user:jon |
|  |  | expectation: false |
|  |  | listObjectsAssertions: |
|  |  | - request: |
|  |  | user: user:jon |
|  |  | type: document |
|  |  | relation: viewer |
|  |  | expectation: |
|  |  | - name: immediate\_cycle\_through\_computed\_userset |
|  |  | stages: |
|  |  | - model: | |
|  |  | model |
|  |  | schema 1.1 |
|  |  | type user |
|  |  |  |
|  |  | type document |
|  |  | relations |
|  |  | define editor: [user, document#viewer] |
|  |  | define viewer: editor |
|  |  | tuples: |
|  |  | - user: document:1#viewer |
|  |  | relation: editor |
|  |  | object: document:1 |
|  |  | checkAssertions: |
|  |  | - tuple: |
|  |  | object: document:1 |
|  |  | relation: viewer |
|  |  | user: user:jon |
|  |  | expectation: false |
|  |  | listObjectsAssertions: |
|  |  | - request: |
|  |  | user: user:jon |
|  |  | type: document |
|  |  | relation: viewer |
|  |  | expectation: |
|  |  | - name: true\_butnot\_cycle\_return\_false |
|  |  | stages: |
|  |  | - model: | |
|  |  | model |
|  |  | schema 1.1 |
|  |  | type user |
|  |  |  |
|  |  | type document |
|  |  | relations |
|  |  | define restricted: [user, document#viewer] |
|  |  | define viewer: [user] but not restricted |
|  |  | tuples: |
|  |  | - user: user:jon |
|  |  | relation: viewer |
|  |  | object: document:1 |
|  |  | - user: document:1#viewer |
|  |  | relation: restricted |
|  |  | object: document:1 |
|  |  | checkAssertions: |
|  |  | - tuple: |
|  |  | object: document:1 |
|  |  | relation: viewer |
|  |  | user: user:jon |
|  |  | expectation: false |
|  |  | listObjectsAssertions: |
|  |  | - request: |
|  |  | user: user:jon |
|  |  | type: document |
|  |  | relation: viewer |
|  |  | expectation: |
|  |  | - name: cycle\_and\_cycle\_return\_false |
|  |  | stages: |
|  |  | - model: | |
|  |  | model |
|  |  | schema 1.1 |
|  |  |  |
|  |  | type user |
|  |  |  |
|  |  | type document |
|  |  | relations |
|  |  | define editor: [user, document#viewer] |
|  |  | define viewer: [user, document#editor] and editor |
|  |  | tuples: |
|  |  | - user: document:1#editor |
|  |  | relation: viewer |
|  |  | object: document:1 |
|  |  | - user: document:1#viewer |
|  |  | relation: editor |
|  |  | object: document:1 |
|  |  | checkAssertions: |
|  |  | - tuple: |
|  |  | object: document:1 |
|  |  | relation: viewer |
|  |  | user: user:jon |
|  |  | expectation: false |
|  |  | listObjectsAssertions: |
|  |  | - request: |
|  |  | user: user:jon |
|  |  | type: document |
|  |  | relation: viewer |
|  |  | expectation: |
|  |  | - name: cycle\_and\_true\_return\_false |
|  |  | stages: |
|  |  | - model: | |
|  |  | model |
|  |  | schema 1.1 |
|  |  |  |
|  |  | type user |
|  |  |  |
|  |  | type document |
|  |  | relations |
|  |  | define allowed: [user] |
|  |  | define viewer: [user, document#viewer] and allowed |
|  |  | tuples: |
|  |  | - user: user:jon |
|  |  | relation: allowed |
|  |  | object: document:1 |
|  |  | - user: document:1#viewer |
|  |  | relation: viewer |
|  |  | object: document:1 |
|  |  | checkAssertions: |
|  |  | - tuple: |
|  |  | object: document:1 |
|  |  | relation: viewer |
|  |  | user: user:jon |
|  |  | expectation: false |
|  |  | listObjectsAssertions: |
|  |  | - request: |
|  |  | user: user:jon |
|  |  | type: document |
|  |  | relation: viewer |
|  |  | expectation: |
|  |  | - name: immediate\_cycle\_return\_false |
|  |  | stages: |
|  |  | - model: | |
|  |  | model |
|  |  | schema 1.1 |
|  |  |  |
|  |  | type user |
|  |  |  |
|  |  | type document |
|  |  | relations |
|  |  | define viewer: [user, document#viewer] |
|  |  | tuples: |
|  |  | - user: document:1#viewer |
|  |  | relation: viewer |
|  |  | object: document:1 |
|  |  | checkAssertions: |
|  |  | - tuple: |
|  |  | object: document:1 |
|  |  | relation: viewer |
|  |  | user: user:jon |
|  |  | expectation: false |
|  |  | listObjectsAssertions: |
|  |  | - request: |
|  |  | user: user:jon |
|  |  | type: document |
|  |  | relation: viewer |
|  |  | expectation: |
|  |  | - name: cycle\_butnot\_false\_return\_false |
|  |  | stages: |
|  |  | - model: | |
|  |  | model |
|  |  | schema 1.1 |
|  |  |  |
|  |  | type user |
|  |  |  |
|  |  | type document |
|  |  | relations |
|  |  | define restricted: [user] |
|  |  | define viewer: [user, document#viewer] but not restricted |
|  |  | tuples: |
|  |  | - user: document:1#viewer |
|  |  | relation: viewer |
|  |  | object: document:1 |
|  |  | checkAssertions: |
|  |  | - tuple: |
|  |  | object: document:1 |
|  |  | relation: viewer |
|  |  | user: user:jon |
|  |  | expectation: false |
|  |  | listObjectsAssertions: |
|  |  | - request: |
|  |  | user: user:jon |
|  |  | type: document |
|  |  | relation: viewer |
|  |  | expectation: |
|  |  | - name: false\_butnot\_cycle\_return\_false |
|  |  | stages: |
|  |  | - model: | |
|  |  | model |
|  |  | schema 1.1 |
|  |  |  |
|  |  | type user |
|  |  |  |
|  |  | type document |
|  |  | relations |
|  |  | define restricted: [user, document#viewer] |
|  |  | define viewer: [user] but not restricted |
|  |  | tuples: |
|  |  | - user: document:1#viewer |
|  |  | relation: restricted |
|  |  | object: document:1 |
|  |  | checkAssertions: |
|  |  | - tuple: |
|  |  | object: document:1 |
|  |  | relation: viewer |
|  |  | user: user:jon |
|  |  | expectation: false |
|  |  | listObjectsAssertions: |
|  |  | - request: |
|  |  | user: user:jon |
|  |  | type: document |
|  |  | relation: viewer |
|  |  | expectation: |
|  |  | - name: err\_and\_err\_return\_err |
|  |  | stages: |
|  |  | - model: | |
|  |  | model |
|  |  | schema 1.1 |
|  |  | type user |
|  |  | type resource |
|  |  | relations |
|  |  | define a1: a2 |
|  |  | define a2: a3 |
|  |  | define a3: a4 |
|  |  | define a4: a5 |
|  |  | define a5: a6 |
|  |  | define a6: a7 |
|  |  | define a7: a8 |
|  |  | define a8: a9 |
|  |  | define a9: a10 |
|  |  | define a10: a11 |
|  |  | define a11: a12 |
|  |  | define a12: a13 |
|  |  | define a13: a14 |
|  |  | define a14: a15 |
|  |  | define a15: a16 |
|  |  | define a16: a17 |
|  |  | define a17: a18 |
|  |  | define a18: a19 |
|  |  | define a19: a20 |
|  |  | define a20: a21 |
|  |  | define a21: a22 |
|  |  | define a22: a23 |
|  |  | define a23: a24 |
|  |  | define a24: a25 |
|  |  | define a25: a26 |
|  |  | define a26: [user] |
|  |  | define can\_view: a1 and a1 |
|  |  | tuples: |
|  |  | - object: resource:abc |
|  |  | relation: a26 |
|  |  | user: user:maria |
|  |  | checkAssertions: |
|  |  | - tuple: |
|  |  | object: resource:abc |
|  |  | relation: can\_view |
|  |  | user: user:maria |
|  |  | errorCode: 2002 |
|  |  | listObjectsAssertions: |
|  |  | - request: |
|  |  | type: resource |
|  |  | relation: can\_view |
|  |  | user: user:maria |
|  |  | errorCode: 2002 |
|  |  | - name: err\_and\_true\_return\_err |
|  |  | stages: |
|  |  | - model: | |
|  |  | model |
|  |  | schema 1.1 |
|  |  | type user |
|  |  | type resource |
|  |  | relations |
|  |  | define a1: a2 |
|  |  | define a2: a3 |
|  |  | define a3: a4 |
|  |  | define a4: a5 |
|  |  | define a5: a6 |
|  |  | define a6: a7 |
|  |  | define a7: a8 |
|  |  | define a8: a9 |
|  |  | define a9: a10 |
|  |  | define a10: a11 |
|  |  | define a11: a12 |
|  |  | define a12: a13 |
|  |  | define a13: a14 |
|  |  | define a14: a15 |
|  |  | define a15: a16 |
|  |  | define a16: a17 |
|  |  | define a17: a18 |
|  |  | define a18: a19 |
|  |  | define a19: a20 |
|  |  | define a20: a21 |
|  |  | define a21: a22 |
|  |  | define a22: a23 |
|  |  | define a23: a24 |
|  |  | define a24: a25 |
|  |  | define a25: a26 |
|  |  | define a26: [user] |
|  |  | define can\_view: a1 and a26 |
|  |  | tuples: |
|  |  | - object: resource:abc |
|  |  | relation: a26 |
|  |  | user: user:maria |
|  |  | checkAssertions: |
|  |  | - tuple: |
|  |  | object: resource:abc |
|  |  | relation: can\_view |
|  |  | user: user:maria |
|  |  | errorCode: 2002 |
|  |  | listObjectsAssertions: |
|  |  | - request: |
|  |  | type: resource |
|  |  | relation: can\_view |
|  |  | user: user:maria |
|  |  | errorCode: 2002 |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `b6a6d99`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenfga%2Fopenfga%2Fcommit%2Fb6a6d99b2bdbf8c3781503989576076289f48ed2) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


