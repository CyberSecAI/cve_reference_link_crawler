[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F067cdcd3f2e9&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40arielbreisacher%2Fmy-chart-fx-7-software-investigation-journey-leading-to-a-directory-traversal-vulnerability-067cdcd3f2e9&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40arielbreisacher%2Fmy-chart-fx-7-software-investigation-journey-leading-to-a-directory-traversal-vulnerability-067cdcd3f2e9&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# My Chart FX 7 software investigation journey leading to a Directory Traversal vulnerability (CVE-2023–39611)

[![Ariel Breisacher](https://miro.medium.com/v2/resize:fill:88:88/1*nG0OiXR6If4rzoWmgZeuLw.jpeg)](/%40arielbreisacher?source=post_page---byline--067cdcd3f2e9--------------------------------)

[Ariel Breisacher](/%40arielbreisacher?source=post_page---byline--067cdcd3f2e9--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbe623e5edf37&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40arielbreisacher%2Fmy-chart-fx-7-software-investigation-journey-leading-to-a-directory-traversal-vulnerability-067cdcd3f2e9&user=Ariel+Breisacher&userId=be623e5edf37&source=post_page-be623e5edf37--byline--067cdcd3f2e9---------------------post_header-----------)

6 min read·Jan 31, 2024

--

Listen

Share

**About the Software**

Chart FX 7 is a data visualization library that allows developers to create a variety of charts. It supports various platforms and languages, providing tools for creating interactive and visually compelling charts in web and desktop applications. With a user-friendly interface, Chart FX 7 simplifies the integration of powerful data visualization capabilities into diverse software projects.

In this blog post we will focus on the v7.0.4962.20829 version.

**Vulnerability**

Directory Traversal (also known as Path Traversal) is a web security vulnerability that allows an attacker to read arbitrary files on the server that is running an application. This might include application code and data, credentials for back-end systems, and sensitive operating system files.

**Reverse Engineering Process**

During my work as a penetration tester and red teamer in Sompo Digital Lab Tel Aviv, I encountered the Chart FX 7 product and decided to download the trial version and play with it.

I have downloaded the SoftwareFX’s Chart FX 7 for .NET based application trial version from the Software FX official site:

<https://www.softwarefx.com/products/chartfx/visual-studio/chartfx-7/features.aspx>

While analysing the file structure of the software I have noticed the ChartFX.PSS.HttpHandler.dll in the Bin directory.

The HTTP handler DLL files within the product directory are used to handle HTTP communication in ASP.NET web applications, therefore the ChartFX.PSS.HttpHandler.dll file needs to be added to the ASP.NET web application in order for ChartFX 7 to work.

I started to investigate the ChartFX 7 software by opening the ChartFX.PSS.HttpHandler.dll in the dnSpy de-compiler tool to decompile the executable file to C#.

Link to dnSpy tool: <https://github.com/dnSpy/dnSpy>

![]()

Figure 1.1 Chart FX HTTP handler DLL files

I found that the HTTP Handler passes the HTTP arguments to a PSS service using the TCP protocol on port 8082

![]()

Figure 1.2 HTTP handler communication destination

I decided to search the PSS service that the HTTP Handler communicates with and to investigate its files. I found the PSS service on Task Manager and opened it’s files location.

![]()

Figure 1.3 PSS service in Task Manager

The PSS service files are located under the “PSS” directory, I started from the ChartFX.PSS.Service.exe.config file, which contains configurations including an optional folder directory for the output files and the same TCP channel as I found above.

![]()

Figure 1.4 PSS service files

![]()

Figure 1.5 PSS service configuration file

Next, I opened the ChartFX.PSS.Service.exe file in the dnSpy decompiler tool. Note that the used version is v7.0.4962.20829.

![]()

Figure 1.6 PSS service info

After following the code flow from the HTTP Handler to the PSS service and back, I came to those conclusions:

The HTTP request to the chartfx70/pss/ChartFX.aspx endpoint receives the following 3 parameters: id, type, mime.

![]()

Figure 1.7 Required HTTP request input parameters in the HTTP handler

1. The “id” parameter is comprised of a digit following a hyphen and then digits representing part of the filename — the part after the ‘-’ character of the parameter value will be interpreted as part of the filename to be read.

For example, in the following “id” value of “0–071217250”, the “071217250” will be part of the file name that the software will try to read.

2. The “type” parameter value is added to the end of the file name that the software will try to read.

For example, in the following “type” value of “png”, the file name that the software will try to read will end with “png”.

3. The “mime” parameter value determines the content type header for the HTTP response. Note that this parameter is not used in the construction of the file name to be read.

For example, in the following “mime” value of “image/png”, the value of the HTTP response Content-Type header will be “image/png”.

To explain the code flow, I will use the following unauthenticated HTTP GET request as an example:

<http://localhost:2096/chartfx70/pss/ChartFX.aspx?id=0-071217250&type=png&mime=image%2Fpng>

By following the arguments input passed to ChartFX.PSS.Service.exe I found that the software uses those arguments to determine the full path of the file to be returned to the client.

Here we can see that the software looks for the hyphen character and splits the “id” argument into two variables:

![]()

Figure 1.8 PSS service split the “id” argument

In our example, the “0–071217250” value will be split into “0” and “071217250”.

Here we can see that the software combines some strings to get the file name to be read:

![]()

Figure 1.9 File name combination in the PSS service

In function c, the software combines the user’s current name(or “anonymous” if unauthenticated) to the end of the “this.a” variable, which contains the value of the A\_2 parameter (shown in Figure 1.8).

In our example, the “(anonymous)” value will be combined with “071217250” to return the following string:”071217250(anonymous)”.

Then, in function a, the software will combine the “A\_0” value, which contains the “type” argument value with the “this.c” variable which contains the returned string from function c.

In our example, the “png” value will be combined with “071217250(anonymous)” to return the following string: “071217250(anonymous)\_png”.

Now, function b combines the “A\_0” string, the string returned from function a (shown in Figure 1.9), with “this.o” variable which contains one of those options:

1. The %TempPath% value, located in the ChartFX.PSS.Service.exe.config (shown in image 1.1).
2. The “Temp” folder, under the “PSS” directory.

Then, the software reads this file and returns it as an HTTP response:

![]()

Figure 1.10 Read file in the PSS service

So for our example, the software will return the following file:

C:\Program Files (x86)\Chart FX 7\PSS\Temp\071217250(anonymous)\_png

Additionally, we found in the ChartFX.PSS.HttpHandler.dll file that the “mime” argument is used to determine the HTTP response content type:

![]()

Figure 1.11 HTTP response content type determination in the HTTP handler

**Proof of Concept**

Now, when we have all the relevant information such as the file name convention and the file location we can access all the files located on the filesystem that the PSS service has access to, including files located on other partitions.

Let’s show some examples:

Example 1: File system files located on the same partition (drive letter C) as the PSS service output files folder.

Payload: [http://localhost:2096/chartfx70/pss/ChartFX.aspx?id=0-012320280&type=..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\windows\win.ini&mime=image%2Fpng](http://localhost:2096/chartfx70/pss/ChartFX.aspx?id=0-012320280&type=..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5Cwindows%5Cwin.ini&mime=image%2Fpng)

the following request will return the C:\windows\win.ini file with the “image/png” content type (the number of dot-dot-slash needed depends on the %TempPath% value located in the ChartFX.PSS.Service.exe.config or “Temp” folder, under the “PSS” directory in my situation).

![]()

Figure 2.1 C:\windows\win.ini file content

Example 2: Source code file located on another partition (drive letter D).

Payload: [http://localhost:2096/chartfx70/pss/ChartFX.aspx?id=0-d:&type=\\..\aa\Default.aspx&mime=text/html](http://localhost:2096/chartfx70/pss/ChartFX.aspx?id=0-d%3A&type=%5C%5C..%5Caa%5CDefault.aspx&mime=text%2Fhtml)

The C# Path.Combine function allows the second argument to overwrite the first one in case the second argument starts with a drive letter.

In this example, the second argument will be d:(anonymous)\..\aa\Default.aspx, which will read the D:\aa\Default.aspx file and represent it as an ASPX file(since the content type is “text\html”).

Note that since the HTTP response content type is “text\html”, attackers may potentially exploit attacks such as XSS.

![]()

Figure 2.2 D:\aa\Default.aspx file content

Example 3: Configuration file located on another partition (drive letter D).

Payload: [http://localhost:2096/chartfx70/pss/ChartFX.aspx?id=0-d:&type=\\..\web.config&mime=application/x-msdownload](http://localhost:2096/chartfx70/pss/ChartFX.aspx?id=0-d%3A&type=%5C%5C..%5Cweb.config&mime=application%2Fx-msdownload)

In this example, the second argument will be d:(anonymous)\..\web.config, which will read the D:\web.config file and download it to our machine from the browser (since the content type is “application\x-msdownload”).

![]()

Figure 2.3 D:\web.config file content

This vulnerability allows unauthenticated users to traverse the path of the web server in order to access and download files located on the hosting server filesystem that should not be publicly accessible.

CVE ID: CVE-2023–39611

**Disclosure Timeline**

Reported to the vendor: Feb 2023

Reported to the MITRE: 27th Jul 2023

CVE Assigned: 28th Aug 2023

**Discovered By**

Ariel Breisacher, Sompo Digital Lab Tel Aviv — Cyber Center of Excellence

**References**

My LinkedIn: <https://il.linkedin.com/in/ariel-breisacher-ba3079211>

About Sompo Digital Lab Tel Aviv: <https://sompo.io/en/about>

--

--

[![Ariel Breisacher](https://miro.medium.com/v2/resize:fill:96:96/1*nG0OiXR6If4rzoWmgZeuLw.jpeg)](/%40arielbreisacher?source=post_page---post_author_info--067cdcd3f2e9--------------------------------)[![Ariel Breisacher](https://miro.medium.com/v2/resize:fill:128:128/1*nG0OiXR6If4rzoWmgZeuLw.jpeg)](/%40arielbreisacher?source=post_page---post_author_info--067cdcd3f2e9--------------------------------)Follow[## Written by Ariel Breisacher](/%40arielbreisacher?source=post_page---post_author_info--067cdcd3f2e9--------------------------------)[1 Follower](/%40arielbreisacher/followers?source=post_page---post_author_info--067cdcd3f2e9--------------------------------)·[1 Following](/%40arielbreisacher/following?source=post_page---post_author_info--067cdcd3f2e9--------------------------------)

Red Team Researcher

Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----067cdcd3f2e9--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----067cdcd3f2e9--------------------------------)[About](/about?autoplay=1&source=post_page-----067cdcd3f2e9--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----067cdcd3f2e9--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----067cdcd3f2e9--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----067cdcd3f2e9--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----067cdcd3f2e9--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----067cdcd3f2e9--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----067cdcd3f2e9--------------------------------)[Teams](/business?source=post_page-----067cdcd3f2e9--------------------------------)

