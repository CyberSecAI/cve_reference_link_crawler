- **Root cause of vulnerability:** The vulnerability stems from an incomplete blacklist in the `HtmlSanitizer` class, which allows the `button` tag with the `formaction` attribute without sanitizing it. This permits the injection of arbitrary JavaScript code.
- **Weaknesses/vulnerabilities present:** Cross-site scripting (XSS) vulnerability due to insufficient sanitization of user-provided HTML content. Specifically, the `formaction` attribute of the `button` tag is not properly sanitized.
- **Impact of exploitation:** Successful exploitation leads to arbitrary JavaScript code injection, allowing an attacker to perform malicious actions on behalf of the victim user, such as stealing session cookies, redirecting users to malicious sites, or performing other unauthorized operations.
- **Attack vectors:** An attacker can inject malicious HTML code containing the vulnerable `button` tag via HTTP requests.
- **Required attacker capabilities/position:** The attacker needs the ability to submit HTTP requests to modify content that will be rendered by a user. In this specific case, the attacker crafts a POST request to edit news content, injecting the malicious HTML with the `button` tag and `formaction` attribute. The attacker also needs to be an authenticated user with appropriate rights to edit news content.