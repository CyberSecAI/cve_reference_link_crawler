[Skip to main content](#main)Why Spring

* [Overview](/why-spring)
* [Microservices](/microservices)
* [Reactive](/reactive)
* [Event Driven](/event-driven)
* [Cloud](/cloud)
* [Web Applications](/web-applications)
* [Serverless](/serverless)
* [Batch](/batch)
Learn

* [Overview](/learn)
* [Quickstart](/quickstart)
* [Guides](/guides)
* [Blog](/blog)
Projects

* [Overview](/projects)
* [Spring Boot](/projects/spring-boot)
* [Spring Framework](/projects/spring-framework)
* [Spring Cloud](/projects/spring-cloud)
* [Spring Cloud Data Flow](/projects/spring-cloud-dataflow)
* [Spring Data](/projects/spring-data)
* [Spring Integration](/projects/spring-integration)
* [Spring Batch](/projects/spring-batch)
* [Spring Security](/projects/spring-security)
* [Spring AI](/projects/spring-ai)
* [View all projects](/projects)
* [Release Calendar](/projects#release-calendar)
* DEVELOPMENT TOOLS
* [Spring Tools 4](/tools)
* [Spring Initializr](https://start.spring.io/)
Academy

* [Courses](https://spring.academy/courses)
* [Get Certified](https://spring.academy/learning-path)
Solutions

* [Overview](/solutions)
* [Tanzu Spring](/support)
* [Spring Consulting](/consulting)
* [Spring Academy](https://spring.academy/)
* [Security Advisories](/security)
Community

* [Overview](/community)
* [Events](/events)
* [Authors](/authors)
# [Spring Security Advisories](/security)

[RSS feed](/security.atom)
# CVE-2022-31692: Authorization rules can be bypassed via forward or include dispatcher types in Spring Security

HIGH | OCTOBER 31, 2022 | CVE-2022-31692
# Description

Spring Security, versions **5.7** prior to **5.7.5** and **5.6** prior to **5.6.9** could be susceptible to authorization rules bypass via forward or include dispatcher types.

Specifically, an application is vulnerable when all of the following are true:

* The application expects that Spring Security applies security to forward and include dispatcher types.
* The application uses the `AuthorizationFilter` either manually or via the `authorizeHttpRequests()` method.
* The application configures the `FilterChainProxy` to apply to forward and/or include requests (e.g. `spring.security.filter.dispatcher-types = request, error, async, forward, include`).
* The application may forward or include the request to a higher privilege-secured endpoint.
* The application configures Spring Security to apply to every dispatcher type via `authorizeHttpRequests().shouldFilterAllDispatcherTypes(true)`

An application is not vulnerable if any of the following is true:

* The application does not use `authorizeHttpRequests()` or the `AuthorizationFilter`.
* The application does not forward/include requests.
* The application does not need to configure Spring Security to apply to FORWARD and INCLUDE dispatcher types.

# Affected Spring Products and Versions

* Spring Security
  + 5.7.0 to 5.7.4
  + 5.6.0 to 5.6.8

# Mitigation

Users of affected versions should apply the following mitigations:

* 5.7.x users should upgrade to 5.7.5
* 5.6.x users should upgrade to 5.6.9
* Users who cannot change versions, should use `authorizeRequests().filterSecurityInterceptorOncePerRequest(false)` instead of `authorizeHttpRequests().shouldFilterAllDispatcherTypes(true)`
* Users with version < 5.7.0 which does not have `shouldFilterAllDispatcherTypes` available, should add an `ObjectPostProcessor`:
  ```
  authorizeHttpRequests().withObjectPostProcessor(new
  ObjectPostProcessor() {
    @Override
    public O postProcess(O filter) {
     filter.setObserveOncePerRequest(false);
     filter.setFilterAsyncDispatch(true);
     filter.setFilterErrorDispatch(true);
     return filter;
    }});
  ```

Note that in Spring Security 5, the default behavior is to not apply the filters more than once to a request, therefore you have to explicitly configure Spring Security to do that. In addition, the FilterChainProxy is also not configured to be invoked on forward and include dispatcher types, depending on you to do it yourself.

Releases that have fixed this issue include:

* Spring Security
  + 5.7.5
  + 5.6.9

# Credit

This issue was identified and responsibly reported by Osword from SGLAB of Legendsec at Qi'anxin Group.

# References

* <https://docs.spring.io/spring-security/reference/servlet/authorization/authorize-http-requests.html>

# History

* 2022-10-31: Initial vulnerability report published.
## Reporting a vulnerability

To report a security vulnerability for a project within the Spring portfolio, see the [Security Policy](/security-policy)

![](/img/extra/footer.svg)
## Get ahead

VMware offers training and certification to turbo-charge your progress.

[Learn more](https://spring.academy/)
## Get support

Tanzu Spring offers support and binaries for OpenJDK™, Spring, and Apache Tomcat® in one simple subscription.

[Learn more](/support)
## Upcoming events

Check out all the upcoming events in the Spring community.

[View all](/events)[Why Spring](/why-spring)[Microservices](/microservices)[Reactive](/reactive)[Event Driven](/event-driven)[Cloud](/cloud)[Web Applications](/web-applications)[Serverless](/serverless)[Batch](/batch)[Learn](/learn)[Quickstart](/quickstart)[Guides](/guides)[Blog](/blog)[Community](/community)[Events](/events)[Authors](/authors)[Solutions](/overview)[Tanzu Spring](/support)[Spring Consulting](/consulting)[Spring Academy](https://spring.academy/)[Spring Advisories](/security)[Projects](/projects)[Thank You](/thank-you)
## Get the Spring newsletter

Stay connected with the Spring newsletter

[Subscribe](https://go-vmware.broadcom.com/tnz-spring-newsletter-subscribe)

Copyright © 2005 - 2025 Broadcom. All Rights Reserved. The term "Broadcom" refers to Broadcom Inc. and/or its subsidiaries.
[Terms of Use](https://www.vmware.com/help/legal.html) • [Privacy](https://www.vmware.com/help/privacy.html) • [Trademark Guidelines](/trademarks) • [Your California Privacy Rights](https://www.vmware.com/help/privacy/california-privacy-rights.html)

Apache®, Apache Tomcat®, Apache Kafka®, Apache Cassandra™, and Apache Geode™ are trademarks or registered trademarks of the Apache Software Foundation in the United States and/or other countries. Java™, Java™ SE, Java™ EE, and OpenJDK™ are trademarks of Oracle and/or its affiliates. Kubernetes® is a registered trademark of the Linux Foundation in the United States and other countries. Linux® is the registered trademark of Linus Torvalds in the United States and other countries. Windows® and Microsoft® Azure are registered trademarks of Microsoft Corporation. “AWS” and “Amazon Web Services” are trademarks or registered trademarks of Amazon.com Inc. or its affiliates. All other trademarks and copyrights are property of their respective owners and are only mentioned for informative purposes. Other names may be trademarks of their respective owners.

