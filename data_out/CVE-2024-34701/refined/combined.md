=== Content from github.com_2b0f393f_20250110_150832.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmiraheze%2FCreateWiki%2Fsecurity%2Fadvisories%2FGHSA-89fx-77w7-rc64)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmiraheze%2FCreateWiki%2Fsecurity%2Fadvisories%2FGHSA-89fx-77w7-rc64)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=miraheze%2FCreateWiki)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[miraheze](/miraheze)
/
**[CreateWiki](/miraheze/CreateWiki)**
Public

* [Notifications](/login?return_to=%2Fmiraheze%2FCreateWiki) You must be signed in to change notification settings
* [Fork
  39](/login?return_to=%2Fmiraheze%2FCreateWiki)
* [Star
   25](/login?return_to=%2Fmiraheze%2FCreateWiki)

* [Code](/miraheze/CreateWiki)
* [Pull requests
  8](/miraheze/CreateWiki/pulls)
* [Actions](/miraheze/CreateWiki/actions)
* [Security](/miraheze/CreateWiki/security)
* [Insights](/miraheze/CreateWiki/pulse)

Additional navigation options

* [Code](/miraheze/CreateWiki)
* [Pull requests](/miraheze/CreateWiki/pulls)
* [Actions](/miraheze/CreateWiki/actions)
* [Security](/miraheze/CreateWiki/security)
* [Insights](/miraheze/CreateWiki/pulse)

# Impersonation of wiki requester

Moderate

[redbluegreenhat](/redbluegreenhat)
published
GHSA-89fx-77w7-rc64
May 12, 2024

## Package

CreateWiki
(MediaWiki)

## Affected versions

<02e0f298f8d35155c39aa74193cb7b867432c5b8

## Patched versions

02e0f298f8d35155c39aa74193cb7b867432c5b8

## Description

### Impact

It is possible for users to be considered as the requester of a specific wiki request if their local user ID on any wiki in a wiki farm matches the local ID of the requester at the wiki where the wiki request was made.

This allows them to go to that request entry's on Special:RequestWikiQueue on the wiki where their local user ID matches and take any actions that the wiki requester is allowed to take from there.

### Patches

[02e0f29](https://github.com/miraheze/CreateWiki/commit/02e0f298f8d35155c39aa74193cb7b867432c5b8)

Important note about the fix: This vulnerability has been fixed by disabling access to the REST API and special pages outside of the wiki configured as the "global wiki" in `$wgCreateWikiGlobalWiki` in your MediaWiki settings.

### Workarounds

It is possible to disable the special pages outside of your global wiki by doing something similar to [miraheze/mw-config@e566499](https://github.com/miraheze/mw-config/commit/e5664995fbb8644f9a80b450b4326194f20f9ddc). You must adapt that to your setup.

As for the REST API, before the fix, there wasn't any REST endpoint that allowed to make writes. Regardless, it is possible to also disable it outside of the global wiki by using `$wgCreateWikiDisableRESTAPI` and `$wgConf` in the configuration for your wiki farm. See [miraheze/mw-config@1798e53](https://github.com/miraheze/mw-config/commit/1798e53901a202b62edab32f8bcd5c6b9e574191)

### References

* <https://issue-tracker.miraheze.org/T12102>
* <https://issue-tracker.miraheze.org/T12011>

### Severity

Moderate

5.9

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
High

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
None

Integrity
High

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N

### CVE ID

CVE-2024-34701

### Weaknesses

No CWEs

### Credits

* [![@redbluegreenhat](https://avatars.githubusercontent.com/u/107424288?s=40&v=4)](/redbluegreenhat)
  [redbluegreenhat](/redbluegreenhat)
  Remediation developer

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from issue-tracker.miraheze.org_f6f166b4_20250110_150834.html ===
Page Menu[HomeMiraheze](/)

* SearchConfigure Global Search

[Log In](https://issue-tracker.miraheze.org/auth/start/?next=%2FT12102)[Create Task](/maniphest/task/edit/nocreate/) [Maniphest](/maniphest/)  T12102
# You can impersonate a wiki requester if you manage to get the same local ID in a wiki as the requester's local IDClosed, Resolved[Public](/policy/explain/PHID-TASK-w4edsjazetuykhvrxge2/view/)Actions

* [Edit Task](/maniphest/task/edit/12102/)
* Edit Related Tasks...
* [Create Subtask](/maniphest/task/subtask/12102/)
* [Edit Parent Tasks](/search/rel/task.has-parent/PHID-TASK-w4edsjazetuykhvrxge2/)
* [Edit Subtasks](/search/rel/task.has-subtask/PHID-TASK-w4edsjazetuykhvrxge2/)
* [Merge Duplicates In](/search/rel/task.merge-in/PHID-TASK-w4edsjazetuykhvrxge2/)
* [Close As Duplicate](/search/rel/task.close-as-duplicate/PHID-TASK-w4edsjazetuykhvrxge2/)
* Edit Related Objects...
* [Edit Commits](/search/rel/task.has-commit/PHID-TASK-w4edsjazetuykhvrxge2/)
* [Edit Revisions](/search/rel/task.has-revision/PHID-TASK-w4edsjazetuykhvrxge2/)
* Subscribe
* [Mute Notifications](/subscriptions/mute/PHID-TASK-w4edsjazetuykhvrxge2/)
* [Flag For Later](/flag/edit/PHID-TASK-w4edsjazetuykhvrxge2/)
* [Award Token](/token/give/PHID-TASK-w4edsjazetuykhvrxge2/)

Assigned To

|  | [OrangeStar](/p/OrangeStar/) |
| --- | --- |

Authored By

|  | [OrangeStar](/p/OrangeStar/) |
| --- | --- |
| May 3 2024, 10:322024-05-03 10:32:15 (UTC+0) |

Tags

* [Security](/tag/security/) [(Backlog)](/project/board/58/)
* [CreateWiki](/tag/createwiki/) [(Backlog)](/project/board/4/)
* [Technology-Team (MediaWiki)](/tag/technology-team_mediawiki/) [(Backlog)](/project/board/62/)
Referenced FilesNoneSubscribers

|  | [AmandaCath](/p/AmandaCath/) |
| --- | --- |

|  | [BrandonWM](/p/BrandonWM/) |
| --- | --- |

|  | [Joritochip](/p/Joritochip/) |
| --- | --- |

|  | [OrangeStar](/p/OrangeStar/) |
| --- | --- |

|  | [Void](/p/Void/) |
| --- | --- |

# Description

RequestWikiRequestViewer does a simple check to find out if the current user is the requester of the current wiki request. It simply compares their local IDs:

<https://github.com/miraheze/CreateWiki/blob/d4ddc2ff2b96224c455e27d39ef24beb6d0046a7/includes/RequestWiki/RequestWikiRequestViewer.php#L127> (comment added separately)

```
// Second condition after the OR is the one checking if the requester is the same as the current user
if ( $permissionManager->userHasRight( $userR, 'createwiki' ) && !$userR->getBlock() || $userR->getId() == $request->requester->getId() )
```

This check would've been enough if the special pages were only available on CreateWikiGlobalWiki ([T12011: Restrict the CreateWiki special pages and API to the global wiki](/T12011)), but that's not the case as of writing.

If, in a wiki, you manage to get the same local ID as the requester of a specific wiki request, you can post comments or edit the wiki request as if you were them, by going to that request's entry on Special:RequestWikiQueue on your wiki. It is very difficult to investigate successful attempts at exploiting this vulnerability.

# Related Objects

* Mentions

Mentioned In [R9:e5664995fbb8: T12102: Disable CreateWiki's special pages outside of the global wikis (#5551)](/R9%3Ae5664995fbb8644f9a80b450b4326194f20f9ddc) Mentioned Here [T12011: Restrict the CreateWiki special pages and API to the global wiki](/T12011)
### Event Timeline

[OrangeStar](/p/OrangeStar/) created this task.[May 3 2024, 10:322024-05-03 10:32:15 (UTC+0)](#242406)[Herald](/herald/) added a subscriber: [Void](/p/Void/).  · [View Herald Transcript](/herald/transcript/153983/)[May 3 2024, 10:322024-05-03 10:32:15 (UTC+0)](#242418)

[OrangeStar](/p/OrangeStar/) renamed this task from You can post comments cross-wiki if you manage to get the same local ID in a wiki as the requester's local ID to You can post comments and edit wiki requests cross-wiki if you manage to get the same local ID in a wiki as the requester's local ID.[May 3 2024, 10:332024-05-03 10:33:27 (UTC+0)](#242419)Comment Actions

The only true fix to this is [T12011](/T12011), there's really no other way.

Restricted Repository Identity mentioned this in [R9:e5664995fbb8: T12102: Disable CreateWiki's special pages outside of the global wikis (#5551)](/R9%3Ae5664995fbb8644f9a80b450b4326194f20f9ddc).[May 3 2024, 10:532024-05-03 10:53:42 (UTC+0)](#242421)

[OrangeStar](/p/OrangeStar/) added a comment.[May 3 2024, 17:592024-05-03 17:59:12 (UTC+0)](#242466)Comment Actions

Fixed in <https://github.com/miraheze/CreateWiki/commit/02e0f298f8d35155c39aa74193cb7b867432c5b8>, GHSA pending.

[OrangeStar](/p/OrangeStar/) changed the visibility from "[Custom Policy](/transactions/old/PHID-XACT-TASK-gsn3oqava2lh2zf/)" to "Public (No Login Required)".[May 12 2024, 10:042024-05-12 10:04:54 (UTC+0)](#242824)[OrangeStar](/p/OrangeStar/) changed the edit policy from "[Custom Policy](/transactions/old/PHID-XACT-TASK-dq2jydsn3mdnqfr/)" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-dq2jydsn3mdnqfr/)".[Herald](/herald/) added a subscriber: [BrandonWM](/p/BrandonWM/).  · [View Herald Transcript](/herald/transcript/154222/)[May 12 2024, 10:042024-05-12 10:04:54 (UTC+0)](#242826)[OrangeStar](/p/OrangeStar/) added a project: [CreateWiki](/tag/createwiki/).[May 12 2024, 10:052024-05-12 10:05:07 (UTC+0)](#242827)[Herald](/herald/) added a project: [Technology-Team (MediaWiki)](/tag/technology-team_mediawiki/).  · [View Herald Transcript](/herald/transcript/154223/)[May 12 2024, 10:052024-05-12 10:05:07 (UTC+0)](#242829)[Herald](/herald/) added subscribers: [AmandaCath](/p/AmandaCath/), [Joritochip](/p/Joritochip/).  · [View Herald Transcript](/herald/transcript/154223/)[OrangeStar](/p/OrangeStar/) renamed this task from You can post comments and edit wiki requests cross-wiki if you manage to get the same local ID in a wiki as the requester's local ID to You can impersonate a wiki requester if you manage to get the same local ID in a wiki as the requester's local ID.[May 12 2024, 10:232024-05-12 10:23:57 (UTC+0)](#242834)

[OrangeStar](/p/OrangeStar/) closed this task as Resolved.[May 12 2024, 10:322024-05-12 10:32:42 (UTC+0)](#242835)Comment Actions

GHSA published: <https://github.com/miraheze/CreateWiki/security/advisories/GHSA-89fx-77w7-rc64>

[Log In to Comment](/login/?next=%2FT12102)

=== Content from github.com_f36cf9bd_20250110_150833.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmiraheze%2Fmw-config%2Fcommit%2F1798e53901a202b62edab32f8bcd5c6b9e574191)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmiraheze%2Fmw-config%2Fcommit%2F1798e53901a202b62edab32f8bcd5c6b9e574191)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=miraheze%2Fmw-config)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[miraheze](/miraheze)
/
**[mw-config](/miraheze/mw-config)**
Public

* [Notifications](/login?return_to=%2Fmiraheze%2Fmw-config) You must be signed in to change notification settings
* [Fork
  248](/login?return_to=%2Fmiraheze%2Fmw-config)
* [Star
   85](/login?return_to=%2Fmiraheze%2Fmw-config)

* [Code](/miraheze/mw-config)
* [Pull requests
  14](/miraheze/mw-config/pulls)
* [Actions](/miraheze/mw-config/actions)
* [Security](/miraheze/mw-config/security)
* [Insights](/miraheze/mw-config/pulse)

Additional navigation options

* [Code](/miraheze/mw-config)
* [Pull requests](/miraheze/mw-config/pulls)
* [Actions](/miraheze/mw-config/actions)
* [Security](/miraheze/mw-config/security)
* [Insights](/miraheze/mw-config/pulse)

## Commit

[Permalink](/miraheze/mw-config/commit/1798e53901a202b62edab32f8bcd5c6b9e574191)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Add wgCreateWikiDisableRESTAPI ([#5549](https://github.com/miraheze/mw-config/pull/5549))

[Browse files](/miraheze/mw-config/tree/1798e53901a202b62edab32f8bcd5c6b9e574191)
Browse the repository at this point in the history

* Loading branch information

[![@redbluegreenhat](https://avatars.githubusercontent.com/u/107424288?s=40&v=4)](/redbluegreenhat)

[redbluegreenhat](/miraheze/mw-config/commits?author=redbluegreenhat "View all commits by redbluegreenhat")
authored
May 1, 2024

1 parent
[ad768c3](/miraheze/mw-config/commit/ad768c379757111c881964215c620285a3881704)

commit 1798e53

Showing
**1 changed file**
with
**5 additions**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

5 changes: 5 additions & 0 deletions

5
[LocalSettings.php](#diff-35b93cff8d87232a32e7a37a41c1e96682b8c911f123f1ffec8f3291b5bbfdb0 "LocalSettings.php")

Show comments

[View file](/miraheze/mw-config/blob/1798e53901a202b62edab32f8bcd5c6b9e574191/LocalSettings.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -928,6 +928,11 @@ |
|  |  | 'default' => 'wiki', |
|  |  | 'mirabeta' => 'wikibeta', |
|  |  | ], |
|  |  | 'wgCreateWikiDisableRESTAPI' => [ |
|  |  | 'default' => true, |
|  |  | 'metawiki' => false, |
|  |  | 'metawikibeta' => false, |
|  |  | ], |
|  |  | 'wgCreateWikiGlobalWiki' => [ |
|  |  | 'default' => 'metawiki', |
|  |  | 'mirabeta' => 'metawikibeta', |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `1798e53`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmiraheze%2Fmw-config%2Fcommit%2F1798e53901a202b62edab32f8bcd5c6b9e574191) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_871a8caa_20250110_150833.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmiraheze%2Fmw-config%2Fcommit%2Fe5664995fbb8644f9a80b450b4326194f20f9ddc)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmiraheze%2Fmw-config%2Fcommit%2Fe5664995fbb8644f9a80b450b4326194f20f9ddc)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=miraheze%2Fmw-config)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[miraheze](/miraheze)
/
**[mw-config](/miraheze/mw-config)**
Public

* [Notifications](/login?return_to=%2Fmiraheze%2Fmw-config) You must be signed in to change notification settings
* [Fork
  248](/login?return_to=%2Fmiraheze%2Fmw-config)
* [Star
   85](/login?return_to=%2Fmiraheze%2Fmw-config)

* [Code](/miraheze/mw-config)
* [Pull requests
  14](/miraheze/mw-config/pulls)
* [Actions](/miraheze/mw-config/actions)
* [Security](/miraheze/mw-config/security)
* [Insights](/miraheze/mw-config/pulse)

Additional navigation options

* [Code](/miraheze/mw-config)
* [Pull requests](/miraheze/mw-config/pulls)
* [Actions](/miraheze/mw-config/actions)
* [Security](/miraheze/mw-config/security)
* [Insights](/miraheze/mw-config/pulse)

## Commit

[Permalink](/miraheze/mw-config/commit/e5664995fbb8644f9a80b450b4326194f20f9ddc)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

T12102: Disable CreateWiki's special pages outside of the global wikis (

[Browse files](/miraheze/mw-config/tree/e5664995fbb8644f9a80b450b4326194f20f9ddc)
Browse the repository at this point in the history

```
[#5551](https://github.com/miraheze/mw-config/pull/5551))
```

* Loading branch information

[![@redbluegreenhat](https://avatars.githubusercontent.com/u/107424288?s=40&v=4)](/redbluegreenhat)

[redbluegreenhat](/miraheze/mw-config/commits?author=redbluegreenhat "View all commits by redbluegreenhat")
authored
May 3, 2024

1 parent
[36ab4e2](/miraheze/mw-config/commit/36ab4e200aaf55955b69b17cc2600b83de01c3a5)

commit e566499

Showing
**1 changed file**
with
**7 additions**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

7 changes: 7 additions & 0 deletions

7
[GlobalSettings.php](#diff-9e954f4a6ba579fb4ddf150f2b43ae3c53679fcb9609463a1ffdd5a1b25d2247 "GlobalSettings.php")

Show comments

[View file](/miraheze/mw-config/blob/e5664995fbb8644f9a80b450b4326194f20f9ddc/GlobalSettings.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -3,6 +3,7 @@ |
|  |  | use MediaWiki\Auth\LocalPasswordPrimaryAuthenticationProvider; |
|  |  | use MediaWiki\Extension\ConfirmEdit\Store\CaptchaCacheStore; |
|  |  | use MediaWiki\Html\Html; |
|  |  | use MediaWiki\SpecialPage\DisabledSpecialPage; |
|  |  | use MediaWiki\SpecialPage\SpecialPage; |
|  |  | use Miraheze\MirahezeMagic\MirahezeIRCRCFeedFormatter; |
|  |  |  |
| Expand All | | @@ -26,6 +27,12 @@ |
|  |  | }; |
|  |  | } |
|  |  |  |
|  |  | if ( $wi->dbname !== 'metawiki' && $wi->dbname !== 'metawikibeta' ) { |
|  |  | $wgSpecialPages['RequestWikiQueue'] = DisabledSpecialPage::getCallback( 'RequestWikiQueue', 'createwiki-requestwikiqueue-disabled' ); |
|  |  | $wgSpecialPages['RequestWiki'] = DisabledSpecialPage::getCallback( 'RequestWiki', 'createwiki-requestwiki-disabled' ); |
|  |  | $wgSpecialPages['CreateWiki'] = DisabledSpecialPage::getCallback( 'CreateWiki', 'createwiki-createwiki-disabled' ); |
|  |  | } |
|  |  |  |
|  |  | // Extensions |
|  |  | if ( $wi->dbname !== 'ldapwikiwiki' && $wi->dbname !== 'srewiki' ) { |
|  |  | wfLoadExtensions( [ |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `e566499`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmiraheze%2Fmw-config%2Fcommit%2Fe5664995fbb8644f9a80b450b4326194f20f9ddc) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_72c0b980_20250110_150832.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmiraheze%2FCreateWiki%2Fcommit%2F02e0f298f8d35155c39aa74193cb7b867432c5b8)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmiraheze%2FCreateWiki%2Fcommit%2F02e0f298f8d35155c39aa74193cb7b867432c5b8)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=miraheze%2FCreateWiki)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[miraheze](/miraheze)
/
**[CreateWiki](/miraheze/CreateWiki)**
Public

* [Notifications](/login?return_to=%2Fmiraheze%2FCreateWiki) You must be signed in to change notification settings
* [Fork
  39](/login?return_to=%2Fmiraheze%2FCreateWiki)
* [Star
   25](/login?return_to=%2Fmiraheze%2FCreateWiki)

* [Code](/miraheze/CreateWiki)
* [Pull requests
  8](/miraheze/CreateWiki/pulls)
* [Actions](/miraheze/CreateWiki/actions)
* [Security](/miraheze/CreateWiki/security)
* [Insights](/miraheze/CreateWiki/pulse)

Additional navigation options

* [Code](/miraheze/CreateWiki)
* [Pull requests](/miraheze/CreateWiki/pulls)
* [Actions](/miraheze/CreateWiki/actions)
* [Security](/miraheze/CreateWiki/security)
* [Insights](/miraheze/CreateWiki/pulse)

## Commit

[Permalink](/miraheze/CreateWiki/commit/02e0f298f8d35155c39aa74193cb7b867432c5b8)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

T12011: Disable the special pages and API outside of the global wiki ([#…](https://github.com/miraheze/CreateWiki/pull/519)

[Browse files](/miraheze/CreateWiki/tree/02e0f298f8d35155c39aa74193cb7b867432c5b8)
Browse the repository at this point in the history

```
[…519](https://github.com/miraheze/CreateWiki/pull/519))

<https://issue-tracker.miraheze.org/T12011>
```

* Loading branch information

[![@redbluegreenhat](https://avatars.githubusercontent.com/u/107424288?s=40&v=4)](/redbluegreenhat)

[redbluegreenhat](/miraheze/CreateWiki/commits?author=redbluegreenhat "View all commits by redbluegreenhat")
authored
May 3, 2024

1 parent
[64e86a8](/miraheze/CreateWiki/commit/64e86a8670a37a811b56504641e82f921be50a1e)

commit 02e0f29

 Show file tree

 Hide file tree

Showing
**8 changed files**
with
**74 additions**
and
**6 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* includes

  + CreateWiki

    - includes/CreateWiki/SpecialCreateWiki.php
      [SpecialCreateWiki.php](#diff-59e4ef217b3b5a4000dcb855bd3a3d990a59274ba8759b62ff558c8a77dac626)
  + includes/EntryPointUtils.php
    [EntryPointUtils.php](#diff-75ce79438c9ec0f96c49024ec08c3aac27d118016b4b936f1e1caf9cf183a227)
  + RequestWiki

    - Handler

      * includes/RequestWiki/Handler/RestWikiRequest.php
        [RestWikiRequest.php](#diff-57deec323e7c7ce4cecd11150fcc76d3b8e030726ec90c120a95a46623008037)
      * includes/RequestWiki/Handler/RestWikiRequestsByUser.php
        [RestWikiRequestsByUser.php](#diff-403978ba07ce47a9262434462227ed951e46a2466cf627e2d9a6176fb34aba68)
    - includes/RequestWiki/SpecialRequestWiki.php
      [SpecialRequestWiki.php](#diff-8592c9bef562e95bb95b7014aee11be576595d5240ddcc7228aa0a3f5971dd97)
    - includes/RequestWiki/SpecialRequestWikiQueue.php
      [SpecialRequestWikiQueue.php](#diff-4578162b3d77583e9976c3af00774c17b02117fdca078507056bd9672d73decf)
  + includes/RestUtils.php
    [RestUtils.php](#diff-b2e1f6a78778dc963b5486fc507a076d6232dbcab4c03cbccce7220bb700ccd7)
* tests/phpunit

  + tests/phpunit/SpecialRequestWikiTest.php
    [SpecialRequestWikiTest.php](#diff-911f03e304ea120e3bcf5fa31ef89fd9cf6a247c057000693775c5223c7d3415)

## There are no files selected for viewing

11 changes: 11 additions & 0 deletions

11
[includes/CreateWiki/SpecialCreateWiki.php](#diff-59e4ef217b3b5a4000dcb855bd3a3d990a59274ba8759b62ff558c8a77dac626 "includes/CreateWiki/SpecialCreateWiki.php")

Show comments

[View file](/miraheze/CreateWiki/blob/02e0f298f8d35155c39aa74193cb7b867432c5b8/includes/CreateWiki/SpecialCreateWiki.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -6,6 +6,7 @@ |
|  |  | use FormSpecialPage; |
|  |  | use Html; |
|  |  | use MediaWiki\MediaWikiServices; |
|  |  | use Miraheze\CreateWiki\EntryPointUtils; |
|  |  | use Miraheze\CreateWiki\Hooks\CreateWikiHookRunner; |
|  |  | use Miraheze\CreateWiki\WikiManager; |
|  |  |  |
| Expand All | | @@ -23,6 +24,16 @@ public function \_\_construct( CreateWikiHookRunner $hookRunner ) { |
|  |  | $this->hookRunner = $hookRunner; |
|  |  | } |
|  |  |  |
|  |  | public function execute( $par ) { |
|  |  | if ( !EntryPointUtils::currentWikiIsGlobalWiki() ) { |
|  |  | return $this->getOutput()->addHTML( |
|  |  | Html::errorBox( $this->msg( 'createwiki-wikinotglobalwiki' )->escaped() ) |
|  |  | ); |
|  |  | } |
|  |  |  |
|  |  | parent::execute( $par ); |
|  |  | } |
|  |  |  |
|  |  | protected function getFormFields() { |
|  |  | $par = $this->par; |
|  |  | $request = $this->getRequest(); |
| Expand Down | |  |

17 changes: 17 additions & 0 deletions

17
[includes/EntryPointUtils.php](#diff-75ce79438c9ec0f96c49024ec08c3aac27d118016b4b936f1e1caf9cf183a227 "includes/EntryPointUtils.php")

Show comments

[View file](/miraheze/CreateWiki/blob/02e0f298f8d35155c39aa74193cb7b867432c5b8/includes/EntryPointUtils.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,17 @@ |
|  |  | <?php |
|  |  | namespace Miraheze\CreateWiki; |
|  |  |  |
|  |  | use MediaWiki\MediaWikiServices; |
|  |  | use MediaWiki\WikiMap\WikiMap; |
|  |  |  |
|  |  | class EntryPointUtils { |
|  |  |  |
|  |  | public static function currentWikiIsGlobalWiki(): bool { |
|  |  | $config = MediaWikiServices::getInstance()->getConfigFactory()->makeConfig( 'CreateWiki' ); |
|  |  | if ( $config->get( 'CreateWikiGlobalWiki' ) === WikiMap::getCurrentWikiId() ) { |
|  |  | return true; |
|  |  | } else { |
|  |  | return false; |
|  |  | } |
|  |  | } |
|  |  | } |

5 changes: 2 additions & 3 deletions

5
[includes/RequestWiki/Handler/RestWikiRequest.php](#diff-57deec323e7c7ce4cecd11150fcc76d3b8e030726ec90c120a95a46623008037 "includes/RequestWiki/Handler/RestWikiRequest.php")

Show comments

[View file](/miraheze/CreateWiki/blob/02e0f298f8d35155c39aa74193cb7b867432c5b8/includes/RequestWiki/Handler/RestWikiRequest.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -6,6 +6,7 @@ |
|  |  | use MediaWiki\Config\ConfigFactory; |
|  |  | use MediaWiki\Rest\SimpleHandler; |
|  |  | use MediaWiki\User\UserFactory; |
|  |  | use Miraheze\CreateWiki\RestUtils; |
|  |  | use Wikimedia\Message\MessageValue; |
|  |  | use Wikimedia\ParamValidator\ParamValidator; |
|  |  | use Wikimedia\Rdbms\ILBFactory; |
| Expand Down  Expand Up | | @@ -41,9 +42,7 @@ public function \_\_construct( |
|  |  | } |
|  |  |  |
|  |  | public function run( $requestID ) { |
|  |  | if ( $this->config->get( 'CreateWikiDisableRESTAPI' ) ) { |
|  |  | return $this->getResponseFactory()->createLocalizedHttpError( 403, new MessageValue( 'createwiki-rest-disabled' ) ); |
|  |  | } |
|  |  | RestUtils::checkEnv(); |
|  |  | // Should be kept in sync with RequestWikiRequestViewer's $visibilityConds |
|  |  | $visibilityConds = [ |
|  |  | 0 => 'public', |
| Expand Down | |  |

5 changes: 2 additions & 3 deletions

5
[includes/RequestWiki/Handler/RestWikiRequestsByUser.php](#diff-403978ba07ce47a9262434462227ed951e46a2466cf627e2d9a6176fb34aba68 "includes/RequestWiki/Handler/RestWikiRequestsByUser.php")

Show comments

[View file](/miraheze/CreateWiki/blob/02e0f298f8d35155c39aa74193cb7b867432c5b8/includes/RequestWiki/Handler/RestWikiRequestsByUser.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -6,6 +6,7 @@ |
|  |  | use MediaWiki\Config\ConfigFactory; |
|  |  | use MediaWiki\Rest\SimpleHandler; |
|  |  | use MediaWiki\User\UserFactory; |
|  |  | use Miraheze\CreateWiki\RestUtils; |
|  |  | use Wikimedia\Message\MessageValue; |
|  |  | use Wikimedia\ParamValidator\ParamValidator; |
|  |  | use Wikimedia\Rdbms\ILBFactory; |
| Expand Down  Expand Up | | @@ -41,9 +42,7 @@ public function \_\_construct( |
|  |  | } |
|  |  |  |
|  |  | public function run( $userName ) { |
|  |  | if ( $this->config->get( 'CreateWikiDisableRESTAPI' ) ) { |
|  |  | return $this->getResponseFactory()->createLocalizedHttpError( 403, new MessageValue( 'createwiki-rest-disabled' ) ); |
|  |  | } |
|  |  | RestUtils::checkEnv(); |
|  |  | // Should be kept in sync with RequestWikiRequestViewer's $visibilityConds |
|  |  | $visibilityConds = [ |
|  |  | 0 => 'public', |
| Expand Down | |  |

7 changes: 7 additions & 0 deletions

7
[includes/RequestWiki/SpecialRequestWiki.php](#diff-8592c9bef562e95bb95b7014aee11be576595d5240ddcc7228aa0a3f5971dd97 "includes/RequestWiki/SpecialRequestWiki.php")

Show comments

[View file](/miraheze/CreateWiki/blob/02e0f298f8d35155c39aa74193cb7b867432c5b8/includes/RequestWiki/SpecialRequestWiki.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -12,6 +12,7 @@ |
|  |  | use MediaWiki\MediaWikiServices; |
|  |  | use Miraheze\CreateWiki\CreateWikiRegexConstraint; |
|  |  | use Miraheze\CreateWiki\Hooks\CreateWikiHookRunner; |
|  |  | use Miraheze\CreateWiki\EntryPointUtils; |
|  |  | use Title; |
|  |  |  |
|  |  | class SpecialRequestWiki extends FormSpecialPage { |
| Expand All | | @@ -29,6 +30,12 @@ public function \_\_construct( CreateWikiHookRunner $hookRunner ) { |
|  |  | } |
|  |  |  |
|  |  | public function execute( $par ) { |
|  |  | if ( !EntryPointUtils::currentWikiIsGlobalWiki() ) { |
|  |  | return $this->getOutput()->addHTML( |
|  |  | Html::errorBox( $this->msg( 'createwiki-wikinotglobalwiki' )->escaped() ) |
|  |  | ); |
|  |  | } |
|  |  |  |
|  |  | $request = $this->getRequest(); |
|  |  | $out = $this->getOutput(); |
|  |  |  |
| Expand Down | |  |

8 changes: 8 additions & 0 deletions

8
[includes/RequestWiki/SpecialRequestWikiQueue.php](#diff-4578162b3d77583e9976c3af00774c17b02117fdca078507056bd9672d73decf "includes/RequestWiki/SpecialRequestWikiQueue.php")

Show comments

[View file](/miraheze/CreateWiki/blob/02e0f298f8d35155c39aa74193cb7b867432c5b8/includes/RequestWiki/SpecialRequestWikiQueue.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2,8 +2,10 @@ |
|  |  |  |
|  |  | namespace Miraheze\CreateWiki\RequestWiki; |
|  |  |  |
|  |  | use Html; |
|  |  | use HTMLForm; |
|  |  | use Miraheze\CreateWiki\Hooks\CreateWikiHookRunner; |
|  |  | use Miraheze\CreateWiki\EntryPointUtils; |
|  |  | use SpecialPage; |
|  |  |  |
|  |  | class SpecialRequestWikiQueue extends SpecialPage { |
| Expand All | | @@ -18,6 +20,12 @@ public function \_\_construct( CreateWikiHookRunner $hookRunner ) { |
|  |  | } |
|  |  |  |
|  |  | public function execute( $par ) { |
|  |  | if ( !EntryPointUtils::currentWikiIsGlobalWiki() ) { |
|  |  | return $this->getOutput()->addHTML( |
|  |  | Html::errorBox( $this->msg( 'createwiki-wikinotglobalwiki' )->escaped() ) |
|  |  | ); |
|  |  | } |
|  |  |  |
|  |  | $this->setHeaders(); |
|  |  |  |
|  |  | if ( $par === null || $par === '' ) { |
| Expand Down | |  |

24 changes: 24 additions & 0 deletions

24
[includes/RestUtils.php](#diff-b2e1f6a78778dc963b5486fc507a076d6232dbcab4c03cbccce7220bb700ccd7 "includes/RestUtils.php")

Show comments

[View file](/miraheze/CreateWiki/blob/02e0f298f8d35155c39aa74193cb7b867432c5b8/includes/RestUtils.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,24 @@ |
|  |  | <?php |
|  |  |  |
|  |  | namespace Miraheze\CreateWiki; |
|  |  |  |
|  |  | use MediaWiki\MediaWikiServices; |
|  |  | use MediaWiki\Rest\LocalizedHttpException; |
|  |  | use Miraheze\CreateWiki\EntryPointUtils; |
|  |  | use Wikimedia\Message\MessageValue; |
|  |  |  |
|  |  | class RestUtils { |
|  |  |  |
|  |  | /\* |
|  |  | \* Called from the REST handlers, checks that the current wiki is the global wiki and that the REST API is not disabled |
|  |  | \*/ |
|  |  | public static function checkEnv() { |
|  |  | if ( !EntryPointUtils::currentWikiIsGlobalWiki() ) { |
|  |  | throw new LocalizedHttpException( new MessageValue( 'createwiki-wikinotglobalwiki' ), 403 ); |
|  |  | } |
|  |  | $config = MediaWikiServices::getInstance()->getConfigFactory()->makeConfig( 'CreateWiki' ); |
|  |  | if ( $config->get( 'CreateWikiDisableRESTAPI' ) ) { |
|  |  | throw new LocalizedHttpException( new MessageValue( 'createwiki-rest-disabled' ), 403 ); |
|  |  | } |
|  |  | } |
|  |  | } |

3 changes: 3 additions & 0 deletions

3
[tests/phpunit/SpecialRequestWikiTest.php](#diff-911f03e304ea120e3bcf5fa31ef89fd9cf6a247c057000693775c5223c7d3415 "tests/phpunit/SpecialRequestWikiTest.php")

Show comments

[View file](/miraheze/CreateWiki/blob/02e0f298f8d35155c39aa74193cb7b867432c5b8/tests/phpunit/SpecialRequestWikiTest.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -5,6 +5,7 @@ |
|  |  | use DerivativeContext; |
|  |  | use ErrorPageError; |
|  |  | use MediaWikiIntegrationTestCase; |
|  |  | use MediaWiki\WikiMap\WikiMap; |
|  |  | use Miraheze\CreateWiki\Hooks\CreateWikiHookRunner; |
|  |  | use Miraheze\CreateWiki\RequestWiki\SpecialRequestWiki; |
|  |  | use SpecialPage; |
| Expand Down  Expand Up | | @@ -33,6 +34,7 @@ public function testConstructor() { |
|  |  | \* @covers ::execute |
|  |  | \*/ |
|  |  | public function testExecuteNotLoggedIn() { |
|  |  | $this->setMwGlobals( 'wgCreateWikiGlobalWiki', WikiMap::getCurrentWikiId() ); |
|  |  | $hookRunner = $this->createMock( CreateWikiHookRunner::class ); |
|  |  | $specialRequestWiki = new SpecialRequestWiki( $hookRunner ); |
|  |  |  |
| Expand Down  Expand Up | | @@ -70,6 +72,7 @@ public function testExecuteLoggedInEmailConfirmed() { |
|  |  | \* @covers ::execute |
|  |  | \*/ |
|  |  | public function testExecuteLoggedInEmailNotConfirmed() { |
|  |  | $this->setMwGlobals( 'wgCreateWikiGlobalWiki', WikiMap::getCurrentWikiId() ); |
|  |  | $this->setGroupPermissions( 'user', 'requestwiki', true ); |
|  |  |  |
|  |  | $hookRunner = $this->createMock( CreateWikiHookRunner::class ); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `02e0f29`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmiraheze%2FCreateWiki%2Fcommit%2F02e0f298f8d35155c39aa74193cb7b867432c5b8) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from issue-tracker.miraheze.org_1fcbd6da_20250110_150834.html ===
Page Menu[HomeMiraheze](/)

* SearchConfigure Global Search

[Log In](https://issue-tracker.miraheze.org/auth/start/?next=%2FT12011)[Create Task](/maniphest/task/edit/nocreate/) [Maniphest](/maniphest/)  T12011
# Restrict the CreateWiki special pages and API to the global wikiClosed, Resolved[Public](/policy/explain/PHID-TASK-otiabs254rqzjzzxydal/view/)Actions

* [Edit Task](/maniphest/task/edit/12011/)
* Edit Related Tasks...
* [Create Subtask](/maniphest/task/subtask/12011/)
* [Edit Parent Tasks](/search/rel/task.has-parent/PHID-TASK-otiabs254rqzjzzxydal/)
* [Edit Subtasks](/search/rel/task.has-subtask/PHID-TASK-otiabs254rqzjzzxydal/)
* [Merge Duplicates In](/search/rel/task.merge-in/PHID-TASK-otiabs254rqzjzzxydal/)
* [Close As Duplicate](/search/rel/task.close-as-duplicate/PHID-TASK-otiabs254rqzjzzxydal/)
* Edit Related Objects...
* [Edit Commits](/search/rel/task.has-commit/PHID-TASK-otiabs254rqzjzzxydal/)
* [Edit Revisions](/search/rel/task.has-revision/PHID-TASK-otiabs254rqzjzzxydal/)
* Subscribe
* [Mute Notifications](/subscriptions/mute/PHID-TASK-otiabs254rqzjzzxydal/)
* [Flag For Later](/flag/edit/PHID-TASK-otiabs254rqzjzzxydal/)
* [Award Token](/token/give/PHID-TASK-otiabs254rqzjzzxydal/)

Assigned To

|  | [OrangeStar](/p/OrangeStar/) |
| --- | --- |

Authored By

|  | [OrangeStar](/p/OrangeStar/) |
| --- | --- |
| Mar 31 2024, 15:562024-03-31 15:56:35 (UTC+0) |

Tags

* [OrangeStar](/tag/orangestar/) [(Radar)](/project/board/88/)
* [CreateWiki](/tag/createwiki/) [(Backlog)](/project/board/4/)
* [Technology-Team (MediaWiki)](/tag/technology-team_mediawiki/) [(Backlog)](/project/board/62/)
* [Security](/tag/security/) [(Backlog)](/project/board/58/)
Referenced FilesNoneSubscribers

|  | [AmandaCath](/p/AmandaCath/) |
| --- | --- |

|  | [BrandonWM](/p/BrandonWM/) |
| --- | --- |

|  | [Collei](/p/Collei/) |
| --- | --- |

|  | [Joritochip](/p/Joritochip/) |
| --- | --- |

|  | [OrangeStar](/p/OrangeStar/) |
| --- | --- |

|  | [Rodejong](/p/Rodejong/) |
| --- | --- |

|  | [Void](/p/Void/) |
| --- | --- |

# Description

There's zero reason for the CreateWiki special pages and API to be available outside of the wiki in CreateWikiGlobalWiki. In fact, this being the case is one of the reasons behind [T11999](/T11999).

It should be noted that this doesn't even work right due to the usage of local user IDs. These IDs are not guaranteed to correspond to the same user accross wikis. This leads to stuff like [testwikibeta saying that wiki request #15 was filed by the ImportDump extension's system user](https://test.mirabeta.org/wiki/Special%3ARequestWikiQueue/15)

# Related Objects

* Mentions

Mentioned In [T12376: Add virtual database domains support to CreateWiki](/T12376)
[T12102: You can impersonate a wiki requester if you manage to get the same local ID in a wiki as the requester's local ID](/T12102) Mentioned Here [T11999: Leak of suppressed wiki requests via Special:RequestWikiQueue outside of Meta](/T11999)
### Event Timeline

[OrangeStar](/p/OrangeStar/) created this task.[Mar 31 2024, 15:562024-03-31 15:56:35 (UTC+0)](#240555)[OrangeStar](/p/OrangeStar/) triaged this task as Low priority.[OrangeStar](/p/OrangeStar/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-ywyfsrowowfysxu/)[OrangeStar](/p/OrangeStar/) renamed this task from Restrict the CreateWiki special pages to the global wiki to Restrict the CreateWiki special pages and API to the global wiki.[Mar 31 2024, 16:132024-03-31 16:13:45 (UTC+0)](#240570)[OrangeStar](/p/OrangeStar/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-7s4fp6coujedvf5/)[Rodejong](/p/Rodejong/) subscribed.[Apr 5 2024, 17:022024-04-05 17:02:23 (UTC+0)](#240739)[OrangeStar](/p/OrangeStar/) removed a parent task: [T12010: CreateWiki suppression rework](/T12010).[Apr 6 2024, 19:342024-04-06 19:34:09 (UTC+0)](#240764)[Collei](/p/Collei/) subscribed.[Apr 20 2024, 19:432024-04-20 19:43:33 (UTC+0)](#241485)Comment Actions

Has this been resolved through the LocalSettings.php changes that restrict CreateWiki, or is this in regard to CreateWiki as an extension on non-Miraheze wikis?

[OrangeStar](/p/OrangeStar/) added a comment.[Apr 20 2024, 20:082024-04-20 20:08:31 (UTC+0)](#241490)Comment Actions

No, this is still in progress.

[OrangeStar](/p/OrangeStar/) mentioned this in [T12102: You can impersonate a wiki requester if you manage to get the same local ID in a wiki as the requester's local ID](/T12102).[May 3 2024, 10:322024-05-03 10:32:15 (UTC+0)](#242417)

[OrangeStar](/p/OrangeStar/) closed this task as Resolved.[May 3 2024, 17:112024-05-03 17:11:09 (UTC+0)](#242464)Comment Actions

<https://github.com/miraheze/CreateWiki/pull/519>

[OrangeStar](/p/OrangeStar/) added a project: [Security](/tag/security/).[May 12 2024, 10:102024-05-12 10:10:33 (UTC+0)](#242830)[Herald](/herald/) added a subscriber: [Void](/p/Void/).  · [View Herald Transcript](/herald/transcript/154224/)[May 12 2024, 10:102024-05-12 10:10:33 (UTC+0)](#242831)[OrangeStar](/p/OrangeStar/) changed the edit policy from "[Custom Policy](/transactions/old/PHID-XACT-TASK-wvm76aiqfu3uxeg/)" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-wvm76aiqfu3uxeg/)".[May 12 2024, 10:132024-05-12 10:13:16 (UTC+0)](#242832)[OrangeStar](/p/OrangeStar/) mentioned this in [T12376: Add virtual database domains support to CreateWiki](/T12376).[Jul 23 2024, 10:452024-07-23 10:45:06 (UTC+0)](#247634)[Log In to Comment](/login/?next=%2FT12011)
