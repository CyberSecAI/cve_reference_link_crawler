Page Menu[HomeMiraheze](/)

* SearchConfigure Global Search

[Log In](https://issue-tracker.miraheze.org/auth/start/?next=%2FT12102)[Create Task](/maniphest/task/edit/nocreate/) [Maniphest](/maniphest/)  T12102
# You can impersonate a wiki requester if you manage to get the same local ID in a wiki as the requester's local IDClosed, Resolved[Public](/policy/explain/PHID-TASK-w4edsjazetuykhvrxge2/view/)Actions

* [Edit Task](/maniphest/task/edit/12102/)
* Edit Related Tasks...
* [Create Subtask](/maniphest/task/subtask/12102/)
* [Edit Parent Tasks](/search/rel/task.has-parent/PHID-TASK-w4edsjazetuykhvrxge2/)
* [Edit Subtasks](/search/rel/task.has-subtask/PHID-TASK-w4edsjazetuykhvrxge2/)
* [Merge Duplicates In](/search/rel/task.merge-in/PHID-TASK-w4edsjazetuykhvrxge2/)
* [Close As Duplicate](/search/rel/task.close-as-duplicate/PHID-TASK-w4edsjazetuykhvrxge2/)
* Edit Related Objects...
* [Edit Commits](/search/rel/task.has-commit/PHID-TASK-w4edsjazetuykhvrxge2/)
* [Edit Revisions](/search/rel/task.has-revision/PHID-TASK-w4edsjazetuykhvrxge2/)
* Subscribe
* [Mute Notifications](/subscriptions/mute/PHID-TASK-w4edsjazetuykhvrxge2/)
* [Flag For Later](/flag/edit/PHID-TASK-w4edsjazetuykhvrxge2/)
* [Award Token](/token/give/PHID-TASK-w4edsjazetuykhvrxge2/)

Assigned To

|  | [OrangeStar](/p/OrangeStar/) |
| --- | --- |

Authored By

|  | [OrangeStar](/p/OrangeStar/) |
| --- | --- |
| May 3 2024, 10:322024-05-03 10:32:15 (UTC+0) |

Tags

* [Security](/tag/security/) [(Backlog)](/project/board/58/)
* [CreateWiki](/tag/createwiki/) [(Backlog)](/project/board/4/)
* [Technology-Team (MediaWiki)](/tag/technology-team_mediawiki/) [(Backlog)](/project/board/62/)
Referenced FilesNoneSubscribers

|  | [AmandaCath](/p/AmandaCath/) |
| --- | --- |

|  | [BrandonWM](/p/BrandonWM/) |
| --- | --- |

|  | [Joritochip](/p/Joritochip/) |
| --- | --- |

|  | [OrangeStar](/p/OrangeStar/) |
| --- | --- |

|  | [Void](/p/Void/) |
| --- | --- |

# Description

RequestWikiRequestViewer does a simple check to find out if the current user is the requester of the current wiki request. It simply compares their local IDs:

<https://github.com/miraheze/CreateWiki/blob/d4ddc2ff2b96224c455e27d39ef24beb6d0046a7/includes/RequestWiki/RequestWikiRequestViewer.php#L127> (comment added separately)

```
// Second condition after the OR is the one checking if the requester is the same as the current user
if ( $permissionManager->userHasRight( $userR, 'createwiki' ) && !$userR->getBlock() || $userR->getId() == $request->requester->getId() )
```

This check would've been enough if the special pages were only available on CreateWikiGlobalWiki ([T12011: Restrict the CreateWiki special pages and API to the global wiki](/T12011)), but that's not the case as of writing.

If, in a wiki, you manage to get the same local ID as the requester of a specific wiki request, you can post comments or edit the wiki request as if you were them, by going to that request's entry on Special:RequestWikiQueue on your wiki. It is very difficult to investigate successful attempts at exploiting this vulnerability.

# Related Objects

* Mentions

Mentioned In [R9:e5664995fbb8: T12102: Disable CreateWiki's special pages outside of the global wikis (#5551)](/R9%3Ae5664995fbb8644f9a80b450b4326194f20f9ddc) Mentioned Here [T12011: Restrict the CreateWiki special pages and API to the global wiki](/T12011)
### Event Timeline

[OrangeStar](/p/OrangeStar/) created this task.[May 3 2024, 10:322024-05-03 10:32:15 (UTC+0)](#242406)[Herald](/herald/) added a subscriber: [Void](/p/Void/).  路 [View Herald Transcript](/herald/transcript/153983/)[May 3 2024, 10:322024-05-03 10:32:15 (UTC+0)](#242418)

[OrangeStar](/p/OrangeStar/) renamed this task from You can post comments cross-wiki if you manage to get the same local ID in a wiki as the requester's local ID to You can post comments and edit wiki requests cross-wiki if you manage to get the same local ID in a wiki as the requester's local ID.[May 3 2024, 10:332024-05-03 10:33:27 (UTC+0)](#242419)Comment Actions

The only true fix to this is [T12011](/T12011), there's really no other way.

Restricted Repository Identity mentioned this in [R9:e5664995fbb8: T12102: Disable CreateWiki's special pages outside of the global wikis (#5551)](/R9%3Ae5664995fbb8644f9a80b450b4326194f20f9ddc).[May 3 2024, 10:532024-05-03 10:53:42 (UTC+0)](#242421)

[OrangeStar](/p/OrangeStar/) added a comment.[May 3 2024, 17:592024-05-03 17:59:12 (UTC+0)](#242466)Comment Actions

Fixed in <https://github.com/miraheze/CreateWiki/commit/02e0f298f8d35155c39aa74193cb7b867432c5b8>, GHSA pending.

[OrangeStar](/p/OrangeStar/) changed the visibility from "[Custom Policy](/transactions/old/PHID-XACT-TASK-gsn3oqava2lh2zf/)" to "Public (No Login Required)".[May 12 2024, 10:042024-05-12 10:04:54 (UTC+0)](#242824)[OrangeStar](/p/OrangeStar/) changed the edit policy from "[Custom Policy](/transactions/old/PHID-XACT-TASK-dq2jydsn3mdnqfr/)" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-dq2jydsn3mdnqfr/)".[Herald](/herald/) added a subscriber: [BrandonWM](/p/BrandonWM/).  路 [View Herald Transcript](/herald/transcript/154222/)[May 12 2024, 10:042024-05-12 10:04:54 (UTC+0)](#242826)[OrangeStar](/p/OrangeStar/) added a project: [CreateWiki](/tag/createwiki/).[May 12 2024, 10:052024-05-12 10:05:07 (UTC+0)](#242827)[Herald](/herald/) added a project: [Technology-Team (MediaWiki)](/tag/technology-team_mediawiki/).  路 [View Herald Transcript](/herald/transcript/154223/)[May 12 2024, 10:052024-05-12 10:05:07 (UTC+0)](#242829)[Herald](/herald/) added subscribers: [AmandaCath](/p/AmandaCath/), [Joritochip](/p/Joritochip/).  路 [View Herald Transcript](/herald/transcript/154223/)[OrangeStar](/p/OrangeStar/) renamed this task from You can post comments and edit wiki requests cross-wiki if you manage to get the same local ID in a wiki as the requester's local ID to You can impersonate a wiki requester if you manage to get the same local ID in a wiki as the requester's local ID.[May 12 2024, 10:232024-05-12 10:23:57 (UTC+0)](#242834)

[OrangeStar](/p/OrangeStar/) closed this task as Resolved.[May 12 2024, 10:322024-05-12 10:32:42 (UTC+0)](#242835)Comment Actions

GHSA published: <https://github.com/miraheze/CreateWiki/security/advisories/GHSA-89fx-77w7-rc64>

[Log In to Comment](/login/?next=%2FT12102)