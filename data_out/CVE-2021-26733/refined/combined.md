=== Content from www.nozominetworks.com_4fbd30d1_20250108_113916.html ===
**Detecting Insider Threats: The Undiscussed, Under Reported OT/ICS Cybersecurity Challenge**[Register Now](/resources/detecting-insider-threats-the-undiscussed-under-reported-ot-ics-cybersecurity-challenge)[Academy](/academy)[Labs](/labs)[Careers](/company/careers)[Partner Login](https://partners.nozominetworks.com/English/)[Support](/support)[![Nozomi logo](https://cdn.prod.website-files.com/645a4534705010e2cb244f50/647cdfc8e9b140d6c4dd4877_nozomi-logo.svg)](/)Platform![](https://cdn.prod.website-files.com/645a4534705010e2cb244f50/647dee6d3014cdc037112e34_nozomi-platform-menu-icon-1.svg)
### Platform Overview

Our industrial cybersecurity solutions deliver unmatched asset intelligence, threat detection and AI-driven insights.

[Learn more](/products)MANAGERS[VantageCloud](/products/vantage)[Central Management ConsoleOn prem](/products/central-management-console)SENSORS[GuardianNetwork](/products/guardian)[Guardian AirWireless](/products/guardian-air)[ArcEndpoint](/products/arc)[Arc EmbeddedEndpoint](/products/arc-embedded)ENHANCEMENTS[Vantage IQ](/products/vantage-iq)[Asset Intelligence](/products/asset-intelligence)[Threat Intelligence](/products/threat-intelligence)[Smart Polling](/products/smart-polling)[TI ExpansionÂ Pack
Powered by Mandiant](/products/ti-expansion-pack-powered-by-mandiant)![](https://cdn.prod.website-files.com/645a4534705010e2cb244f50/647df4835368816567937004_nozomi-platform-menu-icon-2.svg)
### Professional Services

OT and IoT security expertise that speeds solution deployment and maximizes value

[Learn more](/professional-services)PROFESSIONALÂ
SERVICES[Design](/professional-services/solution-design)[Deployment](/professional-services/solution-deployment)[Fast Track](/professional-services/fast-track-service-packages)[Optimization](/professional-services/solution-optimization)[Project Management](/professional-services/project-management)Solutions![](https://cdn.prod.website-files.com/645a4534705010e2cb244f50/647df7bf62bc558e18211b85_nozomi-solutions-menu-icon-1.svg)BUSINESSÂ NEED[Asset Inventory Management](/solutions/iot-ot-asset-inventory-management)[Threat DetectionÂ & Response](/solutions/threat-detection-and-response)[Continuous Network Monitoring](/solutions/iot-ot-network-monitoring)[Risk & Vulnerability Management](/solutions/iot-ot-vulnerability-management)[IoT Security](/solutions/iot-security)[Data Center Cybersecurity](/solutions/data-center-cybersecurity)[Building Automation System
Cybersecurity](/solutions/building-automation-system-cybersecurity)![](https://cdn.prod.website-files.com/645a4534705010e2cb244f50/647df7bf74ced86d0dc1c29c_nozomi-solutions-menu-icon-3.svg)INDUSTRY[Airports](/industries/airport-cybersecurity)[Electric Utilities](/industries/electric-utilities-cybersecurity)[Federal Government](/industries/federal-government)[Healthcare](/industries/healthcare-cybersecurity)[Manufacturing](/industries/manufacturing-cybersecurity)[Maritime](/industries/maritime-cybersecurity)[Mining](/industries/mining-cybersecurity)[Oil & Gas](/industries/oil-gas-cybersecurity)[Pharmaceutical](/industries/pharmaceutical-cybersecurity)[Rail](/industries/rail-cybersecurity)[Retail](/industries/retail-cybersecurity)[Smart Cities](/industries/smart-cities-cybersecurity)[Stadiums & Arenas](/industries/stadiums-arenas)[Water &
Wastewater](/industries/water-wastewater-cybersecurity)![](https://cdn.prod.website-files.com/645a4534705010e2cb244f50/647df7bfb032786965be445e_nozomi-solutions-menu-icon-2.svg)COMPLIANCE[ISA/IEC 62443 Standards](/compliance/isa-iec-62443-standards)[NERC CIP](/compliance/nerc-cip)[NIS2 Directive](/compliance/nis2-directive-compliance)[SEC Cybersecurity Rules](/compliance/sec-cybersecurity-rules)[TSA Security Directives](/compliance/tsa-security-directives)Partners![](https://cdn.prod.website-files.com/645a4534705010e2cb244f50/647dfde6427cc3addfcd2765_nozomi-partners-menu-icon-1.svg)
### Why Partner with Us

Our global partner network deploys OT & IoT cybersecurity solutions for customers around the world.

[Learn more](/partners)![](https://cdn.prod.website-files.com/645a4534705010e2cb244f50/647dfea905891930ecca34ac_nozomi-about-menu-icon-1.svg)
### Our Partners

Explore all Nozomi Networks partners

[Learn more](/partners#our-partners)![](https://cdn.prod.website-files.com/645a4534705010e2cb244f50/65df8146636482acba9ef204_partner-search-icon.svg)
### Find a Partner

Find a certified Nozomi Networks partner in your country.

[Learn more](/partners/find-a-partner)![](https://cdn.prod.website-files.com/645a4534705010e2cb244f50/64d507342134d4fe7e42c63f_NN-Icons-3-Colors-400x400px_laptop-140.svg)
### Partner Portal

Log into the Nozomi Networks partner portal.

[Log In](https://partners.nozominetworks.com/English/)Resources![](https://cdn.prod.website-files.com/645a4534705010e2cb244f50/647e083e33848493787fd49d_nozomi-resources-menu-icon-1.svg)
### Resource Library

Browse OT & IoT security research, guides, videos and more from the Nozomi Networks team.

[View Resources](/resources)RESOURCES[Case Studies](/case-studies)[Content Packs](/content-packs)[Data Sheets](/data-sheets)[OT Cyber FAQs](/ot-cybersecurity-faqs)[Guides](/guides) [Research Reports](/research-reports)[Solution Briefs](/solution-briefs)[Videos](/videos)[Webinars](/webinars)[White Papers](/white-papers)![](https://cdn.prod.website-files.com/645a4534705010e2cb244f50/647dfea905891930ecca34ac_nozomi-about-menu-icon-1.svg)
### Customer Hub

Explore our latest customer resources, including webinars, how-to videos, content packs and more.

[View Hub](/customer-resources)[Blog](/blog)Company![](https://cdn.prod.website-files.com/645a4534705010e2cb244f50/647dfea905891930ecca34ac_nozomi-about-menu-icon-1.svg)
### About Nozomi Networks

We keep critical infrastructure and operational technology cyber resilient.

[Learn more](/company)[![](https://cdn.prod.website-files.com/645a4534705010e2cb244f50/64c93675ed962a0e3b6e45d8_leadership-team-icon.svg)Leadership Team](/company/leadership)[![](https://cdn.prod.website-files.com/645a4534705010e2cb244f50/64b57df71e33d8cb8245cbe7_%20events-icon.svg)Events](/events)[![](https://cdn.prod.website-files.com/645a4534705010e2cb244f50/64b57df7bb1169138c54ebc8_newsroom-icon.svg)Newsroom](/company/newsroom)[![](https://cdn.prod.website-files.com/645a4534705010e2cb244f50/64b57df7e2340e9dfe2c628b_careers-icon.svg)Careers](/company/careers)[![](https://cdn.prod.website-files.com/645a4534705010e2cb244f50/64b57df7de423e6e0ba360c1_customer-testimonials.svg)Customer Testimonials](/customer-testimonials)[![](https://cdn.prod.website-files.com/645a4534705010e2cb244f50/64b57df87f088fba967ffc33_contact-us.svg)Contact Us](/company/contact-us)[Request Demo](/demo)![Vulnerabilities in BMC Firmware Affect OT/IoT Device Security â Part 1](https://cdn.prod.website-files.com/645a45d56fc4750d4edd96fe/646273cf6ad62c7541f8bb7a_BMC-Firmware-BLOG.jpeg)
# Vulnerabilities in BMC Firmware Affect OT/IoT Device Security â Part 1

by Nozomi Networks Labs | November 22, 2022

Over the past year, Nozomi Networks Labs has conducted research on the security of Baseboard Management Controllers (BMCs), with a special focus on OT and IoT devices. In part one of this blog series, we reveal thirteen vulnerabilities that affect BMCs of Lanner devices based on the American Megatrends (AMI) MegaRAC SP-X. By abusing these vulnerabilities, an unauthenticated attacker may achieve Remote Code Execution (RCE) with root privileges on the BMC, completely compromising it and gaining control of the managed host. During our research, we uncovered other vulnerabilities whose patching is still in progress and thus cannot be disclosed as of yet; those will be covered in a follow-up blog post.

Our discussion starts with an introduction to BMCs and an illustration of the vulnerabilities discovered. We will then provide an example of how an attacker can abuse these issues to ultimately compromise the device, and conclude with remediations that asset owners can implement.

## Baseboard Management Controllers (BMC) 101

A Baseboard Management Controller (BMC) is a supplementary System-on-Chip designed for remote monitoring and management of a computer. Due to this dedicated network interface and tight coupling with critical hardware components (e.g. motherboard chipset), BMCs can perform fully remote low-level system operations, such as keyboard-and-mouse interaction straight from the bootstrap, system power control, BIOS firmware reflash, etc.

In the past, BMCs were only found in IT server motherboards, whereas vendors are now broadening the scope of BMCs to operational technology (OT) and internet of things (IoT) sectors. One such vendor is [Lanner Inc.](https://www.lannerinc.com/), a Taiwanese brand specializing in embedded applications. Notably, during our research, we analyzed Lanner [IAC-AST2500A](https://www.lannerinc.com/products/network-appliances/modules-and-acceleration-cards/iac-ast2500), an expansion card that enables BMC functionalities on Lanner appliances. IAC-AST2500Aâs firmware is based on the American Megatrends (AMI) [MegaRAC SP-X](https://www.ami.com/megarac/) solution, a popular BMC firmware also utilized by brands such as Asus, Dell, Gigabyte, HP, Lenovo, or nVidia.

Among the available network services, the expansion card features a web application through which users can fully control the managed host as well as the BMC itself. Figure 1 depicts a screenshot of the interface.

![web interface of the Lanner IAC-AST2500A](https://cdn.prod.website-files.com/645a45d56fc4750d4edd96fe/646baa6ac8f56fa296675cff_Fg1-768x453.webp)

**Figure 1.** Screenshot of the web interface of the Lanner IAC-AST2500A

### Vulnerabilities Found

By analyzing the web interface of the IAC-AST2500A, we found thirteen vulnerabilities, as listed below:

* **CVE-2021-26727**: spx\_restservice SubNet\_handler\_func Multiple Command Injections and Stack-Based Buffer Overflows, **CVSS v3.1 10** (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)
* **CVE-2021-26728**: spx\_restservice KillDupUsr\_func Command Injection and Stack-Based Buffer Overflow, **CVSS v3.1 10** (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)
* **CVE-2021-26729**: spx\_restservice Login\_handler\_func Command Injection and Multiple Stack-Based Buffer Overflows, **CVSS v3.1 10** (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)
* **CVE-2021-26730**: spx\_restservice Login\_handler\_func Subfunction Stack-Based Buffer Overflow, **CVSS v3.1 10** (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)
* **CVE-2021-26731**: spx\_restservice modifyUserb\_func Command Injection and Multiple Stack-Based Buffer Overflows, **CVSS v3.1 9.1** (CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H)
* **CVE-2021-26732**: spx\_restservice First\_network\_func Broken Access Control, CVSS v3.1 6.5 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:L)
* **CVE-2021-26733**: spx\_restservice FirstReset\_handler\_func Broken Access Control, CVSS v3.1 5.3 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L)
* **CVE-2021-44776**: spx\_restservice SubNet\_handler\_func Broken Access Control, CVSS v3.1 6.5 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:L)
* **CVE-2021-44467**: spx\_restservice KillDupUsr\_func Broken Access Control, CVSS v3.1 5.3 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L)
* **CVE-2021-44769**: TLS Certificate Generation Function Improper Input Validation, CVSS v3.1 4.9 (CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H)
* **CVE-2021-46279**: Session Fixation and Insufficient Session Expiration, CVSS v3.1 5.8 (CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:L/A:L)
* **CVE-2021-45925**: Username Enumeration, CVSS v3.1 5.3 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N)
* **CVE-2021-4228**: Hard-coded TLS Certificate, CVSS v3.1 5.8 (CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:L/A:L)

These vulnerabilities affect version 1.10.0 of the standard firmware of Lanner IAC-AST2500, except for CVE-2021-4228 which was found on version 1.00.0.

### Attack Chain Example: CVE-2021-44467 and CVE-2021-26728

CVE-2021-44467 and CVE-2021-26728 describe a possible attack chain whereby an unauthenticated attacker can achieve Remote Code Execution (RCE) with root privileges on the BMC. During the login process, the web application asks through a confirmation dialog if the user wants to terminate any other active session on the logged-in account (Figure 2).

![](https://cdn.prod.website-files.com/645a45d56fc4750d4edd96fe/646baa8028b6380a0cce3787_Fg2-768x327.webp)

**Figure 2.** Termination of other active sessions on a logged-in account

This functionality is implemented via an authenticated POST request to â/api/KillDupUsrâ, which is ultimately handled by the âKillDupUsr\_funcâ function of âspx\_restserviceâ. This function begins as in Figure 3.

![](https://cdn.prod.website-files.com/645a45d56fc4750d4edd96fe/646baa90d82177fca256a346_Figure-3-CVE-2021-44467.webp)

Figure 3 CVE 2021 44467

Although the POST request contains a QSESSIONID cookie, the function does not perform any verification checks on the user session. This flaw enables unauthenticated attackers to arbitrarily terminate active sessions of other users, causing a Denial-of-Service (DoS) condition (CVE-2021-44467). Further issues can be observed by proceeding with the analysis (Figure 4).

![](https://cdn.prod.website-files.com/645a45d56fc4750d4edd96fe/646baab528b6380a0cce78da_Fg3-620x524%20(1).webp)

**Figure 4.** CVE-2021-26728 in KillDupUsr\_func

At line 41, âstrcatâ is called to copy the content of âv9â, which contains the value of the externally controllable HTTP parameter âusernameâ, into âdestâ, a fixed-size buffer. No checks are done on the length of âv9â before executing the instruction, leading to a stack-based buffer overflow.

At line 46, a âsafe\_systemâ is called with âdestâ as argument. Despite the name, it turned out to be possible to inject arbitrary OS commands in the string (for instance, a subshell command) that were executed by the device, leading to a command injection (CVE-2021-26728). When also considering that all processes run with root privileges on the device, the combined weaknesses enable an unauthenticated attacker to completely compromise both the BMC and the managed host.

## Remediations Â

After sharing all vulnerabilities with Lanner via a responsible disclosure process, the vendor developed updated BMC firmware versions for the IAC-AST2500A that resolve all issues described in this blog. The correct patched version strictly depends on the appliance in use; thus, we urge Lanner customers to contact technical support to receive the appropriate package.

If asset owners are unable to patch their appliances, we advise enforcing firewall or network access control rules to restrict the network reachability of the web interface to trusted personnel only, or to actively monitor the network traffic via intrusion detection systems.

## Summary Â

BMCs represent an attractive way to conveniently monitor and manage computer systems without requiring physical access, in the IT as well as in the OT/IoT domain. Nevertheless, their usability comes at the expense of a broader attack surface, and that may lead to an increase of the overall risk if they are not adequately protected. In this blog, we have presented the first results of our analysis of BMCs in OT and IoT devices and discussed thirteen vulnerabilities, five of which are rated as critical.

During our assessment, we uncovered further vulnerabilities, that are still in the process of being fixed and will be disclosed at a later date. We recommend that our readers regularly monitor our Nozomi Networks Labs page for the release of the follow-up blogpost, which will describe the remaining issues.

No items found.No items found.No items found.No items found.![Nozomi Networks Labs](https://cdn.prod.website-files.com/645a45d56fc4750d4edd96fe/64a5941f5376a221fffa214e_labs-updatedsicon-300x300.webp)ABOUTÂ THEÂ AUTHOR
### Nozomi Networks Labs

Nozomi Networks Labs is dedicated to reducing cyber risk for the worldâs industrial and critical infrastructure organizations. Through our cybersecurity research and collaboration with industry and institutions, weâre helping defend the operational systems that support everyday life.
### RELATEDÂ POSTS

[![](https://cdn.prod.website-files.com/645a45d56fc4750d4edd96fe/6758e805b893d850e334b219_A-Deep-Dive-into-Glupteba-Internals-FEATURED.webp)
#### A Deep Dive into Glupteba Internals](/blog/a-deep-dive-into-glupteba-internals)[![](https://cdn.prod.website-files.com/645a45d56fc4750d4edd96fe/6757599eca882b2b6ed26203_Mguard-Thumbnail.webp)
#### Flaws in Phoenix Contact mGuard Industrial Router Allow up to Root RCE](/blog/flaws-in-phoenix-contact-mguard-industrial-router-allow-up-to-root-rce)[![](https://cdn.prod.website-files.com/645a45d56fc4750d4edd96fe/674eccebe0eeed1f112ef3b9_Wago_PLC_750_8216_Vulnerabilities-FEATURED.webp)
#### Vulnerabilities in Wago PLCs: Understanding the Risks for Industrial Facilities](/blog/vulnerabilities-in-wago-plcs)[![](https://cdn.prod.website-files.com/645a45d56fc4750d4edd96fe/6758db079f727bf24bc4a5e3_Advantech-Thumbnail-new.webp)
#### Over-the-Air Vulnerabilities Discovered in Advantech EKI Access Points](/blog/over-the-air-vulnerabilities-discovered-in-advantech-eki-access-points)
### Subscribe to our newsletter

[View our Privacy Policy](https://www.nozominetworks.com/legal/privacy-policy)

[View our Privacy Policy](https://www.nozominetworks.com/legal/privacy-policy)![](https://cdn.prod.website-files.com/645a4534705010e2cb244f50/647e0bbe5862d58545496b67_nozomi-blue-icon.svg)## Subscribe[## LinkedIn](https://www.linkedin.com/company/nozomi-networks-sa)[## Demo](/demo)
### PLATFORM

[Platform Overview](/products)[Vantage](/products/vantage)[Central Management Console](/products/central-management-console)[Guardian](/products/guardian)[Guardian Air](/products/guardian-air)[Arc](/products/arc)[Asset Intelligence](/products/asset-intelligence)[Threat Intelligence](/products/threat-intelligence)[Smart Polling](/products/smart-polling)[PSIRT](https://security.nozominetworks.com/)
### Professional Services

[Overview](/professional-services)[Design](/professional-services/solution-design)[Deployment](/professional-services/solution-deployment)[Fast Track](/professional-services/fast-track-service-packages)[Optimization](/professional-services/solution-optimization)[Project Management](/professional-services/project-management)
### Solutions: Business needs

[Threat Detection & Response](/solutions/threat-detection-and-response)[Continuous Network Monitoring](/solutions/iot-ot-network-monitoring)[Asset Inventory Management](/solutions/iot-ot-asset-inventory-management)[Risk & Vulnerability Management](/solutions/iot-ot-vulnerability-management)[IoT Security](/solutions/iot-security)[Data Center Cybersecurity](/solutions/data-center-cybersecurity)
### Solutions: Compliance

[NERC CIP](/compliance/nerc-cip)[NIS2 Directive](/compliance/nis2-directive-compliance)[TSA Security Directives](/compliance/tsa-security-directives)
### Solutions: Industry

[Airports](/industries/airport-cybersecurity)[Electric Utilities](/industries/electric-utilities-cybersecurity)[Healthcare](/industries/healthcare-cybersecurity)[Federal Government](/industries/federal-government)[Manufacturing](/industries/manufacturing-cybersecurity)[Maritime](/industries/maritime-cybersecurity)[Mining](/industries/mining-cybersecurity)[Oil & Gas](/industries/oil-gas-cybersecurity)[Pharmaceutical](/industries/pharmaceutical-cybersecurity)[Rail](/industries/rail-cybersecurity)[Retail](/industries/retail-cybersecurity)[Smart Cities](/industries/smart-cities-cybersecurity)[Water & Wastewater](/industries/water-wastewater-cybersecurity)
### Learn

[Partners](/partners)[Resources](/resources)[Company](/company)[Contact Us](/company/contact-us)[Academy](/academy)[Careers](/company/careers)[Labs](/labs)[Legal](https://www.nozominetworks.com/legal/privacy-policy)[![](https://cdn.prod.website-files.com/645a4534705010e2cb244f50/64e91608e818b441814b52e8_twitter_footer_22x18.svg)](https://twitter.com/nozominetworks)[![LinkedIn logo](https://cdn.prod.website-files.com/645a4534705010e2cb244f50/647e0f5111954ec5d275cd99_linkedin.svg)](https://www.linkedin.com/company/nozomi-networks-sa)[![](https://cdn.prod.website-files.com/645a4534705010e2cb244f50/647e0f5133e547a9cb765948_youtube.svg)](https://www.youtube.com/%40nozominetworks)Â© 2025 Nozomi Networks Inc. All Rights Reserved. [Privacy Policy](https://www.nozominetworks.com/legal/privacy-policy) and Certifications. System Status.


