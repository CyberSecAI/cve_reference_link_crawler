

| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=d17d47da59f726dc4c87caebda3a50333d7e2fd3)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=d17d47da59f726dc4c87caebda3a50333d7e2fd3)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d17d47da59f726dc4c87caebda3a50333d7e2fd3)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d17d47da59f726dc4c87caebda3a50333d7e2fd3)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | David Ahern <dsahern@kernel.org> | 2021-06-07 11:35:30 -0600 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-06-10 13:39:29 +0200 |
| commit | [d17d47da59f726dc4c87caebda3a50333d7e2fd3](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d17d47da59f726dc4c87caebda3a50333d7e2fd3) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=d17d47da59f726dc4c87caebda3a50333d7e2fd3)) | |
| tree | [39a60a748d98aa6ac0ab534a35c7500f32dbce78](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=d17d47da59f726dc4c87caebda3a50333d7e2fd3) | |
| parent | [6b53db8c4c14b4e7256f058d202908b54a7b85b4](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=6b53db8c4c14b4e7256f058d202908b54a7b85b4) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d17d47da59f726dc4c87caebda3a50333d7e2fd3&id2=6b53db8c4c14b4e7256f058d202908b54a7b85b4)) | |
| download | [linux-d17d47da59f726dc4c87caebda3a50333d7e2fd3.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-d17d47da59f726dc4c87caebda3a50333d7e2fd3.tar.gz) | |

neighbour: allow NUD\_NOARP entries to be forced GCedcommit 7a6b1ab7475fd6478eeaf5c9d1163e7a18125c8f upstream.
IFF\_POINTOPOINT interfaces use NUD\_NOARP entries for IPv6. It's possible to
fill up the neighbour table with enough entries that it will overflow for
valid connections after that.
This behaviour is more prevalent after commit 58956317c8de ("neighbor:
Improve garbage collection") is applied, as it prevents removal from
entries that are not NUD\_FAILED, unless they are more than 5s old.
Fixes: 58956317c8de (neighbor: Improve garbage collection)
Reported-by: Kasper Dupont <kasperd@gjkwv.06.feb.2021.kasperd.net>
Signed-off-by: Thadeu Lima de Souza Cascardo <cascardo@canonical.com>
Signed-off-by: David Ahern <dsahern@kernel.org>
Signed-off-by: David S. Miller <davem@davemloft.net>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d17d47da59f726dc4c87caebda3a50333d7e2fd3)

| -rw-r--r-- | [net/core/neighbour.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/core/neighbour.c?id=d17d47da59f726dc4c87caebda3a50333d7e2fd3) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 0 deletions

| diff --git a/net/core/neighbour.c b/net/core/neighbour.cindex a18c2973b8c6d0..c452ebf209394a 100644--- a/[net/core/neighbour.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/core/neighbour.c?id=6b53db8c4c14b4e7256f058d202908b54a7b85b4)+++ b/[net/core/neighbour.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/core/neighbour.c?id=d17d47da59f726dc4c87caebda3a50333d7e2fd3)@@ -239,6 +239,7 @@ static int neigh\_forced\_gc(struct neigh\_table \*tbl)  write\_lock(&n->lock); if ((n->nud\_state == NUD\_FAILED) ||+ (n->nud\_state == NUD\_NOARP) || (tbl->is\_multicast && tbl->is\_multicast(n->primary\_key)) || time\_after(tref, n->updated)) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 16:15:31 +0000

