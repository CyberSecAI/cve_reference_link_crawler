=== Content from git.kernel.org_6a7e1de1_20250111_204006.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=962ac2dce56bb3aad1f82a4bbe3ada57a020287c)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=962ac2dce56bb3aad1f82a4bbe3ada57a020287c)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=962ac2dce56bb3aad1f82a4bbe3ada57a020287c)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=962ac2dce56bb3aad1f82a4bbe3ada57a020287c)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Manasi Navare <navaremanasi@chromium.org> | 2024-02-05 20:46:19 +0000 |
| --- | --- | --- |
| committer | Joonas Lahtinen <joonas.lahtinen@linux.intel.com> | 2024-02-12 11:39:15 +0200 |
| commit | [962ac2dce56bb3aad1f82a4bbe3ada57a020287c](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=962ac2dce56bb3aad1f82a4bbe3ada57a020287c) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=962ac2dce56bb3aad1f82a4bbe3ada57a020287c)) | |
| tree | [ef34c59eceed0f49c2cefcfe6a56579d43dcc3e8](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=962ac2dce56bb3aad1f82a4bbe3ada57a020287c) | |
| parent | [841c35169323cd833294798e58b9bf63fa4fa1de](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=841c35169323cd833294798e58b9bf63fa4fa1de) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=962ac2dce56bb3aad1f82a4bbe3ada57a020287c&id2=841c35169323cd833294798e58b9bf63fa4fa1de)) | |
| download | [linux-962ac2dce56bb3aad1f82a4bbe3ada57a020287c.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-962ac2dce56bb3aad1f82a4bbe3ada57a020287c.tar.gz) | |

drm/i915/dsc: Fix the macro that calculates DSCC\_/DSCA\_ PPS reg addressCommit bd077259d0a9 ("drm/i915/vdsc: Add function to read any PPS
register") defines a new macro to calculate the DSC PPS register
addresses with PPS number as an input. This macro correctly calculates
the addresses till PPS 11 since the addresses increment by 4. So in that
case the following macro works correctly to give correct register
address:
\_MMIO(\_DSCA\_PPS\_0 + (pps) \* 4)
However after PPS 11, the register address for PPS 12 increments by 12
because of RC Buffer memory allocation in between. Because of this
discontinuity in the address space, the macro calculates wrong addresses
for PPS 12 - 16 resulting into incorrect DSC PPS parameter value
read/writes causing DSC corruption.
This fixes it by correcting this macro to add the offset of 12 for PPS
>=12.
v3: Add correct paranthesis for pps argument (Jani Nikula)
Closes: https://gitlab.freedesktop.org/drm/intel/-/issues/10172
Fixes: bd077259d0a9 ("drm/i915/vdsc: Add function to read any PPS register")
Cc: Suraj Kandpal <suraj.kandpal@intel.com>
Cc: Ankit Nautiyal <ankit.k.nautiyal@intel.com>
Cc: Animesh Manna <animesh.manna@intel.com>
Cc: Jani Nikula <jani.nikula@linux.intel.com>
Cc: Sean Paul <sean@poorly.run>
Cc: Drew Davenport <ddavenport@chromium.org>
Signed-off-by: Manasi Navare <navaremanasi@chromium.org>
Reviewed-by: Jani Nikula <jani.nikula@intel.com>
Signed-off-by: Jani Nikula <jani.nikula@intel.com>
Link: [https://patchwork.freedesktop.org/patch/msgid/20240205204619.1991673-1-navaremanasi@chromium.org](https://patchwork.freedesktop.org/patch/msgid/20240205204619.1991673-1-navaremanasi%40chromium.org)
(cherry picked from commit 6074be620c31dc2ae11af96a1a5ea95580976fb5)
Signed-off-by: Joonas Lahtinen <joonas.lahtinen@linux.intel.com>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=962ac2dce56bb3aad1f82a4bbe3ada57a020287c)

| -rw-r--r-- | [drivers/gpu/drm/i915/display/intel\_vdsc\_regs.h](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/gpu/drm/i915/display/intel_vdsc_regs.h?id=962ac2dce56bb3aad1f82a4bbe3ada57a020287c) | 4 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 2 insertions, 2 deletions

| diff --git a/drivers/gpu/drm/i915/display/intel\_vdsc\_regs.h b/drivers/gpu/drm/i915/display/intel\_vdsc\_regs.hindex 64f440fdc22b2c..8b21dc8e26d525 100644--- a/[drivers/gpu/drm/i915/display/intel\_vdsc\_regs.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/i915/display/intel_vdsc_regs.h?id=841c35169323cd833294798e58b9bf63fa4fa1de)+++ b/[drivers/gpu/drm/i915/display/intel\_vdsc\_regs.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/i915/display/intel_vdsc_regs.h?id=962ac2dce56bb3aad1f82a4bbe3ada57a020287c)@@ -51,8 +51,8 @@ #define DSCC\_PICTURE\_PARAMETER\_SET\_0 \_MMIO(0x6BA00) #define \_DSCA\_PPS\_0 0x6B200 #define \_DSCC\_PPS\_0 0x6BA00-#define DSCA\_PPS(pps) \_MMIO(\_DSCA\_PPS\_0 + (pps) \* 4)-#define DSCC\_PPS(pps) \_MMIO(\_DSCC\_PPS\_0 + (pps) \* 4)+#define DSCA\_PPS(pps) \_MMIO(\_DSCA\_PPS\_0 + ((pps) < 12 ? (pps) : (pps) + 12) \* 4)+#define DSCC\_PPS(pps) \_MMIO(\_DSCC\_PPS\_0 + ((pps) < 12 ? (pps) : (pps) + 12) \* 4) #define \_ICL\_DSC0\_PICTURE\_PARAMETER\_SET\_0\_PB 0x78270 #define \_ICL\_DSC1\_PICTURE\_PARAMETER\_SET\_0\_PB 0x78370 #define \_ICL\_DSC0\_PICTURE\_PARAMETER\_SET\_0\_PC 0x78470 |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 20:38:43 +0000



=== Content from git.kernel.org_319548cb_20250111_204006.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=ff5999fb03f467e1e7159f0ddb199c787f7512b9)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=ff5999fb03f467e1e7159f0ddb199c787f7512b9)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ff5999fb03f467e1e7159f0ddb199c787f7512b9)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ff5999fb03f467e1e7159f0ddb199c787f7512b9)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Manasi Navare <navaremanasi@chromium.org> | 2024-02-05 20:46:19 +0000 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-02-23 09:51:27 +0100 |
| commit | [ff5999fb03f467e1e7159f0ddb199c787f7512b9](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ff5999fb03f467e1e7159f0ddb199c787f7512b9) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=ff5999fb03f467e1e7159f0ddb199c787f7512b9)) | |
| tree | [202bb54d9c24201f59987365d00513e8f312545c](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=ff5999fb03f467e1e7159f0ddb199c787f7512b9) | |
| parent | [ed5b8b735369b40d6c1f8ef3e62d369f74b4c491](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ed5b8b735369b40d6c1f8ef3e62d369f74b4c491) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ff5999fb03f467e1e7159f0ddb199c787f7512b9&id2=ed5b8b735369b40d6c1f8ef3e62d369f74b4c491)) | |
| download | [linux-ff5999fb03f467e1e7159f0ddb199c787f7512b9.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-ff5999fb03f467e1e7159f0ddb199c787f7512b9.tar.gz) | |

drm/i915/dsc: Fix the macro that calculates DSCC\_/DSCA\_ PPS reg address[ Upstream commit 962ac2dce56bb3aad1f82a4bbe3ada57a020287c ]
Commit bd077259d0a9 ("drm/i915/vdsc: Add function to read any PPS
register") defines a new macro to calculate the DSC PPS register
addresses with PPS number as an input. This macro correctly calculates
the addresses till PPS 11 since the addresses increment by 4. So in that
case the following macro works correctly to give correct register
address:
\_MMIO(\_DSCA\_PPS\_0 + (pps) \* 4)
However after PPS 11, the register address for PPS 12 increments by 12
because of RC Buffer memory allocation in between. Because of this
discontinuity in the address space, the macro calculates wrong addresses
for PPS 12 - 16 resulting into incorrect DSC PPS parameter value
read/writes causing DSC corruption.
This fixes it by correcting this macro to add the offset of 12 for PPS
>=12.
v3: Add correct paranthesis for pps argument (Jani Nikula)
Closes: https://gitlab.freedesktop.org/drm/intel/-/issues/10172
Fixes: bd077259d0a9 ("drm/i915/vdsc: Add function to read any PPS register")
Cc: Suraj Kandpal <suraj.kandpal@intel.com>
Cc: Ankit Nautiyal <ankit.k.nautiyal@intel.com>
Cc: Animesh Manna <animesh.manna@intel.com>
Cc: Jani Nikula <jani.nikula@linux.intel.com>
Cc: Sean Paul <sean@poorly.run>
Cc: Drew Davenport <ddavenport@chromium.org>
Signed-off-by: Manasi Navare <navaremanasi@chromium.org>
Reviewed-by: Jani Nikula <jani.nikula@intel.com>
Signed-off-by: Jani Nikula <jani.nikula@intel.com>
Link: [https://patchwork.freedesktop.org/patch/msgid/20240205204619.1991673-1-navaremanasi@chromium.org](https://patchwork.freedesktop.org/patch/msgid/20240205204619.1991673-1-navaremanasi%40chromium.org)
(cherry picked from commit 6074be620c31dc2ae11af96a1a5ea95580976fb5)
Signed-off-by: Joonas Lahtinen <joonas.lahtinen@linux.intel.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ff5999fb03f467e1e7159f0ddb199c787f7512b9)

| -rw-r--r-- | [drivers/gpu/drm/i915/display/intel\_vdsc\_regs.h](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/gpu/drm/i915/display/intel_vdsc_regs.h?id=ff5999fb03f467e1e7159f0ddb199c787f7512b9) | 4 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 2 insertions, 2 deletions

| diff --git a/drivers/gpu/drm/i915/display/intel\_vdsc\_regs.h b/drivers/gpu/drm/i915/display/intel\_vdsc\_regs.hindex 64f440fdc22b2c..8b21dc8e26d525 100644--- a/[drivers/gpu/drm/i915/display/intel\_vdsc\_regs.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/i915/display/intel_vdsc_regs.h?id=ed5b8b735369b40d6c1f8ef3e62d369f74b4c491)+++ b/[drivers/gpu/drm/i915/display/intel\_vdsc\_regs.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/i915/display/intel_vdsc_regs.h?id=ff5999fb03f467e1e7159f0ddb199c787f7512b9)@@ -51,8 +51,8 @@ #define DSCC\_PICTURE\_PARAMETER\_SET\_0 \_MMIO(0x6BA00) #define \_DSCA\_PPS\_0 0x6B200 #define \_DSCC\_PPS\_0 0x6BA00-#define DSCA\_PPS(pps) \_MMIO(\_DSCA\_PPS\_0 + (pps) \* 4)-#define DSCC\_PPS(pps) \_MMIO(\_DSCC\_PPS\_0 + (pps) \* 4)+#define DSCA\_PPS(pps) \_MMIO(\_DSCA\_PPS\_0 + ((pps) < 12 ? (pps) : (pps) + 12) \* 4)+#define DSCC\_PPS(pps) \_MMIO(\_DSCC\_PPS\_0 + ((pps) < 12 ? (pps) : (pps) + 12) \* 4) #define \_ICL\_DSC0\_PICTURE\_PARAMETER\_SET\_0\_PB 0x78270 #define \_ICL\_DSC1\_PICTURE\_PARAMETER\_SET\_0\_PB 0x78370 #define \_ICL\_DSC0\_PICTURE\_PARAMETER\_SET\_0\_PC 0x78470 |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 20:38:43 +0000


