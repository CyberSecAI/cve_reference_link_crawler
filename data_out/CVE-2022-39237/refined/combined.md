=== Content from github.com_9ecda6f7_20250108_123801.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsylabs%2Fsif%2Fcommit%2F07fb86029a12e3210f6131e065570124605daeaa)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsylabs%2Fsif%2Fcommit%2F07fb86029a12e3210f6131e065570124605daeaa)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=sylabs%2Fsif)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[sylabs](/sylabs)
/
**[sif](/sylabs/sif)**
Public

* [Notifications](/login?return_to=%2Fsylabs%2Fsif) You must be signed in to change notification settings
* [Fork
  10](/login?return_to=%2Fsylabs%2Fsif)
* [Star
   17](/login?return_to=%2Fsylabs%2Fsif)

* [Code](/sylabs/sif)
* [Issues
  7](/sylabs/sif/issues)
* [Pull requests
  0](/sylabs/sif/pulls)
* [Actions](/sylabs/sif/actions)
* [Projects
  0](/sylabs/sif/projects)
* [Security](/sylabs/sif/security)
* [Insights](/sylabs/sif/pulse)

Additional navigation options

* [Code](/sylabs/sif)
* [Issues](/sylabs/sif/issues)
* [Pull requests](/sylabs/sif/pulls)
* [Actions](/sylabs/sif/actions)
* [Projects](/sylabs/sif/projects)
* [Security](/sylabs/sif/security)
* [Insights](/sylabs/sif/pulse)

## Commit

[Permalink](/sylabs/sif/commit/07fb86029a12e3210f6131e065570124605daeaa)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-m5m3-46gj-wch8](https://github.com/advisories/GHSA-m5m3-46gj-wch8 "GHSA-m5m3-46gj-wch8")

[Browse files](/sylabs/sif/tree/07fb86029a12e3210f6131e065570124605daeaa)
Browse the repository at this point in the history

```
Improve Digital Signature Hash Algorithm Validation
```

* Loading branch information

[![@tri-adam](https://avatars.githubusercontent.com/u/9903835?s=40&v=4)](/tri-adam)

[tri-adam](/sylabs/sif/commits?author=tri-adam "View all commits by tri-adam")
authored
Oct 6, 2022

2 parents
[5f9bee6](/sylabs/sif/commit/5f9bee689df4c5d6b3b0674ce03336ad88dd4a24)
+
[a854038](/sylabs/sif/commit/a854038ce1f18237b81d505a1c3be6a60505db52)

commit 07fb860

 Show file tree

 Hide file tree

Showing
**28 changed files**
with
**149 additions**
and
**73 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* pkg/integrity

  + pkg/integrity/clearsign.go
    [clearsign.go](#diff-c89b3200d12ea0fc351514c97643a9668c48a1e617b601718dec07a363cb9293)
  + pkg/integrity/clearsign\_test.go
    [clearsign\_test.go](#diff-c0d46bfe3c38ba23874da9119ad80208c118b3e5f1cb5df37d879cfae425b77e)
  + pkg/integrity/digest.go
    [digest.go](#diff-940abe5d16e3be759e0cf967ec90f7b8afa68f8d6e1bca9927e49517810f61c2)
  + pkg/integrity/digest\_test.go
    [digest\_test.go](#diff-f456cee24bb83cd10ba8559cf32571bb2ec049484349beed94a6e2c509468136)
  + pkg/integrity/metadata\_test.go
    [metadata\_test.go](#diff-170bed754c63f0cdac1fe9d5e5942a79b45b845289c62c18b078736c3bf22fa4)
  + pkg/integrity/sign\_test.go
    [sign\_test.go](#diff-6219673c0cb33e3bc154229b8375a12bc0a9c59af98c840e1cf514cf70b74dc3)
  + testdata

    - TestDigest\_MarshalJSON

      * pkg/integrity/testdata/TestDigest\_MarshalJSON/SHA1.golden
        [SHA1.golden](#diff-b65592303c25a6445e8d678f4ef6e9ee03eae786e9c7572e9162cc7bd084b299)
      * pkg/integrity/testdata/TestDigest\_MarshalJSON/SHA512\_224.golden
        [SHA512\_224.golden](#diff-ccb501643ff8394ce562d122de13311de8ccdfefca1c9cda2328343aa695a738)
      * pkg/integrity/testdata/TestDigest\_MarshalJSON/SHA512\_256.golden
        [SHA512\_256.golden](#diff-53b31554caa8d30876ebeb70d7e9b9822eea44108e0198f9dff8622bd7ac838c)
    - TestGetHeaderMetadata

      * pkg/integrity/testdata/TestGetHeaderMetadata/SHA1.golden
        [SHA1.golden](#diff-78d18118c82c863a0b44b0ad8a6b1ffe055139e2cd480e9756a65c0492a77791)
      * pkg/integrity/testdata/TestGetHeaderMetadata/SHA512\_224.golden
        [SHA512\_224.golden](#diff-167862f2bd84d0541051459b0f51780d9011881df4a6ae03bd4d4c859113dd05)
      * pkg/integrity/testdata/TestGetHeaderMetadata/SHA512\_256.golden
        [SHA512\_256.golden](#diff-cdd4e7fcc75e3a766ce886fbd356985d2b1569fc13d1d1f7e582e0cc2840acf9)
    - TestGetImageMetadata

      * pkg/integrity/testdata/TestGetImageMetadata/Object1.golden
        [Object1.golden](#diff-d4b0bd0ff0d865ea86b978bd208703253699d834ef8e607466c2b390bb968cfb)
      * pkg/integrity/testdata/TestGetImageMetadata/Object2.golden
        [Object2.golden](#diff-49d7435f01676d2ce5254f0bf242d4722f14395399d5ffb13cbf642d14ffb1f7)
      * pkg/integrity/testdata/TestGetImageMetadata/SHA1.golden
        [SHA1.golden](#diff-e1ae4327d50a2c0af2e0c0443c3714f358f10d02f1b14bd8a42d4d2537afb4fa)
    - TestGetObjectMetadata

      * pkg/integrity/testdata/TestGetObjectMetadata/RelativeID.golden
        [RelativeID.golden](#diff-74c3d571966d94a59b7dac2f6d0e3f8c144dde9275c32e95c08457abd306a694)
      * pkg/integrity/testdata/TestGetObjectMetadata/SHA1.golden
        [SHA1.golden](#diff-2ad77d06b11edb42bb75cb7526d5433d1f4d48ecfec451260b982ddbc81783be)
      * pkg/integrity/testdata/TestGetObjectMetadata/SHA512\_224.golden
        [SHA512\_224.golden](#diff-34192d727614353f6c9ee38c4e9d332b25069a1b7e05ba74ca5dcc6af4d08e23)
      * pkg/integrity/testdata/TestGetObjectMetadata/SHA512\_256.golden
        [SHA512\_256.golden](#diff-6577aa8f905a1ba6f0e8f78f2ac6921ddb8bc81bdaac6b2ecb881b990d47dd80)
    - TestGroupSigner\_SignWithEntity

      * pkg/integrity/testdata/TestGroupSigner\_SignWithEntity/Group1.golden
        [Group1.golden](#diff-5ce013793341ad757358c8e16c2dcf1197f1a22af85325a02f9923ebd12c223c)
      * pkg/integrity/testdata/TestGroupSigner\_SignWithEntity/Group2.golden
        [Group2.golden](#diff-ca0d4fc01572ad435ffce9a7bde67e99ed3d2399db90cc858a2251e28dc76737)
      * pkg/integrity/testdata/TestGroupSigner\_SignWithEntity/Object1.golden
        [Object1.golden](#diff-78fa60feddec680a2ec60f40c30282a5a58f1d5c564577879357391373885b20)
      * pkg/integrity/testdata/TestGroupSigner\_SignWithEntity/Object2.golden
        [Object2.golden](#diff-c18cc0362f6cf9bbe5fe244470a0cf9f2e35e362c93f4edcb749d9af652fab3f)
      * pkg/integrity/testdata/TestGroupSigner\_SignWithEntity/SignatureConfigSHA224.golden
        [SignatureConfigSHA224.golden](#diff-eca478697712937821ade8824927add8747307489642f4a2147bbfe692fccbed)
      * pkg/integrity/testdata/TestGroupSigner\_SignWithEntity/SignatureConfigSHA256.golden
        [SignatureConfigSHA256.golden](#diff-2f43a569c7062f46f0d9f40d482e2c74127bd41cd2732a59b7f562434cbce5e0)
      * pkg/integrity/testdata/TestGroupSigner\_SignWithEntity/SignatureConfigSHA384.golden
        [SignatureConfigSHA384.golden](#diff-a013f27ea6f4746da51cae023c45b730d058f190530f41f8eeda5f2eb1a2b1a9)
      * pkg/integrity/testdata/TestGroupSigner\_SignWithEntity/SignatureConfigSHA512.golden
        [SignatureConfigSHA512.golden](#diff-e7d7d4d6d176ee7fad39da2f22daedc4238de0f01a4f68d7b29176e19c652f18)
    - TestSignAndEncodeJSON

      * pkg/integrity/testdata/TestSignAndEncodeJSON/SHA1.golden
        [SHA1.golden](#diff-0aa39fb7c4180f7f64be80c76bc86f17b67b0cd86003956cd41335666db08a53)

## There are no files selected for viewing

34 changes: 32 additions & 2 deletions

34
[pkg/integrity/clearsign.go](#diff-c89b3200d12ea0fc351514c97643a9668c48a1e617b601718dec07a363cb9293 "pkg/integrity/clearsign.go")

Show comments

[View file](/sylabs/sif/blob/07fb86029a12e3210f6131e065570124605daeaa/pkg/integrity/clearsign.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,4 +1,4 @@ |
|  |  | // Copyright (c) 2020, Sylabs Inc. All rights reserved. |
|  |  | // Copyright (c) 2020-2022, Sylabs Inc. All rights reserved. |
|  |  | // This software is licensed under a 3-clause BSD license. Please consult the LICENSE.md file |
|  |  | // distributed with the sources of this project regarding your rights to use or distribute this |
|  |  | // software. |
| Expand All | | @@ -7,6 +7,7 @@ package integrity |
|  |  |  |
|  |  | import ( |
|  |  | "bytes" |
|  |  | "crypto" |
|  |  | "encoding/json" |
|  |  | "errors" |
|  |  | "io" |
| Expand All | | @@ -18,9 +19,32 @@ import ( |
|  |  |  |
|  |  | var errClearsignedMsgNotFound = errors.New("clearsigned message not found") |
|  |  |  |
|  |  | // Hash functions specified for OpenPGP in RFC4880, excluding those that are not currently |
|  |  | // recommended by NIST. |
|  |  | var supportedPGPAlgorithms = []crypto.Hash{ |
|  |  | crypto.SHA224, |
|  |  | crypto.SHA256, |
|  |  | crypto.SHA384, |
|  |  | crypto.SHA512, |
|  |  | } |
|  |  |  |
|  |  | // hashAlgorithmSupported returns whether h is a supported PGP hash function. |
|  |  | func hashAlgorithmSupported(h crypto.Hash) bool { |
|  |  | for \_, alg := range supportedPGPAlgorithms { |
|  |  | if alg == h { |
|  |  | return true |
|  |  | } |
|  |  | } |
|  |  | return false |
|  |  | } |
|  |  |  |
|  |  | // signAndEncodeJSON encodes v, clear-signs it with privateKey, and writes it to w. If config is |
|  |  | // nil, sensible defaults are used. |
|  |  | func signAndEncodeJSON(w io.Writer, v interface{}, privateKey \*packet.PrivateKey, config \*packet.Config) error { |
|  |  | if !hashAlgorithmSupported(config.Hash()) { |
|  |  | return errHashUnsupported |
|  |  | } |
|  |  |  |
|  |  | // Get clearsign encoder. |
|  |  | plaintext, err := clearsign.Encode(w, privateKey, config) |
|  |  | if err != nil { |
| Expand Down  Expand Up | | @@ -59,7 +83,13 @@ func verifyAndDecode(data []byte, kr openpgp.KeyRing) (\*openpgp.Entity, []byte, |
|  |  | } |
|  |  |  |
|  |  | // Check signature. |
|  |  | e, err := openpgp.CheckDetachedSignature(kr, bytes.NewReader(b.Bytes), b.ArmoredSignature.Body, nil) |
|  |  | e, err := openpgp.CheckDetachedSignatureAndHash( |
|  |  | kr, |
|  |  | bytes.NewReader(b.Bytes), |
|  |  | b.ArmoredSignature.Body, |
|  |  | supportedPGPAlgorithms, |
|  |  | nil, |
|  |  | ) |
|  |  | return e, b.Plaintext, rest, err |
|  |  | } |
|  |  |  |
| Expand Down | |  |

17 changes: 13 additions & 4 deletions

17
[pkg/integrity/clearsign\_test.go](#diff-c0d46bfe3c38ba23874da9119ad80208c118b3e5f1cb5df37d879cfae425b77e "pkg/integrity/clearsign_test.go")

Show comments

[View file](/sylabs/sif/blob/07fb86029a12e3210f6131e065570124605daeaa/pkg/integrity/clearsign_test.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,4 +1,4 @@ |
|  |  | // Copyright (c) 2020-2021, Sylabs Inc. All rights reserved. |
|  |  | // Copyright (c) 2020-2022, Sylabs Inc. All rights reserved. |
|  |  | // This software is licensed under a 3-clause BSD license. Please consult the LICENSE.md file |
|  |  | // distributed with the sources of this project regarding your rights to use or distribute this |
|  |  | // software. |
| Expand All | | @@ -9,13 +9,15 @@ import ( |
|  |  | "bufio" |
|  |  | "bytes" |
|  |  | "crypto" |
|  |  | "encoding/json" |
|  |  | "errors" |
|  |  | "io" |
|  |  | "reflect" |
|  |  | "strings" |
|  |  | "testing" |
|  |  |  |
|  |  | "github.com/ProtonMail/go-crypto/openpgp" |
|  |  | "github.com/ProtonMail/go-crypto/openpgp/clearsign" |
|  |  | pgperrors "github.com/ProtonMail/go-crypto/openpgp/errors" |
|  |  | "github.com/ProtonMail/go-crypto/openpgp/packet" |
|  |  | "github.com/sebdah/goldie/v2" |
| Expand All | | @@ -41,7 +43,7 @@ func TestSignAndEncodeJSON(t \*testing.T) { |
|  |  | }{ |
|  |  | {name: "EncryptedKey", key: &encryptedKey, wantErr: true}, |
|  |  | {name: "DefaultHash", key: e.PrivateKey}, |
|  |  | {name: "SHA1", key: e.PrivateKey, hash: crypto.SHA1}, |
|  |  | {name: "SHA1", key: e.PrivateKey, hash: crypto.SHA1, wantErr: true}, |
|  |  | {name: "SHA224", key: e.PrivateKey, hash: crypto.SHA224}, |
|  |  | {name: "SHA256", key: e.PrivateKey, hash: crypto.SHA256}, |
|  |  | {name: "SHA384", key: e.PrivateKey, hash: crypto.SHA384}, |
| Expand Down  Expand Up | | @@ -121,7 +123,7 @@ func TestVerifyAndDecodeJSON(t \*testing.T) { |
|  |  | {name: "CorruptedSignature", el: openpgp.EntityList{e}, corrupter: corruptSignature}, |
|  |  | {name: "VerifyOnly", el: openpgp.EntityList{e}, wantEntity: e}, |
|  |  | {name: "DefaultHash", el: openpgp.EntityList{e}, output: &testType{}, wantEntity: e}, |
|  |  | {name: "SHA1", hash: crypto.SHA1, el: openpgp.EntityList{e}, output: &testType{}, wantEntity: e}, |
|  |  | {name: "SHA1", hash: crypto.SHA1, el: openpgp.EntityList{e}, wantErr: pgperrors.StructuralError("hash algorithm mismatch with cleartext message headers")}, //nolint:lll |
|  |  | {name: "SHA224", hash: crypto.SHA224, el: openpgp.EntityList{e}, output: &testType{}, wantEntity: e}, |
|  |  | {name: "SHA256", hash: crypto.SHA256, el: openpgp.EntityList{e}, output: &testType{}, wantEntity: e}, |
|  |  | {name: "SHA384", hash: crypto.SHA384, el: openpgp.EntityList{e}, output: &testType{}, wantEntity: e}, |
| Expand All | | @@ -136,10 +138,17 @@ func TestVerifyAndDecodeJSON(t \*testing.T) { |
|  |  | config := packet.Config{ |
|  |  | DefaultHash: tt.hash, |
|  |  | } |
|  |  | err := signAndEncodeJSON(&b, testValue, e.PrivateKey, &config) |
|  |  |  |
|  |  | // Manually sign and encode rather than calling signAndEncodeJSON, since we want to |
|  |  | // test unsupported hash algorithms. |
|  |  | plaintext, err := clearsign.Encode(&b, e.PrivateKey, &config) |
|  |  | if err != nil { |
|  |  | t.Fatal(err) |
|  |  | } |
|  |  | if err := json.NewEncoder(plaintext).Encode(testValue); err != nil { |
|  |  | t.Fatal(err) |
|  |  | } |
|  |  | plaintext.Close() |
|  |  |  |
|  |  | // Introduce corruption, if applicable. |
|  |  | if tt.corrupter != nil { |
| Expand Down | |  |

20 changes: 11 additions & 9 deletions

20
[pkg/integrity/digest.go](#diff-940abe5d16e3be759e0cf967ec90f7b8afa68f8d6e1bca9927e49517810f61c2 "pkg/integrity/digest.go")

Show comments

[View file](/sylabs/sif/blob/07fb86029a12e3210f6131e065570124605daeaa/pkg/integrity/digest.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -22,12 +22,14 @@ var ( |
|  |  | errDigestMalformed = errors.New("digest malformed") |
|  |  | ) |
|  |  |  |
|  |  | var supportedAlgorithms = map[crypto.Hash]string{ |
|  |  | crypto.SHA1: "sha1", |
|  |  | crypto.SHA224: "sha224", |
|  |  | crypto.SHA256: "sha256", |
|  |  | crypto.SHA384: "sha384", |
|  |  | crypto.SHA512: "sha512", |
|  |  | // Hash functions supported for digests. |
|  |  | var supportedDigestAlgorithms = map[crypto.Hash]string{ |
|  |  | crypto.SHA224: "sha224", |
|  |  | crypto.SHA256: "sha256", |
|  |  | crypto.SHA384: "sha384", |
|  |  | crypto.SHA512: "sha512", |
|  |  | crypto.SHA512\_224: "sha512\_224", |
|  |  | crypto.SHA512\_256: "sha512\_256", |
|  |  | } |
|  |  |  |
|  |  | // hashValue calculates a digest by applying hash function h to the contents read from r. If h is |
| Expand All | | @@ -52,7 +54,7 @@ type digest struct { |
|  |  | // newDigest returns a new digest. If h is not supported, errHashUnsupported is returned. If digest |
|  |  | // is malformed, errDigestMalformed is returned. |
|  |  | func newDigest(h crypto.Hash, value []byte) (digest, error) { |
|  |  | if \_, ok := supportedAlgorithms[h]; !ok { |
|  |  | if \_, ok := supportedDigestAlgorithms[h]; !ok { |
|  |  | return digest{}, errHashUnsupported |
|  |  | } |
|  |  |  |
| Expand Down  Expand Up | | @@ -104,7 +106,7 @@ func (d digest) matches(r io.Reader) (bool, error) { |
|  |  |  |
|  |  | // MarshalJSON marshals d into string of format "alg:value". |
|  |  | func (d digest) MarshalJSON() ([]byte, error) { |
|  |  | n, ok := supportedAlgorithms[d.hash] |
|  |  | n, ok := supportedDigestAlgorithms[d.hash] |
|  |  | if !ok { |
|  |  | return nil, errHashUnsupported |
|  |  | } |
| Expand All | | @@ -130,7 +132,7 @@ func (d \*digest) UnmarshalJSON(data []byte) error { |
|  |  | return fmt.Errorf("%w: %v", errDigestMalformed, err) |
|  |  | } |
|  |  |  |
|  |  | for h, n := range supportedAlgorithms { |
|  |  | for h, n := range supportedDigestAlgorithms { |
|  |  | if n == name { |
|  |  | digest, err := newDigest(h, v) |
|  |  | if err != nil { |
| Expand Down | |  |

64 changes: 47 additions & 17 deletions

64
[pkg/integrity/digest\_test.go](#diff-f456cee24bb83cd10ba8559cf32571bb2ec049484349beed94a6e2c509468136 "pkg/integrity/digest_test.go")

Show comments

[View file](/sylabs/sif/blob/07fb86029a12e3210f6131e065570124605daeaa/pkg/integrity/digest_test.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -114,14 +114,14 @@ func TestDigest\_MarshalJSON(t \*testing.T) { |
|  |  | wantErr error |
|  |  | }{ |
|  |  | { |
|  |  | name: "UnsupportedHash", |
|  |  | name: "HashUnsupportedMD5", |
|  |  | hash: crypto.MD5, |
|  |  | wantErr: errHashUnsupported, |
|  |  | }, |
|  |  | { |
|  |  | name: "SHA1", |
|  |  | hash: crypto.SHA1, |
|  |  | value: "597f6a540010f94c15d71806a99a2c8710e747bd", |
|  |  | name:  "HashUnsupportedSHA1", |
|  |  | hash:  crypto.SHA1, |
|  |  | wantErr: errHashUnsupported, |
|  |  | }, |
|  |  | { |
|  |  | name: "SHA224", |
| Expand All | | @@ -143,6 +143,16 @@ func TestDigest\_MarshalJSON(t \*testing.T) { |
|  |  | hash: crypto.SHA512, |
|  |  | value: "db3974a97f2407b7cae1ae637c0030687a11913274d578492558e39c16c017de84eacdc8c62fe34ee4e12b4b1428817f09b6a2760c3f8a664ceae94d2434a593", //nolint:lll |
|  |  | }, |
|  |  | { |
|  |  | name: "SHA512\_224", |
|  |  | hash: crypto.SHA512\_224, |
|  |  | value: "06001bf08dfb17d2b54925116823be230e98b5c6c278303bc4909a8c", |
|  |  | }, |
|  |  | { |
|  |  | name: "SHA512\_256", |
|  |  | hash: crypto.SHA512\_256, |
|  |  | value: "3d37fe58435e0d87323dee4a2c1b339ef954de63716ee79f5747f94d974f913f", |
|  |  | }, |
|  |  | } |
|  |  |  |
|  |  | for \_, tt := range tests { |
| Expand Down  Expand Up | | @@ -193,60 +203,80 @@ func TestDigest\_UnmarshalJSON(t \*testing.T) { |
|  |  | wantErr: errDigestMalformed, |
|  |  | }, |
|  |  | { |
|  |  | name: "UnsupportedHash", |
|  |  | name: "HashUnsupportedMD5", |
|  |  | r: strings.NewReader(`"md5:b0804ec967f48520697662a204f5fe72"`), |
|  |  | wantErr: errHashUnsupported, |
|  |  | }, |
|  |  | { |
|  |  | name: "HashUnsupportedSHA1", |
|  |  | r: strings.NewReader(`"sha1:597f6a540010f94c15d71806a99a2c8710e747bd"`), |
|  |  | wantErr: errHashUnsupported, |
|  |  | }, |
|  |  | { |
|  |  | name: "DigestMalformedNotHex", |
|  |  | r: strings.NewReader(`"sha1:oops"`), |
|  |  | r: strings.NewReader(`"sha256:oops"`), |
|  |  | wantErr: errDigestMalformed, |
|  |  | }, |
|  |  | { |
|  |  | name: "DigestMalformedIncorrectLen", |
|  |  | r: strings.NewReader(`"sha1:597f"`), |
|  |  | r: strings.NewReader(`"sha256:597f"`), |
|  |  | wantErr: errDigestMalformed, |
|  |  | }, |
|  |  | { |
|  |  | name: "SHA1", |
|  |  | r: strings.NewReader(`"sha1:597f6a540010f94c15d71806a99a2c8710e747bd"`), |
|  |  | wantHash: crypto.SHA1, |
|  |  | wantValue: "597f6a540010f94c15d71806a99a2c8710e747bd", |
|  |  | }, |
|  |  | { |
|  |  | name: "SHA224", |
|  |  | r: strings.NewReader(`"sha224:95041dd60ab08c0bf5636d50be85fe9790300f39eb84602858a9b430"`), |
|  |  | wantHash: crypto.SHA1, |
|  |  | wantHash: crypto.SHA224, |
|  |  | wantValue: "95041dd60ab08c0bf5636d50be85fe9790300f39eb84602858a9b430", |
|  |  | }, |
|  |  | { |
|  |  | name: "SHA256", |
|  |  | r: strings.NewReader(`"sha256:a948904f2f0f479b8f8197694b30184b0d2ed1c1cd2a1ec0fb85d299a192a447"`), |
|  |  | wantHash: crypto.SHA1, |
|  |  | wantHash: crypto.SHA256, |
|  |  | wantValue: "a948904f2f0f479b8f8197694b30184b0d2ed1c1cd2a1ec0fb85d299a192a447", |
|  |  | }, |
|  |  | { |
|  |  | name: "SHA384", |
|  |  | r: strings.NewReader(`"sha384:6b3b69ff0a404f28d75e98a066d3fc64fffd9940870cc68bece28545b9a75086b343d7a1366838083e4b8f3ca6fd3c80"`), //nolint:lll |
|  |  | wantHash: crypto.SHA1, |
|  |  | wantHash: crypto.SHA384, |
|  |  | wantValue: "6b3b69ff0a404f28d75e98a066d3fc64fffd9940870cc68bece28545b9a75086b343d7a1366838083e4b8f3ca6fd3c80", |
|  |  | }, |
|  |  | { |
|  |  | name: "SHA512", |
|  |  | r: strings.NewReader(`"sha512:db3974a97f2407b7cae1ae637c0030687a11913274d578492558e39c16c017de84eacdc8c62fe34ee4e12b4b1428817f09b6a2760c3f8a664ceae94d2434a593"`), //nolint:lll |
|  |  | wantHash: crypto.SHA1, |
|  |  | wantHash: crypto.SHA512, |
|  |  | wantValue: "db3974a97f2407b7cae1ae637c0030687a11913274d578492558e39c16c017de84eacdc8c62fe34ee4e12b4b1428817f09b6a2760c3f8a664ceae94d2434a593", //nolint:lll |
|  |  | }, |
|  |  | { |
|  |  | name: "SHA512\_224", |
|  |  | r: strings.NewReader(`"sha512\_224:06001bf08dfb17d2b54925116823be230e98b5c6c278303bc4909a8c"`), |
|  |  | wantHash: crypto.SHA512\_224, |
|  |  | wantValue: "06001bf08dfb17d2b54925116823be230e98b5c6c278303bc4909a8c", |
|  |  | }, |
|  |  | { |
|  |  | name: "SHA512\_256", |
|  |  | r: strings.NewReader(`"sha512\_256:3d37fe58435e0d87323dee4a2c1b339ef954de63716ee79f5747f94d974f913f"`), |
|  |  | wantHash: crypto.SHA512\_256, |
|  |  | wantValue: "3d37fe58435e0d87323dee4a2c1b339ef954de63716ee79f5747f94d974f913f", |
|  |  | }, |
|  |  | } |
|  |  |  |
|  |  | for \_, tt := range tests { |
|  |  | tt := tt |
|  |  | t.Run(tt.name, func(t \*testing.T) { |
|  |  | var d digest |
|  |  |  |
|  |  | err := json.NewDecoder(tt.r).Decode(&d) |
|  |  | if got, want := err, tt.wantErr; !errors.Is(got, want) { |
|  |  | t.Fatalf("got error %v, want %v", got, want) |
|  |  | } |
|  |  |  |
|  |  | if got, want := d.hash, tt.wantHash; got != want { |
|  |  | t.Errorf("got hash %v, want %v", got, want) |
|  |  | } |
|  |  |  |
|  |  | if got, want := hex.EncodeToString(d.value), tt.wantValue; got != want { |
|  |  | t.Errorf("got value %v, want %v", got, want) |
|  |  | } |
|  |  | }) |
|  |  | } |
|  |  | } |

26 changes: 15 additions & 11 deletions

26
[pkg/integrity/metadata\_test.go](#diff-170bed754c63f0cdac1fe9d5e5942a79b45b845289c62c18b078736c3bf22fa4 "pkg/integrity/metadata_test.go")

Show comments

[View file](/sylabs/sif/blob/07fb86029a12e3210f6131e065570124605daeaa/pkg/integrity/metadata_test.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,4 +1,4 @@ |
|  |  | // Copyright (c) 2020-2021, Sylabs Inc. All rights reserved. |
|  |  | // Copyright (c) 2020-2022, Sylabs Inc. All rights reserved. |
|  |  | // This software is licensed under a 3-clause BSD license. Please consult the LICENSE.md file |
|  |  | // distributed with the sources of this project regarding your rights to use or distribute this |
|  |  | // software. |
| Expand Down  Expand Up | | @@ -35,12 +35,14 @@ func TestGetHeaderMetadata(t \*testing.T) { |
|  |  | wantErr error |
|  |  | }{ |
|  |  | {name: "HashUnavailable", header: bytes.NewReader(b), hash: crypto.MD4, wantErr: errHashUnavailable}, |
|  |  | {name: "HashUnsupported", header: bytes.NewReader(b), hash: crypto.MD5, wantErr: errHashUnsupported}, |
|  |  | {name: "SHA1", header: bytes.NewReader(b), hash: crypto.SHA1}, |
|  |  | {name: "HashUnsupportedMD5", header: bytes.NewReader(b), hash: crypto.MD5, wantErr: errHashUnsupported}, |
|  |  | {name: "HashUnsupportedSHA1", header: bytes.NewReader(b), hash: crypto.SHA1, wantErr: errHashUnsupported}, |
|  |  | {name: "SHA224", header: bytes.NewReader(b), hash: crypto.SHA224}, |
|  |  | {name: "SHA256", header: bytes.NewReader(b), hash: crypto.SHA256}, |
|  |  | {name: "SHA384", header: bytes.NewReader(b), hash: crypto.SHA384}, |
|  |  | {name: "SHA512", header: bytes.NewReader(b), hash: crypto.SHA512}, |
|  |  | {name: "SHA512\_224", header: bytes.NewReader(b), hash: crypto.SHA512\_224}, |
|  |  | {name: "SHA512\_256", header: bytes.NewReader(b), hash: crypto.SHA512\_256}, |
|  |  | } |
|  |  |  |
|  |  | for \_, tt := range tests { |
| Expand Down  Expand Up | | @@ -88,13 +90,15 @@ func TestGetObjectMetadata(t \*testing.T) { |
|  |  | wantErr error |
|  |  | }{ |
|  |  | {name: "HashUnavailable", descr: bytes.NewReader(rid0), hash: crypto.MD4, wantErr: errHashUnavailable}, |
|  |  | {name: "HashUnsupported", descr: bytes.NewReader(rid0), hash: crypto.MD5, wantErr: errHashUnsupported}, |
|  |  | {name: "RelativeID", relativeID: 1, descr: bytes.NewReader(rid1), data: strings.NewReader("blah"), hash: crypto.SHA1}, |
|  |  | {name: "SHA1", descr: bytes.NewReader(rid0), data: strings.NewReader("blah"), hash: crypto.SHA1}, |
|  |  | {name: "HashUnsupportedMD5", descr: bytes.NewReader(rid0), hash: crypto.MD5, wantErr: errHashUnsupported}, |
|  |  | {name: "HashUnsupportedSHA1", descr: bytes.NewReader(rid0), hash: crypto.SHA1, wantErr: errHashUnsupported}, |
|  |  | {name: "RelativeID", relativeID: 1, descr: bytes.NewReader(rid1), data: strings.NewReader("blah"), hash: crypto.SHA256}, //nolint:lll |
|  |  | {name: "SHA224", descr: bytes.NewReader(rid0), data: strings.NewReader("blah"), hash: crypto.SHA224}, |
|  |  | {name: "SHA256", descr: bytes.NewReader(rid0), data: strings.NewReader("blah"), hash: crypto.SHA256}, |
|  |  | {name: "SHA384", descr: bytes.NewReader(rid0), data: strings.NewReader("blah"), hash: crypto.SHA384}, |
|  |  | {name: "SHA512", descr: bytes.NewReader(rid0), data: strings.NewReader("blah"), hash: crypto.SHA512}, |
|  |  | {name: "SHA512\_224", descr: bytes.NewReader(rid0), data: strings.NewReader("blah"), hash: crypto.SHA512\_224}, |
|  |  | {name: "SHA512\_256", descr: bytes.NewReader(rid0), data: strings.NewReader("blah"), hash: crypto.SHA512\_256}, |
|  |  | } |
|  |  |  |
|  |  | for \_, tt := range tests { |
| Expand Down  Expand Up | | @@ -139,11 +143,11 @@ func TestGetImageMetadata(t \*testing.T) { |
|  |  | wantErr error |
|  |  | }{ |
|  |  | {name: "HashUnavailable", hash: crypto.MD4, wantErr: errHashUnavailable}, |
|  |  | {name: "HashUnsupported", hash: crypto.MD5, wantErr: errHashUnsupported}, |
|  |  | {name: "MinimumIDInvalid", minID: 2, ods: []sif.Descriptor{od1}, hash: crypto.SHA1, wantErr: errMinimumIDInvalid}, |
|  |  | {name: "Object1", minID: 1, ods: []sif.Descriptor{od1}, hash: crypto.SHA1}, |
|  |  | {name: "Object2", minID: 1, ods: []sif.Descriptor{od2}, hash: crypto.SHA1}, |
|  |  | {name: "SHA1", minID: 1, ods: []sif.Descriptor{od1, od2}, hash: crypto.SHA1}, |
|  |  | {name: "HashUnsupportedMD5", hash: crypto.MD5, wantErr: errHashUnsupported}, |
|  |  | {name: "HashUnsupportedSHA1", hash: crypto.SHA1, wantErr: errHashUnsupported}, |
|  |  | {name: "MinimumIDInvalid", minID: 2, ods: []sif.Descriptor{od1}, hash: crypto.SHA256, wantErr: errMinimumIDInvalid}, |
|  |  | {name: "Object1", minID: 1, ods: []sif.Descriptor{od1}, hash: crypto.SHA256}, |
|  |  | {name: "Object2", minID: 1, ods: []sif.Descriptor{od2}, hash: crypto.SHA256}, |
|  |  | {name: "SHA224", minID: 1, ods: []sif.Descriptor{od1, od2}, hash: crypto.SHA224}, |
|  |  | {name: "SHA256", minID: 1, ods: []sif.Descriptor{od1, od2}, hash: crypto.SHA256}, |
|  |  | {name: "SHA384", minID: 1, ods: []sif.Descriptor{od1, od2}, hash: crypto.SHA384}, |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `07fb860`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsylabs%2Fsif%2Fcommit%2F07fb86029a12e3210f6131e065570124605daeaa) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_556c0f74_20250108_123801.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsylabs%2Fsif%2Fsecurity%2Fadvisories%2FGHSA-m5m3-46gj-wch8)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsylabs%2Fsif%2Fsecurity%2Fadvisories%2FGHSA-m5m3-46gj-wch8)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=sylabs%2Fsif)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[sylabs](/sylabs)
/
**[sif](/sylabs/sif)**
Public

* [Notifications](/login?return_to=%2Fsylabs%2Fsif) You must be signed in to change notification settings
* [Fork
  10](/login?return_to=%2Fsylabs%2Fsif)
* [Star
   17](/login?return_to=%2Fsylabs%2Fsif)

* [Code](/sylabs/sif)
* [Issues
  7](/sylabs/sif/issues)
* [Pull requests
  0](/sylabs/sif/pulls)
* [Actions](/sylabs/sif/actions)
* [Projects
  0](/sylabs/sif/projects)
* [Security](/sylabs/sif/security)
* [Insights](/sylabs/sif/pulse)

Additional navigation options

* [Code](/sylabs/sif)
* [Issues](/sylabs/sif/issues)
* [Pull requests](/sylabs/sif/pulls)
* [Actions](/sylabs/sif/actions)
* [Projects](/sylabs/sif/projects)
* [Security](/sylabs/sif/security)
* [Insights](/sylabs/sif/pulse)

# Digital Signature Hash Algorithms Not Validated

Low

[tri-adam](/tri-adam)
published
GHSA-m5m3-46gj-wch8
Oct 6, 2022

## Package

gomod

github.com/sylabs/sif/v2
([Go](/advisories?query=ecosystem%3Ago))

## Affected versions

<= 2.8.0

## Patched versions

2.8.1

## Description

### Impact

The `github.com/sylabs/sif/v2/pkg/integrity` package does not verify that the hash algorithm(s) used are cryptographically secure when verifying digital signatures.

### Patches

A patch is available in version >= v2.8.1 of the module. Users are encouraged to upgrade.

The patch is commit [07fb860](https://github.com/sylabs/sif/commit/07fb86029a12e3210f6131e065570124605daeaa)

### Workarounds

Users may independently validate that the hash algorithm(s) used for metadata digest(s) and signature hash are cryptographically secure.

### References

* [CVE-2004-2761](https://nvd.nist.gov/vuln/detail/cve-2004-2761)
* [CVE-2005-4900](https://nvd.nist.gov/vuln/detail/cve-2005-4900)

### For more information

If you have any questions or comments about this advisory:

* Open an issue in [github.com/sylabs/sif](https://github.com/sylabs/sif/issues/new)
* Email us at security@sylabs.io

### Severity

Low

2.3

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Local

Attack complexity
High

Privileges required
High

User interaction
Required

Scope
Changed

Confidentiality
None

Integrity
Low

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:L/AC:H/PR:H/UI:R/S:C/C:N/I:L/A:N

### CVE ID

CVE-2022-39237

### Weaknesses

[CWE-328](/advisories?query=cwe%3A328)

### Credits

* [![@tri-adam](https://avatars.githubusercontent.com/u/9903835?s=40&v=4)](/tri-adam)
  [tri-adam](/tri-adam)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from security.gentoo.org_1175702a_20250108_123802.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Apptainer: Lack of Digital Signature Hash Verification — GLSA **202210-19**

A vulnerability has been found in Apptainer which could result in the usage of an unexpected of a container.

### Affected packages

| Package | **app-containers/apptainer** on all architectures |
| --- | --- |
| Affected versions | < **1.1.2** |
| Unaffected versions | >= **1.1.2** |

### Background

Apptainer is the container system for secure high-performance computing.

### Description

The Go module "sif" version 2.8.0 and older, which is a statically linked dependency of Apptainer, does not verify that the hash algorithm(s) used are cryptographically secure when verifying digital signatures.

### Impact

An image whose verification relies on a cryptographically insecure hash algorithm could be replaced, resulting in users using an image other than the one that was expected.

### Workaround

There is no known workaround at this time.

### Resolution

All Apptainer users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=app-containers/apptainer-1.1.2"

```
### References

* [CVE-2022-39237](https://nvd.nist.gov/vuln/detail/CVE-2022-39237)

**Release date**

October 31, 2022

**Latest revision**

October 31, 2022: 1

**Severity**

low

**Exploitable**

remote

**Bugzilla entries**

* [875869](https://bugs.gentoo.org/show_bug.cgi?id=875869)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**


