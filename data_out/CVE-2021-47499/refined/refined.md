Based on the provided information, this content relates to CVE-2021-47499.

**Root cause of vulnerability:**
The root cause of the vulnerability lies in a conditional check within the `kxcjk1013_probe` function of the `kxcjk-1013` driver. When the ACPI type is `ACPI_SMO8500`, the `data->dready_trig` field is not set, leading to a scenario where memory allocated by `iio_triggered_buffer_setup()` is not released during error handling or device removal, thus causing a memory leak.

**Weaknesses/vulnerabilities present:**
- Memory leak: The primary vulnerability is a memory leak. Memory allocated for the triggered buffer is not freed when the `dready_trig` is not set.

**Impact of exploitation:**
- Resource exhaustion: The memory leak leads to a gradual consumption of system memory. If this continues, it can result in system instability and eventually a denial of service due to the exhaustion of memory resources.

**Attack vectors:**
- Device initialization: The vulnerability is triggered during the initialization (probe) of the `kxcjk-1013` sensor, specifically when it is configured with the `ACPI_SMO8500` type.

**Required attacker capabilities/position:**
- The attacker would need to be able to control the system's hardware configuration or have control of the ACPI configuration, specifically forcing the device to use the ACPI\_SMO8500 type, to trigger the memory leak.

**More Details:**
The provided information gives the exact code changes to fix this issue. The fix involves removing the conditional check on `data->dready_trig` before calling `iio_triggered_buffer_cleanup()`, ensuring that the allocated memory is always released.