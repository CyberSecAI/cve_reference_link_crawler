- **Root cause of vulnerability:** A user with the custom role permission "Manage push rules" is able to create project-level deploy tokens, which should only be accessible by owners of the Group/Project. This occurs due to the permission associated with "Manage push rules" being overly permissive.
- **Weaknesses/vulnerabilities present:**
    - **Authorization Bypass:** The "Manage push rules" permission allows unintended creation of deploy tokens.
    - **Inadequate Access Control:** Custom roles are not properly restricting access to deploy token creation.
- **Impact of exploitation:**
    - Unauthorized read/write access to project-level packages, repositories, and registry images.
    - Potential data exfiltration, tampering, and supply chain compromise.
- **Attack vectors:**
    -  The attacker needs a user account with the "Manage push rules" permission within the target group.
    - The attacker crafts a POST request to create a deploy token, mimicking the legitimate request, using their own credentials.
- **Required attacker capabilities/position:**
    - Attacker must have a user account with the custom role that includes "Manage push rules" permission within the target group.
    - Attacker can be a guest with this permission.
    - Attacker must also know the project ID to perform the attack, as the request contains the project-specific path.

**Additional details:**
- The report mentions that the issue was found on gitlab.com, and it might also affect Gitlab community/Enterprise edition.
- The report includes detailed steps to reproduce the issue, along with the specific HTTP request and response involved in exploiting the vulnerability.
- A CVSS score of CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N is provided with Confidentiality and Integrity rated High.