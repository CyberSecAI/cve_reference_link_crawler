### Summary
The provided content confirms the existence of a vulnerability, CVE-2024-1294, in the Sunshine Photo Cart WordPress plugin. The vulnerability allows unauthenticated users to access sensitive order information via the invoice functionality.

**Root cause of vulnerability:**
The vulnerability is due to a lack of access control on the invoice functionality. Specifically, the `invoice()` function in `sunshine-order.php` (before the fix in version 3.1) did not check if the user was authorized to view the invoice, allowing unauthenticated users to access it directly.

**Weaknesses/vulnerabilities present:**
- **Inadequate Access Control:** The primary vulnerability is that the plugin does not verify user permissions before displaying the invoice, enabling unauthenticated access to sensitive information.

**Impact of exploitation:**
- **Sensitive Information Exposure:** Attackers can retrieve sensitive data, such as customer names, email addresses, phone numbers, billing addresses, shipping addresses, order details, and potentially other customer-related data contained within the order.

**Attack vectors:**
- **Direct Access:** Attackers can directly access the invoice page using the `sunshine_invoice` parameter in the URL, without needing to log in. The vulnerable code is located in the `invoice()` function starting at line 894 in the provided `sunshine-order.php` file, specifically line 896.

**Required attacker capabilities/position:**
- **Unauthenticated Access:** The attacker does not require any special privileges or access to the WordPress site.
- **Knowledge of URL structure:** The attacker needs to know or guess the URL format containing the `sunshine_invoice` parameter and the order ID (`post` parameter).

**Additional details:**
- The fix for this vulnerability was introduced in version 3.1 of the plugin. The relevant code change can be seen in the provided changeset diff, where a check `current_user_can( 'sunshine_manage_options' )` was added to the `invoice()` function. This ensures that only users with the `sunshine_manage_options` capability can access the invoice page. The change can be seen between lines 896 and 905 of the provided file diff.
- The Wordfence article provides a CVSS score of 5.3 (Medium) with a vector of `CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N`.

**Vulnerable code snippet** (before fix in version 3.1):
```php
function invoice() {
    if ( isset( $_GET['sunshine_invoice'] ) && isset( $_GET['post'] ) ) {
        $order = new SPC_Order( intval( $_GET['post'] ) );
        if ( empty( $order ) ) {
           wp_die( __( 'Invalid order ID', 'sunshine-photo-cart' ) );
           exit;
        }
        echo sunshine_get_template( 'invoice/admin', array( 'order' => $order ) );
        exit;
    }
}
```

**Fixed code snippet** (version 3.1):
```php
function invoice() {
    if ( isset( $_GET['sunshine_invoice'] ) && isset( $_GET['post'] ) && current_user_can( 'sunshine_manage_options' ) ) {
        $order = new SPC_Order( intval( $_GET['post'] ) );
        if ( empty( $order ) ) {
           wp_die( __( 'Invalid order ID', 'sunshine-photo-cart' ) );
           exit;
        }
        echo sunshine_get_template( 'invoice/admin', array( 'order' => $order ) );
        exit;
    }
}
```