```
{
  "vulnerability": {
    "root_cause": "The application does not properly validate the Host header, allowing an attacker to inject a malicious hostname.",
    "weaknesses": [
      "Host Header Injection",
      "Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')",
      "CWE-74"
    ],
    "impact": "An attacker can send password reset links to users that redirect them to a malicious server, leading to the disclosure of password reset tokens and account takeover.",
    "attack_vectors": "The attacker crafts a password reset request with a malicious Host header.",
    "required_capabilities": "The attacker needs to be able to intercept and modify HTTP requests.",
    "affected_environments": "Snipe-IT versions v3.0-alpha through v5.3.7"
  },
  "fix": {
    "recommendation": "Upgrade to version v5.3.8 or higher.",
    "commit_details": "The fix is implemented in commit 0c4768fd2a11ac26a61814cef23a71061bfd8bcc on the snipe/snipe-it repository. It forces the UrlGenerator's Root URL to be the base of APP_URL unless overridden.",
     "fix_details": "The fix in `app/Providers/AppServiceProvider.php` ensures that the root URL is derived from the `app.url` configuration and uses `URL::forceRootUrl` to prevent forging of domain parts of the URL via the Host header. This is done only if `APP_ALLOW_INSECURE_HOSTS` is not set. "
  },
  "cvss": {
    "v3.1": {
      "base_score": 8.8,
      "attack_vector": "Network",
      "attack_complexity": "Low",
      "privileges_required": "None",
      "user_interaction": "Required",
      "scope": "Unchanged",
      "confidentiality": "High",
      "integrity": "High",
      "availability": "High"
    },
    "v2": {
      "base_score": 6.8,
      "access_vector": "Network",
      "access_complexity": "Medium",
      "authentication": "None",
      "confidentiality": "Partial",
      "integrity": "Partial",
      "availability": "Partial"
    }
  }
}
```