- **Root cause of vulnerability:** Stack buffer overflow in the `fromWizardHandle` function due to insufficient bounds checking when processing the `PPW` parameter within a POST request.
- **Weaknesses/vulnerabilities present:** The `decodePwd()` function copies user-supplied data (`PPW`) into a fixed-size buffer (`decode_pwd`) without proper length validation, leading to a stack buffer overflow.
- **Impact of exploitation:** A successful exploit can lead to arbitrary code execution on the device. This could allow attackers to gain complete control over the router, potentially leading to data theft, manipulation of network settings, and inclusion in a botnet.
- **Attack vectors:** The vulnerability can be triggered by sending a crafted POST request to the `/goform/WizardHandle` endpoint. The attacker must include the `WANS` and `WANT` parameters, setting `WANT` to `2`, and a specially crafted payload within the `PPW` parameter.
- **Required attacker capabilities/position:** An attacker must be able to send HTTP POST requests to the vulnerable router. This would generally mean they would need to be on the same local network as the router, or have remote access to it via port forwarding or other means.