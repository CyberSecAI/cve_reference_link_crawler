Based on the provided content, here's a breakdown of the vulnerabilities associated with CVE-2024-4547:

**CVE-2024-4547 - RecalculateScript Unauthenticated SQLi**

*   **Root Cause:** The vulnerability stems from improper handling of user-supplied input within the `RecalculateScript` message processing in `CEBC.exe`. Specifically, the code splits the message using the `~` character and directly uses the fourth field in an SQL query without sanitization.

*   **Weaknesses/Vulnerabilities:**
    *   **SQL Injection (SQLi):** The application is vulnerable to SQL injection due to the lack of input sanitization/parameterization in the SQL query. This allows an attacker to inject arbitrary SQL code.
    *   **Unauthenticated Access:** The vulnerability is exploitable by unauthenticated remote attackers because the affected function is reachable without authentication on TCP port 928.
    *   **Insufficient Input Validation:** The code only checks for the correct number of fields after splitting the input, but does not validate the contents before using them in an SQL query.

*   **Impact of Exploitation:** Successful exploitation allows an attacker to:
    *   **Arbitrary SQL Execution:** Execute arbitrary SQL queries, potentially leading to data breaches, modification, or deletion.
    *   **Remote Code Execution:** The provided PoC shows that an attacker can insert and execute VBScript code as SYSTEM, leading to arbitrary code execution on the target machine.
    *   **Privilege Escalation:** By modifying the root user's password, an attacker can gain administrative access to the DIAEnergie application.

*   **Attack Vectors:**
    *   **Network:** Remote attackers can send specially crafted `RecalculateScript` messages over the network to the vulnerable TCP port 928.
    *   **Unauthenticated:** No authentication is required to exploit the vulnerability.

*   **Required Attacker Capabilities/Position:**
    *   The attacker needs network access to the target machine.
    *   The attacker needs the ability to send data to port 928.
    *   No prior authentication is required.