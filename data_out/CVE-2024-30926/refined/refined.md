```text
### Unauthenticated XSS Vulnerability in ./inc/kiosks.inc
*   **CVE ID**: CVE-2024-30926
*   **Affected Version** v9.0 and below
*   **Affected Component**: Kiosk address handling in `./inc/kiosks.inc`
*   **Authentication**: None (Unauthenticated)
*   **Vulnerability**: Cross-Site Scripting (XSS)

**Vulnerability Details:**

In DerbyNet, an unauthenticated Cross-Site Scripting (XSS) vulnerability exists within the `address_for_current_kiosk()` function located in the `./inc/kiosks.inc` file. This vulnerability arises from the improper handling of user-supplied input through URL parameters `id` and `address`.

The function `address_for_current_kiosk()` is designed to determine the address identifier for a kiosk. It accepts input from URL parameters, which are directly assigned to a variable without sanitization. This flaw allows attackers to inject malicious JavaScript code by crafting malicious URLs, such as:

* `http://127.0.0.1:8000/kiosk.php?id=<script>alert(1)</script>`
* `http://127.0.0.1:8000/kiosk.php?address=<script>alert(1)</script>`

When these URLs are accessed, the JavaScript code within the parameters is executed, leading to an XSS attack.

**Code Snippet Highlighting the Issue:**

```
function address_for_current_kiosk() {
  $addr = "";
  if (isset($_GET['id'])) {
    $addr = $_GET['id'];  // Direct assignment from user input without sanitization
  } else if (isset($_GET['address'])) {
    $addr = $_GET['address'];  // Direct assignment from user input without sanitization
  }
  // Further code that uses $addr, potentially leading to XSS when rendered in a browser
  return $addr;
}
```

**Root cause of vulnerability:** The `address_for_current_kiosk` function directly uses the `id` and `address` GET parameters without sanitization.

**Weaknesses/vulnerabilities present:** Unauthenticated XSS vulnerability due to lack of sanitization of user supplied input from GET parameters.

**Impact of exploitation:** Execution of arbitrary JavaScript code in the victim's browser. Attackers can steal sensitive information, perform unauthorized actions, or compromise the user's interaction with the application.

**Attack vectors:** Malicious URLs with JavaScript code injected into the `id` or `address` parameter.

**Required attacker capabilities/position:** The attacker can be unauthenticated and needs to convince a user to click on a specially crafted link.
```