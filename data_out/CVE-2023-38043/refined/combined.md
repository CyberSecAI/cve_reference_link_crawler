=== Content from northwave-cybersecurity.com_22634697_20250111_082129.html ===


[Skip to content](#main-content)

arrow-alt-circle-up icon

#### Cyber Incident?

arrow-alt-circle-up icon

#### Call 00800 1744 0000

arrow-alt-circle-up icon

####

[![](https://northwave-cybersecurity.com/hs-fs/hubfs/NW%20Logo%20Horizontal%20rgb.png?width=2598&height=768&name=NW%20Logo%20Horizontal%20rgb.png)](//northwave-cybersecurity.com/?hsLang=en)

* [Services](https://northwave-cybersecurity.com/cyber-security-services)

  + [Incident Response](https://northwave-cybersecurity.com/cert-cyber-incident-response)
  + [NIS2](https://northwave-cybersecurity.com/navigate-your-nis2-journey)
  + [Intelligent Security Operations](https://northwave-cybersecurity.com/managed-cyber-security-intelligent-security-operations)
  + Business

    - [Managed Security & Privacy office](https://northwave-cybersecurity.com/managed-security-privacy-office)
    - [State of Security Assessment](https://northwave-cybersecurity.com/state-of-security-assessment)
    - [Data Protection Impact Assessment](https://northwave-cybersecurity.com/data-protection-impact-assessment)
    - [Security Roadmap](https://northwave-cybersecurity.com/cyber-security-roadmap)
    - [Audit & Control](https://northwave-cybersecurity.com/audits-control-service)
    - [ISO 27001 FastTrack](https://northwave-cybersecurity.com/iso-27001-fasttrack)
  + Bytes

    - [Managed Detection & Response](https://northwave-cybersecurity.com/managed-detection-response-service)
    - [SOC CMM](https://northwave-cybersecurity.com/soc-capability-and-maturity-assessment)
    - [Rapid Response](https://northwave-cybersecurity.com/cyber-rapid-response-service)
    - [Red Teaming](https://northwave-cybersecurity.com/red-teaming)
    - [TIBER](https://northwave-cybersecurity.com/tiber-threat-intelligence-based-ethical-red-teaming)
    - [ART (Advanced Red Teaming)](https://northwave-cybersecurity.com/art-advanced-red-teaming)
    - [Gold Teaming](https://northwave-cybersecurity.com/gold-teaming)
    - [Pentesting & Vuln. Assessments](https://northwave-cybersecurity.com/pentest)
    - [Vulnerability Management](https://northwave-cybersecurity.com/vulnerability-management)
  + Behaviour

    - [Managed Cyber Behaviour](https://northwave-cybersecurity.com/cyber-behaviour-service)
    - [Workshops & Assessments](https://northwave-cybersecurity.com/mcb-workshops-and-assessments)
    - [Cyber Resilience Service](https://northwave-cybersecurity.com/cyber-resilience-service-2.0)
    - [Gold Teaming](https://northwave-cybersecurity.com/gold-teaming)
* [About](https://northwave-cybersecurity.com/about)
* [Career](https://northwave-cybersecurity.com/career)

  + [Vacancies](https://careers.northwave-cybersecurity.com/)
  + [Working At Northwave](https://northwave-cybersecurity.com/working-at-northwave)
  + [Meet the Team](https://northwave-cybersecurity.com/people-of-northwave)
* News

  + [News & Press](https://northwave-cybersecurity.com/news-press)
  + [Events](https://northwave-cybersecurity.com/events)
  + [Threat Response](https://northwave-cybersecurity.com/threat-response)
* Expertise

  + [White papers & Articles](https://northwave-cybersecurity.com/whitepapers-articles)
  + [Interviews](https://northwave-cybersecurity.com/interviews)
  + [Intel & Research](https://northwave-cybersecurity.com/threat-intel-research)
  + [Vulnerability Notices](https://northwave-cybersecurity.com/vulnerability-notice)
* [Contact](https://northwave-cybersecurity.com/contact)

[24/7 Incident Response](https://northwave-cybersecurity.com/cert-cyber-incident-response?hsLang=en)

✖

# Arbitrary Kernel Function Call in Ivanti Secure Access Client

[*See all Vulnerability notices*](/vulnerability-notice?hsLang=en)

*Date: 10-11-2023*

### CVE NUMBER

CVE-2023-38043

### CVSS SCORE

9.3 - CVSS:4.0/AV:L/AC:L/AT:N/PR:L/UI:N/VC:H/VI:H/VA:H/SC:H/SI:H/SA:H

### SUMMARY

Ivanti's Secure Access Client (formerly Pulse Secure Access Client), an enterprise VPN client, is vulnerable to an arbitrary kernel function call vulnerability. The vulnerability exists inside one of the kernel drivers included in the software package named `jnprva.sys`. Exploiting this vulnerability could lead to code execution in the kernel or privilege escalation from an unprivileged user context.

### Impacted Versions

The bug has been present since at least 2018. At least the following versions are affected.

* Pulse Secure VPN version 9.1R18 and lower.
* Ivanti Secure Access version 22.6R1 and lower.

### DETAILS

The handler for IOCTL number `0x8000204C` interprets part of the user-controlled input buffer as a pointer to an `IO\_CSQ` struct. The pointer is passed to the kernel API `IoCsqRemoveIrp`:

![Picture 2](https://northwave-cybersecurity.com/hs-fs/hubfs/Picture%202.png?width=326&height=150&name=Picture%202.png)

`IoCsqRemoveIrp` calls 3 pointers that are contained inside the `IO\_CSQ` struct. Passing a pointer to the kernel function `HalMakeBeep` in our input buffer and calling the IOCTL will result in the execution of the API:

![Picture 3](https://northwave-cybersecurity.com/hs-fs/hubfs/Picture%203.png?width=559&height=87&name=Picture%203.png)

### TIMELINE

* 16-03-2023 – Initial notice to DIVD
* 20-03-2023 – First reply from Ivanti regarding their responsible disclosure policy
* 13-06-2023 – Northwave shares vulnerability details and PoC with Ivanti
* 09-09-2023 – Ivanti notifies Northwave of planned patch release date
* 17-10-2023 – Planned Vendor Patch Release (not achieved)
* 09-11-2023 – Vendor Patch Release
* 09-11-2023 – Public Release

### REFERENCE

Ivanti Security Advisory: <https://forums.ivanti.com/s/article/Security-fixes-included-in-the-latest-Ivanti-Secure-Access-Client-Release>

### CREDIT

Discovered by Tijme Gommers & Alex Oudenaarden of Northwave Cybersecurity.

---

## Disclaimer

*Northwave has made every effort to make this information accurate and reliable. However, the information provided is without warranty of any kind and its use is at the sole risk of the user. Northwave does not accept any responsibility or liability for the accuracy, content, completeness, legality or reliability of the information provided. We shall not be liable for any loss or damage of whatever nature, direct or indirect, consequential or other, whether arising in contract, tort or otherwise, which may arise as a result of your use of, or inability to use, this information or any additional information provided by us in direct or indirect relation to the information provided here.*

![NW-Logo-Horizontal-rgb-2](https://northwave-cybersecurity.com/hubfs/NW-Logo-Horizontal-rgb-2.png "NW-Logo-Horizontal-rgb-2")

Tel: +31 (0)30 303 1240

E-mail: info@northwave-cybersecurity.com

Van Deventerlaan 31-51, 3528 AG Utrecht

PO 1305, 3430 BH, Nieuwegein

[Responsible Disclosure](https://northwave-cybersecurity.com/responsible-disclosure?hsLang=en)

[Privacy Statement](https://northwave-cybersecurity.com/privacy-cookie-statement?hsLang=en)

[Cookie Statement](https://northwave-cybersecurity.com/cookie-statement?hsLang=en)

#### Business

[Managed Security & Privacy Office](https://northwave-cybersecurity.com/security-privacy-office-service?hsLang=en)

[State of Security Assessment](https://northwave-cybersecurity.com/state-of-security-assessment?hsLang=en)

[Data Protection Impact Assessment](https://northwave-cybersecurity.com/data-protection-impact-assessment?hsLang=en)

[Security Roadmap](https://northwave-cybersecurity.com/security-roadmap?hsLang=en)

[Assess & Control](https://northwave-cybersecurity.com/audits-control-service?hsLang=en)

[ISO 27001 FastTrack](https://northwave-cybersecurity.com/iso-27001-fasttrack?hsLang=en)

#### Bytes

[Managed Detection & Response](https://northwave-cybersecurity.com/managed-detection-response-service?hsLang=en)

[Rapid Response](https://northwave-cybersecurity.com/rapid-response-service?hsLang=en)

[Red Teaming](https://northwave-cybersecurity.com/adversary-simulation?hsLang=en)

[ART (Advanced Red Teaming)](https://northwave-cybersecurity.com/art-advanced-red-teaming?hsLang=en)

[Pentest](https://northwave-cybersecurity.com/pentest?hsLang=en)

[Vulnerability Management](https://northwave-cybersecurity.com/vulnerability-management?hsLang=en)

#### Behaviour

[Managed Cyber Behaviour](https://northwave-cybersecurity.com/cyber-behaviour-service?hsLang=en)

[Cyber Resilience Service](https://northwave-cybersecurity.com/cyber-resilience-service-2.0?hsLang=en)

© 2024 Northwave All Rights Reserved.



=== Content from forums.ivanti.com_3f613c61_20250111_082129.html ===
Loading×Sorry to interruptCSS ErrorRefresh
