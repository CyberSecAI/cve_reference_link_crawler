
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fzenml-io%2Fzenml%2Fcommit%2Fb95f083efffa56831cd41d8ed536aeb0b6038fa3)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fzenml-io%2Fzenml%2Fcommit%2Fb95f083efffa56831cd41d8ed536aeb0b6038fa3)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=zenml-io%2Fzenml)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[zenml-io](/zenml-io)
/
**[zenml](/zenml-io/zenml)**
Public

* [Notifications](/login?return_to=%2Fzenml-io%2Fzenml) You must be signed in to change notification settings
* [Fork
  465](/login?return_to=%2Fzenml-io%2Fzenml)
* [Star
   4.3k](/login?return_to=%2Fzenml-io%2Fzenml)

* [Code](/zenml-io/zenml)
* [Issues
  22](/zenml-io/zenml/issues)
* [Pull requests
  15](/zenml-io/zenml/pulls)
* [Actions](/zenml-io/zenml/actions)
* [Projects
  0](/zenml-io/zenml/projects)
* [Security](/zenml-io/zenml/security)
* [Insights](/zenml-io/zenml/pulse)

Additional navigation options

* [Code](/zenml-io/zenml)
* [Issues](/zenml-io/zenml/issues)
* [Pull requests](/zenml-io/zenml/pulls)
* [Actions](/zenml-io/zenml/actions)
* [Projects](/zenml-io/zenml/projects)
* [Security](/zenml-io/zenml/security)
* [Insights](/zenml-io/zenml/pulse)

## Commit

[Permalink](/zenml-io/zenml/commit/b95f083efffa56831cd41d8ed536aeb0b6038fa3)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Add admin users notion ([#2494](https://github.com/zenml-io/zenml/pull/2494))

[Browse files](/zenml-io/zenml/tree/b95f083efffa56831cd41d8ed536aeb0b6038fa3)
Browse the repository at this point in the history

```
* add admin users to OSS

* skip missing methods

* increase readability

* doc string

* lint

* lint

* missing arg

* add some edge-cases

* wip commit to carve out clean_client changes

* revert irrelevant changes

* revert irrelevant changes

* rework tests to run on rest

* Apply suggestions from code review

Co-authored-by: Alex Strick van Linschoten <strickvl@users.noreply.github.com>
Co-authored-by: Stefan Nica <stefan@zenml.io>

* polish test cases

* fix branching

* admin user mgmt CLI/Client

* close activation vulnerability

* revert rbac changes

* verify admin permissions in endpoints

* add `is_admin` to external users

* only reg users will be migrated as admins

* default is always admin

* extend tests

* lint

* default `is_admin` None

* Auto-update of Starter template

* review suggestions

* review suggestions

* calm down linter

* Update src/zenml/cli/user_management.py

Co-authored-by: coderabbitai[bot] <136622811+coderabbitai[bot]@users.noreply.github.com>

* Apply suggestions from code review

Co-authored-by: Alex Strick van Linschoten <strickvl@users.noreply.github.com>

* review suggestion

---------

Co-authored-by: Alex Strick van Linschoten <strickvl@users.noreply.github.com>
Co-authored-by: Stefan Nica <stefan@zenml.io>
Co-authored-by: GitHub Actions <actions@github.com>
Co-authored-by: coderabbitai[bot] <136622811+coderabbitai[bot]@users.noreply.github.com>
```

* Loading branch information

[![@avishniakov](https://avatars.githubusercontent.com/u/31008759?s=40&v=4)](/avishniakov) [![@strickvl](https://avatars.githubusercontent.com/u/3348134?s=40&v=4)](/strickvl)
[![@stefannica](https://avatars.githubusercontent.com/u/3963946?s=40&v=4)](/stefannica) [![@actions-user](https://avatars.githubusercontent.com/u/65916846?s=40&v=4)](/actions-user) [![@coderabbitai](https://avatars.githubusercontent.com/in/347564?s=40&v=4)](/marketplace/coderabbitai)

5 people

authored
Mar 12, 2024

1 parent
[8a8085d](/zenml-io/zenml/commit/8a8085d2df730d6fc7f2c02d8699c1896beefe67)

commit b95f083

 Show file tree

 Hide file tree

Showing
**18 changed files**
with
**603 additions**
and
**67 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* examples/quickstart

  + examples/quickstart/README.md
    [README.md](#diff-5d176b8a174dbf132271a4bf774eaa7189da6137ab2a0d0b791e34ae4c1ea64a)
* src/zenml

  + cli

    - src/zenml/cli/user\_management.py
      [user\_management.py](#diff-a73a481b9242f3c823a4fb7b324395e2565dd023493f4df726db081c1f864135)
  + src/zenml/client.py
    [client.py](#diff-84b93992959735eed85ebcb2fed105598c4e421f5d0a1d964cf69f7ba0c33994)
  + models/v2

    - core

      * src/zenml/models/v2/core/service\_account.py
        [service\_account.py](#diff-ae704c5bd9c8373abe93d13e37c2f221e4388f47d5fd0b719b60e5e10229c908)
      * src/zenml/models/v2/core/user.py
        [user.py](#diff-e0fd6255a51cb63d6096cfe38642efc383d1176a3cfde4e29725ae74c247d50b)
    - misc

      * src/zenml/models/v2/misc/external\_user.py
        [external\_user.py](#diff-f62b4311b97d9042955e59c33490bfff98948dafc68b194f3aeb81f4f2d0a33f)
  + zen\_server

    - src/zenml/zen\_server/auth.py
      [auth.py](#diff-7f01e24a1a32784e1c576a28dc97ae3442c9d745ca42f548f99097f2d10ce1c8)
    - rbac

      * src/zenml/zen\_server/rbac/endpoint\_utils.py
        [endpoint\_utils.py](#diff-4d9de3946c7d3c556c8d1d00a1f5b4e124e3fab65062fae730723acb27fb511e)
      * src/zenml/zen\_server/rbac/utils.py
        [utils.py](#diff-9201b95730f4f057969649a34601690b464c1e0ad1d48d5a01a64cd9d1f77e75)
    - routers

      * src/zenml/zen\_server/routers/users\_endpoints.py
        [users\_endpoints.py](#diff-7f777d6044b383af2530b7e1da1532f55539efbad97353b8c1e915d1b70ae6fb)
    - src/zenml/zen\_server/utils.py
      [utils.py](#diff-365b87d5754a096dfc9a202f3546c4ad2c1130c5f2ae55128fef3b5e128b0139)
  + zen\_stores

    - migrations/versions

      * src/zenml/zen\_stores/migrations/versions/1a9a9d2a836d\_admin\_users.py
        [1a9a9d2a836d\_admin\_users.py](#diff-20f418b8d516d332dbce06f4065fcd9f54c62675c284fb1541571aa974833436)
    - schemas

      * src/zenml/zen\_stores/schemas/user\_schemas.py
        [user\_schemas.py](#diff-5be43543d3740d7a531e99e60a2ae41b492d1c67b3f0ea14ac811085f01cf4b2)
    - src/zenml/zen\_stores/sql\_zen\_store.py
      [sql\_zen\_store.py](#diff-33a06e43badf8dd56701f3dba2e085f77993837a66e8dafd3b91cbc20e2f1e77)
* tests

  + integration/functional/zen\_stores

    - tests/integration/functional/zen\_stores/test\_zen\_store.py
      [test\_zen\_store.py](#diff-bedf4b90bcbddd89de31e1e8af7a9e4166a99c046efd8a3dc5d66bff73753a1d)
    - tests/integration/functional/zen\_stores/utils.py
      [utils.py](#diff-fd951c69ccee4740c852f0b79bb2d77c94c01f2197e5cebd761a637155521055)
  + unit

    - tests/unit/conftest.py
      [conftest.py](#diff-0cae8a7ee2d37098b1ad84b543d17cfc1e8535eed5fd6abac88c668bfe354cbb)
    - models

      * tests/unit/models/test\_user\_models.py
        [test\_user\_models.py](#diff-e2484145db927ec9441699e8591c3a6e62643887bbf83054c1cbf3a26a975d25)

## There are no files selected for viewing

4 changes: 2 additions & 2 deletions

4
[examples/quickstart/README.md](#diff-5d176b8a174dbf132271a4bf774eaa7189da6137ab2a0d0b791e34ae4c1ea64a "examples/quickstart/README.md")

Show comments

[View file](/zenml-io/zenml/blob/b95f083efffa56831cd41d8ed536aeb0b6038fa3/examples/quickstart/README.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -24,7 +24,7 @@ Along the way we will also show you how to: |
|  |  |  |
|  |  | You can use Google Colab to see ZenML in action, no signup / installation required! |
|  |  |  |
|  |  | <a href="https://colab.research.google.com/github/zenml-io/zenml/blob/main/examples/quickstart/run.ipynb" target="\_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a> |
|  |  | <a href="https://colab.research.google.com/github/zenml-io/zenml/blob/main/examples/quickstart/quickstart.ipynb" target="\_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a> |
|  |  |  |
|  |  | ## :computer: Run Locally |
|  |  |  |
| Expand Down  Expand Up | | @@ -208,4 +208,4 @@ The best way to get a production ZenML instance up and running with all batterie |
|  |  | Also, make sure to join our <a href="https://zenml.io/slack" target="\_blank"> |
|  |  | <img width="15" src="https://cdn3.iconfinder.com/data/icons/logos-and-brands-adobe/512/306\_Slack-512.png" alt="Slack"/> |
|  |  | <b>Slack Community</b> |
|  |  | </a> to become part of the ZenML family! |
|  |  | </a> to become part of the ZenML family! |

75 changes: 71 additions & 4 deletions

75
[src/zenml/cli/user\_management.py](#diff-a73a481b9242f3c823a4fb7b324395e2565dd023493f4df726db081c1f864135 "src/zenml/cli/user_management.py")

Show comments

[View file](/zenml-io/zenml/blob/b95f083efffa56831cd41d8ed536aeb0b6038fa3/src/zenml/cli/user_management.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -120,15 +120,27 @@ def list\_users(ctx: click.Context, \*\*kwargs: Any) -> None: |
|  |  | required=False, |
|  |  | type=str, |
|  |  | ) |
|  |  | @click.option( |
|  |  | "--is\_admin", |
|  |  | is\_flag=True, |
|  |  | help=( |
|  |  | "Whether the user should be an admin. If not specified, the user will " |
|  |  | "be a regular user." |
|  |  | ), |
|  |  | required=False, |
|  |  | default=False, |
|  |  | ) |
|  |  | def create\_user( |
|  |  | user\_name: str, |
|  |  | password: Optional[str] = None, |
|  |  | is\_admin: bool = False, |
|  |  | ) -> None: |
|  |  | """Create a new user. |
|  |  |  |
|  |  | Args: |
|  |  | user\_name: The name of the user to create. |
|  |  | password: The password of the user to create. |
|  |  | is\_admin: Whether the user should be an admin. |
|  |  | """ |
|  |  | client = Client() |
|  |  | if not password: |
| Expand All | | @@ -146,7 +158,9 @@ def create\_user( |
|  |  | ) |
|  |  |  |
|  |  | try: |
|  |  | new\_user = client.create\_user(name=user\_name, password=password) |
|  |  | new\_user = client.create\_user( |
|  |  | name=user\_name, password=password, is\_admin=is\_admin |
|  |  | ) |
|  |  |  |
|  |  | cli\_utils.declare(f"Created user '{new\_user.name}'.") |
|  |  | except EntityExistsError as err: |
| Expand All | | @@ -162,8 +176,7 @@ def create\_user( |
|  |  |  |
|  |  | @user.command( |
|  |  | "update", |
|  |  | help="Update user information through the cli. All attributes " |
|  |  | "except for password can be updated through the cli.", |
|  |  | help="Update user information through the cli.", |
|  |  | ) |
|  |  | @click.argument("user\_name\_or\_id", type=str, required=True) |
|  |  | @click.option( |
| Expand Down  Expand Up | | @@ -191,26 +204,80 @@ def create\_user( |
|  |  | required=False, |
|  |  | help="New user email.", |
|  |  | ) |
|  |  | @click.option( |
|  |  | "--password", |
|  |  | "-p", |
|  |  | "updated\_password", |
|  |  | type=str, |
|  |  | required=False, |
|  |  | help="New user password.", |
|  |  | ) |
|  |  | @click.option( |
|  |  | "--admin", |
|  |  | "-a", |
|  |  | "make\_admin", |
|  |  | is\_flag=True, |
|  |  | required=False, |
|  |  | default=None, |
|  |  | help="Whether the user should be an admin.", |
|  |  | ) |
|  |  | @click.option( |
|  |  | "--user", |
|  |  | "-u", |
|  |  | "make\_user", |
|  |  | is\_flag=True, |
|  |  | required=False, |
|  |  | default=None, |
|  |  | help="Whether the user should be a regular user.", |
|  |  | ) |
|  |  | def update\_user( |
|  |  | user\_name\_or\_id: str, |
|  |  | updated\_name: Optional[str] = None, |
|  |  | updated\_full\_name: Optional[str] = None, |
|  |  | updated\_email: Optional[str] = None, |
|  |  | updated\_password: Optional[str] = None, |
|  |  | make\_admin: Optional[bool] = None, |
|  |  | make\_user: Optional[bool] = None, |
|  |  | ) -> None: |
|  |  | """Create a new user. |
|  |  | """Update an existing user. |
|  |  |  |
|  |  | Args: |
|  |  | user\_name\_or\_id: The name of the user to create. |
|  |  | updated\_name: The name of the user to create. |
|  |  | updated\_full\_name: The name of the user to create. |
|  |  | updated\_email: The name of the user to create. |
|  |  | updated\_password: The name of the user to create. |
|  |  | make\_admin: Whether the user should be an admin. |
|  |  | make\_user: Whether the user should be a regular user. |
|  |  | """ |
|  |  | if make\_admin is not None and make\_user is not None: |
|  |  | cli\_utils.error( |
|  |  | "Cannot set both --admin and --user flags as these are mutually exclusive." |
|  |  | ) |
|  |  | try: |
|  |  | current\_user = Client().get\_user( |
|  |  | user\_name\_or\_id, allow\_name\_prefix\_match=False |
|  |  | ) |
|  |  | if current\_user.is\_admin and make\_user: |
|  |  | confirmation = cli\_utils.confirmation( |
|  |  | f"Currently user `{current\_user.name}` is an admin. Are you sure you want to make them a regular user?" |
|  |  | ) |
|  |  | if not confirmation: |
|  |  | cli\_utils.declare("User update canceled.") |
|  |  | return |
|  |  |  |
|  |  | updated\_is\_admin = None |
|  |  | if make\_admin is True: |
|  |  | updated\_is\_admin = True |
|  |  | elif make\_user is True: |
|  |  | updated\_is\_admin = False |
|  |  | Client().update\_user( |
|  |  | name\_id\_or\_prefix=user\_name\_or\_id, |
|  |  | updated\_name=updated\_name, |
|  |  | updated\_full\_name=updated\_full\_name, |
|  |  | updated\_email=updated\_email, |
|  |  | updated\_password=updated\_password, |
|  |  | updated\_is\_admin=updated\_is\_admin, |
|  |  | ) |
|  |  | except (KeyError, IllegalOperationError) as err: |
|  |  | cli\_utils.error(str(err)) |
| Expand Down | |  |

14 changes: 13 additions & 1 deletion

14
[src/zenml/client.py](#diff-84b93992959735eed85ebcb2fed105598c4e421f5d0a1d964cf69f7ba0c33994 "src/zenml/client.py")

Show comments

[View file](/zenml-io/zenml/blob/b95f083efffa56831cd41d8ed536aeb0b6038fa3/src/zenml/client.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -691,18 +691,22 @@ def create\_user( |
|  |  | self, |
|  |  | name: str, |
|  |  | password: Optional[str] = None, |
|  |  | is\_admin: bool = False, |
|  |  | ) -> UserResponse: |
|  |  | """Create a new user. |
|  |  |  |
|  |  | Args: |
|  |  | name: The name of the user. |
|  |  | password: The password of the user. If not provided, the user will |
|  |  | be created with empty password. |
|  |  | is\_admin: Whether the user should be an admin. |
|  |  |  |
|  |  | Returns: |
|  |  | The model of the created user. |
|  |  | """ |
|  |  | user = UserRequest(name=name, password=password or None) |
|  |  | user = UserRequest( |
|  |  | name=name, password=password or None, is\_admin=is\_admin |
|  |  | ) |
|  |  | user.active = ( |
|  |  | password != "" if self.zen\_store.type != StoreType.REST else True |
|  |  | ) |
| Expand Down  Expand Up | | @@ -801,6 +805,8 @@ def update\_user( |
|  |  | updated\_email: Optional[str] = None, |
|  |  | updated\_email\_opt\_in: Optional[bool] = None, |
|  |  | updated\_hub\_token: Optional[str] = None, |
|  |  | updated\_password: Optional[str] = None, |
|  |  | updated\_is\_admin: Optional[bool] = None, |
|  |  | ) -> UserResponse: |
|  |  | """Update a user. |
|  |  |  |
| Expand All | | @@ -811,6 +817,8 @@ def update\_user( |
|  |  | updated\_email: The new email of the user. |
|  |  | updated\_email\_opt\_in: The new email opt-in status of the user. |
|  |  | updated\_hub\_token: Update the hub token |
|  |  | updated\_password: The new password of the user. |
|  |  | updated\_is\_admin: Whether the user should be an admin. |
|  |  |  |
|  |  | Returns: |
|  |  | The updated user. |
| Expand All | | @@ -830,6 +838,10 @@ def update\_user( |
|  |  | user\_update.email\_opted\_in = updated\_email\_opt\_in |
|  |  | if updated\_hub\_token is not None: |
|  |  | user\_update.hub\_token = updated\_hub\_token |
|  |  | if updated\_password is not None: |
|  |  | user\_update.password = updated\_password |
|  |  | if updated\_is\_admin is not None: |
|  |  | user\_update.is\_admin = updated\_is\_admin |
|  |  |  |
|  |  | return self.zen\_store.update\_user( |
|  |  | user\_id=user.id, user\_update=user\_update |
| Expand Down | |  |

1 change: 1 addition & 0 deletions

1
[src/zenml/models/v2/core/service\_account.py](#diff-ae704c5bd9c8373abe93d13e37c2f221e4388f47d5fd0b719b60e5e10229c908 "src/zenml/models/v2/core/service_account.py")

Show comments

[View file](/zenml-io/zenml/blob/b95f083efffa56831cd41d8ed536aeb0b6038fa3/src/zenml/models/v2/core/service_account.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -147,6 +147,7 @@ def to\_user\_model(self) -> "UserResponse": |
|  |  | email\_opted\_in=False, |
|  |  | created=self.created, |
|  |  | updated=self.updated, |
|  |  | is\_admin=False, |
|  |  | ), |
|  |  | metadata=UserResponseMetadata( |
|  |  | description=self.description, |
| Expand Down | |  |

114 changes: 78 additions & 36 deletions

114
[src/zenml/models/v2/core/user.py](#diff-e0fd6255a51cb63d6096cfe38642efc383d1176a3cfde4e29725ae74c247d50b "src/zenml/models/v2/core/user.py")

Show comments

[View file](/zenml-io/zenml/blob/b95f083efffa56831cd41d8ed536aeb0b6038fa3/src/zenml/models/v2/core/user.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -26,7 +26,7 @@ |
|  |  | ) |
|  |  | from uuid import UUID |
|  |  |  |
|  |  | from pydantic import Field, root\_validator |
|  |  | from pydantic import BaseModel, Field, root\_validator |
|  |  |  |
|  |  | from zenml.constants import STR\_FIELD\_MAX\_LENGTH |
|  |  | from zenml.models.v2.base.base import ( |
| Expand All | | @@ -35,40 +35,23 @@ |
|  |  | BaseRequest, |
|  |  | BaseResponseMetadata, |
|  |  | BaseResponseResources, |
|  |  | BaseZenModel, |
|  |  | ) |
|  |  | from zenml.models.v2.base.filter import AnyQuery, BaseFilter |
|  |  | from zenml.models.v2.base.update import update\_model |
|  |  |  |
|  |  | if TYPE\_CHECKING: |
|  |  | from passlib.context import CryptContext |
|  |  |  |
|  |  | from zenml.models.v2.base.filter import AnySchema |
|  |  |  |
|  |  | # ------------------ Request Model ------------------ |
|  |  |  |
|  |  | # ------------------ Base Model ------------------ |
|  |  |  |
|  |  | class UserRequest(BaseRequest): |
|  |  | """Request model for users.""" |
|  |  |  |
|  |  | # Analytics fields for user request models |
|  |  | ANALYTICS\_FIELDS: ClassVar[List[str]] = [ |
|  |  | "name", |
|  |  | "full\_name", |
|  |  | "active", |
|  |  | "email\_opted\_in", |
|  |  | ] |
|  |  | class UserBase(BaseModel): |
|  |  | """Base model for users.""" |
|  |  |  |
|  |  | # Fields |
|  |  | name: str = Field( |
|  |  | title="The unique username for the account.", |
|  |  | max\_length=STR\_FIELD\_MAX\_LENGTH, |
|  |  | ) |
|  |  | full\_name: str = Field( |
|  |  | default="", |
|  |  | title="The full name for the account owner. Only relevant for user " |
|  |  | "accounts.", |
|  |  | max\_length=STR\_FIELD\_MAX\_LENGTH, |
|  |  | ) |
|  |  |  |
|  |  | email: Optional[str] = Field( |
|  |  | default=None, |
|  |  | title="The email address associated with the account.", |
| Expand Down  Expand Up | | @@ -99,17 +82,6 @@ class UserRequest(BaseRequest): |
|  |  | default=None, |
|  |  | title="The external user ID associated with the account.", |
|  |  | ) |
|  |  | active: bool = Field(default=False, title="Whether the account is active.") |
|  |  |  |
|  |  | class Config: |
|  |  | """Pydantic configuration class.""" |
|  |  |  |
|  |  | # Validate attributes when assigning them |
|  |  | validate\_assignment = True |
|  |  |  |
|  |  | # Forbid extra attributes to prevent unexpected behavior |
|  |  | extra = "forbid" |
|  |  | underscore\_attrs\_are\_private = True |
|  |  |  |
|  |  | @classmethod |
|  |  | def \_get\_crypt\_context(cls) -> "CryptContext": |
| Expand Down  Expand Up | | @@ -165,13 +137,71 @@ def generate\_activation\_token(self) -> str: |
|  |  | return self.activation\_token |
|  |  |  |
|  |  |  |
|  |  | # ------------------ Request Model ------------------ |
|  |  |  |
|  |  |  |
|  |  | class UserRequest(UserBase, BaseRequest): |
|  |  | """Request model for users.""" |
|  |  |  |
|  |  | # Analytics fields for user request models |
|  |  | ANALYTICS\_FIELDS: ClassVar[List[str]] = [ |
|  |  | "name", |
|  |  | "full\_name", |
|  |  | "active", |
|  |  | "email\_opted\_in", |
|  |  | ] |
|  |  |  |
|  |  | name: str = Field( |
|  |  | title="The unique username for the account.", |
|  |  | max\_length=STR\_FIELD\_MAX\_LENGTH, |
|  |  | ) |
|  |  | full\_name: str = Field( |
|  |  | default="", |
|  |  | title="The full name for the account owner. Only relevant for user " |
|  |  | "accounts.", |
|  |  | max\_length=STR\_FIELD\_MAX\_LENGTH, |
|  |  | ) |
|  |  | is\_admin: bool = Field( |
|  |  | title="Whether the account is an administrator.", |
|  |  | ) |
|  |  | active: bool = Field(default=False, title="Whether the account is active.") |
|  |  |  |
|  |  | class Config: |
|  |  | """Pydantic configuration class.""" |
|  |  |  |
|  |  | # Validate attributes when assigning them |
|  |  | validate\_assignment = True |
|  |  |  |
|  |  | # Forbid extra attributes to prevent unexpected behavior |
|  |  | extra = "forbid" |
|  |  | underscore\_attrs\_are\_private = True |
|  |  |  |
|  |  |  |
|  |  | # ------------------ Update Model ------------------ |
|  |  |  |
|  |  |  |
|  |  | @update\_model |
|  |  | class UserUpdate(UserRequest): |
|  |  | class UserUpdate(UserBase, BaseZenModel): |
|  |  | """Update model for users.""" |
|  |  |  |
|  |  | name: Optional[str] = Field( |
|  |  | title="The unique username for the account.", |
|  |  | max\_length=STR\_FIELD\_MAX\_LENGTH, |
|  |  | default=None, |
|  |  | ) |
|  |  | full\_name: Optional[str] = Field( |
|  |  | default=None, |
|  |  | title="The full name for the account owner. Only relevant for user " |
|  |  | "accounts.", |
|  |  | max\_length=STR\_FIELD\_MAX\_LENGTH, |
|  |  | ) |
|  |  | is\_admin: Optional[bool] = Field( |
|  |  | default=None, |
|  |  | title="Whether the account is an administrator.", |
|  |  | ) |
|  |  | active: Optional[bool] = Field( |
|  |  | default=None, title="Whether the account is active." |
|  |  | ) |
|  |  |  |
|  |  | @root\_validator |
|  |  | def user\_email\_updates(cls, values: Dict[str, Any]) -> Dict[str, Any]: |
|  |  | """Validate that the UserUpdateModel conforms to the email-opt-in-flow. |
| Expand Down  Expand Up | | @@ -231,6 +261,9 @@ class UserResponseBody(BaseDatedResponseBody): |
|  |  | is\_service\_account: bool = Field( |
|  |  | title="Indicates whether this is a service account or a user account." |
|  |  | ) |
|  |  | is\_admin: bool = Field( |
|  |  | title="Whether the account is an administrator.", |
|  |  | ) |
|  |  |  |
|  |  |  |
|  |  | class UserResponseMetadata(BaseResponseMetadata): |
| Expand Down  Expand Up | | @@ -340,6 +373,15 @@ def is\_service\_account(self) -> bool: |
|  |  | """ |
|  |  | return self.get\_body().is\_service\_account |
|  |  |  |
|  |  | @property |
|  |  | def is\_admin(self) -> bool: |
|  |  | """The `is\_admin` property. |
|  |  |  |
|  |  | Returns: |
|  |  | Whether the user is an admin. |
|  |  | """ |
|  |  | return self.get\_body().is\_admin |
|  |  |  |
|  |  | @property |
|  |  | def email(self) -> Optional[str]: |
|  |  | """The `email` property. |
| Expand Down | |  |

1 change: 1 addition & 0 deletions

1
[src/zenml/models/v2/misc/external\_user.py](#diff-f62b4311b97d9042955e59c33490bfff98948dafc68b194f3aeb81f4f2d0a33f "src/zenml/models/v2/misc/external_user.py")

Show comments

[View file](/zenml-io/zenml/blob/b95f083efffa56831cd41d8ed536aeb0b6038fa3/src/zenml/models/v2/misc/external_user.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -25,6 +25,7 @@ class ExternalUserModel(BaseModel): |
|  |  | id: UUID |
|  |  | email: str |
|  |  | name: Optional[str] = None |
|  |  | is\_admin: bool = False |
|  |  |  |
|  |  | class Config: |
|  |  | """Pydantic configuration.""" |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `b95f083`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fzenml-io%2Fzenml%2Fcommit%2Fb95f083efffa56831cd41d8ed536aeb0b6038fa3) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

