<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="CVE-2023-38346 is a directory traversal vulnerability in Wind River's tarExtract function in VxWorks discovered by Pentagrid during a penetration test and source code review.">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Wind River VxWorks tarExtract directory traversal vulnerability (CVE-2023-38346) | Pentagrid AG</title>
<link href="../../../assets/fontawesome/css/all.min.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/baguetteBox.min.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/rst.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/code.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/theme.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<link rel="alternate" type="application/rss+xml" title="RSS (de)" href="../../../de/rss.xml">
<link rel="alternate" type="application/rss+xml" title="RSS (en)" href="../../rss.xml">
<link rel="canonical" href="https://www.pentagrid.ch/en/blog/wind-river-vxworks-tarextract-directory-traversal-vulnerability/">
<link rel="icon" href="../../../favicon.ico" sizes="16x16">
<link rel="icon" href="../../../icon_128x128.png" sizes="128x128">
<link rel="apple-touch-icon" href="../../../icon_128x128.png" sizes="128x128">
<!--[if lt IE 9]><script src="../../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Pentagrid AG">
<link rel="prev" href="../it-sicherheit-beim-elektronischen-gesundheitsdossier-im-fuerstentum-liechtenstein/" title="IT-Sicherheit beim elektronischen Gesundheitsdossier im FÃ¼rstentum Liechtenstein" type="text/html">
<link rel="next" href="../archive-pwn-tool-release/" title="Archive Pwn tool released" type="text/html">
<meta property="og:site_name" content="Pentagrid AG">
<meta property="og:title" content="Wind River VxWorks tarExtract directory traversal vulnerability (CVE-2">
<meta property="og:url" content="https://www.pentagrid.ch/en/blog/wind-river-vxworks-tarextract-directory-traversal-vulnerability/">
<meta property="og:description" content="CVE-2023-38346 is a directory traversal vulnerability in Wind River's tarExtract function in VxWorks discovered by Pentagrid during a penetration test and source code review.">
<meta property="og:image" content="https://www.pentagrid.ch/images/202309_river.png">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-09-19T07:00:00+01:00">
<meta property="article:tag" content="Advisory">
<meta property="article:tag" content="Directory Traversal">
<meta property="article:tag" content="Embedded devices">
<meta property="article:tag" content="Exploit">
<meta property="article:tag" content="Vulnerability">
<meta property="article:tag" content="VxWorks">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@pentagridsec">
<meta name="twitter:creator" content="@pentagridsec">
<link rel="alternate" hreflang="de" href="../../../de/blog/wind-river-vxworks-tarextract-directory-traversal-vulnerability/">
<meta name="geo.region" content="CH-SG">
<meta name="geo.placename" content="Buchs SG">
<meta name="geo.position" content="47.166808762756524;9.47720487085083">
<meta name="ICBM" content="47.166808762756524, 9.47720487085083">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->
<nav class="navbar navbar-expand-md static-top mb-4 navbar-dark bg-dark navbar-inverse bg-inverse "><div class="container">
<!-- This keeps the margins nice -->
        <a class="navbar-brand" href="https://www.pentagrid.ch/en/">
            <img src="../../../assets/images/logos/Logo_single_row_h25.png" alt="Pentagrid AG" id="logo" class="nav-link"><!-- was: d-inline-block align-middle --></a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="bs-navbar">
            <ul class="navbar-nav mr-auto">
<li class="nav-item">
<a href="../../pages/home/" class="nav-link">Home</a>
                </li>
<li class="nav-item">
<a href="../../pages/services/" class="nav-link">Services</a>
                </li>
<li class="nav-item">
<a href="../../pages/about-us/" class="nav-link">AboutÂ Us</a>
                </li>
<li class="nav-item">
<a href="../../pages/career/" class="nav-link">Career</a>
                </li>
<li class="nav-item">
<a href="../" class="nav-link">Blog</a>
                </li>
<li class="nav-item">
<a href="../../pages/imprint-and-contact/" class="nav-link">ImprintÂ andÂ Contact</a>

                
            </li>
</ul>
<ul class="navbar-nav navbar-right">
<li>
            </li>
<li class="nav-item"><a href="https://www.pentagrid.ch/de/" rel="alternate" hreflang="de" class="nav-link">Deutsch</a></li>

                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- Insert Carusel? --><!-- Content --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
        
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Wind River VxWorks tarExtract directory traversal vulnerability (CVE-2023-38346)</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    Pentagrid AG
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2023-09-19T07:00:00+01:00" itemprop="datePublished" title="2023-09-19 07:00">2023-09-19 07:00</time></a>
            </p>
            

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>Today we publish an advisory for a specific function in <a class="reference external" href="https://www.windriver.com/products/vxworks">Wind River's VxWorks operating system</a>.</p>
<p>VxWorks is a real-time operating system used in many embedded devices in high-availability environments with high safety and security requirements. This includes important industrial, medical, airospace, networking and automotive devices. For example, <a class="reference external" href="https://mars.nasa.gov/msl/home/">NASA's Curiosity rover</a> currently deployed on planet Mars is using Wind River's VxWorks operating system.</p>
<p>The vulnerability is triggered when VxWorks' <code class="docutils literal">tarExtract</code> function is used on untrusted tar archive files. The <a class="reference external" href="https://support2.windriver.com/index.php?page=cve&amp;on=view&amp;id=CVE-2023-38346">official VxWorks advisory can be found on the Wind River website</a>.</p>
<!-- TEASER_END -->
<section id="summary"><h2>Summary</h2>
<p>Pentagrid identified a vulnerability in VxWorks' <code class="docutils literal">tarExtract</code> method affecting at least VxWorks 21.07. The function <code class="docutils literal">tarExtract</code> implements tar file extraction and thereby also processes files within an archive that has relative or absolute file names. While end-user tar tools on other platforms usually stop processing an archive if not otherwise forced, the VxWorks' <code class="docutils literal">tarExtract</code> proceeds with processing relative or absolute filenames. This is unexpected and also undocumented behaviour, which in general may result in a directory traversal vulnerability.</p>
</section><section id="impact"><h2>Impact</h2>
<p>If a developer uses <code class="docutils literal">tarExtract</code> without additional checks, extracting an untrusted tar file may lead to an overwrite of files outside the current working directory in the filesystem of the VxWorks operating system. If the tar processing runs under elevated privileges, <code class="docutils literal">tarExtract</code> may overwrite arbitrary files in a VxWorks environment, which may then lead to a system compromise. In an embedded environment, extracting tar files likely happens during multi-file imports such as data ingestion or software/configuration update. The directory traversal may lead to a verification bypass, if a tar archive is extracted first and the verification of the content happens afterwards.</p>
<p>We rate the issue as a high-severity issue for devices that use the <code class="docutils literal">tarExtract</code> function on untrusted user input.</p>
</section><section id="timeline"><h2>Timeline</h2>
<ul class="simple">
<li><p>2023-06-05: Vulnerability noticed and research into tar behaviour started.</p></li>
<li><p>2023-06-21: Initial contact request as requested by <a class="reference external" href="https://www.windriver.com/psirt-policy">Wind River's PSIRT</a> and encrypted with the published PGP key. Communication of coordinated disclosure publication date 2023-09-19.</p></li>
<li><p>2023-06-21: Wind River PSIRT replies they can't decrypt the message and asks if we exchanged keys before. Pentagrid replied in a cleartext e-mail that we used the key from <a class="reference external" href="https://www.windriver.com/psirt-policy">Wind River's PSIRT website</a>.</p></li>
<li><p>2023-06-21: Pentagrid asks in a cleartext e-mail if they were able to decrypt the message now. No response from Wind River.</p></li>
<li><p>2023-06-28: Pentagrid asks in a cleartext e-mail for a status. Pentagrid informs Wind River that if we don't receive a response, we might publish information and will contact local authorities for communication support.</p></li>
<li><p>2023-06-28: Wind River is not able to decrypt the message. Wind River proposes to provide Pentagrid's keys in a password protected document and provide the password in a separate document. Alternatively, to send the e-mail unencrypted. Pentagrid resends advisory in an unencrypted e-mail to PSIRT lead. PSIRT lead commits to a monthly status update. Further e-mails only sent to PSIRT lead in cleartext.</p></li>
<li><p>2023-06-29: Wind River asks for flexibility on the disclosure deadline. An hour later Wind River asks to ignore the request.</p></li>
<li><p>2023-07-15: CVE-2023-38346 was assigned by MITRE.</p></li>
<li><p>2023-07-17: Status update by Wind River: Analysis ongoing.</p></li>
<li><p>2023-07-17: Wind River asks for a meeting.</p></li>
<li><p>2023-07-31: Video call between Pentagrid and Wind River. Wind River rates the vulnerability with a CVSS 3.1 score of 6.5 (Medium). Target version for a fix is 23.09. They are working on updating the documentation and introduce a secure default behavior of tarExtract. A communication plan for customers before coordinated disclosure date is in place.</p></li>
<li><p>2023-08-28: Video call between Pentagrid and Wind River, status update.</p></li>
<li><p>2023-09-13: Video call between Pentagrid and Wind River, status update.</p></li>
<li><p>2023-09-19: Coordinated disclosure, Wind River publishes <a class="reference external" href="https://support2.windriver.com/index.php?page=cve&amp;on=view&amp;id=CVE-2023-38346">their adisory</a>.</p></li>
</ul></section><section id="affected-components"><h2>Affected Components</h2>
<p>The issue affects VxWorks' <code class="docutils literal">tarExtract</code> method affecting in at least VxWorks 21.07. Pentagrid assumes that all VxWorks versions released before September 2023 are affected.</p>
<p>It is unknown to Pentagrid which or how many embedded devices implement a data ingestion or software/configuration update function by parsing untrusted archives with <code class="docutils literal">tarExtract</code>. It is likely that many devices are affected, as there seems to be no other data ingestion functionality available in the VxWorks Kernel API.</p>
<p>CVE-2023-38346 has been assigned to this issue. The <a class="reference external" href="https://support2.windriver.com/index.php?page=cve&amp;on=view&amp;id=CVE-2023-38346">official VxWorks advisory can be found on the Wind River website</a>.</p>
</section><section id="background-information"><h2>Background information</h2>
<p>This finding is about different expectations and assumptions when using a tar extraction function. If there is a mismatch regarding the expectations and the actual behaviour, this might lead to a security issue.</p>
<p>First of all, the standard tar utilities present in Linux, FreeBSD and also Busybox will not extract a file from an archive, if the file has an absolute file name or a relative file name outside the unpacking directory. Instead, these tools show a warning. For GNU and BSD tar, the option <code class="docutils literal"><span class="pre">--absolute-names</span></code> (<code class="docutils literal"><span class="pre">-P</span></code>) must be added to force extraction of such files. For example, one may expect that extracting an archive in the download folder hopefully does not overwrite a user's <code class="docutils literal"><span class="pre">~/.bashrc</span></code>.</p>
<p>Furthermore, if an archive is extracted from the root directory (<code class="docutils literal">/</code>), all path names are relative to the root directory. Files and directories may already exist and there is no need to use the pattern <code class="docutils literal">../</code> to traverse through the filesystem. Usually, software developers expect this behaviour when applications are installed. This should be known by every software developer and can be considered expected behaviour. However, absolute paths and directory traversal paths are not expected behaviour for many software developers as the following security issues illustrate.</p>
<p>There were several vulnerabilities in the past regarding relative file names in tar files, for example:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/isaacs/node-tar/security/advisories/GHSA-5955-9wpr-37jh">node-tar - Fast and full-featured Tar for Node.js: Arbitrary File Creation/Overwrite on Windows via insufficient relative path sanitization (CVE-2021-37713)</a></p></li>
<li><p><a class="reference external" href="https://github.com/isaacs/node-tar/security/advisories/GHSA-qq89-hq3f-393p">node-tar - Fast and full-featured Tar for Node.js: Arbitrary File Creation/Overwrite via insufficient symlink protection due to directory cache poisoning using symbolic links (CVE-2021-37712)</a></p></li>
<li><p><a class="reference external" href="https://github.com/isaacs/node-tar/security/advisories/GHSA-9r2w-394v-53qc">node-tar - Fast and full-featured Tar for Node.js: Arbitrary File Creation/Overwrite via insufficient symlink protection due to directory cache poisoning using symbolic links (CVE-2021-37701)</a></p></li>
<li><p><a class="reference external" href="https://github.com/isaacs/node-tar/security/advisories/GHSA-r628-mhmh-qjhw">node-tar - Fast and full-featured Tar for Node.js: Arbitrary File Creation/Overwrite via insufficient symlink protection due to directory cache poisoning (CVE-2021-32803)</a></p></li>
<li><p><a class="reference external" href="https://github.com/isaacs/node-tar/security/advisories/GHSA-3jfq-g458-7qm9">node-tar - Arbitrary File Creation/Overwrite on Windows via insufficient relative path sanitization (CVE-2021-32804),</a></p></li>
<li><p><a class="reference external" href="https://www.sonarsource.com/blog/bitbucket-path-traversal-to-rce/">Bitbucket 6.1.1 Path Traversal to RCE (CVE-2019-3397)</a></p></li>
<li><p><a class="reference external" href="https://www.randori.com/blog/cve-2021-21972-vsphere-vulnerability-analysis/">VMware vCenter Server, vSphere Client - Remote code execution (CVE-2021-21972)</a></p></li>
<li><p><a class="reference external" href="https://security.snyk.io/research/zip-slip-vulnerability">A vulnerability called Zip Slip affects many libraries (including CVE-2018-1002203, CVE-2018-1002204, CVE-2018-1002200, CVE-2018-1002201, CVE-2018-1002202, CVE-2018-1002205, CVE-2018-1002206, CVE-2019-10743, CVE-2018-1002208, CVE-2018-1000544, CVE-2018-1002209, CVE-2018-10860)</a></p></li>
<li><p><a class="reference external" href="https://www.rapid7.com/blog/post/2022/10/06/exploitation-of-unpatched-zero-day-remote-code-execution-vulnerability-in-zimbra-collaboration-suite-cve-2022-41352/">The collaboration software Zimbra had a remotely exploitable vulnerability (CVE-2022-41352) originating in the use of Amavis that extracts tar files using the cpio tool.</a> The problem with <a class="reference external" href="https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=774669">GNU cpio is known for years as CVE-2015-1197 and also partially patched</a>.</p></li>
<li><p><a class="reference external" href="https://nvd.nist.gov/vuln/detail/CVE-2007-4559">Python tarfile (CVE-2007-4559)</a></p></li>
</ul>
<p>The last example of Python's tarfile got a CVE-ID assigned, but is still unfixed. Many discussions about this issue can be found on the Internet. At least <a class="reference external" href="https://docs.python.org/3.11/library/tarfile.html#tarfile.TarFile.extractall">Python's API documentation highlights a prominent warning</a>. But despite this warning, it seems to violate the principle of least astonishment: <a class="reference external" href="https://www.trellix.com/en-us/about/newsroom/stories/research/tarfile-exploiting-the-world.html">A researcher from Trellix rediscovered this issue</a>, wrote a tool for automated code-analysis and <a class="reference external" href="https://www.trellix.com/en-us/about/newsroom/stories/research/open-source-intelligence.html">estimated that there may be 340,000 repositories at Github vulnerable to the tarfile problem</a> and this despite a documented warning. The Bitbucket and VMware vulnerabilities mentioned above are both based on the <a class="reference external" href="https://commons.apache.orgZimbra/proper/commons-compress/apidocs/overview-summary.html">tar extractor implementation org.apache.commons.compress.archivers.tar from the Apache Commons Compress library</a>. This library does not have a prominent warning and obviously expectations on who must take care of what failed there, too.</p>
<p>Bitbucket (CVE-2019-3397), Zimbra (CVE-2022-41352), vCenter (CVE-2021-21972) have CVSS Base Score beyond 9.0, implicating a critical severity. The last two vulnerabilities were added to CISA's <a class="reference external" href="https://www.cisa.gov/known-exploited-vulnerabilities-catalog">Known Exploited Vulnerabilities Catalog</a>. That means there is a good reason, why even a documented but unexpected behaviour becomes a problem, especially in security-critical environments.</p>
<p>While the above list is about tar archives, the same problem exists for many archive formats, for example:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://security.snyk.io/research/zip-slip-vulnerability">Zip Slip</a></p></li>
<li><p><a class="reference external" href="../busybox-cpio-directory-traversal-vulnerability/">Busybox cpio directory traversal vulnerability (CVE-2023-39810)</a></p></li>
</ul></section><section id="technical-details"><h2>Technical Details</h2>
<p>Extracting untrusted user-supplied tar files in an embedded device is part of a user-friendly way to implement a multi-file import such as data ingestion or software/configuration update. The device allows tar import instead of multiple files, to simplify the process for the user. At the same time, overwriting or adding an attacker-supplied file to a file system might lead to direct remote command execution vulnerability (e.g. by overwriting an application binary that includes executable code). Therefore, many implementations of software/configuration update functions in commercial products verify the supplied files (e.g. by using cryptographic signatures). But these signatures have to be stored somewhere and therefore are usually included in the tar file. As tar file extraction therefore has to happen in a first step (to extract the cryptographic signature and the update files) and before any content is verified, the current behaviour of <code class="docutils literal">tarExtract</code> allows to bypass such verification steps as well.</p>
<p>Documentation and source code at least for VxWorks 5.5 and 6.6 does not mention required steps to process a tar file in order to prevent vulnerabilities. It does not include warnings for the <code class="docutils literal">tarExtract</code> function and that it shouldn't be applied to untrusted tar files. It also does not include a guide on how a multi-file import, such as data ingestion or software/configuration update via a single archive file (zip, tar, etc.), could be securely implemented. Tar is the only archive format currently supported according to the VxWorks Kernel API documentation.</p>
<p>Therefore, Pentagrid assumes that many current implementations of data ingestion or software/configuration update functions in devices with VxWorks have this vulnerability.</p>
<p>As privilege separation via different users in VxWorks was only recently introduced, it is possible that current implementations do not already use this feature. Therefore, it is possible that data ingestion or software/configuration update functions do not protect themself by using different users and access permissions on the operating system level.</p>
<p>As VxWorks <code class="docutils literal">tarToc</code> function only prints to standard output, software developers would need to write custom parsers to check that the tar contents are safe to unpack. This introduces undesired complexity and dependency on the <code class="docutils literal">tarToc</code> output format not changing between VxWorks versions.</p>
<p>Exploitation of the <code class="docutils literal">tarExtract</code> issue can be achieved by supplying a crafted tar file. For creating such a tar file, Pentagrid used a simple script based on the Python version 3 tarfile library, which is flexible regarding the handling of relative file names as mentioned earlier. The used script is shown below:</p>
<div class="code"><pre class="code python"><a id="rest_code_dd6b0395dd2a465ea335017e4d84a67f-1" name="rest_code_dd6b0395dd2a465ea335017e4d84a67f-1" href="#rest_code_dd6b0395dd2a465ea335017e4d84a67f-1"></a><span class="ch">#!/usr/bin/env python3</span>
<a id="rest_code_dd6b0395dd2a465ea335017e4d84a67f-2" name="rest_code_dd6b0395dd2a465ea335017e4d84a67f-2" href="#rest_code_dd6b0395dd2a465ea335017e4d84a67f-2"></a><span class="c1">#</span>
<a id="rest_code_dd6b0395dd2a465ea335017e4d84a67f-3" name="rest_code_dd6b0395dd2a465ea335017e4d84a67f-3" href="#rest_code_dd6b0395dd2a465ea335017e4d84a67f-3"></a><span class="c1"># The author of this code is not responsible for any damage caused by the use</span>
<a id="rest_code_dd6b0395dd2a465ea335017e4d84a67f-4" name="rest_code_dd6b0395dd2a465ea335017e4d84a67f-4" href="#rest_code_dd6b0395dd2a465ea335017e4d84a67f-4"></a><span class="c1"># or misuse of this PoC exploit. This PoCs is intended for educational and</span>
<a id="rest_code_dd6b0395dd2a465ea335017e4d84a67f-5" name="rest_code_dd6b0395dd2a465ea335017e4d84a67f-5" href="#rest_code_dd6b0395dd2a465ea335017e4d84a67f-5"></a><span class="c1"># research purposes only, and should never be used to target or exploit systems</span>
<a id="rest_code_dd6b0395dd2a465ea335017e4d84a67f-6" name="rest_code_dd6b0395dd2a465ea335017e4d84a67f-6" href="#rest_code_dd6b0395dd2a465ea335017e4d84a67f-6"></a><span class="c1"># without explicit permission from the owner.</span>
<a id="rest_code_dd6b0395dd2a465ea335017e4d84a67f-7" name="rest_code_dd6b0395dd2a465ea335017e4d84a67f-7" href="#rest_code_dd6b0395dd2a465ea335017e4d84a67f-7"></a><span class="c1">#</span>
<a id="rest_code_dd6b0395dd2a465ea335017e4d84a67f-8" name="rest_code_dd6b0395dd2a465ea335017e4d84a67f-8" href="#rest_code_dd6b0395dd2a465ea335017e4d84a67f-8"></a><span class="kn">import</span> <span class="nn">tarfile</span>
<a id="rest_code_dd6b0395dd2a465ea335017e4d84a67f-9" name="rest_code_dd6b0395dd2a465ea335017e4d84a67f-9" href="#rest_code_dd6b0395dd2a465ea335017e4d84a67f-9"></a><span class="kn">import</span> <span class="nn">os</span>
<a id="rest_code_dd6b0395dd2a465ea335017e4d84a67f-10" name="rest_code_dd6b0395dd2a465ea335017e4d84a67f-10" href="#rest_code_dd6b0395dd2a465ea335017e4d84a67f-10"></a><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">"emptyfile"</span><span class="p">,</span> <span class="s2">"wb"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="rest_code_dd6b0395dd2a465ea335017e4d84a67f-11" name="rest_code_dd6b0395dd2a465ea335017e4d84a67f-11" href="#rest_code_dd6b0395dd2a465ea335017e4d84a67f-11"></a>    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">b</span><span class="s2">"Just a test"</span><span class="p">)</span>
<a id="rest_code_dd6b0395dd2a465ea335017e4d84a67f-12" name="rest_code_dd6b0395dd2a465ea335017e4d84a67f-12" href="#rest_code_dd6b0395dd2a465ea335017e4d84a67f-12"></a><span class="n">tar_out</span> <span class="o">=</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">"example.tar"</span><span class="p">,</span> <span class="s2">"w"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="n">tarfile</span><span class="o">.</span><span class="n">GNU_FORMAT</span><span class="p">)</span>
<a id="rest_code_dd6b0395dd2a465ea335017e4d84a67f-13" name="rest_code_dd6b0395dd2a465ea335017e4d84a67f-13" href="#rest_code_dd6b0395dd2a465ea335017e4d84a67f-13"></a><span class="n">tar_out</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">"emptyfile"</span><span class="p">,</span> <span class="n">arcname</span><span class="o">=</span><span class="s2">"../TRAVERSAL"</span><span class="p">)</span>
<a id="rest_code_dd6b0395dd2a465ea335017e4d84a67f-14" name="rest_code_dd6b0395dd2a465ea335017e4d84a67f-14" href="#rest_code_dd6b0395dd2a465ea335017e4d84a67f-14"></a><span class="n">tar_out</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<a id="rest_code_dd6b0395dd2a465ea335017e4d84a67f-15" name="rest_code_dd6b0395dd2a465ea335017e4d84a67f-15" href="#rest_code_dd6b0395dd2a465ea335017e4d84a67f-15"></a><span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">"emptyfile"</span><span class="p">)</span>
</pre></div>
</section><section id="precondition"><h2>Precondition</h2>
<p>Program code that passes an untrusted tar file to the VxWorks <code class="docutils literal">tarExtract</code> function has to be present, meaning the developers must have been unaware of the implications of unpacking untrusted tar files.</p>
</section><section id="recommendation"><h2>Recommendation</h2>
<p>User recommendation:</p>
<ul class="simple">
<li><p>To apply the <a class="reference external" href="https://support2.windriver.com/index.php?page=cve&amp;on=view&amp;id=CVE-2023-38346">patch/update supplied by Wind River</a>.</p></li>
<li><p>It is recommended to do integrity/authenticity checks (e.g. cryptographic signature checks) on the tar file before it is extracted to make sure it is of trusted origin where possible. We are aware that in practice this is not user friendly as the signature would need to be stored separately in another file next to the tar file. It might be feasible to append the signature to the tar file and remove it before checking the tar, but this could result in non-standard tar files.</p></li>
<li><p>It is recommended to check tar file contents by using a third-party library or custom code. It is not reommended to use the VxWorks tarToc kernel function as it will only print to stdout, which makes it impractical for further processing.</p></li>
</ul>
<p>The original recommendations for Wind River were:</p>
<ul class="simple">
<li><p>It is recommended to implement file name filtering to follow the best-practise of simplifying safe and secure library usage, while improper use of a library should be made more difficult, for example by adding an explicit force parameter to process insecure filenames.</p></li>
<li><p>It is recommended to add a clear statement in the documentation and API reference documentation if <code class="docutils literal">tarExtract</code> is safe to be used with untrusted tar files or not.</p></li>
<li><p>It is recommended to consider how customers of Wind River could be supported in the future by providing more high-level APIs that provide secure data ingestion or software/configuration update functions that include signature checks.</p></li>
<li><p>It is recommended to inform Wind River's customers about the vulnerability.</p></li>
</ul></section><section id="credits"><h2>Credits</h2>
<p>The vulnerability has been found by Tobias Ospelt and Martin Schobert of Pentagrid. Pentagrid would like to thank Wind River for the support during the coordinated disclosure process.</p>
</section>
</div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/advisory/" rel="tag">Advisory</a></li>
            <li><a class="tag p-category" href="../../categories/directory-traversal/" rel="tag">Directory Traversal</a></li>
            <li><a class="tag p-category" href="../../categories/embedded-devices/" rel="tag">Embedded devices</a></li>
            <li><a class="tag p-category" href="../../categories/exploit/" rel="tag">Exploit</a></li>
            <li><a class="tag p-category" href="../../categories/vulnerability/" rel="tag">Vulnerability</a></li>
            <li><a class="tag p-category" href="../../categories/vxworks/" rel="tag">VxWorks</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../it-sicherheit-beim-elektronischen-gesundheitsdossier-im-fuerstentum-liechtenstein/" rel="prev" title="IT-Sicherheit beim elektronischen Gesundheitsdossier im FÃ¼rstentum Liechtenstein">Previous post</a>
            </li>
            <li class="next">
                <a href="../archive-pwn-tool-release/" rel="next" title="Archive Pwn tool released">Next post</a>
            </li>
        </ul></nav></aside></article><!--End of body content-->
</div>
</div>



            <script src="../../../assets/js/jquery.min.js"></script><script src="../../../assets/js/popper.min.js"></script><script src="../../../assets/js/bootstrap.min.js"></script><script src="../../../assets/js/baguetteBox.min.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><!-- Footer --><div class="d-print-none" style="position: relative; width: 20px; height: 20px; background-color: #ff0000; float: right; margin: 0px; top: -20px;"></div>


<footer class="jumbotron jumbotron-fluid bg-secondary text-light mb-0 d-print-none" id="footer"><div class="container">

    <!-- First footer row -->
    
    <div class="row">

      <div class="col-md-6">      
        <p>
	Contact:</p>
	<p>
        <b>PentagridÂ AG</b><br>
        Bahnhofstrasse 7<br>
        CH-9470 Buchs SG<br>
        Switzerland
        </p>
	<p>
        <b>PentagridÂ GmbH</b><br>
        Am Treptower Park 75<br>
        DE-12435 Berlin<br>
        Germany
        </p>
	<p>
        Phone: +41 81 511 2556<br>	
	E-mail: <a href="mailto:contact@pentagrid.ch">contact@pentagrid.ch</a>
	</p>
      </div>


      <div class="col-md-3">
      <p>
           Follow us:
      </p>
      <p>
	   <a href="../../rss.xml" aria-label="RSS">
	   <i class="fas fa-rss fa-2x fa-inverse mr-2" aria-hidden="true"></i>
	   </a>

	   <a rel="me" href="https://infosec.exchange/@pentagrid" aria-label="Mastodon">
	   <i class="fab fa-mastodon fa-2x fa-inverse mr-2" aria-hidden="true"></i>
	   </a>

	   <a href="https://bsky.app/profile/pentagrid.bsky.social" aria-label="Bluesky">
	   <i class="fab fa-bluesky fa-2x fa-inverse mr-2" aria-hidden="true"></i>
	   </a>

	   <a href="https://github.com/pentagridsec" aria-label="Github">
	   <i class="fab fa-github fa-2x fa-inverse mr-2" aria-hidden="true"></i>
	   </a>
	   
	   <a href="https://www.linkedin.com/company/67698060/" aria-label="LinkedIn">
	   <i class="fab fa-linkedin fa-2x fa-inverse mr-2" aria-hidden="true"></i>
	   </a>
	   
	   <a href="https://www.xing.com/companies/pentagridag" aria-label="Xing">
	   <i class="fab fa-xing fa-2x fa-inverse mr-2" aria-hidden="true"></i>
	   </a>
	   	   
	</p>	   
      </div>


    </div>

    <!-- Second footer row -->
    <div class="row">
      <div class="col-md-3">
        <p>
	   
	   
           Â© 2025 PentagridÂ AG. All rights reserved.
        </p>
      </div>
    </div>
    
  </div>
</footer>
</body>
</html>
