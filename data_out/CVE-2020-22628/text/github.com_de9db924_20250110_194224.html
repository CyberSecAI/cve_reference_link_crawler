
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FLibRaw%2FLibRaw%2Fissues%2F269)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FLibRaw%2FLibRaw%2Fissues%2F269)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=LibRaw%2FLibRaw)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[LibRaw](/LibRaw)
/
**[LibRaw](/LibRaw/LibRaw)**
Public

* [Notifications](/login?return_to=%2FLibRaw%2FLibRaw) You must be signed in to change notification settings
* [Fork
  287](/login?return_to=%2FLibRaw%2FLibRaw)
* [Star
   1.2k](/login?return_to=%2FLibRaw%2FLibRaw)

* [Code](/LibRaw/LibRaw)
* [Issues
  2](/LibRaw/LibRaw/issues)
* [Pull requests
  0](/LibRaw/LibRaw/pulls)
* [Actions](/LibRaw/LibRaw/actions)
* [Projects
  0](/LibRaw/LibRaw/projects)
* [Wiki](/LibRaw/LibRaw/wiki)
* [Security](/LibRaw/LibRaw/security)
* [Insights](/LibRaw/LibRaw/pulse)

Additional navigation options

* [Code](/LibRaw/LibRaw)
* [Issues](/LibRaw/LibRaw/issues)
* [Pull requests](/LibRaw/LibRaw/pulls)
* [Actions](/LibRaw/LibRaw/actions)
* [Projects](/LibRaw/LibRaw/projects)
* [Wiki](/LibRaw/LibRaw/wiki)
* [Security](/LibRaw/LibRaw/security)
* [Insights](/LibRaw/LibRaw/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FLibRaw%2FLibRaw%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FLibRaw%2FLibRaw%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# "LibRaw::stretch()" Out-of-bounds read vulnerability #269

Closed

[GirlElecta](/GirlElecta) opened this issue
Mar 25, 2020
· 2 comments

Closed

# ["LibRaw::stretch()" Out-of-bounds read vulnerability](#top) #269

[GirlElecta](/GirlElecta) opened this issue
Mar 25, 2020
· 2 comments

## Comments

[![@GirlElecta](https://avatars.githubusercontent.com/u/61733998?s=80&v=4)](/GirlElecta)

Copy link

### **[GirlElecta](/GirlElecta)** commented [Mar 25, 2020](#issue-587920532) • edited Loading

| **Description**  An out-of-bounds read vulnerability exists within the "LibRaw::stretch()" function (libraw\src\postprocessing\aspect\_ratio.cpp) when parsing a crafted CRW file.  **Steps to Reproduce**  (poc archive password= girlelecta): <https://drive.google.com/open?id=1Y70DxvWYfsNS7DBu4cuoUVOoMOyheA8O>  cmd: magick.exe convert poc.crw new.png  Upon running this, following crash happens (Note: I enabled page heap on magick.exe):  Microsoft (R) Windows Debugger Version 10.0.18362.1 AMD64 Copyright (c) Microsoft Corporation. All rights reserved.  CommandLine: "C:\Program Files\ImageMagick-7.0.9-Q16\magick.exe" convert E:\Workspace\poc.crw E:\Workspace\new.png  \*\*\*\*\*\*\*\*\*\*\*\*\* Path validation summary \*\*\*\*\*\*\*\*\*\*\*\*\*\* Symbol search path is: srv\* Executable search path is: ModLoad: 00007ff7 93fc0000 00007ff7 93fcc000 image00007ff7 93fc0000 ModLoad: 00007ff8 87ea0000 00007ff8 88090000 ntdll.dll ModLoad: 00007ff8 70fb0000 00007ff8 71021000 C:\WINDOWS\System32\verifier.dll Page heap: pid 0x2ADC: page heap enabled with flags 0x3. ModLoad: 00007ff8 87bb0000 00007ff8 87c62000 C:\WINDOWS\System32\KERNEL32.DLL ModLoad: 00007ff8 85820000 00007ff8 85ac3000 C:\WINDOWS\System32\KERNELBASE.dll ModLoad: 00007ff8 6e630000 00007ff8 6e808000 C:\Program Files\ImageMagick-7.0.9-Q16\CORE\_RL\_MagickCore\_.dll ModLoad: 00007ff8 6e550000 00007ff8 6e629000 C:\Program Files\ImageMagick-7.0.9-Q16\CORE\_RL\_MagickWand\_.dll ModLoad: 00007ff8 6e460000 00007ff8 6e54f000 C:\Program Files\ImageMagick-7.0.9-Q16\MSVCR120.dll ModLoad: 000002c7 22170000 000002c7 2225f000 C:\Program Files\ImageMagick-7.0.9-Q16\MSVCR120.dll ModLoad: 00007ff8 74a90000 00007ff8 74ab2000 C:\Program Files\ImageMagick-7.0.9-Q16\VCOMP120.DLL ModLoad: 00007ff8 876f0000 00007ff8 87884000 C:\WINDOWS\System32\USER32.dll ModLoad: 00007ff8 85e80000 00007ff8 85ea1000 C:\WINDOWS\System32\win32u.dll ModLoad: 00007ff8 862f0000 00007ff8 86316000 C:\WINDOWS\System32\GDI32.dll ModLoad: 00007ff8 855b0000 00007ff8 85744000 C:\WINDOWS\System32\gdi32full.dll ModLoad: 00007ff8 85eb0000 00007ff8 85f4e000 C:\WINDOWS\System32\msvcp\_win.dll ModLoad: 00007ff8 87c70000 00007ff8 87d13000 C:\WINDOWS\System32\ADVAPI32.dll ModLoad: 00007ff8 86680000 00007ff8 8671e000 C:\WINDOWS\System32\msvcrt.dll ModLoad: 00007ff8 861f0000 00007ff8 86287000 C:\WINDOWS\System32\sechost.dll ModLoad: 00007ff8 85ad0000 00007ff8 85bca000 C:\WINDOWS\System32\ucrtbase.dll ModLoad: 00007ff8 87d40000 00007ff8 87e60000 C:\WINDOWS\System32\RPCRT4.dll ModLoad: 00007ff8 74f30000 00007ff8 74f44000 C:\Program Files\ImageMagick-7.0.9-Q16\CORE\_RL\_bzlib\_.dll ModLoad: 00007ff8 86600000 00007ff8 8666f000 C:\WINDOWS\System32\WS2\_32.dll ModLoad: 00007ff8 6e400000 00007ff8 6e456000 C:\Program Files\ImageMagick-7.0.9-Q16\CORE\_RL\_lcms\_.dll ModLoad: 00007ff8 6e360000 00007ff8 6e400000 C:\Program Files\ImageMagick-7.0.9-Q16\CORE\_RL\_freetype\_.dll ModLoad: 00007ff8 73500000 00007ff8 73513000 C:\Program Files\ImageMagick-7.0.9-Q16\CORE\_RL\_lqr\_.dll ModLoad: 00007ff8 73000000 00007ff8 73018000 C:\Program Files\ImageMagick-7.0.9-Q16\CORE\_RL\_zlib\_.dll ModLoad: 00007ff8 6e100000 00007ff8 6e355000 C:\Program Files\ImageMagick-7.0.9-Q16\CORE\_RL\_glib\_.dll ModLoad: 00007ff8 86720000 00007ff8 86e05000 C:\WINDOWS\System32\SHELL32.dll ModLoad: 00007ff8 857d0000 00007ff8 8581a000 C:\WINDOWS\System32\cfgmgr32.dll ModLoad: 00007ff8 85f50000 00007ff8 85ff9000 C:\WINDOWS\System32\shcore.dll ModLoad: 00007ff8 86e10000 00007ff8 87146000 C:\WINDOWS\System32\combase.dll ModLoad: 00007ff8 85d20000 00007ff8 85da0000 C:\WINDOWS\System32\bcryptPrimitives.dll ModLoad: 00007ff8 84e30000 00007ff8 855af000 C:\WINDOWS\System32\windows.storage.dll ModLoad: 00007ff8 84e10000 00007ff8 84e2f000 C:\WINDOWS\System32\profapi.dll ModLoad: 00007ff8 84d80000 00007ff8 84dca000 C:\WINDOWS\System32\powrprof.dll ModLoad: 00007ff8 84d70000 00007ff8 84d80000 C:\WINDOWS\System32\UMPDC.dll ModLoad: 00007ff8 87910000 00007ff8 87962000 C:\WINDOWS\System32\shlwapi.dll ModLoad: 00007ff8 84dd0000 00007ff8 84de1000 C:\WINDOWS\System32\kernel.appcore.dll ModLoad: 00007ff8 857b0000 00007ff8 857c7000 C:\WINDOWS\System32\cryptsp.dll ModLoad: 00007ff8 87a50000 00007ff8 87ba6000 C:\WINDOWS\System32\ole32.dll ModLoad: 00007ff8 842f0000 00007ff8 8432a000 C:\WINDOWS\SYSTEM32\IPHLPAPI.DLL ModLoad: 00007ff8 84330000 00007ff8 843fa000 C:\WINDOWS\SYSTEM32\DNSAPI.dll ModLoad: 00007ff8 87900000 00007ff8 87908000 C:\WINDOWS\System32\NSI.dll ModLoad: 00007ff8 6e090000 00007ff8 6e0f8000 C:\Program Files\ImageMagick-7.0.9-Q16\CORE\_RL\_libxml\_.dll (2adc.2ae0): Break instruction exception - code 80000003 (first chance) ntdll!LdrInitShimEngineDynamic+0x35c: 00007ff8 87f7121c cc int 3 0:000> g ModLoad: 00007ff8 86000000 00007ff8 8602e000 C:\WINDOWS\System32\IMM32.DLL ModLoad: 00007ff8 77200000 00007ff8 7720a000 C:\Program Files\ImageMagick-7.0.9-Q16\modules\coders\IM\_MOD\_RL\_DNG\_.dll ModLoad: 00007ff8 5fe70000 00007ff8 5ff74000 C:\Program Files\ImageMagick-7.0.9-Q16\CORE\_RL\_libraw\_.dll ModLoad: 00007ff8 6df60000 00007ff8 6e006000 C:\Program Files\ImageMagick-7.0.9-Q16\MSVCP120.dll (2adc.2ae0): Access violation - code c0000005 (first chance) First chance exceptions are reported before any exception handling. This exception may be expected and handled. CORE\_RL\_libraw\_!LibRaw::stretch+0x17d: 00007ff8 5febc7ed 430fb70402 movzx eax,word ptr [r10+r8] ds:000002c7 284ac5c0=???? 0:000> k Child-SP RetAddr Call Site 00 000000e1 ef2f3af0 00007ff8 5fedb222 CORE\_RL\_libraw\_!LibRaw::stretch+0x17d 01 000000e1 ef2f3b70 00007ff8 772016b4 CORE\_RL\_libraw\_!LibRaw::dcraw\_process+0x562 02 000000e1 ef2f3be0 00007ff8 6e6704ac IM\_MOD\_RL\_DNG\_+0x16b4 03 000000e1 ef2f5c70 00007ff8 6e670fbc CORE\_RL\_MagickCore\_!ReadImage+0x47c 04 000000e1 ef2fadc0 00007ff8 6e569636 CORE\_RL\_MagickCore\_!ReadImages+0x1ac 05 000000e1 ef2fbe40 00007ff8 6e5ac907 CORE\_RL\_MagickWand\_!ConvertImageCommand+0x566 06 000000e1 ef2fd760 00007ff7 93fc130b CORE\_RL\_MagickWand\_!MagickCommandGenesis+0x5a7 07 000000e1 ef2fe920 00007ff7 93fc13ec image00007ff7\_93fc0000+0x130b 08 000000e1 ef2ffb30 00007ff7 93fc1783 image00007ff7\_93fc0000+0x13ec 09 000000e1 ef2ffb60 00007ff8 87bc7bd4 image00007ff7\_93fc0000+0x1783 0a 000000e1 ef2ffb90 00007ff8 87f0ced1 KERNEL32!BaseThreadInitThunk+0x14 0b 000000e1 ef2ffbc0 00000000 00000000 ntdll!RtlUserThreadStart+0x21  **System Configuration**   * ImageMagick:   Version: ImageMagick-7.0.9-Q16 <https://imagemagick.org>   License: <https://imagemagick.org/script/license.php> * Environment (Operating system, version and so on):   Distributor ID: Microsoft Windows   Description: Windows 10 |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@LibRaw](https://avatars.githubusercontent.com/u/435672?s=80&u=251cfce65048ed9a6283ea0ebfe262af9b6859fc&v=4)](/LibRaw)

Copy link

Owner

### **[LibRaw](/LibRaw)** commented [Mar 26, 2020](#issuecomment-604268920)

| Fixed by this patch: [84bbb97](https://github.com/LibRaw/LibRaw/commit/84bbb972d94a965f70302b85738778443540774a)  (sorry, it was wrong date on devel machine) |
| --- |

All reactions

Sorry, something went wrong.

[![@LibRaw](https://avatars.githubusercontent.com/u/435672?s=40&u=251cfce65048ed9a6283ea0ebfe262af9b6859fc&v=4)](/LibRaw)
[LibRaw](/LibRaw)
closed this as [completed](/LibRaw/LibRaw/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Mar 26, 2020](#event-3166970368)

[![@GirlElecta](https://avatars.githubusercontent.com/u/61733998?s=40&v=4)](/GirlElecta)
[GirlElecta](/GirlElecta)
changed the title
~~out-of-bounds-read in libraw\src\postprocessing\aspect\_ratio.cpp~~
"LibRaw::stretch()" Out-of-bounds read vulnerability
[Jun 15, 2020](#event-3444833487)

[![@samueloph](https://avatars.githubusercontent.com/u/2778482?s=80&u=389037b5d44d9f53ee61280f02b9fd5a94fc624e&v=4)](/samueloph)

Copy link

### **[samueloph](/samueloph)** commented [Aug 24, 2023](#issuecomment-1691758020)

| [CVE-2020-22628](https://github.com/advisories/GHSA-c4mp-wp8f-qrg6 "CVE-2020-22628") was assigned to this.  I didn't have any involvement in the assignment, posting here for reference only. |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FLibRaw%2FLibRaw%2Fissues%2F269)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

3 participants

[![@LibRaw](https://avatars.githubusercontent.com/u/435672?s=52&v=4)](/LibRaw) [![@samueloph](https://avatars.githubusercontent.com/u/2778482?s=52&v=4)](/samueloph) [![@GirlElecta](https://avatars.githubusercontent.com/u/61733998?s=52&v=4)](/GirlElecta)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

