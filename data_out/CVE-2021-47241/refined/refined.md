The provided content relates to a fix for CVE-2021-47241.

**Root cause of vulnerability:**
The vulnerability stems from an incorrect calculation of the message length in the `strset_reply_size` function within the `net/ethtool/strset.c` file. The outer nest for `ETHTOOL_A_STRSET_STRINGSETS` was not being accounted for when calculating the message payload length.

**Weaknesses/vulnerabilities present:**
The primary weakness is a flaw in the calculation of the buffer size required for an ethtool string set response, leading to a potential buffer overflow or warning due to insufficient space. Specifically, the code was missing the size of the attribute `ETHTOOL_A_STRSET_STRINGSETS` when calculating the reply size.

**Impact of exploitation:**
Exploitation could lead to a warning being logged and a kernel splat. The warning message would be similar to "calculated message payload length (684) not sufficient". While not explicitly causing a crash, a kernel splat indicates an error condition that may lead to instability.

**Attack vectors:**
The vulnerability is triggered when sending an `ETHTOOL_MSG_STRSET_GET` request to ethtool.

**Required attacker capabilities/position:**
An attacker needs the ability to send netlink messages to the kernel, specifically utilizing the `ETHTOOL_MSG_STRSET_GET` command. The attacker also needs to satisfy three specific conditions for the warning to trigger: 
1. There must be no skb size rounding up.
2. The string set must be per-device.
3. The device name must be at least 12 characters long.

The fix introduces the following line to account for the missing size:
```c
len += nla_total_size(0); /* ETHTOOL_A_STRSET_STRINGSETS */
```