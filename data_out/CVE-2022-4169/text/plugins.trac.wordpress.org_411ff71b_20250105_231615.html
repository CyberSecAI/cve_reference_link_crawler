

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%3Fnew%3D2814605%2540theme-translation-for-polylang%252Ftrunk%26old%3D2812254%2540theme-translation-for-polylang%252Ftrunk)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* [Reverse Diff](/changeset/2812254/theme-translation-for-polylang/trunk?old=2814605&old_path=%2Ftheme-translation-for-polylang%2Ftrunk)

---

# Changes in [theme-translation-for-polylang/trunk](/browser/theme-translation-for-polylang/trunk?rev=2814605 "Show entry in browser") [[2812254:2814605]](/log/theme-translation-for-polylang/trunk?rev=2814605&stop_rev=2812254 "Show revision log")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Location:
[theme-translation-for-polylang/trunk](/browser/theme-translation-for-polylang/trunk?rev=2814605)
Files:

3 edited

* [polylang-theme-translation.php](/browser/theme-translation-for-polylang/trunk/polylang-theme-translation.php?rev=2814605 "Show entry in browser")
  (modified)
  ([1 diff](#file0 "Show differences"))
* [readme.txt](/browser/theme-translation-for-polylang/trunk/readme.txt?rev=2814605 "Show entry in browser")
  (modified)
  ([2 diffs](#file1 "Show differences"))
* [theme-translation-for-polylang.php](/browser/theme-translation-for-polylang/trunk/theme-translation-for-polylang.php?rev=2814605 "Show entry in browser")
  (modified)
  ([1 diff](#file2 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [theme-translation-for-polylang/trunk/polylang-theme-translation.php](/changeset/2814605/theme-translation-for-polylang/trunk/polylang-theme-translation.php?old=2812254&old_path=theme-translation-for-polylang%2Ftrunk%2Fpolylang-theme-translation.php "Show the [2812254:2814605] differences restricted to theme-translation-for-polylang/trunk/polylang-theme-translation.php")

  | [r2812254](/browser/theme-translation-for-polylang/trunk/polylang-theme-translation.php?rev=2812254#L2 "Show revision 2812254 of this file in browser") | [r2814605](/browser/theme-translation-for-polylang/trunk/polylang-theme-translation.php?rev=2814605#L2 "Show revision 2814605 of this file in browser") |  |
  | --- | --- | --- |
  | 2 | 2 | /\* Plugin Name: Theme and plugin translation for Polylang (TTfP) |
  | 3 | 3 | Description: Polylang - theme and plugin translation for WordPress |
  | 4 |  | Version: 3.2.1~~6~~ |
  |  | 4 | Version: 3.2.17 |
  | 5 | 5 | Author: Marcin Kazmierski |
  | 6 | 6 | License: GPL2 |
* ## [theme-translation-for-polylang/trunk/readme.txt](/changeset/2814605/theme-translation-for-polylang/trunk/readme.txt?old=2812254&old_path=theme-translation-for-polylang%2Ftrunk%2Freadme.txt "Show the [2812254:2814605] differences restricted to theme-translation-for-polylang/trunk/readme.txt")

  | [r2812254](/browser/theme-translation-for-polylang/trunk/readme.txt?rev=2812254#L5 "Show revision 2812254 of this file in browser") | [r2814605](/browser/theme-translation-for-polylang/trunk/readme.txt?rev=2814605#L5 "Show revision 2814605 of this file in browser") |  |
  | --- | --- | --- |
  | 5 | 5 | Tested up to: 6.1 |
  | 6 | 6 | Requires PHP: 5.6 |
  | 7 |  | Stable tag: 3.2.1~~6~~ |
  |  | 7 | Stable tag: 3.2.17 |
  | 8 | 8 | License: GPL2 |
  | 9 | 9 |  |
  | […](/browser/theme-translation-for-polylang/trunk/readme.txt?rev=2812254#L159) | […](/browser/theme-translation-for-polylang/trunk/readme.txt?rev=2814605#L159) |  |
  | 159 | 159 | == Changelog == |
  | 160 | 160 |  |
  | 161 |  | = 3.2.16 - 2022/10/04 = |
  |  | 161 | = 3.2.17 - 2022/11/08 = |
  |  | 162 |  |
  |  | 163 | \* Security fix. |
  |  | 164 |  |
  |  | 165 | = 3.2.16 - 2022/11/04 = |
  | 162 | 166 |  |
  | 163 | 167 | \* Fixed gettext filter. |
  | 164 | 168 |  |
  | 165 |  | = 3.2.15 - 2022/1~~0~~/04 = |
  |  | 169 | = 3.2.15 - 2022/11/04 = |
  | 166 | 170 |  |
  | 167 | 171 | \* Fixed gettext filter. |
  | 168 | 172 |  |
  | 169 |  | = 3.2.14 - 2022/1~~0~~/03 = |
  |  | 173 | = 3.2.14 - 2022/11/03 = |
  | 170 | 174 |  |
  | 171 | 175 | \* Fixed gettext filter. |
* ## [theme-translation-for-polylang/trunk/theme-translation-for-polylang.php](/changeset/2814605/theme-translation-for-polylang/trunk/theme-translation-for-polylang.php?old=2812254&old_path=theme-translation-for-polylang%2Ftrunk%2Ftheme-translation-for-polylang.php "Show the [2812254:2814605] differences restricted to theme-translation-for-polylang/trunk/theme-translation-for-polylang.php")

  | [r2812254](/browser/theme-translation-for-polylang/trunk/theme-translation-for-polylang.php?rev=2812254#L211 "Show revision 2812254 of this file in browser") | [r2814605](/browser/theme-translation-for-polylang/trunk/theme-translation-for-polylang.php?rev=2814605#L211 "Show revision 2814605 of this file in browser") |  |
  | --- | --- | --- |
  | 211 | 211 | function process\_polylang\_theme\_translation\_wp\_loaded() |
  | 212 | 212 | { |
  | 213 |  | if (isset($\_POST) && isset($\_POST['export\_strings']) && (int)$\_POST['export\_strings'] === 1 && current\_user\_can('manage\_options')) { |
  | 214 |  | $translation = new Polylang\_Theme\_Translation(); |
  | 215 |  | $exporter = new Polylang\_TT\_exporter($translation); |
  | 216 |  | $exporter->export(); |
  | 217 |  | } |
  | 218 |  |  |
  | 219 |  | if (isset($\_POST["action\_import\_strings"])) { |
  | 220 |  | if (PLL() instanceof PLL\_Settings) { |
  | 221 |  | $fileName = $\_FILES["import\_strings"]["tmp\_name"]; |
  | 222 |  | if ($\_FILES["import\_strings"]["size"] > 0 && $fileName) { |
  | 223 |  | $importer = new Polylang\_TT\_importer(); |
  | 224 |  | $counter = $importer->import($fileName); |
  | 225 |  |  |
  | 226 |  | wp\_redirect((add\_query\_arg(['\_msg' => 'translations-imported', 'items' => $counter], wp\_get\_referer()))); |
  | 227 |  | exit; |
  | 228 |  | } |
  | 229 |  | } |
  | 230 |  | wp\_redirect((add\_query\_arg('\_msg', 'translations-import-error', wp\_get\_referer()))); |
  | 231 |  | exit; |
  | 232 |  | } |
  | 233 |  |  |
  | 234 |  |  |
  | 235 |  | if (isset($\_POST['action\_settings'])) { |
  | 236 |  | $settings = [ |
  | 237 |  | 'themes' => [], |
  | 238 |  | 'plugins' => [], |
  | 239 |  | ]; |
  | 240 |  | $t = isset($\_POST['themes']) ? $\_POST['themes'] : []; |
  | 241 |  | foreach ($t as $item) { |
  | 242 |  | if (in\_array($item, pll\_get\_themes())) { |
  | 243 |  | $settings['themes'][] = $item; |
  | 244 |  | } |
  | 245 |  | } |
  | 246 |  |  |
  | 247 |  | $t = isset($\_POST['plugins']) ? $\_POST['plugins'] : []; |
  | 248 |  | foreach ($t as $item) { |
  | 249 |  | if (in\_array($item, pll\_get\_plugins())) { |
  | 250 |  | $settings['plugins'][] = $item; |
  | 251 |  | } |
  | 252 |  | } |
  | 253 |  |  |
  | 254 |  | if (!add\_option(Polylang\_Theme\_Translation::SETTINGS\_OPTION, $settings)) { |
  | 255 |  | update\_option(Polylang\_Theme\_Translation::SETTINGS\_OPTION, $settings); |
  | 256 |  | } |
  | 257 |  |  |
  | 258 |  | wp\_redirect((add\_query\_arg(['\_msg' => 'settings-saved'], wp\_get\_referer()))); |
  | 259 |  | exit; |
  | 260 |  | } |
  | 261 |  |  |
  |  | 213 | global $pagenow; |
  |  | 214 |  |
  |  | 215 | if (current\_user\_can('manage\_options') && $pagenow === 'admin.php') { |
  |  | 216 | if (isset($\_POST) && isset($\_POST['export\_strings']) && (int)$\_POST['export\_strings'] === 1) { |
  |  | 217 | $translation = new Polylang\_Theme\_Translation(); |
  |  | 218 | $exporter = new Polylang\_TT\_exporter($translation); |
  |  | 219 | $exporter->export(); |
  |  | 220 | } |
  |  | 221 |  |
  |  | 222 | if (isset($\_POST["action\_import\_strings"])) { |
  |  | 223 | if (PLL() instanceof PLL\_Settings) { |
  |  | 224 | $fileName = $\_FILES["import\_strings"]["tmp\_name"]; |
  |  | 225 | if ($\_FILES["import\_strings"]["size"] > 0 && $fileName) { |
  |  | 226 | $importer = new Polylang\_TT\_importer(); |
  |  | 227 | $counter = $importer->import($fileName); |
  |  | 228 |  |
  |  | 229 | wp\_redirect((add\_query\_arg(['\_msg' => 'translations-imported', 'items' => $counter], wp\_get\_referer()))); |
  |  | 230 | exit; |
  |  | 231 | } |
  |  | 232 | } |
  |  | 233 | wp\_redirect((add\_query\_arg('\_msg', 'translations-import-error', wp\_get\_referer()))); |
  |  | 234 | exit; |
  |  | 235 | } |
  |  | 236 |  |
  |  | 237 |  |
  |  | 238 | if (isset($\_POST['action\_settings'])) { |
  |  | 239 | $settings = [ |
  |  | 240 | 'themes' => [], |
  |  | 241 | 'plugins' => [], |
  |  | 242 | ]; |
  |  | 243 | $t = isset($\_POST['themes']) ? $\_POST['themes'] : []; |
  |  | 244 | foreach ($t as $item) { |
  |  | 245 | if (in\_array($item, pll\_get\_themes())) { |
  |  | 246 | $settings['themes'][] = $item; |
  |  | 247 | } |
  |  | 248 | } |
  |  | 249 |  |
  |  | 250 | $t = isset($\_POST['plugins']) ? $\_POST['plugins'] : []; |
  |  | 251 | foreach ($t as $item) { |
  |  | 252 | if (in\_array($item, pll\_get\_plugins())) { |
  |  | 253 | $settings['plugins'][] = $item; |
  |  | 254 | } |
  |  | 255 | } |
  |  | 256 |  |
  |  | 257 | if (!add\_option(Polylang\_Theme\_Translation::SETTINGS\_OPTION, $settings)) { |
  |  | 258 | update\_option(Polylang\_Theme\_Translation::SETTINGS\_OPTION, $settings); |
  |  | 259 | } |
  |  | 260 |  |
  |  | 261 | wp\_redirect((add\_query\_arg(['\_msg' => 'settings-saved'], wp\_get\_referer()))); |
  |  | 262 | exit; |
  |  | 263 | } |
  |  | 264 | } |
  | 262 | 265 | } |
  | 263 | 266 |  |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=2814605&old=2812254&new_path=%2Ftheme-translation-for-polylang%2Ftrunk&old_path=%2Ftheme-translation-for-polylang%2Ftrunk)
* [Zip Archive](?format=zip&new=2814605&old=2812254&new_path=%2Ftheme-translation-for-polylang%2Ftrunk&old_path=%2Ftheme-translation-for-polylang%2Ftrunk)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

