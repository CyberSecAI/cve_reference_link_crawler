
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fchipsalliance%2Frocket-chip%2Fpull%2F2950)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fchipsalliance%2Frocket-chip%2Fpull%2F2950)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=chipsalliance%2Frocket-chip)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[chipsalliance](/chipsalliance)
/
**[rocket-chip](/chipsalliance/rocket-chip)**
Public

* [Notifications](/login?return_to=%2Fchipsalliance%2Frocket-chip) You must be signed in to change notification settings
* [Fork
  1.1k](/login?return_to=%2Fchipsalliance%2Frocket-chip)
* [Star
   3.3k](/login?return_to=%2Fchipsalliance%2Frocket-chip)

* [Code](/chipsalliance/rocket-chip)
* [Issues
  232](/chipsalliance/rocket-chip/issues)
* [Pull requests
  65](/chipsalliance/rocket-chip/pulls)
* [Discussions](/chipsalliance/rocket-chip/discussions)
* [Actions](/chipsalliance/rocket-chip/actions)
* [Projects
  0](/chipsalliance/rocket-chip/projects)
* [Wiki](/chipsalliance/rocket-chip/wiki)
* [Security](/chipsalliance/rocket-chip/security)
* [Insights](/chipsalliance/rocket-chip/pulse)

Additional navigation options

* [Code](/chipsalliance/rocket-chip)
* [Issues](/chipsalliance/rocket-chip/issues)
* [Pull requests](/chipsalliance/rocket-chip/pulls)
* [Discussions](/chipsalliance/rocket-chip/discussions)
* [Actions](/chipsalliance/rocket-chip/actions)
* [Projects](/chipsalliance/rocket-chip/projects)
* [Wiki](/chipsalliance/rocket-chip/wiki)
* [Security](/chipsalliance/rocket-chip/security)
* [Insights](/chipsalliance/rocket-chip/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fchipsalliance%2Frocket-chip%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fchipsalliance%2Frocket-chip%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Zk(Zbk, Zkn, Zks)/Zb: Scalar Cryptography/Bitmanip Extension #2950

 Merged

[jerryz123](/jerryz123)
merged 104 commits into
[chipsalliance:master](/chipsalliance/rocket-chip/tree/master "chipsalliance/rocket-chip:master")
from
[OpenRigil:Zk-chisel](/OpenRigil/rocket-chip/tree/Zk-chisel "OpenRigil/rocket-chip:Zk-chisel")

Jan 18, 2023

 Merged

# [Zk(Zbk, Zkn, Zks)/Zb: Scalar Cryptography/Bitmanip Extension](#top) #2950

[jerryz123](/jerryz123)
merged 104 commits into
[chipsalliance:master](/chipsalliance/rocket-chip/tree/master "chipsalliance/rocket-chip:master")
from
[OpenRigil:Zk-chisel](/OpenRigil/rocket-chip/tree/Zk-chisel "OpenRigil/rocket-chip:Zk-chisel")

Jan 18, 2023

[Conversation
127](/chipsalliance/rocket-chip/pull/2950)
[Commits
104](/chipsalliance/rocket-chip/pull/2950/commits)
[Checks
0](/chipsalliance/rocket-chip/pull/2950/checks)
[Files changed](/chipsalliance/rocket-chip/pull/2950/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![ZenithalHourlyRate](https://avatars.githubusercontent.com/u/19512674?s=60&v=4)](/ZenithalHourlyRate)

Copy link

Contributor

### @ZenithalHourlyRate **[ZenithalHourlyRate](/ZenithalHourlyRate)** commented [Mar 19, 2022](#issue-1174292462)

**Related PR**: [#2906](https://github.com/chipsalliance/rocket-chip/pull/2906)

**Type of change**: other enhancement

**Impact**: API addition (no impact on existing code)

**Development Phase**: implementation (needs cleanup)

**Note**

This has borrowed a lot of code (mainly decode logic) from [#2906](https://github.com/chipsalliance/rocket-chip/pull/2906). The decode logic has been rebased on the master due to the merging of H extension.

Some of the logics are also inspired by [#2906](https://github.com/chipsalliance/rocket-chip/pull/2906), thanks!

While [#2906](https://github.com/chipsalliance/rocket-chip/pull/2906) has different implementations for rv32 and rv64, this PR merges them together.

As for Zkr, as [#2906](https://github.com/chipsalliance/rocket-chip/pull/2906) is just a stub, I think a Chisel stub is fairly easy to implement. In the meantime, the CSR logics should be PRed by the owner of [#2906](https://github.com/chipsalliance/rocket-chip/pull/2906) instead of me. Maybe users can just cherry-pick that commit and implement their own Zkr?

There are some notes on Zkt (like ROM optimization), but it is not verified. As this is a single-cycle implementation, Zkt ought to be satisfied (not verified though).

A lot of helpers are temply embedded here, and should be cleaned up. barrel.rightRotate is borrowed from [here](https://github.com/sequencer/arithmetic/tree/master/arithmetic/src/utils/shifter)

This has passed riscv-arch-test on [rv64i\_m/K](https://github.com/riscv-non-isa/riscv-arch-test/tree/master/riscv-test-suite/rv64i_m/K) and [rv32i\_m/K](https://github.com/riscv-non-isa/riscv-arch-test/tree/master/riscv-test-suite/rv32i_m/K) when verilated to an emulator

Cc [@sequencer](https://github.com/sequencer) [@phthinh](https://github.com/phthinh) [@ben-marshall](https://github.com/ben-marshall)

Also thanks [@liweiwei90](https://github.com/liweiwei90) for his help on riscv-arch-test

**TODO**

1. Clean up of the code on mergeing common datapaths and bad handling of some logics (like multiple levels of Mux of io.out)
2. Clean up of some helpers (e.g. move them into zk/utils.scala) / get helpers upstreamed to Chisel
3. Add CI tests on Zk for rocket-chip (How?)
4. Test against FPGA

**Discussion**

1. Should we merge zbk into ALU as they share some logics (like `~io.rs2` and logical operation gates for andn/orn/xnor)
2. Should we embed SBox as ROM here or just write real-time computing logics, as [Zk: Scalar Cryptography Extension #2906](https://github.com/chipsalliance/rocket-chip/pull/2906) and [Xiangshan](https://github.com/OpenXiangShan/XiangShan/blob/master/src/main/scala/xiangshan/backend/fu/Bku.scala) have done

**Release Notes**

This pull request is to add the hardware implementation to support the Zbk, Zkn, Zks of the cryptographic extensions Zk on the Rocket-chip. This supports the Scalar Instructions specified in the v1.0.1 version. The implementation can work with 32-bit and 64-bit Architectures. The plug-in supports can be enabled by using the WithZBK, WithZKN, WithZKS configuration options.

Sorry, something went wrong.

All reactions

 [phthinh](/phthinh)
and others
added 30 commits
[March 15, 2022 16:53](#commits-pushed-ee289d4)

[![@phthinh](https://avatars.githubusercontent.com/u/617447?s=40&v=4)](/phthinh) [![@ZenithalHourlyRate](https://avatars.githubusercontent.com/u/19512674?s=40&v=4)](/ZenithalHourlyRate)

`[add the Zbk extension for Bitmanip instructions supporting cryptography](/chipsalliance/rocket-chip/pull/2950/commits/ee289d44ed21b193ffd53968eef96b30df12195f "add the Zbk extension for Bitmanip instructions supporting cryptography

fix decode due to the add of H extension commit

Related to 185cac830746df9a22465e3267e6d47e01567bc3")`
 …

`[ee289d4](/chipsalliance/rocket-chip/pull/2950/commits/ee289d44ed21b193ffd53968eef96b30df12195f)`

```
fix decode due to the add of H extension commit

Related to [185cac8](https://github.com/OpenRigil/rocket-chip/commit/185cac830746df9a22465e3267e6d47e01567bc3)
```

[![@ZenithalHourlyRate](https://avatars.githubusercontent.com/u/19512674?s=40&v=4)](/ZenithalHourlyRate)

`[Zbk: implement rotate](/chipsalliance/rocket-chip/pull/2950/commits/5932acb74c3fd220cfe2599af786131db9ae565a "Zbk: implement rotate")`

`[5932acb](/chipsalliance/rocket-chip/pull/2950/commits/5932acb74c3fd220cfe2599af786131db9ae565a)`

[![@ZenithalHourlyRate](https://avatars.githubusercontent.com/u/19512674?s=40&v=4)](/ZenithalHourlyRate)

`[Zbk: implement logic](/chipsalliance/rocket-chip/pull/2950/commits/5f4fcbb09258f45007eecb609d1c7d735e8fd833 "Zbk: implement logic")`

`[5f4fcbb](/chipsalliance/rocket-chip/pull/2950/commits/5f4fcbb09258f45007eecb609d1c7d735e8fd833)`

[![@ZenithalHourlyRate](https://avatars.githubusercontent.com/u/19512674?s=40&v=4)](/ZenithalHourlyRate)

`[Zbk: implement pack](/chipsalliance/rocket-chip/pull/2950/commits/da9d6b82424612ad07c9c67715657949ace5e686 "Zbk: implement pack")`

`[da9d6b8](/chipsalliance/rocket-chip/pull/2950/commits/da9d6b82424612ad07c9c67715657949ace5e686)`

[![@ZenithalHourlyRate](https://avatars.githubusercontent.com/u/19512674?s=40&v=4)](/ZenithalHourlyRate)

`[Zbk: implement rev](/chipsalliance/rocket-chip/pull/2950/commits/428f8080fc606e4aed0ad7244cbb4b1b4b892a88 "Zbk: implement rev")`

`[428f808](/chipsalliance/rocket-chip/pull/2950/commits/428f8080fc606e4aed0ad7244cbb4b1b4b892a88)`

[![@ZenithalHourlyRate](https://avatars.githubusercontent.com/u/19512674?s=40&v=4)](/ZenithalHourlyRate)

`[Zbk: implement zip](/chipsalliance/rocket-chip/pull/2950/commits/58dc1b536802c86477b5a250fb3be93fc3ee555f "Zbk: implement zip")`

`[58dc1b5](/chipsalliance/rocket-chip/pull/2950/commits/58dc1b536802c86477b5a250fb3be93fc3ee555f)`

[![@ZenithalHourlyRate](https://avatars.githubusercontent.com/u/19512674?s=40&v=4)](/ZenithalHourlyRate)

`[Zbk: implement xperm](/chipsalliance/rocket-chip/pull/2950/commits/a786f231966b4a1fc1d0cee3893fcf9a1077083c "Zbk: implement xperm")`

`[a786f23](/chipsalliance/rocket-chip/pull/2950/commits/a786f231966b4a1fc1d0cee3893fcf9a1077083c)`

[![@ZenithalHourlyRate](https://avatars.githubusercontent.com/u/19512674?s=40&v=4)](/ZenithalHourlyRate)

`[Zbk: xperm cheaper impl](/chipsalliance/rocket-chip/pull/2950/commits/2eefbe0cbd18edd8a8bde2d6bb96a95b72b9ab9b "Zbk: xperm cheaper impl")`

`[2eefbe0](/chipsalliance/rocket-chip/pull/2950/commits/2eefbe0cbd18edd8a8bde2d6bb96a95b72b9ab9b)`

[![@phthinh](https://avatars.githubusercontent.com/u/617447?s=40&v=4)](/phthinh) [![@ZenithalHourlyRate](https://avatars.githubusercontent.com/u/19512674?s=40&v=4)](/ZenithalHourlyRate)

`[Zbk: add zbkc decode](/chipsalliance/rocket-chip/pull/2950/commits/386e5e99b6009ca4725c09f891e5c8884a9e2769 "Zbk: add zbkc decode")`

`[386e5e9](/chipsalliance/rocket-chip/pull/2950/commits/386e5e99b6009ca4725c09f891e5c8884a9e2769)`

[![@ZenithalHourlyRate](https://avatars.githubusercontent.com/u/19512674?s=40&v=4)](/ZenithalHourlyRate)

`[Zbk: implement clmul](/chipsalliance/rocket-chip/pull/2950/commits/c5e0bd1bcf373fe99579975661d673d0a4160913 "Zbk: implement clmul")`

`[c5e0bd1](/chipsalliance/rocket-chip/pull/2950/commits/c5e0bd1bcf373fe99579975661d673d0a4160913)`

[![@ZenithalHourlyRate](https://avatars.githubusercontent.com/u/19512674?s=40&v=4)](/ZenithalHourlyRate)

`[Zbk: implement out mux](/chipsalliance/rocket-chip/pull/2950/commits/af97f3a18028b351cc65361fa64a063544fe3150 "Zbk: implement out mux")`

`[af97f3a](/chipsalliance/rocket-chip/pull/2950/commits/af97f3a18028b351cc65361fa64a063544fe3150)`

[![@ZenithalHourlyRate](https://avatars.githubusercontent.com/u/19512674?s=40&v=4)](/ZenithalHourlyRate)

`[Zbk: clmul: fix off by one](/chipsalliance/rocket-chip/pull/2950/commits/0b46e1db18e6473ae6171fe8e6f5eb38343f2892 "Zbk: clmul: fix off by one")`

`[0b46e1d](/chipsalliance/rocket-chip/pull/2950/commits/0b46e1db18e6473ae6171fe8e6f5eb38343f2892)`

[![@ZenithalHourlyRate](https://avatars.githubusercontent.com/u/19512674?s=40&v=4)](/ZenithalHourlyRate)

`[zbk: fix compile](/chipsalliance/rocket-chip/pull/2950/commits/380bb42a4c4702211024759b93678cf619779c2f "zbk: fix compile")`

`[380bb42](/chipsalliance/rocket-chip/pull/2950/commits/380bb42a4c4702211024759b93678cf619779c2f)`

[![@phthinh](https://avatars.githubusercontent.com/u/617447?s=40&v=4)](/phthinh) [![@ZenithalHourlyRate](https://avatars.githubusercontent.com/u/19512674?s=40&v=4)](/ZenithalHourlyRate)

`[Zbk: update instruction decode for Zbk](/chipsalliance/rocket-chip/pull/2950/commits/a3ba274e200619afedf8390b5f29adbb62d8fcdb "Zbk: update instruction decode for Zbk")`

`[a3ba274](/chipsalliance/rocket-chip/pull/2950/commits/a3ba274e200619afedf8390b5f29adbb62d8fcdb)`

[![@ZenithalHourlyRate](https://avatars.githubusercontent.com/u/19512674?s=40&v=4)](/ZenithalHourlyRate)

`[bk: fix config](/chipsalliance/rocket-chip/pull/2950/commits/009f0ed56a434071e07d9a76482e635bf5266622 "bk: fix config

Cherry-pick part of (54a6cdd9a6f7)
Zbk: add the Zbk implementation for RV64")`
 …

`[009f0ed](/chipsalliance/rocket-chip/pull/2950/commits/009f0ed56a434071e07d9a76482e635bf5266622)`

```
Cherry-pick part of ([54a6cdd](https://github.com/OpenRigil/rocket-chip/commit/54a6cdd9a6f71eaf965fee18cc20743bbe1ae4e5))
Zbk: add the Zbk implementation for RV64
```

[![@phthinh](https://avatars.githubusercontent.com/u/617447?s=40&v=4)](/phthinh) [![@ZenithalHourlyRate](https://avatars.githubusercontent.com/u/19512674?s=40&v=4)](/ZenithalHourlyRate)

`[Zbk: a small correction](/chipsalliance/rocket-chip/pull/2950/commits/35f02e11d504e7c5701689ee976814d1b54bfb62 "Zbk: a small correction")`

`[35f02e1](/chipsalliance/rocket-chip/pull/2950/commits/35f02e11d504e7c5701689ee976814d1b54bfb62)`

[![@phthinh](https://avatars.githubusercontent.com/u/617447?s=40&v=4)](/phthinh) [![@ZenithalHourlyRate](https://avatars.githubusercontent.com/u/19512674?s=40&v=4)](/ZenithalHourlyRate)

`[decode: add the support for the Zkn extension](/chipsalliance/rocket-chip/pull/2950/commits/c3278636d0c801970274e4cc295d9e27bf93ba7f "decode: add the support for the Zkn extension

Merge conflicts with (185cac830746df9a2)
Add hypervisor extension (#2841)")`
 …

`[c327863](/chipsalliance/rocket-chip/pull/2950/commits/c3278636d0c801970274e4cc295d9e27bf93ba7f)`

```
Merge conflicts with ([185cac8](https://github.com/OpenRigil/rocket-chip/commit/185cac830746df9a22465e3267e6d47e01567bc3))
Add hypervisor extension ([chipsalliance#2841](https://github.com/chipsalliance/rocket-chip/pull/2841))
```

[![@ZenithalHourlyRate](https://avatars.githubusercontent.com/u/19512674?s=40&v=4)](/ZenithalHourlyRate)

`[Use asBytes/asNibbles helper](/chipsalliance/rocket-chip/pull/2950/commits/f431ffd243394c8a331bfb3829d74ad47f18bbf8 "Use asBytes/asNibbles helper")`

`[f431ffd](/chipsalliance/rocket-chip/pull/2950/commits/f431ffd243394c8a331bfb3829d74ad47f18bbf8)`

[![@ZenithalHourlyRate](https://avatars.githubusercontent.com/u/19512674?s=40&v=4)](/ZenithalHourlyRate)

`[zkn: implement aes enc/dec](/chipsalliance/rocket-chip/pull/2950/commits/7ae146a64831b9102306b09b63a793c2d9f514d9 "zkn: implement aes enc/dec")`

`[7ae146a](/chipsalliance/rocket-chip/pull/2950/commits/7ae146a64831b9102306b09b63a793c2d9f514d9)`

[![@ZenithalHourlyRate](https://avatars.githubusercontent.com/u/19512674?s=40&v=4)](/ZenithalHourlyRate)

`[zkn: implement aes ks](/chipsalliance/rocket-chip/pull/2950/commits/e2c81850a9a1d131883b7dae6a11de05eef8c84b "zkn: implement aes ks")`

`[e2c8185](/chipsalliance/rocket-chip/pull/2950/commits/e2c81850a9a1d131883b7dae6a11de05eef8c84b)`

[![@ZenithalHourlyRate](https://avatars.githubusercontent.com/u/19512674?s=40&v=4)](/ZenithalHourlyRate)

`[zkn: aes ks1 reuse sbox in enc](/chipsalliance/rocket-chip/pull/2950/commits/2faae3f74685e8b8ab70b5d8d9ac9a6db21f0a4e "zkn: aes ks1 reuse sbox in enc")`

`[2faae3f](/chipsalliance/rocket-chip/pull/2950/commits/2faae3f74685e8b8ab70b5d8d9ac9a6db21f0a4e)`

[![@ZenithalHourlyRate](https://avatars.githubusercontent.com/u/19512674?s=40&v=4)](/ZenithalHourlyRate)

`[zkn: implement sha](/chipsalliance/rocket-chip/pull/2950/commits/265d4ee536b6c72a89498edd68ba5e2ae062c42b "zkn: implement sha")`

`[265d4ee](/chipsalliance/rocket-chip/pull/2950/commits/265d4ee536b6c72a89498edd68ba5e2ae062c42b)`

[![@phthinh](https://avatars.githubusercontent.com/u/617447?s=40&v=4)](/phthinh) [![@ZenithalHourlyRate](https://avatars.githubusercontent.com/u/19512674?s=40&v=4)](/ZenithalHourlyRate)

`[ZK: add the support for the Zks extension.](/chipsalliance/rocket-chip/pull/2950/commits/36350c90a2148183b803346f09d7581e2b2df913 "ZK: add the support for the Zks extension.")`

`[36350c9](/chipsalliance/rocket-chip/pull/2950/commits/36350c90a2148183b803346f09d7581e2b2df913)`

[![@ZenithalHourlyRate](https://avatars.githubusercontent.com/u/19512674?s=40&v=4)](/ZenithalHourlyRate)

`[zks: implement sm3/4](/chipsalliance/rocket-chip/pull/2950/commits/0ce3f74049b89d39067974096a7eb1ccc4c4d52b "zks: implement sm3/4")`

`[0ce3f74](/chipsalliance/rocket-chip/pull/2950/commits/0ce3f74049b89d39067974096a7eb1ccc4c4d52b)`

[![@ZenithalHourlyRate](https://avatars.githubusercontent.com/u/19512674?s=40&v=4)](/ZenithalHourlyRate)

`[zkn, zks: implement out mux](/chipsalliance/rocket-chip/pull/2950/commits/d26e56199ed6ca8ad8e14e8364d7a40e396b1805 "zkn, zks: implement out mux")`

`[d26e561](/chipsalliance/rocket-chip/pull/2950/commits/d26e56199ed6ca8ad8e14e8364d7a40e396b1805)`

[![@ZenithalHourlyRate](https://avatars.githubusercontent.com/u/19512674?s=40&v=4)](/ZenithalHourlyRate)

`[zk: fix compile](/chipsalliance/rocket-chip/pull/2950/commits/76db33a7922b009464137aa6ae5bd15f43f6c142 "zk: fix compile")`

`[76db33a](/chipsalliance/rocket-chip/pull/2950/commits/76db33a7922b009464137aa6ae5bd15f43f6c142)`

[![@ZenithalHourlyRate](https://avatars.githubusercontent.com/u/19512674?s=40&v=4)](/ZenithalHourlyRate)

`[zbk: fix packw/xperm](/chipsalliance/rocket-chip/pull/2950/commits/d4acc70abfa5c0e73b218c0a3f0154b0689cbaf4 "zbk: fix packw/xperm")`

`[d4acc70](/chipsalliance/rocket-chip/pull/2950/commits/d4acc70abfa5c0e73b218c0a3f0154b0689cbaf4)`

[![@ZenithalHourlyRate](https://avatars.githubusercontent.com/u/19512674?s=40&v=4)](/ZenithalHourlyRate)

`[zkn: fix aes64ks1m due to not merged datapath](/chipsalliance/rocket-chip/pull/2950/commits/7631b8ae2682f9ab4275d2d5f11c703a4afa00ae "zkn: fix aes64ks1m due to not merged datapath")`

`[7631b8a](/chipsalliance/rocket-chip/pull/2950/commits/7631b8ae2682f9ab4275d2d5f11c703a4afa00ae)`

[![@ZenithalHourlyRate](https://avatars.githubusercontent.com/u/19512674?s=40&v=4)](/ZenithalHourlyRate)

`[zks: sm4: fix UInt length after left shift](/chipsalliance/rocket-chip/pull/2950/commits/8240daf3a34b52fe59afa1a2e1c21b222b0df86d "zks: sm4: fix UInt length after left shift")`

`[8240daf](/chipsalliance/rocket-chip/pull/2950/commits/8240daf3a34b52fe59afa1a2e1c21b222b0df86d)`

[![@ZenithalHourlyRate](https://avatars.githubusercontent.com/u/19512674?s=40&v=4)](/ZenithalHourlyRate)

`[zkn, zks: aes32, sm4 fix leftRotate to rightRotate](/chipsalliance/rocket-chip/pull/2950/commits/38728ef3e57ee226caf444d95fd745935b639c4d "zkn, zks: aes32, sm4 fix leftRotate to rightRotate")`

`[38728ef](/chipsalliance/rocket-chip/pull/2950/commits/38728ef3e57ee226caf444d95fd745935b639c4d)`

110 hidden items

Load more…

[![jerryz123](https://avatars.githubusercontent.com/u/14086183?s=60&v=4)](/jerryz123)

**[jerryz123](/jerryz123)**
reviewed
[Jan 14, 2023](#pullrequestreview-1248957914)

 [View reviewed changes](/chipsalliance/rocket-chip/pull/2950/files/922955632e10c3ce56a5b936a14b9fcf4c0c5564)

[src/main/scala/rocket/ALU.scala](/chipsalliance/rocket-chip/pull/2950/files/922955632e10c3ce56a5b936a14b9fcf4c0c5564#diff-6f6ac597e4720283dd74eabcc5590fe6a69a0731bfc6fe59e61841dc1ed25545)
Outdated

Show resolved

Hide resolved

[![jerryz123](https://avatars.githubusercontent.com/u/14086183?s=60&v=4)](/jerryz123)

**[jerryz123](/jerryz123)**
reviewed
[Jan 14, 2023](#pullrequestreview-1248958153)

 [View reviewed changes](/chipsalliance/rocket-chip/pull/2950/files/922955632e10c3ce56a5b936a14b9fcf4c0c5564)

[src/main/scala/rocket/ABLU.scala](/chipsalliance/rocket-chip/pull/2950/files/922955632e10c3ce56a5b936a14b9fcf4c0c5564#diff-4fa6e75479ec527e37b957083c7a0d9ca90aa639dbbf2aaf0b3959d14a88576c)
Outdated

Show resolved

Hide resolved

[![jerryz123](https://avatars.githubusercontent.com/u/14086183?s=60&v=4)](/jerryz123)

**[jerryz123](/jerryz123)**
reviewed
[Jan 14, 2023](#pullrequestreview-1248962909)

 [View reviewed changes](/chipsalliance/rocket-chip/pull/2950/files/922955632e10c3ce56a5b936a14b9fcf4c0c5564)

[src/main/scala/rocket/CSR.scala](/chipsalliance/rocket-chip/pull/2950/files/922955632e10c3ce56a5b936a14b9fcf4c0c5564#diff-31a67b34f6b106bdfcc83c5d63ff32e9553378b3cf38a9a2a96806f9cad65cb5)

Show resolved

Hide resolved

[![jerryz123](https://avatars.githubusercontent.com/u/14086183?s=60&v=4)](/jerryz123)

**[jerryz123](/jerryz123)**
reviewed
[Jan 14, 2023](#pullrequestreview-1248963386)

 [View reviewed changes](/chipsalliance/rocket-chip/pull/2950/files/922955632e10c3ce56a5b936a14b9fcf4c0c5564)

[src/main/scala/rocket/Multiplier.scala](/chipsalliance/rocket-chip/pull/2950/files/922955632e10c3ce56a5b936a14b9fcf4c0c5564#diff-f201d09796bde5dfbc2165d928c9685737008d5b5541547c0f576b068baade42)
Outdated

Show resolved

Hide resolved

[![jerryz123](https://avatars.githubusercontent.com/u/14086183?s=60&v=4)](/jerryz123)

**[jerryz123](/jerryz123)**
requested changes
[Jan 14, 2023](#pullrequestreview-1248963938)

 [View reviewed changes](/chipsalliance/rocket-chip/pull/2950/files/922955632e10c3ce56a5b936a14b9fcf4c0c5564)

Copy link

Contributor

### @jerryz123 **[jerryz123](/jerryz123)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I trust the circuit implementations, but there should be some refactors

Sorry, something went wrong.

All reactions

 [ZenithalHourlyRate](/ZenithalHourlyRate)
added 3 commits
[January 15, 2023 02:49](#commits-pushed-beb3a11)

[![@ZenithalHourlyRate](https://avatars.githubusercontent.com/u/19512674?s=40&v=4)](/ZenithalHourlyRate)

`[Add comment on B misa bit](/chipsalliance/rocket-chip/pull/2950/commits/beb3a11f871a82d2aad1c53d01b55a39834492aa "Add comment on B misa bit")`

`[beb3a11](/chipsalliance/rocket-chip/pull/2950/commits/beb3a11f871a82d2aad1c53d01b55a39834492aa)`

[![@ZenithalHourlyRate](https://avatars.githubusercontent.com/u/19512674?s=40&v=4)](/ZenithalHourlyRate)

`[Refactor ALUFN](/chipsalliance/rocket-chip/pull/2950/commits/590fbb5a696d1927bf24301b9d238945c242f7c7 "Refactor ALUFN")`

`[590fbb5](/chipsalliance/rocket-chip/pull/2950/commits/590fbb5a696d1927bf24301b9d238945c242f7c7)`

[![@ZenithalHourlyRate](https://avatars.githubusercontent.com/u/19512674?s=40&v=4)](/ZenithalHourlyRate)

`[Refactor other ctrl signals](/chipsalliance/rocket-chip/pull/2950/commits/879f6c360cad4af8a3dab023076b11e9ea8e6ace "Refactor other ctrl signals")`

`[879f6c3](/chipsalliance/rocket-chip/pull/2950/commits/879f6c360cad4af8a3dab023076b11e9ea8e6ace)`

[![jerryz123](https://avatars.githubusercontent.com/u/14086183?s=60&v=4)](/jerryz123)

**[jerryz123](/jerryz123)**
reviewed
[Jan 15, 2023](#pullrequestreview-1249114852)

 [View reviewed changes](/chipsalliance/rocket-chip/pull/2950/files/879f6c360cad4af8a3dab023076b11e9ea8e6ace)

[src/main/scala/rocket/Multiplier.scala](/chipsalliance/rocket-chip/pull/2950/files/879f6c360cad4af8a3dab023076b11e9ea8e6ace#diff-f201d09796bde5dfbc2165d928c9685737008d5b5541547c0f576b068baade42)
Outdated

Show resolved

Hide resolved

[![@ZenithalHourlyRate](https://avatars.githubusercontent.com/u/19512674?s=40&v=4)](/ZenithalHourlyRate)

`[Pass alufn to Multipler](/chipsalliance/rocket-chip/pull/2950/commits/e5a5edcd989f0559dc8d19e3b51121a54e992145 "Pass alufn to Multipler")`

`[e5a5edc](/chipsalliance/rocket-chip/pull/2950/commits/e5a5edcd989f0559dc8d19e3b51121a54e992145)`

[![jerryz123](https://avatars.githubusercontent.com/u/14086183?s=60&v=4)](/jerryz123)

**[jerryz123](/jerryz123)**
reviewed
[Jan 15, 2023](#pullrequestreview-1249336207)

 [View reviewed changes](/chipsalliance/rocket-chip/pull/2950/files/e5a5edcd989f0559dc8d19e3b51121a54e992145)

[src/main/scala/rocket/ALU.scala](/chipsalliance/rocket-chip/pull/2950/files/e5a5edcd989f0559dc8d19e3b51121a54e992145#diff-6f6ac597e4720283dd74eabcc5590fe6a69a0731bfc6fe59e61841dc1ed25545)
Outdated

Show resolved

Hide resolved

[![@jerryz123](https://avatars.githubusercontent.com/u/14086183?s=80&u=3c2b5dce28dd51ec0ef44c59d5f2cf90fe58c728&v=4)](/jerryz123)

Copy link

Contributor

### **[jerryz123](/jerryz123)** commented [Jan 15, 2023](#issuecomment-1383233975)

| I will clone this branch myself to check some things. |
| --- |

All reactions

Sorry, something went wrong.

 [ZenithalHourlyRate](/ZenithalHourlyRate)
and others
added 5 commits
[January 16, 2023 05:33](#commits-pushed-c04a3a6)

[![@ZenithalHourlyRate](https://avatars.githubusercontent.com/u/19512674?s=40&v=4)](/ZenithalHourlyRate)

`[More default ALUFN](/chipsalliance/rocket-chip/pull/2950/commits/c04a3a64c60cb8166d12f145dbfdb7a66e7c6dad "More default ALUFN")`

`[c04a3a6](/chipsalliance/rocket-chip/pull/2950/commits/c04a3a64c60cb8166d12f145dbfdb7a66e7c6dad)`

[![@jerryz123](https://avatars.githubusercontent.com/u/14086183?s=40&v=4)](/jerryz123)

`[Refactors to ease migration burden](/chipsalliance/rocket-chip/pull/2950/commits/be84dc03a6cbb49a45b6ed6fdb034ac84f8c8f0a "Refactors to ease migration burden")`

`[be84dc0](/chipsalliance/rocket-chip/pull/2950/commits/be84dc03a6cbb49a45b6ed6fdb034ac84f8c8f0a)`

[![@ZenithalHourlyRate](https://avatars.githubusercontent.com/u/19512674?s=40&v=4)](/ZenithalHourlyRate)

`[Merge pull request](/chipsalliance/rocket-chip/pull/2950/commits/57b12592ac6f19f3209eb99727eecfd9945ca3cc "Merge pull request #4 from chipsalliance/Zk-chisel-fixes

Refactors to ease migration burden") [#4](https://github.com/OpenRigil/rocket-chip/pull/4) [from chipsalliance/Zk-chisel-fixes](/chipsalliance/rocket-chip/pull/2950/commits/57b12592ac6f19f3209eb99727eecfd9945ca3cc "Merge pull request #4 from chipsalliance/Zk-chisel-fixes

Refactors to ease migration burden")`
 …

`[57b1259](/chipsalliance/rocket-chip/pull/2950/commits/57b12592ac6f19f3209eb99727eecfd9945ca3cc)`

```
Refactors to ease migration burden
```

[![@ZenithalHourlyRate](https://avatars.githubusercontent.com/u/19512674?s=40&v=4)](/ZenithalHourlyRate)

`[Fix format](/chipsalliance/rocket-chip/pull/2950/commits/bccdd5f5f8b617a2bdeeaeecf73ec5efbbe79600 "Fix format")`

`[bccdd5f](/chipsalliance/rocket-chip/pull/2950/commits/bccdd5f5f8b617a2bdeeaeecf73ec5efbbe79600)`

[![@ZenithalHourlyRate](https://avatars.githubusercontent.com/u/19512674?s=40&v=4)](/ZenithalHourlyRate)

`[Fix int ctrl sigs fn width](/chipsalliance/rocket-chip/pull/2950/commits/6abee570a3435e3ae132da1a4a27668254980644 "Fix int ctrl sigs fn width")`

`[6abee57](/chipsalliance/rocket-chip/pull/2950/commits/6abee570a3435e3ae132da1a4a27668254980644)`

[![jerryz123](https://avatars.githubusercontent.com/u/14086183?s=60&v=4)](/jerryz123)

**[jerryz123](/jerryz123)**
reviewed
[Jan 17, 2023](#pullrequestreview-1252141424)

 [View reviewed changes](/chipsalliance/rocket-chip/pull/2950/files/6abee570a3435e3ae132da1a4a27668254980644)

[src/main/scala/tile/BaseTile.scala](/chipsalliance/rocket-chip/pull/2950/files/6abee570a3435e3ae132da1a4a27668254980644#diff-f44aaa7c41ee7d5c3c298bd47b7ff6d42f0a75c357069153e0910de5c525e015)
Outdated

Show resolved

Hide resolved

[![jerryz123](https://avatars.githubusercontent.com/u/14086183?s=60&v=4)](/jerryz123)

**[jerryz123](/jerryz123)**
reviewed
[Jan 17, 2023](#pullrequestreview-1252141770)

 [View reviewed changes](/chipsalliance/rocket-chip/pull/2950/files/6abee570a3435e3ae132da1a4a27668254980644)

[src/main/scala/tile/BaseTile.scala](/chipsalliance/rocket-chip/pull/2950/files/6abee570a3435e3ae132da1a4a27668254980644#diff-f44aaa7c41ee7d5c3c298bd47b7ff6d42f0a75c357069153e0910de5c525e015)

Show resolved

Hide resolved

[![jerryz123](https://avatars.githubusercontent.com/u/14086183?s=60&v=4)](/jerryz123)

**[jerryz123](/jerryz123)**
reviewed
[Jan 17, 2023](#pullrequestreview-1252142877)

 [View reviewed changes](/chipsalliance/rocket-chip/pull/2950/files/6abee570a3435e3ae132da1a4a27668254980644)

[src/main/scala/tile/Core.scala](/chipsalliance/rocket-chip/pull/2950/files/6abee570a3435e3ae132da1a4a27668254980644#diff-65a21ddf2c5be8f2e43ceff7b8931a7154da8ff7d391e3bb6a78dfdca1f5bebe)

Show resolved

Hide resolved

[![@ZenithalHourlyRate](https://avatars.githubusercontent.com/u/19512674?s=40&v=4)](/ZenithalHourlyRate)

`[Add isa string in bulk](/chipsalliance/rocket-chip/pull/2950/commits/871e13c5adacba2b4b88ddde896f8c72a1a1c97a "Add isa string in bulk")`

`[871e13c](/chipsalliance/rocket-chip/pull/2950/commits/871e13c5adacba2b4b88ddde896f8c72a1a1c97a)`

[![@ZenithalHourlyRate](https://avatars.githubusercontent.com/u/19512674?s=80&u=9c1f4be55cb635fd926213b8d9286b6c4e3205ea&v=4)](/ZenithalHourlyRate)

Copy link

Contributor

Author

### **[ZenithalHourlyRate](/ZenithalHourlyRate)** commented [Jan 18, 2023](#issuecomment-1386376769)

| Should squash&merge for this PR because the history is too long.. |
| --- |

All reactions

Sorry, something went wrong.

[![@jerryz123](https://avatars.githubusercontent.com/u/14086183?s=80&u=3c2b5dce28dd51ec0ef44c59d5f2cf90fe58c728&v=4)](/jerryz123)

Copy link

Contributor

### **[jerryz123](/jerryz123)** commented [Jan 18, 2023](#issuecomment-1386377722)

| Yes we should squash+merge. This PR looks fine for me now. |
| --- |

All reactions

Sorry, something went wrong.

[![@jerryz123](https://avatars.githubusercontent.com/u/14086183?s=80&u=3c2b5dce28dd51ec0ef44c59d5f2cf90fe58c728&v=4)](/jerryz123)

Copy link

Contributor

### **[jerryz123](/jerryz123)** commented [Jan 18, 2023](#issuecomment-1386377965)

| Once CI is done I will squash+merge |
| --- |

All reactions

Sorry, something went wrong.

[![@ZenithalHourlyRate](https://avatars.githubusercontent.com/u/19512674?s=80&u=9c1f4be55cb635fd926213b8d9286b6c4e3205ea&v=4)](/ZenithalHourlyRate)

Copy link

Contributor

Author

### **[ZenithalHourlyRate](/ZenithalHourlyRate)** commented [Jan 18, 2023](#issuecomment-1386500993)

| Once CI is done I will squash+merge  CI passed. |
| --- |

All reactions

Sorry, something went wrong.

[![@jerryz123](https://avatars.githubusercontent.com/u/14086183?s=40&u=3c2b5dce28dd51ec0ef44c59d5f2cf90fe58c728&v=4)](/jerryz123)
[jerryz123](/jerryz123)
enabled auto-merge (squash)
[January 18, 2023 09:16](#event-8253673189)

[![jerryz123](https://avatars.githubusercontent.com/u/14086183?s=60&v=4)](/jerryz123)

**[jerryz123](/jerryz123)**
approved these changes
[Jan 18, 2023](#pullrequestreview-1253095679)

 [View reviewed changes](/chipsalliance/rocket-chip/pull/2950/files/871e13c5adacba2b4b88ddde896f8c72a1a1c97a)

[![@jerryz123](https://avatars.githubusercontent.com/u/14086183?s=40&u=3c2b5dce28dd51ec0ef44c59d5f2cf90fe58c728&v=4)](/jerryz123)
[jerryz123](/jerryz123)
merged commit [`4ecc497`](/chipsalliance/rocket-chip/commit/4ecc497ccb72ff56a3bbeb07244a5545de8770d9)
into
chipsalliance:master

[Jan 18, 2023](https://github.com/chipsalliance/rocket-chip/pull/2950#event-8253675897)

[![@ZenithalHourlyRate](https://avatars.githubusercontent.com/u/19512674?s=40&u=9c1f4be55cb635fd926213b8d9286b6c4e3205ea&v=4)](/ZenithalHourlyRate)
[ZenithalHourlyRate](/ZenithalHourlyRate)
mentioned this pull request
[Feb 8, 2023](#ref-issue-1575975732)

[[Proposal] Adding ZenithalHourlyRate to rocket-chip maintainer
#3244](/chipsalliance/rocket-chip/issues/3244)

Closed

[![@sequencer](https://avatars.githubusercontent.com/u/5791019?s=40&v=4)](/sequencer)
[sequencer](/sequencer)
mentioned this pull request
[Feb 27, 2023](#ref-pullrequest-1600087230)

[Migrate IDecoder to use DecoderTable
#3272](/chipsalliance/rocket-chip/pull/3272)
 Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fchipsalliance%2Frocket-chip%2Fpull%2F2950)

Reviewers

[![@jerryz123](https://avatars.githubusercontent.com/u/14086183?s=40&v=4)](/jerryz123) [jerryz123](/jerryz123)

jerryz123 approved these changes

[![@sequencer](https://avatars.githubusercontent.com/u/5791019?s=40&v=4)](/sequencer) [sequencer](/sequencer)

sequencer approved these changes

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

6 participants

[![@ZenithalHourlyRate](https://avatars.githubusercontent.com/u/19512674?s=52&v=4)](/ZenithalHourlyRate) [![@Phantom1003](https://avatars.githubusercontent.com/u/39120057?s=52&v=4)](/Phantom1003) [![@sequencer](https://avatars.githubusercontent.com/u/5791019?s=52&v=4)](/sequencer) [![@jerryz123](https://avatars.githubusercontent.com/u/14086183?s=52&v=4)](/jerryz123) [![@phthinh](https://avatars.githubusercontent.com/u/617447?s=52&v=4)](/phthinh) [![@cyyself](https://avatars.githubusercontent.com/u/8191303?s=52&v=4)](/cyyself)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

