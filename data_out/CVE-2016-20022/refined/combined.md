=== Content from lore.kernel.org_23674869_20250110_190720.html ===

```
[linux-kernel.vger.kernel.org archive mirror](../?t=20170205201602)
 [help](../_/text/help/) / [color](../_/text/color/) / [mirror](../_/text/mirror/) / [Atom feed](../new.atom)
```
```
From: Willy Tarreau <w@1wt.eu>
To: [linux-kernel@vger.kernel.org](../../lkml/?t=20170205201602), [stable@vger.kernel.org](../../stable/?t=20170205201602), linux@roeck-us.net
Cc: Alan Stern <stern@rowland.harvard.edu>,
	Greg Kroah-Hartman <gregkh@linuxfoundation.org>,
	Willy Tarreau <w@1wt.eu>
Subject: [[PATCH 3.10 107/319] USB: validate wMaxPacketValue entries in endpoint descriptors](#r)
Date: Sun,  5 Feb 2017 20:18:49 +0100	[[thread overview]](#r)
Message-ID: <1486322541-8206-8-git-send-email-w@1wt.eu> (<raw>)
In-Reply-To: <[1486322541-8206-1-git-send-email-w@1wt.eu](../1486322541-8206-1-git-send-email-w%401wt.eu/)>

From: Alan Stern <stern@rowland.harvard.edu>

commit aed9d65ac3278d4febd8665bd7db59ef53e825fe upstream.

Erroneous or malicious endpoint descriptors may have non-zero bits in
reserved positions, or out-of-bounds values.  This patch helps prevent
these from causing problems by bounds-checking the wMaxPacketValue
entries in endpoint descriptors and capping the values at the maximum
allowed.

This issue was first discovered and tests were conducted by Jake Lamberson
<jake.lamberson1@gmail.com>, an intern working for Rosie Hall.

Signed-off-by: Alan Stern <stern@rowland.harvard.edu>
Reported-by: roswest <roswest@cisco.com>
Tested-by: roswest <roswest@cisco.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[wt: adjusted to 3.10 -- no USB_SPEED_SUPER_PLUS]

Signed-off-by: Willy Tarreau <w@1wt.eu>
---
 [drivers/usb/core/config.c](#Z31drivers:usb:core:config.c) | 65 ++++++++++++++++++++++++++++++++++++++++++++---
 1 file [changed](#related), 62 insertions(+), 3 deletions(-)

[diff](#iZ31drivers:usb:core:config.c) --git a/drivers/usb/core/config.c b/drivers/usb/core/config.c
index 9b05e88..ecb2acb 100644
--- a/drivers/usb/core/config.c
+++ b/drivers/usb/core/config.c
@@ -144,6 +144,31 @@ static void usb_parse_ss_endpoint_companion(struct device *ddev, int cfgno,
 	}
 }

+static const unsigned short low_speed_maxpacket_maxes[4] = {
+	[USB_ENDPOINT_XFER_CONTROL] = 8,
+	[USB_ENDPOINT_XFER_ISOC] = 0,
+	[USB_ENDPOINT_XFER_BULK] = 0,
+	[USB_ENDPOINT_XFER_INT] = 8,
+};
+static const unsigned short full_speed_maxpacket_maxes[4] = {
+	[USB_ENDPOINT_XFER_CONTROL] = 64,
+	[USB_ENDPOINT_XFER_ISOC] = 1023,
+	[USB_ENDPOINT_XFER_BULK] = 64,
+	[USB_ENDPOINT_XFER_INT] = 64,
+};
+static const unsigned short high_speed_maxpacket_maxes[4] = {
+	[USB_ENDPOINT_XFER_CONTROL] = 64,
+	[USB_ENDPOINT_XFER_ISOC] = 1024,
+	[USB_ENDPOINT_XFER_BULK] = 512,
+	[USB_ENDPOINT_XFER_INT] = 1023,
+};
+static const unsigned short super_speed_maxpacket_maxes[4] = {
+	[USB_ENDPOINT_XFER_CONTROL] = 512,
+	[USB_ENDPOINT_XFER_ISOC] = 1024,
+	[USB_ENDPOINT_XFER_BULK] = 1024,
+	[USB_ENDPOINT_XFER_INT] = 1024,
+};
+
 static int usb_parse_endpoint(struct device *ddev, int cfgno, int inum,
     int asnum, struct usb_host_interface *ifp, int num_ep,
     unsigned char *buffer, int size)
@@ -152,6 +177,8 @@ static int usb_parse_endpoint(struct device *ddev, int cfgno, int inum,
 	struct usb_endpoint_descriptor *d;
 	struct usb_host_endpoint *endpoint;
 	int n, i, j, retval;
+	unsigned int maxp;
+	const unsigned short *maxpacket_maxes;

 	d = (struct usb_endpoint_descriptor *) buffer;
 	buffer += d->bLength;
@@ -247,6 +274,41 @@ static int usb_parse_endpoint(struct device *ddev, int cfgno, int inum,
 			endpoint->desc.wMaxPacketSize = cpu_to_le16(8);
 	}

+	/* Validate the wMaxPacketSize field */
+	maxp = usb_endpoint_maxp(&endpoint->desc);
+
+	/* Find the highest legal maxpacket size for this endpoint */
+	i = 0;		/* additional transactions per microframe */
+	switch (to_usb_device(ddev)->speed) {
+	case USB_SPEED_LOW:
+		maxpacket_maxes = low_speed_maxpacket_maxes;
+		break;
+	case USB_SPEED_FULL:
+		maxpacket_maxes = full_speed_maxpacket_maxes;
+		break;
+	case USB_SPEED_HIGH:
+		/* Bits 12..11 are allowed only for HS periodic endpoints */
+		if (usb_endpoint_xfer_int(d) || usb_endpoint_xfer_isoc(d)) {
+			i = maxp & (BIT(12) | BIT(11));
+			maxp &= ~i;
+		}
+		/* fallthrough */
+	default:
+		maxpacket_maxes = high_speed_maxpacket_maxes;
+		break;
+	case USB_SPEED_SUPER:
+		maxpacket_maxes = super_speed_maxpacket_maxes;
+		break;
+	}
+	j = maxpacket_maxes[usb_endpoint_type(&endpoint->desc)];
+
+	if (maxp > j) {
+		dev_warn(ddev, "config %d interface %d altsetting %d endpoint 0x%X has invalid maxpacket %d, setting to %d\n",
+		    cfgno, inum, asnum, d->bEndpointAddress, maxp, j);
+		maxp = j;
+		endpoint->desc.wMaxPacketSize = cpu_to_le16(i | maxp);
+	}
+
 	/*
 	 * Some buggy high speed devices have bulk endpoints using
 	 * maxpacket sizes other than 512.  High speed HCDs may not
@@ -254,9 +316,6 @@ static int usb_parse_endpoint(struct device *ddev, int cfgno, int inum,
 	 */
 	if (to_usb_device(ddev)->speed == USB_SPEED_HIGH
 			&& usb_endpoint_xfer_bulk(d)) {
-		unsigned maxp;
-
-		maxp = usb_endpoint_maxp(&endpoint->desc) & 0x07ff;
 		if (maxp != 512)
 			dev_warn(ddev, "config %d interface %d altsetting %d "
 				"bulk endpoint 0x%X has invalid maxpacket %d\n",
--
2.8.0.rc2.1.gbe9624a

```

---

```
[next](../1486322541-8206-9-git-send-email-w%401wt.eu/) [prev](../1486322541-8206-7-git-send-email-w%401wt.eu/) [parent](../1486322541-8206-1-git-send-email-w%401wt.eu/) [reply](#R)	other threads:[[~2017-02-05 20:16 UTC](../?t=20170205201602)|[newest](../)]

Thread overview: 239+ messages / expand[[flat](T/#u)|[nested](t/#u)]  [mbox.gz](t.mbox.gz)  [Atom feed](t.atom)  [top](#b)
2017-02-05 19:18 [[PATCH 3.10 100/319] fix fault_in_multipages_...() on architectures with no-op access_ok()](../1486322541-8206-1-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:18 ` [[PATCH 3.10 101/319] fix memory leaks in tracing_buffers_splice_read()](../1486322541-8206-2-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:18 ` [[PATCH 3.10 102/319] arc: don't leak bits of kernel stack into coredump](../1486322541-8206-3-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:18 ` [[PATCH 3.10 103/319] Fix potential infoleak in older kernels](../1486322541-8206-4-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:18 ` [[PATCH 3.10 104/319] swapfile: fix memory corruption via malformed swapfile](../1486322541-8206-5-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:18 ` [[PATCH 3.10 105/319] coredump: fix unfreezable coredumping task](../1486322541-8206-6-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:18 ` [[PATCH 3.10 106/319] usb: dwc3: gadget: increment request->actual once](../1486322541-8206-7-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:18 ` [Willy Tarreau [this message]](#t)
2017-02-05 19:18 ` [[PATCH 3.10 108/319] USB: fix typo in wMaxPacketSize validation](../1486322541-8206-9-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:18 ` [[PATCH 3.10 109/319] usb: xhci: Fix panic if disconnect](../1486322541-8206-10-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:18 ` [[PATCH 3.10 110/319] USB: serial: fix memleak in driver-registration error path](../1486322541-8206-11-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:18 ` [[PATCH 3.10 111/319] USB: kobil_sct: fix non-atomic allocation in write path](../1486322541-8206-12-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:18 ` [[PATCH 3.10 112/319] USB: serial: mos7720:](../1486322541-8206-13-git-send-email-w%401wt.eu/) " Willy Tarreau
2017-02-05 19:18 ` [[PATCH 3.10 113/319] USB: serial: mos7840:](../1486322541-8206-14-git-send-email-w%401wt.eu/) " Willy Tarreau
2017-02-05 19:18 ` [[PATCH 3.10 114/319] usb: renesas_usbhs: fix clearing the {BRDY,BEMP}STS condition](../1486322541-8206-15-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:18 ` [[PATCH 3.10 115/319] USB: change bInterval default to 10 ms](../1486322541-8206-16-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:18 ` [[PATCH 3.10 116/319] usb: gadget: fsl_qe_udc: signedness bug in qe_get_frame()](../1486322541-8206-17-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:18 ` [[PATCH 3.10 117/319] USB: serial: cp210x: fix hardware flow-control disable](../1486322541-8206-18-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 118/319] usb: misc: legousbtower: Fix NULL pointer deference](../1486322541-8206-19-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 119/319] usb: gadget: function: u_ether: don't starve tx request queue](../1486322541-8206-20-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 120/319] USB: serial: cp210x: fix tiocmget error handling](../1486322541-8206-21-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 121/319] usb: gadget: u_ether: remove interrupt throttling](../1486322541-8206-22-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 122/319] usb: chipidea: move the lock initialization to core file](../1486322541-8206-23-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 123/319] Fix USB CB/CBI storage devices with CONFIG_VMAP_STACK=y](../1486322541-8206-24-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 124/319] ALSA: rawmidi: Fix possible deadlock with virmidi registration](../1486322541-8206-25-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 125/319] ALSA: timer: fix NULL pointer dereference in read()/ioctl() race](../1486322541-8206-26-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 126/319] ALSA: timer: fix division by zero after SNDRV_TIMER_IOCTL_CONTINUE](../1486322541-8206-27-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 127/319] ALSA: timer: fix NULL pointer dereference on memory allocation failure](../1486322541-8206-28-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 128/319] ALSA: ali5451: Fix out-of-bound position reporting](../1486322541-8206-29-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 129/319] ALSA: pcm : Call kill_fasync() in stream lock](../1486322541-8206-30-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 130/319] zfcp: fix fc_host port_type with NPIV](../1486322541-8206-31-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 131/319] zfcp: fix ELS/GS request&response length for hardware data router](../1486322541-8206-32-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 132/319] zfcp: close window with unblocked rport during rport gone](../1486322541-8206-33-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 133/319] zfcp: retain trace level for SCSI and HBA FSF response records](../1486322541-8206-34-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 134/319] zfcp: restore: Dont use 0 to indicate invalid LUN in rec trace](../1486322541-8206-35-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 135/319] zfcp: trace on request for open and close of WKA port](../1486322541-8206-36-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 136/319] zfcp: restore tracing of handle for port and LUN with HBA records](../1486322541-8206-37-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 137/319] zfcp: fix D_ID field with actual value on tracing SAN responses](../1486322541-8206-38-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 138/319] zfcp: fix payload trace length for SAN request&response](../1486322541-8206-39-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 139/319] zfcp: trace full payload of all SAN records (req,resp,iels)](../1486322541-8206-40-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 140/319] scsi: zfcp: spin_lock_irqsave() is not nestable](../1486322541-8206-41-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 141/319] scsi: mpt3sas: Fix secure erase premature termination](../1486322541-8206-42-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-06 16:21   ` [Sathya Prakash Veerichetty](../ae8ffc4f86c5af1caf97dfa9a6493443%40mail.gmail.com/)
2017-02-06 22:26     ` [Willy Tarreau](../20170206222623.GA4769%401wt.eu/)
2017-02-07  6:38       ` [James Bottomley](../1486449528.2474.125.camel%40HansenPartnership.com/)
2017-02-07  6:59         ` [Willy Tarreau](../20170207065946.GC4850%401wt.eu/)
2017-02-07 17:02           ` [James Bottomley](../1486486971.2488.19.camel%40HansenPartnership.com/)
2017-02-07 17:12             ` [Willy Tarreau](../20170207171234.GB4041%401wt.eu/)
2017-02-08  6:53               ` [Willy Tarreau](../20170208065356.GA4838%401wt.eu/)
2017-02-05 19:19 ` [[PATCH 3.10 142/319] mpt2sas:](../1486322541-8206-43-git-send-email-w%401wt.eu/) " Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 143/319] scsi: megaraid_sas: Fix data integrity failure for JBOD (passthrough) devices](../1486322541-8206-44-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 144/319] scsi: megaraid_sas: fix macro MEGASAS_IS_LOGICAL to avoid regression](../1486322541-8206-45-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 145/319] scsi: ibmvfc: Fix I/O hang when port is not mapped](../1486322541-8206-46-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 146/319] scsi: Fix use-after-free](../1486322541-8206-47-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 147/319] scsi: arcmsr: Buffer overflow in arcmsr_iop_message_xfer()](../1486322541-8206-48-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 148/319] scsi: scsi_debug: Fix memory leak if LBP enabled and module is unloaded](../1486322541-8206-49-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 149/319] scsi: arcmsr: Send SYNCHRONIZE_CACHE command to firmware](../1486322541-8206-50-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 150/319] ext4: validate that metadata blocks do not overlap superblock](../1486322541-8206-51-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 151/319] ext4: avoid modifying checksum fields directly during checksum verification](../1486322541-8206-52-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 152/319] ext4: use __GFP_NOFAIL in ext4_free_blocks()](../1486322541-8206-53-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 153/319] ext4: reinforce check of i_dtime when clearing high fields of uid and gid](../1486322541-8206-54-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 154/319] ext4: allow DAX writeback for hole punch](../1486322541-8206-55-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 155/319] ext4: sanity check the block and cluster size at mount time](../1486322541-8206-56-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 156/319] reiserfs: fix "new_insert_key may be used uninitialized ..."](../1486322541-8206-57-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 157/319] reiserfs: Unlock superblock before calling reiserfs_quota_on_mount()](../1486322541-8206-58-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 158/319] xfs: fix superblock inprogress check](../1486322541-8206-59-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 159/319] libxfs: clean up _calc_dquots_per_chunk](../1486322541-8206-60-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 160/319] btrfs: ensure that file descriptor used with subvol ioctls is a dir](../1486322541-8206-61-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 161/319] ocfs2/dlm: fix race between convert and migration](../1486322541-8206-62-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 162/319] ocfs2: fix start offset to ocfs2_zero_range_for_truncate()](../1486322541-8206-63-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 163/319] ubifs: Fix assertion in layout_in_gaps()](../1486322541-8206-64-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 164/319] ubifs: Fix xattr_names length in exit paths](../1486322541-8206-65-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 165/319] UBIFS: Fix possible memory leak in ubifs_readdir()](../1486322541-8206-66-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 166/319] ubifs: Abort readdir upon error](../1486322541-8206-67-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 167/319] ubifs: Fix regression in ubifs_readdir()](../1486322541-8206-68-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 168/319] UBI: fastmap: scrub PEB when bitflips are detected in a free PEB EC header](../1486322541-8206-69-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 169/319] NFSv4.x: Fix a refcount leak in nfs_callback_up_net](../1486322541-8206-70-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 170/319] NFSD: Using free_conn free connection](../1486322541-8206-71-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 171/319] NFS: Don't drop CB requests with invalid principals](../1486322541-8206-72-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 172/319] NFSv4: Open state recovery must account for file permission changes](../1486322541-8206-73-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 173/319] fs/seq_file: fix out-of-bounds read](../1486322541-8206-74-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 174/319] fs/super.c: fix race between freeze_super() and thaw_super()](../1486322541-8206-75-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 175/319] isofs: Do not return EACCES for unknown filesystems](../1486322541-8206-76-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 176/319] hostfs: Freeing an ERR_PTR in hostfs_fill_sb_common()](../1486322541-8206-77-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:19 ` [[PATCH 3.10 177/319] driver core: Delete an unnecessary check before the function call "put_device"](../1486322541-8206-78-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 178/319] driver core: fix race between creating/querying glue dir and its cleanup](../1486322541-8206-79-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 179/319] drm/radeon: fix radeon_move_blit on 32bit systems](../1486322541-8206-80-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 180/319] drm: Reject page_flip for !DRIVER_MODESET](../1486322541-8206-81-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 181/319] drm/radeon: Ensure vblank interrupt is enabled on DPMS transition to on](../1486322541-8206-82-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 182/319] qxl: check for kmap failures](../1486322541-8206-83-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 183/319] Input: i8042 - break load dependency between atkbd/psmouse and i8042](../1486322541-8206-84-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 184/319] Input: i8042 - set up shared ps2_cmd_mutex for AUX ports](../1486322541-8206-85-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 185/319] Input: ili210x - fix permissions on "calibrate" attribute](../1486322541-8206-86-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 186/319] hwrng: exynos - Disable runtime PM on probe failure](../1486322541-8206-87-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 187/319] hwrng: omap - Fix assumption that runtime_get_sync will always succeed](../1486322541-8206-88-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 188/319] hwrng: omap - Only fail if pm_runtime_get_sync returns < 0](../1486322541-8206-89-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 189/319] i2c-eg20t: fix race between i2c init and interrupt enable](../1486322541-8206-90-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 190/319] em28xx-i2c: rt_mutex_trylock() returns zero on failure](../1486322541-8206-91-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 191/319] i2c: core: fix NULL pointer dereference under race condition](../1486322541-8206-92-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 192/319] i2c: at91: fix write transfers by clearing pending interrupt first](../1486322541-8206-93-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 193/319] iio: accel: kxsd9: Fix raw read return](../1486322541-8206-94-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 194/319] iio: accel: kxsd9: Fix scaling bug](../1486322541-8206-95-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 195/319] thermal: hwmon: Properly report critical temperature in sysfs](../1486322541-8206-96-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 196/319] cdc-acm: fix wrong pipe type on rx interrupt xfers](../1486322541-8206-97-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 197/319] timers: Use proper base migration in add_timer_on()](../1486322541-8206-98-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 198/319] EDAC: Increment correct counter in edac_inc_ue_error()](../1486322541-8206-99-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 199/319] IB/srpt: Simplify srpt_handle_tsk_mgmt()](../1486322541-8206-100-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-06  5:14   ` [Bart Van Assche](../1486358029.2980.1.camel%40sandisk.com/)
2017-02-06  6:32     ` [Willy Tarreau](../20170206063204.GB9533%401wt.eu/)
2017-02-05 19:20 ` [[PATCH 3.10 200/319] IB/ipoib: Fix memory corruption in ipoib cm mode connect flow](../1486322541-8206-101-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 201/319] IB/core: Fix use after free in send_leave function](../1486322541-8206-102-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 202/319] IB/ipoib: Don't allow MC joins during light MC flush](../1486322541-8206-103-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 203/319] IB/mlx4: Fix incorrect MC join state bit-masking on SR-IOV](../1486322541-8206-104-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 204/319] IB/mlx4: Fix create CQ error flow](../1486322541-8206-105-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 205/319] IB/uverbs: Fix leak of XRC target QPs](../1486322541-8206-106-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 206/319] IB/cm: Mark stale CM id's whenever the mad agent was unregistered](../1486322541-8206-107-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 207/319] mtd: blkdevs: fix potential deadlock + lockdep warnings](../1486322541-8206-108-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 208/319] mtd: pmcmsp-flash: Allocating too much in init_msp_flash()](../1486322541-8206-109-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 209/319] mtd: nand: davinci: Reinitialize the HW ECC engine in 4bit hwctl](../1486322541-8206-110-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 210/319] perf symbols: Fixup symbol sizes before picking best ones](../1486322541-8206-111-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 211/319] perf: Tighten (and fix) the grouping condition](../1486322541-8206-112-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 212/319] tty: Prevent ldisc drivers from re-using stale tty fields](../1486322541-8206-113-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 213/319] tty: limit terminal size to 4M chars](../1486322541-8206-114-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 214/319] tty: vt, fix bogus division in csi_J](../1486322541-8206-115-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 215/319] vt: clear selection before resizing](../1486322541-8206-116-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 216/319] drivers/vfio: Rework offsetofend()](../1486322541-8206-117-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 217/319] include/stddef.h: Move offsetofend() from vfio.h to a generic kernel header](../1486322541-8206-118-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 218/319] stddef.h: move offsetofend inside #ifndef/#endif guard, neaten](../1486322541-8206-119-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 219/319] ipv6: don't call fib6_run_gc() until routing is ready](../1486322541-8206-120-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 220/319] ipv6: split duplicate address detection and router solicitation timer](../1486322541-8206-121-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 221/319] ipv6: move DAD and addrconf_verify processing to workqueue](../1486322541-8206-122-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 222/319] ipv6: addrconf: fix dev refcont leak when DAD failed](../1486322541-8206-123-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 223/319] ipv6: fix rtnl locking in setsockopt for anycast and multicast](../1486322541-8206-124-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 224/319] ip6_gre: fix flowi6_proto value in ip6gre_xmit_other()](../1486322541-8206-125-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 225/319] ipv6: correctly add local routes when lo goes up](../1486322541-8206-126-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 226/319] ipv6: dccp: fix out of bound access in dccp_v6_err()](../1486322541-8206-127-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 227/319] ipv6: dccp: add missing bind_conflict to dccp_ipv6_mapped](../1486322541-8206-128-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 228/319] ip6_tunnel: Clear IP6CB in ip6tunnel_xmit()](../1486322541-8206-129-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 229/319] ip6_tunnel: disable caching when the traffic class is inherited](../1486322541-8206-130-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 230/319] net/irda: handle iriap_register_lsap() allocation failure](../1486322541-8206-131-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 231/319] tcp: fix use after free in tcp_xmit_retransmit_queue()](../1486322541-8206-132-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 232/319] tcp: properly scale window in tcp_v[46]_reqsk_send_ack()](../1486322541-8206-133-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 233/319] tcp: fix overflow in __tcp_retransmit_skb()](../1486322541-8206-134-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 234/319] tcp: fix wrong checksum calculation on MTU probing](../1486322541-8206-135-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 235/319] tcp: take care of truncations done by sk_filter()](../1486322541-8206-136-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 236/319] bonding: Fix bonding crash](../1486322541-8206-137-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:20 ` [[PATCH 3.10 237/319] net: ratelimit warnings about dst entry refcount underflow or overflow](../1486322541-8206-138-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 238/319] mISDN: Support DR6 indication in mISDNipac driver](../1486322541-8206-139-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 239/319] mISDN: Fixing missing validation in base_sock_bind()](../1486322541-8206-140-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 240/319] net: disable fragment reassembly if high_thresh is set to zero](../1486322541-8206-141-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 241/319] ipvs: count pre-established TCP states as active](../1486322541-8206-142-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 242/319] iwlwifi: pcie: fix access to scratch buffer](../1486322541-8206-143-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 243/319] svc: Avoid garbage replies when pc_func() returns rpc_drop_reply](../1486322541-8206-144-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 244/319] brcmsmac: Free packet if dma_mapping_error() fails in dma_rxfill](../1486322541-8206-145-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 245/319] brcmsmac: Initialize power in brcms_c_stf_ss_algo_channel_get()](../1486322541-8206-146-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 246/319] brcmfmac: avoid potential stack overflow in brcmf_cfg80211_start_ap()](../1486322541-8206-147-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 247/319] pstore: Fix buffer overflow while write offset equal to buffer size](../1486322541-8206-148-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 248/319] net/mlx4_core: Allow resetting VF admin mac to zero](../1486322541-8206-149-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 249/319] firewire: net: guard against rx buffer overflows](../1486322541-8206-150-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 250/319] firewire: net: fix fragmented datagram_size off-by-one](../1486322541-8206-151-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 251/319] netfilter: fix namespace handling in nf_log_proc_dostring](../1486322541-8206-152-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 252/319] can: bcm: fix warning in bcm_connect/proc_register](../1486322541-8206-153-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 253/319] net: fix sk_mem_reclaim_partial()](../1486322541-8206-154-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 254/319] net: avoid sk_forward_alloc overflows](../1486322541-8206-155-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 255/319] ipmr, ip6mr: fix scheduling while atomic and a deadlock with ipmr_get_route](../1486322541-8206-156-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 256/319] packet: call fanout_release, while UNREGISTERING a netdev](../1486322541-8206-157-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 257/319] net: sctp, forbid negative length](../1486322541-8206-158-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 258/319] sctp: validate chunk len before actually using it](../1486322541-8206-159-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 259/319] net: clear sk_err_soft in sk_clone_lock()](../1486322541-8206-160-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 260/319] net: mangle zero checksum in skb_checksum_help()](../1486322541-8206-161-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 261/319] dccp: do not send reset to already closed sockets](../1486322541-8206-162-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 262/319] dccp: fix out of bound access in dccp_v4_err()](../1486322541-8206-163-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 263/319] sctp: assign assoc_id earlier in __sctp_connect](../1486322541-8206-164-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 264/319] neigh: check error pointer instead of NULL for ipv4_neigh_lookup()](../1486322541-8206-165-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 265/319] ipv4: use new_gw for redirect neigh lookup](../1486322541-8206-166-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 266/319] mac80211: fix purging multicast PS buffer queue](../1486322541-8206-167-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 267/319] mac80211: discard multicast and 4-addr A-MSDUs](../1486322541-8206-168-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 268/319] cfg80211: limit scan results cache size](../1486322541-8206-169-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 269/319] mwifiex: printk() overflow with 32-byte SSIDs](../1486322541-8206-170-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 270/319] ipv4: Set skb->protocol properly for local output](../1486322541-8206-171-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 271/319] net: sky2: Fix shutdown crash](../1486322541-8206-172-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 272/319] kaweth: fix firmware download](../1486322541-8206-173-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 273/319] tracing: Move mutex to protect against resetting of seq data](../1486322541-8206-174-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 274/319] kernel/fork: fix CLONE_CHILD_CLEARTID regression in nscd](../1486322541-8206-175-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 275/319] ipc: remove use of seq_printf return value](../1486322541-8206-176-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:49   ` [Joe Perches](../1486324173.22276.93.camel%40perches.com/)
2017-02-05 20:35     ` [Willy Tarreau](../20170205203519.GA8835%401wt.eu/)
2017-02-06  8:06   ` [Willy Tarreau](../20170206080628.GH14903%401wt.eu/)
2017-02-05 19:21 ` [[PATCH 3.10 276/319] arch: Introduce smp_load_acquire(), smp_store_release()](../1486322541-8206-177-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-06  8:06   ` [Willy Tarreau](../20170206080616.GG14903%401wt.eu/)
2017-02-05 19:21 ` [[PATCH 3.10 277/319] kernel: Provide READ_ONCE and ASSIGN_ONCE](../1486322541-8206-178-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-06  8:06   ` [Willy Tarreau](../20170206080608.GF14903%401wt.eu/)
2017-02-05 19:21 ` [[PATCH 3.10 278/319] kernel: Change ASSIGN_ONCE(val, x) to WRITE_ONCE(x, val)](../1486322541-8206-179-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-06  8:06   ` [Willy Tarreau](../20170206080601.GE14903%401wt.eu/)
2017-02-05 19:21 ` [[PATCH 3.10 279/319] kernel: make READ_ONCE() valid on const arguments](../1486322541-8206-180-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-06  8:05   ` [Willy Tarreau](../20170206080547.GD14903%401wt.eu/)
2017-02-05 19:21 ` [[PATCH 3.10 280/319] locking: Remove atomicy checks from {READ,WRITE}_ONCE](../1486322541-8206-181-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-06  8:05   ` [Willy Tarreau](../20170206080537.GC14903%401wt.eu/)
2017-02-05 19:21 ` [[PATCH 3.10 281/319] compiler: Allow 1- and 2-byte smp_load_acquire() and smp_store_release()](../1486322541-8206-182-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-06  8:05   ` [Willy Tarreau](../20170206080528.GB14903%401wt.eu/)
2017-02-05 19:21 ` [[PATCH 3.10 282/319] ipc/sem.c: fix complex_count vs. simple op race](../1486322541-8206-183-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-06  8:04   ` [Willy Tarreau](../20170206080456.GA14903%401wt.eu/)
2017-02-05 19:21 ` [[PATCH 3.10 283/319] cfq: fix starvation of asynchronous writes](../1486322541-8206-184-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 284/319] drbd: Fix kernel_sendmsg() usage - potential NULL deref](../1486322541-8206-185-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 285/319] lib/genalloc.c: start search from start of chunk](../1486322541-8206-186-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 286/319] tools/vm/slabinfo: fix an unintentional printf](../1486322541-8206-187-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 287/319] rcu: Fix soft lockup for rcu_nocb_kthread](../1486322541-8206-188-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 288/319] ratelimit: fix bug in time interval by resetting right begin time](../1486322541-8206-189-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 289/319] mfd: core: Fix device reference leak in mfd_clone_cell](../1486322541-8206-190-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 290/319] PM / sleep: fix device reference leak in test_suspend](../1486322541-8206-191-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 291/319] mmc: mxs: Initialize the spinlock prior to using it](../1486322541-8206-192-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 292/319] mmc: block: don't use CMD23 with very old MMC cards](../1486322541-8206-193-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 293/319] pstore/core: drop cmpxchg based updates](../1486322541-8206-194-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 294/319] pstore/ram: Use memcpy_toio instead of memcpy](../1486322541-8206-195-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 295/319] pstore/ram: Use memcpy_fromio() to save old buffer](../1486322541-8206-196-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 296/319] mb86a20s: fix the locking logic](../1486322541-8206-197-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:21 ` [[PATCH 3.10 297/319] mb86a20s: fix demod settings](../1486322541-8206-198-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:22 ` [[PATCH 3.10 298/319] cx231xx: don't return error on success](../1486322541-8206-199-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:22 ` [[PATCH 3.10 299/319] cx231xx: fix GPIOs for Pixelview SBTVD hybrid](../1486322541-8206-200-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:22 ` [[PATCH 3.10 300/319] gpio: mpc8xxx: Correct irq handler function](../1486322541-8206-201-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:22 ` [[PATCH 3.10 301/319] uio: fix dmem_region_start computation](../1486322541-8206-202-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:22 ` [[PATCH 3.10 302/319] KEYS: Fix short sprintf buffer in /proc/keys show function](../1486322541-8206-203-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:22 ` [[PATCH 3.10 303/319] hv: do not lose pending heartbeat vmbus packets](../1486322541-8206-204-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:22 ` [[PATCH 3.10 304/319] staging: iio: ad5933: avoid uninitialized variable in error case](../1486322541-8206-205-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:22 ` [[PATCH 3.10 305/319] mei: bus: fix received data size check in NFC fixup](../1486322541-8206-206-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:22 ` [[PATCH 3.10 306/319] ACPI / APEI: Fix incorrect return value of ghes_proc()](../1486322541-8206-207-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:22 ` [[PATCH 3.10 307/319] PCI: Handle read-only BARs on AMD CS553x devices](../1486322541-8206-208-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:22 ` [[PATCH 3.10 308/319] tile: avoid using clocksource_cyc2ns with absolute cycle count](../1486322541-8206-209-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:22 ` [[PATCH 3.10 309/319] dm flakey: fix reads to be issued if drop_writes configured](../1486322541-8206-210-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:22 ` [[PATCH 3.10 310/319] mm,ksm: fix endless looping in allocating memory when ksm enable](../1486322541-8206-211-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:22 ` [[PATCH 3.10 311/319] can: dev: fix deadlock reported after bus-off](../1486322541-8206-212-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:22 ` [[PATCH 3.10 312/319] hwmon: (adt7411) set bit 3 in CFG1 register](../1486322541-8206-213-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:22 ` [[PATCH 3.10 313/319] mpi: Fix NULL ptr dereference in mpi_powm() [ver #3]](../1486322541-8206-214-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:22 ` [[PATCH 3.10 314/319] mfd: 88pm80x: Double shifting bug in suspend/resume](../1486322541-8206-215-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:22 ` [[PATCH 3.10 315/319] ASoC: omap-mcpdm: Fix irq resource handling](../1486322541-8206-216-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:22 ` [[PATCH 3.10 316/319] regulator: tps65910: Work around silicon erratum SWCZ010](../1486322541-8206-217-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:22 ` [[PATCH 3.10 317/319] dm: mark request_queue dead before destroying the DM device](../1486322541-8206-218-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:22 ` [[PATCH 3.10 318/319] fbdev/efifb: Fix 16 color palette entry calculation](../1486322541-8206-219-git-send-email-w%401wt.eu/) Willy Tarreau
2017-02-05 19:22 ` [[PATCH 3.10 319/319] metag: Only define atomic_dec_if_positive conditionally](../1486322541-8206-220-git-send-email-w%401wt.eu/) Willy Tarreau

```
```
find likely ancestor, descendant, or conflicting patches for [this message](#t):
( dfblob:9b05e88 dfblob:ecb2acb )
 OR (
bs:"[PATCH 3.10 107/319] USB: validate wMaxPacketValue entries in endpoint descriptors" )
	([help](../_/text/help/#search))
```

---

```
Reply instructions:

You may reply publicly to [this message](#t) via plain-text email
using any one of the following methods:

* Save the following mbox file, import it into your mail client,
  and reply-to-all from there: [mbox](raw)

  Avoid top-posting and favor interleaved quoting:
  <https://en.wikipedia.org/wiki/Posting_style#Interleaved_style>

* Reply using the --to, --cc, and --in-reply-to
  switches of git-send-email(1):

  git send-email \
    --in-reply-to=1486322541-8206-8-git-send-email-w@1wt.eu \
    --to=w@1wt.eu \
    --cc=gregkh@linuxfoundation.org \
    --cc=linux-kernel@vger.kernel.org \
    --cc=linux@roeck-us.net \
    --cc=stable@vger.kernel.org \
    --cc=stern@rowland.harvard.edu \
    /path/to/YOUR_REPLY

  <https://kernel.org/pub/software/scm/git/docs/git-send-email.html>

* If your mail client supports setting the In-Reply-To header
  via mailto: links, try the mailto: link

```
Be sure your reply has a **Subject:** header at the top and a blank line
before the message body.

---

```
This is a public inbox, see [mirroring instructions](../_/text/mirror/)
for how to clone and mirror all data and code used for this inbox;
as well as URLs for NNTP newsgroup(s).
```


=== Content from www.spinics.net_8869336d_20250110_190721.html ===


# USB vulnerability

[[Date Prev](msg144176.html)][[Date Next](msg144178.html)][[Thread Prev](msg144170.html)][[Thread Next](msg144179.html)][[Date Index](mail49.html#144177)][[Thread Index](thrd47.html#144177)]

---

* *Subject*: USB vulnerability
* *From*: roswest <roswest@xxxxxxxxx>
* *Date*: Thu, 28 Jul 2016 12:23:01 -0400
* *Cc*: linux-usb@xxxxxxxxxxxxxxx, Christopher Kopek <ckopek@xxxxxxxxx>
* *User-agent*: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.10; rv:45.0) Gecko/20100101 Thunderbird/45.0

---

```

Alan,

Hi, I am an engineer at Cisco Systems, and this summer we tasked some
interns with performing USB fuzzing. One of the interns, Jake Lamberson,
was able to cause a kernel panic when emulating an HID keyboard because
the OHCI driver fails to reserve bandwidth for the device.  Please see
the attachment for details.

Thank you,
Rosie Hall

```
```

Headline:         Linux Kernel Panic Over USB with HID Keyboard wMaxPacketSize
Platforms:        Ubuntu
Versions:         Linux Kernel 4.4.0-22-generic
CVSS Score:       4.7
CVSS Vector:      AV:L/AC:M/Au:N/C:N/I:N/A:C
Filed Defects:
Related Defects:
CWE Tags:
Cycle:
Found by:         Jake Lamberson

Linux Kernel panics when using an OHCI controller if a USB device reports being
a generic HID keyboard and reports a wMaxPacketSize of over 4095. The OHCI
controller driver fails to reserve bandwidth for the device, causing the
keyboard handler to fail when attaching to the HID. Later, when the device is
removed, the system crashes due to a null pointer dereference in a linked list
of endpoint descriptors. The crash can be re-created using a Facedancer and UMAP
software. Given an appropriately configured Facedancer and UMAP setup, the crash
can be re-created with:
sudo board=facedancer21 python3 umap.py -P /dev/serial_device_here -f 03:00:00:E:0046 -l LOG

Note: OHCI is a USB 1.1 controller standard that can be included with devices
that support either USB 1.1 or 2.0 as their highest USB spec. USB 3.0 devices
all use xHCI, which implements USB 1.1, 2.0, and 3.0, making them immune to
this particular bug.

```

**Attachment:
[signature.asc](attachments/pgpBm0C7is62T.pgp)**

*Description:* OpenPGP digital signature

---

* **Follow-Ups**:
  + **[Re: USB vulnerability](msg144205.html)**
    - *From:* Felipe Balbi
  + **[Re: USB vulnerability](msg144179.html)**
    - *From:* Greg KH

* Prev by Date:
  **[Re: [PATCH v3 4/6] usb: core: add power sequence handling for USB devices](msg144176.html)**
* Next by Date:
  **[Re: [PATCH v3 0/6] power: add power sequence library](msg144178.html)**
* Previous by thread:
  **[xhci\_hcd crash on linux 4.7.0](msg144170.html)**
* Next by thread:
  **[Re: USB vulnerability](msg144179.html)**
* Index(es):
  + [**Date**](mail49.html#144177)
  + [**Thread**](thrd47.html#144177)

[[Index of Archives]](/lists/)

[[Linux Media]](/lists/linux-media/)

[[Linux Input]](/lists/linux-input/)

[[Linux Audio Users]](/lists/linux-audio-users/)

[[Yosemite News]](https://yosemitenews.info/)

[[Linux Kernel]](/lists/kernel/)

[[Linux SCSI]](/lists/linux-scsi/)

[[Old Linux USB Devel Archive]](/lists/linux-usb-devel/)

---

|  | [Powered by Linux](/lists/) |
| --- | --- |



=== Content from github.com_95f77542_20250110_190718.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftorvalds%2Flinux%2Fcommit%2Faed9d65ac3278d4febd8665bd7db59ef53e825fe)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftorvalds%2Flinux%2Fcommit%2Faed9d65ac3278d4febd8665bd7db59ef53e825fe)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=torvalds%2Flinux)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[torvalds](/torvalds)
/
**[linux](/torvalds/linux)**
Public

* [Notifications](/login?return_to=%2Ftorvalds%2Flinux) You must be signed in to change notification settings
* [Fork
  54.7k](/login?return_to=%2Ftorvalds%2Flinux)
* [Star
   186k](/login?return_to=%2Ftorvalds%2Flinux)

* [Code](/torvalds/linux)
* [Pull requests
  433](/torvalds/linux/pulls)
* [Actions](/torvalds/linux/actions)
* [Projects
  0](/torvalds/linux/projects)
* [Security](/torvalds/linux/security)
* [Insights](/torvalds/linux/pulse)

Additional navigation options

* [Code](/torvalds/linux)
* [Pull requests](/torvalds/linux/pulls)
* [Actions](/torvalds/linux/actions)
* [Projects](/torvalds/linux/projects)
* [Security](/torvalds/linux/security)
* [Insights](/torvalds/linux/pulse)

## Commit

[Permalink](/torvalds/linux/commit/aed9d65ac3278d4febd8665bd7db59ef53e825fe)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

USB: validate wMaxPacketValue entries in endpoint descriptors

[Browse files](/torvalds/linux/tree/aed9d65ac3278d4febd8665bd7db59ef53e825fe)
Browse the repository at this point in the history

```
Erroneous or malicious endpoint descriptors may have non-zero bits in
reserved positions, or out-of-bounds values.  This patch helps prevent
these from causing problems by bounds-checking the wMaxPacketValue
entries in endpoint descriptors and capping the values at the maximum
allowed.

This issue was first discovered and tests were conducted by Jake Lamberson
<jake.lamberson1@gmail.com>, an intern working for Rosie Hall.

Signed-off-by: Alan Stern <stern@rowland.harvard.edu>
Reported-by: roswest <roswest@cisco.com>
Tested-by: roswest <roswest@cisco.com>
CC: <stable@vger.kernel.org>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
```

* Loading branch information

[![@AlanStern](https://avatars.githubusercontent.com/u/28933196?s=40&v=4)](/AlanStern) [![@gregkh](https://avatars.githubusercontent.com/u/14953?s=40&v=4)](/gregkh)

[AlanStern](/torvalds/linux/commits?author=AlanStern "View all commits by AlanStern")
authored and
[gregkh](/torvalds/linux/commits?author=gregkh "View all commits by gregkh")
committed
Aug 9, 2016

1 parent
[9c6256a](/torvalds/linux/commit/9c6256a5e707a9eb8b91962b550050b13aa75334)

commit aed9d65

Showing
**1 changed file**
with
**63 additions**
and
**3 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

66 changes: 63 additions & 3 deletions

66
[drivers/usb/core/config.c](#diff-de55b4e2ce42f3e168d6fa95c90b80f4be170421896be5d2165d3aed83520185 "drivers/usb/core/config.c")

Show comments

[View file](/torvalds/linux/blob/aed9d65ac3278d4febd8665bd7db59ef53e825fe/drivers/usb/core/config.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -171,6 +171,31 @@ static void usb\_parse\_ss\_endpoint\_companion(struct device \*ddev, int cfgno, |
|  |  | ep, buffer, size); |
|  |  | } |
|  |  |  |
|  |  | static const unsigned short low\_speed\_maxpacket\_maxes[4] = { |
|  |  | [USB\_ENDPOINT\_XFER\_CONTROL] = 8, |
|  |  | [USB\_ENDPOINT\_XFER\_ISOC] = 0, |
|  |  | [USB\_ENDPOINT\_XFER\_BULK] = 0, |
|  |  | [USB\_ENDPOINT\_XFER\_INT] = 8, |
|  |  | }; |
|  |  | static const unsigned short full\_speed\_maxpacket\_maxes[4] = { |
|  |  | [USB\_ENDPOINT\_XFER\_CONTROL] = 64, |
|  |  | [USB\_ENDPOINT\_XFER\_ISOC] = 1023, |
|  |  | [USB\_ENDPOINT\_XFER\_BULK] = 64, |
|  |  | [USB\_ENDPOINT\_XFER\_INT] = 64, |
|  |  | }; |
|  |  | static const unsigned short high\_speed\_maxpacket\_maxes[4] = { |
|  |  | [USB\_ENDPOINT\_XFER\_CONTROL] = 64, |
|  |  | [USB\_ENDPOINT\_XFER\_ISOC] = 1024, |
|  |  | [USB\_ENDPOINT\_XFER\_BULK] = 512, |
|  |  | [USB\_ENDPOINT\_XFER\_INT] = 1023, |
|  |  | }; |
|  |  | static const unsigned short super\_speed\_maxpacket\_maxes[4] = { |
|  |  | [USB\_ENDPOINT\_XFER\_CONTROL] = 512, |
|  |  | [USB\_ENDPOINT\_XFER\_ISOC] = 1024, |
|  |  | [USB\_ENDPOINT\_XFER\_BULK] = 1024, |
|  |  | [USB\_ENDPOINT\_XFER\_INT] = 1024, |
|  |  | }; |
|  |  |  |
|  |  | static int usb\_parse\_endpoint(struct device \*ddev, int cfgno, int inum, |
|  |  | int asnum, struct usb\_host\_interface \*ifp, int num\_ep, |
|  |  | unsigned char \*buffer, int size) |
| Expand All | | @@ -179,6 +204,8 @@ static int usb\_parse\_endpoint(struct device \*ddev, int cfgno, int inum, |
|  |  | struct usb\_endpoint\_descriptor \*d; |
|  |  | struct usb\_host\_endpoint \*endpoint; |
|  |  | int n, i, j, retval; |
|  |  | unsigned int maxp; |
|  |  | const unsigned short \*maxpacket\_maxes; |
|  |  |  |
|  |  | d = (struct usb\_endpoint\_descriptor \*) buffer; |
|  |  | buffer += d->bLength; |
| Expand Down  Expand Up | | @@ -286,16 +313,49 @@ static int usb\_parse\_endpoint(struct device \*ddev, int cfgno, int inum, |
|  |  | endpoint->desc.wMaxPacketSize = cpu\_to\_le16(8); |
|  |  | } |
|  |  |  |
|  |  | /\* Validate the wMaxPacketSize field \*/ |
|  |  | maxp = usb\_endpoint\_maxp(&endpoint->desc); |
|  |  |  |
|  |  | /\* Find the highest legal maxpacket size for this endpoint \*/ |
|  |  | i = 0; /\* additional transactions per microframe \*/ |
|  |  | switch (to\_usb\_device(ddev)->speed) { |
|  |  | case USB\_SPEED\_LOW: |
|  |  | maxpacket\_maxes = low\_speed\_maxpacket\_maxes; |
|  |  | break; |
|  |  | case USB\_SPEED\_FULL: |
|  |  | maxpacket\_maxes = full\_speed\_maxpacket\_maxes; |
|  |  | break; |
|  |  | case USB\_SPEED\_HIGH: |
|  |  | /\* Bits 12..11 are allowed only for HS periodic endpoints \*/ |
|  |  | if (usb\_endpoint\_xfer\_int(d) || usb\_endpoint\_xfer\_isoc(d)) { |
|  |  | i = maxp & (BIT(12) | BIT(11)); |
|  |  | maxp &= ~i; |
|  |  | } |
|  |  | /\* fallthrough \*/ |
|  |  | default: |
|  |  | maxpacket\_maxes = high\_speed\_maxpacket\_maxes; |
|  |  | break; |
|  |  | case USB\_SPEED\_SUPER: |
|  |  | case USB\_SPEED\_SUPER\_PLUS: |
|  |  | maxpacket\_maxes = super\_speed\_maxpacket\_maxes; |
|  |  | break; |
|  |  | } |
|  |  | j = maxpacket\_maxes[usb\_endpoint\_type(&endpoint->desc)]; |
|  |  |  |
|  |  | if (maxp > j) { |
|  |  | dev\_warn(ddev, "config %d interface %d altsetting %d endpoint 0x%X has invalid maxpacket %d, setting to %d\n", |
|  |  | cfgno, inum, asnum, d->bEndpointAddress, maxp, j); |
|  |  | maxp = j; |
|  |  | endpoint->desc.wMaxPacketSize = cpu\_to\_le16(i | maxp); |
|  |  | } |
|  |  |  |
|  |  | /\* |
|  |  | \* Some buggy high speed devices have bulk endpoints using |
|  |  | \* maxpacket sizes other than 512. High speed HCDs may not |
|  |  | \* be able to handle that particular bug, so let's warn... |
|  |  | \*/ |
|  |  | if (to\_usb\_device(ddev)->speed == USB\_SPEED\_HIGH |
|  |  | && usb\_endpoint\_xfer\_bulk(d)) { |
|  |  | unsigned maxp; |
|  |  |  |
|  |  | maxp = usb\_endpoint\_maxp(&endpoint->desc) & 0x07ff; |
|  |  | if (maxp != 512) |
|  |  | dev\_warn(ddev, "config %d interface %d altsetting %d " |
|  |  | "bulk endpoint 0x%X has invalid maxpacket %d\n", |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `aed9d65`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftorvalds%2Flinux%2Fcommit%2Faed9d65ac3278d4febd8665bd7db59ef53e825fe) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


