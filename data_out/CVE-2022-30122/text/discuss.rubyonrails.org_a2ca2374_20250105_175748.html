

![Ruby on Rails Discussions](data:image/svg;base64...)
Loading

[Ruby on Rails Discussions](/)

# [[CVE-2022-30122] Denial of Service Vulnerability in Rack Multipart Parsing](/t/cve-2022-30122-denial-of-service-vulnerability-in-rack-multipart-parsing/80729)

[Security Announcements](/c/security-announcements/9)

[announcement](https://discuss.rubyonrails.org/tag/announcement),
[security](https://discuss.rubyonrails.org/tag/security),
[rack](https://discuss.rubyonrails.org/tag/rack)

[tenderlove](https://discuss.rubyonrails.org/u/tenderlove)
(Aaron Patterson)

May 27, 2022, 4:03pm

1

There is a possible denial of service vulnerability in the multipart parsing

component of Rack. This vulnerability has been assigned the CVE identifier

CVE-2022-30122.

Versions Affected: >= 1.2

Not affected: < 1.2

Fixed Versions: 2.0.9.1, 2.1.4.1, 2.2.3.1

Impact

---

Carefully crafted multipart POST requests can cause Rack’s multipart parser to

take much longer than expected, leading to a possible denial of service

vulnerability.

Impacted code will use Rack’s multipart parser to parse multipart posts. This

includes directly using the multipart parser like this:

```

params = Rack::Multipart.parse_multipart(env)

```

But it also includes reading POST data from a Rack request object like this:

```

p request.POST # read POST data

p request.params # reads both query params and POST data

```

All users running an affected release should either upgrade or use one of the

workarounds immediately.

Releases

---

The FIXED releases are available at the normal locations.

Workarounds

---

There are no feasible workarounds for this issue.

Patches

---

To aid users who aren’t able to upgrade immediately we have provided patches for

the two supported release series. They are in git-am format and consist of a

single changeset.

* 2-0-multipart-redos.patch - Patch for 2.0 series
* 2-1-multipart-redos.patch - Patch for 2.1 series
* 2-2-multipart-redos.patch - Patch for 2.2 series

Credits

---

Thanks to [@ooooooo\_q](https://hackerone.com/ooooooo_q?type=user) for reporting this!

[2-2-multipart-redos.patch](/uploads/short-url/QLqGciXeKiMeT18zZTqa7Xipm.patch) (4.1 KB)
[2-1-multipart-redos.patch](/uploads/short-url/5lMbus1dE9xwFBSOgOMeoa6tHwr.patch) (4.1 KB)
[2-0-multipart-redos.patch](/uploads/short-url/tp8V0wRhlZ0QspBFB14Hsu4AXWt.patch) (4.1 KB)

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [[CVE-2022-44571] Possible Denial of Service Vulnerability in Rack Content-Disposition parsing](https://discuss.rubyonrails.org/t/cve-2022-44571-possible-denial-of-service-vulnerability-in-rack-content-disposition-parsing/82126)  [Security Announcements](/c/security-announcements/9) [patch](https://discuss.rubyonrails.org/tag/patch) ,  [rack](https://discuss.rubyonrails.org/tag/rack) ,  [security](https://discuss.rubyonrails.org/tag/security) | 0 | 6767 | January 17, 2023 |
| [[CVE-2022-44572] Possible Denial of Service Vulnerability in Rack's RFC2183 boundary parsing](https://discuss.rubyonrails.org/t/cve-2022-44572-possible-denial-of-service-vulnerability-in-racks-rfc2183-boundary-parsing/82124)  [Security Announcements](/c/security-announcements/9) [patch](https://discuss.rubyonrails.org/tag/patch) ,  [rack](https://discuss.rubyonrails.org/tag/rack) ,  [security](https://discuss.rubyonrails.org/tag/security) | 0 | 4528 | January 17, 2023 |
| [[CVE-2022-44570] Possible Denial of Service Vulnerability in Rack's Range header parsing](https://discuss.rubyonrails.org/t/cve-2022-44570-possible-denial-of-service-vulnerability-in-racks-range-header-parsing/82125)  [Security Announcements](/c/security-announcements/9) [patch](https://discuss.rubyonrails.org/tag/patch) ,  [rack](https://discuss.rubyonrails.org/tag/rack) ,  [security](https://discuss.rubyonrails.org/tag/security) | 0 | 7203 | January 17, 2023 |
| [[CVE-2023-27539] Possible Denial of Service Vulnerability in Rack's header parsing](https://discuss.rubyonrails.org/t/cve-2023-27539-possible-denial-of-service-vulnerability-in-racks-header-parsing/82466)  [Security Announcements](/c/security-announcements/9) [announcement](https://discuss.rubyonrails.org/tag/announcement) ,  [patch](https://discuss.rubyonrails.org/tag/patch) ,  [security](https://discuss.rubyonrails.org/tag/security) | 0 | 6890 | March 13, 2023 |
| [Possible Denial of Service Vulnerability in Rack Header Parsing](https://discuss.rubyonrails.org/t/possible-denial-of-service-vulnerability-in-rack-header-parsing/84942)  [Security Announcements](/c/security-announcements/9) [announcement](https://discuss.rubyonrails.org/tag/announcement) ,  [rack](https://discuss.rubyonrails.org/tag/rack) | 0 | 4465 | February 21, 2024 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled

