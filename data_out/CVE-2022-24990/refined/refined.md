```
{
  "vulnerability": {
    "root_cause": "The vulnerability stems from a combination of an information leak and an OS command injection. The `webNasIPS` function in `mobile.class.php` leaks the admin password hash and the MAC address. This is used in conjunction with an OS command injection vulnerability in the `createRaid` function.",
    "weaknesses": [
      "Information Leak: The `webNasIPS` function discloses sensitive information such as the admin password hash and MAC address.",
      "OS Command Injection: The `createRaid` function in `volume.class.php` passes user-supplied input to the `popen` function without sanitization, leading to OS command injection."
    ],
    "impact": "Successful exploitation allows an unauthenticated attacker to execute arbitrary OS commands as root on the target system.",
    "attack_vectors": "The attack vector is through HTTP requests to the vulnerable `api.php` endpoint, specifically targeting the `webNasIPS` and `createRaid` functions.",
    "required_capabilities": "The attacker needs to be able to send HTTP requests to the target TerraMaster NAS device. The attacker needs to obtain the admin password hash and the MAC address from the `webNasIPS` function to craft a valid exploit using the `createRaid` vulnerability. The attacker also needs to calculate the correct `TIMESTAMP` and `SIGNATURE` HTTP headers to bypass the security checks in `api.php`."
  },
  "references": [
    "https://github.com/0xf4n9x/CVE-2022-24990",
    "https://octagon.net/blog/2022/03/07/cve-2022-24990-terrmaster-tos-unauthenticated-remote-command-execution-via-php-object-instantiation/"
  ]
}
```