- **Root cause of vulnerability:** Missing authorization checks due to method security advice not being applied correctly when using `@AuthorizeReturnObject` or `AuthorizationAdvisorProxyFactory`. This occurs when specific conditions regarding auto-proxy creation and `FactoryBean` usage are met.
- **Weaknesses/vulnerabilities present:** Incomplete application of method security annotations like `@PreFilter`, `@PostFilter`, `@PreAuthorize`, and `@PostAuthorize` on objects wrapped by `@AuthorizeReturnObject` or `AuthorizationAdvisorProxyFactory`, bypassing the intended security checks.
- **Impact of exploitation:** Security advice meant to control access to returned objects is not enforced, potentially leading to unauthorized data access or manipulation.
- **Attack vectors:** Exploitation requires the application to use `@AuthorizeReturnObject` or `AuthorizationAdvisorProxyFactory` along with method security annotations, have at least one `FactoryBean`, and use `AnnotationAwareAspectJAutoProxyCreator` for proxy creation. An attacker might be able to access or manipulate data that should be protected by method security annotations.
- **Required attacker capabilities/position:** The attacker does not need special privileges or positioning but needs to be able to interact with the application in a way that invokes methods returning wrapped objects. They must also be able to manipulate the input parameters so the security flaws are triggered and can potentially bypass access control restrictions.