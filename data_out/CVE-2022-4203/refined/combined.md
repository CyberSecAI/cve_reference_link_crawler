=== Content from git.openssl.org_ca19f8a5_20250108_115258.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenssl%2Fopenssl%2Fcommit%2Fc927a3492698c254637da836762f9b1f86cffabc)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenssl%2Fopenssl%2Fcommit%2Fc927a3492698c254637da836762f9b1f86cffabc)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=openssl%2Fopenssl)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[openssl](/openssl)
/
**[openssl](/openssl/openssl)**
Public

* [Notifications](/login?return_to=%2Fopenssl%2Fopenssl) You must be signed in to change notification settings
* [Fork
  10.2k](/login?return_to=%2Fopenssl%2Fopenssl)
* [Star
   26.3k](/login?return_to=%2Fopenssl%2Fopenssl)

* [Code](/openssl/openssl)
* [Issues
  1.6k](/openssl/openssl/issues)
* [Pull requests
  264](/openssl/openssl/pulls)
* [Discussions](/openssl/openssl/discussions)
* [Actions](/openssl/openssl/actions)
* [Projects
  1](/openssl/openssl/projects)
* [Security](/openssl/openssl/security)
* [Insights](/openssl/openssl/pulse)

Additional navigation options

* [Code](/openssl/openssl)
* [Issues](/openssl/openssl/issues)
* [Pull requests](/openssl/openssl/pulls)
* [Discussions](/openssl/openssl/discussions)
* [Actions](/openssl/openssl/actions)
* [Projects](/openssl/openssl/projects)
* [Security](/openssl/openssl/security)
* [Insights](/openssl/openssl/pulse)

## Commit

[Permalink](/openssl/openssl/commit/c927a3492698c254637da836762f9b1f86cffabc)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix type confusion in nc\_match\_single()

[Browse files](/openssl/openssl/tree/c927a3492698c254637da836762f9b1f86cffabc)
Browse the repository at this point in the history

```
This function assumes that if the "gen" is an OtherName, then the "base"
is a rfc822Name constraint. This assumption is not true in all cases.
If the end-entity certificate contains an OtherName SAN of any type besides
SmtpUtf8Mailbox and the CA certificate contains a name constraint of
OtherName (of any type), then "nc_email_eai" will be invoked, with the
OTHERNAME "base" being incorrectly interpreted as a ASN1_IA5STRING.

Reported by Corey Bonnell from Digicert.

[CVE-2022-4203](https://github.com/advisories/GHSA-w67w-mw4j-8qrv "CVE-2022-4203")

Reviewed-by: Paul Dale <pauli@openssl.org>
Reviewed-by: Hugo Landau <hlandau@openssl.org>
Reviewed-by: Tomas Mraz <tomas@openssl.org>
```

* Loading branch information

[![@t8m](https://avatars.githubusercontent.com/u/7125407?s=40&v=4)](/t8m)

Viktor Dukhovni
authored and
[t8m](/openssl/openssl/commits?author=t8m "View all commits by t8m")
committed
Feb 2, 2023

1 parent
[36d85b0](/openssl/openssl/commit/36d85b02cef2ca34253619acae35623989258277)

commit c927a34

Showing
**1 changed file**
with
**31 additions**
and
**14 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

45 changes: 31 additions & 14 deletions

45
[crypto/x509/v3\_ncons.c](#diff-926874b8f573cfb6a4fd510c7a3795edefe0d190fe5fbd8ec88b325c7ee1c4bf "crypto/x509/v3_ncons.c")

Show comments

[View file](/openssl/openssl/blob/c927a3492698c254637da836762f9b1f86cffabc/crypto/x509/v3_ncons.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -31,7 +31,8 @@ static int do\_i2r\_name\_constraints(const X509V3\_EXT\_METHOD \*method, |
|  |  | static int print\_nc\_ipadd(BIO \*bp, ASN1\_OCTET\_STRING \*ip); |
|  |  |  |
|  |  | static int nc\_match(GENERAL\_NAME \*gen, NAME\_CONSTRAINTS \*nc); |
|  |  | static int nc\_match\_single(GENERAL\_NAME \*sub, GENERAL\_NAME \*gen); |
|  |  | static int nc\_match\_single(int effective\_type, GENERAL\_NAME \*sub, |
|  |  | GENERAL\_NAME \*gen); |
|  |  | static int nc\_dn(const X509\_NAME \*sub, const X509\_NAME \*nm); |
|  |  | static int nc\_dns(ASN1\_IA5STRING \*sub, ASN1\_IA5STRING \*dns); |
|  |  | static int nc\_email(ASN1\_IA5STRING \*sub, ASN1\_IA5STRING \*eml); |
| Expand Down  Expand Up | | @@ -472,14 +473,17 @@ static int nc\_match(GENERAL\_NAME \*gen, NAME\_CONSTRAINTS \*nc) |
|  |  | { |
|  |  | GENERAL\_SUBTREE \*sub; |
|  |  | int i, r, match = 0; |
|  |  | int effective\_type = gen->type; |
|  |  |  |
|  |  | /\* |
|  |  | \* We need to compare not gen->type field but an "effective" type because |
|  |  | \* the otherName field may contain EAI email address treated specially |
|  |  | \* according to RFC 8398, section 6 |
|  |  | \*/ |
|  |  | int effective\_type = ((gen->type == GEN\_OTHERNAME) && |
|  |  | (OBJ\_obj2nid(gen->d.otherName->type\_id) == |
|  |  | NID\_id\_on\_SmtpUTF8Mailbox)) ? GEN\_EMAIL : gen->type; |
|  |  | if (effective\_type == GEN\_OTHERNAME && |
|  |  | (OBJ\_obj2nid(gen->d.otherName->type\_id) == NID\_id\_on\_SmtpUTF8Mailbox)) { |
|  |  | effective\_type = GEN\_EMAIL; |
|  |  | } |
|  |  |  |
|  |  | /\* |
|  |  | \* Permitted subtrees: if any subtrees exist of matching the type at |
| Expand All | | @@ -488,7 +492,10 @@ static int nc\_match(GENERAL\_NAME \*gen, NAME\_CONSTRAINTS \*nc) |
|  |  |  |
|  |  | for (i = 0; i < sk\_GENERAL\_SUBTREE\_num(nc->permittedSubtrees); i++) { |
|  |  | sub = sk\_GENERAL\_SUBTREE\_value(nc->permittedSubtrees, i); |
|  |  | if (effective\_type != sub->base->type) |
|  |  | if (effective\_type != sub->base->type |
|  |  | || (effective\_type == GEN\_OTHERNAME && |
|  |  | OBJ\_cmp(gen->d.otherName->type\_id, |
|  |  | sub->base->d.otherName->type\_id) != 0)) |
|  |  | continue; |
|  |  | if (!nc\_minmax\_valid(sub)) |
|  |  | return X509\_V\_ERR\_SUBTREE\_MINMAX; |
| Expand All | | @@ -497,7 +504,7 @@ static int nc\_match(GENERAL\_NAME \*gen, NAME\_CONSTRAINTS \*nc) |
|  |  | continue; |
|  |  | if (match == 0) |
|  |  | match = 1; |
|  |  | r = nc\_match\_single(gen, sub->base); |
|  |  | r = nc\_match\_single(effective\_type, gen, sub->base); |
|  |  | if (r == X509\_V\_OK) |
|  |  | match = 2; |
|  |  | else if (r != X509\_V\_ERR\_PERMITTED\_VIOLATION) |
| Expand All | | @@ -511,12 +518,15 @@ static int nc\_match(GENERAL\_NAME \*gen, NAME\_CONSTRAINTS \*nc) |
|  |  |  |
|  |  | for (i = 0; i < sk\_GENERAL\_SUBTREE\_num(nc->excludedSubtrees); i++) { |
|  |  | sub = sk\_GENERAL\_SUBTREE\_value(nc->excludedSubtrees, i); |
|  |  | if (effective\_type != sub->base->type) |
|  |  | if (effective\_type != sub->base->type |
|  |  | || (effective\_type == GEN\_OTHERNAME && |
|  |  | OBJ\_cmp(gen->d.otherName->type\_id, |
|  |  | sub->base->d.otherName->type\_id) != 0)) |
|  |  | continue; |
|  |  | if (!nc\_minmax\_valid(sub)) |
|  |  | return X509\_V\_ERR\_SUBTREE\_MINMAX; |
|  |  |  |
|  |  | r = nc\_match\_single(gen, sub->base); |
|  |  | r = nc\_match\_single(effective\_type, gen, sub->base); |
|  |  | if (r == X509\_V\_OK) |
|  |  | return X509\_V\_ERR\_EXCLUDED\_VIOLATION; |
|  |  | else if (r != X509\_V\_ERR\_PERMITTED\_VIOLATION) |
| Expand All | | @@ -528,15 +538,22 @@ static int nc\_match(GENERAL\_NAME \*gen, NAME\_CONSTRAINTS \*nc) |
|  |  |  |
|  |  | } |
|  |  |  |
|  |  | static int nc\_match\_single(GENERAL\_NAME \*gen, GENERAL\_NAME \*base) |
|  |  | static int nc\_match\_single(int effective\_type, GENERAL\_NAME \*gen, |
|  |  | GENERAL\_NAME \*base) |
|  |  | { |
|  |  | switch (gen->type) { |
|  |  | case GEN\_OTHERNAME: |
|  |  | /\* |
|  |  | \* We are here only when we have SmtpUTF8 name, |
|  |  | \* so we match the value of othername with base->d.rfc822Name |
|  |  | \*/ |
|  |  | return nc\_email\_eai(gen->d.otherName->value, base->d.rfc822Name); |
|  |  | switch (effective\_type) { |
|  |  | case GEN\_EMAIL: |
|  |  | /\* |
|  |  | \* We are here only when we have SmtpUTF8 name, |
|  |  | \* so we match the value of othername with base->d.rfc822Name |
|  |  | \*/ |
|  |  | return nc\_email\_eai(gen->d.otherName->value, base->d.rfc822Name); |
|  |  |  |
|  |  | default: |
|  |  | return X509\_V\_ERR\_UNSUPPORTED\_CONSTRAINT\_TYPE; |
|  |  | } |
|  |  |  |
|  |  | case GEN\_DIRNAME: |
|  |  | return nc\_dn(gen->d.directoryName, base->d.directoryName); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `c927a34`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenssl%2Fopenssl%2Fcommit%2Fc927a3492698c254637da836762f9b1f86cffabc) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from security.gentoo.org_b881b883_20250108_115258.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# OpenSSL: Multiple Vulnerabilities — GLSA **202402-08**

Multiple vulnerabilities have been found in OpenSSL, the worst of which could result in denial of service.

### Affected packages

| Package | **dev-libs/openssl** on all architectures |
| --- | --- |
| Affected versions | < **3.0.10** |
| Unaffected versions | >= **3.0.10** |

### Background

OpenSSL is an Open Source toolkit implementing the Secure Sockets Layer (SSL v2/v3) and Transport Layer Security (TLS v1) as well as a general purpose cryptography library.

### Description

Multiple vulnerabilities have been discovered in OpenSSL. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All OpenSSL users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=dev-libs/openssl-3.0.10"

```
### References

* [CVE-2022-3358](https://nvd.nist.gov/vuln/detail/CVE-2022-3358)
* [CVE-2022-4203](https://nvd.nist.gov/vuln/detail/CVE-2022-4203)
* [CVE-2022-4304](https://nvd.nist.gov/vuln/detail/CVE-2022-4304)
* [CVE-2022-4450](https://nvd.nist.gov/vuln/detail/CVE-2022-4450)
* [CVE-2023-0215](https://nvd.nist.gov/vuln/detail/CVE-2023-0215)
* [CVE-2023-0216](https://nvd.nist.gov/vuln/detail/CVE-2023-0216)
* [CVE-2023-0217](https://nvd.nist.gov/vuln/detail/CVE-2023-0217)
* [CVE-2023-0286](https://nvd.nist.gov/vuln/detail/CVE-2023-0286)
* [CVE-2023-0401](https://nvd.nist.gov/vuln/detail/CVE-2023-0401)
* [CVE-2023-0464](https://nvd.nist.gov/vuln/detail/CVE-2023-0464)
* [CVE-2023-0465](https://nvd.nist.gov/vuln/detail/CVE-2023-0465)
* [CVE-2023-0466](https://nvd.nist.gov/vuln/detail/CVE-2023-0466)
* [CVE-2023-2650](https://nvd.nist.gov/vuln/detail/CVE-2023-2650)
* [CVE-2023-2975](https://nvd.nist.gov/vuln/detail/CVE-2023-2975)
* [CVE-2023-3446](https://nvd.nist.gov/vuln/detail/CVE-2023-3446)
* [CVE-2023-3817](https://nvd.nist.gov/vuln/detail/CVE-2023-3817)

**Release date**

February 04, 2024

**Latest revision**

February 04, 2024: 1

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [876787](https://bugs.gentoo.org/show_bug.cgi?id=876787)
* [893446](https://bugs.gentoo.org/show_bug.cgi?id=893446)
* [902779](https://bugs.gentoo.org/show_bug.cgi?id=902779)
* [903545](https://bugs.gentoo.org/show_bug.cgi?id=903545)
* [907413](https://bugs.gentoo.org/show_bug.cgi?id=907413)
* [910556](https://bugs.gentoo.org/show_bug.cgi?id=910556)
* [911560](https://bugs.gentoo.org/show_bug.cgi?id=911560)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from www.openssl.org_8f85403c_20250108_115259.html ===
OpenSSL Security Advisory [7th February 2023]
=============================================
X.400 address type confusion in X.509 GeneralName (CVE-2023-0286)
=================================================================
Severity: High
There is a type confusion vulnerability relating to X.400 address processing
inside an X.509 GeneralName. X.400 addresses were parsed as an ASN1\_STRING but
the public structure definition for GENERAL\_NAME incorrectly specified the type
of the x400Address field as ASN1\_TYPE. This field is subsequently interpreted by
the OpenSSL function GENERAL\_NAME\_cmp as an ASN1\_TYPE rather than an
ASN1\_STRING.
When CRL checking is enabled (i.e. the application sets the
X509\_V\_FLAG\_CRL\_CHECK flag), this vulnerability may allow an attacker to pass
arbitrary pointers to a memcmp call, enabling them to read memory contents or
enact a denial of service. In most cases, the attack requires the attacker to
provide both the certificate chain and CRL, neither of which need to have a
valid signature. If the attacker only controls one of these inputs, the other
input must already contain an X.400 address as a CRL distribution point, which
is uncommon. As such, this vulnerability is most likely to only affect
applications which have implemented their own functionality for retrieving CRLs
over a network.
OpenSSL versions 3.0, 1.1.1 and 1.0.2 are vulnerable to this issue.
OpenSSL 3.0 users should upgrade to OpenSSL 3.0.8.
OpenSSL 1.1.1 users should upgrade to OpenSSL 1.1.1t.
OpenSSL 1.0.2 users should upgrade to OpenSSL 1.0.2zg (premium support customers
only).
This issue was reported on 11th January 2023 by David Benjamin (Google).
The fix was developed by Hugo Landau.
Timing Oracle in RSA Decryption (CVE-2022-4304)
===============================================
Severity: Moderate
A timing based side channel exists in the OpenSSL RSA Decryption implementation
which could be sufficient to recover a plaintext across a network in a
Bleichenbacher style attack. To achieve a successful decryption an attacker
would have to be able to send a very large number of trial messages for
decryption. The vulnerability affects all RSA padding modes: PKCS#1 v1.5,
RSA-OEAP and RSASVE.
For example, in a TLS connection, RSA is commonly used by a client to send an
encrypted pre-master secret to the server. An attacker that had observed a
genuine connection between a client and a server could use this flaw to send
trial messages to the server and record the time taken to process them. After a
sufficiently large number of messages the attacker could recover the pre-master
secret used for the original connection and thus be able to decrypt the
application data sent over that connection.
OpenSSL 3.0, 1.1.1 and 1.0.2 are vulnerable to this issue.
OpenSSL 3.0 users should upgrade to OpenSSL 3.0.8.
OpenSSL 1.1.1 users should upgrade to OpenSSL 1.1.1t.
OpenSSL 1.0.2 users should upgrade to OpenSSL 1.0.2zg (premium support customers
only).
An initial report of a possible timing side channel was made on 14th July 2020
by Hubert Kario (Red Hat). A refined report identifying a specific timing side
channel was made on 15th July 2022 by Hubert Kario.
The fix was developed by Dmitry Belyavsky (Red Hat) and Hubert Kario.
X.509 Name Constraints Read Buffer Overflow (CVE-2022-4203)
===========================================================
Severity: Moderate
A read buffer overrun can be triggered in X.509 certificate verification,
specifically in name constraint checking. Note that this occurs
after certificate chain signature verification and requires either a
CA to have signed the malicious certificate or for the application to
continue certificate verification despite failure to construct a path
to a trusted issuer.
The read buffer overrun might result in a crash which could lead to
a denial of service attack. In theory it could also result in the disclosure
of private memory contents (such as private keys, or sensitive plaintext)
although we are not aware of any working exploit leading to memory
contents disclosure as of the time of release of this advisory.
In a TLS client, this can be triggered by connecting to a malicious
server. In a TLS server, this can be triggered if the server requests
client authentication and a malicious client connects.
OpenSSL versions 3.0.0 to 3.0.7 are vulnerable to this issue.
OpenSSL 3.0 users should upgrade to OpenSSL 3.0.8.
OpenSSL 1.1.1 and 1.0.2 are not affected by this issue.
This issue was reported to OpenSSL on 3rd November 2022 by Corey Bonnell
from Digicert. The fix was developed by Viktor Dukhovni.
Use-after-free following BIO\_new\_NDEF (CVE-2023-0215)
=====================================================
Severity: Moderate
The public API function BIO\_new\_NDEF is a helper function used for streaming
ASN.1 data via a BIO. It is primarily used internally to OpenSSL to support the
SMIME, CMS and PKCS7 streaming capabilities, but may also be called directly by
end user applications.
The function receives a BIO from the caller, prepends a new BIO\_f\_asn1 filter
BIO onto the front of it to form a BIO chain, and then returns the new head of
the BIO chain to the caller. Under certain conditions, for example if a CMS
recipient public key is invalid, the new filter BIO is freed and the function
returns a NULL result indicating a failure. However, in this case, the BIO chain
is not properly cleaned up and the BIO passed by the caller still retains
internal pointers to the previously freed filter BIO. If the caller then goes on
to call BIO\_pop() on the BIO then a use-after-free will occur. This will most
likely result in a crash.
This scenario occurs directly in the internal function B64\_write\_ASN1() which
may cause BIO\_new\_NDEF() to be called and will subsequently call BIO\_pop() on
the BIO. This internal function is in turn called by the public API functions
PEM\_write\_bio\_ASN1\_stream, PEM\_write\_bio\_CMS\_stream, PEM\_write\_bio\_PKCS7\_stream,
SMIME\_write\_ASN1, SMIME\_write\_CMS and SMIME\_write\_PKCS7.
Other public API functions that may be impacted by this include
i2d\_ASN1\_bio\_stream, BIO\_new\_CMS, BIO\_new\_PKCS7, i2d\_CMS\_bio\_stream and
i2d\_PKCS7\_bio\_stream.
The OpenSSL cms and smime command line applications are similarly affected.
OpenSSL 3.0, 1.1.1 and 1.0.2 are vulnerable to this issue.
OpenSSL 3.0 users should upgrade to OpenSSL 3.0.8.
OpenSSL 1.1.1 users should upgrade to OpenSSL 1.1.1t.
OpenSSL 1.0.2 users should upgrade to OpenSSL 1.0.2zg (premium support customers
only).
This issue was reported on 29th November 2022 by Octavio Galland and
Marcel BÃ¶hme (Max Planck Institute for Security and Privacy). The fix was
developed by Viktor Dukhovni and Matt Caswell.
Double free after calling PEM\_read\_bio\_ex (CVE-2022-4450)
=========================================================
Severity: Moderate
The function PEM\_read\_bio\_ex() reads a PEM file from a BIO and parses and
decodes the "name" (e.g. "CERTIFICATE"), any header data and the payload data.
If the function succeeds then the "name\_out", "header" and "data" arguments are
populated with pointers to buffers containing the relevant decoded data. The
caller is responsible for freeing those buffers. It is possible to construct a
PEM file that results in 0 bytes of payload data. In this case PEM\_read\_bio\_ex()
will return a failure code but will populate the header argument with a pointer
to a buffer that has already been freed. If the caller also frees this buffer
then a double free will occur. This will most likely lead to a crash. This
could be exploited by an attacker who has the ability to supply malicious PEM
files for parsing to achieve a denial of service attack.
The functions PEM\_read\_bio() and PEM\_read() are simple wrappers around
PEM\_read\_bio\_ex() and therefore these functions are also directly affected.
These functions are also called indirectly by a number of other OpenSSL
functions including PEM\_X509\_INFO\_read\_bio\_ex() and
SSL\_CTX\_use\_serverinfo\_file() which are also vulnerable. Some OpenSSL internal
uses of these functions are not vulnerable because the caller does not free the
header argument if PEM\_read\_bio\_ex() returns a failure code. These locations
include the PEM\_read\_bio\_TYPE() functions as well as the decoders introduced in
OpenSSL 3.0.
The OpenSSL asn1parse command line application is also impacted by this issue.
OpenSSL 3.0 and 1.1.1 are vulnerable to this issue.
OpenSSL 3.0 users should upgrade to OpenSSL 3.0.8.
OpenSSL 1.1.1 users should upgrade to OpenSSL 1.1.1t.
OpenSSL 1.0.2 is not affected by this issue.
This issue was discovered by CarpetFuzz and reported on 8th December 2022 by
Dawei Wang. Independently reported by Marc SchÃ¶nefeld. The fix was developed by
Kurt Roeckx and Matt Caswell.
Invalid pointer dereference in d2i\_PKCS7 functions (CVE-2023-0216)
==================================================================
Severity: Moderate
An invalid pointer dereference on read can be triggered when an
application tries to load malformed PKCS7 data with the
d2i\_PKCS7(), d2i\_PKCS7\_bio() or d2i\_PKCS7\_fp() functions.
The result of the dereference is an application crash which could
lead to a denial of service attack. The TLS implementation in OpenSSL
does not call this function however third party applications might
call these functions on untrusted data.
OpenSSL versions 3.0.0 to 3.0.7 are vulnerable to this issue.
OpenSSL 3.0 users should upgrade to OpenSSL 3.0.8.
OpenSSL 1.1.1 and 1.0.2 are not affected by this issue.
This issue was reported on 27th December 2022 by Marc SchÃ¶nefeld.
The fix was developed by Tomas Mraz.
NULL dereference validating DSA public key (CVE-2023-0217)
==========================================================
Severity: Moderate
An invalid pointer dereference on read can be triggered when an
application tries to check a malformed DSA public key by the
EVP\_PKEY\_public\_check() function. This will most likely lead
to an application crash. This function can be called on public
keys supplied from untrusted sources which could allow an attacker
to cause a denial of service attack.
The TLS implementation in OpenSSL does not call this function
but applications might call the function if there are additional
security requirements imposed by standards such as FIPS 140-3.
OpenSSL versions 3.0.0 to 3.0.7 are vulnerable to this issue.
OpenSSL 3.0 users should upgrade to OpenSSL 3.0.8.
OpenSSL 1.1.1 and 1.0.2 are not affected by this issue.
This issue was reported on 27th December 2022 by Kurt Roeckx.
The fix was developed by Shane Lontis from Oracle.
NULL dereference during PKCS7 data verification (CVE-2023-0401)
===============================================================
Severity: Moderate
A NULL pointer can be dereferenced when signatures are being
verified on PKCS7 signed or signedAndEnveloped data. In case the hash
algorithm used for the signature is known to the OpenSSL library but
the implementation of the hash algorithm is not available the digest
initialization will fail. There is a missing check for the return
value from the initialization function which later leads to invalid
usage of the digest API most likely leading to a crash.
The unavailability of an algorithm can be caused by using FIPS
enabled configuration of providers or more commonly by not loading
the legacy provider.
PKCS7 data is processed by the SMIME library calls and also by the
time stamp (TS) library calls. The TLS implementation in OpenSSL does
not call these functions however third party applications would be
affected if they call these functions to verify signatures on untrusted
data.
OpenSSL versions 3.0.0 to 3.0.7 are vulnerable to this issue.
OpenSSL 3.0 users should upgrade to OpenSSL 3.0.8.
OpenSSL 1.1.1 and 1.0.2 are not affected by this issue.
This issue was reported on 13th January 2023 by Hubert Kario and
Dmitry Belyavsky (Red Hat).
The fix was developed by Tomas Mraz.
References
==========
URL for this Security Advisory:
https://www.openssl.org/news/secadv/20230207.txt
Note: the online version of the advisory may be updated with additional details
over time.
For details of OpenSSL severity classifications please see:
https://www.openssl.org/policies/general/security-policy.html


=== Content from github.com_53ef1c93_20250108_151515.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-w67w-mw4j-8qrv)

**CVE-2022-4203**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-w67w-mw4j-8qrv)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [GitHub Reviewed](/advisories?query=type%3Areviewed)
3. [CVE-2022-4203](/advisories/GHSA-w67w-mw4j-8qrv)

## openssl-src contains Read Buffer Overflow in X.509 Name Constraint

Critical severity

GitHub Reviewed

Published
Feb 8, 2023
to the GitHub Advisory Database
•
Updated Feb 5, 2024

[Vulnerability details](/advisories/GHSA-w67w-mw4j-8qrv)
[Dependabot alerts
0](/advisories/GHSA-w67w-mw4j-8qrv/dependabot)

## Package

cargo

openssl-src
([Rust](/advisories?query=ecosystem%3Arust))

## Affected versions

>= 300.0.0, < 300.0.12

## Patched versions

300.0.12

## Description

A read buffer overrun can be triggered in X.509 certificate verification, specifically in name constraint checking. Note that this occurs

after certificate chain signature verification and requires either a CA to have signed the malicious certificate or for the application to

continue certificate verification despite failure to construct a path to a trusted issuer.

The read buffer overrun might result in a crash which could lead to a denial of service attack. In theory it could also result in the disclosure of private memory contents (such as private keys, or sensitive plaintext) although we are not aware of any working exploit leading to memory contents disclosure as of the time of release of this advisory.

In a TLS client, this can be triggered by connecting to a malicious server. In a TLS server, this can be triggered if the server requests client authentication and a malicious client connects.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2022-4203>
* <https://rustsec.org/advisories/RUSTSEC-2023-0008.html>
* <https://www.openssl.org/news/secadv/20230207.txt>
* <https://git.openssl.org/gitweb/?p=openssl.git;a=commitdiff;h=c927a3492698c254637da836762f9b1f86cffabc>
* <https://security.gentoo.org/glsa/202402-08>

Published to the GitHub Advisory Database
Feb 8, 2023

Reviewed
Feb 8, 2023

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2022-4203)
Feb 24, 2023

Last updated
Feb 5, 2024

### Severity

Critical

9.1

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
None

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:H

### [EPSS score](https://www.first.org/epss/user-guide)

0.168%
 (54th percentile)

### Weaknesses

[CWE-125](/advisories?query=cwe%3A125)

### CVE ID

CVE-2022-4203

### GHSA ID

GHSA-w67w-mw4j-8qrv

### Source code

No known source code

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-w67w-mw4j-8qrv/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


