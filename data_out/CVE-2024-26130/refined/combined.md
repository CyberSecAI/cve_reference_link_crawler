=== Content from github.com_8b65caab_20250111_065728.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpyca%2Fcryptography%2Fpull%2F10423)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpyca%2Fcryptography%2Fpull%2F10423)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=pyca%2Fcryptography)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[pyca](/pyca)
/
**[cryptography](/pyca/cryptography)**
Public

* [Notifications](/login?return_to=%2Fpyca%2Fcryptography) You must be signed in to change notification settings
* [Fork
  1.6k](/login?return_to=%2Fpyca%2Fcryptography)
* [Star
   6.8k](/login?return_to=%2Fpyca%2Fcryptography)

* [Code](/pyca/cryptography)
* [Issues
  45](/pyca/cryptography/issues)
* [Pull requests
  8](/pyca/cryptography/pulls)
* [Actions](/pyca/cryptography/actions)
* [Security](/pyca/cryptography/security)
* [Insights](/pyca/cryptography/pulse)

Additional navigation options

* [Code](/pyca/cryptography)
* [Issues](/pyca/cryptography/issues)
* [Pull requests](/pyca/cryptography/pulls)
* [Actions](/pyca/cryptography/actions)
* [Security](/pyca/cryptography/security)
* [Insights](/pyca/cryptography/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fpyca%2Fcryptography%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fpyca%2Fcryptography%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Fixes #10422 -- don't crash when a PKCS#12 key and cert don't match #10423

 Merged

[reaperhulk](/reaperhulk)
merged 1 commit into
[pyca:main](/pyca/cryptography/tree/main "pyca/cryptography:main")
from
[alex:pkcs12-key-cert-mismatch](/alex/cryptography/tree/pkcs12-key-cert-mismatch "alex/cryptography:pkcs12-key-cert-mismatch")

Feb 19, 2024

 Merged

# [Fixes #10422 -- don't crash when a PKCS#12 key and cert don't match](#top) #10423

[reaperhulk](/reaperhulk)
merged 1 commit into
[pyca:main](/pyca/cryptography/tree/main "pyca/cryptography:main")
from
[alex:pkcs12-key-cert-mismatch](/alex/cryptography/tree/pkcs12-key-cert-mismatch "alex/cryptography:pkcs12-key-cert-mismatch")

Feb 19, 2024

+27

−0

[Conversation
0](/pyca/cryptography/pull/10423)
[Commits
1](/pyca/cryptography/pull/10423/commits)
[Checks
56](/pyca/cryptography/pull/10423/checks)
[Files changed
2](/pyca/cryptography/pull/10423/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![alex](https://avatars.githubusercontent.com/u/772?s=60&v=4)](/alex)

Copy link

Member

### @alex **[alex](/alex)** commented [Feb 19, 2024](#issue-2142731678)

 *No description provided.*

Sorry, something went wrong.

All reactions

[![@alex](https://avatars.githubusercontent.com/u/772?s=40&v=4)](/alex)

`[Fixes](/pyca/cryptography/pull/10423/commits/3e5fc0e30f708df624f28170bb8963b180ebf7e6 "Fixes #10422 -- don't crash when a PKCS#12 key and cert don't match") [pyca#10422](https://github.com/pyca/cryptography/issues/10422) [-- don't crash when a PKCS#12 key and cert don't match](/pyca/cryptography/pull/10423/commits/3e5fc0e30f708df624f28170bb8963b180ebf7e6 "Fixes #10422 -- don't crash when a PKCS#12 key and cert don't match")`

`[3e5fc0e](/pyca/cryptography/pull/10423/commits/3e5fc0e30f708df624f28170bb8963b180ebf7e6)`

 [![@alex](https://avatars.githubusercontent.com/u/772?s=40&u=7c00c7c8ac3691da556d7686e16ff08b797d4a38&v=4)](/alex)
[alex](/alex)
[force-pushed](/pyca/cryptography/compare/61a8fa47bd9e2d0446696f699419e26e77a80442..3e5fc0e30f708df624f28170bb8963b180ebf7e6)
the
pkcs12-key-cert-mismatch

branch
from
[`61a8fa4`](/pyca/cryptography/commit/61a8fa47bd9e2d0446696f699419e26e77a80442) to
[`3e5fc0e`](/pyca/cryptography/commit/3e5fc0e30f708df624f28170bb8963b180ebf7e6)  [Compare](/pyca/cryptography/compare/61a8fa47bd9e2d0446696f699419e26e77a80442..3e5fc0e30f708df624f28170bb8963b180ebf7e6)
[February 19, 2024 16:22](#event-11851990199)

[![reaperhulk](https://avatars.githubusercontent.com/u/161495?s=60&v=4)](/reaperhulk)

**[reaperhulk](/reaperhulk)**
approved these changes
[Feb 19, 2024](#pullrequestreview-1888867217)

 [View reviewed changes](/pyca/cryptography/pull/10423/files/3e5fc0e30f708df624f28170bb8963b180ebf7e6)

 Hide details
View details

[![@reaperhulk](https://avatars.githubusercontent.com/u/161495?s=40&u=5f0232a38e50d219b679bc014de04922fba33ae0&v=4)](/reaperhulk)
[reaperhulk](/reaperhulk)
merged commit [`97d2316`](/pyca/cryptography/commit/97d231672763cdb5959a3b191e692a362f1b9e55)
into
pyca:main

[Feb 19, 2024](https://github.com/pyca/cryptography/pull/10423#event-11852301732)
57 checks passed

 [![@alex](https://avatars.githubusercontent.com/u/772?s=40&u=7c00c7c8ac3691da556d7686e16ff08b797d4a38&v=4)](/alex)
[alex](/alex)
deleted the
pkcs12-key-cert-mismatch

branch
[February 19, 2024 16:54](#event-11852338595)

[![@alex](https://avatars.githubusercontent.com/u/772?s=40&u=7c00c7c8ac3691da556d7686e16ff08b797d4a38&v=4)](/alex)
[alex](/alex)
mentioned this pull request
[Feb 19, 2024](#ref-pullrequest-2142817177)

[Fixes #10422 -- don't crash when a PKCS#12 key and cert don't match (…
#10425](/pyca/cryptography/pull/10425)
 Merged

[alex](/alex)
added a commit
to alex/cryptography
that referenced
this pull request
[Feb 19, 2024](#ref-commit-9a2be4e)
[![@alex](https://avatars.githubusercontent.com/u/772?s=40&u=7c00c7c8ac3691da556d7686e16ff08b797d4a38&v=4)](/alex)

`[Fixes](/alex/cryptography/commit/9a2be4e2d38ab8631ff3f2e71757265ab6e064fc "Fixes #10422 -- don't crash when a PKCS#12 key and cert don't match (#10423)") [pyca#10422](https://github.com/pyca/cryptography/issues/10422) [-- don't crash when a PKCS#12 key and cert don't mat…](/alex/cryptography/commit/9a2be4e2d38ab8631ff3f2e71757265ab6e064fc "Fixes #10422 -- don't crash when a PKCS#12 key and cert don't match (#10423)")`
…

`[9a2be4e](/alex/cryptography/commit/9a2be4e2d38ab8631ff3f2e71757265ab6e064fc)`

```
…ch ([pyca#10423](https://github.com/pyca/cryptography/pull/10423))
```

[reaperhulk](/reaperhulk)
pushed a commit
that referenced
this pull request
[Feb 19, 2024](#ref-commit-7a4d012)
[![@alex](https://avatars.githubusercontent.com/u/772?s=40&u=7c00c7c8ac3691da556d7686e16ff08b797d4a38&v=4)](/alex)

`[Fixes](/pyca/cryptography/commit/7a4d012991061974da5d9cb7614de65eac94f49b "Fixes #10422 -- don't crash when a PKCS#12 key and cert don't match (#10423) (#10425)") [#10422](https://github.com/pyca/cryptography/issues/10422) [-- don't crash when a PKCS#12 key and cert don't match (](/pyca/cryptography/commit/7a4d012991061974da5d9cb7614de65eac94f49b "Fixes #10422 -- don't crash when a PKCS#12 key and cert don't match (#10423) (#10425)")[#…](https://github.com/pyca/cryptography/pull/10423)`
…

`[7a4d012](/pyca/cryptography/commit/7a4d012991061974da5d9cb7614de65eac94f49b)`

```
[…10423](https://github.com/pyca/cryptography/pull/10423)) ([#10425](https://github.com/pyca/cryptography/pull/10425))
```

[![@GoVulnBot](https://avatars.githubusercontent.com/u/96493708?s=40&v=4)](/GoVulnBot)
[GoVulnBot](/GoVulnBot)
mentioned this pull request
[Feb 21, 2024](#ref-issue-2147382877)

[x/vulndb: potential Go vuln in github.com/pyca/cryptography: CVE-2024-26130
golang/vulndb#2573](/golang/vulndb/issues/2573)

Closed

[![@sniffler-app](https://avatars.githubusercontent.com/in/135474?s=40&v=4)](/apps/sniffler-app)
[sniffler-app](/apps/sniffler-app)
bot
mentioned this pull request
[Feb 21, 2024](#ref-issue-2147624217)

[cryptography NULL pointer deference with pkcs12.serialize\_key\_and\_certificates when called with a non-matching certificate and private key and an hmac\_hash override
lightspeed-hospitality/pre-commit-hooks#79](/lightspeed-hospitality/pre-commit-hooks/issues/79)

Open

This was referenced Feb 22, 2024

[chore(deps): update dependency twistedpair/google-cloud-sdk to v465
uniget-org/tools#3215](/uniget-org/tools/pull/3215)
 Merged

[changes to create demo on python-anywhere.com
jaihind213/radio-duck#16](/jaihind213/radio-duck/pull/16)
 Closed

[chore(deps): update dependency twistedpair/google-cloud-sdk to v466
uniget-org/tools#3310](/uniget-org/tools/pull/3310)
 Merged

This was referenced Mar 5, 2024

[chore(deps): update dependency twistedpair/google-cloud-sdk to v467
uniget-org/tools#3426](/uniget-org/tools/pull/3426)
 Merged

[simplifying docker build
jaihind213/radio-duck#17](/jaihind213/radio-duck/pull/17)
 Merged

[chore(deps): update dependency twistedpair/google-cloud-sdk to v468
uniget-org/tools#3582](/uniget-org/tools/pull/3582)
 Merged

This was referenced Mar 20, 2024

[chore(deps): update dependency twistedpair/google-cloud-sdk to v469
uniget-org/tools#3737](/uniget-org/tools/pull/3737)
 Merged

[Add cves and recommendation docker scout commands
ashenm/workspace#79](/ashenm/workspace/pull/79)
 Closed

[chore(deps): update dependency twistedpair/google-cloud-sdk to v470
uniget-org/tools#3845](/uniget-org/tools/pull/3845)
 Merged

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
mentioned this pull request
[Apr 2, 2024](#ref-pullrequest-2220945121)

[chore(deps): update dependency twistedpair/google-cloud-sdk to v471
uniget-org/tools#3954](/uniget-org/tools/pull/3954)
 Merged

1 task

[![@colons](https://avatars.githubusercontent.com/u/1394710?s=40&v=4)](/colons)
[colons](/colons)
mentioned this pull request
[Apr 13, 2024](#ref-pullrequest-2159963160)

[overrides: add hash for cryptography 42.0.5
nix-community/poetry2nix#1541](/nix-community/poetry2nix/pull/1541)
 Closed

This was referenced Apr 13, 2024

[Test
Khagou/khagu-devops#29](/Khagou/khagu-devops/pull/29)
 Closed

[Test2
Khagou/khagu-devops#30](/Khagou/khagu-devops/pull/30)
 Closed

[Test
Khagou/khagu-devops#31](/Khagou/khagu-devops/pull/31)
 Closed

[Test
Khagou/khagu-devops#32](/Khagou/khagu-devops/pull/32)
 Closed

[Test
Khagou/khagu-devops#33](/Khagou/khagu-devops/pull/33)
 Closed

[should fix ssl pour back
Khagou/khagu-devops#34](/Khagou/khagu-devops/pull/34)
 Open

[chore(deps): update dependency twistedpair/google-cloud-sdk to v472
uniget-org/tools#4207](/uniget-org/tools/pull/4207)
 Merged

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
mentioned this pull request
[Apr 23, 2024](#ref-pullrequest-2259298524)

[chore(deps): update dependency twistedpair/google-cloud-sdk to v473
uniget-org/tools#4331](/uniget-org/tools/pull/4331)
 Merged

1 task

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
mentioned this pull request
[Apr 30, 2024](#ref-pullrequest-2271986130)

[chore(deps): update dependency twistedpair/google-cloud-sdk to v474
uniget-org/tools#4464](/uniget-org/tools/pull/4464)
 Merged

1 task

This was referenced May 7, 2024

[chore(deps): update dependency twistedpair/google-cloud-sdk to v475
uniget-org/tools#4590](/uniget-org/tools/pull/4590)
 Merged

[feat: add php
windmill-labs/windmill#3725](/windmill-labs/windmill/pull/3725)
 Merged

This was referenced Jun 28, 2024

[[Snyk] Security upgrade python from 3.11.8-slim-bookworm to 3.13.0b2-slim-bookworm
windmill-labs/windmill#3998](/windmill-labs/windmill/pull/3998)
 Closed

[[Snyk] Security upgrade python from 3.11.8-slim-bookworm to 3.12.4-slim-bookworm
windmill-labs/windmill#4018](/windmill-labs/windmill/pull/4018)
 Closed

[[Snyk] Security upgrade python from 3.11.8-slim-bookworm to 3.11.9-slim-bookworm
windmill-labs/windmill#4026](/windmill-labs/windmill/pull/4026)
 Closed

This was referenced Jul 12, 2024

[[Snyk] Security upgrade python from 3.11.8-slim-bookworm to 3.12.4-slim-bookworm
windmill-labs/windmill#4067](/windmill-labs/windmill/pull/4067)
 Closed

[rhel9 binaries
windmill-labs/windmill#4086](/windmill-labs/windmill/pull/4086)
 Merged

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
mentioned this pull request
[Jul 24, 2024](#ref-pullrequest-2426555909)

[[Snyk] Security upgrade python from 3.11.8-slim-bookworm to slim-bookworm
windmill-labs/windmill#4123](/windmill-labs/windmill/pull/4123)
 Closed

This was referenced Aug 7, 2024

[[Snyk] Security upgrade python from 3.11.8-slim-bookworm to 3.13.0rc1-slim-bookworm
windmill-labs/windmill#4204](/windmill-labs/windmill/pull/4204)
 Closed

[[Snyk] Security upgrade python from 3.11.8-slim-bookworm to 3.12.4-slim-bookworm
windmill-labs/windmill#4224](/windmill-labs/windmill/pull/4224)
 Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fpyca%2Fcryptography%2Fpull%2F10423)

Reviewers

[![@reaperhulk](https://avatars.githubusercontent.com/u/161495?s=40&v=4)](/reaperhulk) [reaperhulk](/reaperhulk)

reaperhulk approved these changes

Assignees

No one assigned

Labels

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

2 participants

[![@alex](https://avatars.githubusercontent.com/u/772?s=52&v=4)](/alex) [![@reaperhulk](https://avatars.githubusercontent.com/u/161495?s=52&v=4)](/reaperhulk)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_b53ddba5_20250111_065727.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpyca%2Fcryptography%2Fcommit%2F97d231672763cdb5959a3b191e692a362f1b9e55)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpyca%2Fcryptography%2Fcommit%2F97d231672763cdb5959a3b191e692a362f1b9e55)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=pyca%2Fcryptography)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[pyca](/pyca)
/
**[cryptography](/pyca/cryptography)**
Public

* [Notifications](/login?return_to=%2Fpyca%2Fcryptography) You must be signed in to change notification settings
* [Fork
  1.6k](/login?return_to=%2Fpyca%2Fcryptography)
* [Star
   6.8k](/login?return_to=%2Fpyca%2Fcryptography)

* [Code](/pyca/cryptography)
* [Issues
  45](/pyca/cryptography/issues)
* [Pull requests
  8](/pyca/cryptography/pulls)
* [Actions](/pyca/cryptography/actions)
* [Security](/pyca/cryptography/security)
* [Insights](/pyca/cryptography/pulse)

Additional navigation options

* [Code](/pyca/cryptography)
* [Issues](/pyca/cryptography/issues)
* [Pull requests](/pyca/cryptography/pulls)
* [Actions](/pyca/cryptography/actions)
* [Security](/pyca/cryptography/security)
* [Insights](/pyca/cryptography/pulse)

## Commit

[Permalink](/pyca/cryptography/commit/97d231672763cdb5959a3b191e692a362f1b9e55)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fixes [#10422](https://github.com/pyca/cryptography/issues/10422) -- don't crash when a PKCS#12 key and cert don't match ([#…](https://github.com/pyca/cryptography/pull/10423)

[Browse files](/pyca/cryptography/tree/97d231672763cdb5959a3b191e692a362f1b9e55)
Browse the repository at this point in the history

```
[…10423](https://github.com/pyca/cryptography/pull/10423))
```

* Loading branch information

[![@alex](https://avatars.githubusercontent.com/u/772?s=40&v=4)](/alex)

[alex](/pyca/cryptography/commits?author=alex "View all commits by alex")
authored
Feb 19, 2024

1 parent
[4398f19](/pyca/cryptography/commit/4398f19e0700ffb1bb1e13be4f8efe7271feb62a)

commit 97d2316

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**27 additions**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src/cryptography/hazmat/backends/openssl

  + src/cryptography/hazmat/backends/openssl/backend.py
    [backend.py](#diff-f5134bf8f3cf0a5cc8601df55e50697acc866c603a38caff98802bd8e17976c5)
* tests/hazmat/primitives

  + tests/hazmat/primitives/test\_pkcs12.py
    [test\_pkcs12.py](#diff-9c52aef0f5f42c047d52e1c6c36a03416d83bb209f955e002912f63400d23f4b)

## There are no files selected for viewing

9 changes: 9 additions & 0 deletions

9
[src/cryptography/hazmat/backends/openssl/backend.py](#diff-f5134bf8f3cf0a5cc8601df55e50697acc866c603a38caff98802bd8e17976c5 "src/cryptography/hazmat/backends/openssl/backend.py")

Show comments

[View file](/pyca/cryptography/blob/97d231672763cdb5959a3b191e692a362f1b9e55/src/cryptography/hazmat/backends/openssl/backend.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -623,6 +623,15 @@ def serialize\_key\_and\_certificates\_to\_pkcs12( |
|  |  | mac\_iter, |
|  |  | 0, |
|  |  | ) |
|  |  | if p12 == self.\_ffi.NULL: |
|  |  | errors = self.\_consume\_errors() |
|  |  | raise ValueError( |
|  |  | ( |
|  |  | "Failed to create PKCS12 (does the key match the " |
|  |  | "certificate?)" |
|  |  | ), |
|  |  | errors, |
|  |  | ) |
|  |  |  |
|  |  | if ( |
|  |  | self.\_lib.Cryptography\_HAS\_PKCS12\_SET\_MAC |
| Expand Down | |  |

18 changes: 18 additions & 0 deletions

18
[tests/hazmat/primitives/test\_pkcs12.py](#diff-9c52aef0f5f42c047d52e1c6c36a03416d83bb209f955e002912f63400d23f4b "tests/hazmat/primitives/test_pkcs12.py")

Show comments

[View file](/pyca/cryptography/blob/97d231672763cdb5959a3b191e692a362f1b9e55/tests/hazmat/primitives/test_pkcs12.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -660,6 +660,24 @@ def test\_key\_serialization\_encryption\_set\_mac\_unsupported( |
|  |  | b"name", cakey, cacert, [], algorithm |
|  |  | ) |
|  |  |  |
|  |  | @pytest.mark.supported( |
|  |  | only\_if=lambda backend: backend.\_lib.Cryptography\_HAS\_PKCS12\_SET\_MAC, |
|  |  | skip\_message="Requires OpenSSL with PKCS12\_set\_mac", |
|  |  | ) |
|  |  | def test\_set\_mac\_key\_certificate\_mismatch(self, backend): |
|  |  | cacert, \_ = \_load\_ca(backend) |
|  |  | key = ec.generate\_private\_key(ec.SECP256R1()) |
|  |  | encryption = ( |
|  |  | serialization.PrivateFormat.PKCS12.encryption\_builder() |
|  |  | .hmac\_hash(hashes.SHA256()) |
|  |  | .build(b"password") |
|  |  | ) |
|  |  |  |
|  |  | with pytest.raises(ValueError): |
|  |  | serialize\_key\_and\_certificates( |
|  |  | b"name", key, cacert, [], encryption |
|  |  | ) |
|  |  |  |
|  |  |  |
|  |  | @pytest.mark.skip\_fips( |
|  |  | reason="PKCS12 unsupported in FIPS mode. So much bad crypto in it." |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `97d2316`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpyca%2Fcryptography%2Fcommit%2F97d231672763cdb5959a3b191e692a362f1b9e55) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_a6955ec1_20250111_065729.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpyca%2Fcryptography%2Fsecurity%2Fadvisories%2FGHSA-6vqw-3v5j-54x4)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpyca%2Fcryptography%2Fsecurity%2Fadvisories%2FGHSA-6vqw-3v5j-54x4)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=pyca%2Fcryptography)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[pyca](/pyca)
/
**[cryptography](/pyca/cryptography)**
Public

* [Notifications](/login?return_to=%2Fpyca%2Fcryptography) You must be signed in to change notification settings
* [Fork
  1.6k](/login?return_to=%2Fpyca%2Fcryptography)
* [Star
   6.8k](/login?return_to=%2Fpyca%2Fcryptography)

* [Code](/pyca/cryptography)
* [Issues
  45](/pyca/cryptography/issues)
* [Pull requests
  8](/pyca/cryptography/pulls)
* [Actions](/pyca/cryptography/actions)
* [Security](/pyca/cryptography/security)
* [Insights](/pyca/cryptography/pulse)

Additional navigation options

* [Code](/pyca/cryptography)
* [Issues](/pyca/cryptography/issues)
* [Pull requests](/pyca/cryptography/pulls)
* [Actions](/pyca/cryptography/actions)
* [Security](/pyca/cryptography/security)
* [Insights](/pyca/cryptography/pulse)

# NULL pointer deference with pkcs12.serialize\_key\_and\_certificates when called with a non-matching certificate and private key and an hmac\_hash override

Moderate

[alex](/alex)
published
GHSA-6vqw-3v5j-54x4
Feb 21, 2024

## Package

pip

cryptography
([pip](/advisories?query=ecosystem%3Apip))

## Affected versions

>=38.0.0

## Patched versions

>=42.0.4

## Description

If `pkcs12.serialize_key_and_certificates` is called with both:

1. A certificate whose public key did not match the provided private key
2. An `encryption_algorithm` with `hmac_hash` set (via `PrivateFormat.PKCS12.encryption_builder().hmac_hash(...)`

Then a NULL pointer dereference would occur, crashing the Python process.

This has been resolved, and now a `ValueError` is properly raised.

Patched in [#10423](https://github.com/pyca/cryptography/pull/10423)

### Severity

Moderate

### CVE ID

CVE-2024-26130

### Weaknesses

[CWE-476](/advisories?query=cwe%3A476)

### Credits

* [![@Alexander-Programming](https://avatars.githubusercontent.com/u/156447091?s=40&v=4)](/Alexander-Programming)
  [Alexander-Programming](/Alexander-Programming)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


