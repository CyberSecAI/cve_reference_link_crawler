

[Log in](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-19999)[Skip to main content](#main)[Skip to sidebar](#sidebar)Linked ApplicationsLoadingâ€¦[![XWiki.org JIRA](/s/-65z3d2/930000/8ws80b/_/jira-logo-scaled.png)](https://jira.xwiki.org/secure/MyJiraHome.jspa)

* [Dashboards](/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/secure/BrowseProjects.jspa "View recent projects and browse a list of projects")
* [Issues](/issues/ "Search for issues and view recent issues")

* Give feedback to Atlassian
* [Help](https://docs.atlassian.com/jira/jcore-docs-093/ "Help")
  + [Jira Core help](https://docs.atlassian.com/jira/jcore-docs-093/ "Go to the online documentation for Jira Core")
  + [Keyboard Shortcuts](/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [About Jira](/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-19999)

![Uploaded image for project: 'XWiki Platform'](https://jira.xwiki.org/secure/projectavatar?pid=10010&avatarId=13602)

1. [XWiki Platform](/browse/XWIKI)
2. [XWIKI-19999](/browse/XWIKI-19999)

# Livetable results allow reconstructing title, content and object fields of inaccessible documents with many requests

[Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-19999 "Log In")ClosedExportnull

XMLWordPrintable
#### Details

* **Type:**
  ![](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.") Bug
* **Resolution:**
  Fixed
* **Priority:**
  ![](/images/icons/priorities/blocker.svg "Blocker - Blocks development and/or testing work, production could not run.") Blocker
* **Fix Version/s:**
  [14.6-rc-1](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+14.6-rc-1 "14.6-rc-1 "), [13.10.8](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+13.10.8 "13.10.8 "), [14.4.3](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+14.4.3 "14.4.3 ")
* **Affects Version/s:**
  12.10.11, 13.9-rc-1, 13.4.4
* **Component/s:**
  [LiveTable](/issues/?jql=project+%3D+XWIKI+AND+component+%3D+LiveTable "LiveTable ")
* **Labels:**
  + [attack\_dataleak](/issues/?jql=labels+%3D+attack_dataleak "attack_dataleak")
  + [attacker\_view](/issues/?jql=labels+%3D+attacker_view "attacker_view")
  + [security](/issues/?jql=labels+%3D+security "security")

* **Difficulty:**
  Unknown
* **Documentation:**
  N/A
* **Documentation in Release Notes:**
  N/A
* **Similar issues:**

#### Description

**Steps to Reproduce:**

1. Restrict "view" access to Sandbox.TestPage3 by setting an explicit view right for admins
2. As a user who is not an admin, open <server>/bin/get/XWiki/LiveTableResults?outputSyntax=plain&classname=&collist=doc.title%2Cdoc.location%2Cdoc.content&doc.title=Sandbo&doc.location=Sandbox.TestPage3&doc.content=dummy&limit=0 where <server> is the URL of your XWiki installation.

**Expect Result:**

No results are displayed as the user doesn't have view rights on Sandbox.TestPage3.

**Actual Result:**

The result

```
{"reqNo":null,"matchingtags":{},"tags":[],"totalrows":1,"returnedrows":0,"offset":1,"rows":[{"doc_viewable":false,"doc_fullName":"obfuscated"}]}

```

is displayed.

This reveals that a document Sandbox.TestPage3 exists (we explicitly searched for this name) which has a title containing "Sandbo" and a content containing "dummy". By starting with a single letter and then iteratively extending the match, the full content of the title/content or XObject properties can be discovered. Several tests can be combined in a single request to use binary search to narrow down the actual match from a list of possible characters/words. If the used alphabet is known and smaller than 128 distinct characters, it is possible to discover one character with 7 requests. Alternatively, frequencies of words and word pairs (2-gram frequencies) can be used to first guess whole words and only resort to guessing individual characters if none of the predicted words match, allowing a much faster recovery of the textual content. As it also depends on the content how easy the attack is and how much recovered content would be a "successful" attack, it is hard to quantify how many requests are necessary.

The issue has been reproduced on 14.5 but is most likely older.

#### Attachments

#### Issue Links

links to

![Web Link](https://github.com/favicon.ico "Web Link")
[Github Security advisory](https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-p2x4-6ghr-6vmq)

#### Activity

#### People

Assignee:

![mleduc](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Manuel Leduc

Reporter:

![MichaelHamann](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Michael Hamann

Votes:
0
Vote for this issue

Watchers:
1
Start watching this issue

#### Dates

Created:

11/Jul/22 15:38

Updated:

21/Nov/22 10:29

Resolved:

12/Jul/22 14:14

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/secure/CreateIssue%21default.jspa)

Powered by a free Atlassian [Jira](http://www.atlassian.com/software/jira) open source license for XWiki.org. Try Jira - [bug tracking software](http://www.atlassian.com/software/jira) for *your* team.

[Atlassian](http://www.atlassian.com/)

