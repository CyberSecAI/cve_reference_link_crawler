Page Menu[HomeMiraheze](/)

* SearchConfigure Global Search

[Log In](https://issue-tracker.miraheze.org/auth/start/?next=%2FT12701)[Create Task](/maniphest/task/edit/nocreate/) [Maniphest](/maniphest/)  T12701
# Users may impersonate import requesters if their actor IDs coincideClosed, Resolved[Public](/policy/explain/PHID-TASK-vqwxonhfktlqxdlzbtsw/view/)Actions

* [Edit Task](/maniphest/task/edit/12701/)
* Edit Related Tasks...
* [Create Subtask](/maniphest/task/subtask/12701/)
* [Edit Parent Tasks](/search/rel/task.has-parent/PHID-TASK-vqwxonhfktlqxdlzbtsw/)
* [Edit Subtasks](/search/rel/task.has-subtask/PHID-TASK-vqwxonhfktlqxdlzbtsw/)
* [Merge Duplicates In](/search/rel/task.merge-in/PHID-TASK-vqwxonhfktlqxdlzbtsw/)
* [Close As Duplicate](/search/rel/task.close-as-duplicate/PHID-TASK-vqwxonhfktlqxdlzbtsw/)
* Edit Related Objects...
* [Edit Commits](/search/rel/task.has-commit/PHID-TASK-vqwxonhfktlqxdlzbtsw/)
* [Edit Revisions](/search/rel/task.has-revision/PHID-TASK-vqwxonhfktlqxdlzbtsw/)
* Subscribe
* [Mute Notifications](/subscriptions/mute/PHID-TASK-vqwxonhfktlqxdlzbtsw/)
* [Flag For Later](/flag/edit/PHID-TASK-vqwxonhfktlqxdlzbtsw/)
* [Award Token](/token/give/PHID-TASK-vqwxonhfktlqxdlzbtsw/)

Assigned To

|  | [BlankEclair](/p/BlankEclair/) |
| --- | --- |

Authored By

|  | [BlankEclair](/p/BlankEclair/) |
| --- | --- |
| Oct 4 2024, 14:532024-10-04 14:53:50 (UTC+0) |

Tags

* [Security](/tag/security/) [(Backlog)](/project/board/58/)
* [Technology-Team (MediaWiki)](/tag/technology-team_mediawiki/) [(Backlog)](/project/board/62/)
* [ImportDump](/tag/importdump/) [(Bugs)](/project/board/77/)
Referenced Files

|  | [F3948514: importdump-actor-ids.mp4](/F3948514) |
| --- | --- |
| Oct 4 2024, 14:532024-10-04 14:53:50 (UTC+0) |

Subscribers

|  | [Agent\_Isai](/p/Agent_Isai/) |
| --- | --- |

|  | [BlankEclair](/p/BlankEclair/) |
| --- | --- |

|  | [BrandonWM](/p/BrandonWM/) |
| --- | --- |

|  | [RhinosF1](/p/RhinosF1/) |
| --- | --- |

|  | [Universal\_Omega](/p/Universal_Omega/) |
| --- | --- |

|  | [Void](/p/Void/) |
| --- | --- |

# Description

Special:RequestImportQueue is still enabled on all wikis. However, the user's *local* actor ID is stored in the database to tell who made what requests. Therefore, if a user on another wiki happens to have the same actor ID as someone on metawiki, the user on the other wiki can act as if they're the original wiki requester.

For example, a user called... User from mw142.icecone.internal requested an import. However, another user called Vandal2 from uwu.mw142.icecone.internal happens to have the same local actor ID as User from mw142.icecone.internal. Thus, they can act on the import request as if they're User:

This is similar to <https://github.com/miraheze/CreateWiki/security/advisories/GHSA-89fx-77w7-rc64>, except this case is for actor IDs, while that one is for user IDs.

Advisory: <https://github.com/miraheze/ImportDump/security/advisories/GHSA-jjmq-mg36-6387>

### Event Timeline

[BlankEclair](/p/BlankEclair/) created this task.[Oct 4 2024, 14:532024-10-04 14:53:50 (UTC+0)](#254713)[Herald](/herald/) added subscribers: [Agent\_Isai](/p/Agent_Isai/), [Universal\_Omega](/p/Universal_Omega/), [Void](/p/Void/).  · [View Herald Transcript](/herald/transcript/159725/)[Oct 4 2024, 14:532024-10-04 14:53:50 (UTC+0)](#254723)[BlankEclair](/p/BlankEclair/) moved this task from [Backlog](/project/board/77/) to [Bugs](/project/board/77/) on the [ImportDump](/tag/importdump/) board.[Oct 4 2024, 14:542024-10-04 14:54:05 (UTC+0)](#254724)

[BlankEclair](/p/BlankEclair/) added a comment.Edited · [Oct 4 2024, 15:082024-10-04 15:08:09 (UTC+0)](#254725)Comment Actions

Not gonna make the advisory today, *maybe* tomorrow

Feel free to beat me

[BlankEclair](/p/BlankEclair/) added a subscriber: [RhinosF1](/p/RhinosF1/).[Oct 4 2024, 15:352024-10-04 15:35:20 (UTC+0)](#254726)

[Universal\_Omega](/p/Universal_Omega/) added a comment.[Oct 4 2024, 19:352024-10-04 19:35:00 (UTC+0)](#254741)Comment Actions

This shouldn't be an issue in CW since you can only access RWQ from the global wiki, for ImportDump we just need to add:

```
$dbr = $this->connectionProvider->getReplicaDatabase( 'virtual-importdump' );
		if ( !WikiMap::isCurrentWikiDbDomain( $dbr->getDomainID() ) ) {
			throw new ErrorPageError( 'importdump-notcentral', 'importdump-notcentral-text' );
		}
```

to RequestImportQueue like we do RequestImport, don't we?

[Universal\_Omega](/p/Universal_Omega/) added a comment.[Oct 4 2024, 19:362024-10-04 19:36:27 (UTC+0)](#254742)Comment Actions

Its only meant to use central wiki hence why we don't use central ids here because we only really care about the wiki you request from as it shouldn't be possible to do anything from other wikis, and that is indeed the issue here.

[BlankEclair](/p/BlankEclair/) claimed this task.[Oct 5 2024, 01:442024-10-05 01:44:54 (UTC+0)](#254760)[BlankEclair](/p/BlankEclair/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-rieo42cken6ak62/)[Oct 5 2024, 02:192024-10-05 02:19:35 (UTC+0)](#254761)[Universal\_Omega](/p/Universal_Omega/) closed this task as Resolved.[Oct 9 2024, 02:062024-10-09 02:06:27 (UTC+0)](#255435)[Universal\_Omega](/p/Universal_Omega/) changed the visibility from "[Custom Policy](/transactions/old/PHID-XACT-TASK-hji27f6kxblj6eg/)" to "Public (No Login Required)".[Herald](/herald/) added a subscriber: [BrandonWM](/p/BrandonWM/).  · [View Herald Transcript](/herald/transcript/160079/)[Oct 9 2024, 02:062024-10-09 02:06:27 (UTC+0)](#255437)[Log In to Comment](/login/?next=%2FT12701)