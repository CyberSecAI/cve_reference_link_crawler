<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us" dir="ltr">
<head>
<title>2023/06/30: SE202301: Security Advisory: CVE-2023-27395 etc: Fixed 6 vulnerabilities of SoftEther VPN in cooperation with Cisco Systems, Inc. - SoftEther VPN Project</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<meta name="robots" content="index,follow" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="alternate" type="application/rss+xml" title="What's new feed" href="/index.php?title=Special:Recentchanges&amp;feed=rss" />
<link rel="alternate" type="application/rss+xml" title="Page and subpages changes feed" href="/index.php?title=Special:Article&amp;type=feed&amp;feedtype=subpagechanges&amp;pageid=523" />
<link rel="alternate" type="application/rss+xml" title="Page changes feed" href="/index.php?title=Special:Article&amp;type=feed&amp;pageid=523" />
<meta name="generator" content="MindTouch Core" />
<link rel="search" type="application/opensearchdescription+xml" title="SoftEther VPN Project Search" href="/deki/gui/opensearch.php?type=description" /><link rel="stylesheet" type="text/css" media="screen" href="/skins/common/reset.css" /><link rel="stylesheet" type="text/css" media="screen" href="/skins/common/css.php" /> <!--[if IE 7]><style type="text/css">@import "/skins/common/_ie7.css";</style><![endif]--><!--[if IE 6]><style type="text/css">@import "/skins/common/_ie.css";</style><![endif]--><!--[if IE 7]><link href="/skins/deuce/lighty-blue/ie7.css" rel="stylesheet" type="text/css" /><![endif]-->
<!--[if IE 6]><link href="/skins/deuce/lighty-blue/ie6.css" rel="stylesheet" type="text/css" /><![endif]-->
<link href="/skins/deuce/lighty-blue/css.php" media="screen" rel="stylesheet" type="text/css" />
<link rel="stylesheet" type="text/css" media="print" href="/skins/common/print.css" /><link rel="stylesheet" type="text/css" media="print" href="/skins/deuce/print.css" />
<script type="text/javascript">CKEDITOR_BASEPATH = "/deki/plugins/page_editor_ckeditor/ckeditor/";</script>
<script type="text/javascript" src="/skins/common/js.php?perms=LOGIN,BROWSE,READ,SUBSCRIBE"></script>	<script type="text/javascript">

		var aLt = aLt || [];aLt["attach-no-description"] = 'No description'; aLt["cancel"] = 'Cancel'; aLt["close"] = 'Close'; aLt["comment-delete"] = 'Are you sure you want to delete this comment?'; aLt["contentrating-title-popup"] = 'Thanks for your feedback'; aLt["error"] = 'Error'; aLt["error-permission-denied"] = 'Permission denied'; aLt["error-permission-details"] = 'Your account does not have sufficient permissions to perform that action.'; aLt["gallery-close"] = 'close'; aLt["gallery-next"] = 'next'; aLt["gallery-prev"] = 'prev'; aLt["internal-error"] = 'Sorry, but there was an internal problem - please try again soon.'; aLt["js-label_cancel"] = 'Cancel'; aLt["js-label_save"] = 'Save'; aLt["js-tooltip_cancel"] = 'Exit Without Saving Changes'; aLt["js-tooltip_save"] = 'Save and Exit (Alt+S)'; aLt["ldap-provide-credentials"] = 'Please provide external service login credentials.'; aLt["loading"] = 'Loading...'; aLt["menu-confirm-delete"] = 'Are you sure you want to delete this file?'; aLt["menu-delete-file"] = 'Delete'; aLt["menu-edit-description"] = 'Edit description'; aLt["menu-move-file"] = 'Move'; aLt["menu-previous-versions"] = 'Previous versions'; aLt["menu-view-original"] = 'View original'; aLt["ready"] = 'Ready'; aLt["remove-tag"] = 'Remove tag'; aLt["restore-tag"] = 'Restore tag'; aLt["adding-tags"] = 'Adding Tags...'; aLt["save"] = 'Save'; aLt["submit"] = 'Submit'; aLt["wikibits-attach-another"] = 'Attach another file'; aLt["wikibits-attach-file"] = 'Attach File'; aLt["wikibits-cant-attach-editing"] = 'Sorry, you can\'t attach files while editing a page. Please close the editor first.'; aLt["wikibits-edit-section"] = 'Edit section'; aLt["wikibits-remove-file"] = 'Remove file'; aLt["advanced-search"] = 'Advanced Search'; aLt["standard-search"] = 'Standard Search';  var wfMsg = wfMsg || function (key) { return aLt[key] ? aLt[key] : 'MISSING: ' + key; };
	//hook in menu clicking events to the document's body
	YAHOO.util.Event.addListener(document, "click", function () { DWMenu.BodyClick(); });
	YAHOO.util.Event.onDOMReady(function () { new clientWindow });

		

			YAHOO.util.Event.onDOMReady(function() {
			tb_init("a.lightbox, area.lightbox, input.lightbox, a[rel='awesomebox']");//pass where to apply thickbox
		});
	
			YAHOO.util.Event.onDOMReady(function() {
			MTComments.HookBehavior();
		});
		</script>

<script type="text/javascript" src="/deki/plugins/nav_pane/rgbcolor.js"></script>

<script type="text/javascript">

Deki.BaseHref = 'https://www.softether.org';
Deki.PageId = 523;
Deki.PageTitle = '9-about/News/904-SEVPN202301';
Deki.PageLanguageCode = 'en-us';
Deki.FollowRedirects = 1;
Deki.PathTpl = '/skins/deuce';
Deki.PathSkin = '/skins/deuce/lighty-blue';
Deki.PathCommon = '/skins/common';
Deki.UserName = 'Anonymous User';
Deki.Today = '11 Jan 2025';
Deki.UserIsAnonymous = true;
Deki.EditorConfigToken = 'bc5c1697';
Deki.EditorStylesToken = '91ba55dc';
Deki.PageEditable = false;
</script>
<script type="text/javascript">aLt["commercial-required"] = 'Gather feedback on your content with <strong>community scoring</strong> - these ratings weight results in adaptive search. Through curation analytics, ratings are used to highlight pages in need of attention. <a href="http://www.mindtouch.com/redir/mindtouch-tcs/">Learn more on enabling these capabilities with MindTouch 2010.</a>';aLt["login-required"] = 'You must be <a href="/index.php?title=Special:Userlogin&returntotitle=9-about%2FNews%2F904-SEVPN202301">logged in</a> to perform that action';</script><link href="/skins/common/custom_css.php" rel="stylesheet" type="text/css" /></head>
<body class="yui-skin-sam">
<noscript><div class="noscript">This application requires Javascript to be enabled.</div></noscript><div id="header">
	<div class="wrap">
		<table style="border: 0px;padding: 0px; width: 100%;">
			<tr>
				<td rowspan="2" valign="bottom" style="border: 0px none; padding-top: 3px; padding-bottom: 0px;"><a href='/' style="width: 190px; padding-top: 0px; border-style: none;" onmouseover="this.style.backgroundColor='#ffffff'" ><span style="font-weight: bold"><img src="/skins/deuce/lighty-blue/logo.jpg" /></span></a></td>
				<td style="border: 0px none; padding-top: 3px; padding-bottom: 0px;">
					
					<div class="search">
						<form action="/Special:Search">
							<fieldset>
								<input type="text" name="search" tabindex="1" class="search" id="searchInput" value="" />
								<button type="submit">Search</button>
							</fieldset>
						</form>
					</div>
				</td>
			</tr>
			<tr>
				<td style="border: 0px none; padding-top: 0px; padding-bottom: 0px;">
					<div id='cssmenu'>
						<ul>
							<li><a href='/' style='width: 50px;'>Top</a></li>
							<li><a href='/1-features' style='width: 175px;'>Why SoftEther VPN</a>
								<ul>
									<li><a href='/1-features' style='width: 180px;'>Introductions</a></li>
									<li><a href='/3-screens' style='width: 180px;'>Screenshots</a></li>
									<li style='border-bottom-width: 1px;'><a href='/3-spec' style='width: 180px;'>Specification</a></li>
								</ul>
							</li>
							<li><a href='/4-docs' style='width: 100px;'>Documents</a>
								<ul>
									<li><a href='/4-docs/1-manual' style='width: 180px;'>Reference Manual</a></li>
									<li><a href='/4-docs/2-howto' style='width: 180px;'>Tutorials</a></li>
									<li><a href='/4-docs/3-kb' style='width: 180px;'>FAQs and KBs</a></li>
									<li style='border-bottom-width: 1px;'><a href='/4-docs/9-research' style='width: 180px;'>Research Works</a></li>					</ul>
							</li>
							<li><a href='/5-download' style='width: 95px;'>Download</a>
								<ul>
									<li><a href='/5-download' style='width: 230px;'>Download SoftEther VPN</a></li>
									<li><a href='/5-download/history' style='width: 230px;'>Version History</a></li>
									<li><a href='/5-download/src' style='width: 230px;'>Source Code</a></li>
									<li style='border-bottom-width: 1px;'><a href='https://github.com/SoftEtherVPN/SoftEtherVPN/' style='width: 230px;'>GitHub Repository</a></li>
								</ul>
							</li>
							<li><a href='/7-forum' style='width: 80px;'>Support</a></li>
							<li><a href='/9-about' style='width: 120px;'>About Project</a></li>
						</ul>
					</div>
				</td>
			</tr>
		</table>
		<div class="clear"></div>
	</div>
</div>
<div class="wrap">
		<hr noshade>
	<div id="body">
		<div class="nav">
			<div id="siteNavTree"><div class="node dockedNode homeNode parentClosed" id="n22" c="n112" path=""><a href="https://www.softether.org/" title="SoftEther VPN Project"><span>SoftEther VPN Project</span></a></div><div class="node dockedNode parentClosed" id="n112" c="n506" p="n22" path="9-about/" cd="n506" sd="0"><a href="https://www.softether.org/9-about" title="About SoftEther VPN Project"><span>About SoftEther VPN Project</span></a></div><div class="node dockedNode lastDocked parentClosed" id="n506" c="n507,n520,n726,n523,n524" p="n112" path="9-about/News/" sd="0"><a href="https://www.softether.org/9-about/News" title="News"><span>News</span></a></div><div class="node childNode sibling" id="n507" p="n506" path="9-about/News/800-open-source/"><a href="https://www.softether.org/9-about/News/800-open-source" title="SoftEther VPN Becomes Open Source"><span>SoftEther VPN Becomes Open Source</span></a></div><div class="node childNode sibling" id="n520" p="n506" path="9-about/News/900-SEVPN201901/"><a href="https://www.softether.org/9-about/News/900-SEVPN201901" title="2019/07/09: SE201901: SoftEther VPN Server NDIS 5.x Windows Local Bridge Driver Local Privilege Escalation Vulnerability"><span>2019/07/09: SE201901: SoftEther VPN Server NDIS 5.x Windows Local Bridge Driver Local Privilege Escalation Vulnerability</span></a></div><div class="node childNode sibling" id="n726" p="n506" path="9-about/News/903_211111/"><a href="https://www.softether.org/9-about/News/903_211111" title="2021/11/11: Issue with Creating New L2TP/IPsec Connections on Android 12"><span>2021/11/11: Issue with Creating New L2TP/IPsec Connections on Android 12</span></a></div><div class="node childNode sibling selected" id="n523" p="n506" path="9-about/News/904-SEVPN202301/"><a href="https://www.softether.org/9-about/News/904-SEVPN202301" title="2023/06/30: SE202301: Security Advisory: CVE-2023-27395 etc: Fixed 6 vulnerabilities of SoftEther VPN in cooperation with Cisco Systems, Inc."><span>2023/06/30: SE202301: Security Advisory: CVE-2023-27395 etc: Fixed 6 vulnerabilities of SoftEther VPN in cooperation with Cisco Systems, Inc.</span></a></div><div class="node childNode sibling" id="n524" p="n506" path="9-about/News/905-TunnelCrack/"><a href="https://www.softether.org/9-about/News/905-TunnelCrack" title="2023/08/31: TunnelCrack protection implemented in SoftEther VPN Client"><span>2023/08/31: TunnelCrack protection implemented in SoftEther VPN Client</span></a></div></div><script type="text/javascript">var navMaxWidth = 25500;YAHOO.util.Event.onAvailable("siteNavTree", ((typeof Deki.nav != "undefined") ? Deki.nav.init : null), Deki.nav, true);</script>			<div class="toc" id="pagetoc">
					<div class="pageToc"><h5>Table of contents</h5><div class="tocdata"><ol style="list-style-type:none; margin-left:0px; padding-left:0px;"><li><span>1.</span> <a href="#1._CVE-2023-27395:_Heap_overflow_in_SoftEther_VPN_DDNS_client_functionality_at_risk_of_crashing_and_theoretically_arbitrary_code_execution_caused_by_a_malicious_man-in-the-middle_attacker_such_like_ISP-level_or_on_national_Internet_communication_channels" rel="internal">1. CVE-2023-27395: Heap overflow in SoftEther VPN DDNS client functionality at risk of crashing and theoretically arbitrary code execution caused by a malicious man-in-the-middle attacker such like ISP-level or on national Internet communication channels</a><ol style="list-style-type:none; margin-left:0px; padding-left:15px;"><li><span>1.1.</span> <a href="#(1)_Severity" rel="internal">(1) Severity</a></li><li><span>1.2.</span> <a href="#(2)_Overview" rel="internal">(2) Overview</a></li><li><span>1.3.</span> <a href="#(3)_Affected_versions" rel="internal">(3) Affected versions</a></li><li><span>1.4.</span> <a href="#(4)_Conditions_necessary_for_a_successful_attack_against_this_vulnerability" rel="internal">(4) Conditions necessary for a successful attack against this vulnerability</a></li><li><span>1.5.</span> <a href="#(5)_Details" rel="internal">(5) Details</a></li></ol></li><li><span>2.</span> <a href="#2._CVE-2023-22325:_Integer_overflow_in_the_SoftEther_VPN_DDNS_client_functionality_could_result_in_crashing_caused_by_a_malicious_man-in-the-middle_attacker_such_like_ISP-level_or_on_national_Internet_communication_channels" rel="internal">2. CVE-2023-22325: Integer overflow in the SoftEther VPN DDNS client functionality could result in crashing caused by a malicious man-in-the-middle attacker such like ISP-level or on national Internet communication channels</a><ol style="list-style-type:none; margin-left:0px; padding-left:15px;"><li><span>2.1.</span> <a href="#(1)_Severity_2" rel="internal">(1) Severity</a></li><li><span>2.2.</span> <a href="#(2)_Overview_2" rel="internal">(2) Overview</a></li><li><span>2.3.</span> <a href="#(3)_Affected_versions_2" rel="internal">(3) Affected versions</a></li><li><span>2.4.</span> <a href="#(4)_Conditions_necessary_for_a_successful_attack_against_this_vulnerability_2" rel="internal">(4) Conditions necessary for a successful attack against this vulnerability</a></li><li><span>2.5.</span> <a href="#(5)_Details_2" rel="internal">(5) Details</a></li></ol></li><li><span>3.</span> <a href="#3._CVE-2023-32275:_Vulnerability_that_allows_the_administrator_himself_of_a_32-bit_version_of_VPN_Client_or_VPN_Server_to_see_the_32-bit_value_heap_address_of_each_of_trusted_CA's_certificates_in_the_VPN_process" rel="internal">3. CVE-2023-32275: Vulnerability that allows the administrator himself of a 32-bit version of VPN Client or VPN Server to see the 32-bit value heap address of each of trusted CA's certificates in the VPN process</a><ol style="list-style-type:none; margin-left:0px; padding-left:15px;"><li><span>3.1.</span> <a href="#(1)_Severity_3" rel="internal">(1) Severity</a></li><li><span>3.2.</span> <a href="#(2)_Overview_3" rel="internal">(2) Overview</a></li><li><span>3.3.</span> <a href="#(3)_Affected_versions_3" rel="internal">(3) Affected versions</a></li><li><span>3.4.</span> <a href="#(4)_Conditions_necessary_for_a_successful_attack_against_this_vulnerability_3" rel="internal">(4) Conditions necessary for a successful attack against this vulnerability</a></li><li><span>3.5.</span> <a href="#(5)_Details_3" rel="internal">(5) Details</a></li></ol></li><li><span>4.</span> <a href="#4._CVE-2023-27516:_If_the_user_forget_to_set_the_administrator_password_of_SoftEther_VPN_Client_and_enable_remote_administration_with_blank_password.2C_the_administrator_password_of_VPN_Client_can_be_changed_remotely_or_VPN_client_can_be_used_remotely_by_anonymouse_third_person" rel="internal">4. CVE-2023-27516: If the user forget to set the administrator password of SoftEther VPN Client and enable remote administration with blank password, the administrator password of VPN Client can be changed remotely or VPN client can be used remotely by anonymouse third person</a><ol style="list-style-type:none; margin-left:0px; padding-left:15px;"><li><span>4.1.</span> <a href="#(1)_Severity_4" rel="internal">(1) Severity</a></li><li><span>4.2.</span> <a href="#(2)_Overview_4" rel="internal">(2) Overview</a></li><li><span>4.3.</span> <a href="#(3)_Affected_versions_4" rel="internal">(3) Affected versions</a></li><li><span>4.4.</span> <a href="#(4)_Conditions_necessary_for_a_successful_attack_against_this_vulnerability_4" rel="internal">(4) Conditions necessary for a successful attack against this vulnerability</a></li><li><span>4.5.</span> <a href="#(5)_Details_4" rel="internal">(5) Details</a></li></ol></li><li><span>5.</span> <a href="#5._CVE-2023-32634:_If_an_attacker_succeeds_in_launching_a_TCP_relay_program_on_the_same_port_as_the_VPN_Client_on_a_local_computer_running_the_SoftEther_VPN_Client_before_the_VPN_Client_process_is_launched.2C_the_TCP_relay_program_can_conduct_a_man-in-the-middle_attack_on_communication_between_the_administrator_and_the_VPN_Client_process" rel="internal">5. CVE-2023-32634: If an attacker succeeds in launching a TCP relay program on the same port as the VPN Client on a local computer running the SoftEther VPN Client before the VPN Client process is launched, the TCP relay program can conduct a man-in-the-middle attack on communication between the administrator and the VPN Client process</a><ol style="list-style-type:none; margin-left:0px; padding-left:15px;"><li><span>5.1.</span> <a href="#(1)_Severity_5" rel="internal">(1) Severity</a></li><li><span>5.2.</span> <a href="#(2)_Overview_5" rel="internal">(2) Overview</a></li><li><span>5.3.</span> <a href="#(3)_Affected_versions_5" rel="internal">(3) Affected versions</a></li><li><span>5.4.</span> <a href="#(4)_Conditions_necessary_for_a_successful_attack_against_this_vulnerability_5" rel="internal">(4) Conditions necessary for a successful attack against this vulnerability</a></li><li><span>5.5.</span> <a href="#(5)_Details_5" rel="internal">(5) Details</a></li></ol></li><li><span>6.</span> <a href="#6._CVE-2023-31192:_When_SoftEther_VPN_Client_connects_to_an_untrusted_VPN_Server.2C_an_invalid_redirection_response_for_the_clustering_(load_balancing)_feature_causes_20_bytes_of_uninitialized_stack_space_to_be_read" rel="internal">6. CVE-2023-31192: When SoftEther VPN Client connects to an untrusted VPN Server, an invalid redirection response for the clustering (load balancing) feature causes 20 bytes of uninitialized stack space to be read</a><ol style="list-style-type:none; margin-left:0px; padding-left:15px;"><li><span>6.1.</span> <a href="#(1)_Severity_6" rel="internal">(1) Severity</a></li><li><span>6.2.</span> <a href="#(2)_Overview_6" rel="internal">(2) Overview</a></li><li><span>6.3.</span> <a href="#(3)_Affected_versions_6" rel="internal">(3) Affected versions</a></li><li><span>6.4.</span> <a href="#(4)_Conditions_necessary_for_a_successful_attack_against_this_vulnerability_6" rel="internal">(4) Conditions necessary for a successful attack against this vulnerability</a></li><li><span>6.5.</span> <a href="#(5)_Details_6" rel="internal">(5) Details</a></li></ol></li><li><span>7.</span> <a href="#New_build_with_fixes_for_the_above_vulnerabilities" rel="internal"> New build with fixes for the above vulnerabilities</a></li></ol></div></div>			</div>
		</div>
		<div class="body">
							
				<div class="breadcrumbs hideforedit">
					<div class="pagemetalinks">
						<ul>
						</ul>
					</div>
														 				<div class="hierarchy">
			 					<ol class="dw-hierarchy deki-hierarchy"><li class="first"><a href="https://www.softether.org/" class="deki-ns">SoftEther VPN Project</a></li>
<li><a href="https://www.softether.org/9-about" class="deki-ns">About SoftEther VPN Project</a></li>
<li><a href="https://www.softether.org/9-about/News" class="deki-ns">News</a></li>
<li class="last"><a href="https://www.softether.org/9-about/News/904-SEVPN202301" class="deki-ns current">2023/06/30: SE202301: Security Advisory: CVE-2023-27395 etc: Fixed 6 vulnerabilities of SoftEther VPN in cooperation with Cisco Systems, Inc.</a></li></ol>			 				</div>
		 						 					 			<div class="br"></div>
				</div>
						
									 			
			<div class="content">
								<div class="title">
					<h1 id="title">
										2023/06/30: SE202301: Security Advisory: CVE-2023-27395 etc: Fixed 6 vulnerabilities of SoftEther VPN in cooperation with Cisco Systems, Inc.					
										</h1>
					
				</div>
								
				<div id="sessionMsg"><div class="inner"><ul></ul></div></div>				
				<div class="text">
					<div id="page-top"><div id="pageToc"><div class="pageToc"><h5>Table of contents</h5><div class="tocdata"><ol style="list-style-type:none; margin-left:0px; padding-left:0px;"><li><span>1.</span> <a href="#1._CVE-2023-27395:_Heap_overflow_in_SoftEther_VPN_DDNS_client_functionality_at_risk_of_crashing_and_theoretically_arbitrary_code_execution_caused_by_a_malicious_man-in-the-middle_attacker_such_like_ISP-level_or_on_national_Internet_communication_channels" rel="internal">1. CVE-2023-27395: Heap overflow in SoftEther VPN DDNS client functionality at risk of crashing and theoretically arbitrary code execution caused by a malicious man-in-the-middle attacker such like ISP-level or on national Internet communication channels</a><ol style="list-style-type:none; margin-left:0px; padding-left:15px;"><li><span>1.1.</span> <a href="#(1)_Severity" rel="internal">(1) Severity</a></li><li><span>1.2.</span> <a href="#(2)_Overview" rel="internal">(2) Overview</a></li><li><span>1.3.</span> <a href="#(3)_Affected_versions" rel="internal">(3) Affected versions</a></li><li><span>1.4.</span> <a href="#(4)_Conditions_necessary_for_a_successful_attack_against_this_vulnerability" rel="internal">(4) Conditions necessary for a successful attack against this vulnerability</a></li><li><span>1.5.</span> <a href="#(5)_Details" rel="internal">(5) Details</a></li></ol></li><li><span>2.</span> <a href="#2._CVE-2023-22325:_Integer_overflow_in_the_SoftEther_VPN_DDNS_client_functionality_could_result_in_crashing_caused_by_a_malicious_man-in-the-middle_attacker_such_like_ISP-level_or_on_national_Internet_communication_channels" rel="internal">2. CVE-2023-22325: Integer overflow in the SoftEther VPN DDNS client functionality could result in crashing caused by a malicious man-in-the-middle attacker such like ISP-level or on national Internet communication channels</a><ol style="list-style-type:none; margin-left:0px; padding-left:15px;"><li><span>2.1.</span> <a href="#(1)_Severity_2" rel="internal">(1) Severity</a></li><li><span>2.2.</span> <a href="#(2)_Overview_2" rel="internal">(2) Overview</a></li><li><span>2.3.</span> <a href="#(3)_Affected_versions_2" rel="internal">(3) Affected versions</a></li><li><span>2.4.</span> <a href="#(4)_Conditions_necessary_for_a_successful_attack_against_this_vulnerability_2" rel="internal">(4) Conditions necessary for a successful attack against this vulnerability</a></li><li><span>2.5.</span> <a href="#(5)_Details_2" rel="internal">(5) Details</a></li></ol></li><li><span>3.</span> <a href="#3._CVE-2023-32275:_Vulnerability_that_allows_the_administrator_himself_of_a_32-bit_version_of_VPN_Client_or_VPN_Server_to_see_the_32-bit_value_heap_address_of_each_of_trusted_CA's_certificates_in_the_VPN_process" rel="internal">3. CVE-2023-32275: Vulnerability that allows the administrator himself of a 32-bit version of VPN Client or VPN Server to see the 32-bit value heap address of each of trusted CA's certificates in the VPN process</a><ol style="list-style-type:none; margin-left:0px; padding-left:15px;"><li><span>3.1.</span> <a href="#(1)_Severity_3" rel="internal">(1) Severity</a></li><li><span>3.2.</span> <a href="#(2)_Overview_3" rel="internal">(2) Overview</a></li><li><span>3.3.</span> <a href="#(3)_Affected_versions_3" rel="internal">(3) Affected versions</a></li><li><span>3.4.</span> <a href="#(4)_Conditions_necessary_for_a_successful_attack_against_this_vulnerability_3" rel="internal">(4) Conditions necessary for a successful attack against this vulnerability</a></li><li><span>3.5.</span> <a href="#(5)_Details_3" rel="internal">(5) Details</a></li></ol></li><li><span>4.</span> <a href="#4._CVE-2023-27516:_If_the_user_forget_to_set_the_administrator_password_of_SoftEther_VPN_Client_and_enable_remote_administration_with_blank_password.2C_the_administrator_password_of_VPN_Client_can_be_changed_remotely_or_VPN_client_can_be_used_remotely_by_anonymouse_third_person" rel="internal">4. CVE-2023-27516: If the user forget to set the administrator password of SoftEther VPN Client and enable remote administration with blank password, the administrator password of VPN Client can be changed remotely or VPN client can be used remotely by anonymouse third person</a><ol style="list-style-type:none; margin-left:0px; padding-left:15px;"><li><span>4.1.</span> <a href="#(1)_Severity_4" rel="internal">(1) Severity</a></li><li><span>4.2.</span> <a href="#(2)_Overview_4" rel="internal">(2) Overview</a></li><li><span>4.3.</span> <a href="#(3)_Affected_versions_4" rel="internal">(3) Affected versions</a></li><li><span>4.4.</span> <a href="#(4)_Conditions_necessary_for_a_successful_attack_against_this_vulnerability_4" rel="internal">(4) Conditions necessary for a successful attack against this vulnerability</a></li><li><span>4.5.</span> <a href="#(5)_Details_4" rel="internal">(5) Details</a></li></ol></li><li><span>5.</span> <a href="#5._CVE-2023-32634:_If_an_attacker_succeeds_in_launching_a_TCP_relay_program_on_the_same_port_as_the_VPN_Client_on_a_local_computer_running_the_SoftEther_VPN_Client_before_the_VPN_Client_process_is_launched.2C_the_TCP_relay_program_can_conduct_a_man-in-the-middle_attack_on_communication_between_the_administrator_and_the_VPN_Client_process" rel="internal">5. CVE-2023-32634: If an attacker succeeds in launching a TCP relay program on the same port as the VPN Client on a local computer running the SoftEther VPN Client before the VPN Client process is launched, the TCP relay program can conduct a man-in-the-middle attack on communication between the administrator and the VPN Client process</a><ol style="list-style-type:none; margin-left:0px; padding-left:15px;"><li><span>5.1.</span> <a href="#(1)_Severity_5" rel="internal">(1) Severity</a></li><li><span>5.2.</span> <a href="#(2)_Overview_5" rel="internal">(2) Overview</a></li><li><span>5.3.</span> <a href="#(3)_Affected_versions_5" rel="internal">(3) Affected versions</a></li><li><span>5.4.</span> <a href="#(4)_Conditions_necessary_for_a_successful_attack_against_this_vulnerability_5" rel="internal">(4) Conditions necessary for a successful attack against this vulnerability</a></li><li><span>5.5.</span> <a href="#(5)_Details_5" rel="internal">(5) Details</a></li></ol></li><li><span>6.</span> <a href="#6._CVE-2023-31192:_When_SoftEther_VPN_Client_connects_to_an_untrusted_VPN_Server.2C_an_invalid_redirection_response_for_the_clustering_(load_balancing)_feature_causes_20_bytes_of_uninitialized_stack_space_to_be_read" rel="internal">6. CVE-2023-31192: When SoftEther VPN Client connects to an untrusted VPN Server, an invalid redirection response for the clustering (load balancing) feature causes 20 bytes of uninitialized stack space to be read</a><ol style="list-style-type:none; margin-left:0px; padding-left:15px;"><li><span>6.1.</span> <a href="#(1)_Severity_6" rel="internal">(1) Severity</a></li><li><span>6.2.</span> <a href="#(2)_Overview_6" rel="internal">(2) Overview</a></li><li><span>6.3.</span> <a href="#(3)_Affected_versions_6" rel="internal">(3) Affected versions</a></li><li><span>6.4.</span> <a href="#(4)_Conditions_necessary_for_a_successful_attack_against_this_vulnerability_6" rel="internal">(4) Conditions necessary for a successful attack against this vulnerability</a></li><li><span>6.5.</span> <a href="#(5)_Details_6" rel="internal">(5) Details</a></li></ol></li><li><span>7.</span> <a href="#New_build_with_fixes_for_the_above_vulnerabilities" rel="internal"> New build with fixes for the above vulnerabilities</a></li></ol></div></div></div><div id="topic"><div id="pageText"><div>June 30, 2023 by Daiyuu Nobori</div>
<div>&nbsp;</div>
<div>Related: CVE-2023-27395, CVE-2023-22325, CVE-2023-32275, CVE-2023-27516, CVE-2023-32634, CVE-2023-31192</div>
<div>&nbsp;</div>
<div>SoftEther VPN Security Advisory articles are published for high impact vulnerabilities (an arbitrary code execution or equivalent).</div>
<div>&nbsp;</div>
<div>The SoftEther VPN project received a high level code review and technical assistance from <a class="link-https" title="https://www.cisco.com/" rel="external nofollow" href="https://www.cisco.com/" target="_blank">Cisco Systems, Inc. of the United States</a> from April to June 2023 to fix several vulnerabilities in the SoftEther VPN code.</div>
<div>&nbsp;</div>
<div>The risk of exploitation of any of the fixed vulnerabilities is low under normal usage and environment, and actual attacks are very difficult. However, SoftEther VPN is now an open source VPN software used by 7.4 million unique users worldwide, and is used daily by many users to defend against the risk of blocking attacks by national censorship firewalls and attempts to eavesdrop on communications. Therefore, as long as the slightest attack possibility exists, there is great value in preventing vulnerabilities as much as possible in anticipation of the most sophisticated cyber attackers in the world, such as malicious ISPs and man-in-the-middle attackers on national Internet communication channels. These fixes are important and useful patches for users who use SoftEther VPN and the Internet for secure communications to prevent advanced attacks that can theoretically be triggered by malicious ISPs and man-in-the-middle attackers on national Internet communication pathways.</div>
<div>&nbsp;</div>
<div>The fixed vulnerabilities are CVE-2023-27395, CVE-2023-22325, CVE-2023-32275, CVE-2023-27516, CVE-2023-32634, and CVE-2023-31192. All of these were discovered in an outstanding code review of SoftEther VPN by Cisco Systems, Inc.</div>
<div>&nbsp;</div>
<div>We would like to sincerely acknowledge <a class="link-https" title="https://www.cisco.com/" rel="external nofollow" href="https://www.cisco.com/" target="_blank">Cisco Systems, Inc.</a> and Lilith, a security researcher in <a class="link-https" title="https://www.talosintelligence.com/" rel="external nofollow" href="https://www.talosintelligence.com/" target="_blank">the Cisco Talos division</a>, for their contributions to improving security for users of SoftEther VPN over the Internet.</div>
<div>&nbsp;</div>
<div>SoftEther VPN is open source software (Apache 2.0 license) and all modifications to the source code are publicly available.</div>
<div>&nbsp;</div>
<div>The list of vulnerabilities is as follows. Of particular interest are vulnerabilities 1, 2, and 6, which were difficult to find without a thorough code review.</div>
<div>&nbsp;</div>
<div><strong>1. CVE-2023-27395: Heap overflow in SoftEther VPN DDNS client functionality at risk of crashing and theoretically arbitrary code execution caused by a malicious man-in-the-middle attacker such like ISP-level or on national Internet communication channels</strong></div>
<div>&nbsp;</div>
<div><strong>2. CVE-2023-22325: Integer overflow in the SoftEther VPN DDNS client functionality could result in crashing caused by a malicious man-in-the-middle attacker such like ISP-level or on national Internet communication channels</strong></div>
<div>&nbsp;</div>
<div><strong>3. CVE-2023-32275: Vulnerability that allows the administrator himself of a 32-bit version of VPN Client or VPN Server to see the 32-bit value heap address of each of trusted CA's certificates in the VPN process</strong></div>
<div>&nbsp;</div>
<div><strong>4. CVE-2023-27516: If the user forget to set the administrator password of SoftEther VPN Client and enable remote administration with blank password, the administrator password of VPN Client can be changed remotely or VPN client can be used remotely by anonymouse third person</strong></div>
<div>&nbsp;</div>
<div><strong>5. CVE-2023-32634: If an attacker succeeds in launching a TCP relay program on the same port as the VPN Client on a local computer running the SoftEther VPN Client before the VPN Client process is launched, the TCP relay program can conduct a man-in-the-middle attack on communication between the administrator and the VPN Client process</strong></div>
<div>&nbsp;</div>
<div><strong>6. CVE-2023-31192: When SoftEther VPN Client connects to an untrusted VPN Server, an invalid redirection response for the clustering (load balancing) feature causes 20 bytes of uninitialized stack space to be read</strong></div>
<div>&nbsp;</div>
<div>&nbsp;</div>
<div>&nbsp;</div>
<div>The details are explained below.</div>
<div>&nbsp;</div>
<div>&nbsp;</div>
<div id="section_1"><span id="1._CVE-2023-27395:_Heap_overflow_in_SoftEther_VPN_DDNS_client_functionality_at_risk_of_crashing_and_theoretically_arbitrary_code_execution_caused_by_a_malicious_man-in-the-middle_attacker_such_like_ISP-level_or_on_national_Internet_communication_channels"></span><h3 class="editable">1. CVE-2023-27395: Heap overflow in SoftEther VPN DDNS client functionality at risk of crashing and theoretically arbitrary code execution caused by a malicious man-in-the-middle attacker such like ISP-level or on national Internet communication channels</h3>
<div>&nbsp;</div>
<div id="section_2"><span id="(1)_Severity"></span><h4 class="editable">(1) Severity</h4>
<div>CVSS v3.1: AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H (8.1)</div>
<div>However, as noted below, the attack requires a man-in-the-middle attack on the TCP communication between the Dynamic DNS (DDNS) client function and the DDNS server. Even in that case, arbitrary code execution has not been demonstrated, only a theoretical possibility exists. Nevertheless, we recommend updating the software as a precautionary measure.</div>
<div>&nbsp;</div>
</div><div id="section_3"><span id="(2)_Overview"></span><h4 class="editable">(2) Overview</h4>
<div>In the Dynamic DNS (DDNS) client function built into SoftEther VPN Server / Bridge (the same below), an attacker who succeeds in a man-in-the-middle attack on the TCP communication between the VPN Server and the DDNS server can generate a heap overflow and cause the VPN Server program to stop. The attacker must control the communication path between the VPN Server and the Internet to be able to conduct a man-in-the-middle attack. Because of the heap overflow, although usually prevented by heap address randomization and heap corruption detection possessed by the OS and runtime, the theoretical possibility exists that it can be exploited for arbitrary code execution. Therefore, an update of the VPN Server is recommended.</div>
<div>&nbsp;</div>
</div><div id="section_4"><span id="(3)_Affected_versions"></span><h4 class="editable">(3) Affected versions</h4>
<div>SoftEther VPN 4.41 Build 9787 RTM and earlier</div>
<div>&nbsp;</div>
</div><div id="section_5"><span id="(4)_Conditions_necessary_for_a_successful_attack_against_this_vulnerability"></span><h4 class="editable">(4) Conditions necessary for a successful attack against this vulnerability</h4>
<div>The attacker must have control over the Internet connection lines (ISP, WiFi, or other infrastructure) or reference DNS servers to which the VPN server is connected to the Internet, and be in a position to execute a man-in-the-middle attack that rewrites the contents of communications, such as tampering with TCP/IP communications between a dynamic DNS client and a dynamic DNS server or DNS communications preceding this.</div>
<div>&nbsp;</div>
</div><div id="section_6"><span id="(5)_Details"></span><h4 class="editable">(5) Details</h4>
<div>SoftEther VPN Server has a dynamic DNS client (DDNS) function. The dynamic DNS client function periodically registers or updates itself with the dynamic DNS server.</div>
<div>The dynamic DNS server <a class=" link-https" rel="external nofollow" href="https://www.softether.net/" title="https://www.softether.net/" target="_blank">https://www.softether.net/</a> issues &quot;****.softether.net&quot; (where *** is an arbitrary string desired by the user).</div>
<div>The communication (RPC, HTTP-based Remote Procedure Call) by the SoftEther VPN Server to register itself with the dynamic DNS server or to update its registration is performed in the background.</div>
<div>If an attacker meets the above &quot;conditions,&quot; such as the attacker controlling the communication path such as the ISP line to which the VPN Server is connected to the Internet, the attacker can rewrite the contents of the RPC between the VPN Server and the dynamic DNS server, or can respond with a false RPC.</div>
<div>By altering or forging the RPC response and including abnormal data in the RPC response, the attacker causes a heap space overflow in the SoftEther VPN Server process that receives the response.</div>
<div>If the VPN Server program crashes, all users connected to the VPN Server will be disconnected and VPN communication will be unavailable until the process is restarted.</div>
<div>Therefore, an attacker who meets the above conditions can realize a DoS attack that disconnects VPN communication.</div>
<div>Note that this vulnerability is a heap area overflow, which is detected by the heap area corruption checks possessed by the OS and C runtime and causes the program to crash, but in principle, the possibility that arbitrary code execution is possible cannot be denied if an elaborate attack communication packet is created. However, neither the primary discoverer nor the developers have so far succeeded in demonstrating that arbitrary code execution is possible.</div>
<div>In addition to identifying and fixing the area where the heap overflow occurs, this vulnerability patch provides double prevention by changing the communication between the DNS client function and the DDNS server function, which previously used HTTP, to SSL.</div>
<div>&nbsp;</div>
<div>&nbsp;</div>
<div>&nbsp;</div>
</div></div><div id="section_7"><span id="2._CVE-2023-22325:_Integer_overflow_in_the_SoftEther_VPN_DDNS_client_functionality_could_result_in_crashing_caused_by_a_malicious_man-in-the-middle_attacker_such_like_ISP-level_or_on_national_Internet_communication_channels"></span><h3 class="editable">2. CVE-2023-22325: Integer overflow in the SoftEther VPN DDNS client functionality could result in crashing caused by a malicious man-in-the-middle attacker such like ISP-level or on national Internet communication channels</h3>
<div>&nbsp;</div>
<div id="section_8"><span id="(1)_Severity_2"></span><h4 class="editable">(1) Severity</h4>
<div>CVSS v3.1: AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H (5.9)</div>
<div>&nbsp;</div>
</div><div id="section_9"><span id="(2)_Overview_2"></span><h4 class="editable">(2) Overview</h4>
<div>In the dynamic DNS (DDNS) client function built into SoftEther VPN Server, an attacker who succeeds in a man-in-the-middle attack on the TCP communication between the VPN Server and the DDNS server can cause an integer overflow and stop only the DDNS client function part of the VPN Server program. If the DDNS client portion of the VPN Server program is stopped, even if the server's IP address changes, the change cannot be registered with the DDNS server until the VPN Server program is restarted. Then this causes a practical problem. An attacker needs to control the communication path between the VPN Server and the Internet to be able to conduct a man-in-the-middle attack.</div>
<div>&nbsp;</div>
</div><div id="section_10"><span id="(3)_Affected_versions_2"></span><h4 class="editable">(3) Affected versions</h4>
<div>SoftEther VPN 4.41 Build 9787 RTM and earlier</div>
<div>&nbsp;</div>
</div><div id="section_11"><span id="(4)_Conditions_necessary_for_a_successful_attack_against_this_vulnerability_2"></span><h4 class="editable">(4) Conditions necessary for a successful attack against this vulnerability</h4>
<div>The attacker must have control over the Internet connection lines (ISP, WiFi, or other infrastructure) or reference DNS servers to which the VPN server is connected to the Internet, and be in a position to execute a man-in-the-middle attack that rewrites the contents of communications, such as tampering with TCP/IP communications between a dynamic DNS client and a dynamic DNS server or DNS communications preceding this.</div>
<div>&nbsp;</div>
</div><div id="section_12"><span id="(5)_Details_2"></span><h4 class="editable">(5) Details</h4>
<div>This vulnerability is similar to CVE-2023-27395. The attacker needs to send a specially crafted packet to the VPN Server to increase the maximum size of the receive buffer before tampering with the DDNS RPC response. That in itself does not cause a problem, but if the communication with the DDNS server is subsequently tampered with or the DDNS server is replaced by a false server, and the DDNS server responds with a value stating a certain large data size, the DDNS client will attempt to allocate memory space for that large data size. The DDNS client attempts to allocate memory space for that large data size. Here, an overflow on an integer variable occurs, causing a simple infinite loop and code stoppage in some DDNS client functions.</div>
<div>In this vulnerability patch, the part where the integer overflow occurs has been identified and fixed, and the communication between the DNS client function and the DDNS server function, which previously used HTTP, has been converted to SSL to provide a double layer of prevention.</div>
<div>&nbsp;</div>
</div></div><div id="section_13"><span id="3._CVE-2023-32275:_Vulnerability_that_allows_the_administrator_himself_of_a_32-bit_version_of_VPN_Client_or_VPN_Server_to_see_the_32-bit_value_heap_address_of_each_of_trusted_CA's_certificates_in_the_VPN_process"></span><h3 class="editable">3. CVE-2023-32275: Vulnerability that allows the administrator himself of a 32-bit version of VPN Client or VPN Server to see the 32-bit value heap address of each of trusted CA's certificates in the VPN process</h3>
<div>&nbsp;</div>
<div id="section_14"><span id="(1)_Severity_3"></span><h4 class="editable">(1) Severity</h4>
<div>5.5 - CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N</div>
<div>&nbsp;</div>
</div><div id="section_15"><span id="(2)_Overview_3"></span><h4 class="editable">(2) Overview</h4>
<div>SoftEther VPN Client and SoftEther VPN Server have a function to manage the list of trusted certificate authorities (CA). The first address of the heap address that holds the certificate is responded. This is because the heap address is used as a unique ID in the memory of the certificate. This means that the administrator himself can infer the heap state from outside the VPN process without dumping the process.</div>
<div>Whether or not this is really a vulnerability (i.e., whether or not it is an infringement of confidentiality for the administrator who manages and controls the VPN process to be able to know the heap address of an object in the process) should be discussed, but it is true that the heap address of a certificate. The heap address of an object is important only within a single process that manages it, and outputting it outside the process is not normally expected, except for exceptional functions such as debuggers that output internal states, so we decided to fix this issue.</div>
<div>In the 64-bit version of SoftEther VPN, heap address is not used, so heap address is not displayed. The 64-bit version uses a hash value based on the heap address instead. However, according to the opinion of the first discoverer of the vulnerability, it is possible to use the rainbow table of hashes to guess the original heap address.</div>
<div>&nbsp;</div>
</div><div id="section_16"><span id="(3)_Affected_versions_3"></span><h4 class="editable">(3) Affected versions</h4>
<div>SoftEther VPN 4.41 Build 9787 RTM and earlier</div>
<div>&nbsp;</div>
</div><div id="section_17"><span id="(4)_Conditions_necessary_for_a_successful_attack_against_this_vulnerability_3"></span><h4 class="editable">(4) Conditions necessary for a successful attack against this vulnerability</h4>
<div>An attacker who desires to peek at the heap address must have administrative privileges to the target VPN Server or VPN Client and must be authenticated as an administrator.</div>
<div>&nbsp;</div>
</div><div id="section_18"><span id="(5)_Details_3"></span><h4 class="editable">(5) Details</h4>
<div>In this patch, both the 32-bit and 64-bit versions have been improved to make it difficult to even create a rainbow table by using a random random number seed specific to the instance of the process when generating a unique enumeration identifier from the heap address.</div>
<div>&nbsp;</div>
<div>&nbsp;</div>
</div></div><div id="section_19"><span id="4._CVE-2023-27516:_If_the_user_forget_to_set_the_administrator_password_of_SoftEther_VPN_Client_and_enable_remote_administration_with_blank_password.2C_the_administrator_password_of_VPN_Client_can_be_changed_remotely_or_VPN_client_can_be_used_remotely_by_anonymouse_third_person"></span><h3 class="editable">4. CVE-2023-27516: If the user forget to set the administrator password of SoftEther VPN Client and enable remote administration with blank password, the administrator password of VPN Client can be changed remotely or VPN client can be used remotely by anonymouse third person</h3>
<div>&nbsp;</div>
<div id="section_20"><span id="(1)_Severity_4"></span><h4 class="editable">(1) Severity</h4>
<div>7.0 - CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:L/A:L</div>
<div>However, the problem occurs only when the administrator forgot to set the administrator password of SoftEther VPN Client and&nbsp; also enable remote administration.</div>
<div>&nbsp;</div>
</div><div id="section_21"><span id="(2)_Overview_4"></span><h4 class="editable">(2) Overview</h4>
<div>SoftEther VPN Client is divided into two parts: the main VPN Client process and the VPN Client Manager or vpncmd command line utility. The communication between the main process and the VPN Client Manager or vpncmd command line utility is done via TCP-based RPC. Normally, the VPN Client process itself and the VPN Client Manager or vpncmd command line utility reside on the same computer. Therefore, initially, they can only be controlled from the same computer (localhost, 127.0.0.1).</div>
<div>SoftEther VPN Client has a remote administration feature that allows the administrator to change the configuration of the VPN Client process and allow control from a remote computer (other than localhost).</div>
<div>If the administrator has configured the VPN Client to allow remote administration and has forgotten to set the administration password, an attacker with TCP access can connect to the VPN Client without a password, set the password without permission, and use the VPN Client functions freely. It is dangerous.</div>
<div>&nbsp;</div>
</div><div id="section_22"><span id="(3)_Affected_versions_4"></span><h4 class="editable">(3) Affected versions</h4>
<div>SoftEther VPN 4.41 Build 9787 RTM and earlier</div>
<div>&nbsp;</div>
</div><div id="section_23"><span id="(4)_Conditions_necessary_for_a_successful_attack_against_this_vulnerability_4"></span><h4 class="editable">(4) Conditions necessary for a successful attack against this vulnerability</h4>
<div>The administrator of the SoftEther VPN Client must have forgotten to set the administrator password and must have enabled remote administration. Furthermore, the VPN Client must be exposed to the Internet or otherwise able to communicate with the attacker.</div>
<div>&nbsp;</div>
<div>&nbsp;</div>
</div><div id="section_24"><span id="(5)_Details_4"></span><h4 class="editable">(5) Details</h4>
<div>This problem does not occur by default because SoftEther VPN Client is a default secure implementation and remote administration is disabled by default. However, it is possible that the administrator may forget to set the password and enable remote administration. Whether this is a vulnerability or not is a matter of debate. However, it can be assumed that a normal administrator would set a password almost 100% of the time when enabling remote management of the VPN Client. If the administrator forgets to set the password, changing the implementation so that the user authentication in remote administration is not allowed to pass has the advantage of improving security, and on the other hand, it has few disadvantages.</div>
<div>Therefore, we have modified the behavior of SoftEther VPN Client to prohibit remote connections if the administrator has forgotten the administrator password setting and has enabled remote administration, thereby improving security.</div>
<div>&nbsp;</div>
</div></div><div id="section_25"><span id="5._CVE-2023-32634:_If_an_attacker_succeeds_in_launching_a_TCP_relay_program_on_the_same_port_as_the_VPN_Client_on_a_local_computer_running_the_SoftEther_VPN_Client_before_the_VPN_Client_process_is_launched.2C_the_TCP_relay_program_can_conduct_a_man-in-the-middle_attack_on_communication_between_the_administrator_and_the_VPN_Client_process"></span><h3 class="editable">5. CVE-2023-32634: If an attacker succeeds in launching a TCP relay program on the same port as the VPN Client on a local computer running the SoftEther VPN Client before the VPN Client process is launched, the TCP relay program can conduct a man-in-the-middle attack on communication between the administrator and the VPN Client process</h3>
<div>&nbsp;</div>
<div id="section_26"><span id="(1)_Severity_5"></span><h4 class="editable">(1) Severity</h4>
<div>7.8 - CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H</div>
<div>&nbsp;</div>
</div><div id="section_27"><span id="(2)_Overview_5"></span><h4 class="editable">(2) Overview</h4>
<div>SoftEther VPN Client is divided into two parts: the main VPN Client process and the VPN Client Manager or vpncmd command line utility. The communication between the main process and the VPN Client Manager or vpncmd command line utility is done via TCP-based RPC. Normally, the VPN Client process itself and the VPN Client Manager or vpncmd command line utility reside on the same computer. Therefore, initially, they can only be controlled from the same computer (localhost, 127.0.0.1).</div>
<div>Assume that an attacker has already infiltrated the local computer on which the VPN Client is running by other means (e.g., knowing the OS's user password) and can freely launch processes on the local machine. In addition, suppose that the attacker succeeds in launching a TCP relay program on the same port as the VPN Client before the VPN Client is launched. In this case, if the VPN Client is launched at a later time, the VPN Client avoids using the conflicting TCP port number and increments the TCP port number in turn, using the first free port it finds. This is referred to here as the DynamicPortListener function. In this case, the attacker's TCP relay program can accept TCP RPC connections from the administrator's VPN Client Manager and relay the communication to the true VPN Client process modified by the DynamicPortListener function. If the administrator has enabled remote administration and has set an administrator password, the TCP relay program can hijack the content of the communication after authentication.</div>
<div>&nbsp;</div>
</div><div id="section_28"><span id="(3)_Affected_versions_5"></span><h4 class="editable">(3) Affected versions</h4>
<div>SoftEther VPN 4.41 Build 9787 RTM and earlier</div>
<div>&nbsp;</div>
</div><div id="section_29"><span id="(4)_Conditions_necessary_for_a_successful_attack_against_this_vulnerability_5"></span><h4 class="editable">(4) Conditions necessary for a successful attack against this vulnerability</h4>
<div>The attacker must be able to infiltrate the computer on which the VPN Client is running by other means beforehand, and must be able to launch arbitrary programs locally.</div>
<div>&nbsp;</div>
</div><div id="section_30"><span id="(5)_Details_5"></span><h4 class="editable">(5) Details</h4>
<div>In order for this attack to be realized, the target computer must already be logged in by the attacker and ready to execute arbitrary programs, and in practice, the threat is small.</div>
<div>However, there are environments where UNIX computers are SSH-shared by multiple users. And it is possible that one user may have malicious intent. In such an environment, it is desirable to have some countermeasures against this vulnerability.</div>
<div>In this patch, a function to enable/disable the DynamicPortListener function has been added to the VPN Client. The reason why the DynamicPortListener function is enabled by default in the Windows environment and disabled by default in the UNIX environment is that when using the VPN Client on Windows, it is usually assumed that one user occupies one terminal.</div>
<div>The DynamicPortListener function can be enabled/disabled by setting the DisableRpcDynamicPortListener setting value to true/false in the vpn_client.config configuration file.</div>
<div>&nbsp;</div>
<div>&nbsp;</div>
</div></div><div id="section_31"><span id="6._CVE-2023-31192:_When_SoftEther_VPN_Client_connects_to_an_untrusted_VPN_Server.2C_an_invalid_redirection_response_for_the_clustering_(load_balancing)_feature_causes_20_bytes_of_uninitialized_stack_space_to_be_read"></span><h3 class="editable">6. CVE-2023-31192: When SoftEther VPN Client connects to an untrusted VPN Server, an invalid redirection response for the clustering (load balancing) feature causes 20 bytes of uninitialized stack space to be read</h3>
<div>&nbsp;</div>
<div id="section_32"><span id="(1)_Severity_6"></span><h4 class="editable">(1) Severity</h4>
<div>5.3 - CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N</div>
<div>&nbsp;</div>
</div><div id="section_33"><span id="(2)_Overview_6"></span><h4 class="editable">(2) Overview</h4>
<div>This is a very interesting vulnerability, and the outstanding uniqueness of the first discoverer's point of view on this vulnerability is well expressed.</div>
<div>When the VPN Client (including the Cascade Connection function of VPN Server / Bridge) connects to the VPN Server, if the VPN Server has clustering enabled, after successful user authentication, a redirect response is returned for load balancing and fault tolerance. The redirect response contains a 20-byte one-time token code for the redirect destination called a &quot;Ticket&quot;, which is typically copied in memory from the packet from which the VPN Client received the redirect response into a 20-byte UCHAR ticket[20] variable in the C language. If the redirection response packet does not contain a Ticket value, it is not copied. However, in this case, the variable UCHAR ticket[20] is uninitialized, and what it contains is neither defined nor predictable.</div>
<div>The VPN Client then connects to the VPN Server to which it was redirected, and at that time, a copy of the 20-byte UCHAR ticket[20] variable in the C language that was copied earlier is sent to the destination VPN Server as a the VPN Server is then sent a copy of the 20-byte UCHAR ticket[20] variable in the C language that was just copied. Here, the uninitialized 20-byte value is sent. This enables the destination VPN Server to obtain the value of the uninitialized 20-byte variable on the stack.</div>
<div>&nbsp;</div>
</div><div id="section_34"><span id="(3)_Affected_versions_6"></span><h4 class="editable">(3) Affected versions</h4>
<div>SoftEther VPN 4.41 Build 9787 RTM and earlier</div>
<div>&nbsp;</div>
</div><div id="section_35"><span id="(4)_Conditions_necessary_for_a_successful_attack_against_this_vulnerability_6"></span><h4 class="editable">(4) Conditions necessary for a successful attack against this vulnerability</h4>
<div>Prior to the attack, the attacker needs to induce users of the VPN Client to connect toward an unintended VPN Server by using man-in-the-middle attacks on the Internet, DNS rewriting attacks, or other techniques.</div>
<div>In addition, the VPN Client has a function to verify the SSL certificate of the VPN Server; if SSL certificate verification is enabled, the attacker needs to steal the private key of the SSL certificate by some means, and then launch a fake VPN Server.</div>
<div>&nbsp;</div>
</div><div id="section_36"><span id="(5)_Details_6"></span><h4 class="editable">(5) Details</h4>
<div>This vulnerability allows a malicious VPN Server to obtain the contents of a 20-byte variable called UCHAR ticket[20] that has not been initialized when a VPN Client connects.</div>
<div>The question is what is in the uninitialized UCHAR ticket[20]. The contents of an uninitialized variable is undefined and unpredictable. In most cases, when the stack depth of another function called earlier is sufficient, the values of variables written in memory areas that happen to exist at the same stack depth in that other function (e.g., integer values of int i, j, k, etc. in a for loop) remain intact and are read back. This is not particularly useful information for an attacker. However, theoretically, there is a possibility that a fragment of confidential information (e.g. authentication information, heap memory address, etc.) could accidentally overlap with the 20-byte area. In this case, the attacker can read out significant information for his attack. Note that unlike higher-level languages, C language variables contain little or no meta-information (management information for managed variables) that encompasses the variable domain, so even if an attacker obtains a 20-byte value, the meaning of the contents is almost always unknown by the attacker, and the possibility of it being useful is small. Nevertheless, if there is even a small theoretical possibility that the contents of an uninitialized variable are externally exposed that could be exploited, it is important to zero-clear this as a precautionary measure to increase security as much as possible.</div>
</div></div><div id="section_37"><span id="New_build_with_fixes_for_the_above_vulnerabilities"></span><h3 class="editable"><br /> New build with fixes for the above vulnerabilities</h3>
<p>A new build was released on June 30, 2023.</p>
<ul> <li><strong><a title="Version History (ChangeLog)" rel="internal" href="https://www.softether.org/5-download/history">VPN 4.42 Build 9798 RTM</a>&nbsp;or later</strong></li>
</ul></div></div></div></div>					<div class="br"></div>
				</div>
			</div>
		</div>
		<div class="br"></div>
			
	<hr>
	
	<div id="footer">
		<div class="product" style="text-align: right;">
			<a href="https://ja.softether.org/">Japanese (日本語)</a> | <a href="/7-forum">Support</a> | <a href="/9-about">About Us</a> | <a href="https://www.tsukuba.ac.jp/english/">University of Tsukuba</a><BR>Copyright &copy; SoftEther Project.
					</div>
		<div class="sitenav">
			<ul>
							<li><a href="/index.php?title=Special:Userlogin&returntotitle=9-about%2FNews%2F904-SEVPN202301" class="login">Log in</a></li>
				<li>
								</li>
								<!-- <li>Language: <select onChange="location.href=value"><option value="http://www.softether.org/">English</option><option value="http://ja.softether" selected>Japanease</option><option value="http://cn.softether.org/">Chinese</option></select></li>

 -->			</ul>
		</div>
			
	</div>
</div>

<div class="popups">
	<div id="popupMessage"></div>
		<div id="popupMessage"></div> 
	<script type="text/javascript">var _endtime = new Date().getTime(); var _size = 59242;</script>

	<div onclick="DWMenu.Bubble=true;" class="menu" id="menutools" style="display:none;">
		<div class="header">&nbsp;</div>
		<div class="body">
			<ul>
			<li class="Templatelist"><a href="/Template:" title="Templates"><span class="icon"><img src="/skins/common/icons/icon-trans.gif" class="templatelist" alt="" /></span><span class="text">Templates</span></a></li><li class="Userlist"><a href="/User:" title="Users"><span class="icon"><img src="/skins/common/icons/icon-trans.gif" class="userlist" alt="" /></span><span class="text">Users</span></a></li><li class="Popularpages"><a href="/Special:Popularpages" title="Popular pages"><span class="icon"><img src="/skins/common/icons/icon-trans.gif" class="popularpages" alt="" /></span><span class="text">Popular pages</span></a></li><li class="deki-desktop-suite"><a href="http://www.mindtouch.com/redir/desktop-suite/" target="_blank" title="Desktop Suite"><span class="icon"><img src="/skins/common/icons/icon-trans.gif" class="deki-desktop-suite" alt="" /></span><span class="text">Desktop Suite</span></a></li>			</ul>
		</div>
		<div class="footer">&nbsp;</div>
	</div>

	<div onclick="DWMenu.Bubble=true;" class="menu" id="menuoptions" style="display:none;">
		<div class="header">&nbsp;</div>
		<div class="body">
			<ul>
				<li class="pageEdit"><a href="#" class="disabled" onclick="DWMenu.Off('menuoptions');return false" title="Edit page"><span class="icon"><img src="/skins/common/icons/icon-trans.gif" class="edit" alt="" /></span><span class="text">Edit page</span></a><li class="pageAdd"><a href="#" class="disabled disabled-login" onclick="DWMenu.Off('menuoptions');" title="New page"><span class="icon"><img src="/skins/common/icons/icon-trans.gif" class="add" alt="" /></span><span class="text">New page</span></a><li class="pagePdf"><a href="https://www.softether.org/@api/deki/pages/523/pdf" onclick="DWMenu.Off('menuoptions');" title="Save as PDF"><span class="icon"><img src="/skins/common/icons/icon-trans.gif" class="pdf" alt="" /></span><span class="text">Save as PDF</span></a><li class="pageRestrict"><a href="#" class="disabled" onclick="DWMenu.Off('menuoptions');" title="Restrict access"><span class="icon"><img src="/skins/common/icons/icon-trans.gif" class="restrict" alt="" /></span><span class="text">Restrict access</span></a><li class="pageAttach"><a href="#" class="disabled" onclick="DWMenu.Off('menuoptions');return false" title="Attach file"><span class="icon"><img src="/skins/common/icons/icon-trans.gif" class="attach" alt="" /></span><span class="text">Attach file</span></a><li class="pageEmail"><a href="#" class="disabled" onclick="DWMenu.Off('menuoptions');" title="Email link"><span class="icon"><img src="/skins/common/icons/icon-trans.gif" class="email" alt="" /></span><span class="text">Email link</span></a><li class="pageMove"><a href="#" class="disabled" onclick="DWMenu.Off('menuoptions');return false" title="Move page"><span class="icon"><img src="/skins/common/icons/icon-trans.gif" class="move" alt="" /></span><span class="text">Move page</span></a><li class="pageDelete"><a href="#" class="disabled" onclick="DWMenu.Off('menuoptions');return false" title="Delete page"><span class="icon"><img src="/skins/common/icons/icon-trans.gif" class="delete" alt="" /></span><span class="text">Delete page</span></a><li class="pageTags"><a href="#" class="disabled" onclick="DWMenu.Off('menuoptions');return false" title="Tag"><span class="icon"><img src="/skins/common/icons/icon-trans.gif" class="tags" alt="" /></span><span class="text">Tag</span></a><li class="pageProperties"><a href="#" class="disabled" onclick="DWMenu.Off('menuoptions');return false" title="Set page properties"><span class="icon"><img src="/skins/common/icons/icon-trans.gif" class="properties" alt="" /></span><span class="text">Set page properties</span></a><li class="pageSource"><a href="/index.php?title=9-about/News/904-SEVPN202301&action=source" onclick="DWMenu.Off('menuoptions');" title="View source"><span class="icon"><img src="/skins/common/icons/icon-trans.gif" class="source" alt="" /></span><span class="text">View source</span></a><li class="pageWatch"><a href="#" class="disabled" onclick="DWMenu.Off('menuoptions');" title="Watch page"><span class="icon"><img src="/skins/common/icons/icon-trans.gif" class="watch" alt="" /></span><span class="text">Watch page</span></a>			</ul>
		</div>
		<div class="footer">&nbsp;</div>
	</div>

	
	<div onclick="DWMenu.Bubble=true;" class="menu" id="menuPageContent" style="display: none;">
		<div class="header">&nbsp;</div>
		<div class="body"><div class="pageToc"><h5>Table of contents</h5><div class="tocdata"><ol style="list-style-type:none; margin-left:0px; padding-left:0px;"><li><span>1.</span> <a href="#1._CVE-2023-27395:_Heap_overflow_in_SoftEther_VPN_DDNS_client_functionality_at_risk_of_crashing_and_theoretically_arbitrary_code_execution_caused_by_a_malicious_man-in-the-middle_attacker_such_like_ISP-level_or_on_national_Internet_communication_channels" rel="internal">1. CVE-2023-27395: Heap overflow in SoftEther VPN DDNS client functionality at risk of crashing and theoretically arbitrary code execution caused by a malicious man-in-the-middle attacker such like ISP-level or on national Internet communication channels</a><ol style="list-style-type:none; margin-left:0px; padding-left:15px;"><li><span>1.1.</span> <a href="#(1)_Severity" rel="internal">(1) Severity</a></li><li><span>1.2.</span> <a href="#(2)_Overview" rel="internal">(2) Overview</a></li><li><span>1.3.</span> <a href="#(3)_Affected_versions" rel="internal">(3) Affected versions</a></li><li><span>1.4.</span> <a href="#(4)_Conditions_necessary_for_a_successful_attack_against_this_vulnerability" rel="internal">(4) Conditions necessary for a successful attack against this vulnerability</a></li><li><span>1.5.</span> <a href="#(5)_Details" rel="internal">(5) Details</a></li></ol></li><li><span>2.</span> <a href="#2._CVE-2023-22325:_Integer_overflow_in_the_SoftEther_VPN_DDNS_client_functionality_could_result_in_crashing_caused_by_a_malicious_man-in-the-middle_attacker_such_like_ISP-level_or_on_national_Internet_communication_channels" rel="internal">2. CVE-2023-22325: Integer overflow in the SoftEther VPN DDNS client functionality could result in crashing caused by a malicious man-in-the-middle attacker such like ISP-level or on national Internet communication channels</a><ol style="list-style-type:none; margin-left:0px; padding-left:15px;"><li><span>2.1.</span> <a href="#(1)_Severity_2" rel="internal">(1) Severity</a></li><li><span>2.2.</span> <a href="#(2)_Overview_2" rel="internal">(2) Overview</a></li><li><span>2.3.</span> <a href="#(3)_Affected_versions_2" rel="internal">(3) Affected versions</a></li><li><span>2.4.</span> <a href="#(4)_Conditions_necessary_for_a_successful_attack_against_this_vulnerability_2" rel="internal">(4) Conditions necessary for a successful attack against this vulnerability</a></li><li><span>2.5.</span> <a href="#(5)_Details_2" rel="internal">(5) Details</a></li></ol></li><li><span>3.</span> <a href="#3._CVE-2023-32275:_Vulnerability_that_allows_the_administrator_himself_of_a_32-bit_version_of_VPN_Client_or_VPN_Server_to_see_the_32-bit_value_heap_address_of_each_of_trusted_CA's_certificates_in_the_VPN_process" rel="internal">3. CVE-2023-32275: Vulnerability that allows the administrator himself of a 32-bit version of VPN Client or VPN Server to see the 32-bit value heap address of each of trusted CA's certificates in the VPN process</a><ol style="list-style-type:none; margin-left:0px; padding-left:15px;"><li><span>3.1.</span> <a href="#(1)_Severity_3" rel="internal">(1) Severity</a></li><li><span>3.2.</span> <a href="#(2)_Overview_3" rel="internal">(2) Overview</a></li><li><span>3.3.</span> <a href="#(3)_Affected_versions_3" rel="internal">(3) Affected versions</a></li><li><span>3.4.</span> <a href="#(4)_Conditions_necessary_for_a_successful_attack_against_this_vulnerability_3" rel="internal">(4) Conditions necessary for a successful attack against this vulnerability</a></li><li><span>3.5.</span> <a href="#(5)_Details_3" rel="internal">(5) Details</a></li></ol></li><li><span>4.</span> <a href="#4._CVE-2023-27516:_If_the_user_forget_to_set_the_administrator_password_of_SoftEther_VPN_Client_and_enable_remote_administration_with_blank_password.2C_the_administrator_password_of_VPN_Client_can_be_changed_remotely_or_VPN_client_can_be_used_remotely_by_anonymouse_third_person" rel="internal">4. CVE-2023-27516: If the user forget to set the administrator password of SoftEther VPN Client and enable remote administration with blank password, the administrator password of VPN Client can be changed remotely or VPN client can be used remotely by anonymouse third person</a><ol style="list-style-type:none; margin-left:0px; padding-left:15px;"><li><span>4.1.</span> <a href="#(1)_Severity_4" rel="internal">(1) Severity</a></li><li><span>4.2.</span> <a href="#(2)_Overview_4" rel="internal">(2) Overview</a></li><li><span>4.3.</span> <a href="#(3)_Affected_versions_4" rel="internal">(3) Affected versions</a></li><li><span>4.4.</span> <a href="#(4)_Conditions_necessary_for_a_successful_attack_against_this_vulnerability_4" rel="internal">(4) Conditions necessary for a successful attack against this vulnerability</a></li><li><span>4.5.</span> <a href="#(5)_Details_4" rel="internal">(5) Details</a></li></ol></li><li><span>5.</span> <a href="#5._CVE-2023-32634:_If_an_attacker_succeeds_in_launching_a_TCP_relay_program_on_the_same_port_as_the_VPN_Client_on_a_local_computer_running_the_SoftEther_VPN_Client_before_the_VPN_Client_process_is_launched.2C_the_TCP_relay_program_can_conduct_a_man-in-the-middle_attack_on_communication_between_the_administrator_and_the_VPN_Client_process" rel="internal">5. CVE-2023-32634: If an attacker succeeds in launching a TCP relay program on the same port as the VPN Client on a local computer running the SoftEther VPN Client before the VPN Client process is launched, the TCP relay program can conduct a man-in-the-middle attack on communication between the administrator and the VPN Client process</a><ol style="list-style-type:none; margin-left:0px; padding-left:15px;"><li><span>5.1.</span> <a href="#(1)_Severity_5" rel="internal">(1) Severity</a></li><li><span>5.2.</span> <a href="#(2)_Overview_5" rel="internal">(2) Overview</a></li><li><span>5.3.</span> <a href="#(3)_Affected_versions_5" rel="internal">(3) Affected versions</a></li><li><span>5.4.</span> <a href="#(4)_Conditions_necessary_for_a_successful_attack_against_this_vulnerability_5" rel="internal">(4) Conditions necessary for a successful attack against this vulnerability</a></li><li><span>5.5.</span> <a href="#(5)_Details_5" rel="internal">(5) Details</a></li></ol></li><li><span>6.</span> <a href="#6._CVE-2023-31192:_When_SoftEther_VPN_Client_connects_to_an_untrusted_VPN_Server.2C_an_invalid_redirection_response_for_the_clustering_(load_balancing)_feature_causes_20_bytes_of_uninitialized_stack_space_to_be_read" rel="internal">6. CVE-2023-31192: When SoftEther VPN Client connects to an untrusted VPN Server, an invalid redirection response for the clustering (load balancing) feature causes 20 bytes of uninitialized stack space to be read</a><ol style="list-style-type:none; margin-left:0px; padding-left:15px;"><li><span>6.1.</span> <a href="#(1)_Severity_6" rel="internal">(1) Severity</a></li><li><span>6.2.</span> <a href="#(2)_Overview_6" rel="internal">(2) Overview</a></li><li><span>6.3.</span> <a href="#(3)_Affected_versions_6" rel="internal">(3) Affected versions</a></li><li><span>6.4.</span> <a href="#(4)_Conditions_necessary_for_a_successful_attack_against_this_vulnerability_6" rel="internal">(4) Conditions necessary for a successful attack against this vulnerability</a></li><li><span>6.5.</span> <a href="#(5)_Details_6" rel="internal">(5) Details</a></li></ol></li><li><span>7.</span> <a href="#New_build_with_fixes_for_the_above_vulnerabilities" rel="internal"> New build with fixes for the above vulnerabilities</a></li></ol></div></div></div>
		<div class="footer">&nbsp;</div>
	</div>
		
			
<div class="ui-msg-wrap" id="MTMessage" style="display: none;">
	<div class="ui-msg ui-errormsg" id="MTMessageStyle">
		<div class="ui-msg-opt">
			<ul>
				<li><a href="#" class="dismiss" onclick="return MTMessage.Hide();">dismiss message</a></li>
				<li><a href="#" class="details" id="MTMessageDetailsLink" onclick="return MTMessage.ShowDetails(this);">view details</a></li>
			</ul>
			<div class="ui-msg-autoclose">
				<span id="MTMessageUnpaused" style="display: inline;">Message will close by itself in <span id="MTMessageTimer"></span> seconds</span>
				<span id="MTMessagePaused" style="display: none;">Message timer has been stopped</span>
			</div>
		</div>
		<div class="ui-msg-header" id="MTMessageHeader"></div>
		<div class="ui-msg-desc" id="MTMessageDesc"></div>
		<div class="ui-msg-desc" id="MTMessageDetails" style="display: none;">
			<p>Viewing Details:</p>
		</div>
	</div>
</div><div id="menuFiller"></div><div id="bodyHeight"></div><script type="text/javascript">$(function() {var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");$.getScript(gaJsHost + "google-analytics.com/ga.js", function() {try {var pageTracker = _gat._getTracker("UA-26766422-8");pageTracker._trackPageview();} catch(e) {}});});</script>
<!-- Served by www.softether.org in 0.28 secs. -->
</div>
</body>
</html>
