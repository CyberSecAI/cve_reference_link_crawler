- **Root cause of vulnerability**: The `fullFilePath` parameter of the `/api/upload-resource` endpoint, when the upload provider is set to "Storage Local File System," allows for directory traversal.
- **Weaknesses/vulnerabilities present**: The vulnerability is an arbitrary file write/overwrite vulnerability. Specifically, the lack of proper sanitization of the `fullFilePath` parameter allows an attacker to use relative paths like `../` to navigate outside the intended directory.
- **Impact of exploitation**: An attacker can write malicious files to arbitrary locations on the file system or overwrite existing files, potentially leading to code execution or other malicious actions.
- **Attack vectors**: The vulnerability is exploited via the `/api/upload-resource` endpoint with a crafted POST request that includes the `fullFilePath` parameter with directory traversal sequences (e.g., `resource%2F%2e%2e%2F%2e%2e%2Fweb%2Fbuild%2Fflag.html`). The request body also includes a file, which is written to the location specified by the traversed path.
- **Required attacker capabilities/position**: An attacker needs to be able to send POST requests to the `/api/upload-resource` endpoint. The provided example shows the attacker being authenticated as an admin with a valid session cookie (`casdoor_session_id=2fd9ab275d8d65ea296ab327fd92166a`). It was later clarified that authentication is required to exploit this issue.