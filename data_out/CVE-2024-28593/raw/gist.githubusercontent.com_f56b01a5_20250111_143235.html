[Summary]
An issue in Moodle v.4.3.3+ allows a remote attacker to execute arbitrary code via a crafted script to the Chatbox email component.

[Impact]
An attacker could:
+ Modify the HTML codes of the user interface with any malicious content including phishing content to gain the victim's credentials and for further attack scenarios.  In this case, the chat box is a highly sensitive area! It can lead to a lot of risks for users, such as inserting an <a> tag that users can click on and redirect, as well as inserting numerous <img> tags.  When messaging in Moodle, the email will be sent to the victim's side. From there, it also can lead to Email HTML Injection(Content Spoofing) it can be used for phishing, spamming, etc. 
+ Injecting multiple HTML tags with nested functions can lead to system denial of service (DOS). Try injecting tags that are prone to DOS attacks. It could potentially DOS everyone receiving the messages, making them unable to access the server.

[Attack Vectors]
1. Log into the chat box -> path -> /message/ and message anyone
2. Injecting HTML tags, the simplest one being <h1>minendie</h1>giongfnef
3. Observed server response -> completely vulnerable to HTML injection in both chat box message and Email HTML Injection through email