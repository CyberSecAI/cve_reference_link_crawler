The provided content relates to CVE-2024-39134.

**Root cause of vulnerability:**
A stack-buffer-overflow occurs in the `__zzip_fetch_disk_trailer()` function within `zzip/zip.c`. This is due to insufficient bounds checking when reading the disk trailer from a zip archive, specifically when `ZZIP_DISK64_TRAILER` is defined.

**Weaknesses/vulnerabilities present:**
The vulnerability is a stack-buffer-overflow. The code attempts to read a `zzip_disk_trailer` struct into a stack allocated buffer. When `ZZIP_DISK64_TRAILER` is defined, the code only checks if `end - tail` is greater than 0 but does not verify it's greater or equal to size of the `zzip_disk_trailer` structure leading to an overflow when the size check is insufficient.

**Impact of exploitation:**
Attackers can exploit this vulnerability to achieve a denial of service (DoS) by causing a crash. Potentially, attackers could achieve arbitrary code execution.

**Attack vectors:**
The attack vector is by providing a crafted zip file that triggers the insufficient size check condition in `__zzip_fetch_disk_trailer()`.

**Required attacker capabilities/position:**
The attacker needs to be able to provide a specially crafted zip file to the vulnerable software (zziplib). The attacker does not need any special privileges on the system.