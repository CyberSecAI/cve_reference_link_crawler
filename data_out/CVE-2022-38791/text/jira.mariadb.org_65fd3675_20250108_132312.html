

[Log in](/login.jsp?os_destination=%2Fbrowse%2FMDEV-28719)[Skip to main content](#main)[Skip to sidebar](#sidebar)Linked ApplicationsLoading…[![Jira](/s/lu2c13/820016/12ta74/_/jira-logo-scaled.png)](https://jira.mariadb.org/secure/MyJiraHome.jspa)

* [Dashboards](/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/browse/MDEV "View recent projects and browse a list of projects")
* [Issues](/issues/ "Search for issues and view recent issues")

* Give feedback to Atlassian
* [Help](https://docs.atlassian.com/jira/jcore-docs-0820/ "Help")
  + [Jira Core help](https://docs.atlassian.com/jira/jcore-docs-0820/ "Go to the online documentation for Jira Core")
  + [Keyboard Shortcuts](/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [Issue Reminders help](https://thestarware.atlassian.net/wiki/spaces/REM/overview)
  + [About Jira](/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/login.jsp?os_destination=%2Fbrowse%2FMDEV-28719)

![Uploaded image for project: 'MariaDB Server'](https://jira.mariadb.org/secure/projectavatar?pid=10000&avatarId=10011)

1. [MariaDB Server](/browse/MDEV)
2. [MDEV-28719](/browse/MDEV-28719)

# compress\_write() fails to release mutex on failure

[Log In](/login.jsp?os_destination=%2Fbrowse%2FMDEV-28719 "Log In")Export

XMLWordPrintable
#### Details

* **Type:**
  ![](/secure/viewavatar?size=xsmall&avatarId=14103&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.") Bug
* **Status:**
  Closed
  ([View Workflow](/browse/MDEV-28719?workflowName=MariaDB+v4&stepId=6 "MariaDB v4: MDEV-28719"))
* **Priority:**
  ![](/images/icons/priorities/critical.svg "Critical - Crashes, loss of data, severe memory leak.") Critical
* **Resolution:**
  Fixed
* **Affects Version/s:**
  10.9.1, 10.3(EOL), 10.4(EOL), 10.5, 10.6, 10.7(EOL), 10.8(EOL)
* **Fix Version/s:**
  [10.3.36](/issues/?jql=project+%3D+MDEV+AND+fixVersion+%3D+10.3.36 "10.3.36 "), [10.4.26](/issues/?jql=project+%3D+MDEV+AND+fixVersion+%3D+10.4.26 "10.4.26 "), [10.5.17](/issues/?jql=project+%3D+MDEV+AND+fixVersion+%3D+10.5.17 "10.5.17 "), [10.6.9](/issues/?jql=project+%3D+MDEV+AND+fixVersion+%3D+10.6.9 "10.6.9 "), [10.7.5](/issues/?jql=project+%3D+MDEV+AND+fixVersion+%3D+10.7.5 "10.7.5 "), [10.8.4](/issues/?jql=project+%3D+MDEV+AND+fixVersion+%3D+10.8.4 "10.8.4 "), [10.9.2](/issues/?jql=project+%3D+MDEV+AND+fixVersion+%3D+10.9.2 "10.9.2 First GA")
* **Component/s:**
  [Backup](/issues/?jql=project+%3D+MDEV+AND+component+%3D+Backup "Backup ")
* **Labels:**
  None
* **Environment:**
  All
#### Description

Hi, @marko, it seems that the fixing for ~~[MDEV-28689](https://jira.mariadb.org/browse/MDEV-28689 "Two improper locking bugs in the method compress_write")~~ is buggy. The lock thd->data\_mutex is still not released during erroneously writing to the destination stream and writing to the destination stream (Line 246 and 256).

Due to the original issue is closed, thus I just open a new issue.

<https://github.com/MariaDB/server/blob/863c3eda872b19f70ce6045119bf621584e1312d/extra/mariabackup/ds_compress.cc#L233-L259>

#### Attachments

#### Issue Links

links to

![Web Link](/images/icons/generic_link_16.png "Web Link")
[CVE-2022-38791](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-38791)

#### Activity

#### People

Assignee:

![marko](https://jira.mariadb.org/secure/useravatar?size=small&avatarId=10122)
Marko Mäkelä

Reporter:

![Ryan](https://jira.mariadb.org/secure/useravatar?size=small&avatarId=17327)
Ryan

Votes:
0
Vote for this issue

Watchers:
2
Start watching this issue

#### Dates

Created:

2022-06-01 07:23

Updated:

2023-01-18 14:32

Resolved:

2022-06-01 09:23

#### Git Integration

Error rendering 'com.xiplink.jira.git.jira\_git\_plugin:git-issue-webpanel'. Please contact your Jira administrators.

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/secure/CreateIssue%21default.jspa)

Powered by a free Atlassian [Jira](http://www.atlassian.com/software/jira) open source license for MariaDB Corporation Ab. Try Jira - [bug tracking software](http://www.atlassian.com/software/jira) for *your* team.

[Atlassian](http://www.atlassian.com/)

