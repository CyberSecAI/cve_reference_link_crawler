

[![wizlynx group | IT Security Services](/content/images/logo-nav.png)](/ch/en/)

[Contact Us](../../ch/en/contact)

# Security Research & Advisories

### Server-Side Request Forgery (SSRF) in cBioPortal v6.0.11 and earlier

| Vendor |  |
| --- | --- |
| Product | cBioPortal for Cancer Genomics |
| Affected Version(s) | v6.0.11 and earlier and probably prior |
| Tested Version(s) | v6.0.8 and v5.4.10 |
| Vendor Notification | 17 June 2024 |
| Advisory Publication | 17 June 2024 [without technical details] |
| Vendor Fix | A fix has been released in v6.0.12 |
| Public Disclosure | 24 July 2024 |
| Latest Modification | 24 July 2024 |
| CVE Identifier | [CVE-2024-41668](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-41668) |
| Product Description | The cBioPortal for Cancer Genomics provides visualization, analysis, and download of large-scale cancer genomics data sets. |
| Credits | Lim Chin Boon Security Researcher & Penetration Tester @wizlynx group |

## **Vulnerability Details**

| **Server-Side Request Forgery (SSRF)** | | | |
| --- | --- | --- | --- |
| **Severity**: **High** | **CVSS Score**: 8.3 | **CWE-ID**: [CWE-918](https://cwe.mitre.org/data/definitions/918.html) | **Status**: Open |
| **Vulnerability Description** | | | |
| The open-source web application cBioPortal for Cancer Genomics is affected by a Server-Side Request Forgery (SSRF) vulnerability affecting v6.0.8 and below. Attackers can manipulate URLs by directing requests to unexpected hosts or ports. This tactic can deceive security measures like firewalls that typically block direct URL access. Exploiting this, attackers could use the server as a proxy to perform activities such as internal network port scanning. Attacker can also abuse the functionality on the server to read or update internal resources. The attacker may be able to read server configuration such as AWS metadata, connect to internal services like http enabled databases or perform post requests towards internal services which are not intended to be exposed. | | | |
| **CVSS Base Score** | | | |
| **Attack Vector** | Network | **Scope** | Changed |
| **Attack Complexity** | Low | **Confidentiality Impact** | Low |
| **Privileges Required** | None | **Integrity Impact** | Low |
| **User Interaction** | None | **Availability Impact** | Low |

## **PoC**

### Demonstration

The default endpoint /proxy in the open-source application cBioPortal is found to be vulnerable to Server-Side Request Forgery (SSRF) vulnerability.

We have tested two versions of the application for this vulnerability, v6.0.8 and v5.4.10 (hosted locally via Docker). Therefore, the following demonstration shows the proof of concept on 2 versions of the application.

The application authors have hosted the application with version 6.0.8 on www.cbioportal.org which was the latest pre-release version available when the vulnerability was discovered.

![](/content/images/vuln/K8LJA4J90IAY.png)

When browsing through the application on www.cbioportal.org, there was a request sent to an endpoint called /proxy, which fetches or retrieves data from a supplied URL (docs.cbioportal.org in this case), as shown in the following screenshot.

![](/content/images/vuln/52CVL021APAP.png)

cBioPortal v6.0.8 (hosted locally via docker)

From the screenshot below, it can be seen that the version of the application hosted via Docker is v6.0.8, which was the same version as the one on www.cbioportal.org at the time the vulnerability was found.

![](/content/images/vuln/ZVAAJRKVC2AK.png)

Upon checking the /proxy endpoint discovered on www.cbioportal.org, it appears that the /proxy endpoint is the default endpoint in the cBioPortal application.

![](/content/images/vuln/RU3EMMIZP6CA.png)

Then, the /proxy endpoint was tested using Burp Repeater. The /proxy endpoint request was injected with a Burp Collaborator URL/server and sent to the server. Surprisingly, the server returned a response containing the Burp Collaborator payload.

![](/content/images/vuln/XZ7MOJWSOWHM.png)

After a while, our Burp Collaborator received multiple requests, including DNS and HTTP requests. The HTTP request returned the same response body as the Repeater request that we sent. This indicates that we can make the application send any HTTP request to a supplied URL, exposing to Server-Side Request Forgery (SSRF) vulnerability.

![](/content/images/vuln/8L5LXMSN8RCF.png)

The following screenshot shows the User-Agent of the HTTP request received in Collaborator. The User-Agent returned 'Java/21.0.3', indicating that the request was sent from a Java application. Furthermore, the application is confirmed to be using the Java Spring Boot framework, as documented in their online documentation (https://docs.cbioportal.org/architecture-overview/), which further confirms that the request originated from the target.

![](/content/images/vuln/AILJBU0LI93Y.png)

The screenshot below confirms this by showing that the Docker container hosting the application was using OpenJDK 21.0.3.

![](/content/images/vuln/NA5AMXV8URNS.png)

For further proof of concept, an HTTP server was hosted locally with some directories and files, as shown in the following screenshot.

![](/content/images/vuln/JH5TA2HH4QZW.png)

The affected endpoint /proxy was able to access a private IP address and retrieve the directory listing of the HTTP server hosted on private network, as shown in the following screenshot.

![](/content/images/vuln/URQ32KYHOF4S.png)

The following screenshot demonstrates that the application was able to retrieve the content of one of the files from inside the private IP address through /proxy endpoint.

![](/content/images/vuln/5VEOGF562QZY.png)

The following screenshot shows the application making a connection to a private IP address by abusing the endpoint /proxy.

![](/content/images/vuln/0WUG3GSMDUKV.png)

SSRF can also bypass various security mechanisms such as Cloud WAFs, allowing attackers to reveal the real IP addresses of backend servers. The following screenshot shows some testing on the application hosted on www.cbioportal.org by using Burp Suite Collaborator feature.

![](/content/images/vuln/79BCYISJDVSV.png)

The following screenshot shows that the Collaborator received multiple DNS requests before the HTTP request was sent, implying that the injected request bypassed the cloud WAF and reached the infrastructure where the application is hosted, revealing the real IP addresses of the infrastructure.

![](/content/images/vuln/CH1791OHNHIG.png)

cBioPortal v5.4.10 (hosted locally via docker)

An older version of the cBioPortal application, v5.4.10, was also tested for the vulnerability.

![](/content/images/vuln/KB6QJ2B5U5AL.png)

Following the same steps as tested on v6.0.8, the affected endpoint /proxy was tested by using Burp Repeater, the /proxy endpoint request was injected with a Burp Collaborator URL/server and sent to the server. Again, the server returned a response containing the Burp Collaborator payload.

![](/content/images/vuln/U4QBJRBMVEQT.png)

Again, our Burp Collaborator received multiple requests, including DNS and HTTP requests. The HTTP request returned the same response body as the Repeater request that we sent, which is the same result obtained when we tested on v6.0.8. This confirms that the older version of the application is also vulnerable to SSRF.

![](/content/images/vuln/NI4H6VNPQXSZ.png)

The screenshot shows that the User-Agent of the HTTP request received by Collaborator is Java/11.0.21, indicating that the request was indeed sent from the application.

![](/content/images/vuln/II9ATE8OPPQ7.png)

The screenshot below confirms this by showing that the Docker container hosting the application was using OpenJDK 11.0.21.

![](/content/images/vuln/PTAXR2KSRKSK.png)

[Top](#0)

![wizlynx group | IT Security Services](/content/images/WhiteWithRed.png)

wizlynx has not only built a solid foundation of information security, quality and project management know-how, but our associates are known for their ability to apply the right soft skills at the right time to best serve our customers. We make it a point to understand the infrastructure, needs and challenges of our customers, which enables us to deliver fast, effective and high quality results. It is our belief that this level of understanding can only be obtained with the most capable and experienced resources. Reach out to our associates at any time through our interactive competence centers to draw upon our knowledge of processes, procedures, guidelines and tools. Youï¿½ll be able to see, firsthand, the value our team will add to your organization.

---

---

©2023 wizlynx group - All Rights Reserved

* [Terms of Use](/ch/en/terms-of-use)
* [Privacy](/ch/en/privacy)

