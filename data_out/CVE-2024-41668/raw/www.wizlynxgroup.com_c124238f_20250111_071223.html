<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1, maximum-scale=1" name="viewport">

    <!-- SITE TITLE -->
    <title>wizlynx group | Server-Side Request Forgery (SSRF) in cBioPortal v6.0.11 and earlier</title>

    <!-- =========================
     FAV AND TOUCH ICONS AND FONT
    ============================== -->
    <link href="/content/images/favicons/favicon.png" rel="icon">
    <link href="/content/images/favicons/favicon-152.png" sizes="152x152" rel="apple-touch-icon-precomposed">
    <link href="/content/images/favicons/favicon-120.png" sizes="120x120" rel="apple-touch-icon-precomposed">
    <link href="/content/images/favicons/favicon-57.png" rel="apple-touch-icon-precomposed">
    <link type="text/css" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700">

    <!-- BOOTSTRAP AND ANIMATION -->
    <link href="/content/css/bootstrap.min.css" rel="stylesheet">
    <link href="/content/js/smartmenus-1.0.0/addons/bootstrap/jquery.smartmenus.bootstrap.css" rel="stylesheet">
    <link href="/content/css/animate.min.css" rel="stylesheet">

    <!-- FONT AWESOME -->
    <link href="/content/css/font-awesome.min.css" rel="stylesheet">
    <link href="/content/css/font-awesome-v4-shims.css" rel="stylesheet">

    <!-- CUSTOM STYLESHEETS -->
    <link href="/content/css/styles.css" rel="stylesheet">

    <!-- RESPONSIVE FIXES -->
    <link href="/content/css/responsive.css" rel="stylesheet">
    <link href="/content/css/nivo-lightbox.css" rel="stylesheet" />

    <!--[if lt IE 9]>
        <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/r29/html5.min.js"></script>
    <![endif]-->

</head>
<body>

    <!-- =========================
     PRE LOADER
    ============================== -->
    <div class="preloader" style="">
        <div class="status" style="">
            &nbsp;
        </div>
    </div>
    <!-- =========================
     SECTION: HOME / HEADER
    ============================== -->
    <header id="home" class="header circuitsBG">
        <div role="navigation" class="navbar-fixed-top sticky-navigation">
            <div class="container" style="min-height: 70px;text-align: left">
                <div class="navbar-header" style="display: inline-block">
                    <!-- LOGO -->
                    <a href="/ch/en/" class="navbar-brand">
                        <img alt="wizlynx group | IT Security Services" src="/content/images/logo-nav.png">
                    </a>

                </div>
                <div class="pull-right social-container">
                    <div class="social-icons-header" style="">
                        <a href="https://www.facebook.com/pages/wizlynx-group/166294663422930"><span class="fa fa-facebook"></span></a>
                        <a href="https://twitter.com/wizlynxgroup"><span class="fa fa-twitter"></span></a>
                        <a href="https://www.linkedin.com/company/wizlynx-group"><span class="fa fa-linkedin"></span></a><a href="https://www.xing.com/companies/wizlynxag"><span class="fa fa-xing"></span></a>
                    </div>
                    <a style="border-radius: 3px;padding: 6px 15px 6px;font-size: 12px;vertical-align: top" class="navbar-register-button hidden-xs" href="../../ch/en/contact">Contact Us</a>
                </div>
            </div>
        </div>
        <div class="overlay-layer small-margin-top">
            <div class="container">
                <div class="row">
                    <div class="col-md-12">
                        <div class="intro-section" style="text-align: center">
                            <div class="section-header wow fadeIn" data-wow-duration="2.5s">
                                <h1 class="white-text">
                                    <span class="strong">
                                        Security Research & Advisories
                                    </span>
                                </h1>
                                <h3 class="white-text" style="margin-top: 20px;">
                                    <span style="font-weight: bold">Server-Side Request Forgery (SSRF) in cBioPortal v6.0.11 and earlier</span>
                                </h3>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <style>
            .header .overlay-layer {
                height: auto;
                margin-top: 70px;
                padding-bottom: 60px;
                padding-top: 60px;
            }
        </style>
        <script type="36b8f2f11ce6b611f4013990-text/javascript">
            (function (i, s, o, g, r, a, m) {
                i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
                    (i[r].q = i[r].q || []).push(arguments);
                }, i[r].l = 1 * new Date(); a = s.createElement(o),
                    m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m);
            })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

            ga('create', 'UA-64955363-1', 'auto');
            ga('send', 'pageview');

        </script>

    </header>

    <!-- =========================
     SECTION: OUR BELIEF
    ============================== -->
    <section id="section1" class="unique-features white-bg">
        <div class="container">
            <table style="width: 100%" class="vulnTable">
                <tr>
                    <td style="width: 220px">Vendor</td>
                    <td style="">
                        <a href="https://github.com/cBioPortal/cbioportal                                                                                                                                                                "><img style="width: 200px" src="/content/images/vuln/UAAXN3PKADT4.png" /></a>
                    </td>
                </tr>
                <tr>
                    <td>Product</td>
                    <td>cBioPortal for Cancer Genomics</td>
                </tr>
                <tr>
                    <td>Affected Version(s)</td>
                    <td>v6.0.11 and earlier and probably prior</td>
                </tr>
                <tr>
                    <td>Tested Version(s)</td>
                    <td>v6.0.8 and v5.4.10</td>
                </tr>
                <tr>
                    <td style="padding-top: 20px">Vendor Notification</td>
                    <td style="padding-top: 20px">17 June 2024</td>
                </tr>
                <tr>
                    <td>Advisory Publication</td>
                    <td>17 June 2024 [without technical details]</td>
                </tr>
                <tr>
                    <td>Vendor Fix</td>
                    <td>A fix has been released in v6.0.12</td>
                </tr>
                <tr>
                    <td>Public Disclosure</td>
                    <td>24 July 2024</td>
                </tr>
                <tr>
                    <td>Latest Modification</td>
                    <td>24 July 2024</td>
                </tr>
                <tr>
                    <td>CVE Identifier</td>
                    <td>
                        <a href='https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-41668'>CVE-2024-41668</a>
                    </td>
                </tr>
                <tr>
                    <td style="padding-top: 20px">Product Description</td>
                    <td style="padding-top: 20px">The cBioPortal for Cancer Genomics provides visualization, analysis, and download of large-scale cancer genomics data sets.</td>
                </tr>
                <tr>
                    <td style="padding-top: 20px">Credits</td>
                    <td style="padding-top: 20px">Lim Chin Boon Security Researcher & Penetration Tester @wizlynx group</td>
                </tr>
            </table>
        </div>
    </section>
    <section id="section2" class="unique-features dark-white-bg" style="">
        <div class="container">
            <div class="section-header header-left wow fadeIn" data-wow-duration="2.5s">
                <h2 class="dark-text">
                    <strong>Vulnerability Details</strong>
                </h2>
                <div class="colored-line colored-line-wide">
                </div>
            </div>
            <div style="margin-top: 20px">
                <table style="border: 1px solid #07506e; width: 100%;" class="vulnDetails">
                    <tr>
                        <td colspan="4" style="background-color: #07506E;color:white">
                            <b>Server-Side Request Forgery (SSRF)</b>
                        </td>
                    </tr>
                    <tr>
                        <td><b>Severity</b>: <span style="color: darkorange"><b>High</b></span> <span style="color: darkorange" class="fa fa-thermometer-three-quarters"></span></td>
                        <td><b>CVSS Score</b>: 8.3</td>
                        <td><b>CWE-ID</b>:  <a href='https://cwe.mitre.org/data/definitions/918.html'>CWE-918</a></td>
                        <td><b>Status</b>: Open</td>
                    </tr>
                    <tr>
                        <td colspan="4" style="background-color: #07506E;color:white">
                            <b>Vulnerability Description</b>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="4" style="">
                            The open-source web application cBioPortal for Cancer Genomics is affected by a Server-Side Request Forgery (SSRF) vulnerability affecting v6.0.8 and below. Attackers can manipulate URLs by directing requests to unexpected hosts or ports. This tactic can deceive security measures like firewalls that typically block direct URL access. Exploiting this, attackers could use the server as a proxy to perform activities such as internal network port scanning. Attacker can also abuse the functionality on the server to read or update internal resources. The attacker may be able to read server configuration such as AWS metadata, connect to internal services like http enabled databases or perform post requests towards internal services which are not intended to be exposed.
                        </td>
                    </tr>
                    <tr>
                        <td colspan="4" style="background-color: #07506E;color:white">
                            <b>CVSS Base Score</b>
                        </td>
                    </tr>
                    <tr>
                        <td><b>Attack Vector</b></td>
                        <td>Network</td>
                        <td><b>Scope</b></td>
                        <td>Changed</td>
                    </tr>
                    <tr>
                        <td><b>Attack Complexity</b></td>
                        <td>Low</td>
                        <td><b>Confidentiality Impact</b></td>
                        <td>Low</td>
                    </tr>
                    <tr>
                        <td><b>Privileges Required</b></td>
                        <td>None</td>
                        <td><b>Integrity Impact</b></td>
                        <td>Low</td>
                    </tr>
                    <tr>
                        <td><b>User Interaction</b></td>
                        <td>None</td>
                        <td><b>Availability Impact</b></td>
                        <td>Low</td>
                    </tr>
                </table>
            </div>
        </div>
    </section>
    <section id="section4" class="unique-features white-bg">
        <div class="container">
            <div class="section-header header-left wow fadeIn" data-wow-duration="2.5s">
                <h2 class="dark-text">
                    <strong>PoC</strong>
                </h2>
                <div class="colored-line colored-line-wide">
                </div>
            </div>
            <div style="margin-top: 20px">
                <h3>Demonstration</h3><p>The default endpoint /proxy in the open-source application cBioPortal is found to be vulnerable to Server-Side Request Forgery (SSRF) vulnerability.</p><p>We have tested two versions of the application for this vulnerability, v6.0.8 and v5.4.10 (hosted locally via Docker). Therefore, the following demonstration shows the proof of concept on 2 versions of the application.</p><p>The application authors have hosted the application with version 6.0.8 on www.cbioportal.org which was the latest pre-release version available when the vulnerability was discovered.</p><img class="img-responsive" src="/content/images/vuln/K8LJA4J90IAY.png" style="margin-top: 40px; margin-bottom: 40px"/><p>When browsing through the application on www.cbioportal.org, there was a request sent to an endpoint called /proxy, which fetches or retrieves data from a supplied URL (docs.cbioportal.org in this case), as shown in the following screenshot.</p><img class="img-responsive" src="/content/images/vuln/52CVL021APAP.png" style="margin-top: 40px; margin-bottom: 40px"/><p>cBioPortal v6.0.8 (hosted locally via docker)<br></p><p>From the screenshot below, it can be seen that the version of the application hosted via Docker is v6.0.8, which was the same version as the one on www.cbioportal.org at the time the vulnerability was found.</p><img class="img-responsive" src="/content/images/vuln/ZVAAJRKVC2AK.png" style="margin-top: 40px; margin-bottom: 40px"/><p>Upon checking the /proxy endpoint discovered on www.cbioportal.org, it appears that the /proxy endpoint is the default endpoint in the cBioPortal application.</p><img class="img-responsive" src="/content/images/vuln/RU3EMMIZP6CA.png" style="margin-top: 40px; margin-bottom: 40px"/><p>Then, the /proxy endpoint was tested using Burp Repeater. The /proxy endpoint request was injected with a Burp Collaborator URL/server and sent to the server. Surprisingly, the server returned a response containing the Burp Collaborator payload.</p><img class="img-responsive" src="/content/images/vuln/XZ7MOJWSOWHM.png" style="margin-top: 40px; margin-bottom: 40px"/><p>After a while, our Burp Collaborator received multiple requests, including DNS and HTTP requests. The HTTP request returned the same response body as the Repeater request that we sent. This indicates that we can make the application send any HTTP request to a supplied URL, exposing to Server-Side Request Forgery (SSRF) vulnerability.</p><img class="img-responsive" src="/content/images/vuln/8L5LXMSN8RCF.png" style="margin-top: 40px; margin-bottom: 40px"/><p>The following screenshot shows the User-Agent of the HTTP request received in Collaborator. The User-Agent returned 'Java/21.0.3', indicating that the request was sent from a Java application. Furthermore, the application is confirmed to be using the Java Spring Boot framework, as documented in their online documentation (https://docs.cbioportal.org/architecture-overview/), which further confirms that the request originated from the target.</p><img class="img-responsive" src="/content/images/vuln/AILJBU0LI93Y.png" style="margin-top: 40px; margin-bottom: 40px"/><p>The screenshot below confirms this by showing that the Docker container hosting the application was using OpenJDK 21.0.3. </p><img class="img-responsive" src="/content/images/vuln/NA5AMXV8URNS.png" style="margin-top: 40px; margin-bottom: 40px"/><p>For further proof of concept, an HTTP server was hosted locally with some directories and files, as shown in the following screenshot.</p><img class="img-responsive" src="/content/images/vuln/JH5TA2HH4QZW.png" style="margin-top: 40px; margin-bottom: 40px"/><p>The affected endpoint /proxy was able to access a private IP address and retrieve the directory listing of the HTTP server hosted on private network, as shown in the following screenshot.</p><img class="img-responsive" src="/content/images/vuln/URQ32KYHOF4S.png" style="margin-top: 40px; margin-bottom: 40px"/><p>The following screenshot demonstrates that the application was able to retrieve the content of one of the files from inside the private IP address through /proxy endpoint.</p><img class="img-responsive" src="/content/images/vuln/5VEOGF562QZY.png" style="margin-top: 40px; margin-bottom: 40px"/><p>The following screenshot shows the application making a connection to a private IP address by abusing the endpoint /proxy.</p><img class="img-responsive" src="/content/images/vuln/0WUG3GSMDUKV.png" style="margin-top: 40px; margin-bottom: 40px"/><p>SSRF can also bypass various security mechanisms such as Cloud WAFs, allowing attackers to reveal the real IP addresses of backend servers. The following screenshot shows some testing on the application hosted on www.cbioportal.org by using Burp Suite Collaborator feature.
</p><img class="img-responsive" src="/content/images/vuln/79BCYISJDVSV.png" style="margin-top: 40px; margin-bottom: 40px"/><p>The following screenshot shows that the Collaborator received multiple DNS requests before the HTTP request was sent, implying that the injected request bypassed the cloud WAF and reached the infrastructure where the application is hosted, revealing the real IP addresses of the infrastructure. </p><img class="img-responsive" src="/content/images/vuln/CH1791OHNHIG.png" style="margin-top: 40px; margin-bottom: 40px"/><p>cBioPortal v5.4.10 (hosted locally via docker)</p><p>An older version of the cBioPortal application, v5.4.10, was also tested for the vulnerability.</p><img class="img-responsive" src="/content/images/vuln/KB6QJ2B5U5AL.png" style="margin-top: 40px; margin-bottom: 40px"/><p>Following the same steps as tested on v6.0.8, the affected endpoint /proxy was tested by using Burp Repeater, the /proxy endpoint request was injected with a Burp Collaborator URL/server and sent to the server. Again, the server returned a response containing the Burp Collaborator payload.</p><img class="img-responsive" src="/content/images/vuln/U4QBJRBMVEQT.png" style="margin-top: 40px; margin-bottom: 40px"/><p>Again, our Burp Collaborator received multiple requests, including DNS and HTTP requests. The HTTP request returned the same response body as the Repeater request that we sent, which is the same result obtained when we tested on v6.0.8. This confirms that the older version of the application is also vulnerable to SSRF.</p><img class="img-responsive" src="/content/images/vuln/NI4H6VNPQXSZ.png" style="margin-top: 40px; margin-bottom: 40px"/><p>The screenshot shows that the User-Agent of the HTTP request received by Collaborator is Java/11.0.21, indicating that the request was indeed sent from the application. </p><img class="img-responsive" src="/content/images/vuln/II9ATE8OPPQ7.png" style="margin-top: 40px; margin-bottom: 40px"/><p>The screenshot below confirms this by showing that the Docker container hosting the application was using OpenJDK 11.0.21.</p><img class="img-responsive" src="/content/images/vuln/PTAXR2KSRKSK.png" style="margin-top: 40px; margin-bottom: 40px"/>
            </div>
        </div>
    </section>


    <a href="#0" class="cd-top">Top</a>

    <!-- FOOTER -->
    <footer class="footer ultradark-bg lg-padding">
        <div class="container" style="color: #6f6f6f">
            <div class="row">
                <div class="col-xs-12 col-lg-3">
                    <img alt="wizlynx group | IT Security Services" class="img-responsive" src="/content/images/WhiteWithRed.png" />
                </div>
                <div class="col-xs-12 col-lg-9 small-text text-justify xs-margin-top-15">
                    wizlynx has not only built a solid foundation of information security, quality and project management know-how, but our associates are known for their ability to apply the right soft skills at the right time to best serve our customers. We make it a point to understand the infrastructure, needs and challenges of our customers, which enables us to deliver fast, effective and high quality results. It is our belief that this level of understanding can only be obtained with the most capable and experienced resources. Reach out to our associates at any time through our interactive competence centers to draw upon our knowledge of processes, procedures, guidelines and tools. Youï¿½ll be able to see, firsthand, the value our team will add to your organization.
                </div>
                <hr />
            </div>
            <hr />
            <div class="row">
                <div class="xs-no-float small-text col-lg-6 text-left">
                    &copy;2023 <span class="white-text">wizlynx group</span> - All Rights Reserved
                </div>
                <div class="xs-no-float col-lg-6">
                    <ul class="footer-links small-text text-right">
                        <li>
                            <a class="white-text" href="/ch/en/terms-of-use">Terms of Use</a>
                        </li>
                        <li>
                            <a class="white-text" href="/ch/en/privacy">Privacy</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </footer>


    <!-- =========================
     SCRIPTS
    ============================== -->
    <script src="/content/js/jquery-3.6.0.min.js" type="36b8f2f11ce6b611f4013990-text/javascript"></script><script src="/content/js/jquery-migrate-3.4.0.min.js" type="36b8f2f11ce6b611f4013990-text/javascript"></script>
    <script type="36b8f2f11ce6b611f4013990-text/javascript">
        /* PRE LOADER */
        $(window).load(function () {
            "use strict";
            $(".status").fadeOut();
            $(".preloader").delay(1000).fadeOut("slow");
        });
        $(document).ready(function () {
            $('a.nivo-lb').nivoLightbox();
        });
    </script>

    <script src="/content/js/bootstrap.min.js" type="36b8f2f11ce6b611f4013990-text/javascript"></script>
    <script type="36b8f2f11ce6b611f4013990-text/javascript" src="/content/js/smartmenus-1.0.0/jquery.smartmenus.min.js"></script>
    <script type="36b8f2f11ce6b611f4013990-text/javascript" src="/content/js/smartmenus-1.0.0/addons/bootstrap/jquery.smartmenus.bootstrap.min.js"></script>
    <script src="/content/js/jquery.nav.js" type="36b8f2f11ce6b611f4013990-text/javascript"></script>
    <script src="/content/js/wow.min.js" type="36b8f2f11ce6b611f4013990-text/javascript"></script>
    <script src="/content/js/jquery.simple-text-rotator.min.js" type="36b8f2f11ce6b611f4013990-text/javascript"></script>
    <script src="/content/css/jquery-ui-1.11.4.custom/jquery-ui.min.js" type="36b8f2f11ce6b611f4013990-text/javascript"></script>
    <link href="/content/css/jquery-ui-1.11.4.custom/jquery-ui.min.css" rel="stylesheet" />

    <script src="/content/js/nivo-lightbox.min.js" type="36b8f2f11ce6b611f4013990-text/javascript"></script>
    <style>
        .ui-widget {
            font-family: inherit !important;
            font-size: inherit !important;
        }

        .list li {
            margin-bottom: 20px;
        }
    </style>

    <!-- CUSTOM JS  -->
    <script src="/content/js/site.js" type="36b8f2f11ce6b611f4013990-text/javascript"></script>
    <script src="/content/js/sites_dialogs.js" type="36b8f2f11ce6b611f4013990-text/javascript"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js" type="36b8f2f11ce6b611f4013990-text/javascript"></script>

<script src="/cdn-cgi/scripts/7d0fa10a/cloudflare-static/rocket-loader.min.js" data-cf-settings="36b8f2f11ce6b611f4013990-|49" defer></script></body>
</html>