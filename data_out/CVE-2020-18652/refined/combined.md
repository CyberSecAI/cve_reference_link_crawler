=== Content from gitlab.freedesktop.org_4a96a002_20250111_150406.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Register](/users/sign_up)

## Admin message

Due to an influx of spam, we have had to impose restrictions on new accounts. Please see [this wiki page](https://gitlab.freedesktop.org/freedesktop/freedesktop/-/wikis/home) for instructions on how to get full permissions. Sorry for the inconvenience.

# A heap-based buffer over-read was found in WEBP\_Support.cpp

Hello,
I found a heap-based buffer over-read bug in function VP8XChunk::VP8XChunk at WEBP\_Support.cpp:125 & 126. Actually, it looks like CVE-2018-7731(<https://bugs.freedesktop.org/show_bug.cgi?id=105247>) and it might be an issue caused by the incomplete consideration of the former issue.
The ASAN report is as below:

```
processing file /home/liwc/crashes/case1
dump_xmp for file /home/liwc/crashes/case1
=================================================================
==58159==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60200000ef77 at pc 0x0000005ce0b3 bp 0x7ffc7d9b8580 sp 0x7ffc7d9b8570
READ of size 1 at 0x60200000ef77 thread T0
    #0 0x5ce0b2 in WEBP::VP8XChunk::VP8XChunk(WEBP::Container*) /home/liwc/exempi-master/XMPFiles/source/FormatSupport/WEBP_Support.cpp:125
    #1 0x5ce81c in WEBP::Container::Container(WEBP_MetaHandler*) /home/liwc/exempi-master/XMPFiles/source/FormatSupport/WEBP_Support.cpp:203
    #2 0x5c9661 in WEBP_MetaHandler::CacheFileData() /home/liwc/exempi-master/XMPFiles/source/FileHandlers/WEBP_Handler.cpp:89
    #3 0x48874f in DoOpenFile /home/liwc/exempi-master/XMPFiles/source/XMPFiles.cpp:1076
    #4 0x488f8a in XMPFiles::OpenFile(char const*, unsigned int, unsigned int) /home/liwc/exempi-master/XMPFiles/source/XMPFiles.cpp:1179
    #5 0x47e415 in WXMPFiles_OpenFile_1 /home/liwc/exempi-master/XMPFiles/source/WXMPFiles.cpp:233
    #6 0x41dab4 in TXMPFiles<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >::OpenFile(char const*, unsigned int, unsigned int) (/home/liwc/exempi-master/exempi/exempi+0x41dab4)
    #7 0x40bd79 in xmp_files_open_new /home/liwc/exempi-master/exempi/exempi.cpp:294
    #8 0x408ccb in get_xmp_from_file /home/liwc/exempi-master/exempi/main.cpp:242
    #9 0x408ece in dump_xmp /home/liwc/exempi-master/exempi/main.cpp:257
    #10 0x409b54 in process_file /home/liwc/exempi-master/exempi/main.cpp:348
    #11 0x408728 in main /home/liwc/exempi-master/exempi/main.cpp:194
    #12 0x7fd3f681d82f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)
    #13 0x407a58 in _start (/home/liwc/exempi-master/exempi/exempi+0x407a58)

0x60200000ef77 is located 1 bytes to the right of 6-byte region [0x60200000ef70,0x60200000ef76)
allocated by thread T0 here:
    #0 0x7fd3f7b54592 in operator new(unsigned long) (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x99592)
    #1 0x4fedc6 in __gnu_cxx::new_allocator<unsigned char>::allocate(unsigned long, void const*) /usr/include/c++/5/ext/new_allocator.h:104
    #2 0x4fe8f0 in std::allocator_traits<std::allocator<unsigned char> >::allocate(std::allocator<unsigned char>&, unsigned long) /usr/include/c++/5/bits/alloc_traits.h:491
    #3 0x4fe50f in std::_Vector_base<unsigned char, std::allocator<unsigned char> >::_M_allocate(unsigned long) /usr/include/c++/5/bits/stl_vector.h:170
    #4 0x58ec6d in unsigned char* std::vector<unsigned char, std::allocator<unsigned char> >::_M_allocate_and_copy<std::move_iterator<unsigned char*> >(unsigned long, std::move_iterator<unsigned char*>, std::move_iterator<unsigned char*>) (/home/liwc/exempi-master/exempi/exempi+0x58ec6d)
    #5 0x58e6c9 in std::vector<unsigned char, std::allocator<unsigned char> >::reserve(unsigned long) /usr/include/c++/5/bits/vector.tcc:75
    #6 0x5cd019 in WEBP::Chunk::Chunk(WEBP::Container*, WEBP_MetaHandler*) /home/liwc/exempi-master/XMPFiles/source/FormatSupport/WEBP_Support.cpp:38
    #7 0x5ce72c in WEBP::Container::Container(WEBP_MetaHandler*) /home/liwc/exempi-master/XMPFiles/source/FormatSupport/WEBP_Support.cpp:190
    #8 0x5c9661 in WEBP_MetaHandler::CacheFileData() /home/liwc/exempi-master/XMPFiles/source/FileHandlers/WEBP_Handler.cpp:89
    #9 0x48874f in DoOpenFile /home/liwc/exempi-master/XMPFiles/source/XMPFiles.cpp:1076
    #10 0x488f8a in XMPFiles::OpenFile(char const*, unsigned int, unsigned int) /home/liwc/exempi-master/XMPFiles/source/XMPFiles.cpp:1179
    #11 0x47e415 in WXMPFiles_OpenFile_1 /home/liwc/exempi-master/XMPFiles/source/WXMPFiles.cpp:233
    #12 0x41dab4 in TXMPFiles<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >::OpenFile(char const*, unsigned int, unsigned int) (/home/liwc/exempi-master/exempi/exempi+0x41dab4)
    #13 0x40bd79 in xmp_files_open_new /home/liwc/exempi-master/exempi/exempi.cpp:294
    #14 0x408ccb in get_xmp_from_file /home/liwc/exempi-master/exempi/main.cpp:242
    #15 0x408ece in dump_xmp /home/liwc/exempi-master/exempi/main.cpp:257
    #16 0x409b54 in process_file /home/liwc/exempi-master/exempi/main.cpp:348
    #17 0x408728 in main /home/liwc/exempi-master/exempi/main.cpp:194
    #18 0x7fd3f681d82f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)

SUMMARY: AddressSanitizer: heap-buffer-overflow /home/liwc/exempi-master/XMPFiles/source/FormatSupport/WEBP_Support.cpp:125 WEBP::VP8XChunk::VP8XChunk(WEBP::Container*)
Shadow bytes around the buggy address:
  0x0c047fff9d90: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff9da0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff9db0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff9dc0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff9dd0: fa fa fa fa fa fa 00 02 fa fa 00 04 fa fa 00 06
=>0x0c047fff9de0: fa fa fd fd fa fa 06 fa fa fa 00 fa fa fa[06]fa
  0x0c047fff9df0: fa fa fd fa fa fa fd fd fa fa fd fa fa fa 00 00
  0x0c047fff9e00: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff9e10: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff9e20: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff9e30: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07
  Heap left redzone:       fa
  Heap right redzone:      fb
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack partial redzone:   f4
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
==58159==ABORTING

```

The size of VP8XChunk was assigned to 10, but in this case there was no valid VP8XChunk, and the buffer pointed by bitstream was malloced with only 6 bytes. In this way the heap-based buffer over-read happened. A crafted webp can trigger this issue, which allows a DoS attack.

```
114 VP8XChunk::VP8XChunk(Container* parent_)
115   : Chunk(parent_, kChunk_VP8X)
116 {
117     this->needsRewrite = true;
118     this->size = 10;
119     this->data.resize(this->size);
120     this->data.assign(this->size, 0);
121     XMP_Uns8* bitstream =
122         (XMP_Uns8*)parent->chunks[WEBP_CHUNK_IMAGE][0]->data.data();
123     // See bug https://bugs.freedesktop.org/show_bug.cgi?id=105247
124     // bitstream could be NULL.
125     XMP_Uns32 width = bitstream ? ((bitstream[7] << 8) | bitstream[6]) & 0x3fff : 0; <= buffer over-read
126     XMP_Uns32 height = bitstream ? ((bitstream[9] << 8) | bitstream[8]) & 0x3fff : 0; <= buffer over-read
127     this->width(width);
128     this->height(height);
129     parent_->vp8x = this;
 }
```

You can reproduce it as below.

```
OS:Ubuntu 16.04 x86_64

export CFLAGS="-fsanitize=address -ggdb"
export CXXFLAGS="-fsanitize=address -ggdb"
export LDFLAGS="-fsanitize=address -ggdb"
sudo apt install libboost-dev
sudo apt install libboost-test-dev
./autogen.sh
./configure --disable-shared
make

./exampi/exempi -x POC -o out
```

WenChao Li of VARAS@IIE

[POC](/-/project/886/uploads/359b3d4bae8707939ffcf4b51292fca5/POC)

To upload designs, you'll need to enable LFS and have an admin enable hashed storage. [More information](/help/user/project/issues/design_management.md#prerequisites)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.freedesktop.org_54308e47_20250111_150401.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Register](/users/sign_up)

## Admin message

Due to an influx of spam, we have had to impose restrictions on new accounts. Please see [this wiki page](https://gitlab.freedesktop.org/freedesktop/freedesktop/-/wikis/home) for instructions on how to get full permissions. Sorry for the inconvenience.

**Commit
acee2894**

authored
Jul 27, 2019
by
**[![Hubert Figuiere's avatar](https://secure.gravatar.com/avatar/fdb4b80e48103ebb250a98b0c148221031fa0bb9678b7bc655c57b0bffc49763?s=96&d=identicon "Hubert Figuiere")](/hub)
[Hubert Figuiere](/hub)**

[Browse files](/libopenraw/exempi/-/tree/acee2894ceb91616543927c2a6e45050c60f98f7)

### Bug [#12](/libopenraw/exempi/-/issues/12 "A heap-based buffer over-read was found in WEBP_Support.cpp") - Invalid WebP cause memory overflow.

```

[#12](https://gitlab.freedesktop.org/libopenraw/exempi/issues/12 "A heap-based buffer over-read was found in WEBP_Support.cpp")
```

parent
[53379ec2](/libopenraw/exempi/-/commit/53379ec212ff481ff66688462140d261d63ed030)

Loading

Loading

Loading

* [Changes
  1](/libopenraw/exempi/-/commit/acee2894ceb91616543927c2a6e45050c60f98f7)

[Hide whitespace changes](/libopenraw/exempi/-/commit/acee2894ceb91616543927c2a6e45050c60f98f7?action=show&controller=projects%2Fcommit&id=acee2894ceb91616543927c2a6e45050c60f98f7&namespace_id=libopenraw&project_id=exempi&w=1)
[Inline](/libopenraw/exempi/-/commit/acee2894ceb91616543927c2a6e45050c60f98f7?view=inline)
[Side-by-side](/libopenraw/exempi/-/commit/acee2894ceb91616543927c2a6e45050c60f98f7?view=parallel)

Loading

Preview

0%
Loading

Try again

or
attach a new file

.

Cancel

You are about to add
**0
people**
to the discussion. Proceed with caution.

Finish editing this message first!

Save comment

Cancel

Please [register](/users/sign_up?redirect_to_referer=yes) or [sign in](/users/sign_in?redirect_to_referer=yes) to comment



=== Content from lists.debian.org_a7db895e_20250111_150407.html ===


---

[[Date Prev](msg00031.html)][[Date Next](msg00033.html)]
[[Thread Prev](msg00031.html)][[Thread Next](msg00033.html)]
[[Date Index](maillist.html#00032)]
[[Thread Index](threads.html#00032)]

# [SECURITY] [DLA 3585-1] exempi security update

---

* *To*: <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 3585-1] exempi security update
* *From*: rouca@debian.org
* *Date*: Mon, 25 Sep 2023 22:37:28 +0000
* *Message-id*: <[[🔎]](/msgid-search/e15123edf71ec036d20ad8901615c29d.rouca%40debian.org) [e15123edf71ec036d20ad8901615c29d.rouca@debian.org](msg00032.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3585-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                   Bastien RoucariÃ¨s
September 25, 2023                            <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : exempi
Version        : 2.5.0-2+deb10u1
CVE ID         : CVE-2020-18651 CVE-2020-18652 CVE-2021-36045 CVE-2021-36046
                 CVE-2021-36047 CVE-2021-36048 CVE-2021-36050 CVE-2021-36051
                 CVE-2021-36052 CVE-2021-36053 CVE-2021-36054 CVE-2021-36055
                 CVE-2021-36056 CVE-2021-36057 CVE-2021-36058 CVE-2021-36064
                 CVE-2021-39847 CVE-2021-40716 CVE-2021-40732 CVE-2021-42528
		 CVE-2021-42529 CVE-2021-42530 CVE-2021-42531 CVE-2021-42532

Multiple vulneratibilities were found in exempi, an implementation of XMP
(Extensible Metadata Platform).

CVE-2020-18651

    A Buffer Overflow vulnerability was found
    in function ID3_Support::ID3v2Frame::getFrameValue
    allows remote attackers to cause a denial of service.

CVE-2020-18652

    A Buffer Overflow vulnerability was found in
    WEBP_Support.cpp allows remote attackers to cause a
    denial of service.

CVE-2021-36045

    An out-of-bounds read vulnerability was found
    that could lead to disclosure of arbitrary memory.

CVE-2021-36046

    A memory corruption vulnerability was found,
    potentially resulting in arbitrary code execution
    in the context of the current use

CVE-2021-36047

    An Improper Input Validation vulnerability was found,
    potentially resulting in arbitrary
    code execution in the context of the current use.

CVE-2021-36048

    An Improper Input Validation was found,
    potentially resulting in arbitrary
    code execution in the context of the current user.

CVE-2021-36050

    A buffer overflow vulnerability was found,
    potentially resulting in arbitrary code execution
    in the context of the current user.

CVE-2021-36051

    A buffer overflow vulnerability was found,
    potentially resulting in arbitrary code execution
    in the context of the current user.

CVE-2021-36052

    A memory corruption vulnerability was found,
    potentially resulting in arbitrary code execution
    in the context of the current user.

CVE-2021-36053

    An out-of-bounds read vulnerability was found,
    that could lead to disclosure of arbitrary memory.

CVE-2021-36054

    A buffer overflow vulnerability was found potentially
    resulting in local application denial of service.

CVE-2021-36055

    A use-after-free vulnerability was found that could
    result in arbitrary code execution.

CVE-2021-36056

    A buffer overflow vulnerability was found, potentially
    resulting in arbitrary code execution in the context of
    the current user.

CVE-2021-36057

     A write-what-where condition vulnerability was found,
     caused during the application's memory allocation process.
     This may cause the memory management functions to become
     mismatched resulting in local application denial of service
     in the context of the current user.

CVE-2021-36058

    An Integer Overflow vulnerability was found, potentially
    resulting in application-level denial of service in the
    context of the current user.

CVE-2021-36064

    A Buffer Underflow vulnerability was found which
    could result in arbitrary code execution in the context
    of the current user

CVE-2021-39847

    A stack-based buffer overflow vulnerability
    potentially resulting in arbitrary code execution in the
    context of the current user.

CVE-2021-40716

    An out-of-bounds read vulnerability was found that
    could lead to disclosure of sensitive memory

CVE-2021-40732

    A null pointer dereference vulnerability was found,
    that could result in leaking data from certain memory
    locations and causing a local denial of service

CVE-2021-42528

    A Null pointer dereference vulnerability was found
    when parsing a specially crafted file. An unauthenticated attacker
    could leverage this vulnerability to achieve an application
    denial-of-service in the context of the current user.

CVE-2021-42529

    A stack-based buffer overflow vulnerability was found
    potentially resulting in arbitrary code execution
    in the context of the current user.

CVE-2021-42530

    A stack-based buffer overflow vulnerability was found
    potentially resulting in arbitrary code execution in the
    context of the current user.

CVE-2021-42531

    A stack-based buffer overflow vulnerability
    potentially resulting in arbitrary code execution in
    the context of the current user

CVE-2021-42532

    A stack-based buffer overflow vulnerability
    potentially resulting in arbitrary code execution in the
    context of the current user.

For Debian 10 buster, these problems have been fixed in version
2.5.0-2+deb10u1.

We recommend that you upgrade your exempi packages.

For the detailed security status of exempi please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/exempi>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEXQGHuUCiRbrXsPVqADoaLapBCF8FAmUSC6gACgkQADoaLapB
CF8hpA/9EMn9GrpCjfxPjbP8FlnCEUUNcNYkXlA7jnAVpH2nGwen/RseZp8uOgiR
75kyCzgrwkjvFPL8ZPgMNsUOntYbASbA2xKrlE5Qivf8+rizhouY/bLJ8DUm2+Zz
8mK6Dri3ZPsPd8Q1ymPANc9vV6QRTjzIYKk/adO1R4lK5Lb1J9Vq2Q5FSL+hoheC
wJoVL2xZT2iWRA6PiLKcLNGRcEWYsyBXK7wscnd4/bopnLeSy6GBfdhqPHpeKEvw
mZEp298+sg25N4NEm5RPzSJbk5UJaT/ySbQThSu88Jrr+GCcD9YqR6y2Md+efqCM
zxvePjC9m+BozLkZLVKQY6CQktHKG2ZW5HvYdw+NqBwV0vpfsd3a5qh918Nj5YOI
Ac+HHS27VaIcTWFWOo2/DTuqvnQL++fPZE6Jn3va/46VQXa4y9rOYl+QJS5TAd46
56IknBbA1nZwf4bvs8rd859e2MV+aBLuhMJgUIrxJ00La6ehtxtxN2fGzistVaUD
JqXFPdvWwtRAqiKLrW+htlrszjlbC2rITdEZ3ySZLkDNBwrZunRVaJZTqBU0/d6d
5xk7za0b8VElQ/xoBGQUly2R2WICt+mTJ5rH7bFbjSmyHcGZJfrmBENwFKbgBRFM
1Dww4m7PnreUWJSKTYERFevcgwDHoFGbXGYkzaRreYjlxDg/G4E=
=KI0r
-----END PGP SIGNATURE-----

```

---


