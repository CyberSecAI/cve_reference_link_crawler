=== Content from github.com_fd13fdea_20250111_001642.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpeering-manager%2Fpeering-manager%2Fcommit%2F8a865fb596c11ad7caf45aef317d8fcbce7f85ff)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpeering-manager%2Fpeering-manager%2Fcommit%2F8a865fb596c11ad7caf45aef317d8fcbce7f85ff)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=peering-manager%2Fpeering-manager)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[peering-manager](/peering-manager)
/
**[peering-manager](/peering-manager/peering-manager)**
Public

* [Notifications](/login?return_to=%2Fpeering-manager%2Fpeering-manager) You must be signed in to change notification settings
* [Fork
  95](/login?return_to=%2Fpeering-manager%2Fpeering-manager)
* [Star
   497](/login?return_to=%2Fpeering-manager%2Fpeering-manager)

* [Code](/peering-manager/peering-manager)
* [Issues
  30](/peering-manager/peering-manager/issues)
* [Pull requests
  4](/peering-manager/peering-manager/pulls)
* [Discussions](/peering-manager/peering-manager/discussions)
* [Actions](/peering-manager/peering-manager/actions)
* [Projects
  2](/peering-manager/peering-manager/projects)
* [Security](/peering-manager/peering-manager/security)
* [Insights](/peering-manager/peering-manager/pulse)

Additional navigation options

* [Code](/peering-manager/peering-manager)
* [Issues](/peering-manager/peering-manager/issues)
* [Pull requests](/peering-manager/peering-manager/pulls)
* [Discussions](/peering-manager/peering-manager/discussions)
* [Actions](/peering-manager/peering-manager/actions)
* [Projects](/peering-manager/peering-manager/projects)
* [Security](/peering-manager/peering-manager/security)
* [Insights](/peering-manager/peering-manager/pulse)

## Commit

[Permalink](/peering-manager/peering-manager/commit/8a865fb596c11ad7caf45aef317d8fcbce7f85ff)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Run Jinja2 code in sandboxed environment

[Browse files](/peering-manager/peering-manager/tree/8a865fb596c11ad7caf45aef317d8fcbce7f85ff)
Browse the repository at this point in the history

```
Also warn user in the documentation about security risks when using code
from others.
```

* Loading branch information

[![@gmazoyer](https://avatars.githubusercontent.com/u/736209?s=40&v=4)](/gmazoyer)

[gmazoyer](/peering-manager/peering-manager/commits?author=gmazoyer "View all commits by gmazoyer")
committed
Jan 25, 2024

1 parent
[0d714d1](/peering-manager/peering-manager/commit/0d714d1f30f29b6221142eac4d4accebd154f0f3)

commit 8a865fb

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**9 additions**
and
**2 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* docs/templating

  + docs/templating/index.md
    [index.md](#diff-fd6df2dc1e79222eb13ed4c70417975d60b272290dbcc6f3f65c0dfc7d8899d4)
* peering\_manager/jinja2

  + peering\_manager/jinja2/\_\_init\_\_.py
    [\_\_init\_\_.py](#diff-59e9ff470d7c0d83eac28b6110593720bcea8e4cd329c19ac622fdfc3731608a)

## There are no files selected for viewing

6 changes: 6 additions & 0 deletions

6
[docs/templating/index.md](#diff-fd6df2dc1e79222eb13ed4c70417975d60b272290dbcc6f3f65c0dfc7d8899d4 "docs/templating/index.md")

Show comments

[View file](/peering-manager/peering-manager/blob/8a865fb596c11ad7caf45aef317d8fcbce7f85ff/docs/templating/index.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -3,6 +3,12 @@ |
|  |  | Peering Manager comes with a built-in templating feature. This feature can be |
|  |  | used to generate configuration for routers as well as e-mails. |
|  |  |  |
|  |  | !!! warning |
|  |  | Even though Peering Manager uses a sandboxed environment to run Jinja2 |
|  |  | logic, the language is powerful enough to do things that can potentially |
|  |  | leak confidential details or even harm the machine. Be extremely careful |
|  |  | when using code from someone else. |
|  |  |  |
|  |  | ## Jinja2 |
|  |  |  |
|  |  | The templating feature is based on |
| Expand Down | |  |

5 changes: 3 additions & 2 deletions

5
[peering\_manager/jinja2/\_\_init\_\_.py](#diff-59e9ff470d7c0d83eac28b6110593720bcea8e4cd329c19ac622fdfc3731608a "peering_manager/jinja2/__init__.py")

Show comments

[View file](/peering-manager/peering-manager/blob/8a865fb596c11ad7caf45aef317d8fcbce7f85ff/peering_manager/jinja2/__init__.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -10,9 +10,10 @@ def render\_jinja2(template, context, trim=False, lstrip=False): |
|  |  | import traceback |
|  |  |  |
|  |  | from django.conf import settings |
|  |  | from jinja2 import Environment, TemplateSyntaxError |
|  |  | from jinja2 import TemplateSyntaxError |
|  |  | from jinja2.sandbox import SandboxedEnvironment |
|  |  |  |
|  |  | environment = Environment( |
|  |  | environment = SandboxedEnvironment( |
|  |  | loader=PeeringManagerLoader(), trim\_blocks=trim, lstrip\_blocks=lstrip |
|  |  | ) |
|  |  | environment.add\_extension(IncludeTemplateExtension) |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `8a865fb`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpeering-manager%2Fpeering-manager%2Fcommit%2F8a865fb596c11ad7caf45aef317d8fcbce7f85ff) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from stackoverflow.com_8c384499_20250111_001643.html ===


[Skip to main content](#content)

[Stack Overflow](https://stackoverflow.com)

1. [About](https://stackoverflow.co/)
2. Products
3. [OverflowAI](https://stackoverflow.co/teams/ai/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=top-nav-bar&utm_content=overflowai)

1. [Stack Overflow for Teams
   Where developers & technologists share private knowledge with coworkers](https://stackoverflow.co/teams/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=top-nav&utm_content=stack-overflow-for-teams)
2. [Advertising & Talent
   Reach devs & technologists worldwide about your product, service or employer brand](https://stackoverflow.co/advertising/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=top-nav&utm_content=stack-overflow-advertising)
3. [OverflowAI
   GenAI features for Teams](https://stackoverflow.co/teams/ai/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=top-nav&utm_content=overflow-ai)
4. [OverflowAPI
   Train & fine-tune LLMs](https://stackoverflow.co/api-solutions/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=top-nav&utm_content=overflow-api)
5. [Labs
   The future of collective knowledge sharing](https://stackoverflow.co/labs/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=top-nav&utm_content=labs)
6. [About the company](https://stackoverflow.co/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=top-nav&utm_content=about-the-company)
   [Visit the blog](https://stackoverflow.blog/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=top-nav&utm_content=blog)

Loading…

1. ### [current community](https://stackoverflow.com)

   * [Stack Overflow](https://stackoverflow.com)

     [help](https://stackoverflow.com/help)
     [chat](https://chat.stackoverflow.com/?tab=site&host=stackoverflow.com)
   * [Meta Stack Overflow](https://meta.stackoverflow.com)
   ### your communities

   [Sign up](https://stackoverflow.com/users/signup?ssrc=site_switcher&returnurl=https%3a%2f%2fstackoverflow.com%2fquestions%2f73939573%2fhow-to-sanitise-string-of-python-code-with-python) or [log in](https://stackoverflow.com/users/login?ssrc=site_switcher&returnurl=https%3a%2f%2fstackoverflow.com%2fquestions%2f73939573%2fhow-to-sanitise-string-of-python-code-with-python) to customize your list.

   ### [more stack exchange communities](https://stackexchange.com/sites)

   [company blog](https://stackoverflow.blog)
3. [Log in](https://stackoverflow.com/users/login?ssrc=head&returnurl=https%3a%2f%2fstackoverflow.com%2fquestions%2f73939573%2fhow-to-sanitise-string-of-python-code-with-python)
4. [Sign up](https://stackoverflow.com/users/signup?ssrc=head&returnurl=https%3a%2f%2fstackoverflow.com%2fquestions%2f73939573%2fhow-to-sanitise-string-of-python-code-with-python)

1. 1. [Home](/)
   2. [Questions](/questions)
   3. [Tags](/tags)
   5. [Users](/users)
   6. [Companies](https://stackoverflow.com/jobs/companies?so_medium=stackoverflow&so_source=SiteNav)
   7. Labs
   8. [Jobs](/jobs?source=so-left-nav)
   9. [Discussions](/beta/discussions)
   10. Collectives
   11. Communities for your favorite technologies. [Explore all Collectives](/collectives-all)
2. Teams
   ![](https://cdn.sstatic.net/Img/teams/teams-promo.svg?v=e507948b81bf)

   Ask questions, find answers and collaborate at work with Stack Overflow for Teams.

   [Try Teams for free](https://stackoverflowteams.com/teams/create/free/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=side-bar&utm_content=explore-teams)
   [Explore Teams](https://stackoverflow.co/teams/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=side-bar&utm_content=explore-teams)
3. Teams
4. Ask questions, find answers and collaborate at work with Stack Overflow for Teams.
   [Explore Teams](https://stackoverflow.co/teams/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=side-bar&utm_content=explore-teams-compact)

##### Collectives™ on Stack Overflow

Find centralized, trusted content and collaborate around the technologies you use most.

[Learn more about Collectives](/collectives)

**Teams**

Q&A for work

Connect and share knowledge within a single location that is structured and easy to search.

[Learn more about Teams](https://stackoverflow.co/teams/)

Get early access and see previews of new features.

 [Learn more about Labs](https://stackoverflow.co/labs/)

# [How to sanitise string of Python code with Python?](/questions/73939573/how-to-sanitise-string-of-python-code-with-python)

[Ask Question](/questions/ask)

Asked
2 years, 3 months ago

Modified
[2 years, 3 months ago](?lastactivity "2022-10-04 16:49:23Z")

Viewed
584 times

1

I am using Jinja2 as my templating engine for an admin dashboard, that displays some user feedback. I worry that an attacker could type some python code as their feedback and the Jinja2 template could execute that.

I.e.

An attacker might put the following as their feedback:

```
__import__('subprocess').getoutput('tree')

```

When the templater renders this, i.e.

```
feedback = "__import__('subprocess').getoutput('tree')"
Template("{{ feedback }}").render(feedback=feedback)

```

The tree command is run in the terminal.

How can I sanitise my strings so that they do not include any python code which might allow them access to my server via the command line?

* [python](/questions/tagged/python "show questions tagged 'python'")
* [security](/questions/tagged/security "show questions tagged 'security'")
* [jinja2](/questions/tagged/jinja2 "show questions tagged 'jinja2'")

[Share](/q/73939573 "Short permalink to this question")

[Improve this question](/posts/73939573/edit)

Follow

[edited Oct 4, 2022 at 16:45](/posts/73939573/revisions "show all edits to this post")

SamTheProgrammer

asked Oct 3, 2022 at 18:44

[![SamTheProgrammer's user avatar](https://www.gravatar.com/avatar/28bc814aa25c087cfe475e064b7697f9?s=64&d=identicon&r=PG&f=y&so-version=2)](/users/15515166/samtheprogrammer)

[SamTheProgrammer](/users/15515166/samtheprogrammer)SamTheProgrammer
1,18511 gold badge1313 silver badges3434 bronze badges

7

* 1

  Escape (or remove) `{` characters in the user-supplied string. Maybe jinja2 has some escape function to do it better.
  – [pts](/users/97248/pts "87,041 reputation")

  Commented
  Oct 3, 2022 at 18:51
* I did not mean that the things between the {{}} brackets. Please read new edit.
  – [SamTheProgrammer](/users/15515166/samtheprogrammer "1,185 reputation")

  Commented
  Oct 3, 2022 at 18:53
* I mean that the string contains the code, and is stored as a string variable. This is interpolated, and executed by the Jinja2 templater.
  – [SamTheProgrammer](/users/15515166/samtheprogrammer "1,185 reputation")

  Commented
  Oct 3, 2022 at 18:55
* 2

  The template `{{ feedback }}` in your code is already safe and correct: Python commands within the feedback string variable won't be executed.
  – [pts](/users/97248/pts "87,041 reputation")

  Commented
  Oct 3, 2022 at 19:00
* 1

  Unless you do `{{ feedback | safe }}`, your ... well, safe: [jinja.palletsprojects.com/en/3.1.x/templates/…](https://jinja.palletsprojects.com/en/3.1.x/templates/#jinja-filters.safe)
  – [β.εηοιτ.βε](/users/2123530/%CE%B2-%CE%B5%CE%B7%CE%BF%CE%B9%CF%84-%CE%B2%CE%B5 "38,929 reputation")

  Commented
  Oct 3, 2022 at 19:05

 |
Show **2** more comments

## 1 Answer 1

Sorted by:

[Reset to default](/questions/73939573/how-to-sanitise-string-of-python-code-with-python?answertab=scoredesc#tab-top)

Highest score (default)

Trending (recent votes count more)

Date modified (newest first)

Date created (oldest first)

0

The solution is that the templater only executes it if you put it directly in the template.

So...

```
Template("{{ __import__('subprocess').getoutput('tree') }}").render()

```

executes the code.

Whereas...

```
x = "__import__('subprocess').getoutput('tree')"
Template("{{ x }}").render(x=x)

```

Will not. So treat them as strings and vulnerabilities are mitigated.

[Share](/a/73951153 "Short permalink to this answer")

[Improve this answer](/posts/73951153/edit)

Follow

answered Oct 4, 2022 at 16:49

[![SamTheProgrammer's user avatar](https://www.gravatar.com/avatar/28bc814aa25c087cfe475e064b7697f9?s=64&d=identicon&r=PG&f=y&so-version=2)](/users/15515166/samtheprogrammer)

[SamTheProgrammer](/users/15515166/samtheprogrammer)SamTheProgrammer
1,18511 gold badge1313 silver badges3434 bronze badges

Add a comment
 |

## Your Answer

**Reminder:** Answers generated by artificial intelligence tools are not allowed on Stack Overflow. [Learn more](/help/gen-ai-policy)

Thanks for contributing an answer to Stack Overflow!

* Please be sure to *answer the question*. Provide details and share your research!

But *avoid* …

* Asking for help, clarification, or responding to other answers.
* Making statements based on opinion; back them up with references or personal experience.

To learn more, see our [tips on writing great answers](/help/how-to-answer).

Draft saved
Draft discarded

### Sign up or [log in](/users/login?ssrc=question_page&returnurl=https%3a%2f%2fstackoverflow.com%2fquestions%2f73939573%2fhow-to-sanitise-string-of-python-code-with-python%23new-answer)

 Sign up using Google

 Sign up using Email and Password

Submit
### Post as a guest

Name

Email

Required, but never shown

### Post as a guest

Name

Email

Required, but never shown

Post Your Answer

Discard

By clicking “Post Your Answer”, you agree to our [terms of service](https://stackoverflow.com/legal/terms-of-service/public) and acknowledge you have read our [privacy policy](https://stackoverflow.com/legal/privacy-policy).

## Not the answer you're looking for? Browse other questions tagged * [python](/questions/tagged/python "show questions tagged 'python'") * [security](/questions/tagged/security "show questions tagged 'security'") * [jinja2](/questions/tagged/jinja2 "show questions tagged 'jinja2'") or [ask your own question](/questions/ask).

* The Overflow Blog
* [Failing fast at scale: Rapid prototyping at Intuit](https://stackoverflow.blog/2025/01/08/failing-fast-at-scale-rapid-prototyping-at-intuit/)
* [“Data is the key”: Twilio’s Head of R&D on the need for good data](https://stackoverflow.blog/2025/01/10/data-is-the-key-twilio-s-head-of-r-and-d-on-the-need-for-good-data/)
* Featured on Meta
* [The December 2024 Community Asks Sprint has been moved to March 2025 (and...](https://meta.stackexchange.com/questions/404724/the-december-2024-community-asks-sprint-has-been-moved-to-march-2025-and-length "The December 2024 Community Asks Sprint has been moved to March 2025 (and lengthened to 2 weeks to compensate)")
* [Voting experiment to encourage people who rarely vote to upvote](https://meta.stackoverflow.com/questions/432459/voting-experiment-to-encourage-people-who-rarely-vote-to-upvote)

#### Related

[64](/q/16861 "Question score (upvotes - downvotes)")
[Sanitising user input using Python](/questions/16861/sanitising-user-input-using-python)

[39](/q/1556554 "Question score (upvotes - downvotes)")
[How do I html-escape dangerous unsanitized input in jinja2?](/questions/1556554/how-do-i-html-escape-dangerous-unsanitized-input-in-jinja2)

[11](/q/2627135 "Question score (upvotes - downvotes)")
[How do I sanitize LaTeX input?](/questions/2627135/how-do-i-sanitize-latex-input)

[26](/q/12339806 "Question score (upvotes - downvotes)")
[Escape strings for JavaScript using Jinja2?](/questions/12339806/escape-strings-for-javascript-using-jinja2)

[16](/q/13066594 "Question score (upvotes - downvotes)")
[Is there a way to secure strings for Python's eval?](/questions/13066594/is-there-a-way-to-secure-strings-for-pythons-eval)

[1](/q/29701870 "Question score (upvotes - downvotes)")
[Python, Jinja2 nl2br and security](/questions/29701870/python-jinja2-nl2br-and-security)

[2](/q/35238976 "Question score (upvotes - downvotes)")
[Escaping string and then adding html tags in jinja](/questions/35238976/escaping-string-and-then-adding-html-tags-in-jinja)

[3](/q/45578984 "Question score (upvotes - downvotes)")
[Is there a safe alternative to striptags in Jinja?](/questions/45578984/is-there-a-safe-alternative-to-striptags-in-jinja)

[0](/q/56312797 "Question score (upvotes - downvotes)")
[Sanitizing JSON Strings without \](/questions/56312797/sanitizing-json-strings-without)

[0](/q/61469251 "Question score (upvotes - downvotes)")
[Python: Safely render user entered html code](/questions/61469251/python-safely-render-user-entered-html-code)

#### [Hot Network Questions](https://stackexchange.com/questions?tab=hot)

* [123456789 = 987654321?](https://puzzling.stackexchange.com/questions/130004/123456789-987654321)
* [What is הרעש השביעי?](https://judaism.stackexchange.com/questions/146964/what-is-%D7%94%D7%A8%D7%A2%D7%A9-%D7%94%D7%A9%D7%91%D7%99%D7%A2%D7%99)
* [The sum of reciprocals of divisors is not injective](https://math.stackexchange.com/questions/5021723/the-sum-of-reciprocals-of-divisors-is-not-injective)
* [Is there a way to confirm your Alipay works before arriving in China?](https://travel.stackexchange.com/questions/192951/is-there-a-way-to-confirm-your-alipay-works-before-arriving-in-china)
* [How are countries' militaries responding to inflammatory statements made by incoming US leadership?](https://politics.stackexchange.com/questions/90258/how-are-countries-militaries-responding-to-inflammatory-statements-made-by-inco)
* [How can I find TCP packets with specific data in a Wireshark capture?](https://superuser.com/questions/1870047/how-can-i-find-tcp-packets-with-specific-data-in-a-wireshark-capture)
* [(tcolorbox, memoize, tikz, titlesec) Package collargs Error: Environment "tikzpicture" ended as "tcb@drawing"](https://tex.stackexchange.com/questions/734681/tcolorbox-memoize-tikz-titlesec-package-collargs-error-environment-tikzpi)
* [Why was Jesus taken to Egypt when it was forbidden by God for Jews to re-enter Egypt?](https://hermeneutics.stackexchange.com/questions/100366/why-was-jesus-taken-to-egypt-when-it-was-forbidden-by-god-for-jews-to-re-enter-e)
* [TikZ Parametric Surface Debugging Request](https://tex.stackexchange.com/questions/734691/tikz-parametric-surface-debugging-request)
* [Can equipment used in Alcohol distillation be used for the small-scale distillation of crude oil](https://chemistry.stackexchange.com/questions/186751/can-equipment-used-in-alcohol-distillation-be-used-for-the-small-scale-distillat)
* [May I leave the airport during a Singapore transit to visit the city while my checked-through luggage is handled by the airport staff?](https://travel.stackexchange.com/questions/192977/may-i-leave-the-airport-during-a-singapore-transit-to-visit-the-city-while-my-ch)
* [How can I control LED brightness from an MCU without using PWM](https://electronics.stackexchange.com/questions/735422/how-can-i-control-led-brightness-from-an-mcu-without-using-pwm)
* [Can I use an A or D string on my violin in place of a G string?](https://music.stackexchange.com/questions/138533/can-i-use-an-a-or-d-string-on-my-violin-in-place-of-a-g-string)
* [When did the Church Fathers start drawing a connection between Jesus' "I AM" statements and God calling himself the "I AM" in Exodus 3:14?](https://christianity.stackexchange.com/questions/104677/when-did-the-church-fathers-start-drawing-a-connection-between-jesus-i-am-sta)
* [Comic book where Spider-Man defeats a Sentinel, only to discover hundreds or thousands more attacking the city](https://scifi.stackexchange.com/questions/294131/comic-book-where-spider-man-defeats-a-sentinel-only-to-discover-hundreds-or-tho)
* [How do I get the drain plug out of the sink?](https://diy.stackexchange.com/questions/312729/how-do-i-get-the-drain-plug-out-of-the-sink)
* [Momentum measurement and uncertainity principle](https://physics.stackexchange.com/questions/839462/momentum-measurement-and-uncertainity-principle)
* [How is heat loss related to heat source?](https://diy.stackexchange.com/questions/312774/how-is-heat-loss-related-to-heat-source)
* [Merge two (saved) Apple II BASIC programs in memory](https://retrocomputing.stackexchange.com/questions/31123/merge-two-saved-apple-ii-basic-programs-in-memory)
* [Does a consistent heuristic have value 0 on a goal state?](https://ai.stackexchange.com/questions/47718/does-a-consistent-heuristic-have-value-0-on-a-goal-state)
* [Traveling to the UK](https://travel.stackexchange.com/questions/192978/traveling-to-the-uk)
* [Is it idiomatic to say "I just played" or "I was just playing" in response to the question "What did you do this morning"?](https://ell.stackexchange.com/questions/361067/is-it-idiomatic-to-say-i-just-played-or-i-was-just-playing-in-response-to-th)
* [Will the first Mars mission force the space laundry question?](https://space.stackexchange.com/questions/67651/will-the-first-mars-mission-force-the-space-laundry-question)
* [How would 0 visibility combat change weapon choice and military strategy](https://worldbuilding.stackexchange.com/questions/264008/how-would-0-visibility-combat-change-weapon-choice-and-military-strategy)

more hot questions

[Question feed](/feeds/question/73939573 "Feed of this question and its answers")

# Subscribe to RSS

Question feed

To subscribe to this RSS feed, copy and paste this URL into your RSS reader.

![](/posts/73939573/ivc/bbb1?prg=8189c1bf-a0ac-42c3-811c-a463893880ad)lang-py

##### [Stack Overflow](https://stackoverflow.com)

* [Questions](/questions)
* [Help](/help)
* [Chat](https://chat.stackoverflow.com/?tab=site&host=stackoverflow.com)

##### [Products](https://stackoverflow.co/)

* [Teams](https://stackoverflow.co/teams/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=footer&utm_content=teams)
* [Advertising](https://stackoverflow.co/advertising/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=footer&utm_content=advertising)
* [Talent](https://stackoverflow.co/advertising/employer-branding/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=footer&utm_content=talent)

##### [Company](https://stackoverflow.co/)

* [About](https://stackoverflow.co/)
* [Press](https://stackoverflow.co/company/press/)
* [Work Here](https://stackoverflow.co/company/work-here/)
* [Legal](https://stackoverflow.com/legal)
* [Privacy Policy](https://stackoverflow.com/legal/privacy-policy)
* [Terms of Service](https://stackoverflow.com/legal/terms-of-service/public)
* [Contact Us](/contact)
* Cookie Settings
* [Cookie Policy](https://stackoverflow.com/legal/cookie-policy)

##### [Stack Exchange Network](https://stackexchange.com)

* [Technology](https://stackexchange.com/sites#technology)
* [Culture & recreation](https://stackexchange.com/sites#culturerecreation)
* [Life & arts](https://stackexchange.com/sites#lifearts)
* [Science](https://stackexchange.com/sites#science)
* [Professional](https://stackexchange.com/sites#professional)
* [Business](https://stackexchange.com/sites#business)
* [API](https://api.stackexchange.com/)
* [Data](https://data.stackexchange.com/)

* [Blog](https://stackoverflow.blog?blb=1)
* [Facebook](https://www.facebook.com/officialstackoverflow/)
* [Twitter](https://twitter.com/stackoverflow)
* [LinkedIn](https://linkedin.com/company/stack-overflow)
* [Instagram](https://www.instagram.com/thestackoverflow)

Site design / logo © 2025 Stack Exchange Inc;
user contributions licensed under
[CC BY-SA](https://stackoverflow.com/help/licensing)
.
rev 2025.1.7.20880



=== Content from github.com_1cfba992_20250111_001643.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpeering-manager%2Fpeering-manager%2Fsecurity%2Fadvisories%2FGHSA-q37x-qfrx-jcv6)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpeering-manager%2Fpeering-manager%2Fsecurity%2Fadvisories%2FGHSA-q37x-qfrx-jcv6)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=peering-manager%2Fpeering-manager)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[peering-manager](/peering-manager)
/
**[peering-manager](/peering-manager/peering-manager)**
Public

* [Notifications](/login?return_to=%2Fpeering-manager%2Fpeering-manager) You must be signed in to change notification settings
* [Fork
  95](/login?return_to=%2Fpeering-manager%2Fpeering-manager)
* [Star
   497](/login?return_to=%2Fpeering-manager%2Fpeering-manager)

* [Code](/peering-manager/peering-manager)
* [Issues
  30](/peering-manager/peering-manager/issues)
* [Pull requests
  4](/peering-manager/peering-manager/pulls)
* [Discussions](/peering-manager/peering-manager/discussions)
* [Actions](/peering-manager/peering-manager/actions)
* [Projects
  2](/peering-manager/peering-manager/projects)
* [Security](/peering-manager/peering-manager/security)
* [Insights](/peering-manager/peering-manager/pulse)

Additional navigation options

* [Code](/peering-manager/peering-manager)
* [Issues](/peering-manager/peering-manager/issues)
* [Pull requests](/peering-manager/peering-manager/pulls)
* [Discussions](/peering-manager/peering-manager/discussions)
* [Actions](/peering-manager/peering-manager/actions)
* [Projects](/peering-manager/peering-manager/projects)
* [Security](/peering-manager/peering-manager/security)
* [Insights](/peering-manager/peering-manager/pulse)

# Remote Code Execution using Server Side Template Injection

High

[gmazoyer](/gmazoyer)
published
GHSA-q37x-qfrx-jcv6
Mar 12, 2024

## Package

peering-manager/peering-manager
(git)

## Affected versions

<=1.8.2

## Patched versions

1.8.3

docker

peeringmanager/peering-manager
([docker](/advisories?query=ecosystem%3Adocker))

<=1.8.2

1.8.3

## Description

### Summary

There is a [Server Side Template Injection](https://owasp.org/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/07-Input_Validation_Testing/18-Testing_for_Server_Side_Template_Injection) vulnerability that leads to [Remote Code Execution](https://owasp.org/www-community/attacks/Command_Injection) in Peering Manager `<=1.8.2`.

### Impact

Arbitrary commands can be executed on the operating system that is running Peering Manager.

### Suggestions

* Update to version `1.8.3` where a sandbox is used for jinja templates.
* As now mentioned in the documentation, sandboxing is not a guaranteed protection. Always check any code before using it in your instance.

### Further References

* <https://hub.ntc.swiss/ntcf-2023-72886>
* <https://docs.peering-manager.net/templating/>
* <https://docs.cobalt.io/bestpractices/prevent-ssti/>
* <https://stackoverflow.com/questions/73939573/how-to-sanitise-string-of-python-code-with-python>

### Severity

High

8.1

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
High

User interaction
Required

Scope
Changed

Confidentiality
High

Integrity
High

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:H/A:N

### CVE ID

CVE-2024-28114

### Weaknesses

[CWE-1336](/advisories?query=cwe%3A1336)

### Credits

* [![@ntc-swiss-team](https://avatars.githubusercontent.com/u/146006358?s=40&v=4)](/ntc-swiss-team)
  [ntc-swiss-team](/ntc-swiss-team)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from owasp.org_a6b3f139_20250111_001643.html ===


For full functionality of this site it is necessary to enable JavaScript. Here are the  [instructions how to enable JavaScript in your web browser](http://turnonjs.com/).

[![OWASP logo](https://owasp.org/assets/images/logo.png)](https://owasp.org/)

[![](https://owasp.org/assets/images/logo.png)](https://owasp.org/)

 [Store](https://owasp.org/store)
[Donate](https://owasp.org/donate?reponame=www-community)
[Join](https://owasp.org/membership)

This website uses cookies to analyze our traffic and only share that information with our analytics partners.

Accept

x

[Store](https://owasp.org/store)
[Donate](https://owasp.org/donate?reponame=www-community)
[Join](https://owasp.org/membership)

# Command Injection

**Author:** Weilin Zhong

**Contributor(s):** Wichers, Amwestgate, Rezos, Clow808, KristenS, Jason Li, Andrew Smith, Jmanico, Tal Mel, kingthorin

## Description

Command injection is an attack in which the goal is execution of
arbitrary commands on the host operating system via a vulnerable
application. Command injection attacks are possible when an application
passes unsafe user supplied data (forms, cookies, HTTP headers etc.) to
a system shell. In this attack, the attacker-supplied operating system
commands are usually executed with the privileges of the vulnerable
application. Command injection attacks are possible largely due to
insufficient input validation.

This attack differs from [Code Injection](Code_Injection "wikilink"), in
that code injection allows the attacker to add their own code that is then
executed by the application. In Command Injection, the attacker extends
the default functionality of the application, which execute system
commands, without the necessity of injecting code.

## Examples

### Example 1

The following code is a wrapper around the UNIX command *cat* which
prints the contents of a file to standard output. It is also injectable:

```
#include <stdio.h>
#include <unistd.h>

int main(int argc, char **argv) {
 char cat[] = "cat ";
 char *command;
 size_t commandLength;

 commandLength = strlen(cat) + strlen(argv[1]) + 1;
 command = (char *) malloc(commandLength);
 strncpy(command, cat, commandLength);
 strncat(command, argv[1], (commandLength - strlen(cat)) );

 system(command);
 return (0);
}

```

Used normally, the output is simply the contents of the file requested:

```
$ ./catWrapper Story.txt
When last we left our heroes...

```

However, if we add a semicolon and another command to the end of this
line, the command is executed by catWrapper with no complaint:

```
$ ./catWrapper "Story.txt; ls"
When last we left our heroes...
Story.txt               doubFree.c              nullpointer.c
unstosig.c              www*                    a.out*
format.c                strlen.c                useFree*
catWrapper*             misnull.c               strlength.c             useFree.c
commandinjection.c      nodefault.c             trunc.c                 writeWhatWhere.c

```

If catWrapper had been set to have a higher privilege level than the
standard user, arbitrary commands could be executed with that higher
privilege.

### Example 2

The following simple program accepts a filename as a command line
argument, and displays the contents of the file back to the user. The
program is installed setuid root because it is intended for use as a
learning tool to allow system administrators in-training to inspect
privileged system files without giving them the ability to modify them
or damage the system.

```
int main(char* argc, char** argv) {
 char cmd[CMD_MAX] = "/usr/bin/cat ";
 strcat(cmd, argv[1]);
 system(cmd);
}

```

Because the program runs with root privileges, the call to system() also
executes with root privileges. If a user specifies a standard filename,
the call works as expected. However, if an attacker passes a string of
the form “;rm -rf /”, then the call to system() fails to execute cat due
to a lack of arguments and then plows on to recursively delete the
contents of the root partition.

### Example 3

The following code from a privileged program uses the environment
variable $APPHOME to determine the application’s installation directory,
and then executes an initialization script in that directory.

```
...
char* home=getenv("APPHOME");
char* cmd=(char*)malloc(strlen(home)+strlen(INITCMD));
if (cmd) {
 strcpy(cmd,home);
 strcat(cmd,INITCMD);
 execl(cmd, NULL);
}
...

```

As in Example 2, the code in this example allows an attacker to execute
arbitrary commands with the elevated privilege of the application. In
this example, the attacker can modify the environment variable $APPHOME
to specify a different path containing a malicious version of INITCMD.
Because the program does not validate the value read from the
environment, by controlling the environment variable, the attacker can
fool the application into running malicious code.

The attacker is using the environment variable to control the command
that the program invokes, so the effect of the environment is explicit
in this example. We will now turn our attention to what can happen when
the attacker changes the way the command is interpreted.

### Example 4

The code below is from a web-based CGI utility that allows users to
change their passwords. The password update process under NIS includes
running *make* in the /var/yp directory. Note that since the program
updates password records, it has been installed setuid root.

The program invokes make as follows:

```
system("cd /var/yp && make &> /dev/null");

```

Unlike the previous examples, the command in this example is hardcoded,
so an attacker cannot control the argument passed to system(). However,
since the program does not specify an absolute path for make, and does
not scrub any environment variables prior to invoking the command, the
attacker can modify their $PATH variable to point to a malicious binary
named make and execute the CGI script from a shell prompt. And since the
program has been installed setuid root, the attacker’s version of make
now runs with root privileges.

The environment plays a powerful role in the execution of system
commands within programs. Functions like system() and exec() use the
environment of the program that calls them, and therefore attackers have
a potential opportunity to influence the behavior of these calls.

There are many sites that will tell you that Java’s Runtime.exec is
exactly the same as C’s system function. This is not true. Both allow
you to invoke a new program/process. However, C’s system function passes
its arguments to the shell (/bin/sh) to be parsed, whereas Runtime.exec
tries to split the string into an array of words, then executes the
first word in the array with the rest of the words as parameters.
Runtime.exec does NOT try to invoke the shell at any point. The key
difference is that much of the functionality provided by the shell that
could be used for mischief (chaining commands using “&”, “&&”, “|”,
“||”, etc, redirecting input and output) would simply end up as a
parameter being passed to the first command, and likely causing a syntax
error, or being thrown out as an invalid parameter.

### Example 5

The following trivial code snippets are vulnerable to OS command
injection on the Unix/Linux platform:

**C:**

```
#include <stdlib.h>
#include <stdio.h>
#include <string.h>

int main(int argc, char **argv)
{
     char command[256];

     if(argc != 2) {
          printf("Error: Please enter a program to time!\n");
          return -1;
     }

     memset(&command, 0, sizeof(command));

     strcat(command, "time ./");
     strcat(command, argv[1]);

     system(command);
     return 0;
}

```

If this were a suid binary, consider the case when an attacker
enters the following: `ls; cat /etc/shadow`. In the Unix environment,
shell commands are separated by a semi-colon. We now can execute system
commands at will!

**Java:**

There are many sites that will tell you that Java’s `Runtime.exec` is
exactly the same as C’s system function. This is not true. Both allow
you to invoke a new program/process. However, C’s system function passes
its arguments to the shell (`/bin/sh`) to be parsed, whereas Runtime.exec
tries to split the string into an array of words, then executes the
first word in the array with the rest of the words as parameters.
Runtime.exec does NOT try to invoke the shell at any point. The key
difference is that much of the functionality provided by the shell that
could be used for mischief (chaining commands using `&`, `&&`, `|`,
`||`, etc, redirecting input and output) would simply end up as a
parameter being passed to the first command, and likely causing a syntax
error, or being thrown out as an invalid parameter.

### Example 6

The following PHP code snippet is vulnerable to a command injection
attack:

```
<?php
print("Please specify the name of the file to delete");
print("<p>");
$file=$_GET['filename'];
system("rm $file");
?>

```

The following request and response is an example of a successful attack:

Request `http://127.0.0.1/delete.php?filename=bob.txt;id`

Response

```
Please specify the name of the file to delete

uid=33(www-data) gid=33(www-data) groups=33(www-data)

```

Sanitizing Input

```
Replace or Ban arguments with “;”
Other shell escapes available
Example:
–  &&
–  |
–  ...

```
## Related [Controls](https://owasp.org/www-community/controls/)

Ideally, a developer should use existing API for their language. For
example (Java): Rather than use `Runtime.exec()` to issue a ‘mail’
command, use the available Java API located at `javax.mail.*`.

If no such available API exists, the developer should scrub all input
for malicious characters. Implementing a positive security model would
be most efficient. Typically, it is much easier to define the legal
characters than the illegal characters.

## References

* [CWE-77: Command Injection](http://cwe.mitre.org/data/definitions/77.html)
* [CWE-78: OS Command Injection](http://cwe.mitre.org/data/definitions/78.html)

[Category:Injection](https://owasp.org/www-community/Injection_Flaws)

---

[Watch](https://github.com/owasp/www-community/subscription)
[Star](https://github.com/owasp/www-community)

**The OWASP® Foundation** works to improve the security of software through its community-led open source software projects,
hundreds of chapters worldwide, tens of thousands of members, and by hosting local and global conferences.
### Important Community Links

* [Community](/www-community/)
* Attacks (You are here)
* [Vulnerabilities](/www-community/vulnerabilities)
* [Controls](/www-community/controls)

### Upcoming OWASP Global Events

## Corporate Supporters

[Become a corporate supporter](https://owasp.org/supporters)

* [HOME](https://owasp.org/)
* [PROJECTS](https://owasp.org/projects/)
* [CHAPTERS](https://owasp.org/chapters/)
* [EVENTS](https://owasp.org/events/)
* [ABOUT](https://owasp.org/about/)
* [PRIVACY](https://owasp.org/www-policy/operational/privacy)
* [SITEMAP](https://owasp.org/sitemap/)
* [CONTACT](https://owasp.org/contact/)

OWASP, the OWASP logo, and Global AppSec are registered trademarks and AppSec Days, AppSec California, AppSec Cali, SnowFROC, and LASCON are trademarks of the OWASP Foundation, Inc. Unless otherwise specified, all content on the site is Creative Commons Attribution-ShareAlike v4.0 and provided without warranty of service or accuracy. For more information, please refer to our [General Disclaimer](/www-policy/operational/general-disclaimer.html). OWASP does not endorse or recommend commercial products or services, allowing our community to remain vendor neutral with the collective wisdom of the best minds in software security worldwide. Copyright 2025, OWASP Foundation, Inc.



=== Content from owasp.org_80de5302_20250111_001643.html ===


For full functionality of this site it is necessary to enable JavaScript. Here are the  [instructions how to enable JavaScript in your web browser](http://turnonjs.com/).
You're viewing a past version of the Web Security Testing Guide project. For the latest stable version, [visit /stable](/www-project-web-security-testing-guide/stable/).

[![OWASP logo](https://owasp.org/assets/images/logo.png)](https://owasp.org/)

[![](https://owasp.org/assets/images/logo.png)](https://owasp.org/)

 [Store](https://owasp.org/store)
[Donate](https://owasp.org/donate?reponame=www-project-web-security-testing-guide&title=WSTG+-+v4.1)
[Join](https://owasp.org/membership)

This website uses cookies to analyze our traffic and only share that information with our analytics partners.

Accept

x

[Store](https://owasp.org/store)
[Donate](https://owasp.org/donate?reponame=www-project-web-security-testing-guide&title=WSTG+-+v4.1)
[Join](https://owasp.org/membership)

# WSTG - v4.1

# Testing for Server Side Template Injection

| ID |
| --- |
| WSTG-INPV-18 |

## Summary

Web applications commonly use server side templating technologies (Jinja2, Twig, FreeMaker, etc.) to generate dynamic HTML responses. Server Side Template Injection vulnerabilities (SSTI) occur when user input is embedded in a template in an unsafe manner and results in remote code execution on the server. Any features that support advanced user-supplied markup may be vulnerable to SSTI including wiki-pages, reviews, marketing applications, CMS systems etc. Some template engines employ various mechanisms (eg. sandbox, whitelisting, etc.) to protect against SSTI.

## Example - Twig

The following example is an excerpt from the [Extreme Vulnerable Web Application](https://github.com/s4n7h0/xvwa) project.

```
public function getFilter($name)
{
        [snip]
        foreach ($this->filterCallbacks as $callback) {
        if (false !== $filter = call_user_func($callback, $name)) {
            return $filter;
        }
    }
    return false;
}

```

In the getFilter function the `call_user_func($callback, $name)` is vulnerable to SSTI: the `name` parameter is fetched from the HTTP GET request and executed by the server:

![SSTI XVWA Example](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/07-Input_Validation_Testing/images/SSTI_XVWA.jpeg)

## Example - Flask/Jinja2

The following example uses Flask and Jinja2 templating engine. The `page` function accepts a ‘name’ parameter from an HTTP GET request and renders an HTML response with the `name` variable content:

```
@app.route("/page")
def page():
    name = request.values.get('name')
    output = Jinja2.from_string('Hello ' + name + '!').render()
    return output

```

This code snippet is vulnerable to XSS but it is also vulnerable to SSTI. Using the following as a payload in the `name` parameter:

```
$ curl -g 'http://www.target.com/page?name={{7*7}}'
Hello 49!

```
## How to Test

SSTI vulnerabilities exist either in text or code context. In plaintext context users allowed to use freeform ‘text’ with direct HTML code. In code context the user input may also be placed within a template statement (eg. in a variable name). In both cases the testing methodology has the following steps:

1. Detect template injection vulnerability points
2. Identify the templating engine
3. Build the exploit

### Identify Template Injection Vulnerability

The first step in testing SSTI in plaintext context is to construct common template expressions used by various template engines as payloads and monitor server responses to identify which template expression was executed by the server.

Common template expression examples:

```
a{{bar}}b
a{{7*7}}
{var} ${var} {{var}} <%var%> [% var %]

```

In this step an extensive [template expression test strings/payloads list](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection) is recommended.

Testing for SSTI in code context is slightly different. First, the tester constructs the request that result either blank or error server responses. In the example below the HTTP GET parameter is inserted info the variable `personal_greeting` in a template statement:

```
personal_greeting=username
Hello user01

```

Using the following payload - the server response is blank “Hello”:

```
personal_greeting=username<tag>
Hello

```

In the next step is to break out of the template statement and injecting HTML tag after it using the following payload

```
personal_greeting=username}}<tag>
Hello user01 <tag>

```
### Identify the Templating Engine

Based on the information from the previous step now the tester has to identify which template engine is used by supplying various template expressions. Based on the server responses the tester deduces the template engine used. This manual approach is discussed in greater detail in [this](https://portswigger.net/blog/server-side-template-injection#Identify) PortSwigger article. To automate the identification of the SSTI vulnerability and the templating engine various tools are available including [Tplmap](https://github.com/epinna/tplmap) or the [Backslash Powered Scanner Burp Suite extension](https://github.com/PortSwigger/backslash-powered-scanner).

### Build the RCE Exploit

The main goal in this step is to identify to gain further control on the server with an RCE exploit by studying the template documentation and research. Key areas of interest are:

* **For template authors** sections covering basic syntax.
* **Security considerations** sections.
* Lists of builtin methods, functions, filters, and variables.
* Lists of extensions/plugins.

The tester can also identify what other objects, methods and properties can be exposed by focusing on the `self` object. If the `self` object is not available and the documentation does not reveal the technical details, a brute force of the variable name is recommended. Once the object is identified the next step is to loop through the object to identify all the methods, properties and attributes that are accessible through the template engine. This could lead to other kinds of security findings including privilege escalations, information disclosure about application passwords, API keys, configurations and environment variables, etc.

## References

1. [James Kettle: Server-Side Template Injection:RCE for the modern webapp (whitepaper)](https://portswigger.net/kb/papers/serversidetemplateinjection.pdf)
2. [Server-Side Template Injection](https://portswigger.net/blog/server-side-template-injection)
3. [Exploring SSTI in Flask/Jinja2](https://www.lanmaster53.com/2016/03/exploring-ssti-flask-jinja2/)
4. [Server Side Template Injection: from detection to Remote shell](https://www.okiok.com/server-side-template-injection-from-detection-to-remote-shell/)
5. [Extreme Vulnerable Web Application](https://github.com/s4n7h0/xvwa)
6. [Divine Selorm Tsa: Exploiting server side template injection with tplmap](https://owasp.org/www-pdf-archive/Owasp_SSTI_final.pdf)

## Tools

1. [Tplmap](https://github.com/epinna/tplmap)
2. [Backslash Powered Scanner Burp Suite extension](https://github.com/PortSwigger/backslash-powered-scanner)
3. [Template expression test strings/payloads list](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection)

---

[Watch](https://github.com/OWASP/wstg/subscription)
[Star](https://github.com/OWASP/wstg)

**The OWASP® Foundation** works to improve the security of software through its community-led open source software projects,
hundreds of chapters worldwide, tens of thousands of members, and by hosting local and global conferences.
## [WSTG Contents (v4.1)](/www-project-web-security-testing-guide/v41/)

* [0. Foreword by Eoin Keary](/www-project-web-security-testing-guide/v41/0-Foreword/README)
* [1. Frontispiece](/www-project-web-security-testing-guide/v41/1-Frontispiece/)
* [2. Introduction](/www-project-web-security-testing-guide/v41/2-Introduction/)
* [2.1 The OWASP Testing Project](/www-project-web-security-testing-guide/v41/2-Introduction/README#the-owasp-testing-project)
* [2.2 Principles of Testing](/www-project-web-security-testing-guide/v41/2-Introduction/README#principles-of-testing)
* [2.3 Testing Techniques Explained](/www-project-web-security-testing-guide/v41/2-Introduction/README#testing-techniques-explained)
* [2.4 Manual Inspections and Reviews](/www-project-web-security-testing-guide/v41/2-Introduction/README#manual-inspections-and-reviews)
* [2.5 Threat Modeling](/www-project-web-security-testing-guide/v41/2-Introduction/README#threat-modeling)
* [2.6 Source Code Review](/www-project-web-security-testing-guide/v41/2-Introduction/README#source-code-review)
* [2.7 Penetration Testing](/www-project-web-security-testing-guide/v41/2-Introduction/README#penetration-testing)
* [2.8 The Need for a Balanced Approach](/www-project-web-security-testing-guide/v41/2-Introduction/README#the-need-for-a-balanced-approach)
* [2.9 Deriving Security Test Requirements](/www-project-web-security-testing-guide/v41/2-Introduction/README#deriving-security-test-requirements)
* [2.10 Security Tests Integrated in Development and Testing Workflows](/www-project-web-security-testing-guide/v41/2-Introduction/README#security-tests-integrated-in-development-and-testing-workflows)
* [2.11 Security Test Data Analysis and Reporting](/www-project-web-security-testing-guide/v41/2-Introduction/README#security-test-data-analysis-and-reporting)
* [3. The OWASP Testing Framework](/www-project-web-security-testing-guide/v41/3-The_OWASP_Testing_Framework/)
* [3.1 The Web Security Testing Framework](/www-project-web-security-testing-guide/v41/3-The_OWASP_Testing_Framework/0-The_Web_Security_Testing_Framework)
* [3.2 Phase 1 Before Development Begins](/www-project-web-security-testing-guide/v41/3-The_OWASP_Testing_Framework/0-The_Web_Security_Testing_Framework#phase-1-before-development-begins)
* [3.3 Phase 2 During Definition and Design](/www-project-web-security-testing-guide/v41/3-The_OWASP_Testing_Framework/0-The_Web_Security_Testing_Framework#phase-2-during-definition-and-design)
* [3.4 Phase 3 During Development](/www-project-web-security-testing-guide/v41/3-The_OWASP_Testing_Framework/0-The_Web_Security_Testing_Framework#phase-3-during-development)
* [3.5 Phase 4 During Deployment](/www-project-web-security-testing-guide/v41/3-The_OWASP_Testing_Framework/0-The_Web_Security_Testing_Framework#phase-4-during-deployment)
* [3.6 Phase 5 During Maintenance and Operations](/www-project-web-security-testing-guide/v41/3-The_OWASP_Testing_Framework/0-The_Web_Security_Testing_Framework#phase-5-during-maintenance-and-operations)
* [3.7 A Typical SDLC Testing Workflow](/www-project-web-security-testing-guide/v41/3-The_OWASP_Testing_Framework/0-The_Web_Security_Testing_Framework#a-typical-sdlc-testing-workflow)
* [3.8 Penetration Testing Methodologies](/www-project-web-security-testing-guide/v41/3-The_OWASP_Testing_Framework/1-Penetration_Testing_Methodologies)
* [4. Web Application Security Testing](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/)
* [4.0 Introduction and Objectives](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/00-Introduction_and_Objectives/README)
* [4.1 Information Gathering](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/01-Information_Gathering/README)
* [4.1.1 Conduct Search Engine Discovery Reconnaissance for Information Leakage](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/01-Information_Gathering/01-Conduct_Search_Engine_Discovery_Reconnaissance_for_Information_Leakage)
* [4.1.2 Fingerprint Web Server](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/01-Information_Gathering/02-Fingerprint_Web_Server)
* [4.1.3 Review Webserver Metafiles for Information Leakage](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/01-Information_Gathering/03-Review_Webserver_Metafiles_for_Information_Leakage)
* [4.1.4 Enumerate Applications on Webserver](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/01-Information_Gathering/04-Enumerate_Applications_on_Webserver)
* [4.1.5 Review Webpage Comments and Metadata for Information Leakage](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/01-Information_Gathering/05-Review_Webpage_Comments_and_Metadata_for_Information_Leakage)
* [4.1.6 Identify Application Entry Points](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/01-Information_Gathering/06-Identify_Application_Entry_Points)
* [4.1.7 Map Execution Paths Through Application](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/01-Information_Gathering/07-Map_Execution_Paths_Through_Application)
* [4.1.8 Fingerprint Web Application Framework](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/01-Information_Gathering/08-Fingerprint_Web_Application_Framework)
* [4.1.9 Fingerprint Web Application](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/01-Information_Gathering/09-Fingerprint_Web_Application)
* [4.1.10 Map Application Architecture](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/01-Information_Gathering/10-Map_Application_Architecture)
* [4.2 Configuration and Deployment Management Testing](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/README)
* [4.2.1 Test Network Infrastructure Configuration](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/01-Test_Network_Infrastructure_Configuration)
* [4.2.2 Test Application Platform Configuration](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/02-Test_Application_Platform_Configuration)
* [4.2.3 Test File Extensions Handling for Sensitive Information](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/03-Test_File_Extensions_Handling_for_Sensitive_Information)
* [4.2.4 Review Old Backup and Unreferenced Files for Sensitive Information](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/04-Review_Old_Backup_and_Unreferenced_Files_for_Sensitive_Information)
* [4.2.5 Enumerate Infrastructure and Application Admin Interfaces](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/05-Enumerate_Infrastructure_and_Application_Admin_Interfaces)
* [4.2.6 Test HTTP Methods](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/06-Test_HTTP_Methods)
* [4.2.7 Test HTTP Strict Transport Security](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/07-Test_HTTP_Strict_Transport_Security)
* [4.2.8 Test RIA Cross Domain Policy](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/08-Test_RIA_Cross_Domain_Policy)
* [4.2.9 Test File Permission](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/09-Test_File_Permission)
* [4.2.10 Test for Subdomain Takeover](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/10-Test_for_Subdomain_Takeover)
* [4.2.11 Test Cloud Storage](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/11-Test_Cloud_Storage)
* [4.3 Identity Management Testing](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/03-Identity_Management_Testing/README)
* [4.3.1 Test Role Definitions](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/03-Identity_Management_Testing/01-Test_Role_Definitions)
* [4.3.2 Test User Registration Process](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/03-Identity_Management_Testing/02-Test_User_Registration_Process)
* [4.3.3 Test Account Provisioning Process](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/03-Identity_Management_Testing/03-Test_Account_Provisioning_Process)
* [4.3.4 Testing for Account Enumeration and Guessable User Account](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/03-Identity_Management_Testing/04-Testing_for_Account_Enumeration_and_Guessable_User_Account)
* [4.3.5 Testing for Weak or Unenforced Username Policy](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/03-Identity_Management_Testing/05-Testing_for_Weak_or_Unenforced_Username_Policy)
* [4.4 Authentication Testing](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/04-Authentication_Testing/README)
* [4.4.1 Testing for Credentials Transported over an Encrypted Channel](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/04-Authentication_Testing/01-Testing_for_Credentials_Transported_over_an_Encrypted_Channel)
* [4.4.2 Testing for Default Credentials](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/04-Authentication_Testing/02-Testing_for_Default_Credentials)
* [4.4.3 Testing for Weak Lock Out Mechanism](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/04-Authentication_Testing/03-Testing_for_Weak_Lock_Out_Mechanism)
* [4.4.4 Testing for Bypassing Authentication Schema](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/04-Authentication_Testing/04-Testing_for_Bypassing_Authentication_Schema)
* [4.4.5 Testing for Vulnerable Remember Password](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/04-Authentication_Testing/05-Testing_for_Vulnerable_Remember_Password)
* [4.4.6 Testing for Browser Cache Weaknesses](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/04-Authentication_Testing/06-Testing_for_Browser_Cache_Weaknesses)
* [4.4.7 Testing for Weak Password Policy](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/04-Authentication_Testing/07-Testing_for_Weak_Password_Policy)
* [4.4.8 Testing for Weak Security Question Answer](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/04-Authentication_Testing/08-Testing_for_Weak_Security_Question_Answer)
* [4.4.9 Testing for Weak Password Change or Reset Functionalities](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/04-Authentication_Testing/09-Testing_for_Weak_Password_Change_or_Reset_Functionalities)
* [4.4.10 Testing for Weaker Authentication in Alternative Channel](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/04-Authentication_Testing/10-Testing_for_Weaker_Authentication_in_Alternative_Channel)
* [4.5 Authorization Testing](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/05-Authorization_Testing/README)
* [4.5.1 Testing Directory Traversal File Include](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/05-Authorization_Testing/01-Testing_Directory_Traversal_File_Include)
* [4.5.2 Testing for Bypassing Authorization Schema](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/05-Authorization_Testing/02-Testing_for_Bypassing_Authorization_Schema)
* [4.5.3 Testing for Privilege Escalation](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/05-Authorization_Testing/03-Testing_for_Privilege_Escalation)
* [4.5.4 Testing for Insecure Direct Object References](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/05-Authorization_Testing/04-Testing_for_Insecure_Direct_Object_References)
* [4.6 Session Management Testing](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/06-Session_Management_Testing/README)
* [4.6.1 Testing for Session Management Schema](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/06-Session_Management_Testing/01-Testing_for_Session_Management_Schema)
* [4.6.2 Testing for Cookies Attributes](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/06-Session_Management_Testing/02-Testing_for_Cookies_Attributes)
* [4.6.3 Testing for Session Fixation](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/06-Session_Management_Testing/03-Testing_for_Session_Fixation)
* [4.6.4 Testing for Exposed Session Variables](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/06-Session_Management_Testing/04-Testing_for_Exposed_Session_Variables)
* [4.6.5 Testing for Cross Site Request Forgery](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/06-Session_Management_Testing/05-Testing_for_Cross_Site_Request_Forgery)
* [4.6.6 Testing for Logout Functionality](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/06-Session_Management_Testing/06-Testing_for_Logout_Functionality)
* [4.6.7 Testing Session Timeout](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/06-Session_Management_Testing/07-Testing_Session_Timeout)
* [4.6.8 Testing for Session Puzzling](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/06-Session_Management_Testing/08-Testing_for_Session_Puzzling)
* [4.7 Input Validation Testing](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/07-Input_Validation_Testing/README)
* [4.7.1 Testing for Reflected Cross Site Scripting](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/07-Input_Validation_Testing/01-Testing_for_Reflected_Cross_Site_Scripting)
* [4.7.2 Testing for Stored Cross Site Scripting](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/07-Input_Validation_Testing/02-Testing_for_Stored_Cross_Site_Scripting)
* [4.7.3 Testing for HTTP Verb Tampering](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/07-Input_Validation_Testing/03-Testing_for_HTTP_Verb_Tampering)
* [4.7.4 Testing for HTTP Parameter Pollution](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/07-Input_Validation_Testing/04-Testing_for_HTTP_Parameter_Pollution)
* [4.7.5 Testing for SQL Injection](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05-Testing_for_SQL_Injection)
* [4.7.5.1 Testing for Oracle](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05.1-Testing_for_Oracle)
* [4.7.5.2 Testing for MySQL](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05.2-Testing_for_MySQL)
* [4.7.5.3 Testing for SQL Server](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05.3-Testing_for_SQL_Server)
* [4.7.5.4 Testing PostgreSQL](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05.4-Testing_PostgreSQL)
* [4.7.5.5 Testing for MS Access](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05.5-Testing_for_MS_Access)
* [4.7.5.6 Testing for NoSQL Injection](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05.6-Testing_for_NoSQL_Injection)
* [4.7.5.7 Testing for ORM Injection](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05.7-Testing_for_ORM_Injection)
* [4.7.5.8 Testing for Client Side](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05.8-Testing_for_Client_Side)
* [4.7.6 Testing for LDAP Injection](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/07-Input_Validation_Testing/06-Testing_for_LDAP_Injection)
* [4.7.7 Testing for XML Injection](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/07-Input_Validation_Testing/07-Testing_for_XML_Injection)
* [4.7.8 Testing for SSI Injection](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/07-Input_Validation_Testing/08-Testing_for_SSI_Injection)
* [4.7.9 Testing for XPath Injection](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/07-Input_Validation_Testing/09-Testing_for_XPath_Injection)
* [4.7.10 Testing for IMAP SMTP Injection](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/07-Input_Validation_Testing/10-Testing_for_IMAP_SMTP_Injection)
* [4.7.11 Testing for Code Injection](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/07-Input_Validation_Testing/11-Testing_for_Code_Injection)
* [4.7.11.1 Testing for Local File Inclusion](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/07-Input_Validation_Testing/11.1-Testing_for_Local_File_Inclusion)
* [4.7.11.2 Testing for Remote File Inclusion](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/07-Input_Validation_Testing/11.2-Testing_for_Remote_File_Inclusion)
* [4.7.12 Testing for Command Injection](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/07-Input_Validation_Testing/12-Testing_for_Command_Injection)
* [4.7.13 Testing for Buffer Overflow](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/07-Input_Validation_Testing/13-Testing_for_Buffer_Overflow)
* [4.7.13.1 Testing for Heap Overflow](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/07-Input_Validation_Testing/13.1-Testing_for_Heap_Overflow)
* [4.7.13.2 Testing for Stack Overflow](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/07-Input_Validation_Testing/13.2-Testing_for_Stack_Overflow)
* [4.7.13.3 Testing for Format String](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/07-Input_Validation_Testing/13.3-Testing_for_Format_String)
* [4.7.14 Testing for Incubated Vulnerability](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/07-Input_Validation_Testing/14-Testing_for_Incubated_Vulnerability)
* [4.7.15 Testing for HTTP Splitting Smuggling](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/07-Input_Validation_Testing/15-Testing_for_HTTP_Splitting_Smuggling)
* [4.7.16 Testing for HTTP Incoming Requests](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/07-Input_Validation_Testing/16-Testing_for_HTTP_Incoming_Requests)
* [4.7.17 Testing for Host Header Injection](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/07-Input_Validation_Testing/17-Testing_for_Host_Header_Injection)
* [4.7.18 Testing for Server Side Template Injection](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/07-Input_Validation_Testing/18-Testing_for_Server_Side_Template_Injection)
* [4.8 Testing for Error Handling](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/08-Testing_for_Error_Handling/README)
* [4.8.1 Testing for Error Code](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/08-Testing_for_Error_Handling/01-Testing_for_Error_Code)
* [4.8.2 Testing for Stack Traces](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/08-Testing_for_Error_Handling/02-Testing_for_Stack_Traces)
* [4.9 Testing for Weak Cryptography](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/09-Testing_for_Weak_Cryptography/README)
* [4.9.1 Testing for Weak SSL TLS Ciphers Insufficient Transport Layer Protection](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/09-Testing_for_Weak_Cryptography/01-Testing_for_Weak_SSL_TLS_Ciphers_Insufficient_Transport_Layer_Protection)
* [4.9.2 Testing for Padding Oracle](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/09-Testing_for_Weak_Cryptography/02-Testing_for_Padding_Oracle)
* [4.9.3 Testing for Sensitive Information Sent via Unencrypted Channels](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/09-Testing_for_Weak_Cryptography/03-Testing_for_Sensitive_Information_Sent_via_Unencrypted_Channels)
* [4.9.4 Testing for Weak Encryption](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/09-Testing_for_Weak_Cryptography/04-Testing_for_Weak_Encryption)
* [4.10 Business Logic Testing](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/10-Business_Logic_Testing/README)
* [4.10.0 Introduction to Business Logic](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/10-Business_Logic_Testing/00-Introduction_to_Business_Logic)
* [4.10.1 Test Business Logic Data Validation](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/10-Business_Logic_Testing/01-Test_Business_Logic_Data_Validation)
* [4.10.2 Test Ability to Forge Requests](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/10-Business_Logic_Testing/02-Test_Ability_to_Forge_Requests)
* [4.10.3 Test Integrity Checks](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/10-Business_Logic_Testing/03-Test_Integrity_Checks)
* [4.10.4 Test for Process Timing](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/10-Business_Logic_Testing/04-Test_for_Process_Timing)
* [4.10.5 Test Number of Times a Function Can Be Used Limits](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/10-Business_Logic_Testing/05-Test_Number_of_Times_a_Function_Can_Be_Used_Limits)
* [4.10.6 Testing for the Circumvention of Work Flows](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/10-Business_Logic_Testing/06-Testing_for_the_Circumvention_of_Work_Flows)
* [4.10.7 Test Defenses Against Application Misuse](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/10-Business_Logic_Testing/07-Test_Defenses_Against_Application_Misuse)
* [4.10.8 Test Upload of Unexpected File Types](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/10-Business_Logic_Testing/08-Test_Upload_of_Unexpected_File_Types)
* [4.10.9 Test Upload of Malicious Files](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/10-Business_Logic_Testing/09-Test_Upload_of_Malicious_Files)
* [4.11 Client Side Testing](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/11-Client_Side_Testing/README)
* [4.11.1 Testing for DOM-Based Cross Site Scripting](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/11-Client_Side_Testing/01-Testing_for_DOM-based_Cross_Site_Scripting)
* [4.11.2 Testing for JavaScript Execution](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/11-Client_Side_Testing/02-Testing_for_JavaScript_Execution)
* [4.11.3 Testing for HTML Injection](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/11-Client_Side_Testing/03-Testing_for_HTML_Injection)
* [4.11.4 Testing for Client Side URL Redirect](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/11-Client_Side_Testing/04-Testing_for_Client_Side_URL_Redirect)
* [4.11.5 Testing for CSS Injection](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/11-Client_Side_Testing/05-Testing_for_CSS_Injection)
* [4.11.6 Testing for Client Side Resource Manipulation](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/11-Client_Side_Testing/06-Testing_for_Client_Side_Resource_Manipulation)
* [4.11.7 Testing Cross Origin Resource Sharing](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/11-Client_Side_Testing/07-Testing_Cross_Origin_Resource_Sharing)
* [4.11.8 Testing for Cross Site Flashing](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/11-Client_Side_Testing/08-Testing_for_Cross_Site_Flashing)
* [4.11.9 Testing for Clickjacking](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/11-Client_Side_Testing/09-Testing_for_Clickjacking)
* [4.11.10 Testing WebSockets](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/11-Client_Side_Testing/10-Testing_WebSockets)
* [4.11.11 Testing Web Messaging](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/11-Client_Side_Testing/11-Testing_Web_Messaging)
* [4.11.12 Testing Browser Storage](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/11-Client_Side_Testing/12-Testing_Browser_Storage)
* [4.11.13 Testing for Cross Site Script Inclusion](/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/11-Client_Side_Testing/13-Testing_for_Cross_Site_Script_Inclusion)
* [5. Reporting](/www-project-web-security-testing-guide/v41/5-Reporting/README)
* [Appendix A. Testing Tools Resource](/www-project-web-security-testing-guide/v41/6-Appendix/A-Testing_Tools_Resource)
* [Appendix B. Suggested Reading](/www-project-web-security-testing-guide/v41/6-Appendix/B-Suggested_Reading)
* [Appendix C. Fuzz Vectors](/www-project-web-security-testing-guide/v41/6-Appendix/C-Fuzz_Vectors)
* [Appendix D. Encoded Injection](/www-project-web-security-testing-guide/v41/6-Appendix/D-Encoded_Injection)
* [Appendix E. History](/www-project-web-security-testing-guide/v41/6-Appendix/E-History)

### Upcoming OWASP Global Events

## Corporate Supporters

[Become a corporate supporter](https://owasp.org/supporters)

* [HOME](https://owasp.org/)
* [PROJECTS](https://owasp.org/projects/)
* [CHAPTERS](https://owasp.org/chapters/)
* [EVENTS](https://owasp.org/events/)
* [ABOUT](https://owasp.org/about/)
* [PRIVACY](https://owasp.org/www-policy/operational/privacy)
* [SITEMAP](https://owasp.org/sitemap/)
* [CONTACT](https://owasp.org/contact/)

OWASP, the OWASP logo, and Global AppSec are registered trademarks and AppSec Days, AppSec California, AppSec Cali, SnowFROC, and LASCON are trademarks of the OWASP Foundation, Inc. Unless otherwise specified, all content on the site is Creative Commons Attribution-ShareAlike v4.0 and provided without warranty of service or accuracy. For more information, please refer to our [General Disclaimer](/www-policy/operational/general-disclaimer.html). OWASP does not endorse or recommend commercial products or services, allowing our community to remain vendor neutral with the collective wisdom of the best minds in software security worldwide. Copyright 2025, OWASP Foundation, Inc.


