

[Skip to main content](#content)

[Stack Overflow](https://stackoverflow.com)

1. [About](https://stackoverflow.co/)
2. Products
3. [OverflowAI](https://stackoverflow.co/teams/ai/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=top-nav-bar&utm_content=overflowai)

1. [Stack Overflow for Teams
   Where developers & technologists share private knowledge with coworkers](https://stackoverflow.co/teams/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=top-nav&utm_content=stack-overflow-for-teams)
2. [Advertising & Talent
   Reach devs & technologists worldwide about your product, service or employer brand](https://stackoverflow.co/advertising/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=top-nav&utm_content=stack-overflow-advertising)
3. [OverflowAI
   GenAI features for Teams](https://stackoverflow.co/teams/ai/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=top-nav&utm_content=overflow-ai)
4. [OverflowAPI
   Train & fine-tune LLMs](https://stackoverflow.co/api-solutions/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=top-nav&utm_content=overflow-api)
5. [Labs
   The future of collective knowledge sharing](https://stackoverflow.co/labs/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=top-nav&utm_content=labs)
6. [About the company](https://stackoverflow.co/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=top-nav&utm_content=about-the-company)
   [Visit the blog](https://stackoverflow.blog/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=top-nav&utm_content=blog)

Loading…

1. ### [current community](https://stackoverflow.com)

   * [Stack Overflow](https://stackoverflow.com)

     [help](https://stackoverflow.com/help)
     [chat](https://chat.stackoverflow.com/?tab=site&host=stackoverflow.com)
   * [Meta Stack Overflow](https://meta.stackoverflow.com)
   ### your communities

   [Sign up](https://stackoverflow.com/users/signup?ssrc=site_switcher&returnurl=https%3a%2f%2fstackoverflow.com%2fquestions%2f73939573%2fhow-to-sanitise-string-of-python-code-with-python) or [log in](https://stackoverflow.com/users/login?ssrc=site_switcher&returnurl=https%3a%2f%2fstackoverflow.com%2fquestions%2f73939573%2fhow-to-sanitise-string-of-python-code-with-python) to customize your list.

   ### [more stack exchange communities](https://stackexchange.com/sites)

   [company blog](https://stackoverflow.blog)
3. [Log in](https://stackoverflow.com/users/login?ssrc=head&returnurl=https%3a%2f%2fstackoverflow.com%2fquestions%2f73939573%2fhow-to-sanitise-string-of-python-code-with-python)
4. [Sign up](https://stackoverflow.com/users/signup?ssrc=head&returnurl=https%3a%2f%2fstackoverflow.com%2fquestions%2f73939573%2fhow-to-sanitise-string-of-python-code-with-python)

1. 1. [Home](/)
   2. [Questions](/questions)
   3. [Tags](/tags)
   5. [Users](/users)
   6. [Companies](https://stackoverflow.com/jobs/companies?so_medium=stackoverflow&so_source=SiteNav)
   7. Labs
   8. [Jobs](/jobs?source=so-left-nav)
   9. [Discussions](/beta/discussions)
   10. Collectives
   11. Communities for your favorite technologies. [Explore all Collectives](/collectives-all)
2. Teams
   ![](https://cdn.sstatic.net/Img/teams/teams-promo.svg?v=e507948b81bf)

   Ask questions, find answers and collaborate at work with Stack Overflow for Teams.

   [Try Teams for free](https://stackoverflowteams.com/teams/create/free/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=side-bar&utm_content=explore-teams)
   [Explore Teams](https://stackoverflow.co/teams/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=side-bar&utm_content=explore-teams)
3. Teams
4. Ask questions, find answers and collaborate at work with Stack Overflow for Teams.
   [Explore Teams](https://stackoverflow.co/teams/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=side-bar&utm_content=explore-teams-compact)

##### Collectives™ on Stack Overflow

Find centralized, trusted content and collaborate around the technologies you use most.

[Learn more about Collectives](/collectives)

**Teams**

Q&A for work

Connect and share knowledge within a single location that is structured and easy to search.

[Learn more about Teams](https://stackoverflow.co/teams/)

Get early access and see previews of new features.

 [Learn more about Labs](https://stackoverflow.co/labs/)

# [How to sanitise string of Python code with Python?](/questions/73939573/how-to-sanitise-string-of-python-code-with-python)

[Ask Question](/questions/ask)

Asked
2 years, 3 months ago

Modified
[2 years, 3 months ago](?lastactivity "2022-10-04 16:49:23Z")

Viewed
584 times

1

I am using Jinja2 as my templating engine for an admin dashboard, that displays some user feedback. I worry that an attacker could type some python code as their feedback and the Jinja2 template could execute that.

I.e.

An attacker might put the following as their feedback:

```
__import__('subprocess').getoutput('tree')

```

When the templater renders this, i.e.

```
feedback = "__import__('subprocess').getoutput('tree')"
Template("{{ feedback }}").render(feedback=feedback)

```

The tree command is run in the terminal.

How can I sanitise my strings so that they do not include any python code which might allow them access to my server via the command line?

* [python](/questions/tagged/python "show questions tagged 'python'")
* [security](/questions/tagged/security "show questions tagged 'security'")
* [jinja2](/questions/tagged/jinja2 "show questions tagged 'jinja2'")

[Share](/q/73939573 "Short permalink to this question")

[Improve this question](/posts/73939573/edit)

Follow

[edited Oct 4, 2022 at 16:45](/posts/73939573/revisions "show all edits to this post")

SamTheProgrammer

asked Oct 3, 2022 at 18:44

[![SamTheProgrammer's user avatar](https://www.gravatar.com/avatar/28bc814aa25c087cfe475e064b7697f9?s=64&d=identicon&r=PG&f=y&so-version=2)](/users/15515166/samtheprogrammer)

[SamTheProgrammer](/users/15515166/samtheprogrammer)SamTheProgrammer
1,18511 gold badge1313 silver badges3434 bronze badges

7

* 1

  Escape (or remove) `{` characters in the user-supplied string. Maybe jinja2 has some escape function to do it better.
  – [pts](/users/97248/pts "87,041 reputation")

  Commented
  Oct 3, 2022 at 18:51
* I did not mean that the things between the {{}} brackets. Please read new edit.
  – [SamTheProgrammer](/users/15515166/samtheprogrammer "1,185 reputation")

  Commented
  Oct 3, 2022 at 18:53
* I mean that the string contains the code, and is stored as a string variable. This is interpolated, and executed by the Jinja2 templater.
  – [SamTheProgrammer](/users/15515166/samtheprogrammer "1,185 reputation")

  Commented
  Oct 3, 2022 at 18:55
* 2

  The template `{{ feedback }}` in your code is already safe and correct: Python commands within the feedback string variable won't be executed.
  – [pts](/users/97248/pts "87,041 reputation")

  Commented
  Oct 3, 2022 at 19:00
* 1

  Unless you do `{{ feedback | safe }}`, your ... well, safe: [jinja.palletsprojects.com/en/3.1.x/templates/…](https://jinja.palletsprojects.com/en/3.1.x/templates/#jinja-filters.safe)
  – [β.εηοιτ.βε](/users/2123530/%CE%B2-%CE%B5%CE%B7%CE%BF%CE%B9%CF%84-%CE%B2%CE%B5 "38,929 reputation")

  Commented
  Oct 3, 2022 at 19:05

 |
Show **2** more comments

## 1 Answer 1

Sorted by:

[Reset to default](/questions/73939573/how-to-sanitise-string-of-python-code-with-python?answertab=scoredesc#tab-top)

Highest score (default)

Trending (recent votes count more)

Date modified (newest first)

Date created (oldest first)

0

The solution is that the templater only executes it if you put it directly in the template.

So...

```
Template("{{ __import__('subprocess').getoutput('tree') }}").render()

```

executes the code.

Whereas...

```
x = "__import__('subprocess').getoutput('tree')"
Template("{{ x }}").render(x=x)

```

Will not. So treat them as strings and vulnerabilities are mitigated.

[Share](/a/73951153 "Short permalink to this answer")

[Improve this answer](/posts/73951153/edit)

Follow

answered Oct 4, 2022 at 16:49

[![SamTheProgrammer's user avatar](https://www.gravatar.com/avatar/28bc814aa25c087cfe475e064b7697f9?s=64&d=identicon&r=PG&f=y&so-version=2)](/users/15515166/samtheprogrammer)

[SamTheProgrammer](/users/15515166/samtheprogrammer)SamTheProgrammer
1,18511 gold badge1313 silver badges3434 bronze badges

Add a comment
 |

## Your Answer

**Reminder:** Answers generated by artificial intelligence tools are not allowed on Stack Overflow. [Learn more](/help/gen-ai-policy)

Thanks for contributing an answer to Stack Overflow!

* Please be sure to *answer the question*. Provide details and share your research!

But *avoid* …

* Asking for help, clarification, or responding to other answers.
* Making statements based on opinion; back them up with references or personal experience.

To learn more, see our [tips on writing great answers](/help/how-to-answer).

Draft saved
Draft discarded

### Sign up or [log in](/users/login?ssrc=question_page&returnurl=https%3a%2f%2fstackoverflow.com%2fquestions%2f73939573%2fhow-to-sanitise-string-of-python-code-with-python%23new-answer)

 Sign up using Google

 Sign up using Email and Password

Submit
### Post as a guest

Name

Email

Required, but never shown

### Post as a guest

Name

Email

Required, but never shown

Post Your Answer

Discard

By clicking “Post Your Answer”, you agree to our [terms of service](https://stackoverflow.com/legal/terms-of-service/public) and acknowledge you have read our [privacy policy](https://stackoverflow.com/legal/privacy-policy).

## Not the answer you're looking for? Browse other questions tagged * [python](/questions/tagged/python "show questions tagged 'python'") * [security](/questions/tagged/security "show questions tagged 'security'") * [jinja2](/questions/tagged/jinja2 "show questions tagged 'jinja2'") or [ask your own question](/questions/ask).

* The Overflow Blog
* [Failing fast at scale: Rapid prototyping at Intuit](https://stackoverflow.blog/2025/01/08/failing-fast-at-scale-rapid-prototyping-at-intuit/)
* [“Data is the key”: Twilio’s Head of R&D on the need for good data](https://stackoverflow.blog/2025/01/10/data-is-the-key-twilio-s-head-of-r-and-d-on-the-need-for-good-data/)
* Featured on Meta
* [The December 2024 Community Asks Sprint has been moved to March 2025 (and...](https://meta.stackexchange.com/questions/404724/the-december-2024-community-asks-sprint-has-been-moved-to-march-2025-and-length "The December 2024 Community Asks Sprint has been moved to March 2025 (and lengthened to 2 weeks to compensate)")
* [Voting experiment to encourage people who rarely vote to upvote](https://meta.stackoverflow.com/questions/432459/voting-experiment-to-encourage-people-who-rarely-vote-to-upvote)

#### Related

[64](/q/16861 "Question score (upvotes - downvotes)")
[Sanitising user input using Python](/questions/16861/sanitising-user-input-using-python)

[39](/q/1556554 "Question score (upvotes - downvotes)")
[How do I html-escape dangerous unsanitized input in jinja2?](/questions/1556554/how-do-i-html-escape-dangerous-unsanitized-input-in-jinja2)

[11](/q/2627135 "Question score (upvotes - downvotes)")
[How do I sanitize LaTeX input?](/questions/2627135/how-do-i-sanitize-latex-input)

[26](/q/12339806 "Question score (upvotes - downvotes)")
[Escape strings for JavaScript using Jinja2?](/questions/12339806/escape-strings-for-javascript-using-jinja2)

[16](/q/13066594 "Question score (upvotes - downvotes)")
[Is there a way to secure strings for Python's eval?](/questions/13066594/is-there-a-way-to-secure-strings-for-pythons-eval)

[1](/q/29701870 "Question score (upvotes - downvotes)")
[Python, Jinja2 nl2br and security](/questions/29701870/python-jinja2-nl2br-and-security)

[2](/q/35238976 "Question score (upvotes - downvotes)")
[Escaping string and then adding html tags in jinja](/questions/35238976/escaping-string-and-then-adding-html-tags-in-jinja)

[3](/q/45578984 "Question score (upvotes - downvotes)")
[Is there a safe alternative to striptags in Jinja?](/questions/45578984/is-there-a-safe-alternative-to-striptags-in-jinja)

[0](/q/56312797 "Question score (upvotes - downvotes)")
[Sanitizing JSON Strings without \](/questions/56312797/sanitizing-json-strings-without)

[0](/q/61469251 "Question score (upvotes - downvotes)")
[Python: Safely render user entered html code](/questions/61469251/python-safely-render-user-entered-html-code)

#### [Hot Network Questions](https://stackexchange.com/questions?tab=hot)

* [123456789 = 987654321?](https://puzzling.stackexchange.com/questions/130004/123456789-987654321)
* [What is הרעש השביעי?](https://judaism.stackexchange.com/questions/146964/what-is-%D7%94%D7%A8%D7%A2%D7%A9-%D7%94%D7%A9%D7%91%D7%99%D7%A2%D7%99)
* [The sum of reciprocals of divisors is not injective](https://math.stackexchange.com/questions/5021723/the-sum-of-reciprocals-of-divisors-is-not-injective)
* [Is there a way to confirm your Alipay works before arriving in China?](https://travel.stackexchange.com/questions/192951/is-there-a-way-to-confirm-your-alipay-works-before-arriving-in-china)
* [How are countries' militaries responding to inflammatory statements made by incoming US leadership?](https://politics.stackexchange.com/questions/90258/how-are-countries-militaries-responding-to-inflammatory-statements-made-by-inco)
* [How can I find TCP packets with specific data in a Wireshark capture?](https://superuser.com/questions/1870047/how-can-i-find-tcp-packets-with-specific-data-in-a-wireshark-capture)
* [(tcolorbox, memoize, tikz, titlesec) Package collargs Error: Environment "tikzpicture" ended as "tcb@drawing"](https://tex.stackexchange.com/questions/734681/tcolorbox-memoize-tikz-titlesec-package-collargs-error-environment-tikzpi)
* [Why was Jesus taken to Egypt when it was forbidden by God for Jews to re-enter Egypt?](https://hermeneutics.stackexchange.com/questions/100366/why-was-jesus-taken-to-egypt-when-it-was-forbidden-by-god-for-jews-to-re-enter-e)
* [TikZ Parametric Surface Debugging Request](https://tex.stackexchange.com/questions/734691/tikz-parametric-surface-debugging-request)
* [Can equipment used in Alcohol distillation be used for the small-scale distillation of crude oil](https://chemistry.stackexchange.com/questions/186751/can-equipment-used-in-alcohol-distillation-be-used-for-the-small-scale-distillat)
* [May I leave the airport during a Singapore transit to visit the city while my checked-through luggage is handled by the airport staff?](https://travel.stackexchange.com/questions/192977/may-i-leave-the-airport-during-a-singapore-transit-to-visit-the-city-while-my-ch)
* [How can I control LED brightness from an MCU without using PWM](https://electronics.stackexchange.com/questions/735422/how-can-i-control-led-brightness-from-an-mcu-without-using-pwm)
* [Can I use an A or D string on my violin in place of a G string?](https://music.stackexchange.com/questions/138533/can-i-use-an-a-or-d-string-on-my-violin-in-place-of-a-g-string)
* [When did the Church Fathers start drawing a connection between Jesus' "I AM" statements and God calling himself the "I AM" in Exodus 3:14?](https://christianity.stackexchange.com/questions/104677/when-did-the-church-fathers-start-drawing-a-connection-between-jesus-i-am-sta)
* [Comic book where Spider-Man defeats a Sentinel, only to discover hundreds or thousands more attacking the city](https://scifi.stackexchange.com/questions/294131/comic-book-where-spider-man-defeats-a-sentinel-only-to-discover-hundreds-or-tho)
* [How do I get the drain plug out of the sink?](https://diy.stackexchange.com/questions/312729/how-do-i-get-the-drain-plug-out-of-the-sink)
* [Momentum measurement and uncertainity principle](https://physics.stackexchange.com/questions/839462/momentum-measurement-and-uncertainity-principle)
* [How is heat loss related to heat source?](https://diy.stackexchange.com/questions/312774/how-is-heat-loss-related-to-heat-source)
* [Merge two (saved) Apple II BASIC programs in memory](https://retrocomputing.stackexchange.com/questions/31123/merge-two-saved-apple-ii-basic-programs-in-memory)
* [Does a consistent heuristic have value 0 on a goal state?](https://ai.stackexchange.com/questions/47718/does-a-consistent-heuristic-have-value-0-on-a-goal-state)
* [Traveling to the UK](https://travel.stackexchange.com/questions/192978/traveling-to-the-uk)
* [Is it idiomatic to say "I just played" or "I was just playing" in response to the question "What did you do this morning"?](https://ell.stackexchange.com/questions/361067/is-it-idiomatic-to-say-i-just-played-or-i-was-just-playing-in-response-to-th)
* [Will the first Mars mission force the space laundry question?](https://space.stackexchange.com/questions/67651/will-the-first-mars-mission-force-the-space-laundry-question)
* [How would 0 visibility combat change weapon choice and military strategy](https://worldbuilding.stackexchange.com/questions/264008/how-would-0-visibility-combat-change-weapon-choice-and-military-strategy)

more hot questions

[Question feed](/feeds/question/73939573 "Feed of this question and its answers")

# Subscribe to RSS

Question feed

To subscribe to this RSS feed, copy and paste this URL into your RSS reader.

![](/posts/73939573/ivc/bbb1?prg=8189c1bf-a0ac-42c3-811c-a463893880ad)lang-py

##### [Stack Overflow](https://stackoverflow.com)

* [Questions](/questions)
* [Help](/help)
* [Chat](https://chat.stackoverflow.com/?tab=site&host=stackoverflow.com)

##### [Products](https://stackoverflow.co/)

* [Teams](https://stackoverflow.co/teams/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=footer&utm_content=teams)
* [Advertising](https://stackoverflow.co/advertising/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=footer&utm_content=advertising)
* [Talent](https://stackoverflow.co/advertising/employer-branding/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=footer&utm_content=talent)

##### [Company](https://stackoverflow.co/)

* [About](https://stackoverflow.co/)
* [Press](https://stackoverflow.co/company/press/)
* [Work Here](https://stackoverflow.co/company/work-here/)
* [Legal](https://stackoverflow.com/legal)
* [Privacy Policy](https://stackoverflow.com/legal/privacy-policy)
* [Terms of Service](https://stackoverflow.com/legal/terms-of-service/public)
* [Contact Us](/contact)
* Cookie Settings
* [Cookie Policy](https://stackoverflow.com/legal/cookie-policy)

##### [Stack Exchange Network](https://stackexchange.com)

* [Technology](https://stackexchange.com/sites#technology)
* [Culture & recreation](https://stackexchange.com/sites#culturerecreation)
* [Life & arts](https://stackexchange.com/sites#lifearts)
* [Science](https://stackexchange.com/sites#science)
* [Professional](https://stackexchange.com/sites#professional)
* [Business](https://stackexchange.com/sites#business)
* [API](https://api.stackexchange.com/)
* [Data](https://data.stackexchange.com/)

* [Blog](https://stackoverflow.blog?blb=1)
* [Facebook](https://www.facebook.com/officialstackoverflow/)
* [Twitter](https://twitter.com/stackoverflow)
* [LinkedIn](https://linkedin.com/company/stack-overflow)
* [Instagram](https://www.instagram.com/thestackoverflow)

Site design / logo © 2025 Stack Exchange Inc;
user contributions licensed under
[CC BY-SA](https://stackoverflow.com/help/licensing)
.
rev 2025.1.7.20880

