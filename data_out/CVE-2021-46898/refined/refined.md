Based on the provided content, here's an analysis of the vulnerability:

**Root cause of vulnerability:**
The vulnerability stems from insufficient validation of the `redirect` parameter in the `switch_user` view within `grappelli/views/switch.py`. The code only checked if the `redirect_url` started with a `/` but did not properly validate if the redirect URL is an external site.

**Weaknesses/vulnerabilities present:**
- **Open Redirect:** The primary weakness is an open redirect vulnerability. An attacker can craft a malicious URL with an arbitrary domain in the `redirect` parameter, leading users to an untrusted website after a successful user switch.

**Impact of exploitation:**
- **Phishing:** An attacker could use this open redirect to craft phishing attacks. By redirecting users to a fake login page or a malicious site after a legitimate action on the application, attackers can steal user credentials or compromise their systems.

**Attack vectors:**
- **Manipulated URL:** The attack vector is a manipulated URL containing a malicious value for the `redirect` parameter. For example: `<http://127.0.0.1:8000/grappelli/switch/user/2/?redirect=//example.com>`

**Required attacker capabilities/position:**
- The attacker needs to be able to craft a URL with a malicious `redirect` parameter.
- No special privileges are required, as long as the user has access to the `switch_user` view.

**Additional details:**
- The original code checked if the redirect URL started with "/", which was insufficient to prevent redirects to external sites.
- The fix replaces the `startswith("/")` check with `url_has_allowed_host_and_scheme` check to prevent redirection to arbitrary URLs.

The provided content offers more detail than a typical CVE description would. Specifically, it provides the exact code location and the PoC that triggers the vulnerability, as well as the fix that was implemented.