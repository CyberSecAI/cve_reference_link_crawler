<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>oss-security - Re: CVE-2021-42013: Path Traversal and Remote Code
 Execution in Apache HTTP Server 2.4.49 and 2.4.50 (incomplete fix of CVE-2021-41773)</title>

<link href="/style.css" type="text/css" rel="stylesheet">
<style type="text/css">
.calendar { text-align: center; }
.ccell { background: #ccc; width: 5ex; padding: 2px; }

.cal_brief { text-align: center; }
.cal_brief td:first-child { background: inherit; }
.cal_brief td { background: #ccc; width: 5ex; padding: 2px; }
.cal_big { text-align: center; padding: 0; margin: 0; }
.cal_big td { padding: 0 2px; }
.cal_mon { text-align: center; }
.cal_mon th { font-size: small; padding: 0; margin: 0; }
.cal_mon td { background: #ccc; width: 5ex; height: 1.5em;
	padding: 2px; text-align: right; }
.cal_mon td[colspan] { background: inherit; }
.cal_mon sup { color: #F0F0F0; text-align: left; float: left;
	margin-top: -2pt; font-weight: bold; }
.cal_mon a { text-align: right; margin-left: -4em; float: right; }
</style>
</head>

<BODY bgcolor="#E0E0E0" text="black" link="blue" alink="red" vlink="navy">


<table bgcolor="#ffffff" width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>

<td>
<a href="/"><img class="logo" src="/logo.png" border="0" width="182" height="80" alt="Openwall"></a>
<td width="100%">
<div class="nav">
<ul>
<li><a href="/">Products</a>
<ul>
<li><a href="/Owl/">Openwall GNU/*/Linux &nbsp; <i>server OS</i></a>
<li><a href="/lkrg/">Linux Kernel Runtime Guard</a>
<li><a href="/john/">John the Ripper &nbsp; <i>password cracker</i></a>
<ul>
<li><a href="/john/">Free &amp; Open Source for any platform</a>
<li><a href="/john/cloud/">in the cloud</a>
<li><a href="/john/pro/linux/">Pro for Linux</a>
<li><a href="/john/pro/macosx/">Pro for macOS</a>
</ul>
<li><a href="/wordlists/">Wordlists &nbsp; <i>for password cracking</i></a>
<li><a href="/passwdqc/">passwdqc &nbsp; <i>policy enforcement</i></a>
<ul>
<li><a href="/passwdqc/">Free &amp; Open Source for Unix</a>
<li><a href="/passwdqc/windows/">Pro for Windows (Active Directory)</a>
</ul>
<li><a href="/yescrypt/">yescrypt &nbsp; <i>KDF &amp; password hashing</i></a>
<li><a href="/yespower/">yespower &nbsp; <i>Proof-of-Work (PoW)</i></a>
<li><a href="/crypt/">crypt_blowfish &nbsp; <i>password hashing</i></a>
<li><a href="/phpass/">phpass &nbsp; <i>ditto in PHP</i></a>
<li><a href="/tcb/">tcb &nbsp; <i>better password shadowing</i></a>
<li><a href="/pam/">Pluggable Authentication Modules</a>
<li><a href="/scanlogd/">scanlogd &nbsp; <i>port scan detector</i></a>
<li><a href="/popa3d/">popa3d &nbsp; <i>tiny POP3 daemon</i></a>
<li><a href="/blists/">blists &nbsp; <i>web interface to mailing lists</i></a>
<li><a href="/msulogin/">msulogin &nbsp; <i>single user mode login</i></a>
<li><a href="/php_mt_seed/">php_mt_seed &nbsp; <i>mt_rand() cracker</i></a>
</ul>
<li><a href="/services/">Services</a>
<li id="narrow-li-1"><a>Publications</a>
<ul>
<li><a href="/articles/">Articles</a>
<li><a href="/presentations/">Presentations</a>
</ul>
<li><a>Resources</a>
<ul>
<li><a href="/lists/">Mailing lists</a>
<li><a href="https://openwall.info/wiki/">Community wiki</a>
<li><a href="https://github.com/openwall">Source code repositories (GitHub)</a>
<li><a href="https://cvsweb.openwall.com">Source code repositories (CVSweb)</a>
<li><a href="/mirrors/">File archive &amp; mirrors</a>
<li><a href="/signatures/">How to verify digital signatures</a>
<li><a href="/ove/">OVE IDs</a>
</ul>
<li id="last-li"><a href="/news">What's new</a>
</ul>
</div>


</table>


<TABLE bgcolor="#B4D0DC" width="100%" border="0" cellspacing="0" cellpadding="1">
<TR><TD>
<TABLE width="100%" border="0" cellspacing="0" cellpadding="2">
<TR><TD bgcolor="#ECF8FF">
<a href="https://twitter.com/openwall">
Follow @Openwall on Twitter for new release announcements and other news</a>

</TABLE>
</TABLE>

<a href="3">[&lt;prev]</a> <a href="../../../2021/10/12/1">[next&gt;]</a> <a href="../../../2021/10/09/1">[&lt;thread-prev]</a> <a href="../../../2021/10/15/3">[thread-next&gt;]</a> <a href=".">[day]</a> <a href="..">[month]</a> <a href="../..">[year]</a> <a href="../../..">[list]</a>
<pre style="white-space: pre-wrap">
Message-ID: &lt;CAKQ1sVOd-9FS8M4gDLOKvs+44LORSJ1CUtxck3tQ+M58SRpE3Q&#64;mail.gmail.com&gt;
Date: Mon, 11 Oct 2021 10:57:21 +0200
From: Yann Ylavic &lt;ylavic.dev&#64;...il.com&gt;
To: oss-security&#64;...ts.openwall.com
Subject: Re: CVE-2021-42013: Path Traversal and Remote Code
 Execution in Apache HTTP Server 2.4.49 and 2.4.50 (incomplete fix of CVE-2021-41773)

On Sat, Oct 9, 2021 at 8:00 PM Roman Medina-Heigl Hernandez
&lt;roman&#64;...labs.com&gt; wrote:
&gt;
&gt; I just wanted to clarify that the impact of both CVEs is exactly the
&gt; same: RCE and/or arbitrary file read and/or none, depending on httpd
&gt; config :-).

I appreciate this nuance in your tweetS. For completeness :) I'll note
that most configs (default, vendors, distros) are not vulnerable to
the RCE.
The removal of "&lt;Directory/&gt; require all denied" is an exploit httpd
can do nothing about. httpd provides default/examples config [3] and
docs (no "don't do that" there I concede).

&gt; There's no difference between Apache 2.4.49 and 2.4.50 in
&gt; that regard.

Ack.

&gt;
&gt; But reading the blog post by Stefan
&gt; (<a href="https://github.com/icing/blog/blob/main/httpd-2.4.50.md" rel="nofollow">https://github.com/icing/blog/blob/main/httpd-2.4.50.md</a>) and Apache
&gt; HTTP 2.4 vulns security page
&gt; (<a href="https://httpd.apache.org/security/vulnerabilities_24.html" rel="nofollow">https://httpd.apache.org/security/vulnerabilities_24.html</a>) as well, I
&gt; feel like you are associating the RCE impact to 2.4.50 and the arbitrary
&gt; file read to 2.4.49. That's misleading. Examples:

I feel obligated to Alexander and reference [1], plain text of the
current httpd vulnerabilities (w.r.t. CVE-2021-42013 &amp;
CVE-2021-41773), as of "Fri, 8 Oct 2021 15:44:24 +0200" [2].

&gt;
&gt; - blog post
&gt;
&gt; "Affection, 2.4.49" -&gt; You go for arbitrary file read example.
&gt;
&gt; "Affection, 2.4.50" -&gt; Then you go for RCE example.

The blog port has the form of a chronological post mortem (it happened
in this order from the httpd team POV), it's an editorial choice (by
Stefan) which makes sense to me as it describes the case progressively
and finally quite exhaustively.
It's not the same goal as the vulnerabilities page anyway.

&gt;
&gt; - security page

Please see [1], both CVEs are aligned now.

&gt;
&gt; I'm sure this is unintentional and yes, it's only matter of wording but
&gt; it's kind of misleading, imho. I'd kindly advise for it to be fixed.

That's the case (I think) on the vulnerabilities page now.

&gt; And
&gt; I also take this opportunity to thank ASF and particularly the folks
&gt; like Yann and Stefan whose work makes Apache httpd possible.
&gt;
&gt; C'u in apache-nosejob-202x.c !!! :-)

Thanks for the kind words! Well, I suppose :)

Regards;
Yann.


[1] <a href="https://httpd.apache.org/security/vulnerabilities_24.html" rel="nofollow">https://httpd.apache.org/security/vulnerabilities_24.html</a> (8 Oct) :
"""
critical: Path Traversal and Remote Code Execution in Apache HTTP
Server 2.4.49 and 2.4.50 (incomplete fix of CVE-2021-41773)
(CVE-2021-42013)

    It was found that the fix for CVE-2021-41773 in Apache HTTP Server
2.4.50 was insufficient. An attacker could use a path traversal attack
to map URLs to files outside the directories configured by Alias-like
directives.

    If files outside of these directories are not protected by the
usual default configuration "require all denied", these requests can
succeed. If CGI scripts are also enabled for these aliased paths, this
could allow for remote code execution.

    This issue only affects Apache 2.4.49 and Apache 2.4.50 and not
earlier versions.

    Acknowledgements:

        Reported by Juan Escobar from Dreamlab Technologies
        Reported by Fernando Mu√±oz from NULL Life CTF Team
        Reported by Shungo Kumasaka
        Reported by Nattapon Jongcharoen

    Reported to security team    2021-10-06
    fixed by r1893977, r1893980, r1893982 in 2.4.x    2021-10-07
    Update 2.4.51 released    2021-10-07
    Affects    2.4.50, 2.4.49

critical: Path traversal and file disclosure vulnerability in Apache
HTTP Server 2.4.49 (CVE-2021-41773)

    A flaw was found in a change made to path normalization in Apache
HTTP Server 2.4.49. An attacker could use a path traversal attack to
map URLs to files outside the directories configured by Alias-like
directives.

    If files outside of these directories are not protected by the
usual default configuration "require all denied", these requests can
succeed. If CGI scripts are also enabled for these aliased paths, this
could allow for remote code execution.

    This issue is known to be exploited in the wild.

    This issue only affects Apache 2.4.49 and not earlier versions.

    Acknowledgements: This issue was reported by Ash Daulton along
with the cPanel Security Team
    Reported to security team    2021-09-29
    fixed by r1893775 in 2.4.x    2021-10-01
    Update 2.4.50 released    2021-10-04
    Affects    2.4.49
"""

[2] <a href="https://github.com/apache/httpd-site/commit/74a166fab7443838c660c88df81961ddaa8df7fd.patch" rel="nofollow">https://github.com/apache/httpd-site/commit/74a166fab7443838c660c88df81961ddaa8df7fd.patch</a>
:
"""
Date: Fri, 8 Oct 2021 15:44:24 +0200
Subject: [PATCH] Revert "Trigger rebuild"

This reverts commit 151e1ff7cdacf68fc615cc1513dbf81b8f307907.
---
 content/security/json/CVE-2021-42013.json | 1 -
 1 file changed, 1 deletion(-)

diff --git a/content/security/json/CVE-2021-42013.json
b/content/security/json/CVE-2021-42013.json
index 09b4792..31e9295 100644
--- a/content/security/json/CVE-2021-42013.json
+++ b/content/security/json/CVE-2021-42013.json
@@ -112,4 +112,3 @@
     }
   ]
 }
-
"""
To make sure every single byte was published :)

[3] <a href="https://github.com/apache/httpd/blob/2.4.x/docs/conf/httpd.conf.in#L110" rel="nofollow">https://github.com/apache/httpd/blob/2.4.x/docs/conf/httpd.conf.in#L110</a> :
"""
#
# Deny access to the entirety of your server's filesystem. You must
# explicitly permit access to web content directories in other
# &lt;Directory&gt; blocks below.
#
&lt;Directory /&gt;
    AllowOverride none
    Require all denied
&lt;/Directory&gt;
"""
</pre>
<p><a href="https://www.openwall.com/blists/">Powered by blists</a> - <a href="https://lists.openwall.net">more mailing lists</a>


<p>
Please check out the
<a href="https://oss-security.openwall.org/wiki/">
Open Source Software Security Wiki</a>, which is counterpart to this
<a href="https://oss-security.openwall.org/wiki/mailing-lists/oss-security">mailing list</a>.
<p>
Confused about <a href="/lists/">mailing lists</a> and their use?
<a href="https://en.wikipedia.org/wiki/Electronic_mailing_list">Read about mailing lists on Wikipedia</a>
and check out these
<a href="https://www.complang.tuwien.ac.at/anton/mail-news-errors.html">guidelines on proper formatting of your messages</a>.
<p>

</body>
</html>
