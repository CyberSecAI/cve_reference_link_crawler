 [![povilaika](https://sp-ao.shortpixel.ai/client/to_webp,q_glossy,ret_img,w_300,h_80/https://www.povilaika.com/wp-content/uploads/2022/05/logo_black.png)](https://www.povilaika.com/)

* [Home](https://www.povilaika.com/)
* [Blog](https://www.povilaika.com/blog/)

      [Contact us](/contact/)      [Povilaika Solutions](https://www.povilaika.com/)[Information Security learning and research](https://www.povilaika.com/)

* [Home](https://www.povilaika.com/)
* [Blog](https://www.povilaika.com/blog/)
  Using a CVE-2021-42013 Apache 2.4.50 exploit in the wild​ ![apache 2.4.50 exploit](https://sp-ao.shortpixel.ai/client/to_webp,q_glossy,ret_img,w_2560,h_976/https://www.povilaika.com/wp-content/uploads/2022/05/Apache_HTTP_server_logo_2019-present.svg_.png)

* [exploits](https://www.povilaika.com/category/exploits/)
# Using a CVE-2021-42013 Apache 2.4.50 exploit in the wild

A sequel to the unproperly patched CVE-2021-41773 vulnerability in Apache HTTPd release 2.4.50, the CVE-2021-42013 vulnerability presents us with an opportunity to have a functional Apache 2.4.50 exploit. The vulnerability affects the Apache release 2.4.49 as well. However, for either version, certain conditions must be met to leverage successful exploitation:

1. 1. An overwrite of the original Apache configuration (Require all denied) to a permissive one
   2. CGI script execution enabled
2. And of course, you will need a functioning Apache 2.4.50 exploit.

## Reproducing

We can easily reproduce a vulnerable host by using [a Docker image provided by jas9reet](https://hub.docker.com/r/jas9reet/cve-2021-42013-lab):

![docker image for apache 2.4.50 exploit](https://sp-ao.shortpixel.ai/client/to_webp,q_glossy,ret_img,w_590,h_188/https://www.povilaika.com/wp-content/uploads/2022/05/docker_image_for_apache_exploit.png)![docker image for apache 2.4.50 exploit](data:image/svg+xml...)

By following the setup instructions from the container’s description we can set up our lab in no time. To get the IP address of our container, we can use the following command:
`$ docker inspect -f '{{range.NetworkSettings.Networks}}{{.IPAddress}}{{end}}'`

An exploit written in C can be found in the GitHub repository [CVE-2021-42013](https://github.com/viliuspovilaika/cve-2021-42013).

Download the source and compile it:

![downloading the exploit](https://sp-ao.shortpixel.ai/client/to_webp,q_glossy,ret_img,w_1018,h_261/https://www.povilaika.com/wp-content/uploads/2022/05/downloading_apache_exploit.png)![downloading the exploit](data:image/svg+xml...)

Alternatively, [you can download a prebuilt release](https://www.povilaika.com/download/1369/).

We can now run this exploit against the Docker container we have set up earlier:

![apache 2.4.50 exploit](https://sp-ao.shortpixel.ai/client/to_webp,q_glossy,ret_img,w_1018,h_442/https://www.povilaika.com/wp-content/uploads/2022/05/apache_2450_exploit.png)![apache 2.4.50 exploit](data:image/svg+xml...)

As we can see, the execution of the exploit was easy and we have received the *passwd* file we requested in our payload argument.

## Taking it up a notch

To research this vulnerability further and estimate the number of vulnerable systems, we need to find hosts running Apache 2.4.50. For this task, we can use services such as [Shodan](https://www.shodan.io/) or [Censys](https://censys.io/). Another, more traditional approach is to use the port scanning software, such as *nmap* or *masscan*:

![scanning the internet with masscan](https://sp-ao.shortpixel.ai/client/to_webp,q_glossy,ret_img,w_980,h_101/https://www.povilaika.com/wp-content/uploads/2022/05/scanning_the_internet.png)![scanning the internet with masscan](data:image/svg+xml...)

The result can then be formatted using *cat*, *tr,* and *cut* utilities:

![formatting masscan output for nmap](https://sp-ao.shortpixel.ai/client/to_webp,q_glossy,ret_img,w_980,h_30/https://www.povilaika.com/wp-content/uploads/2022/05/formatting_masscan_output.png)![formatting masscan output for nmap](data:image/svg+xml...)

Finally, load up the new host file into *nmap* for banner grabbing:

![banner grabbing with nmap](https://sp-ao.shortpixel.ai/client/to_webp,q_glossy,ret_img,w_980,h_58/https://www.povilaika.com/wp-content/uploads/2022/05/nmap_banner_grabbing.png)![banner grabbing with nmap](data:image/svg+xml...)

After some waiting, *nmap* finally went through the ~280k host file supplied and saved the results in a text file. After going through random samples from the results manually, we did get some hits with our compiled Apache 2.4.50 exploit:

![apache 2.4.50 exploit](https://sp-ao.shortpixel.ai/client/to_webp,q_glossy,ret_img,w_1018,h_546/https://www.povilaika.com/wp-content/uploads/2022/05/apache_2.4.50_exploit.png)![apache 2.4.50 exploit](data:image/svg+xml...)

However, few hosts were running this specific version of Apache HTTPd, and even fewer were vulnerable to the attack.

With around roughly 1.5 thousand hosts running Apache 2.4.50 according to Censys, and with about one in six vulnerable, we get mere hundreds of exploitable systems as of May 2022.

 [apache](https://www.povilaika.com/tag/apache/)
### Leave a Reply [Cancel reply](/apache-2-4-50-exploit/#respond)

Your email address will not be published. Required fields are marked \*

Comment \*

Name \*

Email \*

Website

 Save my name, email, and website in this browser for the next time I comment.

## Recent Posts

* [Penetration Testing Checklist](https://www.povilaika.com/penetration-testing-checklist/)
* [Using a CVE-2021-42013 Apache 2.4.50 exploit in the wild​](https://www.povilaika.com/apache-2-4-50-exploit/)
  Povilaika Solutions | All rights reserved

* [Home](https://www.povilaika.com/)
* [Blog](https://www.povilaika.com/blog/)
      [Go to mobile version](https://www.povilaika.com/apache-2-4-50-exploit/?amp=1)