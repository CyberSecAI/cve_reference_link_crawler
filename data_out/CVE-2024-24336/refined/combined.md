=== Content from nitipoom-jar.github.io_209f4361_20250111_180529.html ===

Quantiano

# CVE-2024-24336

2024-02-06

Nitipoom Jaroonchaipipat

---

## Product detail ⌗

Affected product: Koha

Affected version: 23.05.05.00 (This vulnerability was discovered on November 2023)

Affected components: '/members/moremember.pl' and ‘/members/members-home.pl’

A multiple Cross-site scripting (XSS) vulnerability in the '/members/moremember.pl', and ‘/members/members-home.pl’ endpoints within Koha Library Management System version <= 23.05.05 allows malicious staff users to carry out CSRF attacks, including unauthorized changes to usernames and passwords of users visiting the affected page, via the 'Circulation note' and ‘Patrons Restriction’ components.

---

## Prerequisite [⌗](#proof-of-concept)

Install Koha from official Koha Github repository
[GitHub page](https://github.com/Koha-Community/Koha)

![](https://nitipoom-jar.github.io/CVE-2024-24336/0.png)

Installed Koha version 23.05.05

---

## Exploitation [⌗](#proof-of-concept)

1. We have 2 roles in the system. lead\_admin and patrons\_staff

![](https://nitipoom-jar.github.io/CVE-2024-24336/1.png)

2. Patrons\_staff can only staff access into this web portal and add, modify, and view patron only

![](https://nitipoom-jar.github.io/CVE-2024-24336/2.png)

3. But patrons\_staff with granted won’t be able to edit username for any user except the system admin (same level as default admin by the system)

![](https://nitipoom-jar.github.io/CVE-2024-24336/3.png)

4. Try with a simple xss payload on affected field

![](https://nitipoom-jar.github.io/CVE-2024-24336/4.png)

5. Change from xss popup message to csrf for impact, since cookie had been set with httponly flag, so we couldn’t steal it.

![](https://nitipoom-jar.github.io/CVE-2024-24336/5.png)

5. The above javascript code will force user send request along with CSRF token, which we will change username and password for default admin which has a number of 1

6. Exploitation in gif shows that malicious staff delivered csrf attack to lead admin successful and changed their username

![](https://nitipoom-jar.github.io/CVE-2024-24336/6.gif)

© 2023 Powered by
[Hugo](https://gohugo.io)

::
[Theme](https://github.com/panr/hugo-theme-terminal)
made by
[panr](https://github.com/panr)


