=== Content from phabricator.wikimedia.org_44ee29b2_20250111_190616.html ===
Page Menu[HomePhabricator](/)

* SearchConfigure Global Search

[Log In](https://phabricator.wikimedia.org/auth/start/?next=%2FT368628)[Create Task](/maniphest/task/edit/nocreate/) [Maniphest](/maniphest/)  T368628
# Write and send supplementary release announcement for extensions and skins with security patches (1.39.9/1.41.3/1.42.2)Closed, Resolved[Public](/policy/explain/PHID-TASK-iioqdvgypcne7ektjakw/view/)SecurityActions

* [Edit Task](/maniphest/task/edit/368628/)
* Edit Related Tasks...
* [Create Subtask](/maniphest/task/subtask/368628/)
* [Edit Parent Tasks](/search/rel/task.has-parent/PHID-TASK-iioqdvgypcne7ektjakw/)
* [Edit Subtasks](/search/rel/task.has-subtask/PHID-TASK-iioqdvgypcne7ektjakw/)
* [Merge Duplicates In](/search/rel/task.merge-in/PHID-TASK-iioqdvgypcne7ektjakw/)
* [Close As Duplicate](/search/rel/task.close-as-duplicate/PHID-TASK-iioqdvgypcne7ektjakw/)
* Edit Related Objects...
* [Edit Commits](/search/rel/task.has-commit/PHID-TASK-iioqdvgypcne7ektjakw/)
* [Edit Mocks](/search/rel/task.has-mock/PHID-TASK-iioqdvgypcne7ektjakw/)
* Subscribe
* [Mute Notifications](/subscriptions/mute/PHID-TASK-iioqdvgypcne7ektjakw/)
* [Protect as security issue](/wmf/escalate-task/368628/)
* [Award Token](/token/give/PHID-TASK-iioqdvgypcne7ektjakw/)
* [Flag For Later](/flag/edit/PHID-TASK-iioqdvgypcne7ektjakw/)

Assigned To

|  | [Mstyles](/p/Mstyles/) |
| --- | --- |

Authored By

|  | [Reedy](/p/Reedy/) |
| --- | --- |
| Jun 27 2024, 3:22 PM2024-06-27 15:22:38 (UTC+0) |

Tags

* [Security](/tag/security/)
* [MediaWiki-Releasing](/tag/mediawiki-releasing/) [(Backlog)](/project/board/1539/)
Referenced FilesNoneSubscribers

|  | [Aklapper](/p/Aklapper/) |
| --- | --- |

|  | [Bawolff](/p/Bawolff/) |
| --- | --- |

|  | [mmartorana](/p/mmartorana/) |
| --- | --- |

|  | [Mstyles](/p/Mstyles/) |
| --- | --- |

|  | [R4356th](/p/R4356th/) |
| --- | --- |

|  | [Reedy](/p/Reedy/) |
| --- | --- |

|  | [RhinosF1](/p/RhinosF1/) |
| --- | --- |

|  | [sbassett](/p/sbassett/) |
| --- | --- |

# Description

Previous work: [T361321: Write and send supplementary release announcement for extensions and skins with security patches (1.39.8/1.40.4/1.41.2/1.42.0)](/T361321) / [T353904: Write and send supplementary release announcement for extensions and skins with security patches (1.39.7/1.40.3/1.41.1)](/T353904)

| Maniphest ID | Extension or Skin | CVE ID | REL1\_39 | REL1\_41 | REL1\_42 | master |
| --- | --- | --- | --- | --- | --- | --- |
| [T366991](/T366991) | [PageTriage](https://www.mediawiki.org/wiki/Extension%3APageTriage) | [CVE-2024-47848](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-47848) | No | No | [Yes](https://gerrit.wikimedia.org/r/1077081) | [Yes](https://gerrit.wikimedia.org/r/1076839) |
| [T368594](/T368594) | [CSS](https://www.mediawiki.org/wiki/Extension%3ACSS) | [CVE-2024-47845](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-47845) | No | No | [Yes](https://gerrit.wikimedia.org/r/c/mediawiki/extensions/CSS/%2B/1076838) | [Yes](https://gerrit.wikimedia.org/r/c/mediawiki/extensions/CSS/%2B/1074402) |
| [T370022](/T370022) | [Widgets](https://www.mediawiki.org/wiki/Extension%3AWidgets) | [CVE-2024-35226](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-35226) | [Yes](https://gerrit.wikimedia.org/r/1054642) | No | [Yes](https://gerrit.wikimedia.org/r/1054643) | [Yes](https://gerrit.wikimedia.org/r/1054486) |
| [T370632](/T370632) | [Cargo](https://www.mediawiki.org/wiki/Extension%3ACargo) | [CVE-2024-47849](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-47849) | No | No | No | [Yes](https://gerrit.wikimedia.org/r/1055963) |
| [T372209](/T372209) | [Cargo](https://www.mediawiki.org/wiki/Extension%3ACargo) | [CVE-2024-47846](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-47846) | No | No | No | [Yes](https://gerrit.wikimedia.org/r/1062723) |
| [T372211](/T372211) | [Cargo](https://www.mediawiki.org/wiki/Extension%3ACargo) | [CVE-2024-47847](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-47847) | No | No | No | Yes ([1](https://gerrit.wikimedia.org/r/1063804), [2](https://gerrit.wikimedia.org/r/1063806), [3](https://gerrit.wikimedia.org/r/1063827), [4](https://gerrit.wikimedia.org/r/1063831)) |
| [T370081](/T370081) | [Apex](https://www.mediawiki.org/wiki/Skin%3AApex) | [CVE-2024-47840](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-47840) | No | No | [Yes](https://gerrit.wikimedia.org/r/c/mediawiki/skins/apex/%2B/1071636) | [Yes](https://gerrit.wikimedia.org/r/c/mediawiki/skins/apex/%2B/1064405) |
| [T369486](/T369486) | [CSS](https://www.mediawiki.org/wiki/Extension%3ACSS) | [CVE-2024-47841](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-47841) | No | No | [Yes](https://gerrit.wikimedia.org/r/1067324) | [Yes](https://gerrit.wikimedia.org/r/c/mediawiki/extensions/CSS/%2B/1067223) |
| [T375358](/T375358) | [DataTransfer](https://www.mediawiki.org/wiki/Extension%3ADataTransfer) | [CVE-2024-45048](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-45048), [CVE-2024-45046](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-45046) | [Yes](https://gerrit.wikimedia.org/r/1075048) | No | No | [Yes](https://gerrit.wikimedia.org/r/1074761) |
|

**Template**

| Txxxxxx | [ExtName](https://www.mediawiki.org/wiki/Extension%3AExtName) | [CVE-2024-xxxxx](https://www.cve.org/CVERecord?id=CVE-2024-xxxxx) | [No](https://gerrit.wikimedia.org/r/) | [No](https://gerrit.wikimedia.org/r/) | [No](https://gerrit.wikimedia.org/r/) | [No](https://gerrit.wikimedia.org/r/) |
| --- | --- | --- | --- | --- | --- | --- |
|

**Notes**

1. [T373889](/T373889) - ext:CommunityConfiguration briefly had XSS issues on the beta cluster
# Details

Risk Rating Informational Author Affiliation WMF Technology Dept
# Related ObjectsSearch...

* Task Graph
* Mentions

|  |  | Status | Subtype | Assigned | Task |
| --- | --- | --- | --- | --- | --- |
|  |  |  |  |  | Restricted Task |
|  |  | Resolved | Security | [Mstyles](/p/Mstyles/) | T368628 [Write and send supplementary release announcement for extensions and skins with security patches (1.39.9/1.41.3/1.42.2)](/T368628) |

Mentioned In [T366991: CVE-2024-47848: User can review/unreview articles while blocked](/T366991)
[T370081: CVE-2024-47840: Stored XSS through sidebar in Apex skin](/T370081) Mentioned Here [T375358: Extension:DataTransfer uses vulnerable version of `phpoffice/phpspreadsheet`](/T375358)
[T373889: Community updates is vulnerable to XSS attacks via CommunityConfiguration](/T373889)
[T369486: CVE-2024-47841: Path traversal when loading stylesheets from /w/skins/ can load files outside of /w/skins/](/T369486)
[T370081: CVE-2024-47840: Stored XSS through sidebar in Apex skin](/T370081)
[T372211: CVE-2024-47847: Various XSSes found in Cargo](/T372211)
[T372209: CVE-2024-47846: Special:DeleteCargoTable and Special:SwitchCargoTable have no CSRF protection](/T372209)
[T370632: CVE-2024-47849: Cargo: Backticks can allow the usage of not-allowed SQL functions](/T370632)
[T370022: Version `4.3.5` of `smarty/smarty` library in Extension:Widgets library has CVE-2024-35226](/T370022)
[T368594: CVE-2024-47845: Extension:CSS uses CSS sanitizer incorrectly, and is easily bypassed](/T368594)
[T366991: CVE-2024-47848: User can review/unreview articles while blocked](/T366991)
[T353904: Write and send supplementary release announcement for extensions and skins with security patches (1.39.7/1.40.3/1.41.1)](/T353904)
[T361321: Write and send supplementary release announcement for extensions and skins with security patches (1.39.8/1.40.4/1.41.2/1.42.0)](/T361321)
### Event Timeline

[Reedy](/p/Reedy/) created this task.[Jun 27 2024, 3:22 PM2024-06-27 15:22:38 (UTC+0)](#9931033)Restricted Application added a subscriber: [Aklapper](/p/Aklapper/).  Â· [View Herald Transcript](/herald/transcript/6011049/)[Jun 27 2024, 3:22 PM2024-06-27 15:22:39 (UTC+0)](#9931042)[Reedy](/p/Reedy/) added a parent task: Restricted Task.[Jun 27 2024, 3:22 PM2024-06-27 15:22:49 (UTC+0)](#9931045)[Reedy](/p/Reedy/) edited projects, added [MediaWiki-Releasing](/tag/mediawiki-releasing/); removed [Security-Team](/tag/security-team/).[Reedy](/p/Reedy/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-oju5i24m3pomrsz/)[sbassett](/p/sbassett/) changed the task status from Open to In Progress.[Jul 8 2024, 9:15 PM2024-07-08 21:15:53 (UTC+0)](#9963073)[sbassett](/p/sbassett/) triaged this task as Medium priority.[sbassett](/p/sbassett/) changed Author Affiliation from N/A to WMF Technology Dept.[sbassett](/p/sbassett/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-2b5qn5nyy3t67gk/)[sbassett](/p/sbassett/) changed Risk Rating from N/A to Informational.[sbassett](/p/sbassett/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-4ygyqvajtorb6gg/)[sbassett](/p/sbassett/) added subscribers: [mmartorana](/p/mmartorana/), [Mstyles](/p/Mstyles/), [Bawolff](/p/Bawolff/), [RhinosF1](/p/RhinosF1/).[sbassett](/p/sbassett/) subscribed.[sbassett](/p/sbassett/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-oqwjdfxuxwyuecj/)[Jul 8 2024, 9:20 PM2024-07-08 21:20:03 (UTC+0)](#9963091)[sbassett](/p/sbassett/) added a project: [user-sbassett](/tag/user-sbassett/).[sbassett](/p/sbassett/) moved this task from [Backlog](/project/board/3979/) to [In Progress](/project/board/3979/) on the [user-sbassett](/tag/user-sbassett/) board.[sbassett](/p/sbassett/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-rvllmlzepyilkhs/)[Jul 16 2024, 11:43 PM2024-07-16 23:43:20 (UTC+0)](#9988756)[sbassett](/p/sbassett/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-vde6ynrl7cdoq4m/)[Jul 22 2024, 4:48 PM2024-07-22 16:48:30 (UTC+0)](#10003624)[sbassett](/p/sbassett/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-i6gr35itfim4xst/)[sbassett](/p/sbassett/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-yrrskhdifi4nijv/)[Jul 22 2024, 5:36 PM2024-07-22 17:36:43 (UTC+0)](#10003926)[sbassett](/p/sbassett/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-r4wqept42nicbpu/)[Aug 15 2024, 3:05 PM2024-08-15 15:05:44 (UTC+0)](#10067172)[sbassett](/p/sbassett/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-kw6c2tpgyuad4ml/)[sbassett](/p/sbassett/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-q4sw2jglosd7jaz/)[Aug 19 2024, 3:14 PM2024-08-19 15:14:59 (UTC+0)](#10073835)[sbassett](/p/sbassett/) added a subscriber: [R4356th](/p/R4356th/).[sbassett](/p/sbassett/) mentioned this in [T370081: CVE-2024-47840: Stored XSS through sidebar in Apex skin](/T370081).[Aug 19 2024, 3:17 PM2024-08-19 15:17:16 (UTC+0)](#10073849)[sbassett](/p/sbassett/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-yxmigpzo5zqestg/)[Aug 20 2024, 1:57 PM2024-08-20 13:57:20 (UTC+0)](#10077613)[sbassett](/p/sbassett/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-wdeqzi45iz5kdgt/)[Aug 26 2024, 4:20 PM2024-08-26 16:20:03 (UTC+0)](#10092953)[Mstyles](/p/Mstyles/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-bvri26fywn7q32p/)[Aug 30 2024, 12:46 AM2024-08-30 00:46:31 (UTC+0)](#10105039)[sbassett](/p/sbassett/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-j5lhbp6ptlxpkmx/)[Sep 5 2024, 3:06 PM2024-09-05 15:06:47 (UTC+0)](#10121937)[sbassett](/p/sbassett/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-svxhzj6gbqrhwcf/)[Sep 23 2024, 3:53 PM2024-09-23 15:53:40 (UTC+0)](#10168129)[sbassett](/p/sbassett/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-xebnhljcwagu2cu/)[Sep 23 2024, 3:56 PM2024-09-23 15:56:58 (UTC+0)](#10168158)[Mstyles](/p/Mstyles/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-xdt3zdlsiyd5wew/)[Sep 30 2024, 8:59 PM2024-09-30 20:59:48 (UTC+0)](#10189718)[Mstyles](/p/Mstyles/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-mzwumlqym7qaszs/)[Oct 5 2024, 12:16 AM2024-10-05 00:16:23 (UTC+0)](#10204292)[Mstyles](/p/Mstyles/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-axt5vayfqhisksz/)[Oct 5 2024, 1:21 AM2024-10-05 01:21:20 (UTC+0)](#10204323)[Mstyles](/p/Mstyles/) added a comment.[Oct 5 2024, 1:40 AM2024-10-05 01:40:23 (UTC+0)](#10204325)Comment Actions

Subject: MediaWiki Extensions and Skins Security Release Supplement (1.39.9/1.41.3/1.42.2)

Greetings-

With the security/maintenance release of MediaWiki 1.39.9/1.41.3/1.42.2, we would also like to provide this supplementary announcement of MediaWiki extensions and skins with now-public Phabricator tasks, security patches and backports [1]:

PageTriage

+ ([T366991](/T366991), CVE-2024-47848) - User can review/unreview articles while blocked

<https://gerrit.wikimedia.org/r/q/I0288a715f7040a14ab7f70b2888fe1ef77a44588>

CSS

+ ([T368594](/T368594), CVE-2024-47845) - CSS sanitizer used incorrectly

<https://gerrit.wikimedia.org/r/q/I6f38f4a8fc1dcd690ab27b8f18ce6ca903bacc53>

Widgets

+ ([T370022](/T370022), CVE-2024-35226) - smarty library version has CVE

<https://gerrit.wikimedia.org/r/q/I18f161c338f8c52477a766524c255a31879d5e63>

Cargo

+ ([T370632](/T370632), CVE-2024-47849) - Backticks can allow the usage of not-allowed SQL functions

[https://gerrit.wikimedia.org/r/c/mediawiki/extensions/Cargo/+/1055963](https://gerrit.wikimedia.org/r/c/mediawiki/extensions/Cargo/%2B/1055963)

Cargo

+ ([T372209](/T372209), CVE-2024-47846) - Special:DeleteCargoTable and Special:SwitchCargoTable have no CSRF protection

[https://gerrit.wikimedia.org/r/c/mediawiki/extensions/Cargo/+/1062723](https://gerrit.wikimedia.org/r/c/mediawiki/extensions/Cargo/%2B/1062723)

Cargo

+ ([T372211](/T372211), CVE-2024-47847) - Various XSSes found in Cargo

[https://gerrit.wikimedia.org/r/c/mediawiki/extensions/Cargo/+/1063804](https://gerrit.wikimedia.org/r/c/mediawiki/extensions/Cargo/%2B/1063804)

[https://gerrit.wikimedia.org/r/c/mediawiki/extensions/Cargo/+/1063806](https://gerrit.wikimedia.org/r/c/mediawiki/extensions/Cargo/%2B/1063806)

[https://gerrit.wikimedia.org/r/c/mediawiki/extensions/Cargo/+/1063827](https://gerrit.wikimedia.org/r/c/mediawiki/extensions/Cargo/%2B/1063827)

[https://gerrit.wikimedia.org/r/c/mediawiki/extensions/Cargo/+/1063831](https://gerrit.wikimedia.org/r/c/mediawiki/extensions/Cargo/%2B/1063831)

Apex

+ ([T370081](/T370081), CVE-2024-47840) - Stored XSS through sidebar

<https://gerrit.wikimedia.org/r/q/Id9093783051c3f8e6dcb5dc89f9493a5f5cf7bd7>

CSS

+ ([T369486](/T369486), CVE-2024-47841) - Path traversal when loading stylesheets

<https://gerrit.wikimedia.org/r/q/I46613d8d50fc978bdac58e2b312ee03324c1edc8>

DataTransfer

+ ([T375358](/T375358), CVE-2024-45048, CVE-2024-45046) - vulnerable version of phpoffice/phpspreadsheet

[https://gerrit.wikimedia.org/r/c/mediawiki/extensions/DataTransfer/+/1074761](https://gerrit.wikimedia.org/r/c/mediawiki/extensions/DataTransfer/%2B/1074761)

The Wikimedia Security Team recommends updating these extensions and/or skins to the current master branch or relevant, supported release branch [2] as soon as possible. Some of the referenced Phabricator tasks above \_may\_ still be private. Unfortunately, when security issues are reported, sometimes sensitive information is exposed and since Phabricator is historical, we cannot make these tasks public without exposing this sensitive information. If you have any additional questions or concerns regarding this update, please feel free to contact security@wikimedia.org or file a security task within Phabricator [3].

[1] <https://phabricator.wikimedia.org/T368628>

[2] <https://www.mediawiki.org/wiki/Version_lifecycle>

[3] <https://www.mediawiki.org/wiki/Reporting_security_bugs>

[Mstyles](/p/Mstyles/) closed this task as Resolved.[Oct 5 2024, 1:46 AM2024-10-05 01:46:43 (UTC+0)](#10204326)[Mstyles](/p/Mstyles/) claimed this task.Comment Actions

Supplemental announcement is out!

* [mediawiki-announce](https://lists.wikimedia.org/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/thread/HSYMEVZJGTFJ732R62K3BI2AIYPK2AN2/)
* [wikitech-I](https://lists.wikimedia.org/hyperkitty/list/wikitech-l%40lists.wikimedia.org/thread/HSYMEVZJGTFJ732R62K3BI2AIYPK2AN2/)
* [mediawiki-I](https://lists.wikimedia.org/hyperkitty/list/mediawiki-l%40lists.wikimedia.org/thread/HSYMEVZJGTFJ732R62K3BI2AIYPK2AN2/)
[Mstyles](/p/Mstyles/) changed the visibility from "[Custom Policy](/transactions/old/PHID-XACT-TASK-xgrvjr4tugoua2j/)" to "Public (No Login Required)".[Oct 5 2024, 1:47 AM2024-10-05 01:47:00 (UTC+0)](#10204330)[Mstyles](/p/Mstyles/) changed the edit policy from "[Custom Policy](/transactions/old/PHID-XACT-TASK-2yz3lrkhbc7twzg/)" to "All Users".[sbassett](/p/sbassett/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-akgcyui4rrjrfcn/)[Oct 7 2024, 2:52 PM2024-10-07 14:52:28 (UTC+0)](#10207013)[sbassett](/p/sbassett/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-kdeoxojcw2b54qk/)[sbassett](/p/sbassett/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-ewugavm5iefxbpu/)[Oct 7 2024, 2:55 PM2024-10-07 14:55:30 (UTC+0)](#10207023)[sbassett](/p/sbassett/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-msmyhgbk5lwcs7r/)[sbassett](/p/sbassett/) removed a project: [user-sbassett](/tag/user-sbassett/).[Oct 7 2024, 3:02 PM2024-10-07 15:02:36 (UTC+0)](#10207048)[sbassett](/p/sbassett/) mentioned this in [T366991: CVE-2024-47848: User can review/unreview articles while blocked](/T366991).[Oct 22 2024, 2:08 PM2024-10-22 14:08:15 (UTC+0)](#10250362)Content licensed under Creative Commons Attribution-ShareAlike (CC BY-SA) 4.0 unless otherwise noted; code licensed under GNU General Public License (GPL) 2.0 or later and other open source licenses. By using this site, you agree to the Terms of Use, Privacy Policy, and Code of Conduct. Â· [Wikimedia Foundation](https://wikimediafoundation.org/) Â· [Privacy Policy](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ANon-wiki_privacy_policy) Â· [Code of Conduct](https://www.mediawiki.org/wiki/Special%3AMyLanguage/Code_of_Conduct) Â· [Terms of Use](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ATerms_of_Use/Phabricator) Â· [Disclaimer](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3AGeneral_disclaimer) Â· [CC-BY-SA](https://creativecommons.org/licenses/by-sa/4.0/) Â· [GPL](https://www.gnu.org/licenses/old-licenses/gpl-2.0.html) Â· [Credits](https://www.mediawiki.org/wiki/Phabricator/Credits)

=== Content from phabricator.wikimedia.org_bc366384_20250111_190617.html ===
Page Menu[HomePhabricator](/)

* SearchConfigure Global Search

[Log In](https://phabricator.wikimedia.org/auth/start/?next=%2FT370081)[Create Task](/maniphest/task/edit/nocreate/) [Maniphest](/maniphest/)  T370081
# CVE-2024-47840: Stored XSS through sidebar in Apex skinClosed, Resolved[Public](/policy/explain/PHID-TASK-nchlzkn5cihnmmaxh5aq/view/)SecurityActions

* [Edit Task](/maniphest/task/edit/370081/)
* Edit Related Tasks...
* [Create Subtask](/maniphest/task/subtask/370081/)
* [Edit Parent Tasks](/search/rel/task.has-parent/PHID-TASK-nchlzkn5cihnmmaxh5aq/)
* [Edit Subtasks](/search/rel/task.has-subtask/PHID-TASK-nchlzkn5cihnmmaxh5aq/)
* [Merge Duplicates In](/search/rel/task.merge-in/PHID-TASK-nchlzkn5cihnmmaxh5aq/)
* [Close As Duplicate](/search/rel/task.close-as-duplicate/PHID-TASK-nchlzkn5cihnmmaxh5aq/)
* Edit Related Objects...
* [Edit Commits](/search/rel/task.has-commit/PHID-TASK-nchlzkn5cihnmmaxh5aq/)
* [Edit Mocks](/search/rel/task.has-mock/PHID-TASK-nchlzkn5cihnmmaxh5aq/)
* Subscribe
* [Mute Notifications](/subscriptions/mute/PHID-TASK-nchlzkn5cihnmmaxh5aq/)
* [Protect as security issue](/wmf/escalate-task/370081/)
* [Award Token](/token/give/PHID-TASK-nchlzkn5cihnmmaxh5aq/)
* [Flag For Later](/flag/edit/PHID-TASK-nchlzkn5cihnmmaxh5aq/)

Assigned To

|  | [Mstyles](/p/Mstyles/) |
| --- | --- |

Authored By

|  | [R4356th](/p/R4356th/) |
| --- | --- |
| Jul 15 2024, 4:51 PM2024-07-15 16:51:05 (UTC+0) |

Tags

* [Security](/tag/security/)
* [Apex](/tag/apex/) [(Backlog)](/project/board/941/)
* [Vuln-XSS](/tag/vuln-xss/)
* [SecTeam-Processed](/tag/secteam-processed/) [(Completed)](/project/board/5180/)
* [Patch-For-Review](/tag/patch-for-review/)
Referenced Files

|  | [F57276847: 0001-SECURITY-Escape-MediaWiki-Sidebar-before-rendering.patch](/F57276847) |
| --- | --- |
| Aug 16 2024, 1:40 PM2024-08-16 13:40:40 (UTC+0) |

Subscribers

|  | [Aklapper](/p/Aklapper/) |
| --- | --- |

|  | [gerritbot](/p/gerritbot/) |
| --- | --- |

|  | [mmartorana](/p/mmartorana/) |
| --- | --- |

|  | [R4356th](/p/R4356th/) |
| --- | --- |

|  | [sbassett](/p/sbassett/) |
| --- | --- |

# Description

Apex renders the sidebar without any form of escaping. Interface admins or others with access to MediaWiki:Sidebar can exploit this. The issue can be reproduced with code like '><script>alert('sidebar-custom');</script><'.

# Details

Risk Rating Low Author Affiliation Wikimedia Communities

|  | Subject | Repo | Branch | Lines +/- |
| --- | --- | --- | --- | --- |
|  | [SECURITY: Escape MediaWiki:Sidebar before rendering](https://gerrit.wikimedia.org/r/c/1071636) | [mediawiki/skins/apex](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/skins/apex) | [REL1\_42](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/skins/apex/%2B/REL1_42) | +1 -1 |
|  | [SECURITY: Escape MediaWiki:Sidebar before rendering](https://gerrit.wikimedia.org/r/c/1071635) | [mediawiki/skins/apex](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/skins/apex) | [REL1\_40](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/skins/apex/%2B/REL1_40) | +1 -1 |
|  | [SECURITY: Escape MediaWiki:Sidebar before rendering](https://gerrit.wikimedia.org/r/c/1064405) | [mediawiki/skins/apex](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/skins/apex) | [master](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/skins/apex/%2B/master) | +1 -1 |

[Customize query in gerrit](https://gerrit.wikimedia.org/r/#/q/bug:T370081)
# Related Objects

* Mentions

Mentioned In [T368628: Write and send supplementary release announcement for extensions and skins with security patches (1.39.9/1.41.3/1.42.2)](/T368628) Mentioned Here [T368628: Write and send supplementary release announcement for extensions and skins with security patches (1.39.9/1.41.3/1.42.2)](/T368628)
[T361452: CVE-2024-40605: Foreground skin: stored XSS via MediaWiki:Sidebar](/T361452)
### Event Timeline

[R4356th](/p/R4356th/) created this task.[Jul 15 2024, 4:51 PM2024-07-15 16:51:05 (UTC+0)](#9982423)Restricted Application added a subscriber: [Aklapper](/p/Aklapper/).  Â· [View Herald Transcript](/herald/transcript/6040552/)[Jul 15 2024, 4:51 PM2024-07-15 16:51:08 (UTC+0)](#9982436)[R4356th](/p/R4356th/) added a project: [Apex](/tag/apex/).[Jul 15 2024, 4:51 PM2024-07-15 16:51:31 (UTC+0)](#9982437)[R4356th](/p/R4356th/) added a project: [Vuln-XSS](/tag/vuln-xss/).[R4356th](/p/R4356th/) added a comment.[Jul 15 2024, 5:00 PM2024-07-15 17:00:11 (UTC+0)](#9982471)Comment Actions

Seeing as the skin is not actively maintained and the original author has been away for a long time now, would the Security Team be able to merge a patch to this?

Also, this is actually the same issue as [T361452](/T361452); are similar cases being tracked anywhere?

[sbassett](/p/sbassett/) edited projects, added [SecTeam-Processed](/tag/secteam-processed/); removed [Security-Team](/tag/security-team/).[Jul 22 2024, 4:27 PM2024-07-22 16:27:51 (UTC+0)](#10003490)[mmartorana](/p/mmartorana/) changed the task status from Open to In Progress.Edited Â· [Jul 23 2024, 3:54 PM2024-07-23 15:54:29 (UTC+0)](#10007466)[mmartorana](/p/mmartorana/) triaged this task as Medium priority.[mmartorana](/p/mmartorana/) changed Risk Rating from N/A to Low.[mmartorana](/p/mmartorana/) subscribed.Comment Actions
> In [T370081#9982471](/T370081#9982471), [@R4356th](/p/R4356th/) wrote:
>
> Seeing as the skin is not actively maintained and the original author has been away for a long time now, would the Security Team be able to merge a patch to this?
>
> Also, this is actually the same issue as [T361452](/T361452); are similar cases being tracked anywhere?

Hi, the [Security-Team](/tag/security-team/) is happy to review and merge any patch for this issue; however, we do not plan to actively work on developing a patch ourselves.

Thanks

[R4356th](/p/R4356th/) added a comment.[Aug 16 2024, 1:40 PM2024-08-16 13:40:40 (UTC+0)](#10069490)Comment Actions

Hi [@mmartorana](/p/mmartorana/), apologies for the late reply. To be clear, I was not asking if the Security Team would be willing to develop a patch at all; I just wanted to know if you would be willing to merge it. Anyway, I am glad to hear you are, so here is the patch. Considering this issue requires elevated access, I think pushing this to Gerrit would be fine. Thanks for your time.

0001-SECURITY-Escape-MediaWiki-Sidebar-before-rendering.patch1007 B[Download](https://phab.wmfusercontent.org/file/download/seyrgewx6jwpbay3z64f/PHID-FILE-jmyvj6jwbsya5rbcjxqh/0001-SECURITY-Escape-MediaWiki-Sidebar-before-rendering.patch)

[sbassett](/p/sbassett/) subscribed.[Aug 16 2024, 3:23 PM2024-08-16 15:23:04 (UTC+0)](#10069783)Comment Actions
> In [T370081#10069490](/T370081#10069490), [@R4356th](/p/R4356th/) wrote:
>
> 0001-SECURITY-Escape-MediaWiki-Sidebar-before-rendering.patch1007 B[Download](https://phab.wmfusercontent.org/file/download/seyrgewx6jwpbay3z64f/PHID-FILE-jmyvj6jwbsya5rbcjxqh/0001-SECURITY-Escape-MediaWiki-Sidebar-before-rendering.patch)

+1 for the specific escape of Sanitizer::escapeIdForAttribute( "p-$name" ) here. Though I didn't review the code to determine if there are any *additional* XSS sinks at this time...

[R4356th](/p/R4356th/) added a comment.[Aug 17 2024, 5:49 PM2024-08-17 17:49:44 (UTC+0)](#10071391)Comment Actions
> In [T370081#10069783](/T370081#10069783), [@sbassett](/p/sbassett/) wrote:
>
> +1 for the specific escape of Sanitizer::escapeIdForAttribute( "p-$name" ) here. Though I didn't review the code to determine if there are any *additional* XSS sinks at this time...

Thanks, I have pentested to make sure it's fine. Are you fine with me pushing this to Gerrit now?

[sbassett](/p/sbassett/) mentioned this in [T368628: Write and send supplementary release announcement for extensions and skins with security patches (1.39.9/1.41.3/1.42.2)](/T368628).[Aug 19 2024, 3:14 PM2024-08-19 15:14:59 (UTC+0)](#10073837)[sbassett](/p/sbassett/) added a comment.Edited Â· [Aug 19 2024, 3:17 PM2024-08-19 15:17:16 (UTC+0)](#10073848)Comment Actions
> In [T370081#10071391](/T370081#10071391), [@R4356th](/p/R4356th/) wrote:
>
> Thanks, I have pentested to make sure it's fine. Are you fine with me pushing this to Gerrit now?

Yes, that's fine. In general, as long as the code isn't [bundled](https://www.mediawiki.org/wiki/Bundled_extensions_and_skins) or [Wikimedia-production-deployed](https://noc.wikimedia.org/conf/highlight.php?file=wmf-config/extension-list), it's fine to push security fixes publicly and get them merged. We try to (re-)announce issues like this via the supplemental security releases - I've added this issue to the tracking task for the next supplemental release: [T368628](/T368628).

[sbassett](/p/sbassett/) added a subscriber: [gerritbot](/p/gerritbot/).[Aug 19 2024, 3:17 PM2024-08-19 15:17:33 (UTC+0)](#10073851)[gerritbot](/p/gerritbot/) added a comment.[Aug 21 2024, 4:04 PM2024-08-21 16:04:04 (UTC+0)](#10082052)Comment Actions

Change #1064405 had a related patch set uploaded (by R4356thwiki; author: R4356thwiki):

[mediawiki/skins/apex@master] Bug: T370081

<https://gerrit.wikimedia.org/r/1064405>

[gerritbot](/p/gerritbot/) added a project: [Patch-For-Review](/tag/patch-for-review/).[Aug 21 2024, 4:04 PM2024-08-21 16:04:06 (UTC+0)](#10082053)[gerritbot](/p/gerritbot/) added a comment.[Aug 21 2024, 4:12 PM2024-08-21 16:12:20 (UTC+0)](#10082086)Comment Actions

Change #1064405 had a related patch set uploaded (by R4356thwiki; author: R4356thwiki):

[mediawiki/skins/apex@master] SECURITY: Escape MediaWiki:Sidebar before rendering

<https://gerrit.wikimedia.org/r/1064405>

[gerritbot](/p/gerritbot/) added a comment.[Sep 9 2024, 2:28 PM2024-09-09 14:28:04 (UTC+0)](#10130142)Comment Actions

Change #1064405 **merged** by jenkins-bot:

[mediawiki/skins/apex@master] SECURITY: Escape MediaWiki:Sidebar before rendering

<https://gerrit.wikimedia.org/r/1064405>

[gerritbot](/p/gerritbot/) added a comment.[Sep 9 2024, 3:09 PM2024-09-09 15:09:15 (UTC+0)](#10130388)Comment Actions

Change #1071635 had a related patch set uploaded (by R4356thwiki; author: R4356thwiki):

[mediawiki/skins/apex@REL1\_40] SECURITY: Escape MediaWiki:Sidebar before rendering

<https://gerrit.wikimedia.org/r/1071635>

[gerritbot](/p/gerritbot/) added a comment.[Sep 9 2024, 3:11 PM2024-09-09 15:11:57 (UTC+0)](#10130400)Comment Actions

Change #1071635 **abandoned** by R4356thwiki:

[mediawiki/skins/apex@REL1\_40] SECURITY: Escape MediaWiki:Sidebar before rendering

Reason:

Whoops, didn't realise 1.40 is EOL

<https://gerrit.wikimedia.org/r/1071635>

[gerritbot](/p/gerritbot/) added a comment.[Sep 9 2024, 3:12 PM2024-09-09 15:12:40 (UTC+0)](#10130409)Comment Actions

Change #1071636 had a related patch set uploaded (by R4356thwiki; author: R4356thwiki):

[mediawiki/skins/apex@REL1\_42] SECURITY: Escape MediaWiki:Sidebar before rendering

<https://gerrit.wikimedia.org/r/1071636>

[gerritbot](/p/gerritbot/) added a comment.[Sep 9 2024, 3:51 PM2024-09-09 15:51:38 (UTC+0)](#10130641)Comment Actions

Change #1071636 **merged** by jenkins-bot:

[mediawiki/skins/apex@REL1\_42] SECURITY: Escape MediaWiki:Sidebar before rendering

<https://gerrit.wikimedia.org/r/1071636>

[Mstyles](/p/Mstyles/) renamed this task from Stored XSS through sidebar in Apex skin to CVE-2024-47840: Stored XSS through sidebar in Apex skin.[Oct 5 2024, 12:53 AM2024-10-05 00:53:58 (UTC+0)](#10204311)[Mstyles](/p/Mstyles/) closed this task as Resolved.[Mstyles](/p/Mstyles/) claimed this task.[Mstyles](/p/Mstyles/) changed the visibility from "[Custom Policy](/transactions/old/PHID-XACT-TASK-7s4l5tpsue6aibh/)" to "Public (No Login Required)".[Mstyles](/p/Mstyles/) changed the edit policy from "[Custom Policy](/transactions/old/PHID-XACT-TASK-47ymwleqp3kk3tu/)" to "All Users".Content licensed under Creative Commons Attribution-ShareAlike (CC BY-SA) 4.0 unless otherwise noted; code licensed under GNU General Public License (GPL) 2.0 or later and other open source licenses. By using this site, you agree to the Terms of Use, Privacy Policy, and Code of Conduct. Â· [Wikimedia Foundation](https://wikimediafoundation.org/) Â· [Privacy Policy](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ANon-wiki_privacy_policy) Â· [Code of Conduct](https://www.mediawiki.org/wiki/Special%3AMyLanguage/Code_of_Conduct) Â· [Terms of Use](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ATerms_of_Use/Phabricator) Â· [Disclaimer](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3AGeneral_disclaimer) Â· [CC-BY-SA](https://creativecommons.org/licenses/by-sa/4.0/) Â· [GPL](https://www.gnu.org/licenses/old-licenses/gpl-2.0.html) Â· [Credits](https://www.mediawiki.org/wiki/Phabricator/Credits)

=== Content from gerrit.wikimedia.org_724197c8_20250111_190615.html ===



