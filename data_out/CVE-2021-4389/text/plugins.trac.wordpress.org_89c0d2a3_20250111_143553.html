

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F2477827%2Fwp-travel%2Ftags%2F4.4.7%2Finc%2Fadmin%2Fclass-admin-metaboxes.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/2474364/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php "Changeset 2474364 for wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php")
* [Next Change](/changeset/2479311/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php "Changeset 2479311 for wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php") →

---

# Changeset [2477827](/changeset/2477827 "Show full changeset") for [wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2477827 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
02/19/2021 04:00:51 PM
([4 years](/timeline?from=2021-02-19T16%3A00%3A51Z&precision=second "See timeline at 02/19/2021 04:00:51 PM") ago)

Author:
wptravel
Message:

New Changes !!

File:

1 edited

* [wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2477827 "Show entry in browser")
  (modified)
  ([25 diffs](#file0 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php](/changeset/2477827/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php "Show the changeset 2477827 restricted to wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php")

  | [r2474364](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2474364#L141 "Show revision 2474364 of this file in browser") | [r2477827](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2477827#L141 "Show revision 2477827 of this file in browser") |  |
  | --- | --- | --- |
  | 141 | 141 | \*/ |
  | 142 | 142 | public function register\_metaboxes() { |
  | 143 |  | $settings        = wp~~\_~~travel\_get\_settings(); |
  |  | 143 | $settings        = wptravel\_get\_settings(); |
  | 144 | 144 | $switch\_to\_react = $settings['wp\_travel\_switch\_to\_react']; |
  | 145 | 145 | if ( 'no' === $switch\_to\_react ) { |
  | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2474364#L147) | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2477827#L147) |  |
  | 147 | 147 | remove\_meta\_box( 'travel\_locationsdiv', WP\_TRAVEL\_POST\_TYPE, 'side' ); |
  | 148 | 148 | } |
  | 149 |  | add\_meta\_box( 'wp-travel-itinerary-payment-detail', \_\_( 'Payment Detail', 'wp-travel' ), array( $this, 'wp~~\_~~travel\_payment\_info' ), 'itinerary-booking', 'normal', 'low' ); |
  | 150 |  | add\_meta\_box( 'wp-travel-itinerary-single-payment-detail', \_\_( 'Payment Info', 'wp-travel' ), array( $this, 'wp~~\_~~travel\_single\_payment\_info' ), 'itinerary-booking', 'side', 'low' ); |
  |  | 149 | add\_meta\_box( 'wp-travel-itinerary-payment-detail', \_\_( 'Payment Detail', 'wp-travel' ), array( $this, 'wptravel\_payment\_info' ), 'itinerary-booking', 'normal', 'low' ); |
  |  | 150 | add\_meta\_box( 'wp-travel-itinerary-single-payment-detail', \_\_( 'Payment Info', 'wp-travel' ), array( $this, 'wptravel\_single\_payment\_info' ), 'itinerary-booking', 'side', 'low' ); |
  | 151 | 151 |  |
  | 152 | 152 | global $post; |
  | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2474364#L162) | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2477827#L162) |  |
  | 162 | 162 | \* @return void |
  | 163 | 163 | \*/ |
  | 164 |  | public function wp~~\_~~travel\_payment\_info( $post ) { |
  |  | 164 | public function wptravel\_payment\_info( $post ) { |
  | 165 | 165 | if ( ! $post ) { |
  | 166 | 166 | return; |
  | 167 | 167 | } |
  | 168 | 168 | $booking\_id   = $post->ID; |
  | 169 |  | $payment\_data = wp~~\_~~travel\_payment\_data( $booking\_id ); |
  |  | 169 | $payment\_data = wptravel\_payment\_data( $booking\_id ); |
  | 170 | 170 |  |
  | 171 | 171 | if ( $payment\_data && count( $payment\_data ) > 0 ) { |
  | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2474364#L201) | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2477827#L201) |  |
  | 201 | 201 | if ( count( $description ) > 0 ) { |
  | 202 | 202 | echo '<pre>'; |
  | 203 |  | print\_r( $description ); |
  |  | 203 | print\_r( $description ); // @phpcs:ignore |
  | 204 | 204 | echo '</pre>'; |
  | 205 | 205 | } |
  | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2474364#L227) | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2477827#L227) |  |
  | 227 | 227 | \* @return void |
  | 228 | 228 | \*/ |
  | 229 |  | public function wp~~\_~~travel\_single\_payment\_info( $post ) { |
  |  | 229 | public function wptravel\_single\_payment\_info( $post ) { |
  | 230 | 230 | if ( ! $post ) { |
  | 231 | 231 | return; |
  | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2474364#L234) | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2477827#L234) |  |
  | 234 | 234 |  |
  | 235 | 235 | $payment\_id = get\_post\_meta( $booking\_id, 'wp\_travel\_payment\_id', true ); |
  | 236 |  | $payment\_id = wp~~\_~~travel\_get\_payment\_id( $booking\_id ); |
  |  | 236 | $payment\_id = wptravel\_get\_payment\_id( $booking\_id ); |
  | 237 | 237 | if ( ! $payment\_id ) { |
  | 238 | 238 | $title      = 'Payment - #' . $booking\_id; |
  | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2474364#L247) | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2477827#L247) |  |
  | 247 | 247 | update\_post\_meta( $booking\_id, 'wp\_travel\_payment\_id', $payment\_id ); |
  | 248 | 248 | } |
  | 249 |  | $status = wp~~\_~~travel\_get\_payment\_status(); |
  | 250 |  |  |
  | 251 |  | $details        = wp~~\_~~travel\_booking\_data( $booking\_id ); |
  |  | 249 | $status = wptravel\_get\_payment\_status(); |
  |  | 250 |  |
  |  | 251 | $details        = wptravel\_booking\_data( $booking\_id ); |
  | 252 | 252 | $payment\_status = $details['payment\_status']; |
  | 253 | 253 | ?> |
  | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2474364#L278) | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2477827#L278) |  |
  | 278 | 278 | <tr> |
  | 279 | 279 | <td><strong><?php esc\_html\_e( 'Total Price', 'wp-travel' ); ?></strong></td> |
  | 280 |  | <td><?php echo wp~~\_travel\_get\_formated\_price\_currency( $total\_price );~~ ?></td> |
  |  | 280 | <td><?php echo wptravel\_get\_formated\_price\_currency( $total\_price ); //phpcs:ignore ?></td> |
  | 281 | 281 | </tr> |
  | 282 | 282 | <tr> |
  | 283 | 283 | <td><strong><?php esc\_html\_e( 'Paid Amount', 'wp-travel' ); ?></strong></td> |
  | 284 |  | <td><?php echo wp~~\_travel\_get\_formated\_price\_currency( $paid\_amount );~~ ?></td> |
  |  | 284 | <td><?php echo wptravel\_get\_formated\_price\_currency( $paid\_amount ); //phpcs:ignore ?></td> |
  | 285 | 285 | </tr> |
  | 286 | 286 | <tr> |
  | 287 | 287 | <td><strong><?php esc\_html\_e( 'Due Amount', 'wp-travel' ); ?></strong></td> |
  | 288 |  | <td><?php echo wp~~\_travel\_get\_formated\_price\_currency( $due\_amount );~~ ?></td> |
  |  | 288 | <td><?php echo wptravel\_get\_formated\_price\_currency( $due\_amount ); //phpcs:ignore ?></td> |
  | 289 | 289 | </tr> |
  | 290 | 290 | <?php endif; ?> |
  | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2474364#L298) | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2477827#L298) |  |
  | 298 | 298 | public function remove\_metaboxs() { |
  | 299 | 299 | remove\_meta\_box( 'postimagediv', WP\_TRAVEL\_POST\_TYPE, 'side' ); |
  | 300 |  | $settings        = wp~~\_~~travel\_get\_settings(); |
  |  | 300 | $settings        = wptravel\_get\_settings(); |
  | 301 | 301 | $switch\_to\_react = $settings['wp\_travel\_switch\_to\_react']; |
  | 302 | 302 | if ( 'yes' !== $switch\_to\_react ) { |
  | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2474364#L347) | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2477827#L347) |  |
  | 347 | 347 | public function load\_tab\_template( $post ) { |
  | 348 | 348 | $args['post'] = $post; |
  | 349 |  | WP~~\_~~Travel()->tabs->load( self::$post\_type, $args ); |
  |  | 349 | WPTravel()->tabs->load( self::$post\_type, $args ); |
  | 350 | 350 | } |
  | 351 | 351 |  |
  | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2474364#L355) | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2477827#L355) |  |
  | 355 | 355 | \* @param  Object $post Post object. |
  | 356 | 356 | \*/ |
  | 357 |  | public function wp~~\_~~travel\_trip\_info( $post ) { |
  |  | 357 | public function wptravel\_trip\_info( $post ) { |
  | 358 | 358 | if ( ! $post ) { |
  | 359 | 359 | return; |
  | 360 | 360 | } |
  | 361 |  | $trip\_code = wp~~\_~~travel\_get\_trip\_code( $post->ID ); |
  |  | 361 | $trip\_code = wptravel\_get\_trip\_code( $post->ID ); |
  | 362 | 362 | ?> |
  | 363 | 363 | <table class="form-table trip-info-sidebar"> |
  | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2474364#L377) | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2477827#L377) |  |
  | 377 | 377 | 'link2\_label' => \_\_( 'Get WP Travel Utilities Addon', 'wp-travel' ), |
  | 378 | 378 | ); |
  | 379 |  | wp~~\_~~travel\_upsell\_message( $args ); |
  |  | 379 | wptravel\_upsell\_message( $args ); |
  | 380 | 380 | endif; |
  | 381 | 381 | } |
  | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2474364#L392) | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2477827#L392) |  |
  | 392 | 392 | return; |
  | 393 | 393 | } |
  | 394 |  | if ( ! wp\_verify\_nonce( ~~$\_POST['wp\_travel\_save\_data']~~, 'wp\_travel\_save\_data\_process' ) ) { |
  |  | 394 | if ( ! wp\_verify\_nonce( sanitize\_text\_field( wp\_unslash( $\_POST['wp\_travel\_save\_data'] ) ), 'wp\_travel\_save\_data\_process' ) ) { |
  | 395 | 395 | return; |
  | 396 | 396 | } |
  | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2474364#L407) | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2477827#L407) |  |
  | 407 | 407 | } |
  | 408 | 408 |  |
  | 409 |  | $settings     = wp~~\_~~travel\_get\_settings(); |
  |  | 409 | $settings     = wptravel\_get\_settings(); |
  | 410 | 410 | $switch\_to\_v4 = $settings['wp\_travel\_switch\_to\_react']; |
  | 411 | 411 | if ( 'yes' === $switch\_to\_v4 ) { |
  | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2474364#L466) | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2477827#L466) |  |
  | 466 | 466 |  |
  | 467 | 467 | // Setting trip price. |
  | 468 |  | $trip\_meta['wp~~\_~~travel\_trip\_price'] = $trip\_meta['wp\_travel\_price']; // This price is used to sort archive list by price so need to update accordingly [ for single and multiple pricing option ] |
  |  | 468 | $trip\_meta['wptravel\_trip\_price'] = $trip\_meta['wp\_travel\_price']; // This price is used to sort archive list by price so need to update accordingly [ for single and multiple pricing option ] |
  | 469 | 469 |  |
  | 470 | 470 | $trip\_meta['wp\_travel\_enable\_sale'] = isset( $\_POST['wp\_travel\_enable\_sale'] ) ? sanitize\_text\_field( wp\_unslash( $\_POST['wp\_travel\_enable\_sale'] ) ) : 0; |
  | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2474364#L472) | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2477827#L472) |  |
  | 472 | 472 | if ( $trip\_meta['wp\_travel\_sale\_price'] ) { |
  | 473 | 473 | // Update trip price. |
  | 474 |  | $trip\_meta['wp~~\_~~travel\_trip\_price'] = $trip\_meta['wp\_travel\_sale\_price']; |
  |  | 474 | $trip\_meta['wptravel\_trip\_price'] = $trip\_meta['wp\_travel\_sale\_price']; |
  | 475 | 475 | } |
  | 476 | 476 |  |
  | 477 | 477 | $trip\_meta['wp\_travel\_price\_per']           = isset( $\_POST['wp\_travel\_price\_per'] ) ? sanitize\_text\_field( wp\_unslash( $\_POST['wp\_travel\_price\_per'] ) ) : ''; |
  | 478 | 478 | $trip\_meta['wp\_travel\_group\_size']          = isset( $\_POST['wp\_travel\_group\_size'] ) ? sanitize\_text\_field( wp\_unslash( $\_POST['wp\_travel\_group\_size'] ) ) : ''; |
  | 479 |  | $trip\_meta['wp\_travel\_trip\_include']        = isset( $\_POST['wp\_travel\_trip\_include'] ) ? wp\_kses\_post( $\_POST['wp\_travel\_trip\_include'] ) : ''; |
  |  | 479 | $trip\_meta['wp\_travel\_trip\_include']        = isset( $\_POST['wp\_travel\_trip\_include'] ) ? wp\_kses\_post( $\_POST['wp\_travel\_trip\_include'] ) : ''; // For getting html we can't sanitize it. |
  | 480 | 480 | $trip\_meta['wp\_travel\_trip\_exclude']        = isset( $\_POST['wp\_travel\_trip\_exclude'] ) ? wp\_kses\_post( $\_POST['wp\_travel\_trip\_exclude'] ) : ''; |
  | 481 |  | $trip\_meta['wp\_travel\_outline']             = isset( $\_POST['wp\_travel\_outline'] ) ? wp\_kses\_post( $\_POST['wp\_travel\_outline'] ): ''; |
  |  | 481 | $trip\_meta['wp\_travel\_outline']             = isset( $\_POST['wp\_travel\_outline'] ) ? wp\_kses\_post( $\_POST['wp\_travel\_outline'] ) : ''; |
  | 482 | 482 | $trip\_meta['wp\_travel\_start\_date']          = isset( $\_POST['wp\_travel\_start\_date'] ) ? sanitize\_text\_field( $\_POST['wp\_travel\_start\_date'] ) : ''; |
  | 483 | 483 | $trip\_meta['wp\_travel\_end\_date']            = isset( $\_POST['wp\_travel\_end\_date'] ) ? sanitize\_text\_field( $\_POST['wp\_travel\_end\_date'] ): ''; |
  | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2474364#L509) | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2477827#L509) |  |
  | 509 | 509 | // Saving Tabs Settings. |
  | 510 | 510 | $trip\_meta['wp\_travel\_use\_global\_tabs'] = isset( $\_POST['wp\_travel\_use\_global\_tabs'] ) ? sanitize\_text\_field( wp\_unslash( $\_POST['wp\_travel\_use\_global\_tabs'] ) ) : 'yes'; |
  | 511 |  | $trip\_meta['wp\_travel\_tabs']            = isset( $\_POST['wp\_travel\_tabs'] ) ? wp~~\_~~travel\_sanitize\_array( wp\_unslash( $\_POST['wp\_travel\_tabs'] ) ) : array(); |
  |  | 511 | $trip\_meta['wp\_travel\_tabs']            = isset( $\_POST['wp\_travel\_tabs'] ) ? wptravel\_sanitize\_array( wp\_unslash( $\_POST['wp\_travel\_tabs'] ) ) : array(); |
  | 512 | 512 | // Trip enquiry Global. |
  | 513 | 513 | $trip\_meta['wp\_travel\_use\_global\_trip\_enquiry\_option'] = isset( $\_POST['wp\_travel\_use\_global\_trip\_enquiry\_option'] ) ? sanitize\_text\_field( wp\_unslash( $\_POST['wp\_travel\_use\_global\_trip\_enquiry\_option'] ) ) : 'yes'; |
  | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2474364#L515) | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2477827#L515) |  |
  | 515 | 515 | $trip\_meta['wp\_travel\_enable\_trip\_enquiry\_option'] = isset( $\_POST['wp\_travel\_enable\_trip\_enquiry\_option'] ) ? sanitize\_text\_field( wp\_unslash( $\_POST['wp\_travel\_enable\_trip\_enquiry\_option'] ) ) : 'no'; |
  | 516 | 516 |  |
  | 517 |  | $trip\_meta['wp\_travel\_faq\_question']  = isset( $\_POST['wp\_travel\_faq\_question'] ) ? wp~~\_~~travel\_sanitize\_array( wp\_unslash( $\_POST['wp\_travel\_faq\_question'] ) ) : array(); |
  | 518 |  | $trip\_meta['wp\_travel\_faq\_answer']    = isset( $\_POST['wp\_travel\_faq\_answer'] ) ? wp~~\_~~travel\_sanitize\_array( wp\_unslash( $\_POST['wp\_travel\_faq\_answer'] ) ) : array(); |
  | 519 |  | $trip\_meta['wp\_travel\_is\_global\_faq'] = isset( $\_POST['wp\_travel\_is\_global\_faq'] ) ? wp~~\_~~travel\_sanitize\_array( wp\_unslash( $\_POST['wp\_travel\_is\_global\_faq'] ) ) : array(); // fixes issue with is global faq values not updating when disabling pro. |
  |  | 517 | $trip\_meta['wp\_travel\_faq\_question']  = isset( $\_POST['wp\_travel\_faq\_question'] ) ? wptravel\_sanitize\_array( wp\_unslash( $\_POST['wp\_travel\_faq\_question'] ) ) : array(); |
  |  | 518 | $trip\_meta['wp\_travel\_faq\_answer']    = isset( $\_POST['wp\_travel\_faq\_answer'] ) ? wptravel\_sanitize\_array( wp\_unslash( $\_POST['wp\_travel\_faq\_answer'] ) ) : array(); |
  |  | 519 | $trip\_meta['wp\_travel\_is\_global\_faq'] = isset( $\_POST['wp\_travel\_is\_global\_faq'] ) ? wptravel\_sanitize\_array( wp\_unslash( $\_POST['wp\_travel\_is\_global\_faq'] ) ) : array(); // fixes issue with is global faq values not updating when disabling pro. |
  | 520 | 520 |  |
  | 521 | 521 | // WP Travel Standard Paypal Merged. @since 1.2.1. |
  | 522 |  | $trip\_meta['wp~~\_travel\_minimum\_partial\_payout']            = isset( $\_POST['wp\_travel\_minimum\_partial\_payout'] ) ? wp\_travel\_sanitize\_array( wp\_unslash( $\_POST['wp\_~~travel\_minimum\_partial\_payout'] ) ) : 0; |
  | 523 |  | $trip\_meta['wp~~\_travel\_minimum\_partial\_payout\_percent']    = isset( $\_POST['wp\_travel\_minimum\_partial\_payout\_percent'] ) ? wp\_travel\_sanitize\_array( wp\_unslash( $\_POST['wp\_~~travel\_minimum\_partial\_payout\_percent'] ) ) : 0; |
  | 524 |  | $trip\_meta['wp~~\_travel\_minimum\_partial\_payout\_use\_global'] = isset( $\_POST['wp\_travel\_minimum\_partial\_payout\_use\_global'] ) ? sanitize\_text\_field( wp\_unslash( $\_POST['wp\_~~travel\_minimum\_partial\_payout\_use\_global'] ) ) : ''; |
  |  | 522 | $trip\_meta['wptravel\_minimum\_partial\_payout']            = isset( $\_POST['wptravel\_minimum\_partial\_payout'] ) ? wptravel\_sanitize\_array( wp\_unslash( $\_POST['wptravel\_minimum\_partial\_payout'] ) ) : 0; |
  |  | 523 | $trip\_meta['wptravel\_minimum\_partial\_payout\_percent']    = isset( $\_POST['wptravel\_minimum\_partial\_payout\_percent'] ) ? wptravel\_sanitize\_array( wp\_unslash( $\_POST['wptravel\_minimum\_partial\_payout\_percent'] ) ) : 0; |
  |  | 524 | $trip\_meta['wptravel\_minimum\_partial\_payout\_use\_global'] = isset( $\_POST['wptravel\_minimum\_partial\_payout\_use\_global'] ) ? sanitize\_text\_field( wp\_unslash( $\_POST['wptravel\_minimum\_partial\_payout\_use\_global'] ) ) : ''; |
  | 525 | 525 |  |
  | 526 | 526 | // Update Pricing Options Metas. [ Multiple Pricing data ]. |
  | 527 |  | $trip\_meta['wp\_travel\_pricing\_options'] = isset( $\_POST['wp\_travel\_pricing\_options'] ) ? wp~~\_~~travel\_sanitize\_array( wp\_unslash( $\_POST['wp\_travel\_pricing\_options'] ) ) : ''; |
  |  | 527 | $trip\_meta['wp\_travel\_pricing\_options'] = isset( $\_POST['wp\_travel\_pricing\_options'] ) ? wptravel\_sanitize\_array( wp\_unslash( $\_POST['wp\_travel\_pricing\_options'] ) ) : ''; |
  | 528 | 528 |  |
  | 529 | 529 | if ( 'multiple-price' === $trip\_meta['wp\_travel\_pricing\_option\_type'] && is\_array( $trip\_meta['wp\_travel\_pricing\_options'] ) && count( $trip\_meta['wp\_travel\_pricing\_options'] ) > 0 ) { |
  | 530 |  | // Need to update post meta wp~~\_~~travel\_trip\_price which is used to filter by price in archive page. |
  |  | 530 | // Need to update post meta wptravel\_trip\_price which is used to filter by price in archive page. |
  | 531 | 531 | $args = array( |
  | 532 | 532 | 'trip\_id' => $trip\_id, |
  | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2474364#L534) | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2477827#L534) |  |
  | 534 | 534 | $price = WP\_Travel\_Helpers\_Pricings::get\_price( $args ); |
  | 535 | 535 | if ( $price ) { |
  | 536 |  | $trip\_meta['wp~~\_~~travel\_trip\_price'] = $price; |
  |  | 536 | $trip\_meta['wptravel\_trip\_price'] = $price; |
  | 537 | 537 | } |
  | 538 | 538 | } |
  | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2474364#L540) | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2477827#L540) |  |
  | 540 | 540 | // Update multiple trip dates options. |
  | 541 | 541 | $wp\_travel\_multiple\_trip\_dates = array(); |
  | 542 |  | $trip\_dates                    = array(); // List all the trip dates. Need to filter redundant date below.  @since 3.0.5 |
  |  | 542 | $trip\_dates                    = array(); // List all the trip dates. Need to filter redundant date below.  @since 3.0.5. |
  | 543 | 543 | if ( isset( $\_POST['wp\_travel\_multiple\_trip\_dates'] ) ) { |
  | 544 |  | $wp\_travel\_multiple\_trip\_dates = wp~~\_~~travel\_sanitize\_array( wp\_unslash( $\_POST['wp\_travel\_multiple\_trip\_dates'] ) ); |
  |  | 544 | $wp\_travel\_multiple\_trip\_dates = wptravel\_sanitize\_array( wp\_unslash( $\_POST['wp\_travel\_multiple\_trip\_dates'] ) ); |
  | 545 | 545 |  |
  | 546 | 546 | foreach ( $wp\_travel\_multiple\_trip\_dates as $date\_key => $date\_value ) { |
  | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2474364#L548) | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2477827#L548) |  |
  | 548 | 548 | if ( isset( $date\_value['start\_date'] ) && '' !== $date\_value['start\_date'] ) { |
  | 549 | 549 | $start\_date = $date\_value['start\_date']; |
  | 550 |  | if ( ! wp~~\_~~travel\_is\_ymd\_date( $start\_date ) ) { |
  | 551 |  | $start\_date = wp~~\_~~travel\_format\_ymd\_date( $start\_date, $date\_format ); |
  |  | 550 | if ( ! wptravel\_is\_ymd\_date( $start\_date ) ) { |
  |  | 551 | $start\_date = wptravel\_format\_ymd\_date( $start\_date, $date\_format ); |
  | 552 | 552 | } |
  | 553 | 553 |  |
  | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2474364#L557) | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2477827#L557) |  |
  | 557 | 557 | if ( isset( $date\_value['end\_date'] ) && '' !== $date\_value['end\_date'] ) { |
  | 558 | 558 | $end\_date = $date\_value['end\_date']; |
  | 559 |  | if ( ! wp~~\_~~travel\_is\_ymd\_date( $end\_date ) ) { |
  | 560 |  | $end\_date = wp~~\_~~travel\_format\_ymd\_date( $end\_date, $date\_format ); |
  |  | 559 | if ( ! wptravel\_is\_ymd\_date( $end\_date ) ) { |
  |  | 560 | $end\_date = wptravel\_format\_ymd\_date( $end\_date, $date\_format ); |
  | 561 | 561 | } |
  | 562 | 562 | $wp\_travel\_multiple\_trip\_dates[ $date\_key ]['end\_date'] = $end\_date; |
  | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2474364#L566) | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2477827#L566) |  |
  | 566 | 566 | $wp\_travel\_multiple\_trip\_dates = ( wp\_unslash( $wp\_travel\_multiple\_trip\_dates ) ); |
  | 567 | 567 | $trip\_dates                    = wp\_unslash( array\_unique( $trip\_dates ) ); // Filter unique date. |
  | 568 |  | $trip\_dates                    = wp~~\_~~travel\_filter\_expired\_date( $trip\_dates ); |
  | 569 |  | usort( $trip\_dates, 'wp~~\_~~travel\_date\_sort' ); |
  |  | 568 | $trip\_dates                    = wptravel\_filter\_expired\_date( $trip\_dates ); |
  |  | 569 | usort( $trip\_dates, 'wptravel\_date\_sort' ); |
  | 570 | 570 |  |
  | 571 | 571 | $trip\_meta['trip\_dates'] = $trip\_dates; |
  | 572 | 572 |  |
  | 573 | 573 | if ( is\_array( $trip\_dates ) && isset( $trip\_dates[0] ) ) { |
  | 574 |  | $trip\_meta['trip\_date'] = $trip\_dates[0]; // Use it in sorting according to trip dates. @since 3.0.5 |
  |  | 574 | $trip\_meta['trip\_date'] = $trip\_dates[0]; // Use it in sorting according to trip dates. @since 3.0.5. |
  | 575 | 575 | } |
  | 576 | 576 | } |
  | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2474364#L583) | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2477827#L583) |  |
  | 583 | 583 | $wp\_travel\_trip\_facts = array(); |
  | 584 | 584 | if ( isset( $\_POST['wp\_travel\_trip\_facts'] ) ) { |
  | 585 |  | $wp\_travel\_trip\_facts = array\_filter( array\_filter( array\_values( wp~~\_~~travel\_sanitize\_array( $\_POST['wp\_travel\_trip\_facts'] ) ), 'array\_filter' ), 'count' ); |
  |  | 585 | $wp\_travel\_trip\_facts = array\_filter( array\_filter( array\_values( wptravel\_sanitize\_array( $\_POST['wp\_travel\_trip\_facts'] ) ), 'array\_filter' ), 'count' ); |
  | 586 | 586 | } |
  | 587 | 587 | $trip\_meta['wp\_travel\_trip\_facts'] = $wp\_travel\_trip\_facts; |
  | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2474364#L589) | […](/browser/wp-travel/tags/4.4.7/inc/admin/class-admin-metaboxes.php?rev=2477827#L589) |  |
  | 589 | 589 | $wp\_travel\_tour\_extras = array(); |
  | 590 | 590 | if ( isset( $\_POST['wp\_travel\_tour\_extras'] ) ) { |
  | 591 |  | $wp\_travel\_tour\_extras = stripslashes\_deep( wp~~\_~~travel\_sanitize\_array( $\_POST['wp\_travel\_tour\_extras'] ) ); |
  |  | 591 | $wp\_travel\_tour\_extras = stripslashes\_deep( wptravel\_sanitize\_array( $\_POST['wp\_travel\_tour\_extras'] ) ); |
  | 592 | 592 | } |
  | 593 | 593 | $trip\_meta['wp\_travel\_tour\_extras'] = $wp\_travel\_tour\_extras; |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=2477827)
* [Zip Archive](?format=zip&new=2477827)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

