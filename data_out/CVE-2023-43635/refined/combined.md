=== Content from asrg.io_95c56bf3_20250111_173419.html ===

[Skip to content](#content)
[![](https://asrg.io/wp-content/uploads/2022/07/ASRG-Logo-black.svg)](https://asrg.io)

* [Engage](https://asrg.io/about-us/)
  + [History](https://asrg.io/about-us/#history)
  + [Membership](https://asrg.io/members/)
  + [Sponsorship](https://asrg.io/sponsors/)
  + [ASRG Women](https://asrg.io/asrg-women/)
  + [Academia](https://asrg.io/asrg-academia/)
  + [Team](https://asrg.io/about-us/#team)
  + [Strategy](https://asrg.io/about-us/#strategy)
  + [Press](https://asrg.io/category/press/)
* [Knowledge](https://asrg.io/knowledge/)
* [Networking](https://asrg.io/networking/)
* [Collaboration](https://asrg.io/collaboration/)
* [AutoVulnDB](https://asrg.io/autovulndb/)
* [Disclosure](https://asrg.io/disclosure/)
* [Contact Us](https://asrg.io/contact-us/)

 Menu

* [Engage](https://asrg.io/about-us/)
  + [History](https://asrg.io/about-us/#history)
  + [Membership](https://asrg.io/members/)
  + [Sponsorship](https://asrg.io/sponsors/)
  + [ASRG Women](https://asrg.io/asrg-women/)
  + [Academia](https://asrg.io/asrg-academia/)
  + [Team](https://asrg.io/about-us/#team)
  + [Strategy](https://asrg.io/about-us/#strategy)
  + [Press](https://asrg.io/category/press/)
* [Knowledge](https://asrg.io/knowledge/)
* [Networking](https://asrg.io/networking/)
* [Collaboration](https://asrg.io/collaboration/)
* [AutoVulnDB](https://asrg.io/autovulndb/)
* [Disclosure](https://asrg.io/disclosure/)
* [Contact Us](https://asrg.io/contact-us/)

[Login/Register](https://garage.asrg.io/)

# [Vault Key Sealed With SHA1 PCRs](https://nvd.nist.gov/vuln/detail/CVE-2023-43635)

## CVE ID

### CVE-2023-43635

## Description

The measured boot solution implemented in EVE OS leans on a PCR locking mechanism.
Different parts of the system update different PCR values in the TPM, resulting in a unique value for each PCR entry.
These PCRs are then used in order to seal/unseal a key from the TPM which is used to encrypt/decrypt the “vault” directory.
This “vault” directory is the most sensitive point in the system and as such, its content should be protected.
This mechanism is noted in Zededa’s documentation as the “measured boot” mechanism, designed to protect said “vault”.
The code that’s responsible for generating and fetching the key from the TPM assumes that SHA256 PCRs are used in order to seal/unseal the key, and as such their presence is being checked.
The issue here is that the key is not sealed using SHA256 PCRs, but using SHA1 PCRs.
This leads to several issues:
•Machines that have their SHA256 PCRs enabled but SHA1 PCRs disabled, as well as not sealing their keys at all, meaning the “vault” is not protected from an attacker.
•SHA1 is considered insecure and reduces the complexity level required to unseal the key in machines which have their SHA1 PCRs enabled.

## Refereneces

[Ilay Levi](https://www.linkedin.com/in/ilay-levi/)

## Problem Type

### CWE-328 Use of Weak Hash, CWE-522 Insufficiently Protected Credentials

## CAPEC ID

### CAPEC-115 Authentication Bypass

## Affected Products

EVE OS

## CVSS3.1 Score

8.8 CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H

[![](https://asrg.io/wp-content/uploads/2022/07/ASRG-Logo-black.svg)](https://asrg.io)

Automotive Security. Community Driven.

[Facebook-f](https://www.facebook.com/ASRG-Automotive-Security-Research-Group-1454803571254832/)

[Youtube](https://www.youtube.com/c/AutomotiveSecurityResearchGroup)

[Linkedin-in](https://www.linkedin.com/company/automotive-security-research-group/)

[Github](https://github.com/ASRG)

## Get Started

* [Knowledge](https://asrg.io/knowledge/)
* [Academia](https://asrg.io/academia/)
* [Networking](https://asrg.io/networking/)
* Collaboration
* [Sponsors](https://asrg.io/sponsors/)
* [Members](https://asrg.io/members)

## About

* [About Us](https://asrg.io/about-us/)
* [History](https://asrg.io/about-us/#history)
* [Our Team](https://asrg.io/about-us/#team)
* [Our Strategy](https://asrg.io/about-us/#strategy)

## Legal

* [Terms and Conditions](https://asrg.io/terms-of-use/)
* [Privacy Policy](https://asrg.io/privacy-policy/)

## Get in Touch

* [Contact Us](https://asrg.io/contact-us/)
* [[email protected]](/cdn-cgi/l/email-protection)

### 2025 ASRG | All rights reserved


