=== Content from go.dev_387daab5_20250111_184635.html ===




=== Content from security.netapp.com_a8dc6d89_20250111_184638.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
√¶¬ó¬•√¶¬ú¬¨√®¬™¬û

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [CVE-2024-24791 Golang Vulnerability in NetApp Products](https://security.netapp.com/advisory/ntap-20241004-0004)

## CVE-2024-24791 Golang Vulnerability in NetApp Products

circle-info

NetApp will continue to update this advisory as additional information becomes available.

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close √ó

#### Subscribe to NTAP-20241004-0004 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20241004-0004 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close √ó

#### Unsubscribe from NTAP-20241004-0004 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20241004-0004 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20241004-0004
**Version:**
2.0

**Last updated:**
10/14/2024

**Status:**
Interim.

**CVEs:** CVE-2024-24791

Overview
#### Summary

Multiple NetApp products incorporate Golang. Golang versions prior to 1.21.12 and 1.22.0-0 prior to 1.22.5 are susceptible to a vulnerability which when successfully exploited could lead to Denial of Service (DoS).

#### Impact

Successful exploitation of this vulnerability could lead to Denial of Service (DoS).

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2024-24791](https://nvd.nist.gov/vuln/detail/CVE-2024-24791) | 5.3 (MEDIUM) | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

#### References

* <https://pkg.go.dev/vuln/GO-2024-2963>

Affected Products
#### Affected Products

* Astra Control Provisioner
* Astra Trident
* Astra Trident Autosupport

#### Products Under Investigation

* ONTAP tools for VMware vSphere 10

#### Products Not Affected

* AFF BIOS - A1K/A70/A90
* AFF BIOS - A700s
* AFF Baseboard Management Controller (BMC) - A1K/A70/A90
* AFF Baseboard Management Controller (BMC) - A700s
* AFF LOADER- A1K/A70/A90
* ATTO FibreBridge - 7500N
* ATTO FibreBridge - 7600N
* Active IQ Unified Manager for Linux
* Active IQ Unified Manager for Microsoft Windows
* Active IQ Unified Manager for VMware vSphere
* Active IQ mobile app
* Astra Control Center
* Astra Control Center - NetApp Kubernetes Monitoring Operator
* BlueXP Classification
* Brocade Fabric Operating System Firmware
* Brocade SAN Navigator (SANnav)
* Cloud Volumes ONTAP Mediator
* Data Infrastructure Insights Acquisition Unit (formerly Cloud Insights Acquisition Unit)
* Data Infrastructure Insights Storage Workload Security Agent (formerly Cloud Insights Storage Workload Security Agent)
* Data Infrastructure Insights Telegraf Agent (formerly Cloud Insights Telegraf Agent)
* E-Series BIOS
* E-Series SANtricity OS Controller Software 11.x
* E-Series SANtricity Unified Manager and Web Services Proxy
* Element .NET SDK
* Element HealthTools
* Element JAVA SDK
* Element Plug-in for vCenter Server
* Element Powershell Tools
* Element Python SDK
* FAS/AFF BIOS - 2820
* FAS/AFF BIOS - 8300/8700/A400/C400
* FAS/AFF BIOS - A250/500f/C250
* FAS/AFF BIOS - A300/8200/C190/A220/2720/2750/A150
* FAS/AFF BIOS - A320
* FAS/AFF BIOS - A700/9000
* FAS/AFF BIOS - A800/C800
* FAS/AFF BIOS - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400/C400
* FAS/AFF Baseboard Management Controller (BMC) - A250/500f/C250
* FAS/AFF Baseboard Management Controller (BMC) - A320
* FAS/AFF Baseboard Management Controller (BMC) - A800/C800
* FAS/AFF Baseboard Management Controller (BMC) - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - C190/A150/A220/FAS2720/FAS2750
* FAS/AFF Baseboard Management Controller (BMC) - FAS2820
* FAS/AFF Service Processor - A300/8200
* FAS/AFF Service Processor - A700/9000
* Global File Cache
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* IOM12 SAS Disk Shelf Firmware
* IOM12B SAS Disk Shelf Firmware
* IOM12E SAS Disk Shelf Firmware
* IOM12F SAS Disk Shelf Firmware
* IOM12G SAS Disk Shelf Firmware
* IOM6 SAS Disk Shelf Firmware
* IOM6E SAS Disk Shelf Firmware
* Management Services for Element Software and NetApp HCI
* MetroCluster DataCollector
* MetroCluster Tiebreaker
* Multipath I/O (SANtricity DSM for Windows MPIO)
* NetApp BlueXP
* NetApp Converged Systems Advisor Agent
* NetApp DataOps Toolkit
* NetApp E-Series Host Collection
* NetApp E-Series SANtricity Collection
* NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S
* NetApp HCI Baseboard Management Controller (BMC) - H410C
* NetApp HCI Baseboard Management Controller (BMC) - H610C
* NetApp HCI Baseboard Management Controller (BMC) - H610S
* NetApp HCI Baseboard Management Controller (BMC) - H615C
* NetApp HCI Compute Node (Bootstrap OS)
* NetApp HCI Compute Node BIOS
* NetApp HCI Storage Node BIOS
* NetApp Kubernetes Monitoring Operator
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp ONTAP PowerShell Toolkit (PSTK)
* NetApp SolidFire & HCI Management Node
* NetApp SolidFire & HCI Storage Node (Element Software)
* NetApp SolidFire Plug-in for vRealize Orchestrator (SolidFire vRO)
* NetApp XCP NFS
* NetApp XCP SMB
* ONTAP 9 (formerly Clustered Data ONTAP)
* ONTAP Antivirus Connector
* ONTAP Mediator
* ONTAP Select Deploy administration utility
* ONTAP tools for VMware vSphere 9
* OnCommand Insight
* OnCommand Workflow Automation
* RcfFileGenerator for MetroCluster IP
* SANtricity Storage Plugin for vCenter
* SRA Plugin for Linux
* SRA Plugin for Windows
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapCenter Plug-in for VMware vSphere/BlueXP backup and Recovery for Virtual Machine
* SnapGathers
* SnapManager for Hyper-V
* SolidFire Storage Replication Adapter
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID BIOS SG1000/SG100/SG1100/SG110
* StorageGRID BIOS SG5660/SG5612/SG5760/SG5712
* StorageGRID BIOS SG5812/SG5860
* StorageGRID BIOS SG6060/SGF6024/SGF6112/SG6160
* StorageGRID Baseboard Management Controller (BMC) - SG6060/SG6160/SGF6024/SGF6112/SG100/SG110/SG1000/SG1100
* StorageGRID Baseboard Management Controller (BMC) SG5812/SG5860
* System Manager 9.x
* Terraform Provider for ONTAP
* Workload Factory for VMware

Remediation
#### Software Versions and Fixes

NetApp's currently available patches are listed below.

| **Product** | **First Fixed in Release** |
| --- | --- |
| **Astra Trident** | <https://github.com/NetApp/trident/releases/tag/v24.06.1> |
| **Astra Trident Autosupport** | <https://github.com/NetApp/trident/releases/tag/v24.06.1> |

#### Workarounds

None at this time.

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

**Technical Support**

Revision History
#### Status of This Notice

**Interim.**

NetApp will continue to update this advisory as additional information becomes available.

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20241004-0004>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20241004 | Initial Public Release |
| 2.0 | 20241014 | Astra Control Center - NetApp Kubernetes Monitoring Operator moved to Products Not Affected, Astra Trident and Astra Trident Autosupport Added to Software Versions and Fixes, Astra Control Provisioner, Astra Trident, and Astra Trident Autosupport moved to Affected Products |

This document is provided solely for informational purposes. All information is based upon NetApp√¢¬Ä¬ôs current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. √Ç¬© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 ¬©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from groups.google.com_ba5f3f7c_20250111_184637.html ===
[![](https://fonts.gstatic.com/s/i/productlogos/groups/v9/web-48dp/logo_groups_color_1x_web_48dp.png)Groups](./my-groups "Groups")ConversationsAll groups and messagesSend feedback to GoogleHelpTraining[Sign in](https://accounts.google.com/ServiceLogin?hl=en&passive=true&continue=https://groups.google.com&ec=GAZA0AM)[Groups](./my-groups "Groups")
## golang-dev

[Conversations](./g/golang-dev)[About](./g/golang-dev/about)[Privacy](https://policies.google.com/privacy?hl=en_US)¬†‚Ä¢¬†[Terms](https://policies.google.com/terms?hl=en_US)

Groups keyboard shortcuts have been updatedDismissSee shortcutsÓóÑÓ¢ôÓêàÓêâ
# [security] Go 1.22.5 and Go 1.21.12 are released

 1,575 viewsSkip to first unread messageÓ•Ü![anno...@golang.org's profile photo](https://lh3.googleusercontent.com/a/default-user=s40-c)
### anno...@golang.org

unread,Jul 2, 2024, 8:24:15‚ÄØPM7/2/24Ó†∫ÓÖüÓóîReply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto golan...@googlegroups.com

Hello gophers,

We have just released Go versions 1.22.5 and 1.21.12, minor point releases.

These minor releases include 1 security fixes following the [security policy](https://go.dev/security):

* net/http: denial of service due to improper 100-continue handling

  The net/http HTTP/1.1 client mishandled the case where a server responds to a request with an "Expect: 100-continue" header with a non-informational (200 or higher) status. This mishandling could leave a client connection in an invalid state, where the next request sent on the connection will fail.

  An attacker sending a request to a net/http/httputil.ReverseProxy proxy can exploit this mishandling to cause a denial of service by sending "Expect: 100-continue" requests which elicit a non-informational response from the backend. Each such request leaves the proxy with an invalid connection, and causes one subsequent request using that connection to fail.

  Thanks to Geoff Franks for reporting this issue.

  This is CVE-2024-24791 and Go issue <https://go.dev/issue/67555>.

View the release notes for more information:

<https://go.dev/doc/devel/release#go1.22.5>

You can download binary and source distributions from the Go website:

<https://go.dev/dl/>

To compile from source using a Git clone, update to the release with

`git checkout go1.22.5` and build as usual.

Thanks to everyone who contributed to the releases.

Cheers,

Than and Joedian for the Go team

![Florent Poinsard's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXkPQo0UG8RIdz0j5ULLd9vQzYFofc0VWDuA5_IsXeiteV1aGHA=s40-c)
### Florent Poinsard

unread,Jul 3, 2024, 12:06:27‚ÄØAM7/3/24Ó†∫ÓÖüÓóîReply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto golang-devHi,
I am having issues seeing the v1.22.5 and v1.21.12 Docker images on [DockerHub](https://hub.docker.com/_/golang/tags?page=&page_size=&ordering=&name=1.22.5), are the images supposed to be pushed by now or is it normal to expect some delay?
Thank you,
Florent

Óóì![Dmitri Shuralyov's profile photo](//lh3.googleusercontent.com/a-/ALV-UjX2MtRhBWAty6zP1ursGH0ntoSMU6BJi6Lc-blclMUZio0t06c=s40-c)
### Dmitri Shuralyov

unread,Jul 3, 2024, 12:51:44‚ÄØAM7/3/24Ó†∫ÓÖüÓóîReply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto golang-devHi Florent,
The Go team doesn't maintain Docker images on DockerHub. See the "Maintained by" note at the top of¬†<https://hub.docker.com/_/golang>. That page suggests reporting problems at¬†<https://github.com/docker-library/golang/issues>. That said, it seems they've started to show up about 20 minutes after your post.
Thanks,DmitriÓóì![Florent Poinsard's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXkPQo0UG8RIdz0j5ULLd9vQzYFofc0VWDuA5_IsXeiteV1aGHA=s40-c)
### Florent Poinsard

unread,Jul 3, 2024, 1:22:21‚ÄØAM7/3/24Ó†∫ÓÖüÓóîReply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto golang-devGood to know, thank you for the information.
Cheers,
Florent

ÓóìÓÖüReply allÓÖûReply to authorÓÖîForwardÓóï0 new messagesÓóç

=== Content from go.dev_03704096_20250111_184636.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgolang%2Fgo%2Fissues%2F67555)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgolang%2Fgo%2Fissues%2F67555)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=golang%2Fgo)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[golang](/golang)
/
**[go](/golang/go)**
Public

* [Notifications](/login?return_to=%2Fgolang%2Fgo) You must be signed in to change notification settings
* [Fork
  17.8k](/login?return_to=%2Fgolang%2Fgo)
* [Star
   125k](/login?return_to=%2Fgolang%2Fgo)

* [Code](/golang/go)
* [Issues
  5k+](/golang/go/issues)
* [Pull requests
  508](/golang/go/pulls)
* [Discussions](/golang/go/discussions)
* [Actions](/golang/go/actions)
* [Projects
  4](/golang/go/projects)
* [Wiki](/golang/go/wiki)
* [Security](/golang/go/security)
* [Insights](/golang/go/pulse)

Additional navigation options

* [Code](/golang/go)
* [Issues](/golang/go/issues)
* [Pull requests](/golang/go/pulls)
* [Discussions](/golang/go/discussions)
* [Actions](/golang/go/actions)
* [Projects](/golang/go/projects)
* [Wiki](/golang/go/wiki)
* [Security](/golang/go/security)
* [Insights](/golang/go/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fgolang%2Fgo%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fgolang%2Fgo%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# net/http: `expect: 100-continue` handling is broken in various ways #67555

Open

[neild](/neild) opened this issue
May 21, 2024
¬∑ 10 comments

Open

# [net/http: `expect: 100-continue` handling is broken in various ways](#top) #67555

[neild](/neild) opened this issue
May 21, 2024
¬∑ 10 comments

Assignees
[![@neild](https://avatars.githubusercontent.com/u/52544?s=40&v=4)](/neild)

Labels
[NeedsInvestigation](/golang/go/labels/NeedsInvestigation)
Someone must examine and confirm this is a valid issue and not a duplicate of an existing one.

Milestone
[Go1.24](/golang/go/milestone/322 "Go1.24")

## Comments

[![@neild](https://avatars.githubusercontent.com/u/52544?s=80&u=41bff20219d93918578944360c3930f30df4693b&v=4)](/neild)

Copy link

Contributor

### **[neild](/neild)** commented [May 21, 2024](#issue-2309120286)

| This is a follow-up to [#67382](https://github.com/golang/go/issues/67382). See that issue for some prior discussion. (That issue is also full of watchflakes reports, so I'm letting it be about the test flakiness. This issue is about the underlying problem.)  An HTTP/1 or HTTP/2 client can send an `Expect: 100-continue` header in a request to indicate that it might not send the request body until the server asks for it. The client is permitted to send the request body anyway, either immediately or after a delay.  A server may respond to a `Expect: 100-continue` request with an informational 100 status, indicating that it would like the client to send the request body. A server may also respond with a non-1xx status, without waiting for the request body.  For HTTP/1, a client *must* send the body for a request or close the connection. If a client sends a `Expect: 100-continue` request and receives a non-1xx response from the server, it still needs to finish sending the current request's body before sending any further requests on the connection.  For HTTP/2, a client can reset a request's stream and continue to use the connection without sending the body.  This issue is about how our client and server implementations handle the case of a server responding to an `Expect: 100-continue` request with a non-1xx response.  Client: If we receive a non-1xx response to an `Expect: 100-continue` request, should we send the request body on the assumption that the server might want it? Or should we assume that receiving response headers from the server indicates that the server didn't need the body? Should we modify this behavior for different response codes? A 200 OK might indicate that the server is going to use the request body, but a 403 Forbidden probably does not. Should we modify this behavior based on the presence or absence of a `Connection: close` header in the response? (Note that for HTTP/1 requests, if we do not send the request body, we may not reuse the connection for further requests.)  Server: When handling an `Expect: 100-continue` request, we automatically send a 100 Continue response if the server handler reads from the request body. What should we do if the server handler calls `WriteHeader` to send a non-1xx response, and then reads from the request body? Should we assume the server handler knows what it's doing, and trust that the client is going to send us a request body? Or should we return an error from the body read?  Our current behavior is inconsistent and occasionally wrong.  The HTTP/1 client does not send the request body if it receives a non-1xx response before `ExpectContinueTimeout` expires. This can leave the connection in an invalid state. (Server responds with a non-1xx response and attempts to read the request body; client reuses the connection for another request without sending the body.)  The HTTP/2 client always sends the request body after `ExpectContinueTimeout`, regardless of whether it has received a non-1xx response or not. If the server is trying to read the body, it will eventually get it, but only after a timeout.  Both HTTP/1 and HTTP/2 servers appear to permit reading from a request body even after sending a non-1xx response (and no 100 Continue response).  I'm not certain yet what we should be doing, but at a minimum:   * The HTTP/1 client should not send any further requests on a connection if it decides not to send a request body. * The HTTP/2 client should disable the `ExpectContinueTimeout` timer after receiving a non-1xx response. It should either send or not send the request body, but it shouldn't keep delaying. * We should make an intentional decision on whether a server handler reading from a `Expect: 100-continue` request body after sending response headers gets an error or not. |
| --- |
| The text was updated successfully, but these errors were encountered: |

 üéâ
3
 szuecs, the-hotmann, and cwegener reacted with hooray emoji

All reactions

* üéâ
  3 reactions

[![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=80&u=be84be2341a1a28dc2ede61150f7ceaaf470b8ba&v=4)](/gopherbot)

Copy link

Contributor

### **[gopherbot](/gopherbot)** commented [May 21, 2024](#issuecomment-2123458884)

| Change <https://go.dev/cl/587155> mentions this issue: `net/http: disable flaky 100-continue tests` |
| --- |

All reactions

Sorry, something went wrong.

[gopherbot](/gopherbot)
pushed a commit
that referenced
this issue
[May 21, 2024](#ref-commit-7164fad)
[![@neild](https://avatars.githubusercontent.com/u/52544?s=40&u=41bff20219d93918578944360c3930f30df4693b&v=4)](/neild) [![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=40&v=4)](/gopherbot)

`[net/http: disable flaky 100-continue tests](/golang/go/commit/7164fad87a3be06220771f2ae497cb15ef467e31 "net/http: disable flaky 100-continue tests

Disable three 100-continue tests that aren't exercising the
intended behavior because they don't set ExpectContinueTimeout.
The tests are flaky right now; setting ExpectContinueTimeout
makes them consistently fail.

Set ExpectContinueTimeout and t.Skip the tests for now.

Fixes #67382
For #67555

Change-Id: I459a19a927e14af03881e89c73d20c93cf0da43e
Reviewed-on: https://go-review.googlesource.com/c/go/+/587155
Auto-Submit: Damien Neil <dneil@google.com>
Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
Reviewed-by: Dmitri Shuralyov <dmitshur@golang.org>")`
‚Ä¶

`[7164fad](/golang/go/commit/7164fad87a3be06220771f2ae497cb15ef467e31)`

```
Disable three 100-continue tests that aren't exercising the
intended behavior because they don't set ExpectContinueTimeout.
The tests are flaky right now; setting ExpectContinueTimeout
makes them consistently fail.

Set ExpectContinueTimeout and t.Skip the tests for now.

Fixes [#67382](https://github.com/golang/go/issues/67382)
For [#67555](https://github.com/golang/go/issues/67555)

Change-Id: I459a19a927e14af03881e89c73d20c93cf0da43e
Reviewed-on: [https://go-review.googlesource.com/c/go/+/587155](https://go-review.googlesource.com/c/go/%2B/587155)
Auto-Submit: Damien Neil <dneil@google.com>
Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
Reviewed-by: Dmitri Shuralyov <dmitshur@golang.org>
```

[![@cagedmantis](https://avatars.githubusercontent.com/u/146817?s=40&v=4)](/cagedmantis)
[cagedmantis](/cagedmantis)
added this to the [Go1.23](/golang/go/milestone/212) milestone
[May 22, 2024](#event-12895605839)

[![@cagedmantis](https://avatars.githubusercontent.com/u/146817?s=40&v=4)](/cagedmantis)
[cagedmantis](/cagedmantis)
added
the
[NeedsInvestigation](/golang/go/labels/NeedsInvestigation)
Someone must examine and confirm this is a valid issue and not a duplicate of an existing one.
label
[May 22, 2024](#event-12895610270)

[![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=80&u=be84be2341a1a28dc2ede61150f7ceaaf470b8ba&v=4)](/gopherbot)

Copy link

Contributor

### **[gopherbot](/gopherbot)** commented [Jun 6, 2024](#issuecomment-2153306195)

| Change <https://go.dev/cl/591255> mentions this issue: `net/http: send body or close connection on expect-100-continue requests` |
| --- |

All reactions

Sorry, something went wrong.

[gopherbot](/gopherbot)
pushed a commit
that referenced
this issue
[Jun 6, 2024](#ref-commit-cf501e0)
[![@neild](https://avatars.githubusercontent.com/u/52544?s=40&u=41bff20219d93918578944360c3930f30df4693b&v=4)](/neild)

`[net/http: send body or close connection on expect-100-continue requests](/golang/go/commit/cf501e05e138e6911f759a5db786e90b295499b9 "net/http: send body or close connection on expect-100-continue requests

When sending a request with an \"Expect: 100-continue\" header,
we must send the request body before sending any further requests
on the connection.

When receiving a non-1xx response to an \"Expect: 100-continue\" request,
send the request body if the connection isn't being closed after
processing the response. In other words, if either the request
or response contains a \"Connection: close\" header, then skip sending
the request body (because the connection will not be used for
further requests), but otherwise send it.

Correct a comment on the server-side Expect: 100-continue handling
that implied sending the request body is optional. It isn't.

For #67555

Change-Id: Ia2f12091bee697771087f32ac347509ec5922d54
Reviewed-on: https://go-review.googlesource.com/c/go/+/591255
LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
Reviewed-by: Jonathan Amsterdam <jba@google.com>")`
‚Ä¶

`[cf501e0](/golang/go/commit/cf501e05e138e6911f759a5db786e90b295499b9)`

```
When sending a request with an "Expect: 100-continue" header,
we must send the request body before sending any further requests
on the connection.

When receiving a non-1xx response to an "Expect: 100-continue" request,
send the request body if the connection isn't being closed after
processing the response. In other words, if either the request
or response contains a "Connection: close" header, then skip sending
the request body (because the connection will not be used for
further requests), but otherwise send it.

Correct a comment on the server-side Expect: 100-continue handling
that implied sending the request body is optional. It isn't.

For [#67555](https://github.com/golang/go/issues/67555)

Change-Id: Ia2f12091bee697771087f32ac347509ec5922d54
Reviewed-on: [https://go-review.googlesource.com/c/go/+/591255](https://go-review.googlesource.com/c/go/%2B/591255)
LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
Reviewed-by: Jonathan Amsterdam <jba@google.com>
```

[![@neild](https://avatars.githubusercontent.com/u/52544?s=80&u=41bff20219d93918578944360c3930f30df4693b&v=4)](/neild)

Copy link

Contributor

Author

### **[neild](/neild)** commented [Jun 26, 2024](#issuecomment-2192229147)

| [@gopherbot](https://github.com/gopherbot) please open backport issues. This is a significant bug with no workaround. |
| --- |

All reactions

Sorry, something went wrong.

[![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=40&u=be84be2341a1a28dc2ede61150f7ceaaf470b8ba&v=4)](/gopherbot)
[gopherbot](/gopherbot)
mentioned this issue
[Jun 26, 2024](#ref-issue-2375870314)

[net/http: `expect: 100-continue` handling is broken in various ways [1.21 backport]
#68199](/golang/go/issues/68199)

Closed

[![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=80&u=be84be2341a1a28dc2ede61150f7ceaaf470b8ba&v=4)](/gopherbot)

Copy link

Contributor

### **[gopherbot](/gopherbot)** commented [Jun 26, 2024](#issuecomment-2192229611)

| Backport issue(s) opened: [#68199](https://github.com/golang/go/issues/68199) (for 1.21), [#68200](https://github.com/golang/go/issues/68200) (for 1.22).  Remember to create the cherry-pick CL(s) as soon as the patch is submitted to master, according to <https://go.dev/wiki/MinorReleases>. |
| --- |

All reactions

Sorry, something went wrong.

[![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=40&u=be84be2341a1a28dc2ede61150f7ceaaf470b8ba&v=4)](/gopherbot)
[gopherbot](/gopherbot)
mentioned this issue
[Jun 26, 2024](#ref-issue-2375870322)

[net/http: `expect: 100-continue` handling is broken in various ways [1.22 backport]
#68200](/golang/go/issues/68200)

Closed

[![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=80&u=be84be2341a1a28dc2ede61150f7ceaaf470b8ba&v=4)](/gopherbot)

Copy link

Contributor

### **[gopherbot](/gopherbot)** commented [Jun 26, 2024](#issuecomment-2192516371)

| Change <https://go.dev/cl/595096> mentions this issue: `[release-branch.go1.21] net/http: send body or close connection on expect-100-continue requests` |
| --- |

All reactions

Sorry, something went wrong.

[![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=80&u=be84be2341a1a28dc2ede61150f7ceaaf470b8ba&v=4)](/gopherbot)

Copy link

Contributor

### **[gopherbot](/gopherbot)** commented [Jun 26, 2024](#issuecomment-2192517227)

| Change <https://go.dev/cl/595235> mentions this issue: `[release-branch.go1.22] net/http: send body or close connection on expect-100-continue requests` |
| --- |

All reactions

Sorry, something went wrong.

[gopherbot](/gopherbot)
pushed a commit
that referenced
this issue
[Jun 26, 2024](#ref-commit-c9be6ae)
[![@neild](https://avatars.githubusercontent.com/u/52544?s=40&u=41bff20219d93918578944360c3930f30df4693b&v=4)](/neild) [![@joedian](https://avatars.githubusercontent.com/u/15622142?s=40&v=4)](/joedian)

`[[release-branch.go1.21] net/http: send body or close connection on ex‚Ä¶](/golang/go/commit/c9be6ae748b7679b644a38182d456cb5a6ac06ee "[release-branch.go1.21] net/http: send body or close connection on expect-100-continue requests

When sending a request with an \"Expect: 100-continue\" header,
we must send the request body before sending any further requests
on the connection.

When receiving a non-1xx response to an \"Expect: 100-continue\" request,
send the request body if the connection isn't being closed after
processing the response. In other words, if either the request
or response contains a \"Connection: close\" header, then skip sending
the request body (because the connection will not be used for
further requests), but otherwise send it.

Correct a comment on the server-side Expect: 100-continue handling
that implied sending the request body is optional. It isn't.

For #67555
Fixes #68199

Change-Id: Ia2f12091bee697771087f32ac347509ec5922d54
Reviewed-on: https://go-review.googlesource.com/c/go/+/591255
LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
Reviewed-by: Jonathan Amsterdam <jba@google.com>
(cherry picked from commit cf501e05e138e6911f759a5db786e90b295499b9)
Reviewed-on: https://go-review.googlesource.com/c/go/+/595096
Reviewed-by: Joedian Reid <joedian@google.com>
Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>")`
‚Ä¶

`[c9be6ae](/golang/go/commit/c9be6ae748b7679b644a38182d456cb5a6ac06ee)`

```
‚Ä¶pect-100-continue requests

When sending a request with an "Expect: 100-continue" header,
we must send the request body before sending any further requests
on the connection.

When receiving a non-1xx response to an "Expect: 100-continue" request,
send the request body if the connection isn't being closed after
processing the response. In other words, if either the request
or response contains a "Connection: close" header, then skip sending
the request body (because the connection will not be used for
further requests), but otherwise send it.

Correct a comment on the server-side Expect: 100-continue handling
that implied sending the request body is optional. It isn't.

For [#67555](https://github.com/golang/go/issues/67555)
Fixes [#68199](https://github.com/golang/go/issues/68199)

Change-Id: Ia2f12091bee697771087f32ac347509ec5922d54
Reviewed-on: [https://go-review.googlesource.com/c/go/+/591255](https://go-review.googlesource.com/c/go/%2B/591255)
LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
Reviewed-by: Jonathan Amsterdam <jba@google.com>
(cherry picked from commit [cf501e0](https://github.com/golang/go/commit/cf501e05e138e6911f759a5db786e90b295499b9))
Reviewed-on: [https://go-review.googlesource.com/c/go/+/595096](https://go-review.googlesource.com/c/go/%2B/595096)
Reviewed-by: Joedian Reid <joedian@google.com>
Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
```

[gopherbot](/gopherbot)
pushed a commit
that referenced
this issue
[Jun 26, 2024](#ref-commit-3222951)
[![@neild](https://avatars.githubusercontent.com/u/52544?s=40&u=41bff20219d93918578944360c3930f30df4693b&v=4)](/neild) [![@joedian](https://avatars.githubusercontent.com/u/15622142?s=40&v=4)](/joedian)

`[[release-branch.go1.22] net/http: send body or close connection on ex‚Ä¶](/golang/go/commit/32229514396234a25d910ab26a4e5194671a2c9f "[release-branch.go1.22] net/http: send body or close connection on expect-100-continue requests

When sending a request with an \"Expect: 100-continue\" header,
we must send the request body before sending any further requests
on the connection.

When receiving a non-1xx response to an \"Expect: 100-continue\" request,
send the request body if the connection isn't being closed after
processing the response. In other words, if either the request
or response contains a \"Connection: close\" header, then skip sending
the request body (because the connection will not be used for
further requests), but otherwise send it.

Correct a comment on the server-side Expect: 100-continue handling
that implied sending the request body is optional. It isn't.

For #67555
Fixes #68200

Change-Id: Ia2f12091bee697771087f32ac347509ec5922d54
Reviewed-on: https://go-review.googlesource.com/c/go/+/591255
LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
Reviewed-by: Jonathan Amsterdam <jba@google.com>
(cherry picked from commit cf501e05e138e6911f759a5db786e90b295499b9)
Reviewed-on: https://go-review.googlesource.com/c/go/+/595235
Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
Reviewed-by: Joedian Reid <joedian@google.com>")`
‚Ä¶

`[3222951](/golang/go/commit/32229514396234a25d910ab26a4e5194671a2c9f)`

```
‚Ä¶pect-100-continue requests

When sending a request with an "Expect: 100-continue" header,
we must send the request body before sending any further requests
on the connection.

When receiving a non-1xx response to an "Expect: 100-continue" request,
send the request body if the connection isn't being closed after
processing the response. In other words, if either the request
or response contains a "Connection: close" header, then skip sending
the request body (because the connection will not be used for
further requests), but otherwise send it.

Correct a comment on the server-side Expect: 100-continue handling
that implied sending the request body is optional. It isn't.

For [#67555](https://github.com/golang/go/issues/67555)
Fixes [#68200](https://github.com/golang/go/issues/68200)

Change-Id: Ia2f12091bee697771087f32ac347509ec5922d54
Reviewed-on: [https://go-review.googlesource.com/c/go/+/591255](https://go-review.googlesource.com/c/go/%2B/591255)
LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
Reviewed-by: Jonathan Amsterdam <jba@google.com>
(cherry picked from commit [cf501e0](https://github.com/golang/go/commit/cf501e05e138e6911f759a5db786e90b295499b9))
Reviewed-on: [https://go-review.googlesource.com/c/go/+/595235](https://go-review.googlesource.com/c/go/%2B/595235)
Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
Reviewed-by: Joedian Reid <joedian@google.com>
```

[![@thanm](https://avatars.githubusercontent.com/u/12280172?s=80&u=5104f57d13ae9e459a66271681560be672d22fa7&v=4)](/thanm)

Copy link

Contributor

### **[thanm](/thanm)** commented [Jul 2, 2024](#issuecomment-2204262580)

| From the security team related to this issue:  The net/http HTTP/1.1 client mishandled the case where a server responds to a request with an "Expect: 100-continue" header with a non-informational (200 or higher) status. This mishandling could leave a client connection in an invalid state, where the next request sent on the connection will fail.  An attacker sending a request to a net/http/httputil.ReverseProxy proxy can exploit this mishandling to cause a denial of service by sending "Expect: 100-continue" requests which elicit a non-informational response from the backend. Each such request leaves the proxy with an invalid connection, and causes one subsequent request using that connection to fail.  Thanks to Geoff Franks for reporting this issue.  This is [CVE-2024-24791](https://github.com/advisories/GHSA-hw49-2p59-3mhj "CVE-2024-24791") and Go issue <https://go.dev/issue/67555>. |
| --- |

 üéâ
4
 szuecs, norman-abramovitz, maxmoehl, and cwegener reacted with hooray emoji

All reactions

* üéâ
  4 reactions

Sorry, something went wrong.

[![@864893031735973](https://avatars.githubusercontent.com/u/63679801?s=80&v=4)](/864893031735973)

### This comment was marked as spam.

[Sign in to view](/login?return_to=https%3A%2F%2Fgithub.com%2Fgolang%2Fgo%2Fissues%2F67555)

[![@864893031735973](https://avatars.githubusercontent.com/u/63679801?s=80&v=4)](/864893031735973)

### This comment was marked as spam.

[Sign in to view](/login?return_to=https%3A%2F%2Fgithub.com%2Fgolang%2Fgo%2Fissues%2F67555)

[![@cherrymui](https://avatars.githubusercontent.com/u/14119929?s=80&u=28f1e4e7569d3bbad94e301ac9466815b6961878&v=4)](/cherrymui)

Copy link

Member

### **[cherrymui](/cherrymui)** commented [Jul 15, 2024](#issuecomment-2229059089)

| As the CLs are in and the backports are done, is there anything else needed for this issue, or we can close this? Thanks. |
| --- |

 üëÄ
1
 s7v7nislands reacted with eyes emoji

All reactions

* üëÄ
  1 reaction

Sorry, something went wrong.

[![@neild](https://avatars.githubusercontent.com/u/52544?s=40&u=41bff20219d93918578944360c3930f30df4693b&v=4)](/neild)
[neild](/neild)
self-assigned this
[Jul 31, 2024](#event-13713104574)

[![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=40&u=be84be2341a1a28dc2ede61150f7ceaaf470b8ba&v=4)](/gopherbot)
[gopherbot](/gopherbot)
modified the milestones:
[Go1.23](/golang/go/milestone/212),
[Go1.24](/golang/go/milestone/322)
[Aug 13, 2024](#event-13866034398)

[![@rgoltz](https://avatars.githubusercontent.com/u/16392819?s=40&v=4)](/rgoltz)
[rgoltz](/rgoltz)
mentioned this issue
[Nov 24, 2024](#ref-issue-2640607519)

[Which version of Grafana in 10.x series and 11.x series has fix for these vulnerabilities.
grafana/grafana#96016](/grafana/grafana/issues/96016)

Open

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fgolang%2Fgo%2Fissues%2F67555)

Assignees

[![@neild](https://avatars.githubusercontent.com/u/52544?s=40&v=4)](/neild) [neild](/neild)

Labels

[NeedsInvestigation](/golang/go/labels/NeedsInvestigation)
Someone must examine and confirm this is a valid issue and not a duplicate of an existing one.

Projects

None yet

Milestone

 [**Go1.24**](/golang/go/milestone/322 "Go1.24")

Development

No branches or pull requests

6 participants

[![@neild](https://avatars.githubusercontent.com/u/52544?s=52&v=4)](/neild) [![@cagedmantis](https://avatars.githubusercontent.com/u/146817?s=52&v=4)](/cagedmantis) [![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=52&v=4)](/gopherbot) [![@thanm](https://avatars.githubusercontent.com/u/12280172?s=52&v=4)](/thanm) [![@cherrymui](https://avatars.githubusercontent.com/u/14119929?s=52&v=4)](/cherrymui) [![@864893031735973](https://avatars.githubusercontent.com/u/63679801?s=52&v=4)](/864893031735973)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from pkg.go.dev_bba418b7_20250111_184637.html ===


[![Go](/static/shared/logo/go-white.svg)](https://go.dev/)
 [Skip to Main Content](#main-content)

![](/static/shared/icon/search_gm_grey_24dp.svg)

![](/static/shared/icon/search_gm_grey_24dp.svg)

* Why Go
  ![submenu dropdown icon](/static/shared/icon/arrow_drop_down_gm_grey_24dp.svg)
  + [Case Studies](https://go.dev/solutions#case-studies)

    Common problems companies solve with Go
  + [Use Cases](https://go.dev/solutions#use-cases)

    Stories about how and why companies use Go
  + [Security Policy](https://go.dev/security/policy/)

    How Go can help keep you secure by default
* [Learn](https://go.dev/learn/)
* Docs
  ![submenu dropdown icon](/static/shared/icon/arrow_drop_down_gm_grey_24dp.svg)
  + [Effective Go](https://go.dev/doc/effective_go)

    Tips for writing clear, performant, and idiomatic Go code
  + [Go User Manual](https://go.dev/doc/)

    A complete introduction to building software with Go
  + [Standard library](https://pkg.go.dev/std)

    Reference documentation for Go's standard library
  + [Release Notes](https://go.dev/doc/devel/release)

    Learn what's new in each Go release
* [Packages](/)
* Community
  ![submenu dropdown icon](/static/shared/icon/arrow_drop_down_gm_grey_24dp.svg)
  + [Recorded Talks](https://go.dev/talks/)

    Videos from prior events
  + [Meetups
    *![](/static/shared/icon/launch_gm_grey_24dp.svg)*](https://www.meetup.com/pro/go)

    Meet other local Go developers
  + [Conferences
    *![](/static/shared/icon/launch_gm_grey_24dp.svg)*](https://github.com/golang/go/wiki/Conferences)

    Learn and network with Go developers from around the world
  + [Go blog](https://go.dev/blog)

    The Go project's official blog.
  + [Go project](https://go.dev/help)

    Get help and stay informed from Go
  + Get connected
    [![](/static/shared/logo/social/google-groups.svg)](https://groups.google.com/g/golang-nuts "Get connected with google-groups (Opens in new window)")
    [![](/static/shared/logo/social/github.svg)](https://github.com/golang "Get connected with github (Opens in new window)")
    [![](/static/shared/logo/social/twitter.svg)](https://twitter.com/golang "Get connected with twitter (Opens in new window)")
    [![](/static/shared/logo/social/reddit.svg)](https://www.reddit.com/r/golang/ "Get connected with reddit (Opens in new window)")
    [![](/static/shared/logo/social/slack.svg)](https://invite.slack.golangbridge.org/ "Get connected with slack (Opens in new window)")
    [![](/static/shared/logo/social/stack-overflow.svg)](https://stackoverflow.com/collectives/go)

[![Go.](/static/shared/logo/go-blue.svg)](https://go.dev/)

* Why Go
  *![](/static/shared/icon/navigate_next_gm_grey_24dp.svg)*
  *![](/static/shared/icon/navigate_before_gm_grey_24dp.svg)*
  Why Go
  + [Case Studies](https://go.dev/solutions#case-studies)
  + [Use Cases](https://go.dev/solutions#use-cases)
  + [Security Policy](https://go.dev/security/policy/)
* [Learn](https://go.dev/learn/)
* Docs
  *![](/static/shared/icon/navigate_next_gm_grey_24dp.svg)*
  *![](/static/shared/icon/navigate_before_gm_grey_24dp.svg)*
  Docs
  + [Effective Go](https://go.dev/doc/effective_go)
  + [Go User Manual](https://go.dev/doc/)
  + [Standard library](https://pkg.go.dev/std)
  + [Release Notes](https://go.dev/doc/devel/release)
* [Packages](/)
* Community
  *![](/static/shared/icon/navigate_next_gm_grey_24dp.svg)*
  *![](/static/shared/icon/navigate_before_gm_grey_24dp.svg)*
  Community
  + [Recorded Talks](https://go.dev/talks/)
  + [Meetups
    *![](/static/shared/icon/launch_gm_grey_24dp.svg)*](https://www.meetup.com/pro/go)
  + [Conferences
    *![](/static/shared/icon/launch_gm_grey_24dp.svg)*](https://github.com/golang/go/wiki/Conferences)
  + [Go blog](https://go.dev/blog)
  + [Go project](https://go.dev/help)
  + Get connected
    [![](/static/shared/logo/social/google-groups.svg)](https://groups.google.com/g/golang-nuts)
    [![](/static/shared/logo/social/github.svg)](https://github.com/golang)
    [![](/static/shared/logo/social/twitter.svg)](https://twitter.com/golang)
    [![](/static/shared/logo/social/reddit.svg)](https://www.reddit.com/r/golang/)
    [![](/static/shared/logo/social/slack.svg)](https://invite.slack.golangbridge.org/)
    [![](/static/shared/logo/social/stack-overflow.svg)](https://stackoverflow.com/collectives/go)

1. [Vulnerability Database](/vuln)
2. [All Reports](/vuln/list)
3. GO-2024-2963

# Vulnerability Report: GO-2024-2963

standard library

* CVE-2024-24791
* Affects:
  net/http
* Published: Jul 02, 2024

The net/http HTTP/1.1 client mishandled the case where a server responds to a request with an "Expect: 100-continue" header with a non-informational (200 or higher) status. This mishandling could leave a client connection in an invalid state, where the next request sent on the connection will fail.
An attacker sending a request to a net/http/httputil.ReverseProxy proxy can exploit this mishandling to cause a denial of service by sending "Expect: 100-continue" requests which elicit a non-informational response from the backend. Each such request leaves the proxy with an invalid connection, and causes one subsequent request using that connection to fail.

## Affected Packages

* Path
  Go Versions
  Symbols
* [net/http](/net/http)
  before go1.21.12, from go1.22.0-0 before go1.22.5
  13 affected symbols
  + [Client.CloseIdleConnections](/net/http#Client.CloseIdleConnections)
  + [Client.Do](/net/http#Client.Do)
  + [Client.Get](/net/http#Client.Get)
  + [Client.Head](/net/http#Client.Head)
  + [Client.Post](/net/http#Client.Post)
  + [Client.PostForm](/net/http#Client.PostForm)
  + [Get](/net/http#Get)
  + [Head](/net/http#Head)
  + [Post](/net/http#Post)
  + [PostForm](/net/http#PostForm)
  + [Transport.CancelRequest](/net/http#Transport.CancelRequest)
  + [Transport.CloseIdleConnections](/net/http#Transport.CloseIdleConnections)
  + [Transport.RoundTrip](/net/http#Transport.RoundTrip)

## Aliases

* [CVE-2024-24791](https://www.cve.org/CVERecord?id=CVE-2024-24791)

## References

* <https://go.dev/cl/591255>
* <https://go.dev/issue/67555>
* <https://groups.google.com/g/golang-dev/c/t0rK-qHBqzY/m/6MMoAZkMAgAJ>
* <https://vuln.go.dev/ID/GO-2024-2963.json>

## Credits

* Geoff Franks

## Feedback

See anything missing or incorrect?
[Suggest an edit to this report.](https://github.com/golang/vulndb/issues/new?assignees=&labels=Needs+Triage%2CSuggested+Edit&template=suggest_edit.yaml&title=x%2Fvulndb%3A+suggestion+regarding+GO-2024-2963&report=GO-2024-2963)

[Why Go](https://go.dev/solutions)
[Use Cases](https://go.dev/solutions#use-cases)
[Case Studies](https://go.dev/solutions#case-studies)

[Get Started](https://learn.go.dev/)
[Playground](https://play.golang.org)
[Tour](https://tour.golang.org)
[Stack Overflow](https://stackoverflow.com/questions/tagged/go?tab=Newest)
[Help](https://go.dev/help)

[Packages](https://pkg.go.dev)
[Standard Library](/std)
[Sub-repositories](/golang.org/x)
[About Go Packages](https://pkg.go.dev/about)

[About](https://go.dev/project)
[Download](https://go.dev/dl/)
[Blog](https://go.dev/blog)
[Issue Tracker](https://github.com/golang/go/issues)
[Release Notes](https://go.dev/doc/devel/release.html)
[Brand Guidelines](https://blog.golang.org/go-brand)
[Code of Conduct](https://go.dev/conduct)

[Connect](https://www.twitter.com/golang)
[Twitter](https://www.twitter.com/golang)
[GitHub](https://github.com/golang)
[Slack](https://invite.slack.golangbridge.org/)
[r/golang](https://reddit.com/r/golang)
[Meetup](https://www.meetup.com/pro/go)
[Golang Weekly](https://golangweekly.com/)

![Gopher in flight goggles](/static/shared/gopher/pilot-bust-1431x901.svg)

* [Copyright](https://go.dev/copyright)
* [Terms of Service](https://go.dev/tos)
* [Privacy Policy](http://www.google.com/intl/en/policies/privacy/)
* [Report an Issue](https://go.dev/s/pkgsite-feedback)
* ![System theme](/static/shared/icon/brightness_6_gm_grey_24dp.svg)
  ![Dark theme](/static/shared/icon/brightness_2_gm_grey_24dp.svg)
  ![Light theme](/static/shared/icon/light_mode_gm_grey_24dp.svg)

  Theme Toggle
* ![](/static/shared/icon/keyboard_grey_24dp.svg)

  Shortcuts Modal

[![Google logo](/static/shared/logo/google-white.svg)](https://google.com)

## Jump to

![](/static/shared/icon/close_gm_grey_24dp.svg)

Close

## Keyboard shortcuts

![](/static/shared/icon/close_gm_grey_24dp.svg)

| **?** | : This menu |
| --- | --- |
| **/** | : Search site |
| **f** or **F** | : Jump to |
| **y** or **Y** | : Canonical URL |

Close

go.dev uses cookies from Google to deliver and enhance the quality of its services and to
analyze traffic. [Learn more.](https://policies.google.com/technologies/cookies)
Okay


