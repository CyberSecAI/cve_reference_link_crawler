
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgolang%2Fgo%2Fissues%2F67555)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgolang%2Fgo%2Fissues%2F67555)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=golang%2Fgo)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[golang](/golang)
/
**[go](/golang/go)**
Public

* [Notifications](/login?return_to=%2Fgolang%2Fgo) You must be signed in to change notification settings
* [Fork
  17.8k](/login?return_to=%2Fgolang%2Fgo)
* [Star
   125k](/login?return_to=%2Fgolang%2Fgo)

* [Code](/golang/go)
* [Issues
  5k+](/golang/go/issues)
* [Pull requests
  508](/golang/go/pulls)
* [Discussions](/golang/go/discussions)
* [Actions](/golang/go/actions)
* [Projects
  4](/golang/go/projects)
* [Wiki](/golang/go/wiki)
* [Security](/golang/go/security)
* [Insights](/golang/go/pulse)

Additional navigation options

* [Code](/golang/go)
* [Issues](/golang/go/issues)
* [Pull requests](/golang/go/pulls)
* [Discussions](/golang/go/discussions)
* [Actions](/golang/go/actions)
* [Projects](/golang/go/projects)
* [Wiki](/golang/go/wiki)
* [Security](/golang/go/security)
* [Insights](/golang/go/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fgolang%2Fgo%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fgolang%2Fgo%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# net/http: `expect: 100-continue` handling is broken in various ways #67555

Open

[neild](/neild) opened this issue
May 21, 2024
¬∑ 10 comments

Open

# [net/http: `expect: 100-continue` handling is broken in various ways](#top) #67555

[neild](/neild) opened this issue
May 21, 2024
¬∑ 10 comments

Assignees
[![@neild](https://avatars.githubusercontent.com/u/52544?s=40&v=4)](/neild)

Labels
[NeedsInvestigation](/golang/go/labels/NeedsInvestigation)
Someone must examine and confirm this is a valid issue and not a duplicate of an existing one.

Milestone
[Go1.24](/golang/go/milestone/322 "Go1.24")

## Comments

[![@neild](https://avatars.githubusercontent.com/u/52544?s=80&u=41bff20219d93918578944360c3930f30df4693b&v=4)](/neild)

Copy link

Contributor

### **[neild](/neild)** commented [May 21, 2024](#issue-2309120286)

| This is a follow-up to [#67382](https://github.com/golang/go/issues/67382). See that issue for some prior discussion. (That issue is also full of watchflakes reports, so I'm letting it be about the test flakiness. This issue is about the underlying problem.)  An HTTP/1 or HTTP/2 client can send an `Expect: 100-continue` header in a request to indicate that it might not send the request body until the server asks for it. The client is permitted to send the request body anyway, either immediately or after a delay.  A server may respond to a `Expect: 100-continue` request with an informational 100 status, indicating that it would like the client to send the request body. A server may also respond with a non-1xx status, without waiting for the request body.  For HTTP/1, a client *must* send the body for a request or close the connection. If a client sends a `Expect: 100-continue` request and receives a non-1xx response from the server, it still needs to finish sending the current request's body before sending any further requests on the connection.  For HTTP/2, a client can reset a request's stream and continue to use the connection without sending the body.  This issue is about how our client and server implementations handle the case of a server responding to an `Expect: 100-continue` request with a non-1xx response.  Client: If we receive a non-1xx response to an `Expect: 100-continue` request, should we send the request body on the assumption that the server might want it? Or should we assume that receiving response headers from the server indicates that the server didn't need the body? Should we modify this behavior for different response codes? A 200 OK might indicate that the server is going to use the request body, but a 403 Forbidden probably does not. Should we modify this behavior based on the presence or absence of a `Connection: close` header in the response? (Note that for HTTP/1 requests, if we do not send the request body, we may not reuse the connection for further requests.)  Server: When handling an `Expect: 100-continue` request, we automatically send a 100 Continue response if the server handler reads from the request body. What should we do if the server handler calls `WriteHeader` to send a non-1xx response, and then reads from the request body? Should we assume the server handler knows what it's doing, and trust that the client is going to send us a request body? Or should we return an error from the body read?  Our current behavior is inconsistent and occasionally wrong.  The HTTP/1 client does not send the request body if it receives a non-1xx response before `ExpectContinueTimeout` expires. This can leave the connection in an invalid state. (Server responds with a non-1xx response and attempts to read the request body; client reuses the connection for another request without sending the body.)  The HTTP/2 client always sends the request body after `ExpectContinueTimeout`, regardless of whether it has received a non-1xx response or not. If the server is trying to read the body, it will eventually get it, but only after a timeout.  Both HTTP/1 and HTTP/2 servers appear to permit reading from a request body even after sending a non-1xx response (and no 100 Continue response).  I'm not certain yet what we should be doing, but at a minimum:   * The HTTP/1 client should not send any further requests on a connection if it decides not to send a request body. * The HTTP/2 client should disable the `ExpectContinueTimeout` timer after receiving a non-1xx response. It should either send or not send the request body, but it shouldn't keep delaying. * We should make an intentional decision on whether a server handler reading from a `Expect: 100-continue` request body after sending response headers gets an error or not. |
| --- |
| The text was updated successfully, but these errors were encountered: |

 üéâ
3
 szuecs, the-hotmann, and cwegener reacted with hooray emoji

All reactions

* üéâ
  3 reactions

[![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=80&u=be84be2341a1a28dc2ede61150f7ceaaf470b8ba&v=4)](/gopherbot)

Copy link

Contributor

### **[gopherbot](/gopherbot)** commented [May 21, 2024](#issuecomment-2123458884)

| Change <https://go.dev/cl/587155> mentions this issue: `net/http: disable flaky 100-continue tests` |
| --- |

All reactions

Sorry, something went wrong.

[gopherbot](/gopherbot)
pushed a commit
that referenced
this issue
[May 21, 2024](#ref-commit-7164fad)
[![@neild](https://avatars.githubusercontent.com/u/52544?s=40&u=41bff20219d93918578944360c3930f30df4693b&v=4)](/neild) [![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=40&v=4)](/gopherbot)

`[net/http: disable flaky 100-continue tests](/golang/go/commit/7164fad87a3be06220771f2ae497cb15ef467e31 "net/http: disable flaky 100-continue tests

Disable three 100-continue tests that aren't exercising the
intended behavior because they don't set ExpectContinueTimeout.
The tests are flaky right now; setting ExpectContinueTimeout
makes them consistently fail.

Set ExpectContinueTimeout and t.Skip the tests for now.

Fixes #67382
For #67555

Change-Id: I459a19a927e14af03881e89c73d20c93cf0da43e
Reviewed-on: https://go-review.googlesource.com/c/go/+/587155
Auto-Submit: Damien Neil <dneil@google.com>
Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
Reviewed-by: Dmitri Shuralyov <dmitshur@golang.org>")`
‚Ä¶

`[7164fad](/golang/go/commit/7164fad87a3be06220771f2ae497cb15ef467e31)`

```
Disable three 100-continue tests that aren't exercising the
intended behavior because they don't set ExpectContinueTimeout.
The tests are flaky right now; setting ExpectContinueTimeout
makes them consistently fail.

Set ExpectContinueTimeout and t.Skip the tests for now.

Fixes [#67382](https://github.com/golang/go/issues/67382)
For [#67555](https://github.com/golang/go/issues/67555)

Change-Id: I459a19a927e14af03881e89c73d20c93cf0da43e
Reviewed-on: [https://go-review.googlesource.com/c/go/+/587155](https://go-review.googlesource.com/c/go/%2B/587155)
Auto-Submit: Damien Neil <dneil@google.com>
Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
Reviewed-by: Dmitri Shuralyov <dmitshur@golang.org>
```

[![@cagedmantis](https://avatars.githubusercontent.com/u/146817?s=40&v=4)](/cagedmantis)
[cagedmantis](/cagedmantis)
added this to the [Go1.23](/golang/go/milestone/212) milestone
[May 22, 2024](#event-12895605839)

[![@cagedmantis](https://avatars.githubusercontent.com/u/146817?s=40&v=4)](/cagedmantis)
[cagedmantis](/cagedmantis)
added
the
[NeedsInvestigation](/golang/go/labels/NeedsInvestigation)
Someone must examine and confirm this is a valid issue and not a duplicate of an existing one.
label
[May 22, 2024](#event-12895610270)

[![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=80&u=be84be2341a1a28dc2ede61150f7ceaaf470b8ba&v=4)](/gopherbot)

Copy link

Contributor

### **[gopherbot](/gopherbot)** commented [Jun 6, 2024](#issuecomment-2153306195)

| Change <https://go.dev/cl/591255> mentions this issue: `net/http: send body or close connection on expect-100-continue requests` |
| --- |

All reactions

Sorry, something went wrong.

[gopherbot](/gopherbot)
pushed a commit
that referenced
this issue
[Jun 6, 2024](#ref-commit-cf501e0)
[![@neild](https://avatars.githubusercontent.com/u/52544?s=40&u=41bff20219d93918578944360c3930f30df4693b&v=4)](/neild)

`[net/http: send body or close connection on expect-100-continue requests](/golang/go/commit/cf501e05e138e6911f759a5db786e90b295499b9 "net/http: send body or close connection on expect-100-continue requests

When sending a request with an \"Expect: 100-continue\" header,
we must send the request body before sending any further requests
on the connection.

When receiving a non-1xx response to an \"Expect: 100-continue\" request,
send the request body if the connection isn't being closed after
processing the response. In other words, if either the request
or response contains a \"Connection: close\" header, then skip sending
the request body (because the connection will not be used for
further requests), but otherwise send it.

Correct a comment on the server-side Expect: 100-continue handling
that implied sending the request body is optional. It isn't.

For #67555

Change-Id: Ia2f12091bee697771087f32ac347509ec5922d54
Reviewed-on: https://go-review.googlesource.com/c/go/+/591255
LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
Reviewed-by: Jonathan Amsterdam <jba@google.com>")`
‚Ä¶

`[cf501e0](/golang/go/commit/cf501e05e138e6911f759a5db786e90b295499b9)`

```
When sending a request with an "Expect: 100-continue" header,
we must send the request body before sending any further requests
on the connection.

When receiving a non-1xx response to an "Expect: 100-continue" request,
send the request body if the connection isn't being closed after
processing the response. In other words, if either the request
or response contains a "Connection: close" header, then skip sending
the request body (because the connection will not be used for
further requests), but otherwise send it.

Correct a comment on the server-side Expect: 100-continue handling
that implied sending the request body is optional. It isn't.

For [#67555](https://github.com/golang/go/issues/67555)

Change-Id: Ia2f12091bee697771087f32ac347509ec5922d54
Reviewed-on: [https://go-review.googlesource.com/c/go/+/591255](https://go-review.googlesource.com/c/go/%2B/591255)
LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
Reviewed-by: Jonathan Amsterdam <jba@google.com>
```

[![@neild](https://avatars.githubusercontent.com/u/52544?s=80&u=41bff20219d93918578944360c3930f30df4693b&v=4)](/neild)

Copy link

Contributor

Author

### **[neild](/neild)** commented [Jun 26, 2024](#issuecomment-2192229147)

| [@gopherbot](https://github.com/gopherbot) please open backport issues. This is a significant bug with no workaround. |
| --- |

All reactions

Sorry, something went wrong.

[![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=40&u=be84be2341a1a28dc2ede61150f7ceaaf470b8ba&v=4)](/gopherbot)
[gopherbot](/gopherbot)
mentioned this issue
[Jun 26, 2024](#ref-issue-2375870314)

[net/http: `expect: 100-continue` handling is broken in various ways [1.21 backport]
#68199](/golang/go/issues/68199)

Closed

[![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=80&u=be84be2341a1a28dc2ede61150f7ceaaf470b8ba&v=4)](/gopherbot)

Copy link

Contributor

### **[gopherbot](/gopherbot)** commented [Jun 26, 2024](#issuecomment-2192229611)

| Backport issue(s) opened: [#68199](https://github.com/golang/go/issues/68199) (for 1.21), [#68200](https://github.com/golang/go/issues/68200) (for 1.22).  Remember to create the cherry-pick CL(s) as soon as the patch is submitted to master, according to <https://go.dev/wiki/MinorReleases>. |
| --- |

All reactions

Sorry, something went wrong.

[![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=40&u=be84be2341a1a28dc2ede61150f7ceaaf470b8ba&v=4)](/gopherbot)
[gopherbot](/gopherbot)
mentioned this issue
[Jun 26, 2024](#ref-issue-2375870322)

[net/http: `expect: 100-continue` handling is broken in various ways [1.22 backport]
#68200](/golang/go/issues/68200)

Closed

[![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=80&u=be84be2341a1a28dc2ede61150f7ceaaf470b8ba&v=4)](/gopherbot)

Copy link

Contributor

### **[gopherbot](/gopherbot)** commented [Jun 26, 2024](#issuecomment-2192516371)

| Change <https://go.dev/cl/595096> mentions this issue: `[release-branch.go1.21] net/http: send body or close connection on expect-100-continue requests` |
| --- |

All reactions

Sorry, something went wrong.

[![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=80&u=be84be2341a1a28dc2ede61150f7ceaaf470b8ba&v=4)](/gopherbot)

Copy link

Contributor

### **[gopherbot](/gopherbot)** commented [Jun 26, 2024](#issuecomment-2192517227)

| Change <https://go.dev/cl/595235> mentions this issue: `[release-branch.go1.22] net/http: send body or close connection on expect-100-continue requests` |
| --- |

All reactions

Sorry, something went wrong.

[gopherbot](/gopherbot)
pushed a commit
that referenced
this issue
[Jun 26, 2024](#ref-commit-c9be6ae)
[![@neild](https://avatars.githubusercontent.com/u/52544?s=40&u=41bff20219d93918578944360c3930f30df4693b&v=4)](/neild) [![@joedian](https://avatars.githubusercontent.com/u/15622142?s=40&v=4)](/joedian)

`[[release-branch.go1.21] net/http: send body or close connection on ex‚Ä¶](/golang/go/commit/c9be6ae748b7679b644a38182d456cb5a6ac06ee "[release-branch.go1.21] net/http: send body or close connection on expect-100-continue requests

When sending a request with an \"Expect: 100-continue\" header,
we must send the request body before sending any further requests
on the connection.

When receiving a non-1xx response to an \"Expect: 100-continue\" request,
send the request body if the connection isn't being closed after
processing the response. In other words, if either the request
or response contains a \"Connection: close\" header, then skip sending
the request body (because the connection will not be used for
further requests), but otherwise send it.

Correct a comment on the server-side Expect: 100-continue handling
that implied sending the request body is optional. It isn't.

For #67555
Fixes #68199

Change-Id: Ia2f12091bee697771087f32ac347509ec5922d54
Reviewed-on: https://go-review.googlesource.com/c/go/+/591255
LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
Reviewed-by: Jonathan Amsterdam <jba@google.com>
(cherry picked from commit cf501e05e138e6911f759a5db786e90b295499b9)
Reviewed-on: https://go-review.googlesource.com/c/go/+/595096
Reviewed-by: Joedian Reid <joedian@google.com>
Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>")`
‚Ä¶

`[c9be6ae](/golang/go/commit/c9be6ae748b7679b644a38182d456cb5a6ac06ee)`

```
‚Ä¶pect-100-continue requests

When sending a request with an "Expect: 100-continue" header,
we must send the request body before sending any further requests
on the connection.

When receiving a non-1xx response to an "Expect: 100-continue" request,
send the request body if the connection isn't being closed after
processing the response. In other words, if either the request
or response contains a "Connection: close" header, then skip sending
the request body (because the connection will not be used for
further requests), but otherwise send it.

Correct a comment on the server-side Expect: 100-continue handling
that implied sending the request body is optional. It isn't.

For [#67555](https://github.com/golang/go/issues/67555)
Fixes [#68199](https://github.com/golang/go/issues/68199)

Change-Id: Ia2f12091bee697771087f32ac347509ec5922d54
Reviewed-on: [https://go-review.googlesource.com/c/go/+/591255](https://go-review.googlesource.com/c/go/%2B/591255)
LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
Reviewed-by: Jonathan Amsterdam <jba@google.com>
(cherry picked from commit [cf501e0](https://github.com/golang/go/commit/cf501e05e138e6911f759a5db786e90b295499b9))
Reviewed-on: [https://go-review.googlesource.com/c/go/+/595096](https://go-review.googlesource.com/c/go/%2B/595096)
Reviewed-by: Joedian Reid <joedian@google.com>
Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
```

[gopherbot](/gopherbot)
pushed a commit
that referenced
this issue
[Jun 26, 2024](#ref-commit-3222951)
[![@neild](https://avatars.githubusercontent.com/u/52544?s=40&u=41bff20219d93918578944360c3930f30df4693b&v=4)](/neild) [![@joedian](https://avatars.githubusercontent.com/u/15622142?s=40&v=4)](/joedian)

`[[release-branch.go1.22] net/http: send body or close connection on ex‚Ä¶](/golang/go/commit/32229514396234a25d910ab26a4e5194671a2c9f "[release-branch.go1.22] net/http: send body or close connection on expect-100-continue requests

When sending a request with an \"Expect: 100-continue\" header,
we must send the request body before sending any further requests
on the connection.

When receiving a non-1xx response to an \"Expect: 100-continue\" request,
send the request body if the connection isn't being closed after
processing the response. In other words, if either the request
or response contains a \"Connection: close\" header, then skip sending
the request body (because the connection will not be used for
further requests), but otherwise send it.

Correct a comment on the server-side Expect: 100-continue handling
that implied sending the request body is optional. It isn't.

For #67555
Fixes #68200

Change-Id: Ia2f12091bee697771087f32ac347509ec5922d54
Reviewed-on: https://go-review.googlesource.com/c/go/+/591255
LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
Reviewed-by: Jonathan Amsterdam <jba@google.com>
(cherry picked from commit cf501e05e138e6911f759a5db786e90b295499b9)
Reviewed-on: https://go-review.googlesource.com/c/go/+/595235
Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
Reviewed-by: Joedian Reid <joedian@google.com>")`
‚Ä¶

`[3222951](/golang/go/commit/32229514396234a25d910ab26a4e5194671a2c9f)`

```
‚Ä¶pect-100-continue requests

When sending a request with an "Expect: 100-continue" header,
we must send the request body before sending any further requests
on the connection.

When receiving a non-1xx response to an "Expect: 100-continue" request,
send the request body if the connection isn't being closed after
processing the response. In other words, if either the request
or response contains a "Connection: close" header, then skip sending
the request body (because the connection will not be used for
further requests), but otherwise send it.

Correct a comment on the server-side Expect: 100-continue handling
that implied sending the request body is optional. It isn't.

For [#67555](https://github.com/golang/go/issues/67555)
Fixes [#68200](https://github.com/golang/go/issues/68200)

Change-Id: Ia2f12091bee697771087f32ac347509ec5922d54
Reviewed-on: [https://go-review.googlesource.com/c/go/+/591255](https://go-review.googlesource.com/c/go/%2B/591255)
LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
Reviewed-by: Jonathan Amsterdam <jba@google.com>
(cherry picked from commit [cf501e0](https://github.com/golang/go/commit/cf501e05e138e6911f759a5db786e90b295499b9))
Reviewed-on: [https://go-review.googlesource.com/c/go/+/595235](https://go-review.googlesource.com/c/go/%2B/595235)
Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
Reviewed-by: Joedian Reid <joedian@google.com>
```

[![@thanm](https://avatars.githubusercontent.com/u/12280172?s=80&u=5104f57d13ae9e459a66271681560be672d22fa7&v=4)](/thanm)

Copy link

Contributor

### **[thanm](/thanm)** commented [Jul 2, 2024](#issuecomment-2204262580)

| From the security team related to this issue:  The net/http HTTP/1.1 client mishandled the case where a server responds to a request with an "Expect: 100-continue" header with a non-informational (200 or higher) status. This mishandling could leave a client connection in an invalid state, where the next request sent on the connection will fail.  An attacker sending a request to a net/http/httputil.ReverseProxy proxy can exploit this mishandling to cause a denial of service by sending "Expect: 100-continue" requests which elicit a non-informational response from the backend. Each such request leaves the proxy with an invalid connection, and causes one subsequent request using that connection to fail.  Thanks to Geoff Franks for reporting this issue.  This is [CVE-2024-24791](https://github.com/advisories/GHSA-hw49-2p59-3mhj "CVE-2024-24791") and Go issue <https://go.dev/issue/67555>. |
| --- |

 üéâ
4
 szuecs, norman-abramovitz, maxmoehl, and cwegener reacted with hooray emoji

All reactions

* üéâ
  4 reactions

Sorry, something went wrong.

[![@864893031735973](https://avatars.githubusercontent.com/u/63679801?s=80&v=4)](/864893031735973)

### This comment was marked as spam.

[Sign in to view](/login?return_to=https%3A%2F%2Fgithub.com%2Fgolang%2Fgo%2Fissues%2F67555)

[![@864893031735973](https://avatars.githubusercontent.com/u/63679801?s=80&v=4)](/864893031735973)

### This comment was marked as spam.

[Sign in to view](/login?return_to=https%3A%2F%2Fgithub.com%2Fgolang%2Fgo%2Fissues%2F67555)

[![@cherrymui](https://avatars.githubusercontent.com/u/14119929?s=80&u=28f1e4e7569d3bbad94e301ac9466815b6961878&v=4)](/cherrymui)

Copy link

Member

### **[cherrymui](/cherrymui)** commented [Jul 15, 2024](#issuecomment-2229059089)

| As the CLs are in and the backports are done, is there anything else needed for this issue, or we can close this? Thanks. |
| --- |

 üëÄ
1
 s7v7nislands reacted with eyes emoji

All reactions

* üëÄ
  1 reaction

Sorry, something went wrong.

[![@neild](https://avatars.githubusercontent.com/u/52544?s=40&u=41bff20219d93918578944360c3930f30df4693b&v=4)](/neild)
[neild](/neild)
self-assigned this
[Jul 31, 2024](#event-13713104574)

[![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=40&u=be84be2341a1a28dc2ede61150f7ceaaf470b8ba&v=4)](/gopherbot)
[gopherbot](/gopherbot)
modified the milestones:
[Go1.23](/golang/go/milestone/212),
[Go1.24](/golang/go/milestone/322)
[Aug 13, 2024](#event-13866034398)

[![@rgoltz](https://avatars.githubusercontent.com/u/16392819?s=40&v=4)](/rgoltz)
[rgoltz](/rgoltz)
mentioned this issue
[Nov 24, 2024](#ref-issue-2640607519)

[Which version of Grafana in 10.x series and 11.x series has fix for these vulnerabilities.
grafana/grafana#96016](/grafana/grafana/issues/96016)

Open

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fgolang%2Fgo%2Fissues%2F67555)

Assignees

[![@neild](https://avatars.githubusercontent.com/u/52544?s=40&v=4)](/neild) [neild](/neild)

Labels

[NeedsInvestigation](/golang/go/labels/NeedsInvestigation)
Someone must examine and confirm this is a valid issue and not a duplicate of an existing one.

Projects

None yet

Milestone

 [**Go1.24**](/golang/go/milestone/322 "Go1.24")

Development

No branches or pull requests

6 participants

[![@neild](https://avatars.githubusercontent.com/u/52544?s=52&v=4)](/neild) [![@cagedmantis](https://avatars.githubusercontent.com/u/146817?s=52&v=4)](/cagedmantis) [![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=52&v=4)](/gopherbot) [![@thanm](https://avatars.githubusercontent.com/u/12280172?s=52&v=4)](/thanm) [![@cherrymui](https://avatars.githubusercontent.com/u/14119929?s=52&v=4)](/cherrymui) [![@864893031735973](https://avatars.githubusercontent.com/u/63679801?s=52&v=4)](/864893031735973)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.

