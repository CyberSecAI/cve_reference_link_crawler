=== Content from research.splunk.com_be45e69b_20250111_195711.html ===

[![Splunk Security Content Logo](https://research.splunk.com/images/logo.svg)](https://research.splunk.com/)

* [Analytic Stories](https://research.splunk.com/stories/)
* [Detections](https://research.splunk.com/detections/)
* [Playbooks](https://research.splunk.com/playbooks/)
* [Data Sources](https://research.splunk.com/sources/)
* [Blog](https://www.splunk.com/en_us/blog/author/secmrkt-research.html)
* [About](http://splunk.com/threat-research)
* [![GitHub Repo](https://research.splunk.com/images/GitHubMarkLight.svg)](https://github.com/splunk/security_content)

## Table of Contents

* + [Description](#description)
  + [Search](#search)
  + [Data Source](#data-source)
  + [Macros Used](#macros-used)
  + [Annotations](#annotations)
  + [Default Configuration](#default-configuration)
  + [Implementation](#implementation)
  + [Known False Positives](#known-false-positives)
  + [Associated Analytic Story](#associated-analytic-story)
  + [Risk Based Analytics (RBA)](#risk-based-analytics-rba)
  + [References](#references)
  + [Detection Testing](#detection-testing)

# Detection: Splunk Sensitive Information Disclosure in DEBUG Logging Channels

Updated Date: 2024-10-17
ID: 93dc7182-c5da-4085-82ec-401abf33d623
Author: Rod Soto, Eric McGinnis, Splunk
[Type: Hunting](#default-configuration)
[Product: Splunk Enterprise Security](https://www.splunk.com/en_us/products/enterprise-security.html)
### Description

In Splunk versions 9.3, 9.2, 9.1, 9.1.5 Applications which have been enabled with logging level DEBUG may write sensitive information such as keys, tokens, or other sensitive strings into the internal index.

### Search

```
1`splunkd` log_level="DEBUG" AND component IN ("REST_Calls", "AdminManager", "JSONWebToken")
2
3| stats count min(_time) as firstTime max(_time) as lastTime by host splunk_server log_level component event_message
4
5| `security_content_ctime(firstTime)`
6
7| `security_content_ctime(lastTime)`
8
9| `splunk_sensitive_information_disclosure_in_debug_logging_channels_filter`

```
### Data Source

| Name | Platform | Sourcetype | Source |
| --- | --- | --- | --- |
| [Splunk](/sources/d8a2c791-460b-4756-a8e5-ecade77b21e3) | Splunk icon [Splunk](/platform/splunk) | `'splunkd_ui_access'` | `'splunkd_ui_access.log'` |

### Macros Used

| Name | Value |
| --- | --- |
| [security\_content\_ctime](https://github.com/splunk/security_content/blob/develop/macros/security_content_ctime.yml) | `convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)` |
| splunk\_sensitive\_information\_disclosure\_in\_debug\_logging\_channels\_filter | `search *` |

`splunk_sensitive_information_disclosure_in_debug_logging_channels_filter` is an empty macro by default. It allows the user to filter out any results (false positives) without editing the SPL.
### Annotations

- MITRE ATT&CK

+ Kill Chain Phases

+ NIST

+ CIS

- Threat Actors

| ID | Technique | Tactic |
| --- | --- | --- |
| [T1552](https://attack.mitre.org/techniques/T1552/) | Unsecured Credentials | Credential Access |

KillChainPhase.EXPLOITAITON

NistCategory.DE\_AE

Cis18Value.CIS\_10

Volt Typhoon

### Default Configuration

This detection is configured by default in Splunk Enterprise Security to run with the following settings:

| Setting | Value |
| --- | --- |
| Disabled | true |
| Cron Schedule | `0 * * * *` |
| Earliest Time | `-70m@m` |
| Latest Time | `-10m@m` |
| Schedule Window | `auto` |
| Creates Risk Event | False |

This configuration file applies to all detections of type hunting.
### Implementation

Requires access to \_internal index. It is recommended to inventory and modify the search for specific apps that may have DEBUG logging enabled.

### Known False Positives

There will be false positives as not every message to the DEBUG log will expose sensitive information, such as keys or other secrets.

### Associated Analytic Story

* [Splunk Vulnerabilities](/stories/splunk_vulnerabilities/)

### Risk Based Analytics (RBA)

| Risk Message | Risk Score | Impact | Confidence |
| --- | --- | --- | --- |
| Possible sensitive credential information found via DEBUG logging in component $component$ at $host$ \_internal index | 45 | 50 | 90 |

The Risk Score is calculated by the following formula: Risk Score = (Impact \* Confidence/100). Initial Confidence and Impact is set by the analytic author.
### References

* <https://advisory.splunk.com/advisories/SVD-2024-0301>
* <https://advisory.splunk.com/advisories/SVD-2024-1008>
* <https://advisory.splunk.com/advisories/SVD-2024-1009>

### Detection Testing

| Test Type | Status | Dataset | Source | Sourcetype |
| --- | --- | --- | --- | --- |
| Validation | â [Passing](https://github.com/splunk/security_content/actions/workflows/build.yml) | N/A | N/A | N/A |
| Unit | â [Passing](https://github.com/splunk/security_content/actions/workflows/build.yml) | [Dataset](https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1654/splunk/jsonwebtokenplaintokensvd_splunkd.log) | `/opt/splunk/var/log/splunk/splunkd.log` | `splunkd` |
| Integration | â Passing | [Dataset](https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1654/splunk/jsonwebtokenplaintokensvd_splunkd.log) | `/opt/splunk/var/log/splunk/splunkd.log` | `splunkd` |

Replay any dataset to Splunk Enterprise by using our [`replay.py`](https://github.com/splunk/attack_data#using-replaypy) tool or the [UI](https://github.com/splunk/attack_data#using-ui).
Alternatively you can replay a dataset into a [Splunk Attack Range](https://github.com/splunk/attack_range#replay-dumps-into-attack-range-splunk-server)

---

Source: [GitHub](https://github.com/splunk/security_content/tree/develop/detections/application/splunk_sensitive_information_disclosure_in_debug_logging_channels.yml) |
Version: **2**

[Detection: Splunk risky Command Abuse disclosed february 2023](https://research.splunk.com/application/ee69374a-d27e-4136-adac-956a96ff60fd/ "Detection: Splunk risky Command Abuse disclosed february 2023")

[Detection: Splunk SG Information Disclosure for Low Privs User](https://research.splunk.com/application/0a3d6035-7bef-4dfa-b01e-84349edac3b4/ "Detection: Splunk SG Information Disclosure for Low Privs User")

Â© 2005 - 2024 Splunk LLC All rights reserved.



=== Content from advisory.splunk.com_49088479_20250111_195711.html ===
 [![ ](/assets/img/logo.svg)](https://www.splunk.com/)

* [Home](/)
* [Report a Vulnerability](/report)
* [FAQs](/faqs)
* [Mailing List](https://www.splunk.com/en_us/form/splunk-security-advisories-notification.html)

 Toggle menu

* [Home](/)
* [Report a Vulnerability](/report)
* [FAQs](/faqs)
* [Mailing List](https://www.splunk.com/en_us/form/splunk-security-advisories-notification.html)
# Sensitive information disclosure in REST\_Calls logging channel

**Advisory ID:** SVD-2024-1008

**CVE ID:** [CVE-2024-45738](https://www.cve.org/CVERecord?id=CVE-2024-45738)

**Published:** 2024-10-14

**Last Update:** 2024-10-14

**CVSSv3.1 Score:** 4.9, Medium

**CVSSv3.1 Vector:** [CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N)

**CWE:** [CWE-200](https://cwe.mitre.org/data/definitions/200.html)

**Bug ID:** VULN-15407

## Description

In Splunk Enterprise versions below 9.3.1, 9.2.3, and 9.1.6, the software potentially exposes sensitive HTTP parameters to the `_internal` index. This exposure could happen if you configure the Splunk Enterprise `REST_Calls` log channel at the DEBUG logging level.

The vulnerability would require either local access to the log files or administrative access to internal indexes, which by default only the admin role receives. Review roles and capabilities on your instance and restrict internal index access to administrator-level roles. See [Define roles on the Splunk platform with capabilities](https://docs.splunk.com/Documentation/Splunk/latest/Security/Rolesandcapabilities) in the Splunk documentation for more information.

## Solution

There are multiple solutions depending on how you have configured the Splunk Enterprise instance `REST_Calls` log channel.

First, determine whether or not debug logging is on for the `REST_Calls` log channel. You must log into the Splunk Enterprise instance as an admin user or equivalent to perform these actions.To determine the log channel logging mode on the instance:
   1. In a web browser, visit the Server Logging Settings page in Splunk Web at `/en-US/manager/system/server/logger`.
   2. Review the Logging Level column on the page that loads. If the `REST_Calls` row in this column shows DEBUG as the logging level, then the Splunk Enterprise REST\_Call log channel is in debug mode. Otherwise, it is not in debug mode.
See [Enable debug logging](https://docs.splunk.com/Documentation/Splunk/latest/Troubleshooting/Enabledebuglogging) for more information.

If the previous steps determine that debug logging is enabled in that log channel, then remedy the problem by performing the following tasks:
   1. Upgrade Splunk Enterprise to versions 9.3.1, 9.2.3, 9.1.6, or higher.
   2. Delete the following log file on the Splunk Enterprise instance: `$SPLUNK_HOME/var/log/splunk/splunkd.log`
   3. Delete all the Splunk Enterprise log file events for the `REST_Calls` component from the `_internal` index by running the following search command:
      `index=_internal component=REST_Calls | delete`

## Product Status

| Product | Version | Component | Affected Version | Fix Version |
| --- | --- | --- | --- | --- |
| Splunk Enterprise | 9.3 | splunkd | 9.3.0 | 9.3.1 |
| Splunk Enterprise | 9.2 | splunkd | 9.2.0 to 9.2.2 | 9.2.3 |
| Splunk Enterprise | 9.1 | splunkd | 9.1.0 to 9.1.5 | 9.1.6 |

## Mitigations and Workarounds

If it isn’t currently possible to upgrade to a fixed version of Splunk Enterprise, you can remedy the vulnerability by doing the following:
   1. Configure the `REST_Calls` log channel to a logging level that is less verbose than DEBUG.
   2. Delete the following log file on the Splunk Enterprise instance: `$SPLUNK_HOME/var/log/splunk/splunkd.log`
   3. Delete all of the Splunk Enterprise log file events for the `REST_Calls` component from the `_internal` index by running the following search command:
      `index=_internal component=REST_Calls | delete`

## Detections

* [Splunk Sensitive Information Disclosure in DEBUG Logging Channels](https://research.splunk.com/application/93dc7182-c5da-4085-82ec-401abf33d623/)

## Severity

Splunk rates this vulnerability as a 4.9, Medium, with a CVSSv3.1 vector of CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N.

## Acknowledgments

Eric McGinnis, Splunk

Rod Soto, Splunk

* Email
* [RSS Feed](/feed.xml)
* [Support](https://login.splunk.com/page/sso_redirect?type=portal)
© 2005 - 2025 Splunk Inc. All rights reserved.[Legal](https://www.splunk.com/en_us/legal.html)     [Privacy     [Website Terms of Use](https://www.splunk.com/en_us/legal/terms/terms-of-use.html)](https://www.splunk.com/en_us/legal/privacy/privacy-policy.html)
