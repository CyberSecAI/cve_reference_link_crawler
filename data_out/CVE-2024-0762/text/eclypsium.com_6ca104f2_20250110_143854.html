

  ![](https://px.ads.linkedin.com/collect/?pid=6584308&fmt=gif)

* Platform
  + [Supply Chain Security](https://eclypsium.com/platform/)
  + [Supply Chain Intelligence](https://eclypsium.com/platform/guide/)
* Solutions
  + [Solutions Overview](https://eclypsium.com/solutions/)
  + [Solutions](https://eclypsium.com/solutions/)
  + [Digital Supply Chain
     Security](https://eclypsium.com/solutions/digital-supply-chain-security/)
  + [Firmware Security
     for Enterprises](https://eclypsium.com/solutions/firmware-security-for-enterprises/)
  + [Regulatory Compliance](https://eclypsium.com/compliance/)
  + [Zero Trust
     for Endpoints](https://eclypsium.com/solutions/zero-trust-for-endpoints/)
* Resources
  + - [Resources Overview](https://eclypsium.com/resources/)
    - [Resources](https://eclypsium.com/resources/)
    - [Blog](https://eclypsium.com/blog/)
    - [Demos & Videos](https://eclypsium.com/demos-videos/)
    - [Events & Webinars](https://eclypsium.com/events/)
    - [Podcasts](https://eclypsium.com/podcasts/)
    - [WHITE PAPERS](https://eclypsium.com/resources/whitepapers/)
    - [SOLUTION BRIEFS](https://eclypsium.com/resources/solution-briefs/)
    - [CASE STUDIES](https://eclypsium.com/resources/case-studies/)
    - [THREAT REPORTS](https://eclypsium.com/threat-report/)
  + - [Newsletter](/newsletter)
    - [Support](https://eclypsium.zendesk.com/)
  + - ###### Latest Blogs

      [Blog](https://eclypsium.com/category/blog/), [RESEARCH](https://eclypsium.com/category/research/)
      #### [Genetic Engineering Meets Reverse Engineering: DNA Sequencer's Vulnerable BIOS](https://eclypsium.com/blog/genetic-engineering-meets-reverse-engineering-dna-sequencers-vulnerable-bios/)

      [Learn more](https://eclypsium.com/blog/genetic-engineering-meets-reverse-engineering-dna-sequencers-vulnerable-bios/)

      [Blog](https://eclypsium.com/category/blog/), [RESEARCH](https://eclypsium.com/category/research/)
      #### [BadRAM-ifications: A Low-Cost Attack on Trusted Execution Environments](https://eclypsium.com/blog/amd-badram/)

      [Learn more](https://eclypsium.com/blog/amd-badram/)
* [Research](https://eclypsium.com/research/)
* Company
  + [Company Overview](https://eclypsium.com/company/)
  + [Company](https://eclypsium.com/company/)
  + [Team](https://eclypsium.com/company/team/)
  + [Newsroom](https://eclypsium.com/company/newsroom/)
  + [Careers](https://eclypsium.com/company/careers/)
  + [Partners](https://eclypsium.com/company/partners/)
  + [Contact](https://eclypsium.com/company/contact/)

* [Get a demo](https://eclypsium.com/demo/)
* [Take a Tour](https://eclypsium.com/tour/)

* [Get a demo](https://eclypsium.com/demo/)
* [Take a Tour](https://eclypsium.com/tour/)

* Platform
  + [Supply Chain Security](https://eclypsium.com/platform/)
  + [Supply Chain Intelligence](https://eclypsium.com/platform/guide/)
* Solutions
  + [Solutions Overview](https://eclypsium.com/solutions/)
  + [Solutions](https://eclypsium.com/solutions/)
  + [Digital Supply Chain
     Security](https://eclypsium.com/solutions/digital-supply-chain-security/)
  + [Firmware Security
     for Enterprises](https://eclypsium.com/solutions/firmware-security-for-enterprises/)
  + [Regulatory Compliance](https://eclypsium.com/compliance/)
  + [Zero Trust
     for Endpoints](https://eclypsium.com/solutions/zero-trust-for-endpoints/)
* Resources
  + - [Resources Overview](https://eclypsium.com/resources/)
    - [Resources](https://eclypsium.com/resources/)
    - [Blog](https://eclypsium.com/blog/)
    - [Demos & Videos](https://eclypsium.com/demos-videos/)
    - [Events & Webinars](https://eclypsium.com/events/)
    - [Podcasts](https://eclypsium.com/podcasts/)
    - [WHITE PAPERS](https://eclypsium.com/resources/whitepapers/)
    - [SOLUTION BRIEFS](https://eclypsium.com/resources/solution-briefs/)
    - [CASE STUDIES](https://eclypsium.com/resources/case-studies/)
    - [THREAT REPORTS](https://eclypsium.com/threat-report/)
  + - [Newsletter](/newsletter)
    - [Support](https://eclypsium.zendesk.com/)
  + - ###### Latest Blogs

      [Blog](https://eclypsium.com/category/blog/), [RESEARCH](https://eclypsium.com/category/research/)
      #### [Genetic Engineering Meets Reverse Engineering: DNA Sequencer's Vulnerable BIOS](https://eclypsium.com/blog/genetic-engineering-meets-reverse-engineering-dna-sequencers-vulnerable-bios/)

      [Learn more](https://eclypsium.com/blog/genetic-engineering-meets-reverse-engineering-dna-sequencers-vulnerable-bios/)

      [Blog](https://eclypsium.com/category/blog/), [RESEARCH](https://eclypsium.com/category/research/)
      #### [BadRAM-ifications: A Low-Cost Attack on Trusted Execution Environments](https://eclypsium.com/blog/amd-badram/)

      [Learn more](https://eclypsium.com/blog/amd-badram/)
* [Research](https://eclypsium.com/research/)
* Company
  + [Company Overview](https://eclypsium.com/company/)
  + [Company](https://eclypsium.com/company/)
  + [Team](https://eclypsium.com/company/team/)
  + [Newsroom](https://eclypsium.com/company/newsroom/)
  + [Careers](https://eclypsium.com/company/careers/)
  + [Partners](https://eclypsium.com/company/partners/)
  + [Contact](https://eclypsium.com/company/contact/)

[Blog](https://eclypsium.com/category/blog/)
# UEFIcanhazbufferoverflow: Widespread Impact from Vulnerability in Popular PC and Server Firmware

By:
Eclypsium

June 20, 2024

![](https://eclypsium.com/wp-content/uploads/feature_image_phonuefi3.png)
## **Summary**

[Eclypsium Automata](https://eclypsium.com/blog/multiplying-security-research-how-eclypsium-automates-binary-analysis-at-scale/), our automated binary analysis system, has identified a high impact vulnerability ([CVE-2024-0762](https://www.cve.org/CVERecord?id=CVE-2024-0762) with a reported CVSS of 7.5) in the Phoenix SecureCore UEFI firmware that runs on multiple families of Intel Core desktop and mobile processors. The issue involves an unsafe variable in the Trusted Platform Module (TPM) configuration that could lead to a buffer overflow and potential malicious code execution. To be clear, this vulnerability lies in the UEFI code handling TPM configuration—in other words, it doesn’t matter if you have a security chip like a TPM if the underlying code is flawed.

We originally identified the vulnerability on the Lenovo ThinkPad X1 Carbon 7th Gen and X1 Yoga 4th Gen, both using the latest Lenovo BIOS updates. However, [Phoenix Technologies has subsequently acknowledged](https://www.phoenix.com/security-notifications/cve-2024-0762/) that the same issue applies to multiple versions of its SecureCore firmware that runs on Intel processor families including AlderLake, CoffeeLake, CometLake, IceLake, JasperLake, KabyLake, MeteorLake, RaptorLake, RocketLake, and TigerLake. These are Intel codenames for multiple generations of Intel Core mobile and desktop processors. Given that these Intel Core processors are used by a wide range of OEMs and ODMs, the same vulnerability could potentially affect a wide range of vendors and potentially hundreds of PC products that also use the Phoenix SecureCore UEFI firmware. The possibility of exploitation depends on the configuration and permission assigned to the TCG2\_CONFIGURATION variable, which could be different for every platform.

The vulnerability allows a local attacker to escalate privileges and gain code execution within the UEFI firmware during runtime. This type of low-level exploitation is typical of firmware backdoors (e.g. [BlackLotus](https://eclypsium.com/blog/blacklotus-a-threat-coming-to-a-system-near-you/)) that are increasingly observed in the wild. Such implants give attackers ongoing persistence within a device and often, the ability to evade higher-level security measures running in the operating system and software layers. Additionally, the manipulation of runtime code can make attacks harder to detect via various firmware measurements.

This disclosure has been closely coordinated with Phoenix Technologies and Lenovo PSIRT. Lenovo has published relevant BIOS updates at [Multi-vendor BIOS Security Vulnerabilities (May, 2024) – Lenovo Support US](https://support.lenovo.com/us/en/product_security/LEN-158632). Eclypsium customers can scan their devices to identify vulnerable assets in their environment. Customers should also refer to their relevant system manufacturer for guidance on affected devices and available updates.

![](https://eclypsium.com/wp-content/uploads/phonuefi_screen.png)
## **Key Background**

As the modern replacement for BIOS, UEFI is the all-important system firmware that controls how a device boots. UEFI also provides ongoing runtime management of the device below the OS via systems such as System Management Mode (SMM). As such UEFI is the first code to run and the most privileged on most any system.

These same traits have turned UEFI into a prime target for attackers with firmware implants and backdoors such as [BlackLotus](https://eclypsium.com/blog/blacklotus-a-threat-coming-to-a-system-near-you/), [CosmicStrand](https://eclypsium.com/blog/yet-another-uefi-bootkit-discovered-meet-cosmicstrand/), and [MosaicRegressor](https://eclypsium.com/threat-reports/mosaicregressor/) becoming increasingly common in the wild. These threats allow attackers to ensure that their malicious code can preempt and subvert the built-in protections and security tools that run in the OS and higher layers. This not only gives the attackers opportunity to cause damage, it also allows attackers to silently maintain persistence on a compromised device.

![](https://eclypsium.com/wp-content/uploads/feature_image_phonuefi4.png)

*Proposed inheritance pattern of the UEFIcanhazbufferoverflow vulnerability passed down to affected systems*

UEFI firmware also occupies a critical role in the technology supply chain. UEFI firmware development is a complex and specialized discipline and OEMs will often source their firmware from third-party firmware vendors. In this case, Lenovo licensed firmware from Phoenix Technologies, a well-respected and established firmware vendor. However, this also means that any vulnerabilities in an upstream supply-chain provider can potentially affect many different products and vendors. In this case, any manufacturer that uses [versions of Phoenix firmware named in the CVE](https://www.cve.org/CVERecord?id=CVE-2024-0762) could be affected.

## **Vulnerability Details**

This vulnerability was initially discovered by [Automata](https://eclypsium.com/blog/multiplying-security-research-how-eclypsium-automates-binary-analysis-at-scale/), Eclypsium’s automated binary analysis system. Automata leverages the collective intelligence and experience of Eclypsium researchers and applies those insights and techniques at scale for production systems. It is worth noting that this vulnerability is similar to other UEFI vulnerabilities in HP devices that we have also [recently reported on](https://eclypsium.com/blog/automata-in-action-new-vulnerabilities-discovered-in-hp-uefi/). However, these are distinct, separate vulnerabilities that were simply both discovered by Eclypsium Automata.

The vulnerability is related to the unsafe call to the GetVariable UEFI service.

Vulnerable module GUID: E6A7A1CE-5881-4B49-80BE-69C91811685C

There are two calls to GetVariable with the “TCG2\_CONFIGURATION” argument and the same DataSize, without adequate checks in between. If an attacker can modify the value of the “TCG2\_CONFIGURATION” UEFI variable at system run time, they can set it to a value long enough so that the first call to GetVariable returns EFI\_BUFFER\_TOO\_SMALL, and the data\_size is set to the length of the UEFI variable. The second call would succeed and overflow the buffer, leading to a stack buffer overflow.

```

void Function_0000537c(void){
...
  ulonglong data_size;
 char buffer [8];
...

 EVar1 = (*gRS_2->GetVariable)
                    ((CHAR16 *)TCG2_CONFIGURATION, &gTCG2_CONFIG_FORM_SET_GUID,
                     (UINT32 *)0x0, &data_size, buffer);
  if (EVar1 == EFI_BUFFER_TOO_SMALL) {
    EVar1 = (*gRS_2->GetVariable)
                      ((CHAR16 *)TCG2_CONFIGURATION,&gTCG2_CONFIG_FORM_SET_GUID,
                       (UINT32 *)0x0,&data_size,buffer)

```

Phoenix has assigned [CVE-2024-0762](https://nvd.nist.gov/vuln/detail/CVE-2024-0762) to the vulnerability and addressed it on May 14, 2024. The CVSS 3.1 score is reported as 7.5 High. (CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:C/C:H/I:H/A:H)

## **Mitigations**

As with other supply chain incidents, the first step of mitigation is to identify which devices are affected. Given that the vulnerability affects many Intel chipset families and Phoenix licenses firmware to many vendors, there are many potentially affected devices. As a result, Eclypsium customers are encouraged to scan their devices using the latest available version of the Eclypsium Platform, and search for any devices affected by CVE-2024-0762.

Once affected devices have been identified, customers should refer to the relevant vendor for firmware updates. At the time of writing, Lenovo has published the following firmware update:

* **Lenovo** – [Multi-vendor BIOS Security Vulnerabilities (May, 2024)](https://support.lenovo.com/us/en/product_security/LEN-158632)

## **Conclusion**

This vulnerability exemplifies two characteristic traits of IT infrastructure supply chain incidents—high impact and broad reach. UEFI firmware is some of the most high-value code on modern devices, and any compromise of that code can give attackers full control and persistence on the device. And since the vulnerable code stems from a major supply chain partner that licenses code to multiple OEM vendors, the issue can potentially affect many different products.

To prepare for these types of incidents, enterprises must be able to independently assess devices and components using commercial tools like Eclypsium. IT and Security teams need the ability to know which assets contain which components, if any of those components are vulnerable, and ultimately if the integrity of an asset has been compromised. Eclypsium Automata ensures this can be done continuously, comprehensively, and automatically for our customers.

Want to know if you’re affected? [Get in touch](https://eclypsium.com/demo/?utm_source=UEFIblog&utm_medium=website&utm_id=2024-UEFIbufferoverflow-blog) with us for a free scan of your infrastructure.

**Related resources**

* White paper – [*The Ultimate Guide to Supply Chain Security*](https://eclypsium.com/ultimate-guide-to-supply-chain-security/)
* Podcast – [Below-the-Surface #31, Managing Complex Digital Supply Chains with Cassie Crossley](https://eclypsium.com/podcasts/bts-31-managing-complex-digital-supply-chains-cassie-crossley/)
* Blog post – [Building Trust: The Role of Third-Party Assurance in IT Infrastructure Supply Chains](https://eclypsium.com/blog/building-trust-the-role-of-third-party-assurance-in-it-infrastructure-supply-chains/)

[Back to Blog](/blog)

Related Blogs

[View all](/blog)

 [![](https://eclypsium.com/wp-content/uploads/feature_image_dnasequencer.jpg)](https://eclypsium.com/blog/genetic-engineering-meets-reverse-engineering-dna-sequencers-vulnerable-bios/)

[Blog](https://eclypsium.com/category/blog/), [RESEARCH](https://eclypsium.com/category/research/)
#### [Genetic Engineering Meets Reverse Engineering: DNA Sequencer's Vulnerable BIOS](https://eclypsium.com/blog/genetic-engineering-meets-reverse-engineering-dna-sequencers-vulnerable-bios/)

[Read more](https://eclypsium.com/blog/genetic-engineering-meets-reverse-engineering-dna-sequencers-vulnerable-bios/)

 [![](https://eclypsium.com/wp-content/uploads/feature_image_badram.jpg)](https://eclypsium.com/blog/amd-badram/)

[Blog](https://eclypsium.com/category/blog/), [RESEARCH](https://eclypsium.com/category/research/)
#### [BadRAM-ifications: A Low-Cost Attack on Trusted Execution Environments](https://eclypsium.com/blog/amd-badram/)

[Read more](https://eclypsium.com/blog/amd-badram/)

 [![](https://eclypsium.com/wp-content/uploads/feature_image_typhoonapts.png)](https://eclypsium.com/blog/salt-typhoon/)

[Blog](https://eclypsium.com/category/blog/)
#### [Holding Back Salt Typhoon + Other Chinese APT CVEs](https://eclypsium.com/blog/salt-typhoon/)

[Read more](https://eclypsium.com/blog/salt-typhoon/)

 [![CISA and the FCC have issued new cyber security guidance for telecommunications carriers](https://eclypsium.com/wp-content/uploads/feature_image_cisafcchardening.jpg)](https://eclypsium.com/blog/fcc-cisa-communications-infrastructure-cyber-security/)

[Blog](https://eclypsium.com/category/blog/)
#### [CISA and FCC Issue Urgent Call for Cyber Hardening for Communications Infrastructure](https://eclypsium.com/blog/fcc-cisa-communications-infrastructure-cyber-security/)

[Read more](https://eclypsium.com/blog/fcc-cisa-communications-infrastructure-cyber-security/)

 [![Eclypsium | Supply Chain Security for the Modern Enterprise](https://eclypsium.com/wp-content/themes/eclypsium/assets/img/png/Eclypsium-logo-footer.png)](https://eclypsium.com)
[Get a Demo](https://eclypsium.com/demo/)
[Contact Us](https://eclypsium.com/company/contact/)
###### [Platform](https://eclypsium.com/platform/)

* Title
  + [Supply Chain Security](https://eclypsium.com/platform/)
  + [Supply Chain Intelligence](https://eclypsium.com/platform/guide/)

###### [Research](https://eclypsium.com/research/)

###### [Solutions](https://eclypsium.com/solutions/)

* Title
  + [Digital Supply Chain Security](https://eclypsium.com/solutions/digital-supply-chain-security/)
  + [Firmware Security for Enterprises](https://eclypsium.com/solutions/firmware-security-for-enterprises/)
  + [Simple Solutions for New Regulatory Challenges](https://eclypsium.com/compliance/)
  + [Zero Trust for Endpoints](https://eclypsium.com/solutions/zero-trust-for-endpoints/)
###### [Resources](https://eclypsium.com/resources/)

* [Title](https://eclypsium.com/resources/)
  + [Blog](/blog)
  + [Events](/events)
  + [Podcasts](/podcasts)
  + [White Papers](/whitepapers)
* Title
  + [Solution Briefs](/solution-briefs)
  + [THREAT REPORTS](https://eclypsium.com/category/threat-reports/)
  + [Newsletter](/newsletter)
###### [Company](https://eclypsium.com/company/)

* [Title](https://eclypsium.com/company/)
  + [Team](https://eclypsium.com/company/team/)
  + [Newsroom](https://eclypsium.com/company/newsroom/)
  + [Careers](https://eclypsium.com/company/careers/)
  + [Partners](https://eclypsium.com/company/partners/)
  + [Security](https://eclypsium.com/security/)
  + [Contact](https://eclypsium.com/company/contact/)

* [Linkedin](https://www.linkedin.com/company/eclypsium/ "Linkedin")
* [Youtube](https://www.youtube.com/%40Eclypsium "Youtube")
* [Twitter](https://twitter.com/eclypsium "Twitter")
* [Facebook](https://www.facebook.com/Eclypsium/ "Facebook")
© 2025 Eclypsium, Inc.
###### [Privacy Policy](/privacy-policy) | [Terms of Use](https://eclypsium.com/eula/) | [Sitemap](/sitemap)

![websights](https://ws.zoominfo.com/pixel/62631d72af23a00012552677)

