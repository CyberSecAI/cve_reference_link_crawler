

[Skip to content](#cve-2024-6409-openssh)

[![logo](../../assets/icon-white.svg)](../.. "SIG/Security Wiki")

SIG/Security Wiki

CVE-2024-6409: openssh

Initializing search

[security/wiki](https://git.resf.org/security/wiki "Go to repository")

[![logo](../../assets/icon-white.svg)](../.. "SIG/Security Wiki")
SIG/Security Wiki

[security/wiki](https://git.resf.org/security/wiki "Go to repository")

* [SIG/Security Wiki](../..)
* [News](../../news/)
* Issues

  Issues
  + [CVE-2023-23583: microcode\_ctl](../CVE-2023-23583/)
  + [CVE-2023-4911: glibc](../CVE-2023-4911/)
  + [CVE-2024-1086: kernel](../CVE-2024-1086/)
  + [CVE-2024-2961: glibc](../CVE-2024-2961/)
  + [CVE-2024-6387: openssh](../CVE-2024-6387/)
  + CVE-2024-6409: openssh

    [CVE-2024-6409: openssh](./)

    Table of contents
    - [Title](#title)
    - [Summary](#summary)
    - [EL9](#el9)
    - [EL8](#el8)
    - [Mitigation](#mitigation)
* Packages

  Packages
  + [Extra package: control](../../packages/control/)
  + [Override package: glibc](../../packages/glibc/)
  + [Extra package: hardened\_malloc](../../packages/hardened_malloc/)
  + [Extra package: lkrg](../../packages/lkrg/)
  + [Override package: microcode\_ctl](../../packages/microcode_ctl/)
  + [Override package: openssh](../../packages/openssh/)
  + [Extra package: passwdqc](../../packages/passwdqc/)

# CVE-2024-6409: openssh[¶](#cve-2024-6409-openssh "Permanent link")

## Title[¶](#title "Permanent link")

CVE-2024-6409: OpenSSH: Possible remote code execution in privsep child due to a race condition in signal handling

## Summary[¶](#summary "Permanent link")

As [discovered by Solar Designer (CIQ/Rocky Linux)](https://www.openwall.com/lists/oss-security/2024/07/08/2):

OpenSSH versions 8.7 and 8.8 and the corresponding portable releases call `cleanup_exit()` from `grace_alarm_handler()` when running in the privsep child process. `cleanup_exit()` was not meant to be called from a signal handler and may call other async-signal-unsafe functions. The current understanding is that in those upstream versions `cleanup_exit()` would not actually call async-signal-unsafe functions under those conditions, but with downstream distribution patches it sometimes does. Specifically, openssh-7.6p1-audit.patch found in Red Hat's package of OpenSSH adds code to `cleanup_exit()` that exposes the issue. Relevantly, this patch is found in EL 9, where the package is based on OpenSSH 8.7p1.

This is an EL9-specific issue similar to [CVE-2024-6387 regreSSHion](../CVE-2024-6387/).

Public disclosure date: July 8, 2024

## EL9[¶](#el9 "Permanent link")

* Fixed in version: `8.7p1-38.1.el9_4.security.0.7` available July 8, 2024

## EL8[¶](#el8 "Permanent link")

* Unaffected

## Mitigation[¶](#mitigation "Permanent link")

Set `LoginGraceTime 0` in `/etc/ssh/sshd_config` and do a `systemctl restart sshd`.

A drawback of this mitigation is that it will make the SSH server more susceptible to denial of service attacks.

July 8, 2024

Back to top

Copyright © 2023 Rocky Enterprise Software Foundation

Made with
[Material for MkDocs](https://squidfunk.github.io/mkdocs-material/)

