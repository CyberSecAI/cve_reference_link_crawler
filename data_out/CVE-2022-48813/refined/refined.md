The provided content relates to CVE-2022-48813.

**Root cause of vulnerability:**
The vulnerability arises from improper handling of the MDIO bus within the Felix VSC9959 switch driver in the Linux kernel. Specifically, the driver was using `devres` (device resources) to manage the MDIO bus, which could lead to a double-free scenario if the device was shutdown in certain circumstances.

**Weaknesses/vulnerabilities present:**
- **Double Free:** The core issue was a double-free vulnerability due to the usage of `devres` for both MDIO bus allocation and registration. When a device is shut down, `devres` would attempt to free the MDIO bus even if it was already unregistered. This could cause a kernel panic.
- **Improper Resource Management:** The driver was using `devm_mdiobus_alloc_size` for MDIO bus allocation and `devm_mdiobus_register` for registration, relying on `devres` to handle freeing. However, the driver also had manual unregistration logic (`mdiobus_unregister`). If the device shutdown sequence triggers a driver removal via device links, then `devres` would free an already unregistred bus. This is caused by the DSA master being on a bus that calls ->remove from ->shutdown.

**Impact of exploitation:**
The impact of this vulnerability is a kernel panic, leading to a denial of service.

**Attack vectors:**
The attack vector is triggered by the shutdown of a device that uses the Felix VSC9959 switch and its corresponding driver. In particular, if the DSA master itself is on a bus that calls `->remove` from `->shutdown` (e.g., dpaa2-eth on the fsl-mc bus), there's a device link between the switch and the DSA master that triggers the vulnerability.

**Required attacker capabilities/position:**
An attacker would need to trigger a specific device shutdown scenario in order to cause the double-free and kernel panic. The attacker would need some control over the device topology and shutdown processes to trigger this.