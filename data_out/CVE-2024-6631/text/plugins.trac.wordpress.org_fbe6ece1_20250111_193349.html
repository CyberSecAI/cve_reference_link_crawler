

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3119956%2Fimagerecycle-pdf-image-compression%2Ftags%2F3.1.15%2Fclass%2Fclass-image-otimizer.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/3031424/imagerecycle-pdf-image-compression/trunk/class/class-image-otimizer.php "Changeset 3031424 for imagerecycle-pdf-image-compression/tags/3.1.15/class/class-image-otimizer.php")
* Next Change →

---

# Changeset [3119956](/changeset/3119956 "Show full changeset") for [imagerecycle-pdf-image-compression/tags/3.1.15/class/class-image-otimizer.php](/browser/imagerecycle-pdf-image-compression/tags/3.1.15/class/class-image-otimizer.php?rev=3119956 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
07/17/2024 07:09:19 AM
([6 months](/timeline?from=2024-07-17T07%3A09%3A19Z&precision=second "See timeline at 07/17/2024 07:09:19 AM") ago)

Author:
ImageRecycle
Message:

Updating to version 3.1.15

Location:
[imagerecycle-pdf-image-compression/tags/3.1.15](/browser/imagerecycle-pdf-image-compression/tags/3.1.15?rev=3119956)
Files:

1 edited
1 copied

* [.](/browser/imagerecycle-pdf-image-compression/tags/3.1.15?rev=3119956 "Show entry in browser")
  (copied)
  *(copied from [imagerecycle-pdf-image-compression/trunk](/browser/imagerecycle-pdf-image-compression/trunk?rev=3068733 "Show original file (revision 3119955)"))*
* [class/class-image-otimizer.php](/browser/imagerecycle-pdf-image-compression/tags/3.1.15/class/class-image-otimizer.php?rev=3119956 "Show entry in browser")
  (modified)
  ([8 diffs](#file1 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [imagerecycle-pdf-image-compression/tags/3.1.15/class/class-image-otimizer.php](/changeset/3119956/imagerecycle-pdf-image-compression/tags/3.1.15/class/class-image-otimizer.php "Show the changeset 3119956 restricted to imagerecycle-pdf-image-compression/tags/3.1.15/class/class-image-otimizer.php")

  | [r3031424](/browser/imagerecycle-pdf-image-compression/trunk/class/class-image-otimizer.php?rev=3031424#L57 "Show revision 3031424 of this file in browser") | [r3119956](/browser/imagerecycle-pdf-image-compression/tags/3.1.15/class/class-image-otimizer.php?rev=3119956#L57 "Show revision 3119956 of this file in browser") |  |
  | --- | --- | --- |
  | 57 | 57 |  |
  | 58 | 58 | //process files during upload |
  | 59 |  | add\_filter('wp\_generate\_attachment\_metadata', array(&$this,'generateMetadata')); |
  |  | 59 | add\_filter('wp\_generate\_attachment\_metadata', array(&$this,'generateMetadata'), 99); |
  | 60 | 60 | add\_filter('wp\_handle\_upload', array(&$this,'addFileToQueue'));  //for pdf file |
  | 61 | 61 |  |
  | […](/browser/imagerecycle-pdf-image-compression/trunk/class/class-image-otimizer.php?rev=3031424#L403) | […](/browser/imagerecycle-pdf-image-compression/tags/3.1.15/class/class-image-otimizer.php?rev=3119956#L403) |  |
  | 403 | 403 | public function doActionUnqueued() |
  | 404 | 404 | { |
  |  | 405 | if (!current\_user\_can('edit\_posts')) { |
  |  | 406 | wp\_send\_json(array('status' => false, 'msg' => esc\_html\_\_('Not have permission!', 'wpio'))); |
  |  | 407 | } |
  | 405 | 408 | update\_option('wpio\_ao\_status', 0, false); |
  | 406 | 409 | $file = stripslashes($\_REQUEST['file']); |
  | […](/browser/imagerecycle-pdf-image-compression/trunk/class/class-image-otimizer.php?rev=3031424#L715) | […](/browser/imagerecycle-pdf-image-compression/tags/3.1.15/class/class-image-otimizer.php?rev=3119956#L718) |  |
  | 715 | 718 | public function countTotalImages() |
  | 716 | 719 | { |
  |  | 720 | if (!current\_user\_can('edit\_posts')) { |
  |  | 721 | wp\_send\_json(array('status' => false, 'msg' => esc\_html\_\_('Not have permission!', 'wpio'))); |
  |  | 722 | } |
  | 717 | 723 | require\_once 'filesystem.php'; |
  | 718 | 724 | $data = array(); |
  | […](/browser/imagerecycle-pdf-image-compression/trunk/class/class-image-otimizer.php?rev=3031424#L760) | […](/browser/imagerecycle-pdf-image-compression/tags/3.1.15/class/class-image-otimizer.php?rev=3119956#L766) |  |
  | 760 | 766 | public function scanImages() |
  | 761 | 767 | { |
  |  | 768 | if (!current\_user\_can('edit\_posts')) { |
  |  | 769 | wp\_send\_json(array('status' => false, 'msg' => esc\_html\_\_('Not have permission!', 'wpio'))); |
  |  | 770 | } |
  | 762 | 771 | require\_once 'filesystem.php'; |
  | 763 | 772 | $data = array(); |
  | […](/browser/imagerecycle-pdf-image-compression/trunk/class/class-image-otimizer.php?rev=3031424#L1412) | […](/browser/imagerecycle-pdf-image-compression/tags/3.1.15/class/class-image-otimizer.php?rev=3119956#L1421) |  |
  | 1412 | 1421 | public function doActionOptimize() |
  | 1413 | 1422 | { |
  |  | 1423 | if (!current\_user\_can('edit\_posts')) { |
  |  | 1424 | wp\_send\_json(array('status' => false, 'msg' => esc\_html\_\_('Not have permission!', 'wpio'))); |
  |  | 1425 | } |
  | 1414 | 1426 | $file = ABSPATH.$\_REQUEST['file']; |
  | 1415 | 1427 | $returned = $this->optimize($file); |
  | […](/browser/imagerecycle-pdf-image-compression/trunk/class/class-image-otimizer.php?rev=3031424#L1419) | […](/browser/imagerecycle-pdf-image-compression/tags/3.1.15/class/class-image-otimizer.php?rev=3119956#L1431) |  |
  | 1419 | 1431 | public function doActionOptimizeAll() |
  | 1420 | 1432 | { |
  |  | 1433 | if (!current\_user\_can('edit\_posts')) { |
  |  | 1434 | wp\_send\_json(array('status' => false, 'msg' => esc\_html\_\_('Not have permission!', 'wpio'))); |
  |  | 1435 | } |
  | 1421 | 1436 | $filters = array('optimized' => 'no'); |
  | 1422 | 1437 | $filters['onlyfile'] = 1; |
  | […](/browser/imagerecycle-pdf-image-compression/trunk/class/class-image-otimizer.php?rev=3031424#L1469) | […](/browser/imagerecycle-pdf-image-compression/tags/3.1.15/class/class-image-otimizer.php?rev=3119956#L1484) |  |
  | 1469 | 1484 | { |
  | 1470 | 1485 | global $wpdb; |
  | 1471 |  |  |
  |  | 1486 | if (!current\_user\_can('edit\_posts')) { |
  |  | 1487 | wp\_send\_json(array('status' => false, 'msg' => esc\_html\_\_('Not have permission!', 'wpio'))); |
  |  | 1488 | } |
  | 1472 | 1489 | $file = realpath(ABSPATH.$\_REQUEST['file']); |
  | 1473 | 1490 | $relativePath = DIRECTORY\_SEPARATOR.substr($file, strlen(ABSPATH)); |
  | […](/browser/imagerecycle-pdf-image-compression/trunk/class/class-image-otimizer.php?rev=3031424#L1626) | […](/browser/imagerecycle-pdf-image-compression/tags/3.1.15/class/class-image-otimizer.php?rev=3119956#L1643) |  |
  | 1626 | 1643 | public function saveNewAccountData() |
  | 1627 | 1644 | { |
  |  | 1645 | if (!current\_user\_can('manage\_options')) { |
  |  | 1646 | // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  |  | 1647 | wp\_send\_json(array('status' => false, 'msg' => esc\_html\_\_('Not have permission!', 'wpio'))); |
  |  | 1648 | } |
  | 1628 | 1649 | $key = $\_REQUEST['key']; |
  | 1629 | 1650 | $secret = $\_REQUEST['secret']; |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3119956)
* [Zip Archive](?format=zip&new=3119956)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

