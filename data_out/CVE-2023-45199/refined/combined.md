=== Content from mbed-tls.readthedocs.io_42a6710f_20250110_163312.html ===

[Mbed TLS](../../)

Contents

* [Getting Started](../../getting_started/)
* [API Reference](https://mbed-tls.readthedocs.io/projects/api)
* [Project](../../project/)
* [Reviews](../../reviews/)
* [Security Advisories](../)
  + [Buffer underrun in pkwrite when writing an opaque key pair](../mbedtls-security-advisory-2024-10-1/)
  + [Limited authentication bypass in TLS 1.3 optional client authentication](../mbedtls-security-advisory-2024-08-3/)
  + [Stack buffer overflow in ECDSA signature conversion functions](../mbedtls-security-advisory-2024-08-2/)
  + [CTR\_DRBG prioritized over HMAC\_DRBG as the PSA DRBG](../mbedtls-security-advisory-2024-08-1/)
  + [Insecure handling of shared memory in PSA Crypto APIs](../mbedtls-security-advisory-2024-03/)
  + [Buffer overflow in mbedtls\_x509\_set\_extension()](../mbedtls-security-advisory-2024-01-2/)
  + [Timing side channel in private key RSA operations.](../mbedtls-security-advisory-2024-01-1/)
  + Buffer overflow in TLS handshake parsing with ECDH
    - [Vulnerability](#vulnerability)
    - [Impact](#impact)
    - [Resolution](#resolution)
    - [Work-around](#work-around)
  + [Buffer overread in TLS stream cipher suites](../mbedtls-security-advisory-2023-10-1/)
  + [Buffer overread in DTLS ClientHello parsing](../mbedtls-security-advisory-2022-07/)
  + [Double Free in `mbedtls_ssl_set_session()` in an error case.](../mbedtls-security-advisory-2021-12/)
  + [Local side channel attack on static Diffie-Hellman with Montgomery curves](../mbedtls-security-advisory-2021-07-2/)
  + [Local side channel attack on RSA](../mbedtls-security-advisory-2021-07-1/)
  + [Protocol weakness in DHE-PSK key exchange](../mbedtls-security-advisory-2020-09-3/)
  + [Local side channel attack on RSA and static Diffie-Hellman](../mbedtls-security-advisory-2020-09-2/)
  + [Local side channel attack on classical CBC decryption in (D)TLS](../mbedtls-security-advisory-2020-09-1/)
  + [Side-channel attack on ECC key import and validation](../mbedtls-security-advisory-2020-07/)
  + [Side channel attack on ECDSA](../mbedtls-security-advisory-2020-04/)
  + [Cache attack against RSA key import in SGX](../mbedtls-security-advisory-2020-02/)
  + [Side channel attack on ECDSA](../mbedtls-security-advisory-2019-12/)
  + [Side channel attack on deterministic ECDSA](../mbedtls-security-advisory-2019-10/)
  + [Mbed TLS Security Advisory 2018-03](../mbedtls-security-advisory-2018-03/)
  + [Mbed TLS Security Advisory 2018-02](../mbedtls-security-advisory-2018-02/)
  + [mbed TLS Security Advisory 2018-01](../mbedtls-security-advisory-2018-01/)
  + [mbed TLS Security Advisory 2017-02](../mbedtls-security-advisory-2017-02/)
  + [mbed TLS Security Advisory 2017-01](../mbedtls-security-advisory-2017-01/)
  + [mbed TLS Security Advisory 2015-01](../mbedtls-security-advisory-2015-01/)
  + [PolarSSL Security Advisory 2014-04](../polarssl-security-advisory-2014-04/)
  + [PolarSSL Security Advisory 2014-03](../polarssl-security-advisory-2014-03-poodle-attack-on-ssl-v3/)
  + [PolarSSL Security Advisory 2014-02](../polarssl-security-advisory-2014-02/)
  + [PolarSSL Security Advisory 2014-01](../polarssl-security-advisory-2014-01/)
  + [PolarSSL Security Advisory 2013-05](../polarssl-security-advisory-2013-05/)
  + [PolarSSL Security Advisory 2013-04](../polarssl-security-advisory-2013-04/)
  + [PolarSSL Security Advisory 2013-03](../polarssl-security-advisory-2013-03/)
  + [PolarSSL Security Advisory 2013-02](../polarssl-security-advisory-2013-02/)
  + [PolarSSL Security Advisory 2013-01](../polarssl-security-advisory-2013-01/)
  + [PolarSSL Security Advisory 2012-01](../polarssl-security-advisory-2012-01/)
  + [PolarSSL Security Advisory 2011-02](../polarssl-security-advisory-2011-02/)
  + [PolarSSL Security Advisory 2011-01](../polarssl-security-advisory-2011-01/)
* [Contributing to This Documentation](../../CONTRIBUTING/)
* [Knowledge Base](../../kb/)

[Mbed TLS](../../)

* [Security Advisories](../)
* Buffer overflow in TLS handshake parsing with ECDH
* [View page source](../../_sources/security-advisories/mbedtls-security-advisory-2023-10-2.md.txt)

---

# Buffer overflow in TLS handshake parsing with ECDH[](#buffer-overflow-in-tls-handshake-parsing-with-ecdh "Permalink to this heading")

| **Title** | Buffer overflow in TLS handshake parsing with ECDH |
| --- | --- |
| **CVE** | CVE-2023-45199 |
| **Date** | 05 October 2023 |
| **Affects** | Mbed TLS 3.2.0 and above |
| **Impact** | A remote attacker may cause arbitrary code execution. |
| **Severity** | HIGH |
| **Credit** | OSS-Fuzz |

## Vulnerability[](#vulnerability "Permalink to this heading")

A TLS 1.3 client or server configured with support for signature-based authentication (i.e. any non-PSK key exchange) is vulnerable to a heap buffer overflow. The server copies up to 65535 bytes in a buffer that is shorter. An unauthenticated malicious peer can overflow the TLS handshake structure by sending an overly long ECDH or FFDH public key.

A TLS 1.2 server configured with `MBEDTLS_USE_PSA_CRYPTO` and with support for a cipher suite using ECDH and a signature is vulnerable to a heap buffer overflow. An unauthenticated malicious peer can overflow the TLS handshake structure by sending an overly long ECDH public key. The server copies up to 255 bytes into a heap buffer that is sized for a valid public key, and thus shorter unless RSA or FFDH is enabled in addition to ECDH. TLS 1.2 clients, and builds without `MBEDTLS_USE_PSA_CRYPTO` are not affected.

## Impact[](#impact "Permalink to this heading")

A malicious peer can overflow a buffer on the heap with attacker-controlled data. This can often be escalated to remote code execution.

## Resolution[](#resolution "Permalink to this heading")

Affected users will want to upgrade to Mbed TLS 3.5.0.

## Work-around[](#work-around "Permalink to this heading")

The default configuration is not affected. Mbed TLS 2.28 is not affected.

In TLS 1.2, builds that support RSA or FFDH with keys of size at least 2048 bits in addition to ECDH are not affected. Note that the TLS 1.3 stack remains affected in that case.

 [Previous](../mbedtls-security-advisory-2024-01-1/ "Timing side channel in private key RSA operations.")
[Next](../mbedtls-security-advisory-2023-10-1/ "Buffer overread in TLS stream cipher suites")

---

© Copyright The Mbed TLS Contributors.

Built with [Sphinx](https://www.sphinx-doc.org/) using a
[theme](https://github.com/readthedocs/sphinx_rtd_theme)
provided by [Read the Docs](https://readthedocs.org).


