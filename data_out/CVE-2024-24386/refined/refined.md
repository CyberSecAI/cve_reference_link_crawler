- **Root cause of vulnerability**: The Task Manager module in VitalPBX, when used with Cron Profiles, allows execution of scripts located in a specific directory. The vulnerability arises because the filename provided in the script field is directly used in the execution, without proper sanitization or validation.
- **Weaknesses/vulnerabilities present**:
    - **Command Injection**: By injecting a malicious script name containing shell commands, an attacker can achieve command injection when the script is executed by the Task Manager.
- **Impact of exploitation**:
    - **Remote Code Execution (RCE)**: Successful exploitation allows the attacker to execute arbitrary commands on the server with the privileges of the VitalPBX application. This can lead to a full system compromise.
    - **Privilege Escalation:** If an attacker compromises a low-privileged Tenant, they can potentially gain full access to the server and other tenants due to the RCE.
- **Attack vectors**:
    - **Web Interface**: The attacker needs access to the Task Manager module in VitalPBX's web interface.
    - **Malicious Script Placement**: The attacker needs to place a malicious script in `/var/lib/vitalpbx/scripts/`
- **Required attacker capabilities/position**:
    - **Authenticated User**: The attacker must be an authenticated user with access to the Task Manager module and Cron Profiles functionality.
    - **File System Access**: The attacker must be able to place a script within the `/var/lib/vitalpbx/scripts/` directory

The provided content contains a detailed explanation and proof-of-concept of the vulnerability, which is more detailed than a typical CVE description.