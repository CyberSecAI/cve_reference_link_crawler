=== Content from gist.github.com_ee653ac1_20250110_123512.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2FHouqiyuA%2F27879a6366a65fcd5f6c6fcbcf68d8e3)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2FHouqiyuA%2F27879a6366a65fcd5f6c6fcbcf68d8e3&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2FHouqiyuA%2F27879a6366a65fcd5f6c6fcbcf68d8e3) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2FHouqiyuA%2F27879a6366a65fcd5f6c6fcbcf68d8e3&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@HouqiyuA](https://avatars.githubusercontent.com/u/138644910?s=64&v=4)](/HouqiyuA)

# [HouqiyuA](/HouqiyuA)/**[gist:27879a6366a65fcd5f6c6fcbcf68d8e3](/HouqiyuA/27879a6366a65fcd5f6c6fcbcf68d8e3)** Secret

Created
July 23, 2024 16:01

Show Gist options

* [Download ZIP](/HouqiyuA/27879a6366a65fcd5f6c6fcbcf68d8e3/archive/71dac54f1e6ba75c4a6c667a76233cd85309fdc2.zip)

* [Star
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2FHouqiyuA%2F27879a6366a65fcd5f6c6fcbcf68d8e3)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2FHouqiyuA%2F27879a6366a65fcd5f6c6fcbcf68d8e3)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/HouqiyuA/27879a6366a65fcd5f6c6fcbcf68d8e3.js&quot;&gt;&lt;/script&gt;
* Save HouqiyuA/27879a6366a65fcd5f6c6fcbcf68d8e3 to your computer and use it in GitHub Desktop.

[Code](/HouqiyuA/27879a6366a65fcd5f6c6fcbcf68d8e3)
[Revisions
1](/HouqiyuA/27879a6366a65fcd5f6c6fcbcf68d8e3/revisions)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/HouqiyuA/27879a6366a65fcd5f6c6fcbcf68d8e3.js&quot;&gt;&lt;/script&gt;

Save HouqiyuA/27879a6366a65fcd5f6c6fcbcf68d8e3 to your computer and use it in GitHub Desktop.

[Download ZIP](/HouqiyuA/27879a6366a65fcd5f6c6fcbcf68d8e3/archive/71dac54f1e6ba75c4a6c667a76233cd85309fdc2.zip)

CVE-2024-36537 References

 [Raw](/HouqiyuA/27879a6366a65fcd5f6c6fcbcf68d8e3/raw/71dac54f1e6ba75c4a6c667a76233cd85309fdc2/gistfile1.txt)

[**gistfile1.txt**](#file-gistfile1-txt)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | [Description]: |
| --- | --- |
|  | Insecure permissions in cert-manager v1.14.4 and earlier versions allows attackers to access sensitive data and escalate privileges by obtaining the service account's token. |
|  |  |
|  | [Vulnerability Type]: |
|  | Incorrect Access Control |
|  |  |
|  | [Vendor of Product]: |
|  | https://github.com/cert-manager/cert-manager |
|  |  |
|  | [Affected Product Code Base]: |
|  | cert-manager - <=v1.14.4 |
|  |  |
|  | [Affected Component]: |
|  | Directly compromise all Secrets components in k8s, further compromise other components in the cluster or even take over the entire kubernetes cluster. |
|  |  |
|  | [Attack Vectors]: |
|  | 1. the attacker stole the token. |
|  | Here is an example of stealing a token：in cncf, there is a project named hwameistor, and the DaemonSet hwameistor-local-disk-manager for that project has a cluster role named hwameistor-admin, which has the `update/patch` verb of `nodes` resource.If a malicious user takes control of a worker node, by default the "hwameistor-local-disk-manager" pod will run on that node and he/she can use that pod to patch/update other nodes and force cert-manager’s pod to run on the malicious worker node. Then, he/she can stole the token. |
|  | 2. Use the obtained token information to authenticate with the API Server. By including the token in the request, attacker can be recognized as a legitimate user with the ServiceAccount and gain all privileges associated with the ServiceAccount. |
|  | 3. Use the privileges to access all Secrets in the cluster. |
|  | 4. Use the sensitive information in the Secrets to elevate privileges and explore other sensitive resources, and eventually take over the entire cluster. |
|  | [PoC]: |
|  | https://github.com/HouqiyuA/k8s-rbac-poc |

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2FHouqiyuA%2F27879a6366a65fcd5f6c6fcbcf68d8e3)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


