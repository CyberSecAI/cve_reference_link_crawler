- **Root cause of vulnerability:** The `ebtables` command, when used with `ebtables-nft` on certain operating systems, incorrectly reverts the default policy of a newly created chain from `DROP` to `RETURN` after flushing the existing rules. This occurs because `ebtables-nft` does not behave the same as the legacy `ebtables` binary.
- **Weaknesses/vulnerabilities present:** The vulnerability lies in the way `neutron-linuxbridge-agent` creates and manages `ebtables` chains for ARP spoofing protection. The intended behavior is to create a chain with a default `DROP` policy and then add specific rules to allow legitimate ARP traffic. When the default policy reverts to `RETURN`, it bypasses the intended filter and permits spoofed ARP packets to pass.
- **Impact of exploitation:** An attacker within the same network segment could perform ARP spoofing to redirect network traffic, potentially leading to a denial of service (DoS) attack against another user's virtual machine, or perform man-in-the-middle attacks.
- **Attack vectors:** An attacker needs to be on the same L2 network as the victim VM, meaning they need to be on the same broadcast domain.
- **Required attacker capabilities/position:** The attacker must have the ability to send network traffic on the same L2 network as the victim and be able to send malicious ARP packets.