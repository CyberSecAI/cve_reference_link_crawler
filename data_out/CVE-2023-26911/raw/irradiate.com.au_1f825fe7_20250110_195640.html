<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta property="og:image" content="https://irradiate.com.au/assets/irradiate-icon-black.jpg"/><meta property="og:image:alt" content="Irradiate Security Icon"/><meta property="og:image:width" content="500"/><meta property="og:image:height" content="500"/><meta property="og:locale" content="en_AU"/><title>Unquoted Service Path in Asus Armoury Crate (CVE-2023-26911) - Irradiate Security</title><meta name="robots" content="index,follow"/><meta name="description" content="A deep dive into an unquoted service path vulnerability in Asus Armoury Crate software and the persisting relevance of proper path quoting as a vital secure coding practice on Windows platforms."/><meta property="og:title" content="Unquoted Service Path in Asus Armoury Crate (CVE-2023-26911) | Irradiate Security"/><meta property="og:description" content="A deep dive into an unquoted service path vulnerability in Asus Armoury Crate software and the persisting relevance of proper path quoting as a vital secure coding practice on Windows platforms."/><meta property="og:url" content="https://irradiate.com.au/blog/CVE-2023-26911"/><meta property="og:type" content="article"/><meta property="article:published_time" content="2023-07-04"/><meta property="article:tag" content="Zero Day"/><meta property="article:tag" content="ASUS"/><meta property="og:site_name" content="Irradiate Security"/><meta name="next-head-count" content="18"/><link data-next-font="" rel="preconnect" href="/" crossorigin="anonymous"/><link rel="preload" href="/_next/static/css/c67410a198129559.css" as="style"/><link rel="stylesheet" href="/_next/static/css/c67410a198129559.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-6c4aa9394a53d058.js" defer=""></script><script src="/_next/static/chunks/framework-49c6cecf1f6d5795.js" defer=""></script><script src="/_next/static/chunks/main-2937419eca1f2975.js" defer=""></script><script src="/_next/static/chunks/pages/_app-2b37e2431f3cd134.js" defer=""></script><script src="/_next/static/chunks/175675d1-48b4f93cdbebc7f4.js" defer=""></script><script src="/_next/static/chunks/1bfc9850-00d82af3906a5ef8.js" defer=""></script><script src="/_next/static/chunks/664-d254d21a6fe56bff.js" defer=""></script><script src="/_next/static/chunks/885-930346de9ad006a5.js" defer=""></script><script src="/_next/static/chunks/676-8a913a0c6948fe82.js" defer=""></script><script src="/_next/static/chunks/288-589694512b997d70.js" defer=""></script><script src="/_next/static/chunks/570-af2366dad3068e2f.js" defer=""></script><script src="/_next/static/chunks/425-5a2d3457a2265e2d.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5Bid%5D-ff1c1de42cdeb563.js" defer=""></script><script src="/_next/static/whoh_H9-mwKe_6ow6ygVo/_buildManifest.js" defer=""></script><script src="/_next/static/whoh_H9-mwKe_6ow6ygVo/_ssgManifest.js" defer=""></script></head><title>Irradiate Security</title><link rel="icon" href="/irradiate_icon.svg" type="image/svg+xml"/><body><div id="__next"><script>!function(){try{var d=document.documentElement,c=d.classList;c.remove('light','dark');var e=localStorage.getItem('theme');if('system'===e||(!e&&false)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';c.add('dark')}else{d.style.colorScheme = 'light';c.add('light')}}else if(e){c.add(e|| '')}else{c.add('light')}if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'light'}catch(e){}}()</script><div class="Toastify"></div><div class="sticky top-0 z-50 bg-white dark:bg-[#1d1d1d] shadow-sm isolate py-2 backdrop-blur-lg bg-opacity-80 dark:bg-opacity-80"><div class="px-6 pt-6 lg:px-8"><nav class="flex items-center justify-between" aria-label="Global"><div class="flex lg:flex-1"><a class="-m-2.5 p-2.5" href="/"><span class="sr-only">Irradiate Security</span><img class="h-10" src="/assets/irradiate-icon-black.png" alt="Irradiate Security Icon"/></a></div><div class="flex lg:hidden"><div class="hamburger-react" aria-expanded="false" role="button" style="cursor:pointer;height:48px;position:relative;transition:0.4s ease-in;user-select:none;width:48px;outline:none" tabindex="0"><div style="background:currentColor;height:2px;left:12px;position:absolute;border-radius:9em;width:25px;top:15px;transition:0.4s ease-in;transform:none"></div><div style="background:currentColor;height:2px;left:12px;position:absolute;border-radius:9em;width:25px;top:23px;transition:0.2s ease-in;transform:none"></div><div style="background:currentColor;height:2px;left:12px;position:absolute;border-radius:9em;width:25px;top:31px;transition:0.4s ease-in;transform:none"></div></div></div><div class="hidden lg:flex lg:gap-x-12"><a class="text-base font-medium leading-6 text-gray-900 dark:text-zinc-100 transition-colors duration-600 hover:text-emerald-600 dark:hover:text-emerald-600" href="/">Home</a><a class="text-base font-medium leading-6 text-gray-900 dark:text-zinc-100 transition-colors duration-600 hover:text-emerald-600 dark:hover:text-emerald-600" href="/about">About</a><a class="text-base font-medium leading-6 text-gray-900 dark:text-zinc-100 transition-colors duration-600 hover:text-emerald-600 dark:hover:text-emerald-600" href="/services">Services</a><a class="text-base font-medium leading-6 text-gray-900 dark:text-zinc-100 transition-colors duration-600 hover:text-emerald-600 dark:hover:text-emerald-600" href="/contact">Contact</a><a class="text-base font-medium leading-6 text-gray-900 dark:text-zinc-100 transition-colors duration-600 hover:text-emerald-600 dark:hover:text-emerald-600" href="/blog">Blog</a></div><div class="hidden lg:flex lg:flex-1 lg:justify-end"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" color="black" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" style="cursor:pointer;transform:rotate(90deg)"><mask id="circle-mask-0"><rect x="0" y="0" width="100%" height="100%" fill="white"></rect><circle style="cx:100%;cy:0%" r="9" fill="black"></circle></mask><circle cx="12" cy="12" fill="black" style="r:5px" mask="url(#circle-mask-0)"></circle><g stroke="currentColor" style="opacity:1"><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></g></svg></div></nav><div hidden="" style="position:fixed;top:1px;left:1px;width:1px;height:0;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0;display:none"></div></div></div><main><nav class="flex items-center justify-end px-7 pt-6" aria-label="Breadcrumb"><ol class="inline-flex items-center space-x-1 md:space-x-3"><li class="inline-flex items-center"><a class="inline-flex items-center text-sm font-medium text-gray-700 hover:text-green-600 dark:text-gray-400 dark:hover:text-white" href="/"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="w-4 h-4 mr-2"><path d="M11.47 3.841a.75.75 0 0 1 1.06 0l8.69 8.69a.75.75 0 1 0 1.06-1.061l-8.689-8.69a2.25 2.25 0 0 0-3.182 0l-8.69 8.69a.75.75 0 1 0 1.061 1.06l8.69-8.689Z"></path><path d="m12 5.432 8.159 8.159c.03.03.06.058.091.086v6.198c0 1.035-.84 1.875-1.875 1.875H15a.75.75 0 0 1-.75-.75v-4.5a.75.75 0 0 0-.75-.75h-3a.75.75 0 0 0-.75.75V21a.75.75 0 0 1-.75.75H5.625a1.875 1.875 0 0 1-1.875-1.875v-6.198a2.29 2.29 0 0 0 .091-.086L12 5.432Z"></path></svg>Home</a></li><li><div class="flex items-center"><svg aria-hidden="true" class="w-6 h-6 text-gray-400" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg><a class="ml-1 text-sm font-medium text-gray-500 md:ml-2 hover:text-green-600 dark:hover:text-white dark:text-gray-400" href="/blog">Blog</a></div></li><li aria-current="page"><div class="flex items-center"><svg aria-hidden="true" class="w-6 h-6 text-gray-400" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg><span class="ml-1 text-sm font-medium text-gray-500 md:ml-2">Unquoted Service Path in Asus Armoury Crate (CVE-2023-26911)</span></div></li></ol></nav><div class="grid grid-cols-1 gap-4"><div class="col-span-1"><article class="bg-white dark:bg-[#1d1d1d] max-w-4xl mx-auto py-16 px-4 sm:max-w-xl md:max-w-full lg:max-w-screen-xl md:px-24 lg:px-8"><dd class="text-base font-medium leading-6 text-gray-500 text-center py-6 dark:text-gray-400"><time dateTime="2023-07-04">July 04, 2023</time></dd><h1 class="mb-4 font-sans text-3xl sm:text-4xl md:text-5xl font-black text-gray-900 dark:text-zinc-100 sm:leading-normal text-center">Unquoted Service Path in Asus Armoury Crate (CVE-2023-26911)</h1><div class="text-base font-medium leading-2 text-gray-500 text-center py-2 dark:text-gray-400"><span style="display:inline-flex;align-items:center"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" style="margin-right:5px" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm0 448c-110.5 0-200-89.5-200-200S145.5 56 256 56s200 89.5 200 200-89.5 200-200 200zm61.8-104.4l-84.9-61.7c-3.1-2.3-4.9-5.9-4.9-9.7V116c0-6.6 5.4-12 12-12h32c6.6 0 12 5.4 12 12v141.7l66.8 48.6c5.4 3.9 6.5 11.4 2.6 16.8L334.6 349c-3.9 5.3-11.4 6.5-16.8 2.6z"></path></svg>4 min read</span></div><hr class="w-full my-8 border-gray-100 dark:border-zinc-700 content-center"/><div class="px-4 text-base text-gray-700 dark:text-zinc-100 md:text-lg lg:text-[15px]"><p class="mb-4">During a recent engagement, our team discovered a local privilege escalation vulnerability in Asus&#x27; Armoury Crate software (version 5.3.4.0 and earlier). The vulnerability stems from an unquoted service path in the SetupAsusServices module (version 1.0.5.1 and earlier) that Asus distributes with the software.</p>
<p class="mb-4">When started on a Windows operating system, SetupAsusServices attempts to access several locations on the local C drive. This is due to the default behaviour of Windows when presented with file paths containing spaces. These locations were:</p>
<pre><pre class="language-none"><code>C:\
C:\Program Files\
C:\Program Files\ASUS\
</code></pre></pre>
<p class="mb-4">This results in &quot;NAME NOT FOUND&quot; errors as shown below:</p>
<p class="mb-4"><div style="display:flex;justify-content:center;align-items:center;margin:15px"><img alt="img" loading="lazy" width="500" height="300" decoding="async" data-nimg="1" style="color:transparent;width:70%;height:70%" srcSet="/_next/image?url=%2Fassets%2Fcve-2023-26911%2Ffig1.png&amp;w=640&amp;q=75 1x, /_next/image?url=%2Fassets%2Fcve-2023-26911%2Ffig1.png&amp;w=1080&amp;q=75 2x" src="/_next/image?url=%2Fassets%2Fcve-2023-26911%2Ffig1.png&amp;w=1080&amp;q=75"/></div></p>
<p class="mb-4">This behaviour can be exploited by a local attacker as long as they have write access to these locations. By placing a malicious executable in the requested path, it will be executed by the launched service with the privilege level of the application, which by default is system. Our team managed to exploit this vulnerability by placing a file named <code class="undefined p-1 bg-gray-100 rounded dark:bg-zinc-800 text-sm font-semibold text-red-500 dark:text-red-400">ARMOURY.exe</code> in <code class="undefined p-1 bg-gray-100 rounded dark:bg-zinc-800 text-sm font-semibold text-red-500 dark:text-red-400">C:\Program Files\ASUS\</code>, this granted our user elevated privileges after a system restart.</p>
<p class="mb-4">The service runs as an authenticated user with high integrity, enabling any malicious code to execute with powerful system privileges if successfully exploited. While local access is required, this poses a serious risk if chained with other vulnerabilities.</p>
<p class="mb-4">After responsibly disclosing this issue to ASUS, they promptly evaluated and patched the vulnerability in Armoury Crate by releasing version 5.3.4.0. This newer version mitigates the vulnerability by enclosing the file path with quotes, which prevents the iterative execution behaviour of Windows.  We appreciate ASUS taking quick action patching this issue after our inital disclosure.</p>
<h1 level="1" class="text-xl font-extrabold text-2xl text-gray-900 tracking-tight dark:text-zinc-100 py-3">Is unquoted service path still relevant?</h1>
<p class="mb-4">Unquoted service path vulnerabilities have been a known issue for over a decade but continue to appear in new software, demonstrating the persisting relevance of this vulnerability class.</p>
<p class="mb-4">An unquoted service path contains spaces but lacks quotation marks around the full path. This allows a local attacker with write access to somewhere along the affected path to insert a malicious executable file that will be run unintentionally by the vulnerable service.</p>
<p class="mb-4">The core issue stems from how Windows handles spaces in path names. By default, Windows uses spaces as delimiters to separate folder/file names in a path string. For example, consider the path:</p>
<p class="mb-4"><code class="undefined p-1 bg-gray-100 rounded dark:bg-zinc-800 text-sm font-semibold text-red-500 dark:text-red-400">C:\My Folder\MyProgram.exe</code></p>
<p class="mb-4">Windows will interpret this as:</p>
<ul depth="0">
<li index="0" class="list-disc ml-5 mb-2"><code class="undefined p-1 bg-gray-100 rounded dark:bg-zinc-800 text-sm font-semibold text-red-500 dark:text-red-400">C:\My</code></li>
<li index="1" class="list-disc ml-5 mb-2"><code class="undefined p-1 bg-gray-100 rounded dark:bg-zinc-800 text-sm font-semibold text-red-500 dark:text-red-400">Folder\MyProgram.exe</code></li>
</ul><div class="mt-3"></div>
<p class="mb-4">It sees <code class="undefined p-1 bg-gray-100 rounded dark:bg-zinc-800 text-sm font-semibold text-red-500 dark:text-red-400">My</code> and <code class="undefined p-1 bg-gray-100 rounded dark:bg-zinc-800 text-sm font-semibold text-red-500 dark:text-red-400">Folder</code> as separate folder names because they are separated by a space. This causes problems when the space is intended to be part of the folder name <code class="undefined p-1 bg-gray-100 rounded dark:bg-zinc-800 text-sm font-semibold text-red-500 dark:text-red-400">My Folder</code> rather than a delimiter.</p>
<p class="mb-4">On Windows systems, the operating system searches folders within an unquoted path and executes the first matching executable it finds. By placing a malicious executable first in the path, an attacker can exploit this behavior to escalate privileges when the service starts.</p>
<p class="mb-4">While simple to fix by properly quoting the path, many developers still overlook this crucial secure coding practice. Unquoted service path allow attackers to trivially bypass system permissions and controls. The prevalence of this issue in modern software highlights the need for continued education on properly handling path names in Windows services.</p>
<h1 level="1" class="text-xl font-extrabold text-2xl text-gray-900 tracking-tight dark:text-zinc-100 py-3">Best Practices to Resolve Unquoted Service Path</h1>
<p class="mb-4">To mitigate the risk of unquoted service path vulnerabilities, developers should adhere to the following best practices:</p>
<ul depth="0">
<li index="0" class="list-disc ml-5 mb-2">
<p class="mb-4">Always use quotes around service path: This is the most straightforward solution to the problem. By enclosing service path in quotes, you prevent the system from misinterpreting spaces as delimiters.</p>
</li>
<li index="1" class="list-disc ml-5 mb-2">
<p class="mb-4">Implement least privilege principle: Limit the privileges of your applications and services to only what they need to function.</p>
</li>
</ul><div class="mt-3"></div>
<p class="mb-4">Consider the following vulnerable service code:</p>
<pre><pre class="language-none"><code>void ServiceMain(int argc, char** argv) {

  char path[] = &quot;C:\\Program Files\\MyService\\&quot;;
  
  SetCurrentDirectory(path);
  
  system(&quot;MyService.exe&quot;);

}
</code></pre></pre>
<p class="mb-4">In the above code, the path passed to <code class="undefined p-1 bg-gray-100 rounded dark:bg-zinc-800 text-sm font-semibold text-red-500 dark:text-red-400">SetCurrentDirectory()</code> is unquoted. This allows an attacker to place a malicious executable in <code class="undefined p-1 bg-gray-100 rounded dark:bg-zinc-800 text-sm font-semibold text-red-500 dark:text-red-400">C:\Program Files\</code> that will run instead of MyService.exe.</p>
<p class="mb-4">Here is the fixed code:</p>
<pre><pre class="language-none"><code>void ServiceMain(int argc, char** argv) {

  char path[] = &quot;\&quot;C:\\Program Files\\MyService\\\&quot;&quot;;
   
  SetCurrentDirectory(path);
   
  system(&quot;MyService.exe&quot;);

}
</code></pre></pre>
<p class="mb-4">By quoting the path, the service will correctly run MyService.exe as intended.</p>
<p class="mb-4">Quoting service path helps mitigate unquoted path vulnerabilities by ensuring the correct executables are called. It is a simple but critical secure coding practice on Windows platforms.</p>
<h1 level="1" class="text-xl font-extrabold text-2xl text-gray-900 tracking-tight dark:text-zinc-100 py-3">Responsible Disclosure Timeline</h1>
<ul depth="0">
<li index="0" class="list-disc ml-5 mb-2">November 29, 2022: Reported vulnerability to ASUS.</li>
<li index="1" class="list-disc ml-5 mb-2">December 12, 2022: ASUS security team confirms presence of vulnerability, noted that it will be fixed before the end of December.</li>
<li index="2" class="list-disc ml-5 mb-2">January 18, 2023: ASUS updated the release patch date to 30 January 2023</li>
<li index="3" class="list-disc ml-5 mb-2">January 31, 2023: Asus releases Armoury Crate new version resolving unquoted path vulnerability.</li>
</ul><div class="mt-3"></div></div><div class="flex justify-between mx-4 my-4 mt-8"><div class="mr-4"></div><div class="ml-4"><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Next Post</h2><div class="text-emerald-600 hover:text-emerald-700 break-words"><a href="/blog/developing-risk-mitigation-strategy-for-ai-based-windows-search-case-study">Developing a Risk Mitigation Strategy for AI-Based Microsoft Search - A Case Study</a></div></div></div></article></div></div></main><div class="bg-white dark:bg-[#1d1d1d]"><div class="px-4 pt-16 mx-auto sm:max-w-xl md:max-w-full lg:max-w-screen-xl md:px-24 lg:px-8"><div class="grid gap-10 row-gap-6 mb-8 sm:grid-cols-2 lg:grid-cols-4"><div class="sm:col-span-2"><a aria-label="Go home" title="Company" class="inline-flex items-center" href="/"><img src="/assets/irradiate-icon-black.png" class="h-[40px] mr-7" alt="Irradiate Security Icon"/></a><div class="mt-3 lg:max-w-sm text-gray-800 dark:text-zinc-100"><p class="text-sm ">We are based in Canberra, Australia, on the traditional lands of the Ngunnawal people.</p><p class="mt-3 text-sm">We recognize and honour the traditional custodians of this land and extend our respects to Elders past, present, and emerging.</p></div></div><div class="space-y-2 text-sm"><p class="text-base font-bold tracking-wide text-gray-900 dark:text-zinc-100">Sitemap</p><div class="flex"><ul class="mr-1 text-gray-800"><li><a class="text-sm text-gray-600 transition-colors duration-300 hover:text-emerald-600 dark:text-zinc-100 dark:hover:text-emerald-600" href="/">Home</a></li></ul></div><div class="flex"><ul class="mr-1 text-gray-800"><li><a class="text-sm text-gray-600 transition-colors duration-300 hover:text-emerald-600 dark:text-zinc-100 dark:hover:text-emerald-600" href="/about">About</a></li></ul></div><div class="flex"><ul class="mr-1 text-gray-800"><li><a class="text-sm text-gray-600 transition-colors duration-300 hover:text-emerald-600 dark:text-zinc-100 dark:hover:text-emerald-600" href="/services">Services</a></li></ul></div><div class="flex"><ul class="mr-1 text-gray-800"><li><a class="text-sm text-gray-600 transition-colors duration-300 hover:text-emerald-600 dark:text-zinc-100 dark:hover:text-emerald-600" href="/contact">Contact Us</a></li></ul></div><div class="flex"><ul class="mr-1 text-gray-800"><li><a class="text-sm text-gray-600 transition-colors duration-300 hover:text-emerald-600 dark:text-zinc-100 dark:hover:text-emerald-600" href="/blog">Blog</a></li></ul></div></div><div><span class="text-base font-bold tracking-wide text-gray-900 dark:text-zinc-100">Social</span><div class="flex items-center mt-1 space-x-3 "><a class="text-gray-500 transition-colors duration-300 hover:text-emerald-600 mt-2" href="https://www.linkedin.com/company/irradiate-security"><svg width="24px" height="24px" viewBox="0 0 24 24" role="img" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><title>LinkedIn icon</title><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg></a></div></div></div><div class="flex flex-col-reverse justify-between pt-5 pb-10 border-t border-gray-100 dark:border-gray-700/80 lg:flex-row"><p class="text-sm text-gray-600 dark:text-zinc-100">Copyright ©  2024 Irradiate Security. All rights reserved.</p><ul class="flex flex-col mb-3 space-y-2 lg:mb-0 sm:space-y-0 sm:space-x-5 sm:flex-row"><li><a class="text-sm text-gray-500 dark:text-zinc-100 hover:text-emerald-600 dark:hover:text-emerald-600" href="/privacy">Privacy Policy</a></li><li><a class="text-sm text-gray-500 dark:text-zinc-100 hover:text-emerald-600 dark:hover:text-emerald-600" href="/accessibility">Accessibility</a></li></ul></div></div></div><div style="position:fixed;bottom:20px;left:20px;width:400px;box-shadow:0 0 30px rgba(0, 0, 0, 0.3);padding-bottom:65px;opacity:0;transition:opacity 1.5s ease-in-out" class="p-4 bg-white text-black rounded-lg flex flex-col justify-between items-start"><h2 class="text-md font-bold mb-2 text-gray-600 text-left">Cookie Consent</h2><p class="text-xs text-gray-600 text-justify">This website uses essential cookies to remember user preferences, such as colour preference. We do not use cookies for tracking or collecting personal information. By using this website, you agree to our use of cookies to remember your preferences. If you do not agree, you can disable cookies in your browser settings.</p><button style="position:absolute;bottom:0;left:0;right:0" class="transition-colors duration-1000 bg-white hover:bg-gray-100 text-gray-600 py-2 w-full border-t border-gray-100 rounded-lg">Accept</button></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"CVE-2023-26911","prevPostId":null,"nextPostId":"developing-risk-mitigation-strategy-for-ai-based-windows-search-case-study","prevPostTitle":null,"nextPostTitle":"Developing a Risk Mitigation Strategy for AI-Based Microsoft Search - A Case Study","contentMarkdown":"\n\nDuring a recent engagement, our team discovered a local privilege escalation vulnerability in Asus' Armoury Crate software (version 5.3.4.0 and earlier). The vulnerability stems from an unquoted service path in the SetupAsusServices module (version 1.0.5.1 and earlier) that Asus distributes with the software.\n\nWhen started on a Windows operating system, SetupAsusServices attempts to access several locations on the local C drive. This is due to the default behaviour of Windows when presented with file paths containing spaces. These locations were:\n\n    C:\\\n    C:\\Program Files\\\n    C:\\Program Files\\ASUS\\\n\nThis results in \"NAME NOT FOUND\" errors as shown below:\n\n![img](/assets/cve-2023-26911/fig1.png)\n\n\nThis behaviour can be exploited by a local attacker as long as they have write access to these locations. By placing a malicious executable in the requested path, it will be executed by the launched service with the privilege level of the application, which by default is system. Our team managed to exploit this vulnerability by placing a file named `ARMOURY.exe` in `C:\\Program Files\\ASUS\\`, this granted our user elevated privileges after a system restart.\n\nThe service runs as an authenticated user with high integrity, enabling any malicious code to execute with powerful system privileges if successfully exploited. While local access is required, this poses a serious risk if chained with other vulnerabilities.\n\nAfter responsibly disclosing this issue to ASUS, they promptly evaluated and patched the vulnerability in Armoury Crate by releasing version 5.3.4.0. This newer version mitigates the vulnerability by enclosing the file path with quotes, which prevents the iterative execution behaviour of Windows.  We appreciate ASUS taking quick action patching this issue after our inital disclosure.\n\n# Is unquoted service path still relevant?\n\nUnquoted service path vulnerabilities have been a known issue for over a decade but continue to appear in new software, demonstrating the persisting relevance of this vulnerability class.\n\nAn unquoted service path contains spaces but lacks quotation marks around the full path. This allows a local attacker with write access to somewhere along the affected path to insert a malicious executable file that will be run unintentionally by the vulnerable service. \n\nThe core issue stems from how Windows handles spaces in path names. By default, Windows uses spaces as delimiters to separate folder/file names in a path string. For example, consider the path:\n\n`C:\\My Folder\\MyProgram.exe`\n\nWindows will interpret this as:\n\n- `C:\\My`\n- `Folder\\MyProgram.exe`\n\nIt sees `My` and `Folder` as separate folder names because they are separated by a space. This causes problems when the space is intended to be part of the folder name `My Folder` rather than a delimiter.\n\nOn Windows systems, the operating system searches folders within an unquoted path and executes the first matching executable it finds. By placing a malicious executable first in the path, an attacker can exploit this behavior to escalate privileges when the service starts.\n\nWhile simple to fix by properly quoting the path, many developers still overlook this crucial secure coding practice. Unquoted service path allow attackers to trivially bypass system permissions and controls. The prevalence of this issue in modern software highlights the need for continued education on properly handling path names in Windows services.\n\n# Best Practices to Resolve Unquoted Service Path\nTo mitigate the risk of unquoted service path vulnerabilities, developers should adhere to the following best practices:\n\n- Always use quotes around service path: This is the most straightforward solution to the problem. By enclosing service path in quotes, you prevent the system from misinterpreting spaces as delimiters.\n\n- Implement least privilege principle: Limit the privileges of your applications and services to only what they need to function. \n\nConsider the following vulnerable service code:\n\n```\nvoid ServiceMain(int argc, char** argv) {\n\n  char path[] = \"C:\\\\Program Files\\\\MyService\\\\\";\n  \n  SetCurrentDirectory(path);\n  \n  system(\"MyService.exe\");\n\n}\n```\n\nIn the above code, the path passed to `SetCurrentDirectory()` is unquoted. This allows an attacker to place a malicious executable in `C:\\Program Files\\` that will run instead of MyService.exe.\n\nHere is the fixed code:\n\n```\nvoid ServiceMain(int argc, char** argv) {\n\n  char path[] = \"\\\"C:\\\\Program Files\\\\MyService\\\\\\\"\";\n   \n  SetCurrentDirectory(path);\n   \n  system(\"MyService.exe\");\n\n}\n```\n\nBy quoting the path, the service will correctly run MyService.exe as intended.\n\nQuoting service path helps mitigate unquoted path vulnerabilities by ensuring the correct executables are called. It is a simple but critical secure coding practice on Windows platforms.\n\n# Responsible Disclosure Timeline\n\n- November 29, 2022: Reported vulnerability to ASUS.\n- December 12, 2022: ASUS security team confirms presence of vulnerability, noted that it will be fixed before the end of December.\n- January 18, 2023: ASUS updated the release patch date to 30 January 2023\n- January 31, 2023: Asus releases Armoury Crate new version resolving unquoted path vulnerability.\n\n\n","title":"Unquoted Service Path in Asus Armoury Crate (CVE-2023-26911)","date":"2023-07-04","tags":["Zero Day","ASUS"],"draft":false,"summary":"A deep dive into an unquoted service path vulnerability in Asus Armoury Crate software and the persisting relevance of proper path quoting as a vital secure coding practice on Windows platforms."}},"__N_SSG":true},"page":"/blog/[id]","query":{"id":"CVE-2023-26911"},"buildId":"whoh_H9-mwKe_6ow6ygVo","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>