=== Content from asus.com_6c16f944_20250110_195639.html ===


Skip to content
 [Accessibility help](/content/Accessibility-Policy/) [![ROG](https://www.asus.com/media/Odin/images/header/ROG_normal.svg) ![ROG](https://www.asus.com/media/Odin/images/header/ROG_hover.svg)](https://rog.asus.com/)[![ProArt](https://www.asus.com/media/Odin/images/header/ProArt_normal.svg) ![ProArt](https://www.asus.com/media/Odin/images/header/ProArt_hover.svg)](https://www.asus.com/ProArt/)[![ASUS IoT](https://www.asus.com/media/Odin/images/header/IoT_normal.svg) ![ASUS IoT](https://www.asus.com/media/Odin/images/header/IoT_hover.svg)](https://iot.asus.com/)
Gaming
 [Business](https://www.asus.com/business/)[Environment](https://www.asus.com/content/sustainability-environment/)
Mobile / Handhelds

Laptops

Displays / Desktops

Motherboards / Components

Networking / IoT / Servers

Accessories

Support
  [Support](https://www.asus.com/support/)[ZenTalk](https://zentalk.asus.com/)[Drivers and manuals](https://www.asus.com/support/Download-Center/)[Check repair status](https://www.asus.com/support/rma-location)[MyASUS](https://www.asus.com/support/MyASUS-deeplink/)
My Account

Gaming
  [ROG - Republic of Gamers](https://rog.asus.com/)[TUF Gaming](https://www.asus.com/campaign/tuf-gaming/)[Business](https://www.asus.com/business/) [Environment](https://www.asus.com/content/sustainability-environment/)  [![ROG](https://www.asus.com/media/Odin/images/header/ROG_hover.svg)](https://rog.asus.com/)[![ProArt](https://www.asus.com/media/Odin/images/header/ProArt_hover.svg)](https://www.asus.com/ProArt/)[![ASUS IoT](https://www.asus.com/media/Odin/images/header/IoT_hover.svg)](https://iot.asus.com/)
Support

Create an ASUS account today to register your product for better support.
 [Learn more](https://account.asus.com/registerform.aspx)    [![ASUS ExpertBook B5](/WebsitesBanner/global/banners/8yhffew3nr2y4wlc/8yhffew3nr2y4wlc-0_0_desktop_0_1X.webp)](https://www.asus.com/laptops/for-work/expertbook/asus-expertbook-b5-b5405/)  [ASUS ExpertBook B5](https://www.asus.com/laptops/for-work/expertbook/asus-expertbook-b5-b5405/)  [Smart, secure AI power for business](https://www.asus.com/laptops/for-work/expertbook/asus-expertbook-b5-b5405/)   [Learn more](https://www.asus.com/laptops/for-work/expertbook/asus-expertbook-b5-b5405/)   [![ASUS new X870/B850 Series](/WebsitesBanner/global/banners/tsckyfbuxslqzldc/tsckyfbuxslqzldc-0_0_desktop_0_1X.jpg)](https://www.asus.com/microsite/motherboard/amd-am5-ryzen-9000-x3d-x870e-x870-b850-b840/?utm_source=official-site&utm_medium=asus-b850-hero-banner)        [![CES 2025](/WebsitesBanner/global/banners/k54spf8kwcnaufq2/k54spf8kwcnaufq2-0_0_desktop_0_1X.webp)](https://www.asus.com/event/ces/)        [![An ASUS NUC 14 Pro AI Mini PC with icons around it showcasing key features: Copilot+ PC, Wi-Fi 7, Voice Command, and Power Saving. Each icon highlights these unique product capabilities, creating a visually informative display of its strengths.](/WebsitesBanner/global/banners/cqcroi711cn5ols1/cqcroi711cn5ols1-0_0_desktop_0_1X.jpg)](https://www.asus.com/displays-desktops/nucs/nuc-mini-pcs/asus-nuc-14-pro-ai/)       [![Get to know Windows 11 Pro open in new window ](https://dlcdnimgs.asus.com/images/MDA2022/blue/en-us.jpg)](https://www.microsoft.com/windowsforbusiness) [![ASUS Zenbook A14](/WebsitesBanner/global/banners/gie4wo5qffnq1upq/gie4wo5qffnq1upq-0_0_desktop_0_1X.webp)](https://www.asus.com/laptops/for-home/zenbook/asus-zenbook-a14-ux3407/)  [ASUS Zenbook A14](https://www.asus.com/laptops/for-home/zenbook/asus-zenbook-a14-ux3407/)  [Unload. Unplugged. Unlimited.](https://www.asus.com/laptops/for-home/zenbook/asus-zenbook-a14-ux3407/)   [Learn more](https://www.asus.com/laptops/for-home/zenbook/asus-zenbook-a14-ux3407/)   [![ASUS new Z890/B860 Series](/WebsitesBanner/global/banners/ot5ddwndfgramxol/ot5ddwndfgramxol-0_0_desktop_0_1X.jpg)](https://www.asus.com/microsite/motherboard/intel-ultra-series-2-arrow-lake-s-z890-h810-b860/?utm_source=official-site&utm_medium=asus-b860-hero-banner)                             [![ROG Astral, TUF Gaming, Prime GeForce RTX 50 graphics card fly upward](/WebsitesBanner/global/banners/p5oieiwbjl30hu2n/p5oieiwbjl30hu2n-0_0_desktop_0_1X.jpg)](https://www.asus.com/microsite/Graphics-Cards/GeForce-RTX-50-Series/)              [![ASUS ExpertBook B1](/WebsitesBanner/global/banners/puhmbtkv0u1ykecf/puhmbtkv0u1ykecf-0_0_desktop_1_1X.webp)](https://www.asus.com/laptops/for-work/expertbook/asus-expertbook-b1-b1403/)
ASUS ExpertBook B1
 Elevated, effortless and secure   [Learn more](https://www.asus.com/laptops/for-work/expertbook/asus-expertbook-b1-b1403/) [![ASUS Expert P Series](/WebsitesBanner/global/banners/puhmbtkv0u1ykecf/puhmbtkv0u1ykecf-1_0_desktop_0_1X.webp)](https://www.asus.com/laptops/for-work/expertbook/expertbook-p5-p5405/)
ASUS Expert P Series
 Work reimagined, with AI   [Learn more](https://www.asus.com/laptops/for-work/expertbook/expertbook-p5-p5405/) [![It's EHA Reader Awards 2024 which was voted by 20 million readers from European Hardware Association, and this year, we have 3 product categories been voted as the best, include MB, Gaming LCD, and Mini PCs.](/WebsitesBanner/global/banners/puhmbtkv0u1ykecf/puhmbtkv0u1ykecf-2_0_desktop_2_1X.jpg)](https://asus.click/EHA24_PR)      [![](/WebsitesBanner/global/banners/puhmbtkv0u1ykecf/puhmbtkv0u1ykecf-3_0_desktop_3_1X.webp)](https://www.asus.com/displays-desktops/tower-pcs/expertcenter/expertcenter-d9-mini-tower-d901mdr/)   ![](/WebsitesBanner/global/banners/puhmbtkv0u1ykecf/puhmbtkv0u1ykecf-3_1_desktop_3_1X.png) Enterprise-grade security and scalable manageability   [Learn more](https://www.asus.com/displays-desktops/tower-pcs/expertcenter/expertcenter-d9-mini-tower-d901mdr/) [![](/WebsitesBanner/global/banners/puhmbtkv0u1ykecf/puhmbtkv0u1ykecf-4_0_desktop_4_1X.webp)](https://www.asus.com/laptops/for-creators/proart/proart-p16-h7606/)   ![](/WebsitesBanner/global/banners/puhmbtkv0u1ykecf/puhmbtkv0u1ykecf-4_1_desktop_4_1X.png) Creativity Unrivaled, Anywhere A new AI era begins  [Learn more](https://www.asus.com/laptops/for-creators/proart/proart-p16-h7606/) [![](/WebsitesBanner/global/banners/puhmbtkv0u1ykecf/puhmbtkv0u1ykecf-5_0_desktop_5_1X.webp)](https://www.asus.com/laptops/for-home/vivobook/asus-vivobook-s-14-oled-s5406/)
ASUS Vivobook S 14
 Simply Slim, Simply Stunning   [Learn more](https://www.asus.com/laptops/for-home/vivobook/asus-vivobook-s-14-oled-s5406/)
      ![previous image](data:image/svg+xml;base64...) ![next image](data:image/svg+xml;base64...)
## Shop and Learn

  Mobile / Handhelds [Phones](https://www.asus.com/mobile-handhelds/phones/all-series/)Wearable & HealthcareGaming Handhelds[Accessories](https://www.asus.com/mobile-handhelds/accessories/all-series/) Laptops [For Home](https://www.asus.com/laptops/for-home/all-series/)[For Work](https://www.asus.com/laptops/for-work/all-series/)[For Creators](https://www.asus.com/laptops/for-creators/all-series/)[For Students](https://www.asus.com/laptops/for-students/all-series/)[For Gaming](https://www.asus.com/laptops/for-gaming/all-series/)[Accessories](https://www.asus.com/laptops/accessories/all-series/)SoftwareTechnology / InnovationsCopilot+ PC Displays / Desktops [Monitors](https://www.asus.com/displays-desktops/monitors/all-series/)[Projectors](https://www.asus.com/displays-desktops/projectors/all-series/)[All-in-One PCs](https://www.asus.com/displays-desktops/all-in-one-pcs/all-series/)[Tower PCs](https://www.asus.com/displays-desktops/tower-pcs/all-series/)[Gaming Tower PCs](https://www.asus.com/displays-desktops/gaming-tower-pcs/all-series/)[NUCs](https://www.asus.com/displays-desktops/nucs/all-series/)[Mini PCs](https://www.asus.com/displays-desktops/mini-pcs/all-series/)[Workstations](https://www.asus.com/displays-desktops/workstations/all-series/)[Accessories](https://www.asus.com/displays-desktops/accessories/all-series/)SoftwareWarrantyGlasses Motherboards / Components [Motherboards](https://www.asus.com/motherboards-components/motherboards/all-series/)[Graphics Cards](https://www.asus.com/motherboards-components/graphics-cards/all-series/)[Cases](https://www.asus.com/motherboards-components/cases/all-series/)[Cooling](https://www.asus.com/motherboards-components/cooling/all-series/)[Power Supply Units](https://www.asus.com/motherboards-components/power-supply-units/all-series/)[Sound Cards](https://www.asus.com/motherboards-components/sound-cards/all-series/)[Optical Drives](https://www.asus.com/motherboards-components/optical-drives/all-series/)[Data Storage](https://www.asus.com/motherboards-components/data-storage/all-series/)[External Graphics Docks](https://www.asus.com/motherboards-components/external-graphics-docks/all-series/)Single Board ComputersSoftware Networking / IoT / Servers [WiFi 7](https://www.asus.com/networking-iot-servers/wifi-7/all-series/)[WiFi 6](https://www.asus.com/networking-iot-servers/wifi-6/all-series/)[WiFi Routers](https://www.asus.com/networking-iot-servers/wifi-routers/all-series/)[Whole Home Mesh WiFi System](https://www.asus.com/networking-iot-servers/whole-home-mesh-wifi-system/all-series/)[Business Network Solutions](https://www.asus.com/networking-iot-servers/business-network-solutions/all-series/)Range ExtendersModem RoutersAdapters[Wired Networking](https://www.asus.com/networking-iot-servers/wired-networking/all-series/)[Intelligent Robots](https://www.asus.com/networking-iot-servers/intelligent-robots/all-series/)[AIoT & Industrial Solutions](https://www.asus.com/networking-iot-servers/aiot-industrial-solutions/all-series/)[Servers](https://www.asus.com/networking-iot-servers/servers/all-series/)[Smart Home](https://www.asus.com/networking-iot-servers/smart-home/all-series/) Accessories [Keyboards](https://www.asus.com/accessories/keyboards/all-series/)[Mice and Mouse Pads](https://www.asus.com/accessories/mice-and-mouse-pads/all-series/)[Headsets and Audio](https://www.asus.com/accessories/headsets-and-audio/all-series/)[Streaming Kits](https://www.asus.com/accessories/streaming-kits/all-series/)[Apparel Bags and Gear](https://www.asus.com/accessories/apparel-bags-and-gear/all-series/)[Cases and Protection](https://www.asus.com/accessories/cases-and-protection/all-series/)[Adapters and Chargers](https://www.asus.com/accessories/adapters-and-chargers/all-series/)Wireless Charger[Docks Dongles and Cable](https://www.asus.com/accessories/docks-dongles-and-cable/all-series/)[Power Banks](https://www.asus.com/accessories/power-banks/all-series/)Stylus[Controller](https://www.asus.com/accessories/controller/all-series/)[Gimbal](https://www.asus.com/accessories/gimbal/all-series/)

     Global / English
©ASUSTeK Computer Inc. All rights reserved.
 [Terms of Use Notice](https://www.asus.com/terms_of_use_notice_privacy_policy/official-site/)[Privacy Policy](https://www.asus.com/terms_of_use_notice_privacy_policy/privacy_policy/)[Export Control and Sanctions Compliance](https://www.asus.com/terms_of_use_notice_privacy_policy/export-control-and-sanctions-compliance)
Cookie Settings



=== Content from irradiate.com.au_1f825fe7_20250110_195640.html ===
[Irradiate Security![Irradiate Security Icon](/assets/irradiate-icon-black.png)](/)[Home](/)[About](/about)[Services](/services)[Contact](/contact)[Blog](/blog)

1. [Home](/)
2. [Blog](/blog)
3. Unquoted Service Path in Asus Armoury Crate (CVE-2023-26911)
July 04, 2023
# Unquoted Service Path in Asus Armoury Crate (CVE-2023-26911)

4 min read

---

During a recent engagement, our team discovered a local privilege escalation vulnerability in Asus' Armoury Crate software (version 5.3.4.0 and earlier). The vulnerability stems from an unquoted service path in the SetupAsusServices module (version 1.0.5.1 and earlier) that Asus distributes with the software.

When started on a Windows operating system, SetupAsusServices attempts to access several locations on the local C drive. This is due to the default behaviour of Windows when presented with file paths containing spaces. These locations were:

```

```
C:\
C:\Program Files\
C:\Program Files\ASUS\

```

```

This results in "NAME NOT FOUND" errors as shown below:

![img](/_next/image?url=%2Fassets%2Fcve-2023-26911%2Ffig1.png&w=1080&q=75)

This behaviour can be exploited by a local attacker as long as they have write access to these locations. By placing a malicious executable in the requested path, it will be executed by the launched service with the privilege level of the application, which by default is system. Our team managed to exploit this vulnerability by placing a file named `ARMOURY.exe` in `C:\Program Files\ASUS\`, this granted our user elevated privileges after a system restart.

The service runs as an authenticated user with high integrity, enabling any malicious code to execute with powerful system privileges if successfully exploited. While local access is required, this poses a serious risk if chained with other vulnerabilities.

After responsibly disclosing this issue to ASUS, they promptly evaluated and patched the vulnerability in Armoury Crate by releasing version 5.3.4.0. This newer version mitigates the vulnerability by enclosing the file path with quotes, which prevents the iterative execution behaviour of Windows. We appreciate ASUS taking quick action patching this issue after our inital disclosure.

# Is unquoted service path still relevant?

Unquoted service path vulnerabilities have been a known issue for over a decade but continue to appear in new software, demonstrating the persisting relevance of this vulnerability class.

An unquoted service path contains spaces but lacks quotation marks around the full path. This allows a local attacker with write access to somewhere along the affected path to insert a malicious executable file that will be run unintentionally by the vulnerable service.

The core issue stems from how Windows handles spaces in path names. By default, Windows uses spaces as delimiters to separate folder/file names in a path string. For example, consider the path:

`C:\My Folder\MyProgram.exe`

Windows will interpret this as:

* `C:\My`
* `Folder\MyProgram.exe`

It sees `My` and `Folder` as separate folder names because they are separated by a space. This causes problems when the space is intended to be part of the folder name `My Folder` rather than a delimiter.

On Windows systems, the operating system searches folders within an unquoted path and executes the first matching executable it finds. By placing a malicious executable first in the path, an attacker can exploit this behavior to escalate privileges when the service starts.

While simple to fix by properly quoting the path, many developers still overlook this crucial secure coding practice. Unquoted service path allow attackers to trivially bypass system permissions and controls. The prevalence of this issue in modern software highlights the need for continued education on properly handling path names in Windows services.

# Best Practices to Resolve Unquoted Service Path

To mitigate the risk of unquoted service path vulnerabilities, developers should adhere to the following best practices:

* Always use quotes around service path: This is the most straightforward solution to the problem. By enclosing service path in quotes, you prevent the system from misinterpreting spaces as delimiters.
* Implement least privilege principle: Limit the privileges of your applications and services to only what they need to function.

Consider the following vulnerable service code:

```

```
void ServiceMain(int argc, char** argv) {

  char path[] = "C:\\Program Files\\MyService\\";

  SetCurrentDirectory(path);

  system("MyService.exe");

}

```

```

In the above code, the path passed to `SetCurrentDirectory()` is unquoted. This allows an attacker to place a malicious executable in `C:\Program Files\` that will run instead of MyService.exe.

Here is the fixed code:

```

```
void ServiceMain(int argc, char** argv) {

  char path[] = "\"C:\\Program Files\\MyService\\\"";

  SetCurrentDirectory(path);

  system("MyService.exe");

}

```

```

By quoting the path, the service will correctly run MyService.exe as intended.

Quoting service path helps mitigate unquoted path vulnerabilities by ensuring the correct executables are called. It is a simple but critical secure coding practice on Windows platforms.

# Responsible Disclosure Timeline

* November 29, 2022: Reported vulnerability to ASUS.
* December 12, 2022: ASUS security team confirms presence of vulnerability, noted that it will be fixed before the end of December.
* January 18, 2023: ASUS updated the release patch date to 30 January 2023
* January 31, 2023: Asus releases Armoury Crate new version resolving unquoted path vulnerability.

## Next Post

[Developing a Risk Mitigation Strategy for AI-Based Microsoft Search - A Case Study](/blog/developing-risk-mitigation-strategy-for-ai-based-windows-search-case-study)[![Irradiate Security Icon](/assets/irradiate-icon-black.png)](/ "Company")

We are based in Canberra, Australia, on the traditional lands of the Ngunnawal people.

We recognize and honour the traditional custodians of this land and extend our respects to Elders past, present, and emerging.

Sitemap

* [Home](/)

* [About](/about)

* [Services](/services)

* [Contact Us](/contact)

* [Blog](/blog)
Social[LinkedIn icon](https://www.linkedin.com/company/irradiate-security)

Copyright © 2024 Irradiate Security. All rights reserved.

* [Privacy Policy](/privacy)
* [Accessibility](/accessibility)
## Cookie Consent

This website uses essential cookies to remember user preferences, such as colour preference. We do not use cookies for tracking or collecting personal information. By using this website, you agree to our use of cookies to remember your preferences. If you do not agree, you can disable cookies in your browser settings.

Accept
