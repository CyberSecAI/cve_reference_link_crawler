- **Root cause of vulnerability:** A stack buffer overflow in the `generate_conf_router` function of the LBT T300-T390 router firmware due to the usage of `strcpy` without proper bounds checking.
- **Weaknesses/vulnerabilities present:** Stack buffer overflow vulnerability. The `ApCliSsid` parameter obtained from `nvram_get` is passed to `strcpy` without proper validation, leading to a buffer overflow when the input string exceeds the allocated buffer size.
- **Impact of exploitation:** An attacker can cause the server to crash by sending a crafted request with an overly long `ApCliSsid` parameter. This could lead to denial of service.
- **Attack vectors:** The attack vector involves sending a crafted POST request to the `/apply.cgi` endpoint, specifically targeting the `ApCliSsid` parameter within the request body.
- **Required attacker capabilities/position:** The attacker needs to be able to send HTTP requests to the router, typically from the local network. The attacker also needs to know the URL endpoint (`/apply.cgi`) and the parameter to exploit (`ApCliSsid`). The provided proof of concept (POC) shows the attacker needs to also provide valid credentials as a basic authentication header, which implies they would need to have obtained a valid username and password prior to launching the attack.