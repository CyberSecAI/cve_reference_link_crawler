

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>libnmap.process &mdash; libnmap 0.2 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="libnmap.parser" href="parser.html" />
    <link rel="prev" title="Welcome to libnmapâs documentation!" href="index.html" /> 

<!-- RTD Extra Head -->

<!-- 
Always link to the latest version, as canonical.
http://docs.readthedocs.org/en/latest/canonical.html
-->
<link rel="canonical" href="https://libnmap.readthedocs.io/en/latest/process.html" />



<script type="application/json" id="READTHEDOCS_DATA">{"ad_free": false, "api_host": "https://readthedocs.org", "build_date": "2020-11-18T20:18:51Z", "builder": "sphinx", "canonical_url": "https://libnmap.readthedocs.io/en/latest/", "commit": "c6cdee45", "docroot": "/docs/", "features": {"docsearch_disabled": false}, "global_analytics_code": "UA-17997319-1", "language": "en", "page": "process", "programming_language": "py", "project": "libnmap", "proxied_api_host": "/_", "source_suffix": ".rst", "subprojects": {}, "theme": "sphinx_rtd_theme", "user_analytics_code": "", "version": "latest"}</script>

<!--
Using this variable directly instead of using `JSON.parse` is deprecated.
The READTHEDOCS_DATA global variable will be removed in the future.
-->
<script type="text/javascript">
READTHEDOCS_DATA = JSON.parse(document.getElementById('READTHEDOCS_DATA').innerHTML);
</script>



<!-- end RTD <extrahead> -->
<script async type="text/javascript" src="/_/static/javascript/readthedocs-addons.js"></script><meta name="readthedocs-project-slug" content="libnmap" /><meta name="readthedocs-version-slug" content="latest" /><meta name="readthedocs-resolver-filename" content="/process.html" /><meta name="readthedocs-http-status" content="200" /></head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> libnmap
          

          
          </a>

          
            
            
            
              <div class="version">
                latest
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">libnmap.process</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#purpose-of-libnmap-process">Purpose of libnmap.process</a></li>
<li class="toctree-l2"><a class="reference internal" href="#processing-of-events">Processing of events</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-libnmap-process">Using libnmap.process</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-libnmap.process">NmapProcess methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="#nmaptask-methods">NmapTask methods</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="parser.html">libnmap.parser</a></li>
<li class="toctree-l1"><a class="reference internal" href="objects.html">libnmap.objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="objects/cpe.html">libnmap.objects.cpe</a></li>
<li class="toctree-l1"><a class="reference internal" href="objects/nmaphost.html">libnmap.objects.host</a></li>
<li class="toctree-l1"><a class="reference internal" href="objects/nmapreport.html">libnmap.objects.report</a></li>
<li class="toctree-l1"><a class="reference internal" href="objects/nmapservice.html">libnmap.objects.service</a></li>
<li class="toctree-l1"><a class="reference internal" href="objects/os.html">libnmap.objects.os</a></li>
<li class="toctree-l1"><a class="reference internal" href="diff.html">libnmap.diff</a></li>
<li class="toctree-l1"><a class="reference internal" href="plugins_s3.html">libnmap.plugins.s3.NmapS3Plugin</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">libnmap</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>libnmap.process</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/savon-noir/python-nmap-lib/blob/master/docs/process.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="libnmap-process">
<h1>libnmap.process<a class="headerlink" href="#libnmap-process" title="Permalink to this headline">Â¶</a></h1>
<div class="section" id="purpose-of-libnmap-process">
<h2>Purpose of libnmap.process<a class="headerlink" href="#purpose-of-libnmap-process" title="Permalink to this headline">Â¶</a></h2>
<p>The purpose of this module is to enable the lib users to launch and control nmap scans. This module will consequently fire the nmap command following the specified parameters provided in the constructor.</p>
<p>It is to note that this module will not perform a full inline parsing of the data. Only specific events are parsed and exploitable via either a callback function defined by the user and provided in the constructor; either by running the process in the background and accessing the NmapProcess attributes will the scan is running.</p>
<p>To run an nmap scan, you need to:</p>
<ul class="simple">
<li>instanciate NmapProcess</li>
<li>call the run*() methods</li>
</ul>
<p>Raw results of the scans will be available in the following properties:</p>
<ul class="simple">
<li>NmapProcess.stdout: string, XML output</li>
<li>NmapProcess.stderr: string, text error message from nmap process</li>
</ul>
<p>To instanciate a NmapProcess instance, call the constructor with appropriate parameters</p>
</div>
<div class="section" id="processing-of-events">
<h2>Processing of events<a class="headerlink" href="#processing-of-events" title="Permalink to this headline">Â¶</a></h2>
<p>While Nmap is running, some events are process and parsed. This would enable you to:</p>
<ul class="simple">
<li>evaluate estimated time to completion and progress in percentage</li>
<li>find out which task is running and how many nmap task have been executed</li>
<li>know the start time and nmap version</li>
</ul>
<p>As you may know, depending on the nmap options you specified, nmap will execute several tasks like âDNS Resolveâ, âPing Scanâ, âConnect Scanâ, âNSE scriptsâ,â¦ This is of course independent from libnmap but the lib is able to parse these tasks and will instanciate a NmapTask object for any task executed. The list of executed task is available via the following properties:</p>
<ul class="simple">
<li>NmapProcess.tasks: list of NmapTask object (executed nmap tasks)</li>
<li>NmapProcess.current_task: returns the currently running NmapTask</li>
</ul>
<p>You will find below the list of attributes you can use when dealing with NmapTask:</p>
<ul class="simple">
<li>name: task name (check nmap documentation for the complete list)</li>
<li>etc: unix timestamp of estimated time to completion</li>
<li>progress: estimated percentage of task completion</li>
<li>percent: estimated percentage of task completion (same as progress)</li>
<li>remaining: estimated number of seconds to completion</li>
<li>status: status of the task (âstartedâ or âendedâ)</li>
<li>starttime: unix timestamp of when the task started</li>
<li>endtime: unix timestamp of when the task ended, 0 if not completed yet</li>
<li>extrainfo: extra information stored for specific tasks</li>
<li>updated: unix timestamp of last data update for this task</li>
</ul>
</div>
<div class="section" id="using-libnmap-process">
<h2>Using libnmap.process<a class="headerlink" href="#using-libnmap-process" title="Permalink to this headline">Â¶</a></h2>
<p>This modules enables you to launch nmap scans with simples python commands:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">libnmap.process</span> <span class="kn">import</span> <span class="n">NmapProcess</span>

<span class="n">nm</span> <span class="o">=</span> <span class="n">NmapProcess</span><span class="p">(</span><span class="s2">&quot;scanme.nmap.org&quot;</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="s2">&quot;-sV&quot;</span><span class="p">)</span>
<span class="n">rc</span> <span class="o">=</span> <span class="n">nm</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="k">if</span> <span class="n">nm</span><span class="o">.</span><span class="n">rc</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="nb">print</span> <span class="n">nm</span><span class="o">.</span><span class="n">stdout</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span> <span class="n">nm</span><span class="o">.</span><span class="n">stderr</span>
</pre></div>
</div>
<p>This module is also able to trigger a callback function provided by the user. This callback will be triggered each time nmap returns data to the lib.
It is to note that the lib forces nmap to return its status (progress and etc) every two seconds. The event callback could then play around with those values while running.</p>
<p>To go a bit further, you can always use the threading capabilities of the NmapProcess class and run the class in the background</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>

<span class="kn">from</span> <span class="nn">libnmap.process</span> <span class="kn">import</span> <span class="n">NmapProcess</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span>


<span class="n">nmap_proc</span> <span class="o">=</span> <span class="n">NmapProcess</span><span class="p">(</span><span class="n">targets</span><span class="o">=</span><span class="s2">&quot;scanme.nmap.org&quot;</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="s2">&quot;-sT&quot;</span><span class="p">)</span>
<span class="n">nmap_proc</span><span class="o">.</span><span class="n">run_background</span><span class="p">()</span>
<span class="k">while</span> <span class="n">nmap_proc</span><span class="o">.</span><span class="n">is_running</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Nmap Scan running: ETC: </span><span class="si">{0}</span><span class="s2"> DONE: </span><span class="si">{1}</span><span class="s2">%&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nmap_proc</span><span class="o">.</span><span class="n">etc</span><span class="p">,</span>
                                                          <span class="n">nmap_proc</span><span class="o">.</span><span class="n">progress</span><span class="p">))</span>
    <span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;rc: </span><span class="si">{0}</span><span class="s2"> output: </span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nmap_proc</span><span class="o">.</span><span class="n">rc</span><span class="p">,</span> <span class="n">nmap_proc</span><span class="o">.</span><span class="n">summary</span><span class="p">))</span>
</pre></div>
</div>
<p>The above code will print out the following on standard output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>(pydev)[dev@bouteille python-nmap-lib]$ python examples/proc_async.py
Nmap Scan running: ETC: 0 DONE: 0%
Nmap Scan running: ETC: 1369433951 DONE: 2.45%
Nmap Scan running: ETC: 1369433932 DONE: 13.55%
Nmap Scan running: ETC: 1369433930 DONE: 25.35%
Nmap Scan running: ETC: 1369433931 DONE: 33.40%
Nmap Scan running: ETC: 1369433932 DONE: 41.50%
Nmap Scan running: ETC: 1369433931 DONE: 52.90%
Nmap Scan running: ETC: 1369433931 DONE: 62.55%
Nmap Scan running: ETC: 1369433930 DONE: 75.55%
Nmap Scan running: ETC: 1369433931 DONE: 81.35%
Nmap Scan running: ETC: 1369433931 DONE: 99.99%
rc: 0 output: Nmap done at Sat May 25 00:18:51 2013; 1 IP address (1 host up) scanned in 22.02 seconds
(pydev)[dev@bouteille python-nmap-lib]$
</pre></div>
</div>
<p>Another and last example of a simple use of the NmapProcess class. The code below prints out the scan results a la nmap</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>

<span class="kn">from</span> <span class="nn">libnmap.process</span> <span class="kn">import</span> <span class="n">NmapProcess</span>
<span class="kn">from</span> <span class="nn">libnmap.parser</span> <span class="kn">import</span> <span class="n">NmapParser</span><span class="p">,</span> <span class="n">NmapParserException</span>


<span class="c1"># start a new nmap scan on localhost with some specific options</span>
<span class="k">def</span> <span class="nf">do_scan</span><span class="p">(</span><span class="n">targets</span><span class="p">,</span> <span class="n">options</span><span class="p">):</span>
    <span class="n">parsed</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">nmproc</span> <span class="o">=</span> <span class="n">NmapProcess</span><span class="p">(</span><span class="n">targets</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
    <span class="n">rc</span> <span class="o">=</span> <span class="n">nmproc</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">rc</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;nmap scan failed: </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nmproc</span><span class="o">.</span><span class="n">stderr</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">nmproc</span><span class="o">.</span><span class="n">stdout</span><span class="p">))</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">parsed</span> <span class="o">=</span> <span class="n">NmapParser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">nmproc</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">NmapParserException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Exception raised while parsing scan: </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">msg</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">parsed</span>


<span class="c1"># print scan results from a nmap report</span>
<span class="k">def</span> <span class="nf">print_scan</span><span class="p">(</span><span class="n">nmap_report</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Starting Nmap </span><span class="si">{0}</span><span class="s2"> ( http://nmap.org ) at </span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">nmap_report</span><span class="o">.</span><span class="n">version</span><span class="p">,</span>
        <span class="n">nmap_report</span><span class="o">.</span><span class="n">started</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">host</span> <span class="ow">in</span> <span class="n">nmap_report</span><span class="o">.</span><span class="n">hosts</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">host</span><span class="o">.</span><span class="n">hostnames</span><span class="p">):</span>
            <span class="n">tmp_host</span> <span class="o">=</span> <span class="n">host</span><span class="o">.</span><span class="n">hostnames</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tmp_host</span> <span class="o">=</span> <span class="n">host</span><span class="o">.</span><span class="n">address</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Nmap scan report for </span><span class="si">{0}</span><span class="s2"> (</span><span class="si">{1}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">tmp_host</span><span class="p">,</span>
            <span class="n">host</span><span class="o">.</span><span class="n">address</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Host is </span><span class="si">{0}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">host</span><span class="o">.</span><span class="n">status</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  PORT     STATE         SERVICE&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">serv</span> <span class="ow">in</span> <span class="n">host</span><span class="o">.</span><span class="n">services</span><span class="p">:</span>
            <span class="n">pserv</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{0:&gt;5s}</span><span class="s2">/</span><span class="si">{1:3s}</span><span class="s2">  </span><span class="si">{2:12s}</span><span class="s2">  </span><span class="si">{3}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="nb">str</span><span class="p">(</span><span class="n">serv</span><span class="o">.</span><span class="n">port</span><span class="p">),</span>
                    <span class="n">serv</span><span class="o">.</span><span class="n">protocol</span><span class="p">,</span>
                    <span class="n">serv</span><span class="o">.</span><span class="n">state</span><span class="p">,</span>
                    <span class="n">serv</span><span class="o">.</span><span class="n">service</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">serv</span><span class="o">.</span><span class="n">banner</span><span class="p">):</span>
                <span class="n">pserv</span> <span class="o">+=</span> <span class="s2">&quot; (</span><span class="si">{0}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">serv</span><span class="o">.</span><span class="n">banner</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">pserv</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">nmap_report</span><span class="o">.</span><span class="n">summary</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">report</span> <span class="o">=</span> <span class="n">do_scan</span><span class="p">(</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span> <span class="s2">&quot;-sV&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">report</span><span class="p">:</span>
        <span class="n">print_scan</span><span class="p">(</span><span class="n">report</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No results returned&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The above code will print out the following on standard output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>(pydev)[dev@bouteille python-nmap-lib]$ python examples/proc_nmap_like.py
Starting Nmap 5.51 ( http://nmap.org ) at Sat May 25 00:14:54 2013
Nmap scan report for localhost (127.0.0.1)
Host is up.
  PORT     STATE         SERVICE
   22/tcp  open          ssh (product: OpenSSH extrainfo: protocol 2.0 version: 5.3)
   25/tcp  open          smtp (product: Postfix smtpd hostname:  bouteille.localdomain)
   80/tcp  open          http (product: nginx version: 1.0.15)
  111/tcp  open          rpcbind (version: 2-4 extrainfo: rpc #100000)
  631/tcp  open          ipp (product: CUPS version: 1.4)
Nmap done at Sat May 25 00:15:00 2013; 1 IP address (1 host up) scanned in 6.25 seconds
(pydev)[dev@bouteille python-nmap-lib]$
</pre></div>
</div>
<p>The full <a class="reference external" href="https://github.com/savon-noir/python-nmap-lib">source code</a> is available on GitHub. Please, do not hesitate to fork it and issue pull requests.</p>
</div>
<div class="section" id="module-libnmap.process">
<span id="nmapprocess-methods"></span><h2>NmapProcess methods<a class="headerlink" href="#module-libnmap.process" title="Permalink to this headline">Â¶</a></h2>
<dl class="class">
<dt id="libnmap.process.NmapProcess">
<em class="property">class </em><code class="descclassname">libnmap.process.</code><code class="descname">NmapProcess</code><span class="sig-paren">(</span><em>targets='127.0.0.1'</em>, <em>options='-sT'</em>, <em>event_callback=None</em>, <em>safe_mode=True</em>, <em>fqp=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/libnmap/process.html#NmapProcess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libnmap.process.NmapProcess" title="Permalink to this definition">Â¶</a></dt>
<dd><p>NmapProcess is a class which wraps around the nmap executable.</p>
<p>Consequently, in order to run an NmapProcess, nmap should be installed
on the host running the script. By default NmapProcess will produce
the output of the nmap scan in the nmap XML format. This could be then
parsed out via the NmapParser class from libnmap.parser module.</p>
<dl class="method">
<dt id="libnmap.process.NmapProcess.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>targets='127.0.0.1'</em>, <em>options='-sT'</em>, <em>event_callback=None</em>, <em>safe_mode=True</em>, <em>fqp=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/libnmap/process.html#NmapProcess.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libnmap.process.NmapProcess.__init__" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Constructor of NmapProcess class.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>targets</strong> (<em>string</em><em> or </em><em>list</em>) â hosts to be scanned. Could be a string of hosts         separated with a coma or a python list of hosts/ip.</li>
<li><strong>options</strong> â list of nmap options to be applied to scan.         These options are all documented in nmapâs man pages.</li>
<li><strong>event_callback</strong> â <p>callable function which will be ran         each time nmap process outputs data. This function will receive         two parameters:</p>
<ol class="arabic">
<li>the nmap process object</li>
<li>the data produced by nmap process. See readme for examples.</li>
</ol>
</li>
<li><strong>safe_mode</strong> â parameter to protect unsafe options like -oN, -oG,         -iL, -oA,â¦</li>
<li><strong>fqp</strong> â full qualified path, if None, nmap will be searched         in the PATH</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">NmapProcess object</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="libnmap.process.NmapProcess.command">
<code class="descname">command</code><a class="headerlink" href="#libnmap.process.NmapProcess.command" title="Permalink to this definition">Â¶</a></dt>
<dd><p>return the constructed nmap command or empty string if not
constructed yet.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">string</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="libnmap.process.NmapProcess.current_task">
<code class="descname">current_task</code><a class="headerlink" href="#libnmap.process.NmapProcess.current_task" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Accessor for the current NmapTask beeing run</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">NmapTask or None if no task started yet</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="libnmap.process.NmapProcess.elapsed">
<code class="descname">elapsed</code><a class="headerlink" href="#libnmap.process.NmapProcess.elapsed" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Accessor returning for how long the scan ran (in seconds)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">string</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="libnmap.process.NmapProcess.endtime">
<code class="descname">endtime</code><a class="headerlink" href="#libnmap.process.NmapProcess.endtime" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Accessor for time when scan ended</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">string. Unix timestamp</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="libnmap.process.NmapProcess.etc">
<code class="descname">etc</code><a class="headerlink" href="#libnmap.process.NmapProcess.etc" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Accessor for estimated time to completion</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">estimated time to completion</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="libnmap.process.NmapProcess.get_command_line">
<code class="descname">get_command_line</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/libnmap/process.html#NmapProcess.get_command_line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libnmap.process.NmapProcess.get_command_line" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Public method returning the reconstructed command line ran via the lib</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">the full nmap command line to run</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">string</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="libnmap.process.NmapProcess.has_failed">
<code class="descname">has_failed</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/libnmap/process.html#NmapProcess.has_failed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libnmap.process.NmapProcess.has_failed" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Checks if nmap has failed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">True if nmap process errored.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="libnmap.process.NmapProcess.has_terminated">
<code class="descname">has_terminated</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/libnmap/process.html#NmapProcess.has_terminated"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libnmap.process.NmapProcess.has_terminated" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Checks if nmap has terminated. Could have failed or succeeded</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">True if nmap process is not running anymore.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="libnmap.process.NmapProcess.is_running">
<code class="descname">is_running</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/libnmap/process.html#NmapProcess.is_running"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libnmap.process.NmapProcess.is_running" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Checks if nmap is still running.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">True if nmap is still running</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="libnmap.process.NmapProcess.is_successful">
<code class="descname">is_successful</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/libnmap/process.html#NmapProcess.is_successful"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libnmap.process.NmapProcess.is_successful" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Checks if nmap terminated successfully.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">True if nmap terminated successfully.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="libnmap.process.NmapProcess.options">
<code class="descname">options</code><a class="headerlink" href="#libnmap.process.NmapProcess.options" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Provides the list of options for that scan</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">list of string (nmap options)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="libnmap.process.NmapProcess.progress">
<code class="descname">progress</code><a class="headerlink" href="#libnmap.process.NmapProcess.progress" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Accessor for progress status in percentage</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">percentage of job processed.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="libnmap.process.NmapProcess.rc">
<code class="descname">rc</code><a class="headerlink" href="#libnmap.process.NmapProcess.rc" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Accessor for nmap executionâs return code</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">nmap executionâs return code</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="libnmap.process.NmapProcess.run">
<code class="descname">run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/libnmap/process.html#NmapProcess.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libnmap.process.NmapProcess.run" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Public method which is usually called right after the constructor
of NmapProcess. This method starts the nmap executableâs subprocess.
It will also bind a Process that will read from subprocessâ stdout
and stderr and push the lines read in a python queue for futher
processing. This processing is waken-up each time data is pushed
from the nmap binary into the stdout reading routine. Processing
could be performed by a user-provided callback. The whole
NmapProcess object could be accessible asynchroneously.</p>
<p>return: return code from nmap execution</p>
</dd></dl>

<dl class="method">
<dt id="libnmap.process.NmapProcess.run_background">
<code class="descname">run_background</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/libnmap/process.html#NmapProcess.run_background"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libnmap.process.NmapProcess.run_background" title="Permalink to this definition">Â¶</a></dt>
<dd><p>run nmap scan in background as a thread.
For privileged scans, consider NmapProcess.sudo_run_background()</p>
</dd></dl>

<dl class="attribute">
<dt id="libnmap.process.NmapProcess.starttime">
<code class="descname">starttime</code><a class="headerlink" href="#libnmap.process.NmapProcess.starttime" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Accessor for time when scan started</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">string. Unix timestamp</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="libnmap.process.NmapProcess.state">
<code class="descname">state</code><a class="headerlink" href="#libnmap.process.NmapProcess.state" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Accessor for nmap execution state. Possible states are:</p>
<ul class="simple">
<li>self.READY</li>
<li>self.RUNNING</li>
<li>self.FAILED</li>
<li>self.CANCELLED</li>
<li>self.DONE</li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">integer (from above documented enum)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="libnmap.process.NmapProcess.stderr">
<code class="descname">stderr</code><a class="headerlink" href="#libnmap.process.NmapProcess.stderr" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Accessor for nmap standart error</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">output from nmap when errors occured.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">string</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="libnmap.process.NmapProcess.stdout">
<code class="descname">stdout</code><a class="headerlink" href="#libnmap.process.NmapProcess.stdout" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Accessor for nmap standart output</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">output from nmap scan in XML</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">string</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="libnmap.process.NmapProcess.stop">
<code class="descname">stop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/libnmap/process.html#NmapProcess.stop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libnmap.process.NmapProcess.stop" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Send KILL -15 to the nmap subprocess and gently ask the threads to
stop.</p>
</dd></dl>

<dl class="method">
<dt id="libnmap.process.NmapProcess.sudo_run">
<code class="descname">sudo_run</code><span class="sig-paren">(</span><em>run_as='root'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/libnmap/process.html#NmapProcess.sudo_run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libnmap.process.NmapProcess.sudo_run" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Public method enabling the libraryâs user to run the scan with
priviledges via sudo. The sudo configuration should be set manually
on the local system otherwise sudo will prompt for a password.
This method alters the command line by prefixing the sudo command to
nmap and will then call self.run()</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>run_as</strong> â user name to which the lib needs to sudo to run the scan</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">return code from nmap execution</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="libnmap.process.NmapProcess.sudo_run_background">
<code class="descname">sudo_run_background</code><span class="sig-paren">(</span><em>run_as='root'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/libnmap/process.html#NmapProcess.sudo_run_background"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libnmap.process.NmapProcess.sudo_run_background" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Public method enabling the libraryâs user to run in background a
nmap scan with priviledges via sudo.
The sudo configuration should be set manually on the local system
otherwise sudo will prompt for a password.
This method alters the command line by prefixing the sudo command to
nmap and will then call self.run()</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>run_as</strong> â user name to which the lib needs to sudo to run the scan</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">return code from nmap execution</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="libnmap.process.NmapProcess.summary">
<code class="descname">summary</code><a class="headerlink" href="#libnmap.process.NmapProcess.summary" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Accessor returning a short summary of the scanâs results</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">string</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="libnmap.process.NmapProcess.targets">
<code class="descname">targets</code><a class="headerlink" href="#libnmap.process.NmapProcess.targets" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Provides the list of targets to scan</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">list of string</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="libnmap.process.NmapProcess.tasks">
<code class="descname">tasks</code><a class="headerlink" href="#libnmap.process.NmapProcess.tasks" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Accessor returning for the list of tasks ran during nmap scan</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">dict of NmapTask object</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="libnmap.process.NmapProcess.version">
<code class="descname">version</code><a class="headerlink" href="#libnmap.process.NmapProcess.version" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Accessor for nmap binary version number</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">version number of nmap binary</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">string</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="nmaptask-methods">
<h2>NmapTask methods<a class="headerlink" href="#nmaptask-methods" title="Permalink to this headline">Â¶</a></h2>
<dl class="class">
<dt id="libnmap.process.NmapTask">
<em class="property">class </em><code class="descclassname">libnmap.process.</code><code class="descname">NmapTask</code><span class="sig-paren">(</span><em>name</em>, <em>starttime=0</em>, <em>extrainfo=''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/libnmap/process.html#NmapTask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libnmap.process.NmapTask" title="Permalink to this definition">Â¶</a></dt>
<dd><p>NmapTask is a internal class used by process. Each time nmap
starts a new task during the scan, a new class will be instanciated.
Classes examples are: âPing Scanâ, âNSE scriptâ, âDNS Resolveâ,..
To each class an estimated time to complete is assigned and updated
at least every second within the NmapProcess.
A property NmapProcess.current_task points to the running task at
time T and a dictionnary NmapProcess.tasks with âtask nameâ as key
is built during scan execution</p>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="parser.html" class="btn btn-neutral float-right" title="libnmap.parser" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="Welcome to libnmapâs documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright CC-BY 2013, Ronald Bister
      
        <span class="commit">
          Revision <code>c6cdee45</code>.
        </span>
      

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  



  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
   

</body>
</html>