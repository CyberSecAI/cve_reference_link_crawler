

![Japan Vulnerability Notes](/common/img/note_logo.gif)

Published:2022/03/15  Last Updated:2022/03/15
# JVN#87751554 Multiple vulnerabilities in pfSense

## Overview

pfSense contains multiple vulnerabilities.

## Products Affected

**CVE-2021-20729**

* pfSense CE software versions 2.5.2 and earlier
* pfSense Plus software versions 21.05 and earlier

**CVE-2022-26019, CVE-2022-24299**

* pfSense CE software versions prior to 2.6.0
* pfSense Plus software versions prior to 22.01

## Description

pfSense software provided by Netgate contains multiple vulnerabilities listed below.

* **Cross-site scripting ([CWE-79](https://cwe.mitre.org/data/definitions/79.html))** - CVE-2021-20729

  | CVSS v3 | CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N | **Base Score: 6.1** |
  | --- | --- | --- |
  | CVSS v2 | AV:N/AC:M/Au:N/C:N/I:P/A:N | **Base Score: 4.3** |
* **Improper access control ([CWE-284](https://cwe.mitre.org/data/definitions/284.html))** - CVE-2022-26019

  | CVSS v3 | CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H | **Base Score: 7.2** |
  | --- | --- | --- |
  | CVSS v2 | AV:N/AC:L/Au:S/C:C/I:C/A:C | **Base Score: 9.0** |
* **Improper input validation ([CWE-20](https://cwe.mitre.org/data/definitions/20.html))** - CVE-2022-24299

  | CVSS v3 | CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N | **Base Score: 5.4** |
  | --- | --- | --- |
  | CVSS v2 | AV:N/AC:L/Au:S/C:P/I:P/A:N | **Base Score: 5.5** |

## Impact

* An arbitrary script may be executed on a user's web browser when following a malicious URL to visit the captive portal login page - CVE-2021-20729
* A user with the privilege to change NTP GPS settings may rewrite existing files on the file system, resulting to arbitrary command execution - CVE-2022-26019
* A user with the privilege to change OpenVPN client or server settings may execute arbitrary commands - CVE-2022-24299

## Solution

**Update the software**

Update the software to the latest version according to the information provided by the developer.

## Vendor Status

| Vendor | Link |
| --- | --- |
| pfSense | [pfSense-SA-21\_02.captiveportal - XSS vulnerability in the WebGUI](https://docs.netgate.com/downloads/pfSense-SA-21_02.captiveportal.asc) |
|  | [pfSense-SA-22\_01.webgui - File overwrite vulnerability in the WebGUI](https://docs.netgate.com/downloads/pfSense-SA-22_01.webgui.asc) |
|  | [pfSense-SA-22\_03.webgui - Multiple vulnerabilities in the WebGUI](https://docs.netgate.com/downloads/pfSense-SA-22_03.webgui.asc) |
|  | [pfSense Open Source Firewall](https://www.pfsense.org/) |
|  | [Releases](https://docs.netgate.com/pfsense/en/latest/releases/index.html) |

## References

## JPCERT/CC Addendum

## Vulnerability Analysis by JPCERT/CC

## Credit

Yutaka WATANABE of Ierae Security Inc. reported these vulnerabilities to IPA.

JPCERT/CC coordinated with the developer under Information Security Early Warning Partnership.

## Other Information

| JPCERT Alert |  |
| --- | --- |
| JPCERT Reports |  |
| CERT Advisory |  |
| CPNI Advisory |  |
| TRnotes |  |
| CVE | [CVE-2021-20729](https://www.cve.org/CVERecord?id=CVE-2021-20729) |
|  | [CVE-2022-26019](https://www.cve.org/CVERecord?id=CVE-2022-26019) |
|  | [CVE-2022-24299](https://www.cve.org/CVERecord?id=CVE-2022-24299) |
| JVN iPedia | [JVNDB-2022-000020](https://jvndb.jvn.jp/jvndb/JVNDB-2022-000020) |

* JVN
* [HOME](/en/index.html)
* [What is JVN ?](/en/nav/jvn.html)
* [Instructions](/en/nav/jvnhelp.html)
* [List of Vulnerability Report](/en/report/index.html)
* [VN\_JP](/en/jp/index.html)
* [VN\_JP(Unreachable)](/en/adj/index.html)
* [VN\_VU](/en/vu/index.html)
* [TA](/en/ta/index.html)
* [TRnotes](/en/tr/index.html)
* [JVN iPedia](http://jvndb.jvn.jp/en/)
* [MyJVN](http://jvndb.jvn.jp/en/apis/myjvn/index.html)
* [JVNJS/RSS](/en/rss/index.html)
* [Vendor List](/en/nav/index.html)
* [List of unreachable developers](/en/reply/index.html)
* [Contact](/en/contact/index.html)

Copyright (c) 2000-2022 JPCERT/CC and IPA. All rights reserved.

