=== Content from docs.netgate.com_c7c4b057_20250108_143122.html ===
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
=============================================================================
pfSense-SA-22\_03.webgui Security Advisory
pfSense
Topic: Multiple vulnerabilities in the WebGUI
Category: pfSense Base System
Module: webgui
Announced: 2022-01-13
Credits: Yutaka WATANABE of Ierae Security, Inc. via JPCERT/CC
CVE ID: CVE-2022-24299
Affects: pfSense Plus software versions < 22.01
pfSense CE software versions < 2.6.0
Corrected: 2022-01-14 17:24:32 UTC (pfSense Plus master)
2022-01-17 17:45:31 UTC (pfSense Plus 22.01)
2022-01-14 17:24:32 UTC (pfSense CE master)
2022-01-17 17:45:31 UTC (pfSense CE 2.6.0)
0. Revision History
v1.2 2022-03-08 Removed JVN ID, added CVE ID, updated solution information.
v1.1 2022-02-14 Fix Redmine link
v1.0 2022-01-13 Initial SA draft
I. Background
pfSense® software is a free network firewall distribution based on the
FreeBSD operating system. The pfSense software distribution includes third-
party free software packages for additional functionality, and provides most of
the functionality of common commercial firewalls.
pfSense® Plus is the productized version of pfSense software from Netgate®,
previously referred to as pfSense Factory Edition (FE). It is available to
Netgate appliance and CSP customers.
The majority of users of pfSense software have never installed or used a stock
FreeBSD system. Unlike similar GNU/Linux-based firewall distributions, there
is no need for any UNIX knowledge. The command line is never used, and there
is no need to ever manually edit any rule sets. Instead, pfSense software
includes a web interface for the configuration of all included components.
Users familiar with commercial firewalls will quickly understand the web
interface, while those unfamiliar with commercial-grade firewalls may encounter
a short learning curve.
II. Problem Description
The vpn\_openvpn\_server.php and vpn\_openvpn\_client.php pages in the pfSense Plus
and pfSense CE software GUI did not properly validate user input passed via the
data\_ciphers parameter in certain cases. This problems is present on pfSense
Plus version 21.05.2, pfSense CE version 2.5.2, and earlier versions of both.
When the client or server mode was set to p2p\_shared\_key, the GUI did not
validate user input in the data\_ciphers parameter but the backend code still
included the value of data\_ciphers in the OpenVPN configuration. By passing
carefully crafted data including parameters which allow OpenVPN to execute
scripts, an attacker could execute arbitrary shell commands and read or write
arbitrary files.
NOTE: The Custom Options field on OpenVPN client and server configuration pages
also allows this type of action intentionally, but that field has a separate
privilege which can limit access to prevent users from altering its contents.
III. Impact
An authenticated attacker with access the to affected page, even without access
to the Custom Options field, could execute arbitrary shell commands, perform
privilege escalation, information disclosure, denial of service, or other
negative outcomes.
IV. Workaround
To help mitigate the problem on older releases, use one or more of the
following:
\* Limit access to the affected pages to trusted administrators only.
V. Solution
Users can upgrade to pfSense Plus software version 22.01 or later when
available, or pfSense CE software version 2.6.0 or later. This upgrade may be
performed in the web interface or from the console.
See https://docs.netgate.com/pfsense/en/latest/install/upgrade-guide.html
Users on pfSense Plus version 21.05.2 or pfSense pfSense CE version 2.5.2 may
apply the fix from the recommended patches list in the System Patches package.
Users may also manually apply the relevant revisions below using the System
Patches package on pfSense pfSense Plus version 21.05.2 or pfSense CE version
2.5.2 and possibly on earlier versions.
See https://docs.netgate.com/pfsense/en/latest/development/system-patches.html
VI. Correction details
The following list contains the correction revision commit ID for each
affected item.
Branch/path Revision
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
plus/plus-master 78ce96a9af3b2ab5159ef6623078bfc4b15f8a89
ba815f3d219e5bdf404be859e723db2ff0c9258c
plus/plus-RELENG\_22\_01 68afc597b0545b57b605ae8200954b1b5a89bcad
fae2f2d553f42479721db67fc4ff1ddb70caeffa
pfSense/master 78ce96a9af3b2ab5159ef6623078bfc4b15f8a89
ba815f3d219e5bdf404be859e723db2ff0c9258c
pfSense/RELENG\_2\_6\_0 68afc597b0545b57b605ae8200954b1b5a89bcad
fae2f2d553f42479721db67fc4ff1ddb70caeffa
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
VII. References
The latest revision of this advisory is available at
-----BEGIN PGP SIGNATURE-----
iQIzBAEBCgAdFiEE40XvjEU56XSUPIMdE7mH/ZIU+NoFAmInWR0ACgkQE7mH/ZIU
+NrSRQ//TZ79u1qK8Mrrc7XFc79EZPJGS7z4lK0OuhJ3V+ygFqkZEYPKjxxOBFWK
8SVn4NlzMTmiEoa136JhS4ONc519LNpLa/kaM0F0vuLcu/DywWpuzU6z5QpDL9jX
kDmA9lCzY4pDU53Uuy3FTXO6BMgQTWaIS16fcUz+s0DdZi0hweZQypSBYZe48zmJ
uzeJwY0TnDVYgJjriBn/nj6SMnN2DtSZmj+CpfHzQwTsl4P9RLXhoEBW9Vu0gaS7
cP1eKWWdJ1th5+Pt6KCFOuMiiWJ8O3j31xXSSsWiWLo7sUdd9It6CejaVP3w8cmn
tMOw4m2pyeB+/H2Ao6hxqsFXGZv5gFPeUcVP82sJihtWMM4aZkP/rDSqUDC6cJwV
fJ3hwfEhpfLFcxhlSDKAlLJSTQ9+Gnc7+0uC3mEcuDoApXuEo8yE0c6suqSKKsEb
qvQiYERXPHrmDI+4y0msuEYUGbETS71ibZbpykiy1CQEKnnipO63WkOZ1XkCtv9P
fwbiCN3xjz+XFKvT5EKJwhp0o0UjyYJxTjD8CLKQny0koy6mlo5R3J+5BjjktgYV
RjlJJIxuRvscmmlrumUcuZdnsiK8Uvkw0YODzfjabm5SIf0E0OXIIfNv2jxjCdSX
5jZUNF70lGqSVrUz9JEeH+OfpMkGLf4CE/cBYIE7rGC257tDcLE=
=n7jy
-----END PGP SIGNATURE-----


=== Content from jvn.jp_8ab8ee2e_20250108_143123.html ===


![Japan Vulnerability Notes](/common/img/note_logo.gif)

Published:2022/03/15  Last Updated:2022/03/15
# JVN#87751554 Multiple vulnerabilities in pfSense

## Overview

pfSense contains multiple vulnerabilities.

## Products Affected

**CVE-2021-20729**

* pfSense CE software versions 2.5.2 and earlier
* pfSense Plus software versions 21.05 and earlier

**CVE-2022-26019, CVE-2022-24299**

* pfSense CE software versions prior to 2.6.0
* pfSense Plus software versions prior to 22.01

## Description

pfSense software provided by Netgate contains multiple vulnerabilities listed below.

* **Cross-site scripting ([CWE-79](https://cwe.mitre.org/data/definitions/79.html))** - CVE-2021-20729

  | CVSS v3 | CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N | **Base Score: 6.1** |
  | --- | --- | --- |
  | CVSS v2 | AV:N/AC:M/Au:N/C:N/I:P/A:N | **Base Score: 4.3** |
* **Improper access control ([CWE-284](https://cwe.mitre.org/data/definitions/284.html))** - CVE-2022-26019

  | CVSS v3 | CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H | **Base Score: 7.2** |
  | --- | --- | --- |
  | CVSS v2 | AV:N/AC:L/Au:S/C:C/I:C/A:C | **Base Score: 9.0** |
* **Improper input validation ([CWE-20](https://cwe.mitre.org/data/definitions/20.html))** - CVE-2022-24299

  | CVSS v3 | CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N | **Base Score: 5.4** |
  | --- | --- | --- |
  | CVSS v2 | AV:N/AC:L/Au:S/C:P/I:P/A:N | **Base Score: 5.5** |

## Impact

* An arbitrary script may be executed on a user's web browser when following a malicious URL to visit the captive portal login page - CVE-2021-20729
* A user with the privilege to change NTP GPS settings may rewrite existing files on the file system, resulting to arbitrary command execution - CVE-2022-26019
* A user with the privilege to change OpenVPN client or server settings may execute arbitrary commands - CVE-2022-24299

## Solution

**Update the software**

Update the software to the latest version according to the information provided by the developer.

## Vendor Status

| Vendor | Link |
| --- | --- |
| pfSense | [pfSense-SA-21\_02.captiveportal - XSS vulnerability in the WebGUI](https://docs.netgate.com/downloads/pfSense-SA-21_02.captiveportal.asc) |
|  | [pfSense-SA-22\_01.webgui - File overwrite vulnerability in the WebGUI](https://docs.netgate.com/downloads/pfSense-SA-22_01.webgui.asc) |
|  | [pfSense-SA-22\_03.webgui - Multiple vulnerabilities in the WebGUI](https://docs.netgate.com/downloads/pfSense-SA-22_03.webgui.asc) |
|  | [pfSense Open Source Firewall](https://www.pfsense.org/) |
|  | [Releases](https://docs.netgate.com/pfsense/en/latest/releases/index.html) |

## References

## JPCERT/CC Addendum

## Vulnerability Analysis by JPCERT/CC

## Credit

Yutaka WATANABE of Ierae Security Inc. reported these vulnerabilities to IPA.

JPCERT/CC coordinated with the developer under Information Security Early Warning Partnership.

## Other Information

| JPCERT Alert |  |
| --- | --- |
| JPCERT Reports |  |
| CERT Advisory |  |
| CPNI Advisory |  |
| TRnotes |  |
| CVE | [CVE-2021-20729](https://www.cve.org/CVERecord?id=CVE-2021-20729) |
|  | [CVE-2022-26019](https://www.cve.org/CVERecord?id=CVE-2022-26019) |
|  | [CVE-2022-24299](https://www.cve.org/CVERecord?id=CVE-2022-24299) |
| JVN iPedia | [JVNDB-2022-000020](https://jvndb.jvn.jp/jvndb/JVNDB-2022-000020) |

* JVN
* [HOME](/en/index.html)
* [What is JVN ?](/en/nav/jvn.html)
* [Instructions](/en/nav/jvnhelp.html)
* [List of Vulnerability Report](/en/report/index.html)
* [VN\_JP](/en/jp/index.html)
* [VN\_JP(Unreachable)](/en/adj/index.html)
* [VN\_VU](/en/vu/index.html)
* [TA](/en/ta/index.html)
* [TRnotes](/en/tr/index.html)
* [JVN iPedia](http://jvndb.jvn.jp/en/)
* [MyJVN](http://jvndb.jvn.jp/en/apis/myjvn/index.html)
* [JVNJS/RSS](/en/rss/index.html)
* [Vendor List](/en/nav/index.html)
* [List of unreachable developers](/en/reply/index.html)
* [Contact](/en/contact/index.html)

Copyright (c) 2000-2022 JPCERT/CC and IPA. All rights reserved.


