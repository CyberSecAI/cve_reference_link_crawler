

[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# A user with only guest role in a project can download job artifacts that are only available for users with at least developer role

âš  **Please read [the process](https://gitlab.com/gitlab-org/release/docs/-/blob/master/general/security/developer.md) on how to fix security issues before starting to work on the issue. Vulnerabilities must be fixed in a security mirror.**

**[HackerOne report #2475135](https://hackerone.com/reports/2475135)** by `ricardobrito` on 2024-04-23, assigned to `GitLab Team`:

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

Hi team.

##### Summary

The latest version of gitlab introduced a new feature that allows us to control [who can download job artifacts](https://about.gitlab.com/releases/2024/04/18/gitlab-16-11-released/#control-who-can-download-job-artifacts). There are 3 options available:

* all: means anyone can download
* none: means no one can download
* developer: users with developer role or above can download

I have found a way to download the artifacts as a guest or reporter even if they have been set to be downloadable only by a developer.

##### Steps to reproduce

1. Create a project as user A
2. Put the following content inside your `.gitlab-ci.yml` file:

```
include:
  - template: Jobs/Dependency-Scanning.gitlab-ci.yml

build-job:
  stage: build
  script:
    - echo "Hello, $GITLAB_USER_LOGIN!"

test-job1:
  stage: test
  script:
    - echo "This job tests something new" > artifact.txt

  artifacts:
    paths:
      - artifact.txt
    access: 'developer'

test-job2:
  stage: test
  script:
    - echo "This job tests something, but takes more time than test-job1."
    - echo "After the echo commands complete, it runs the sleep command for 20 seconds"
    - echo "which simulates a test that runs 20 seconds longer than test-job1"
    - sleep 20

deploy-prod:
  stage: deploy
  script:
    - echo "This job deploys some stuff ( ... ) from the $CI_COMMIT_BRANCH branch."
  environment: production
```

If you look at the job called `test-job1` you will notice that we have set the access to developer by using: `access: developer`.

This means that only users with at least developer role in the project should be able to download the artifact produced by this job.

3. Commit the changes.

4. Now add user B as a guest to the project.

5. Now as user B, navigate to <http://gdk.test:3443/root/sample-project/-/jobs/>/, where `job-id` is the id of `test-job1` and you should see the following screen:

[![image.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/130e2c894d2173a59f51c0e6873812967338fc35/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f34373166313435622d316132352d343933332d383866302d3933623963356466323238642f696d6167652e706e67)

Still, as user B if you try to download the artifact by navigating to:

<http://gdk.test:3443/root/sample-project/-/jobs/job-id/artifacts/download>

You will get a 404 not found screen:

[![image.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/9545d160b4857438e6983e38e96e979d2582f87c/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f65643861363534332d376134302d343266332d386133302d6633386361653031333836352f696d6167652e706e67)

This is expected and correct behavior.

6. Still as user B, access the following link:

<http://gdk.test:3443/root/sample-project/-/jobs/job-id/artifacts/browse>

and you will see the following screen:

[![image.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/0ef8727d241f75dd05a90627858a4b21c8c23440/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f61363438396637302d616234322d346138362d613532652d3235306430663230653766342f696d6167652e706e67)

Now you can simply click on it and download it:

[![image.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/24b05c3e497c74acdaa178e2b39c22971a37d87d/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f64613233366231622d336437622d343838342d613436312d6139323630646462333236652f696d6167652e706e67)

And indeed you will be able to download it.

Another possible way to download the artifact is to directly access the following link:

<http://gdk.test:3443/root/sample-project/-/jobs/job-id/artifacts/raw/artifact.txt>

##### Impact

A user with only guest or reporter role is capable of downloading a job artifact that was set to be downloadable only by a user with at least developer role.

#### Impact

A user with only guest or reporter role is capable of downloading a job artifact that was set to be downloadable only by a user with at least developer role.

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [image.png](https://h1.sec.gitlab.net/a/471f145b-1a25-4933-88f0-93b9c5df228d/image.png)
* [image.png](https://h1.sec.gitlab.net/a/ed8a6543-7a40-42f3-8a30-f38cae013865/image.png)
* [image.png](https://h1.sec.gitlab.net/a/a6489f70-ab42-4a86-a52e-250d0f20e7f4/image.png)
* [image.png](https://h1.sec.gitlab.net/a/da236b1b-3d7b-4884-a461-a9260ddb326e/image.png)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.

