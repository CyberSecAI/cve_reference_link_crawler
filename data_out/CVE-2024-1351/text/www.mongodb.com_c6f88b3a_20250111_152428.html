[![MongoDB logo](https://webimages.mongodb.com/_com_assets/cms/kuyjf3vea2hg34taa-horizontal_default_slate_blue.svg?auto=format%252Ccompress)](https://www.mongodb.com)

* ProductsPlatform[![atlas_product_family](https://webimages.mongodb.com/_com_assets/icons/atlas_product_family.svg)AtlasBuild on a developer data platform](https://www.mongodb.com/atlas)Platform Services[![atlas_database](https://webimages.mongodb.com/_com_assets/icons/atlas_database.svg)DatabaseDeploy a multi-cloud database](https://www.mongodb.com/products/platform/atlas-database)[![atlas_search](https://webimages.mongodb.com/_com_assets/icons/atlas_search.svg)SearchDeliver engaging search experiences](https://www.mongodb.com/products/platform/atlas-search)[![mdb_vector_search](https://webimages.mongodb.com/_com_assets/icons/mdb_vector_search.svg)Vector SearchDesign intelligent apps with gen AI](https://www.mongodb.com/products/platform/atlas-vector-search)[![atlas_stream_processing](https://webimages.mongodb.com/_com_assets/icons/atlas_stream_processing.svg)Stream ProcessingUnify data in motion and data at rest](https://www.mongodb.com/products/platform/atlas-stream-processing)Self Managed[![enterprise_advanced_product family](https://webimages.mongodb.com/_com_assets/icons/enterprise_advanced_product family.svg)Enterprise AdvancedRun and manage MongoDB yourself](https://www.mongodb.com/products/self-managed/enterprise-advanced)[![community_edition_product_family](https://webimages.mongodb.com/_com_assets/icons/community_edition_product_family.svg)Community EditionDevelop locally with MongoDB](https://www.mongodb.com/products/self-managed/community-edition)Tools[![mdb_compass](https://webimages.mongodb.com/_com_assets/icons/mdb_compass.svg)CompassWork with MongoDB data in a GUI](https://www.mongodb.com/products/tools/compass)[![atlas_integration](https://webimages.mongodb.com/_com_assets/icons/atlas_integration.svg)IntegrationsIntegrations with third-party services](https://cloud.mongodb.com/ecosystem/?filter=integration)[![mdb_migrator](https://webimages.mongodb.com/_com_assets/icons/mdb_migrator.svg)Relational MigratorMigrate to MongoDB with confidence](https://www.mongodb.com/products/tools/relational-migrator)[View All ProductsExplore our full developer suitearrow-right](https://www.mongodb.com/products)Build with MongoDB AtlasGet started for free in minutes[Sign Up](https://www.mongodb.com/cloud/atlas/register)Test Enterprise AdvancedDevelop with MongoDB on-premises[Download](https://www.mongodb.com/try/download/enterprise)Try Community EditionExplore the latest version of MongoDB[Download](https://www.mongodb.com/try/download/community)
* ResourcesDocumentation[Atlas DocumentationGet started using Atlas](https://www.mongodb.com/docs/atlas/)[Server DocumentationLearn to use MongoDB](https://www.mongodb.com/docs/manual/)[Start With GuidesGet step-by-step guidance for key tasks](https://www.mongodb.com/docs/guides/) [Tools and ConnectorsLearn how to connect to MongoDB](https://www.mongodb.com/docs/tools-and-connectors/)[MongoDB DriversUse drivers and libraries for MongoDB](https://www.mongodb.com/docs/drivers/)[Resources HubGet help building the next big thing with MongoDBarrow-right](https://www.mongodb.com/resources)Connect[![atlas_product_family](https://webimages.mongodb.com/_com_assets/icons/atlas_product_family.svg)Developer CenterExplore a wide range of developer resources](https://www.mongodb.com/developer/)[![general_events_ask_the_experts](https://webimages.mongodb.com/_com_assets/icons/general_events_ask_the_experts.svg)CommunityJoin a global community of developers](https://www.mongodb.com/community/)[![general_content_tutorial](https://webimages.mongodb.com/_com_assets/icons/general_content_tutorial.svg)Courses and CertificationLearn for free from MongoDB](https://learn.mongodb.com/)[![general_events_session](https://webimages.mongodb.com/_com_assets/icons/general_events_session.svg)Events and WebinarsFind an event or webinar near you](https://www.mongodb.com/events)
* SolutionsUse cases[Artificial Intelligence](https://www.mongodb.com/solutions/use-cases/artificial-intelligence)[Edge Computing](https://www.mongodb.com/use-cases/atlas-for-the-edge)[Internet of Things](https://www.mongodb.com/solutions/use-cases/internet-of-things)[Mobile](https://www.mongodb.com/solutions/use-cases/mobile)[Payments](https://www.mongodb.com/solutions/use-cases/payments)[Serverless Development](https://www.mongodb.com/solutions/use-cases/serverless)Industries[Financial Services](https://www.mongodb.com/solutions/industries/financial-services)[Telecommunications](https://www.mongodb.com/solutions/industries/telecommunications)[Healthcare](https://www.mongodb.com/solutions/industries/healthcare)[Retail](https://www.mongodb.com/solutions/industries/retail)[Public Sector](https://www.mongodb.com/solutions/industries/public-sector)[Manufacturing](https://www.mongodb.com/solutions/industries/manufacturing)[Solutions LibraryOrganized and tailored solutions to kick-start projectsarrow-right](https://www.mongodb.com/solutions/solutions-library)Developer Data PlatformAccelerate innovation at scale[Learn morearrow-right](https://www.mongodb.com/solutions/developer-data-platform)Startups and AI InnovatorsFor world-changing ideas and AI pioneers[Learn morearrow-right](https://www.mongodb.com/solutions/startups)Customer Case StudiesHear directly from our users[See Storiesarrow-right](https://www.mongodb.com/library/customer-case-studies)
* Company[CareersStart your next adventure](https://www.mongodb.com/company/careers)[BlogRead articles and announcements](https://www.mongodb.com/blog)[NewsroomRead press releases and news stories](https://www.mongodb.com/company/newsroom)[PartnersLearn about our partner ecosystem](https://www.mongodb.com/company/partners)[LeadershipMeet our executive team](https://www.mongodb.com/company/leadership)[CompanyLearn more about who we are](https://www.mongodb.com/company)Contact UsReach out to MongoDB[Letâs chatarrow-right](https://www.mongodb.com/company/contact)InvestorsVisit our investor portal[Learn morearrow-right](https://investors.mongodb.com/)
* [Pricing](https://www.mongodb.com/pricing)

![Language Selector Icon](https://webimages.mongodb.com/_com_assets/cms/lvz91dv3bugodsyau-language-selector-globe.svg?auto=format%252Ccompress)Eng[Support](https://www.mongodb.com/services/support)[Sign In](https://account.mongodb.com/account/login)[Try Free](https://www.mongodb.com/cloud/atlas/register)menu-vertical[![MongoDB logo](https://webimages.mongodb.com/_com_assets/cms/kuyjf3vea2hg34taa-horizontal_default_slate_blue.svg?auto=format%252Ccompress)](https://www.mongodb.com)[![MongoDB logo](https://webimages.mongodb.com/_com_assets/cms/kuyj3d95v5vbmm2f4-horizontal_white.svg?auto=format%252Ccompress)](https://www.mongodb.com)

* ProductsPlatform[![atlas_product_family](https://webimages.mongodb.com/_com_assets/icons/atlas_product_family_inverse.svg)AtlasBuild on a developer data platform](https://www.mongodb.com/atlas)Platform Services[![atlas_database](https://webimages.mongodb.com/_com_assets/icons/atlas_database_inverse.svg)DatabaseDeploy a multi-cloud database](https://www.mongodb.com/products/platform/atlas-database)[![atlas_search](https://webimages.mongodb.com/_com_assets/icons/atlas_search_inverse.svg)SearchDeliver engaging search experiences](https://www.mongodb.com/products/platform/atlas-search)[![mdb_vector_search](https://webimages.mongodb.com/_com_assets/icons/mdb_vector_search_inverse.svg)Vector SearchDesign intelligent apps with gen AI](https://www.mongodb.com/products/platform/atlas-vector-search)[![atlas_stream_processing](https://webimages.mongodb.com/_com_assets/icons/atlas_stream_processing_inverse.svg)Stream ProcessingUnify data in motion and data at rest](https://www.mongodb.com/products/platform/atlas-stream-processing)Self Managed[![enterprise_advanced_product family](https://webimages.mongodb.com/_com_assets/icons/enterprise_advanced_product family_inverse.svg)Enterprise AdvancedRun and manage MongoDB yourself](https://www.mongodb.com/products/self-managed/enterprise-advanced)[![community_edition_product_family](https://webimages.mongodb.com/_com_assets/icons/community_edition_product_family_inverse.svg)Community EditionDevelop locally with MongoDB](https://www.mongodb.com/products/self-managed/community-edition)Tools[![mdb_compass](https://webimages.mongodb.com/_com_assets/icons/mdb_compass_inverse.svg)CompassWork with MongoDB data in a GUI](https://www.mongodb.com/products/tools/compass)[![atlas_integration](https://webimages.mongodb.com/_com_assets/icons/atlas_integration_inverse.svg)IntegrationsIntegrations with third-party services](https://cloud.mongodb.com/ecosystem/?filter=integration)[![mdb_migrator](https://webimages.mongodb.com/_com_assets/icons/mdb_migrator_inverse.svg)Relational MigratorMigrate to MongoDB with confidence](https://www.mongodb.com/products/tools/relational-migrator)[View All ProductsExplore our full developer suitearrow-right](https://www.mongodb.com/products)Build with MongoDB AtlasGet started for free in minutes[Sign Up](https://www.mongodb.com/cloud/atlas/register)Test Enterprise AdvancedDevelop with MongoDB on-premises[Download](https://www.mongodb.com/try/download/enterprise)Try Community EditionExplore the latest version of MongoDB[Download](https://www.mongodb.com/try/download/community)
* ResourcesDocumentation[Atlas DocumentationGet started using Atlas](https://www.mongodb.com/docs/atlas/)[Server DocumentationLearn to use MongoDB](https://www.mongodb.com/docs/manual/)[Start With GuidesGet step-by-step guidance for key tasks](https://www.mongodb.com/docs/guides/) [Tools and ConnectorsLearn how to connect to MongoDB](https://www.mongodb.com/docs/tools-and-connectors/)[MongoDB DriversUse drivers and libraries for MongoDB](https://www.mongodb.com/docs/drivers/)[Resources HubGet help building the next big thing with MongoDBarrow-right](https://www.mongodb.com/resources)Connect[![atlas_product_family](https://webimages.mongodb.com/_com_assets/icons/atlas_product_family_inverse.svg)Developer CenterExplore a wide range of developer resources](https://www.mongodb.com/developer/)[![general_events_ask_the_experts](https://webimages.mongodb.com/_com_assets/icons/general_events_ask_the_experts_inverse.svg)CommunityJoin a global community of developers](https://www.mongodb.com/community/)[![general_content_tutorial](https://webimages.mongodb.com/_com_assets/icons/general_content_tutorial_inverse.svg)Courses and CertificationLearn for free from MongoDB](https://learn.mongodb.com/)[![general_events_session](https://webimages.mongodb.com/_com_assets/icons/general_events_session_inverse.svg)Events and WebinarsFind an event or webinar near you](https://www.mongodb.com/events)
* SolutionsUse cases[Artificial Intelligence](https://www.mongodb.com/solutions/use-cases/artificial-intelligence)[Edge Computing](https://www.mongodb.com/use-cases/atlas-for-the-edge)[Internet of Things](https://www.mongodb.com/solutions/use-cases/internet-of-things)[Mobile](https://www.mongodb.com/solutions/use-cases/mobile)[Payments](https://www.mongodb.com/solutions/use-cases/payments)[Serverless Development](https://www.mongodb.com/solutions/use-cases/serverless)Industries[Financial Services](https://www.mongodb.com/solutions/industries/financial-services)[Telecommunications](https://www.mongodb.com/solutions/industries/telecommunications)[Healthcare](https://www.mongodb.com/solutions/industries/healthcare)[Retail](https://www.mongodb.com/solutions/industries/retail)[Public Sector](https://www.mongodb.com/solutions/industries/public-sector)[Manufacturing](https://www.mongodb.com/solutions/industries/manufacturing)[Solutions LibraryOrganized and tailored solutions to kick-start projectsarrow-right](https://www.mongodb.com/solutions/solutions-library)Developer Data PlatformAccelerate innovation at scale[Learn morearrow-right](https://www.mongodb.com/solutions/developer-data-platform)Startups and AI InnovatorsFor world-changing ideas and AI pioneers[Learn morearrow-right](https://www.mongodb.com/solutions/startups)Customer Case StudiesHear directly from our users[See Storiesarrow-right](https://www.mongodb.com/library/customer-case-studies)
* Company[CareersStart your next adventure](https://www.mongodb.com/company/careers)[BlogRead articles and announcements](https://www.mongodb.com/blog)[NewsroomRead press releases and news stories](https://www.mongodb.com/company/newsroom)[PartnersLearn about our partner ecosystem](https://www.mongodb.com/company/partners)[LeadershipMeet our executive team](https://www.mongodb.com/company/leadership)[CompanyLearn more about who we are](https://www.mongodb.com/company)Contact UsReach out to MongoDB[Letâs chatarrow-right](https://www.mongodb.com/company/contact)InvestorsVisit our investor portal[Learn morearrow-right](https://investors.mongodb.com/)
* [Pricing](https://www.mongodb.com/pricing)

![Language Selector Icon](https://webimages.mongodb.com/_com_assets/cms/lzsle5raf6v32fw36-language-selector-globe-dark-mode.svg?auto=format%252Ccompress)Eng[Support](https://www.mongodb.com/services/support)[Sign In](https://account.mongodb.com/account/login)[Try Free](https://www.mongodb.com/cloud/atlas/register)menu-vertical[![MongoDB logo](https://webimages.mongodb.com/_com_assets/cms/kuyj3d95v5vbmm2f4-horizontal_white.svg?auto=format%252Ccompress)](https://www.mongodb.com)

* [Docs Home](https://www.mongodb.com/docs/)

---

* [MongoDB Manual](/docs/v6.0/)
6.0* [Introduction](/docs/v6.0/introduction/)
* [CRUD Operations](/docs/v6.0/crud/)
* [Aggregation Operations](/docs/v6.0/aggregation/)
* [Indexes](/docs/v6.0/indexes/)
* [Atlas Search](https://www.mongodb.com/docs/atlas/atlas-search/?tck=docs_server_toc)
* [Atlas Vector Search](https://www.mongodb.com/docs/atlas/atlas-vector-search/vector-search-overview/?tck=docs_server_toc)
* [Time Series](/docs/v6.0/core/timeseries-collections/)
* [Change Streams](/docs/v6.0/changeStreams/)
* [Transactions](/docs/v6.0/core/transactions/)
* Data Modeling
* [Replication](/docs/v6.0/replication/)
* [Sharding](/docs/v6.0/sharding/)
* [Storage](/docs/v6.0/storage/)
* [Administration](/docs/v6.0/administration/)
* [Security](/docs/v6.0/security/)
* [Self-Managed Deployments](/docs/v6.0/self-managed-deployments/)
* FAQ
* [Reference](/docs/v6.0/reference/)
* [Release Notes](/docs/v6.0/release-notes/)
* [6.0](/docs/v6.0/release-notes/6.0/)
* [Compatibility Changes](/docs/v6.0/release-notes/6.0-compatibility/)
* Upgrade 5.0 to 6.0
* [Downgrade 6.0 to 5.0](/docs/v6.0/release-notes/6.0-downgrade/)
* [Changelog](/docs/v6.0/release-notes/6.0-changelog/)
* [5.0](/docs/v6.0/release-notes/5.0/)
* [Versioning](/docs/v6.0/reference/versioning/)
* [Technical Support](/docs/v6.0/support/)

Docs MenuAsk MongoDB AIRate This Page[Docs Home](https://www.mongodb.com/docs/) / [MongoDB Manual](/docs/v6.0/) / [Release Notes](/docs/v6.0/release-notes/)
# Release Notes for MongoDB 6.0

On this page

* [Patch Releases](#patch-releases)
* [Aggregation](#aggregation)
* [Change Streams](#change-streams)
* [Cluster Administration](#cluster-administration)
* [Clustered Collections](#clustered-collections)
* [Indexes](#indexes)
* [Installation](#installation)
* [Platform Support](#platform-support)
* [Replica Sets](#replica-sets)
* [Security](#security)
* [Server Parameters](#server-parameters)
* [Sharding](#sharding)
* [Slot-Based Query Execution Engine](#slot-based-query-execution-engine)
* [Stable API](#stable-api)
* [Time Series Collections](#time-series-collections)
* [General Improvements](#general-improvements)
* [Changes Affecting Compatibility](#changes-affecting-compatibility)
* [Upgrade Procedures](#upgrade-procedures)
* [Downgrade Consideration](#downgrade-consideration)
* [Download](#download)
* [Known Issues](#known-issues)
* [Report an Issue](#report-an-issue)

This page describes changes and new features introduced in MongoDB 6.0.

MongoDB 6.0 is a Major Release, which means that it is supported for
both MongoDB Atlas and on-premises deployments. MongoDB 6.0 includes
changes introduced in MongoDB Rapid Releases 5.1, 5.2, and 5.3. This
page describes changes introduced in those Rapid Releases and MongoDB
6.0.

To learn more about the differences between Major and Rapid releases,
see [MongoDB Versioning.](/docs/v6.0/reference/versioning/#std-label-release-version-numbers)

## Warning

### **Past Release Limitations**

The Critical Advisories below affect some prior MongoDB versions. If your
deployment depends on features impacted by a Critical Advisory, upgrade to
the latest available patch release.

| Issue | Affected Versions |
| --- | --- |
| [SERVER-68511](https://jira.mongodb.org/browse/SERVER-68511) | 6.0.0 |
| [SERVER-77506](https://jira.mongodb.org/browse/SERVER-77506) | 6.0.0 - 6.0.12 |
| [SERVER-80203](https://jira.mongodb.org/browse/SERVER-80203) | 6.0.0 - 6.0.11 (Time Series collections sharded by metaField embedded objects) |
| [SERVER-82353](https://jira.mongodb.org/browse/SERVER-82353) | 6.0.0 - 6.0.13 |
| [WT-10461](https://jira.mongodb.org/browse/WT-10461) | 6.0.0 - 6.0.4 (ARM64 or POWER system architectures) |
| [WT-10551](https://jira.mongodb.org/browse/WT-10551) | 6.0.0 - 6.0.5 (Incremental backups on Ops Manager or Cloud Manager clusters) |
| [SERVER-91194](https://jira.mongodb.org/browse/SERVER-91194) | 6.0.0 - 6.0.16 |
| [SERVER-86622](https://jira.mongodb.org/browse/SERVER-86622) | 6.0.0 - 6.0.14 |

## Patch Releases

### 6.0.20 - Upcoming

* [SERVER-93205](https://jira.mongodb.org/browse/SERVER-93205) Expose number of prepareUnique indexes in serverStatus
* [SERVER-94144](https://jira.mongodb.org/browse/SERVER-94144) $documents inside $lookup fails to parse with QueryStats
* [SERVER-94592](https://jira.mongodb.org/browse/SERVER-94592) Check inner arguments for explain
* [SERVER-94635](https://jira.mongodb.org/browse/SERVER-94635) Make session refresh parameters configurable
* [SERVER-95445](https://jira.mongodb.org/browse/SERVER-95445) SSLManagerOpenSSL should validate entire cert chain
  against CRL
* [All Jira issues closed in 6.0.20](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D6.0.20)
* [6.0.20 Changelog](/docs/v6.0/release-notes/6.0-changelog/#std-label-6.0.20-changelog)

### 6.0.19 - Oct 24, 2024

## Important

### **Improper neutralization of null bytes may lead to buffer over-reads in MongoDB Server**

In MongoDB 6.0 prior to 6.0.19, an authorized user may trigger crashes or
receive the contents of buffer over-reads of Server memory by
issuing specially crafted requests that construct malformed BSON
in the MongoDB Server.

This issue affects MongoDB Server versions:

* 5.0.0 - 5.0.29
* 6.0.0 - 6.0.18
* 7.0.0 - 7.0.14
* 8.0.0 - 8.0.2

* [SERVER-96419](https://jira.mongodb.org/browse/SERVER-96419) Improper neutralization of null bytes may lead
  to buffer over-reads in MongoDB Server
* [All Jira issues closed in 6.0.19](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D6.0.19)
* [6.0.19 Changelog](/docs/v6.0/release-notes/6.0-changelog/#std-label-6.0.19-changelog)

### 6.0.18 - Sep 30, 2024

* [SERVER-70508](https://jira.mongodb.org/browse/SERVER-70508) Add current thread count to extra\_info in serverStatus
  on Linux
* [SERVER-94166](https://jira.mongodb.org/browse/SERVER-94166) Disable the SBE query engine in v6.0
* [SERVER-94170](https://jira.mongodb.org/browse/SERVER-94170) Revert [SERVER-91570](https://jira.mongodb.org/browse/SERVER-91570)
* [All Jira issues closed in 6.0.18](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D6.0.18)
* [6.0.18 Changelog](/docs/v6.0/release-notes/6.0-changelog/#std-label-6.0.18-changelog)

### 6.0.17 - Aug 21, 2024

## Important

### **Fix for CSFLE and Queryable Encryption self-lookup may send values in subpipelines as plaintext instead of ciphertext**

Due to CVE-2024-8013, in MongoDB 6.0 prior to 6.0.16, a bug in query analysis of
certain complex self-referential [`$lookup`](/docs/v6.0/reference/operator/aggregation/lookup/#mongodb-pipeline-pipe.-lookup) subpipelines
may result in literal values in expressions for encrypted fields
being sent to the server malformed.

Should this occur, no documents are returned or written.
This issue affects the `mongocryptd` binary and `mongo_crypt_v1`
shared library in the following MongoDB Server versions:

* 7.3.0 - 7.3.3
* 7.0.0 - 7.0.11
* 6.0.0 - 6.0.16
* 5.0.0 - 5.0.28

**CVSS Score**: 2.2

**CWE**: CWE-319: Cleartext Transmission of Sensitive Information

* [SERVER-96254](https://jira.mongodb.org/browse/SERVER-96254) CSFLE and Queryable Encryption self-lookup may
  fail to encrypt values in subpipelines
* [SERVER-85892](https://jira.mongodb.org/browse/SERVER-85892) $merge with pipeline after $documents returns
  error
* [SERVER-91195](https://jira.mongodb.org/browse/SERVER-91195) Provide a generic backportable solution not
  to miss top-level timeseries collection options
* [SERVER-91362](https://jira.mongodb.org/browse/SERVER-91362) Performance: Do not copy JS "scope" object
  if a cached JsExecution exists
* [SERVER-91406](https://jira.mongodb.org/browse/SERVER-91406) $changeStreamSplitLargeEvent returns
  Location7182803 error when used with non-renameable match expression
* [WT-12708](https://jira.mongodb.org/browse/WT-12708) Evaluation/Revision of eviction random traversal
* [All Jira issues closed in 6.0.17](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D6.0.17)
* [6.0.17 Changelog](/docs/v6.0/release-notes/6.0-changelog/#std-label-6.0.17-changelog)

### 6.0.16 - Jun 28, 2024

* [SERVER-79637](https://jira.mongodb.org/browse/SERVER-79637) Incorrect query results in `$lookup` with TS
  foreign collection using a correlated predicate
* [SERVER-86474](https://jira.mongodb.org/browse/SERVER-86474) $\_internalApplyOplogUpdate with `$set: { foo:
  Timestamp(0, 0) }` is not replicated correctly
* [SERVER-89625](https://jira.mongodb.org/browse/SERVER-89625) Handle directoryPerDb and
  wiredTigerDirectoryForIndexes correctly when reporting namespaces and
  UUIDs during a backup
* [WT-10807](https://jira.mongodb.org/browse/WT-10807) Skip in-memory deleted pages as part of the tree
  walk
* [WT-12609](https://jira.mongodb.org/browse/WT-12609) Improve checkpoint cleanup and page eviction logic
* [All Jira issues closed in 6.0.16](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D%276.0.16%27)
* [6.0.16 Changelog](/docs/v6.0/release-notes/6.0-changelog/#std-label-6.0.16-changelog)

### 6.0.15 - Apr 18, 2024

* [SERVER-72703](https://jira.mongodb.org/browse/SERVER-72703) Downgrade $out's db lock to MODE\_IX
* [SERVER-78556](https://jira.mongodb.org/browse/SERVER-78556) Return default of internalInsertMaxBatchSize to 64
* [SERVER-80363](https://jira.mongodb.org/browse/SERVER-80363) server default writeConcern is not honored when wtimeout
  is set
* [SERVER-83602](https://jira.mongodb.org/browse/SERVER-83602) $or -> $in MatchExpression rewrite should not generate
  $or directly nested in another $or
* [WT-11062](https://jira.mongodb.org/browse/WT-11062) Safe free the ref addr to allow concurrent access
* [All Jira issues closed in 6.0.15](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D%276.0.15%27)
* [6.0.15 Changelog](/docs/v6.0/release-notes/6.0-changelog/#std-label-6.0.15-changelog)

### 6.0.14 - Feb 28, 2024

## Important

### **Fix for MongoDB Server may allow successful untrusted connection**

Due to CVE-2024-1351, in MongoDB 6.0 prior to 6.0.14, under certain
configurations of [`--tlsCAFile`](/docs/v6.0/reference/program/mongod/#std-option-mongod.--tlsCAFile) and
[`CAFile`](/docs/v6.0/reference/configuration-options/#mongodb-setting-net.tls.CAFile), MongoDB Server may skip peer certificate
validation which may result in untrusted connections to succeed.

This may effectively reduce the security guarantees provided by TLS
and open connections that should have been closed due to failing
certificate validation. This issue affects the following MongoDB
Server versions:

* 7.0.0 - 7.0.5
* 6.0.0 - 6.0.13
* 5.0.0 - 5.0.24
* 4.4.0 - 4.4.28

**CVSS Score**: 8.8

**CWE**: CWE-295: Improper Certificate Validation

* [SERVER-82353](https://jira.mongodb.org/browse/SERVER-82353) Multi-document transactions can miss documents
  when movePrimary runs concurrently
* [SERVER-83119](https://jira.mongodb.org/browse/SERVER-83119) Secondary replica crashes on clustered
  collection if notablescan is enabled
* [SERVER-83145](https://jira.mongodb.org/browse/SERVER-83145) Shared buffer fragment incorrectly tracks
  memory usage in freeUnused()
* [SERVER-83564](https://jira.mongodb.org/browse/SERVER-83564) Make sure the process field is indexed in
  config.locks
* [WT-12077](https://jira.mongodb.org/browse/WT-12077) Incorrect hardware checksum calculation on zSeries
  for buffers on stack
* [All Jira issues closed in 6.0.14](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D%276.0.14%27)
* [6.0.14 Changelog](/docs/v6.0/release-notes/6.0-changelog/#std-label-6.0.14-changelog)

### 6.0.13 - Jan 18, 2024

* [SERVER-33494](https://jira.mongodb.org/browse/SERVER-33494) WT SizeStorer never deletes old entries
* [SERVER-50792](https://jira.mongodb.org/browse/SERVER-50792) Return more useful errors when a shard key index
  can't be found for shardCollection/refineCollectionShardKey
* [SERVER-70155](https://jira.mongodb.org/browse/SERVER-70155) Add duration of how long an oplog slot is kept
  open to mongod "Slow query" log lines
* [SERVER-77506](https://jira.mongodb.org/browse/SERVER-77506) Sharded multi-document transactions can mismatch
  data and ShardVersion
* [SERVER-83091](https://jira.mongodb.org/browse/SERVER-83091) $or query can trigger an infinite loop during
  plan enumeration
* [All Jira issues closed in 6.0.13](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D%276.0.13%27)
* [6.0.13 Changelog](/docs/v6.0/release-notes/6.0-changelog/#std-label-6.0.13-changelog)

### 6.0.12 - Nov 27, 2023

* [SERVER-69244](https://jira.mongodb.org/browse/SERVER-69244) $merge fails when session default read concern
  has been set to "majority"
* [SERVER-81295](https://jira.mongodb.org/browse/SERVER-81295) Cannot resume V2 changeStream pipelines with V1
  resume tokens
* [SERVER-81966](https://jira.mongodb.org/browse/SERVER-81966) Avoid modification of previous ChunkMap
  instances during refresh
* [WT-7929](https://jira.mongodb.org/browse/WT-7929) Investigate a solution to avoid FTDC stalls during
  checkpoint
* [WT-11564](https://jira.mongodb.org/browse/WT-11564) Fix RTS to read the newest transaction value only
  when it exists in the checkpoint
* [All Jira issues closed in 6.0.12](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D%276.0.12%27)
* [6.0.12 Changelog](/docs/v6.0/release-notes/6.0-changelog/#std-label-6.0.12-changelog)

### 6.0.11 - Oct 11, 2023

* [SERVER-58534](https://jira.mongodb.org/browse/SERVER-58534) Collect FCV in FTDC
* [SERVER-69244](https://jira.mongodb.org/browse/SERVER-69244) $merge fails when session default read concern has been
  set to "majority"
* [SERVER-71520](https://jira.mongodb.org/browse/SERVER-71520) Dump all thread stacks on RSTL acquisition timeout
* [SERVER-79498](https://jira.mongodb.org/browse/SERVER-79498) Backport $vectorSearch to 6.0
* [SERVER-80021](https://jira.mongodb.org/browse/SERVER-80021) Make $convert round-trip correctly between double and string
* [All Jira issues closed in 6.0.11](https://jira.mongodb.org/browse/SERVER-81762?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D6.0.11)
* [6.0.11 Changelog](/docs/v6.0/release-notes/6.0-changelog/#std-label-6.0.11-changelog)

### 6.0.10 - Sep 14, 2023

* [SERVER-71627](https://jira.mongodb.org/browse/SERVER-71627) Refreshed cached collection route info severely
  blocks all client request when a cluster contains 1 million chunks
* [SERVER-73394](https://jira.mongodb.org/browse/SERVER-73394) Remove misleading operationsBlockedByRefresh metrics
* [SERVER-77183](https://jira.mongodb.org/browse/SERVER-77183) $project followed by $group sometimes gives incorrect
  results
* [SERVER-79771](https://jira.mongodb.org/browse/SERVER-79771) Make resharding operations resilient to
  networkInterfaceExceededTimeLimit
  [All Jira issues closed in 6.0.10](https://jira.mongodb.org/browse/SERVER-80810?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D6.0.10)
* [6.0.10 Changelog](/docs/v6.0/release-notes/6.0-changelog/#std-label-6.0.10-changelog)

### 6.0.9 - Aug 14, 2023

* [SERVER-60466](https://jira.mongodb.org/browse/SERVER-60466) Support drivers gossiping signed $clusterTimes to
  replica set --shardsvrs before addShard runs
* [SERVER-74954](https://jira.mongodb.org/browse/SERVER-74954) Incorrect result when contained $or rewrites
  $elemMatch extra condition
* [SERVER-79136](https://jira.mongodb.org/browse/SERVER-79136) Incorrect query result of $match + $group on metaField
  over time-series
* [WT-10759](https://jira.mongodb.org/browse/WT-10759) Do not retry to force evict history store pages during
  reconciliation
* [WT-11064](https://jira.mongodb.org/browse/WT-11064) Skip globally visible tombstones as part of update obsolete
  check
* [All Jira issues closed in 6.0.9](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D%276.0.9%27)
* [6.0.9 Changelog](/docs/v6.0/release-notes/6.0-changelog/#std-label-6.0.9-changelog)

### 6.0.8 - Jul 13, 2023

* [SERVER-61127](https://jira.mongodb.org/browse/SERVER-61127) Multi-writes may exhaust the number of retry attempts
  in the presence of ongoing chunk migrations
* [SERVER-77005](https://jira.mongodb.org/browse/SERVER-77005) Leave LDAP users logged-in during LDAP downtime
* [SERVER-78126](https://jira.mongodb.org/browse/SERVER-78126) For specific kinds of input, mongo::Value() always hashes to the same result on big-endian platforms
* [All Jira issues closed in 6.0.8](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D%276.0.8%27)
* [6.0.8 Changelog](/docs/v6.0/release-notes/6.0-changelog/#std-label-6.0.8-changelog)

### 6.0.7 - Jun 28, 2023

* [SERVER-71985](https://jira.mongodb.org/browse/SERVER-71985) Automatically retry time series insert on DuplicateKey
  error
* [SERVER-73007](https://jira.mongodb.org/browse/SERVER-73007) CURL\_OPT\_SEEKFUNCTION not set for multi-pass
  authentication
* [SERVER-74551](https://jira.mongodb.org/browse/SERVER-74551) WriteConflictException unnecessarily logged as warning
  during findAndModify after upgrade to mongo 5.0
* [SERVER-77018](https://jira.mongodb.org/browse/SERVER-77018) Deadlock between dbStats and 2 index builds
* [WT-10449](https://jira.mongodb.org/browse/WT-10449) Do not save update chain when there are no updates
  to be written to the history store
* [WT-11031](https://jira.mongodb.org/browse/WT-11031) Fix RTS to skip tables with no time window information
  in the checkpoint
* [All Jira issues closed in 6.0.7](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D%276.0.7%27)
* [6.0.7 Changelog](/docs/v6.0/release-notes/6.0-changelog/#std-label-6.0.7-changelog)

### 6.0.6 - May 12, 2023

* [SERVER-51835](https://jira.mongodb.org/browse/SERVER-51835) Mongos readPreferenceTags are not working as expected
* [SERVER-67105](https://jira.mongodb.org/browse/SERVER-67105) $in queries do not use clustered index
* [SERVER-72774](https://jira.mongodb.org/browse/SERVER-72774) A node in quiesce mode can win election
* [SERVER-74930](https://jira.mongodb.org/browse/SERVER-74930) $avg is returning the sum instead of the average in aggregate $group
* [SERVER-75205](https://jira.mongodb.org/browse/SERVER-75205) Deadlock between stepdown and restoring locks after yielding when all read tickets exhausted
* [All Jira issues closed in 6.0.6](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D%276.0.6%27)
* [6.0.6 Changelog](/docs/v6.0/release-notes/6.0-changelog/#std-label-6.0.6-changelog)

### 6.0.5 - Mar 13, 2023

## Warning

If you upgrade an existing instance of MongoDB to MongoDB
6.0.5, that instance may fail to start if `fork: true` is
set in the `mongod.conf` file.

The upgrade issue affects all MongoDB instances that use `.deb` or
`.rpm` installation packages. Installations that use the tarball
(`.tgz`) release or other package types are not affected. For more
information, see [SERVER-74345.](https://jira.mongodb.org/browse/SERVER-74345)

To remove the `fork: true` setting, run these commands from a system
terminal:

```

| systemctl stop mongod.service |
| --- |
| sed -i.bak '/fork: true/d' /etc/mongod.conf |
| systemctl start mongod.service |

```

The second `systemctl` command starts the upgraded instance after the
setting is removed.

Issues Fixed:

* [SERVER-61909](https://jira.mongodb.org/browse/SERVER-61909) Hang inserting or deleting document with large
  number of index entries
* [SERVER-66469](https://jira.mongodb.org/browse/SERVER-66469) Filtering timeseries with date-field does not
  include results from before 1970
* [SERVER-68122](https://jira.mongodb.org/browse/SERVER-68122) Investigate replicating the collection
  WiredTiger config string during initial sync
* [SERVER-70395](https://jira.mongodb.org/browse/SERVER-70395) Slot-Based Engine too aggressively uses disk for
  $group and is slow
* [SERVER-73232](https://jira.mongodb.org/browse/SERVER-73232) Change the default log-verbosity for
  `_killOperations`
* [All JIRA issues closed in 6.0.5](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D%276.0.5%27)
* [6.0.5 Changelog](/docs/v6.0/release-notes/6.0-changelog/#std-label-6.0.5-changelog)

### 6.0.4 - Jan 26, 2023

Issues Fixed:

* [SERVER-72416](https://jira.mongodb.org/browse/SERVER-72416) The find and findAndModify projection code
  does not honor the collection level collation
* [SERVER-71759](https://jira.mongodb.org/browse/SERVER-71759) [`dataSize`](/docs/v6.0/reference/command/dataSize/#mongodb-dbcommand-dbcmd.dataSize) command doesn't yield
* [SERVER-70237](https://jira.mongodb.org/browse/SERVER-70237) Chunks merge commit must not create a BSON object
  too large
* [SERVER-72222](https://jira.mongodb.org/browse/SERVER-72222) [`mapReduce`](/docs/v6.0/reference/command/mapReduce/#mongodb-dbcommand-dbcmd.mapReduce) with single reduce
  optimization fails when merging results in sharded cluster
* [WT-9268](https://jira.mongodb.org/browse/WT-9268) Delay deletion of the history store record
  to reconciliation
* [All JIRA issues closed in 6.0.4](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D%276.0.4%27)
* [6.0.4 Changelog](/docs/v6.0/release-notes/6.0-changelog/#std-label-6.0.4-changelog)

### 6.0.3 - Nov 21, 2022

Issues fixed:

* [SERVER-66289](https://jira.mongodb.org/browse/SERVER-66289) $out incorrectly throws BSONObj size error on
  v5.0.8
* [SERVER-68139](https://jira.mongodb.org/browse/SERVER-68139) Resharding command fails if the projection sort
  is bigger than 100MB
* [SERVER-68371](https://jira.mongodb.org/browse/SERVER-68371) Enabling CSFLE in your MongoClient causes Atlas
  Search to fail
* [SERVER-68115](https://jira.mongodb.org/browse/SERVER-68115) Bug fix for "elemMatchRootLength > 0" invariant
  trigger
* [SERVER-68394](https://jira.mongodb.org/browse/SERVER-68394) Ensure we do not yield strong locks upon startup
  recovery when \_id index is missing
* [All JIRA issues closed in 6.0.3](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D%276.0.3%27)
* [6.0.3 Changelog](/docs/v6.0/release-notes/6.0-changelog/#std-label-6.0.3-changelog)

### 6.0.2 - Sep 28, 2022

Issues fixed:

* [SERVER-68925](https://jira.mongodb.org/browse/SERVER-68925) Reintroduce check table logging settings at
  startup (revert [SERVER-43664)](https://jira.mongodb.org/browse/SERVER-43664)
* [SERVER-68628](https://jira.mongodb.org/browse/SERVER-68628) Retrying a failed resharding operation after a
  primary failover can lead to server crash or lost writes
* [SERVER-63852](https://jira.mongodb.org/browse/SERVER-63852) getThreadName() should not crash
* [SERVER-65317](https://jira.mongodb.org/browse/SERVER-65317) mongod removes connection from connection pool
  after running simple $search query
* [SERVER-63843](https://jira.mongodb.org/browse/SERVER-63843) Don't allow recursive doLog in synchronous
  signal handlers
* [WT-9870](https://jira.mongodb.org/browse/WT-9870) Fix updating pinned timestamp whenever oldest timestamp is
  updated during recovery
* [All JIRA issues closed in 6.0.2](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D%276.0.2%27)
* [6.0.2 Changelog](/docs/v6.0/release-notes/6.0-changelog/#std-label-6.0.2-changelog)

### 6.0.1 - Aug 19, 2022

Issues fixed:

* [SERVER-68511](https://jira.mongodb.org/browse/SERVER-68511) MovePrimary update of `config.databases` entry
  must use dotted fields notation
* [SERVER-68062](https://jira.mongodb.org/browse/SERVER-68062) Multi-stage aggregations that use $geoNear may
  violate constraints
* [SERVER-66072](https://jira.mongodb.org/browse/SERVER-66072) $match sampling and $group aggregation strange
  behavior
* [SERVER-68130](https://jira.mongodb.org/browse/SERVER-68130) AutoSplitVector could generate response bigger
  than BSONObjMaxUserSize
* [SERVER-68209](https://jira.mongodb.org/browse/SERVER-68209) Remove uassert that prevents
  `config.image_collection` entry from being invalidated
* [All JIRA issues closed in 6.0.1](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D%276.0.1%27)
* [6.0.1 Changelog](/docs/v6.0/release-notes/6.0-changelog/#std-label-6.0.1-changelog)

### 6.0.0 - Jul 19, 2022

The rest of this page describes changes and new features introduced in
MongoDB 6.0.

## Aggregation

### New Aggregation Stages

MongoDB 6.0 introduces the following aggregation stages:

| Stage | Description |
| --- | --- |
| [`$densify`](/docs/v6.0/reference/operator/aggregation/densify/#mongodb-pipeline-pipe.-densify) | Creates new documents in a sequence of documents where values in a specified field are missing. |
| [`$documents`](/docs/v6.0/reference/operator/aggregation/documents/#mongodb-pipeline-pipe.-documents) | Returns literal documents from input expressions. |
| [`$fill`](/docs/v6.0/reference/operator/aggregation/fill/#mongodb-pipeline-pipe.-fill) | Populates `null` and missing field values within documents. |
| [`$shardedDataDistribution`](/docs/v6.0/reference/operator/aggregation/shardedDataDistribution/#mongodb-pipeline-pipe.-shardedDataDistribution) | *New in version 6.0.3*: Provides size and data distribution information on sharded collections. |

### New Aggregation Operators

MongoDB 6.0 introduces the following aggregation operators:

| Operator | Description |
| --- | --- |
| [`$bottom`](/docs/v6.0/reference/operator/aggregation/bottom/#mongodb-group-grp.-bottom) | Returns the bottom element within a group according to the specified sort order. |
| [`$bottomN`](/docs/v6.0/reference/operator/aggregation/bottomN/#mongodb-group-grp.-bottomN) | Returns an aggregation of the bottom `n` elements within a group, according to the specified sort order. |
| [`$firstN`](/docs/v6.0/reference/operator/aggregation/firstN/#mongodb-group-grp.-firstN) | Returns an aggregation of the first `n` elements within a group. Distinct from the [`$firstN`](/docs/v6.0/reference/operator/aggregation/firstN/#mongodb-expression-exp.-firstN) array operator. |
| [`$firstN (array operator)`](/docs/v6.0/reference/operator/aggregation/firstN/#mongodb-expression-exp.-firstN) | Returns a specified number of elements from the beginning of an array. Distinct from the [`$firstN`](/docs/v6.0/reference/operator/aggregation/firstN/#mongodb-group-grp.-firstN) accumulator. |
| [`$lastN`](/docs/v6.0/reference/operator/aggregation/lastN/#mongodb-group-grp.-lastN) | Returns an aggregation of the last `n` elements within a group. Distinct from the [`$lastN`](/docs/v6.0/reference/operator/aggregation/lastN/#mongodb-expression-exp.-lastN) array operator. |
| [`$lastN (array operator)`](/docs/v6.0/reference/operator/aggregation/lastN/#mongodb-expression-exp.-lastN) | Returns a specified number of elements from the end of an array. Distinct from the [`$lastN`](/docs/v6.0/reference/operator/aggregation/lastN/#mongodb-group-grp.-lastN) accumulator. |
| [`$linearFill`](/docs/v6.0/reference/operator/aggregation/linearFill/#mongodb-group-grp.-linearFill) | Fills `null` and missing fields in a [window](/docs/v6.0/reference/operator/aggregation/setWindowFields/#std-label-setWindowFields-window) using [linear interpolation](https://en.wikipedia.org/wiki/Linear_interpolation) based on surrounding field values. |
| [`$locf`](/docs/v6.0/reference/operator/aggregation/locf/#mongodb-group-grp.-locf) | Last observation carried forward. Sets values for `null` and missing fields in a [window](/docs/v6.0/reference/operator/aggregation/setWindowFields/#std-label-setWindowFields-window) to the last non-null value for the field. |
| [`$maxN`](/docs/v6.0/reference/operator/aggregation/maxN/#mongodb-group-grp.-maxN) | Returns an aggregation of the `n` maximum valued elements within a group. Distinct from the [`$maxN`](/docs/v6.0/reference/operator/aggregation/maxN-array-element/#mongodb-expression-exp.-maxN) array operator. |
| [`$maxN (array operator)`](/docs/v6.0/reference/operator/aggregation/maxN-array-element/#mongodb-expression-exp.-maxN) | Returns the `n` largest values in an array. Distinct from the [`$maxN`](/docs/v6.0/reference/operator/aggregation/maxN/#mongodb-group-grp.-maxN) accumulator. |
| [`$minN`](/docs/v6.0/reference/operator/aggregation/minN/#mongodb-group-grp.-minN) | Returns an aggregation of the `n` minimum valued elements within a group. Distinct from the [`$minN`](/docs/v6.0/reference/operator/aggregation/minN-array-element/#mongodb-expression-exp.-minN) array operator. |
| [`$minN (array operator)`](/docs/v6.0/reference/operator/aggregation/minN-array-element/#mongodb-expression-exp.-minN) | Returns the `n` smallest values in an array. Distinct from the [`$minN`](/docs/v6.0/reference/operator/aggregation/minN/#mongodb-group-grp.-minN) accumulator. |
| [`$sortArray`](/docs/v6.0/reference/operator/aggregation/sortArray/#mongodb-expression-exp.-sortArray) | Sorts an array based on its elements. |
| [`$top`](/docs/v6.0/reference/operator/aggregation/top/#mongodb-group-grp.-top) | Returns the top element within a group according to the specified sort order. Distinct from the command [`top`.](/docs/v6.0/reference/command/top/#mongodb-dbcommand-dbcmd.top) |
| [`$topN`](/docs/v6.0/reference/operator/aggregation/topN/#mongodb-group-grp.-topN) | Returns an aggregation of the top `n` elements within a group, according to the specified sort order. |
| [`$tsIncrement`](/docs/v6.0/reference/operator/aggregation/tsIncrement/#mongodb-expression-exp.-tsIncrement) | Returns the incrementing ordinal from a [timestamp](/docs/v6.0/reference/bson-types/#std-label-document-bson-type-timestamp) as a [`long`.](/docs/v6.0/reference/mongodb-extended-json-v1/#mongodb-bsontype-data_numberlong) |
| [`$tsSecond`](/docs/v6.0/reference/operator/aggregation/tsSecond/#mongodb-expression-exp.-tsSecond) | Returns the seconds from a [timestamp](/docs/v6.0/reference/bson-types/#std-label-document-bson-type-timestamp) as a [`long`.](/docs/v6.0/reference/mongodb-extended-json-v1/#mongodb-bsontype-data_numberlong) |

### `$lookup` and `$graphLookup` with Sharded Collections

Starting in MongoDB 5.1,
the [`$lookup`](/docs/v6.0/reference/operator/aggregation/lookup/#mongodb-pipeline-pipe.-lookup) and [`$graphLookup`](/docs/v6.0/reference/operator/aggregation/graphLookup/#mongodb-pipeline-pipe.-graphLookup) aggregation stages
support [sharded collections](/docs/v6.0/sharding/#std-label-sharded-cluster) in the `from`
parameter.

In previous versions of MongoDB, `$lookup` and `$graphLookup`
only allowed for unsharded `from` collections.

You **cannot** use the `$graphLookup` stage within a transaction while
targeting a sharded collection.

## Change Streams

### Optimized Change Streams

Starting in MongoDB 5.1, [change streams](/docs/v6.0/changeStreams/#std-label-changeStreams) are optimized, providing more
efficient resource utilization and faster execution of some aggregation
pipeline stages.

### `wallTime` Change Stream Output Field

Starting in MongoDB 6.0, the [change stream output](/docs/v6.0/reference/change-events/#std-label-change-stream-output) has a new `wallTime` field that contains the
server date and time of the database operation.

### Change Streams with Document Pre- and Post-Images

Starting in MongoDB 6.0, you can use [change streams](/docs/v6.0/reference/change-events/#std-label-change-stream-output) to output the version of a document before and
after changes (the document pre- and post-images). For examples, see
[Change Streams with Document Pre- and Post-Images.](/docs/v6.0/reference/method/db.collection.watch/#std-label-db.collection.watch-change-streams-pre-and-post-images-example)

### Change Stream Expanded Events

Starting in MongoDB 6.0, change streams can show additional
change events for DDL operations, like creating indexes and dropping
collections.

For more information, see [Expanded Events.](/docs/v6.0/reference/change-events/#std-label-change-streams-expanded-events)

### Filters

Starting in MongoDB 6.0, whenever possible, [match filters](/docs/v6.0/changeStreams/#std-label-change-stream-modify-output) are applied to change streams earlier
than in prior releases. This improves performance. However, when a
filter is narrowly defined, an earlier match may cause an operation that
succeeds in prior versions to fail in 6.0.

## Cluster Administration

### Cluster Server Parameters

Starting in MongoDB 6.0, you can use [Cluster Parameters for a Self-Managed Deployment](/docs/v6.0/reference/cluster-parameters/#std-label-cluster-parameters) to modify
and retrieve configuration options for all nodes in a replica set or sharded
cluster. You can use [`setClusterParameter`](/docs/v6.0/reference/command/setClusterParameter/#mongodb-dbcommand-dbcmd.setClusterParameter) to modify cluster-wide
options and [`getClusterParameter`](/docs/v6.0/reference/command/getClusterParameter/#mongodb-dbcommand-dbcmd.getClusterParameter) to retrieve the value of a cluster
parameter.

### Connection Pool Parameters

Starting in MongoDB 6.0, you can use
[`ShardingTaskExecutorPoolMinSizeForConfigServers`](/docs/v6.0/reference/parameters/#mongodb-parameter-param.ShardingTaskExecutorPoolMinSizeForConfigServers) and
[`ShardingTaskExecutorPoolMaxSizeForConfigServers`](/docs/v6.0/reference/parameters/#mongodb-parameter-param.ShardingTaskExecutorPoolMaxSizeForConfigServers) to set the
minimum and maximum sharding TaskExecutor connection pool size for
[configuration servers.](/docs/v6.0/core/sharded-cluster-config-servers/#std-label-sharding-config-server)

### `changeStreamOptions` Cluster Parameter

Starting in MongoDB 6.0, you can use [`changeStreamOptions`](/docs/v6.0/reference/cluster-parameters/#mongodb-parameter-param.changeStreamOptions) to control
the retention policy of change stream pre- and post-images.

### `internalSessionsReapThreshold` Parameter

Starting in MongoDB 6.0, you can use the new
[`internalSessionsReapThreshold`](/docs/v6.0/reference/parameters/#mongodb-parameter-param.internalSessionsReapThreshold) parameter to set the session
limit for internal session metadata deletion.

### Multiple Arbiters Unsupported

Starting in MongoDB 5.3, support for multiple arbiters in a replica set is
disabled by default. To enable support for multiple arbiters, start each
node with the [`allowMultipleArbiters`](/docs/v6.0/reference/parameters/#mongodb-parameter-param.allowMultipleArbiters) parameter.

## Clustered Collections

Starting in MongoDB 5.3, you can create a collection with a
[clustered index](/docs/v6.0/reference/method/db.createCollection/#std-label-db.createCollection.clusteredIndex). Collections
created with a clustered index are called clustered collections.

To learn about the benefits compared to a normal collection, see
[Clustered Collections.](/docs/v6.0/core/clustered-collections/#std-label-clustered-collections)

## Indexes

Starting in MongoDB 5.1, you can use the [`collMod`](/docs/v6.0/reference/command/collMod/#mongodb-dbcommand-dbcmd.collMod) database
command to add the `expireAfterSeconds` option to an existing
single-field non-TTL index.

Starting in MongoDB 6.0, you can use the `prepareUnique` and
`unique` options for the [`collMod`](/docs/v6.0/reference/command/collMod/#mongodb-dbcommand-dbcmd.collMod) command to convert an
existing standard index to a unique index.

### Partial Indexes

Starting in MongoDB 6.0, you can use the operators [`$in`](/docs/v6.0/reference/operator/query/in/#mongodb-query-op.-in) and [`$or`](/docs/v6.0/reference/operator/query/or/#mongodb-query-op.-or)
to create [partial indexes](/docs/v6.0/core/index-partial/#std-label-index-type-partial). The `partialFilterExpression`
maximum depth is also expanded from 2 to 4. You can now use the operators [`$and`](/docs/v6.0/reference/operator/query/and/#mongodb-query-op.-and)
and [`$or`](/docs/v6.0/reference/operator/query/or/#mongodb-query-op.-or) at non-top-levels.

## Installation

### SELinux Policies

Starting in MongoDB 5.1, there is a new SE Linux Policy for:

* [MongoDB Enterprise Server](/docs/v6.0/tutorial/install-mongodb-enterprise-on-red-hat/#std-label-install-enterprise-rhel-configure-selinux)
* [MongoDB Community Edition Server](/docs/v6.0/tutorial/install-mongodb-on-red-hat/#std-label-install-rhel-configure-selinux)

running on Red Hat Linux. The SELinux policy is for use with default
installations using `rpm` installer packages.

## Platform Support

MongoDB 6.0.3 introduces support for RHEL / CentOS / Oracle / Rocky / AlmaLinux 9.

To install MongoDB on RHEL, see:

* [Install MongoDB Community Edition on Red Hat or CentOS](/docs/v6.0/tutorial/install-mongodb-on-red-hat/#std-label-install-mongodb-community-rhel)
* [Install MongoDB Enterprise Edition on Red Hat or CentOS](/docs/v6.0/tutorial/install-mongodb-enterprise-on-red-hat/#std-label-install-mongodb-enterprise-rhel)
## Replica Sets

### Multiple Arbiters Unsupported

Starting in MongoDB 5.3, support for multiple arbiters in a replica set is
disabled by default. To enable support for multiple arbiters, start each
node with the [`allowMultipleArbiters`](/docs/v6.0/reference/parameters/#mongodb-parameter-param.allowMultipleArbiters) parameter.

### `initialSyncMethod` Parameter

Starting in MongoDB 5.2, the [`initialSyncMethod`](/docs/v6.0/reference/parameters/#mongodb-parameter-param.initialSyncMethod) determines
whether [initial sync](/docs/v6.0/core/replica-set-sync/#std-label-replica-set-initial-sync) is a
[logical initial sync](/docs/v6.0/core/replica-set-sync/#std-label-replica-set-initial-sync-logical) or a
[file copy based initial sync.](/docs/v6.0/core/replica-set-sync/#std-label-replica-set-initial-sync-file-copy-based)

[`initialSyncMethod`](/docs/v6.0/reference/parameters/#mongodb-parameter-param.initialSyncMethod) is only available in MongoDB Enterprise
Server.

### Specify Secondary Oplog Batch Delay

Starting in MongoDB 6.0, you can use the
[`oplogBatchDelayMillis`](/docs/v6.0/reference/parameters/#mongodb-parameter-param.oplogBatchDelayMillis) server parameter to specify a delay
for writes of oplog batches on secondaries. Adding a short oplog batch
delay can reduce IOPS on
secondaries, but adds latency for writes with write concern
[`"majority"`.](/docs/v6.0/reference/write-concern/#mongodb-writeconcern-writeconcern.-majority-)

For more information, see [`oplogBatchDelayMillis`.](/docs/v6.0/reference/parameters/#mongodb-parameter-param.oplogBatchDelayMillis)

## Security

### Audit Log Encryption

Starting in MongoDB 6.0 Enterprise, you can encrypt the MongoDB audit
log.

To configure the audit log, see
[Audit Log.](/docs/v6.0/core/security-encryption-at-rest/#std-label-security-encryption-at-rest-audit-log)

## Server Parameters

[`mongod`](/docs/v6.0/reference/program/mongod/#mongodb-binary-bin.mongod) adds these parameters:

* [`transactionTooLargeForCacheThreshold`](/docs/v6.0/reference/parameters/#mongodb-parameter-param.transactionTooLargeForCacheThreshold) (Starting in MongoDB
  6.0.5.)
## Sharding

### Use $shardedDataDistribution to Analyze Sharded Data Distribution

Starting in MongoDB 6.0.3, you can use the [`$shardedDataDistribution`](/docs/v6.0/reference/operator/aggregation/shardedDataDistribution/#mongodb-pipeline-pipe.-shardedDataDistribution)
stage to analyze how your sharded data is distributed across your cluster.

If you are running MongoDB 5.0, you can upgrade your cluster to MongoDB
6.0 and analyze sharded data distribution. For additional details, see
[Analyze Sharded Data Distribution.](/docs/v6.0/tutorial/analyze-sharded-data-distribution/#std-label-analyze-sharded-data-distribution)

### Balancing Policy Changes

Starting in MongoDB 6.0.3, data in sharded clusters is distributed based on data
size rather than number of chunks. As a result, you should be aware of the
following significant changes in sharded cluster data distribution behavior:

* The balancer distributes ranges of data rather than chunks. The balancing
  policy looks for evenness of data distribution rather than chunk distribution.
* Chunks are not subject to auto-splitting. Instead, chunks are split only when
  moved across shards.
* A chunk is now referred to as a range.
* `moveRange` has replaced `moveChunk`.
### Default Chunk Size Increased from 64 MB to 128 MB

Starting in MongoDB 5.2, the
[default chunk size](/docs/v6.0/core/sharding-data-partitioning/#std-label-sharding-chunk-size) is 128 megabytes. In
earlier versions of MongoDB, the default chunk size is 64 megabytes.

### `enableSharding` No Longer Required

Starting in MongoDB 6.0, the [`enableSharding`](/docs/v6.0/reference/command/enableSharding/#mongodb-dbcommand-dbcmd.enableSharding) command is
no longer required to shard a collection.

### Monitor Defragmentation Status

Starting in MongoDB 5.3, the [`balancerCollectionStatus`](/docs/v6.0/reference/command/balancerCollectionStatus/#mongodb-dbcommand-dbcmd.balancerCollectionStatus)
command returns detailed information when run on a namespace going
through chunk defragmentation. The output includes the current phase of
the defragmentation and how many chunks are left to process.

To see example output, see
[Ongoing Defragmentation Process.](/docs/v6.0/reference/command/balancerCollectionStatus/#std-label-balancer-collection-status-defrag-output-command)

## Slot-Based Query Execution Engine

Starting in MongoDB 5.1, MongoDB uses a new query execution engine for
eligible queries, called the slot-based query execution engine. If the
slot-based query execution engine is used, new fields are included in
the query explain plan output.

* The new query execution engine is used if possible.
* If the new query execution engine is used, new fields are included in
  the [query explain plan output.](/docs/v6.0/reference/explain-results/#std-label-explain-results-5.1-later)

### Slot-Based Query Execution Engine Can Execute `$group` and `$lookup` Stages

Starting in version 6.0, MongoDB uses the slot-based query execution engine to execute eligible
[`$group`](/docs/v6.0/reference/operator/aggregation/group/#mongodb-pipeline-pipe.-group) and [`$lookup`](/docs/v6.0/reference/operator/aggregation/lookup/#mongodb-pipeline-pipe.-lookup) stages when certain
conditions are met.

For more information, see [Slot-Based Query Execution Engine Pipeline Optimizations.](/docs/v6.0/core/aggregation-pipeline-optimization/#std-label-sbe-pipeline-optimizations)

## Stable API

The following sections describe additions to the [Stable API](/docs/v6.0/reference/stable-api/#std-label-stable-api) introduced in MongoDB 6.0.

To see the full list of database commands available in the Stable API,
see [Stable API Changelog.](/docs/v6.0/reference/stable-api-changelog/#std-label-stable-api-changelog)

### Database Commands

Starting in MongoDB 6.0, the following database commands are supported
in the [Stable API:](/docs/v6.0/reference/stable-api/#std-label-stable-api)

| Command | Description | Stable API Version |
| --- | --- | --- |
| [`count`](/docs/v6.0/reference/command/count/#mongodb-dbcommand-dbcmd.count) | Counts the number of documents in a collection or a view. (Also available in the Stable API for 5.0-series deployments starting in MongoDB 5.0.9.) | V1 |

### Aggregation Stages and Operators

Starting in MongoDB 6.0, the following aggregation stages and operators
are supported in the [Stable API:](/docs/v6.0/reference/stable-api/#std-label-stable-api)

| Stage or Operator | Description | Stable API Version |
| --- | --- | --- |
| [`$bottom`](/docs/v6.0/reference/operator/aggregation/bottom/#mongodb-group-grp.-bottom) | Returns the bottom element within a group, according to the specified sort order. | V1 |
| [`$bottomN`](/docs/v6.0/reference/operator/aggregation/bottomN/#mongodb-group-grp.-bottomN) | Returns an aggregation of the bottom `n` elements within a group, according to the specified sort order. | V1 |
| [`$dateAdd`](/docs/v6.0/reference/operator/aggregation/dateAdd/#mongodb-expression-exp.-dateAdd) | Increments a [Date](/docs/v6.0/reference/method/Date/) object by a specified number of time units. | V1 |
| [`$dateDiff`](/docs/v6.0/reference/operator/aggregation/dateDiff/#mongodb-expression-exp.-dateDiff) | Returns the difference between two dates. | V1 |
| [`$dateSubtract`](/docs/v6.0/reference/operator/aggregation/dateSubtract/#mongodb-expression-exp.-dateSubtract) | Decrements a [Date](/docs/v6.0/reference/method/Date/) object by a specified number of time units. | V1 |
| [`$dateTrunc`](/docs/v6.0/reference/operator/aggregation/dateTrunc/#mongodb-expression-exp.-dateTrunc) | Truncates a date. | V1 |
| [`$densify`](/docs/v6.0/reference/operator/aggregation/densify/#mongodb-pipeline-pipe.-densify) | Creates new documents in a sequence of documents where certain values in a field are missing. | V1 |
| [`$firstN`](/docs/v6.0/reference/operator/aggregation/firstN/#mongodb-group-grp.-firstN) (aggregation accumulator) | Returns an aggregation of the first `n` elements within a group. | V1 |
| [`$firstN`](/docs/v6.0/reference/operator/aggregation/firstN/#mongodb-expression-exp.-firstN) (array operator) | Returns a specified number of elements from the beginning of an array. | V1 |
| [`$getField`](/docs/v6.0/reference/operator/aggregation/getField/#mongodb-expression-exp.-getField) | Returns the value of a specified field from a document. | V1 |
| [`$lastN`](/docs/v6.0/reference/operator/aggregation/lastN/#mongodb-group-grp.-lastN) (aggregation accumulator) | Returns an aggregation of the last `n` elements within a group. | V1 |
| [`$lastN`](/docs/v6.0/reference/operator/aggregation/lastN/#mongodb-expression-exp.-lastN) (array operator) | Returns a specified number of elements from the end of an array. | V1 |
| [`$locf`](/docs/v6.0/reference/operator/aggregation/locf/#mongodb-group-grp.-locf) | Last observation carried forward. Sets values for `null` and missing fields in a [window](/docs/v6.0/reference/operator/aggregation/setWindowFields/#std-label-setWindowFields-window) to the last non-null value for the field. | V1 |
| [`$maxN`](/docs/v6.0/reference/operator/aggregation/maxN/#mongodb-group-grp.-maxN) (aggregation accumulator) | Returns an aggregation of the maximum value `n` elements within a group. | V1 |
| [`$maxN`](/docs/v6.0/reference/operator/aggregation/maxN-array-element/#mongodb-expression-exp.-maxN) (array operator) | Returns the `n` largest values in an array. | V1 |
| [`$minN`](/docs/v6.0/reference/operator/aggregation/minN/#mongodb-group-grp.-minN) (aggregation accumulator) | Returns an aggregation of the minimum value `n` elements within a group. | V1 |
| [`$minN`](/docs/v6.0/reference/operator/aggregation/minN-array-element/#mongodb-expression-exp.-minN) (array operator) | Returns the `n` smallest values in an array. | V1 |
| [`$setField`](/docs/v6.0/reference/operator/aggregation/setField/#mongodb-expression-exp.-setField) | Adds, updates, or removes a specified field in a document. | V1 |
| [`$setWindowFields`](/docs/v6.0/reference/operator/aggregation/setWindowFields/#mongodb-pipeline-pipe.-setWindowFields) | Performs operations on a specified span of documents in a collection, known as a *window*, and returns the results based on the chosen [window operator.](/docs/v6.0/reference/operator/aggregation/setWindowFields/#std-label-setWindowFields-window-operators) | V1 |
| [`$sortArray`](/docs/v6.0/reference/operator/aggregation/sortArray/#mongodb-expression-exp.-sortArray) | Sorts an array based on its elements. | V1 |
| [`$top`](/docs/v6.0/reference/operator/aggregation/top/#mongodb-group-grp.-top) | Returns the top element within a group according to the specified sort order. | V1 |
| [`$topN`](/docs/v6.0/reference/operator/aggregation/topN/#mongodb-group-grp.-topN) | Returns an aggregation of the top `n` elements within a group, according to the specified sort order. | V1 |
| [`$tsIncrement`](/docs/v6.0/reference/operator/aggregation/tsIncrement/#mongodb-expression-exp.-tsIncrement) | Returns the incrementing ordinal from a [timestamp](/docs/v6.0/reference/bson-types/#std-label-document-bson-type-timestamp) as a [`long`.](/docs/v6.0/reference/mongodb-extended-json-v1/#mongodb-bsontype-data_numberlong) | V1 |
| [`$tsSecond`](/docs/v6.0/reference/operator/aggregation/tsSecond/#mongodb-expression-exp.-tsSecond) | Returns the seconds from a [timestamp](/docs/v6.0/reference/bson-types/#std-label-document-bson-type-timestamp) as a [`long`.](/docs/v6.0/reference/mongodb-extended-json-v1/#mongodb-bsontype-data_numberlong) | V1 |

#### Window Operators

Starting in MongoDB 6.0, the following window operators are supported in
the [Stable API:](/docs/v6.0/reference/stable-api/#std-label-stable-api)

| Window Operator | Description | Stable API Version |
| --- | --- | --- |
| [`$addToSet`](/docs/v6.0/reference/operator/aggregation/addToSet/#mongodb-group-grp.-addToSet) | Returns an array of all unique values that results from applying an [expression](/docs/v6.0/reference/aggregation-quick-reference/#std-label-aggregation-expressions) to each document. | V1 |
| [`$avg`](/docs/v6.0/reference/operator/aggregation/avg/#mongodb-group-grp.-avg) | Returns the average for the specified [expression](/docs/v6.0/reference/aggregation-quick-reference/#std-label-aggregation-expressions). Ignores non-numeric values. | V1 |
| [`$count`](/docs/v6.0/reference/operator/aggregation/count-accumulator/#mongodb-group-grp.-count) | Returns the number of documents in the group or window. | V1 |
| [`$covariancePop`](/docs/v6.0/reference/operator/aggregation/covariancePop/#mongodb-group-grp.-covariancePop) | Returns the population covariance of two numeric [expressions.](/docs/v6.0/reference/aggregation-quick-reference/#std-label-aggregation-expressions) | V1 |
| [`$covarianceSamp`](/docs/v6.0/reference/operator/aggregation/covarianceSamp/#mongodb-group-grp.-covarianceSamp) | Returns the sample covariance of two numeric [expressions.](/docs/v6.0/reference/aggregation-quick-reference/#std-label-aggregation-expressions) | V1 |
| [`$denseRank`](/docs/v6.0/reference/operator/aggregation/denseRank/#mongodb-group-grp.-denseRank) | Returns the document position (known as the rank) relative to other documents in the [`$setWindowFields`](/docs/v6.0/reference/operator/aggregation/setWindowFields/#mongodb-pipeline-pipe.-setWindowFields) stage [partition](/docs/v6.0/reference/operator/aggregation/setWindowFields/#std-label-setWindowFields-partitionBy). There are no gaps in the ranks. Ties receive the same rank. | V1 |
| [`$derivative`](/docs/v6.0/reference/operator/aggregation/derivative/#mongodb-group-grp.-derivative) | Returns the average rate of change within the specified [window.](/docs/v6.0/reference/operator/aggregation/setWindowFields/#std-label-setWindowFields-window) | V1 |
| [`$documentNumber`](/docs/v6.0/reference/operator/aggregation/documentNumber/#mongodb-group-grp.-documentNumber) | Returns the position of a document (known as the document number) in the [`$setWindowFields`](/docs/v6.0/reference/operator/aggregation/setWindowFields/#mongodb-pipeline-pipe.-setWindowFields) stage [partition](/docs/v6.0/reference/operator/aggregation/setWindowFields/#std-label-setWindowFields-partitionBy). Ties result in different adjacent document numbers. | V1 |
| [`$expMovingAvg`](/docs/v6.0/reference/operator/aggregation/expMovingAvg/#mongodb-group-grp.-expMovingAvg) | Returns the exponential moving average for the numeric [expression.](/docs/v6.0/reference/aggregation-quick-reference/#std-label-aggregation-expressions) | V1 |
| [`$first`](/docs/v6.0/reference/operator/aggregation/first/#mongodb-group-grp.-first) | Returns the value that results from applying an [expression](/docs/v6.0/reference/aggregation-quick-reference/#std-label-aggregation-expressions) to the first document in a group or [window.](/docs/v6.0/reference/operator/aggregation/setWindowFields/#std-label-setWindowFields-window) | V1 |
| [`$integral`](/docs/v6.0/reference/operator/aggregation/integral/#mongodb-group-grp.-integral) | Returns the approximation of the area under a curve. | V1 |
| [`$last`](/docs/v6.0/reference/operator/aggregation/last/#mongodb-group-grp.-last) | Returns the value that results from applying an [expression](/docs/v6.0/reference/aggregation-quick-reference/#std-label-aggregation-expressions) to the last document in a group or [window.](/docs/v6.0/reference/operator/aggregation/setWindowFields/#std-label-setWindowFields-window) | V1 |
| [`$locf`](/docs/v6.0/reference/operator/aggregation/locf/#mongodb-group-grp.-locf) | Last observation carried forward. Sets values for `null` and missing fields in a [window](/docs/v6.0/reference/operator/aggregation/setWindowFields/#std-label-setWindowFields-window) to the last non-null value for the field. | V1 |
| [`$max`](/docs/v6.0/reference/operator/aggregation/max/#mongodb-group-grp.-max) | Returns the maximum value that results from applying an [expression](/docs/v6.0/reference/aggregation-quick-reference/#std-label-aggregation-expressions) to each document. | V1 |
| [`$min`](/docs/v6.0/reference/operator/aggregation/min/#mongodb-group-grp.-min) | Returns the minimum value that results from applying an [expression](/docs/v6.0/reference/aggregation-quick-reference/#std-label-aggregation-expressions) to each document. | V1 |
| [`$push`](/docs/v6.0/reference/operator/aggregation/push/#mongodb-group-grp.-push) | Returns an array of values that result from applying an [expression](/docs/v6.0/reference/aggregation-quick-reference/#std-label-aggregation-expressions) to each document. | V1 |
| [`$rank`](/docs/v6.0/reference/operator/aggregation/rank/#mongodb-group-grp.-rank) | Returns the document position (known as the rank) relative to other documents in the [`$setWindowFields`](/docs/v6.0/reference/operator/aggregation/setWindowFields/#mongodb-pipeline-pipe.-setWindowFields) stage [partition.](/docs/v6.0/reference/operator/aggregation/setWindowFields/#std-label-setWindowFields-partitionBy) | V1 |
| [`$shift`](/docs/v6.0/reference/operator/aggregation/shift/#mongodb-group-grp.-shift) | Returns the value from an [expression](/docs/v6.0/reference/aggregation-quick-reference/#std-label-aggregation-expressions) applied to a document in a specified position relative to the current document in the [`$setWindowFields`](/docs/v6.0/reference/operator/aggregation/setWindowFields/#mongodb-pipeline-pipe.-setWindowFields) stage [partition.](/docs/v6.0/reference/operator/aggregation/setWindowFields/#std-label-setWindowFields-partitionBy) | V1 |
| [`$stdDevPop`](/docs/v6.0/reference/operator/aggregation/stdDevPop/#mongodb-group-grp.-stdDevPop) | Returns the population standard deviation that results from applying a numeric [expression](/docs/v6.0/reference/aggregation-quick-reference/#std-label-aggregation-expressions) to each document. | V1 |
| [`$stdDevSamp`](/docs/v6.0/reference/operator/aggregation/stdDevSamp/#mongodb-group-grp.-stdDevSamp) | Returns the sample standard deviation that results from applying a numeric [expression](/docs/v6.0/reference/aggregation-quick-reference/#std-label-aggregation-expressions) to each document. | V1 |
| [`$sum`](/docs/v6.0/reference/operator/aggregation/sum/#mongodb-group-grp.-sum) | Returns the sum that results from applying a numeric [expression](/docs/v6.0/reference/aggregation-quick-reference/#std-label-aggregation-expressions) to each document. | V1 |

## Time Series Collections

The following sections describe improvements and new features for
[time series collections.](/docs/v6.0/core/timeseries-collections/#std-label-manual-timeseries-collection)

### Sharded Time Series Collections

MongoDB 5.1 provides support for sharded [time series collections.](/docs/v6.0/core/timeseries-collections/#std-label-manual-timeseries-collection)

See:

* [Shard a Time Series Collection](/docs/v6.0/core/timeseries/timeseries-shard-collection/#std-label-manual-timeseries-shard-collection)
* [`shardCollection`](/docs/v6.0/reference/command/shardCollection/#mongodb-dbcommand-dbcmd.shardCollection)
* [Time Series Limitations](/docs/v6.0/core/timeseries/timeseries-limitations/#std-label-time-series-limitations-sharding)
### Updates and Deletes

Starting in MongoDB 5.1, time series collections support
[update and delete operations](/docs/v6.0/core/timeseries/timeseries-limitations/#std-label-timeseries-limitations-updates-deletes) with limitations.

### Time Series Column Compression

Starting in MongoDB 5.2, time series collections use **column
compression**. Column compression adds a number of innovations that work
together to significantly improve practical compression, reduce your
data's overall storage on disk, and improve read performance.

Starting in MongoDB 6.0, arrays are also compressed as part of the
[time series column compression.](/docs/v6.0/core/timeseries/timeseries-compression/)

### Support for `$geoNear`

Starting in MongoDB 5.3, you can use the [`$geoNear`](/docs/v6.0/reference/operator/aggregation/geoNear/#mongodb-pipeline-pipe.-geoNear) pipeline
operator on any field in a [time series collection.](/docs/v6.0/core/timeseries-collections/#std-label-manual-timeseries-collection)

### Additional Secondary Index Types

You can add additional [secondary index](/docs/v6.0/reference/glossary/#std-term-secondary-index) types
to time series collections, including [2dsphere](/docs/v6.0/core/2dsphere/#std-label-2dsphere-index)
and [2d](/docs/v6.0/core/2d/#std-label-2d-index) indexes.

For all additional indexes and other improvements, see
[Time Series Secondary Indexes in MongoDB 6.0.](/docs/v6.0/core/timeseries/timeseries-secondary-index/#std-label-timeseries-add-secondary-index-mongodb-6.0)

### Sort Operations Use Secondary Indexes

Sort operations on time series collections can use indexes to improve
performance. For more information and an example, see
[Use Secondary Indexes to Improve Sort Performance.](/docs/v6.0/core/timeseries/timeseries-secondary-index/#std-label-timeseries-secondary-index-sort-performance)

## General Improvements

### Drop a Hashed Shard Key Index

Starting in MongoDB 6.0.12 (and 5.0.22), you can drop the index for a
hashed shard key.

This can speed up data insertion for collections sharded with a hashed
shard key. It can also speed up data ingestion when using
`mongosync`.

For details, see [Drop a Hashed Shard Key Index.](/docs/v6.0/tutorial/drop-a-hashed-shard-key-index/#std-label-drop-a-hashed-shard-key-index)

### OpenSSL3 FIPS Support

Starting in MongoDB 6.0.7, FIPS mode supports
[OpenSSL3](https://www.openssl.org/docs/man3.0/man7/migration_guide.html)
for the following operating systems:

* Ubuntu 22.04
* RHEL 9
* Amazon Linux 2023
### Capped Collections Improvements

Starting in MongoDB 6.0, you can change a
[capped collection's](/docs/v6.0/core/capped-collections/#std-label-manual-capped-collection) maximum size, either in
bytes or in number of documents, using the [`collMod`](/docs/v6.0/reference/command/collMod/#mongodb-dbcommand-dbcmd.collMod) command. See
[Resize a Capped Collection](/docs/v6.0/reference/command/collMod/#std-label-resize-capped-collection) for more details.

### `numOrphanDocs` Field Added to collStats Command

Starting in MongoDB 6.0, the [collStats output](/docs/v6.0/reference/command/collStats/#std-label-collStats-output)
includes the [`collStats.numOrphanDocs`](/docs/v6.0/reference/command/collStats/#mongodb-data-collStats.numOrphanDocs) field that shows the number of
[orphaned documents](/docs/v6.0/reference/glossary/#std-term-orphaned-document) in the collection.

### Exclude Embedded Fields in `serverStatus` Output

Starting in MongoDB 6.0 (and 5.0.9), you can exclude embedded fields
from the [`serverStatus`](/docs/v6.0/reference/command/serverStatus/#mongodb-dbcommand-dbcmd.serverStatus) output.

### Connections

Starting in MongoDB 6.0, the [`Mongo()`](/docs/v6.0/reference/method/db.getMongo/#mongodb-method-db.getMongo)
connection object has the following new methods:

* [`Mongo.getWriteConcern()`](/docs/v6.0/reference/method/Mongo.getWriteConcern/#mongodb-method-Mongo.getWriteConcern) returns the [write concern](/docs/v6.0/reference/glossary/#std-term-write-concern)
* [`Mongo.setWriteConcern()`](/docs/v6.0/reference/method/Mongo.setWriteConcern/#mongodb-method-Mongo.setWriteConcern) sets the [write concern](/docs/v6.0/reference/glossary/#std-term-write-concern)
### Support for Diagnostic Backtrace Generation in `arm64`

Starting in MongoDB 6.0 (and 5.0.10), [diagnostic backtrace
generation](/docs/v6.0/tutorial/manage-mongodb-processes/#std-label-sigusr2-diagnostic-backtrace) in `arm64` is supported.

### Configure Refresh Interval for Cached LDAP User Information

Starting in MongoDB 5.2, you can use the following new server parameters
to configure the refresh interval for cached LDAP user information:

* [`ldapUserCacheRefreshInterval`](/docs/v6.0/reference/parameters/#mongodb-parameter-param.ldapUserCacheRefreshInterval)
* [`ldapUserCacheStalenessInterval`](/docs/v6.0/reference/parameters/#mongodb-parameter-param.ldapUserCacheStalenessInterval)
* [`ldapShouldRefreshUserCacheEntries`](/docs/v6.0/reference/parameters/#mongodb-parameter-param.ldapShouldRefreshUserCacheEntries)

Starting in MongoDB 5.2, the update interval for cached user information
retrieved from an LDAP server depends on
[`ldapShouldRefreshUserCacheEntries`:](/docs/v6.0/reference/parameters/#mongodb-parameter-param.ldapShouldRefreshUserCacheEntries)

* If true, use [`ldapUserCacheRefreshInterval`.](/docs/v6.0/reference/parameters/#mongodb-parameter-param.ldapUserCacheRefreshInterval)
* If false, use [`ldapUserCacheInvalidationInterval`.](/docs/v6.0/reference/parameters/#mongodb-parameter-param.ldapUserCacheInvalidationInterval)
## Changes Affecting Compatibility

Some changes can affect compatibility and may require user actions. For
a detailed list of compatibility changes, see
[Compatibility Changes in MongoDB 6.0.](/docs/v6.0/release-notes/6.0-compatibility/#std-label-6.0-compatibility)

## Upgrade Procedures

## Important

### **Feature Compatibility Version**

To upgrade to MongoDB 6.0 from a 5.0 deployment, the 5.0 deployment
must have `featureCompatibilityVersion` set to `5.0`. To check
the version:

```

| db.adminCommand( { getParameter: 1, featureCompatibilityVersion: 1 } ) |
| --- |

```

To upgrade to MongoDB 6.0, refer to the upgrade instructions specific to
your MongoDB deployment:

* [Upgrade a Standalone to 6.0](/docs/v6.0/release-notes/6.0-upgrade-standalone/#std-label-6.0-upgrade-standalone)
* [Upgrade a Replica Set to 6.0](/docs/v6.0/release-notes/6.0-upgrade-replica-set/#std-label-6.0-upgrade-replica-set)
* [Upgrade a Sharded Cluster to 6.0](/docs/v6.0/release-notes/6.0-upgrade-sharded-cluster/#std-label-6.0-upgrade-sharded-cluster)

If you need guidance on upgrading to 6.0, MongoDB professional services
offer major version upgrade support to help ensure a smooth transition
without interruption to your MongoDB application. To learn more, see
[MongoDB Consulting.](https://www.mongodb.com/products/consulting?tck=docs_server)

## Downgrade Consideration

MongoDB only supports single-version downgrades. You cannot downgrade to a
release that is multiple versions behind your current release.

For example, you may downgrade a 6.0-series to a 5.0-series deployment.
However, further downgrading that 5.0-series deployment to a 4.4-series
deployment is not supported.

## Download

To download MongoDB 6.0, go to the [MongoDB Download Center.](https://www.mongodb.com/try/download?tck=docs_server)

## Known Issues

This section describes known issues in MongoDB 6.0 and their resolution
status.

| In Version | Issue | Status |
| --- | --- | --- |
| 6.0.0 | [SERVER-68062](https://jira.mongodb.org/browse/SERVER-68062): Multi-stage aggregations that use $geoNear may violate constraints. | Resolved in 6.0.1. |

## Report an Issue

To report an issue, see the [MongoDB GitHub repository](https://github.com/mongodb/mongo/wiki/Submit-Bug-Reports) for
instructions on how to file a JIRA ticket for the MongoDB server or one
of the related projects.

[Back

Release Notes](/docs/v6.0/release-notes/ "Previous Section")[Next

Compatibility Changes](/docs/v6.0/release-notes/6.0-compatibility/ "Next Section")

On this page

* [Patch Releases](#patch-releases)
* [Aggregation](#aggregation)
* [Change Streams](#change-streams)
* [Cluster Administration](#cluster-administration)
* [Clustered Collections](#clustered-collections)
* [Indexes](#indexes)
* [Installation](#installation)
* [Platform Support](#platform-support)
* [Replica Sets](#replica-sets)
* [Security](#security)
* [Server Parameters](#server-parameters)
* [Sharding](#sharding)
* [Slot-Based Query Execution Engine](#slot-based-query-execution-engine)
* [Stable API](#stable-api)
* [Time Series Collections](#time-series-collections)
* [General Improvements](#general-improvements)
* [Changes Affecting Compatibility](#changes-affecting-compatibility)
* [Upgrade Procedures](#upgrade-procedures)
* [Downgrade Consideration](#downgrade-consideration)
* [Download](#download)
* [Known Issues](#known-issues)
* [Report an Issue](#report-an-issue)

