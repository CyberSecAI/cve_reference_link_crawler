=== Content from www.mongodb.com_df086164_20250111_152427.html ===
[![MongoDB logo](https://webimages.mongodb.com/_com_assets/cms/kuyjf3vea2hg34taa-horizontal_default_slate_blue.svg?auto=format%252Ccompress)](https://www.mongodb.com)

* ProductsPlatform[![atlas_product_family](https://webimages.mongodb.com/_com_assets/icons/atlas_product_family.svg)AtlasBuild on a developer data platform](https://www.mongodb.com/atlas)Platform Services[![atlas_database](https://webimages.mongodb.com/_com_assets/icons/atlas_database.svg)DatabaseDeploy a multi-cloud database](https://www.mongodb.com/products/platform/atlas-database)[![atlas_search](https://webimages.mongodb.com/_com_assets/icons/atlas_search.svg)SearchDeliver engaging search experiences](https://www.mongodb.com/products/platform/atlas-search)[![mdb_vector_search](https://webimages.mongodb.com/_com_assets/icons/mdb_vector_search.svg)Vector SearchDesign intelligent apps with gen AI](https://www.mongodb.com/products/platform/atlas-vector-search)[![atlas_stream_processing](https://webimages.mongodb.com/_com_assets/icons/atlas_stream_processing.svg)Stream ProcessingUnify data in motion and data at rest](https://www.mongodb.com/products/platform/atlas-stream-processing)Self Managed[![enterprise_advanced_product family](https://webimages.mongodb.com/_com_assets/icons/enterprise_advanced_product family.svg)Enterprise AdvancedRun and manage MongoDB yourself](https://www.mongodb.com/products/self-managed/enterprise-advanced)[![community_edition_product_family](https://webimages.mongodb.com/_com_assets/icons/community_edition_product_family.svg)Community EditionDevelop locally with MongoDB](https://www.mongodb.com/products/self-managed/community-edition)Tools[![mdb_compass](https://webimages.mongodb.com/_com_assets/icons/mdb_compass.svg)CompassWork with MongoDB data in a GUI](https://www.mongodb.com/products/tools/compass)[![atlas_integration](https://webimages.mongodb.com/_com_assets/icons/atlas_integration.svg)IntegrationsIntegrations with third-party services](https://cloud.mongodb.com/ecosystem/?filter=integration)[![mdb_migrator](https://webimages.mongodb.com/_com_assets/icons/mdb_migrator.svg)Relational MigratorMigrate to MongoDB with confidence](https://www.mongodb.com/products/tools/relational-migrator)[View All ProductsExplore our full developer suitearrow-right](https://www.mongodb.com/products)Build with MongoDB AtlasGet started for free in minutes[Sign Up](https://www.mongodb.com/cloud/atlas/register)Test Enterprise AdvancedDevelop with MongoDB on-premises[Download](https://www.mongodb.com/try/download/enterprise)Try Community EditionExplore the latest version of MongoDB[Download](https://www.mongodb.com/try/download/community)
* ResourcesDocumentation[Atlas DocumentationGet started using Atlas](https://www.mongodb.com/docs/atlas/)[Server DocumentationLearn to use MongoDB](https://www.mongodb.com/docs/manual/)[Start With GuidesGet step-by-step guidance for key tasks](https://www.mongodb.com/docs/guides/) [Tools and ConnectorsLearn how to connect to MongoDB](https://www.mongodb.com/docs/tools-and-connectors/)[MongoDB DriversUse drivers and libraries for MongoDB](https://www.mongodb.com/docs/drivers/)[Resources HubGet help building the next big thing with MongoDBarrow-right](https://www.mongodb.com/resources)Connect[![atlas_product_family](https://webimages.mongodb.com/_com_assets/icons/atlas_product_family.svg)Developer CenterExplore a wide range of developer resources](https://www.mongodb.com/developer/)[![general_events_ask_the_experts](https://webimages.mongodb.com/_com_assets/icons/general_events_ask_the_experts.svg)CommunityJoin a global community of developers](https://www.mongodb.com/community/)[![general_content_tutorial](https://webimages.mongodb.com/_com_assets/icons/general_content_tutorial.svg)Courses and CertificationLearn for free from MongoDB](https://learn.mongodb.com/)[![general_events_session](https://webimages.mongodb.com/_com_assets/icons/general_events_session.svg)Events and WebinarsFind an event or webinar near you](https://www.mongodb.com/events)
* SolutionsUse cases[Artificial Intelligence](https://www.mongodb.com/solutions/use-cases/artificial-intelligence)[Edge Computing](https://www.mongodb.com/use-cases/atlas-for-the-edge)[Internet of Things](https://www.mongodb.com/solutions/use-cases/internet-of-things)[Mobile](https://www.mongodb.com/solutions/use-cases/mobile)[Payments](https://www.mongodb.com/solutions/use-cases/payments)[Serverless Development](https://www.mongodb.com/solutions/use-cases/serverless)Industries[Financial Services](https://www.mongodb.com/solutions/industries/financial-services)[Telecommunications](https://www.mongodb.com/solutions/industries/telecommunications)[Healthcare](https://www.mongodb.com/solutions/industries/healthcare)[Retail](https://www.mongodb.com/solutions/industries/retail)[Public Sector](https://www.mongodb.com/solutions/industries/public-sector)[Manufacturing](https://www.mongodb.com/solutions/industries/manufacturing)[Solutions LibraryOrganized and tailored solutions to kick-start projectsarrow-right](https://www.mongodb.com/solutions/solutions-library)Developer Data PlatformAccelerate innovation at scale[Learn morearrow-right](https://www.mongodb.com/solutions/developer-data-platform)Startups and AI InnovatorsFor world-changing ideas and AI pioneers[Learn morearrow-right](https://www.mongodb.com/solutions/startups)Customer Case StudiesHear directly from our users[See Storiesarrow-right](https://www.mongodb.com/library/customer-case-studies)
* Company[CareersStart your next adventure](https://www.mongodb.com/company/careers)[BlogRead articles and announcements](https://www.mongodb.com/blog)[NewsroomRead press releases and news stories](https://www.mongodb.com/company/newsroom)[PartnersLearn about our partner ecosystem](https://www.mongodb.com/company/partners)[LeadershipMeet our executive team](https://www.mongodb.com/company/leadership)[CompanyLearn more about who we are](https://www.mongodb.com/company)Contact UsReach out to MongoDB[Letâs chatarrow-right](https://www.mongodb.com/company/contact)InvestorsVisit our investor portal[Learn morearrow-right](https://investors.mongodb.com/)
* [Pricing](https://www.mongodb.com/pricing)

![Language Selector Icon](https://webimages.mongodb.com/_com_assets/cms/lvz91dv3bugodsyau-language-selector-globe.svg?auto=format%252Ccompress)Eng[Support](https://www.mongodb.com/services/support)[Sign In](https://account.mongodb.com/account/login)[Try Free](https://www.mongodb.com/cloud/atlas/register)menu-vertical[![MongoDB logo](https://webimages.mongodb.com/_com_assets/cms/kuyjf3vea2hg34taa-horizontal_default_slate_blue.svg?auto=format%252Ccompress)](https://www.mongodb.com)[![MongoDB logo](https://webimages.mongodb.com/_com_assets/cms/kuyj3d95v5vbmm2f4-horizontal_white.svg?auto=format%252Ccompress)](https://www.mongodb.com)

* ProductsPlatform[![atlas_product_family](https://webimages.mongodb.com/_com_assets/icons/atlas_product_family_inverse.svg)AtlasBuild on a developer data platform](https://www.mongodb.com/atlas)Platform Services[![atlas_database](https://webimages.mongodb.com/_com_assets/icons/atlas_database_inverse.svg)DatabaseDeploy a multi-cloud database](https://www.mongodb.com/products/platform/atlas-database)[![atlas_search](https://webimages.mongodb.com/_com_assets/icons/atlas_search_inverse.svg)SearchDeliver engaging search experiences](https://www.mongodb.com/products/platform/atlas-search)[![mdb_vector_search](https://webimages.mongodb.com/_com_assets/icons/mdb_vector_search_inverse.svg)Vector SearchDesign intelligent apps with gen AI](https://www.mongodb.com/products/platform/atlas-vector-search)[![atlas_stream_processing](https://webimages.mongodb.com/_com_assets/icons/atlas_stream_processing_inverse.svg)Stream ProcessingUnify data in motion and data at rest](https://www.mongodb.com/products/platform/atlas-stream-processing)Self Managed[![enterprise_advanced_product family](https://webimages.mongodb.com/_com_assets/icons/enterprise_advanced_product family_inverse.svg)Enterprise AdvancedRun and manage MongoDB yourself](https://www.mongodb.com/products/self-managed/enterprise-advanced)[![community_edition_product_family](https://webimages.mongodb.com/_com_assets/icons/community_edition_product_family_inverse.svg)Community EditionDevelop locally with MongoDB](https://www.mongodb.com/products/self-managed/community-edition)Tools[![mdb_compass](https://webimages.mongodb.com/_com_assets/icons/mdb_compass_inverse.svg)CompassWork with MongoDB data in a GUI](https://www.mongodb.com/products/tools/compass)[![atlas_integration](https://webimages.mongodb.com/_com_assets/icons/atlas_integration_inverse.svg)IntegrationsIntegrations with third-party services](https://cloud.mongodb.com/ecosystem/?filter=integration)[![mdb_migrator](https://webimages.mongodb.com/_com_assets/icons/mdb_migrator_inverse.svg)Relational MigratorMigrate to MongoDB with confidence](https://www.mongodb.com/products/tools/relational-migrator)[View All ProductsExplore our full developer suitearrow-right](https://www.mongodb.com/products)Build with MongoDB AtlasGet started for free in minutes[Sign Up](https://www.mongodb.com/cloud/atlas/register)Test Enterprise AdvancedDevelop with MongoDB on-premises[Download](https://www.mongodb.com/try/download/enterprise)Try Community EditionExplore the latest version of MongoDB[Download](https://www.mongodb.com/try/download/community)
* ResourcesDocumentation[Atlas DocumentationGet started using Atlas](https://www.mongodb.com/docs/atlas/)[Server DocumentationLearn to use MongoDB](https://www.mongodb.com/docs/manual/)[Start With GuidesGet step-by-step guidance for key tasks](https://www.mongodb.com/docs/guides/) [Tools and ConnectorsLearn how to connect to MongoDB](https://www.mongodb.com/docs/tools-and-connectors/)[MongoDB DriversUse drivers and libraries for MongoDB](https://www.mongodb.com/docs/drivers/)[Resources HubGet help building the next big thing with MongoDBarrow-right](https://www.mongodb.com/resources)Connect[![atlas_product_family](https://webimages.mongodb.com/_com_assets/icons/atlas_product_family_inverse.svg)Developer CenterExplore a wide range of developer resources](https://www.mongodb.com/developer/)[![general_events_ask_the_experts](https://webimages.mongodb.com/_com_assets/icons/general_events_ask_the_experts_inverse.svg)CommunityJoin a global community of developers](https://www.mongodb.com/community/)[![general_content_tutorial](https://webimages.mongodb.com/_com_assets/icons/general_content_tutorial_inverse.svg)Courses and CertificationLearn for free from MongoDB](https://learn.mongodb.com/)[![general_events_session](https://webimages.mongodb.com/_com_assets/icons/general_events_session_inverse.svg)Events and WebinarsFind an event or webinar near you](https://www.mongodb.com/events)
* SolutionsUse cases[Artificial Intelligence](https://www.mongodb.com/solutions/use-cases/artificial-intelligence)[Edge Computing](https://www.mongodb.com/use-cases/atlas-for-the-edge)[Internet of Things](https://www.mongodb.com/solutions/use-cases/internet-of-things)[Mobile](https://www.mongodb.com/solutions/use-cases/mobile)[Payments](https://www.mongodb.com/solutions/use-cases/payments)[Serverless Development](https://www.mongodb.com/solutions/use-cases/serverless)Industries[Financial Services](https://www.mongodb.com/solutions/industries/financial-services)[Telecommunications](https://www.mongodb.com/solutions/industries/telecommunications)[Healthcare](https://www.mongodb.com/solutions/industries/healthcare)[Retail](https://www.mongodb.com/solutions/industries/retail)[Public Sector](https://www.mongodb.com/solutions/industries/public-sector)[Manufacturing](https://www.mongodb.com/solutions/industries/manufacturing)[Solutions LibraryOrganized and tailored solutions to kick-start projectsarrow-right](https://www.mongodb.com/solutions/solutions-library)Developer Data PlatformAccelerate innovation at scale[Learn morearrow-right](https://www.mongodb.com/solutions/developer-data-platform)Startups and AI InnovatorsFor world-changing ideas and AI pioneers[Learn morearrow-right](https://www.mongodb.com/solutions/startups)Customer Case StudiesHear directly from our users[See Storiesarrow-right](https://www.mongodb.com/library/customer-case-studies)
* Company[CareersStart your next adventure](https://www.mongodb.com/company/careers)[BlogRead articles and announcements](https://www.mongodb.com/blog)[NewsroomRead press releases and news stories](https://www.mongodb.com/company/newsroom)[PartnersLearn about our partner ecosystem](https://www.mongodb.com/company/partners)[LeadershipMeet our executive team](https://www.mongodb.com/company/leadership)[CompanyLearn more about who we are](https://www.mongodb.com/company)Contact UsReach out to MongoDB[Letâs chatarrow-right](https://www.mongodb.com/company/contact)InvestorsVisit our investor portal[Learn morearrow-right](https://investors.mongodb.com/)
* [Pricing](https://www.mongodb.com/pricing)

![Language Selector Icon](https://webimages.mongodb.com/_com_assets/cms/lzsle5raf6v32fw36-language-selector-globe-dark-mode.svg?auto=format%252Ccompress)Eng[Support](https://www.mongodb.com/services/support)[Sign In](https://account.mongodb.com/account/login)[Try Free](https://www.mongodb.com/cloud/atlas/register)menu-vertical[![MongoDB logo](https://webimages.mongodb.com/_com_assets/cms/kuyj3d95v5vbmm2f4-horizontal_white.svg?auto=format%252Ccompress)](https://www.mongodb.com)

* [Docs Home](https://www.mongodb.com/docs/)

---

* [MongoDB Manual](/docs/v5.0/)
5.0* [Introduction](/docs/v5.0/introduction/)
* [CRUD Operations](/docs/v5.0/crud/)
* [Aggregation Operations](/docs/v5.0/aggregation/)
* [Indexes](/docs/v5.0/indexes/)
* [Atlas Search](https://www.mongodb.com/docs/atlas/atlas-search/?tck=docs_server_toc)
* [Atlas Vector Search](https://www.mongodb.com/docs/atlas/atlas-vector-search/vector-search-overview/?tck=docs_server_toc)
* [Time Series](/docs/v5.0/core/timeseries-collections/)
* [Change Streams](/docs/v5.0/changeStreams/)
* [Transactions](/docs/v5.0/core/transactions/)
* Data Modeling
* [Replication](/docs/v5.0/replication/)
* [Sharding](/docs/v5.0/sharding/)
* [Storage](/docs/v5.0/storage/)
* [Administration](/docs/v5.0/administration/)
* [Security](/docs/v5.0/security/)
* [Self-Managed Deployments](/docs/v5.0/self-managed-deployments/)
* FAQ
* Reference
* [Release Notes](/docs/v5.0/release-notes/)
* [5.0](/docs/v5.0/release-notes/5.0/)
* [Compatibility Changes](/docs/v5.0/release-notes/5.0-compatibility/)
* Upgrade 4.4 to 5.0
* [Downgrade 5.0 to 4.4](/docs/v5.0/release-notes/5.0-downgrade/)
* [Changelog](/docs/v5.0/release-notes/5.0-changelog/)
* [Versioning](/docs/v5.0/reference/versioning/)
* [Technical Support](/docs/v5.0/support/)

Docs MenuAsk MongoDB AIRate This Page[Docs Home](https://www.mongodb.com/docs/) / [MongoDB Manual](/docs/v5.0/) / [Release Notes](/docs/v5.0/release-notes/)
# Release Notes for MongoDB 5.0

On this page

* [Patch Releases](#patch-releases)
* [Time Series Collections](#time-series-collections)
* [Aggregation](#aggregation)
* [Auditing](#auditing)
* [Capped Collections](#capped-collections)
* [Change Streams](#change-streams)
* [Indexes](#indexes)
* [Removed Commands](#removed-commands)
* [Replica Sets](#replica-sets)
* [Security](#security)
* [Sharded Clusters](#sharded-clusters)
* [Shell Changes](#shell-changes)
* [Snapshots](#snapshots)
* [Transactions](#transactions)
* [Naming Changes](#naming-changes)
* [General Changes](#general-changes)
* [Performance Considerations](#performance-considerations)
* [Platform Support](#platform-support)
* [Changes Affecting Compatibility](#changes-affecting-compatibility)
* [Upgrade Procedures](#upgrade-procedures)
* [Downgrade Consideration](#downgrade-consideration)
* [Download](#download)
* [Known Issues](#known-issues)
* [Report an Issue](#report-an-issue)
MongoDB 5.0 is end of life as of October 2024. This version of the documentation is no longer
supported. To upgrade your 5.0 deployment, see the [MongoDB 6.0 upgrade procedures](https://www.mongodb.com/docs/manual/release-notes/6.0/#upgrade-procedures).
## Note

MongoDB 5.0 Released July 13, 2021

## Patch Releases

## Warning

### **Past Release Limitations**

The Critical Advisories below affect some prior MongoDB versions. If your
deployment depends on features impacted by a Critical Advisory, upgrade to
the latest available patch release.

| Issue | Affected Versions |
| --- | --- |
| [WT-7984](https://jira.mongodb.org/browse/WT-7984) | 5.0.0 - 5.0.2 |
| [WT-7995](https://jira.mongodb.org/browse/WT-7995) | 5.0.0 - 5.0.2 |
| [WT-10461](https://jira.mongodb.org/browse/WT-10461) | 5.0.0 - 5.0.14 (ARM64 or POWER system architectures) |
| [WT-10551](https://jira.mongodb.org/browse/WT-10551) | 5.0.2 - 5.0.17 (Incremental backups on Ops Manager or Cloud Manager clusters) |
| [SERVER-58936](https://jira.mongodb.org/browse/SERVER-58936) | 5.0.0 - 5.0.1 |
| [SERVER-60176](https://jira.mongodb.org/browse/SERVER-60176) | 5.0.0 - 5.0.21 |
| [SERVER-68511](https://jira.mongodb.org/browse/SERVER-68511) | 5.0.0 - 5.0.10 |
| [SERVER-77506](https://jira.mongodb.org/browse/SERVER-77506) | 5.0.0 - 5.0.23 |
| [SERVER-80203](https://jira.mongodb.org/browse/SERVER-80203) | 5.0.6 - 5.0.21 (Time Series collections sharded by metaField embedded objects) |
| [SERVER-82353](https://jira.mongodb.org/browse/SERVER-82353) | 5.0.0 - 5.0.24 |
| [SERVER-86622](https://jira.mongodb.org/browse/SERVER-86622) | 5.0.0 - 5.0.25 |

### 5.0.30 - Oct 24, 2024

## Important

### **Improper neutralization of null bytes may lead to buffer over-reads in MongoDB Server**

In MongoDB 5.0 prior to 5.0.30, an authorized user may trigger crashes or
receive the contents of buffer over-reads of Server memory by
issuing specially crafted requests that construct malformed BSON
in the MongoDB Server.

This issue affects MongoDB Server versions:

* 5.0.0 - 5.0.29
* 6.0.0 - 6.0.18
* 7.0.0 - 7.0.14
* 8.0.0 - 8.0.2

* [SERVER-96419](https://jira.mongodb.org/browse/SERVER-96419) Improper neutralization of null bytes may lead
  to buffer over-reads in MongoDB Server
* [All JIRA issues closed in 5.0.30](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2C%20TOOLS%2C%20WT)%20AND%20resolution%20%3D%20Fixed%20AND%20fixVersion%20%3D%205.0.30)
* [5.0.30 Changelog](/docs/v5.0/release-notes/5.0-changelog/#std-label-5.0.30-changelog)

### 5.0.29 - Sep 30, 2024

## Important

### **Fix for CSFLE and Queryable Encryption self-lookup may send values in subpipelines as plaintext instead of ciphertext**

Due to CVE-2024-8013, in MongoDB 5.0 prior to 5.0.28, a bug in query analysis of
certain complex self-referential [`$lookup`](/docs/v5.0/reference/operator/aggregation/lookup/#mongodb-pipeline-pipe.-lookup) subpipelines
may result in literal values in expressions for encrypted fields
being sent to the server malformed.

Should this occur, no documents are returned or written.
This issue affects the `mongocryptd` binary and `mongo_crypt_v1`
shared library in the following MongoDB Server versions:

* 7.3.0 - 7.3.3
* 7.0.0 - 7.0.11
* 6.0.0 - 6.0.16
* 5.0.0 - 5.0.28

**CVSS Score**: 2.2

**CWE**: CWE-319: Cleartext Transmission of Sensitive Information

* [SERVER-96254](https://jira.mongodb.org/browse/SERVER-96254) CSFLE and Queryable Encryption self-lookup may
  fail to encrypt values in subpipelines
* [SERVER-59831](https://jira.mongodb.org/browse/SERVER-59831) WTUniqueIndex::\_insert expects
  secondaries to pass in dupsAllowed=true
* [SERVER-76777](https://jira.mongodb.org/browse/SERVER-76777) Deadlock between index build external
  abort and self abort
* [SERVER-88750](https://jira.mongodb.org/browse/SERVER-88750) Add "bypassEmptyTsReplacement" param to
  insert, update, findAndModify, and bulkWrite
* [SERVER-91223](https://jira.mongodb.org/browse/SERVER-91223) $log gives incorrect calculation with Decimal128
* [WT-8771](https://jira.mongodb.org/browse/WT-8771) Checkpoint cleanup to dirty obsolete page
  with overflow items
* [All JIRA issues closed in 5.0.29](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2C%20TOOLS%2C%20WT)%20AND%20resolution%20%3D%20Fixed%20AND%20fixVersion%20%3D%205.0.29)
* [5.0.29 Changelog](/docs/v5.0/release-notes/5.0-changelog/#std-label-5.0.29-changelog)

### 5.0.28 - Jul 15, 2024

* [SERVER-63198](https://jira.mongodb.org/browse/SERVER-63198) Prevent shutdown command from hanging
* [SERVER-90747](https://jira.mongodb.org/browse/SERVER-90747) Handle $elemMatch with empty path in plan enumerator
  correctly
* [SERVER-91362](https://jira.mongodb.org/browse/SERVER-91362) Performance: Do not copy JS "scope" object if a cached
  JsExecution exists
* [SERVER-91562](https://jira.mongodb.org/browse/SERVER-91562) [5.0] IndexDescriptor::compareIndexOptions treats no
  unique/sparse as not identical to unique:false/sparse:false
* [WT-10807](https://jira.mongodb.org/browse/WT-10807) Skip in-memory deleted pages as part of the tree walk
* [All JIRA issues closed in 5.0.28](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2C%20TOOLS%2C%20WT)%20AND%20resolution%20%3D%20Fixed%20AND%20fixVersion%20%3D%205.0.28)
* [5.0.28 Changelog](/docs/v5.0/release-notes/5.0-changelog/#std-label-5.0.28-changelog)

### 5.0.27 - Jun 04, 2024

* [SERVER-78556](https://jira.mongodb.org/browse/SERVER-78556) Return default of internalInsertMaxBatchSize to 64
* [SERVER-79637](https://jira.mongodb.org/browse/SERVER-79637) Incorrect query results in $lookup with TS foreign
  collection using a correlated predicate
* [SERVER-80363](https://jira.mongodb.org/browse/SERVER-80363) server default writeConcern is not honored when wtimeout
  is set
* [SERVER-86474](https://jira.mongodb.org/browse/SERVER-86474) $\_internalApplyOplogUpdate with $set: { foo: Timestamp(0, 0) }
  is not replicated correctly
* [SERVER-86648](https://jira.mongodb.org/browse/SERVER-86648) Resumable index build sorter files are not fsynced on shutdown
* [All JIRA issues closed in 5.0.27](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2C%20TOOLS%2C%20WT)%20AND%20resolution%20%3D%20Fixed%20AND%20fixVersion%20%3D%205.0.27)
* [5.0.27 Changelog](/docs/v5.0/release-notes/5.0-changelog/#std-label-5.0.27-changelog)

### 5.0.26 - Mar 26, 2024

* [SERVER-68128](https://jira.mongodb.org/browse/SERVER-68128) Exceptions thrown while generating command response lead
  to network error
* [SERVER-72703](https://jira.mongodb.org/browse/SERVER-72703) Downgrade $out's db lock to MODE\_IX
* [SERVER-83602](https://jira.mongodb.org/browse/SERVER-83602) $or -> $in MatchExpression rewrite should not generate
  $or directly nested in another $or
* [SERVER-86717](https://jira.mongodb.org/browse/SERVER-86717) Resharding should validate user provided zone range
  doesn't include $-prefixed fields.
* [WT-11062](https://jira.mongodb.org/browse/WT-11062) Safe free the ref addr to allow concurrent access
* [All JIRA issues closed in 5.0.26](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2C%20TOOLS%2C%20WT)%20AND%20resolution%20%3D%20Fixed%20AND%20fixVersion%20%3D%205.0.26)
* [5.0.26 Changelog](/docs/v5.0/release-notes/5.0-changelog/#std-label-5.0.26-changelog)

### 5.0.25 - Feb 28, 2024

## Important

### **Fix for MongoDB Server may allow successful untrusted connection**

Due to CVE-2024-1351, in MongoDB 5.0 prior to 5.0.25, under certain
configurations of [`--tlsCAFile`](/docs/v5.0/reference/program/mongod/#std-option-mongod.--tlsCAFile) and
[`CAFile`](/docs/v5.0/reference/configuration-options/#mongodb-setting-net.tls.CAFile), MongoDB Server may skip peer certificate
validation which may result in untrusted connections to succeed.

This may effectively reduce the security guarantees provided by TLS
and open connections that should have been closed due to failing
certificate validation. This issue affects the following MongoDB
Server versions:

* 7.0.0 - 7.0.5
* 6.0.0 - 6.0.13
* 5.0.0 - 5.0.24
* 4.4.0 - 4.4.28

**CVSS Score**: 8.8

**CWE**: CWE-295: Improper Certificate Validation

* [SERVER-64444](https://jira.mongodb.org/browse/SERVER-64444) listIndexes fails on invalid pre-5.0 index spec
  after upgrade
* [SERVER-82353](https://jira.mongodb.org/browse/SERVER-82353) Multi-document transactions can miss documents
  when movePrimary runs concurrently
* [SERVER-83564](https://jira.mongodb.org/browse/SERVER-83564) Make sure the process field is indexed in
  config.locks
* [SERVER-85419](https://jira.mongodb.org/browse/SERVER-85419) Balancer pollutes logs in case no suitable
  recipient is found during draining
* [WT-10017](https://jira.mongodb.org/browse/WT-10017) Remove the unstable historical versions at the
  end of rollback to stable
* [All JIRA issues closed in 5.0.25](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2C%20TOOLS%2C%20WT)%20AND%20resolution%20%3D%20Fixed%20AND%20fixVersion%20%3D%205.0.25)
* [5.0.25 Changelog](/docs/v5.0/release-notes/5.0-changelog/#std-label-5.0.25-changelog)

### 5.0.24 - Jan 18, 2024

* [SERVER-50792](https://jira.mongodb.org/browse/SERVER-50792) Return more useful errors when a shard key index can't
  be found for shardCollection/refineCollectionShardKey
* [SERVER-77506](https://jira.mongodb.org/browse/SERVER-77506) Sharded multi-document transactions can mismatch data
  and ShardVersion
* [SERVER-81878](https://jira.mongodb.org/browse/SERVER-81878) startupRecoveryForRestore may not play nicely with
  collection drop applied during startup recovery
* [SERVER-83091](https://jira.mongodb.org/browse/SERVER-83091) $or query can trigger an infinite loop during plan
  enumeration
* [WT-7929](https://jira.mongodb.org/browse/WT-7929) Investigate a solution to avoid FTDC stalls during checkpoint
* [All JIRA issues closed in 5.0.24](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2C%20TOOLS%2C%20WT)%20AND%20resolution%20%3D%20Fixed%20AND%20fixVersion%20%3D%205.0.24)
* [5.0.24 Changelog](/docs/v5.0/release-notes/5.0-changelog/#std-label-5.0.24-changelog)

### 5.0.23 - Nov 27, 2023

* [SERVER-78108](https://jira.mongodb.org/browse/SERVER-78108) POS interface should expose its shutdown state
* [SERVER-78115](https://jira.mongodb.org/browse/SERVER-78115) Shard primaries must commit a majority write before
  using new routing information from the config server
* [SERVER-83150](https://jira.mongodb.org/browse/SERVER-83150) Document::shred() does not copy document metadata
* [WT-11564](https://jira.mongodb.org/browse/WT-11564) Fix RTS to read the newest transaction value only when it
  exists in the checkpoint
* [WT-11602](https://jira.mongodb.org/browse/WT-11602) Hide expected eviction failures from the application and
  don't rollback in case of errors
* [All JIRA issues closed in 5.0.23](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2C%20TOOLS%2C%20WT)%20AND%20resolution%20%3D%20Fixed%20AND%20fixVersion%20%3D%205.0.23)
* [5.0.23 Changelog](/docs/v5.0/release-notes/5.0-changelog/#std-label-5.0.23-changelog)

### 5.0.22 - Oct 26, 2023

* [SERVER-68548](https://jira.mongodb.org/browse/SERVER-68548) MongoDB Shell version 4.4.15 logging asio message despite
  --quiet flag
* [SERVER-80021](https://jira.mongodb.org/browse/SERVER-80021) Make $convert round-trip correctly between double and string
* [SERVER-80703](https://jira.mongodb.org/browse/SERVER-80703) Avoid traversing routing table in MigrationDestinationManager
* [SERVER-81106](https://jira.mongodb.org/browse/SERVER-81106) Recipient shard doesn't wait for the collection version
  to be locally persisted before starting the cloning phase
* [WT-11064](https://jira.mongodb.org/browse/WT-11064) Skip globally visible tombstones as part of update obsolete check
* [All JIRA issues closed in 5.0.22](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2C%20TOOLS%2C%20WT)%20AND%20resolution%20%3D%20Fixed%20AND%20fixVersion%20%3D%205.0.22)
* [5.0.22 Changelog](/docs/v5.0/release-notes/5.0-changelog/#std-label-5.0.22-changelog)

### 5.0.21 - Sep 12, 2023

* [SERVER-60466](https://jira.mongodb.org/browse/SERVER-60466) Support drivers gossiping signed $clusterTimes to
  replica set --shardsvrs before addShard is run
* [SERVER-71627](https://jira.mongodb.org/browse/SERVER-71627) Refreshed cached collection route info will severely
  block all client request when a cluster with 1 million chunks
* [SERVER-78813](https://jira.mongodb.org/browse/SERVER-78813) Commit point propagation fails indefinitely with exhaust
  cursors with null lastCommitted optime
* [WT-10759](https://jira.mongodb.org/browse/WT-10759) Do not retry to force evict history store pages during
  reconciliation
* [WT-11051](https://jira.mongodb.org/browse/WT-11051) Fix newest start durable timestamp comparison in aggregate
  timestamp validation
* [All JIRA issues closed in 5.0.21](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2C%20TOOLS%2C%20WT)%20AND%20resolution%20%3D%20Fixed%20AND%20fixVersion%20%3D%205.0.21)
* [5.0.21 Changelog](/docs/v5.0/release-notes/5.0-changelog/#std-label-5.0.21-changelog)

### 5.0.20 - Aug 14, 2023

* [SERVER-74954](https://jira.mongodb.org/browse/SERVER-74954) Incorrect result when contained $or rewrites $elemMatch
  extra condition
* [SERVER-78813](https://jira.mongodb.org/browse/SERVER-78813) Commit point propagation fails indefinitely with
  exhaust cursors with null lastCommitted optime
* [SERVER-79136](https://jira.mongodb.org/browse/SERVER-79136) Incorrect query result of $match + $group on metaField
  over time-series
* [WT-10449](https://jira.mongodb.org/browse/WT-10449) Do not save update chain when there are no updates to be
  written to the history store
* [WT-11031](https://jira.mongodb.org/browse/WT-11031) Fix RTS to skip tables with no time window information in
  the checkpoint
* [All JIRA issues closed in 5.0.20](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2C%20TOOLS%2C%20WT)%20AND%20resolution%20%3D%20Fixed%20AND%20fixVersion%20%3D%205.0.20)
* [5.0.20 Changelog](/docs/v5.0/release-notes/5.0-changelog/#std-label-5.0.20-changelog)

### 5.0.19 - Jul 13, 2023

* [SERVER-71985](https://jira.mongodb.org/browse/SERVER-71985) Automatically retry time series insert on DuplicateKey
  error
* [SERVER-74551](https://jira.mongodb.org/browse/SERVER-74551) WriteConflictException unnecessarily logged as warning
  during findAndModify after upgrade to mongo 5.0
* [SERVER-77018](https://jira.mongodb.org/browse/SERVER-77018) Deadlock between dbStats and 2 index builds
* [SERVER-78126](https://jira.mongodb.org/browse/SERVER-78126) For specific kinds of input, mongo::Value() always
  hashes to the same result on big-endian platforms
* [WT-10253](https://jira.mongodb.org/browse/WT-10253) Run session dhandle sweep and session cursor sweep more
  often
* [All JIRA issues closed in 5.0.19](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2C%20TOOLS%2C%20WT)%20AND%20resolution%20%3D%20Fixed%20AND%20fixVersion%20%3D%205.0.19)
* [5.0.19 Changelog](/docs/v5.0/release-notes/5.0-changelog/#std-label-5.0.19-changelog)

### 5.0.18 - May 18, 2023

Issues fixed:

* [SERVER-48196](https://jira.mongodb.org/browse/SERVER-48196) Upgrade the timelib to the latest to update the built-in timezone files to the latest
* [SERVER-54150](https://jira.mongodb.org/browse/SERVER-54150) Recovery from a stable checkpoint should fassert on oplog application failures
* [SERVER-57056](https://jira.mongodb.org/browse/SERVER-57056) Syslog severity set incorrectly for INFO messages
* [SERVER-72686](https://jira.mongodb.org/browse/SERVER-72686) Add support for $collStats agg stage on timeseries collection
* [WT-10551](https://jira.mongodb.org/browse/WT-10551) Incremental backup may omit modified blocks
* [All JIRA issues closed in 5.0.18](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2C%20TOOLS%2C%20WT)%20AND%20resolution%20%3D%20Fixed%20AND%20fixVersion%20%3D%205.0.18)
* [5.0.18 Changelog](/docs/v5.0/release-notes/5.0-changelog/#std-label-5.0.18-changelog)

### 5.0.17 - Apr 27, 2023

Issues fixed:

* [SERVER-73229](https://jira.mongodb.org/browse/SERVER-73229) Logical sessions cache refresh ignores write errors
  from updating session document, leading to cursors being killed early
* [SERVER-74647](https://jira.mongodb.org/browse/SERVER-74647) Resharding state machine creation should be retried
  after interruption
* [SERVER-75261](https://jira.mongodb.org/browse/SERVER-75261) "listCollections" command fails with
  BSONObjectTooLarge error
* [SERVER-75431](https://jira.mongodb.org/browse/SERVER-75431) Get rid or fix best effort check for primary db
  on rename path in sharded clusters
* [SERVER-76098](https://jira.mongodb.org/browse/SERVER-76098) Allow queries with $search and non-simple collations
* [All JIRA issues closed in 5.0.17](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2C%20TOOLS%2C%20WT)%20AND%20resolution%20%3D%20Fixed%20AND%20fixVersion%20%3D%205.0.17)
* [5.0.17 Changelog](/docs/v5.0/release-notes/5.0-changelog/#std-label-5.0.17-changelog)

### 5.0.16 - Apr 10, 2023

Issues fixed:

* [SERVER-61909](https://jira.mongodb.org/browse/SERVER-61909) Hang inserting or deleting document with large
  number of index entries
* [SERVER-73822](https://jira.mongodb.org/browse/SERVER-73822) Time-series $group rewrite ignores certain
  accumulators
* [SERVER-74345](https://jira.mongodb.org/browse/SERVER-74345) mongodb-org-server 4.4.19, 5.0.15, 6.0.5 not
  starting after upgrading from older version (Debian, RPM Packages)
* [SERVER-74501](https://jira.mongodb.org/browse/SERVER-74501) Fix MigrationBatchFetcher/Inserter completion
  reliance to not spawn an extra cleanup thread
* [SERVER-75205](https://jira.mongodb.org/browse/SERVER-75205) Deadlock between stepdown and restoring locks
  after yielding when all read tickets exhausted
* [All JIRA issues closed in 5.0.16](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2C%20TOOLS%2C%20WT)%20AND%20resolution%20%3D%20Fixed%20AND%20fixVersion%20%3D%205.0.16)
* [5.0.16 Changelog](/docs/v5.0/release-notes/5.0-changelog/#std-label-5.0.16-changelog)

### 5.0.15 - Feb 27, 2023

Issues fixed:

* [SERVER-54900](https://jira.mongodb.org/browse/SERVER-54900) Blocking networking calls can delay sync-source resolution indefinitely
* [SERVER-72416](https://jira.mongodb.org/browse/SERVER-72416) The find and findAndModify projection code does not honor the collection level collation
* [SERVER-71759](https://jira.mongodb.org/browse/SERVER-71759) dataSize command doesn't yield
* [SERVER-72222](https://jira.mongodb.org/browse/SERVER-72222) MapReduce with single reduce optimization fails when merging results in sharded cluster
* [WT-9268](https://jira.mongodb.org/browse/WT-9268) Delay deletion of the history store record to reconciliation
* [All JIRA issues closed in 5.0.15](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2C%20TOOLS%2C%20WT)%20AND%20resolution%20%3D%20Fixed%20AND%20fixVersion%20%3D%205.0.15)
* [5.0.15 Changelog](/docs/v5.0/release-notes/5.0-changelog/#std-label-5.0.15-changelog)

### 5.0.14 - Nov 21, 2022

Issues fixed:

* [SERVER-68477](https://jira.mongodb.org/browse/SERVER-68477) Improve NaN-handling for expireAfterSeconds TTL
  index parameter
* [SERVER-66289](https://jira.mongodb.org/browse/SERVER-66289) $out incorrectly throws BSONObj size error on
  v5.0.8
* [SERVER-61185](https://jira.mongodb.org/browse/SERVER-61185) Use prefix\_search for unique index lookup
* [SERVER-68115](https://jira.mongodb.org/browse/SERVER-68115) Bug fix for "elemMatchRootLength > 0" invariant
  trigger
* [SERVER-68139](https://jira.mongodb.org/browse/SERVER-68139) Resharding command fails if the projection sort
  is bigger than 100MB
* [All JIRA issues closed in 5.0.14](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2C%20TOOLS%2C%20WT)%20AND%20resolution%20%3D%20Fixed%20AND%20fixVersion%20%3D%205.0.14)
* [5.0.14 Changelog](/docs/v5.0/release-notes/5.0-changelog/#std-label-5.0.14-changelog)

### 5.0.13 - Sep 29, 2022

Issues fixed:

* [SERVER-69611](https://jira.mongodb.org/browse/SERVER-69611) Set the -ffp-contract=off compiler option by
  default
* [SERVER-69220](https://jira.mongodb.org/browse/SERVER-69220) refineCollectionShardKey permits toggling
  current shard key fields between range-based and hashed, leading to
  data inconsistency
* [SERVER-67650](https://jira.mongodb.org/browse/SERVER-67650) Resharding recipient can return
  remainingOperationTimeEstimatedSecs=0 when the oplog applier hasn't
  caught up with the oplog fetcher
* [SERVER-68094](https://jira.mongodb.org/browse/SERVER-68094) Resharding with custom generated \_id fails with
  projection error
* [WT-9870](https://jira.mongodb.org/browse/WT-9870) Fix updating pinned timestamp whenever oldest
  timestamp is updated during recovery
* [All JIRA issues closed in 5.0.13](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2C%20TOOLS%2C%20WT)%20AND%20resolution%20%3D%20Fixed%20AND%20fixVersion%20%3D%205.0.13)
* [5.0.13 Changelog](/docs/v5.0/release-notes/5.0-changelog/#std-label-5.0.13-changelog)

### 5.0.12 - Sep 05, 2022

Issues fixed:

* [SERVER-68925](https://jira.mongodb.org/browse/SERVER-68925) Reintroduce check table logging settings at
  startup (revert [SERVER-43664)](https://jira.mongodb.org/browse/SERVER-43664)
* [SERVER-63852](https://jira.mongodb.org/browse/SERVER-63852) getThreadName() should not crash
* [SERVER-60958](https://jira.mongodb.org/browse/SERVER-60958) Avoid server hang in chunk migration when
  step-down event occurs
* [SERVER-65382](https://jira.mongodb.org/browse/SERVER-65382) AutoSplitVector should not use clientReadable to
  reorder shard key fields
* [SERVER-63843](https://jira.mongodb.org/browse/SERVER-63843) Don't allow recursive doLog in synchronous
  signal handlers
* [All JIRA issues closed in 5.0.12](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2C%20TOOLS%2C%20WT)%20AND%20resolution%20%3D%20Fixed%20AND%20fixVersion%20%3D%205.0.12)
* [5.0.12 Changelog](/docs/v5.0/release-notes/5.0-changelog/#std-label-5.0.12-changelog)

### 5.0.11 - Aug 19, 2022

Issues fixed:

* [SERVER-68511](https://jira.mongodb.org/browse/SERVER-68511) MovePrimary update of `config.databases` entry
  must use dotted fields notation
* [SERVER-61321](https://jira.mongodb.org/browse/SERVER-61321) Improve handling of large/NaN values for text
  index version
* [SERVER-60607](https://jira.mongodb.org/browse/SERVER-60607) Improve handling of large/NaN values for geo
  index version
* [SERVER-68628](https://jira.mongodb.org/browse/SERVER-68628) Retrying a failed resharding operation after a
  primary failover can lead to server crash or lost writes
* [SERVER-68522](https://jira.mongodb.org/browse/SERVER-68522) Prevent 5.0 binary from starting in fCV 4.4 with
  misconfigured TTL index
* [WT-9500](https://jira.mongodb.org/browse/WT-9500) Fix RTS to use cell time window instead of key/value
  timestamps of HS update
* [All JIRA issues closed in 5.0.11](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2C%20TOOLS%2C%20WT)%20AND%20resolution%20%3D%20Fixed%20AND%20fixVersion%20%3D%205.0.11)
* [5.0.11 Changelog](/docs/v5.0/release-notes/5.0-changelog/#std-label-5.0.11-changelog)

### 5.0.10 - Jul 29, 2022

Issues fixed:

* [SERVER-66418](https://jira.mongodb.org/browse/SERVER-66418) Bad projection created during dependency
  analysis due to string order assumption
* [SERVER-65821](https://jira.mongodb.org/browse/SERVER-65821) Deadlock during setFCV when there are prepared
  transactions that have not persisted commit/abort decision
* [SERVER-65131](https://jira.mongodb.org/browse/SERVER-65131) Disable opportunistic read targeting (except for
  hedged reads)
* [SERVER-63971](https://jira.mongodb.org/browse/SERVER-63971) Change server parameter to default to
  read-your-writes behavior after 2PC transaction
* [SERVER-66433](https://jira.mongodb.org/browse/SERVER-66433) Backport deadline waiting for overlapping range
  deletion to finish to pre-v5.1 versions
* [All JIRA issues closed in 5.0.10](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2C%20TOOLS%2C%20WT)%20AND%20resolution%20%3D%20Fixed%20AND%20fixVersion%20%3D%205.0.10)
* [5.0.10 Changelog](/docs/v5.0/release-notes/5.0-changelog/#std-label-5.0.10-changelog)

### 5.0.9 - May 31, 2022

Issues fixed:

* [SERVER-65636](https://jira.mongodb.org/browse/SERVER-65636) Remove limits on number of LDAP connections
  per host
* [SERVER-65137](https://jira.mongodb.org/browse/SERVER-65137) Detect namespace changes when refreshing
  Collection after yielding
* [SERVER-64822](https://jira.mongodb.org/browse/SERVER-64822) Sharding an empty collection releases the
  critical section too early
* [SERVER-62175](https://jira.mongodb.org/browse/SERVER-62175) Mongos fails to attach RetryableWrite Error
  Label For Command Interrupted In \_parseCommand
* [WT-9096](https://jira.mongodb.org/browse/WT-9096) Fix search near returning wrong key/value sometimes
  when key doesn't exist
* [All JIRA issues closed in 5.0.9](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2C%20TOOLS%2C%20WT)%20AND%20resolution%20%3D%20Fixed%20AND%20fixVersion%20%3D%205.0.9)
* [5.0.9 Changelog](/docs/v5.0/release-notes/5.0-changelog/#std-label-5.0.9-changelog)

### 5.0.8 - Apr 25, 2022

Issues fixed:

* [SERVER-63531](https://jira.mongodb.org/browse/SERVER-63531) commitQuorum incorrectly includes
  buildIndexes:false nodes and error message incorrectly says that only
  voting nodes are eligible
* [SERVER-63387](https://jira.mongodb.org/browse/SERVER-63387) 1 StreamingCursor should return backup blocks in
  the order they were retrieved from the WiredTiger backup cursor
* [SERVER-62229](https://jira.mongodb.org/browse/SERVER-62229) Fix invariant when applying index build entries
  while recoverFromOplogAsStandalone=true
* [SERVER-61879](https://jira.mongodb.org/browse/SERVER-61879) Refreshes to recover migrations must never join
  ongoing refreshes
* [WT-8924](https://jira.mongodb.org/browse/WT-8924) Don't check against on disk time window if there is
  an insert list when checking for conflicts in row-store
* [All JIRA issues closed in 5.0.8](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2C%20TOOLS%2C%20WT)%20AND%20resolution%20%3D%20Fixed%20AND%20fixVersion%20%3D%205.0.8)
* [5.0.8 Changelog](/docs/v5.0/release-notes/5.0-changelog/#std-label-5.0.8-changelog)

### 5.0.7 - Apr 11, 2022

Issues fixed:

* [SERVER-64517](https://jira.mongodb.org/browse/SERVER-64517) RecoverableCriticalSection is not properly
  recovered on startup
* [SERVER-64403](https://jira.mongodb.org/browse/SERVER-64403) Find queries with SORT\_MERGE collation-encode
  the missing sort attribute
* [SERVER-63742](https://jira.mongodb.org/browse/SERVER-63742) Default topology time in shard can lead to
  infinite refresh in shard registry
* [SERVER-60412](https://jira.mongodb.org/browse/SERVER-60412) Host memory limit check does not honor cgroups
  v2
* [WT-7922](https://jira.mongodb.org/browse/WT-7922) Handle missing WiredTiger version file
* [All JIRA issues closed in 5.0.7](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2C%20TOOLS%2C%20WT)%20AND%20resolution%20%3D%20Fixed%20AND%20fixVersion%20%3D%205.0.7)
* [5.0.7 Changelog](/docs/v5.0/release-notes/5.0-changelog/#std-label-5.0.7-changelog)

### 5.0.6 - Jan 31, 2022

Issues fixed:

* [WT-8395](https://jira.mongodb.org/browse/WT-8395) Inconsistent data after upgrade from 4.4.3 and 4.4.4 to 4.4.8+ and 5.0.2+
* [SERVER-62245](https://jira.mongodb.org/browse/SERVER-62245) MigrationRecovery must not assume that only one migration needs to be recovered
* [SERVER-61427](https://jira.mongodb.org/browse/SERVER-61427) Unique index builds can cause a loss of availability during commit due to checking many false duplicates
* [SERVER-61194](https://jira.mongodb.org/browse/SERVER-61194) Prevent time-series bucket OID reuse with coarse granularity
* [SERVER-60310](https://jira.mongodb.org/browse/SERVER-60310) OCSP response validation should not consider statuses of irrelevant certificates
* [All JIRA issues closed in 5.0.6](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2C%20TOOLS%2C%20WT)%20AND%20resolution%20%3D%20Fixed%20AND%20fixVersion%20%3D%205.0.6)
* [5.0.6 Changelog](/docs/v5.0/release-notes/5.0-changelog/#std-label-5.0.6-changelog)

### 5.0.5 - Dec 6, 2021

Issues fixed:

* [SERVER-61483](https://jira.mongodb.org/browse/SERVER-61483) Resharding coordinator fails to recover abort
  decision on step-up, attempts to commit operation as success, leading
  to data inconsistency
* [SERVER-59858](https://jira.mongodb.org/browse/SERVER-59858) Add observability for tasks scheduled on the
  reactor thread
* [SERVER-51329](https://jira.mongodb.org/browse/SERVER-51329) Unexpected non-retryable error when shutting
  down a mongos server
* [WT-8163](https://jira.mongodb.org/browse/WT-8163) Consider more eviction scenarios to give up
  checkpoint-cleanup
* [WT-7912](https://jira.mongodb.org/browse/WT-7912) Fix prefix search near optimisation to handle
  scenarios where the key range is split across pages.
* [All JIRA issues closed in 5.0.5](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2C%20TOOLS%2C%20WT)%20AND%20resolution%20%3D%20Fixed%20AND%20fixVersion%20%3D%205.0.5)
* [5.0.5 Changelog](/docs/v5.0/release-notes/5.0-changelog/#std-label-5.0.5-changelog)

### 5.0.4 - Nov 15, 2021

Issues fixed:

* [SERVER-60326](https://jira.mongodb.org/browse/SERVER-60326) Windows Server fails to start when X509
  certificate has empty subject name
* [SERVER-59876](https://jira.mongodb.org/browse/SERVER-59876) Large delays in returning from libcrypto.so
  while establishing egress connections
* [SERVER-59456](https://jira.mongodb.org/browse/SERVER-59456) Start the LDAPReaper threadpool
* [SERVER-59226](https://jira.mongodb.org/browse/SERVER-59226) Deadlock when stepping down with a profile
  session marked as uninterruptible
* [SERVER-59074](https://jira.mongodb.org/browse/SERVER-59074) Do not acquire storage tickets just to set/wait
  on oplog visibility
* [All JIRA issues closed in 5.0.4](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2C%20TOOLS%2C%20WT)%20AND%20resolution%20%3D%20Fixed%20AND%20fixVersion%20%3D%205.0.4)
* [5.0.4 Changelog](/docs/v5.0/release-notes/5.0-changelog/#std-label-5.0.4-changelog)

### 5.0.3 - Sep 21, 2021

Issues fixed:

* [SERVER-57667](https://jira.mongodb.org/browse/SERVER-57667): Improve processing speed for resharding's
  collection cloning pipeline
* [SERVER-57630](https://jira.mongodb.org/browse/SERVER-57630): Enable SSL\_OP\_NO\_RENEGOTIATION on Ubuntu 18.04
  when running against OpenSSL 1.1.1
* [WT-8005](https://jira.mongodb.org/browse/WT-8005): Fix a prepare commit bug that could leave the
  history store entry unresolved
* [WT-7995](https://jira.mongodb.org/browse/WT-7995): Fix the global visibility that it cannot go beyond
  checkpoint visibility
* [WT-7984](https://jira.mongodb.org/browse/WT-7984): Fix a bug that could cause a checkpoint to omit a
  page of data
* [All JIRA issues closed in 5.0.3](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D%275.0.3%27)
* [5.0.3 Changelog](/docs/v5.0/release-notes/5.0-changelog/#std-label-5.0.3-changelog)

### 5.0.2 - Aug 4, 2021

Issues fixed:

* [SERVER-58936](https://jira.mongodb.org/browse/SERVER-58936): Unique index constraints may not be enforced
* [SERVER-57756](https://jira.mongodb.org/browse/SERVER-57756): Race between concurrent stepdowns and applying
  transaction oplog entry
* [SERVER-54729](https://jira.mongodb.org/browse/SERVER-54729): MongoDB Enterprise Debian/Ubuntu packages
  should depend on libsasl2-modules and libsasl2-modules-gssapi-mit
* [SERVER-47372](https://jira.mongodb.org/browse/SERVER-47372): config.cache collections can remain even after
  collection has been dropped
* [WT-6729](https://jira.mongodb.org/browse/WT-6729): Quiesce eviction prior running rollback to stable's
  active transaction check
* [All JIRA issues closed in 5.0.2](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D%275.0.2%27)
* [5.0.2 Changelog](/docs/v5.0/release-notes/5.0-changelog/#std-label-5.0.2-changelog)

### 5.0.1 - Jul 22, 2021

Issues fixed:

* [SERVER-58489](https://jira.mongodb.org/browse/SERVER-58489): Collection creation stuck in an infinite
  writeConflictRetry loop when having a duplicate name as a view
* [SERVER-58171](https://jira.mongodb.org/browse/SERVER-58171): Changing time-series granularity does not
  update view definition
* [All JIRA issues closed in 5.0.1](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D%275.0.1%27)
* [5.0.1 Changelog](/docs/v5.0/release-notes/5.0-changelog/#std-label-5.0.1-changelog)
### 5.0.0 - Jul 13, 2021

The rest of this page provides the 5.0.0 release notes:

## Time Series Collections

MongoDB 5.0 introduces [time series collections](/docs/v5.0/core/timeseries-collections/#std-label-manual-timeseries-collection) which efficiently store sequences of
measurements over a period of time. Compared to normal collections,
storing time series data in time series collections improves query
efficiency and reduces disk usage for your data and indexes.

## Aggregation

### New Aggregation Operators

MongoDB 5.0 introduces the following aggregation operators:

| Operator | Description |
| --- | --- |
| [`$count`](/docs/v5.0/reference/operator/aggregation/count-accumulator/#mongodb-group-grp.-count) | [`$count (aggregation accumulator)`](/docs/v5.0/reference/operator/aggregation/count-accumulator/#mongodb-group-grp.-count) provides a count of all documents when used in the existing pipeline [`$group (aggregation)`](/docs/v5.0/reference/operator/aggregation/group/#mongodb-pipeline-pipe.-group) stage and the new MongoDB 5.0 [`$setWindowFields`](/docs/v5.0/reference/operator/aggregation/setWindowFields/#mongodb-pipeline-pipe.-setWindowFields) stage.  The [`$count (aggregation accumulator)`](/docs/v5.0/reference/operator/aggregation/count-accumulator/#mongodb-group-grp.-count) is distinct from the [`$count (aggregation)`](/docs/v5.0/reference/operator/aggregation/count/#mongodb-pipeline-pipe.-count) pipeline stage. |
| [`$dateAdd`](/docs/v5.0/reference/operator/aggregation/dateAdd/#mongodb-expression-exp.-dateAdd) | Increments a [Date](/docs/v5.0/reference/method/Date/) object by a specified number of time units. |
| [`$dateDiff`](/docs/v5.0/reference/operator/aggregation/dateDiff/#mongodb-expression-exp.-dateDiff) | Returns the difference between two dates. |
| [`$dateSubtract`](/docs/v5.0/reference/operator/aggregation/dateSubtract/#mongodb-expression-exp.-dateSubtract) | Decrements a [Date](/docs/v5.0/reference/method/Date/) object by a specified number of time units. |
| [`$dateTrunc`](/docs/v5.0/reference/operator/aggregation/dateTrunc/#mongodb-expression-exp.-dateTrunc) | Truncates a date. |
| [`$getField`](/docs/v5.0/reference/operator/aggregation/getField/#mongodb-expression-exp.-getField) | Returns the value of a specified field from a document. You can use [`$getField`](/docs/v5.0/reference/operator/aggregation/getField/#mongodb-expression-exp.-getField) to retrieve the value of fields with names that contain periods (`.`) or start with dollar signs (`$`). |
| [`$rand`](/docs/v5.0/reference/operator/aggregation/rand/#mongodb-expression-exp.-rand) | The [`$rand`](/docs/v5.0/reference/operator/aggregation/rand/#mongodb-expression-exp.-rand) method generates a random float value between 0 and 1 each time it is called. The new [`$sampleRate`](/docs/v5.0/reference/operator/aggregation/sampleRate/#mongodb-expression-exp.-sampleRate) operator is based on `$rand`. |
| [`$sampleRate`](/docs/v5.0/reference/operator/aggregation/sampleRate/#mongodb-expression-exp.-sampleRate) | Adds the [`$sampleRate`](/docs/v5.0/reference/operator/aggregation/sampleRate/#mongodb-expression-exp.-sampleRate) method to probabilistically select documents from a pipeline at a given rate. |
| [`$setField`](/docs/v5.0/reference/operator/aggregation/setField/#mongodb-expression-exp.-setField) | Adds, updates, or removes a specified field in a document. You can use [`$setField`](/docs/v5.0/reference/operator/aggregation/setField/#mongodb-expression-exp.-setField) to add, update, or remove fields with names that contain periods (`.`) or start with dollar signs (`$`). |
| [`$unsetField`](/docs/v5.0/reference/operator/aggregation/unsetField/#mongodb-expression-exp.-unsetField) | Removes a specified field in a document. An alias for [`$setField`](/docs/v5.0/reference/operator/aggregation/setField/#mongodb-expression-exp.-setField) to remove fields with names that contain periods (`.`) or that start with dollar signs (`$`). |

### Window Operators

MongoDB 5.0 introduces the [`$setWindowFields`](/docs/v5.0/reference/operator/aggregation/setWindowFields/#mongodb-pipeline-pipe.-setWindowFields) pipeline stage,
allowing you to perform operations on a specified span of documents in a
collection, known as a *window*. The operation returns the results based
on the chosen [window operator.](/docs/v5.0/reference/operator/aggregation/setWindowFields/#std-label-setWindowFields-window-operators)

For example, you can use the [`$setWindowFields`](/docs/v5.0/reference/operator/aggregation/setWindowFields/#mongodb-pipeline-pipe.-setWindowFields) stage to
output the:

* Difference in sales between two documents in a collection.
* Sales rankings.
* Cumulative sales totals.
* Analysis of complex time series information without exporting the
  data to an external database.
### General Aggregation Improvements

#### `$expr` Operator: Comparison Operators Use Indexes

Starting in MongoDB 5.0, the [`$eq`](/docs/v5.0/reference/operator/aggregation/eq/#mongodb-expression-exp.-eq), [`$lt`](/docs/v5.0/reference/operator/aggregation/lt/#mongodb-expression-exp.-lt),
[`$lte`](/docs/v5.0/reference/operator/aggregation/lte/#mongodb-expression-exp.-lte), [`$gt`](/docs/v5.0/reference/operator/aggregation/gt/#mongodb-expression-exp.-gt), and [`$gte`](/docs/v5.0/reference/operator/aggregation/gte/#mongodb-expression-exp.-gte) operators
placed in an [`$expr`](/docs/v5.0/reference/operator/query/expr/#mongodb-query-op.-expr) operator can use indexes to improve performance.

#### `$ifNull` Expression Accepts Multiple Input Expressions

Starting in MongoDB 5.0, you can specify multiple input expressions for
the [`$ifNull`](/docs/v5.0/reference/operator/aggregation/ifNull/#mongodb-expression-exp.-ifNull) expression before returning a replacement
expression.

#### `let` Option for Aggregation

Starting in MongoDB 5.0, the [`aggregate`](/docs/v5.0/reference/command/aggregate/#mongodb-dbcommand-dbcmd.aggregate) command and
[`db.collection.aggregate()`](/docs/v5.0/reference/method/db.collection.aggregate/#mongodb-method-db.collection.aggregate) helper method have a `let` option
to specify a list of variables that can be used elsewhere in the
aggregation pipeline. This allows you to improve command readability by
separating the variables from the query text.

#### `$lookup` Stage: Concise Correlated Subqueries

Starting in MongoDB 5.0, an aggregation pipeline [`$lookup`](/docs/v5.0/reference/operator/aggregation/lookup/#mongodb-pipeline-pipe.-lookup)
stage supports [concise correlated subqueries](/docs/v5.0/reference/operator/aggregation/lookup/#std-label-lookup-syntax-concise-correlated-subquery) that improve joins between
collections.

#### `$lookup` Stage: Uncorrelated Subqueries

Starting in MongoDB 5.0, for an uncorrelated subquery in a
[`$lookup`](/docs/v5.0/reference/operator/aggregation/lookup/#mongodb-pipeline-pipe.-lookup) pipeline stage containing a [`$sample`](/docs/v5.0/reference/operator/aggregation/sample/#mongodb-pipeline-pipe.-sample)
stage, the [`$sampleRate`](/docs/v5.0/reference/operator/aggregation/sampleRate/#mongodb-expression-exp.-sampleRate) operator, or the
[`$rand`](/docs/v5.0/reference/operator/aggregation/rand/#mongodb-expression-exp.-rand) operator, the subquery is always run again if
repeated. Previously, depending on the subquery output size, either the
subquery output was cached or the subquery was run again.

See [Perform an Uncorrelated Subquery with `$lookup`.](/docs/v5.0/reference/operator/aggregation/lookup/#std-label-lookup-uncorrelated-subquery)

#### `$sort` Stage: Performance Improvements

Starting in MongoDB 5.0, the [query optimizer](/docs/v5.0/reference/glossary/#std-term-query-optimizer) pushes down the results of
a [`$project`](/docs/v5.0/reference/operator/aggregation/project/#mongodb-pipeline-pipe.-project) stage into the [`$sort`](/docs/v5.0/reference/operator/aggregation/sort/#mongodb-pipeline-pipe.-sort) stage. As a result,
`$sort` operations can require less RAM when used with the `project` stage
and avoid `Sort exceeded memory limit` errors.

#### Aggregation Metrics

| Metric | Description |
| --- | --- |
| [`metrics.operatorCounters.match`](/docs/v5.0/reference/command/serverStatus/#mongodb-serverstatus-serverstatus.metrics.operatorCounters.match) | A document which indicates how often [match expressions](/docs/v5.0/reference/operator/query/#std-label-query-projection-operators-top) ran. |

## Auditing

### Runtime Audit Filter Configuration

MongoDB 5.0 adds the ability to [configure auditing filters](/docs/v5.0/tutorial/configure-audit-filters/#std-label-configure-audit-filters-at-runtime) at runtime.

| Operator | Description |
| --- | --- |
| [`auditConfigPollingFrequencySecs`](/docs/v5.0/reference/parameters/#mongodb-parameter-param.auditConfigPollingFrequencySecs) | Defines the polling interval for checking audit configuration |
| [`getAuditConfig`](/docs/v5.0/reference/command/getAuditConfig/#mongodb-dbcommand-dbcmd.getAuditConfig) | Retrieves audit configurations from [`mongod`](/docs/v5.0/reference/program/mongod/#mongodb-binary-bin.mongod) and [`mongos`.](/docs/v5.0/reference/program/mongos/#mongodb-binary-bin.mongos) |
| [`setAuditConfig`](/docs/v5.0/reference/command/setAuditConfig/#mongodb-dbcommand-dbcmd.setAuditConfig) | Sets new audit configurations for [`mongod`](/docs/v5.0/reference/program/mongod/#mongodb-binary-bin.mongod) and [`mongos`](/docs/v5.0/reference/program/mongos/#mongodb-binary-bin.mongos) instances at runtime. |

### General Auditing Updates

Starting in MongoDB 5.0:

* [System event auditing](/docs/v5.0/reference/audit-message/#std-label-audit-message-format) has:

  + An additional [uuid](/docs/v5.0/reference/audit-message/#std-label-audit-message-uuid) field and other
    [audit message](/docs/v5.0/reference/audit-message/#std-label-audit-message-format) enhancements.
  + New audit message types: [clientMetadata](/docs/v5.0/reference/audit-message/#std-label-audit-message-clientMetadata), [directAuthMutation](/docs/v5.0/reference/audit-message/#std-label-audit-message-directAuthMutation), [logout](/docs/v5.0/reference/audit-message/#std-label-audit-message-logout), and [startup.](/docs/v5.0/reference/audit-message/#std-label-audit-message-startup)
  + Additional information and logging scenarios for these existing
    audit message types: [authCheck](/docs/v5.0/reference/audit-message/#std-label-audit-message-authCheck),
    [authenticate](/docs/v5.0/reference/audit-message/#std-label-audit-message-authenticate),
    [createCollection](/docs/v5.0/reference/audit-message/#std-label-audit-message-createCollection),
    [createIndex](/docs/v5.0/reference/audit-message/#std-label-audit-message-createIndex), and
    [dropCollection.](/docs/v5.0/reference/audit-message/#std-label-audit-message-dropCollection)
* DDL operations auditing on [secondaries](/docs/v5.0/reference/glossary/#std-term-secondary) has
  changes. See [Audit Events and Filter.](/docs/v5.0/core/auditing/#std-label-auditing-audit-events-and-filter)

## Capped Collections

### Capped Collection Deletes Are Replicated to Secondaries

Starting in MongoDB 5.0, the [implicit delete operations](/docs/v5.0/core/capped-collections/#std-label-capped_collections_remove_documents) for [replica set](/docs/v5.0/replication/#std-label-replication) [capped collections](/docs/v5.0/reference/glossary/#std-term-capped-collection) are
processed by the primary and replicated to the [secondary members.](/docs/v5.0/core/replica-set-secondary/#std-label-replica-set-secondary-members-ref)

### Explicit Deletes Allowed on Capped Collections

Starting in MongoDB 5.0.7, you can delete documents from [capped
collections](/docs/v5.0/core/capped-collections/#std-label-manual-capped-collection) using [delete methods.](/docs/v5.0/reference/delete-methods/#std-label-delete-additional-methods)

## Change Streams

### Change Events Output

Starting in MongoDB 5.0, [Change Events](/docs/v5.0/reference/change-events/#std-label-change-events)
contain the field `updateDescription.truncatedArrays` to record array
truncations.

## Indexes

### Partial Indexes Behavior Change

Starting in MongoDB 5.0, multiple
[partial indexes](/docs/v5.0/core/index-partial/)
can be created using the same [key pattern](/docs/v5.0/reference/method/db.collection.createIndexes/#std-label-key_patterns) as long
as the [partialFilterExpression](/docs/v5.0/reference/method/db.collection.createIndexes/#std-label-partialFilterExpression)
fields do not express equivalent filters.

In earlier versions of MongoDB, creating multiple
[partial indexes](/docs/v5.0/core/index-partial/) is not allowed when
using the same key pattern with different
[partialFilterExpressions.](/docs/v5.0/reference/method/db.collection.createIndexes/#std-label-partialFilterExpression)

### Unique Sparse Index Behavior Change

Starting in MongoDB 5.0, [unique sparse](/docs/v5.0/core/index-sparse/#std-label-sparse-unique-index)
and [unique non-sparse](/docs/v5.0/indexes/#std-label-unique-index) indexes with the same
[key pattern](/docs/v5.0/reference/method/db.collection.createIndexes/#std-label-key_patterns) can exist on a single collection.

See [unique sparse index creation](/docs/v5.0/core/index-sparse/#std-label-sparse-and-non-sparse_example)

### Cannot Drop `Ready` Indexes During In-Progress Index Builds

The [`db.collection.dropIndexes()`](/docs/v5.0/reference/method/db.collection.dropIndexes/#mongodb-method-db.collection.dropIndexes) command cannot drop
[ready indexes](/docs/v5.0/core/index-creation/#std-label-index-build-process-ready)
if there are any in-progress index builds.

* In versions 4.4.0-4.4.4 of MongoDB, this logic was not true
  due to a bug.
### Foreground Validation May Fix Multikey Metadata Inconsistencies

When run on a MongoDB deployment,
[`db.collection.validate()`](/docs/v5.0/reference/method/db.collection.validate/#mongodb-method-db.collection.validate) attempts to fix
[multikey metadata inconsistencies](/docs/v5.0/reference/method/db.collection.validate/#std-label-validate-standalone-inconsistencies)
of standalone deployments.

### Removal of `geoHaystack` Index and the `geoSearch` Command

MongoDB 5.0 removes the deprecated [geoHaystack](/docs/v5.0/core/geohaystack/) index and [`geoSearch`](/docs/v5.0/reference/command/geoSearch/#mongodb-dbcommand-dbcmd.geoSearch) command. Use a
[2d index](/docs/v5.0/core/2d/) with [`$geoNear`](/docs/v5.0/reference/operator/aggregation/geoNear/#mongodb-pipeline-pipe.-geoNear) or one of the
supported [geospatial query operators](/docs/v5.0/reference/operator/query-geospatial/#std-label-geospatial-query-selectors)
instead.

Upgrading your MongoDB instance to 5.0 and setting
[featureCompatibilityVersion](/docs/v5.0/reference/command/setFeatureCompatibilityVersion/#std-label-view-fcv) to `5.0` will delete any
pre-existing [geoHaystack](/docs/v5.0/core/geohaystack/) indexes.

### New Error Messages

The [`db.collection.createIndex()`](/docs/v5.0/reference/method/db.collection.createIndex/#mongodb-method-db.collection.createIndex) and [`db.collection.createIndexes()`](/docs/v5.0/reference/method/db.collection.createIndexes/#mongodb-method-db.collection.createIndexes)
operations have new error messages when options are specified incorrectly.

### Interrupted Index Builds

If a node in a replica set is cleanly shutdown or rolls back during an
index build, the index build progress is now
[saved to disk](/docs/v5.0/core/index-creation/#std-label-index-operations-build-failure). When the server
restarts, index creation resumes from the saved position.

### `reIndex` Behavior Change

Starting in MongoDB 5.0, the [`reIndex`](/docs/v5.0/reference/command/reIndex/#mongodb-dbcommand-dbcmd.reIndex) command and the
[`db.collection.reIndex()`](/docs/v5.0/reference/method/db.collection.reIndex/#mongodb-method-db.collection.reIndex) shell method may only be run on
[standalone](/docs/v5.0/reference/glossary/#std-term-standalone) instances.

## Removed Commands

Starting in MongoDB 5.0, these database commands and
[`mongo`](/docs/v5.0/reference/program/mongo/#mongodb-binary-bin.mongo) shell helper methods are removed:

| Removed Command | Alternative |
| --- | --- |
| [`db.collection.ensureIndex()`](/docs/v5.0/reference/method/db.collection.ensureIndex/#mongodb-method-db.collection.ensureIndex) | [`db.collection.createIndex()`](/docs/v5.0/reference/method/db.collection.createIndex/#mongodb-method-db.collection.createIndex) |
| [`db.resetError()`](/docs/v5.0/reference/method/db.resetError/#mongodb-method-db.resetError) | Not available |
| [`resetError`](/docs/v5.0/reference/command/resetError/#mongodb-dbcommand-dbcmd.resetError) | Not available |
| [`shardConnPoolStats`](/docs/v5.0/reference/command/shardConnPoolStats/#mongodb-dbcommand-dbcmd.shardConnPoolStats) | [`connPoolStats`](/docs/v5.0/reference/command/connPoolStats/#mongodb-dbcommand-dbcmd.connPoolStats) |
| [`unsetSharding`](/docs/v5.0/reference/command/unsetSharding/#mongodb-dbcommand-dbcmd.unsetSharding) | Not available |
| [`geoSearch`](/docs/v5.0/reference/command/geoSearch/#mongodb-dbcommand-dbcmd.geoSearch) | [`$geoNear`](/docs/v5.0/reference/operator/aggregation/geoNear/#mongodb-pipeline-pipe.-geoNear) or one of the supported [geospatial query operators](/docs/v5.0/reference/operator/query-geospatial/#std-label-geospatial-query-selectors) |

## Replica Sets

### Non-transactional Reads on `config.transactions`

Starting in MongoDB 5.0, non-transaction reads are not allowed on
the [`config.transactions`](/docs/v5.0/reference/config-database/#mongodb-data-config.transactions) collection with the following
read concerns and options:

* [`"snapshot"`](/docs/v5.0/reference/read-concern-snapshot/#mongodb-readconcern-readconcern.-snapshot-)
* [`"majority"`](/docs/v5.0/reference/read-concern-majority/#mongodb-readconcern-readconcern.-majority-) and the
  [afterClusterTime](/docs/v5.0/reference/read-concern/#std-label-afterClusterTime) option is set
* When using a [MongoDB Driver](https://www.mongodb.com/docs/drivers/)
  and [`"majority"`](/docs/v5.0/reference/read-concern-majority/#mongodb-readconcern-readconcern.-majority-)
  within a [causally consistent session](/docs/v5.0/core/read-isolation-consistency-recency/#std-label-sessions)
### `hello` Command

Starting in MongoDB 5.0, the
[`hello`](/docs/v5.0/reference/command/hello/#mongodb-dbcommand-dbcmd.hello) command and the [`db.hello()`](/docs/v5.0/reference/method/db.hello/#mongodb-method-db.hello) method were
introduced as replacements for the `isMaster` command
and the `db.isMaster()` method. The new topology metric
[`connections.exhaustHello`](/docs/v5.0/reference/command/serverStatus/#mongodb-serverstatus-serverstatus.connections.exhaustHello) tracks this in
[`connections`.](/docs/v5.0/reference/command/serverStatus/#mongodb-serverstatus-serverstatus.connections)

### Quiesce Period

Starting in MongoDB 5.0, [`mongod`](/docs/v5.0/reference/program/mongod/#mongodb-binary-bin.mongod) and [`mongos`](/docs/v5.0/reference/program/mongos/#mongodb-binary-bin.mongos)
enter a [quiesce period](/docs/v5.0/reference/command/shutdown/#std-label-shutdown-cmd-quiesce-period) to allow any
ongoing database operations to complete before shutting down.

### Limit Removed for `members[n]._id` Values

Starting in MongoDB 5.0, the [`members[n]._id`](/docs/v5.0/reference/replica-configuration/#mongodb-rsconf-rsconf.members-n-._id) field may be any
integer value greater than or equal to `0`. Previously, this value was
limited to an integer between `0` and `255` inclusive.

### `enableMajorityReadConcern` Is Not Configurable

Starting in MongoDB 5.0,
[`enableMajorityReadConcern`](/docs/v5.0/reference/configuration-options/#mongodb-setting-replication.enableMajorityReadConcern) and
[`--enableMajorityReadConcern`](/docs/v5.0/reference/program/mongod/#std-option-mongod.--enableMajorityReadConcern) cannot be changed
and are always set to `true` due to storage engine improvements.

In earlier versions of MongoDB,
[`enableMajorityReadConcern`](/docs/v5.0/reference/configuration-options/#mongodb-setting-replication.enableMajorityReadConcern) and
[`--enableMajorityReadConcern`](/docs/v5.0/reference/program/mongod/#std-option-mongod.--enableMajorityReadConcern) are configurable and can be set
to `false` to prevent storage cache pressure from immobilizing a
deployment with a three-member primary-secondary-arbiter (PSA)
architecture.

If you are using a three-member primary-secondary-arbiter (PSA)
architecture, consider the following:

* The write concern [`"majority"`](/docs/v5.0/reference/write-concern/#mongodb-writeconcern-writeconcern.-majority-) can cause
  performance issues if a secondary is unavailable or lagging. For
  advice on how to mitigate these issues, see
  [Mitigate Performance Issues with a Self-Managed PSA Replica Set.](/docs/v5.0/tutorial/mitigate-psa-performance-issues/#std-label-performance-issues-psa)
* If you are using a global default [`"majority"`](/docs/v5.0/reference/read-concern-majority/#mongodb-readconcern-readconcern.-majority-)
  and the write concern is less than the size of the majority,
  your queries may return stale (not fully replicated) data.
### Enhanced Thread Pool Timeout Control

Starting in MongoDB 5.0, you can use the new
[`replWriterMinThreadCount`](/docs/v5.0/reference/parameters/#mongodb-parameter-param.replWriterMinThreadCount) server parameter to
allow idle threads above this minimum to be closed.
When [`replWriterMinThreadCount`](/docs/v5.0/reference/parameters/#mongodb-parameter-param.replWriterMinThreadCount) is
configured with a value less than [`replWriterThreadCount`](/docs/v5.0/reference/parameters/#mongodb-parameter-param.replWriterThreadCount),
idle threads above [`replWriterMinThreadCount`](/docs/v5.0/reference/parameters/#mongodb-parameter-param.replWriterMinThreadCount) are timed out.

### Reconfiguring PSA Replica Sets

When reconfiguring primary-secondary-arbiter (PSA) replica sets or
changing to a PSA architecture, it is now in some cases required to
perform the reconfiguration in a two-step change. MongoDB 5.0 introduces
the [`rs.reconfigForPSASet()`](/docs/v5.0/reference/method/rs.reconfigForPSASet/#mongodb-method-rs.reconfigForPSASet) method which performs both steps.
If you cannot use the helper method, follow the procedure in
[Modify a Self-Managed PSA Replica Set Safely.](/docs/v5.0/tutorial/modify-psa-replica-set-safely/#std-label-modify-psa-replica-set-safely)

### Limit Sync Source Re-evaluations

[`maxNumSyncSourceChangesPerHour`](/docs/v5.0/reference/parameters/#mongodb-parameter-param.maxNumSyncSourceChangesPerHour) determines how many sync
source changes can happen per hour before the node temporarily stops
re-evaluating a sync source. This parameter will not prevent a node
from starting to sync from another node if it doesn't have a sync
source.

### `enableOverrideClusterChainingSetting` Server Parameter

Starting in MongoDB 5.0.2, you can set the new
[`enableOverrideClusterChainingSetting`](/docs/v5.0/reference/parameters/#mongodb-parameter-param.enableOverrideClusterChainingSetting) server parameter to
`true` to allow [secondary](/docs/v5.0/reference/glossary/#std-term-secondary) members to replicate data from other
secondary members even if [`settings.chainingAllowed`](/docs/v5.0/reference/replica-configuration/#mongodb-rsconf-rsconf.settings.chainingAllowed) is
`false`.

### storeFindAndModifyImagesInSideCollection Parameter

Starting in MongoDB 5.0, the
[`storeFindAndModifyImagesInSideCollection`](/docs/v5.0/reference/parameters/#mongodb-parameter-param.storeFindAndModifyImagesInSideCollection) parameter
determines whether the temporary documents required for [retryable](/docs/v5.0/core/retryable-writes/#std-label-retryable-writes) [`findAndModify`](/docs/v5.0/reference/command/findAndModify/#mongodb-dbcommand-dbcmd.findAndModify) commands are stored in
the *side* collection (`config.image_collection`).

## Security

### Support for Online Certificate Rotation

Starting in MongoDB 5.0, you may now rotate the following TLS
certificates on demand without first needing to stop your running
[`mongod`](/docs/v5.0/reference/program/mongod/#mongodb-binary-bin.mongod) or [`mongos`](/docs/v5.0/reference/program/mongos/#mongodb-binary-bin.mongos) instance:

* [`TLS Certificates`](/docs/v5.0/reference/configuration-options/#mongodb-setting-net.tls.certificateKeyFile)
* [`CRL (Certificate Revocation List) files`](/docs/v5.0/reference/configuration-options/#mongodb-setting-net.tls.CRLFile)
  (on Linux and Windows platforms)
* [`CA (Certificate Authority) files`](/docs/v5.0/reference/configuration-options/#mongodb-setting-net.tls.CAFile)

To rotate these certificates, replace the certificate files on your
filesystem with updated versions, then use the
[`rotateCertificates`](/docs/v5.0/reference/command/rotateCertificates/#mongodb-dbcommand-dbcmd.rotateCertificates) command or the
[`db.rotateCertificates()`](/docs/v5.0/reference/method/db.rotateCertificates/#mongodb-method-db.rotateCertificates) shell method to trigger certificate
rotation.

Rotating certificates in this manner does not require downtime, and does
not drop any active remote connections.

See [Online Certificate Rotation](/docs/v5.0/tutorial/configure-ssl/#std-label-certificate-rotation) for full details.

### Support for Configuring TLS 1.3 Cipher Suites

MongoDB 5.0 introduces the [`opensslCipherSuiteConfig`](/docs/v5.0/reference/parameters/#mongodb-parameter-param.opensslCipherSuiteConfig)
parameter to enable configuration of the supported cipher suites OpenSSL
should permit when using TLS 1.3 encryption.

### TLS Connection X509 Certificate Startup Warning

Starting in MongoDB 5.0, [`mongod`](/docs/v5.0/reference/program/mongod/#mongodb-binary-bin.mongod) and [`mongos`](/docs/v5.0/reference/program/mongos/#mongodb-binary-bin.mongos) now
issue a startup warning when their certificates do not include a
[Subject Alternative Name](/docs/v5.0/reference/glossary/#std-term-Subject-Alternative-Name) attribute.

The following platforms do not support common name validation:

* iOS 13 and higher
* MacOS 10.15 and higher
* Go 1.15 and higher

Clients using these platforms will not
[authenticate](/docs/v5.0/tutorial/configure-x509-client-authentication/#std-label-x509-client-authentication) to
MongoDB servers which use X.509 certificate whose hostnames are
[specified by CommonName attributes.](/docs/v5.0/reference/program/mongod/#std-label-KMIP-subject-alternative-name-CN)

### ApplyOps Privilege Action

MongoDB 5.0 introduces the [`applyOps`](/docs/v5.0/reference/privilege-actions/#mongodb-authaction-applyOps)
privilege action which is inherited by [`dbAdminAnyDatabase`.](/docs/v5.0/reference/built-in-roles/#mongodb-authrole-dbAdminAnyDatabase)

The [`applyOps`](/docs/v5.0/reference/privilege-actions/#mongodb-authaction-applyOps) action permits users to run the
[`applyOps`](/docs/v5.0/reference/command/applyOps/#mongodb-dbcommand-dbcmd.applyOps) database command.

## Sharded Clusters

### Resharding

The ideal shard key allows MongoDB to distribute documents evenly
throughout the cluster while facilitating common query patterns. A
suboptimal shard key can lead to performance or scaling issues due to
uneven data distribution. Starting in MongoDB 5.0, you can use the
[`reshardCollection`](/docs/v5.0/reference/command/reshardCollection/#mongodb-dbcommand-dbcmd.reshardCollection) command to [change the shard key](/docs/v5.0/core/sharding-change-a-shard-key/#std-label-change-a-shard-key) for a collection to change the distribution of
your data across your cluster.

### `currentOp` Reports Ongoing Resharding Operations

Starting in MongoDB 5.0, the [`$currentOp`](/docs/v5.0/reference/operator/aggregation/currentOp/#mongodb-pipeline-pipe.-currentOp) aggregation stage
(and the [`currentOp`](/docs/v5.0/reference/command/currentOp/#mongodb-dbcommand-dbcmd.currentOp) command and [`db.currentOp()`](/docs/v5.0/reference/method/db.currentOp/#mongodb-method-db.currentOp)
shell method) include additional information about the status of ongoing
resharding operations for the resharding coordinator and the
donor and recipient shards.

### `db.currentOp` Method Now Uses Aggregation Stage in `mongosh`

Starting in MongoDB 5.0, the [`$currentOp`](/docs/v5.0/reference/operator/aggregation/currentOp/#mongodb-pipeline-pipe.-currentOp) aggregation
stage is used when running the helper method [`db.currentOp()`](/docs/v5.0/reference/method/db.currentOp/#mongodb-method-db.currentOp)
with [`mongosh`.](https://www.mongodb.com/docs/mongodb-shell/#mongodb-binary-bin.mongosh)

### `mongos` / `mongod` Connection Pool

Starting in MongoDB 5.0,
MongoDB adds the parameter option `"automatic"` as the new default for
the [`ShardingTaskExecutorPoolReplicaSetMatching`](/docs/v5.0/reference/parameters/#mongodb-parameter-param.ShardingTaskExecutorPoolReplicaSetMatching). When set
for a [`mongos`](/docs/v5.0/reference/program/mongos/#mongodb-binary-bin.mongos), the instance follows the behavior specified
for the `"matchPrimaryNode"` option. When set for a
[`mongod`](/docs/v5.0/reference/program/mongod/#mongodb-binary-bin.mongod), the instance follows the behavior specified for
the `"disabled"` option.

### `renameCollection` Compatible with Sharded Collections

Starting in MongoDB 5.0, you can use the [`renameCollection`](/docs/v5.0/reference/command/renameCollection/#mongodb-dbcommand-dbcmd.renameCollection)
command to change the name of a sharded collection.

When renaming a sharded or unsharded collection in a sharded cluster,
the source and target collections are exclusively locked on every shard.
Subsequent operations on the source and target collections must wait
until the rename operation completes.

### `movePrimary` Error Message For Writes During Operation

Starting in MongoDB 5.0, when using the [`movePrimary`](/docs/v5.0/reference/command/movePrimary/#mongodb-dbcommand-dbcmd.movePrimary) command
to remove a shard from a [sharded cluster](/docs/v5.0/sharding/#std-label-sharded-cluster),
writes to the original shard will generate an error message.

### Split and Merge Chunk Changelogs Show Owning Shard

Starting in MongoDB 5.0, documents in the [`config.changelog`](/docs/v5.0/reference/config-database/#mongodb-data-config.changelog)
collection for
[split](https://www.mongodb.com/docs/manual/tutorial/split-chunks-in-sharded-cluster/) and
[merge](https://www.mongodb.com/docs/manual/tutorial/merge-chunks-in-sharded-cluster/) operations
contain an `owningShard` field. The `owningShard` field shows the
`shardId` of the shard that owns the chunks that were split or
merged.

The `owningShard` field helps identify shards where split or merge
operations frequently occur.

### `maxCatchUpPercentageBeforeBlockingWrites` Server Parameter

Starting in MongoDB 5.0, you can set the
[`maxCatchUpPercentageBeforeBlockingWrites`](/docs/v5.0/reference/parameters/#mongodb-parameter-param.maxCatchUpPercentageBeforeBlockingWrites) to specify the
maximum allowed percentage of data not yet migrated
during a [`moveChunk`](/docs/v5.0/reference/command/moveChunk/#mongodb-dbcommand-dbcmd.moveChunk) operation when compared to the
total size (in MBs) of the chunk being transferred.

This parameter can affect the behavior of:

* [`moveChunk`](/docs/v5.0/reference/command/moveChunk/#mongodb-dbcommand-dbcmd.moveChunk) commands that are run manually.
* Load balancer functionality, which automatically runs multiple
  [`moveChunk`](/docs/v5.0/reference/command/moveChunk/#mongodb-dbcommand-dbcmd.moveChunk) commands to evenly distribute chunks across
  shards. See [Sharded Cluster Balancer.](/docs/v5.0/core/sharding-balancer-administration/#std-label-sharding-balancing)

## Shell Changes

### New MongoDB Shell: `mongosh`

The `mongo` shell has been deprecated in MongoDB v5.0. The
replacement shell is [`mongosh`](https://www.mongodb.com/docs/mongodb-shell/#mongodb-binary-bin.mongosh). The legacy `mongo` shell
will be removed in a future release.

Shell packaging also changes in MongoDB v5.0. Refer to the
[installation instructions](https://www.mongodb.com/docs/mongodb-shell/install/) for further details.

### Shell Support for GCP and Azure KMS Providers

Starting in MongoDB 5.0, the Google Cloud Platform KMS and Azure Key Vault
are supported in both [`mongosh`](https://www.mongodb.com/docs/mongodb-shell/#mongodb-binary-bin.mongosh) and the legacy `mongo` shell as
[Key Management Service (KMS)](/docs/v5.0/core/security-client-side-encryption-key-management/#std-label-field-level-encryption-kms)
providers for [Client-Side Field Level Encryption.](/docs/v5.0/core/security-client-side-encryption/)

Using a KMS, you can centrally and securely store Customer Master Keys
(CMKs), which are used to encrypt and decrypt data encryption keys as
part of the [client-side field level encryption workflow.](/docs/v5.0/core/security-client-side-encryption/#std-label-csfle-encryption-components)

In addition, a configured KMS allows for the use of
[Automatic Field Decryption](/docs/v5.0/core/security-client-side-encryption/#std-label-field-level-encryption-automatic-decryption) of data fields when
used with MongoDB Enterprise.

Instructions are available for both shells:

* [Configure a KMS provider using mongosh](https://www.mongodb.com/docs/mongodb-shell/field-level-encryption/)
* [Configure a KMS provider using the legacy mongo shell](/docs/v5.0/core/security-client-side-encryption-key-management/)

## Snapshots

### Extended Support for Read Concern `"snapshot"`

Starting in MongoDB 5.0, read concern [`"snapshot"`](/docs/v5.0/reference/read-concern-snapshot/#mongodb-readconcern-readconcern.-snapshot-) is
supported for some read operations outside of multi-document
transactions on primaries and secondaries. See
[Perform Long-Running Snapshot Queries.](/docs/v5.0/tutorial/long-running-queries/#std-label-tutorial-long-running-queries)

### `minSnapshotHistoryWindowInSeconds` Server Parameter

Starting in MongoDB 5.0, you can use the
[`minSnapshotHistoryWindowInSeconds`](/docs/v5.0/reference/parameters/#mongodb-parameter-param.minSnapshotHistoryWindowInSeconds) parameter to control how
long WiredTiger keeps the snapshot history.

## Transactions

### `coordinateCommitReturnImmediatelyAfterPersistingDecision` Parameter

The server parameter
[`coordinateCommitReturnImmediatelyAfterPersistingDecision`](/docs/v5.0/reference/parameters/#mongodb-parameter-param.coordinateCommitReturnImmediatelyAfterPersistingDecision)
controls when transaction commit decisions are returned to the client.

The parameter was introduced in MongDB 5.0 with a default value of
`true`. In MongoDB 5.0.10 the default value changes to `false`.

When `coordinateCommitReturnImmediatelyAfterPersistingDecision` is
`false`, the [shard](/docs/v5.0/core/sharded-cluster-shards/#std-label-shards-concepts) transaction coordinator
waits for all members to acknowledge a [multi-document transaction](/docs/v5.0/core/transactions/#std-label-transactions-atomicity) commit before returning the commit decision to
the client.

## Naming Changes

Starting in February 2022, the "Versioned API" terminology was
changed to "Stable API". All concepts and features remain the same
with this naming change.

## General Changes

### `serverStatus` Output Change

Starting in MongoDB 5.0.7, [`serverStatus`](/docs/v5.0/reference/command/serverStatus/#mongodb-dbcommand-dbcmd.serverStatus) includes
[`connections.loadBalanced`](/docs/v5.0/reference/command/serverStatus/#mongodb-serverstatus-serverstatus.connections.loadBalanced) which reports the
number of incoming connections received through a load balancer.

### Execution Plan Statistics for Query with `$lookup` Pipeline Stage

MongoDB 5.0 adds [execution plan statistics](/docs/v5.0/reference/explain-results/#std-label-explain-results-lookup) for queries that use a [`$lookup`](/docs/v5.0/reference/operator/aggregation/lookup/#mongodb-pipeline-pipe.-lookup)
pipeline stage.

### Improved Handling of (`$`) and (`.`) in Field Names

MongoDB 5.0 adds [improved support](/docs/v5.0/core/dot-dollar-considerations/#std-label-crud-concepts-dot-dollar-considerations) for field names that are
(`$`) prefixed or that contain (`.`) characters. The validation
rules for storing data have been updated to make it easier to work with
data sources that use these characters.

### Cluster Wide Default Write Concern

Starting in MongoDB 5.0, once the Cluster Wide Write Concern (CWWC)
is set via the [`setDefaultRWConcern`](/docs/v5.0/reference/command/setDefaultRWConcern/#mongodb-dbcommand-dbcmd.setDefaultRWConcern) command the write
concern cannot be unset.

### Implicit Default Write Concern

Starting in MongoDB 5.0, the implicit default
[write concern](/docs/v5.0/reference/write-concern/#std-label-write-concern) is
[`w: majority`](/docs/v5.0/reference/write-concern/#mongodb-writeconcern-writeconcern.-majority-). However, special
considerations are made for deployments containing
[arbiters:](/docs/v5.0/core/replica-set-arbiter/#std-label-replica-set-arbiter-configuration)

* The voting majority of a replica set is 1 plus half the number of
  voting members, rounded down. If the number of data-bearing voting
  members is not greater than the voting majority, the default write
  concern is `{ w: 1 }`.
* In all other scenarios, the default write concern is `{ w:
  "majority" }`.
* For a [sharded cluster](/docs/v5.0/sharding/#std-label-sharding-sharded-cluster), the default
  write concern is always retrieved from the [config server](/docs/v5.0/core/sharded-cluster-config-servers/#std-label-sharding-config-server). Since the config server must have zero
  arbiters, the implicit default write concern for a sharded cluster
  is always `"majority"`. Even if a shard is in a
  Primary-Secondary-Arbiter topology, it still has a default write
  concern of `"majority"`.
  Starting in MongoDB 5.1, this configuration is disallowed if the
  cluster-wide write concern is not set.

Specifically, MongoDB uses the following formula to determine the
default write concern:

```

| if [ (#arbiters > 0) AND (#non-arbiters <= majority(#voting-nodes)) ] |
| --- |
| defaultWriteConcern = { w: 1 } |
| else |
| defaultWriteConcern = { w: "majority" } |

```

For example, consider the following deployments and their respective
default write concerns:

| Non-Arbiters | Arbiters | Voting Nodes | Majority of Voting Nodes | Implicit Default Write Concern |
| --- | --- | --- | --- | --- |
| 2 | 1 | 3 | 2 | `{ w: 1 }` |
| 4 | 1 | 5 | 3 | `{ w: "majority" }` |

* In the first example:

  + There are 2 non-arbiters and 1 arbiter for a total of 3 voting
    nodes.
  + The majority of voting nodes (1 plus half of 3, rounded
    down) is 2.
  + The number of non-arbiters (2) is equal to
    the majority of voting nodes (2), resulting in an implicit write
    concern of `{ w: 1 }`.
* In the second example:

  + There are 4 non-arbiters and 1 arbiter for a total of 5
    voting nodes.
  + The majority of voting nodes (1 plus half of 5, rounded
    down) is 3.
  + The number of non-arbiters (4) is greater than the majority
    of voting nodes (3), resulting in an implicit write concern of
    `{ w: "majority" }`.

The [`{ w: "majority" }`](/docs/v5.0/reference/write-concern/#mongodb-writeconcern-writeconcern.-majority-) default
[write concern](/docs/v5.0/reference/write-concern/) provides a stronger
durability guarantee in the event of an election, or if replica set
members become unavailable.

### `mongosShutdownTimeoutMillisForSignaledShutdown` Parameter

Starting in MongoDB 5.0, the new parameter
[`mongosShutdownTimeoutMillisForSignaledShutdown`](/docs/v5.0/reference/parameters/#mongodb-parameter-param.mongosShutdownTimeoutMillisForSignaledShutdown) specifies
the time in milliseconds to wait for any ongoing database operations to
complete before initiating a shutdown of [`mongos`.](/docs/v5.0/reference/program/mongos/#mongodb-binary-bin.mongos)

### Configurable `zstd` Compression Level

MongoDB 5.0 introduces the
[`zstdCompressionLevel`](/docs/v5.0/reference/configuration-options/#mongodb-setting-storage.wiredTiger.engineConfig.zstdCompressionLevel)
configuration file option which allows for configurable compression
levels when
[`blockCompressor`](/docs/v5.0/reference/configuration-options/#mongodb-setting-storage.wiredTiger.collectionConfig.blockCompressor) is set
to `zstd`.

### Lock-Free Read Operations

Starting in MongoDB 5.0, the following read operations are not blocked
when another operation holds an exclusive (X) write lock on the
collection:

* [`find`](/docs/v5.0/reference/command/find/#mongodb-dbcommand-dbcmd.find)
* [`count`](/docs/v5.0/reference/command/count/#mongodb-dbcommand-dbcmd.count)
* [`distinct`](/docs/v5.0/reference/command/distinct/#mongodb-dbcommand-dbcmd.distinct)
* [`aggregate`](/docs/v5.0/reference/command/aggregate/#mongodb-dbcommand-dbcmd.aggregate)
* [`mapReduce`](/docs/v5.0/reference/command/mapReduce/#mongodb-dbcommand-dbcmd.mapReduce)
* [`listCollections`](/docs/v5.0/reference/command/listCollections/#mongodb-dbcommand-dbcmd.listCollections)
* [`listIndexes`](/docs/v5.0/reference/command/listIndexes/#mongodb-dbcommand-dbcmd.listIndexes)

When writing to a collection, [`mapReduce`](/docs/v5.0/reference/command/mapReduce/#mongodb-dbcommand-dbcmd.mapReduce) and
[`aggregate`](/docs/v5.0/reference/command/aggregate/#mongodb-dbcommand-dbcmd.aggregate) hold an intent exclusive (IX) lock. Therefore, if
an exclusive X lock is already held on a collection,
[`mapReduce`](/docs/v5.0/reference/command/mapReduce/#mongodb-dbcommand-dbcmd.mapReduce) and [`aggregate`](/docs/v5.0/reference/command/aggregate/#mongodb-dbcommand-dbcmd.aggregate) write operations are
blocked.

### Schema Validation Failures Explained

MongoDB 5.0 adds detailed explanations when a document fails
[schema validation.](/docs/v5.0/core/schema-validation/#std-label-schema-validation-overview)

### Repair Option in `validate` Command

Starting in MongoDB 5.0, the [`validate`](/docs/v5.0/reference/command/validate/#mongodb-dbcommand-dbcmd.validate) command and
[`db.collection.validate()`](/docs/v5.0/reference/method/db.collection.validate/#mongodb-method-db.collection.validate) helper method have a new [repair](/docs/v5.0/reference/command/validate/#std-label-cmd-validate-repair) option for repairing a collection that has
inconsistencies.

The [`validate`](/docs/v5.0/reference/command/validate/#mongodb-dbcommand-dbcmd.validate) command and [`db.collection.validate()`](/docs/v5.0/reference/method/db.collection.validate/#mongodb-method-db.collection.validate)
helper method also return a new [`repaired`](/docs/v5.0/reference/command/validate/#mongodb-data-validate.repaired) boolean value
that is `true` if the collection was repaired.

### `validate` Command Reports Document Schema Violations

Starting in MongoDB 5.0, [`validate`](/docs/v5.0/reference/command/validate/#mongodb-dbcommand-dbcmd.validate) and
[`db.collection.validate()`](/docs/v5.0/reference/method/db.collection.validate/#mongodb-method-db.collection.validate) validates documents
in a collection. The commands report if any
[schema validation rules](/docs/v5.0/core/schema-validation/#std-label-schema-validation-document) are
violated.

### Repair Option in `mongod`

Starting in MongoDB 5.0, the [`--repair`](/docs/v5.0/reference/program/mongod/#std-option-mongod.--repair) option
for [`mongod`](/docs/v5.0/reference/program/mongod/#mongodb-binary-bin.mongod) validates the collections to find any
inconsistencies and fixes them if possible, which avoids rebuilding the
indexes. See the [`--repair`](/docs/v5.0/reference/program/mongod/#std-option-mongod.--repair) option for usage
and limitations.

### `corruptRecords` Field in Validation Output

Starting in MongoDB 5.0, the [`validate`](/docs/v5.0/reference/command/validate/#mongodb-dbcommand-dbcmd.validate) command and
[`db.collection.validate()`](/docs/v5.0/reference/method/db.collection.validate/#mongodb-method-db.collection.validate) helper method return a new
[`corruptRecords`](/docs/v5.0/reference/command/validate/#mongodb-data-validate.corruptRecords) field that contains an array of
`RecordId` values for corrupt documents.

### `maxValidateMemoryUsageMB` Server Parameter

Starting in MongoDB 5.0, the [`setParameter`](/docs/v5.0/reference/command/setParameter/#mongodb-dbcommand-dbcmd.setParameter)
command has a new [`maxValidateMemoryUsageMB`](/docs/v5.0/reference/parameters/#mongodb-parameter-param.maxValidateMemoryUsageMB) parameter, which
sets the maximum memory usage for the [`validate`](/docs/v5.0/reference/command/validate/#mongodb-dbcommand-dbcmd.validate) command.

### `findChunksOnConfigTimeoutMS` Server Parameter

Starting in MongoDB 5.0, you can use the
[`findChunksOnConfigTimeoutMS`](/docs/v5.0/reference/parameters/#mongodb-parameter-param.findChunksOnConfigTimeoutMS) parameter to change the timeout
for find operations on [`chunks`.](/docs/v5.0/reference/config-database/#mongodb-data-config.chunks)

### Database Profiler `filter` Option

Starting in MongoDB 5.0, you can set a `filter` option for the
[database profiler](/docs/v5.0/tutorial/manage-the-database-profiler/#std-label-database-profiler) to determine which
operations are profiled and logged. You can use the `filter`
expression in place of the `slowms` and `sampleRate` profiler
options.

See:

* [Database Profiler](/docs/v5.0/tutorial/manage-the-database-profiler/#std-label-database-profiler)
* [`db.setProfilingLevel()`](/docs/v5.0/reference/method/db.setProfilingLevel/#mongodb-method-db.setProfilingLevel)
* [`profile`](/docs/v5.0/reference/command/profile/#mongodb-dbcommand-dbcmd.profile)
### Log Changes to Database Profiler Settings

Starting in MongoDB 5.0, changes made to the [database profiler](/docs/v5.0/tutorial/manage-the-database-profiler/#std-label-database-profiler) `level`, `slowms`, `sampleRate`, or
`filter` using the [`profile`](/docs/v5.0/reference/command/profile/#mongodb-dbcommand-dbcmd.profile) command or
[`db.setProfilingLevel()`](/docs/v5.0/reference/method/db.setProfilingLevel/#mongodb-method-db.setProfilingLevel) wrapper method are recorded in the
[`log file`.](/docs/v5.0/reference/program/mongod/#std-option-mongod.--logpath)

### Independent Log Rotation for Server and Audit Logs

Starting in MongoDB 5.0, when [auditing](/docs/v5.0/core/auditing/) is
enabled, you may now rotate the server and audit logs
independently using the [`logRotate`](/docs/v5.0/reference/command/logRotate/#mongodb-dbcommand-dbcmd.logRotate) command.
Previously, [`logRotate`](/docs/v5.0/reference/command/logRotate/#mongodb-dbcommand-dbcmd.logRotate) would rotate the two logs together.

### `remote` Field in Slow Operation Logs

Starting in MongoDB 5.0, [slow operation](/docs/v5.0/tutorial/manage-the-database-profiler/#std-label-database-profiling-specify-slowms-threshold) log messages include a
`remote` field specifying client IP address.

### `remoteOpWaitMillis` Log Field

Starting in MongoDB 5.0, you can use the [remoteOpWaitMillis](/docs/v5.0/reference/log-messages/#std-label-log-messages-remoteOpWaitMillis) log field to obtain the wait time for
results from [shards.](/docs/v5.0/reference/glossary/#std-term-shard)

### `resolvedViews` Log Field for Slow Queries on Views

Starting in MongoDB 5.0, [log messages for slow queries](/docs/v5.0/reference/log-messages/#std-label-log-message-slow-ops) on [views](/docs/v5.0/reference/log-messages/#std-label-log-message-view-example)
include a `resolvedViews` field that contains the view details.

### Define Variables Using the `let` Option

Starting in MongoDB 5.0, the following commands have a `let` option to
define a list of variables. This allows you to improve command
readability by separating the variables from the query text.

* [`find`](/docs/v5.0/reference/command/find/#mongodb-dbcommand-dbcmd.find) command
* [`findAndModify`](/docs/v5.0/reference/command/findAndModify/#mongodb-dbcommand-dbcmd.findAndModify) command and corresponding
  [`db.collection.findAndModify()`](/docs/v5.0/reference/method/db.collection.findAndModify/#mongodb-method-db.collection.findAndModify) shell helper
* [`update`](/docs/v5.0/reference/command/update/#mongodb-dbcommand-dbcmd.update) command and corresponding
  [`db.collection.update()`](/docs/v5.0/reference/method/db.collection.update/#mongodb-method-db.collection.update) shell helper
* [`delete`](/docs/v5.0/reference/command/delete/#mongodb-dbcommand-dbcmd.delete) command
* [`db.collection.remove()`](/docs/v5.0/reference/method/db.collection.remove/#mongodb-method-db.collection.remove) shell helper

The [`update`](/docs/v5.0/reference/command/update/#mongodb-dbcommand-dbcmd.update) command also has a `c` field to define a list
of variables.

### Support for Username to LDAP DN Mapping by Default

Starting in MongoDB 5.0, the [`userToDNMapping`](/docs/v5.0/reference/configuration-options/#mongodb-setting-security.ldap.userToDNMapping)
configuration file option and the [`--ldapUserToDNMapping`](/docs/v5.0/reference/program/mongod/#std-option-mongod.--ldapUserToDNMapping) command line option for
[`mongod`](/docs/v5.0/reference/program/mongod/#mongodb-binary-bin.mongod) / [`mongos`](/docs/v5.0/reference/program/mongos/#mongodb-binary-bin.mongos) and [`mongoldap`](/docs/v5.0/reference/program/mongoldap/#std-program-mongoldap)
now map the authenticated username as the LDAP DN by default if an
empty mapping document (i.e. an empty string or empty array) is
specified to the option. Previously, providing an empty mapping document
would cause mapping to fail.

### Additional `dbStats` Free Space Statistics

Starting in MongoDB 5.0, the [`dbStats`](/docs/v5.0/reference/command/dbStats/#mongodb-dbcommand-dbcmd.dbStats) command outputs these
additional statistics:

* Free space allocated to collections ([`freeStorageSize`)](/docs/v5.0/reference/command/dbStats/#mongodb-data-dbStats.freeStorageSize)
* Free space allocated to indexes
  ([`indexFreeStorageSize`)](/docs/v5.0/reference/command/dbStats/#mongodb-data-dbStats.indexFreeStorageSize)
* Total free space allocated to collections and indexes
  ([`totalFreeStorageSize`)](/docs/v5.0/reference/command/dbStats/#mongodb-data-dbStats.totalFreeStorageSize)
### `serverStatus` Output Change

[`serverStatus`](/docs/v5.0/reference/command/serverStatus/#mongodb-dbcommand-dbcmd.serverStatus) includes the following new fields in its
output:

Aggregation Metrics

* [`metrics.commands.update.pipeline`](/docs/v5.0/reference/command/serverStatus/#mongodb-serverstatus-serverstatus.metrics.commands.update.pipeline)
* [`metrics.commands.update.arrayFilters`](/docs/v5.0/reference/command/serverStatus/#mongodb-serverstatus-serverstatus.metrics.commands.update.arrayFilters)
* [`metrics.commands.findAndModify.pipeline`](/docs/v5.0/reference/command/serverStatus/#mongodb-serverstatus-serverstatus.metrics.commands.findAndModify.pipeline)
* [`metrics.commands.findAndModify.arrayFilters`](/docs/v5.0/reference/command/serverStatus/#mongodb-serverstatus-serverstatus.metrics.commands.findAndModify.arrayFilters)
* [`metrics.dotsAndDollarsFields`](/docs/v5.0/reference/command/serverStatus/#mongodb-serverstatus-serverstatus.metrics.dotsAndDollarsFields)
* [`metrics.operatorCounters`](/docs/v5.0/reference/command/serverStatus/#mongodb-serverstatus-serverstatus.metrics.operatorCounters)
API Version Metrics

* [`metrics.apiVersions`](/docs/v5.0/reference/command/serverStatus/#mongodb-serverstatus-serverstatus.metrics.apiVersions)
Replication Metrics

* [`metrics.repl.reconfig.numAutoReconfigsForRemovalOfNewlyAddedFields`](/docs/v5.0/reference/command/serverStatus/#mongodb-serverstatus-serverstatus.metrics.repl.reconfig.numAutoReconfigsForRemovalOfNewlyAddedFields)
Read Concern Counters

* [`readConcernCounters`](/docs/v5.0/reference/command/serverStatus/#mongodb-serverstatus-serverstatus.readConcernCounters), which reports on the
  [read concern level](/docs/v5.0/reference/read-concern/#std-label-read-concern-levels) specified by query
  operations ([`readConcernCounters`](/docs/v5.0/reference/command/serverStatus/#mongodb-serverstatus-serverstatus.readConcernCounters) replaces
  [`opReadConcernCounters`)](/docs/v5.0/reference/command/serverStatus/#mongodb-serverstatus-serverstatus.opReadConcernCounters)
* [`readConcernCounters`](/docs/v5.0/reference/command/serverStatus/#mongodb-serverstatus-serverstatus.readConcernCounters) now has the following new
  fields:

  + `readConcernCounters.nonTransactionOps.noneInfo`
  + `readConcernCounters.transactionOps.noneInfo`
Write Concern Counters

* [`opWriteConcernCounters`](/docs/v5.0/reference/command/serverStatus/#mongodb-serverstatus-serverstatus.opWriteConcernCounters) now has the following new
  fields:

  + `opWriteConcernCounters.insert.noneInfo`
  + `opWriteConcernCounters.update.noneInfo`
  + `opWriteConcernCounters.delete.noneInfo`
Number of Threaded Connections

* [`connections.threaded`](/docs/v5.0/reference/command/serverStatus/#mongodb-serverstatus-serverstatus.connections.threaded), which reports the number of
  incoming connections from clients that are assigned to threads that
  service client requests
Resharding Statistics

* [`shardingStatistics.resharding`](/docs/v5.0/reference/command/serverStatus/#mongodb-serverstatus-serverstatus.shardingStatistics.resharding), which reports
  statistics about resharding operations
Service Executor Metrics

* [`network.serviceExecutors`](/docs/v5.0/reference/command/serverStatus/#mongodb-serverstatus-serverstatus.network.serviceExecutors), which reports on the
  service executors that run operations for client requests
Cursor Metrics

* [`metrics.cursor.moreThanOneBatch`](/docs/v5.0/reference/command/serverStatus/#mongodb-serverstatus-serverstatus.metrics.cursor.moreThanOneBatch), which reports the
  total number of cursors that have returned more than one batch
  (additional batches are retrieved using the [`getMore`](/docs/v5.0/reference/command/getMore/#mongodb-dbcommand-dbcmd.getMore)
  command)
* [`metrics.cursor.totalOpened`](/docs/v5.0/reference/command/serverStatus/#mongodb-serverstatus-serverstatus.metrics.cursor.totalOpened), which reports the total
  number of cursors that have been opened
Security Counter

* [`security.authentication.saslSupportedMechsReceived`](/docs/v5.0/reference/command/serverStatus/#mongodb-serverstatus-serverstatus.security.authentication.saslSupportedMechsReceived),
  which reports the number of times a [`hello`](/docs/v5.0/reference/command/hello/#mongodb-dbcommand-dbcmd.hello) request
  includes a valid [`hello.saslSupportedMechs`](/docs/v5.0/reference/command/hello/#mongodb-data-hello.saslSupportedMechs) field.
Repl

* [`repl`](/docs/v5.0/reference/command/serverStatus/#mongodb-serverstatus-serverstatus.repl) now includes a
  [`primaryOnlyServices`](/docs/v5.0/reference/command/serverStatus/#mongodb-serverstatus-serverstatus.repl.primaryOnlyServices) document that
  contains additional information about services that only run on
  replica set primaries.
Change Stream Metrics

* [`metrics.changeStreams`](/docs/v5.0/reference/command/serverStatus/#mongodb-serverstatus-serverstatus.metrics.changeStreams)
* [`metrics.changeStreams.largeEventsFailed`](/docs/v5.0/reference/command/serverStatus/#mongodb-serverstatus-serverstatus.metrics.changeStreams.largeEventsFailed)
### Plan Cache Debug Info Size Limit

Starting in MongoDB 5.0, the
[plan cache](/docs/v5.0/core/query-plans/) will save full `plan cache`
entries only if the cumulative size of the `plan caches` for all
collections is lower than 0.5 GB. When the cumulative size of the
`plan caches` for all collections exceeds this threshold, additional
`plan cache` entries are stored without certain debug information.

The estimated size in bytes of a `plan cache` entry is available in
the output of [`$planCacheStats`.](/docs/v5.0/reference/operator/aggregation/planCacheStats/#mongodb-pipeline-pipe.-planCacheStats)

### Closure of Inactive Cursors Opened Within a Session

Starting in MongoDB 5.0, cursors created within a
[client session](/docs/v5.0/core/read-isolation-consistency-recency/) close
when the corresponding [server session](/docs/v5.0/reference/server-sessions/)
ends with the [`killSessions`](/docs/v5.0/reference/command/killSessions/#mongodb-dbcommand-dbcmd.killSessions) command, if the session times
out, or if the client has exhausted the cursor.
See [Iterate a Cursor in `mongosh`.](/docs/v5.0/tutorial/iterate-a-cursor/#std-label-read-operations-cursors)

### New `validateDBMetadata` Command

MongoDB 5.0 adds the [`validateDBMetadata`](/docs/v5.0/reference/command/validateDBMetadata/#mongodb-dbcommand-dbcmd.validateDBMetadata) command. The
[`validateDBMetadata`](/docs/v5.0/reference/command/validateDBMetadata/#mongodb-dbcommand-dbcmd.validateDBMetadata) command checks that the stored metadata
of a database or a collection is valid within a particular API version.

## Performance Considerations

### Implicit Default Write Concern

MongoDB 5.0 changes the default [write concern](/docs/v5.0/reference/write-concern/#std-label-write-concern) to
[`{ w: "majority" }`](/docs/v5.0/reference/write-concern/#mongodb-writeconcern-writeconcern.-majority-). The new default write concern
might impact performance since MongoDB acknowledges writes only after a
[calculated majority](/docs/v5.0/reference/write-concern/#std-label-calculating-majority-count) of replica set
members have executed and persisted the write to disk.

If your application relies on performance-sensitive writes, you can
override the default write concern at the cost of data durability guarantees.
To override this setting, you can:

* Set the write concern at the individual operation level for
  performance-critical writes. For more information, see your
  [driver documentation.](https://www.mongodb.com/docs/drivers/)
* Use the [`setDefaultRWConcern`](/docs/v5.0/reference/command/setDefaultRWConcern/#mongodb-dbcommand-dbcmd.setDefaultRWConcern) command to explicitly set the default
  write concern.

## Warning

If write operations use [`{ w: 1 }`](/docs/v5.0/reference/write-concern/#mongodb-writeconcern-writeconcern.-number-) write concern,
the rollback directory may exclude writes submitted after an
[oplog hole](/docs/v5.0/reference/glossary/#std-term-oplog-hole) if the primary restarts before the write operation
completes.

### `local` Default Read Concern

Starting in MongoDB 5.0, [`"local"`](/docs/v5.0/reference/read-concern-local/#mongodb-readconcern-readconcern.-local-) is the default read
concern level for read operations against the primary and secondaries.

This may introduce a significant latency increase for count queries that
use a filter and for [covered queries.](/docs/v5.0/core/query-optimization/#std-label-covered-queries)

You can opt out of this behavior by setting the cluster-wide
[read concern](/docs/v5.0/reference/read-concern/#std-label-read-concern) with
[`setDefaultRWConcern`.](/docs/v5.0/reference/command/setDefaultRWConcern/#mongodb-dbcommand-dbcmd.setDefaultRWConcern)

### Snapshot History Retention

MongoDB 5.0 increases the default value of
[`minSnapshotHistoryWindowInSeconds`](/docs/v5.0/reference/parameters/#mongodb-parameter-param.minSnapshotHistoryWindowInSeconds) to `300`, which might
negatively impact performance. If you aren't using read concern
[`"snapshot"`](/docs/v5.0/reference/read-concern-snapshot/#mongodb-readconcern-readconcern.-snapshot-), you can reduce the value of the
`minSnapshotHistoryWindowInSeconds` parameter to `5` on all
[`mongod`](/docs/v5.0/reference/program/mongod/#mongodb-binary-bin.mongod) instances. For more information, see
[Snapshot History Retention.](/docs/v5.0/core/wiredtiger/#std-label-storage-snapshot-history)

## Note

If you are running a sharded cluster, do not change
`minSnapshotHistoryWindowInSeconds` on [config servers.](/docs/v5.0/core/sharded-cluster-config-servers/#std-label-sharding-config-server)

## Platform Support

### Minimum Microarchitecture

MongoDB 5.0 introduces the following minimum microarchitecture
requirements:

| CPU | Minimum Supported Microarchitecture |
| --- | --- |
| Intel `x86_64` | MongoDB 5.0 requires one of:   * Intel *Sandy Bridge* or later Core processor, or * Intel *Tiger Lake* or later Celeron or Pentium processor. |
| AMD `x86_64` | MongoDB 5.0 requires AMD *Bulldozer* or later. |
| ARM `arm64` | MongoDB 5.0 requires *ARMv8.2-A* or later. |

MongoDB v5.0 is not supported on `x86_64` or `arm64` platforms that
do not meet these minimum microarchitecture requirements.

See [x86\_64 Platform Support](/docs/v5.0/administration/production-notes/#std-label-prod-notes-supported-platforms-x86_64) for more information.

### Removed Platforms

MongoDB 5.0 removes support for the following platforms:

* **macOS 10.13**
* **RHEL 7 / CentOS 7 / Oracle 7** on the
  [PPC64LE](/docs/v5.0/administration/production-notes/#std-label-prod-notes-supported-platforms-PPC64LE) architecture
* **SLES 12** on the [s390x](/docs/v5.0/administration/production-notes/#std-label-prod-notes-supported-platforms-s390x)
  architecture
* **Ubuntu 18.04** on the
  [PPC64LE](/docs/v5.0/administration/production-notes/#std-label-prod-notes-supported-platforms-PPC64LE) and
  [s390x](/docs/v5.0/administration/production-notes/#std-label-prod-notes-supported-platforms-s390x) architectures
* Starting in MongoDB 5.0.6, Community Edition **RHEL -72-s390x**

See [Platform Support](/docs/v5.0/administration/production-notes/#std-label-prod-notes-supported-platforms) for the full list of platforms
and architectures supported in MongoDB 5.0.

## Changes Affecting Compatibility

Some changes can affect compatibility and may require user actions. For
a detailed list of compatibility changes, see
[Compatibility Changes in MongoDB 5.0.](/docs/v5.0/release-notes/5.0-compatibility/)

## Upgrade Procedures

## Important

### **Feature Compatibility Version**

To upgrade to MongoDB 5.0 from a 4.4 deployment, the 4.4 deployment
must have `featureCompatibilityVersion` set to `4.4`. To check
the version:

```

| db.adminCommand( { getParameter: 1, featureCompatibilityVersion: 1 } ) |
| --- |

```

To upgrade to MongoDB 5.0, refer to the upgrade instructions specific to
your MongoDB deployment:

* [Upgrade a Standalone to 5.0](/docs/v5.0/release-notes/5.0-upgrade-standalone/)
* [Upgrade a Replica Set to 5.0](/docs/v5.0/release-notes/5.0-upgrade-replica-set/)
* [Upgrade a Sharded Cluster to 5.0](/docs/v5.0/release-notes/5.0-upgrade-sharded-cluster/)

If you need guidance on upgrading to 5.0, [MongoDB professional services](https://www.mongodb.com/products/consulting?tck=docs_server) offer
major version upgrade support to help ensure a smooth transition
without interruption to your MongoDB application.

## Downgrade Consideration

MongoDB only supports single-version downgrades. You cannot downgrade to a
release that is multiple versions behind your current release.

For example, you may downgrade a 5.0-series to a 4.4-series deployment.
However, further downgrading that 4.4-series deployment to a 4.2-series
deployment is not supported.

## Download

To download MongoDB 5.0, go to the [MongoDB Download Center](https://www.mongodb.com/try/download?tck=docs_server).

## Tip

### **See also:**

* [All Third Party License Notices](https://github.com/mongodb/mongo/blob/v4.4/distsrc/THIRD-PARTY-NOTICES).
## Known Issues

| In Version | Issues | Status |
| --- | --- | --- |
| 5.0.0 | [SERVER-58171](https://jira.mongodb.org/browse/SERVER-58171): A Time Series collection's `granularity` parameter cannot be modified after the collection is created. | Fixed in 5.0.1 |
| 5.0.0 | [SERVER-58392](https://jira.mongodb.org/browse/SERVER-58392): An ongoing resharding operation may prevent a backup or restore operation from succeeding. | Unresolved |

## Report an Issue

To report an issue, see
<https://github.com/mongodb/mongo/wiki/Submit-Bug-Reports> for
instructions on how to file a JIRA ticket for the MongoDB server or one
of the related projects.

[Back

Release Notes](/docs/v5.0/release-notes/ "Previous Section")[Next

Compatibility Changes](/docs/v5.0/release-notes/5.0-compatibility/ "Next Section")

On this page

* [Patch Releases](#patch-releases)
* [Time Series Collections](#time-series-collections)
* [Aggregation](#aggregation)
* [Auditing](#auditing)
* [Capped Collections](#capped-collections)
* [Change Streams](#change-streams)
* [Indexes](#indexes)
* [Removed Commands](#removed-commands)
* [Replica Sets](#replica-sets)
* [Security](#security)
* [Sharded Clusters](#sharded-clusters)
* [Shell Changes](#shell-changes)
* [Snapshots](#snapshots)
* [Transactions](#transactions)
* [Naming Changes](#naming-changes)
* [General Changes](#general-changes)
* [Performance Considerations](#performance-considerations)
* [Platform Support](#platform-support)
* [Changes Affecting Compatibility](#changes-affecting-compatibility)
* [Upgrade Procedures](#upgrade-procedures)
* [Downgrade Consideration](#downgrade-consideration)
* [Download](#download)
* [Known Issues](#known-issues)
* [Report an Issue](#report-an-issue)



=== Content from www.mongodb.com_c6f88b3a_20250111_152428.html ===
[![MongoDB logo](https://webimages.mongodb.com/_com_assets/cms/kuyjf3vea2hg34taa-horizontal_default_slate_blue.svg?auto=format%252Ccompress)](https://www.mongodb.com)

* ProductsPlatform[![atlas_product_family](https://webimages.mongodb.com/_com_assets/icons/atlas_product_family.svg)AtlasBuild on a developer data platform](https://www.mongodb.com/atlas)Platform Services[![atlas_database](https://webimages.mongodb.com/_com_assets/icons/atlas_database.svg)DatabaseDeploy a multi-cloud database](https://www.mongodb.com/products/platform/atlas-database)[![atlas_search](https://webimages.mongodb.com/_com_assets/icons/atlas_search.svg)SearchDeliver engaging search experiences](https://www.mongodb.com/products/platform/atlas-search)[![mdb_vector_search](https://webimages.mongodb.com/_com_assets/icons/mdb_vector_search.svg)Vector SearchDesign intelligent apps with gen AI](https://www.mongodb.com/products/platform/atlas-vector-search)[![atlas_stream_processing](https://webimages.mongodb.com/_com_assets/icons/atlas_stream_processing.svg)Stream ProcessingUnify data in motion and data at rest](https://www.mongodb.com/products/platform/atlas-stream-processing)Self Managed[![enterprise_advanced_product family](https://webimages.mongodb.com/_com_assets/icons/enterprise_advanced_product family.svg)Enterprise AdvancedRun and manage MongoDB yourself](https://www.mongodb.com/products/self-managed/enterprise-advanced)[![community_edition_product_family](https://webimages.mongodb.com/_com_assets/icons/community_edition_product_family.svg)Community EditionDevelop locally with MongoDB](https://www.mongodb.com/products/self-managed/community-edition)Tools[![mdb_compass](https://webimages.mongodb.com/_com_assets/icons/mdb_compass.svg)CompassWork with MongoDB data in a GUI](https://www.mongodb.com/products/tools/compass)[![atlas_integration](https://webimages.mongodb.com/_com_assets/icons/atlas_integration.svg)IntegrationsIntegrations with third-party services](https://cloud.mongodb.com/ecosystem/?filter=integration)[![mdb_migrator](https://webimages.mongodb.com/_com_assets/icons/mdb_migrator.svg)Relational MigratorMigrate to MongoDB with confidence](https://www.mongodb.com/products/tools/relational-migrator)[View All ProductsExplore our full developer suitearrow-right](https://www.mongodb.com/products)Build with MongoDB AtlasGet started for free in minutes[Sign Up](https://www.mongodb.com/cloud/atlas/register)Test Enterprise AdvancedDevelop with MongoDB on-premises[Download](https://www.mongodb.com/try/download/enterprise)Try Community EditionExplore the latest version of MongoDB[Download](https://www.mongodb.com/try/download/community)
* ResourcesDocumentation[Atlas DocumentationGet started using Atlas](https://www.mongodb.com/docs/atlas/)[Server DocumentationLearn to use MongoDB](https://www.mongodb.com/docs/manual/)[Start With GuidesGet step-by-step guidance for key tasks](https://www.mongodb.com/docs/guides/) [Tools and ConnectorsLearn how to connect to MongoDB](https://www.mongodb.com/docs/tools-and-connectors/)[MongoDB DriversUse drivers and libraries for MongoDB](https://www.mongodb.com/docs/drivers/)[Resources HubGet help building the next big thing with MongoDBarrow-right](https://www.mongodb.com/resources)Connect[![atlas_product_family](https://webimages.mongodb.com/_com_assets/icons/atlas_product_family.svg)Developer CenterExplore a wide range of developer resources](https://www.mongodb.com/developer/)[![general_events_ask_the_experts](https://webimages.mongodb.com/_com_assets/icons/general_events_ask_the_experts.svg)CommunityJoin a global community of developers](https://www.mongodb.com/community/)[![general_content_tutorial](https://webimages.mongodb.com/_com_assets/icons/general_content_tutorial.svg)Courses and CertificationLearn for free from MongoDB](https://learn.mongodb.com/)[![general_events_session](https://webimages.mongodb.com/_com_assets/icons/general_events_session.svg)Events and WebinarsFind an event or webinar near you](https://www.mongodb.com/events)
* SolutionsUse cases[Artificial Intelligence](https://www.mongodb.com/solutions/use-cases/artificial-intelligence)[Edge Computing](https://www.mongodb.com/use-cases/atlas-for-the-edge)[Internet of Things](https://www.mongodb.com/solutions/use-cases/internet-of-things)[Mobile](https://www.mongodb.com/solutions/use-cases/mobile)[Payments](https://www.mongodb.com/solutions/use-cases/payments)[Serverless Development](https://www.mongodb.com/solutions/use-cases/serverless)Industries[Financial Services](https://www.mongodb.com/solutions/industries/financial-services)[Telecommunications](https://www.mongodb.com/solutions/industries/telecommunications)[Healthcare](https://www.mongodb.com/solutions/industries/healthcare)[Retail](https://www.mongodb.com/solutions/industries/retail)[Public Sector](https://www.mongodb.com/solutions/industries/public-sector)[Manufacturing](https://www.mongodb.com/solutions/industries/manufacturing)[Solutions LibraryOrganized and tailored solutions to kick-start projectsarrow-right](https://www.mongodb.com/solutions/solutions-library)Developer Data PlatformAccelerate innovation at scale[Learn morearrow-right](https://www.mongodb.com/solutions/developer-data-platform)Startups and AI InnovatorsFor world-changing ideas and AI pioneers[Learn morearrow-right](https://www.mongodb.com/solutions/startups)Customer Case StudiesHear directly from our users[See Storiesarrow-right](https://www.mongodb.com/library/customer-case-studies)
* Company[CareersStart your next adventure](https://www.mongodb.com/company/careers)[BlogRead articles and announcements](https://www.mongodb.com/blog)[NewsroomRead press releases and news stories](https://www.mongodb.com/company/newsroom)[PartnersLearn about our partner ecosystem](https://www.mongodb.com/company/partners)[LeadershipMeet our executive team](https://www.mongodb.com/company/leadership)[CompanyLearn more about who we are](https://www.mongodb.com/company)Contact UsReach out to MongoDB[Letâs chatarrow-right](https://www.mongodb.com/company/contact)InvestorsVisit our investor portal[Learn morearrow-right](https://investors.mongodb.com/)
* [Pricing](https://www.mongodb.com/pricing)

![Language Selector Icon](https://webimages.mongodb.com/_com_assets/cms/lvz91dv3bugodsyau-language-selector-globe.svg?auto=format%252Ccompress)Eng[Support](https://www.mongodb.com/services/support)[Sign In](https://account.mongodb.com/account/login)[Try Free](https://www.mongodb.com/cloud/atlas/register)menu-vertical[![MongoDB logo](https://webimages.mongodb.com/_com_assets/cms/kuyjf3vea2hg34taa-horizontal_default_slate_blue.svg?auto=format%252Ccompress)](https://www.mongodb.com)[![MongoDB logo](https://webimages.mongodb.com/_com_assets/cms/kuyj3d95v5vbmm2f4-horizontal_white.svg?auto=format%252Ccompress)](https://www.mongodb.com)

* ProductsPlatform[![atlas_product_family](https://webimages.mongodb.com/_com_assets/icons/atlas_product_family_inverse.svg)AtlasBuild on a developer data platform](https://www.mongodb.com/atlas)Platform Services[![atlas_database](https://webimages.mongodb.com/_com_assets/icons/atlas_database_inverse.svg)DatabaseDeploy a multi-cloud database](https://www.mongodb.com/products/platform/atlas-database)[![atlas_search](https://webimages.mongodb.com/_com_assets/icons/atlas_search_inverse.svg)SearchDeliver engaging search experiences](https://www.mongodb.com/products/platform/atlas-search)[![mdb_vector_search](https://webimages.mongodb.com/_com_assets/icons/mdb_vector_search_inverse.svg)Vector SearchDesign intelligent apps with gen AI](https://www.mongodb.com/products/platform/atlas-vector-search)[![atlas_stream_processing](https://webimages.mongodb.com/_com_assets/icons/atlas_stream_processing_inverse.svg)Stream ProcessingUnify data in motion and data at rest](https://www.mongodb.com/products/platform/atlas-stream-processing)Self Managed[![enterprise_advanced_product family](https://webimages.mongodb.com/_com_assets/icons/enterprise_advanced_product family_inverse.svg)Enterprise AdvancedRun and manage MongoDB yourself](https://www.mongodb.com/products/self-managed/enterprise-advanced)[![community_edition_product_family](https://webimages.mongodb.com/_com_assets/icons/community_edition_product_family_inverse.svg)Community EditionDevelop locally with MongoDB](https://www.mongodb.com/products/self-managed/community-edition)Tools[![mdb_compass](https://webimages.mongodb.com/_com_assets/icons/mdb_compass_inverse.svg)CompassWork with MongoDB data in a GUI](https://www.mongodb.com/products/tools/compass)[![atlas_integration](https://webimages.mongodb.com/_com_assets/icons/atlas_integration_inverse.svg)IntegrationsIntegrations with third-party services](https://cloud.mongodb.com/ecosystem/?filter=integration)[![mdb_migrator](https://webimages.mongodb.com/_com_assets/icons/mdb_migrator_inverse.svg)Relational MigratorMigrate to MongoDB with confidence](https://www.mongodb.com/products/tools/relational-migrator)[View All ProductsExplore our full developer suitearrow-right](https://www.mongodb.com/products)Build with MongoDB AtlasGet started for free in minutes[Sign Up](https://www.mongodb.com/cloud/atlas/register)Test Enterprise AdvancedDevelop with MongoDB on-premises[Download](https://www.mongodb.com/try/download/enterprise)Try Community EditionExplore the latest version of MongoDB[Download](https://www.mongodb.com/try/download/community)
* ResourcesDocumentation[Atlas DocumentationGet started using Atlas](https://www.mongodb.com/docs/atlas/)[Server DocumentationLearn to use MongoDB](https://www.mongodb.com/docs/manual/)[Start With GuidesGet step-by-step guidance for key tasks](https://www.mongodb.com/docs/guides/) [Tools and ConnectorsLearn how to connect to MongoDB](https://www.mongodb.com/docs/tools-and-connectors/)[MongoDB DriversUse drivers and libraries for MongoDB](https://www.mongodb.com/docs/drivers/)[Resources HubGet help building the next big thing with MongoDBarrow-right](https://www.mongodb.com/resources)Connect[![atlas_product_family](https://webimages.mongodb.com/_com_assets/icons/atlas_product_family_inverse.svg)Developer CenterExplore a wide range of developer resources](https://www.mongodb.com/developer/)[![general_events_ask_the_experts](https://webimages.mongodb.com/_com_assets/icons/general_events_ask_the_experts_inverse.svg)CommunityJoin a global community of developers](https://www.mongodb.com/community/)[![general_content_tutorial](https://webimages.mongodb.com/_com_assets/icons/general_content_tutorial_inverse.svg)Courses and CertificationLearn for free from MongoDB](https://learn.mongodb.com/)[![general_events_session](https://webimages.mongodb.com/_com_assets/icons/general_events_session_inverse.svg)Events and WebinarsFind an event or webinar near you](https://www.mongodb.com/events)
* SolutionsUse cases[Artificial Intelligence](https://www.mongodb.com/solutions/use-cases/artificial-intelligence)[Edge Computing](https://www.mongodb.com/use-cases/atlas-for-the-edge)[Internet of Things](https://www.mongodb.com/solutions/use-cases/internet-of-things)[Mobile](https://www.mongodb.com/solutions/use-cases/mobile)[Payments](https://www.mongodb.com/solutions/use-cases/payments)[Serverless Development](https://www.mongodb.com/solutions/use-cases/serverless)Industries[Financial Services](https://www.mongodb.com/solutions/industries/financial-services)[Telecommunications](https://www.mongodb.com/solutions/industries/telecommunications)[Healthcare](https://www.mongodb.com/solutions/industries/healthcare)[Retail](https://www.mongodb.com/solutions/industries/retail)[Public Sector](https://www.mongodb.com/solutions/industries/public-sector)[Manufacturing](https://www.mongodb.com/solutions/industries/manufacturing)[Solutions LibraryOrganized and tailored solutions to kick-start projectsarrow-right](https://www.mongodb.com/solutions/solutions-library)Developer Data PlatformAccelerate innovation at scale[Learn morearrow-right](https://www.mongodb.com/solutions/developer-data-platform)Startups and AI InnovatorsFor world-changing ideas and AI pioneers[Learn morearrow-right](https://www.mongodb.com/solutions/startups)Customer Case StudiesHear directly from our users[See Storiesarrow-right](https://www.mongodb.com/library/customer-case-studies)
* Company[CareersStart your next adventure](https://www.mongodb.com/company/careers)[BlogRead articles and announcements](https://www.mongodb.com/blog)[NewsroomRead press releases and news stories](https://www.mongodb.com/company/newsroom)[PartnersLearn about our partner ecosystem](https://www.mongodb.com/company/partners)[LeadershipMeet our executive team](https://www.mongodb.com/company/leadership)[CompanyLearn more about who we are](https://www.mongodb.com/company)Contact UsReach out to MongoDB[Letâs chatarrow-right](https://www.mongodb.com/company/contact)InvestorsVisit our investor portal[Learn morearrow-right](https://investors.mongodb.com/)
* [Pricing](https://www.mongodb.com/pricing)

![Language Selector Icon](https://webimages.mongodb.com/_com_assets/cms/lzsle5raf6v32fw36-language-selector-globe-dark-mode.svg?auto=format%252Ccompress)Eng[Support](https://www.mongodb.com/services/support)[Sign In](https://account.mongodb.com/account/login)[Try Free](https://www.mongodb.com/cloud/atlas/register)menu-vertical[![MongoDB logo](https://webimages.mongodb.com/_com_assets/cms/kuyj3d95v5vbmm2f4-horizontal_white.svg?auto=format%252Ccompress)](https://www.mongodb.com)

* [Docs Home](https://www.mongodb.com/docs/)

---

* [MongoDB Manual](/docs/v6.0/)
6.0* [Introduction](/docs/v6.0/introduction/)
* [CRUD Operations](/docs/v6.0/crud/)
* [Aggregation Operations](/docs/v6.0/aggregation/)
* [Indexes](/docs/v6.0/indexes/)
* [Atlas Search](https://www.mongodb.com/docs/atlas/atlas-search/?tck=docs_server_toc)
* [Atlas Vector Search](https://www.mongodb.com/docs/atlas/atlas-vector-search/vector-search-overview/?tck=docs_server_toc)
* [Time Series](/docs/v6.0/core/timeseries-collections/)
* [Change Streams](/docs/v6.0/changeStreams/)
* [Transactions](/docs/v6.0/core/transactions/)
* Data Modeling
* [Replication](/docs/v6.0/replication/)
* [Sharding](/docs/v6.0/sharding/)
* [Storage](/docs/v6.0/storage/)
* [Administration](/docs/v6.0/administration/)
* [Security](/docs/v6.0/security/)
* [Self-Managed Deployments](/docs/v6.0/self-managed-deployments/)
* FAQ
* [Reference](/docs/v6.0/reference/)
* [Release Notes](/docs/v6.0/release-notes/)
* [6.0](/docs/v6.0/release-notes/6.0/)
* [Compatibility Changes](/docs/v6.0/release-notes/6.0-compatibility/)
* Upgrade 5.0 to 6.0
* [Downgrade 6.0 to 5.0](/docs/v6.0/release-notes/6.0-downgrade/)
* [Changelog](/docs/v6.0/release-notes/6.0-changelog/)
* [5.0](/docs/v6.0/release-notes/5.0/)
* [Versioning](/docs/v6.0/reference/versioning/)
* [Technical Support](/docs/v6.0/support/)

Docs MenuAsk MongoDB AIRate This Page[Docs Home](https://www.mongodb.com/docs/) / [MongoDB Manual](/docs/v6.0/) / [Release Notes](/docs/v6.0/release-notes/)
# Release Notes for MongoDB 6.0

On this page

* [Patch Releases](#patch-releases)
* [Aggregation](#aggregation)
* [Change Streams](#change-streams)
* [Cluster Administration](#cluster-administration)
* [Clustered Collections](#clustered-collections)
* [Indexes](#indexes)
* [Installation](#installation)
* [Platform Support](#platform-support)
* [Replica Sets](#replica-sets)
* [Security](#security)
* [Server Parameters](#server-parameters)
* [Sharding](#sharding)
* [Slot-Based Query Execution Engine](#slot-based-query-execution-engine)
* [Stable API](#stable-api)
* [Time Series Collections](#time-series-collections)
* [General Improvements](#general-improvements)
* [Changes Affecting Compatibility](#changes-affecting-compatibility)
* [Upgrade Procedures](#upgrade-procedures)
* [Downgrade Consideration](#downgrade-consideration)
* [Download](#download)
* [Known Issues](#known-issues)
* [Report an Issue](#report-an-issue)

This page describes changes and new features introduced in MongoDB 6.0.

MongoDB 6.0 is a Major Release, which means that it is supported for
both MongoDB Atlas and on-premises deployments. MongoDB 6.0 includes
changes introduced in MongoDB Rapid Releases 5.1, 5.2, and 5.3. This
page describes changes introduced in those Rapid Releases and MongoDB
6.0.

To learn more about the differences between Major and Rapid releases,
see [MongoDB Versioning.](/docs/v6.0/reference/versioning/#std-label-release-version-numbers)

## Warning

### **Past Release Limitations**

The Critical Advisories below affect some prior MongoDB versions. If your
deployment depends on features impacted by a Critical Advisory, upgrade to
the latest available patch release.

| Issue | Affected Versions |
| --- | --- |
| [SERVER-68511](https://jira.mongodb.org/browse/SERVER-68511) | 6.0.0 |
| [SERVER-77506](https://jira.mongodb.org/browse/SERVER-77506) | 6.0.0 - 6.0.12 |
| [SERVER-80203](https://jira.mongodb.org/browse/SERVER-80203) | 6.0.0 - 6.0.11 (Time Series collections sharded by metaField embedded objects) |
| [SERVER-82353](https://jira.mongodb.org/browse/SERVER-82353) | 6.0.0 - 6.0.13 |
| [WT-10461](https://jira.mongodb.org/browse/WT-10461) | 6.0.0 - 6.0.4 (ARM64 or POWER system architectures) |
| [WT-10551](https://jira.mongodb.org/browse/WT-10551) | 6.0.0 - 6.0.5 (Incremental backups on Ops Manager or Cloud Manager clusters) |
| [SERVER-91194](https://jira.mongodb.org/browse/SERVER-91194) | 6.0.0 - 6.0.16 |
| [SERVER-86622](https://jira.mongodb.org/browse/SERVER-86622) | 6.0.0 - 6.0.14 |

## Patch Releases

### 6.0.20 - Upcoming

* [SERVER-93205](https://jira.mongodb.org/browse/SERVER-93205) Expose number of prepareUnique indexes in serverStatus
* [SERVER-94144](https://jira.mongodb.org/browse/SERVER-94144) $documents inside $lookup fails to parse with QueryStats
* [SERVER-94592](https://jira.mongodb.org/browse/SERVER-94592) Check inner arguments for explain
* [SERVER-94635](https://jira.mongodb.org/browse/SERVER-94635) Make session refresh parameters configurable
* [SERVER-95445](https://jira.mongodb.org/browse/SERVER-95445) SSLManagerOpenSSL should validate entire cert chain
  against CRL
* [All Jira issues closed in 6.0.20](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D6.0.20)
* [6.0.20 Changelog](/docs/v6.0/release-notes/6.0-changelog/#std-label-6.0.20-changelog)

### 6.0.19 - Oct 24, 2024

## Important

### **Improper neutralization of null bytes may lead to buffer over-reads in MongoDB Server**

In MongoDB 6.0 prior to 6.0.19, an authorized user may trigger crashes or
receive the contents of buffer over-reads of Server memory by
issuing specially crafted requests that construct malformed BSON
in the MongoDB Server.

This issue affects MongoDB Server versions:

* 5.0.0 - 5.0.29
* 6.0.0 - 6.0.18
* 7.0.0 - 7.0.14
* 8.0.0 - 8.0.2

* [SERVER-96419](https://jira.mongodb.org/browse/SERVER-96419) Improper neutralization of null bytes may lead
  to buffer over-reads in MongoDB Server
* [All Jira issues closed in 6.0.19](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D6.0.19)
* [6.0.19 Changelog](/docs/v6.0/release-notes/6.0-changelog/#std-label-6.0.19-changelog)

### 6.0.18 - Sep 30, 2024

* [SERVER-70508](https://jira.mongodb.org/browse/SERVER-70508) Add current thread count to extra\_info in serverStatus
  on Linux
* [SERVER-94166](https://jira.mongodb.org/browse/SERVER-94166) Disable the SBE query engine in v6.0
* [SERVER-94170](https://jira.mongodb.org/browse/SERVER-94170) Revert [SERVER-91570](https://jira.mongodb.org/browse/SERVER-91570)
* [All Jira issues closed in 6.0.18](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D6.0.18)
* [6.0.18 Changelog](/docs/v6.0/release-notes/6.0-changelog/#std-label-6.0.18-changelog)

### 6.0.17 - Aug 21, 2024

## Important

### **Fix for CSFLE and Queryable Encryption self-lookup may send values in subpipelines as plaintext instead of ciphertext**

Due to CVE-2024-8013, in MongoDB 6.0 prior to 6.0.16, a bug in query analysis of
certain complex self-referential [`$lookup`](/docs/v6.0/reference/operator/aggregation/lookup/#mongodb-pipeline-pipe.-lookup) subpipelines
may result in literal values in expressions for encrypted fields
being sent to the server malformed.

Should this occur, no documents are returned or written.
This issue affects the `mongocryptd` binary and `mongo_crypt_v1`
shared library in the following MongoDB Server versions:

* 7.3.0 - 7.3.3
* 7.0.0 - 7.0.11
* 6.0.0 - 6.0.16
* 5.0.0 - 5.0.28

**CVSS Score**: 2.2

**CWE**: CWE-319: Cleartext Transmission of Sensitive Information

* [SERVER-96254](https://jira.mongodb.org/browse/SERVER-96254) CSFLE and Queryable Encryption self-lookup may
  fail to encrypt values in subpipelines
* [SERVER-85892](https://jira.mongodb.org/browse/SERVER-85892) $merge with pipeline after $documents returns
  error
* [SERVER-91195](https://jira.mongodb.org/browse/SERVER-91195) Provide a generic backportable solution not
  to miss top-level timeseries collection options
* [SERVER-91362](https://jira.mongodb.org/browse/SERVER-91362) Performance: Do not copy JS "scope" object
  if a cached JsExecution exists
* [SERVER-91406](https://jira.mongodb.org/browse/SERVER-91406) $changeStreamSplitLargeEvent returns
  Location7182803 error when used with non-renameable match expression
* [WT-12708](https://jira.mongodb.org/browse/WT-12708) Evaluation/Revision of eviction random traversal
* [All Jira issues closed in 6.0.17](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D6.0.17)
* [6.0.17 Changelog](/docs/v6.0/release-notes/6.0-changelog/#std-label-6.0.17-changelog)

### 6.0.16 - Jun 28, 2024

* [SERVER-79637](https://jira.mongodb.org/browse/SERVER-79637) Incorrect query results in `$lookup` with TS
  foreign collection using a correlated predicate
* [SERVER-86474](https://jira.mongodb.org/browse/SERVER-86474) $\_internalApplyOplogUpdate with `$set: { foo:
  Timestamp(0, 0) }` is not replicated correctly
* [SERVER-89625](https://jira.mongodb.org/browse/SERVER-89625) Handle directoryPerDb and
  wiredTigerDirectoryForIndexes correctly when reporting namespaces and
  UUIDs during a backup
* [WT-10807](https://jira.mongodb.org/browse/WT-10807) Skip in-memory deleted pages as part of the tree
  walk
* [WT-12609](https://jira.mongodb.org/browse/WT-12609) Improve checkpoint cleanup and page eviction logic
* [All Jira issues closed in 6.0.16](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D%276.0.16%27)
* [6.0.16 Changelog](/docs/v6.0/release-notes/6.0-changelog/#std-label-6.0.16-changelog)

### 6.0.15 - Apr 18, 2024

* [SERVER-72703](https://jira.mongodb.org/browse/SERVER-72703) Downgrade $out's db lock to MODE\_IX
* [SERVER-78556](https://jira.mongodb.org/browse/SERVER-78556) Return default of internalInsertMaxBatchSize to 64
* [SERVER-80363](https://jira.mongodb.org/browse/SERVER-80363) server default writeConcern is not honored when wtimeout
  is set
* [SERVER-83602](https://jira.mongodb.org/browse/SERVER-83602) $or -> $in MatchExpression rewrite should not generate
  $or directly nested in another $or
* [WT-11062](https://jira.mongodb.org/browse/WT-11062) Safe free the ref addr to allow concurrent access
* [All Jira issues closed in 6.0.15](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D%276.0.15%27)
* [6.0.15 Changelog](/docs/v6.0/release-notes/6.0-changelog/#std-label-6.0.15-changelog)

### 6.0.14 - Feb 28, 2024

## Important

### **Fix for MongoDB Server may allow successful untrusted connection**

Due to CVE-2024-1351, in MongoDB 6.0 prior to 6.0.14, under certain
configurations of [`--tlsCAFile`](/docs/v6.0/reference/program/mongod/#std-option-mongod.--tlsCAFile) and
[`CAFile`](/docs/v6.0/reference/configuration-options/#mongodb-setting-net.tls.CAFile), MongoDB Server may skip peer certificate
validation which may result in untrusted connections to succeed.

This may effectively reduce the security guarantees provided by TLS
and open connections that should have been closed due to failing
certificate validation. This issue affects the following MongoDB
Server versions:

* 7.0.0 - 7.0.5
* 6.0.0 - 6.0.13
* 5.0.0 - 5.0.24
* 4.4.0 - 4.4.28

**CVSS Score**: 8.8

**CWE**: CWE-295: Improper Certificate Validation

* [SERVER-82353](https://jira.mongodb.org/browse/SERVER-82353) Multi-document transactions can miss documents
  when movePrimary runs concurrently
* [SERVER-83119](https://jira.mongodb.org/browse/SERVER-83119) Secondary replica crashes on clustered
  collection if notablescan is enabled
* [SERVER-83145](https://jira.mongodb.org/browse/SERVER-83145) Shared buffer fragment incorrectly tracks
  memory usage in freeUnused()
* [SERVER-83564](https://jira.mongodb.org/browse/SERVER-83564) Make sure the process field is indexed in
  config.locks
* [WT-12077](https://jira.mongodb.org/browse/WT-12077) Incorrect hardware checksum calculation on zSeries
  for buffers on stack
* [All Jira issues closed in 6.0.14](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D%276.0.14%27)
* [6.0.14 Changelog](/docs/v6.0/release-notes/6.0-changelog/#std-label-6.0.14-changelog)

### 6.0.13 - Jan 18, 2024

* [SERVER-33494](https://jira.mongodb.org/browse/SERVER-33494) WT SizeStorer never deletes old entries
* [SERVER-50792](https://jira.mongodb.org/browse/SERVER-50792) Return more useful errors when a shard key index
  can't be found for shardCollection/refineCollectionShardKey
* [SERVER-70155](https://jira.mongodb.org/browse/SERVER-70155) Add duration of how long an oplog slot is kept
  open to mongod "Slow query" log lines
* [SERVER-77506](https://jira.mongodb.org/browse/SERVER-77506) Sharded multi-document transactions can mismatch
  data and ShardVersion
* [SERVER-83091](https://jira.mongodb.org/browse/SERVER-83091) $or query can trigger an infinite loop during
  plan enumeration
* [All Jira issues closed in 6.0.13](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D%276.0.13%27)
* [6.0.13 Changelog](/docs/v6.0/release-notes/6.0-changelog/#std-label-6.0.13-changelog)

### 6.0.12 - Nov 27, 2023

* [SERVER-69244](https://jira.mongodb.org/browse/SERVER-69244) $merge fails when session default read concern
  has been set to "majority"
* [SERVER-81295](https://jira.mongodb.org/browse/SERVER-81295) Cannot resume V2 changeStream pipelines with V1
  resume tokens
* [SERVER-81966](https://jira.mongodb.org/browse/SERVER-81966) Avoid modification of previous ChunkMap
  instances during refresh
* [WT-7929](https://jira.mongodb.org/browse/WT-7929) Investigate a solution to avoid FTDC stalls during
  checkpoint
* [WT-11564](https://jira.mongodb.org/browse/WT-11564) Fix RTS to read the newest transaction value only
  when it exists in the checkpoint
* [All Jira issues closed in 6.0.12](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D%276.0.12%27)
* [6.0.12 Changelog](/docs/v6.0/release-notes/6.0-changelog/#std-label-6.0.12-changelog)

### 6.0.11 - Oct 11, 2023

* [SERVER-58534](https://jira.mongodb.org/browse/SERVER-58534) Collect FCV in FTDC
* [SERVER-69244](https://jira.mongodb.org/browse/SERVER-69244) $merge fails when session default read concern has been
  set to "majority"
* [SERVER-71520](https://jira.mongodb.org/browse/SERVER-71520) Dump all thread stacks on RSTL acquisition timeout
* [SERVER-79498](https://jira.mongodb.org/browse/SERVER-79498) Backport $vectorSearch to 6.0
* [SERVER-80021](https://jira.mongodb.org/browse/SERVER-80021) Make $convert round-trip correctly between double and string
* [All Jira issues closed in 6.0.11](https://jira.mongodb.org/browse/SERVER-81762?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D6.0.11)
* [6.0.11 Changelog](/docs/v6.0/release-notes/6.0-changelog/#std-label-6.0.11-changelog)

### 6.0.10 - Sep 14, 2023

* [SERVER-71627](https://jira.mongodb.org/browse/SERVER-71627) Refreshed cached collection route info severely
  blocks all client request when a cluster contains 1 million chunks
* [SERVER-73394](https://jira.mongodb.org/browse/SERVER-73394) Remove misleading operationsBlockedByRefresh metrics
* [SERVER-77183](https://jira.mongodb.org/browse/SERVER-77183) $project followed by $group sometimes gives incorrect
  results
* [SERVER-79771](https://jira.mongodb.org/browse/SERVER-79771) Make resharding operations resilient to
  networkInterfaceExceededTimeLimit
  [All Jira issues closed in 6.0.10](https://jira.mongodb.org/browse/SERVER-80810?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D6.0.10)
* [6.0.10 Changelog](/docs/v6.0/release-notes/6.0-changelog/#std-label-6.0.10-changelog)

### 6.0.9 - Aug 14, 2023

* [SERVER-60466](https://jira.mongodb.org/browse/SERVER-60466) Support drivers gossiping signed $clusterTimes to
  replica set --shardsvrs before addShard runs
* [SERVER-74954](https://jira.mongodb.org/browse/SERVER-74954) Incorrect result when contained $or rewrites
  $elemMatch extra condition
* [SERVER-79136](https://jira.mongodb.org/browse/SERVER-79136) Incorrect query result of $match + $group on metaField
  over time-series
* [WT-10759](https://jira.mongodb.org/browse/WT-10759) Do not retry to force evict history store pages during
  reconciliation
* [WT-11064](https://jira.mongodb.org/browse/WT-11064) Skip globally visible tombstones as part of update obsolete
  check
* [All Jira issues closed in 6.0.9](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D%276.0.9%27)
* [6.0.9 Changelog](/docs/v6.0/release-notes/6.0-changelog/#std-label-6.0.9-changelog)

### 6.0.8 - Jul 13, 2023

* [SERVER-61127](https://jira.mongodb.org/browse/SERVER-61127) Multi-writes may exhaust the number of retry attempts
  in the presence of ongoing chunk migrations
* [SERVER-77005](https://jira.mongodb.org/browse/SERVER-77005) Leave LDAP users logged-in during LDAP downtime
* [SERVER-78126](https://jira.mongodb.org/browse/SERVER-78126) For specific kinds of input, mongo::Value() always hashes to the same result on big-endian platforms
* [All Jira issues closed in 6.0.8](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D%276.0.8%27)
* [6.0.8 Changelog](/docs/v6.0/release-notes/6.0-changelog/#std-label-6.0.8-changelog)

### 6.0.7 - Jun 28, 2023

* [SERVER-71985](https://jira.mongodb.org/browse/SERVER-71985) Automatically retry time series insert on DuplicateKey
  error
* [SERVER-73007](https://jira.mongodb.org/browse/SERVER-73007) CURL\_OPT\_SEEKFUNCTION not set for multi-pass
  authentication
* [SERVER-74551](https://jira.mongodb.org/browse/SERVER-74551) WriteConflictException unnecessarily logged as warning
  during findAndModify after upgrade to mongo 5.0
* [SERVER-77018](https://jira.mongodb.org/browse/SERVER-77018) Deadlock between dbStats and 2 index builds
* [WT-10449](https://jira.mongodb.org/browse/WT-10449) Do not save update chain when there are no updates
  to be written to the history store
* [WT-11031](https://jira.mongodb.org/browse/WT-11031) Fix RTS to skip tables with no time window information
  in the checkpoint
* [All Jira issues closed in 6.0.7](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D%276.0.7%27)
* [6.0.7 Changelog](/docs/v6.0/release-notes/6.0-changelog/#std-label-6.0.7-changelog)

### 6.0.6 - May 12, 2023

* [SERVER-51835](https://jira.mongodb.org/browse/SERVER-51835) Mongos readPreferenceTags are not working as expected
* [SERVER-67105](https://jira.mongodb.org/browse/SERVER-67105) $in queries do not use clustered index
* [SERVER-72774](https://jira.mongodb.org/browse/SERVER-72774) A node in quiesce mode can win election
* [SERVER-74930](https://jira.mongodb.org/browse/SERVER-74930) $avg is returning the sum instead of the average in aggregate $group
* [SERVER-75205](https://jira.mongodb.org/browse/SERVER-75205) Deadlock between stepdown and restoring locks after yielding when all read tickets exhausted
* [All Jira issues closed in 6.0.6](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D%276.0.6%27)
* [6.0.6 Changelog](/docs/v6.0/release-notes/6.0-changelog/#std-label-6.0.6-changelog)

### 6.0.5 - Mar 13, 2023

## Warning

If you upgrade an existing instance of MongoDB to MongoDB
6.0.5, that instance may fail to start if `fork: true` is
set in the `mongod.conf` file.

The upgrade issue affects all MongoDB instances that use `.deb` or
`.rpm` installation packages. Installations that use the tarball
(`.tgz`) release or other package types are not affected. For more
information, see [SERVER-74345.](https://jira.mongodb.org/browse/SERVER-74345)

To remove the `fork: true` setting, run these commands from a system
terminal:

```

| systemctl stop mongod.service |
| --- |
| sed -i.bak '/fork: true/d' /etc/mongod.conf |
| systemctl start mongod.service |

```

The second `systemctl` command starts the upgraded instance after the
setting is removed.

Issues Fixed:

* [SERVER-61909](https://jira.mongodb.org/browse/SERVER-61909) Hang inserting or deleting document with large
  number of index entries
* [SERVER-66469](https://jira.mongodb.org/browse/SERVER-66469) Filtering timeseries with date-field does not
  include results from before 1970
* [SERVER-68122](https://jira.mongodb.org/browse/SERVER-68122) Investigate replicating the collection
  WiredTiger config string during initial sync
* [SERVER-70395](https://jira.mongodb.org/browse/SERVER-70395) Slot-Based Engine too aggressively uses disk for
  $group and is slow
* [SERVER-73232](https://jira.mongodb.org/browse/SERVER-73232) Change the default log-verbosity for
  `_killOperations`
* [All JIRA issues closed in 6.0.5](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D%276.0.5%27)
* [6.0.5 Changelog](/docs/v6.0/release-notes/6.0-changelog/#std-label-6.0.5-changelog)

### 6.0.4 - Jan 26, 2023

Issues Fixed:

* [SERVER-72416](https://jira.mongodb.org/browse/SERVER-72416) The find and findAndModify projection code
  does not honor the collection level collation
* [SERVER-71759](https://jira.mongodb.org/browse/SERVER-71759) [`dataSize`](/docs/v6.0/reference/command/dataSize/#mongodb-dbcommand-dbcmd.dataSize) command doesn't yield
* [SERVER-70237](https://jira.mongodb.org/browse/SERVER-70237) Chunks merge commit must not create a BSON object
  too large
* [SERVER-72222](https://jira.mongodb.org/browse/SERVER-72222) [`mapReduce`](/docs/v6.0/reference/command/mapReduce/#mongodb-dbcommand-dbcmd.mapReduce) with single reduce
  optimization fails when merging results in sharded cluster
* [WT-9268](https://jira.mongodb.org/browse/WT-9268) Delay deletion of the history store record
  to reconciliation
* [All JIRA issues closed in 6.0.4](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D%276.0.4%27)
* [6.0.4 Changelog](/docs/v6.0/release-notes/6.0-changelog/#std-label-6.0.4-changelog)

### 6.0.3 - Nov 21, 2022

Issues fixed:

* [SERVER-66289](https://jira.mongodb.org/browse/SERVER-66289) $out incorrectly throws BSONObj size error on
  v5.0.8
* [SERVER-68139](https://jira.mongodb.org/browse/SERVER-68139) Resharding command fails if the projection sort
  is bigger than 100MB
* [SERVER-68371](https://jira.mongodb.org/browse/SERVER-68371) Enabling CSFLE in your MongoClient causes Atlas
  Search to fail
* [SERVER-68115](https://jira.mongodb.org/browse/SERVER-68115) Bug fix for "elemMatchRootLength > 0" invariant
  trigger
* [SERVER-68394](https://jira.mongodb.org/browse/SERVER-68394) Ensure we do not yield strong locks upon startup
  recovery when \_id index is missing
* [All JIRA issues closed in 6.0.3](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D%276.0.3%27)
* [6.0.3 Changelog](/docs/v6.0/release-notes/6.0-changelog/#std-label-6.0.3-changelog)

### 6.0.2 - Sep 28, 2022

Issues fixed:

* [SERVER-68925](https://jira.mongodb.org/browse/SERVER-68925) Reintroduce check table logging settings at
  startup (revert [SERVER-43664)](https://jira.mongodb.org/browse/SERVER-43664)
* [SERVER-68628](https://jira.mongodb.org/browse/SERVER-68628) Retrying a failed resharding operation after a
  primary failover can lead to server crash or lost writes
* [SERVER-63852](https://jira.mongodb.org/browse/SERVER-63852) getThreadName() should not crash
* [SERVER-65317](https://jira.mongodb.org/browse/SERVER-65317) mongod removes connection from connection pool
  after running simple $search query
* [SERVER-63843](https://jira.mongodb.org/browse/SERVER-63843) Don't allow recursive doLog in synchronous
  signal handlers
* [WT-9870](https://jira.mongodb.org/browse/WT-9870) Fix updating pinned timestamp whenever oldest timestamp is
  updated during recovery
* [All JIRA issues closed in 6.0.2](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D%276.0.2%27)
* [6.0.2 Changelog](/docs/v6.0/release-notes/6.0-changelog/#std-label-6.0.2-changelog)

### 6.0.1 - Aug 19, 2022

Issues fixed:

* [SERVER-68511](https://jira.mongodb.org/browse/SERVER-68511) MovePrimary update of `config.databases` entry
  must use dotted fields notation
* [SERVER-68062](https://jira.mongodb.org/browse/SERVER-68062) Multi-stage aggregations that use $geoNear may
  violate constraints
* [SERVER-66072](https://jira.mongodb.org/browse/SERVER-66072) $match sampling and $group aggregation strange
  behavior
* [SERVER-68130](https://jira.mongodb.org/browse/SERVER-68130) AutoSplitVector could generate response bigger
  than BSONObjMaxUserSize
* [SERVER-68209](https://jira.mongodb.org/browse/SERVER-68209) Remove uassert that prevents
  `config.image_collection` entry from being invalidated
* [All JIRA issues closed in 6.0.1](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D%276.0.1%27)
* [6.0.1 Changelog](/docs/v6.0/release-notes/6.0-changelog/#std-label-6.0.1-changelog)

### 6.0.0 - Jul 19, 2022

The rest of this page describes changes and new features introduced in
MongoDB 6.0.

## Aggregation

### New Aggregation Stages

MongoDB 6.0 introduces the following aggregation stages:

| Stage | Description |
| --- | --- |
| [`$densify`](/docs/v6.0/reference/operator/aggregation/densify/#mongodb-pipeline-pipe.-densify) | Creates new documents in a sequence of documents where values in a specified field are missing. |
| [`$documents`](/docs/v6.0/reference/operator/aggregation/documents/#mongodb-pipeline-pipe.-documents) | Returns literal documents from input expressions. |
| [`$fill`](/docs/v6.0/reference/operator/aggregation/fill/#mongodb-pipeline-pipe.-fill) | Populates `null` and missing field values within documents. |
| [`$shardedDataDistribution`](/docs/v6.0/reference/operator/aggregation/shardedDataDistribution/#mongodb-pipeline-pipe.-shardedDataDistribution) | *New in version 6.0.3*: Provides size and data distribution information on sharded collections. |

### New Aggregation Operators

MongoDB 6.0 introduces the following aggregation operators:

| Operator | Description |
| --- | --- |
| [`$bottom`](/docs/v6.0/reference/operator/aggregation/bottom/#mongodb-group-grp.-bottom) | Returns the bottom element within a group according to the specified sort order. |
| [`$bottomN`](/docs/v6.0/reference/operator/aggregation/bottomN/#mongodb-group-grp.-bottomN) | Returns an aggregation of the bottom `n` elements within a group, according to the specified sort order. |
| [`$firstN`](/docs/v6.0/reference/operator/aggregation/firstN/#mongodb-group-grp.-firstN) | Returns an aggregation of the first `n` elements within a group. Distinct from the [`$firstN`](/docs/v6.0/reference/operator/aggregation/firstN/#mongodb-expression-exp.-firstN) array operator. |
| [`$firstN (array operator)`](/docs/v6.0/reference/operator/aggregation/firstN/#mongodb-expression-exp.-firstN) | Returns a specified number of elements from the beginning of an array. Distinct from the [`$firstN`](/docs/v6.0/reference/operator/aggregation/firstN/#mongodb-group-grp.-firstN) accumulator. |
| [`$lastN`](/docs/v6.0/reference/operator/aggregation/lastN/#mongodb-group-grp.-lastN) | Returns an aggregation of the last `n` elements within a group. Distinct from the [`$lastN`](/docs/v6.0/reference/operator/aggregation/lastN/#mongodb-expression-exp.-lastN) array operator. |
| [`$lastN (array operator)`](/docs/v6.0/reference/operator/aggregation/lastN/#mongodb-expression-exp.-lastN) | Returns a specified number of elements from the end of an array. Distinct from the [`$lastN`](/docs/v6.0/reference/operator/aggregation/lastN/#mongodb-group-grp.-lastN) accumulator. |
| [`$linearFill`](/docs/v6.0/reference/operator/aggregation/linearFill/#mongodb-group-grp.-linearFill) | Fills `null` and missing fields in a [window](/docs/v6.0/reference/operator/aggregation/setWindowFields/#std-label-setWindowFields-window) using [linear interpolation](https://en.wikipedia.org/wiki/Linear_interpolation) based on surrounding field values. |
| [`$locf`](/docs/v6.0/reference/operator/aggregation/locf/#mongodb-group-grp.-locf) | Last observation carried forward. Sets values for `null` and missing fields in a [window](/docs/v6.0/reference/operator/aggregation/setWindowFields/#std-label-setWindowFields-window) to the last non-null value for the field. |
| [`$maxN`](/docs/v6.0/reference/operator/aggregation/maxN/#mongodb-group-grp.-maxN) | Returns an aggregation of the `n` maximum valued elements within a group. Distinct from the [`$maxN`](/docs/v6.0/reference/operator/aggregation/maxN-array-element/#mongodb-expression-exp.-maxN) array operator. |
| [`$maxN (array operator)`](/docs/v6.0/reference/operator/aggregation/maxN-array-element/#mongodb-expression-exp.-maxN) | Returns the `n` largest values in an array. Distinct from the [`$maxN`](/docs/v6.0/reference/operator/aggregation/maxN/#mongodb-group-grp.-maxN) accumulator. |
| [`$minN`](/docs/v6.0/reference/operator/aggregation/minN/#mongodb-group-grp.-minN) | Returns an aggregation of the `n` minimum valued elements within a group. Distinct from the [`$minN`](/docs/v6.0/reference/operator/aggregation/minN-array-element/#mongodb-expression-exp.-minN) array operator. |
| [`$minN (array operator)`](/docs/v6.0/reference/operator/aggregation/minN-array-element/#mongodb-expression-exp.-minN) | Returns the `n` smallest values in an array. Distinct from the [`$minN`](/docs/v6.0/reference/operator/aggregation/minN/#mongodb-group-grp.-minN) accumulator. |
| [`$sortArray`](/docs/v6.0/reference/operator/aggregation/sortArray/#mongodb-expression-exp.-sortArray) | Sorts an array based on its elements. |
| [`$top`](/docs/v6.0/reference/operator/aggregation/top/#mongodb-group-grp.-top) | Returns the top element within a group according to the specified sort order. Distinct from the command [`top`.](/docs/v6.0/reference/command/top/#mongodb-dbcommand-dbcmd.top) |
| [`$topN`](/docs/v6.0/reference/operator/aggregation/topN/#mongodb-group-grp.-topN) | Returns an aggregation of the top `n` elements within a group, according to the specified sort order. |
| [`$tsIncrement`](/docs/v6.0/reference/operator/aggregation/tsIncrement/#mongodb-expression-exp.-tsIncrement) | Returns the incrementing ordinal from a [timestamp](/docs/v6.0/reference/bson-types/#std-label-document-bson-type-timestamp) as a [`long`.](/docs/v6.0/reference/mongodb-extended-json-v1/#mongodb-bsontype-data_numberlong) |
| [`$tsSecond`](/docs/v6.0/reference/operator/aggregation/tsSecond/#mongodb-expression-exp.-tsSecond) | Returns the seconds from a [timestamp](/docs/v6.0/reference/bson-types/#std-label-document-bson-type-timestamp) as a [`long`.](/docs/v6.0/reference/mongodb-extended-json-v1/#mongodb-bsontype-data_numberlong) |

### `$lookup` and `$graphLookup` with Sharded Collections

Starting in MongoDB 5.1,
the [`$lookup`](/docs/v6.0/reference/operator/aggregation/lookup/#mongodb-pipeline-pipe.-lookup) and [`$graphLookup`](/docs/v6.0/reference/operator/aggregation/graphLookup/#mongodb-pipeline-pipe.-graphLookup) aggregation stages
support [sharded collections](/docs/v6.0/sharding/#std-label-sharded-cluster) in the `from`
parameter.

In previous versions of MongoDB, `$lookup` and `$graphLookup`
only allowed for unsharded `from` collections.

You **cannot** use the `$graphLookup` stage within a transaction while
targeting a sharded collection.

## Change Streams

### Optimized Change Streams

Starting in MongoDB 5.1, [change streams](/docs/v6.0/changeStreams/#std-label-changeStreams) are optimized, providing more
efficient resource utilization and faster execution of some aggregation
pipeline stages.

### `wallTime` Change Stream Output Field

Starting in MongoDB 6.0, the [change stream output](/docs/v6.0/reference/change-events/#std-label-change-stream-output) has a new `wallTime` field that contains the
server date and time of the database operation.

### Change Streams with Document Pre- and Post-Images

Starting in MongoDB 6.0, you can use [change streams](/docs/v6.0/reference/change-events/#std-label-change-stream-output) to output the version of a document before and
after changes (the document pre- and post-images). For examples, see
[Change Streams with Document Pre- and Post-Images.](/docs/v6.0/reference/method/db.collection.watch/#std-label-db.collection.watch-change-streams-pre-and-post-images-example)

### Change Stream Expanded Events

Starting in MongoDB 6.0, change streams can show additional
change events for DDL operations, like creating indexes and dropping
collections.

For more information, see [Expanded Events.](/docs/v6.0/reference/change-events/#std-label-change-streams-expanded-events)

### Filters

Starting in MongoDB 6.0, whenever possible, [match filters](/docs/v6.0/changeStreams/#std-label-change-stream-modify-output) are applied to change streams earlier
than in prior releases. This improves performance. However, when a
filter is narrowly defined, an earlier match may cause an operation that
succeeds in prior versions to fail in 6.0.

## Cluster Administration

### Cluster Server Parameters

Starting in MongoDB 6.0, you can use [Cluster Parameters for a Self-Managed Deployment](/docs/v6.0/reference/cluster-parameters/#std-label-cluster-parameters) to modify
and retrieve configuration options for all nodes in a replica set or sharded
cluster. You can use [`setClusterParameter`](/docs/v6.0/reference/command/setClusterParameter/#mongodb-dbcommand-dbcmd.setClusterParameter) to modify cluster-wide
options and [`getClusterParameter`](/docs/v6.0/reference/command/getClusterParameter/#mongodb-dbcommand-dbcmd.getClusterParameter) to retrieve the value of a cluster
parameter.

### Connection Pool Parameters

Starting in MongoDB 6.0, you can use
[`ShardingTaskExecutorPoolMinSizeForConfigServers`](/docs/v6.0/reference/parameters/#mongodb-parameter-param.ShardingTaskExecutorPoolMinSizeForConfigServers) and
[`ShardingTaskExecutorPoolMaxSizeForConfigServers`](/docs/v6.0/reference/parameters/#mongodb-parameter-param.ShardingTaskExecutorPoolMaxSizeForConfigServers) to set the
minimum and maximum sharding TaskExecutor connection pool size for
[configuration servers.](/docs/v6.0/core/sharded-cluster-config-servers/#std-label-sharding-config-server)

### `changeStreamOptions` Cluster Parameter

Starting in MongoDB 6.0, you can use [`changeStreamOptions`](/docs/v6.0/reference/cluster-parameters/#mongodb-parameter-param.changeStreamOptions) to control
the retention policy of change stream pre- and post-images.

### `internalSessionsReapThreshold` Parameter

Starting in MongoDB 6.0, you can use the new
[`internalSessionsReapThreshold`](/docs/v6.0/reference/parameters/#mongodb-parameter-param.internalSessionsReapThreshold) parameter to set the session
limit for internal session metadata deletion.

### Multiple Arbiters Unsupported

Starting in MongoDB 5.3, support for multiple arbiters in a replica set is
disabled by default. To enable support for multiple arbiters, start each
node with the [`allowMultipleArbiters`](/docs/v6.0/reference/parameters/#mongodb-parameter-param.allowMultipleArbiters) parameter.

## Clustered Collections

Starting in MongoDB 5.3, you can create a collection with a
[clustered index](/docs/v6.0/reference/method/db.createCollection/#std-label-db.createCollection.clusteredIndex). Collections
created with a clustered index are called clustered collections.

To learn about the benefits compared to a normal collection, see
[Clustered Collections.](/docs/v6.0/core/clustered-collections/#std-label-clustered-collections)

## Indexes

Starting in MongoDB 5.1, you can use the [`collMod`](/docs/v6.0/reference/command/collMod/#mongodb-dbcommand-dbcmd.collMod) database
command to add the `expireAfterSeconds` option to an existing
single-field non-TTL index.

Starting in MongoDB 6.0, you can use the `prepareUnique` and
`unique` options for the [`collMod`](/docs/v6.0/reference/command/collMod/#mongodb-dbcommand-dbcmd.collMod) command to convert an
existing standard index to a unique index.

### Partial Indexes

Starting in MongoDB 6.0, you can use the operators [`$in`](/docs/v6.0/reference/operator/query/in/#mongodb-query-op.-in) and [`$or`](/docs/v6.0/reference/operator/query/or/#mongodb-query-op.-or)
to create [partial indexes](/docs/v6.0/core/index-partial/#std-label-index-type-partial). The `partialFilterExpression`
maximum depth is also expanded from 2 to 4. You can now use the operators [`$and`](/docs/v6.0/reference/operator/query/and/#mongodb-query-op.-and)
and [`$or`](/docs/v6.0/reference/operator/query/or/#mongodb-query-op.-or) at non-top-levels.

## Installation

### SELinux Policies

Starting in MongoDB 5.1, there is a new SE Linux Policy for:

* [MongoDB Enterprise Server](/docs/v6.0/tutorial/install-mongodb-enterprise-on-red-hat/#std-label-install-enterprise-rhel-configure-selinux)
* [MongoDB Community Edition Server](/docs/v6.0/tutorial/install-mongodb-on-red-hat/#std-label-install-rhel-configure-selinux)

running on Red Hat Linux. The SELinux policy is for use with default
installations using `rpm` installer packages.

## Platform Support

MongoDB 6.0.3 introduces support for RHEL / CentOS / Oracle / Rocky / AlmaLinux 9.

To install MongoDB on RHEL, see:

* [Install MongoDB Community Edition on Red Hat or CentOS](/docs/v6.0/tutorial/install-mongodb-on-red-hat/#std-label-install-mongodb-community-rhel)
* [Install MongoDB Enterprise Edition on Red Hat or CentOS](/docs/v6.0/tutorial/install-mongodb-enterprise-on-red-hat/#std-label-install-mongodb-enterprise-rhel)
## Replica Sets

### Multiple Arbiters Unsupported

Starting in MongoDB 5.3, support for multiple arbiters in a replica set is
disabled by default. To enable support for multiple arbiters, start each
node with the [`allowMultipleArbiters`](/docs/v6.0/reference/parameters/#mongodb-parameter-param.allowMultipleArbiters) parameter.

### `initialSyncMethod` Parameter

Starting in MongoDB 5.2, the [`initialSyncMethod`](/docs/v6.0/reference/parameters/#mongodb-parameter-param.initialSyncMethod) determines
whether [initial sync](/docs/v6.0/core/replica-set-sync/#std-label-replica-set-initial-sync) is a
[logical initial sync](/docs/v6.0/core/replica-set-sync/#std-label-replica-set-initial-sync-logical) or a
[file copy based initial sync.](/docs/v6.0/core/replica-set-sync/#std-label-replica-set-initial-sync-file-copy-based)

[`initialSyncMethod`](/docs/v6.0/reference/parameters/#mongodb-parameter-param.initialSyncMethod) is only available in MongoDB Enterprise
Server.

### Specify Secondary Oplog Batch Delay

Starting in MongoDB 6.0, you can use the
[`oplogBatchDelayMillis`](/docs/v6.0/reference/parameters/#mongodb-parameter-param.oplogBatchDelayMillis) server parameter to specify a delay
for writes of oplog batches on secondaries. Adding a short oplog batch
delay can reduce IOPS on
secondaries, but adds latency for writes with write concern
[`"majority"`.](/docs/v6.0/reference/write-concern/#mongodb-writeconcern-writeconcern.-majority-)

For more information, see [`oplogBatchDelayMillis`.](/docs/v6.0/reference/parameters/#mongodb-parameter-param.oplogBatchDelayMillis)

## Security

### Audit Log Encryption

Starting in MongoDB 6.0 Enterprise, you can encrypt the MongoDB audit
log.

To configure the audit log, see
[Audit Log.](/docs/v6.0/core/security-encryption-at-rest/#std-label-security-encryption-at-rest-audit-log)

## Server Parameters

[`mongod`](/docs/v6.0/reference/program/mongod/#mongodb-binary-bin.mongod) adds these parameters:

* [`transactionTooLargeForCacheThreshold`](/docs/v6.0/reference/parameters/#mongodb-parameter-param.transactionTooLargeForCacheThreshold) (Starting in MongoDB
  6.0.5.)
## Sharding

### Use $shardedDataDistribution to Analyze Sharded Data Distribution

Starting in MongoDB 6.0.3, you can use the [`$shardedDataDistribution`](/docs/v6.0/reference/operator/aggregation/shardedDataDistribution/#mongodb-pipeline-pipe.-shardedDataDistribution)
stage to analyze how your sharded data is distributed across your cluster.

If you are running MongoDB 5.0, you can upgrade your cluster to MongoDB
6.0 and analyze sharded data distribution. For additional details, see
[Analyze Sharded Data Distribution.](/docs/v6.0/tutorial/analyze-sharded-data-distribution/#std-label-analyze-sharded-data-distribution)

### Balancing Policy Changes

Starting in MongoDB 6.0.3, data in sharded clusters is distributed based on data
size rather than number of chunks. As a result, you should be aware of the
following significant changes in sharded cluster data distribution behavior:

* The balancer distributes ranges of data rather than chunks. The balancing
  policy looks for evenness of data distribution rather than chunk distribution.
* Chunks are not subject to auto-splitting. Instead, chunks are split only when
  moved across shards.
* A chunk is now referred to as a range.
* `moveRange` has replaced `moveChunk`.
### Default Chunk Size Increased from 64 MB to 128 MB

Starting in MongoDB 5.2, the
[default chunk size](/docs/v6.0/core/sharding-data-partitioning/#std-label-sharding-chunk-size) is 128 megabytes. In
earlier versions of MongoDB, the default chunk size is 64 megabytes.

### `enableSharding` No Longer Required

Starting in MongoDB 6.0, the [`enableSharding`](/docs/v6.0/reference/command/enableSharding/#mongodb-dbcommand-dbcmd.enableSharding) command is
no longer required to shard a collection.

### Monitor Defragmentation Status

Starting in MongoDB 5.3, the [`balancerCollectionStatus`](/docs/v6.0/reference/command/balancerCollectionStatus/#mongodb-dbcommand-dbcmd.balancerCollectionStatus)
command returns detailed information when run on a namespace going
through chunk defragmentation. The output includes the current phase of
the defragmentation and how many chunks are left to process.

To see example output, see
[Ongoing Defragmentation Process.](/docs/v6.0/reference/command/balancerCollectionStatus/#std-label-balancer-collection-status-defrag-output-command)

## Slot-Based Query Execution Engine

Starting in MongoDB 5.1, MongoDB uses a new query execution engine for
eligible queries, called the slot-based query execution engine. If the
slot-based query execution engine is used, new fields are included in
the query explain plan output.

* The new query execution engine is used if possible.
* If the new query execution engine is used, new fields are included in
  the [query explain plan output.](/docs/v6.0/reference/explain-results/#std-label-explain-results-5.1-later)

### Slot-Based Query Execution Engine Can Execute `$group` and `$lookup` Stages

Starting in version 6.0, MongoDB uses the slot-based query execution engine to execute eligible
[`$group`](/docs/v6.0/reference/operator/aggregation/group/#mongodb-pipeline-pipe.-group) and [`$lookup`](/docs/v6.0/reference/operator/aggregation/lookup/#mongodb-pipeline-pipe.-lookup) stages when certain
conditions are met.

For more information, see [Slot-Based Query Execution Engine Pipeline Optimizations.](/docs/v6.0/core/aggregation-pipeline-optimization/#std-label-sbe-pipeline-optimizations)

## Stable API

The following sections describe additions to the [Stable API](/docs/v6.0/reference/stable-api/#std-label-stable-api) introduced in MongoDB 6.0.

To see the full list of database commands available in the Stable API,
see [Stable API Changelog.](/docs/v6.0/reference/stable-api-changelog/#std-label-stable-api-changelog)

### Database Commands

Starting in MongoDB 6.0, the following database commands are supported
in the [Stable API:](/docs/v6.0/reference/stable-api/#std-label-stable-api)

| Command | Description | Stable API Version |
| --- | --- | --- |
| [`count`](/docs/v6.0/reference/command/count/#mongodb-dbcommand-dbcmd.count) | Counts the number of documents in a collection or a view. (Also available in the Stable API for 5.0-series deployments starting in MongoDB 5.0.9.) | V1 |

### Aggregation Stages and Operators

Starting in MongoDB 6.0, the following aggregation stages and operators
are supported in the [Stable API:](/docs/v6.0/reference/stable-api/#std-label-stable-api)

| Stage or Operator | Description | Stable API Version |
| --- | --- | --- |
| [`$bottom`](/docs/v6.0/reference/operator/aggregation/bottom/#mongodb-group-grp.-bottom) | Returns the bottom element within a group, according to the specified sort order. | V1 |
| [`$bottomN`](/docs/v6.0/reference/operator/aggregation/bottomN/#mongodb-group-grp.-bottomN) | Returns an aggregation of the bottom `n` elements within a group, according to the specified sort order. | V1 |
| [`$dateAdd`](/docs/v6.0/reference/operator/aggregation/dateAdd/#mongodb-expression-exp.-dateAdd) | Increments a [Date](/docs/v6.0/reference/method/Date/) object by a specified number of time units. | V1 |
| [`$dateDiff`](/docs/v6.0/reference/operator/aggregation/dateDiff/#mongodb-expression-exp.-dateDiff) | Returns the difference between two dates. | V1 |
| [`$dateSubtract`](/docs/v6.0/reference/operator/aggregation/dateSubtract/#mongodb-expression-exp.-dateSubtract) | Decrements a [Date](/docs/v6.0/reference/method/Date/) object by a specified number of time units. | V1 |
| [`$dateTrunc`](/docs/v6.0/reference/operator/aggregation/dateTrunc/#mongodb-expression-exp.-dateTrunc) | Truncates a date. | V1 |
| [`$densify`](/docs/v6.0/reference/operator/aggregation/densify/#mongodb-pipeline-pipe.-densify) | Creates new documents in a sequence of documents where certain values in a field are missing. | V1 |
| [`$firstN`](/docs/v6.0/reference/operator/aggregation/firstN/#mongodb-group-grp.-firstN) (aggregation accumulator) | Returns an aggregation of the first `n` elements within a group. | V1 |
| [`$firstN`](/docs/v6.0/reference/operator/aggregation/firstN/#mongodb-expression-exp.-firstN) (array operator) | Returns a specified number of elements from the beginning of an array. | V1 |
| [`$getField`](/docs/v6.0/reference/operator/aggregation/getField/#mongodb-expression-exp.-getField) | Returns the value of a specified field from a document. | V1 |
| [`$lastN`](/docs/v6.0/reference/operator/aggregation/lastN/#mongodb-group-grp.-lastN) (aggregation accumulator) | Returns an aggregation of the last `n` elements within a group. | V1 |
| [`$lastN`](/docs/v6.0/reference/operator/aggregation/lastN/#mongodb-expression-exp.-lastN) (array operator) | Returns a specified number of elements from the end of an array. | V1 |
| [`$locf`](/docs/v6.0/reference/operator/aggregation/locf/#mongodb-group-grp.-locf) | Last observation carried forward. Sets values for `null` and missing fields in a [window](/docs/v6.0/reference/operator/aggregation/setWindowFields/#std-label-setWindowFields-window) to the last non-null value for the field. | V1 |
| [`$maxN`](/docs/v6.0/reference/operator/aggregation/maxN/#mongodb-group-grp.-maxN) (aggregation accumulator) | Returns an aggregation of the maximum value `n` elements within a group. | V1 |
| [`$maxN`](/docs/v6.0/reference/operator/aggregation/maxN-array-element/#mongodb-expression-exp.-maxN) (array operator) | Returns the `n` largest values in an array. | V1 |
| [`$minN`](/docs/v6.0/reference/operator/aggregation/minN/#mongodb-group-grp.-minN) (aggregation accumulator) | Returns an aggregation of the minimum value `n` elements within a group. | V1 |
| [`$minN`](/docs/v6.0/reference/operator/aggregation/minN-array-element/#mongodb-expression-exp.-minN) (array operator) | Returns the `n` smallest values in an array. | V1 |
| [`$setField`](/docs/v6.0/reference/operator/aggregation/setField/#mongodb-expression-exp.-setField) | Adds, updates, or removes a specified field in a document. | V1 |
| [`$setWindowFields`](/docs/v6.0/reference/operator/aggregation/setWindowFields/#mongodb-pipeline-pipe.-setWindowFields) | Performs operations on a specified span of documents in a collection, known as a *window*, and returns the results based on the chosen [window operator.](/docs/v6.0/reference/operator/aggregation/setWindowFields/#std-label-setWindowFields-window-operators) | V1 |
| [`$sortArray`](/docs/v6.0/reference/operator/aggregation/sortArray/#mongodb-expression-exp.-sortArray) | Sorts an array based on its elements. | V1 |
| [`$top`](/docs/v6.0/reference/operator/aggregation/top/#mongodb-group-grp.-top) | Returns the top element within a group according to the specified sort order. | V1 |
| [`$topN`](/docs/v6.0/reference/operator/aggregation/topN/#mongodb-group-grp.-topN) | Returns an aggregation of the top `n` elements within a group, according to the specified sort order. | V1 |
| [`$tsIncrement`](/docs/v6.0/reference/operator/aggregation/tsIncrement/#mongodb-expression-exp.-tsIncrement) | Returns the incrementing ordinal from a [timestamp](/docs/v6.0/reference/bson-types/#std-label-document-bson-type-timestamp) as a [`long`.](/docs/v6.0/reference/mongodb-extended-json-v1/#mongodb-bsontype-data_numberlong) | V1 |
| [`$tsSecond`](/docs/v6.0/reference/operator/aggregation/tsSecond/#mongodb-expression-exp.-tsSecond) | Returns the seconds from a [timestamp](/docs/v6.0/reference/bson-types/#std-label-document-bson-type-timestamp) as a [`long`.](/docs/v6.0/reference/mongodb-extended-json-v1/#mongodb-bsontype-data_numberlong) | V1 |

#### Window Operators

Starting in MongoDB 6.0, the following window operators are supported in
the [Stable API:](/docs/v6.0/reference/stable-api/#std-label-stable-api)

| Window Operator | Description | Stable API Version |
| --- | --- | --- |
| [`$addToSet`](/docs/v6.0/reference/operator/aggregation/addToSet/#mongodb-group-grp.-addToSet) | Returns an array of all unique values that results from applying an [expression](/docs/v6.0/reference/aggregation-quick-reference/#std-label-aggregation-expressions) to each document. | V1 |
| [`$avg`](/docs/v6.0/reference/operator/aggregation/avg/#mongodb-group-grp.-avg) | Returns the average for the specified [expression](/docs/v6.0/reference/aggregation-quick-reference/#std-label-aggregation-expressions). Ignores non-numeric values. | V1 |
| [`$count`](/docs/v6.0/reference/operator/aggregation/count-accumulator/#mongodb-group-grp.-count) | Returns the number of documents in the group or window. | V1 |
| [`$covariancePop`](/docs/v6.0/reference/operator/aggregation/covariancePop/#mongodb-group-grp.-covariancePop) | Returns the population covariance of two numeric [expressions.](/docs/v6.0/reference/aggregation-quick-reference/#std-label-aggregation-expressions) | V1 |
| [`$covarianceSamp`](/docs/v6.0/reference/operator/aggregation/covarianceSamp/#mongodb-group-grp.-covarianceSamp) | Returns the sample covariance of two numeric [expressions.](/docs/v6.0/reference/aggregation-quick-reference/#std-label-aggregation-expressions) | V1 |
| [`$denseRank`](/docs/v6.0/reference/operator/aggregation/denseRank/#mongodb-group-grp.-denseRank) | Returns the document position (known as the rank) relative to other documents in the [`$setWindowFields`](/docs/v6.0/reference/operator/aggregation/setWindowFields/#mongodb-pipeline-pipe.-setWindowFields) stage [partition](/docs/v6.0/reference/operator/aggregation/setWindowFields/#std-label-setWindowFields-partitionBy). There are no gaps in the ranks. Ties receive the same rank. | V1 |
| [`$derivative`](/docs/v6.0/reference/operator/aggregation/derivative/#mongodb-group-grp.-derivative) | Returns the average rate of change within the specified [window.](/docs/v6.0/reference/operator/aggregation/setWindowFields/#std-label-setWindowFields-window) | V1 |
| [`$documentNumber`](/docs/v6.0/reference/operator/aggregation/documentNumber/#mongodb-group-grp.-documentNumber) | Returns the position of a document (known as the document number) in the [`$setWindowFields`](/docs/v6.0/reference/operator/aggregation/setWindowFields/#mongodb-pipeline-pipe.-setWindowFields) stage [partition](/docs/v6.0/reference/operator/aggregation/setWindowFields/#std-label-setWindowFields-partitionBy). Ties result in different adjacent document numbers. | V1 |
| [`$expMovingAvg`](/docs/v6.0/reference/operator/aggregation/expMovingAvg/#mongodb-group-grp.-expMovingAvg) | Returns the exponential moving average for the numeric [expression.](/docs/v6.0/reference/aggregation-quick-reference/#std-label-aggregation-expressions) | V1 |
| [`$first`](/docs/v6.0/reference/operator/aggregation/first/#mongodb-group-grp.-first) | Returns the value that results from applying an [expression](/docs/v6.0/reference/aggregation-quick-reference/#std-label-aggregation-expressions) to the first document in a group or [window.](/docs/v6.0/reference/operator/aggregation/setWindowFields/#std-label-setWindowFields-window) | V1 |
| [`$integral`](/docs/v6.0/reference/operator/aggregation/integral/#mongodb-group-grp.-integral) | Returns the approximation of the area under a curve. | V1 |
| [`$last`](/docs/v6.0/reference/operator/aggregation/last/#mongodb-group-grp.-last) | Returns the value that results from applying an [expression](/docs/v6.0/reference/aggregation-quick-reference/#std-label-aggregation-expressions) to the last document in a group or [window.](/docs/v6.0/reference/operator/aggregation/setWindowFields/#std-label-setWindowFields-window) | V1 |
| [`$locf`](/docs/v6.0/reference/operator/aggregation/locf/#mongodb-group-grp.-locf) | Last observation carried forward. Sets values for `null` and missing fields in a [window](/docs/v6.0/reference/operator/aggregation/setWindowFields/#std-label-setWindowFields-window) to the last non-null value for the field. | V1 |
| [`$max`](/docs/v6.0/reference/operator/aggregation/max/#mongodb-group-grp.-max) | Returns the maximum value that results from applying an [expression](/docs/v6.0/reference/aggregation-quick-reference/#std-label-aggregation-expressions) to each document. | V1 |
| [`$min`](/docs/v6.0/reference/operator/aggregation/min/#mongodb-group-grp.-min) | Returns the minimum value that results from applying an [expression](/docs/v6.0/reference/aggregation-quick-reference/#std-label-aggregation-expressions) to each document. | V1 |
| [`$push`](/docs/v6.0/reference/operator/aggregation/push/#mongodb-group-grp.-push) | Returns an array of values that result from applying an [expression](/docs/v6.0/reference/aggregation-quick-reference/#std-label-aggregation-expressions) to each document. | V1 |
| [`$rank`](/docs/v6.0/reference/operator/aggregation/rank/#mongodb-group-grp.-rank) | Returns the document position (known as the rank) relative to other documents in the [`$setWindowFields`](/docs/v6.0/reference/operator/aggregation/setWindowFields/#mongodb-pipeline-pipe.-setWindowFields) stage [partition.](/docs/v6.0/reference/operator/aggregation/setWindowFields/#std-label-setWindowFields-partitionBy) | V1 |
| [`$shift`](/docs/v6.0/reference/operator/aggregation/shift/#mongodb-group-grp.-shift) | Returns the value from an [expression](/docs/v6.0/reference/aggregation-quick-reference/#std-label-aggregation-expressions) applied to a document in a specified position relative to the current document in the [`$setWindowFields`](/docs/v6.0/reference/operator/aggregation/setWindowFields/#mongodb-pipeline-pipe.-setWindowFields) stage [partition.](/docs/v6.0/reference/operator/aggregation/setWindowFields/#std-label-setWindowFields-partitionBy) | V1 |
| [`$stdDevPop`](/docs/v6.0/reference/operator/aggregation/stdDevPop/#mongodb-group-grp.-stdDevPop) | Returns the population standard deviation that results from applying a numeric [expression](/docs/v6.0/reference/aggregation-quick-reference/#std-label-aggregation-expressions) to each document. | V1 |
| [`$stdDevSamp`](/docs/v6.0/reference/operator/aggregation/stdDevSamp/#mongodb-group-grp.-stdDevSamp) | Returns the sample standard deviation that results from applying a numeric [expression](/docs/v6.0/reference/aggregation-quick-reference/#std-label-aggregation-expressions) to each document. | V1 |
| [`$sum`](/docs/v6.0/reference/operator/aggregation/sum/#mongodb-group-grp.-sum) | Returns the sum that results from applying a numeric [expression](/docs/v6.0/reference/aggregation-quick-reference/#std-label-aggregation-expressions) to each document. | V1 |

## Time Series Collections

The following sections describe improvements and new features for
[time series collections.](/docs/v6.0/core/timeseries-collections/#std-label-manual-timeseries-collection)

### Sharded Time Series Collections

MongoDB 5.1 provides support for sharded [time series collections.](/docs/v6.0/core/timeseries-collections/#std-label-manual-timeseries-collection)

See:

* [Shard a Time Series Collection](/docs/v6.0/core/timeseries/timeseries-shard-collection/#std-label-manual-timeseries-shard-collection)
* [`shardCollection`](/docs/v6.0/reference/command/shardCollection/#mongodb-dbcommand-dbcmd.shardCollection)
* [Time Series Limitations](/docs/v6.0/core/timeseries/timeseries-limitations/#std-label-time-series-limitations-sharding)
### Updates and Deletes

Starting in MongoDB 5.1, time series collections support
[update and delete operations](/docs/v6.0/core/timeseries/timeseries-limitations/#std-label-timeseries-limitations-updates-deletes) with limitations.

### Time Series Column Compression

Starting in MongoDB 5.2, time series collections use **column
compression**. Column compression adds a number of innovations that work
together to significantly improve practical compression, reduce your
data's overall storage on disk, and improve read performance.

Starting in MongoDB 6.0, arrays are also compressed as part of the
[time series column compression.](/docs/v6.0/core/timeseries/timeseries-compression/)

### Support for `$geoNear`

Starting in MongoDB 5.3, you can use the [`$geoNear`](/docs/v6.0/reference/operator/aggregation/geoNear/#mongodb-pipeline-pipe.-geoNear) pipeline
operator on any field in a [time series collection.](/docs/v6.0/core/timeseries-collections/#std-label-manual-timeseries-collection)

### Additional Secondary Index Types

You can add additional [secondary index](/docs/v6.0/reference/glossary/#std-term-secondary-index) types
to time series collections, including [2dsphere](/docs/v6.0/core/2dsphere/#std-label-2dsphere-index)
and [2d](/docs/v6.0/core/2d/#std-label-2d-index) indexes.

For all additional indexes and other improvements, see
[Time Series Secondary Indexes in MongoDB 6.0.](/docs/v6.0/core/timeseries/timeseries-secondary-index/#std-label-timeseries-add-secondary-index-mongodb-6.0)

### Sort Operations Use Secondary Indexes

Sort operations on time series collections can use indexes to improve
performance. For more information and an example, see
[Use Secondary Indexes to Improve Sort Performance.](/docs/v6.0/core/timeseries/timeseries-secondary-index/#std-label-timeseries-secondary-index-sort-performance)

## General Improvements

### Drop a Hashed Shard Key Index

Starting in MongoDB 6.0.12 (and 5.0.22), you can drop the index for a
hashed shard key.

This can speed up data insertion for collections sharded with a hashed
shard key. It can also speed up data ingestion when using
`mongosync`.

For details, see [Drop a Hashed Shard Key Index.](/docs/v6.0/tutorial/drop-a-hashed-shard-key-index/#std-label-drop-a-hashed-shard-key-index)

### OpenSSL3 FIPS Support

Starting in MongoDB 6.0.7, FIPS mode supports
[OpenSSL3](https://www.openssl.org/docs/man3.0/man7/migration_guide.html)
for the following operating systems:

* Ubuntu 22.04
* RHEL 9
* Amazon Linux 2023
### Capped Collections Improvements

Starting in MongoDB 6.0, you can change a
[capped collection's](/docs/v6.0/core/capped-collections/#std-label-manual-capped-collection) maximum size, either in
bytes or in number of documents, using the [`collMod`](/docs/v6.0/reference/command/collMod/#mongodb-dbcommand-dbcmd.collMod) command. See
[Resize a Capped Collection](/docs/v6.0/reference/command/collMod/#std-label-resize-capped-collection) for more details.

### `numOrphanDocs` Field Added to collStats Command

Starting in MongoDB 6.0, the [collStats output](/docs/v6.0/reference/command/collStats/#std-label-collStats-output)
includes the [`collStats.numOrphanDocs`](/docs/v6.0/reference/command/collStats/#mongodb-data-collStats.numOrphanDocs) field that shows the number of
[orphaned documents](/docs/v6.0/reference/glossary/#std-term-orphaned-document) in the collection.

### Exclude Embedded Fields in `serverStatus` Output

Starting in MongoDB 6.0 (and 5.0.9), you can exclude embedded fields
from the [`serverStatus`](/docs/v6.0/reference/command/serverStatus/#mongodb-dbcommand-dbcmd.serverStatus) output.

### Connections

Starting in MongoDB 6.0, the [`Mongo()`](/docs/v6.0/reference/method/db.getMongo/#mongodb-method-db.getMongo)
connection object has the following new methods:

* [`Mongo.getWriteConcern()`](/docs/v6.0/reference/method/Mongo.getWriteConcern/#mongodb-method-Mongo.getWriteConcern) returns the [write concern](/docs/v6.0/reference/glossary/#std-term-write-concern)
* [`Mongo.setWriteConcern()`](/docs/v6.0/reference/method/Mongo.setWriteConcern/#mongodb-method-Mongo.setWriteConcern) sets the [write concern](/docs/v6.0/reference/glossary/#std-term-write-concern)
### Support for Diagnostic Backtrace Generation in `arm64`

Starting in MongoDB 6.0 (and 5.0.10), [diagnostic backtrace
generation](/docs/v6.0/tutorial/manage-mongodb-processes/#std-label-sigusr2-diagnostic-backtrace) in `arm64` is supported.

### Configure Refresh Interval for Cached LDAP User Information

Starting in MongoDB 5.2, you can use the following new server parameters
to configure the refresh interval for cached LDAP user information:

* [`ldapUserCacheRefreshInterval`](/docs/v6.0/reference/parameters/#mongodb-parameter-param.ldapUserCacheRefreshInterval)
* [`ldapUserCacheStalenessInterval`](/docs/v6.0/reference/parameters/#mongodb-parameter-param.ldapUserCacheStalenessInterval)
* [`ldapShouldRefreshUserCacheEntries`](/docs/v6.0/reference/parameters/#mongodb-parameter-param.ldapShouldRefreshUserCacheEntries)

Starting in MongoDB 5.2, the update interval for cached user information
retrieved from an LDAP server depends on
[`ldapShouldRefreshUserCacheEntries`:](/docs/v6.0/reference/parameters/#mongodb-parameter-param.ldapShouldRefreshUserCacheEntries)

* If true, use [`ldapUserCacheRefreshInterval`.](/docs/v6.0/reference/parameters/#mongodb-parameter-param.ldapUserCacheRefreshInterval)
* If false, use [`ldapUserCacheInvalidationInterval`.](/docs/v6.0/reference/parameters/#mongodb-parameter-param.ldapUserCacheInvalidationInterval)
## Changes Affecting Compatibility

Some changes can affect compatibility and may require user actions. For
a detailed list of compatibility changes, see
[Compatibility Changes in MongoDB 6.0.](/docs/v6.0/release-notes/6.0-compatibility/#std-label-6.0-compatibility)

## Upgrade Procedures

## Important

### **Feature Compatibility Version**

To upgrade to MongoDB 6.0 from a 5.0 deployment, the 5.0 deployment
must have `featureCompatibilityVersion` set to `5.0`. To check
the version:

```

| db.adminCommand( { getParameter: 1, featureCompatibilityVersion: 1 } ) |
| --- |

```

To upgrade to MongoDB 6.0, refer to the upgrade instructions specific to
your MongoDB deployment:

* [Upgrade a Standalone to 6.0](/docs/v6.0/release-notes/6.0-upgrade-standalone/#std-label-6.0-upgrade-standalone)
* [Upgrade a Replica Set to 6.0](/docs/v6.0/release-notes/6.0-upgrade-replica-set/#std-label-6.0-upgrade-replica-set)
* [Upgrade a Sharded Cluster to 6.0](/docs/v6.0/release-notes/6.0-upgrade-sharded-cluster/#std-label-6.0-upgrade-sharded-cluster)

If you need guidance on upgrading to 6.0, MongoDB professional services
offer major version upgrade support to help ensure a smooth transition
without interruption to your MongoDB application. To learn more, see
[MongoDB Consulting.](https://www.mongodb.com/products/consulting?tck=docs_server)

## Downgrade Consideration

MongoDB only supports single-version downgrades. You cannot downgrade to a
release that is multiple versions behind your current release.

For example, you may downgrade a 6.0-series to a 5.0-series deployment.
However, further downgrading that 5.0-series deployment to a 4.4-series
deployment is not supported.

## Download

To download MongoDB 6.0, go to the [MongoDB Download Center.](https://www.mongodb.com/try/download?tck=docs_server)

## Known Issues

This section describes known issues in MongoDB 6.0 and their resolution
status.

| In Version | Issue | Status |
| --- | --- | --- |
| 6.0.0 | [SERVER-68062](https://jira.mongodb.org/browse/SERVER-68062): Multi-stage aggregations that use $geoNear may violate constraints. | Resolved in 6.0.1. |

## Report an Issue

To report an issue, see the [MongoDB GitHub repository](https://github.com/mongodb/mongo/wiki/Submit-Bug-Reports) for
instructions on how to file a JIRA ticket for the MongoDB server or one
of the related projects.

[Back

Release Notes](/docs/v6.0/release-notes/ "Previous Section")[Next

Compatibility Changes](/docs/v6.0/release-notes/6.0-compatibility/ "Next Section")

On this page

* [Patch Releases](#patch-releases)
* [Aggregation](#aggregation)
* [Change Streams](#change-streams)
* [Cluster Administration](#cluster-administration)
* [Clustered Collections](#clustered-collections)
* [Indexes](#indexes)
* [Installation](#installation)
* [Platform Support](#platform-support)
* [Replica Sets](#replica-sets)
* [Security](#security)
* [Server Parameters](#server-parameters)
* [Sharding](#sharding)
* [Slot-Based Query Execution Engine](#slot-based-query-execution-engine)
* [Stable API](#stable-api)
* [Time Series Collections](#time-series-collections)
* [General Improvements](#general-improvements)
* [Changes Affecting Compatibility](#changes-affecting-compatibility)
* [Upgrade Procedures](#upgrade-procedures)
* [Downgrade Consideration](#downgrade-consideration)
* [Download](#download)
* [Known Issues](#known-issues)
* [Report an Issue](#report-an-issue)



=== Content from security.netapp.com_1b8ccd4a_20250111_152425.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
æ¥æ¬èª

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [CVE-2024-1351 MongoDB Vulnerability in NetApp Products](https://security.netapp.com/advisory/ntap-20240524-0010)

## CVE-2024-1351 MongoDB Vulnerability in NetApp Products

circle-info

NetApp will continue to update this advisory as additional information becomes available.

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close ×

#### Subscribe to NTAP-20240524-0010 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20240524-0010 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close ×

#### Unsubscribe from NTAP-20240524-0010 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20240524-0010 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20240524-0010
**Version:**
3.0

**Last updated:**
06/18/2024

**Status:**
Interim.

**CVEs:** CVE-2024-1351

Overview
#### Summary

Multiple NetApp products incorporate MongoDB. Certain versions of MongoDB are susceptible to a vulnerability which when successfully exploited could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Impact

Successful exploitation of this vulnerability could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2024-1351](https://nvd.nist.gov/vuln/detail/CVE-2024-1351) | 8.8 (HIGH) | CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

#### References

* <https://jira.mongodb.org/browse/SERVER-72839>

Affected Products
#### Affected Products

* Astra Control Center

#### Products Under Investigation

* ONTAP tools for VMware vSphere 10

#### Products Not Affected

* AFF BIOS - A700s
* AFF Baseboard Management Controller (BMC) - A700s
* ATTO FibreBridge - 7500N
* ATTO FibreBridge - 7600N
* Active IQ Unified Manager for Linux
* Active IQ Unified Manager for Microsoft Windows
* Active IQ Unified Manager for VMware vSphere
* Active IQ mobile app
* Astra Control Center - NetApp Kubernetes Monitoring Operator
* Astra Control Provisioner
* Astra Trident
* Astra Trident Autosupport
* BlueXP Classification
* Brocade Fabric Operating System Firmware
* Brocade SAN Navigator (SANnav)
* Cloud Insights Acquisition Unit
* Cloud Insights Storage Workload Security Agent
* Cloud Insights Telegraf Agent
* Cloud Volumes ONTAP Mediator
* E-Series BIOS
* E-Series SANtricity OS Controller Software 11.x
* E-Series SANtricity Unified Manager and Web Services Proxy
* Element .NET SDK
* Element HealthTools
* Element JAVA SDK
* Element Plug-in for vCenter Server
* Element Powershell Tools
* Element Python SDK
* FAS/AFF BIOS - 2820
* FAS/AFF BIOS - 8300/8700/A400/C400
* FAS/AFF BIOS - A250/500f/C250
* FAS/AFF BIOS - A300/8200/A200/2650/2620/C190/A220/2720/2750/A150
* FAS/AFF BIOS - A320
* FAS/AFF BIOS - A700/9000
* FAS/AFF BIOS - A800/C800
* FAS/AFF BIOS - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400/C400
* FAS/AFF Baseboard Management Controller (BMC) - A250/500f/C250
* FAS/AFF Baseboard Management Controller (BMC) - A320
* FAS/AFF Baseboard Management Controller (BMC) - A800/C800
* FAS/AFF Baseboard Management Controller (BMC) - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - C190/A150/A220/FAS2720/FAS2750
* FAS/AFF Baseboard Management Controller (BMC) - FAS2820
* FAS/AFF Service Processor - A300/8200/A200/2650/2620
* FAS/AFF Service Processor - A700/9000
* Global File Cache
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* IOM12 SAS Disk Shelf Firmware
* IOM12B SAS Disk Shelf Firmware
* IOM12E SAS Disk Shelf Firmware
* IOM12F SAS Disk Shelf Firmware
* IOM12G SAS Disk Shelf Firmware
* IOM6 SAS Disk Shelf Firmware
* IOM6E SAS Disk Shelf Firmware
* Management Services for Element Software and NetApp HCI
* MetroCluster DataCollector
* MetroCluster Tiebreaker for clustered Data ONTAP
* Multipath I/O (SANtricity DSM for Windows MPIO)
* NetApp BlueXP
* NetApp Converged Systems Advisor Agent
* NetApp E-Series Host Collection
* NetApp E-Series SANtricity Collection
* NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S
* NetApp HCI Baseboard Management Controller (BMC) - H410C
* NetApp HCI Baseboard Management Controller (BMC) - H610C
* NetApp HCI Baseboard Management Controller (BMC) - H610S
* NetApp HCI Baseboard Management Controller (BMC) - H615C
* NetApp HCI Compute Node (Bootstrap OS)
* NetApp HCI Compute Node BIOS
* NetApp HCI Storage Node BIOS
* NetApp Kubernetes Monitoring Operator
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp ONTAP PowerShell Toolkit (PSTK)
* NetApp SolidFire & HCI Management Node
* NetApp SolidFire & HCI Storage Node (Element Software)
* NetApp SolidFire Plug-in for vRealize Orchestrator (SolidFire vRO)
* NetApp XCP NFS
* NetApp XCP SMB
* ONTAP 9 (formerly Clustered Data ONTAP)
* ONTAP Antivirus Connector
* ONTAP Mediator
* ONTAP Select Deploy administration utility
* ONTAP tools for VMware vSphere 9
* OnCommand Insight
* OnCommand Workflow Automation
* RcfFileGenerator for MetroCluster IP
* SANtricity Storage Plugin for vCenter
* SRA Plugin for Linux
* SRA Plugin for Windows
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapCenter Plug-in for VMware vSphere/BlueXP backup and Recovery for Virtual Machine
* SnapGathers
* SnapManager for Hyper-V
* SolidFire Storage Replication Adapter
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID BIOS SG1000/SG100/SG1100/SG110
* StorageGRID BIOS SG5660/SG5612/SG5760/SG5712
* StorageGRID BIOS SG6060/SGF6024/SGF6112/SG6160
* StorageGRID Baseboard Management Controller (BMC) - SG6060/SG6160/SGF6024/SGF6112/SG100/SG110/SG1000/SG1100
* System Manager 9.x
* Terraform Provider for ONTAP

Remediation
#### Software Versions and Fixes

None.

This section will be updated as patches are released.

#### Workarounds

None at this time.

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

**Technical Support**

mysupport.netapp.com

1 888 4 NETAPP (1 888 463 8277) (U.S. and Canada)

+00 800 44 638277 (EMEA/Europe)

+800 800 80 800 (Asia/Pacific)

Revision History
#### Status of This Notice

**Interim.**

NetApp will continue to update this advisory as additional information becomes available.

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20240524-0010>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20240524 | Initial Public Release |
| 2.0 | 20240612 | Astra Trident and Astra Trident Autosupport moved to Products Not Affected |
| 3.0 | 20240618 | Astra Control Center moved to Affected Products |

This document is provided solely for informational purposes. All information is based upon NetAppâs current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. Â© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 ©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from jira.mongodb.org_fcb131c4_20250111_152424.html ===


[Log in](/login.jsp?os_destination=%2Fbrowse%2FSERVER-72839)[Skip to main content](#main)[Skip to sidebar](#sidebar)[![MongoDB Jira](/s/ub562g/9160001/fy41z4/_/jira-logo-scaled.png)](https://jira.mongodb.org/secure/MyJiraHome.jspa)

* [Dashboards](/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/secure/BrowseProjects.jspa "View recent projects and browse a list of projects")
* [Issues](/issues/ "Search for issues and view recent issues")
* [eazyBI](/plugins/servlet/eazybi)

* Give feedback to Atlassian
* [Help](/secure/ViewKeyboardShortcuts%21default.jspa "Help")
  + [Keyboard Shortcuts](/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [About Jira](/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/login.jsp?os_destination=%2Fbrowse%2FSERVER-72839)
  + [Acknowledged notifications](/plugins/servlet/wittified/profile/notifications)

![Uploaded image for project: 'Core Server'](https://jira.mongodb.org/secure/projectavatar?pid=10000&avatarId=13900)

1. [Core Server](/browse/SERVER)
2. [SERVER-72839](/browse/SERVER-72839)

## Server skips peer certificate validation if neither CAFile nor clusterCAFile is provided

Schedule Issue[Undo Transition](/secure/UndoTransition%21default.jspa?id=2232852)ClosedExportnullXMLWordPrintableJSON
### Details

* **Type:**
  ![Icon: Bug](/secure/viewavatar?size=xsmall&avatarId=14703&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.") Bug
* **Resolution:**
  Fixed
* **Priority:**
  ![Icon: Major - P3](/images/icons/priorities/major.svg "Major - P3 - Major loss of function.") Major - P3
* **Fix Version/s:**
  [7.1.0-rc4](/issues/?jql=project+%3D+SERVER+AND+fixVersion+%3D+7.1.0-rc4 "7.1.0-rc4 "), [7.0.6](/issues/?jql=project+%3D+SERVER+AND+fixVersion+%3D+7.0.6 "7.0.6 "), [5.0.25](/issues/?jql=project+%3D+SERVER+AND+fixVersion+%3D+5.0.25 "5.0.25 "), [4.4.29](/issues/?jql=project+%3D+SERVER+AND+fixVersion+%3D+4.4.29 "4.4.29 "), [6.0.14](/issues/?jql=project+%3D+SERVER+AND+fixVersion+%3D+6.0.14 "6.0.14 ")
* **Affects Version/s:**
  7.0.5, 6.0.13, 5.0.24, 4.4.28
* **Component/s:**
  None
* **Labels:**
  None

* **Assigned Teams:**
  Server Security
* **Backwards Compatibility:**
  Fully Compatible
* **Operating System:**
  ALL
* **Backport Requested:**
  v7.0, v6.0, v5.0, v4.4, v4.2
* **Sprint:**
  Security 2023-01-23, Security 2023-02-06, Security 2023-02-20, Security 2023-03-06, Security 2023-03-20, Security 2023-04-03, Security 2023-04-17, Security 2023-05-01, Security 2023-05-15, Security 2023-05-29, Security 2023-06-12, Security 2023-06-26, Security 2023-07-10, Security 2023-07-24, Security 2023-08-07, Security 2023-08-21, Security 2023-09-04, Security 2023-09-18
* **Case:**

  (copied to CRM)

### Description

**Issue summary [~~SERVER-72839~~](https://jira.mongodb.org/browse/SERVER-72839 "Server skips peer certificate validation if neither CAFile nor clusterCAFile is provided")**

**Starting mongod with TLS now requires specifying a certificate authority**:

A security vulnerability was found where a server process running MongoDB 3.2.6 or later will allow incoming connections to skip peer certificate validation if the server process was started with TLS enabled (*net.tls.mode* set to *allowTLS*, *preferTLS*, or *requireTLS*) and without a *net.tls.CAFile* configured [(CVE-2024-1351)](https://www.cve.org/CVERecord?id=CVE-2024-1351) .

The expected behavior is that this configuration should have validated client certificates against the system CA store.

Atlas clusters are not affected by this vulnerability.

**Changes in valid configurations**:

This behavior is fixed in version 4.4.29, 5.0.25, 6.0.14 and 7.0.6.

As a result of this fix, MongoDB no longer supports a configuration that enables TLS without explicitly specifying a chain of trust. The server now only allows the following configuration options / server parameter when TLS is configured (.net.tls.mode is 'allowTLS' or greater):

* (Config) .net.tls.CAFile
* (Config) .net.tls.CAFile and .net.tls.clusterCAFile
* (Server Parameter) tlsUseSystemCA

A server in this invalid configuration will fail to start and generate the following error message in the log file:

```

The use of TLS without specifying a chain of trust is no longer supported. See "https://jira.mongodb.org/browse/SERVER-72839 for details."

```

Configuring a server to validate client certificates against the system CA now requires the usage of a new [server parameter](https://www.mongodb.com/docs/manual/reference/parameters/) named ***tlsUseSystemCA***.

**Next Steps**:

To configure a server to use the System CA, start the server with the **tlsUseSystemCA** server parameter set to true. (See the [--setParameter mongod option](https://www.mongodb.com/docs/manual/reference/program/mongod/#std-option-mongod.--setParameter))

Note that some applications may have been inadvertently using this behavior to allow connections using certificates which are invalid. As such, correctly configuring a server to use the System CA will result in client connections failing.

**Troubleshooting**

If client connections start failing after setting the ***tlsUseSystemCA*** parameter, then clients are presenting invalid certificates that are not valid according to the system CA.

If client connections start failing after setting the **tlsUseSystemCA** parameter - users may want to:

1. Restart the server with the **net.tls.allowInvalidCertificates** option in the server configuration file to allow client connections with invalid certificates.
2. Note that the use of **net.tls.allowInvalidCertificates** is fundamentally unsafe. This option should only be enabled on an interim basis to allow for investigating why certificates are not valid according to the System CA. The **net.tls.allowInvalidCertificates** should be removed as soon as possible.
3. Review certificates being provided by clients to assess why they are failing System CA validation.

---

**Previous Description**:

The [documentation](https://www.mongodb.com/docs/manual/reference/configuration-options/#mongodb-setting-net.tls.mode) says that:

If --tlsCAFile or tls.CAFile is not specified and you are not using x.509 authentication, the system-wide CA certificate store will be used when connecting to an TLS-enabled server.

However, when a server is configured with neither CAFile nor clusterCAFile, it will skip peer certificate validation on **both** ingress and egress TLS connections. The expectation is that on egress connection, the node (client) should at least verify the peer (server's) certificate using the system CA cert store.

Note, this only applies to server processes (mongod and mongos), the shell is not affected.

### Attachments

### Issue Links

causes

![Task - A task that needs to be done.](/secure/viewavatar?size=xsmall&avatarId=14718&avatarType=issuetype "Task - A task that needs to be done.")
[MONGOSH-1592](/browse/MONGOSH-1592)
Account for server TLS option changes

* ![Major - P3 - Major loss of function.](/images/icons/priorities/major.svg "Major - P3 - Major loss of function.")
* Closed

is caused by

![New Feature - A new feature of the product, which has yet to be developed.](/secure/viewavatar?size=xsmall&avatarId=14711&avatarType=issuetype "New Feature - A new feature of the product, which has yet to be developed.")
[SERVER-23044](/browse/SERVER-23044)
Fall back to system CA certs in the shell if CA file isn't provided

* ![Major - P3 - Major loss of function.](/images/icons/priorities/major.svg "Major - P3 - Major loss of function.")
* Closed

is depended on by

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=14703&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[SERVER-90267](/browse/SERVER-90267)
Server doesn't validate custom CA with tlsUseSystemCA parameter

* ![Minor - P4 - Minor loss of function, or other problem where easy workaround is present.](/images/icons/priorities/minor.svg "Minor - P4 - Minor loss of function, or other problem where easy workaround is present.")
* Closed

![Investigation - ](/secure/viewavatar?size=xsmall&avatarId=14720&avatarType=issuetype "Investigation - ")
[TOOLS-3463](/browse/TOOLS-3463)
Investigate changes in SERVER-72839: Server skips peer certificate validation if neither CAFile nor clusterCAFile is provided

* ![Major - P3 - Major loss of function.](/images/icons/priorities/major.svg "Major - P3 - Major loss of function.")
* Closed

![Investigation - ](/secure/viewavatar?size=xsmall&avatarId=14720&avatarType=issuetype "Investigation - ")
[COMPASS-7197](/browse/COMPASS-7197)
Investigate changes in SERVER-72839: Server skips peer certificate validation if neither CAFile nor clusterCAFile is provided

* ![Minor - P4 - Minor loss of function, or other problem where easy workaround is present.](/images/icons/priorities/minor.svg "Minor - P4 - Minor loss of function, or other problem where easy workaround is present.")
* Closed

is related to

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=14703&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[SERVER-80677](/browse/SERVER-80677)
Cert failures due to parallel tests

* ![Major - P3 - Major loss of function.](/images/icons/priorities/major.svg "Major - P3 - Major loss of function.")
* Closed

related to

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=14703&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[SERVER-72234](/browse/SERVER-72234)
System-wide CA certificate store not used

* ![Minor - P4 - Minor loss of function, or other problem where easy workaround is present.](/images/icons/priorities/minor.svg "Minor - P4 - Minor loss of function, or other problem where easy workaround is present.")
* Closed

![Improvement - An improvement or enhancement to an existing feature or task.](/secure/viewavatar?size=xsmall&avatarId=14710&avatarType=issuetype "Improvement - An improvement or enhancement to an existing feature or task.")
[SERVER-82257](/browse/SERVER-82257)
Add explicit --tlsUseSystemCA flag

* ![Major - P3 - Major loss of function.](/images/icons/priorities/major.svg "Major - P3 - Major loss of function.")
* Closed

Show 3 more links (1 is related to, 2 related to)

### Activity

### People

Assignee:
![brad.moore@mongodb.com](https://jira.mongodb.org/secure/useravatar?size=small&avatarId=10122)
Brad Moore

Reporter:
![erwin.pe@mongodb.com](https://jira.mongodb.org/secure/useravatar?size=small&avatarId=10122)
Erwin Pe

Participants:

[Brad Moore](/secure/IssueNavigator.jspa?reset=true&customfield_10051=brad.moore%40mongodb.com "Find all issues Brad Moore participated in"), [Erwin Pe](/secure/IssueNavigator.jspa?reset=true&customfield_10051=erwin.pe%40mongodb.com "Find all issues Erwin Pe participated in"), [Githook User](/secure/IssueNavigator.jspa?reset=true&customfield_10051=xgen-internal-githook "Find all issues Githook User participated in")

Votes:
0
Vote for this issue

Watchers:
23
Start watching this issue

### Dates

Created:

Jan 13 2023 04:28:27 PM UTC

Updated:

Jan 03 2025 09:28:46 AM UTC

Resolved:

Sep 07 2023 03:54:23 PM UTC

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/secure/CreateIssue%21default.jspa)

Powered by a free Atlassian [Jira](http://www.atlassian.com/software/jira) open source license for MongoDB. Try Jira - [bug tracking software](http://www.atlassian.com/software/jira) for *your* team.

[Atlassian](http://www.atlassian.com/)



=== Content from www.mongodb.com_ae462873_20250111_152426.html ===
[![MongoDB logo](https://webimages.mongodb.com/_com_assets/cms/kuyjf3vea2hg34taa-horizontal_default_slate_blue.svg?auto=format%252Ccompress)](https://www.mongodb.com)

* ProductsPlatform[![atlas_product_family](https://webimages.mongodb.com/_com_assets/icons/atlas_product_family.svg)AtlasBuild on a developer data platform](https://www.mongodb.com/atlas)Platform Services[![atlas_database](https://webimages.mongodb.com/_com_assets/icons/atlas_database.svg)DatabaseDeploy a multi-cloud database](https://www.mongodb.com/products/platform/atlas-database)[![atlas_search](https://webimages.mongodb.com/_com_assets/icons/atlas_search.svg)SearchDeliver engaging search experiences](https://www.mongodb.com/products/platform/atlas-search)[![mdb_vector_search](https://webimages.mongodb.com/_com_assets/icons/mdb_vector_search.svg)Vector SearchDesign intelligent apps with gen AI](https://www.mongodb.com/products/platform/atlas-vector-search)[![atlas_stream_processing](https://webimages.mongodb.com/_com_assets/icons/atlas_stream_processing.svg)Stream ProcessingUnify data in motion and data at rest](https://www.mongodb.com/products/platform/atlas-stream-processing)Self Managed[![enterprise_advanced_product family](https://webimages.mongodb.com/_com_assets/icons/enterprise_advanced_product family.svg)Enterprise AdvancedRun and manage MongoDB yourself](https://www.mongodb.com/products/self-managed/enterprise-advanced)[![community_edition_product_family](https://webimages.mongodb.com/_com_assets/icons/community_edition_product_family.svg)Community EditionDevelop locally with MongoDB](https://www.mongodb.com/products/self-managed/community-edition)Tools[![mdb_compass](https://webimages.mongodb.com/_com_assets/icons/mdb_compass.svg)CompassWork with MongoDB data in a GUI](https://www.mongodb.com/products/tools/compass)[![atlas_integration](https://webimages.mongodb.com/_com_assets/icons/atlas_integration.svg)IntegrationsIntegrations with third-party services](https://cloud.mongodb.com/ecosystem/?filter=integration)[![mdb_migrator](https://webimages.mongodb.com/_com_assets/icons/mdb_migrator.svg)Relational MigratorMigrate to MongoDB with confidence](https://www.mongodb.com/products/tools/relational-migrator)[View All ProductsExplore our full developer suitearrow-right](https://www.mongodb.com/products)Build with MongoDB AtlasGet started for free in minutes[Sign Up](https://www.mongodb.com/cloud/atlas/register)Test Enterprise AdvancedDevelop with MongoDB on-premises[Download](https://www.mongodb.com/try/download/enterprise)Try Community EditionExplore the latest version of MongoDB[Download](https://www.mongodb.com/try/download/community)
* ResourcesDocumentation[Atlas DocumentationGet started using Atlas](https://www.mongodb.com/docs/atlas/)[Server DocumentationLearn to use MongoDB](https://www.mongodb.com/docs/manual/)[Start With GuidesGet step-by-step guidance for key tasks](https://www.mongodb.com/docs/guides/) [Tools and ConnectorsLearn how to connect to MongoDB](https://www.mongodb.com/docs/tools-and-connectors/)[MongoDB DriversUse drivers and libraries for MongoDB](https://www.mongodb.com/docs/drivers/)[Resources HubGet help building the next big thing with MongoDBarrow-right](https://www.mongodb.com/resources)Connect[![atlas_product_family](https://webimages.mongodb.com/_com_assets/icons/atlas_product_family.svg)Developer CenterExplore a wide range of developer resources](https://www.mongodb.com/developer/)[![general_events_ask_the_experts](https://webimages.mongodb.com/_com_assets/icons/general_events_ask_the_experts.svg)CommunityJoin a global community of developers](https://www.mongodb.com/community/)[![general_content_tutorial](https://webimages.mongodb.com/_com_assets/icons/general_content_tutorial.svg)Courses and CertificationLearn for free from MongoDB](https://learn.mongodb.com/)[![general_events_session](https://webimages.mongodb.com/_com_assets/icons/general_events_session.svg)Events and WebinarsFind an event or webinar near you](https://www.mongodb.com/events)
* SolutionsUse cases[Artificial Intelligence](https://www.mongodb.com/solutions/use-cases/artificial-intelligence)[Edge Computing](https://www.mongodb.com/use-cases/atlas-for-the-edge)[Internet of Things](https://www.mongodb.com/solutions/use-cases/internet-of-things)[Mobile](https://www.mongodb.com/solutions/use-cases/mobile)[Payments](https://www.mongodb.com/solutions/use-cases/payments)[Serverless Development](https://www.mongodb.com/solutions/use-cases/serverless)Industries[Financial Services](https://www.mongodb.com/solutions/industries/financial-services)[Telecommunications](https://www.mongodb.com/solutions/industries/telecommunications)[Healthcare](https://www.mongodb.com/solutions/industries/healthcare)[Retail](https://www.mongodb.com/solutions/industries/retail)[Public Sector](https://www.mongodb.com/solutions/industries/public-sector)[Manufacturing](https://www.mongodb.com/solutions/industries/manufacturing)[Solutions LibraryOrganized and tailored solutions to kick-start projectsarrow-right](https://www.mongodb.com/solutions/solutions-library)Developer Data PlatformAccelerate innovation at scale[Learn morearrow-right](https://www.mongodb.com/solutions/developer-data-platform)Startups and AI InnovatorsFor world-changing ideas and AI pioneers[Learn morearrow-right](https://www.mongodb.com/solutions/startups)Customer Case StudiesHear directly from our users[See Storiesarrow-right](https://www.mongodb.com/library/customer-case-studies)
* Company[CareersStart your next adventure](https://www.mongodb.com/company/careers)[BlogRead articles and announcements](https://www.mongodb.com/blog)[NewsroomRead press releases and news stories](https://www.mongodb.com/company/newsroom)[PartnersLearn about our partner ecosystem](https://www.mongodb.com/company/partners)[LeadershipMeet our executive team](https://www.mongodb.com/company/leadership)[CompanyLearn more about who we are](https://www.mongodb.com/company)Contact UsReach out to MongoDB[Letâs chatarrow-right](https://www.mongodb.com/company/contact)InvestorsVisit our investor portal[Learn morearrow-right](https://investors.mongodb.com/)
* [Pricing](https://www.mongodb.com/pricing)

![Language Selector Icon](https://webimages.mongodb.com/_com_assets/cms/lvz91dv3bugodsyau-language-selector-globe.svg?auto=format%252Ccompress)Eng[Support](https://www.mongodb.com/services/support)[Sign In](https://account.mongodb.com/account/login)[Try Free](https://www.mongodb.com/cloud/atlas/register)menu-vertical[![MongoDB logo](https://webimages.mongodb.com/_com_assets/cms/kuyjf3vea2hg34taa-horizontal_default_slate_blue.svg?auto=format%252Ccompress)](https://www.mongodb.com)[![MongoDB logo](https://webimages.mongodb.com/_com_assets/cms/kuyj3d95v5vbmm2f4-horizontal_white.svg?auto=format%252Ccompress)](https://www.mongodb.com)

* ProductsPlatform[![atlas_product_family](https://webimages.mongodb.com/_com_assets/icons/atlas_product_family_inverse.svg)AtlasBuild on a developer data platform](https://www.mongodb.com/atlas)Platform Services[![atlas_database](https://webimages.mongodb.com/_com_assets/icons/atlas_database_inverse.svg)DatabaseDeploy a multi-cloud database](https://www.mongodb.com/products/platform/atlas-database)[![atlas_search](https://webimages.mongodb.com/_com_assets/icons/atlas_search_inverse.svg)SearchDeliver engaging search experiences](https://www.mongodb.com/products/platform/atlas-search)[![mdb_vector_search](https://webimages.mongodb.com/_com_assets/icons/mdb_vector_search_inverse.svg)Vector SearchDesign intelligent apps with gen AI](https://www.mongodb.com/products/platform/atlas-vector-search)[![atlas_stream_processing](https://webimages.mongodb.com/_com_assets/icons/atlas_stream_processing_inverse.svg)Stream ProcessingUnify data in motion and data at rest](https://www.mongodb.com/products/platform/atlas-stream-processing)Self Managed[![enterprise_advanced_product family](https://webimages.mongodb.com/_com_assets/icons/enterprise_advanced_product family_inverse.svg)Enterprise AdvancedRun and manage MongoDB yourself](https://www.mongodb.com/products/self-managed/enterprise-advanced)[![community_edition_product_family](https://webimages.mongodb.com/_com_assets/icons/community_edition_product_family_inverse.svg)Community EditionDevelop locally with MongoDB](https://www.mongodb.com/products/self-managed/community-edition)Tools[![mdb_compass](https://webimages.mongodb.com/_com_assets/icons/mdb_compass_inverse.svg)CompassWork with MongoDB data in a GUI](https://www.mongodb.com/products/tools/compass)[![atlas_integration](https://webimages.mongodb.com/_com_assets/icons/atlas_integration_inverse.svg)IntegrationsIntegrations with third-party services](https://cloud.mongodb.com/ecosystem/?filter=integration)[![mdb_migrator](https://webimages.mongodb.com/_com_assets/icons/mdb_migrator_inverse.svg)Relational MigratorMigrate to MongoDB with confidence](https://www.mongodb.com/products/tools/relational-migrator)[View All ProductsExplore our full developer suitearrow-right](https://www.mongodb.com/products)Build with MongoDB AtlasGet started for free in minutes[Sign Up](https://www.mongodb.com/cloud/atlas/register)Test Enterprise AdvancedDevelop with MongoDB on-premises[Download](https://www.mongodb.com/try/download/enterprise)Try Community EditionExplore the latest version of MongoDB[Download](https://www.mongodb.com/try/download/community)
* ResourcesDocumentation[Atlas DocumentationGet started using Atlas](https://www.mongodb.com/docs/atlas/)[Server DocumentationLearn to use MongoDB](https://www.mongodb.com/docs/manual/)[Start With GuidesGet step-by-step guidance for key tasks](https://www.mongodb.com/docs/guides/) [Tools and ConnectorsLearn how to connect to MongoDB](https://www.mongodb.com/docs/tools-and-connectors/)[MongoDB DriversUse drivers and libraries for MongoDB](https://www.mongodb.com/docs/drivers/)[Resources HubGet help building the next big thing with MongoDBarrow-right](https://www.mongodb.com/resources)Connect[![atlas_product_family](https://webimages.mongodb.com/_com_assets/icons/atlas_product_family_inverse.svg)Developer CenterExplore a wide range of developer resources](https://www.mongodb.com/developer/)[![general_events_ask_the_experts](https://webimages.mongodb.com/_com_assets/icons/general_events_ask_the_experts_inverse.svg)CommunityJoin a global community of developers](https://www.mongodb.com/community/)[![general_content_tutorial](https://webimages.mongodb.com/_com_assets/icons/general_content_tutorial_inverse.svg)Courses and CertificationLearn for free from MongoDB](https://learn.mongodb.com/)[![general_events_session](https://webimages.mongodb.com/_com_assets/icons/general_events_session_inverse.svg)Events and WebinarsFind an event or webinar near you](https://www.mongodb.com/events)
* SolutionsUse cases[Artificial Intelligence](https://www.mongodb.com/solutions/use-cases/artificial-intelligence)[Edge Computing](https://www.mongodb.com/use-cases/atlas-for-the-edge)[Internet of Things](https://www.mongodb.com/solutions/use-cases/internet-of-things)[Mobile](https://www.mongodb.com/solutions/use-cases/mobile)[Payments](https://www.mongodb.com/solutions/use-cases/payments)[Serverless Development](https://www.mongodb.com/solutions/use-cases/serverless)Industries[Financial Services](https://www.mongodb.com/solutions/industries/financial-services)[Telecommunications](https://www.mongodb.com/solutions/industries/telecommunications)[Healthcare](https://www.mongodb.com/solutions/industries/healthcare)[Retail](https://www.mongodb.com/solutions/industries/retail)[Public Sector](https://www.mongodb.com/solutions/industries/public-sector)[Manufacturing](https://www.mongodb.com/solutions/industries/manufacturing)[Solutions LibraryOrganized and tailored solutions to kick-start projectsarrow-right](https://www.mongodb.com/solutions/solutions-library)Developer Data PlatformAccelerate innovation at scale[Learn morearrow-right](https://www.mongodb.com/solutions/developer-data-platform)Startups and AI InnovatorsFor world-changing ideas and AI pioneers[Learn morearrow-right](https://www.mongodb.com/solutions/startups)Customer Case StudiesHear directly from our users[See Storiesarrow-right](https://www.mongodb.com/library/customer-case-studies)
* Company[CareersStart your next adventure](https://www.mongodb.com/company/careers)[BlogRead articles and announcements](https://www.mongodb.com/blog)[NewsroomRead press releases and news stories](https://www.mongodb.com/company/newsroom)[PartnersLearn about our partner ecosystem](https://www.mongodb.com/company/partners)[LeadershipMeet our executive team](https://www.mongodb.com/company/leadership)[CompanyLearn more about who we are](https://www.mongodb.com/company)Contact UsReach out to MongoDB[Letâs chatarrow-right](https://www.mongodb.com/company/contact)InvestorsVisit our investor portal[Learn morearrow-right](https://investors.mongodb.com/)
* [Pricing](https://www.mongodb.com/pricing)

![Language Selector Icon](https://webimages.mongodb.com/_com_assets/cms/lzsle5raf6v32fw36-language-selector-globe-dark-mode.svg?auto=format%252Ccompress)Eng[Support](https://www.mongodb.com/services/support)[Sign In](https://account.mongodb.com/account/login)[Try Free](https://www.mongodb.com/cloud/atlas/register)menu-vertical[![MongoDB logo](https://webimages.mongodb.com/_com_assets/cms/kuyj3d95v5vbmm2f4-horizontal_white.svg?auto=format%252Ccompress)](https://www.mongodb.com)

* [Docs Home](https://www.mongodb.com/docs/)

---

* [MongoDB Manual](/docs/manual/)
8.0 (current)* [Introduction](/docs/manual/introduction/)
* [CRUD Operations](/docs/manual/crud/)
* [Aggregation Operations](/docs/manual/aggregation/)
* [Indexes](/docs/manual/indexes/)
* [Atlas Search](https://www.mongodb.com/docs/atlas/atlas-search/?tck=docs_server_toc)
* [Atlas Vector Search](https://www.mongodb.com/docs/atlas/atlas-vector-search/vector-search-overview/?tck=docs_server_toc)
* [Time Series](/docs/manual/core/timeseries-collections/)
* [Change Streams](/docs/manual/changeStreams/)
* [Transactions](/docs/manual/core/transactions/)
* [Data Modeling](/docs/manual/data-modeling/)
* [Replication](/docs/manual/replication/)
* [Sharding](/docs/manual/sharding/)
* [Storage](/docs/manual/storage/)
* [Administration](/docs/manual/administration/)
* [Security](/docs/manual/security/)
* [Self-Managed Deployments](/docs/manual/self-managed-deployments/)
* FAQ
* [Reference](/docs/manual/reference/)
* [Release Notes](/docs/manual/release-notes/)
* [8.0 (Stable Release)](/docs/manual/release-notes/8.0/)
* [7.0](/docs/manual/release-notes/7.0/)
* [Compatibility Changes](/docs/manual/release-notes/7.0-compatibility/)
* Upgrade 6.0 to 7.0
* [Downgrade 7.0 to 6.0](/docs/manual/release-notes/7.0-downgrade/)
* [Changelog](/docs/manual/release-notes/7.0-changelog/)
* [6.0](/docs/manual/release-notes/6.0/)
* [5.0](/docs/manual/release-notes/5.0/)
* [Versioning](/docs/manual/reference/versioning/)
* [Technical Support](/docs/manual/support/)

Docs MenuAsk MongoDB AIRate This Page[Docs Home](https://www.mongodb.com/docs/) / [MongoDB Manual](/docs/manual/) / [Release Notes](/docs/manual/release-notes/)
# Release Notes for MongoDB 7.0 (Stable Release)

On this page

* [Patch Releases](#patch-releases)
* [Atlas Search Index Management](#atlas-search-index-management)
* [General Changes](#general-changes)
* [Security](#security)
* [Aggregation](#aggregation)
* [Time Series](#time-series)
* [Sharding](#sharding)
* [Changes Introduced in 6.X-Series Rapid Releases](#changes-introduced-in-6.x-series-rapid-releases)
* [Platform Support](#platform-support)
* [Upgrade Procedures](#upgrade-procedures)
* [Downgrade Considerations](#downgrade-considerations)
* [Download](#download)
* [Report an Issue](#report-an-issue)

This page describes changes and new features introduced in MongoDB 7.0.

MongoDB 7.0 is a Major Release, which means that it is supported for
both MongoDB Atlas and on-premises deployments. MongoDB 7.0 includes
changes introduced in MongoDB Rapid Releases 6.1, 6.2, and 6.3. To see
changes introduced in these rapid releases, see
[Changes Introduced in 6.X-Series Rapid Releases.](#std-label-7.0-rapid-release-changes)

To learn more about the differences between Major and Rapid releases,
see [MongoDB Versioning.](/docs/manual/reference/versioning/#std-label-release-version-numbers)

## Warning

### **Past Release Limitations**

The Critical Advisories below affect some prior MongoDB versions. If your
deployment depends on features impacted by a Critical Advisory, upgrade to
the latest available patch release.

| Issue | Affected Versions |
| --- | --- |
| [SERVER-77506](https://jira.mongodb.org/browse/SERVER-77506) | 7.0.0 - 7.0.2 |
| [SERVER-80203](https://jira.mongodb.org/browse/SERVER-80203) | 7.0.0 - 7.0.2 (Time Series collections sharded by metaField embedded objects) |
| [SERVER-82353](https://jira.mongodb.org/browse/SERVER-82353) | 7.0.0 - 7.0.5 |
| [SERVER-84723](https://jira.mongodb.org/browse/SERVER-84723) | 7.0.0 - 7.0.6 |
| [SERVER-87061](https://jira.mongodb.org/browse/SERVER-87061) | 7.0.0 - 7.0.6 |
| [SERVER-86622](https://jira.mongodb.org/browse/SERVER-86622) | 7.0.0 - 7.0.7 |

## Patch Releases

### 7.0.16 - Dec 20, 2024

Issues Fixed:

* [SERVER-67816](https://jira.mongodb.org/browse/SERVER-67816) Time-series bucket rounding for pre-1970 dates
  behaves unexpectedly
* [SERVER-90672](https://jira.mongodb.org/browse/SERVER-90672) Investigate potential bug in time-series insert
  path that allows for multiple buckets to have the same OIDs, across
  stripes
* [SERVER-90893](https://jira.mongodb.org/browse/SERVER-90893) listDatabases inconsistent with concurrent DDL
  operations
* [SERVER-94559](https://jira.mongodb.org/browse/SERVER-94559) Time-series measurement deletes update the
  minTime of a bucket
* [SERVER-95067](https://jira.mongodb.org/browse/SERVER-95067) Time-series inserts can generate multiple
  batches referencing the same bucket
* [All Jira issues closed in 7.0.16](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2C%20TOOLS%2C%20WT)%20AND%20resolution%20%3D%20Fixed%20AND%20fixVersion%20%3D%207.0.16)
* [7.0.16 Changelog](/docs/manual/release-notes/7.0-changelog/#std-label-7.0.16-changelog)

### 7.0.15 - Oct 24, 2024

## Important

### **Improper neutralization of null bytes may lead to buffer over-reads in MongoDB Server**

In MongoDB 7.0 prior to 7.0.15, an authorized user may trigger crashes or
receive the contents of buffer over-reads of Server memory by
issuing specially crafted requests that construct malformed BSON
in the MongoDB Server.

This issue affects MongoDB Server versions:

* 5.0.0 - 5.0.29
* 6.0.0 - 6.0.18
* 7.0.0 - 7.0.14
* 8.0.0 - 8.0.1

* [SERVER-96419](https://jira.mongodb.org/browse/SERVER-96419) Improper neutralization of null bytes may lead to buffer over-reads in MongoDB Server
* [All Jira issues closed in 7.0.15](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2C%20TOOLS%2C%20WT)%20AND%20resolution%20%3D%20Fixed%20AND%20fixVersion%20%3D%207.0.15)
* [7.0.15 Changelog](/docs/manual/release-notes/7.0-changelog/#std-label-7.0.15-changelog)

### 7.0.14 - Aug 26, 2024

Issues Fixed:

* [SERVER-82814](https://jira.mongodb.org/browse/SERVER-82814) Support internal expr comparison operators when
  determining clustered collection scan bounds
* [SERVER-85892](https://jira.mongodb.org/browse/SERVER-85892) $merge with pipeline after $documents returns
  error
* [SERVER-91195](https://jira.mongodb.org/browse/SERVER-91195) Provide a generic backportable solution not to
  miss top-level timeseries collection options
* [SERVER-91625](https://jira.mongodb.org/browse/SERVER-91625) Enable indexed plans for expressions with $$NOW,
  $$CLUSTER\_TIME and $$USER\_ROLES
* [WT-12643](https://jira.mongodb.org/browse/WT-12643) Fix Eviction Server walk logic so that it's able to
  evict all pages
* [All Jira issues closed in 7.0.14](https://jira.mongodb.org/browse/WT-13109?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20(fixversion%3D7.0.13%20or%20fixversion%20%3D%207.0.14))
* [7.0.14 Changelog](/docs/manual/release-notes/7.0-changelog/#std-label-7.0.14-changelog)

### 7.0.12 - Jun 28, 2024

## Important

### **Fix for CSFLE and Queryable Encryption self-lookup may send values in subpipelines as plaintext instead of ciphertext**

Due to CVE-2024-8013, in MongoDB 7.0 prior to 7.0.12, a bug in query analysis of
certain complex self-referential [`$lookup`](/docs/manual/reference/operator/aggregation/lookup/#mongodb-pipeline-pipe.-lookup) subpipelines
may result in literal values in expressions for encrypted fields
being sent to the server malformed.

Should this occur, no documents are returned or written.
This issue affects the `mongocryptd` binary and `mongo_crypt_v1`
shared library in the following MongoDB Server versions:

* 7.3.0 - 7.3.3
* 7.0.0 - 7.0.11
* 6.0.0 - 6.0.16
* 5.0.0 - 5.0.28

**CVSS Score**: 2.2

**CWE**: CWE-319: Cleartext Transmission of Sensitive Information

Issues Fixed:

* [SERVER-96254](https://jira.mongodb.org/browse/SERVER-96254) CSFLE and Queryable Encryption self-lookup may
  fail to encrypt values in subpipelines
* [SERVER-64574](https://jira.mongodb.org/browse/SERVER-64574) Upgrade MozJS/Spidermonkey to the latest ESR
* [SERVER-86674](https://jira.mongodb.org/browse/SERVER-86674) Primary catch-up may believe it is caught up when it
  is not
* [SERVER-90485](https://jira.mongodb.org/browse/SERVER-90485) $sort does not work as expected when used in
  conjunction with includeArrayIndex
* [SERVER-91362](https://jira.mongodb.org/browse/SERVER-91362) Performance: Do not copy JS "scope" object if a
  cached JsExecution exists
* [WT-12736](https://jira.mongodb.org/browse/WT-12736) Mark the page clean after re-instantiating the page with
  prepared updates
* [All Jira issues closed in 7.0.12](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D7.0.12)
* [7.0.12 Changelog](/docs/manual/release-notes/7.0-changelog/#std-label-7.0.12-changelog)

### 7.0.11 - May 23, 2024

Issues Fixed:

* [SERVER-85279](https://jira.mongodb.org/browse/SERVER-85279) Don't run the FTDC collection stats
  collector on arbiters
* [SERVER-89495](https://jira.mongodb.org/browse/SERVER-89495) Disable test parameters even when no
  setParameters are specified
* [SERVER-89625](https://jira.mongodb.org/browse/SERVER-89625) Handle directoryPerDb and
  wiredTigerDirectoryForIndexes correctly when reporting
  namespaces and UUIDs during a backup
* [SERVER-90288](https://jira.mongodb.org/browse/SERVER-90288) Bitwise query operators should interpret
  lowest addressable byte in BinData as least significant byte
* [WT-12609](https://jira.mongodb.org/browse/WT-12609) Improve checkpoint cleanup and page eviction
  logic
* [All Jira issues closed in 7.0.11](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D7.0.11)
* [7.0.11 Changelog](/docs/manual/release-notes/7.0-changelog/#std-label-7.0.11-changelog)

### 7.0.9 - Apr 26, 2024

Issues fixed:

* [SERVER-79637](https://jira.mongodb.org/browse/SERVER-79637) Incorrect query results in $lookup with TS foreign collection
  using a correlated predicate
* [SERVER-82349](https://jira.mongodb.org/browse/SERVER-82349) Mongo 7 crashes on applyOps index delete/drops without a collection UUID
* [SERVER-86407](https://jira.mongodb.org/browse/SERVER-86407) Validation does not produce complete results when it should
* [SERVER-88173](https://jira.mongodb.org/browse/SERVER-88173) BinData bit comparisons give wrong results in many cases
* [WT-10807](https://jira.mongodb.org/browse/WT-10807) Skip in-memory deleted pages as part of the tree walk
* [All Jira issues closed in 7.0.9](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D7.0.9)
* [7.0.9 Changelog](/docs/manual/release-notes/7.0-changelog/#std-label-7.0.9-changelog)

### 7.0.8 - Apr 3, 2024

Issues fixed:

* [SERVER-78556](https://jira.mongodb.org/browse/SERVER-78556) Return default of internalInsertMaxBatchSize to 64
* [SERVER-79575](https://jira.mongodb.org/browse/SERVER-79575) Fix numa node counting
* [SERVER-86583](https://jira.mongodb.org/browse/SERVER-86583) Non-transactional snapshot read on unsharded collection
  may execute with mismatched sharding metadata
* [SERVER-87666](https://jira.mongodb.org/browse/SERVER-87666) Query shape for $documents is unique on each execution
* [SERVER-88360](https://jira.mongodb.org/browse/SERVER-88360) Remove "Sharding catalog and local catalog collection
  uuid do not match" tripwire assertion
* [All Jira issues closed in 7.0.8](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D7.0.8)
* [7.0.8 Changelog](/docs/manual/release-notes/7.0-changelog/#std-label-7.0.8-changelog)

### 7.0.7 - Mar 18, 2024

Issues fixed:

* [SERVER-84368](https://jira.mongodb.org/browse/SERVER-84368) CreateIndex fails with StaleConfig if run from a
  stale mongos against a sharded non-empty collection
* [SERVER-84628](https://jira.mongodb.org/browse/SERVER-84628) Startup warning in mongos for Read/Write Concern
* [SERVER-85459](https://jira.mongodb.org/browse/SERVER-85459) [v7.0] bucketRoundingSeconds param is accepted
  by nodes on FCV 6.0, binary 7.0
* [SERVER-85869](https://jira.mongodb.org/browse/SERVER-85869) Exhaustive find on config shard can return stale
  data
* [SERVER-87061](https://jira.mongodb.org/browse/SERVER-87061) Sharded multi-document transactions can observe
  partial effects of concurrent reshard operation
* [All Jira issues closed in 7.0.7](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D%277.0.7%27)
* [7.0.7 Changelog](/docs/manual/release-notes/7.0-changelog/#std-label-7.0.7-changelog)

### 7.0.6 - Feb 28, 2024

## Important

### **Fix for MongoDB Server may allow successful untrusted connection**

Due to CVE-2024-1351, in MongoDB 7.0 prior to 7.0.6, under certain
configurations of [`--tlsCAFile`](/docs/manual/reference/program/mongod/#std-option-mongod.--tlsCAFile) and
[`CAFile`](/docs/manual/reference/configuration-options/#mongodb-setting-net.tls.CAFile), MongoDB Server may skip peer certificate
validation which may result in untrusted connections to succeed.

This may effectively reduce the security guarantees provided by TLS
and open connections that should have been closed due to failing
certificate validation. This issue affects the following MongoDB
Server versions:

* 7.0.0 - 7.0.5
* 6.0.0 - 6.0.13
* 5.0.0 - 5.0.24
* 4.4.0 - 4.4.28

**CVSS Score**: 8.8

**CWE**: CWE-295: Improper Certificate Validation

Issues fixed:

* [SERVER-72703](https://jira.mongodb.org/browse/SERVER-72703) Downgrade $out's db lock to MODE\_IX
* [SERVER-82353](https://jira.mongodb.org/browse/SERVER-82353) Multi-document transactions can miss documents
  when movePrimary runs concurrently
* [SERVER-84338](https://jira.mongodb.org/browse/SERVER-84338) Top level $or queries may lead to invalid SBE
  plan cache entry which returns wrong results
* [SERVER-84723](https://jira.mongodb.org/browse/SERVER-84723) Sharded multi-document transactions can observe
  partial effects of concurrent DDL operations
* [WT-11062](https://jira.mongodb.org/browse/WT-11062) Safe free the ref addr to allow concurrent access
* [All Jira issues closed in 7.0.6](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D%277.0.6%27)
* [7.0.6 Changelog](/docs/manual/release-notes/7.0-changelog/#std-label-7.0.6-changelog)

### 7.0.5 - Jan 5, 2024

Issues fixed:

* [SERVER-33494](https://jira.mongodb.org/browse/SERVER-33494) WT SizeStorer never deletes old entries
* [SERVER-80363](https://jira.mongodb.org/browse/SERVER-80363) server default writeConcern is not honored when
  wtimeout is set
* [SERVER-83091](https://jira.mongodb.org/browse/SERVER-83091) $or query can trigger an infinite loop during
  plan enumeration
* [SERVER-83830](https://jira.mongodb.org/browse/SERVER-83830) On Enterprise build creating a collection in a
  replica set with the storageEngine.inMemory option breaks secondaries
* [WT-7929](https://jira.mongodb.org/browse/WT-7929) Investigate a solution to avoid FTDC stalls during
  checkpoint
* [All Jira issues closed in 7.0.5](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D%277.0.5%27)
* [7.0.5 Changelog](/docs/manual/release-notes/7.0-changelog/#std-label-7.0.5-changelog)

### 7.0.4 - Nov 27, 2023

Issues fixed:

* [SERVER-67962](https://jira.mongodb.org/browse/SERVER-67962) Applying config.image\_collection deletes needs
  better concurrency control
* [SERVER-69244](https://jira.mongodb.org/browse/SERVER-69244) $merge fails when session default read concern
  has been set to "majority"
* [SERVER-79975](https://jira.mongodb.org/browse/SERVER-79975) [Classic] Optimize large group keys
* [SERVER-81133](https://jira.mongodb.org/browse/SERVER-81133) Speedup logic to persist routing table cache
* [SERVER-82446](https://jira.mongodb.org/browse/SERVER-82446) $densify use case can result in documents
  outside of range
* [All Jira issues closed in 7.0.4](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D%277.0.4%27)
* [7.0.4 Changelog](/docs/manual/release-notes/7.0-changelog/#std-label-7.0.4-changelog)

### 7.0.3 - Nov 9, 2023

Issues fixed:

* [SERVER-77506](https://jira.mongodb.org/browse/SERVER-77506) Sharded multi-document transactions can
  mismatch data and ShardVersion
* [SERVER-79088](https://jira.mongodb.org/browse/SERVER-79088) Improve SBE
  multi-planner performance for query which returns zero results
* [SERVER-81106](https://jira.mongodb.org/browse/SERVER-81106) Recipient shard doesn't wait for the collection
  version to be locally persisted before starting the cloning phase
* [SERVER-81966](https://jira.mongodb.org/browse/SERVER-81966) Avoid modification of previous ChunkMap instances
  during refresh
* [WT-11564](https://jira.mongodb.org/browse/WT-11564) Fix RTS to read the newest
  transaction value only when it exists in the checkpoint
* [All Jira issues closed in 7.0.3](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D%277.0.3%27)
* [7.0.3 Changelog](/docs/manual/release-notes/7.0-changelog/#std-label-7.0.3-changelog)

### 7.0.2 - Sep 29, 2023

Issues fixed:

* [SERVER-74954](https://jira.mongodb.org/browse/SERVER-74954) Incorrect result when contained $or rewrites $elemMatch
  extra condition
* [SERVER-79771](https://jira.mongodb.org/browse/SERVER-79771) Make Resharding Operation Resilient to
  NetworkInterfaceExceededTimeLimit
* [SERVER-79912](https://jira.mongodb.org/browse/SERVER-79912) CheckReplDBHash reports failure with system.buckets
  collections due to invalid BSON
* [SERVER-79982](https://jira.mongodb.org/browse/SERVER-79982) Batched catalog writers can run concurrently with
  HistoricalCatalogIdTracker::cleanup() and lead to incorrect PIT find results
* [SERVER-80488](https://jira.mongodb.org/browse/SERVER-80488) Avoid traversing routing table in balancer split chunk
  policy
* [All Jira issues closed in 7.0.2](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D%277.0.2%27)
* [7.0.2 Changelog](/docs/manual/release-notes/7.0-changelog/#std-label-7.0.2-changelog)

### 7.0.1 - Sep 5, 2023

Issues fixed:

* [SERVER-71627](https://jira.mongodb.org/browse/SERVER-71627) Refreshing cached collection route info severely
  blocks all client requests for a cluster with 1 million chunks
* [SERVER-77183](https://jira.mongodb.org/browse/SERVER-77183) $project followed by $group sometimes gives incorrect
  results
* [SERVER-80256](https://jira.mongodb.org/browse/SERVER-80256) QueryPlannerAnalysis::explodeForSort should not assume
  that index scans produce disjoint results
* [All Jira issues closed in 7.0.1](https://jira.mongodb.org/issues/?jql=project%20in%20(SERVER%2CTOOLS%2CWT)%20AND%20resolution%3D%27Fixed%27%20and%20fixversion%3D%277.0.1%27)
* [7.0.1 Changelog](/docs/manual/release-notes/7.0-changelog/#std-label-7.0.1-changelog)

### 7.0.0 - Aug 15, 2023

The rest of this page describes changes and new features introduced in MongoDB
7.0.

## Atlas Search Index Management

Starting in MongoDB 7.0, you can manage [Atlas Search indexes](https://www.mongodb.com/docs/atlas/atlas-search/atlas-search-overview/#fts-indexes) with `mongosh`
methods and database commands. Atlas Search index commands are only available
for deployments hosted on [MongoDB Atlas](https://www.mongodb.com/docs/atlas/), and require an
Atlas cluster tier of at least M10.

To manage Atlas Search indexes, use the following commands:

### mongosh Methods

| Name | Description |
| --- | --- |
| [`db.collection.createSearchIndex()`](/docs/manual/reference/method/db.collection.createSearchIndex/#mongodb-method-db.collection.createSearchIndex) | Creates an Atlas Search index on a specified collection. |
| [`db.collection.dropSearchIndex()`](/docs/manual/reference/method/db.collection.dropSearchIndex/#mongodb-method-db.collection.dropSearchIndex) | Deletes an existing Atlas Search index. |
| [`db.collection.getSearchIndexes()`](/docs/manual/reference/method/db.collection.getSearchIndexes/#mongodb-method-db.collection.getSearchIndexes) | Returns information about existing Atlas Search indexes on a specified collection. |
| [`db.collection.updateSearchIndex()`](/docs/manual/reference/method/db.collection.updateSearchIndex/#mongodb-method-db.collection.updateSearchIndex) | Updates an existing Atlas Search index. |

### Database Commands

| Name | Description |
| --- | --- |
| [`createSearchIndexes`](/docs/manual/reference/command/createSearchIndexes/#mongodb-dbcommand-dbcmd.createSearchIndexes) | Creates one or more Atlas Search indexes on a specified collection. |
| [`dropSearchIndex`](/docs/manual/reference/command/dropSearchIndex/#mongodb-dbcommand-dbcmd.dropSearchIndex) | Deletes an existing Atlas Search index. |
| [`updateSearchIndex`](/docs/manual/reference/command/updateSearchIndex/#mongodb-dbcommand-dbcmd.updateSearchIndex) | Updates an existing Atlas Search index. |

### Aggregation Stages

| Name | Description |
| --- | --- |
| [`$listSampledQueries`](/docs/manual/reference/operator/aggregation/listSampledQueries/#mongodb-pipeline-pipe.-listSampledQueries) | Lists sampled queries for all collections or a specific collection. |
| [`$listSearchIndexes`](/docs/manual/reference/operator/aggregation/listSearchIndexes/#mongodb-pipeline-pipe.-listSearchIndexes) | Returns information about existing Atlas Search indexes on a specified collection. |

## General Changes

### OIDC Access Token Authentication Behavior

Starting in MongoDB 7.0, only one `audience` oidcIdentityProviders
field can be specified for OIDC access tokens. `audience` fields
with empty arrays or arrays of multiple strings are invalid.

For details, see [oidcIdentityProviders Fields.](/docs/manual/reference/parameters/#std-label-oidcidentityproviders-fields)

### Drop a Hashed Shard Key Index

Starting in MongoDB 7.0.3 (and 6.0.12 and 5.0.22), you can drop the
index for a hashed shard key.

This can speed up data insertion for collections sharded with a hashed
shard key. It can also speed up data ingestion when using
`mongosync`.

For details, see [Drop a Hashed Shard Key Index.](/docs/manual/tutorial/drop-a-hashed-shard-key-index/#std-label-drop-a-hashed-shard-key-index)

### Cache Refresh Time Fields

Starting in MongoDB 7.0, [log messages for slow queries](/docs/manual/reference/log-messages/#std-label-log-message-slow-ops) includes a new [cache refresh time field.](/docs/manual/reference/log-messages/#std-label-log-messages-cache-refresh-times)

### Concurrent Storage Engine Transactions (Read and Write Tickets)

Starting in version 7.0, MongoDB uses a default algorithm to dynamically
adjust the maximum number of concurrent storage engine transactions
(including both read and write tickets) to optimize database throughput
during overload.

The following table summarizes how to identify overload scenarios for MongoDB
post-7.0 and for earlier releases:

| Version | Diagnosing Overload Scenarios |
| --- | --- |
| 7.0 and later | A large number of queued operations that persists for a prolonged period of time likely indicates an overload.  A concurrent storage engine transaction (ticket) availibility of 0 for a prolonged period of time **does not** indicate an overload. |
| 6.0 and earlier | A large number of queued operations that persists for a prolonged period of time likely indicates an overload.  A concurrent storage engine transaction (ticket) availibility of 0 for a prolonged period of time likely indicates an overload. |

To learn more, see:

* `wiredTiger.concurrentTransactions`

  Renamed [`queues.execution`](/docs/manual/reference/command/serverStatus/#mongodb-serverstatus-serverstatus.queues.execution) in v8.0.
* [`storageEngineConcurrentReadTransactions`](/docs/manual/reference/parameters/#mongodb-parameter-param.storageEngineConcurrentReadTransactions)
* [`storageEngineConcurrentWriteTransactions`](/docs/manual/reference/parameters/#mongodb-parameter-param.storageEngineConcurrentWriteTransactions)
### `currentOp` Metrics

Starting in MongoDB 7.0, the [`currentOp`](/docs/manual/reference/command/currentOp/#mongodb-dbcommand-dbcmd.currentOp) command and the
[`db.currentOp()`](/docs/manual/reference/method/db.currentOp/#mongodb-method-db.currentOp) method include these new fields:

* [`currentOp.admissionPriority`](/docs/manual/reference/command/currentOp/#mongodb-data-currentOp.admissionPriority)
* [`currentOp.collUuid`](/docs/manual/reference/command/currentOp/#mongodb-data-currentOp.collUuid)
* [`currentOp.startTime`](/docs/manual/reference/command/currentOp/#mongodb-data-currentOp.startTime)
* [`currentOp.samplesPerSecond`](/docs/manual/reference/command/currentOp/#mongodb-data-currentOp.samplesPerSecond)
* [`currentOp.sampledReadsCount`](/docs/manual/reference/command/currentOp/#mongodb-data-currentOp.sampledReadsCount)
* [`currentOp.sampledWritesCount`](/docs/manual/reference/command/currentOp/#mongodb-data-currentOp.sampledWritesCount)
* [`currentOp.sampledReadsBytes`](/docs/manual/reference/command/currentOp/#mongodb-data-currentOp.sampledReadsBytes)
* [`currentOp.sampledWritesBytes`](/docs/manual/reference/command/currentOp/#mongodb-data-currentOp.sampledWritesBytes)
### `$currentOp` (aggregation) Metrics

Starting in MongoDB 7.0, the [currentOp](/docs/manual/reference/operator/aggregation/currentOp/#std-label-current-op-agg)
aggregation stage includes these new fields:

* [`$currentOp.collUuid`](/docs/manual/reference/operator/aggregation/currentOp/#mongodb-data--currentOp.collUuid)
* [`$currentOp.startTime`](/docs/manual/reference/operator/aggregation/currentOp/#mongodb-data--currentOp.startTime)
* [`$currentOp.samplesPerSecond`](/docs/manual/reference/operator/aggregation/currentOp/#mongodb-data--currentOp.samplesPerSecond)
* [`$currentOp.sampledReadsCount`](/docs/manual/reference/operator/aggregation/currentOp/#mongodb-data--currentOp.sampledReadsCount)
* [`$currentOp.sampledWritesCount`](/docs/manual/reference/operator/aggregation/currentOp/#mongodb-data--currentOp.sampledWritesCount)
* [`$currentOp.sampledReadsBytes`](/docs/manual/reference/operator/aggregation/currentOp/#mongodb-data--currentOp.sampledReadsBytes)
* [`$currentOp.sampledWritesBytes`](/docs/manual/reference/operator/aggregation/currentOp/#mongodb-data--currentOp.sampledWritesBytes)
### Compound Wildcard Indexes

Starting in MongoDB 7.0, you can create [compound wildcard indexes](/docs/manual/core/indexes/index-types/index-wildcard/index-wildcard-compound/#std-label-wildcard-index-compound). A compound wildcard index has one wildcard
term and one or more additional index terms.

Use compound wildcard indexes to support queries on known patterns and
to limit the total number of indexes in a collection.

### Large Change Stream Events

Starting in MongoDB 7.0, if you have [change stream](/docs/manual/changeStreams/#std-label-changeStreams) events larger than 16 MB, you can use the new
[`$changeStreamSplitLargeEvent`](/docs/manual/reference/operator/aggregation/changeStreamSplitLargeEvent/#mongodb-pipeline-pipe.-changeStreamSplitLargeEvent) stage to split the events into
smaller fragments.

The following new metrics report information about large change stream
events:

* [`metrics.changeStreams`](/docs/manual/reference/command/serverStatus/#mongodb-serverstatus-serverstatus.metrics.changeStreams)
* [`metrics.changeStreams.largeEventsFailed`](/docs/manual/reference/command/serverStatus/#mongodb-serverstatus-serverstatus.metrics.changeStreams.largeEventsFailed)
* [`metrics.changeStreams.largeEventsSplit`](/docs/manual/reference/command/serverStatus/#mongodb-serverstatus-serverstatus.metrics.changeStreams.largeEventsSplit)
### serverStatus Output Change

[`serverStatus`](/docs/manual/reference/command/serverStatus/#mongodb-dbcommand-dbcmd.serverStatus) includes the following new fields in its
output:

Plan Cache Metrics

* [`planCache`](/docs/manual/reference/command/serverStatus/#mongodb-serverstatus-serverstatus.planCache)
queryAnalyzer Metrics

* [`queryAnalyzers.activeCollections`](/docs/manual/reference/command/serverStatus/#mongodb-serverstatus-serverstatus.queryAnalyzers.activeCollections)
* [`queryAnalyzers.totalCollections`](/docs/manual/reference/command/serverStatus/#mongodb-serverstatus-serverstatus.queryAnalyzers.totalCollections)
* [`queryAnalyzers.totalSampledReadsCount`](/docs/manual/reference/command/serverStatus/#mongodb-serverstatus-serverstatus.queryAnalyzers.totalSampledReadsCount)
* [`queryAnalyzers.totalSampledWritesCount`](/docs/manual/reference/command/serverStatus/#mongodb-serverstatus-serverstatus.queryAnalyzers.totalSampledWritesCount)
* [`queryAnalyzers.totalSampledReadsBytes`](/docs/manual/reference/command/serverStatus/#mongodb-serverstatus-serverstatus.queryAnalyzers.totalSampledReadsBytes)
* [`queryAnalyzers.totalSampledWritesBytes`](/docs/manual/reference/command/serverStatus/#mongodb-serverstatus-serverstatus.queryAnalyzers.totalSampledWritesBytes)
### Slot-Based Query Execution Engine

Starting in MongoDB 7.0, the [slot-based query execution engine](/docs/manual/reference/sbe/#std-label-sbe-landing) improves
performance for a wider range of find and aggregation queries.

[Slow query log messages](/docs/manual/reference/log-messages/#std-label-log-message-json-examples-slow-op) now
include a `queryFramework` field that indicates which query engine
completed the query:

* `queryFramework: "classic"` indicates that the classic engine
  completed the query.
* `queryFramework: "sbe"` indicates that the slot-based query execution engine completed the
  query.
### User Roles System Variable

Starting in MongoDB 7.0, you can use the new [`USER_ROLES`](/docs/manual/reference/aggregation-variables/#mongodb-variable-variable.USER_ROLES)
system variable to return the [roles](/docs/manual/core/authorization/#std-label-roles) of the current user.

For use cases that include `USER_ROLES`, see the [find](/docs/manual/reference/method/db.collection.find/#std-label-find-user-roles-system-variable-example), [aggregation](/docs/manual/reference/operator/aggregation/setIntersection/#std-label-setIntersection-user-roles-system-variable-example), [view](/docs/manual/core/views/create-view/#std-label-create-view-user-roles-system-variable-example), [updateOne](/docs/manual/reference/method/db.collection.updateOne/#std-label-updateOne-example-user-roles-system-variable), [updateMany](/docs/manual/reference/method/db.collection.updateMany/#std-label-updateMany-example-user-roles-system-variable), and
[findAndModify](/docs/manual/reference/method/db.collection.findAndModify/#std-label-findAndModify-example-user-roles-system-variable)
examples.

### New Sharding Statistics for Chunk Migrations

Available starting in MongoDB 7.1 (and 7.0, 6.3.2, 6.0.6, and 5.0.18).

MongoDB includes the following new sharding statistics for chunk
migrations:

* [`shardingStatistics.countDonorMoveChunkCommitted`](/docs/manual/reference/command/serverStatus/#mongodb-serverstatus-serverstatus.shardingStatistics.countDonorMoveChunkCommitted)
* [`shardingStatistics.countDonorMoveChunkAborted`](/docs/manual/reference/command/serverStatus/#mongodb-serverstatus-serverstatus.shardingStatistics.countDonorMoveChunkAborted)
* [`shardingStatistics.totalDonorMoveChunkTimeMillis`](/docs/manual/reference/command/serverStatus/#mongodb-serverstatus-serverstatus.shardingStatistics.totalDonorMoveChunkTimeMillis)
* [`shardingStatistics.countBytesClonedOnRecipient`](/docs/manual/reference/command/serverStatus/#mongodb-serverstatus-serverstatus.shardingStatistics.countBytesClonedOnRecipient)
* [`shardingStatistics.countDocsClonedOnCatchUpOnRecipient`](/docs/manual/reference/command/serverStatus/#mongodb-serverstatus-serverstatus.shardingStatistics.countDocsClonedOnCatchUpOnRecipient)
* [`shardingStatistics.countBytesClonedOnCatchUpOnRecipient`](/docs/manual/reference/command/serverStatus/#mongodb-serverstatus-serverstatus.shardingStatistics.countBytesClonedOnCatchUpOnRecipient)
### New Slow Query Log Message

Starting in MongoDB 7.0 (and 6.0.13, 5.0.24), the
`totalOplogSlotDurationMicros` in the slow query log message shows the
time between a write operation getting a commit timestamp to commit the
storage engine writes and actually committing. `mongod` supports
parallel writes. However, it commits write operations with commit
timestamps in any order.

To learn more, see [Logging Slow Operations.](/docs/manual/reference/log-messages/#std-label-log-message-slow-ops)

### New Parameters

#### analyzeShardKey-related Parameters

MongoDB 7.0 adds the following parameters related to the
`analyzeShardKey` command:

* [`analyzeShardKeyCharacteristicsDefaultSampleSize`](/docs/manual/reference/parameters/#mongodb-parameter-param.analyzeShardKeyCharacteristicsDefaultSampleSize)
* [`analyzeShardKeyNumMostCommonValues`](/docs/manual/reference/parameters/#mongodb-parameter-param.analyzeShardKeyNumMostCommonValues)
* [`analyzeShardKeyNumRanges`](/docs/manual/reference/parameters/#mongodb-parameter-param.analyzeShardKeyNumRanges)
* [`analyzeShardKeyMonotonicityCorrelationCoefficientThreshold`](/docs/manual/reference/parameters/#mongodb-parameter-param.analyzeShardKeyMonotonicityCorrelationCoefficientThreshold)
#### autoMergerIntervalSecs Parameter

MongoDB 7.0 adds the [`autoMergerIntervalSecs`](/docs/manual/reference/parameters/#mongodb-parameter-param.autoMergerIntervalSecs) parameter
which, when AutoMerger is enabled, specifies the amount of
time between automerging rounds, in seconds.
`autoMergerIntervalSecs` can only be set on config servers of sharded
clusters.

#### autoMergerThrottlingMS Parameter

MongoDB 7.0 adds the [`autoMergerThrottlingMS`](/docs/manual/reference/parameters/#mongodb-parameter-param.autoMergerThrottlingMS) which, when
AutoMerger is enabled, specifies the minimum amount time
between merges initiated by the AutoMerger on the same
collection, in milliseconds. `autoMergerThrottlingMS` can only be set
on config servers of sharded clusters.

#### balancerMigrationsThrottlingMs Parameter

MongoDB 7.0 adds the [`balancerMigrationsThrottlingMs`](/docs/manual/reference/parameters/#mongodb-parameter-param.balancerMigrationsThrottlingMs)
parameter which allows you to throttle the balancing rate.

#### enableDetailedConnectionHealthMetricLogLines Parameter

MongoDB 7.0 adds the [`enableDetailedConnectionHealthMetricLogLines`](/docs/manual/reference/parameters/#mongodb-parameter-param.enableDetailedConnectionHealthMetricLogLines)
parameter which lets you specify whether or not a set of [log messages](/docs/manual/reference/log-messages/#std-label-log-messages-ref) related to cluster connection health metrics appears in the
log.

#### `oidcIdentityProviders` Parameter

MongoDB 7.0 adds the [`oidcIdentityProviders`](/docs/manual/reference/parameters/#mongodb-parameter-param.oidcIdentityProviders) parameter which allows
you to specify identity provider (IDP) configurations when using
[OpenID Connect](/docs/manual/core/oidc/security-oidc/#std-label-authentication-oidc) authentication.

#### configureQueryAnalysis-related Parameters

MongoDB 7.0 adds the following parameters related to the
`configureQueryAnalysis` command:

* [`queryAnalysisSamplerConfigurationRefreshSecs`](/docs/manual/reference/parameters/#mongodb-parameter-param.queryAnalysisSamplerConfigurationRefreshSecs)
* [`queryAnalysisWriterIntervalSecs`](/docs/manual/reference/parameters/#mongodb-parameter-param.queryAnalysisWriterIntervalSecs)
* [`queryAnalysisWriterMaxMemoryUsageBytes`](/docs/manual/reference/parameters/#mongodb-parameter-param.queryAnalysisWriterMaxMemoryUsageBytes)
* [`queryAnalysisWriterMaxBatchSize`](/docs/manual/reference/parameters/#mongodb-parameter-param.queryAnalysisWriterMaxBatchSize)
* [`queryAnalysisSampleExpirationSecs`](/docs/manual/reference/parameters/#mongodb-parameter-param.queryAnalysisSampleExpirationSecs)
## Security

### Queryable Encryption General Availability

Starting in MongoDB 7.0, [Queryable Encryption with equality
queries](/docs/manual/core/queryable-encryption/#std-label-qe-manual-feature-qe) is generally available (GA).
Improvements in the GA make it incompatible with the
Queryable Encryption Public Preview, which should not be used now that the feature is GA.
For details, see [Compatibility Changes in MongoDB 7.0.](/docs/manual/release-notes/7.0-compatibility/#std-label-7.0-compatibility)

### KMIP 1.0 and 1.1 Support

MongoDB 7.0 (and 6.0.6) adds the [`useLegacyProtocol`](/docs/manual/reference/configuration-options/#mongodb-setting-security.kmip.useLegacyProtocol) setting. This setting allows MongoDB
servers to connect to KMIP servers that use KMIP protocol version 1.0 or
1.1.

#### OpenSSL and FIPS Support

Starting in MongoDB 7.0 and 6.0.7, MongoDB supports OpenSSL 3.0 and the
OpenSSL FIPS provider with these operating systems:

* Red Hat Enterprise Linux 9
* Amazon Linux 2023
* Ubuntu Linux 22.04

Starting in MongoDB 8.0, MongoDB supports OpenSSL 3.0 and the OpenSSL
FIPS provider for Amazon Linux 2023.3.

For details, see [TLS/SSL (Transport Encryption).](/docs/manual/core/security-transport-encryption/#std-label-transport-encryption)

#### OpenID Connect

Starting in 7.0, MongoDB Enterprise provides support for
[OpenID Connect](/docs/manual/core/oidc/security-oidc/#std-label-authentication-oidc) authentication. OpenID Connect is an
authentication layer built on top of OAuth2. You can use OpenID Connect to
configure single sign-on between your MongoDB database and a third-party identity
provider.

## Aggregation

New operators:

| Name | Description |
| --- | --- |
| [`$median`](/docs/manual/reference/operator/aggregation/median/#mongodb-group-grp.-median) | Returns an approximation of the [median](/docs/manual/reference/glossary/#std-term-median), the 50th [percentile](/docs/manual/reference/glossary/#std-term-percentile), as a scalar value.  This operator can be used as an accumulator and as an aggregation expression. |
| [`$percentile`](/docs/manual/reference/operator/aggregation/percentile/#mongodb-group-grp.-percentile) | Returns an array of scalar values that correspond to specified [percentile](/docs/manual/reference/glossary/#std-term-percentile) values.  This operator can be used as an accumulator and as an aggregation expression. |

### Month Name Specifier for $dateToString

MongoDB 7.0 adds the following format specifiers to use with the
[`$dateToString`](/docs/manual/reference/operator/aggregation/dateToString/#mongodb-expression-exp.-dateToString) operator:

| Specifiers | Description | Possible Values |
| --- | --- | --- |
| `%b` | Abbreviated month name (3 letters) | `jan`-`dec` |
| `%B` | Full month name | `january`-`december` |

## Time Series

MongoDB 7.0 removes most of the time series limitations from these
operations that are based on the [`delete`](/docs/manual/reference/command/delete/#mongodb-dbcommand-dbcmd.delete) command:

* [`delete`](/docs/manual/reference/command/delete/#mongodb-dbcommand-dbcmd.delete)
* [`deleteOne()`](/docs/manual/reference/method/db.collection.deleteOne/#mongodb-method-db.collection.deleteOne)
* [`deleteMany()`](/docs/manual/reference/method/db.collection.deleteMany/#mongodb-method-db.collection.deleteMany)
* [`Bulk.find.delete()`](/docs/manual/reference/method/Bulk.find.delete/#mongodb-method-Bulk.find.delete)
* [`Bulk.find.deleteOne()`](/docs/manual/reference/method/Bulk.find.deleteOne/#mongodb-method-Bulk.find.deleteOne)

## Sharding

### Sharding Metadata Diagnostics

Starting in MongoDB 7.0, the [`checkMetadataConsistency`](/docs/manual/reference/command/checkMetadataConsistency/#mongodb-dbcommand-dbcmd.checkMetadataConsistency) command
is available to check sharding metadata at the cluster, database, and
collection levels for inconsistencies. These inconsistencies can originate
in cases such as:

* Upgrades in cases where the cluster encountered a bug while running previous
  releases of MongoDB
* Manual interventions that corrupt the cluster catalog

The following helper methods are now available through [`mongosh`:](https://www.mongodb.com/docs/mongodb-shell/#std-program-mongosh)

* [`db.checkMetadataConsistency()`](/docs/manual/reference/method/db.checkMetadataConsistency/#mongodb-method-db.checkMetadataConsistency)
* [`db.collection.checkMetadataConsistency()`](/docs/manual/reference/method/db.collection.checkMetadataConsistency/#mongodb-method-db.collection.checkMetadataConsistency)
* [`sh.checkMetadataConsistency()`](/docs/manual/reference/method/sh.checkMetadataConsistency/#mongodb-method-sh.checkMetadataConsistency)

For more information on the inconsistencies the command checks for, see
[Inconsistency Types.](/docs/manual/reference/inconsistency-type/#std-label-inconsistency-types)

### mergeAllChunksOnShard Command

Starting in MongoDB 7.0, the [`mergeAllChunksOnShard`](/docs/manual/reference/command/mergeAllChunksOnShard/#mongodb-dbcommand-dbcmd.mergeAllChunksOnShard) command
finds and merges all [mergeable chunks](/docs/manual/reference/command/mergeAllChunksOnShard/#std-label-mergeability) that a shard
owns for a given collection.

### The AutoMerger

Starting in MongoDB 7.0, [the AutoMerger](/docs/manual/core/automerger-concept/#std-label-automerger-concept) can automatically merge chunks that meet the
[mergeability requirements](/docs/manual/core/automerger-concept/#std-label-mergeability-concept). The
AutoMerger is enabled by default.

Starting in MongoDB 7.0, you can use the following methods to control
the AutoMerger behavior:

* [`sh.startAutoMerger()`](/docs/manual/reference/method/sh.startAutoMerger/#mongodb-method-sh.startAutoMerger)
* [`sh.stopAutoMerger()`](/docs/manual/reference/method/sh.stopAutoMerger/#mongodb-method-sh.stopAutoMerger)
* [`sh.enableAutoMerger()`](/docs/manual/reference/method/sh.enableAutoMerger/#mongodb-method-sh.enableAutoMerger)
* [`sh.disableAutoMerger()`](/docs/manual/reference/method/sh.disableAutoMerger/#mongodb-method-sh.disableAutoMerger)
### enableAutoMerger Parameter for configureCollectionBalancing

Starting in MongoDB 7.0, the [`configureCollectionBalancing`](/docs/manual/reference/command/configureCollectionBalancing/#mongodb-dbcommand-dbcmd.configureCollectionBalancing)
command accepts the `enableAutoMerger` parameter. Use
`enableAutoMerger` to set whether or not the
[AutoMerger](/docs/manual/core/automerger-concept/#std-label-automerger-concept) takes this collection
into account.

### operationsBlockedByRefresh Metrics Removed

MongoDB 7.0 removes the `operationsBlockedByRefresh` document that
contains statistics about operations blocked by catalog cache refresh
activity because the `operationsBlockedByRefresh` counters increased
on `mongos` for every operation that used collection routing
information even if the operation wasn't blocked by a catalog refresh
activity.

### analyzeShardKey Command and db.collection.analyzeShardKey() Method

MongoDB 7.0 adds the [`analyzeShardKey`](/docs/manual/reference/command/analyzeShardKey/#mongodb-dbcommand-dbcmd.analyzeShardKey) command and the
[`db.collection.analyzeShardKey()`](/docs/manual/reference/method/db.collection.analyzeShardKey/#mongodb-method-db.collection.analyzeShardKey) method, which let you
calculate metrics for evaluating a shard key.

### configureQueryAnalyzer Command and db.collection.configureQueryAnalyzer() Method

MongoDB 7.0 adds the [`configureQueryAnalyzer`](/docs/manual/reference/command/configureQueryAnalyzer/#mongodb-dbcommand-dbcmd.configureQueryAnalyzer) command, which
allows you to configure query sampling for a collection. MongoDB 7.0
also adds the [`db.collection.configureQueryAnalyzer()`](/docs/manual/reference/method/db.collection.configureQueryAnalyzer/#mongodb-method-db.collection.configureQueryAnalyzer), which
wraps the `configureQueryAnalyzer` command. Sampled queries provide
information to `analyzeShardKey` to calculate metrics about read and
write distribution of a shard key.

## Changes Introduced in 6.X-Series Rapid Releases

MongoDB 7.0 includes changes and features from the following Rapid
Release versions:

* [MongoDB 6.1 Release Notes](https://www.mongodb.com/docs/v6.1/release-notes/)
* [MongoDB 6.2 Release Notes](https://www.mongodb.com/docs/v6.2/release-notes/)
* [MongoDB 6.3 Release Notes](https://www.mongodb.com/docs/v6.3/release-notes/)

## Platform Support

### Removed Platforms

MongoDB 7.0 removes support for **RHEL 7 / CentOS 7 / Oracle 7** on the
[PPC64LE](/docs/manual/administration/production-notes/#std-label-prod-notes-supported-platforms-PPC64LE) and [s390x](/docs/manual/administration/production-notes/#std-label-prod-notes-supported-platforms-s390x) architectures.

## Upgrade Procedures

## Important

### **Feature Compatibility Version**

To upgrade to MongoDB 7.0 from a 6.0 deployment, the 6.0 deployment
must have `featureCompatibilityVersion` set to `6.0`. To check
the version:

```

| db.adminCommand( { getParameter: 1, featureCompatibilityVersion: 1 } ) |
| --- |

```

To upgrade to MongoDB 7.0, refer to the upgrade instructions specific to
your MongoDB deployment:

* [Upgrade a Standalone to 7.0](/docs/manual/release-notes/7.0-upgrade-standalone/#std-label-7.0-upgrade-standalone)
* [Upgrade a Replica Set to 7.0](/docs/manual/release-notes/7.0-upgrade-replica-set/#std-label-7.0-upgrade-replica-set)
* [Upgrade a Sharded Cluster to 7.0](/docs/manual/release-notes/7.0-upgrade-sharded-cluster/#std-label-7.0-upgrade-sharded-cluster)

If you need guidance on upgrading to 7.0, MongoDB professional services
offer major version upgrade support to help ensure a smooth transition
without interruption to your MongoDB application. To learn more, see
[MongoDB Consulting.](https://www.mongodb.com/products/consulting?tck=docs_server)

## Downgrade Considerations

### Only Single-Version Downgrades are Supported

MongoDB only supports single-version downgrades. You cannot downgrade to a
release that is multiple versions behind your current release.

For example, you may downgrade a 7.0-series to a 6.0-series deployment.
However, further downgrading that 6.0-series deployment to a 5.0-series
deployment is not supported.

### Downgrade Policy Changes

Starting in MongoDB 7.0:

* Binary downgrades are no longer supported for MongoDB Community Edition.
* You cannot downgrade your deployment's FCV to or from a
  [rapid release](/docs/manual/reference/versioning/#std-label-rapid-releases) version of MongoDB.
* The [`setFeatureCompatibilityVersion`](/docs/manual/reference/command/setFeatureCompatibilityVersion/#mongodb-dbcommand-dbcmd.setFeatureCompatibilityVersion) command requires an
  additional parameter, `confirm`, which must be set to `true` to
  upgrade or downgrade FCV.
* If you upgrade or downgrade your deployment's FCV, you cannot
  downgrade your Enterprise deployment's binary version without assistance from
  support.
### Backward-Incompatible Features

MongoDB 7.0 includes features that are not compatible with earlier releases.
Downgrading from 7.0 to an earlier release requires that you remove data
that uses these features.

For more information, see [Backward-Incompatible Features.](/docs/manual/release-notes/7.0-compatibility/#std-label-7.0-downgrade-incompatible)

## Download

To download MongoDB 7.0, go to the [MongoDB Download Center.](https://www.mongodb.com/try/download?tck=docs_server)

## Report an Issue

To report an issue, see the [MongoDB GitHub repository](https://github.com/mongodb/mongo/wiki/Submit-Bug-Reports) for
instructions on how to file a JIRA ticket for the MongoDB server or one
of the related projects.

[Back

Changelog](/docs/manual/release-notes/8.0-changelog/ "Previous Section")[Next

Compatibility Changes](/docs/manual/release-notes/7.0-compatibility/ "Next Section")

On this page

* [Patch Releases](#patch-releases)
* [Atlas Search Index Management](#atlas-search-index-management)
* [General Changes](#general-changes)
* [Security](#security)
* [Aggregation](#aggregation)
* [Time Series](#time-series)
* [Sharding](#sharding)
* [Changes Introduced in 6.X-Series Rapid Releases](#changes-introduced-in-6.x-series-rapid-releases)
* [Platform Support](#platform-support)
* [Upgrade Procedures](#upgrade-procedures)
* [Downgrade Considerations](#downgrade-considerations)
* [Download](#download)
* [Report an Issue](#report-an-issue)


