- **Root cause of vulnerability:** The `DetranCLI` binary in Siretta QUARTZ-GOLD devices uses `sprintf` to format strings based on user-provided input without checking the size of the input against the destination buffer, leading to stack-based buffer overflows.
- **Weaknesses/vulnerabilities present:** Stack-based buffer overflows exist in multiple command parsing functions within the `DetranCLI` binary due to improper usage of `sprintf`. The size of the input is not validated against the buffer size before being written to memory
- **Impact of exploitation:** Successful exploitation of the buffer overflows can lead to arbitrary command execution on the affected device.
- **Attack vectors:** An attacker can send specially-crafted network packets to trigger the vulnerable commands in `DetranCLI`.
- **Required attacker capabilities/position:** The attacker needs to be able to send network packets to the device and have the ability to execute commands using `DetranCLI`. The CVSS score indicates that high privileges are required (PR:H).

Specifically for **CVE-2022-41029**:
- The vulnerability lies within the `wlan filter mac address` command.
- The vulnerable code:
  ```c
    sprintf(buff_0x20,"%s%s%s%s%s%s<%s",octet_from_argv0[0],octet_from_argv0[1],octet_from_argv0[2],octet_from_argv0[3],octet_from_argv0[4],octet_from_argv0[5],argv[1]);
  ```
- A buffer of size 0x20 is filled using `sprintf` where the last argument `argv[1]` which is derived from user input is not checked for length.