

[![The Daily Swig](/content/images/banners/the-daily-swig-logo.svg)](/daily-swig)

Latest threats

Bug bounty

For devs

Deep dives

More

[About](https://portswigger.net/daily-swig/about)
[Web security vulnerabilities](https://portswigger.net/daily-swig/vulnerabilities)
[Network security vulnerabilities](https://portswigger.net/daily-swig/network-security)
[Cloud security](https://portswigger.net/daily-swig/cloud-security)
[Zero-day news](https://portswigger.net/daily-swig/zero-day)
[Supply chain attacks](https://portswigger.net/daily-swig/supply-chain-attacks)

[View all web security news](https://portswigger.net/daily-swig/vulnerabilities)

[**Prototype pollution**

Prototype pollution project yields another Parse Server RCE

![Prototype-pollution](/daily-swig-mega-nav/images/latestthreats.png)](https://portswigger.net/daily-swig/prototype-pollution-project-yields-another-parse-server-rce)

[Bug bounty news](https://portswigger.net/daily-swig/bug-bounty)
[VDPs](https://portswigger.net/daily-swig/vdp)
[Bug Bounty Radar](https://portswigger.net/daily-swig/bug-bounty-radar)

[View all bug bounty news](https://portswigger.net/daily-swig/bug-bounty)

[**Bug Bounty Radar**

The latest programs for February 2023

![Bug bounties](/daily-swig-mega-nav/images/bug-bounties.png)](https://portswigger.net/daily-swig/bug-bounty-radar-the-latest-bug-bounty-programs-for-february-2023)

[DevSecOps](https://portswigger.net/daily-swig/devsecops)
[Security best practices](https://portswigger.net/daily-swig/security-best-practices)
[Dev stack tech](https://portswigger.net/daily-swig/dev-stack-tech)

[View all dev related news](https://portswigger.net/daily-swig/devsecops)

[**All Day DevOps**

AppSec engineer keynote says Log4j revealed lessons were not learned from the Equifax breach

![DevOps](/daily-swig-mega-nav/images/devsecops.png)](https://portswigger.net/daily-swig/all-day-devops-third-of-log4j-downloads-still-pull-vulnerable-version-despite-threat-of-supply-chain-attacks)

[Deep dives](https://portswigger.net/daily-swig/deep-dives)
[Interviews](https://portswigger.net/daily-swig/interviews)

[View all of the latest features](https://portswigger.net/daily-swig/deep-dives)

[**Infosec beginner?**

A rough guide to launching a career in cybersecurity

![cyber-career](/daily-swig-mega-nav/images/deepdives.png)](https://portswigger.net/daily-swig/a-rough-guide-to-launching-a-career-in-cybersecurity)

[Industry news](https://portswigger.net/daily-swig/industry-news)
[Enterprise security news](https://portswigger.net/daily-swig/enterprise)
[Web hacking tools](https://portswigger.net/daily-swig/hacking-tools)
[Events](https://portswigger.net/daily-swig/events)

[View all infosec industry news](https://portswigger.net/daily-swig/industry-news)

[**Cybersecurity conferences**

A schedule of events in 2022 and beyond

![More topics](/daily-swig-mega-nav/images/more-topics.jpg)](https://portswigger.net/daily-swig/cybersecurity-conferences-a-rundown-of-online-in-person-and-hybrid-events)

# WAF bypass: ‘Severe’ OWASP ModSecurity Core Rule Set bug was present for several years

[Jessica Haworth-Elsayed](/daily-swig/by/jessica-haworth-elsayed)
05 July 2021 at 12:31 UTC

Updated: 06 July 2021 at 08:47 UTC

[Industry News](/daily-swig/industry-news)
[Vulnerabilities](/daily-swig/vulnerabilities)
[Open Source Software](/daily-swig/open-source-software)

[Twitter](https://twitter.com/share?url=https%3a%2f%2fportswigger.net%2fdaily-swig%2fwaf-bypass-severe-owasp-modsecurity-core-rule-set-bug-was-present-for-several-years&text=WAF+bypass%3a+%e2%80%98Severe%e2%80%99+OWASP+ModSecurity+Core+Rule+Set+bug+was+present+for+several+years+%7c+The+Daily+Swig%0A)
[WhatsApp](https://api.whatsapp.com/send?text=https%3a%2f%2fportswigger.net%2fdaily-swig%2fwaf-bypass-severe-owasp-modsecurity-core-rule-set-bug-was-present-for-several-years)
[Facebook](https://www.facebook.com/sharer.php?u=https%3a%2f%2fportswigger.net%2fdaily-swig%2fwaf-bypass-severe-owasp-modsecurity-core-rule-set-bug-was-present-for-several-years)
[Reddit](https://reddit.com/submit?url=https%3a%2f%2fportswigger.net%2fdaily-swig%2fwaf-bypass-severe-owasp-modsecurity-core-rule-set-bug-was-present-for-several-years)
[LinkedIn](https://www.linkedin.com/sharing/share-offsite?url=https%3a%2f%2fportswigger.net%2fdaily-swig%2fwaf-bypass-severe-owasp-modsecurity-core-rule-set-bug-was-present-for-several-years)
Email

High-scoring bug went unnoticed due to time and money constraints

![A vulnerability in the OWASP ModSecurity Core Rule Set (CRS) project that could allow attackers to bypass security mechanisms was present for several years](/cms/images/43/9c/ebe2-article-210705-waf-body-text.jpg "Image: KLSS / Shutterstock")

A [vulnerability](https://portswigger.net/daily-swig/vulnerabilities) in the OWASP ModSecurity Core Rule Set (CRS) project that could allow attackers to bypass security mechanisms was present for several years, the maintainers have admitted.

The bug – tracked as CVE-2021-35368 – bypasses the security protections offered by the in-built CRS web application firewall (WAF), an advisory warns.

This means that malicious request body payloads are able to pass the rule set without being inspected, due to a combination of two bugs in the CRS Drupal rule exclusion package.

The vulnerability is not limited to Drupal installations, however, but is present in every CRS installation that includes these rule exclusions – regardless of whether they are enabled or not.

### Backend weaknesses exposed

The risk to websites depends on their ModSecurity configuration, [a write-up details](https://coreruleset.org/20210630/cve-2021-35368-crs-request-body-bypass/).

“If the backend is broken and configured with the correct trailing pathname information setting… then anything is possible. If the backend looks into the trailing path info as it should, then you are on the safe side,” it reads.

Christian Folini, co-lead of the volunteer-led Core Rule Set project, told The Daily Swig that the flaw has “been around for several years”.

“When we did the early rule exclusion packages in 2016 and 2017 we were not really used to the rule writing techniques that we had to employ,” Folini explained.

YOU MAY LIKE [CVE board slams Distributed Weakness Filing project for publishing ‘unauthorized’ CVE records](https://portswigger.net/daily-swig/cve-board-slams-distributed-weakness-filing-project-for-publishing-unauthorized-cve-records)

“Also [there were] no coding guidelines. And as we [have come] to realize now, nobody has really reviewed this part of the code in the meantime, probably also thanks to the misconception that bugs within the rule exclusion packages would have limited impact since they are disabled by default.

“In retrospect, the failure is obvious. The important part now is learning our lesson and adopting our [development](https://portswigger.net/daily-swig/secure-development) and review process to avoid such failures in the future.”

### A deeper look

The flaw was discovered and reported by Andrew Howe from Loadbalancer.org, who reviewed the ModSecurity engine last year, Folini said.

Howe reported the two bugs in the CRS in June. All known CRS installations that offer the predefined CRS rule exclusion packages are affected. This also applies to end-of-life CRS versions 3.0.x, 3.1.0, 3.1.1, as well as the currently supported versions 3.2.0 and 3.3.0.

Integrators and users are advised to upgrade to 3.1.2, 3.2.1, and 3.3.2, respectively.

Discussing the challenges faced by a volunteer-led project such as CRS, Folini pinpointed a lack of [financial](https://portswigger.net/daily-swig/financial) support as a key barrier.

 [Readmore of the latest open source software security news](https://portswigger.net/daily-swig/open-source-software)

Folini said: “[Open source](https://portswigger.net/daily-swig/open-source-software) is not inherently more secure than closed source – it just means that people can look at the code. Yet the security advantage can only play out when people actually do look at the code, like Andrew Howe did.

“If we have these reviews, then the inherent transparency of an open source project will bring an advantage over traditional software, namely in the security domain where users really want to see what is going deep down in their software.

“Open source projects also tend to be more open about their shortcomings so they are often able to build up more trust and confidence with their user base. A commercial project is often tempted to avoid bad press by keeping a problem under the rug, or hiding a fix in the changelog.”

MUST READ [Moving security forward by looking back](https://portswigger.net/daily-swig/moving-security-forward-by-looking-back)

Conducting these reviews is challenging, however, since the project does not have any funds to pay people for their time.

“You could say we’re in a bit of Heartbleed situation,” said Folini, referring to [the 2014 discovery of an implementation flaw](https://heartbleed.com/) in the widely used OpenSSL cryptographic software library, which went unnoticed due (in part) to a lack of financial support.

“CRS is running on over 100 Tbit/s of traffic and most content delivery networks and [cloud providers](https://portswigger.net/daily-swig/cloud-security) have a commercial offering where they charge for CRS, yet most of them fail to contribute back to our project so far,” he explained.

Folini said that the project maintainers have contacted the [organizations](https://portswigger.net/daily-swig/organizations) using CRS, and are calling for help from the “big players”.

“Convincing a commercial company from sponsoring something they can get for free is a hard sell,” he explained.

“Yet we have subscribed the first real sponsors in 2021 and I hope that the big players will join them.

“We have a lot of plans where to take our project, yet many of them are on hold until we find the money and resources to implement them.”

YOU MAY ALSO LIKE [Many Hats Club founder announces closure – spelling end for podcast, conference, Discord community](https://portswigger.net/daily-swig/many-hats-club-founder-announces-closure-spelling-end-for-podcast-conference-discord-community)

[Industry News](/daily-swig/industry-news)
[Vulnerabilities](/daily-swig/vulnerabilities)
[Open Source Software](/daily-swig/open-source-software)
[Secure Development](/daily-swig/secure-development)
[DevSecOps](/daily-swig/devsecops)
[DevOps](/daily-swig/devops)
[TLS](/daily-swig/tls)

![Jessica Haworth-Elsayed](/cms/profiles/jessica-haworth-elsayed.png)
[Twitter](https://twitter.com/share?url=https%3a%2f%2fportswigger.net%2fdaily-swig%2fwaf-bypass-severe-owasp-modsecurity-core-rule-set-bug-was-present-for-several-years&text=WAF+bypass%3a+%e2%80%98Severe%e2%80%99+OWASP+ModSecurity+Core+Rule+Set+bug+was+present+for+several+years+%7c+The+Daily+Swig%0A)
[WhatsApp](https://api.whatsapp.com/send?text=https%3a%2f%2fportswigger.net%2fdaily-swig%2fwaf-bypass-severe-owasp-modsecurity-core-rule-set-bug-was-present-for-several-years)
[Facebook](https://www.facebook.com/sharer.php?u=https%3a%2f%2fportswigger.net%2fdaily-swig%2fwaf-bypass-severe-owasp-modsecurity-core-rule-set-bug-was-present-for-several-years)
[Reddit](https://reddit.com/submit?url=https%3a%2f%2fportswigger.net%2fdaily-swig%2fwaf-bypass-severe-owasp-modsecurity-core-rule-set-bug-was-present-for-several-years)
[LinkedIn](https://www.linkedin.com/sharing/share-offsite?url=https%3a%2f%2fportswigger.net%2fdaily-swig%2fwaf-bypass-severe-owasp-modsecurity-core-rule-set-bug-was-present-for-several-years)
Email

This page requires JavaScript for an enhanced user experience.

Latest Posts
[### We’re going teetotal – It’s goodbye to The Daily Swig

02 March 2023
We’re going teetotal – It’s goodbye to The Daily Swig
PortSwigger today announces that The Daily Swig is closing down](/daily-swig/were-going-teetotal-its-goodbye-to-the-daily-swig)
[### Bug Bounty Radar

The latest bug bounty programs for March 2023
28 February 2023
Bug Bounty Radar
The latest bug bounty programs for March 2023](/daily-swig/bug-bounty-radar-the-latest-bug-bounty-programs-for-march-2023)
[### Indian gov flaws allowed creation of counterfeit driving licenses

28 February 2023
Indian gov flaws allowed creation of counterfeit driving licenses
Armed with personal data fragments, a researcher could also access 185 million citizens’ PII](/daily-swig/indian-transport-ministry-flaws-potentially-allowed-creation-of-counterfeit-driving-licenses)

Burp Suite

[Web vulnerability scanner](/burp/vulnerability-scanner)
[Burp Suite Editions](/burp)
[Release Notes](/burp/releases)

Vulnerabilities

[Cross-site scripting (XSS)](/web-security/cross-site-scripting)
[SQL injection](/web-security/sql-injection)
[Cross-site request forgery](/web-security/csrf)
[XML external entity injection](/web-security/xxe)
[Directory traversal](/web-security/file-path-traversal)
[Server-side request forgery](/web-security/ssrf)

Customers

[Organizations](/organizations)
[Testers](/testers)
[Developers](/developers)

Company

[About](/about)
[Careers](/careers)
[Contact](/about/contact)
[Legal](/legal)
[Privacy Notice](/privacy)

Insights

[Web Security Academy](/web-security)
[Blog](/blog)
[Research](/research)

[![PortSwigger Logo](/content/images/logos/portswigger-logo.svg)](/)
 [Follow us](https://twitter.com/Burp_Suite)

© 2025 PortSwigger Ltd.

