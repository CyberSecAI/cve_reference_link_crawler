

[![The Daily Swig](/content/images/banners/the-daily-swig-logo.svg)](/daily-swig)

Latest threats

Bug bounty

For devs

Deep dives

More

[About](https://portswigger.net/daily-swig/about)
[Web security vulnerabilities](https://portswigger.net/daily-swig/vulnerabilities)
[Network security vulnerabilities](https://portswigger.net/daily-swig/network-security)
[Cloud security](https://portswigger.net/daily-swig/cloud-security)
[Zero-day news](https://portswigger.net/daily-swig/zero-day)
[Supply chain attacks](https://portswigger.net/daily-swig/supply-chain-attacks)

[View all web security news](https://portswigger.net/daily-swig/vulnerabilities)

[**Prototype pollution**

Prototype pollution project yields another Parse Server RCE

![Prototype-pollution](/daily-swig-mega-nav/images/latestthreats.png)](https://portswigger.net/daily-swig/prototype-pollution-project-yields-another-parse-server-rce)

[Bug bounty news](https://portswigger.net/daily-swig/bug-bounty)
[VDPs](https://portswigger.net/daily-swig/vdp)
[Bug Bounty Radar](https://portswigger.net/daily-swig/bug-bounty-radar)

[View all bug bounty news](https://portswigger.net/daily-swig/bug-bounty)

[**Bug Bounty Radar**

The latest programs for February 2023

![Bug bounties](/daily-swig-mega-nav/images/bug-bounties.png)](https://portswigger.net/daily-swig/bug-bounty-radar-the-latest-bug-bounty-programs-for-february-2023)

[DevSecOps](https://portswigger.net/daily-swig/devsecops)
[Security best practices](https://portswigger.net/daily-swig/security-best-practices)
[Dev stack tech](https://portswigger.net/daily-swig/dev-stack-tech)

[View all dev related news](https://portswigger.net/daily-swig/devsecops)

[**All Day DevOps**

AppSec engineer keynote says Log4j revealed lessons were not learned from the Equifax breach

![DevOps](/daily-swig-mega-nav/images/devsecops.png)](https://portswigger.net/daily-swig/all-day-devops-third-of-log4j-downloads-still-pull-vulnerable-version-despite-threat-of-supply-chain-attacks)

[Deep dives](https://portswigger.net/daily-swig/deep-dives)
[Interviews](https://portswigger.net/daily-swig/interviews)

[View all of the latest features](https://portswigger.net/daily-swig/deep-dives)

[**Infosec beginner?**

A rough guide to launching a career in cybersecurity

![cyber-career](/daily-swig-mega-nav/images/deepdives.png)](https://portswigger.net/daily-swig/a-rough-guide-to-launching-a-career-in-cybersecurity)

[Industry news](https://portswigger.net/daily-swig/industry-news)
[Enterprise security news](https://portswigger.net/daily-swig/enterprise)
[Web hacking tools](https://portswigger.net/daily-swig/hacking-tools)
[Events](https://portswigger.net/daily-swig/events)

[View all infosec industry news](https://portswigger.net/daily-swig/industry-news)

[**Cybersecurity conferences**

A schedule of events in 2022 and beyond

![More topics](/daily-swig-mega-nav/images/more-topics.jpg)](https://portswigger.net/daily-swig/cybersecurity-conferences-a-rundown-of-online-in-person-and-hybrid-events)

# Lessons learned: How a severe vulnerability in the OWASP ModSecurity Core Rule Set sparked much-needed change

[Jessica Haworth-Elsayed](/daily-swig/by/jessica-haworth-elsayed)
05 November 2021 at 15:47 UTC

Updated: 05 December 2022 at 16:01 UTC

[Vulnerabilities](/daily-swig/vulnerabilities)
[WAF](/daily-swig/waf)
[DevOps](/daily-swig/devops)

[Twitter](https://twitter.com/share?url=https%3a%2f%2fportswigger.net%2fdaily-swig%2flessons-learned-how-a-severe-vulnerability-in-the-owasp-modsecurity-core-rule-set-sparked-much-needed-change&text=Lessons+learned%3a+How+a+severe+vulnerability+in+the+OWASP+ModSecurity+Core+Rule+Set+sparked+much-needed+change+%7c+The+Daily+Swig%0A)
[WhatsApp](https://api.whatsapp.com/send?text=https%3a%2f%2fportswigger.net%2fdaily-swig%2flessons-learned-how-a-severe-vulnerability-in-the-owasp-modsecurity-core-rule-set-sparked-much-needed-change)
[Facebook](https://www.facebook.com/sharer.php?u=https%3a%2f%2fportswigger.net%2fdaily-swig%2flessons-learned-how-a-severe-vulnerability-in-the-owasp-modsecurity-core-rule-set-sparked-much-needed-change)
[Reddit](https://reddit.com/submit?url=https%3a%2f%2fportswigger.net%2fdaily-swig%2flessons-learned-how-a-severe-vulnerability-in-the-owasp-modsecurity-core-rule-set-sparked-much-needed-change)
[LinkedIn](https://www.linkedin.com/sharing/share-offsite?url=https%3a%2f%2fportswigger.net%2fdaily-swig%2flessons-learned-how-a-severe-vulnerability-in-the-owasp-modsecurity-core-rule-set-sparked-much-needed-change)
Email

Years-old WAF bypass flaw was discovered in June

![Lessons learned: How a severe vulnerability in the OWASP ModSecurity Core Rule Set sparked much-needed change](/cms/images/d0/f7/440d-article-211105-modsec-body-text.png "Image: At-Scene / Shutterstock")

A severe [vulnerability](https://portswigger.net/daily-swig/vulnerabilities) present in the OWASP ModSecurity Core Rule Set (CRS) for several years was a “bang on the ear” for the project's maintainers, who have outlined steps to improve its security.

The ModSec team reported that a complete rule set bypass (CVE-2021-35368) had been discovered in June 2021. The critical bug that had been present in the software for at least four years.

As [previously reported](https://portswigger.net/daily-swig/waf-bypass-severe-owasp-modsecurity-core-rule-set-bug-was-present-for-several-years) by The Daily Swig, the vulnerability bypassed the security protections offered by the in-built CRS web application firewall (WAF), meaning that malicious request body payloads could be smuggled through without being inspected.

The issue, which was introduced in code changes 2017, has since been remediated.

However, to help reduce the likelihood of another high-impact bug slipping through the net, the CRS maintainers have implemented new practices, guidelines, and a [bug bounty](https://portswigger.net/daily-swig/bug-bounty) program to further secure the technology.

### A chance for growth

Speaking to The Daily Swig, OWASP CRS co-lead Christian Folini said that the incident was “one of the biggest bangs on the ear” for him.

He explained: “It was clearly my personal fault. I had introduced these two bugs right after our new team had taken over the dormant project in 2016. The fix was easy enough, yet I felt like hiding under a rock.”

BACKGROUND [WAF bypass: ‘Severe’ OWASP ModSecurity Core Rule Set bug was present for several years](https://portswigger.net/daily-swig/waf-bypass-severe-owasp-modsecurity-core-rule-set-bug-was-present-for-several-years)

The [team met in Switzerland last week](https://coreruleset.org/20211101/crs-developer-retreat-2021/) to formulate a plan to “improve set up and procedures”, said Folini, who admitted that the incident was an “embarrassment”.

Folini said: “We started to look at it as a chance for growth and development. Therefore, we made it a focus theme for our first CRS developer retreat – how can we prevent merging bugs? And, if we carry them, how do we detect them in our rules?”

### Beyond automated testing

Folini said that the CRS team has been slowly expanding its [DevOps](https://portswigger.net/daily-swig/devops) practices “for several years” since they took over in 2016.

However, the project is in need of “a comprehensive [application security](/burp/application-security-testing) program that goes beyond automatic testing”, according to Folini.

Addressing the issue, he told The Daily Swig that the CRS team has implemented a list of changes that will foster a more proactive approach to security.

> “We ran a workshop at our retreat and tried to come up with various measures that would form several layers of defense against any failures in our rule set. Eventually we settled on four changes:
>
> - Rule exclusion packages will become plugins
>
> - We will forbid certain constructs/directives from the rule set
>
> - We will prepare a formal checklist to review every rule, namely new ones
>
> - We will launch a bug bounty program.”

### Shrinking the attack surface

Folini explained that the bypass vulnerability was hidden in one of the rule exclusion packages, which are distributed together with the rule set.

“Even an inactive rule exclusion package could cripple the entire rule set,” he said.

“So, we want to transform these packages into plugins, leveraging the new plugin functionality that we are going to introduce with our next major release. Plugins are not installed by default, so this measure will reduce our attack surface.”

[Read more of the latest security vulnerability news](https://portswigger.net/daily-swig/vulnerabilities)

Folini told The Daily Swig that the bypass was only possible because a bad rule used a “very powerful” construct to disable request body access under certain conditions.

“What we did not realize was that an attacker could meet these conditions by abusing the PATH\_INFO part of the request URI,” he continued.

“If we forbid this and similarly powerful directives, we reduce the impact of future bugs, so this is a risk limiting measure.”

Folini also said that by introducing a formal checklist and a bug bounty program, code can be extensively reviewed, both internally and externally.

This plan does, however, contain a caveat: In order to be able to pay such bounties, the project will need to attract more sponsors.

### Lessons learned

Despite the major security headache caused by the [WAF](https://portswigger.net/daily-swig/waf) bypass vulnerability, Folini is optimistic that the lessons learned will spark much-needed change.

“Nobody likes to look like an idiot in public,” he admitted. “But it is important to take the bull by the horns.

“Going out, writing a detailed advisory, informing the big integrators directly (in advance), responding to questions from the community and reviewing your own policies and procedures are all crucial steps if you want to grow and improve.

“The whole affair also strengthened the ties within the team. We overcame this together and we know we can trust each other even when we’re in deep trouble and that’s very reassuring.

“So ultimately, I think it was a positive experience and we trust that the community appreciates how we handled this severe incident. So, it looks like we’re doing the right thing here.”

RECOMMENDED [‘Focus on brilliance at the basics’ – GitHub CSO Mike Hanley on shifting left and securing the software supply chain](https://portswigger.net/daily-swig/focus-on-brilliance-at-the-basics-github-cso-mike-hanley-on-shifting-left-and-securing-the-software-supply-chain)

[Vulnerabilities](/daily-swig/vulnerabilities)
[WAF](/daily-swig/waf)
[DevOps](/daily-swig/devops)
[DevSecOps](/daily-swig/devsecops)
[Hacking culture](/daily-swig/hacking-culture)
[Industry News](/daily-swig/industry-news)
[Secure Development](/daily-swig/secure-development)
[Interviews](/daily-swig/interviews)
[Bug Bounty](/daily-swig/bug-bounty)
[Europe](/daily-swig/europe)
[Open Source Software](/daily-swig/open-source-software)
[Switzerland](/daily-swig/switzerland)
[Network Security](/daily-swig/network-security)
[Database Security](/daily-swig/database-security)
[Cloud Security](/daily-swig/cloud-security)

![Jessica Haworth-Elsayed](/cms/profiles/jessica-haworth-elsayed.png)
[Twitter](https://twitter.com/share?url=https%3a%2f%2fportswigger.net%2fdaily-swig%2flessons-learned-how-a-severe-vulnerability-in-the-owasp-modsecurity-core-rule-set-sparked-much-needed-change&text=Lessons+learned%3a+How+a+severe+vulnerability+in+the+OWASP+ModSecurity+Core+Rule+Set+sparked+much-needed+change+%7c+The+Daily+Swig%0A)
[WhatsApp](https://api.whatsapp.com/send?text=https%3a%2f%2fportswigger.net%2fdaily-swig%2flessons-learned-how-a-severe-vulnerability-in-the-owasp-modsecurity-core-rule-set-sparked-much-needed-change)
[Facebook](https://www.facebook.com/sharer.php?u=https%3a%2f%2fportswigger.net%2fdaily-swig%2flessons-learned-how-a-severe-vulnerability-in-the-owasp-modsecurity-core-rule-set-sparked-much-needed-change)
[Reddit](https://reddit.com/submit?url=https%3a%2f%2fportswigger.net%2fdaily-swig%2flessons-learned-how-a-severe-vulnerability-in-the-owasp-modsecurity-core-rule-set-sparked-much-needed-change)
[LinkedIn](https://www.linkedin.com/sharing/share-offsite?url=https%3a%2f%2fportswigger.net%2fdaily-swig%2flessons-learned-how-a-severe-vulnerability-in-the-owasp-modsecurity-core-rule-set-sparked-much-needed-change)
Email

This page requires JavaScript for an enhanced user experience.

Latest Posts
[### We’re going teetotal – It’s goodbye to The Daily Swig

02 March 2023
We’re going teetotal – It’s goodbye to The Daily Swig
PortSwigger today announces that The Daily Swig is closing down](/daily-swig/were-going-teetotal-its-goodbye-to-the-daily-swig)
[### Bug Bounty Radar

The latest bug bounty programs for March 2023
28 February 2023
Bug Bounty Radar
The latest bug bounty programs for March 2023](/daily-swig/bug-bounty-radar-the-latest-bug-bounty-programs-for-march-2023)
[### Indian gov flaws allowed creation of counterfeit driving licenses

28 February 2023
Indian gov flaws allowed creation of counterfeit driving licenses
Armed with personal data fragments, a researcher could also access 185 million citizens’ PII](/daily-swig/indian-transport-ministry-flaws-potentially-allowed-creation-of-counterfeit-driving-licenses)

Burp Suite

[Web vulnerability scanner](/burp/vulnerability-scanner)
[Burp Suite Editions](/burp)
[Release Notes](/burp/releases)

Vulnerabilities

[Cross-site scripting (XSS)](/web-security/cross-site-scripting)
[SQL injection](/web-security/sql-injection)
[Cross-site request forgery](/web-security/csrf)
[XML external entity injection](/web-security/xxe)
[Directory traversal](/web-security/file-path-traversal)
[Server-side request forgery](/web-security/ssrf)

Customers

[Organizations](/organizations)
[Testers](/testers)
[Developers](/developers)

Company

[About](/about)
[Careers](/careers)
[Contact](/about/contact)
[Legal](/legal)
[Privacy Notice](/privacy)

Insights

[Web Security Academy](/web-security)
[Blog](/blog)
[Research](/research)

[![PortSwigger Logo](/content/images/logos/portswigger-logo.svg)](/)
 [Follow us](https://twitter.com/Burp_Suite)

© 2025 PortSwigger Ltd.

