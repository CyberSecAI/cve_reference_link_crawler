<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <title>Lessons learned: How a severe vulnerability in the OWASP ModSecurity Core Rule Set sparked much-needed change | The Daily Swig</title>

    <meta content="Years-old WAF bypass flaw was discovered in June" name="description">
    
<!-- Twitter data -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@DailySwig">
<meta name="twitter:title" content="Lessons learned: How a severe vulnerability in the OWASP ModSecurity Core Rule Set sparked much-needed change">
    <meta name="twitter:description" content="Years-old WAF bypass flaw was discovered in June">
    <meta name="twitter:creator" content="@JesscaHaworth">
<meta name="twitter:image" content="https://portswigger.net/cms/images/d0/f7/440d-twittercard-211105-modsec-body-text.png">

<!-- Open Graph data -->
<meta property="og:title" content="Lessons learned: How a severe vulnerability in the OWASP ModSecurity Core Rule Set sparked much-needed change" />
    <meta property="og:description" content="Years-old WAF bypass flaw was discovered in June">
<meta property="og:type" content="article" />
<meta property="og:url" content="https://portswigger.net/daily-swig/lessons-learned-how-a-severe-vulnerability-in-the-owasp-modsecurity-core-rule-set-sparked-much-needed-change" />
<meta property="og:image" content="https://portswigger.net/cms/images/d0/f7/440d-twittercard-211105-modsec-body-text.png" />
    <meta property="og:site_name" content="The Daily Swig | Cybersecurity news and views" />
    <meta property="article:published_time" content="2021-11-05T15:47:00" />

    <link href="https://portswigger.net/daily-swig/lessons-learned-how-a-severe-vulnerability-in-the-owasp-modsecurity-core-rule-set-sparked-much-needed-change" rel="canonical"/>

        <link href="https://portswigger.net/daily-swig/amp/lessons-learned-how-a-severe-vulnerability-in-the-owasp-modsecurity-core-rule-set-sparked-much-needed-change" rel="amphtml"/>

    <link href="/content/images/logos/favicon.ico" rel="icon" type="image/x-icon"/>
    <link href="/content/images/logos/apple-touch-icon.png" rel="apple-touch-icon">
    <link href="/content/psdailyswig.css" rel="stylesheet" type="text/css">
    <link rel="preload" href="/content/fonts/ps-icons-small/ps-icons-small.woff?td2uot" as="font" crossorigin="anonymous">
<link rel="preload" href="/content/fonts/ps-main/ps-icons.woff?l1la2n" as="font" crossorigin="anonymous">
    
<script nonce="9PD7MWAvXQdizEbcd/1T460aWa1EhcI8">
    const dimensionName = "dimension2";
    const userRef = "";
</script>



<script nonce="9PD7MWAvXQdizEbcd/1T460aWa1EhcI8">

    (function(window, document, dataLayerName, id) {
    function stgCreateCookie(a,b,c){var d="";if(c){var e=new Date;e.setTime(e.getTime()+24*c*60*60*1e3),d=";expires="+e.toUTCString()}document.cookie=a+"="+b+d+"; path=/"}
    var isStgDebug=(window.location.href.match("stg_debug")||document.cookie.match("stg_debug"))&&!window.location.href.match("stg_disable_debug");
    stgCreateCookie("stg_debug",isStgDebug?1:"",isStgDebug?14:-1);
    var qP=[];dataLayerName!=="dataLayer"&&qP.push("data_layer_name="+dataLayerName),isStgDebug&&qP.push("stg_debug");
    var qPString=qP.length>0?("?"+qP.join("&")):"";
    document.write('<nonce-script src="https://ps.containers.piwik.pro/'+id+'.sync.js' + qPString + '" nonce="9PD7MWAvXQdizEbcd/1T460aWa1EhcI8"></' + 'nonce-script>');
    })(window, document, 'dataLayer', '287552c2-4917-42e0-8982-ba994a2a73d7');

    window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        customerId : '',
    });
</script> 
</head>
<body class="theme-dailyswig">
    


<script nonce="9PD7MWAvXQdizEbcd/1T460aWa1EhcI8">
(function(window, document, dataLayerName, id) {
    window[dataLayerName]=window[dataLayerName]||[],window[dataLayerName].push({start:(new Date).getTime(),event:"stg.start"});
    var scripts=document.getElementsByTagName('script')[0],tags=document.createElement('script');
    function stgCreateCookie(a,b,c){var d="";if(c){var e=new Date;e.setTime(e.getTime()+24*c*60*60*1e3),d=";expires="+e.toUTCString()}document.cookie=a+"="+b+d+"; path=/"}
    var isStgDebug=(window.location.href.match("stg_debug")||document.cookie.match("stg_debug"))&&!window.location.href.match("stg_disable_debug");
    stgCreateCookie("stg_debug",isStgDebug?1:"",isStgDebug?14:-1);
    var qP=[];dataLayerName!=="dataLayer"&&qP.push("data_layer_name="+dataLayerName),tags.nonce="9PD7MWAvXQdizEbcd/1T460aWa1EhcI8",isStgDebug&&qP.push("stg_debug");
    var qPString=qP.length>0?("?"+qP.join("&")):"";
    tags.async=!0,tags.src="https://ps.containers.piwik.pro/"+id+".js"+qPString,
    scripts.parentNode.insertBefore(tags,scripts);
    !function(a,n,i){a[n]=a[n]||{};for(var c=0;c<i.length;c++)!function(i){a[n][i]=a[n][i]||{},a[n][i].api=a[n][i].api||function(){
    var a=[].slice.call(arguments,0);"string"==typeof a[0]&&window[dataLayerName].push({event:n+"."+i+":"+a[0],parameters:[].slice.call(arguments,1)})}}(i[c])}(window,"ppms",["tm","cm"]);
    })(window, document, 'dataLayer', '287552c2-4917-42e0-8982-ba994a2a73d7');
</script>
    

<section class="banner-container dailyswig" id="top">
    <div class="container">
        <div class="linkscontainer-left" id="portswigger-logo-container">
            <a class="is-icon light-blue-hover" href="/" >
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18">
    <path d="M0 0h18v18H0z" fill="#f63"/>
    <path d="M10 18H8v-2.8l2.7-3.3H8V8H3.3l4.8-5.8V0H10v2.9L7.3 6H10V10h4.7L10 15.8z" fill="#fff"/>
</svg>
            </a>
        </div>
        <div class="linkscontainer" id="icons-container">
            <a class="aboutlink" href="/daily-swig/about" ></a>
            <a class="is-icon light-blue-hover" href="https://twitter.com/DailySwig" >
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 19.998">
    <path d="M22.245,2.835a3.066,3.066,0,0,1-.923.118v-.1A7.616,7.616,0,0,0,23.169.663c.074-.254,0-.336,0-.345L21.608,1l-1.293.609h0A5.128,5.128,0,0,0,16.52,0a4.69,4.69,0,0,0-4.913,4.416A7.015,7.015,0,0,0,11.8,6.078c0,.127,0-.127,0,0A14.883,14.883,0,0,1,5.818,4.261C1.847,2.208,1.625.79,1.625.79,1.007,1.462.7,3.7,1.321,5.451A5.728,5.728,0,0,0,3.1,7.578h0A4.094,4.094,0,0,1,1.847,7.36a2.715,2.715,0,0,1-.923-.445c-.379.963.388,2.726,1.727,3.916A7.026,7.026,0,0,0,4.839,12l-2.216.064c-.12,2.217,4.525,3.526,4.525,3.526h0A7.457,7.457,0,0,1,2.53,17.327,8.651,8.651,0,0,1,0,16.946,11.857,11.857,0,0,0,8.237,19.99c8.311-.445,12.974-7.769,13.2-14.956h0a5.9,5.9,0,0,0,1.219-1.054A8.831,8.831,0,0,0,24,2.162,13.006,13.006,0,0,1,22.245,2.835Z"
          transform="translate(0 0.005)" fill="#324d5c"/>
</svg>
            </a>
            <a class="is-icon light-blue-hover" href="https://www.facebook.com/DailySwig/" >
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
    <path d="M19.091,0H.909A.909.909,0,0,0,0,.909V19.091A.909.909,0,0,0,.909,20h9.764V12.291H8.091V9.227h2.582V6.836a4.064,4.064,0,0,1,4.055-4.064h2.191v3.2H14.727a.855.855,0,0,0-.855.864V9.227h3.045l-.473,3.064H13.873V20h5.218A.909.909,0,0,0,20,19.091V.909A.909.909,0,0,0,19.091,0Z"
          fill="#324d5c"/>
</svg>
            </a>
            <a class="is-icon light-blue-hover" href="https://www.linkedin.com/company/the-daily-swig" >
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="24" viewBox="0 0 24 24">
    <path fill="#324d5c" d="M0 0v24h24v-24h-24zm8 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.397-2.586 7-2.777 7 2.476v6.759z"/>
</svg>
            </a>
            <a class="is-icon light-blue-hover" href="mailto:dailyswig@portswigger.net" >
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 29 20">
    <path d="M14.312,11.14,1.41,0H27.866L14.973,11.14A.506.506,0,0,1,14.312,11.14Z" transform="translate(-0.129)"
          fill="#324d5c"/>
    <path d="M2.39,16.786,0,18.84V1.43l10.1,8.7Z" transform="translate(0 -0.131)" fill="#324d5c"/>
    <path d="M24.487,18.123l3.452,2.989H1.42l3.869-3.344,6.342-5.452,1.658,1.436,1.06.909a.506.506,0,0,0,.661,0l1.06-.909,1.694-1.463Z"
          transform="translate(-0.13 -1.113)" fill="#324d5c"/>
    <path d="M30.99,1.45v17.3l-1.863-1.609L20.95,10.105Z" transform="translate(-1.99 -0.132)" fill="#324d5c"/>
</svg>
            </a>
            <a class="is-icon light-blue-hover" href="/daily-swig/rss" >
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
    <path d="M16.173,20H20A20,20,0,0,0,14.136,5.864,20,20,0,0,0,0,0V3.818A16.209,16.209,0,0,1,16.173,20Z"
          transform="translate(0)" fill="#324d5c" fill-rule="evenodd"/>
    <path d="M0,11.3a9.3,9.3,0,0,1,6.615,2.726,9.368,9.368,0,0,1,2.726,6.624h3.834A13.193,13.193,0,0,0,9.3,11.324,13.157,13.157,0,0,0,0,7.48Z"
          transform="translate(0 -0.673)" fill="#324d5c" fill-rule="evenodd"/>
    <path d="M.781,20.669A2.622,2.622,0,1,0,0,18.8a2.626,2.626,0,0,0,.781,1.872Z" transform="translate(0 -1.468)"
          fill="#324d5c" fill-rule="evenodd"/>
</svg>
            </a>
        </div>
        <div class="titlecontainer">
            <a class="banner-main" href="/daily-swig" >
                <img alt="The Daily Swig" src="/content/images/banners/the-daily-swig-logo.svg"/>
            </a>
        </div>
    </div>
</section>

  <div class="mega-nav-dailyswig-wrapper">
    <input type="checkbox" id="daily-swig-hamburger-mobile" class="hamburger-input-mobile">
    <div class="hamburger-menu-mobile">
          <label class="hamburger-menu-label header-hidden" for="daily-swig-hamburger-mobile">
            <span class="hamburger-layers"></span>
          </label>
        </div>
        <div class="mega-nav">
          <input type="radio" id="daily-swig-mega-nav-close" class="mega-nav-input-close" name="daily-swig-mega-nav-input">
          <input type="radio" id="daily-swig-mega-nav-label-1" class="mega-nav-input-1" name="daily-swig-mega-nav-input">
          <input type="radio" id="daily-swig-mega-nav-label-2" class="mega-nav-input-2" name="daily-swig-mega-nav-input">
          <input type="radio" id="daily-swig-mega-nav-label-3" class="mega-nav-input-3" name="daily-swig-mega-nav-input">
          <input type="radio" id="daily-swig-mega-nav-label-4" class="mega-nav-input-4" name="daily-swig-mega-nav-input">
          <input type="radio" id="daily-swig-mega-nav-label-5" class="mega-nav-input-5" name="daily-swig-mega-nav-input">

          <label for="daily-swig-mega-nav-close" class="mega-nav-close"></label>
    
          <label class="mega-nav-label mega-nav-label-1" for="daily-swig-mega-nav-label-1">
            <span class="mega-nav-text">Latest threats</span>
            <svg class="icon-arrow-head-down" xmlns="http://www.w3.org/2000/svg" width="16" height="9.43" viewBox="0 0 16 9.43">
              <path d="M8,9.84,1.43,3.27,0,4.7l8,8,8-8L14.57,3.27Z" transform="translate(0 -3.27)"></path>
            </svg>
          </label>
          <label class="mega-nav-label mega-nav-label-2" for="daily-swig-mega-nav-label-2">
            <span class="mega-nav-text">Bug bounty</span>
            <svg class="icon-arrow-head-down" xmlns="http://www.w3.org/2000/svg" width="16" height="9.43" viewBox="0 0 16 9.43">
              <path d="M8,9.84,1.43,3.27,0,4.7l8,8,8-8L14.57,3.27Z" transform="translate(0 -3.27)"></path>
            </svg>
          </label>
          <label class="mega-nav-label mega-nav-label-3" for="daily-swig-mega-nav-label-3">
            <span class="mega-nav-text">For devs</span>
            <svg class="icon-arrow-head-down" xmlns="http://www.w3.org/2000/svg" width="16" height="9.43" viewBox="0 0 16 9.43">
              <path d="M8,9.84,1.43,3.27,0,4.7l8,8,8-8L14.57,3.27Z" transform="translate(0 -3.27)"></path>
            </svg>
          </label>
          <label class="mega-nav-label mega-nav-label-4" for="daily-swig-mega-nav-label-4">
            <span class="mega-nav-text">Deep dives</span>
            <svg class="icon-arrow-head-down" xmlns="http://www.w3.org/2000/svg" width="16" height="9.43" viewBox="0 0 16 9.43">
              <path d="M8,9.84,1.43,3.27,0,4.7l8,8,8-8L14.57,3.27Z" transform="translate(0 -3.27)"></path>
            </svg>
          </label>
          <label class="mega-nav-label mega-nav-label-6" for="daily-swig-mega-nav-label-5">
            <span class="mega-nav-text">More</span>
            <svg class="icon-arrow-head-down" xmlns="http://www.w3.org/2000/svg" width="16" height="9.43" viewBox="0 0 16 9.43">
              <path d="M8,9.84,1.43,3.27,0,4.7l8,8,8-8L14.57,3.27Z" transform="translate(0 -3.27)"></path>
            </svg>
          </label>
          <a class="mega-nav-link header-hidden" href="https://portswigger.net/daily-swig/about"><span class="mega-nav-text">About</span></a>
   
          <div class="mega-nav-container">
    
            <div class="mega-nav-content mega-nav-content-1">
              <div class="section-white-medium-no-padding">
                <div class="container-columns-66-percent-right">
                  <div>
                    <div class="container-columns">
                      <a href="https://portswigger.net/daily-swig/vulnerabilities" class="no-border">Web security vulnerabilities</a>
                      <a href="https://portswigger.net/daily-swig/network-security" class="no-border">Network security vulnerabilities</a>
                      <a href="https://portswigger.net/daily-swig/cloud-security" class="no-border">Cloud security</a>
                      <a href="https://portswigger.net/daily-swig/zero-day" class="no-border">Zero-day news</a>
                      <a href="https://portswigger.net/daily-swig/supply-chain-attacks" class="no-border">Supply chain attacks</a>

                    </div>
                    <a href="https://portswigger.net/daily-swig/vulnerabilities" class="chevron-after">View all web security news</a>
                  </div>
    
                  <div>
                    <div class="container-cards-lists-white">
                      <a href="https://portswigger.net/daily-swig/prototype-pollution-project-yields-another-parse-server-rce">
                        <p><strong>Prototype pollution</strong></p>
                        <p>Prototype pollution project yields another Parse Server RCE</p>
                        <img src="/daily-swig-mega-nav/images/latestthreats.png" alt="Prototype-pollution">
                      </a>
                    </div>
    
                  </div>
    
    
                </div>
              </div>
            </div>
            <div class="mega-nav-content mega-nav-content-2">
              <div class="section-white-medium-no-padding">
                <div class="container-columns-66-percent-right">
                  <div>
                    <div class="container-small">
                      <a href="https://portswigger.net/daily-swig/bug-bounty" class="no-border">Bug bounty news</a>
    
                      <a href="https://portswigger.net/daily-swig/vdp" class="no-border">VDPs</a>
    
                      <a href="https://portswigger.net/daily-swig/bug-bounty-radar" class="no-border">Bug Bounty Radar</a>
                    </div>
                    <a href="https://portswigger.net/daily-swig/bug-bounty" class="chevron-after">View all bug bounty news</a>
                  </div>
    
                  <div>
                    <div class="container-cards-lists-white">
                      <a href="https://portswigger.net/daily-swig/bug-bounty-radar-the-latest-bug-bounty-programs-for-february-2023">
                        <p><strong>Bug Bounty Radar</strong></p>
                        <p>The latest programs for February 2023</p>
                        <img src="/daily-swig-mega-nav/images/bug-bounties.png" alt="Bug bounties">
                      </a>
                    </div>
    
                  </div>
    
    
                </div>
              </div>
            </div>
            <div class="mega-nav-content mega-nav-content-3">
              <div class="section-white-medium-no-padding">
                <div class="container-columns-66-percent-right">
                  <div>
                    <div class="container-columns">
                      <a href="https://portswigger.net/daily-swig/devsecops" class="no-border">DevSecOps</a>
                      <a href="https://portswigger.net/daily-swig/security-best-practices" class="no-border">Security best practices</a>
                      <a href="https://portswigger.net/daily-swig/dev-stack-tech" class="no-border">Dev stack tech</a>
                    </div>
                    <a href="https://portswigger.net/daily-swig/devsecops" class="chevron-after">View all dev related news</a>
                  </div>
    
                  <div>
                    <div class="container-cards-lists-white">
                      <a href="https://portswigger.net/daily-swig/all-day-devops-third-of-log4j-downloads-still-pull-vulnerable-version-despite-threat-of-supply-chain-attacks">
                        <p><strong>All Day DevOps</strong></p>
                        <p>AppSec engineer keynote says Log4j revealed lessons were not learned from the Equifax breach</p>
                        <img src="/daily-swig-mega-nav/images/devsecops.png" alt="DevOps">
                      </a>
                    </div>
    
                  </div>
    
    
                </div>
              </div>
            </div>
            <div class="mega-nav-content mega-nav-content-4">
              <div class="section-white-medium-no-padding">
                <div class="container-columns-66-percent-right">
                  <div>
                    <div class="container-small">
                      <a href="https://portswigger.net/daily-swig/deep-dives" class="no-border">Deep dives</a>
    
                      <a href="https://portswigger.net/daily-swig/interviews" class="no-border">Interviews</a>
    
                    </div>
                    <a href="https://portswigger.net/daily-swig/deep-dives" class="chevron-after">View all of the latest features</a>
                  </div>
    
                  <div>
                    <div class="container-cards-lists-white">
                      <a href="https://portswigger.net/daily-swig/a-rough-guide-to-launching-a-career-in-cybersecurity">
                        <p><strong>Infosec beginner?</strong></p>
                        <p>A rough guide to launching a career in cybersecurity</p>
                        <img src="/daily-swig-mega-nav/images/deepdives.png" alt="cyber-career">
                      </a>
                    </div>
    
                  </div>
    
    
                </div>
              </div>
            </div>
            <div class="mega-nav-content mega-nav-content-5">
              <div class="section-white-medium-no-padding">
                <div class="container-columns-66-percent-right">
                  <div>
                    <div class="container-small">
                      <a href="https://portswigger.net/daily-swig/industry-news" class="no-border">Industry news</a>

                      <a href="https://portswigger.net/daily-swig/enterprise" class="no-border">Enterprise security news</a>

                      <a href="https://portswigger.net/daily-swig/hacking-tools" class="no-border">Web hacking tools</a>

                      <a href="https://portswigger.net/daily-swig/events" class="no-border">Events</a>

                    </div>
                    <a href="https://portswigger.net/daily-swig/industry-news" class="chevron-after">View all infosec industry news</a>
                  </div>

                  <div>
                    <div class="container-cards-lists-white">
                      <a href="https://portswigger.net/daily-swig/cybersecurity-conferences-a-rundown-of-online-in-person-and-hybrid-events">
                      <p><strong>Cybersecurity conferences</strong></p>
                      <p>A schedule of events in 2022 and beyond</p>
                      <img src="/daily-swig-mega-nav/images/more-topics.jpg" alt="More topics">
                      </a>
                    </div>

                  </div>


                </div>
              </div>
            </div>
          </div>
        </div>
  </div>
  
    


<input id="MediaId" name="MediaId" type="hidden" value="01E1E22ABDD4B272D471B1CDF744FAD1" />


<section class="maincontainer dailyswig">
    <div class="container is-flex margin-bottom-m">
        <div class="maincol">
            <div class="post-card">
                
<h1>Lessons learned: How a severe vulnerability in the OWASP ModSecurity Core Rule Set sparked much-needed change</h1>
                
                <div class="post-additionalinfo">
                    
<a href="/daily-swig/by/jessica-haworth-elsayed">
    Jessica Haworth-Elsayed</a>

05 November 2021 at 15:47 UTC

    <br>
    Updated: 05 December 2022 at 16:01 UTC

                </div>
                <div class="post-labels">
                    
            <a href="/daily-swig/vulnerabilities">
                <span>Vulnerabilities</span></a>
            <a href="/daily-swig/waf">
                <span>WAF</span></a>
            <a href="/daily-swig/devops">
                <span>DevOps</span></a>

                </div>
                

<div class="sharebuttoncontainer is-smallicons">
    <a href="https://twitter.com/share?url=https%3a%2f%2fportswigger.net%2fdaily-swig%2flessons-learned-how-a-severe-vulnerability-in-the-owasp-modsecurity-core-rule-set-sparked-much-needed-change&text=Lessons+learned%3a+How+a+severe+vulnerability+in+the+OWASP+ModSecurity+Core+Rule+Set+sparked+much-needed+change+%7c+The+Daily+Swig%0A" target="_blank">
        <span class="share-twitter ">
            <span class="share-icon icon-ps-twitter"></span>
            <span class="share-text">Twitter</span>
        </span>
    </a>
    <a href="https://api.whatsapp.com/send?text=https%3a%2f%2fportswigger.net%2fdaily-swig%2flessons-learned-how-a-severe-vulnerability-in-the-owasp-modsecurity-core-rule-set-sparked-much-needed-change" target="_blank">
        <span class="share-whatsapp ">
            <span class="share-icon icon-ps-whatsapp"></span>
            <span class="share-text">WhatsApp</span>
        </span>
    </a>
    <a href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fportswigger.net%2fdaily-swig%2flessons-learned-how-a-severe-vulnerability-in-the-owasp-modsecurity-core-rule-set-sparked-much-needed-change" target="_blank">
        <span class="share-facebook ">
            <span class="share-icon icon-ps-facebook"></span>
            <span class="share-text">Facebook</span>
        </span>
    </a>
    <a href="https://reddit.com/submit?url=https%3a%2f%2fportswigger.net%2fdaily-swig%2flessons-learned-how-a-severe-vulnerability-in-the-owasp-modsecurity-core-rule-set-sparked-much-needed-change" target="_blank">
        <span class="share-reddit ">
            <span class="share-icon icon-ps-reddit"></span>
            <span class="share-text">Reddit</span>
        </span>
    </a>
    <a href="https://www.linkedin.com/sharing/share-offsite?url=https%3a%2f%2fportswigger.net%2fdaily-swig%2flessons-learned-how-a-severe-vulnerability-in-the-owasp-modsecurity-core-rule-set-sparked-much-needed-change" target="_blank">
        <span class="share-linkedin ">
            <span class="share-icon icon-ps-linkedin"></span>
            <span class="share-text">LinkedIn</span>
        </span>
    </a>
    <a href="mailto:?subject=Lessons+learned%3a+How+a+severe+vulnerability+in+the+OWASP+ModSecurity+Core+Rule+Set+sparked+much-needed+change+%7c+The+Daily+Swig&body=Lessons+learned%3a+How+a+severe+vulnerability+in+the+OWASP+ModSecurity+Core+Rule+Set+sparked+much-needed+change+%7c+The+Daily+Swig%0A%0AYears-old+WAF+bypass+flaw+was+discovered+in+June%0A%0Ahttps://portswigger.net/daily-swig/lessons-learned-how-a-severe-vulnerability-in-the-owasp-modsecurity-core-rule-set-sparked-much-needed-change">
        <span class="share-email ">
            <span class="share-icon icon-ps-email"></span>
            <span class="share-text">Email</span>
        </span>
    </a>
</div>
                <div class="post-content">
                    <!-- Article Start -->
                    <p class="standfirst">Years-old WAF bypass flaw was discovered in June</p><p><img src="/cms/images/d0/f7/440d-article-211105-modsec-body-text.png" alt="Lessons learned: How a severe vulnerability in the OWASP ModSecurity Core Rule Set sparked much-needed change" title="Image: At-Scene / Shutterstock"><br></p><p>A severe <a href="https://portswigger.net/daily-swig/vulnerabilities" target="_blank">vulnerability</a> present in the OWASP ModSecurity Core Rule Set (CRS) for several years was a “bang on the ear” for the project's maintainers, who have outlined steps to improve its security.</p><p>The ModSec team reported that a complete rule set bypass (CVE-2021-35368) had been discovered in June 2021. The critical bug that had been present in the software for at least four years.</p><p>As <a href="https://portswigger.net/daily-swig/waf-bypass-severe-owasp-modsecurity-core-rule-set-bug-was-present-for-several-years" target="_blank">previously reported </a>by <span class="italic">The Daily Swig</span>, the vulnerability bypassed the security protections offered by the in-built CRS web application firewall (WAF), meaning that malicious request body payloads could be smuggled through without being inspected.</p><p>The issue, which was introduced in code changes 2017, has since been remediated.</p><p>However, to help reduce the likelihood of another high-impact bug slipping through the net, the CRS maintainers have implemented new practices, guidelines, and a <a href="https://portswigger.net/daily-swig/bug-bounty" target="_blank">bug bounty</a> program to further secure the technology.</p><h3>A chance for growth</h3><p>Speaking to <span class="italic">The Daily Swig</span>, OWASP CRS co-lead Christian Folini said that the incident was “one of the biggest bangs on the ear” for him.</p><p>He explained: “It was clearly my personal fault. I had introduced these two bugs right after our new team had taken over the dormant project in 2016. The fix was easy enough, yet I felt like hiding under a rock.”</p><p><br></p><p class="text-center"><span class="bold">BACKGROUND&nbsp;</span><a href="https://portswigger.net/daily-swig/waf-bypass-severe-owasp-modsecurity-core-rule-set-bug-was-present-for-several-years" target="_blank">WAF bypass: ‘Severe’ OWASP ModSecurity Core Rule Set bug was present for several years</a></p><p><br>The <a href="https://coreruleset.org/20211101/crs-developer-retreat-2021/" target="_blank">team met in Switzerland last week</a> to formulate a plan to “improve set up and procedures”, said Folini, who admitted that the incident was an “embarrassment”.</p><p>Folini said: “We started to look at it as a chance for growth and development. Therefore, we made it a focus theme for our first CRS developer retreat – how can we prevent merging bugs? And, if we carry them, how do we detect them in our rules?”</p><p></p><h3>Beyond automated testing<p></p></h3><p>Folini said that the CRS team has been slowly expanding its <a href="https://portswigger.net/daily-swig/devops" target="_blank">DevOps</a> practices “for several years” since they took over in 2016.</p><p>However, the project is in need of “a comprehensive <a href="/burp/application-security-testing">application security</a> program that goes beyond automatic testing”, according to Folini.</p><p>Addressing the issue, he told<span class="italic"> The Daily Swig</span> that the CRS team has implemented a list of changes that will foster a more proactive approach to security.</p><p><br></p><blockquote>“We ran a workshop at our retreat and tried to come up with various measures that would form several layers of defense against any failures in our rule set. Eventually we settled on four changes:<br><br>- Rule exclusion packages will become plugins<br><br>- We will forbid certain constructs/directives from the rule set<br><br>- We will prepare a formal checklist to review every rule, namely new ones<br><br>- We will launch a bug bounty program.”</blockquote><h3>Shrinking the attack surface</h3><p>Folini explained that the bypass vulnerability was hidden in one of the rule exclusion packages, which are distributed together with the rule set.</p><p>“Even an inactive rule exclusion package could cripple the entire rule set,” he said.</p><p>“So, we want to transform these packages into plugins, leveraging the new plugin functionality that we are going to introduce with our next major release. Plugins are not installed by default, so this measure will reduce our attack surface.”</p><p><br></p><p class="text-center"><a href="https://portswigger.net/daily-swig/vulnerabilities" target="_blank" class="bold">Read more of the latest security vulnerability news</a></p><p><br>Folini told <span class="italic">The Daily Swig</span> that the bypass was only possible because a bad rule used a “very powerful” construct to disable request body access under certain conditions.</p><p>“What we did not realize was that an attacker could meet these conditions by abusing the <span class="codeextract">PATH_INFO</span> part of the request URI,” he continued.</p><p>“If we forbid this and similarly powerful directives, we reduce the impact of future bugs, so this is a risk limiting measure.”</p><p>Folini also said that by introducing a formal checklist and a bug bounty program, code can be extensively reviewed, both internally and externally.</p><p>This plan does, however, contain a caveat: In order to be able to pay such bounties, the project will need to attract more sponsors.</p><h3>Lessons learned</h3><p>Despite the major security headache caused by the <a href="https://portswigger.net/daily-swig/waf" target="_blank">WAF</a> bypass vulnerability, Folini is optimistic that the lessons learned will spark much-needed change.</p><p>“Nobody likes to look like an idiot in public,” he admitted. “But it is important to take the bull by the horns.</p><p>“Going out, writing a detailed advisory, informing the big integrators directly (in advance), responding to questions from the community and reviewing your own policies and procedures are all crucial steps if you want to grow and improve.</p><p>“The whole affair also strengthened the ties within the team. We overcame this together and we know we can trust each other even when we’re in deep trouble and that’s very reassuring.</p><p>“So ultimately, I think it was a positive experience and we trust that the community appreciates how we handled this severe incident. So, it looks like we’re doing the right thing here.”</p><p><br></p><p><span class="bold">RECOMMENDED</span> <a href="https://portswigger.net/daily-swig/focus-on-brilliance-at-the-basics-github-cso-mike-hanley-on-shifting-left-and-securing-the-software-supply-chain" target="_blank">‘Focus on brilliance at the basics’ – GitHub CSO Mike Hanley on shifting left and securing the software supply chain</a></p>
                    <!-- Article End -->
                </div>
                <div class="post-labels">
                    
            <a href="/daily-swig/vulnerabilities">
                <span>Vulnerabilities</span></a>
            <a href="/daily-swig/waf">
                <span>WAF</span></a>
            <a href="/daily-swig/devops">
                <span>DevOps</span></a>
            <a href="/daily-swig/devsecops">
                <span>DevSecOps</span></a>
            <a href="/daily-swig/hacking-culture">
                <span>Hacking culture</span></a>
            <a href="/daily-swig/industry-news">
                <span>Industry News</span></a>
            <a href="/daily-swig/secure-development">
                <span>Secure Development</span></a>
            <a href="/daily-swig/interviews">
                <span>Interviews</span></a>
            <a href="/daily-swig/bug-bounty">
                <span>Bug Bounty</span></a>
            <a href="/daily-swig/europe">
                <span>Europe</span></a>
            <a href="/daily-swig/open-source-software">
                <span>Open Source Software</span></a>
            <a href="/daily-swig/switzerland">
                <span>Switzerland</span></a>
            <a href="/daily-swig/network-security">
                <span>Network Security</span></a>
            <a href="/daily-swig/database-security">
                <span>Database Security</span></a>
            <a href="/daily-swig/cloud-security">
                <span>Cloud Security</span></a>

                </div>
                <div class="post-authorinfo">

<img src="/cms/profiles/jessica-haworth-elsayed.png" alt="Jessica Haworth-Elsayed"/>
<div class="post-authorinfo-text">
    <p class="post-authorinfo-name">
        <!-- Author Start -->
        <a href="/daily-swig/by/jessica-haworth-elsayed">Jessica Haworth-Elsayed</a>
        <!-- Author} End -->
    </p>
        <p>
            <a href="https://twitter.com/JesscaHaworth">@JesscaHaworth <span class="icon cmsicon-twitter"></span></a>
        </p>
</div>

                </div>
                

<div class="sharebuttoncontainer is-aftercontent">
    <a href="https://twitter.com/share?url=https%3a%2f%2fportswigger.net%2fdaily-swig%2flessons-learned-how-a-severe-vulnerability-in-the-owasp-modsecurity-core-rule-set-sparked-much-needed-change&text=Lessons+learned%3a+How+a+severe+vulnerability+in+the+OWASP+ModSecurity+Core+Rule+Set+sparked+much-needed+change+%7c+The+Daily+Swig%0A" target="_blank">
        <span class="share-twitter is-wide">
            <span class="share-icon icon-ps-twitter"></span>
            <span class="share-text">Twitter</span>
        </span>
    </a>
    <a href="https://api.whatsapp.com/send?text=https%3a%2f%2fportswigger.net%2fdaily-swig%2flessons-learned-how-a-severe-vulnerability-in-the-owasp-modsecurity-core-rule-set-sparked-much-needed-change" target="_blank">
        <span class="share-whatsapp is-wide">
            <span class="share-icon icon-ps-whatsapp"></span>
            <span class="share-text">WhatsApp</span>
        </span>
    </a>
    <a href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fportswigger.net%2fdaily-swig%2flessons-learned-how-a-severe-vulnerability-in-the-owasp-modsecurity-core-rule-set-sparked-much-needed-change" target="_blank">
        <span class="share-facebook is-wide">
            <span class="share-icon icon-ps-facebook"></span>
            <span class="share-text">Facebook</span>
        </span>
    </a>
    <a href="https://reddit.com/submit?url=https%3a%2f%2fportswigger.net%2fdaily-swig%2flessons-learned-how-a-severe-vulnerability-in-the-owasp-modsecurity-core-rule-set-sparked-much-needed-change" target="_blank">
        <span class="share-reddit is-wide">
            <span class="share-icon icon-ps-reddit"></span>
            <span class="share-text">Reddit</span>
        </span>
    </a>
    <a href="https://www.linkedin.com/sharing/share-offsite?url=https%3a%2f%2fportswigger.net%2fdaily-swig%2flessons-learned-how-a-severe-vulnerability-in-the-owasp-modsecurity-core-rule-set-sparked-much-needed-change" target="_blank">
        <span class="share-linkedin is-wide">
            <span class="share-icon icon-ps-linkedin"></span>
            <span class="share-text">LinkedIn</span>
        </span>
    </a>
    <a href="mailto:?subject=Lessons+learned%3a+How+a+severe+vulnerability+in+the+OWASP+ModSecurity+Core+Rule+Set+sparked+much-needed+change+%7c+The+Daily+Swig&body=Lessons+learned%3a+How+a+severe+vulnerability+in+the+OWASP+ModSecurity+Core+Rule+Set+sparked+much-needed+change+%7c+The+Daily+Swig%0A%0AYears-old+WAF+bypass+flaw+was+discovered+in+June%0A%0Ahttps://portswigger.net/daily-swig/lessons-learned-how-a-severe-vulnerability-in-the-owasp-modsecurity-core-rule-set-sparked-much-needed-change">
        <span class="share-email is-wide">
            <span class="share-icon icon-ps-email"></span>
            <span class="share-text">Email</span>
        </span>
    </a>
</div>
            </div>
        </div>

<div id="widgetcolumn" class="post-widgetcolumn rightcol">
    <noscript>
        <div class="noscript-warning">This page requires JavaScript for an enhanced user experience.</div>
    </noscript>
    <div class="widget-tile-container">
        <div class="widget-title">Latest Posts</div>
        <div class="widget-content">


<a href="/daily-swig/were-going-teetotal-its-goodbye-to-the-daily-swig" class="tile-container dailyswig onecolumn widget-tile size0 style1 textstyle4 is-whitebackground" data-backgroundimageurl=/cms/images/21/e7/3c38-tile-945d0fb3-78b5-446d-813f-8716ed41dc38.png  data-backgroundcolorid="0">
    
<h3 class="tile-text1 notext2">
        <span class="tile-text-container">We’re going teetotal – It’s goodbye to The Daily Swig</span>
</h3>
    
<span class="tile-date">02 March 2023</span>
    
<span class="tile-text1-alt">We’re going teetotal – It’s goodbye to The Daily Swig</span>
        
        <span class="tile-text2-alt">PortSwigger today announces that The Daily Swig is closing down</span>

</a>

<a href="/daily-swig/bug-bounty-radar-the-latest-bug-bounty-programs-for-march-2023" class="tile-container dailyswig onecolumn widget-tile size0 style1 textstyle2 is-whitebackground" data-backgroundimageurl=/cms/images/58/c9/3d89-tile-bug-bounty-radar-2021-1x1-orange.jpg  data-backgroundcolorid="0">
    
<h3 class="tile-text1 ">
Bug Bounty Radar</h3>


    <span class="tile-text2">
The latest bug bounty programs for March 2023    </span>
    
<span class="tile-date">28 February 2023</span>
    
<span class="tile-text1-alt">Bug Bounty Radar</span>
        
        <span class="tile-text2-alt">The latest bug bounty programs for March 2023</span>

</a>

<a href="/daily-swig/indian-transport-ministry-flaws-potentially-allowed-creation-of-counterfeit-driving-licenses" class="tile-container dailyswig onecolumn widget-tile size0 style0 textstyle4 is-whitebackground" data-backgroundimageurl=/cms/images/65/d7/7a29-tile-india_roads_1x1.jpg data-backgroundoverlay data-backgroundcolorid="0">
    
<h3 class="tile-text1 notext2">
        <span class="tile-text-container">Indian gov flaws allowed creation of counterfeit driving licenses</span>
</h3>
    
<span class="tile-date">28 February 2023</span>
    
<span class="tile-text1-alt">Indian gov flaws allowed creation of counterfeit driving licenses</span>
        
        <span class="tile-text2-alt">Armed with personal data fragments, a researcher could also access 185 million citizens&#x2019; PII</span>

</a>        </div>
    </div>
</div>    </div>
</section>


<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "NewsArticle",
  "author": {
    "@type": "Person",
    "email": "dailyswig@portswigger.net",
    "name": "Jessica Haworth-Elsayed"
  },
  "dateModified": "2022-12-05",
  "datePublished": "2021-11-05",
  "headline": "Lessons learned: How a severe vulnerability in the OWASP ModSecurity Core Rule Set sparked much-needed change",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://portswigger.net/daily-swig/lessons-learned-how-a-severe-vulnerability-in-the-owasp-modsecurity-core-rule-set-sparked-much-needed-change"
  },
  "image":{
    "@type": "ImageObject",
    "url": "https://portswigger.net/cms/images/d0/f7/440d-twittercard-211105-modsec-body-text.png"
  },
  "publisher": {
    "@type": "Organization",
    "logo": {
      "@type": "ImageObject",
      "url": "https://portswigger.net/content/images/logos/dailyswig-logo.jpg"
    },
    "name": "The Daily Swig",
    "url": "https://portswigger.net/daily-swig",
    "sameAs": [
      "https://twitter.com/dailyswig"
    ]
  },
  "url": "https://portswigger.net/daily-swig/lessons-learned-how-a-severe-vulnerability-in-the-owasp-modsecurity-core-rule-set-sparked-much-needed-change"
}
</script>

    <script src="/bundles/cms/dailyswig/details.js?v=A7C6lEdOeTWiQyWR2YYLVh7yfQQ" nonce="9PD7MWAvXQdizEbcd/1T460aWa1EhcI8"></script>


    <section class="prefootercontainer dailyswig"></section>
    
    <footer class="wrapper">
        <div class="container">
            <div>
                <p>Burp Suite</p>
                <a href="/burp/vulnerability-scanner">Web vulnerability scanner</a>
                <a href="/burp">Burp Suite Editions</a>
                <a href="/burp/releases">Release Notes</a>
            </div>
            <div>
                <p>Vulnerabilities</p>
                <a href="/web-security/cross-site-scripting">Cross-site scripting (XSS)</a>
                <a href="/web-security/sql-injection">SQL injection</a>
                <a href="/web-security/csrf">Cross-site request forgery</a>
                <a href="/web-security/xxe">XML external entity injection</a>
                <a href="/web-security/file-path-traversal">Directory traversal</a>
                <a href="/web-security/ssrf">Server-side request forgery</a>
            </div>
            <div>
                <p>Customers</p>
                <a href="/organizations">Organizations</a>
                <a href="/testers">Testers</a>
                <a href="/developers">Developers</a>
            </div>
            <div>
                <p>Company</p>
                <a href="/about">About</a>
                <a href="/careers">Careers</a>
                <a href="/about/contact">Contact</a>
                <a href="/legal">Legal</a>
                <a href="/privacy">Privacy Notice</a>
            </div>
            <div>
                <p>Insights</p>
                <a href="/web-security">Web Security Academy</a>
                <a href="/blog">Blog</a>
                <a href="/research">Research</a>
            </div>
            <div>
                <a href="/"><img src="/content/images/logos/portswigger-logo.svg" alt="PortSwigger Logo" class="footer-logo"></a>
                <a class="button-outline-blue-small camelcase" href="https://twitter.com/Burp_Suite" rel="noreferrer"><span class="icon-twitter"></span>  Follow us</a>
                <p class="grey">&copy; 2025 PortSwigger Ltd.</p>
            </div>
        </div>
    </footer>
    <a href="#top" class="back-to-top"><svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 26 26"><polygon points="4.07 14.7 5.03 15.78 12.48 9.13 19.94 15.78 20.9 14.7 12.48 7.2 4.07 14.7" fill="#f63" /><path d="M13,0A13,13,0,1,0,26,13,13,13,0,0,0,13,0Zm0,24.56A11.56,11.56,0,1,1,24.56,13,11.58,11.58,0,0,1,13,24.56Z" fill="#f63" /></svg></a>

</body>
</html>