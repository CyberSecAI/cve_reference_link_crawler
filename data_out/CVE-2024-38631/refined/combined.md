=== Content from git.kernel.org_6f7aa585_20250111_105758.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=8dbcb3a8cfdf8ff5afce62dad50790278ff0d3b7)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=8dbcb3a8cfdf8ff5afce62dad50790278ff0d3b7)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8dbcb3a8cfdf8ff5afce62dad50790278ff0d3b7)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8dbcb3a8cfdf8ff5afce62dad50790278ff0d3b7)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Marius Cristea <marius.cristea@microchip.com> | 2024-04-25 14:42:32 +0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-06-12 11:39:16 +0200 |
| commit | [8dbcb3a8cfdf8ff5afce62dad50790278ff0d3b7](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8dbcb3a8cfdf8ff5afce62dad50790278ff0d3b7) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=8dbcb3a8cfdf8ff5afce62dad50790278ff0d3b7)) | |
| tree | [6dc0e0032efb6a6653981205c659baa21621b726](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=8dbcb3a8cfdf8ff5afce62dad50790278ff0d3b7) | |
| parent | [54dd425767c3858933923f7ed59c04fab5cb163e](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=54dd425767c3858933923f7ed59c04fab5cb163e) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8dbcb3a8cfdf8ff5afce62dad50790278ff0d3b7&id2=54dd425767c3858933923f7ed59c04fab5cb163e)) | |
| download | [linux-8dbcb3a8cfdf8ff5afce62dad50790278ff0d3b7.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-8dbcb3a8cfdf8ff5afce62dad50790278ff0d3b7.tar.gz) | |

iio: adc: PAC1934: fix accessing out of bounds array index[ Upstream commit 51fafb3cd7fcf4f4682693b4d2883e2a5bfffe33 ]
Fix accessing out of bounds array index for average
current and voltage measurements. The device itself has
only 4 channels, but in sysfs there are "fake"
channels for the average voltages and currents too.
Fixes: 0fb528c8255b ("iio: adc: adding support for PAC193x")
Reported-by: Conor Dooley <conor.dooley@microchip.com>
Signed-off-by: Marius Cristea <marius.cristea@microchip.com>
Closes: https://lore.kernel.org/linux-iio/20240405-embellish-bonnet-ab5f10560d93@wendy/
Tested-by: Conor Dooley <conor.dooley@microchip.com>
Link: [https://lore.kernel.org/r/20240425114232.81390-1-marius.cristea@microchip.com](https://lore.kernel.org/r/20240425114232.81390-1-marius.cristea%40microchip.com)
Signed-off-by: Jonathan Cameron <Jonathan.Cameron@huawei.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8dbcb3a8cfdf8ff5afce62dad50790278ff0d3b7)

| -rw-r--r-- | [drivers/iio/adc/pac1934.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/iio/adc/pac1934.c?id=8dbcb3a8cfdf8ff5afce62dad50790278ff0d3b7) | 9 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 9 insertions, 0 deletions

| diff --git a/drivers/iio/adc/pac1934.c b/drivers/iio/adc/pac1934.cindex e0c2742da5236f..8a0c357422121b 100644--- a/[drivers/iio/adc/pac1934.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/iio/adc/pac1934.c?id=54dd425767c3858933923f7ed59c04fab5cb163e)+++ b/[drivers/iio/adc/pac1934.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/iio/adc/pac1934.c?id=8dbcb3a8cfdf8ff5afce62dad50790278ff0d3b7)@@ -787,6 +787,15 @@ static int pac1934\_read\_raw(struct iio\_dev \*indio\_dev, s64 curr\_energy; int ret, channel = chan->channel - 1; + /\*+ \* For AVG the index should be between 5 to 8.+ \* To calculate PAC1934\_CH\_VOLTAGE\_AVERAGE,+ \* respectively PAC1934\_CH\_CURRENT real index, we need+ \* to remove the added offset (PAC1934\_MAX\_NUM\_CHANNELS).+ \*/+ if (channel >= PAC1934\_MAX\_NUM\_CHANNELS)+ channel = channel - PAC1934\_MAX\_NUM\_CHANNELS;+ ret = pac1934\_retrieve\_data(info, PAC1934\_MIN\_UPDATE\_WAIT\_TIME\_US); if (ret < 0) return ret; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 10:56:35 +0000



=== Content from git.kernel.org_274ff13d_20250111_105757.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=51fafb3cd7fcf4f4682693b4d2883e2a5bfffe33)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=51fafb3cd7fcf4f4682693b4d2883e2a5bfffe33)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=51fafb3cd7fcf4f4682693b4d2883e2a5bfffe33)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=51fafb3cd7fcf4f4682693b4d2883e2a5bfffe33)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Marius Cristea <marius.cristea@microchip.com> | 2024-04-25 14:42:32 +0300 |
| --- | --- | --- |
| committer | Jonathan Cameron <jonathan.cameron@huawei.com> | 2024-05-03 11:48:56 +0100 |
| commit | [51fafb3cd7fcf4f4682693b4d2883e2a5bfffe33](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=51fafb3cd7fcf4f4682693b4d2883e2a5bfffe33) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=51fafb3cd7fcf4f4682693b4d2883e2a5bfffe33)) | |
| tree | [8e604543524af872fce843018a25dfccfc490820](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=51fafb3cd7fcf4f4682693b4d2883e2a5bfffe33) | |
| parent | [bf8367b00c33c64a9391c262bb2e11d274c9f2a4](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=bf8367b00c33c64a9391c262bb2e11d274c9f2a4) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=51fafb3cd7fcf4f4682693b4d2883e2a5bfffe33&id2=bf8367b00c33c64a9391c262bb2e11d274c9f2a4)) | |
| download | [linux-51fafb3cd7fcf4f4682693b4d2883e2a5bfffe33.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-51fafb3cd7fcf4f4682693b4d2883e2a5bfffe33.tar.gz) | |

iio: adc: PAC1934: fix accessing out of bounds array indexFix accessing out of bounds array index for average
current and voltage measurements. The device itself has
only 4 channels, but in sysfs there are "fake"
channels for the average voltages and currents too.
Fixes: 0fb528c8255b ("iio: adc: adding support for PAC193x")
Reported-by: Conor Dooley <conor.dooley@microchip.com>
Signed-off-by: Marius Cristea <marius.cristea@microchip.com>
Closes: https://lore.kernel.org/linux-iio/20240405-embellish-bonnet-ab5f10560d93@wendy/
Tested-by: Conor Dooley <conor.dooley@microchip.com>
Link: [https://lore.kernel.org/r/20240425114232.81390-1-marius.cristea@microchip.com](https://lore.kernel.org/r/20240425114232.81390-1-marius.cristea%40microchip.com)
Signed-off-by: Jonathan Cameron <Jonathan.Cameron@huawei.com>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=51fafb3cd7fcf4f4682693b4d2883e2a5bfffe33)

| -rw-r--r-- | [drivers/iio/adc/pac1934.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/iio/adc/pac1934.c?id=51fafb3cd7fcf4f4682693b4d2883e2a5bfffe33) | 9 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 9 insertions, 0 deletions

| diff --git a/drivers/iio/adc/pac1934.c b/drivers/iio/adc/pac1934.cindex f751260605e4e1..456f12faa34807 100644--- a/[drivers/iio/adc/pac1934.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/iio/adc/pac1934.c?id=bf8367b00c33c64a9391c262bb2e11d274c9f2a4)+++ b/[drivers/iio/adc/pac1934.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/iio/adc/pac1934.c?id=51fafb3cd7fcf4f4682693b4d2883e2a5bfffe33)@@ -787,6 +787,15 @@ static int pac1934\_read\_raw(struct iio\_dev \*indio\_dev, s64 curr\_energy; int ret, channel = chan->channel - 1; + /\*+ \* For AVG the index should be between 5 to 8.+ \* To calculate PAC1934\_CH\_VOLTAGE\_AVERAGE,+ \* respectively PAC1934\_CH\_CURRENT real index, we need+ \* to remove the added offset (PAC1934\_MAX\_NUM\_CHANNELS).+ \*/+ if (channel >= PAC1934\_MAX\_NUM\_CHANNELS)+ channel = channel - PAC1934\_MAX\_NUM\_CHANNELS;+ ret = pac1934\_retrieve\_data(info, PAC1934\_MIN\_UPDATE\_WAIT\_TIME\_US); if (ret < 0) return ret; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 10:56:35 +0000


