<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="UTF-8">
<meta property="og:type" content="website">
<meta property="og:title" content="1816390 - (CVE-2024-1554) Browser cache poisoning attack using fetch() with different headers">
<meta property="og:url" content="https://bugzilla.mozilla.org/show_bug.cgi?id=1816390">
<meta property="og:description"
      content="RESOLVED (valentin.gosu) in Core - Networking: Cache. Last updated 2024-09-16.">
<meta name="twitter:label1" value="Type">
<meta name="twitter:data1" value="defect">
<meta name="twitter:label2" value="Priority">
<meta name="twitter:data2" value="P2">

    

    <meta name="viewport"
          content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="color-scheme" content="dark light">
    <meta name="generator" content="Bugzilla 20250108.1">
    <meta name="bugzilla-global" content="dummy"
        id="bugzilla-global" data-bugzilla="{&quot;api_token&quot;:&quot;&quot;,&quot;config&quot;:{&quot;basepath&quot;:&quot;\/&quot;,&quot;cookie_consent_enabled&quot;:&quot;&quot;,&quot;cookie_consent_required&quot;:1,&quot;essential_cookies&quot;:[&quot;bugzilla&quot;,&quot;Bugzilla_login&quot;,&quot;Bugzilla_logincookie&quot;,&quot;Bugzilla_login_request_cookie&quot;,&quot;github_state&quot;,&quot;github_token&quot;,&quot;mfa_verification_token&quot;,&quot;moz-consent-pref&quot;,&quot;sudo&quot;],&quot;urlbase&quot;:&quot;https:\/\/bugzilla.mozilla.org\/&quot;},&quot;constant&quot;:{&quot;COMMENT_COLS&quot;:80},&quot;param&quot;:{&quot;maxattachmentsize&quot;:&quot;10240&quot;,&quot;maxusermatches&quot;:&quot;50&quot;,&quot;splinter_base&quot;:&quot;\/page.cgi?id=splinter.html&amp;ignore=\/&quot;,&quot;use_markdown&quot;:&quot;1&quot;},&quot;string&quot;:{&quot;TextEditor&quot;:{&quot;command_bold&quot;:&quot;Bold&quot;,&quot;command_bulleted_list&quot;:&quot;Bulleted list&quot;,&quot;command_code&quot;:&quot;Code&quot;,&quot;command_heading&quot;:&quot;Heading&quot;,&quot;command_italic&quot;:&quot;Italic&quot;,&quot;command_link&quot;:&quot;Link&quot;,&quot;command_numbered_list&quot;:&quot;Numbered list&quot;,&quot;command_quote&quot;:&quot;Quote&quot;,&quot;comment_editor&quot;:&quot;Comment Editor&quot;,&quot;edit&quot;:&quot;Edit&quot;,&quot;etiquette_link&quot;:{&quot;href&quot;:&quot;page.cgi?id=etiquette.html&quot;,&quot;text&quot;:&quot;Etiquette&quot;},&quot;guidelines_link&quot;:{&quot;href&quot;:&quot;page.cgi?id=bug-writing.html&quot;,&quot;text&quot;:&quot;Bug Writing Guidelines&quot;},&quot;loading&quot;:&quot;Loading…&quot;,&quot;markdown_link&quot;:{&quot;href&quot;:&quot;https:\/\/guides.github.com\/features\/mastering-markdown\/&quot;,&quot;text&quot;:&quot;Markdown supported&quot;},&quot;preview&quot;:&quot;Preview&quot;,&quot;preview_error&quot;:&quot;Preview could not be loaded. Please try again later.&quot;,&quot;text_editor&quot;:&quot;Text Editor&quot;,&quot;toolbar_label&quot;:&quot;Markdown text-formatting toolbar&quot;},&quot;bug&quot;:&quot;bug&quot;,&quot;bug_type_required&quot;:&quot;You must select a Type for this bug&quot;,&quot;component_required&quot;:&quot;You must select a Component for this bug&quot;,&quot;description_required&quot;:&quot;You must enter a Description for this bug&quot;,&quot;short_desc_required&quot;:&quot;You must enter a Summary for this bug&quot;,&quot;version_required&quot;:&quot;You must select a Version for this bug&quot;},&quot;user&quot;:{&quot;cookie_consent&quot;:&quot;&quot;,&quot;is_new&quot;:true,&quot;login&quot;:&quot;&quot;}}">
    <meta name="google-site-verification" content="JYXIuR9cAlV7fLmglSrc_4UaJS6Wzh5Mdxiorqu5AQc" />
    <title>1816390 - (CVE-2024-1554) Browser cache poisoning attack using fetch() with different headers</title>

<link rel="Top" href="/">

  


  
    <link rel="Show" title="Dependency Tree"
          href="/showdependencytree.cgi?id=1816390&amp;hide_resolved=1">
    <link rel="Show" title="Dependency Graph"
          href="/showdependencygraph.cgi?id=1816390">
    <link rel="Show" title="Bug Activity"
          href="/show_activity.cgi?id=1816390">

<link href="/static/v20250108.1/skins/standard/global.css" rel="stylesheet" type="text/css"><link href="/static/v20250108.1/extensions/BugModal/web/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20250108.1/js/jquery/plugins/contextMenu/contextMenu.css" rel="stylesheet" type="text/css"><link href="/static/v20250108.1/extensions/BMO/web/styles/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20250108.1/extensions/EditComments/web/styles/inline-comment-editor.css" rel="stylesheet" type="text/css"><link href="/static/v20250108.1/js/jquery/ui/jquery-ui-min.css" rel="stylesheet" type="text/css"><link href="/static/v20250108.1/js/jquery/ui/jquery-ui-structure-min.css" rel="stylesheet" type="text/css"><link href="/static/v20250108.1/js/jquery/ui/jquery-ui-theme-min.css" rel="stylesheet" type="text/css"><link href="/static/v20250108.1/skins/lib/prism.css" rel="stylesheet" type="text/css"><link href="/static/v20250108.1/skins/standard/consent.css" rel="stylesheet" type="text/css"><link href="/static/v20250108.1/extensions/Needinfo/web/styles/needinfo.css" rel="stylesheet" type="text/css"><link href="/static/v20250108.1/extensions/Review/web/styles/badge.css" rel="stylesheet" type="text/css"><link href="/static/v20250108.1/extensions/Review/web/styles/review.css" rel="stylesheet" type="text/css"><link href="/static/v20250108.1/skins/standard/text-editor.css" rel="stylesheet" type="text/css">



    
<script nonce="hpA0hGj0JJn7pHxOBmH4elY8pwVjemdqG9XQDMYo3QJb8fci" src="/static/v20250108.1/js/jquery/jquery-min.js"></script><script nonce="hpA0hGj0JJn7pHxOBmH4elY8pwVjemdqG9XQDMYo3QJb8fci" src="/static/v20250108.1/js/jquery/ui/jquery-ui-min.js"></script><script nonce="hpA0hGj0JJn7pHxOBmH4elY8pwVjemdqG9XQDMYo3QJb8fci" src="/static/v20250108.1/js/jquery/plugins/contextMenu/contextMenu-min.js"></script><script nonce="hpA0hGj0JJn7pHxOBmH4elY8pwVjemdqG9XQDMYo3QJb8fci" src="/static/v20250108.1/js/jquery/plugins/devbridgeAutocomplete/devbridgeAutocomplete-min.js"></script><script nonce="hpA0hGj0JJn7pHxOBmH4elY8pwVjemdqG9XQDMYo3QJb8fci" src="/static/v20250108.1/js/global.js"></script><script nonce="hpA0hGj0JJn7pHxOBmH4elY8pwVjemdqG9XQDMYo3QJb8fci" src="/static/v20250108.1/js/util.js"></script><script nonce="hpA0hGj0JJn7pHxOBmH4elY8pwVjemdqG9XQDMYo3QJb8fci" src="/static/v20250108.1/js/widgets.js"></script>

      <script nonce="hpA0hGj0JJn7pHxOBmH4elY8pwVjemdqG9XQDMYo3QJb8fci">BUGZILLA.value_descs = JSON.parse('{\"bug_status\":{},\"resolution\":{\"\":\"---\"}}');

  
    var tracking_flags_str = "{\"flags\":{\"project\":{\"cf_performance_impact\":\"---\",\"cf_a11y_review_project_flag\":\"---\",\"cf_webcompat_score\":\"---\",\"cf_accessibility_severity\":\"---\",\"cf_webcompat_priority\":\"---\"},\"tracking\":{\"cf_tracking_firefox_esr115\":\"---\",\"cf_tracking_thunderbird_esr115\":\"---\",\"cf_status_firefox134\":\"---\",\"cf_status_thunderbird_esr128\":\"---\",\"cf_tracking_firefox_relnote\":\"---\",\"cf_tracking_firefox_esr128\":\"---\",\"cf_tracking_firefox135\":\"---\",\"cf_tracking_firefox134\":\"---\",\"cf_status_firefox135\":\"---\",\"cf_status_firefox123\":\"fixed\",\"cf_status_firefox_esr128\":\"---\",\"cf_status_firefox136\":\"---\",\"cf_status_firefox121\":\"wontfix\",\"cf_tracking_firefox136\":\"---\",\"cf_tracking_thunderbird_esr128\":\"---\",\"cf_status_thunderbird_esr115\":\"---\",\"cf_status_firefox_esr115\":\"wontfix\",\"cf_status_firefox122\":\"wontfix\"}},\"comments\":{\"cf_a11y_review_project_flag\":{\"requested\":\"Description:\\nPlease provide an explanation of the feature or change. Include a description of the user scenario in which it would be used and how the user would complete the task(s).\\nScreenshots and visual UI specs are welcome, but please include sufficient accompanying explanation so that blind members of the accessibility team are able to understand the feature\/change.\\n\\nHow do we test this?\\nIf there is an implementation to test, please provide instructions for testing it; e.g. setting preferences, other preparation, how to trigger the UI, etc.\\n\\nWhen will this ship?\\nTracking bug\/issue:\\nDesign documents (e.g. Product Requirements Document, UI spec):\\nEngineering lead:\\nProduct manager:\\n\\nThe accessibility team has developed the Mozilla Accessibility Release Guidelines which outline what is needed to make user interfaces accessible:\\nhttps:\/\/wiki.mozilla.org\/Accessibility\/Guidelines\\nPlease describe the accessibility guidelines you considered and what steps you\'ve taken to address them:\\n\\nDescribe any areas of concern to which you want the accessibility team to give special attention:\"},\"cf_tracking_firefox_esr128\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_relnote\":{\"?\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox_esr115\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox134\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox135\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox136\":{\"?\":\"[Tracking Requested - why for this release]:\"}},\"types\":[\"tracking\"]}";
    var TrackingFlags = $.parseJSON(tracking_flags_str);

  
    BUGZILLA.bug_id = 1816390;
    BUGZILLA.bug_title = '1816390 - (CVE-2024-1554) Browser cache poisoning attack using fetch() with different headers';
    BUGZILLA.bug_summary = 'Browser cache poisoning attack using fetch() with different headers';
    BUGZILLA.bug_url = 'https:\/\/bugzilla.mozilla.org\/show_bug.cgi?id=1816390';
    BUGZILLA.bug_keywords = 'reporter-external, sec-moderate',
    BUGZILLA.bug_secure = false;
    

  BUGZILLA.user = {
    id: 0,
    login: '',
    is_insider: false,
    is_timetracker: false,
    can_tag: false,
    can_triage: false,
    timezone: 'America\/Los_Angeles',
    settings: {
      quote_replies: 'quoted_reply',
      zoom_textareas: true,
      remember_collapsed: true,
      inline_attachments: true,
      autosize_comments: false
    },
    cookie_consent: false
  };
  review_suggestions = {
    _mentors: [
    ],


      
      'Networking: Cache': [
      ],

    
    _end: 1
  };

    static_component = 'Networking: Cache';
      </script>
<script nonce="hpA0hGj0JJn7pHxOBmH4elY8pwVjemdqG9XQDMYo3QJb8fci" src="/static/v20250108.1/js/text-editor.js"></script><script nonce="hpA0hGj0JJn7pHxOBmH4elY8pwVjemdqG9XQDMYo3QJb8fci" src="/static/v20250108.1/extensions/BugModal/web/autosize.min.js"></script><script nonce="hpA0hGj0JJn7pHxOBmH4elY8pwVjemdqG9XQDMYo3QJb8fci" src="/static/v20250108.1/extensions/ProdCompSearch/web/js/prod_comp_search.js"></script><script nonce="hpA0hGj0JJn7pHxOBmH4elY8pwVjemdqG9XQDMYo3QJb8fci" src="/static/v20250108.1/extensions/BugModal/web/attachments_overlay.js"></script><script nonce="hpA0hGj0JJn7pHxOBmH4elY8pwVjemdqG9XQDMYo3QJb8fci" src="/static/v20250108.1/extensions/BugModal/web/bug_modal.js"></script><script nonce="hpA0hGj0JJn7pHxOBmH4elY8pwVjemdqG9XQDMYo3QJb8fci" src="/static/v20250108.1/extensions/BugModal/web/comments.js"></script><script nonce="hpA0hGj0JJn7pHxOBmH4elY8pwVjemdqG9XQDMYo3QJb8fci" src="/static/v20250108.1/extensions/ComponentWatching/web/js/overlay.js"></script><script nonce="hpA0hGj0JJn7pHxOBmH4elY8pwVjemdqG9XQDMYo3QJb8fci" src="/static/v20250108.1/js/bugzilla-readable-status-min.js"></script><script nonce="hpA0hGj0JJn7pHxOBmH4elY8pwVjemdqG9XQDMYo3QJb8fci" src="/static/v20250108.1/js/field.js"></script><script nonce="hpA0hGj0JJn7pHxOBmH4elY8pwVjemdqG9XQDMYo3QJb8fci" src="/static/v20250108.1/js/comments.js"></script><script nonce="hpA0hGj0JJn7pHxOBmH4elY8pwVjemdqG9XQDMYo3QJb8fci" src="/static/v20250108.1/js/util.js"></script><script nonce="hpA0hGj0JJn7pHxOBmH4elY8pwVjemdqG9XQDMYo3QJb8fci" src="/static/v20250108.1/extensions/TrackingFlags/web/js/flags.js"></script><script nonce="hpA0hGj0JJn7pHxOBmH4elY8pwVjemdqG9XQDMYo3QJb8fci" src="/static/v20250108.1/extensions/BMO/web/js/firefox-crash-table.js"></script><script nonce="hpA0hGj0JJn7pHxOBmH4elY8pwVjemdqG9XQDMYo3QJb8fci" src="/static/v20250108.1/extensions/MozChangeField/web/js/severity-s1-priority-p1.js"></script><script nonce="hpA0hGj0JJn7pHxOBmH4elY8pwVjemdqG9XQDMYo3QJb8fci" src="/static/v20250108.1/extensions/MozChangeField/web/js/clear-tracking-priority-s1.js"></script><script nonce="hpA0hGj0JJn7pHxOBmH4elY8pwVjemdqG9XQDMYo3QJb8fci" src="/static/v20250108.1/extensions/MozChangeField/web/js/set-tracking-severity-s1.js"></script><script nonce="hpA0hGj0JJn7pHxOBmH4elY8pwVjemdqG9XQDMYo3QJb8fci" src="/static/v20250108.1/js/lib/prism.js"></script><script nonce="hpA0hGj0JJn7pHxOBmH4elY8pwVjemdqG9XQDMYo3QJb8fci" src="/static/v20250108.1/js/consent.js"></script><script nonce="hpA0hGj0JJn7pHxOBmH4elY8pwVjemdqG9XQDMYo3QJb8fci" src="/static/v20250108.1/js/cookie-helper.js"></script><script nonce="hpA0hGj0JJn7pHxOBmH4elY8pwVjemdqG9XQDMYo3QJb8fci" src="/static/v20250108.1/js/lib/md5.min.js"></script><script nonce="hpA0hGj0JJn7pHxOBmH4elY8pwVjemdqG9XQDMYo3QJb8fci" src="/static/v20250108.1/extensions/Review/web/js/badge.js"></script><script nonce="hpA0hGj0JJn7pHxOBmH4elY8pwVjemdqG9XQDMYo3QJb8fci" src="/static/v20250108.1/extensions/Review/web/js/review.js"></script>

    

    
    <link href="/static/v20250108.1/skins/lib/fontawesome.min.css" rel="stylesheet" type="text/css">
    <link href="/static/v20250108.1/skins/lib/fontawesome-brands.min.css" rel="stylesheet" type="text/css">
    <link href="/static/v20250108.1/skins/lib/fontawesome-solid.min.css" rel="stylesheet" type="text/css">

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla@Mozilla" href="/search_plugin.cgi"><link rel="shortcut icon" href="/extensions/BMO/web/images/favicon.ico">
<link rel="canonical" href="https://bugzilla.mozilla.org/show_bug.cgi?id=1816390">
<link rel="shorturl" href="https://bugzilla.mozilla.org/1816390"><meta name="robots" content="noarchive">
  </head>



  <body
        class="bugzilla-mozilla-org
               skin-standard bug_modal">



<div id="wrapper">

<header id="header" role="banner" aria-label="Global Header">
  <div class="inner" role="none">
    <button type="button" class="iconic ghost" id="open-menu-drawer" aria-label="Open Site Menu">
      <span class="icon" aria-hidden="true" data-icon="menu"></span>
    </button><div id="header-external-links" class="dropdown" role="none">
  <button type="button" id="header-external-menu-button" class="dropdown-button minor"
          aria-label="Show Mozilla Menu" aria-expanded="false" aria-haspopup="true"
          aria-controls="header-external-menu">
    <img src="/static/v20250108.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg"
         width="32" height="32" alt="">
  </button>
  <ul class="dropdown-content right" id="header-external-menu" role="menu" aria-label="Mozilla Menu"
      style="display:none;">
    <li role="none">
      <a href="https://www.mozilla.org/" role="menuitem">
        <span class="label" role="none">Mozilla Home</span>
      </a>
    </li>
    <li role="separator"></li>
    <li role="none">
      <a href="https://www.mozilla.org/privacy/websites/" role="menuitem">
        <span class="label" role="none">Privacy</span>
      </a>
    </li>
    <li role="none">
      <a href="https://www.mozilla.org/privacy/websites/#cookies" role="menuitem">
        <span class="label" role="none">Cookies</span>
      </a>
    </li>
    <li role="none">
      <a href="https://www.mozilla.org/about/legal/" role="menuitem">
        <span class="label" role="none">Legal</span>
      </a>
    </li>
  </ul>
</div>
    <h1 id="header-title" class="title" role="none">
      <a class="header-button" href="https://bugzilla.mozilla.org/home" title="Go to home page">
        <span aria-label="Go to Bugzilla Home Page">Bugzilla</span>
      </a>
    </h1>
    <form id="header-search" class="quicksearch" action="/buglist.cgi"
          data-no-csrf role="search" aria-label="Search Bugs">
      <button type="button" class="iconic ghost" id="show-searchbox"
              aria-label="Search Bugs">
        <span class="icon" aria-hidden="true" data-icon="search"></span>
      </button>
      <div class="searchbox-outer dropdown" role="combobox" aria-label="Quick Search"
           aria-haspopup="listbox" aria-owns="header-search-dropdown" aria-expanded="false">
        <span class="icon" aria-hidden="true" data-icon="search"></span>
        <input id="quicksearch_top" class="dropdown-button" name="quicksearch" autocomplete="off"
               value="" accesskey="s"
               placeholder="Search Bugs"
               title="Enter a bug number or some search terms"
               role="searchbox" aria-controls="header-search-dropdown" aria-label="Search Terms"><div id="header-search-dropdown" class="dropdown-content dropdown-panel right" role="listbox"
     style="display: none;">
  <div id="header-search-dropdown-wrapper" role="none">
    <section id="header-search-dropdown-help" role="group" aria-label="Help">
      <footer role="none">
        <a href="/page.cgi?id=quicksearch.html">Quick Search Tips</a>
        <a href="/query.cgi?format=advanced">Advanced Search</a>
      </footer>
    </section>
  </div>
</div>
      </div>
    </form>
    <nav id="header-nav" role="menubar" aria-label="Site Links">
      <ul class="links" role="none"><li role="none">
    <a class="header-button" href="/describecomponents.cgi"
       title="Browse bugs by component" role="menuitem">
      <span class="icon" aria-hidden="true" data-icon="category"></span>
      <span class="label" role="none">Browse</span>
    </a>
  </li>
  <li role="none">
    <a class="header-button" href="/query.cgi?format=advanced"
       title="Search bugs using various criteria" role="menuitem">
      <span class="icon" aria-hidden="true" data-icon="pageview"></span>
      <span class="label" role="none">Advanced Search</span>
    </a>
  </li>
  <li role="none">
    <a class="header-button" href="/enter_bug.cgi"
       title="File a new bug" role="menuitem">
      <span class="icon" aria-hidden="true" data-icon="add_box"></span>
      <span class="label" role="none">New Bug</span>
    </a>
  </li>
      </ul>
      <div class="dropdown" role="none">
        <button type="button" id="header-tools-menu-button"
                class="header-button dropdown-button minor" title="More tools…"
                role="menuitem" aria-label="Show More Tools Menu" aria-expanded="false"
                aria-haspopup="true" aria-controls="header-tools-menu">
          <span class="icon" aria-hidden="true" data-icon="more_horiz"></span>
        </button>
        <ul class="dropdown-content left" id="header-tools-menu" role="menu"
            aria-label="More Tools Menu" style="display:none;"><li role="none">
    <a href="/report.cgi" role="menuitem">
      <span class="icon" aria-hidden="true" data-icon="analytics"></span>
      <span class="label" role="none">Reports</span>
    </a>
  </li>
    <li role="separator"></li>
    <li role="none">
      <a href="https://bmo.readthedocs.io/en/latest/" target="_blank" role="menuitem">
        <span class="icon" aria-hidden="true" data-icon="help"></span>
        <span class="label" role="none">Documentation</span>
      </a>
    </li>
        </ul>
      </div>
    </nav>
      <ul id="header-login" class="links" role="none"><li id="mini_login_container_top" role="none">
  <a id="login_link_top" href="/index.cgi?GoAheadAndLogIn=1"
     class='show_mini_login_form header-button' data-qs-suffix="_top"
     role="button">
    <span class="icon" aria-hidden="true" data-icon="login"></span>
    <span class="label" role="none">Log In</span>
  </a>

  <div id="mini_login_top" class="mini-popup mini_login bz_default_hidden">

<form method="post" action="/github.cgi">
    <input type="hidden" name="github_token" value="cQ3TjdjBIan5kvGcGcs48pJbxTzcFtDF6veFUJaH4P2TomKnEUuRegvIvHn8oEOs1wst1EIU8bH6bnpfOotBdbRqnCty4VB7srAcLKTyy2eBZ6Kh32oAIewopGyiXnXb1x9XH7SZlotByNfD08CUErdfeVvl9nDzUzBVwJjjPjqbMShk3Vkj1a6eONy3xzVxSRrAPuegozGdigXDT2nhXqqnQgLAqxYlIrnWXAoRvG57XJ3yQ3JYpaJaYQy3CiTz">
    <input type="hidden" name="target_uri" value="https://bugzilla.mozilla.org/show_bug.cgi">
    <button type="submit">
      <i class="fab fa-github"></i> Log In with GitHub
    </button>
  </form>

    <div class="method-separator">or</div>

  <form action="/show_bug.cgi?id=1816390" method="POST"
        data-qs-suffix="_top">

    <input id="Bugzilla_login_top"
           class="bz_login"
           name="Bugzilla_login"
           title="Login"
           placeholder="Email"
           aria-label="Email"
           type="email"
           required
    >
    <input class="bz_password"
           id="Bugzilla_password_top"
           name="Bugzilla_password"
           type="password"
           title="Password"
           placeholder="Password"
           aria-label="Password"
           required
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text"
           id="Bugzilla_password_dummy_top" value="password"
           title="Password"
    >
      <span class="remember-outer">
        <input type="checkbox" id="Bugzilla_remember_top"
               name="Bugzilla_remember" value="on" class="bz_remember"
               checked>
        <label for="Bugzilla_remember_top">Remember me</label>
      </span>
    <input type="hidden" name="Bugzilla_login_token"
           value="1736533881-WbQtY3P0g8h_NyXkmWkqEiBemFsWsTj2rK7SsuqUWSA">
    <input type="submit" name="GoAheadAndLogIn" value="Log In" id="log_in_top"
           class="check_mini_login_fields" data-qs-suffix="_top">
    <a href="#" id="hide_mini_login_top" aria-label="Close"
       class="close-button hide_mini_login_form" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  <div class="footer">
      <a href="/createaccount.cgi">Create an Account</a>
    &middot;
    <a id="forgot_link_top" href="/index.cgi?GoAheadAndLogIn=1#forgot"
       class='show_forgot_form'
       data-qs-suffix="_top">Forgot Password</a>
  </div>
  </div>

  <div id="forgot_form_top" class="mini-popup mini_forgot bz_default_hidden">
  <form action="/token.cgi" method="post">
    <input type="email" name="loginname" size="20" placeholder="Email" aria-label="Email" required>
    <input id="forgot_button_top" value="Reset Password"
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <input type="hidden" id="token_top" name="token" value="1736533881-tGGvZWmMwAbnpZbJht1LE22KMq1B_9-CP325XRriAhk">
    <a href="#" class="close-button hide_forgot_form" aria-label="Close" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
      </ul>
  </div>
  <dialog id="menu-drawer" inert aria-label="Site Menu">
    <div class="drawer-inner" role="none">
      <div class="header" role="none">
        <button type="button" class="iconic ghost" id="close-menu-drawer"
                aria-label="Close Site Menu">
          <span class="icon" aria-hidden="true" data-icon="close"></span>
        </button>
      </div>
      <ul role="menu" aria-label="Site Links"><li role="none">
    <a class="header-button" href="/describecomponents.cgi"
       title="Browse bugs by component" role="menuitem">
      <span class="icon" aria-hidden="true" data-icon="category"></span>
      <span class="label" role="none">Browse</span>
    </a>
  </li>
  <li role="none">
    <a class="header-button" href="/query.cgi?format=advanced"
       title="Search bugs using various criteria" role="menuitem">
      <span class="icon" aria-hidden="true" data-icon="pageview"></span>
      <span class="label" role="none">Advanced Search</span>
    </a>
  </li>
  <li role="none">
    <a class="header-button" href="/enter_bug.cgi"
       title="File a new bug" role="menuitem">
      <span class="icon" aria-hidden="true" data-icon="add_box"></span>
      <span class="label" role="none">New Bug</span>
    </a>
  </li><li role="none">
    <a href="/report.cgi" role="menuitem">
      <span class="icon" aria-hidden="true" data-icon="analytics"></span>
      <span class="label" role="none">Reports</span>
    </a>
  </li>
    <li role="separator"></li>
    <li role="none">
      <a href="https://bmo.readthedocs.io/en/latest/" target="_blank" role="menuitem">
        <span class="icon" aria-hidden="true" data-icon="help"></span>
        <span class="label" role="none">Documentation</span>
      </a>
    </li>
      </ul>
    </div>
  </dialog>
</header> 


<main id="bugzilla-body" tabindex="-1">

<aside id="message-container" role="complementary">
  <noscript>
    <div class="noscript">
      <div class="inner">
        <p>Please enable JavaScript in your browser to use all the features on this site.</p>
      </div>
    </div>
  </noscript>
</aside>

<div id="main-inner">




<div role="toolbar" id="page-toolbar">
  <div role="group" class="buttons">
    <button type="button" id="copy-summary" class="secondary separate-dropdown-button-main"
      title="Copy bug number and summary to your clipboard">Copy Summary</button
    ><div id="copy-menu-dropdown" class="dropdown"><button type="button" id="copy-menu-btn" aria-haspopup="true" aria-label="View"
      aria-expanded="false" aria-controls="copy-menu" class="dropdown-button secondary separate-dropdown-button-arrow"
      title="More options for copy">&#9662;</button>
      <ul class="dropdown-content left" id="copy-menu" role="menu" style="display:none;">
        <li role="presentation">
          <a id="copy-markdown-summary" role="menuitem" tabindex="-1">Markdown</a>
        </li>
        <li role="presentation">
          <a id="copy-markdown-bug-number" role="menuitem" tabindex="-1">Markdown (bug number)</a>
        </li>
        <li role="presentation">
          <a id="copy-text-summary" role="menuitem" tabindex="-1">Plain Text</a>
        </li>
        <li role="presentation">
          <a id="copy-html-summary" role="menuitem" tabindex="-1">HTML</a>
        </li>
      </ul>
    </div>
    <div id="clip-container" style="display:none"><input type="text" id="clip"></div>
    <div class="dropdown">
      <button type="button" id="action-menu-btn" aria-haspopup="true" aria-label="View"
        aria-expanded="false" aria-controls="action-menu" class="dropdown-button secondary">View &#9662;</button>
      <ul class="dropdown-content left" id="action-menu" role="menu" style="display:none;">
        <li role="presentation">
          <a id="action-reset" role="menuitem" tabindex="-1">Reset Sections</a>
        </li>
        <li role="presentation">
          <a id="action-expand-all" role="menuitem" tabindex="-1">Expand All Sections</a>
        </li>
        <li role="presentation">
          <a id="action-collapse-all" role="menuitem" tabindex="-1">Collapse All Sections</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a id="action-history" role="menuitem" tabindex="-1">History</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a href="/rest/bug/1816390" role="menuitem" tabindex="-1">JSON</a>
        </li>
        <li role="presentation">
          <a href="/show_bug.cgi?ctype=xml&amp;id=1816390" role="menuitem" tabindex="-1">XML</a>
        </li>
      </ul>
    </div>
  </div>
</div>



<div role="status" id="io-error" style="display:none"></div>
<div role="status" id="floating-message" style="display:none">
  <div id="floating-message-text"></div>
</div>
<section class="module"
>
  <div class="module-content"
  >
  <div id="summary-container">
    <div class="field bug_modal indent"
    id="field-status_summary"
>



  
    <div class=" container">
        <span id="field-value-status_summary">
      <span class="bug-status-label text" data-status="closed">Closed</span>
      <span id="field-value-bug_id">
        <a href="/show_bug.cgi?id=1816390">Bug 1816390</a>
          <span class="edit-hide">(CVE-2024-1554)</span>
      </span>
      <span class="bug-time-labels">
        <span class="bug-time-label">Opened <span class="rel-time" title="2023-02-13 02:32 PST" data-time="1676284359">2 years ago</span></span>
          <span class="bug-time-label">Closed <span class="rel-time" title="2024-01-16 08:42 PST" data-time="1705423362">1 year ago</span></span>
      </span>
        </span>
    </div>

  
</div>
<div class="field bug_modal indent edit-hide"
>



  
    <div class=" container">
      

      <h1 id="field-value-short_desc">Browser cache poisoning attack using fetch() with different headers</h1>
    </div>

  
</div>

    <div class="field bug_modal edit-show"
    id="field-short_desc" style="display:none"
>
    <div class="name">
      
        <span class="required_star edit-show" style="display:none" aria-label="Required Field">*</span> 
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc" id="short_desc-help-link" class="help">Summary:
        </a>
    </div>



  
    <div class="value">
        <span id="field-value-short_desc">
            Browser cache poisoning attack using fetch() with different headers

        </span>
    </div>

  
</div>
  </div>
  </div>
</section>


<section class="module" id="module-categories"
>
    <header id="module-categories-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Categories section"
           data-label-collapsed="Expand Categories section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-categories-content"
             aria-expanded="true"
             aria-labeledby="module-categories-title"
             aria-describedby="module-categories-subtitle"></div>
        <h2 class="module-title" id="module-categories-title">Categories</h2>
          <h3 class="module-subtitle" id="module-categories-subtitle">
            (Core :: Networking: Cache, defect, P2)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-categories-content"
  ><div class="fields-lhs">

    <div class="field bug_modal"
    id="field-product"
>
    <div class="name">
      
        <a href="/describecomponents.cgi?product=Core" id="product-help-link" class="help">Product:
        </a>
    </div>



  
    <div class="value">
        <span id="field-value-product">
      <div class="name-info-outer dropdown">
        <span id="product-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="product-info">Core
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="product-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Product description and actions">
          <header>
            <div class="title">Core</div>
            <div class="description">Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the <a href="https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox">Firefox</a> product. (<a href="https://wiki.mozilla.org/Modules/All#Core">More info</a>)</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=Core&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Product</a></div>
            <div><a href="/enter_bug.cgi?product=Core"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Product</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="Core"
                         data-label-watch="Watch This Product" data-label-unwatch="Unwatch This Product"
                         data-source="BugModal">Watch This Product</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field bug_modal"
    id="field-component"
>
    <div class="name">
      
        <a href="/describecomponents.cgi?product=Core&component=Networking%3A%20Cache#Networking%3A%20Cache" id="component-help-link" class="help">Component:
        </a>
    </div>



  
    <div class="value">
        <span id="field-value-component">
      <div class="name-info-outer dropdown">
        <span id="component-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="component-info">Networking: Cache
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="component-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Component description and actions">
          <header>
            <div class="title">Core :: Networking: Cache</div>
            <div class="description">For bugs in the cache, which stores recently accessed data for more rapid access. Includes the disk cache, memory cache, and all cache preferences.<br><br> 

Examples of appropriate bugs: Implement compression of network cache data; or Implement partial HTTP caching.</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=Core&amp;component=Networking%3A%20Cache&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Component</a></div>
            <div><a href="/buglist.cgi?product=Core&amp;component=Networking%3A%20Cache&amp;chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__"
                    target="_blank" role="menuitem" tabindex="-1">Recently Fixed Bugs in This Component</a></div>
            <div><a href="/enter_bug.cgi?product=Core&amp;component=Networking%3A%20Cache"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Component</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="Core" data-component="Networking: Cache"
                         data-label-watch="Watch This Component" data-label-unwatch="Unwatch This Component"
                         data-source="BugModal">Watch This Component</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field bug_modal"
    id="field-version"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#version" id="version-help-link" class="help">Version:
        </a>
    </div>



  
    <div class="value">
        <span id="field-value-version">
            Firefox 109

        </span>
    </div>

  
</div>

    <div class="field bug_modal edit-show" style="display:none"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform" id="-help-link" class="help">Platform:
        </a>
    </div>



  
    <div class=" container"><div class="field bug_modal inline"
    id="field-rep_platform"
>



  
    <div class="value">
        <span id="field-value-rep_platform">
            Unspecified

        </span>
    </div>

  
</div><div class="field bug_modal indent inline"
    id="field-op_sys"
>



  
    <div class="value">
        <span id="field-value-op_sys">
            Unspecified

        </span>
    </div>

  
</div><div class="field bug_modal"
>



  
    <div class=" container">
    </div>

  
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field bug_modal contains-buttons"
    id="field-bug_type"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type" id="bug_type-help-link" class="help">Type:
        </a>
    </div>



  
    <div class="value">
        <span id="field-value-bug_type">
      <span class="bug-type-label iconic-text" data-type="defect">
        <span class="icon" aria-hidden="true"></span>defect</span>
        </span>
    </div>

  
</div>

    <div class="field bug_modal"
    id="field-importance"
>



  
    <div class=" container">
        <span id="field-value-importance"><div class="field bug_modal inline"
    id="field-priority"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority" id="priority-help-link" class="help">Priority:
        </a>
    </div>



  
    <div class="value">
        <span id="field-value-priority">P2
        </span>
    </div>

  
</div><div class="field bug_modal inline"
    id="field-bug_severity"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity" id="bug_severity-help-link" class="help">Severity:
        </a>
    </div>



  
    <div class="value">
        <span id="field-value-bug_severity">
            S3

        </span>
    </div>

  
</div>
        </span>
    </div>

  
</div>


    <div class="field bug_modal edit-show"
    id="field-cf_fx_points" style="display:none"
>
    <div class="name">
      Points:
    </div>



  
    <div class="value">
        <span id="field-value-cf_fx_points">
            ---

        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-tracking"
>
    <header id="module-tracking-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Tracking section"
           data-label-collapsed="Expand Tracking section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-tracking-content"
             aria-expanded="true"
             aria-labeledby="module-tracking-title"
             aria-describedby="module-tracking-subtitle"></div>
        <h2 class="module-title" id="module-tracking-title">Tracking</h2>
          <h3 class="module-subtitle" id="module-tracking-subtitle">
            (<span id="readable-bug-status" data-readable-bug-status="{&quot;cf_status_firefox136&quot;:&quot;---&quot;,&quot;cf_status_firefox_esr128&quot;:&quot;---&quot;,&quot;cf_a11y_review_project_flag&quot;:&quot;---&quot;,&quot;resolution&quot;:&quot;FIXED&quot;,&quot;cf_tracking_thunderbird_esr128&quot;:&quot;---&quot;,&quot;priority&quot;:&quot;P2&quot;,&quot;keywords&quot;:[&quot;reporter-external&quot;,&quot;sec-moderate&quot;],&quot;cf_status_firefox_esr115&quot;:&quot;wontfix&quot;,&quot;cf_status_firefox122&quot;:&quot;wontfix&quot;,&quot;flags&quot;:[{&quot;status&quot;:&quot;+&quot;,&quot;name&quot;:&quot;sec-bounty&quot;},{&quot;name&quot;:&quot;qe-verify&quot;,&quot;status&quot;:&quot;-&quot;}],&quot;target_milestone&quot;:&quot;123 Branch&quot;,&quot;cf_tracking_thunderbird_esr115&quot;:&quot;---&quot;,&quot;id&quot;:1816390,&quot;cf_tracking_firefox135&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_relnote&quot;:&quot;---&quot;,&quot;cf_status_firefox123&quot;:&quot;fixed&quot;,&quot;cf_status_firefox135&quot;:&quot;---&quot;,&quot;cf_webcompat_score&quot;:&quot;---&quot;,&quot;cf_tracking_firefox136&quot;:&quot;---&quot;,&quot;cf_status_firefox121&quot;:&quot;wontfix&quot;,&quot;cf_status_thunderbird_esr115&quot;:&quot;---&quot;,&quot;cf_webcompat_priority&quot;:&quot;---&quot;,&quot;cf_accessibility_severity&quot;:&quot;---&quot;,&quot;dupe_of&quot;:null,&quot;cf_status_firefox134&quot;:&quot;---&quot;,&quot;cf_performance_impact&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_esr115&quot;:&quot;---&quot;,&quot;cf_status_thunderbird_esr128&quot;:&quot;---&quot;,&quot;cf_tracking_firefox134&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_esr128&quot;:&quot;---&quot;,&quot;status&quot;:&quot;RESOLVED&quot;}"></span>)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-tracking-content"
  ><div class="fields-lhs">

    <div class="field bug_modal edit-hide"
    id="field-status-view"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-view-help-link" class="help">Status:
        </a>
    </div>



  
    <div class=" container">
        <span id="field-value-status-view">RESOLVED
        FIXED
        </span>
    </div>

  
</div>

    <div class="field bug_modal edit-show"
    id="field-status-edit" style="display:none"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-edit-help-link" class="help">Status:
        </a>
    </div>



  
    <div class=" container">
        <span id="field-value-status-edit"><div class="field bug_modal inline"
    id="field-bug_status"
>



  
    <div class="value">
        <span id="field-value-bug_status">
            RESOLVED

        </span>
    </div>

  
</div><div class="field bug_modal indent inline"
    id="field-resolution"
>



  
    <div class="value">
        <span id="field-value-resolution">
            FIXED

        </span>
    </div>

  
</div>
  <div id="status-action-buttons">
      <div id="assigned-container" style="display:none">
        <button type="button" class="secondary" id="mark-as-assigned-btn">
          Mark as Assigned
        </button>
      </div>
  </div>
        </span>
    </div>

  
</div>

    <div class="field bug_modal"
    id="field-target_milestone"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone" id="target_milestone-help-link" class="help">Milestone:
        </a>
    </div>



  
    <div class="value">
        <span id="field-value-target_milestone">
            123 Branch

        </span>
    </div>

  
</div>

    <div class="field bug_modal edit-show"
    id="field-cf_fx_iteration" style="display:none"
>
    <div class="name">
      Iteration:
    </div>



  
    <div class="value">
        <span id="field-value-cf_fx_iteration">
            ---

        </span>
    </div>

  
</div>


      <div class="field bug_modal edit-show" style="display:none"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Project_Flags" id="-help-link" class="help">Project Flags:
        </a>
    </div>



  
    <div class=" container"><div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <td class="tracking-flag-name">Performance Impact</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_performance_impact-dirty">
  <select id="cf_performance_impact" name="cf_performance_impact">
        <option value="---"
          id="v5427_cf_performance_impact" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">a11y-review</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_a11y_review_project_flag-dirty">
  <select id="cf_a11y_review_project_flag" name="cf_a11y_review_project_flag">
        <option value="---"
          id="v4876_cf_a11y_review_project_flag" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Accessibility Severity</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_accessibility_severity-dirty">
  <select id="cf_accessibility_severity" name="cf_accessibility_severity">
        <option value="---"
          id="v6045_cf_accessibility_severity" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Webcompat Score</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_webcompat_score-dirty">
  <select id="cf_webcompat_score" name="cf_webcompat_score">
        <option value="---"
          id="v6757_cf_webcompat_score" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Webcompat Priority</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_webcompat_priority-dirty">
  <select id="cf_webcompat_priority" name="cf_webcompat_priority">
        <option value="---"
          id="v4274_cf_webcompat_priority" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

      <div class="field tracking-flags-wrapper"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Tracking Flags:
        </a>
    </div>



  
    <div class=" container"><div class="flags edit-hide">
    <table class="layout-table tracking-flags">
        <tr>
          <th></th>
          <th>Tracking</th>
          <th>Status</th>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox-esr115</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox_esr115&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox121</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox121&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox122</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox122&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox123</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox123&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
    </table>
  </div>


<div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <th></th>
        <th>Tracking</th>
        <th>Status</th>
      </tr>
      <tr>
        <td class="tracking-flag-name">relnote-firefox</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_relnote-dirty">
  <select id="cf_tracking_firefox_relnote" name="cf_tracking_firefox_relnote">
        <option value="---"
          id="v539_cf_tracking_firefox_relnote" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr115</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr115-dirty">
  <select id="cf_tracking_thunderbird_esr115" name="cf_tracking_thunderbird_esr115">
        <option value="---"
          id="v6094_cf_tracking_thunderbird_esr115" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr115-dirty">
  <select id="cf_status_thunderbird_esr115" name="cf_status_thunderbird_esr115">
        <option value="---"
          id="v6100_cf_status_thunderbird_esr115" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr128</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr128-dirty">
  <select id="cf_tracking_thunderbird_esr128" name="cf_tracking_thunderbird_esr128">
        <option value="---"
          id="v6557_cf_tracking_thunderbird_esr128" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr128-dirty">
  <select id="cf_status_thunderbird_esr128" name="cf_status_thunderbird_esr128">
        <option value="---"
          id="v6576_cf_status_thunderbird_esr128" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr115</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr115-dirty">
  <select id="cf_tracking_firefox_esr115" name="cf_tracking_firefox_esr115">
        <option value="---"
          id="v6079_cf_tracking_firefox_esr115" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr115-dirty">
  <select id="cf_status_firefox_esr115" name="cf_status_firefox_esr115">
        <option value="wontfix"
          id="v6093_cf_status_firefox_esr115" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr128</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr128-dirty">
  <select id="cf_tracking_firefox_esr128" name="cf_tracking_firefox_esr128">
        <option value="---"
          id="v6501_cf_tracking_firefox_esr128" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr128-dirty">
  <select id="cf_status_firefox_esr128" name="cf_status_firefox_esr128">
        <option value="---"
          id="v6505_cf_status_firefox_esr128" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox121</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox121-dirty">
  <select id="cf_status_firefox121" name="cf_status_firefox121">
        <option value="wontfix"
          id="v6264_cf_status_firefox121" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox122</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox122-dirty">
  <select id="cf_status_firefox122" name="cf_status_firefox122">
        <option value="wontfix"
          id="v6293_cf_status_firefox122" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox123</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox123-dirty">
  <select id="cf_status_firefox123" name="cf_status_firefox123">
        <option value="fixed"
          id="v6334_cf_status_firefox123" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox134</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox134-dirty">
  <select id="cf_tracking_firefox134" name="cf_tracking_firefox134">
        <option value="---"
          id="v6773_cf_tracking_firefox134" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox134-dirty">
  <select id="cf_status_firefox134" name="cf_status_firefox134">
        <option value="---"
          id="v6778_cf_status_firefox134" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox135</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox135-dirty">
  <select id="cf_tracking_firefox135" name="cf_tracking_firefox135">
        <option value="---"
          id="v6816_cf_tracking_firefox135" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox135-dirty">
  <select id="cf_status_firefox135" name="cf_status_firefox135">
        <option value="---"
          id="v6821_cf_status_firefox135" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox136</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox136-dirty">
  <select id="cf_tracking_firefox136" name="cf_tracking_firefox136">
        <option value="---"
          id="v6838_cf_tracking_firefox136" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox136-dirty">
  <select id="cf_status_firefox136" name="cf_status_firefox136">
        <option value="---"
          id="v6843_cf_status_firefox136" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>

</div>
  </div>
</section>



<section class="module" id="module-people"
>
    <header id="module-people-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse People section"
           data-label-collapsed="Expand People section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-people-content"
             aria-expanded="false"
             aria-labeledby="module-people-title"
             aria-describedby="module-people-subtitle"></div>
        <h2 class="module-title" id="module-people-title">People</h2>
          <h3 class="module-subtitle" id="module-people-subtitle">
            (Reporter: martin.oneal, Assigned: valentin)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-people-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field bug_modal edit-hide"
    id="field-assigned_to"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>



  
    <div class="value">
        <span id="field-value-assigned_to"><div class="vcard vcard_415378" ><img src="https://secure.gravatar.com/avatar/dedff9d4500fcbc5cdd1cd270f044b33?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=415378" > <span class="fna">valentin</span></a>
</div>
        </span>
    </div>

  
</div><div class="field bug_modal edit-show"
    id="field-assigned_to" style="display:none"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>



  
    <div class="value">
        <span id="field-value-assigned_to">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-assignee" name="set_default_assignee" class="set-default"
          value="1" data-for="assigned_to">
        <label for="set-default-assignee">Reset Assignee to default</label>
      </div>
        </span>
    </div>

  
</div>

    <div class="field bug_modal edit-show"
    id="field-bug_mentors" style="display:none"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor" id="bug_mentors-help-link" class="help">Mentors:
        </a>
    </div>



  
    <div class="value">
        <span id="field-value-bug_mentors">---
        </span>
    </div>

  
</div>

    <div class="field bug_modal edit-show"
    id="field-qa_contact" style="display:none"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact" id="qa_contact-help-link" class="help">QA Contact:
        </a>
    </div>



  
    <div class="value">
        <span id="field-value-qa_contact">
        <div class="set-default-container" style="display:none">
          <input type="checkbox" id="set-default-qa-contact" name="set_default_qa_contact" class="set-default"
            value="1" data-for="qa_contact">
          <label for="set-default-qa-contact">Reset QA Contact to default</label>
        </div>
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field bug_modal"
    id="field-reporter"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter" id="reporter-help-link" class="help">Reporter:
        </a>
    </div>



  
    <div class="value">
        <span id="field-value-reporter">
            <div class="vcard vcard_713228" ><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=713228" > <span class="fna">martin.oneal</span></a>
</div>

        </span>
    </div>

  
</div>


    <div class="field bug_modal"
    id="field-triage_owner"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner" id="triage_owner-help-link" class="help">Triage Owner:
        </a>
    </div>



  
    <div class="value">
        <span id="field-value-triage_owner">
            <div class="vcard vcard_711499" ><img src="https://secure.gravatar.com/avatar/b032108dab3ccfada1140fb485c6e182?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=711499" > <span class="fna">smayya</span></a>
</div>

        </span>
    </div>

  
</div>

    

    <div class="field bug_modal"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc" id="-help-link" class="help">CC:
        </a>
    </div>



  
    <div class=" container">


        <span aria-owns="cc-summary cc-latch">
          <span role="button" tabindex="0" id="cc-summary" data-count="12">12 people
          </span>
        </span>


        <div id="cc-list" style="display:none"></div>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-references"
>
    <header id="module-references-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse References section"
           data-label-collapsed="Expand References section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-references-content"
             aria-expanded="false"
             aria-labeledby="module-references-title"
             aria-describedby="module-references-subtitle"></div>
        <h2 class="module-title" id="module-references-title">References</h2>
          <h3 class="module-subtitle" id="module-references-subtitle">
            (<div class="link">
    <a href="https://attackshipsonfi.re/p/72fd0b4c-b173-4fdd-9d8f-d5a2e82e6033" target="_blank"
      rel="noreferrer" title="https://attackshipsonfi.re/p/72fd0b4c-b173-4fdd-9d8f-d5a2e82e6033"
      class="bug-url" data-safe="1">URL</a>
  </div>)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-references-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field bug_modal bug-list edit-show"
    id="field-dependson" style="display:none"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson" id="dependson-help-link" class="help">Depends on:
        </a>
    </div>



  
    <div class="value">
        <span id="field-value-dependson">
        ---
        </span>
    </div>

  
</div><div class="field bug_modal bug-list edit-show"
    id="field-blocked" style="display:none"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks" id="blocked-help-link" class="help">Blocks:
        </a>
    </div>



  
    <div class="value">
        <span id="field-value-blocked">
        ---
        </span>
    </div>

  
</div>

    <div class="field bug_modal bug-list edit-show"
    id="field-regresses" style="display:none"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses" id="regresses-help-link" class="help">Regressions:
        </a>
    </div>



  
    <div class="value">
        <span id="field-value-regresses">
        ---
        </span>
    </div>

  
</div><div class="field bug_modal bug-list edit-show"
    id="field-regressed_by" style="display:none"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by" id="regressed_by-help-link" class="help">Regressed by:
        </a>
    </div>



  
    <div class="value">
        <span id="field-value-regressed_by">
        ---
        </span>
    </div>

  
</div>

    
</div><div class="fields-rhs">

    <div class="field bug_modal"
    id="field-bug_file_loc"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc" id="bug_file_loc-help-link" class="help">URL:
        </a>
    </div>



  
    <div class="value">
        <span id="field-value-bug_file_loc"><div class="link">
    <a href="https://attackshipsonfi.re/p/72fd0b4c-b173-4fdd-9d8f-d5a2e82e6033" target="_blank"
      rel="noreferrer" title="https://attackshipsonfi.re/p/72fd0b4c-b173-4fdd-9d8f-d5a2e82e6033"
      class="bug-url" data-safe="1">attackshipsonfi.re/p/72fd0b4c-b173-4f...</a>
  </div>
        </span>
    </div>

  
</div>

    <div class="field bug_modal"
    id="field-see_also"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also" id="see_also-help-link" class="help">See Also:
        </a>
    </div>



  
    <div class="value">
        <span id="field-value-see_also">
            <div class="link">
      <a href="https://bugs.chromium.org/p/chromium/issues/detail?id=1415268" title="https://bugs.chromium.org/p/chromium/issues/detail?id=1415268">bugs.chromium.org/p/chromium/issues/d...</a>
    </div>

        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-details"
>
    <header id="module-details-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Details section"
           data-label-collapsed="Expand Details section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-details-content"
             aria-expanded="false"
             aria-labeledby="module-details-title"
             aria-describedby="module-details-subtitle"></div>
        <h2 class="module-title" id="module-details-title">Details</h2>
          <h3 class="module-subtitle" id="module-details-subtitle">
            (Keywords: reporter-external, sec-moderate, Whiteboard: [necko-triaged][necko-priority-queue][adv-main123+])
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-details-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field bug_modal edit-show"
    id="field-alias" style="display:none"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias" id="alias-help-link" class="help">Alias:
        </a>
    </div>



  
    <div class="value">
        <span id="field-value-alias">
            CVE-2024-1554

        </span>
    </div>

  
</div>

    <div class="field bug_modal"
    id="field-keywords"
>
    <div class="name">
      
        <a href="/describekeywords.cgi" id="keywords-help-link" class="help">Keywords:
        </a>
    </div>



  
    <div class="value">
        <span id="field-value-keywords">
          <a href="/buglist.cgi?keywords=reporter-external&amp;resolution=---">reporter-external</a>, 
          <a href="/buglist.cgi?keywords=sec-moderate&amp;resolution=---">sec-moderate</a>
        </span>
    </div>

  
</div>

    <div class="field bug_modal"
    id="field-status_whiteboard"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/Whiteboard" id="status_whiteboard-help-link" class="help">Whiteboard:
        </a>
    </div>



  
    <div class="value">
        <span id="field-value-status_whiteboard">[necko-triaged][necko-priority-queue][adv-main123+]
        </span>
    </div>

  
</div><div class="field bug_modal"
    id="field-cf_qa_whiteboard"
>
    <div class="name">
      QA Whiteboard:
    </div>



  
    <div class="value">
        <span id="field-value-cf_qa_whiteboard">
            [post-critsmash-triage]

        </span>
    </div>

  
</div>

    <div class="field bug_modal edit-show"
    id="field-cf_has_str" style="display:none"
>
    <div class="name">
      Has STR:
    </div>



  
    <div class="value">
        <span id="field-value-cf_has_str">
            ---

        </span>
    </div>

  
</div><div class="field bug_modal edit-show"
    id="field-cf_cab_review" style="display:none"
>
    <div class="name">
      Change Request:
    </div>



  
    <div class="value">
        <span id="field-value-cf_cab_review">
            ---

        </span>
    </div>

  
</div>

    <div class="field bug_modal"
    id="field-votes"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes" id="votes-help-link" class="help">Votes:
        </a>
    </div>



  
    <div class=" container">
        <span id="field-value-votes">0
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field bug_modal"
    id="field-bug_flags"
>
    <div class="name">
      Bug Flags:
    </div>



  
    <div class=" container">
        <span id="field-value-bug_flags"><div id="bug-flags" class="flags">
  <table class="layout-table">
          <tbody class="edit-hide"><tr>
    <td class="flag-setter"><div class="vcard vcard_1689" ><a class="email " href="/user_profile?user_id=1689" > <span class="fna">dveditz</span></a>
</div>
    </td>

    <td class="flag-name">
        <a href="#a30962685_1689"
            class="rel-time-title activity-ref"
            title="1 year ago"
        data-time="1706029885"
      >sec-bounty</a>
    </td>

    <td class="flag-value">+
    </td>

  </tr>
          </tbody>
          <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter"><div class="vcard vcard_1689" ><a class="email " href="/user_profile?user_id=1689" > <span class="fna">dveditz</span></a>
</div>
    </td>

    <td class="flag-name">
      <label title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug." for="flag-2207427">sec-bounty</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag-2207427-dirty">
      <select id="flag-2207427" name="flag-2207427"
        title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug."
        class="bug-flag">
            <option value="+" selected>+</option>
      </select>
    </td>


  </tr>
          </tbody>
          <tbody class="edit-hide"><tr>
    <td class="flag-setter"><div class="vcard vcard_488993" ><a class="email " href="/user_profile?user_id=488993" > <span class="fna">avaida</span></a>
</div>
    </td>

    <td class="flag-name">
        <a href="#a29878946_488993"
            class="rel-time-title activity-ref"
            title="1 year ago"
        data-time="1706163305"
      >qe-verify</a>
    </td>

    <td class="flag-value">-
    </td>

  </tr>
          </tbody>
          <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter"><div class="vcard vcard_488993" ><a class="email " href="/user_profile?user_id=488993" > <span class="fna">avaida</span></a>
</div>
    </td>

    <td class="flag-name">
      <label title="qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually" for="flag-2207720">qe-verify</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag-2207720-dirty">
      <select id="flag-2207720" name="flag-2207720"
        title="qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually"
          disabled
        class="bug-flag">
            <option value="-" selected>-</option>
      </select>
    </td>


  </tr>
          </tbody>
    <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Is this bug/feature enabled in a release by a pref flag?" for="flag_type-930">behind-pref</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-930-dirty">
      <select id="flag_type-930" name="flag_type-930"
        title="Is this bug/feature enabled in a release by a pref flag?"
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag tracking inclusion in the desktop Firefox product backlog." for="flag_type-846">firefox-backlog</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-846-dirty">
      <select id="flag_type-846" name="flag_type-846"
        title="Flag tracking inclusion in the desktop Firefox product backlog."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame." for="flag_type-913">sec-bounty-hof</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-913-dirty">
      <select id="flag_type-913" name="flag_type-913"
        title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-787">in-qa-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-787-dirty">
      <select id="flag_type-787" name="flag_type-787"
        title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>

      <td class="flag-requestee">
        <div id="requestee_type-787-container" style="display:none"><input
    name="requestee_type-787"
    value="" class="requestee bz_autocomplete_user"  id="requestee_type-787" 
  >
        </div>
      <td>

  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-37">in-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-37-dirty">
      <select id="flag_type-37" name="flag_type-37"
        title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr>
    </tbody>
  </table>
</div>
        </span>
    </div>

  
</div>
</div>

  
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-crash-data"
>
    <header id="module-crash-data-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Crash Data section"
           data-label-collapsed="Expand Crash Data section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-crash-data-content"
             aria-expanded="false"
             aria-labeledby="module-crash-data-title"
             aria-describedby="module-crash-data-subtitle"></div>
        <h2 class="module-title" id="module-crash-data-title">Crash Data</h2>
      </div>
    </header>
  <div class="module-content" id="module-crash-data-content" style="display:none"
  ><div class="field bug_modal edit-show"
    id="field-cf_crash_signature" style="display:none"
>
    <div class="name">
      Signature:
    </div>



  
    <div class="value">
        <span id="field-value-cf_crash_signature">
    <em>None</em>
        </span>
    </div>

  
</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-security"
>
    <header id="module-security-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Security section"
           data-label-collapsed="Expand Security section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-security-content"
             aria-expanded="false"
             aria-labeledby="module-security-title"
             aria-describedby="module-security-subtitle"></div>
        <h2 class="module-title" id="module-security-title">Security</h2>
          <h3 class="module-subtitle" id="module-security-subtitle">
            (public)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-security-content" style="display:none"
  ><div class="groups edit-hide">
    This bug is publicly visible.
</div>

<div class="groups edit-show" style="display:none">


</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-user-story" data-non-stick="1"
>
    <header id="module-user-story-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse User Story section"
           data-label-collapsed="Expand User Story section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-user-story-content"
             aria-expanded="false"
             aria-labeledby="module-user-story-title"
             aria-describedby="module-user-story-subtitle"></div>
        <h2 class="module-title" id="module-user-story-title">User Story</h2>
      </div>
    </header>
  <div class="module-content" id="module-user-story-content" style="display:none"
  >
    <pre id="user-story"></pre>
  </div>
</section>







<section class="module" id="module-attachments"
>
    <header id="module-attachments-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Attachments section"
           data-label-collapsed="Expand Attachments section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-attachments-content"
             aria-expanded="true"
             aria-labeledby="module-attachments-title"
             aria-describedby="module-attachments-subtitle"></div>
        <h2 class="module-title" id="module-attachments-title">Attachments</h2>
          <h3 class="module-subtitle" id="module-attachments-subtitle">
            (3 files)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-attachments-content"
  ><table role="table" class="responsive" id="attachments">
    <tr data-attachment-id="9367434" class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
          <a href="/attachment.cgi?id=9367434" > Bug 1816390 - Partition the cache entries generated by cross-origin fetch requests r=#necko
            </a>
        </div>
        <div>
            <a href="#c62" class="attach-time activity-ref"><span class="rel-time" title="2023-12-07 02:53 PST" data-time="1701946414">1 year ago</span></a>
          <span class="attach-author"><div class="vcard vcard_415378" ><a class="email " href="/user_profile?user_id=415378" > <span class="fna">Valentin Gosu [:valentin] (he/him) {{ PTO 21 Dec - 06 Jan }}</span></a>
</div></span>
        </div>
        <div class="attach-info">48 bytes,
          text/x-phabricator-request        </div>
      </td>
      <td></td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9367434&amp;action=edit" data-details="1">Details</a>&#x0020; |
  <a href="/attachment.cgi?id=9367434">Review</a>
    </tr>
    <tr data-attachment-id="9373002" class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
          <a href="/attachment.cgi?id=9373002" > Bug 1816390 - test r=#necko
            </a>
        </div>
        <div>
            <a href="#c74" class="attach-time activity-ref"><span class="rel-time" title="2024-01-16 03:05 PST" data-time="1705403158">1 year ago</span></a>
          <span class="attach-author"><div class="vcard vcard_415378" ><a class="email " href="/user_profile?user_id=415378" > <span class="fna">Valentin Gosu [:valentin] (he/him) {{ PTO 21 Dec - 06 Jan }}</span></a>
</div></span>
        </div>
        <div class="attach-info">48 bytes,
          text/x-phabricator-request        </div>
      </td>
      <td></td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9373002&amp;action=edit" data-details="1">Details</a>&#x0020; |
  <a href="/attachment.cgi?id=9373002">Review</a>
    </tr>
    <tr data-attachment-id="9380042" class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
          <a href="/attachment.cgi?id=9380042" > advisory.txt
            </a>
        </div>
        <div>
            <a href="#c78" class="attach-time activity-ref"><span class="rel-time" title="2024-02-13 14:52 PST" data-time="1707864739">11 months ago</span></a>
          <span class="attach-author"><div class="vcard vcard_578488" ><a class="email " href="/user_profile?user_id=578488" > <span class="fna">Tom Ritter [:tjr]</span></a>
</div></span>
        </div>
        <div class="attach-info">518 bytes,
          text/plain        </div>
      </td>
      <td></td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9380042&amp;action=edit" data-details="1">Details</a>
    </tr>
</table>

<footer id="attachments-footer">
  <div id="attachments-actions">
  </div>
  
</footer>
  </div>
</section>



<script nonce="hpA0hGj0JJn7pHxOBmH4elY8pwVjemdqG9XQDMYo3QJb8fci">
  init_module_visibility();
</script>




<meta name="firefox-versions" content="{&quot;FIREFOX_AURORA&quot;:&quot;&quot;,&quot;FIREFOX_DEVEDITION&quot;:&quot;135.0b2&quot;,&quot;FIREFOX_ESR&quot;:&quot;128.6.0esr&quot;,&quot;FIREFOX_ESR115&quot;:&quot;115.19.0esr&quot;,&quot;FIREFOX_ESR_NEXT&quot;:&quot;&quot;,&quot;FIREFOX_NIGHTLY&quot;:&quot;136.0a1&quot;,&quot;LAST_MERGE_DATE&quot;:&quot;2025-01-06&quot;,&quot;LAST_RELEASE_DATE&quot;:&quot;2025-01-07&quot;,&quot;LAST_SOFTFREEZE_DATE&quot;:&quot;2025-01-02&quot;,&quot;LAST_STRINGFREEZE_DATE&quot;:&quot;2025-01-03&quot;,&quot;LATEST_FIREFOX_DEVEL_VERSION&quot;:&quot;135.0b2&quot;,&quot;LATEST_FIREFOX_OLDER_VERSION&quot;:&quot;3.6.28&quot;,&quot;LATEST_FIREFOX_RELEASED_DEVEL_VERSION&quot;:&quot;135.0b2&quot;,&quot;LATEST_FIREFOX_VERSION&quot;:&quot;134.0&quot;,&quot;NEXT_MERGE_DATE&quot;:&quot;2025-02-03&quot;,&quot;NEXT_RELEASE_DATE&quot;:&quot;2025-02-04&quot;,&quot;NEXT_SOFTFREEZE_DATE&quot;:&quot;2025-01-30&quot;,&quot;NEXT_STRINGFREEZE_DATE&quot;:&quot;2025-01-31&quot;}">


<div id="comment-actions">
    <button type="button" id="bottom-btn" class="secondary" aria-label="Go to Page Bottom">Bottom &darr;</button>
  <div class="dropdown">
    <button type="button" id="comment-tags-btn" aria-haspopup="true" aria-label="Tags"
      aria-expanded="false" aria-controls="comment-tags-menu" class="dropdown-button minor">Tags &#9662;</button>
    <ul id="comment-tags-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a role="menuitem" tabindex="-1" data-comment-tag="">Reset</a>
      </li>
    </ul>
  </div>
  <div class="dropdown">
    <button type="button" id="view-menu-btn" aria-haspopup="true" aria-label="Timeline"
      aria-expanded="false" aria-controls="view-menu" class="dropdown-button minor">Timeline &#9662;</button>
    <ul id="view-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a id="view-reset" role="menuitem" tabindex="-1">Reset</a>
      </li>
      <li role="separator"></li>
      <li role="presentation">
        <a id="view-collapse-all" role="menuitem" tabindex="-1">Collapse All</a>
      </li>
      <li role="presentation">
        <a id="view-expand-all" role="menuitem" tabindex="-1">Expand All</a>
      </li>
      <li role="presentation">
        <a id="view-comments-only" role="menuitem" tabindex="-1">Comments Only</a>
      </li>
    </ul>
   </div>
</div>
<div class="change-set" id="c0"><div class="comment" data-id="16278263" data-no="0"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-0" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" ><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" ><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-0"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-0" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c0">Description</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-02-13 02:32 PST" data-time="1676284359">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-0">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-0" data-comment-id="16278263"><p>User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/109.0</p>
<p>Steps to reproduce:</p>
<h1>TL;DR</h1>
<p>If the right set of circumstances are present, Fetch can be used to pre-load the browser private cache, and poison normal navigation. Using this approach, a range of attacks that were previously thought to be unexploitable, can be unlocked and made practical. Hurrah!</p>
<h1>Blah Blah Blah</h1>
<p>The reason that this works is because the browser shares the private cache between Fetch and normal navigation, with the cache key being based upon the URI and originating context. However, because Fetch is able to add headers to the request that can vary the response (but which are not included in the cache key), an attacker can pre-request resources to poison the private cache, then force the browser to navigate to the page, which activates the attack.</p>
<p>To make this work requires two things:</p>
<ul>
<li>
<p>The Fetch request and response must be cacheable under normal circumstances by the browser. Typically, a GET method, and the response must be implicitly cacheable (301/308 status code, and last-modified header), or explicitly cacheable (cache-control, pragma and expires headers).</p>
</li>
<li>
<p>The target endpoint must pass a pre-flight check, as adding additional headers to a Fetch request requires CORS.</p>
</li>
</ul>
<p>As an interesting observation, the response does not always have to be made available to Fetch for the browser cache to be updated. For example, if the pre-flight passes, but the actual response does not have an access-control-allow-origin header, then it will be blocked due to CORS. But even so, the cache will sometimes still be updated successfully.</p>
<h1>Recommendations</h1>
<p>It is recommended that additional information is added to the cache key, so that requests made by Fetch and the normal navigation are separated.</p>
<h1>PoC</h1>
<p>The following PoC links launch same-origin, same-site and cross-origin tests, either directly or from within an iframe data URI (to force a null origin).</p>
<h2>301 status code (direct)</h2>
<ul>
<li>cross-site: <a href="https://p1.scarlet.ae/ff229a50-9266-4741-a478-ff91383525fa" rel="nofollow">https://p1.scarlet.ae/ff229a50-9266-4741-a478-ff91383525fa</a></li>
<li>same-site: <a href="https://p1.smelter.org/ff229a50-9266-4741-a478-ff91383525fa" rel="nofollow">https://p1.smelter.org/ff229a50-9266-4741-a478-ff91383525fa</a></li>
<li>same-origin: <a href="https://p2.smelter.org/ff229a50-9266-4741-a478-ff91383525fa" rel="nofollow">https://p2.smelter.org/ff229a50-9266-4741-a478-ff91383525fa</a></li>
</ul>
<h2>200 status code (direct)</h2>
<ul>
<li>cross-site: <a href="https://p1.scarlet.ae/9991460e-55db-49eb-8716-f4c72fd74d0c" rel="nofollow">https://p1.scarlet.ae/9991460e-55db-49eb-8716-f4c72fd74d0c</a></li>
<li>same-site: <a href="https://p1.smelter.org/9991460e-55db-49eb-8716-f4c72fd74d0c" rel="nofollow">https://p1.smelter.org/9991460e-55db-49eb-8716-f4c72fd74d0c</a></li>
<li>same-origin: <a href="https://p2.smelter.org/9991460e-55db-49eb-8716-f4c72fd74d0c" rel="nofollow">https://p2.smelter.org/9991460e-55db-49eb-8716-f4c72fd74d0c</a></li>
</ul>
<h2>301 status code (iframe)</h2>
<ul>
<li>cross-site: <a href="https://p1.scarlet.ae/17a031ba-cd6e-4cc0-af06-4c3f80354731" rel="nofollow">https://p1.scarlet.ae/17a031ba-cd6e-4cc0-af06-4c3f80354731</a></li>
<li>same-site: <a href="https://p1.smelter.org/17a031ba-cd6e-4cc0-af06-4c3f80354731" rel="nofollow">https://p1.smelter.org/17a031ba-cd6e-4cc0-af06-4c3f80354731</a></li>
<li>same-origin: <a href="https://p2.smelter.org/17a031ba-cd6e-4cc0-af06-4c3f80354731" rel="nofollow">https://p2.smelter.org/17a031ba-cd6e-4cc0-af06-4c3f80354731</a></li>
</ul>
<h2>200 status code (iframe)</h2>
<ul>
<li>cross-site: <a href="https://p1.scarlet.ae/e5b1e318-d679-4b47-b113-744cc97bcacf" rel="nofollow">https://p1.scarlet.ae/e5b1e318-d679-4b47-b113-744cc97bcacf</a></li>
<li>same-site: <a href="https://p1.smelter.org/e5b1e318-d679-4b47-b113-744cc97bcacf" rel="nofollow">https://p1.smelter.org/e5b1e318-d679-4b47-b113-744cc97bcacf</a></li>
<li>same-origin: <a href="https://p2.smelter.org/e5b1e318-d679-4b47-b113-744cc97bcacf" rel="nofollow">https://p2.smelter.org/e5b1e318-d679-4b47-b113-744cc97bcacf</a></li>
</ul>
<p>Actual results:</p>
<p>as above</p>
<p>Expected results:</p>
<p>as above</p>
</div></div><div class="change-set" id="c1"><div class="comment" data-id="16278278" data-no="1"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-1" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" ><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" ><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-1"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-1" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c1">Comment 1</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-02-13 02:51 PST" data-time="1676285466">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-1">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-1" data-comment-id="16278278"><p>(In reply to scarlet from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1816390#c0" title="RESOLVED FIXED - Browser cache poisoning attack using fetch() with different headers">comment #0</a>)</p>
<blockquote>
<p>If the right set of circumstances are present, Fetch can be used to pre-load the browser private cache, and poison normal navigation. Using this approach, a range of attacks that were previously thought to be unexploitable, can be unlocked and made practical. Hurrah!</p>
</blockquote>
<p>What do you mean by &quot;private cache&quot; and &quot;normal navigation&quot; here? And can you give an example of an attack made possible by this issue?</p>
</div><div class="activity"><div class="change">Group: firefox-core-security &rarr; network-core-security</div><div class="change">Component: Untriaged &rarr; Networking: Cache</div><div class="change">Flags: needinfo?(martin.oneal)</div><div class="change">Product: Firefox &rarr; Core</div></div></div><div class="change-set" id="c2"><div class="comment" data-id="16278288" data-no="2"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-2" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" ><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" ><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-2"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-2" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c2">Comment 2</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-02-13 03:03 PST" data-time="1676286184">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-2">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-2" data-comment-id="16278288"><p>Caches tend to fall into two buckets, private caches (the one in the browser) and shared caches (proxies, accelerators etc). Details here: <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Caching" rel="nofollow">https://developer.mozilla.org/en-US/docs/Web/HTTP/Caching</a></p>
<p>The reference to &quot;normal navigation&quot; is just to make a destinction between Fetch, and normal browser activity: following a link, loading resources from within a page etc.</p>
<p>Cache poisoning is an approach to adding an attack to a cache that will be activated by the next access. Generally this is a shared cache (poison once, attack many), but the bug described here works just as well for targeting the private cache in the browser. Details here (shared cache attacks, but the principal works just the same): <a href="https://portswigger.net/research/practical-web-cache-poisoning" rel="nofollow">https://portswigger.net/research/practical-web-cache-poisoning</a></p>
<p>So this kind of attack is great for unlocking a range of vulnerabilities in a site (such as XSS) that otherwise can&#39;t be practically exploited.</p>
<p>Hopefully that helps!</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(martin.oneal)</span></div></div></div><div class="change-set" id="c3"><div class="comment" data-id="16278507" data-no="3"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-3" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_415378" ><img src="https://secure.gravatar.com/avatar/dedff9d4500fcbc5cdd1cd270f044b33?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_415378" ><a class="email " href="/user_profile?user_id=415378" > <span class="fna">Valentin Gosu [:valentin] (he/him) {{ PTO 21 Dec - 06 Jan }}</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-3"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-3" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c3">Comment 3</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-02-13 05:36 PST" data-time="1676295372">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-3">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-3" data-comment-id="16278507"><p>Could you explain what the PoC does? How it actually works for every request? I would have expected network state partitioning to be a good mitigation against cache poisoning.</p>
</div><div class="activity"><div class="change">Severity: -- &rarr; S3</div><div class="change">Priority: -- &rarr; P1</div><div class="change">Whiteboard: [necko-triaged][necko-priority-review]</div></div></div><div class="change-set" id="c4"><div class="comment" data-id="16278518" data-no="4"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-4" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" ><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" ><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-4"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-4" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c4">Comment 4</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-02-13 05:51 PST" data-time="1676296301">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-4">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-4" data-comment-id="16278518"><p>my pleasure!</p>
<p>The PoCs are all very similar, and work in the same way: first they make a request using Fetch (using a header that alters the response, but isn&#39;t part of the cache key), then they follow up with normal navigation to the same URI. Because the response is cacheable, the second navigation step loads the response from cache (and doesn&#39;t make a new request).</p>
<p>The PoCs are broken into three CORS clumps: same origin (literally the same host), same site (they share a base domain, like mozilla.org) and cross site (the domains are unrelated).</p>
<p>Then on top of this, the PoCs are also split into direct requests (just made from a page) and others that are wrapped inside an iframe (as this forces the origin of the request to null).</p>
<p>And finally, the PoCs are separated into reponses that generate a 200 and a 301 (though 308 will work the same way: basically a permanent, inherently cacheable redirect).</p>
<p>The idea being that these tests permute the main combinations, and demonstrate whether the browser request can be poisoned.</p>
<p>Have you tried safari and chrome yet? ;)</p>
</div></div><div class="change-set" id="c5"><div class="comment" data-id="16278521" data-no="5"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-5" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" ><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" ><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-5"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-5" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c5">Comment 5</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-02-13 05:52 PST" data-time="1676296351">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-5">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-5" data-comment-id="16278521"><p>As an aside, a MITM proxy like Charles or Burp will make the mechanics of the actual requests much more clear.</p>
</div></div><div class="change-set" id="c6"><div class="comment" data-id="16279307" data-no="6"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-6" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" ><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" ><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-6"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-6" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c6">Comment 6</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-02-13 15:06 PST" data-time="1676329572">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-6">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-6" data-comment-id="16279307"><p>(In reply to scarlet from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1816390#c4" title="RESOLVED FIXED - Browser cache poisoning attack using fetch() with different headers">comment #4</a>)</p>
<blockquote>
<p>Have you tried safari and chrome yet? ;)</p>
</blockquote>
<p>Looks like Chrome at least reports &quot;poisoned: yep&quot; for at least some of those - I assume you&#39;ve also reported to Chrome and Safari (if they too are vulnerable) as well, and if so, can you link the reports? :-)</p>
</div><div class="activity"><div class="change">Flags: needinfo?(martin.oneal)</div></div></div><div class="change-set" id="a45275_159069"><div class="change" id="aa45275_159069">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a45275_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_159069" id="a45275_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="as-a45275_159069"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a45275_159069">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#a45275_159069">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-02-13 15:07 PST" data-time="1676329634">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Summary: Private cache poisoning attack &rarr; Browser cache poisoning attack using fetch() with different headers</div></div></div><div class="change-set" id="c7"><div class="comment" data-id="16279514" data-no="7"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-7" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" id="a45275_159069"><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" id="a45275_159069"><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-7"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-7" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c7">Comment 7</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-02-13 20:05 PST" data-time="1676347553">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-7">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-7" data-comment-id="16279514"><p>Haha, indeed reported elsewhere too.</p>
<p>I&#39;ve found cross-browser bugs before, so happy to reference tickets across vendors. I know chrome are too, but Apple (as ever) generally give pretty much no feedback prior to releasing a patch, so I wouldn&#39;t expect anything. ;)</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(martin.oneal)</span></div></div></div><div class="change-set" id="c8"><div class="comment" data-id="16279681" data-no="8"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-8" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" id="a45275_159069"><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" id="a45275_159069"><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-8"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-8" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c8">Comment 8</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-02-14 00:52 PST" data-time="1676364766">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-8">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-8" data-comment-id="16279681"><p>chromium ticket: <a href="https://bugs.chromium.org/p/chromium/issues/detail?id=1415268" rel="nofollow">https://bugs.chromium.org/p/chromium/issues/detail?id=1415268</a></p>
</div></div><div class="change-set" id="c9"><div class="comment" data-id="16279682" data-no="9"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-9" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" id="a45275_159069"><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" id="a45275_159069"><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-9"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-9" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c9">Comment 9</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-02-14 00:53 PST" data-time="1676364806">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-9">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-9" data-comment-id="16279682"><p>there is the potential for this to become a whatwg issue, given the cross-browser aspect.</p>
</div></div><div class="change-set" id="c10"><div class="comment" data-id="16282532" data-no="10"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-10" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a45275_159069"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a45275_159069"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-10"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-10" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c10">Comment 10</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-02-15 14:54 PST" data-time="1676501691">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-10">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-10" data-comment-id="16282532"><p>If the server is returning different values based on the headers, doesn&#39;t it fall on the server to issue a <code>Vary:</code> header for those?</p>
</div><div class="activity"><div class="change">Status: UNCONFIRMED &rarr; NEW</div><div class="change">Ever confirmed: true</div><div class="change">See Also:  &rarr; <a href="https://bugs.chromium.org/p/chromium/issues/detail?id=1415268" target="_blank" rel="noreferrer">https://bugs.chromium.org/p/chromium/issues/detail?id=1415268</a></div></div></div><div class="change-set" id="a219681_1689"><div class="change" id="aa219681_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a219681_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a219681_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="as-a219681_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a219681_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#a219681_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-02-15 15:34 PST" data-time="1676504040">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: needinfo?(valentin.gosu)</div></div></div><div class="change-set" id="c11"><div class="comment" data-id="16282962" data-no="11"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-11" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_415378" id="a219681_1689"><img src="https://secure.gravatar.com/avatar/dedff9d4500fcbc5cdd1cd270f044b33?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_415378" id="a219681_1689"><a class="email " href="/user_profile?user_id=415378" > <span class="fna">Valentin Gosu [:valentin] (he/him) {{ PTO 21 Dec - 06 Jan }}</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-11"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-11" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c11">Comment 11</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-02-16 01:14 PST" data-time="1676538867">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-11">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-11" data-comment-id="16282962"><p>(In reply to Daniel Veditz [:dveditz] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1816390#c10" title="RESOLVED FIXED - Browser cache poisoning attack using fetch() with different headers">comment #10</a>)</p>
<blockquote>
<p>If the server is returning different values based on the headers, doesn&#39;t it fall on the server to issue a <code>Vary:</code> header for those?</p>
</blockquote>
<p>Yes, it does. As far as I can tell, none of the requests to links in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1816390#c0" title="RESOLVED FIXED - Browser cache poisoning attack using fetch() with different headers">comment 0</a> are returning a Vary header.</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(valentin.gosu)</span></div></div></div><div class="change-set" id="c12"><div class="comment" data-id="16282973" data-no="12"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-12" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" id="a219681_1689"><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" id="a219681_1689"><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-12"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-12" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c12">Comment 12</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-02-16 01:21 PST" data-time="1676539274">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-12">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-12" data-comment-id="16282973"><p>Oh yes, the standards have a mechanism for dealing with this, but the reality is that it just isn&#39;t used particularly widely (in this way).</p>
<p>The typical approach to avoid cache poisoning is to include one or other of <code>referer</code> and <code>origin</code> in the <code>vary</code> response, but as this is a private cache, they are going to be the same anyway.</p>
</div></div><div class="change-set" id="c13"><div class="comment" data-id="16283051" data-no="13"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-13" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_415378" id="a219681_1689"><img src="https://secure.gravatar.com/avatar/dedff9d4500fcbc5cdd1cd270f044b33?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_415378" id="a219681_1689"><a class="email " href="/user_profile?user_id=415378" > <span class="fna">Valentin Gosu [:valentin] (he/him) {{ PTO 21 Dec - 06 Jan }}</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-13"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-13" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c13">Comment 13</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-02-16 02:21 PST" data-time="1676542870">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-13">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-13" data-comment-id="16283051"><p>(In reply to scarlet from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1816390#c12" title="RESOLVED FIXED - Browser cache poisoning attack using fetch() with different headers">comment #12</a>)</p>
<blockquote>
<p>Oh yes, the standards have a mechanism for dealing with this, but the reality is that it just isn&#39;t used particularly widely (in this way).</p>
<p>The typical approach to avoid cache poisoning is to include one or other of <code>referer</code> and <code>origin</code> in the <code>vary</code> response, but as this is a private cache, they are going to be the same anyway.</p>
</blockquote>
<p>(In reply to scarlet from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1816390#c0" title="RESOLVED FIXED - Browser cache poisoning attack using fetch() with different headers">comment #0</a>)</p>
<blockquote>
<ul>
<li>same-origin: <a href="https://p2.smelter.org/9991460e-55db-49eb-8716-f4c72fd74d0c" rel="nofollow">https://p2.smelter.org/9991460e-55db-49eb-8716-f4c72fd74d0c</a></li>
</ul>
</blockquote>
<p>But in this case the server is returning a different response based on the <code>x-original-url</code> header, so presumably it should include that in the Vary response?</p>
</div></div><div class="change-set" id="c14"><div class="comment" data-id="16283100" data-no="14"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-14" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" id="a219681_1689"><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" id="a219681_1689"><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-14"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-14" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c14">Comment 14</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-02-16 03:05 PST" data-time="1676545522">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-14">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-14" data-comment-id="16283100"><p>in my experience, for anything other than the most simple install, there really isn&#39;t anything you can point to as a server. There will be a stack of infrastructure and application components, each with rules about what to allow, and what extra headers to add to responses.</p>
<p>so the bit that will respond to the <code>x-original-url</code> header will be the app component (or framework) whereas other than the basic 200 responses, the cache headers will actually be applied by middleware, the framework, or a webserver, or maybe a WAF, reverse proxy or firewall.</p>
<p>a lot of this stuff doesn&#39;t even consider the caching aspect too: for example the 301/308s. They&#39;ll be sent as-is, with no extra headers, and it is the browser that inherently caches them.</p>
</div></div><div class="change-set" id="c15"><div class="comment" data-id="16286581" data-no="15"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-15" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" id="a219681_1689"><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" id="a219681_1689"><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-15"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-15" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c15">Comment 15</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-02-19 11:50 PST" data-time="1676836239">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-15">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-15" data-comment-id="16286581"><p>I ran some more testing using service workers this weekend.</p>
<p>results the same as the direct PoCs previously provided:</p>
<h3>301 status code (service worker)</h3>
<ul>
<li>cross-site: <a href="https://p1.scarlet.ae/263d8d0d-e889-447e-9270-14fa3a4d7096" rel="nofollow">https://p1.scarlet.ae/263d8d0d-e889-447e-9270-14fa3a4d7096</a></li>
<li>same-site: <a href="https://p1.smelter.org/263d8d0d-e889-447e-9270-14fa3a4d7096" rel="nofollow">https://p1.smelter.org/263d8d0d-e889-447e-9270-14fa3a4d7096</a></li>
<li>same-origin: <a href="https://p2.smelter.org/263d8d0d-e889-447e-9270-14fa3a4d7096" rel="nofollow">https://p2.smelter.org/263d8d0d-e889-447e-9270-14fa3a4d7096</a></li>
</ul>
<h3>200 status code (service worker)</h3>
<ul>
<li>cross-site: <a href="https://p1.scarlet.ae/6a6cde5c-e28c-4b62-9f3c-d155feccb2c4" rel="nofollow">https://p1.scarlet.ae/6a6cde5c-e28c-4b62-9f3c-d155feccb2c4</a></li>
<li>same-site: <a href="https://p1.smelter.org/6a6cde5c-e28c-4b62-9f3c-d155feccb2c4" rel="nofollow">https://p1.smelter.org/6a6cde5c-e28c-4b62-9f3c-d155feccb2c4</a></li>
<li>same-origin: <a href="https://p2.smelter.org/6a6cde5c-e28c-4b62-9f3c-d155feccb2c4" rel="nofollow">https://p2.smelter.org/6a6cde5c-e28c-4b62-9f3c-d155feccb2c4</a></li>
</ul>
<p>I also noticed a strange quirk with the same-origin 200 response: if the response has a <code>cache-control: no-cache, no-store header</code> then the first time it is requested, it fails as expected. However, subsequent requests succeed. Only for same-origin, the others are unnafected.</p>
<p>As with the other same origin stuff, it&#39;s not that useful as an exploit. However, it does hint at something else being broken.</p>
</div></div><div class="change-set" id="c16"><div class="comment" data-id="16289135" data-no="16"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-16" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" id="a219681_1689"><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" id="a219681_1689"><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-16"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-16" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c16">Comment 16</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-02-20 05:10 PST" data-time="1676898604">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-16">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-16" data-comment-id="16289135"><p>ignore the reload bit: my code was broken (didn;t activate properly immediately). so same-origin via a service worker ignores cache settings.</p>
</div></div><div class="change-set" id="c17"><div class="comment" data-id="16289136" data-no="17"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-17" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" id="a219681_1689"><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" id="a219681_1689"><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-17"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-17" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c17">Comment 17</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-02-20 05:10 PST" data-time="1676898647">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-17">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-17" data-comment-id="16289136"><p>same results for pre-caching through a service worker:</p>
<h3>301 status code (service worker, pre-cache)</h3>
<ul>
<li>cross-site: <a href="https://p1.scarlet.ae/c96edaed-9816-4dcc-a857-5cdb4cea59ee" rel="nofollow">https://p1.scarlet.ae/c96edaed-9816-4dcc-a857-5cdb4cea59ee</a></li>
<li>same-site: <a href="https://p1.smelter.org/c96edaed-9816-4dcc-a857-5cdb4cea59ee" rel="nofollow">https://p1.smelter.org/c96edaed-9816-4dcc-a857-5cdb4cea59ee</a></li>
<li>same-origin: <a href="https://p2.smelter.org/c96edaed-9816-4dcc-a857-5cdb4cea59ee" rel="nofollow">https://p2.smelter.org/c96edaed-9816-4dcc-a857-5cdb4cea59ee</a></li>
</ul>
<h3>200 status code (service worker, pre-cache)</h3>
<ul>
<li>cross-site: <a href="https://p1.scarlet.ae/3ca1ee29-1e02-40ef-aad6-22efd83c8407" rel="nofollow">https://p1.scarlet.ae/3ca1ee29-1e02-40ef-aad6-22efd83c8407</a></li>
<li>same-site: <a href="https://p1.smelter.org/3ca1ee29-1e02-40ef-aad6-22efd83c8407" rel="nofollow">https://p1.smelter.org/3ca1ee29-1e02-40ef-aad6-22efd83c8407</a></li>
<li>same-origin: <a href="https://p2.smelter.org/3ca1ee29-1e02-40ef-aad6-22efd83c8407" rel="nofollow">https://p2.smelter.org/3ca1ee29-1e02-40ef-aad6-22efd83c8407</a></li>
</ul>
</div></div><div class="change-set" id="c18"><div class="comment" data-id="16289159" data-no="18"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-18" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" id="a219681_1689"><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" id="a219681_1689"><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-18"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-18" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c18">Comment 18</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-02-20 05:22 PST" data-time="1676899323">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-18">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-18" data-comment-id="16289159"><p>I also noticed a strange quirk with the same-origin 200 response: if the response has a <code>cache-control: no-cache, no-store header</code> then it is successfully cached. Only for same-origin, the others are unnafected.</p>
<p>As with the other same origin stuff, it&#39;s not that useful as an exploit. However, it does hint at something else being broken.</p>
</div></div><div class="change-set" id="c19"><div class="comment" data-id="16289164" data-no="19"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-19" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" id="a219681_1689"><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" id="a219681_1689"><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-19"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-19" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c19">Comment 19</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-02-20 05:23 PST" data-time="1676899433">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-19">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-19" data-comment-id="16289164"><p>and just for clarity, that&#39;s via the service worker only: direct requests are not cached as expected.</p>
</div></div><div class="change-set" id="a708265_694371"><div class="change" id="aa708265_694371">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_694371" id="a708265_694371"><img src="https://secure.gravatar.com/avatar/4f4aff1d0dc02baa9469c919a0e4c759?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_694371" id="a708265_694371"><a class="email " href="/user_profile?user_id=694371" > <span class="fna">Greg Hess</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="as-a708265_694371"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a708265_694371">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#a708265_694371">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-02-21 07:17 PST" data-time="1676992624">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Severity: S3 &rarr; S2</div><div class="change">Priority: P1 &rarr; P2</div></div></div><div class="change-set" id="c20"><div class="comment" data-id="16290536" data-no="20"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-20" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_415378" id="a708265_694371"><img src="https://secure.gravatar.com/avatar/dedff9d4500fcbc5cdd1cd270f044b33?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_415378" id="a708265_694371"><a class="email " href="/user_profile?user_id=415378" > <span class="fna">Valentin Gosu [:valentin] (he/him) {{ PTO 21 Dec - 06 Jan }}</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-20"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-20" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c20">Comment 20</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-02-21 07:20 PST" data-time="1676992839">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-20">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-20" data-comment-id="16290536"><p>(In reply to scarlet from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1816390#c9" title="RESOLVED FIXED - Browser cache poisoning attack using fetch() with different headers">comment #9</a>)</p>
<blockquote>
<p>there is the potential for this to become a whatwg issue, given the cross-browser aspect.</p>
</blockquote>
<p>Hi Anne,</p>
<p>Should we open a fetch security advisory for this issue?</p>
<p>Thanks!</p>
</div><div class="activity"><div class="change">Flags: needinfo?(annevk)</div></div></div><div class="change-set" id="c21"><div class="comment" data-id="16292971" data-no="21"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-21" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" id="a708265_694371"><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" id="a708265_694371"><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-21"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-21" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c21">Comment 21</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-02-21 21:07 PST" data-time="1677042469">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-21">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-21" data-comment-id="16292971"><p>I&#39;m not a subject matter expert, but to me, it seems more of an implementation thing, than a standards thing. All the main browsers (and even recent versions) respond differently, as they seem to use a subtly different approach to deciding how to generate the cache key.</p>
<p>As a layman, for this particular issue, adding a flag for whether the fetch request is initiated from javascript or not would seem to solve the problem.</p>
</div></div><div class="change-set" id="c22"><div class="comment" data-id="16293119" data-no="22"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-22" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" id="a708265_694371"><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" id="a708265_694371"><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-22"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-22" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c22">Comment 22</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-02-22 01:14 PST" data-time="1677057294">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-22">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-22" data-comment-id="16293119"><p>I ran up some more tests last night, and bodyless POSTs (via an overide header) work just fine too.</p>
<p>This is very useful in the real world, for leveraging XSS that has previously been unexploitable as it requires CORS (auth headers, cookie or header based XSS etc).</p>
<h3>301 status code (direct, bodyless post)</h3>
<ul>
<li>cross-site: <a href="https://p1.scarlet.ae/abb9d2b8-06ea-4abf-b6eb-25f346f6e8a1" rel="nofollow">https://p1.scarlet.ae/abb9d2b8-06ea-4abf-b6eb-25f346f6e8a1</a></li>
<li>same-site: <a href="https://p1.smelter.org/abb9d2b8-06ea-4abf-b6eb-25f346f6e8a1" rel="nofollow">https://p1.smelter.org/abb9d2b8-06ea-4abf-b6eb-25f346f6e8a1</a></li>
<li>same-origin: <a href="https://p2.smelter.org/abb9d2b8-06ea-4abf-b6eb-25f346f6e8a1" rel="nofollow">https://p2.smelter.org/abb9d2b8-06ea-4abf-b6eb-25f346f6e8a1</a></li>
</ul>
<h3>200 status code (direct, bodyless post)</h3>
<ul>
<li>cross-site: <a href="https://p1.scarlet.ae/eecc1994-eac6-43a8-82cc-ff7cde1607f8" rel="nofollow">https://p1.scarlet.ae/eecc1994-eac6-43a8-82cc-ff7cde1607f8</a></li>
<li>same-site: <a href="https://p1.smelter.org/eecc1994-eac6-43a8-82cc-ff7cde1607f8" rel="nofollow">https://p1.smelter.org/eecc1994-eac6-43a8-82cc-ff7cde1607f8</a></li>
<li>same-origin: <a href="https://p2.smelter.org/eecc1994-eac6-43a8-82cc-ff7cde1607f8" rel="nofollow">https://p2.smelter.org/eecc1994-eac6-43a8-82cc-ff7cde1607f8</a></li>
</ul>
</div></div><div class="change-set" id="c23"><div class="comment" data-id="16294784" data-no="23"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-23" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_102998" id="a708265_694371"><img src="https://secure.gravatar.com/avatar/09bb44ac3625a121017cd98d0a7dc52c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_102998" id="a708265_694371"><a class="email " href="/user_profile?user_id=102998" > <span class="fna">Anne (:annevk)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-23"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-23" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c23">Comment 23</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-02-22 10:46 PST" data-time="1677091579">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-23">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-23" data-comment-id="16294784"><p>The boundary we are trying to protect is top-level cross-site. That&#39;s done through HTTP cache partitioning. Top-level cross-site tests don&#39;t seem to work so I think all is working as designed?</p>
<p>Servers could use Fetch Metadata Request Headers if they need control within the site boundary.</p>
<p>Valentin, feel free if you think there are changes we should make. I don&#39;t see anything actionable here personally.</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(annevk)</span></div></div></div><div class="change-set" id="c24"><div class="comment" data-id="16302572" data-no="24"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-24" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" id="a708265_694371"><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" id="a708265_694371"><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-24"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-24" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c24">Comment 24</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-02-27 14:56 PST" data-time="1677538596">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-24">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-24" data-comment-id="16302572"><p>is there a plan and schedule for getting a fix together and shipped?</p>
</div></div><div class="change-set ca-713228" id="c25"><div class="comment" data-id="16313083" data-no="25"
       data-tags="duplicate">
    
    <table class="layout-table change-head reporter" id="ch-25" style="display:none" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" id="a708265_694371"><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" id="a708265_694371"><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-25"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-25" style="display:none">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c25">Comment 25</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-03-06 03:11 PST" data-time="1678101064">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-25">
        <td colspan="2" class="comment-tags"><span class="comment-tag" data-tag="duplicate">duplicate
  </span>
        </td>
      </tr>
    </table>

    
      <table class="layout-table change-head default-collapsed" id="cc-25"
             role="presentation">
      <tr>
        <td class="comment-collapse-reason"
            title="martin.oneal [2 years ago]">
            Comment hidden (duplicate)
        </td>
        <td class="comment-actions">
          <button type="button" class="change-spinner ghost iconic" id="ccs-25"
                  aria-label="Expand"
                  aria-expanded="false"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </td>
      </tr>
      </table>
  </div><div
      class="comment-text markdown-body "
      id="ct-25" data-comment-id="16313083" style="display:none"><p>[prod]</p>
</div></div><div class="change-set" id="c26"><div class="comment" data-id="16313459" data-no="26"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-26" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_415378" id="a708265_694371"><img src="https://secure.gravatar.com/avatar/dedff9d4500fcbc5cdd1cd270f044b33?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_415378" id="a708265_694371"><a class="email " href="/user_profile?user_id=415378" > <span class="fna">Valentin Gosu [:valentin] (he/him) {{ PTO 21 Dec - 06 Jan }}</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-26"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-26" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c26">Comment 26</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-03-06 06:41 PST" data-time="1678113672">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-26">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-26" data-comment-id="16313459"><p>I start working on this. We don&#39;t have a timeline for shipping a fix yet.</p>
</div><div class="activity"><div class="change">Assignee: nobody &rarr; valentin.gosu</div></div></div><div class="change-set" id="c27"><div class="comment" data-id="16315546" data-no="27"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-27" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" id="a708265_694371"><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" id="a708265_694371"><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-27"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-27" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c27">Comment 27</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-03-07 07:56 PST" data-time="1678204593">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-27">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-27" data-comment-id="16315546"><p>cool. thanks for the update!</p>
</div></div><div class="change-set" id="c28"><div class="comment" data-id="16315547" data-no="28"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-28" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" id="a708265_694371"><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" id="a708265_694371"><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-28"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-28" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c28">Comment 28</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-03-07 07:57 PST" data-time="1678204642">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-28">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-28" data-comment-id="16315547"><p>what approach have you taken? will you be adding a flag to the cache key for fetch-javascript, ala iframe?</p>
</div></div><div class="change-set" id="a2634993_1689"><div class="change" id="aa2634993_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a2634993_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a2634993_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="as-a2634993_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a2634993_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#a2634993_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-03-15 15:29 PDT" data-time="1678919352">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: needinfo?(valentin.gosu)</div></div></div><div class="change-set ca-713228" id="c29"><div class="comment" data-id="16342465" data-no="29"
       data-tags="duplicate">
    
    <table class="layout-table change-head reporter" id="ch-29" style="display:none" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" id="a2634993_1689"><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" id="a2634993_1689"><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-29"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-29" style="display:none">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c29">Comment 29</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-03-26 22:37 PDT" data-time="1679895472">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-29">
        <td colspan="2" class="comment-tags"><span class="comment-tag" data-tag="duplicate">duplicate
  </span>
        </td>
      </tr>
    </table>

    
      <table class="layout-table change-head default-collapsed" id="cc-29"
             role="presentation">
      <tr>
        <td class="comment-collapse-reason"
            title="martin.oneal [2 years ago]">
            Comment hidden (duplicate)
        </td>
        <td class="comment-actions">
          <button type="button" class="change-spinner ghost iconic" id="ccs-29"
                  aria-label="Expand"
                  aria-expanded="false"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </td>
      </tr>
      </table>
  </div><div
      class="comment-text markdown-body "
      id="ct-29" data-comment-id="16342465" style="display:none"><p>any progress?</p>
</div></div><div class="change-set" id="c30"><div class="comment" data-id="16346035" data-no="30"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-30" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_415378" id="a2634993_1689"><img src="https://secure.gravatar.com/avatar/dedff9d4500fcbc5cdd1cd270f044b33?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_415378" id="a2634993_1689"><a class="email " href="/user_profile?user_id=415378" > <span class="fna">Valentin Gosu [:valentin] (he/him) {{ PTO 21 Dec - 06 Jan }}</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-30"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-30" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c30">Comment 30</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-03-28 01:37 PDT" data-time="1679992632">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-30">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-30" data-comment-id="16346035"><p>Sorry for the long response delay - I&#39;m working on the patch to add a fetch flag to the partitioning key.<br>
Most of my time is occupied by another project, but that&#39;s ramping down this week so I&#39;ll probably have something to share by the end of next week. Thank you for your patience.</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(valentin.gosu)</span></div></div></div><div class="change-set" id="c31"><div class="comment" data-id="16346071" data-no="31"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-31" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" id="a2634993_1689"><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" id="a2634993_1689"><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-31"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-31" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c31">Comment 31</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-03-28 02:03 PDT" data-time="1679994184">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-31">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-31" data-comment-id="16346071"><p>cool. just checking it hasn&#39;t been forgotten ;)</p>
</div></div><div class="change-set" id="a4332766_694371"><div class="change" id="aa4332766_694371">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_694371" id="a4332766_694371"><img src="https://secure.gravatar.com/avatar/4f4aff1d0dc02baa9469c919a0e4c759?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_694371" id="a4332766_694371"><a class="email " href="/user_profile?user_id=694371" > <span class="fna">Greg Hess</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="as-a4332766_694371"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a4332766_694371">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#a4332766_694371">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-04-04 07:05 PDT" data-time="1680617125">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: [necko-triaged][necko-priority-review] &rarr; [necko-triaged][necko-priority-next]</div></div></div><div class="change-set" id="c32"><div class="comment" data-id="16368372" data-no="32"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-32" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_102998" id="a4332766_694371"><img src="https://secure.gravatar.com/avatar/09bb44ac3625a121017cd98d0a7dc52c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_102998" id="a4332766_694371"><a class="email " href="/user_profile?user_id=102998" > <span class="fna">Anne (:annevk)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-32"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-32" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c32">Comment 32</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-04-12 23:44 PDT" data-time="1681368265">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-32">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-32" data-comment-id="16368372"><p>Valentin, if you don&#39;t think this is WONTFIX could you please discuss the relevant standard changes in tandem with any fix? It&#39;s still not clear to me this is worth fixing at all.</p>
</div></div><div class="change-set" id="c33"><div class="comment" data-id="16368452" data-no="33"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-33" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" id="a4332766_694371"><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" id="a4332766_694371"><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-33"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-33" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c33">Comment 33</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-04-13 00:57 PDT" data-time="1681372671">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-33">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-33" data-comment-id="16368452"><p>There&#39;s a really good primer for cache poisoning here: <a href="https://portswigger.net/web-security/web-cache-poisoning" rel="nofollow">https://portswigger.net/web-security/web-cache-poisoning</a></p>
<p>The only bit different, is that the poisoning happens within the browser&#39;s private cache (and not a shared cache, as in the link), but otherwise all the principals and effects are the same.</p>
<p>I&#39;ve been having a lot of fun with it in the last few months, as it unlocks a collection of attacks that have previously been unexploitable.</p>
</div></div><div class="change-set ca-713228" id="c34"><div class="comment" data-id="16415832" data-no="34"
       data-tags="duplicate">
    
    <table class="layout-table change-head reporter" id="ch-34" style="display:none" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" id="a4332766_694371"><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" id="a4332766_694371"><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-34"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-34" style="display:none">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c34">Comment 34</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-05-17 06:27 PDT" data-time="1684330079">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-34">
        <td colspan="2" class="comment-tags"><span class="comment-tag" data-tag="duplicate">duplicate
  </span>
        </td>
      </tr>
    </table>

    
      <table class="layout-table change-head default-collapsed" id="cc-34"
             role="presentation">
      <tr>
        <td class="comment-collapse-reason"
            title="martin.oneal [2 years ago]">
            Comment hidden (duplicate)
        </td>
        <td class="comment-actions">
          <button type="button" class="change-spinner ghost iconic" id="ccs-34"
                  aria-label="Expand"
                  aria-expanded="false"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </td>
      </tr>
      </table>
  </div><div
      class="comment-text markdown-body "
      id="ct-34" data-comment-id="16415832" style="display:none"><p>how is this going?</p>
</div></div><div class="change-set" id="c35"><div class="comment" data-id="16426527" data-no="35"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-35" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a4332766_694371"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a4332766_694371"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-35"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-35" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c35">Comment 35</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-05-24 15:20 PDT" data-time="1684966800">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-35">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-35" data-comment-id="16426527"><blockquote>
<p>if the pre-flight passes, but the actual response does not have an access-control-allow-origin header, then it will be blocked due to CORS. But even so, the cache will sometimes still be updated successfully.</p>
</blockquote>
<p>Is there a way we can avoid caching these failed responses ever? We do, though, want to cache the pre-flight responses for a time for perf reasons, but maybe these can be tagged to only be used for pre-flights and nothing else?</p>
</div><div class="activity"><div class="change">Keywords: <a href="/buglist.cgi?keywords=sec-other&amp;resolution=---">sec-other</a></div></div></div><div class="change-set" id="a9171732_415378"><div class="change" id="aa9171732_415378">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_415378" id="a9171732_415378"><img src="https://secure.gravatar.com/avatar/dedff9d4500fcbc5cdd1cd270f044b33?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_415378" id="a9171732_415378"><a class="email " href="/user_profile?user_id=415378" > <span class="fna">Valentin Gosu [:valentin] (he/him) {{ PTO 21 Dec - 06 Jan }}</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="as-a9171732_415378"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a9171732_415378">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#a9171732_415378">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-05-30 07:14 PDT" data-time="1685456091">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: [necko-triaged][necko-priority-next] &rarr; [necko-triaged][necko-priority-queue]</div></div></div><div class="change-set ca-713228" id="c36"><div class="comment" data-id="16499348" data-no="36"
       data-tags="duplicate">
    
    <table class="layout-table change-head reporter" id="ch-36" style="display:none" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" id="a9171732_415378"><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" id="a9171732_415378"><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-36"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-36" style="display:none">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c36">Comment 36</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-07-17 01:27 PDT" data-time="1689582472">1 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-36">
        <td colspan="2" class="comment-tags"><span class="comment-tag" data-tag="duplicate">duplicate
  </span>
        </td>
      </tr>
    </table>

    
      <table class="layout-table change-head default-collapsed" id="cc-36"
             role="presentation">
      <tr>
        <td class="comment-collapse-reason"
            title="martin.oneal [1 years ago]">
            Comment hidden (duplicate)
        </td>
        <td class="comment-actions">
          <button type="button" class="change-spinner ghost iconic" id="ccs-36"
                  aria-label="Expand"
                  aria-expanded="false"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </td>
      </tr>
      </table>
  </div><div
      class="comment-text markdown-body "
      id="ct-36" data-comment-id="16499348" style="display:none"><p>how&#39;s it going?</p>
</div></div><div class="change-set" id="c37"><div class="comment" data-id="16504365" data-no="37"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-37" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" id="a9171732_415378"><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" id="a9171732_415378"><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-37"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-37" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c37">Comment 37</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-07-20 07:44 PDT" data-time="1689864261">1 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-37">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-37" data-comment-id="16504365"><p>As an example of how this can be used in the real world, if you can find a site with the following criteria, then you have a universal XSS flaw:</p>
<ul>
<li>javascript files</li>
<li>pre-flight response with * for origin and headers</li>
<li>responds to host/protocol override headers (typically a 301)</li>
</ul>
<p>So to exploit it, you use the fetch to pre-load the cache, then navigate to the site, which uses the cached redirect to load malicious javascript.</p>
</div></div><div class="change-set ca-713228" id="c38"><div class="comment" data-id="16578635" data-no="38"
       data-tags="duplicate">
    
    <table class="layout-table change-head reporter" id="ch-38" style="display:none" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" id="a9171732_415378"><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" id="a9171732_415378"><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-38"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-38" style="display:none">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c38">Comment 38</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-09-15 02:37 PDT" data-time="1694770656">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-38">
        <td colspan="2" class="comment-tags"><span class="comment-tag" data-tag="duplicate">duplicate
  </span>
        </td>
      </tr>
    </table>

    
      <table class="layout-table change-head default-collapsed" id="cc-38"
             role="presentation">
      <tr>
        <td class="comment-collapse-reason"
            title="martin.oneal [1 year ago]">
            Comment hidden (duplicate)
        </td>
        <td class="comment-actions">
          <button type="button" class="change-spinner ghost iconic" id="ccs-38"
                  aria-label="Expand"
                  aria-expanded="false"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </td>
      </tr>
      </table>
  </div><div
      class="comment-text markdown-body "
      id="ct-38" data-comment-id="16578635" style="display:none"><p>any progress?</p>
</div></div><div class="change-set" id="c39"><div class="comment" data-id="16585870" data-no="39"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-39" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_415378" id="a9171732_415378"><img src="https://secure.gravatar.com/avatar/dedff9d4500fcbc5cdd1cd270f044b33?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_415378" id="a9171732_415378"><a class="email " href="/user_profile?user_id=415378" > <span class="fna">Valentin Gosu [:valentin] (he/him) {{ PTO 21 Dec - 06 Jan }}</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-39"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-39" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c39">Comment 39</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-09-20 04:53 PDT" data-time="1695210801">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-39">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-39" data-comment-id="16585870"><p>Hi Scarlet, I&#39;m sorry for the delay here.<br>
I&#39;m trying to verify if the addition of a fetch flag to the isolation key fixes this issue, but your links don&#39;t work anymore.<br>
Could you possibly upload the sources of the test cases? It would make it much easier to reason about the correctness of the behaviour.</p>
<p>That said, I&#39;m wondering what is the status of the Chrome bug? Did they address it in any way?</p>
</div><div class="activity"><div class="change">Flags: needinfo?(martin.oneal)</div></div></div><div class="change-set" id="c40"><div class="comment" data-id="16586089" data-no="40"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-40" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" id="a9171732_415378"><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" id="a9171732_415378"><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-40"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-40" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c40">Comment 40</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-09-20 06:18 PDT" data-time="1695215917">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-40">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-40" data-comment-id="16586089"><p>haha, as far as I know, it&#39;s all still queued with everyone .</p>
<p>yeah, the test cases were decommissioned a while back: this was reported 7 months ago. ;)</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(martin.oneal)</span></div></div></div><div class="change-set" id="c41"><div class="comment" data-id="16662131" data-no="41"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-41" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" id="a9171732_415378"><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" id="a9171732_415378"><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-41"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-41" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c41">Comment 41</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-11-10 10:51 PST" data-time="1699642317">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-41">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-41" data-comment-id="16662131"><p>I reinstated the test cases, and some are still failing:</p>
<p><a href="http://a.gvj.io/" rel="nofollow">http://a.gvj.io/</a><br>
<a href="http://a.gvj.io/iframe" rel="nofollow">http://a.gvj.io/iframe</a></p>
</div></div><div class="change-set" id="c42"><div class="comment" data-id="16662315" data-no="42"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-42" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" id="a9171732_415378"><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" id="a9171732_415378"><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-42"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-42" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c42">Comment 42</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-11-10 22:06 PST" data-time="1699682774">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-42">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-42" data-comment-id="16662315"><p>Added a test for 308s, and these can be poisoned cross-site, which is a fun plot-twist. ;)</p>
</div></div><div class="change-set" id="c43"><div class="comment" data-id="16662593" data-no="43"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-43" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" id="a9171732_415378"><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" id="a9171732_415378"><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-43"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-43" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c43">Comment 43</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-11-12 00:01 PST" data-time="1699776068">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-43">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-43" data-comment-id="16662593"><p>actually, ignore me: typo in the test code.</p>
<p>as far as I can see, the caching is now fixed in line with what I&#39;d expect.</p>
<p>all the iframe poisoning is now blocked.</p>
<p>embed, object and direct poisoning is limited to same-origin, but that is inline with the cache partition strategy.</p>
<p>Do you agree that it is fixed?</p>
<p><a href="http://a.gvj.io/" rel="nofollow">http://a.gvj.io/</a><br>
<a href="http://a.gvj.io/iframe" rel="nofollow">http://a.gvj.io/iframe</a><br>
<a href="http://a.gvj.io/embed" rel="nofollow">http://a.gvj.io/embed</a><br>
<a href="http://a.gvj.io/object" rel="nofollow">http://a.gvj.io/object</a></p>
</div></div><div class="change-set" id="c44"><div class="comment" data-id="16662600" data-no="44"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-44" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" id="a9171732_415378"><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" id="a9171732_415378"><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-44"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-44" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c44">Comment 44</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-11-12 00:30 PST" data-time="1699777824">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-44">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-44" data-comment-id="16662600"><p>chrome and safari still have broken test cases though, so please hold off on any announcement.</p>
</div></div><div class="change-set" id="c45"><div class="comment" data-id="16664724" data-no="45"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-45" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_415378" id="a9171732_415378"><img src="https://secure.gravatar.com/avatar/dedff9d4500fcbc5cdd1cd270f044b33?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_415378" id="a9171732_415378"><a class="email " href="/user_profile?user_id=415378" > <span class="fna">Valentin Gosu [:valentin] (he/him) {{ PTO 21 Dec - 06 Jan }}</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-45"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-45" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c45">Comment 45</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-11-12 23:46 PST" data-time="1699861597">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-45">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-45" data-comment-id="16664724"><p>Hi Scarlet, I don&#39;t think we made any changes to fetch caching recently.<br>
Either the new test cases are wrong, or the previous ones were.</p>
</div></div><div class="change-set" id="c46"><div class="comment" data-id="16664741" data-no="46"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-46" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" id="a9171732_415378"><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" id="a9171732_415378"><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-46"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-46" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c46">Comment 46</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-11-13 00:31 PST" data-time="1699864309">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-46">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-46" data-comment-id="16664741"><p>I&#39;m confident the test cases are right: they still show consistent results on the other browsers.</p>
<p>It&#39;s obviously 9 months ago now, but IIRC when I originally logged the bug, some of the iframe tests were failing, as all the fetch reqests shared the same null origin.</p>
<p>That no-longer seems to be the case.</p>
</div></div><div class="change-set" id="c47"><div class="comment" data-id="16664757" data-no="47"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-47" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_415378" id="a9171732_415378"><img src="https://secure.gravatar.com/avatar/dedff9d4500fcbc5cdd1cd270f044b33?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_415378" id="a9171732_415378"><a class="email " href="/user_profile?user_id=415378" > <span class="fna">Valentin Gosu [:valentin] (he/him) {{ PTO 21 Dec - 06 Jan }}</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-47"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-47" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c47">Comment 47</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-11-13 00:52 PST" data-time="1699865574">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-47">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-47" data-comment-id="16664757"><p>I used mozregression to check with Firefox 109 with the new test cases, and I get the exact same values as with the latest version. Please let me know if you&#39;re seeig something different.<br>
<a href="https://mozilla.github.io/mozregression/quickstart.html" rel="nofollow">https://mozilla.github.io/mozregression/quickstart.html</a></p>
<p><code>mozregression -b 109 --find-fix</code></p>
</div><div class="activity"><div class="change">Status: NEW &rarr; RESOLVED</div><div class="change">Closed: <span class="rel-time" title="2023-11-13 00:52 PST" data-time="1699865574">1 year ago</span></div><div class="change">Resolution: --- &rarr; FIXED</div></div></div><div class="change-set" id="c48"><div class="comment" data-id="16664912" data-no="48"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-48" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" id="a9171732_415378"><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" id="a9171732_415378"><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-48"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-48" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c48">Comment 48</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-11-13 03:33 PST" data-time="1699875213">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-48">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-48" data-comment-id="16664912"><p>yep, re-downloaded 109 and seeing the same thing.</p>
</div></div><div class="change-set" id="c49"><div class="comment" data-id="16664931" data-no="49"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-49" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_415378" id="a9171732_415378"><img src="https://secure.gravatar.com/avatar/dedff9d4500fcbc5cdd1cd270f044b33?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_415378" id="a9171732_415378"><a class="email " href="/user_profile?user_id=415378" > <span class="fna">Valentin Gosu [:valentin] (he/him) {{ PTO 21 Dec - 06 Jan }}</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-49"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-49" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c49">Comment 49</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-11-13 03:43 PST" data-time="1699875791">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-49">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-49" data-comment-id="16664931"><p>I had closed the bug by mistake.</p>
</div><div class="activity"><div class="change">Severity: S2 &rarr; S3</div><div class="change">Status: RESOLVED &rarr; REOPENED</div><div class="change">Resolution: FIXED &rarr; ---</div><div class="change">Whiteboard: [necko-triaged][necko-priority-queue] &rarr; [necko-triaged][necko-monitor]</div></div></div><div class="change-set" id="c50"><div class="comment" data-id="16665132" data-no="50"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-50" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" id="a9171732_415378"><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" id="a9171732_415378"><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-50"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-50" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c50">Comment 50</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-11-13 04:39 PST" data-time="1699879171">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-50">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-50" data-comment-id="16665132"><p>so, the bits that are left are that you can poison the navigation same-site using fetch, which isn&#39;t vastly useful in the real world (as to be able to deliver it, requires another, more serious issue in the site).</p>
</div></div><div class="change-set" id="c51"><div class="comment" data-id="16669169" data-no="51"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-51" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_415378" id="a9171732_415378"><img src="https://secure.gravatar.com/avatar/dedff9d4500fcbc5cdd1cd270f044b33?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_415378" id="a9171732_415378"><a class="email " href="/user_profile?user_id=415378" > <span class="fna">Valentin Gosu [:valentin] (he/him) {{ PTO 21 Dec - 06 Jan }}</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-51"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-51" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c51">Comment 51</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-11-15 09:48 PST" data-time="1700070537">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-51">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-51" data-comment-id="16669169"><p>Note that I downgraded the bug to S3 considering <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1816390#c43" title="RESOLVED FIXED - Browser cache poisoning attack using fetch() with different headers">comment 43</a> and <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1816390#c46" title="RESOLVED FIXED - Browser cache poisoning attack using fetch() with different headers">comment 46</a>.<br>
We&#39;ll keep the bug open in order to determine if there is an actual vulnerability here, or if the original testcases were failing for a different reason.</p>
</div></div><div class="change-set" id="c52"><div class="comment" data-id="16669840" data-no="52"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-52" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" id="a9171732_415378"><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" id="a9171732_415378"><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-52"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-52" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c52">Comment 52</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-11-16 00:25 PST" data-time="1700123152">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-52">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-52" data-comment-id="16669840"><p>it&#39;s possible.</p>
<p>the original test cases spawned an iframe, then ran the test within it. the current ones wrap the whole test suite in a single iframe.</p>
<p>I&#39;ve found notable differences between browsers based on how the navigation is triggered too: location.replace or an A element onclick have different results.</p>
</div></div><div class="change-set" id="c53"><div class="comment" data-id="16674866" data-no="53"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-53" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" id="a9171732_415378"><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" id="a9171732_415378"><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-53"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-53" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c53">Comment 53</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-11-20 00:31 PST" data-time="1700469086">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-53">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-53" data-comment-id="16674866"><p>so, I went back to my original notes and found that firefox only poisoned the normal navigation cache if the Access-Control-Allow-Credentials header was present in the responses. with the headers reinstated, the current code now poisons cross-site within an iframe. pow!</p>
<p><a href="http://a.gvj.io/iframe" rel="nofollow">http://a.gvj.io/iframe</a></p>
<p>you may want to reprioritise the bug and fix that. ;)</p>
</div></div><div class="change-set" id="c54"><div class="comment" data-id="16679065" data-no="54"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-54" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" id="a9171732_415378"><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" id="a9171732_415378"><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-54"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-54" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c54">Comment 54</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-11-22 07:12 PST" data-time="1700665924">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-54">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-54" data-comment-id="16679065"><p>I&#39;ve put together a draft write-up for the issue (this isn&#39;t publically visible yet):<br>
<a href="https://attackshipsonfi.re/p/72fd0b4c-b173-4fdd-9d8f-d5a2e82e6033" rel="nofollow">https://attackshipsonfi.re/p/72fd0b4c-b173-4fdd-9d8f-d5a2e82e6033</a></p>
</div></div><div class="change-set" id="c55"><div class="comment" data-id="16680420" data-no="55"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-55" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a9171732_415378"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a9171732_415378"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-55"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-55" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c55">Comment 55</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-11-23 05:07 PST" data-time="1700744862">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-55">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-55" data-comment-id="16680420"><p>Ni Valentin for a re-triage given the last few comments.</p>
</div><div class="activity"><div class="change">Flags: needinfo?(moz.valentin)</div></div></div><div class="change-set" id="a24551865_415378"><div class="change" id="aa24551865_415378">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_415378" id="a24551865_415378"><img src="https://secure.gravatar.com/avatar/dedff9d4500fcbc5cdd1cd270f044b33?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_415378" id="a24551865_415378"><a class="email " href="/user_profile?user_id=415378" > <span class="fna">Valentin Gosu [:valentin] (he/him) {{ PTO 21 Dec - 06 Jan }}</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="as-a24551865_415378"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a24551865_415378">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#a24551865_415378">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-11-24 06:30 PST" data-time="1700836224">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Status: REOPENED &rarr; ASSIGNED</div><div class="change">Flags: <span class="activity-deleted">needinfo?(moz.valentin)</span></div></div></div><div class="change-set" id="a24554383_415378"><div class="change" id="aa24554383_415378">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_415378" id="a24554383_415378"><img src="https://secure.gravatar.com/avatar/dedff9d4500fcbc5cdd1cd270f044b33?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_415378" id="a24554383_415378"><a class="email " href="/user_profile?user_id=415378" > <span class="fna">Valentin Gosu [:valentin] (he/him) {{ PTO 21 Dec - 06 Jan }}</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="as-a24554383_415378"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a24554383_415378">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#a24554383_415378">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-11-24 07:12 PST" data-time="1700838742">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: [necko-triaged][necko-monitor] &rarr; [necko-triaged][necko-priority-queue]</div></div></div><div class="change-set" id="c56"><div class="comment" data-id="16689256" data-no="56"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-56" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_415378" id="a24554383_415378"><img src="https://secure.gravatar.com/avatar/dedff9d4500fcbc5cdd1cd270f044b33?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_415378" id="a24554383_415378"><a class="email " href="/user_profile?user_id=415378" > <span class="fna">Valentin Gosu [:valentin] (he/him) {{ PTO 21 Dec - 06 Jan }}</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-56"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-56" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c56">Comment 56</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-11-29 06:34 PST" data-time="1701268467">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-56">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-56" data-comment-id="16689256"><p>Hi Scarlet,</p>
<blockquote>
<p><a href="http://a.gvj.io/iframe" rel="nofollow">http://a.gvj.io/iframe</a></p>
</blockquote>
<p>So Sunil and I worked on this bug today and we confirmed that the iframe testcase is fixed by adding an extra flag to the <a href="https://searchfox.org/mozilla-central/rev/996f5bf0b9a32aa0620a841abb9531625fe916aa/netwerk/protocol/http/nsHttpChannel.cpp#3758" rel="nofollow">cacheKey</a> when the request is caused by a <a href="https://searchfox.org/mozilla-central/rev/996f5bf0b9a32aa0620a841abb9531625fe916aa/netwerk/protocol/http/HttpBaseChannel.cpp#3081" rel="nofollow">fetch</a> fixes the test case.</p>
<p>But when we started to work on writing tests for this we started to think about the implications of this attack.<br>
So attacker.com does a fetch request that poisons the cache, then includes an iframe to target.com that is then loaded from the cache. Since the cache, cookies and site data is keyed by the top level domain, there are no user specific info that can be obtained from getting the iframe to load  the wrong content.</p>
<p>If the cross-site cache poisoning worked for <a href="http://a.gvj.io/direct" rel="nofollow">http://a.gvj.io/direct</a> it would indeed be a lot more worrisome.<br>
But for iframes, I don&#39;t think there&#39;s anything the attacker could get from the iframe. Do you have a different view of this? Or is there some attack vector I&#39;m not seeing?</p>
</div><div class="activity"><div class="change">Flags: needinfo?(martin.oneal)</div></div></div><div class="change-set" id="c57"><div class="comment" data-id="16689456" data-no="57"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-57" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" id="a24554383_415378"><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" id="a24554383_415378"><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-57"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-57" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c57">Comment 57</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-11-29 08:38 PST" data-time="1701275892">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-57">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-57" data-comment-id="16689456"><p>for a vanilla iframe, where you are looking to isolate between the two contexts, then yup, the direct and iframe are isolated.</p>
<p>but in this case, say the exploit we&#39;re targeting is an XSS, that means we&#39;re running our code inside the iframe, and also outside. which means we can pass data between them through window messages etc. and because we&#39;re not looking to isolate them, the parent window can subsequently add allow-same-origin to the iframe sandbox, after the initial navigation that activates the exploit.</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(martin.oneal)</span></div></div></div><div class="change-set" id="c58"><div class="comment" data-id="16689511" data-no="58"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-58" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_415378" id="a24554383_415378"><img src="https://secure.gravatar.com/avatar/dedff9d4500fcbc5cdd1cd270f044b33?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_415378" id="a24554383_415378"><a class="email " href="/user_profile?user_id=415378" > <span class="fna">Valentin Gosu [:valentin] (he/him) {{ PTO 21 Dec - 06 Jan }}</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-58"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-58" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c58">Comment 58</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-11-29 09:17 PST" data-time="1701278247">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-58">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-58" data-comment-id="16689511"><p>That still doesn&#39;t explain what an attacker could steal from the iframe. You need an extra step where the iframe has access to either cookies or some other sensitive resource that is only accessible to the victim.<br>
Otherwise there is functionally no difference between you, the attacker loading <a href="http://a.gvj.io/iframe" rel="nofollow">http://a.gvj.io/iframe</a> in your browser and the victim loading <a href="http://a.gvj.io/iframe" rel="nofollow">http://a.gvj.io/iframe</a> in theirs. Or maybe there&#39;s a more creative way of making the iframe share data with a top level window of the same domain.</p>
</div></div><div class="change-set" id="c59"><div class="comment" data-id="16690318" data-no="59"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-59" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" id="a24554383_415378"><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" id="a24554383_415378"><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-59"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-59" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c59">Comment 59</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-11-30 00:33 PST" data-time="1701333191">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-59">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-59" data-comment-id="16690318"><p>it&#39;s not about stealing directly.<br>
a successful attack is often an attack-chain, gluing mutiple issues together.<br>
so the successful poisoning enables javascript running in the target site DOM.<br>
from there, you can chain it with a raft of other issues that leverage the same-site scope, or move from the null partition to direct.</p>
</div></div><div class="change-set" id="c60"><div class="comment" data-id="16699663" data-no="60"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-60" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" id="a24554383_415378"><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" id="a24554383_415378"><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-60"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-60" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c60">Comment 60</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-12-06 08:23 PST" data-time="1701879792">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-60">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-60" data-comment-id="16699663"><p>what&#39;s the plan for pushing the code?</p>
</div></div><div class="change-set" id="a25649532_1689"><div class="change" id="aa25649532_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a25649532_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a25649532_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="as-a25649532_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a25649532_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#a25649532_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-12-06 23:24 PST" data-time="1701933891">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">URL: <a href="https://attackshipsonfi.re/p/72fd0b4c-b173-4fdd-9d8f-d5a2e82e6033" target="_blank" rel="noreferrer"
           class="bug-url" data-safe="1"
        >https://attackshipsonfi.re/p/72fd0b4c...</a></div></div></div><div class="change-set" id="c61"><div class="comment" data-id="16700684" data-no="61"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-61" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a25649532_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a25649532_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-61"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-61" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c61">Comment 61</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-12-07 02:13 PST" data-time="1701943992">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-61">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-61" data-comment-id="16700684"><p>(In reply to Valentin Gosu [:valentin] (he/him) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1816390#c58" title="RESOLVED FIXED - Browser cache poisoning attack using fetch() with different headers">comment #58</a>)</p>
<blockquote>
<p>That still doesn&#39;t explain what an attacker could steal from the iframe. You need an extra step where the iframe has access to either cookies or some other sensitive resource that is only accessible to the victim.</p>
</blockquote>
<p>There could be a &quot;popup&quot; from the iframe that, still partitioned, let&#39;s users log into the iframed site. Or the target site could have used the Storage Access API to get unpartitioned cookies. But even if the cookies are partitioned, don&#39;t underestimate the ability of clever hackers to find some way to exploit this difference. It would be very site specific of course, and probably rare to get the conditions to line up, but definitely could be a problem.</p>
<p>Going back to the thinking behind the CORS pre-flight, there are some fetch/xhr requests that look and behave exactly like requests that could already be made from unscripted HTML elements. Those don&#39;t need a pre-flight because the server already has to handle those requests; we only need CORS to know whether to let the script read the response or not. Other requests—like ones that add a header!—can only be done using fetch/xhr. We need to do a pre-flight to know if we&#39;re even allowed to MAKE the request, let alone read the response.</p>
<p>Adding a cache flag to distinguish &quot;initiated by HTML&quot; from &quot;scripted and needed a pre-flight&quot; not only seems like a workable fix, I think the fundamental theory of CORS requires it. If the theory I&#39;m presenting holds any water then fetch requests that did not need a pre-flight should be cached and shared with web content rather than with requests that required a pre-flight. In most cases It probably doesn&#39;t matter either way (other than one way taking up more space), but I feel vaguely uneasy that browser engines should agree on the same behavior here and write it into the Fetch spec. Maybe some old site tries to use scripted fetch to &quot;pre-load&quot; resources to speed up the next page, and segregating the cache would defeat that (never mind that we have better dedicated features to do that these days).    ¯\_(ツ)_/¯</p>
</div></div><div class="change-set" id="c62"><div class="comment" data-id="16700728" data-no="62"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-62" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_415378" id="a25649532_1689"><img src="https://secure.gravatar.com/avatar/dedff9d4500fcbc5cdd1cd270f044b33?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_415378" id="a25649532_1689"><a class="email " href="/user_profile?user_id=415378" > <span class="fna">Valentin Gosu [:valentin] (he/him) {{ PTO 21 Dec - 06 Jan }}</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-62"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-62" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c62">Comment 62</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-12-07 02:53 PST" data-time="1701946414">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-62">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9367434"
         class="attachment"
         data-id="9367434" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="phabricator-D195757-url.txt">
      <meta itemprop="contentSize" content="48">
      <meta itemprop="encodingFormat" content="text/x-phabricator-request">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=9367434" itemprop="contentUrl" >
        <span id="att-9367434-description" itemprop="description">Bug 1816390 - Partition the cache entries generated by cross-origin fetch requests r=#necko</span></a>
        — <a href="attachment.cgi?id=9367434&amp;action=edit" itemprop="url" data-details="1">Details</a>
      </div>
    </div>

  <div
      class="comment-text markdown-body empty"
      id="ct-62" data-comment-id="16700728"></div></div><div class="change-set" id="c63"><div class="comment" data-id="16700759" data-no="63"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-63" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_102998" id="a25649532_1689"><img src="https://secure.gravatar.com/avatar/09bb44ac3625a121017cd98d0a7dc52c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_102998" id="a25649532_1689"><a class="email " href="/user_profile?user_id=102998" > <span class="fna">Anne (:annevk)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-63"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-63" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c63">Comment 63</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-12-07 03:24 PST" data-time="1701948252">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-63">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-63" data-comment-id="16700759"><p>Daniel, it&#39;s not entirely clear to me how that theory holds given top-level site HTTP cache partitioning and as such the poisoning you can do is very limited and restricted to the same site. I still haven&#39;t seen anything that invalidates <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1816390#c23" title="RESOLVED FIXED - Browser cache poisoning attack using fetch() with different headers">comment 23</a>.</p>
</div></div><div class="change-set" id="c64"><div class="comment" data-id="16700773" data-no="64"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-64" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" id="a25649532_1689"><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" id="a25649532_1689"><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-64"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-64" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c64">Comment 64</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-12-07 03:37 PST" data-time="1701949072">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-64">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-64" data-comment-id="16700773"><p>I&#39;m inclined to agree with Daniel as to the standard, as all three browser stacks have implemented the functionality differently.</p>
<p>Does that not (in itself) say something in the standard isn&#39;t clear?</p>
</div></div><div class="change-set" id="c65"><div class="comment" data-id="16700783" data-no="65"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-65" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" id="a25649532_1689"><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" id="a25649532_1689"><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-65"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-65" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c65">Comment 65</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-12-07 03:43 PST" data-time="1701949394">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-65">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-65" data-comment-id="16700783"><p>Also, if you look at <a href="http://a.gvj.io/iframe" rel="nofollow">http://a.gvj.io/iframe</a> you can see that the navigation is poisoned cross-site just fine.</p>
<p>Did affect chromium, but they&#39;ve fixed it since it was originally reported. Still affects firefox (patch as above) and safari.</p>
</div></div><div class="change-set" id="c66"><div class="comment" data-id="16702107" data-no="66"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-66" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_102998" id="a25649532_1689"><img src="https://secure.gravatar.com/avatar/09bb44ac3625a121017cd98d0a7dc52c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_102998" id="a25649532_1689"><a class="email " href="/user_profile?user_id=102998" > <span class="fna">Anne (:annevk)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-66"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-66" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c66">Comment 66</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-12-08 01:25 PST" data-time="1702027514">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-66">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-66" data-comment-id="16702107"><p>scarlet, I don&#39;t see how that demo proves anything with regards to that as there&#39;s no top-level cross-site navigation. Chromium has additional cache keying beyond top-level site and maybe you discovered a flaw in that, but Gecko and WebKit don&#39;t as far as I know. And yes, that means some same-top-level-site attacks work in Gecko and WebKit and those should (eventually) be addressed, but that&#39;s been a known bug for quite a while.</p>
</div></div><div class="change-set" id="c67"><div class="comment" data-id="16702193" data-no="67"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-67" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" id="a25649532_1689"><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" id="a25649532_1689"><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-67"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-67" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c67">Comment 67</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-12-08 02:29 PST" data-time="1702031369">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-67">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-67" data-comment-id="16702193"><p>well, there are a few problems as far as I can see.</p>
<p>the first is the fact that fetch/xhr share the cache with normal browser operations at all. the reason this is a problem is that fetch/xhr allow you to add headers to the request that do not inherently get included within the cache key. adding a flag that differentiated between fetch/xhr and regular browser operations would solve this globally.</p>
<p>the second is that the partitioning implementation is patchy. some browsers partition strictly on origin, and some samesite (eTLD). this is a critical issue, as for large eTLDs, the attack surface is huge. this discrepancy enables an attacker to jump laterally from unloved.mozilla.org to <a href="http://www.mozilla.org" rel="nofollow">www.mozilla.org</a>. I think you chaps need to make a call on this, and update the standards to match.</p>
<p>the third is the universal equivalence of the null origin with the partitioning. it is common to use an iframe wrapper for thirdparty code (for example embedding tweets in your site). if a vulnerability can be found in twitter, then an attacker can pre-seed using fetch, and then use your page with the embedded tweet to activate the attack. adding a flag that separates the null origin would solve this globally (as firefox have done).</p>
<p>the fourth is that when making the fetch/xhr request, the pre-flight obviously has to succeed for the regular request to be attempted, but if the response fails the CORS check, then the HTTP cache is updated anyway. you chaps may want to reverse the order of those operations, so that only successful requests are cached.</p>
<p>I would have though that some or all of those were whatwg standards things, no?</p>
</div></div><div class="change-set" id="c68"><div class="comment" data-id="16709827" data-no="68"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-68" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" id="a25649532_1689"><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" id="a25649532_1689"><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-68"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-68" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c68">Comment 68</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-12-13 05:46 PST" data-time="1702475194">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-68">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-68" data-comment-id="16709827"><p>Is there an ETA for shipping the patched version?</p>
</div></div><div class="change-set" id="c69"><div class="comment" data-id="16728717" data-no="69"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-69" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_575867" id="a25649532_1689"><img src="https://secure.gravatar.com/avatar/9eb8612b118640351041fb0877c5fc8f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_575867" id="a25649532_1689"><a class="email " href="/user_profile?user_id=575867" > <span class="fna">BugBot [:suhaib / :marco/ :calixte]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-69"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-69" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c69">Comment 69</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2023-12-27 04:11 PST" data-time="1703679085">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-69">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-69" data-comment-id="16728717"><p>There is an r+ patch which didn&#39;t land and no activity in this bug for 2 weeks.<br>
:valentin, could you have a look please?<br>
If you still have some work to do, you can add an action &quot;Plan Changes&quot; in Phabricator.<br>
For more information, please visit <a href="https://wiki.mozilla.org/BugBot#not_landed.py" rel="nofollow">BugBot documentation</a>.</p>
</div><div class="activity"><div class="change">Flags: needinfo?(moz.valentin)</div><div class="change">Flags: needinfo?(kershaw)</div></div></div><div class="change-set" id="a28067612_505624"><div class="change" id="aa28067612_505624">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_505624" id="a28067612_505624"><img src="https://secure.gravatar.com/avatar/608e04ebca94be52b05c003d51d43e07?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_505624" id="a28067612_505624"><a class="email " href="/user_profile?user_id=505624" > <span class="fna">Kershaw Chang [:kershaw]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="as-a28067612_505624"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a28067612_505624">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#a28067612_505624">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2024-01-03 23:06 PST" data-time="1704351971">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(kershaw)</span></div></div></div><div class="change-set" id="c70"><div class="comment" data-id="16740829" data-no="70"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-70" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_415378" id="a28067612_505624"><img src="https://secure.gravatar.com/avatar/dedff9d4500fcbc5cdd1cd270f044b33?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_415378" id="a28067612_505624"><a class="email " href="/user_profile?user_id=415378" > <span class="fna">Valentin Gosu [:valentin] (he/him) {{ PTO 21 Dec - 06 Jan }}</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-70"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-70" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c70">Comment 70</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2024-01-08 02:23 PST" data-time="1704709427">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-70">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-70" data-comment-id="16740829"><p>(In reply to scarlet from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1816390#c68" title="RESOLVED FIXED - Browser cache poisoning attack using fetch() with different headers">comment #68</a>)</p>
<blockquote>
<p>Is there an ETA for shipping the patched version?</p>
</blockquote>
<p>I&#39;ll try to land it sometimes this week.</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(moz.valentin)</span></div></div></div><div class="change-set" id="c71"><div class="comment" data-id="16741079" data-no="71"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-71" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" id="a28067612_505624"><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" id="a28067612_505624"><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-71"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-71" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c71">Comment 71</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2024-01-08 04:17 PST" data-time="1704716237">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-71">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-71" data-comment-id="16741079"><p>cool, ta</p>
</div></div><div class="change-set" id="c72"><div class="comment" data-id="16742727" data-no="72"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-72" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" id="a28067612_505624"><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" id="a28067612_505624"><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-72"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-72" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c72">Comment 72</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2024-01-09 07:25 PST" data-time="1704813908">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-72">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-72" data-comment-id="16742727"><p>Hey chaps,</p>
<p>since the last time I looked (admitedly a few months back), there have been a couple of changes to the way firefox poisons:</p>
<ul>
<li>same-site now works for direct (was only same-origin)</li>
<li>303s don&#39;t cache at all</li>
</ul>
<p>is that a deliberate change in behaviour, or a side effect of another change in partitioning/caching that has been pushed?</p>
</div></div><div class="change-set" id="c73"><div class="comment" data-id="16752482" data-no="73"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-73" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_510726" id="a28067612_505624"><img src="https://secure.gravatar.com/avatar/a9d6ca739b340c670a0fecbd2c36f516?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_510726" id="a28067612_505624"><a class="email " href="/user_profile?user_id=510726" > <span class="fna">Pulsebot</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-73"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-73" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c73">Comment 73</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2024-01-16 02:54 PST" data-time="1705402489">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-73">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text  "
      id="ct-73" data-comment-id="16752482">Pushed by <a href="mailto:valentin.gosu&#64;gmail.com">valentin.gosu&#64;gmail.com</a>:
<a rel="nofollow" href="https://hg.mozilla.org/integration/autoland/rev/94ed4d6361b3">https://hg.mozilla.org/integration/autoland/rev/94ed4d6361b3</a>
Partition the cache entries generated by cross-origin fetch requests r=necko-reviewers,kershaw,jesup</div></div><div class="change-set" id="c74"><div class="comment" data-id="16752502" data-no="74"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-74" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_415378" id="a28067612_505624"><img src="https://secure.gravatar.com/avatar/dedff9d4500fcbc5cdd1cd270f044b33?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_415378" id="a28067612_505624"><a class="email " href="/user_profile?user_id=415378" > <span class="fna">Valentin Gosu [:valentin] (he/him) {{ PTO 21 Dec - 06 Jan }}</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-74"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-74" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c74">Comment 74</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2024-01-16 03:05 PST" data-time="1705403158">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-74">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9373002"
         class="attachment"
         data-id="9373002" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="phabricator-D198674-url.txt">
      <meta itemprop="contentSize" content="48">
      <meta itemprop="encodingFormat" content="text/x-phabricator-request">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=9373002" itemprop="contentUrl" >
        <span id="att-9373002-description" itemprop="description">Bug 1816390 - test r=#necko</span></a>
        — <a href="attachment.cgi?id=9373002&amp;action=edit" itemprop="url" data-details="1">Details</a>
      </div>
    </div>

  <div
      class="comment-text markdown-body empty"
      id="ct-74" data-comment-id="16752502"></div></div><div class="change-set" id="c75"><div class="comment" data-id="16752983" data-no="75"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-75" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_258347" id="a28067612_505624"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_258347" id="a28067612_505624"><a class="email " href="/user_profile?user_id=258347" > <span class="fna">Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-75"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-75" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c75">Comment 75</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2024-01-16 08:42 PST" data-time="1705423362">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-75">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-75" data-comment-id="16752983"><p><a href="https://hg.mozilla.org/mozilla-central/rev/94ed4d6361b3" rel="nofollow">https://hg.mozilla.org/mozilla-central/rev/94ed4d6361b3</a></p>
</div><div class="activity"><div class="change">Group: network-core-security &rarr; core-security-release</div><div class="change">Status: ASSIGNED &rarr; RESOLVED</div><div class="change">Closed: <span class="rel-time" title="2023-11-13 00:52 PST" data-time="1699865574">1 year ago</span> &rarr; <span class="rel-time" title="2024-01-16 08:42 PST" data-time="1705423362">1 year ago</span></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox123&amp;o1=isnotempty">status-firefox123</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox123&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">Resolution: --- &rarr; FIXED</div><div class="change">Target Milestone: --- &rarr; 123 Branch</div></div></div><div class="change-set" id="a29151444_75935"><div class="change" id="aa29151444_75935">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a29151444_75935"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_75935" id="a29151444_75935"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="as-a29151444_75935"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a29151444_75935">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#a29151444_75935">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2024-01-16 12:10 PST" data-time="1705435803">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox121&amp;o1=isnotempty">status-firefox121</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox121&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox122&amp;o1=isnotempty">status-firefox122</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox122&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr115&amp;o1=isnotempty">status-firefox-esr115</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr115&amp;o1=equals&amp;v1=wontfix">wontfix</a></div></div></div><div class="change-set" id="c76"><div class="comment" data-id="16754483" data-no="76"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-76" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" id="a29151444_75935"><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" id="a29151444_75935"><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-76"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-76" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c76">Comment 76</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2024-01-17 07:08 PST" data-time="1705504115">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-76">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-76" data-comment-id="16754483"><p>can you please tag this bug for a bounty? TIA</p>
</div></div><div class="change-set" id="a29745526_159069"><div class="change" id="aa29745526_159069">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a29745526_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_159069" id="a29745526_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="as-a29745526_159069"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a29745526_159069">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#a29745526_159069">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2024-01-23 09:11 PST" data-time="1706029885">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: sec-bounty?</div></div></div><div class="change-set" id="c77"><div class="comment" data-id="16764677" data-no="77"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-77" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_713228" id="a29745526_159069"><img src="https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_713228" id="a29745526_159069"><a class="email " href="/user_profile?user_id=713228" > <span class="fna">scarlet</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-77"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-77" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c77">Comment 77</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2024-01-23 09:42 PST" data-time="1706031727">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-77">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-77" data-comment-id="16764677"><p>thanks!</p>
</div></div><div class="change-set" id="a29878946_488993"><div class="change" id="aa29878946_488993">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_488993" id="a29878946_488993"><img src="https://secure.gravatar.com/avatar/cbdd015c31ac3b59d7b54121cb25c744?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_488993" id="a29878946_488993"><a class="email " href="/user_profile?user_id=488993" > <span class="fna">Andrei Vaida [:avaida]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="as-a29878946_488993"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a29878946_488993">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#a29878946_488993">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2024-01-24 22:15 PST" data-time="1706163305">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">QA Whiteboard: [post-critsmash-triage]</div><div class="change">Flags: qe-verify-</div></div></div><div class="change-set" id="a30962685_1689"><div class="change" id="aa30962685_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a30962685_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a30962685_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="as-a30962685_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a30962685_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#a30962685_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2024-02-06 11:17 PST" data-time="1707247044">11 months ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: sec-bounty? &rarr; sec-bounty+</div></div></div><div class="change-set" id="a31572107_578488"><div class="change" id="aa31572107_578488">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_578488" id="a31572107_578488"><img src="https://secure.gravatar.com/avatar/6822db445808be789b12cfae22d118dc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_578488" id="a31572107_578488"><a class="email " href="/user_profile?user_id=578488" > <span class="fna">Tom Ritter [:tjr]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="as-a31572107_578488"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a31572107_578488">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#a31572107_578488">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2024-02-13 12:34 PST" data-time="1707856466">11 months ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: [necko-triaged][necko-priority-queue] &rarr; [necko-triaged][necko-priority-queue][adv-main123+]</div></div></div><div class="change-set" id="c78"><div class="comment" data-id="16796365" data-no="78"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-78" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_578488" id="a31572107_578488"><img src="https://secure.gravatar.com/avatar/6822db445808be789b12cfae22d118dc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_578488" id="a31572107_578488"><a class="email " href="/user_profile?user_id=578488" > <span class="fna">Tom Ritter [:tjr]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-78"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-78" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#c78">Comment 78</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2024-02-13 14:52 PST" data-time="1707864739">11 months ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-78">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9380042"
         class="attachment"
         data-id="9380042" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="file_1816390.txt">
      <meta itemprop="contentSize" content="518">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=9380042" itemprop="contentUrl" >
        <span id="att-9380042-description" itemprop="description">advisory.txt</span></a>
        — <a href="attachment.cgi?id=9380042&amp;action=edit" itemprop="url" data-details="1">Details</a>
      </div>
    </div>

  <div
      class="comment-text markdown-body empty"
      id="ct-78" data-comment-id="16796365"></div></div><div class="change-set" id="a31617272_428608"><div class="change" id="aa31617272_428608">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a31617272_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_428608" id="a31617272_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="as-a31617272_428608"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a31617272_428608">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#a31617272_428608">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2024-02-14 01:07 PST" data-time="1707901631">11 months ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Keywords: <a href="/buglist.cgi?keywords=sec-other&amp;resolution=---">sec-other</a> &rarr; <a href="/buglist.cgi?keywords=sec-moderate&amp;resolution=---">sec-moderate</a></div></div></div><div class="change-set" id="a31735757_578488"><div class="change" id="aa31735757_578488">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_578488" id="a31735757_578488"><img src="https://secure.gravatar.com/avatar/6822db445808be789b12cfae22d118dc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_578488" id="a31735757_578488"><a class="email " href="/user_profile?user_id=578488" > <span class="fna">Tom Ritter [:tjr]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="as-a31735757_578488"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a31735757_578488">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#a31735757_578488">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2024-02-15 10:01 PST" data-time="1708020116">11 months ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Alias: CVE-2024-1554</div></div></div><div class="change-set" id="a40807964_5898"><div class="change" id="aa40807964_5898">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_5898" id="a40807964_5898"><img src="https://secure.gravatar.com/avatar/afd301f3bbbe2b1a94d93a1e7c313d9e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_5898" id="a40807964_5898"><a class="email " href="/user_profile?user_id=5898" > <span class="fna">David Lawrence [:dkl]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="as-a40807964_5898"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a40807964_5898">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#a40807964_5898">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2024-05-30 11:05 PDT" data-time="1717092323">8 months ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Keywords: <a href="/buglist.cgi?keywords=reporter-external&amp;resolution=---">reporter-external</a></div></div></div><div class="change-set" id="a50186643_1689"><div class="change" id="aa50186643_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a50186643_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a50186643_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="as-a50186643_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a50186643_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1816390#a50186643_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2024-09-16 00:16 PDT" data-time="1726471002">4 months ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: <span class="activity-deleted">core-security-release</span></div></div></div><div id="new-comment-notice">
          You need to <a href="/show_bug.cgi?id=1816390&amp;GoAheadAndLogIn=1">log in</a>
          before you can comment on or make changes to this bug.
        </div>



<div id="bottom-actions">
  <div id="bottom-right-actions">
    <button type="button" id="top-btn" class="secondary" aria-label="Go to Page Top">Top &uarr;</button>
  </div>
</div>



<dialog id="att-overlay" class="readonly"
        aria-labelledby="att-overlay-title" data-attachment-count="3">
  <form method="dialog">
    <div class="header">
      <h2 id="att-overlay-title" class="title">Attachment</h2>
      <div class="spacer"></div>
      <button type="button" class="secondary iconic" hidden disabled data-action="prev"
              title="Previous Attachment" aria-keyshortcuts="ArrowLeft">
        <span class="icon" aria-hidden="true"></span>
      </button>
      <button type="button" class="secondary iconic" hidden disabled data-action="next"
              title="Next Attachment" aria-keyshortcuts="ArrowRight">
        <span class="icon" aria-hidden="true"></span>
      </button>
      <button type="button" class="secondary" data-action="toggle-details">Hide Details</button>
      <button type="button" class="secondary iconic" data-action="close" aria-label="Close">
        <span class="icon" aria-hidden="true"></span>
      </button>
    </div>
    <div class="body">
      <div class="sub-column">
        <div class="detail-pane">
          <section class="cols">
            <h3>General</h3>
            <div class="creator">
              Creator: <div class="vcard vcard_415378" ><a class="email " href="/user_profile?user_id=415378" > <span class="fna">Valentin Gosu [:valentin] (he/him) {{ PTO 21 Dec - 06 Jan }}</span></a>
</div>
            </div>
            <div>Created: <span class="created-date rel-time"></span></div>
            <div>Updated: <span class="updated-date rel-time"></span></div>
            <div>Size: <span class="file-size"></span></div>
          </section>
          <section class="cols">
            <h3>
              <label for="att-overlay-description">Description</label>
            </h3>
            <div>
              <input type="text" name="description" disabled
                     id="att-overlay-description" class="flex">
            </div>
          </section>
          <section class="cols">
            <h3>
              <label for="att-overlay-file-name">File Name</label>
            </h3>
            <div>
              <input type="text" name="filename" disabled
                     id="att-overlay-file-name" class="flex">
            </div>
          </section>
          <section class="cols">
            <h3>
              <label for="att-overlay-content-type">Content Type</label>
            </h3>
              <div>
                <input type="text" name="contenttypeentry" disabled id="att-overlay-content-type"
                       class="flex">
              </div>
          </section>
          
        </div>
      </div>
      <div class="main-column">
        <div class="preview-pane">
          <div class="preview ">
          </div>
        </div>
      </div>
    </div>
    <div class="footer">
      <button type="button" class="secondary" data-action="raw">Raw</button>
        <button type="button" class="secondary" disabled data-action="diff">Diff</button>
        <button type="button" class="secondary" disabled data-action="review"
                data-base="https://bugzilla.mozilla.org/page.cgi?id=splinter.html&amp;ignore=">Splinter Review</button>
      <div class="spacer"></div>
    </div>
  </form>
</dialog>
<link rel="stylesheet" href="/static/v20250108.1/extensions/FlagTypeComment/web/styles/ftc.css">
<script nonce="hpA0hGj0JJn7pHxOBmH4elY8pwVjemdqG9XQDMYo3QJb8fci" src="/static/v20250108.1/extensions/FlagTypeComment/web/js/ftc.js"></script></div> 
</main> 
</div> 


</body>
</html>