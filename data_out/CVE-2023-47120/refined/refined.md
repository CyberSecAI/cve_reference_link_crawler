Based on the provided information, here's an analysis of CVE-2023-47120:

**Root Cause of Vulnerability:**
The vulnerability stems from the lack of proper validation and limitation on the length of favicon URLs processed by the Onebox feature in Discourse. Specifically, the `UrlHelper` class did not enforce a maximum length for URLs, allowing excessively long URLs to be processed.

**Weaknesses/Vulnerabilities Present:**
- **Unrestricted URL Length:** The primary weakness is the absence of a limit on the length of favicon URLs. This allows an attacker to supply a very long URL, which when processed, can lead to excessive memory consumption.
- **Onebox Cache Overflow:** The Onebox feature caches the processed favicon URLs. When a long URL is repeatedly processed, it can cause the cache to grow excessively, eventually leading to memory exhaustion.

**Impact of Exploitation:**
- **Denial of Service (DoS):** The primary impact is a denial-of-service (DoS) attack, caused by Redis memory exhaustion. When the Redis memory is depleted, the application's functionality is severely impacted, possibly resulting in service unavailability.

**Attack Vectors:**
- **Crafted Site:** An attacker can create a site with an abnormally long favicon URL.
- **Multiple Posts:** The attacker then needs to draft multiple posts within the Discourse forum which then uses Onebox to process the crafted favicon URL from the malicious site.

**Required Attacker Capabilities/Position:**
- **Network Access:** The attacker needs to be able to interact with a Discourse instance over the network.
- **No Special Privileges:** No special user privileges or user interaction are needed to trigger the vulnerability.
- **Ability to post to Discourse:** The attacker needs the ability to create posts in the forum.

**Additional details:**
- The vulnerability is fixed by limiting the length of URLs in the `UrlHelper` class and the max download size in the Onebox module.
- The fix involved setting `MAX_URL_LENGTH` to 2,000 characters. The `max_download_kb` was reduced from 10MB to 2MB.
- The vulnerability is classified as having a "High" severity.
- The CVSS v3 base score is 7.5, with a vector of CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
- Affected versions include Discourse stable versions > 3.1.0 and < 3.1.2, and beta/tests-passed versions > 3.1.0.beta6 and < 3.2.0.beta2.
- Patched versions are stable >= 3.1.3 and beta/tests-passed >= 3.2.0.beta3.