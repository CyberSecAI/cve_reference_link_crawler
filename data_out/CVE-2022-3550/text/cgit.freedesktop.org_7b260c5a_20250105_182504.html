

| [cgit logo](/) | [index](/) : [xorg/xserver](/xorg/xserver/) | COMPOSITEWRAP CYGWIN DAMAGE-XFIXES Domain-branch IPv6-REVIEW XACE-SELINUX XACE-modular XEVIE XORG-6\_8-branch XORG-RELEASE-1 XORG-RELEASE-1-STSF XORG-RELEASE-1-TM XORG-STABLE XPRINT autoconfig-for-7.2 bcook-backend compat\_output dmx-2 dri-0-1-branch dri2-swapbuffers exa-damagetrack glucose-2 gsr-current input-hotplug lg3d lg3d-7.2 lg3d-dev lg3d-dev-0-6-1 lg3d-dev-0-6-1-1 lg3d-dev-0-6-1-current lg3d-dev-0-6-1-latest lg3d-dev-0-6-2 lg3d-dev-0-6-latest lg3d-dev-0-7-0 lg3d-dev-0-7-1 lg3d-event lg3d-master master mpx no-pci-rework orib-soc-2006 panning-for-server-1.6 pci-rework randr-1.2 randr-1.2-for-server-1.2 randr-dpms sco\_port\_update server-1.10-branch server-1.11-branch server-1.12-branch server-1.13-branch server-1.14-branch server-1.15-branch server-1.16-branch server-1.17-branch server-1.18-branch server-1.19-branch server-1.2-branch server-1.20-branch server-1.3-branch server-1.4-branch server-1.5-branch server-1.6-branch server-1.6-enterleave server-1.7-branch server-1.7-nominations server-1.8-branch server-1.9-branch server-1\_0-branch server-1\_1-branch server-21.1-branch transform-proposal wonderland-dev xf-4\_0\_2-branch xf-4\_1-branch xf-4\_2-branch xf-4\_3-branch xfixes\_2\_branch xgl-0-0-1 xorg-server-1.2-apple xorg-server-1.4-apple xorg-server-1.5-apple xorg-server-1.6-apple xorg-server-1.7-apple xquartz-composite xwayland-21.1 xwayland-22.1 xwayland-23.1 xwayland-23.2 xwayland-24.1 |
| --- | --- | --- |
| X server (mirrored from https://gitlab.freedesktop.org/xorg/xserver) | keithp |

| [summary](/xorg/xserver/)[refs](/xorg/xserver/refs/?id=11beef0b7f1ed290348e45618e5fa0d2bffcb72e)[log](/xorg/xserver/log/)[tree](/xorg/xserver/tree/?id=11beef0b7f1ed290348e45618e5fa0d2bffcb72e)[commit](/xorg/xserver/commit/?id=11beef0b7f1ed290348e45618e5fa0d2bffcb72e)[diff](/xorg/xserver/diff/?id=11beef0b7f1ed290348e45618e5fa0d2bffcb72e) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Peter Hutterer <peter.hutterer@who-t.net> | 2022-07-05 12:06:20 +1000 |
| --- | --- | --- |
| committer | Peter Hutterer <peter.hutterer@who-t.net> | 2022-07-13 14:37:51 +1000 |
| commit | [11beef0b7f1ed290348e45618e5fa0d2bffcb72e](/xorg/xserver/commit/?id=11beef0b7f1ed290348e45618e5fa0d2bffcb72e) ([patch](/xorg/xserver/patch/?id=11beef0b7f1ed290348e45618e5fa0d2bffcb72e)) | |
| tree | [cb5d9657548e36a9e283d180e22159ed3ffb8e36](/xorg/xserver/tree/?id=11beef0b7f1ed290348e45618e5fa0d2bffcb72e) | |
| parent | [1bb7767f19969ee6b109f7424ff97738752d18c9](/xorg/xserver/commit/?id=1bb7767f19969ee6b109f7424ff97738752d18c9) ([diff](/xorg/xserver/diff/?id=11beef0b7f1ed290348e45618e5fa0d2bffcb72e&id2=1bb7767f19969ee6b109f7424ff97738752d18c9)) | |

xkb: proof GetCountedString against request length attacksGetCountedString did a check for the whole string to be within the
request buffer but not for the initial 2 bytes that contain the length
field. A swapped client could send a malformed request to trigger a
swaps() on those bytes, writing into random memory.
Signed-off-by: Peter Hutterer <peter.hutterer@who-t.net>
[Diffstat](/xorg/xserver/diff/?id=11beef0b7f1ed290348e45618e5fa0d2bffcb72e)

| -rw-r--r-- | [xkb/xkb.c](/xorg/xserver/diff/xkb/xkb.c?id=11beef0b7f1ed290348e45618e5fa0d2bffcb72e) | 5 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 0 deletions

| diff --git a/xkb/xkb.c b/xkb/xkb.cindex f42f59ef3..1841cff26 100644--- a/[xkb/xkb.c](/xorg/xserver/tree/xkb/xkb.c?id=1bb7767f19969ee6b109f7424ff97738752d18c9)+++ b/[xkb/xkb.c](/xorg/xserver/tree/xkb/xkb.c?id=11beef0b7f1ed290348e45618e5fa0d2bffcb72e)@@ -5137,6 +5137,11 @@ \_GetCountedString(char \*\*wire\_inout, ClientPtr client, char \*\*str) CARD16 len;  wire = \*wire\_inout;++ if (client->req\_len <+ bytes\_to\_int32(wire + 2 - (char \*) client->requestBuffer))+ return BadValue;+ len = \*(CARD16 \*) wire; if (client->swapped) { swaps(&len); |
| --- |

generated by [cgit v1.2.3](https://git.zx2c4.com/cgit/about/) ([git 2.39.1](https://git-scm.com/)) at 2025-01-05 18:25:04 +0000

