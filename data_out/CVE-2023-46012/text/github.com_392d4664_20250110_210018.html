
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdest-3%2FCVE-2023-46012%2Ftree%2Fmain)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdest-3%2FCVE-2023-46012%2Ftree%2Fmain)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=dest-3%2FCVE-2023-46012)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[dest-3](/dest-3)
/
**[CVE-2023-46012](/dest-3/CVE-2023-46012)**
Public

* [Notifications](/login?return_to=%2Fdest-3%2FCVE-2023-46012) You must be signed in to change notification settings
* [Fork
  2](/login?return_to=%2Fdest-3%2FCVE-2023-46012)
* [Star
   3](/login?return_to=%2Fdest-3%2FCVE-2023-46012)

LINKSYS AC1900 EA7500v3 IGD UPnP Stack Buffer Overflow Remote Code Execution Vulnerability

[3
stars](/dest-3/CVE-2023-46012/stargazers) [2
forks](/dest-3/CVE-2023-46012/forks) [Branches](/dest-3/CVE-2023-46012/branches) [Tags](/dest-3/CVE-2023-46012/tags) [Activity](/dest-3/CVE-2023-46012/activity)
 [Star](/login?return_to=%2Fdest-3%2FCVE-2023-46012)

 [Notifications](/login?return_to=%2Fdest-3%2FCVE-2023-46012) You must be signed in to change notification settings

* [Code](/dest-3/CVE-2023-46012)
* [Issues
  0](/dest-3/CVE-2023-46012/issues)
* [Pull requests
  0](/dest-3/CVE-2023-46012/pulls)
* [Actions](/dest-3/CVE-2023-46012/actions)
* [Projects
  0](/dest-3/CVE-2023-46012/projects)
* [Security](/dest-3/CVE-2023-46012/security)
* [Insights](/dest-3/CVE-2023-46012/pulse)

Additional navigation options

* [Code](/dest-3/CVE-2023-46012)
* [Issues](/dest-3/CVE-2023-46012/issues)
* [Pull requests](/dest-3/CVE-2023-46012/pulls)
* [Actions](/dest-3/CVE-2023-46012/actions)
* [Projects](/dest-3/CVE-2023-46012/projects)
* [Security](/dest-3/CVE-2023-46012/security)
* [Insights](/dest-3/CVE-2023-46012/pulse)

# dest-3/CVE-2023-46012

    main[Branches](/dest-3/CVE-2023-46012/branches)[Tags](/dest-3/CVE-2023-46012/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[11 Commits](/dest-3/CVE-2023-46012/commits/main/) | | |
| [README.md](/dest-3/CVE-2023-46012/blob/main/README.md "README.md") | | [README.md](/dest-3/CVE-2023-46012/blob/main/README.md "README.md") |  |  |
| [poc.py](/dest-3/CVE-2023-46012/blob/main/poc.py "poc.py") | | [poc.py](/dest-3/CVE-2023-46012/blob/main/poc.py "poc.py") |  |  |
| [poc\_v1.1.5.190349.py](/dest-3/CVE-2023-46012/blob/main/poc_v1.1.5.190349.py "poc_v1.1.5.190349.py") | | [poc\_v1.1.5.190349.py](/dest-3/CVE-2023-46012/blob/main/poc_v1.1.5.190349.py "poc_v1.1.5.190349.py") |  |  |
| View all files | | |

## Repository files navigation

* README
# CVE-2023-46012

## LINKSYS AC1900 EA7500v3 IGD UPnP Stack Buffer Overflow Remote Code Execution Vulnerability

This vulnerability allows network-adjacent attackers to execute arbitrary code on affected installations of LINKSYS EA7500 routers. Authentication is not required to exploit this vulnerability.

The specific flaw exists within the handling of HTTP request data to the IGD UPnP service. When parsing the contents of a user-supplied variable of a given SOAP UPnP Action Request, the process does not
properly validate the length of user-supplied data prior to copying it to a fixed-length stack buffer. An attacker can leverage this vulnerability to execute code in the context of root.

**Product/Firmware: Linksys EA7500 Firmware ALL VERSIONS including Ver.3.0.1.207964 - Other router models and firmware versions using this binary are also affected**

### Root Cause Analysis

The UPnP IGD service binary is located at `/usr/sbin/IGD` and is running by default on port 49152. This service provides the `IGDdevicedesc.xml` UPnP XML description file that details several functions that can be invoked using HTTP requests with an XML body.
One of these functions is SetDefaultConnectionService. This function requires one variable of type string. When the SetDefaultConnectionService function is invoked and executed, the program does not validate the length of the user-supplied variable prior to
performing a strncpy call involving this buffer. Both the source address and copy size variables of the strncpy call are user-controlled, with the copy size being the length of the user-supplied variable.
The data is then copied to a fixed buffer of 184 bytes, leading to a stack buffer overflow vulnerability.

### Code Flow

The function SetDefaultConnectionService is labeled as \_set\_connection\_type. The function begins by initializing a 184-byte buffer and then obtains a pointer to the buffer holding the user-supplied string variable included in the request if it is not NULL.
This is done by calling PAL\_xml\_node\_GetFirstbyName and then PAL\_xml\_node\_get\_value. See code below:

```
int _set_connection_type(int **param_1)

{
  int iVar1;
  char *var_value;
  size_t var_value_length;
  undefined uVar2;
  undefined1 *puVar3;
  char **ppcVar4;
  undefined4 *puVar5;
  char *pcVar6;
  int *piVar7;
  char acStack_d4 [184]; -----> /* Initializing 184-byte buffer */

  memset(acStack_d4,0,0xb4);
  iVar1 = PAL_xml_node_GetFirstbyName((*param_1)[0xf0],"NewConnectionType",0); -----> /* iVar1 now points to the user-supplied value */
  if ((iVar1 != 0) && (var_value = (char *)PAL_xml_node_get_value(), var_value != (char *)0x0)) { -----> /* Ensures the user-supplied value is not empty and obtains a pointer to it */
  ...
```

### Injection Point

Later in the same function, a strlen call is performed to obtain the size of the user-supplied string plus a static offset of 0x174. The vulnerable condition is triggered in the
subsequent strncpy call where the destination argument is the address of the newly initialized 184-byte buffer, the source is the pointer to the user-supplied string, and the size of the copy operation is
the size of the user-supplied string returned by the call to strlen plus a static offset of 0x174.
This leads to a buffer overflow vulnerability as both the source address and size variables are controlled by the user and no size validation checks are performed.
See code below:

```
int _set_connection_type(int **param_1)

{
 ...

      var_value_length = strlen((char *)(iVar1 + 0x174)); ----> /* iVar1 is a pointer to the user supplied string */
      strncpy(acStack_d4,(char *)(iVar1 + 0x174),var_value_length + 1); ----> /* Vulnerable strncpy call */
 ...
```

The offset to overwriting a function return address on the stack is 276 bytes. The next 4 bytes can be utilized to redirect execution to an arbitrary address and thus hijack the control flow of the program.

### Suggested Fixes

1. Use a safer string copy function: Instead of using strncpy, which does not guarantee null-termination of the destination buffer, a safer string copy function can be used like strncpy\_s or memcpy\_s. These functions ensure that the destination buffer is always null-terminated and do not allow the copying of more data than the buffer can hold.
2. Input validation: Validate user input to ensure that it does not exceed the size of the destination buffer. If the input is longer than the buffer size, either reject it or truncate it to fit within the buffer.
3. Use a dynamically allocated buffer: Allocate memory for the destination buffer dynamically instead of using a fixed-size stack buffer. This approach allows the buffer size to be adjusted according to the input data size. (Not recommended for a system with limited resources)

PoC Execution: `python poc.py 192.168.1.1 49152`

Software Download Link: <https://www.linksys.com/support-article?articleNum=49798> (Firmware version Ver. 3.0.1.207964)

### Notes for Debugging

* The router has a UART interface that can be used to obtain a root shell. Credentials for root access are root:admin.
* The testing device that was used during this engagement is EA7500 R75. This device has a UART interface with the Rx pin disabled.
  + To connect the Rx line, a bent paperclip was used to connect the Rx pin to a line on the PCB making it possible to login to the device.
* With a root shell on the box, drop a statically-compiled gdb-server (I used the prebuilt binary `gdbserver-7.7.1-armel-eabi5-v1-sysv` available here: <https://github.com/stayliv3/gdb-static-cross/tree/master/prebuilt>).
* Use `pkill IGD` to terminate the binary and then relaunch it using `./gdbserver :1337 /usr/sbin/IGD`. The following .gdbinit file can be used to initiate a stable debugging session:

```
> set follow-fork-mode child
> set detach-on-fork off
> target remote 192.168.1.1:1337
> c

```

### Additional Links

* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-46012>
* <https://nvd.nist.gov/vuln/detail/CVE-2023-46012>

## About

LINKSYS AC1900 EA7500v3 IGD UPnP Stack Buffer Overflow Remote Code Execution Vulnerability

### Resources

[Readme](#readme-ov-file)

[Activity](/dest-3/CVE-2023-46012/activity)
### Stars

[**3**
stars](/dest-3/CVE-2023-46012/stargazers)
### Watchers

[**1**
watching](/dest-3/CVE-2023-46012/watchers)
### Forks

[**2**
forks](/dest-3/CVE-2023-46012/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fdest-3%2FCVE-2023-46012&report=dest-3+%28user%29)

## [Releases](/dest-3/CVE-2023-46012/releases)

No releases published

## [Packages 0](/users/dest-3/packages?repo_name=CVE-2023-46012)

No packages published

## Languages

* [Python
  100.0%](/dest-3/CVE-2023-46012/search?l=python)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

