The provided content relates to CVE-2024-26950.

**Root cause of vulnerability:**
The vulnerability stems from accessing the device through `peer->device` in the WireGuard netlink code, which could lead to a NULL pointer dereference if the `peer->device` is NULL. This can occur if the peer is freed.

**Weaknesses/vulnerabilities present:**
- Potential NULL pointer dereference when accessing `peer->device`.

**Impact of exploitation:**
- Denial of service due to a crash caused by the NULL pointer dereference.

**Attack vectors:**
- Triggering the vulnerable code path in `get_peer` function within `drivers/net/wireguard/netlink.c` through netlink interaction with WireGuard module.
- Actions that cause a peer to be freed could potentially trigger the vulnerability.

**Required attacker capabilities/position:**
- Ability to interact with the WireGuard netlink interface.
- Ability to trigger the freeing of a peer object while still having an active context referring to the peer.

**Additional notes:**
- The fix replaces `peer->device->peer_allowedips.seq` with `ctx->wg->peer_allowedips.seq` which is semantically correct because `ctx` contains the context for the WireGuard device. This also avoids dereferencing freed `peer` objects.
- The commit message explicitly mentions that this fix also acts as a defense-in-depth provision against freed peers.
- The fix is included in multiple stable kernel branches, as shown by the multiple git commits.