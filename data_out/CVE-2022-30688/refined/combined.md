=== Content from github.com_94fbe732_20250108_120453.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fliske%2Fneedrestart%2Freleases%2Ftag%2Fv3.6)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fliske%2Fneedrestart%2Freleases%2Ftag%2Fv3.6)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=liske%2Fneedrestart)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[liske](/liske)
/
**[needrestart](/liske/needrestart)**
Public

* [Notifications](/login?return_to=%2Fliske%2Fneedrestart) You must be signed in to change notification settings
* [Fork
  74](/login?return_to=%2Fliske%2Fneedrestart)
* [Star
   450](/login?return_to=%2Fliske%2Fneedrestart)

* [Code](/liske/needrestart/tree/v3.6)
* [Issues
  45](/liske/needrestart/issues)
* [Pull requests
  3](/liske/needrestart/pulls)
* [Actions](/liske/needrestart/actions)
* [Security](/liske/needrestart/security)
* [Insights](/liske/needrestart/pulse)

Additional navigation options

* [Code](/liske/needrestart/tree/v3.6)
* [Issues](/liske/needrestart/issues)
* [Pull requests](/liske/needrestart/pulls)
* [Actions](/liske/needrestart/actions)
* [Security](/liske/needrestart/security)
* [Insights](/liske/needrestart/pulse)

1. [Releases](/liske/needrestart/releases)
2. [v3.6](/liske/needrestart/releases/tag/v3.6)

# v3.6

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/liske/needrestart/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v3.6)

 Loading

[View all tags](/liske/needrestart/tags)

![@liske](https://avatars.githubusercontent.com/u/372458?s=40&v=4)
[liske](/liske)
released this
17 May 15:04

Â·
[89 commits](/liske/needrestart/compare/v3.6...master)
to master
since this release

[v3.6](/liske/needrestart/tree/v3.6)

[`baf5e54`](/liske/needrestart/commit/baf5e5480f6dc30b7f4bcb7030677e63dbbfd0a9)

# Security

* [Interp] [CVE-2022-30688](https://nvd.nist.gov/vuln/detail/CVE-2022-30688): Anchor interpreter regex to prevent local privilege escalation.

  (responsibly reported by Jakub Wilk)

  [DSA 5137-1](https://lists.debian.org/debian-security-announce/2022/msg00105.html) | [USN-5426-1](https://ubuntu.com/security/notices/USN-5426-1)

# Features

* [Core] Add support for runit.

  (Debian Bug#972685 by Lorenzo Puliti plorenzo@disroot.org)
* [VM] Add support to detect outdated VM processes (i.e. qemu).

  (github pull request [#216](https://github.com/liske/needrestart/pull/216) by )Christian Ehrhardt [@cpaelzer](https://github.com/cpaelzer))

# Changes

* [Cont] Improve LXD container support.

  (github pull request [#188](https://github.com/liske/needrestart/pull/188) by James TD Smith [@ahktenzero](https://github.com/ahktenzero))
* [Cont] Update cgroup regex for LXC 4.0.

  (github pull request [#215](https://github.com/liske/needrestart/pull/215) by James TD Smith [@ahktenzero](https://github.com/ahktenzero))
* [Cont] Support cgroup v2 for docker.

  (github pull request [#234](https://github.com/liske/needrestart/pull/234) by Markus Frosch [@lazyfrosch](https://github.com/lazyfrosch))
* [Cont] Support cgroup v2 for LXC/LXD.

  (github pull request [#238](https://github.com/liske/needrestart/pull/238) by Trent Lloyd [@lathiat](https://github.com/lathiat))
* [Core] Support cgroup v2 for services and user sessions.
* [Core] Support systemd manager restart on Ubuntu 20.04+.

  (github pull request [#195](https://github.com/liske/needrestart/pull/195) by Lars Kollstedt [@LarsKollstedt](https://github.com/LarsKollstedt))
* [Core] Do not restart bluetooth.service by default.

  (github pull request [#209](https://github.com/liske/needrestart/pull/209) by Erik Tews [@eriktews](https://github.com/eriktews))
* [Core] Do not restart elogind by default.

  (github issue [#205](https://github.com/liske/needrestart/issues/205) by [@HumanG33k](https://github.com/HumanG33k))
* [Core] Output user sessions in batch mode.

  (github pull request [#232](https://github.com/liske/needrestart/pull/232) by [@anarcat](https://github.com/anarcat))
* [Core] Use ImVirt for virtualization detection if not running on systemd.

  (Debian Bug#984789 by Patrik Schindler poc@pocnet.net)
* [Interp] Add tolerance when checking script file ctimes to avoid false positives.

  (github pull request [#233](https://github.com/liske/needrestart/pull/233) by Corey Hickey [@bugfood](https://github.com/bugfood))
* [Kernel] Replace strings(1) by GNU grep to drop binutils dependency.

  (Debian Bug#986507 by Trent W. Buck trentbuck@gmail.com)

# Fixes

* [Core] Fix comment for default value of `skip_mapfiles`.

  (github pull request [#179](https://github.com/liske/needrestart/pull/179) by [@iasdeoupxe](https://github.com/iasdeoupxe))
* [Interp] Fix detection for ruby script started from relative paths.

  (github pull request [#182](https://github.com/liske/needrestart/pull/182) by Alexander Neumann @rtpt-alex)
* [Core] Fix typos.

  (github pull request [#189](https://github.com/liske/needrestart/pull/189) by [@wwuck](https://github.com/wwuck))

  (github pull request [#193](https://github.com/liske/needrestart/pull/193) by Stefan Weil [@stweil](https://github.com/stweil))
* [Core] Fix verbose/verbosity confusion in needrestart.conf.

  (github pull request [#197](https://github.com/liske/needrestart/pull/197) by Jan-Philipp Litza [@jplitza](https://github.com/jplitza))
* [Core] Ignore memfd files like used by nvidia's binary drivers.

  (github pull request [#200](https://github.com/liske/needrestart/pull/200) by Jan Visser [@starquake](https://github.com/starquake))
* [Core] Ignore all memfd mappings.

  (Debian Bug#972685 by Michail Bachmann m.bachmann@cms.hu-berlin.de)
* [Core] Ignore Java Native Access mappings.

  (github issue [#142](https://github.com/liske/needrestart/issues/142) by [@nirgal](https://github.com/nirgal))

  (github issue [#185](https://github.com/liske/needrestart/issues/185) by Ivan Zaera [@izaera](https://github.com/izaera))
* [Core] nagios: Do not print perfdata data in unkown state.

  (github pull request [#222](https://github.com/liske/needrestart/pull/222) by Lorenz [@RincewindsHat](https://github.com/RincewindsHat))
* [uCode] Fix 'uninitialized value' on AMD.

  (github pull request [#226](https://github.com/liske/needrestart/pull/226) by Christian Garbs [@mmitch](https://github.com/mmitch))

# Misc

* Minor cleanups (whitespaces, shellcheck, ...).

  (github pull request [#217](https://github.com/liske/needrestart/pull/217) by [@a1346054](https://github.com/a1346054))
* Update README.batch.md.

  (github pull request [#219](https://github.com/liske/needrestart/pull/219) by Stavros Ntentos [@stdedos](https://github.com/stdedos))
* Add icinga2 example config.

  (github pull request [#223](https://github.com/liske/needrestart/pull/223) by Lorenz [@RincewindsHat](https://github.com/RincewindsHat))
* [uCode] Fix lsinitrd example.

  (github pull request [#240](https://github.com/liske/needrestart/pull/240) by Corey Hickey [@bugfood](https://github.com/bugfood))

**Full Changelog**: [v3.5...v3.6](https://github.com/liske/needrestart/compare/v3.5...v3.6)

### Contributors

* [![@lazyfrosch](https://avatars.githubusercontent.com/u/121874?s=64&v=4)](https://github.com/lazyfrosch)
* [![@stdedos](https://avatars.githubusercontent.com/u/133706?s=64&v=4)](https://github.com/stdedos)
* [![@nirgal](https://avatars.githubusercontent.com/u/187012?s=64&v=4)](https://github.com/nirgal)
* [![@lathiat](https://avatars.githubusercontent.com/u/290673?s=64&v=4)](https://github.com/lathiat)
* [![@wwuck](https://avatars.githubusercontent.com/u/301402?s=64&v=4)](https://github.com/wwuck)
* [![@mmitch](https://avatars.githubusercontent.com/u/391942?s=64&v=4)](https://github.com/mmitch)
* [![@anarcat](https://avatars.githubusercontent.com/u/796623?s=64&v=4)](https://github.com/anarcat)
* [![@starquake](https://avatars.githubusercontent.com/u/1044544?s=64&v=4)](https://github.com/starquake)
* [![@eriktews](https://avatars.githubusercontent.com/u/1436802?s=64&v=4)](https://github.com/eriktews)
* [![@HumanG33k](https://avatars.githubusercontent.com/u/1794193?s=64&v=4)](https://github.com/HumanG33k)
* [![@bugfood](https://avatars.githubusercontent.com/u/2976480?s=64&v=4)](https://github.com/bugfood)
* [![@izaera](https://avatars.githubusercontent.com/u/3273630?s=64&v=4)](https://github.com/izaera)
* [![@jplitza](https://avatars.githubusercontent.com/u/3628012?s=64&v=4)](https://github.com/jplitza)
* [![@ahktenzero](https://avatars.githubusercontent.com/u/4405291?s=64&v=4)](https://github.com/ahktenzero)
* [![@stweil](https://avatars.githubusercontent.com/u/6734573?s=64&v=4)](https://github.com/stweil)
* [![@LarsKollstedt](https://avatars.githubusercontent.com/u/9744696?s=64&v=4)](https://github.com/LarsKollstedt)
* [![@RincewindsHat](https://avatars.githubusercontent.com/u/12514511?s=64&v=4)](https://github.com/RincewindsHat)
* [![@cpaelzer](https://avatars.githubusercontent.com/u/14993822?s=64&v=4)](https://github.com/cpaelzer)
* [![@a1346054](https://avatars.githubusercontent.com/u/36859588?s=64&v=4)](https://github.com/a1346054)
* [![@iasdeoupxe](https://avatars.githubusercontent.com/u/39667843?s=64&v=4)](https://github.com/iasdeoupxe)

lazyfrosch, stdedos, and 18 other contributors

 Assets
2

 Loading

All reactions

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canât perform that action at this time.



=== Content from lists.debian.org_0287ffa6_20250108_120453.html ===


---

[[Date Prev](msg00104.html)][[Date Next](msg00106.html)]
[[Thread Prev](msg00104.html)][[Thread Next](msg00106.html)]
[[Date Index](maillist.html#00105)]
[[Thread Index](threads.html#00105)]

# [SECURITY] [DSA 5137-1] needrestart security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 5137-1] needrestart security update
* *From*: Salvatore Bonaccorso <carnil@debian.org>
* *Date*: Tue, 17 May 2022 15:49:39 +0000
* *Message-id*: <[[ð]](/msgid-search/E1nqzS7-0001UW-Cn%40seger.debian.org)Â [E1nqzS7-0001UW-Cn@seger.debian.org](msg00105.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-5137-1                   security@debian.org
<https://www.debian.org/security/>                     Salvatore Bonaccorso
May 17, 2022                          <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : needrestart
CVE ID         : CVE-2022-30688

Jakub Wilk discovered a local privilege escalation in needrestart, a
utility to check which daemons need to be restarted after library
upgrades. Regular expressions to detect the Perl, Python, and Ruby
interpreters are not anchored, allowing a local user to escalate
privileges when needrestart tries to detect if interpreters are using
old source files.

For the oldstable distribution (buster), this problem has been fixed
in version 3.4-5+deb10u1.

For the stable distribution (bullseye), this problem has been fixed in
version 3.5-4+deb11u1.

We recommend that you upgrade your needrestart packages.

For the detailed security status of needrestart please refer to its
security tracker page at:
<https://security-tracker.debian.org/tracker/needrestart>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQKTBAEBCgB9FiEERkRAmAjBceBVMd3uBUy48xNDz0QFAmKDw1JfFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldDQ2
NDQ0MDk4MDhDMTcxRTA1NTMxRERFRTA1NENCOEYzMTM0M0NGNDQACgkQBUy48xND
z0RT8hAAoA3yInyXth3hYy2+Na/+bhNvNZ9nxHHS+Qch3TooRuraezIe42OQ9wVx
XDiQ5rlqW8uLLC78g5IK7sg0sAyZDFyEJK/kp66FHff0bO1u9+uzA/yuFdNccfo2
deHo4HpstwdHhFh2jYc10Nws7D2vOnRO9/NcHT7wSH1j1bWUnbGNPBgy53hhHtlO
rn7NIV4YcuYgq92tNIQ/DayYgZwQPqxEuqjAI8PNAtXxK5vGx3oB2unAnC7I3RcT
Yno8OPzHa9J5me8vHbxH0hCGuhwftySO+pKZ69X+WeGmnf7gcCwxGe8YXUc28XRo
/h2I/XMEHGyFlr7igr+hEPXkpwmFtww5kL+5M2HlYlNBe/ovV26qtctV6O5fANRv
EtURtJvNf4m1f+UE81QyFNfcagpcx4xl0LALuu1Y1m4ID2ymaFECR62iZ5IRxm90
y9D2EqIlOx4ehAcCkYJex3B/R8kuLoVkZ8Q6iatpEV9hcLTePJB1tD6isJLPPKrs
aUGx0E3zlp6jVgnv45/+unVdKPzoZduwTMHkQgY3hMlKl0L/NdFcO8Srxic+heja
llPa6ptku+Px24af8ZZMEonYkXshzzE7XhLzJA4+RV3Vynnrj8bOoypGRswUN5I0
OzWeHcwOmJCO8CQkEHcYqrJ61/gn9kH1D7zD9Opyv8E3M9ZYumw=
=Gz2y
-----END PGP SIGNATURE-----

```

---



=== Content from www.openwall.com_1e9d76e8_20250108_120454.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux Â  *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper Â  *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists Â  *for password cracking*](/wordlists/)+ [passwdqc Â  *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt Â  *KDF & password hashing*](/yescrypt/)+ [yespower Â  *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish Â  *password hashing*](/crypt/)+ [phpass Â  *ditto in PHP*](/phpass/)+ [tcb Â  *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd Â  *port scan detector*](/scanlogd/)+ [popa3d Â  *tiny POP3 daemon*](/popa3d/)+ [blists Â  *web interface to mailing lists*](/blists/)+ [msulogin Â  *single user mode login*](/msulogin/)+ [php\_mt\_seed Â  *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](8) [[next>]](../../../2022/05/18/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <e53ec98ef43fa137db9a626e5148ae1c00ea7c7e.camel@fiasko-nw.net>
Date: Tue, 17 May 2022 20:35:37 +0200
From: Thomas Liske <thomas@...sko-nw.net>
To: oss-security@...ts.openwall.com
Subject: CVE-2022-30688: needrestart 0.8+ local privilege escalation

# needrestart: local privilege escalation

<https://github.com/liske/needrestart>

## Description

A local privilege escalation has been found in needrestart. CVE-2022-
30688 has been assigned to this issue.

The interpreter heuristic contains unanchored regexs allowing local
users to execute arbitrary code in the context of the user running
needrestart. Needrestart might be run as root by package manager hooks
on package installations or upgrades.

## Affected

Affected: needrestart >= 0.8
Fixed in: needrestart >= 3.6

## Mitigation

Disabling the interpreter heuristic in neederstart's config prevents
this attack:

Â # Disable interpreter scanners.
Â $nrconf{interpscan} = 0;

## Credit

Reported by Jakub Wilk.

Regards,
Thomas Liske

View attachment "[anchor-interp-re.patch](9/1)" of type "text/x-patch" (1244 bytes)

Download attachment "[signature.asc](9/2)" of type "application/pgp-signature" (863 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from github.com_5c562807_20250108_152231.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-6qgc-vw4g-mxw4)

**CVE-2022-30688**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-6qgc-vw4g-mxw4)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [Unreviewed](/advisories?query=type%3Aunreviewed)
3. [CVE-2022-30688](/advisories/GHSA-6qgc-vw4g-mxw4)

## needrestart 0.8 through 3.5 before 3.6 is prone to local...

High severity

Unreviewed

Published
May 18, 2022
to the GitHub Advisory Database
â¢
Updated Jan 28, 2023

## Package

No package listedâ
[Suggest a package](/advisories/GHSA-6qgc-vw4g-mxw4/improve)

## Affected versions

Unknown

## Patched versions

Unknown

## Description

needrestart 0.8 through 3.5 before 3.6 is prone to local privilege escalation. Regexes to detect the Perl, Python, and Ruby interpreters are not anchored, allowing a local user to escalate privileges when needrestart tries to detect if interpreters are using old source files.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2022-30688>
* [liske/needrestart@e6e5813](https://github.com/liske/needrestart/commit/e6e58136e1e3c92296e2e810cb8372a5fe0dbd30)
* <https://github.com/liske/needrestart/releases/tag/v3.6>
* <https://lists.debian.org/debian-security-announce/2022/msg00105.html>
* <https://www.openwall.com/lists/oss-security/2022/05/17/9>
* <http://www.openwall.com/lists/oss-security/2022/05/17/9>
* <https://lists.debian.org/debian-lts-announce/2022/05/msg00024.html>
* <https://www.debian.org/security/2022/dsa-5137>

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2022-30688)
May 17, 2022

Published to the GitHub Advisory Database
May 18, 2022

Last updated
Jan 28, 2023

### Severity

High

7.8

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Local

Attack complexity
Low

Privileges required
Low

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

### [EPSS score](https://www.first.org/epss/user-guide)

0.042%
 (5th percentile)

### Weaknesses

[CWE-269](/advisories?query=cwe%3A269)

### CVE ID

CVE-2022-30688

### GHSA ID

GHSA-6qgc-vw4g-mxw4

### Source code

No known source code

Dependabot alerts are not supported on this advisory because it does not have a package from a supported ecosystem with an affected and fixed version.

[Learn more about GitHub language support](https://docs.github.com/get-started/learning-about-github/github-language-support#about-supported-languages)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-6qgc-vw4g-mxw4/improve).

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canât perform that action at this time.



=== Content from www.openwall.com_938cc922_20250108_120452.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux Â  *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper Â  *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists Â  *for password cracking*](/wordlists/)+ [passwdqc Â  *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt Â  *KDF & password hashing*](/yescrypt/)+ [yespower Â  *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish Â  *password hashing*](/crypt/)+ [phpass Â  *ditto in PHP*](/phpass/)+ [tcb Â  *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd Â  *port scan detector*](/scanlogd/)+ [popa3d Â  *tiny POP3 daemon*](/popa3d/)+ [blists Â  *web interface to mailing lists*](/blists/)+ [msulogin Â  *single user mode login*](/msulogin/)+ [php\_mt\_seed Â  *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](8) [[next>]](../../../2022/05/18/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <e53ec98ef43fa137db9a626e5148ae1c00ea7c7e.camel@fiasko-nw.net>
Date: Tue, 17 May 2022 20:35:37 +0200
From: Thomas Liske <thomas@...sko-nw.net>
To: oss-security@...ts.openwall.com
Subject: CVE-2022-30688: needrestart 0.8+ local privilege escalation

# needrestart: local privilege escalation

<https://github.com/liske/needrestart>

## Description

A local privilege escalation has been found in needrestart. CVE-2022-
30688 has been assigned to this issue.

The interpreter heuristic contains unanchored regexs allowing local
users to execute arbitrary code in the context of the user running
needrestart. Needrestart might be run as root by package manager hooks
on package installations or upgrades.

## Affected

Affected: needrestart >= 0.8
Fixed in: needrestart >= 3.6

## Mitigation

Disabling the interpreter heuristic in neederstart's config prevents
this attack:

Â # Disable interpreter scanners.
Â $nrconf{interpscan} = 0;

## Credit

Reported by Jakub Wilk.

Regards,
Thomas Liske

View attachment "[anchor-interp-re.patch](9/1)" of type "text/x-patch" (1244 bytes)

Download attachment "[signature.asc](9/2)" of type "application/pgp-signature" (863 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from lists.debian.org_79309587_20250108_120453.html ===


---

[[Date Prev](msg00023.html)][[Date Next](msg00025.html)]
[[Thread Prev](msg00023.html)][[Thread Next](msg00025.html)]
[[Date Index](maillist.html#00024)]
[[Thread Index](threads.html#00024)]

# [SECURITY] [DLA 3013-1] needrestart security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3013-1] needrestart security update
* *From*: Utkarsh Gupta <guptautkarsh2102@gmail.com>
* *Date*: Wed, 18 May 2022 06:17:12 +0530
* *Message-id*: <[[ð]](/msgid-search/CAPP0f97oQ0Mw4%2Bhc2SfEa%3D%3D%3DSG7SEu5aL2RA5qv_Tcnjh_f%3DUA%40mail.gmail.com)Â [CAPP0f97oQ0Mw4+hc2SfEa===SG7SEu5aL2RA5qv\_Tcnjh\_f=UA@mail.gmail.com](msg00024.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -----------------------------------------------------------------------
Debian LTS Advisory DLA-3013-1              debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                      Utkarsh Gupta
May 18, 2022                                <https://wiki.debian.org/LTS>
- -----------------------------------------------------------------------

Package        : needrestart
Version        : 2.11-3+deb9u2
CVE ID         : CVE-2022-30688
Debian Bug     : 1011154

Jakub Wilk discovered a local privilege escalation in needrestart, a
utility to check which daemons need to be restarted after library
upgrades. Regular expressions to detect the Perl, Python, and Ruby
interpreters are not anchored, allowing a local user to escalate
privileges when needrestart tries to detect if interpreters are using
old source files.

For Debian 9 stretch, this problem has been fixed in version
2.11-3+deb9u2.

We recommend that you upgrade your needrestart packages.

For the detailed security status of needrestart please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/needrestart>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEbJ0QSEqa5Mw4X3xxgj6WdgbDS5YFAmKEQesACgkQgj6WdgbD
S5b75BAAtO9RIWctdSGd/lRNDUwja8pcHQQypMPATn5jTYnAfXCHXH4CUu/gEvRB
vylYc2y0OhREi6LVn1nA2etA/MmD7puH1gmU2A/lx8cYMgKg+uE8AS3EW/e1VqMs
Uaeyz07jvmXt+BlC7oCQWvRNvLfMYozuKyJPWgHk6oCrHRgkxJ1FCijpB7MBuXHE
w++KyeqT96oOe5mvBZ0ONh3XPC140+pUdld2thlvbdWVHni7/nQ/CPL9dYiBhgwG
Mr/5LwF06Cz+0bkBmsKajWkNKu+kuiIrkVWf5yPY8L8Tfhj5d9Fi93wUbC/CqjPv
6PllyKXfcthjcNr/H3sMVK65q6WlDHSVQEp3f1XnYLenlU5XSb20517VtcO9zqyP
gnA55uGpa0fdjxo6W9Kx6C7LXyTK6fGyA7IEooehrdIT+cbowjlbZJXJ6dNECmFM
6RIQT7+cYtF0H/3xhlEEE7kQXIL535Cf2bQwTZDrnUtfrHa2EF7Ozsy/vG5e4GWM
MQAGcakZYQTkneEZ5r3faOncjAbJ5eIU83PHCvSIKmbI6uoNZ6orwibIvCY7kp9R
bVcZYEAg/3GpuMYb1XYmmK2FwUBX4nQ693RLozBBcbec9TjjpCzqEAT1vViUUr1s
3cGNrgUH7Stu2EmRy1e4Ty2Wr/kZOBhIacb7ff0WOlYcVNtdBEY=
=/crS
-----END PGP SIGNATURE-----

```

---



=== Content from www.debian.org_cc611c76_20250108_120454.html ===


---

[[Date Prev](msg00104.html)][[Date Next](msg00106.html)]
[[Thread Prev](msg00104.html)][[Thread Next](msg00106.html)]
[[Date Index](maillist.html#00105)]
[[Thread Index](threads.html#00105)]

# [SECURITY] [DSA 5137-1] needrestart security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 5137-1] needrestart security update
* *From*: Salvatore Bonaccorso <carnil@debian.org>
* *Date*: Tue, 17 May 2022 15:49:39 +0000
* *Message-id*: <[[ð]](/msgid-search/E1nqzS7-0001UW-Cn%40seger.debian.org)Â [E1nqzS7-0001UW-Cn@seger.debian.org](msg00105.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-5137-1                   security@debian.org
<https://www.debian.org/security/>                     Salvatore Bonaccorso
May 17, 2022                          <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : needrestart
CVE ID         : CVE-2022-30688

Jakub Wilk discovered a local privilege escalation in needrestart, a
utility to check which daemons need to be restarted after library
upgrades. Regular expressions to detect the Perl, Python, and Ruby
interpreters are not anchored, allowing a local user to escalate
privileges when needrestart tries to detect if interpreters are using
old source files.

For the oldstable distribution (buster), this problem has been fixed
in version 3.4-5+deb10u1.

For the stable distribution (bullseye), this problem has been fixed in
version 3.5-4+deb11u1.

We recommend that you upgrade your needrestart packages.

For the detailed security status of needrestart please refer to its
security tracker page at:
<https://security-tracker.debian.org/tracker/needrestart>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQKTBAEBCgB9FiEERkRAmAjBceBVMd3uBUy48xNDz0QFAmKDw1JfFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldDQ2
NDQ0MDk4MDhDMTcxRTA1NTMxRERFRTA1NENCOEYzMTM0M0NGNDQACgkQBUy48xND
z0RT8hAAoA3yInyXth3hYy2+Na/+bhNvNZ9nxHHS+Qch3TooRuraezIe42OQ9wVx
XDiQ5rlqW8uLLC78g5IK7sg0sAyZDFyEJK/kp66FHff0bO1u9+uzA/yuFdNccfo2
deHo4HpstwdHhFh2jYc10Nws7D2vOnRO9/NcHT7wSH1j1bWUnbGNPBgy53hhHtlO
rn7NIV4YcuYgq92tNIQ/DayYgZwQPqxEuqjAI8PNAtXxK5vGx3oB2unAnC7I3RcT
Yno8OPzHa9J5me8vHbxH0hCGuhwftySO+pKZ69X+WeGmnf7gcCwxGe8YXUc28XRo
/h2I/XMEHGyFlr7igr+hEPXkpwmFtww5kL+5M2HlYlNBe/ovV26qtctV6O5fANRv
EtURtJvNf4m1f+UE81QyFNfcagpcx4xl0LALuu1Y1m4ID2ymaFECR62iZ5IRxm90
y9D2EqIlOx4ehAcCkYJex3B/R8kuLoVkZ8Q6iatpEV9hcLTePJB1tD6isJLPPKrs
aUGx0E3zlp6jVgnv45/+unVdKPzoZduwTMHkQgY3hMlKl0L/NdFcO8Srxic+heja
llPa6ptku+Px24af8ZZMEonYkXshzzE7XhLzJA4+RV3Vynnrj8bOoypGRswUN5I0
OzWeHcwOmJCO8CQkEHcYqrJ61/gn9kH1D7zD9Opyv8E3M9ZYumw=
=Gz2y
-----END PGP SIGNATURE-----

```

---



=== Content from github.com_907c5c97_20250108_120453.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fliske%2Fneedrestart%2Fcommit%2Fe6e58136e1e3c92296e2e810cb8372a5fe0dbd30)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fliske%2Fneedrestart%2Fcommit%2Fe6e58136e1e3c92296e2e810cb8372a5fe0dbd30)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=liske%2Fneedrestart)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[liske](/liske)
/
**[needrestart](/liske/needrestart)**
Public

* [Notifications](/login?return_to=%2Fliske%2Fneedrestart) You must be signed in to change notification settings
* [Fork
  74](/login?return_to=%2Fliske%2Fneedrestart)
* [Star
   450](/login?return_to=%2Fliske%2Fneedrestart)

* [Code](/liske/needrestart)
* [Issues
  45](/liske/needrestart/issues)
* [Pull requests
  3](/liske/needrestart/pulls)
* [Actions](/liske/needrestart/actions)
* [Security](/liske/needrestart/security)
* [Insights](/liske/needrestart/pulse)

Additional navigation options

* [Code](/liske/needrestart)
* [Issues](/liske/needrestart/issues)
* [Pull requests](/liske/needrestart/pulls)
* [Actions](/liske/needrestart/actions)
* [Security](/liske/needrestart/security)
* [Insights](/liske/needrestart/pulse)

## Commit

[Permalink](/liske/needrestart/commit/e6e58136e1e3c92296e2e810cb8372a5fe0dbd30)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

[Interp] [CVE-2022-30688](https://github.com/advisories/GHSA-6qgc-vw4g-mxw4 "CVE-2022-30688"): Anchor interpreter regex to prevent local prâ¦

[Browse files](/liske/needrestart/tree/e6e58136e1e3c92296e2e810cb8372a5fe0dbd30)
Browse the repository at this point in the history

```
â¦ivilege escalation (reported by Jakub Wilk).
```

* Loading branch information

[![@liske](https://avatars.githubusercontent.com/u/372458?s=40&v=4)](/liske)

[liske](/liske/needrestart/commits?author=liske "View all commits by liske")
committed
May 17, 2022

1 parent
[f54d85c](/liske/needrestart/commit/f54d85cab33c450b2d4e17eaf359a5c7470ef91d)

commit e6e5813

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**3 additions**
and
**3 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* perl/lib/NeedRestart/Interp

  + perl/lib/NeedRestart/Interp/Perl.pm
    [Perl.pm](#diff-a2c231e99687ffe5fb481d604d0a000aadf8cb496580a2783fe970933430e98f)
  + perl/lib/NeedRestart/Interp/Python.pm
    [Python.pm](#diff-56dba8634ed33cbeb34cfff11395a88075cca1af93c17085b91c69e788949e39)
  + perl/lib/NeedRestart/Interp/Ruby.pm
    [Ruby.pm](#diff-47a7e942bcf18de634f06bdb18e5277c6de19f26a37be7af6c8c296b9268fdb7)

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[perl/lib/NeedRestart/Interp/Perl.pm](#diff-a2c231e99687ffe5fb481d604d0a000aadf8cb496580a2783fe970933430e98f "perl/lib/NeedRestart/Interp/Perl.pm")

Show comments

[View file](/liske/needrestart/blob/e6e58136e1e3c92296e2e810cb8372a5fe0dbd30/perl/lib/NeedRestart/Interp/Perl.pm)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -43,7 +43,7 @@ sub isa { |
|  |  | my $pid = shift; |
|  |  | my $bin = shift; |
|  |  |  |
|  |  | return 1 if($bin =~ m@/usr/(local/)?bin/perl@); |
|  |  | return 1 if($bin =~ m@^/usr/(local/)?bin/perl(5[.\d]\*)?$@); |
|  |  |  |
|  |  | return 0; |
|  |  | } |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[perl/lib/NeedRestart/Interp/Python.pm](#diff-56dba8634ed33cbeb34cfff11395a88075cca1af93c17085b91c69e788949e39 "perl/lib/NeedRestart/Interp/Python.pm")

Show comments

[View file](/liske/needrestart/blob/e6e58136e1e3c92296e2e810cb8372a5fe0dbd30/perl/lib/NeedRestart/Interp/Python.pm)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -42,7 +42,7 @@ sub isa { |
|  |  | my $pid = shift; |
|  |  | my $bin = shift; |
|  |  |  |
|  |  | return 1 if($bin =~ m@/usr/(local/)?bin/python@); |
|  |  | return 1 if($bin =~ m@^/usr/(local/)?bin/python([23][.\d]\*)?$@); |
|  |  |  |
|  |  | return 0; |
|  |  | } |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[perl/lib/NeedRestart/Interp/Ruby.pm](#diff-47a7e942bcf18de634f06bdb18e5277c6de19f26a37be7af6c8c296b9268fdb7 "perl/lib/NeedRestart/Interp/Ruby.pm")

Show comments

[View file](/liske/needrestart/blob/e6e58136e1e3c92296e2e810cb8372a5fe0dbd30/perl/lib/NeedRestart/Interp/Ruby.pm)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -42,7 +42,7 @@ sub isa { |
|  |  | my $pid = shift; |
|  |  | my $bin = shift; |
|  |  |  |
|  |  | return 1 if($bin =~ m@/usr/(local/)?bin/ruby@); |
|  |  | return 1 if($bin =~ m@^/usr/(local/)?bin/ruby$@); |
|  |  |  |
|  |  | return 0; |
|  |  | } |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `e6e5813`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fliske%2Fneedrestart%2Fcommit%2Fe6e58136e1e3c92296e2e810cb8372a5fe0dbd30) to comment.

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canât perform that action at this time.


