- **Root cause of vulnerability**: The plugin lacks authorization and CSRF checks when saving menu settings. It also does not validate, sanitize, or escape these settings.
- **Weaknesses/vulnerabilities present**: Stored Cross-Site Scripting (XSS).
- **Impact of exploitation**: An attacker can inject arbitrary JavaScript code into menu settings. This code will then be executed in the browsers of users who visit the front-end where the affected menu is displayed. This can lead to a variety of attacks, including session hijacking, defacement, or redirecting users to malicious sites.
- **Attack vectors**: A low-privileged authenticated user (e.g., a subscriber) can send a crafted POST request to the `admin-ajax.php` endpoint to modify the menu settings.
- **Required attacker capabilities/position**: The attacker needs to be an authenticated user of the WordPress site. The attacker needs to know a valid menu item id to enable the image functionality.