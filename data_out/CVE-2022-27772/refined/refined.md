- **Root cause of vulnerability:** A race condition exists in the `createTempDir` method of `AbstractConfigurableWebServerFactory`. The method creates a temporary file, deletes it, and then attempts to create a directory with the same name. An attacker can exploit the time gap between the file deletion and directory creation to create their own directory with the same name, leading to a directory hijacking.
- **Weaknesses/vulnerabilities present:**
  - Race condition during temporary directory creation (`CWE-377`).
  - Improper handling of return value of `mkdirs()` (lack of exception thrown, leading to silent failure) (`CWE-379`).
  - Vulnerable method `createTempDir` in `org.springframework.boot.web.server.AbstractConfigurableWebServerFactory`.
- **Impact of exploitation:** A local attacker can hijack the temporary directory used by the embedded web server. This allows the attacker to take control of the application, including writing and reading any files in that directory. This can lead to local privilege escalation.
- **Attack vectors:** A local attacker exploits a race condition when the `createTempDir` method is invoked.
- **Required attacker capabilities/position:**
    - The attacker needs write access to the system's shared temporary directory.
    - The attacker must be able to race the application during directory creation.
    - The attacker must be able to predict the path of the temporary directory.
    - The vulnerability impacts Unix-like systems, and very old versions of Mac OSX and Windows as they all share the system temporary directory between all users.