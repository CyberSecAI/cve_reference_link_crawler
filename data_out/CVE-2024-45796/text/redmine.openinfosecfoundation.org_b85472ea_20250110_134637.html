

⚲

### Project

### General

### Profile

* [Sign in](/login)
* [Register](/account/register)

* [Home](/)
* [Projects](/projects)
* [Help](https://www.redmine.org/guide)

[Search](/projects/suricata/search?scope=subprojects):

 Suricata[All Projects](/projects?jump=issues)
# Suricata

* [Overview](/projects/suricata)
* [Activity](/projects/suricata/activity)
* [Roadmap](/projects/suricata/roadmap)
* [Issues](/projects/suricata/issues)
* [Wiki](/projects/suricata/wiki)
* [Files](/projects/suricata/files)

### Custom queries

* [8.0.0 Stories](/projects/suricata/issues?query_id=90)
* [Good First Issues](/projects/suricata/issues?query_id=41)
* [OISF community](/projects/suricata/issues?query_id=3)

Actions
Copy link
## Security #7067

closed

### defrag: off by one leads to possible evasion

Added by [Philippe Antoine](/users/1820) [7 months](/projects/suricata/activity?from=2024-06-06 "06/06/2024 02:56 PM") ago.
Updated [3 months](/projects/suricata/activity?from=2024-10-16 "10/16/2024 07:51 AM") ago.

Status:ClosedPriority:NormalAssignee:[Philippe Antoine](/users/1820)Target version:[8.0.0-beta1](/versions/163 "04/01/2025")
Affected Versions:Label:CVE:[2024-45796](https://nvd.nist.gov/vuln/detail/CVE-2024-45796)Git IDs:Severity:HIGHDisclosure Date:09/04/2024

---

**Description**

Found by oss-fuzz
<https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=69475>

Regression on 26th of April cf <https://github.com/OISF/suricata/compare/ad4185b3c4fdcdfd0eac44a5ddf6bc7484c35bda...4fedba11404ea6548fd2ed319adf4b78a56180b4>

Victor, I leave you this new one, cc [@Jason Ish](/users/9)

---

**Files**

[Download all files](/attachments/issues/7067/download "Download all files")

| [lolc.pcap](/attachments/3020) (129 KB) [lolc.pcap](/attachments/download/3020/lolc.pcap "Download") |  | Philippe Antoine, 06/11/2024 08:15 AM |  |
| --- | --- | --- | --- |
| [lole.pcap](/attachments/3021) (300 Bytes) [lole.pcap](/attachments/download/3021/lole.pcap "Download") |  | Philippe Antoine, 06/11/2024 08:55 AM |  |

---

**Subtasks**
[1](/issues?parent_id=~7067&set_filter=true&status_id=%2A) (0 open — [1 closed](/issues?parent_id=~7067&set_filter=true&status_id=c))

|  | [Security #7215](/issues/7215): defrag: off by one leads to possible evasion (7.0.x backport) | Closed | [Philippe Antoine](/users/1820) |  |  |  | Actions |
| --- | --- | --- | --- | --- | --- | --- | --- |

* [History](/issues/7067?tab=history)
* [Notes](/issues/7067?tab=notes)
* [Property changes](/issues/7067?tab=properties)

ActionsCopy link
[#1](#note-1)
#### Updated by [Philippe Antoine](/users/1820) [7 months](/projects/suricata/activity?from=2024-06-06 "06/06/2024 03:08 PM") ago

Ouch `tracker->ip\_hdr\_offset` 4 is greater than `GET_PKT_LEN(r)` 0

ActionsCopy link
[#2](#note-2)
#### Updated by [Victor Julien](/users/4) [7 months](/projects/suricata/activity?from=2024-06-06 "06/06/2024 03:12 PM") ago

Do you have pcap?

ActionsCopy link
[#3](#note-3)
#### Updated by [Philippe Antoine](/users/1820) [7 months](/projects/suricata/activity?from=2024-06-06 "06/06/2024 03:16 PM") ago

* **File** *lol.pcap* added

The pcap does trigger only on fuzz\_decodepcapfile, not on suricata

ActionsCopy link
[#4](#note-4)
#### Updated by [Philippe Antoine](/users/1820) [7 months](/projects/suricata/activity?from=2024-06-11 "06/11/2024 08:18 AM") ago

* **File** [lolc.pcap](/attachments/3020) [lolc.pcap](/attachments/download/3020/lolc.pcap "Download") added

Here is a pcap reproducer

I had to do `mergecap -a -w lolc.pcap lolb.pcap lolb.pcap` because fuzzing runs the input twice (to check for leaks)

ActionsCopy link
[#5](#note-5)
#### Updated by [Philippe Antoine](/users/1820) [7 months](/projects/suricata/activity?from=2024-06-11 "06/11/2024 08:18 AM") ago

* **File** deleted (~~*lol.pcap*~~)

ActionsCopy link
[#6](#note-6)
#### Updated by [Philippe Antoine](/users/1820) [7 months](/projects/suricata/activity?from=2024-06-11 "06/11/2024 08:55 AM") ago

* **File** [lole.pcap](/attachments/3021) [lole.pcap](/attachments/download/3021/lole.pcap "Download") added

Minimized reproducer

ActionsCopy link
[#7](#note-7)
#### Updated by [Victor Julien](/users/4) [7 months](/projects/suricata/activity?from=2024-06-11 "06/11/2024 09:34 AM") ago

* **Status** changed from *New* to *Assigned*

ActionsCopy link
[#8](#note-8)
#### Updated by [Philippe Antoine](/users/1820) [6 months](/projects/suricata/activity?from=2024-07-15 "07/15/2024 08:11 AM") ago

* **Status** changed from *Assigned* to *In Review*

Gitlab MR

ActionsCopy link
[#9](#note-9)
#### Updated by [Philippe Antoine](/users/1820) [5 months](/projects/suricata/activity?from=2024-08-14 "08/14/2024 02:30 PM") ago

* **Label** *Needs backport to 7.0* added

ActionsCopy link
[#10](#note-10)
#### Updated by [OISF Ticketbot](/users/7712) [5 months](/projects/suricata/activity?from=2024-08-14 "08/14/2024 02:30 PM") ago

* **Subtask** *#7215* added

ActionsCopy link
[#11](#note-11)
#### Updated by [OISF Ticketbot](/users/7712) [5 months](/projects/suricata/activity?from=2024-08-14 "08/14/2024 02:30 PM") ago

* **Label** deleted (~~*Needs backport to 7.0*~~)

ActionsCopy link
[#12](#note-12)
#### Updated by [Philippe Antoine](/users/1820) [5 months](/projects/suricata/activity?from=2024-08-27 "08/27/2024 10:50 AM") ago

* **Tracker** changed from *Bug* to *Security*
* **Severity** set to *MODERATE*
* **Disclosure Date** set to *09/04/2024*

ActionsCopy link
[#13](#note-13)
#### Updated by [Victor Julien](/users/4) [4 months](/projects/suricata/activity?from=2024-09-02 "09/02/2024 12:30 PM") ago

* **Assignee** changed from *Victor Julien* to *Philippe Antoine*

ActionsCopy link
[#14](#note-14)
#### Updated by [Victor Julien](/users/4) [4 months](/projects/suricata/activity?from=2024-09-09 "09/09/2024 02:16 PM") ago

* **Severity** changed from *MODERATE* to *HIGH*

HIGH as it could potentially lead to loss of visibility, and thus policy bypass.

ActionsCopy link
[#15](#note-15)
#### Updated by [Victor Julien](/users/4) [4 months](/projects/suricata/activity?from=2024-09-12 "09/12/2024 07:24 AM") ago

* **Subject** changed from *defrag: DEBUG\_VALIDATE\_BUG\_ON(len > UINT16\_MAX);* to *defrag: off by one leads to possible evasion*

ActionsCopy link
[#16](#note-16)
#### Updated by [Juliana Fajardini Reichow](/users/6858) [4 months](/projects/suricata/activity?from=2024-09-16 "09/16/2024 05:28 PM") ago

* **CVE** set to *2024-45796*

<https://github.com/OISF/suricata/security/advisories/GHSA-mf6r-3xp2-v7xg>

ActionsCopy link
[#17](#note-17)
#### Updated by [Philippe Antoine](/users/1820) [3 months](/projects/suricata/activity?from=2024-10-01 "10/01/2024 09:13 AM") ago

* **Status** changed from *In Review* to *Closed*

<https://github.com/OISF/suricata/commit/9203656496c4081260817cce018a0d8fd57869b5>

ActionsCopy link
[#18](#note-18)
#### Updated by [Victor Julien](/users/4) [3 months](/projects/suricata/activity?from=2024-10-16 "10/16/2024 07:51 AM") ago

* **Private** changed from *Yes* to *No*

Actions
Copy link

Also available in: [Atom](/issues/7067.atom)
[PDF](/issues/7067.pdf)

Powered by [Redmine](https://www.redmine.org/) © 2006-2024 Jean-Philippe Lang

Loading...

