

search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#887409

## JasPer memory corruption vulnerabilities

#### Vulnerability Note VU#887409

Original Release Date: 2011-12-08 | Last Revised: 2012-06-14

---

### Overview

Some versions of JasPer contain multiple vulnerabilities that may allow a remote, unauthenticated attacker to execute arbitrary code.

### Description

| JasPer fails to properly decode marker segments and other sections in malformed JPEG2000 files. Malformed inputs can cause heap buffer overflows which in turn may result in execution of attacker-controlled code.  **CVE-2011-4516**: src/libjasper/jpc/jpc\_cs.c: jpc\_cox\_getcompparmsjpc\_cox\_getcomparms is called as part of the decoding of a coding style default (COD) marker segment. The function populates a parameter struct (jpc\_msparms\_t) that is contained in a marker segment struct (jpc\_ms\_t). jpc\_cox\_getcompparms contains a loop that copies data from the input file to the jpc\_msparms\_t struct. The loop terminates on a value (numrlvls) derived from the input file:for (i = 0; i < compparms->numrlvls; ++i) {  if (jpc\_getuint8(in, &tmp)) {    jpc\_cox\_destroycompparms(compparms);  return -1;  }  compparms->rlvls[i].parwidthval = tmp & 0xf;  compparms->rlvls[i].parheightval = (tmp >> 4) & 0xf;}numrlvls is read from the input file. The attacker can control numrlvls to overflow the jpc\_msparms\_t struct and copy attacker-controlled data from the input file into a struct of callback functions (jpc\_msops\_s) that appears in jpc\_ms\_t (src/libjasper/jpc/jpc\_cs.h) just after jpc\_msparms\_t:typedef struct {  /\* The type of marker segment. \*/  uint\_fast16\_t id;  /\* The length of the marker segment. \*/  uint\_fast16\_t len;  /\* The starting offset within the stream. \*/  uint\_fast32\_t off;  /\* The parameters of the marker segment. \*/  jpc\_msparms\_t parms;  /\* The marker segment operations. \*/  struct jpc\_msops\_s \*ops;} jpc\_ms\_t;Any subsequent failures in decoding the marker segment will result in the destroyparms member of the callback struct being invoked as part of cleanup. If the attacker has overwritten this callback via the loop above, attacker-controlled values can be loaded into the program counter.**CVE-2011-4517**: src/libjasper/jpc/jpc\_cs.c: jpc\_crg\_getparmsjpc\_crg\_getparms is called as part of the decoding of a component registration (CRG) marker segment. This function populates a heap buffer with data derived from the input file (in).The function contains an allocation size/type error. The heap buffer size is calculated using sizeof(uint\_fast16\_t) but the rest of the function assumes sizeof(jpc\_crgcomp\_t).jpc\_crgcomp\_t \*comp;...if (!(crg->comps = jas\_malloc(cstate->numcomps \* sizeof(uint\_fast16\_t)))) {  return -1;}...for (compno = 0, comp = crg->comps; compno < cstate->numcomps;++compno, ++comp) {  if (jpc\_getuint16(in, &comp->hoff) ||    jpc\_getuint16(in, &comp->voff)) {    jpc\_crg\_destroyparms(ms);    return -1;  }}The attacker can overwrite the bytes after crg->comp in memory with arbitrary data. This is a heap buffer overflow, which is generally considered exploitable.There are additional security implications here as well, however. The loop above is controlled by cstate->numcomps (cstate as one member: numcomps). cstate is allocated in a calling function, and is often allocated just before crg->comp. On some platforms the heap chunk allocated for cstate is located just after the heap chunk allocated for crg->comp, separated by only 4 bytes of heap accounting info. The accounting info + cstate (8 bytes after crg->comp) can be overwritten with bytes from the input file via the loop above. In these cases, the attacker can place a large number in cstate->numcomps to make the loop above iterate past the expected bound of crg->comps and copy an arbitrary number of bytes from the input file into heap (a heap buffer overflow). This enables the attacker to perform well-known heap exploitations, as well as allowing the attacker to overwrite other active heap allocations such as the callback pointers referenced in the previous bug description. |
| --- |

### Impact

| By tricking a user into opening or previewing an image file in an application that decodes images with the JasPer library, an attacker can execute arbitrary code or cause a denial-of-service crash. |
| --- |

### Solution

| **Apply an update**Users who obtain JasPer from a third-party vendor, such as their operating system vendor, should see the vendor information portion of this document for a partial list of affected vendors. |
| --- |

| Please consider the following workarounds:**Avoid processing malicious image files**Turn off image preview features in file browsers and other applications that use the JasPer library. Avoid opening image attachments from untrusted or unrecognized sources. |
| --- |

### Vendor Information

887409
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23887409/) to view vendors.**
### [Artifex Software, Inc.](#JFOE-8V9GPK) Affected

Updated:  June 14, 2012

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Debian GNU/Linux](#MAPG-8MTKYJ) Affected

Notified:  October 20, 2011  Updated: June 14, 2012

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Fedora Project](#MAPG-8MTKYZ) Affected

Notified:  October 20, 2011  Updated: December 08, 2011

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Gentoo Linux](#MAPG-8MTKZA) Affected

Notified:  October 20, 2011  Updated: June 14, 2012

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Oracle Corporation](#MAPG-8MTL2Y) Affected

Notified:  October 20, 2011  Updated: March 02, 2012

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### Vendor References

* <http://www.oracle.com/technetwork/topics/security/cpujan2012-366304.html>

### [Red Hat, Inc.](#MAPG-8MTL36) Affected

Notified:  October 20, 2011  Updated: December 08, 2011

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [SUSE Linux](#MAPG-8MTL3V) Affected

Notified:  October 20, 2011  Updated: December 08, 2011

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Ubuntu](#MAPG-8MTL43) Affected

Notified:  October 20, 2011  Updated: December 08, 2011

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Apple Inc.](#MAPG-8MTKY9) Not Affected

Notified:  October 20, 2011  Updated: December 08, 2011

**Statement Date:   October 22, 2011**

### Status

Not Affected

### Vendor Statement

The library in question is not used in any version of OS X or iOS.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Juniper Networks, Inc.](#MAPG-8MTL22) Not Affected

Notified:  October 20, 2011  Updated: December 08, 2011

**Statement Date:   December 02, 2011**

### Status

Not Affected

### Vendor Statement

Juniper Networks products are not susceptible to this vulnerability.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Openwall GNU/\*/Linux](#MAPG-8MTL2V) Not Affected

Notified:  October 20, 2011  Updated: December 08, 2011

**Statement Date:   December 05, 2011**

### Status

Not Affected

### Vendor Statement

Our products do not use JasPer.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Cray Inc.](#MAPG-8MTKYF) Unknown

Notified:  October 20, 2011  Updated: October 20, 2011

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [DragonFly BSD Project](#MAPG-8MTKYM) Unknown

Notified:  October 20, 2011  Updated: October 20, 2011

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [EMC Corporation](#MAPG-8MTKYQ) Unknown

Notified:  October 20, 2011  Updated: October 20, 2011

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Engarde Secure Linux](#MAPG-8MTKYT) Unknown

Notified:  October 20, 2011  Updated: October 20, 2011

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [F5 Networks, Inc.](#MAPG-8MTKYW) Unknown

Notified:  October 20, 2011  Updated: October 20, 2011

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [FreeBSD Project](#MAPG-8MTKZ4) Unknown

Notified:  October 20, 2011  Updated: October 20, 2011

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Fujitsu](#MAPG-8MTKZ7) Unknown

Notified:  October 20, 2011  Updated: October 20, 2011

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Google](#MAPG-8MTKZD) Unknown

Notified:  October 20, 2011  Updated: October 20, 2011

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Hewlett-Packard Company](#MAPG-8MTKZK) Unknown

Notified:  October 20, 2011  Updated: October 20, 2011

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Hitachi](#MAPG-8MTKZG) Unknown

Notified:  October 20, 2011  Updated: October 20, 2011

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [IBM Corporation](#MAPG-8MTKZN) Unknown

Notified:  October 20, 2011  Updated: October 20, 2011

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [IBM Corporation (zseries)](#MAPG-8MTKZR) Unknown

Notified:  October 20, 2011  Updated: October 20, 2011

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [IBM eServer](#MAPG-8MTKZU) Unknown

Notified:  October 20, 2011  Updated: October 20, 2011

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Infoblox](#MAPG-8MTKZX) Unknown

Notified:  October 20, 2011  Updated: October 20, 2011

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Mandriva S. A.](#MAPG-8MTL25) Unknown

Notified:  October 20, 2011  Updated: October 20, 2011

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Microsoft Corporation](#MAPG-8MTL28) Unknown

Notified:  October 20, 2011  Updated: October 20, 2011

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [MontaVista Software, Inc.](#MAPG-8MTL2B) Unknown

Notified:  October 20, 2011  Updated: October 20, 2011

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [NEC Corporation](#MAPG-8MTL2E) Unknown

Notified:  October 20, 2011  Updated: October 20, 2011

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [NetBSD](#MAPG-8MTL2H) Unknown

Notified:  October 20, 2011  Updated: October 20, 2011

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Nokia](#MAPG-8MTL2L) Unknown

Notified:  October 20, 2011  Updated: October 20, 2011

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Novell, Inc.](#MAPG-8MTL2P) Unknown

Notified:  October 20, 2011  Updated: October 20, 2011

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [OpenBSD](#MAPG-8MTL2S) Unknown

Notified:  October 20, 2011  Updated: October 20, 2011

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [QNX Software Systems Inc.](#MAPG-8MTL33) Unknown

Notified:  October 20, 2011  Updated: October 20, 2011

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [SafeNet](#MAPG-8MTL39) Unknown

Notified:  October 20, 2011  Updated: October 20, 2011

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Silicon Graphics, Inc.](#MAPG-8MTL3H) Unknown

Notified:  October 20, 2011  Updated: October 20, 2011

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Slackware Linux Inc.](#MAPG-8MTL3L) Unknown

Notified:  October 20, 2011  Updated: October 20, 2011

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Sony Corporation](#MAPG-8MTL3P) Unknown

Notified:  October 20, 2011  Updated: October 20, 2011

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Sun Microsystems, Inc.](#MAPG-8MTL3S) Unknown

Notified:  October 20, 2011  Updated: October 20, 2011

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [The SCO Group](#MAPG-8MTL3C) Unknown

Notified:  October 20, 2011  Updated: October 20, 2011

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Turbolinux](#MAPG-8MTL3Y) Unknown

Notified:  October 20, 2011  Updated: October 20, 2011

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Unisys](#MAPG-8MTL46) Unknown

Notified:  October 20, 2011  Updated: October 20, 2011

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Wind River Systems, Inc.](#MAPG-8MTL4A) Unknown

Notified:  October 20, 2011  Updated: October 20, 2011

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

View all 43 vendorsView less vendors

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base | 9 | AV:N/AC:M/Au:N/C:C/I:C/A:P |
| Temporal | 7 | E:POC/RL:OF/RC:C |
| Environmental | 7.1 | CDP:ND/TD:ND/CR:ND/IR:ND/AR:ND |

### References

* [http://www.ece.uvic.ca/~frodo/jasper/](http://www.ece.uvic.ca/~frodo/jasper/%20)
* [http://cwe.mitre.org/data/definitions/122.html](http://cwe.mitre.org/data/definitions/122.html%20)
* [http://cwe.mitre.org/data/definitions/843.html](http://cwe.mitre.org/data/definitions/843.html%20)
### Acknowledgements

These vulnerabilities were discovered by Jonathan Foote of the CERT/CC.

This document was written by Jonathan Foote.

### Other Information

| **CVE IDs:** | [CVE-2011-4516](http://web.nvd.nist.gov/vuln/detail/CVE-2011-4516), [CVE-2011-4517](http://web.nvd.nist.gov/vuln/detail/CVE-2011-4517) |
| --- | --- |
| **Severity Metric:** | 3.58 |
| **Date Public:** | 2011-12-08 |
| **Date First Published:** | 2011-12-08 |
| **Date Last Updated:** | 2012-06-14 12:35 UTC |
| **Document Revision:** | 41 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800

