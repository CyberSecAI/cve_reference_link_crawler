```
{
  "CVE-2011-4517": {
    "description": "The `jpc_crg_getparms` function in `src/libjasper/jpc/jpc_cs.c` within JasPer, when decoding a component registration (CRG) marker segment, has an allocation size/type error. The heap buffer size is calculated using `sizeof(uint_fast16_t)`, but the rest of the function assumes `sizeof(jpc_crgcomp_t)`. This allows attackers to cause a heap-based buffer overflow.",
    "vulnerability_details": {
      "root_cause": "Incorrect calculation of heap buffer size when decoding a component registration (CRG) marker segment in JPEG2000 files.",
      "weaknesses": [
        "Heap-based buffer overflow due to allocation size/type error"
      ],
      "impact": "Arbitrary code execution or denial-of-service crash.",
      "attack_vectors": [
        "Opening or previewing a malformed JPEG2000 image file.",
         "The vulnerability can be triggered by a remote, unauthenticated attacker by tricking a user into processing a malicious image file."
      ],
        "required_attacker_capabilities": [
        "Ability to craft a malicious JPEG2000 image file.",
        "Ability to convince a user to process the file."
      ],
        "attacker_position":"Remote, unauthenticated"
    },
   "affected_components":[
      "JasPer library",
      "Applications using the JasPer library such as image viewers"
    ],
    "additional_notes": "The vulnerability is present in `src/libjasper/jpc/jpc_cs.c` function `jpc_crg_getparms`. The function allocates a heap buffer based on `sizeof(uint_fast16_t)` but then assumes the buffer holds `jpc_crgcomp_t` which is larger, leading to a heap overflow.",
      "references": [
        "http://www.kb.cert.org/vuls/id/887409",
        "http://cve.mitre.org/data/definitions/122.html",
        "http://cve.mitre.org/data/definitions/843.html",
         "https://www.redhat.com/security/data/cve/CVE-2011-4517.html",
         "https://access.redhat.com/errata/RHSA-2015:0698",
        "https://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=747726",
         "https://www.ubuntu.com/usn/usn-1315-1/",
         "http://www.oracle.com/technetwork/topics/security/cpujan2012-366304.html",
         "https://lists.opensuse.org/archives/list/security-announce@lists.opensuse.org/thread/UG3H2KJFJFPOCVGNV2JGIIHOTHD4FGV7/#UG3H2KJFJFPOCVGNV2JGIIHOTHD4FGV7",
         "http://www.slackware.com/security/viewer.php?l=slackware-security&y=2015&m=slackware-security.141736"
         ]
  }
}
```