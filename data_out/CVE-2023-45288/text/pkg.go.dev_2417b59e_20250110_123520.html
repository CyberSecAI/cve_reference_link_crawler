

[![Go](/static/shared/logo/go-white.svg)](https://go.dev/)
 [Skip to Main Content](#main-content)

![](/static/shared/icon/search_gm_grey_24dp.svg)

![](/static/shared/icon/search_gm_grey_24dp.svg)

* Why Go
  ![submenu dropdown icon](/static/shared/icon/arrow_drop_down_gm_grey_24dp.svg)
  + [Case Studies](https://go.dev/solutions#case-studies)

    Common problems companies solve with Go
  + [Use Cases](https://go.dev/solutions#use-cases)

    Stories about how and why companies use Go
  + [Security Policy](https://go.dev/security/policy/)

    How Go can help keep you secure by default
* [Learn](https://go.dev/learn/)
* Docs
  ![submenu dropdown icon](/static/shared/icon/arrow_drop_down_gm_grey_24dp.svg)
  + [Effective Go](https://go.dev/doc/effective_go)

    Tips for writing clear, performant, and idiomatic Go code
  + [Go User Manual](https://go.dev/doc/)

    A complete introduction to building software with Go
  + [Standard library](https://pkg.go.dev/std)

    Reference documentation for Go's standard library
  + [Release Notes](https://go.dev/doc/devel/release)

    Learn what's new in each Go release
* [Packages](/)
* Community
  ![submenu dropdown icon](/static/shared/icon/arrow_drop_down_gm_grey_24dp.svg)
  + [Recorded Talks](https://go.dev/talks/)

    Videos from prior events
  + [Meetups
    *![](/static/shared/icon/launch_gm_grey_24dp.svg)*](https://www.meetup.com/pro/go)

    Meet other local Go developers
  + [Conferences
    *![](/static/shared/icon/launch_gm_grey_24dp.svg)*](https://github.com/golang/go/wiki/Conferences)

    Learn and network with Go developers from around the world
  + [Go blog](https://go.dev/blog)

    The Go project's official blog.
  + [Go project](https://go.dev/help)

    Get help and stay informed from Go
  + Get connected
    [![](/static/shared/logo/social/google-groups.svg)](https://groups.google.com/g/golang-nuts "Get connected with google-groups (Opens in new window)")
    [![](/static/shared/logo/social/github.svg)](https://github.com/golang "Get connected with github (Opens in new window)")
    [![](/static/shared/logo/social/twitter.svg)](https://twitter.com/golang "Get connected with twitter (Opens in new window)")
    [![](/static/shared/logo/social/reddit.svg)](https://www.reddit.com/r/golang/ "Get connected with reddit (Opens in new window)")
    [![](/static/shared/logo/social/slack.svg)](https://invite.slack.golangbridge.org/ "Get connected with slack (Opens in new window)")
    [![](/static/shared/logo/social/stack-overflow.svg)](https://stackoverflow.com/collectives/go)

[![Go.](/static/shared/logo/go-blue.svg)](https://go.dev/)

* Why Go
  *![](/static/shared/icon/navigate_next_gm_grey_24dp.svg)*
  *![](/static/shared/icon/navigate_before_gm_grey_24dp.svg)*
  Why Go
  + [Case Studies](https://go.dev/solutions#case-studies)
  + [Use Cases](https://go.dev/solutions#use-cases)
  + [Security Policy](https://go.dev/security/policy/)
* [Learn](https://go.dev/learn/)
* Docs
  *![](/static/shared/icon/navigate_next_gm_grey_24dp.svg)*
  *![](/static/shared/icon/navigate_before_gm_grey_24dp.svg)*
  Docs
  + [Effective Go](https://go.dev/doc/effective_go)
  + [Go User Manual](https://go.dev/doc/)
  + [Standard library](https://pkg.go.dev/std)
  + [Release Notes](https://go.dev/doc/devel/release)
* [Packages](/)
* Community
  *![](/static/shared/icon/navigate_next_gm_grey_24dp.svg)*
  *![](/static/shared/icon/navigate_before_gm_grey_24dp.svg)*
  Community
  + [Recorded Talks](https://go.dev/talks/)
  + [Meetups
    *![](/static/shared/icon/launch_gm_grey_24dp.svg)*](https://www.meetup.com/pro/go)
  + [Conferences
    *![](/static/shared/icon/launch_gm_grey_24dp.svg)*](https://github.com/golang/go/wiki/Conferences)
  + [Go blog](https://go.dev/blog)
  + [Go project](https://go.dev/help)
  + Get connected
    [![](/static/shared/logo/social/google-groups.svg)](https://groups.google.com/g/golang-nuts)
    [![](/static/shared/logo/social/github.svg)](https://github.com/golang)
    [![](/static/shared/logo/social/twitter.svg)](https://twitter.com/golang)
    [![](/static/shared/logo/social/reddit.svg)](https://www.reddit.com/r/golang/)
    [![](/static/shared/logo/social/slack.svg)](https://invite.slack.golangbridge.org/)
    [![](/static/shared/logo/social/stack-overflow.svg)](https://stackoverflow.com/collectives/go)

1. [Vulnerability Database](/vuln)
2. [All Reports](/vuln/list)
3. GO-2024-2687

# Vulnerability Report: GO-2024-2687

standard library

* CVE-2023-45288, GHSA-4v7x-pqxf-cx7m
* Affects:
  net/http, golang.org/x/net
* Published: Apr 03, 2024
* Modified: May 20, 2024

An attacker may cause an HTTP/2 endpoint to read arbitrary amounts of header data by sending an excessive number of CONTINUATION frames.
Maintaining HPACK state requires parsing and processing all HEADERS and CONTINUATION frames on a connection. When a request's headers exceed MaxHeaderBytes, no memory is allocated to store the excess headers, but they are still parsed.
This permits an attacker to cause an HTTP/2 endpoint to read arbitrary amounts of header data, all associated with a request which is going to be rejected. These headers can include Huffman-encoded data which is significantly more expensive for the receiver to decode than for an attacker to send.
The fix sets a limit on the amount of excess header frames we will process before closing a connection.

## Affected Packages

* Path
  Go Versions
  Symbols
* [net/http](/net/http)
  before go1.21.9, from go1.22.0-0 before go1.22.2
  71 affected symbols
  + [CanonicalHeaderKey](/net/http#CanonicalHeaderKey)
  + [Client.CloseIdleConnections](/net/http#Client.CloseIdleConnections)
  + [Client.Do](/net/http#Client.Do)
  + [Client.Get](/net/http#Client.Get)
  + [Client.Head](/net/http#Client.Head)
  + [Client.Post](/net/http#Client.Post)
  + [Client.PostForm](/net/http#Client.PostForm)
  + [Cookie.String](/net/http#Cookie.String)
  + [Cookie.Valid](/net/http#Cookie.Valid)
  + [Dir.Open](/net/http#Dir.Open)
  + [Error](/net/http#Error)
  + [Get](/net/http#Get)
  + [HandlerFunc.ServeHTTP](/net/http#HandlerFunc.ServeHTTP)
  + [Head](/net/http#Head)
  + [Header.Add](/net/http#Header.Add)
  + [Header.Del](/net/http#Header.Del)
  + [Header.Get](/net/http#Header.Get)
  + [Header.Set](/net/http#Header.Set)
  + [Header.Values](/net/http#Header.Values)
  + [Header.Write](/net/http#Header.Write)
  + [Header.WriteSubset](/net/http#Header.WriteSubset)
  + [ListenAndServe](/net/http#ListenAndServe)
  + [ListenAndServeTLS](/net/http#ListenAndServeTLS)
  + [NewRequest](/net/http#NewRequest)
  + [NewRequestWithContext](/net/http#NewRequestWithContext)
  + [NotFound](/net/http#NotFound)
  + [ParseTime](/net/http#ParseTime)
  + [Post](/net/http#Post)
  + [PostForm](/net/http#PostForm)
  + [ProxyFromEnvironment](/net/http#ProxyFromEnvironment)
  + [ReadRequest](/net/http#ReadRequest)
  + [ReadResponse](/net/http#ReadResponse)
  + [Redirect](/net/http#Redirect)
  + [Request.AddCookie](/net/http#Request.AddCookie)
  + [Request.BasicAuth](/net/http#Request.BasicAuth)
  + [Request.FormFile](/net/http#Request.FormFile)
  + [Request.FormValue](/net/http#Request.FormValue)
  + [Request.MultipartReader](/net/http#Request.MultipartReader)
  + [Request.ParseForm](/net/http#Request.ParseForm)
  + [Request.ParseMultipartForm](/net/http#Request.ParseMultipartForm)
  + [Request.PostFormValue](/net/http#Request.PostFormValue)
  + [Request.Referer](/net/http#Request.Referer)
  + [Request.SetBasicAuth](/net/http#Request.SetBasicAuth)
  + [Request.UserAgent](/net/http#Request.UserAgent)
  + [Request.Write](/net/http#Request.Write)
  + [Request.WriteProxy](/net/http#Request.WriteProxy)
  + [Response.Cookies](/net/http#Response.Cookies)
  + [Response.Location](/net/http#Response.Location)
  + [Response.Write](/net/http#Response.Write)
  + [ResponseController.EnableFullDuplex](/net/http#ResponseController.EnableFullDuplex)
  + [ResponseController.Flush](/net/http#ResponseController.Flush)
  + [ResponseController.Hijack](/net/http#ResponseController.Hijack)
  + [ResponseController.SetReadDeadline](/net/http#ResponseController.SetReadDeadline)
  + [ResponseController.SetWriteDeadline](/net/http#ResponseController.SetWriteDeadline)
  + [Serve](/net/http#Serve)
  + [ServeContent](/net/http#ServeContent)
  + [ServeFile](/net/http#ServeFile)
  + [ServeMux.ServeHTTP](/net/http#ServeMux.ServeHTTP)
  + [ServeTLS](/net/http#ServeTLS)
  + [Server.Close](/net/http#Server.Close)
  + [Server.ListenAndServe](/net/http#Server.ListenAndServe)
  + [Server.ListenAndServeTLS](/net/http#Server.ListenAndServeTLS)
  + [Server.Serve](/net/http#Server.Serve)
  + [Server.ServeTLS](/net/http#Server.ServeTLS)
  + [Server.SetKeepAlivesEnabled](/net/http#Server.SetKeepAlivesEnabled)
  + [Server.Shutdown](/net/http#Server.Shutdown)
  + [SetCookie](/net/http#SetCookie)
  + [Transport.CancelRequest](/net/http#Transport.CancelRequest)
  + [Transport.Clone](/net/http#Transport.Clone)
  + [Transport.CloseIdleConnections](/net/http#Transport.CloseIdleConnections)
  + [Transport.RoundTrip](/net/http#Transport.RoundTrip)
* [golang.org/x/net/http2](/golang.org/x/net/http2)
  before v0.23.0
  37 affected symbols
  + [ClientConn.Close](/golang.org/x/net/http2#ClientConn.Close)
  + [ClientConn.Ping](/golang.org/x/net/http2#ClientConn.Ping)
  + [ClientConn.RoundTrip](/golang.org/x/net/http2#ClientConn.RoundTrip)
  + [ClientConn.Shutdown](/golang.org/x/net/http2#ClientConn.Shutdown)
  + [ConfigureServer](/golang.org/x/net/http2#ConfigureServer)
  + [ConfigureTransport](/golang.org/x/net/http2#ConfigureTransport)
  + [ConfigureTransports](/golang.org/x/net/http2#ConfigureTransports)
  + [ConnectionError.Error](/golang.org/x/net/http2#ConnectionError.Error)
  + [ErrCode.String](/golang.org/x/net/http2#ErrCode.String)
  + [FrameHeader.String](/golang.org/x/net/http2#FrameHeader.String)
  + [FrameType.String](/golang.org/x/net/http2#FrameType.String)
  + [FrameWriteRequest.String](/golang.org/x/net/http2#FrameWriteRequest.String)
  + [Framer.ReadFrame](/golang.org/x/net/http2#Framer.ReadFrame)
  + [Framer.WriteContinuation](/golang.org/x/net/http2#Framer.WriteContinuation)
  + [Framer.WriteData](/golang.org/x/net/http2#Framer.WriteData)
  + [Framer.WriteDataPadded](/golang.org/x/net/http2#Framer.WriteDataPadded)
  + [Framer.WriteGoAway](/golang.org/x/net/http2#Framer.WriteGoAway)
  + [Framer.WriteHeaders](/golang.org/x/net/http2#Framer.WriteHeaders)
  + [Framer.WritePing](/golang.org/x/net/http2#Framer.WritePing)
  + [Framer.WritePriority](/golang.org/x/net/http2#Framer.WritePriority)
  + [Framer.WritePushPromise](/golang.org/x/net/http2#Framer.WritePushPromise)
  + [Framer.WriteRSTStream](/golang.org/x/net/http2#Framer.WriteRSTStream)
  + [Framer.WriteRawFrame](/golang.org/x/net/http2#Framer.WriteRawFrame)
  + [Framer.WriteSettings](/golang.org/x/net/http2#Framer.WriteSettings)
  + [Framer.WriteSettingsAck](/golang.org/x/net/http2#Framer.WriteSettingsAck)
  + [Framer.WriteWindowUpdate](/golang.org/x/net/http2#Framer.WriteWindowUpdate)
  + [GoAwayError.Error](/golang.org/x/net/http2#GoAwayError.Error)
  + [ReadFrameHeader](/golang.org/x/net/http2#ReadFrameHeader)
  + [Server.ServeConn](/golang.org/x/net/http2#Server.ServeConn)
  + [Setting.String](/golang.org/x/net/http2#Setting.String)
  + [SettingID.String](/golang.org/x/net/http2#SettingID.String)
  + [SettingsFrame.ForeachSetting](/golang.org/x/net/http2#SettingsFrame.ForeachSetting)
  + [StreamError.Error](/golang.org/x/net/http2#StreamError.Error)
  + [Transport.CloseIdleConnections](/golang.org/x/net/http2#Transport.CloseIdleConnections)
  + [Transport.NewClientConn](/golang.org/x/net/http2#Transport.NewClientConn)
  + [Transport.RoundTrip](/golang.org/x/net/http2#Transport.RoundTrip)
  + [Transport.RoundTripOpt](/golang.org/x/net/http2#Transport.RoundTripOpt)

## Aliases

* [CVE-2023-45288](https://www.cve.org/CVERecord?id=CVE-2023-45288)
* [GHSA-4v7x-pqxf-cx7m](https://github.com/advisories/GHSA-4v7x-pqxf-cx7m)

## References

* <https://go.dev/issue/65051>
* <https://go.dev/cl/576155>
* <https://groups.google.com/g/golang-announce/c/YgW0sx8mN3M>
* <https://vuln.go.dev/ID/GO-2024-2687.json>

## Credits

* Bartek Nowotarski (https://nowotarski.info/)

## Feedback

See anything missing or incorrect?
[Suggest an edit to this report.](https://github.com/golang/vulndb/issues/new?assignees=&labels=Needs+Triage%2CSuggested+Edit&template=suggest_edit.yaml&title=x%2Fvulndb%3A+suggestion+regarding+GO-2024-2687&report=GO-2024-2687)

[Why Go](https://go.dev/solutions)
[Use Cases](https://go.dev/solutions#use-cases)
[Case Studies](https://go.dev/solutions#case-studies)

[Get Started](https://learn.go.dev/)
[Playground](https://play.golang.org)
[Tour](https://tour.golang.org)
[Stack Overflow](https://stackoverflow.com/questions/tagged/go?tab=Newest)
[Help](https://go.dev/help)

[Packages](https://pkg.go.dev)
[Standard Library](/std)
[Sub-repositories](/golang.org/x)
[About Go Packages](https://pkg.go.dev/about)

[About](https://go.dev/project)
[Download](https://go.dev/dl/)
[Blog](https://go.dev/blog)
[Issue Tracker](https://github.com/golang/go/issues)
[Release Notes](https://go.dev/doc/devel/release.html)
[Brand Guidelines](https://blog.golang.org/go-brand)
[Code of Conduct](https://go.dev/conduct)

[Connect](https://www.twitter.com/golang)
[Twitter](https://www.twitter.com/golang)
[GitHub](https://github.com/golang)
[Slack](https://invite.slack.golangbridge.org/)
[r/golang](https://reddit.com/r/golang)
[Meetup](https://www.meetup.com/pro/go)
[Golang Weekly](https://golangweekly.com/)

![Gopher in flight goggles](/static/shared/gopher/pilot-bust-1431x901.svg)

* [Copyright](https://go.dev/copyright)
* [Terms of Service](https://go.dev/tos)
* [Privacy Policy](http://www.google.com/intl/en/policies/privacy/)
* [Report an Issue](https://go.dev/s/pkgsite-feedback)
* ![System theme](/static/shared/icon/brightness_6_gm_grey_24dp.svg)
  ![Dark theme](/static/shared/icon/brightness_2_gm_grey_24dp.svg)
  ![Light theme](/static/shared/icon/light_mode_gm_grey_24dp.svg)

  Theme Toggle
* ![](/static/shared/icon/keyboard_grey_24dp.svg)

  Shortcuts Modal

[![Google logo](/static/shared/logo/google-white.svg)](https://google.com)

## Jump to

![](/static/shared/icon/close_gm_grey_24dp.svg)

Close

## Keyboard shortcuts

![](/static/shared/icon/close_gm_grey_24dp.svg)

| **?** | : This menu |
| --- | --- |
| **/** | : Search site |
| **f** or **F** | : Jump to |
| **y** or **Y** | : Canonical URL |

Close

go.dev uses cookies from Google to deliver and enhance the quality of its services and to
analyze traffic. [Learn more.](https://policies.google.com/technologies/cookies)
Okay

