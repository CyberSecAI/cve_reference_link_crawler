=== Content from discuss.hashicorp.com_297a34ef_20250110_222607.html ===


[HashiCorp Discuss](/)

# [HCSEC-2023-25 - Consul JWT Auth in L7 Intentions Allow for Mismatched Service Identity and JWT Providers](/t/hcsec-2023-25-consul-jwt-auth-in-l7-intentions-allow-for-mismatched-service-identity-and-jwt-providers/57004)

[Security](/c/security/52)

[security-consul](https://discuss.hashicorp.com/tag/security-consul)

[eastebry](https://discuss.hashicorp.com/u/eastebry)

August 8, 2023, 9:02pm

1

**Bulletin ID:** HCSEC-2023-25

**Affected Products / Versions:** Consul and Consul Enterprise 1.16.0; fixed in 1.16.1.

**Publication Date:** August 8, 2023

**Summary**

A vulnerability was identified in Consul and Consul Enterprise (“Consul”) such that using JWT authentication for service mesh incorrectly allows/denies access regardless of service identities. This vulnerability, CVE-2023-3518, affects Consul 1.16.0 and was fixed in 1.16.1.

**Background**

Consul 1.16.0 introduced JWT authentication for service mesh which allows configuring JWT provider configuration entries to grant access to the endpoints within the mesh.

**Details**

Internal testing by the Consul engineering team identified that JWT authentication for service mesh incorrectly allows/denies access regardless of service identities (mTLS certificate).

This may allow two source intentions that would restrict access to an endpoint with differing JWT providers to cause only one JWT validation configuration to be used, allowing some service identities to be allowed with mismatching JWTs.

More requirements and recommendations for a secure Consul deployment can be found in the [security model](https://developer.hashicorp.com/consul/docs/security/security-models/core).

**Remediation**

Customers should evaluate the risk associated with this issue and consider upgrading to Consul 1.16.1 or newer.

See Consul’s [Upgrading](https://developer.hashicorp.com/consul/docs/upgrading) for general guidance on this process.

**Acknowledgement**

This issue was identified by the Consul engineering team.

*We deeply appreciate any effort to coordinate disclosure of security vulnerabilities. For information about security at HashiCorp and the reporting of security vulnerabilities, please see <https://hashicorp.com/security>.*

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [HCSEC-2022-20 - Consul Service Mesh Intention Bypass with Malicious Certificate Signing Request](https://discuss.hashicorp.com/t/hcsec-2022-20-consul-service-mesh-intention-bypass-with-malicious-certificate-signing-request/44628)  [Security](/c/security/52) [security-consul](https://discuss.hashicorp.com/tag/security-consul) | 0 | 7605 | September 21, 2022 |
| [HCSEC-2021-17 - Consul’s Envoy TLS Configuration Did Not Validate Destination Service Subject Alternative Names](https://discuss.hashicorp.com/t/hcsec-2021-17-consul-s-envoy-tls-configuration-did-not-validate-destination-service-subject-alternative-names/26856)  [Security](/c/security/52) [security-consul](https://discuss.hashicorp.com/tag/security-consul) | 0 | 7739 | July 15, 2021 |
| [HCSEC-2022-19 - Consul Auto-Config JWT Authorization Missing Input Validation](https://discuss.hashicorp.com/t/hcsec-2022-19-consul-auto-config-jwt-authorization-missing-input-validation/44627)  [Security](/c/security/52) [security-consul](https://discuss.hashicorp.com/tag/security-consul) | 0 | 7028 | September 21, 2022 |
| [HCSEC-2021-24 - Consul Missing Authorization Check on Txn.Apply Endpoint](https://discuss.hashicorp.com/t/hcsec-2021-24-consul-missing-authorization-check-on-txn-apply-endpoint/29026)  [Security](/c/security/52) [security-consul](https://discuss.hashicorp.com/tag/security-consul) | 0 | 7715 | September 1, 2021 |
| [HCSEC-2022-07 - Consul’s Connect Service Mesh Affected By Recent Envoy Security Releases](https://discuss.hashicorp.com/t/hcsec-2022-07-consul-s-connect-service-mesh-affected-by-recent-envoy-security-releases/36332)  [Security](/c/security/52) [security-consul](https://discuss.hashicorp.com/tag/security-consul) | 0 | 4784 | March 1, 2022 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](https://meta.discourse.org/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled


