
# [febiNJ](https://febin0x4e4a.wordpress.com/)

## InfoSec Enthusiast

Menu
[Skip to content](#content)

* [Home](https://febin0x4e4a.wordpress.com/)
* [About](https://febin0x4e4a.wordpress.com/about/)

Search

Search for:

# XSS vulnerability in Koha integrated library system

[11th January 202311th January 2023](https://febin0x4e4a.wordpress.com/2023/01/11/xss-vulnerability-in-koha-integrated-library-system/) / [FebiNJ](https://febin0x4e4a.wordpress.com/author/febin0x4e4a/)

This is Febin, a Security Researcher. This article is about a Cross-Site Scripting vulnerability I found in a popular library management system named Koha.

**Koha Library Software**:

![](https://febin0x4e4a.wordpress.com/wp-content/uploads/2023/01/koha.png?w=394)

Koha is an open-source integrated library system (ILS), used world-wide by public, school and special libraries.

Koha is a web-based ILS, with a SQL database (MariaDB or MySQL preferred) back end with cataloguing data stored in MARC and accessible via Z39.50 or SRU. The user interface is very configurable and adaptable and has been translated into many languages. Koha has most of the features that would be expected in an ILS, including:

```

Various Web 2.0 facilities like tagging, comment, social sharing and RSS feeds
Union catalog facility
Customizable search
Online circulation
Bar code printing
Patron card creation
Report generation
Patron self registration form through OPAC

```

Official Site: <https://koha-community.org/>

**The Vulnerability:**

A Cross-Site Scripting (XSS) vulnerability has been found in Koha Library software that can be used by an external attacker to steal credentials, deliver malware and take over admin account for further exploitation.

The vulnerability exists in the “HTML customizations” and “News” features under “Additional tools”(/cgi-bin/koha/tools/additional-contents.pl).

![](https://febin0x4e4a.wordpress.com/wp-content/uploads/2023/01/koha_html.png?w=1024)

An attacker can craft a URL and send it to the victim, if the victim is authenticated, then the javascript will get executed and if he’s not authenticated then Koha will prompt its login, after successful sign-in, the XSS payload will get executed. And the payload will be stored under the “HTML customizations” section i.e, whenever the victim visits that section, the XSS payload will be triggered thus making this a persistent XSS

## Proof Of Concept:

There are many demo instances of Koha software that are hosted online and are officially listed on Koha’s official website.

I have used a couple of demo Koha instances to test and prove the vulnerability.

Demo 1: intranet-demo.biblibre.com

Demo Credentials: test/test

<https://intranet-demo.biblibre.com/cgi-bin/koha/tools/additional-contents.pl?op=add_validate&category=html_customizations&code=&idnew=38&redirect=&editmode=wysiwyg&location=&&title_default=test&content_default=%3Cimg+src=X+onerror=alert(%27FEBIN%27)%3E&lang=default>

![](https://febin0x4e4a.wordpress.com/wp-content/uploads/2023/01/koha_xss1-1.png?w=1024)

Demo 1: demo-admin.catalyst-koha.com.au

Demo Credentials: staff/staff1

<https://demo-admin.catalyst-koha.com.au//cgi-bin/koha/tools/additional-contents.pl?op=add_validate&category=html_customizations&code=&idnew=38&redirect=/&editmode=wysiwyg&location=&&title_default=test&content_default=%3Cimg+src=X+onerror=alert(%27FEBIN%27)%3E&lang=default>

![](https://febin0x4e4a.wordpress.com/wp-content/uploads/2023/01/koha_xss2.png?w=1024)

**Fix:** Disable Javascript in HTML customizations, Sanitize user input, Use anti-CSRF token

<https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html>

**Thanks.**

### Share this:

* [Twitter](https://febin0x4e4a.wordpress.com/2023/01/11/xss-vulnerability-in-koha-integrated-library-system/?share=twitter "Click to share on Twitter")
* [Facebook](https://febin0x4e4a.wordpress.com/2023/01/11/xss-vulnerability-in-koha-integrated-library-system/?share=facebook "Click to share on Facebook")
Like Loading...
### *Related*

[Uncategorized](https://febin0x4e4a.wordpress.com/category/uncategorised/)

# Post navigation

[← CVE-2021-40662 Chamilo LMS 1.11.14 RCE](https://febin0x4e4a.wordpress.com/2022/03/22/cve-2021-40662-chamilo-lms-1-11-14-rce/)[Stored XSS in FileBrowser leads to Admin account Takeover + RCE →](https://febin0x4e4a.wordpress.com/2023/09/15/xss-in-filebrowser-leads-to-admin-account-takeover-in-filebrowser/)

### Leave a comment [Cancel reply](/2023/01/11/xss-vulnerability-in-koha-integrated-library-system/#respond)

Δ

Search for:

# Recent Posts

* [Privilege Escalation Vulnerability in Balena Etcher Software](https://febin0x4e4a.wordpress.com/2024/08/22/privilege-escalation-vulnerability-in-balena-etcher-software/)
* [CVE-2024-28739, CVE-2024-28740: XSS to One-Click RCE in Koha ILS](https://febin0x4e4a.wordpress.com/2024/03/07/xss-to-one-click-rce-in-koha-ils/)
* [CVE-2023-44452, CVE-2023-51698: CBT File Parsing Argument Injection that affected Popular Linux Distros](https://febin0x4e4a.wordpress.com/2024/01/17/cve-2023-44452-cve-2023-51698-cbt-file-parsing-argument-injection-that-affected-popular-linux-distros/)
* [CVE-2023-44451, CVE-2023-52076: EPUB File Parsing Directory Traversal RCE Vulnerability affecting popular distros](https://febin0x4e4a.wordpress.com/2024/01/17/cve-2023-44451-cve-2023-52076-epub-file-parsing-directory-traversal-rce-vulnerability-affecting-popular-distros/)
* [Zip Path Traversal in Asus Smartphone’s default FileManager App.](https://febin0x4e4a.wordpress.com/2024/01/10/zip-path-traversal-in-asus-smartphones-default-filemanager-app/)
# Recent Comments

# Archives

* [August 2024](https://febin0x4e4a.wordpress.com/2024/08/)
* [March 2024](https://febin0x4e4a.wordpress.com/2024/03/)
* [January 2024](https://febin0x4e4a.wordpress.com/2024/01/)
* [December 2023](https://febin0x4e4a.wordpress.com/2023/12/)
* [October 2023](https://febin0x4e4a.wordpress.com/2023/10/)
* [September 2023](https://febin0x4e4a.wordpress.com/2023/09/)
* [January 2023](https://febin0x4e4a.wordpress.com/2023/01/)
* [March 2022](https://febin0x4e4a.wordpress.com/2022/03/)
* [January 2022](https://febin0x4e4a.wordpress.com/2022/01/)
# Categories

* [Uncategorized](https://febin0x4e4a.wordpress.com/category/uncategorised/)

[Blog at WordPress.com.](https://wordpress.com/?ref=footer_blog)

* [Comment](https://febin0x4e4a.wordpress.com/2023/01/11/xss-vulnerability-in-koha-integrated-library-system/#respond)
* Reblog
* Subscribe
  Subscribed

  + [![](https://febin0x4e4a.wordpress.com/wp-content/uploads/2022/01/cropped-hacker-operate-laptop-cartoon-illustration_188898-166.jpg?w=50) febiNJ](https://febin0x4e4a.wordpress.com)

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Ffebin0x4e4a.wordpress.com%2F2023%2F01%2F11%2Fxss-vulnerability-in-koha-integrated-library-system%2F&signup_flow=account)
* Privacy
* + [![](https://febin0x4e4a.wordpress.com/wp-content/uploads/2022/01/cropped-hacker-operate-laptop-cartoon-illustration_188898-166.jpg?w=50) febiNJ](https://febin0x4e4a.wordpress.com)
  + [Customize](https://febin0x4e4a.wordpress.com/wp-admin/customize.php?url=https%3A%2F%2Ffebin0x4e4a.wordpress.com%2F2023%2F01%2F11%2Fxss-vulnerability-in-koha-integrated-library-system%2F)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Ffebin0x4e4a.wordpress.com%2F2023%2F01%2F11%2Fxss-vulnerability-in-koha-integrated-library-system%2F&signup_flow=account)
  + [Copy shortlink](https://wp.me/pdF9Nn-1c)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://febin0x4e4a.wordpress.com/2023/01/11/xss-vulnerability-in-koha-integrated-library-system/)
  + [View post in Reader](https://wordpress.com/read/blogs/201901473/posts/74)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

##

##

Loading Comments...

Write a Comment...

Email (Required)

Name (Required)

Website

###

%d

![](https://pixel.wp.com/b.gif?v=noscript)
Design a site like this with WordPress.com[Get started](https://wordpress.com/start/?ref=marketing_bar)

