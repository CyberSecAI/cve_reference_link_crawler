

| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=5e90258303a358e88737afb5048bee9113beea3a)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=5e90258303a358e88737afb5048bee9113beea3a)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=5e90258303a358e88737afb5048bee9113beea3a)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=5e90258303a358e88737afb5048bee9113beea3a)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Florian Westphal <fw@strlen.de> | 2024-06-14 12:17:33 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-06-27 13:52:21 +0200 |
| commit | [5e90258303a358e88737afb5048bee9113beea3a](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=5e90258303a358e88737afb5048bee9113beea3a) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=5e90258303a358e88737afb5048bee9113beea3a)) | |
| tree | [c23fa86fcf6efcb96c646a05773a2ea0f661e4dd](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=5e90258303a358e88737afb5048bee9113beea3a) | |
| parent | [7e30eb0de8164445b31622649a6e993f96ea793c](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=7e30eb0de8164445b31622649a6e993f96ea793c) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=5e90258303a358e88737afb5048bee9113beea3a&id2=7e30eb0de8164445b31622649a6e993f96ea793c)) | |
| download | [linux-5e90258303a358e88737afb5048bee9113beea3a.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-5e90258303a358e88737afb5048bee9113beea3a.tar.gz) | |

bpf: Avoid splat in pskb\_pull\_reason[ Upstream commit 2bbe3e5a2f4ef69d13be54f1cf895b4658287080 ]
syzkaller builds (CONFIG\_DEBUG\_NET=y) frequently trigger a debug
hint in pskb\_may\_pull.
We'd like to retain this debug check because it might hint at integer
overflows and other issues (kernel code should pull headers, not huge
value).
In bpf case, this splat isn't interesting at all: such (nonsensical)
bpf programs are typically generated by a fuzzer anyway.
Do what Eric suggested and suppress such warning.
For CONFIG\_DEBUG\_NET=n we don't need the extra check because
pskb\_may\_pull will do the right thing: return an error without the
WARN() backtrace.
Fixes: 219eee9c0d16 ("net: skbuff: add overflow debug check to pull/push helpers")
Reported-by: syzbot+0c4150bff9fff3bf023c@syzkaller.appspotmail.com
Suggested-by: Eric Dumazet <edumazet@google.com>
Signed-off-by: Florian Westphal <fw@strlen.de>
Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>
Reviewed-by: Eric Dumazet <edumazet@google.com>
Acked-by: Daniel Borkmann <daniel@iogearbox.net>
Closes: https://syzkaller.appspot.com/bug?extid=0c4150bff9fff3bf023c
Link: [https://lore.kernel.org/netdev/9f254c96-54f2-4457-b7ab-1d9f6187939c@gmail.com/](https://lore.kernel.org/netdev/9f254c96-54f2-4457-b7ab-1d9f6187939c%40gmail.com/)
Link: [https://lore.kernel.org/bpf/20240614101801.9496-1-fw@strlen.de](https://lore.kernel.org/bpf/20240614101801.9496-1-fw%40strlen.de)
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=5e90258303a358e88737afb5048bee9113beea3a)

| -rw-r--r-- | [net/core/filter.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/core/filter.c?id=5e90258303a358e88737afb5048bee9113beea3a) | 5 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 0 deletions

| diff --git a/net/core/filter.c b/net/core/filter.cindex a5856a8b4498b8..ce255e0a2fbd94 100644--- a/[net/core/filter.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/core/filter.c?id=7e30eb0de8164445b31622649a6e993f96ea793c)+++ b/[net/core/filter.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/core/filter.c?id=5e90258303a358e88737afb5048bee9113beea3a)@@ -1662,6 +1662,11 @@ static DEFINE\_PER\_CPU(struct bpf\_scratchpad, bpf\_sp); static inline int \_\_bpf\_try\_make\_writable(struct sk\_buff \*skb, unsigned int write\_len) {+#ifdef CONFIG\_DEBUG\_NET+ /\* Avoid a splat in pskb\_may\_pull\_reason() \*/+ if (write\_len > INT\_MAX)+ return -EINVAL;+#endif return skb\_ensure\_writable(skb, write\_len); } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 06:45:53 +0000

