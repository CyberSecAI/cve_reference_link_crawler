

![](/static/v20250108.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1842658)
* [XML](/show_bug.cgi?ctype=xml&id=1842658)

Closed
[Bug 1842658](/show_bug.cgi?id=1842658)
(CVE-2023-4049)

Opened 2 years ago
Closed 1 years ago

# Clean up some manual AddRef/Release implementations

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Clean up some manual AddRef/Release implementations

## Categories

### (Core :: XPCOM, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=XPCOM#XPCOM)

XPCOM
▾

Core :: XPCOM
This is the basis of our component technology; this covers the mozilla/xpcom source directory and includes the "repository". Unlikely a tester would be able to tell there was an XPCOM problem specifically.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=XPCOM&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=XPCOM&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=XPCOM)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

117 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| a11y-review | --- |
| Accessibility Severity | --- |
| Webcompat Score | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr102 | [116+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=116%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed) |
| firefox-esr115 | [116+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=116%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed) |
| firefox115 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=wontfix) |
| firefox116 | [+](/buglist.cgi?f1=cf_tracking_firefox116&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=fixed) |
| firefox117 | [+](/buglist.cgi?f1=cf_tracking_firefox117&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr102 | 116+ | fixed |
| firefox-esr115 | 116+ | fixed |
| firefox-esr128 | --- | --- |
| firefox115 |  | wontfix |
| firefox116 | + | fixed |
| firefox117 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: nika, Assigned: nika)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/fcf93a5a624020bf2256443c69e08b51?d=mm&size=40)  [nika](/user_profile?user_id=534482)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/fcf93a5a624020bf2256443c69e08b51?d=mm&size=40)  [nika](/user_profile?user_id=534482)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/fcf93a5a624020bf2256443c69e08b51?d=mm&size=40)  [nika](/user_profile?user_id=534482)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

12 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-race, sec-high, Whiteboard: [adv-main116+] [adv-ESR115.1+] [adv-ESR102.14+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2023-4049

[Keywords:](/describekeywords.cgi)

[csectype-race](/buglist.cgi?keywords=csectype-race&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main116+] [adv-ESR115.1+] [adv-ESR102.14+]

QA Whiteboard:

[post-critsmash-triage]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files)

| [Bug 1842658 - Part 1: Use a refcounting macro for imgCacheEntry, r=emilio!](/attachment.cgi?id=9343146)  [2 years ago](#c1)  [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482)   48 bytes, text/x-phabricator-request | diannaS : [approval-mozilla-beta+](#c11 "1 years ago")  tjr : [sec-approval+](#c7 "2 years ago") | [Details](/attachment.cgi?id=9343146&action=edit) | [Review](/attachment.cgi?id=9343146) |
| --- | --- | --- |
| [Bug 1842658 - Part 2: Use refcounting macros for nsHtml5OwningUTF16Buffer, r=mccr8!](/attachment.cgi?id=9343147)  [2 years ago](#c2)  [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482)   48 bytes, text/x-phabricator-request | diannaS : [approval-mozilla-beta+](#a502455_690067 "1 years ago")  diannaS : [approval-mozilla-esr102+](#c15 "1 years ago")  diannaS : [approval-mozilla-esr115+](#c13 "1 years ago")  tjr : [sec-approval+](#c6 "2 years ago") | [Details](/attachment.cgi?id=9343147&action=edit) | [Review](/attachment.cgi?id=9343147) |
| [advisory.txt](/attachment.cgi?id=9346065)  [1 years ago](#c17)  [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733)   252 bytes, text/plain |  | [Details](/attachment.cgi?id=9346065&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482)  Assignee |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1842658#c0)• 2 years ago |
|  | |

While reading over the refcnt implementations in <https://phabricator.services.mozilla.com/D182992>, I noticed some of the implementations were manual and in some cases a bit sketchy when they didn't need to be.

This patch is to track cleaning them up, and potentially fixing race issues in atomic refcounts which were not being handled correctly.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1842658#a115_406194)• 2 years ago |

Group: core-security → dom-core-securityKeywords: [csectype-race](/buglist.cgi?keywords=csectype-race&resolution=---)

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1842658#c1)• 2 years ago |
|  | |

Attached file
[Bug 1842658 - Part 1: Use a refcounting macro for imgCacheEntry, r=emilio!](attachment.cgi?id=9343146)
— [Details](attachment.cgi?id=9343146&action=edit)

It appears that when this was originally added in [bug 430061](/show_bug.cgi?id=430061 "RESOLVED FIXED - Replace imglib's use of necko memory cache with an imglib-specific cache"), the inline

refcounting macros didn't exist yet.

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1842658#c2)• 2 years ago |
|  | |

Attached file
[Bug 1842658 - Part 2: Use refcounting macros for nsHtml5OwningUTF16Buffer, r=mccr8!](attachment.cgi?id=9343147)
— [Details](attachment.cgi?id=9343147&action=edit)

When the code was originally added in [bug 1842658](/show_bug.cgi?id=1842658 "RESOLVED FIXED - Clean up some manual AddRef/Release implementations"), it was to use non-atomic

refcounting across multiple threads due to some invariants preventing

concurrent access. That was changed in [bug 1607762](/show_bug.cgi?id=1607762 "RESOLVED FIXED - ThreadSanitizer: data race [@ operator--] vs. [@ operator--] through [@ nsHtml5OwningUTF16Buffer::Release]") to fix a race issue.

We should be able to switch to using the macros now, which will simplify the

code here a bit.

Depends on D183203

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1842658#c3)• 2 years ago |
|  | |

Nika pointed out that this can lead to double frees (which could lead to UAFs), if the refcount is at 2, then 2 threads decrement, then they both read the refcount as zero, so I'm going to mark this sec-high. I don't know how easily exploitable that is for these particular classes. These don't look directly exposed to web content, but they can certainly be created and destroyed by it.

Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1842658#c4)• 2 years ago |
|  | |

Specifically the sec-high part is only part 2, part 1 should have no changes due to it never being a threadsafe refcnt.

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1842658#c5)• 2 years ago |
|  | |

Comment on [attachment 9343147](/attachment.cgi?id=9343147 "Bug 1842658 - Part 2: Use refcounting macros for nsHtml5OwningUTF16Buffer, r=mccr8!") [[details]](/attachment.cgi?id=9343147&action=edit "Bug 1842658 - Part 2: Use refcounting macros for nsHtml5OwningUTF16Buffer, r=mccr8!")

[Bug 1842658](/show_bug.cgi?id=1842658 "RESOLVED FIXED - Clean up some manual AddRef/Release implementations") - Part 2: Use refcounting macros for nsHtml5OwningUTF16Buffer, r=mccr8!

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: It would be quite difficult to. The issue is due to multiple atomic loads during a `Release` function of a platform object.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which older supported branches are affected by this flaw?**: All
* **If not all supported branches, which bug introduced the flaw?**: [Bug 1607762](/show_bug.cgi?id=1607762 "RESOLVED FIXED - ThreadSanitizer: data race [@ operator--] vs. [@ operator--] through [@ nsHtml5OwningUTF16Buffer::Release]")
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**: I expect that the patch will apply cleanly on all impacted branches.
* **How likely is this patch to cause regressions; how much testing does it need?**: Unlikely to cause regressions
* **Is Android affected?**: Yes
[Attachment #9343147](/attachment.cgi?id=9343147&action=edit "Bug 1842658 - Part 2: Use refcounting macros for nsHtml5OwningUTF16Buffer, r=mccr8!") -
Flags: sec-approval?

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1842658#a78182_534482)• 2 years ago |

[Attachment #9343146](/attachment.cgi?id=9343146&action=edit "Bug 1842658 - Part 1: Use a refcounting macro for imgCacheEntry, r=emilio!") -
Flags: sec-approval?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1842658#a111610_75935)• 2 years ago |

[status-firefox115](/buglist.cgi?f1=cf_status_firefox115&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=wontfix)
[status-firefox116](/buglist.cgi?f1=cf_status_firefox116&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=affected)
[status-firefox117](/buglist.cgi?f1=cf_status_firefox117&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=affected)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected)
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected)
[tracking-firefox116](/buglist.cgi?f1=cf_tracking_firefox116&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox116&o1=equals&v1=%2B)
[tracking-firefox117](/buglist.cgi?f1=cf_tracking_firefox117&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox117&o1=equals&v1=%2B)
[tracking-firefox-esr102](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=isnotempty):
--- → [116+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=116%2B)
[tracking-firefox-esr115](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=isnotempty):
--- → [116+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=116%2B)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1842658#c6)• 2 years ago |
|  | |

Comment on [attachment 9343147](/attachment.cgi?id=9343147 "Bug 1842658 - Part 2: Use refcounting macros for nsHtml5OwningUTF16Buffer, r=mccr8!") [[details]](/attachment.cgi?id=9343147&action=edit "Bug 1842658 - Part 2: Use refcounting macros for nsHtml5OwningUTF16Buffer, r=mccr8!")

[Bug 1842658](/show_bug.cgi?id=1842658 "RESOLVED FIXED - Clean up some manual AddRef/Release implementations") - Part 2: Use refcounting macros for nsHtml5OwningUTF16Buffer, r=mccr8!

Approved to land and uplift if desired.

[Attachment #9343147](/attachment.cgi?id=9343147&action=edit "Bug 1842658 - Part 2: Use refcounting macros for nsHtml5OwningUTF16Buffer, r=mccr8!") -
Flags: sec-approval? → sec-approval+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1842658#c7)• 2 years ago |
|  | |

Comment on [attachment 9343146](/attachment.cgi?id=9343146 "Bug 1842658 - Part 1: Use a refcounting macro for imgCacheEntry, r=emilio!") [[details]](/attachment.cgi?id=9343146&action=edit "Bug 1842658 - Part 1: Use a refcounting macro for imgCacheEntry, r=emilio!")

[Bug 1842658](/show_bug.cgi?id=1842658 "RESOLVED FIXED - Clean up some manual AddRef/Release implementations") - Part 1: Use a refcounting macro for imgCacheEntry, r=emilio!

Approved to land and uplift if desired.

[Attachment #9343146](/attachment.cgi?id=9343146&action=edit "Bug 1842658 - Part 1: Use a refcounting macro for imgCacheEntry, r=emilio!") -
Flags: sec-approval? → sec-approval+

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1842658#c8)• 1 years ago |
|  | |

Comment on [attachment 9343147](/attachment.cgi?id=9343147 "Bug 1842658 - Part 2: Use refcounting macros for nsHtml5OwningUTF16Buffer, r=mccr8!") [[details]](/attachment.cgi?id=9343147&action=edit "Bug 1842658 - Part 2: Use refcounting macros for nsHtml5OwningUTF16Buffer, r=mccr8!")

[Bug 1842658](/show_bug.cgi?id=1842658 "RESOLVED FIXED - Clean up some manual AddRef/Release implementations") - Part 2: Use refcounting macros for nsHtml5OwningUTF16Buffer, r=mccr8!

### Beta/Release Uplift Approval Request

* **User impact if declined**: Potential race condition leading to UAF.

Only part 2 could actually lead to a security issue, so part 1 could be not uplifted if desired, but they uplift well as a package.

* **Is this code covered by automated tests?**: No
* **Has the fix been verified in Nightly?**: No
* **Needs manual test from QE?**: No
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Change to use battle-tested reference counting macros rather than manually implemented reference counting on some objects.
* **String changes made/needed**: None
* **Is Android affected?**: Yes

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**:
* **User impact if declined**: Potential race condition leading to UAF.

Only part 2 could actually lead to a security issue, so part 1 could be not uplifted if desired, but they uplift well as a package.

* **Fix Landed on Version**:
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Change to use battle-tested reference counting macros rather than manually implemented reference counting on some objects.
[Attachment #9343147](/attachment.cgi?id=9343147&action=edit "Bug 1842658 - Part 2: Use refcounting macros for nsHtml5OwningUTF16Buffer, r=mccr8!") -
Flags: approval-mozilla-esr115?
[Attachment #9343147](/attachment.cgi?id=9343147&action=edit "Bug 1842658 - Part 2: Use refcounting macros for nsHtml5OwningUTF16Buffer, r=mccr8!") -
Flags: approval-mozilla-beta?

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1842658#a339636_534482)• 1 years ago |

[Attachment #9343146](/attachment.cgi?id=9343146&action=edit "Bug 1842658 - Part 1: Use a refcounting macro for imgCacheEntry, r=emilio!") -
Flags: approval-mozilla-beta?

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1842658#c9)• 1 years ago |
|  | |

Pushed by nlayzell@mozilla.com:
<https://hg.mozilla.org/integration/autoland/rev/642d09cfa740>
Part 1: Use a refcounting macro for imgCacheEntry, r=tnikkel
<https://hg.mozilla.org/integration/autoland/rev/509bf5b39d3f>
Part 2: Use refcounting macros for nsHtml5OwningUTF16Buffer, r=mccr8

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1842658#c10)• 1 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/642d09cfa740>

<https://hg.mozilla.org/mozilla-central/rev/509bf5b39d3f>

Group: dom-core-security → core-security-releaseStatus: NEW → RESOLVEDClosed: 1 years ago
[status-firefox117](/buglist.cgi?f1=cf_status_firefox117&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 117 Branch

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1842658#c11)• 1 years ago |
|  | |

Comment on [attachment 9343146](/attachment.cgi?id=9343146 "Bug 1842658 - Part 1: Use a refcounting macro for imgCacheEntry, r=emilio!") [[details]](/attachment.cgi?id=9343146&action=edit "Bug 1842658 - Part 1: Use a refcounting macro for imgCacheEntry, r=emilio!")

[Bug 1842658](/show_bug.cgi?id=1842658 "RESOLVED FIXED - Clean up some manual AddRef/Release implementations") - Part 1: Use a refcounting macro for imgCacheEntry, r=emilio!

Approved for 116.0b6

[Attachment #9343146](/attachment.cgi?id=9343146&action=edit "Bug 1842658 - Part 1: Use a refcounting macro for imgCacheEntry, r=emilio!") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1842658#a502455_690067)• 1 years ago |

[Attachment #9343147](/attachment.cgi?id=9343147&action=edit "Bug 1842658 - Part 2: Use refcounting macros for nsHtml5OwningUTF16Buffer, r=mccr8!") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1842658#c12)• 1 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/46e2e4de8d2b>
<https://hg.mozilla.org/releases/mozilla-beta/rev/d41ddd1d61e2>

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1842658#a502789_690067)• 1 years ago |

[status-firefox116](/buglist.cgi?f1=cf_status_firefox116&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=fixed)

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1842658#c13)• 1 years ago |
|  | |

Comment on [attachment 9343147](/attachment.cgi?id=9343147 "Bug 1842658 - Part 2: Use refcounting macros for nsHtml5OwningUTF16Buffer, r=mccr8!") [[details]](/attachment.cgi?id=9343147&action=edit "Bug 1842658 - Part 2: Use refcounting macros for nsHtml5OwningUTF16Buffer, r=mccr8!")

[Bug 1842658](/show_bug.cgi?id=1842658 "RESOLVED FIXED - Clean up some manual AddRef/Release implementations") - Part 2: Use refcounting macros for nsHtml5OwningUTF16Buffer, r=mccr8!

Approved for 115.1esr

[Attachment #9343147](/attachment.cgi?id=9343147&action=edit "Bug 1842658 - Part 2: Use refcounting macros for nsHtml5OwningUTF16Buffer, r=mccr8!") -
Flags: approval-mozilla-esr115? → approval-mozilla-esr115+

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1842658#c14)• 1 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr115/rev/b320eac319c0>

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1842658#a597442_690067)• 1 years ago |

[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1842658#a613920_75935)• 1 years ago |

[Attachment #9343147](/attachment.cgi?id=9343147&action=edit "Bug 1842658 - Part 2: Use refcounting macros for nsHtml5OwningUTF16Buffer, r=mccr8!") -
Flags: approval-mozilla-esr102?

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1842658#a728232_488993)• 1 years ago |

QA Whiteboard: [post-critsmash-triage]

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1842658#c15)• 1 years ago |
|  | |

Comment on [attachment 9343147](/attachment.cgi?id=9343147 "Bug 1842658 - Part 2: Use refcounting macros for nsHtml5OwningUTF16Buffer, r=mccr8!") [[details]](/attachment.cgi?id=9343147&action=edit "Bug 1842658 - Part 2: Use refcounting macros for nsHtml5OwningUTF16Buffer, r=mccr8!")

[Bug 1842658](/show_bug.cgi?id=1842658 "RESOLVED FIXED - Clean up some manual AddRef/Release implementations") - Part 2: Use refcounting macros for nsHtml5OwningUTF16Buffer, r=mccr8!

Approved for 102.14esr

[Attachment #9343147](/attachment.cgi?id=9343147&action=edit "Bug 1842658 - Part 2: Use refcounting macros for nsHtml5OwningUTF16Buffer, r=mccr8!") -
Flags: approval-mozilla-esr102? → approval-mozilla-esr102+

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1842658#c16)• 1 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr102/rev/39238cdf16e8>

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1842658#a785888_690067)• 1 years ago |

[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed)

|  | [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1842658#a1408037_486733)• 1 years ago |

Whiteboard: [adv-main116+] [adv-ESR115.1+] [adv-ESR102.14+]

|  | [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1842658#c17)• 1 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9346065)
— [Details](attachment.cgi?id=9346065&action=edit)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1842658#a15341096_1689)• 1 year ago |

Group: core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1842658#a15347663_1689)• 1 year ago |

Alias: CVE-2023-4049
You need to [log in](/show_bug.cgi?id=1842658&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review

