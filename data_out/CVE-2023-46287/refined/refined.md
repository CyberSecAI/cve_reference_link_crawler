The content provided relates to CVE-2023-46287.

Based on the provided information, here's a breakdown of the vulnerability:

**Root cause of vulnerability:**
The vulnerability stems from a lack of proper sanitization of the `value` and `display` parameters within the `select()` function in `html.php`. Specifically, these parameters were not being escaped before being included in the HTML output, leading to a potential Cross-Site Scripting (XSS) vulnerability.

**Weaknesses/vulnerabilities present:**
- Cross-Site Scripting (XSS) vulnerability: The `select` function in `share/server/core/functions/html.php` was vulnerable to XSS because the `value` and `display` parameters were directly embedded into the HTML without proper encoding.

**Impact of exploitation:**
- An attacker could inject malicious scripts into the `value` or `display` parameters.
- When a user interacts with the affected dropdown menu, the injected script would execute within the user's browser.
- The attacker could potentially steal cookies, redirect the user to malicious sites, or perform actions on behalf of the user.

**Attack vectors:**
- An attacker would need to control the input passed to the `select()` function.
- This could involve manipulating form parameters, URL parameters, or any other data source that ultimately populates the `value` and `display` attributes of the `<option>` tag.

**Required attacker capabilities/position:**
- An attacker needs to be able to influence the data used to create the dropdown menu.
- The attacker doesn't necessarily need direct access to the web server, but they do need to be able to manipulate data before it gets to the vulnerable function.
- They need to have the ability to inject malicious code into the `value` or `display` parameters of the `select()` function.

**Additional details:**
The fix implemented in commit `d660591b23e5cfea4d1be2d3fb8f3855aa6020fb` involves using `htmlspecialchars()` on the `value` and `display` parameters before they are included in the HTML output. This ensures that any special HTML characters are encoded and rendered literally instead of being interpreted as code, thereby preventing XSS.
```diff
--- a/share/server/core/functions/html.php
+++ b/share/server/core/functions/html.php
@@ -326,7 +326,7 @@
 			$select = '';
 			if($value == $default)
 				$select = ' selected';
-			$ret .= '<option value="'.$value.'"'.$select.'>'.$display.'</option>'.N;
+			$ret .= '<option value="'.htmlspecialchars($value).'"'.$select.'>'.htmlspecialchars($display).'</option>'.N;
 		}
 		$ret .= '</select>'.N;
 		echo $ret;
```
This commit message also clarifies that the issue is an XSS vulnerability
```
Fix XSS vulnerability
```