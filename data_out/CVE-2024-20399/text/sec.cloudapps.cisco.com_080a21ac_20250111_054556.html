

[Home](https://www.cisco.com)  / [Cisco Security](/security/center/home.x) / [Security Advisories](https://sec.cloudapps.cisco.com/security/center/publicationListing.x)

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| | Cisco Security AdvisoryCisco NX-OS Software CLI Command Injection Vulnerability Medium   Advisory ID:  cisco-sa-nxos-cmd-injection-xD9OhyOP  First Published: 2024 July 1 16:00 GMT  Last Updated:  2024 September 17 18:05 GMT  Version 1.3:  [Final](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#final)   Workarounds:  No workarounds available  Cisco Bug IDs: [CSCwj94682](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwj94682)  [CSCwj97007](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwj97007)  [CSCwj97009](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwj97009)  More...  ,[CSCwj94682](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwj94682),[CSCwj97007](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwj97007),[CSCwj97009](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwj97009),[CSCwj97011](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwj97011)   CVE-2024-20399     CWE-78       CVSS Score: [Base 6.0](https://sec.cloudapps.cisco.com/security/center/cvssCalculator.x?version=3.1&vector=CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:N)**Click Icon to Copy Verbose Score** CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:N/E:X/RL:X/RC:X       CVE-2024-20399     CWE-78       [Download CSAF](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-nxos-cmd-injection-xD9OhyOP/csaf/cisco-sa-nxos-cmd-injection-xD9OhyOP.json)   Email      Summary  * A vulnerability in the CLI of Cisco NX-OS Software could allow an authenticated user in possession of *Administrator* credentials to execute arbitrary commands as *root* on the underlying operating system of an affected device.  This vulnerability is due to insufficient validation of arguments that are passed to specific configuration CLI commands. An attacker could exploit this vulnerability by including crafted input as the argument of an affected configuration CLI command. A successful exploit could allow the attacker to execute arbitrary commands on the underlying operating system with the privileges of *root*.  **Note:** To successfully exploit this vulnerability on a Cisco NX-OS device, an attacker must have *Administrator* credentials. The following Cisco devices already allow administrative users to access the underlying operating system through the **bash-shell** feature, so, for these devices, this vulnerability does not grant any additional privileges:    + Nexus 3000 Series Switches   + Nexus 7000 Series Switches that are running Cisco NX-OS Software releases 8.1(1) and later   + Nexus 9000 Series Switches in standalone NX-OS mode Cisco has released software updates that address this vulnerability. There are no workarounds that address this vulnerability.  This advisory is available at the following link:<https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-nxos-cmd-injection-xD9OhyOP>  Affected Products  * Vulnerable Products At the time of publication, this vulnerability affected the following Cisco products if they were running a vulnerable release of Cisco NX-OS Software:    + MDS 9000 Series Multilayer Switches ([CSCwj97007](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwj97007))   + Nexus 3000 Series Switches ([CSCwj97009](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwj97009))1   + Nexus 5500 Platform Switches ([CSCwj97011](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwj97011))   + Nexus 5600 Platform Switches ([CSCwj97011](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwj97011))   + Nexus 6000 Series Switches ([CSCwj97011](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwj97011))   + Nexus 7000 Series Switches ([CSCwj94682](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwj94682))2   + Nexus 9000 Series Switches in standalone NX-OS mode ([CSCwj97009](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwj97009))1 1. For Cisco NX-OS Software releases that are running on Cisco Nexus 3000 Series Switches and Cisco Nexus 9000 Series Switches in standalone NX-OS mode, this vulnerability does not grant additional privileges due to the availability of the **bash-shell** feature. Cisco NX-OS Software releases 9.3(5) and later are not affected by this vulnerability, with the exception of the following Cisco platforms:    + Nexus 3000 platforms that are fixed in Cisco NX-OS Software Release 9.3(14):   - N3K-C3048TP-1GE   - N3K-C3132Q-40GX   - N3K-C3172PQ-10GE   - N3K-C3172TQ-10GT   - N3K-C3172TQ-32T   - N3K-C3524P-10GX   - N3K-C3548P-10GX+ Nexus 9000 platforms that are fixed in Cisco NX-OS Software releases 9.3(14), 10.3(6), 10.4(3), and later:   - N9K-C92348GC-X 2. For Cisco NX-OS Software releases 8.1(1) and later that are running on Cisco Nexus 7000 Series Switches, this vulnerability does not grant additional privileges due to the availability of the **bash-shell** feature.  For more information about this vulnerability, see the [Details](#details) section of this advisory.  For more information about which Cisco software releases are vulnerable, see the [Fixed Software](#fs) section of this advisory. Products Confirmed Not Vulnerable Only products listed in the [Vulnerable Products](#vp) section of this advisory are known to be affected by this vulnerability.  Cisco has confirmed that this vulnerability does not affect the following Cisco products:    + Adaptive Security Appliance (ASA) Software   + Firepower 1000 Series   + Firepower 2100 Series   + Firepower 4100 Series   + Firepower 9300 Security Appliances   + Firepower Threat Defense (FTD) Software   + Nexus 1000 Virtual Edge for VMware vSphere   + Nexus 1000V Switch for VMware vSphere   + Nexus 9000 Series Fabric Switches in ACI mode   + Secure Firewall 3100 Series   + Secure Firewall 4200 Series   + Secure Firewall Management Center (FMC) Software   + UCS 6200 Series Fabric Interconnects   + UCS 6300 Series Fabric Interconnects   + UCS 6400 Series Fabric Interconnects   + UCS 6500 Series Fabric Interconnects  Details  * To exploit this vulnerability, an attacker must have *Administrator* privileges and have access to specific configuration commands.  If a device is running a Cisco NX-OS Software release that does not support the **bash-shell** feature, a user with *Administrator* privileges could exploit this vulnerability to execute arbitrary commands on the underlying operating system.  If a device is running a Cisco NX-OS Software release that supports the **bash-shell** feature, a user with *Administrator* privileges can already access the underlying operating system directly using the **bash-shell** feature. Therefore, this vulnerability does not grant any additional privileges on the device. However, this vulnerability does allow a user with *Administrator* privileges to execute commands on the underlying operating system without enabling the **bash-shell** feature and without triggering system syslog messages showing that the user executed the **run bash** CLI command. This could help a user with *Administrator* privileges hide the execution of shell commands on the device. However, because the affected CLI commands are configuration commands, the initial step for exploitation of this vulnerability would result in a syslog message reporting that a configuration change was applied to the device.  The **bash-shell** feature is available on all supported Cisco NX-OS Software releases for the following Cisco devices:    + Nexus 3000 Series Switches   + Nexus 7000 Series Switches that are running Cisco NX-OS Software releases 8.1(1) and later   + Nexus 9000 Series Switches in standalone NX-OS mode As a standard network practice, the credentials for the administrative users **network-admin** and **vdc-admin** should be monitored and changed frequently. The devices should also be monitored for any unexpected configuration changes.  Workarounds  * There are no workarounds that address this vulnerability.  Fixed Software  * When [considering software upgrades](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#fixes), customers are advised to regularly consult the advisories for Cisco products, which are available from the [Cisco Security Advisories page](https://www.cisco.com/go/psirt), to determine exposure and a complete upgrade solution.  In all cases, customers should ensure that the devices to be upgraded contain sufficient memory and confirm that current hardware and software configurations will continue to be supported properly by the new release. If the information is not clear, customers are advised to contact the Cisco Technical Assistance Center (TAC) or their contracted maintenance providers. Cisco NX-OS Software To help customers determine their exposure to vulnerabilities in Cisco NX-OS Software, Cisco provides the [Cisco Software Checker](https://sec.cloudapps.cisco.com/security/center/softwarechecker.x). This tool identifies any Cisco security advisories that impact a specific software release and the earliest release that fixes the vulnerabilities that are described in each advisory (“First Fixed”). If applicable, the tool also returns the earliest release that fixes all the vulnerabilities described in all the advisories that the Software Checker identifies (“Combined First Fixed”).  To use the tool, go to the [Cisco Software Checker](https://sec.cloudapps.cisco.com/security/center/softwarechecker.x) page and follow the instructions. Alternatively, use the following form to search for vulnerabilities that affect a specific software release. To use the form, follow these steps:    1. Choose which advisories the tool will search-only this advisory, only advisories with a Critical or High [Security Impact Rating (SIR)](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#asr), or all advisories.   2. Choose the appropriate software.   3. Choose the appropriate platform.   4. Enter a release number-for example, **7.0(3)I7(5)** for Cisco Nexus 3000 Series Switches or **14.0(1h)** for Cisco NX-OS Software in ACI mode.   5. Click **Check**.        Only this advisory   All Critical and High advisories   All advisories   Cisco NX-OS Software   Cisco NX-OS Software in ACI Mode   Any Platform   MDS 9000 Series Multilayer Switches   Nexus 1000V Series Switches   Nexus 3000 Series Switches   Nexus 5000 Series Switches   Nexus 6000 Series Switches   Nexus 7000 Series Switches   Nexus 9000 Series Switches          Additional Resources For help determining the best Cisco NX-OS Software release for a Cisco Nexus Switch, see the following Recommended Releases documents. If a security advisory recommends a later release, Cisco recommends following the advisory guidance.  [Cisco MDS Series Switches](https://www.cisco.com/c/en/us/td/docs/switches/datacenter/mds9000/sw/b_MDS_NX-OS_Recommended_Releases.html)[Cisco Nexus 1000V for VMware Switch](http://www.cisco.com/c/en/us/td/docs/switches/datacenter/nexus1000/sw/recommended_releases/b_Cisco_N1KV_VMware_MinRecommendedReleases.html)[Cisco Nexus 3000 Series Switches](http://www.cisco.com/c/en/us/td/docs/switches/datacenter/nexus3000/sw/recommended_release/b_Minimum_and_Recommended_Cisco_NX-OS_Releases_for_Cisco_Nexus_3000_Series_Switches.html)[Cisco Nexus 5500 Platform Switches](http://www.cisco.com/c/en/us/td/docs/switches/datacenter/nexus5500/sw/release/recommended_releases/n5500_recommended_nx-os_releases.html)[Cisco Nexus 5600 Platform Switches](https://www.cisco.com/c/en/us/td/docs/switches/datacenter/nexus5600/sw/release/recommended_releases/n5600_recommended_nx-os_releases.html)[Cisco Nexus 6000 Series Switches](http://www.cisco.com/c/en/us/td/docs/switches/datacenter/nexus6000/sw/release/recommended_releases/recommended_nx-os_releases.html)[Cisco Nexus 7000 Series Switches](http://www.cisco.com/c/en/us/td/docs/switches/datacenter/sw/nx-os/recommended_releases/recommended_nx-os_releases.html)[Cisco Nexus 9000 Series Switches](http://www.cisco.com/c/en/us/td/docs/switches/datacenter/nexus9000/sw/recommended_release/b_Minimum_and_Recommended_Cisco_NX-OS_Releases_for_Cisco_Nexus_9000_Series_Switches.html)[Cisco Nexus 9000 Series ACI-Mode Switches](https://www.cisco.com/c/en/us/td/docs/switches/datacenter/aci/apic/sw/recommended-release/b_Recommended_Cisco_ACI_Releases.html)  To determine the best release for Cisco UCS Software, see the Recommended Releases documents in the release notes for the device.  Exploitation and Public Announcements  * In April 2024, the Cisco Product Security Incident Response Team (PSIRT) became aware of attempted exploitation of this vulnerability in the wild.  Source  * Cisco would like to thank Sygnia for reporting this vulnerability. Tristan Van Egroo of the Cisco Advanced Security Initiatives Group (ASIG) investigated this vulnerability.  Cisco Security Vulnerability Policy  * To learn about Cisco security vulnerability disclosure policies and publications, see the [Security Vulnerability Policy](http://www.cisco.com/web/about/security/psirt/security_vulnerability_policy.html). This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.  Subscribe to Cisco Security Notifications  * [Subscribe](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html)  Related to This Advisory    URL  * <https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-nxos-cmd-injection-xD9OhyOP>  Revision History  * | Version | Description | Section | Status | Date |   | --- | --- | --- | --- | --- |   | 1.3 | Removed references to upcoming fixed releases because they are all available now. Updated the list of vulnerable PIDs. | Summary and Vulnerable Products | Final | 2024-SEP-17 |   | 1.2 | Further clarified the condition under which exploitation can occur and added products that are not vulnerable. | Summary, Vulnerable Products, Products Confirmed Not Vulnerable, Details | Final | 2024-JUL-03 |   | 1.1 | Updated to explain that fixes are available for some products and others will be released as they become available. | Summary | Final | 2024-JUL-02 |   | 1.0 | Initial public release. | - | Final | 2024-JUL-01 |      Show Less  ---   Legal Disclaimer  * THIS DOCUMENT IS PROVIDED ON AN "AS IS" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE. YOUR USE OF THE INFORMATION ON THE DOCUMENT OR MATERIALS LINKED FROM THE DOCUMENT IS AT YOUR OWN RISK. CISCO RESERVES THE RIGHT TO CHANGE OR UPDATE THIS DOCUMENT AT ANY TIME.  A standalone copy or paraphrase of the text of this document that omits the distribution URL is an uncontrolled copy and may lack important information or contain factual errors. The information in this document is intended for end users of Cisco products.   Feedback  * Leave additional feedback     Cisco Security Vulnerability Policy  * To learn about Cisco security vulnerability disclosure policies and publications, see the [Security Vulnerability Policy](http://www.cisco.com/web/about/security/psirt/security_vulnerability_policy.html). This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.  Subscribe to Cisco Security Notifications  * [Subscribe](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html)  Related to This Advisory |        | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |

