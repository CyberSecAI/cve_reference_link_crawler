=== Content from www.sygnia.co_4c3a1f82_20250111_054557.html ===


[![Sygnia Logo](https://www.sygnia.co/wp-content/uploads/2024/01/main_logo.svg)](https://www.sygnia.co/)

* [Solutions](https://www.sygnia.co/solutions/)
  + [Services](https://www.sygnia.co/solutions/)
    - [Cyber readiness](https://www.sygnia.co/solutions/)
      * [Know](https://www.sygnia.co/solutions/know/)
        + [Posture enhancement](https://www.sygnia.co/solutions/cyber-posture-enhancement/)
        + [Secure design](/solutions/secure-design/)
        + [M&A assessment](https://www.sygnia.co/solutions/m-and-a-cyber-due-diligence-assessment/)
      * [Prepare](https://www.sygnia.co/solutions/prepare/)
        + [Incident response retainer](https://www.sygnia.co/solutions/incident-response-retainer/)
        + [Ransomware readiness](https://www.sygnia.co/solutions/ransomware-readiness-assessment/)
        + [Crisis preparedness & contingency planning](https://www.sygnia.co/solutions/prepare/)
      * [Simulate](/solutions/simulate/)
        + [Red teaming](https://www.sygnia.co/solutions/red-teaming/)
        + [Purple teaming​](https://www.sygnia.co/solutions/purple-teaming/)
        + [Tabletop wargames​](https://www.sygnia.co/solutions/cyber-war-gaming/)
      * [Detect](https://www.sygnia.co/solutions/detect/)
        + [Managed detection and response](https://www.sygnia.co/solutions/managed-detection-and-response/)
        + [Threat intelligence exposure monitoring](https://www.sygnia.co/solutions/cyber-threat-intelligence-solutions/)
    - [Cyber response](https://www.sygnia.co/solutions/)
      * [Respond & Recover](https://www.sygnia.co/solutions/respond-recover/)
        + [Incident response](https://www.sygnia.co/solutions/incident-response/)
        + [Advanced monitoring](https://www.sygnia.co/solutions/detect/)
        + [Threat hunting & compromise assessment](https://www.sygnia.co/solutions/threat-hunting/)
  + [Technologies](https://www.sygnia.co/solutions/managed-extended-detection-and-response/)
    - [Velocity XDR](https://www.sygnia.co/solutions/velocity-xdr/)
  + [Enterprise Solutions](https://www.sygnia.co/solutions/)
    - [OT security](https://www.sygnia.co/solutions/ot-security-services/)
    - [Cloud security](https://www.sygnia.co/solutions/cloud-security-consulting/)
    - [Ransomware readiness](https://www.sygnia.co/solutions/ransomware-readiness-assessment-services/)
* [Company](https://www.sygnia.co/company/)
  + [About us](https://www.sygnia.co/company/)
    - [Story and values](https://www.sygnia.co/our-story/)
    - [Leadership](https://www.sygnia.co/leadership/)
    - [Newsroom](https://www.sygnia.co/newsroom/)
  + Our Clients
    - [Case studies](https://www.sygnia.co/case-study/)
    - [Solutions by industry](https://www.sygnia.co/solutions-by-industry/)
* [Careers](https://www.sygnia.co/careers/)
  + [Open Positions](https://www.sygnia.co/careers/open-positions/)
* [Knowledge Center](https://www.sygnia.co/knowledge-center/)
  + [All resources](/knowledge-center/)
  + [Blog](https://www.sygnia.co/blog/)
  + [Threat reports & advisories](https://www.sygnia.co/knowledge-center/threat-reports-and-advisories/)
  + [Guides and tools](https://www.sygnia.co/guides-and-tools/)
  + [Newsroom](https://www.sygnia.co/newsroom/)

[![](https://www.sygnia.co/wp-content/uploads/2024/01/icon_info.svg)
I’m under attack](https://www.sygnia.co/im-under-attack/)

[Contact us](https://www.sygnia.co/contact-us/)

[![](https://www.sygnia.co/wp-content/uploads/2024/01/icon_info.svg)
I’m under attack](https://www.sygnia.co/im-under-attack/)

* [Solutions](https://www.sygnia.co/solutions/)
  + [Services](https://www.sygnia.co/solutions/)
    - [Cyber readiness](https://www.sygnia.co/solutions/)
      * [Know](https://www.sygnia.co/solutions/know/)
        + [Posture enhancement](https://www.sygnia.co/solutions/cyber-posture-enhancement/)
        + [Secure design](/solutions/secure-design/)
        + [M&A assessment](https://www.sygnia.co/solutions/m-and-a-cyber-due-diligence-assessment/)
      * [Prepare](https://www.sygnia.co/solutions/prepare/)
        + [Incident response retainer](https://www.sygnia.co/solutions/incident-response-retainer/)
        + [Ransomware readiness](https://www.sygnia.co/solutions/ransomware-readiness-assessment/)
        + [Crisis preparedness & contingency planning](https://www.sygnia.co/solutions/prepare/)
      * [Simulate](/solutions/simulate/)
        + [Red teaming](https://www.sygnia.co/solutions/red-teaming/)
        + [Purple teaming​](https://www.sygnia.co/solutions/purple-teaming/)
        + [Tabletop wargames​](https://www.sygnia.co/solutions/cyber-war-gaming/)
      * [Detect](https://www.sygnia.co/solutions/detect/)
        + [Managed detection and response](https://www.sygnia.co/solutions/managed-detection-and-response/)
        + [Threat intelligence exposure monitoring](https://www.sygnia.co/solutions/cyber-threat-intelligence-solutions/)
    - [Cyber response](https://www.sygnia.co/solutions/)
      * [Respond & Recover](https://www.sygnia.co/solutions/respond-recover/)
        + [Incident response](https://www.sygnia.co/solutions/incident-response/)
        + [Advanced monitoring](https://www.sygnia.co/solutions/detect/)
        + [Threat hunting & compromise assessment](https://www.sygnia.co/solutions/threat-hunting/)
  + [Technologies](https://www.sygnia.co/solutions/managed-extended-detection-and-response/)
    - [Velocity XDR](https://www.sygnia.co/solutions/velocity-xdr/)
  + [Enterprise Solutions](https://www.sygnia.co/solutions/)
    - [OT security](https://www.sygnia.co/solutions/ot-security-services/)
    - [Cloud security](https://www.sygnia.co/solutions/cloud-security-consulting/)
    - [Ransomware readiness](https://www.sygnia.co/solutions/ransomware-readiness-assessment-services/)
* [Company](https://www.sygnia.co/company/)
  + [About us](https://www.sygnia.co/company/)
    - [Story and values](https://www.sygnia.co/our-story/)
    - [Leadership](https://www.sygnia.co/leadership/)
    - [Newsroom](https://www.sygnia.co/newsroom/)
  + Our Clients
    - [Case studies](https://www.sygnia.co/case-study/)
    - [Solutions by industry](https://www.sygnia.co/solutions-by-industry/)
* [Careers](https://www.sygnia.co/careers/)
  + [Open Positions](https://www.sygnia.co/careers/open-positions/)
* [Knowledge Center](https://www.sygnia.co/knowledge-center/)
  + [All resources](/knowledge-center/)
  + [Blog](https://www.sygnia.co/blog/)
  + [Threat reports & advisories](https://www.sygnia.co/knowledge-center/threat-reports-and-advisories/)
  + [Guides and tools](https://www.sygnia.co/guides-and-tools/)
  + [Newsroom](https://www.sygnia.co/newsroom/)

[CONTACT US](https://www.sygnia.co/contact-us/)

* [Home](https://www.sygnia.co/)
* [Blog](https://www.sygnia.co/blog/)
* China-Nexus Threat Group ‘Velvet Ant’ Exploits Cisco Zero-Day (CVE-2024-20399) to Compromise Nexus Switch Devices – Advisory for Mitigation and Response

![](data:image/svg+xml...)![](https://www.sygnia.co/wp-content/uploads/2024/07/Blog_Insacts_Header_v4_Black_2_Velvet_Ant-scaled.jpg)

![](https://www.sygnia.co/wp-content/themes/sygnia-theme/images/share_item_facebook.svg)
![](https://www.sygnia.co/wp-content/themes/sygnia-theme/images/share_item_x.svg)
![](https://www.sygnia.co/wp-content/themes/sygnia-theme/images/share_item_linkedin.svg)
[![](https://www.sygnia.co/wp-content/themes/sygnia-theme/images/share_item_mail.svg)](/cdn-cgi/l/email-protection#47783432252d2224337a042f2e29266a09223f3234627577132f352226336275770035283237627577a5c7df11222b312233627577062933a5c7de627577023f372b282e3334627577042e3424286275771d2235286a03263e6275776f0411026a757775736a7577747e7e6e627577332862757704282a3735282a2e342262757709223f323462757714302e33242f6275770322312e242234627577a5c7d46275770623312e3428353e6275772128356275770a2e332e2026332e2829627577262923627577152234372829342261262a377c2528233e7a042f22242c6728323367332f2e34672f3333373462740662750162750130303069343e20292e26692428627501332f352226336a352237283533346a2629236a2623312e3428352e2234627501242f2e29266a29223f32346a332f352226336a20352832376a31222b3122336a2629336a223f372b282e33346a242e3424286a776a23263e627501)

# China-Nexus Threat Group ‘Velvet Ant’ Exploits Cisco Zero-Day (CVE-2024-20399) to Compromise Nexus Switch Devices – Advisory for Mitigation and Response

Learn about the forensic investigation by Sygnia, the cyber espionage operation by Velvet Ant, and best practices for safeguarding your network against sophisticated threats.

Sygnia Team
1 July 2024

CONTENTS

* [Overview](#1)
* [Introduction](#2)
  + [Background](#3)
  + [Relevance and Impact for Your Organization](#4)
* [What You Should Do](#5)
  + [General Details and Affected Products](#6)
  + [Patching](#7)
  + [Hardening and Prevention](#8)
  + [Monitoring and Detection](#9)
* [Appendices](#10)
  + [References](#11)
  + [How Sygnia Can Help](#12)

![](https://www.sygnia.co/wp-content/themes/sygnia-theme/images/share_item_facebook.svg)
![](https://www.sygnia.co/wp-content/themes/sygnia-theme/images/share_item_x.svg)
![](https://www.sygnia.co/wp-content/themes/sygnia-theme/images/share_item_linkedin.svg)
[![](https://www.sygnia.co/wp-content/themes/sygnia-theme/images/share_item_mail.svg)](/cdn-cgi/l/email-protection#cbf4b8bea9a1aea8bff688a3a2a5aae685aeb3beb8eef9fb9fa3b9aeaabfeef9fb8cb9a4bebbeef9fb294b539daea7bdaebfeef9fb8aa5bf294b52eef9fb8eb3bba7a4a2bfb8eef9fb88a2b8a8a4eef9fb91aeb9a4e68faab2eef9fbe3889d8ee6f9fbf9ffe6f9fbf8f2f2e2eef9fbbfa4eef9fb88a4a6bbb9a4a6a2b8aeeef9fb85aeb3beb8eef9fb98bca2bfa8a3eef9fb8faebda2a8aeb8eef9fb294b58eef9fb8aafbda2b8a4b9b2eef9fbada4b9eef9fb86a2bfa2acaabfa2a4a5eef9fbaaa5afeef9fb99aeb8bba4a5b8aeedaaa6bbf0a9a4afb2f688a3aea8a0eba4bebfebbfa3a2b8eba3bfbfbbb8eef88aeef98deef98dbcbcbce5b8b2aca5a2aae5a8a4eef98dbfa3b9aeaabfe6b9aebba4b9bfb8e6aaa5afe6aaafbda2b8a4b9a2aeb8eef98da8a3a2a5aae6a5aeb3beb8e6bfa3b9aeaabfe6acb9a4bebbe6bdaea7bdaebfe6aaa5bfe6aeb3bba7a4a2bfb8e6a8a2b8a8a4e6fbe6afaab2eef98d)

## Overview

* On July 1, Cisco [published](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-nxos-cmd-injection-xD9OhyOP) an advisory regarding CVE-2024-20399, a newly discovered command injection vulnerability in the Cisco NX-OS Software CLI. This vulnerability affects a wide range of Cisco Nexus devices.
* Sygnia discovered and reported this vulnerability to Cisco and provided detailed information about the exploit and the subsequent attack flow.
* The vulnerability was identified as part of a larger forensic investigation performed by Sygnia of a China-nexus cyber espionage operation that was conducted by a threat actor Sygnia dubs as ‘Velvet Ant’.
* Following Velvet Ant’s exploitation of CVE-2024-20399, the group successfully executed malicious code on the underlying Linux OS of the Nexus switch.
* Network appliances, particularly switches, are often not monitored, and their logs are frequently not forwarded to a centralized logging system. This lack of monitoring creates significant challenges in identifying and investigating malicious activities.
* Consistently applying and adhering to security best practices ensures resilient defense mechanisms, effectively safeguarding against sophisticated threats, including state sponsored attacks, such Velvet Ant.

## Introduction

### Background

Cisco NX-OS Software is a network operating system specifically used for Cisco’s Nexus series of switches. Although NX-OS is based on a Linux kernel, it abstracts away the underlying Linux environment and provides its own set of commands using the NX-OS CLI. In order to execute commands on the underlaying Linux operating system from the Switch management console, an attacker would need a “jailbreak” type of vulnerability to escape the NX-OS CLI context.

CVE-2024-20399 that was identified by Sygnia allows an attacker with valid administrator credentials to the Switch management console to escape the NX-OS CLI and execute arbitrary commands on the Linux underlaying operating system.

Sygnia identified that CVE-2024-20399 was exploited in the wild by a China-nexus threat group as a ‘zero-day’ and shared the details of the vulnerability with Cisco. By exploiting this vulnerability, a threat group – dubbed ‘Velvet Ant’ – successfully executed commands on the underlying operating system of Cisco Nexus devices. This exploitation led to the execution of a previously unknown custom malware that allowed the threat group to remotely connect to compromised Cisco Nexus devices, upload additional files, and execute code on the devices.

### Relevance and Impact for Your Organization

Cisco Nexus switches are prevalent in enterprise environments, especially within data centers. Exploiting the identified vulnerability requires the threat group to possess valid administrator-level credentials and have network access to the Nexus switch. Given that most Nexus switches are not directly exposed to the internet, a threat group must first achieve initial access to the organization’s internal network to exploit this vulnerability. Consequently, the overall risk to organizations is reduced by the inherent difficulty in obtaining the necessary access.

Despite the substantial pre-requisites for exploiting the discussed vulnerability, this incident demonstrates the tendency of sophisticated threat groups to leverage network appliances – which are often not sufficiently protected and monitored – to maintain persistent network access; the incident also underscores the critical importance of adhering to security best practices as a mitigation against this type of threat. The recommended mitigation strategies are detailed in the Hardening and Prevention section below.

## What You Should Do

### General Details and Affected Products

The vulnerability has CVE ID CVE-2024-20399, and a CVSS score of 6.0 (medium severity).

As of version 1.0 of Cisco’s advisory regarding the CVE, the following products are affected:

* MDS 9000 Series Multilayer Switches (CSCwj97007) \*
* Nexus 3000 Series Switches (CSCwj97009)
* Nexus 5500 Platform Switches (CSCwj97011)
* Nexus 5600 Platform Switches (CSCwj97011)
* Nexus 6000 Series Switches (CSCwj97011)
* Nexus 7000 Series Switches (CSCwj94682) \*
* Nexus 9000 Series Switches in standalone NX-OS mode (CSCwj97009) \*

\* See the detailed list of affected products in Cisco’s [advisory](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-nxos-cmd-injection-xD9OhyOP).

### Patching

Cisco has released software updates that address the vulnerability described in this advisory. Updating the systems of affected devices is the primary mitigation strategy for licensed devices. For cases in which software updates are not available, this incident demonstrates the critical importance of adopting security best practices to prevent access to devices in the first place.

### Hardening and Prevention

The prevention and hardening strategies outlined below are designed to provide organizations with robust measures to counter threats related to unauthorized access and command execution vulnerabilities in network equipment such as CVE-2024-20399.

1. **Restrict administrative access:** Utilize a Privileged Access Management (PAM) solution or a dedicated, hardened, jump server with multi-factor authentication (MFA) enforced, to restrict access to network equipment. If these options are not feasible, restrict access to specific network addresses, such as an Out-Of-Band (OOB) network. Implementing a secure point for management access significantly limits a threat groups’ ability to gain access to switches and other network equipment without being detected.
2. **Use central authentication, authorization, and accounting management for users (AAA):** Utilizing TACACS+ and systems such as Cisco ISE can help streamline and enhance security, especially in environments with numerous switches. Centralized user management ensures that local user accounts are not scattered across individual switches, and simplifies monitoring, password rotation, and access reviews. Additionally, in the event of a compromise, centralized management allows for quick and efficient user remediation across all network equipment.
3. **Enforce a strong password policy and maintain good password hygiene:** Although passwords should not be the sole security measure, ensuring that administrative users have complex, securely stored passwords is crucial. Preferably, use a Privileged Identity Management (PIM) solution that can auto-rotate administrative account passwords, or a password vault with restricted access. Avoid storing passwords in unsecured locations, such as Excel spreadsheets or shared folders.
4. **Restrict outbound internet access for devices:** Restrict switches from initiating outbound connections to the internet to reduce the risk of them being exploited by external threats, or used to communicate with malicious actors. Implement strict firewall rules and access control lists (ACLs) to ensure that only necessary traffic is allowed, further enhancing the security of your network infrastructure.
5. **Implement regular patch management and vulnerability management practices:** Regularly review and apply patches to all network devices to address newly discovered vulnerabilities such as CVE-2024-20399 to reduce the risk of exploitation. Utilize automated tools such as vulnerability scanners to identify and prioritize existing vulnerabilities in network equipment.

### Monitoring and Detection

Network equipment, especially switches, often lacks adequate monitoring by organizations. Enhancing visibility and forwarding logs to a central logging solution are crucial first steps in identifying malicious activities on network devices. To monitor for exploitation attempts, consider the following actions:

1. **Enable Syslog on All Switches**: Ensure that all network switches are configured to send log data to a centralized Syslog server.
   1. Cisco supports configuring different logging levels for specific modules.
   2. By default, Cisco switches only log failed authentication attempts. Consider changing the AUTHPRIV level to 6 to also include successful authentication attempts.
2. **Set Up SIEM Integration**: Integrate switch logs with a Security Information and Event Management (SIEM) system to correlate events and detect anomalies.
3. **Configure Alerts**: Utilize syslog information to establish alerts that help identify suspicious activities. For instance, set up alerts for SSH connections that do not originate from an authorized jump host, and for SSH connections originating from network equipment.
4. **Set up Network Monitoring:** Regularly analyze network traffic to identify anomalous patterns associated with Cisco switches, with a focus on traffic involving management ports such as SSH and Telnet.
5. **Conduct Periodic Threat Hunts**: Design threat hunts focused on network devices.
   1. Exploitation of CVE-2024-20399 can be identified by analyzing commands executed on the device and searching for anomalies; such commands may include the output of the ‘show accounting log’ command.
   2. To identify a compromised switch running the malware deployed by Velvet Ant, analyze the output of ‘show sockets connection’, and search for processes listening on high ports.
   3. Note that to validate if a switch that exhibits suspicious indicators is indeed compromised, access to the underlying Linux operating system is required.
6. **Monitor Velvet Ant’s IOCs and TTPs**: Sygnia recently published a detailed [blog post](https://www.sygnia.co/blog/china-nexus-threat-group-velvet-ant/) on the group, providing additional insights into their methods. Use the information in the blog to enhance detection capabilities, and to detect whether the threat group is present or active within your network.

## Appendices

### References

Cisco Advisory: <https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-nxos-cmd-injection-xD9OhyOP>

Sygnia’s blog on Velvet Ant:
<https://www.sygnia.co/blog/china-nexus-threat-group-velvet-ant/>

### How Sygnia Can Help

Sygnia offers focused threat hunts and incident response services to navigate the challenges posed by CVE-2024-20399. Our experts are ready to assist in swiftly securing your environment against this and all vulnerabilities.

If you were impacted by this attack or are seeking guidance on how to prevent similar attacks, please contact us at [[email protected]](/cdn-cgi/l/email-protection#e88b87869c898b9ca89b918f868189c68b87) or our 24-hour hotline +1-877-686-8680.

This advisory and any information or recommendation contained here has been prepared for general informational purposes and is not intended to be used as a substitute for professional consultation on facts and circumstances specific to any entity. While we have made attempts to ensure the information contained herein has been obtained from reliable sources and to perform rigorous analysis, this advisory is based on initial rapid study, and needs to be treated accordingly. Sygnia is not responsible for any errors or omissions, or for the results obtained from the use of this Advisory. This advisory is provided on an as-is basis, and without warranties of any kind.

CONTENTS

* [Overview](#1)
* [Introduction](#2)
  + [Background](#3)
  + [Relevance and Impact for Your Organization](#4)
* [What You Should Do](#5)
  + [General Details and Affected Products](#6)
  + [Patching](#7)
  + [Hardening and Prevention](#8)
  + [Monitoring and Detection](#9)
* [Appendices](#10)
  + [References](#11)
  + [How Sygnia Can Help](#12)

RELATED ARTICLES
[CrowdStrike Fallout: Navigating the Risks of Intrusive Security Tools](https://www.sygnia.co/blog/crowdstrike-outage-security-vs-operational-stability/)
7 October 2024

[China-Nexus Threat Group ‘Velvet Ant’ Leverages a Zero-Day to Deploy Malware on Cisco Nexus Switches](https://www.sygnia.co/blog/china-threat-group-velvet-ant-cisco-zero-day/)
22 August 2024

[What is a Rootkit? Exploring the Hidden Threats and Their Impact on System Security](https://www.sygnia.co/blog/rootkit-malware/)
12 August 2024

[Incident Response Readiness: What is it and how to improve it?](https://www.sygnia.co/guides-and-tools/incident-response-readiness/)
11 August 2024

### Newsletter signup

Keep up to date with our weekly digest of articles.

By clicking Subscribe, I agree to the use of my personal data in accordance with Sygnia [Privacy Policy](https://www.sygnia.co/privacy/). Sygnia will not sell, trade, lease, or rent your personal data to third parties.

[![](data:image/svg+xml...)

### 2024 Gartner® Market Guide for DFIR Retainer Services

Download Complimentary Copy](https://www.sygnia.co/2024-gartner-market-guide-dfir-services/)

## RELATED ARTICLES

[![](https://www.sygnia.co/wp-content/themes/sygnia-theme/images/article_card_lines_decor.svg)

![](data:image/svg+xml...)

Blog
### CrowdStrike Fallout: Navigating the Risks of Intrusive Security Tools

Learn how to balance robust cybersecurity with operational stability in the wake of the CrowdStrike outage.

Read more](https://www.sygnia.co/blog/crowdstrike-outage-security-vs-operational-stability/)
[![](https://www.sygnia.co/wp-content/themes/sygnia-theme/images/article_card_lines_decor.svg)

![](data:image/svg+xml...)

Blog
### China-Nexus Threat Group ‘Velvet Ant’ Leverages a Zero-Day to Deploy Malware on Cisco Nexus Switches

Sygnia uncovers the China-Nexus group ‘Velvet Ant’ leveraging a zero-day exploit (CVE-2024-20399) on Cisco Switch appliances, escalating evasion tactics to maintain long-term network persistence.

Read more](https://www.sygnia.co/blog/china-threat-group-velvet-ant-cisco-zero-day/)
[![](https://www.sygnia.co/wp-content/themes/sygnia-theme/images/article_card_lines_decor.svg)

![](data:image/svg+xml...)

Blog
### What is a Rootkit? Exploring the Hidden Threats and Their Impact on System Security

Learn what Rootkits are, how sophisticated threat actors leverage them to gain full control of computers and systems, and how to protect your systems from this unique risk.

Read more](https://www.sygnia.co/blog/rootkit-malware/)

![subsctibe decor](data:image/svg+xml...)![subsctibe decor](https://www.sygnia.co/wp-content/themes/sygnia-theme/images/banner_subsctibe_new.png)

Want to get in touch?
[Contact us](https://www.sygnia.co/contact-us/)

Subscribe to newsletter

By clicking Subscribe, I agree to the use of my personal data in accordance with Sygnia [Privacy Policy](https://www.sygnia.co/privacy/). Sygnia will not sell, trade, lease, or rent your personal data to third parties.

[![Sygnia Logo](https://www.sygnia.co/wp-content/uploads/2024/01/main_logo.svg)](https://www.sygnia.co/)

Company

* [About](https://www.sygnia.co/company/)
* [Careers](https://www.sygnia.co/careers/)

Services

* [Know](https://www.sygnia.co/solutions/know/)
* [Prepare](https://www.sygnia.co/solutions/prepare/)
* [Simulate](https://www.sygnia.co/solutions/simulate/)
* [Detect](https://www.sygnia.co/solutions/detect/)
* [Respond & Recover](https://www.sygnia.co/solutions/respond-recover/)

Technologies

* [Velocity XDR](https://www.sygnia.co/solutions/velocity-xdr/)

Enterprise Solutions

* [OT Security](https://www.sygnia.co/solutions/ot-security-services/)
* [Cloud Security](https://www.sygnia.co/solutions/cloud-security-consulting/)
* [Ransomware Readiness](/solutions/ransomware-readiness/)

Knowledge Center

* [Blog](https://www.sygnia.co/knowledge-center/blog/)
* [Reports and advisories](/threat-reports-and-advisories/)

[![Sygnia Logo](https://www.sygnia.co/wp-content/uploads/2024/01/main_logo.svg)](https://www.sygnia.co/)

Copyright © 2025 Sygnia Consulting Ltd. All rights reserved.

* [Privacy](https://www.sygnia.co/privacy/)
* [Terms of use](https://www.sygnia.co/terms-of-use/)

[![](https://www.sygnia.co/wp-content/uploads/2024/05/social_linkedin_white.svg)](https://www.linkedin.com/company/sygnia)

[![](https://www.sygnia.co/wp-content/uploads/2024/05/social_x_white.svg)](https://twitter.com/sygnia_labs)



=== Content from sec.cloudapps.cisco.com_080a21ac_20250111_054556.html ===


[Home](https://www.cisco.com)  / [Cisco Security](/security/center/home.x) / [Security Advisories](https://sec.cloudapps.cisco.com/security/center/publicationListing.x)

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| | Cisco Security AdvisoryCisco NX-OS Software CLI Command Injection Vulnerability Medium   Advisory ID:  cisco-sa-nxos-cmd-injection-xD9OhyOP  First Published: 2024 July 1 16:00 GMT  Last Updated:  2024 September 17 18:05 GMT  Version 1.3:  [Final](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#final)   Workarounds:  No workarounds available  Cisco Bug IDs: [CSCwj94682](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwj94682)  [CSCwj97007](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwj97007)  [CSCwj97009](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwj97009)  More...  ,[CSCwj94682](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwj94682),[CSCwj97007](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwj97007),[CSCwj97009](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwj97009),[CSCwj97011](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwj97011)   CVE-2024-20399     CWE-78       CVSS Score: [Base 6.0](https://sec.cloudapps.cisco.com/security/center/cvssCalculator.x?version=3.1&vector=CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:N)**Click Icon to Copy Verbose Score** CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:N/E:X/RL:X/RC:X       CVE-2024-20399     CWE-78       [Download CSAF](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-nxos-cmd-injection-xD9OhyOP/csaf/cisco-sa-nxos-cmd-injection-xD9OhyOP.json)   Email      Summary  * A vulnerability in the CLI of Cisco NX-OS Software could allow an authenticated user in possession of *Administrator* credentials to execute arbitrary commands as *root* on the underlying operating system of an affected device.  This vulnerability is due to insufficient validation of arguments that are passed to specific configuration CLI commands. An attacker could exploit this vulnerability by including crafted input as the argument of an affected configuration CLI command. A successful exploit could allow the attacker to execute arbitrary commands on the underlying operating system with the privileges of *root*.  **Note:** To successfully exploit this vulnerability on a Cisco NX-OS device, an attacker must have *Administrator* credentials. The following Cisco devices already allow administrative users to access the underlying operating system through the **bash-shell** feature, so, for these devices, this vulnerability does not grant any additional privileges:    + Nexus 3000 Series Switches   + Nexus 7000 Series Switches that are running Cisco NX-OS Software releases 8.1(1) and later   + Nexus 9000 Series Switches in standalone NX-OS mode Cisco has released software updates that address this vulnerability. There are no workarounds that address this vulnerability.  This advisory is available at the following link:<https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-nxos-cmd-injection-xD9OhyOP>  Affected Products  * Vulnerable Products At the time of publication, this vulnerability affected the following Cisco products if they were running a vulnerable release of Cisco NX-OS Software:    + MDS 9000 Series Multilayer Switches ([CSCwj97007](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwj97007))   + Nexus 3000 Series Switches ([CSCwj97009](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwj97009))1   + Nexus 5500 Platform Switches ([CSCwj97011](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwj97011))   + Nexus 5600 Platform Switches ([CSCwj97011](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwj97011))   + Nexus 6000 Series Switches ([CSCwj97011](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwj97011))   + Nexus 7000 Series Switches ([CSCwj94682](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwj94682))2   + Nexus 9000 Series Switches in standalone NX-OS mode ([CSCwj97009](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwj97009))1 1. For Cisco NX-OS Software releases that are running on Cisco Nexus 3000 Series Switches and Cisco Nexus 9000 Series Switches in standalone NX-OS mode, this vulnerability does not grant additional privileges due to the availability of the **bash-shell** feature. Cisco NX-OS Software releases 9.3(5) and later are not affected by this vulnerability, with the exception of the following Cisco platforms:    + Nexus 3000 platforms that are fixed in Cisco NX-OS Software Release 9.3(14):   - N3K-C3048TP-1GE   - N3K-C3132Q-40GX   - N3K-C3172PQ-10GE   - N3K-C3172TQ-10GT   - N3K-C3172TQ-32T   - N3K-C3524P-10GX   - N3K-C3548P-10GX+ Nexus 9000 platforms that are fixed in Cisco NX-OS Software releases 9.3(14), 10.3(6), 10.4(3), and later:   - N9K-C92348GC-X 2. For Cisco NX-OS Software releases 8.1(1) and later that are running on Cisco Nexus 7000 Series Switches, this vulnerability does not grant additional privileges due to the availability of the **bash-shell** feature.  For more information about this vulnerability, see the [Details](#details) section of this advisory.  For more information about which Cisco software releases are vulnerable, see the [Fixed Software](#fs) section of this advisory. Products Confirmed Not Vulnerable Only products listed in the [Vulnerable Products](#vp) section of this advisory are known to be affected by this vulnerability.  Cisco has confirmed that this vulnerability does not affect the following Cisco products:    + Adaptive Security Appliance (ASA) Software   + Firepower 1000 Series   + Firepower 2100 Series   + Firepower 4100 Series   + Firepower 9300 Security Appliances   + Firepower Threat Defense (FTD) Software   + Nexus 1000 Virtual Edge for VMware vSphere   + Nexus 1000V Switch for VMware vSphere   + Nexus 9000 Series Fabric Switches in ACI mode   + Secure Firewall 3100 Series   + Secure Firewall 4200 Series   + Secure Firewall Management Center (FMC) Software   + UCS 6200 Series Fabric Interconnects   + UCS 6300 Series Fabric Interconnects   + UCS 6400 Series Fabric Interconnects   + UCS 6500 Series Fabric Interconnects  Details  * To exploit this vulnerability, an attacker must have *Administrator* privileges and have access to specific configuration commands.  If a device is running a Cisco NX-OS Software release that does not support the **bash-shell** feature, a user with *Administrator* privileges could exploit this vulnerability to execute arbitrary commands on the underlying operating system.  If a device is running a Cisco NX-OS Software release that supports the **bash-shell** feature, a user with *Administrator* privileges can already access the underlying operating system directly using the **bash-shell** feature. Therefore, this vulnerability does not grant any additional privileges on the device. However, this vulnerability does allow a user with *Administrator* privileges to execute commands on the underlying operating system without enabling the **bash-shell** feature and without triggering system syslog messages showing that the user executed the **run bash** CLI command. This could help a user with *Administrator* privileges hide the execution of shell commands on the device. However, because the affected CLI commands are configuration commands, the initial step for exploitation of this vulnerability would result in a syslog message reporting that a configuration change was applied to the device.  The **bash-shell** feature is available on all supported Cisco NX-OS Software releases for the following Cisco devices:    + Nexus 3000 Series Switches   + Nexus 7000 Series Switches that are running Cisco NX-OS Software releases 8.1(1) and later   + Nexus 9000 Series Switches in standalone NX-OS mode As a standard network practice, the credentials for the administrative users **network-admin** and **vdc-admin** should be monitored and changed frequently. The devices should also be monitored for any unexpected configuration changes.  Workarounds  * There are no workarounds that address this vulnerability.  Fixed Software  * When [considering software upgrades](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#fixes), customers are advised to regularly consult the advisories for Cisco products, which are available from the [Cisco Security Advisories page](https://www.cisco.com/go/psirt), to determine exposure and a complete upgrade solution.  In all cases, customers should ensure that the devices to be upgraded contain sufficient memory and confirm that current hardware and software configurations will continue to be supported properly by the new release. If the information is not clear, customers are advised to contact the Cisco Technical Assistance Center (TAC) or their contracted maintenance providers. Cisco NX-OS Software To help customers determine their exposure to vulnerabilities in Cisco NX-OS Software, Cisco provides the [Cisco Software Checker](https://sec.cloudapps.cisco.com/security/center/softwarechecker.x). This tool identifies any Cisco security advisories that impact a specific software release and the earliest release that fixes the vulnerabilities that are described in each advisory (“First Fixed”). If applicable, the tool also returns the earliest release that fixes all the vulnerabilities described in all the advisories that the Software Checker identifies (“Combined First Fixed”).  To use the tool, go to the [Cisco Software Checker](https://sec.cloudapps.cisco.com/security/center/softwarechecker.x) page and follow the instructions. Alternatively, use the following form to search for vulnerabilities that affect a specific software release. To use the form, follow these steps:    1. Choose which advisories the tool will search-only this advisory, only advisories with a Critical or High [Security Impact Rating (SIR)](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#asr), or all advisories.   2. Choose the appropriate software.   3. Choose the appropriate platform.   4. Enter a release number-for example, **7.0(3)I7(5)** for Cisco Nexus 3000 Series Switches or **14.0(1h)** for Cisco NX-OS Software in ACI mode.   5. Click **Check**.        Only this advisory   All Critical and High advisories   All advisories   Cisco NX-OS Software   Cisco NX-OS Software in ACI Mode   Any Platform   MDS 9000 Series Multilayer Switches   Nexus 1000V Series Switches   Nexus 3000 Series Switches   Nexus 5000 Series Switches   Nexus 6000 Series Switches   Nexus 7000 Series Switches   Nexus 9000 Series Switches          Additional Resources For help determining the best Cisco NX-OS Software release for a Cisco Nexus Switch, see the following Recommended Releases documents. If a security advisory recommends a later release, Cisco recommends following the advisory guidance.  [Cisco MDS Series Switches](https://www.cisco.com/c/en/us/td/docs/switches/datacenter/mds9000/sw/b_MDS_NX-OS_Recommended_Releases.html)[Cisco Nexus 1000V for VMware Switch](http://www.cisco.com/c/en/us/td/docs/switches/datacenter/nexus1000/sw/recommended_releases/b_Cisco_N1KV_VMware_MinRecommendedReleases.html)[Cisco Nexus 3000 Series Switches](http://www.cisco.com/c/en/us/td/docs/switches/datacenter/nexus3000/sw/recommended_release/b_Minimum_and_Recommended_Cisco_NX-OS_Releases_for_Cisco_Nexus_3000_Series_Switches.html)[Cisco Nexus 5500 Platform Switches](http://www.cisco.com/c/en/us/td/docs/switches/datacenter/nexus5500/sw/release/recommended_releases/n5500_recommended_nx-os_releases.html)[Cisco Nexus 5600 Platform Switches](https://www.cisco.com/c/en/us/td/docs/switches/datacenter/nexus5600/sw/release/recommended_releases/n5600_recommended_nx-os_releases.html)[Cisco Nexus 6000 Series Switches](http://www.cisco.com/c/en/us/td/docs/switches/datacenter/nexus6000/sw/release/recommended_releases/recommended_nx-os_releases.html)[Cisco Nexus 7000 Series Switches](http://www.cisco.com/c/en/us/td/docs/switches/datacenter/sw/nx-os/recommended_releases/recommended_nx-os_releases.html)[Cisco Nexus 9000 Series Switches](http://www.cisco.com/c/en/us/td/docs/switches/datacenter/nexus9000/sw/recommended_release/b_Minimum_and_Recommended_Cisco_NX-OS_Releases_for_Cisco_Nexus_9000_Series_Switches.html)[Cisco Nexus 9000 Series ACI-Mode Switches](https://www.cisco.com/c/en/us/td/docs/switches/datacenter/aci/apic/sw/recommended-release/b_Recommended_Cisco_ACI_Releases.html)  To determine the best release for Cisco UCS Software, see the Recommended Releases documents in the release notes for the device.  Exploitation and Public Announcements  * In April 2024, the Cisco Product Security Incident Response Team (PSIRT) became aware of attempted exploitation of this vulnerability in the wild.  Source  * Cisco would like to thank Sygnia for reporting this vulnerability. Tristan Van Egroo of the Cisco Advanced Security Initiatives Group (ASIG) investigated this vulnerability.  Cisco Security Vulnerability Policy  * To learn about Cisco security vulnerability disclosure policies and publications, see the [Security Vulnerability Policy](http://www.cisco.com/web/about/security/psirt/security_vulnerability_policy.html). This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.  Subscribe to Cisco Security Notifications  * [Subscribe](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html)  Related to This Advisory    URL  * <https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-nxos-cmd-injection-xD9OhyOP>  Revision History  * | Version | Description | Section | Status | Date |   | --- | --- | --- | --- | --- |   | 1.3 | Removed references to upcoming fixed releases because they are all available now. Updated the list of vulnerable PIDs. | Summary and Vulnerable Products | Final | 2024-SEP-17 |   | 1.2 | Further clarified the condition under which exploitation can occur and added products that are not vulnerable. | Summary, Vulnerable Products, Products Confirmed Not Vulnerable, Details | Final | 2024-JUL-03 |   | 1.1 | Updated to explain that fixes are available for some products and others will be released as they become available. | Summary | Final | 2024-JUL-02 |   | 1.0 | Initial public release. | - | Final | 2024-JUL-01 |      Show Less  ---   Legal Disclaimer  * THIS DOCUMENT IS PROVIDED ON AN "AS IS" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE. YOUR USE OF THE INFORMATION ON THE DOCUMENT OR MATERIALS LINKED FROM THE DOCUMENT IS AT YOUR OWN RISK. CISCO RESERVES THE RIGHT TO CHANGE OR UPDATE THIS DOCUMENT AT ANY TIME.  A standalone copy or paraphrase of the text of this document that omits the distribution URL is an uncontrolled copy and may lack important information or contain factual errors. The information in this document is intended for end users of Cisco products.   Feedback  * Leave additional feedback     Cisco Security Vulnerability Policy  * To learn about Cisco security vulnerability disclosure policies and publications, see the [Security Vulnerability Policy](http://www.cisco.com/web/about/security/psirt/security_vulnerability_policy.html). This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.  Subscribe to Cisco Security Notifications  * [Subscribe](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html)  Related to This Advisory |        | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |


