```
{
  "vulnerability": {
    "root_cause": "The mass storage function in the Linux kernel tries to queue a request from the main thread, but another thread might have already disabled the endpoint when the function disables.",
    "weaknesses": [
      "Race condition where a thread attempts to queue a request to a USB endpoint that has been disabled by another thread."
    ],
    "impact": "The original code generated a warning message when attempting to queue a request to a disabled endpoint. This was not a functional issue. This patch changes the warning to a debug message and also returns -ESHUTDOWN.",
    "attack_vectors": [
      "A malicious USB mass storage device can attempt to exploit the race condition by sending requests to a disabled endpoint. However, this does not seem to lead to privilege escalation or denial of service."
    ],
    "required_capabilities": "A malicious USB mass storage device is required to trigger the race condition."
  },
  "fixes": [
    {
      "commit": "36177c2595df12225b95ce74eb1ac77b43d5a58c",
      "description": "Changed WARN_ON_ONCE() in usb_ep_queue() to pr_debug()."
    },
    {
      "commit": "2a587a035214fa1b5ef598aea0b81848c5b72e5e",
      "description": "Changed WARN_ON_ONCE() in usb_ep_queue() to pr_debug()."
    },
        {
      "commit": "3e944ddc17c042945d983e006df7860687a8849a",
      "description": "Changed WARN_ON_ONCE() in usb_ep_queue() to pr_debug()."
    },
        {
      "commit": "99731076722eb7ed26b0c87c879da7bb71d24290",
      "description": "Changed WARN_ON_ONCE() in usb_ep_queue() to pr_debug()."
    },
        {
      "commit": "68d951880d0c52c7f13dcefb5501b69b8605ce8c",
      "description": "Changed WARN_ON_ONCE() in usb_ep_queue() to pr_debug()."
    },
        {
      "commit": "2b002c308e184feeaeb72987bca3f1b11e5f70b8",
      "description": "Changed WARN_ON_ONCE() in usb_ep_queue() to pr_debug()."
    },
       {
      "commit": "30511676eb54d480d014352bf784f02577a10252",
      "description": "Changed WARN_ON_ONCE() in usb_ep_queue() to pr_debug()."
    },
        {
      "commit": "df5cbb908f1687e8ab97e222a16b7890d5501acf",
      "description": "Changed WARN_ON_ONCE() in usb_ep_queue() to pr_debug()."
    },
        {
      "commit": "f74c5e0b54b02706d9a862ac6cddade30ac86bcf",
      "description": "Changed WARN_ON_ONCE() in usb_ep_queue() to pr_debug()."
    }

  ],
    "cve": "CVE-2024-35822"
}
```