The content is related to CVE-2024-3077.

**Root cause of vulnerability:**
- The vulnerability lies in the `gatt_find_info_rsp` function within the Zephyr RTOS Bluetooth stack. It occurs due to improper handling of the length parameter when parsing GATT packets, leading to an integer underflow and invalid memory access.
- Specifically, the length of the packet is decremented without checking if it's already zero, causing an underflow to `0xFFFF` when the initial length is 0.

**Weaknesses/vulnerabilities present:**
- **Integer underflow:** The `length--` operation without a prior check for zero leads to an integer underflow when the length parameter is zero.
- **Invalid pointer dereference:** The for loop iterates based on `length / len` and calculates a new pointer `pdu` by incrementing the current pdu by `len`, and due to the integer underflow mentioned above, this may lead to an invalid memory address. This invalid `pdu` is dereferenced later (`info.i16 = pdu; handle = sys_le16_to_cpu(info.i16->handle);`) leading to crashes.

**Impact of exploitation:**
- A malicious BLE device can crash a vulnerable BLE device. This can be achieved by sending a malformed GATT packet that causes the `length` parameter in the vulnerable function to be zero.

**Attack vectors:**
- The attack vector is adjacent (A). The attacker needs to be within the Bluetooth range of the vulnerable device.
- The attacker sends a crafted/malformed BLE packet to the vulnerable device triggering the vulnerability in `gatt_find_info_rsp` function.

**Required attacker capabilities/position:**
- The attacker must be a BLE device capable of sending GATT packets to the target device.
- The attacker needs to have low privileges to trigger the vulnerability
- No user interaction is required.