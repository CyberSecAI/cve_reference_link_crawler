<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="">
<meta name="description" content="Vulnerability Properties Title: Shopkit 1.0 is vulnerable to an integer Overflow on add to cart functionality
CVE ID: CVE-2023-45854
CVSSv3 Base Score: 7.5
CVSSv3.1 Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
Vendor: Shopkit
Advisory Release Date: 14-09-24
Vulnerability Summary A critical vulnerability has been identified in the add-to-cart functionality of Shopkit. The vulnerability occurs due to an integer overflow caused by the system&rsquo;s inability to accurately process and store large values, allowing attackers to manipulate the cart&rsquo;s contents." />
<meta name="keywords" content=", blog, businessLogic" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://kafka-esc.com/posts/2024/09/cve-2023-45854-interger-overflow-in-shopkit-1.0/" />



    <title>
        
            CVE-2023-45854 - Interger Overflow in Shopkit 1.0 :: [KafkaEsc] 
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.5c821d626e2f5bf848ce9331ce39856890e28e88bc072abdbddf51295122b80d.css">




    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="/favicon.ico">
    <meta name="msapplication-TileColor" content="">
    <meta name="theme-color" content="">




  <meta itemprop="name" content="CVE-2023-45854 - Interger Overflow in Shopkit 1.0">
  <meta itemprop="description" content="Vulnerability Properties Title: Shopkit 1.0 is vulnerable to an integer Overflow on add to cart functionality
CVE ID: CVE-2023-45854
CVSSv3 Base Score: 7.5
CVSSv3.1 Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
Vendor: Shopkit
Advisory Release Date: 14-09-24
Vulnerability Summary A critical vulnerability has been identified in the add-to-cart functionality of Shopkit. The vulnerability occurs due to an integer overflow caused by the system’s inability to accurately process and store large values, allowing attackers to manipulate the cart’s contents.">
  <meta itemprop="datePublished" content="2024-09-14T00:00:00+00:00">
  <meta itemprop="dateModified" content="2024-09-24T11:08:32+00:00">
  <meta itemprop="wordCount" content="248">
  <meta itemprop="image" content="https://kafka-esc.com/d4hzf6a-cf291fb5-d8ff-4dcc-8381-30acb13cb09d.png">
  <meta itemprop="keywords" content="Blog,BusinessLogic">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://kafka-esc.com/d4hzf6a-cf291fb5-d8ff-4dcc-8381-30acb13cb09d.png">
  <meta name="twitter:title" content="CVE-2023-45854 - Interger Overflow in Shopkit 1.0">
  <meta name="twitter:description" content="Vulnerability Properties Title: Shopkit 1.0 is vulnerable to an integer Overflow on add to cart functionality
CVE ID: CVE-2023-45854
CVSSv3 Base Score: 7.5
CVSSv3.1 Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
Vendor: Shopkit
Advisory Release Date: 14-09-24
Vulnerability Summary A critical vulnerability has been identified in the add-to-cart functionality of Shopkit. The vulnerability occurs due to an integer overflow caused by the system’s inability to accurately process and store large values, allowing attackers to manipulate the cart’s contents.">



    <meta property="og:url" content="https://kafka-esc.com/posts/2024/09/cve-2023-45854-interger-overflow-in-shopkit-1.0/">
  <meta property="og:site_name" content="[KafkaEsc]">
  <meta property="og:title" content="CVE-2023-45854 - Interger Overflow in Shopkit 1.0">
  <meta property="og:description" content="Vulnerability Properties Title: Shopkit 1.0 is vulnerable to an integer Overflow on add to cart functionality
CVE ID: CVE-2023-45854
CVSSv3 Base Score: 7.5
CVSSv3.1 Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
Vendor: Shopkit
Advisory Release Date: 14-09-24
Vulnerability Summary A critical vulnerability has been identified in the add-to-cart functionality of Shopkit. The vulnerability occurs due to an integer overflow caused by the system’s inability to accurately process and store large values, allowing attackers to manipulate the cart’s contents.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-09-14T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-09-24T11:08:32+00:00">
    <meta property="article:tag" content="Blog">
    <meta property="article:tag" content="BusinessLogic">
    <meta property="og:image" content="https://kafka-esc.com/d4hzf6a-cf291fb5-d8ff-4dcc-8381-30acb13cb09d.png">




    <meta property="article:section" content="CVEs" />

    <meta property="article:section" content="articles" />



    <meta property="article:published_time" content="2024-09-14 00:00:00 &#43;0000 UTC" />









    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark"> </span>
            <span class="logo__text">/home/KafkaEsc</span>
            <span class="logo__cursor" style=
                  "visibility:hidden;
                   background-color:#67a2c9;
                   animation-duration:3s;">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner">
                <li><a href="/about/">About</a></li>
                <li><a href="/posts/">Posts</a></li>
                <div class="submenu">
                    <li class="dropdown">
                        <a href="/categories/" class="dropbtn">Hacking</a>
                        <label class="drop-icon" for="Hacking">▾</label>
                        <div class="dropdown-content">
                                
                                    <a title="Articles" href="/categories/articles/">Articles</a>
                                
                                    <a title="Write Ups" href="/categories/writeups/">Write Ups</a>
                                
                                    <a title="CVEs" href="/categories/cves/">CVEs</a>
                                
                        </div>
                    </li>
                </div>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
                <span class="theme-toggle not-selectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
   <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
   3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
   13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
 </svg></span>
        </span>
    </span>
</header>


            <div class="content">
                
  <main class="post">

    <div class="post-info">
      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock">
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
        2 minutes

        
      </p>
    </div>

    <article>
      <h1 class="post-title">
        <a href="https://kafka-esc.com/posts/2024/09/cve-2023-45854-interger-overflow-in-shopkit-1.0/">CVE-2023-45854 - Interger Overflow in Shopkit 1.0</a>
      </h1>

      

      

      

      <div class="post-content">
        <h2 id="vulnerability-properties">Vulnerability Properties</h2>
<p><strong>Title:</strong> Shopkit 1.0 is vulnerable to an integer Overflow on add to cart functionality<br>
<strong>CVE ID:</strong> <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-45854">CVE-2023-45854</a><br>
<strong>CVSSv3 Base Score:</strong> 7.5<br>
<strong>CVSSv3.1 Vector:</strong> <code>CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N</code><br>
<strong>Vendor:</strong> Shopkit<br>
<strong>Advisory Release Date:</strong> 14-09-24</p>
<h2 id="vulnerability-summary">Vulnerability Summary</h2>
<p>A critical vulnerability has been identified in the <strong>add-to-cart</strong> functionality of Shopkit. The vulnerability occurs due to an integer overflow caused by the system&rsquo;s inability to accurately process and store large values, allowing attackers to manipulate the cart&rsquo;s contents. This flaw enables malicious actors to introduce negative values into the cart, resulting in unauthorized modifications to the total amount due.</p>
<h2 id="proof-of-concept">Proof of Concept</h2>
<p>The vulnerable component is the <strong>add-to-cart</strong> functionality:</p>
<p><img src="/img/archive/add_cart_browser.png" alt=""></p>
<p>This sends a POST request to <code>/cart/add</code> with the parameter <code>qtd</code> (quantity).</p>
<p><img src="/img/archive/Pasted%20image%2020240914162757.png" alt=""></p>
<p>Changing the value of this parameter to a very big integer causes the quantity to overflow and display a negative number.</p>
<p><img src="/img/archive/Pasted%20image%2020240914162615.png" alt=""></p>
<p>The offset can be calculated by subtracting the absolute value of the current quantity by the absolute value of the pretended quantity.</p>
<p>Adding that value to the cart:</p>
<p><img src="/img/archive/Pasted%20image%2020240914162859.png" alt=""></p>
<p>This will result on a quantity of <code>-1</code>.</p>
<p><img src="/img/archive/Pasted%20image%2020240914162941.png" alt=""></p>
<h3 id="impact">Impact</h3>
<p>When attackers can manipulate the cart&rsquo;s contents by adding negative values, it means they can effectively &ldquo;remove&rdquo; items from the cart without actually removing them. This can have severe consequences for merchants.</p>
<h2 id="vulnerable-versions">Vulnerable Versions</h2>
<ul>
<li>Shopkit 1.0  from before 13/12/23</li>
</ul>
<h2 id="solution">Solution</h2>
<ul>
<li>Update to the latest version.</li>
</ul>
<h2 id="vulnerability-timeline">Vulnerability Timeline</h2>
<ul>
<li>05/08/23 - Bug reported to vendor</li>
<li>11/08/23 - Bug validated by vendor</li>
<li>13/12/23 - Patch released by vendor</li>
<li>14/09/24 - Advisory released</li>
</ul>
<h2 id="references">References</h2>
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/840.html">https://cwe.mitre.org/data/definitions/840.html</a></li>
<li><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-45854">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-45854</a></li>
<li><a href="https://owasp.org/www-community/vulnerabilities/Business_logic_vulnerability">https://owasp.org/www-community/vulnerabilities/Business_logic_vulnerability</a></li>
<li><a href="https://portswigger.net/web-security/logic-flaws">https://portswigger.net/web-security/logic-flaws</a></li>
</ul>

      </div>
    </article>

    

    <div class="post-info">
      
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        
        
                <span class="tag"><a href="https://kafka-esc.com/tags/businesslogic/">businessLogic</a></span>
            
        
    </p>

      
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder meta-icon"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>

        <span class="tag"><a href="https://kafka-esc.com/categories/cves/">CVEs</a></span>
        <span class="tag"><a href="https://kafka-esc.com/categories/articles/">articles</a></span>
        
    </p>


      
    </div>

    

    
    <div class="pagination">
        <div class="pagination__title">
            <span class="pagination__title-h"></span>
            <hr />
        </div>

        <div class="pagination__buttons">
            
            <span class="button previous">
                <a href="https://kafka-esc.com/posts/2024/09/mcrtp-review/">
                    <span class="button__icon">←</span>
                    <span class="button__text">MCRTP Review</span>
                </a>
            </span>
            

            
            <span class="button next">
                <a href="https://kafka-esc.com/posts/2024/09/getting-microburst-working-on-linux/">
                    <span class="button__text">Getting Microburst working on Linux</span>
                    <span class="button__icon">→</span>
                </a>
            </span>
            
        </div>
    </div>



    

    

  </main>

            </div>

            
                <footer class="footer">
    
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>V2UncmUgYWxsIG1hZCBoZXJlLgo=</span>
        </div>
    </div>
    
</footer>

            
        </div>

        


<script type="text/javascript" src="/bundle.min.234deadcc884d4680ca3aca6c399e1b8be43e2dda3246bee583704b9b34b6c9e15c08c09655d87968efb503e980f888fcdc8b8685654ca9b8e9aa6cd23dd2080.js" integrity="sha512-I03q3MiE1GgMo6ymw5nhuL5D4t2jJGvuWDcEubNLbJ4VwIwJZV2Hlo77UD6YD4iPzci4aFZUypuOmqbNI90ggA=="></script>



    </body>
</html>
