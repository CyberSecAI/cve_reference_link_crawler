




<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
  <title>
    
      
        Authenticated Insecure Direct Object Reference in Kentico CMS (CVE-2022-29287) | Offensity
      
    
  </title>
  <meta name="description" content="
    Security reports: efficient and straightforward. The simplest way to detect and fix vulnerabilities
    ">

  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  

<link rel="icon"                             href="/static/img/favicons/favicon.b40bcf662e92.ico"       type="image/png" >
<link rel="icon"             sizes="32x32"   href="/static/img/favicons/favicon-32x32.c04ea7432641.png" type="image/png">
<link rel="icon"             sizes="16x16"   href="/static/img/favicons/favicon-16x16.1b9f9ac10ab2.png" type="image/png">
<link rel="apple-touch-icon" sizes="180x180" href="/static/img/favicons/apple-touch-icon.d4292be8229c.png">

<link rel="mask-icon" href="/static/img/favicons/safari-pinned-tab.a6b1f8bf6958.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#2b5797">
<meta name="theme-color" content="#ffffff">


  
    

<meta property="og:image" content="https://www.offensity.com/static/img/2022/main-hero-image.b0185c5d2276.png" />
<meta property="og:title" name="title" content="
  
    
      Authenticated Insecure Direct Object Reference in Kentico CMS (CVE-2022-29287) | Offensity
    
  
">


  

  <link href="/static/css/helper-webflow.1c0c27591bcf.css" rel="stylesheet">
  <link href="/static/css/normalize.25b2e0265584.css" rel="stylesheet">
  <link href="/static/css/webflow.f4371e634c74.css" rel="stylesheet">
  <link href="/static/css/offensity.webflow.11401112c5de.css" rel="stylesheet">

  
  <link href="/static/css/pages.77be530408bb.css" rel="stylesheet">


  <link rel="canonical" href="https://www.offensity.com/en/blog/authenticated-insecure-direct-object-reference-in-kentico-cms-cve-outstanding/">

  
  
</head>
<body class="blog-page body">

  <!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-ND88VML"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

  

  
    
  

  
    





<div data-animation="over-right" data-collapse="medium" data-duration="400" data-easing="ease" data-easing2="ease"
     role="banner" class="navbar w-nav">
  <div class="navbar-container w-container">
    <div class="navbar-wrapper">
      <a href="/en/" title="offensity.com/en/" aria-current="page"
         class="brand w-nav-brand w--current"><img
        src="/static/img/2022/offensity-logo.a280f1ac3bd0.svg" loading="lazy" alt="logo" class="logo-image"></a>
      <nav role="navigation" class="nav-menu w-nav-menu">
        <div class="close-menu w-nav-button"><img src="/static/img/2022/mobile-close-icon.4e1cdcd5d2cd.svg" loading="lazy"
                                                  alt="close"></div>
        <div class="links-wrapper">
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          



  
    
      <a href="/en/solution/"
         class="nav-link w-nav-link">
        Solution
      </a>
    
  

  
    
      <a href="/en/pricing/"
         class="nav-link w-nav-link">
        Pricing
      </a>
    
  

  
    
      <a href="/en/demo/" target="_blank"
         class="nav-link w-nav-link">
        Demo
      </a>
    
  

  


        </div>
        <div class="nav-buttons mobile">
          <div class="lang-wrapper">
            <a href="/de/"
               class=" lang-switcher ">DE</a>
            <a href="/en/"
               class=" lang-switcher w--current ">EN</a>
          </div>
          
            <a href="https://reporting.offensity.com" class="default-button margin-right w-button">
              Offensity Login ↗
            </a>
          
          <a href="/en/signup/" class="default-button style-2 w-button">Get it free</a>
        </div>
      </nav>
      <div class="nav-buttons">
        <a href="/de/"
           class=" lang-switcher ">DE</a>
        <a href="/en/"
           class=" lang-switcher w--current ">EN</a>
        
          <a href="https://reporting.offensity.com" class="default-button margin-right w-button">
            Offensity Login ↗
          </a>
        
        



      <a href="/en/try-offensity-for-free/"
         class="default-button style-2 w-button">
        Try for free
      </a>



      </div>
      <div class="menu-button-2 w-nav-button"><img src="/static/img/2022/mobile-burger-menu.0fe3faa0a176.svg" loading="lazy"
                                                   width="30" alt="burger-menu"></div>
    </div>
  </div>
</div>

  

  

  <div class="hero-section-champaign wf-section">
    <div class="container-default w-container">
      <h1 class="heading">Authenticated Insecure Direct Object Reference in Kentico CMS (CVE-2022-29287)</h1>
      <p class="hero-text mt-15">
        
          <strong>Gabor Szivos, April 11, 2022</strong>
          </p>
    </div>

  </div>



  <main role="main" class="body">
    
  
    <div class="container-default w-container">
      <div class="block-paragraph_block"><p data-block-key="dw7sh">During a security assessment for one of our customers we identified a vulnerability with a CVSS of 4.9 (CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N) in the deployed version (13.0.44) of the Kentico CMS. According to the published release notes this vulnerability seems to effect newer versions of the software as well. This vulnerability would allow an administrator to access sensitive data of higher privileged users like a global administrator.</p><p data-block-key="9ssiq">A user with the role administrator is allowed to export another user’s settings if its privileges are lower than the currently logged in user. This basically means that a global administrator could export the settings of any other user and an administrator could export the settings of its own account and that of any user which has the role editor or none. Editors are not allowed to export or view other users unless explicitly enabled.</p><p data-block-key="a97qn">The export functionality is divided into two different steps. First the system verifies that the user has the necessary rights to export the target user’s settings - the target user is defined by the URL parameter objectId. If the current user is authorized to export the account of the target user, the currently logged in user is asked to provide the name of the file which will contain the exported settings. The parameters of the second step are sent to the server via a POST request. The ID of the target user is still sent via the previously mentioned URL parameter and the name of the file is sent via the POST body as the parameter m$c$txtFileName (URL-Encoded).</p><p data-block-key="2l2la">The following screenshot shows, that if an unauthorized user (e.g. an administrator) tries to start the export process by providing the ID of a global administrator the server rejects this request. In this case the objectId 78 belongs to a global administrator.</p>
</div>
<div class="block-image_block">
  <figure>
    






<img alt=""
     src="https://sos-at-vie-1.exo.io/offensity-www-media/images/user_export_first_step.width-320.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250105%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250105T165844Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=060e64229c204705dd36e794efd271b97f19530b736860440dbb21e0462fa18f"
     sizes="100vw" class="full-width"

   srcset="https://sos-at-vie-1.exo.io/offensity-www-media/images/user_export_first_step.width-320.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250105%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250105T165844Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=060e64229c204705dd36e794efd271b97f19530b736860440dbb21e0462fa18f 320w,
           https://sos-at-vie-1.exo.io/offensity-www-media/images/user_export_first_step.width-640.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250105%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250105T165844Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=da9b736a13817d339df2930126c4335a62e70ba4751e3632e1b06bd7e675b5a1 640w,
           https://sos-at-vie-1.exo.io/offensity-www-media/images/user_export_first_step.width-930.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250105%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250105T165844Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=73ad8085585cc322ac2d6fb0d084f879745beb0b930f9f8df2db7840a40b62b6 930w">

    <figcaption>An Administrator tries to export a user with global administrator rights</figcaption>
  </figure>
</div>
<div class="block-paragraph_block"><p data-block-key="dw7sh">However, the first step is completely irrelevant if it is known how the second request looks like. As the following screenshot demonstrates it was possible to export the global administrator’s settings with a lower privileged user even though the server states that the current user is not authorized to do so.</p>
</div>
<div class="block-image_block">
  <figure>
    






<img alt=""
     src="https://sos-at-vie-1.exo.io/offensity-www-media/images/create_new_export.width-320.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250105%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250105T165844Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=20a7eff44e303d5a9e40037498a38b25545d1ec452ac07ddc06fd017598ba0f3"
     sizes="100vw" class="full-width"

   srcset="https://sos-at-vie-1.exo.io/offensity-www-media/images/create_new_export.width-320.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250105%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250105T165844Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=20a7eff44e303d5a9e40037498a38b25545d1ec452ac07ddc06fd017598ba0f3 320w,
           https://sos-at-vie-1.exo.io/offensity-www-media/images/create_new_export.width-640.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250105%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250105T165844Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=060db796aad92b14a85f2b8135423ce0a33c208d1a0ec5dba70ae5d5473b64b7 640w,
           https://sos-at-vie-1.exo.io/offensity-www-media/images/create_new_export.width-930.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250105%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250105T165844Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=ea88511014dee46e95a569c065bc3c806576c503ad982dd06084e356b349d29e 930w">

    <figcaption>Ignoring the first step of the export process allows the any user with user management rights to export any other user</figcaption>
  </figure>
</div>
<div class="block-paragraph_block"><p data-block-key="dw7sh">By knowing the name of the file – as it was provided by the user itself – it is possible to download this file – a ZIP containing several export related data - as it can be seen on the following screenshot.</p>
</div>
<div class="block-image_block">
  <figure>
    






<img alt=""
     src="https://sos-at-vie-1.exo.io/offensity-www-media/images/download_zip.width-320.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250105%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250105T165844Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=e2cc6ee797dd2ca56ab1003a11021f2e7b12959152a17634be7cbfdc2e948493"
     sizes="100vw" class="full-width"

   srcset="https://sos-at-vie-1.exo.io/offensity-www-media/images/download_zip.width-320.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250105%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250105T165844Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=e2cc6ee797dd2ca56ab1003a11021f2e7b12959152a17634be7cbfdc2e948493 320w,
           https://sos-at-vie-1.exo.io/offensity-www-media/images/download_zip.width-640.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250105%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250105T165844Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=5d200c9b397df24e4b96c3765da89788a8b73dd0ba984229a7534786bd4b8232 640w,
           https://sos-at-vie-1.exo.io/offensity-www-media/images/download_zip.width-930.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250105%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250105T165844Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=c3a40239b59fb3fc829630d092e60caae5543116374ae4a9d009ac345f5f69e4 930w">

    <figcaption>Knowing the name of the file allows the user to download the exported files</figcaption>
  </figure>
</div>
<div class="block-paragraph_block"><p data-block-key="dw7sh">After downloading ZIP and extracting the data in it, it was possible to gain access to highly sensitive data like the hashed password of the user.</p>
</div>
<div class="block-image_block">
  <figure>
    






<img alt=""
     src="https://sos-at-vie-1.exo.io/offensity-www-media/images/user_export.width-320.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250105%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250105T165844Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=69460de6dbcecbb3ed9f716a4fb60be9870c632e829c57a928e27bfb477f5142"
     sizes="100vw" class="full-width"

   srcset="https://sos-at-vie-1.exo.io/offensity-www-media/images/user_export.width-320.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250105%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250105T165844Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=69460de6dbcecbb3ed9f716a4fb60be9870c632e829c57a928e27bfb477f5142 320w,
           https://sos-at-vie-1.exo.io/offensity-www-media/images/user_export.width-640.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250105%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250105T165844Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=4f7be1a16560288a13c9ba481612dfa6e0a2d82569ce42d685666018b21f3537 640w,
           https://sos-at-vie-1.exo.io/offensity-www-media/images/user_export.width-930.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250105%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250105T165844Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=31a19d1900318090c4f47c4be905758ccf6d786b6120408f56244ffc0b561beb 930w">

    <figcaption>The exported user object as XML</figcaption>
  </figure>
</div>
<div class="block-paragraph_block"><p data-block-key="s6jil">The issue was disclosed privately to the vendor (Kentico) in the form of a responsible disclosure. After some internal analysis they confirmed the existence of the vulnerability and released a hotfix (<a href="https://devnet.kentico.com/download/hotfixes">13.0.66</a>) on 11.04.2022 which resolves this issue. Although an attacker has to have access to the software to exploit this vulnerability we would recommend to update to the newest version nevertheless.</p><p data-block-key="5fcls"></p><p data-block-key="28a0t"><s>A CVE number has been requests. As soon as it is assigned this article will be updated.</s></p><p data-block-key="cjrgv"></p><p data-block-key="62m5q"><b>Update 19.04.2022:</b> The CVE number CVE-2022-29287 has been assigned to this issue</p>
</div>

      
      

      
    </div>
  

  </main>

  
    

<div class="section wf-section">
  <div class="container-extra-small w-container">
    <div class="banner tracking-banner">
      <div class="container center-container">
        <div class="row">
          <div class="col-sm-10">
            <p>
              
                This website uses cookies and other technology to customize advertising
                and provide you a more personalized experience. To find out more,
                see our <a href="/en/privacy/">Privacy Policy</a>.
              
            </p>
            <p>
              
                Unless you explicitly allow tracking, your data will not be collected using Google Analytics.
              
            </p>

          </div>
          <div class="col-sm-2">
            <button class="js-tracking-accept default-button style-2 w-button btn-center" >
              Allow tracking</button>
            <button class="js-tracking-deny default-button">
              Do not track</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>


  

  
    



<div class="footer-wrapper wf-section">
    <div class="wrap">
      <div class="w-layout-grid footer">
        <a id="w-node-ac901f39-8c9e-5153-0f09-5850d60c738e-d2795924" href="/" class="w-inline-block"><img src="/static/img/2022/offensity-logo-white.2ee1a7096670.svg" loading="lazy" id="w-node-_61e74489-159b-d7fd-84ba-75aed2795927-d2795924" alt="" class="footer-image"></a>
        <div id="w-node-_61e74489-159b-d7fd-84ba-75aed2795928-d2795924" class="footer-grid-column">
          <div id="w-node-_61e74489-159b-d7fd-84ba-75aed2795929-d2795924" class="label w-inline-block">Product</div>
          <a href="/login" class="footer-link">Offensity</a>
        </div>
        




        <div id="w-node-_61e74489-159b-d7fd-84ba-75aed2795931-d2795924" class="footer-grid-column">
          <div id="w-node-_61e74489-159b-d7fd-84ba-75aed279593b-d2795924" class="label w-inline-block">Resources</div>
          <a href="/en/blog/" class="footer-link">Blog</a>
          <a href="/en/faq/" class="footer-link">FAQ</a>
        </div>
        <div id="w-node-_61e74489-159b-d7fd-84ba-75aed2795943-d2795924" class="footer-grid-column">
          <div id="w-node-_61e74489-159b-d7fd-84ba-75aed2795944-d2795924" class="label w-inline-block">About</div>
          <a href="https://a1.digital/" target="_blank" class="footer-link">A1 Digital</a>
          <a href="/en/team" class="footer-link">About Us</a>
        </div>
        <div id="w-node-_61e74489-159b-d7fd-84ba-75aed279594c-d2795924" class="footer-grid-column">
          <div id="w-node-_61e74489-159b-d7fd-84ba-75aed279594d-d2795924" class="label w-inline-block">Germany</div>
          <div class="footer-text">St. Martin Straße 59<br>81669 Munich<br>Germany</div>
        </div>
        <div id="w-node-_61e74489-159b-d7fd-84ba-75aed2795955-d2795924" class="footer-grid-column">
          <div class="label w-inline-block">Austria</div>
          <div class="footer-text">Lassallestraße 9<br>1020 Vienna<br>Austria</div>
        </div>
        <div id="w-node-_61e74489-159b-d7fd-84ba-75aed279595e-d2795924" class="footer-grid-column">
          <div class="label w-inline-block"></div>
          <a href="/en/contact/" class="footer-link">Contact</a>
          <a href="/en/privacy/" class="footer-link">Privacy Policy</a>
          <a href="/en/imprint/" class="footer-link">Imprint</a>
        </div>
      </div>
    </div>
  </div>



  



  <script src="/static/js/vendor/jquery-3.5.1.min.12b69d0ae6c6.js"></script>
  <script src="/static/js/vendor/lottie-player.cfc909dd4bec.js"></script>
  <script src="/static/js/2022/webflow.a821adce20fc.js" async defer></script>
  <script src="/static/js/components/004_signup-combo.0091e42240a0.js"></script>
  <script src="/static/js/components/011_cookie-consent.673a7024175b.js"></script>


</body>


</html>
