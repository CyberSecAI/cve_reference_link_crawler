- **Root cause of vulnerability:** The vulnerability lies in the way GitLab sanitizes Gollum links, specifically in the `GollumTagsFilter`. The filter uses `node.content`, which emits plaintext, allowing injection of arbitrary HTML elements.
- **Weaknesses/vulnerabilities present:**
    - Stored Cross-Site Scripting (XSS): Malicious HTML and JavaScript code can be injected into the application and stored, later executing when a user views the affected content.
    - Content Security Policy (CSP) bypass: The injected script bypasses the CSP.
- **Impact of exploitation:** An attacker can execute arbitrary actions on behalf of a victim by injecting malicious JavaScript code into the comments, leading to potential account compromise or data theft.
- **Attack vectors:**
    - The attack vector is through the comment section in commit diff views.
    - An attacker injects HTML within a comment that includes a `data-diff-for-path` attribute pointing to a file containing JavaScript.
- **Required attacker capabilities/position:**
    - The attacker needs to be able to create a project and make a commit, or comment on an existing project.
    - The attacker needs to be able to create a public snippet with a JSON file containing a malicious script and get the raw URL.
    - The attacker needs to be able to post a comment with the crafted HTML injection in a commit diff view.