The provided content relates to CVE-2024-25385.

**Root cause of vulnerability:**
The vulnerability is a heap-use-after-free error in the `flv_close` function within the `flvmeta` library. This occurs because the `flv_read_video_tag` function incorrectly calls `flv_close` when encountering an end-of-file condition. This violates the intended ownership of the `flv_stream` object, leading to a double free when the caller also tries to close it.

**Weaknesses/vulnerabilities present:**
- Heap-use-after-free: The primary vulnerability is that the program attempts to access memory that has already been freed. This occurs in `flv_close` after `flv_read_video_tag` prematurely frees the stream.
- Violation of object ownership: The `flv_read_video_tag` function should not be closing a resource it does not own.

**Impact of exploitation:**
- Program crash: The heap-use-after-free leads to a program crash, as demonstrated by the AddressSanitizer report and GDB backtrace. This can lead to denial of service.

**Attack vectors:**
- Malicious FLV file: The vulnerability can be triggered by a specially crafted FLV file, which causes the program to call `flv_read_video_tag` and then trigger the premature close of the stream.

**Required attacker capabilities/position:**
- The attacker must be able to provide a malicious FLV file as input to the `flvmeta` program.