- **Root cause of vulnerability**: The vulnerability stems from the lack of proper validation of the `targetUrl` parameter in the `response.sendRedirect()` function calls within the login and logout route handlers of the AVSystem Unified Management Platform (UMP). Specifically, the application does not sanitize or validate the provided URL before using it in the redirect, allowing for an open redirect vulnerability.
- **Weaknesses/vulnerabilities present**: The primary vulnerability is an open redirect. The application uses user-controlled input (`url` and `redirectTo` parameters) to construct redirect URLs without proper validation.
- **Impact of exploitation**: An attacker can leverage this vulnerability to redirect authenticated users to malicious websites, potentially leading to phishing attacks, credential theft, or other malicious activities. In the provided example, an attacker could create a fake login page that harvests user credentials.
- **Attack vectors**: The attack vector is through HTTP GET requests to the `/auth/login` and `/auth/logout` endpoints of the web management interface. The attacker crafts a malicious URL with their chosen target URL using the `url` or `redirectTo` parameter, for example `auth/login?url=//www.attackerwebsite.com`.
- **Required attacker capabilities/position**: The attacker doesn't need specific privileges or position within the network. The attacker needs to craft a malicious link and convince a user to click it. The user must already be authenticated for the login redirect to occur, however the logout redirect is available to any user.