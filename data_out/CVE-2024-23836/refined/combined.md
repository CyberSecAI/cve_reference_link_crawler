=== Content from github.com_265124b0_20250110_202742.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOISF%2Fsuricata%2Fcommit%2Fcd035d59e3df157b606f4fe67324ea8e437be786)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOISF%2Fsuricata%2Fcommit%2Fcd035d59e3df157b606f4fe67324ea8e437be786)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=OISF%2Fsuricata)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[OISF](/OISF)
/
**[suricata](/OISF/suricata)**
Public

* [Notifications](/login?return_to=%2FOISF%2Fsuricata) You must be signed in to change notification settings
* [Fork
  1.5k](/login?return_to=%2FOISF%2Fsuricata)
* [Star
   4.8k](/login?return_to=%2FOISF%2Fsuricata)

* [Code](/OISF/suricata)
* [Pull requests
  71](/OISF/suricata/pulls)
* [Actions](/OISF/suricata/actions)
* [Security](/OISF/suricata/security)
* [Insights](/OISF/suricata/pulse)

Additional navigation options

* [Code](/OISF/suricata)
* [Pull requests](/OISF/suricata/pulls)
* [Actions](/OISF/suricata/actions)
* [Security](/OISF/suricata/security)
* [Insights](/OISF/suricata/pulse)

## Commit

[Permalink](/OISF/suricata/commit/cd035d59e3df157b606f4fe67324ea8e437be786)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

smtp: avoid creating empty transaction

[Browse files](/OISF/suricata/tree/cd035d59e3df157b606f4fe67324ea8e437be786)
Browse the repository at this point in the history

```
Ticket: 6477

So as to avoid ending up with too many empty transactions.

This happens when Suricata sees a DATA command in the current
transaction but did not have a confirmation response for it.
Then, if Suricata receives another DATA command, it will
create another new transaction, even if the previous one
is empty. And so, a malicious client can create many empty
transactions by just sending a repeated amount of DATA commands
without having a confirmation code for them.

Suricata cannot use state->current_command == SMTP_COMMAND_DATA
to prevent this attack and needs to resort to a new boolean
is_data because the malicious client may send another dummy command
after each DATA command.

This patch leaves only one call to SMTPTransactionCreate

(cherry picked from commit [61f2e4e](https://github.com/OISF/suricata/commit/61f2e4e1e5b34dfd8ae44d1c15253e2da65f6e6a))
```

* Loading branch information

[![@catenacyber](https://avatars.githubusercontent.com/u/35799796?s=40&v=4)](/catenacyber) [![@victorjulien](https://avatars.githubusercontent.com/u/32410611?s=40&v=4)](/victorjulien)

[catenacyber](/OISF/suricata/commits?author=catenacyber "View all commits by catenacyber")
authored and
[victorjulien](/OISF/suricata/commits?author=victorjulien "View all commits by victorjulien")
committed
Feb 6, 2024

1 parent
[f9de1cc](/OISF/suricata/commit/f9de1cca6182e571f1c02387dca6e695e55608af)

commit cd035d5

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**15 additions**
and
**26 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src

  + src/app-layer-smtp.c
    [app-layer-smtp.c](#diff-2211b552dfe681c733c77810415590ea78e61d8dbfc828fda8c9e5c9cb470610)
  + src/app-layer-smtp.h
    [app-layer-smtp.h](#diff-e1bb5985f5b1cdcd973f884c8276d67bd37482804ad2f08b75f474043212650d)

## There are no files selected for viewing

34 changes: 9 additions & 25 deletions

34
[src/app-layer-smtp.c](#diff-2211b552dfe681c733c77810415590ea78e61d8dbfc828fda8c9e5c9cb470610 "src/app-layer-smtp.c")

Show comments

[View file](/OISF/suricata/blob/cd035d59e3df157b606f4fe67324ea8e437be786/src/app-layer-smtp.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -819,7 +819,7 @@ static inline void SMTPTransactionComplete(SMTPState \*state) |
|  |  | { |
|  |  | DEBUG\_VALIDATE\_BUG\_ON(state->curr\_tx == NULL); |
|  |  | if (state->curr\_tx) |
|  |  | state->curr\_tx->done = 1; |
|  |  | state->curr\_tx->done = true; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
| Expand Down  Expand Up | | @@ -1215,36 +1215,19 @@ static int SMTPProcessRequest(SMTPState \*state, Flow \*f, AppLayerParserState \*ps |
|  |  | state->current\_command = SMTP\_COMMAND\_STARTTLS; |
|  |  | } else if (line->len >= 4 && SCMemcmpLowercase("data", line->buf, 4) == 0) { |
|  |  | state->current\_command = SMTP\_COMMAND\_DATA; |
|  |  | if (smtp\_config.raw\_extraction) { |
|  |  | if (state->tx\_cnt > 1 && !state->curr\_tx->done) { |
|  |  | // we did not close the previous tx, set error |
|  |  | SMTPSetEvent(state, SMTP\_DECODER\_EVENT\_UNPARSABLE\_CONTENT); |
|  |  | FileCloseFile(&tx->files\_ts, &smtp\_config.sbcfg, NULL, 0, FILE\_TRUNCATED); |
|  |  | tx = SMTPTransactionCreate(state); |
|  |  | if (tx == NULL) |
|  |  | return -1; |
|  |  | state->curr\_tx = tx; |
|  |  | TAILQ\_INSERT\_TAIL(&state->tx\_list, tx, next); |
|  |  | tx->tx\_id = state->tx\_cnt++; |
|  |  | } |
|  |  | if (state->curr\_tx->is\_data) { |
|  |  | // We did not receive a confirmation from server |
|  |  | // And now client sends a next DATA |
|  |  | SMTPSetEvent(state, SMTP\_DECODER\_EVENT\_UNPARSABLE\_CONTENT); |
|  |  | SCReturnInt(0); |
|  |  | } else if (smtp\_config.raw\_extraction) { |
|  |  | if (FileOpenFileWithId(&tx->files\_ts, &smtp\_config.sbcfg, state->file\_track\_id++, |
|  |  | (uint8\_t \*)rawmsgname, strlen(rawmsgname), NULL, 0, |
|  |  | FILE\_NOMD5 | FILE\_NOMAGIC) == 0) { |
|  |  | SMTPNewFile(tx, tx->files\_ts.tail); |
|  |  | } |
|  |  | } else if (smtp\_config.decode\_mime) { |
|  |  | if (tx->mime\_state) { |
|  |  | /\* We have 2 chained mails and did not detect the end |
|  |  | \* of first one. So we start a new transaction. \*/ |
|  |  | tx->mime\_state->state\_flag = PARSE\_ERROR; |
|  |  | SMTPSetEvent(state, SMTP\_DECODER\_EVENT\_UNPARSABLE\_CONTENT); |
|  |  | tx = SMTPTransactionCreate(state); |
|  |  | if (tx == NULL) |
|  |  | return -1; |
|  |  | state->curr\_tx = tx; |
|  |  | TAILQ\_INSERT\_TAIL(&state->tx\_list, tx, next); |
|  |  | tx->tx\_id = state->tx\_cnt++; |
|  |  | } |
|  |  | DEBUG\_VALIDATE\_BUG\_ON(tx->mime\_state); |
|  |  | tx->mime\_state = MimeDecInitParser(f, SMTPProcessDataChunk); |
|  |  | if (tx->mime\_state == NULL) { |
|  |  | return MIME\_DEC\_ERR\_MEM; |
| Expand All | | @@ -1260,6 +1243,7 @@ static int SMTPProcessRequest(SMTPState \*state, Flow \*f, AppLayerParserState \*ps |
|  |  | tx->msg\_tail = tx->mime\_state->msg; |
|  |  | } |
|  |  | } |
|  |  | state->curr\_tx->is\_data = true; |
|  |  | /\* Enter immediately data mode without waiting for server reply \*/ |
|  |  | if (state->parser\_state & SMTP\_PARSER\_STATE\_PIPELINING\_SERVER) { |
|  |  | state->parser\_state |= SMTP\_PARSER\_STATE\_COMMAND\_DATA\_MODE; |
| Expand Down | |  |

7 changes: 6 additions & 1 deletion

7
[src/app-layer-smtp.h](#diff-e1bb5985f5b1cdcd973f884c8276d67bd37482804ad2f08b75f474043212650d "src/app-layer-smtp.h")

Show comments

[View file](/OISF/suricata/blob/cd035d59e3df157b606f4fe67324ea8e437be786/src/app-layer-smtp.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -75,7 +75,12 @@ typedef struct SMTPTransaction\_ { |
|  |  |  |
|  |  | AppLayerTxData tx\_data; |
|  |  |  |
|  |  | int done; |
|  |  | /\*\* the tx is complete and can be logged and cleaned \*/ |
|  |  | bool done; |
|  |  | /\*\* the tx has seen a DATA command \*/ |
|  |  | // another DATA command within the same context |
|  |  | // will trigger an app-layer event. |
|  |  | bool is\_data; |
|  |  | /\*\* the first message contained in the session \*/ |
|  |  | MimeDecEntity \*msg\_head; |
|  |  | /\*\* the last message contained in the session \*/ |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `cd035d5`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOISF%2Fsuricata%2Fcommit%2Fcd035d59e3df157b606f4fe67324ea8e437be786) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_0a96f99b_20250110_202745.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOISF%2Fsuricata%2Fcommit%2Fe7e28822f473320658d6125f16ac3f0524baff01)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOISF%2Fsuricata%2Fcommit%2Fe7e28822f473320658d6125f16ac3f0524baff01)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=OISF%2Fsuricata)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[OISF](/OISF)
/
**[suricata](/OISF/suricata)**
Public

* [Notifications](/login?return_to=%2FOISF%2Fsuricata) You must be signed in to change notification settings
* [Fork
  1.5k](/login?return_to=%2FOISF%2Fsuricata)
* [Star
   4.8k](/login?return_to=%2FOISF%2Fsuricata)

* [Code](/OISF/suricata)
* [Pull requests
  71](/OISF/suricata/pulls)
* [Actions](/OISF/suricata/actions)
* [Security](/OISF/suricata/security)
* [Insights](/OISF/suricata/pulse)

Additional navigation options

* [Code](/OISF/suricata)
* [Pull requests](/OISF/suricata/pulls)
* [Actions](/OISF/suricata/actions)
* [Security](/OISF/suricata/security)
* [Insights](/OISF/suricata/pulse)

## Commit

[Permalink](/OISF/suricata/commit/e7e28822f473320658d6125f16ac3f0524baff01)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

http1: configurable max number of live tx per flow

[Browse files](/OISF/suricata/tree/e7e28822f473320658d6125f16ac3f0524baff01)
Browse the repository at this point in the history

```
Ticket: [#5921](https://github.com/OISF/suricata/pull/5921)

Co-authored-by: Jason Ish <jason.ish@oisf.net>
(cherry picked from commit [4175680](https://github.com/OISF/suricata/commit/4175680a8a1c0dfaa491ee63d6e36c011d498473))
```

* Loading branch information

[![@catenacyber](https://avatars.githubusercontent.com/u/35799796?s=40&v=4)](/catenacyber) [![@victorjulien](https://avatars.githubusercontent.com/u/32410611?s=40&v=4)](/victorjulien)

[catenacyber](/OISF/suricata/commits?author=catenacyber "View all commits by catenacyber")
authored and
[victorjulien](/OISF/suricata/commits?author=victorjulien "View all commits by victorjulien")
committed
Feb 6, 2024

1 parent
[9795399](/OISF/suricata/commit/97953998d2d60673ed6c30ddfb6a2d59b4230f97)

commit e7e2882

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**21 additions**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* configure.ac
  [configure.ac](#diff-49473dca262eeab3b4a43002adb08b4db31020d190caaad1594b47f1d5daa810)
* doc/userguide/configuration

  + doc/userguide/configuration/suricata-yaml.rst
    [suricata-yaml.rst](#diff-2d0b91379c9e1f8f7c031ee133db2ead63a2fc064d964f0b630e43909f441f11)
* src

  + src/app-layer-htp.c
    [app-layer-htp.c](#diff-56922fe0497672d8c8892934e2390961e65f9c02ee4822dcb9789e38cd786a6d)
* suricata.yaml.in
  [suricata.yaml.in](#diff-6edad567c7414ca3b78009e7d315547542cbb77455e7a223c11719d2734fd3db)

## There are no files selected for viewing

2 changes: 2 additions & 0 deletions

2
[configure.ac](#diff-49473dca262eeab3b4a43002adb08b4db31020d190caaad1594b47f1d5daa810 "configure.ac")

Show comments

[View file](/OISF/suricata/blob/e7e28822f473320658d6125f16ac3f0524baff01/configure.ac)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1596,6 +1596,7 @@ |
|  |  | AC\_CHECK\_LIB([htp], [htp\_config\_set\_lzma\_layers],AC\_DEFINE\_UNQUOTED([HAVE\_HTP\_CONFIG\_SET\_LZMA\_LAYERS],[1],[Found htp\_config\_set\_lzma\_layers function in libhtp]) ,,[-lhtp]) |
|  |  | AC\_CHECK\_LIB([htp], [htp\_config\_set\_compression\_bomb\_limit],AC\_DEFINE\_UNQUOTED([HAVE\_HTP\_CONFIG\_SET\_COMPRESSION\_BOMB\_LIMIT],[1],[Found htp\_config\_set\_compression\_bomb\_limit function in libhtp]) ,,[-lhtp]) |
|  |  | AC\_CHECK\_LIB([htp], [htp\_config\_set\_compression\_time\_limit],AC\_DEFINE\_UNQUOTED([HAVE\_HTP\_CONFIG\_SET\_COMPRESSION\_TIME\_LIMIT],[1],[Found htp\_config\_set\_compression\_time\_limit function in libhtp]) ,,[-lhtp]) |
|  |  | AC\_CHECK\_LIB([htp], [htp\_config\_set\_max\_tx],AC\_DEFINE\_UNQUOTED([HAVE\_HTP\_CONFIG\_SET\_MAX\_TX],[1],[Found htp\_config\_set\_max\_tx function in libhtp]) ,,[-lhtp]) |
|  |  | ]) |
|  |  |  |
|  |  | if test "x$enable\_non\_bundled\_htp" = "xno"; then |
| Expand All | | @@ -1620,6 +1621,7 @@ |
|  |  | AC\_DEFINE\_UNQUOTED([HAVE\_HTP\_CONFIG\_SET\_LZMA\_LAYERS],[1],[Assuming htp\_config\_set\_lzma\_layers function in bundled libhtp]) |
|  |  | AC\_DEFINE\_UNQUOTED([HAVE\_HTP\_CONFIG\_SET\_COMPRESSION\_BOMB\_LIMIT],[1],[Assuming htp\_config\_set\_compression\_bomb\_limit function in bundled libhtp]) |
|  |  | AC\_DEFINE\_UNQUOTED([HAVE\_HTP\_CONFIG\_SET\_COMPRESSION\_TIME\_LIMIT],[1],[Assuming htp\_config\_set\_compression\_time\_limit function in bundled libhtp]) |
|  |  | AC\_DEFINE\_UNQUOTED([HAVE\_HTP\_CONFIG\_SET\_MAX\_TX],[1],[Assuming htp\_config\_set\_max\_tx function in bundled libhtp]) |
|  |  | else |
|  |  | echo |
|  |  | echo " ERROR: Libhtp is not bundled. Get libhtp by doing:" |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[doc/userguide/configuration/suricata-yaml.rst](#diff-2d0b91379c9e1f8f7c031ee133db2ead63a2fc064d964f0b630e43909f441f11 "doc/userguide/configuration/suricata-yaml.rst")

Show comments

[View file](/OISF/suricata/blob/e7e28822f473320658d6125f16ac3f0524baff01/doc/userguide/configuration/suricata-yaml.rst)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -1761,7 +1761,7 @@ incompatible with ``decode-mime``. If both are enabled, |
|  |  | Maximum transactions |
|  |  | ~~~~~~~~~~~~~~~~~~~~ |
|  |  |  |
|  |  | MQTT, FTP, PostgreSQL, SMB, DCERPC and NFS have each a `max-tx` parameter that can be customized. |
|  |  | MQTT, FTP, PostgreSQL, SMB, DCERPC, HTTP1 and NFS have each a `max-tx` parameter that can be customized. |
|  |  | `max-tx` refers to the maximum number of live transactions for each flow. |
|  |  | An app-layer event `protocol.too\_many\_transactions` is triggered when this value is reached. |
|  |  | The point of this parameter is to find a balance between the completeness of analysis |
| Expand Down | |  |

16 changes: 16 additions & 0 deletions

16
[src/app-layer-htp.c](#diff-56922fe0497672d8c8892934e2390961e65f9c02ee4822dcb9789e38cd786a6d "src/app-layer-htp.c")

Show comments

[View file](/OISF/suricata/blob/e7e28822f473320658d6125f16ac3f0524baff01/src/app-layer-htp.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2517,6 +2517,10 @@ static void HTPConfigSetDefaultsPhase1(HTPCfgRec \*cfg\_prec) |
|  |  | #endif |
|  |  | #ifdef HAVE\_HTP\_CONFIG\_SET\_COMPRESSION\_TIME\_LIMIT |
|  |  | htp\_config\_set\_compression\_time\_limit(cfg\_prec->cfg, HTP\_CONFIG\_DEFAULT\_COMPRESSION\_TIME\_LIMIT); |
|  |  | #endif |
|  |  | #ifdef HAVE\_HTP\_CONFIG\_SET\_MAX\_TX |
|  |  | #define HTP\_CONFIG\_DEFAULT\_MAX\_TX\_LIMIT 512 |
|  |  | htp\_config\_set\_max\_tx(cfg\_prec->cfg, HTP\_CONFIG\_DEFAULT\_MAX\_TX\_LIMIT); |
|  |  | #endif |
|  |  | /\* libhtp <= 0.5.9 doesn't use soft limit, but it's impossible to set |
|  |  | \* only the hard limit. So we set both here to the (current) htp defaults. |
| Expand Down  Expand Up | | @@ -2868,6 +2872,18 @@ static void HTPConfigParseParameters(HTPCfgRec \*cfg\_prec, ConfNode \*s, |
|  |  | } |
|  |  | SCLogConfig("Setting HTTP decompression time limit to %" PRIu32 " usec", limit); |
|  |  | htp\_config\_set\_compression\_time\_limit(cfg\_prec->cfg, (size\_t)limit); |
|  |  | #endif |
|  |  | #ifdef HAVE\_HTP\_CONFIG\_SET\_MAX\_TX |
|  |  | } else if (strcasecmp("max-tx", p->name) == 0) { |
|  |  | uint32\_t limit = 0; |
|  |  | if (ParseSizeStringU32(p->val, &limit) < 0) { |
|  |  | FatalError("failed to parse 'max-tx' " |
|  |  | "from conf file - %s.", |
|  |  | p->val); |
|  |  | } |
|  |  | /\* set default soft-limit with our new hard limit \*/ |
|  |  | SCLogConfig("Setting HTTP max-tx limit to %" PRIu32 " bytes", limit); |
|  |  | htp\_config\_set\_max\_tx(cfg\_prec->cfg, (size\_t)limit); |
|  |  | #endif |
|  |  | } else if (strcasecmp("randomize-inspection-sizes", p->name) == 0) { |
|  |  | if (!g\_disable\_randomness) { |
| Expand Down | |  |

2 changes: 2 additions & 0 deletions

2
[suricata.yaml.in](#diff-6edad567c7414ca3b78009e7d315547542cbb77455e7a223c11719d2734fd3db "suricata.yaml.in")

Show comments

[View file](/OISF/suricata/blob/e7e28822f473320658d6125f16ac3f0524baff01/suricata.yaml.in)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1086,6 +1086,8 @@ app-layer: |
|  |  | #compression-bomb-limit: 1mb |
|  |  | # Maximum time spent decompressing a single transaction in usec |
|  |  | #decompression-time-limit: 100000 |
|  |  | # Maximum number of live transactions per flow |
|  |  | #max-tx: 512 |
|  |  |  |
|  |  | server-config: |
|  |  |  |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `e7e2882`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOISF%2Fsuricata%2Fcommit%2Fe7e28822f473320658d6125f16ac3f0524baff01) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from lists.fedoraproject.org_b567ec2f_20250110_202747.html ===


[![Fedora Mailing-Lists](/static/logo-hyperkitty-fedora.png)](/archives/ "Fedora Mailing-Lists")

[Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/GOCOBFUTIFHOP2PZOH4ENRFXRBHIRKK4/)
[Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/GOCOBFUTIFHOP2PZOH4ENRFXRBHIRKK4/)

* [Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/GOCOBFUTIFHOP2PZOH4ENRFXRBHIRKK4/)
* [Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/GOCOBFUTIFHOP2PZOH4ENRFXRBHIRKK4/)

* [Manage this list](/admin/lists/package-announce.lists.fedoraproject.org/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

### 2025

* [January](/archives/list/package-announce%40lists.fedoraproject.org/2025/1/)

### 2024

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2024/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2024/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2024/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2024/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2024/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2024/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2024/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2024/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2024/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2024/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2024/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2024/1/)

### 2023

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2023/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2023/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2023/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2023/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2023/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2023/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2023/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2023/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2023/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2023/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2023/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2023/1/)

### 2022

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2022/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2022/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2022/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2022/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2022/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2022/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2022/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2022/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2022/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2022/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2022/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2022/1/)

### 2021

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2021/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2021/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2021/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2021/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2021/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2021/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2021/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2021/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2021/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2021/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2021/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2021/1/)

### 2020

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2020/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2020/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2020/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2020/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2020/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2020/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2020/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2020/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2020/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2020/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2020/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2020/1/)

### 2019

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2019/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2019/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2019/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2019/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2019/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2019/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2019/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2019/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2019/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2019/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2019/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2019/1/)

### 2018

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2018/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2018/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2018/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2018/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2018/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2018/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2018/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2018/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2018/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2018/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2018/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2018/1/)

### 2017

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2017/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2017/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2017/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2017/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2017/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2017/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2017/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2017/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2017/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2017/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2017/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2017/1/)

### 2016

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2016/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2016/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2016/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2016/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2016/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2016/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2016/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2016/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2016/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2016/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2016/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2016/1/)

### 2015

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2015/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2015/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2015/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2015/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2015/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2015/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2015/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2015/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2015/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2015/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2015/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2015/1/)

### 2014

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2014/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2014/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2014/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2014/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2014/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2014/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2014/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2014/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2014/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2014/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2014/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2014/1/)

### 2013

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2013/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2013/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2013/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2013/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2013/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2013/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2013/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2013/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2013/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2013/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2013/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2013/1/)

### 2012

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2012/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2012/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2012/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2012/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2012/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2012/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2012/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2012/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2012/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2012/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2012/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2012/1/)

### 2011

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2011/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2011/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2011/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2011/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2011/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2011/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2011/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2011/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2011/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2011/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2011/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2011/1/)

### 2010

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2010/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2010/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2010/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2010/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2010/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2010/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2010/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2010/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2010/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2010/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2010/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2010/1/)

### 2009

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2009/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2009/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2009/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2009/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2009/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2009/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2009/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2009/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2009/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2009/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2009/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2009/1/)

### 2008

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2008/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2008/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2008/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2008/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2008/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2008/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2008/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2008/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2008/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2008/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2008/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2008/1/)

### 2007

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2007/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2007/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2007/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2007/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2007/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2007/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2007/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2007/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2007/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2007/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2007/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2007/1/)

### 2006

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2006/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2006/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2006/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2006/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2006/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2006/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2006/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2006/5/)

[List overview](/archives/list/package-announce%40lists.fedoraproject.org/)

[Download](/archives/list/package-announce%40lists.fedoraproject.org/export/package-announce%40lists.fedoraproject.org-GOCOBFUTIFHOP2PZOH4ENRFXRBHIRKK4.mbox.gz?message=GOCOBFUTIFHOP2PZOH4ENRFXRBHIRKK4 "This message in gzipped mbox format")

[thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/GOCOBFUTIFHOP2PZOH4ENRFXRBHIRKK4/#GOCOBFUTIFHOP2PZOH4ENRFXRBHIRKK4)

# [SECURITY] Fedora 39 Update: suricata-6.0.16-1.fc39

![](https://seccdn.libravatar.org/avatar/be256568dfce45c1862b55e6cf3f2726.jpg?s=120&d=retro&r=g)

[updates＠fedoraproject.org](/archives/users/3d8bb2e4c1d843beb492d4f8a7c44761/ "See the profile for updates＠fedoraproject.org")

7 Mar
2024

7 Mar
'24

12:58 a.m.

--------------------------------------------------------------------------------
Fedora Update Notification
FEDORA-2024-bd4eed8466
2024-03-07 00:56:19.124094
--------------------------------------------------------------------------------

Name : suricata
Product : Fedora 39
Version : 6.0.16
Release : 1.fc39
URL : <https://suricata-ids.org/>
Summary : Intrusion Detection System
Description :
The Suricata Engine is an Open Source Next Generation Intrusion
Detection and Prevention Engine. This engine is not intended to
just replace or emulate the existing tools in the industry, but
will bring new ideas and technologies to the field. This new Engine
supports Multi-threading, Automatic Protocol Detection (IP, TCP,
UDP, ICMP, HTTP, TLS, FTP and SMB! ), Gzip Decompression, Fast IP
Matching, and GeoIP identification.

--------------------------------------------------------------------------------
Update Information:

This update fixes: CVE-2024-23835, CVE-2024-23836, CVE-2024-23837,
CVE-2024-23839, CVE-2024-24568.
--------------------------------------------------------------------------------
ChangeLog:

\* Mon Feb 26 2024 Steve Grubb sgrubb@redhat.com 6.0.16-1
- New security and bugfix release
--------------------------------------------------------------------------------
References:

[ 1 ] Bug #2266171 - CVE-2024-24568 suricata: potential bypass of rules inspecting HTTP2 headers [epel-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=2266171>
[ 2 ] Bug #2266172 - CVE-2024-24568 suricata: potential bypass of rules inspecting HTTP2 headers [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=2266172>
[ 3 ] Bug #2267727 - CVE-2024-23836 suricata: crafted traffic can cause denial of service [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=2267727>
--------------------------------------------------------------------------------

This update can be installed with the "dnf" update program. Use
su -c 'dnf upgrade --advisory FEDORA-2024-bd4eed8466' at the command
line. For more information, refer to the dnf documentation available at
<http://dnf.readthedocs.io/en/latest/command_ref.html#upgrade-command-label>

All packages are signed with the Fedora Project GPG key. More details on the
GPG keys used by the Fedora Project can be found at
<https://fedoraproject.org/keys>
--------------------------------------------------------------------------------

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Back to the thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/GOCOBFUTIFHOP2PZOH4ENRFXRBHIRKK4/#GOCOBFUTIFHOP2PZOH4ENRFXRBHIRKK4)

[Back to the list](/archives/list/package-announce%40lists.fedoraproject.org/)

Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.7.



=== Content from github.com_37f9b558_20250110_202741.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOISF%2Fsuricata%2Fcommit%2F97953998d2d60673ed6c30ddfb6a2d59b4230f97)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOISF%2Fsuricata%2Fcommit%2F97953998d2d60673ed6c30ddfb6a2d59b4230f97)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=OISF%2Fsuricata)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[OISF](/OISF)
/
**[suricata](/OISF/suricata)**
Public

* [Notifications](/login?return_to=%2FOISF%2Fsuricata) You must be signed in to change notification settings
* [Fork
  1.5k](/login?return_to=%2FOISF%2Fsuricata)
* [Star
   4.8k](/login?return_to=%2FOISF%2Fsuricata)

* [Code](/OISF/suricata)
* [Pull requests
  71](/OISF/suricata/pulls)
* [Actions](/OISF/suricata/actions)
* [Security](/OISF/suricata/security)
* [Insights](/OISF/suricata/pulse)

Additional navigation options

* [Code](/OISF/suricata)
* [Pull requests](/OISF/suricata/pulls)
* [Actions](/OISF/suricata/actions)
* [Security](/OISF/suricata/security)
* [Insights](/OISF/suricata/pulse)

## Commit

[Permalink](/OISF/suricata/commit/97953998d2d60673ed6c30ddfb6a2d59b4230f97)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

http1: remove transactions from their list

[Browse files](/OISF/suricata/tree/97953998d2d60673ed6c30ddfb6a2d59b4230f97)
Browse the repository at this point in the history

```
instead of keeping a NULL pointer in an array

Ticket: [#5921](https://github.com/OISF/suricata/pull/5921)
(cherry picked from commit [8f63a8f](https://github.com/OISF/suricata/commit/8f63a8f3bffbbaf8fae4985ee5f974ab326b08c0))
```

* Loading branch information

[![@catenacyber](https://avatars.githubusercontent.com/u/35799796?s=40&v=4)](/catenacyber) [![@victorjulien](https://avatars.githubusercontent.com/u/32410611?s=40&v=4)](/victorjulien)

[catenacyber](/OISF/suricata/commits?author=catenacyber "View all commits by catenacyber")
authored and
[victorjulien](/OISF/suricata/commits?author=victorjulien "View all commits by victorjulien")
committed
Feb 6, 2024

1 parent
[478a2a3](/OISF/suricata/commit/478a2a38f54e2ae235f8486bff87d7d66b6307f0)

commit 9795399

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**18 additions**
and
**8 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src

  + src/app-layer-htp-file.c
    [app-layer-htp-file.c](#diff-b0cc4de1e2b734aa4701922614fa3efd8e11a6649b8b524d31b26ae017773e5c)
  + src/app-layer-htp.c
    [app-layer-htp.c](#diff-56922fe0497672d8c8892934e2390961e65f9c02ee4822dcb9789e38cd786a6d)
  + src/app-layer-htp.h
    [app-layer-htp.h](#diff-9faaa86a9ea5b3a85890fd4ea5bf65e7d3bb0d844933e497f7bd3757aed86a0a)

## There are no files selected for viewing

3 changes: 2 additions & 1 deletion

3
[src/app-layer-htp-file.c](#diff-b0cc4de1e2b734aa4701922614fa3efd8e11a6649b8b524d31b26ae017773e5c "src/app-layer-htp-file.c")

Show comments

[View file](/OISF/suricata/blob/97953998d2d60673ed6c30ddfb6a2d59b4230f97/src/app-layer-htp-file.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -179,7 +179,8 @@ int HTPFileOpenWithRange(HtpState \*s, HtpTxUserData \*txud, const uint8\_t \*filena |
|  |  | } |
|  |  |  |
|  |  | // Then, we will try to handle reassembly of different ranges of the same file |
|  |  | htp\_tx\_t \*tx = htp\_list\_get(s->conn->transactions, txid); |
|  |  | // TODO have the caller pass directly the tx |
|  |  | htp\_tx\_t \*tx = htp\_list\_get(s->conn->transactions, txid - s->tx\_freed); |
|  |  | if (!tx) { |
|  |  | SCReturnInt(-1); |
|  |  | } |
| Expand Down | |  |

16 changes: 9 additions & 7 deletions

16
[src/app-layer-htp.c](#diff-56922fe0497672d8c8892934e2390961e65f9c02ee4822dcb9789e38cd786a6d "src/app-layer-htp.c")

Show comments

[View file](/OISF/suricata/blob/97953998d2d60673ed6c30ddfb6a2d59b4230f97/src/app-layer-htp.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -401,7 +401,7 @@ void HTPStateFree(void \*state) |
|  |  | uint64\_t total\_txs = HTPStateGetTxCnt(state); |
|  |  | /\* free the list of body chunks \*/ |
|  |  | if (s->conn != NULL) { |
|  |  | for (tx\_id = 0; tx\_id < total\_txs; tx\_id++) { |
|  |  | for (tx\_id = s->tx\_freed; tx\_id < total\_txs; tx\_id++) { |
|  |  | htp\_tx\_t \*tx = HTPStateGetTx(s, tx\_id); |
|  |  | if (tx != NULL) { |
|  |  | HtpTxUserData \*htud = (HtpTxUserData \*) htp\_tx\_get\_user\_data(tx); |
| Expand Down  Expand Up | | @@ -458,8 +458,10 @@ static void HTPStateTransactionFree(void \*state, uint64\_t id) |
|  |  | tx->request\_progress = HTP\_REQUEST\_COMPLETE; |
|  |  | tx->response\_progress = HTP\_RESPONSE\_COMPLETE; |
|  |  | } |
|  |  | // replaces tx in the s->conn->transactions list by NULL |
|  |  | htp\_tx\_destroy(tx); |
|  |  | } |
|  |  | s->tx\_freed += htp\_connp\_tx\_freed(s->connp); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
| Expand Down  Expand Up | | @@ -3077,7 +3079,7 @@ static uint64\_t HTPStateGetTxCnt(void \*alstate) |
|  |  | if (size < 0) |
|  |  | return 0ULL; |
|  |  | SCLogDebug("size %"PRIu64, size); |
|  |  | return (uint64\_t)size; |
|  |  | return (uint64\_t)size + http\_state->tx\_freed; |
|  |  | } else { |
|  |  | return 0ULL; |
|  |  | } |
| Expand All | | @@ -3087,8 +3089,8 @@ static void \*HTPStateGetTx(void \*alstate, uint64\_t tx\_id) |
|  |  | { |
|  |  | HtpState \*http\_state = (HtpState \*)alstate; |
|  |  |  |
|  |  | if (http\_state != NULL && http\_state->conn != NULL) |
|  |  | return htp\_list\_get(http\_state->conn->transactions, tx\_id); |
|  |  | if (http\_state != NULL && http\_state->conn != NULL && tx\_id >= http\_state->tx\_freed) |
|  |  | return htp\_list\_get(http\_state->conn->transactions, tx\_id - http\_state->tx\_freed); |
|  |  | else |
|  |  | return NULL; |
|  |  | } |
| Expand All | | @@ -3098,9 +3100,9 @@ void \*HtpGetTxForH2(void \*alstate) |
|  |  | // gets last transaction |
|  |  | HtpState \*http\_state = (HtpState \*)alstate; |
|  |  | if (http\_state != NULL && http\_state->conn != NULL) { |
|  |  | size\_t txid = htp\_list\_array\_size(http\_state->conn->transactions); |
|  |  | if (txid > 0) { |
|  |  | return htp\_list\_get(http\_state->conn->transactions, txid - 1); |
|  |  | size\_t txid = HTPStateGetTxCnt(http\_state); |
|  |  | if (txid > http\_state->tx\_freed) { |
|  |  | return htp\_list\_get(http\_state->conn->transactions, txid - http\_state->tx\_freed - 1); |
|  |  | } |
|  |  | } |
|  |  | return NULL; |
| Expand Down | |  |

7 changes: 7 additions & 0 deletions

7
[src/app-layer-htp.h](#diff-9faaa86a9ea5b3a85890fd4ea5bf65e7d3bb0d844933e497f7bd3757aed86a0a "src/app-layer-htp.h")

Show comments

[View file](/OISF/suricata/blob/97953998d2d60673ed6c30ddfb6a2d59b4230f97/src/app-layer-htp.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -247,6 +247,13 @@ typedef struct HtpState\_ { |
|  |  | htp\_conn\_t \*conn; |
|  |  | Flow \*f; /\*\*< Needed to retrieve the original flow when using HTPLib callbacks \*/ |
|  |  | uint64\_t transaction\_cnt; |
|  |  | // tx\_freed is the number of already freed transactions |
|  |  | // This is needed as libhtp only keeps the live transactions : |
|  |  | // To get the total number of transactions, we need to add |
|  |  | // the number of transactions tracked by libhtp to this number. |
|  |  | // It is also needed as an offset to translate between suricata |
|  |  | // transaction id to libhtp offset in its list/array |
|  |  | uint64\_t tx\_freed; |
|  |  | const struct HTPCfgRec\_ \*cfg; |
|  |  | uint16\_t flags; |
|  |  | uint16\_t events; |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `9795399`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOISF%2Fsuricata%2Fcommit%2F97953998d2d60673ed6c30ddfb6a2d59b4230f97) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_5eaa0025_20250110_202738.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOISF%2Fsuricata%2Fcommit%2F18841a58da71e735ddf4e52cbfa6989755ecbeb7)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOISF%2Fsuricata%2Fcommit%2F18841a58da71e735ddf4e52cbfa6989755ecbeb7)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=OISF%2Fsuricata)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[OISF](/OISF)
/
**[suricata](/OISF/suricata)**
Public

* [Notifications](/login?return_to=%2FOISF%2Fsuricata) You must be signed in to change notification settings
* [Fork
  1.5k](/login?return_to=%2FOISF%2Fsuricata)
* [Star
   4.8k](/login?return_to=%2FOISF%2Fsuricata)

* [Code](/OISF/suricata)
* [Pull requests
  71](/OISF/suricata/pulls)
* [Actions](/OISF/suricata/actions)
* [Security](/OISF/suricata/security)
* [Insights](/OISF/suricata/pulse)

Additional navigation options

* [Code](/OISF/suricata)
* [Pull requests](/OISF/suricata/pulls)
* [Actions](/OISF/suricata/actions)
* [Security](/OISF/suricata/security)
* [Insights](/OISF/suricata/pulse)

## Commit

[Permalink](/OISF/suricata/commit/18841a58da71e735ddf4e52cbfa6989755ecbeb7)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

http1: remove transactions from their list

[Browse files](/OISF/suricata/tree/18841a58da71e735ddf4e52cbfa6989755ecbeb7)
Browse the repository at this point in the history

```
instead of keeping a NULL pointer in an array

Ticket: [#5921](https://github.com/OISF/suricata/pull/5921)

(cherry picked from commit [8f63a8f](https://github.com/OISF/suricata/commit/8f63a8f3bffbbaf8fae4985ee5f974ab326b08c0))
```

* Loading branch information

[![@catenacyber](https://avatars.githubusercontent.com/u/35799796?s=40&v=4)](/catenacyber) [![@victorjulien](https://avatars.githubusercontent.com/u/32410611?s=40&v=4)](/victorjulien)

[catenacyber](/OISF/suricata/commits?author=catenacyber "View all commits by catenacyber")
authored and
[victorjulien](/OISF/suricata/commits?author=victorjulien "View all commits by victorjulien")
committed
Feb 7, 2024

1 parent
[ffed4b3](/OISF/suricata/commit/ffed4b35cb8a0c4db586305239fe615dce0174a8)

commit 18841a5

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**16 additions**
and
**7 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src

  + src/app-layer-htp.c
    [app-layer-htp.c](#diff-56922fe0497672d8c8892934e2390961e65f9c02ee4822dcb9789e38cd786a6d)
  + src/app-layer-htp.h
    [app-layer-htp.h](#diff-9faaa86a9ea5b3a85890fd4ea5bf65e7d3bb0d844933e497f7bd3757aed86a0a)

## There are no files selected for viewing

16 changes: 9 additions & 7 deletions

16
[src/app-layer-htp.c](#diff-56922fe0497672d8c8892934e2390961e65f9c02ee4822dcb9789e38cd786a6d "src/app-layer-htp.c")

Show comments

[View file](/OISF/suricata/blob/18841a58da71e735ddf4e52cbfa6989755ecbeb7/src/app-layer-htp.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -402,7 +402,7 @@ void HTPStateFree(void \*state) |
|  |  | uint64\_t total\_txs = HTPStateGetTxCnt(state); |
|  |  | /\* free the list of body chunks \*/ |
|  |  | if (s->conn != NULL) { |
|  |  | for (tx\_id = 0; tx\_id < total\_txs; tx\_id++) { |
|  |  | for (tx\_id = s->tx\_freed; tx\_id < total\_txs; tx\_id++) { |
|  |  | htp\_tx\_t \*tx = HTPStateGetTx(s, tx\_id); |
|  |  | if (tx != NULL) { |
|  |  | HtpTxUserData \*htud = (HtpTxUserData \*) htp\_tx\_get\_user\_data(tx); |
| Expand Down  Expand Up | | @@ -461,8 +461,10 @@ static void HTPStateTransactionFree(void \*state, uint64\_t id) |
|  |  | tx->request\_progress = HTP\_REQUEST\_COMPLETE; |
|  |  | tx->response\_progress = HTP\_RESPONSE\_COMPLETE; |
|  |  | } |
|  |  | // replaces tx in the s->conn->transactions list by NULL |
|  |  | htp\_tx\_destroy(tx); |
|  |  | } |
|  |  | s->tx\_freed += htp\_connp\_tx\_freed(s->connp); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
| Expand Down  Expand Up | | @@ -2976,7 +2978,7 @@ static uint64\_t HTPStateGetTxCnt(void \*alstate) |
|  |  | if (size < 0) |
|  |  | return 0ULL; |
|  |  | SCLogDebug("size %"PRIu64, size); |
|  |  | return (uint64\_t)size; |
|  |  | return (uint64\_t)size + http\_state->tx\_freed; |
|  |  | } else { |
|  |  | return 0ULL; |
|  |  | } |
| Expand All | | @@ -2986,8 +2988,8 @@ static void \*HTPStateGetTx(void \*alstate, uint64\_t tx\_id) |
|  |  | { |
|  |  | HtpState \*http\_state = (HtpState \*)alstate; |
|  |  |  |
|  |  | if (http\_state != NULL && http\_state->conn != NULL) |
|  |  | return htp\_list\_get(http\_state->conn->transactions, tx\_id); |
|  |  | if (http\_state != NULL && http\_state->conn != NULL && tx\_id >= http\_state->tx\_freed) |
|  |  | return htp\_list\_get(http\_state->conn->transactions, tx\_id - http\_state->tx\_freed); |
|  |  | else |
|  |  | return NULL; |
|  |  | } |
| Expand All | | @@ -2997,9 +2999,9 @@ void \*HtpGetTxForH2(void \*alstate) |
|  |  | // gets last transaction |
|  |  | HtpState \*http\_state = (HtpState \*)alstate; |
|  |  | if (http\_state != NULL && http\_state->conn != NULL) { |
|  |  | size\_t txid = htp\_list\_array\_size(http\_state->conn->transactions); |
|  |  | if (txid > 0) { |
|  |  | return htp\_list\_get(http\_state->conn->transactions, txid - 1); |
|  |  | size\_t txid = HTPStateGetTxCnt(http\_state); |
|  |  | if (txid > http\_state->tx\_freed) { |
|  |  | return htp\_list\_get(http\_state->conn->transactions, txid - http\_state->tx\_freed - 1); |
|  |  | } |
|  |  | } |
|  |  | return NULL; |
| Expand Down | |  |

7 changes: 7 additions & 0 deletions

7
[src/app-layer-htp.h](#diff-9faaa86a9ea5b3a85890fd4ea5bf65e7d3bb0d844933e497f7bd3757aed86a0a "src/app-layer-htp.h")

Show comments

[View file](/OISF/suricata/blob/18841a58da71e735ddf4e52cbfa6989755ecbeb7/src/app-layer-htp.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -252,6 +252,13 @@ typedef struct HtpState\_ { |
|  |  | uint64\_t store\_tx\_id; |
|  |  | FileContainer \*files\_ts; |
|  |  | FileContainer \*files\_tc; |
|  |  | // tx\_freed is the number of already freed transactions |
|  |  | // This is needed as libhtp only keeps the live transactions : |
|  |  | // To get the total number of transactions, we need to add |
|  |  | // the number of transactions tracked by libhtp to this number. |
|  |  | // It is also needed as an offset to translate between suricata |
|  |  | // transaction id to libhtp offset in its list/array |
|  |  | uint64\_t tx\_freed; |
|  |  | const struct HTPCfgRec\_ \*cfg; |
|  |  | uint16\_t flags; |
|  |  | uint16\_t events; |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `18841a5`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOISF%2Fsuricata%2Fcommit%2F18841a58da71e735ddf4e52cbfa6989755ecbeb7) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_8d3d1411_20250110_202746.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOISF%2Fsuricata%2Fcommit%2Ff9de1cca6182e571f1c02387dca6e695e55608af)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOISF%2Fsuricata%2Fcommit%2Ff9de1cca6182e571f1c02387dca6e695e55608af)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=OISF%2Fsuricata)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[OISF](/OISF)
/
**[suricata](/OISF/suricata)**
Public

* [Notifications](/login?return_to=%2FOISF%2Fsuricata) You must be signed in to change notification settings
* [Fork
  1.5k](/login?return_to=%2FOISF%2Fsuricata)
* [Star
   4.8k](/login?return_to=%2FOISF%2Fsuricata)

* [Code](/OISF/suricata)
* [Pull requests
  71](/OISF/suricata/pulls)
* [Actions](/OISF/suricata/actions)
* [Security](/OISF/suricata/security)
* [Insights](/OISF/suricata/pulse)

Additional navigation options

* [Code](/OISF/suricata)
* [Pull requests](/OISF/suricata/pulls)
* [Actions](/OISF/suricata/actions)
* [Security](/OISF/suricata/security)
* [Insights](/OISF/suricata/pulse)

## Commit

[Permalink](/OISF/suricata/commit/f9de1cca6182e571f1c02387dca6e695e55608af)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

smtp: config limit maximum number of live transactions

[Browse files](/OISF/suricata/tree/f9de1cca6182e571f1c02387dca6e695e55608af)
Browse the repository at this point in the history

```
Ticket: [#6477](https://github.com/OISF/suricata/pull/6477)
(cherry picked from commit [8f73a0a](https://github.com/OISF/suricata/commit/8f73a0ac5588cb5e5c501b3c7a07cb5d35b99d92))
```

* Loading branch information

[![@catenacyber](https://avatars.githubusercontent.com/u/35799796?s=40&v=4)](/catenacyber) [![@victorjulien](https://avatars.githubusercontent.com/u/32410611?s=40&v=4)](/victorjulien)

[catenacyber](/OISF/suricata/commits?author=catenacyber "View all commits by catenacyber")
authored and
[victorjulien](/OISF/suricata/commits?author=victorjulien "View all commits by victorjulien")
committed
Feb 6, 2024

1 parent
[e7e2882](/OISF/suricata/commit/e7e28822f473320658d6125f16ac3f0524baff01)

commit f9de1cc

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**27 additions**
and
**5 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* doc/userguide/configuration

  + doc/userguide/configuration/suricata-yaml.rst
    [suricata-yaml.rst](#diff-2d0b91379c9e1f8f7c031ee133db2ead63a2fc064d964f0b630e43909f441f11)
* src

  + src/app-layer-smtp.c
    [app-layer-smtp.c](#diff-2211b552dfe681c733c77810415590ea78e61d8dbfc828fda8c9e5c9cb470610)
  + src/app-layer-smtp.h
    [app-layer-smtp.h](#diff-e1bb5985f5b1cdcd973f884c8276d67bd37482804ad2f08b75f474043212650d)
* suricata.yaml.in
  [suricata.yaml.in](#diff-6edad567c7414ca3b78009e7d315547542cbb77455e7a223c11719d2734fd3db)

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[doc/userguide/configuration/suricata-yaml.rst](#diff-2d0b91379c9e1f8f7c031ee133db2ead63a2fc064d964f0b630e43909f441f11 "doc/userguide/configuration/suricata-yaml.rst")

Show comments

[View file](/OISF/suricata/blob/f9de1cca6182e571f1c02387dca6e695e55608af/doc/userguide/configuration/suricata-yaml.rst)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -1761,7 +1761,7 @@ incompatible with ``decode-mime``. If both are enabled, |
|  |  | Maximum transactions |
|  |  | ~~~~~~~~~~~~~~~~~~~~ |
|  |  |  |
|  |  | MQTT, FTP, PostgreSQL, SMB, DCERPC, HTTP1 and NFS have each a `max-tx` parameter that can be customized. |
|  |  | SMTP, MQTT, FTP, PostgreSQL, SMB, DCERPC, HTTP1 and NFS have each a `max-tx` parameter that can be customized. |
|  |  | `max-tx` refers to the maximum number of live transactions for each flow. |
|  |  | An app-layer event `protocol.too\_many\_transactions` is triggered when this value is reached. |
|  |  | The point of this parameter is to find a balance between the completeness of analysis |
| Expand Down | |  |

27 changes: 23 additions & 4 deletions

27
[src/app-layer-smtp.c](#diff-2211b552dfe681c733c77810415590ea78e61d8dbfc828fda8c9e5c9cb470610 "src/app-layer-smtp.c")

Show comments

[View file](/OISF/suricata/blob/f9de1cca6182e571f1c02387dca6e695e55608af/src/app-layer-smtp.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -112,6 +112,8 @@ |
|  |  | #define SMTP\_EHLO\_EXTENSION\_STARTTLS |
|  |  | #define SMTP\_EHLO\_EXTENSION\_8BITMIME |
|  |  |  |
|  |  | #define SMTP\_DEFAULT\_MAX\_TX 256 |
|  |  |  |
|  |  | typedef struct SMTPInput\_ { |
|  |  | /\* current input that is being parsed \*/ |
|  |  | const uint8\_t \*buf; |
| Expand Down  Expand Up | | @@ -421,6 +423,18 @@ static void SMTPConfigure(void) { |
|  |  | smtp\_config.raw\_extraction = 0; |
|  |  | } |
|  |  |  |
|  |  | uint64\_t value = SMTP\_DEFAULT\_MAX\_TX; |
|  |  | smtp\_config.max\_tx = SMTP\_DEFAULT\_MAX\_TX; |
|  |  | const char \*str = NULL; |
|  |  | if (ConfGet("app-layer.protocols.smtp.max-tx", &str) == 1) { |
|  |  | if (ParseSizeStringU64(str, &value) < 0) { |
|  |  | SCLogWarning("max-tx value cannot be deduced: %s," |
|  |  | " keeping default", |
|  |  | str); |
|  |  | } |
|  |  | smtp\_config.max\_tx = value; |
|  |  | } |
|  |  |  |
|  |  | SCReturn; |
|  |  | } |
|  |  |  |
| Expand All | | @@ -436,8 +450,11 @@ static void SMTPSetEvent(SMTPState \*s, uint8\_t e) |
|  |  | SCLogDebug("couldn't set event %u", e); |
|  |  | } |
|  |  |  |
|  |  | static SMTPTransaction \*SMTPTransactionCreate(void) |
|  |  | static SMTPTransaction \*SMTPTransactionCreate(SMTPState \*state) |
|  |  | { |
|  |  | if (state->tx\_cnt > smtp\_config.max\_tx) { |
|  |  | return NULL; |
|  |  | } |
|  |  | SMTPTransaction \*tx = SCCalloc(1, sizeof(\*tx)); |
|  |  | if (tx == NULL) { |
|  |  | return NULL; |
| Expand Down  Expand Up | | @@ -1170,7 +1187,7 @@ static int SMTPProcessRequest(SMTPState \*state, Flow \*f, AppLayerParserState \*ps |
|  |  | return 0; |
|  |  | } |
|  |  | if (state->curr\_tx == NULL || (state->curr\_tx->done && !NoNewTx(state, line))) { |
|  |  | tx = SMTPTransactionCreate(); |
|  |  | tx = SMTPTransactionCreate(state); |
|  |  | if (tx == NULL) |
|  |  | return -1; |
|  |  | state->curr\_tx = tx; |
| Expand Down  Expand Up | | @@ -1203,7 +1220,7 @@ static int SMTPProcessRequest(SMTPState \*state, Flow \*f, AppLayerParserState \*ps |
|  |  | // we did not close the previous tx, set error |
|  |  | SMTPSetEvent(state, SMTP\_DECODER\_EVENT\_UNPARSABLE\_CONTENT); |
|  |  | FileCloseFile(&tx->files\_ts, &smtp\_config.sbcfg, NULL, 0, FILE\_TRUNCATED); |
|  |  | tx = SMTPTransactionCreate(); |
|  |  | tx = SMTPTransactionCreate(state); |
|  |  | if (tx == NULL) |
|  |  | return -1; |
|  |  | state->curr\_tx = tx; |
| Expand All | | @@ -1221,7 +1238,7 @@ static int SMTPProcessRequest(SMTPState \*state, Flow \*f, AppLayerParserState \*ps |
|  |  | \* of first one. So we start a new transaction. \*/ |
|  |  | tx->mime\_state->state\_flag = PARSE\_ERROR; |
|  |  | SMTPSetEvent(state, SMTP\_DECODER\_EVENT\_UNPARSABLE\_CONTENT); |
|  |  | tx = SMTPTransactionCreate(); |
|  |  | tx = SMTPTransactionCreate(state); |
|  |  | if (tx == NULL) |
|  |  | return -1; |
|  |  | state->curr\_tx = tx; |
| Expand Down  Expand Up | | @@ -1935,6 +1952,8 @@ static void SMTPTestInitConfig(void) |
|  |  | smtp\_config.content\_inspect\_window = FILEDATA\_CONTENT\_INSPECT\_WINDOW; |
|  |  | smtp\_config.content\_inspect\_min\_size = FILEDATA\_CONTENT\_INSPECT\_MIN\_SIZE; |
|  |  |  |
|  |  | smtp\_config.max\_tx = SMTP\_DEFAULT\_MAX\_TX; |
|  |  |  |
|  |  | smtp\_config.sbcfg.buf\_size = FILEDATA\_CONTENT\_INSPECT\_WINDOW; |
|  |  | } |
|  |  |  |
| Expand Down | |  |

1 change: 1 addition & 0 deletions

1
[src/app-layer-smtp.h](#diff-e1bb5985f5b1cdcd973f884c8276d67bd37482804ad2f08b75f474043212650d "src/app-layer-smtp.h")

Show comments

[View file](/OISF/suricata/blob/f9de1cca6182e571f1c02387dca6e695e55608af/src/app-layer-smtp.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -101,6 +101,7 @@ typedef struct SMTPConfig { |
|  |  | uint32\_t content\_limit; |
|  |  | uint32\_t content\_inspect\_min\_size; |
|  |  | uint32\_t content\_inspect\_window; |
|  |  | uint64\_t max\_tx; |
|  |  |  |
|  |  | bool raw\_extraction; |
|  |  |  |
| Expand Down | |  |

2 changes: 2 additions & 0 deletions

2
[suricata.yaml.in](#diff-6edad567c7414ca3b78009e7d315547542cbb77455e7a223c11719d2734fd3db "suricata.yaml.in")

Show comments

[View file](/OISF/suricata/blob/f9de1cca6182e571f1c02387dca6e695e55608af/suricata.yaml.in)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -939,6 +939,8 @@ app-layer: |
|  |  | smtp: |
|  |  | enabled: yes |
|  |  | raw-extraction: no |
|  |  | # Maximum number of live SMTP transactions per flow |
|  |  | # max-tx: 256 |
|  |  | # Configure SMTP-MIME Decoder |
|  |  | mime: |
|  |  | # Decode MIME messages from SMTP transactions |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `f9de1cc`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOISF%2Fsuricata%2Fcommit%2Ff9de1cca6182e571f1c02387dca6e695e55608af) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_a63e4557_20250110_202740.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOISF%2Fsuricata%2Fcommit%2F83c5567ea7b0b28376f57dcfee9c6301448c7bc7)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOISF%2Fsuricata%2Fcommit%2F83c5567ea7b0b28376f57dcfee9c6301448c7bc7)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=OISF%2Fsuricata)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[OISF](/OISF)
/
**[suricata](/OISF/suricata)**
Public

* [Notifications](/login?return_to=%2FOISF%2Fsuricata) You must be signed in to change notification settings
* [Fork
  1.5k](/login?return_to=%2FOISF%2Fsuricata)
* [Star
   4.8k](/login?return_to=%2FOISF%2Fsuricata)

* [Code](/OISF/suricata)
* [Pull requests
  71](/OISF/suricata/pulls)
* [Actions](/OISF/suricata/actions)
* [Security](/OISF/suricata/security)
* [Insights](/OISF/suricata/pulse)

Additional navigation options

* [Code](/OISF/suricata)
* [Pull requests](/OISF/suricata/pulls)
* [Actions](/OISF/suricata/actions)
* [Security](/OISF/suricata/security)
* [Insights](/OISF/suricata/pulse)

## Commit

[Permalink](/OISF/suricata/commit/83c5567ea7b0b28376f57dcfee9c6301448c7bc7)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

smtp: avoid creating empty transaction

[Browse files](/OISF/suricata/tree/83c5567ea7b0b28376f57dcfee9c6301448c7bc7)
Browse the repository at this point in the history

```
Ticket: 6477

So as to avoid ending up with too many empty transactions.

This happens when Suricata sees a DATA command in the current
transaction but did not have a confirmation response for it.
Then, if Suricata receives another DATA command, it will
create another new transaction, even if the previous one
is empty. And so, a malicious client can create many empty
transactions by just sending a repeated amount of DATA commands
without having a confirmation code for them.

Suricata cannot use state->current_command == SMTP_COMMAND_DATA
to prevent this attack and needs to resort to a new boolean
is_data because the malicious client may send another dummy command
after each DATA command.

This patch leaves only one call to SMTPTransactionCreate

(cherry picked from commit [61f2e4e](https://github.com/OISF/suricata/commit/61f2e4e1e5b34dfd8ae44d1c15253e2da65f6e6a))
```

* Loading branch information

[![@catenacyber](https://avatars.githubusercontent.com/u/35799796?s=40&v=4)](/catenacyber) [![@victorjulien](https://avatars.githubusercontent.com/u/32410611?s=40&v=4)](/victorjulien)

[catenacyber](/OISF/suricata/commits?author=catenacyber "View all commits by catenacyber")
authored and
[victorjulien](/OISF/suricata/commits?author=victorjulien "View all commits by victorjulien")
committed
Feb 7, 2024

1 parent
[2a2120e](/OISF/suricata/commit/2a2120ecf10c5b5713ec2bf59469fe57f7b5b747)

commit 83c5567

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**15 additions**
and
**26 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src

  + src/app-layer-smtp.c
    [app-layer-smtp.c](#diff-2211b552dfe681c733c77810415590ea78e61d8dbfc828fda8c9e5c9cb470610)
  + src/app-layer-smtp.h
    [app-layer-smtp.h](#diff-e1bb5985f5b1cdcd973f884c8276d67bd37482804ad2f08b75f474043212650d)

## There are no files selected for viewing

34 changes: 9 additions & 25 deletions

34
[src/app-layer-smtp.c](#diff-2211b552dfe681c733c77810415590ea78e61d8dbfc828fda8c9e5c9cb470610 "src/app-layer-smtp.c")

Show comments

[View file](/OISF/suricata/blob/83c5567ea7b0b28376f57dcfee9c6301448c7bc7/src/app-layer-smtp.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -722,7 +722,7 @@ static inline void SMTPTransactionComplete(SMTPState \*state) |
|  |  | { |
|  |  | DEBUG\_VALIDATE\_BUG\_ON(state->curr\_tx == NULL); |
|  |  | if (state->curr\_tx) |
|  |  | state->curr\_tx->done = 1; |
|  |  | state->curr\_tx->done = true; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
| Expand Down  Expand Up | | @@ -1121,43 +1121,26 @@ static int SMTPProcessRequest(SMTPState \*state, Flow \*f, |
|  |  | } else if (state->current\_line\_len >= 4 && |
|  |  | SCMemcmpLowercase("data", state->current\_line, 4) == 0) { |
|  |  | state->current\_command = SMTP\_COMMAND\_DATA; |
|  |  | if (smtp\_config.raw\_extraction) { |
|  |  | if (state->curr\_tx->is\_data) { |
|  |  | // We did not receive a confirmation from server |
|  |  | // And now the sends a next DATA |
|  |  | SMTPSetEvent(state, SMTP\_DECODER\_EVENT\_UNPARSABLE\_CONTENT); |
|  |  | SCReturnInt(0); |
|  |  | } else if (smtp\_config.raw\_extraction) { |
|  |  | const char \*msgname = "rawmsg"; /\* XXX have a better name \*/ |
|  |  | if (state->files\_ts == NULL) |
|  |  | state->files\_ts = FileContainerAlloc(); |
|  |  | if (state->files\_ts == NULL) { |
|  |  | return -1; |
|  |  | } |
|  |  | if (state->tx\_cnt > 1 && !state->curr\_tx->done) { |
|  |  | // we did not close the previous tx, set error |
|  |  | SMTPSetEvent(state, SMTP\_DECODER\_EVENT\_UNPARSABLE\_CONTENT); |
|  |  | FileCloseFile(state->files\_ts, NULL, 0, FILE\_TRUNCATED); |
|  |  | tx = SMTPTransactionCreate(state); |
|  |  | if (tx == NULL) |
|  |  | return -1; |
|  |  | state->curr\_tx = tx; |
|  |  | TAILQ\_INSERT\_TAIL(&state->tx\_list, tx, next); |
|  |  | tx->tx\_id = state->tx\_cnt++; |
|  |  | } |
|  |  | if (FileOpenFileWithId(state->files\_ts, &smtp\_config.sbcfg, |
|  |  | state->file\_track\_id++, |
|  |  | (uint8\_t\*) msgname, strlen(msgname), NULL, 0, |
|  |  | FILE\_NOMD5|FILE\_NOMAGIC|FILE\_USE\_DETECT) == 0) { |
|  |  | SMTPNewFile(state->curr\_tx, state->files\_ts->tail); |
|  |  | } |
|  |  | } else if (smtp\_config.decode\_mime) { |
|  |  | if (tx->mime\_state) { |
|  |  | /\* We have 2 chained mails and did not detect the end |
|  |  | \* of first one. So we start a new transaction. \*/ |
|  |  | tx->mime\_state->state\_flag = PARSE\_ERROR; |
|  |  | SMTPSetEvent(state, SMTP\_DECODER\_EVENT\_UNPARSABLE\_CONTENT); |
|  |  | tx = SMTPTransactionCreate(state); |
|  |  | if (tx == NULL) |
|  |  | return -1; |
|  |  | state->curr\_tx = tx; |
|  |  | TAILQ\_INSERT\_TAIL(&state->tx\_list, tx, next); |
|  |  | tx->tx\_id = state->tx\_cnt++; |
|  |  | } |
|  |  | DEBUG\_VALIDATE\_BUG\_ON(tx->mime\_state); |
|  |  | tx->mime\_state = MimeDecInitParser(f, SMTPProcessDataChunk); |
|  |  | if (tx->mime\_state == NULL) { |
|  |  | return MIME\_DEC\_ERR\_MEM; |
| Expand All | | @@ -1173,6 +1156,7 @@ static int SMTPProcessRequest(SMTPState \*state, Flow \*f, |
|  |  | tx->msg\_tail = tx->mime\_state->msg; |
|  |  | } |
|  |  | } |
|  |  | state->curr\_tx->is\_data = true; |
|  |  | /\* Enter immediately data mode without waiting for server reply \*/ |
|  |  | if (state->parser\_state & SMTP\_PARSER\_STATE\_PIPELINING\_SERVER) { |
|  |  | state->parser\_state |= SMTP\_PARSER\_STATE\_COMMAND\_DATA\_MODE; |
| Expand Down | |  |

7 changes: 6 additions & 1 deletion

7
[src/app-layer-smtp.h](#diff-e1bb5985f5b1cdcd973f884c8276d67bd37482804ad2f08b75f474043212650d "src/app-layer-smtp.h")

Show comments

[View file](/OISF/suricata/blob/83c5567ea7b0b28376f57dcfee9c6301448c7bc7/src/app-layer-smtp.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -76,7 +76,12 @@ typedef struct SMTPTransaction\_ { |
|  |  |  |
|  |  | AppLayerTxData tx\_data; |
|  |  |  |
|  |  | int done; |
|  |  | /\*\* the tx is complete and can be logged and cleaned \*/ |
|  |  | bool done; |
|  |  | /\*\* the tx has seen a DATA command \*/ |
|  |  | // another DATA command within the same context |
|  |  | // will trigger an app-layer event. |
|  |  | bool is\_data; |
|  |  | /\*\* the first message contained in the session \*/ |
|  |  | MimeDecEntity \*msg\_head; |
|  |  | /\*\* the last message contained in the session \*/ |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `83c5567`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOISF%2Fsuricata%2Fcommit%2F83c5567ea7b0b28376f57dcfee9c6301448c7bc7) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_338256ae_20250110_202742.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOISF%2Fsuricata%2Fcommit%2Fb1549e930f6426eeff43f12b672337cbcda566b8)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOISF%2Fsuricata%2Fcommit%2Fb1549e930f6426eeff43f12b672337cbcda566b8)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=OISF%2Fsuricata)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[OISF](/OISF)
/
**[suricata](/OISF/suricata)**
Public

* [Notifications](/login?return_to=%2FOISF%2Fsuricata) You must be signed in to change notification settings
* [Fork
  1.5k](/login?return_to=%2FOISF%2Fsuricata)
* [Star
   4.8k](/login?return_to=%2FOISF%2Fsuricata)

* [Code](/OISF/suricata)
* [Pull requests
  71](/OISF/suricata/pulls)
* [Actions](/OISF/suricata/actions)
* [Security](/OISF/suricata/security)
* [Insights](/OISF/suricata/pulse)

Additional navigation options

* [Code](/OISF/suricata)
* [Pull requests](/OISF/suricata/pulls)
* [Actions](/OISF/suricata/actions)
* [Security](/OISF/suricata/security)
* [Insights](/OISF/suricata/pulse)

## Commit

[Permalink](/OISF/suricata/commit/b1549e930f6426eeff43f12b672337cbcda566b8)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

http2: limit number of concurrent transactions

[Browse files](/OISF/suricata/tree/b1549e930f6426eeff43f12b672337cbcda566b8)
Browse the repository at this point in the history

```
Ticket: 6481

Instead of just setting the old transactions to a drop state so
that they get later cleaned up by Suricata, fail creating new ones.

This is because one call to app-layer parsing can create many
transactions, and quadratic complexity could happen in one
single app-layer parsing because of find_or_create_tx

(cherry picked from commit [80abc22](https://github.com/OISF/suricata/commit/80abc22f6475b6a87a33166729a871203f34d578))
```

* Loading branch information

[![@catenacyber](https://avatars.githubusercontent.com/u/35799796?s=40&v=4)](/catenacyber) [![@victorjulien](https://avatars.githubusercontent.com/u/32410611?s=40&v=4)](/victorjulien)

[catenacyber](/OISF/suricata/commits?author=catenacyber "View all commits by catenacyber")
authored and
[victorjulien](/OISF/suricata/commits?author=victorjulien "View all commits by victorjulien")
committed
Feb 7, 2024

1 parent
[83c5567](/OISF/suricata/commit/83c5567ea7b0b28376f57dcfee9c6301448c7bc7)

commit b1549e9

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**41 additions**
and
**6 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* rust/src/http2

  + rust/src/http2/detect.rs
    [detect.rs](#diff-599641e61b3b13c2c68cc1bdf917f5a2f3629372dbc3fc09ffcf3cf920cf4f4e)
  + rust/src/http2/http2.rs
    [http2.rs](#diff-41f11afd5b2edbf0809c3c6435f08f9f084f2948bfc050fd38316fd22748c0e9)

## There are no files selected for viewing

4 changes: 2 additions & 2 deletions

4
[rust/src/http2/detect.rs](#diff-599641e61b3b13c2c68cc1bdf917f5a2f3629372dbc3fc09ffcf3cf920cf4f4e "rust/src/http2/detect.rs")

Show comments

[View file](/OISF/suricata/blob/b1549e930f6426eeff43f12b672337cbcda566b8/rust/src/http2/detect.rs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -911,7 +911,7 @@ fn http2\_tx\_set\_header(state: &mut HTTP2State, name: &[u8], input: &[u8]) { |
|  |  | blocks: blocks, |
|  |  | }; |
|  |  | let txdata = HTTP2FrameTypeData::HEADERS(hs); |
|  |  | let tx = state.find\_or\_create\_tx(&head, &txdata, STREAM\_TOSERVER); |
|  |  | let tx = state.find\_or\_create\_tx(&head, &txdata, STREAM\_TOSERVER).unwrap(); |
|  |  | tx.frames\_ts.push(HTTP2Frame { |
|  |  | header: head, |
|  |  | data: txdata, |
| Expand Down  Expand Up | | @@ -1052,7 +1052,7 @@ fn http2\_tx\_set\_settings(state: &mut HTTP2State, input: &[u8]) { |
|  |  | match parser::http2\_parse\_frame\_settings(&dec) { |
|  |  | Ok((\_, set)) => { |
|  |  | let txdata = HTTP2FrameTypeData::SETTINGS(set); |
|  |  | let tx = state.find\_or\_create\_tx(&head, &txdata, STREAM\_TOSERVER); |
|  |  | let tx = state.find\_or\_create\_tx(&head, &txdata, STREAM\_TOSERVER).unwrap(); |
|  |  | tx.frames\_ts.push(HTTP2Frame { |
|  |  | header: head, |
|  |  | data: txdata, |
| Expand Down | |  |

43 changes: 39 additions & 4 deletions

43
[rust/src/http2/http2.rs](#diff-41f11afd5b2edbf0809c3c6435f08f9f084f2948bfc050fd38316fd22748c0e9 "rust/src/http2/http2.rs")

Show comments

[View file](/OISF/suricata/blob/b1549e930f6426eeff43f12b672337cbcda566b8/rust/src/http2/http2.rs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -67,6 +67,7 @@ const HTTP2\_FRAME\_WINDOWUPDATE\_LEN: usize = 4; |
|  |  | pub const HTTP2\_MAX\_TABLESIZE: u32 = 0x10000; // 65536 |
|  |  | // maximum size of reassembly for header + continuation |
|  |  | static mut HTTP2\_MAX\_REASS: usize = 102400; |
|  |  | static mut HTTP2\_MAX\_STREAMS: usize = 4096; // 0x1000 |
|  |  |  |
|  |  | #[repr(u8)] |
|  |  | #[derive(Copy, Clone, PartialOrd, PartialEq, Debug)] |
| Expand Down  Expand Up | | @@ -117,6 +118,8 @@ pub enum HTTP2TransactionState { |
|  |  | HTTP2StateClosed = 7, |
|  |  | //not a RFC-defined state, used for stream 0 frames appyling to the global connection |
|  |  | HTTP2StateGlobal = 8, |
|  |  | //not a RFC-defined state, dropping this old tx because we have too many |
|  |  | HTTP2StateTodrop = 9, |
|  |  | } |
|  |  |  |
|  |  | #[derive(Debug)] |
| Expand Down  Expand Up | | @@ -365,6 +368,7 @@ pub enum HTTP2Event { |
|  |  | AuthorityHostMismatch, |
|  |  | UserinfoInUri, |
|  |  | ReassemblyLimitReached, |
|  |  | TooManyStreams, |
|  |  | } |
|  |  |  |
|  |  | impl HTTP2Event { |
| Expand All | | @@ -382,6 +386,7 @@ impl HTTP2Event { |
|  |  | 9 => Some(HTTP2Event::FailedDecompression), |
|  |  | 10 => Some(HTTP2Event::AuthorityHostMismatch), |
|  |  | 11 => Some(HTTP2Event::UserinfoInUri), |
|  |  | 12 => Some(HTTP2Event::TooManyStreams), |
|  |  | \_ => None, |
|  |  | } |
|  |  | } |
| Expand Down  Expand Up | | @@ -523,9 +528,21 @@ impl HTTP2State { |
|  |  |  |
|  |  | pub fn find\_or\_create\_tx( |
|  |  | &mut self, header: &parser::HTTP2FrameHeader, data: &HTTP2FrameTypeData, dir: u8, |
|  |  | ) -> &mut HTTP2Transaction { |
|  |  | ) -> Option<&mut HTTP2Transaction> { |
|  |  | if header.stream\_id == 0 { |
|  |  | return self.create\_global\_tx(); |
|  |  | if self.transactions.len() >= unsafe { HTTP2\_MAX\_STREAMS } { |
|  |  | for tx\_old in &mut self.transactions { |
|  |  | if tx\_old.state == HTTP2TransactionState::HTTP2StateTodrop { |
|  |  | // loop was already run |
|  |  | break; |
|  |  | } |
|  |  | tx\_old.set\_event(HTTP2Event::TooManyStreams); |
|  |  | // use a distinct state, even if we do not log it |
|  |  | tx\_old.state = HTTP2TransactionState::HTTP2StateTodrop; |
|  |  | } |
|  |  | return None; |
|  |  | } |
|  |  | return Some(self.create\_global\_tx()); |
|  |  | } |
|  |  | let sid = match data { |
|  |  | //yes, the right stream\_id for Suricata is not the header one |
| Expand All | | @@ -551,15 +568,28 @@ impl HTTP2State { |
|  |  | self.set\_event(HTTP2Event::StreamIdReuse); |
|  |  | } |
|  |  | } |
|  |  | return &mut self.transactions[index - 1]; |
|  |  | return Some(&mut self.transactions[index - 1]); |
|  |  | } else { |
|  |  | // do not use SETTINGS\_MAX\_CONCURRENT\_STREAMS as it can grow too much |
|  |  | if self.transactions.len() >= unsafe { HTTP2\_MAX\_STREAMS } { |
|  |  | for tx\_old in &mut self.transactions { |
|  |  | if tx\_old.state == HTTP2TransactionState::HTTP2StateTodrop { |
|  |  | // loop was already run |
|  |  | break; |
|  |  | } |
|  |  | tx\_old.set\_event(HTTP2Event::TooManyStreams); |
|  |  | // use a distinct state, even if we do not log it |
|  |  | tx\_old.state = HTTP2TransactionState::HTTP2StateTodrop; |
|  |  | } |
|  |  | return None; |
|  |  | } |
|  |  | let mut tx = HTTP2Transaction::new(); |
|  |  | self.tx\_id += 1; |
|  |  | tx.tx\_id = self.tx\_id; |
|  |  | tx.stream\_id = sid; |
|  |  | tx.state = HTTP2TransactionState::HTTP2StateOpen; |
|  |  | self.transactions.push\_back(tx); |
|  |  | return self.transactions.back\_mut().unwrap(); |
|  |  | return Some(self.transactions.back\_mut().unwrap()); |
|  |  | } |
|  |  | } |
|  |  |  |
| Expand Down  Expand Up | | @@ -925,6 +955,10 @@ impl HTTP2State { |
|  |  | ); |
|  |  |  |
|  |  | let tx = self.find\_or\_create\_tx(&head, &txdata, dir); |
|  |  | if tx.is\_none() { |
|  |  | return AppLayerResult::err(); |
|  |  | } |
|  |  | let tx = tx.unwrap(); |
|  |  | if reass\_limit\_reached { |
|  |  | tx.set\_event(HTTP2Event::ReassemblyLimitReached); |
|  |  | } |
| Expand Down  Expand Up | | @@ -1279,6 +1313,7 @@ pub extern "C" fn rs\_http2\_state\_get\_event\_info\_by\_id( |
|  |  | HTTP2Event::AuthorityHostMismatch => "authority\_host\_mismatch\0", |
|  |  | HTTP2Event::UserinfoInUri => "userinfo\_in\_uri\0", |
|  |  | HTTP2Event::ReassemblyLimitReached => "reassembly\_limit\_reached\0", |
|  |  | HTTP2Event::TooManyStreams => "too\_many\_streams\0", |
|  |  | }; |
|  |  | unsafe { |
|  |  | \*event\_name = estr.as\_ptr() as \*const std::os::raw::c\_char; |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `b1549e9`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOISF%2Fsuricata%2Fcommit%2Fb1549e930f6426eeff43f12b672337cbcda566b8) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from redmine.openinfosecfoundation.org_31098b2c_20250110_202749.html ===


⚲

### Project

### General

### Profile

* [Sign in](/login)
* [Register](/account/register)

* [Home](/)
* [Projects](/projects)
* [Help](https://www.redmine.org/guide)

[Search](/projects/suricata/search?scope=subprojects):

 Suricata[All Projects](/projects?jump=issues)
# Suricata

* [Overview](/projects/suricata)
* [Activity](/projects/suricata/activity)
* [Roadmap](/projects/suricata/roadmap)
* [Issues](/projects/suricata/issues)
* [Wiki](/projects/suricata/wiki)
* [Files](/projects/suricata/files)

### Custom queries

* [8.0.0 Stories](/projects/suricata/issues?query_id=90)
* [Good First Issues](/projects/suricata/issues?query_id=41)
* [OISF community](/projects/suricata/issues?query_id=3)

Actions
Copy link
## Security #6660

closed

[Security #6481](/issues/6481): http2: quadratic complexity in find\_or\_create\_tx not bounded by max-tx

### http2: quadratic complexity in find\_or\_create\_tx not bounded by max-tx (6.0.x backport)

Added by [OISF Ticketbot](/users/7712) [about 1 year](/projects/suricata/activity?from=2024-01-04 "01/04/2024 04:08 PM") ago.
Updated [11 months](/projects/suricata/activity?from=2024-02-26 "02/26/2024 01:47 PM") ago.

Status:ClosedPriority:NormalAssignee:[Philippe Antoine](/users/1820)Target version:[6.0.16](/versions/201 "02/08/2024")
Affected Versions:Label:CVE:[2024-23836](https://nvd.nist.gov/vuln/detail/CVE-2024-23836)Git IDs:

b1549e930f6426eeff43f12b672337cbcda566b8

Severity:LOWDisclosure Date:

* [History](/issues/6660?tab=history)
* [Notes](/issues/6660?tab=notes)
* [Property changes](/issues/6660?tab=properties)

ActionsCopy link
[#1](#note-1)
#### Updated by [Jason Ish](/users/9) [12 months](/projects/suricata/activity?from=2024-01-25 "01/25/2024 03:47 PM") ago

* **Severity** changed from *MODERATE* to *CRITICAL*

ActionsCopy link
[#2](#note-2)
#### Updated by [Jason Ish](/users/9) [12 months](/projects/suricata/activity?from=2024-01-30 "01/30/2024 02:33 PM") ago

* **Status** changed from *Assigned* to *In Review*

ActionsCopy link
[#3](#note-3)
#### Updated by [Victor Julien](/users/4) [11 months](/projects/suricata/activity?from=2024-02-08 "02/08/2024 08:55 AM") ago

* **Status** changed from *In Review* to *Resolved*

ActionsCopy link
[#4](#note-4)
#### Updated by [Victor Julien](/users/4) [11 months](/projects/suricata/activity?from=2024-02-08 "02/08/2024 09:33 AM") ago

* **CVE** set to *2024-23836*
* **Severity** changed from *CRITICAL* to *LOW*

LOW severity as HTTP2 is considered experimental and disabled by default in 6.0.x.

ActionsCopy link
[#5](#note-5)
#### Updated by [Philippe Antoine](/users/1820) [11 months](/projects/suricata/activity?from=2024-02-12 "02/12/2024 10:35 AM") ago

* **Status** changed from *Resolved* to *Closed*
* **Git IDs** updated ([diff](/journals/32535/diff?detail_id=33203 "View differences"))

ActionsCopy link
[#6](#note-6)
#### Updated by [Victor Julien](/users/4) [11 months](/projects/suricata/activity?from=2024-02-26 "02/26/2024 10:32 AM") ago

* **Private** changed from *Yes* to *No*

ActionsCopy link
[#7](#note-7)
#### Updated by [Victor Julien](/users/4) [11 months](/projects/suricata/activity?from=2024-02-26 "02/26/2024 01:47 PM") ago

<https://github.com/OISF/suricata/security/advisories/GHSA-q33q-45cr-3cpc>

Actions
Copy link

Also available in: [Atom](/issues/6660.atom)
[PDF](/issues/6660.pdf)

Powered by [Redmine](https://www.redmine.org/) © 2006-2024 Jean-Philippe Lang

Loading...



=== Content from redmine.openinfosecfoundation.org_e6d42489_20250110_202749.html ===


⚲

### Project

### General

### Profile

* [Sign in](/login)
* [Register](/account/register)

* [Home](/)
* [Projects](/projects)
* [Help](https://www.redmine.org/guide)

[Search](/projects/suricata/search?scope=subprojects):

 Suricata[All Projects](/projects?jump=issues)
# Suricata

* [Overview](/projects/suricata)
* [Activity](/projects/suricata/activity)
* [Roadmap](/projects/suricata/roadmap)
* [Issues](/projects/suricata/issues)
* [Wiki](/projects/suricata/wiki)
* [Files](/projects/suricata/files)

### Custom queries

* [8.0.0 Stories](/projects/suricata/issues?query_id=90)
* [Good First Issues](/projects/suricata/issues?query_id=41)
* [OISF community](/projects/suricata/issues?query_id=3)

Actions
Copy link
## Security #6658

closed

[Security #5921](/issues/5921): http1: configurable limit for maximum number of live transactions per flow

### http1: configurable limit for maximum number of live transactions per flow (6.0.x backport)

Added by [OISF Ticketbot](/users/7712) [about 1 year](/projects/suricata/activity?from=2024-01-04 "01/04/2024 04:04 PM") ago.
Updated [11 months](/projects/suricata/activity?from=2024-02-26 "02/26/2024 01:47 PM") ago.

Status:ClosedPriority:NormalAssignee:[Philippe Antoine](/users/1820)Target version:[6.0.16](/versions/201 "02/08/2024")
Affected Versions:Label:CVE:[2024-23836](https://nvd.nist.gov/vuln/detail/CVE-2024-23836)Git IDs:

8efaebe293e2a74c8e323fa85a6f5fadf82801bc

18841a58da71e735ddf4e52cbfa6989755ecbeb7

Severity:CRITICALDisclosure Date:

* [History](/issues/6658?tab=history)
* [Notes](/issues/6658?tab=notes)
* [Property changes](/issues/6658?tab=properties)

ActionsCopy link
[#1](#note-1)
#### Updated by [Jason Ish](/users/9) [12 months](/projects/suricata/activity?from=2024-01-25 "01/25/2024 03:47 PM") ago

* **Severity** changed from *MODERATE* to *CRITICAL*

ActionsCopy link
[#2](#note-2)
#### Updated by [Jason Ish](/users/9) [12 months](/projects/suricata/activity?from=2024-01-30 "01/30/2024 02:33 PM") ago

* **Status** changed from *Assigned* to *In Review*

ActionsCopy link
[#3](#note-3)
#### Updated by [Victor Julien](/users/4) [11 months](/projects/suricata/activity?from=2024-02-08 "02/08/2024 08:55 AM") ago

* **Status** changed from *In Review* to *Resolved*

ActionsCopy link
[#4](#note-4)
#### Updated by [Victor Julien](/users/4) [11 months](/projects/suricata/activity?from=2024-02-08 "02/08/2024 09:31 AM") ago

* **CVE** set to *2024-23836*

ActionsCopy link
[#5](#note-5)
#### Updated by [Philippe Antoine](/users/1820) [11 months](/projects/suricata/activity?from=2024-02-12 "02/12/2024 10:34 AM") ago

* **Status** changed from *Resolved* to *Closed*
* **Git IDs** updated ([diff](/journals/32532/diff?detail_id=33197 "View differences"))

ActionsCopy link
[#6](#note-6)
#### Updated by [Philippe Antoine](/users/1820) [11 months](/projects/suricata/activity?from=2024-02-12 "02/12/2024 10:36 AM") ago

* **Git IDs** updated ([diff](/journals/32536/diff?detail_id=33204 "View differences"))

ActionsCopy link
[#7](#note-7)
#### Updated by [Victor Julien](/users/4) [11 months](/projects/suricata/activity?from=2024-02-26 "02/26/2024 10:32 AM") ago

* **Private** changed from *Yes* to *No*

ActionsCopy link
[#8](#note-8)
#### Updated by [Victor Julien](/users/4) [11 months](/projects/suricata/activity?from=2024-02-26 "02/26/2024 01:47 PM") ago

<https://github.com/OISF/suricata/security/advisories/GHSA-q33q-45cr-3cpc>

Actions
Copy link

Also available in: [Atom](/issues/6658.atom)
[PDF](/issues/6658.pdf)

Powered by [Redmine](https://www.redmine.org/) © 2006-2024 Jean-Philippe Lang

Loading...



=== Content from lists.fedoraproject.org_260a494e_20250110_202747.html ===


[![Fedora Mailing-Lists](/static/logo-hyperkitty-fedora.png)](/archives/ "Fedora Mailing-Lists")

[Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/ZXJIT7R53ZXROO3I256RFUWTIW4ECK6P/)
[Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/ZXJIT7R53ZXROO3I256RFUWTIW4ECK6P/)

* [Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/ZXJIT7R53ZXROO3I256RFUWTIW4ECK6P/)
* [Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/ZXJIT7R53ZXROO3I256RFUWTIW4ECK6P/)

* [Manage this list](/admin/lists/package-announce.lists.fedoraproject.org/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

### 2025

* [January](/archives/list/package-announce%40lists.fedoraproject.org/2025/1/)

### 2024

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2024/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2024/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2024/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2024/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2024/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2024/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2024/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2024/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2024/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2024/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2024/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2024/1/)

### 2023

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2023/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2023/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2023/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2023/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2023/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2023/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2023/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2023/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2023/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2023/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2023/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2023/1/)

### 2022

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2022/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2022/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2022/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2022/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2022/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2022/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2022/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2022/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2022/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2022/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2022/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2022/1/)

### 2021

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2021/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2021/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2021/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2021/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2021/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2021/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2021/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2021/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2021/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2021/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2021/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2021/1/)

### 2020

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2020/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2020/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2020/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2020/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2020/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2020/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2020/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2020/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2020/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2020/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2020/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2020/1/)

### 2019

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2019/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2019/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2019/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2019/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2019/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2019/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2019/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2019/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2019/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2019/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2019/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2019/1/)

### 2018

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2018/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2018/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2018/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2018/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2018/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2018/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2018/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2018/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2018/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2018/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2018/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2018/1/)

### 2017

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2017/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2017/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2017/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2017/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2017/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2017/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2017/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2017/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2017/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2017/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2017/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2017/1/)

### 2016

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2016/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2016/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2016/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2016/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2016/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2016/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2016/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2016/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2016/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2016/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2016/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2016/1/)

### 2015

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2015/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2015/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2015/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2015/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2015/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2015/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2015/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2015/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2015/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2015/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2015/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2015/1/)

### 2014

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2014/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2014/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2014/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2014/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2014/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2014/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2014/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2014/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2014/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2014/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2014/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2014/1/)

### 2013

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2013/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2013/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2013/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2013/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2013/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2013/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2013/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2013/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2013/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2013/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2013/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2013/1/)

### 2012

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2012/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2012/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2012/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2012/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2012/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2012/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2012/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2012/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2012/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2012/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2012/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2012/1/)

### 2011

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2011/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2011/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2011/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2011/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2011/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2011/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2011/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2011/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2011/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2011/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2011/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2011/1/)

### 2010

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2010/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2010/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2010/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2010/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2010/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2010/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2010/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2010/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2010/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2010/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2010/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2010/1/)

### 2009

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2009/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2009/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2009/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2009/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2009/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2009/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2009/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2009/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2009/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2009/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2009/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2009/1/)

### 2008

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2008/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2008/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2008/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2008/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2008/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2008/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2008/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2008/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2008/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2008/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2008/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2008/1/)

### 2007

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2007/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2007/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2007/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2007/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2007/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2007/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2007/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2007/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2007/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2007/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2007/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2007/1/)

### 2006

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2006/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2006/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2006/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2006/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2006/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2006/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2006/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2006/5/)

[List overview](/archives/list/package-announce%40lists.fedoraproject.org/)

[Download](/archives/list/package-announce%40lists.fedoraproject.org/export/package-announce%40lists.fedoraproject.org-ZXJIT7R53ZXROO3I256RFUWTIW4ECK6P.mbox.gz?message=ZXJIT7R53ZXROO3I256RFUWTIW4ECK6P "This message in gzipped mbox format")

[thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/ZXJIT7R53ZXROO3I256RFUWTIW4ECK6P/#ZXJIT7R53ZXROO3I256RFUWTIW4ECK6P)

# [SECURITY] Fedora 38 Update: suricata-6.0.16-1.fc38

![](https://seccdn.libravatar.org/avatar/be256568dfce45c1862b55e6cf3f2726.jpg?s=120&d=retro&r=g)

[updates＠fedoraproject.org](/archives/users/3d8bb2e4c1d843beb492d4f8a7c44761/ "See the profile for updates＠fedoraproject.org")

7 Mar
2024

7 Mar
'24

1:50 a.m.

--------------------------------------------------------------------------------
Fedora Update Notification
FEDORA-2024-7b063bce0a
2024-03-07 01:49:42.076779
--------------------------------------------------------------------------------

Name : suricata
Product : Fedora 38
Version : 6.0.16
Release : 1.fc38
URL : <https://suricata-ids.org/>
Summary : Intrusion Detection System
Description :
The Suricata Engine is an Open Source Next Generation Intrusion
Detection and Prevention Engine. This engine is not intended to
just replace or emulate the existing tools in the industry, but
will bring new ideas and technologies to the field. This new Engine
supports Multi-threading, Automatic Protocol Detection (IP, TCP,
UDP, ICMP, HTTP, TLS, FTP and SMB! ), Gzip Decompression, Fast IP
Matching, and GeoIP identification.

--------------------------------------------------------------------------------
Update Information:

This update fixes: CVE-2024-23835, CVE-2024-23836, CVE-2024-23837,
CVE-2024-23839, CVE-2024-24568.
--------------------------------------------------------------------------------
ChangeLog:

\* Mon Feb 26 2024 Steve Grubb sgrubb@redhat.com 6.0.16-1
- New security and bugfix release
--------------------------------------------------------------------------------
References:

[ 1 ] Bug #2266171 - CVE-2024-24568 suricata: potential bypass of rules inspecting HTTP2 headers [epel-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=2266171>
[ 2 ] Bug #2266172 - CVE-2024-24568 suricata: potential bypass of rules inspecting HTTP2 headers [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=2266172>
--------------------------------------------------------------------------------

This update can be installed with the "dnf" update program. Use
su -c 'dnf upgrade --advisory FEDORA-2024-7b063bce0a' at the command
line. For more information, refer to the dnf documentation available at
<http://dnf.readthedocs.io/en/latest/command_ref.html#upgrade-command-label>

All packages are signed with the Fedora Project GPG key. More details on the
GPG keys used by the Fedora Project can be found at
<https://fedoraproject.org/keys>
--------------------------------------------------------------------------------

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Back to the thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/ZXJIT7R53ZXROO3I256RFUWTIW4ECK6P/#ZXJIT7R53ZXROO3I256RFUWTIW4ECK6P)

[Back to the list](/archives/list/package-announce%40lists.fedoraproject.org/)

Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.7.



=== Content from github.com_1b34be40_20250110_202739.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOISF%2Fsuricata%2Fcommit%2F2a2120ecf10c5b5713ec2bf59469fe57f7b5b747)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOISF%2Fsuricata%2Fcommit%2F2a2120ecf10c5b5713ec2bf59469fe57f7b5b747)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=OISF%2Fsuricata)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[OISF](/OISF)
/
**[suricata](/OISF/suricata)**
Public

* [Notifications](/login?return_to=%2FOISF%2Fsuricata) You must be signed in to change notification settings
* [Fork
  1.5k](/login?return_to=%2FOISF%2Fsuricata)
* [Star
   4.8k](/login?return_to=%2FOISF%2Fsuricata)

* [Code](/OISF/suricata)
* [Pull requests
  71](/OISF/suricata/pulls)
* [Actions](/OISF/suricata/actions)
* [Security](/OISF/suricata/security)
* [Insights](/OISF/suricata/pulse)

Additional navigation options

* [Code](/OISF/suricata)
* [Pull requests](/OISF/suricata/pulls)
* [Actions](/OISF/suricata/actions)
* [Security](/OISF/suricata/security)
* [Insights](/OISF/suricata/pulse)

## Commit

[Permalink](/OISF/suricata/commit/2a2120ecf10c5b5713ec2bf59469fe57f7b5b747)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

smtp: config limit maximum number of live transactions

[Browse files](/OISF/suricata/tree/2a2120ecf10c5b5713ec2bf59469fe57f7b5b747)
Browse the repository at this point in the history

```
Unlike the original commit, this fix just sets a limit but does not
expose it as a configurable option.

Ticket: [#6477](https://github.com/OISF/suricata/pull/6477)

(cherry picked from commit [8f73a0a](https://github.com/OISF/suricata/commit/8f73a0ac5588cb5e5c501b3c7a07cb5d35b99d92))
```

* Loading branch information

[![@catenacyber](https://avatars.githubusercontent.com/u/35799796?s=40&v=4)](/catenacyber) [![@victorjulien](https://avatars.githubusercontent.com/u/32410611?s=40&v=4)](/victorjulien)

[catenacyber](/OISF/suricata/commits?author=catenacyber "View all commits by catenacyber")
authored and
[victorjulien](/OISF/suricata/commits?author=victorjulien "View all commits by victorjulien")
committed
Feb 7, 2024

1 parent
[8efaebe](/OISF/suricata/commit/8efaebe293e2a74c8e323fa85a6f5fadf82801bc)

commit 2a2120e

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**16 additions**
and
**5 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src

  + src/app-layer-smtp.c
    [app-layer-smtp.c](#diff-2211b552dfe681c733c77810415590ea78e61d8dbfc828fda8c9e5c9cb470610)
  + src/app-layer-smtp.h
    [app-layer-smtp.h](#diff-e1bb5985f5b1cdcd973f884c8276d67bd37482804ad2f08b75f474043212650d)

## There are no files selected for viewing

20 changes: 15 additions & 5 deletions

20
[src/app-layer-smtp.c](#diff-2211b552dfe681c733c77810415590ea78e61d8dbfc828fda8c9e5c9cb470610 "src/app-layer-smtp.c")

Show comments

[View file](/OISF/suricata/blob/2a2120ecf10c5b5713ec2bf59469fe57f7b5b747/src/app-layer-smtp.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -111,6 +111,8 @@ |
|  |  | #define SMTP\_EHLO\_EXTENSION\_STARTTLS |
|  |  | #define SMTP\_EHLO\_EXTENSION\_8BITMIME |
|  |  |  |
|  |  | #define SMTP\_DEFAULT\_MAX\_TX 256 |
|  |  |  |
|  |  | SCEnumCharMap smtp\_decoder\_event\_table[] = { |
|  |  | { "INVALID\_REPLY", SMTP\_DECODER\_EVENT\_INVALID\_REPLY }, |
|  |  | { "UNABLE\_TO\_MATCH\_REPLY\_WITH\_REQUEST", SMTP\_DECODER\_EVENT\_UNABLE\_TO\_MATCH\_REPLY\_WITH\_REQUEST }, |
| Expand Down  Expand Up | | @@ -218,7 +220,8 @@ SCEnumCharMap smtp\_reply\_map[ ] = { |
|  |  | }; |
|  |  |  |
|  |  | /\* Create SMTP config structure \*/ |
|  |  | SMTPConfig smtp\_config = { 0, { 0, 0, 0, 0, 0 }, 0, 0, 0, 0, STREAMING\_BUFFER\_CONFIG\_INITIALIZER}; |
|  |  | SMTPConfig smtp\_config = { 0, { 0, 0, 0, 0, 0 }, 0, 0, 0, SMTP\_DEFAULT\_MAX\_TX, 0, |
|  |  | STREAMING\_BUFFER\_CONFIG\_INITIALIZER }; |
|  |  |  |
|  |  | static SMTPString \*SMTPStringAlloc(void); |
|  |  | static int SMTPPreProcessCommands(SMTPState \*state, Flow \*f, AppLayerParserState \*pstate); |
| Expand Down  Expand Up | | @@ -327,6 +330,8 @@ static void SMTPConfigure(void) { |
|  |  | smtp\_config.raw\_extraction = 0; |
|  |  | } |
|  |  |  |
|  |  | smtp\_config.max\_tx = SMTP\_DEFAULT\_MAX\_TX; |
|  |  |  |
|  |  | SCReturn; |
|  |  | } |
|  |  |  |
| Expand All | | @@ -342,8 +347,11 @@ static void SMTPSetEvent(SMTPState \*s, uint8\_t e) |
|  |  | SCLogDebug("couldn't set event %u", e); |
|  |  | } |
|  |  |  |
|  |  | static SMTPTransaction \*SMTPTransactionCreate(void) |
|  |  | static SMTPTransaction \*SMTPTransactionCreate(SMTPState \*state) |
|  |  | { |
|  |  | if (state->tx\_cnt > smtp\_config.max\_tx) { |
|  |  | return NULL; |
|  |  | } |
|  |  | SMTPTransaction \*tx = SCCalloc(1, sizeof(\*tx)); |
|  |  | if (tx == NULL) { |
|  |  | return NULL; |
| Expand Down  Expand Up | | @@ -1081,7 +1089,7 @@ static int SMTPProcessRequest(SMTPState \*state, Flow \*f, |
|  |  | return 0; |
|  |  | } |
|  |  | if (state->curr\_tx == NULL || (state->curr\_tx->done && !NoNewTx(state))) { |
|  |  | tx = SMTPTransactionCreate(); |
|  |  | tx = SMTPTransactionCreate(state); |
|  |  | if (tx == NULL) |
|  |  | return -1; |
|  |  | state->curr\_tx = tx; |
| Expand Down  Expand Up | | @@ -1124,7 +1132,7 @@ static int SMTPProcessRequest(SMTPState \*state, Flow \*f, |
|  |  | // we did not close the previous tx, set error |
|  |  | SMTPSetEvent(state, SMTP\_DECODER\_EVENT\_UNPARSABLE\_CONTENT); |
|  |  | FileCloseFile(state->files\_ts, NULL, 0, FILE\_TRUNCATED); |
|  |  | tx = SMTPTransactionCreate(); |
|  |  | tx = SMTPTransactionCreate(state); |
|  |  | if (tx == NULL) |
|  |  | return -1; |
|  |  | state->curr\_tx = tx; |
| Expand All | | @@ -1143,7 +1151,7 @@ static int SMTPProcessRequest(SMTPState \*state, Flow \*f, |
|  |  | \* of first one. So we start a new transaction. \*/ |
|  |  | tx->mime\_state->state\_flag = PARSE\_ERROR; |
|  |  | SMTPSetEvent(state, SMTP\_DECODER\_EVENT\_UNPARSABLE\_CONTENT); |
|  |  | tx = SMTPTransactionCreate(); |
|  |  | tx = SMTPTransactionCreate(state); |
|  |  | if (tx == NULL) |
|  |  | return -1; |
|  |  | state->curr\_tx = tx; |
| Expand Down  Expand Up | | @@ -1905,6 +1913,8 @@ static void SMTPTestInitConfig(void) |
|  |  | smtp\_config.content\_inspect\_window = FILEDATA\_CONTENT\_INSPECT\_WINDOW; |
|  |  | smtp\_config.content\_inspect\_min\_size = FILEDATA\_CONTENT\_INSPECT\_MIN\_SIZE; |
|  |  |  |
|  |  | smtp\_config.max\_tx = SMTP\_DEFAULT\_MAX\_TX; |
|  |  |  |
|  |  | smtp\_config.sbcfg.buf\_size = FILEDATA\_CONTENT\_INSPECT\_WINDOW; |
|  |  | } |
|  |  |  |
| Expand Down | |  |

1 change: 1 addition & 0 deletions

1
[src/app-layer-smtp.h](#diff-e1bb5985f5b1cdcd973f884c8276d67bd37482804ad2f08b75f474043212650d "src/app-layer-smtp.h")

Show comments

[View file](/OISF/suricata/blob/2a2120ecf10c5b5713ec2bf59469fe57f7b5b747/src/app-layer-smtp.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -103,6 +103,7 @@ typedef struct SMTPConfig { |
|  |  | uint32\_t content\_limit; |
|  |  | uint32\_t content\_inspect\_min\_size; |
|  |  | uint32\_t content\_inspect\_window; |
|  |  | uint64\_t max\_tx; |
|  |  |  |
|  |  | int raw\_extraction; |
|  |  |  |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `2a2120e`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOISF%2Fsuricata%2Fcommit%2F2a2120ecf10c5b5713ec2bf59469fe57f7b5b747) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_a7adbf1f_20250110_202747.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOISF%2Fsuricata%2Fsecurity%2Fadvisories%2FGHSA-q33q-45cr-3cpc)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOISF%2Fsuricata%2Fsecurity%2Fadvisories%2FGHSA-q33q-45cr-3cpc)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=OISF%2Fsuricata)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[OISF](/OISF)
/
**[suricata](/OISF/suricata)**
Public

* [Notifications](/login?return_to=%2FOISF%2Fsuricata) You must be signed in to change notification settings
* [Fork
  1.5k](/login?return_to=%2FOISF%2Fsuricata)
* [Star
   4.8k](/login?return_to=%2FOISF%2Fsuricata)

* [Code](/OISF/suricata)
* [Pull requests
  71](/OISF/suricata/pulls)
* [Actions](/OISF/suricata/actions)
* [Security](/OISF/suricata/security)
* [Insights](/OISF/suricata/pulse)

Additional navigation options

* [Code](/OISF/suricata)
* [Pull requests](/OISF/suricata/pulls)
* [Actions](/OISF/suricata/actions)
* [Security](/OISF/suricata/security)
* [Insights](/OISF/suricata/pulse)

# crafted traffic can cause denial of service

High

[victorjulien](/victorjulien)
published
GHSA-q33q-45cr-3cpc
Feb 26, 2024

## Package

suricata

## Affected versions

<= 6.0.15
>= 7.0.0, <= 7.0.2

## Patched versions

6.0.16
7.0.3

## Description

### Impact

An attacker can craft traffic to cause Suricata to use far more CPU and memory for processing the traffic than needed, which can lead to extreme slow downs and denial of service.

### Patches

Upgrade to 6.0.16 or 7.0.3.

### Workarounds

Disable affected protocol app-layer parser in the yaml.

A reduced `stream.reassembly.depth` value helps reduce the severity of the issue.

### References

<https://redmine.openinfosecfoundation.org/issues/6658> (6.0.x)

<https://redmine.openinfosecfoundation.org/issues/6659> (6.0.x)

<https://redmine.openinfosecfoundation.org/issues/6660> (6.0.x)

<https://redmine.openinfosecfoundation.org/issues/6532> (7.0.x)

<https://redmine.openinfosecfoundation.org/issues/6540> (7.0.x)

<https://redmine.openinfosecfoundation.org/issues/6531> (7.0.x)

These tickets are private until about 2 weeks after release.

### Credits

Found by OSS-Fuzz using quadfuzz.

### Severity

High

7.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
None

Integrity
None

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H

### CVE ID

CVE-2024-23836

### Weaknesses

[CWE-770](/advisories?query=cwe%3A770)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from redmine.openinfosecfoundation.org_9f8e3298_20250110_202749.html ===


⚲

### Project

### General

### Profile

* [Sign in](/login)
* [Register](/account/register)

* [Home](/)
* [Projects](/projects)
* [Help](https://www.redmine.org/guide)

[Search](/projects/suricata/search?scope=subprojects):

 Suricata[All Projects](/projects?jump=issues)
# Suricata

* [Overview](/projects/suricata)
* [Activity](/projects/suricata/activity)
* [Roadmap](/projects/suricata/roadmap)
* [Issues](/projects/suricata/issues)
* [Wiki](/projects/suricata/wiki)
* [Files](/projects/suricata/files)

### Custom queries

* [8.0.0 Stories](/projects/suricata/issues?query_id=90)
* [Good First Issues](/projects/suricata/issues?query_id=41)
* [OISF community](/projects/suricata/issues?query_id=3)

Actions
Copy link
## Security #6659

closed

[Security #6477](/issues/6477): SMTP: quadratic complexity from unbounded number of transaction per flow

### SMTP: quadratic complexity from unbounded number of transaction per flow (6.0.x backport)

Added by [OISF Ticketbot](/users/7712) [about 1 year](/projects/suricata/activity?from=2024-01-04 "01/04/2024 04:06 PM") ago.
Updated [11 months](/projects/suricata/activity?from=2024-02-26 "02/26/2024 01:47 PM") ago.

Status:ClosedPriority:NormalAssignee:[Philippe Antoine](/users/1820)Target version:[6.0.16](/versions/201 "02/08/2024")
Affected Versions:Label:CVE:[2024-23836](https://nvd.nist.gov/vuln/detail/CVE-2024-23836)Git IDs:

2a2120ecf10c5b5713ec2bf59469fe57f7b5b747

83c5567ea7b0b28376f57dcfee9c6301448c7bc7

Severity:CRITICALDisclosure Date:

* [History](/issues/6659?tab=history)
* [Notes](/issues/6659?tab=notes)
* [Property changes](/issues/6659?tab=properties)

ActionsCopy link
[#1](#note-1)
#### Updated by [Jason Ish](/users/9) [12 months](/projects/suricata/activity?from=2024-01-25 "01/25/2024 03:47 PM") ago

* **Severity** changed from *MODERATE* to *CRITICAL*

ActionsCopy link
[#2](#note-2)
#### Updated by [Jason Ish](/users/9) [12 months](/projects/suricata/activity?from=2024-01-30 "01/30/2024 02:33 PM") ago

* **Status** changed from *Assigned* to *In Review*

ActionsCopy link
[#3](#note-3)
#### Updated by [Victor Julien](/users/4) [11 months](/projects/suricata/activity?from=2024-02-08 "02/08/2024 08:55 AM") ago

* **Status** changed from *In Review* to *Resolved*

ActionsCopy link
[#4](#note-4)
#### Updated by [Victor Julien](/users/4) [11 months](/projects/suricata/activity?from=2024-02-08 "02/08/2024 09:34 AM") ago

* **CVE** set to *2024-23836*

ActionsCopy link
[#5](#note-5)
#### Updated by [Philippe Antoine](/users/1820) [11 months](/projects/suricata/activity?from=2024-02-12 "02/12/2024 10:34 AM") ago

* **Status** changed from *Resolved* to *Closed*
* **Git IDs** updated ([diff](/journals/32533/diff?detail_id=33199 "View differences"))

ActionsCopy link
[#6](#note-6)
#### Updated by [Victor Julien](/users/4) [11 months](/projects/suricata/activity?from=2024-02-26 "02/26/2024 10:32 AM") ago

* **Private** changed from *Yes* to *No*

ActionsCopy link
[#7](#note-7)
#### Updated by [Victor Julien](/users/4) [11 months](/projects/suricata/activity?from=2024-02-26 "02/26/2024 01:47 PM") ago

<https://github.com/OISF/suricata/security/advisories/GHSA-q33q-45cr-3cpc>

Actions
Copy link

Also available in: [Atom](/issues/6659.atom)
[PDF](/issues/6659.pdf)

Powered by [Redmine](https://www.redmine.org/) © 2006-2024 Jean-Philippe Lang

Loading...



=== Content from redmine.openinfosecfoundation.org_36b8c5e3_20250110_202748.html ===


⚲

### Project

### General

### Profile

* [Sign in](/login)
* [Register](/account/register)

* [Home](/)
* [Projects](/projects)
* [Help](https://www.redmine.org/guide)

[Search](/projects/suricata/search?scope=subprojects):

 Suricata[All Projects](/projects?jump=issues)
# Suricata

* [Overview](/projects/suricata)
* [Activity](/projects/suricata/activity)
* [Roadmap](/projects/suricata/roadmap)
* [Issues](/projects/suricata/issues)
* [Wiki](/projects/suricata/wiki)
* [Files](/projects/suricata/files)

### Custom queries

* [8.0.0 Stories](/projects/suricata/issues?query_id=90)
* [Good First Issues](/projects/suricata/issues?query_id=41)
* [OISF community](/projects/suricata/issues?query_id=3)

Actions
Copy link
## Security #6531

closed

[Security #6481](/issues/6481): http2: quadratic complexity in find\_or\_create\_tx not bounded by max-tx

### http2: quadratic complexity in find\_or\_create\_tx not bounded by max-tx (7.0.x backport)

Added by [OISF Ticketbot](/users/7712) [about 1 year](/projects/suricata/activity?from=2023-11-17 "11/17/2023 12:17 PM") ago.
Updated [11 months](/projects/suricata/activity?from=2024-02-26 "02/26/2024 01:47 PM") ago.

Status:ClosedPriority:NormalAssignee:[Philippe Antoine](/users/1820)Target version:[7.0.3](/versions/200 "02/08/2024")
Affected Versions:Label:CVE:[2024-23836](https://nvd.nist.gov/vuln/detail/CVE-2024-23836)Git IDs:

ce9b90326949c94a46611d6394e28600ee5e8bd5

Severity:CRITICALDisclosure Date:

* [History](/issues/6531?tab=history)
* [Notes](/issues/6531?tab=notes)
* [Property changes](/issues/6531?tab=properties)

ActionsCopy link
[#1](#note-1)
#### Updated by [Jason Ish](/users/9) [12 months](/projects/suricata/activity?from=2024-01-25 "01/25/2024 03:52 PM") ago

* **Severity** changed from *MODERATE* to *CRITICAL*

ActionsCopy link
[#2](#note-2)
#### Updated by [Victor Julien](/users/4) [11 months](/projects/suricata/activity?from=2024-02-08 "02/08/2024 08:59 AM") ago

* **Status** changed from *Assigned* to *Resolved*

ActionsCopy link
[#3](#note-3)
#### Updated by [Victor Julien](/users/4) [11 months](/projects/suricata/activity?from=2024-02-08 "02/08/2024 09:32 AM") ago

* **CVE** set to *2024-23836*

ActionsCopy link
[#4](#note-4)
#### Updated by [Philippe Antoine](/users/1820) [11 months](/projects/suricata/activity?from=2024-02-12 "02/12/2024 10:41 AM") ago

* **Status** changed from *Resolved* to *Closed*
* **Git IDs** updated ([diff](/journals/32543/diff?detail_id=33218 "View differences"))

ActionsCopy link
[#5](#note-5)
#### Updated by [Victor Julien](/users/4) [11 months](/projects/suricata/activity?from=2024-02-26 "02/26/2024 10:32 AM") ago

* **Private** changed from *Yes* to *No*

ActionsCopy link
[#6](#note-6)
#### Updated by [Victor Julien](/users/4) [11 months](/projects/suricata/activity?from=2024-02-26 "02/26/2024 01:47 PM") ago

<https://github.com/OISF/suricata/security/advisories/GHSA-q33q-45cr-3cpc>

Actions
Copy link

Also available in: [Atom](/issues/6531.atom)
[PDF](/issues/6531.pdf)

Powered by [Redmine](https://www.redmine.org/) © 2006-2024 Jean-Philippe Lang

Loading...



=== Content from github.com_14326e42_20250110_202744.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOISF%2Fsuricata%2Fcommit%2Fce9b90326949c94a46611d6394e28600ee5e8bd5)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOISF%2Fsuricata%2Fcommit%2Fce9b90326949c94a46611d6394e28600ee5e8bd5)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=OISF%2Fsuricata)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[OISF](/OISF)
/
**[suricata](/OISF/suricata)**
Public

* [Notifications](/login?return_to=%2FOISF%2Fsuricata) You must be signed in to change notification settings
* [Fork
  1.5k](/login?return_to=%2FOISF%2Fsuricata)
* [Star
   4.8k](/login?return_to=%2FOISF%2Fsuricata)

* [Code](/OISF/suricata)
* [Pull requests
  71](/OISF/suricata/pulls)
* [Actions](/OISF/suricata/actions)
* [Security](/OISF/suricata/security)
* [Insights](/OISF/suricata/pulse)

Additional navigation options

* [Code](/OISF/suricata)
* [Pull requests](/OISF/suricata/pulls)
* [Actions](/OISF/suricata/actions)
* [Security](/OISF/suricata/security)
* [Insights](/OISF/suricata/pulse)

## Commit

[Permalink](/OISF/suricata/commit/ce9b90326949c94a46611d6394e28600ee5e8bd5)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

http2: limit number of concurrent transactions

[Browse files](/OISF/suricata/tree/ce9b90326949c94a46611d6394e28600ee5e8bd5)
Browse the repository at this point in the history

```
Ticket: 6481

Instead of just setting the old transactions to a drop state so
that they get later cleaned up by Suricata, fail creating new ones.

This is because one call to app-layer parsing can create many
transactions, and quadratic complexity could happen in one
single app-layer parsing because of find_or_create_tx

(cherry picked from commit [80abc22](https://github.com/OISF/suricata/commit/80abc22f6475b6a87a33166729a871203f34d578))
```

* Loading branch information

[![@catenacyber](https://avatars.githubusercontent.com/u/35799796?s=40&v=4)](/catenacyber) [![@victorjulien](https://avatars.githubusercontent.com/u/32410611?s=40&v=4)](/victorjulien)

[catenacyber](/OISF/suricata/commits?author=catenacyber "View all commits by catenacyber")
authored and
[victorjulien](/OISF/suricata/commits?author=victorjulien "View all commits by victorjulien")
committed
Feb 6, 2024

1 parent
[b0d762d](/OISF/suricata/commit/b0d762d2675a2441b74e039d54bfa5b050641f8e)

commit ce9b903

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**34 additions**
and
**17 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* rust/src/http2

  + rust/src/http2/detect.rs
    [detect.rs](#diff-599641e61b3b13c2c68cc1bdf917f5a2f3629372dbc3fc09ffcf3cf920cf4f4e)
  + rust/src/http2/http2.rs
    [http2.rs](#diff-41f11afd5b2edbf0809c3c6435f08f9f084f2948bfc050fd38316fd22748c0e9)

## There are no files selected for viewing

4 changes: 2 additions & 2 deletions

4
[rust/src/http2/detect.rs](#diff-599641e61b3b13c2c68cc1bdf917f5a2f3629372dbc3fc09ffcf3cf920cf4f4e "rust/src/http2/detect.rs")

Show comments

[View file](/OISF/suricata/blob/ce9b90326949c94a46611d6394e28600ee5e8bd5/rust/src/http2/detect.rs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -932,7 +932,7 @@ fn http2\_tx\_set\_header(state: &mut HTTP2State, name: &[u8], input: &[u8]) { |
|  |  | blocks, |
|  |  | }; |
|  |  | let txdata = HTTP2FrameTypeData::HEADERS(hs); |
|  |  | let tx = state.find\_or\_create\_tx(&head, &txdata, Direction::ToServer); |
|  |  | let tx = state.find\_or\_create\_tx(&head, &txdata, Direction::ToServer).unwrap(); |
|  |  | tx.frames\_ts.push(HTTP2Frame { |
|  |  | header: head, |
|  |  | data: txdata, |
| Expand Down  Expand Up | | @@ -975,7 +975,7 @@ fn http2\_tx\_set\_settings(state: &mut HTTP2State, input: &[u8]) { |
|  |  | match parser::http2\_parse\_frame\_settings(&dec) { |
|  |  | Ok((\_, set)) => { |
|  |  | let txdata = HTTP2FrameTypeData::SETTINGS(set); |
|  |  | let tx = state.find\_or\_create\_tx(&head, &txdata, Direction::ToServer); |
|  |  | let tx = state.find\_or\_create\_tx(&head, &txdata, Direction::ToServer).unwrap(); |
|  |  | tx.frames\_ts.push(HTTP2Frame { |
|  |  | header: head, |
|  |  | data: txdata, |
| Expand Down | |  |

47 changes: 32 additions & 15 deletions

47
[rust/src/http2/http2.rs](#diff-41f11afd5b2edbf0809c3c6435f08f9f084f2948bfc050fd38316fd22748c0e9 "rust/src/http2/http2.rs")

Show comments

[View file](/OISF/suricata/blob/ce9b90326949c94a46611d6394e28600ee5e8bd5/rust/src/http2/http2.rs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -611,9 +611,21 @@ impl HTTP2State { |
|  |  |  |
|  |  | pub fn find\_or\_create\_tx( |
|  |  | &mut self, header: &parser::HTTP2FrameHeader, data: &HTTP2FrameTypeData, dir: Direction, |
|  |  | ) -> &mut HTTP2Transaction { |
|  |  | ) -> Option<&mut HTTP2Transaction> { |
|  |  | if header.stream\_id == 0 { |
|  |  | return self.create\_global\_tx(); |
|  |  | if self.transactions.len() >= unsafe { HTTP2\_MAX\_STREAMS } { |
|  |  | for tx\_old in &mut self.transactions { |
|  |  | if tx\_old.state == HTTP2TransactionState::HTTP2StateTodrop { |
|  |  | // loop was already run |
|  |  | break; |
|  |  | } |
|  |  | tx\_old.set\_event(HTTP2Event::TooManyStreams); |
|  |  | // use a distinct state, even if we do not log it |
|  |  | tx\_old.state = HTTP2TransactionState::HTTP2StateTodrop; |
|  |  | } |
|  |  | return None; |
|  |  | } |
|  |  | return Some(self.create\_global\_tx()); |
|  |  | } |
|  |  | let sid = match data { |
|  |  | //yes, the right stream\_id for Suricata is not the header one |
| Expand Down  Expand Up | | @@ -643,30 +655,31 @@ impl HTTP2State { |
|  |  | let tx = &mut self.transactions[index - 1]; |
|  |  | tx.tx\_data.update\_file\_flags(self.state\_data.file\_flags); |
|  |  | tx.update\_file\_flags(tx.tx\_data.file\_flags); |
|  |  | return tx; |
|  |  | return Some(tx); |
|  |  | } else { |
|  |  | let mut tx = HTTP2Transaction::new(); |
|  |  | self.tx\_id += 1; |
|  |  | tx.tx\_id = self.tx\_id; |
|  |  | tx.stream\_id = sid; |
|  |  | tx.state = HTTP2TransactionState::HTTP2StateOpen; |
|  |  | // do not use SETTINGS\_MAX\_CONCURRENT\_STREAMS as it can grow too much |
|  |  | if self.transactions.len() > unsafe { HTTP2\_MAX\_STREAMS } { |
|  |  | // set at least one another transaction to the drop state |
|  |  | if self.transactions.len() >= unsafe { HTTP2\_MAX\_STREAMS } { |
|  |  | for tx\_old in &mut self.transactions { |
|  |  | if tx\_old.state != HTTP2TransactionState::HTTP2StateTodrop { |
|  |  | // use a distinct state, even if we do not log it |
|  |  | tx\_old.set\_event(HTTP2Event::TooManyStreams); |
|  |  | tx\_old.state = HTTP2TransactionState::HTTP2StateTodrop; |
|  |  | if tx\_old.state == HTTP2TransactionState::HTTP2StateTodrop { |
|  |  | // loop was already run |
|  |  | break; |
|  |  | } |
|  |  | tx\_old.set\_event(HTTP2Event::TooManyStreams); |
|  |  | // use a distinct state, even if we do not log it |
|  |  | tx\_old.state = HTTP2TransactionState::HTTP2StateTodrop; |
|  |  | } |
|  |  | return None; |
|  |  | } |
|  |  | let mut tx = HTTP2Transaction::new(); |
|  |  | self.tx\_id += 1; |
|  |  | tx.tx\_id = self.tx\_id; |
|  |  | tx.stream\_id = sid; |
|  |  | tx.state = HTTP2TransactionState::HTTP2StateOpen; |
|  |  | tx.tx\_data.update\_file\_flags(self.state\_data.file\_flags); |
|  |  | tx.update\_file\_flags(tx.tx\_data.file\_flags); |
|  |  | tx.tx\_data.file\_tx = STREAM\_TOSERVER|STREAM\_TOCLIENT; // might hold files in both directions |
|  |  | self.transactions.push\_back(tx); |
|  |  | return self.transactions.back\_mut().unwrap(); |
|  |  | return Some(self.transactions.back\_mut().unwrap()); |
|  |  | } |
|  |  | } |
|  |  |  |
| Expand Down  Expand Up | | @@ -1038,6 +1051,10 @@ impl HTTP2State { |
|  |  | ); |
|  |  |  |
|  |  | let tx = self.find\_or\_create\_tx(&head, &txdata, dir); |
|  |  | if tx.is\_none() { |
|  |  | return AppLayerResult::err(); |
|  |  | } |
|  |  | let tx = tx.unwrap(); |
|  |  | if reass\_limit\_reached { |
|  |  | tx.tx\_data.set\_event(HTTP2Event::ReassemblyLimitReached as u8); |
|  |  | } |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `ce9b903`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOISF%2Fsuricata%2Fcommit%2Fce9b90326949c94a46611d6394e28600ee5e8bd5) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from redmine.openinfosecfoundation.org_e045496d_20250110_202748.html ===


⚲

### Project

### General

### Profile

* [Sign in](/login)
* [Register](/account/register)

* [Home](/)
* [Projects](/projects)
* [Help](https://www.redmine.org/guide)

[Search](/projects/suricata/search?scope=subprojects):

 Suricata[All Projects](/projects?jump=issues)
# Suricata

* [Overview](/projects/suricata)
* [Activity](/projects/suricata/activity)
* [Roadmap](/projects/suricata/roadmap)
* [Issues](/projects/suricata/issues)
* [Wiki](/projects/suricata/wiki)
* [Files](/projects/suricata/files)

### Custom queries

* [8.0.0 Stories](/projects/suricata/issues?query_id=90)
* [Good First Issues](/projects/suricata/issues?query_id=41)
* [OISF community](/projects/suricata/issues?query_id=3)

Actions
Copy link
## Security #6540

closed

[Security #5921](/issues/5921): http1: configurable limit for maximum number of live transactions per flow

### http1: configurable limit for maximum number of live transactions per flow (7.0.x backport)

Added by [OISF Ticketbot](/users/7712) [about 1 year](/projects/suricata/activity?from=2023-11-17 "11/17/2023 12:17 PM") ago.
Updated [11 months](/projects/suricata/activity?from=2024-02-26 "02/26/2024 01:47 PM") ago.

Status:ClosedPriority:NormalAssignee:[Philippe Antoine](/users/1820)Target version:[7.0.3](/versions/200 "02/08/2024")
Affected Versions:Label:CVE:[2024-23836](https://nvd.nist.gov/vuln/detail/CVE-2024-23836)Git IDs:

97953998d2d60673ed6c30ddfb6a2d59b4230f97

e7e28822f473320658d6125f16ac3f0524baff01

Severity:CRITICALDisclosure Date:

* [History](/issues/6540?tab=history)
* [Notes](/issues/6540?tab=notes)
* [Property changes](/issues/6540?tab=properties)

ActionsCopy link
[#1](#note-1)
#### Updated by [Jason Ish](/users/9) [12 months](/projects/suricata/activity?from=2024-01-25 "01/25/2024 03:52 PM") ago

* **Severity** changed from *MODERATE* to *CRITICAL*

ActionsCopy link
[#2](#note-2)
#### Updated by [Victor Julien](/users/4) [11 months](/projects/suricata/activity?from=2024-02-08 "02/08/2024 08:59 AM") ago

* **Status** changed from *Assigned* to *Resolved*

ActionsCopy link
[#3](#note-3)
#### Updated by [Victor Julien](/users/4) [11 months](/projects/suricata/activity?from=2024-02-08 "02/08/2024 09:31 AM") ago

* **CVE** set to *2024-23836*

ActionsCopy link
[#4](#note-4)
#### Updated by [Philippe Antoine](/users/1820) [11 months](/projects/suricata/activity?from=2024-02-12 "02/12/2024 10:40 AM") ago

* **Status** changed from *Resolved* to *Closed*
* **Git IDs** updated ([diff](/journals/32539/diff?detail_id=33210 "View differences"))

ActionsCopy link
[#5](#note-5)
#### Updated by [Victor Julien](/users/4) [11 months](/projects/suricata/activity?from=2024-02-26 "02/26/2024 10:32 AM") ago

* **Private** changed from *Yes* to *No*

ActionsCopy link
[#6](#note-6)
#### Updated by [Victor Julien](/users/4) [11 months](/projects/suricata/activity?from=2024-02-26 "02/26/2024 01:47 PM") ago

<https://github.com/OISF/suricata/security/advisories/GHSA-q33q-45cr-3cpc>

Actions
Copy link

Also available in: [Atom](/issues/6540.atom)
[PDF](/issues/6540.pdf)

Powered by [Redmine](https://www.redmine.org/) © 2006-2024 Jean-Philippe Lang

Loading...



=== Content from redmine.openinfosecfoundation.org_51687d97_20250110_202748.html ===


⚲

### Project

### General

### Profile

* [Sign in](/login)
* [Register](/account/register)

* [Home](/)
* [Projects](/projects)
* [Help](https://www.redmine.org/guide)

[Search](/projects/suricata/search?scope=subprojects):

 Suricata[All Projects](/projects?jump=issues)
# Suricata

* [Overview](/projects/suricata)
* [Activity](/projects/suricata/activity)
* [Roadmap](/projects/suricata/roadmap)
* [Issues](/projects/suricata/issues)
* [Wiki](/projects/suricata/wiki)
* [Files](/projects/suricata/files)

### Custom queries

* [8.0.0 Stories](/projects/suricata/issues?query_id=90)
* [Good First Issues](/projects/suricata/issues?query_id=41)
* [OISF community](/projects/suricata/issues?query_id=3)

Actions
Copy link
## Security #6532

closed

[Security #6477](/issues/6477): SMTP: quadratic complexity from unbounded number of transaction per flow

### SMTP: quadratic complexity from unbounded number of transaction per flow (7.0.x backport)

Added by [OISF Ticketbot](/users/7712) [about 1 year](/projects/suricata/activity?from=2023-11-17 "11/17/2023 12:17 PM") ago.
Updated [11 months](/projects/suricata/activity?from=2024-02-26 "02/26/2024 01:48 PM") ago.

Status:ClosedPriority:NormalAssignee:[Philippe Antoine](/users/1820)Target version:[7.0.3](/versions/200 "02/08/2024")
Affected Versions:Label:CVE:[2024-23836](https://nvd.nist.gov/vuln/detail/CVE-2024-23836)Git IDs:

f9de1cca6182e571f1c02387dca6e695e55608af

cd035d59e3df157b606f4fe67324ea8e437be786

Severity:CRITICALDisclosure Date:

* [History](/issues/6532?tab=history)
* [Notes](/issues/6532?tab=notes)
* [Property changes](/issues/6532?tab=properties)

ActionsCopy link
[#1](#note-1)
#### Updated by [Jason Ish](/users/9) [12 months](/projects/suricata/activity?from=2024-01-25 "01/25/2024 03:52 PM") ago

* **Severity** changed from *MODERATE* to *CRITICAL*

ActionsCopy link
[#2](#note-2)
#### Updated by [Victor Julien](/users/4) [11 months](/projects/suricata/activity?from=2024-02-08 "02/08/2024 08:59 AM") ago

* **Status** changed from *Assigned* to *Resolved*

ActionsCopy link
[#3](#note-3)
#### Updated by [Victor Julien](/users/4) [11 months](/projects/suricata/activity?from=2024-02-08 "02/08/2024 09:32 AM") ago

* **CVE** set to *2024-23836*

ActionsCopy link
[#4](#note-4)
#### Updated by [Philippe Antoine](/users/1820) [11 months](/projects/suricata/activity?from=2024-02-12 "02/12/2024 10:41 AM") ago

* **Status** changed from *Resolved* to *Closed*
* **Git IDs** updated ([diff](/journals/32542/diff?detail_id=33216 "View differences"))

ActionsCopy link
[#5](#note-5)
#### Updated by [Victor Julien](/users/4) [11 months](/projects/suricata/activity?from=2024-02-26 "02/26/2024 10:32 AM") ago

* **Private** changed from *Yes* to *No*

ActionsCopy link
[#6](#note-6)
#### Updated by [Victor Julien](/users/4) [11 months](/projects/suricata/activity?from=2024-02-26 "02/26/2024 01:47 PM") ago

<https://github.com/OISF/suricata/security/advisories/GHSA-q33q-45cr-3cpc>

Actions
Copy link

Also available in: [Atom](/issues/6532.atom)
[PDF](/issues/6532.pdf)

Powered by [Redmine](https://www.redmine.org/) © 2006-2024 Jean-Philippe Lang

Loading...



=== Content from github.com_a297468a_20250110_202740.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOISF%2Fsuricata%2Fcommit%2F8efaebe293e2a74c8e323fa85a6f5fadf82801bc)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOISF%2Fsuricata%2Fcommit%2F8efaebe293e2a74c8e323fa85a6f5fadf82801bc)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=OISF%2Fsuricata)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[OISF](/OISF)
/
**[suricata](/OISF/suricata)**
Public

* [Notifications](/login?return_to=%2FOISF%2Fsuricata) You must be signed in to change notification settings
* [Fork
  1.5k](/login?return_to=%2FOISF%2Fsuricata)
* [Star
   4.8k](/login?return_to=%2FOISF%2Fsuricata)

* [Code](/OISF/suricata)
* [Pull requests
  71](/OISF/suricata/pulls)
* [Actions](/OISF/suricata/actions)
* [Security](/OISF/suricata/security)
* [Insights](/OISF/suricata/pulse)

Additional navigation options

* [Code](/OISF/suricata)
* [Pull requests](/OISF/suricata/pulls)
* [Actions](/OISF/suricata/actions)
* [Security](/OISF/suricata/security)
* [Insights](/OISF/suricata/pulse)

## Commit

[Permalink](/OISF/suricata/commit/8efaebe293e2a74c8e323fa85a6f5fadf82801bc)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

http1: configurable max number of live tx per flow

[Browse files](/OISF/suricata/tree/8efaebe293e2a74c8e323fa85a6f5fadf82801bc)
Browse the repository at this point in the history

```
Unlike the original commit, this commit just enforces a maximum limit,
but does not expose the configuration of it.

Ticket: [#5921](https://github.com/OISF/suricata/pull/5921)

(cherry picked from commit [4175680](https://github.com/OISF/suricata/commit/4175680a8a1c0dfaa491ee63d6e36c011d498473))
```

* Loading branch information

[![@catenacyber](https://avatars.githubusercontent.com/u/35799796?s=40&v=4)](/catenacyber) [![@victorjulien](https://avatars.githubusercontent.com/u/32410611?s=40&v=4)](/victorjulien)

[catenacyber](/OISF/suricata/commits?author=catenacyber "View all commits by catenacyber")
authored and
[victorjulien](/OISF/suricata/commits?author=victorjulien "View all commits by victorjulien")
committed
Feb 7, 2024

1 parent
[18841a5](/OISF/suricata/commit/18841a58da71e735ddf4e52cbfa6989755ecbeb7)

commit 8efaebe

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**6 additions**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* configure.ac
  [configure.ac](#diff-49473dca262eeab3b4a43002adb08b4db31020d190caaad1594b47f1d5daa810)
* src

  + src/app-layer-htp.c
    [app-layer-htp.c](#diff-56922fe0497672d8c8892934e2390961e65f9c02ee4822dcb9789e38cd786a6d)

## There are no files selected for viewing

2 changes: 2 additions & 0 deletions

2
[configure.ac](#diff-49473dca262eeab3b4a43002adb08b4db31020d190caaad1594b47f1d5daa810 "configure.ac")

Show comments

[View file](/OISF/suricata/blob/8efaebe293e2a74c8e323fa85a6f5fadf82801bc/configure.ac)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1692,6 +1692,7 @@ |
|  |  | AC\_CHECK\_LIB([htp], [htp\_config\_set\_lzma\_layers],AC\_DEFINE\_UNQUOTED([HAVE\_HTP\_CONFIG\_SET\_LZMA\_LAYERS],[1],[Found htp\_config\_set\_lzma\_layers function in libhtp]) ,,[-lhtp]) |
|  |  | AC\_CHECK\_LIB([htp], [htp\_config\_set\_compression\_bomb\_limit],AC\_DEFINE\_UNQUOTED([HAVE\_HTP\_CONFIG\_SET\_COMPRESSION\_BOMB\_LIMIT],[1],[Found htp\_config\_set\_compression\_bomb\_limit function in libhtp]) ,,[-lhtp]) |
|  |  | AC\_CHECK\_LIB([htp], [htp\_config\_set\_compression\_time\_limit],AC\_DEFINE\_UNQUOTED([HAVE\_HTP\_CONFIG\_SET\_COMPRESSION\_TIME\_LIMIT],[1],[Found htp\_config\_set\_compression\_time\_limit function in libhtp]) ,,[-lhtp]) |
|  |  | AC\_CHECK\_LIB([htp], [htp\_config\_set\_max\_tx],AC\_DEFINE\_UNQUOTED([HAVE\_HTP\_CONFIG\_SET\_MAX\_TX],[1],[Found htp\_config\_set\_max\_tx function in libhtp]) ,,[-lhtp]) |
|  |  | ]) |
|  |  |  |
|  |  | if test "x$enable\_non\_bundled\_htp" = "xno"; then |
| Expand All | | @@ -1716,6 +1717,7 @@ |
|  |  | AC\_DEFINE\_UNQUOTED([HAVE\_HTP\_CONFIG\_SET\_LZMA\_LAYERS],[1],[Assuming htp\_config\_set\_lzma\_layers function in bundled libhtp]) |
|  |  | AC\_DEFINE\_UNQUOTED([HAVE\_HTP\_CONFIG\_SET\_COMPRESSION\_BOMB\_LIMIT],[1],[Assuming htp\_config\_set\_compression\_bomb\_limit function in bundled libhtp]) |
|  |  | AC\_DEFINE\_UNQUOTED([HAVE\_HTP\_CONFIG\_SET\_COMPRESSION\_TIME\_LIMIT],[1],[Assuming htp\_config\_set\_compression\_time\_limit function in bundled libhtp]) |
|  |  | AC\_DEFINE\_UNQUOTED([HAVE\_HTP\_CONFIG\_SET\_MAX\_TX],[1],[Assuming htp\_config\_set\_max\_tx function in bundled libhtp]) |
|  |  | else |
|  |  | echo |
|  |  | echo " ERROR: Libhtp is not bundled. Get libhtp by doing:" |
| Expand Down | |  |

4 changes: 4 additions & 0 deletions

4
[src/app-layer-htp.c](#diff-56922fe0497672d8c8892934e2390961e65f9c02ee4822dcb9789e38cd786a6d "src/app-layer-htp.c")

Show comments

[View file](/OISF/suricata/blob/8efaebe293e2a74c8e323fa85a6f5fadf82801bc/src/app-layer-htp.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2407,6 +2407,10 @@ static void HTPConfigSetDefaultsPhase1(HTPCfgRec \*cfg\_prec) |
|  |  | #endif |
|  |  | #ifdef HAVE\_HTP\_CONFIG\_SET\_COMPRESSION\_TIME\_LIMIT |
|  |  | htp\_config\_set\_compression\_time\_limit(cfg\_prec->cfg, HTP\_CONFIG\_DEFAULT\_COMPRESSION\_TIME\_LIMIT); |
|  |  | #endif |
|  |  | #ifdef HAVE\_HTP\_CONFIG\_SET\_MAX\_TX |
|  |  | #define HTP\_CONFIG\_DEFAULT\_MAX\_TX\_LIMIT 512 |
|  |  | htp\_config\_set\_max\_tx(cfg\_prec->cfg, HTP\_CONFIG\_DEFAULT\_MAX\_TX\_LIMIT); |
|  |  | #endif |
|  |  | /\* libhtp <= 0.5.9 doesn't use soft limit, but it's impossible to set |
|  |  | \* only the hard limit. So we set both here to the (current) htp defaults. |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `8efaebe`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOISF%2Fsuricata%2Fcommit%2F8efaebe293e2a74c8e323fa85a6f5fadf82801bc) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


