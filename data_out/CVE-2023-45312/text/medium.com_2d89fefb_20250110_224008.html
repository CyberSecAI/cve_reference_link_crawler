[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F742a455be16b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40_sadshade%2Falmost-2000-telegram-proxy-servers-are-potentially-vulnerable-to-rce-since-2018-742a455be16b&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40_sadshade%2Falmost-2000-telegram-proxy-servers-are-potentially-vulnerable-to-rce-since-2018-742a455be16b&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# Erlang mtproto proxy — Telegram MTproxy implementation vulnerable to RCE

[![Konstantin Burov](https://miro.medium.com/v2/resize:fill:88:88/2*acf68pemKtYyddOB-7nwdg.jpeg)](/%40_sadshade?source=post_page---byline--742a455be16b--------------------------------)

[Konstantin Burov](/%40_sadshade?source=post_page---byline--742a455be16b--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc6ba332e183f&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40_sadshade%2Falmost-2000-telegram-proxy-servers-are-potentially-vulnerable-to-rce-since-2018-742a455be16b&user=Konstantin+Burov&userId=c6ba332e183f&source=post_page-c6ba332e183f--byline--742a455be16b---------------------post_header-----------)

2 min read·Sep 12, 2023

--

Listen

Share

![MTProxy]()

The “Erlang mtproto proxy” Github project, which implements the functionality of the Telegram MTProxy protocol on Erlang by Sergey Prokhorov, is affected by a remote execution code vulnerability.

## Info

This vulnerability allows a remote attacker to run arbitrary OS commands from a low-privileged “mtproto-proxy*”* user via default erlang cookie. You can find more information about this vulnerability in my previous write-up — [CouchDB, Erlang and cookies — RCE on default settings](/%40_sadshade/couchdb-erlang-and-cookies-rce-on-default-settings-b1e9173a4bcd).

![POC]()

So far, 1800+ potentially vulnerable hosts have been found on shodan.io, and according to the git commit history, the project is vulnerable since September 2018.

![]()
## Mitigations

If you are using proxy in your telegram client, go to <https://shodan.io/>, enter the IP address of your proxy and make sure that port 4369 is not open there. If it is, this server could be compromised and your privacy might be at risk.

![]()

If you are the administrator of this server, then you need to close all ports except those necessary, for example, the port for the proxy itself (usually 443) and port 22 for connecting SSH.

You can also migrate to official Telegram MTProto proxy server as an option.

## **Vendor Advisory**

According to Telegram’s security team and third-party sources, all information from the client to the telegram servers is encrypted and the proxy server does not even see your username, only your IP address.

However you can still be tracked to the country/city by IP.

The project does not appear to be active, although the author will confirm that he is going to fix the issue, but there is no exact ETA.

## CVE info

Product name: Erlang mtproto proxy
Affected version: 0.7.0 and below
Vulnerability Type: Remote Command Execution
Root Cause: Improperly secured default installation (Erlang cookie)
ID: [CVE-2023–45312](https://nvd.nist.gov/vuln/detail/CVE-2023%E2%80%9345312), [CWE-1188](http://cwe.mitre.org/data/definitions/1188.html)

## Links

* [Erlang mtproto proxy](https://github.com/seriyps/mtproto_proxy)
* [MTProxy server by Telegram](https://github.com/TelegramMessenger/MTProxy)
* Metasploit [module](https://www.rapid7.com/db/modules/exploit/multi/misc/erlang_cookie_rce/) “erlang\_cookie\_rce”
[Rce](/tag/rce?source=post_page-----742a455be16b--------------------------------)[Telegram](/tag/telegram?source=post_page-----742a455be16b--------------------------------)[Vulnerability](/tag/vulnerability?source=post_page-----742a455be16b--------------------------------)[Erlang](/tag/erlang?source=post_page-----742a455be16b--------------------------------)[Privacy](/tag/privacy?source=post_page-----742a455be16b--------------------------------)

--

--

[![Konstantin Burov](https://miro.medium.com/v2/resize:fill:96:96/2*acf68pemKtYyddOB-7nwdg.jpeg)](/%40_sadshade?source=post_page---post_author_info--742a455be16b--------------------------------)[![Konstantin Burov](https://miro.medium.com/v2/resize:fill:128:128/2*acf68pemKtYyddOB-7nwdg.jpeg)](/%40_sadshade?source=post_page---post_author_info--742a455be16b--------------------------------)Follow[## Written by Konstantin Burov](/%40_sadshade?source=post_page---post_author_info--742a455be16b--------------------------------)[22 Followers](/%40_sadshade/followers?source=post_page---post_author_info--742a455be16b--------------------------------)·[5 Following](/%40_sadshade/following?source=post_page---post_author_info--742a455be16b--------------------------------)

PenTester, Information Security Engineer, <https://linkedin.com/in/burovlkdn>

Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----742a455be16b--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----742a455be16b--------------------------------)[About](/about?autoplay=1&source=post_page-----742a455be16b--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----742a455be16b--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----742a455be16b--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----742a455be16b--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----742a455be16b--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----742a455be16b--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----742a455be16b--------------------------------)[Teams](/business?source=post_page-----742a455be16b--------------------------------)

