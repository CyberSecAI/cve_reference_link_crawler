Page Menu[HomeMiraheze](/)

* SearchConfigure Global Search

[Log In](https://issue-tracker.miraheze.org/auth/start/?next=%2FT9018)[Create Task](/maniphest/task/edit/nocreate/) [Maniphest](/maniphest/)  T9018
# POST request does not check registered status for RequestWiki commentsClosed, Resolved[Public](/policy/explain/PHID-TASK-chx5lkar6m237r2ryy6k/view/)Actions

* [Edit Task](/maniphest/task/edit/9018/)
* Edit Related Tasks...
* [Create Subtask](/maniphest/task/subtask/9018/)
* [Edit Parent Tasks](/search/rel/task.has-parent/PHID-TASK-chx5lkar6m237r2ryy6k/)
* [Edit Subtasks](/search/rel/task.has-subtask/PHID-TASK-chx5lkar6m237r2ryy6k/)
* [Merge Duplicates In](/search/rel/task.merge-in/PHID-TASK-chx5lkar6m237r2ryy6k/)
* [Close As Duplicate](/search/rel/task.close-as-duplicate/PHID-TASK-chx5lkar6m237r2ryy6k/)
* Edit Related Objects...
* [Edit Commits](/search/rel/task.has-commit/PHID-TASK-chx5lkar6m237r2ryy6k/)
* [Edit Revisions](/search/rel/task.has-revision/PHID-TASK-chx5lkar6m237r2ryy6k/)
* Subscribe
* [Mute Notifications](/subscriptions/mute/PHID-TASK-chx5lkar6m237r2ryy6k/)
* [Flag For Later](/flag/edit/PHID-TASK-chx5lkar6m237r2ryy6k/)
* [Award Token](/token/give/PHID-TASK-chx5lkar6m237r2ryy6k/)

Assigned To

|  | [John](/p/John/) |
| --- | --- |

Authored By

|  | Unknown Object (User) |
| --- | --- |
| Apr 2 2022, 17:192022-04-02 17:19:19 (UTC+0) |

Tags

* [CreateWiki](/tag/createwiki/) [(Backlog)](/project/board/4/)
* [Technology-Team (MediaWiki)](/tag/technology-team_mediawiki/) [(Backlog)](/project/board/62/)
* [Security](/tag/security/) [(Backlog)](/project/board/58/)
Referenced FilesNoneSubscribers

|  | [Dmehus](/p/Dmehus/) |
| --- | --- |

|  | [Reception123](/p/Reception123/) |
| --- | --- |

|  | [RhinosF1](/p/RhinosF1/) |
| --- | --- |

|  | [Void](/p/Void/) |
| --- | --- |

# Description

A locked user reopened request #[2831](https://meta.miraheze.org/wiki/Special%3ARequestWikiQueue/2831) and edited the request various times. The username of the user for some reason is not visible in the wiki request (the requester appears to be one's IP for some reason) but after looking through the Farmer log ([see log from 27 March, 2017](https://meta.miraheze.org/w/index.php?title=Special:Log/farmer&offset=20170328013638&type=farmer&user=)), it seems the request was opened by a user named "Hello" ([CentralAuth](https://meta.miraheze.org/wiki/Special%3ACentralAuth/Hello)) who was locked for long-term abuse.

This "Hello" user was locked by NDKilla in \*2017\* and is still locked but they somehow reopened this 5 year old request and when they reopened the request, they did not trigger a log entry in the farmer log saying that they had reopened their request, it just suddenly appeared in the wiki request queue. How could this have happened?

(Task temporarily hidden from public view to prevent a potential Streisand effect)

# Related Objects

* Mentions

Mentioned In [T9061: CreateRedirect has weak (no?) permissions checks](/T9061)
### Event Timeline

Unknown Object (User) created this task.[Apr 2 2022, 17:192022-04-02 17:19:19 (UTC+0)](#182532)Unknown Object (User) triaged this task as Normal priority.Unknown Object (User) created this object with visibility "[Custom Policy](/transactions/new/PHID-XACT-TASK-7yawiqimhimrdn6/)".Unknown Object (User) created this object with edit policy "[Custom Policy](/transactions/new/PHID-XACT-TASK-hddxjocgnhsfhne/)".[Herald](/herald/) added subscribers: Unknown Object (User), [RhinosF1](/p/RhinosF1/), [Void](/p/Void/), [Reception123](/p/Reception123/).  Â· [View Herald Transcript](/herald/transcript/115910/)[Apr 2 2022, 17:192022-04-02 17:19:20 (UTC+0)](#182541)

[RhinosF1](/p/RhinosF1/) added a comment.[Apr 2 2022, 17:202022-04-02 17:20:49 (UTC+0)](#182542)Comment Actions

Baffling

Unknown Object (User) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-7sufrmcnrl3fnvg/)[Apr 2 2022, 17:222022-04-02 17:22:31 (UTC+0)](#182543)[John](/p/John/) claimed this task.[Apr 2 2022, 18:282022-04-02 18:28:21 (UTC+0)](#182545)[John](/p/John/) raised the priority of this task from Normal to High.[John](/p/John/) added a project: [Security](/tag/security/).[John](/p/John/) closed this task as Resolved.[Apr 2 2022, 18:552022-04-02 18:55:34 (UTC+0)](#182547)[John](/p/John/) changed the visibility from "[Custom Policy](/transactions/old/PHID-XACT-TASK-irsh2d5tejz3r23/)" to "Public (No Login Required)".[John](/p/John/) changed the edit policy from "[Custom Policy](/transactions/old/PHID-XACT-TASK-xim4uqvcvzu33kz/)" to "All Users".[Dmehus](/p/Dmehus/) subscribed.[Apr 2 2022, 19:122022-04-02 19:12:57 (UTC+0)](#182550)

[RhinosF1](/p/RhinosF1/) added a comment.[Apr 2 2022, 19:172022-04-02 19:17:14 (UTC+0)](#182551)Comment Actions

<https://github.com/miraheze/CreateWiki/security/advisories/GHSA-9xvw-w66v-prvg>

[RhinosF1](/p/RhinosF1/) renamed this task from Locked user reopened wiki request to POST request does not check registered status for RequestWiki comments.[Apr 2 2022, 19:252022-04-02 19:25:18 (UTC+0)](#182552)

[Dmehus](/p/Dmehus/) added a comment.[Apr 2 2022, 20:172022-04-02 20:17:10 (UTC+0)](#182553)Comment Actions
> In [T9018#182551](/T9018#182551), [@RhinosF1](/p/RhinosF1/) wrote:
>
> <https://github.com/miraheze/CreateWiki/security/advisories/GHSA-9xvw-w66v-prvg>

[@RhinosF1](/p/RhinosF1/) Thanks for the link. Is that advisory up and posted, no? I get a 404 not found error

[RhinosF1](/p/RhinosF1/) added a comment.[Apr 2 2022, 20:422022-04-02 20:42:58 (UTC+0)](#182554)Comment Actions

Still waiting for GitHub to issue the CVE

[Dmehus](/p/Dmehus/) added a comment.[Apr 2 2022, 21:202022-04-02 21:20:47 (UTC+0)](#182555)Comment Actions
> In [T9018#182554](/T9018#182554), [@RhinosF1](/p/RhinosF1/) wrote:
>
> Still waiting for GitHub to issue the CVE

Okay, thanks. Did we revert the changes made to the wiki requests by manually editing the applicable wiki request database table?

[RhinosF1](/p/RhinosF1/) added a comment.[Apr 2 2022, 21:252022-04-02 21:25:07 (UTC+0)](#182556)Comment Actions

No

[Dmehus](/p/Dmehus/) added a comment.[Apr 2 2022, 23:272022-04-02 23:27:22 (UTC+0)](#182560)Comment Actions
> In [T9018#182556](/T9018#182556), [@RhinosF1](/p/RhinosF1/) wrote:
>
> No

Can we try and do that, please, presumably by looking in a backup database table and manually reverting to the pre-LTA-effected changes?

[Dmehus](/p/Dmehus/) mentioned this in [T9061: CreateRedirect has weak (no?) permissions checks](/T9061).[Apr 11 2022, 04:102022-04-11 04:10:17 (UTC+0)](#183465)[Log In to Comment](/login/?next=%2FT9018)