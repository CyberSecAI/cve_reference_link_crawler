```
{
  "vulnerability": {
    "root_cause": "The `__ip6_tnl_rcv` function in the Linux kernel's IPv6 tunnel implementation did not properly pull the inner IPv6 header before accessing it. This resulted in the use of potentially uninitialized data.",
    "weaknesses": [
      "Use of uninitialized data",
      "Missing input validation or sanitization"
    ],
    "impact": "Access to uninitialized memory could lead to information leaks and possibly denial of service.",
    "attack_vectors": "A crafted IPv6 packet sent through an IPv6 tunnel could trigger the vulnerability.",
    "required_attacker_capabilities": "An attacker needs to be able to send network packets to a system with enabled IPv6 tunneling and have the ability to send a specifically crafted IPv6 packet. This requires a position within the network or external access with the ability to create the appropriate traffic."
  },
  "fix": {
    "description": "The fix ensures that `pskb_inet_may_pull()` is called to pull the inner header before accessing it, also initializing the `ipv6h` variable after this call. The offset of the outer header is saved relative to `skb->head`, and this offset is used after `skb_reset_network_header(skb)` which can change `skb->head`.",
    "commits": [
        "a9bc32879a08f23cdb80a48c738017e39aea1080",
        "8d975c15c0cd744000ca386247432d57b21f9df0",
        "af6b5c50d47ab43e5272ad61935d0ed2e264d3f0",
        "350a6640fac4b53564ec20aa3f4a0922cb0ba5e6",
        "c835df3bcc14858ae9b27315dd7de76370b94f3a",
         "d54e4da98bbfa8c257bdca94c49652d81d18a4d8"
      ],
    "details": "The fix involves calling `pskb_inet_may_pull()` to ensure the necessary data is present in the `sk_buff`. The outer header offset is stored, the network header is reset and the outer header pointer is calculated, then a check is made if the inner header is available using `pskb_inet_may_pull()`. If not, the packet is dropped, otherwise processing continues after ensuring the `ipv6h` pointer is properly initialized after the call to `pskb_inet_may_pull()` as this function can modify the skb structure and change the skb->head pointer."
  },
  "affected_products": [
    "Active IQ Unified Manager for VMware vSphere",
    "FAS/AFF Baseboard Management Controller (BMC) - A800/C800",
    "FAS/AFF Baseboard Management Controller (BMC) - A900/9500",
    "FAS/AFF Baseboard Management Controller (BMC) - C190/A150/A220/FAS2720/FAS2750",
    "FAS/AFF Baseboard Management Controller (BMC) - FAS2820",
    "ONTAP Select Deploy administration utility"
  ],
    "additional_notes": "The vulnerability was discovered by syzbot and fixed in multiple kernel versions. NetApp products using the vulnerable kernel are also affected. The vulnerability is rated as medium severity with a CVSS score of 5.5 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H)"
}
```