=== Content from git.kernel.org_69c981a2_20250111_052732.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=f0f484714f35d24ffa0ecb4afe3df1c5b225411d)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=f0f484714f35d24ffa0ecb4afe3df1c5b225411d)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f0f484714f35d24ffa0ecb4afe3df1c5b225411d)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f0f484714f35d24ffa0ecb4afe3df1c5b225411d)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Sudeep Holla <sudeep.holla@arm.com> | 2021-12-09 12:04:56 +0000 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-12-22 09:30:50 +0100 |
| commit | [f0f484714f35d24ffa0ecb4afe3df1c5b225411d](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f0f484714f35d24ffa0ecb4afe3df1c5b225411d) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=f0f484714f35d24ffa0ecb4afe3df1c5b225411d)) | |
| tree | [2ac6986b15f32d4cc0cd2e1a2f7624c7bffaab9a](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=f0f484714f35d24ffa0ecb4afe3df1c5b225411d) | |
| parent | [7fd214fc7f2ee3a89f91e717e3cfad55f5a27045](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=7fd214fc7f2ee3a89f91e717e3cfad55f5a27045) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f0f484714f35d24ffa0ecb4afe3df1c5b225411d&id2=7fd214fc7f2ee3a89f91e717e3cfad55f5a27045)) | |
| download | [linux-f0f484714f35d24ffa0ecb4afe3df1c5b225411d.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-f0f484714f35d24ffa0ecb4afe3df1c5b225411d.tar.gz) | |

firmware: arm\_scpi: Fix string overflow in SCPI genpd drivercommit 865ed67ab955428b9aa771d8b4f1e4fb7fd08945 upstream.
Without the bound checks for scpi\_pd->name, it could result in the buffer
overflow when copying the SCPI device name from the corresponding device
tree node as the name string is set at maximum size of 30.
Let us fix it by using devm\_kasprintf so that the string buffer is
allocated dynamically.
Fixes: 8bec4337ad40 ("firmware: scpi: add device power domain support using genpd")
Reported-by: Pedro Batista <pedbap.g@gmail.com>
Signed-off-by: Sudeep Holla <sudeep.holla@arm.com>
Cc: stable@vger.kernel.org
Cc: Cristian Marussi <cristian.marussi@arm.com>
Link: [https://lore.kernel.org/r/20211209120456.696879-1-sudeep.holla@arm.com'](https://lore.kernel.org/r/20211209120456.696879-1-sudeep.holla%40arm.com%27)
Signed-off-by: Arnd Bergmann <arnd@arndb.de>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f0f484714f35d24ffa0ecb4afe3df1c5b225411d)

| -rw-r--r-- | [drivers/firmware/scpi\_pm\_domain.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/firmware/scpi_pm_domain.c?id=f0f484714f35d24ffa0ecb4afe3df1c5b225411d) | 10 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 7 insertions, 3 deletions

| diff --git a/drivers/firmware/scpi\_pm\_domain.c b/drivers/firmware/scpi\_pm\_domain.cindex 51201600d789b9..800673910b5111 100644--- a/[drivers/firmware/scpi\_pm\_domain.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/firmware/scpi_pm_domain.c?id=7fd214fc7f2ee3a89f91e717e3cfad55f5a27045)+++ b/[drivers/firmware/scpi\_pm\_domain.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/firmware/scpi_pm_domain.c?id=f0f484714f35d24ffa0ecb4afe3df1c5b225411d)@@ -16,7 +16,6 @@ struct scpi\_pm\_domain { struct generic\_pm\_domain genpd; struct scpi\_ops \*ops; u32 domain;- char name[30]; };  /\*@@ -110,8 +109,13 @@ static int scpi\_pm\_domain\_probe(struct platform\_device \*pdev)  scpi\_pd->domain = i; scpi\_pd->ops = scpi\_ops;- sprintf(scpi\_pd->name, "%pOFn.%d", np, i);- scpi\_pd->genpd.name = scpi\_pd->name;+ scpi\_pd->genpd.name = devm\_kasprintf(dev, GFP\_KERNEL,+ "%pOFn.%d", np, i);+ if (!scpi\_pd->genpd.name) {+ dev\_err(dev, "Failed to allocate genpd name:%pOFn.%d\n",+ np, i);+ continue;+ } scpi\_pd->genpd.power\_off = scpi\_pd\_power\_off; scpi\_pd->genpd.power\_on = scpi\_pd\_power\_on; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 05:26:10 +0000



=== Content from git.kernel.org_9805c0a1_20250111_052725.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=4694b1ec425a2d20d6f8ca3db594829fdf5f2672)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=4694b1ec425a2d20d6f8ca3db594829fdf5f2672)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=4694b1ec425a2d20d6f8ca3db594829fdf5f2672)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=4694b1ec425a2d20d6f8ca3db594829fdf5f2672)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Sudeep Holla <sudeep.holla@arm.com> | 2021-12-09 12:04:56 +0000 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-12-22 09:18:00 +0100 |
| commit | [4694b1ec425a2d20d6f8ca3db594829fdf5f2672](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=4694b1ec425a2d20d6f8ca3db594829fdf5f2672) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=4694b1ec425a2d20d6f8ca3db594829fdf5f2672)) | |
| tree | [7441a748202cd3613e107cf3d1fe70622eae328b](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=4694b1ec425a2d20d6f8ca3db594829fdf5f2672) | |
| parent | [f3fde37d3f0d429f0fcce214cb52588a9e21260e](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f3fde37d3f0d429f0fcce214cb52588a9e21260e) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=4694b1ec425a2d20d6f8ca3db594829fdf5f2672&id2=f3fde37d3f0d429f0fcce214cb52588a9e21260e)) | |
| download | [linux-4694b1ec425a2d20d6f8ca3db594829fdf5f2672.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-4694b1ec425a2d20d6f8ca3db594829fdf5f2672.tar.gz) | |

firmware: arm\_scpi: Fix string overflow in SCPI genpd drivercommit 865ed67ab955428b9aa771d8b4f1e4fb7fd08945 upstream.
Without the bound checks for scpi\_pd->name, it could result in the buffer
overflow when copying the SCPI device name from the corresponding device
tree node as the name string is set at maximum size of 30.
Let us fix it by using devm\_kasprintf so that the string buffer is
allocated dynamically.
Fixes: 8bec4337ad40 ("firmware: scpi: add device power domain support using genpd")
Reported-by: Pedro Batista <pedbap.g@gmail.com>
Signed-off-by: Sudeep Holla <sudeep.holla@arm.com>
Cc: stable@vger.kernel.org
Cc: Cristian Marussi <cristian.marussi@arm.com>
Link: [https://lore.kernel.org/r/20211209120456.696879-1-sudeep.holla@arm.com'](https://lore.kernel.org/r/20211209120456.696879-1-sudeep.holla%40arm.com%27)
Signed-off-by: Arnd Bergmann <arnd@arndb.de>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=4694b1ec425a2d20d6f8ca3db594829fdf5f2672)

| -rw-r--r-- | [drivers/firmware/scpi\_pm\_domain.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/firmware/scpi_pm_domain.c?id=4694b1ec425a2d20d6f8ca3db594829fdf5f2672) | 10 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 7 insertions, 3 deletions

| diff --git a/drivers/firmware/scpi\_pm\_domain.c b/drivers/firmware/scpi\_pm\_domain.cindex f395dec271131a..a6e62a793fbe60 100644--- a/[drivers/firmware/scpi\_pm\_domain.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/firmware/scpi_pm_domain.c?id=f3fde37d3f0d429f0fcce214cb52588a9e21260e)+++ b/[drivers/firmware/scpi\_pm\_domain.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/firmware/scpi_pm_domain.c?id=4694b1ec425a2d20d6f8ca3db594829fdf5f2672)@@ -27,7 +27,6 @@ struct scpi\_pm\_domain { struct generic\_pm\_domain genpd; struct scpi\_ops \*ops; u32 domain;- char name[30]; };  /\*@@ -121,8 +120,13 @@ static int scpi\_pm\_domain\_probe(struct platform\_device \*pdev)  scpi\_pd->domain = i; scpi\_pd->ops = scpi\_ops;- sprintf(scpi\_pd->name, "%s.%d", np->name, i);- scpi\_pd->genpd.name = scpi\_pd->name;+ scpi\_pd->genpd.name = devm\_kasprintf(dev, GFP\_KERNEL,+ "%s.%d", np->name, i);+ if (!scpi\_pd->genpd.name) {+ dev\_err(dev, "Failed to allocate genpd name:%s.%d\n",+ np->name, i);+ continue;+ } scpi\_pd->genpd.power\_off = scpi\_pd\_power\_off; scpi\_pd->genpd.power\_on = scpi\_pd\_power\_on; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 05:26:02 +0000



=== Content from git.kernel.org_7c9f7125_20250111_052730.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=865ed67ab955428b9aa771d8b4f1e4fb7fd08945)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=865ed67ab955428b9aa771d8b4f1e4fb7fd08945)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=865ed67ab955428b9aa771d8b4f1e4fb7fd08945)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=865ed67ab955428b9aa771d8b4f1e4fb7fd08945)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Sudeep Holla <sudeep.holla@arm.com> | 2021-12-09 12:04:56 +0000 |
| --- | --- | --- |
| committer | Arnd Bergmann <arnd@arndb.de> | 2021-12-13 15:17:37 +0100 |
| commit | [865ed67ab955428b9aa771d8b4f1e4fb7fd08945](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=865ed67ab955428b9aa771d8b4f1e4fb7fd08945) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=865ed67ab955428b9aa771d8b4f1e4fb7fd08945)) | |
| tree | [c1c42564eaab0032d755d246a66b4ce7fed9542f](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=865ed67ab955428b9aa771d8b4f1e4fb7fd08945) | |
| parent | [38d5b296d39e8c0afe8efd4e351e12960cc3881e](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=38d5b296d39e8c0afe8efd4e351e12960cc3881e) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=865ed67ab955428b9aa771d8b4f1e4fb7fd08945&id2=38d5b296d39e8c0afe8efd4e351e12960cc3881e)) | |
| download | [linux-865ed67ab955428b9aa771d8b4f1e4fb7fd08945.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-865ed67ab955428b9aa771d8b4f1e4fb7fd08945.tar.gz) | |

firmware: arm\_scpi: Fix string overflow in SCPI genpd driverWithout the bound checks for scpi\_pd->name, it could result in the buffer
overflow when copying the SCPI device name from the corresponding device
tree node as the name string is set at maximum size of 30.
Let us fix it by using devm\_kasprintf so that the string buffer is
allocated dynamically.
Fixes: 8bec4337ad40 ("firmware: scpi: add device power domain support using genpd")
Reported-by: Pedro Batista <pedbap.g@gmail.com>
Signed-off-by: Sudeep Holla <sudeep.holla@arm.com>
Cc: stable@vger.kernel.org
Cc: Cristian Marussi <cristian.marussi@arm.com>
Link: [https://lore.kernel.org/r/20211209120456.696879-1-sudeep.holla@arm.com'](https://lore.kernel.org/r/20211209120456.696879-1-sudeep.holla%40arm.com%27)
Signed-off-by: Arnd Bergmann <arnd@arndb.de>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=865ed67ab955428b9aa771d8b4f1e4fb7fd08945)

| -rw-r--r-- | [drivers/firmware/scpi\_pm\_domain.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/firmware/scpi_pm_domain.c?id=865ed67ab955428b9aa771d8b4f1e4fb7fd08945) | 10 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 7 insertions, 3 deletions

| diff --git a/drivers/firmware/scpi\_pm\_domain.c b/drivers/firmware/scpi\_pm\_domain.cindex 51201600d789b9..800673910b5111 100644--- a/[drivers/firmware/scpi\_pm\_domain.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/firmware/scpi_pm_domain.c?id=38d5b296d39e8c0afe8efd4e351e12960cc3881e)+++ b/[drivers/firmware/scpi\_pm\_domain.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/firmware/scpi_pm_domain.c?id=865ed67ab955428b9aa771d8b4f1e4fb7fd08945)@@ -16,7 +16,6 @@ struct scpi\_pm\_domain { struct generic\_pm\_domain genpd; struct scpi\_ops \*ops; u32 domain;- char name[30]; };  /\*@@ -110,8 +109,13 @@ static int scpi\_pm\_domain\_probe(struct platform\_device \*pdev)  scpi\_pd->domain = i; scpi\_pd->ops = scpi\_ops;- sprintf(scpi\_pd->name, "%pOFn.%d", np, i);- scpi\_pd->genpd.name = scpi\_pd->name;+ scpi\_pd->genpd.name = devm\_kasprintf(dev, GFP\_KERNEL,+ "%pOFn.%d", np, i);+ if (!scpi\_pd->genpd.name) {+ dev\_err(dev, "Failed to allocate genpd name:%pOFn.%d\n",+ np, i);+ continue;+ } scpi\_pd->genpd.power\_off = scpi\_pd\_power\_off; scpi\_pd->genpd.power\_on = scpi\_pd\_power\_on; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 05:26:07 +0000



=== Content from git.kernel.org_918d3922_20250111_052728.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=7e8645ca2c0046f7cd2f0f7d569fc036c8abaedb)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=7e8645ca2c0046f7cd2f0f7d569fc036c8abaedb)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=7e8645ca2c0046f7cd2f0f7d569fc036c8abaedb)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=7e8645ca2c0046f7cd2f0f7d569fc036c8abaedb)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Sudeep Holla <sudeep.holla@arm.com> | 2021-12-09 12:04:56 +0000 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-12-22 09:19:04 +0100 |
| commit | [7e8645ca2c0046f7cd2f0f7d569fc036c8abaedb](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=7e8645ca2c0046f7cd2f0f7d569fc036c8abaedb) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=7e8645ca2c0046f7cd2f0f7d569fc036c8abaedb)) | |
| tree | [d0cb9875339bb82ad24ac3e53f973ee8207b4b6c](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=7e8645ca2c0046f7cd2f0f7d569fc036c8abaedb) | |
| parent | [9723ebad4c729fb4e0c16a06e5636471bdd4ddba](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=9723ebad4c729fb4e0c16a06e5636471bdd4ddba) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=7e8645ca2c0046f7cd2f0f7d569fc036c8abaedb&id2=9723ebad4c729fb4e0c16a06e5636471bdd4ddba)) | |
| download | [linux-7e8645ca2c0046f7cd2f0f7d569fc036c8abaedb.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-7e8645ca2c0046f7cd2f0f7d569fc036c8abaedb.tar.gz) | |

firmware: arm\_scpi: Fix string overflow in SCPI genpd drivercommit 865ed67ab955428b9aa771d8b4f1e4fb7fd08945 upstream.
Without the bound checks for scpi\_pd->name, it could result in the buffer
overflow when copying the SCPI device name from the corresponding device
tree node as the name string is set at maximum size of 30.
Let us fix it by using devm\_kasprintf so that the string buffer is
allocated dynamically.
Fixes: 8bec4337ad40 ("firmware: scpi: add device power domain support using genpd")
Reported-by: Pedro Batista <pedbap.g@gmail.com>
Signed-off-by: Sudeep Holla <sudeep.holla@arm.com>
Cc: stable@vger.kernel.org
Cc: Cristian Marussi <cristian.marussi@arm.com>
Link: [https://lore.kernel.org/r/20211209120456.696879-1-sudeep.holla@arm.com'](https://lore.kernel.org/r/20211209120456.696879-1-sudeep.holla%40arm.com%27)
Signed-off-by: Arnd Bergmann <arnd@arndb.de>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=7e8645ca2c0046f7cd2f0f7d569fc036c8abaedb)

| -rw-r--r-- | [drivers/firmware/scpi\_pm\_domain.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/firmware/scpi_pm_domain.c?id=7e8645ca2c0046f7cd2f0f7d569fc036c8abaedb) | 10 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 7 insertions, 3 deletions

| diff --git a/drivers/firmware/scpi\_pm\_domain.c b/drivers/firmware/scpi\_pm\_domain.cindex f395dec271131a..a6e62a793fbe60 100644--- a/[drivers/firmware/scpi\_pm\_domain.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/firmware/scpi_pm_domain.c?id=9723ebad4c729fb4e0c16a06e5636471bdd4ddba)+++ b/[drivers/firmware/scpi\_pm\_domain.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/firmware/scpi_pm_domain.c?id=7e8645ca2c0046f7cd2f0f7d569fc036c8abaedb)@@ -27,7 +27,6 @@ struct scpi\_pm\_domain { struct generic\_pm\_domain genpd; struct scpi\_ops \*ops; u32 domain;- char name[30]; };  /\*@@ -121,8 +120,13 @@ static int scpi\_pm\_domain\_probe(struct platform\_device \*pdev)  scpi\_pd->domain = i; scpi\_pd->ops = scpi\_ops;- sprintf(scpi\_pd->name, "%s.%d", np->name, i);- scpi\_pd->genpd.name = scpi\_pd->name;+ scpi\_pd->genpd.name = devm\_kasprintf(dev, GFP\_KERNEL,+ "%s.%d", np->name, i);+ if (!scpi\_pd->genpd.name) {+ dev\_err(dev, "Failed to allocate genpd name:%s.%d\n",+ np->name, i);+ continue;+ } scpi\_pd->genpd.power\_off = scpi\_pd\_power\_off; scpi\_pd->genpd.power\_on = scpi\_pd\_power\_on; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 05:26:05 +0000



=== Content from git.kernel.org_64492afe_20250111_052731.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=976389cbb16cee46847e5d06250a3a0b5506781e)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=976389cbb16cee46847e5d06250a3a0b5506781e)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=976389cbb16cee46847e5d06250a3a0b5506781e)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=976389cbb16cee46847e5d06250a3a0b5506781e)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Sudeep Holla <sudeep.holla@arm.com> | 2021-12-09 12:04:56 +0000 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-12-22 09:32:35 +0100 |
| commit | [976389cbb16cee46847e5d06250a3a0b5506781e](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=976389cbb16cee46847e5d06250a3a0b5506781e) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=976389cbb16cee46847e5d06250a3a0b5506781e)) | |
| tree | [a31bf1faae20189d6d1902046d9827b56f0c8d7e](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=976389cbb16cee46847e5d06250a3a0b5506781e) | |
| parent | [c62b16f98688ae7bc0ab23a6490481f4ce9b3a49](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c62b16f98688ae7bc0ab23a6490481f4ce9b3a49) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=976389cbb16cee46847e5d06250a3a0b5506781e&id2=c62b16f98688ae7bc0ab23a6490481f4ce9b3a49)) | |
| download | [linux-976389cbb16cee46847e5d06250a3a0b5506781e.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-976389cbb16cee46847e5d06250a3a0b5506781e.tar.gz) | |

firmware: arm\_scpi: Fix string overflow in SCPI genpd drivercommit 865ed67ab955428b9aa771d8b4f1e4fb7fd08945 upstream.
Without the bound checks for scpi\_pd->name, it could result in the buffer
overflow when copying the SCPI device name from the corresponding device
tree node as the name string is set at maximum size of 30.
Let us fix it by using devm\_kasprintf so that the string buffer is
allocated dynamically.
Fixes: 8bec4337ad40 ("firmware: scpi: add device power domain support using genpd")
Reported-by: Pedro Batista <pedbap.g@gmail.com>
Signed-off-by: Sudeep Holla <sudeep.holla@arm.com>
Cc: stable@vger.kernel.org
Cc: Cristian Marussi <cristian.marussi@arm.com>
Link: [https://lore.kernel.org/r/20211209120456.696879-1-sudeep.holla@arm.com'](https://lore.kernel.org/r/20211209120456.696879-1-sudeep.holla%40arm.com%27)
Signed-off-by: Arnd Bergmann <arnd@arndb.de>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=976389cbb16cee46847e5d06250a3a0b5506781e)

| -rw-r--r-- | [drivers/firmware/scpi\_pm\_domain.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/firmware/scpi_pm_domain.c?id=976389cbb16cee46847e5d06250a3a0b5506781e) | 10 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 7 insertions, 3 deletions

| diff --git a/drivers/firmware/scpi\_pm\_domain.c b/drivers/firmware/scpi\_pm\_domain.cindex 51201600d789b9..800673910b5111 100644--- a/[drivers/firmware/scpi\_pm\_domain.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/firmware/scpi_pm_domain.c?id=c62b16f98688ae7bc0ab23a6490481f4ce9b3a49)+++ b/[drivers/firmware/scpi\_pm\_domain.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/firmware/scpi_pm_domain.c?id=976389cbb16cee46847e5d06250a3a0b5506781e)@@ -16,7 +16,6 @@ struct scpi\_pm\_domain { struct generic\_pm\_domain genpd; struct scpi\_ops \*ops; u32 domain;- char name[30]; };  /\*@@ -110,8 +109,13 @@ static int scpi\_pm\_domain\_probe(struct platform\_device \*pdev)  scpi\_pd->domain = i; scpi\_pd->ops = scpi\_ops;- sprintf(scpi\_pd->name, "%pOFn.%d", np, i);- scpi\_pd->genpd.name = scpi\_pd->name;+ scpi\_pd->genpd.name = devm\_kasprintf(dev, GFP\_KERNEL,+ "%pOFn.%d", np, i);+ if (!scpi\_pd->genpd.name) {+ dev\_err(dev, "Failed to allocate genpd name:%pOFn.%d\n",+ np, i);+ continue;+ } scpi\_pd->genpd.power\_off = scpi\_pd\_power\_off; scpi\_pd->genpd.power\_on = scpi\_pd\_power\_on; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 05:26:08 +0000



=== Content from git.kernel.org_2889dd3b_20250111_052726.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=639901b9429a3195e0fead981ed74b51f5f31538)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=639901b9429a3195e0fead981ed74b51f5f31538)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=639901b9429a3195e0fead981ed74b51f5f31538)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=639901b9429a3195e0fead981ed74b51f5f31538)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Sudeep Holla <sudeep.holla@arm.com> | 2021-12-09 12:04:56 +0000 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-12-22 09:05:15 +0100 |
| commit | [639901b9429a3195e0fead981ed74b51f5f31538](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=639901b9429a3195e0fead981ed74b51f5f31538) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=639901b9429a3195e0fead981ed74b51f5f31538)) | |
| tree | [8d72dfa51c3777c32c3912769b413f58e00ae7d1](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=639901b9429a3195e0fead981ed74b51f5f31538) | |
| parent | [de57f62f76450b934de8203711bdc4f7953c3421](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=de57f62f76450b934de8203711bdc4f7953c3421) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=639901b9429a3195e0fead981ed74b51f5f31538&id2=de57f62f76450b934de8203711bdc4f7953c3421)) | |
| download | [linux-639901b9429a3195e0fead981ed74b51f5f31538.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-639901b9429a3195e0fead981ed74b51f5f31538.tar.gz) | |

firmware: arm\_scpi: Fix string overflow in SCPI genpd drivercommit 865ed67ab955428b9aa771d8b4f1e4fb7fd08945 upstream.
Without the bound checks for scpi\_pd->name, it could result in the buffer
overflow when copying the SCPI device name from the corresponding device
tree node as the name string is set at maximum size of 30.
Let us fix it by using devm\_kasprintf so that the string buffer is
allocated dynamically.
Fixes: 8bec4337ad40 ("firmware: scpi: add device power domain support using genpd")
Reported-by: Pedro Batista <pedbap.g@gmail.com>
Signed-off-by: Sudeep Holla <sudeep.holla@arm.com>
Cc: stable@vger.kernel.org
Cc: Cristian Marussi <cristian.marussi@arm.com>
Link: [https://lore.kernel.org/r/20211209120456.696879-1-sudeep.holla@arm.com'](https://lore.kernel.org/r/20211209120456.696879-1-sudeep.holla%40arm.com%27)
Signed-off-by: Arnd Bergmann <arnd@arndb.de>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=639901b9429a3195e0fead981ed74b51f5f31538)

| -rw-r--r-- | [drivers/firmware/scpi\_pm\_domain.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/firmware/scpi_pm_domain.c?id=639901b9429a3195e0fead981ed74b51f5f31538) | 10 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 7 insertions, 3 deletions

| diff --git a/drivers/firmware/scpi\_pm\_domain.c b/drivers/firmware/scpi\_pm\_domain.cindex f395dec271131a..a6e62a793fbe60 100644--- a/[drivers/firmware/scpi\_pm\_domain.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/firmware/scpi_pm_domain.c?id=de57f62f76450b934de8203711bdc4f7953c3421)+++ b/[drivers/firmware/scpi\_pm\_domain.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/firmware/scpi_pm_domain.c?id=639901b9429a3195e0fead981ed74b51f5f31538)@@ -27,7 +27,6 @@ struct scpi\_pm\_domain { struct generic\_pm\_domain genpd; struct scpi\_ops \*ops; u32 domain;- char name[30]; };  /\*@@ -121,8 +120,13 @@ static int scpi\_pm\_domain\_probe(struct platform\_device \*pdev)  scpi\_pd->domain = i; scpi\_pd->ops = scpi\_ops;- sprintf(scpi\_pd->name, "%s.%d", np->name, i);- scpi\_pd->genpd.name = scpi\_pd->name;+ scpi\_pd->genpd.name = devm\_kasprintf(dev, GFP\_KERNEL,+ "%s.%d", np->name, i);+ if (!scpi\_pd->genpd.name) {+ dev\_err(dev, "Failed to allocate genpd name:%s.%d\n",+ np->name, i);+ continue;+ } scpi\_pd->genpd.power\_off = scpi\_pd\_power\_off; scpi\_pd->genpd.power\_on = scpi\_pd\_power\_on; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 05:26:04 +0000



=== Content from git.kernel.org_b89fdb33_20250111_052729.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=802a1a8501563714a5fe8824f4ed27fec04a0719)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=802a1a8501563714a5fe8824f4ed27fec04a0719)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=802a1a8501563714a5fe8824f4ed27fec04a0719)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=802a1a8501563714a5fe8824f4ed27fec04a0719)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Sudeep Holla <sudeep.holla@arm.com> | 2021-12-09 12:04:56 +0000 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-12-22 09:29:34 +0100 |
| commit | [802a1a8501563714a5fe8824f4ed27fec04a0719](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=802a1a8501563714a5fe8824f4ed27fec04a0719) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=802a1a8501563714a5fe8824f4ed27fec04a0719)) | |
| tree | [3b1ae18912d9c28ea6edceb084cd63d4c2ce091e](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=802a1a8501563714a5fe8824f4ed27fec04a0719) | |
| parent | [33f0dfab3187ff46d6f4eb443f04e7406f1d63d8](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=33f0dfab3187ff46d6f4eb443f04e7406f1d63d8) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=802a1a8501563714a5fe8824f4ed27fec04a0719&id2=33f0dfab3187ff46d6f4eb443f04e7406f1d63d8)) | |
| download | [linux-802a1a8501563714a5fe8824f4ed27fec04a0719.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-802a1a8501563714a5fe8824f4ed27fec04a0719.tar.gz) | |

firmware: arm\_scpi: Fix string overflow in SCPI genpd drivercommit 865ed67ab955428b9aa771d8b4f1e4fb7fd08945 upstream.
Without the bound checks for scpi\_pd->name, it could result in the buffer
overflow when copying the SCPI device name from the corresponding device
tree node as the name string is set at maximum size of 30.
Let us fix it by using devm\_kasprintf so that the string buffer is
allocated dynamically.
Fixes: 8bec4337ad40 ("firmware: scpi: add device power domain support using genpd")
Reported-by: Pedro Batista <pedbap.g@gmail.com>
Signed-off-by: Sudeep Holla <sudeep.holla@arm.com>
Cc: stable@vger.kernel.org
Cc: Cristian Marussi <cristian.marussi@arm.com>
Link: [https://lore.kernel.org/r/20211209120456.696879-1-sudeep.holla@arm.com'](https://lore.kernel.org/r/20211209120456.696879-1-sudeep.holla%40arm.com%27)
Signed-off-by: Arnd Bergmann <arnd@arndb.de>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=802a1a8501563714a5fe8824f4ed27fec04a0719)

| -rw-r--r-- | [drivers/firmware/scpi\_pm\_domain.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/firmware/scpi_pm_domain.c?id=802a1a8501563714a5fe8824f4ed27fec04a0719) | 10 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 7 insertions, 3 deletions

| diff --git a/drivers/firmware/scpi\_pm\_domain.c b/drivers/firmware/scpi\_pm\_domain.cindex 51201600d789b9..800673910b5111 100644--- a/[drivers/firmware/scpi\_pm\_domain.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/firmware/scpi_pm_domain.c?id=33f0dfab3187ff46d6f4eb443f04e7406f1d63d8)+++ b/[drivers/firmware/scpi\_pm\_domain.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/firmware/scpi_pm_domain.c?id=802a1a8501563714a5fe8824f4ed27fec04a0719)@@ -16,7 +16,6 @@ struct scpi\_pm\_domain { struct generic\_pm\_domain genpd; struct scpi\_ops \*ops; u32 domain;- char name[30]; };  /\*@@ -110,8 +109,13 @@ static int scpi\_pm\_domain\_probe(struct platform\_device \*pdev)  scpi\_pd->domain = i; scpi\_pd->ops = scpi\_ops;- sprintf(scpi\_pd->name, "%pOFn.%d", np, i);- scpi\_pd->genpd.name = scpi\_pd->name;+ scpi\_pd->genpd.name = devm\_kasprintf(dev, GFP\_KERNEL,+ "%pOFn.%d", np, i);+ if (!scpi\_pd->genpd.name) {+ dev\_err(dev, "Failed to allocate genpd name:%pOFn.%d\n",+ np, i);+ continue;+ } scpi\_pd->genpd.power\_off = scpi\_pd\_power\_off; scpi\_pd->genpd.power\_on = scpi\_pd\_power\_on; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 05:26:06 +0000


