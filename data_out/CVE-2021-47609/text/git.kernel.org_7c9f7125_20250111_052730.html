

| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=865ed67ab955428b9aa771d8b4f1e4fb7fd08945)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=865ed67ab955428b9aa771d8b4f1e4fb7fd08945)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=865ed67ab955428b9aa771d8b4f1e4fb7fd08945)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=865ed67ab955428b9aa771d8b4f1e4fb7fd08945)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Sudeep Holla <sudeep.holla@arm.com> | 2021-12-09 12:04:56 +0000 |
| --- | --- | --- |
| committer | Arnd Bergmann <arnd@arndb.de> | 2021-12-13 15:17:37 +0100 |
| commit | [865ed67ab955428b9aa771d8b4f1e4fb7fd08945](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=865ed67ab955428b9aa771d8b4f1e4fb7fd08945) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=865ed67ab955428b9aa771d8b4f1e4fb7fd08945)) | |
| tree | [c1c42564eaab0032d755d246a66b4ce7fed9542f](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=865ed67ab955428b9aa771d8b4f1e4fb7fd08945) | |
| parent | [38d5b296d39e8c0afe8efd4e351e12960cc3881e](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=38d5b296d39e8c0afe8efd4e351e12960cc3881e) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=865ed67ab955428b9aa771d8b4f1e4fb7fd08945&id2=38d5b296d39e8c0afe8efd4e351e12960cc3881e)) | |
| download | [linux-865ed67ab955428b9aa771d8b4f1e4fb7fd08945.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-865ed67ab955428b9aa771d8b4f1e4fb7fd08945.tar.gz) | |

firmware: arm\_scpi: Fix string overflow in SCPI genpd driverWithout the bound checks for scpi\_pd->name, it could result in the buffer
overflow when copying the SCPI device name from the corresponding device
tree node as the name string is set at maximum size of 30.
Let us fix it by using devm\_kasprintf so that the string buffer is
allocated dynamically.
Fixes: 8bec4337ad40 ("firmware: scpi: add device power domain support using genpd")
Reported-by: Pedro Batista <pedbap.g@gmail.com>
Signed-off-by: Sudeep Holla <sudeep.holla@arm.com>
Cc: stable@vger.kernel.org
Cc: Cristian Marussi <cristian.marussi@arm.com>
Link: [https://lore.kernel.org/r/20211209120456.696879-1-sudeep.holla@arm.com'](https://lore.kernel.org/r/20211209120456.696879-1-sudeep.holla%40arm.com%27)
Signed-off-by: Arnd Bergmann <arnd@arndb.de>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=865ed67ab955428b9aa771d8b4f1e4fb7fd08945)

| -rw-r--r-- | [drivers/firmware/scpi\_pm\_domain.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/firmware/scpi_pm_domain.c?id=865ed67ab955428b9aa771d8b4f1e4fb7fd08945) | 10 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 7 insertions, 3 deletions

| diff --git a/drivers/firmware/scpi\_pm\_domain.c b/drivers/firmware/scpi\_pm\_domain.cindex 51201600d789b9..800673910b5111 100644--- a/[drivers/firmware/scpi\_pm\_domain.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/firmware/scpi_pm_domain.c?id=38d5b296d39e8c0afe8efd4e351e12960cc3881e)+++ b/[drivers/firmware/scpi\_pm\_domain.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/firmware/scpi_pm_domain.c?id=865ed67ab955428b9aa771d8b4f1e4fb7fd08945)@@ -16,7 +16,6 @@ struct scpi\_pm\_domain { struct generic\_pm\_domain genpd; struct scpi\_ops \*ops; u32 domain;- char name[30]; };  /\*@@ -110,8 +109,13 @@ static int scpi\_pm\_domain\_probe(struct platform\_device \*pdev)  scpi\_pd->domain = i; scpi\_pd->ops = scpi\_ops;- sprintf(scpi\_pd->name, "%pOFn.%d", np, i);- scpi\_pd->genpd.name = scpi\_pd->name;+ scpi\_pd->genpd.name = devm\_kasprintf(dev, GFP\_KERNEL,+ "%pOFn.%d", np, i);+ if (!scpi\_pd->genpd.name) {+ dev\_err(dev, "Failed to allocate genpd name:%pOFn.%d\n",+ np, i);+ continue;+ } scpi\_pd->genpd.power\_off = scpi\_pd\_power\_off; scpi\_pd->genpd.power\_on = scpi\_pd\_power\_on; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 05:26:07 +0000

