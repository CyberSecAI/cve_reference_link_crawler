=== Content from plugins.trac.wordpress.org_4a4d6373_20250111_082617.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%3Fnew%3D2553337%2540free-comments-for-wordpress-vuukle%26old%3D2553337%2540free-comments-for-wordpress-vuukle)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/2553326/free-comments-for-wordpress-vuukle "Changeset 2553326 for free-comments-for-wordpress-vuukle")
* [Next Change](/changeset/2553351/free-comments-for-wordpress-vuukle "Changeset 2553351 for free-comments-for-wordpress-vuukle") →

---

# Changeset [2553337](/changeset/2553337 "Show full changeset") for [free-comments-for-wordpress-vuukle](/browser/free-comments-for-wordpress-vuukle?rev=2553337 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
06/24/2021 12:44:49 PM
([4 years](/timeline?from=2021-06-24T12%3A44%3A49Z&precision=second "See timeline at 06/24/2021 12:44:49 PM") ago)

Author:
vuukle
Message:

4.0 trunk release

Location:
[free-comments-for-wordpress-vuukle/trunk](/browser/free-comments-for-wordpress-vuukle/trunk?rev=2553337)
Files:

2 added
1 deleted
12 edited

* [.gitignore](/browser/free-comments-for-wordpress-vuukle/trunk/.gitignore?rev=2553337 "Show entry in browser")
  (added)
* [README.txt](/browser/free-comments-for-wordpress-vuukle/trunk/README.txt?rev=2553337 "Show entry in browser")
  (modified)
  ([2 diffs](#file1 "Show differences"))
* [admin/class-free-comments-for-wordpress-vuukle-admin.php](/browser/free-comments-for-wordpress-vuukle/trunk/admin/class-free-comments-for-wordpress-vuukle-admin.php?rev=2553337 "Show entry in browser")
  (modified)
  ([6 diffs](#file2 "Show differences"))
* [admin/js/count.js](/browser/free-comments-for-wordpress-vuukle/trunk/admin/js/count.js?rev=2527980 "Show what was removed (content at revision 2553336)")
  (deleted)
* [admin/js/free-comments-for-wordpress-vuukle-admin.js](/browser/free-comments-for-wordpress-vuukle/trunk/admin/js/free-comments-for-wordpress-vuukle-admin.js?rev=2553337 "Show entry in browser")
  (modified)
  ([1 diff](#file4 "Show differences"))
* [admin/partials/free-comments-for-wordpress-vuukle-admin-display.php](/browser/free-comments-for-wordpress-vuukle/trunk/admin/partials/free-comments-for-wordpress-vuukle-admin-display.php?rev=2553337 "Show entry in browser")
  (modified)
  ([21 diffs](#file5 "Show differences"))
* [export.js](/browser/free-comments-for-wordpress-vuukle/trunk/export.js?rev=2553337 "Show entry in browser")
  (added)
* [free-comments-for-wordpress-vuukle.php](/browser/free-comments-for-wordpress-vuukle/trunk/free-comments-for-wordpress-vuukle.php?rev=2553337 "Show entry in browser")
  (modified)
  ([2 diffs](#file7 "Show differences"))
* [includes/class-free-comments-for-wordpress-vuukle.php](/browser/free-comments-for-wordpress-vuukle/trunk/includes/class-free-comments-for-wordpress-vuukle.php?rev=2553337 "Show entry in browser")
  (modified)
  ([2 diffs](#file8 "Show differences"))
* [includes/commentbox.php](/browser/free-comments-for-wordpress-vuukle/trunk/includes/commentbox.php?rev=2553337 "Show entry in browser")
  (modified)
  ([2 diffs](#file9 "Show differences"))
* [includes/export-comments.php](/browser/free-comments-for-wordpress-vuukle/trunk/includes/export-comments.php?rev=2553337 "Show entry in browser")
  (modified)
  ([5 diffs](#file10 "Show differences"))
* [includes/free-comments-for-wordpress-vuukle-activate-modal.php](/browser/free-comments-for-wordpress-vuukle/trunk/includes/free-comments-for-wordpress-vuukle-activate-modal.php?rev=2553337 "Show entry in browser")
  (modified)
  ([5 diffs](#file11 "Show differences"))
* [includes/free-comments-for-wordpress-vuukle-deactivate-modal.php](/browser/free-comments-for-wordpress-vuukle/trunk/includes/free-comments-for-wordpress-vuukle-deactivate-modal.php?rev=2553337 "Show entry in browser")
  (modified)
  ([6 diffs](#file12 "Show differences"))
* [includes/vuukleplatform.php](/browser/free-comments-for-wordpress-vuukle/trunk/includes/vuukleplatform.php?rev=2553337 "Show entry in browser")
  (modified)
  ([4 diffs](#file13 "Show differences"))
* [public/class-free-comments-for-wordpress-vuukle-public.php](/browser/free-comments-for-wordpress-vuukle/trunk/public/class-free-comments-for-wordpress-vuukle-public.php?rev=2553337 "Show entry in browser")
  (modified)
  ([4 diffs](#file14 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [free-comments-for-wordpress-vuukle/trunk/README.txt](/changeset/2553337/free-comments-for-wordpress-vuukle/trunk/README.txt "Show the changeset 2553337 restricted to free-comments-for-wordpress-vuukle/trunk/README.txt")

  | [r2533938](/browser/free-comments-for-wordpress-vuukle/trunk/README.txt?rev=2533938#L4 "Show revision 2533938 of this file in browser") | [r2553337](/browser/free-comments-for-wordpress-vuukle/trunk/README.txt?rev=2553337#L4 "Show revision 2553337 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | Requires at least: 2.0.2 |
  | 5 | 5 | Tested up to: 5.7 |
  | 6 |  | Version: ~~3.4.31~~ |
  |  | 6 | Version: 4.0 |
  | 7 | 7 | Stable tag: trunk |
  | 8 | 8 | Requires PHP: 5.4 |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/README.txt?rev=2533938#L173) | […](/browser/free-comments-for-wordpress-vuukle/trunk/README.txt?rev=2553337#L173) |  |
  | 173 | 173 |  |
  | 174 | 174 | == Changelog == |
  | 175 |  | - enabled share bar targetting for specific option |
  | 176 |  | - performance optimizations and bug fixes |
  |  | 175 | - Added SEO features |
  | 177 | 176 |  |
  | 178 | 177 | == Upgrade Notice == |
* ## [free-comments-for-wordpress-vuukle/trunk/admin/class-free-comments-for-wordpress-vuukle-admin.php](/changeset/2553337/free-comments-for-wordpress-vuukle/trunk/admin/class-free-comments-for-wordpress-vuukle-admin.php "Show the changeset 2553337 restricted to free-comments-for-wordpress-vuukle/trunk/admin/class-free-comments-for-wordpress-vuukle-admin.php")

  | [r2533938](/browser/free-comments-for-wordpress-vuukle/trunk/admin/class-free-comments-for-wordpress-vuukle-admin.php?rev=2533938#L1 "Show revision 2533938 of this file in browser") | [r2553337](/browser/free-comments-for-wordpress-vuukle/trunk/admin/class-free-comments-for-wordpress-vuukle-admin.php?rev=2553337#L1 "Show revision 2553337 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php |
  | 2 |  |  |
  | 3 | 2 | /\*\* |
  | 4 | 3 | \* The admin-specific functionality of the plugin. |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/class-free-comments-for-wordpress-vuukle-admin.php?rev=2533938#L26) | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/class-free-comments-for-wordpress-vuukle-admin.php?rev=2553337#L25) |  |
  | 26 | 25 | \* @link       https://vuukle.com |
  | 27 | 26 | \*/ |
  | 28 |  | class Free\_Comments\_For\_Wordpress\_Vuukle\_Admin |
  | 29 |  | { |
  | 30 |  |  |
  | 31 |  | /\*\* |
  | 32 |  | \* The ID of this plugin. |
  | 33 |  | \* |
  | 34 |  | \* @since  1.0.0 |
  | 35 |  | \* @access private |
  | 36 |  | \* @var    string    $plugin\_name    The ID of this plugin. |
  | 37 |  | \*/ |
  | 38 |  | private $plugin\_name; |
  | 39 |  |  |
  | 40 |  | /\*\* |
  | 41 |  | \* The version of this plugin. |
  | 42 |  | \* |
  | 43 |  | \* @since  1.0.0 |
  | 44 |  | \* @access private |
  | 45 |  | \* @var    string    $version    The current version of this plugin. |
  | 46 |  | \*/ |
  | 47 |  | private $version; |
  | 48 |  |  |
  | 49 |  | /\*\* |
  | 50 |  | \* Initialize the class and set its properties. |
  | 51 |  | \* |
  | 52 |  | \* @param string $plugin\_name The name of this plugin. |
  | 53 |  | \* @param string $version     The version of this plugin. |
  | 54 |  | \*/ |
  | 55 |  | public function \_\_construct($plugin\_name, $version) |
  | 56 |  | { |
  | 57 |  |  |
  | 58 |  | $this->plugin\_name = $plugin\_name; |
  | 59 |  | $this->version = $version; |
  | 60 |  | $this->settings\_url  = 'options-general.php?page=' . dirname(plugin\_basename($this->plugin\_name)) . '/' . basename($this->plugin\_name); |
  | 61 |  | $this->settings\_name = 'Vuukle'; |
  | 62 |  | $this->settings      = get\_option($this->settings\_name); |
  | 63 |  | $comments\_status = get\_option('default\_comment\_status', false); |
  | 64 |  | $this->settings\_defaults = array( |
  | 65 |  | 'AppId'                       => '', |
  | 66 |  | 'sso'                         => 'false', |
  | 67 |  | 'div\_id'                      => '', |
  | 68 |  | 'div\_class'                   => '', |
  | 69 |  | 'div\_id\_powerbar'             => '', |
  | 70 |  | 'div\_id\_emotes'               => '', |
  | 71 |  | 'div\_id\_newsfeed'             => '', |
  | 72 |  | 'div\_class\_powerbar'          => '', |
  | 73 |  | 'div\_class\_powerbar2'         => '', |
  | 74 |  | 'div\_class\_emotes'            => '', |
  | 75 |  | 'div\_class\_newsfeed'          => '', |
  | 76 |  | 'lang'                        => '', |
  | 77 |  | 'emote'                       => 'true', |
  | 78 |  | 'save\_ads\_txt'                => ($this->settings['save\_ads\_txt'])?$this->settings['save\_ads\_txt']:'false', |
  | 79 |  | 'save\_comments'               => '0', |
  | 80 |  | 'recomendations\_protocol'     => 'none', |
  | 81 |  | 'enabled\_comments'            => 'true', |
  | 82 |  | 'amount\_comments'             => 1000, |
  | 83 |  | 'embed\_comments'              => $comments\_status == "open" ? '1' : '2', |
  | 84 |  | 'embed\_emotes'                => '0', |
  | 85 |  | 'mobile\_type'                 => 'vertical', |
  | 86 |  | 'desktop\_type'                => 'vertical', |
  | 87 |  | 'embed\_newsfeed'              => '0', |
  | 88 |  | 'embed\_powerbar'              => '0', |
  | 89 |  | 'embed\_powerbar\_vertical'     => '0', |
  | 90 |  | 'div\_class\_powerbar\_vertical' => '0', |
  | 91 |  | 'endless\_mode'                => '0', |
  | 92 |  | 'email\_for\_export\_comments'   => 'support@vuukle.com', |
  | 93 |  | 'start\_date\_comments'         => gmdate('Y-m-d', strtotime('-30 days')), |
  | 94 |  | 'end\_date\_comments'           => gmdate('Y-m-d'), |
  | 95 |  | 'og\_tags'                     => '0', |
  | 96 |  | 'vuukle\_facebook\_url'         => '', |
  | 97 |  | 'vuukle\_twitter\_url'          => '', |
  | 98 |  | 'vuukle\_linkedin\_url'         => '', |
  | 99 |  | 'vuukle\_publisher\_url'        => '', |
  | 100 |  | 'embed\_emotes\_amp'            => 'off', |
  | 101 |  | 'enable\_seo'                  => 'off', |
  | 102 |  | 'non\_article\_pages'           => 'off', |
  | 103 |  | // 'vuukle\_user\_linkedin\_url'    => '', |
  | 104 |  | // 'vuukle\_user\_twitter\_url'     => '', |
  | 105 |  | 'text'                        => array( |
  | 106 |  | 'common'                  => array( |
  | 107 |  | //Name for user to enter |
  | 108 |  | 'name'         => 'Name', |
  | 109 |  | //Email for user to enter |
  | 110 |  | 'email'        => 'Email', |
  | 111 |  | //Place holder when user is not logged in |
  | 112 |  | 'me'           => 'Me', |
  | 113 |  | //Message as placeholder for user to write comment |
  | 114 |  | 'writeComment' => 'Write a comment', |
  | 115 |  | //Message to show when user attempts to login without entering name |
  | 116 |  | 'blankName'    => 'Name can not be blank', |
  | 117 |  | //Message to show when user attempts to login without entering email |
  | 118 |  | 'blankEmail'   => 'Email can not be blank', |
  | 119 |  | //Message to show when user attempts to comment without entering text |
  | 120 |  | 'blankComment' => 'Comment can not be blank', |
  | 121 |  | //Message to show when user write invalid email |
  | 122 |  | 'invalidEmail' => 'Invalid email, please try again.', |
  | 123 |  | //Message to show when user write invalid name |
  | 124 |  | 'invalidName'  => 'Name should not contain numbers, www., or special characters. Thank You.', |
  | 125 |  | //Message to show when user doesn't agree to terms and conditions |
  | 126 |  | 'checkTerms'   => 'Please Check the T&C box to post comments', |
  | 127 |  | ), |
  | 128 |  | 'messages'           => array( |
  | 129 |  | //Message to show when user write comment longer than the configured man comment length |
  | 130 |  | 'charlimits'              => 'The moderator has set a character limit up to', |
  | 131 |  | //Message to show when user tries to Up/Down votes more than once |
  | 132 |  | 'alreadyVoted'            => 'You have already Voted.', |
  | 133 |  | //Message to show when user tries to flag comment more than once |
  | 134 |  | 'alreadyReported'         => 'You have already reported this comment to moderator.', |
  | 135 |  | //Message to show when comments are closed |
  | 136 |  | 'commentsClosed'          => 'Comments are now closed.', |
  | 137 |  | //Message to show when user when the moderator closes the comments |
  | 138 |  | 'commentsClosedModerator' => 'Comments have been closed by the site moderator.', |
  | 139 |  | //Placeholder for writing comment |
  | 140 |  | 'writeComment'            => 'Please write a comment.', |
  | 141 |  | //Message to show when user tries to send the samer comment again |
  | 142 |  | 'alreadySubmitted'        => 'Your comment has been already submitted for this article.', |
  | 143 |  | //Message to show when user tries to comment without signing in |
  | 144 |  | 'loginFirst'              => 'Please enter your Name and Email or login to comment.', |
  | 145 |  | //Message to show when user is needed to sign in |
  | 146 |  | 'loginTry'                => 'Please login and try again.', |
  | 147 |  | //Message to show when user tries to vote without signing in |
  | 148 |  | 'loginToVote'             => 'Please sign in to vote.', |
  | 149 |  | //Message to show when user flags a comment |
  | 150 |  | 'flaggedMessage'          => 'Thanks, the moderator will be notified', |
  | 151 |  | //Message to show when user tries to flag without signing in |
  | 152 |  | 'loginToFlag'             => 'Please sign in to flag a comment.', |
  | 153 |  | //Message to show when error happens in submitting comment |
  | 154 |  | 'errorSubmitting'         => 'There was an error while saving your comment, please refresh the page and try again', |
  | 155 |  | //Message to show when user tries to login with invalid data |
  | 156 |  | 'invalidLogin'            => 'Invalid login, please log in again', |
  | 157 |  | //General error, contact us |
  | 158 |  | 'errorContactVuukle'      => 'error - please notify us at support@vuukle.com', |
  | 159 |  | //Message to show when user is flagged as spammer, and blocked from commenting |
  | 160 |  | 'spammerComment'          => 'Your comment is under moderation', |
  | 161 |  | //Message to show when user tries to comment with any words, like aaaaa etc... |
  | 162 |  | 'nonSenseComment'         => 'Please enter a more descriptive comment.', |
  | 163 |  | //Message to show when user comments and the moderation is on |
  | 164 |  | 'moderationMessage'       => 'Your comment is under moderation and will be approved by the site moderator. Thank you for your patience.', |
  | 165 |  | ), |
  | 166 |  | //These config deal with showing date in the comments, ie: 5 minutes ago, 2 days ago, etc... |
  | 167 |  | 'timeAgo'           => array( |
  | 168 |  | 'suffixAgo'     => 'ago', |
  | 169 |  | 'suffixFromNow' => 'from now', |
  | 170 |  | 'seconds'       => 'less than a minute', |
  | 171 |  | 'minute'        => 'about a minute', |
  | 172 |  | 'minutes'       => '%d minutes', |
  | 173 |  | 'hour'          => 'about an hour', |
  | 174 |  | 'hours'         => 'about %d hours', |
  | 175 |  | 'day'           => 'a day', |
  | 176 |  | 'days'          => '%d days', |
  | 177 |  | 'month'         => 'about a month', |
  | 178 |  | 'months'        => '%d months', |
  | 179 |  | 'year'          => 'about a year', |
  | 180 |  | 'years'         => '%d years', |
  | 181 |  | ), |
  | 182 |  | //Tooltips for sharing icons |
  | 183 |  | 'shareIcons'         => array( |
  | 184 |  | 'google'   => 'Share using Google Plus', |
  | 185 |  | 'facebook' => 'Share using Facebook', |
  | 186 |  | 'twitter'  => 'Share using Twitter', |
  | 187 |  | 'linkedin' => 'Share using Linkedin', |
  | 188 |  | ), |
  | 189 |  | //Tooltips for social logins |
  | 190 |  | 'login'              => array( |
  | 191 |  | 'google'   => 'Login using Google', |
  | 192 |  | 'facebook' => 'Login using Facebook', |
  | 193 |  | 'twitter'  => 'Login using Twitter', |
  | 194 |  | 'linkedin' => 'Login using Linkedin', |
  | 195 |  | ), |
  | 196 |  | 'commentText'        => array( |
  | 197 |  | //Text at header of comment section when there is no comments |
  | 198 |  | 'when0' => 'Leave a comment', |
  | 199 |  | //Text at header of comment section when there is 1 comment |
  | 200 |  | 'when1' => 'comment', |
  | 201 |  | //Text at header of comment section when there is more than comment |
  | 202 |  | 'whenX' => 'comments', |
  | 203 |  | ), |
  | 204 |  | //Rating section strings to show to user, includes ( Average rating 4.5 start from 123 users, etc... ) |
  | 205 |  | 'rating'             => array( |
  | 206 |  | 'header'     => 'Give your rating:', |
  | 207 |  | 'average'    => 'Average', |
  | 208 |  | 'starsFrom'  => 'start from', |
  | 209 |  | 'ratings'    => 'ratings', |
  | 210 |  | 'yourRating' => 'Your rating', |
  | 211 |  | 'stars'      => 'stars', |
  | 212 |  | ), |
  | 213 |  | //Texts for the buttons we have |
  | 214 |  | 'buttons'            => array( |
  | 215 |  | 'loadMore' => 'Load more', |
  | 216 |  | 'singin'   => 'Sign in', |
  | 217 |  | 'post'     => 'Post', |
  | 218 |  | ), |
  | 219 |  |  |
  | 220 |  | ), |
  | 221 |  | 'priority'                    => 300, |
  | 222 |  | 'size\_emote'                  => 70, |
  | 223 |  | 'share'                       => '1', |
  | 224 |  | 'enable\_h\_v'                  => 'no', |
  | 225 |  | 'share\_position'              => '1', |
  | 226 |  | 'share\_position2'             => '1', |
  | 227 |  | 'checkboxTextEnabled'         => false, |
  | 228 |  | 'share\_type'                  => 'horizontal', |
  | 229 |  | 'share\_type\_vertical'         => 'vertical', |
  | 230 |  | 'mobile\_type'                 => 'vertical', |
  | 231 |  | 'mobile\_type\_horizontal'      => 'horizontal', |
  | 232 |  | 'desktop\_type'                => 'vertical', |
  | 233 |  | 'desktop\_type\_horizontal'     => 'horizontal', |
  | 234 |  | 'share\_vertical\_styles'       => 'position:fixed;                                                          z-index: 10001;                                                            width: 60px;                                                            max-width: 60px;                                                           left: 10px;                                                             top: 160px;', |
  | 235 |  | 'emote\_widget\_width'          => '600', |
  | 236 |  | 'emote\_enabled1'              => '1', |
  | 237 |  | 'emote\_enabled2'              => '2', |
  | 238 |  | 'emote\_enabled3'              => '3', |
  | 239 |  | 'emote\_enabled4'              => '4', |
  | 240 |  | 'emote\_enabled5'              => '5', |
  | 241 |  | 'emote\_enabled6'              => '6', |
  | 242 |  | 'newsletter'                  => '0', |
  | 243 |  | 'newsfeed'                    => '0', |
  | 244 |  | 'newsletter\_position'         => '1', |
  | 245 |  | 'post\_exceptions'             => '', |
  | 246 |  | 'happy\_text'                  => 'Happy', |
  | 247 |  | 'happy\_url'                   => '', |
  | 248 |  | 'indifferent\_text'            => 'Unmoved', |
  | 249 |  | 'indifferent\_url'             => '', |
  | 250 |  | 'amused\_text'                 => 'Amused', |
  | 251 |  | 'amused\_url'                  => '', |
  | 252 |  | 'excited\_text'                => 'Excited', |
  | 253 |  | 'excited\_url'                 => '', |
  | 254 |  | 'angry\_text'                  => 'Angry', |
  | 255 |  | 'angry\_url'                   => '', |
  | 256 |  | 'sad\_text'                    => 'Sad', |
  | 257 |  | 'sad\_url'                     => '', |
  | 258 |  | 'category\_exceptions'         => '', |
  | 259 |  | 'post\_type\_exceptions'        => '', |
  | 260 |  | 'post\_type\_by\_url\_exceptions' => '', |
  | 261 |  | 'hide\_chat'                   => 'true', |
  | 262 |  | 'twitter\_handle'              => '', |
  | 263 |  | 'items\_powerbar'              => array( |
  | 264 |  | 'facebook', |
  | 265 |  | 'twitter', |
  | 266 |  | 'whatsapp', |
  | 267 |  | 'linkedin', |
  | 268 |  | 'reddit', |
  | 269 |  | 'messenger', |
  | 270 |  | 'telegram', |
  | 271 |  | 'pinterest', |
  | 272 |  | 'flipboard', |
  | 273 |  | 'email', |
  | 274 |  | ), |
  | 275 |  | 'items\_powerbar\_no\_active'    => array( |
  | 276 |  | 'gab', |
  | 277 |  | 'parler' |
  | 278 |  | ), |
  | 279 |  | ); |
  | 280 |  | } |
  | 281 |  |  |
  | 282 |  | /\*\* |
  | 283 |  | \* Register the stylesheets for the admin area. |
  | 284 |  | \* |
  | 285 |  | \* @since  1.0.0 |
  | 286 |  | \* @return void |
  | 287 |  | \*/ |
  | 288 |  | public function enqueueStyles() |
  | 289 |  | { |
  | 290 |  |  |
  | 291 |  | /\*\* |
  | 292 |  | \* This function is provided for demonstration purposes only. |
  | 293 |  | \* |
  | 294 |  | \* An instance of this class should be passed to the run() function |
  | 295 |  | \* defined in Free\_Comments\_For\_Wordpress\_Vuukle\_Loader as all of the hooks are defined |
  | 296 |  | \* in that particular class. |
  | 297 |  | \* |
  | 298 |  | \* The Free\_Comments\_For\_Wordpress\_Vuukle\_Loader will then create the relationship |
  | 299 |  | \* between the defined hooks and the functions defined in this |
  | 300 |  | \* class. |
  | 301 |  | \*/ |
  | 302 |  |  |
  | 303 |  | if (current\_user\_can('editor') || current\_user\_can('administrator')) { |
  | 304 |  | wp\_enqueue\_style('vuukle\_admin\_font\_awesome', 'https://use.fontawesome.com/releases/v5.2.0/css/all.css', array(), $this->version, 'all'); |
  | 305 |  | wp\_enqueue\_style($this->plugin\_name, plugin\_dir\_url(\_\_FILE\_\_) . 'css/free-comments-for-wordpress-vuukle-admin.css', array(), $this->version, 'all'); |
  | 306 |  | } |
  | 307 |  | } |
  | 308 |  |  |
  | 309 |  | /\*\* |
  | 310 |  | \* Register the JavaScript for the admin area. |
  | 311 |  | \* |
  | 312 |  | \* @since  1.0.0 |
  | 313 |  | \* @return void |
  | 314 |  | \*/ |
  | 315 |  | public function enqueueScripts() |
  | 316 |  | { |
  | 317 |  |  |
  | 318 |  | /\*\* |
  | 319 |  | \* This function is provided for demonstration purposes only. |
  | 320 |  | \* |
  | 321 |  | \* An instance of this class should be passed to the run() function |
  | 322 |  | \* defined in Free\_Comments\_For\_Wordpress\_Vuukle\_Loader as all of the hooks are defined |
  | 323 |  | \* in that particular class. |
  | 324 |  | \* |
  | 325 |  | \* The Free\_Comments\_For\_Wordpress\_Vuukle\_Loader will then create the relationship |
  | 326 |  | \* between the defined hooks and the functions defined in this |
  | 327 |  | \* class. |
  | 328 |  | \*/ |
  | 329 |  | if (current\_user\_can('editor') || current\_user\_can('administrator')) { |
  | 330 |  | wp\_enqueue\_script($this->plugin\_name . "1", plugin\_dir\_url(\_\_FILE\_\_) . 'js/sortable.js', $this->version, false); |
  | 331 |  | wp\_enqueue\_script('jquery'); |
  | 332 |  | wp\_enqueue\_script('jquery-ui-core'); |
  | 333 |  | wp\_enqueue\_script('jquery-ui-dialog'); |
  | 334 |  | wp\_enqueue\_script('jquery-ui-sortable'); |
  | 335 |  | wp\_enqueue\_script($this->plugin\_name, plugin\_dir\_url(\_\_FILE\_\_) . 'js/free-comments-for-wordpress-vuukle-admin.js', $this->version, false); // phpcs:ignore |
  | 336 |  | wp\_enqueue\_script($this->plugin\_name, plugin\_dir\_url(\_\_FILE\_\_) . 'https://securepubads.g.doubleclick.net/tag/js/gpt.js', $this->version, false); |
  | 337 |  | } |
  | 338 |  | } |
  | 339 |  |  |
  | 340 |  | /\*\* |
  | 341 |  | \* This function creates a page in the admin dashboard. |
  | 342 |  | \* |
  | 343 |  | \* @since  1.0.0. |
  | 344 |  | \* @return void |
  | 345 |  | \*/ |
  | 346 |  | public function adminMenu() |
  | 347 |  | { |
  | 348 |  | add\_submenu\_page('options-general.php', 'Vuukle &rsaquo; Settings', 'Vuukle', 'manage\_options', $this->plugin\_name, array($this, 'adminPageVuukle')); |
  | 349 |  | add\_menu\_page('Vuukle Settings', 'Vuukle', 'manage\_options', $this->plugin\_name, array($this, 'adminPageVuukle'),  plugins\_url('free-comments-for-wordpress-vuukle/admin/images/icon@2.png')); |
  | 350 |  | } |
  | 351 |  |  |
  | 352 |  | /\*\* |
  | 353 |  | \* This function adds styles to the menu. |
  | 354 |  | \* |
  | 355 |  | \* @since  1.0.0. |
  | 356 |  | \* @return void |
  | 357 |  | \*/ |
  | 358 |  | public function adminMenuStyles() |
  | 359 |  | { |
  | 360 |  | if (current\_user\_can('editor') || current\_user\_can('administrator')) { |
  | 361 |  | echo "<style> |
  |  | 27 | class Free\_Comments\_For\_Wordpress\_Vuukle\_Admin { |
  |  | 28 |  |
  |  | 29 | /\*\* |
  |  | 30 | \* The ID of this plugin. |
  |  | 31 | \* |
  |  | 32 | \* @since  1.0.0 |
  |  | 33 | \* @access private |
  |  | 34 | \* @var    string $plugin\_name The ID of this plugin. |
  |  | 35 | \*/ |
  |  | 36 | private $plugin\_name; |
  |  | 37 |  |
  |  | 38 | /\*\* |
  |  | 39 | \* The version of this plugin. |
  |  | 40 | \* |
  |  | 41 | \* @since  1.0.0 |
  |  | 42 | \* @access private |
  |  | 43 | \* @var    string $version The current version of this plugin. |
  |  | 44 | \*/ |
  |  | 45 | private $version; |
  |  | 46 |  |
  |  | 47 | /\*\* |
  |  | 48 | \* Initialize the class and set its properties. |
  |  | 49 | \* |
  |  | 50 | \* @param   string  $plugin\_name  The name of this plugin. |
  |  | 51 | \* @param   string  $version      The version of this plugin. |
  |  | 52 | \*/ |
  |  | 53 | public function \_\_construct( $plugin\_name, $version ) { |
  |  | 54 |  |
  |  | 55 | $this->plugin\_name       = $plugin\_name; |
  |  | 56 | $this->version           = $version; |
  |  | 57 | $this->settings\_url      = 'options-general.php?page=' . dirname( plugin\_basename( $this->plugin\_name ) ) . '/' . basename( $this->plugin\_name ); |
  |  | 58 | $this->settings\_name     = 'Vuukle'; |
  |  | 59 | $this->settings          = get\_option( $this->settings\_name ); |
  |  | 60 | $comments\_status         = get\_option( 'default\_comment\_status', false ); |
  |  | 61 | $this->settings\_defaults = array( |
  |  | 62 | 'AppId'                       => '', |
  |  | 63 | 'sso'                         => 'false', |
  |  | 64 | 'div\_id'                      => '', |
  |  | 65 | 'div\_class'                   => '', |
  |  | 66 | 'div\_id\_powerbar'             => '', |
  |  | 67 | 'div\_id\_emotes'               => '', |
  |  | 68 | 'div\_class\_powerbar'          => '', |
  |  | 69 | 'div\_class\_powerbar2'         => '', |
  |  | 70 | 'div\_class\_emotes'            => '', |
  |  | 71 | 'lang'                        => '', |
  |  | 72 | 'emote'                       => 'true', |
  |  | 73 | 'save\_ads\_txt'                => isset( $this->settings['save\_ads\_txt'] ) ? $this->settings['save\_ads\_txt'] : 'false', |
  |  | 74 | 'save\_comments'               => '0', |
  |  | 75 | 'enabled\_comments'            => 'true', |
  |  | 76 | 'amount\_comments'             => 1000, |
  |  | 77 | 'embed\_comments'              => $comments\_status == "open" ? '1' : '2', |
  |  | 78 | 'embed\_emotes'                => '0', |
  |  | 79 | 'mobile\_type'                 => 'vertical', |
  |  | 80 | 'desktop\_type'                => 'vertical', |
  |  | 81 | 'embed\_powerbar'              => '0', |
  |  | 82 | 'embed\_powerbar\_vertical'     => '0', |
  |  | 83 | 'div\_class\_powerbar\_vertical' => '0', |
  |  | 84 | 'email\_for\_export\_comments'   => 'support@vuukle.com', |
  |  | 85 | 'start\_date\_comments'         => gmdate( 'Y-m-d', strtotime( '-30 days' ) ), |
  |  | 86 | 'end\_date\_comments'           => gmdate( 'Y-m-d' ), |
  |  | 87 | 'non\_article\_pages'           => 'off', |
  |  | 88 | // 'vuukle\_user\_linkedin\_url'    => '', |
  |  | 89 | // 'vuukle\_user\_twitter\_url'     => '', |
  |  | 90 | 'text'                        => array( |
  |  | 91 | 'common'      => array( |
  |  | 92 | //Name for user to enter |
  |  | 93 | 'name'         => 'Name', |
  |  | 94 | //Email for user to enter |
  |  | 95 | 'email'        => 'Email', |
  |  | 96 | //Place holder when user is not logged in |
  |  | 97 | 'me'           => 'Me', |
  |  | 98 | //Message as placeholder for user to write comment |
  |  | 99 | 'writeComment' => 'Write a comment', |
  |  | 100 | //Message to show when user attempts to login without entering name |
  |  | 101 | 'blankName'    => 'Name can not be blank', |
  |  | 102 | //Message to show when user attempts to login without entering email |
  |  | 103 | 'blankEmail'   => 'Email can not be blank', |
  |  | 104 | //Message to show when user attempts to comment without entering text |
  |  | 105 | 'blankComment' => 'Comment can not be blank', |
  |  | 106 | //Message to show when user write invalid email |
  |  | 107 | 'invalidEmail' => 'Invalid email, please try again.', |
  |  | 108 | //Message to show when user write invalid name |
  |  | 109 | 'invalidName'  => 'Name should not contain numbers, www., or special characters. Thank You.', |
  |  | 110 | //Message to show when user doesn't agree to terms and conditions |
  |  | 111 | 'checkTerms'   => 'Please Check the T&C box to post comments', |
  |  | 112 | ), |
  |  | 113 | 'messages'    => array( |
  |  | 114 | //Message to show when user write comment longer than the configured man comment length |
  |  | 115 | 'charlimits'              => 'The moderator has set a character limit up to', |
  |  | 116 | //Message to show when user tries to Up/Down votes more than once |
  |  | 117 | 'alreadyVoted'            => 'You have already Voted.', |
  |  | 118 | //Message to show when user tries to flag comment more than once |
  |  | 119 | 'alreadyReported'         => 'You have already reported this comment to moderator.', |
  |  | 120 | //Message to show when comments are closed |
  |  | 121 | 'commentsClosed'          => 'Comments are now closed.', |
  |  | 122 | //Message to show when user when the moderator closes the comments |
  |  | 123 | 'commentsClosedModerator' => 'Comments have been closed by the site moderator.', |
  |  | 124 | //Placeholder for writing comment |
  |  | 125 | 'writeComment'            => 'Please write a comment.', |
  |  | 126 | //Message to show when user tries to send the samer comment again |
  |  | 127 | 'alreadySubmitted'        => 'Your comment has been already submitted for this article.', |
  |  | 128 | //Message to show when user tries to comment without signing in |
  |  | 129 | 'loginFirst'              => 'Please enter your Name and Email or login to comment.', |
  |  | 130 | //Message to show when user is needed to sign in |
  |  | 131 | 'loginTry'                => 'Please login and try again.', |
  |  | 132 | //Message to show when user tries to vote without signing in |
  |  | 133 | 'loginToVote'             => 'Please sign in to vote.', |
  |  | 134 | //Message to show when user flags a comment |
  |  | 135 | 'flaggedMessage'          => 'Thanks, the moderator will be notified', |
  |  | 136 | //Message to show when user tries to flag without signing in |
  |  | 137 | 'loginToFlag'             => 'Please sign in to flag a comment.', |
  |  | 138 | //Message to show when error happens in submitting comment |
  |  | 139 | 'errorSubmitting'         => 'There was an error while saving your comment, please refresh the page and try again', |
  |  | 140 | //Message to show when user tries to login with invalid data |
  |  | 141 | 'invalidLogin'            => 'Invalid login, please log in again', |
  |  | 142 | //General error, contact us |
  |  | 143 | 'errorContactVuukle'      => 'error - please notify us at support@vuukle.com', |
  |  | 144 | //Message to show when user is flagged as spammer, and blocked from commenting |
  |  | 145 | 'spammerComment'          => 'Your comment is under moderation', |
  |  | 146 | //Message to show when user tries to comment with any words, like aaaaa etc... |
  |  | 147 | 'nonSenseComment'         => 'Please enter a more descriptive comment.', |
  |  | 148 | //Message to show when user comments and the moderation is on |
  |  | 149 | 'moderationMessage'       => 'Your comment is under moderation and will be approved by the site moderator. Thank you for your patience.', |
  |  | 150 | ), |
  |  | 151 | //These config deal with showing date in the comments, ie: 5 minutes ago, 2 days ago, etc... |
  |  | 152 | 'timeAgo'     => array( |
  |  | 153 | 'suffixAgo'     => 'ago', |
  |  | 154 | 'suffixFromNow' => 'from now', |
  |  | 155 | 'seconds'       => 'less than a minute', |
  |  | 156 | 'minute'        => 'about a minute', |
  |  | 157 | 'minutes'       => '%d minutes', |
  |  | 158 | 'hour'          => 'about an hour', |
  |  | 159 | 'hours'         => 'about %d hours', |
  |  | 160 | 'day'           => 'a day', |
  |  | 161 | 'days'          => '%d days', |
  |  | 162 | 'month'         => 'about a month', |
  |  | 163 | 'months'        => '%d months', |
  |  | 164 | 'year'          => 'about a year', |
  |  | 165 | 'years'         => '%d years', |
  |  | 166 | ), |
  |  | 167 | //Tooltips for social logins |
  |  | 168 | 'login'       => array( |
  |  | 169 | 'google'   => 'Login using Google', |
  |  | 170 | 'facebook' => 'Login using Facebook', |
  |  | 171 | 'twitter'  => 'Login using Twitter', |
  |  | 172 | 'linkedin' => 'Login using Linkedin', |
  |  | 173 | ), |
  |  | 174 | 'commentText' => array( |
  |  | 175 | //Text at header of comment section when there is no comments |
  |  | 176 | 'when0' => 'Leave a comment', |
  |  | 177 | //Text at header of comment section when there is 1 comment |
  |  | 178 | 'when1' => 'comment', |
  |  | 179 | //Text at header of comment section when there is more than comment |
  |  | 180 | 'whenX' => 'comments', |
  |  | 181 | ), |
  |  | 182 | //Rating section strings to show to user, includes ( Average rating 4.5 start from 123 users, etc... ) |
  |  | 183 | 'rating'      => array( |
  |  | 184 | 'header'     => 'Give your rating:', |
  |  | 185 | 'average'    => 'Average', |
  |  | 186 | 'starsFrom'  => 'start from', |
  |  | 187 | 'ratings'    => 'ratings', |
  |  | 188 | 'yourRating' => 'Your rating', |
  |  | 189 | 'stars'      => 'stars', |
  |  | 190 | ), |
  |  | 191 | //Texts for the buttons we have |
  |  | 192 | 'buttons'     => array( |
  |  | 193 | 'loadMore' => 'Load more', |
  |  | 194 | 'singin'   => 'Sign in', |
  |  | 195 | 'post'     => 'Post', |
  |  | 196 | ), |
  |  | 197 | ), |
  |  | 198 | 'priority'                    => 300, |
  |  | 199 | 'share'                       => '1', |
  |  | 200 | 'enable\_h\_v'                  => 'no', |
  |  | 201 | 'share\_position'              => '1', |
  |  | 202 | 'share\_position2'             => '1', |
  |  | 203 | 'checkboxTextEnabled'         => false, |
  |  | 204 | 'share\_type'                  => 'horizontal', |
  |  | 205 | 'share\_type\_vertical'         => 'vertical', |
  |  | 206 | 'mobile\_type\_horizontal'      => 'horizontal', |
  |  | 207 | 'desktop\_type\_horizontal'     => 'horizontal', |
  |  | 208 | 'emote\_widget\_width'          => '600', |
  |  | 209 | 'post\_exceptions'             => '', |
  |  | 210 | 'category\_exceptions'         => '', |
  |  | 211 | 'post\_type\_exceptions'        => '', |
  |  | 212 | 'post\_type\_by\_url\_exceptions' => '', |
  |  | 213 | 'hide\_chat'                   => 'true', |
  |  | 214 | ); |
  |  | 215 | } |
  |  | 216 |  |
  |  | 217 | /\*\* |
  |  | 218 | \* Quick register API |
  |  | 219 | \*/ |
  |  | 220 | public function try\_quick\_register() { |
  |  | 221 | $is\_our = ! empty( $\_GET['page'] ) && $\_GET['page'] == 'free-comments-for-wordpress-vuukle'; |
  |  | 222 | if ( $is\_our ) { |
  |  | 223 | if ( empty( $this->settings['AppId'] ) ) { |
  |  | 224 | $this->quickRegister( true ); |
  |  | 225 | $this->settings = get\_option( $this->settings\_name ); |
  |  | 226 | } |
  |  | 227 | } |
  |  | 228 | } |
  |  | 229 |  |
  |  | 230 | /\*\* |
  |  | 231 | \* Start session. Mostly for organizing proper error messaging |
  |  | 232 | \* |
  |  | 233 | \* @since  1.0.0 |
  |  | 234 | \*/ |
  |  | 235 | public function start\_session() { |
  |  | 236 | if ( empty( session\_id() ) ) { |
  |  | 237 | session\_start(); |
  |  | 238 | } |
  |  | 239 | } |
  |  | 240 |  |
  |  | 241 | /\*\* |
  |  | 242 | \* Check plugin using date |
  |  | 243 | \* |
  |  | 244 | \* @since  1.0.0 |
  |  | 245 | \*/ |
  |  | 246 | public function check\_one\_month\_passed() { |
  |  | 247 | if ( get\_option( 'hide\_vuukle\_admin\_notice' ) !== '1' ) { |
  |  | 248 | $date\_activation = get\_option( 'Activated\_Vuukle\_Plugin\_Date' ); |
  |  | 249 | $date\_activation = strtotime( '+4 weeks', strtotime( $date\_activation ) ); |
  |  | 250 | $current\_date    = strtotime( gmdate( 'Y-m-d H:i:s' ) ); |
  |  | 251 | if ( $current\_date >= $date\_activation ) { |
  |  | 252 | add\_action( 'admin\_notices', array( $this, 'one\_month\_notice' ) ); |
  |  | 253 | } |
  |  | 254 | } |
  |  | 255 | } |
  |  | 256 |  |
  |  | 257 | /\*\* |
  |  | 258 | \* Register the stylesheets for the admin area. |
  |  | 259 | \* |
  |  | 260 | \* @return void |
  |  | 261 | \* @since  1.0.0 |
  |  | 262 | \*/ |
  |  | 263 | public function enqueueStyles() { |
  |  | 264 |  |
  |  | 265 | /\*\* |
  |  | 266 | \* This function is provided for demonstration purposes only. |
  |  | 267 | \* |
  |  | 268 | \* An instance of this class should be passed to the run() function |
  |  | 269 | \* defined in Free\_Comments\_For\_Wordpress\_Vuukle\_Loader as all of the hooks are defined |
  |  | 270 | \* in that particular class. |
  |  | 271 | \* |
  |  | 272 | \* The Free\_Comments\_For\_Wordpress\_Vuukle\_Loader will then create the relationship |
  |  | 273 | \* between the defined hooks and the functions defined in this |
  |  | 274 | \* class. |
  |  | 275 | \*/ |
  |  | 276 | if ( current\_user\_can( 'editor' ) || current\_user\_can( 'administrator' ) ) { |
  |  | 277 | wp\_enqueue\_style( 'vuukle\_admin\_font\_awesome', 'https://use.fontawesome.com/releases/v5.2.0/css/all.css', array(), $this->version, 'all' ); |
  |  | 278 | wp\_enqueue\_style( $this->plugin\_name, plugin\_dir\_url( \_\_FILE\_\_ ) . 'css/free-comments-for-wordpress-vuukle-admin.css', array(), $this->version, 'all' ); |
  |  | 279 | } |
  |  | 280 | } |
  |  | 281 |  |
  |  | 282 | /\*\* |
  |  | 283 | \* Register the JavaScript for the admin area. |
  |  | 284 | \* |
  |  | 285 | \* @return void |
  |  | 286 | \* @since  1.0.0 |
  |  | 287 | \*/ |
  |  | 288 | public function enqueueScripts() { |
  |  | 289 |  |
  |  | 290 | /\*\* |
  |  | 291 | \* This function is provided for demonstration purposes only. |
  |  | 292 | \* |
  |  | 293 | \* An instance of this class should be passed to the run() function |
  |  | 294 | \* defined in Free\_Comments\_For\_Wordpress\_Vuukle\_Loader as all of the hooks are defined |
  |  | 295 | \* in that particular class. |
  |  | 296 | \* |
  |  | 297 | \* The Free\_Comments\_For\_Wordpress\_Vuukle\_Loader will then create the relationship |
  |  | 298 | \* between the defined hooks and the functions defined in this |
  |  | 299 | \* class. |
  |  | 300 | \*/ |
  |  | 301 | if ( current\_user\_can( 'editor' ) || current\_user\_can( 'administrator' ) ) { |
  |  | 302 | wp\_enqueue\_script( 'jquery' ); |
  |  | 303 | wp\_enqueue\_script( 'jquery-ui-core' ); |
  |  | 304 | wp\_enqueue\_script( 'jquery-ui-dialog' ); |
  |  | 305 | wp\_enqueue\_script( 'jquery-ui-sortable' ); |
  |  | 306 | wp\_enqueue\_script( $this->plugin\_name . '-sortable', plugin\_dir\_url( \_\_FILE\_\_ ) . 'js/sortable.js', $this->version, false ); |
  |  | 307 | wp\_enqueue\_script( $this->plugin\_name, plugin\_dir\_url( \_\_FILE\_\_ ) . 'js/free-comments-for-wordpress-vuukle-admin.js', $this->version, false ); // phpcs:ignore |
  |  | 308 | wp\_localize\_script( $this->plugin\_name, 'fcfwv\_admin\_vars', [ 'ajax\_url' => admin\_url( 'admin-ajax.php' ), 'nonce' => wp\_create\_nonce() ] ); |
  |  | 309 | } |
  |  | 310 | } |
  |  | 311 |  |
  |  | 312 | /\*\* |
  |  | 313 | \* This function creates a page in the admin dashboard. |
  |  | 314 | \* |
  |  | 315 | \* @return void |
  |  | 316 | \* @since  1.0.0. |
  |  | 317 | \*/ |
  |  | 318 | public function adminMenu() { |
  |  | 319 | add\_submenu\_page( 'options-general.php', 'Vuukle &rsaquo; Settings', 'Vuukle', 'manage\_options', $this->plugin\_name, array( $this, 'adminPageVuukle' ) ); |
  |  | 320 | add\_menu\_page( 'Vuukle Settings', 'Vuukle', 'manage\_options', $this->plugin\_name, array( $this, 'adminPageVuukle' ), plugins\_url( 'free-comments-for-wordpress-vuukle/admin/images/icon@2.png' ) ); |
  |  | 321 | } |
  |  | 322 |  |
  |  | 323 | /\*\* |
  |  | 324 | \* This function adds styles to the menu. |
  |  | 325 | \* |
  |  | 326 | \* @return void |
  |  | 327 | \* @since  1.0.0. |
  |  | 328 | \*/ |
  |  | 329 | public function adminMenuStyles() { |
  |  | 330 | if ( current\_user\_can( 'editor' ) || current\_user\_can( 'administrator' ) ) { |
  |  | 331 | echo "<style> |
  | 362 | 332 |  |
  | 363 | 333 |  |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/class-free-comments-for-wordpress-vuukle-admin.php?rev=2533938#L368) | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/class-free-comments-for-wordpress-vuukle-admin.php?rev=2553337#L338) |  |
  | 368 | 338 | } |
  | 369 | 339 | <style>"; |
  | 370 |  | } |
  | 371 |  | } |
  | 372 |  |  |
  | 373 |  | /\*\* |
  | 374 |  | \* This function  create an admin page. |
  | 375 |  | \* |
  | 376 |  | \* @since  1.0.0. |
  | 377 |  | \* @return void |
  | 378 |  | \*/ |
  | 379 |  | public function adminPageVuukle() |
  | 380 |  | { |
  | 381 |  | include\_once 'partials/free-comments-for-wordpress-vuukle-admin-display.php'; |
  | 382 |  | } |
  | 383 |  |  |
  | 384 |  | /\*\* |
  | 385 |  | \* This function ensures quick registration. |
  | 386 |  | \* |
  | 387 |  | \* @param string $live Is there live or not |
  | 388 |  | \* |
  | 389 |  | \* @return string |
  | 390 |  | \*/ |
  | 391 |  | public function quickRegister($live = false) |
  | 392 |  | { |
  | 393 |  | $site\_url = get\_site\_url(); |
  | 394 |  | $args = array( |
  | 395 |  | 'name'     => str\_replace(array('www.', 'http://', 'https://'), '', $site\_url), |
  | 396 |  | 'host'     => str\_replace(array('www.', 'http://', 'https://'), '', $site\_url), |
  | 397 |  | 'avatar'   => '', |
  | 398 |  | 'email'    => get\_option('admin\_email'), |
  | 399 |  | 'password' => rand(0, 1000000), |
  | 400 |  | ); |
  | 401 |  | $args = json\_encode($args); |
  | 402 |  |  |
  | 403 |  |  |
  | 404 |  | $url = 'https://api.vuukle.com/api/v1/Publishers/registerWP'; |
  | 405 |  | $ch = curl\_init(); |
  | 406 |  | curl\_setopt\_array( |
  | 407 |  | $ch, |
  | 408 |  | array( |
  | 409 |  | CURLOPT\_URL => $url, |
  | 410 |  | CURLOPT\_RETURNTRANSFER => true, |
  | 411 |  | CURLOPT\_ENCODING => "", |
  | 412 |  | CURLOPT\_MAXREDIRS => 10, |
  | 413 |  | CURLOPT\_TIMEOUT => 30, |
  | 414 |  | CURLOPT\_SSL\_VERIFYPEER => false, |
  | 415 |  | CURLOPT\_HTTP\_VERSION => CURL\_HTTP\_VERSION\_1\_1, |
  | 416 |  | CURLOPT\_CUSTOMREQUEST => "POST", |
  | 417 |  | CURLOPT\_POSTFIELDS => $args, |
  | 418 |  | CURLOPT\_HTTPHEADER => array( |
  | 419 |  | "Content-Type: application/json", |
  | 420 |  | 'Content-Length: ' . strlen($args) |
  | 421 |  | ), |
  | 422 |  | ) |
  | 423 |  | ); |
  | 424 |  |  |
  | 425 |  | $response = curl\_exec($ch); |
  | 426 |  | $err = curl\_error($ch); |
  | 427 |  |  |
  | 428 |  | curl\_close($ch); |
  | 429 |  |  |
  | 430 |  | if ($err) { |
  | 431 |  | //            echo "cURL Error #:" . $err; |
  | 432 |  | } else { |
  | 433 |  | $output = json\_decode($response, true); |
  | 434 |  | } |
  | 435 |  |  |
  | 436 |  | $responseApiKey = $output['data']['apiKey']; |
  | 437 |  |  |
  | 438 |  | if ($responseApiKey) { |
  | 439 |  |  |
  | 440 |  | if (isset($responseApiKey)) { |
  | 441 |  | $settings          = get\_option($this->settings\_name); |
  | 442 |  | $settings['AppId'] = $responseApiKey; |
  | 443 |  | update\_option($this->settings\_name, $settings); |
  | 444 |  | $this->settings = get\_option($this->settings\_name); |
  | 445 |  | } |
  | 446 |  | } |
  | 447 |  |  |
  | 448 |  | if (empty($responseApiKey)) { |
  | 449 |  | $site\_url = get\_site\_url(); |
  | 450 |  | $url = 'https://api.vuukle.com/api/v1/WP/alertSupport?subjectLine=' . str\_replace(array('www.', 'http://', 'https://'), '', $site\_url); |
  | 451 |  | // execute curl |
  | 452 |  | $ch = curl\_init(); // phpcs:ignore WordPress.WP.AlternativeFunctions |
  | 453 |  | curl\_setopt\_array( |
  | 454 |  | $ch, |
  | 455 |  | array( |
  | 456 |  | CURLOPT\_URL => $url, |
  | 457 |  | CURLOPT\_RETURNTRANSFER => true, |
  | 458 |  | CURLOPT\_ENCODING => "", |
  | 459 |  | CURLOPT\_MAXREDIRS => 10, |
  | 460 |  | CURLOPT\_TIMEOUT => 30, |
  | 461 |  | CURLOPT\_SSL\_VERIFYPEER => false, |
  | 462 |  | CURLOPT\_HTTP\_VERSION => CURL\_HTTP\_VERSION\_1\_1, |
  | 463 |  | CURLOPT\_CUSTOMREQUEST => "GET", |
  | 464 |  | CURLOPT\_HTTPHEADER => array( |
  | 465 |  | "Content-Type: application/json" |
  | 466 |  | ), |
  | 467 |  | ) |
  | 468 |  | ); |
  | 469 |  | $output = curl\_exec($ch); // phpcs:ignore WordPress.WP.AlternativeFunctions |
  | 470 |  | $output = json\_decode($output, true); // phpcs:ignore WordPress.WP.AlternativeFunctions |
  | 471 |  | curl\_close($ch); // phpcs:ignore WordPress.WP.AlternativeFunctions |
  | 472 |  | } |
  | 473 |  |  |
  | 474 |  | if (!$live) { |
  | 475 |  | echo esc\_html($responseApiKey); |
  | 476 |  | wp\_die(); |
  | 477 |  | } |
  | 478 |  | } |
  | 479 |  |  |
  | 480 |  | /\*\* |
  | 481 |  | \* This function for change color. |
  | 482 |  | \* |
  | 483 |  | \* @since  1.0.0. |
  | 484 |  | \* @return void |
  | 485 |  | \*/ |
  | 486 |  | public function myColorPicker() |
  | 487 |  | { |
  | 488 |  |  |
  | 489 |  | wp\_enqueue\_script('iris'); |
  | 490 |  | } |
  | 491 |  |  |
  | 492 |  | /\*\* |
  | 493 |  | \* For enabling. |
  | 494 |  | \* |
  | 495 |  | \* @since  1.0.0. |
  | 496 |  | \* @return void |
  | 497 |  | \*/ |
  | 498 |  | public function vuukleEnableFunction() |
  | 499 |  | { |
  | 500 |  |  |
  | 501 |  | if (isset($\_POST['\_wpnonce']) && wp\_verify\_nonce(sanitize\_key($\_POST['\_wpnonce']))) { // Input var okay |
  | 502 |  | $post = $\_POST; // Input var okay |
  | 503 |  | } |
  | 504 |  | $option = get\_option('Vuukle'); |
  | 505 |  | if ('1' === $post['emote']) { |
  | 506 |  | $option['emote'] = 'true'; |
  | 507 |  | } else { |
  | 508 |  | $option['emote'] = 'false'; |
  | 509 |  | } |
  | 510 |  | if ('1' === $post['share']) { |
  | 511 |  | $option['share'] = '1'; |
  | 512 |  | } else { |
  | 513 |  | $option['share'] = '0'; |
  | 514 |  | } |
  | 515 |  | if (!empty($\_POST['enable\_h\_v'])) { |
  | 516 |  | if ('no' === $post['enable\_h\_v']) { |
  | 517 |  | $option['enable\_h\_v'] = 'no'; |
  | 518 |  | } else { |
  | 519 |  | $option['enable\_h\_v'] = 'yes'; |
  | 520 |  | } |
  | 521 |  | } |
  | 522 |  |  |
  | 523 |  | if ('1' === $post['enabled\_comments']) { |
  | 524 |  | $option['enabled\_comments'] = 'true'; |
  | 525 |  | } else { |
  | 526 |  | $option['enabled\_comments'] = 'false'; |
  | 527 |  | } |
  | 528 |  |  |
  | 529 |  |  |
  | 530 |  | update\_option('Vuukle', $option); |
  | 531 |  |  |
  | 532 |  | wp\_safe\_redirect(admin\_url('plugins.php')); |
  | 533 |  | exit; |
  | 534 |  | } |
  | 535 |  |  |
  | 536 |  | /\*\* |
  | 537 |  | \* For deactivation. |
  | 538 |  | \* |
  | 539 |  | \* @since  1.0.0. |
  | 540 |  | \* @return void |
  | 541 |  | \*/ |
  | 542 |  | public function vuukleDeactivateFunction() |
  | 543 |  | { |
  | 544 |  | if (isset($\_POST['\_wpnonce']) && wp\_verify\_nonce(sanitize\_key($\_POST['\_wpnonce']))) { // Input var okay |
  | 545 |  | $post = $\_POST; // Input var okay |
  | 546 |  | } |
  | 547 |  |  |
  | 548 |  | if ('confirm' === $post['vuukle\_deactivate\_function']) { |
  | 549 |  | deactivate\_plugins(array($this->plugin\_name . '/' . $this->plugin\_name . '.php')); |
  | 550 |  | delete\_option('Activated\_Vuukle\_Plugin\_Date'); |
  | 551 |  | delete\_option('hide\_vuukle\_admin\_notice'); |
  | 552 |  | if (!empty($post['answer-deactivate-vuukle'])) { |
  | 553 |  | $vuukle\_subject\_message = 'Deactivate Vuukle plugin on the site ' . site\_url(); |
  | 554 |  | $vuukle\_message         = '<strong>Type answer:</strong> ' . stripslashes($post['answer-deactivate-vuukle']); |
  | 555 |  | if (!empty($post['other-answer-deactivate-vuukle']) && 'Other' === $post['answer-deactivate-vuukle']) { |
  | 556 |  | $vuukle\_message .= '<br><strong>Text answer:</strong> ' . stripslashes($post['other-answer-deactivate-vuukle']); |
  | 557 |  | } |
  | 558 |  | $headers = array( |
  | 559 |  | 'From: ' . get\_option('blogname') . ' <' . get\_option('admin\_email') . '>', |
  | 560 |  | 'content-type: text/html', |
  | 561 |  | ); |
  | 562 |  | wp\_mail('support@vuukle.com', $vuukle\_subject\_message, $vuukle\_message, $headers); |
  | 563 |  | } |
  | 564 |  | } |
  | 565 |  |  |
  | 566 |  | wp\_safe\_redirect(admin\_url('plugins.php')); |
  | 567 |  | exit; |
  | 568 |  | } |
  | 569 |  |  |
  | 570 |  | /\*\* |
  | 571 |  | \* Creating activation modal. |
  | 572 |  | \* |
  | 573 |  | \* @since  1.0.0. |
  | 574 |  | \* @return void |
  | 575 |  | \*/ |
  | 576 |  | public function activationModal() |
  | 577 |  | { |
  | 578 |  |  |
  | 579 |  | if (is\_admin() && '1' === get\_option('Activated\_Vuukle\_Plugin')) { |
  | 580 |  | delete\_option('Activated\_Vuukle\_Plugin'); |
  | 581 |  | include VUUKLE\_INCLUDES\_PATH . '/free-comments-for-wordpress-vuukle-activate-modal.php'; |
  | 582 |  | } |
  | 583 |  | } |
  | 584 |  |  |
  | 585 |  | /\*\* |
  | 586 |  | \* Creating deactivation modal. |
  | 587 |  | \* |
  | 588 |  | \* @since  1.0.0. |
  | 589 |  | \* @return void |
  | 590 |  | \*/ |
  | 591 |  | public function deactivationModal() |
  | 592 |  | { |
  | 593 |  |  |
  | 594 |  | if (is\_admin()) { |
  | 595 |  | $screen = get\_current\_screen(); |
  | 596 |  | if ('plugins' === $screen->base) { |
  | 597 |  | include VUUKLE\_INCLUDES\_PATH  . '/free-comments-for-wordpress-vuukle-deactivate-modal.php'; |
  | 598 |  | } |
  | 599 |  | } |
  | 600 |  | } |
  | 601 |  |  |
  | 602 |  | /\*\* |
  | 603 |  | \* For settings JS. |
  | 604 |  | \* |
  | 605 |  | \* @since  1.0.0. |
  | 606 |  | \* @return void |
  | 607 |  | \*/ |
  | 608 |  | public function settingsJs() |
  | 609 |  | { |
  | 610 |  |  |
  | 611 |  | wp\_enqueue\_script('settings', plugins\_url('js/settings.js', \_\_FILE\_\_)); |
  | 612 |  | } |
  | 613 |  |  |
  | 614 |  | /\*\* |
  | 615 |  | \* For dashicons. |
  | 616 |  | \* |
  | 617 |  | \* @since  1.0.0. |
  | 618 |  | \* @return void |
  | 619 |  | \*/ |
  | 620 |  | public function jkLoadDashicons() |
  | 621 |  | { |
  | 622 |  | wp\_enqueue\_style('dashicons'); |
  | 623 |  | } |
  | 624 |  |  |
  | 625 |  | /\*\* |
  | 626 |  | \* This function hides admin notice. |
  | 627 |  | \* |
  | 628 |  | \* @since  1.0.0. |
  | 629 |  | \* @return void |
  | 630 |  | \*/ |
  | 631 |  | public function hideVuukleVdminVotice() |
  | 632 |  | { |
  | 633 |  |  |
  | 634 |  | add\_option('hideVuukleVdminVotice', '1'); |
  | 635 |  | } |
  | 636 |  |  |
  | 637 |  | /\*\* |
  | 638 |  | \* This function creates admin notice. |
  | 639 |  | \* |
  | 640 |  | \* @since  1.0.0. |
  | 641 |  | \* @return void |
  | 642 |  | \*/ |
  | 643 |  | public function vuukleAdminNotice() |
  | 644 |  | { |
  | 645 |  | ?> |
  |  | 340 | } |
  |  | 341 | } |
  |  | 342 |  |
  |  | 343 | /\*\* |
  |  | 344 | \* This function  create an admin page. |
  |  | 345 | \* |
  |  | 346 | \* @return void |
  |  | 347 | \* @since  1.0.0. |
  |  | 348 | \*/ |
  |  | 349 | public function adminPageVuukle() { |
  |  | 350 | // Prepare some data |
  |  | 351 | $vuukle\_tab           = ! empty( $\_GET['vuukle\_tab'] ) ? sanitize\_text\_field( $\_GET['vuukle\_tab'] ) : 'tab1'; |
  |  | 352 | $url                  = esc\_url\_raw( remove\_query\_arg( array( 'vuukle\_tab' ) ) ); |
  |  | 353 | $this->settings       = ! is\_array( $this->settings ) ? $this->settings\_defaults : array\_replace\_recursive( $this->settings\_defaults, $this->settings ); |
  |  | 354 | $wp\_content\_dir\_array = explode( '/', WP\_CONTENT\_DIR ); |
  |  | 355 | $wp\_content\_dir       = $wp\_content\_dir\_array[ count( $wp\_content\_dir\_array ) - 1 ]; |
  |  | 356 | $root\_path            = str\_replace( $wp\_content\_dir, '', WP\_CONTENT\_DIR ); |
  |  | 357 | include\_once 'partials/free-comments-for-wordpress-vuukle-admin-display.php'; |
  |  | 358 | } |
  |  | 359 |  |
  |  | 360 | /\*\* |
  |  | 361 | \* Get error/success message value |
  |  | 362 | \* |
  |  | 363 | \* @param $type |
  |  | 364 | \* |
  |  | 365 | \* @return mixed |
  |  | 366 | \* @since  1.0.0. |
  |  | 367 | \*/ |
  |  | 368 | public function get\_message( $type ) { |
  |  | 369 | return $\_SESSION['fcfwv\_admin'][ $type ]; |
  |  | 370 | } |
  |  | 371 |  |
  |  | 372 | /\*\* |
  |  | 373 | \* Get error/success message existence |
  |  | 374 | \* |
  |  | 375 | \* @param $type |
  |  | 376 | \* |
  |  | 377 | \* @return bool |
  |  | 378 | \* @since  1.0.0. |
  |  | 379 | \*/ |
  |  | 380 | public function check\_message\_existence( $type ) { |
  |  | 381 | return ! empty( $\_SESSION['fcfwv\_admin'] ) && ! empty( $\_SESSION['fcfwv\_admin'][ $type ] ); |
  |  | 382 | } |
  |  | 383 |  |
  |  | 384 | /\*\* |
  |  | 385 | \* Remove message from sessions |
  |  | 386 | \* |
  |  | 387 | \* @since  1.0.0. |
  |  | 388 | \*/ |
  |  | 389 | public function unset\_sessions() { |
  |  | 390 | unset( $\_SESSION['fcfwv\_admin'] ); |
  |  | 391 | } |
  |  | 392 |  |
  |  | 393 | /\*\* |
  |  | 394 | \* Redirect upon result (success, error) |
  |  | 395 | \* |
  |  | 396 | \* @param $parsed\_url |
  |  | 397 | \* @param $key |
  |  | 398 | \* @param $value |
  |  | 399 | \* @param $query\_arr |
  |  | 400 | \* |
  |  | 401 | \* @since 4.0 |
  |  | 402 | \*/ |
  |  | 403 | public function redirect\_upon\_result( $parsed\_url, $key, $value, $query\_arr ) { |
  |  | 404 | if ( ! empty( $key ) && ! empty( $value ) ) { |
  |  | 405 | if ( empty( $\_SESSION['fcfwv\_admin'] ) ) { |
  |  | 406 | $\_SESSION['fcfwv\_admin'] = []; |
  |  | 407 | } |
  |  | 408 | $\_SESSION['fcfwv\_admin'][ $key ] = $value; |
  |  | 409 | } |
  |  | 410 | $query\_string = http\_build\_query( $query\_arr ); |
  |  | 411 | $query\_string = $query\_string != '' ? '?' . $query\_string : ''; |
  |  | 412 | $url          = $parsed\_url['scheme'] . '://' . $parsed\_url['host'] . $parsed\_url['path'] . $query\_string; |
  |  | 413 | wp\_safe\_redirect( $url ); |
  |  | 414 | exit(); |
  |  | 415 | } |
  |  | 416 |  |
  |  | 417 | /\*\* |
  |  | 418 | \* This function ensures quick registration. |
  |  | 419 | \* |
  |  | 420 | \* @param   bool  $live  Is there live or not |
  |  | 421 | \*/ |
  |  | 422 | public function quickRegister( $live = false ) { |
  |  | 423 | $site\_url = get\_site\_url(); |
  |  | 424 | $args     = array( |
  |  | 425 | 'name'     => str\_replace( array( 'www.', 'http://', 'https://' ), '', $site\_url ), |
  |  | 426 | 'host'     => str\_replace( array( 'www.', 'http://', 'https://' ), '', $site\_url ), |
  |  | 427 | 'avatar'   => '', |
  |  | 428 | 'email'    => get\_option( 'admin\_email' ), |
  |  | 429 | 'password' => rand( 0, 1000000 ), |
  |  | 430 | ); |
  |  | 431 | $body     = json\_encode( $args ); |
  |  | 432 | $url      = 'https://api.vuukle.com/api/v1/Publishers/registerWP'; |
  |  | 433 | $response = wp\_remote\_post( $url, array( |
  |  | 434 | 'timeout' => 30, |
  |  | 435 | 'headers' => array( |
  |  | 436 | 'Content-Type'   => 'application/json', |
  |  | 437 | 'Content-Length' => strlen( $body ) |
  |  | 438 | ), |
  |  | 439 | 'body'    => $body, // request parameters in an array |
  |  | 440 | ) ); |
  |  | 441 | if ( empty( $response ) || $response instanceof WP\_Error ) { |
  |  | 442 | // Error |
  |  | 443 | //TODO log error |
  |  | 444 | } |
  |  | 445 | $body\_received\_json = wp\_remote\_retrieve\_body( $response ); |
  |  | 446 | if ( empty( $body\_received\_json ) ) { |
  |  | 447 | // Error |
  |  | 448 | //TODO log error |
  |  | 449 | } |
  |  | 450 | $output         = @json\_decode( $body\_received\_json, true ); |
  |  | 451 | $responseApiKey = ! empty( $output['data'] ) && ! empty( $output['data']['apiKey'] ) ? $output['data']['apiKey'] : null; |
  |  | 452 | if ( ! empty( $responseApiKey ) ) { |
  |  | 453 | $settings          = get\_option( $this->settings\_name ); |
  |  | 454 | $settings['AppId'] = $responseApiKey; |
  |  | 455 | update\_option( $this->settings\_name, $settings ); |
  |  | 456 | $this->settings = get\_option( $this->settings\_name ); |
  |  | 457 | } else { |
  |  | 458 | $url      = 'https://api.vuukle.com/api/v1/WP/alertSupport?subjectLine=' . str\_replace( array( 'www.', 'http://', 'https://' ), '', $site\_url ); |
  |  | 459 | $response = wp\_remote\_get( $url, array( |
  |  | 460 | 'timeout' => 30, |
  |  | 461 | 'headers' => array( |
  |  | 462 | 'Content-Type' => 'application/json' |
  |  | 463 | ) |
  |  | 464 | ) ); |
  |  | 465 | if ( empty( $response ) || $response instanceof WP\_Error ) { |
  |  | 466 | // Error |
  |  | 467 | //TODO log error |
  |  | 468 | } |
  |  | 469 | $body\_received\_json = wp\_remote\_retrieve\_body( $response ); |
  |  | 470 | if ( empty( $body\_received\_json ) ) { |
  |  | 471 | // Error |
  |  | 472 | //TODO log error |
  |  | 473 | } |
  |  | 474 | $output = @json\_decode( $body\_received\_json, true ); |
  |  | 475 | } |
  |  | 476 | if ( ! $live ) { |
  |  | 477 | echo esc\_html( $responseApiKey ); |
  |  | 478 | wp\_die(); |
  |  | 479 | } |
  |  | 480 | } |
  |  | 481 |  |
  |  | 482 | /\*\* |
  |  | 483 | \* This function for change color. |
  |  | 484 | \* |
  |  | 485 | \* @return void |
  |  | 486 | \* @since  1.0.0. |
  |  | 487 | \*/ |
  |  | 488 | public function myColorPicker() { |
  |  | 489 | wp\_enqueue\_script( 'iris' ); |
  |  | 490 | } |
  |  | 491 |  |
  |  | 492 | /\*\* |
  |  | 493 | \* For enabling. |
  |  | 494 | \* |
  |  | 495 | \* @return void |
  |  | 496 | \* @since  1.0.0. |
  |  | 497 | \*/ |
  |  | 498 | public function vuukleEnableFunction() { |
  |  | 499 | $parsed\_url = wp\_parse\_url( $\_SERVER['HTTP\_REFERER'] ); |
  |  | 500 | parse\_str( $parsed\_url['query'], $query\_arr ); |
  |  | 501 | $nonce = ! empty( $\_POST['\_wpnonce'] ) ? sanitize\_key( $\_POST['\_wpnonce'] ) : ''; |
  |  | 502 | // Check nonce |
  |  | 503 | if ( wp\_verify\_nonce( $nonce, $this->settings\_name ) ) { |
  |  | 504 | $post   = esc\_sql( $\_POST ); |
  |  | 505 | $option = get\_option( 'Vuukle' ); |
  |  | 506 | if ( isset( $post['emote'] ) && '1' === $post['emote'] ) { |
  |  | 507 | $option['emote'] = 'true'; |
  |  | 508 | } else { |
  |  | 509 | $option['emote'] = 'false'; |
  |  | 510 | } |
  |  | 511 | if ( isset( $post['share'] ) && '1' === $post['share'] ) { |
  |  | 512 | $option['share'] = '1'; |
  |  | 513 | } else { |
  |  | 514 | $option['share'] = '0'; |
  |  | 515 | } |
  |  | 516 | if ( isset( $post['enable\_h\_v'] ) ) { |
  |  | 517 | if ( 'no' === $post['enable\_h\_v'] ) { |
  |  | 518 | $option['enable\_h\_v'] = 'no'; |
  |  | 519 | } else { |
  |  | 520 | $option['enable\_h\_v'] = 'yes'; |
  |  | 521 | } |
  |  | 522 | } |
  |  | 523 | if ( isset( $post['enabled\_comments'] ) && '1' === $post['enabled\_comments'] ) { |
  |  | 524 | $option['enabled\_comments'] = 'true'; |
  |  | 525 | } else { |
  |  | 526 | $option['enabled\_comments'] = 'false'; |
  |  | 527 | } |
  |  | 528 | update\_option( 'Vuukle', $option ); |
  |  | 529 | } |
  |  | 530 | wp\_safe\_redirect( admin\_url( 'plugins.php' ) ); |
  |  | 531 | exit; |
  |  | 532 | } |
  |  | 533 |  |
  |  | 534 | /\*\* |
  |  | 535 | \* Save Vuukle settings |
  |  | 536 | \* |
  |  | 537 | \* @since 4.0 |
  |  | 538 | \*/ |
  |  | 539 | public function VuukleSaveSettings() { |
  |  | 540 | // Define vars |
  |  | 541 | $parsed\_url = wp\_parse\_url( $\_SERVER['HTTP\_REFERER'] ); |
  |  | 542 | parse\_str( $parsed\_url['query'], $query\_arr ); |
  |  | 543 | $nonce = ! empty( $\_POST['nonce'] ) ? sanitize\_key( $\_POST['nonce'] ) : null; |
  |  | 544 | // Check nonce |
  |  | 545 | if ( empty( $nonce ) || ! wp\_verify\_nonce( $nonce, $this->settings\_name ) ) { |
  |  | 546 | // Invalid or empty nonce |
  |  | 547 | $this->redirect\_upon\_result( $parsed\_url, 'error', \_\_( 'Invalid nonce' ), $query\_arr ); |
  |  | 548 | } |
  |  | 549 | $data\_received = []; |
  |  | 550 | foreach ( $this->settings\_defaults as $key => $setting ) { |
  |  | 551 | if ( isset( $\_POST[ $key ] ) ) { |
  |  | 552 | // Two scenarios: 1. Field is string or 2. Field is array |
  |  | 553 | // Second one is connected with field named "text" |
  |  | 554 | // Most probably that field will be removed from user interface, or completely |
  |  | 555 | if ( is\_array( $\_POST[ $key ] ) && is\_array( $this->settings\_defaults[ $key ] ) ) { |
  |  | 556 | // Field is array |
  |  | 557 | $data\_received[ $key ] = []; |
  |  | 558 | foreach ( $this->settings\_defaults[ $key ] as $sub\_key => $sub\_value ) { |
  |  | 559 | if ( $key === 'text' && $sub\_key === 'timeAgo' ) { |
  |  | 560 | continue; |
  |  | 561 | } |
  |  | 562 | if ( isset( $\_POST[ $key ][ $sub\_key ] ) ) { |
  |  | 563 | $data\_received[ $key ][ $sub\_key ] = sanitize\_text\_field( $\_POST[ $key ][ $sub\_key ] ); |
  |  | 564 | } else { |
  |  | 565 | $data\_received[ $key ][ $sub\_key ] = $this->settings\_defaults[ $key ][ $sub\_key ]; |
  |  | 566 | } |
  |  | 567 | } |
  |  | 568 | } else { |
  |  | 569 | // Field is string |
  |  | 570 | // Check additional logic |
  |  | 571 | $data\_received[ $key ] = sanitize\_text\_field( $\_POST[ $key ] ); |
  |  | 572 | } |
  |  | 573 | } else { |
  |  | 574 | // Field is not set |
  |  | 575 | // According to previous save logic, lets check for couple fields default value |
  |  | 576 | switch ( $key ) { |
  |  | 577 | case 'share\_type': |
  |  | 578 | case 'share\_type\_vertical': |
  |  | 579 | case 'share\_position': |
  |  | 580 | case 'share\_position2': |
  |  | 581 | $data\_received[ $key ] = ''; |
  |  | 582 | break; |
  |  | 583 | case 'non\_article\_pages': |
  |  | 584 | $data\_received[ $key ] = 'off'; |
  |  | 585 | break; |
  |  | 586 | case 'checkboxTextEnabled': |
  |  | 587 | $data\_received[ $key ] = false; |
  |  | 588 | break; |
  |  | 589 | } |
  |  | 590 | } |
  |  | 591 | } |
  |  | 592 | // Some logic |
  |  | 593 | if ( $data\_received['enable\_h\_v'] === 'yes' ) { |
  |  | 594 | $data\_received['div\_class\_powerbar'] = ''; |
  |  | 595 | } |
  |  | 596 | if ( $data\_received['div\_class'] === '' && $data\_received['embed\_comments'] === '3' ) { |
  |  | 597 | $data\_received['embed\_comments'] = '1'; |
  |  | 598 | } |
  |  | 599 | if ( $data\_received['div\_id'] === '' && $data\_received['embed\_comments'] === '4' ) { |
  |  | 600 | $data\_received['embed\_comments'] = '1'; |
  |  | 601 | } |
  |  | 602 | // Final save |
  |  | 603 | $ok = update\_option( $this->settings\_name, $data\_received ); |
  |  | 604 | if ( $ok === false ) { |
  |  | 605 | // Error |
  |  | 606 | $this->redirect\_upon\_result( $parsed\_url, 'error', \_\_( 'Unable to save' ), $query\_arr ); |
  |  | 607 | } |
  |  | 608 | // Success |
  |  | 609 | $this->redirect\_upon\_result( $parsed\_url, 'success', \_\_( 'Successfully saved' ), $query\_arr ); |
  |  | 610 |  |
  |  | 611 | } |
  |  | 612 |  |
  |  | 613 | /\*\* |
  |  | 614 | \* Save Vuukle settings |
  |  | 615 | \* |
  |  | 616 | \* @since 4.0 |
  |  | 617 | \*/ |
  |  | 618 | public function VuukleResetSettings() { |
  |  | 619 | // Define vars |
  |  | 620 | $parsed\_url = wp\_parse\_url( $\_SERVER['HTTP\_REFERER'] ); |
  |  | 621 | parse\_str( $parsed\_url['query'], $query\_arr ); |
  |  | 622 | $nonce = ! empty( $\_POST['nonce'] ) ? sanitize\_key( $\_POST['nonce'] ) : null; |
  |  | 623 | // Check nonce |
  |  | 624 | if ( empty( $nonce ) || ! wp\_verify\_nonce( $nonce, $this->settings\_name ) ) { |
  |  | 625 | // Invalid or empty nonce |
  |  | 626 | $this->redirect\_upon\_result( $parsed\_url, 'error', \_\_( 'Invalid nonce' ), $query\_arr ); |
  |  | 627 | } |
  |  | 628 | $app\_id                           = ! empty( $\_POST['AppId'] ) ? sanitize\_text\_field( $\_POST['AppId'] ) : ''; |
  |  | 629 | $this->settings\_defaults['AppId'] = $app\_id; |
  |  | 630 | // Final save |
  |  | 631 | $ok = update\_option( $this->settings\_name, $this->settings\_defaults ); |
  |  | 632 | if ( $ok === false ) { |
  |  | 633 | // Error |
  |  | 634 | $this->redirect\_upon\_result( $parsed\_url, 'error', \_\_( 'Unable to save' ), $query\_arr ); |
  |  | 635 | } |
  |  | 636 | // Success |
  |  | 637 | $this->redirect\_upon\_result( $parsed\_url, 'success', \_\_( 'Successfully saved' ), $query\_arr ); |
  |  | 638 | } |
  |  | 639 |  |
  |  | 640 | /\*\* |
  |  | 641 | \* For deactivation. |
  |  | 642 | \* |
  |  | 643 | \* @return void |
  |  | 644 | \* @since  1.0.0. |
  |  | 645 | \*/ |
  |  | 646 | public function vuukleDeactivateFunction() { |
  |  | 647 | $nonce = ! empty( $\_POST['\_wpnonce'] ) ? sanitize\_key( $\_POST['\_wpnonce'] ) : ''; |
  |  | 648 | if ( wp\_verify\_nonce( $nonce ) ) { |
  |  | 649 | $post = $\_POST; |
  |  | 650 | if ( 'confirm' === $post['vuukle\_deactivate\_function'] ) { |
  |  | 651 | deactivate\_plugins( array( $this->plugin\_name . '/' . $this->plugin\_name . '.php' ) ); |
  |  | 652 | delete\_option( 'Activated\_Vuukle\_Plugin\_Date' ); |
  |  | 653 | delete\_option( 'hide\_vuukle\_admin\_notice' ); |
  |  | 654 | if ( ! empty( $post['answer-deactivate-vuukle'] ) ) { |
  |  | 655 | $subject = 'Deactivate Vuukle plugin on the site ' . site\_url(); |
  |  | 656 | $message = '<strong>Type answer:</strong> ' . esc\_html( stripslashes( $post['answer-deactivate-vuukle'] ) ); |
  |  | 657 | if ( ! empty( $post['other-answer-deactivate-vuukle'] ) && 'Other' === $post['answer-deactivate-vuukle'] ) { |
  |  | 658 | $message .= '<br><strong>Text answer:</strong> ' . esc\_html( stripslashes( $post['other-answer-deactivate-vuukle'] ) ); |
  |  | 659 | } |
  |  | 660 | $headers = array( |
  |  | 661 | 'From: ' . get\_option( 'blogname' ) . ' <' . get\_option( 'admin\_email' ) . '>', |
  |  | 662 | 'content-type: text/html', |
  |  | 663 | ); |
  |  | 664 | wp\_mail( 'support@vuukle.com', $subject, $message, $headers ); |
  |  | 665 | } |
  |  | 666 | } |
  |  | 667 | } |
  |  | 668 | wp\_safe\_redirect( admin\_url( 'plugins.php' ) ); |
  |  | 669 | exit; |
  |  | 670 | } |
  |  | 671 |  |
  |  | 672 | /\*\* |
  |  | 673 | \* Creating activation modal. |
  |  | 674 | \* |
  |  | 675 | \* @return void |
  |  | 676 | \* @since  1.0.0. |
  |  | 677 | \*/ |
  |  | 678 | public function activationModal() { |
  |  | 679 | if ( is\_admin() && '1' === get\_option( 'Activated\_Vuukle\_Plugin' ) ) { |
  |  | 680 | delete\_option( 'Activated\_Vuukle\_Plugin' ); |
  |  | 681 | include VUUKLE\_INCLUDES\_PATH . '/free-comments-for-wordpress-vuukle-activate-modal.php'; |
  |  | 682 | } |
  |  | 683 | } |
  |  | 684 |  |
  |  | 685 | /\*\* |
  |  | 686 | \* Creating deactivation modal. |
  |  | 687 | \* |
  |  | 688 | \* @return void |
  |  | 689 | \* @since  1.0.0. |
  |  | 690 | \*/ |
  |  | 691 | public function deactivationModal() { |
  |  | 692 | if ( is\_admin() ) { |
  |  | 693 | $screen = get\_current\_screen(); |
  |  | 694 | if ( 'plugins' === $screen->base ) { |
  |  | 695 | include VUUKLE\_INCLUDES\_PATH . '/free-comments-for-wordpress-vuukle-deactivate-modal.php'; |
  |  | 696 | } |
  |  | 697 | } |
  |  | 698 | } |
  |  | 699 |  |
  |  | 700 | /\*\* |
  |  | 701 | \* For settings JS. |
  |  | 702 | \* |
  |  | 703 | \* @return void |
  |  | 704 | \* @since  1.0.0. |
  |  | 705 | \*/ |
  |  | 706 | public function settingsJs() { |
  |  | 707 | wp\_enqueue\_script( 'settings', plugins\_url( 'js/settings.js', \_\_FILE\_\_ ) ); |
  |  | 708 | } |
  |  | 709 |  |
  |  | 710 | /\*\* |
  |  | 711 | \* For dashicons. |
  |  | 712 | \* |
  |  | 713 | \* @return void |
  |  | 714 | \* @since  1.0.0. |
  |  | 715 | \*/ |
  |  | 716 | public function jkLoadDashicons() { |
  |  | 717 | wp\_enqueue\_style( 'dashicons' ); |
  |  | 718 | } |
  |  | 719 |  |
  |  | 720 | /\*\* |
  |  | 721 | \* This function hides admin notice. |
  |  | 722 | \* |
  |  | 723 | \* @return void |
  |  | 724 | \* @since  1.0.0. |
  |  | 725 | \*/ |
  |  | 726 | public function hideVuukleVdminVotice() { |
  |  | 727 | add\_option( 'hideVuukleVdminVotice', '1' ); |
  |  | 728 | } |
  |  | 729 |  |
  |  | 730 | /\*\* |
  |  | 731 | \* This function creates admin notice. |
  |  | 732 | \* |
  |  | 733 | \* @return void |
  |  | 734 | \* @since  1.0.0. |
  |  | 735 | \*/ |
  |  | 736 | public function one\_month\_notice() { |
  |  | 737 | ?> |
  | 646 | 738 | <div class="notice notice-success is-dismissible vuukle-notice"> |
  | 647 | 739 | <p> |
  | 648 | 740 | <img style="float:right; width:180px;" class="logo" src="<?php echo VUUKLE\_ADMIN\_URL; // WPCS: XSS ok |
  | 649 |  | ~~?>/images/vuukle-logo.svg"~~ /> |
  |  | 741 | ?>/images/vuukle-logo.svg"/> |
  | 650 | 742 | <strong> |
  | 651 |  | ~~<p>~~Hello there! You’ve been using Vuukle widgets on your site for over a month now. If it sucked, you know what |
  | 652 |  | to do but if it was a great experience - please rate it 5-stars and spread the positive vibes by leaving us |
  | 653 |  | ~~a comment.<br>We thank you for choosing us and helping us become a better product. Email us on <a href="mailto:support@vuukle.com">support@vuukle.com</a> if you have any suggestions.</p>~~ |
  |  | 743 | Hello there! You’ve been using Vuukle widgets on your site for over a month now. If it sucked, you know what |
  |  | 744 | to do but if it was a great experience - please rate it 5-stars and spread the positive vibes by leaving us |
  |  | 745 | a comment.<br>We thank you for choosing us and helping us become a better product. Email us on <a href="mailto:support@vuukle.com">support@vuukle.com</a> if you have any suggestions. |
  | 654 | 746 | </strong> |
  |  | 747 | </p> |
  | 655 | 748 | <div style="clear: both"></div> |
  | 656 |  | ~~</p>~~ |
  | 657 | 749 | <ul> |
  | 658 | 750 | <li> |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/class-free-comments-for-wordpress-vuukle-admin.php?rev=2533938#L673) | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/class-free-comments-for-wordpress-vuukle-admin.php?rev=2553337#L765) |  |
  | 673 | 765 | </ul> |
  | 674 | 766 | </div> |
  | 675 |  |  |
  | 676 | 767 | <script> |
  | 677 | 768 | function doAjaxRequest(type, data, url) { |
  | 678 | 769 | var xmlhttp = new XMLHttpRequest(); |
  | 679 |  |  |
  | 680 |  | xmlhttp.onreadystatechange = function() { |
  | 681 |  |  |
  |  | 770 | xmlhttp.onreadystatechange = function () { |
  | 682 | 771 | }; |
  | 683 |  |  |
  | 684 | 772 | xmlhttp.open(type, url, true); |
  | 685 | 773 | if (data) |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/class-free-comments-for-wordpress-vuukle-admin.php?rev=2533938#L688) | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/class-free-comments-for-wordpress-vuukle-admin.php?rev=2553337#L776) |  |
  | 688 | 776 | xmlhttp.send(); |
  | 689 | 777 | } |
  | 690 |  | document.addEventListener('click', function(event) { |
  | 691 |  |  |
  |  | 778 |  |
  |  | 779 | document.addEventListener('click', function (event) { |
  | 692 | 780 | if (event.target.matches('.pum2-dismiss')) { |
  | 693 | 781 | document.querySelector('.vuukle-notice button.notice-dismiss')?.click(); |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/class-free-comments-for-wordpress-vuukle-admin.php?rev=2533938#L697) | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/class-free-comments-for-wordpress-vuukle-admin.php?rev=2553337#L785) |  |
  | 697 | 785 | }); |
  | 698 | 786 | </script> |
  | 699 |  | <?php |
  | 700 |  | } |
  | 701 |  |  |
  | 702 |  | /\*\* |
  | 703 |  | \* Action link. |
  | 704 |  | \* |
  | 705 |  | \* @param string $links formed link |
  | 706 |  | \* |
  | 707 |  | \* @return string |
  | 708 |  | \*/ |
  | 709 |  | public function actionLinks($links) |
  | 710 |  | { |
  | 711 |  |  |
  | 712 |  | $link = '<a href="' . $this->settings\_url . '">Settings</a>'; |
  | 713 |  | array\_push($links, $link); |
  | 714 |  | return $links; |
  | 715 |  | } |
  | 716 |  |  |
  | 717 |  | /\*\* |
  | 718 |  | \* This function for disabling. |
  | 719 |  | \* |
  | 720 |  | \* @since  1.0.0. |
  | 721 |  | \* @return void |
  | 722 |  | \*/ |
  | 723 |  | public function vuukleDisablePlugin() |
  | 724 |  | { |
  | 725 |  |  |
  | 726 |  | deactivate\_plugins(array('free-comments-for-wordpress-vuukle/free-comments-for-wordpress-vuukle.php')); |
  | 727 |  | delete\_option('Activated\_Vuukle\_Plugin\_Date'); |
  | 728 |  | delete\_option('hide\_vuukle\_admin\_notice'); |
  | 729 |  | wp\_redirect(admin\_url('admin.php')); |
  | 730 |  |  |
  | 731 |  | exit; |
  | 732 |  | } |
  | 733 |  |  |
  | 734 |  | /\*\* |
  | 735 |  | \* This function removes ver CSS and JS . |
  | 736 |  | \* |
  | 737 |  | \* @param string $src removed argument |
  | 738 |  | \* |
  | 739 |  | \* @since  1.0.0. |
  | 740 |  | \* @return string |
  | 741 |  | \*/ |
  | 742 |  | public function vuukleRemoveVerCssJs($src) |
  | 743 |  | { |
  | 744 |  | if (strpos($src, 'vuukle-admin.js?ver=')) { |
  | 745 |  | $src = remove\_query\_arg('ver', $src); |
  | 746 |  | } |
  | 747 |  | return $src; |
  | 748 |  | } |
  | 749 |  |  |
  | 750 |  | /\*\* |
  | 751 |  | \* This function for comments template. |
  | 752 |  | \* |
  | 753 |  | \* @param string $file template |
  | 754 |  | \* |
  | 755 |  | \* @since  1.0.0. |
  | 756 |  | \* @return string |
  | 757 |  | \*/ |
  | 758 |  | public function commentsTemplate($file) |
  | 759 |  | { |
  | 760 |  | global $post; |
  | 761 |  |  |
  | 762 |  | $post\_exceptions = explode(',', $this->settings['post\_exceptions']); |
  | 763 |  | $post\_exceptions = array\_map('trim', $post\_exceptions); |
  | 764 |  |  |
  | 765 |  | $category\_exceptions = explode(',', $this->settings['category\_exceptions']); |
  | 766 |  | $category\_exceptions = array\_map('trim', $category\_exceptions); |
  | 767 |  | $post\_categories     = get\_the\_category($post->ID); |
  | 768 |  | foreach ($post\_categories as $key => $category) { |
  | 769 |  | $post\_categories[$key] = $category->slug; |
  | 770 |  | } |
  | 771 |  |  |
  | 772 |  | if (empty($content)) { |
  | 773 |  | $content = ''; |
  | 774 |  | } |
  | 775 |  |  |
  | 776 |  | if (in\_array((string) $post->ID, $post\_exceptions, true)) { |
  | 777 |  | return $content; |
  | 778 |  | } |
  | 779 |  |  |
  | 780 |  | if (count(array\_intersect($category\_exceptions, $post\_categories))) { |
  | 781 |  | return $content; |
  | 782 |  | } |
  | 783 |  |  |
  | 784 |  |  |
  | 785 |  | // post type exceptions |
  | 786 |  | $post\_type\_exceptions = explode(',', $this->settings['post\_type\_exceptions']); |
  | 787 |  | $post\_type\_exceptions = array\_map('trim', $post\_type\_exceptions); |
  | 788 |  | if (in\_array((string) $post->post\_type, $post\_type\_exceptions, true)) { |
  | 789 |  | return $content; |
  | 790 |  | } |
  | 791 |  |  |
  | 792 |  | // post type by URL exceptions |
  | 793 |  | $post\_type\_by\_url\_exceptions = explode(',', $this->settings['post\_type\_by\_url\_exceptions']); |
  | 794 |  | $post\_type\_by\_url\_exceptions = array\_map('trim', $post\_type\_by\_url\_exceptions); |
  | 795 |  | if (in\_array((string) $post->post\_type, $post\_type\_by\_url\_exceptions, true)) { |
  | 796 |  | return $content; |
  | 797 |  | } |
  | 798 |  |  |
  | 799 |  | $comments\_file = dirname(\_\_FILE\_\_) . DIRECTORY\_SEPARATOR . 'comments-empty.php'; |
  | 800 |  |  |
  | 801 |  | if (is\_single()) { |
  | 802 |  | if ($this->settings['AppId'] && file\_exists($comments\_file)) { |
  | 803 |  | $file = $comments\_file; |
  | 804 |  | } |
  | 805 |  | } |
  | 806 |  | return $file; |
  | 807 |  | } |
  | 808 |  |  |
  | 809 |  | /\*\* |
  | 810 |  | \* This function returns the content. |
  | 811 |  | \* |
  | 812 |  | \* @param string $content returned content |
  | 813 |  | \* |
  | 814 |  | \* @since  1.0.0. |
  | 815 |  | \* @return string |
  | 816 |  | \*/ |
  | 817 |  | public function theContent2($content) |
  | 818 |  | { |
  | 819 |  | $author\_info = array( |
  | 820 |  | 'name'  => get\_the\_author\_meta('display\_name', $post->post\_author), |
  | 821 |  | 'email' => get\_the\_author\_meta('user\_email', $post->post\_author), |
  | 822 |  | ); |
  | 823 |  |  |
  | 824 |  | return $content; |
  | 825 |  | } |
  | 826 |  |  |
  | 827 |  | /\*\* |
  | 828 |  | \* This function counts the posts.. |
  | 829 |  | \* |
  | 830 |  | \* @since  1.0.0. |
  | 831 |  | \* @return void |
  | 832 |  | \*/ |
  | 833 |  | public function vuukleCommentsCountPost() |
  | 834 |  | { |
  | 835 |  | global $vuukle; |
  | 836 |  | global $post; |
  | 837 |  | $post\_ids = get\_posts( // phpcs:ignore WordPress.VIP.RestrictedFunctions |
  | 838 |  | array( |
  | 839 |  | 'fields'         => 'ids', |
  | 840 |  | 'posts\_per\_page' => -1, // phpcs:ignore WordPress.VIP.PostsPerPage |
  | 841 |  | ) |
  | 842 |  | ); |
  | 843 |  | $list     = $post\_ids; |
  | 844 |  | $list     = implode(',', $list); |
  | 845 |  | if ($vuukle->settings['AppId']) { |
  | 846 |  | $url      = 'https://api.vuukle.com/api/v1/Comments/getCommentCountListByHost?host=' . str\_replace(array('www.', 'http://', 'https://'), '', get\_site\_url()) . '&articleIds=' . $list; |
  | 847 |  | $args     = array('headers' => array('Cache-Control' => 'no-cache')); |
  | 848 |  | $response = wp\_remote\_retrieve\_body(wp\_safe\_remote\_get($url, $args)); |
  | 849 |  | $count    = 0; |
  | 850 |  | $response = json\_decode($response, true); |
  | 851 |  |  |
  | 852 |  | if ($response['data']) { |
  | 853 |  | $response\_data = $response['data']; |
  | 854 |  | if (!empty($response\_data[$post->ID])) { |
  | 855 |  | return $response\_data[$post->ID]; |
  | 856 |  | } else { |
  | 857 |  | return $count; |
  | 858 |  | } |
  | 859 |  | } |
  | 860 |  | } |
  | 861 |  | return $count; |
  | 862 |  | } |
  | 863 |  |  |
  | 864 |  | /\*\* |
  | 865 |  | \* This function for activating. |
  | 866 |  | \* |
  | 867 |  | \* @since  1.0.0. |
  | 868 |  | \* @return void |
  | 869 |  | \*/ |
  | 870 |  | public function activate() |
  | 871 |  | { |
  | 872 |  |  |
  | 873 |  | if (is\_array($this->settings)) { |
  | 874 |  | $settings = array\_merge($this->settings\_defaults, $this->settings); |
  | 875 |  | $settings = array\_intersect\_key($settings, $this->settings\_defaults); |
  | 876 |  | update\_option($this->settings\_name, $settings); |
  | 877 |  | } else { |
  | 878 |  | add\_option($this->settings\_name, $this->settings\_defaults); |
  | 879 |  | } |
  | 880 |  |  |
  | 881 |  | $this->settings = get\_option($this->settings\_name); |
  | 882 |  |  |
  | 883 |  | $args = array( |
  | 884 |  | 'name'     => str\_replace(array('www.', 'http://', 'https://'), '', get\_site\_url()), |
  | 885 |  | 'host'     => str\_replace(array('www.', 'http://', 'https://'), '', get\_site\_url()), |
  | 886 |  | 'avatar'   => '', |
  | 887 |  | 'email'    => get\_option('admin\_email'), |
  | 888 |  | 'password' => rand(0, 1000000), |
  | 889 |  | ); |
  | 890 |  | $args = json\_encode($args); |
  | 891 |  |  |
  | 892 |  |  |
  | 893 |  | $url = 'https://api.vuukle.com/api/v1/Publishers/registerWP'; |
  | 894 |  | $ch = curl\_init(); // phpcs:ignore WordPress.WP.AlternativeFunctions |
  | 895 |  | curl\_setopt($ch, CURLOPT\_URL, $url); // phpcs:ignore WordPress.WP.AlternativeFunctions |
  | 896 |  | curl\_setopt($ch, CURLOPT\_RETURNTRANSFER, 1); // phpcs:ignore WordPress.WP.AlternativeFunctions |
  | 897 |  | curl\_setopt($ch, CURLOPT\_POST, true); // phpcs:ignore WordPress.WP.AlternativeFunctions |
  | 898 |  | curl\_setopt($ch, CURLOPT\_POSTFIELDS, $args); // phpcs:ignore WordPress.WP.AlternativeFunctions |
  | 899 |  | curl\_setopt( |
  | 900 |  | $ch, |
  | 901 |  | CURLOPT\_HTTPHEADER, |
  | 902 |  | array( |
  | 903 |  | 'Content-Type:application/json', |
  | 904 |  | 'Content-Length: ' . strlen($args) |
  | 905 |  | ) |
  | 906 |  | ); |
  | 907 |  | $output = curl\_exec($ch); // phpcs:ignore WordPress.WP.AlternativeFunctions |
  | 908 |  | $output = json\_decode($output, true); // phpcs:ignore WordPress.WP.AlternativeFunctions |
  | 909 |  | curl\_close($ch); // phpcs:ignore WordPress.WP.AlternativeFunctions |
  | 910 |  |  |
  | 911 |  | $responseApiKey = $output['data']['apiKey']; |
  | 912 |  |  |
  | 913 |  | if ($responseApiKey) { |
  | 914 |  |  |
  | 915 |  | if (isset($responseApiKey)) { |
  | 916 |  | $settings          = get\_option($this->settings\_name); |
  | 917 |  | $settings['AppId'] = $responseApiKey; |
  | 918 |  | update\_option($this->settings\_name, $settings); |
  | 919 |  | $this->settings = get\_option($this->settings\_name); |
  | 920 |  | } |
  | 921 |  | } |
  | 922 |  |  |
  | 923 |  | if (empty($responseApiKey)) { |
  | 924 |  |  |
  | 925 |  | $url = 'https://api.vuukle.com/api/v1/WP/alertSupport?subjectLine=' . str\_replace(array('www.', 'http://', 'https://'), '', get\_site\_url());; |
  | 926 |  | // execute curl |
  | 927 |  | $ch = curl\_init(); // phpcs:ignore WordPress.WP.AlternativeFunctions |
  | 928 |  | curl\_setopt($ch, CURLOPT\_URL, $url); // phpcs:ignore WordPress.WP.AlternativeFunctions |
  | 929 |  | curl\_setopt($ch, CURLOPT\_RETURNTRANSFER, 1); // phpcs:ignore WordPress.WP.AlternativeFunctions |
  | 930 |  | $output = curl\_exec($ch); // phpcs:ignore WordPress.WP.AlternativeFunctions |
  | 931 |  | $output = json\_decode($output, true); // phpcs:ignore WordPress.WP.AlternativeFunctions |
  | 932 |  | curl\_close($ch); // phpcs:ignore WordPress.WP.AlternativeFunctions |
  | 933 |  | } |
  | 934 |  | } |
  | 935 |  |  |
  | 936 |  | /\*\* |
  | 937 |  | \* This function for deactivating. |
  | 938 |  | \* |
  | 939 |  | \* @since  1.0.0. |
  | 940 |  | \* @return void |
  | 941 |  | \*/ |
  | 942 |  | public function deactivate() |
  | 943 |  | { |
  | 944 |  |  |
  | 945 |  | $url  = 'https://api.vuukle.com/api/v1/WP/uninstallVuukle?'; |
  | 946 |  | $url .= http\_build\_query( |
  | 947 |  | array( |
  | 948 |  | 'email' => get\_option('admin\_email'), |
  | 949 |  | ) |
  | 950 |  | ); |
  | 951 |  | // execute curl |
  | 952 |  | $ch = curl\_init(); // phpcs:ignore WordPress.WP.AlternativeFunctions |
  | 953 |  | curl\_setopt($ch, CURLOPT\_URL, $url); // phpcs:ignore WordPress.WP.AlternativeFunctions |
  | 954 |  | curl\_setopt($ch, CURLOPT\_RETURNTRANSFER, 1); // phpcs:ignore WordPress.WP.AlternativeFunctions |
  | 955 |  | $output = curl\_exec($ch); // phpcs:ignore WordPress.WP.AlternativeFunctions |
  | 956 |  | $output = json\_decode($output, true); // phpcs:ignore WordPress.WP.AlternativeFunctions |
  | 957 |  | curl\_close($ch); // phpcs:ignore WordPress.WP.AlternativeFunctions |
  | 958 |  |  |
  | 959 |  | } |
  |  | 787 | <?php |
  |  | 788 | } |
  |  | 789 |  |
  |  | 790 | /\*\* |
  |  | 791 | \* Action link. |
  |  | 792 | \* |
  |  | 793 | \* @param   array  $links  formed link |
  |  | 794 | \* |
  |  | 795 | \* @return array |
  |  | 796 | \*/ |
  |  | 797 | public function actionLinks( $links ) { |
  |  | 798 | $link = '<a href="' . $this->settings\_url . '">Settings</a>'; |
  |  | 799 | array\_push( $links, $link ); |
  |  | 800 |  |
  |  | 801 | return $links; |
  |  | 802 | } |
  |  | 803 |  |
  |  | 804 | /\*\* |
  |  | 805 | \* This function removes ver CSS and JS . |
  |  | 806 | \* |
  |  | 807 | \* @param   string  $src  removed argument |
  |  | 808 | \* |
  |  | 809 | \* @return string |
  |  | 810 | \* @since  1.0.0. |
  |  | 811 | \*/ |
  |  | 812 | public function vuukleRemoveVerCssJs( $src ) { |
  |  | 813 | if ( strpos( $src, 'vuukle-admin.js?ver=' ) ) { |
  |  | 814 | $src = remove\_query\_arg( 'ver', $src ); |
  |  | 815 | } |
  |  | 816 |  |
  |  | 817 | return $src; |
  |  | 818 | } |
  |  | 819 |  |
  |  | 820 | /\*\* |
  |  | 821 | \* This function for comments template. |
  |  | 822 | \* |
  |  | 823 | \* @param   string  $file  template |
  |  | 824 | \* |
  |  | 825 | \* @return string |
  |  | 826 | \* @since  1.0.0. |
  |  | 827 | \*/ |
  |  | 828 | public function commentsTemplate( $file ) { |
  |  | 829 | global $post; |
  |  | 830 | $post\_exceptions     = explode( ',', $this->settings['post\_exceptions'] ); |
  |  | 831 | $post\_exceptions     = array\_map( 'trim', $post\_exceptions ); |
  |  | 832 | $category\_exceptions = explode( ',', $this->settings['category\_exceptions'] ); |
  |  | 833 | $category\_exceptions = array\_map( 'trim', $category\_exceptions ); |
  |  | 834 | $post\_categories     = get\_the\_category( $post->ID ); |
  |  | 835 | foreach ( $post\_categories as $key => $category ) { |
  |  | 836 | $post\_categories[ $key ] = $category->slug; |
  |  | 837 | } |
  |  | 838 | if ( empty( $content ) ) { |
  |  | 839 | $content = ''; |
  |  | 840 | } |
  |  | 841 | if ( in\_array( (string) $post->ID, $post\_exceptions, true ) ) { |
  |  | 842 | return $content; |
  |  | 843 | } |
  |  | 844 | if ( count( array\_intersect( $category\_exceptions, $post\_categories ) ) ) { |
  |  | 845 | return $content; |
  |  | 846 | } |
  |  | 847 | // post type exceptions |
  |  | 848 | $post\_type\_exceptions = explode( ',', $this->settings['post\_type\_exceptions'] ); |
  |  | 849 | $post\_type\_exceptions = array\_map( 'trim', $post\_type\_exceptions ); |
  |  | 850 | if ( in\_array( (string) $post->post\_type, $post\_type\_exceptions, true ) ) { |
  |  | 851 | return $content; |
  |  | 852 | } |
  |  | 853 | // post type by URL exceptions |
  |  | 854 | $post\_type\_by\_url\_exceptions = explode( ',', $this->settings['post\_type\_by\_url\_exceptions'] ); |
  |  | 855 | $post\_type\_by\_url\_exceptions = array\_map( 'trim', $post\_type\_by\_url\_exceptions ); |
  |  | 856 | if ( in\_array( (string) $post->post\_type, $post\_type\_by\_url\_exceptions, true ) ) { |
  |  | 857 | return $content; |
  |  | 858 | } |
  |  | 859 | $comments\_file = dirname( \_\_FILE\_\_ ) . DIRECTORY\_SEPARATOR . 'comments-empty.php'; |
  |  | 860 | if ( is\_single() ) { |
  |  | 861 | if ( $this->settings['AppId'] && file\_exists( $comments\_file ) ) { |
  |  | 862 | $file = $comments\_file; |
  |  | 863 | } |
  |  | 864 | } |
  |  | 865 |  |
  |  | 866 | return $file; |
  |  | 867 | } |
  |  | 868 |  |
  |  | 869 | /\*\* |
  |  | 870 | \* This function counts the posts.. |
  |  | 871 | \* |
  |  | 872 | \* @return int |
  |  | 873 | \* @since  1.0.0. |
  |  | 874 | \*/ |
  |  | 875 | public function vuukleCommentsCountPost() { |
  |  | 876 | global $vuukle; |
  |  | 877 | global $post; |
  |  | 878 | $post\_ids = get\_posts( // phpcs:ignore WordPress.VIP.RestrictedFunctions |
  |  | 879 | array( |
  |  | 880 | 'fields'         => 'ids', |
  |  | 881 | 'posts\_per\_page' => - 1, // phpcs:ignore WordPress.VIP.PostsPerPage |
  |  | 882 | ) ); |
  |  | 883 | $list     = $post\_ids; |
  |  | 884 | $list     = implode( ',', $list ); |
  |  | 885 | if ( $vuukle->settings['AppId'] ) { |
  |  | 886 | $url      = 'https://api.vuukle.com/api/v1/Comments/getCommentCountListByHost?host=' . str\_replace( array( 'www.', 'http://', 'https://' ), '', get\_site\_url() ) . '&articleIds=' . $list; |
  |  | 887 | $args     = array( 'headers' => array( 'Cache-Control' => 'no-cache' ) ); |
  |  | 888 | $response = wp\_remote\_retrieve\_body( wp\_safe\_remote\_get( $url, $args ) ); |
  |  | 889 | $count    = 0; |
  |  | 890 | $response = json\_decode( $response, true ); |
  |  | 891 | if ( $response['data'] ) { |
  |  | 892 | $response\_data = $response['data']; |
  |  | 893 | if ( ! empty( $response\_data[ $post->ID ] ) ) { |
  |  | 894 | return $response\_data[ $post->ID ]; |
  |  | 895 | } else { |
  |  | 896 | return $count; |
  |  | 897 | } |
  |  | 898 | } |
  |  | 899 | } |
  |  | 900 |  |
  |  | 901 | return $count; |
  |  | 902 | } |
  | 960 | 903 | } |
  | 961 | 904 |  |
  | 962 |  | /\*\* |
  | 963 |  | \* The widget-specific functionality of the plugin. |
  | 964 |  | \* |
  | 965 |  | \* @category   PHP |
  | 966 |  | \* @package    Free\_Comments\_For\_Wordpress\_Vuukle |
  | 967 |  | \* @subpackage Free\_Comments\_For\_Wordpress\_Vuukle/admin |
  | 968 |  | \* @author     Vuukle <info@vuukle.com> |
  | 969 |  | \* @license    http://www.gnu.org/licenses/gpl-2.0.txt GPL-2.0+ |
  | 970 |  | \* @link       https://vuukle.com |
  | 971 |  | \*/ |
  | 972 |  | class Recent\_Comments\_Widget extends WP\_Widget |
  | 973 |  | { |
  | 974 |  |  |
  | 975 |  | /\*\* |
  | 976 |  | \* Initialize the class and set its properties. |
  | 977 |  | \*/ |
  | 978 |  | function \_\_construct() |
  | 979 |  | { |
  | 980 |  | parent::\_\_construct( |
  | 981 |  | 'recent\_comments\_widget', |
  | 982 |  | 'Recent Comments', |
  | 983 |  | array('description' => 'Vuukle Recent Comments Widget') |
  | 984 |  | ); |
  | 985 |  | } |
  | 986 |  |  |
  | 987 |  |  |
  | 988 |  | /\*\* |
  | 989 |  | \* This function creates the widget. |
  | 990 |  | \* |
  | 991 |  | \* @param array $args     this is an array |
  | 992 |  | \* @param array $instance this is an array |
  | 993 |  | \* |
  | 994 |  | \* @since  1.0.0. |
  | 995 |  | \* @return string |
  | 996 |  | \*/ |
  | 997 |  | public function widget($args, $instance) |
  | 998 |  | { |
  | 999 |  | $widget\_id    = $args['widget\_id']; |
  | 1000 |  | $title        = apply\_filters('widget\_title', $instance['title']); |
  | 1001 |  | $tags         = $instance['tags']; |
  | 1002 |  | $count        = $instance['count']; |
  | 1003 |  | $style        = $instance['style']; |
  | 1004 |  | $character    = $instance['character']; |
  | 1005 |  | $display\_type = 'List'; |
  | 1006 |  | $display\_date = 'Yes'; |
  | 1007 |  | echo $args['before\_widget']; // WPCS: XSS ok |
  | 1008 |  |  |
  | 1009 |  | if (!empty($title)) { |
  | 1010 |  | echo $args['before\_title'] . $title . $args['after\_title']; // WPCS: XSS ok |
  | 1011 |  | } |
  | 1012 |  |  |
  | 1013 |  | $api          = get\_option('Vuukle'); |
  | 1014 |  | $api          = $api['AppId']; |
  | 1015 |  | $url          = 'https://api.vuukle.com/api/v1/Comments/getRecentComments?host=' . str\_replace(array('www.', 'http://', 'https://'), '', get\_site\_url()) . '&count=' . $count; |
  | 1016 |  | $request\_args = array('headers' => array('Cache-Control' => 'no-cache')); |
  | 1017 |  | $response     = wp\_remote\_retrieve\_body(wp\_safe\_remote\_get($url, $request\_args)); |
  | 1018 |  | $comments     = json\_decode($response, true); |
  | 1019 |  | $print\_html   = ''; |
  | 1020 |  |  |
  | 1021 |  |  |
  | 1022 |  | if ('Carousel' === $display\_type) { |
  | 1023 |  | $stories\_widget\_carousel\_items\_width = count($comments) \* 160; |
  | 1024 |  | $print\_html                          = '<div class="stories\_widget\_carousel"> |
  | 1025 |  | <div id="controllers" title="0"> |
  | 1026 |  | <span id="left" class="dashicons dashicons-arrow-left-alt2"></span> |
  | 1027 |  | <span id="right" class="dashicons dashicons-arrow-right-alt2"></span> |
  | 1028 |  | </div> |
  | 1029 |  | <div class="carousel\_items" style="width:' . $stories\_widget\_carousel\_items\_width . 'px;">'; |
  | 1030 |  |  |
  | 1031 |  | foreach ($comments['data'] as $comment) { |
  | 1032 |  | $\_\_comment    = substr($comment['commentText'], 0, $character); |
  | 1033 |  | $avatar\_image = isset($comment['articleAvatar']) && '' !== $comment['articleAvatar'] ? $comment['articleAvatar'] : plugins\_url('/noimage.jpg', \_\_FILE\_\_); |
  | 1034 |  | $print\_html  .= '<div class="carousel\_item"> |
  | 1035 |  | <div class="carousel\_item\_img\_div"> |
  | 1036 |  | <img class="carousel\_item\_img" src="' . $avatar\_image . '"> |
  | 1037 |  | <div class="count">' . $\_\_comment . '</div> |
  | 1038 |  | </div> |
  | 1039 |  | <div class="title"><a title="' . $comment['title'] . '" class="carousel\_item\_link"  href="' . str\_replace(str\_replace(array('www.', 'http://', 'https://'), '', get\_site\_url()), '', $comment['uri']) . '">' . substr($comment['title'], 0, 21) . '</a></div> |
  | 1040 |  | </div>'; |
  | 1041 |  | }; |
  | 1042 |  | $print\_html .= '</div></div>'; |
  | 1043 |  | $print\_html .= '<style> |
  | 1044 |  | .stories\_widget\_carousel{width: 160px;height: 200px;overflow: hidden;position: relative;} |
  | 1045 |  | .stories\_widget\_carousel #controllers{} |
  | 1046 |  | .stories\_widget\_carousel #controllers > span {cursor: pointer;} |
  | 1047 |  | .carousel\_items{ position: absolute;left: 0;right: 0; transition: 1s;position: relative;} |
  | 1048 |  | .carousel\_item{display: inline-block;} |
  | 1049 |  | .carousel\_item\_link{ position: absolute;} |
  | 1050 |  | .carousel\_item\_img{width: 160px;height: 130px;} |
  | 1051 |  | .carousel\_item\_img\_div{    position: relative;} |
  | 1052 |  | .carousel\_item .count{position:absolute;bottom:0;padding: 3px;background: rgba( 33, 29, 29, 0.39 );border-radius: 10px 10px 0px 0px;color: white;font-size: 11px; right:7px;max-height: 38px;} |
  | 1053 |  | </style>'; |
  | 1054 |  | } elseif ('List' === $display\_type) { |
  | 1055 |  | $print\_html .= '<ul id="' . $style . '">'; |
  | 1056 |  |  |
  | 1057 |  |  |
  | 1058 |  | foreach ($comments['data'] as $comment) { |
  | 1059 |  | $\_\_comment    = substr($comment['commentText'], 0, $character); |
  | 1060 |  | $avatar\_image = isset($comment['pictureUrl']) && '' !== $comment['pictureUrl'] ? $comment['pictureUrl'] : plugins\_url('/images/noavatar.png', \_\_FILE\_\_); |
  | 1061 |  | $comment\_date = 'Yes' === $display\_date ? $this->timeElapsedString(gmdate('Y-m-d H:i:s', $comment['createdTimestamp'])) : ''; |
  | 1062 |  | $url\_profile = "https://vuukle.com/user/by/" . $comment['name'] . "/" . $comment['userId']; |
  | 1063 |  | if ('theme1' === $instance['style']) { |
  | 1064 |  | $print\_html .= '<li><div class="header"><a href="' . $url\_profile . '"><img class="avatar" src="' . $avatar\_image . '"/><span>' . $comment['name'] . '</span></a></div>'; |
  | 1065 |  | $print\_html .= $\_\_comment; |
  | 1066 |  | $print\_html .= '<div class="footer"><a href="' . str\_replace(str\_replace(array('www.', 'http://', 'https://'), '', get\_site\_url()), '', $comment['uri']) . '">' . $comment['title'] . '</a>' . $comment\_date . '</div></li>'; |
  | 1067 |  | } elseif ('theme2' === $instance['style']) { |
  | 1068 |  | wp\_enqueue\_script('comments\_count', plugins\_url('/js/count.js', \_\_FILE\_\_)); |
  | 1069 |  | wp\_localize\_script( |
  | 1070 |  | 'comments\_count', |
  | 1071 |  | 'params', |
  | 1072 |  | array( |
  | 1073 |  | 'host' => str\_replace(array('www.', 'http://', 'https://'), '', get\_site\_url()), |
  | 1074 |  | ) |
  | 1075 |  | ); |
  | 1076 |  | $\_\_comment   = strlen($\_\_comment) > 80 ? substr($\_\_comment, 0, 80) . '...' : $\_\_comment; |
  | 1077 |  | $print\_html .= '<li><div class="header"><a href="' .  $url\_profile . '"><img class="avatar" src="' . $avatar\_image . '"/><span>' . $comment['name'] . '</span></a></div>'; |
  | 1078 |  | $print\_html .= '<strong>( <span style="display: none" class="vuukle-postid" data-postid="' . esc\_attr($comment['articleId']) . '"></span> )<a href="' . str\_replace(str\_replace(array('www.', 'http://', 'https://'), '', get\_site\_url()), '', $comment['uri']) . '">' . $comment['title'] . '</a> :</strong>'; |
  | 1079 |  | $print\_html .= $\_\_comment . $comment\_date . '</li>'; |
  | 1080 |  | } |
  | 1081 |  | } |
  | 1082 |  | $print\_html .= '</ul>'; |
  | 1083 |  | } |
  | 1084 |  |  |
  | 1085 |  | echo $print\_html; // WPCS: XSS ok |
  | 1086 |  | echo $args['after\_widget']; // WPCS: XSS ok |
  | 1087 |  | } |
  | 1088 |  |  |
  | 1089 |  | /\*\* |
  | 1090 |  | \* This function for  time elapsed. |
  | 1091 |  | \* |
  | 1092 |  | \* @param date   $datetime returned date |
  | 1093 |  | \* @param bulean $full     this is a bulean |
  | 1094 |  | \* |
  | 1095 |  | \* @since  1.0.0. |
  | 1096 |  | \* @return string |
  | 1097 |  | \*/ |
  | 1098 |  | protected function timeElapsedString($datetime, $full = false) |
  | 1099 |  | { |
  | 1100 |  |  |
  | 1101 |  | if ($datetime) { |
  | 1102 |  | $now      = new DateTime; |
  | 1103 |  | $ago      = new DateTime($datetime); |
  | 1104 |  | $diff     = $now->diff($ago); |
  | 1105 |  | $diff->w  = floor($diff->d / 7); |
  | 1106 |  | $diff->d -= $diff->w \* 7; |
  | 1107 |  |  |
  | 1108 |  | $string = array( |
  | 1109 |  | 'y' => 'year', |
  | 1110 |  | 'm' => 'month', |
  | 1111 |  | 'w' => 'week', |
  | 1112 |  | 'd' => 'day', |
  | 1113 |  | 'h' => 'hour', |
  | 1114 |  | 'i' => 'minute', |
  | 1115 |  | 's' => 'second', |
  | 1116 |  | ); |
  | 1117 |  | foreach ($string as $k => &$v) { |
  | 1118 |  | if ($diff->$k) { |
  | 1119 |  | $v = $diff->$k . ' ' . $v . ($diff->$k > 1 ? 's' : ''); |
  | 1120 |  | } else { |
  | 1121 |  | unset($string[$k]); |
  | 1122 |  | } |
  | 1123 |  | } |
  | 1124 |  |  |
  | 1125 |  | if (!empty($full)) { |
  | 1126 |  | $string = array\_slice($string, 0, 1); |
  | 1127 |  | } |
  | 1128 |  | return $string ? implode(', ', $string) . ' ago' : 'just now'; |
  | 1129 |  | } else { |
  | 1130 |  | return ''; |
  | 1131 |  | } |
  | 1132 |  | } |
  | 1133 |  |  |
  | 1134 |  | /\*\* |
  | 1135 |  | \* This function creates the form. |
  | 1136 |  | \* |
  | 1137 |  | \* @param array $instance this is an array |
  | 1138 |  | \* |
  | 1139 |  | \* @since  1.0.0. |
  | 1140 |  | \* @return void |
  | 1141 |  | \*/ |
  | 1142 |  | public function form($instance) |
  | 1143 |  | { |
  | 1144 |  | $title        = isset($instance['title']) ? $instance['title'] : 'Recent Comments'; |
  | 1145 |  | $tags         = isset($instance['tags']) ? $instance['tags'] : ''; |
  | 1146 |  | $count        = isset($instance['count']) ? $instance['count'] : '10'; |
  | 1147 |  | $style        = isset($instance['style']) ? $instance['style'] : 'theme1'; |
  | 1148 |  | $character    = isset($instance['character']) ? $instance['character'] : '200'; |
  | 1149 |  | $display\_type = isset($instance['display\_type']) ? $instance['display\_type'] : 'Carousel'; |
  | 1150 |  | $display\_date = isset($instance['display\_date']) ? $instance['display\_date'] : 'No'; |
  | 1151 |  | ?> |
  | 1152 |  | <p> |
  | 1153 |  | <label for="<?php echo esc\_attr($this->get\_field\_id('title')); ?>"><?php echo 'Title:'; ?></label> |
  | 1154 |  | <input class="widefat" id="<?php echo esc\_attr($this->get\_field\_id('title')); ?>" name="<?php echo esc\_attr($this->get\_field\_name('title')); ?>" type="text" value="<?php echo esc\_attr($title); ?>"> |
  | 1155 |  | </p> |
  | 1156 |  | <p> |
  | 1157 |  | <label for="<?php echo esc\_attr($this->get\_field\_id('style')); ?>"><?php echo 'Style:'; ?></label> |
  | 1158 |  | <select class="widefat" id="<?php echo esc\_attr($this->get\_field\_id('style')); ?>" name="<?php echo esc\_attr($this->get\_field\_name('style')); ?>"> |
  | 1159 |  | <option value="theme1" <?php selected($style, 'theme1'); ?>>Theme1</option> |
  | 1160 |  | <option value="theme2" <?php selected($style, 'theme2'); ?>>Theme2</option> |
  | 1161 |  | </select> |
  | 1162 |  | </p> |
  | 1163 |  | <p> |
  | 1164 |  | <label for="<?php echo esc\_attr($this->get\_field\_id('count')); ?>"><?php echo 'Count:'; ?></label> |
  | 1165 |  | <input class="widefat" id="<?php echo esc\_attr($this->get\_field\_id('count')); ?>" name="<?php echo esc\_attr($this->get\_field\_name('count')); ?>" type="text" value="<?php echo esc\_attr($count); ?>"> |
  | 1166 |  | </p> |
  | 1167 |  | <p> |
  | 1168 |  | <label for="<?php echo esc\_attr($this->get\_field\_id('character')); ?>"><?php echo 'Character:'; ?></label> |
  | 1169 |  | <input class="widefat" id="<?php echo esc\_attr($this->get\_field\_id('character')); ?>" name="<?php echo esc\_attr($this->get\_field\_name('character')); ?>" type="text" value="<?php echo esc\_attr($character); ?>"> |
  | 1170 |  | </p> |
  | 1171 |  | <p> |
  | 1172 |  | <p> |
  | 1173 |  | <label for="<?php echo esc\_attr($this->get\_field\_id('tags')); ?>"><?php echo 'Tags:'; ?></label> |
  | 1174 |  | <input class="widefat" id="<?php echo esc\_attr($this->get\_field\_id('tags')); ?>" name="<?php echo esc\_attr($this->get\_field\_name('tags')); ?>" type="text" value="<?php echo esc\_attr($tags); ?>"> |
  | 1175 |  | </p> |
  | 1176 |  | <?php |
  | 1177 |  | } |
  | 1178 |  |  |
  | 1179 |  | /\*\* |
  | 1180 |  | \* This function ensures the update. |
  | 1181 |  | \* |
  | 1182 |  | \* @param array $new\_instance this is a new array |
  | 1183 |  | \* @param array $old\_instance this is an old array |
  | 1184 |  | \* |
  | 1185 |  | \* @since  1.0.0. |
  | 1186 |  | \* @return array |
  | 1187 |  | \*/ |
  | 1188 |  | public function update($new\_instance, $old\_instance) |
  | 1189 |  | { |
  | 1190 |  | $instance                 = array(); |
  | 1191 |  | $instance['title']        = (!empty($new\_instance['title'])) ? strip\_tags($new\_instance['title']) : ''; |
  | 1192 |  | $instance['count']        = (!empty($new\_instance['count'])) ? strip\_tags($new\_instance['count']) : ''; |
  | 1193 |  | $instance['style']        = (!empty($new\_instance['style'])) ? strip\_tags($new\_instance['style']) : ''; |
  | 1194 |  | $instance['tags']         = (!empty($new\_instance['tags'])) ? strip\_tags($new\_instance['tags']) : ''; |
  | 1195 |  | $instance['character']    = (!empty($new\_instance['character'])) ? strip\_tags($new\_instance['character']) : ''; |
  | 1196 |  | $instance['display\_type'] = (!empty($new\_instance['display\_type'])) ? strip\_tags($new\_instance['display\_type']) : ''; |
  | 1197 |  | $instance['display\_date'] = (!empty($new\_instance['display\_date'])) ? strip\_tags($new\_instance['display\_date']) : ''; |
  | 1198 |  | return $instance; |
  | 1199 |  | } |
  | 1200 |  | } |
  | 1201 |  |  |
  | 1202 |  | /\*\* |
  | 1203 |  | \* The widget-specific functionality of the plugin. |
  | 1204 |  | \* |
  | 1205 |  | \* @category   PHP |
  | 1206 |  | \* @package    Free\_Comments\_For\_Wordpress\_Vuukle |
  | 1207 |  | \* @subpackage Free\_Comments\_For\_Wordpress\_Vuukle/admin |
  | 1208 |  | \* @author     Vuukle <info@vuukle.com> |
  | 1209 |  | \* @license    http://www.gnu.org/licenses/gpl-2.0.txt GPL-2.0+ |
  | 1210 |  | \* @link       https://vuukle.com |
  | 1211 |  | \*/ |
  | 1212 |  | class Most\_Commented\_Stories\_Widget extends WP\_Widget |
  | 1213 |  | { |
  | 1214 |  |  |
  | 1215 |  | /\*\* |
  | 1216 |  | \* Initialize the class and set its properties. |
  | 1217 |  | \*/ |
  | 1218 |  | function \_\_construct() |
  | 1219 |  | { |
  | 1220 |  | parent::\_\_construct( |
  | 1221 |  | 'most\_commented\_stories\_widget', |
  | 1222 |  | 'Most Commented Stories', |
  | 1223 |  | array('description' => 'Vuuke Most Commented Stories Widget') |
  | 1224 |  | ); |
  | 1225 |  | } |
  | 1226 |  |  |
  | 1227 |  | /\*\* |
  | 1228 |  | \* This function creates the widget. |
  | 1229 |  | \* |
  | 1230 |  | \* @param array $args     this is an array |
  | 1231 |  | \* @param array $instance this is an array |
  | 1232 |  | \* |
  | 1233 |  | \* @since  1.0.0. |
  | 1234 |  | \* @return void |
  | 1235 |  | \*/ |
  | 1236 |  | public function widget($args, $instance) |
  | 1237 |  | { |
  | 1238 |  | $widget\_id    = $args['widget\_id']; |
  | 1239 |  | $title        = apply\_filters('widget\_title', $instance['title']); |
  | 1240 |  | $hours        = $instance['hours']; |
  | 1241 |  | $count        = $instance['count']; |
  | 1242 |  | $display\_type = $instance['display\_type']; |
  | 1243 |  | echo $args['before\_widget']; // WPCS: XSS ok |
  | 1244 |  |  |
  | 1245 |  | if (!empty($title)) { |
  | 1246 |  | echo $args['before\_title'] . $title . $args['after\_title']; // WPCS: XSS ok |
  | 1247 |  | } |
  | 1248 |  | if (is\_array(get\_option('Vuukle'))) { |
  | 1249 |  | $api = get\_option('Vuukle'); |
  | 1250 |  | $api = $api['AppId']; |
  | 1251 |  | }; |
  | 1252 |  |  |
  | 1253 |  | $url          = 'https://api.vuukle.com/api/v1/Articles/getRecentMostCommentedByHostByTime?host=' . str\_replace(array('www.', 'http://', 'https://'), '', get\_site\_url()) . '&hours=' . $hours . '&start=0&pageSize=' . $count; |
  | 1254 |  | $request\_args = array('headers' => array('Cache-Control' => 'no-cache')); |
  | 1255 |  | $response     = wp\_remote\_retrieve\_body(wp\_safe\_remote\_get($url, $request\_args)); |
  | 1256 |  | $articles     = json\_decode($response, true); |
  | 1257 |  |  |
  | 1258 |  | $print\_html = ''; |
  | 1259 |  | if ('Carousel' === $display\_type) { |
  | 1260 |  | $stories\_widget\_carousel\_items\_width = count($articles) \* 160; |
  | 1261 |  | $print\_html                          = '<div class="stories\_widget\_carousel"> |
  | 1262 |  | <div id="controllers" title="0"> |
  | 1263 |  | <span id="left" class="dashicons dashicons-arrow-left-alt2"></span> |
  | 1264 |  | <span id="right" class="dashicons dashicons-arrow-right-alt2"></span> |
  | 1265 |  | </div> |
  | 1266 |  | <div class="carousel\_items" style="width:' . $stories\_widget\_carousel\_items\_width . 'px;">'; |
  | 1267 |  | foreach ($articles['data'] as $article) { |
  | 1268 |  | $article\_image = isset($article['articleAvatar']) && '404' !== $article['articleAvatar'] ? $article['articleAvatar'] : plugins\_url('/noimage.jpg', \_\_FILE\_\_); |
  | 1269 |  | $print\_html   .= '<div class="carousel\_item"> |
  | 1270 |  | <div class="carousel\_item\_img\_div"> |
  | 1271 |  | <img class="carousel\_item\_img" src="' . $article\_image . '"> |
  | 1272 |  | <div class="count">' . $article['commentCount'] . ' Comments</div> |
  | 1273 |  | </div> |
  | 1274 |  | <div class="title"><a title="' . $article['title'] . '" class="carousel\_item\_link"  href="' . $article['uri'] . '">' . substr($article['title'], 0, 21) . '</a></div> |
  | 1275 |  | </div>'; |
  | 1276 |  | }; |
  | 1277 |  | $print\_html .= '</div></div>'; |
  | 1278 |  | $print\_html .= '<style> |
  | 1279 |  | .stories\_widget\_carousel{width: 160px;height: 200px;overflow: hidden;position: relative;} |
  | 1280 |  | .stories\_widget\_carousel #controllers{} |
  | 1281 |  | .stories\_widget\_carousel #controllers > span {cursor: pointer;} |
  | 1282 |  | .carousel\_items{ position: absolute;left: 0;right: 0; transition: 1s;position: relative;} |
  | 1283 |  | .carousel\_item{display: inline-block;} |
  | 1284 |  | .carousel\_item\_link{ position: absolute;} |
  | 1285 |  | .carousel\_item\_img{width: 160px;height: 130px;} |
  | 1286 |  | .carousel\_item\_img\_div{    position: relative;} |
  | 1287 |  | .carousel\_item .count{position:absolute;bottom:0;padding: 3px;background: rgba( 33, 29, 29, 0.39 );border-radius: 10px 10px 0px 0px;color: white;font-size: 11px; right:7px;max-height: 38px;} |
  | 1288 |  | </style>'; |
  | 1289 |  | } elseif ('List' === $display\_type) { |
  | 1290 |  | $print\_html .= '<ul>'; |
  | 1291 |  | foreach ($articles['data'] as $article) { |
  | 1292 |  | echo '<li><img src="' . $article['articleAvatar'] . '"/>' . $article['commentCount'] . ' comments on <a href="' . $article['uri'] . '">' . $article['title'] . '</a>'; // WPCS: XSS ok |
  | 1293 |  | } |
  | 1294 |  | $print\_html .= '</ul>'; |
  | 1295 |  | } |
  | 1296 |  |  |
  | 1297 |  | echo $print\_html; // WPCS: XSS ok |
  | 1298 |  | echo $args['after\_widget']; // WPCS: XSS ok |
  | 1299 |  | } |
  | 1300 |  |  |
  | 1301 |  | /\*\* |
  | 1302 |  | \* This function creates the form. |
  | 1303 |  | \* |
  | 1304 |  | \* @param array $instance this is an array |
  | 1305 |  | \* |
  | 1306 |  | \* @since  1.0.0. |
  | 1307 |  | \* @return string |
  | 1308 |  | \*/ |
  | 1309 |  | public function form($instance) |
  | 1310 |  | { |
  | 1311 |  | $title        = isset($instance['title']) ? $instance['title'] : 'Most Commented Stories'; |
  | 1312 |  | $hours        = ($instance['hours']) ? $instance['hours'] : '12'; |
  | 1313 |  | $count        = isset($instance['count']) ? $instance['count'] : '10'; |
  | 1314 |  | $display\_type = isset($instance['display\_type']) ? $instance['display\_type'] : '10'; |
  | 1315 |  | ?> |
  | 1316 |  | <p> |
  | 1317 |  | <label for="<?php echo esc\_attr($this->get\_field\_id('title')); ?>"><?php echo 'Title:'; ?></label> |
  | 1318 |  | <input class="widefat" id="<?php echo esc\_attr($this->get\_field\_id('title')); ?>" name="<?php echo esc\_attr($this->get\_field\_name('title')); ?>" type="text" value="<?php echo esc\_attr($title); ?>"> |
  | 1319 |  | </p> |
  | 1320 |  | <p> |
  | 1321 |  | <label for="<?php echo esc\_attr($this->get\_field\_id('count')); ?>"><?php echo 'Count:'; ?></label> |
  | 1322 |  | <input class="widefat" id="<?php echo esc\_attr($this->get\_field\_id('count')); ?>" name="<?php echo esc\_attr($this->get\_field\_name('count')); ?>" type="text" value="<?php echo esc\_attr($count); ?>"> |
  | 1323 |  | </p> |
  | 1324 |  | <p> |
  | 1325 |  | <label for="<?php echo esc\_attr($this->get\_field\_id('hours')); ?>"><?php echo 'Hours:'; ?></label> |
  | 1326 |  | <select name="<?php echo esc\_attr($this->get\_field\_name('hours')); ?>"> |
  | 1327 |  | <?php |
  | 1328 |  | $hour\_options = array('12', '24', '48', '96', '200', '500', '1000'); |
  | 1329 |  | foreach ($hour\_options as $hour\_option) : |
  | 1330 |  | ?> |
  | 1331 |  | <option <?php echo $hours === $hour\_option ? 'selected' : ''; // WPCS: XSS ok |
  | 1332 |  | ?> value="<?php echo $hour\_option; // WPCS: XSS ok |
  | 1333 |  | ?>"><?php echo $hour\_option; // WPCS: XSS ok |
  | 1334 |  | ?></option> |
  | 1335 |  | <?php endforeach; ?> |
  | 1336 |  | </select> |
  | 1337 |  | </p> |
  | 1338 |  | <p> |
  | 1339 |  | <label for="<?php echo esc\_attr($this->get\_field\_id('display\_type')); ?>"><?php echo 'Display Type:'; ?></label> |
  | 1340 |  | <select name="<?php echo esc\_attr($this->get\_field\_name('display\_type')); ?>"> |
  | 1341 |  | <option <?php echo 'Carousel' === $display\_type ? 'selected' : ''; ?> value="Carousel">Carousel</option> |
  | 1342 |  | <option <?php echo 'List' === $display\_type ? 'selected' : ''; ?> value="List">List</option> |
  | 1343 |  | </select> |
  | 1344 |  | </p> |
  | 1345 |  | <?php |
  | 1346 |  | } |
  | 1347 |  |  |
  | 1348 |  | /\*\* |
  | 1349 |  | \* This function ensures the update. |
  | 1350 |  | \* |
  | 1351 |  | \* @param array $new\_instance this is a new array |
  | 1352 |  | \* @param array $old\_instance this is an old array |
  | 1353 |  | \* |
  | 1354 |  | \* @since  1.0.0. |
  | 1355 |  | \* @return array |
  | 1356 |  | \*/ |
  | 1357 |  | public function update($new\_instance, $old\_instance) |
  | 1358 |  | { |
  | 1359 |  | $instance                 = array(); |
  | 1360 |  | $instance['title']        = (!empty($new\_instance['title'])) ? strip\_tags($new\_instance['title']) : ''; |
  | 1361 |  | $instance['count']        = (!empty($new\_instance['count'])) ? strip\_tags($new\_instance['count']) : ''; |
  | 1362 |  | $instance['hours']        = (!empty($new\_instance['hours'])) ? strip\_tags($new\_instance['hours']) : ''; |
  | 1363 |  | $instance['display\_type'] = (!empty($new\_instance['display\_type'])) ? strip\_tags($new\_instance['display\_type']) : ''; |
  | 1364 |  | return $instance; |
  | 1365 |  | } |
  | 1366 |  | } |
  |  | 905 |  |
* ## [free-comments-for-wordpress-vuukle/trunk/admin/js/free-comments-for-wordpress-vuukle-admin.js](/changeset/2553337/free-comments-for-wordpress-vuukle/trunk/admin/js/free-comments-for-wordpress-vuukle-admin.js "Show the changeset 2553337 restricted to free-comments-for-wordpress-vuukle/trunk/admin/js/free-comments-for-wordpress-vuukle-admin.js")

  | [r2533938](/browser/free-comments-for-wordpress-vuukle/trunk/admin/js/free-comments-for-wordpress-vuukle-admin.js?rev=2533938#L28 "Show revision 2533938 of this file in browser") | [r2553337](/browser/free-comments-for-wordpress-vuukle/trunk/admin/js/free-comments-for-wordpress-vuukle-admin.js?rev=2553337#L28 "Show revision 2553337 of this file in browser") |  |
  | --- | --- | --- |
  | 28 | 28 | \* practising this, we should strive to set a better example in our own work. |
  | 29 | 29 | \*/ |
  | 30 |  | ~~var url = "/wp-admin/admin-ajax.php";~~ |
  | 31 | 30 | document.addEventListener("DOMContentLoaded", function () { |
  | 32 |  | const cbox1 = document.getElementsByClassName("nav-tab"); |
  | 33 |  | for (let i = 0; i < cbox1.length; i++) { |
  | 34 |  | cbox1[i].addEventListener("click", function (event) { |
  | 35 |  | let elemenetID = event.currentTarget.getAttribute("href"); |
  | 36 |  | let active\_tab = event.currentTarget.getAttribute("data-tab"); |
  | 37 |  | document.getElementById("hidden\_tab").value = active\_tab; |
  | 38 |  | document |
  | 39 |  | .querySelectorAll(".nav-tab-wrapper a.nav-tab") |
  | 40 |  | .forEach((element) => { |
  | 41 |  | if (element.classList.contains("nav-tab-active")) { |
  | 42 |  | element.classList.remove("nav-tab-active"); |
  | 43 |  | } |
  | 44 |  | }); |
  | 45 |  | event.currentTarget.classList.add("nav-tab-active"); |
  | 46 |  | document.querySelectorAll(".vuukle-tab-content").forEach((element) => { |
  | 47 |  | if (element.classList.contains("vuukle-tab-content-active")) { |
  | 48 |  | element.classList.remove("vuukle-tab-content-active"); |
  |  | 31 | const cbox1 = document.getElementsByClassName("nav-tab"); |
  |  | 32 | for (let i = 0; i < cbox1.length; i++) { |
  |  | 33 | cbox1[i].addEventListener("click", function (event) { |
  |  | 34 | let elemenetID = event.currentTarget.getAttribute("href"); |
  |  | 35 | let active\_tab = event.currentTarget.getAttribute("data-tab"); |
  |  | 36 | document.getElementById("hidden\_tab").value = active\_tab; |
  |  | 37 | document |
  |  | 38 | .querySelectorAll(".nav-tab-wrapper a.nav-tab") |
  |  | 39 | .forEach((element) => { |
  |  | 40 | if (element.classList.contains("nav-tab-active")) { |
  |  | 41 | element.classList.remove("nav-tab-active"); |
  |  | 42 | } |
  |  | 43 | }); |
  |  | 44 | event.currentTarget.classList.add("nav-tab-active"); |
  |  | 45 | document.querySelectorAll(".vuukle-tab-content").forEach((element) => { |
  |  | 46 | if (element.classList.contains("vuukle-tab-content-active")) { |
  |  | 47 | element.classList.remove("vuukle-tab-content-active"); |
  |  | 48 | } |
  |  | 49 | }); |
  |  | 50 | document.querySelectorAll("[name='vuukle-tab']").value = active\_tab; |
  |  | 51 | document |
  |  | 52 | .querySelector(".vuukle-tab-content" + elemenetID) |
  |  | 53 | .classList.add("vuukle-tab-content-active"); |
  |  | 54 | event.preventDefault(); |
  |  | 55 | }); |
  |  | 56 | } |
  |  | 57 |  |
  |  | 58 | document |
  |  | 59 | .querySelector(".vuukle\_popup\_close") |
  |  | 60 | ?.addEventListener("click", function (event) { |
  |  | 61 | event.currentTarget.parentElement.parentElement.style.visibility = |
  |  | 62 | "hidden"; |
  |  | 63 | }); |
  |  | 64 | document |
  |  | 65 | .querySelector("#export\_button2") |
  |  | 66 | ?.addEventListener("click", function (event) { |
  |  | 67 | var amount\_comments = document.querySelector(".amount\_comments").value; |
  |  | 68 | var thisButton = event.currentTarget; |
  |  | 69 | thisButton.style.display = "none"; |
  |  | 70 | document.querySelectorAll(".loader-animation")[0].style.visibility = |
  |  | 71 | "visible"; |
  |  | 72 | loadXMLDoc(); |
  |  | 73 |  |
  |  | 74 | function loadXMLDoc() { |
  |  | 75 | var offset = thisButton.getAttribute("offset"); |
  |  | 76 | var xmlhttp = new XMLHttpRequest(); |
  |  | 77 | let cache = false; |
  |  | 78 | var params = { |
  |  | 79 | action: "export\_comments\_plugin\_page", |
  |  | 80 | offset: offset, |
  |  | 81 | export\_xml: 2, |
  |  | 82 | amount\_comments: amount\_comments, |
  |  | 83 | \_wpnonce: fcfwv\_admin\_vars.nonce, |
  |  | 84 | }; |
  |  | 85 | var queryString = Object.keys(params) |
  |  | 86 | .map(function (key) { |
  |  | 87 | return key + "=" + params[key]; |
  |  | 88 | }) |
  |  | 89 | .join("&"); |
  |  | 90 | xmlhttp.open("GET", fcfwv\_admin\_vars.ajax\_url + "?" + queryString, cache); |
  |  | 91 | xmlhttp.send(); |
  |  | 92 | if (xmlhttp.readyState == XMLHttpRequest.DONE) { |
  |  | 93 | // XMLHttpRequest.DONE == 4 |
  |  | 94 | if (xmlhttp.status == 200) { |
  |  | 95 | var result = JSON.parse(xmlhttp.response); |
  |  | 96 | if (result.result > 0) { |
  |  | 97 | thisButton.setAttribute("offset", result.result); |
  |  | 98 | loadXMLDoc(); |
  |  | 99 | } else if (result.result == 0) { |
  |  | 100 | thisButton.setAttribute("offset", result.result); |
  |  | 101 | document.querySelector(".loader-animation").style.visibility = |
  |  | 102 | "hidden"; |
  |  | 103 | thisButton.style.display = "inline-block"; |
  |  | 104 | window.location.assign(result.link); |
  |  | 105 | } else if (result.result < 0) { |
  |  | 106 | alert(result.message); |
  |  | 107 | } |
  |  | 108 | } |
  |  | 109 | } |
  |  | 110 | } |
  |  | 111 | }); |
  |  | 112 |  |
  |  | 113 | document |
  |  | 114 | .querySelector("input[name=embed\_comments]") |
  |  | 115 | ?.addEventListener("click", function (event) { |
  |  | 116 | let htmlElem = document.querySelector(".embed\_fields input[type=text]"); |
  |  | 117 | htmlElem.classList.remove("reg"); |
  |  | 118 | htmlElem.style.boxShadow = "none"; |
  |  | 119 | let nextSibling = htmlElem.parentElement.nextElementSibling; |
  |  | 120 | while (nextSibling) { |
  |  | 121 | nextSibling = element.style.boxShadow = "none"; |
  |  | 122 | } |
  |  | 123 | var nodes = []; |
  |  | 124 | var element = event.currentTarget; |
  |  | 125 | nodes.push(element); |
  |  | 126 | while (element.parentNode) { |
  |  | 127 | nodes.unshift(element.parentNode); |
  |  | 128 | element = element.parentNode; |
  |  | 129 | } |
  |  | 130 | let filteredNodes = nodes.filter((el) => el.tagName === "td"); |
  |  | 131 | filteredNodes.forEach((el) => { |
  |  | 132 | el.querySelector("input[type=text]").classList.add("reg"); |
  |  | 133 | }); |
  |  | 134 | }); |
  |  | 135 | const addEventForChild = function (parent, eventName, childSelector, cb) { |
  |  | 136 | parent.addEventListener(eventName, function (event) { |
  |  | 137 | const clickedElement = event.target, |
  |  | 138 | matchingChild = clickedElement.closest(childSelector); |
  |  | 139 | if (matchingChild) cb(matchingChild); |
  |  | 140 | }); |
  |  | 141 | }; |
  |  | 142 |  |
  |  | 143 | addEventForChild(document, "click", "input.reg", function () { |
  |  | 144 | let nextSibling = querySelectorAll( |
  |  | 145 | ".embed\_fields input[type=text]" |
  |  | 146 | ).nextElementSibling; |
  |  | 147 | while (nextSibling) { |
  |  | 148 | nextSibling = element.style.boxShadow = "none"; |
  | 49 | 149 | } |
  | 50 |  | ~~});~~ |
  | 51 |  | ~~document.querySelectorAll("[name='vuukle-tab']").value = active\_tab;~~ |
  | 52 |  | ~~document~~ |
  | 53 |  | ~~.querySelector(".vuukle-tab-content" + elemenetID)~~ |
  | 54 |  | ~~.classList.add("vuukle-tab-content-active");~~ |
  | 55 |  | ~~event.preventDefault();~~ |
  | 56 | 150 | }); |
  | 57 |  | } |
  | 58 |  |  |
  | 59 |  | document |
  | 60 |  | .querySelector(".vuukle\_popup\_close") |
  | 61 |  | ?.addEventListener("click", function (event) { |
  | 62 |  | event.currentTarget.parentElement.parentElement.style.visibility = |
  | 63 |  | "hidden"; |
  |  | 151 |  |
  |  | 152 | document |
  |  | 153 | .querySelector("input[name=embed\_emotes]") |
  |  | 154 | ?.addEventListener("click", function (event) { |
  |  | 155 | let el = document.querySelector(".embed\_fields\_emotes input[type=text]"); |
  |  | 156 | el.classList.remove("reg1"); |
  |  | 157 | var result = [], |
  |  | 158 | node = el.parentNode.firstChild; |
  |  | 159 | while (node) { |
  |  | 160 | if (node !== this && node.nodeType === Node.ELEMENT\_NODE) |
  |  | 161 | result.push(node); |
  |  | 162 | node = node.nextElementSibling || node.nextSibling; |
  |  | 163 | } |
  |  | 164 | result.forEach((element) => (element.style.boxShadow = "none")); |
  |  | 165 | var nodes = []; |
  |  | 166 | var element = event.currentTarget; |
  |  | 167 | nodes.push(element); |
  |  | 168 | while (element.parentNode) { |
  |  | 169 | nodes.unshift(element.parentNode); |
  |  | 170 | element = element.parentNode; |
  |  | 171 | } |
  |  | 172 | let filteredNodes = nodes.filter((el) => el.tagName === "td"); |
  |  | 173 | filteredNodes.forEach((el) => { |
  |  | 174 | el.querySelector("input[type=text]").classList.add("reg1"); |
  |  | 175 | }); |
  |  | 176 | }); |
  |  | 177 |  |
  |  | 178 | addEventForChild(document, "click", "input.reg", function () { |
  |  | 179 | let nextSibling = querySelectorAll( |
  |  | 180 | ".embed\_fields input[type=text]" |
  |  | 181 | ).nextElementSibling; |
  |  | 182 | while (nextSibling) { |
  |  | 183 | nextSibling = element.style.boxShadow = "none"; |
  |  | 184 | } |
  | 64 | 185 | }); |
  | 65 |  | document |
  | 66 |  | .querySelector("#export\_button2") |
  | 67 |  | ?.addEventListener("click", function (event) { |
  | 68 |  | var amount\_comments = document.querySelector(".amount\_comments").value; |
  | 69 |  | var thisButton = event.currentTarget; |
  | 70 |  | thisButton.style.display = "none"; |
  | 71 |  | document.querySelectorAll(".loader-animation")[0].style.visibility = |
  | 72 |  | "visible"; |
  | 73 |  | loadXMLDoc(); |
  | 74 |  | function loadXMLDoc() { |
  | 75 |  | var offset = thisButton.getAttribute("offset"); |
  | 76 |  | var xmlhttp = new XMLHttpRequest(); |
  | 77 |  | let cache = false; |
  | 78 |  | var params = { |
  | 79 |  | action: "export\_comments\_plugin\_page", |
  | 80 |  | offset: offset, |
  | 81 |  | export\_xml: 2, |
  | 82 |  | amount\_comments: amount\_comments, |
  | 83 |  | \_wpnonce: `<?php echo esc\_attr(wp\_create\_nonce('export\_xml2')); ?>`, |
  | 84 |  | }; |
  | 85 |  | var queryString = Object.keys(params) |
  | 86 |  | .map(function (key) { |
  | 87 |  | return key + "=" + params[key]; |
  | 88 |  | }) |
  | 89 |  | .join("&"); |
  | 90 |  | xmlhttp.open("GET", url + "?" + queryString, cache); |
  | 91 |  | xmlhttp.send(); |
  | 92 |  | if (xmlhttp.readyState == XMLHttpRequest.DONE) { |
  | 93 |  | // XMLHttpRequest.DONE == 4 |
  | 94 |  | if (xmlhttp.status == 200) { |
  | 95 |  | var result = JSON.parse(xmlhttp.response); |
  | 96 |  | if (result.result > 0) { |
  | 97 |  | thisButton.setAttribute("offset", result.result); |
  | 98 |  | loadXMLDoc(); |
  | 99 |  | } else if (result.result == 0) { |
  | 100 |  | thisButton.setAttribute("offset", result.result); |
  | 101 |  | document.querySelector(".loader-animation").style.visibility = |
  | 102 |  | "hidden"; |
  | 103 |  | thisButton.style.display = "inline-block"; |
  | 104 |  | window.location.assign(result.link); |
  | 105 |  | } else if (result.result < 0) { |
  | 106 |  | alert(result.message); |
  | 107 |  | } |
  | 108 |  | } |
  | 109 |  | } |
  | 110 |  | } |
  | 111 |  | }); |
  | 112 |  |  |
  | 113 |  | document |
  | 114 |  | .querySelector("input[name=embed\_comments]") |
  | 115 |  | ?.addEventListener("click", function (event) { |
  | 116 |  | let htmlElem = document.querySelector(".embed\_fields input[type=text]"); |
  | 117 |  | htmlElem.classList.remove("reg"); |
  | 118 |  | htmlElem.style.boxShadow = "none"; |
  | 119 |  | let nextSibling = htmlElem.parentElement.nextElementSibling; |
  | 120 |  | while (nextSibling) { |
  | 121 |  | nextSibling = element.style.boxShadow = "none"; |
  | 122 |  | } |
  | 123 |  | var nodes = []; |
  | 124 |  | var element = event.currentTarget; |
  | 125 |  | nodes.push(element); |
  | 126 |  | while (element.parentNode) { |
  | 127 |  | nodes.unshift(element.parentNode); |
  | 128 |  | element = element.parentNode; |
  | 129 |  | } |
  | 130 |  | let filteredNodes = nodes.filter((el) => el.tagName === "td"); |
  | 131 |  | filteredNodes.forEach((el) => { |
  | 132 |  | el.querySelector("input[type=text]").classList.add("reg"); |
  | 133 |  | }); |
  | 134 |  | }); |
  | 135 |  | const addEventForChild = function (parent, eventName, childSelector, cb) { |
  | 136 |  | parent.addEventListener(eventName, function (event) { |
  | 137 |  | const clickedElement = event.target, |
  | 138 |  | matchingChild = clickedElement.closest(childSelector); |
  | 139 |  | if (matchingChild) cb(matchingChild); |
  | 140 |  | }); |
  | 141 |  | }; |
  | 142 |  |  |
  | 143 |  | addEventForChild(document, "click", "input.reg", function () { |
  | 144 |  | let nextSibling = querySelectorAll( |
  | 145 |  | ".embed\_fields input[type=text]" |
  | 146 |  | ).nextElementSibling; |
  | 147 |  | while (nextSibling) { |
  | 148 |  | nextSibling = element.style.boxShadow = "none"; |
  |  | 186 |  |
  |  | 187 | document |
  |  | 188 | .querySelector("#save-settings") |
  |  | 189 | ?.addEventListener("click", function (event) { |
  |  | 190 | if (document.querySelectorAll("input.reg").length > 0) { |
  |  | 191 | if (!document.querySelector("input.reg").value) { |
  |  | 192 | let nextSibling = |
  |  | 193 | document.querySelector("input.reg").nextElementSibling; |
  |  | 194 | while (nextSibling) { |
  |  | 195 | nextSibling = element.style.boxShadow = "0px 0px 3px 2px red"; |
  |  | 196 | } |
  |  | 197 |  |
  |  | 198 | document.querySelector("html, body").animate( |
  |  | 199 | { |
  |  | 200 | scrollTop: $("input.reg").offset().top - 150, |
  |  | 201 | }, |
  |  | 202 | 1000 |
  |  | 203 | ); |
  |  | 204 | } |
  |  | 205 | } |
  |  | 206 |  |
  |  | 207 | if (document.querySelectorAll("input.reg1").length > 0) { |
  |  | 208 | if (!document.querySelector("input.reg1").value) { |
  |  | 209 | let nextSibling = |
  |  | 210 | document.querySelector("input.reg1").nextElementSibling; |
  |  | 211 | while (nextSibling) { |
  |  | 212 | nextSibling = element.style.boxShadow = "0px 0px 3px 2px red"; |
  |  | 213 | } |
  |  | 214 | document.querySelector("html, body").animate( |
  |  | 215 | { |
  |  | 216 | scrollTop: |
  |  | 217 | document.querySelector("input.reg1").getBoundingClientRect() |
  |  | 218 | .top - 150, |
  |  | 219 | }, |
  |  | 220 | 1000 |
  |  | 221 | ); |
  |  | 222 | } |
  |  | 223 | } |
  |  | 224 |  |
  |  | 225 | if ( |
  |  | 226 | (!document.querySelector("input.reg")?.value && |
  |  | 227 | document.querySelectorAll("input.reg").length > 0) || |
  |  | 228 | (!document.querySelector("input.reg1")?.value && |
  |  | 229 | document.querySelectorAll("input.reg1").length > 0) |
  |  | 230 | ) { |
  |  | 231 | return false; |
  |  | 232 | } |
  |  | 233 |  |
  |  | 234 | document.getElementById('action').value = 'VuukleSaveSettings'; |
  |  | 235 | }); |
  |  | 236 |  |
  |  | 237 | document |
  |  | 238 | .querySelector("#save\_settings\_ads") |
  |  | 239 | ?.addEventListener("click", function (event) { |
  |  | 240 | if (document.querySelectorAll("input.reg").length > 0) { |
  |  | 241 | if (!document.querySelector("input.reg").value) { |
  |  | 242 | let nextSibling = |
  |  | 243 | document.querySelector("input.reg").nextElementSibling; |
  |  | 244 |  |
  |  | 245 | while (nextSibling) { |
  |  | 246 | nextSibling = element.style.boxShadow = "0px 0px 3px 2px red"; |
  |  | 247 | } |
  |  | 248 |  |
  |  | 249 | document.querySelector("html, body").animate( |
  |  | 250 | { |
  |  | 251 | scrollTop: $("input.reg").offset().top - 150, |
  |  | 252 | }, |
  |  | 253 | 1000 |
  |  | 254 | ); |
  |  | 255 | } |
  |  | 256 | } |
  |  | 257 |  |
  |  | 258 | if (document.querySelectorAll("input.reg1").length > 0) { |
  |  | 259 | if (!document.querySelector("input.reg1").value) { |
  |  | 260 | let nextSibling = |
  |  | 261 | document.querySelector("input.reg1").nextElementSibling; |
  |  | 262 | while (nextSibling) { |
  |  | 263 | nextSibling = element.style.boxShadow = "0px 0px 3px 2px red"; |
  |  | 264 | } |
  |  | 265 | document.querySelector("html, body").animate( |
  |  | 266 | { |
  |  | 267 | scrollTop: |
  |  | 268 | document.querySelector("input.reg1").getBoundingClientRect() |
  |  | 269 | .top - 150, |
  |  | 270 | }, |
  |  | 271 | 1000 |
  |  | 272 | ); |
  |  | 273 | } |
  |  | 274 | } |
  |  | 275 |  |
  |  | 276 | if ( |
  |  | 277 | (!document.querySelector("input.reg")?.value && |
  |  | 278 | document.querySelectorAll("input.reg").length > 0) || |
  |  | 279 | (!document.querySelector("input.reg1")?.value && |
  |  | 280 | document.querySelectorAll("input.reg1").length > 0) |
  |  | 281 | ) { |
  |  | 282 | return false; |
  |  | 283 | } |
  |  | 284 | }); |
  |  | 285 | const cbox = document.querySelectorAll('input[name="reset"]'); |
  |  | 286 | for (let i = 0; i < cbox.length; i++) { |
  |  | 287 | cbox[i].addEventListener("click", function (event) { |
  |  | 288 | if (!confirm("Are you sure you want to reset to default settings?")) { |
  |  | 289 | event.preventDefault(); |
  |  | 290 |  |
  |  | 291 | return false; |
  |  | 292 | } |
  |  | 293 | document.getElementById('action').value = 'VuukleResetSettings'; |
  |  | 294 | }); |
  | 149 | 295 | } |
  | 150 |  | ~~});~~ |
  | 151 |  |  |
  | 152 |  | ~~document~~ |
  | 153 |  | ~~.querySelector("input[name=embed\_emotes]")~~ |
  | 154 |  | ~~?.addEventListener("click", function (event) {~~ |
  | 155 |  | ~~let el = document.querySelector(".embed\_fields\_emotes input[type=text]");~~ |
  | 156 |  | ~~el.classList.remove("reg1");~~ |
  | 157 |  | ~~var result = [],~~ |
  | 158 |  | ~~node = el.parentNode.firstChild;~~ |
  | 159 |  | ~~while (node) {~~ |
  | 160 |  | ~~if (node !== this && node.nodeType === Node.ELEMENT\_NODE)~~ |
  | 161 |  | ~~result.push(node);~~ |
  | 162 |  | ~~node = node.nextElementSibling || node.nextSibling;~~ |
  | 163 |  | ~~}~~ |
  | 164 |  | ~~result.forEach((element) => (element.style.boxShadow = "none"));~~ |
  | 165 |  | ~~var nodes = [];~~ |
  | 166 |  | ~~var element = event.currentTarget;~~ |
  | 167 |  | ~~nodes.push(element);~~ |
  | 168 |  | ~~while (element.parentNode) {~~ |
  | 169 |  | ~~nodes.unshift(element.parentNode);~~ |
  | 170 |  | ~~element = element.parentNode;~~ |
  | 171 |  | ~~}~~ |
  | 172 |  | ~~let filteredNodes = nodes.filter((el) => el.tagName === "td");~~ |
  | 173 |  | ~~filteredNodes.forEach((el) => {~~ |
  | 174 |  | ~~el.querySelector("input[type=text]").classList.add("reg1");~~ |
  | 175 |  | ~~});~~ |
  | 176 |  | ~~});~~ |
  | 177 |  |  |
  | 178 |  | ~~addEventForChild(document, "click", "input.reg", function () {~~ |
  | 179 |  | ~~let nextSibling = querySelectorAll(~~ |
  | 180 |  | ~~".embed\_fields input[type=text]"~~ |
  | 181 |  | ~~).nextElementSibling;~~ |
  | 182 |  | ~~while (nextSibling) {~~ |
  | 183 |  | ~~nextSibling = element.style.boxShadow = "none";~~ |
  | 184 |  | ~~}~~ |
  | 185 |  | ~~});~~ |
  | 186 |  |  |
  | 187 |  | ~~window.addEventListener("load", function (event) {~~ |
  | 188 |  | ~~if (window.location.pathname == "/wp-admin/admin.php") {~~ |
  | 189 |  | ~~if (~~ |
  | 190 |  | ~~document~~ |
  | 191 |  | ~~.getElementById("tab10")~~ |
  | 192 |  | ~~.classList.contains("vuukle-tab-content-active")~~ |
  | 193 |  | ~~) {~~ |
  | 194 |  | ~~document.getElementById("vis").style.display = "none";~~ |
  | 195 |  | ~~} else {~~ |
  | 196 |  | ~~document.getElementById("vis").style.display = "block";~~ |
  | 197 |  | ~~}~~ |
  | 198 |  | ~~}~~ |
  | 199 |  | ~~});~~ |
  | 200 |  |  |
  | 201 |  | ~~document~~ |
  | 202 |  | ~~.querySelector("#save-settings")~~ |
  | 203 |  | ~~?.addEventListener("click", function (event) {~~ |
  | 204 |  | ~~var hiddenTab = document.querySelector("#hidden\_tab").value;~~ |
  | 205 |  | ~~var hiddenUrl = document.querySelector("#hidden\_url").value;~~ |
  | 206 |  | ~~if(hiddenTab !== 'tab10'){~~ |
  | 207 |  | ~~document~~ |
  | 208 |  | ~~.querySelector("#vuukle-settings-form")~~ |
  | 209 |  | ~~.setAttribute("action", hiddenUrl + "&vuukle\_tab=" + hiddenTab);~~ |
  | 210 |  | ~~if (document.querySelectorAll("input.reg").length > 0) {~~ |
  | 211 |  | ~~if (!document.querySelector("input.reg").value) {~~ |
  | 212 |  | ~~let nextSibling =~~ |
  | 213 |  | ~~document.querySelector("input.reg").nextElementSibling;~~ |
  | 214 |  | ~~while (nextSibling) {~~ |
  | 215 |  | ~~nextSibling = element.style.boxShadow = "0px 0px 3px 2px red";~~ |
  | 216 |  | ~~}~~ |
  | 217 |  |  |
  | 218 |  | ~~document.querySelector("html, body").animate(~~ |
  | 219 |  | ~~{~~ |
  | 220 |  | ~~scrollTop: $("input.reg").offset().top - 150,~~ |
  | 221 |  | ~~},~~ |
  | 222 |  | ~~1000~~ |
  | 223 |  | ~~);~~ |
  | 224 |  | ~~}~~ |
  | 225 |  | ~~}~~ |
  | 226 |  |  |
  | 227 |  | ~~if (document.querySelectorAll("input.reg1").length > 0) {~~ |
  | 228 |  | ~~if (!document.querySelector("input.reg1").value) {~~ |
  | 229 |  | ~~let nextSibling =~~ |
  | 230 |  | ~~document.querySelector("input.reg1").nextElementSibling;~~ |
  | 231 |  | ~~while (nextSibling) {~~ |
  | 232 |  | ~~nextSibling = element.style.boxShadow = "0px 0px 3px 2px red";~~ |
  | 233 |  | ~~}~~ |
  | 234 |  | ~~document.querySelector("html, body").animate(~~ |
  | 235 |  | ~~{~~ |
  | 236 |  | ~~scrollTop:~~ |
  | 237 |  | ~~document.querySelector("input.reg1").getBoundingClientRect()~~ |
  | 238 |  | ~~.top - 150,~~ |
  | 239 |  | ~~},~~ |
  | 240 |  | ~~1000~~ |
  | 241 |  | ~~);~~ |
  | 242 |  | ~~}~~ |
  | 243 |  | ~~}~~ |
  | 244 |  |  |
  | 245 |  | ~~if (~~ |
  | 246 |  | ~~(!document.querySelector("input.reg")?.value &&~~ |
  | 247 |  | ~~document.querySelectorAll("input.reg").length > 0) ||~~ |
  | 248 |  | ~~(!document.querySelector("input.reg1")?.value &&~~ |
  | 249 |  | ~~document.querySelectorAll("input.reg1").length > 0)~~ |
  | 250 |  | ~~) {~~ |
  | 251 |  | ~~return false;~~ |
  | 252 |  | ~~}~~ |
  | 253 |  | ~~}~~ |
  | 254 |  | ~~});~~ |
  | 255 |  |  |
  | 256 |  | ~~document~~ |
  | 257 |  | ~~.querySelector("#save\_settings\_ads")~~ |
  | 258 |  | ~~?.addEventListener("click", function (event) {~~ |
  | 259 |  | ~~var hiddenTab = document.querySelector("#hidden\_tab").value;~~ |
  | 260 |  | ~~var hiddenUrl = document.querySelector("#hidden\_url").value;~~ |
  | 261 |  |  |
  | 262 |  | ~~document~~ |
  | 263 |  | ~~.querySelector("#vuukle-settings-form1")~~ |
  | 264 |  | ~~.setAttribute("action", hiddenUrl + "&vuukle\_tab=" + hiddenTab);~~ |
  | 265 |  | ~~if (document.querySelectorAll("input.reg").length > 0) {~~ |
  | 266 |  | ~~if (!document.querySelector("input.reg").value) {~~ |
  | 267 |  | ~~let nextSibling =~~ |
  | 268 |  | ~~document.querySelector("input.reg").nextElementSibling;~~ |
  | 269 |  |  |
  | 270 |  | ~~while (nextSibling) {~~ |
  | 271 |  | ~~nextSibling = element.style.boxShadow = "0px 0px 3px 2px red";~~ |
  | 272 |  | ~~}~~ |
  | 273 |  |  |
  | 274 |  | ~~document.querySelector("html, body").animate(~~ |
  | 275 |  | ~~{~~ |
  | 276 |  | ~~scrollTop: $("input.reg").offset().top - 150,~~ |
  | 277 |  | ~~},~~ |
  | 278 |  | ~~1000~~ |
  | 279 |  | ~~);~~ |
  | 280 |  | ~~}~~ |
  | 281 |  | ~~}~~ |
  | 282 |  |  |
  | 283 |  | ~~if (document.querySelectorAll("input.reg1").length > 0) {~~ |
  | 284 |  | ~~if (!document.querySelector("input.reg1").value) {~~ |
  | 285 |  | ~~let nextSibling =~~ |
  | 286 |  | ~~document.querySelector("input.reg1").nextElementSibling;~~ |
  | 287 |  | ~~while (nextSibling) {~~ |
  | 288 |  | ~~nextSibling = element.style.boxShadow = "0px 0px 3px 2px red";~~ |
  | 289 |  | ~~}~~ |
  | 290 |  | ~~document.querySelector("html, body").animate(~~ |
  | 291 |  | ~~{~~ |
  | 292 |  | ~~scrollTop:~~ |
  | 293 |  | ~~document.querySelector("input.reg1").getBoundingClientRect()~~ |
  | 294 |  | ~~.top - 150,~~ |
  | 295 |  | ~~},~~ |
  | 296 |  | ~~1000~~ |
  | 297 |  | ~~);~~ |
  | 298 |  | ~~}~~ |
  | 299 |  | ~~}~~ |
  | 300 |  |  |
  | 301 |  | ~~if (~~ |
  | 302 |  | ~~(!document.querySelector("input.reg")?.value &&~~ |
  | 303 |  | ~~document.querySelectorAll("input.reg").length > 0) ||~~ |
  | 304 |  | ~~(!document.querySelector("input.reg1")?.value &&~~ |
  | 305 |  | ~~document.querySelectorAll("input.reg1").length > 0)~~ |
  | 306 |  | ~~) {~~ |
  | 307 |  | ~~return false;~~ |
  | 308 |  | ~~}~~ |
  | 309 |  | ~~});~~ |
  | 310 |  | ~~const cbox = document.querySelectorAll('input[name="reset"]');~~ |
  | 311 |  | ~~for (let i = 0; i < cbox.length; i++) {~~ |
  | 312 |  | ~~cbox[i].addEventListener("click", function (event) {~~ |
  | 313 |  | ~~if (!confirm("Are you sure you want to reset to default settings?")) {~~ |
  | 314 |  | ~~return false;~~ |
  | 315 |  | ~~}~~ |
  | 316 |  | ~~});~~ |
  | 317 |  | ~~}~~ |
  | 318 | 296 | }); |
* ## [free-comments-for-wordpress-vuukle/trunk/admin/partials/free-comments-for-wordpress-vuukle-admin-display.php](/changeset/2553337/free-comments-for-wordpress-vuukle/trunk/admin/partials/free-comments-for-wordpress-vuukle-admin-display.php "Show the changeset 2553337 restricted to free-comments-for-wordpress-vuukle/trunk/admin/partials/free-comments-for-wordpress-vuukle-admin-display.php")

  | [r2533938](/browser/free-comments-for-wordpress-vuukle/trunk/admin/partials/free-comments-for-wordpress-vuukle-admin-display.php?rev=2533938#L1 "Show revision 2533938 of this file in browser") | [r2553337](/browser/free-comments-for-wordpress-vuukle/trunk/admin/partials/free-comments-for-wordpress-vuukle-admin-display.php?rev=2553337#L1 "Show revision 2553337 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php |
  | 2 |  |  |
  | 3 | 2 | /\*\* |
  | 4 | 3 | \* Provide a admin area view for the plugin |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/partials/free-comments-for-wordpress-vuukle-admin-display.php?rev=2533938#L14) | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/partials/free-comments-for-wordpress-vuukle-admin-display.php?rev=2553337#L13) |  |
  | 14 | 13 | \* @since      1.0.0 |
  | 15 | 14 | \*/ |
  |  | 15 | if ( $this->check\_message\_existence( 'error' ) || $this->check\_message\_existence( 'success' ) ) { |
  |  | 16 | $message = $this->check\_message\_existence( 'error' ) ? $this->get\_message( 'error' ) : $this->get\_message( 'success' ); |
  |  | 17 | ?> |
  |  | 18 | <div class="notice notice-<?= $this->check\_message\_existence( 'error' ) ? 'error' : 'success' ?> is-dismissible"> |
  |  | 19 | <p><strong><?= $message; ?></strong></p> |
  |  | 20 | </div> |
  |  | 21 | <?php |
  |  | 22 | $this->unset\_sessions(); |
  |  | 23 | } |
  | 16 | 24 | ?> |
  | 17 |  |  |
  | 18 |  | ~~<!-- This file should primarily consist of HTML with a little bit of PHP. -->~~ |
  | 19 |  |  |
  | 20 |  | ~~<?php~~ |
  | 21 |  |  |
  | 22 |  | ~~if (isset($\_GET['vuukle\_tab'])) {~~ |
  | 23 |  | ~~$vuukle\_tab = $\_GET['vuukle\_tab'];~~ |
  | 24 |  | ~~} else {~~ |
  | 25 |  | ~~$vuukle\_tab = 'tab1';~~ |
  | 26 |  | ~~}~~ |
  | 27 |  |  |
  | 28 |  | ~~$url = esc\_url\_raw(remove\_query\_arg(array('vuukle\_tab')));~~ |
  | 29 |  |  |
  | 30 |  | ~~if ('1' !== get\_option('hide\_vuukle\_admin\_notice')) {~~ |
  | 31 |  | ~~$date\_activation\_vuukle\_plugin = get\_option('Activated\_Vuukle\_Plugin\_Date');~~ |
  | 32 |  | ~~$date\_activation\_vuukle\_plugin = strtotime('+4 weeks', strtotime($date\_activation\_vuukle\_plugin));~~ |
  | 33 |  | ~~$current\_date = strtotime(gmdate('Y-m-d H:i:s'));~~ |
  | 34 |  | ~~}~~ |
  | 35 |  | ~~if ($current\_date >= $date\_activation\_vuukle\_plugin) {~~ |
  | 36 |  | ~~add\_action('admin\_notices', 'vuukleAdminNotice');~~ |
  | 37 |  | ~~}~~ |
  | 38 |  |  |
  | 39 |  | ~~if (isset($this->settings['AppId']) && !$this->settings['AppId']) {~~ |
  | 40 |  | ~~$this->quickRegister(true);~~ |
  | 41 |  | ~~$this->settings = get\_option($this->settings\_name);~~ |
  | 42 |  | ~~} elseif (!isset($this->settings['AppId'])) {~~ |
  | 43 |  | ~~$this->quickRegister(true);~~ |
  | 44 |  | ~~$this->settings = get\_option($this->settings\_name);~~ |
  | 45 |  | ~~}~~ |
  | 46 |  |  |
  | 47 |  | ~~if (!is\_array($this->settings)) {~~ |
  | 48 |  | ~~$this->settings = $this->settings\_defaults;~~ |
  | 49 |  | ~~} else {~~ |
  | 50 |  | ~~$this->settings = array\_replace\_recursive($this->settings\_defaults, $this->settings);~~ |
  | 51 |  | ~~}~~ |
  | 52 |  |  |
  | 53 |  | ~~if (!current\_user\_can('manage\_options')) {~~ |
  | 54 |  | ~~wp\_die(esc\_html('You do not have sufficient permissions to access this page.'));~~ |
  | 55 |  | ~~}~~ |
  | 56 |  |  |
  | 57 |  | ~~if (isset($\_POST['nonce']) && !wp\_verify\_nonce(sanitize\_key($\_POST['nonce']), $this->settings\_name)) { // Input var okay~~ |
  | 58 |  | ~~wp\_die(esc\_html('Security check failed! Settings not saved.'));~~ |
  | 59 |  | ~~}~~ |
  | 60 |  | ~~$wp\_content\_dir\_array = explode('/', WP\_CONTENT\_DIR);~~ |
  | 61 |  | ~~$wp\_content\_dir = $wp\_content\_dir\_array[count($wp\_content\_dir\_array) - 1];~~ |
  | 62 |  | ~~$root\_path = str\_replace($wp\_content\_dir, '', WP\_CONTENT\_DIR);~~ |
  | 63 |  | ~~$ads\_txt\_file = $root\_path . 'ads.txt';~~ |
  | 64 |  | ~~if (isset($\_POST['ads-txt-console'])) {~~ |
  | 65 |  | ~~file\_put\_contents($ads\_txt\_file, $\_POST['ads-txt-console']);~~ |
  | 66 |  | ~~}~~ |
  | 67 |  | ~~if (isset($\_POST['action']) && 'VuukleSaveSettings' === $\_POST['action']) { // Input var okay~~ |
  | 68 |  | ~~$app\_id = isset($\_POST) ? $\_POST['AppId'] : '';~~ |
  | 69 |  | ~~$\_POST['mobile\_type']  = 'vertical';~~ |
  | 70 |  | ~~$\_POST['desktop\_type'] = 'vertical';~~ |
  | 71 |  | ~~$\_POST['mobile\_type\_horizontal']  = 'horizontal';~~ |
  | 72 |  | ~~$\_POST['desktop\_type\_horizontal'] = 'horizontal';~~ |
  | 73 |  | ~~if (isset($\_POST['reset'])) { // Input var okay~~ |
  | 74 |  | ~~$\_POST = array\_merge($\_POST, $this->settings\_defaults); // Input var okay~~ |
  | 75 |  | ~~$vuukle\_tab = 'tab1';~~ |
  | 76 |  | ~~$url = remove\_query\_arg(array('vuukle\_tab'));~~ |
  | 77 |  | ~~wp\_redirect($url);~~ |
  | 78 |  | ~~}~~ |
  | 79 |  |  |
  | 80 |  | ~~if (!isset($\_POST['share\_type'])) {~~ |
  | 81 |  | ~~$\_POST['share\_type'] = '';~~ |
  | 82 |  | ~~}~~ |
  | 83 |  | ~~if (!isset($\_POST['share\_type\_vertical'])) {~~ |
  | 84 |  | ~~$\_POST['share\_type\_vertical'] = '';~~ |
  | 85 |  | ~~}~~ |
  | 86 |  | ~~if (!isset($\_POST['mobile\_type'])) {~~ |
  | 87 |  | ~~$\_POST['mobile\_type'] = '';~~ |
  | 88 |  | ~~}~~ |
  | 89 |  | ~~if (!isset($\_POST['desktop\_type'])) {~~ |
  | 90 |  | ~~$\_POST['desktop\_type'] = '';~~ |
  | 91 |  | ~~}~~ |
  | 92 |  | ~~if (!isset($\_POST['mobile\_type\_horizontal'])) {~~ |
  | 93 |  | ~~$\_POST['mobile\_type\_horizontal'] = '';~~ |
  | 94 |  | ~~}~~ |
  | 95 |  | ~~if (isset($\_POST['enable\_h\_v']) && $\_POST['enable\_h\_v'] === 'yes') {~~ |
  | 96 |  |  |
  | 97 |  | ~~$\_POST['div\_class\_powerbar'] = '';~~ |
  | 98 |  |  |
  | 99 |  | ~~}~~ |
  | 100 |  |  |
  | 101 |  | ~~if ($\_POST['div\_class'] === '' && $\_POST['embed\_comments'] === '3') {~~ |
  | 102 |  | ~~$\_POST['embed\_comments'] = '1';~~ |
  | 103 |  | ~~}~~ |
  | 104 |  |  |
  | 105 |  | ~~if ($\_POST['div\_id'] === '' && $\_POST['embed\_comments'] === '4') {~~ |
  | 106 |  | ~~$\_POST['embed\_comments'] = '1';~~ |
  | 107 |  | ~~}~~ |
  | 108 |  |  |
  | 109 |  | ~~if (!isset($\_POST['desktop\_type\_horizontal'])) {~~ |
  | 110 |  | ~~$\_POST['desktop\_type\_horizontal'] = '';~~ |
  | 111 |  | ~~}~~ |
  | 112 |  |  |
  | 113 |  | ~~foreach ($\_POST as $key => $value) { // Input var okay~~ |
  | 114 |  | ~~if (array\_key\_exists($key, $this->settings\_defaults)) {~~ |
  | 115 |  | ~~if (is\_string($value)) {~~ |
  | 116 |  | ~~$value = trim(wp\_strip\_all\_tags($value));~~ |
  | 117 |  | ~~}~~ |
  | 118 |  |  |
  | 119 |  | ~~if ('text' === $key) {~~ |
  | 120 |  | ~~foreach ($value as $k => &$v) {~~ |
  | 121 |  | ~~if ('timeAgo' === $k) {~~ |
  | 122 |  | ~~continue;~~ |
  | 123 |  | ~~}~~ |
  | 124 |  | ~~if (is\_array($v)) {~~ |
  | 125 |  | ~~$v = array\_map('trim', $v);~~ |
  | 126 |  | ~~$v = array\_map('wp\_strip\_all\_tags', $v);~~ |
  | 127 |  | ~~} else {~~ |
  | 128 |  | ~~$v = trim(wp\_strip\_all\_tags($v));~~ |
  | 129 |  | ~~}~~ |
  | 130 |  | ~~}~~ |
  | 131 |  | ~~}~~ |
  | 132 |  | ~~$this->settings[$key] = $value;~~ |
  | 133 |  | ~~}~~ |
  | 134 |  | ~~}~~ |
  | 135 |  |  |
  | 136 |  |  |
  | 137 |  | ~~$this->settings['items\_powerbar'] = $\_POST['items\_powerbar'];~~ |
  | 138 |  |  |
  | 139 |  | ~~if ($\_POST['AppId'] == '') { // Input var okay~~ |
  | 140 |  | ~~$this->settings['AppId'] = $app\_id;~~ |
  | 141 |  | ~~}~~ |
  | 142 |  | ~~if (!isset($\_POST['items\_powerbar'])) { // Input var okay~~ |
  | 143 |  | ~~$this->settings['items\_powerbar'] = '';~~ |
  | 144 |  | ~~}~~ |
  | 145 |  | ~~if (empty($\_POST['share\_position'])) { // Input var okay~~ |
  | 146 |  | ~~$this->settings['share\_position'] = '';~~ |
  | 147 |  | ~~}~~ |
  | 148 |  | ~~if (empty($\_POST['share\_position2'])) { // Input var okay~~ |
  | 149 |  | ~~$this->settings['share\_position2'] = '';~~ |
  | 150 |  | ~~}~~ |
  | 151 |  |  |
  | 152 |  | ~~if (empty($\_POST['emote\_enabled1'])) { // Input var okay~~ |
  | 153 |  | ~~$this->settings['emote\_enabled1'] = '';~~ |
  | 154 |  | ~~}~~ |
  | 155 |  |  |
  | 156 |  | ~~if (empty($\_POST['emote\_enabled2'])) { // Input var okay~~ |
  | 157 |  | ~~$this->settings['emote\_enabled2'] = '';~~ |
  | 158 |  | ~~}~~ |
  | 159 |  |  |
  | 160 |  | ~~if (empty($\_POST['emote\_enabled3'])) { // Input var okay~~ |
  | 161 |  | ~~$this->settings['emote\_enabled3'] = '';~~ |
  | 162 |  | ~~}~~ |
  | 163 |  |  |
  | 164 |  | ~~if (empty($\_POST['emote\_enabled4'])) { // Input var okay~~ |
  | 165 |  | ~~$this->settings['emote\_enabled4'] = '';~~ |
  | 166 |  | ~~}~~ |
  | 167 |  |  |
  | 168 |  | ~~if (empty($\_POST['emote\_enabled5'])) { // Input var okay~~ |
  | 169 |  | ~~$this->settings['emote\_enabled5'] = '';~~ |
  | 170 |  | ~~}~~ |
  | 171 |  |  |
  | 172 |  | ~~if (empty($\_POST['emote\_enabled6'])) { // Input var okay~~ |
  | 173 |  | ~~$this->settings['emote\_enabled6'] = '';~~ |
  | 174 |  | ~~}~~ |
  | 175 |  |  |
  | 176 |  | ~~if (empty($\_POST['embed\_emotes\_amp'])) {~~ |
  | 177 |  | ~~$this->settings['embed\_emotes\_amp'] = 'off';~~ |
  | 178 |  | ~~}~~ |
  | 179 |  |  |
  | 180 |  | ~~if (empty($\_POST['enable\_seo'])) {~~ |
  | 181 |  | ~~$this->settings['enable\_seo'] = 'off';~~ |
  | 182 |  | ~~}~~ |
  | 183 |  |  |
  | 184 |  | ~~if (empty($\_POST['non\_article\_pages'])) {~~ |
  | 185 |  | ~~$this->settings['non\_article\_pages'] = 'off';~~ |
  | 186 |  | ~~}~~ |
  | 187 |  |  |
  | 188 |  | ~~if (empty($\_POST['non\_article\_pages'])) {~~ |
  | 189 |  | ~~$this->settings['non\_article\_pages'] = 'off';~~ |
  | 190 |  | ~~}~~ |
  | 191 |  |  |
  | 192 |  | ~~if (empty($\_POST['checkboxTextEnabled'])) {~~ |
  | 193 |  | ~~$this->settings['checkboxTextEnabled'] = false;~~ |
  | 194 |  | ~~}~~ |
  | 195 |  |  |
  | 196 |  | ~~if (update\_option($this->settings\_name, $this->settings)) {~~ |
  | 197 |  | ~~print '<div class="updated"><p><strong>Settings saved.</strong></p></div>';~~ |
  | 198 |  | ~~}~~ |
  | 199 |  | ~~}~~ |
  | 200 |  | ~~$vuukle\_api\_key = (isset($this->settings['AppId']) && $this->settings['AppId'] != '') ? false : true;~~ |
  | 201 |  | ~~$checked\_amp = (isset($this->settings['embed\_emotes\_amp']) && $this->settings['embed\_emotes\_amp'] == 'on') ? 'checked' : '';~~ |
  | 202 |  | ~~$checked\_seo = (isset($this->settings['enable\_seo']) && $this->settings['enable\_seo'] == 'on') ? 'checked' : '';~~ |
  | 203 |  | ~~$non\_article\_pages = (isset($this->settings['non\_article\_pages']) && $this->settings['non\_article\_pages'] == 'on') ? 'checked' : '';~~ |
  | 204 |  |  |
  | 205 |  | ~~if (isset($\_POST['action']) && 'VuukleSaveSettings1' === $\_POST['action']) { // Input var okay~~ |
  | 206 |  | ~~$app\_id = isset($\_POST) ? $\_POST['AppId'] : '';~~ |
  | 207 |  | ~~foreach ($\_POST as $key => $value) { // Input var okay~~ |
  | 208 |  | ~~if (array\_key\_exists($key, $this->settings\_defaults)) {~~ |
  | 209 |  | ~~if (is\_string($value)) {~~ |
  | 210 |  | ~~$value = trim(wp\_strip\_all\_tags($value));~~ |
  | 211 |  | ~~}~~ |
  | 212 |  | ~~$this->settings[$key] = $value;~~ |
  | 213 |  | ~~}~~ |
  | 214 |  | ~~}~~ |
  | 215 |  | ~~if (update\_option($this->settings\_name, $this->settings)) {~~ |
  | 216 |  | ~~print '<div class="updated"><p><strong>Settings saved.</strong></p></div>';~~ |
  | 217 |  | ~~}~~ |
  | 218 |  | ~~}~~ |
  | 219 |  |  |
  | 220 |  |  |
  | 221 |  | ~~?>~~ |
  | 222 |  |  |
  | 223 | 25 | <style> |
  | 224 | 26 | #adminmenu a.toplevel\_page\_free-comments-for-wordpress-vuukle div.wp-menu-image img { |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/partials/free-comments-for-wordpress-vuukle-admin-display.php?rev=2533938#L228) | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/partials/free-comments-for-wordpress-vuukle-admin-display.php?rev=2553337#L30) |  |
  | 228 | 30 | } |
  | 229 | 31 | </style> |
  |  | 32 | <style type="text/css" media="print"> |
  |  | 33 | #wpadminbar { |
  |  | 34 | display: none; |
  |  | 35 | } |
  |  | 36 | </style> |
  | 230 | 37 | <script type="text/javascript"> |
  | 231 |  | ~~var mailpoet\_token = "383b2df0a9";~~ |
  | 232 |  | ~~var mailpoet\_api\_version = "v1";~~ |
  | 233 |  | ~~</script>~~ |
  | 234 |  | ~~<script>~~ |
  | 235 | 38 | if (window.history.replaceState) { |
  | 236 | 39 | window.history.replaceState(null, null, document.getElementById('wp-admin-canonical').href + window.location.hash); |
  | 237 | 40 | } |
  | 238 |  | </script> |
  | 239 |  | <script type="text/javascript"> |
  | 240 |  | var \_wpColorScheme = { |
  | 241 |  | "icons": { |
  | 242 |  | "base": "#a0a5aa", |
  | 243 |  | "focus": "#00a0d2", |
  | 244 |  | "current": "#fff" |
  | 245 |  | } |
  | 246 |  | }; |
  | 247 |  | </script> |
  | 248 |  | <script> |
  | 249 |  | function resetVisible(val) { |
  | 250 |  | document.getElementById('vis').style.display = 'none'; |
  | 251 |  | let num = val.getAttribute('data-tab'); |
  | 252 |  | let urlParams = new URLSearchParams(location.search); |
  | 253 |  | if (!urlParams.get('vuukle\_tab')) { |
  | 254 |  | urlParams.append('vuukle\_tab', num); |
  | 255 |  | let newurl = window.location.href + `&vuukle\_tab=${num}`; |
  | 256 |  | window.history.pushState({ |
  | 257 |  | path: newurl |
  | 258 |  | }, '', newurl); |
  | 259 |  | } else { |
  | 260 |  | let newurl = window.location.href.replace(urlParams.get('vuukle\_tab'), num); |
  | 261 |  | window.history.pushState({ |
  | 262 |  | path: newurl |
  | 263 |  | }, '', newurl); |
  | 264 |  | } |
  | 265 |  | } |
  |  | 41 | var mailpoet\_token = "383b2df0a9", |
  |  | 42 | mailpoet\_api\_version = "v1", |
  |  | 43 | \_wpColorScheme = { |
  |  | 44 | "icons": { |
  |  | 45 | "base": "#a0a5aa", |
  |  | 46 | "focus": "#00a0d2", |
  |  | 47 | "current": "#fff" |
  |  | 48 | } |
  |  | 49 | }; |
  | 266 | 50 |  |
  | 267 | 51 | function resetVisibleBlock(val) { |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/partials/free-comments-for-wordpress-vuukle-admin-display.php?rev=2533938#L283) | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/partials/free-comments-for-wordpress-vuukle-admin-display.php?rev=2553337#L67) |  |
  | 283 | 67 | } |
  | 284 | 68 | </script> |
  | 285 |  | ~~<style type="text/css" media="print">~~ |
  | 286 |  | ~~#wpadminbar {~~ |
  | 287 |  | ~~display: none;~~ |
  | 288 |  | ~~}~~ |
  | 289 |  | ~~</style>~~ |
  | 290 | 69 | <div class="wrap"> |
  | 291 |  | <img style="position: absolute; right: 40px; width: 35px;" src="<?php echo VUUKLE\_ADMIN\_URL; ?>/images/logo.png"/> |
  |  | 70 | <img style="position: absolute; right: 40px; width: 35px;" src="<?php echo VUUKLE\_ADMIN\_URL; ?>/images/logo.png"/> |
  | 292 | 71 | <h2>Vuukle Settings</h2> |
  | 293 | 72 | <p>Vuukle Commenting is automatically displayed in place of WordPress default comments. You can also insert Vuukle Commenting system to any other part of your website by using ShortCode <code>[vuukle]</code>.</p> |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/partials/free-comments-for-wordpress-vuukle-admin-display.php?rev=2533938#L295) | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/partials/free-comments-for-wordpress-vuukle-admin-display.php?rev=2553337#L74) |  |
  | 295 | 74 | <a target="\_blank" style="background-color: #EB8D40; color: white" class="button" href="https://admin.vuukle.com/">Login to Vuukle Admin</a> |
  | 296 | 75 | <p> |
  | 297 |  | <a target="\_blank" href="https://admin.vuukle.com/forgot-password.html"><button class="button button-primary">Forgot password</button></a> |
  |  | 76 | <a target="\_blank" href="https://admin.vuukle.com/forgot-password.html"> |
  |  | 77 | <button class="button button-primary">Forgot password</button> |
  |  | 78 | </a> |
  | 298 | 79 | <span class="ajax-response"></span> |
  | 299 | 80 | </p> |
  | 300 |  | ~~<?php if ($vuukle\_api\_key~~) : ?> |
  |  | 81 | <?php if ( empty( $this->settings['AppId'] ) ) : ?> |
  | 301 | 82 | <div class="vuukle\_overlay"> |
  | 302 | 83 | <div class="vuukle\_popup"> |
  | 303 | 84 | <div class="vuukle\_popup\_open"> |
  | 304 | 85 | <div class="vuukle\_popup\_info"> |
  | 305 |  | <h2 style="text-align:center;"><?php \_e(~~"To get your APIKEY please send us an email", esc\_html($this->plugin\_name)~~); ?> <a href="mailto:support@vuukle.com">support@vuukle.com</a></h2> |
  |  | 86 | <h2 style="text-align:center;"><?php \_e( "To get your APIKEY please send us an email", esc\_html( $this->plugin\_name ) ); ?> <a href="mailto:support@vuukle.com">support@vuukle.com</a></h2> |
  | 306 | 87 | </div> |
  | 307 | 88 | </div> |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/partials/free-comments-for-wordpress-vuukle-admin-display.php?rev=2533938#L311) | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/partials/free-comments-for-wordpress-vuukle-admin-display.php?rev=2553337#L92) |  |
  | 311 | 92 | </div> |
  | 312 | 93 | </div> |
  | 313 |  | <?php endif; ?> |
  | 314 |  | <form method="post" action="" id="vuukle-settings-form"> |
  | 315 |  |  |
  | 316 |  | <input type="hidden" name="vuukle\_tab" value="<?php echo esc\_html($vuukle\_tab); ?>" id="hidden\_tab"> |
  | 317 |  | <input type="hidden" value="<?php echo esc\_url($url); ?>" id="hidden\_url"> |
  | 318 |  |  |
  | 319 |  | <?php require plugin\_dir\_path(\_\_FILE\_\_) . '/save-settings-modal.php'; ?> |
  | 320 |  |  |
  | 321 |  |  |
  |  | 94 | <?php endif; ?> |
  |  | 95 | <form method="post" action="<?= admin\_url( 'admin-post.php' ); ?>" id="vuukle-settings-form"> |
  |  | 96 | <input type="hidden" name="vuukle\_tab" value="<?php echo esc\_html( $vuukle\_tab ); ?>" id="hidden\_tab"> |
  |  | 97 | <input type="hidden" value="<?php echo esc\_url( $url ); ?>" id="hidden\_url"> |
  |  | 98 | <?php require plugin\_dir\_path( \_\_FILE\_\_ ) . '/save-settings-modal.php'; ?> |
  | 322 | 99 | <div class="nav-tab-wrapper"> |
  | 323 |  | <a href="#tab1" data-tab="tab1" onclick="resetVisibleBlock(this)" class="nav-tab <?php echo ($vuukle\_tab == 'tab1') ? 'nav-tab-active' : ''; ?>"><?php \_e("General settings", esc\_html($this->plugin\_name)); ?></a> |
  | 324 |  | <a href="#tab2" data-tab="tab2" onclick="resetVisibleBlock(this)" class="nav-tab <?php echo ($vuukle\_tab == 'tab2') ? 'nav-tab-active' : ''; ?>"><?php \_e("Share Bar widget settings", esc\_html($this->plugin\_name)); ?></a> |
  | 325 |  | <a href="#tab3" data-tab="tab3" onclick="resetVisibleBlock(this)" class="nav-tab <?php echo ($vuukle\_tab == 'tab3') ? 'nav-tab-active' : ''; ?>"><?php \_e("Custom Sharing URLs", esc\_html($this->plugin\_name)); ?></a> |
  | 326 |  | <a href="#tab4" data-tab="tab4" onclick="resetVisibleBlock(this)" class="nav-tab <?php echo ($vuukle\_tab == 'tab4') ? 'nav-tab-active' : ''; ?>"><?php \_e("Emote widget setting", esc\_html($this->plugin\_name)); ?></a> |
  | 327 |  | <a href="#tab5" data-tab="tab5" onclick="resetVisibleBlock(this)" class="nav-tab <?php echo ($vuukle\_tab == 'tab5') ? 'nav-tab-active' : ''; ?>"><?php \_e("Comment widget settings", esc\_html($this->plugin\_name)); ?></a> |
  | 328 |  | <a href="#tab6" data-tab="tab6" onclick="resetVisibleBlock(this)" class="nav-tab <?php echo ($vuukle\_tab == 'tab6') ? 'nav-tab-active' : ''; ?>"><?php \_e("Newsfeed Bar widget settings", esc\_html($this->plugin\_name)); ?></a> |
  | 329 |  | <a href="#tab7" data-tab="tab7" onclick="resetVisibleBlock(this)" class="nav-tab <?php echo ($vuukle\_tab == 'tab7') ? 'nav-tab-active' : ''; ?>"><?php \_e("Enable only for endless scroll WP theme", esc\_html($this->plugin\_name)); ?></a> |
  | 330 |  | <a href="#tab8" data-tab="tab8" onclick="resetVisibleBlock(this)" class="nav-tab <?php echo ($vuukle\_tab == 'tab8') ? 'nav-tab-active' : ''; ?>"><?php \_e("SEO", esc\_html($this->plugin\_name)); ?></a> |
  | 331 |  | <a href="#tab10" data-tab="tab10" onclick="resetVisible(this)" class="nav-tab <?php echo ($vuukle\_tab == 'tab10') ? 'nav-tab-active' : ''; ?>"><?php \_e("Change ads.txt", esc\_html($this->plugin\_name)); ?></a> |
  | 332 |  | </div> |
  | 333 |  | <div id="tab1" class="vuukle-tab-content <?php echo ($vuukle\_tab == 'tab1') ? 'vuukle-tab-content-active' : ''; ?>"> |
  |  | 100 | <a href="#tab1" data-tab="tab1" onclick="resetVisibleBlock(this)" class="nav-tab <?php echo ( $vuukle\_tab == 'tab1' ) ? 'nav-tab-active' : ''; ?>"><?php \_e( "General settings", |
  |  | 101 | esc\_html( $this->plugin\_name ) ); ?></a> |
  |  | 102 | <a href="#tab2" data-tab="tab2" onclick="resetVisibleBlock(this)" class="nav-tab <?php echo ( $vuukle\_tab == 'tab2' ) ? 'nav-tab-active' : ''; ?>"><?php \_e( "Share Bar widget settings", |
  |  | 103 | esc\_html( $this->plugin\_name ) ); ?></a> |
  |  | 104 | <a href="#tab4" data-tab="tab4" onclick="resetVisibleBlock(this)" class="nav-tab <?php echo ( $vuukle\_tab == 'tab4' ) ? 'nav-tab-active' : ''; ?>"><?php \_e( "Emote widget setting", |
  |  | 105 | esc\_html( $this->plugin\_name ) ); ?></a> |
  |  | 106 | <a href="#tab5" data-tab="tab5" onclick="resetVisibleBlock(this)" class="nav-tab <?php echo ( $vuukle\_tab == 'tab5' ) ? 'nav-tab-active' : ''; ?>"><?php \_e( "Comment widget settings", |
  |  | 107 | esc\_html( $this->plugin\_name ) ); ?></a> |
  |  | 108 | </div> |
  |  | 109 | <div id="tab1" class="vuukle-tab-content <?php echo ( $vuukle\_tab == 'tab1' ) ? 'vuukle-tab-content-active' : ''; ?>"> |
  | 334 | 110 | <table class="form-table settings-table"> |
  | 335 | 111 | <tr> |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/partials/free-comments-for-wordpress-vuukle-admin-display.php?rev=2533938#L344) | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/partials/free-comments-for-wordpress-vuukle-admin-display.php?rev=2553337#L120) |  |
  | 344 | 120 | </th> |
  | 345 | 121 | <td> |
  | 346 |  | <input name="AppId" type="text" value="<?php print esc\_attr(~~$this->settings['AppId']); ?>" class="regular-text"~~ /> |
  | 347 |  | ~~<?php if (!$this->settings['AppId']~~) : ?> |
  |  | 122 | <input name="AppId" type="text" value="<?php print esc\_attr( $this->settings['AppId'] ); ?>" class="regular-text"/> |
  |  | 123 | <?php if ( ! $this->settings['AppId'] ) : ?> |
  | 348 | 124 | <button type="button" id="quick-register" class="button button-primary">Get API-KEY</button> |
  | 349 |  | <?php endif ?> |
  |  | 125 | <?php endif ?> |
  | 350 | 126 | <span class="ajax-response"></span> |
  | 351 | 127 | </td> |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/partials/free-comments-for-wordpress-vuukle-admin-display.php?rev=2533938#L353) | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/partials/free-comments-for-wordpress-vuukle-admin-display.php?rev=2553337#L129) |  |
  | 353 | 129 | <tr> |
  | 354 | 130 | <th scope="row"> |
  | 355 |  | Save comments (WP Database)<a class="vuukle\_help" data-toggle="tooltip" title="<?php \_e("Turn on this option and your comments will be saved in your wordpress database", esc\_html($this->plugin\_name)); ?>"> |
  |  | 131 | Save comments (WP Database)<a class="vuukle\_help" data-toggle="tooltip" |
  |  | 132 | title="<?php \_e( "Turn on this option and your comments will be saved in your wordpress database", esc\_html( $this->plugin\_name ) ); ?>"> |
  | 356 | 133 | <i class="fas fa-info-circle"></i> |
  | 357 | 134 | </a> |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/partials/free-comments-for-wordpress-vuukle-admin-display.php?rev=2533938#L359) | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/partials/free-comments-for-wordpress-vuukle-admin-display.php?rev=2553337#L136) |  |
  | 359 | 136 | <td> |
  | 360 | 137 | Off |
  | 361 |  | <input type="radio" name="save\_comments" value="0" checked="checked"/> |
  |  | 138 | <input type="radio" name="save\_comments" value="0" checked="checked"/> |
  | 362 | 139 | On |
  | 363 |  | <input type="radio" name="save\_comments" value="1" <?php checked($this->settings['save\_comments'], 1); ?> /> |
  | 364 |  | </td> |
  | 365 |  | </tr> |
  | 366 |  |  |
  | 367 |  | <tr> |
  | 368 |  | <th scope="row"> |
  | 369 |  | OpenGraph Tags<a class="vuukle\_help" data-toggle="tooltip" title="<?php \_e("Turn on to enable og:image, og:title tags on the page", esc\_html($this->plugin\_name)); ?>"> |
  | 370 |  | <i class="fas fa-info-circle"></i> |
  | 371 |  | </a> |
  | 372 |  | </th> |
  | 373 |  | <td> |
  | 374 |  | Off |
  | 375 |  | <input type="radio" name="og\_tags" value="0" checked="checked" /> |
  | 376 |  | On |
  | 377 |  | <input type="radio" name="og\_tags" value="1" <?php checked($this->settings['og\_tags'], 1); ?> /> |
  | 378 |  | </td> |
  | 379 |  | </tr> |
  | 380 |  | <tr> |
  | 381 |  | <th scope="row"> |
  | 382 |  | Recommendations Protocol <a class="vuukle\_help" data-toggle="tooltip" title="<?php \_e(" Select the protocol that matches your site", esc\_html($this->plugin\_name)); ?>"> |
  | 383 |  | <i class="fas fa-info-circle"></i> |
  | 384 |  | </a> |
  | 385 |  | </th> |
  | 386 |  | <td> |
  | 387 |  | <select name="recomendations\_protocol"> |
  | 388 |  | <option value="none" <?php selected($this->settings['recomendations\_protocol'], 'none'); ?>>none</option> |
  | 389 |  | <option value="http" <?php selected($this->settings['recomendations\_protocol'], 'http'); ?>>http</option> |
  | 390 |  | <option value="https" <?php selected($this->settings['recomendations\_protocol'], 'https'); ?>>https</option> |
  | 391 |  | <option value="http://www." <?php selected($this->settings['recomendations\_protocol'], 'http://www.'); ?>>http://www.</option> |
  | 392 |  | <option value="https://www." <?php selected($this->settings['recomendations\_protocol'], 'https://www.'); ?>>https://www.</option> |
  | 393 |  | </select> |
  | 394 |  | </td> |
  | 395 |  | </tr> |
  | 396 |  | <tr> |
  | 397 |  | <th>Remove vuukle from the posts (ids, separated by comma) <a class="vuukle\_help" data-toggle="tooltip" title="<?php \_e("Select the posts from which you want to remove vuukle", esc\_html($this->plugin\_name)); ?>"> |
  | 398 |  | <i class="fas fa-info-circle"></i> |
  | 399 |  | </a></th> |
  | 400 |  | <td> |
  | 401 |  | <input type="text" name="post\_exceptions" value="<?php echo esc\_attr($this->settings['post\_exceptions']); ?>" /> |
  | 402 |  | </td> |
  | 403 |  | </tr> |
  | 404 |  | <tr> |
  | 405 |  | <th>Remove vuukle from the post types (slugs, separated by comma)<a class="vuukle\_help" data-toggle="tooltip" title="<?php \_e(" Select the post type from which you want to remove vuukle", esc\_html($this->plugin\_name)); ?>"> |
  | 406 |  | <i class="fas fa-info-circle"></i> |
  | 407 |  | </a></th> |
  | 408 |  | <td> |
  | 409 |  | <input type="text" name="post\_type\_exceptions" value="<?php echo esc\_attr($this->settings['post\_type\_exceptions']); ?>" /> |
  | 410 |  | </td> |
  | 411 |  | </tr> |
  | 412 |  | <tr> |
  | 413 |  | <th>Remove vuukle from posts by URL (put words comma separated)<a class="vuukle\_help" data-toggle="tooltip" title="<?php \_e(" Select the whole URL or some part of it from which you want to remove vuukle.", esc\_html($this->plugin\_name)); ?>"> |
  | 414 |  | <i class="fas fa-info-circle"></i> |
  | 415 |  | </a></th> |
  | 416 |  | <td> |
  | 417 |  | <input type="text" name="post\_type\_by\_url\_exceptions" value="<?php echo esc\_attr($this->settings['post\_type\_by\_url\_exceptions']); ?>" /> |
  | 418 |  | </td> |
  | 419 |  | </tr> |
  | 420 |  | <tr> |
  | 421 |  | <th>Remove vuukle from the categories (slugs, separated by comma) <a class="vuukle\_help" data-toggle="tooltip" title="<?php \_e("Select the categories  from which you want to remove vuukle", esc\_html($this->plugin\_name)); ?>"> |
  | 422 |  | <i class="fas fa-info-circle"></i> |
  | 423 |  | </a></th> |
  | 424 |  | <td> |
  | 425 |  | <input type="text" name="category\_exceptions" value="<?php echo esc\_attr($this->settings['category\_exceptions']); ?>" /> |
  | 426 |  | </td> |
  | 427 |  | </tr> |
  | 428 |  | <tr> |
  | 429 |  | <th>Export comments <a class="vuukle\_help" data-toggle="tooltip" title="<?php \_e("Select how many comments you want to export", esc\_html($this->plugin\_name)); ?>"> |
  | 430 |  | <i class="fas fa-info-circle"></i> |
  | 431 |  | </a></th> |
  | 432 |  | <td> |
  | 433 |  | <input style="width: 78px;height: 29px !important;min-height: 29px;" class="amount\_comments" type="number" name="amount\_comments" value="<?php echo esc\_attr($this->settings['amount\_comments']); ?>" /> |
  | 434 |  | <input type="button" id="export\_button2" offset="0" class="button button-primary" name="export\_botton" value="Download File" /> |
  |  | 140 | <input type="radio" name="save\_comments" value="1" <?php checked( $this->settings['save\_comments'], 1 ); ?> /> |
  |  | 141 | </td> |
  |  | 142 | </tr> |
  |  | 143 |  |
  |  | 144 | <tr> |
  |  | 145 | <th>Remove vuukle from the posts (ids, separated by comma) <a class="vuukle\_help" data-toggle="tooltip" |
  |  | 146 | title="<?php \_e( "Select the posts from which you want to remove vuukle", esc\_html( $this->plugin\_name ) ); ?>"> |
  |  | 147 | <i class="fas fa-info-circle"></i> |
  |  | 148 | </a></th> |
  |  | 149 | <td> |
  |  | 150 | <input type="text" name="post\_exceptions" value="<?php echo esc\_attr( $this->settings['post\_exceptions'] ); ?>"/> |
  |  | 151 | </td> |
  |  | 152 | </tr> |
  |  | 153 | <tr> |
  |  | 154 | <th>Remove vuukle from the post types (slugs, separated by comma)<a class="vuukle\_help" data-toggle="tooltip" |
  |  | 155 | title="<?php \_e( " Select the post type from which you want to remove vuukle", esc\_html( $this->plugin\_name ) ); ?>"> |
  |  | 156 | <i class="fas fa-info-circle"></i> |
  |  | 157 | </a></th> |
  |  | 158 | <td> |
  |  | 159 | <input type="text" name="post\_type\_exceptions" value="<?php echo esc\_attr( $this->settings['post\_type\_exceptions'] ); ?>"/> |
  |  | 160 | </td> |
  |  | 161 | </tr> |
  |  | 162 | <tr> |
  |  | 163 | <th>Remove vuukle from posts by URL (put words comma separated)<a class="vuukle\_help" data-toggle="tooltip" |
  |  | 164 | title="<?php \_e( ' Select the whole URL or some part of it from which you want to remove vuukle.', |
  |  | 165 | esc\_html( $this->plugin\_name ) ); ?>"> |
  |  | 166 | <i class="fas fa-info-circle"></i> |
  |  | 167 | </a></th> |
  |  | 168 | <td> |
  |  | 169 | <input type="text" name="post\_type\_by\_url\_exceptions" value="<?php echo esc\_attr( $this->settings['post\_type\_by\_url\_exceptions'] ); ?>"/> |
  |  | 170 | </td> |
  |  | 171 | </tr> |
  |  | 172 | <tr> |
  |  | 173 | <th>Remove vuukle from the categories (slugs, separated by comma) <a class="vuukle\_help" data-toggle="tooltip" |
  |  | 174 | title="<?php \_e( "Select the categories  from which you want to remove vuukle", esc\_html( $this->plugin\_name ) ); ?>"> |
  |  | 175 | <i class="fas fa-info-circle"></i> |
  |  | 176 | </a></th> |
  |  | 177 | <td> |
  |  | 178 | <input type="text" name="category\_exceptions" value="<?php echo esc\_attr( $this->settings['category\_exceptions'] ); ?>"/> |
  |  | 179 | </td> |
  |  | 180 | </tr> |
  |  | 181 | <tr> |
  |  | 182 | <th>Export comments <a class="vuukle\_help" data-toggle="tooltip" title="<?php \_e( "Select how many comments you want to export", esc\_html( $this->plugin\_name ) ); ?>"> |
  |  | 183 | <i class="fas fa-info-circle"></i> |
  |  | 184 | </a></th> |
  |  | 185 | <td> |
  |  | 186 | <input style="width: 78px;height: 29px !important;min-height: 29px;" class="amount\_comments" type="number" name="amount\_comments" |
  |  | 187 | value="<?php echo esc\_attr( $this->settings['amount\_comments'] ); ?>"/> |
  |  | 188 | <input type="button" id="export\_button2" offset="0" class="button button-primary" name="export\_botton" value="Download File"/> |
  | 435 | 189 | <span class="loader-animation" style="display: none;"><strong>Please wait ...</strong></span> |
  | 436 | 190 | </td> |
  | 437 | 191 | </tr> |
  | 438 |  | ~~<tr class="embed\_fields\_emotes">~~ |
  | 439 |  | ~~<th>Enable for AMP~~ |
  | 440 |  | ~~<a class="vuukle\_help" data-toggle="tooltip" title="<?php esc\_html\_e($this->settings['embed\_emotes\_amp'] === 'on' ? "If you don't use Google AMP ( Accelerated Mobile Pages ) uncheck the checkbox please." : "If you use Google AMP ( Accelerated Mobile Pages ) check the checkbox please.", esc\_html($this->plugin\_name)); ?>">~~ |
  | 441 |  | ~~<i class="fas fa-info-circle"></i>~~ |
  | 442 |  | ~~</a>~~ |
  | 443 |  | ~~</th>~~ |
  | 444 |  | ~~<td>~~ |
  | 445 |  | ~~<input type="checkbox" name="embed\_emotes\_amp" value="on" <?php echo esc\_html($checked\_amp); ?> />~~ |
  | 446 |  | ~~</td>~~ |
  | 447 |  | ~~</tr>~~ |
  | 448 | 192 | <tr> |
  | 449 | 193 | <th>Track page views on non article pages |
  | 450 |  | <a class="vuukle\_help" data-toggle="tooltip" title="<?php \_e(~~"Tracks pages' views on non article pages", esc\_html($this->plugin\_name)~~); ?>"> |
  | 451 |  | <i class="fas fa-info-circle"></i> |
  | 452 |  | </a> |
  | 453 |  | </th> |
  | 454 |  | <td> |
  | 455 |  | <input type="checkbox" name="non\_article\_pages" value="on" <?php ~~echo esc\_html($non\_article\_pages);~~ ?> /> |
  |  | 194 | <a class="vuukle\_help" data-toggle="tooltip" title="<?php \_e( "Tracks pages' views on non article pages", esc\_html( $this->plugin\_name ) ); ?>"> |
  |  | 195 | <i class="fas fa-info-circle"></i> |
  |  | 196 | </a> |
  |  | 197 | </th> |
  |  | 198 | <td> |
  |  | 199 | <input type="checkbox" name="non\_article\_pages" value="on" <?php checked( $this->settings['non\_article\_pages'], 'on' ) ?> /> |
  | 456 | 200 | </td> |
  | 457 | 201 | </tr> |
  | 458 | 202 | </table> |
  | 459 | 203 | </div> |
  | 460 |  | <div id="tab2" class="vuukle-tab-content <?php echo (~~$vuukle\_tab == 'tab2'~~) ? 'vuukle-tab-content-active' : ''; ?>"> |
  |  | 204 | <div id="tab2" class="vuukle-tab-content <?php echo ( $vuukle\_tab == 'tab2' ) ? 'vuukle-tab-content-active' : ''; ?>"> |
  | 461 | 205 | <table class="form-table settings-table"> |
  | 462 | 206 | <tr> |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/partials/free-comments-for-wordpress-vuukle-admin-display.php?rev=2533938#L467) | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/partials/free-comments-for-wordpress-vuukle-admin-display.php?rev=2553337#L211) |  |
  | 467 | 211 | <tr valign="top"> |
  | 468 | 212 | <th scope="row"> |
  | 469 |  | Show Share Bar <a class="vuukle\_help" data-toggle="tooltip" title="<?php \_e(~~"Choose to show share bar or not", esc\_html($this->plugin\_name)~~); ?>"> |
  | 470 |  | <i class="fas fa-info-circle"></i> |
  | 471 |  | </a> |
  | 472 |  | <br/> |
  |  | 213 | Show Share Bar <a class="vuukle\_help" data-toggle="tooltip" title="<?php \_e( "Choose to show share bar or not", esc\_html( $this->plugin\_name ) ); ?>"> |
  |  | 214 | <i class="fas fa-info-circle"></i> |
  |  | 215 | </a> |
  |  | 216 | <br/> |
  | 473 | 217 | </th> |
  | 474 | 218 | <td> |
  | 475 | 219 | Off |
  | 476 |  | <input type="radio" name="share" value="0" checked="checked"/> |
  |  | 220 | <input type="radio" name="share" value="0" checked="checked"/> |
  | 477 | 221 | On |
  | 478 |  | <input type="radio" name="share" value="1" <?php checked(~~$this->settings['share'], 1~~); ?> /> |
  | 479 |  | <img src="<?php echo VUUKLE\_ADMIN\_URL . '/images/share.png'; ?>"/> |
  | 480 |  | </td> |
  | 481 |  | </tr> |
  | 482 |  | <tr valign="top"> |
  | 483 |  | <th scope="row"> |
  | 484 |  | Share Bar Position <a class="vuukle\_help" data-toggle="tooltip" title="<?php \_e(~~"Select the location where you want to display the share bar", esc\_html($this->plugin\_name)~~); ?>"> |
  | 485 |  | <i class="fas fa-info-circle"></i> |
  | 486 |  | </a> |
  | 487 |  | <br/> |
  |  | 222 | <input type="radio" name="share" value="1" <?php checked( $this->settings['share'], 1 ); ?> /> |
  |  | 223 | <img src="<?php echo VUUKLE\_ADMIN\_URL . '/images/share.png'; ?>"/> |
  |  | 224 | </td> |
  |  | 225 | </tr> |
  |  | 226 | <tr valign="top"> |
  |  | 227 | <th scope="row"> |
  |  | 228 | Share Bar Position <a class="vuukle\_help" data-toggle="tooltip" title="<?php \_e( "Select the location where you want to display the share bar", esc\_html( $this->plugin\_name ) ); ?>"> |
  |  | 229 | <i class="fas fa-info-circle"></i> |
  |  | 230 | </a> |
  |  | 231 | <br/> |
  | 488 | 232 | </th> |
  | 489 | 233 | <td> |
  | 490 | 234 | After Content Post |
  | 491 | 235 | <input type="checkbox" name="share\_position" value="1" <?php |
  | 492 |  | ~~if ('1' === $this->settings['share\_position']~~) { |
  | 493 |  | echo 'checked="checked"'; |
  | 494 |  | } |
  | 495 |  | ?> /> |
  |  | 236 | if ( '1' === $this->settings['share\_position'] ) { |
  |  | 237 | echo 'checked="checked"'; |
  |  | 238 | } |
  |  | 239 | ?> /> |
  | 496 | 240 | Before Content Post |
  | 497 | 241 | <input type="checkbox" name="share\_position2" value="1" <?php |
  | 498 |  | ~~if ('1' === $this->settings['share\_position2']~~) { |
  | 499 |  | echo 'checked="checked"'; |
  | 500 |  | } |
  | 501 |  | ?> /> |
  | 502 |  | </td> |
  | 503 |  | </tr> |
  | 504 |  |  |
  | 505 |  | <tr valign="top"> |
  | 506 |  | <th scope="row"> |
  | 507 |  | Share Bar Type <a class="vuukle\_help" data-toggle="tooltip" title="<?php \_e(~~"Choose the position to be displayed (horizontal or vertical)", esc\_html($this->plugin\_name)~~); ?>"> |
  | 508 |  | <i class="fas fa-info-circle"></i> |
  | 509 |  | </a> |
  | 510 |  | <br/> |
  |  | 242 | if ( '1' === $this->settings['share\_position2'] ) { |
  |  | 243 | echo 'checked="checked"'; |
  |  | 244 | } |
  |  | 245 | ?> /> |
  |  | 246 | </td> |
  |  | 247 | </tr> |
  |  | 248 |  |
  |  | 249 | <tr valign="top"> |
  |  | 250 | <th scope="row"> |
  |  | 251 | Share Bar Type <a class="vuukle\_help" data-toggle="tooltip" title="<?php \_e( "Choose the position to be displayed (horizontal or vertical)", esc\_html( $this->plugin\_name ) ); ?>"> |
  |  | 252 | <i class="fas fa-info-circle"></i> |
  |  | 253 | </a> |
  |  | 254 | <br/> |
  | 511 | 255 | </th> |
  | 512 | 256 | <td> |
  | 513 | 257 | Horizontal |
  | 514 | 258 | <input type="checkbox" name="share\_type" value="horizontal" <?php |
  | 515 |  | ~~if ('horizontal' === $this->settings['share\_type']~~) { |
  | 516 |  | echo 'checked="checked"'; |
  | 517 |  | } ?> /> |
  |  | 259 | if ( 'horizontal' === $this->settings['share\_type'] ) { |
  |  | 260 | echo 'checked="checked"'; |
  |  | 261 | } ?> /> |
  | 518 | 262 |  |
  | 519 | 263 | Vertical |
  | 520 | 264 | <input type="checkbox" name="share\_type\_vertical" value="vertical" <?php |
  | 521 |  | ~~if ('vertical' === $this->settings['share\_type\_vertical']~~) { |
  | 522 |  | echo 'checked="checked"'; |
  | 523 |  | } ?> /> |
  |  | 265 | if ( 'vertical' === $this->settings['share\_type\_vertical'] ) { |
  |  | 266 | echo 'checked="checked"'; |
  |  | 267 | } ?> /> |
  | 524 | 268 | </td> |
  | 525 | 269 | </tr> |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/partials/free-comments-for-wordpress-vuukle-admin-display.php?rev=2533938#L528) | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/partials/free-comments-for-wordpress-vuukle-admin-display.php?rev=2553337#L272) |  |
  | 528 | 272 | function handleChangeYes(src) { |
  | 529 | 273 | document.getElementById("embed\_powerbar1").disabled = true; |
  | 530 |  | document.getElementById("div\_class\_powerbar1").disabled = true; |
  |  | 274 | document.getElementById("div\_class\_powerbar1").disabled = true; |
  | 531 | 275 | } |
  | 532 | 276 |  |
  | 533 | 277 | function handleChangeNo(src) { |
  | 534 | 278 | document.getElementById("embed\_powerbar1").disabled = false; |
  | 535 |  | document.getElementById("div\_class\_powerbar1").disabled = false; |
  |  | 279 | document.getElementById("div\_class\_powerbar1").disabled = false; |
  | 536 | 280 | } |
  | 537 | 281 | </script> |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/partials/free-comments-for-wordpress-vuukle-admin-display.php?rev=2533938#L539) | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/partials/free-comments-for-wordpress-vuukle-admin-display.php?rev=2553337#L283) |  |
  | 539 | 283 | <tr valign="top"> |
  | 540 | 284 | <th scope="row"> |
  | 541 |  | Enable horizontal for mobile and vertical for desktop <a class="vuukle\_help" data-toggle="tooltip" title="<?php \_e("Choose the position to be displayed (horizontal or vertical)", esc\_html($this->plugin\_name)); ?>"> |
  | 542 |  | <i class="fas fa-info-circle"></i> |
  | 543 |  | </a> |
  | 544 |  | <br /> |
  |  | 285 | Enable horizontal for mobile and vertical for desktop <a class="vuukle\_help" data-toggle="tooltip" |
  |  | 286 | title="<?php \_e( "Choose the position to be displayed (horizontal or vertical)", esc\_html( $this->plugin\_name ) ); ?>"> |
  |  | 287 | <i class="fas fa-info-circle"></i> |
  |  | 288 | </a> |
  |  | 289 | <br/> |
  | 545 | 290 | </th> |
  | 546 | 291 | <td> |
  | 547 | 292 | Yes |
  | 548 |  | <input type="radio" name="enable\_h\_v" onchange="handleChangeYes(this);" value="yes" <?php checked(~~$this->settings['enable\_h\_v'], 'yes'~~); ?> /> |
  |  | 293 | <input type="radio" name="enable\_h\_v" onchange="handleChangeYes(this);" value="yes" <?php checked( $this->settings['enable\_h\_v'], 'yes' ); ?> /> |
  | 549 | 294 |  |
  | 550 | 295 | No |
  | 551 |  | <input type="radio" name="enable\_h\_v" value="no" onchange="handleChangeNo(this);" <?php checked($this->settings['enable\_h\_v'], 'no'); ?> /> |
  | 552 |  |  |
  | 553 |  | </td> |
  | 554 |  | </tr> |
  | 555 |  |  |
  | 556 |  | <tr valign="top"> |
  | 557 |  | <th scope="row"> |
  | 558 |  | Share Bar Styles (only for vertical type) <a class="vuukle\_help" data-toggle="tooltip" title="<?php \_e("Write the styles of your preference(only for vertical type)", esc\_html($this->plugin\_name)); ?>"> |
  | 559 |  | <i class="fas fa-info-circle"></i> |
  | 560 |  | </a> |
  | 561 |  | <br /> |
  | 562 |  | </th> |
  | 563 |  | <td> |
  | 564 |  | <textarea style="height:250px" name="share\_vertical\_styles"><?php echo esc\_attr($this->settings['share\_vertical\_styles']); ?></textarea> |
  | 565 |  | </td> |
  | 566 |  | </tr> |
  | 567 |  |  |
  | 568 |  | <tr> |
  | 569 |  | <th>DIV Container Class Horizontal<a class="vuukle\_help" data-toggle="tooltip" title="<?php \_e("Specify the element Class under which you want the PowerBar to be displayed", esc\_html($this->plugin\_name)); ?>"> |
  | 570 |  | <i class="fas fa-info-circle"></i> |
  | 571 |  | </a></th> |
  | 572 |  | <td> |
  | 573 |  | <input type="radio" id="embed\_powerbar1" name="embed\_powerbar" value="1" <?php checked($this->settings['embed\_powerbar'], '1'); ?> <?php checked($this->settings['embed\_powerbar'], '1'); ?> <?php if ( |
  | 574 |  | $this->settings['enable\_h\_v'] === "yes" |
  | 575 |  | ) { |
  | 576 |  | echo 'disabled'; |
  | 577 |  | } ?> /> |
  | 578 |  | <input type="text" id="div\_class\_powerbar1" name="div\_class\_powerbar" value="<?php echo esc\_attr($this->settings['div\_class\_powerbar']); ?>" <?php if ( |
  | 579 |  | $this->settings['enable\_h\_v'] === "yes" |
  | 580 |  | ) { |
  | 581 |  | echo 'disabled'; |
  | 582 |  | } ?>> |
  | 583 |  | </td> |
  | 584 |  | </tr> |
  | 585 |  | <tr> |
  | 586 |  | <th>DIV Container ID Horizontal <a class="vuukle\_help" data-toggle="tooltip" title="<?php \_e("Specify the element ID under which you want the PowerBar to be displayed", esc\_html($this->plugin\_name)); ?>"> |
  | 587 |  | <i class="fas fa-info-circle"></i> |
  | 588 |  | </a></th> |
  | 589 |  | <td> |
  | 590 |  | <input type="radio" id="embed\_powerbar2" name="embed\_powerbar" value="2" <?php checked($this->settings['embed\_powerbar'], '2'); ?> > |
  | 591 |  | <input type="text"  name="div\_id\_powerbar" value="<?php echo esc\_attr($this->settings['div\_id\_powerbar']); ?>" > |
  | 592 |  | </td> |
  | 593 |  | </tr> |
  | 594 |  |  |
  | 595 |  | <tr valign="top"> |
  | 596 |  | <th scope="row"> |
  | 597 |  | Sharing option customization <a class="vuukle\_help" data-toggle="tooltip" title="<?php \_e("Select the sharing buttons you want to display", esc\_html($this->plugin\_name)); ?>"> |
  | 598 |  | <i class="fas fa-info-circle"></i> |
  | 599 |  | </a> |
  | 600 |  | <br /> |
  | 601 |  | </th> |
  | 602 |  | <td> |
  | 603 |  |  |
  | 604 |  |  |
  | 605 |  | <form method="get"> |
  | 606 |  |  |
  | 607 |  | <input type="checkbox" name="items\_powerbar[]" value="facebook" <?php if (in\_array('facebook', $this->settings['items\_powerbar'])) { |
  | 608 |  | echo 'checked="checked"'; |
  | 609 |  | } ?> />Facebook <br /> |
  | 610 |  |  |
  | 611 |  | <input type="checkbox" name="items\_powerbar[]" value="twitter" <?php if (in\_array('twitter', $this->settings['items\_powerbar'])) { |
  | 612 |  | echo 'checked="checked"'; |
  | 613 |  | } ?> />Twitter <br /> |
  | 614 |  |  |
  | 615 |  | <input type="checkbox" name="items\_powerbar[]" value="whatsapp" <?php if (in\_array('whatsapp', $this->settings['items\_powerbar'])) { |
  | 616 |  | echo 'checked="checked"'; |
  | 617 |  | } ?> />Whatsapp <br /> |
  | 618 |  |  |
  | 619 |  | <input type="checkbox" name="items\_powerbar[]" value="linkedin" <?php if (in\_array('linkedin', $this->settings['items\_powerbar'])) { |
  | 620 |  | echo 'checked="checked"'; |
  | 621 |  | } ?> />Linkedin <br /> |
  | 622 |  |  |
  | 623 |  | <input type="checkbox" name="items\_powerbar[]" value="reddit" <?php if (in\_array('reddit', $this->settings['items\_powerbar'])) { |
  | 624 |  | echo 'checked="checked"'; |
  | 625 |  | } ?> />Reddit <br /> |
  | 626 |  |  |
  | 627 |  | <input type="checkbox" name="items\_powerbar[]" value="messenger" <?php if (in\_array('messenger', $this->settings['items\_powerbar'])) { |
  | 628 |  | echo 'checked="checked"'; |
  | 629 |  | } ?> />Messenger <br /> |
  | 630 |  |  |
  | 631 |  | <input type="checkbox" name="items\_powerbar[]" value="telegram" <?php if (in\_array('telegram', $this->settings['items\_powerbar'])) { |
  | 632 |  | echo 'checked="checked"'; |
  | 633 |  | } ?> />Telegram <br /> |
  | 634 |  |  |
  | 635 |  | <input type="checkbox" name="items\_powerbar[]" value="pinterest" <?php if (in\_array('pinterest', $this->settings['items\_powerbar'])) { |
  | 636 |  | echo 'checked="checked"'; |
  | 637 |  | } ?> />Pinterest <br /> |
  | 638 |  |  |
  | 639 |  | <input type="checkbox" name="items\_powerbar[]" value="flipboard" <?php if (in\_array('flipboard', $this->settings['items\_powerbar'])) { |
  | 640 |  | echo 'checked="checked"'; |
  | 641 |  | } ?> />Flipboard <br /> |
  | 642 |  |  |
  | 643 |  | <input type="checkbox" name="items\_powerbar[]" value="email" <?php if (in\_array('email', $this->settings['items\_powerbar'])) { |
  | 644 |  | echo 'checked="checked"'; |
  | 645 |  | } ?> />Email <br /> |
  | 646 |  |  |
  | 647 |  | <input type="checkbox" name="items\_powerbar[]" value="gab" <?php if (in\_array('gab', $this->settings['items\_powerbar'])) { |
  | 648 |  | echo 'checked="checked"'; |
  | 649 |  | } ?> />Gab <br /> |
  | 650 |  |  |
  | 651 |  | <input type="checkbox" name="items\_powerbar[]" value="parler" <?php if (in\_array('parler', $this->settings['items\_powerbar'])) { |
  | 652 |  | echo 'checked="checked"'; |
  | 653 |  | } ?> />Parler <br /> |
  | 654 |  |  |
  | 655 |  | </form> |
  | 656 |  | <?php |
  | 657 |  |  |
  | 658 |  | $settings\_powerbar = get\_option('Vuukle'); |
  | 659 |  | $items\_powerbar = array( |
  | 660 |  | 'facebook', |
  | 661 |  | 'twitter', |
  | 662 |  | 'whatsapp', |
  | 663 |  | 'linkedin', |
  | 664 |  | 'reddit', |
  | 665 |  | 'messenger', |
  | 666 |  | 'telegram', |
  | 667 |  | 'pinterest', |
  | 668 |  | 'flipboard', |
  | 669 |  | 'email', |
  | 670 |  | ); |
  | 671 |  | $items\_powerbar = isset($settings\_powerbar['items\_powerbar']) ? $settings\_powerbar['items\_powerbar'] : $items\_powerbar; |
  | 672 |  |  |
  | 673 |  | ?> |
  |  | 296 | <input type="radio" name="enable\_h\_v" value="no" onchange="handleChangeNo(this);" <?php checked( $this->settings['enable\_h\_v'], 'no' ); ?> /> |
  |  | 297 |  |
  |  | 298 | </td> |
  |  | 299 | </tr> |
  |  | 300 |  |
  |  | 301 | <tr> |
  |  | 302 | <th>DIV Container Class Horizontal<a class="vuukle\_help" data-toggle="tooltip" |
  |  | 303 | title="<?php \_e( "Specify the element Class under which you want the PowerBar to be displayed", esc\_html( $this->plugin\_name ) ); ?>"> |
  |  | 304 | <i class="fas fa-info-circle"></i> |
  |  | 305 | </a></th> |
  |  | 306 | <td> |
  |  | 307 | <input type="radio" id="embed\_powerbar1" name="embed\_powerbar" value="1" <?php checked( $this->settings['embed\_powerbar'], '1' ); ?> <?php checked( $this->settings['embed\_powerbar'], |
  |  | 308 | '1' ); ?> <?php if ( $this->settings['enable\_h\_v'] === "yes" ) { |
  |  | 309 | echo 'disabled'; |
  |  | 310 | } ?> /> |
  |  | 311 | <input type="text" id="div\_class\_powerbar1" name="div\_class\_powerbar" value="<?php echo esc\_attr( $this->settings['div\_class\_powerbar'] ); ?>" <?php if ( $this->settings['enable\_h\_v'] |
  |  | 312 | === "yes" ) { |
  |  | 313 | echo 'disabled'; |
  |  | 314 | } ?>> |
  |  | 315 | </td> |
  |  | 316 | </tr> |
  |  | 317 | <tr> |
  |  | 318 | <th>DIV Container ID Horizontal <a class="vuukle\_help" data-toggle="tooltip" |
  |  | 319 | title="<?php \_e( "Specify the element ID under which you want the PowerBar to be displayed", esc\_html( $this->plugin\_name ) ); ?>"> |
  |  | 320 | <i class="fas fa-info-circle"></i> |
  |  | 321 | </a></th> |
  |  | 322 | <td> |
  |  | 323 | <input type="radio" id="embed\_powerbar2" name="embed\_powerbar" value="2" <?php checked( $this->settings['embed\_powerbar'], '2' ); ?> > |
  |  | 324 | <input type="text" name="div\_id\_powerbar" value="<?php echo esc\_attr( $this->settings['div\_id\_powerbar'] ); ?>"> |
  |  | 325 | </td> |
  |  | 326 | </tr> |
  |  | 327 |  |
  |  | 328 | <tr valign="top"> |
  |  | 329 | <th scope="row"> |
  |  | 330 | Sharing option customization <a class="vuukle\_help" data-toggle="tooltip" title="<?php \_e( "Select the sharing buttons you want to display", esc\_html( $this->plugin\_name ) ); ?>"> |
  |  | 331 | <i class="fas fa-info-circle"></i> |
  |  | 332 | </a> |
  |  | 333 | <br/> |
  |  | 334 | </th> |
  |  | 335 | <td> |
  |  | 336 | <?php |
  |  | 337 | $settings\_powerbar = get\_option( 'Vuukle' ); |
  |  | 338 | ?> |
  | 674 | 339 | </td> |
  | 675 | 340 | </tr> |
  | 676 | 341 | </table> |
  | 677 | 342 | </div> |
  | 678 |  |  |
  | 679 |  |  |
  | 680 |  | <div id="tab3" class="vuukle-tab-content <?php echo ($vuukle\_tab == 'tab3') ? 'vuukle-tab-content-active' : ''; ?>"> |
  | 681 |  | <table class="form-table settings-table"> |
  | 682 |  | <tr> |
  | 683 |  | <th scope="row"> |
  | 684 |  | <h2 class="title-setting">Custom Sharing URLs</h2> |
  | 685 |  | </th> |
  | 686 |  |  |
  | 687 |  | </tr> |
  | 688 |  |  |
  | 689 |  | <tr> |
  | 690 |  | <th scope="row"> |
  | 691 |  | Twitter Handle <a class="vuukle\_help" data-toggle="tooltip" title="<?php \_e("Add your twitter handle", esc\_html($this->plugin\_name)); ?>"> |
  | 692 |  | <i class="fas fa-info-circle"></i> |
  | 693 |  | </a> |
  | 694 |  | </th> |
  | 695 |  | <td> |
  | 696 |  | <input type="text" name="twitter\_handle" value="<?php echo esc\_attr($this->settings['twitter\_handle']); ?>" /> |
  | 697 |  | </td> |
  | 698 |  | </tr> |
  | 699 |  | </table> |
  | 700 |  | </div> |
  | 701 |  | <div id="tab4" class="vuukle-tab-content <?php echo ($vuukle\_tab == 'tab4') ? 'vuukle-tab-content-active' : ''; ?>"> |
  |  | 343 | <div id="tab4" class="vuukle-tab-content <?php echo ( $vuukle\_tab == 'tab4' ) ? 'vuukle-tab-content-active' : ''; ?>"> |
  | 702 | 344 | <table class="form-table settings-table"> |
  | 703 | 345 | <tr> |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/partials/free-comments-for-wordpress-vuukle-admin-display.php?rev=2533938#L709) | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/partials/free-comments-for-wordpress-vuukle-admin-display.php?rev=2553337#L351) |  |
  | 709 | 351 | <th scope="row"> |
  | 710 | 352 | Show Emote at the end of each post |
  | 711 |  | <a class="vuukle\_help" data-toggle="tooltip" title="<?php \_e("Select this option to place Reactions at the end of each post․ (To disable Reactions uncheck the box)", esc\_html($this->plugin\_name)); ?>"> |
  |  | 353 | <a class="vuukle\_help" data-toggle="tooltip" |
  |  | 354 | title="<?php \_e( "Select this option to place Reactions at the end of each post․ (To disable Reactions uncheck the box)", esc\_html( $this->plugin\_name ) ); ?>"> |
  | 712 | 355 | <i class="fas fa-info-circle"></i> |
  | 713 | 356 | </a> |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/partials/free-comments-for-wordpress-vuukle-admin-display.php?rev=2533938#L717) | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/partials/free-comments-for-wordpress-vuukle-admin-display.php?rev=2553337#L360) |  |
  | 717 | 360 | <td colspan="3"> |
  | 718 | 361 | Off |
  | 719 |  | <input type="radio" name="emote" value="false" checked="checked"/> |
  |  | 362 | <input type="radio" name="emote" value="false" checked="checked"/> |
  | 720 | 363 | On |
  | 721 |  | <input type="radio" name="emote" value="true" <?php checked(~~$this->settings['emote'], 'true'~~); ?> /> |
  | 722 |  |  |
  | 723 |  | <img style="width: 400px" src="<?php echo VUUKLE\_ADMIN\_URL . '/images/emote.png'; ?>"/> |
  |  | 364 | <input type="radio" name="emote" value="true" <?php checked( $this->settings['emote'], 'true' ); ?> /> |
  |  | 365 |  |
  |  | 366 | <img style="width: 400px" src="<?php echo VUUKLE\_ADMIN\_URL . '/images/emote.png'; ?>"/> |
  | 724 | 367 | <br> |
  | 725 | 368 |  |
  | 726 |  | <div style="margin-left: 98px;"> |
  | 727 |  | <label> |
  | 728 |  | <input <?php echo ($this->settings['emote\_enabled1'] == '1') ? "checked='checked'" : ''; ?> type="checkbox" name="emote\_enabled1" value="1"> |
  | 729 |  | <?php esc\_html\_e(($this->settings['happy\_text']), $this->plugin\_name); ?> |
  | 730 |  | </label> |
  | 731 |  | <label> |
  | 732 |  | <input <?php echo ($this->settings['emote\_enabled2'] == '2') ? "checked='checked'" : ''; ?> type="checkbox" name="emote\_enabled2" value="2"> |
  | 733 |  | <?php esc\_html\_e($this->settings['indifferent\_text'], $this->plugin\_name); ?> |
  | 734 |  | </label> |
  | 735 |  | <label> |
  | 736 |  | <input <?php echo ($this->settings['emote\_enabled3'] == '3') ? "checked='checked'" : ''; ?> type="checkbox" name="emote\_enabled3" value="3"> |
  | 737 |  | <?php esc\_html\_e($this->settings['amused\_text'], $this->plugin\_name); ?> |
  | 738 |  | </label> |
  | 739 |  | <label> |
  | 740 |  | <input <?php echo ($this->settings['emote\_enabled4'] == '4') ? "checked='checked'" : ''; ?> type="checkbox" name="emote\_enabled4" value="4"> |
  | 741 |  | <?php esc\_html\_e($this->settings['excited\_text'], $this->plugin\_name); ?> |
  | 742 |  | </label> |
  | 743 |  | <label> |
  | 744 |  | <input <?php echo ($this->settings['emote\_enabled5'] == '5') ? "checked='checked'" : ''; ?> type="checkbox" name="emote\_enabled5" value="5"> |
  | 745 |  | <?php esc\_html\_e($this->settings['angry\_text'], $this->plugin\_name); ?> |
  | 746 |  | </label> |
  | 747 |  | <label> |
  | 748 |  | <input <?php echo ($this->settings['emote\_enabled6'] == '6') ? "checked='checked'" : ''; ?> type="checkbox" name="emote\_enabled6" value="6"> |
  | 749 |  | <?php esc\_html\_e($this->settings['sad\_text'], $this->plugin\_name); ?> |
  | 750 |  | </label> |
  | 751 |  | </div> |
  | 752 |  | </td> |
  | 753 |  | </tr> |
  | 754 |  |  |
  | 755 |  | <tr> |
  | 756 |  | <th scope="row"> |
  | 757 |  | Emote first name |
  | 758 |  | <br /> |
  | 759 |  | </th> |
  | 760 |  | <td> |
  | 761 |  | <input type="text" name="happy\_text" value="<?php echo esc\_attr($this->settings['happy\_text']); ?>" placeholder="<?php esc\_html\_e($this->settings['happy\_text'], $this->plugin\_name); ?>"> |
  | 762 |  | </td> |
  | 763 |  | <th scope="row"> |
  | 764 |  | Emote first url image |
  | 765 |  | <br /> |
  | 766 |  | </th> |
  | 767 |  | <td> |
  | 768 |  | <input type="text" name="happy\_url" value="<?php echo esc\_attr($this->settings['happy\_url']); ?>" placeholder=""> |
  | 769 |  | </td> |
  | 770 |  | </tr> |
  | 771 |  | <tr> |
  | 772 |  | <th scope="row"> |
  | 773 |  | Emote second name |
  | 774 |  | <br /> |
  | 775 |  | </th> |
  | 776 |  | <td> |
  | 777 |  | <input type="text" name="indifferent\_text" value="<?php echo esc\_attr($this->settings['indifferent\_text']); ?>" placeholder="<?php esc\_html\_e($this->settings['indifferent\_text'], $this->plugin\_name); ?>"> |
  | 778 |  | </td> |
  | 779 |  | <th scope="row"> |
  | 780 |  | Emote second url image |
  | 781 |  | <br /> |
  | 782 |  | </th> |
  | 783 |  | <td> |
  | 784 |  | <input type="text" name="indifferent\_url" value="<?php echo esc\_attr($this->settings['indifferent\_url']); ?>" placeholder=""> |
  | 785 |  | </td> |
  | 786 |  | </tr> |
  | 787 |  | <tr> |
  | 788 |  | <th scope="row"> |
  | 789 |  | Emote third name |
  | 790 |  | <br /> |
  | 791 |  | </th> |
  | 792 |  | <td> |
  | 793 |  | <input type="text" name="amused\_text" value="<?php echo esc\_attr($this->settings['amused\_text']); ?>" placeholder="<?php esc\_html\_e($this->settings['amused\_text'], $this->plugin\_name); ?>"> |
  | 794 |  | </td> |
  | 795 |  | <th scope="row"> |
  | 796 |  | Emote third url image |
  | 797 |  | <br /> |
  | 798 |  | </th> |
  | 799 |  | <td> |
  | 800 |  | <input type="text" name="amused\_url" value="<?php echo esc\_attr($this->settings['amused\_url']); ?>" placeholder=""> |
  | 801 |  | </td> |
  | 802 |  | </tr> |
  | 803 |  | <tr> |
  | 804 |  | <th scope="row"> |
  | 805 |  | Emote fourth name |
  | 806 |  | <br /> |
  | 807 |  | </th> |
  | 808 |  | <td> |
  | 809 |  | <input type="text" name="excited\_text" value="<?php echo esc\_attr($this->settings['excited\_text']); ?>" placeholder="<?php esc\_html\_e($this->settings['excited\_text'], $this->plugin\_name); ?>"> |
  | 810 |  | </td> |
  | 811 |  | <th scope="row"> |
  | 812 |  | Emote fourth url image |
  | 813 |  | <br /> |
  | 814 |  | </th> |
  | 815 |  | <td> |
  | 816 |  | <input type="text" name="excited\_url" value="<?php echo esc\_attr($this->settings['excited\_url']); ?>" placeholder=""> |
  | 817 |  | </td> |
  | 818 |  | </tr> |
  | 819 |  | <tr> |
  | 820 |  | <th scope="row"> |
  | 821 |  | Emote fifth name |
  | 822 |  | <br /> |
  | 823 |  | </th> |
  | 824 |  | <td> |
  | 825 |  | <input type="text" name="angry\_text" value="<?php echo esc\_attr($this->settings['angry\_text']); ?>" placeholder="<?php esc\_html\_e($this->settings['angry\_text'], $this->plugin\_name); ?>"> |
  | 826 |  | </td> |
  | 827 |  | <th scope="row"> |
  | 828 |  | Emote fifth url image |
  | 829 |  | <br /> |
  | 830 |  | </th> |
  | 831 |  | <td> |
  | 832 |  | <input type="text" name="angry\_url" value="<?php echo esc\_attr($this->settings['angry\_url']); ?>" placeholder=""> |
  | 833 |  | </td> |
  | 834 |  | </tr> |
  | 835 |  | <tr> |
  | 836 |  | <th scope="row"> |
  | 837 |  | Emote sixth name |
  | 838 |  | <br /> |
  | 839 |  | </th> |
  | 840 |  | <td> |
  | 841 |  | <input type="text" name="sad\_text" value="<?php echo esc\_attr($this->settings['sad\_text']); ?>" placeholder="<?php esc\_html\_e($this->settings['sad\_text'], $this->plugin\_name); ?>"> |
  | 842 |  | </td> |
  | 843 |  | <th scope="row"> |
  | 844 |  | Emote sixth url image |
  | 845 |  | <br /> |
  | 846 |  | </th> |
  | 847 |  | <td> |
  | 848 |  | <input type="text" name="sad\_url" value="<?php echo esc\_attr($this->settings['sad\_url']); ?>" placeholder=""> |
  | 849 |  | </td> |
  | 850 |  | </tr> |
  | 851 |  | <tr> |
  | 852 |  | <th>Emote size <a class="vuukle\_help" data-toggle="tooltip" title="<?php esc\_html\_e("Specify the size of emojis", $this->plugin\_name); ?>"> |
  | 853 |  | <i class="fas fa-info-circle"></i> |
  | 854 |  | </a></th> |
  | 855 |  | <td> |
  | 856 |  | <input type="number" name="size\_emote" value="<?php echo esc\_attr($this->settings['size\_emote']); ?>" placeholder="70"> px |
  | 857 |  | </td> |
  | 858 |  | </tr> |
  | 859 |  | <tr valign="top"> |
  | 860 |  | <th scope="row"> |
  | 861 |  | Widget width <a class="vuukle\_help" data-toggle="tooltip" title="<?php esc\_html\_e("Specify the Widget width", $this->plugin\_name); ?>"> |
  | 862 |  | <i class="fas fa-info-circle"></i> |
  | 863 |  | </a> |
  | 864 |  | <br /> |
  | 865 |  | </th> |
  | 866 |  | <td> |
  | 867 |  | <input type="number" name="emote\_widget\_width" value="<?php echo esc\_attr($this->settings['emote\_widget\_width']); ?>" placeholder="600"> px |
  | 868 |  | </td> |
  | 869 |  | </tr> |
  | 870 |  | <tr> |
  | 871 |  | <th>Reactions embed Method <a class="vuukle\_help" data-toggle="tooltip" title="<?php esc\_html\_e("Select this option if you want to install Reactions after the content", $this->plugin\_name); ?>"> |
  |  | 369 | </td> |
  |  | 370 | </tr> |
  |  | 371 |  |
  |  | 372 | <tr valign="top"> |
  |  | 373 | <th scope="row"> |
  |  | 374 | Widget width <a class="vuukle\_help" data-toggle="tooltip" title="<?php esc\_html\_e( "Specify the Widget width", $this->plugin\_name ); ?>"> |
  |  | 375 | <i class="fas fa-info-circle"></i> |
  |  | 376 | </a> |
  |  | 377 | <br/> |
  |  | 378 | </th> |
  |  | 379 | <td> |
  |  | 380 | <input type="number" name="emote\_widget\_width" value="<?php echo esc\_attr( $this->settings['emote\_widget\_width'] ); ?>" placeholder="600"> px |
  |  | 381 | </td> |
  |  | 382 | </tr> |
  |  | 383 | <tr> |
  |  | 384 | <th>Reactions embed Method <a class="vuukle\_help" data-toggle="tooltip" title="<?php esc\_html\_e( "Select this option if you want to install Reactions after the content", $this->plugin\_name ); ?>"> |
  | 872 | 385 | <i class="fas fa-info-circle"></i> |
  | 873 | 386 | </a></th> |
  | 874 | 387 | <td> |
  | 875 | 388 | <label> |
  | 876 |  | <input type="radio" name="embed\_emotes" value="0" <?php checked(~~$this->settings['embed\_emotes'], '0'~~); ?> /> |
  |  | 389 | <input type="radio" name="embed\_emotes" value="0" <?php checked( $this->settings['embed\_emotes'], '0' ); ?> /> |
  | 877 | 390 | Insert After the Content |
  | 878 | 391 | </label> |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/partials/free-comments-for-wordpress-vuukle-admin-display.php?rev=2533938#L880) | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/partials/free-comments-for-wordpress-vuukle-admin-display.php?rev=2553337#L393) |  |
  | 880 | 393 | </tr> |
  | 881 | 394 | <tr class="embed\_fields\_emotes"> |
  | 882 |  | <th>DIV Container Class <a class="vuukle\_help" data-toggle="tooltip" title="<?php esc\_html\_e(~~"Specify the element Class under which you want the Reactions to be displayed", $this->plugin\_name~~); ?>"> |
  | 883 |  | <i class="fas fa-info-circle"></i> |
  | 884 |  | </a></th> |
  | 885 |  | <td> |
  | 886 |  | <input type="radio" name="embed\_emotes" value="1" <?php checked(~~$this->settings['embed\_emotes'], '1'~~); ?> /> |
  | 887 |  | <input type="text" <?php echo (~~'1' === $this->settings['embed\_emotes']) ? 'class="reg1"' : ''; ?> name="div\_class\_emotes" value="<?php echo esc\_attr($this->settings['div\_class\_emotes']~~); ?>"> |
  |  | 395 | <th>DIV Container Class <a class="vuukle\_help" data-toggle="tooltip" title="<?php esc\_html\_e( "Specify the element Class under which you want the Reactions to be displayed", $this->plugin\_name ); ?>"> |
  |  | 396 | <i class="fas fa-info-circle"></i> |
  |  | 397 | </a></th> |
  |  | 398 | <td> |
  |  | 399 | <input type="radio" name="embed\_emotes" value="1" <?php checked( $this->settings['embed\_emotes'], '1' ); ?> /> |
  |  | 400 | <input type="text" <?php echo ( '1' === $this->settings['embed\_emotes'] ) ? 'class="reg1"' : ''; ?> name="div\_class\_emotes" value="<?php echo esc\_attr( $this->settings['div\_class\_emotes'] ); ?>"> |
  | 888 | 401 | </td> |
  | 889 | 402 | </tr> |
  | 890 | 403 | <tr class="embed\_fields\_emotes"> |
  | 891 |  | <th>DIV Container ID <a class="vuukle\_help" data-toggle="tooltip" title="<?php esc\_html\_e(~~"Specify the element ID under which you want the Reactions to be displayed", $this->plugin\_name~~); ?>"> |
  | 892 |  | <i class="fas fa-info-circle"></i> |
  | 893 |  | </a></th> |
  | 894 |  | <td> |
  | 895 |  | <input type="radio" name="embed\_emotes" value="2" <?php checked(~~$this->settings['embed\_emotes'], '2'~~); ?> /> |
  | 896 |  | <input type="text" <?php echo (~~'2' === $this->settings['embed\_emotes']) ? 'class="reg1"' : ''; ?> name="div\_id\_emotes" value="<?php echo esc\_attr($this->settings['div\_id\_emotes']~~); ?>"> |
  |  | 404 | <th>DIV Container ID <a class="vuukle\_help" data-toggle="tooltip" title="<?php esc\_html\_e( "Specify the element ID under which you want the Reactions to be displayed", $this->plugin\_name ); ?>"> |
  |  | 405 | <i class="fas fa-info-circle"></i> |
  |  | 406 | </a></th> |
  |  | 407 | <td> |
  |  | 408 | <input type="radio" name="embed\_emotes" value="2" <?php checked( $this->settings['embed\_emotes'], '2' ); ?> /> |
  |  | 409 | <input type="text" <?php echo ( '2' === $this->settings['embed\_emotes'] ) ? 'class="reg1"' : ''; ?> name="div\_id\_emotes" value="<?php echo esc\_attr( $this->settings['div\_id\_emotes'] ); ?>"> |
  | 897 | 410 | </td> |
  | 898 | 411 | </tr> |
  | 899 | 412 | </table> |
  | 900 | 413 | </div> |
  | 901 |  | <div id="tab5" class="vuukle-tab-content <?php echo (~~$vuukle\_tab == 'tab5'~~) ? 'vuukle-tab-content-active' : ''; ?>"> |
  |  | 414 | <div id="tab5" class="vuukle-tab-content <?php echo ( $vuukle\_tab == 'tab5' ) ? 'vuukle-tab-content-active' : ''; ?>"> |
  | 902 | 415 | <table class="form-table settings-table"> |
  | 903 | 416 | <tr> |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/partials/free-comments-for-wordpress-vuukle-admin-display.php?rev=2533938#L908) | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/partials/free-comments-for-wordpress-vuukle-admin-display.php?rev=2553337#L421) |  |
  | 908 | 421 | <tr> |
  | 909 | 422 | <th> |
  | 910 |  | Enable comments <a class="vuukle\_help" data-toggle="tooltip" title="<?php esc\_html\_e(!empty($this->settings['enabled\_comments']) && $this->settings['enabled\_comments'] === "true" ? "Please choose option No if you don't want enable comments" : "Please choose option Yes if you want enable comments", $this->plugin\_name); ?>"> |
  |  | 423 | Enable comments <a class="vuukle\_help" data-toggle="tooltip" title="<?php esc\_html\_e( ! empty( $this->settings['enabled\_comments'] ) && $this->settings['enabled\_comments'] === "true" |
  |  | 424 | ? "Please choose option No if you don't want enable comments" : "Please choose option Yes if you want enable comments", $this->plugin\_name ); ?>"> |
  | 911 | 425 | <i class="fas fa-info-circle"></i> |
  | 912 | 426 | </a> |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/partials/free-comments-for-wordpress-vuukle-admin-display.php?rev=2533938#L914) | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/partials/free-comments-for-wordpress-vuukle-admin-display.php?rev=2553337#L428) |  |
  | 914 | 428 | <td> |
  | 915 | 429 | No |
  | 916 |  | <input type="radio" name="enabled\_comments" value="false" checked="checked"/> |
  |  | 430 | <input type="radio" name="enabled\_comments" value="false" checked="checked"/> |
  | 917 | 431 | Yes |
  | 918 |  | <input type="radio" name="enabled\_comments" value="true" <?php checked(~~$this->settings['enabled\_comments'], 'true'~~); ?> /> |
  |  | 432 | <input type="radio" name="enabled\_comments" value="true" <?php checked( $this->settings['enabled\_comments'], 'true' ); ?> /> |
  | 919 | 433 | </td> |
  | 920 | 434 | </tr> |
  | 921 | 435 | <tr> |
  | 922 | 436 | <th> |
  | 923 |  | Comments Embed Method <a class="vuukle\_help" data-toggle="tooltip" title="<?php esc\_html\_e("Choose how comments are shown ․ Replace WordPress Comments  or Insert After the Content", $this->plugin\_name); ?>"> |
  |  | 437 | Comments Embed Method <a class="vuukle\_help" data-toggle="tooltip" |
  |  | 438 | title="<?php esc\_html\_e( "Choose how comments are shown ․ Replace WordPress Comments  or Insert After the Content", $this->plugin\_name ); ?>"> |
  | 924 | 439 | <i class="fas fa-info-circle"></i> |
  | 925 | 440 | </a> |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/partials/free-comments-for-wordpress-vuukle-admin-display.php?rev=2533938#L927) | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/partials/free-comments-for-wordpress-vuukle-admin-display.php?rev=2553337#L442) |  |
  | 927 | 442 | <td> |
  | 928 | 443 | <label> |
  | 929 |  | <input type="radio" name="embed\_comments" value="1" <?php checked(~~$this->settings['embed\_comments'], '1'~~); ?> /> |
  |  | 444 | <input type="radio" name="embed\_comments" value="1" <?php checked( $this->settings['embed\_comments'], '1' ); ?> /> |
  | 930 | 445 | Replace WordPress Comments |
  | 931 | 446 | </label> |
  | 932 | 447 | <br><br> |
  | 933 | 448 | <label> |
  | 934 |  | <input type="radio" name="embed\_comments" value="2" <?php checked(~~$this->settings['embed\_comments'], '2'~~); ?> /> |
  |  | 449 | <input type="radio" name="embed\_comments" value="2" <?php checked( $this->settings['embed\_comments'], '2' ); ?> /> |
  | 935 | 450 | Insert After the Content |
  | 936 | 451 | </label> |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/partials/free-comments-for-wordpress-vuukle-admin-display.php?rev=2533938#L938) | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/partials/free-comments-for-wordpress-vuukle-admin-display.php?rev=2553337#L453) |  |
  | 938 | 453 | </tr> |
  | 939 | 454 | <tr class="embed\_fields"> |
  | 940 |  | <th>DIV Container Class <a class="vuukle\_help" data-toggle="tooltip" title="<?php esc\_html\_e(~~"Specify the element Class under which you want the Comments to be displayed", $this->plugin\_name~~); ?>"> |
  | 941 |  | <i class="fas fa-info-circle"></i> |
  | 942 |  | </a></th> |
  | 943 |  | <td> |
  | 944 |  | <input type="radio" name="embed\_comments" value="3" <?php checked(~~$this->settings['embed\_comments'], '3'~~); ?> /> |
  | 945 |  | <input type="text" <?php echo (~~'3' === $this->settings['embed\_comments']) ? 'class="reg"' : ''; ?> name="div\_class" value="<?php echo esc\_attr($this->settings['div\_class']~~); ?>"> |
  |  | 455 | <th>DIV Container Class <a class="vuukle\_help" data-toggle="tooltip" title="<?php esc\_html\_e( "Specify the element Class under which you want the Comments to be displayed", $this->plugin\_name ); ?>"> |
  |  | 456 | <i class="fas fa-info-circle"></i> |
  |  | 457 | </a></th> |
  |  | 458 | <td> |
  |  | 459 | <input type="radio" name="embed\_comments" value="3" <?php checked( $this->settings['embed\_comments'], '3' ); ?> /> |
  |  | 460 | <input type="text" <?php echo ( '3' === $this->settings['embed\_comments'] ) ? 'class="reg"' : ''; ?> name="div\_class" value="<?php echo esc\_attr( $this->settings['div\_class'] ); ?>"> |
  | 946 | 461 | </td> |
  | 947 | 462 | </tr> |
  | 948 | 463 | <tr class="embed\_fields"> |
  | 949 |  | <th>DIV Container ID <a class="vuukle\_help" data-toggle="tooltip" title="<?php esc\_html\_e("Specify the element ID under which you want the Comments to be displayed", $this->plugin\_name); ?>"> |
  | 950 |  | <i class="fas fa-info-circle"></i> |
  | 951 |  | </a></th> |
  | 952 |  | <td> |
  | 953 |  | <input type="radio" name="embed\_comments" value="4" <?php checked($this->settings['embed\_comments'], '4'); ?> /> |
  | 954 |  | <input type="text" <?php echo ('4' === $this->settings['embed\_comments']) ? 'class="reg"' : ''; ?> name="div\_id" value="<?php echo esc\_attr($this->settings['div\_id']); ?>"> |
  | 955 |  | </td> |
  | 956 |  | </tr> |
  | 957 |  |  |
  |  | 464 | <th>DIV Container ID <a class="vuukle\_help" data-toggle="tooltip" title="<?php esc\_html\_e( "Specify the element ID under which you want the Comments to be displayed", $this->plugin\_name ); ?>"> |
  |  | 465 | <i class="fas fa-info-circle"></i> |
  |  | 466 | </a></th> |
  |  | 467 | <td> |
  |  | 468 | <input type="radio" name="embed\_comments" value="4" <?php checked( $this->settings['embed\_comments'], '4' ); ?> /> |
  |  | 469 | <input type="text" <?php echo ( '4' === $this->settings['embed\_comments'] ) ? 'class="reg"' : ''; ?> name="div\_id" value="<?php echo esc\_attr( $this->settings['div\_id'] ); ?>"> |
  |  | 470 | </td> |
  |  | 471 | </tr> |
  | 958 | 472 | </table> |
  | 959 | 473 | </div> |
  | 960 |  | ~~<div id="tab6" class="vuukle-tab-content <?php echo ($vuukle\_tab == 'tab6') ? 'vuukle-tab-content-active' : ''; ?>">~~ |
  | 961 |  | ~~<table class="form-table settings-table">~~ |
  | 962 |  | ~~<tr>~~ |
  | 963 |  | ~~<th colspan="2">~~ |
  | 964 |  | ~~<h2 class="title-setting">Newsfeed Bar widget settings</h2>~~ |
  | 965 |  | ~~</th>~~ |
  | 966 |  | ~~</tr>~~ |
  | 967 |  | ~~<tr valign="top">~~ |
  | 968 |  | ~~<th scope="row">~~ |
  | 969 |  | ~~Show Newsfeed Bar <a class="vuukle\_help" data-toggle="tooltip" title="<?php esc\_html\_e("Select the following option if you want to display the Newsfeed widget", $this->plugin\_name); ?>">~~ |
  | 970 |  | ~~<i class="fas fa-info-circle"></i>~~ |
  | 971 |  | ~~</a>~~ |
  | 972 |  | ~~<br />~~ |
  | 973 |  | ~~</th>~~ |
  | 974 |  | ~~<td>~~ |
  | 975 |  | ~~Off~~ |
  | 976 |  | ~~<input type="radio" name="newsfeed" value="0" checked="checked" />~~ |
  | 977 |  | ~~On~~ |
  | 978 |  | ~~<input type="radio" name="newsfeed" value="1" <?php checked($this->settings['newsfeed'], 1); ?> />~~ |
  | 979 |  | ~~</td>~~ |
  | 980 |  | ~~</tr>~~ |
  | 981 |  | ~~<tr>~~ |
  | 982 |  | ~~<th>DIV Container Class <a class="vuukle\_help" data-toggle="tooltip" title="<?php esc\_html\_e("Specify the element Class under which you want the Newsfeed widget to be displayed", $this->plugin\_name); ?>">~~ |
  | 983 |  | ~~<i class="fas fa-info-circle"></i>~~ |
  | 984 |  | ~~</a></th>~~ |
  | 985 |  | ~~<td>~~ |
  | 986 |  | ~~<input type="radio" name="embed\_newsfeed" value="1" <?php checked($this->settings['embed\_newsfeed'], '1'); ?> />~~ |
  | 987 |  | ~~<input type="text" name="div\_class\_newsfeed" value="<?php echo esc\_attr($this->settings['div\_class\_newsfeed']); ?>">~~ |
  | 988 |  | ~~</td>~~ |
  | 989 |  | ~~</tr>~~ |
  | 990 |  | ~~<tr>~~ |
  | 991 |  | ~~<th>DIV Container ID <a class="vuukle\_help" data-toggle="tooltip" title="<?php esc\_html\_e("Specify the element ID under which you want the Newsfeed widget to be displayed", $this->plugin\_name); ?>">~~ |
  | 992 |  | ~~<i class="fas fa-info-circle"></i>~~ |
  | 993 |  | ~~</a></th>~~ |
  | 994 |  | ~~<td>~~ |
  | 995 |  | ~~<input type="radio" name="embed\_newsfeed" value="2" <?php checked($this->settings['embed\_newsfeed'], '2'); ?> />~~ |
  | 996 |  | ~~<input type="text" name="div\_id\_newsfeed" value="<?php echo esc\_attr($this->settings['div\_id\_newsfeed']); ?>">~~ |
  | 997 |  | ~~</td>~~ |
  | 998 |  | ~~</tr>~~ |
  | 999 |  | ~~</table>~~ |
  | 1000 |  | ~~</div>~~ |
  | 1001 |  | ~~<div id="tab7" class="vuukle-tab-content <?php echo ($vuukle\_tab == 'tab7') ? 'vuukle-tab-content-active' : ''; ?>">~~ |
  | 1002 |  | ~~<table class="form-table settings-table">~~ |
  | 1003 |  | ~~<tr>~~ |
  | 1004 |  | ~~<th colspan="2">~~ |
  | 1005 |  | ~~<h2 class="title-setting">Enable only for endless scroll WP theme</h2>~~ |
  | 1006 |  | ~~</th>~~ |
  | 1007 |  | ~~</tr>~~ |
  | 1008 |  | ~~<tr valign="top">~~ |
  | 1009 |  | ~~<th scope="row">~~ |
  | 1010 |  | ~~Endless <a class="vuukle\_help" data-toggle="tooltip" title="<?php esc\_html\_e("Enable if you have infinite story theme page", $this->plugin\_name); ?>">~~ |
  | 1011 |  | ~~<i class="fas fa-info-circle"></i>~~ |
  | 1012 |  | ~~</a>~~ |
  | 1013 |  | ~~<br />~~ |
  | 1014 |  | ~~</th>~~ |
  | 1015 |  | ~~<td>~~ |
  | 1016 |  | ~~Off~~ |
  | 1017 |  | ~~<input type="radio" name="endless\_mode" value="0" checked="checked" />~~ |
  | 1018 |  | ~~On~~ |
  | 1019 |  | ~~<input type="radio" name="endless\_mode" value="1" <?php checked($this->settings['endless\_mode'], 1); ?> />~~ |
  | 1020 |  | ~~</td>~~ |
  | 1021 |  | ~~</tr>~~ |
  | 1022 |  |  |
  | 1023 |  | ~~<tr valign="top" style="display:none">~~ |
  | 1024 |  | ~~<th scope="row">~~ |
  | 1025 |  | ~~Show Newsletter Bar <a class="vuukle\_help" data-toggle="tooltip" title="<?php esc\_html\_e("lorem ipsum", $this->plugin\_name); ?>">~~ |
  | 1026 |  | ~~<i class="fas fa-info-circle"></i>~~ |
  | 1027 |  | ~~</a>~~ |
  | 1028 |  | ~~<br />~~ |
  | 1029 |  | ~~</th>~~ |
  | 1030 |  | ~~<td>~~ |
  | 1031 |  | ~~Off~~ |
  | 1032 |  | ~~<input disabled type="radio" name="newsletter" value="0" checked="checked" />~~ |
  | 1033 |  | ~~On~~ |
  | 1034 |  | ~~<input disabled type="radio" name="newsletter" value="1" <?php checked($this->settings['newsletter'], 1); ?> />~~ |
  | 1035 |  | ~~</td>~~ |
  | 1036 |  | ~~</tr>~~ |
  | 1037 |  | ~~<tr valign="top" style="display:none">~~ |
  | 1038 |  | ~~<th scope="row">~~ |
  | 1039 |  | ~~Newsletter Bar Position <a class="vuukle\_help" data-toggle="tooltip" title="<?php esc\_html\_e("lorem ipsum", $this->plugin\_name); ?>">~~ |
  | 1040 |  | ~~<i class="fas fa-info-circle"></i>~~ |
  | 1041 |  | ~~</a>~~ |
  | 1042 |  | ~~<br />~~ |
  | 1043 |  | ~~</th>~~ |
  | 1044 |  | ~~<td>~~ |
  | 1045 |  | ~~After Content Post~~ |
  | 1046 |  | ~~<input disabled type="radio" name="newsletter\_position" value="1" checked="checked" />~~ |
  | 1047 |  | ~~Before Content Post~~ |
  | 1048 |  | ~~<input disabled type="radio" name="newsletter\_position" value="2" <?php checked($this->settings['newsletter\_position'], 2); ?> />~~ |
  | 1049 |  | ~~</td>~~ |
  | 1050 |  | ~~</tr>~~ |
  | 1051 |  |  |
  | 1052 |  | ~~</table>~~ |
  | 1053 |  | ~~</div>~~ |
  | 1054 |  | ~~<div id="tab8" class="vuukle-tab-content <?php echo ($vuukle\_tab == 'tab8') ? 'vuukle-tab-content-active' : ''; ?>">~~ |
  | 1055 |  | ~~<table class="form-table settings-table">~~ |
  | 1056 |  | ~~<tr>~~ |
  | 1057 |  | ~~<th scope="row">~~ |
  | 1058 |  | ~~<span>Enable SEO</span>~~ |
  | 1059 |  | ~~</th>~~ |
  | 1060 |  | ~~<td>~~ |
  | 1061 |  | ~~<input name="enable\_seo" type="checkbox" value="on" class="regular-text" <?php echo esc\_html($checked\_seo) ?> />~~ |
  | 1062 |  | ~~</td>~~ |
  | 1063 |  | ~~</tr>~~ |
  | 1064 |  | ~~<tr>~~ |
  | 1065 |  | ~~<th colspan="2">~~ |
  | 1066 |  | ~~<h4 class="title-setting">Organization</h4>~~ |
  | 1067 |  | ~~</th>~~ |
  | 1068 |  | ~~</tr>~~ |
  | 1069 |  | ~~<tr valign="top">~~ |
  | 1070 |  | ~~<th scope="row">~~ |
  | 1071 |  | ~~<span>Facebook URL</span>~~ |
  | 1072 |  | ~~</th>~~ |
  | 1073 |  | ~~<td>~~ |
  | 1074 |  | ~~<input name="vuukle\_facebook\_url" type="text" value="<?php echo esc\_attr($this->settings['vuukle\_facebook\_url']); ?>" class="regular-text" />~~ |
  | 1075 |  | ~~</td>~~ |
  | 1076 |  | ~~</tr>~~ |
  | 1077 |  |  |
  | 1078 |  | ~~<tr valign="top">~~ |
  | 1079 |  | ~~<th scope="row">~~ |
  | 1080 |  | ~~<span>Twitter URL</span>~~ |
  | 1081 |  | ~~</th>~~ |
  | 1082 |  | ~~<td>~~ |
  | 1083 |  | ~~<input name="vuukle\_twitter\_url" type="text" value="<?php print esc\_attr($this->settings['vuukle\_twitter\_url']); ?>" class="regular-text" />~~ |
  | 1084 |  | ~~</td>~~ |
  | 1085 |  | ~~</tr>~~ |
  | 1086 |  | ~~<tr valign="top">~~ |
  | 1087 |  | ~~<th scope="row">~~ |
  | 1088 |  | ~~<span>Linkedin URL</span>~~ |
  | 1089 |  | ~~</th>~~ |
  | 1090 |  | ~~<td>~~ |
  | 1091 |  | ~~<input name="vuukle\_linkedin\_url" type="text" value="<?php print esc\_attr($this->settings['vuukle\_linkedin\_url']); ?>" class="regular-text" />~~ |
  | 1092 |  | ~~</td>~~ |
  | 1093 |  | ~~</tr>~~ |
  | 1094 |  | ~~<tr>~~ |
  | 1095 |  | ~~<th colspan="2">~~ |
  | 1096 |  | ~~<h4 class="title-setting">Publisher</h4>~~ |
  | 1097 |  | ~~</th>~~ |
  | 1098 |  | ~~</tr>~~ |
  | 1099 |  | ~~<tr valign="top">~~ |
  | 1100 |  | ~~<th scope="row">~~ |
  | 1101 |  | ~~<span>Logo URL (<span style="color:red;">\*required</span>)</span>~~ |
  | 1102 |  | ~~</th>~~ |
  | 1103 |  | ~~<td>~~ |
  | 1104 |  | ~~<input name="vuukle\_publisher\_url" type="text" value="<?php print esc\_attr($this->settings['vuukle\_publisher\_url']); ?>" class="regular-text" />~~ |
  | 1105 |  | ~~</td>~~ |
  | 1106 |  | ~~</tr>~~ |
  | 1107 |  | ~~<!-- <tr valign="top" >~~ |
  | 1108 |  | ~~<th scope="row">~~ |
  | 1109 |  | ~~<span>Twitter URL</span>~~ |
  | 1110 |  | ~~</th>~~ |
  | 1111 |  | ~~<td>~~ |
  | 1112 |  | ~~<input name="vuukle\_user\_twitter\_url" type="text" value="<#?php print esc\_attr($this->settings['vuukle\_user\_twitter\_url']); ?>" class="regular-text" />~~ |
  | 1113 |  | ~~</td>~~ |
  | 1114 |  | ~~</tr>~~ |
  | 1115 |  | ~~<tr valign="top" >~~ |
  | 1116 |  | ~~<th scope="row">~~ |
  | 1117 |  | ~~<span>Linkedin URL</span>~~ |
  | 1118 |  | ~~</th>~~ |
  | 1119 |  | ~~<td>~~ |
  | 1120 |  | ~~<input name="vuukle\_user\_linkedin\_url" type="text" value="<#?php print esc\_attr($this->settings['vuukle\_user\_linkedin\_url']); ?>" class="regular-text" />~~ |
  | 1121 |  | ~~</td>~~ |
  | 1122 |  | ~~</tr> -->~~ |
  | 1123 |  | ~~</table>~~ |
  | 1124 |  | ~~</div>~~ |
  | 1125 |  | ~~<style>~~ |
  | 1126 |  | ~~.lined-textarea {~~ |
  | 1127 |  | ~~background: url(http://i.imgur.com/2cOaJ.png);~~ |
  | 1128 |  | ~~background-color: white;~~ |
  | 1129 |  | ~~background-attachment: local;~~ |
  | 1130 |  | ~~background-repeat: no-repeat;~~ |
  | 1131 |  | ~~padding-left: 35px;~~ |
  | 1132 |  | ~~padding-top: 10px;~~ |
  | 1133 |  | ~~border-color: #ccc;~~ |
  | 1134 |  | ~~font-size: 13px;~~ |
  | 1135 |  | ~~line-height: 16px;~~ |
  | 1136 |  | ~~resize: none;~~ |
  | 1137 |  | ~~}~~ |
  | 1138 |  | ~~</style>~~ |
  | 1139 |  |  |
  | 1140 |  |  |
  | 1141 |  | ~~<div class="collapse-container" style="display: none!important;">~~ |
  | 1142 |  | ~~<h3>~~ |
  | 1143 |  | ~~Advanced settings~~ |
  | 1144 |  | ~~<span style="cursor: pointer; color: #0073aa;" class="collapse dashicons dashicons-plus"></span>~~ |
  | 1145 |  | ~~</h3>~~ |
  | 1146 |  | ~~<div class="collapsed" style="display: none">~~ |
  | 1147 |  | ~~<table class="form-table">~~ |
  | 1148 |  | ~~<tr>~~ |
  | 1149 |  | ~~<th>Priority</th>~~ |
  | 1150 |  | ~~<td>~~ |
  | 1151 |  | ~~<input type="text" name="priority" value="<?php echo $this->settings['priority'] ? esc\_attr($this->settings['priority']) : 300; ?>">~~ |
  | 1152 |  | ~~</td>~~ |
  | 1153 |  | ~~</tr>~~ |
  | 1154 |  | ~~</table>~~ |
  | 1155 |  | ~~<h4 style="display: none">Common Text</h4>~~ |
  | 1156 |  | ~~<table style="display: none" class="form-table">~~ |
  | 1157 |  | ~~<tr>~~ |
  | 1158 |  | ~~<th scope="row">~~ |
  | 1159 |  | ~~Name for user to enter~~ |
  | 1160 |  | ~~<br />~~ |
  | 1161 |  | ~~</th>~~ |
  | 1162 |  | ~~<td>~~ |
  | 1163 |  | ~~<input type="text" name="text[common][name]" value="<?php echo esc\_attr($this->settings['text']['common']['name']); ?>">~~ |
  | 1164 |  | ~~</td>~~ |
  | 1165 |  | ~~</tr>~~ |
  | 1166 |  | ~~<tr>~~ |
  | 1167 |  | ~~<th scope="row">~~ |
  | 1168 |  | ~~Email for user to enter~~ |
  | 1169 |  | ~~<br />~~ |
  | 1170 |  | ~~</th>~~ |
  | 1171 |  | ~~<td>~~ |
  | 1172 |  | ~~<input type="text" name="text[common][email]" value="<?php echo esc\_attr($this->settings['text']['common']['email']); ?>">~~ |
  | 1173 |  | ~~</td>~~ |
  | 1174 |  | ~~</tr>~~ |
  | 1175 |  | ~~<tr>~~ |
  | 1176 |  | ~~<th scope="row">~~ |
  | 1177 |  | ~~Place holder when a user is not logged in~~ |
  | 1178 |  | ~~<br />~~ |
  | 1179 |  | ~~</th>~~ |
  | 1180 |  | ~~<td>~~ |
  | 1181 |  | ~~<input type="text" name="text[common][me]" value="<?php echo esc\_attr($this->settings['text']['common']['me']); ?>">~~ |
  | 1182 |  | ~~</td>~~ |
  | 1183 |  | ~~</tr>~~ |
  | 1184 |  | ~~<tr>~~ |
  | 1185 |  | ~~<th scope="row">~~ |
  | 1186 |  | ~~Message as placeholder for user to write comment~~ |
  | 1187 |  | ~~<br />~~ |
  | 1188 |  | ~~</th>~~ |
  | 1189 |  | ~~<td>~~ |
  | 1190 |  | ~~<input type="text" name="text[common][writeComment]" value="<?php echo esc\_attr($this->settings['text']['common']['writeComment']); ?>">~~ |
  | 1191 |  | ~~</td>~~ |
  | 1192 |  | ~~</tr>~~ |
  | 1193 |  | ~~<tr>~~ |
  | 1194 |  | ~~<th scope="row">~~ |
  | 1195 |  | ~~Message to show when a user attempts to log in without entering name~~ |
  | 1196 |  | ~~<br />~~ |
  | 1197 |  | ~~</th>~~ |
  | 1198 |  | ~~<td>~~ |
  | 1199 |  | ~~<input type="text" name="text[common][blankName]" value="<?php echo esc\_attr($this->settings['text']['common']['blankName']); ?>">~~ |
  | 1200 |  | ~~</td>~~ |
  | 1201 |  | ~~</tr>~~ |
  | 1202 |  | ~~<tr>~~ |
  | 1203 |  | ~~<th scope="row">~~ |
  | 1204 |  | ~~Message to show when a user attempts to log in without entering email~~ |
  | 1205 |  | ~~<br />~~ |
  | 1206 |  | ~~</th>~~ |
  | 1207 |  | ~~<td>~~ |
  | 1208 |  | ~~<input type="text" name="text[common][blankEmail]" value="<?php echo esc\_attr($this->settings['text']['common']['blankEmail']); ?>">~~ |
  | 1209 |  | ~~</td>~~ |
  | 1210 |  | ~~</tr>~~ |
  | 1211 |  | ~~<tr>~~ |
  | 1212 |  | ~~<th scope="row">~~ |
  | 1213 |  | ~~Message to show when a user attempts to comment without entering text~~ |
  | 1214 |  | ~~<br />~~ |
  | 1215 |  | ~~</th>~~ |
  | 1216 |  | ~~<td>~~ |
  | 1217 |  | ~~<input type="text" name="text[common][blankComment]" value="<?php echo esc\_attr($this->settings['text']['common']['blankComment']); ?>">~~ |
  | 1218 |  | ~~</td>~~ |
  | 1219 |  | ~~</tr>~~ |
  | 1220 |  | ~~<tr>~~ |
  | 1221 |  | ~~<th scope="row">~~ |
  | 1222 |  | ~~Message to show when a user write invalid email~~ |
  | 1223 |  | ~~<br />~~ |
  | 1224 |  | ~~</th>~~ |
  | 1225 |  | ~~<td>~~ |
  | 1226 |  | ~~<input type="text" name="text[common][invalidEmail]" value="<?php echo esc\_attr($this->settings['text']['common']['invalidEmail']); ?>">~~ |
  | 1227 |  | ~~</td>~~ |
  | 1228 |  | ~~</tr>~~ |
  | 1229 |  | ~~<tr>~~ |
  | 1230 |  | ~~<th scope="row">~~ |
  | 1231 |  | ~~Message to show when a user write invalid name~~ |
  | 1232 |  | ~~<br />~~ |
  | 1233 |  | ~~</th>~~ |
  | 1234 |  | ~~<td>~~ |
  | 1235 |  | ~~<input type="text" name="text[common][invalidName]" value="<?php echo esc\_attr($this->settings['text']['common']['invalidName']); ?>">~~ |
  | 1236 |  | ~~</td>~~ |
  | 1237 |  | ~~</tr>~~ |
  | 1238 |  | ~~<tr>~~ |
  | 1239 |  | ~~<th scope="row">~~ |
  | 1240 |  | ~~Message to show when a user doesn't agree to terms and conditions~~ |
  | 1241 |  | ~~<br />~~ |
  | 1242 |  | ~~</th>~~ |
  | 1243 |  | ~~<td>~~ |
  | 1244 |  | ~~<input type="text" name="text[common][checkTerms]" value="<?php echo esc\_attr($this->settings['text']['common']['checkTerms']); ?>">~~ |
  | 1245 |  | ~~</td>~~ |
  | 1246 |  | ~~</tr>~~ |
  | 1247 |  |  |
  | 1248 |  | ~~</table>~~ |
  | 1249 |  | ~~<h4 style="display: none">Messages</h4>~~ |
  | 1250 |  | ~~<table style="display: none" class="form-table">~~ |
  | 1251 |  | ~~<tr>~~ |
  | 1252 |  | ~~<th scope="row">~~ |
  | 1253 |  | ~~Message to show when a user write comment longer than the configured main comment length~~ |
  | 1254 |  | ~~<br />~~ |
  | 1255 |  | ~~</th>~~ |
  | 1256 |  | ~~<td>~~ |
  | 1257 |  | ~~<input type="text" name="text[messages][charlimits]" value="<?php echo esc\_attr($this->settings['text']['messages']['charlimits']); ?>">~~ |
  | 1258 |  | ~~</td>~~ |
  | 1259 |  | ~~</tr>~~ |
  | 1260 |  | ~~<tr>~~ |
  | 1261 |  | ~~<th scope="row">~~ |
  | 1262 |  | ~~Message to show when a user tries to Up/Down votes more than once~~ |
  | 1263 |  | ~~<br />~~ |
  | 1264 |  | ~~</th>~~ |
  | 1265 |  | ~~<td>~~ |
  | 1266 |  | ~~<input type="text" name="text[messages][alreadyVoted]" value="<?php echo esc\_attr($this->settings['text']['messages']['alreadyVoted']); ?>">~~ |
  | 1267 |  | ~~</td>~~ |
  | 1268 |  | ~~</tr>~~ |
  | 1269 |  | ~~<tr>~~ |
  | 1270 |  | ~~<th scope="row">~~ |
  | 1271 |  | ~~Message to show when a user tries to flag comment more than once~~ |
  | 1272 |  | ~~<br />~~ |
  | 1273 |  | ~~</th>~~ |
  | 1274 |  | ~~<td>~~ |
  | 1275 |  | ~~<input type="text" name="text[messages][alreadyReported]" value="<?php echo esc\_attr($this->settings['text']['messages']['alreadyReported']); ?>">~~ |
  | 1276 |  | ~~</td>~~ |
  | 1277 |  | ~~</tr>~~ |
  | 1278 |  | ~~<tr>~~ |
  | 1279 |  | ~~<th scope="row">~~ |
  | 1280 |  | ~~Message to show when comments are closed~~ |
  | 1281 |  | ~~<br />~~ |
  | 1282 |  | ~~</th>~~ |
  | 1283 |  | ~~<td>~~ |
  | 1284 |  | ~~<input type="text" name="text[messages][commentsClosed]" value="<?php echo esc\_attr($this->settings['text']['messages']['commentsClosed']); ?>">~~ |
  | 1285 |  | ~~</td>~~ |
  | 1286 |  | ~~</tr>~~ |
  | 1287 |  | ~~<tr>~~ |
  | 1288 |  | ~~<th scope="row">~~ |
  | 1289 |  | ~~Message to show when a user when the moderator closes the comments~~ |
  | 1290 |  | ~~<br />~~ |
  | 1291 |  | ~~</th>~~ |
  | 1292 |  | ~~<td>~~ |
  | 1293 |  | ~~<input type="text" name="text[messages][commentsClosedModerator]" value="<?php echo esc\_attr($this->settings['text']['messages']['commentsClosedModerator']); ?>">~~ |
  | 1294 |  | ~~</td>~~ |
  | 1295 |  | ~~</tr>~~ |
  | 1296 |  | ~~<tr>~~ |
  | 1297 |  | ~~<th scope="row">~~ |
  | 1298 |  | ~~Placeholder for writing comment~~ |
  | 1299 |  | ~~<br />~~ |
  | 1300 |  | ~~</th>~~ |
  | 1301 |  | ~~<td>~~ |
  | 1302 |  | ~~<input type="text" name="text[messages][writeComment]" value="<?php echo esc\_attr($this->settings['text']['messages']['writeComment']); ?>">~~ |
  | 1303 |  | ~~</td>~~ |
  | 1304 |  | ~~</tr>~~ |
  | 1305 |  | ~~<tr>~~ |
  | 1306 |  | ~~<th scope="row">~~ |
  | 1307 |  | ~~Message to show when a user tries to send the same comment again~~ |
  | 1308 |  | ~~<br />~~ |
  | 1309 |  | ~~</th>~~ |
  | 1310 |  | ~~<td>~~ |
  | 1311 |  | ~~<input type="text" name="text[messages][alreadySubmitted]" value="<?php echo esc\_attr($this->settings['text']['messages']['alreadySubmitted']); ?>">~~ |
  | 1312 |  | ~~</td>~~ |
  | 1313 |  | ~~</tr>~~ |
  | 1314 |  | ~~<tr>~~ |
  | 1315 |  | ~~<th scope="row">~~ |
  | 1316 |  | ~~Message to show when a user tries to comment without signing in~~ |
  | 1317 |  | ~~<br />~~ |
  | 1318 |  | ~~</th>~~ |
  | 1319 |  | ~~<td>~~ |
  | 1320 |  | ~~<input type="text" name="text[messages][loginFirst]" value="<?php echo esc\_attr($this->settings['text']['messages']['loginFirst']); ?>">~~ |
  | 1321 |  | ~~</td>~~ |
  | 1322 |  | ~~</tr>~~ |
  | 1323 |  | ~~<tr>~~ |
  | 1324 |  | ~~<th scope="row">~~ |
  | 1325 |  | ~~Message to show when a user is needed to sign in~~ |
  | 1326 |  | ~~<br />~~ |
  | 1327 |  | ~~</th>~~ |
  | 1328 |  | ~~<td>~~ |
  | 1329 |  | ~~<input type="text" name="text[messages][loginTry]" value="<?php echo esc\_attr($this->settings['text']['messages']['loginTry']); ?>">~~ |
  | 1330 |  | ~~</td>~~ |
  | 1331 |  | ~~</tr>~~ |
  | 1332 |  | ~~<tr>~~ |
  | 1333 |  | ~~<th scope="row">~~ |
  | 1334 |  | ~~Message to show when a user tries to vote without signing in~~ |
  | 1335 |  | ~~<br />~~ |
  | 1336 |  | ~~</th>~~ |
  | 1337 |  | ~~<td>~~ |
  | 1338 |  | ~~<input type="text" name="text[messages][loginToVote]" value="<?php echo esc\_attr($this->settings['text']['messages']['loginToVote']); ?>">~~ |
  | 1339 |  | ~~</td>~~ |
  | 1340 |  | ~~</tr>~~ |
  | 1341 |  | ~~<tr>~~ |
  | 1342 |  | ~~<th scope="row">~~ |
  | 1343 |  | ~~Message to show when a user flags a comment~~ |
  | 1344 |  | ~~<br />~~ |
  | 1345 |  | ~~</th>~~ |
  | 1346 |  | ~~<td>~~ |
  | 1347 |  | ~~<input type="text" name="text[messages][flaggedMessage]" value="<?php echo esc\_attr($this->settings['text']['messages']['flaggedMessage']); ?>">~~ |
  | 1348 |  | ~~</td>~~ |
  | 1349 |  | ~~</tr>~~ |
  | 1350 |  | ~~<tr>~~ |
  | 1351 |  | ~~<th scope="row">~~ |
  | 1352 |  | ~~Message to show when a user tries to flag without signing in~~ |
  | 1353 |  | ~~<br />~~ |
  | 1354 |  | ~~</th>~~ |
  | 1355 |  | ~~<td>~~ |
  | 1356 |  | ~~<input type="text" name="text[messages][loginToFlag]" value="<?php echo esc\_attr($this->settings['text']['messages']['loginToFlag']); ?>">~~ |
  | 1357 |  | ~~</td>~~ |
  | 1358 |  | ~~</tr>~~ |
  | 1359 |  | ~~<tr>~~ |
  | 1360 |  | ~~<th scope="row">~~ |
  | 1361 |  | ~~Message to show when an error happens in submitting comment~~ |
  | 1362 |  | ~~<br />~~ |
  | 1363 |  | ~~</th>~~ |
  | 1364 |  | ~~<td>~~ |
  | 1365 |  | ~~<input type="text" name="text[messages][errorSubmitting]" value="<?php echo esc\_attr($this->settings['text']['messages']['errorSubmitting']); ?>">~~ |
  | 1366 |  | ~~</td>~~ |
  | 1367 |  | ~~</tr>~~ |
  | 1368 |  | ~~<tr>~~ |
  | 1369 |  | ~~<th scope="row">~~ |
  | 1370 |  | ~~Message to show when a user tries to login with invalid data~~ |
  | 1371 |  | ~~<br />~~ |
  | 1372 |  | ~~</th>~~ |
  | 1373 |  | ~~<td>~~ |
  | 1374 |  | ~~<input type="text" name="text[messages][invalidLogin]" value="<?php echo esc\_attr($this->settings['text']['messages']['invalidLogin']); ?>">~~ |
  | 1375 |  | ~~</td>~~ |
  | 1376 |  | ~~</tr>~~ |
  | 1377 |  | ~~<tr>~~ |
  | 1378 |  | ~~<th scope="row">~~ |
  | 1379 |  | ~~General error, contact us~~ |
  | 1380 |  | ~~<br />~~ |
  | 1381 |  | ~~</th>~~ |
  | 1382 |  | ~~<td>~~ |
  | 1383 |  | ~~<input type="text" name="text[messages][errorContactVuukle]" value="<?php echo esc\_attr($this->settings['text']['messages']['errorContactVuukle']); ?>">~~ |
  | 1384 |  | ~~</td>~~ |
  | 1385 |  | ~~</tr>~~ |
  | 1386 |  | ~~<tr>~~ |
  | 1387 |  | ~~<th scope="row">~~ |
  | 1388 |  | ~~Message to show when a user is flagged as spammer, and blocked from commenting~~ |
  | 1389 |  | ~~<br />~~ |
  | 1390 |  | ~~</th>~~ |
  | 1391 |  | ~~<td>~~ |
  | 1392 |  | ~~<input type="text" name="text[messages][spammerComment]" value="<?php echo esc\_attr($this->settings['text']['messages']['spammerComment']); ?>">~~ |
  | 1393 |  | ~~</td>~~ |
  | 1394 |  | ~~</tr>~~ |
  | 1395 |  | ~~<tr>~~ |
  | 1396 |  | ~~<th scope="row">~~ |
  | 1397 |  | ~~Message to show when a user tries to comment with any words, like aaaaa etc...~~ |
  | 1398 |  | ~~<br />~~ |
  | 1399 |  | ~~</th>~~ |
  | 1400 |  | ~~<td>~~ |
  | 1401 |  | ~~<input type="text" name="text[messages][nonSenseComment]" value="<?php echo esc\_attr($this->settings['text']['messages']['nonSenseComment']); ?>">~~ |
  | 1402 |  | ~~</td>~~ |
  | 1403 |  | ~~</tr>~~ |
  | 1404 |  | ~~<tr>~~ |
  | 1405 |  | ~~<th scope="row">~~ |
  | 1406 |  | ~~Message to show when a user comments and the moderation is on~~ |
  | 1407 |  | ~~<br />~~ |
  | 1408 |  | ~~</th>~~ |
  | 1409 |  | ~~<td>~~ |
  | 1410 |  | ~~<input type="text" name="text[messages][moderationMessage]" value="<?php echo esc\_attr($this->settings['text']['messages']['moderationMessage']); ?>">~~ |
  | 1411 |  | ~~</td>~~ |
  | 1412 |  | ~~</tr>~~ |
  | 1413 |  | ~~</table>~~ |
  | 1414 |  | ~~<h4 style="display:none">These config deal with showing date in the comments, ie: 5 minutes ago, 2 days ago, etc...</h4>~~ |
  | 1415 |  | ~~<table style="display:none" class="form-table">~~ |
  | 1416 |  | ~~<tr>~~ |
  | 1417 |  | ~~<th scope="row">~~ |
  | 1418 |  | ~~Suffix ago~~ |
  | 1419 |  | ~~<br />~~ |
  | 1420 |  | ~~</th>~~ |
  | 1421 |  | ~~<td>~~ |
  | 1422 |  | ~~<input type="text" name="text[timeAgo][suffixAgo]" value="<?php echo esc\_attr($this->settings['text']['timeAgo']['suffixAgo']); ?>">~~ |
  | 1423 |  | ~~</td>~~ |
  | 1424 |  | ~~</tr>~~ |
  | 1425 |  | ~~<tr>~~ |
  | 1426 |  | ~~<th scope="row">~~ |
  | 1427 |  | ~~Suffix From Now~~ |
  | 1428 |  | ~~<br />~~ |
  | 1429 |  | ~~</th>~~ |
  | 1430 |  | ~~<td>~~ |
  | 1431 |  | ~~<input type="text" name="text[timeAgo][suffixFromNow]" value="<?php echo esc\_attr($this->settings['text']['timeAgo']['suffixFromNow']); ?>">~~ |
  | 1432 |  | ~~</td>~~ |
  | 1433 |  | ~~</tr>~~ |
  | 1434 |  | ~~<tr>~~ |
  | 1435 |  | ~~<th scope="row">~~ |
  | 1436 |  | ~~Seconds~~ |
  | 1437 |  | ~~<br />~~ |
  | 1438 |  | ~~</th>~~ |
  | 1439 |  | ~~<td>~~ |
  | 1440 |  | ~~<input type="text" name="text[timeAgo][seconds]" value="<?php echo esc\_attr($this->settings['text']['timeAgo']['seconds']); ?>">~~ |
  | 1441 |  | ~~</td>~~ |
  | 1442 |  | ~~</tr>~~ |
  | 1443 |  | ~~<tr>~~ |
  | 1444 |  | ~~<th scope="row">~~ |
  | 1445 |  | ~~Minute~~ |
  | 1446 |  | ~~<br />~~ |
  | 1447 |  | ~~</th>~~ |
  | 1448 |  | ~~<td>~~ |
  | 1449 |  | ~~<input type="text" name="text[timeAgo][minute]" value="<?php echo esc\_attr($this->settings['text']['timeAgo']['minute']); ?>">~~ |
  | 1450 |  | ~~</td>~~ |
  | 1451 |  | ~~</tr>~~ |
  | 1452 |  | ~~<tr>~~ |
  | 1453 |  | ~~<th scope="row">~~ |
  | 1454 |  | ~~Minutes~~ |
  | 1455 |  | ~~<br />~~ |
  | 1456 |  | ~~</th>~~ |
  | 1457 |  | ~~<td>~~ |
  | 1458 |  | ~~<input type="text" name="text[timeAgo][minutes]" value="<?php echo esc\_attr($this->settings['text']['timeAgo']['minutes']); ?>">~~ |
  | 1459 |  | ~~</td>~~ |
  | 1460 |  | ~~</tr>~~ |
  | 1461 |  | ~~<tr>~~ |
  | 1462 |  | ~~<th scope="row">~~ |
  | 1463 |  | ~~Hour~~ |
  | 1464 |  | ~~<br />~~ |
  | 1465 |  | ~~</th>~~ |
  | 1466 |  | ~~<td>~~ |
  | 1467 |  | ~~<input type="text" name="text[timeAgo][hour]" value="<?php echo esc\_attr($this->settings['text']['timeAgo']['hour']); ?>">~~ |
  | 1468 |  | ~~</td>~~ |
  | 1469 |  | ~~</tr>~~ |
  | 1470 |  | ~~<tr>~~ |
  | 1471 |  | ~~<th scope="row">~~ |
  | 1472 |  | ~~Hours~~ |
  | 1473 |  | ~~<br />~~ |
  | 1474 |  | ~~</th>~~ |
  | 1475 |  | ~~<td>~~ |
  | 1476 |  | ~~<input type="text" name="text[timeAgo][hours]" value="<?php echo esc\_attr($this->settings['text']['timeAgo']['hours']); ?>">~~ |
  | 1477 |  | ~~</td>~~ |
  | 1478 |  | ~~</tr>~~ |
  | 1479 |  | ~~<tr>~~ |
  | 1480 |  | ~~<th scope="row">~~ |
  | 1481 |  | ~~Day~~ |
  | 1482 |  | ~~<br />~~ |
  | 1483 |  | ~~</th>~~ |
  | 1484 |  | ~~<td>~~ |
  | 1485 |  | ~~<input type="text" name="text[timeAgo][day]" value="<?php echo esc\_attr($this->settings['text']['timeAgo']['day']); ?>">~~ |
  | 1486 |  | ~~</td>~~ |
  | 1487 |  | ~~</tr>~~ |
  | 1488 |  | ~~<tr>~~ |
  | 1489 |  | ~~<th scope="row">~~ |
  | 1490 |  | ~~Days~~ |
  | 1491 |  | ~~<br />~~ |
  | 1492 |  | ~~</th>~~ |
  | 1493 |  | ~~<td>~~ |
  | 1494 |  | ~~<input type="text" name="text[timeAgo][days]" value="<?php echo esc\_attr($this->settings['text']['timeAgo']['days']); ?>">~~ |
  | 1495 |  | ~~</td>~~ |
  | 1496 |  | ~~</tr>~~ |
  | 1497 |  | ~~<tr>~~ |
  | 1498 |  | ~~<th scope="row">~~ |
  | 1499 |  | ~~Month~~ |
  | 1500 |  | ~~<br />~~ |
  | 1501 |  | ~~</th>~~ |
  | 1502 |  | ~~<td>~~ |
  | 1503 |  | ~~<input type="text" name="text[timeAgo][month]" value="<?php echo esc\_attr($this->settings['text']['timeAgo']['month']); ?>">~~ |
  | 1504 |  | ~~</td>~~ |
  | 1505 |  | ~~</tr>~~ |
  | 1506 |  | ~~<tr>~~ |
  | 1507 |  | ~~<th scope="row">~~ |
  | 1508 |  | ~~Months~~ |
  | 1509 |  | ~~<br />~~ |
  | 1510 |  | ~~</th>~~ |
  | 1511 |  | ~~<td>~~ |
  | 1512 |  | ~~<input type="text" name="text[timeAgo][months]" value="<?php echo esc\_attr($this->settings['text']['timeAgo']['months']); ?>">~~ |
  | 1513 |  | ~~</td>~~ |
  | 1514 |  | ~~</tr>~~ |
  | 1515 |  | ~~<tr>~~ |
  | 1516 |  | ~~<th scope="row">~~ |
  | 1517 |  | ~~Year~~ |
  | 1518 |  | ~~<br />~~ |
  | 1519 |  | ~~</th>~~ |
  | 1520 |  | ~~<td>~~ |
  | 1521 |  | ~~<input type="text" name="text[timeAgo][year]" value="<?php echo esc\_attr($this->settings['text']['timeAgo']['year']); ?>">~~ |
  | 1522 |  | ~~</td>~~ |
  | 1523 |  | ~~</tr>~~ |
  | 1524 |  | ~~<tr>~~ |
  | 1525 |  | ~~<th scope="row">~~ |
  | 1526 |  | ~~Years~~ |
  | 1527 |  | ~~<br />~~ |
  | 1528 |  | ~~</th>~~ |
  | 1529 |  | ~~<td>~~ |
  | 1530 |  | ~~<input type="text" name="text[timeAgo][years]" value="<?php echo esc\_attr($this->settings['text']['timeAgo']['years']); ?>">~~ |
  | 1531 |  | ~~</td>~~ |
  | 1532 |  | ~~</tr>~~ |
  | 1533 |  | ~~</table>~~ |
  | 1534 |  | ~~<h4 style="display:none">Tooltips for sharing icons</h4>~~ |
  | 1535 |  | ~~<table style="display:none" class="form-table">~~ |
  | 1536 |  | ~~<tr>~~ |
  | 1537 |  | ~~<th scope="row">~~ |
  | 1538 |  | ~~Google~~ |
  | 1539 |  | ~~<br />~~ |
  | 1540 |  | ~~</th>~~ |
  | 1541 |  | ~~<td>~~ |
  | 1542 |  | ~~<input type="text" name="text[shareIcons][google]" value="<?php echo esc\_attr($this->settings['text']['shareIcons']['google']); ?>">~~ |
  | 1543 |  | ~~</td>~~ |
  | 1544 |  | ~~</tr>~~ |
  | 1545 |  | ~~<tr>~~ |
  | 1546 |  | ~~<th scope="row">~~ |
  | 1547 |  | ~~Facebook~~ |
  | 1548 |  | ~~<br />~~ |
  | 1549 |  | ~~</th>~~ |
  | 1550 |  | ~~<td>~~ |
  | 1551 |  | ~~<input type="text" name="text[shareIcons][facebook]" value="<?php echo esc\_attr($this->settings['text']['shareIcons']['facebook']); ?>">~~ |
  | 1552 |  | ~~</td>~~ |
  | 1553 |  | ~~</tr>~~ |
  | 1554 |  | ~~<tr>~~ |
  | 1555 |  | ~~<th scope="row">~~ |
  | 1556 |  | ~~Twitter~~ |
  | 1557 |  | ~~<br />~~ |
  | 1558 |  | ~~</th>~~ |
  | 1559 |  | ~~<td>~~ |
  | 1560 |  | ~~<input type="text" name="text[shareIcons][twitter]" value="<?php echo esc\_attr($this->settings['text']['shareIcons']['twitter']); ?>">~~ |
  | 1561 |  | ~~</td>~~ |
  | 1562 |  | ~~</tr>~~ |
  | 1563 |  | ~~<tr>~~ |
  | 1564 |  | ~~<th scope="row">~~ |
  | 1565 |  | ~~Linkedin~~ |
  | 1566 |  | ~~<br />~~ |
  | 1567 |  | ~~</th>~~ |
  | 1568 |  | ~~<td>~~ |
  | 1569 |  | ~~<input type="text" name="text[shareIcons][linkedin]" value="<?php echo esc\_attr($this->settings['text']['shareIcons']['linkedin']); ?>">~~ |
  | 1570 |  | ~~</td>~~ |
  | 1571 |  | ~~</tr>~~ |
  | 1572 |  | ~~</table>~~ |
  | 1573 |  | ~~<h4 style="display:none">Tooltips for social logins</h4>~~ |
  | 1574 |  | ~~<table style="display:none" class="form-table">~~ |
  | 1575 |  | ~~<tr>~~ |
  | 1576 |  | ~~<th scope="row">~~ |
  | 1577 |  | ~~Google~~ |
  | 1578 |  | ~~<br />~~ |
  | 1579 |  | ~~</th>~~ |
  | 1580 |  | ~~<td>~~ |
  | 1581 |  | ~~<input type="text" name="text[login][google]" value="<?php echo esc\_attr($this->settings['text']['login']['google']); ?>">~~ |
  | 1582 |  | ~~</td>~~ |
  | 1583 |  | ~~</tr>~~ |
  | 1584 |  | ~~<tr>~~ |
  | 1585 |  | ~~<th scope="row">~~ |
  | 1586 |  | ~~Facebook~~ |
  | 1587 |  | ~~<br />~~ |
  | 1588 |  | ~~</th>~~ |
  | 1589 |  | ~~<td>~~ |
  | 1590 |  | ~~<input type="text" name="text[login][facebook]" value="<?php echo esc\_attr($this->settings['text']['login']['facebook']); ?>">~~ |
  | 1591 |  | ~~</td>~~ |
  | 1592 |  | ~~</tr>~~ |
  | 1593 |  | ~~<tr>~~ |
  | 1594 |  | ~~<th scope="row">~~ |
  | 1595 |  | ~~Twitter~~ |
  | 1596 |  | ~~<br />~~ |
  | 1597 |  | ~~</th>~~ |
  | 1598 |  | ~~<td>~~ |
  | 1599 |  | ~~<input type="text" name="text[login][twitter]" value="<?php echo esc\_attr($this->settings['text']['login']['twitter']); ?>">~~ |
  | 1600 |  | ~~</td>~~ |
  | 1601 |  | ~~</tr>~~ |
  | 1602 |  | ~~<tr>~~ |
  | 1603 |  | ~~<th scope="row">~~ |
  | 1604 |  | ~~Linkedin~~ |
  | 1605 |  | ~~<br />~~ |
  | 1606 |  | ~~</th>~~ |
  | 1607 |  | ~~<td>~~ |
  | 1608 |  | ~~<input type="text" name="text[login][linkedin]" value="<?php echo esc\_attr($this->settings['text']['login']['linkedin']); ?>">~~ |
  | 1609 |  | ~~</td>~~ |
  | 1610 |  | ~~</tr>~~ |
  | 1611 |  | ~~</table>~~ |
  | 1612 |  | ~~<h4 style="display:none">Comment Text</h4>~~ |
  | 1613 |  | ~~<table style="display:none" class="form-table">~~ |
  | 1614 |  | ~~<tr>~~ |
  | 1615 |  | ~~<th scope="row">~~ |
  | 1616 |  | ~~Text at header of comment section when there is no comments~~ |
  | 1617 |  | ~~<br />~~ |
  | 1618 |  | ~~</th>~~ |
  | 1619 |  | ~~<td>~~ |
  | 1620 |  | ~~<input type="text" name="text[commentText][when0]" value="<?php echo esc\_attr($this->settings['text']['commentText']['when0']); ?>">~~ |
  | 1621 |  | ~~</td>~~ |
  | 1622 |  | ~~</tr>~~ |
  | 1623 |  | ~~<tr>~~ |
  | 1624 |  | ~~<th scope="row">~~ |
  | 1625 |  | ~~Text at header of comment section when there is 1 comment~~ |
  | 1626 |  | ~~<br />~~ |
  | 1627 |  | ~~</th>~~ |
  | 1628 |  | ~~<td>~~ |
  | 1629 |  | ~~<input type="text" name="text[commentText][when1]" value="<?php echo esc\_attr($this->settings['text']['commentText']['when1']); ?>">~~ |
  | 1630 |  | ~~</td>~~ |
  | 1631 |  | ~~</tr>~~ |
  | 1632 |  | ~~<tr>~~ |
  | 1633 |  | ~~<th scope="row">~~ |
  | 1634 |  | ~~Text at header of comment section when there is more than comment~~ |
  | 1635 |  | ~~<br />~~ |
  | 1636 |  | ~~</th>~~ |
  | 1637 |  | ~~<td>~~ |
  | 1638 |  | ~~<input type="text" name="text[commentText][whenX]" value="<?php echo esc\_attr($this->settings['text']['commentText']['whenX']); ?>">~~ |
  | 1639 |  | ~~</td>~~ |
  | 1640 |  | ~~</tr>~~ |
  | 1641 |  | ~~</table>~~ |
  | 1642 |  | ~~<h4 style="display:none">Rating section strings to show to user, includes (Average rating 4.5 start from 123 users, etc...)</h4>~~ |
  | 1643 |  | ~~<table style="display:none" class="form-table">~~ |
  | 1644 |  | ~~<tr>~~ |
  | 1645 |  | ~~<th scope="row">~~ |
  | 1646 |  | ~~Header~~ |
  | 1647 |  | ~~<br />~~ |
  | 1648 |  | ~~</th>~~ |
  | 1649 |  | ~~<td>~~ |
  | 1650 |  | ~~<input type="text" name="text[rating][header]" value="<?php echo esc\_attr($this->settings['text']['rating']['header']); ?>">~~ |
  | 1651 |  | ~~</td>~~ |
  | 1652 |  | ~~</tr>~~ |
  | 1653 |  | ~~<tr>~~ |
  | 1654 |  | ~~<th scope="row">~~ |
  | 1655 |  | ~~Average~~ |
  | 1656 |  | ~~<br />~~ |
  | 1657 |  | ~~</th>~~ |
  | 1658 |  | ~~<td>~~ |
  | 1659 |  | ~~<input type="text" name="text[rating][average]" value="<?php echo esc\_attr($this->settings['text']['rating']['average']); ?>">~~ |
  | 1660 |  | ~~</td>~~ |
  | 1661 |  | ~~</tr>~~ |
  | 1662 |  | ~~<tr>~~ |
  | 1663 |  | ~~<th scope="row">~~ |
  | 1664 |  | ~~Start From~~ |
  | 1665 |  | ~~<br />~~ |
  | 1666 |  | ~~</th>~~ |
  | 1667 |  | ~~<td>~~ |
  | 1668 |  | ~~<input type="text" name="text[rating][starsFrom]" value="<?php echo esc\_attr($this->settings['text']['rating']['starsFrom']); ?>">~~ |
  | 1669 |  | ~~</td>~~ |
  | 1670 |  | ~~</tr>~~ |
  | 1671 |  | ~~<tr>~~ |
  | 1672 |  | ~~<th scope="row">~~ |
  | 1673 |  | ~~Ratings~~ |
  | 1674 |  | ~~<br />~~ |
  | 1675 |  | ~~</th>~~ |
  | 1676 |  | ~~<td>~~ |
  | 1677 |  | ~~<input type="text" name="text[rating][ratings]" value="<?php echo esc\_attr($this->settings['text']['rating']['ratings']); ?>">~~ |
  | 1678 |  | ~~</td>~~ |
  | 1679 |  | ~~</tr>~~ |
  | 1680 |  | ~~<tr>~~ |
  | 1681 |  | ~~<th scope="row">~~ |
  | 1682 |  | ~~Your Rating~~ |
  | 1683 |  | ~~<br />~~ |
  | 1684 |  | ~~</th>~~ |
  | 1685 |  | ~~<td>~~ |
  | 1686 |  | ~~<input type="text" name="text[rating][yourRating]" value="<?php echo esc\_attr($this->settings['text']['rating']['yourRating']); ?>">~~ |
  | 1687 |  | ~~</td>~~ |
  | 1688 |  | ~~</tr>~~ |
  | 1689 |  | ~~<tr>~~ |
  | 1690 |  | ~~<th scope="row">~~ |
  | 1691 |  | ~~Stars~~ |
  | 1692 |  | ~~<br />~~ |
  | 1693 |  | ~~</th>~~ |
  | 1694 |  | ~~<td>~~ |
  | 1695 |  | ~~<input type="text" name="text[rating][stars]" value="<?php echo esc\_attr($this->settings['text']['rating']['stars']); ?>">~~ |
  | 1696 |  | ~~</td>~~ |
  | 1697 |  | ~~</tr>~~ |
  | 1698 |  | ~~</table>~~ |
  | 1699 |  | ~~<h4 style="display:none">Texts for the buttons we have</h4>~~ |
  | 1700 |  | ~~<table style="display:none" class="form-table">~~ |
  | 1701 |  | ~~<tr>~~ |
  | 1702 |  | ~~<th scope="row">~~ |
  | 1703 |  | ~~Load More~~ |
  | 1704 |  | ~~<br />~~ |
  | 1705 |  | ~~</th>~~ |
  | 1706 |  | ~~<td>~~ |
  | 1707 |  | ~~<input type="text" name="text[buttons][loadMore]" value="<?php echo esc\_attr($this->settings['text']['buttons']['loadMore']); ?>">~~ |
  | 1708 |  | ~~</td>~~ |
  | 1709 |  | ~~</tr>~~ |
  | 1710 |  | ~~<tr>~~ |
  | 1711 |  | ~~<th scope="row">~~ |
  | 1712 |  | ~~Sign in~~ |
  | 1713 |  | ~~<br />~~ |
  | 1714 |  | ~~</th>~~ |
  | 1715 |  | ~~<td>~~ |
  | 1716 |  | ~~<input type="text" name="text[buttons][singin]" value="<?php echo esc\_attr($this->settings['text']['buttons']['singin']); ?>">~~ |
  | 1717 |  | ~~</td>~~ |
  | 1718 |  | ~~</tr>~~ |
  | 1719 |  | ~~<tr>~~ |
  | 1720 |  | ~~<th scope="row">~~ |
  | 1721 |  | ~~Post~~ |
  | 1722 |  | ~~<br />~~ |
  | 1723 |  | ~~</th>~~ |
  | 1724 |  | ~~<td>~~ |
  | 1725 |  | ~~<input type="text" name="text[buttons][post]" value="<?php echo esc\_attr($this->settings['text']['buttons']['post']); ?>">~~ |
  | 1726 |  | ~~</td>~~ |
  | 1727 |  | ~~</tr>~~ |
  | 1728 |  | ~~</table>~~ |
  | 1729 |  | ~~</div>~~ |
  | 1730 |  | ~~</div>~~ |
  | 1731 | 474 | <script type="text/javascript"> |
  | 1732 |  | document.addEventListener("DOMContentLoaded", function() { |
  | 1733 |  | document.addEventListener("DOMContentLoaded", function() { |
  |  | 475 | document.addEventListener("DOMContentLoaded", function () { |
  |  | 476 | document.addEventListener("DOMContentLoaded", function () { |
  | 1734 | 477 | document.querySelector('#color-picker').iris({ |
  | 1735 | 478 | width: 400, |
  | 1736 | 479 | hide: true, |
  | 1737 |  | change: function(event, ui) { |
  |  | 480 | change: function (event, ui) { |
  | 1738 | 481 | // event = standard jQuery event, produced by whichever control was changed. |
  | 1739 | 482 | // ui = standard jQuery UI object, with a color member containing a Color.js object |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/partials/free-comments-for-wordpress-vuukle-admin-display.php?rev=2533938#L1747) | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/partials/free-comments-for-wordpress-vuukle-admin-display.php?rev=2553337#L490) |  |
  | 1747 | 490 | }); |
  | 1748 | 491 |  |
  | 1749 |  | event.currentTarget.addEventListener("click", function(event) { |
  |  | 492 | event.currentTarget.addEventListener("click", function (event) { |
  | 1750 | 493 | if (!document.querySelector(e.target).matchesSelector("#color-picker")) { |
  | 1751 | 494 | document.querySelector('#color-picker').iris('hide'); |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/partials/free-comments-for-wordpress-vuukle-admin-display.php?rev=2533938#L1757) | […](/browser/free-comments-for-wordpress-vuukle/trunk/admin/partials/free-comments-for-wordpress-vuukle-admin-display.php?rev=2553337#L500) |  |
  | 1757 | 500 | }); |
  | 1758 | 501 | </script> |
  | 1759 |  | <input name="nonce" type="hidden" value="<?php echo esc\_attr(wp\_create\_nonce($this->settings\_name)); ?>" /> |
  | 1760 |  | <input name="action" type="hidden" value="VuukleSaveSettings" /> |
  | 1761 |  |  |
  | 1762 |  |  |
  |  | 502 | <input name="nonce" type="hidden" value="<?php echo esc\_attr( wp\_create\_nonce( $this->settings\_name ) ); ?>"/> |
  |  | 503 | <input name="action" id="action" type="hidden" value=""/> |
  | 1763 | 504 | <div class="submit" id="vis"> |
  | 1764 |  | <input id="save-settings" name="" type="submit" value="Save Settings" class="button-primary" /> |
  | 1765 |  | <input name="reset" type="submit" value="Reset to Default" class="button-primary" /> |
  | 1766 |  | </div> |
  | 1767 |  | </form> |
  | 1768 |  |  |
  | 1769 |  | <form method="post" action="" id="vuukle-settings-form1"> |
  | 1770 |  | <style> |
  | 1771 |  | #vis { |
  | 1772 |  | display: block; |
  | 1773 |  | } |
  | 1774 |  | </style> |
  | 1775 |  | <div id="tab10" class="vuukle-tab-content <?php echo ($vuukle\_tab == 'tab10') ? 'vuukle-tab-content-active' : ''; ?>"> |
  | 1776 |  | <table class="form-table settings-table"> |
  | 1777 |  | <tr> |
  | 1778 |  | <th scope="row"> |
  | 1779 |  | <h2 class="title-setting">Change ads.txt settings</h2><br /> |
  | 1780 |  | <span> Ads.txt file<a class="vuukle\_help" data-toggle="tooltip" title="<?php \_e("Here you can add or change your ads.txt file.", esc\_html($this->plugin\_name)); ?>"> |
  | 1781 |  | <i class="fas fa-info-circle"></i> |
  | 1782 |  | </a> |
  | 1783 |  | </span> |
  | 1784 |  | </th> |
  | 1785 |  | </tr> |
  | 1786 |  | </table> |
  | 1787 |  | <tr> |
  | 1788 |  | <th scope="row"> |
  | 1789 |  | Ads.txt enable button<a class="vuukle\_help" data-toggle="tooltip" title="<?php \_e("Enable the button to make changes in ads.txt file", esc\_html($this->plugin\_name)); ?>"> |
  | 1790 |  | <i class="fas fa-info-circle"></i> |
  | 1791 |  | </a> |
  | 1792 |  | </th> |
  | 1793 |  | <td> |
  | 1794 |  | Off |
  | 1795 |  | <input type="radio" name="save\_ads\_txt" value="false" <?php checked($this->settings['save\_ads\_txt'], 'false'); ?> /> |
  | 1796 |  | On |
  | 1797 |  | <input type="radio" name="save\_ads\_txt" value="true" <?php checked($this->settings['save\_ads\_txt'], 'true'); ?> /> |
  | 1798 |  | </td> |
  | 1799 |  | </tr> |
  | 1800 |  | <?php if ($this->settings['save\_ads\_txt'] == 'true') : ?> |
  | 1801 |  | <textarea class="lined-textarea" name="ads-txt-console" style="width: 100%; height: 700px; font-size: 12px;"><?php |
  | 1802 |  | $wp\_content\_dir\_array = explode('/', WP\_CONTENT\_DIR); |
  | 1803 |  | $wp\_content\_dir = $wp\_content\_dir\_array[count($wp\_content\_dir\_array) - 1]; |
  | 1804 |  | $root\_path = str\_replace($wp\_content\_dir, '', WP\_CONTENT\_DIR); |
  | 1805 |  | $ads\_txt\_file = $root\_path . 'ads.txt'; |
  | 1806 |  | echo file\_get\_contents($ads\_txt\_file); |
  | 1807 |  | ?> |
  | 1808 |  | </textarea> |
  | 1809 |  | <?php endif; ?> |
  | 1810 |  | <br /> |
  | 1811 |  | <br /> |
  | 1812 |  | <div class="submit"> |
  | 1813 |  | <input name="action" type="hidden" value="VuukleSaveSettings1" /> |
  | 1814 |  | <input id="save\_settings\_ads" name="" type="submit" class="button-primary" value="Save settings Ads" /> |
  | 1815 |  |  |
  | 1816 |  | </div> |
  | 1817 |  | </div> |
  | 1818 |  |  |
  | 1819 |  |  |
  | 1820 |  |  |
  |  | 505 | <input id="save-settings" name="" type="submit" value="Save Settings" class="button-primary"/> |
  |  | 506 | <input name="reset" type="submit" value="Reset to Default" class="button-primary"/> |
  |  | 507 | </div> |
  | 1821 | 508 | </form> |
  | 1822 | 509 | <script src='<?php echo VUUKLE\_ADMIN\_URL; ?>/js/export.js'></script> |
* ## [free-comments-for-wordpress-vuukle/trunk/free-comments-for-wordpress-vuukle.php](/changeset/2553337/free-comments-for-wordpress-vuukle/trunk/free-comments-for-wordpress-vuukle.php "Show the changeset 2553337 restricted to free-comments-for-wordpress-vuukle/trunk/free-comments-for-wordpress-vuukle.php")

  | [r2533938](/browser/free-comments-for-wordpress-vuukle/trunk/free-comments-for-wordpress-vuukle.php?rev=2533938#L21 "Show revision 2533938 of this file in browser") | [r2553337](/browser/free-comments-for-wordpress-vuukle/trunk/free-comments-for-wordpress-vuukle.php?rev=2553337#L21 "Show revision 2553337 of this file in browser") |  |
  | --- | --- | --- |
  | 21 | 21 | \* Description:       Vuukle is the smartest commenting platform that offers AI-powered commenting, Unique Sharing tool bar, Emoji reaction widget and real time analytics with just one click. Customize all you want, make your pages load faster and experience user engagement like never before! |
  | 22 | 22 |  |
  | 23 |  | \* Version:           ~~3.4.31~~ |
  |  | 23 | \* Version:           4.0 |
  | 24 | 24 |  |
  | 25 | 25 | \* Author:            Vuukle |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/free-comments-for-wordpress-vuukle.php?rev=2533938#L41) | […](/browser/free-comments-for-wordpress-vuukle/trunk/free-comments-for-wordpress-vuukle.php?rev=2553337#L41) |  |
  | 41 | 41 | \* Rename this for your plugin and update it as you release new versions. |
  | 42 | 42 | \*/ |
  | 43 |  | define('FREE\_COMMENTS\_FOR\_WORDPRESS\_VUUKLE\_VERSION', '~~3.4.31~~'); |
  |  | 43 | define('FREE\_COMMENTS\_FOR\_WORDPRESS\_VUUKLE\_VERSION', '4.0'); |
  | 44 | 44 |  |
  | 45 | 45 |  |
* ## [free-comments-for-wordpress-vuukle/trunk/includes/class-free-comments-for-wordpress-vuukle.php](/changeset/2553337/free-comments-for-wordpress-vuukle/trunk/includes/class-free-comments-for-wordpress-vuukle.php "Show the changeset 2553337 restricted to free-comments-for-wordpress-vuukle/trunk/includes/class-free-comments-for-wordpress-vuukle.php")

  | [r2506540](/browser/free-comments-for-wordpress-vuukle/trunk/includes/class-free-comments-for-wordpress-vuukle.php?rev=2506540#L1 "Show revision 2506540 of this file in browser") | [r2553337](/browser/free-comments-for-wordpress-vuukle/trunk/includes/class-free-comments-for-wordpress-vuukle.php?rev=2553337#L1 "Show revision 2553337 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php |
  | 2 |  |  |
  | 3 | 2 | /\*\* |
  | 4 | 3 | \* The file that defines the core plugin class |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/includes/class-free-comments-for-wordpress-vuukle.php?rev=2506540#L33) | […](/browser/free-comments-for-wordpress-vuukle/trunk/includes/class-free-comments-for-wordpress-vuukle.php?rev=2553337#L32) |  |
  | 33 | 32 | \* @since      1.0.0 |
  | 34 | 33 | \*/ |
  | 35 |  | class Free\_Comments\_For\_Wordpress\_Vuukle |
  | 36 |  | { |
  | 37 |  |  |
  | 38 |  | /\*\* |
  | 39 |  | \* The loader that's responsible for maintaining and registering all hooks that power |
  | 40 |  | \* the plugin. |
  | 41 |  | \* |
  | 42 |  | \* @since  1.0.0 |
  | 43 |  | \* @access protected |
  | 44 |  | \* @var    Free\_Comments\_For\_Wordpress\_Vuukle\_Loader    $loader    Maintains and registers all hooks for the plugin. |
  | 45 |  | \*/ |
  | 46 |  | protected $loader; |
  | 47 |  |  |
  | 48 |  | /\*\* |
  | 49 |  | \* The unique identifier of this plugin. |
  | 50 |  | \* |
  | 51 |  | \* @since  1.0.0 |
  | 52 |  | \* @access protected |
  | 53 |  | \* @var    string    $plugin\_name    The string used to uniquely identify this plugin. |
  | 54 |  | \*/ |
  | 55 |  | protected $plugin\_name; |
  | 56 |  |  |
  | 57 |  | /\*\* |
  | 58 |  | \* The current version of the plugin. |
  | 59 |  | \* |
  | 60 |  | \* @since  1.0.0 |
  | 61 |  | \* @access protected |
  | 62 |  | \* @var    string    $version    The current version of the plugin. |
  | 63 |  | \*/ |
  | 64 |  | protected $version; |
  | 65 |  |  |
  | 66 |  | /\*\* |
  | 67 |  | \* Define the core functionality of the plugin. |
  | 68 |  | \* |
  | 69 |  | \* Set the plugin name and the plugin version that can be used throughout the plugin. |
  | 70 |  | \* Load the dependencies, define the locale, and set the hooks for the admin area and |
  | 71 |  | \* the public-facing side of the site. |
  | 72 |  | \* |
  | 73 |  | \* @since 1.0.0 |
  | 74 |  | \*/ |
  | 75 |  | public function \_\_construct() |
  | 76 |  | { |
  | 77 |  | if (defined('FREE\_COMMENTS\_FOR\_WORDPRESS\_VUUKLE\_VERSION')) { |
  | 78 |  | $this->version = FREE\_COMMENTS\_FOR\_WORDPRESS\_VUUKLE\_VERSION; |
  | 79 |  | } else { |
  | 80 |  | $this->version = '1.0.0'; |
  | 81 |  | } |
  | 82 |  | $this->plugin\_name = 'free-comments-for-wordpress-vuukle'; |
  | 83 |  |  |
  | 84 |  | $this->\_loadDependencies(); |
  | 85 |  | $this->\_setLocale(); |
  | 86 |  | $this->\_defineAdminHooks(); |
  | 87 |  | $this->\_definePublicHooks(); |
  | 88 |  | } |
  | 89 |  |  |
  | 90 |  | /\*\* |
  | 91 |  | \* Load the required dependencies for this plugin. |
  | 92 |  | \* |
  | 93 |  | \* Include the following files that make up the plugin: |
  | 94 |  | \* |
  | 95 |  | \* - Free\_Comments\_For\_Wordpress\_Vuukle\_Loader. Orchestrates the hooks of the plugin. |
  | 96 |  | \* - Free\_Comments\_For\_Wordpress\_Vuukle\_i18n. Defines internationalization functionality. |
  | 97 |  | \* - Free\_Comments\_For\_Wordpress\_Vuukle\_Admin. Defines all hooks for the admin area. |
  | 98 |  | \* - Free\_Comments\_For\_Wordpress\_Vuukle\_Public. Defines all hooks for the public side of the site. |
  | 99 |  | \* |
  | 100 |  | \* Create an instance of the loader which will be used to register the hooks |
  | 101 |  | \* with WordPress. |
  | 102 |  | \* |
  | 103 |  | \* @since  1.0.0 |
  | 104 |  | \* @access private |
  | 105 |  | \* |
  | 106 |  | \* @return void |
  | 107 |  | \*/ |
  | 108 |  | private function \_loadDependencies() |
  | 109 |  | { |
  | 110 |  |  |
  | 111 |  | /\*\* |
  | 112 |  | \* The class responsible for orchestrating the actions and filters of the |
  | 113 |  | \* core plugin. |
  | 114 |  | \*/ |
  | 115 |  | include\_once plugin\_dir\_path(dirname(\_\_FILE\_\_)) . 'includes/class-free-comments-for-wordpress-vuukle-loader.php'; |
  | 116 |  |  |
  | 117 |  | /\*\* |
  | 118 |  | \* The class responsible for defining internationalization functionality |
  | 119 |  | \* of the plugin. |
  | 120 |  | \*/ |
  | 121 |  | include\_once plugin\_dir\_path(dirname(\_\_FILE\_\_)) . 'includes/class-free-comments-for-wordpress-vuukle-i18n.php'; |
  | 122 |  |  |
  | 123 |  | /\*\* |
  | 124 |  | \* The class responsible for defining all actions that occur in the admin area. |
  | 125 |  | \*/ |
  | 126 |  | include\_once plugin\_dir\_path(dirname(\_\_FILE\_\_)) . 'admin/class-free-comments-for-wordpress-vuukle-admin.php'; |
  | 127 |  |  |
  | 128 |  | /\*\* |
  | 129 |  | \* The class responsible for defining all actions that occur in the public-facing |
  | 130 |  | \* side of the site. |
  | 131 |  | \*/ |
  | 132 |  | include\_once plugin\_dir\_path(dirname(\_\_FILE\_\_)) . 'public/class-free-comments-for-wordpress-vuukle-public.php'; |
  | 133 |  |  |
  | 134 |  | $this->loader = new Free\_Comments\_For\_Wordpress\_Vuukle\_Loader(); |
  | 135 |  | } |
  | 136 |  |  |
  | 137 |  | /\*\* |
  | 138 |  | \* Define the locale for this plugin for internationalization. |
  | 139 |  | \* |
  | 140 |  | \* Uses the Free\_Comments\_For\_Wordpress\_Vuukle\_i18n class in order to set the domain and to register the hook |
  | 141 |  | \* with WordPress. |
  | 142 |  | \* |
  | 143 |  | \* @since  1.0.0 |
  | 144 |  | \* @access private |
  | 145 |  | \* |
  | 146 |  | \* @return void |
  | 147 |  | \*/ |
  | 148 |  | private function \_setLocale() |
  | 149 |  | { |
  | 150 |  |  |
  | 151 |  | $plugin\_i18n = new Free\_Comments\_For\_Wordpress\_Vuukle\_i18n(); |
  | 152 |  |  |
  | 153 |  | $this->loader->add\_action('plugins\_loaded', $plugin\_i18n, 'load\_plugin\_textdomain'); |
  | 154 |  | } |
  | 155 |  |  |
  | 156 |  | /\*\* |
  | 157 |  | \* Register all of the hooks related to the admin area functionality |
  | 158 |  | \* of the plugin. |
  | 159 |  | \* |
  | 160 |  | \* @since  1.0.0 |
  | 161 |  | \* @access private |
  | 162 |  | \* |
  | 163 |  | \* @return void |
  | 164 |  | \*/ |
  | 165 |  | private function \_defineAdminHooks() |
  | 166 |  | { |
  | 167 |  |  |
  | 168 |  | $plugin\_admin = new Free\_Comments\_For\_Wordpress\_Vuukle\_Admin($this->getPluginName(), $this->getVersion()); |
  | 169 |  |  |
  | 170 |  | $this->loader->add\_action('admin\_enqueue\_scripts', $plugin\_admin, 'enqueueStyles'); |
  | 171 |  | $this->loader->add\_action('admin\_enqueue\_scripts', $plugin\_admin, 'enqueueScripts'); |
  | 172 |  | $this->loader->add\_action('admin\_menu', $plugin\_admin, 'adminMenu'); |
  | 173 |  | $this->loader->add\_action('admin\_enqueue\_scripts', $plugin\_admin, 'myColorPicker'); |
  | 174 |  | $this->loader->add\_action('admin\_post\_vuukleEnableFunction', $plugin\_admin, 'vuukleEnableFunction'); |
  | 175 |  | $this->loader->add\_action('admin\_post\_vuukleDeactivateFunction', $plugin\_admin, 'vuukleDeactivateFunction'); |
  | 176 |  | $this->loader->add\_action('admin\_post\_vuukleDisablePlugin', $plugin\_admin, 'vuukleDisablePlugin'); |
  | 177 |  | $this->loader->add\_action('admin\_footer', $plugin\_admin, 'activationModal'); |
  | 178 |  | $this->loader->add\_action('admin\_footer', $plugin\_admin, 'deactivationModal'); |
  | 179 |  | $this->loader->add\_action('admin\_enqueue\_scripts', $plugin\_admin, 'settingsJs'); |
  | 180 |  | $this->loader->add\_action('wp\_enqueue\_scripts', $plugin\_admin, 'jkLoadDashicons'); |
  | 181 |  | $this->loader->add\_action('wp\_ajax\_hideVuukleAdminNotice', $plugin\_admin, 'hideVuukleAdminNotice'); |
  | 182 |  | $this->loader->add\_action('wp\_ajax\_nopriv\_hideVuukleAdminNotice', $plugin\_admin, 'hideVuukleAdminNotice'); |
  | 183 |  | $this->loader->add\_action('wp\_ajax\_quickRegister', $plugin\_admin, 'quickRegister'); |
  | 184 |  | $this->loader->add\_action('wp\_ajax\_nopriv\_quickRegister', $plugin\_admin, 'quickRegister'); |
  | 185 |  | $this->loader->add\_filter('script\_loader\_src', $plugin\_admin, 'vuukleRemoveVerCssJs', 9999); |
  | 186 |  | } |
  | 187 |  |  |
  | 188 |  | /\*\* |
  | 189 |  | \* Register all of the hooks related to the public-facing functionality |
  | 190 |  | \* of the plugin. |
  | 191 |  | \* |
  | 192 |  | \* @since  1.0.0 |
  | 193 |  | \* @access private |
  | 194 |  | \* |
  | 195 |  | \* @return void |
  | 196 |  | \*/ |
  | 197 |  | private function \_definePublicHooks() |
  | 198 |  | { |
  | 199 |  |  |
  | 200 |  | $plugin\_public = new Free\_Comments\_For\_Wordpress\_Vuukle\_Public($this->getPluginName(), $this->getVersion()); |
  | 201 |  |  |
  | 202 |  | $this->loader->add\_action('wp\_enqueue\_scripts', $plugin\_public, 'enqueueStyles'); |
  | 203 |  | $this->loader->add\_action('wp\_enqueue\_scripts', $plugin\_public, 'enqueueScripts'); |
  | 204 |  | $this->loader->add\_action('wp\_ajax\_saveCommentToDb', $plugin\_public, 'saveCommentToDb'); |
  | 205 |  | $this->loader->add\_action('wp\_ajax\_nopriv\_saveCommentToDb', $plugin\_public, 'saveCommentToDb'); |
  | 206 |  | $this->loader->add\_action('init', $plugin\_public, 'generateShortcode'); |
  | 207 |  | $this->loader->add\_action('wp\_enqueue\_scripts', $plugin\_public, 'frontScripts'); |
  | 208 |  | $this->loader->add\_action('widgets\_init', $plugin\_public, 'registerRecentCommentsWidget'); |
  | 209 |  | $this->loader->add\_action('wp\_head', $plugin\_public, 'addDns'); |
  | 210 |  | $this->loader->add\_filter('script\_loader\_tag', $plugin\_public, 'defer\_parsing\_of\_js', 10); |
  | 211 |  | } |
  | 212 |  |  |
  | 213 |  | /\*\* |
  | 214 |  | \* Run the loader to execute all of the hooks with WordPress. |
  | 215 |  | \* |
  | 216 |  | \* @since 1.0.0 |
  | 217 |  | \* |
  | 218 |  | \* @return void |
  | 219 |  | \*/ |
  | 220 |  | public function run() |
  | 221 |  | { |
  | 222 |  | $this->loader->run(); |
  | 223 |  | } |
  | 224 |  |  |
  | 225 |  | /\*\* |
  | 226 |  | \* The name of the plugin used to uniquely identify it within the context of |
  | 227 |  | \* WordPress and to define internationalization functionality. |
  | 228 |  | \* |
  | 229 |  | \* @since  1.0.0 |
  | 230 |  | \* @return string    The name of the plugin. |
  | 231 |  | \*/ |
  | 232 |  | public function getPluginName() |
  | 233 |  | { |
  | 234 |  | return $this->plugin\_name; |
  | 235 |  | } |
  | 236 |  |  |
  | 237 |  | /\*\* |
  | 238 |  | \* The reference to the class that orchestrates the hooks with the plugin. |
  | 239 |  | \* |
  | 240 |  | \* @since  1.0.0 |
  | 241 |  | \* @return Free\_Comments\_For\_Wordpress\_Vuukle\_Loader    Orchestrates the hooks of the plugin. |
  | 242 |  | \*/ |
  | 243 |  | public function getLoader() |
  | 244 |  | { |
  | 245 |  | return $this->loader; |
  | 246 |  | } |
  | 247 |  | /\*\* |
  | 248 |  | \* Retrieve the version number of the plugin. |
  | 249 |  | \* |
  | 250 |  | \* @since  1.0.0 |
  | 251 |  | \* @return string    The version number of the plugin. |
  | 252 |  | \*/ |
  | 253 |  | public function getVersion() |
  | 254 |  | { |
  | 255 |  | return $this->version; |
  | 256 |  | } |
  |  | 34 | class Free\_Comments\_For\_Wordpress\_Vuukle { |
  |  | 35 |  |
  |  | 36 | /\*\* |
  |  | 37 | \* The loader that's responsible for maintaining and registering all hooks that power |
  |  | 38 | \* the plugin. |
  |  | 39 | \* |
  |  | 40 | \* @since  1.0.0 |
  |  | 41 | \* @access protected |
  |  | 42 | \* @var    Free\_Comments\_For\_Wordpress\_Vuukle\_Loader $loader Maintains and registers all hooks for the plugin. |
  |  | 43 | \*/ |
  |  | 44 | protected $loader; |
  |  | 45 |  |
  |  | 46 | /\*\* |
  |  | 47 | \* The unique identifier of this plugin. |
  |  | 48 | \* |
  |  | 49 | \* @since  1.0.0 |
  |  | 50 | \* @access protected |
  |  | 51 | \* @var    string $plugin\_name The string used to uniquely identify this plugin. |
  |  | 52 | \*/ |
  |  | 53 | protected $plugin\_name; |
  |  | 54 |  |
  |  | 55 | /\*\* |
  |  | 56 | \* The current version of the plugin. |
  |  | 57 | \* |
  |  | 58 | \* @since  1.0.0 |
  |  | 59 | \* @access protected |
  |  | 60 | \* @var    string $version The current version of the plugin. |
  |  | 61 | \*/ |
  |  | 62 | protected $version; |
  |  | 63 |  |
  |  | 64 | /\*\* |
  |  | 65 | \* Define the core functionality of the plugin. |
  |  | 66 | \* |
  |  | 67 | \* Set the plugin name and the plugin version that can be used throughout the plugin. |
  |  | 68 | \* Load the dependencies, define the locale, and set the hooks for the admin area and |
  |  | 69 | \* the public-facing side of the site. |
  |  | 70 | \* |
  |  | 71 | \* @since 1.0.0 |
  |  | 72 | \*/ |
  |  | 73 | public function \_\_construct() { |
  |  | 74 | if ( defined( 'FREE\_COMMENTS\_FOR\_WORDPRESS\_VUUKLE\_VERSION' ) ) { |
  |  | 75 | $this->version = FREE\_COMMENTS\_FOR\_WORDPRESS\_VUUKLE\_VERSION; |
  |  | 76 | } else { |
  |  | 77 | $this->version = '1.0.0'; |
  |  | 78 | } |
  |  | 79 | $this->plugin\_name = 'free-comments-for-wordpress-vuukle'; |
  |  | 80 | $this->\_loadDependencies(); |
  |  | 81 | $this->\_setLocale(); |
  |  | 82 | $this->\_defineAdminHooks(); |
  |  | 83 | $this->\_definePublicHooks(); |
  |  | 84 | } |
  |  | 85 |  |
  |  | 86 | /\*\* |
  |  | 87 | \* Load the required dependencies for this plugin. |
  |  | 88 | \* |
  |  | 89 | \* Include the following files that make up the plugin: |
  |  | 90 | \* |
  |  | 91 | \* - Free\_Comments\_For\_Wordpress\_Vuukle\_Loader. Orchestrates the hooks of the plugin. |
  |  | 92 | \* - Free\_Comments\_For\_Wordpress\_Vuukle\_i18n. Defines internationalization functionality. |
  |  | 93 | \* - Free\_Comments\_For\_Wordpress\_Vuukle\_Admin. Defines all hooks for the admin area. |
  |  | 94 | \* - Free\_Comments\_For\_Wordpress\_Vuukle\_Public. Defines all hooks for the public side of the site. |
  |  | 95 | \* |
  |  | 96 | \* Create an instance of the loader which will be used to register the hooks |
  |  | 97 | \* with WordPress. |
  |  | 98 | \* |
  |  | 99 | \* @return void |
  |  | 100 | \* @since  1.0.0 |
  |  | 101 | \* @access private |
  |  | 102 | \* |
  |  | 103 | \*/ |
  |  | 104 | private function \_loadDependencies() { |
  |  | 105 |  |
  |  | 106 | /\*\* |
  |  | 107 | \* The class responsible for orchestrating the actions and filters of the |
  |  | 108 | \* core plugin. |
  |  | 109 | \*/ |
  |  | 110 | include\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'includes/class-free-comments-for-wordpress-vuukle-loader.php'; |
  |  | 111 | /\*\* |
  |  | 112 | \* The class responsible for defining internationalization functionality |
  |  | 113 | \* of the plugin. |
  |  | 114 | \*/ |
  |  | 115 | include\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'includes/class-free-comments-for-wordpress-vuukle-i18n.php'; |
  |  | 116 | /\*\* |
  |  | 117 | \* The class responsible for defining all actions that occur in the admin area. |
  |  | 118 | \*/ |
  |  | 119 | include\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'admin/class-free-comments-for-wordpress-vuukle-admin.php'; |
  |  | 120 | /\*\* |
  |  | 121 | \* The class responsible for defining all actions that occur in the public-facing |
  |  | 122 | \* side of the site. |
  |  | 123 | \*/ |
  |  | 124 | include\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'public/class-free-comments-for-wordpress-vuukle-public.php'; |
  |  | 125 | $this->loader = new Free\_Comments\_For\_Wordpress\_Vuukle\_Loader(); |
  |  | 126 | } |
  |  | 127 |  |
  |  | 128 | /\*\* |
  |  | 129 | \* Define the locale for this plugin for internationalization. |
  |  | 130 | \* |
  |  | 131 | \* Uses the Free\_Comments\_For\_Wordpress\_Vuukle\_i18n class in order to set the domain and to register the hook |
  |  | 132 | \* with WordPress. |
  |  | 133 | \* |
  |  | 134 | \* @return void |
  |  | 135 | \* @since  1.0.0 |
  |  | 136 | \* @access private |
  |  | 137 | \* |
  |  | 138 | \*/ |
  |  | 139 | private function \_setLocale() { |
  |  | 140 |  |
  |  | 141 | $plugin\_i18n = new Free\_Comments\_For\_Wordpress\_Vuukle\_i18n(); |
  |  | 142 | $this->loader->add\_action( 'plugins\_loaded', $plugin\_i18n, 'load\_plugin\_textdomain' ); |
  |  | 143 | } |
  |  | 144 |  |
  |  | 145 | /\*\* |
  |  | 146 | \* Register all of the hooks related to the admin area functionality |
  |  | 147 | \* of the plugin. |
  |  | 148 | \* |
  |  | 149 | \* @return void |
  |  | 150 | \* @since  1.0.0 |
  |  | 151 | \* @access private |
  |  | 152 | \* |
  |  | 153 | \*/ |
  |  | 154 | private function \_defineAdminHooks() { |
  |  | 155 |  |
  |  | 156 | $plugin\_admin = new Free\_Comments\_For\_Wordpress\_Vuukle\_Admin( $this->getPluginName(), $this->getVersion() ); |
  |  | 157 | $this->loader->add\_action( 'admin\_init', $plugin\_admin, 'start\_session' ); |
  |  | 158 | $this->loader->add\_action( 'admin\_init', $plugin\_admin, 'check\_one\_month\_passed' ); |
  |  | 159 | $this->loader->add\_action( 'admin\_init', $plugin\_admin, 'try\_quick\_register' ); |
  |  | 160 | $this->loader->add\_action( 'admin\_enqueue\_scripts', $plugin\_admin, 'enqueueStyles' ); |
  |  | 161 | $this->loader->add\_action( 'admin\_enqueue\_scripts', $plugin\_admin, 'enqueueScripts' ); |
  |  | 162 | $this->loader->add\_action( 'admin\_menu', $plugin\_admin, 'adminMenu' ); |
  |  | 163 | $this->loader->add\_action( 'admin\_enqueue\_scripts', $plugin\_admin, 'myColorPicker' ); |
  |  | 164 | $this->loader->add\_action( 'admin\_post\_vuukleEnableFunction', $plugin\_admin, 'vuukleEnableFunction' ); |
  |  | 165 | $this->loader->add\_action( 'admin\_post\_vuukleDeactivateFunction', $plugin\_admin, 'vuukleDeactivateFunction' ); |
  |  | 166 | $this->loader->add\_action( 'admin\_post\_VuukleSaveSettings', $plugin\_admin, 'VuukleSaveSettings' ); |
  |  | 167 | $this->loader->add\_action( 'admin\_post\_VuukleResetSettings', $plugin\_admin, 'VuukleResetSettings' ); |
  |  | 168 | $this->loader->add\_action( 'admin\_footer', $plugin\_admin, 'activationModal' ); |
  |  | 169 | $this->loader->add\_action( 'admin\_footer', $plugin\_admin, 'deactivationModal' ); |
  |  | 170 | $this->loader->add\_action( 'admin\_enqueue\_scripts', $plugin\_admin, 'settingsJs' ); |
  |  | 171 | $this->loader->add\_action( 'wp\_enqueue\_scripts', $plugin\_admin, 'jkLoadDashicons' ); |
  |  | 172 | $this->loader->add\_action( 'wp\_ajax\_hideVuukleAdminNotice', $plugin\_admin, 'hideVuukleAdminNotice' ); |
  |  | 173 | $this->loader->add\_action( 'wp\_ajax\_nopriv\_hideVuukleAdminNotice', $plugin\_admin, 'hideVuukleAdminNotice' ); |
  |  | 174 | $this->loader->add\_action( 'wp\_ajax\_quickRegister', $plugin\_admin, 'quickRegister' ); |
  |  | 175 | $this->loader->add\_action( 'wp\_ajax\_nopriv\_quickRegister', $plugin\_admin, 'quickRegister' ); |
  |  | 176 | $this->loader->add\_filter( 'script\_loader\_src', $plugin\_admin, 'vuukleRemoveVerCssJs', 9999 ); |
  |  | 177 | } |
  |  | 178 |  |
  |  | 179 | /\*\* |
  |  | 180 | \* Register all of the hooks related to the public-facing functionality |
  |  | 181 | \* of the plugin. |
  |  | 182 | \* |
  |  | 183 | \* @return void |
  |  | 184 | \* @since  1.0.0 |
  |  | 185 | \* @access private |
  |  | 186 | \* |
  |  | 187 | \*/ |
  |  | 188 | private function \_definePublicHooks() { |
  |  | 189 |  |
  |  | 190 | $plugin\_public = new Free\_Comments\_For\_Wordpress\_Vuukle\_Public( $this->getPluginName(), $this->getVersion() ); |
  |  | 191 | $this->loader->add\_action( 'wp\_enqueue\_scripts', $plugin\_public, 'enqueueStyles' ); |
  |  | 192 | $this->loader->add\_action( 'wp\_enqueue\_scripts', $plugin\_public, 'enqueueScripts' ); |
  |  | 193 | $this->loader->add\_action( 'wp\_ajax\_saveCommentToDb', $plugin\_public, 'saveCommentToDb' ); |
  |  | 194 | $this->loader->add\_action( 'wp\_ajax\_nopriv\_saveCommentToDb', $plugin\_public, 'saveCommentToDb' ); |
  |  | 195 | $this->loader->add\_action( 'init', $plugin\_public, 'generateShortcode' ); |
  |  | 196 | $this->loader->add\_action( 'wp\_enqueue\_scripts', $plugin\_public, 'frontScripts' ); |
  |  | 197 | $this->loader->add\_action( 'widgets\_init', $plugin\_public, 'registerRecentCommentsWidget' ); |
  |  | 198 | $this->loader->add\_action( 'wp\_head', $plugin\_public, 'addDns' ); |
  |  | 199 | $this->loader->add\_filter( 'script\_loader\_tag', $plugin\_public, 'defer\_parsing\_of\_js', 10 ); |
  |  | 200 | } |
  |  | 201 |  |
  |  | 202 | /\*\* |
  |  | 203 | \* Run the loader to execute all of the hooks with WordPress. |
  |  | 204 | \* |
  |  | 205 | \* @return void |
  |  | 206 | \* @since 1.0.0 |
  |  | 207 | \* |
  |  | 208 | \*/ |
  |  | 209 | public function run() { |
  |  | 210 | $this->loader->run(); |
  |  | 211 | } |
  |  | 212 |  |
  |  | 213 | /\*\* |
  |  | 214 | \* The name of the plugin used to uniquely identify it within the context of |
  |  | 215 | \* WordPress and to define internationalization functionality. |
  |  | 216 | \* |
  |  | 217 | \* @return string    The name of the plugin. |
  |  | 218 | \* @since  1.0.0 |
  |  | 219 | \*/ |
  |  | 220 | public function getPluginName() { |
  |  | 221 | return $this->plugin\_name; |
  |  | 222 | } |
  |  | 223 |  |
  |  | 224 | /\*\* |
  |  | 225 | \* The reference to the class that orchestrates the hooks with the plugin. |
  |  | 226 | \* |
  |  | 227 | \* @return Free\_Comments\_For\_Wordpress\_Vuukle\_Loader    Orchestrates the hooks of the plugin. |
  |  | 228 | \* @since  1.0.0 |
  |  | 229 | \*/ |
  |  | 230 | public function getLoader() { |
  |  | 231 | return $this->loader; |
  |  | 232 | } |
  |  | 233 |  |
  |  | 234 | /\*\* |
  |  | 235 | \* Retrieve the version number of the plugin. |
  |  | 236 | \* |
  |  | 237 | \* @return string    The version number of the plugin. |
  |  | 238 | \* @since  1.0.0 |
  |  | 239 | \*/ |
  |  | 240 | public function getVersion() { |
  |  | 241 | return $this->version; |
  |  | 242 | } |
  | 257 | 243 | } |
* ## [free-comments-for-wordpress-vuukle/trunk/includes/commentbox.php](/changeset/2553337/free-comments-for-wordpress-vuukle/trunk/includes/commentbox.php "Show the changeset 2553337 restricted to free-comments-for-wordpress-vuukle/trunk/includes/commentbox.php")

  | [r2533938](/browser/free-comments-for-wordpress-vuukle/trunk/includes/commentbox.php?rev=2533938#L19 "Show revision 2533938 of this file in browser") | [r2553337](/browser/free-comments-for-wordpress-vuukle/trunk/includes/commentbox.php?rev=2553337#L19 "Show revision 2553337 of this file in browser") |  |
  | --- | --- | --- |
  | 19 | 19 | if (isset($vuukle->settings)) { |
  | 20 | 20 | $vuukle->settings['emote\_position'] = 1; |
  | 21 |  | ~~$check\_amp = isset($vuukle->settings['embed\_emotes\_amp']) && $vuukle->settings['embed\_emotes\_amp'] == 'on' ? true : false;~~ |
  | 22 | 21 | $v\_app\_key = isset($vuukle->settings['AppId']) && $vuukle->settings['AppId'] != '' ? $vuukle->settings['AppId'] : ''; |
  | 23 | 22 | } |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/includes/commentbox.php?rev=2533938#L212) | […](/browser/free-comments-for-wordpress-vuukle/trunk/includes/commentbox.php?rev=2553337#L211) |  |
  | 212 | 211 | <?php endif; ?> |
  | 213 | 212 |  |
  | 214 |  | ~~<?php if (!empty($vuukle->settings['div\_id\_newsfeed']) && '2' === $vuukle->settings['embed\_newsfeed']) : ?>~~ |
  | 215 |  | ~~<script data-cfasync="false">~~ |
  | 216 |  | ~~var str = document.getElementById("<?php echo esc\_attr($vuukle->settings['div\_id\_newsfeed']); ?>");~~ |
  | 217 |  | ~~if (str === null) {~~ |
  | 218 |  | ~~console.warn("Vuukle newsfeed post request was not completed because the divClassID for Vuukle Widgets is invalid. Please check your configuration.");~~ |
  | 219 |  | ~~} else {~~ |
  | 220 |  | ~~document.addEventListener("DOMContentLoaded", function(event) {~~ |
  | 221 |  | ~~var newsfeedBoxDiv = document.getElementById("vuukle-newsfeed");~~ |
  | 222 |  | ~~var newsfeedBoxDivAfter = document.getElementById("<?php echo esc\_attr($vuukle->settings['div\_id\_newsfeed']); ?>");~~ |
  | 223 |  | ~~var cloneNewsfeedBoxDiv = newsfeedBoxDiv.cloneNode(true);~~ |
  | 224 |  | ~~newsfeedBoxDiv.parentNode.removeChild(newsfeedBoxDiv);~~ |
  | 225 |  | ~~newsfeedBoxDivAfter.parentNode.insertBefore(cloneNewsfeedBoxDiv, newsfeedBoxDivAfter.nextSibling);~~ |
  | 226 |  | ~~});~~ |
  | 227 |  | ~~}~~ |
  | 228 |  | ~~</script>~~ |
  | 229 |  | ~~<style>~~ |
  | 230 |  | ~~#vuukle-newsfeed {~~ |
  | 231 |  | ~~position: relative !important;~~ |
  | 232 |  | ~~}~~ |
  | 233 |  | ~~</style>~~ |
  | 234 |  | ~~<?php endif; ?>~~ |
  | 235 |  |  |
  | 236 |  | ~~<?php if (!empty($vuukle->settings['div\_class\_newsfeed']) && '1' === $vuukle->settings['embed\_newsfeed']) : ?>~~ |
  | 237 |  | ~~<script data-cfasync="false">~~ |
  | 238 |  | ~~var str = document.getElementsByClassName("<?php echo esc\_attr($vuukle->settings['div\_class\_newsfeed']); ?>");~~ |
  | 239 |  | ~~if (str === null) {~~ |
  | 240 |  | ~~console.warn("Vuukle newsfeed post request was not completed because the divClass for Vuukle Widgets is invalid. Please check your configuration.");~~ |
  | 241 |  | ~~} else {~~ |
  | 242 |  | ~~document.addEventListener("DOMContentLoaded", function(event) {~~ |
  | 243 |  | ~~var newsfeedBoxDiv2 = document.getElementById("vuukle-newsfeed");~~ |
  | 244 |  | ~~var newsfeedBoxDivAfter\_for2 = document.getElementsByClassName("<?php echo esc\_attr($vuukle->settings['div\_class\_newsfeed']); ?>")[0];~~ |
  | 245 |  | ~~var cloneNewsfeedBoxDiv2 = newsfeedBoxDiv2.cloneNode(true);~~ |
  | 246 |  | ~~newsfeedBoxDiv2.parentNode.removeChild(newsfeedBoxDiv2);~~ |
  | 247 |  | ~~newsfeedBoxDivAfter\_for2.parentNode.insertBefore(cloneNewsfeedBoxDiv2, newsfeedBoxDivAfter\_for2.nextSibling);~~ |
  | 248 |  | ~~});~~ |
  | 249 |  | ~~}~~ |
  | 250 |  | ~~</script>~~ |
  | 251 |  |  |
  | 252 |  | ~~<?php endif; ?>~~ |
  | 253 | 213 |  |
  | 254 | 214 |  |
* ## [free-comments-for-wordpress-vuukle/trunk/includes/export-comments.php](/changeset/2553337/free-comments-for-wordpress-vuukle/trunk/includes/export-comments.php "Show the changeset 2553337 restricted to free-comments-for-wordpress-vuukle/trunk/includes/export-comments.php")

  | [r2509274](/browser/free-comments-for-wordpress-vuukle/trunk/includes/export-comments.php?rev=2509274#L1 "Show revision 2509274 of this file in browser") | [r2553337](/browser/free-comments-for-wordpress-vuukle/trunk/includes/export-comments.php?rev=2553337#L1 "Show revision 2553337 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php |
  | 2 |  |  |
  | 3 | 2 | /\*\* |
  | 4 | 3 | \* The file that defines the core plugin class |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/includes/export-comments.php?rev=2509274#L15) | […](/browser/free-comments-for-wordpress-vuukle/trunk/includes/export-comments.php?rev=2553337#L14) |  |
  | 15 | 14 | \* @since      1.0.0 |
  | 16 | 15 | \*/ |
  | 17 |  |  |
  | 18 |  | add\_action( |
  | 19 |  | 'admin\_menu', |
  | 20 |  | function () { |
  | 21 |  | add\_options\_page('Export comments', 'Export comments', 'manage\_options', 'export-comments-xml', 'export\_comments\_plugin\_page'); |
  | 22 |  | } |
  | 23 |  | ); |
  | 24 |  |  |
  | 25 |  |  |
  | 26 |  | add\_action( |
  | 27 |  | 'admin\_head', |
  | 28 |  | function () { |
  | 29 |  | echo '<style>.wp-submenu a[href\*="export-comments-xml"]{display:none!important}</style>'; |
  | 30 |  | } |
  | 31 |  | ); |
  | 32 |  |  |
  | 33 |  | add\_action( |
  | 34 |  | 'wp\_ajax\_export\_comments\_plugin\_page', |
  | 35 |  | function () { |
  | 36 |  | if (!isset($\_GET['\_wpnonce']) && wp\_verify\_nonce(sanitize\_key($\_GET['\_wpnonce']))) { // Input var okay |
  | 37 |  | return true; |
  | 38 |  | } |
  | 39 |  |  |
  | 40 |  | $amount\_comments = $\_GET['amount\_comments']; // phpcs:ignore WordPress.VIP |
  | 41 |  | $offset = $\_GET['offset']; // phpcs:ignore WordPress.VIP |
  | 42 |  |  |
  | 43 |  | if (!is\_dir(plugin\_dir\_path(\_\_FILE\_\_) . 'files')) { |
  | 44 |  | wp\_mkdir\_p(plugin\_dir\_path(\_\_FILE\_\_) . 'files'); |
  | 45 |  | } else if ($offset == 0) { |
  | 46 |  | cleanDir(plugin\_dir\_path(\_\_FILE\_\_) . 'files'); |
  | 47 |  | } |
  | 48 |  |  |
  | 49 |  |  |
  | 50 |  |  |
  | 51 |  | $limit = $amount\_comments; |
  | 52 |  | $offse2 = $offset \* $limit; |
  | 53 |  | global $wpdb; |
  | 54 |  | $table    = $wpdb->prefix . 'comments'; |
  | 55 |  | $query    = "SELECT \* FROM $table LIMIT $offse2, $limit"; |
  | 56 |  | $comments = $wpdb->get\_results($query, OBJECT\_K); // phpcs:ignore WordPress |
  | 57 |  |  |
  | 58 |  | if (empty($comments)) { |
  | 59 |  | if ($offset == 0) { |
  | 60 |  | echo json\_encode(array('result' => '-1', 'link' => '', 'message' => 'Comments not found in database.')); |
  | 61 |  | exit; |
  | 62 |  | } |
  | 63 |  | $time   = gmdate('Y-m-d'); |
  | 64 |  | $file\_name = get\_bloginfo('name') . '-commment-export-' . $time . '.zip'; |
  | 65 |  | $file\_path\_zip = plugin\_dir\_path(\_\_FILE\_\_) . 'files/' . $file\_name; |
  | 66 |  | $zip      = new ZipArchive(); |
  | 67 |  | $zip\_name = $file\_path\_zip; |
  | 68 |  | if (true !== $zip->open($zip\_name, ZIPARCHIVE::CREATE)) { |
  | 69 |  | echo json\_encode(array('result' => '-1', 'link' => '', 'message' => 'Sorry ZIP creation failed at this time')); |
  | 70 |  | exit; |
  | 71 |  | } else { |
  | 72 |  | $file\_path\_zip = plugin\_dir\_path(\_\_FILE\_\_) . 'files/'; |
  | 73 |  | for ($i = 0; $i < $offset; $i++) { |
  | 74 |  | $zip->addFile(plugin\_dir\_path(\_\_FILE\_\_) . 'files/' . $i . '\_comments.xml',  $i . '\_comments.xml'); |
  | 75 |  | } |
  | 76 |  | $zip->close(); |
  | 77 |  | } |
  | 78 |  |  |
  | 79 |  | $linkToDownload = plugins\_url() . '/free-comments-for-wordpress-vuukle/includes/files/' . $file\_name; // WPCS: XSS ok |
  | 80 |  |  |
  | 81 |  | echo json\_encode(array('result' => '0', 'link' => $linkToDownload)); |
  | 82 |  | exit; |
  | 83 |  | } else { |
  | 84 |  | $xml = '<?xml version="1.0" encoding="UTF-8" ?> |
  |  | 16 | add\_action( 'admin\_head', function () { |
  |  | 17 | echo '<style>.wp-submenu a[href\*="export-comments-xml"]{display:none!important}</style>'; |
  |  | 18 | } ); |
  |  | 19 | add\_action( 'wp\_ajax\_export\_comments\_plugin\_page', function () { |
  |  | 20 | $nonce = ! empty( $\_GET['\_wpnonce'] ) ? sanitize\_key( $\_GET['\_wpnonce'] ) : ''; |
  |  | 21 | if ( ! wp\_verify\_nonce( $nonce ) ) { |
  |  | 22 | die(); |
  |  | 23 | } |
  |  | 24 | $amount\_comments = (int) esc\_sql( $\_GET['amount\_comments'] ); // phpcs:ignore WordPress.VIP |
  |  | 25 | $offset          = (int) esc\_sql( $\_GET['offset'] ); // phpcs:ignore WordPress.VIP |
  |  | 26 | if ( ! is\_dir( plugin\_dir\_path( \_\_FILE\_\_ ) . 'files' ) ) { |
  |  | 27 | wp\_mkdir\_p( plugin\_dir\_path( \_\_FILE\_\_ ) . 'files' ); |
  |  | 28 | } elseif ( $offset == 0 ) { |
  |  | 29 | cleanDir( plugin\_dir\_path( \_\_FILE\_\_ ) . 'files' ); |
  |  | 30 | } |
  |  | 31 | $limit  = $amount\_comments; |
  |  | 32 | $offse2 = $offset \* $limit; |
  |  | 33 | global $wpdb; |
  |  | 34 | $table    = $wpdb->prefix . 'comments'; |
  |  | 35 | $query    = "SELECT \* FROM $table LIMIT $offse2, $limit"; |
  |  | 36 | $comments = $wpdb->get\_results( $query, OBJECT\_K ); // phpcs:ignore WordPress |
  |  | 37 | if ( empty( $comments ) ) { |
  |  | 38 | if ( $offset == 0 ) { |
  |  | 39 | echo json\_encode( array( 'result' => '-1', 'link' => '', 'message' => 'Comments not found in database.' ) ); |
  |  | 40 | exit; |
  |  | 41 | } |
  |  | 42 | $time          = gmdate( 'Y-m-d' ); |
  |  | 43 | $file\_name     = get\_bloginfo( 'name' ) . '-commment-export-' . $time . '.zip'; |
  |  | 44 | $file\_path\_zip = plugin\_dir\_path( \_\_FILE\_\_ ) . 'files/' . $file\_name; |
  |  | 45 | $zip           = new ZipArchive(); |
  |  | 46 | $zip\_name      = $file\_path\_zip; |
  |  | 47 | if ( true !== $zip->open( $zip\_name, ZIPARCHIVE::CREATE ) ) { |
  |  | 48 | echo json\_encode( array( 'result' => '-1', 'link' => '', 'message' => 'Sorry ZIP creation failed at this time' ) ); |
  |  | 49 | exit; |
  |  | 50 | } else { |
  |  | 51 | $file\_path\_zip = plugin\_dir\_path( \_\_FILE\_\_ ) . 'files/'; |
  |  | 52 | for ( $i = 0; $i < $offset; $i ++ ) { |
  |  | 53 | $zip->addFile( plugin\_dir\_path( \_\_FILE\_\_ ) . 'files/' . $i . '\_comments.xml', $i . '\_comments.xml' ); |
  |  | 54 | } |
  |  | 55 | $zip->close(); |
  |  | 56 | } |
  |  | 57 | $linkToDownload = plugins\_url() . '/free-comments-for-wordpress-vuukle/includes/files/' . $file\_name; // WPCS: XSS ok |
  |  | 58 | echo json\_encode( array( 'result' => '0', 'link' => $linkToDownload ) ); |
  |  | 59 | exit; |
  |  | 60 | } else { |
  |  | 61 | $xml = '<?xml version="1.0" encoding="UTF-8" ?> |
  | 85 | 62 | <rss version="2.0" |
  | 86 | 63 | xmlns:excerpt="http://wordpress.org/export/1.2/excerpt/" |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/includes/export-comments.php?rev=2509274#L91) | […](/browser/free-comments-for-wordpress-vuukle/trunk/includes/export-comments.php?rev=2553337#L68) |  |
  | 91 | 68 | <channel> |
  | 92 | 69 | <wp:wxr\_version>1.2</wp:wxr\_version>'; |
  | 93 |  | foreach ($comments as $comment) { |
  | 94 |  | $author\_post\_id   = get\_post($comment->comment\_post\_ID); |
  | 95 |  | $author\_post\_id   = $author\_post\_id->post\_author; |
  | 96 |  | $author\_post\_name = get\_author\_name($author\_post\_id); |
  | 97 |  | $categories       = get\_the\_category($comment->comment\_post\_ID); |
  | 98 |  | $string\_caegorty  = ''; |
  | 99 |  | if (!empty($categories)) { |
  | 100 |  | foreach ($categories as $category) { |
  | 101 |  | $string\_caegorty .= '<category domain="post\_tag" nicename="' . $category->name . '"><![CDATA[' . $category->name . ']]></category>'; |
  | 102 |  | } |
  | 103 |  | } |
  | 104 |  | $date\_comment = gmdate('Y-m-d', strtotime($comment->comment\_date)) . 'T' . gmdate('H:i:s', strtotime($comment->comment\_date)); |
  | 105 |  |  |
  | 106 |  | $xml .= '<item> |
  |  | 70 | foreach ( $comments as $comment ) { |
  |  | 71 | $comment\_post     = get\_post( $comment->comment\_post\_ID ); |
  |  | 72 | $author\_id        = $comment\_post->post\_author; |
  |  | 73 | $author\_post\_name = get\_the\_author\_meta( 'display\_name', $author\_id ); |
  |  | 74 | $categories       = get\_the\_category( $comment\_post->ID ); |
  |  | 75 | $string\_caegorty  = ''; |
  |  | 76 | if ( ! empty( $categories ) ) { |
  |  | 77 | foreach ( $categories as $category ) { |
  |  | 78 | $string\_caegorty .= '<category domain="post\_tag" nicename="' . $category->name . '"><![CDATA[' . $category->name . ']]></category>'; |
  |  | 79 | } |
  |  | 80 | } |
  |  | 81 | $date\_comment = gmdate( 'Y-m-d', strtotime( $comment->comment\_date ) ) . 'T' . gmdate( 'H:i:s', strtotime( $comment->comment\_date ) ); |
  |  | 82 | $xml          .= '<item> |
  | 107 | 83 | <dc:creator><![CDATA[' . $author\_post\_name . ']]></dc:creator> |
  | 108 | 84 | <wp:post\_type><![CDATA[post]]></wp:post\_type> |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/includes/export-comments.php?rev=2509274#L110) | […](/browser/free-comments-for-wordpress-vuukle/trunk/includes/export-comments.php?rev=2553337#L86) |  |
  | 110 | 86 | <wp:comment\_date><![CDATA[' . $date\_comment . ']]></wp:comment\_date> |
  | 111 | 87 | ' . $string\_caegorty . ' |
  | 112 |  | <link><![CDATA[' . get\_permalink(~~$comment->comment\_post\_ID~~) . ']]></link> |
  | 113 |  | <title><![CDATA[' . get\_the\_title(~~$comment->comment\_post\_ID~~) . ']]></title> |
  |  | 88 | <link><![CDATA[' . get\_permalink( $comment->comment\_post\_ID ) . ']]></link> |
  |  | 89 | <title><![CDATA[' . get\_the\_title( $comment->comment\_post\_ID ) . ']]></title> |
  | 114 | 90 | <wp:post\_id><![CDATA[' . $comment->comment\_post\_ID . ']]></wp:post\_id> |
  | 115 | 91 | <wp:comment> |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/includes/export-comments.php?rev=2509274#L122) | […](/browser/free-comments-for-wordpress-vuukle/trunk/includes/export-comments.php?rev=2553337#L98) |  |
  | 122 | 98 | </wp:comment> |
  | 123 | 99 | </item>'; |
  | 124 |  | } |
  | 125 |  |  |
  | 126 |  | $xml .= '</channel> |
  |  | 100 | } |
  |  | 101 | $xml           .= '</channel> |
  | 127 | 102 | </rss>'; |
  | 128 |  |  |
  | 129 |  |  |
  | 130 |  | $file\_path\_xml = plugin\_dir\_path(\_\_FILE\_\_) . 'files/' . $offset . '\_comments.xml'; |
  | 131 |  | file\_put\_contents($file\_path\_xml, $xml); // phpcs:ignore WordPress.VIP.FileSystemWritesDisallow, WordPress.WP.AlternativeFunctions |
  | 132 |  |  |
  | 133 |  | $offset++; |
  | 134 |  | echo json\_encode(array('result' => $offset)); |
  | 135 |  | } |
  | 136 |  |  |
  | 137 |  | exit; |
  | 138 |  | } |
  | 139 |  | ); |
  | 140 |  |  |
  | 141 |  | /\*add\_action( 'wp\_ajax\_export\_comments\_plugin\_page', array($this,'export\_comments\_plugin\_page') ); |
  | 142 |  | add\_action( 'wp\_ajax\_nopriv\_export\_comments\_plugin\_page',  array($this,'export\_comments\_plugin\_page') );\*/ |
  | 143 |  |  |
  | 144 |  | if (!function\_exists("cleanDir")) { |
  | 145 |  | /\*\* |
  | 146 |  | \* This function is cleanid dir |
  | 147 |  | \* |
  | 148 |  | \* @param string $dir parametr |
  | 149 |  | \* |
  | 150 |  | \* @since  1.0.0 |
  | 151 |  | \* @return void |
  | 152 |  | \*/ |
  | 153 |  | function cleanDir($dir) |
  | 154 |  | { |
  | 155 |  | $files = glob($dir . '/\*'); |
  | 156 |  | if (count($files) > 0) { |
  | 157 |  | foreach ($files as $file) { |
  | 158 |  | if (file\_exists($file)) { |
  | 159 |  | unlink($file); // phpcs:ignore WordPress.VIP.FileSystemWritesDisallow, WordPress.WP.AlternativeFunctions |
  | 160 |  | } |
  | 161 |  | } |
  | 162 |  | } |
  | 163 |  | } |
  |  | 103 | $file\_path\_xml = plugin\_dir\_path( \_\_FILE\_\_ ) . 'files/' . $offset . '\_comments.xml'; |
  |  | 104 | file\_put\_contents( $file\_path\_xml, $xml ); // phpcs:ignore WordPress.VIP.FileSystemWritesDisallow, WordPress.WP.AlternativeFunctions |
  |  | 105 | $offset ++; |
  |  | 106 | echo json\_encode( array( 'result' => $offset ) ); |
  |  | 107 | } |
  |  | 108 | exit; |
  |  | 109 | } ); |
  |  | 110 | if ( ! function\_exists( "cleanDir" ) ) { |
  |  | 111 | /\*\* |
  |  | 112 | \* This function is cleanid dir |
  |  | 113 | \* |
  |  | 114 | \* @param   string  $dir  parametr |
  |  | 115 | \* |
  |  | 116 | \* @return void |
  |  | 117 | \* @since  1.0.0 |
  |  | 118 | \*/ |
  |  | 119 | function cleanDir( $dir ) { |
  |  | 120 | $files = glob( $dir . '/\*' ); |
  |  | 121 | if ( count( $files ) > 0 ) { |
  |  | 122 | foreach ( $files as $file ) { |
  |  | 123 | if ( file\_exists( $file ) ) { |
  |  | 124 | unlink( $file ); // phpcs:ignore WordPress.VIP.FileSystemWritesDisallow, WordPress.WP.AlternativeFunctions |
  |  | 125 | } |
  |  | 126 | } |
  |  | 127 | } |
  |  | 128 | } |
  | 164 | 129 | } |
* ## [free-comments-for-wordpress-vuukle/trunk/includes/free-comments-for-wordpress-vuukle-activate-modal.php](/changeset/2553337/free-comments-for-wordpress-vuukle/trunk/includes/free-comments-for-wordpress-vuukle-activate-modal.php "Show the changeset 2553337 restricted to free-comments-for-wordpress-vuukle/trunk/includes/free-comments-for-wordpress-vuukle-activate-modal.php")

  | [r2527980](/browser/free-comments-for-wordpress-vuukle/trunk/includes/free-comments-for-wordpress-vuukle-activate-modal.php?rev=2527980#L1 "Show revision 2527980 of this file in browser") | [r2553337](/browser/free-comments-for-wordpress-vuukle/trunk/includes/free-comments-for-wordpress-vuukle-activate-modal.php?rev=2553337#L1 "Show revision 2553337 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php |
  | 2 |  |  |
  | 3 | 2 | /\*\* |
  | 4 | 3 | \* The file that defines the core plugin class |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/includes/free-comments-for-wordpress-vuukle-activate-modal.php?rev=2527980#L23) | […](/browser/free-comments-for-wordpress-vuukle/trunk/includes/free-comments-for-wordpress-vuukle-activate-modal.php?rev=2553337#L22) |  |
  | 23 | 22 | <div class="modal-body"> |
  | 24 | 23 | <center><img src="<?php echo VUUKLE\_ADMIN\_URL ?>/images/logo.png" style="width: 100px;"></center> |
  | 25 |  | <p><strong>Vuukle is installed on your site and your admin email used is <a href="mailto:<?php echo esc\_attr(get\_option('admin\_email')); ?>"><?php echo esc\_attr(get\_option('admin\_email')); ?></a></strong></p> |
  |  | 24 | <p><strong>Vuukle is installed on your site and your admin email used is <a |
  |  | 25 | href="mailto:<?php echo esc\_attr( get\_option( 'admin\_email' ) ); ?>"><?php echo esc\_attr( get\_option( 'admin\_email' ) ); ?></a></strong></p> |
  | 26 | 26 | <p><strong>To see Vuukle Live instantly on your website please delete any plugin cache or super cache etc.</strong></p> |
  | 27 | 27 | <p><strong>For any questions please email us on <a href="mailto:support@vuukle.com">support@vuukle.com</a></strong></p> |
  | 28 | 28 | <h2>Please select the widgets</h2> |
  | 29 |  | <form id="vuukle-enable-function" action="<?php echo esc\_attr(~~admin\_url('admin-post.php')); ?>" method="POST~~"> |
  |  | 29 | <form id="vuukle-enable-function" action="<?php echo esc\_attr( admin\_url( 'admin-post.php' ) ); ?>" method="post"> |
  | 30 | 30 | <div class="form-check"> |
  | 31 | 31 | <label class="form-check-label"> |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/includes/free-comments-for-wordpress-vuukle-activate-modal.php?rev=2527980#L47) | […](/browser/free-comments-for-wordpress-vuukle/trunk/includes/free-comments-for-wordpress-vuukle-activate-modal.php?rev=2553337#L47) |  |
  | 47 | 47 | </div> |
  | 48 | 48 | <input type="hidden" name="action" id="action-field" value="vuukleEnableFunction"> |
  | 49 |  | <?php wp\_nonce\_field(); ?> |
  |  | 49 | <?php wp\_nonce\_field(); ?> |
  | 50 | 50 | </form> |
  | 51 | 51 | </div> |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/includes/free-comments-for-wordpress-vuukle-activate-modal.php?rev=2527980#L56) | […](/browser/free-comments-for-wordpress-vuukle/trunk/includes/free-comments-for-wordpress-vuukle-activate-modal.php?rev=2553337#L56) |  |
  | 56 | 56 | </div> |
  | 57 | 57 | <script> |
  | 58 |  | document.addEventListener("DOMContentLoaded", function() { |
  |  | 58 | document.addEventListener("DOMContentLoaded", function () { |
  | 59 | 59 | window.location = '#modal-activate'; |
  | 60 |  | document.querySelector('#vuukle-activate-button').addEventListener("click", function(event) { |
  |  | 60 | document.querySelector('#vuukle-activate-button').addEventListener("click", function (event) { |
  | 61 | 61 | document.querySelector('#vuukle-enable-function').submit(); |
  | 62 | 62 | }); |
  | 63 | 63 |  |
  | 64 |  | document.querySelector('.form-check-input-vuukle').addEventListener('change', function() { |
  |  | 64 | document.querySelector('.form-check-input-vuukle').addEventListener('change', function () { |
  | 65 | 65 | document.querySelector('#vuukle-activate-button').removeAttribute('disabled'); |
  | 66 | 66 | if (!document.querySelector('.checkbox1').checked && !document.querySelector('.checkbox2').checked && !document.querySelector('.checkbox3').checked) { |
  | 67 | 67 | document.querySelector('#vuukle-activate-button').attrgetAttribute('disabled', true); |
  | 68 | 68 | } |
  | 69 |  | if(document.querySelector('#export\_button3')){ |
  | 70 |  | if (document.querySelector('.checkbox3').checked) { |
  | 71 |  | document.querySelector('#export\_button3').style.visibility = "visible"; |
  | 72 |  | } else { |
  | 73 |  | document.querySelector('#export\_button3').style.visibility = "hidden"; |
  | 74 |  | }} |
  |  | 69 | if (document.querySelector('#export\_button3')) { |
  |  | 70 | if (document.querySelector('.checkbox3').checked) { |
  |  | 71 | document.querySelector('#export\_button3').style.visibility = "visible"; |
  |  | 72 | } else { |
  |  | 73 | document.querySelector('#export\_button3').style.visibility = "hidden"; |
  |  | 74 | } |
  |  | 75 | } |
  | 75 | 76 | }); |
  | 76 | 77 | }); |
  | 77 | 78 |  |
  | 78 |  | document.addEventListener("DOMContentLoaded", function() { |
  | 79 |  | document.querySelector('#export\_button3')?.addEventListener("click", function(event) { |
  |  | 79 | document.addEventListener("DOMContentLoaded", function () { |
  |  | 80 | document.querySelector('#export\_button3')?.addEventListener("click", function (event) { |
  | 80 | 81 | function loadXMLDoc() { |
  | 81 | 82 | var cache = false; |
  | 82 |  | var url = ~~"/wp-admin/admin-ajax.php"~~; |
  |  | 83 | var url = '<?=admin\_url( 'admin-ajax.php' )?>'; |
  | 83 | 84 | var xmlhttp = new XMLHttpRequest(); |
  | 84 | 85 | xmlhttp.open("GET", url, cache); |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/includes/free-comments-for-wordpress-vuukle-activate-modal.php?rev=2527980#L86) | […](/browser/free-comments-for-wordpress-vuukle/trunk/includes/free-comments-for-wordpress-vuukle-activate-modal.php?rev=2553337#L87) |  |
  | 86 | 87 | "action": "export\_comments\_plugin\_page", |
  | 87 | 88 | "export\_xml": 2, |
  | 88 |  | "\_wpnonce": "<?php echo esc\_attr(~~wp\_create\_nonce('export\_xml2')~~); ?>" |
  |  | 89 | "\_wpnonce": "<?php echo esc\_attr( wp\_create\_nonce( 'export\_xml2' ) ); ?>" |
  | 89 | 90 | }); |
  | 90 | 91 | if (xmlhttp.readyState == XMLHttpRequest.DONE) { // XMLHttpRequest.DONE == 4 |
* ## [free-comments-for-wordpress-vuukle/trunk/includes/free-comments-for-wordpress-vuukle-deactivate-modal.php](/changeset/2553337/free-comments-for-wordpress-vuukle/trunk/includes/free-comments-for-wordpress-vuukle-deactivate-modal.php "Show the changeset 2553337 restricted to free-comments-for-wordpress-vuukle/trunk/includes/free-comments-for-wordpress-vuukle-deactivate-modal.php")

  | [r2527980](/browser/free-comments-for-wordpress-vuukle/trunk/includes/free-comments-for-wordpress-vuukle-deactivate-modal.php?rev=2527980#L1 "Show revision 2527980 of this file in browser") | [r2553337](/browser/free-comments-for-wordpress-vuukle/trunk/includes/free-comments-for-wordpress-vuukle-deactivate-modal.php?rev=2553337#L1 "Show revision 2553337 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php |
  | 2 |  |  |
  | 3 | 2 | /\*\* |
  | 4 | 3 | \* The file that defines the core plugin class |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/includes/free-comments-for-wordpress-vuukle-deactivate-modal.php?rev=2527980#L24) | […](/browser/free-comments-for-wordpress-vuukle/trunk/includes/free-comments-for-wordpress-vuukle-deactivate-modal.php?rev=2553337#L23) |  |
  | 24 | 23 | <div class="modal-body"> |
  | 25 | 24 | <h2>If you have a moment, please let us know why you are deactivating:</h2> |
  | 26 |  | <form id="vuukle-answer-form" action="<?php echo esc\_url(~~admin\_url('admin-post.php')~~); ?>" method="POST"> |
  |  | 25 | <form id="vuukle-answer-form" action="<?php echo esc\_url( admin\_url( 'admin-post.php' ) ); ?>" method="POST"> |
  | 27 | 26 | <div class="form-check"> |
  | 28 | 27 | <label class="form-check-label"> |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/includes/free-comments-for-wordpress-vuukle-deactivate-modal.php?rev=2527980#L55) | […](/browser/free-comments-for-wordpress-vuukle/trunk/includes/free-comments-for-wordpress-vuukle-deactivate-modal.php?rev=2553337#L54) |  |
  | 55 | 54 | <input type="hidden" name="vuukle\_deactivate\_function" value="confirm"> |
  | 56 | 55 | <input type="hidden" name="action" value="vuukleDeactivateFunction"> |
  | 57 |  | <?php wp\_nonce\_field(); ?> |
  |  | 56 | <?php wp\_nonce\_field(); ?> |
  | 58 | 57 | </form> |
  | 59 | 58 | </div> |
  | 60 | 59 | <div class="modal-footer"> |
  | 61 | 60 | <button type="button" class="button button-secondary" id="vuukle-deactivate-button">Submit & Deactivate</button> |
  | 62 |  | <a href="#"><button type="button" class="button button-primary button-close">Close</button></a> |
  |  | 61 | <a href="#"> |
  |  | 62 | <button type="button" class="button button-primary button-close">Close</button> |
  |  | 63 | </a> |
  | 63 | 64 | </div> |
  | 64 | 65 | </div> |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/includes/free-comments-for-wordpress-vuukle-deactivate-modal.php?rev=2527980#L178) | […](/browser/free-comments-for-wordpress-vuukle/trunk/includes/free-comments-for-wordpress-vuukle-deactivate-modal.php?rev=2553337#L179) |  |
  | 178 | 179 | </style> |
  | 179 | 180 | <script> |
  | 180 |  | document.addEventListener("DOMContentLoaded", function() { |
  |  | 181 | document.addEventListener("DOMContentLoaded", function () { |
  | 181 | 182 | document.querySelector('.deactivate a[href\*="vuukle"]').setAttribute('href', '#modal-deactivate'); |
  | 182 | 183 | document.querySelector('.deactivate a[href\*="Vuukle"]')?.setAttribute('href', '#modal-deactivate'); |
  | 183 | 184 | document.querySelectorAll('.form-check input[type=radio]').forEach((element) => { |
  | 184 |  | element.addEventListener("click", function(event) { |
  |  | 185 | element.addEventListener("click", function (event) { |
  | 185 | 186 | if (event.currentTarget.value == 'Other') { |
  | 186 | 187 | document.querySelector('.other-answer-deactivate-vuukle').style.display = "block"; |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/includes/free-comments-for-wordpress-vuukle-deactivate-modal.php?rev=2527980#L190) | […](/browser/free-comments-for-wordpress-vuukle/trunk/includes/free-comments-for-wordpress-vuukle-deactivate-modal.php?rev=2553337#L191) |  |
  | 190 | 191 | }); |
  | 191 | 192 | }); |
  | 192 |  | document.querySelector('#vuukle-deactivate-button').addEventListener("click", function(event) { |
  |  | 193 | document.querySelector('#vuukle-deactivate-button').addEventListener("click", function (event) { |
  | 193 | 194 | var valid = 0; |
  | 194 | 195 | if (document.querySelector('.form-check-input-vuukle:checked').length <= 0) { |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/includes/free-comments-for-wordpress-vuukle-deactivate-modal.php?rev=2527980#L218) | […](/browser/free-comments-for-wordpress-vuukle/trunk/includes/free-comments-for-wordpress-vuukle-deactivate-modal.php?rev=2553337#L219) |  |
  | 218 | 219 | } |
  | 219 | 220 | } |
  | 220 |  | document.querySelector('.form-check-input-vuukle').addEventListener("click", function(event) { |
  |  | 221 | document.querySelector('.form-check-input-vuukle').addEventListener("click", function (event) { |
  | 221 | 222 | let nextSibling = document.querySelector('.form-check-input-vuukle').nextElementSibling; |
  | 222 | 223 | while (nextSibling) { |
* ## [free-comments-for-wordpress-vuukle/trunk/includes/vuukleplatform.php](/changeset/2553337/free-comments-for-wordpress-vuukle/trunk/includes/vuukleplatform.php "Show the changeset 2553337 restricted to free-comments-for-wordpress-vuukle/trunk/includes/vuukleplatform.php")

  | [r2533938](/browser/free-comments-for-wordpress-vuukle/trunk/includes/vuukleplatform.php?rev=2533938#L1 "Show revision 2533938 of this file in browser") | [r2553337](/browser/free-comments-for-wordpress-vuukle/trunk/includes/vuukleplatform.php?rev=2553337#L1 "Show revision 2553337 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php |
  | 2 |  |  |
  | 3 | 2 | /\*\* |
  | 4 | 3 | \* The file that defines the core plugin class |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/includes/vuukleplatform.php?rev=2533938#L15) | […](/browser/free-comments-for-wordpress-vuukle/trunk/includes/vuukleplatform.php?rev=2553337#L14) |  |
  | 15 | 14 | \* @since      1.0.0 |
  | 16 | 15 | \*/ |
  | 17 |  |  |
  | 18 | 16 | global $post; |
  | 19 | 17 | $custom\_text\_default = $vuukle->settings\_defaults['text']; |
  | 20 | 18 | $custom\_text         = $vuukle->settings['text']; |
  | 21 |  | $custom\_text         = ($custom\_text\_default === $custom\_text) ? '' : wp\_json\_encode($custom\_text); |
  | 22 |  |  |
  | 23 |  | $author\_info = array( |
  | 24 |  | 'name'      => get\_the\_author\_meta('display\_name', $post->post\_author), |
  | 25 |  | 'username'  => get\_the\_author\_meta('user\_login', $post->post\_author), |
  | 26 |  | 'email'     => get\_the\_author\_meta('user\_email', $post->post\_author), |
  |  | 19 | $custom\_text         = ( $custom\_text\_default === $custom\_text ) ? '' : wp\_json\_encode( $custom\_text ); |
  |  | 20 | $author\_info         = array( |
  |  | 21 | 'name'     => get\_the\_author\_meta( 'display\_name', $post->post\_author ), |
  |  | 22 | 'username' => get\_the\_author\_meta( 'user\_login', $post->post\_author ), |
  |  | 23 | 'email'    => get\_the\_author\_meta( 'user\_email', $post->post\_author ), |
  | 27 | 24 | ); |
  | 28 |  | $author\_info = wp\_json\_encode($author\_info); |
  | 29 |  |  |
  | 30 |  |  |
  | 31 |  |  |
  | 32 |  | $tags     = wp\_get\_post\_tags($post->ID); |
  | 33 |  | $arr\_tags = array(); |
  | 34 |  |  |
  | 35 |  | if (!empty($tags)) { |
  | 36 |  | $k = 1; |
  | 37 |  | foreach ($tags as $taged) { |
  | 38 |  | if ($k < 4) { |
  | 39 |  | $arr\_tags[] = $taged->name; |
  | 40 |  | } |
  | 41 |  | $k++; |
  | 42 |  | } |
  | 43 |  | $tags = implode(', ', $arr\_tags); |
  |  | 25 | $author\_info         = wp\_json\_encode( $author\_info ); |
  |  | 26 | $tags                = wp\_get\_post\_tags( $post->ID ); |
  |  | 27 | $arr\_tags            = array(); |
  |  | 28 | if ( ! empty( $tags ) ) { |
  |  | 29 | $k = 1; |
  |  | 30 | foreach ( $tags as $taged ) { |
  |  | 31 | if ( $k < 4 ) { |
  |  | 32 | $arr\_tags[] = $taged->name; |
  |  | 33 | } |
  |  | 34 | $k ++; |
  |  | 35 | } |
  |  | 36 | $tags = implode( ', ', $arr\_tags ); |
  | 44 | 37 | } else { |
  | 45 |  | $tags = ''; |
  |  | 38 | $tags = ''; |
  | 46 | 39 | } |
  | 47 |  |  |
  | 48 |  |  |
  | 49 |  | $author\_info = json\_decode($author\_info); |
  | 50 |  |  |
  | 51 |  | $protocol = get\_option('Vuukle'); |
  | 52 |  | if (!isset($protocol['recomendations\_protocol'])) { |
  | 53 |  | $protocol = $this->settings['recomendations\_protocol']; |
  |  | 40 | $author\_info      = json\_decode( $author\_info ); |
  |  | 41 | $protocol         = get\_option( 'Vuukle' ); |
  |  | 42 | $sso              = $vuukle->settings['sso']; |
  |  | 43 | $enabled\_comments = $vuukle->settings['enabled\_comments']; |
  |  | 44 | $emotes\_enabled   = $vuukle->settings['emote']; |
  |  | 45 | $size             = $vuukle->settings['size\_emote']; |
  |  | 46 | $first\_img        = $vuukle->settings['happy\_url']; |
  |  | 47 | $first\_name       = $vuukle->settings['happy\_text']; |
  |  | 48 | $second\_img       = $vuukle->settings['indifferent\_url']; |
  |  | 49 | $second\_name      = $vuukle->settings['indifferent\_text']; |
  |  | 50 | $third\_img        = $vuukle->settings['amused\_url']; |
  |  | 51 | $third\_name       = $vuukle->settings['amused\_text']; |
  |  | 52 | $fourth\_img       = $vuukle->settings['excited\_url']; |
  |  | 53 | $fourth\_name      = $vuukle->settings['excited\_text']; |
  |  | 54 | $fifth\_img        = $vuukle->settings['angry\_url']; |
  |  | 55 | $fifth\_name       = $vuukle->settings['angry\_text']; |
  |  | 56 | $sixth\_img        = $vuukle->settings['sad\_url']; |
  |  | 57 | $sixth\_name       = $vuukle->settings['sad\_text']; |
  |  | 58 | if ( $vuukle->settings['share'] ) { |
  |  | 59 | $powerbar\_enable = 'true'; |
  | 54 | 60 | } else { |
  | 55 |  | ~~$protocol = $protocol['recomendations\_protocol']~~; |
  |  | 61 | $powerbar\_enable = 'false'; |
  | 56 | 62 | } |
  | 57 |  |  |
  | 58 |  | $sso = $vuukle->settings['sso']; |
  | 59 |  |  |
  | 60 |  | $enabled\_comments = $vuukle->settings['enabled\_comments']; |
  | 61 |  |  |
  | 62 |  | $emotes\_enabled = $vuukle->settings['emote']; |
  | 63 |  |  |
  | 64 |  | $size = $vuukle->settings['size\_emote']; |
  | 65 |  |  |
  | 66 |  | $first\_img = $vuukle->settings['happy\_url']; |
  | 67 |  |  |
  | 68 |  | $first\_name = $vuukle->settings['happy\_text']; |
  | 69 |  |  |
  | 70 |  | $second\_img = $vuukle->settings['indifferent\_url']; |
  | 71 |  |  |
  | 72 |  | $second\_name = $vuukle->settings['indifferent\_text']; |
  | 73 |  |  |
  | 74 |  | $third\_img = $vuukle->settings['amused\_url']; |
  | 75 |  |  |
  | 76 |  | $third\_name = $vuukle->settings['amused\_text']; |
  | 77 |  |  |
  | 78 |  | $fourth\_img = $vuukle->settings['excited\_url']; |
  | 79 |  |  |
  | 80 |  | $fourth\_name = $vuukle->settings['excited\_text']; |
  | 81 |  |  |
  | 82 |  | $fifth\_img = $vuukle->settings['angry\_url']; |
  | 83 |  |  |
  | 84 |  | $fifth\_name = $vuukle->settings['angry\_text']; |
  | 85 |  |  |
  | 86 |  | $sixth\_img = $vuukle->settings['sad\_url']; |
  | 87 |  |  |
  | 88 |  | $sixth\_name = $vuukle->settings['sad\_text']; |
  | 89 |  |  |
  | 90 |  | if ($vuukle->settings['share']) { |
  | 91 |  | $powerbar\_enable = 'true'; |
  |  | 63 | $post\_post\_url = $post\_url; |
  |  | 64 | $post\_title    = get\_the\_title( $post->ID ); |
  |  | 65 | $post\_url      = home\_url(); |
  |  | 66 | if ( isset( get\_option( 'Vuukle' )['items\_powerbar'] ) ) { |
  |  | 67 | $items\_powerbar = get\_option( 'Vuukle' )['items\_powerbar']; |
  | 92 | 68 | } else { |
  | 93 |  | $powerbar\_enable = 'false'; |
  | 94 |  | } |
  | 95 |  |  |
  | 96 |  |  |
  | 97 |  | $endless\_mode        = $vuukle->settings['endless\_mode']; |
  | 98 |  | $twitter\_handle      = $vuukle->settings['twitter\_handle']; |
  | 99 |  | $post\_post\_url       = $post\_url; |
  | 100 |  | $post\_title          = get\_the\_title($post->ID); |
  | 101 |  | $post\_title\_name     = $post\_title; |
  | 102 |  | $post\_title\_name     = str\_replace("&#8217;", "'", $post\_title\_name); |
  | 103 |  | $post\_title\_name     = str\_replace("&#8216;", "'", $post\_title\_name); |
  | 104 |  | $post\_title\_name     = str\_replace('&"', "\"", $post\_title\_name); |
  | 105 |  | $post\_title\_name     = str\_replace("&#8220;", "\"", $post\_title\_name); |
  | 106 |  | $post\_title\_name     = str\_replace("#038;", "&", $post\_title\_name); |
  | 107 |  | $post\_title\_name     = str\_replace("#8221;", "\" ", $post\_title\_name); |
  | 108 |  | $post\_title\_name     = str\_replace("&&", "&", $post\_title\_name); |
  | 109 |  | $post\_title\_name     = str\_replace("@@", "@", $post\_title\_name); |
  | 110 |  | $twitter\_handle\_name = $twitter\_handle; |
  | 111 |  | $twitter\_handle\_name = str\_replace("@", "", $twitter\_handle\_name); |
  | 112 |  | $post\_url            = home\_url(); |
  | 113 |  |  |
  | 114 |  |  |
  | 115 |  |  |
  | 116 |  |  |
  | 117 |  |  |
  | 118 |  | if (isset(get\_option('Vuukle')['items\_powerbar'])) { |
  | 119 |  | $items\_powerbar = get\_option('Vuukle')['items\_powerbar']; |
  | 120 |  | } else { |
  | 121 |  | $items\_powerbar = $this->settings['items\_powerbar']; |
  |  | 69 | $items\_powerbar = $vuukle->settings\_defaults['items\_powerbar']; |
  | 122 | 70 | } |
  | 123 | 71 | //$items\_powerbar = get\_option( 'Vuukle' )['items\_powerbar']; |
  | 124 |  |  |
  | 125 | 72 | $emote\_enabled1 = $vuukle->settings['emote\_enabled1']; |
  | 126 | 73 | $emote\_enabled2 = $vuukle->settings['emote\_enabled2']; |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/includes/vuukleplatform.php?rev=2533938#L129) | […](/browser/free-comments-for-wordpress-vuukle/trunk/includes/vuukleplatform.php?rev=2553337#L76) |  |
  | 129 | 76 | $emote\_enabled5 = $vuukle->settings['emote\_enabled5']; |
  | 130 | 77 | $emote\_enabled6 = $vuukle->settings['emote\_enabled6']; |
  | 131 |  |  |
  | 132 |  | $emote\_enabled = array( |
  | 133 |  | $emote\_enabled1, |
  | 134 |  | $emote\_enabled2, |
  | 135 |  | $emote\_enabled3, |
  | 136 |  | $emote\_enabled4, |
  | 137 |  | $emote\_enabled5, |
  | 138 |  | $emote\_enabled6, |
  |  | 78 | $emote\_enabled  = array( |
  |  | 79 | $emote\_enabled1, |
  |  | 80 | $emote\_enabled2, |
  |  | 81 | $emote\_enabled3, |
  |  | 82 | $emote\_enabled4, |
  |  | 83 | $emote\_enabled5, |
  |  | 84 | $emote\_enabled6, |
  | 139 | 85 | ); |
  | 140 |  |  |
  | 141 | 86 | $emote\_disabled = array( |
  | 142 |  | 1 => 1, |
  | 143 |  | 2 => 2, |
  | 144 |  | 3 => 3, |
  | 145 |  | 4 => 4, |
  | 146 |  | 5 => 5, |
  | 147 |  | 6 => 6 |
  |  | 87 | 1 => 1, |
  |  | 88 | 2 => 2, |
  |  | 89 | 3 => 3, |
  |  | 90 | 4 => 4, |
  |  | 91 | 5 => 5, |
  |  | 92 | 6 => 6 |
  | 148 | 93 | ); |
  | 149 |  |  |
  | 150 |  | if (!empty($emote\_enabled)) { |
  | 151 |  | foreach ($emote\_enabled as $k => $v) { |
  | 152 |  | unset($emote\_disabled[$v]); |
  | 153 |  | } |
  |  | 94 | if ( ! empty( $emote\_enabled ) ) { |
  |  | 95 | foreach ( $emote\_enabled as $k => $v ) { |
  |  | 96 | unset( $emote\_disabled[ $v ] ); |
  |  | 97 | } |
  | 154 | 98 | } |
  | 155 |  |  |
  | 156 |  |  |
  | 157 | 99 | $lang = $vuukle->settings['lang']; |
  | 158 |  | if (~~$lang~~) { |
  | 159 |  | ~~$translated\_strings = file\_get\_contents(VUUKLE\_BASE\_PATH . 'languages/' . $lang . '.json'~~); |
  | 160 |  | ~~$translated         = json\_decode($translated\_strings~~); |
  | 161 |  | ~~$powerbar\_translite = json\_encode($translated->powerbar->customText, JSON\_UNESCAPED\_UNICODE~~); |
  | 162 |  | ~~$emotes\_translite   = json\_encode($translated->emotes->customText, JSON\_UNESCAPED\_UNICODE~~); |
  | 163 |  | ~~$comments\_translite = json\_encode($translated->comments->customText, JSON\_UNESCAPED\_UNICODE~~); |
  |  | 100 | if ( $lang ) { |
  |  | 101 | $translated\_strings = file\_get\_contents( VUUKLE\_BASE\_PATH . 'languages/' . $lang . '.json' ); |
  |  | 102 | $translated         = json\_decode( $translated\_strings ); |
  |  | 103 | $powerbar\_translite = json\_encode( $translated->powerbar->customText, JSON\_UNESCAPED\_UNICODE ); |
  |  | 104 | $emotes\_translite   = json\_encode( $translated->emotes->customText, JSON\_UNESCAPED\_UNICODE ); |
  |  | 105 | $comments\_translite = json\_encode( $translated->comments->customText, JSON\_UNESCAPED\_UNICODE ); |
  | 164 | 106 | } else { |
  | 165 |  | $powerbar\_translite = ''; |
  | 166 |  | $emotes\_translite   = ''; |
  | 167 |  | $comments\_translite = ''; |
  |  | 107 | $powerbar\_translite = ''; |
  |  | 108 | $emotes\_translite   = ''; |
  |  | 109 | $comments\_translite = ''; |
  | 168 | 110 | } ?> |
  | 169 | 111 |  |
  | 170 | 112 | <script data-cfasync="false"> |
  | 171 | 113 | var VUUKLE\_CONFIG = { |
  | 172 |  | apiKey: "<?php echo esc\_html($vuukle->settings['AppId']); ?>", |
  | 173 |  | articleId: "<?php echo esc\_html($post->ID); ?>", |
  | 174 |  | title: <?php echo "'" . esc\_html($post\_title) . "'"; ?>, |
  | 175 |  | tags: "<?php echo  esc\_html(str\_replace(['"', "'"], '', quotemeta(stripslashes($tags)))); ?>", |
  | 176 |  | author: "<?php echo esc\_html(str\_replace(['"', "'"], '', quotemeta(stripslashes($author\_info->name)))); ?>", |
  | 177 |  | <?php if ('1' === $endless\_mode) : ?> |
  | 178 |  | endlessMode: true, |
  | 179 |  | <?php endif; ?> |
  |  | 114 | apiKey: "<?php echo esc\_html( $vuukle->settings['AppId'] ); ?>", |
  |  | 115 | articleId: "<?php echo esc\_html( $post->ID ); ?>", |
  |  | 116 | title: <?php echo "'" . esc\_html( $post\_title ) . "'"; ?>, |
  |  | 117 | tags: "<?php echo esc\_html( str\_replace( [ '"', "'" ], '', quotemeta( stripslashes( $tags ) ) ) ); ?>", |
  |  | 118 | author: "<?php echo esc\_html( str\_replace( [ '"', "'" ], '', quotemeta( stripslashes( $author\_info->name ) ) ) ); ?>", |
  | 180 | 119 |  |
  | 181 |  | <?php if ('1' === $vuukle->settings['save\_comments']) : ?>wordpressSync: true, |
  | 182 |  | eventHandler: function(e) { |
  | 183 |  | console.log(e); |
  | 184 |  | if (e.eventType == 'wpSync') { |
  |  | 120 | <?php if ('1' === $vuukle->settings['save\_comments']) : ?>wordpressSync: true, |
  |  | 121 | eventHandler: function (e) { |
  |  | 122 | if (e.eventType === 'wpSync') { |
  | 185 | 123 | function loadXMLDoc() { |
  | 186 | 124 | var xmlhttp = new XMLHttpRequest(); |
  | 187 |  | var url = ~~"/wp-admin/admin-ajax.php"~~; |
  |  | 125 | var url = '<?=admin\_url( 'admin-ajax.php' )?>'; |
  | 188 | 126 | var cache = false; |
  | 189 | 127 | var formData = new FormData(); |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/includes/vuukleplatform.php?rev=2533938#L200) | […](/browser/free-comments-for-wordpress-vuukle/trunk/includes/vuukleplatform.php?rev=2553337#L138) |  |
  | 200 | 138 | formData.append("comment\_author\_IP", e.comment\_author\_IP); |
  | 201 | 139 | formData.append("comment\_agent", e.comment\_agent); |
  | 202 |  | formData.append("comment\_a~~gent~~", e.comment\_approved); |
  |  | 140 | formData.append("comment\_approved", e.comment\_approved); |
  | 203 | 141 | formData.append("comment\_date", e.comment\_date); |
  | 204 | 142 | formData.append("comment\_date\_gmt", e.comment\_date\_gmt); |
  | 205 | 143 | formData.append("comment\_karma", e.comment\_karma); |
  | 206 |  | formData.append("\_wpnonce", "<?php echo esc\_attr(~~wp\_create\_nonce()~~); ?>"); |
  |  | 144 | formData.append("\_wpnonce", "<?php echo esc\_attr( wp\_create\_nonce() ); ?>"); |
  | 207 | 145 | xmlhttp.open("POST", url, cache); |
  | 208 | 146 | xmlhttp.send(formData); |
  | 209 | 147 | } |
  |  | 148 |  |
  | 210 | 149 | loadXMLDoc(); |
  | 211 | 150 | } |
  | 212 | 151 | }, |
  | 213 |  | <?php endif; ?> |
  | 214 |  | <?php if ('none' !== $protocol) : ?> |
  | 215 |  | recommendationsProtocol: "<?php echo esc\_attr($protocol); ?>", |
  | 216 |  | <?php endif; ?> |
  | 217 |  | <?php if ($comments\_translite) : ?> |
  | 218 |  | comments: { |
  | 219 |  | customText: <?php echo esc\_html($comments\_translite); ?>, |
  |  | 152 | <?php endif; ?> |
  |  | 153 | <?php if ($comments\_translite) : ?> |
  |  | 154 | comments: { |
  |  | 155 | customText: <?php echo esc\_html( $comments\_translite ); ?>, |
  | 220 | 156 | }, <?php endif; ?> |
  | 221 |  | <?php if ($emotes\_enabled === 'false' || |
  | 222 |  | $size != $vuukle->settings\_defaults['size\_emote'] || |
  | 223 |  | $first\_img != $vuukle->settings\_defaults['happy\_url'] || |
  | 224 |  | $first\_name != $vuukle->settings\_defaults['happy\_text'] || |
  | 225 |  | $second\_img != $vuukle->settings\_defaults['indifferent\_url'] || |
  | 226 |  | $second\_name != $vuukle->settings\_defaults['indifferent\_text'] || |
  | 227 |  | $third\_img != $vuukle->settings\_defaults['amused\_url'] || |
  | 228 |  | $third\_name != $vuukle->settings\_defaults['amused\_text'] || |
  | 229 |  | $fourth\_img != $vuukle->settings\_defaults['excited\_url'] || |
  | 230 |  | $fourth\_name != $vuukle->settings\_defaults['excited\_text'] || |
  | 231 |  | $fifth\_img != $vuukle->settings\_defaults['angry\_url'] || |
  | 232 |  | $fifth\_name != $vuukle->settings\_defaults['angry\_text'] || |
  | 233 |  | $sixth\_img != $vuukle->settings\_defaults['sad\_url'] || |
  | 234 |  | $sixth\_name != $vuukle->settings\_defaults['sad\_text'] || |
  | 235 |  | ($emote\_enabled1 !== '1' || $emote\_enabled2 !== '2' || $emote\_enabled3 !== '3' || $emote\_enabled4 !== '4' || $emote\_enabled5 !== '5') || |
  | 236 |  | $emotes\_translite |
  | 237 |  |  |
  | 238 |  | ) : ?> |
  | 239 |  | emotes: { |
  | 240 |  | <?php if ($emotes\_enabled === 'false') : ?> |
  | 241 |  | enabled: <?php echo esc\_attr($emotes\_enabled); ?>, |
  | 242 |  | <?php endif; ?> |
  | 243 |  | <?php if ($size != $vuukle->settings\_defaults['size\_emote']) : ?> |
  | 244 |  | size: '<?php echo esc\_attr($size); ?>', // icons size |
  | 245 |  | <?php endif; ?> |
  | 246 |  | <?php if ($first\_img != $vuukle->settings\_defaults['happy\_url']) : ?> |
  | 247 |  | firstImg: '<?php echo esc\_attr($first\_img); ?>', |
  | 248 |  | <?php endif; ?> |
  | 249 |  | <?php if ($first\_name != $vuukle->settings\_defaults['happy\_text']) : ?> |
  | 250 |  | firstName: '<?php echo esc\_attr($first\_name); ?>', |
  | 251 |  | <?php endif; ?> |
  | 252 |  | <?php if ($second\_img != $vuukle->settings\_defaults['indifferent\_url']) : ?> |
  | 253 |  | secondImg: '<?php echo esc\_attr($second\_img); ?>', |
  | 254 |  | <?php endif; ?> |
  | 255 |  | <?php if ($second\_name != $vuukle->settings\_defaults['indifferent\_text']) : ?> |
  | 256 |  | secondName: '<?php echo esc\_attr($second\_name); ?>', |
  | 257 |  | <?php endif; ?> |
  | 258 |  | <?php if ($third\_img != $vuukle->settings\_defaults['amused\_url']) : ?> |
  | 259 |  | thirdImg: '<?php echo esc\_attr($third\_img); ?>', |
  | 260 |  | <?php endif; ?> |
  | 261 |  | <?php if ($third\_name != $vuukle->settings\_defaults['amused\_text']) : ?> |
  | 262 |  | thirdName: '<?php echo esc\_attr($third\_name); ?>', |
  | 263 |  | <?php endif; ?> |
  | 264 |  | <?php if ($fourth\_img != $vuukle->settings\_defaults['excited\_url']) : ?> |
  | 265 |  | fourthImg: '<?php echo esc\_attr($fourth\_img); ?>', |
  | 266 |  | <?php endif; ?> |
  | 267 |  | <?php if ($fourth\_name != $vuukle->settings\_defaults['excited\_text']) : ?> |
  | 268 |  | fourthName: '<?php echo esc\_attr($fourth\_name); ?>', |
  | 269 |  | <?php endif; ?> |
  | 270 |  | <?php if ($fifth\_img != $vuukle->settings\_defaults['angry\_url']) : ?> |
  | 271 |  | fifthImg: '<?php echo esc\_attr($fifth\_img); ?>', |
  | 272 |  | <?php endif; ?> |
  | 273 |  | <?php if ($fifth\_name != $vuukle->settings\_defaults['angry\_text']) : ?> |
  | 274 |  | fifthName: '<?php echo esc\_attr($fifth\_name); ?>', |
  | 275 |  | <?php endif; ?> |
  | 276 |  | <?php if ($sixth\_img != $vuukle->settings\_defaults['sad\_url']) : ?> |
  | 277 |  | sixthImg: '<?php echo esc\_attr($sixth\_img); ?>', |
  | 278 |  | <?php endif; ?> |
  | 279 |  | <?php if ($sixth\_name != $vuukle->settings\_defaults['sad\_text']) : ?> |
  | 280 |  | sixthName: '<?php echo esc\_attr($sixth\_name); ?>', |
  | 281 |  | <?php endif; ?> |
  | 282 |  | <?php if ($emote\_enabled1 !== '1' || $emote\_enabled2 !== '2' || $emote\_enabled3 !== '3' || $emote\_enabled4 !== '4' ||          $emote\_enabled5 !== '5')  : ?>                                                                                               disable: [<?php echo esc\_attr(implode(',', $emote\_disabled)); ?>], |
  | 283 |  | <?php endif; ?> |
  | 284 |  | <?php if ($emotes\_translite) : ?> |
  | 285 |  | customText: <?php echo esc\_html($emotes\_translite); ?>, |
  | 286 |  | <?php endif; ?> |
  | 287 |  | }, <?php endif; ?> |
  | 288 |  | powerbar: { |
  | 289 |  | <?php if ($powerbar\_enable != true) : ?> |
  | 290 |  | enabled: <?php echo esc\_attr($powerbar\_enable); ?>, |
  | 291 |  | <?php endif; ?> |
  | 292 |  | defaultEmote: 1, |
  | 293 |  | <?php if (!empty($items\_powerbar)) { ?> |
  | 294 |  | items: [ |
  | 295 |  | <?php foreach ($items\_powerbar as $item) : ?> '<?php echo esc\_attr($item); ?>', |
  | 296 |  | <?php endforeach; ?> |
  | 297 |  | ], |
  | 298 |  | <?php } else { ?> |
  | 299 |  | items: ['facebook'], |
  | 300 |  | <?php }; ?> |
  | 301 |  | <?php if ($twitter\_handle) :  ?> |
  | 302 |  | customUrls: { |
  | 303 |  | twitter: `http://twitter.com/share?text=<?php echo urlencode($post\_title\_name); ?>&url=<?php echo esc\_attr($post\_post\_url); ?>&via=<?php echo esc\_attr($twitter\_handle\_name); ?>`, |
  | 304 |  | }, |
  | 305 |  | <?php endif; ?> |
  | 306 |  | <?php if ($powerbar\_translite) : ?> |
  | 307 |  | customText: <?php echo esc\_html($powerbar\_translite); ?>, |
  | 308 |  | <?php endif; ?> |
  | 309 |  | }, |
  | 310 |  | }; |
  | 311 |  | (function() { |
  |  | 157 | <?php if ($emotes\_translite) : ?> |
  |  | 158 | emotes: { |
  |  | 159 | <?php if ($emotes\_enabled === 'false') : ?> |
  |  | 160 | enabled: <?php echo esc\_attr( $emotes\_enabled ); ?>, |
  |  | 161 | <?php endif; ?> |
  |  | 162 | <?php endif; ?> |
  |  | 163 | }; |
  |  | 164 | (function () { |
  | 312 | 165 | var d = document, |
  | 313 | 166 | s = d.createElement('script'); |
* ## [free-comments-for-wordpress-vuukle/trunk/public/class-free-comments-for-wordpress-vuukle-public.php](/changeset/2553337/free-comments-for-wordpress-vuukle/trunk/public/class-free-comments-for-wordpress-vuukle-public.php "Show the changeset 2553337 restricted to free-comments-for-wordpress-vuukle/trunk/public/class-free-comments-for-wordpress-vuukle-public.php")

  | [r2533938](/browser/free-comments-for-wordpress-vuukle/trunk/public/class-free-comments-for-wordpress-vuukle-public.php?rev=2533938#L1 "Show revision 2533938 of this file in browser") | [r2553337](/browser/free-comments-for-wordpress-vuukle/trunk/public/class-free-comments-for-wordpress-vuukle-public.php?rev=2553337#L1 "Show revision 2553337 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php |
  | 2 |  |  |
  | 3 | 2 | /\*\* |
  | 4 | 3 | \* The public-facing functionality of the plugin. |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/public/class-free-comments-for-wordpress-vuukle-public.php?rev=2533938#L26) | […](/browser/free-comments-for-wordpress-vuukle/trunk/public/class-free-comments-for-wordpress-vuukle-public.php?rev=2553337#L25) |  |
  | 26 | 25 | \* @link       https://vuukle.com |
  | 27 | 26 | \*/ |
  | 28 |  | class Free\_Comments\_For\_Wordpress\_Vuukle\_Public |
  | 29 |  | { |
  | 30 |  |  |
  | 31 |  | /\*\* |
  | 32 |  | \* The ID of this plugin. |
  | 33 |  | \* |
  | 34 |  | \* @since  1.0.0 |
  | 35 |  | \* @access private |
  | 36 |  | \* @var    string    $plugin\_name    The ID of this plugin. |
  | 37 |  | \*/ |
  | 38 |  | private $plugin\_name; |
  | 39 |  |  |
  | 40 |  | /\*\* |
  | 41 |  | \* The version of this plugin. |
  | 42 |  | \* |
  | 43 |  | \* @since  1.0.0 |
  | 44 |  | \* @access private |
  | 45 |  | \* @var    string    $version    The current version of this plugin. |
  | 46 |  | \*/ |
  | 47 |  | private $version; |
  | 48 |  | //    private $content\_check; |
  | 49 |  |  |
  | 50 |  | /\*\* |
  | 51 |  | \* Initialize the class and set its properties. |
  | 52 |  | \* |
  | 53 |  | \* @param string $plugin\_name The name of the plugin. |
  | 54 |  | \* @param string $version     The version of this plugin. |
  | 55 |  | \* |
  | 56 |  | \* @since 1.0.0 |
  | 57 |  | \*/ |
  | 58 |  | public function \_\_construct($plugin\_name, $version) |
  | 59 |  | { |
  | 60 |  | //        $this->content\_check = 0; |
  | 61 |  | $this->plugin\_name = $plugin\_name; |
  | 62 |  | $this->version = $version; |
  | 63 |  | $this->plugin\_path   = dirname($this->plugin\_name) . DIRECTORY\_SEPARATOR; |
  | 64 |  | $this->settings\_url  = 'options-general.php?page=' . dirname(plugin\_basename($this->plugin\_name)) . '/' . basename($this->plugin\_name); |
  | 65 |  | $this->settings\_name = 'Vuukle'; |
  | 66 |  | $this->settings      = get\_option($this->settings\_name); |
  | 67 |  | $comments\_status = get\_option('default\_comment\_status', false); |
  | 68 |  | $this->settings\_defaults = array( |
  | 69 |  | 'AppId'                       => '', |
  | 70 |  | 'sso'                         => 'false', |
  | 71 |  | 'div\_id'                      => '', |
  | 72 |  | 'div\_class'                   => '', |
  | 73 |  | 'div\_id\_powerbar'             => '', |
  | 74 |  | 'div\_id\_emotes'               => '', |
  | 75 |  | 'div\_id\_newsfeed'             => '', |
  | 76 |  | 'embed\_powerbar'              => '', |
  | 77 |  | 'div\_class\_powerbar'          => '', |
  | 78 |  | 'div\_class\_powerbar2'         => '', |
  | 79 |  | 'div\_class\_emotes'            => '', |
  | 80 |  | 'div\_class\_newsfeed'          => '', |
  | 81 |  | 'lang'                        => '', |
  | 82 |  | 'enabled\_comments'            => 'true', |
  | 83 |  | 'color'                       => '#108ee9', |
  | 84 |  | 'emote'                       => 'true', |
  | 85 |  | 'save\_comments'               => '0', |
  | 86 |  | 'save\_ads\_txt'                => ($this->settings['save\_ads\_txt'])?$this->settings['save\_ads\_txt']:'false', |
  | 87 |  | 'recomendations\_protocol'     => 'none', |
  | 88 |  | 'amount\_comments'             => 1000, |
  | 89 |  | 'embed\_comments'              => $comments\_status == "open" ? '1' : '2', |
  | 90 |  | 'embed\_emotes'                => '0', |
  | 91 |  | 'embed\_newsfeed'              => '0', |
  | 92 |  | 'embed\_powerbar'              => '0', |
  | 93 |  | 'mobile\_type'                 => 'vertical', |
  | 94 |  | 'desktop\_type'                => 'vertical', |
  | 95 |  | 'mobile\_type\_horizontal'      => 'horizontal', |
  | 96 |  | 'desktop\_type\_horizontal'     => 'horizontal', |
  | 97 |  | 'endless\_mode'                => '0', |
  | 98 |  | 'email\_for\_export\_comments'   => 'support@vuukle.com', |
  | 99 |  | 'start\_date\_comments'         => gmdate('Y-m-d', strtotime('-30 days')), |
  | 100 |  | 'end\_date\_comments'           => gmdate('Y-m-d'), |
  | 101 |  | 'og\_tags'                     => '0', |
  | 102 |  | 'text'                        => array( |
  | 103 |  | 'common'                  => array( |
  | 104 |  | //Name for user to enter |
  | 105 |  | 'name'         => 'Name', |
  | 106 |  | //Email for user to enter |
  | 107 |  | 'email'        => 'Email', |
  | 108 |  | //Place holder when user is not logged in |
  | 109 |  | 'me'           => 'Me', |
  | 110 |  | //Message as placeholder for user to write comment |
  | 111 |  | 'writeComment' => 'Write a comment', |
  | 112 |  | //Message to show when user attempts to login without entering name |
  | 113 |  | 'blankName'    => 'Name can not be blank', |
  | 114 |  | //Message to show when user attempts to login without entering email |
  | 115 |  | 'blankEmail'   => 'Email can not be blank', |
  | 116 |  | //Message to show when user attempts to comment without entering text |
  | 117 |  | 'blankComment' => 'Comment can not be blank', |
  | 118 |  | //Message to show when user write invalid email |
  | 119 |  | 'invalidEmail' => 'Invalid email, please try again.', |
  | 120 |  | //Message to show when user write invalid name |
  | 121 |  | 'invalidName'  => 'Name should not contain numbers, www., or special characters. Thank You.', |
  | 122 |  | //Message to show when user doesn't agree to terms and conditions |
  | 123 |  | 'checkTerms'   => 'Please Check the T&C box to post comments', |
  | 124 |  | ), |
  | 125 |  | 'messages'           => array( |
  | 126 |  | //Message to show when user write comment longer than the configured man comment length |
  | 127 |  | 'charlimits'              => 'The moderator has set a character limit up to', |
  | 128 |  | //Message to show when user tries to Up/Down votes more than once |
  | 129 |  | 'alreadyVoted'            => 'You have already Voted.', |
  | 130 |  | //Message to show when user tries to flag comment more than once |
  | 131 |  | 'alreadyReported'         => 'You have already reported this comment to moderator.', |
  | 132 |  | //Message to show when comments are closed |
  | 133 |  | 'commentsClosed'          => 'Comments are now closed.', |
  | 134 |  | //Message to show when user when the moderator closes the comments |
  | 135 |  | 'commentsClosedModerator' => 'Comments have been closed by the site moderator.', |
  | 136 |  | //Placeholder for writing comment |
  | 137 |  | 'writeComment'            => 'Please write a comment.', |
  | 138 |  | //Message to show when user tries to send the samer comment again |
  | 139 |  | 'alreadySubmitted'        => 'Your comment has been already submitted for this article.', |
  | 140 |  | //Message to show when user tries to comment without signing in |
  | 141 |  | 'loginFirst'              => 'Please enter your Name and Email or login to comment.', |
  | 142 |  | //Message to show when user is needed to sign in |
  | 143 |  | 'loginTry'                => 'Please login and try again.', |
  | 144 |  | //Message to show when user tries to vote without signing in |
  | 145 |  | 'loginToVote'             => 'Please sign in to vote.', |
  | 146 |  | //Message to show when user flags a comment |
  | 147 |  | 'flaggedMessage'          => 'Thanks, the moderator will be notified', |
  | 148 |  | //Message to show when user tries to flag without signing in |
  | 149 |  | 'loginToFlag'             => 'Please sign in to flag a comment.', |
  | 150 |  | //Message to show when error happens in submitting comment |
  | 151 |  | 'errorSubmitting'         => 'There was an error while saving your comment, please refresh the page and try again', |
  | 152 |  | //Message to show when user tries to login with invalid data |
  | 153 |  | 'invalidLogin'            => 'Invalid login, please log in again', |
  | 154 |  | //General error, contact us |
  | 155 |  | 'errorContactVuukle'      => 'error - please notify us at support@vuukle.com', |
  | 156 |  | //Message to show when user is flagged as spammer, and blocked from commenting |
  | 157 |  | 'spammerComment'          => 'Your comment is under moderation', |
  | 158 |  | //Message to show when user tries to comment with any words, like aaaaa etc... |
  | 159 |  | 'nonSenseComment'         => 'Please enter a more descriptive comment.', |
  | 160 |  | //Message to show when user comments and the moderation is on |
  | 161 |  | 'moderationMessage'       => 'Your comment is under moderation and will be approved by the site moderator. Thank you for your patience.', |
  | 162 |  | ), |
  | 163 |  | //These config deal with showing date in the comments, ie: 5 minutes ago, 2 days ago, etc... |
  | 164 |  | 'timeAgo'           => array( |
  | 165 |  | 'suffixAgo'     => 'ago', |
  | 166 |  | 'suffixFromNow' => 'from now', |
  | 167 |  | 'seconds'       => 'less than a minute', |
  | 168 |  | 'minute'        => 'about a minute', |
  | 169 |  | 'minutes'       => '%d minutes', |
  | 170 |  | 'hour'          => 'about an hour', |
  | 171 |  | 'hours'         => 'about %d hours', |
  | 172 |  | 'day'           => 'a day', |
  | 173 |  | 'days'          => '%d days', |
  | 174 |  | 'month'         => 'about a month', |
  | 175 |  | 'months'        => '%d months', |
  | 176 |  | 'year'          => 'about a year', |
  | 177 |  | 'years'         => '%d years', |
  | 178 |  | ), |
  | 179 |  | //Tooltips for sharing icons |
  | 180 |  | 'shareIcons'         => array( |
  | 181 |  | 'google'   => 'Share using Google Plus', |
  | 182 |  | 'facebook' => 'Share using Facebook', |
  | 183 |  | 'twitter'  => 'Share using Twitter', |
  | 184 |  | 'linkedin' => 'Share using Linkedin', |
  | 185 |  | ), |
  | 186 |  | //Tooltips for social logins |
  | 187 |  | 'login'              => array( |
  | 188 |  | 'google'   => 'Login using Google', |
  | 189 |  | 'facebook' => 'Login using Facebook', |
  | 190 |  | 'twitter'  => 'Login using Twitter', |
  | 191 |  | 'linkedin' => 'Login using Linkedin', |
  | 192 |  | ), |
  | 193 |  | 'commentText'        => array( |
  | 194 |  | //Text at header of comment section when there is no comments |
  | 195 |  | 'when0' => 'Leave a comment', |
  | 196 |  | //Text at header of comment section when there is 1 comment |
  | 197 |  | 'when1' => 'comment', |
  | 198 |  | //Text at header of comment section when there is more than comment |
  | 199 |  | 'whenX' => 'comments', |
  | 200 |  | ), |
  | 201 |  | //Rating section strings to show to user, includes ( Average rating 4.5 start from 123 users, etc... ) |
  | 202 |  | 'rating'             => array( |
  | 203 |  | 'header'     => 'Give your rating:', |
  | 204 |  | 'average'    => 'Average', |
  | 205 |  | 'starsFrom'  => 'start from', |
  | 206 |  | 'ratings'    => 'ratings', |
  | 207 |  | 'yourRating' => 'Your rating', |
  | 208 |  | 'stars'      => 'stars', |
  | 209 |  | ), |
  | 210 |  | //Texts for the buttons we have |
  | 211 |  | 'buttons'            => array( |
  | 212 |  | 'loadMore' => 'Load more', |
  | 213 |  | 'singin'   => 'Sign in', |
  | 214 |  | 'post'     => 'Post', |
  | 215 |  | ), |
  | 216 |  |  |
  | 217 |  | ), |
  | 218 |  | 'priority'                    => 300, |
  | 219 |  | 'size\_emote'                  => 70, |
  | 220 |  | 'share'                       => '1', |
  | 221 |  | 'enable\_h\_v'                  => 'no', |
  | 222 |  | 'share\_position'              => '1', |
  | 223 |  | 'share\_position2'             => '1', |
  | 224 |  | 'checkboxTextEnabled'         => false, |
  | 225 |  | 'share\_type'                  => 'horizontal', |
  | 226 |  | 'share\_type\_vertical'         => 'vertical', |
  | 227 |  | 'mobile\_type'                 => 'vertical', |
  | 228 |  | 'desktop\_type'                => 'vertical', |
  | 229 |  | 'mobile\_type\_horizontal'      => 'horizontal', |
  | 230 |  | 'desktop\_type\_horizontal'     => 'horizontal', |
  | 231 |  | 'share\_vertical\_styles'       => 'position:fixed;                                                             z-index: 10001;                                                            width: 60px;                                                            max-width: 60px;                                                           left: 10px;                                                             top: 160px;', |
  | 232 |  | 'emote\_widget\_width'          => '600', |
  | 233 |  | 'emote\_enabled1'              => '1', |
  | 234 |  | 'emote\_enabled2'              => '2', |
  | 235 |  | 'emote\_enabled3'              => '3', |
  | 236 |  | 'emote\_enabled4'              => '4', |
  | 237 |  | 'emote\_enabled5'              => '5', |
  | 238 |  | 'emote\_enabled6'              => '6', |
  | 239 |  | 'newsletter'                  => '0', |
  | 240 |  | 'newsfeed'                    => '0', |
  | 241 |  | 'newsletter\_position'         => '1', |
  | 242 |  | 'post\_exceptions'             => '', |
  | 243 |  | 'happy\_text'                  => 'Happy', |
  | 244 |  | 'happy\_url'                   => '', |
  | 245 |  | 'indifferent\_text'            => 'Unmoved', |
  | 246 |  | 'indifferent\_url'             => '', |
  | 247 |  | 'amused\_text'                 => 'Amused', |
  | 248 |  | 'amused\_url'                  => '', |
  | 249 |  | 'excited\_text'                => 'Excited', |
  | 250 |  | 'excited\_url'                 => '', |
  | 251 |  | 'angry\_text'                  => 'Angry', |
  | 252 |  | 'angry\_url'                   => '', |
  | 253 |  | 'sad\_text'                    => 'Sad', |
  | 254 |  | 'sad\_url'                     => '', |
  | 255 |  | 'category\_exceptions'         => '', |
  | 256 |  | 'post\_type\_exceptions'        => '', |
  | 257 |  | 'post\_type\_by\_url\_exceptions' => '', |
  | 258 |  | 'hide\_chat'                   => 'true', |
  | 259 |  | 'twitter\_handle'              => '', |
  | 260 |  | 'facebook\_url'                => '', |
  | 261 |  | 'twitter\_url'                 => '', |
  | 262 |  | 'linkedin\_url'                => '', |
  | 263 |  | 'items\_powerbar'              => array( |
  | 264 |  | 'facebook', |
  | 265 |  | 'twitter', |
  | 266 |  | 'whatsapp', |
  | 267 |  | 'linkedin', |
  | 268 |  | 'reddit', |
  | 269 |  | 'messenger', |
  | 270 |  | 'telegram', |
  | 271 |  | 'pinterest', |
  | 272 |  | 'flipboard', |
  | 273 |  | 'email', |
  | 274 |  | ), |
  | 275 |  | 'items\_powerbar\_no\_active'    => array( |
  | 276 |  | 'gab', |
  | 277 |  | 'parler' |
  | 278 |  | ), |
  | 279 |  | ); |
  | 280 |  |  |
  | 281 |  | if (!isset($this->settings['embed\_comments'])) { |
  | 282 |  | $this->settings = $this->settings\_defaults; |
  | 283 |  | } |
  | 284 |  |  |
  | 285 |  | if ('true' == $this->settings['enabled\_comments']) { |
  | 286 |  | if ('1' == $this->settings['embed\_comments']) { |
  | 287 |  | add\_filter('comments\_open', '\_\_return\_false', 20, 2); |
  | 288 |  | add\_filter('pings\_open', '\_\_return\_false', 20, 2); |
  | 289 |  | add\_filter('comments\_array', '\_\_return\_empty\_array', 10, 2); |
  | 290 |  | add\_filter('the\_content', array($this, 'vuukleCommentBox'), $this->settings['priority']); |
  | 291 |  | add\_filter('comments\_template', array($this, 'replaceWordpressComments'), 999); |
  | 292 |  | } |
  | 293 |  | if ('2' == $this->settings['embed\_comments']) { |
  | 294 |  | add\_filter('the\_content', array($this, 'vuukleCommentBox'), $this->settings['priority']); |
  | 295 |  | add\_filter('comments\_template', array($this, 'commentsTemplate'), 999); |
  | 296 |  | } |
  | 297 |  |  |
  | 298 |  | if ('3' == $this->settings['embed\_comments']) { |
  | 299 |  | if (!empty($this->settings['div\_class'])) { |
  | 300 |  | add\_filter('the\_content', array($this, 'vuukleCommentBox'), $this->settings['priority']); |
  | 301 |  | } |
  | 302 |  | add\_filter('comments\_template', array($this, 'commentsTemplate'), 999); |
  | 303 |  | } |
  | 304 |  |  |
  | 305 |  | if ('4' == $this->settings['embed\_comments']) { |
  | 306 |  | if (!empty($this->settings['div\_id'])) { |
  | 307 |  | add\_filter('the\_content', array($this, 'vuukleCommentBox'), $this->settings['priority']); |
  | 308 |  | } |
  | 309 |  | add\_filter('comments\_template', array($this, 'commentsTemplate'), 999); |
  | 310 |  | } |
  | 311 |  | } |
  | 312 |  | add\_action('wp\_footer', array($this, 'createVuuklePlatform')); |
  | 313 |  | if ('1' == $this->settings['endless\_mode']) { |
  | 314 |  | add\_filter('the\_content', array($this, 'addEndlessScript'), 20); |
  | 315 |  | add\_filter('the\_content', array($this, 'addEndlessBox'), 20); |
  | 316 |  | } |
  | 317 |  | if ($this->settings['emote'] && '2') { |
  | 318 |  | add\_filter('the\_content', array($this, 'addEmote'), 20); |
  | 319 |  | } |
  | 320 |  | if ('1' == $this->settings['newsfeed']) { |
  | 321 |  | add\_filter('the\_content', array($this, 'addNewsfeedBox'), 12); |
  | 322 |  | } |
  | 323 |  |  |
  | 324 |  |  |
  | 325 |  |  |
  | 326 |  |  |
  | 327 |  | //share bar mobile and desktop before Div & ID |
  | 328 |  |  |
  | 329 |  |  |
  | 330 |  | if ($this->settings['enable\_h\_v'] === 'yes') { |
  | 331 |  | if (wp\_is\_mobile()) { |
  | 332 |  | if ($this->settings['embed\_powerbar'] === '2' && $this->settings['div\_id\_powerbar'] != ''){ |
  | 333 |  | add\_filter('the\_content', array($this, 'addShareBefore'), 11);} |
  | 334 |  | else{  if ($this->settings['share']) { |
  | 335 |  | add\_filter('the\_content', array($this, 'addOnlyBefore'), 11); |
  | 336 |  | } |
  | 337 |  | if ($this->settings['share']) { |
  | 338 |  | add\_filter('the\_content', array($this, 'addOnlyAfter'), 11); |
  | 339 |  | }} |
  | 340 |  | } else { |
  | 341 |  | if ($this->settings['share']) { |
  | 342 |  | add\_filter('the\_content', array($this, 'addOnlyVertical'), 11); |
  | 343 |  | } |
  | 344 |  | } |
  | 345 |  | } else { |
  | 346 |  | if (($this->settings['embed\_powerbar'] === '1' && $this->settings['div\_class\_powerbar'] != '') || ($this->settings['embed\_powerbar'] === '2' && $this->settings['div\_id\_powerbar'] != '')) { |
  | 347 |  | if (wp\_is\_mobile()) { |
  | 348 |  | if ($this->settings['share'] && 'vertical' === $this->settings['mobile\_type'] && $this->settings['share\_type\_vertical'] === 'vertical') { |
  | 349 |  | add\_filter('the\_content', array($this, 'addShareBefore2'), 11); |
  | 350 |  | } |
  | 351 |  | if ($this->settings['share'] && 'horizontal' === $this->settings['mobile\_type\_horizontal'] && $this->settings['share\_type'] === 'horizontal') { |
  | 352 |  | add\_filter('the\_content', array($this, 'addShareBefore'), 11); |
  | 353 |  | } |
  | 354 |  | } else { |
  | 355 |  | if ($this->settings['share'] && 'vertical' === $this->settings['desktop\_type'] && $this->settings['share\_type\_vertical'] === 'vertical') { |
  | 356 |  | add\_filter('the\_content', array($this, 'addShareBefore2'), 11); |
  | 357 |  | } |
  | 358 |  |  |
  | 359 |  | if ($this->settings['share'] && 'horizontal' === $this->settings['desktop\_type\_horizontal'] && $this->settings['share\_type'] === 'horizontal') { |
  | 360 |  | add\_filter('the\_content', array($this, 'addShareBefore'), 11); |
  | 361 |  | } |
  | 362 |  | } |
  | 363 |  | } else { |
  | 364 |  | $isPut = false; |
  | 365 |  |  |
  | 366 |  | if (wp\_is\_mobile()) { |
  | 367 |  | if ($this->settings['share'] && 'vertical' === $this->settings['mobile\_type'] && $this->settings['share\_type\_vertical'] === 'vertical') { |
  | 368 |  | $isPut = true; |
  | 369 |  | add\_filter('the\_content', array($this, 'addShareBefore2'), 11); |
  | 370 |  | } |
  | 371 |  | if ($this->settings['share'] && 'horizontal' === $this->settings['mobile\_type\_horizontal'] && $this->settings['share\_type'] === 'horizontal' && $this->settings['share\_position2'] === '1') { |
  | 372 |  | add\_filter('the\_content', array($this, 'addShareBefore'), 11); |
  | 373 |  | } |
  | 374 |  | } else { |
  | 375 |  | if ($this->settings['share'] && 'vertical' === $this->settings['desktop\_type'] && $this->settings['share\_type\_vertical'] === 'vertical' && !$isPut) { |
  | 376 |  | add\_filter('the\_content', array($this, 'addShareBefore2'), 11); |
  | 377 |  | } |
  | 378 |  |  |
  | 379 |  | if ($this->settings['share'] && 'horizontal' === $this->settings['desktop\_type\_horizontal'] && $this->settings['share\_type'] === 'horizontal' && $this->settings['share\_position2'] === '1') { |
  | 380 |  | add\_filter('the\_content', array($this, 'addShareBefore'), 11); |
  | 381 |  | } |
  | 382 |  | } |
  | 383 |  |  |
  | 384 |  |  |
  | 385 |  | if (wp\_is\_mobile()) { |
  | 386 |  | if ($this->settings['share'] && 'vertical' === $this->settings['mobile\_type'] && $this->settings['share\_type\_vertical'] === 'vertical' && !$isPut) { |
  | 387 |  | add\_filter('the\_content', array($this, 'addShareAfter2'), 11); |
  | 388 |  | } |
  | 389 |  | if ($this->settings['share'] && 'horizontal' === $this->settings['mobile\_type\_horizontal'] && $this->settings['share\_type'] === 'horizontal' && $this->settings['share\_position'] === '1') { |
  | 390 |  | add\_filter('the\_content', array($this, 'addShareAfter'), 11); |
  | 391 |  | } |
  | 392 |  | } else { |
  | 393 |  | if ($this->settings['share'] && 'vertical' === $this->settings['desktop\_type'] && $this->settings['share\_type\_vertical'] === 'vertical' && $isPut) { |
  | 394 |  | add\_filter('the\_content', array($this, 'addShareAfter2'), 11); |
  | 395 |  | } |
  | 396 |  |  |
  | 397 |  | if ($this->settings['share'] && 'horizontal' === $this->settings['desktop\_type\_horizontal'] && $this->settings['share\_type'] === 'horizontal' && $this->settings['share\_position'] === '1') { |
  | 398 |  | add\_filter('the\_content', array($this, 'addShareAfter'), 11); |
  | 399 |  | } |
  | 400 |  | } |
  | 401 |  | } |
  | 402 |  | } |
  | 403 |  |  |
  | 404 |  |  |
  | 405 |  | // newsletter bar |
  | 406 |  | if ($this->settings['newsletter']) { |
  | 407 |  | add\_filter('the\_content', array($this, 'addNewsletter')); |
  | 408 |  | } |
  | 409 |  | if ('1' == $this->settings['og\_tags']) { |
  | 410 |  | add\_action('wp\_head',  array($this, 'ogTags')); |
  | 411 |  | } |
  | 412 |  | if (isset($this->settings['enable\_seo']) && $this->settings['enable\_seo'] != 'off') { |
  | 413 |  | add\_filter('the\_content', array($this, 'addPostScript'), 20); |
  | 414 |  | } |
  | 415 |  | if (isset($this->settings['non\_article\_pages']) && $this->settings['non\_article\_pages'] != 'off') { |
  | 416 |  | add\_action("wp\_footer", array($this, 'track\_page\_view')); |
  | 417 |  | } |
  | 418 |  | include VUUKLE\_INCLUDES\_PATH . '/export-comments.php'; |
  | 419 |  | } |
  | 420 |  |  |
  | 421 |  | /\*\* |
  | 422 |  | \* Register the stylesheets for the public-facing side of the site. |
  | 423 |  | \* |
  | 424 |  | \* @since  1.0.0 |
  | 425 |  | \* @return void |
  | 426 |  | \*/ |
  | 427 |  | public function enqueueStyles() |
  | 428 |  | { |
  | 429 |  |  |
  | 430 |  | /\*\* |
  | 431 |  | \* This function is provided for demonstration purposes only. |
  | 432 |  | \* |
  | 433 |  | \* An instance of this class should be passed to the run() function |
  | 434 |  | \* defined in Free\_Comments\_For\_Wordpress\_Vuukle\_Loader as all of the hooks are defined |
  | 435 |  | \* in that particular class. |
  | 436 |  | \* |
  | 437 |  | \* The Free\_Comments\_For\_Wordpress\_Vuukle\_Loader will then create the relationship |
  | 438 |  | \* between the defined hooks and the functions defined in this |
  | 439 |  | \* class. |
  | 440 |  | \*/ |
  | 441 |  | } |
  | 442 |  |  |
  | 443 |  | /\*\* |
  | 444 |  | \* Register the JavaScript for the public-facing side of the site. |
  | 445 |  | \* |
  | 446 |  | \* @since  1.0.0 |
  | 447 |  | \* @return void |
  | 448 |  | \*/ |
  | 449 |  | public function enqueueScripts() |
  | 450 |  | { |
  | 451 |  |  |
  | 452 |  | /\*\* |
  | 453 |  | \* This function is provided for demonstration purposes only. |
  | 454 |  | \* |
  | 455 |  | \* An instance of this class should be passed to the run() function |
  | 456 |  | \* defined in Free\_Comments\_For\_Wordpress\_Vuukle\_Loader as all of the hooks are defined |
  | 457 |  | \* in that particular class. |
  | 458 |  | \* |
  | 459 |  | \* The Free\_Comments\_For\_Wordpress\_Vuukle\_Loader will then create the relationship |
  | 460 |  | \* between the defined hooks and the functions defined in this |
  | 461 |  | \* class. |
  | 462 |  | \*/ |
  | 463 |  | } |
  | 464 |  |  |
  | 465 |  |  |
  | 466 |  | /\*\* |
  | 467 |  | \* This function generates shortcode. |
  | 468 |  | \* |
  | 469 |  | \* @since  1.0.0. |
  | 470 |  | \* @return void |
  | 471 |  | \*/ |
  | 472 |  | public function generateShortcode() |
  | 473 |  | { |
  | 474 |  |  |
  | 475 |  | add\_shortcode('vuukle', array($this, 'shortCodeVuukle')); |
  | 476 |  | } |
  | 477 |  |  |
  | 478 |  | /\*\* |
  | 479 |  | \* This function creates a block for shortcode. |
  | 480 |  | \* |
  | 481 |  | \* @param string $attr    this is attributes |
  | 482 |  | \* @param string $content this is content |
  | 483 |  | \* |
  | 484 |  | \* @since  1.0.0. |
  | 485 |  | \* @return string |
  | 486 |  | \*/ |
  | 487 |  | public function shortCodeVuukle($attr, $content) |
  | 488 |  | { |
  | 489 |  |  |
  | 490 |  | return '<div id="vuukle-comments"></div>'; |
  | 491 |  | } |
  | 492 |  |  |
  | 493 |  | /\*\* |
  | 494 |  | \* This function saves comments to DB. |
  | 495 |  | \* |
  | 496 |  | \* @since  1.0.0. |
  | 497 |  | \* @return void |
  | 498 |  | \*/ |
  | 499 |  | public function saveCommentToDb() |
  | 500 |  | { |
  | 501 |  |  |
  | 502 |  | if (isset($\_POST['\_wpnonce']) && wp\_verify\_nonce(sanitize\_key($\_POST['\_wpnonce']))) { // Input var okay |
  | 503 |  | global $wpdb; |
  | 504 |  | $post = $\_POST; // Input var okay |
  | 505 |  | $data = array( |
  | 506 |  | 'comment\_post\_ID'      => $post['comment\_post\_ID'], |
  | 507 |  | 'comment\_author'       => $post['comment\_author'], |
  | 508 |  | 'comment\_author\_email' => $post['comment\_author\_email'], |
  | 509 |  | 'comment\_author\_url'   => $post['comment\_author\_url'], |
  | 510 |  | 'comment\_content'      => $post['comment\_content'], |
  | 511 |  | 'comment\_type'         => $post['comment\_type'], |
  | 512 |  | 'comment\_parent'       => $post['comment\_parent\_ID'], |
  | 513 |  | 'user\_id'              => $post['user\_id'], |
  | 514 |  | 'comment\_author\_IP'    => $post['comment\_author\_IP'], |
  | 515 |  | 'comment\_agent'        => $post['comment\_agent'], |
  | 516 |  | 'comment\_date'         => gmdate('Y-m-d H:i:s', strtotime($post['comment\_date'])), |
  | 517 |  | 'comment\_date\_gmt'     => gmdate('Y-m-d H:i:s', strtotime($post['comment\_date'])), |
  | 518 |  | 'comment\_approved'     => $post['comment\_approved'], |
  | 519 |  | 'comment\_karma'        => $post['comment\_karma'], |
  | 520 |  | ); |
  | 521 |  | $comment\_ID = wp\_insert\_comment($data); |
  | 522 |  | $vuukle\_comment\_ID = (int) $post['comment\_ID']; |
  | 523 |  | $wpdb->query($wpdb->prepare("UPDATE" . $wpdb->prefix . "comments SET comment\_ID=%s WHERE comment\_ID=%s", $vuukle\_comment\_ID, $comment\_ID)); |
  | 524 |  | //$wpdb->query("UPDATE ".$wpdb->prefix."comments SET comment\_ID = $vuukle\_comment\_ID WHERE comment\_ID = '$comment\_ID'"); |
  | 525 |  |  |
  | 526 |  | exit; |
  | 527 |  | } |
  | 528 |  | } |
  | 529 |  |  |
  | 530 |  | /\*\* |
  | 531 |  | \* This function adds DNS. |
  | 532 |  | \* |
  | 533 |  | \* @since  1.0.0. |
  | 534 |  | \* @return void |
  | 535 |  | \*/ |
  | 536 |  | public function addDns() |
  | 537 |  | { |
  | 538 |  | ?> |
  | 539 |  | <link rel="preload" href="https://securepubads.g.doubleclick.net/tag/js/gpt.js" as="script"> |
  |  | 27 | class Free\_Comments\_For\_Wordpress\_Vuukle\_Public { |
  |  | 28 |  |
  |  | 29 | /\*\* |
  |  | 30 | \* The ID of this plugin. |
  |  | 31 | \* |
  |  | 32 | \* @since  1.0.0 |
  |  | 33 | \* @access private |
  |  | 34 | \* @var    string $plugin\_name The ID of this plugin. |
  |  | 35 | \*/ |
  |  | 36 | private $plugin\_name; |
  |  | 37 |  |
  |  | 38 | /\*\* |
  |  | 39 | \* The version of this plugin. |
  |  | 40 | \* |
  |  | 41 | \* @since  1.0.0 |
  |  | 42 | \* @access private |
  |  | 43 | \* @var    string $version The current version of this plugin. |
  |  | 44 | \*/ |
  |  | 45 | private $version; |
  |  | 46 | //    private $content\_check; |
  |  | 47 |  |
  |  | 48 | /\*\* |
  |  | 49 | \* Initialize the class and set its properties. |
  |  | 50 | \* |
  |  | 51 | \* @param   string  $plugin\_name  The name of the plugin. |
  |  | 52 | \* @param   string  $version      The version of this plugin. |
  |  | 53 | \* |
  |  | 54 | \* @since 1.0.0 |
  |  | 55 | \*/ |
  |  | 56 | public function \_\_construct( $plugin\_name, $version ) { |
  |  | 57 | //        $this->content\_check = 0; |
  |  | 58 | $this->plugin\_name       = $plugin\_name; |
  |  | 59 | $this->version           = $version; |
  |  | 60 | $this->plugin\_path       = dirname( $this->plugin\_name ) . DIRECTORY\_SEPARATOR; |
  |  | 61 | $this->settings\_url      = 'options-general.php?page=' . dirname( plugin\_basename( $this->plugin\_name ) ) . '/' . basename( $this->plugin\_name ); |
  |  | 62 | $this->settings\_name     = 'Vuukle'; |
  |  | 63 | $this->settings          = get\_option( $this->settings\_name ); |
  |  | 64 | $comments\_status         = get\_option( 'default\_comment\_status', false ); |
  |  | 65 | $this->settings\_defaults = array( |
  |  | 66 | 'AppId'                       => '', |
  |  | 67 | 'sso'                         => 'false', |
  |  | 68 | 'div\_id'                      => '', |
  |  | 69 | 'div\_class'                   => '', |
  |  | 70 | 'div\_id\_powerbar'             => '', |
  |  | 71 | 'div\_id\_emotes'               => '', |
  |  | 72 | 'div\_class\_powerbar'          => '', |
  |  | 73 | 'div\_class\_powerbar2'         => '', |
  |  | 74 | 'div\_class\_emotes'            => '', |
  |  | 75 | 'lang'                        => '', |
  |  | 76 | 'enabled\_comments'            => 'true', |
  |  | 77 | 'color'                       => '#108ee9', |
  |  | 78 | 'emote'                       => 'true', |
  |  | 79 | 'save\_comments'               => '0', |
  |  | 80 | 'save\_ads\_txt'                => isset( $this->settings['save\_ads\_txt'] ) ? $this->settings['save\_ads\_txt'] : 'false', |
  |  | 81 | 'amount\_comments'             => 1000, |
  |  | 82 | 'embed\_comments'              => $comments\_status == "open" ? '1' : '2', |
  |  | 83 | 'embed\_emotes'                => '0', |
  |  | 84 | 'embed\_powerbar'              => '0', |
  |  | 85 | 'mobile\_type'                 => 'vertical', |
  |  | 86 | 'desktop\_type'                => 'vertical', |
  |  | 87 | 'mobile\_type\_horizontal'      => 'horizontal', |
  |  | 88 | 'desktop\_type\_horizontal'     => 'horizontal', |
  |  | 89 | 'email\_for\_export\_comments'   => 'support@vuukle.com', |
  |  | 90 | 'start\_date\_comments'         => gmdate( 'Y-m-d', strtotime( '-30 days' ) ), |
  |  | 91 | 'end\_date\_comments'           => gmdate( 'Y-m-d' ), |
  |  | 92 | 'text'                        => array( |
  |  | 93 | 'common'      => array( |
  |  | 94 | //Name for user to enter |
  |  | 95 | 'name'         => 'Name', |
  |  | 96 | //Email for user to enter |
  |  | 97 | 'email'        => 'Email', |
  |  | 98 | //Place holder when user is not logged in |
  |  | 99 | 'me'           => 'Me', |
  |  | 100 | //Message as placeholder for user to write comment |
  |  | 101 | 'writeComment' => 'Write a comment', |
  |  | 102 | //Message to show when user attempts to login without entering name |
  |  | 103 | 'blankName'    => 'Name can not be blank', |
  |  | 104 | //Message to show when user attempts to login without entering email |
  |  | 105 | 'blankEmail'   => 'Email can not be blank', |
  |  | 106 | //Message to show when user attempts to comment without entering text |
  |  | 107 | 'blankComment' => 'Comment can not be blank', |
  |  | 108 | //Message to show when user write invalid email |
  |  | 109 | 'invalidEmail' => 'Invalid email, please try again.', |
  |  | 110 | //Message to show when user write invalid name |
  |  | 111 | 'invalidName'  => 'Name should not contain numbers, www., or special characters. Thank You.', |
  |  | 112 | //Message to show when user doesn't agree to terms and conditions |
  |  | 113 | 'checkTerms'   => 'Please Check the T&C box to post comments', |
  |  | 114 | ), |
  |  | 115 | 'messages'    => array( |
  |  | 116 | //Message to show when user write comment longer than the configured man comment length |
  |  | 117 | 'charlimits'              => 'The moderator has set a character limit up to', |
  |  | 118 | //Message to show when user tries to Up/Down votes more than once |
  |  | 119 | 'alreadyVoted'            => 'You have already Voted.', |
  |  | 120 | //Message to show when user tries to flag comment more than once |
  |  | 121 | 'alreadyReported'         => 'You have already reported this comment to moderator.', |
  |  | 122 | //Message to show when comments are closed |
  |  | 123 | 'commentsClosed'          => 'Comments are now closed.', |
  |  | 124 | //Message to show when user when the moderator closes the comments |
  |  | 125 | 'commentsClosedModerator' => 'Comments have been closed by the site moderator.', |
  |  | 126 | //Placeholder for writing comment |
  |  | 127 | 'writeComment'            => 'Please write a comment.', |
  |  | 128 | //Message to show when user tries to send the samer comment again |
  |  | 129 | 'alreadySubmitted'        => 'Your comment has been already submitted for this article.', |
  |  | 130 | //Message to show when user tries to comment without signing in |
  |  | 131 | 'loginFirst'              => 'Please enter your Name and Email or login to comment.', |
  |  | 132 | //Message to show when user is needed to sign in |
  |  | 133 | 'loginTry'                => 'Please login and try again.', |
  |  | 134 | //Message to show when user tries to vote without signing in |
  |  | 135 | 'loginToVote'             => 'Please sign in to vote.', |
  |  | 136 | //Message to show when user flags a comment |
  |  | 137 | 'flaggedMessage'          => 'Thanks, the moderator will be notified', |
  |  | 138 | //Message to show when user tries to flag without signing in |
  |  | 139 | 'loginToFlag'             => 'Please sign in to flag a comment.', |
  |  | 140 | //Message to show when error happens in submitting comment |
  |  | 141 | 'errorSubmitting'         => 'There was an error while saving your comment, please refresh the page and try again', |
  |  | 142 | //Message to show when user tries to login with invalid data |
  |  | 143 | 'invalidLogin'            => 'Invalid login, please log in again', |
  |  | 144 | //General error, contact us |
  |  | 145 | 'errorContactVuukle'      => 'error - please notify us at support@vuukle.com', |
  |  | 146 | //Message to show when user is flagged as spammer, and blocked from commenting |
  |  | 147 | 'spammerComment'          => 'Your comment is under moderation', |
  |  | 148 | //Message to show when user tries to comment with any words, like aaaaa etc... |
  |  | 149 | 'nonSenseComment'         => 'Please enter a more descriptive comment.', |
  |  | 150 | //Message to show when user comments and the moderation is on |
  |  | 151 | 'moderationMessage'       => 'Your comment is under moderation and will be approved by the site moderator. Thank you for your patience.', |
  |  | 152 | ), |
  |  | 153 | //These config deal with showing date in the comments, ie: 5 minutes ago, 2 days ago, etc... |
  |  | 154 | 'timeAgo'     => array( |
  |  | 155 | 'suffixAgo'     => 'ago', |
  |  | 156 | 'suffixFromNow' => 'from now', |
  |  | 157 | 'seconds'       => 'less than a minute', |
  |  | 158 | 'minute'        => 'about a minute', |
  |  | 159 | 'minutes'       => '%d minutes', |
  |  | 160 | 'hour'          => 'about an hour', |
  |  | 161 | 'hours'         => 'about %d hours', |
  |  | 162 | 'day'           => 'a day', |
  |  | 163 | 'days'          => '%d days', |
  |  | 164 | 'month'         => 'about a month', |
  |  | 165 | 'months'        => '%d months', |
  |  | 166 | 'year'          => 'about a year', |
  |  | 167 | 'years'         => '%d years', |
  |  | 168 | ), |
  |  | 169 | //Tooltips for social logins |
  |  | 170 | 'login'       => array( |
  |  | 171 | 'google'   => 'Login using Google', |
  |  | 172 | 'facebook' => 'Login using Facebook', |
  |  | 173 | 'twitter'  => 'Login using Twitter', |
  |  | 174 | 'linkedin' => 'Login using Linkedin', |
  |  | 175 | ), |
  |  | 176 | 'commentText' => array( |
  |  | 177 | //Text at header of comment section when there is no comments |
  |  | 178 | 'when0' => 'Leave a comment', |
  |  | 179 | //Text at header of comment section when there is 1 comment |
  |  | 180 | 'when1' => 'comment', |
  |  | 181 | //Text at header of comment section when there is more than comment |
  |  | 182 | 'whenX' => 'comments', |
  |  | 183 | ), |
  |  | 184 | //Rating section strings to show to user, includes ( Average rating 4.5 start from 123 users, etc... ) |
  |  | 185 | 'rating'      => array( |
  |  | 186 | 'header'     => 'Give your rating:', |
  |  | 187 | 'average'    => 'Average', |
  |  | 188 | 'starsFrom'  => 'start from', |
  |  | 189 | 'ratings'    => 'ratings', |
  |  | 190 | 'yourRating' => 'Your rating', |
  |  | 191 | 'stars'      => 'stars', |
  |  | 192 | ), |
  |  | 193 | //Texts for the buttons we have |
  |  | 194 | 'buttons'     => array( |
  |  | 195 | 'loadMore' => 'Load more', |
  |  | 196 | 'singin'   => 'Sign in', |
  |  | 197 | 'post'     => 'Post', |
  |  | 198 | ), |
  |  | 199 | ), |
  |  | 200 | 'priority'                    => 300, |
  |  | 201 | 'size\_emote'                  => 70, |
  |  | 202 | 'share'                       => '1', |
  |  | 203 | 'enable\_h\_v'                  => 'no', |
  |  | 204 | 'share\_position'              => '1', |
  |  | 205 | 'share\_position2'             => '1', |
  |  | 206 | 'checkboxTextEnabled'         => false, |
  |  | 207 | 'share\_type'                  => 'horizontal', |
  |  | 208 | 'share\_type\_vertical'         => 'vertical', |
  |  | 209 | 'emote\_widget\_width'          => '600', |
  |  | 210 | 'post\_exceptions'             => '', |
  |  | 211 | 'category\_exceptions'         => '', |
  |  | 212 | 'post\_type\_exceptions'        => '', |
  |  | 213 | 'post\_type\_by\_url\_exceptions' => '', |
  |  | 214 | 'hide\_chat'                   => 'true', |
  |  | 215 | 'facebook\_url'                => '', |
  |  | 216 | 'twitter\_url'                 => '', |
  |  | 217 | 'linkedin\_url'                => '', |
  |  | 218 | ); |
  |  | 219 | if ( ! isset( $this->settings['embed\_comments'] ) ) { |
  |  | 220 | $this->settings = $this->settings\_defaults; |
  |  | 221 | } |
  |  | 222 | $this->settings = get\_option( $this->settings\_name ); |
  |  | 223 | if ( is\_array( $this->settings ) ) { |
  |  | 224 | $settings       = array\_merge( $this->settings\_defaults, $this->settings ); |
  |  | 225 | $settings       = array\_intersect\_key( $settings, $this->settings\_defaults ); |
  |  | 226 | $this->settings = $settings; |
  |  | 227 | } |
  |  | 228 | if ( 'true' == $this->settings['enabled\_comments'] ) { |
  |  | 229 | if ( '1' == $this->settings['embed\_comments'] ) { |
  |  | 230 | add\_filter( 'comments\_open', '\_\_return\_false', 20, 2 ); |
  |  | 231 | add\_filter( 'pings\_open', '\_\_return\_false', 20, 2 ); |
  |  | 232 | add\_filter( 'comments\_array', '\_\_return\_empty\_array', 10, 2 ); |
  |  | 233 | add\_filter( 'the\_content', array( $this, 'vuukleCommentBox' ), $this->settings['priority'] ); |
  |  | 234 | add\_filter( 'comments\_template', array( $this, 'replaceWordpressComments' ), 999 ); |
  |  | 235 | } |
  |  | 236 | if ( '2' == $this->settings['embed\_comments'] ) { |
  |  | 237 | add\_filter( 'the\_content', array( $this, 'vuukleCommentBox' ), $this->settings['priority'] ); |
  |  | 238 | add\_filter( 'comments\_template', array( $this, 'commentsTemplate' ), 999 ); |
  |  | 239 | } |
  |  | 240 | if ( '3' == $this->settings['embed\_comments'] ) { |
  |  | 241 | if ( ! empty( $this->settings['div\_class'] ) ) { |
  |  | 242 | add\_filter( 'the\_content', array( $this, 'vuukleCommentBox' ), $this->settings['priority'] ); |
  |  | 243 | } |
  |  | 244 | add\_filter( 'comments\_template', array( $this, 'commentsTemplate' ), 999 ); |
  |  | 245 | } |
  |  | 246 | if ( '4' == $this->settings['embed\_comments'] ) { |
  |  | 247 | if ( ! empty( $this->settings['div\_id'] ) ) { |
  |  | 248 | add\_filter( 'the\_content', array( $this, 'vuukleCommentBox' ), $this->settings['priority'] ); |
  |  | 249 | } |
  |  | 250 | add\_filter( 'comments\_template', array( $this, 'commentsTemplate' ), 999 ); |
  |  | 251 | } |
  |  | 252 | } |
  |  | 253 | add\_action( 'wp\_footer', array( $this, 'createVuuklePlatform' ) ); |
  |  | 254 | if ( $this->settings['emote'] && '2' ) { |
  |  | 255 | add\_filter( 'the\_content', array( $this, 'addEmote' ), 20 ); |
  |  | 256 | } |
  |  | 257 | //share bar mobile and desktop before Div & ID |
  |  | 258 | if ( $this->settings['enable\_h\_v'] === 'yes' ) { |
  |  | 259 | if ( wp\_is\_mobile() ) { |
  |  | 260 | if ( $this->settings['embed\_powerbar'] === '2' && $this->settings['div\_id\_powerbar'] != '' ) { |
  |  | 261 | add\_filter( 'the\_content', array( $this, 'addShareBefore' ), 11 ); |
  |  | 262 | } else { |
  |  | 263 | if ( $this->settings['share'] ) { |
  |  | 264 | add\_filter( 'the\_content', array( $this, 'addOnlyBefore' ), 11 ); |
  |  | 265 | } |
  |  | 266 | if ( $this->settings['share'] ) { |
  |  | 267 | add\_filter( 'the\_content', array( $this, 'addOnlyAfter' ), 11 ); |
  |  | 268 | } |
  |  | 269 | } |
  |  | 270 | } else { |
  |  | 271 | if ( $this->settings['share'] ) { |
  |  | 272 | add\_filter( 'the\_content', array( $this, 'addOnlyVertical' ), 11 ); |
  |  | 273 | } |
  |  | 274 | } |
  |  | 275 | } else { |
  |  | 276 | if ( ( $this->settings['embed\_powerbar'] === '1' && $this->settings['div\_class\_powerbar'] != '' ) || ( $this->settings['embed\_powerbar'] === '2' && $this->settings['div\_id\_powerbar'] != '' ) ) { |
  |  | 277 | if ( wp\_is\_mobile() ) { |
  |  | 278 | if ( $this->settings['share'] && 'vertical' === $this->settings['mobile\_type'] && $this->settings['share\_type\_vertical'] === 'vertical' ) { |
  |  | 279 | add\_filter( 'the\_content', array( $this, 'addShareBefore2' ), 11 ); |
  |  | 280 | } |
  |  | 281 | if ( $this->settings['share'] && 'horizontal' === $this->settings['mobile\_type\_horizontal'] && $this->settings['share\_type'] === 'horizontal' ) { |
  |  | 282 | add\_filter( 'the\_content', array( $this, 'addShareBefore' ), 11 ); |
  |  | 283 | } |
  |  | 284 | } else { |
  |  | 285 | if ( $this->settings['share'] && 'vertical' === $this->settings['desktop\_type'] && $this->settings['share\_type\_vertical'] === 'vertical' ) { |
  |  | 286 | add\_filter( 'the\_content', array( $this, 'addShareBefore2' ), 11 ); |
  |  | 287 | } |
  |  | 288 | if ( $this->settings['share'] && 'horizontal' === $this->settings['desktop\_type\_horizontal'] && $this->settings['share\_type'] === 'horizontal' ) { |
  |  | 289 | add\_filter( 'the\_content', array( $this, 'addShareBefore' ), 11 ); |
  |  | 290 | } |
  |  | 291 | } |
  |  | 292 | } else { |
  |  | 293 | $isPut = false; |
  |  | 294 | if ( wp\_is\_mobile() ) { |
  |  | 295 | if ( $this->settings['share'] && 'vertical' === $this->settings['mobile\_type'] && $this->settings['share\_type\_vertical'] === 'vertical' ) { |
  |  | 296 | $isPut = true; |
  |  | 297 | add\_filter( 'the\_content', array( $this, 'addShareBefore2' ), 11 ); |
  |  | 298 | } |
  |  | 299 | if ( $this->settings['share'] && 'horizontal' === $this->settings['mobile\_type\_horizontal'] && $this->settings['share\_type'] === 'horizontal' && $this->settings['share\_position2'] === '1' ) { |
  |  | 300 | add\_filter( 'the\_content', array( $this, 'addShareBefore' ), 11 ); |
  |  | 301 | } |
  |  | 302 | } else { |
  |  | 303 | if ( $this->settings['share'] && 'vertical' === $this->settings['desktop\_type'] && $this->settings['share\_type\_vertical'] === 'vertical' && ! $isPut ) { |
  |  | 304 | add\_filter( 'the\_content', array( $this, 'addShareBefore2' ), 11 ); |
  |  | 305 | } |
  |  | 306 | if ( $this->settings['share'] && 'horizontal' === $this->settings['desktop\_type\_horizontal'] && $this->settings['share\_type'] === 'horizontal' && $this->settings['share\_position2'] === '1' ) { |
  |  | 307 | add\_filter( 'the\_content', array( $this, 'addShareBefore' ), 11 ); |
  |  | 308 | } |
  |  | 309 | } |
  |  | 310 | if ( wp\_is\_mobile() ) { |
  |  | 311 | if ( $this->settings['share'] && 'vertical' === $this->settings['mobile\_type'] && $this->settings['share\_type\_vertical'] === 'vertical' && ! $isPut ) { |
  |  | 312 | add\_filter( 'the\_content', array( $this, 'addShareAfter2' ), 11 ); |
  |  | 313 | } |
  |  | 314 | if ( $this->settings['share'] && 'horizontal' === $this->settings['mobile\_type\_horizontal'] && $this->settings['share\_type'] === 'horizontal' && $this->settings['share\_position'] === '1' ) { |
  |  | 315 | add\_filter( 'the\_content', array( $this, 'addShareAfter' ), 11 ); |
  |  | 316 | } |
  |  | 317 | } else { |
  |  | 318 | if ( $this->settings['share'] && 'vertical' === $this->settings['desktop\_type'] && $this->settings['share\_type\_vertical'] === 'vertical' && $isPut ) { |
  |  | 319 | add\_filter( 'the\_content', array( $this, 'addShareAfter2' ), 11 ); |
  |  | 320 | } |
  |  | 321 | if ( $this->settings['share'] && 'horizontal' === $this->settings['desktop\_type\_horizontal'] && $this->settings['share\_type'] === 'horizontal' && $this->settings['share\_position'] === '1' ) { |
  |  | 322 | add\_filter( 'the\_content', array( $this, 'addShareAfter' ), 11 ); |
  |  | 323 | } |
  |  | 324 | } |
  |  | 325 | } |
  |  | 326 | } |
  |  | 327 | // newsletter bar |
  |  | 328 | if ( isset( $this->settings['non\_article\_pages'] ) && $this->settings['non\_article\_pages'] != 'off' ) { |
  |  | 329 | add\_action( "wp\_footer", array( $this, 'track\_page\_view' ) ); |
  |  | 330 | } |
  |  | 331 | include VUUKLE\_INCLUDES\_PATH . '/export-comments.php'; |
  |  | 332 | } |
  |  | 333 |  |
  |  | 334 | /\*\* |
  |  | 335 | \* Register the stylesheets for the public-facing side of the site. |
  |  | 336 | \* |
  |  | 337 | \* @return void |
  |  | 338 | \* @since  1.0.0 |
  |  | 339 | \*/ |
  |  | 340 | public function enqueueStyles() { |
  |  | 341 |  |
  |  | 342 | /\*\* |
  |  | 343 | \* This function is provided for demonstration purposes only. |
  |  | 344 | \* |
  |  | 345 | \* An instance of this class should be passed to the run() function |
  |  | 346 | \* defined in Free\_Comments\_For\_Wordpress\_Vuukle\_Loader as all of the hooks are defined |
  |  | 347 | \* in that particular class. |
  |  | 348 | \* |
  |  | 349 | \* The Free\_Comments\_For\_Wordpress\_Vuukle\_Loader will then create the relationship |
  |  | 350 | \* between the defined hooks and the functions defined in this |
  |  | 351 | \* class. |
  |  | 352 | \*/ |
  |  | 353 | } |
  |  | 354 |  |
  |  | 355 | /\*\* |
  |  | 356 | \* Register the JavaScript for the public-facing side of the site. |
  |  | 357 | \* |
  |  | 358 | \* @return void |
  |  | 359 | \* @since  1.0.0 |
  |  | 360 | \*/ |
  |  | 361 | public function enqueueScripts() { |
  |  | 362 |  |
  |  | 363 | /\*\* |
  |  | 364 | \* This function is provided for demonstration purposes only. |
  |  | 365 | \* |
  |  | 366 | \* An instance of this class should be passed to the run() function |
  |  | 367 | \* defined in Free\_Comments\_For\_Wordpress\_Vuukle\_Loader as all of the hooks are defined |
  |  | 368 | \* in that particular class. |
  |  | 369 | \* |
  |  | 370 | \* The Free\_Comments\_For\_Wordpress\_Vuukle\_Loader will then create the relationship |
  |  | 371 | \* between the defined hooks and the functions defined in this |
  |  | 372 | \* class. |
  |  | 373 | \*/ |
  |  | 374 | } |
  |  | 375 |  |
  |  | 376 |  |
  |  | 377 | /\*\* |
  |  | 378 | \* This function generates shortcode. |
  |  | 379 | \* |
  |  | 380 | \* @return void |
  |  | 381 | \* @since  1.0.0. |
  |  | 382 | \*/ |
  |  | 383 | public function generateShortcode() { |
  |  | 384 |  |
  |  | 385 | add\_shortcode( 'vuukle', array( $this, 'shortCodeVuukle' ) ); |
  |  | 386 | } |
  |  | 387 |  |
  |  | 388 | /\*\* |
  |  | 389 | \* This function creates a block for shortcode. |
  |  | 390 | \* |
  |  | 391 | \* @param   string  $attr     this is attributes |
  |  | 392 | \* @param   string  $content  this is content |
  |  | 393 | \* |
  |  | 394 | \* @return string |
  |  | 395 | \* @since  1.0.0. |
  |  | 396 | \*/ |
  |  | 397 | public function shortCodeVuukle( $attr, $content ) { |
  |  | 398 |  |
  |  | 399 | return '<div id="vuukle-comments"></div>'; |
  |  | 400 | } |
  |  | 401 |  |
  |  | 402 | /\*\* |
  |  | 403 | \* This function saves comments to DB. |
  |  | 404 | \* |
  |  | 405 | \* @return void |
  |  | 406 | \* @since  1.0.0. |
  |  | 407 | \*/ |
  |  | 408 | public function saveCommentToDb() { |
  |  | 409 | $nonce = ! empty( $\_POST['\_wpnonce'] ) ? sanitize\_key( $\_POST['\_wpnonce'] ) : ''; |
  |  | 410 | if ( wp\_verify\_nonce( $nonce ) ) { |
  |  | 411 | global $wpdb; |
  |  | 412 | $post              = esc\_sql( $\_POST ); // Input var okay |
  |  | 413 | $data              = array( |
  |  | 414 | 'comment\_post\_ID'      => (int) $post['comment\_post\_ID'], |
  |  | 415 | 'comment\_author'       => $post['comment\_author'], |
  |  | 416 | 'comment\_author\_email' => $post['comment\_author\_email'], |
  |  | 417 | 'comment\_author\_url'   => $post['comment\_author\_url'], |
  |  | 418 | 'comment\_content'      => $post['comment\_content'], |
  |  | 419 | 'comment\_type'         => $post['comment\_type'], |
  |  | 420 | 'comment\_parent'       => $post['comment\_parent\_ID'], |
  |  | 421 | 'user\_id'              => $post['user\_id'], |
  |  | 422 | 'comment\_author\_IP'    => $post['comment\_author\_IP'], |
  |  | 423 | 'comment\_agent'        => $post['comment\_agent'], |
  |  | 424 | 'comment\_date'         => gmdate( 'Y-m-d H:i:s', strtotime( $post['comment\_date'] ) ), |
  |  | 425 | 'comment\_date\_gmt'     => gmdate( 'Y-m-d H:i:s', strtotime( $post['comment\_date'] ) ), |
  |  | 426 | 'comment\_approved'     => $post['comment\_approved'], |
  |  | 427 | 'comment\_karma'        => $post['comment\_karma'], |
  |  | 428 | ); |
  |  | 429 | $comment\_ID        = wp\_insert\_comment( $data ); |
  |  | 430 | $vuukle\_comment\_ID = (int) $post['comment\_ID']; |
  |  | 431 | $wpdb->query( $wpdb->prepare( "UPDATE" . $wpdb->prefix . "comments SET comment\_ID=%s WHERE comment\_ID=%s", $vuukle\_comment\_ID, $comment\_ID ) ); |
  |  | 432 | //$wpdb->query("UPDATE ".$wpdb->prefix."comments SET comment\_ID = $vuukle\_comment\_ID WHERE comment\_ID = '$comment\_ID'"); |
  |  | 433 | exit; |
  |  | 434 | } |
  |  | 435 | } |
  |  | 436 |  |
  |  | 437 | /\*\* |
  |  | 438 | \* This function adds DNS. |
  |  | 439 | \* |
  |  | 440 | \* @return void |
  |  | 441 | \* @since  1.0.0. |
  |  | 442 | \*/ |
  |  | 443 | public function addDns() { |
  |  | 444 | ?> |
  | 540 | 445 | <link rel="preconnect" href="https://cdn.vuukle.com/"> |
  | 541 | 446 | <link rel="dns-prefetch" href="https://cdn.vuukle.com/"> |
  | 542 | 447 | <link rel="dns-prefetch" href="https://api.vuukle.com/"> |
  | 543 | 448 | <link rel="preconnect" href="https://api.vuukle.com/"> |
  | 544 |  | <link rel="prefetch preload" href="https://cdn.vuukle.com/platform.js" as="script"> |
  | 545 |  | <?php |
  | 546 |  | } |
  | 547 |  | public function defer\_parsing\_of\_js($url) |
  | 548 |  | { |
  | 549 |  | if (is\_user\_logged\_in()) return $url; //don't break WP Admin |
  | 550 |  | if (FALSE === strpos($url, '.js')) return $url; |
  | 551 |  | if (strpos($url, 'jquery.js')) return $url; |
  | 552 |  | return str\_replace(' src', '  src', $url); |
  | 553 |  | } |
  | 554 |  |  |
  | 555 |  | /\*\* |
  | 556 |  | \* This function adds scripts in the front. |
  | 557 |  | \* |
  | 558 |  | \* @since  1.0.0. |
  | 559 |  | \* @return void |
  | 560 |  | \*/ |
  | 561 |  | public function frontScripts() |
  | 562 |  | { |
  | 563 |  | if ($this->settings['AppId']) { |
  | 564 |  | if (is\_single()) { |
  | 565 |  | wp\_localize\_script( |
  | 566 |  | 'wuukle-widget', |
  | 567 |  | 'param', |
  | 568 |  | array( |
  | 569 |  | 'vuukle\_version' => FREE\_COMMENTS\_FOR\_WORDPRESS\_VUUKLE\_VERSION, |
  | 570 |  | 'api\_key' => (bool)$this->settings['AppId'], |
  | 571 |  | ) |
  | 572 |  | ); |
  | 573 |  | } else { |
  | 574 |  | wp\_enqueue\_script('comments\_count', plugins\_url('/js/count.js', \_\_FILE\_\_),  NULL, true); |
  | 575 |  | wp\_localize\_script( |
  | 576 |  | 'comments\_count', |
  | 577 |  | 'params', |
  | 578 |  | array( |
  | 579 |  | 'api\_key' => $this->settings['AppId'], |
  | 580 |  | 'host' => str\_replace(array('www.', 'http://', 'https://'), '', get\_site\_url()), |
  | 581 |  | ) |
  | 582 |  | ); |
  | 583 |  | } |
  | 584 |  | } |
  | 585 |  | } |
  | 586 |  |  |
  | 587 |  | /\*\* |
  | 588 |  | \* This function adds scripts in the front. |
  | 589 |  | \* |
  | 590 |  | \* @param string $content this is a content |
  | 591 |  | \* |
  | 592 |  | \* @since  1.0.0. |
  | 593 |  | \* @return string |
  | 594 |  | \*/ |
  | 595 |  | public function vuukleCommentBox($content) |
  | 596 |  | { |
  | 597 |  | if (is\_single()) { |
  | 598 |  | ob\_start(); |
  | 599 |  | $vuukle = $this; |
  | 600 |  | include VUUKLE\_INCLUDES\_PATH . '/commentbox.php'; |
  | 601 |  | $commentbox = ob\_get\_contents(); |
  | 602 |  | ob\_end\_clean(); |
  | 603 |  | $content .= $commentbox; |
  | 604 |  | } |
  | 605 |  | return $content; |
  | 606 |  | } |
  | 607 |  | public function removePostone() |
  | 608 |  | { |
  | 609 |  | global $post; |
  | 610 |  |  |
  | 611 |  | $post\_exceptions = explode(',', $this->settings['post\_exceptions']); |
  | 612 |  | $post\_exceptions = array\_map('trim', $post\_exceptions); |
  | 613 |  |  |
  | 614 |  | $category\_exceptions = explode(',', $this->settings['category\_exceptions']); |
  | 615 |  | $category\_exceptions = array\_map('trim', $category\_exceptions); |
  | 616 |  | $post\_categories     = get\_the\_category($post->ID); |
  | 617 |  | foreach ($post\_categories as $key => $category) { |
  | 618 |  | $post\_categories[$key] = $category->slug; |
  | 619 |  | } |
  | 620 |  |  |
  | 621 |  |  |
  | 622 |  | if (in\_array((string) $post->ID, $post\_exceptions, true)) { |
  | 623 |  | return false; |
  | 624 |  | } |
  | 625 |  |  |
  | 626 |  | if (count(array\_intersect($category\_exceptions, $post\_categories))) { |
  | 627 |  | return false; |
  | 628 |  | } |
  | 629 |  |  |
  | 630 |  | // post type exceptions |
  | 631 |  | $post\_type\_exceptions = explode(',', $this->settings['post\_type\_exceptions']); |
  | 632 |  | $post\_type\_exceptions = array\_map('trim', $post\_type\_exceptions); |
  | 633 |  | if (in\_array((string) $post->post\_type, $post\_type\_exceptions, true)) { |
  | 634 |  | return false; |
  | 635 |  | } |
  | 636 |  |  |
  | 637 |  | // post type by URL exceptions |
  | 638 |  | $post\_type\_by\_url\_exceptions = explode(',', $this->settings['post\_type\_by\_url\_exceptions']); |
  | 639 |  | $post\_type\_by\_url\_exceptions = array\_map('trim', $post\_type\_by\_url\_exceptions); |
  | 640 |  | $link = str\_replace(home\_url(), '', get\_permalink()); |
  | 641 |  | if (in\_array((string) $link, $post\_type\_by\_url\_exceptions, true)) { |
  | 642 |  | return false; |
  | 643 |  | } |
  | 644 |  | return true; |
  | 645 |  | } |
  | 646 |  |  |
  | 647 |  |  |
  | 648 |  |  |
  | 649 |  | /\*\* |
  | 650 |  | \* This function adds emote. |
  | 651 |  | \* |
  | 652 |  | \* @param string $content this is a content |
  | 653 |  | \* |
  | 654 |  | \* @since  1.0.0. |
  | 655 |  | \* @return string |
  | 656 |  | \*/ |
  | 657 |  | public function addEmote($content) |
  | 658 |  | { |
  | 659 |  | $emote\_text = array( |
  | 660 |  | $this->settings['happy\_text'], |
  | 661 |  | $this->settings['indifferent\_text'], |
  | 662 |  | $this->settings['amused\_text'], |
  | 663 |  | $this->settings['excited\_text'], |
  | 664 |  | $this->settings['angry\_text'], |
  | 665 |  | $this->settings['sad\_text'], |
  | 666 |  | ); |
  | 667 |  |  |
  | 668 |  |  |
  | 669 |  |  |
  | 670 |  | $style\_emote = ''; |
  | 671 |  | if (is\_single()) { |
  | 672 |  | if ($this->settings['emote\_widget\_width'] &&  $this->settings['emote'] === 'true' && $this->removePostone()) { |
  | 673 |  | $width = $this->settings['emote\_widget\_width']; |
  | 674 |  | $style\_emote = "style='max-width:" . $width . "px;min-height:160px;'"; |
  | 675 |  | } |
  | 676 |  | } else { |
  | 677 |  | $style\_emote = ''; |
  | 678 |  | } |
  | 679 |  |  |
  | 680 |  | return $content . '<div id="vuukle-emote" ' . $style\_emote . ' class="emotesBoxDiv"></div>'; |
  | 681 |  | } |
  | 682 |  |  |
  | 683 |  |  |
  | 684 |  |  |
  | 685 |  | /\*\* |
  | 686 |  | \* This function adds newsfeed box. |
  | 687 |  | \* |
  | 688 |  | \* @param string $content this is a content |
  | 689 |  | \* |
  | 690 |  | \* @since  1.0.0. |
  | 691 |  | \* @return string |
  | 692 |  | \*/ |
  | 693 |  | public function addNewsfeedBox($content) |
  | 694 |  | { |
  | 695 |  |  |
  | 696 |  | return $content . '<div id="vuukle-newsfeed" class="newsfeedBoxDiv"></div>'; |
  | 697 |  | } |
  | 698 |  |  |
  | 699 |  | /\*\* |
  | 700 |  | \* This function adds endless box. |
  | 701 |  | \* |
  | 702 |  | \* @param string $content this is a content |
  | 703 |  | \* |
  | 704 |  | \* @since  1.0.0. |
  | 705 |  | \* @return string |
  | 706 |  | \*/ |
  | 707 |  | public function addEndlessBox($content) |
  | 708 |  | { |
  | 709 |  | global $post; |
  | 710 |  |  |
  | 711 |  | return $content . ' <div class="vuukle-powerbar-' . $post->ID . '"></div> |
  |  | 449 | <?php |
  |  | 450 | } |
  |  | 451 |  |
  |  | 452 | public function defer\_parsing\_of\_js( $url ) { |
  |  | 453 | if ( is\_user\_logged\_in() ) { |
  |  | 454 | return $url; |
  |  | 455 | } //don't break WP Admin |
  |  | 456 | if ( false === strpos( $url, '.js' ) ) { |
  |  | 457 | return $url; |
  |  | 458 | } |
  |  | 459 | if ( strpos( $url, 'jquery.js' ) ) { |
  |  | 460 | return $url; |
  |  | 461 | } |
  |  | 462 |  |
  |  | 463 | return str\_replace( ' src', '  src', $url ); |
  |  | 464 | } |
  |  | 465 |  |
  |  | 466 | /\*\* |
  |  | 467 | \* This function adds scripts in the front. |
  |  | 468 | \* |
  |  | 469 | \* @return void |
  |  | 470 | \* @since  1.0.0. |
  |  | 471 | \*/ |
  |  | 472 | public function frontScripts() { |
  |  | 473 | if ( $this->settings['AppId'] ) { |
  |  | 474 | if ( is\_single() ) { |
  |  | 475 | wp\_localize\_script( 'wuukle-widget', 'param', array( |
  |  | 476 | 'vuukle\_version' => FREE\_COMMENTS\_FOR\_WORDPRESS\_VUUKLE\_VERSION, |
  |  | 477 | 'api\_key'        => (bool) $this->settings['AppId'], |
  |  | 478 | ) ); |
  |  | 479 | } else { |
  |  | 480 | wp\_enqueue\_script( 'comments\_count', plugins\_url( '/js/count.js', \_\_FILE\_\_ ), null, true ); |
  |  | 481 | wp\_localize\_script( 'comments\_count', 'params', array( |
  |  | 482 | 'api\_key' => $this->settings['AppId'], |
  |  | 483 | 'host'    => str\_replace( array( 'www.', 'http://', 'https://' ), '', get\_site\_url() ), |
  |  | 484 | ) ); |
  |  | 485 | } |
  |  | 486 | } |
  |  | 487 | } |
  |  | 488 |  |
  |  | 489 | /\*\* |
  |  | 490 | \* This function adds scripts in the front. |
  |  | 491 | \* |
  |  | 492 | \* @param   string  $content  this is a content |
  |  | 493 | \* |
  |  | 494 | \* @return string |
  |  | 495 | \* @since  1.0.0. |
  |  | 496 | \*/ |
  |  | 497 | public function vuukleCommentBox( $content ) { |
  |  | 498 | if ( is\_single() ) { |
  |  | 499 | ob\_start(); |
  |  | 500 | $vuukle           = $this; |
  |  | 501 | $vuukle->settings = get\_option( $vuukle->settings\_name ); |
  |  | 502 | if ( is\_array( $vuukle->settings ) ) { |
  |  | 503 | $settings         = array\_merge( $this->settings\_defaults, $this->settings ); |
  |  | 504 | $settings         = array\_intersect\_key( $settings, $this->settings\_defaults ); |
  |  | 505 | $vuukle->settings = $settings; |
  |  | 506 | } |
  |  | 507 | include VUUKLE\_INCLUDES\_PATH . '/commentbox.php'; |
  |  | 508 | $commentbox = ob\_get\_contents(); |
  |  | 509 | ob\_end\_clean(); |
  |  | 510 | $content .= $commentbox; |
  |  | 511 | } |
  |  | 512 |  |
  |  | 513 | return $content; |
  |  | 514 | } |
  |  | 515 |  |
  |  | 516 | public function removePostone() { |
  |  | 517 | global $post; |
  |  | 518 | $post\_exceptions     = explode( ',', $this->settings['post\_exceptions'] ); |
  |  | 519 | $post\_exceptions     = array\_map( 'trim', $post\_exceptions ); |
  |  | 520 | $category\_exceptions = explode( ',', $this->settings['category\_exceptions'] ); |
  |  | 521 | $category\_exceptions = array\_map( 'trim', $category\_exceptions ); |
  |  | 522 | $post\_categories     = get\_the\_category( $post->ID ); |
  |  | 523 | foreach ( $post\_categories as $key => $category ) { |
  |  | 524 | $post\_categories[ $key ] = $category->slug; |
  |  | 525 | } |
  |  | 526 | if ( in\_array( (string) $post->ID, $post\_exceptions, true ) ) { |
  |  | 527 | return false; |
  |  | 528 | } |
  |  | 529 | if ( count( array\_intersect( $category\_exceptions, $post\_categories ) ) ) { |
  |  | 530 | return false; |
  |  | 531 | } |
  |  | 532 | // post type exceptions |
  |  | 533 | $post\_type\_exceptions = explode( ',', $this->settings['post\_type\_exceptions'] ); |
  |  | 534 | $post\_type\_exceptions = array\_map( 'trim', $post\_type\_exceptions ); |
  |  | 535 | if ( in\_array( (string) $post->post\_type, $post\_type\_exceptions, true ) ) { |
  |  | 536 | return false; |
  |  | 537 | } |
  |  | 538 | // post type by URL exceptions |
  |  | 539 | $post\_type\_by\_url\_exceptions = explode( ',', $this->settings['post\_type\_by\_url\_exceptions'] ); |
  |  | 540 | $post\_type\_by\_url\_exceptions = array\_map( 'trim', $post\_type\_by\_url\_exceptions ); |
  |  | 541 | $link                        = str\_replace( home\_url(), '', get\_permalink() ); |
  |  | 542 | if ( in\_array( (string) $link, $post\_type\_by\_url\_exceptions, true ) ) { |
  |  | 543 | return false; |
  |  | 544 | } |
  |  | 545 |  |
  |  | 546 | return true; |
  |  | 547 | } |
  |  | 548 |  |
  |  | 549 |  |
  |  | 550 | /\*\* |
  |  | 551 | \* This function adds emote. |
  |  | 552 | \* |
  |  | 553 | \* @param   string  $content  this is a content |
  |  | 554 | \* |
  |  | 555 | \* @return string |
  |  | 556 | \* @since  1.0.0. |
  |  | 557 | \*/ |
  |  | 558 | public function addEmote( $content ) { |
  |  | 559 |  |
  |  | 560 | $style\_emote = ''; |
  |  | 561 | if ( is\_single() ) { |
  |  | 562 | if ( $this->settings['emote\_widget\_width'] && $this->removePostone() ) { |
  |  | 563 | $width       = $this->settings['emote\_widget\_width']; |
  |  | 564 | $style\_emote = "style='max-width:" . $width . "px;min-height:160px;'"; |
  |  | 565 | } |
  |  | 566 | } else { |
  |  | 567 | $style\_emote = ''; |
  |  | 568 | } |
  |  | 569 |  |
  |  | 570 | return $content . '<div id="vuukle-emote" ' . $style\_emote . ' class="emotesBoxDiv"></div>'; |
  |  | 571 | } |
  |  | 572 |  |
  |  | 573 |  |
  |  | 574 | /\*\* |
  |  | 575 | \* This function adds newsfeed box. |
  |  | 576 | \* |
  |  | 577 | \* @param   string  $content  this is a content |
  |  | 578 | \* |
  |  | 579 | \* @return string |
  |  | 580 | \* @since  1.0.0. |
  |  | 581 | \*/ |
  |  | 582 | public function addNewsfeedBox( $content ) { |
  |  | 583 |  |
  |  | 584 | return $content . '<div id="vuukle-newsfeed" class="newsfeedBoxDiv"></div>'; |
  |  | 585 | } |
  |  | 586 |  |
  |  | 587 | /\*\* |
  |  | 588 | \* This function adds endless box. |
  |  | 589 | \* |
  |  | 590 | \* @param   string  $content  this is a content |
  |  | 591 | \* |
  |  | 592 | \* @return string |
  |  | 593 | \* @since  1.0.0. |
  |  | 594 | \*/ |
  |  | 595 | public function addEndlessBox( $content ) { |
  |  | 596 | global $post; |
  |  | 597 |  |
  |  | 598 | return $content . ' <div class="vuukle-powerbar-' . $post->ID . '"></div> |
  | 712 | 599 | <div id="vuukle-emote-' . $post->ID . '"></div> |
  | 713 | 600 | <div id="vuukle-comments-' . $post->ID . '"></div> |
  | 714 | 601 | '; |
  | 715 |  | } |
  | 716 |  |  |
  | 717 |  | /\*\* |
  | 718 |  | \* This function adds endless script. |
  | 719 |  | \* |
  | 720 |  | \* @param string $content this is a content |
  | 721 |  | \* |
  | 722 |  | \* @since  1.0.0. |
  | 723 |  | \* @return string |
  | 724 |  | \*/ |
  | 725 |  | public function addEndlessScript($content) |
  | 726 |  | { |
  | 727 |  | global $post; |
  | 728 |  | $tags     = wp\_get\_post\_tags($post->ID); |
  | 729 |  | $arr\_tags = array(); |
  | 730 |  | if (!empty($tags)) { |
  | 731 |  | $k = 1; |
  | 732 |  | foreach ($tags as $taged) { |
  | 733 |  | if ($k < 4) { |
  | 734 |  | $arr\_tags[] = $taged->name; |
  | 735 |  | } |
  | 736 |  | $k++; |
  | 737 |  | } |
  | 738 |  | $tags = implode(', ', $arr\_tags); |
  | 739 |  | } else { |
  | 740 |  | $tags = ''; |
  | 741 |  | } |
  | 742 |  |  |
  | 743 |  | return $content . ' |
  |  | 602 | } |
  |  | 603 |  |
  |  | 604 | /\*\* |
  |  | 605 | \* This function adds endless script. |
  |  | 606 | \* |
  |  | 607 | \* @param   string  $content  this is a content |
  |  | 608 | \* |
  |  | 609 | \* @return string |
  |  | 610 | \* @since  1.0.0. |
  |  | 611 | \*/ |
  |  | 612 | public function addEndlessScript( $content ) { |
  |  | 613 | global $post; |
  |  | 614 | $tags     = wp\_get\_post\_tags( $post->ID ); |
  |  | 615 | $arr\_tags = array(); |
  |  | 616 | if ( ! empty( $tags ) ) { |
  |  | 617 | $k = 1; |
  |  | 618 | foreach ( $tags as $taged ) { |
  |  | 619 | if ( $k < 4 ) { |
  |  | 620 | $arr\_tags[] = $taged->name; |
  |  | 621 | } |
  |  | 622 | $k ++; |
  |  | 623 | } |
  |  | 624 | $tags = implode( ', ', $arr\_tags ); |
  |  | 625 | } else { |
  |  | 626 | $tags = ''; |
  |  | 627 | } |
  |  | 628 |  |
  |  | 629 | return $content . ' |
  | 744 | 630 | <script data-cfasync="false" > |
  | 745 | 631 | document.addEventListener("DOMContentLoaded", function() { |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/public/class-free-comments-for-wordpress-vuukle-public.php?rev=2533938#L748) | […](/browser/free-comments-for-wordpress-vuukle/trunk/public/class-free-comments-for-wordpress-vuukle-public.php?rev=2553337#L634) |  |
  | 748 | 634 | elementsIndex: ' . $post->ID . ', |
  | 749 | 635 | articleId: ' . $post->ID . ', |
  | 750 |  | img: "' . get\_the\_post\_thumbnail\_url(~~$post->ID, 'thumbnail'~~) . '", |
  | 751 |  | title: "' . get\_the\_title(~~$post->ID~~) . '", |
  | 752 |  | tags: "' . str\_replace(~~['"', "'"], '', quotemeta(stripslashes($tags))~~) . '", |
  | 753 |  | url: "' . get\_permalink(~~$post->ID~~) . '", |
  |  | 636 | img: "' . get\_the\_post\_thumbnail\_url( $post->ID, 'thumbnail' ) . '", |
  |  | 637 | title: "' . get\_the\_title( $post->ID ) . '", |
  |  | 638 | tags: "' . str\_replace( [ '"', "'" ], '', quotemeta( stripslashes( $tags ) ) ) . '", |
  |  | 639 | url: "' . get\_permalink( $post->ID ) . '", |
  | 754 | 640 | }); |
  | 755 | 641 | }, 2000); |
  | 756 | 642 | }); |
  | 757 | 643 | </script>'; |
  | 758 |  | } |
  | 759 |  |  |
  | 760 |  | /\*\* |
  | 761 |  | \* This function adds share afther box. |
  | 762 |  | \* |
  | 763 |  | \* @param string $content this is a content |
  | 764 |  | \* |
  | 765 |  | \* @since  1.0.0. |
  | 766 |  | \* @return string |
  | 767 |  | \*/ |
  | 768 |  | public function addShareAfter($content) |
  | 769 |  | { |
  | 770 |  | $type   = 'horizontal' === $this->settings['share\_type'] ? 'vuukle-powerbar' : 'vuukle-powerbar-vertical'; |
  | 771 |  | $styles = 'horizontal' === $this->settings['share\_type'] ? '' : $this->settings['share\_vertical\_styles']; |
  | 772 |  | if (is\_single() && $this->removePostone()) { |
  | 773 |  | $styles = $styles . "min-height: 50px;"; |
  | 774 |  | } else { |
  | 775 |  | $styles = ''; |
  | 776 |  | } |
  | 777 |  | return $content . '<div id="vuukle-powerbar" class="' . $type . ' powerbarBoxDiv" style="' . $styles . '" data-styles="' . $styles . '"></div>'; |
  | 778 |  | } |
  | 779 |  | public function addShareAfter2($content) |
  | 780 |  | { |
  | 781 |  | $type   = 'vertical' === $this->settings['share\_type\_vertical'] ? 'vuukle-powerbar-vertical' : 'vuukle-powerbar'; |
  | 782 |  | $styles = 'vertical' === $this->settings['share\_type\_vertical'] ? $this->settings['share\_vertical\_styles'] : ''; |
  | 783 |  | $styles = $styles . "min-height: 50px;"; |
  | 784 |  | return $content . '<div id="vuukle-powerbar" class="' . $type . ' powerbarBoxDiv" style="' . $styles . '" data-styles="' . $styles . '"></div>'; |
  | 785 |  | } |
  | 786 |  |  |
  | 787 |  |  |
  | 788 |  | /\*\* |
  | 789 |  | \* This function adds share before box. |
  | 790 |  | \* |
  | 791 |  | \* @param string $content this is a content |
  | 792 |  | \* |
  | 793 |  | \* @since  1.0.0. |
  | 794 |  | \* @return string |
  | 795 |  | \*/ |
  | 796 |  | public function addShareBefore($content) |
  | 797 |  | { |
  | 798 |  | $type   = 'horizontal' === $this->settings['share\_type'] ? 'vuukle-powerbar' : 'vuukle-powerbar-vertical'; |
  | 799 |  | $styles = 'horizontal' === $this->settings['share\_type'] ? '' : $this->settings['share\_vertical\_styles']; |
  | 800 |  | if (is\_single() && $this->removePostone()) { |
  | 801 |  | $styles = $styles . "min-height: 50px;"; |
  | 802 |  | } else { |
  | 803 |  | $styles = ''; |
  | 804 |  | } |
  | 805 |  | return '<div id="vuukle-powerbar" class="' . $type . ' powerbarBoxDiv" style="' . $styles . ' " data-styles="' . $styles . '"></div>' . $content; |
  | 806 |  | } |
  | 807 |  | public function addShareBefore2($content) |
  | 808 |  | { |
  | 809 |  | $type   = 'vertical' === $this->settings['share\_type\_vertical'] ? 'vuukle-powerbar-vertical' : 'vuukle-powerbar'; |
  | 810 |  | $styles = 'vertical' === $this->settings['share\_type\_vertical'] ?  $this->settings['share\_vertical\_styles'] : ''; |
  | 811 |  | $styles = $styles . "min-height: 50px;"; |
  | 812 |  | return '<div id="vuukle-powerbar" class="' . $type . ' powerbarBoxDiv" style="' . $styles . ' " data-styles="' . $styles . '"></div>' . $content; |
  | 813 |  | } |
  | 814 |  |  |
  | 815 |  |  |
  | 816 |  | public function addOnlyAfter($content) |
  | 817 |  | { |
  | 818 |  | $type = 'vuukle-powerbar'; |
  | 819 |  | $styles = ''; |
  | 820 |  | return $content . '<div id="vuukle-powerbar" class="' . $type . ' powerbarBoxDiv" style="' . $styles . '" data-styles="' . $styles . '"></div>'; |
  | 821 |  | } |
  | 822 |  | public function addOnlyBefore($content) |
  | 823 |  | { |
  | 824 |  | $type = 'vuukle-powerbar'; |
  | 825 |  | $styles = ''; |
  | 826 |  | return '<div id="vuukle-powerbar" class="' . $type . ' powerbarBoxDiv" style="' . $styles . ' " data-styles="' . $styles . '"></div>' . $content; |
  | 827 |  | } |
  | 828 |  | public function addOnlyVertical($content) |
  | 829 |  | { |
  | 830 |  | $type = 'vuukle-powerbar-vertical'; |
  | 831 |  | $styles =  $this->settings['share\_vertical\_styles']; |
  | 832 |  | return $content . '<div id="vuukle-powerbar" class="' . $type . ' powerbarBoxDiv" style="' . $styles . '" data-styles="' . $styles . '"></div>'; |
  | 833 |  | } |
  | 834 |  |  |
  | 835 |  |  |
  | 836 |  | /\*\* |
  | 837 |  | \* This function adds newsletter box. |
  | 838 |  | \* |
  | 839 |  | \* @param string $content this is a content |
  | 840 |  | \* |
  | 841 |  | \* @since  1.0.0. |
  | 842 |  | \* @return string |
  | 843 |  | \*/ |
  | 844 |  | public function addNewsletter($content) |
  | 845 |  | { |
  | 846 |  | return ('1' === $this->settings['newsletter\_position']) ? $content . '<div id="vuukle-subscribe"></div>' : '<div id="vuukle-subscribe"></div>' . $content; |
  | 847 |  | } |
  | 848 |  |  |
  | 849 |  | /\*\* |
  | 850 |  | \* This function registers recent comments widget. |
  | 851 |  | \* |
  | 852 |  | \* @since  1.0.0. |
  | 853 |  | \* @return void |
  | 854 |  | \*/ |
  | 855 |  | public function registerRecentCommentsWidget() |
  | 856 |  | { |
  | 857 |  | unregister\_widget('WP\_Widget\_Recent\_Comments'); |
  | 858 |  | register\_widget('Recent\_Comments\_Widget'); |
  | 859 |  | register\_widget('Most\_Commented\_Stories\_Widget'); |
  | 860 |  | } |
  | 861 |  |  |
  | 862 |  | /\*\* |
  | 863 |  | \* This function adds meta tags. |
  | 864 |  | \* |
  | 865 |  | \* @since  1.0.0. |
  | 866 |  | \* @return void |
  | 867 |  | \*/ |
  | 868 |  | public function ogTags() |
  | 869 |  | { |
  | 870 |  | global $post; |
  | 871 |  | $tags = '<meta property="og:title" content="' . get\_the\_title() . '" /> |
  |  | 644 | } |
  |  | 645 |  |
  |  | 646 | /\*\* |
  |  | 647 | \* This function adds share afther box. |
  |  | 648 | \* |
  |  | 649 | \* @param   string  $content  this is a content |
  |  | 650 | \* |
  |  | 651 | \* @return string |
  |  | 652 | \* @since  1.0.0. |
  |  | 653 | \*/ |
  |  | 654 | public function addShareAfter( $content ) { |
  |  | 655 | $type   = 'horizontal' === $this->settings['share\_type'] ? 'vuukle-powerbar' : 'vuukle-powerbar-vertical'; |
  |  | 656 | $styles = ''; |
  |  | 657 | if ( is\_single() && $this->removePostone() ) { |
  |  | 658 | $styles = $styles . "min-height: 50px;"; |
  |  | 659 | } else { |
  |  | 660 | $styles = ''; |
  |  | 661 | } |
  |  | 662 |  |
  |  | 663 | return $content . '<div id="vuukle-powerbar" class="' . $type . ' powerbarBoxDiv" style="' . $styles . '" data-styles="' . $styles . '"></div>'; |
  |  | 664 | } |
  |  | 665 |  |
  |  | 666 | public function addShareAfter2( $content ) { |
  |  | 667 | $type   = 'vertical' === $this->settings['share\_type\_vertical'] ? 'vuukle-powerbar-vertical' : 'vuukle-powerbar'; |
  |  | 668 | $styles = ''; |
  |  | 669 | $styles = $styles . "min-height: 50px;"; |
  |  | 670 |  |
  |  | 671 | return $content . '<div id="vuukle-powerbar" class="' . $type . ' powerbarBoxDiv" style="' . $styles . '" data-styles="' . $styles . '"></div>'; |
  |  | 672 | } |
  |  | 673 |  |
  |  | 674 |  |
  |  | 675 | /\*\* |
  |  | 676 | \* This function adds share before box. |
  |  | 677 | \* |
  |  | 678 | \* @param   string  $content  this is a content |
  |  | 679 | \* |
  |  | 680 | \* @return string |
  |  | 681 | \* @since  1.0.0. |
  |  | 682 | \*/ |
  |  | 683 | public function addShareBefore( $content ) { |
  |  | 684 | $type   = 'horizontal' === $this->settings['share\_type'] ? 'vuukle-powerbar' : 'vuukle-powerbar-vertical'; |
  |  | 685 | $styles = ''; |
  |  | 686 | if ( is\_single() && $this->removePostone() ) { |
  |  | 687 | $styles = $styles . "min-height: 50px;"; |
  |  | 688 | } else { |
  |  | 689 | $styles = ''; |
  |  | 690 | } |
  |  | 691 |  |
  |  | 692 | return '<div id="vuukle-powerbar" class="' . $type . ' powerbarBoxDiv" style="' . $styles . ' " data-styles="' . $styles . '"></div>' . $content; |
  |  | 693 | } |
  |  | 694 |  |
  |  | 695 | public function addShareBefore2( $content ) { |
  |  | 696 | $type   = 'vertical' === $this->settings['share\_type\_vertical'] ? 'vuukle-powerbar-vertical' : 'vuukle-powerbar'; |
  |  | 697 | $styles = ''; |
  |  | 698 | $styles = $styles . "min-height: 50px;"; |
  |  | 699 |  |
  |  | 700 | return '<div id="vuukle-powerbar" class="' . $type . ' powerbarBoxDiv" style="' . $styles . ' " data-styles="' . $styles . '"></div>' . $content; |
  |  | 701 | } |
  |  | 702 |  |
  |  | 703 |  |
  |  | 704 | public function addOnlyAfter( $content ) { |
  |  | 705 | $type   = 'vuukle-powerbar'; |
  |  | 706 | $styles = ''; |
  |  | 707 |  |
  |  | 708 | return $content . '<div id="vuukle-powerbar" class="' . $type . ' powerbarBoxDiv" style="' . $styles . '" data-styles="' . $styles . '"></div>'; |
  |  | 709 | } |
  |  | 710 |  |
  |  | 711 | public function addOnlyBefore( $content ) { |
  |  | 712 | $type   = 'vuukle-powerbar'; |
  |  | 713 | $styles = ''; |
  |  | 714 |  |
  |  | 715 | return '<div id="vuukle-powerbar" class="' . $type . ' powerbarBoxDiv" style="' . $styles . ' " data-styles="' . $styles . '"></div>' . $content; |
  |  | 716 | } |
  |  | 717 |  |
  |  | 718 | public function addOnlyVertical( $content ) { |
  |  | 719 | $type = 'vuukle-powerbar-vertical'; |
  |  | 720 |  |
  |  | 721 | return $content . '<div id="vuukle-powerbar" class="' . $type . ' powerbarBoxDiv" style="' . '" data-styles="' . $styles . '"></div>'; |
  |  | 722 | } |
  |  | 723 |  |
  |  | 724 |  |
  |  | 725 | /\*\* |
  |  | 726 | \* This function adds newsletter box. |
  |  | 727 | \* |
  |  | 728 | \* @param   string  $content  this is a content |
  |  | 729 | \* |
  |  | 730 | \* @return string |
  |  | 731 | \* @since  1.0.0. |
  |  | 732 | \*/ |
  |  | 733 | /\*\* |
  |  | 734 | \* This function registers recent comments widget. |
  |  | 735 | \* |
  |  | 736 | \* @return void |
  |  | 737 | \* @since  1.0.0. |
  |  | 738 | \*/ |
  |  | 739 | public function registerRecentCommentsWidget() { |
  |  | 740 | unregister\_widget( 'WP\_Widget\_Recent\_Comments' ); |
  |  | 741 | // register\_widget('Recent\_Comments\_Widget'); |
  |  | 742 | // register\_widget('Most\_Commented\_Stories\_Widget'); |
  |  | 743 | unregister\_widget( 'Recent\_Comments\_Widget' ); |
  |  | 744 | unregister\_widget( 'Most\_Commented\_Stories\_Widget' ); |
  |  | 745 | } |
  |  | 746 |  |
  |  | 747 | /\*\* |
  |  | 748 | \* This function adds meta tags. |
  |  | 749 | \* |
  |  | 750 | \* @return void |
  |  | 751 | \* @since  1.0.0. |
  |  | 752 | \*/ |
  |  | 753 | public function ogTags() { |
  |  | 754 | global $post; |
  |  | 755 | $tags = '<meta property="og:title" content="' . get\_the\_title() . '" /> |
  | 872 | 756 | <meta property="og:type" content="article" /> |
  | 873 | 757 | <meta property="og:url" content="' . get\_permalink() . '" /> |
  | 874 | 758 | '; |
  | 875 |  | if (has\_post\_thumbnail()) { |
  | 876 |  | $tags .= '<meta property="og:image" content="' . get\_the\_post\_thumbnail\_url() . '" />'; |
  | 877 |  | } |
  | 878 |  |  |
  | 879 |  | echo $tags; |
  | 880 |  | } |
  | 881 |  |  |
  | 882 |  | /\*\* |
  | 883 |  | \* This function creates a VUUKLE platform. |
  | 884 |  | \* |
  | 885 |  | \* @param string $content this is a content |
  | 886 |  | \* |
  | 887 |  | \* @since  1.0.0. |
  | 888 |  | \* @return string |
  | 889 |  | \*/ |
  | 890 |  | public function createVuuklePlatform($content) |
  | 891 |  | { |
  | 892 |  | if (!is\_single()) { |
  | 893 |  | return $content; |
  | 894 |  | } |
  | 895 |  |  |
  | 896 |  | if (!is\_singular()) { |
  | 897 |  | return $content; |
  | 898 |  | } |
  | 899 |  |  |
  | 900 |  | if (!is\_main\_query()) { |
  | 901 |  | return $content; |
  | 902 |  | } |
  | 903 |  |  |
  | 904 |  | global $post; |
  | 905 |  |  |
  | 906 |  | $post\_exceptions = explode(',', $this->settings['post\_exceptions']); |
  | 907 |  | $post\_exceptions = array\_map('trim', $post\_exceptions); |
  | 908 |  |  |
  | 909 |  | $category\_exceptions = explode(',', $this->settings['category\_exceptions']); |
  | 910 |  | $category\_exceptions = array\_map('trim', $category\_exceptions); |
  | 911 |  | $post\_categories     = get\_the\_category($post->ID); |
  | 912 |  | $post\_url = get\_permalink($post->ID); |
  | 913 |  | foreach ($post\_categories as $key => $category) { |
  | 914 |  | $post\_categories[$key] = $category->slug; |
  | 915 |  | } |
  | 916 |  |  |
  | 917 |  | if (in\_array((string) $post->ID, $post\_exceptions, true)) { |
  | 918 |  | return $content; |
  | 919 |  | } |
  | 920 |  |  |
  | 921 |  | if (count(array\_intersect($category\_exceptions, $post\_categories))) { |
  | 922 |  | return $content; |
  | 923 |  | } |
  | 924 |  |  |
  | 925 |  | // post type exceptions |
  | 926 |  | $post\_type\_exceptions = explode(',', $this->settings['post\_type\_exceptions']); |
  | 927 |  | $post\_type\_exceptions = array\_map('trim', $post\_type\_exceptions); |
  | 928 |  | if (in\_array((string) $post->post\_type, $post\_type\_exceptions, true)) { |
  | 929 |  | return $content; |
  | 930 |  | } |
  | 931 |  |  |
  | 932 |  | // post type by URL exceptions |
  | 933 |  | $post\_type\_by\_url = (isset($this->settings['post\_type\_by\_url\_exceptions']) && $this->settings['post\_type\_by\_url\_exceptions'] != '') ? $this->settings['post\_type\_by\_url\_exceptions'] : ''; |
  | 934 |  | if ($post\_type\_by\_url != '') { |
  | 935 |  | $post\_type\_by\_url\_exceptions = explode(',', $this->settings['post\_type\_by\_url\_exceptions']); |
  | 936 |  | $post\_type\_by\_url\_exceptions = array\_map('trim', $post\_type\_by\_url\_exceptions); |
  | 937 |  | if ($post\_type\_by\_url\_exceptions != '') { |
  | 938 |  | foreach ($post\_type\_by\_url\_exceptions as $key => $post\_type) { |
  | 939 |  | $result = strpos($post\_url, $post\_type); |
  | 940 |  | if ($result !== false) { |
  | 941 |  | return $content; |
  | 942 |  | break; |
  | 943 |  | } |
  | 944 |  | } |
  | 945 |  | } |
  | 946 |  | } |
  | 947 |  | ob\_start(); |
  | 948 |  | $vuukle = $this; |
  | 949 |  | $vuukle->settings = get\_option($vuukle->settings\_name); |
  | 950 |  | include VUUKLE\_INCLUDES\_PATH . '/vuukleplatform.php'; |
  | 951 |  | $commentbox = ob\_get\_contents(); |
  | 952 |  | ob\_end\_clean(); |
  | 953 |  | $content .= $commentbox; |
  | 954 |  | echo $content; |
  | 955 |  | return $content; |
  | 956 |  | } |
  | 957 |  |  |
  | 958 |  | /\*\* |
  | 959 |  | \* This function replaces WORDPRESS comments. |
  | 960 |  | \* |
  | 961 |  | \* @param string $file this is a file |
  | 962 |  | \* |
  | 963 |  | \* @since  1.0.0. |
  | 964 |  | \* @return string |
  | 965 |  | \*/ |
  | 966 |  | public function replaceWordpressComments($file) |
  | 967 |  | { |
  | 968 |  | global $post; |
  | 969 |  |  |
  | 970 |  | $post\_exceptions = explode(',', $this->settings['post\_exceptions']); |
  | 971 |  | $post\_exceptions = array\_map('trim', $post\_exceptions); |
  | 972 |  |  |
  | 973 |  | $category\_exceptions = explode(',', $this->settings['category\_exceptions']); |
  | 974 |  | $category\_exceptions = array\_map('trim', $category\_exceptions); |
  | 975 |  | $post\_categories     = get\_the\_category($post->ID); |
  | 976 |  | $post\_url            = get\_permalink($post->ID); |
  | 977 |  | foreach ($post\_categories as $key => $category) { |
  | 978 |  | $post\_categories[$key] = $category->slug; |
  | 979 |  | } |
  | 980 |  |  |
  | 981 |  | if (empty($content)) { |
  | 982 |  | $content = ''; |
  | 983 |  | } |
  | 984 |  |  |
  | 985 |  | if (in\_array((string) $post->ID, $post\_exceptions, true)) { |
  | 986 |  | return $content; |
  | 987 |  | } |
  | 988 |  |  |
  | 989 |  | if (count(array\_intersect($category\_exceptions, $post\_categories))) { |
  | 990 |  | return $content; |
  | 991 |  | } |
  | 992 |  |  |
  | 993 |  | // post type exceptions |
  | 994 |  | $post\_type\_exceptions = explode(',', $this->settings['post\_type\_exceptions']); |
  | 995 |  | $post\_type\_exceptions = array\_map('trim', $post\_type\_exceptions); |
  | 996 |  | if (in\_array((string) $post->post\_type, $post\_type\_exceptions, true)) { |
  | 997 |  | return $content; |
  | 998 |  | } |
  | 999 |  |  |
  | 1000 |  | // post type by URL exceptions |
  | 1001 |  | $post\_type\_by\_url = (isset($this->settings['post\_type\_by\_url\_exceptions']) && $this->settings['post\_type\_by\_url\_exceptions'] != '') ? $this->settings['post\_type\_by\_url\_exceptions'] : ''; |
  | 1002 |  | if ($post\_type\_by\_url != '') { |
  | 1003 |  | $post\_type\_by\_url\_exceptions = explode(',', $this->settings['post\_type\_by\_url\_exceptions']); |
  | 1004 |  | $post\_type\_by\_url\_exceptions = array\_map('trim', $post\_type\_by\_url\_exceptions); |
  | 1005 |  | if ($post\_type\_by\_url\_exceptions != '') { |
  | 1006 |  | foreach ($post\_type\_by\_url\_exceptions as $key => $post\_type) { |
  | 1007 |  | $result = strpos($post\_url, $post\_type); |
  | 1008 |  | if ($result !== false) { |
  | 1009 |  | return $content; |
  | 1010 |  | break; |
  | 1011 |  | } |
  | 1012 |  | } |
  | 1013 |  | } |
  | 1014 |  | } |
  | 1015 |  |  |
  | 1016 |  | $vuukle = $this; |
  | 1017 |  | $comments\_file = VUUKLE\_INCLUDES\_PATH . '/commentbox.php'; |
  | 1018 |  |  |
  | 1019 |  | if (is\_single()) { |
  | 1020 |  | if ($this->settings['AppId'] && file\_exists($comments\_file)) { |
  | 1021 |  | $file = $comments\_file; |
  | 1022 |  | } |
  | 1023 |  | } |
  | 1024 |  | return $file; |
  | 1025 |  | } |
  | 1026 |  |  |
  | 1027 |  | /\*\* |
  | 1028 |  | \* This function for comments template. |
  | 1029 |  | \* |
  | 1030 |  | \* @param string $file template |
  | 1031 |  | \* |
  | 1032 |  | \* @since  1.0.0. |
  | 1033 |  | \* @return string |
  | 1034 |  | \*/ |
  | 1035 |  | public function commentsTemplate($file) |
  | 1036 |  | { |
  | 1037 |  | global $post; |
  | 1038 |  |  |
  | 1039 |  | $post\_exceptions = explode(',', $this->settings['post\_exceptions']); |
  | 1040 |  | $post\_exceptions = array\_map('trim', $post\_exceptions); |
  | 1041 |  | $category\_exceptions = explode(',', $this->settings['category\_exceptions']); |
  | 1042 |  | $category\_exceptions = array\_map('trim', $category\_exceptions); |
  | 1043 |  | $post\_categories     = get\_the\_category($post->ID); |
  | 1044 |  | $post\_url = get\_permalink($post->ID); |
  | 1045 |  | foreach ($post\_categories as $key => $category) { |
  | 1046 |  | $post\_categories[$key] = $category->slug; |
  | 1047 |  | } |
  | 1048 |  |  |
  | 1049 |  | if (empty($content)) { |
  | 1050 |  | $content = ''; |
  | 1051 |  | } |
  | 1052 |  |  |
  | 1053 |  | if (in\_array((string) $post->ID, $post\_exceptions, true)) { |
  | 1054 |  | return $content; |
  | 1055 |  | } |
  | 1056 |  |  |
  | 1057 |  | if (count(array\_intersect($category\_exceptions, $post\_categories))) { |
  | 1058 |  | return $content; |
  | 1059 |  | } |
  | 1060 |  |  |
  | 1061 |  | // post type exceptions |
  | 1062 |  | $post\_type\_exceptions = explode(',', $this->settings['post\_type\_exceptions']); |
  | 1063 |  | $post\_type\_exceptions = array\_map('trim', $post\_type\_exceptions); |
  | 1064 |  | if (in\_array((string) $post->post\_type, $post\_type\_exceptions, true)) { |
  | 1065 |  | return $content; |
  | 1066 |  | } |
  | 1067 |  |  |
  | 1068 |  | // post type by URL exceptions |
  | 1069 |  | $post\_type\_by\_url = (isset($this->settings['post\_type\_by\_url\_exceptions']) && $this->settings['post\_type\_by\_url\_exceptions'] != '') ? $this->settings['post\_type\_by\_url\_exceptions'] : ''; |
  | 1070 |  | if ($post\_type\_by\_url != '') { |
  | 1071 |  | $post\_type\_by\_url\_exceptions = explode(',', $this->settings['post\_type\_by\_url\_exceptions']); |
  | 1072 |  | $post\_type\_by\_url\_exceptions = array\_map('trim', $post\_type\_by\_url\_exceptions); |
  | 1073 |  | if ($post\_type\_by\_url\_exceptions != '') { |
  | 1074 |  | foreach ($post\_type\_by\_url\_exceptions as $key => $post\_type) { |
  | 1075 |  | $result = strpos($post\_url, $post\_type); |
  | 1076 |  | if ($result !== false) { |
  | 1077 |  | return $content; |
  | 1078 |  | break; |
  | 1079 |  | } |
  | 1080 |  | } |
  | 1081 |  | } |
  | 1082 |  | } |
  | 1083 |  |  |
  | 1084 |  | $comments\_file = dirname(\_\_FILE\_\_) . DIRECTORY\_SEPARATOR . 'comments-empty.php'; |
  | 1085 |  |  |
  | 1086 |  | if (is\_single()) { |
  | 1087 |  | if ($this->settings['AppId'] && file\_exists($comments\_file)) { |
  | 1088 |  | $file = $comments\_file; |
  | 1089 |  | } |
  | 1090 |  | } |
  | 1091 |  | return $file; |
  | 1092 |  | } |
  | 1093 |  |  |
  | 1094 |  | public function addPostScript($content) |
  | 1095 |  | { |
  | 1096 |  | global $post; |
  | 1097 |  | $setting = $this->settings; |
  | 1098 |  |  |
  | 1099 |  | // get post atts |
  | 1100 |  | $post\_title     = isset($post->post\_title) && $post->post\_title ? $post->post\_title : ''; |
  | 1101 |  | $post\_excerpt   = isset($post->post\_excerpt) && $post->post\_excerpt ? $post->post\_excerpt : ''; |
  | 1102 |  | $post\_date      = isset($post->post\_date) && $post->post\_date ? $post->post\_date : ''; |
  | 1103 |  | $post\_modified  = isset($post->post\_modified) && $post->post\_modified ? $post->post\_modified : ''; |
  | 1104 |  | $post\_author\_id = isset($post->post\_author) && $post->post\_author ? $post->post\_author : ''; |
  | 1105 |  | $post\_content   = isset($post->post\_content) && $post->post\_content ? sanitize\_text\_field($post->post\_content) : ''; |
  | 1106 |  |  |
  | 1107 |  | // get custom option args organization |
  | 1108 |  | $org\_fb\_url        = isset($setting['vuukle\_facebook\_url']) && $setting['vuukle\_facebook\_url'] != '' ? $setting['vuukle\_facebook\_url'] : ''; |
  | 1109 |  | $org\_twitter\_url   = isset($setting['vuukle\_twitter\_url']) && $setting['vuukle\_twitter\_url'] != '' ? $setting['vuukle\_twitter\_url'] : ''; |
  | 1110 |  | $org\_linkedin\_url  = isset($setting['vuukle\_linkedin\_url']) && $setting['vuukle\_linkedin\_url'] != '' ? $setting['vuukle\_linkedin\_url'] : ''; |
  | 1111 |  | $org\_publisher\_url = isset($setting['vuukle\_publisher\_url']) && $setting['vuukle\_publisher\_url'] != '' ? $setting['vuukle\_publisher\_url'] : ''; |
  | 1112 |  |  |
  | 1113 |  | // get custom option args user |
  | 1114 |  | $user\_fb\_url       = isset($setting['vuukle\_user\_facebook\_url']) && $setting['vuukle\_user\_facebook\_url'] != '' ? $setting['vuukle\_user\_facebook\_url'] : ''; |
  | 1115 |  | $user\_twitter\_url  = isset($setting['vuukle\_user\_linkedin\_url']) && $setting['vuukle\_user\_linkedin\_url'] != '' ? $setting['vuukle\_user\_linkedin\_url'] : ''; |
  | 1116 |  | $user\_linkedin\_url = isset($setting['vuukle\_user\_twitter\_url']) && $setting['vuukle\_user\_twitter\_url'] != '' ? $setting['vuukle\_user\_twitter\_url'] : ''; |
  | 1117 |  |  |
  | 1118 |  | // get user data |
  | 1119 |  | $this\_post\_user    = get\_userdata(intval($post\_author\_id)); |
  | 1120 |  | $get\_this\_site\_url = get\_site\_url(); |
  | 1121 |  | $current\_site\_name = get\_bloginfo($get\_this\_site\_url); |
  | 1122 |  |  |
  | 1123 |  | // get featured image |
  | 1124 |  | $image\_url    = ''; |
  | 1125 |  | $image\_width  = ''; |
  | 1126 |  | $image\_height = ''; |
  | 1127 |  | $image = wp\_get\_attachment\_image\_src(get\_post\_thumbnail\_id($post->ID), 'full'); |
  | 1128 |  | if (!empty($image)) { |
  | 1129 |  | $image\_url    = isset($image[0]) && $image[0] != '' ? $image[0] : ''; |
  | 1130 |  | $image\_width  = isset($image[1]) && $image[1] != '' ? $image[1] : ''; |
  | 1131 |  | $image\_height = isset($image[2]) && $image[2] != '' ? $image[2] : ''; |
  | 1132 |  | } |
  | 1133 |  |  |
  | 1134 |  | // get logo |
  | 1135 |  | $logo\_img     = ''; |
  | 1136 |  | $logo\_img\_url = ''; |
  | 1137 |  | $logo\_img\_id  = get\_theme\_mod('custom\_logo'); |
  | 1138 |  | if ($logo\_img\_id) { |
  | 1139 |  | $logo\_img = wp\_get\_attachment\_image\_src($logo\_img\_id, 'full'); |
  | 1140 |  | if (!empty($logo\_img)) { |
  | 1141 |  | $logo\_img\_url = isset($logo\_img[0]) && $logo\_img[0] != '' ? $logo\_img[0] : ''; |
  | 1142 |  | } |
  | 1143 |  | } |
  | 1144 |  |  |
  | 1145 |  | // get user name |
  | 1146 |  | $this\_user\_name = ''; |
  | 1147 |  | if ($this\_post\_user !== null) { |
  | 1148 |  | $this\_user\_name = isset($this\_post\_user->data->display\_name) && $this\_post\_user->data->display\_name != '' ? $this\_post\_user->data->display\_name : ''; |
  | 1149 |  | } |
  | 1150 |  |  |
  | 1151 |  | $my\_content\_obj = array( |
  | 1152 |  | "@context" => "https://schema.org", |
  | 1153 |  | "@type"    => "Article", |
  | 1154 |  | ); |
  | 1155 |  | if (function\_exists("amp\_is\_request") && amp\_is\_request()) { |
  | 1156 |  | $my\_content\_obj["mainEntityOfPage"] = array( |
  | 1157 |  | "@type" => "WebPage", |
  | 1158 |  | "@id" => get\_permalink($post->ID), |
  | 1159 |  | ); |
  | 1160 |  | } |
  | 1161 |  |  |
  | 1162 |  | if ($post\_title != '') { |
  | 1163 |  | $my\_content\_obj["headline"] = $post\_title; |
  | 1164 |  | } |
  | 1165 |  |  |
  | 1166 |  | if ($post\_excerpt != '') { |
  | 1167 |  | $my\_content\_obj["description"] = $post\_excerpt; |
  | 1168 |  | } |
  | 1169 |  |  |
  | 1170 |  | if ($post\_date != '') { |
  | 1171 |  | $my\_content\_obj["datePublished"] = substr($post\_date, 0, 10); |
  | 1172 |  | } |
  | 1173 |  |  |
  | 1174 |  | if ($post\_modified != '') { |
  | 1175 |  | $my\_content\_obj["datemodified"] = substr($post\_modified, 0, 10); |
  | 1176 |  | } |
  | 1177 |  |  |
  | 1178 |  | $my\_content\_obj["image"] = array( |
  | 1179 |  | "@type"  => "imageObject", |
  | 1180 |  | "url"    => $image\_url, |
  | 1181 |  | "height" => $image\_height, |
  | 1182 |  | "width"  => $image\_width, |
  | 1183 |  | ); |
  | 1184 |  | $my\_content\_obj["publisher"] = array( |
  | 1185 |  | "@type" => "Organization", |
  | 1186 |  | ); |
  | 1187 |  | if ($current\_site\_name != '') { |
  | 1188 |  | $my\_content\_obj["publisher"]["name"] = $current\_site\_name; |
  | 1189 |  | } |
  | 1190 |  | $my\_content\_obj["publisher"]["sameAs"] = array( |
  | 1191 |  | $org\_fb\_url, |
  | 1192 |  | $org\_twitter\_url, |
  | 1193 |  | $org\_linkedin\_url, |
  | 1194 |  | ); |
  | 1195 |  | // $my\_content\_obj["publisher"]["logo"] = array( |
  | 1196 |  | //     "@type" => "imageObject", |
  | 1197 |  | //     "url" => $logo\_img\_url, |
  | 1198 |  | // ); |
  | 1199 |  | $my\_content\_obj["publisher"]["logo"] = array( |
  | 1200 |  | "@type" => "imageObject", |
  | 1201 |  | "url" => $org\_publisher\_url, |
  | 1202 |  | ); |
  | 1203 |  | $my\_content\_obj["author"] = array( |
  | 1204 |  | "@type" => "Person", |
  | 1205 |  | ); |
  | 1206 |  | if ($this\_user\_name != '') { |
  | 1207 |  | $my\_content\_obj["author"]['name'] = $this\_user\_name; |
  | 1208 |  | } |
  | 1209 |  | $my\_content\_obj["author"]['sameAs'] = array( |
  | 1210 |  | $user\_fb\_url, |
  | 1211 |  | $user\_twitter\_url, |
  | 1212 |  | $user\_linkedin\_url, |
  | 1213 |  | ); |
  | 1214 |  | $my\_content\_obj["articleBody"] = $post\_content; |
  | 1215 |  | $my\_content = json\_encode($my\_content\_obj); |
  | 1216 |  |  |
  | 1217 |  | $my\_content = '<script type="application/ld+json" >' . ($my\_content) . '</script>'; |
  | 1218 |  | $content .= $my\_content; |
  | 1219 |  |  |
  | 1220 |  | return $content; |
  | 1221 |  | } |
  | 1222 |  |  |
  | 1223 |  | public function track\_page\_view() |
  | 1224 |  | { |
  | 1225 |  | $setting = $this->settings; |
  | 1226 |  | $api\_key = isset($setting['AppId']) && $setting['AppId'] != '' ? $setting['AppId'] : ''; |
  | 1227 |  | $content = ''; |
  | 1228 |  | $check\_page = is\_single(); |
  | 1229 |  | if (!$check\_page) { |
  | 1230 |  | $content .= "<script data-cfasync='false'> |
  |  | 759 | if ( has\_post\_thumbnail() ) { |
  |  | 760 | $tags .= '<meta property="og:image" content="' . get\_the\_post\_thumbnail\_url() . '" />'; |
  |  | 761 | } |
  |  | 762 | echo $tags; |
  |  | 763 | } |
  |  | 764 |  |
  |  | 765 | /\*\* |
  |  | 766 | \* This function creates a VUUKLE platform. |
  |  | 767 | \* |
  |  | 768 | \* @param   string  $content  this is a content |
  |  | 769 | \* |
  |  | 770 | \* @return string |
  |  | 771 | \* @since  1.0.0. |
  |  | 772 | \*/ |
  |  | 773 | public function createVuuklePlatform( $content ) { |
  |  | 774 | if ( ! is\_single() ) { |
  |  | 775 | return $content; |
  |  | 776 | } |
  |  | 777 | if ( ! is\_singular() ) { |
  |  | 778 | return $content; |
  |  | 779 | } |
  |  | 780 | if ( ! is\_main\_query() ) { |
  |  | 781 | return $content; |
  |  | 782 | } |
  |  | 783 | global $post; |
  |  | 784 | $post\_exceptions     = explode( ',', $this->settings['post\_exceptions'] ); |
  |  | 785 | $post\_exceptions     = array\_map( 'trim', $post\_exceptions ); |
  |  | 786 | $category\_exceptions = explode( ',', $this->settings['category\_exceptions'] ); |
  |  | 787 | $category\_exceptions = array\_map( 'trim', $category\_exceptions ); |
  |  | 788 | $post\_categories     = get\_the\_category( $post->ID ); |
  |  | 789 | $post\_url            = get\_permalink( $post->ID ); |
  |  | 790 | foreach ( $post\_categories as $key => $category ) { |
  |  | 791 | $post\_categories[ $key ] = $category->slug; |
  |  | 792 | } |
  |  | 793 | if ( in\_array( (string) $post->ID, $post\_exceptions, true ) ) { |
  |  | 794 | return $content; |
  |  | 795 | } |
  |  | 796 | if ( count( array\_intersect( $category\_exceptions, $post\_categories ) ) ) { |
  |  | 797 | return $content; |
  |  | 798 | } |
  |  | 799 | // post type exceptions |
  |  | 800 | $post\_type\_exceptions = explode( ',', $this->settings['post\_type\_exceptions'] ); |
  |  | 801 | $post\_type\_exceptions = array\_map( 'trim', $post\_type\_exceptions ); |
  |  | 802 | if ( in\_array( (string) $post->post\_type, $post\_type\_exceptions, true ) ) { |
  |  | 803 | return $content; |
  |  | 804 | } |
  |  | 805 | // post type by URL exceptions |
  |  | 806 | $post\_type\_by\_url = ( isset( $this->settings['post\_type\_by\_url\_exceptions'] ) && $this->settings['post\_type\_by\_url\_exceptions'] != '' ) ? $this->settings['post\_type\_by\_url\_exceptions'] : ''; |
  |  | 807 | if ( $post\_type\_by\_url != '' ) { |
  |  | 808 | $post\_type\_by\_url\_exceptions = explode( ',', $this->settings['post\_type\_by\_url\_exceptions'] ); |
  |  | 809 | $post\_type\_by\_url\_exceptions = array\_map( 'trim', $post\_type\_by\_url\_exceptions ); |
  |  | 810 | if ( $post\_type\_by\_url\_exceptions != '' ) { |
  |  | 811 | foreach ( $post\_type\_by\_url\_exceptions as $key => $post\_type ) { |
  |  | 812 | $result = strpos( $post\_url, $post\_type ); |
  |  | 813 | if ( $result !== false ) { |
  |  | 814 | return $content; |
  |  | 815 | break; |
  |  | 816 | } |
  |  | 817 | } |
  |  | 818 | } |
  |  | 819 | } |
  |  | 820 | ob\_start(); |
  |  | 821 | $vuukle           = $this; |
  |  | 822 | $vuukle->settings = get\_option( $vuukle->settings\_name ); |
  |  | 823 | if ( is\_array( $vuukle->settings ) ) { |
  |  | 824 | $settings         = array\_merge( $this->settings\_defaults, $this->settings ); |
  |  | 825 | $settings         = array\_intersect\_key( $settings, $this->settings\_defaults ); |
  |  | 826 | $vuukle->settings = $settings; |
  |  | 827 | } |
  |  | 828 | include VUUKLE\_INCLUDES\_PATH . '/vuukleplatform.php'; |
  |  | 829 | $commentbox = ob\_get\_contents(); |
  |  | 830 | ob\_end\_clean(); |
  |  | 831 | $content .= $commentbox; |
  |  | 832 | echo $content; |
  |  | 833 |  |
  |  | 834 | return $content; |
  |  | 835 | } |
  |  | 836 |  |
  |  | 837 | /\*\* |
  |  | 838 | \* This function replaces WORDPRESS comments. |
  |  | 839 | \* |
  |  | 840 | \* @param   string  $file  this is a file |
  |  | 841 | \* |
  |  | 842 | \* @return string |
  |  | 843 | \* @since  1.0.0. |
  |  | 844 | \*/ |
  |  | 845 | public function replaceWordpressComments( $file ) { |
  |  | 846 | global $post; |
  |  | 847 | $post\_exceptions     = explode( ',', $this->settings['post\_exceptions'] ); |
  |  | 848 | $post\_exceptions     = array\_map( 'trim', $post\_exceptions ); |
  |  | 849 | $category\_exceptions = explode( ',', $this->settings['category\_exceptions'] ); |
  |  | 850 | $category\_exceptions = array\_map( 'trim', $category\_exceptions ); |
  |  | 851 | $post\_categories     = get\_the\_category( $post->ID ); |
  |  | 852 | $post\_url            = get\_permalink( $post->ID ); |
  |  | 853 | foreach ( $post\_categories as $key => $category ) { |
  |  | 854 | $post\_categories[ $key ] = $category->slug; |
  |  | 855 | } |
  |  | 856 | if ( empty( $content ) ) { |
  |  | 857 | $content = ''; |
  |  | 858 | } |
  |  | 859 | if ( in\_array( (string) $post->ID, $post\_exceptions, true ) ) { |
  |  | 860 | return $content; |
  |  | 861 | } |
  |  | 862 | if ( count( array\_intersect( $category\_exceptions, $post\_categories ) ) ) { |
  |  | 863 | return $content; |
  |  | 864 | } |
  |  | 865 | // post type exceptions |
  |  | 866 | $post\_type\_exceptions = explode( ',', $this->settings['post\_type\_exceptions'] ); |
  |  | 867 | $post\_type\_exceptions = array\_map( 'trim', $post\_type\_exceptions ); |
  |  | 868 | if ( in\_array( (string) $post->post\_type, $post\_type\_exceptions, true ) ) { |
  |  | 869 | return $content; |
  |  | 870 | } |
  |  | 871 | // post type by URL exceptions |
  |  | 872 | $post\_type\_by\_url = ( isset( $this->settings['post\_type\_by\_url\_exceptions'] ) && $this->settings['post\_type\_by\_url\_exceptions'] != '' ) ? $this->settings['post\_type\_by\_url\_exceptions'] : ''; |
  |  | 873 | if ( $post\_type\_by\_url != '' ) { |
  |  | 874 | $post\_type\_by\_url\_exceptions = explode( ',', $this->settings['post\_type\_by\_url\_exceptions'] ); |
  |  | 875 | $post\_type\_by\_url\_exceptions = array\_map( 'trim', $post\_type\_by\_url\_exceptions ); |
  |  | 876 | if ( $post\_type\_by\_url\_exceptions != '' ) { |
  |  | 877 | foreach ( $post\_type\_by\_url\_exceptions as $key => $post\_type ) { |
  |  | 878 | $result = strpos( $post\_url, $post\_type ); |
  |  | 879 | if ( $result !== false ) { |
  |  | 880 | return $content; |
  |  | 881 | break; |
  |  | 882 | } |
  |  | 883 | } |
  |  | 884 | } |
  |  | 885 | } |
  |  | 886 | $vuukle        = $this; |
  |  | 887 | $comments\_file = VUUKLE\_INCLUDES\_PATH . '/commentbox.php'; |
  |  | 888 | if ( is\_single() ) { |
  |  | 889 | if ( $this->settings['AppId'] && file\_exists( $comments\_file ) ) { |
  |  | 890 | $file = $comments\_file; |
  |  | 891 | } |
  |  | 892 | } |
  |  | 893 |  |
  |  | 894 | return $file; |
  |  | 895 | } |
  |  | 896 |  |
  |  | 897 | /\*\* |
  |  | 898 | \* This function for comments template. |
  |  | 899 | \* |
  |  | 900 | \* @param   string  $file  template |
  |  | 901 | \* |
  |  | 902 | \* @return string |
  |  | 903 | \* @since  1.0.0. |
  |  | 904 | \*/ |
  |  | 905 | public function commentsTemplate( $file ) { |
  |  | 906 | global $post; |
  |  | 907 | $post\_exceptions     = explode( ',', $this->settings['post\_exceptions'] ); |
  |  | 908 | $post\_exceptions     = array\_map( 'trim', $post\_exceptions ); |
  |  | 909 | $category\_exceptions = explode( ',', $this->settings['category\_exceptions'] ); |
  |  | 910 | $category\_exceptions = array\_map( 'trim', $category\_exceptions ); |
  |  | 911 | $post\_categories     = get\_the\_category( $post->ID ); |
  |  | 912 | $post\_url            = get\_permalink( $post->ID ); |
  |  | 913 | foreach ( $post\_categories as $key => $category ) { |
  |  | 914 | $post\_categories[ $key ] = $category->slug; |
  |  | 915 | } |
  |  | 916 | if ( empty( $content ) ) { |
  |  | 917 | $content = ''; |
  |  | 918 | } |
  |  | 919 | if ( in\_array( (string) $post->ID, $post\_exceptions, true ) ) { |
  |  | 920 | return $content; |
  |  | 921 | } |
  |  | 922 | if ( count( array\_intersect( $category\_exceptions, $post\_categories ) ) ) { |
  |  | 923 | return $content; |
  |  | 924 | } |
  |  | 925 | // post type exceptions |
  |  | 926 | $post\_type\_exceptions = explode( ',', $this->settings['post\_type\_exceptions'] ); |
  |  | 927 | $post\_type\_exceptions = array\_map( 'trim', $post\_type\_exceptions ); |
  |  | 928 | if ( in\_array( (string) $post->post\_type, $post\_type\_exceptions, true ) ) { |
  |  | 929 | return $content; |
  |  | 930 | } |
  |  | 931 | // post type by URL exceptions |
  |  | 932 | $post\_type\_by\_url = ( isset( $this->settings['post\_type\_by\_url\_exceptions'] ) && $this->settings['post\_type\_by\_url\_exceptions'] != '' ) ? $this->settings['post\_type\_by\_url\_exceptions'] : ''; |
  |  | 933 | if ( $post\_type\_by\_url != '' ) { |
  |  | 934 | $post\_type\_by\_url\_exceptions = explode( ',', $this->settings['post\_type\_by\_url\_exceptions'] ); |
  |  | 935 | $post\_type\_by\_url\_exceptions = array\_map( 'trim', $post\_type\_by\_url\_exceptions ); |
  |  | 936 | if ( $post\_type\_by\_url\_exceptions != '' ) { |
  |  | 937 | foreach ( $post\_type\_by\_url\_exceptions as $key => $post\_type ) { |
  |  | 938 | $result = strpos( $post\_url, $post\_type ); |
  |  | 939 | if ( $result !== false ) { |
  |  | 940 | return $content; |
  |  | 941 | break; |
  |  | 942 | } |
  |  | 943 | } |
  |  | 944 | } |
  |  | 945 | } |
  |  | 946 | $comments\_file = dirname( \_\_FILE\_\_ ) . DIRECTORY\_SEPARATOR . 'comments-empty.php'; |
  |  | 947 | if ( is\_single() ) { |
  |  | 948 | if ( $this->settings['AppId'] && file\_exists( $comments\_file ) ) { |
  |  | 949 | $file = $comments\_file; |
  |  | 950 | } |
  |  | 951 | } |
  |  | 952 |  |
  |  | 953 | return $file; |
  |  | 954 | } |
  |  | 955 |  |
  |  | 956 | public function addPostScript( $content ) { |
  |  | 957 | global $post; |
  |  | 958 | $setting = $this->settings; |
  |  | 959 | // get post atts |
  |  | 960 | $post\_title     = isset( $post->post\_title ) && $post->post\_title ? $post->post\_title : ''; |
  |  | 961 | $post\_excerpt   = isset( $post->post\_excerpt ) && $post->post\_excerpt ? $post->post\_excerpt : ''; |
  |  | 962 | $post\_date      = isset( $post->post\_date ) && $post->post\_date ? $post->post\_date : ''; |
  |  | 963 | $post\_modified  = isset( $post->post\_modified ) && $post->post\_modified ? $post->post\_modified : ''; |
  |  | 964 | $post\_author\_id = isset( $post->post\_author ) && $post->post\_author ? $post->post\_author : ''; |
  |  | 965 | $post\_content   = isset( $post->post\_content ) && $post->post\_content ? sanitize\_text\_field( $post->post\_content ) : ''; |
  |  | 966 | // get custom option args user |
  |  | 967 | $user\_fb\_url       = isset( $setting['vuukle\_user\_facebook\_url'] ) && $setting['vuukle\_user\_facebook\_url'] != '' ? $setting['vuukle\_user\_facebook\_url'] : ''; |
  |  | 968 | $user\_twitter\_url  = isset( $setting['vuukle\_user\_linkedin\_url'] ) && $setting['vuukle\_user\_linkedin\_url'] != '' ? $setting['vuukle\_user\_linkedin\_url'] : ''; |
  |  | 969 | $user\_linkedin\_url = isset( $setting['vuukle\_user\_twitter\_url'] ) && $setting['vuukle\_user\_twitter\_url'] != '' ? $setting['vuukle\_user\_twitter\_url'] : ''; |
  |  | 970 | // get user data |
  |  | 971 | $this\_post\_user    = get\_userdata( intval( $post\_author\_id ) ); |
  |  | 972 | $get\_this\_site\_url = get\_site\_url(); |
  |  | 973 | $current\_site\_name = get\_bloginfo( $get\_this\_site\_url ); |
  |  | 974 | // get featured image |
  |  | 975 | $image\_url    = ''; |
  |  | 976 | $image\_width  = ''; |
  |  | 977 | $image\_height = ''; |
  |  | 978 | $image        = wp\_get\_attachment\_image\_src( get\_post\_thumbnail\_id( $post->ID ), 'full' ); |
  |  | 979 | if ( ! empty( $image ) ) { |
  |  | 980 | $image\_url    = isset( $image[0] ) && $image[0] != '' ? $image[0] : ''; |
  |  | 981 | $image\_width  = isset( $image[1] ) && $image[1] != '' ? $image[1] : ''; |
  |  | 982 | $image\_height = isset( $image[2] ) && $image[2] != '' ? $image[2] : ''; |
  |  | 983 | } |
  |  | 984 | // get logo |
  |  | 985 | $logo\_img     = ''; |
  |  | 986 | $logo\_img\_url = ''; |
  |  | 987 | $logo\_img\_id  = get\_theme\_mod( 'custom\_logo' ); |
  |  | 988 | if ( $logo\_img\_id ) { |
  |  | 989 | $logo\_img = wp\_get\_attachment\_image\_src( $logo\_img\_id, 'full' ); |
  |  | 990 | if ( ! empty( $logo\_img ) ) { |
  |  | 991 | $logo\_img\_url = isset( $logo\_img[0] ) && $logo\_img[0] != '' ? $logo\_img[0] : ''; |
  |  | 992 | } |
  |  | 993 | } |
  |  | 994 | // get user name |
  |  | 995 | $this\_user\_name = ''; |
  |  | 996 | if ( $this\_post\_user !== null ) { |
  |  | 997 | $this\_user\_name = isset( $this\_post\_user->data->display\_name ) && $this\_post\_user->data->display\_name != '' ? $this\_post\_user->data->display\_name : ''; |
  |  | 998 | } |
  |  | 999 | $my\_content\_obj = array( |
  |  | 1000 | "@context" => "https://schema.org", |
  |  | 1001 | "@type"    => "Article", |
  |  | 1002 | ); |
  |  | 1003 | if ( function\_exists( "amp\_is\_request" ) && amp\_is\_request() ) { |
  |  | 1004 | $my\_content\_obj["mainEntityOfPage"] = array( |
  |  | 1005 | "@type" => "WebPage", |
  |  | 1006 | "@id"   => get\_permalink( $post->ID ), |
  |  | 1007 | ); |
  |  | 1008 | } |
  |  | 1009 | if ( $post\_title != '' ) { |
  |  | 1010 | $my\_content\_obj["headline"] = $post\_title; |
  |  | 1011 | } |
  |  | 1012 | if ( $post\_excerpt != '' ) { |
  |  | 1013 | $my\_content\_obj["description"] = $post\_excerpt; |
  |  | 1014 | } |
  |  | 1015 | if ( $post\_date != '' ) { |
  |  | 1016 | $my\_content\_obj["datePublished"] = substr( $post\_date, 0, 10 ); |
  |  | 1017 | } |
  |  | 1018 | if ( $post\_modified != '' ) { |
  |  | 1019 | $my\_content\_obj["datemodified"] = substr( $post\_modified, 0, 10 ); |
  |  | 1020 | } |
  |  | 1021 | $my\_content\_obj["image"]     = array( |
  |  | 1022 | "@type"  => "imageObject", |
  |  | 1023 | "url"    => $image\_url, |
  |  | 1024 | "height" => $image\_height, |
  |  | 1025 | "width"  => $image\_width, |
  |  | 1026 | ); |
  |  | 1027 | $my\_content\_obj["publisher"] = array( |
  |  | 1028 | "@type" => "Organization", |
  |  | 1029 | ); |
  |  | 1030 | if ( $current\_site\_name != '' ) { |
  |  | 1031 | $my\_content\_obj["publisher"]["name"] = $current\_site\_name; |
  |  | 1032 | } |
  |  | 1033 | $my\_content\_obj["publisher"]["sameAs"] = array( |
  |  | 1034 | $org\_fb\_url, |
  |  | 1035 | $org\_twitter\_url, |
  |  | 1036 | $org\_linkedin\_url, |
  |  | 1037 | ); |
  |  | 1038 | // $my\_content\_obj["publisher"]["logo"] = array( |
  |  | 1039 | //     "@type" => "imageObject", |
  |  | 1040 | //     "url" => $logo\_img\_url, |
  |  | 1041 | // ); |
  |  | 1042 | $my\_content\_obj["publisher"]["logo"] = array( |
  |  | 1043 | "@type" => "imageObject", |
  |  | 1044 | "url"   => $org\_publisher\_url, |
  |  | 1045 | ); |
  |  | 1046 | $my\_content\_obj["author"]            = array( |
  |  | 1047 | "@type" => "Person", |
  |  | 1048 | ); |
  |  | 1049 | if ( $this\_user\_name != '' ) { |
  |  | 1050 | $my\_content\_obj["author"]['name'] = $this\_user\_name; |
  |  | 1051 | } |
  |  | 1052 | $my\_content\_obj["author"]['sameAs'] = array( |
  |  | 1053 | $user\_fb\_url, |
  |  | 1054 | $user\_twitter\_url, |
  |  | 1055 | $user\_linkedin\_url, |
  |  | 1056 | ); |
  |  | 1057 | $my\_content\_obj["articleBody"]      = $post\_content; |
  |  | 1058 | $my\_content                         = json\_encode( $my\_content\_obj ); |
  |  | 1059 | $my\_content                         = '<script type="application/ld+json" >' . ( $my\_content ) . '</script>'; |
  |  | 1060 | $content                            .= $my\_content; |
  |  | 1061 |  |
  |  | 1062 | return $content; |
  |  | 1063 | } |
  |  | 1064 |  |
  |  | 1065 | public function track\_page\_view() { |
  |  | 1066 | $setting    = $this->settings; |
  |  | 1067 | $api\_key    = isset( $setting['AppId'] ) && $setting['AppId'] != '' ? $setting['AppId'] : ''; |
  |  | 1068 | $content    = ''; |
  |  | 1069 | $check\_page = is\_single(); |
  |  | 1070 | if ( ! $check\_page ) { |
  |  | 1071 | $content .= "<script data-cfasync='false'> |
  | 1231 | 1072 | var VUUKLE\_CONFIG = { |
  | 1232 | 1073 | apiKey: '" . $api\_key . "', |
  | […](/browser/free-comments-for-wordpress-vuukle/trunk/public/class-free-comments-for-wordpress-vuukle-public.php?rev=2533938#L1246) | […](/browser/free-comments-for-wordpress-vuukle/trunk/public/class-free-comments-for-wordpress-vuukle-public.php?rev=2553337#L1087) |  |
  | 1246 | 1087 | (); |
  | 1247 | 1088 | </script>"; |
  | 1248 |  | } |
  | 1249 |  |  |
  | 1250 |  | echo $content; |
  | 1251 |  | } |
  |  | 1089 | } |
  |  | 1090 | echo $content; |
  |  | 1091 | } |
  | 1252 | 1092 | } |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=2553337)
* [Zip Archive](?format=zip&new=2553337)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from blog.nintechnet.com_5b527821_20250111_082559.html ===

[![NinTechNet](https://blog.nintechnet.com/wp-content/uploads/2018/07/nintechnet_logo.png)](https://nintechnet.com/)

[NinTechNet](https://nintechnet.com/ "Back to NinTechNet's home")

The Ninja Technologies Network

[Skip to content](#content)
[Menu](#header-menu-responsive)

* [Blog Summary](https://blog.nintechnet.com/)
* [NinTechNet’s Home](https://nintechnet.com/)

# More WordPress plugins and themes vulnerable to CSRF attacks.

* by [Jerome Bruandet](https://blog.nintechnet.com/author/bruandet/)
* Posted on [September 26, 2020 - 7:59pm [+0700]January 21, 2021 - 6:19pm [+0700]](https://blog.nintechnet.com/more-wordpress-plugins-and-themes-vulnerable-to-csrf-attacks/)

*Last revision: November 16, 2020*

This is an addendum to our previous post [25 WordPress plugins vulnerable to CSRF attacks](https://blog.nintechnet.com/25-wordpress-plugins-vulnerable-to-csrf-attacks/). As we have reported additional WordPress plugins and themes that were vulnerable to CSRF attacks, we’ll update this post when they will be fixed by their respective authors.

### Vulnerable Plugins

1. [Ocean Extra](https://wordpress.org/plugins/ocean-extra/) (600,000+ installations).

Vulnerable version: 1.6.5 and below.

Vulnerable nonces: includes/panel/updater.php L247, L564, L637 and L934:

```
247   if (!current_user_can('manage_options') ||(isset($_REQUEST['_wpnonce'])&& !wp_verify_nonce($_REQUEST['_wpnonce'], 'oceanwp_options-options')))
248	   return;
...
...
564   if (!current_user_can('manage_options') || (isset($_REQUEST['_wpnonce'])&&!wp_verify_nonce($_REQUEST['_wpnonce'], 'oceanwp_options-options')))
565	   return;
..
..
637   if (!current_user_can('manage_options') || (isset($_REQUEST['_wpnonce'])&&!wp_verify_nonce($_REQUEST['_wpnonce'], 'oceanwp_options-options')))
638	   return;
...
...
934   if (!current_user_can('manage_options') || (isset($_REQUEST['_wpnonce'])&&!wp_verify_nonce($_REQUEST['_wpnonce'], 'changelog_link_nonce')))
935	   return;

```

If `$_REQUEST['_wpnonce']` is not set, it won’t be checked.

---

2. [EWWW Image Optimizer](https://wordpress.org/plugins/ewww-image-optimizer/) (800,000+ installations).

Vulnerable version: 5.8.1 and below.

Vulnerable nonces: classes/class-ewww-nextgen.php L858:

```
if ( empty( $_REQUEST['ewww_wpnonce'] ) && ! wp_verify_nonce( sanitize_key( $_REQUEST['ewww_wpnonce'] ), 'ewww-image-optimizer-bulk' ) || ! current_user_can( $permissions ) ) {
   $output['error'] = esc_html__( 'Access denied.', 'ewww-image-optimizer' );
   ewwwio_ob_clean();
   wp_die( wp_json_encode( $output ) );
}

```

If `$_REQUEST['ewww_wpnonce']` is not empty, it won’t be checked.

---

### Vulnerable Themes

1. [Customizr](https://wordpress.org/themes/customizr/) (70,000+ installations).

Vulnerable version: 4.3.0 and below.

Vulnerable nonces: core/czr-admin-ccat.php L1764, L1792, L2345 and L2559:

```
1763   // verify this came from our screen and with proper authorization,
1764   if ( isset( $_POST['post_layout_noncename']) && !wp_verify_nonce( $_POST['post_layout_noncename'], plugin_basename( __FILE__ ) ) )
1765      return;
...
...
1791   // verify this came from our screen and with proper authorization,
1792   if ( isset( $_POST['post_slider_noncename']) && !wp_verify_nonce( $_POST['post_slider_noncename'], plugin_basename( __FILE__ ) ) )
1793      return;
...
...
2342   // verify this came from our screen and with proper authorization,
2343   // because save_post can be triggered at other times
2344
2345   if ( isset( $_POST['slider_noncename']) && !wp_verify_nonce( $_POST['slider_noncename'], plugin_basename( __FILE__ ) ) )
2346      return;
...
...
2558   //We check the ajax nonce (common for post and attachment)
2559   if ( isset( $_POST['SliderCheckNonce']) && !wp_verify_nonce( $_POST['SliderCheckNonce'], 'tc-slider-check-nonce' ) )
2560      return;

```

In all 4 cases, if the security nonce is not set it won’t be checked.

---

2. [Hueman](https://wordpress.org/themes/hueman/) (50,000+ installations).

Vulnerable version: 3.6.1 and below.

Vulnerable nonces: option-tree/includes/class-ot-meta-box.php L211:

```
// Verify nonce.
if ( isset( $_POST[ $this->meta_box['id'] . '_nonce' ] ) && ! wp_verify_nonce( $_POST[ $this->meta_box['id'] . '_nonce' ], $this->meta_box['id'] ) ) { // phpcs:ignore
   return $post_id;
}

```

If the security nonce is not set, it won’t be checked.

---

### Recommendations

Make sure to update to the latest version if you are running any of the above-mentioned themes or plugins.

### Stay informed about the latest vulnerabilities

* Running WordPress? You can get [email notifications](https://blog.nintechnet.com/how-to-get-informed-about-the-latest-security-updates-in-your-wordpress-plugins-and-themes/) about vulnerabilities in the plugins or themes installed on your blog.
* On Twitter: [@nintechnet](https://twitter.com/nintechnet)

Tagged: [NinjaFirewall](https://blog.nintechnet.com/tag/ninjafirewall/), [Security](https://blog.nintechnet.com/tag/security/), [Vulnerability](https://blog.nintechnet.com/tag/vulnerability/), [WordPress](https://blog.nintechnet.com/tag/wordpress/)

* [Share on Twitter](https://twitter.com/share?text=More%20WordPress%20plugins%20and%20themes%20vulnerable%20to%20CSRF%20attacks.&url=https%3A%2F%2Fblog.nintechnet.com%2Fmore-wordpress-plugins-and-themes-vulnerable-to-csrf-attacks%2F)
* [Share on Facebook](https://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.nintechnet.com%2Fmore-wordpress-plugins-and-themes-vulnerable-to-csrf-attacks%2F)
* [Share on Reddit](https://www.reddit.com/submit?title=More%20WordPress%20plugins%20and%20themes%20vulnerable%20to%20CSRF%20attacks.&url=https%3A%2F%2Fblog.nintechnet.com%2Fmore-wordpress-plugins-and-themes-vulnerable-to-csrf-attacks%2F)
* [RSS icon](https://blog.nintechnet.com/feed/)

## Post navigation

[Previous WordPress Simple:Press plugin fixed critical vulnerabilities.](https://blog.nintechnet.com/wordpress-simplepress-plugin-fixed-critical-vulnerabilities/)[Next Unauthenticated function injection vulnerability fixed in 15 WordPress themes.](https://blog.nintechnet.com/unauthenticated-function-injection-vulnerability-fixed-in-15-wordpress-themes/)

## Our Products

![NinjaFirewall](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-nfwp-150.png)

**NinjaFirewall WP+**

Web Application Firewall for WordPress. It will give your blog the highest level of protection it deserves.

Free Download

---

![SaferCheckout](https://blog.nintechnet.com/wp-content/uploads/safercheckout_150x150.png)

**SaferCheckout**

A powerful security plugin to protect WooCommerce stores from fraudulent transactions.

Free Download

---

![NinjaFirewall](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-nfpro-150.png)

**NinjaFirewall Pro+**

Web Application Firewall for PHP applications. It will protect your PHP site, from custom scripts to popular shopping cart and CMS applications.

Free Download

---

![Code Profiler](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-cp-150.png)

**Code Profiler**

Speed up your WordPress website by locating bottlenecks and performance issues in your plugins and themes.

Free Download

---

![NinjaScanner](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-ns-150.png)

**NinjaScanner**

A lightweight, fast and powerful malware and virus scanner for WordPress which includes many features to help you scan your blog for malware and virus.

Free Download
## Categories

Categories
Select Category
Benchmarks  (5)
Changelog  (1)
Code Profiler  (1)
HHVM  (1)
Joomla!  (2)
Magento  (1)
NinjaFirewall  (150)
NinjaScanner  (8)
Performance  (2)
Privacy  (1)
Security  (154)
   Brute-force attack  (5)
   Malware  (7)
   Phishing  (2)
   Virus  (2)
   Vulnerability  (129)
Troubleshooting  (14)
Tutorial  (26)
WooCommerce  (2)
WordPress  (149)

## Search

Search for:

Search

## Recent Posts

* [XSS / HTML injection vulnerability in WordPress Plugin Check (PCP) plugin.](https://blog.nintechnet.com/xss-html-injection-vulnerability-in-wordpress-plugin-check-pcp-plugin/)
  December 6, 2024 - 7:24pm [+0700]
* [How to debug WooCommerce Add to Cart action with Code Profiler.](https://blog.nintechnet.com/how-to-debug-woocommerce-add-to-cart-action-with-code-profiler/)
  November 28, 2024 - 7:00pm [+0700]
* [SaferCheckout: Fraud prevention plugin for WooCommerce stores.](https://blog.nintechnet.com/safercheckout-fraud-prevention-plugin-for-woocommerce-stores/)
  August 5, 2024 - 5:31pm [+0700]
* [Unauthenticated function injection vulnerability in WordPress Shortcode Addons plugin (unpatched).](https://blog.nintechnet.com/unauthenticated-function-injection-vulnerability-in-wordpress-shortcode-addons-plugin-unpatched/)
  April 22, 2024 - 11:29am [+0700]
* [Broken access control vulnerability fixed in WordPress 10Web AI Assistant plugin.](https://blog.nintechnet.com/broken-access-control-vulnerability-fixed-in-wordpress-10web-ai-assistant-plugin/)
  January 26, 2024 - 1:50pm [+0700]

© Copyright
2025 – [The Ninja Technologies Network](https://nintechnet.com/)



=== Content from blog.nintechnet.com_eba8c35c_20250111_082559.html ===

[![NinTechNet](https://blog.nintechnet.com/wp-content/uploads/2018/07/nintechnet_logo.png)](https://nintechnet.com/)

[NinTechNet](https://nintechnet.com/ "Back to NinTechNet's home")

The Ninja Technologies Network

[Skip to content](#content)
[Menu](#header-menu-responsive)

* [Blog Summary](https://blog.nintechnet.com/)
* [NinTechNet’s Home](https://nintechnet.com/)

# Multiple WordPress plugins fixed CSRF vulnerabilities (part 3).

* by [Jerome Bruandet](https://blog.nintechnet.com/author/bruandet/)
* Posted on [June 21, 2021 - 11:11am [+0700]](https://blog.nintechnet.com/multiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-3/)

This is the third part of our “Multiple WordPress plugins fixed CSRF vulnerabilities” saga. If you missed the previous episodes, you can consult them here:

[Multiple WordPress plugins fixed CSRF vulnerabilities (part 1)](https://blog.nintechnet.com/multiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-1/).

[Multiple WordPress plugins fixed CSRF vulnerabilities (part 2)](https://blog.nintechnet.com/multiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-2/).

### Vulnerable Plugins

1. [Absolute Reviews](https://wordpress.org/plugins/absolute-reviews/)

Vulnerable version: 1.0.8 and below

Vulnerable nonce: admin/class-absolute-reviews-admin.php#L645

```
if ( isset( $_POST['abr_review_meta'] ) && ! wp_verify_nonce( wp_unslash( $_POST['abr_review_meta'] ), 'abr_review_meta_nonce' ) ) { // Input var ok; sanitization ok.
   return;
}

```

If `$_POST['abr_review_meta']` isn’t set, the nonce won’t be checked.

---

2. [Advanced Popups](https://wordpress.org/plugins/advanced-popups/)

Vulnerable version: 1.1.1 and below

Vulnerable nonce: admin/class-advanced-popups-admin.php#L607

```
if ( isset( $_POST['adp_popup_meta'] ) && ! wp_verify_nonce( wp_unslash( $_POST['adp_popup_meta'] ), 'popup_meta_nonce' ) ) { // Input var ok; sanitization ok.
   return;
}

```

if `$_POST['adp_popup_meta']` isn’t set, the nonce won’t be checked.

---

3. [Remove Schema](https://wordpress.org/plugins/remove-schema/)

Vulnerable version: 1.4 and below

Vulnerable nonce: admin/class-remove-schema-post-editor.php#L92

```
// security check
if ( isset($_POST['remove_schema_nonce']) && !wp_verify_nonce( $_POST['remove_schema_nonce'], plugin_basename( __FILE__ ) ) )
   return;

```

If `$_POST['remove_schema_nonce']` isn’t set, the nonce won’t be checked.

---

4. [Sunshine Photo Cart](https://wordpress.org/plugins/sunshine-photo-cart/)

Vulnerable version: 2.8.28 and below

Vulnerable nonce: admin/sunshine-products.php#L67

```
if ( ( isset( $_POST['_inline_edit'] ) && !wp_verify_nonce( $_POST['_inline_edit'], 'inlineeditnonce' ) ) ||
( isset( $_POST['sunshine_noncename'] ) && !wp_verify_nonce( $_POST['sunshine_noncename'], plugin_basename( __FILE__ ) ) ) ) {
   return;
}

```

If neither `$_POST['_inline_edit']` nor `$_POST['sunshine_noncename']` are set, the two nonces won’t be checked.

---

5. [Ultimate Gift Cards For WooCommerce](https://wordpress.org/plugins/woo-gift-cards-lite/)

Vulnerable version: 2.1.1 and below

Vulnerable nonce: admin/class-woocommerce-gift-cards-lite-admin.php#L471

```
if ( isset( $_POST['mwb_wgm_product_nonce_field'] ) && ! wp_verify_nonce( sanitize_text_field( wp_unslash( $_POST['mwb_wgm_product_nonce_field'] ) ), 'mwb_wgm_lite_nonce' ) ) {
   return;
}

```

If `$_POST['mwb_wgm_product_nonce_field']` isn’t set, the nonce won’t be checked.

---

6. [wp-mpdf](https://wordpress.org/plugins/wp-mpdf/)

Vulnerable version: 3.5.1 and below

Vulnerable nonce: wp-mpdf.php#L557

```
if ( isset( $_POST['wp_mpdf_noncename'] ) && ! wp_verify_nonce( $_POST['wp_mpdf_noncename'], plugin_basename( __FILE__ ) ) ) {
   return $post_id;
}

```

If `$_POST['wp_mpdf_noncename']` isn’t set, the nonce won’t be checked.

---

7. [Staff Directory Plugin](https://wordpress.org/plugins/staff-directory-pro/)

Vulnerable version: 3.6 and below

Vulnerable nonce: gold-framework/gold-plugins-custom-post-type.php#L312

```
if ( isset($_POST[ 'my-custom-fields_wpnonce' ]) && !wp_verify_nonce( $_POST[ 'my-custom-fields_wpnonce' ], 'my-custom-fields' ) ){
   return;
}

```

If `$_POST[ 'my-custom-fields_wpnonce' ]` isn’t set, the nonce won’t be checked.

---

8. [DW Question & Answer](https://wordpress.org/plugins/dw-question-answer/)

Vulnerable version: 1.5.7 and below (unfixed)

Vulnerable nonce: inc/Handle.php#L144

```
if ( !isset( $_POST['_wpnonce'] ) && !wp_verify_nonce( esc_html( $_POST['_wpnonce'] ), '_dwqa_edit_answer' ) ) {
   dwqa_add_notice( __( 'Hello, Are you cheating huh?', 'dw-question-answer' ), 'error' );
}

```

If `$_POST['_wpnonce']` is set, it won’t be checked.

---

9. [Contact Form 7 Style](https://wordpress.org/plugins/contact-form-7-style/)

Vulnerable version: 3.2 and below (unfixed)

Vulnerable nonce: cf7-style-meta-box.php#L553

```
// verify quick edit nonce
if ( isset( $_POST[ '_inline_edit' ] ) && ! wp_verify_nonce( sanitize_text_field( $_POST[ '_inline_edit' ] ), 'inlineeditnonce' ) )
   return $post_id;

```

If `$_POST[ '_inline_edit' ]` is not set, it won’t be checked.

---

### Recommendations

Make sure to update to the latest version if you are running any of the above-mentioned plugins. If you had some of the vulnerable plugins installed on your blog and were using our web application firewall for WordPress, [NinjaFirewall WP Edition](https://wordpress.org/plugins/ninjafirewall/) (free) and [NinjaFirewall WP+ Edition](https://nintechnet.com/ninjafirewall/wp-edition/) (premium), you have already been informed about those issues by email.

### Stay informed about the latest vulnerabilities

* Running WordPress? You can get [email notifications](https://blog.nintechnet.com/how-to-get-informed-about-the-latest-security-updates-in-your-wordpress-plugins-and-themes/) about vulnerabilities in the plugins or themes installed on your blog.
* On Twitter: [@nintechnet](https://twitter.com/nintechnet)

Tagged: [NinjaFirewall](https://blog.nintechnet.com/tag/ninjafirewall/), [Security](https://blog.nintechnet.com/tag/security/), [Vulnerability](https://blog.nintechnet.com/tag/vulnerability/), [WordPress](https://blog.nintechnet.com/tag/wordpress/)

* [Share on Twitter](https://twitter.com/share?text=Multiple%20WordPress%20plugins%20fixed%20CSRF%20vulnerabilities%20%28part%203%29.&url=https%3A%2F%2Fblog.nintechnet.com%2Fmultiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-3%2F)
* [Share on Facebook](https://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.nintechnet.com%2Fmultiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-3%2F)
* [Share on Reddit](https://www.reddit.com/submit?title=Multiple%20WordPress%20plugins%20fixed%20CSRF%20vulnerabilities%20%28part%203%29.&url=https%3A%2F%2Fblog.nintechnet.com%2Fmultiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-3%2F)
* [RSS icon](https://blog.nintechnet.com/feed/)

## Post navigation

[Previous Broken access control vulnerability fixed in WordPress 404 to 301 plugin.](https://blog.nintechnet.com/broken-access-control-vulnerability-fixed-in-wordpress-404-to-301-plugin/)[Next WordPress PWA for WP and AMP plugin fixed vulnerabilities.](https://blog.nintechnet.com/wordpress-pwa-for-wp-and-amp-plugin-fixed-vulnerabilities/)

## Our Products

![NinjaFirewall](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-nfwp-150.png)

**NinjaFirewall WP+**

Web Application Firewall for WordPress. It will give your blog the highest level of protection it deserves.

Free Download

---

![SaferCheckout](https://blog.nintechnet.com/wp-content/uploads/safercheckout_150x150.png)

**SaferCheckout**

A powerful security plugin to protect WooCommerce stores from fraudulent transactions.

Free Download

---

![NinjaFirewall](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-nfpro-150.png)

**NinjaFirewall Pro+**

Web Application Firewall for PHP applications. It will protect your PHP site, from custom scripts to popular shopping cart and CMS applications.

Free Download

---

![Code Profiler](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-cp-150.png)

**Code Profiler**

Speed up your WordPress website by locating bottlenecks and performance issues in your plugins and themes.

Free Download

---

![NinjaScanner](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-ns-150.png)

**NinjaScanner**

A lightweight, fast and powerful malware and virus scanner for WordPress which includes many features to help you scan your blog for malware and virus.

Free Download
## Categories

Categories
Select Category
Benchmarks  (5)
Changelog  (1)
Code Profiler  (1)
HHVM  (1)
Joomla!  (2)
Magento  (1)
NinjaFirewall  (150)
NinjaScanner  (8)
Performance  (2)
Privacy  (1)
Security  (154)
   Brute-force attack  (5)
   Malware  (7)
   Phishing  (2)
   Virus  (2)
   Vulnerability  (129)
Troubleshooting  (14)
Tutorial  (26)
WooCommerce  (2)
WordPress  (149)

## Search

Search for:

Search

## Recent Posts

* [XSS / HTML injection vulnerability in WordPress Plugin Check (PCP) plugin.](https://blog.nintechnet.com/xss-html-injection-vulnerability-in-wordpress-plugin-check-pcp-plugin/)
  December 6, 2024 - 7:24pm [+0700]
* [How to debug WooCommerce Add to Cart action with Code Profiler.](https://blog.nintechnet.com/how-to-debug-woocommerce-add-to-cart-action-with-code-profiler/)
  November 28, 2024 - 7:00pm [+0700]
* [SaferCheckout: Fraud prevention plugin for WooCommerce stores.](https://blog.nintechnet.com/safercheckout-fraud-prevention-plugin-for-woocommerce-stores/)
  August 5, 2024 - 5:31pm [+0700]
* [Unauthenticated function injection vulnerability in WordPress Shortcode Addons plugin (unpatched).](https://blog.nintechnet.com/unauthenticated-function-injection-vulnerability-in-wordpress-shortcode-addons-plugin-unpatched/)
  April 22, 2024 - 11:29am [+0700]
* [Broken access control vulnerability fixed in WordPress 10Web AI Assistant plugin.](https://blog.nintechnet.com/broken-access-control-vulnerability-fixed-in-wordpress-10web-ai-assistant-plugin/)
  January 26, 2024 - 1:50pm [+0700]

© Copyright
2025 – [The Ninja Technologies Network](https://nintechnet.com/)



=== Content from blog.nintechnet.com_4eb58b52_20250111_082559.html ===

[![NinTechNet](https://blog.nintechnet.com/wp-content/uploads/2018/07/nintechnet_logo.png)](https://nintechnet.com/)

[NinTechNet](https://nintechnet.com/ "Back to NinTechNet's home")

The Ninja Technologies Network

[Skip to content](#content)
[Menu](#header-menu-responsive)

* [Blog Summary](https://blog.nintechnet.com/)
* [NinTechNet’s Home](https://nintechnet.com/)

# Multiple WordPress plugins fixed CSRF vulnerabilities (part 2).

* by [Jerome Bruandet](https://blog.nintechnet.com/author/bruandet/)
* Posted on [June 8, 2021 - 12:55pm [+0700]June 8, 2021 - 3:34pm [+0700]](https://blog.nintechnet.com/multiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-2/)

This is the second part of our “Multiple WordPress plugins fixed CSRF vulnerabilities” saga. If you missed the first part, [you can access it here](https://blog.nintechnet.com/multiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-1/).

### Vulnerable Plugins

1. [Qtranslate Slug](https://wordpress.org/plugins/qtranslate-slug/)

Vulnerable version: 1.1.18 and below (unfixed).

Vulnerable nonce: includes/class-qtranslate-slug.php#L2106

```
if ((defined('DOING_AUTOSAVE') && DOING_AUTOSAVE)    // check autosave
   || (!isset($_POST['post_ID']) || $post_id != $_POST['post_ID']) // check revision
   || (isset($_POST['qts_nonce']) && !wp_verify_nonce( $_POST['qts_nonce'], 'qts_nonce'))  // verify nonce
   || (!current_user_can($post_type_object->cap->edit_post, $post_id))) {  // check permission
   return $post_id;
}

```

If `$_POST['qts_nonce']` isn’t set, the nonce won’t be checked.

---

2. [WC Marketplace](https://wordpress.org/plugins/dc-woocommerce-multi-vendor/)

Vulnerable version: 3.7.3 and below.

Vulnerable nonce: classes/class-wcmp-vendor-dashboard.php#L468

```
if (!empty($_POST['wcmp_submit_product_comment'])) {
   // verify nonce
   if (isset($_POST['vendor_add_product_nonce']) && !wp_verify_nonce($_POST['vendor_add_product_nonce'], 'dc-vendor-add-product-comment'))
      return false;

```

If `$_POST['vendor_add_product_nonce']` isn’t set, the nonce won’t be checked.

---

3. [Custom css-js-php](https://wordpress.org/plugins/custom-css-js-php/)

Vulnerable version: 2.0.7 and below (unfixed).

Vulnerable nonce: modules/code/model.code.php#L91

```
if ( isset( $_REQUEST['_wpnonce'] ) ) {
   $nonce = sanitize_text_field( wp_unslash( $_REQUEST['_wpnonce'] ) ); }

if ( isset( $nonce ) and ! wp_verify_nonce( $nonce, 'wpgmp-nonce' ) ) {

   die( 'Cheating...' );
}

```

If `$_REQUEST['_wpnonce']` isn’t set, the nonce won’t be checked.

---

4. [Multiple Roles](https://wordpress.org/plugins/multiple-roles/)

Vulnerable version: 1.3.1 and below (unfixed).

Vulnerable nonce: controllers/checklist.php#L98

```
if ( isset( $_POST['md_multiple_roles_nonce'] ) && ! wp_verify_nonce( $_POST['md_multiple_roles_nonce'], 'update-md-multiple-roles' ) ) {
   return;
}

```

If `$_POST['md_multiple_roles_nonce']` isn’t set, the nonce won’t be checked.

---

5. [Edwiser Bridge](https://wordpress.org/plugins/edwiser-bridge/)

Vulnerable version: 2.0.6 and below.

Vulnerable nonce #1: admin/class-eb-welcome.php#L312

```
if ( isset( $_POST['subscribe_nonce_field'] ) && ! wp_verify_nonce( sanitize_text_field( wp_unslash( $_POST['subscribe_nonce_field'] ) ), 'subscribe_nonce' ) ) {
   die( esc_html__( 'Action failed. Please refresh the page and retry.', 'eb-textdomain' ) );
}

```

If `$_POST['subscribe_nonce_field']` isn’t set, the nonce won’t be checked.

Vulnerable nonce #2: admin/class-eb-welcome.php#L341

```
if ( isset( $_POST['subscribe_nonce_field'] ) && ! wp_verify_nonce( sanitize_text_field( wp_unslash( $_POST['subscribe_nonce_field'] ) ), 'subscribe_nonce' ) ) {
   esc_html_e( 'Sorry, there is a problem!', 'eb-textdomain' );
   exit;

```

Same as above.

Vulnerable nonce #3: public/templates/account/form-login.php#L15

```
if ( isset( $_POST['_wpnonce'] ) && ! wp_verify_nonce( sanitize_text_field( wp_unslash( $_POST['_wpnonce'] ) ), 'eb-login' ) ) {
   return;
}

```

If `$_POST['_wpnonce']` isn’t set, the nonce won’t be checked.

Vulnerable nonce #4: includes/payments/eb-ipn.php#L16

```
if ( isset( $custom_data->eb_nonce ) && ! wp_verify_nonce( sanitize_text_field( wp_unslash( $custom_data->eb_nonce ) ), 'eb_paypal_nonce' ) ) {
   return;
}

```

If `$custom_data->eb_nonce` isn’t set, the nonce won’t be checked.

Vulnerable nonce #5: includes/class-eb-user-manager.php#L995

```
if ( isset( $_GET['_wpnonce'] ) && ! wp_verify_nonce( sanitize_text_field( wp_unslash( $_GET['_wpnonce'] ) ), 'bulk-users' ) ) {
   return;
}

```

If `$_GET['_wpnonce']` isn’t set, the nonce won’t be checked.

Vulnerable nonce #6: includes/class-eb-custom-list-table.php#L339

```
 if ( isset( $_REQUEST['eb-manage-user-enrol'] ) && ! wp_verify_nonce( sanitize_text_field( wp_unslash( $_REQUEST['eb-manage-user-enrol'] ) ), 'eb-manage-user-enrol' ) ) {
   return;
}

```

If `$_REQUEST['eb-manage-user-enrol']` isn’t set, the nonce won’t be checked.

---

6. [WP Prayer](https://wordpress.org/plugins/wp-prayer/)

Vulnerable version: 1.6.5 and below.

Vulnerable nonce #1: modules/settings/model.settings.php#L33

```
if ( isset( $_REQUEST['_wpnonce'] ) ) {
   $nonce = sanitize_text_field( $_REQUEST['_wpnonce']  ); }
   if ( isset( $nonce ) and ! wp_verify_nonce( $nonce, 'wpgmp-nonce' ) ) {
      die( 'Cheating...' );
   }

```

If `$_REQUEST['_wpnonce']` isn’t set, the nonce won’t be checked.

Vulnerable nonce #2: modules/shortcode/model.shortcode.php#L44

```
if (isset($_REQUEST['_wpnonce'])) {
   $nonce = sanitize_text_field($_REQUEST['_wpnonce']);
}
if (isset($nonce) and ! wp_verify_nonce($nonce, 'wpgmp-nonce')) {
    die('Cheating...');
}

```

Same as above.

Vulnerable nonce #3: modules/email\_settings/model.email\_settings.php#L20

```
if ( isset( $_REQUEST['_wpnonce'] ) ) {
   $nonce = sanitize_text_field( $_REQUEST['_wpnonce']  );
}

if ( isset( $nonce ) and ! wp_verify_nonce( $nonce, 'wpgmp-nonce' ) ) {
   die( 'Cheating...' );
}

```

Same as above.

Vulnerable nonce #4: modules/prayer/model.prayer.php#L87

```
if (isset($_REQUEST['_wpnonce'])) {
   $nonce = sanitize_text_field($_REQUEST['_wpnonce']);
}
if (isset($nonce) and ! wp_verify_nonce($nonce, 'wpgmp-nonce')) {
   die('Cheating...');
}

```

Same as above.

---

### Recommendations

Make sure to update to the latest version if you are running any of the above-mentioned plugins. If you had some of the vulnerable plugins installed on your blog and were using our web application firewall for WordPress, [NinjaFirewall WP Edition](https://wordpress.org/plugins/ninjafirewall/) (free) and [NinjaFirewall WP+ Edition](https://nintechnet.com/ninjafirewall/wp-edition/) (premium), you have already been informed about those issues by email.

### Stay informed about the latest vulnerabilities

* Running WordPress? You can get [email notifications](https://blog.nintechnet.com/how-to-get-informed-about-the-latest-security-updates-in-your-wordpress-plugins-and-themes/) about vulnerabilities in the plugins or themes installed on your blog.
* On Twitter: [@nintechnet](https://twitter.com/nintechnet)

Tagged: [NinjaFirewall](https://blog.nintechnet.com/tag/ninjafirewall/), [Security](https://blog.nintechnet.com/tag/security/), [Vulnerability](https://blog.nintechnet.com/tag/vulnerability/), [WordPress](https://blog.nintechnet.com/tag/wordpress/)

* [Share on Twitter](https://twitter.com/share?text=Multiple%20WordPress%20plugins%20fixed%20CSRF%20vulnerabilities%20%28part%202%29.&url=https%3A%2F%2Fblog.nintechnet.com%2Fmultiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-2%2F)
* [Share on Facebook](https://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.nintechnet.com%2Fmultiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-2%2F)
* [Share on Reddit](https://www.reddit.com/submit?title=Multiple%20WordPress%20plugins%20fixed%20CSRF%20vulnerabilities%20%28part%202%29.&url=https%3A%2F%2Fblog.nintechnet.com%2Fmultiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-2%2F)
* [RSS icon](https://blog.nintechnet.com/feed/)

## Post navigation

[Previous WordPress Kiwi Social Sharing plugin fixed critical vulnerability.](https://blog.nintechnet.com/wordpress-kiwi-social-sharing-plugin-fixed-critical-vulnerability/)[Next Improper input validation fixed in WordPress Popular Posts plugin.](https://blog.nintechnet.com/improper-input-validation-fixed-in-wordpress-popular-posts-plugin/)

## Our Products

![NinjaFirewall](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-nfwp-150.png)

**NinjaFirewall WP+**

Web Application Firewall for WordPress. It will give your blog the highest level of protection it deserves.

Free Download

---

![SaferCheckout](https://blog.nintechnet.com/wp-content/uploads/safercheckout_150x150.png)

**SaferCheckout**

A powerful security plugin to protect WooCommerce stores from fraudulent transactions.

Free Download

---

![NinjaFirewall](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-nfpro-150.png)

**NinjaFirewall Pro+**

Web Application Firewall for PHP applications. It will protect your PHP site, from custom scripts to popular shopping cart and CMS applications.

Free Download

---

![Code Profiler](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-cp-150.png)

**Code Profiler**

Speed up your WordPress website by locating bottlenecks and performance issues in your plugins and themes.

Free Download

---

![NinjaScanner](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-ns-150.png)

**NinjaScanner**

A lightweight, fast and powerful malware and virus scanner for WordPress which includes many features to help you scan your blog for malware and virus.

Free Download
## Categories

Categories
Select Category
Benchmarks  (5)
Changelog  (1)
Code Profiler  (1)
HHVM  (1)
Joomla!  (2)
Magento  (1)
NinjaFirewall  (150)
NinjaScanner  (8)
Performance  (2)
Privacy  (1)
Security  (154)
   Brute-force attack  (5)
   Malware  (7)
   Phishing  (2)
   Virus  (2)
   Vulnerability  (129)
Troubleshooting  (14)
Tutorial  (26)
WooCommerce  (2)
WordPress  (149)

## Search

Search for:

Search

## Recent Posts

* [XSS / HTML injection vulnerability in WordPress Plugin Check (PCP) plugin.](https://blog.nintechnet.com/xss-html-injection-vulnerability-in-wordpress-plugin-check-pcp-plugin/)
  December 6, 2024 - 7:24pm [+0700]
* [How to debug WooCommerce Add to Cart action with Code Profiler.](https://blog.nintechnet.com/how-to-debug-woocommerce-add-to-cart-action-with-code-profiler/)
  November 28, 2024 - 7:00pm [+0700]
* [SaferCheckout: Fraud prevention plugin for WooCommerce stores.](https://blog.nintechnet.com/safercheckout-fraud-prevention-plugin-for-woocommerce-stores/)
  August 5, 2024 - 5:31pm [+0700]
* [Unauthenticated function injection vulnerability in WordPress Shortcode Addons plugin (unpatched).](https://blog.nintechnet.com/unauthenticated-function-injection-vulnerability-in-wordpress-shortcode-addons-plugin-unpatched/)
  April 22, 2024 - 11:29am [+0700]
* [Broken access control vulnerability fixed in WordPress 10Web AI Assistant plugin.](https://blog.nintechnet.com/broken-access-control-vulnerability-fixed-in-wordpress-10web-ai-assistant-plugin/)
  January 26, 2024 - 1:50pm [+0700]

© Copyright
2025 – [The Ninja Technologies Network](https://nintechnet.com/)



=== Content from blog.nintechnet.com_07c44c34_20250111_082559.html ===

[![NinTechNet](https://blog.nintechnet.com/wp-content/uploads/2018/07/nintechnet_logo.png)](https://nintechnet.com/)

[NinTechNet](https://nintechnet.com/ "Back to NinTechNet's home")

The Ninja Technologies Network

[Skip to content](#content)
[Menu](#header-menu-responsive)

* [Blog Summary](https://blog.nintechnet.com/)
* [NinTechNet’s Home](https://nintechnet.com/)

# Multiple WordPress plugins fixed CSRF vulnerabilities (part 4).

* by [Jerome Bruandet](https://blog.nintechnet.com/author/bruandet/)
* Posted on [July 5, 2021 - 11:25am [+0700]](https://blog.nintechnet.com/multiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-4/)

This is the fourth part of our “Multiple WordPress plugins fixed CSRF vulnerabilities” saga. If you missed the previous episodes, you can click on the links below:

[Multiple WordPress plugins fixed CSRF vulnerabilities (part 1)](https://blog.nintechnet.com/multiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-1/).

[Multiple WordPress plugins fixed CSRF vulnerabilities (part 2)](https://blog.nintechnet.com/multiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-2/).

[Multiple WordPress plugins fixed CSRF vulnerabilities (part 3)](https://blog.nintechnet.com/multiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-3/).

### Vulnerable Plugins

1. [Slider Hero](https://wordpress.org/plugins/slider-hero/)

Vulnerable version: 8.2.0 and below

Vulnerable nonce: qcld-slider-main.php#275

```
if ( isset( $_REQUEST['slider_hero_duplicate_nonce'] ) ) {
   if ( ! wp_verify_nonce( $_REQUEST['slider_hero_duplicate_nonce'], 'slider_hero_duplicateslider_' . $id ) ) {
      die( __( 'Security check failed', 'reslide' ) );
   }
}

```

If `$_REQUEST['slider_hero_duplicate_nonce']` isn’t set, the nonce won’t be checked.

---

2. [Amministrazione Trasparente](https://wordpress.org/plugins/amministrazione-trasparente/)

Vulnerable version: 7.1 and below

Vulnerable nonce: redirector.php#L27

```
// verify this came from the our screen and with proper authorization,
// because save_post can be triggered at other times
if ( isset($_POST['aturlmeta_noncename']) && !wp_verify_nonce( $_POST['aturlmeta_noncename'], plugin_basename(__FILE__) )) {
   return $post->ID;
}

```

if `$_POST['aturlmeta_noncename']` isn’t set, the nonce won’t be checked.

---

3. [Vuukle](https://wordpress.org/plugins/free-comments-for-wordpress-vuukle/)

Vulnerable version: 3.4.31 and below

Vulnerable nonce: admin/partials/free-comments-for-wordpress-vuukle-admin-display.php#L57

```
if (isset($_POST['nonce']) && !wp_verify_nonce(sanitize_key($_POST['nonce']), $this->settings_name)) { // Input var okay
   wp_die(esc_html('Security check failed! Settings not saved.'));
}

```

If `$_POST['nonce']` isn’t set, the nonce won’t be checked.

---

4. [WP EasyPay](https://wordpress.org/plugins/wp-easy-pay/)

Vulnerable version: 3.2.0 and below

Vulnerable nonce: wpep\_setup.php#L221

```
if ( ! isset($_POST['nonce']) && ! wp_verify_nonce( sanitize_key($_POST['nonce']), 'nonce' )  ) {
   die('access denied! Nonce not verify.');
}

```

If `$_POST['nonce']` is set, the nonce won’t be checked.

---

5. [Abandoned Cart Recovery for WooCommerce](https://wordpress.org/plugins/woo-abandoned-cart-recovery/)

Vulnerable version: 1.0.4 and below

Vulnerable nonce #1: includes/reports/abandoned-report-table.php#L166

```
if ( isset( $_GET['_wpnonce'] ) && ! wp_verify_nonce( wp_unslash( $_GET['_wpnonce'] ), 'wacv-filter' ) ) {
   return;
}

```

If `$_GET['_wpnonce']` isn’t set, the nonce won’t be checked.

Vulnerable nonce #2:abandoned-report-table.php#L341

```
if ( isset( $_GET['_wpnonce'] ) && ! wp_verify_nonce( wp_unslash( $_GET['_wpnonce'] ), 'wacv-filter' ) ) {
   return;
}

```

Same as above.

---

6. [Locations](https://wordpress.org/plugins/locations/)

Vulnerable version: 3.2.1 and below

Vulnerable nonce: gold-framework/gold-plugins-custom-post-type.php#L291

```
if ( isset($_POST[ 'my-custom-fields_wpnonce' ]) && !wp_verify_nonce( $_POST[ 'my-custom-fields_wpnonce' ], 'my-custom-fields' ) ){
   return;
}

```

If `$_POST[ 'my-custom-fields_wpnonce' ]` isn’t set, the nonce won’t be checked.

---

### Recommendations

Make sure to update to the latest version if you are running any of the above-mentioned plugins. If you had some of the vulnerable plugins installed on your blog and were using our web application firewall for WordPress, [NinjaFirewall WP Edition](https://wordpress.org/plugins/ninjafirewall/) (free) and [NinjaFirewall WP+ Edition](https://nintechnet.com/ninjafirewall/wp-edition/) (premium), you have already been informed about those issues by email.

### Stay informed about the latest vulnerabilities

* Running WordPress? You can get [email notifications](https://blog.nintechnet.com/how-to-get-informed-about-the-latest-security-updates-in-your-wordpress-plugins-and-themes/) about vulnerabilities in the plugins or themes installed on your blog.
* On Twitter: [@nintechnet](https://twitter.com/nintechnet)

Tagged: [NinjaFirewall](https://blog.nintechnet.com/tag/ninjafirewall/), [Security](https://blog.nintechnet.com/tag/security/), [Vulnerability](https://blog.nintechnet.com/tag/vulnerability/), [WordPress](https://blog.nintechnet.com/tag/wordpress/)

* [Share on Twitter](https://twitter.com/share?text=Multiple%20WordPress%20plugins%20fixed%20CSRF%20vulnerabilities%20%28part%204%29.&url=https%3A%2F%2Fblog.nintechnet.com%2Fmultiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-4%2F)
* [Share on Facebook](https://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.nintechnet.com%2Fmultiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-4%2F)
* [Share on Reddit](https://www.reddit.com/submit?title=Multiple%20WordPress%20plugins%20fixed%20CSRF%20vulnerabilities%20%28part%204%29.&url=https%3A%2F%2Fblog.nintechnet.com%2Fmultiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-4%2F)
* [RSS icon](https://blog.nintechnet.com/feed/)

## Post navigation

[Previous WordPress PWA for WP and AMP plugin fixed vulnerabilities.](https://blog.nintechnet.com/wordpress-pwa-for-wp-and-amp-plugin-fixed-vulnerabilities/)[Next WordPress Frontend File Manager plugin fixed multiple critical vulnerabilities.](https://blog.nintechnet.com/wordpress-frontend-file-manager-plugin-fixed-multiple-critical-vulnerabilities/)

## Our Products

![NinjaFirewall](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-nfwp-150.png)

**NinjaFirewall WP+**

Web Application Firewall for WordPress. It will give your blog the highest level of protection it deserves.

Free Download

---

![SaferCheckout](https://blog.nintechnet.com/wp-content/uploads/safercheckout_150x150.png)

**SaferCheckout**

A powerful security plugin to protect WooCommerce stores from fraudulent transactions.

Free Download

---

![NinjaFirewall](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-nfpro-150.png)

**NinjaFirewall Pro+**

Web Application Firewall for PHP applications. It will protect your PHP site, from custom scripts to popular shopping cart and CMS applications.

Free Download

---

![Code Profiler](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-cp-150.png)

**Code Profiler**

Speed up your WordPress website by locating bottlenecks and performance issues in your plugins and themes.

Free Download

---

![NinjaScanner](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-ns-150.png)

**NinjaScanner**

A lightweight, fast and powerful malware and virus scanner for WordPress which includes many features to help you scan your blog for malware and virus.

Free Download
## Categories

Categories
Select Category
Benchmarks  (5)
Changelog  (1)
Code Profiler  (1)
HHVM  (1)
Joomla!  (2)
Magento  (1)
NinjaFirewall  (150)
NinjaScanner  (8)
Performance  (2)
Privacy  (1)
Security  (154)
   Brute-force attack  (5)
   Malware  (7)
   Phishing  (2)
   Virus  (2)
   Vulnerability  (129)
Troubleshooting  (14)
Tutorial  (26)
WooCommerce  (2)
WordPress  (149)

## Search

Search for:

Search

## Recent Posts

* [XSS / HTML injection vulnerability in WordPress Plugin Check (PCP) plugin.](https://blog.nintechnet.com/xss-html-injection-vulnerability-in-wordpress-plugin-check-pcp-plugin/)
  December 6, 2024 - 7:24pm [+0700]
* [How to debug WooCommerce Add to Cart action with Code Profiler.](https://blog.nintechnet.com/how-to-debug-woocommerce-add-to-cart-action-with-code-profiler/)
  November 28, 2024 - 7:00pm [+0700]
* [SaferCheckout: Fraud prevention plugin for WooCommerce stores.](https://blog.nintechnet.com/safercheckout-fraud-prevention-plugin-for-woocommerce-stores/)
  August 5, 2024 - 5:31pm [+0700]
* [Unauthenticated function injection vulnerability in WordPress Shortcode Addons plugin (unpatched).](https://blog.nintechnet.com/unauthenticated-function-injection-vulnerability-in-wordpress-shortcode-addons-plugin-unpatched/)
  April 22, 2024 - 11:29am [+0700]
* [Broken access control vulnerability fixed in WordPress 10Web AI Assistant plugin.](https://blog.nintechnet.com/broken-access-control-vulnerability-fixed-in-wordpress-10web-ai-assistant-plugin/)
  January 26, 2024 - 1:50pm [+0700]

© Copyright
2025 – [The Ninja Technologies Network](https://nintechnet.com/)



=== Content from www.wordfence.com_e6491ea8_20250111_082618.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Vuukle Comments, Reactions, Share Bar, Revenue <= 3.4.31 - Cross-Site Request Forgery Bypass

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Vuukle Comments, Reactions, Share Bar, Revenue <= 3.4.31 - Cross-Site Request Forgery Bypass

4.3

**Cross-Site Request Forgery (CSRF)**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N)

| CVE | [CVE-2021-4427](https://www.cve.org/CVERecord?id=CVE-2021-4427) |
| --- | --- |
| CVSS | 4.3 (Medium) |
| Publicly Published | July 5, 2021 |
| Last Updated | January 22, 2024 |
| Researcher | [Jerome Bruandet - NinTechNet](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/jerome-bruandet-1) |

### Description

The Vuukle Comments, Reactions, Share Bar, Revenue plugin for WordPress is vulnerable to Cross-Site Request Forgery in versions up to, and including, 3.4.31. This is due to missing or incorrect nonce validation in the /admin/partials/free-comments-for-wordpress-vuukle-admin-display.php file. This makes it possible for unauthenticated attackers to edit the plugins settings via a forged request granted they can trick a site administrator into performing an action such as clicking on a link.

#### References

* [blog.nintechnet.com](https://blog.nintechnet.com/25-wordpress-plugins-vulnerable-to-csrf-attacks/)
* [blog.nintechnet.com](https://blog.nintechnet.com/more-wordpress-plugins-and-themes-vulnerable-to-csrf-attacks/)
* [blog.nintechnet.com](https://blog.nintechnet.com/multiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-3/)
* [blog.nintechnet.com](https://blog.nintechnet.com/multiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-2/)
* [blog.nintechnet.com](https://blog.nintechnet.com/multiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-1/)
* [blog.nintechnet.com](https://blog.nintechnet.com/multiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-5/)
* [blog.nintechnet.com](https://blog.nintechnet.com/multiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-4/)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=2553337%40free-comments-for-wordpress-vuukle&new=2553337%40free-comments-for-wordpress-vuukle&sfp_email=&sfph_mail=)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Ffree-comments-for-wordpress-vuukle%2Fvuukle-comments-reactions-share-bar-revenue-3431-cross-site-request-forgery-bypass&t=Vuukle%20Comments%2C%20Reactions%2C%20Share%20Bar%2C%20Revenue%20%3C%3D%203.4.31%20-%20Cross-Site%20Request%20Forgery%20Bypass "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Ffree-comments-for-wordpress-vuukle%2Fvuukle-comments-reactions-share-bar-revenue-3431-cross-site-request-forgery-bypass&text=Vuukle%20Comments%2C%20Reactions%2C%20Share%20Bar%2C%20Revenue%20%3C%3D%203.4.31%20-%20Cross-Site%20Request%20Forgery%20Bypass "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Ffree-comments-for-wordpress-vuukle%2Fvuukle-comments-reactions-share-bar-revenue-3431-cross-site-request-forgery-bypass "LinkedIn")
Email

## Vulnerability Details for Vuukle Comments, Reactions, Share Bar, Revenue

#### [Vuukle Comments, Reactions, Share Bar, Revenue](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/free-comments-for-wordpress-vuukle)

| Software Type | Plugin |
| --- | --- |
| Software Slug | free-comments-for-wordpress-vuukle [(view on wordpress.org)](https://wordpress.org/plugins/free-comments-for-wordpress-vuukle) |
| Patched? | Yes |
| Remediation | Update to version 4.0, or a newer patched version |
| Affected Version | * <= 3.4.31 |
| Patched Version | * 4.0 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from blog.nintechnet.com_6d5969cb_20250111_082600.html ===

[![NinTechNet](https://blog.nintechnet.com/wp-content/uploads/2018/07/nintechnet_logo.png)](https://nintechnet.com/)

[NinTechNet](https://nintechnet.com/ "Back to NinTechNet's home")

The Ninja Technologies Network

[Skip to content](#content)
[Menu](#header-menu-responsive)

* [Blog Summary](https://blog.nintechnet.com/)
* [NinTechNet’s Home](https://nintechnet.com/)

# Multiple WordPress plugins fixed CSRF vulnerabilities (part 5).

* by [Jerome Bruandet](https://blog.nintechnet.com/author/bruandet/)
* Posted on [August 16, 2021 - 12:20pm [+0700]](https://blog.nintechnet.com/multiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-5/)

This is the fifth part of our “Multiple WordPress plugins fixed CSRF vulnerabilities” saga. If you missed the previous episodes, you can click on the links below:

[Multiple WordPress plugins fixed CSRF vulnerabilities (part 1)](https://blog.nintechnet.com/multiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-1/).

[Multiple WordPress plugins fixed CSRF vulnerabilities (part 2)](https://blog.nintechnet.com/multiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-2/).

[Multiple WordPress plugins fixed CSRF vulnerabilities (part 3)](https://blog.nintechnet.com/multiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-3/).

[Multiple WordPress plugins fixed CSRF vulnerabilities (part 4)](https://blog.nintechnet.com/multiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-4/).

### Vulnerable Plugins

1. [Rucy](https://wordpress.org/plugins/rucy/)

Vulnerable version: 0.4.4 and below (plugin closed)

Vulnerable nonce: inc/class-rucy-editor.php#L242

```
if(isset( $_POST['schroeder'] ) && !wp_verify_nonce( $_POST['schroeder'], plugin_basename( __FILE__ ) ) ) {
   return;
}

```

If `$_POST['schroeder']` isn’t set, the nonce won’t be checked.

---

2. [WP-Backgrounds Lite](https://wordpress.org/plugins/wp-backgrounds-lite/)

Vulnerable version: 2.3 and below (plugin closed)

Vulnerable nonce: inoplugs\_background\_plugin.php#L183

```
// verify nonce
if (isset($_POST['ino_meta_box_nonce']) && !wp_verify_nonce($_POST['ino_meta_box_nonce'], basename(__FILE__))) {
   return $post_id;
}

```

if `$_POST['ino_meta_box_nonce']` isn’t set, the nonce won’t be checked.

---

3. [WP Security Question](https://wordpress.org/plugins/wp-security-questions/)

Vulnerable version: 1.0.5 and below (plugin closed)

Vulnerable nonce: modules/settings/model.settings.php#L36

```
if ( isset( $_REQUEST['_wpnonce'] ) ) {
   $nonce = sanitize_text_field( wp_unslash( $_REQUEST['_wpnonce'] ) ); }
if ( isset( $nonce ) and ! wp_verify_nonce( $nonce, 'wpgmp-nonce' ) ) {
   die( 'Cheating...' );
}

```

If `$_REQUEST['_wpnonce']` isn’t set, the nonce won’t be checked.

---

4. [Event Espresso 4 Decaf – Event Registration Event Ticketing](https://wordpress.org/plugins/event-espresso-decaf/)

Vulnerable version: 4.10.11.decaf and below (plugin closed)

Vulnerable nonce: core/domain/services/pue/Stats.php#L194

```
// verify nonce
if (isset($_POST['nonce']) && ! wp_verify_nonce($_POST['nonce'], 'ee-data-optin')) {
   exit();
}

```

If `$_POST['nonce']` isn’t set, the nonce won’t be checked.

---

5. [WordPress Photo Gallery – Image Gallery](https://wordpress.org/plugins/photo-contest/)

Vulnerable version: 1.0.6 and below (plugin closed)

Vulnerable nonce #1: includes/view/ajax-function.php#L562

```
if (!isset($_POST['galleryImgThumbnailLoadNonce']) && !wp_verify_nonce($_POST['galleryImgThumbnailLoadNonce'], 'gallery_img_thumbnail_load_nonce')) {
   wp_die('Security check fail');
}

```

If `$_POST['galleryImgThumbnailLoadNonce']` is set, the nonce won’t be checked.

Vulnerable nonce #2: includes/admin/admin-page-galleries.php#L107

```
if (isset($_REQUEST['gallery_nonce_remove_image']) && !wp_verify_nonce($_REQUEST['gallery_nonce_remove_image'], 'gallery_nonce_remove_image' . $idfordelete)) {
   wp_die('Security check fail edit');
}

```

If `$_REQUEST['gallery_nonce_remove_image']` isn’t set, the nonce won’t be checked.

---

6. [Opal Estate](https://wordpress.org/plugins/opal-estate/)

Vulnerable version: 1.6.11 and below (plugin closed)

Vulnerable nonce #1: inc/ajax-functions.php#L183

```
if ( ! isset( $_REQUEST['nonce'] ) && ! wp_verify_nonce( $_REQUEST['nonce'], 'nonce' ) ) return;

```

If `$_REQUEST['nonce']` is set, the nonce won’t be checked.

Vulnerable nonce #2: inc/ajax-functions.php#L195

```
if ( ! isset( $_REQUEST['nonce'] ) && ! wp_verify_nonce( $_REQUEST['nonce'], 'nonce' ) ) return;

```

Same as above.

---

7. [Sync to Etsy Marketplace from WooCommerce](https://wordpress.org/plugins/exportfeed-for-woocommerce-product-to-etsy/)

Vulnerable version: 3.3.1 and below (plugin closed)

Vulnerable nonce: etsy-export-feed-manage.php#L737

```
if ( ! isset( $_GET['ETCPF_security'] ) && ! wp_verify_nonce( sanitize_text_field( wp_unslash( $_GET['ETCPF_security'] ) ), 'delete_feed' ) ) {
   if ( ! current_user_can( 'editor' ) || ! current_user_can( 'administrator' ) ) {
      return false;
   }
}

```

If `$_GET['ETCPF_security']` is set, the nonce won’t be checked (and the 2 capability checks will be bypassed as well).

---

8. [RAYS Grid](https://wordpress.org/plugins/rays-grid/)

Vulnerable version: 1.2.2 and below (plugin closed)

Vulnerable nonce: includes/class-db.php#L132

```
if ( isset( $_POST['rsgd_nonce_fields'] ) && ! wp_verify_nonce( $_POST['rsgd_nonce_fields'], 'rsgd_nonce_fields' ) && !current_user_can( 'edit_others_posts' ) ) { return; }

```

If `$_POST['rsgd_nonce_fields']` isn’t set, the nonce won’t be checked (and the capability check will be bypassed as well).

---

9. [Sell Media](https://wordpress.org/plugins/sell-media/)

Vulnerable version: 2.5.5 and below (plugin closed)

Vulnerable nonce: inc/gateways/class-sm-gateway-paypal-request.php#L85

```
//check_ajax_referer( 'sell_media_paypal_nonce', 'nonce_security' );
if (isset($_POST['_nonce']) && !wp_verify_nonce($_POST['_nonce'], 'sell_media_paypal_nonce')) {
   $_send_data['status'] = false;
   wp_send_json($_send_data);
   die();
}

```

If `$_POST['_nonce']` isn’t set, the nonce won’t be checked.

---

### Stay informed about the latest vulnerabilities

* Running WordPress? You can get [email notifications](https://blog.nintechnet.com/how-to-get-informed-about-the-latest-security-updates-in-your-wordpress-plugins-and-themes/) about vulnerabilities in the plugins or themes installed on your blog.
* On Twitter: [@nintechnet](https://twitter.com/nintechnet)

Tagged: [NinjaFirewall](https://blog.nintechnet.com/tag/ninjafirewall/), [Security](https://blog.nintechnet.com/tag/security/), [Vulnerability](https://blog.nintechnet.com/tag/vulnerability/), [WordPress](https://blog.nintechnet.com/tag/wordpress/)

* [Share on Twitter](https://twitter.com/share?text=Multiple%20WordPress%20plugins%20fixed%20CSRF%20vulnerabilities%20%28part%205%29.&url=https%3A%2F%2Fblog.nintechnet.com%2Fmultiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-5%2F)
* [Share on Facebook](https://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.nintechnet.com%2Fmultiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-5%2F)
* [Share on Reddit](https://www.reddit.com/submit?title=Multiple%20WordPress%20plugins%20fixed%20CSRF%20vulnerabilities%20%28part%205%29.&url=https%3A%2F%2Fblog.nintechnet.com%2Fmultiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-5%2F)
* [RSS icon](https://blog.nintechnet.com/feed/)

## Post navigation

[Previous WordPress Plugins and Themes Vulnerabilities: Stats, Facts and Recommendations.](https://blog.nintechnet.com/wordpress-plugins-and-themes-vulnerabilities-stats-facts-and-recommendations/)[Next Anatomy of the EICAR Antivirus Test File.](https://blog.nintechnet.com/anatomy-of-the-eicar-antivirus-test-file/)

## Our Products

![NinjaFirewall](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-nfwp-150.png)

**NinjaFirewall WP+**

Web Application Firewall for WordPress. It will give your blog the highest level of protection it deserves.

Free Download

---

![SaferCheckout](https://blog.nintechnet.com/wp-content/uploads/safercheckout_150x150.png)

**SaferCheckout**

A powerful security plugin to protect WooCommerce stores from fraudulent transactions.

Free Download

---

![NinjaFirewall](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-nfpro-150.png)

**NinjaFirewall Pro+**

Web Application Firewall for PHP applications. It will protect your PHP site, from custom scripts to popular shopping cart and CMS applications.

Free Download

---

![Code Profiler](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-cp-150.png)

**Code Profiler**

Speed up your WordPress website by locating bottlenecks and performance issues in your plugins and themes.

Free Download

---

![NinjaScanner](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-ns-150.png)

**NinjaScanner**

A lightweight, fast and powerful malware and virus scanner for WordPress which includes many features to help you scan your blog for malware and virus.

Free Download
## Categories

Categories
Select Category
Benchmarks  (5)
Changelog  (1)
Code Profiler  (1)
HHVM  (1)
Joomla!  (2)
Magento  (1)
NinjaFirewall  (150)
NinjaScanner  (8)
Performance  (2)
Privacy  (1)
Security  (154)
   Brute-force attack  (5)
   Malware  (7)
   Phishing  (2)
   Virus  (2)
   Vulnerability  (129)
Troubleshooting  (14)
Tutorial  (26)
WooCommerce  (2)
WordPress  (149)

## Search

Search for:

Search

## Recent Posts

* [XSS / HTML injection vulnerability in WordPress Plugin Check (PCP) plugin.](https://blog.nintechnet.com/xss-html-injection-vulnerability-in-wordpress-plugin-check-pcp-plugin/)
  December 6, 2024 - 7:24pm [+0700]
* [How to debug WooCommerce Add to Cart action with Code Profiler.](https://blog.nintechnet.com/how-to-debug-woocommerce-add-to-cart-action-with-code-profiler/)
  November 28, 2024 - 7:00pm [+0700]
* [SaferCheckout: Fraud prevention plugin for WooCommerce stores.](https://blog.nintechnet.com/safercheckout-fraud-prevention-plugin-for-woocommerce-stores/)
  August 5, 2024 - 5:31pm [+0700]
* [Unauthenticated function injection vulnerability in WordPress Shortcode Addons plugin (unpatched).](https://blog.nintechnet.com/unauthenticated-function-injection-vulnerability-in-wordpress-shortcode-addons-plugin-unpatched/)
  April 22, 2024 - 11:29am [+0700]
* [Broken access control vulnerability fixed in WordPress 10Web AI Assistant plugin.](https://blog.nintechnet.com/broken-access-control-vulnerability-fixed-in-wordpress-10web-ai-assistant-plugin/)
  January 26, 2024 - 1:50pm [+0700]

© Copyright
2025 – [The Ninja Technologies Network](https://nintechnet.com/)



=== Content from blog.nintechnet.com_370ffbfd_20250111_082559.html ===

[![NinTechNet](https://blog.nintechnet.com/wp-content/uploads/2018/07/nintechnet_logo.png)](https://nintechnet.com/)

[NinTechNet](https://nintechnet.com/ "Back to NinTechNet's home")

The Ninja Technologies Network

[Skip to content](#content)
[Menu](#header-menu-responsive)

* [Blog Summary](https://blog.nintechnet.com/)
* [NinTechNet’s Home](https://nintechnet.com/)

# Multiple WordPress plugins fixed CSRF vulnerabilities (part 1).

* by [Jerome Bruandet](https://blog.nintechnet.com/author/bruandet/)
* Posted on [March 1, 2021 - 12:43pm [+0700]](https://blog.nintechnet.com/multiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-1/)

Back in September 2020, we discovered 33 WordPress plugins and themes vulnerable to cross-site request forgery (CSRF) attacks. Twenty-nine has been fixed so far (see [here](https://blog.nintechnet.com/25-wordpress-plugins-vulnerable-to-csrf-attacks/) and [there](https://blog.nintechnet.com/more-wordpress-plugins-and-themes-vulnerable-to-csrf-attacks/)).

Earlier this month we decided to check again for similar issues and eventually we found more vulnerable plugins than we did last September. As it will likely take *some times* before they all get patched, we’ll disclose the fixed ones in batches of 10 to 15 plugins. Here’s the first one:

### Vulnerable Plugins

1. [Post SMTP Mailer/Email Log](https://wordpress.org/plugins/post-smtp/)

Vulnerable version: 2.0.20 and below.

Vulnerable nonce: Postman/Postman-Email-Log/PostmanEmailLogController.php#L79

```
if ( isset( $_REQUEST['post-smtp-log-nonce'] ) && ! wp_verify_nonce( $_REQUEST['post-smtp-log-nonce'], 'post-smtp' ) )
   die( 'Security check' );

```

If `$_REQUEST['post-smtp-log-nonce']` isn’t set, the nonce won’t be checked

---

2. [Forminator](https://wordpress.org/plugins/forminator/)

Vulnerable version: 1.14.8 and below.

Vulnerable nonce #1: library/modules/quizzes/front/front-render.php#L1337

```
if ( isset( $_REQUEST['nonce'] ) && ! wp_verify_nonce( $_REQUEST['nonce'], 'forminator_submit_form' ) ) {
   wp_send_json_error( new WP_Error( 'invalid_code' ) );
}

```

If `$_REQUEST['nonce']` isn’t set, the nonce won’t be checked.

Vulnerable nonce #2: library/modules/custom-forms/front/front-action.php#L1499

```
if ( isset( $post_data['nonce'] ) && ! wp_verify_nonce( $post_data['nonce'], 'forminator_submit_form' ) ) {
   wp_send_json_error( new WP_Error( 'invalid_code' ) );
}

```

If `$post_data['nonce']` isn’t set, the nonce won’t be checked.

---

3. [Dokan](https://wordpress.org/plugins/dokan-lite/)

Vulnerable version: 3.2.0 and below.

Vulnerable nonce #1: includes/Ajax.php#L421

```
if ( isset( $_POST['dokan_security_nonce'] ) && ! wp_verify_nonce( sanitize_key( $_POST['dokan_security_nonce'] ), 'dokan_security_action' ) ) {
   die( -1 );
}

```

If `$_POST['dokan_security_nonce']` isn’t set, the nonce won’t be checked.

Vulnerable nonce #2: includes/Admin/UserProfile.php#L541

```
if ( isset( $post_data['dokan_update_user_profile_info_nonce'] ) && ! wp_verify_nonce( $post_data['dokan_update_user_profile_info_nonce'], 'dokan_update_user_profile_info' ) ) {
   return;
}

```

If `$post_data['dokan_update_user_profile_info_nonce']` isn’t set, the nonce won’t be checked.

---

4. [Defender Security](https://wordpress.org/plugins/defender-security/)

Vulnerable version: 2.4.6 and below.

Vulnerable nonce: src/controller/two-factor.php#L208

```
if ( isset( $_POST['_wpnonce'] ) && ! wp_verify_nonce( $_POST['_wpnonce'], 'verify_otp' ) ) {
   return;
}

```

If `$_POST['_wpnonce']` isn’t set, the nonce won’t be checked.

---

5. [Abandoned Cart Lite for WooCommerce](https://wordpress.org/plugins/woocommerce-abandoned-cart/)

Vulnerable version: 5.8.5 and below.

Vulnerable nonce #1: woocommerce-ac.php#L412

```
if ( isset( $_REQUEST['_wpnonce'] ) && ! wp_verify_nonce( sanitize_text_field( wp_unslash( $_REQUEST['_wpnonce'] ) ), 'woocommerce-abandoned-cart' ) ) {
   die( 'Security check' );
}

```

If `$_REQUEST['_wpnonce']` isn’t set, the nonce won’t be checked.

Vulnerable nonce #2: woocommerce-ac.php#L449

```
if ( isset( $_REQUEST['_wpnonce'] ) && ! wp_verify_nonce( sanitize_text_field( wp_unslash( $_REQUEST['_wpnonce'] ) ), 'woocommerce-abandoned-cart' ) ) {
   die( 'Security check' );
}

```

Same as above.

---

6. [Style Kits](https://wordpress.org/plugins/analogwp-templates/)

Vulnerable version: 1.8.0 and below.

Vulnerable nonce: inc/class-quick-edit.php#L163

```
if ( isset( $_POST['ang_sk_update_nonce'] ) && ! wp_verify_nonce( $_POST['ang_sk_update_nonce'], plugin_basename( __FILE__ ) ) ) { // phpcs:ignore
   return;
}

```

If `$_POST['ang_sk_update_nonce']` isn’t set, the nonce won’t be checked.

---

7. [WP ERP](https://wordpress.org/plugins/erp/)

Vulnerable version: 1.7.4 and below.

Vulnerable nonce: modules/hrm/includes/class-form-handler.php#L1227

```
if ( isset( $_POST['_wpnonce'] ) && ! wp_verify_nonce( sanitize_key( $_POST['_wpnonce'] ), 'erp-settings-nonce' ) ) {
   die( 'Nonce failed.' );
}

```

If `$_POST['_wpnonce']` isn’t set, the nonce won’t be checked.

---

8. [eCommerce Product Catalog](https://wordpress.org/plugins/ecommerce-product-catalog/)

Vulnerable version: 3.0.17 and below.

Vulnerable nonce: modules/cart/includes/orders/includes/register-digital-orders.php#L398

```
$order_summary_meta_noncename = isset( $_POST[ 'order_summary_meta_noncename' ] ) ? $_POST[ 'order_summary_meta_noncename' ] : '';
if ( !empty( $order_summary_meta_noncename ) && !wp_verify_nonce( $order_summary_meta_noncename, plugin_basename( __FILE__ ) ) ) {
   return $post->ID;
}

```

If `$_POST['order_summary_meta_noncename']` is empty or not set, the nonce won’t be checked.

---

9. [WP Project Manager](https://wordpress.org/plugins/wedevs-project-manager/)

Vulnerable version: 2.4.9 and below.

Vulnerable nonce: core/Promotions/Offers.php#L137

```
if ( isset( $_POST['nonce'] ) && ! wp_verify_nonce( sanitize_text_field( wp_unslash( $_POST['nonce'] ) ), 'pm_dismiss_offer' ) ) {
   wp_send_json_error( __( 'Invalid nonce', 'wedevs-project-manager' ) );
}

```

If `$_POST['nonce']` isn’t set, the nonce won’t be checked.

---

10. [WP Private Content Plus](https://wordpress.org/plugins/wp-private-content-plus/)

Vulnerable version: 3.1 and below.

Vulnerable nonce: classes/class-wppcp-groups.php#L188

```
$nonce = isset($_POST['wppcp_backend_group_add_new_member_nonce']) ?
sanitize_text_field($_POST['wppcp_backend_group_add_new_member_nonce']) : '';
if ( isset($_POST['wppcp_backend_group_add_new_member_nonce']) && ! wp_verify_nonce( $nonce, 'wppcp-backend-group-add-new-member-nonce' ) ) {
   return;
}

```

If `$_POST['wppcp_backend_group_add_new_member_nonce']` isn’t set, the nonce won’t be checked.

---

11. [Better Search](https://wordpress.org/plugins/better-search/)

Vulnerable version: 2.5.2 and below.

Vulnerable nonce #1: includes/admin/tools.php#L223

```
if ( isset( $_POST['bsearch_export_settings_nonce'] ) && ! wp_verify_nonce( sanitize_key( $_POST['bsearch_export_settings_nonce'] ), 'bsearch_export_settings_nonce' ) ) {
   return;
}

```

If `$_POST['bsearch_export_settings_nonce']` isn’t set, the nonce won’t be checked.

Vulnerable nonce #2: includes/admin/tools.php#L257

```
if ( isset( $_POST['bsearch_import_settings_nonce'] ) && ! wp_verify_nonce( sanitize_key( $_POST['bsearch_import_settings_nonce'] ), 'bsearch_import_settings_nonce' ) ) {
   return;
}

```

If `$_POST['bsearch_import_settings_nonce']` isn’t set, the nonce won’t be checked.

---

12. [Custom Banners](https://wordpress.org/plugins/custom-banners/)

Vulnerable version: 3.2.2 and below.

Vulnerable nonce: gold-framework/gold-plugins-custom-post-type.php#L191

```
// exit if nonce is not present or invalid
if ( empty($_POST[ 'my-custom-fields_wpnonce' ])
   || ! wp_verify_nonce( $_POST[ 'my-custom-fields_wpnonce' ], 'my-custom-fields' ) ) {
   return;
}

```

If `$_POST[ 'my-custom-fields_wpnonce' ]` isn’t set, the nonce won’t be checked.

---

13. [ElasticPress](https://wordpress.org/plugins/elasticpress/)

Vulnerable version: 3.5.3 and below.

Vulnerable nonce: includes/classes/Feature/Autosuggest/Autosuggest.php#L640

```
if ( ! empty( $_REQUEST['ep_epio_nonce'] ) && ! wp_verify_nonce( $_REQUEST['ep_epio_nonce'], 'ep-epio-set-autosuggest' ) ) {
   return;
}

```

If `$_REQUEST['ep_epio_nonce']` is empty or not set, the nonce won’t be checked.

---

14. [WP Travel](https://wordpress.org/plugins/wp-travel/)

Vulnerable version: 4.4.6 and below.

Vulnerable nonce: inc/admin/class-admin-metaboxes.php#L431

```
if ( isset( $_POST['wp_travel_save_data'] ) && ! wp_verify_nonce( $_POST['wp_travel_save_data'], 'wp_travel_save_data_process' ) ) {
   return;
}

```

If `$_POST['wp_travel_save_data']` isn’t set, the nonce won’t be checked.

---

15. [Process Steps Template Designer](https://wordpress.org/plugins/process-steps-template-designer/)

Vulnerable version: 1.2.1 and below.

Vulnerable nonce: icons-selector/font-awesome-field.php#L215

```
if ( isset( $_POST['fa_field_icon_nonce'] ) && ! wp_verify_nonce( $_POST['fa_field_icon_nonce'], 'fa_field_icon' ) ) {
   return;
}

```

If `$_POST['fa_field_icon_nonce']` isn’t set, the nonce won’t be checked.

---

### Recommendations

Make sure to update to the latest version if you are running any of the above-mentioned plugins. If you had some of the vulnerable plugins installed on your blog and were using our web application firewall for WordPress, [NinjaFirewall WP Edition](https://wordpress.org/plugins/ninjafirewall/) (free) and [NinjaFirewall WP+ Edition](https://nintechnet.com/ninjafirewall/wp-edition/) (premium), you have already been informed about those issues by email.

### Timeline

All vulnerabilities were reported to the WordPress.org Plugin Team between February 12 and 15, 2021.

### Stay informed about the latest vulnerabilities

* Running WordPress? You can get [email notifications](https://blog.nintechnet.com/how-to-get-informed-about-the-latest-security-updates-in-your-wordpress-plugins-and-themes/) about vulnerabilities in the plugins or themes installed on your blog.
* On Twitter: [@nintechnet](https://twitter.com/nintechnet)

Tagged: [NinjaFirewall](https://blog.nintechnet.com/tag/ninjafirewall/), [Security](https://blog.nintechnet.com/tag/security/), [Vulnerability](https://blog.nintechnet.com/tag/vulnerability/), [WordPress](https://blog.nintechnet.com/tag/wordpress/)

* [Share on Twitter](https://twitter.com/share?text=Multiple%20WordPress%20plugins%20fixed%20CSRF%20vulnerabilities%20%28part%201%29.&url=https%3A%2F%2Fblog.nintechnet.com%2Fmultiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-1%2F)
* [Share on Facebook](https://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.nintechnet.com%2Fmultiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-1%2F)
* [Share on Reddit](https://www.reddit.com/submit?title=Multiple%20WordPress%20plugins%20fixed%20CSRF%20vulnerabilities%20%28part%201%29.&url=https%3A%2F%2Fblog.nintechnet.com%2Fmultiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-1%2F)
* [RSS icon](https://blog.nintechnet.com/feed/)

## Post navigation

[Previous Critical vulnerability in WordPress Ultimate GDPR and CCPA Compliance Toolkit plugin.](https://blog.nintechnet.com/critical-vulnerability-in-wordpress-ultimate-gdpr-ccpa-compliance-toolkit-plugin/)[Next Zero-day vulnerability fixed in WordPress Flo Forms plugin.](https://blog.nintechnet.com/zero-day-vulnerability-fixed-in-wordpress-flo-forms-plugin/)

## Our Products

![NinjaFirewall](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-nfwp-150.png)

**NinjaFirewall WP+**

Web Application Firewall for WordPress. It will give your blog the highest level of protection it deserves.

Free Download

---

![SaferCheckout](https://blog.nintechnet.com/wp-content/uploads/safercheckout_150x150.png)

**SaferCheckout**

A powerful security plugin to protect WooCommerce stores from fraudulent transactions.

Free Download

---

![NinjaFirewall](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-nfpro-150.png)

**NinjaFirewall Pro+**

Web Application Firewall for PHP applications. It will protect your PHP site, from custom scripts to popular shopping cart and CMS applications.

Free Download

---

![Code Profiler](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-cp-150.png)

**Code Profiler**

Speed up your WordPress website by locating bottlenecks and performance issues in your plugins and themes.

Free Download

---

![NinjaScanner](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-ns-150.png)

**NinjaScanner**

A lightweight, fast and powerful malware and virus scanner for WordPress which includes many features to help you scan your blog for malware and virus.

Free Download
## Categories

Categories
Select Category
Benchmarks  (5)
Changelog  (1)
Code Profiler  (1)
HHVM  (1)
Joomla!  (2)
Magento  (1)
NinjaFirewall  (150)
NinjaScanner  (8)
Performance  (2)
Privacy  (1)
Security  (154)
   Brute-force attack  (5)
   Malware  (7)
   Phishing  (2)
   Virus  (2)
   Vulnerability  (129)
Troubleshooting  (14)
Tutorial  (26)
WooCommerce  (2)
WordPress  (149)

## Search

Search for:

Search

## Recent Posts

* [XSS / HTML injection vulnerability in WordPress Plugin Check (PCP) plugin.](https://blog.nintechnet.com/xss-html-injection-vulnerability-in-wordpress-plugin-check-pcp-plugin/)
  December 6, 2024 - 7:24pm [+0700]
* [How to debug WooCommerce Add to Cart action with Code Profiler.](https://blog.nintechnet.com/how-to-debug-woocommerce-add-to-cart-action-with-code-profiler/)
  November 28, 2024 - 7:00pm [+0700]
* [SaferCheckout: Fraud prevention plugin for WooCommerce stores.](https://blog.nintechnet.com/safercheckout-fraud-prevention-plugin-for-woocommerce-stores/)
  August 5, 2024 - 5:31pm [+0700]
* [Unauthenticated function injection vulnerability in WordPress Shortcode Addons plugin (unpatched).](https://blog.nintechnet.com/unauthenticated-function-injection-vulnerability-in-wordpress-shortcode-addons-plugin-unpatched/)
  April 22, 2024 - 11:29am [+0700]
* [Broken access control vulnerability fixed in WordPress 10Web AI Assistant plugin.](https://blog.nintechnet.com/broken-access-control-vulnerability-fixed-in-wordpress-10web-ai-assistant-plugin/)
  January 26, 2024 - 1:50pm [+0700]

© Copyright
2025 – [The Ninja Technologies Network](https://nintechnet.com/)



=== Content from blog.nintechnet.com_c2ec115a_20250111_082559.html ===

[![NinTechNet](https://blog.nintechnet.com/wp-content/uploads/2018/07/nintechnet_logo.png)](https://nintechnet.com/)

[NinTechNet](https://nintechnet.com/ "Back to NinTechNet's home")

The Ninja Technologies Network

[Skip to content](#content)
[Menu](#header-menu-responsive)

* [Blog Summary](https://blog.nintechnet.com/)
* [NinTechNet’s Home](https://nintechnet.com/)

# 25 WordPress plugins vulnerable to CSRF attacks.

* by [Jerome Bruandet](https://blog.nintechnet.com/author/bruandet/)
* Posted on [September 16, 2020 - 7:06pm [+0700]June 7, 2023 - 12:17pm [+0700]](https://blog.nintechnet.com/25-wordpress-plugins-vulnerable-to-csrf-attacks/)

Twenty five plugins for WordPress were found to be vulnerable to cross-site request forgery (CSRF) attacks.

### What is a CSRF attack?

> In a CSRF attack, an innocent end user is tricked by an attacker into submitting a web request that they did not intend. This may cause actions to be performed on the website that can include inadvertent client or server data leakage, change of session state, or manipulation of an end user’s account.Wikipedia

### CSRF attacks and WordPress

In order to protect against such attacks, the WordPress API offers one-time use security tokens, a.k.a. [nonces](https://codex.wordpress.org/WordPress_Nonces). Checking for a nonce validity can be done with the WordPress `wp_verify_nonce` function:

```
if (! isset( $_REQUEST['some-nonce'] ) || ! wp_verify_nonce( $_REQUEST['some-nonce'], 'some-nonce' ) ) {
   exit( 'Potential CSRF attack detected.' );
}

```

If the nonce is missing or invalid, the request is rejected.

That looks very simple but, when mixing `isset()`, `!isset()`, `empty()`, `!empty()` with the `&&` (AND) and `||` (OR) operators, it may sometimes lead to some weird results. For instance, here are three examples among the many vulnerable nonces I’ve found in WordPress themes and plugins lately:

-Example #1:

```
if ( isset( $_POST['some-nonce'] ) && ! wp_verify_nonce( $_POST['some-nonce'], 'some-nonce' ) ) {
   exit( 'Potential CSRF attack detected.' );
}

```

The nonce will be checked only if it exists. If it doesn’t, the attacker will bypass the security check.

-Example #2:

```
if (! empty( $_POST['some-nonce'] ) && ! wp_verify_nonce( $_POST['some-nonce'], 'some-nonce' ) ) {
   exit( 'Potential CSRF attack detected.' );
}

```

A bit similar to the previous code snippet, the nonce won’t be checked if it doesn’t exist or is empty.

-Example #3:

```
if (! isset( $_POST['some-nonce'] ) && ! wp_verify_nonce( $_POST['some-nonce'], 'some-nonce' ) ) {
   exit( 'Potential CSRF attack detected.' );
}

```

The nonce will be verified only if it doesn’t exist!

Below is the list of the vulnerable plugins that were fixed by their authors.

The impact of these vulnerabilities may vary from low to high severity and lead to, for instance, XSS (stored or reflected), settings change, configuration import and modification of data in the database, among other issues.

They are sorted in no particular order.

### Vulnerable Plugins

1. [Cartflows](https://wordpress.org/plugins/cartflows/) (100,000+ installations).

Vulnerable version: 1.5.15 and below.

Vulnerable nonce #1: classes/class-cartflows-importer.php lines L155:

```
if ( isset( $_POST['cartflows-action-nonce'] ) && ! wp_verify_nonce( sanitize_text_field( wp_unslash( $_POST['cartflows-action-nonce'] ) ), 'cartflows-action-nonce' ) ) {
   return;
}

```

Vulnerable nonce #2: classes/class-cartflows-importer.php lines L265:

```
if ( isset( $_POST['cartflows-action-nonce'] ) && ! wp_verify_nonce( sanitize_text_field( wp_unslash( $_POST['cartflows-action-nonce'] ) ), 'cartflows-action-nonce' ) ) {
   return;
}

```

In both cases, if `$_POST['cartflows-action-nonce']` is not set, it won’t be checked.

---

2. [Paid Memberships Pro](https://wordpress.org/plugins/paid-memberships-pro/) (100,000+ installations).

Vulnerable version: 2.4.2 and below.

Vulnerable nonces: includes/metaboxes.php L57 and 79:

```
57   if (!empty($_POST['pmpro_noncename']) && !wp_verify_nonce( $_POST['pmpro_noncename'], plugin_basename(__FILE__) )) {
58      return $post_id;
59   }
...
...
78   // OK, we're authenticated: we need to find and save the data
79   if(isset($_POST['pmpro_noncename']))
80   {
...
...

```

It rejects `$_POST['pmpro_noncename']` if it is not empty L57 and if it is not set L79. Therefore, if `$_POST['pmpro_noncename']` is equal to 0, it won’t be checked.

---

3. [Cool Timeline](https://wordpress.org/plugins/cool-timeline/) (10,000 installations).

Vulnerable version: 2.0.2 and below.

Vulnerable nonce: fa-icons/fa-icons-class.php L149:

```
if ( isset( $_POST['fa_field_icon_nonce'] ) && ! wp_verify_nonce( $_POST['fa_field_icon_nonce'], 'fa_field_icon' ) ) {
   return;
}

```

If `$_POST['fa_field_icon_nonce']` is not set, it won’t be checked.

---

4. [Custom Field Template](https://wordpress.org/plugins/custom-field-template/) (70,000+ installations).

Vulnerable version: 2.5.1 and below.

Vulnerable nonce: custom-field-template.php L3061:

```
if( isset($_REQUEST['custom-field-template-verify-key']) && !wp_verify_nonce($_REQUEST['custom-field-template-verify-key'], 'custom-field-template') )
   return $id;

```

If `$_REQUEST['custom-field-template-verify-key']` is not set, it won’t

be checked.

---

5. [eCommerce Product Catalog Plugin](https://wordpress.org/plugins/ecommerce-product-catalog/) (10,000+ installations).

Vulnerable version: 2.9.43 and below.

Vulnerable nonce: includes/register-product.php L301:

```
$pricemeta_noncename = isset( $_POST[ 'pricemeta_noncename' ] ) ? $_POST[ 'pricemeta_noncename' ] : '';
if ( !empty( $pricemeta_noncename ) && !wp_verify_nonce( $pricemeta_noncename, plugin_basename( __FILE__ ) ) ) {
   return $post->ID;
}

```

If `$_POST[ 'pricemeta_noncename' ]` is not set or is empty, it won’t be checked.

---

6. [NotificationX](https://wordpress.org/plugins/notificationx/) (10,000+ installations).

Vulnerable version: 1.8.2 and below.

Vulnerable nonce: public/class-nx-public.php L273:

```
if( ! isset( $_POST['nonce'] ) && ! wp_verify_nonce( $_POST['nonce'], 'nx_frontend_nonce' ) ) {
   return;
}

```

If `$_POST['nonce']` is set, it won’t be checked.

---

7. [Product Catalog X](https://wordpress.org/plugins/post-type-x/) (1,000+ installations).

Vulnerable version: 1.5.12 and below.

Vulnerable nonce: core/includes/register-product.php L301:

```
$pricemeta_noncename = isset( $_POST[ 'pricemeta_noncename' ] ) ? $_POST[ 'pricemeta_noncename' ] : '';
if ( !empty( $pricemeta_noncename ) && !wp_verify_nonce( $pricemeta_noncename, plugin_basename( __FILE__ ) ) ) {
   return $post->ID;
}

```

If `$_POST[ 'pricemeta_noncename' ]` is not set or is empty, it won’t be checked.

---

8. [Coupon Creator](https://wordpress.org/plugins/coupon-creator/) (10,000+ installations).

Vulnerable version: 3.1 and below.

Vulnerable nonce: plugin-engine/src/Pngx/Admin/Meta.php L335:

```
//Verify Nonce
if ( isset( $_POST['pngx_nonce'] ) && ! wp_verify_nonce( $_POST['pngx_nonce'], 'pngx_save_fields' ) && ( isset( $_POST['_inline_edit'] ) && ! wp_verify_nonce( $_POST['_inline_edit'], 'inlineeditnonce' ) ) ) {
   return;
}

```

If either `$_POST['pngx_nonce']` or `$_POST['_inline_edit']` (or both) isn’t set, it won’t be checked.

---

9. [Radio Buttons for Taxonomies](https://wordpress.org/plugins/radio-buttons-for-taxonomies/) (10,000+ installations).

Vulnerable version: 2.0.5 and below.

Vulnerable nonce: inc/class.WordPress\_Radio\_Taxonomy.php L437:

```
// verify nonce
if ( isset( $_POST["_radio_nonce-{$this->taxonomy}"]) && ! wp_verify_nonce( $_REQUEST["_radio_nonce-{$this->taxonomy}"], "radio_nonce-{$this->taxonomy}" ) )
   return $post_id;

```

If `$_POST["_radio_nonce-{$this->taxonomy}"]` is not set, it won’t be checked.

---

10. [Menu Swapper](https://wordpress.org/plugins/menu-swapper/) (7,000+ installations).

Vulnerable version: 1.1.0.2 and below.

Vulnerable nonce: includes/meta-box.php L65:

```
// verify nonce
if( isset( $_POST['swap_meta_box_nonce'] ) && !wp_verify_nonce( $_POST['swap_meta_box_nonce'], basename(__FILE__) ) )
   return $post_id;

```

If `$_POST['swap_meta_box_nonce']` is not set, it won’t be checked.

---

11. [Forminator](https://wordpress.org/plugins/forminator/) (70,000+ installations).

Vulnerable version: 1.13.4 and below.

Vulnerable nonce: /library/class-export.php L158:

```
if ( isset( $_POST['_forminator_nonce'] ) && ! wp_verify_nonce( $_POST['_forminator_nonce'], 'forminator_export' ) ) {
   $redirect = add_query_arg(
      array(
        'err_msg' => rawurlencode( __( 'Invalid request, you are not allowed to do that action.', Forminator::DOMAIN ) ),
      )
   );

   wp_safe_redirect( $redirect );
}

```

If `$_POST['_forminator_nonce']` is not set, it won’t be checked.

---

12. [Coming Soon & Maintenance Mode Page](https://wordpress.org/plugins/nifty-coming-soon-and-under-construction-page/) (20,000+ installations).

Vulnerable version: 1.57 and below.

Vulnerable nonce #1: admin/includes/ot-meta-box-api.php L204:

```
/* verify nonce */
if ( isset( $_POST[ $this->meta_box['id'] . '_nonce'] ) && ! wp_verify_nonce( $_POST[ $this->meta_box['id'] . '_nonce'], $this->meta_box['id'] ) )
   return $post_id;

```

Vulnerable nonce #2: admin/includes/class-ot-meta-box.php L210:

```
// Verify nonce.
if ( isset( $_POST[ $this->meta_box['id'] . '_nonce' ] ) && ! wp_verify_nonce( $_POST[ $this->meta_box['id'] . '_nonce' ], $this->meta_box['id'] ) ) { // phpcs:ignore
   return $post_id;

```

In both cases, if `$_POST[ $this->meta_box['id'] . '_nonce']` is not set, it won’t be check

---

13. [Woody ad snippets](https://wordpress.org/plugins/insert-php/) (80,000+ installations).

Vulnerable version: 2.3.9 and below.

Vulnerable nonce: admin/includes/class.snippets.viewtable.php L139:

```
$wpnonce = WINP_Plugin::app()->request->get( '_wpnonce', '' );

if ( ( ! empty( $wpnonce ) && ! wp_verify_nonce( $wpnonce, 'wbcr_inp_snippert_' . $post_id . '_action_nonce' ) ) || ! WINP_Plugin::app()->currentUserCan() ) {
   wp_die( 'Permission error. You can not edit this page.' );
}

```

If `$wpnonce` is empty or not set, it won’t be checked.

---

14. [Feed Them Social](https://wordpress.org/plugins/feed-them-social/) (80,000+ installations).

Vulnerable version: 2.8.6 and below.

Vulnerable nonce: includes/feed-them-functions.php L814:

```
if ( isset( $_REQUEST['fts_security'], $_REQUEST['fts_time'] ) && ! wp_verify_nonce( sanitize_text_field( wp_unslash( $_REQUEST['fts_security'] ) ), sanitize_text_field( wp_unslash( $_REQUEST['fts_time'] ) ) . 'load-more-nonce' ) ) {
   exit( 'Sorry, You can\'t do that!' );
} else {

```

If either `$_REQUEST['fts_security']` or `$_REQUEST['fts_time']` (or both)

isn’t set, it won’t be checked.

---

15. [Import / Export Customizer Settings](https://wordpress.org/plugins/astra-import-export/) (50,000+ installations).

Vulnerable version: 1.0.3 and below.

Vulnerable nonce: inc/classes/class-astra-import-export-loader.php L105:

```
// Verify correct source for the $_GET data.
if ( isset( $_GET['_wpnonce'] ) && ! wp_verify_nonce( $_GET['_wpnonce'], 'astra-import-complete' ) ) {
   return;
}

```

If `$_GET['_wpnonce']` is not set, it won’t be checked.

---

16. [Easy Testimonials](https://wordpress.org/plugins/easy-testimonials/) (30,000+ installations).

Vulnerable version: 3.6.1 and below.

Vulnerable nonce: include/lib/ik-custom-post-type.php L278:

```
//RWG: 1.30.14 - added isset($_POST[ 'my-custom-fields_wpnonce' ]) to prevent undefined index notices on new item creation
if ( isset($_POST[ 'my-custom-fields_wpnonce' ]) && !wp_verify_nonce( $_POST[ 'my-custom-fields_wpnonce' ], 'my-custom-fields' ) )
   return;

```

If `$_POST['my-custom-fields_wpnonce']` is not set, it won’t be checked.

---

17. [RSS Aggregator by Feedzy](https://wordpress.org/plugins/feedzy-rss-feeds/) (40,000+ installations).

Vulnerable version: 3.4.2 and below.

Vulnerable nonce #1: includes/admin/feedzy-rss-feeds-admin.php L271:

```
if (
   empty( $_POST ) ||
   ( isset( $_POST['feedzy_category_meta_noncename'] ) && ! wp_verify_nonce( $_POST['feedzy_category_meta_noncename'], FEEDZY_BASEFILE ) ) ||
   ! current_user_can( 'edit_post', $post_id )
) {
   return $post_id;
}

```

If `$_POST['feedzy_category_meta_noncename']` is not set, it won’t be checked.

Vulnerable nonce #2: includes/admin/feedzy-rss-feeds-import.php L340:

```
if (
   empty( $_POST ) ||
   get_post_type( $post_id ) !== 'feedzy_imports' ||
   ( isset( $_POST['feedzy_import_noncename'] ) && ! wp_verify_nonce( $_POST['feedzy_import_noncename'], FEEDZY_BASEFILE ) ) ||
   ! current_user_can( 'edit_post', $post_id )
) {
   return $post_id;
}

```

If `$_POST['feedzy_import_noncename']` is not set, it won’t be checked.

---

18. [Top 10 – Popular posts plugin for WordPress](https://wordpress.org/plugins/top-10/) (30,000+ installations).

Vulnerable version: 2.9.4 and below.

Vulnerable nonces: includes/admin/import-export.php:

```
155   if ( isset( $_POST['tptn_export_nonce'] ) && ! wp_verify_nonce( sanitize_key( $_POST['tptn_export_nonce'] ), 'tptn_export_nonce' ) ) {
156      return;
157   }
...
...
238   if ( isset( $_POST['tptn_import_nonce'] ) && ! wp_verify_nonce( sanitize_key( $_POST['tptn_import_nonce'] ), 'tptn_import_nonce' ) ) {
239      return;
240   }
...
...
322   if ( isset( $_POST['tptn_export_settings_nonce'] ) && ! wp_verify_nonce( sanitize_key( $_POST['tptn_export_settings_nonce'] ), 'tptn_export_settings_nonce' ) ) {
323      return;
324   }
...
...
355   if ( isset( $_POST['tptn_import_settings_nonce'] ) && ! wp_verify_nonce( sanitize_key( $_POST['tptn_import_settings_nonce'] ), 'tptn_import_settings_nonce' ) ) {
356      return;
357   }

```

All four nonces will be checked only if they are set.

---

19. [Dokan](https://wordpress.org/plugins/dokan-lite/) (50,000+ installations).

Vulnerable version: 3.0.8 and below.

Vulnerable nonce: includes/Dashboard/Templates/Orders.php L98:

```
$post_data = wp_unslash( $_POST );

if ( isset( $post_data['dokan_vendor_order_export_nonce'] ) && ! wp_verify_nonce( sanitize_text_field( $post_data['dokan_vendor_order_export_nonce'] ), 'dokan_vendor_order_export_action' ) ) {
   return;
}

```

If `$post_data['dokan_vendor_order_export_nonce']` is not set, it won’t be checked.

---

20. [Lightweight Sidebar Manager](https://wordpress.org/plugins/sidebar-manager/) (50,000+ installations).

Vulnerable version: 1.1.4 and below.

Vulnerable nonce: classes/class-bsf-sb-metabox.php L85:

```
if ( get_post_type() != BSF_SB_POST_TYPE
   || ( isset( $_POST[ BSF_SB_POST_TYPE . '-nonce' ] ) && ! wp_verify_nonce( $_POST[ BSF_SB_POST_TYPE . '-nonce' ], BSF_SB_POST_TYPE ) )
) {
   return $post_id;
}

```

If `$_POST[ BSF_SB_POST_TYPE . '-nonce']` is not set, it won’t be checked.

---

21. [WP Hotel Booking](https://wordpress.org/plugins/wp-hotel-booking/) (9,000+ installations).

Vulnerable version: 1.10.1 and below.

Vulnerable nonce: includes/class-wphb-ajax.php L579:

```
if ( ! isset( $_POST['hotel-admin-check-room-available'] ) && ! wp_verify_nonce( sanitize_key( $_POST['hotel-admin-check-room-available'] ), 'hotel_admin_check_room_available' ) ) {
   $result['message'] = __( 'nonce is invalid', 'wp-hotel-booking' );
   wp_send_json( $result );
}

```

If `$_POST['hotel-admin-check-room-available']` is set, it won’t be checked.

---

22. [WP ERP](https://wordpress.org/plugins/erp/) (10,000+ installations).

Vulnerable version: 1.6.3 and below.

Vulnerable nonce: modules/crm/includes/functions-customer.php L3188:

```
if ( isset( $_REQUEST['_wpnonce'] ) && ! wp_verify_nonce( sanitize_text_field( wp_unslash( $_REQUEST['_wpnonce'] ) ), 'erp_create_contact_from_user' ) ) {
   exit;
}

```

If `$_REQUEST['_wpnonce']` is not set, it won’t be checked.

---

23. [Best WooCommerce Multivendor Marketplace Solution](https://wordpress.org/plugins/dc-woocommerce-multi-vendor/) (9,000+ installations).

Vulnerable version: 3.5.7 and below.

Vulnerable nonce: classes/class-wcmp-vendor-dashboard.php L437:

```
// verify nonce
if ($_POST['vendor_add_order_nonce'] && !wp_verify_nonce($_POST['vendor_add_order_nonce'], 'dc-vendor-add-order-comment'))
   return false;

```

---

24. [WP Project Manager](https://wordpress.org/plugins/wedevs-project-manager/) (10,000+ installations).

Vulnerable version: 2.4.0 and below.

Vulnerable nonce: core/Upgrades/Upgrade.php L180:

```
if ( isset( $_POST['pm_nonce'] ) && ! wp_verify_nonce( sanitize_text_field( wp_unslash( $_POST['pm_nonce'] ) ), '_nonce' ) ) {
   return;
}

```

If `$_POST['pm_nonce']` is not set, it won’t be checked.

---

25. [10WebAnalytics](https://wordpress.org/plugins/wd-google-analytics/) (10,000+ installations).

Vulnerable version: 1.2.8 and below.

Vulnerable nonce #1: gawd\_class.php L306:

```
if(isset($_POST['security']) && !wp_verify_nonce($_POST['security'], 'gawd_admin_page_nonce')) {
   $response['error']['code'] = 'wrong_nonce';
   $response['error']['msg'] = 'wrong_nonce';
   die(json_encode($response));
}

```

Vulnerable nonce #2: gawd\_class.php L344:

```
if(isset($_POST['security']) && !wp_verify_nonce($_POST['security'], 'gawd_admin_page_nonce')) {
   $response['error']['code'] = 'wrong_nonce';
   $response['error']['msg'] = 'wrong_nonce';

   if($die == true) {
      die(json_encode($response));
   } else {
      return $response;
   }
}

```

In both cases, if `$_POST['security']` is not set, it won’t be checked.

---

### Timeline

All vulnerabilities were reported to the authors or the WordPress plugins team on August 24th.

### Recommendations

Make sure to update to the latest version if you are running any of the above-mentioned plugins.

### Related posts

[More WordPress plugins and themes vulnerable to CSRF attacks](https://blog.nintechnet.com/more-wordpress-plugins-and-themes-vulnerable-to-csrf-attacks/).

[Multiple WordPress plugins fixed CSRF vulnerabilities (part 1)](https://blog.nintechnet.com/multiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-1/).

[Multiple WordPress plugins fixed CSRF vulnerabilities (part 2)](https://blog.nintechnet.com/multiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-2/).

[Multiple WordPress plugins fixed CSRF vulnerabilities (part 3)](https://blog.nintechnet.com/multiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-3/).

[Multiple WordPress plugins fixed CSRF vulnerabilities (part 4)](https://blog.nintechnet.com/multiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-4/).

[Multiple WordPress plugins fixed CSRF vulnerabilities (part 5)](https://blog.nintechnet.com/multiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-5/).

### Stay informed about the latest vulnerabilities

* Running WordPress? You can get [email notifications](https://blog.nintechnet.com/how-to-get-informed-about-the-latest-security-updates-in-your-wordpress-plugins-and-themes/) about vulnerabilities in the plugins or themes installed on your blog.
* On Twitter: [@nintechnet](https://twitter.com/nintechnet)

Tagged: [NinjaFirewall](https://blog.nintechnet.com/tag/ninjafirewall/), [Security](https://blog.nintechnet.com/tag/security/), [Vulnerability](https://blog.nintechnet.com/tag/vulnerability/), [WordPress](https://blog.nintechnet.com/tag/wordpress/)

* [Share on Twitter](https://twitter.com/share?text=25%20WordPress%20plugins%20vulnerable%20to%20CSRF%20attacks.&url=https%3A%2F%2Fblog.nintechnet.com%2F25-wordpress-plugins-vulnerable-to-csrf-attacks%2F)
* [Share on Facebook](https://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.nintechnet.com%2F25-wordpress-plugins-vulnerable-to-csrf-attacks%2F)
* [Share on Reddit](https://www.reddit.com/submit?title=25%20WordPress%20plugins%20vulnerable%20to%20CSRF%20attacks.&url=https%3A%2F%2Fblog.nintechnet.com%2F25-wordpress-plugins-vulnerable-to-csrf-attacks%2F)
* [RSS icon](https://blog.nintechnet.com/feed/)

## Post navigation

[Previous The impact of an XSS vulnerability on WordPress: How hackers exploit XSS vulnerabilities to create admin accounts on your blog.](https://blog.nintechnet.com/how-hackers-exploit-xss-vulnerabilities-to-create-admin-accounts-on-your-wordpress-blog/)[Next When some developers of WordPress plugin and theme go rogue.](https://blog.nintechnet.com/when-some-developers-of-wordpress-plugin-and-theme-go-rogue/)

## Our Products

![NinjaFirewall](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-nfwp-150.png)

**NinjaFirewall WP+**

Web Application Firewall for WordPress. It will give your blog the highest level of protection it deserves.

Free Download

---

![SaferCheckout](https://blog.nintechnet.com/wp-content/uploads/safercheckout_150x150.png)

**SaferCheckout**

A powerful security plugin to protect WooCommerce stores from fraudulent transactions.

Free Download

---

![NinjaFirewall](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-nfpro-150.png)

**NinjaFirewall Pro+**

Web Application Firewall for PHP applications. It will protect your PHP site, from custom scripts to popular shopping cart and CMS applications.

Free Download

---

![Code Profiler](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-cp-150.png)

**Code Profiler**

Speed up your WordPress website by locating bottlenecks and performance issues in your plugins and themes.

Free Download

---

![NinjaScanner](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-ns-150.png)

**NinjaScanner**

A lightweight, fast and powerful malware and virus scanner for WordPress which includes many features to help you scan your blog for malware and virus.

Free Download
## Categories

Categories
Select Category
Benchmarks  (5)
Changelog  (1)
Code Profiler  (1)
HHVM  (1)
Joomla!  (2)
Magento  (1)
NinjaFirewall  (150)
NinjaScanner  (8)
Performance  (2)
Privacy  (1)
Security  (154)
   Brute-force attack  (5)
   Malware  (7)
   Phishing  (2)
   Virus  (2)
   Vulnerability  (129)
Troubleshooting  (14)
Tutorial  (26)
WooCommerce  (2)
WordPress  (149)

## Search

Search for:

Search

## Recent Posts

* [XSS / HTML injection vulnerability in WordPress Plugin Check (PCP) plugin.](https://blog.nintechnet.com/xss-html-injection-vulnerability-in-wordpress-plugin-check-pcp-plugin/)
  December 6, 2024 - 7:24pm [+0700]
* [How to debug WooCommerce Add to Cart action with Code Profiler.](https://blog.nintechnet.com/how-to-debug-woocommerce-add-to-cart-action-with-code-profiler/)
  November 28, 2024 - 7:00pm [+0700]
* [SaferCheckout: Fraud prevention plugin for WooCommerce stores.](https://blog.nintechnet.com/safercheckout-fraud-prevention-plugin-for-woocommerce-stores/)
  August 5, 2024 - 5:31pm [+0700]
* [Unauthenticated function injection vulnerability in WordPress Shortcode Addons plugin (unpatched).](https://blog.nintechnet.com/unauthenticated-function-injection-vulnerability-in-wordpress-shortcode-addons-plugin-unpatched/)
  April 22, 2024 - 11:29am [+0700]
* [Broken access control vulnerability fixed in WordPress 10Web AI Assistant plugin.](https://blog.nintechnet.com/broken-access-control-vulnerability-fixed-in-wordpress-10web-ai-assistant-plugin/)
  January 26, 2024 - 1:50pm [+0700]

© Copyright
2025 – [The Ninja Technologies Network](https://nintechnet.com/)


