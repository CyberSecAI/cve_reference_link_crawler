=== Content from www.objectif-securite.ch_4e49e311_20250110_145305.html ===
=========================================================================
Subject: Reflected Cross-Site Scripting (XSS) in envelope recipient
Product: Totemomail
Vendor: Kiteworks
CVE ID: CVE-2024-28063
CVSS v3.1: 6.1 [AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N]
Authors: Delphine Peter  , Philippe Oechslin
Date: 06.05.2024
=========================================================================
Summary
-------
A reflected Cross-Site Scripting (XSS) vulnerability was discovered in Totemomail 7.0.0.
Details
-------
Totemomail offers a webmail interface for reading and writing e-mails. Users can
choose between two channels for secure messages: Webmail, which allows to read
secure messages in Totemo webmail application, and Registered Envelope, which
consists in sending encrypted secure messages to the recipient's mailbox as HTML
attachments. When opening the HTML attachment of a Registered Envelope, the user
must authenticate in order to retrieve the cryptographic material used to
decrypt the secure message contained in the HTML file.
If such an HTML attachment is opened in a browser that does not have JavaScript
enabled, the  part of the HTML page is executed, which sends a GET
request as follows:
GET /responsiveUI/EnvelopeOpenServlet?envelopeAction=displayLoginChunkedImages&messageId=123\_45&templateName=defaultEnvelopeTemplate.vm&useLinkedStyle=false&envelopeRecipient=[REDACTED]&attachment=false&supportsOpenOnlinetrue HTTP/1.1
The parameter envelopeRecipient is vulnerable to reflected XSS, as its value is
included without any sanitization in the server response. For instance, when
envelopeRecipient is set to
testuser%40objectif-securite.ch%22%3e%3cscript%3ealert(%27XSS%27)%3c%2fscript%3e
the HTML page returned by the server contains the following, which executes the JavaScript alert function:
">
Vulnerable versions:
--------------------
Tested on Totemo AG totemomail version 7.0.0
Fixed version:
--------------
No information received from the vendor
Timeline
-------
23.02.24 Discovery
26.02.24 Initial vendor notification
01.03.24 Vendor acknowledgement
08.04.24 Patch available (as announced by the vendor, but no confirmation received)
06.05.24 CVE requested
06.05.24 Advisory publication
18.05.24 CVE assigned
References
------
https://nvd.nist.gov/vuln/detail/CVE-2024-28063
https://www.objectif-securite.ch/advisories/totemomail-reflected-xss.txt

