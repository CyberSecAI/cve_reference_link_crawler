```
Message-ID: <157c85dc-9fc6-bd11-cc0b-c22a46c2d091@apache.org>
Date: Mon, 08 May 2023 03:57:31 +0000
From: Wang Weibing <wwbmmm@...che.org>
To: oss-security@...ts.openwall.com
Subject: CVE-2023-31039: Apache bRPC: ServerOptions.pid_file may cause
 arbitrary code execution

Severity: important

Affected versions:

- Apache bRPC 0.9.0 before 1.5.0

Description:

Security vulnerability in Apache bRPC <1.5.0 on all platforms allows attackers to execute arbitrary code via ServerOptions::pid_file.
An attacker that can influence the ServerOptions pid_file parameter with which the bRPC server is started can execute arbitrary code with the permissions of the bRPC process.

Solution:
1. upgrade to bRPC >= 1.5.0
2. If you are using an old version of bRPC and hard to upgrade, you can apply this patch:  <https://github.com/apache/brpc/pull/2218>

Required Configurations:

set brpc::ServerOptions::pid_file from user input

Work Arounds:

Apply this patch:  <https://github.com/apache/brpc/pull/2218>

References:

<https://brpc.apache.org>
<https://www.cve.org/CVERecord?id=CVE-2023-31039>
```

- **Root cause of vulnerability:** The vulnerability stems from the ability of an attacker to control the `ServerOptions::pid_file` parameter when starting a bRPC server.
- **Weaknesses/vulnerabilities present:**  The code is vulnerable to arbitrary code execution due to insecure handling of the `pid_file` parameter.
- **Impact of exploitation:** Successful exploitation allows an attacker to execute arbitrary code with the same permissions as the bRPC process.
- **Attack vectors:** The attack vector involves manipulating the `ServerOptions::pid_file` parameter.
- **Required attacker capabilities/position:** The attacker needs the ability to influence the `pid_file` parameter passed to the bRPC server when it starts.