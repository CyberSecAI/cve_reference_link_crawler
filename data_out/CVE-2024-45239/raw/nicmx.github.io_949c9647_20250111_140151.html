<!DOCTYPE html>
<html lang="en">
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

	<!-- Bootstrap CSS -->
	<!--<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">-->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">

	<!-- Styles -->
	<link href="./css/screen.css" rel="stylesheet" type="text/css">

	<meta name="robots" content="index,follow">
	<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>CVE | FORT Validator - RPKI Relying Party</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="CVE" />
<meta property="og:locale" content="en" />
<meta name="description" content="FORT validator is an RPKI Relying Party. It is a service that performs the validation of the entire RPKI repository, and which serves the resulting ROAs for easy access by your routers." />
<meta property="og:description" content="FORT validator is an RPKI Relying Party. It is a service that performs the validation of the entire RPKI repository, and which serves the resulting ROAs for easy access by your routers." />
<link rel="canonical" href="https://nicmx.github.io/FORT-validator/CVE.html" />
<meta property="og:url" content="https://nicmx.github.io/FORT-validator/CVE.html" />
<meta property="og:site_name" content="FORT Validator - RPKI Relying Party" />
<meta property="og:image" content="https://nicmx.github.io/FORT-validator/img/logo_validador_og.png" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:image" content="https://nicmx.github.io/FORT-validator/img/logo_validador_og.png" />
<meta property="twitter:title" content="CVE" />
<meta name="twitter:site" content="@" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"FORT validator is an RPKI Relying Party. It is a service that performs the validation of the entire RPKI repository, and which serves the resulting ROAs for easy access by your routers.","headline":"CVE","image":"https://nicmx.github.io/FORT-validator/img/logo_validador_og.png","url":"https://nicmx.github.io/FORT-validator/CVE.html"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<!-- Header -->
<header class="site-header">
	<div class="container">
		<div class="row align-items-center">
			<div class="col">
				<div class="logo">
					<a href="./index.html" title="" class="d-flex">
						<img src="./img/logo_validador_fort.svg" alt="Fort" width="125px">
					</a>
				</div>
			</div>
			<div class="col-auto">
				<div class="menu-open">
					<span></span>
					<span></span>
					<span></span>
				</div>
				<div class="navigation">
					<nav class="site-nav">
						<ul>
							<li><a class="active-item" href="./index.html">FORT Validator</a></li>
						</ul>
					</nav>

				</div>
			</div>
		</div>
	</div>
</header>

<section class="site-section section-h-full">
	<div class="container">
		<div class="row">
			<div class="col-lg-3">
				<aside class="site-aside">
					<ul class="list-bullet">
						<li><a class="item-menu" href="index.html">Home</a></li>
						<li><a class="item-menu" href="intro-rpki.html">Introduction to RPKI</a></li>
						<li><a class="item-menu" href="intro-fort.html">Introduction to Fort</a></li>
						<li><a class="item-menu" href="installation.html">Compilation and Installation</a></li>
						<li><a class="item-menu" href="run.html">Basic Usage</a></li>
						<li><a class="item-menu" href="usage.html">Program Arguments</a></li>
						<li><a class="item-menu" href="logging.html">Logging</a></li>
						<li><a class="item-menu" href="slurm.html">SLURM</a></li>
						<li><a class="item-menu" href="incidence.html">Incidences</a></li>
						<li><a class="item-menu" href="routers.html">Routers</a></li>
						<li><a class="item-menu active" href="CVE.html">CVEs</a></li>
					</ul>
				</aside>
			</div>
			<div class="col">
				<article class="article-section">
				<h1 id="cves">CVEs</h1>

<h2 id="cve-2024-45238">CVE-2024-45238</h2>

<p>Certificate containing a malformed <code class="language-plaintext highlighter-rouge">subjectPublicKey</code> crashes Fort 1.6.2-, when compiled with OpenSSL &lt; 3.</p>

<table>
  <tbody>
    <tr>
      <td>Description</td>
      <td>A malicious RPKI repository that descends from a (trusted) Trust Anchor can serve (via rsync or RRDP) a resource certificate containing a bit string that doesn’t properly decode into a Subject Public Key. OpenSSL does <a href="https://github.com/openssl/openssl/blob/OpenSSL_1_1_1w/crypto/x509/x_pubkey.c#L152-L157">not report this problem during parsing</a>, and when compiled with OpenSSL libcrypto versions below 3, Fort was recklessly dereferencing the pointer.</td>
    </tr>
    <tr>
      <td>Impact</td>
      <td>Crash. (Potential unavailability of Route Origin Validation.)</td>
    </tr>
    <tr>
      <td>Patch</td>
      <td>Commit <a href="https://github.com/NICMx/FORT-validator/commit/5689dea5e878fed28c5f338a27d7cda4151a14f1">5689dea</a>, released in Fort 1.6.3.</td>
    </tr>
    <tr>
      <td>Acknowledgments</td>
      <td>Thanks to Niklas Vogel and Haya Schulmann for their research and disclosure.</td>
    </tr>
  </tbody>
</table>

<h2 id="cve-2024-45237">CVE-2024-45237</h2>

<p>Certificate containing a Key Usage bit string longer than 2 bytes causes buffer overflow on Fort 1.6.2-.</p>

<table>
  <tbody>
    <tr>
      <td>Description</td>
      <td>A malicious RPKI repository that descends from a (trusted) Trust Anchor can serve (via rsync or RRDP) a resource certificate containing a <a href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.2.1.3">Key Usage extension</a> consisting of more than two bytes of data. Fort used to write this string on a 2-byte buffer without properly sanitizing its length, leading to buffer overflow.</td>
    </tr>
    <tr>
      <td>Impact</td>
      <td>Depending on compilation options, the vulnerability would lead to a crash (which might in turn lead to unavailability of Route Origin Validation), incorrect validation results or arbitrary code execution.</td>
    </tr>
    <tr>
      <td>Patch</td>
      <td>Commit <a href="https://github.com/NICMx/FORT-validator/commit/939d988551d17996be73f52c376a70a3d6ba69f9">939d988</a>, released in Fort 1.6.3.</td>
    </tr>
    <tr>
      <td>Acknowledgments</td>
      <td>Thanks to Niklas Vogel and Haya Schulmann for their research and disclosure.</td>
    </tr>
  </tbody>
</table>

<h2 id="cve-2024-45235">CVE-2024-45235</h2>

<p>Certificate containing an Authority Key Identifier missing a <code class="language-plaintext highlighter-rouge">keyIdentifier</code> crashes Fort 1.6.2-.</p>

<table>
  <tbody>
    <tr>
      <td>Description</td>
      <td>A malicious RPKI repository that descends from a (trusted) Trust Anchor can serve (via rsync or RRDP) a resource certificate containing an <a href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.2.1.1">Authority Key Identifier extension</a> missing the <code class="language-plaintext highlighter-rouge">keyIdentifier</code> field. Fort was referencing the pointer without sanitizing it first.</td>
    </tr>
    <tr>
      <td>Impact</td>
      <td>Crash. (Potential unavailability of Route Origin Validation.)</td>
    </tr>
    <tr>
      <td>Patch</td>
      <td>Commit <a href="https://github.com/NICMx/FORT-validator/commit/b1eb3c507ae920859bbe294776ebc2bb30bb7e56">b1eb3c5</a>, released in Fort 1.6.3.</td>
    </tr>
    <tr>
      <td>Acknowledgments</td>
      <td>Thanks to Niklas Vogel and Haya Schulmann for their research and disclosure.</td>
    </tr>
  </tbody>
</table>

<h2 id="cve-2024-45236">CVE-2024-45236</h2>

<p>Signed Object containing empty <code class="language-plaintext highlighter-rouge">signedAttrs</code> crashes Fort 1.6.2-.</p>

<table>
  <tbody>
    <tr>
      <td>Description</td>
      <td>A malicious RPKI repository that descends from a (trusted) Trust Anchor can serve (via rsync or RRDP) a signed object containing an empty <a href="https://datatracker.ietf.org/doc/html/rfc6488#section-2.1.6.4"><code class="language-plaintext highlighter-rouge">signedAttributes</code></a>. Fort was accessing the set’s elements without sanitizing it first.</td>
    </tr>
    <tr>
      <td>Impact</td>
      <td>Crash. (Potential unavailability of Route Origin Validation.)</td>
    </tr>
    <tr>
      <td>Patch</td>
      <td>Commit <a href="https://github.com/NICMx/FORT-validator/commit/4dafbd9de64a5a0616af97365bc1751465b29d2e">4dafbd9</a>, released in Fort 1.6.3.</td>
    </tr>
    <tr>
      <td>Acknowledgments</td>
      <td>Thanks to Niklas Vogel and Haya Schulmann for their research and disclosure.</td>
    </tr>
  </tbody>
</table>

<h2 id="cve-2024-45239">CVE-2024-45239</h2>

<p>Signed Object containing null <code class="language-plaintext highlighter-rouge">eContent</code> crashes Fort 1.6.2-.</p>

<table>
  <tbody>
    <tr>
      <td>Description</td>
      <td>A malicious RPKI repository that descends from a (trusted) Trust Anchor can serve (via rsync or RRDP) a ROA or Manifest containing a null <a href="https://datatracker.ietf.org/doc/html/rfc6488#section-2.1.3.2"><code class="language-plaintext highlighter-rouge">eContent</code></a>. Fort was dereferencing the pointer without sanitizing it first.</td>
    </tr>
    <tr>
      <td>Impact</td>
      <td>Crash. (Potential unavailability of Route Origin Validation.)</td>
    </tr>
    <tr>
      <td>Patch</td>
      <td>Commit <a href="https://github.com/NICMx/FORT-validator/commit/942f921ba7244cdcf4574cedc4c16392a7cc594b">942f921</a>, released in Fort 1.6.3.</td>
    </tr>
    <tr>
      <td>Acknowledgments</td>
      <td>Thanks to Niklas Vogel and Haya Schulmann for their research and disclosure.</td>
    </tr>
  </tbody>
</table>

<h2 id="cve-2024-45234">CVE-2024-45234</h2>

<p>Certificate containing <code class="language-plaintext highlighter-rouge">signedAttrs</code> not in canonical form crashes Fort 1.6.2-.</p>

<table>
  <tbody>
    <tr>
      <td>Description</td>
      <td>A malicious RPKI repository that descends from a (trusted) Trust Anchor can serve (via rsync or RRDP) a ROA or Manifest containing a <code class="language-plaintext highlighter-rouge">signedAttrs</code> encoded in non-canonical form. This bypassed the BER-decoder, reaching a point in the code that panicked when faced with data not encoded in DER.</td>
    </tr>
    <tr>
      <td>Impact</td>
      <td>Crash. (Potential unavailability of Route Origin Validation.)</td>
    </tr>
    <tr>
      <td>Patch</td>
      <td>Commit <a href="https://github.com/NICMx/FORT-validator/commit/521b1a0db5041258096fbabdf8fc1e10ecc793cf">521b1a0</a>, released in Fort 1.6.3.</td>
    </tr>
    <tr>
      <td>Acknowledgments</td>
      <td>Thanks to Niklas Vogel and Haya Schulmann for their research and disclosure.</td>
    </tr>
  </tbody>
</table>

<h2 id="cve-2024-48943">CVE-2024-48943</h2>

<p>Malicious rsync repositories can block Fort by drip-feeding repository objects.</p>

<table>
  <tbody>
    <tr>
      <td>Description</td>
      <td>A malicious RPKI rsync repository can prevent Fort from finishing its validation run by drip-feeding its content.</td>
    </tr>
    <tr>
      <td>Impact</td>
      <td>Delayed validation. (Stale or unavailable Route Origin Validation.)</td>
    </tr>
    <tr>
      <td>Patch</td>
      <td>Commit <a href="https://github.com/NICMx/FORT-validator/commit/4ee88d1c3fa7df763dd52312134cd93c1ce50870">4ee88d1</a>, released in Fort 1.6.4.</td>
    </tr>
    <tr>
      <td>Acknowledgments</td>
      <td>Thanks to Koen van Hove for his research and disclosure, and Job Snijders for the proposed fix.</td>
    </tr>
  </tbody>
</table>

<h2 id="cve-2024-56170">CVE-2024-56170</h2>

<p>Fort is employing the latest fetched manifest, rather than the one with the most recent metadata.</p>

<table>
  <tbody>
    <tr>
      <td>Description</td>
      <td>RPKI manifests are listings of relevant files that clients are supposed to verify.<br />Assuming everything else is correct, the most recent version of a manifest should be prioritized over other versions, to prevent replays, accidental or otherwise.<br />Manifests contain the <code class="language-plaintext highlighter-rouge">manifestNumber</code> and <code class="language-plaintext highlighter-rouge">thisUpdate</code> fields, which can be used to gauge the relevance of a given manifest, when compared to other manifests. The former is a serial-like sequential number, and the latter is the date in which the manifest was created.<br />Fort is not comparing the up-to-dateness of the most recently-fetched manifest against the cached manifest. As such, it’s prone to roll back into a previous version if it’s served a valid outdated manifest.</td>
    </tr>
    <tr>
      <td>Impact</td>
      <td>Outdated Route Origin Validation.</td>
    </tr>
    <tr>
      <td>Patch</td>
      <td>Scheduled for Fort release <a href="https://github.com/NICMx/FORT-validator/milestone/12">2.0.0</a>.</td>
    </tr>
    <tr>
      <td>Acknowledgments</td>
      <td>Job Snijders</td>
    </tr>
  </tbody>
</table>

<h2 id="cve-2024-56169">CVE-2024-56169</h2>

<p>Fort’s cache provides insufficient fallbacking.</p>

<table>
  <tbody>
    <tr>
      <td>Description</td>
      <td>RPKI Relying Parties (such as Fort) are supposed to maintain a backup cache of the remote RPKI data. This can be employed as fallback in case a new fetch fails or yields incorrect files.<br />Fort is presently using its cache merely as a bandwidth saving tool. (Because the fetching is performed through deltas.) If a fetch fails midway or yields incorrect files, Fort is left without a viable fallback.</td>
    </tr>
    <tr>
      <td>Impact</td>
      <td>Incomplete Route Origin Validation data.</td>
    </tr>
    <tr>
      <td>Patch</td>
      <td>Scheduled for Fort release <a href="https://github.com/NICMx/FORT-validator/milestone/12">2.0.0</a>.</td>
    </tr>
    <tr>
      <td>Acknowledgments</td>
      <td>Ties de Kock</td>
    </tr>
    <tr>
      <td>Issue</td>
      <td><a href="https://github.com/NICMx/FORT-validator/issues/82">82</a></td>
    </tr>
  </tbody>
</table>

<h2 id="cve-2024-56375">CVE-2024-56375</h2>

<p>Manifest containing empty <code class="language-plaintext highlighter-rouge">fileList</code> crashes Fort 1.6.3, 1.6.4.</p>

<table>
  <tbody>
    <tr>
      <td>Description</td>
      <td>A malicious RPKI repository that descends from a (trusted) Trust Anchor can serve (via rsync or RRDP) a Manifest RPKI object containing an empty fileList.<br />Fort dereferences (and shortly afterwards writes) this array during a shuffle attempt, before the validation that would normally reject it when empty.<br />This out-of-bounds access is caused by an integer underflow that causes the surrounding loop to iterate infinitely. As Fort gets stuck permanently attempting to overshuffle an array that doesn’t actually exist, a crash is pretty much guaranteed.</td>
    </tr>
    <tr>
      <td>Impact</td>
      <td>Crash. (Potential unavailability of Route Origin Validation.)</td>
    </tr>
    <tr>
      <td>Patch</td>
      <td>Commit <a href="https://github.com/NICMx/FORT-validator/commit/17f095210553182b0e0a28ee6fd41b0d3c8fc1d3">17f0952</a>, released in Fort 1.6.5.</td>
    </tr>
    <tr>
      <td>Acknowledgments</td>
      <td>Niklas Vogel</td>
    </tr>
  </tbody>
</table>

				</article>
			</div>
		</div>
	</div>
</section>
<!-- Footer -->
<footer class="site-footer">
	<div class="container">
		<div class="row align-items-center">
			<div class="col">
			</div>
			<div class="col">
				<a href="https://github.com/NICMx/FORT-validator" target="_blank" title="" class="d-flex justify-content-center">
					<img src="./img/GitHub-Mark-Light-120px-plus.png" alt="Git" width="40">
				</a>
			</div>
			<div class="col-lg text-right">
				<a href="mailto:validadorfort@fortproject.net" target="_blank" title="">validadorfort@fortproject.net</a>
			</div>
		</div>
	</div>
</footer>

<div class="js-overlay overlay-content"></div>

<!-- Bootstrap js -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

<!-- APP JS -->
<script src="./js/metodos.js" type="text/javascript"></script>


</body>
</html>
