

| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=51fa08edd80003db700bdaa099385c5900d27f4b)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=51fa08edd80003db700bdaa099385c5900d27f4b)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=51fa08edd80003db700bdaa099385c5900d27f4b)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=51fa08edd80003db700bdaa099385c5900d27f4b)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Dmitry Torokhov <dmitry.torokhov@gmail.com> | 2024-08-04 17:50:25 -0700 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-09-12 11:06:49 +0200 |
| commit | [51fa08edd80003db700bdaa099385c5900d27f4b](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=51fa08edd80003db700bdaa099385c5900d27f4b) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=51fa08edd80003db700bdaa099385c5900d27f4b)) | |
| tree | [fb970eb8491e32ef6841d4bd00a403e0e5798b90](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=51fa08edd80003db700bdaa099385c5900d27f4b) | |
| parent | [34185de73d74fdc90e8651cfc472bfea6073a13f](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=34185de73d74fdc90e8651cfc472bfea6073a13f) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=51fa08edd80003db700bdaa099385c5900d27f4b&id2=34185de73d74fdc90e8651cfc472bfea6073a13f)) | |
| download | [linux-51fa08edd80003db700bdaa099385c5900d27f4b.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-51fa08edd80003db700bdaa099385c5900d27f4b.tar.gz) | |

Input: uinput - reject requests with unreasonable number of slots[ Upstream commit 206f533a0a7c683982af473079c4111f4a0f9f5e ]
From: Dmitry Torokhov <dmitry.torokhov@gmail.com>
When exercising uinput interface syzkaller may try setting up device
with a really large number of slots, which causes memory allocation
failure in input\_mt\_init\_slots(). While this allocation failure is
handled properly and request is rejected, it results in syzkaller
reports. Additionally, such request may put undue burden on the
system which will try to free a lot of memory for a bogus request.
Fix it by limiting allowed number of slots to 100. This can easily
be extended if we see devices that can track more than 100 contacts.
Reported-by: Tetsuo Handa <penguin-kernel@I-love.SAKURA.ne.jp>
Reported-by: syzbot <syzbot+0122fa359a69694395d5@syzkaller.appspotmail.com>
Closes: https://syzkaller.appspot.com/bug?extid=0122fa359a69694395d5
Link: [https://lore.kernel.org/r/Zqgi7NYEbpRsJfa2@google.com](https://lore.kernel.org/r/Zqgi7NYEbpRsJfa2%40google.com)
Signed-off-by: Dmitry Torokhov <dmitry.torokhov@gmail.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=51fa08edd80003db700bdaa099385c5900d27f4b)

| -rw-r--r-- | [drivers/input/misc/uinput.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/input/misc/uinput.c?id=51fa08edd80003db700bdaa099385c5900d27f4b) | 14 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 14 insertions, 0 deletions

| diff --git a/drivers/input/misc/uinput.c b/drivers/input/misc/uinput.cindex f2593133e5247a..790db3ceb2083a 100644--- a/[drivers/input/misc/uinput.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/input/misc/uinput.c?id=34185de73d74fdc90e8651cfc472bfea6073a13f)+++ b/[drivers/input/misc/uinput.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/input/misc/uinput.c?id=51fa08edd80003db700bdaa099385c5900d27f4b)@@ -416,6 +416,20 @@ static int uinput\_validate\_absinfo(struct input\_dev \*dev, unsigned int code, return -EINVAL; } + /\*+ \* Limit number of contacts to a reasonable value (100). This+ \* ensures that we need less than 2 pages for struct input\_mt+ \* (we are not using in-kernel slot assignment so not going to+ \* allocate memory for the "red" table), and we should have no+ \* trouble getting this much memory.+ \*/+ if (code == ABS\_MT\_SLOT && max > 99) {+ printk(KERN\_DEBUG+ "%s: unreasonably large number of slots requested: %d\n",+ UINPUT\_NAME, max);+ return -EINVAL;+ }+ return 0; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 07:21:19 +0000

