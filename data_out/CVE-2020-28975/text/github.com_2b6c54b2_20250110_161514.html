
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fscikit-learn%2Fscikit-learn%2Fissues%2F18891)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fscikit-learn%2Fscikit-learn%2Fissues%2F18891)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=scikit-learn%2Fscikit-learn)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[scikit-learn](/scikit-learn)
/
**[scikit-learn](/scikit-learn/scikit-learn)**
Public

* [Notifications](/login?return_to=%2Fscikit-learn%2Fscikit-learn) You must be signed in to change notification settings
* [Fork
  25.5k](/login?return_to=%2Fscikit-learn%2Fscikit-learn)
* [Star
   60.7k](/login?return_to=%2Fscikit-learn%2Fscikit-learn)

* [Code](/scikit-learn/scikit-learn)
* [Issues
  1.6k](/scikit-learn/scikit-learn/issues)
* [Pull requests
  559](/scikit-learn/scikit-learn/pulls)
* [Discussions](/scikit-learn/scikit-learn/discussions)
* [Actions](/scikit-learn/scikit-learn/actions)
* [Projects
  15](/scikit-learn/scikit-learn/projects)
* [Wiki](/scikit-learn/scikit-learn/wiki)
* [Security](/scikit-learn/scikit-learn/security)
* [Insights](/scikit-learn/scikit-learn/pulse)

Additional navigation options

* [Code](/scikit-learn/scikit-learn)
* [Issues](/scikit-learn/scikit-learn/issues)
* [Pull requests](/scikit-learn/scikit-learn/pulls)
* [Discussions](/scikit-learn/scikit-learn/discussions)
* [Actions](/scikit-learn/scikit-learn/actions)
* [Projects](/scikit-learn/scikit-learn/projects)
* [Wiki](/scikit-learn/scikit-learn/wiki)
* [Security](/scikit-learn/scikit-learn/security)
* [Insights](/scikit-learn/scikit-learn/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fscikit-learn%2Fscikit-learn%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fscikit-learn%2Fscikit-learn%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Segmentation fault on SVMLIB #18891

Closed

[pabloec20](/pabloec20) opened this issue
Nov 21, 2020
· 11 comments
 · Fixed by [#21336](https://github.com/scikit-learn/scikit-learn/pull/21336)

Closed

# [Segmentation fault on SVMLIB](#top) #18891

[pabloec20](/pabloec20) opened this issue
Nov 21, 2020
· 11 comments
 · Fixed by [#21336](https://github.com/scikit-learn/scikit-learn/pull/21336)

## Comments

[![@pabloec20](https://avatars.githubusercontent.com/u/24191742?s=80&v=4)](/pabloec20)

Copy link

### **[pabloec20](/pabloec20)** commented [Nov 21, 2020](#issue-748032145) • edited by NicolasHug Loading

| Description: In Scikit-learn version 0.23.2 calling the predict() method maliciously crafted model SVM can result in a segmentation fault. Such models can be introduced via pickle, json, or any other model permanence standard. The behaviour is triggered when one of the members of the \_n\_support array has a very large value, example [1000000](https://github.com/scikit-learn/scikit-learn/commit/1000000c72c9cf9bdfe59f0baf561ad29fef60f2) when calling libsvm.predict()  ####Tested environment:  Ubuntu 9.3.0-17ubuntu1~20.04 Python 3.8.5 (default, Jul 28 2020, 12:59:40) [GCC 9.3.0] on linux Numpy version: '1.19.2' Sklearn.**version**: '0.23.2' Steps/Code to Reproduce ``` from sklearn import svm from sklearn import datasets   if __name__ == '__main__':     X,y = datasets.load_iris(return_X_y=True)     clf = svm.SVC()     clf.fit(X, y)     clf._n_support[0] = 1000000     y_pred = clf.predict(X) ``` Expected Results not to fail Actual Results Segmentation fault, this is a debugger trace  `Thread 1 "python3-dbg" received signal SIGSEGV, Segmentation fault. 0x00007fffd7174df7 in svm_predict_values () from /home/pablo/.local/lib/python3.8/site-packages/sklearn/svm/_libsvm.cpython-38-x86_64-linux-gnu.so (gdb) bt #0 0x00007fffd7174df7 in svm_predict_values () from /home/pablo/.local/lib/python3.8/site-packages/sklearn/svm/_libsvm.cpython-38-x86_64-linux-gnu.so #1 0x00007fffd717504f in svm_predict () from /home/pablo/.local/lib/python3.8/site-packages/sklearn/svm/_libsvm.cpython-38-x86_64-linux-gnu.so #2 0x00007fffd7163e57 in copy_predict () from /home/pablo/.local/lib/python3.8/site-packages/sklearn/svm/_libsvm.cpython-38-x86_64-linux-gnu.so #3 0x00007fffd716bb3a in ?? () from /home/pablo/.local/lib/python3.8/site-packages/sklearn/svm/_libsvm.cpython-38-x86_64-linux-gnu.so #4 0x00007fffd716d47d in ?? () from /home/pablo/.local/lib/python3.8/site-packages/sklearn/svm/_libsvm.cpython-38-x86_64-linux-gnu.so #5 0x000000000043663e in cfunction_call_varargs (func=0x7fffd76e9dd0, args=0x7fffd40fc1d0, kwargs=0x7fffd40fbdd0) at ../Objects/call.c:742 #6 0x000000000043920c in PyCFunction_Call (func=<optimized out>, args=<optimized out>, kwargs=<optimized out>) at ../Objects/call.c:772 #7 0x000000000043708b in _PyObject_MakeTpCall (callable=callable@entry=0x7fffd76e9dd0, args=args@entry=0x18433a0, nargs=<optimized out>, keywords=keywords@entry=0x7fffd7821de0) at ../Objects/call.c:159 #8 0x00000000004ebe5b in _PyObject_Vectorcall (kwnames=0x7fffd7821de0, nargsf=9223372036854775816, args=0x18433a0, callable=0x7fffd76e9dd0) at ../Include/cpython/abstract.h:125 #9 call_function (kwnames=0x7fffd7821de0, oparg=<optimized out>, pp_stack=<synthetic pointer>, tstate=0x954500) at ../Python/ceval.c:4963 #10 _PyEval_EvalFrameDefault (f=0x1843210, throwflag=<optimized out>) at ../Python/ceval.c:3515 #11 0x00000000004df2ef in PyEval_EvalFrameEx (f=` Versions System: python: 3.8.5 (default, Jul 28 2020, 12:59:40) [GCC 9.3.0] executable: /usr/bin/python3 machine: Linux-5.4.0-53-generic-x86\_64-with-glibc2.29  Python dependencies: pip: 20.0.2 setuptools: 45.2.0 sklearn: 0.23.2 numpy: 1.19.2 scipy: 1.5.2 Cython: None pandas: 1.1.2 matplotlib: 3.3.2 joblib: 0.16.0 threadpoolctl: 2.1.0  Built with OpenMP: True |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@pabloec20](https://avatars.githubusercontent.com/u/24191742?s=40&v=4)](/pabloec20)
[pabloec20](/pabloec20)
added
the
[Bug: triage](/scikit-learn/scikit-learn/labels/Bug%3A%20triage)
label
[Nov 21, 2020](#event-4023905506)

[![@carnil](https://avatars.githubusercontent.com/u/773068?s=80&u=54a9fd1cfc2b1abb34a487f17e07eb8a03cecdae&v=4)](/carnil)

Copy link

### **[carnil](/carnil)** commented [Nov 22, 2020](#issuecomment-731714716)

| This issue was assigned [CVE-2020-28975](https://github.com/advisories/GHSA-jxfp-4rvq-9h9m "CVE-2020-28975") |
| --- |

All reactions

Sorry, something went wrong.

[![@NicolasHug](https://avatars.githubusercontent.com/u/1190450?s=80&u=c20b01c8240814fa1358eb1fb2c91e73bc02e546&v=4)](/NicolasHug)

Copy link

Member

### **[NicolasHug](/NicolasHug)** commented [Nov 22, 2020](#issuecomment-731720782)

| `clf._n_support[0] = 1000000`  It's expected that manually changing a private attribute will lead to wrong results, or even segfault as is the case here.  May I ask why you want to change the number of SVs, and why you expected it to work? Changing it likely leads the program to overshoot indexing in an array somewhere. For ref, there are 7 SVs for class `0`. |
| --- |

All reactions

Sorry, something went wrong.

[![@NicolasHug](https://avatars.githubusercontent.com/u/1190450?s=40&u=c20b01c8240814fa1358eb1fb2c91e73bc02e546&v=4)](/NicolasHug)
[NicolasHug](/NicolasHug)
closed this as [completed](/scikit-learn/scikit-learn/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Nov 22, 2020](#event-4024612541)

[![@pabloec20](https://avatars.githubusercontent.com/u/24191742?s=80&v=4)](/pabloec20)

Copy link

Author

### **[pabloec20](/pabloec20)** commented [Nov 22, 2020](#issuecomment-731742446)

| It should not segfault but fail gracefully. |
| --- |

All reactions

Sorry, something went wrong.

[![@NicolasHug](https://avatars.githubusercontent.com/u/1190450?s=80&u=c20b01c8240814fa1358eb1fb2c91e73bc02e546&v=4)](/NicolasHug)

Copy link

Member

### **[NicolasHug](/NicolasHug)** commented [Nov 22, 2020](#issuecomment-731774616)

| The snippet above is changing a *private* attribute (it has a leading underscore).  By definition, these aren't supposed to be changed by the user. When they're used by the estimator, it's fair to assume that they are properly set to a correct value.  We can't safe-guard against every single misuse, and this is a misuse. |
| --- |

All reactions

Sorry, something went wrong.

[![@pabloec20](https://avatars.githubusercontent.com/u/24191742?s=80&v=4)](/pabloec20)

Copy link

Author

### **[pabloec20](/pabloec20)** commented [Nov 22, 2020](#issuecomment-731778147)

| Consider the common scenario when a model is trained in a research machine and then transfered for production use to live environment, if a malicious actor is able to take a hold of the model and change it, it should not be able to trigger a segmentation fault, please bear in mind the segfaults may have security implications other than crashing the process. |
| --- |

All reactions

Sorry, something went wrong.

[![@NicolasHug](https://avatars.githubusercontent.com/u/1190450?s=80&u=c20b01c8240814fa1358eb1fb2c91e73bc02e546&v=4)](/NicolasHug)

Copy link

Member

### **[NicolasHug](/NicolasHug)** commented [Nov 22, 2020](#issuecomment-731779378)

| if a malicious actor  This is where it's out of scope here: we can't guard against everything. We have a responsibility to provide safe code when that code is used under the limits of what's a normal use-case, but that's pretty much it. Private attributes shouldn't be modified, and it's up to users to make sure that the estimator isn't maliciously altered.  I might go on a limb and use a poor analogy but when I buy a car, I can't complain that it breaks if I replace the steering wheel by a potato.  If you really want to prevent segfaults, maybe you can intercept the `SIGSEGV`? |
| --- |

All reactions

Sorry, something went wrong.

[![@pabloec20](https://avatars.githubusercontent.com/u/24191742?s=80&v=4)](/pabloec20)

Copy link

Author

### **[pabloec20](/pabloec20)** commented [Nov 26, 2020](#issuecomment-734484234) • edited Loading

| To reuse you example: If someone switches the steering wheel for a potato, the car should not completelly break/fail unrecoverably the moment you turn it on and if it happens it would be considered a security risk would it no? You would not just say the driver to wear a helmet instead or would you? |
| --- |

All reactions

Sorry, something went wrong.

[![@jnothman](https://avatars.githubusercontent.com/u/78827?s=80&u=17334e24ba35d41cad10bc633e981ea82a2016e6&v=4)](/jnothman)

Copy link

Member

### **[jnothman](/jnothman)** commented [Nov 27, 2020](#issuecomment-734523160) via email

| Pickles are unsafe in any case. If you submit a pull request to avoid the segfault we can consider it. |
| --- |

 👍
1
 rth reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@pabloec20](https://avatars.githubusercontent.com/u/24191742?s=80&v=4)](/pabloec20)

Copy link

Author

### **[pabloec20](/pabloec20)** commented [Nov 30, 2020](#issuecomment-736093339)

| There are other ways to export a model which are not via pickle, and this does not require pickle at all. |
| --- |

All reactions

Sorry, something went wrong.

[![@bkreider](https://avatars.githubusercontent.com/u/1699478?s=80&v=4)](/bkreider)

Copy link

### **[bkreider](/bkreider)** commented [Oct 14, 2021](#issuecomment-943667409)

| This is where it's out of scope here: we can't guard against everything.  Isn't the model loader improperly validating the model and then segfaulting? Is pickle the only way to load a model?  The proof of concept exploit code is just using the private attribute to shorten the example. Perhaps it should have used a comment there describing "loading a model with a modified n value"?  This high CVE score is tripping up people trying to use scikit learn in regulated and secure environments. |
| --- |

 👍
1
 ogrisel reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@rth](https://avatars.githubusercontent.com/u/630936?s=80&u=b5970c1f09aabdac20bd07baa3dccfb424ec0d5d&v=4)](/rth)

Copy link

Member

### **[rth](/rth)** commented [Oct 14, 2021](#issuecomment-943776320)

| This high CVE score is tripping up people trying to use scikit learn in regulated and secure environments.  Hmm, yes <https://nvd.nist.gov/vuln/detail/CVE-2020-28975> and those are really used for enterprise deployment. We could do a bit more sanity checks in   [scikit-learn/sklearn/svm/\_libsvm.pyx](https://github.com/scikit-learn/scikit-learn/blob/b43f057b22dead2e98669b8f7931eaf86d24b1d1/sklearn/svm/_libsvm.pyx#L279)  Line 279 in [b43f057](/scikit-learn/scikit-learn/commit/b43f057b22dead2e98669b8f7931eaf86d24b1d1)   |  | def predict(np.ndarray[np.float64\_t, ndim=2, mode='c'] X, | | --- | --- |    to make that CVE go await, even if it would be difficult to be fully fail proof. A PR would be welcome. |
| --- | --- | --- |

 👍
1
 ogrisel reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@thomasjpfan](https://avatars.githubusercontent.com/u/5402633?s=40&v=4)](/thomasjpfan)
[thomasjpfan](/thomasjpfan)
reopened this
[Oct 15, 2021](#event-5466975054)

[![@thomasjpfan](https://avatars.githubusercontent.com/u/5402633?s=40&v=4)](/thomasjpfan)
[thomasjpfan](/thomasjpfan)
mentioned this issue
[Oct 15, 2021](#ref-pullrequest-1026931081)

[FIX Prevents segfault in SVC when internals are altered
#21336](/scikit-learn/scikit-learn/pull/21336)
 Merged

[![@glemaitre](https://avatars.githubusercontent.com/u/7454015?s=40&u=d9704641f89c00ce86f8207e59aedb554109d7fa&v=4)](/glemaitre)
[glemaitre](/glemaitre)
closed this as [completed](/scikit-learn/scikit-learn/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
in
[#21336](/scikit-learn/scikit-learn/pull/21336)
[Oct 20, 2021](#event-5491561743)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fscikit-learn%2Fscikit-learn%2Fissues%2F18891)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging a pull request may close this issue.

 [FIX Prevents segfault in SVC when internals are altered](/scikit-learn/scikit-learn/pull/21336)
 [thomasjpfan/scikit-learn](/thomasjpfan/scikit-learn)

7 participants

[![@jnothman](https://avatars.githubusercontent.com/u/78827?s=52&v=4)](/jnothman) [![@rth](https://avatars.githubusercontent.com/u/630936?s=52&v=4)](/rth) [![@carnil](https://avatars.githubusercontent.com/u/773068?s=52&v=4)](/carnil) [![@NicolasHug](https://avatars.githubusercontent.com/u/1190450?s=52&v=4)](/NicolasHug) [![@bkreider](https://avatars.githubusercontent.com/u/1699478?s=52&v=4)](/bkreider) [![@thomasjpfan](https://avatars.githubusercontent.com/u/5402633?s=52&v=4)](/thomasjpfan) [![@pabloec20](https://avatars.githubusercontent.com/u/24191742?s=52&v=4)](/pabloec20)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

