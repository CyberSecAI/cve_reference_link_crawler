- **Root cause of vulnerability:** The `mk_informix` plugin in Checkmk previously used `eval` to process statements parsed from `$INFORMIXDIR/bin/onstat`. Also, the plugin prioritized `$INFORMIXDIR/bin` over `$PATH` when searching for executable files, and executed `$INFORMIXDIR/bin/onstat` as root without verification.
- **Weaknesses/vulnerabilities present:**
    - **Code Injection:** Using `eval` on content from `$INFORMIXDIR/bin/onstat` allows for the injection of arbitrary code.
    - **Path Hijacking:** Prioritizing `$INFORMIXDIR/bin` in the `$PATH` allows an attacker to replace system commands with malicious scripts.
    - **Privilege Escalation:** Executing `$INFORMIXDIR/bin/onstat` as root, allows a user to execute a script with root privileges if they can modify the contents of `$INFORMIXDIR/bin/onstat`.
- **Impact of exploitation:** An attacker with local access could escalate privileges to root and execute arbitrary code.
- **Attack vectors:**
    - Manipulating the contents of the file `$INFORMIXDIR/bin/onstat`.
    - Placing malicious scripts in `$INFORMIXDIR/bin`.
- **Required attacker capabilities/position:**
    - The attacker needs to have the ability to write to `$INFORMIXDIR/bin`.
    - They also need the ability to execute the `mk_informix` plugin, which typically runs as root.