=== Content from research.splunk.com_f8ea20af_20250110_155353.html ===

[![Splunk Security Content Logo](https://research.splunk.com/images/logo.svg)](https://research.splunk.com/)

* [Analytic Stories](https://research.splunk.com/stories/)
* [Detections](https://research.splunk.com/detections/)
* [Playbooks](https://research.splunk.com/playbooks/)
* [Data Sources](https://research.splunk.com/sources/)
* [Blog](https://www.splunk.com/en_us/blog/author/secmrkt-research.html)
* [About](http://splunk.com/threat-research)
* [![GitHub Repo](https://research.splunk.com/images/GitHubMarkLight.svg)](https://github.com/splunk/security_content)

## Table of Contents

* + [Description](#description)
  + [Search](#search)
  + [Data Source](#data-source)
  + [Macros Used](#macros-used)
  + [Annotations](#annotations)
  + [Default Configuration](#default-configuration)
  + [Implementation](#implementation)
  + [Known False Positives](#known-false-positives)
  + [Associated Analytic Story](#associated-analytic-story)
  + [Risk Based Analytics (RBA)](#risk-based-analytics-rba)
  + [References](#references)
  + [Detection Testing](#detection-testing)

# Detection: Splunk Unauthenticated Path Traversal Modules Messaging

Updated Date: 2024-10-17
ID: e7c2b064-524e-4d65-8002-efce808567aa
Author: Rod Soto, Chase Franklin
[Type: Hunting](#default-configuration)
[Product: Splunk Enterprise Security](https://www.splunk.com/en_us/products/enterprise-security.html)
### Description

This hunting search provides information on exploitation attempts against /modules/messaging endpoint, the exploit can be clearly seen as the ../ which signals an attempt to traverse target directories.

### Search

```
1`splunkd_web` method=GET uri_path="/*/modules/messaging/*..*"
2| stats min(_time) as firstTime max(_time) as lastTime values(method) as method values(uri_path) as uri_path by host
3| `security_content_ctime(firstTime)`
4| `security_content_ctime(lastTime)`
5| `splunk_unauthenticated_path_traversal_modules_messaging_filter`

```
### Data Source

| Name | Platform | Sourcetype | Source |
| --- | --- | --- | --- |
| [Splunk](/sources/d8a2c791-460b-4756-a8e5-ecade77b21e3) | Splunk icon [Splunk](/platform/splunk) | `'splunkd_ui_access'` | `'splunkd_ui_access.log'` |

### Macros Used

| Name | Value |
| --- | --- |
| [security\_content\_ctime](https://github.com/splunk/security_content/blob/develop/macros/security_content_ctime.yml) | `convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)` |
| splunk\_unauthenticated\_path\_traversal\_modules\_messaging\_filter | `search *` |

`splunk_unauthenticated_path_traversal_modules_messaging_filter` is an empty macro by default. It allows the user to filter out any results (false positives) without editing the SPL.
### Annotations

- MITRE ATT&CK

+ Kill Chain Phases

+ NIST

+ CIS

- Threat Actors

| ID | Technique | Tactic |
| --- | --- | --- |
| [T1083](https://attack.mitre.org/techniques/T1083/) | File and Directory Discovery | Discovery |

KillChainPhase.EXPLOITAITON

NistCategory.DE\_AE

Cis18Value.CIS\_10

APT18
APT28
APT3
APT32
APT38
APT39
APT41
APT5
Aoqin Dragon
BRONZE BUTLER
Chimera
Confucius
Dark Caracal
Darkhotel
Dragonfly
FIN13
Fox Kitten
Gamaredon Group
HAFNIUM
Inception
Ke3chang
Kimsuky
Lazarus Group
Leafminer
LuminousMoth
Magic Hound
MuddyWater
Mustang Panda
Patchwork
Play
RedCurl
Sandworm Team
Scattered Spider
Sidewinder
Sowbug
TeamTNT
ToddyCat
Tropic Trooper
Turla
Volt Typhoon
Windigo
Winnti Group
Winter Vivern
admin@338
menuPass

### Default Configuration

This detection is configured by default in Splunk Enterprise Security to run with the following settings:

| Setting | Value |
| --- | --- |
| Disabled | true |
| Cron Schedule | `0 * * * *` |
| Earliest Time | `-70m@m` |
| Latest Time | `-10m@m` |
| Schedule Window | `auto` |
| Creates Risk Event | False |

This configuration file applies to all detections of type hunting.
### Implementation

Only applies to Microsoft Windows installations of Splunk.

### Known False Positives

May catch other exploitation attempts using path traversal related characters.

### Associated Analytic Story

* [Splunk Vulnerabilities](/stories/splunk_vulnerabilities/)

### Risk Based Analytics (RBA)

| Risk Message | Risk Score | Impact | Confidence |
| --- | --- | --- | --- |
| Possible directory traversal attack against $host$ | 20 | 20 | 100 |

The Risk Score is calculated by the following formula: Risk Score = (Impact \* Confidence/100). Initial Confidence and Impact is set by the analytic author.
### References

* <https://advisory.splunk.com/SVD-2024-0711>

### Detection Testing

| Test Type | Status | Dataset | Source | Sourcetype |
| --- | --- | --- | --- | --- |
| Validation | â [Passing](https://github.com/splunk/security_content/actions/workflows/build.yml) | N/A | N/A | N/A |
| Unit | â [Passing](https://github.com/splunk/security_content/actions/workflows/build.yml) | [Dataset](https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1083/splunk/SVD-2024-0711_web_access_splunk_web_access.log) | `C:\\Program Files\\Splunk\\var\\log\\splunk\\web_access.log` | `splunk_web_access` |
| Integration | â Passing | [Dataset](https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1083/splunk/SVD-2024-0711_web_access_splunk_web_access.log) | `C:\\Program Files\\Splunk\\var\\log\\splunk\\web_access.log` | `splunk_web_access` |

Replay any dataset to Splunk Enterprise by using our [`replay.py`](https://github.com/splunk/attack_data#using-replaypy) tool or the [UI](https://github.com/splunk/attack_data#using-ui).
Alternatively you can replay a dataset into a [Splunk Attack Range](https://github.com/splunk/attack_range#replay-dumps-into-attack-range-splunk-server)

---

Source: [GitHub](https://github.com/splunk/security_content/tree/develop/detections/application/splunk_unauthenticated_path_traversal_modules_messaging.yml) |
Version: **2**

[Detection: Splunk Unauthenticated DoS via Null Pointer References](https://research.splunk.com/application/d67594fe-c317-41b8-9319-ec8428d5c2ea/ "Detection: Splunk Unauthenticated DoS via Null Pointer References")

[Detection: Splunk Unauthorized Experimental Items Creation](https://research.splunk.com/application/84afda04-0cd6-466b-869e-70d6407d0a34/ "Detection: Splunk Unauthorized Experimental Items Creation")

Â© 2005 - 2024 Splunk LLC All rights reserved.



=== Content from advisory.splunk.com_6ae39ea2_20250110_155351.html ===
 [![ ](/assets/img/logo.svg)](https://www.splunk.com/)

* [Home](/)
* [Report a Vulnerability](/report)
* [FAQs](/faqs)
* [Mailing List](https://www.splunk.com/en_us/form/splunk-security-advisories-notification.html)

 Toggle menu

* [Home](/)
* [Report a Vulnerability](/report)
* [FAQs](/faqs)
* [Mailing List](https://www.splunk.com/en_us/form/splunk-security-advisories-notification.html)
# Path Traversal on the “/modules/messaging/“ endpoint in Splunk Enterprise on Windows

**Advisory ID:** SVD-2024-0711

**CVE ID:** [CVE-2024-36991](https://www.cve.org/CVERecord?id=CVE-2024-36991)

**Published:** 2024-07-01

**Last Update:** 2024-07-01

**CVSSv3.1 Score:** 7.5, High

**CVSSv3.1 Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N)

**CWE:** [CWE-35](https://cwe.mitre.org/data/definitions/35.html)

**Bug ID:** VULN-15637

## Description

In Splunk Enterprise versions below 9.2.2, 9.1.5, and 9.0.10, an attacker could perform a path traversal on the `/modules/messaging/` endpoint in Splunk Enterprise on Windows.

The vulnerability exists because the Python `os.path.join` function removes the drive letter from path tokens if the drive in the token matches the drive in the built path.

This vulnerability should only affect Splunk Enterprise on Windows.

## Solution

Upgrade Splunk Enterprise to versions 9.2.2, 9.1.5, and 9.0.10, or higher.

## Product Status

| Product | Version | Component | Affected Version | Fix Version |
| --- | --- | --- | --- | --- |
| Splunk Enterprise | 9.2 | Splunk Web | 9.2.0 to 9.2.1 | 9.2.2 |
| Splunk Enterprise | 9.1 | Splunk Web | 9.1.0 to 9.1.4 | 9.1.5 |
| Splunk Enterprise | 9.0 | Splunk Web | 9.0.0 to 9.0.9 | 9.0.10 |

## Mitigations and Workarounds

The vulnerability affects instances with [Splunk Web](https://docs.splunk.com/Documentation/Splunk/latest/Security/DisableunnecessarySplunkcomponents) turned on. You could turn Splunk Web off as a possible workaround. See [Disable unnecessary Splunk Enterprise components](https://docs.splunk.com/Documentation/Splunk/latest/Security/DisableunnecessarySplunkcomponents) and the [web.conf](https://docs.splunk.com/Documentation/Splunk/latest/Admin/Webconf) configuration specification file for more information on turning Splunk Web off.

## Detections

* [Splunk Unauthenticated Path Traversal modules messaging](https://research.splunk.com/application/e7c2b064-524e-4d65-8002-efce808567aa)

## Severity

Splunk rates this vulnerability as 7.5, High, with a CVSSv3.1 vector of CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N.

If the Splunk Enterprise instance does not run Splunk Web, there should be no impact and the severity would be informational.

## Acknowledgments

Danylo Dmytriiev (DDV\_UA)

* Email
* [RSS Feed](/feed.xml)
* [Support](https://login.splunk.com/page/sso_redirect?type=portal)
© 2005 - 2025 Splunk Inc. All rights reserved.[Legal](https://www.splunk.com/en_us/legal.html)     [Privacy     [Website Terms of Use](https://www.splunk.com/en_us/legal/terms/terms-of-use.html)](https://www.splunk.com/en_us/legal/privacy/privacy-policy.html)
