```
{
  "cve": "CVE-2024-44960",
  "related": true,
  "description": "The provided commits address a null pointer dereference vulnerability in the Linux kernel's USB gadget core. The vulnerability occurs in the `usb_ep_enable` function within `drivers/usb/gadget/udc/core.c`.  Prior to the fix, the code would attempt to access the `maxpacket` field of the endpoint descriptor (`ep->desc`) without verifying that the `ep->desc` pointer itself was valid (not NULL). If the descriptor was not set or if it was NULL (due to a gadget driver not properly setting up the endpoint for the current speed, malformed gadget descriptors, or the descriptor not being found for the speed/endpoint), a null pointer dereference would occur, leading to a kernel panic. ",
  "vulnerability": {
    "root_cause": "The vulnerability stems from a missing check for a NULL `ep->desc` pointer before accessing its `maxpacket` field using `usb_endpoint_maxp(ep->desc)`.",
    "weaknesses": [
      "Null pointer dereference",
      "Missing input validation"
    ],
    "impact": "A null pointer dereference will cause a kernel panic, leading to a denial of service.",
     "attack_vectors": "An attacker could trigger this vulnerability by providing a crafted or malformed USB gadget descriptor that results in the `ep->desc` pointer being NULL when the `usb_ep_enable` function is called.",
    "required_capabilities": "An attacker would need the ability to control or influence the USB device descriptors provided to the Linux kernel via the USB gadget interface to trigger the vulnerability."
  },
  "fixes": [
    {
      "commit": "973a57891608a98e894db2887f278777f564de18",
      "description": "The fix adds a check to ensure that the `ep->desc` pointer is not NULL before attempting to access `maxpacket`.  The corrected code first checks if `ep->desc` is NULL. If it is, or if `usb_endpoint_maxp(ep->desc)` returns 0, it issues a `WARN_ONCE` message and returns `-EINVAL`, thus preventing the null pointer dereference. The change is in `drivers/usb/gadget/udc/core.c`, inside the `usb_ep_enable` function."
    },
   {
      "commit": "1a9df57d57452b104c46c918569143cf21d7ebf1",
      "description": "The fix adds a check to ensure that the `ep->desc` pointer is not NULL before attempting to access `maxpacket`.  The corrected code first checks if `ep->desc` is NULL. If it is, or if `usb_endpoint_maxp(ep->desc)` returns 0, it issues a `WARN_ONCE` message and returns `-EINVAL`, thus preventing the null pointer dereference. The change is in `drivers/usb/gadget/udc/core.c`, inside the `usb_ep_enable` function."
   },
   {
      "commit":"716cba46f73a92645cf13eded8d257ed48afc2a4",
       "description":"The fix adds a check to ensure that the `ep->desc` pointer is not NULL before attempting to access `maxpacket`.  The corrected code first checks if `ep->desc` is NULL. If it is, or if `usb_endpoint_maxp(ep->desc)` returns 0, it issues a `WARN_ONCE` message and returns `-EINVAL`, thus preventing the null pointer dereference. The change is in `drivers/usb/gadget/udc/core.c`, inside the `usb_ep_enable` function."
   },
    {
      "commit":"a0362cd6e503278add954123957fd47990e8d9bf",
      "description":"The fix adds a check to ensure that the `ep->desc` pointer is not NULL before attempting to access `maxpacket`.  The corrected code first checks if `ep->desc` is NULL. If it is, or if `usb_endpoint_maxp(ep->desc)` returns 0, it issues a `WARN_ONCE` message and returns `-EINVAL`, thus preventing the null pointer dereference. The change is in `drivers/usb/gadget/udc/core.c`, inside the `usb_ep_enable` function."
   },
   {
       "commit": "bdf403b6_20250111_151522",
        "description":"The fix adds a check to ensure that the `ep->desc` pointer is not NULL before attempting to access `maxpacket`.  The corrected code first checks if `ep->desc` is NULL. If it is, or if `usb_endpoint_maxp(ep->desc)` returns 0, it issues a `WARN_ONCE` message and returns `-EINVAL`, thus preventing the null pointer dereference. The change is in `drivers/usb/gadget/udc/core.c`, inside the `usb_ep_enable` function."
   },
   {
      "commit":"bdfc7a79_20250111_151522",
       "description":"The fix adds a check to ensure that the `ep->desc` pointer is not NULL before attempting to access `maxpacket`.  The corrected code first checks if `ep->desc` is NULL. If it is, or if `usb_endpoint_maxp(ep->desc)` returns 0, it issues a `WARN_ONCE` message and returns `-EINVAL`, thus preventing the null pointer dereference. The change is in `drivers/usb/gadget/udc/core.c`, inside the `usb_ep_enable` function."
   },
   {
     "commit":"ba15815dd24cc5ec0d23e2170dc58c7db1e03b4a",
      "description":"The fix adds a check to ensure that the `ep->desc` pointer is not NULL before attempting to access `maxpacket`.  The corrected code first checks if `ep->desc` is NULL. If it is, or if `usb_endpoint_maxp(ep->desc)` returns 0, it issues a `WARN_ONCE` message and returns `-EINVAL`, thus preventing the null pointer dereference. The change is in `drivers/usb/gadget/udc/core.c`, inside the `usb_ep_enable` function."
   },
    {
       "commit":"48044648_20250111_151521",
        "description":"The fix adds a check to ensure that the `ep->desc` pointer is not NULL before attempting to access `maxpacket`.  The corrected code first checks if `ep->desc` is NULL. If it is, or if `usb_endpoint_maxp(ep->desc)` returns 0, it issues a `WARN_ONCE` message and returns `-EINVAL`, thus preventing the null pointer dereference. The change is in `drivers/usb/gadget/udc/core.c`, inside the `usb_ep_enable` function."
   },
   {
        "commit":"3a8bb07f_20250111_151523",
        "description":"The fix adds a check to ensure that the `ep->desc` pointer is not NULL before attempting to access `maxpacket`.  The corrected code first checks if `ep->desc` is NULL. If it is, or if `usb_endpoint_maxp(ep->desc)` returns 0, it issues a `WARN_ONCE` message and returns `-EINVAL`, thus preventing the null pointer dereference. The change is in `drivers/usb/gadget/udc/core.c`, inside the `usb_ep_enable` function."
   },
   {
        "commit":"e91d7d60_20250111_151523",
        "description":"The fix adds a check to ensure that the `ep->desc` pointer is not NULL before attempting to access `maxpacket`.  The corrected code first checks if `ep->desc` is NULL. If it is, or if `usb_endpoint_maxp(ep->desc)` returns 0, it issues a `WARN_ONCE` message and returns `-EINVAL`, thus preventing the null pointer dereference. The change is in `drivers/usb/gadget/udc/core.c`, inside the `usb_ep_enable` function."
   },
   {
       "commit":"50c5248b0ea8aae0529fdf28dac42a41312d3b62",
        "description":"The fix adds a check to ensure that the `ep->desc` pointer is not NULL before attempting to access `maxpacket`.  The corrected code first checks if `ep->desc` is NULL. If it is, or if `usb_endpoint_maxp(ep->desc)` returns 0, it issues a `WARN_ONCE` message and returns `-EINVAL`, thus preventing the null pointer dereference. The change is in `drivers/usb/gadget/udc/core.c`, inside the `usb_ep_enable` function."
   },
  {
       "commit": "1190d6a0_20250111_151520",
        "description":"The fix adds a check to ensure that the `ep->desc` pointer is not NULL before attempting to access `maxpacket`.  The corrected code first checks if `ep->desc` is NULL. If it is, or if `usb_endpoint_maxp(ep->desc)` returns 0, it issues a `WARN_ONCE` message and returns `-EINVAL`, thus preventing the null pointer dereference. The change is in `drivers/usb/gadget/udc/core.c`, inside the `usb_ep_enable` function."
    },

  ],
  "more_info": "The fix ensures that a null pointer dereference cannot occur by first verifying that the descriptor exists before accessing its members. This prevents a kernel panic when an endpoint is enabled with a missing or invalid descriptor. The vulnerability is specific to USB gadget configurations where a driver might not set up the endpoint correctly or provide malformed descriptors. The `WARN_ONCE` macro is used to emit a warning message to the kernel log, indicating the issue and aiding debugging."
}
```