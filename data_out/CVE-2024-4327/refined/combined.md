=== Content from 1drv.ms_c63f91f7_20250110_175902.html ===



=== Content from vuldb.com_80701003_20250110_175905.html ===
![VulDB](/_thm/vuldb.png)

* Home
  + Overview
  + [Live Recent](?live.recent)
  + [Live Updates](?live.updates)
  + [Live Archive](?live.archive)
  + [Live Submits](?live.submits)
* [Entries](?recent)
  + [Recent](?recent)
  + [Updates](?updates)
  + [Commits](?commits)
  + [Archive](?archive)
  + [CNA](?cna)
  + [Stats](?stats)
  + [Submits](?submits)
  + [Add](?id.add)
* [Products](?product)
  + [Vendor](?vendor)
  + [Product](?product)
  + [Type](?type)
* [Risk](?cvssv3)
  + [CVSSv4](?cvssv4)
  + [CVSSv3](?cvssv3)
  + [CVSSv2](?cvssv2)
  + [Risks](?risk)
  + [Exploits](?exploits)
* [Threat](?cti)
  + [Analysis](?cti.analyze)
  + [Activities](?activities)
  + [Events](?events)
  + [Actors](?actor)
  + [IP addresses](?ip)
  + [Country](?country)
  + [Sector](?sector)
  + [Exploit Prices](?exploitprices)
* [References](?references)
  + [References](?references)
  + [Tools](?tools)
  + [Videos](?videos)
  + [Google Hacking](?googlehacking)
  + [Exports](?export)
* [Search](?search)

  + [Search](?search)
  + [Advanced Search](?search.advanced)
  + [User](?user)
  + [Feeds](?feeds)
  + [API](?kb.api)
* [Support](?kb)
  + [Knowledge Base](?kb)
  + [FAQ](?kb.faq)
  + [Changelog](?kb.changelog)
  + [Roadmap](?kb.roadmap)
  + [Status](?status)
  + [Contact](?contact)
* [Login](?login)
  + [Login](?login)
  + [Signup](?signup)
  + [Purchase](?pay)
  + [Terms of Use](?kb.terms)

* [Live](?live.submits)
* [Submits](?submits)
* [Add](?id.add)
* [Policy](?kb.submission)
* [Purchase](?pay)

[Login](?login)[Signup](?signup)ðŸ›¡ Home[Submit](?submit)321231
# Submit #321231: apryse WebViewe 10.8.0 Cross Site Scripting[info](?kb.submission)

| Title | apryse WebViewe 10.8.0 Cross Site Scripting |
| --- | --- |
| Description | The default WebViewer [https://www.npmjs.com/package/@pdftron/webviewer] deployments allow Embedded JavaScript within PDF which can lead to cross-site scripting XSS I was able to replicate this issue on the WebViewer demo. To reproduce: Visit https://showcase.apryse.com/portfolio. Upload the attached PDF file. https://1drv.ms/b/s!AqJ7dHWS4CD\_l0acw2hDjgo-C2zC?e=DOGPmq XSS will be triggered. Vandor was contacted and they will fix the issue on the next release, by disabling the embedded javascript by default. |
| User | [hamza\_g (UID 68030)](?user.68030) |
| Submission | 04/23/2024 12:55 AM (9 months ago) |
| Moderation | 04/29/2024 09:40 PM (7 days later) |
| Status | [Accepted](?kb.submission) |
| VulDB Entry | [262419](?id.262419) [Apryse WebViewer up to 10.8.0 PDF Document cross site scripting] |
| Points | 17 |

[â—‚ Previous](?submit.321230)[Overview](?submit)[Next â–¸](?submit.321232)

# Interested in the pricing of exploits?

See the underground prices here!

## Notice

Submissions are made by [VulDB community users](?user). VulDB is *not responsible* for their content nor the links to external sources.

Please use the raw information shown and the links listed *with caution*. They might contain malicious and harmful actions, code or data.

The corresponding VulDB entries contain the moderated, verified, and normalized information provided within the raw submission.

## Documentation

* [Submission Policy](?kb.submission)
* [Data Processing](?kb.processing)
* [CVE Handling](?kb.cna)
[Â© 1997-2025 vuldb.com](?kb.terms) Â· [cc by-nc-sa](https://creativecommons.org/licenses/by-nc-sa/4.0/)[de](/de/?submit.321231 "German") Â· [fr](/fr/?submit.321231 "French") Â· [it](/it/?submit.321231 "Italian") Â· [es](/es/?submit.321231 "Spanish") Â· [pt](/pt/?submit.321231 "Portuguese") Â· [ru](/ru/?submit.321231 "Russian") Â· [pl](/pl/?submit.321231 "Polish") Â· [sv](/sv/?submit.321231 "Swedish") Â· [zh](/zh/?submit.321231 "Chinese") Â· [ja](/ja/?submit.321231 "Japanese") Â· [ar](/ar/?submit.321231 "Arabic")[v18.14.7](?kb.changelog)

=== Content from docs.apryse.com_af39f0c6_20250110_175904.html ===
[![apryse docs](https://cdn.sanity.io/images/e72qwn7x/production/60b1dbed84e49946bc7cc3d8cc3cf07c889b2e4e-233x32.svg)![apryse docs](https://cdn.sanity.io/images/e72qwn7x/production/6dd6fff6206d077182dde16b6c587145ac5c34bb-233x32.svg)](/)[Quick Start](/guides/get-started)[Samples](/samples)[Downloads](/downloads)[APIs](/apis)[![apryse docs](https://cdn.sanity.io/images/e72qwn7x/production/60b1dbed84e49946bc7cc3d8cc3cf07c889b2e4e-233x32.svg)![apryse docs](https://cdn.sanity.io/images/e72qwn7x/production/6dd6fff6206d077182dde16b6c587145ac5c34bb-233x32.svg)](/)SearchSwitch to Light ModeSwitch to Dark Mode[apryse.com](https://apryse.com)[Contact sales](https://apryse.com/form/contact-sales?docLink=hdrSal)
#### Product:

WebViewer SDK

Section:

Guides[Guides](/web/guides/get-started)[Pricing](https://apryse.com/pricing/webviewer?docLink=hdrWVprice)[Downloads](/web/guides/download)[FAQ](/web/faq)[API](https://sdk.apryse.com/api/web/index.html)[Samples](/web/samples)[Changelog](/web/guides/changelog)[Demo](https://showcase.apryse.com?docLink=WVhdr2Show)
#### Product:

WebViewer SDKGeneral[Add a license key](/web/faq/add-license)[Add a video license key](/web/faq/add-license-video)[Find your WebViewer version number](/web/faq/version-number)[Self serving substitute fonts](/web/faq/self-serve-substitute-fonts)[Use a Content Security Policy](/web/faq/content-security-policy)[Transpiling JavaScript](/web/faq/transpiling-javascript)[Close a document](/web/faq/close-a-document)[What type of server can WebViewer be hosted on?](/web/faq/webviewer-on-static-server)[How to use WebViewer with IE9 and IE10?](/web/faq/webviewer-with-ie9)[How to use WebViewer with IE11?](/web/faq/webviewer-with-ie11)[How to upgrade to new WebViewer version?](/web/faq/upgrading-webviewer)[How to load a tiff file?](/web/faq/load-tiff)[Where to find code snippets for WebViewer 5.0 or earlier?](/web/faq/webviewer-5.0-snippets)[Where to get WebViewer nightly build?](/web/faq/webviewer-nightly-build)[Load updated WebViewer files without clearing cache](/web/faq/load-webviewer-files-no-cache)[Disable localStorage usage](/web/faq/localstorage)[Enable file attachment list](/web/faq/file-attachment-list)[WebAssembly Threads](/web/faq/wasm-threads)[How to enable inline comment feature and right-click annotation menu](/web/faq/enable-inline-comment)Annotations[How to save and load a custom property on an annotation?](/web/faq/save-load-custom-props)[FreeHandAnnotation creation delay](/web/faq/freehand-creation-delay)[Separate opacity for fill and stroke](/web/faq/separate-opacity-for-fill-and-stroke)[How to use annotation selection styling from before version 7.3](/web/faq/revert-selection-styling)[Why does tabbing between form fields go in the wrong order?](/web/faq/widget-tab-ordering)Troubleshooting[Loading errors](/web/faq/loading-errors)[Slow loading](/web/faq/slow-loading)[MIME types](/web/faq/mime-types)[CORS support](/web/faq/cors-support)[Content encoding warnings](/web/faq/content-encoding)[Why do my PDF colors look different in WebViewer?](/web/faq/pdf-color-different)[Angular project integration issues](/web/faq/angular-integration-issues)[ASP.NET or Blazor integration issues](/web/faq/blazor-integration-issues)[WebViewer infinite loading loop](/web/faq/infinite-loading-loop)[My custom header element is not rendering when using a polyfill (IE)](/web/faq/custom-elements-with-polyfill)[Why full screen button is disabled on iPhone](/web/faq/full-screen-button-disabled-on-iphone)[Why does my office file only have 1 page in documentLoaded?](/web/faq/office-file-page-count)[Why do I get React invalid hook error with custom components?](/web/faq/react-hooks-error)[Chrome 77 printing not working](/web/faq/chrome-77-printing)[PNaCl modules can only be used on the open web](/web/faq/pnacl-modules)WebViewer Server[What is WebViewer Server?](/web/faq/wvs/what-is-wvs)[Install Issues](/web/faq/wvs/wvs-install-issues)[Manual Load Balancing](/web/faq/wvs/load_balancing)[What is the BCID?](/web/faq/wvs/what-is-the-bcid)[Retrieving Container Information](/web/faq/wvs/container-information)[Changing the HTTP cache directory](/web/faq/wvs/changing-the-http-data-directory)[Mounting a Docker Data Volume](/web/faq/wvs/mounting-docker-data-volume)[Modifying WebViewer Server](/web/faq/wvs/modifying-wvs)[Supporting XRefs](/web/faq/wvs/supporting-xrefs)React[Sharing WebViewer instance across components](/web/faq/react-global-instance)Electron[Why is the viewer showing "Network Failure"?](/web/faq/viewer-showing-network-failure)["npx: not found" errors when trying to install the dependencies](/web/faq/npx-not-found)Forms[Does the Apryse SDK support XFA/LifeCycle PDF forms?](/web/faq/xfa-lifecycle-support)[How to extract XML from a XFA PDF form?](/web/faq/extract-xml-from-xfa)Cordova or Ionic[Open cordova or ionic links in external browser](/web/faq/cordova-links-external-browser)
# Using a Content Security Policy (CSP) with WebViewer

[MDN says](https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP/) a Content Security Policy (CSP) is:
"an added layer of security that helps to detect and mitigate certain types of attacks, including Cross-Site Scripting (XSS) and data injection attacks."

## Recommended policy

WebViewer requires certain CSP directives to be used. If you do not need to support [embedded JavaScript](/web/guides/forms/embedded-js) then the current recommended policy is:

#### sh

```
1script-src 'self' 'wasm-unsafe-eval' blob:; font-src 'self' data: blob:; img-src 'self' data: blob:; style-src 'self' 'unsafe-inline'; connect-src https://www.pdftron.com/ https://pws-collect.pdftron.com/ https://proxy.pdftron.com/

```
Report Invalid CodeCopy

If you use this policy and want to make sure the embedded JavaScript warnings/errors don't show up because of the CSP then you can [disable embedded JavaScript in WebViewer](/web/guides/forms/embedded-js#disabling).

### Allowing embedded JavaScript

If you need to enable to embedded JavaScript then you'll currently need to enable `unsafe-inline` and `unsafe-eval` for `script-src`.

#### sh

```
1script-src 'self' 'unsafe-inline' 'unsafe-eval' blob:; font-src 'self' data:; img-src 'self' data: blob:; style-src 'self' 'unsafe-inline'; connect-src https://www.pdftron.com/ https://pws-collect.pdftron.com/ https://proxy.pdftron.com/

```
Report Invalid CodeCopy
### Why is `connect-src https://www.pdftron.com/` necessary?

The `https://www.pdftron.com/` domain hosts fonts that WebViewer will download when necessary for certain documents.

It is possible to self-serve these fonts on another domain by following the [guide for self serving substitute fonts](/web/faq/self-serve-substitute-fonts).

### Why is `connect-src https://pws-collect.pdftron.com/` necessary?

When WebViewer is provided a license key that transmits usage data back to Apryse, then this is needed to ensure that the API server hosted at <https://pws-collect.pdftron.com/> can be reached.

If the license key used is not a usage-based license key, then adding this URL to the `connect-src` directive is not necessary.

### Why is `connect-src https://proxy.pdftron.com/` necessary?

The proxy server is used in cases where WebViewer needs to contact a Certificate Revocation List (CRL) server or Online Certificate Status Protocol (OCSP) server for a subset of [Digital Signature Verification](/web/guides/features/signature/verify-pdf) calls.

This Proxy server can be substituted for any other Proxy server via the API [Core.PDFNet.VerificationOptions.setRevocationProxyPrefix](https://docs.apryse.com/api/web/Core.PDFNet.VerificationOptions.html#setRevocationProxyPrefix).

Otherwise, if your instance of WebViewer is not utilizing [Digital Signature Verification](/web/guides/features/signature/verify-pdf), then this can be removed.

### Why is `script-src 'wasm-unsafe-eval'` necessary?

WebViewer leverages WebAssembly for several native modules, and therefore requires a CSP directive that allows WebAssembly to execute.

While the term "unsafe" is used, we are currently unaware of any security risks related to the `wasm-unsafe-eval` directive, as it is distinct from the more dangerous `unsafe-eval` directive. For avoidance of doubt, `wasm-unsafe-eval` does not allow for the JavaScript `eval` method to be invoked, whereas `unsafe-eval` does allow for the `eval` method to be invoked.

Furthermore, as of this writing, the official WebAssembly documentation [recommends this directive](https://github.com/WebAssembly/content-security-policy/blob/4c61db828b4a0739e4500e8d42d0ec85ef05505a/proposals/CSP.md#the-wasm-unsafe-eval-source-directive) when WebAssembly compilation and instantiation is required.

### Why is `style-src 'unsafe-inline'` necessary?

WebViewer requires the following Content Security Policy (CSP) setting for the style-src directive: `style-src 'self' 'unsafe-inline'`

The `unsafe-inline` source is required because the built and minified WebViewer code contains HTML elements that use the style attribute.

When the `unsafe-inline` source is used strictly with the `style-src` directive, only inline changes related to styling on a web page are possible.

Any risks beyond styling changes are mitigated by the `self` source, meaning that any attempts to use `style` attribute logic to make network requests outside of the source web page where WebViewer is hosted is not possible, given that the `self` source will use the same CSP rule to prevent communication outside of the hosting domain.

### What if the web server I want to deploy WebViewer on does not allow the `script-src blob:` directive?

There is a WebViewer constructor option [`disableObjectURLBlobs`](https://docs.apryse.com/api/web/global.html#WebViewer__anchor) that will remove the need for `script-src blob:`, that can be called like so:

#### sh

```
1WebViewer({
2  // ...
3  disableObjectURLBlobs: true,
4  // ...
5}, document.getElementById('viewer')).then(instance => {
6  // ...
7});

```
Report Invalid CodeCopy

For additional context, WebViewer by default loads various compressed JavaScript worker files that are compressed as the G-Zip (`.gz`) or Brotli (`.br`) compression types. In order for WebViewer to uncompress these file extensions, they need to be opened with the browser's [URL.createObjectURL](https://developer.mozilla.org/en-US/docs/Web/API/URL/createObjectURL/) method, which returns a [`Blob`](https://developer.mozilla.org/en-US/docs/Web/API/Blob/) that is then loaded as a `blob:` URL.

If the CSP directive `script-src blob:` is not available, then this operation is not permitted.

Please note that the downside of this is that WebViewer then needs to load uncompressed versions of these worker files, which may have a minor impact on performance, depending on the client's network speed, though it is worth noting that the size difference between the compressed and uncompressed assets are not major.

### What if the web server I want to deploy WebViewer on does not allow the `script-src 'wasm-unsafe-eval'` directive?

WebViewer can operate in a non-WebAssembly context with [`disableObjectURLBlobs`](https://docs.apryse.com/api/web/global.html#WebViewer__anchor), like so:

#### sh

```
1WebViewer({
2  // ...
3  disableObjectURLBlobs: true,
4  backendType: WebViewer.BackendTypes.ASM,
5  // ...
6}, document.getElementById('viewer')).then(instance => {
7  // ...
8});

```
Report Invalid CodeCopy

However, this does require uncompressing the non-WASM PDF & Office worker files manually, as Apryse does not ship the uncompressed versions of these files due to the file size of the uncompressed files.

#### The files to uncompress

##### PDF Workers

WebViewer has a `fullAPI` option as part of the constructor, which would look like this extending from the code example above:

#### sh

```
1WebViewer({
2  // ...
3  disableObjectURLBlobs: true,
4  backendType: WebViewer.BackendTypes.ASM,
5  fullAPI: true,
6  // ...
7}, document.getElementById('viewer')).then(instance => {
8  // ...
9});

```
Report Invalid CodeCopy

If `fullAPI: true` is being used, then the following commands should be run in `lib/core/pdf/full`, otherwise if `fullAPI` is not being used, perform the commands in `lib/core/pdf/lean`.

#### sh

```
1# Copy and rename the new JavaScript worker file to end with .gz
2cp PDFNetC.gz.js.mem PDFNetC.js.gz
3# Uncompress the newly copied G-Zip compressed file
4gzip -d PDFNetC.js.gz
5# Copy and rename the Binary worker file to end with .gz and move it up one level, as this is where PDFNetC.js expects to load the uncompressed binary mem worker
6cp PDFNetC.gz.mem ../PDFNetC.js.mem.gz
7# Uncompress the newly copied G-Zip compressed file
8gzip -d ../PDFNetC.js.mem.gz

```
Report Invalid CodeCopy
##### Office Workers

For modern Office files (`.docx`, `.xlsx` and `.pptx`), perform the following commands in `lib/core/office`:

#### sh

```
1# Copy and rename the new JavaScript worker file to end with .gz
2cp WebOfficeWorker.gz.js.mem WebOfficeWorker.js.gz
3# Uncompress the newly copied G-Zip compressed file
4gzip -d WebOfficeWorker.js.gz
5# Copy and rename the Binary worker file to end with .gz
6cp WebOfficeWorker.gz.mem WebOfficeWorker.js.mem.gz
7# Uncompress the newly copied G-Zip compressed file
8gzip -d WebOfficeWorker.js.mem.gz

```
Report Invalid CodeCopy

Please note that the instructions for the PDF workers also need to be completed for the Office workers to operate correctly.

##### Legacy Office Workers

For legacy Office files (`.doc`, `.xls` and `.ppt`), perform the following commands in `lib/core/legacyOffice`:

#### sh

```
1# Copy and rename the new JavaScript worker file to end with .gz
2cp WebB2XOfficeWorker.gz.js.mem WebB2XOfficeWorker.js.gz
3# Uncompress the newly copied G-Zip compressed file
4gzip -d WebB2XOfficeWorker.js.gz
5# Copy and rename the Binary worker file to end with .gz
6cp WebB2XOfficeWorker.gz.mem WebB2XOfficeWorker.js.mem.gz
7# Uncompress the newly copied G-Zip compressed file
8gzip -d WebB2XOfficeWorker.js.mem.gz

```
Report Invalid CodeCopy

Please note that the instructions for the PDF workers also need to be completed for the Office workers to operate correctly.

Did you find this helpful?

Trial setup questions?

[Ask experts on Discord](https://apryse.com/discord?docLink=docDis)

Need other help?

[Contact Support](https://support.apryse.com/?docLink=docSup)

Pricing or product questions?

[Contact Sales](https://apryse.com/form/contact-sales?docLink=docSal)
#### On this page

[Recommended policy](#recommended-policy)[Allowing embedded JavaScript](#allowing-embedded-javascript)[Why is connect-src https://www.pdftron.com/ necessary?](#why-is-connectsrc-https:--wwwpdftroncom--necessary)[Why is connect-src https://pws-collect.pdftron.com/ necessary?](#why-is-connectsrc-https:--pwscollectpdftroncom--necessary)[Why is connect-src https://proxy.pdftron.com/ necessary?](#why-is-connectsrc-https:--proxypdftroncom--necessary)[Why is script-src 'wasm-unsafe-eval' necessary?](#why-is-scriptsrc-wasmunsafeeval-necessary)[Why is style-src 'unsafe-inline' necessary?](#why-is-stylesrc-unsafeinline-necessary)[What if the web server I want to deploy WebViewer on does not allow the script-src blob: directive?](#what-if-the-web-server-i-want-to-deploy-webviewer-on-does-not-allow-the-scriptsrc-blob:-directive)[What if the web server I want to deploy WebViewer on does not allow the script-src 'wasm-unsafe-eval' directive?](#what-if-the-web-server-i-want-to-deploy-webviewer-on-does-not-allow-the-scriptsrc-wasmunsafeeval-directive)
