=== Content from bugzilla.mozilla.org_abc53456_20250108_144142.html ===


![](/static/v20241211.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1730194)
* [XML](/show_bug.cgi?ctype=xml&id=1730194)

Closed
[Bug 1730194](/show_bug.cgi?id=1730194)
(CVE-2021-38505)

Opened 3 years ago
Closed 3 years ago

# Prevent Copy button to send information to Cloud Clipboard and Clipboard History on Windows

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Prevent Copy button to send information to Cloud Clipboard and Clipboard History on Windows

## Categories

### (Firefox :: about:logins, defect, P1)

[Product:](/describecomponents.cgi?product=Firefox)

Firefox
▾

Firefox
For bugs in Firefox Desktop, the Mozilla Foundation's web browser. For Firefox user interface issues in menus, bookmarks, location bar, and preferences. Many Firefox bugs will either be filed here or in the [Core](https://bugzilla.mozilla.org/describecomponents.cgi?product=Core) product. Bugs for developer tools (F12) should be filed in the [DevTools](https://bugzilla.mozilla.org/describecomponents.cgi?product=DevTools) product. ([more info](https://wiki.mozilla.org/Modules/All#Firefox))
[See Open Bugs in This Product](/buglist.cgi?product=Firefox&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Firefox)
Watch This Product

[Component:](/describecomponents.cgi?product=Firefox&component=about%3Alogins#about%3Alogins)

about:logins
▾

Firefox :: about:logins
Issues with the [Firefox Lockwise 'Logins and Passwords' management page](https://wiki.mozilla.org/Toolkit%3APassword_Manager/about%3Alogins). Issues with filling and saving passwords on websites belong in [Toolkit::Password Manager](https://wiki.mozilla.org/Toolkit%3APassword_Manager).
[See Open Bugs in This Component](/buglist.cgi?product=Firefox&component=about%3Alogins&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Firefox&component=about%3Alogins&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Firefox&component=about%3Alogins)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Windows

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

95 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Accessibility Severity | --- |
| Webcompat Score | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr78 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=wontfix) |
| firefox-esr91 | [94+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=94%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=verified) |
| firefox92 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox92&o1=equals&v1=wontfix) |
| firefox93 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox93&o1=equals&v1=wontfix) |
| firefox94 | [+](/buglist.cgi?f1=cf_tracking_firefox94&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox94&o1=equals&v1=verified) |
| firefox95 | [+](/buglist.cgi?f1=cf_tracking_firefox95&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox95&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox-esr78 |  | wontfix |
| firefox-esr91 | 94+ | verified |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox92 |  | wontfix |
| firefox93 |  | wontfix |
| firefox94 | + | verified |
| firefox95 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: serg, Assigned: serg)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/56d78d779f6650bac5fee98c8b204f98?d=mm&size=40)  [serg](/user_profile?user_id=691597)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/56d78d779f6650bac5fee98c8b204f98?d=mm&size=40)  [serg](/user_profile?user_id=691597)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

---

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

16 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

[1739413](/show_bug.cgi?id=1739413 "RESOLVED WONTFIX - windows clipboard history doesn't work in version 94.0 in private window"), [1753567](/show_bug.cgi?id=1753567 "RESOLVED INVALID - Windows system: Problem with display copied text from pages in clipboard")

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1746388](/show_bug.cgi?id=1746388 "NEW - Clipboard API lacks a sensitive/private data type => password managers can't protect your passwords from leaking through Clipboard History or Cloud Clipboard")

## Details

### (Keywords: csectype-disclosure, privacy, sec-high, Whiteboard: [sec-survey][adv-main94+][adv-esr91.3+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2021-38505

[Keywords:](/describekeywords.cgi)

[csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---),
[privacy](/buglist.cgi?keywords=privacy&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[sec-survey][adv-main94+][adv-esr91.3+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | blocking-fx-sync1.7 | ? |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files, 1 obsolete file)

| [WIP: Bug 1730194 - Prevent Copy button to send information to Cloud Clipboard and Clipboard History on Windows](/attachment.cgi?id=9241420)  [3 years ago](#c2)  [Sergey Galich [:serg]](/user_profile?user_id=691597)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9241420&action=edit) | [Review](/attachment.cgi?id=9241420) |
| --- | --- | --- |
| [Bug 1730194 - Prevent Copy button to send information to Cloud Clipboard and Clipboard History on Windows r?dimi,sfoster,tgiles,johannh](/attachment.cgi?id=9241572)  [3 years ago](#c4)  [Sergey Galich [:serg]](/user_profile?user_id=691597)   48 bytes, text/x-phabricator-request | diannaS : [approval-mozilla-beta+](#c13 "3 years ago")  RyanVM : [approval-mozilla-esr91+](#c16 "3 years ago")  tjr : [sec-approval+](#c7 "3 years ago") | [Details](/attachment.cgi?id=9241572&action=edit) | [Review](/attachment.cgi?id=9241572) |
| [advisory.txt](/attachment.cgi?id=9248071)  [3 years ago](#c19)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   686 bytes, text/plain |  | [Details](/attachment.cgi?id=9248071&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Sergey Galich [:serg]](/user_profile?user_id=691597)  Assignee |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1730194#c0)• 3 years ago |
|  | |

Windows 10 introduced Cloud Clipboard and Clipboard History, when app uses classic clipboard API the information goes to the local clipboard and to the cloud/history as well.

This is typically not clear or known to user, so they might not understand they are copying their sensitive information to the cloud and history.

There is no known way to disable these features for the whole app, but if we add 3 clipboard formats listed here <https://docs.microsoft.com/en-us/windows/win32/dataxchg/clipboard-formats#cloud-clipboard-and-clipboard-history-formats> we will prevent sensitive data from going to the unexpected places.

|  | [Sam Foster [:sfoster] (he/him)](/user_profile?user_id=430165) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1730194#c1)• 3 years ago |
|  | |

Changing severity to S3 as this is existing functionality that continues to "work" but now with unexpected side-effects.

If the suggested clipboard formats solution in [comment #0](/show_bug.cgi?id=1730194#c0 "VERIFIED FIXED - Prevent Copy button to send information to Cloud Clipboard and Clipboard History on Windows") will fix this, this should be a quick patch we can ship ASAP.

Severity: -- → S3Type: enhancement → defectPriority: -- → P1

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1730194#a18240_5898)• 3 years ago |

Group: partner-confidential

|  | [Sergey Galich [:serg]](/user_profile?user_id=691597)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1730194#a425107_691597)• 3 years ago |

Assignee: nobody → sgalich

|  | [Sergey Galich [:serg]](/user_profile?user_id=691597)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1730194#c2)• 3 years ago |
|  | |

Attached file
[WIP: Bug 1730194 - Prevent Copy button to send information to Cloud Clipboard and Clipboard History on Windows](attachment.cgi?id=9241420) (obsolete)
— [Details](attachment.cgi?id=9241420&action=edit)

|  | [Sergey Galich [:serg]](/user_profile?user_id=691597)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1730194#c3)• 3 years ago |
|  | |

[WIP](https://bugzilla.mozilla.org/attachment.cgi?id=9241420) here prevents Copy button in about:logins from storing info in Cloud Clipboard and Clipboard History, as an added bonus it also prevents almost anything in Private Browsing from going to the clouds as well.

I'd appreciate a review and suggestions on how to move this forward.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1730194#a455138_1689)• 3 years ago |

Keywords: [csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---),
[privacy](/buglist.cgi?keywords=privacy&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Sergey Galich [:serg]](/user_profile?user_id=691597)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1730194#c4)• 3 years ago |
|  | |

Attached file
[Bug 1730194 - Prevent Copy button to send information to Cloud Clipboard and Clipboard History on Windows r?dimi,sfoster,tgiles,johannh](attachment.cgi?id=9241572)
— [Details](attachment.cgi?id=9241572&action=edit)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1730194#a518553_600971)• 3 years ago |

[Attachment #9241572](/attachment.cgi?id=9241572&action=edit "Bug 1730194 - Prevent Copy button to send information to Cloud Clipboard and Clipboard History on Windows r?dimi,sfoster,tgiles,johannh") -
Attachment description: Bug 1730194 - Prevent Copy button to send information to Cloud Clipboard and Clipboard History on Windows r?dimi,sfoster,tgiles → Bug 1730194 - Prevent Copy button to send information to Cloud Clipboard and Clipboard History on Windows r?dimi,sfoster,tgiles,johannh

|  | [Sergey Galich [:serg]](/user_profile?user_id=691597)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1730194#a518643_691597)• 3 years ago |

[Attachment #9241420](/attachment.cgi?id=9241420&action=edit "WIP: Bug 1730194 - Prevent Copy button to send information to Cloud Clipboard and Clipboard History on Windows") -
Attachment is obsolete: true

|  | [Sergey Galich [:serg]](/user_profile?user_id=691597)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1730194#a993777_691597)• 3 years ago |

Status: NEW → ASSIGNED

|  | [Sergey Galich [:serg]](/user_profile?user_id=691597)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1730194#c5)• 3 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1730194&comment_id=15599987 "1 revision") |
|  | |

Comment on [attachment 9241572](/attachment.cgi?id=9241572 "Bug 1730194 - Prevent Copy button to send information to Cloud Clipboard and Clipboard History on Windows r?dimi,sfoster,tgiles,johannh") [[details]](/attachment.cgi?id=9241572&action=edit "Bug 1730194 - Prevent Copy button to send information to Cloud Clipboard and Clipboard History on Windows r?dimi,sfoster,tgiles,johannh")

[Bug 1730194](/show_bug.cgi?id=1730194 "VERIFIED FIXED - Prevent Copy button to send information to Cloud Clipboard and Clipboard History on Windows") - Prevent Copy button to send information to Cloud Clipboard and Clipboard History on Windows r?dimi,sfoster,tgiles,johannh

removed comment that was made by mistake

[Attachment #9241572](/attachment.cgi?id=9241572&action=edit "Bug 1730194 - Prevent Copy button to send information to Cloud Clipboard and Clipboard History on Windows r?dimi,sfoster,tgiles,johannh") -
Flags: sec-approval?

|  | [Sergey Galich [:serg]](/user_profile?user_id=691597)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1730194#c6)• 3 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1730194&comment_id=15599993 "1 revision") |
|  | |

Comment on [attachment 9241572](/attachment.cgi?id=9241572 "Bug 1730194 - Prevent Copy button to send information to Cloud Clipboard and Clipboard History on Windows r?dimi,sfoster,tgiles,johannh") [[details]](/attachment.cgi?id=9241572&action=edit "Bug 1730194 - Prevent Copy button to send information to Cloud Clipboard and Clipboard History on Windows r?dimi,sfoster,tgiles,johannh")

[Bug 1730194](/show_bug.cgi?id=1730194 "VERIFIED FIXED - Prevent Copy button to send information to Cloud Clipboard and Clipboard History on Windows") - Prevent Copy button to send information to Cloud Clipboard and Clipboard History on Windows r?dimi,sfoster,tgiles,johannh

removed comment that was made by mistake

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1730194#c7)• 3 years ago |
|  | |

Comment on [attachment 9241572](/attachment.cgi?id=9241572 "Bug 1730194 - Prevent Copy button to send information to Cloud Clipboard and Clipboard History on Windows r?dimi,sfoster,tgiles,johannh") [[details]](/attachment.cgi?id=9241572&action=edit "Bug 1730194 - Prevent Copy button to send information to Cloud Clipboard and Clipboard History on Windows r?dimi,sfoster,tgiles,johannh")

[Bug 1730194](/show_bug.cgi?id=1730194 "VERIFIED FIXED - Prevent Copy button to send information to Cloud Clipboard and Clipboard History on Windows") - Prevent Copy button to send information to Cloud Clipboard and Clipboard History on Windows r?dimi,sfoster,tgiles,johannh

Approved to land and request uplift

[Attachment #9241572](/attachment.cgi?id=9241572&action=edit "Bug 1730194 - Prevent Copy button to send information to Cloud Clipboard and Clipboard History on Windows r?dimi,sfoster,tgiles,johannh") -
Flags: sec-approval? → sec-approval+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1730194#a2325196_578488)• 3 years ago |

[status-firefox92](/buglist.cgi?f1=cf_status_firefox92&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox92&o1=equals&v1=affected)
[status-firefox93](/buglist.cgi?f1=cf_status_firefox93&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox93&o1=equals&v1=affected)
[status-firefox94](/buglist.cgi?f1=cf_status_firefox94&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox94&o1=equals&v1=affected)
[status-firefox95](/buglist.cgi?f1=cf_status_firefox95&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox95&o1=equals&v1=affected)
[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected)
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1730194#c8)• 3 years ago |
|  | |

Prevent Copy button to send information to Cloud Clipboard and Clipboard History on Windows r=dimi,johannh,cmartin

<https://hg.mozilla.org/integration/autoland/rev/c13cadb3b0e0dc2fb2a0f0d0568ab671b738f7ad>

<https://hg.mozilla.org/mozilla-central/rev/c13cadb3b0e0>

Group: firefox-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 3 years ago
[status-firefox95](/buglist.cgi?f1=cf_status_firefox95&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox95&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox95&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 95 Branch

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1730194#c9)• 3 years ago |
|  | |

Please nominate this for Beta & ESR91 approval when you get a chance.

[status-firefox92](/buglist.cgi?f1=cf_status_firefox92&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox92&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox92&o1=equals&v1=wontfix)
[status-firefox93](/buglist.cgi?f1=cf_status_firefox93&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox93&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox93&o1=equals&v1=wontfix)
[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=wontfix)
[tracking-firefox94](/buglist.cgi?f1=cf_tracking_firefox94&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox94&o1=equals&v1=%2B)
[tracking-firefox95](/buglist.cgi?f1=cf_tracking_firefox95&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox95&o1=equals&v1=%2B)
[tracking-firefox-esr91](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=isnotempty):
--- → [94+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=94%2B)Flags: needinfo?(sgalich)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1730194#c10)• 3 years ago |
|  | |

As part of a security bug pattern analysis, we are requesting your help with a high level analysis of this bug. It is our hope to develop static analysis (or potentially runtime/dynamic analysis) in the future to identify classes of bugs.

Please visit [this google form](https://docs.google.com/forms/d/e/1FAIpQLSe9uRXuoMK6tRglbNL5fpXbun_oEb6_xC2zpuE_CKA_GUjrvA/viewform?usp=pp_url&entry.2124261401=https%3A%2F%2Fbugzilla.mozilla.org%2Fshow_bug.cgi%3Fid%3D1730194) to reply.

Flags: needinfo?(sgalich)Whiteboard: [sec-survey]

|  | [Sergey Galich [:serg]](/user_profile?user_id=691597)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1730194#c11)• 3 years ago |
|  | |

Comment on [attachment 9241572](/attachment.cgi?id=9241572 "Bug 1730194 - Prevent Copy button to send information to Cloud Clipboard and Clipboard History on Windows r?dimi,sfoster,tgiles,johannh") [[details]](/attachment.cgi?id=9241572&action=edit "Bug 1730194 - Prevent Copy button to send information to Cloud Clipboard and Clipboard History on Windows r?dimi,sfoster,tgiles,johannh")

[Bug 1730194](/show_bug.cgi?id=1730194 "VERIFIED FIXED - Prevent Copy button to send information to Cloud Clipboard and Clipboard History on Windows") - Prevent Copy button to send information to Cloud Clipboard and Clipboard History on Windows r?dimi,sfoster,tgiles,johannh

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: Around 2018 Windows 10 added new places where information goes when it is sent to clipboard (cloud/history). This patch prevents leaking secrets to unexpected places.
* **User impact if declined**: Every Ctrl+C in Private Browsing and when will be going to the history/cloud. According to <https://metadataconsulting.blogspot.com/2018/05/How-safe-secure-is-the-new-Microsoft-Cloud-Clipboard.html> initially it was stored in plain text on disk.
* **Fix Landed on Version**: 94
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: changes are made in the rarely updated code (Clipboard) and we are adding extra "data formats" to mark sensitive data as sensitive.
* **String or UUID changes made by this patch**:

### Beta/Release Uplift Approval Request

* **User impact if declined**: Every Ctrl+C in Private Browsing and when will be going to the history/cloud. According to <https://metadataconsulting.blogspot.com/2018/05/How-safe-secure-is-the-new-Microsoft-Cloud-Clipboard.html> initially it was stored in plain text on disk.
* **Is this code covered by automated tests?**: No
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: Yes
* **If yes, steps to reproduce**: Ctrl+C anything from the web page in Private Browsing or click Copy button on password field in about:logins. Without this patch, Windows+V will show clipboard history with copied content, with this patch Clipboard history will not have copied content.
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: changes are made in the rarely updated code (Clipboard) and we are adding extra "data formats" to mark sensitive data as sensitive.
* **String changes made/needed**:
Flags: needinfo?(sgalich)
[Attachment #9241572](/attachment.cgi?id=9241572&action=edit "Bug 1730194 - Prevent Copy button to send information to Cloud Clipboard and Clipboard History on Windows r?dimi,sfoster,tgiles,johannh") -
Flags: approval-mozilla-esr91?
[Attachment #9241572](/attachment.cgi?id=9241572&action=edit "Bug 1730194 - Prevent Copy button to send information to Cloud Clipboard and Clipboard History on Windows r?dimi,sfoster,tgiles,johannh") -
Flags: approval-mozilla-beta?

|  | [Sergey Galich [:serg]](/user_profile?user_id=691597)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1730194#a2868054_691597)• 3 years ago |

Flags: qe-verify+

|  | [Cornel Ionce [:noni] [Hubs QA]](/user_profile?user_id=458186) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1730194#a2906459_458186)• 3 years ago |

QA Whiteboard: [qa-triaged]

|  | [Bogdan Maris, Desktop Test Engineering [PTO until 13 Jan]](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1730194#c12)• 3 years ago |
|  | |

Reproduced the initial issue using old NIghtly from 2021-09-11, the copied text or password from about:logins are saved in the Clipboard. Verified that using latest Nightly build on Windows 10 this does not happen anymore, nothing is saved in the clipboard from Private Window or Private Mode.

[status-firefox95](/buglist.cgi?f1=cf_status_firefox95&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox95&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox95&o1=equals&v1=verified)

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1730194#c13)• 3 years ago |
|  | |

Comment on [attachment 9241572](/attachment.cgi?id=9241572 "Bug 1730194 - Prevent Copy button to send information to Cloud Clipboard and Clipboard History on Windows r?dimi,sfoster,tgiles,johannh") [[details]](/attachment.cgi?id=9241572&action=edit "Bug 1730194 - Prevent Copy button to send information to Cloud Clipboard and Clipboard History on Windows r?dimi,sfoster,tgiles,johannh")

[Bug 1730194](/show_bug.cgi?id=1730194 "VERIFIED FIXED - Prevent Copy button to send information to Cloud Clipboard and Clipboard History on Windows") - Prevent Copy button to send information to Cloud Clipboard and Clipboard History on Windows r?dimi,sfoster,tgiles,johannh

Approved for 94.0b6

[Attachment #9241572](/attachment.cgi?id=9241572&action=edit "Bug 1730194 - Prevent Copy button to send information to Cloud Clipboard and Clipboard History on Windows r?dimi,sfoster,tgiles,johannh") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1730194#c14)• 3 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/3ea4b88551a0>

[status-firefox94](/buglist.cgi?f1=cf_status_firefox94&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox94&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox94&o1=equals&v1=fixed)

|  | [Bogdan Maris, Desktop Test Engineering [PTO until 13 Jan]](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1730194#c15)• 3 years ago |
|  | |

Also verified this is fixed using 94.0b6.

[status-firefox94](/buglist.cgi?f1=cf_status_firefox94&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox94&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox94&o1=equals&v1=verified)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1730194#c16)• 3 years ago |
|  | |

Comment on [attachment 9241572](/attachment.cgi?id=9241572 "Bug 1730194 - Prevent Copy button to send information to Cloud Clipboard and Clipboard History on Windows r?dimi,sfoster,tgiles,johannh") [[details]](/attachment.cgi?id=9241572&action=edit "Bug 1730194 - Prevent Copy button to send information to Cloud Clipboard and Clipboard History on Windows r?dimi,sfoster,tgiles,johannh")

[Bug 1730194](/show_bug.cgi?id=1730194 "VERIFIED FIXED - Prevent Copy button to send information to Cloud Clipboard and Clipboard History on Windows") - Prevent Copy button to send information to Cloud Clipboard and Clipboard History on Windows r?dimi,sfoster,tgiles,johannh

Approved for 91.3esr.

[Attachment #9241572](/attachment.cgi?id=9241572&action=edit "Bug 1730194 - Prevent Copy button to send information to Cloud Clipboard and Clipboard History on Windows r?dimi,sfoster,tgiles,johannh") -
Flags: approval-mozilla-esr91? → approval-mozilla-esr91+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1730194#c17)• 3 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr91/rev/8e2b9a337281>

[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed)

|  | [Bogdan Maris, Desktop Test Engineering [PTO until 13 Jan]](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1730194#c18)• 3 years ago |
|  | |

Also verified that this is fixed using latest esr91 build from treeherder.

Status: RESOLVED → VERIFIEDQA Whiteboard: [qa-triaged]
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=verified)Flags: qe-verify+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1730194#a4069127_578488)• 3 years ago |

Whiteboard: [sec-survey] → [sec-survey][adv-main94+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1730194#c19)• 3 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9248071)
— [Details](attachment.cgi?id=9248071&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1730194#a4069896_578488)• 3 years ago |

Whiteboard: [sec-survey][adv-main94+] → [sec-survey][adv-main94+][adv-esr91.3+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1730194#a4489404_578488)• 3 years ago |

Alias: CVE-2021-38505

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1730194#a4828891_406194)• 3 years ago |

Regressions: [1739413](/show_bug.cgi?id=1739413 "RESOLVED WONTFIX - windows clipboard history doesn't work in version 94.0 in private window")

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1730194#a8728116_447061)• 3 years ago |

See Also: → [1746388](/show_bug.cgi?id=1746388 "NEW - Clipboard API lacks a sensitive/private data type => password managers can't protect your passwords from leaking through Clipboard History or Cloud Clipboard")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1730194#a30293065_1689)• 2 years ago |

Group: core-security-release

|  | [Alice0775 White](/user_profile?user_id=293623) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1730194#a33645463_293623)• 2 years ago |

Regressions: [1753567](/show_bug.cgi?id=1753567 "RESOLVED INVALID - Windows system: Problem with display copied text from pages in clipboard")
You need to [log in](/show_bug.cgi?id=1730194&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Sergey Galich [:serg]](/user_profile?user_id=691597)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_0ee21338_20250108_144142.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-48

## Security Vulnerabilities fixed in Firefox 94

Announced
November 2, 2021
Impact
high
Products
Firefox
Fixed in

* Firefox 94

#### [#CVE-2021-38503: iframe sandbox rules did not apply to XSLT stylesheets](#CVE-2021-38503)

Reporter
Armin Ebert
Impact
high
##### Description

The iframe sandbox rules were not correctly applied to XSLT stylesheets, allowing an iframe to bypass restrictions such as executing scripts or navigating the top-level frame.

##### References

* [Bug 1729517](https://bugzilla.mozilla.org/show_bug.cgi?id=1729517)

#### [#CVE-2021-38504: Use-after-free in file picker dialog](#CVE-2021-38504)

Reporter
Irvan Kurniawan
Impact
high
##### Description

When interacting with an HTML input element's file picker dialog with `webkitdirectory` set, a use-after-free could have resulted, leading to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1730156](https://bugzilla.mozilla.org/show_bug.cgi?id=1730156)

#### [#CVE-2021-38505: Windows 10 Cloud Clipboard may have recorded sensitive user data](#CVE-2021-38505)

Reporter
Sergey Galich
Impact
high
##### Description

Microsoft introduced a new feature in Windows 10 known as Cloud Clipboard which, if enabled, will record data copied to the clipboard to the cloud, and make it available on other computers in certain scenarios. Applications that wish to prevent copied data from being recorded in Cloud History must use specific clipboard formats; and Firefox before versions 94 and ESR 91.3 did not implement them. This could have caused sensitive data to be recorded to a user's Microsoft account.
*This bug only affects Firefox for Windows 10+ with Cloud Clipboard enabled. Other operating systems are unaffected.*

##### References

* [Bug 1730194](https://bugzilla.mozilla.org/show_bug.cgi?id=1730194)

#### [#CVE-2021-38506: Firefox could be coaxed into going into fullscreen mode without notification or warning](#CVE-2021-38506)

Reporter
Irvan Kurniawan
Impact
high
##### Description

Through a series of navigations, Firefox could have entered fullscreen mode without notification or warning to the user. This could lead to spoofing attacks on the browser UI including phishing.

##### References

* [Bug 1730750](https://bugzilla.mozilla.org/show_bug.cgi?id=1730750)

#### [#CVE-2021-38507: Opportunistic Encryption in HTTP2 could be used to bypass the Same-Origin-Policy on services hosted on other ports](#CVE-2021-38507)

Reporter
Takeshi Terada
Impact
high
##### Description

The Opportunistic Encryption feature of HTTP2 (RFC 8164) allows a connection to be transparently upgraded to TLS while retaining the visual properties of an HTTP connection, including being same-origin with unencrypted connections on port 80. However, if a second encrypted port on the same IP address (e.g. port 8443) did not opt-in to opportunistic encryption; a network attacker could forward a connection from the browser to port 443 to port 8443, causing the browser to treat the content of port 8443 as same-origin with HTTP. This was resolved by disabling the Opportunistic Encryption feature, which had low usage.

##### References

* [Bug 1730935](https://bugzilla.mozilla.org/show_bug.cgi?id=1730935)

#### [#CVE-2021-43530: Universal XSS in Firefox for Android via QR Code URLs](#CVE-2021-43530)

Reporter
Hafiizh
Impact
high
##### Description

A Universal XSS vulnerability was present in Firefox for Android resulting from improper sanitization when processing a URL scanned from a QR code.
*This bug only affects Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1736886](https://bugzilla.mozilla.org/show_bug.cgi?id=1736886)

#### [#CVE-2021-38508: Permission Prompt could be overlaid, resulting in user confusion and potential spoofing](#CVE-2021-38508)

Reporter
Raphael
Impact
moderate
##### Description

By displaying a form validity message in the correct location at the same time as a permission prompt (such as for geolocation), the validity message could have obscured the prompt, resulting in the user potentially being tricked into granting the permission.

##### References

* [Bug 1366818](https://bugzilla.mozilla.org/show_bug.cgi?id=1366818)

#### [#CVE-2021-43531: Web Extensions could access pre-redirect URL when their context menu was triggered by a user](#CVE-2021-43531)

Reporter
Rob Wu
Impact
moderate
##### Description

When a user loaded a Web Extensions context menu, the Web Extension could access the post-redirect URL of the element clicked. If the Web Extension lacked the WebRequest permission for the hosts involved in the redirect, this would be a same-origin-violation leaking data the Web Extension should have access to. This was fixed to provide the pre-redirect URL. This is related to CVE-2021-43532 but in the context of Web Extensions.

##### References

* [Bug 1659155](https://bugzilla.mozilla.org/show_bug.cgi?id=1659155)

#### [#CVE-2021-38509: Javascript alert box could have been spoofed onto an arbitrary domain](#CVE-2021-38509)

Reporter
Ademar Nowasky Junior
Impact
moderate
##### Description

Due to an unusual sequence of attacker-controlled events, a Javascript `alert()` dialog with arbitrary (although unstyled) contents could be displayed over top an uncontrolled webpage of the attacker's choosing.

##### References

* [Bug 1718571](https://bugzilla.mozilla.org/show_bug.cgi?id=1718571)

#### [#CVE-2021-38510: Download Protections were bypassed by .inetloc files on Mac OS](#CVE-2021-38510)

Reporter
Hou JingYi
Impact
moderate
##### Description

The executable file warning was not presented when downloading .inetloc files, which can run commands on a user's computer.
*Note: This issue only affected Mac OS operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1731779](https://bugzilla.mozilla.org/show_bug.cgi?id=1731779)

#### [#CVE-2021-43532: 'Copy Image Link' context menu action could have been abused to see authentication tokens](#CVE-2021-43532)

Reporter
Ademar Nowasky Junior
Impact
low
##### Description

The 'Copy Image Link' context menu action would copy the final image URL after redirects. By embedding an image that triggered authentication flows - in conjunction with a Content Security Policy that stopped a redirection chain in the middle - the final image URL could be one that contained an authentication token used to takeover a user account. If a website tricked a user into copy and pasting the image link back to the page, the page would be able to steal the authentication tokens. This was fixed by making the action return the original URL, before any redirects.

##### References

* [Bug 1719203](https://bugzilla.mozilla.org/show_bug.cgi?id=1719203)

#### [#CVE-2021-43533: URL Parsing may incorrectly parse internationalized domains](#CVE-2021-43533)

Reporter
Taiga Shirakura
Impact
low
##### Description

When parsing internationalized domain names, high bits of the characters in the URLs were sometimes stripped, resulting in inconsistencies that could lead to user confusion or attacks such as phishing.

##### References

* [Bug 1724233](https://bugzilla.mozilla.org/show_bug.cgi?id=1724233)

#### [#CVE-2021-43534: Memory safety bugs fixed in Firefox 94 and Firefox ESR 91.3](#CVE-2021-43534)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers and community members Christian Holler, Valentin Gosu, and Andrew McCreight reported memory safety bugs present in Firefox 93 and Firefox ESR 91.2. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 94 and Firefox ESR 91.3](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1606864%2C1712671%2C1730048%2C1735152)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_827a400d_20250108_144143.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-49

## Security Vulnerabilities fixed in Firefox ESR 91.3

Announced
November 2, 2021
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 91.3

#### [#CVE-2021-38503: iframe sandbox rules did not apply to XSLT stylesheets](#CVE-2021-38503)

Reporter
Armin Ebert
Impact
high
##### Description

The iframe sandbox rules were not correctly applied to XSLT stylesheets, allowing an iframe to bypass restrictions such as executing scripts or navigating the top-level frame.

##### References

* [Bug 1729517](https://bugzilla.mozilla.org/show_bug.cgi?id=1729517)

#### [#CVE-2021-38504: Use-after-free in file picker dialog](#CVE-2021-38504)

Reporter
Irvan Kurniawan
Impact
high
##### Description

When interacting with an HTML input element's file picker dialog with `webkitdirectory` set, a use-after-free could have resulted, leading to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1730156](https://bugzilla.mozilla.org/show_bug.cgi?id=1730156)

#### [#CVE-2021-38505: Windows 10 Cloud Clipboard may have recorded sensitive user data](#CVE-2021-38505)

Reporter
Sergey Galich
Impact
high
##### Description

Microsoft introduced a new feature in Windows 10 known as Cloud Clipboard which, if enabled, will record data copied to the clipboard to the cloud, and make it available on other computers in certain scenarios. Applications that wish to prevent copied data from being recorded in Cloud History must use specific clipboard formats; and Firefox before versions 94 and ESR 91.3 did not implement them. This could have caused sensitive data to be recorded to a user's Microsoft account.
*This bug only affects Firefox for Windows 10+ with Cloud Clipboard enabled. Other operating systems are unaffected.*

##### References

* [Bug 1730194](https://bugzilla.mozilla.org/show_bug.cgi?id=1730194)

#### [#CVE-2021-38506: Firefox could be coaxed into going into fullscreen mode without notification or warning](#CVE-2021-38506)

Reporter
Irvan Kurniawan
Impact
high
##### Description

Through a series of navigations, Firefox could have entered fullscreen mode without notification or warning to the user. This could lead to spoofing attacks on the browser UI including phishing.

##### References

* [Bug 1730750](https://bugzilla.mozilla.org/show_bug.cgi?id=1730750)

#### [#CVE-2021-38507: Opportunistic Encryption in HTTP2 could be used to bypass the Same-Origin-Policy on services hosted on other ports](#CVE-2021-38507)

Reporter
Takeshi Terada
Impact
high
##### Description

The Opportunistic Encryption feature of HTTP2 (RFC 8164) allows a connection to be transparently upgraded to TLS while retaining the visual properties of an HTTP connection, including being same-origin with unencrypted connections on port 80. However, if a second encrypted port on the same IP address (e.g. port 8443) did not opt-in to opportunistic encryption; a network attacker could forward a connection from the browser to port 443 to port 8443, causing the browser to treat the content of port 8443 as same-origin with HTTP. This was resolved by disabling the Opportunistic Encryption feature, which had low usage.

##### References

* [Bug 1730935](https://bugzilla.mozilla.org/show_bug.cgi?id=1730935)

#### [#CVE-2021-43535: Use-after-free in HTTP2 Session object](#CVE-2021-43535)

Reporter
Julien Cristau
Impact
high
##### Description

A use-after-free could have occured when an HTTP2 session object was released on a different thread, leading to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1667102](https://bugzilla.mozilla.org/show_bug.cgi?id=1667102)

#### [#CVE-2021-38508: Permission Prompt could be overlaid, resulting in user confusion and potential spoofing](#CVE-2021-38508)

Reporter
Raphael
Impact
moderate
##### Description

By displaying a form validity message in the correct location at the same time as a permission prompt (such as for geolocation), the validity message could have obscured the prompt, resulting in the user potentially being tricked into granting the permission.

##### References

* [Bug 1366818](https://bugzilla.mozilla.org/show_bug.cgi?id=1366818)

#### [#CVE-2021-38509: Javascript alert box could have been spoofed onto an arbitrary domain](#CVE-2021-38509)

Reporter
Ademar Nowasky Junior
Impact
moderate
##### Description

Due to an unusual sequence of attacker-controlled events, a Javascript `alert()` dialog with arbitrary (although unstyled) contents could be displayed over top an uncontrolled webpage of the attacker's choosing.

##### References

* [Bug 1718571](https://bugzilla.mozilla.org/show_bug.cgi?id=1718571)

#### [#CVE-2021-38510: Download Protections were bypassed by .inetloc files on Mac OS](#CVE-2021-38510)

Reporter
Hou JingYi
Impact
moderate
##### Description

The executable file warning was not presented when downloading .inetloc files, which, due to a flaw in Mac OS, can run commands on a user's computer.
*Note: This issue only affected Mac OS operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1731779](https://bugzilla.mozilla.org/show_bug.cgi?id=1731779)

#### [#CVE-2021-43534: Memory safety bugs fixed in Firefox 94 and Firefox ESR 91.3](#CVE-2021-43534)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers and community members Christian Holler, Valentin Gosu, and Andrew McCreight reported memory safety bugs present in Firefox 93 and Firefox ESR 91.2. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 94 and Firefox ESR 91.3](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1606864%2C1712671%2C1730048%2C1735152)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_0e2a32c7_20250108_144143.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-50

## Security Vulnerabilities fixed in Thunderbird 91.3

Announced
November 3, 2021
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 91.3

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*
This advisory was updated January 17, 2023 to add CVE-2021-43529. This fix was included in the original release of Thunderbird 91.3, but did not appear in the advisory published at that time.

#### [#CVE-2021-43529: Memory corruption when processing S/MIME messages](#CVE-2021-43529)

Reporter
Tavis Ormandy
Impact
critical
##### Description

Thunderbird versions prior to 91.3.0 are vulnerable to the heap overflow described in CVE-2021-43527 when processing S/MIME messages. Thunderbird versions 91.3.0 and later will not call the vulnerable code when processing S/MIME messages that contain certificates with DER-encoded DSA or RSA-PSS signatures.
Note: This advisory was added on January 17, 2023 after discovering it was inadvertently left out of the original advisory. The fix was included in the original release of Thunderbird 91.3.

##### References

* [Bug 1738501](https://bugzilla.mozilla.org/show_bug.cgi?id=1738501)

#### [#CVE-2021-38503: iframe sandbox rules did not apply to XSLT stylesheets](#CVE-2021-38503)

Reporter
Armin Ebert
Impact
high
##### Description

The iframe sandbox rules were not correctly applied to XSLT stylesheets, allowing an iframe to bypass restrictions such as executing scripts or navigating the top-level frame.

##### References

* [Bug 1729517](https://bugzilla.mozilla.org/show_bug.cgi?id=1729517)

#### [#CVE-2021-38504: Use-after-free in file picker dialog](#CVE-2021-38504)

Reporter
Irvan Kurniawan
Impact
high
##### Description

When interacting with an HTML input element's file picker dialog with `webkitdirectory` set, a use-after-free could have resulted, leading to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1730156](https://bugzilla.mozilla.org/show_bug.cgi?id=1730156)

#### [#CVE-2021-38505: Windows 10 Cloud Clipboard may have recorded sensitive user data](#CVE-2021-38505)

Reporter
Sergey Galich
Impact
high
##### Description

Microsoft introduced a new feature in Windows 10 known as Cloud Clipboard which, if enabled, will record data copied to the clipboard to the cloud, and make it available on other computers in certain scenarios. Applications that wish to prevent copied data from being recorded in Cloud History must use specific clipboard formats; and Thunderbird before version 91.3 did not implement them. This could have caused sensitive data to be recorded to a user's Microsoft account.
*This bug only affects Thunderbird for Windows 10+ with Cloud Clipboard enabled. Other operating systems are unaffected.*

##### References

* [Bug 1730194](https://bugzilla.mozilla.org/show_bug.cgi?id=1730194)

#### [#CVE-2021-38506: Thunderbird could be coaxed into going into fullscreen mode without notification or warning](#CVE-2021-38506)

Reporter
Irvan Kurniawan
Impact
high
##### Description

Through a series of web navigations, Thunderbird could have entered fullscreen mode without notification or warning to the user. This could lead to spoofing attacks on the browser UI including phishing.

##### References

* [Bug 1730750](https://bugzilla.mozilla.org/show_bug.cgi?id=1730750)

#### [#CVE-2021-38507: Opportunistic Encryption in HTTP2 could be used to bypass the Same-Origin-Policy on services hosted on other ports](#CVE-2021-38507)

Reporter
Takeshi Terada
Impact
high
##### Description

The Opportunistic Encryption feature of HTTP2 (RFC 8164) allows a connection to be transparently upgraded to TLS while retaining the visual properties of an HTTP connection, including being same-origin with unencrypted connections on port 80. However, if a second encrypted port on the same IP address (e.g. port 8443) did not opt-in to opportunistic encryption; a network attacker could forward a connection from the browser to port 443 to port 8443, causing the browser to treat the content of port 8443 as same-origin with HTTP. This was resolved by disabling the Opportunistic Encryption feature, which had low usage.

##### References

* [Bug 1730935](https://bugzilla.mozilla.org/show_bug.cgi?id=1730935)

#### [#CVE-2021-43535: Use-after-free in HTTP2 Session object](#CVE-2021-43535)

Reporter
Julien Cristau
Impact
high
##### Description

A use-after-free could have occured when an HTTP2 session object was released on a different thread, leading to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1667102](https://bugzilla.mozilla.org/show_bug.cgi?id=1667102)

#### [#CVE-2021-38508: Permission Prompt could be overlaid, resulting in user confusion and potential spoofing](#CVE-2021-38508)

Reporter
Raphael
Impact
moderate
##### Description

By displaying a form validity message in the correct location at the same time as a permission prompt (such as for geolocation), the validity message could have obscured the prompt, resulting in the user potentially being tricked into granting the permission.

##### References

* [Bug 1366818](https://bugzilla.mozilla.org/show_bug.cgi?id=1366818)

#### [#CVE-2021-38509: Javascript alert box could have been spoofed onto an arbitrary domain](#CVE-2021-38509)

Reporter
Ademar Nowasky Junior
Impact
moderate
##### Description

Due to an unusual sequence of attacker-controlled events, a Javascript `alert()` dialog with arbitrary (although unstyled) contents could be displayed over top an uncontrolled webpage of the attacker's choosing.

##### References

* [Bug 1718571](https://bugzilla.mozilla.org/show_bug.cgi?id=1718571)

#### [#CVE-2021-38510: Download Protections were bypassed by .inetloc files on Mac OS](#CVE-2021-38510)

Reporter
Hou JingYi
Impact
moderate
##### Description

The executable file warning was not presented when downloading .inetloc files, which, due to a flaw in Mac OS, can run commands on a user's computer.
*Note: This issue only affected Mac OS operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1731779](https://bugzilla.mozilla.org/show_bug.cgi?id=1731779)

#### [#CVE-2021-43534: Memory safety bugs fixed in Thunderbird ESR 91.3](#CVE-2021-43534)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers and community members Christian Holler, Valentin Gosu, and Andrew McCreight reported memory safety bugs present in Thunderbird 91.2. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 91.3](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1606864%2C1712671%2C1730048%2C1735152)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


