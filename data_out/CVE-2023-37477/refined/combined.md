=== Content from github.com_6954cbf7_20250111_021315.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2F1Panel-dev%2F1Panel%2Fsecurity%2Fadvisories%2FGHSA-p9xf-74xh-mhw5)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2F1Panel-dev%2F1Panel%2Fsecurity%2Fadvisories%2FGHSA-p9xf-74xh-mhw5)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=1Panel-dev%2F1Panel)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[1Panel-dev](/1Panel-dev)
/
**[1Panel](/1Panel-dev/1Panel)**
Public

* [Notifications](/login?return_to=%2F1Panel-dev%2F1Panel) You must be signed in to change notification settings
* [Fork
  2.2k](/login?return_to=%2F1Panel-dev%2F1Panel)
* [Star
   24.9k](/login?return_to=%2F1Panel-dev%2F1Panel)

* [Code](/1Panel-dev/1Panel)
* [Issues
  608](/1Panel-dev/1Panel/issues)
* [Pull requests
  0](/1Panel-dev/1Panel/pulls)
* [Discussions](/1Panel-dev/1Panel/discussions)
* [Actions](/1Panel-dev/1Panel/actions)
* [Security](/1Panel-dev/1Panel/security)
* [Insights](/1Panel-dev/1Panel/pulse)

Additional navigation options

* [Code](/1Panel-dev/1Panel)
* [Issues](/1Panel-dev/1Panel/issues)
* [Pull requests](/1Panel-dev/1Panel/pulls)
* [Discussions](/1Panel-dev/1Panel/discussions)
* [Actions](/1Panel-dev/1Panel/actions)
* [Security](/1Panel-dev/1Panel/security)
* [Insights](/1Panel-dev/1Panel/pulse)

# Command injection in Firewall ip functionality

High

[wanghe-fit2cloud](/wanghe-fit2cloud)
published
GHSA-p9xf-74xh-mhw5
Jul 18, 2023

## Package

gomod

https://github.com/1Panel-dev/1Panel
([Go](/advisories?query=ecosystem%3Ago))

## Affected versions

<= 1.4.2

## Patched versions

1.4.3

## Description

### Summary

An OS command injection vulnerability exists in 1Panel firewall functionality. A specially-crafted HTTP request can lead to arbitrary command execution. An attacker can make an authenticated HTTP request to trigger this vulnerability.

### Details

1Panel firewall functionality `/hosts/firewall/ip` endpoint read user input without validation, the attacker extends the default functionality of the application, which execute system commands.

### PoC

the payload `; sleep 3 #` will lead server response in 3 seconds

[![image](https://user-images.githubusercontent.com/4935500/252299676-bc4a8b92-e475-40ee-a92a-fec9fad7a6c3.png)](https://user-images.githubusercontent.com/4935500/252299676-bc4a8b92-e475-40ee-a92a-fec9fad7a6c3.png)

the payload `; sleep 6 #` will lead server response in 6 seconds

[![image](https://user-images.githubusercontent.com/4935500/252299871-766cc411-69e5-4c6c-b4ff-7774fa974ea0.png)](https://user-images.githubusercontent.com/4935500/252299871-766cc411-69e5-4c6c-b4ff-7774fa974ea0.png)

### Impact

An attacker can execute arbitrary code on the target system, which can lead to a complete compromise of the system.

### Patches

The vulnerability has been fixed in v1.4.3.

### Workarounds

It is recommended to upgrade the version to v1.4.3.

### References

If you have any questions or comments about this advisory:

Open an issue in <https://github.com/1Panel-dev/1Panel>

Email us at wanghe@fit2cloud.com

### Severity

High

7.2

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
High

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H

### CVE ID

CVE-2023-37477

### Weaknesses

[CWE-77](/advisories?query=cwe%3A77) [CWE-78](/advisories?query=cwe%3A78)

### Credits

* [![@Malayke](https://avatars.githubusercontent.com/u/4935500?s=40&v=4)](/Malayke)
  [Malayke](/Malayke)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_3d2e26cd_20250111_021315.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2F1Panel-dev%2F1Panel%2Fcommit%2Fe17b80cff4975ee343568ff526b62319f499005d)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2F1Panel-dev%2F1Panel%2Fcommit%2Fe17b80cff4975ee343568ff526b62319f499005d)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=1Panel-dev%2F1Panel)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[1Panel-dev](/1Panel-dev)
/
**[1Panel](/1Panel-dev/1Panel)**
Public

* [Notifications](/login?return_to=%2F1Panel-dev%2F1Panel) You must be signed in to change notification settings
* [Fork
  2.2k](/login?return_to=%2F1Panel-dev%2F1Panel)
* [Star
   24.9k](/login?return_to=%2F1Panel-dev%2F1Panel)

* [Code](/1Panel-dev/1Panel)
* [Issues
  608](/1Panel-dev/1Panel/issues)
* [Pull requests
  0](/1Panel-dev/1Panel/pulls)
* [Discussions](/1Panel-dev/1Panel/discussions)
* [Actions](/1Panel-dev/1Panel/actions)
* [Security](/1Panel-dev/1Panel/security)
* [Insights](/1Panel-dev/1Panel/pulse)

Additional navigation options

* [Code](/1Panel-dev/1Panel)
* [Issues](/1Panel-dev/1Panel/issues)
* [Pull requests](/1Panel-dev/1Panel/pulls)
* [Discussions](/1Panel-dev/1Panel/discussions)
* [Actions](/1Panel-dev/1Panel/actions)
* [Security](/1Panel-dev/1Panel/security)
* [Insights](/1Panel-dev/1Panel/pulse)

## Commit

[Permalink](/1Panel-dev/1Panel/commit/e17b80cff4975ee343568ff526b62319f499005d)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

fix: 解决部分接口命令注入问题 ([#1690](https://github.com/1Panel-dev/1Panel/pull/1690))

[Browse files](/1Panel-dev/1Panel/tree/e17b80cff4975ee343568ff526b62319f499005d)
Browse the repository at this point in the history

* Loading branch information

[![@ssongliu](https://avatars.githubusercontent.com/u/73214554?s=40&v=4)](/ssongliu)

[ssongliu](/1Panel-dev/1Panel/commits?author=ssongliu "View all commits by ssongliu")
authored
Jul 17, 2023

1 parent
[1d6f1b0](/1Panel-dev/1Panel/commit/1d6f1b0ef302dad2f6dd1e6bb23f6d5b86c74e59)

commit e17b80c

 Show file tree

 Hide file tree

Showing
**12 changed files**
with
**58 additions**
and
**7 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* backend

  + app/service

    - backend/app/service/container.go
      [container.go](#diff-0cbbde6260f6a241c955cd5203e591450290adadfec4c80d3e99082ff8dd8358)
    - backend/app/service/container\_compose.go
      [container\_compose.go](#diff-e14b8d27b02cdfcf0b89f5a66f60c4bc5fd92fc53410f96a0a52460261ef4229)
    - backend/app/service/database\_mysql.go
      [database\_mysql.go](#diff-ba79fa36d9331cecc649716bafdf4e1acd2097221e73e3fe6a303af8fa1fd939)
    - backend/app/service/firewall.go
      [firewall.go](#diff-e9eae227607b00a64a32f9ed3ff16050f81a9776e37fea5236ab5e4b8fcc9a1a)
    - backend/app/service/image\_repo.go
      [image\_repo.go](#diff-8e44e0b650bacfc677c311d1b01af3f32fda78bb0bcaae2eaa33ad2fecf951e2)
    - backend/app/service/ssh.go
      [ssh.go](#diff-87aa4afa4e1d9c2037c3845eeafdb441b32c95dcd970cb63ce7838fc144baec0)
  + constant

    - backend/constant/errs.go
      [errs.go](#diff-5cb04330c13fe2e8d975577147fa020fee0cf681b020d5ba954548629a157c77)
  + i18n/lang

    - backend/i18n/lang/en.yaml
      [en.yaml](#diff-8d5abf7ae434b58c34889eb1f3f2772434039b8dc4a49909e758fd6823f3d547)
    - backend/i18n/lang/zh-Hant.yaml
      [zh-Hant.yaml](#diff-271cf963bf7947f6b49758c7103c8ba558515a969c945965b1856749cbea9a3b)
    - backend/i18n/lang/zh.yaml
      [zh.yaml](#diff-3dfa4b0f7f3b9b13586489e12d4d32081875699e0168aa36782a6b2d8f23c8d7)
  + utils/firewall/client

    - backend/utils/firewall/client/firewalld.go
      [firewalld.go](#diff-09d6b77cb727a11321a964edeccb99e367c1282fcf750034e0926eb7dbd51807)
    - backend/utils/firewall/client/ufw.go
      [ufw.go](#diff-549f661b301beb0e1e3e5c204a42202ad4db05e59b872dffc3b40ad8fcf4e64b)

## There are no files selected for viewing

4 changes: 4 additions & 0 deletions

4
[backend/app/service/container.go](#diff-0cbbde6260f6a241c955cd5203e591450290adadfec4c80d3e99082ff8dd8358 "backend/app/service/container.go")

Show comments

[View file](/1Panel-dev/1Panel/blob/e17b80cff4975ee343568ff526b62319f499005d/backend/app/service/container.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -18,6 +18,7 @@ import ( |
|  |  | "github.com/1Panel-dev/1Panel/backend/buserr" |
|  |  | "github.com/1Panel-dev/1Panel/backend/constant" |
|  |  | "github.com/1Panel-dev/1Panel/backend/global" |
|  |  | "github.com/1Panel-dev/1Panel/backend/utils/cmd" |
|  |  | "github.com/1Panel-dev/1Panel/backend/utils/common" |
|  |  | "github.com/1Panel-dev/1Panel/backend/utils/docker" |
|  |  | "github.com/docker/docker/api/types" |
| Expand Down  Expand Up | | @@ -552,6 +553,9 @@ func (u \*ContainerService) ContainerLogClean(req dto.OperationWithName) error { |
|  |  | } |
|  |  |  |
|  |  | func (u \*ContainerService) ContainerLogs(wsConn \*websocket.Conn, container, since, tail string, follow bool) error { |
|  |  | if cmd.CheckIllegal(container, since, tail) { |
|  |  | return buserr.New(constant.ErrCmdIllegal) |
|  |  | } |
|  |  | command := fmt.Sprintf("docker logs %s", container) |
|  |  | if tail != "0" { |
|  |  | command += " -n " + tail |
| Expand Down | |  |

14 changes: 14 additions & 0 deletions

14
[backend/app/service/container\_compose.go](#diff-e14b8d27b02cdfcf0b89f5a66f60c4bc5fd92fc53410f96a0a52460261ef4229 "backend/app/service/container_compose.go")

Show comments

[View file](/1Panel-dev/1Panel/blob/e17b80cff4975ee343568ff526b62319f499005d/backend/app/service/container_compose.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -14,8 +14,10 @@ import ( |
|  |  |  |
|  |  | "github.com/1Panel-dev/1Panel/backend/app/dto" |
|  |  | "github.com/1Panel-dev/1Panel/backend/app/model" |
|  |  | "github.com/1Panel-dev/1Panel/backend/buserr" |
|  |  | "github.com/1Panel-dev/1Panel/backend/constant" |
|  |  | "github.com/1Panel-dev/1Panel/backend/global" |
|  |  | "github.com/1Panel-dev/1Panel/backend/utils/cmd" |
|  |  | "github.com/1Panel-dev/1Panel/backend/utils/compose" |
|  |  | "github.com/1Panel-dev/1Panel/backend/utils/docker" |
|  |  | "github.com/docker/docker/api/types" |
| Expand Down  Expand Up | | @@ -127,6 +129,9 @@ func (u \*ContainerService) PageCompose(req dto.SearchWithPage) (int64, interface |
|  |  | } |
|  |  |  |
|  |  | func (u \*ContainerService) TestCompose(req dto.ComposeCreate) (bool, error) { |
|  |  | if cmd.CheckIllegal(req.Path) { |
|  |  | return false, buserr.New(constant.ErrCmdIllegal) |
|  |  | } |
|  |  | composeItem, \_ := composeRepo.GetRecord(commonRepo.WithByName(req.Name)) |
|  |  | if composeItem.ID != 0 { |
|  |  | return false, constant.ErrRecordExist |
| Expand All | | @@ -143,6 +148,9 @@ func (u \*ContainerService) TestCompose(req dto.ComposeCreate) (bool, error) { |
|  |  | } |
|  |  |  |
|  |  | func (u \*ContainerService) CreateCompose(req dto.ComposeCreate) (string, error) { |
|  |  | if cmd.CheckIllegal(req.Name, req.Path) { |
|  |  | return "", buserr.New(constant.ErrCmdIllegal) |
|  |  | } |
|  |  | if err := u.loadPath(&req); err != nil { |
|  |  | return "", err |
|  |  | } |
| Expand Down  Expand Up | | @@ -177,6 +185,9 @@ func (u \*ContainerService) CreateCompose(req dto.ComposeCreate) (string, error) |
|  |  | } |
|  |  |  |
|  |  | func (u \*ContainerService) ComposeOperation(req dto.ComposeOperation) error { |
|  |  | if cmd.CheckIllegal(req.Path, req.Operation) { |
|  |  | return buserr.New(constant.ErrCmdIllegal) |
|  |  | } |
|  |  | if \_, err := os.Stat(req.Path); err != nil { |
|  |  | return fmt.Errorf("load file with path %s failed, %v", req.Path, err) |
|  |  | } |
| Expand All | | @@ -195,6 +206,9 @@ func (u \*ContainerService) ComposeOperation(req dto.ComposeOperation) error { |
|  |  | } |
|  |  |  |
|  |  | func (u \*ContainerService) ComposeUpdate(req dto.ComposeUpdate) error { |
|  |  | if cmd.CheckIllegal(req.Name, req.Path) { |
|  |  | return buserr.New(constant.ErrCmdIllegal) |
|  |  | } |
|  |  | if \_, err := os.Stat(req.Path); err != nil { |
|  |  | return fmt.Errorf("load file with path %s failed, %v", req.Path, err) |
|  |  | } |
| Expand Down | |  |

12 changes: 12 additions & 0 deletions

12
[backend/app/service/database\_mysql.go](#diff-ba79fa36d9331cecc649716bafdf4e1acd2097221e73e3fe6a303af8fa1fd939 "backend/app/service/database_mysql.go")

Show comments

[View file](/1Panel-dev/1Panel/blob/e17b80cff4975ee343568ff526b62319f499005d/backend/app/service/database_mysql.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -17,6 +17,7 @@ import ( |
|  |  | "github.com/1Panel-dev/1Panel/backend/buserr" |
|  |  | "github.com/1Panel-dev/1Panel/backend/constant" |
|  |  | "github.com/1Panel-dev/1Panel/backend/global" |
|  |  | "github.com/1Panel-dev/1Panel/backend/utils/cmd" |
|  |  | "github.com/1Panel-dev/1Panel/backend/utils/common" |
|  |  | "github.com/1Panel-dev/1Panel/backend/utils/compose" |
|  |  | \_ "github.com/go-sql-driver/mysql" |
| Expand Down  Expand Up | | @@ -77,6 +78,10 @@ var formatMap = map[string]string{ |
|  |  | } |
|  |  |  |
|  |  | func (u \*MysqlService) Create(ctx context.Context, req dto.MysqlDBCreate) (\*model.DatabaseMysql, error) { |
|  |  | if cmd.CheckIllegal(req.Name, req.Username, req.Password, req.Format, req.Permission) { |
|  |  | return nil, buserr.New(constant.ErrCmdIllegal) |
|  |  | } |
|  |  |  |
|  |  | if req.Username == "root" { |
|  |  | return nil, errors.New("Cannot set root as user name") |
|  |  | } |
| Expand Down  Expand Up | | @@ -184,6 +189,10 @@ func (u \*MysqlService) Delete(ctx context.Context, req dto.MysqlDBDelete) error |
|  |  | } |
|  |  |  |
|  |  | func (u \*MysqlService) ChangePassword(info dto.ChangeDBInfo) error { |
|  |  | if cmd.CheckIllegal(info.Value) { |
|  |  | return buserr.New(constant.ErrCmdIllegal) |
|  |  | } |
|  |  |  |
|  |  | var ( |
|  |  | mysql model.DatabaseMysql |
|  |  | err error |
| Expand Down  Expand Up | | @@ -253,6 +262,9 @@ func (u \*MysqlService) ChangePassword(info dto.ChangeDBInfo) error { |
|  |  | } |
|  |  |  |
|  |  | func (u \*MysqlService) ChangeAccess(info dto.ChangeDBInfo) error { |
|  |  | if cmd.CheckIllegal(info.Value) { |
|  |  | return buserr.New(constant.ErrCmdIllegal) |
|  |  | } |
|  |  | var ( |
|  |  | mysql model.DatabaseMysql |
|  |  | err error |
| Expand Down | |  |

1 change: 0 additions & 1 deletion

1
[backend/app/service/firewall.go](#diff-e9eae227607b00a64a32f9ed3ff16050f81a9776e37fea5236ab5e4b8fcc9a1a "backend/app/service/firewall.go")

Show comments

[View file](/1Panel-dev/1Panel/blob/e17b80cff4975ee343568ff526b62319f499005d/backend/app/service/firewall.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -304,7 +304,6 @@ func OperateFirewallPort(oldPorts, newPorts []int) error { |
|  |  | return err |
|  |  | } |
|  |  | for \_, port := range newPorts { |
|  |  |  |
|  |  | if err := client.Port(fireClient.FireInfo{Port: strconv.Itoa(port), Protocol: "tcp", Strategy: "accept"}, "add"); err != nil { |
|  |  | return err |
|  |  | } |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[backend/app/service/image\_repo.go](#diff-8e44e0b650bacfc677c311d1b01af3f32fda78bb0bcaae2eaa33ad2fecf951e2 "backend/app/service/image_repo.go")

Show comments

[View file](/1Panel-dev/1Panel/blob/e17b80cff4975ee343568ff526b62319f499005d/backend/app/service/image_repo.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -79,7 +79,7 @@ func (u \*ImageRepoService) List() ([]dto.ImageRepoOption, error) { |
|  |  |  |
|  |  | func (u \*ImageRepoService) Create(req dto.ImageRepoCreate) error { |
|  |  | if cmd.CheckIllegal(req.Username, req.Password, req.DownloadUrl) { |
|  |  | return buserr.New(constant.ErrRepoConn) |
|  |  | return buserr.New(constant.ErrCmdIllegal) |
|  |  | } |
|  |  | imageRepo, \_ := imageRepoRepo.Get(commonRepo.WithByName(req.Name)) |
|  |  | if imageRepo.ID != 0 { |
| Expand Down  Expand Up | | @@ -148,7 +148,7 @@ func (u \*ImageRepoService) Update(req dto.ImageRepoUpdate) error { |
|  |  | return errors.New("The default value cannot be deleted !") |
|  |  | } |
|  |  | if cmd.CheckIllegal(req.Username, req.Password, req.DownloadUrl) { |
|  |  | return buserr.New(constant.ErrRepoConn) |
|  |  | return buserr.New(constant.ErrCmdIllegal) |
|  |  | } |
|  |  | repo, err := imageRepoRepo.Get(commonRepo.WithByID(req.ID)) |
|  |  | if err != nil { |
| Expand Down | |  |

4 changes: 4 additions & 0 deletions

4
[backend/app/service/ssh.go](#diff-87aa4afa4e1d9c2037c3845eeafdb441b32c95dcd970cb63ce7838fc144baec0 "backend/app/service/ssh.go")

Show comments

[View file](/1Panel-dev/1Panel/blob/e17b80cff4975ee343568ff526b62319f499005d/backend/app/service/ssh.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -11,6 +11,7 @@ import ( |
|  |  | "time" |
|  |  |  |
|  |  | "github.com/1Panel-dev/1Panel/backend/app/dto" |
|  |  | "github.com/1Panel-dev/1Panel/backend/buserr" |
|  |  | "github.com/1Panel-dev/1Panel/backend/constant" |
|  |  | "github.com/1Panel-dev/1Panel/backend/global" |
|  |  | "github.com/1Panel-dev/1Panel/backend/utils/cmd" |
| Expand Down  Expand Up | | @@ -146,6 +147,9 @@ func (u \*SSHService) UpdateByFile(value string) error { |
|  |  | } |
|  |  |  |
|  |  | func (u \*SSHService) GenerateSSH(req dto.GenerateSSH) error { |
|  |  | if cmd.CheckIllegal(req.EncryptionMode, req.Password) { |
|  |  | return buserr.New(constant.ErrCmdIllegal) |
|  |  | } |
|  |  | currentUser, err := user.Current() |
|  |  | if err != nil { |
|  |  | return fmt.Errorf("load current user failed, err: %v", err) |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[backend/constant/errs.go](#diff-5cb04330c13fe2e8d975577147fa020fee0cf681b020d5ba954548629a157c77 "backend/constant/errs.go")

Show comments

[View file](/1Panel-dev/1Panel/blob/e17b80cff4975ee343568ff526b62319f499005d/backend/constant/errs.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -42,6 +42,7 @@ var ( |
|  |  | ErrTypePasswordExpired = "ErrPasswordExpired" |
|  |  | ErrNameIsExist = "ErrNameIsExist" |
|  |  | ErrDemoEnvironment = "ErrDemoEnvironment" |
|  |  | ErrCmdIllegal = "ErrCmdIllegal" |
|  |  | ) |
|  |  |  |
|  |  | // app |
| Expand Down  Expand Up | | @@ -107,7 +108,6 @@ var ( |
|  |  | ErrInUsed = "ErrInUsed" |
|  |  | ErrObjectInUsed = "ErrObjectInUsed" |
|  |  | ErrPortRules = "ErrPortRules" |
|  |  | ErrRepoConn = "ErrRepoConn" |
|  |  | ) |
|  |  |  |
|  |  | // runtime |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[backend/i18n/lang/en.yaml](#diff-8d5abf7ae434b58c34889eb1f3f2772434039b8dc4a49909e758fd6823f3d547 "backend/i18n/lang/en.yaml")

Show comments

[View file](/1Panel-dev/1Panel/blob/e17b80cff4975ee343568ff526b62319f499005d/backend/i18n/lang/en.yaml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -13,6 +13,7 @@ ErrNotSupportType: "The system does not support the current type: {{ .detail }}" |
|  |  | ErrNameIsExist: "Name is already exist" |
|  |  | ErrDemoEnvironment: "Demo server, prohibit this operation!" |
|  |  | ErrCmdTimeout: "Command execution timed out！" |
|  |  | ErrCmdIllegal: "The command contains illegal characters. Please modify and try again!" |
|  |  |  |
|  |  | #app |
|  |  | ErrPortInUsed: "{{ .detail }} port already in use" |
| Expand Down  Expand Up | | @@ -83,7 +84,6 @@ ErrTypeOfRedis: "The recovery file type does not match the current persistence m |
|  |  | #container |
|  |  | ErrInUsed: "{{ .detail }} is in use and cannot be deleted" |
|  |  | ErrObjectInUsed: "This object is in use and cannot be deleted" |
|  |  | ErrRepoConn: "The repository information contains illegal characters" |
|  |  | ErrPortRules: "The number of ports does not match, please re-enter!" |
|  |  |  |
|  |  | #runtime |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[backend/i18n/lang/zh-Hant.yaml](#diff-271cf963bf7947f6b49758c7103c8ba558515a969c945965b1856749cbea9a3b "backend/i18n/lang/zh-Hant.yaml")

Show comments

[View file](/1Panel-dev/1Panel/blob/e17b80cff4975ee343568ff526b62319f499005d/backend/i18n/lang/zh-Hant.yaml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -13,6 +13,7 @@ ErrNotSupportType: "系統暫不支持當前類型: {{ .detail }}" |
|  |  | ErrNameIsExist: "名稱已存在" |
|  |  | ErrDemoEnvironment: "演示伺服器，禁止此操作!" |
|  |  | ErrCmdTimeout: "指令執行超時！" |
|  |  | ErrCmdIllegal: "執行命令中存在不合法字符，請修改後重試！" |
|  |  |  |
|  |  | #app |
|  |  | ErrPortInUsed: "{{ .detail }} 端口已被佔用！" |
| Expand Down  Expand Up | | @@ -83,7 +84,6 @@ ErrTypeOfRedis: "恢復文件類型與當前持久化方式不符，請修改後 |
|  |  | #container |
|  |  | ErrInUsed: "{{ .detail }} 正被使用，無法刪除" |
|  |  | ErrObjectInUsed: "該對象正被使用，無法刪除" |
|  |  | ErrRepoConn: "倉庫資訊中存在不合法的字符" |
|  |  | ErrPortRules: "端口數目不匹配，請重新輸入！" |
|  |  |  |
|  |  | #runtime |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[backend/i18n/lang/zh.yaml](#diff-3dfa4b0f7f3b9b13586489e12d4d32081875699e0168aa36782a6b2d8f23c8d7 "backend/i18n/lang/zh.yaml")

Show comments

[View file](/1Panel-dev/1Panel/blob/e17b80cff4975ee343568ff526b62319f499005d/backend/i18n/lang/zh.yaml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -13,6 +13,7 @@ ErrNotSupportType: "系统暂不支持当前类型: {{ .detail }}" |
|  |  | ErrNameIsExist: "名称已存在" |
|  |  | ErrDemoEnvironment: "演示服务器，禁止此操作!" |
|  |  | ErrCmdTimeout: "命令执行超时！" |
|  |  | ErrCmdIllegal: "执行命令中存在不合法字符，请修改后重试！" |
|  |  |  |
|  |  | #app |
|  |  | ErrPortInUsed: "{{ .detail }} 端口已被占用！" |
| Expand Down  Expand Up | | @@ -83,7 +84,6 @@ ErrTypeOfRedis: "恢复文件类型与当前持久化方式不符，请修改后 |
|  |  | #container |
|  |  | ErrInUsed: "{{ .detail }} 正被使用，无法删除" |
|  |  | ErrObjectInUsed: "该对象正被使用，无法删除" |
|  |  | ErrRepoConn: "仓库信息中存在不合法的字符" |
|  |  | ErrPortRules: "端口数目不匹配，请重新输入！" |
|  |  |  |
|  |  | #runtime |
| Expand Down | |  |

9 changes: 9 additions & 0 deletions

9
[backend/utils/firewall/client/firewalld.go](#diff-09d6b77cb727a11321a964edeccb99e367c1282fcf750034e0926eb7dbd51807 "backend/utils/firewall/client/firewalld.go")

Show comments

[View file](/1Panel-dev/1Panel/blob/e17b80cff4975ee343568ff526b62319f499005d/backend/utils/firewall/client/firewalld.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -4,6 +4,8 @@ import ( |
|  |  | "fmt" |
|  |  | "strings" |
|  |  |  |
|  |  | "github.com/1Panel-dev/1Panel/backend/buserr" |
|  |  | "github.com/1Panel-dev/1Panel/backend/constant" |
|  |  | "github.com/1Panel-dev/1Panel/backend/utils/cmd" |
|  |  | ) |
|  |  |  |
| Expand Down  Expand Up | | @@ -114,6 +116,10 @@ func (f \*Firewall) ListAddress() ([]FireInfo, error) { |
|  |  | } |
|  |  |  |
|  |  | func (f \*Firewall) Port(port FireInfo, operation string) error { |
|  |  | if cmd.CheckIllegal(operation, port.Protocol, port.Port) { |
|  |  | return buserr.New(constant.ErrCmdIllegal) |
|  |  | } |
|  |  |  |
|  |  | stdout, err := cmd.Execf("firewall-cmd --zone=public --%s-port=%s/%s --permanent", operation, port.Port, port.Protocol) |
|  |  | if err != nil { |
|  |  | return fmt.Errorf("%s port failed, err: %s", operation, stdout) |
| Expand All | | @@ -122,6 +128,9 @@ func (f \*Firewall) Port(port FireInfo, operation string) error { |
|  |  | } |
|  |  |  |
|  |  | func (f \*Firewall) RichRules(rule FireInfo, operation string) error { |
|  |  | if cmd.CheckIllegal(operation, rule.Address, rule.Protocol, rule.Port, rule.Strategy) { |
|  |  | return buserr.New(constant.ErrCmdIllegal) |
|  |  | } |
|  |  | ruleStr := "" |
|  |  | if strings.Contains(rule.Address, "-") { |
|  |  | std, err := cmd.Execf("firewall-cmd --permanent --new-ipset=%s --type=hash:ip", rule.Address) |
| Expand Down | |  |

9 changes: 9 additions & 0 deletions

9
[backend/utils/firewall/client/ufw.go](#diff-549f661b301beb0e1e3e5c204a42202ad4db05e59b872dffc3b40ad8fcf4e64b "backend/utils/firewall/client/ufw.go")

Show comments

[View file](/1Panel-dev/1Panel/blob/e17b80cff4975ee343568ff526b62319f499005d/backend/utils/firewall/client/ufw.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -4,6 +4,8 @@ import ( |
|  |  | "fmt" |
|  |  | "strings" |
|  |  |  |
|  |  | "github.com/1Panel-dev/1Panel/backend/buserr" |
|  |  | "github.com/1Panel-dev/1Panel/backend/constant" |
|  |  | "github.com/1Panel-dev/1Panel/backend/utils/cmd" |
|  |  | ) |
|  |  |  |
| Expand Down  Expand Up | | @@ -131,6 +133,9 @@ func (f \*Ufw) Port(port FireInfo, operation string) error { |
|  |  | default: |
|  |  | return fmt.Errorf("unsupport strategy %s", port.Strategy) |
|  |  | } |
|  |  | if cmd.CheckIllegal(port.Protocol, port.Port) { |
|  |  | return buserr.New(constant.ErrCmdIllegal) |
|  |  | } |
|  |  |  |
|  |  | command := fmt.Sprintf("%s %s %s", f.CmdStr, port.Strategy, port.Port) |
|  |  | if operation == "remove" { |
| Expand All | | @@ -156,6 +161,10 @@ func (f \*Ufw) RichRules(rule FireInfo, operation string) error { |
|  |  | return fmt.Errorf("unsupport strategy %s", rule.Strategy) |
|  |  | } |
|  |  |  |
|  |  | if cmd.CheckIllegal(operation, rule.Protocol, rule.Address, rule.Port) { |
|  |  | return buserr.New(constant.ErrCmdIllegal) |
|  |  | } |
|  |  |  |
|  |  | ruleStr := fmt.Sprintf("%s %s ", f.CmdStr, rule.Strategy) |
|  |  | if operation == "remove" { |
|  |  | ruleStr = fmt.Sprintf("%s delete %s ", f.CmdStr, rule.Strategy) |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `e17b80c`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2F1Panel-dev%2F1Panel%2Fcommit%2Fe17b80cff4975ee343568ff526b62319f499005d) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


