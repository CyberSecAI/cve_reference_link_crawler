[xml version="1.0" encoding="UTF-8"?](/)ProductProductAll Safety subscriptions include access to our entire suite of products, delivering end-to-end supply chain security for teams of all sizes.[Safety Scanner and Dashboards icon

Safety CLI ScannerComprehensive, System-Wide Python Vulnerability Scanning](/product/safety-cli)[Vulnerability Database icon

Safety DBIndustry-leading Python dependency vulnerability database](/product/vulnerability-db)[Safety for AI/ML icon

Safety PlatformThreat analysis and management system with central policy management and web-based dashboards.](/product/safety-platform)[Package Gateway icon

Safety GatewaySecuring Software Supply Chains Against Malicious and Vulnerable Packages](/product/safety-gateway)

SolutionsSOLUTIONSSafety delivers software supply chain security to organizations of all sizes and across all industries.[Safety for Enterprise icon

Safety for EnterpriseEnterprise-grade Software Supply-Chain Security](/solutions/safety-for-enterprise)[Safety for DevSecOps icon

Safety for DevSecOpsReduce vulnerability noise by up to 90%, while enforcing supply chain security across your team](/solutions/devsecops)[Safety Scanner and Dashboards icon

Safety for AI/ML TeamsLeverage the power of Open Source, securely](/solutions/aiml)[Safety for AI/ML icon

Safety for Data ScienceJoin hundreds of data science, healthcare, and health technology organizations and secure your software supply chain.](/solutions/safety-for-healthcare)[Pricing icon

Safety for FinanceDiscover how Finance, FinTech and Insurance firms are securing their software supply chains with Safety.](/solutions/safety-for-finance)

ResourcesResourcesLearn about our available plans and access our extensive documentation designed to get your teams up and running in minutes, not weeks.[Pricing icon

Available PlansFind the right solution for your team](/resources/plans)[Documentation icon

DocumentationDeveloper guides, installation instructions, and more.](https://docs.safetycli.com)[GitHub icon

GitHubView our GitHub page for more details on our open-source products.](https://github.com/pyupio)[Open Source icon

Open SourceSafety's role in the open-source community.](https://github.com/pyupio)[Bug Bounty icon

Bug BountyDetails on our bug bounty program.](/resources/bug-bounty)[Safety for Enterprise icon

About Safety CybersecurityMeet our leadership team and learn more about Safety.](/resources/about)[Safety for AI/ML icon

CareersJoin our growing team and help revolutionize the way organizations protect their software ecosystems.](https://apply.workable.com/safety/)

[Research](/research)ResearchSafety's Cybersecurity Intelligence Team performs industry-leading research into novel attack vectors, vulnerabilities and more. From security best practice to the latest vulnerabilities, you'll find it here.[Documentation icon

All PostsView all research, security, and blog posts.](/research)[Documentation icon

ResearchRead the latest research and vulnerability findings by our Cybersecurity Intelligence Team.](https://safetycli.com/research?category=Research)[Documentation icon

SecuritySecurity best practices and information on software supply chain security.](https://safetycli.com/research?category=Security)[Documentation icon

Blog and Product UpdatesLearn more about Safety and our product updates via our blog.](https://safetycli.com/research?category=Blog)

[Pricing](/resources/plans)[Sign in](https://platform.safetycli.com/login/)[Sign Up](https://platform.safetycli.com/register/)Research
# Safety Discovers ReDoS Vulnerabilities in Top Python Packages

December 21, 2022â¢5 min readThis is the first of a series of posts disclosing novel security vulnerabilities found by PyUp's Cybersecurity Intelligence Team, which maintains PyUp's proprietary Python vulnerability database. In this post, we are covering ongoing research by our Cybersecurity team on an often underestimated type of vulnerability:
Regular Expression Denial of Service (ReDoS) attack.
Our team has found ReDoS attack vectors in some of the most popular and widely used python packages.![](https://cdn.prod.website-files.com/64465cf18ba6212696c9289f/64badd55a2336326101d3df3_redos_1_blog.png)
# **Safety Discovers ReDoS Vulnerabilities in Top Python Packages**

This is the first of a series of posts disclosing novel security vulnerabilities found by Safety's Cybersecurity Intelligence Team, which maintains Safety's proprietary [Python vulnerability database](https://pyup.io/#vuln-db).

â

In this post, we are covering ongoing research by our Cybersecurity team on an often underestimated type of vulnerability: Regular Expression Denial of Service (ReDoS) attack.

â
Our team has found ReDoS attack vectors in some of the most popular and widely used python packages.

â

## How Does a Regular Expression Denial of Service (ReDoS) Vulnerability Work?

This attack vector is frequently a concern when a web or other interface like a command line accepts user input. If successfully exploited, the load and resulting availability of your system or service may be affected. While interfaces are the most common concern with this type of attack, Regular Expressions can also be present in many other components of a software system stack, such as firewalls, backends, and many others.

â

![undefined](https://cdn.prod.website-files.com/64465cf18ba6212696c9289f/647e559e53942ea73337a01f_dfUgxmh8QpOfucR3YfpC.webp)

*(Source: Owasp)*

â

A Regular Expression can be a powerful resource for matching your needed data and text. If misconfigured, Regular Expression matching can take too much time and CPU resources, resulting in a worst-case exponential time execution on the input length of the data being matched.Â

â

When creating Regular Expressions that match the data you want, it can be easy to miss the critical step of also protecting from these potentially exponential time execution runs. This means that there can be poor-performing Regular Expressions in essential components of the software stack that are sometimes hard to detect while also being potentially exploitable.

â

A typical example of a vulnerable Regular Expression is ^(a+)+$

â

With an input like aaaX, this Regular Expression will "walk" all the possible paths for matching until finally failing in the ending character. This is called *backtracking,* and, in this case, the number of steps will grow exponentially with the number of a's in the input.

â

Depending on the programming language, different Regular Expression algorithms, engines, and implementations exist. It's a vast topic, and we won't try to cover that in detail here, but you can read more about Regular Expression matching and algorithms [here](https://www.regular-expressions.info/catastrophic.html).

â

## The steps we followed

With the aid of a variety of tools, we found vulnerable Regular Expressions in many popular Python open-source projects.

â

We then determined if the exploitation was possible by creating *proofs of concept*, informing the package maintainers following the responsible disclosure process, and, in some cases, helping to issue patches.

â

As a result of this research, several flaws were assigned CVE identifiers, and patched versions of the affected packages were released. The first of our findings are summarized in this post.

â

## Affected Packages

Top Python packages were examined according to their number of downloads. We analyzed all python packages with more than 20 million downloads in the last 30 days.

â

### **OAuthLib**

[OAuthLib](https://pypi.org/project/oauthlib/) is a framework that implements the logic of OAuth1 or OAuth2 without assuming a specific HTTP request object or web framework. OAuthLib is downloaded more than 85 million times each month.Â

â

#### Vulnerability Details:

The [IPv6 Regular Expression at uri\_validate.py](https://github.com/oauthlib/oauthlib/blob/2b8a44855a51ad5a5b0c348a08c2564a2e197ea2/oauthlib/uri_validate.py#L69) was vulnerable. As a result, an attacker providing a malicious redirect URI or leveraging the usage of uri\_validate functions could cause DoS to OAuthlib's web application.Â

â

**Who is impacted?**

The flaw was introduced in Oauthlib version 3.1.1. Affected are OAuthlib applications that use OAuth2.0 provider support or the uri\_validate function directly.Â

You can find more information [here](https://github.com/oauthlib/oauthlib/security/advisories/GHSA-3pgj-pg6c-r5p7).

â

**Patches**

This issue was fixed in the 3.2.1 release of OAuthLib.

â

**Workarounds**

*Is there a way for users to fix or remediate the vulnerability without upgrading to 3.2.1?*The redirect\_uri can be verified in Web Toolkit such asÂ  bottle-oauthlib or django-oauth-toolkit before OAuthlib is called. A sample check if : is present to reject the request can prevent the DoS, assuming no port or IPv6 is fundamentally required.

â

**Proof of Concept:**

is\_absolute\_uri("http://[:::::::::::::::::::::::::::::::::::::::]/path")

â

**Assigned Identifiers:**

**Safety Cybersecurity:** [50959](https://pyup.io/vulnerabilities/CVE-2022-36087/50959/)

**CVE:** [CVE-2022-36087](https://nvd.nist.gov/vuln/detail/CVE-2022-36087)

â

### **Wheel**

[Wheel](https://pypi.org/project/wheel/) is a reference implementation of the Python wheel packaging standard. Wheel is downloaded more than 155 million times each month.Â

â

#### Vulnerability Details:

The Regular Expression used to verify the validity of Wheel file names was discovered to be vulnerable. This vulnerability can be exploited in two ways: through the use of Wheel as a library or through the use of the Wheel Command Line Interface (CLI). While the use of Wheel as a library is already discouraged in the documentation, the use of the CLI is a more significant concern because it is the *"reference implementation of the Python Wheel packaging standard."*

â

Wheel can also be used as an extension for setuptools (via bdist\_wheel). However, this path doesn't seem to be vulnerable, as there are several parts where [part of the payload string is sanitized](https://github.com/pypa/wheel/blob/5edc61d2c6535c380fa278bc83c578fbd5444167/src/wheel/bdist_wheel.py#L105).

â

**Who is impacted?**

Wheel versions <0.38.0 when parsing a maliciously crafted Wheel file.

â

**Patches**

Wheel 0.38.0 includes the patch. After our disclosure, the maintainers acknowledged the issue, discussed a possible fix, and then applied it in 0.38.0.

â

**Assigned Identifiers:**

**Safety Cybersecurity:** [51499](https://pyup.io/vulnerabilities/CVE-2022-40898/51499/)

**CVE:** CVE-2022-40898

â

### **Mako**

[Mako](https://pypi.org/project/Mako/) is a template library written in Python. It provides a familiar, non-XML syntax that compiles into Python modules for maximum performance. Mako is downloaded more than 20 million times each month.Â

â

#### Vulnerability Details:

The [Regular Expression for matching tags start](https://github.com/sqlalchemy/mako/blob/rel_1_2_1/mako/lexer.py#L275) at the Lexer class for parsing template strings was vulnerable.
â

We found this to be reachable in Mako's code not only by calling the Lexer class but also through babelplugin and linguaplugin, which use process\_file function of MessageExtractor class:

![unnamed.webp](https://cdn.prod.website-files.com/64465cf18ba6212696c9289f/647e559ebdc2e48a7a5dadae_R07rygrVTPyAzvVSoSDY.webp)

â

![unnamed (1).webp](https://cdn.prod.website-files.com/64465cf18ba6212696c9289f/647e559e80fdbe2b2442495f_FHce1IEZS0OOIuUiYbRZ.webp)

*/mako/ext/extract.py*

â

**Patches**

The [issue was fixed](https://github.com/sqlalchemy/mako/commit/925760291d6efec64fda6e9dd1fd9cfbd5be068c), and a new patched version of mako (1.2.2) was released less than 24 hours after we sent the report to Mako's security email.Â

â

**Assigned Identifiers:**

**Safety Cybersecurity:** [50870](https://pyup.io/vulnerabilities/CVE-2022-40023/50870/)

**CVE:** [CVE-2022-40023](https://nvd.nist.gov/vuln/detail/CVE-2022-40023)

â

### **Setuptools**

[Setuptools](https://pypi.org/project/setuptools/) is downloaded more than 203 million times each month.Â

â

#### Vulnerability Details:

The vulnerable Regular Expression is present in package\_index. As a result, a user fetching malicious HTML from a package in PyPI or a custom PackageIndex page may be attacked.

![undefined](https://cdn.prod.website-files.com/64465cf18ba6212696c9289f/647e559e2c2182b0445b4257_sTo8UP6PTomhj5txZ0Y6.webp)

â

It's worth mentioning that only a small portion of the user base is impacted by this flaw. Setuptools maintainers pointed out that package\_index is deprecated (not formally, but âin spiritâ) and the vulnerability isn't reachable through standard, recommended workflows.

â

**Patches & Vendor Response**

Maintainers acknowledged the issue, discussed a possible fix, [and then applied it in 65.5.1](https://github.com/pypa/setuptools/commit/43a9c9bfa6aa626ec2a22540bea28d2ca77964be).

â

**Assigned Identifiers:**

**Safety Cybersecurity:** [52495](https://pyup.io/vulnerabilities/CVE-2022-40897/52495/)

**CVE:** CVE-2022-40897

â

### **Future**

[Future](https://pypi.org/project/future/) allows you to use a single, clean Python 3.x-compatible codebase to support both Python 2 and Python 3 with minimal overhead. Future is downloaded more than 33 million times each month.Â

â

#### Vulnerability Details:

Here, we have a known, not patched vulnerability. LOOSE\_HTTP\_DATE\_RE.match [is called](https://github.com/PythonCharmers/python-future/blob/master/src/future/backports/http/cookiejar.py#L215) when using http.cookiejar.CookieJar to parse Set-Cookie headers returned by a server. Processing a response from a malicious HTTP server can lead to extreme CPU usage, and execution will be blocked for a long time. This issue was already found, patched, and backported in Python core in 2019.
â
You can find more information [here](https://github.com/python/cpython/pull/17157).

â

**Patches & Vendor Response**

The issue was reported to Future maintainers on September 1, 2022, but there was no response. We noted that the project might be inactive because the last commit on the GitHub repository was on November 30, 2021, and the last closed issue was on November 27, 2020. There are now 182 open issues.

â

**Assigned Identifiers:**

**Safety Cybersecurity:** [52510](https://pyup.io/vulnerabilities/CVE-2022-40899/52510/)

**CVE:** CVE-2022-40899

â

Acknowledgements: Special thanks to Sebastian Chnelik, Cybersecurity Analyst at Safety who researched and discovered these vulnerabilities.

â

[All posts](https://safetycli.com/research)

ResearchLinkedIn iconFacebook icon
Telegram icon

Reddit icon

## Reduce vulnerability noise by 90%. âGet a demo today to learn more.

[Get a Demo](/contact-sales)![](https://cdn.prod.website-files.com/643d37c3e503a14690c2decb/643e9b7aa3447750df27aea1_Secure.webp)
## Related Research Posts

![](https://cdn.prod.website-files.com/64465cf18ba6212696c9289f/66ce25732886b2072d578df9_TensorFlow%20Blog%20Header.png)Safety CLI Team Uncovers Unpublished Vulnerability in TensorFlow: CVE-2023-33976
Findings icon

Research
Calendar icon

August 27, 2024[Read more](/research/safety-cli-team-uncovers-unpublished-vulnerability-in-tensorflow-cve-2023-33976)![](https://cdn.prod.website-files.com/64465cf18ba6212696c9289f/6525f67dcd1ec7502074ba75_curl%20vuln%20advisory.png)cURL Vulnerability CVE-2023-38545 for Python Systems
Findings icon

Research
Calendar icon

October 10, 2023[Read more](/research/curl-cve-2023-38545-python)![](https://cdn.prod.website-files.com/64465cf18ba6212696c9289f/651ee0e8b52db1b35c927b63_libwebp.png)Libwebp: Special Vulnerability Advisory (CVE-2023-4863)
Findings icon

Research
Calendar icon

October 2, 2023[Read more](/research/libwebp-vulnerability-advisory-cve-2023-4863)Product[Safety CLI Scanner](/product/safety-cli)[Safety DB](/product/vulnerability-db)[Safety Gateway](/product/safety-gateway)[Safety Platform](/product/safety-platform)Solutions[Enterprise](/solutions/safety-for-enterprise)[AI/ML](/solutions/aiml)[Finance](/solutions/safety-for-finance)[Healthcare](/solutions/safety-for-healthcare)[DevSecOps](/solutions/devsecops)Resources[Contact Sales](/contact-sales)[Plans and Pricing](/resources/plans)[Status](https://status.safetycli.com)[Documentation](https://docs.safetycli.com)[Bug Bounty](/resources/bug-bounty)[About Safety](/resources/about)[Careers](https://apply.workable.com/safety/)[Research](/research)[Vulnerability Research](https://safetycli.com/research?category=Research)[Security Best Practices](https://safetycli.com/research?category=Security)[Blog and Product Updates](https://safetycli.com/research?category=Blog)[Changelogs](https://manage.safetycli.com/changelogs/)Legal[Trust Center](https://trust.safetycli.com/)[Privacy Policy](/legal/privacy-policy)[Terms of Service](/legal/terms-of-service)[Data Processing](/legal/data-processing-agreement)Manage CookiesÂ© 2024 Safety CLI Cybersecurity Inc. AllÂ RightsÂ Reserved.

