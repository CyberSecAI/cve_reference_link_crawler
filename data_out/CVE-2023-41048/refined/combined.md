=== Content from github.com_94d3459b_20250110_222139.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fplone%2FProducts.PloneHotfix20210518)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fplone%2FProducts.PloneHotfix20210518)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=plone%2FProducts.PloneHotfix20210518)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[plone](/plone)
/
**[Products.PloneHotfix20210518](/plone/Products.PloneHotfix20210518)**
Public

* [Notifications](/login?return_to=%2Fplone%2FProducts.PloneHotfix20210518) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2Fplone%2FProducts.PloneHotfix20210518)
* [Star
   0](/login?return_to=%2Fplone%2FProducts.PloneHotfix20210518)

[0
stars](/plone/Products.PloneHotfix20210518/stargazers) [0
forks](/plone/Products.PloneHotfix20210518/forks) [Branches](/plone/Products.PloneHotfix20210518/branches) [Tags](/plone/Products.PloneHotfix20210518/tags) [Activity](/plone/Products.PloneHotfix20210518/activity)
 [Star](/login?return_to=%2Fplone%2FProducts.PloneHotfix20210518)

 [Notifications](/login?return_to=%2Fplone%2FProducts.PloneHotfix20210518) You must be signed in to change notification settings

* [Code](/plone/Products.PloneHotfix20210518)
* [Issues
  0](/plone/Products.PloneHotfix20210518/issues)
* [Pull requests
  0](/plone/Products.PloneHotfix20210518/pulls)
* [Actions](/plone/Products.PloneHotfix20210518/actions)
* [Projects
  0](/plone/Products.PloneHotfix20210518/projects)
* [Security](/plone/Products.PloneHotfix20210518/security)
* [Insights](/plone/Products.PloneHotfix20210518/pulse)

Additional navigation options

* [Code](/plone/Products.PloneHotfix20210518)
* [Issues](/plone/Products.PloneHotfix20210518/issues)
* [Pull requests](/plone/Products.PloneHotfix20210518/pulls)
* [Actions](/plone/Products.PloneHotfix20210518/actions)
* [Projects](/plone/Products.PloneHotfix20210518/projects)
* [Security](/plone/Products.PloneHotfix20210518/security)
* [Insights](/plone/Products.PloneHotfix20210518/pulse)

# plone/Products.PloneHotfix20210518

    main[Branches](/plone/Products.PloneHotfix20210518/branches)[Tags](/plone/Products.PloneHotfix20210518/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[31 Commits](/plone/Products.PloneHotfix20210518/commits/main/) | | |
| [.github/workflows](/plone/Products.PloneHotfix20210518/tree/main/.github/workflows "This path skips through empty directories") | | [.github/workflows](/plone/Products.PloneHotfix20210518/tree/main/.github/workflows "This path skips through empty directories") |  |  |
| [Products](/plone/Products.PloneHotfix20210518/tree/main/Products "Products") | | [Products](/plone/Products.PloneHotfix20210518/tree/main/Products "Products") |  |  |
| [docs](/plone/Products.PloneHotfix20210518/tree/main/docs "docs") | | [docs](/plone/Products.PloneHotfix20210518/tree/main/docs "docs") |  |  |
| [.gitignore](/plone/Products.PloneHotfix20210518/blob/main/.gitignore ".gitignore") | | [.gitignore](/plone/Products.PloneHotfix20210518/blob/main/.gitignore ".gitignore") |  |  |
| [MANIFEST.in](/plone/Products.PloneHotfix20210518/blob/main/MANIFEST.in "MANIFEST.in") | | [MANIFEST.in](/plone/Products.PloneHotfix20210518/blob/main/MANIFEST.in "MANIFEST.in") |  |  |
| [README.rst](/plone/Products.PloneHotfix20210518/blob/main/README.rst "README.rst") | | [README.rst](/plone/Products.PloneHotfix20210518/blob/main/README.rst "README.rst") |  |  |
| [RELEASING.rst](/plone/Products.PloneHotfix20210518/blob/main/RELEASING.rst "RELEASING.rst") | | [RELEASING.rst](/plone/Products.PloneHotfix20210518/blob/main/RELEASING.rst "RELEASING.rst") |  |  |
| [TESTING.rst](/plone/Products.PloneHotfix20210518/blob/main/TESTING.rst "TESTING.rst") | | [TESTING.rst](/plone/Products.PloneHotfix20210518/blob/main/TESTING.rst "TESTING.rst") |  |  |
| [mkdists.py](/plone/Products.PloneHotfix20210518/blob/main/mkdists.py "mkdists.py") | | [mkdists.py](/plone/Products.PloneHotfix20210518/blob/main/mkdists.py "mkdists.py") |  |  |
| [setup.cfg](/plone/Products.PloneHotfix20210518/blob/main/setup.cfg "setup.cfg") | | [setup.cfg](/plone/Products.PloneHotfix20210518/blob/main/setup.cfg "setup.cfg") |  |  |
| [setup.py](/plone/Products.PloneHotfix20210518/blob/main/setup.py "setup.py") | | [setup.py](/plone/Products.PloneHotfix20210518/blob/main/setup.py "setup.py") |  |  |
| [test-4.3.cfg](/plone/Products.PloneHotfix20210518/blob/main/test-4.3.cfg "test-4.3.cfg") | | [test-4.3.cfg](/plone/Products.PloneHotfix20210518/blob/main/test-4.3.cfg "test-4.3.cfg") |  |  |
| [test-4.3pac.cfg](/plone/Products.PloneHotfix20210518/blob/main/test-4.3pac.cfg "test-4.3pac.cfg") | | [test-4.3pac.cfg](/plone/Products.PloneHotfix20210518/blob/main/test-4.3pac.cfg "test-4.3pac.cfg") |  |  |
| [test-4.3pt.cfg](/plone/Products.PloneHotfix20210518/blob/main/test-4.3pt.cfg "test-4.3pt.cfg") | | [test-4.3pt.cfg](/plone/Products.PloneHotfix20210518/blob/main/test-4.3pt.cfg "test-4.3pt.cfg") |  |  |
| [test-5.0.cfg](/plone/Products.PloneHotfix20210518/blob/main/test-5.0.cfg "test-5.0.cfg") | | [test-5.0.cfg](/plone/Products.PloneHotfix20210518/blob/main/test-5.0.cfg "test-5.0.cfg") |  |  |
| [test-5.1.cfg](/plone/Products.PloneHotfix20210518/blob/main/test-5.1.cfg "test-5.1.cfg") | | [test-5.1.cfg](/plone/Products.PloneHotfix20210518/blob/main/test-5.1.cfg "test-5.1.cfg") |  |  |
| [test-5.2.1.cfg](/plone/Products.PloneHotfix20210518/blob/main/test-5.2.1.cfg "test-5.2.1.cfg") | | [test-5.2.1.cfg](/plone/Products.PloneHotfix20210518/blob/main/test-5.2.1.cfg "test-5.2.1.cfg") |  |  |
| [test-5.2.cfg](/plone/Products.PloneHotfix20210518/blob/main/test-5.2.cfg "test-5.2.cfg") | | [test-5.2.cfg](/plone/Products.PloneHotfix20210518/blob/main/test-5.2.cfg "test-5.2.cfg") |  |  |
| [test-hotfix.cfg](/plone/Products.PloneHotfix20210518/blob/main/test-hotfix.cfg "test-hotfix.cfg") | | [test-hotfix.cfg](/plone/Products.PloneHotfix20210518/blob/main/test-hotfix.cfg "test-hotfix.cfg") |  |  |
| [tox.ini](/plone/Products.PloneHotfix20210518/blob/main/tox.ini "tox.ini") | | [tox.ini](/plone/Products.PloneHotfix20210518/blob/main/tox.ini "tox.ini") |  |  |
| View all files | | |

## Repository files navigation

* README
* Code of conduct
* Security
## Plone hotfix, 2021-05-18

This hotfix fixes several security issues:

* Remote Code Execution via traversal in expressions via aliases.
  Reported by David Miller.
* Remote Code Execution via traversal in expressions (no aliases).
  Reported by Calum Hutton.
* Remote Code Execution via traversal in expressions via string formatter.
  Reported by David Miller.
* Writing arbitrary files via docutils and Python Script.
  Reported by Calum Hutton.
* Stored XSS from file upload (svg, html).
  Reported separately by Emir Cüneyt Akkutlu and Tino Kautschke.
* XSS vulnerability in CMFDiffTool.
  Reported by Igor Margitich.
* Reflected XSS in various spots.
  Reported by Calum Hutton.
* Various information disclosures: GS, QI, all\_users.
  Reported by Calum Hutton.
* Stored XSS from user fullname.
  Reported by Tino Kautschke.
* Blind SSRF via feedparser accessing an internal URL.
  Reported by Subodh Kumar Shree.
* Server Side Request Forgery via event ical URL.
  Reported by MisakiKata and David Miller.
* Server Side Request Forgery via lxml parser.
  Reported by MisakiKata and David Miller.
* XSS in folder contents on Plone 5.0 and higher.
  Reported by Matt Moreschi.
  Only included since version 1.5 of the hotfix.
* Remote Code Execution via Python Script.
  Reported by Calum Hutton.
  Only Plone 5.2 on Python 3 is vulnerable.
  Only included since version 1.6 of the hotfix.

## Compatibility

This hotfix should be applied to the following versions of Plone:

* Plone 5.2.4 and any earlier 5.2.x version
* Plone 5.1.7 and any earlier 5.1x version
* Plone 5.0.10 and any earlier 5.0.x version
* Plone 4.3.20 and any earlier 4.x version

The hotfix is officially supported by the Plone security team on the
following versions of Plone in accordance with the Plone
[version support policy](https://plone.org/security/update-policy): 4.3.20, 5.0.10, 5.1.7 and 5.2.4.

On Plone 4.3, 5.0 and 5.1 the hotfix is officially only supported on Python 2.7.
On Plone 5.2.X it is supported on Python 2.7 and Python 3.6/3.7/3.8.

The fixes included here will be incorporated into subsequent releases of Plone,
so Plone 5.2.5 and greater should not require this hotfix.

## Zope

Zope is also affected.
New versions for Zope and other packages are available.
Upgrading to those is the recommended way.

If you cannot upgrade yet, you can try the Plone hotfix.
It has not been tested on Zope only, but we try not to let the Plone-specific code get in the way, so it should be okay.

These vulnerabilities mentioned above are relevant for Zope:

* Remote Code Execution via traversal in expressions via aliases.
  Fixes released in Zope 4.6 and 5.2.
* Remote Code Execution via traversal in expressions (no aliases).
  Fixes released in Zope 4.6.1 and 5.2.1.
* Various information disclosures.
  Fixes released in Products.PluggableAuthService 2.6.0, Products.GenericSetup 2.1.1, and Zope 4.5.5.
* Reflected XSS in various spots.
  Fixes released in Products.CMFCore 2.5.1 and Products.PluggableAuthService 2.6.2.
* Remote Code Execution via traversal in expressions via string formatter.
  Fixes released in Zope 4.6.2, which takes over the already stricter code from Zope 5.2.1.
* Remote Code Execution via Python Script.
  Fixes released in Zope 4.6.3 and 5.3.

## Installation

Installation instructions can be found at
<https://plone.org/security/hotfix/20210518>

Note

You may get an error when running buildout:

```
Error: Couldn't find a distribution for 'Products.PloneHotfix20210518==1.0'.

```

The most likely cause is that you use a too old Python or too old setuptools without "SNI" support.
See this [community.plone.org post](https://community.plone.org/t/pypi-deprecation-of-support-for-non-sni-clients-breaks-buildout-for-older-plone-versions/13803).

Another cause could be that your buildout is trying to download the hotfix via http or from an older PyPI index.
In the buildout section of your buildout, make sure you use the correct index:

```
[buildout]
index = https://pypi.org/simple/

```

## Q&A

Q: How can I confirm that the hotfix is installed correctly and my site is protected?

A: On startup, the hotfix will log a number of messages to the Zope event log
that look like this:

```
2021-05-18 14:07:24,176 INFO    [Products.PloneHotfix20210518:43][MainThread] Applied expressions patch
2021-05-18 14:07:24,179 INFO    [Products.PloneHotfix20210518:43][MainThread] Applied genericsetup patch
2021-05-18 14:07:24,181 INFO    [Products.PloneHotfix20210518:43][MainThread] Applied pas patch
2021-05-18 14:07:24,182 INFO    [Products.PloneHotfix20210518:43][MainThread] Applied propertymanager patch
2021-05-18 14:07:24,183 INFO    [Products.PloneHotfix20210518:43][MainThread] Applied skinnable patch
2021-05-18 14:07:24,187 INFO    [Products.PloneHotfix20210518:43][MainThread] Applied xmlrpc_dump_instance patch
2021-05-18 14:07:24,188 INFO    [Products.PloneHotfix20210518:43][MainThread] Applied difftool patch
2021-05-18 14:07:24,238 INFO    [Products.PloneHotfix20210518:43][MainThread] Applied event patch
2021-05-18 14:07:24,244 INFO    [Products.PloneHotfix20210518:43][MainThread] Applied modeleditor patch
2021-05-18 14:07:24,246 INFO    [Products.PloneHotfix20210518:43][MainThread] Applied namedfile patch
2021-05-18 14:07:24,283 INFO    [Products.PloneHotfix20210518:43][MainThread] Applied pa_users patch
2021-05-18 14:07:24,367 INFO    [Products.PloneHotfix20210518:43][MainThread] Applied portlets patch
2021-05-18 14:07:24,369 INFO    [Products.PloneHotfix20210518:43][MainThread] Applied publishing patch
2021-05-18 14:07:24,371 INFO    [Products.PloneHotfix20210518:43][MainThread] Applied qi patch
2021-05-18 14:07:24,372 INFO    [Products.PloneHotfix20210518:43][MainThread] Applied supermodel patch
2021-05-18 14:07:24,500 INFO    [Products.PloneHotfix20210518:43][MainThread] Applied theming patch
2021-05-18 14:07:24,634 INFO    [Products.PloneHotfix20210518:43][MainThread] Applied transforms patch
2021-05-18 14:07:24,634 INFO    [Products.PloneHotfix20210518:51][MainThread] Hotfix installed

```

The exact number of patches applied, will differ depending on what packages you are using.
If a patch is attempted but fails, it will be logged as an error that says
"Could not apply". This may indicate that you have a non-standard Plone
installation. Please investigate, and mail us the accompanying traceback if you think it is a problem in the hotfix.

Q: How can I report problems installing the patch?
A: Contact the Plone security team at security@plone.org or visit the
Gitter channel at <https://gitter.im/plone/public> and the forum at <https://community.plone.org>
Q: How can I report other potential security vulnerabilities?
A: Please email the security team at security@plone.org rather than discussing
potential security issues publicly.

## About

No description, website, or topics provided.
### Resources

[Readme](#readme-ov-file)
### Code of conduct

[Code of conduct](#coc-ov-file)
### Security policy

[Security policy](#security-ov-file)

[Activity](/plone/Products.PloneHotfix20210518/activity)
[Custom properties](/plone/Products.PloneHotfix20210518/custom-properties)
### Stars

[**0**
stars](/plone/Products.PloneHotfix20210518/stargazers)
### Watchers

[**216**
watching](/plone/Products.PloneHotfix20210518/watchers)
### Forks

[**0**
forks](/plone/Products.PloneHotfix20210518/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fplone%2FProducts.PloneHotfix20210518&report=plone+%28user%29)

## [Releases](/plone/Products.PloneHotfix20210518/releases)

[1
tags](/plone/Products.PloneHotfix20210518/tags)

## Sponsor this project

 Sponsor

[Learn more about GitHub Sponsors](/sponsors)

## [Packages 0](/orgs/plone/packages?repo_name=Products.PloneHotfix20210518)

No packages published

## Languages

* [Python
  100.0%](/plone/Products.PloneHotfix20210518/search?l=python)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_3a38fe04_20250110_222142.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fplone%2Fplone.namedfile%2Fcommit%2Ff0f911f2a72b2e5c923dc2ab9179319cc47788f9)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fplone%2Fplone.namedfile%2Fcommit%2Ff0f911f2a72b2e5c923dc2ab9179319cc47788f9)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=plone%2Fplone.namedfile)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[plone](/plone)
/
**[plone.namedfile](/plone/plone.namedfile)**
Public

* [Notifications](/login?return_to=%2Fplone%2Fplone.namedfile) You must be signed in to change notification settings
* [Fork
  20](/login?return_to=%2Fplone%2Fplone.namedfile)
* [Star
   9](/login?return_to=%2Fplone%2Fplone.namedfile)

* [Code](/plone/plone.namedfile)
* [Issues
  12](/plone/plone.namedfile/issues)
* [Pull requests
  3](/plone/plone.namedfile/pulls)
* [Actions](/plone/plone.namedfile/actions)
* [Security](/plone/plone.namedfile/security)
* [Insights](/plone/plone.namedfile/pulse)

Additional navigation options

* [Code](/plone/plone.namedfile)
* [Issues](/plone/plone.namedfile/issues)
* [Pull requests](/plone/plone.namedfile/pulls)
* [Actions](/plone/plone.namedfile/actions)
* [Security](/plone/plone.namedfile/security)
* [Insights](/plone/plone.namedfile/pulse)

## Commit

[Permalink](/plone/plone.namedfile/commit/f0f911f2a72b2e5c923dc2ab9179319cc47788f9)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-jj7c-jrv4-c65x](https://github.com/advisories/GHSA-jj7c-jrv4-c65x "GHSA-jj7c-jrv4-c65x")

[Browse files](/plone/plone.namedfile/tree/f0f911f2a72b2e5c923dc2ab9179319cc47788f9)
Browse the repository at this point in the history

```
Force download of image scales when inline is not allowed for mime type [master]
```

* Loading branch information

[![@mauritsvanrees](https://avatars.githubusercontent.com/u/210587?s=40&v=4)](/mauritsvanrees)

[mauritsvanrees](/plone/plone.namedfile/commits?author=mauritsvanrees "View all commits by mauritsvanrees")
authored
Sep 21, 2023

2 parents
[628805e](/plone/plone.namedfile/commit/628805e3b1dad01b731721555f7bb819a7ea1531)
+
[07a890a](/plone/plone.namedfile/commit/07a890a857ff14c6077fa5eabab42bdf99061162)

commit f0f911f

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**105 additions**
and
**4 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* news

  + news/1.bugfix
    [1.bugfix](#diff-6e4c37fa5287b47d17a52e3e9df34fa89ca3c94fd92a04164b8d6361d2249f21)
* plone/namedfile

  + plone/namedfile/scaling.py
    [scaling.py](#diff-a8114d50cd1310a7f79d303f8d55e166e917aa77fc5a9579cf13d0d4bbf2ec66)
  + tests

    - plone/namedfile/tests/test\_display\_file.py
      [test\_display\_file.py](#diff-8980da4d64e2bd93868e87c0971cce33a75db71eb23d75ecf6f501bdf391510f)

## There are no files selected for viewing

4 changes: 4 additions & 0 deletions

4
[news/1.bugfix](#diff-6e4c37fa5287b47d17a52e3e9df34fa89ca3c94fd92a04164b8d6361d2249f21 "news/1.bugfix")

Show comments

[View file](/plone/plone.namedfile/blob/f0f911f2a72b2e5c923dc2ab9179319cc47788f9/news/1.bugfix)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,4 @@ |
|  |  | Fix stored XSS (Cross Site Scripting) for SVG images. |
|  |  | Done by forcing a download instead of displaying inline. |
|  |  | See `security advisory <https://github.com/plone/plone.namedfile/security/advisories/GHSA-jj7c-jrv4-c65x>`\_. |
|  |  | [maurits] |

42 changes: 40 additions & 2 deletions

42
[plone/namedfile/scaling.py](#diff-a8114d50cd1310a7f79d303f8d55e166e917aa77fc5a9579cf13d0d4bbf2ec66 "plone/namedfile/scaling.py")

Show comments

[View file](/plone/plone.namedfile/blob/f0f911f2a72b2e5c923dc2ab9179319cc47788f9/plone/namedfile/scaling.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -4,6 +4,9 @@ |
|  |  | from io import BytesIO |
|  |  | from plone.memoize import ram |
|  |  | from plone.namedfile.file import FILECHUNK\_CLASSES |
|  |  | from plone.namedfile.browser import ALLOWED\_INLINE\_MIMETYPES |
|  |  | from plone.namedfile.browser import DISALLOWED\_INLINE\_MIMETYPES |
|  |  | from plone.namedfile.browser import USE\_DENYLIST |
|  |  | from plone.namedfile.interfaces import IAvailableSizes |
|  |  | from plone.namedfile.interfaces import IStableImageScale |
|  |  | from plone.namedfile.picture import get\_picture\_variants |
| Expand Down  Expand Up | | @@ -75,6 +78,14 @@ class ImageScale(BrowserView): |
|  |  | \_\_allow\_access\_to\_unprotected\_subobjects\_\_ = 1 |
|  |  | data = None |
|  |  |  |
|  |  | # You can control which mimetypes may be shown inline |
|  |  | # and which must always be downloaded, for security reasons. |
|  |  | # Make the configuration available on the class. |
|  |  | # Then subclasses can override this. |
|  |  | allowed\_inline\_mimetypes = ALLOWED\_INLINE\_MIMETYPES |
|  |  | disallowed\_inline\_mimetypes = DISALLOWED\_INLINE\_MIMETYPES |
|  |  | use\_denylist = USE\_DENYLIST |
|  |  |  |
|  |  | def \_\_init\_\_(self, context, request, \*\*info): |
|  |  | self.context = context |
|  |  | self.request = request |
| Expand Down  Expand Up | | @@ -167,10 +178,37 @@ def validate\_access(self): |
|  |  | fieldname = getattr(self.data, "fieldname", getattr(self, "fieldname", None)) |
|  |  | guarded\_getattr(self.context, fieldname) |
|  |  |  |
|  |  | def \_should\_force\_download(self): |
|  |  | # If this returns True, the caller should call set\_headers with a filename. |
|  |  | if not hasattr(self.data, "contentType"): |
|  |  | return |
|  |  | mimetype = self.data.contentType |
|  |  | if self.use\_denylist: |
|  |  | # We explicitly deny a few mimetypes, and allow the rest. |
|  |  | return mimetype in self.disallowed\_inline\_mimetypes |
|  |  | # Use the allowlist. |
|  |  | # We only explicitly allow a few mimetypes, and deny the rest. |
|  |  | return mimetype not in self.allowed\_inline\_mimetypes |
|  |  |  |
|  |  | def set\_headers(self, response=None): |
|  |  | # set headers for the image |
|  |  | image = self.data |
|  |  | if response is None: |
|  |  | response = self.request.response |
|  |  | filename = None |
|  |  | if self.\_should\_force\_download(): |
|  |  | # We MUST pass a filename, even a dummy one if needed. |
|  |  | filename = getattr(image, "filename", getattr(self, "filename", None)) |
|  |  | if filename is None: |
|  |  | filename = getattr(image, "fieldname", getattr(self, "fieldname", None)) |
|  |  | if filename is None: |
|  |  | filename = "image.ext" |
|  |  | set\_headers(image, response, filename=filename) |
|  |  |  |
|  |  | def index\_html(self): |
|  |  | """download the image""" |
|  |  | self.validate\_access() |
|  |  | set\_headers(self.data, self.request.response) |
|  |  | self.set\_headers() |
|  |  | return stream\_data(self.data) |
|  |  |  |
|  |  | def manage\_DAVget(self): |
| Expand All | | @@ -190,7 +228,7 @@ def HEAD(self, REQUEST, RESPONSE=None): |
|  |  | without transfer of the image itself |
|  |  | """ |
|  |  | self.validate\_access() |
|  |  | set\_headers(self.data, REQUEST.response) |
|  |  | self.set\_headers(response=REQUEST.response) |
|  |  | return "" |
|  |  |  |
|  |  | HEAD.\_\_roles\_\_ = ("Anonymous",) |
| Expand Down | |  |

63 changes: 61 additions & 2 deletions

63
[plone/namedfile/tests/test\_display\_file.py](#diff-8980da4d64e2bd93868e87c0971cce33a75db71eb23d75ecf6f501bdf391510f "plone/namedfile/tests/test_display_file.py")

Show comments

[View file](/plone/plone.namedfile/blob/f0f911f2a72b2e5c923dc2ab9179319cc47788f9/plone/namedfile/tests/test_display_file.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -3,12 +3,15 @@ |
|  |  | from plone.app.testing import SITE\_OWNER\_PASSWORD |
|  |  | from plone.namedfile import field |
|  |  | from plone.namedfile import file |
|  |  | from plone.namedfile.interfaces import IAvailableSizes |
|  |  | from plone.namedfile.interfaces import IImageScaleTraversable |
|  |  | from plone.namedfile.testing import PLONE\_NAMEDFILE\_FUNCTIONAL\_TESTING |
|  |  | from plone.namedfile.tests import getFile |
|  |  | from plone.testing.zope import Browser |
|  |  | from Products.CMFPlone.utils import safe\_unicode |
|  |  | from zope.annotation import IAnnotations |
|  |  | from zope.annotation import IAttributeAnnotatable |
|  |  | from zope.component import getSiteManager |
|  |  | from zope.interface import implementer |
|  |  |  |
|  |  | import transaction |
| Expand Down  Expand Up | | @@ -46,6 +49,11 @@ def get\_disposition\_header(browser): |
|  |  | return browser.headers.get(name, None) |
|  |  |  |
|  |  |  |
|  |  | def custom\_available\_sizes(): |
|  |  | # Define available image scales. |
|  |  | return {"custom": (10, 10)} |
|  |  |  |
|  |  |  |
|  |  | class TestAttackVectorNamedImage(unittest.TestCase): |
|  |  | layer = PLONE\_NAMEDFILE\_FUNCTIONAL\_TESTING |
|  |  | field\_class = file.NamedImage |
| Expand All | | @@ -56,6 +64,12 @@ def setUp(self): |
|  |  | item = DummyContent() |
|  |  | self.layer["app"].\_setOb("item", item) |
|  |  | self.item = self.layer["app"].item |
|  |  | sm = getSiteManager() |
|  |  | sm.registerUtility(component=custom\_available\_sizes, provided=IAvailableSizes) |
|  |  |  |
|  |  | def tearDown(self): |
|  |  | sm = getSiteManager() |
|  |  | sm.unregisterUtility(provided=IAvailableSizes) |
|  |  |  |
|  |  | def get\_admin\_browser(self): |
|  |  | browser = Browser(self.layer["app"]) |
| Expand Down  Expand Up | | @@ -98,30 +112,73 @@ def assert\_display\_inline\_is\_download(self, base\_url): |
|  |  | self.assertIn("attachment", header) |
|  |  | self.assertIn("filename", header) |
|  |  |  |
|  |  | def assert\_scale\_view\_works(self, base\_url): |
|  |  | # Test that accessing a scale view shows the image inline. |
|  |  | browser = self.get\_anon\_browser() |
|  |  | browser.open(base\_url + "/@@images/{}".format(self.field\_name)) |
|  |  | self.assertIsNone(get\_disposition\_header(browser)) |
|  |  |  |
|  |  | # Note: the 'custom' scale is defined in an adapter above. |
|  |  | browser.open(base\_url + "/@@images/{}/custom".format(self.field\_name)) |
|  |  | self.assertIsNone(get\_disposition\_header(browser)) |
|  |  |  |
|  |  | unique\_scale\_id = list(IAnnotations(self.item)["plone.scale"].keys())[0] |
|  |  | browser.open(base\_url + "/@@images/{}".format(unique\_scale\_id)) |
|  |  | self.assertIsNone(get\_disposition\_header(browser)) |
|  |  |  |
|  |  | def assert\_scale\_view\_is\_download(self, base\_url): |
|  |  | # Test that accessing a scale view turns into a download. |
|  |  | browser = self.get\_anon\_browser() |
|  |  | browser.open(base\_url + "/@@images/{}".format(self.field\_name)) |
|  |  | header = get\_disposition\_header(browser) |
|  |  | self.assertIsNotNone(header) |
|  |  | self.assertIn("attachment", header) |
|  |  | self.assertIn("filename", header) |
|  |  |  |
|  |  | browser.open(base\_url + "/@@images/{}/custom".format(self.field\_name)) |
|  |  | header = get\_disposition\_header(browser) |
|  |  | self.assertIsNotNone(header) |
|  |  | self.assertIn("attachment", header) |
|  |  | self.assertIn("filename", header) |
|  |  |  |
|  |  | unique\_scale\_id = list(IAnnotations(self.item)["plone.scale"].keys())[0] |
|  |  | browser.open(base\_url + "/@@images/{}".format(unique\_scale\_id)) |
|  |  | header = get\_disposition\_header(browser) |
|  |  | self.assertIsNotNone(header) |
|  |  | self.assertIn("attachment", header) |
|  |  | self.assertIn("filename", header) |
|  |  |  |
|  |  | def test\_png\_image(self): |
|  |  | setattr(self.item, self.field\_name, self.\_named\_file("image.png")) |
|  |  | transaction.commit() |
|  |  | base\_url = self.item.absolute\_url() |
|  |  | self.assert\_download\_works(base\_url) |
|  |  | self.assert\_display\_inline\_works(base\_url) |
|  |  | if self.field\_name == "image": |
|  |  | self.assert\_scale\_view\_works(base\_url) |
|  |  |  |
|  |  | def test\_svg\_image(self): |
|  |  | setattr(self.item, self.field\_name, self.\_named\_file("image.svg")) |
|  |  | transaction.commit() |
|  |  | base\_url = self.item.absolute\_url() |
|  |  | self.assert\_download\_works(base\_url) |
|  |  | self.assert\_display\_inline\_is\_download(base\_url) |
|  |  | if self.field\_name == "image": |
|  |  | self.assert\_scale\_view\_is\_download(base\_url) |
|  |  |  |
|  |  | def test\_filename\_none(self): |
|  |  | # A 'None' filename None probably does not happen during normal upload, |
|  |  | # but if an attacker manages this, even @@download will show inline. |
|  |  | # A 'None' filename probably does not happen during normal upload, |
|  |  | # but if an attacker manages this, even @@download would show inline. |
|  |  | # We prevent this. |
|  |  | data = self.\_named\_file("image.svg") |
|  |  | data.filename = None |
|  |  | setattr(self.item, self.field\_name, data) |
|  |  | transaction.commit() |
|  |  | base\_url = self.item.absolute\_url() |
|  |  | self.assert\_download\_works(base\_url) |
|  |  | self.assert\_display\_inline\_is\_download(base\_url) |
|  |  | if self.field\_name == "image": |
|  |  | self.assert\_scale\_view\_is\_download(base\_url) |
|  |  |  |
|  |  | def test\_filename\_empty(self): |
|  |  | # An empty filename is probably no problem, but let's check. |
| Expand All | | @@ -132,6 +189,8 @@ def test\_filename\_empty(self): |
|  |  | base\_url = self.item.absolute\_url() |
|  |  | self.assert\_download\_works(base\_url) |
|  |  | self.assert\_display\_inline\_is\_download(base\_url) |
|  |  | if self.field\_name == "image": |
|  |  | self.assert\_scale\_view\_is\_download(base\_url) |
|  |  |  |
|  |  |  |
|  |  | class TestAttackVectorNamedBlobImage(TestAttackVectorNamedImage): |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `f0f911f`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fplone%2Fplone.namedfile%2Fcommit%2Ff0f911f2a72b2e5c923dc2ab9179319cc47788f9) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_0aeb26b6_20250110_222143.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fplone%2Fplone.namedfile%2Fcommit%2Fff5269fb4c79f4eb91dd934561b8824a49a03b60)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fplone%2Fplone.namedfile%2Fcommit%2Fff5269fb4c79f4eb91dd934561b8824a49a03b60)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=plone%2Fplone.namedfile)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[plone](/plone)
/
**[plone.namedfile](/plone/plone.namedfile)**
Public

* [Notifications](/login?return_to=%2Fplone%2Fplone.namedfile) You must be signed in to change notification settings
* [Fork
  20](/login?return_to=%2Fplone%2Fplone.namedfile)
* [Star
   9](/login?return_to=%2Fplone%2Fplone.namedfile)

* [Code](/plone/plone.namedfile)
* [Issues
  12](/plone/plone.namedfile/issues)
* [Pull requests
  3](/plone/plone.namedfile/pulls)
* [Actions](/plone/plone.namedfile/actions)
* [Security](/plone/plone.namedfile/security)
* [Insights](/plone/plone.namedfile/pulse)

Additional navigation options

* [Code](/plone/plone.namedfile)
* [Issues](/plone/plone.namedfile/issues)
* [Pull requests](/plone/plone.namedfile/pulls)
* [Actions](/plone/plone.namedfile/actions)
* [Security](/plone/plone.namedfile/security)
* [Insights](/plone/plone.namedfile/pulse)

## Commit

[Permalink](/plone/plone.namedfile/commit/ff5269fb4c79f4eb91dd934561b8824a49a03b60)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-jj7c-jrv4-c65x](https://github.com/advisories/GHSA-jj7c-jrv4-c65x "GHSA-jj7c-jrv4-c65x")

[Browse files](/plone/plone.namedfile/tree/ff5269fb4c79f4eb91dd934561b8824a49a03b60)
Browse the repository at this point in the history

```
Force download of image scales when inline is not allowed for mime type [5.x]
```

* Loading branch information

[![@mauritsvanrees](https://avatars.githubusercontent.com/u/210587?s=40&v=4)](/mauritsvanrees)

[mauritsvanrees](/plone/plone.namedfile/commits?author=mauritsvanrees "View all commits by mauritsvanrees")
authored
Sep 21, 2023

2 parents
[4358160](/plone/plone.namedfile/commit/435816001d6b7b7e5a805e116571833e2db017f8)
+
[776cb9b](/plone/plone.namedfile/commit/776cb9b54241adff1fccd940c3d6abed35ca83e4)

commit ff5269f

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**105 additions**
and
**4 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* news

  + news/1.bugfix
    [1.bugfix](#diff-6e4c37fa5287b47d17a52e3e9df34fa89ca3c94fd92a04164b8d6361d2249f21)
* plone/namedfile

  + plone/namedfile/scaling.py
    [scaling.py](#diff-a8114d50cd1310a7f79d303f8d55e166e917aa77fc5a9579cf13d0d4bbf2ec66)
  + tests

    - plone/namedfile/tests/test\_display\_file.py
      [test\_display\_file.py](#diff-8980da4d64e2bd93868e87c0971cce33a75db71eb23d75ecf6f501bdf391510f)

## There are no files selected for viewing

4 changes: 4 additions & 0 deletions

4
[news/1.bugfix](#diff-6e4c37fa5287b47d17a52e3e9df34fa89ca3c94fd92a04164b8d6361d2249f21 "news/1.bugfix")

Show comments

[View file](/plone/plone.namedfile/blob/ff5269fb4c79f4eb91dd934561b8824a49a03b60/news/1.bugfix)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,4 @@ |
|  |  | Fix stored XSS (Cross Site Scripting) for SVG images. |
|  |  | Done by forcing a download instead of displaying inline. |
|  |  | See `security advisory <https://github.com/plone/plone.namedfile/security/advisories/GHSA-jj7c-jrv4-c65x>`\_. |
|  |  | [maurits] |

42 changes: 40 additions & 2 deletions

42
[plone/namedfile/scaling.py](#diff-a8114d50cd1310a7f79d303f8d55e166e917aa77fc5a9579cf13d0d4bbf2ec66 "plone/namedfile/scaling.py")

Show comments

[View file](/plone/plone.namedfile/blob/ff5269fb4c79f4eb91dd934561b8824a49a03b60/plone/namedfile/scaling.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -5,6 +5,9 @@ |
|  |  | from io import BytesIO |
|  |  | from plone.memoize import ram |
|  |  | from plone.namedfile.file import FILECHUNK\_CLASSES |
|  |  | from plone.namedfile.browser import ALLOWED\_INLINE\_MIMETYPES |
|  |  | from plone.namedfile.browser import DISALLOWED\_INLINE\_MIMETYPES |
|  |  | from plone.namedfile.browser import USE\_DENYLIST |
|  |  | from plone.namedfile.interfaces import IAvailableSizes |
|  |  | from plone.namedfile.interfaces import IStableImageScale |
|  |  | from plone.namedfile.utils import getHighPixelDensityScales |
| Expand Down  Expand Up | | @@ -51,6 +54,14 @@ class ImageScale(BrowserView): |
|  |  | \_\_allow\_access\_to\_unprotected\_subobjects\_\_ = 1 |
|  |  | data = None |
|  |  |  |
|  |  | # You can control which mimetypes may be shown inline |
|  |  | # and which must always be downloaded, for security reasons. |
|  |  | # Make the configuration available on the class. |
|  |  | # Then subclasses can override this. |
|  |  | allowed\_inline\_mimetypes = ALLOWED\_INLINE\_MIMETYPES |
|  |  | disallowed\_inline\_mimetypes = DISALLOWED\_INLINE\_MIMETYPES |
|  |  | use\_denylist = USE\_DENYLIST |
|  |  |  |
|  |  | def \_\_init\_\_(self, context, request, \*\*info): |
|  |  | self.context = context |
|  |  | self.request = request |
| Expand Down  Expand Up | | @@ -138,10 +149,37 @@ def validate\_access(self): |
|  |  | fieldname = getattr(self.data, "fieldname", getattr(self, "fieldname", None)) |
|  |  | guarded\_getattr(self.context, fieldname) |
|  |  |  |
|  |  | def \_should\_force\_download(self): |
|  |  | # If this returns True, the caller should call set\_headers with a filename. |
|  |  | if not hasattr(self.data, "contentType"): |
|  |  | return |
|  |  | mimetype = self.data.contentType |
|  |  | if self.use\_denylist: |
|  |  | # We explicitly deny a few mimetypes, and allow the rest. |
|  |  | return mimetype in self.disallowed\_inline\_mimetypes |
|  |  | # Use the allowlist. |
|  |  | # We only explicitly allow a few mimetypes, and deny the rest. |
|  |  | return mimetype not in self.allowed\_inline\_mimetypes |
|  |  |  |
|  |  | def set\_headers(self, response=None): |
|  |  | # set headers for the image |
|  |  | image = self.data |
|  |  | if response is None: |
|  |  | response = self.request.response |
|  |  | filename = None |
|  |  | if self.\_should\_force\_download(): |
|  |  | # We MUST pass a filename, even a dummy one if needed. |
|  |  | filename = getattr(image, "filename", getattr(self, "filename", None)) |
|  |  | if filename is None: |
|  |  | filename = getattr(image, "fieldname", getattr(self, "fieldname", None)) |
|  |  | if filename is None: |
|  |  | filename = "image.ext" |
|  |  | set\_headers(image, response, filename=filename) |
|  |  |  |
|  |  | def index\_html(self): |
|  |  | """ download the image """ |
|  |  | self.validate\_access() |
|  |  | set\_headers(self.data, self.request.response) |
|  |  | self.set\_headers() |
|  |  | return stream\_data(self.data) |
|  |  |  |
|  |  | def manage\_DAVget(self): |
| Expand All | | @@ -161,7 +199,7 @@ def HEAD(self, REQUEST, RESPONSE=None): |
|  |  | without transfer of the image itself |
|  |  | """ |
|  |  | self.validate\_access() |
|  |  | set\_headers(self.data, REQUEST.response) |
|  |  | self.set\_headers(response=REQUEST.response) |
|  |  | return "" |
|  |  |  |
|  |  | HEAD.\_\_roles\_\_ = ("Anonymous",) |
| Expand Down | |  |

63 changes: 61 additions & 2 deletions

63
[plone/namedfile/tests/test\_display\_file.py](#diff-8980da4d64e2bd93868e87c0971cce33a75db71eb23d75ecf6f501bdf391510f "plone/namedfile/tests/test_display_file.py")

Show comments

[View file](/plone/plone.namedfile/blob/ff5269fb4c79f4eb91dd934561b8824a49a03b60/plone/namedfile/tests/test_display_file.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -4,12 +4,15 @@ |
|  |  | from plone.app.testing import SITE\_OWNER\_PASSWORD |
|  |  | from plone.namedfile import field |
|  |  | from plone.namedfile import file |
|  |  | from plone.namedfile.interfaces import IAvailableSizes |
|  |  | from plone.namedfile.interfaces import IImageScaleTraversable |
|  |  | from plone.namedfile.testing import PLONE\_NAMEDFILE\_FUNCTIONAL\_TESTING |
|  |  | from plone.namedfile.tests import getFile |
|  |  | from plone.testing.zope import Browser |
|  |  | from Products.CMFPlone.utils import safe\_unicode |
|  |  | from zope.annotation import IAnnotations |
|  |  | from zope.annotation import IAttributeAnnotatable |
|  |  | from zope.component import getSiteManager |
|  |  | from zope.interface import implementer |
|  |  |  |
|  |  | import os |
| Expand Down  Expand Up | | @@ -48,6 +51,11 @@ def get\_disposition\_header(browser): |
|  |  | return browser.headers.get(name, None) |
|  |  |  |
|  |  |  |
|  |  | def custom\_available\_sizes(): |
|  |  | # Define available image scales. |
|  |  | return {"custom": (10, 10)} |
|  |  |  |
|  |  |  |
|  |  | class TestAttackVectorNamedImage(unittest.TestCase): |
|  |  | layer = PLONE\_NAMEDFILE\_FUNCTIONAL\_TESTING |
|  |  | field\_class = file.NamedImage |
| Expand All | | @@ -58,6 +66,12 @@ def setUp(self): |
|  |  | item = DummyContent() |
|  |  | self.layer["app"].\_setOb("item", item) |
|  |  | self.item = self.layer["app"].item |
|  |  | sm = getSiteManager() |
|  |  | sm.registerUtility(component=custom\_available\_sizes, provided=IAvailableSizes) |
|  |  |  |
|  |  | def tearDown(self): |
|  |  | sm = getSiteManager() |
|  |  | sm.unregisterUtility(provided=IAvailableSizes) |
|  |  |  |
|  |  | def get\_admin\_browser(self): |
|  |  | browser = Browser(self.layer["app"]) |
| Expand Down  Expand Up | | @@ -100,30 +114,73 @@ def assert\_display\_inline\_is\_download(self, base\_url): |
|  |  | self.assertIn("attachment", header) |
|  |  | self.assertIn("filename", header) |
|  |  |  |
|  |  | def assert\_scale\_view\_works(self, base\_url): |
|  |  | # Test that accessing a scale view shows the image inline. |
|  |  | browser = self.get\_anon\_browser() |
|  |  | browser.open(base\_url + "/@@images/{}".format(self.field\_name)) |
|  |  | self.assertIsNone(get\_disposition\_header(browser)) |
|  |  |  |
|  |  | # Note: the 'custom' scale is defined in an adapter above. |
|  |  | browser.open(base\_url + "/@@images/{}/custom".format(self.field\_name)) |
|  |  | self.assertIsNone(get\_disposition\_header(browser)) |
|  |  |  |
|  |  | unique\_scale\_id = list(IAnnotations(self.item)["plone.scale"].keys())[0] |
|  |  | browser.open(base\_url + "/@@images/{}".format(unique\_scale\_id)) |
|  |  | self.assertIsNone(get\_disposition\_header(browser)) |
|  |  |  |
|  |  | def assert\_scale\_view\_is\_download(self, base\_url): |
|  |  | # Test that accessing a scale view turns into a download. |
|  |  | browser = self.get\_anon\_browser() |
|  |  | browser.open(base\_url + "/@@images/{}".format(self.field\_name)) |
|  |  | header = get\_disposition\_header(browser) |
|  |  | self.assertIsNotNone(header) |
|  |  | self.assertIn("attachment", header) |
|  |  | self.assertIn("filename", header) |
|  |  |  |
|  |  | browser.open(base\_url + "/@@images/{}/custom".format(self.field\_name)) |
|  |  | header = get\_disposition\_header(browser) |
|  |  | self.assertIsNotNone(header) |
|  |  | self.assertIn("attachment", header) |
|  |  | self.assertIn("filename", header) |
|  |  |  |
|  |  | unique\_scale\_id = list(IAnnotations(self.item)["plone.scale"].keys())[0] |
|  |  | browser.open(base\_url + "/@@images/{}".format(unique\_scale\_id)) |
|  |  | header = get\_disposition\_header(browser) |
|  |  | self.assertIsNotNone(header) |
|  |  | self.assertIn("attachment", header) |
|  |  | self.assertIn("filename", header) |
|  |  |  |
|  |  | def test\_png\_image(self): |
|  |  | setattr(self.item, self.field\_name, self.\_named\_file("image.png")) |
|  |  | transaction.commit() |
|  |  | base\_url = self.item.absolute\_url() |
|  |  | self.assert\_download\_works(base\_url) |
|  |  | self.assert\_display\_inline\_works(base\_url) |
|  |  | if self.field\_name == "image": |
|  |  | self.assert\_scale\_view\_works(base\_url) |
|  |  |  |
|  |  | def test\_svg\_image(self): |
|  |  | setattr(self.item, self.field\_name, self.\_named\_file("image.svg")) |
|  |  | transaction.commit() |
|  |  | base\_url = self.item.absolute\_url() |
|  |  | self.assert\_download\_works(base\_url) |
|  |  | self.assert\_display\_inline\_is\_download(base\_url) |
|  |  | if self.field\_name == "image": |
|  |  | self.assert\_scale\_view\_is\_download(base\_url) |
|  |  |  |
|  |  | def test\_filename\_none(self): |
|  |  | # A 'None' filename None probably does not happen during normal upload, |
|  |  | # but if an attacker manages this, even @@download will show inline. |
|  |  | # A 'None' filename probably does not happen during normal upload, |
|  |  | # but if an attacker manages this, even @@download would show inline. |
|  |  | # We prevent this. |
|  |  | data = self.\_named\_file("image.svg") |
|  |  | data.filename = None |
|  |  | setattr(self.item, self.field\_name, data) |
|  |  | transaction.commit() |
|  |  | base\_url = self.item.absolute\_url() |
|  |  | self.assert\_download\_works(base\_url) |
|  |  | self.assert\_display\_inline\_is\_download(base\_url) |
|  |  | if self.field\_name == "image": |
|  |  | self.assert\_scale\_view\_is\_download(base\_url) |
|  |  |  |
|  |  | def test\_filename\_empty(self): |
|  |  | # An empty filename is probably no problem, but let's check. |
| Expand All | | @@ -134,6 +191,8 @@ def test\_filename\_empty(self): |
|  |  | base\_url = self.item.absolute\_url() |
|  |  | self.assert\_download\_works(base\_url) |
|  |  | self.assert\_display\_inline\_is\_download(base\_url) |
|  |  | if self.field\_name == "image": |
|  |  | self.assert\_scale\_view\_is\_download(base\_url) |
|  |  |  |
|  |  |  |
|  |  | class TestAttackVectorNamedBlobImage(TestAttackVectorNamedImage): |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `ff5269f`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fplone%2Fplone.namedfile%2Fcommit%2Fff5269fb4c79f4eb91dd934561b8824a49a03b60) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_bcce15b5_20250110_222141.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fplone%2Fplone.namedfile%2Fcommit%2F217d6ce847b7171bf1b73fcb6c08010eb449216a)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fplone%2Fplone.namedfile%2Fcommit%2F217d6ce847b7171bf1b73fcb6c08010eb449216a)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=plone%2Fplone.namedfile)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[plone](/plone)
/
**[plone.namedfile](/plone/plone.namedfile)**
Public

* [Notifications](/login?return_to=%2Fplone%2Fplone.namedfile) You must be signed in to change notification settings
* [Fork
  20](/login?return_to=%2Fplone%2Fplone.namedfile)
* [Star
   9](/login?return_to=%2Fplone%2Fplone.namedfile)

* [Code](/plone/plone.namedfile)
* [Issues
  12](/plone/plone.namedfile/issues)
* [Pull requests
  3](/plone/plone.namedfile/pulls)
* [Actions](/plone/plone.namedfile/actions)
* [Security](/plone/plone.namedfile/security)
* [Insights](/plone/plone.namedfile/pulse)

Additional navigation options

* [Code](/plone/plone.namedfile)
* [Issues](/plone/plone.namedfile/issues)
* [Pull requests](/plone/plone.namedfile/pulls)
* [Actions](/plone/plone.namedfile/actions)
* [Security](/plone/plone.namedfile/security)
* [Insights](/plone/plone.namedfile/pulse)

## Commit

[Permalink](/plone/plone.namedfile/commit/217d6ce847b7171bf1b73fcb6c08010eb449216a)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-jj7c-jrv4-c65x](https://github.com/advisories/GHSA-jj7c-jrv4-c65x "GHSA-jj7c-jrv4-c65x")

[Browse files](/plone/plone.namedfile/tree/217d6ce847b7171bf1b73fcb6c08010eb449216a)
Browse the repository at this point in the history

```
Force download of image scales when inline is not allowed for mime type [6.1.x]
```

* Loading branch information

[![@mauritsvanrees](https://avatars.githubusercontent.com/u/210587?s=40&v=4)](/mauritsvanrees)

[mauritsvanrees](/plone/plone.namedfile/commits?author=mauritsvanrees "View all commits by mauritsvanrees")
authored
Sep 21, 2023

2 parents
[f814162](/plone/plone.namedfile/commit/f814162c1fb2993d2750dadbf1baca1a9f7340f1)
+
[bf9f2b9](/plone/plone.namedfile/commit/bf9f2b9f265e96babc2137ff235d4e29bdec1f3a)

commit 217d6ce

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**105 additions**
and
**4 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* news

  + news/1.bugfix
    [1.bugfix](#diff-6e4c37fa5287b47d17a52e3e9df34fa89ca3c94fd92a04164b8d6361d2249f21)
* plone/namedfile

  + plone/namedfile/scaling.py
    [scaling.py](#diff-a8114d50cd1310a7f79d303f8d55e166e917aa77fc5a9579cf13d0d4bbf2ec66)
  + tests

    - plone/namedfile/tests/test\_display\_file.py
      [test\_display\_file.py](#diff-8980da4d64e2bd93868e87c0971cce33a75db71eb23d75ecf6f501bdf391510f)

## There are no files selected for viewing

4 changes: 4 additions & 0 deletions

4
[news/1.bugfix](#diff-6e4c37fa5287b47d17a52e3e9df34fa89ca3c94fd92a04164b8d6361d2249f21 "news/1.bugfix")

Show comments

[View file](/plone/plone.namedfile/blob/217d6ce847b7171bf1b73fcb6c08010eb449216a/news/1.bugfix)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,4 @@ |
|  |  | Fix stored XSS (Cross Site Scripting) for SVG images. |
|  |  | Done by forcing a download instead of displaying inline. |
|  |  | See `security advisory <https://github.com/plone/plone.namedfile/security/advisories/GHSA-jj7c-jrv4-c65x>`\_. |
|  |  | [maurits] |

42 changes: 40 additions & 2 deletions

42
[plone/namedfile/scaling.py](#diff-a8114d50cd1310a7f79d303f8d55e166e917aa77fc5a9579cf13d0d4bbf2ec66 "plone/namedfile/scaling.py")

Show comments

[View file](/plone/plone.namedfile/blob/217d6ce847b7171bf1b73fcb6c08010eb449216a/plone/namedfile/scaling.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -4,6 +4,9 @@ |
|  |  | from io import BytesIO |
|  |  | from plone.memoize import ram |
|  |  | from plone.namedfile.file import FILECHUNK\_CLASSES |
|  |  | from plone.namedfile.browser import ALLOWED\_INLINE\_MIMETYPES |
|  |  | from plone.namedfile.browser import DISALLOWED\_INLINE\_MIMETYPES |
|  |  | from plone.namedfile.browser import USE\_DENYLIST |
|  |  | from plone.namedfile.interfaces import IAvailableSizes |
|  |  | from plone.namedfile.interfaces import IStableImageScale |
|  |  | from plone.namedfile.picture import get\_picture\_variants |
| Expand Down  Expand Up | | @@ -75,6 +78,14 @@ class ImageScale(BrowserView): |
|  |  | \_\_allow\_access\_to\_unprotected\_subobjects\_\_ = 1 |
|  |  | data = None |
|  |  |  |
|  |  | # You can control which mimetypes may be shown inline |
|  |  | # and which must always be downloaded, for security reasons. |
|  |  | # Make the configuration available on the class. |
|  |  | # Then subclasses can override this. |
|  |  | allowed\_inline\_mimetypes = ALLOWED\_INLINE\_MIMETYPES |
|  |  | disallowed\_inline\_mimetypes = DISALLOWED\_INLINE\_MIMETYPES |
|  |  | use\_denylist = USE\_DENYLIST |
|  |  |  |
|  |  | def \_\_init\_\_(self, context, request, \*\*info): |
|  |  | self.context = context |
|  |  | self.request = request |
| Expand Down  Expand Up | | @@ -167,10 +178,37 @@ def validate\_access(self): |
|  |  | fieldname = getattr(self.data, "fieldname", getattr(self, "fieldname", None)) |
|  |  | guarded\_getattr(self.context, fieldname) |
|  |  |  |
|  |  | def \_should\_force\_download(self): |
|  |  | # If this returns True, the caller should call set\_headers with a filename. |
|  |  | if not hasattr(self.data, "contentType"): |
|  |  | return |
|  |  | mimetype = self.data.contentType |
|  |  | if self.use\_denylist: |
|  |  | # We explicitly deny a few mimetypes, and allow the rest. |
|  |  | return mimetype in self.disallowed\_inline\_mimetypes |
|  |  | # Use the allowlist. |
|  |  | # We only explicitly allow a few mimetypes, and deny the rest. |
|  |  | return mimetype not in self.allowed\_inline\_mimetypes |
|  |  |  |
|  |  | def set\_headers(self, response=None): |
|  |  | # set headers for the image |
|  |  | image = self.data |
|  |  | if response is None: |
|  |  | response = self.request.response |
|  |  | filename = None |
|  |  | if self.\_should\_force\_download(): |
|  |  | # We MUST pass a filename, even a dummy one if needed. |
|  |  | filename = getattr(image, "filename", getattr(self, "filename", None)) |
|  |  | if filename is None: |
|  |  | filename = getattr(image, "fieldname", getattr(self, "fieldname", None)) |
|  |  | if filename is None: |
|  |  | filename = "image.ext" |
|  |  | set\_headers(image, response, filename=filename) |
|  |  |  |
|  |  | def index\_html(self): |
|  |  | """download the image""" |
|  |  | self.validate\_access() |
|  |  | set\_headers(self.data, self.request.response) |
|  |  | self.set\_headers() |
|  |  | return stream\_data(self.data) |
|  |  |  |
|  |  | def manage\_DAVget(self): |
| Expand All | | @@ -190,7 +228,7 @@ def HEAD(self, REQUEST, RESPONSE=None): |
|  |  | without transfer of the image itself |
|  |  | """ |
|  |  | self.validate\_access() |
|  |  | set\_headers(self.data, REQUEST.response) |
|  |  | self.set\_headers(response=REQUEST.response) |
|  |  | return "" |
|  |  |  |
|  |  | HEAD.\_\_roles\_\_ = ("Anonymous",) |
| Expand Down | |  |

63 changes: 61 additions & 2 deletions

63
[plone/namedfile/tests/test\_display\_file.py](#diff-8980da4d64e2bd93868e87c0971cce33a75db71eb23d75ecf6f501bdf391510f "plone/namedfile/tests/test_display_file.py")

Show comments

[View file](/plone/plone.namedfile/blob/217d6ce847b7171bf1b73fcb6c08010eb449216a/plone/namedfile/tests/test_display_file.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -3,12 +3,15 @@ |
|  |  | from plone.app.testing import SITE\_OWNER\_PASSWORD |
|  |  | from plone.namedfile import field |
|  |  | from plone.namedfile import file |
|  |  | from plone.namedfile.interfaces import IAvailableSizes |
|  |  | from plone.namedfile.interfaces import IImageScaleTraversable |
|  |  | from plone.namedfile.testing import PLONE\_NAMEDFILE\_FUNCTIONAL\_TESTING |
|  |  | from plone.namedfile.tests import getFile |
|  |  | from plone.testing.zope import Browser |
|  |  | from Products.CMFPlone.utils import safe\_unicode |
|  |  | from zope.annotation import IAnnotations |
|  |  | from zope.annotation import IAttributeAnnotatable |
|  |  | from zope.component import getSiteManager |
|  |  | from zope.interface import implementer |
|  |  |  |
|  |  | import transaction |
| Expand Down  Expand Up | | @@ -46,6 +49,11 @@ def get\_disposition\_header(browser): |
|  |  | return browser.headers.get(name, None) |
|  |  |  |
|  |  |  |
|  |  | def custom\_available\_sizes(): |
|  |  | # Define available image scales. |
|  |  | return {"custom": (10, 10)} |
|  |  |  |
|  |  |  |
|  |  | class TestAttackVectorNamedImage(unittest.TestCase): |
|  |  | layer = PLONE\_NAMEDFILE\_FUNCTIONAL\_TESTING |
|  |  | field\_class = file.NamedImage |
| Expand All | | @@ -56,6 +64,12 @@ def setUp(self): |
|  |  | item = DummyContent() |
|  |  | self.layer["app"].\_setOb("item", item) |
|  |  | self.item = self.layer["app"].item |
|  |  | sm = getSiteManager() |
|  |  | sm.registerUtility(component=custom\_available\_sizes, provided=IAvailableSizes) |
|  |  |  |
|  |  | def tearDown(self): |
|  |  | sm = getSiteManager() |
|  |  | sm.unregisterUtility(provided=IAvailableSizes) |
|  |  |  |
|  |  | def get\_admin\_browser(self): |
|  |  | browser = Browser(self.layer["app"]) |
| Expand Down  Expand Up | | @@ -98,30 +112,73 @@ def assert\_display\_inline\_is\_download(self, base\_url): |
|  |  | self.assertIn("attachment", header) |
|  |  | self.assertIn("filename", header) |
|  |  |  |
|  |  | def assert\_scale\_view\_works(self, base\_url): |
|  |  | # Test that accessing a scale view shows the image inline. |
|  |  | browser = self.get\_anon\_browser() |
|  |  | browser.open(base\_url + "/@@images/{}".format(self.field\_name)) |
|  |  | self.assertIsNone(get\_disposition\_header(browser)) |
|  |  |  |
|  |  | # Note: the 'custom' scale is defined in an adapter above. |
|  |  | browser.open(base\_url + "/@@images/{}/custom".format(self.field\_name)) |
|  |  | self.assertIsNone(get\_disposition\_header(browser)) |
|  |  |  |
|  |  | unique\_scale\_id = list(IAnnotations(self.item)["plone.scale"].keys())[0] |
|  |  | browser.open(base\_url + "/@@images/{}".format(unique\_scale\_id)) |
|  |  | self.assertIsNone(get\_disposition\_header(browser)) |
|  |  |  |
|  |  | def assert\_scale\_view\_is\_download(self, base\_url): |
|  |  | # Test that accessing a scale view turns into a download. |
|  |  | browser = self.get\_anon\_browser() |
|  |  | browser.open(base\_url + "/@@images/{}".format(self.field\_name)) |
|  |  | header = get\_disposition\_header(browser) |
|  |  | self.assertIsNotNone(header) |
|  |  | self.assertIn("attachment", header) |
|  |  | self.assertIn("filename", header) |
|  |  |  |
|  |  | browser.open(base\_url + "/@@images/{}/custom".format(self.field\_name)) |
|  |  | header = get\_disposition\_header(browser) |
|  |  | self.assertIsNotNone(header) |
|  |  | self.assertIn("attachment", header) |
|  |  | self.assertIn("filename", header) |
|  |  |  |
|  |  | unique\_scale\_id = list(IAnnotations(self.item)["plone.scale"].keys())[0] |
|  |  | browser.open(base\_url + "/@@images/{}".format(unique\_scale\_id)) |
|  |  | header = get\_disposition\_header(browser) |
|  |  | self.assertIsNotNone(header) |
|  |  | self.assertIn("attachment", header) |
|  |  | self.assertIn("filename", header) |
|  |  |  |
|  |  | def test\_png\_image(self): |
|  |  | setattr(self.item, self.field\_name, self.\_named\_file("image.png")) |
|  |  | transaction.commit() |
|  |  | base\_url = self.item.absolute\_url() |
|  |  | self.assert\_download\_works(base\_url) |
|  |  | self.assert\_display\_inline\_works(base\_url) |
|  |  | if self.field\_name == "image": |
|  |  | self.assert\_scale\_view\_works(base\_url) |
|  |  |  |
|  |  | def test\_svg\_image(self): |
|  |  | setattr(self.item, self.field\_name, self.\_named\_file("image.svg")) |
|  |  | transaction.commit() |
|  |  | base\_url = self.item.absolute\_url() |
|  |  | self.assert\_download\_works(base\_url) |
|  |  | self.assert\_display\_inline\_is\_download(base\_url) |
|  |  | if self.field\_name == "image": |
|  |  | self.assert\_scale\_view\_is\_download(base\_url) |
|  |  |  |
|  |  | def test\_filename\_none(self): |
|  |  | # A 'None' filename None probably does not happen during normal upload, |
|  |  | # but if an attacker manages this, even @@download will show inline. |
|  |  | # A 'None' filename probably does not happen during normal upload, |
|  |  | # but if an attacker manages this, even @@download would show inline. |
|  |  | # We prevent this. |
|  |  | data = self.\_named\_file("image.svg") |
|  |  | data.filename = None |
|  |  | setattr(self.item, self.field\_name, data) |
|  |  | transaction.commit() |
|  |  | base\_url = self.item.absolute\_url() |
|  |  | self.assert\_download\_works(base\_url) |
|  |  | self.assert\_display\_inline\_is\_download(base\_url) |
|  |  | if self.field\_name == "image": |
|  |  | self.assert\_scale\_view\_is\_download(base\_url) |
|  |  |  |
|  |  | def test\_filename\_empty(self): |
|  |  | # An empty filename is probably no problem, but let's check. |
| Expand All | | @@ -132,6 +189,8 @@ def test\_filename\_empty(self): |
|  |  | base\_url = self.item.absolute\_url() |
|  |  | self.assert\_download\_works(base\_url) |
|  |  | self.assert\_display\_inline\_is\_download(base\_url) |
|  |  | if self.field\_name == "image": |
|  |  | self.assert\_scale\_view\_is\_download(base\_url) |
|  |  |  |
|  |  |  |
|  |  | class TestAttackVectorNamedBlobImage(TestAttackVectorNamedImage): |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `217d6ce`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fplone%2Fplone.namedfile%2Fcommit%2F217d6ce847b7171bf1b73fcb6c08010eb449216a) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_3aa0cbe9_20250110_222140.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fplone%2Fplone.namedfile%2Fcommit%2F188f66a4577021cf8f2bf7c0f5150f9b9573f167)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fplone%2Fplone.namedfile%2Fcommit%2F188f66a4577021cf8f2bf7c0f5150f9b9573f167)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=plone%2Fplone.namedfile)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[plone](/plone)
/
**[plone.namedfile](/plone/plone.namedfile)**
Public

* [Notifications](/login?return_to=%2Fplone%2Fplone.namedfile) You must be signed in to change notification settings
* [Fork
  20](/login?return_to=%2Fplone%2Fplone.namedfile)
* [Star
   9](/login?return_to=%2Fplone%2Fplone.namedfile)

* [Code](/plone/plone.namedfile)
* [Issues
  12](/plone/plone.namedfile/issues)
* [Pull requests
  3](/plone/plone.namedfile/pulls)
* [Actions](/plone/plone.namedfile/actions)
* [Security](/plone/plone.namedfile/security)
* [Insights](/plone/plone.namedfile/pulse)

Additional navigation options

* [Code](/plone/plone.namedfile)
* [Issues](/plone/plone.namedfile/issues)
* [Pull requests](/plone/plone.namedfile/pulls)
* [Actions](/plone/plone.namedfile/actions)
* [Security](/plone/plone.namedfile/security)
* [Insights](/plone/plone.namedfile/pulse)

## Commit

[Permalink](/plone/plone.namedfile/commit/188f66a4577021cf8f2bf7c0f5150f9b9573f167)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-jj7c-jrv4-c65x](https://github.com/advisories/GHSA-jj7c-jrv4-c65x "GHSA-jj7c-jrv4-c65x")

[Browse files](/plone/plone.namedfile/tree/188f66a4577021cf8f2bf7c0f5150f9b9573f167)
Browse the repository at this point in the history

```
Force download of image scales when inline is not allowed for mime type [6.0.x]
```

* Loading branch information

[![@mauritsvanrees](https://avatars.githubusercontent.com/u/210587?s=40&v=4)](/mauritsvanrees)

[mauritsvanrees](/plone/plone.namedfile/commits?author=mauritsvanrees "View all commits by mauritsvanrees")
authored
Sep 21, 2023

2 parents
[ad36289](/plone/plone.namedfile/commit/ad362890b4357e71d7f526381b7fcdd408ce1748)
+
[014400a](/plone/plone.namedfile/commit/014400aadc6fc4ffcf15c2b1e954e4548f47d71e)

commit 188f66a

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**105 additions**
and
**4 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* news

  + news/1.bugfix
    [1.bugfix](#diff-6e4c37fa5287b47d17a52e3e9df34fa89ca3c94fd92a04164b8d6361d2249f21)
* plone/namedfile

  + plone/namedfile/scaling.py
    [scaling.py](#diff-a8114d50cd1310a7f79d303f8d55e166e917aa77fc5a9579cf13d0d4bbf2ec66)
  + tests

    - plone/namedfile/tests/test\_display\_file.py
      [test\_display\_file.py](#diff-8980da4d64e2bd93868e87c0971cce33a75db71eb23d75ecf6f501bdf391510f)

## There are no files selected for viewing

4 changes: 4 additions & 0 deletions

4
[news/1.bugfix](#diff-6e4c37fa5287b47d17a52e3e9df34fa89ca3c94fd92a04164b8d6361d2249f21 "news/1.bugfix")

Show comments

[View file](/plone/plone.namedfile/blob/188f66a4577021cf8f2bf7c0f5150f9b9573f167/news/1.bugfix)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,4 @@ |
|  |  | Fix stored XSS (Cross Site Scripting) for SVG images. |
|  |  | Done by forcing a download instead of displaying inline. |
|  |  | See `security advisory <https://github.com/plone/plone.namedfile/security/advisories/GHSA-jj7c-jrv4-c65x>`\_. |
|  |  | [maurits] |

42 changes: 40 additions & 2 deletions

42
[plone/namedfile/scaling.py](#diff-a8114d50cd1310a7f79d303f8d55e166e917aa77fc5a9579cf13d0d4bbf2ec66 "plone/namedfile/scaling.py")

Show comments

[View file](/plone/plone.namedfile/blob/188f66a4577021cf8f2bf7c0f5150f9b9573f167/plone/namedfile/scaling.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -4,6 +4,9 @@ |
|  |  | from io import BytesIO |
|  |  | from plone.memoize import ram |
|  |  | from plone.namedfile.file import FILECHUNK\_CLASSES |
|  |  | from plone.namedfile.browser import ALLOWED\_INLINE\_MIMETYPES |
|  |  | from plone.namedfile.browser import DISALLOWED\_INLINE\_MIMETYPES |
|  |  | from plone.namedfile.browser import USE\_DENYLIST |
|  |  | from plone.namedfile.interfaces import IAvailableSizes |
|  |  | from plone.namedfile.interfaces import IStableImageScale |
|  |  | from plone.namedfile.picture import get\_picture\_variants |
| Expand Down  Expand Up | | @@ -74,6 +77,14 @@ class ImageScale(BrowserView): |
|  |  | \_\_allow\_access\_to\_unprotected\_subobjects\_\_ = 1 |
|  |  | data = None |
|  |  |  |
|  |  | # You can control which mimetypes may be shown inline |
|  |  | # and which must always be downloaded, for security reasons. |
|  |  | # Make the configuration available on the class. |
|  |  | # Then subclasses can override this. |
|  |  | allowed\_inline\_mimetypes = ALLOWED\_INLINE\_MIMETYPES |
|  |  | disallowed\_inline\_mimetypes = DISALLOWED\_INLINE\_MIMETYPES |
|  |  | use\_denylist = USE\_DENYLIST |
|  |  |  |
|  |  | def \_\_init\_\_(self, context, request, \*\*info): |
|  |  | self.context = context |
|  |  | self.request = request |
| Expand Down  Expand Up | | @@ -166,10 +177,37 @@ def validate\_access(self): |
|  |  | fieldname = getattr(self.data, "fieldname", getattr(self, "fieldname", None)) |
|  |  | guarded\_getattr(self.context, fieldname) |
|  |  |  |
|  |  | def \_should\_force\_download(self): |
|  |  | # If this returns True, the caller should call set\_headers with a filename. |
|  |  | if not hasattr(self.data, "contentType"): |
|  |  | return |
|  |  | mimetype = self.data.contentType |
|  |  | if self.use\_denylist: |
|  |  | # We explicitly deny a few mimetypes, and allow the rest. |
|  |  | return mimetype in self.disallowed\_inline\_mimetypes |
|  |  | # Use the allowlist. |
|  |  | # We only explicitly allow a few mimetypes, and deny the rest. |
|  |  | return mimetype not in self.allowed\_inline\_mimetypes |
|  |  |  |
|  |  | def set\_headers(self, response=None): |
|  |  | # set headers for the image |
|  |  | image = self.data |
|  |  | if response is None: |
|  |  | response = self.request.response |
|  |  | filename = None |
|  |  | if self.\_should\_force\_download(): |
|  |  | # We MUST pass a filename, even a dummy one if needed. |
|  |  | filename = getattr(image, "filename", getattr(self, "filename", None)) |
|  |  | if filename is None: |
|  |  | filename = getattr(image, "fieldname", getattr(self, "fieldname", None)) |
|  |  | if filename is None: |
|  |  | filename = "image.ext" |
|  |  | set\_headers(image, response, filename=filename) |
|  |  |  |
|  |  | def index\_html(self): |
|  |  | """download the image""" |
|  |  | self.validate\_access() |
|  |  | set\_headers(self.data, self.request.response) |
|  |  | self.set\_headers() |
|  |  | return stream\_data(self.data) |
|  |  |  |
|  |  | def manage\_DAVget(self): |
| Expand All | | @@ -189,7 +227,7 @@ def HEAD(self, REQUEST, RESPONSE=None): |
|  |  | without transfer of the image itself |
|  |  | """ |
|  |  | self.validate\_access() |
|  |  | set\_headers(self.data, REQUEST.response) |
|  |  | self.set\_headers(response=REQUEST.response) |
|  |  | return "" |
|  |  |  |
|  |  | HEAD.\_\_roles\_\_ = ("Anonymous",) |
| Expand Down | |  |

63 changes: 61 additions & 2 deletions

63
[plone/namedfile/tests/test\_display\_file.py](#diff-8980da4d64e2bd93868e87c0971cce33a75db71eb23d75ecf6f501bdf391510f "plone/namedfile/tests/test_display_file.py")

Show comments

[View file](/plone/plone.namedfile/blob/188f66a4577021cf8f2bf7c0f5150f9b9573f167/plone/namedfile/tests/test_display_file.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -3,12 +3,15 @@ |
|  |  | from plone.app.testing import SITE\_OWNER\_PASSWORD |
|  |  | from plone.namedfile import field |
|  |  | from plone.namedfile import file |
|  |  | from plone.namedfile.interfaces import IAvailableSizes |
|  |  | from plone.namedfile.interfaces import IImageScaleTraversable |
|  |  | from plone.namedfile.testing import PLONE\_NAMEDFILE\_FUNCTIONAL\_TESTING |
|  |  | from plone.namedfile.tests import getFile |
|  |  | from plone.testing.zope import Browser |
|  |  | from Products.CMFPlone.utils import safe\_unicode |
|  |  | from zope.annotation import IAnnotations |
|  |  | from zope.annotation import IAttributeAnnotatable |
|  |  | from zope.component import getSiteManager |
|  |  | from zope.interface import implementer |
|  |  |  |
|  |  | import transaction |
| Expand Down  Expand Up | | @@ -46,6 +49,11 @@ def get\_disposition\_header(browser): |
|  |  | return browser.headers.get(name, None) |
|  |  |  |
|  |  |  |
|  |  | def custom\_available\_sizes(): |
|  |  | # Define available image scales. |
|  |  | return {"custom": (10, 10)} |
|  |  |  |
|  |  |  |
|  |  | class TestAttackVectorNamedImage(unittest.TestCase): |
|  |  | layer = PLONE\_NAMEDFILE\_FUNCTIONAL\_TESTING |
|  |  | field\_class = file.NamedImage |
| Expand All | | @@ -56,6 +64,12 @@ def setUp(self): |
|  |  | item = DummyContent() |
|  |  | self.layer["app"].\_setOb("item", item) |
|  |  | self.item = self.layer["app"].item |
|  |  | sm = getSiteManager() |
|  |  | sm.registerUtility(component=custom\_available\_sizes, provided=IAvailableSizes) |
|  |  |  |
|  |  | def tearDown(self): |
|  |  | sm = getSiteManager() |
|  |  | sm.unregisterUtility(provided=IAvailableSizes) |
|  |  |  |
|  |  | def get\_admin\_browser(self): |
|  |  | browser = Browser(self.layer["app"]) |
| Expand Down  Expand Up | | @@ -98,30 +112,73 @@ def assert\_display\_inline\_is\_download(self, base\_url): |
|  |  | self.assertIn("attachment", header) |
|  |  | self.assertIn("filename", header) |
|  |  |  |
|  |  | def assert\_scale\_view\_works(self, base\_url): |
|  |  | # Test that accessing a scale view shows the image inline. |
|  |  | browser = self.get\_anon\_browser() |
|  |  | browser.open(base\_url + "/@@images/{}".format(self.field\_name)) |
|  |  | self.assertIsNone(get\_disposition\_header(browser)) |
|  |  |  |
|  |  | # Note: the 'custom' scale is defined in an adapter above. |
|  |  | browser.open(base\_url + "/@@images/{}/custom".format(self.field\_name)) |
|  |  | self.assertIsNone(get\_disposition\_header(browser)) |
|  |  |  |
|  |  | unique\_scale\_id = list(IAnnotations(self.item)["plone.scale"].keys())[0] |
|  |  | browser.open(base\_url + "/@@images/{}".format(unique\_scale\_id)) |
|  |  | self.assertIsNone(get\_disposition\_header(browser)) |
|  |  |  |
|  |  | def assert\_scale\_view\_is\_download(self, base\_url): |
|  |  | # Test that accessing a scale view turns into a download. |
|  |  | browser = self.get\_anon\_browser() |
|  |  | browser.open(base\_url + "/@@images/{}".format(self.field\_name)) |
|  |  | header = get\_disposition\_header(browser) |
|  |  | self.assertIsNotNone(header) |
|  |  | self.assertIn("attachment", header) |
|  |  | self.assertIn("filename", header) |
|  |  |  |
|  |  | browser.open(base\_url + "/@@images/{}/custom".format(self.field\_name)) |
|  |  | header = get\_disposition\_header(browser) |
|  |  | self.assertIsNotNone(header) |
|  |  | self.assertIn("attachment", header) |
|  |  | self.assertIn("filename", header) |
|  |  |  |
|  |  | unique\_scale\_id = list(IAnnotations(self.item)["plone.scale"].keys())[0] |
|  |  | browser.open(base\_url + "/@@images/{}".format(unique\_scale\_id)) |
|  |  | header = get\_disposition\_header(browser) |
|  |  | self.assertIsNotNone(header) |
|  |  | self.assertIn("attachment", header) |
|  |  | self.assertIn("filename", header) |
|  |  |  |
|  |  | def test\_png\_image(self): |
|  |  | setattr(self.item, self.field\_name, self.\_named\_file("image.png")) |
|  |  | transaction.commit() |
|  |  | base\_url = self.item.absolute\_url() |
|  |  | self.assert\_download\_works(base\_url) |
|  |  | self.assert\_display\_inline\_works(base\_url) |
|  |  | if self.field\_name == "image": |
|  |  | self.assert\_scale\_view\_works(base\_url) |
|  |  |  |
|  |  | def test\_svg\_image(self): |
|  |  | setattr(self.item, self.field\_name, self.\_named\_file("image.svg")) |
|  |  | transaction.commit() |
|  |  | base\_url = self.item.absolute\_url() |
|  |  | self.assert\_download\_works(base\_url) |
|  |  | self.assert\_display\_inline\_is\_download(base\_url) |
|  |  | if self.field\_name == "image": |
|  |  | self.assert\_scale\_view\_is\_download(base\_url) |
|  |  |  |
|  |  | def test\_filename\_none(self): |
|  |  | # A 'None' filename None probably does not happen during normal upload, |
|  |  | # but if an attacker manages this, even @@download will show inline. |
|  |  | # A 'None' filename probably does not happen during normal upload, |
|  |  | # but if an attacker manages this, even @@download would show inline. |
|  |  | # We prevent this. |
|  |  | data = self.\_named\_file("image.svg") |
|  |  | data.filename = None |
|  |  | setattr(self.item, self.field\_name, data) |
|  |  | transaction.commit() |
|  |  | base\_url = self.item.absolute\_url() |
|  |  | self.assert\_download\_works(base\_url) |
|  |  | self.assert\_display\_inline\_is\_download(base\_url) |
|  |  | if self.field\_name == "image": |
|  |  | self.assert\_scale\_view\_is\_download(base\_url) |
|  |  |  |
|  |  | def test\_filename\_empty(self): |
|  |  | # An empty filename is probably no problem, but let's check. |
| Expand All | | @@ -132,6 +189,8 @@ def test\_filename\_empty(self): |
|  |  | base\_url = self.item.absolute\_url() |
|  |  | self.assert\_download\_works(base\_url) |
|  |  | self.assert\_display\_inline\_is\_download(base\_url) |
|  |  | if self.field\_name == "image": |
|  |  | self.assert\_scale\_view\_is\_download(base\_url) |
|  |  |  |
|  |  |  |
|  |  | class TestAttackVectorNamedBlobImage(TestAttackVectorNamedImage): |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `188f66a`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fplone%2Fplone.namedfile%2Fcommit%2F188f66a4577021cf8f2bf7c0f5150f9b9573f167) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.openwall.com_e7e0cb2b_20250110_222139.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](3) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <1afd8036-850f-c98e-5ee8-9e95f658e82e@vanrees.org>
Date: Fri, 22 Sep 2023 12:14:42 +0200
From: Maurits van Rees <maurits@...rees.org>
To: oss-security@...ts.openwall.com
Subject: Plone security advisory 2023/09/21

Various vulnerabilities in Plone and Zope have been reported and fixed.
They affect all supported Plone versions: 5.2 and 6.0. Older Plone
versions are likely also affected.
There will be no traditional hotfix package for these: you should update
the version pins of individual packages. See [this
post](<https://community.plone.org/t/less-plone-hotfix-packages/17931?u=mauritsvanrees>)
about why we do less hotfix packages.

The information can be found here:
<https://community.plone.org/t/plone-security-advisory-2023-09-21/17941>
<https://plone.org/security/hotfix/20230921>

The text is included below.

## Denial of service

In `plone.rest` when the `++api++` traverser is accidentally used
multiple times in a url, handling it takes increasingly longer, making
the server less responsive.

Security advisory:
[CVE-2023-42457](<https://github.com/plone/plone.rest/security/advisories/GHSA-h6rp-mprm-xgcq>).

## Stored XSS

There is a stored cross site scripting vulnerability for SVG images. A
[security hotfix from
2021](<https://github.com/plone/Products.PloneHotfix20210518>) already
partially fixed this, by making sure SVG images are always downloaded
instead of shown inline. But the same problem still exists for *scales*
of SVG images. And it exists for *user portraits*, both in Volto and
ClassicUI.

Technically, ClassicUI is not vulnerable for the user portrait part,
because you cannot upload an SVG as user portrait. But in Volto you can,
so you may be able to access a vulnerable url in the backend anyway.

Note that a page that uses an image tag with an SVG image as source is
never vulnerable, even when the SVG image contains malicious code. To
exploit the vulnerability, an attacker would first need to upload a
malicious SVG image, and then trick a user into following a specially
crafted link.

Fixes are needed in three packages. We link to the security advisories:

*
[`plone.namedfile`](<https://github.com/plone/plone.namedfile/security/advisories/GHSA-jj7c-jrv4-c65x>)
CVE-2023-41048
*
[`Zope`](<https://github.com/zopefoundation/Zope/security/advisories/GHSA-wm8q-9975-xh5v>)
CVE-2023-42458
*
[`plone.restapi`](<https://github.com/plone/plone.restapi/security/advisories/GHSA-hc5c-r8m5-2gfh>)
also CVE-2023-42458

## Information disclosure and sandbox escape

Earlier this month, new Zope releases were made, which included security
releases of `AccessControl` and `RestrictedPython` . See the [community
announcement](<https://community.plone.org/t/zope-4-8-9-and-5-8-4-released-with-a-security-fix/17849>).

## Fixed Plone versions

All needed packages are included in Plone 5.2.14 and 6.0.7 which have
just been released.

## Package versions

If you cannot or do not want to upgrade your entire Plone version, you
can upgrade individual package versions.

Fixes are available in these versions:

```
AccessControl = 4.4, 5.8, 6.2
RestrictedPython = 5.4, 6.2
plone.namedfile = 5.6.1, 6.0.3, 6.1.3, 6.2.1
plone.rest = 2.0.1, 3.0.1
plone.restapi = 8.43.4
Zope = 4.8.10, 5.8.5
```

If you are using Buildout, then for the `Zope`, `AccessControl` and
`RestrictedPython` versions it is best to update the `[buildout]
extends` lines to include the following.

For Plone 5.2:
<https://zopefoundation.github.io/Zope/releases/4.8.10/versions.cfg>

For Plone 6:
<https://zopefoundation.github.io/Zope/releases/5.8.5/versions.cfg>

So which versions of these packages should you use on which Plone version?

To avoid surprises, you should use the version that is closest to the
version you are already using. If you use the default versions, the
following should help. This uses the Buildout notation. If you use a pip
constraints file, you should use a double equals sign.

### Plone 5.2

```
AccessControl = 4.4
plone.namedfile = 5.6.1
RestrictedPython = 5.4
Zope = 4.8.10
```

If you run Plone 5.2 on Python 3, and you are already using
`plone.restapi` 8, then you can additionally use:

```
plone.restapi = 8.43.4
```

### Plone 6.0.0/6.0.1

```
AccessControl = 5.8
plone.namedfile = 6.0.3
plone.rest = 2.0.1
plone.restapi = 8.43.4
RestrictedPython = 6.2
Zope = 5.8.5
```

### Plone 6.0.2

```
AccessControl = 5.8
plone.namedfile = 6.0.3
plone.rest = 3.0.1
plone.restapi = 8.43.4
RestrictedPython = 6.2
Zope = 5.8.5
```

### Plone 6.0.3/6.0.4

```
AccessControl = 6.2
plone.namedfile = 6.0.3
plone.rest = 3.0.1
plone.restapi = 8.43.4
RestrictedPython = 6.2
Zope = 5.8.5
```

### Plone 6.0.5/6.0.6

```
AccessControl = 6.2
plone.namedfile = 6.1.3
plone.rest = 3.0.1
plone.restapi = 8.43.4
RestrictedPython = 6.2
Zope = 5.8.5
```

If you are having problems with the installation, or see regressions,
please make a post in this thread, and anyone can help you.

If you see further security problems, please [mail the Plone/Zope
Security Team](mailto:security@...ne.org).

--
Maurits van Rees <https://maurits.vanrees.org/>
Plone/Zope Security Team

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from github.com_2200ab67_20250110_222144.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fplone%2Fplone.namedfile%2Fsecurity%2Fadvisories%2FGHSA-jj7c-jrv4-c65x)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fplone%2Fplone.namedfile%2Fsecurity%2Fadvisories%2FGHSA-jj7c-jrv4-c65x)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=plone%2Fplone.namedfile)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[plone](/plone)
/
**[plone.namedfile](/plone/plone.namedfile)**
Public

* [Notifications](/login?return_to=%2Fplone%2Fplone.namedfile) You must be signed in to change notification settings
* [Fork
  20](/login?return_to=%2Fplone%2Fplone.namedfile)
* [Star
   9](/login?return_to=%2Fplone%2Fplone.namedfile)

* [Code](/plone/plone.namedfile)
* [Issues
  12](/plone/plone.namedfile/issues)
* [Pull requests
  3](/plone/plone.namedfile/pulls)
* [Actions](/plone/plone.namedfile/actions)
* [Security](/plone/plone.namedfile/security)
* [Insights](/plone/plone.namedfile/pulse)

Additional navigation options

* [Code](/plone/plone.namedfile)
* [Issues](/plone/plone.namedfile/issues)
* [Pull requests](/plone/plone.namedfile/pulls)
* [Actions](/plone/plone.namedfile/actions)
* [Security](/plone/plone.namedfile/security)
* [Insights](/plone/plone.namedfile/pulse)

# Stored Cross Site Scripting with SVG images

Low

[mauritsvanrees](/mauritsvanrees)
published
GHSA-jj7c-jrv4-c65x
Sep 21, 2023

## Package

pip

plone.namedfile
([pip](/advisories?query=ecosystem%3Apip))

## Affected versions

<=5.6.0, <=6.0.2, <=6.1.2, <=6.2.0

## Patched versions

5.6.1, 6.0.3, 6.1.3, 6.2.1

## Description

### Impact

There is a stored cross site scripting vulnerability for SVG images. A [security hotfix from 2021](https://github.com/plone/Products.PloneHotfix20210518) already partially fixed this, by making sure SVG images are always downloaded instead of shown inline. But the same problem still exists for scales of SVG images.

Note that an image tag with an SVG image as source is not vulnerable, even when the SVG image contains malicious code. To exploit the vulnerability, an attacker would first need to upload an image, and then trick a user into following a specially crafted link.

All versions of `plone.namedfile` are impacted.

### Patches

Patches will be released in various `plone.namedfile` releases:

* 5.6.1 (for Plone 5.2)
* 6.0.3 (for Plone 6.0.0-6.0.4)
* 6.1.3 (for Plone 6.0.5-6.0.6)
* 6.2.1 (for Plone 6.0.7)

### Workarounds

There is no workaround.

### Credits

This was independently reported to the [Plone Security Team](https://plone.org/security/report) by Miguel Segovia, Aldin Visnjic, and Faris Krivic.

### Severity

Low

3.7

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
High

Privileges required
Low

User interaction
Required

Scope
Unchanged

Confidentiality
Low

Integrity
Low

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:L/I:L/A:N

### CVE ID

CVE-2023-41048

### Weaknesses

[CWE-80](/advisories?query=cwe%3A80)

### Credits

* [![@msegoviag](https://avatars.githubusercontent.com/u/41863090?s=40&v=4)](/msegoviag)
  [msegoviag](/msegoviag)
  Finder

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


