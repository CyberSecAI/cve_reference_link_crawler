
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fplone%2FProducts.PloneHotfix20210518)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fplone%2FProducts.PloneHotfix20210518)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=plone%2FProducts.PloneHotfix20210518)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[plone](/plone)
/
**[Products.PloneHotfix20210518](/plone/Products.PloneHotfix20210518)**
Public

* [Notifications](/login?return_to=%2Fplone%2FProducts.PloneHotfix20210518) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2Fplone%2FProducts.PloneHotfix20210518)
* [Star
   0](/login?return_to=%2Fplone%2FProducts.PloneHotfix20210518)

[0
stars](/plone/Products.PloneHotfix20210518/stargazers) [0
forks](/plone/Products.PloneHotfix20210518/forks) [Branches](/plone/Products.PloneHotfix20210518/branches) [Tags](/plone/Products.PloneHotfix20210518/tags) [Activity](/plone/Products.PloneHotfix20210518/activity)
 [Star](/login?return_to=%2Fplone%2FProducts.PloneHotfix20210518)

 [Notifications](/login?return_to=%2Fplone%2FProducts.PloneHotfix20210518) You must be signed in to change notification settings

* [Code](/plone/Products.PloneHotfix20210518)
* [Issues
  0](/plone/Products.PloneHotfix20210518/issues)
* [Pull requests
  0](/plone/Products.PloneHotfix20210518/pulls)
* [Actions](/plone/Products.PloneHotfix20210518/actions)
* [Projects
  0](/plone/Products.PloneHotfix20210518/projects)
* [Security](/plone/Products.PloneHotfix20210518/security)
* [Insights](/plone/Products.PloneHotfix20210518/pulse)

Additional navigation options

* [Code](/plone/Products.PloneHotfix20210518)
* [Issues](/plone/Products.PloneHotfix20210518/issues)
* [Pull requests](/plone/Products.PloneHotfix20210518/pulls)
* [Actions](/plone/Products.PloneHotfix20210518/actions)
* [Projects](/plone/Products.PloneHotfix20210518/projects)
* [Security](/plone/Products.PloneHotfix20210518/security)
* [Insights](/plone/Products.PloneHotfix20210518/pulse)

# plone/Products.PloneHotfix20210518

    main[Branches](/plone/Products.PloneHotfix20210518/branches)[Tags](/plone/Products.PloneHotfix20210518/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[31 Commits](/plone/Products.PloneHotfix20210518/commits/main/) | | |
| [.github/workflows](/plone/Products.PloneHotfix20210518/tree/main/.github/workflows "This path skips through empty directories") | | [.github/workflows](/plone/Products.PloneHotfix20210518/tree/main/.github/workflows "This path skips through empty directories") |  |  |
| [Products](/plone/Products.PloneHotfix20210518/tree/main/Products "Products") | | [Products](/plone/Products.PloneHotfix20210518/tree/main/Products "Products") |  |  |
| [docs](/plone/Products.PloneHotfix20210518/tree/main/docs "docs") | | [docs](/plone/Products.PloneHotfix20210518/tree/main/docs "docs") |  |  |
| [.gitignore](/plone/Products.PloneHotfix20210518/blob/main/.gitignore ".gitignore") | | [.gitignore](/plone/Products.PloneHotfix20210518/blob/main/.gitignore ".gitignore") |  |  |
| [MANIFEST.in](/plone/Products.PloneHotfix20210518/blob/main/MANIFEST.in "MANIFEST.in") | | [MANIFEST.in](/plone/Products.PloneHotfix20210518/blob/main/MANIFEST.in "MANIFEST.in") |  |  |
| [README.rst](/plone/Products.PloneHotfix20210518/blob/main/README.rst "README.rst") | | [README.rst](/plone/Products.PloneHotfix20210518/blob/main/README.rst "README.rst") |  |  |
| [RELEASING.rst](/plone/Products.PloneHotfix20210518/blob/main/RELEASING.rst "RELEASING.rst") | | [RELEASING.rst](/plone/Products.PloneHotfix20210518/blob/main/RELEASING.rst "RELEASING.rst") |  |  |
| [TESTING.rst](/plone/Products.PloneHotfix20210518/blob/main/TESTING.rst "TESTING.rst") | | [TESTING.rst](/plone/Products.PloneHotfix20210518/blob/main/TESTING.rst "TESTING.rst") |  |  |
| [mkdists.py](/plone/Products.PloneHotfix20210518/blob/main/mkdists.py "mkdists.py") | | [mkdists.py](/plone/Products.PloneHotfix20210518/blob/main/mkdists.py "mkdists.py") |  |  |
| [setup.cfg](/plone/Products.PloneHotfix20210518/blob/main/setup.cfg "setup.cfg") | | [setup.cfg](/plone/Products.PloneHotfix20210518/blob/main/setup.cfg "setup.cfg") |  |  |
| [setup.py](/plone/Products.PloneHotfix20210518/blob/main/setup.py "setup.py") | | [setup.py](/plone/Products.PloneHotfix20210518/blob/main/setup.py "setup.py") |  |  |
| [test-4.3.cfg](/plone/Products.PloneHotfix20210518/blob/main/test-4.3.cfg "test-4.3.cfg") | | [test-4.3.cfg](/plone/Products.PloneHotfix20210518/blob/main/test-4.3.cfg "test-4.3.cfg") |  |  |
| [test-4.3pac.cfg](/plone/Products.PloneHotfix20210518/blob/main/test-4.3pac.cfg "test-4.3pac.cfg") | | [test-4.3pac.cfg](/plone/Products.PloneHotfix20210518/blob/main/test-4.3pac.cfg "test-4.3pac.cfg") |  |  |
| [test-4.3pt.cfg](/plone/Products.PloneHotfix20210518/blob/main/test-4.3pt.cfg "test-4.3pt.cfg") | | [test-4.3pt.cfg](/plone/Products.PloneHotfix20210518/blob/main/test-4.3pt.cfg "test-4.3pt.cfg") |  |  |
| [test-5.0.cfg](/plone/Products.PloneHotfix20210518/blob/main/test-5.0.cfg "test-5.0.cfg") | | [test-5.0.cfg](/plone/Products.PloneHotfix20210518/blob/main/test-5.0.cfg "test-5.0.cfg") |  |  |
| [test-5.1.cfg](/plone/Products.PloneHotfix20210518/blob/main/test-5.1.cfg "test-5.1.cfg") | | [test-5.1.cfg](/plone/Products.PloneHotfix20210518/blob/main/test-5.1.cfg "test-5.1.cfg") |  |  |
| [test-5.2.1.cfg](/plone/Products.PloneHotfix20210518/blob/main/test-5.2.1.cfg "test-5.2.1.cfg") | | [test-5.2.1.cfg](/plone/Products.PloneHotfix20210518/blob/main/test-5.2.1.cfg "test-5.2.1.cfg") |  |  |
| [test-5.2.cfg](/plone/Products.PloneHotfix20210518/blob/main/test-5.2.cfg "test-5.2.cfg") | | [test-5.2.cfg](/plone/Products.PloneHotfix20210518/blob/main/test-5.2.cfg "test-5.2.cfg") |  |  |
| [test-hotfix.cfg](/plone/Products.PloneHotfix20210518/blob/main/test-hotfix.cfg "test-hotfix.cfg") | | [test-hotfix.cfg](/plone/Products.PloneHotfix20210518/blob/main/test-hotfix.cfg "test-hotfix.cfg") |  |  |
| [tox.ini](/plone/Products.PloneHotfix20210518/blob/main/tox.ini "tox.ini") | | [tox.ini](/plone/Products.PloneHotfix20210518/blob/main/tox.ini "tox.ini") |  |  |
| View all files | | |

## Repository files navigation

* README
* Code of conduct
* Security
## Plone hotfix, 2021-05-18

This hotfix fixes several security issues:

* Remote Code Execution via traversal in expressions via aliases.
  Reported by David Miller.
* Remote Code Execution via traversal in expressions (no aliases).
  Reported by Calum Hutton.
* Remote Code Execution via traversal in expressions via string formatter.
  Reported by David Miller.
* Writing arbitrary files via docutils and Python Script.
  Reported by Calum Hutton.
* Stored XSS from file upload (svg, html).
  Reported separately by Emir Cüneyt Akkutlu and Tino Kautschke.
* XSS vulnerability in CMFDiffTool.
  Reported by Igor Margitich.
* Reflected XSS in various spots.
  Reported by Calum Hutton.
* Various information disclosures: GS, QI, all\_users.
  Reported by Calum Hutton.
* Stored XSS from user fullname.
  Reported by Tino Kautschke.
* Blind SSRF via feedparser accessing an internal URL.
  Reported by Subodh Kumar Shree.
* Server Side Request Forgery via event ical URL.
  Reported by MisakiKata and David Miller.
* Server Side Request Forgery via lxml parser.
  Reported by MisakiKata and David Miller.
* XSS in folder contents on Plone 5.0 and higher.
  Reported by Matt Moreschi.
  Only included since version 1.5 of the hotfix.
* Remote Code Execution via Python Script.
  Reported by Calum Hutton.
  Only Plone 5.2 on Python 3 is vulnerable.
  Only included since version 1.6 of the hotfix.

## Compatibility

This hotfix should be applied to the following versions of Plone:

* Plone 5.2.4 and any earlier 5.2.x version
* Plone 5.1.7 and any earlier 5.1x version
* Plone 5.0.10 and any earlier 5.0.x version
* Plone 4.3.20 and any earlier 4.x version

The hotfix is officially supported by the Plone security team on the
following versions of Plone in accordance with the Plone
[version support policy](https://plone.org/security/update-policy): 4.3.20, 5.0.10, 5.1.7 and 5.2.4.

On Plone 4.3, 5.0 and 5.1 the hotfix is officially only supported on Python 2.7.
On Plone 5.2.X it is supported on Python 2.7 and Python 3.6/3.7/3.8.

The fixes included here will be incorporated into subsequent releases of Plone,
so Plone 5.2.5 and greater should not require this hotfix.

## Zope

Zope is also affected.
New versions for Zope and other packages are available.
Upgrading to those is the recommended way.

If you cannot upgrade yet, you can try the Plone hotfix.
It has not been tested on Zope only, but we try not to let the Plone-specific code get in the way, so it should be okay.

These vulnerabilities mentioned above are relevant for Zope:

* Remote Code Execution via traversal in expressions via aliases.
  Fixes released in Zope 4.6 and 5.2.
* Remote Code Execution via traversal in expressions (no aliases).
  Fixes released in Zope 4.6.1 and 5.2.1.
* Various information disclosures.
  Fixes released in Products.PluggableAuthService 2.6.0, Products.GenericSetup 2.1.1, and Zope 4.5.5.
* Reflected XSS in various spots.
  Fixes released in Products.CMFCore 2.5.1 and Products.PluggableAuthService 2.6.2.
* Remote Code Execution via traversal in expressions via string formatter.
  Fixes released in Zope 4.6.2, which takes over the already stricter code from Zope 5.2.1.
* Remote Code Execution via Python Script.
  Fixes released in Zope 4.6.3 and 5.3.

## Installation

Installation instructions can be found at
<https://plone.org/security/hotfix/20210518>

Note

You may get an error when running buildout:

```
Error: Couldn't find a distribution for 'Products.PloneHotfix20210518==1.0'.

```

The most likely cause is that you use a too old Python or too old setuptools without "SNI" support.
See this [community.plone.org post](https://community.plone.org/t/pypi-deprecation-of-support-for-non-sni-clients-breaks-buildout-for-older-plone-versions/13803).

Another cause could be that your buildout is trying to download the hotfix via http or from an older PyPI index.
In the buildout section of your buildout, make sure you use the correct index:

```
[buildout]
index = https://pypi.org/simple/

```

## Q&A

Q: How can I confirm that the hotfix is installed correctly and my site is protected?

A: On startup, the hotfix will log a number of messages to the Zope event log
that look like this:

```
2021-05-18 14:07:24,176 INFO    [Products.PloneHotfix20210518:43][MainThread] Applied expressions patch
2021-05-18 14:07:24,179 INFO    [Products.PloneHotfix20210518:43][MainThread] Applied genericsetup patch
2021-05-18 14:07:24,181 INFO    [Products.PloneHotfix20210518:43][MainThread] Applied pas patch
2021-05-18 14:07:24,182 INFO    [Products.PloneHotfix20210518:43][MainThread] Applied propertymanager patch
2021-05-18 14:07:24,183 INFO    [Products.PloneHotfix20210518:43][MainThread] Applied skinnable patch
2021-05-18 14:07:24,187 INFO    [Products.PloneHotfix20210518:43][MainThread] Applied xmlrpc_dump_instance patch
2021-05-18 14:07:24,188 INFO    [Products.PloneHotfix20210518:43][MainThread] Applied difftool patch
2021-05-18 14:07:24,238 INFO    [Products.PloneHotfix20210518:43][MainThread] Applied event patch
2021-05-18 14:07:24,244 INFO    [Products.PloneHotfix20210518:43][MainThread] Applied modeleditor patch
2021-05-18 14:07:24,246 INFO    [Products.PloneHotfix20210518:43][MainThread] Applied namedfile patch
2021-05-18 14:07:24,283 INFO    [Products.PloneHotfix20210518:43][MainThread] Applied pa_users patch
2021-05-18 14:07:24,367 INFO    [Products.PloneHotfix20210518:43][MainThread] Applied portlets patch
2021-05-18 14:07:24,369 INFO    [Products.PloneHotfix20210518:43][MainThread] Applied publishing patch
2021-05-18 14:07:24,371 INFO    [Products.PloneHotfix20210518:43][MainThread] Applied qi patch
2021-05-18 14:07:24,372 INFO    [Products.PloneHotfix20210518:43][MainThread] Applied supermodel patch
2021-05-18 14:07:24,500 INFO    [Products.PloneHotfix20210518:43][MainThread] Applied theming patch
2021-05-18 14:07:24,634 INFO    [Products.PloneHotfix20210518:43][MainThread] Applied transforms patch
2021-05-18 14:07:24,634 INFO    [Products.PloneHotfix20210518:51][MainThread] Hotfix installed

```

The exact number of patches applied, will differ depending on what packages you are using.
If a patch is attempted but fails, it will be logged as an error that says
"Could not apply". This may indicate that you have a non-standard Plone
installation. Please investigate, and mail us the accompanying traceback if you think it is a problem in the hotfix.

Q: How can I report problems installing the patch?
A: Contact the Plone security team at security@plone.org or visit the
Gitter channel at <https://gitter.im/plone/public> and the forum at <https://community.plone.org>
Q: How can I report other potential security vulnerabilities?
A: Please email the security team at security@plone.org rather than discussing
potential security issues publicly.

## About

No description, website, or topics provided.
### Resources

[Readme](#readme-ov-file)
### Code of conduct

[Code of conduct](#coc-ov-file)
### Security policy

[Security policy](#security-ov-file)

[Activity](/plone/Products.PloneHotfix20210518/activity)
[Custom properties](/plone/Products.PloneHotfix20210518/custom-properties)
### Stars

[**0**
stars](/plone/Products.PloneHotfix20210518/stargazers)
### Watchers

[**216**
watching](/plone/Products.PloneHotfix20210518/watchers)
### Forks

[**0**
forks](/plone/Products.PloneHotfix20210518/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fplone%2FProducts.PloneHotfix20210518&report=plone+%28user%29)

## [Releases](/plone/Products.PloneHotfix20210518/releases)

[1
tags](/plone/Products.PloneHotfix20210518/tags)

## Sponsor this project

 Sponsor

[Learn more about GitHub Sponsors](/sponsors)

## [Packages 0](/orgs/plone/packages?repo_name=Products.PloneHotfix20210518)

No packages published

## Languages

* [Python
  100.0%](/plone/Products.PloneHotfix20210518/search?l=python)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

