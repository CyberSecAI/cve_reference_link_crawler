Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**
- The vulnerability stems from a failure to properly sanitize user-supplied input within the SSL VPN web portal's error handling mechanism. Specifically, GET parameters in requests to the error page are not sanitized.

**Weaknesses/Vulnerabilities:**
- **Reflected Cross-Site Scripting (XSS):** The lack of input sanitization allows an attacker to inject malicious scripts into the error page's response.

**Impact of Exploitation:**
- **Execute unauthorized code or commands:** By injecting malicious JavaScript, an attacker could potentially execute arbitrary code within the user's browser session. This could lead to session hijacking, data theft, or other malicious activities.

**Attack Vectors:**
- **Network:** The attack is carried out over the network by sending a crafted request to the vulnerable SSL VPN web portal.
- **Unauthenticated Remote Attacker:** The attacker does not need to have valid user credentials for the Fortigate portal, making this an unauthenticated remote vulnerability.

**Required Attacker Capabilities/Position:**
- The attacker needs the ability to send HTTP requests to the vulnerable FortiGate or FortiProxy instance. They do not need access to the internal network or have any special privileges.
- The attacker must be able to craft an HTTP request with malicious GET parameters that will be reflected in the error page's response.
- Victim needs to interact with the malicious link by visiting the crafted URL.

**Affected Products:**
- FortiGate versions 5.6.13 and below.
- FortiProxy versions 2.0.2 and below.
- FortiProxy versions 1.2.10 and below.
- Specific high-end F-Series FortiGate models (FG-1800F, FG-3800F, FG-4200F, FG-4400F) require upgrade to 6.2.9.

**Patched Versions:**
- FortiGate versions 6.0.13 or above
- FortiGate versions 6.2.8 or above
- FortiGate versions 6.4.6 or above
- FortiGate versions 7.0.0 or above
- FortiProxy version 2.0.2 or above
- FortiProxy version 1.2.10 or above