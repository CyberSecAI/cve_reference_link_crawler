        [Docs](/docs)          Search Apollo content (Cmd+K or /)             [Launch GraphOS Studio](https://studio.apollographql.com/signup?referrer=docs)        [Home Home](/docs/)  [Get Started Get Started](/docs/graphos/get-started)  [GraphOS Platform GraphOS Platform](/docs/graphos/platform)  [Schema Design Schema Design](/docs/graphos/schema-design)  [Routing Routing](/docs/graphos/routing)  [Reference Reference](/docs/graphos/reference)      Developer Tools Developer Tools          [Rover CLI](https://www.apollographql.com/docs/rover)[Apollo Sandbox](https://www.apollographql.com/docs/apollo-sandbox)[Apollo Client (Web)](https://www.apollographql.com/docs/react)[Apollo iOS](https://www.apollographql.com/docs/ios)[Apollo Kotlin](https://www.apollographql.com/docs/kotlin)[Apollo Server](https://www.apollographql.com/docs/apollo-server)[Apollo Router Core](https://github.com/apollographql/router)[VS Code Extension](https://www.apollographql.com/docs/vs-code-extension)                     [Overview](https://www.apollographql.com/docs/graphos/routing)[About GraphOS Router](https://www.apollographql.com/docs/graphos/routing/about-router)[Configure Your Router](https://www.apollographql.com/docs/graphos/routing/configure-your-router)
### Cloud Routing

[Overview](https://www.apollographql.com/docs/graphos/routing/cloud)[Configuration](https://www.apollographql.com/docs/graphos/routing/cloud/configuration)[Secure Subgraphs](https://www.apollographql.com/docs/graphos/routing/cloud/secure-subgraphs)[Subscriptions](https://www.apollographql.com/docs/graphos/routing/cloud/subscriptions)[Serverless](https://www.apollographql.com/docs/graphos/routing/cloud/serverless)
### Dedicated

[Overview](https://www.apollographql.com/docs/graphos/routing/cloud/dedicated)[Quickstart](https://www.apollographql.com/docs/graphos/routing/cloud/dedicated-quickstart)[Custom Domains](https://www.apollographql.com/docs/graphos/routing/cloud/custom-domains)[Throughput Guide](https://www.apollographql.com/docs/graphos/routing/cloud/throughput-guide)[Migrate to Dedicated](https://www.apollographql.com/docs/graphos/routing/cloud/migrate-to-dedicated)
### AWS Lattice

[Lattice Configuration](https://www.apollographql.com/docs/graphos/routing/cloud/lattice-configuration)[Lattice Management](https://www.apollographql.com/docs/graphos/routing/cloud/lattice-management)[Lattice Troubleshooting](https://www.apollographql.com/docs/graphos/routing/cloud/lattice-troubleshooting)
### Self-Hosted Deployment

[Overview](https://www.apollographql.com/docs/graphos/routing/self-hosted)[Router Resource Estimator](https://www.apollographql.com/docs/graphos/routing/self-hosted/resource-estimator)[Health Checks](https://www.apollographql.com/docs/graphos/routing/self-hosted/health-checks)[Resource Management](https://www.apollographql.com/docs/graphos/routing/self-hosted/resource-management)
### Containerization

[Overview](https://www.apollographql.com/docs/graphos/routing/self-hosted/containerization)[Docker](https://www.apollographql.com/docs/graphos/routing/self-hosted/containerization/docker)[Kubernetes](https://www.apollographql.com/docs/graphos/routing/self-hosted/containerization/kubernetes)[Optimize Builds](https://www.apollographql.com/docs/graphos/routing/self-hosted/containerization/optimize-build)
### Query Planning

[Native Query Planner](https://www.apollographql.com/docs/graphos/routing/query-planning/native-query-planner)
### Client Features

[HTTP Header Propagation](https://www.apollographql.com/docs/graphos/routing/header-propagation)[File Upload Support](https://www.apollographql.com/docs/graphos/routing/operations/file-upload)
### Real-Time Operations

[Overview](https://www.apollographql.com/docs/graphos/routing/operations)[Defer Support](https://www.apollographql.com/docs/graphos/routing/operations/defer)
### Subscription Support

[Overview](https://www.apollographql.com/docs/graphos/routing/operations/subscriptions)[Callback Protocol](https://www.apollographql.com/docs/graphos/routing/operations/subscriptions/callback-protocol)[Multipart Protocol](https://www.apollographql.com/docs/graphos/routing/operations/subscriptions/multipart-protocol)[Enable with API Gateway](https://www.apollographql.com/docs/graphos/routing/operations/subscriptions/api-gateway)
### Security

[Overview](https://www.apollographql.com/docs/graphos/routing/security)[Persisted Queries](https://www.apollographql.com/docs/graphos/routing/security/persisted-queries)[Authorization](https://www.apollographql.com/docs/graphos/routing/security/authorization)
### Authentication

[JWT Authentication](https://www.apollographql.com/docs/graphos/routing/security/jwt)[Router Authentication](https://www.apollographql.com/docs/graphos/routing/security/router-authentication)[Subgraph Authentication](https://www.apollographql.com/docs/graphos/routing/security/subgraph-authentication)
### Operations Security

[Request Limits](https://www.apollographql.com/docs/graphos/routing/security/request-limits)[Demand Control](https://www.apollographql.com/docs/graphos/routing/security/demand-control)
### Web Security

[CORS](https://www.apollographql.com/docs/graphos/routing/security/cors)[CSRF Prevention](https://www.apollographql.com/docs/graphos/routing/security/csrf)
### Performance and Scaling

[Overview](https://www.apollographql.com/docs/graphos/routing/performance)[Traffic Shaping](https://www.apollographql.com/docs/graphos/routing/performance/traffic-shaping)[Query Batching](https://www.apollographql.com/docs/graphos/routing/performance/query-batching)[Query Planner Pools](https://www.apollographql.com/docs/graphos/routing/performance/query-planner-pools)
### Caching

[In-Memory Caching](https://www.apollographql.com/docs/graphos/routing/performance/caching/in-memory)[Distributed Caching](https://www.apollographql.com/docs/graphos/routing/performance/caching/distributed)[Entity Caching](https://www.apollographql.com/docs/graphos/routing/performance/caching/entity)
### Router Customization

[Router Request Lifecycle](https://www.apollographql.com/docs/graphos/routing/customization/overview)[Rhai Scripts](https://www.apollographql.com/docs/graphos/routing/customization/rhai)[Rust Plugins](https://www.apollographql.com/docs/graphos/routing/customization/native-plugins)[Coprocessors](https://www.apollographql.com/docs/graphos/routing/customization/coprocessor)[Custom Binaries](https://www.apollographql.com/docs/graphos/routing/customization/custom-binary)
### GraphOS Integration

[Apollo Uplink](https://www.apollographql.com/docs/graphos/routing/uplink)[Operation Metrics Reporting](https://www.apollographql.com/docs/graphos/routing/graphos-reporting)
### Observability

[Overview](https://www.apollographql.com/docs/graphos/routing/observability)[Router Telemetry](https://www.apollographql.com/docs/graphos/routing/observability/telemetry)[Federated Trace Data](https://www.apollographql.com/docs/graphos/routing/observability/federated-trace-data)
### Subgraph Observability

[Subgraph Error Inclusion](https://www.apollographql.com/docs/graphos/routing/observability/subgraph-error-inclusion)[Opt-in Error Reporting](https://www.apollographql.com/docs/graphos/routing/observability/error-reporting)[Debugging Subgraph Requests](https://www.apollographql.com/docs/graphos/routing/observability/debugging-subgraph-requests)
### Client Observability

[Client ID Enforcement](https://www.apollographql.com/docs/graphos/routing/observability/client-id-enforcement)
### OpenTelemetry

[Set up OTel](https://www.apollographql.com/docs/graphos/routing/observability/otel)[Connect OTel to Prometheus](https://www.apollographql.com/docs/graphos/routing/observability/otel-traces-to-prometheus)
### Guides

[API Gateway Comparison](https://www.apollographql.com/docs/graphos/routing/router-api-gateway-comparison)Navigation controls
## Get Started

[Overview](https://www.apollographql.com/docs/graphos/get-started)
### Quickstarts

[Start with a GraphQL API](https://www.apollographql.com/docs/graphos/get-started/guides/quickstart)[Connect a REST API](https://www.apollographql.com/docs/graphos/get-started/guides/rest-quickstart)
### Concepts

[GraphQL](https://www.apollographql.com/docs/graphos/get-started/concepts/graphql)[Graph Types](https://www.apollographql.com/docs/graphos/get-started/concepts/graphs)[GraphOS Platform](https://www.apollographql.com/docs/graphos/get-started/concepts/graphos)
## GraphOS Platform

[Overview](https://www.apollographql.com/docs/graphos/platform)
### Schema Management

[Overview](https://www.apollographql.com/docs/graphos/platform/schema-management)
### Schema Delivery

[Publish](https://www.apollographql.com/docs/graphos/platform/schema-management/delivery/publish)[Launch](https://www.apollographql.com/docs/graphos/platform/schema-management/delivery/launch)
### Contracts

[Overview](https://www.apollographql.com/docs/graphos/platform/schema-management/delivery/contracts/overview)[Create](https://www.apollographql.com/docs/graphos/platform/schema-management/delivery/contracts/create)[Usage Patterns](https://www.apollographql.com/docs/graphos/platform/schema-management/delivery/contracts/usage-patterns)[Reference](https://www.apollographql.com/docs/graphos/platform/schema-management/delivery/contracts/reference)
### Schema Checks

[Overview](https://www.apollographql.com/docs/graphos/platform/schema-management/checks)[Run Checks](https://www.apollographql.com/docs/graphos/platform/schema-management/checks/run)[Custom Checks](https://www.apollographql.com/docs/graphos/platform/schema-management/checks/custom)[Checks Configuration](https://www.apollographql.com/docs/graphos/platform/schema-management/checks/configure)[GitHub Integration](https://www.apollographql.com/docs/graphos/platform/schema-management/checks/github-integration)[Checks Reference](https://www.apollographql.com/docs/graphos/platform/schema-management/checks/reference)
### Schema Linting

[Overview](https://www.apollographql.com/docs/graphos/platform/schema-management/linting)[Linter Rules](https://www.apollographql.com/docs/graphos/platform/schema-management/linting/rules)
### Schema Proposals

[Overview](https://www.apollographql.com/docs/graphos/platform/schema-management/proposals)[Configure](https://www.apollographql.com/docs/graphos/platform/schema-management/proposals/configure)[Create](https://www.apollographql.com/docs/graphos/platform/schema-management/proposals/create)[Review](https://www.apollographql.com/docs/graphos/platform/schema-management/proposals/review)[Implement](https://www.apollographql.com/docs/graphos/platform/schema-management/proposals/implement)
### Explorer IDE

[Overview](https://www.apollographql.com/docs/graphos/platform/explorer)[Connect and Authenticate](https://www.apollographql.com/docs/graphos/platform/explorer/connect)[Operation Collections](https://www.apollographql.com/docs/graphos/platform/explorer/operation-collections)[Subscription Support](https://www.apollographql.com/docs/graphos/platform/explorer/subscription-support)[Embed](https://www.apollographql.com/docs/graphos/platform/explorer/embed)[Scripting](https://www.apollographql.com/docs/graphos/platform/explorer/scripting)[Additional Features](https://www.apollographql.com/docs/graphos/platform/explorer/additional-features)
### Graph Security

[Overview](https://www.apollographql.com/docs/graphos/platform/security/overview)[Persisted Queries](https://www.apollographql.com/docs/graphos/platform/security/persisted-queries)
### Metrics and Insights

[Overview](https://www.apollographql.com/docs/graphos/platform/insights)
### Metrics Collection and Forwarding

[Sending Metrics to GraphOS](https://www.apollographql.com/docs/graphos/platform/insights/sending-operation-metrics)[Operation Signatures](https://www.apollographql.com/docs/graphos/platform/insights/operation-signatures)[Datadog Forwarding](https://www.apollographql.com/docs/graphos/platform/insights/datadog-forwarding)
### Insights and Analysis

[Operation Metrics](https://www.apollographql.com/docs/graphos/platform/insights/operation-metrics)[Field Usage](https://www.apollographql.com/docs/graphos/platform/insights/field-usage)[Segmenting by Client](https://www.apollographql.com/docs/graphos/platform/insights/client-segmentation)
### Notifications and Alerts

[Overview](https://www.apollographql.com/docs/graphos/platform/insights/notifications)[Daily Reports](https://www.apollographql.com/docs/graphos/platform/insights/notifications/daily-reports)[Schema Changes](https://www.apollographql.com/docs/graphos/platform/insights/notifications/schema-changes)[Schema Proposals](https://www.apollographql.com/docs/graphos/platform/insights/notifications/schema-proposals)[Performance Alerts](https://www.apollographql.com/docs/graphos/platform/insights/notifications/performance-alerts)[Build Status](https://www.apollographql.com/docs/graphos/platform/insights/notifications/build-status)
### Access Management

[Organizations](https://www.apollographql.com/docs/graphos/platform/access-management/org)[API Keys](https://www.apollographql.com/docs/graphos/platform/access-management/api-keys)[Members, Roles, and Permissions](https://www.apollographql.com/docs/graphos/platform/access-management/member-roles)[Audit Logs](https://www.apollographql.com/docs/graphos/platform/access-management/audit-log)
### SSO

[Overview](https://www.apollographql.com/docs/graphos/platform/access-management/sso/overview)[Multi-Organization](https://www.apollographql.com/docs/graphos/platform/access-management/sso/multi-organization)
### SAML

[Okta](https://www.apollographql.com/docs/graphos/platform/access-management/sso/saml-okta)[Microsoft Entra ID](https://www.apollographql.com/docs/graphos/platform/access-management/sso/saml-microsoft-entra-id)[Generic SAML Setup](https://www.apollographql.com/docs/graphos/platform/access-management/sso/saml-integration-guide)
### OIDC

[Okta](https://www.apollographql.com/docs/graphos/platform/access-management/sso/oidc-okta)[Microsoft Entra ID](https://www.apollographql.com/docs/graphos/platform/access-management/sso/oidc-microsoft-entra-id)[Generic OIDC Setup](https://www.apollographql.com/docs/graphos/platform/access-management/sso/oidc-integration-guide)
### Graph Management

[Using Variants](https://www.apollographql.com/docs/graphos/platform/graph-management/variants)[Adding Subgraphs](https://www.apollographql.com/docs/graphos/platform/graph-management/add-subgraphs)[Managing Subgraphs](https://www.apollographql.com/docs/graphos/platform/graph-management/manage-subgraphs)[Updating Graph Components](https://www.apollographql.com/docs/graphos/platform/graph-management/updates)
### Production Readiness

[Production Readiness Checklist](https://www.apollographql.com/docs/graphos/platform/production-readiness/checklist)
### Testing and Load Management

[Overload Protection](https://www.apollographql.com/docs/graphos/platform/production-readiness/overload-protection)[Load Testing](https://www.apollographql.com/docs/graphos/platform/production-readiness/load-testing)[Testing with Federation](https://www.apollographql.com/docs/graphos/platform/production-readiness/testing-with-apollo-federation)
### Environment and Deployment

[Environment Best Practices](https://www.apollographql.com/docs/graphos/platform/production-readiness/environment-best-practices)[Schema Change Management](https://www.apollographql.com/docs/graphos/platform/production-readiness/change-management)[Updating Client Schema](https://www.apollographql.com/docs/graphos/platform/production-readiness/updating-client-schema)[Deployment Best Practices](https://www.apollographql.com/docs/graphos/platform/production-readiness/deployment-best-practices)[GraphOS Platform API](https://www.apollographql.com/docs/graphos/platform/platform-api)
## Schema Design

[Overview](https://www.apollographql.com/docs/graphos/schema-design)
### Federated Schemas

[Apollo Federation](https://www.apollographql.com/docs/graphos/schema-design/federated-schemas/federation)[Schema Types](https://www.apollographql.com/docs/graphos/schema-design/federated-schemas/schema-types)[Schema Composition](https://www.apollographql.com/docs/graphos/schema-design/federated-schemas/composition)[Sharing Types (Value Types)](https://www.apollographql.com/docs/graphos/schema-design/federated-schemas/sharing-types)[IDE Support](https://www.apollographql.com/docs/graphos/schema-design/federated-schemas/ide-support)
### Entities

[Introduction](https://www.apollographql.com/docs/graphos/schema-design/federated-schemas/entities/intro)[Define Keys](https://www.apollographql.com/docs/graphos/schema-design/federated-schemas/entities/define-keys)[Contribute Fields](https://www.apollographql.com/docs/graphos/schema-design/federated-schemas/entities/contribute-fields)[Resolve Another Subgraph's Fields](https://www.apollographql.com/docs/graphos/schema-design/federated-schemas/entities/resolve-another-subgraphs-fields)[Use Contexts](https://www.apollographql.com/docs/graphos/schema-design/federated-schemas/entities/use-contexts)[Interfaces](https://www.apollographql.com/docs/graphos/schema-design/federated-schemas/entities/interfaces)[Migrate Fields](https://www.apollographql.com/docs/graphos/schema-design/federated-schemas/entities/migrate-fields)[Enforce Ownership](https://www.apollographql.com/docs/graphos/schema-design/federated-schemas/entities/enforce-ownership)[Entity Best Practices](https://www.apollographql.com/docs/graphos/schema-design/federated-schemas/entities/best-practices)
### Apollo Connectors

[Overview](https://www.apollographql.com/docs/graphos/schema-design/connectors)[Common Patterns](https://www.apollographql.com/docs/graphos/schema-design/connectors/guides)
### Connectors Guides

[Making HTTP Requests](https://www.apollographql.com/docs/graphos/schema-design/connectors/http)[Working with Federation](https://www.apollographql.com/docs/graphos/schema-design/connectors/federation)[Working with Router](https://www.apollographql.com/docs/graphos/schema-design/connectors/router)[Selection Mapping](https://www.apollographql.com/docs/graphos/schema-design/connectors/selection)[Observability](https://www.apollographql.com/docs/graphos/schema-design/connectors/observability)[Troubleshooting](https://www.apollographql.com/docs/graphos/schema-design/connectors/troubleshooting)
### IDE Support

[Visual Studio Code](https://www.apollographql.com/docs/graphos/schema-design/connectors/vs-code)[Vim/NeoVim](https://www.apollographql.com/docs/graphos/schema-design/connectors/vim)
### Connectors Reference

[Directives](https://www.apollographql.com/docs/graphos/schema-design/connectors/directives)[Limitations](https://www.apollographql.com/docs/graphos/schema-design/connectors/limitations)[Changelog](https://www.apollographql.com/docs/graphos/schema-design/connectors/changelog)
### Schema Design Guides

[Handling the N+1 Problem](https://www.apollographql.com/docs/graphos/schema-design/guides/handling-n-plus-one)
### Schema Design Principles

[Schema Naming Conventions](https://www.apollographql.com/docs/graphos/schema-design/guides/naming-conventions)[Namespacing](https://www.apollographql.com/docs/graphos/schema-design/guides/namespacing-by-separation-of-concerns)[Mocking to Unblock Development](https://www.apollographql.com/docs/graphos/schema-design/guides/mocking)[Demand Oriented Schema Design](https://www.apollographql.com/docs/graphos/schema-design/guides/demand-oriented-schema-design)[Aggregating Data](https://www.apollographql.com/docs/graphos/schema-design/guides/aggregating-data-across-subgraphs)[Nullability](https://www.apollographql.com/docs/graphos/schema-design/guides/nullability)[Errors as Data](https://www.apollographql.com/docs/graphos/schema-design/guides/errors-as-data-explained)[Deprecations](https://www.apollographql.com/docs/graphos/schema-design/guides/deprecations)
### Advanced Schema Techniques

[Interfaces](https://www.apollographql.com/docs/graphos/schema-design/guides/interfaces)[Response Type Pattern](https://www.apollographql.com/docs/graphos/schema-design/guides/response-type-pattern)[Graph Identities](https://www.apollographql.com/docs/graphos/schema-design/guides/graph-identities)[Relay Style Connections and Pagination](https://www.apollographql.com/docs/graphos/schema-design/guides/relay-style-connections)[Distributed Orchestration](https://www.apollographql.com/docs/graphos/schema-design/guides/distributed-orchestration)
## Routing

[Overview](https://www.apollographql.com/docs/graphos/routing)[About GraphOS Router](https://www.apollographql.com/docs/graphos/routing/about-router)[Configure Your Router](https://www.apollographql.com/docs/graphos/routing/configure-your-router)
### Cloud Routing

[Overview](https://www.apollographql.com/docs/graphos/routing/cloud)[Configuration](https://www.apollographql.com/docs/graphos/routing/cloud/configuration)[Secure Subgraphs](https://www.apollographql.com/docs/graphos/routing/cloud/secure-subgraphs)[Subscriptions](https://www.apollographql.com/docs/graphos/routing/cloud/subscriptions)[Serverless](https://www.apollographql.com/docs/graphos/routing/cloud/serverless)
### Dedicated

[Overview](https://www.apollographql.com/docs/graphos/routing/cloud/dedicated)[Quickstart](https://www.apollographql.com/docs/graphos/routing/cloud/dedicated-quickstart)[Custom Domains](https://www.apollographql.com/docs/graphos/routing/cloud/custom-domains)[Throughput Guide](https://www.apollographql.com/docs/graphos/routing/cloud/throughput-guide)[Migrate to Dedicated](https://www.apollographql.com/docs/graphos/routing/cloud/migrate-to-dedicated)
### AWS Lattice

[Lattice Configuration](https://www.apollographql.com/docs/graphos/routing/cloud/lattice-configuration)[Lattice Management](https://www.apollographql.com/docs/graphos/routing/cloud/lattice-management)[Lattice Troubleshooting](https://www.apollographql.com/docs/graphos/routing/cloud/lattice-troubleshooting)
### Self-Hosted Deployment

[Overview](https://www.apollographql.com/docs/graphos/routing/self-hosted)[Router Resource Estimator](https://www.apollographql.com/docs/graphos/routing/self-hosted/resource-estimator)[Health Checks](https://www.apollographql.com/docs/graphos/routing/self-hosted/health-checks)[Resource Management](https://www.apollographql.com/docs/graphos/routing/self-hosted/resource-management)
### Containerization

[Overview](https://www.apollographql.com/docs/graphos/routing/self-hosted/containerization)[Docker](https://www.apollographql.com/docs/graphos/routing/self-hosted/containerization/docker)[Kubernetes](https://www.apollographql.com/docs/graphos/routing/self-hosted/containerization/kubernetes)[Optimize Builds](https://www.apollographql.com/docs/graphos/routing/self-hosted/containerization/optimize-build)
### Query Planning

[Native Query Planner](https://www.apollographql.com/docs/graphos/routing/query-planning/native-query-planner)
### Client Features

[HTTP Header Propagation](https://www.apollographql.com/docs/graphos/routing/header-propagation)[File Upload Support](https://www.apollographql.com/docs/graphos/routing/operations/file-upload)
### Real-Time Operations

[Overview](https://www.apollographql.com/docs/graphos/routing/operations)[Defer Support](https://www.apollographql.com/docs/graphos/routing/operations/defer)
### Subscription Support

[Overview](https://www.apollographql.com/docs/graphos/routing/operations/subscriptions)[Callback Protocol](https://www.apollographql.com/docs/graphos/routing/operations/subscriptions/callback-protocol)[Multipart Protocol](https://www.apollographql.com/docs/graphos/routing/operations/subscriptions/multipart-protocol)[Enable with API Gateway](https://www.apollographql.com/docs/graphos/routing/operations/subscriptions/api-gateway)
### Security

[Overview](https://www.apollographql.com/docs/graphos/routing/security)[Persisted Queries](https://www.apollographql.com/docs/graphos/routing/security/persisted-queries)[Authorization](https://www.apollographql.com/docs/graphos/routing/security/authorization)
### Authentication

[JWT Authentication](https://www.apollographql.com/docs/graphos/routing/security/jwt)[Router Authentication](https://www.apollographql.com/docs/graphos/routing/security/router-authentication)[Subgraph Authentication](https://www.apollographql.com/docs/graphos/routing/security/subgraph-authentication)
### Operations Security

[Request Limits](https://www.apollographql.com/docs/graphos/routing/security/request-limits)[Demand Control](https://www.apollographql.com/docs/graphos/routing/security/demand-control)
### Web Security

[CORS](https://www.apollographql.com/docs/graphos/routing/security/cors)[CSRF Prevention](https://www.apollographql.com/docs/graphos/routing/security/csrf)
### Performance and Scaling

[Overview](https://www.apollographql.com/docs/graphos/routing/performance)[Traffic Shaping](https://www.apollographql.com/docs/graphos/routing/performance/traffic-shaping)[Query Batching](https://www.apollographql.com/docs/graphos/routing/performance/query-batching)[Query Planner Pools](https://www.apollographql.com/docs/graphos/routing/performance/query-planner-pools)
### Caching

[In-Memory Caching](https://www.apollographql.com/docs/graphos/routing/performance/caching/in-memory)[Distributed Caching](https://www.apollographql.com/docs/graphos/routing/performance/caching/distributed)[Entity Caching](https://www.apollographql.com/docs/graphos/routing/performance/caching/entity)
### Router Customization

[Router Request Lifecycle](https://www.apollographql.com/docs/graphos/routing/customization/overview)[Rhai Scripts](https://www.apollographql.com/docs/graphos/routing/customization/rhai)[Rust Plugins](https://www.apollographql.com/docs/graphos/routing/customization/native-plugins)[Coprocessors](https://www.apollographql.com/docs/graphos/routing/customization/coprocessor)[Custom Binaries](https://www.apollographql.com/docs/graphos/routing/customization/custom-binary)
### GraphOS Integration

[Apollo Uplink](https://www.apollographql.com/docs/graphos/routing/uplink)[Operation Metrics Reporting](https://www.apollographql.com/docs/graphos/routing/graphos-reporting)
### Observability

[Overview](https://www.apollographql.com/docs/graphos/routing/observability)[Router Telemetry](https://www.apollographql.com/docs/graphos/routing/observability/telemetry)[Federated Trace Data](https://www.apollographql.com/docs/graphos/routing/observability/federated-trace-data)
### Subgraph Observability

[Subgraph Error Inclusion](https://www.apollographql.com/docs/graphos/routing/observability/subgraph-error-inclusion)[Opt-in Error Reporting](https://www.apollographql.com/docs/graphos/routing/observability/error-reporting)[Debugging Subgraph Requests](https://www.apollographql.com/docs/graphos/routing/observability/debugging-subgraph-requests)
### Client Observability

[Client ID Enforcement](https://www.apollographql.com/docs/graphos/routing/observability/client-id-enforcement)
### OpenTelemetry

[Set up OTel](https://www.apollographql.com/docs/graphos/routing/observability/otel)[Connect OTel to Prometheus](https://www.apollographql.com/docs/graphos/routing/observability/otel-traces-to-prometheus)
### Guides

[API Gateway Comparison](https://www.apollographql.com/docs/graphos/routing/router-api-gateway-comparison)
## Reference

[Overview](https://www.apollographql.com/docs/graphos/reference)[Changelogs](https://www.apollographql.com/docs/graphos/reference/changelog)[Glossary](https://www.apollographql.com/docs/graphos/reference/glossary)[Examples and Resources](https://www.apollographql.com/docs/graphos/reference/solutions)
### Release Policies

[Apollo Feature Launch Stages](https://www.apollographql.com/docs/graphos/reference/feature-launch-stages)[GraphOS Router Release Lifecycle](https://www.apollographql.com/docs/graphos/reference/router-release-lifecycle)[Apollo Client Library Release Lifecycle](https://www.apollographql.com/docs/graphos/reference/client-library-release-lifecycle)
### Architecture

[Reference Architecture](https://www.apollographql.com/docs/graphos/reference/architecture)
### Supergraph Architecture Framework

[Overview](https://www.apollographql.com/docs/graphos/reference/saf)[Operational Excellence](https://www.apollographql.com/docs/graphos/reference/saf/operational-excellence)[Security](https://www.apollographql.com/docs/graphos/reference/saf/security)[Reliability](https://www.apollographql.com/docs/graphos/reference/saf/reliability)[Performance](https://www.apollographql.com/docs/graphos/reference/saf/performance)[Developer Experience](https://www.apollographql.com/docs/graphos/reference/saf/developer-experience)
### Federation Reference

[Federation Versions](https://www.apollographql.com/docs/graphos/reference/federation/versions)[Federated Directives](https://www.apollographql.com/docs/graphos/reference/federation/directives)[Composition Rules](https://www.apollographql.com/docs/graphos/reference/federation/composition-rules)
### Subgraph Reference

[Federation Subgraphs Specification](https://www.apollographql.com/docs/graphos/reference/federation/subgraph-spec)[Subgraph Specific Fields](https://www.apollographql.com/docs/graphos/reference/federation/subgraph-specific-fields)[Compatible Subgraph Libraries](https://www.apollographql.com/docs/graphos/reference/federation/compatible-subgraphs)
### Development and Debugging

[Query Plans](https://www.apollographql.com/docs/graphos/reference/federation/query-plans)[Composition Hints](https://www.apollographql.com/docs/graphos/reference/federation/hints)[Errors](https://www.apollographql.com/docs/graphos/reference/federation/errors)[Federation v1](https://www.apollographql.com/docs/graphos/reference/federation/v1)
### Router Reference

[Self-Hosted Installation](https://www.apollographql.com/docs/graphos/reference/router/self-hosted-install)[Configuration](https://www.apollographql.com/docs/graphos/reference/router/configuration)[GraphOS Router Features](https://www.apollographql.com/docs/graphos/reference/router/graphos-features)[Rhai API](https://www.apollographql.com/docs/graphos/reference/router/rhai)[Federation Version Support](https://www.apollographql.com/docs/graphos/reference/router/federation-version-support)[Errors](https://www.apollographql.com/docs/graphos/reference/router/errors)
### Router Telemetry

### Log Exporters

[Overview](https://www.apollographql.com/docs/graphos/reference/router/telemetry/log-exporters/overview)[Stdout](https://www.apollographql.com/docs/graphos/reference/router/telemetry/log-exporters/stdout)
### Metrics Exporters

[Overview](https://www.apollographql.com/docs/graphos/reference/router/telemetry/metrics-exporters/overview)[Datadog](https://www.apollographql.com/docs/graphos/reference/router/telemetry/metrics-exporters/datadog)[Dynatrace](https://www.apollographql.com/docs/graphos/reference/router/telemetry/metrics-exporters/dynatrace)[New Relic](https://www.apollographql.com/docs/graphos/reference/router/telemetry/metrics-exporters/new-relic)[OTLP](https://www.apollographql.com/docs/graphos/reference/router/telemetry/metrics-exporters/otlp)[Prometheus](https://www.apollographql.com/docs/graphos/reference/router/telemetry/metrics-exporters/prometheus)
### Trace Exporters

[Overview](https://www.apollographql.com/docs/graphos/reference/router/telemetry/trace-exporters/overview)[Datadog](https://www.apollographql.com/docs/graphos/reference/router/telemetry/trace-exporters/datadog)[Dynatrace](https://www.apollographql.com/docs/graphos/reference/router/telemetry/trace-exporters/dynatrace)[Jaeger](https://www.apollographql.com/docs/graphos/reference/router/telemetry/trace-exporters/jaeger)[New Relic](https://www.apollographql.com/docs/graphos/reference/router/telemetry/trace-exporters/new-relic)[OTLP](https://www.apollographql.com/docs/graphos/reference/router/telemetry/trace-exporters/otlp)[Zipkin](https://www.apollographql.com/docs/graphos/reference/router/telemetry/trace-exporters/zipkin)
### Instrumentation

[Instruments](https://www.apollographql.com/docs/graphos/reference/router/telemetry/instrumentation/instruments)[Events](https://www.apollographql.com/docs/graphos/reference/router/telemetry/instrumentation/events)[Conditions](https://www.apollographql.com/docs/graphos/reference/router/telemetry/instrumentation/conditions)[Spans](https://www.apollographql.com/docs/graphos/reference/router/telemetry/instrumentation/spans)[Selectors](https://www.apollographql.com/docs/graphos/reference/router/telemetry/instrumentation/selectors)[Standard Attributes](https://www.apollographql.com/docs/graphos/reference/router/telemetry/instrumentation/standard-attributes)[Standard Instruments](https://www.apollographql.com/docs/graphos/reference/router/telemetry/instrumentation/standard-instruments)
### Migration Guides

[From Router v1.x to v2.x](https://www.apollographql.com/docs/graphos/reference/migration/from-router-v1)[From Router v0.x to v1.x](https://www.apollographql.com/docs/graphos/reference/migration/from-router-version-0.x)[From @apollo/gateway to Router](https://www.apollographql.com/docs/graphos/reference/migration/from-gateway)[From Federation 1 to 2](https://www.apollographql.com/docs/graphos/reference/migration/to-federation-version-2)[Federation 2 Backwards Compatibility](https://www.apollographql.com/docs/graphos/reference/migration/backward-compatibility)[From a Monolith](https://www.apollographql.com/docs/graphos/reference/migration/from-monolith)[From Schema Stitching](https://www.apollographql.com/docs/graphos/reference/migration/from-schema-stitching)
### GraphQL Adoption Guides

[GraphQL Adoption Patterns](https://www.apollographql.com/docs/graphos/reference/guides/graphql-adoption-patterns)[Using GraphQL for Abstraction](https://www.apollographql.com/docs/graphos/reference/guides/using-graphql-for-abstraction)[Supergraph Stewardship](https://www.apollographql.com/docs/graphos/reference/guides/supergraph-stewardship)
## Rover CLI

[Overview](https://www.apollographql.com/docs/rover)[Install](https://www.apollographql.com/docs/rover/getting-started)[Configure](https://www.apollographql.com/docs/rover/configuring)[Proxy Configuration](https://www.apollographql.com/docs/rover/proxy)[CI/CD](https://www.apollographql.com/docs/rover/ci-cd)[Conventions](https://www.apollographql.com/docs/rover/conventions)[Privacy and Data Collection](https://www.apollographql.com/docs/rover/privacy)[Contributing](https://www.apollographql.com/docs/rover/contributing)[Error Codes](https://www.apollographql.com/docs/rover/errors)
### Commands

[cloud](https://www.apollographql.com/docs/rover/commands/cloud)[config](https://www.apollographql.com/docs/rover/commands/config)[contract](https://www.apollographql.com/docs/rover/commands/contracts)[dev](https://www.apollographql.com/docs/rover/commands/dev)[explain](https://www.apollographql.com/docs/rover/commands/explain)[graph](https://www.apollographql.com/docs/rover/commands/graphs)[license](https://www.apollographql.com/docs/rover/commands/license)[persisted-queries](https://www.apollographql.com/docs/rover/commands/persisted-queries)[readme](https://www.apollographql.com/docs/rover/commands/readmes)[subgraph](https://www.apollographql.com/docs/rover/commands/subgraphs)[supergraph](https://www.apollographql.com/docs/rover/commands/supergraphs)[template](https://www.apollographql.com/docs/rover/commands/template)
### The Apollo CLI (deprecated)

[Installation](https://www.apollographql.com/docs/rover/apollo-cli)[Validating Client Operations](https://www.apollographql.com/docs/rover/validating-client-operations)[Moving to Rover](https://www.apollographql.com/docs/rover/migration)
## Apollo Sandbox

[Overview](https://www.apollographql.com/docs/apollo-sandbox)
## Apollo Client (Web)

Apollo Client (Web) - v3 (latest)[Introduction](https://www.apollographql.com/docs/react)[Why Apollo Client?](https://www.apollographql.com/docs/react/why-apollo)[Get started](https://www.apollographql.com/docs/react/get-started)[Changelog](https://github.com/apollographql/apollo-client/blob/main/CHANGELOG.md)
### Fetching

[Queries](https://www.apollographql.com/docs/react/data/queries)[Suspense](https://www.apollographql.com/docs/react/data/suspense)[Fragments](https://www.apollographql.com/docs/react/data/fragments)[Mutations](https://www.apollographql.com/docs/react/data/mutations)[Refetching](https://www.apollographql.com/docs/react/data/refetching)[Subscriptions](https://www.apollographql.com/docs/react/data/subscriptions)[Directives](https://www.apollographql.com/docs/react/data/directives)[Error handling](https://www.apollographql.com/docs/react/data/error-handling)[Document transforms](https://www.apollographql.com/docs/react/data/document-transforms)[Best practices](https://www.apollographql.com/docs/react/data/operation-best-practices)
### Caching

[Overview](https://www.apollographql.com/docs/react/caching/overview)[Configuration](https://www.apollographql.com/docs/react/caching/cache-configuration)[Reading and writing](https://www.apollographql.com/docs/react/caching/cache-interaction)[Garbage collection and eviction](https://www.apollographql.com/docs/react/caching/garbage-collection)[Customizing field behavior](https://www.apollographql.com/docs/react/caching/cache-field-behavior)[Memory Management](https://www.apollographql.com/docs/react/caching/memory-management)[Advanced topics](https://www.apollographql.com/docs/react/caching/advanced-topics)
### Pagination

[Overview](https://www.apollographql.com/docs/react/pagination/overview)[Core API](https://www.apollographql.com/docs/react/pagination/core-api)[Offset-based](https://www.apollographql.com/docs/react/pagination/offset-based)[Cursor-based](https://www.apollographql.com/docs/react/pagination/cursor-based)[keyArgs](https://www.apollographql.com/docs/react/pagination/key-args)
### Local State

[Overview](https://www.apollographql.com/docs/react/local-state/local-state-management)[Local-only fields](https://www.apollographql.com/docs/react/local-state/managing-state-with-field-policies)[Reactive variables](https://www.apollographql.com/docs/react/local-state/reactive-variables)[Client-side schema](https://www.apollographql.com/docs/react/local-state/client-side-schema)[Local resolvers](https://www.apollographql.com/docs/react/local-state/local-resolvers)
### Development & Testing

[Developer tools](https://www.apollographql.com/docs/react/development-testing/developer-tooling)[Using TypeScript](https://www.apollographql.com/docs/react/development-testing/static-typing)[Testing React components](https://www.apollographql.com/docs/react/development-testing/testing)[Schema-driven testing](https://www.apollographql.com/docs/react/development-testing/schema-driven-testing)[Mocking schema capabilities](https://www.apollographql.com/docs/react/development-testing/client-schema-mocking)[Reducing bundle size](https://www.apollographql.com/docs/react/development-testing/reducing-bundle-size)
### Performance

[Improving performance](https://www.apollographql.com/docs/react/performance/performance)[Optimistic mutation results](https://www.apollographql.com/docs/react/performance/optimistic-ui)[Server-side rendering](https://www.apollographql.com/docs/react/performance/server-side-rendering)[Compiling queries with Babel](https://www.apollographql.com/docs/react/performance/babel)
### Integrations

[Using Apollo Client with your view layer](https://www.apollographql.com/docs/react/integrations/integrations)[Integrating with React Native](https://www.apollographql.com/docs/react/integrations/react-native)[Loading queries with Webpack](https://www.apollographql.com/docs/react/integrations/webpack)
### Networking

[Basic HTTP networking](https://www.apollographql.com/docs/react/networking/basic-http-networking)[Advanced HTTP networking](https://www.apollographql.com/docs/react/networking/advanced-http-networking)[Authentication](https://www.apollographql.com/docs/react/networking/authentication)
### Migrating

[Migrating to Apollo Client 3.0](https://www.apollographql.com/docs/react/migrating/apollo-client-3-migration)[Hooks migration guide](https://www.apollographql.com/docs/react/migrating/hooks-migration)
### API Reference

### Core

[ApolloClient](https://www.apollographql.com/docs/react/api/core/ApolloClient)[InMemoryCache](https://www.apollographql.com/docs/react/api/cache/InMemoryCache)[ObservableQuery](https://www.apollographql.com/docs/react/api/core/ObservableQuery)
### React

[Hooks](https://www.apollographql.com/docs/react/api/react/hooks)[Preloading](https://www.apollographql.com/docs/react/api/react/preloading)[Testing](https://www.apollographql.com/docs/react/api/react/testing)[SSR](https://www.apollographql.com/docs/react/api/react/ssr)[Components (deprecated)](https://www.apollographql.com/docs/react/api/react/components)[HOC (deprecated)](https://www.apollographql.com/docs/react/api/react/hoc)
### Apollo Link

[Overview](https://www.apollographql.com/docs/react/api/link/introduction)[HTTP](https://www.apollographql.com/docs/react/api/link/apollo-link-http)[HTTP Batch](https://www.apollographql.com/docs/react/api/link/apollo-link-batch-http)[Context](https://www.apollographql.com/docs/react/api/link/apollo-link-context)[Error](https://www.apollographql.com/docs/react/api/link/apollo-link-error)[Persisted Queries](https://www.apollographql.com/docs/react/api/link/persisted-queries)[Remove Typename](https://www.apollographql.com/docs/react/api/link/apollo-link-remove-typename)[REST](https://www.apollographql.com/docs/react/api/link/apollo-link-rest)[Retry](https://www.apollographql.com/docs/react/api/link/apollo-link-retry)[Schema](https://www.apollographql.com/docs/react/api/link/apollo-link-schema)[Subscriptions (newer protocol)](https://www.apollographql.com/docs/react/api/link/apollo-link-subscriptions)[WebSocket (older protocol)](https://www.apollographql.com/docs/react/api/link/apollo-link-ws)[Community links](https://www.apollographql.com/docs/react/api/link/community-links)
## Apollo iOS

Apollo iOS - v1 (latest)[Introduction](https://www.apollographql.com/docs/ios)[Get Started](https://www.apollographql.com/docs/ios/get-started)
### Project Configuration

[Introduction](https://www.apollographql.com/docs/ios/project-configuration/intro)[1. Project Modularization](https://www.apollographql.com/docs/ios/project-configuration/modularization)[2. Schema Types](https://www.apollographql.com/docs/ios/project-configuration/schema-types)[3. Operation Models](https://www.apollographql.com/docs/ios/project-configuration/operation-models)[SDK components](https://www.apollographql.com/docs/ios/project-configuration/sdk-components)
### Migration Guides

[v1.0](https://www.apollographql.com/docs/ios/migrations/1.0)[v1.2](https://www.apollographql.com/docs/ios/migrations/1.2)[v1.3](https://www.apollographql.com/docs/ios/migrations/1.3)[v1.5](https://www.apollographql.com/docs/ios/migrations/1.5)[v1.6](https://www.apollographql.com/docs/ios/migrations/1.6)[v1.7](https://www.apollographql.com/docs/ios/migrations/1.7)
### Tutorial

[Code Generation](https://www.apollographql.com/docs/ios/tutorial/codegen-getting-started)
### Build a project with Apollo

[Introduction](https://www.apollographql.com/docs/ios/tutorial/tutorial-introduction)[1. Configure your project](https://www.apollographql.com/docs/ios/tutorial/tutorial-configure-project)[2. Add the GraphQL schema](https://www.apollographql.com/docs/ios/tutorial/tutorial-add-graphql-schema)[3. Write your first query](https://www.apollographql.com/docs/ios/tutorial/tutorial-write-your-first-query)[4. Running code generation](https://www.apollographql.com/docs/ios/tutorial/tutorial-running-code-generation)[5. Execute your first query](https://www.apollographql.com/docs/ios/tutorial/tutorial-execute-first-query)[6. Connect your queries to your UI](https://www.apollographql.com/docs/ios/tutorial/tutorial-connect-queries-to-ui)[7. Add more info to the list](https://www.apollographql.com/docs/ios/tutorial/tutorial-add-more-info-to-list)[8. Paginate results](https://www.apollographql.com/docs/ios/tutorial/tutorial-paginate-results)[9. Complete the details view](https://www.apollographql.com/docs/ios/tutorial/tutorial-complete-details-view)[10. Write your first mutation](https://www.apollographql.com/docs/ios/tutorial/tutorial-first-mutation)[11. Authenticate your operations](https://www.apollographql.com/docs/ios/tutorial/tutorial-authenticate-operations)[12. Define additional mutations](https://www.apollographql.com/docs/ios/tutorial/tutorial-define-additional-mutations)[13. Write your first subscription](https://www.apollographql.com/docs/ios/tutorial/tutorial-subscriptions)
### API Reference

[Overview](https://www.apollographql.com/docs/ios/docc/documentation/index)[Apollo Client](https://www.apollographql.com/docs/ios/docc/documentation/Apollo)[ApolloAPI](https://www.apollographql.com/docs/ios/docc/documentation/ApolloAPI)[ApolloWebSocket](https://www.apollographql.com/docs/ios/docc/documentation/ApolloWebSocket)[ApolloSQLite](https://www.apollographql.com/docs/ios/docc/documentation/ApolloSQLite)[ApolloCodegenLib](https://www.apollographql.com/docs/ios/docc/documentation/ApolloCodegenLib)[ApolloPagination](https://www.apollographql.com/docs/ios/docc/documentation/ApolloPagination)[Client Directives](https://www.apollographql.com/docs/ios/client-directives)
### Code Generation

[Introduction](https://www.apollographql.com/docs/ios/code-generation/introduction)[The Codegen CLI](https://www.apollographql.com/docs/ios/code-generation/codegen-cli)[Configuration](https://www.apollographql.com/docs/ios/code-generation/codegen-configuration)[Downloading a Schema](https://www.apollographql.com/docs/ios/code-generation/downloading-schema)[Running Code Generation in Swift Code](https://www.apollographql.com/docs/ios/code-generation/run-codegen-in-swift-code)[Code Generation Troubleshooting](https://www.apollographql.com/docs/ios/troubleshooting/codegen-troubleshooting)
### Fetching

[Fetching Data](https://www.apollographql.com/docs/ios/fetching/fetching-data)
### Operations

[Queries](https://www.apollographql.com/docs/ios/fetching/queries)[Mutations](https://www.apollographql.com/docs/ios/fetching/mutations)[Subscriptions](https://www.apollographql.com/docs/ios/fetching/subscriptions)[Fragments](https://www.apollographql.com/docs/ios/fetching/fragments)[Operation Arguments](https://www.apollographql.com/docs/ios/fetching/operation-arguments)[Error Handling](https://www.apollographql.com/docs/ios/fetching/error-handling)[Type Conditions](https://www.apollographql.com/docs/ios/fetching/type-conditions)[Custom Scalars](https://www.apollographql.com/docs/ios/custom-scalars)[Persisted Queries](https://www.apollographql.com/docs/ios/fetching/persisted-queries)[@defer support (experimental)](https://www.apollographql.com/docs/ios/fetching/defer)
### Caching

[Introduction](https://www.apollographql.com/docs/ios/caching/introduction)[Setup](https://www.apollographql.com/docs/ios/caching/cache-setup)[Direct Cache Access](https://www.apollographql.com/docs/ios/caching/cache-transactions)[Custom Cache Keys](https://www.apollographql.com/docs/ios/caching/cache-key-resolution)
### Networking

[Creating a Client](https://www.apollographql.com/docs/ios/networking/client-creation)
### Pagination

[Introduction](https://www.apollographql.com/docs/ios/pagination/introduction)[Using Custom Response Models](https://www.apollographql.com/docs/ios/pagination/custom-types)[Directional Pagination](https://www.apollographql.com/docs/ios/pagination/directional-pagers)[Multi-query Pagination](https://www.apollographql.com/docs/ios/pagination/multi-query)
### Development & Testing

[Test Mocks](https://www.apollographql.com/docs/ios/testing/test-mocks)[Including Apollo as an XCFramework](https://www.apollographql.com/docs/ios/development/using-xcframework)
### Advanced

[File Uploads](https://www.apollographql.com/docs/ios/file-uploads)[Request Chain Customization](https://www.apollographql.com/docs/ios/networking/request-pipeline)
## Apollo Kotlin

Apollo Kotlin - v4 (latest)[Get Started](https://www.apollographql.com/docs/kotlin)[Migrating to v4](https://www.apollographql.com/docs/kotlin/migration/4.0)[Modules](https://www.apollographql.com/docs/kotlin/essentials/modules)[Evolution policy](https://www.apollographql.com/docs/kotlin/essentials/evolution)[Kdoc](https://apollographql.github.io/apollo-kotlin/kdoc/)[Changelog](https://github.com/apollographql/apollo-kotlin/blob/main/CHANGELOG.md)
### Tutorial

[0. Introduction](https://www.apollographql.com/docs/kotlin/tutorial/00-introduction)[1. Configure your project](https://www.apollographql.com/docs/kotlin/tutorial/01-configure-project)[2. Add the GraphQL schema](https://www.apollographql.com/docs/kotlin/tutorial/02-add-the-graphql-schema)[3. Write your first query](https://www.apollographql.com/docs/kotlin/tutorial/03-write-your-first-query)[4. Execute your first query](https://www.apollographql.com/docs/kotlin/tutorial/04-execute-the-query)[5. Connect your queries to your UI](https://www.apollographql.com/docs/kotlin/tutorial/05-connect-queries-to-your-ui)[6. Add more info to the list](https://www.apollographql.com/docs/kotlin/tutorial/06-add-more-info)[7. Paginate results](https://www.apollographql.com/docs/kotlin/tutorial/07-paginate-results)[8. Add a details view](https://www.apollographql.com/docs/kotlin/tutorial/08-add-a-details-view)[9. Write your first mutation](https://www.apollographql.com/docs/kotlin/tutorial/09-write-your-first-mutation)[10. Authenticate your operations](https://www.apollographql.com/docs/kotlin/tutorial/10-authenticate-your-queries)[11. Write your first subscription](https://www.apollographql.com/docs/kotlin/tutorial/11-subscriptions)
### Configuration

[Gradle plugin configuration](https://www.apollographql.com/docs/kotlin/advanced/plugin-configuration)[Gradle plugin recipes](https://www.apollographql.com/docs/kotlin/advanced/plugin-recipes)[Multi Modules](https://www.apollographql.com/docs/kotlin/advanced/multi-modules)[File types](https://www.apollographql.com/docs/kotlin/essentials/file-types)[Client Awareness](https://www.apollographql.com/docs/kotlin/advanced/client-awareness)
### Fetching

[Queries](https://www.apollographql.com/docs/kotlin/essentials/queries)[Mutations](https://www.apollographql.com/docs/kotlin/essentials/mutations)[Subscriptions](https://www.apollographql.com/docs/kotlin/essentials/subscriptions)[GraphQL variables](https://www.apollographql.com/docs/kotlin/advanced/operation-variables)[Error handling](https://www.apollographql.com/docs/kotlin/essentials/errors)[Custom scalars](https://www.apollographql.com/docs/kotlin/essentials/custom-scalars)[Fragments](https://www.apollographql.com/docs/kotlin/essentials/fragments)[@defer support](https://www.apollographql.com/docs/kotlin/fetching/defer)[Persisted queries](https://www.apollographql.com/docs/kotlin/advanced/persisted-queries)
### Caching

[Introduction](https://www.apollographql.com/docs/kotlin/caching/introduction)[Normalized caches](https://www.apollographql.com/docs/kotlin/caching/normalized-cache)[Declarative cache IDs](https://www.apollographql.com/docs/kotlin/caching/declarative-ids)[Programmatic cache IDs](https://www.apollographql.com/docs/kotlin/caching/programmatic-ids)[Watching cached data](https://www.apollographql.com/docs/kotlin/caching/query-watchers)[ApolloStore](https://www.apollographql.com/docs/kotlin/caching/store)[HTTP cache](https://www.apollographql.com/docs/kotlin/caching/http-cache)[Troubleshooting](https://www.apollographql.com/docs/kotlin/caching/troubleshooting)
### Networking

[Interceptors](https://www.apollographql.com/docs/kotlin/advanced/interceptors-http)[Custom HTTP clients](https://www.apollographql.com/docs/kotlin/advanced/http-engine)[Using the models without apollo-runtime](https://www.apollographql.com/docs/kotlin/advanced/no-runtime)[Authentication](https://www.apollographql.com/docs/kotlin/advanced/authentication)[WebSocket errors](https://www.apollographql.com/docs/kotlin/advanced/websocket-errors)[Batching operations](https://www.apollographql.com/docs/kotlin/advanced/query-batching)
### Development & Testing

[Testing overview](https://www.apollographql.com/docs/kotlin/testing/overview)[Mocking HTTP responses](https://www.apollographql.com/docs/kotlin/testing/mocking-http-responses)[Mocking GraphQL responses](https://www.apollographql.com/docs/kotlin/testing/mocking-graphql-responses)[Data builders](https://www.apollographql.com/docs/kotlin/testing/data-builders)[Android Studio plugin](https://www.apollographql.com/docs/kotlin/testing/android-studio-plugin)[Apollo Debug Server](https://www.apollographql.com/docs/kotlin/testing/apollo-debug-server)
### Advanced

[Uploading files](https://www.apollographql.com/docs/kotlin/advanced/upload)[Monitoring the network state](https://www.apollographql.com/docs/kotlin/advanced/network-connectivity)[Handling nullability](https://www.apollographql.com/docs/kotlin/advanced/nullability)[Experimental WebSockets](https://www.apollographql.com/docs/kotlin/advanced/experimental-websockets)[Using aliases](https://www.apollographql.com/docs/kotlin/advanced/using-aliases)[Using Java](https://www.apollographql.com/docs/kotlin/advanced/java)[Apollo AST](https://www.apollographql.com/docs/kotlin/advanced/apollo-ast)[Compiler plugins](https://www.apollographql.com/docs/kotlin/advanced/compiler-plugins)[JS Interoperability](https://www.apollographql.com/docs/kotlin/advanced/js-interop)[Response based codegen](https://www.apollographql.com/docs/kotlin/advanced/response-based)[Apollo Kotlin galaxy](https://www.apollographql.com/docs/kotlin/advanced/galaxy)
## Apollo Server

Apollo Server - v4 (latest)[Introduction](https://www.apollographql.com/docs/apollo-server)[Get started](https://www.apollographql.com/docs/apollo-server/getting-started)
### New in v4

[Migrating to Apollo Server 4](https://www.apollographql.com/docs/apollo-server/migration)[Previous versions](https://www.apollographql.com/docs/apollo-server/previous-versions)[Changelog](https://github.com/apollographql/apollo-server/blob/main/packages/server/CHANGELOG.md)
### Defining a Schema

[Schema basics](https://www.apollographql.com/docs/apollo-server/schema/schema)[Unions and interfaces](https://www.apollographql.com/docs/apollo-server/schema/unions-interfaces)[Custom scalars](https://www.apollographql.com/docs/apollo-server/schema/custom-scalars)[Directives](https://www.apollographql.com/docs/apollo-server/schema/directives)
### Resolving Operations

[Resolvers](https://www.apollographql.com/docs/apollo-server/data/resolvers)[Sharing context](https://www.apollographql.com/docs/apollo-server/data/context)[Error handling](https://www.apollographql.com/docs/apollo-server/data/errors)[Subscriptions](https://www.apollographql.com/docs/apollo-server/data/subscriptions)
### Fetching Data

[Overview](https://www.apollographql.com/docs/apollo-server/data/fetching-data)[REST APIs](https://www.apollographql.com/docs/apollo-server/data/fetching-rest)
### Web Frameworks

[Integrations](https://www.apollographql.com/docs/apollo-server/integrations/integration-index)[Building integrations](https://www.apollographql.com/docs/apollo-server/integrations/building-integrations)[MERN stack tutorial](https://www.apollographql.com/docs/apollo-server/integrations/mern)
### Development Workflow

[Build and run queries](https://www.apollographql.com/docs/apollo-server/workflow/build-run-queries)[Request format](https://www.apollographql.com/docs/apollo-server/workflow/requests)[Generating TS types](https://www.apollographql.com/docs/apollo-server/workflow/generate-types)[Mocking](https://www.apollographql.com/docs/apollo-server/testing/mocking)[Integration testing](https://www.apollographql.com/docs/apollo-server/testing/testing)[Apollo Studio Explorer](https://www.apollographql.com/docs/studio/explorer/)
### Performance

[Caching](https://www.apollographql.com/docs/apollo-server/performance/caching)[Cache backends](https://www.apollographql.com/docs/apollo-server/performance/cache-backends)[Response Cache Eviction](https://www.apollographql.com/docs/apollo-server/performance/response-cache-eviction)[Automatic persisted queries](https://www.apollographql.com/docs/apollo-server/performance/apq)
### Security

[Auth](https://www.apollographql.com/docs/apollo-server/security/authentication)[CORS](https://www.apollographql.com/docs/apollo-server/security/cors)[Terminating SSL](https://www.apollographql.com/docs/apollo-server/security/terminating-ssl)[Proxy configuration](https://www.apollographql.com/docs/apollo-server/security/proxy-configuration)
### Deployment

[Lambda](https://www.apollographql.com/docs/apollo-server/deployment/lambda)[Heroku](https://www.apollographql.com/docs/apollo-server/deployment/heroku)
### Monitoring

[Metrics and logging](https://www.apollographql.com/docs/apollo-server/monitoring/metrics)[Health checks](https://www.apollographql.com/docs/apollo-server/monitoring/health-checks)
### API Reference

[ApolloServer](https://www.apollographql.com/docs/apollo-server/api/apollo-server)[startStandaloneServer](https://www.apollographql.com/docs/apollo-server/api/standalone)[expressMiddleware](https://www.apollographql.com/docs/apollo-server/api/express-middleware)
### Plugins

[Overview](https://www.apollographql.com/docs/apollo-server/builtin-plugins)
### Built-in

[Usage reporting](https://www.apollographql.com/docs/apollo-server/api/plugin/usage-reporting)[Schema reporting](https://www.apollographql.com/docs/apollo-server/api/plugin/schema-reporting)[Inline trace](https://www.apollographql.com/docs/apollo-server/api/plugin/inline-trace)[Drain HTTP server](https://www.apollographql.com/docs/apollo-server/api/plugin/drain-http-server)[Cache control](https://www.apollographql.com/docs/apollo-server/api/plugin/cache-control)[Landing pages](https://www.apollographql.com/docs/apollo-server/api/plugin/landing-pages)[Federated subscriptions](https://www.apollographql.com/docs/apollo-server/api/plugin/subscription-callback)
### Custom

[Creating plugins](https://www.apollographql.com/docs/apollo-server/integrations/plugins)[Event reference](https://www.apollographql.com/docs/apollo-server/integrations/plugins-event-reference)
### Using with Federation

### As a subgraph

[Setup](https://www.apollographql.com/docs/apollo-server/using-federation/apollo-subgraph-setup)[@apollo/subgraph reference](https://www.apollographql.com/docs/apollo-server/using-federation/api/apollo-subgraph)
### As a gateway

[Setup](https://www.apollographql.com/docs/apollo-server/using-federation/apollo-gateway-setup)[Gateway performance](https://www.apollographql.com/docs/apollo-server/using-federation/gateway-performance)[@apollo/gateway reference](https://www.apollographql.com/docs/apollo-server/using-federation/api/apollo-gateway)
## VS Code Extension

[Overview](https://www.apollographql.com/docs/vs-code-extension)

[Routing](graphos/routing)

        [Home](/docs/)   /  [Routing](/docs/graphos/routing)   /  [Router Customization](/docs/graphos/routing/customization/overview)   /  [Coprocessors](/docs/graphos/routing/customization/coprocessor)        [Routing /](/docs/graphos/routing)    [Router Customization](/docs/graphos/routing/customization/overview)
# External Coprocessing

Customize your router's behavior in any language

---

   **This feature is only available with a GraphOS Dedicated or Enterprise plan.** You can test it out by signing up for a free [GraphOS trial](https://studio.apollographql.com/signup?&referrer=docs-content). To compare GraphOS feature support across all plan types, see the [pricing page](https://www.apollographql.com/pricing#graphos-router).

With **external coprocessing**, you can hook into the GraphOS Router's request-handling lifecycle by writing standalone code in any language and framework. This code (i.e., your **coprocessor**) can run anywhere on your network that's accessible to the router over HTTP.

You can configure your router to "call out" to your coprocessor at different **stages** throughout the request-handling lifecycle, enabling you to perform custom logic based on a client request's headers, query string, and other details. This logic can access disk and perform network requests, all while safely isolated from the critical router process.

When your coprocessor responds to these requests, its response body can modify [various details](https://www.apollographql.com/docs/graphos/routing/customization/coprocessor#responding-to-coprocessor-requests) of the client's request or response. You can even [terminate a client request](https://www.apollographql.com/docs/graphos/routing/customization/coprocessor#terminating-a-client-request).

**Recommended locations for hosting your coprocessor include:**

* On the same host as your router (minimal request latency)
* In the same Pod as your router, as a "sidecar" container (minimal request latency)
* In the same availability zone as your router (low request latency with increased deployment isolation)

## How it works

Whenever your router receives a client request, at various **stages** in the [request-handling lifecycle](https://www.apollographql.com/docs/graphos/routing/customization/rhai/#router-request-lifecycle) it can send HTTP POST requests to your coprocessor:

This diagram shows request execution proceeding "down" from a client, through the router, to individual subgraphs. Execution then proceeds back "up" to the client in the reverse order.

As shown in the diagram above, the `RouterService`, `SupergraphService`, `ExecutionService`, and `SubgraphService` steps of the [request-handling lifecycle](https://www.apollographql.com/docs/graphos/routing/customization/rhai/#router-request-lifecycle) can send these POST requests (also called **coprocessor requests**).

Each supported service can send its coprocessor requests at two different **stages**:

* As execution proceeds "down" from the client to individual subgraphs

  + Here, the coprocessor can inspect and modify details of requests before GraphQL operations are processed.
  + The coprocessor can also instruct the router to [*terminate* a client request](https://www.apollographql.com/docs/graphos/routing/customization/coprocessor#terminating-a-client-request) immediately.
* As execution proceeds back "up" from subgraphs to the client

  + Here, the coprocessor can inspect and modify details of the router's response to the client.

At *every* stage, the router waits for your coprocessor's response before it continues processing the corresponding request. Because of this, you should maximize responsiveness by configuring *only* whichever coprocessor requests your customization requires.

### Multiple requests with `SubgraphService`

If your coprocessor hooks into your router's `SubgraphService`, the router sends a separate coprocessor request *for each subgraph request in its query plan.* In other words, if your router needs to query three separate subgraphs to fully resolve a client operation, it sends three separate coprocessor requests. Each coprocessor request includes the [name](https://www.apollographql.com/docs/graphos/routing/customization/coprocessor#servicename) and [URL](https://www.apollographql.com/docs/graphos/routing/customization/coprocessor#uri) of the subgraph being queried.

## Setup

First, make sure your router is [connected to a GraphOS Enterprise organization](https://www.apollographql.com/docs/router/enterprise-features/#enabling-enterprise-features).

You configure external coprocessing in your router's [YAML config file](https://www.apollographql.com/docs/router/configuration/overview/#yaml-config-file), under the `coprocessor` key.

### Typical configuration

This example configuration sends commonly used request and response details to your coprocessor (see the comments below for explanations of each field):

YAMLrouter.yaml copy
```
1coprocessor:
2  url: http://127.0.0.1:8081 # Required. Replace with the URL of your coprocessor's HTTP endpoint.
3  timeout: 2s # The timeout for all coprocessor requests. Defaults to 1 second (1s)
4  router: # This coprocessor hooks into the `RouterService`
5    request: # By including this key, the `RouterService` sends a coprocessor request whenever it first receives a client request.
6      headers: true # These boolean properties indicate which request data to include in the coprocessor request. All are optional and false by default.
7      body: false
8      context: false
9      sdl: false
10      path: false
11      method: false
12    response: # By including this key, the `RouterService` sends a coprocessor request whenever it's about to send response data to a client (including incremental data via @defer).
13      headers: true
14      body: false
15      context: false
16      sdl: false
17      status_code: false
18  supergraph: # This coprocessor hooks into the `SupergraphService`
19    request: # By including this key, the `SupergraphService` sends a coprocessor request whenever it first receives a client request.
20      headers: true # These boolean properties indicate which request data to include in the coprocessor request. All are optional and false by default.
21      body: false
22      context: false
23      sdl: false
24      method: false
25    response: # By including this key, the `SupergraphService` sends a coprocessor request whenever it's about to send response data to a client (including incremental data via @defer).
26      headers: true
27      body: false
28      context: false
29      sdl: false
30      status_code: false
31  subgraph:
32    all:
33      request: # By including this key, the `SubgraphService` sends a coprocessor request whenever it is about to make a request to a subgraph.
34        headers: true # These boolean properties indicate which request data to include in the coprocessor request. All are optional and false by default.
35        body: false
36        context: false
37        uri: false
38        method: false
39        service_name: false
40        subgraph_request_id: false
41      response: # By including this key, the `SubgraphService` sends a coprocessor request whenever receives a subgraph response.
42        headers: true
43        body: false
44        context: false
45        service_name: false
46        status_code: false
47        subgraph_request_id: false
```
### Minimal configuration

You can confirm that your router can reach your coprocessor by setting this minimal configuration before expanding it as needed:

YAMLrouter.yaml copy
```
1coprocessor:
2  url: http://127.0.0.1:8081 # Replace with the URL of your coprocessor's HTTP endpoint.
3  router:
4    request:
5      headers: false
```

In this case, the `RouterService` only sends a coprocessor request whenever it receives a client request. The coprocessor request body includes *no* data related to the client request (only "control" data, which is [covered below](https://www.apollographql.com/docs/graphos/routing/customization/coprocessor#coprocessor-request-format)).

### Conditions

You can define [conditions](https://www.apollographql.com/docs/router/configuration/telemetry/instrumentation/conditions) for a stage of the request lifecycle that you want to run the coprocessor. You can set coprocessor conditions with [selectors](https://www.apollographql.com/docs/router/configuration/telemetry/instrumentation/selectors) based on headers or context entries.

**note**The `Execution` stage doesn't support coprocessor conditions.

Example configurations:

* Run during the `SupergraphResponse` stage only for the first event of a supergraph response. Useful for handling only the first subscription event when a subscription is opened:

YAMLrouter.yaml copy
```
1coprocessor:
2  url: http://127.0.0.1:3000
3  supergraph:
4    response:
5      condition:
6        eq:
7        - true
8        - is_primary_response: true # Will be true only for the first event received on a supergraph response (like classical queries and mutations for example)
9      body: true
10      headers: true
```

* Run during the `Request` stage only if the request contains a request header:

YAMLrouter.yaml copy
```
1coprocessor:
2  url: http://127.0.0.1:3000
3  router:
4    request:
5      condition:
6        eq:
7        - request_header: should-execute-copro # Header name
8        - "enabled" # Header value
9      body: true
10      headers: true
```
### Client configuration

The router supports coprocessor connections over:

* HTTP/1.1
* HTTP/1.1 with TLS
* HTTP/2 with TLS
* HTTP/2 Cleartext protocol (h2c). This uses HTTP/2 over plaintext connections.

Use the table below to look up the resulting protocol of a coprocessor connection, based on the  URL and the `experimental_http2` configuration:

|  | URL with `http://` | URL with `https://` |
| --- | --- | --- |
| `experimental_http2:` `disable` | HTTP/1.1 | HTTP/1.1 with TLS |
| `experimental_http2:` `enable` | HTTP/1.1 | Either HTTP/1.1 or HTTP/2 with TLS, as determined by the TLS handshake |
| `experimental_http2:` `http2only` | h2c | HTTP/2 with TLS |
| `experimental_http2`not set | HTTP/1.1 | Either HTTP/1.1 or HTTP/2 with TLS, as determined by the TLS handshake |

**note**

Configuring `experimental_http2: http2only` for a network that doesn't support HTTP/2 results in a failed coprocessor connection.

For example, to enable h2c (http2 cleartext) communication with a coprocessor you can use this configuration::

YAMLrouter.yaml copy
```
1coprocessor:
2  url: http://127.0.0.1:8081
3  # Using an HTTP (not HTTPS) URL and experimental_http2: http2only results in connections that use h2c
4  client:
5    experimental_http2: http2only
6
```
## Coprocessor request format

The router communicates with your coprocessor via HTTP POST requests (called **coprocessor requests**). The body of each coprocessor request is a JSON object with properties that describe either the current client request or the current router response.

**note****Body properties vary by the router's current execution stage.** [See example request bodies for each stage.](https://www.apollographql.com/docs/graphos/routing/customization/coprocessor#example-requests-by-stage)

Properties of the JSON body are divided into two high-level categories:

* "Control" properties

  + These provide information about the context of the specific router request or response. They provide a mechanism to influence the router's execution flow.
  + The router always includes these properties in coprocessor requests.
* Data properties

  + These provide information about the substance of a request or response, such as the GraphQL query string and any HTTP headers. Aside from `sdl`, your coprocessor can modify all of these properties.
  + You [configure which of these fields](https://www.apollographql.com/docs/graphos/routing/customization/coprocessor#setup) the router includes in its coprocessor requests. By default, the router includes *none* of them.

### Example requests by stage

#### `RouterRequest`

Click to expandJSONExample coprocessor request body copy
```
1{
2  // Control properties
3  "version": 1,
4  "stage": "RouterRequest",
5  "control": "continue",
6  "id": "1b19c05fdafc521016df33148ad63c1b",
7
8  // Data properties
9  "headers": {
10    "cookie": [
11      "tasty_cookie=strawberry"
12    ],
13    "content-type": [
14      "application/json"
15    ],
16    "host": [
17      "127.0.0.1:4000"
18    ],
19    "apollo-federation-include-trace": [
20      "ftv1"
21    ],
22    "apollographql-client-name": [
23      "manual"
24    ],
25    "accept": [
26      "*/*"
27    ],
28    "user-agent": [
29      "curl/7.79.1"
30    ],
31    "content-length": [
32      "46"
33    ]
34  },
35  "body": "{
36    \"query\": \"query GetActiveUser {\n  me {\n  name\n}\n}\"
37  }",
38  "context": {
39    "entries": {
40      "accepts-json": false,
41      "accepts-wildcard": true,
42      "accepts-multipart": false
43    }
44  },
45  "sdl": "...", // String omitted due to length
46  "path": "/",
47  "method": "POST"
48}
```
#### `RouterResponse`

Click to expandJSON copy
```
1{
2  // Control properties
3  "version": 1,
4  "stage": "RouterResponse",
5  "control": "continue",
6  "id": "1b19c05fdafc521016df33148ad63c1b",
7
8  // Data properties
9  "headers": {
10    "vary": [
11      "origin"
12    ],
13    "content-type": [
14      "application/json"
15    ]
16  },
17  "body": "{
18    \"data\": {
19      \"me\": {
20        \"name\": \"Ada Lovelace\"
21      }
22    }
23  }",
24  "context": {
25    "entries": {
26      "apollo_telemetry::subgraph_metrics_attributes": {},
27      "accepts-json": false,
28      "accepts-multipart": false,
29      "apollo_telemetry::client_name": "manual",
30      "apollo_telemetry::usage_reporting": {
31        "statsReportKey": "# Long\nquery Long{me{name}}",
32        "referencedFieldsByType": {
33          "User": {
34            "fieldNames": [
35              "name"
36            ],
37            "isInterface": false
38          },
39          "Query": {
40            "fieldNames": [
41              "me"
42            ],
43            "isInterface": false
44          }
45        }
46      },
47      "apollo_telemetry::client_version": "",
48      "accepts-wildcard": true
49    }
50  },
51  "statusCode": 200,
52  "sdl": "..." // Omitted due to length
53}
```
#### `SupergraphRequest`

Click to expandJSON copy
```
1
2{
3  // Control properties
4  "version": 1,
5  "stage": "SupergraphRequest",
6  "control": "continue",
7
8  // Data properties
9  "headers": {
10    "cookie": [
11      "tasty_cookie=strawberry"
12    ],
13    "content-type": [
14      "application/json"
15    ],
16    "host": [
17      "127.0.0.1:4000"
18    ],
19    "apollo-federation-include-trace": [
20      "ftv1"
21    ],
22    "apollographql-client-name": [
23      "manual"
24    ],
25    "accept": [
26      "*/*"
27    ],
28    "user-agent": [
29      "curl/7.79.1"
30    ],
31    "content-length": [
32      "46"
33    ]
34  },
35  "body": {
36    "query": "query Long {\n  me {\n  name\n}\n}",
37    "operationName": "MyQuery",
38    "variables": {}
39  },
40  "context": {
41    "entries": {
42      "accepts-json": false,
43      "accepts-wildcard": true,
44      "accepts-multipart": false,
45      "this-is-a-test-context": 42
46    }
47  },
48  "serviceName": "service name shouldn't change",
49  "uri": "http://thisurihaschanged"
50}
51
```
#### `SupergraphResponse`

Click to expandJSON copy
```
1
2{
3  // Control properties
4  "version": 1,
5  "stage": "SupergraphResponse",
6  "control": {
7    "break": 200
8  },
9
10  // Data properties
11  "body": {
12    "errors": [{ "message": "my error message" }]
13  },
14  "context": {
15    "entries": {
16      "testKey": true
17    }
18  },
19  "headers": {
20    "aheader": ["a value"]
21  }
22}
23
```
#### `ExecutionRequest`

Click to expandJSON copy
```
1
2{
3  // Control properties
4  "version": 1,
5  "stage": "ExecutionRequest",
6  "control": "continue",
7
8  // Data properties
9  "headers": {
10    "cookie": [
11      "tasty_cookie=strawberry"
12    ],
13    "content-type": [
14      "application/json"
15    ],
16    "host": [
17      "127.0.0.1:4000"
18    ],
19    "apollo-federation-include-trace": [
20      "ftv1"
21    ],
22    "apollographql-client-name": [
23      "manual"
24    ],
25    "accept": [
26      "*/*"
27    ],
28    "user-agent": [
29      "curl/7.79.1"
30    ],
31    "content-length": [
32      "46"
33    ]
34  },
35  "body": {
36    "query": "query Long {\n  me {\n  name\n}\n}",
37    "operationName": "MyQuery"
38  },
39  "context": {
40    "entries": {
41      "accepts-json": false,
42      "accepts-wildcard": true,
43      "accepts-multipart": false,
44      "this-is-a-test-context": 42
45    }
46  },
47  "serviceName": "service name shouldn't change",
48  "uri": "http://thisurihaschanged",
49  "queryPlan": {
50    "usage_reporting":{"statsReportKey":"# Me\nquery Me{me{name username}}","referencedFieldsByType":{"User":{"fieldNames":["name","username"],"isInterface":false},"Query":{"fieldNames":["me"],"isInterface":false}}},
51    "root":{
52      "kind":"Fetch",
53      "serviceName":"accounts",
54      "variableUsages":[],
55      "operation":"query Me__accounts__0{me{name username}}",
56      "operationName":"Me__accounts__0",
57      "operationKind":"query",
58      "id":null,
59      "inputRewrites":null,
60      "outputRewrites":null,
61      "authorization":{"is_authenticated":false,"scopes":[],"policies":[]}},
62      "formatted_query_plan":"QueryPlan {\n  Fetch(service: \"accounts\") {\n    {\n      me {\n        name\n        username\n      }\n    }\n  },\n}",
63      "query":{
64        "string":"query Me {\n  me {\n    name\n    username\n  }\n}\n","fragments":{"map":{}},"operations":[{"name":"Me","kind":"query","type_name":"Query","selection_set":[{"Field":{"name":"me","alias":null,"selection_set":[{"Field":{"name":"name","alias":null,"selection_set":null,"field_type":{"Named":"String"},"include_skip":{"include":"Yes","skip":"No"}}},{"Field":{"name":"username","alias":null,"selection_set":null,"field_type":{"Named":"String"},"include_skip":{"include":"Yes","skip":"No"}}}],"field_type":{"Named":"User"},"include_skip":{"include":"Yes","skip":"No"}}}],"variables":{}}],"subselections":{},"unauthorized":{"paths":[],"errors":{"log":true,"response":"errors"}},"filtered_query":null,"defer_stats":{"has_defer":false,"has_unconditional_defer":false,"conditional_defer_variable_names":[]},"is_original":true}
65      }
66}
67
```
#### `ExecutionResponse`

Click to expandJSON copy
```
1
2{
3  // Control properties
4  "version": 1,
5  "stage": "ExecutionResponse",
6  "control": {
7    "break": 200
8  },
9
10  // Data properties
11  "body": {
12    "errors": [{ "message": "my error message" }]
13  },
14  "context": {
15    "entries": {
16      "testKey": true
17    }
18  },
19  "headers": {
20    "aheader": ["a value"]
21  }
22}
23
```
#### `SubgraphRequest`

Click to expandJSON copy
```
1
2{
3  // Control properties
4  "version": 1,
5  "stage": "SubgraphRequest",
6  "control": "continue",
7  "id": "666d677225c1bc6d7c54a52b409dbd4e",
8  "subgraphRequestId": "b5964998b2394b64a864ef802fb5a4b3",
9
10  // Data properties
11  "headers": {},
12  "body": {
13    "query": "query TopProducts__reviews__1($representations:[_Any!]!){_entities(representations:$representations){...on Product{reviews{body id}}}}",
14    "operationName": "TopProducts__reviews__1",
15    "variables": {
16      "representations": [
17        {
18          "__typename": "Product",
19          "upc": "1"
20        },
21        {
22          "__typename": "Product",
23          "upc": "2"
24        },
25        {
26          "__typename": "Product",
27          "upc": "3"
28        }
29      ]
30    }
31  },
32  "context": {
33    "entries": {
34      "apollo_telemetry::usage_reporting": {
35        "statsReportKey": "# TopProducts\nquery TopProducts{topProducts{name price reviews{body id}}}",
36        "referencedFieldsByType": {
37          "Query": {
38            "fieldNames": [
39              "topProducts"
40            ],
41            "isInterface": false
42          },
43          "Review": {
44            "fieldNames": [
45              "body",
46              "id"
47            ],
48            "isInterface": false
49          },
50          "Product": {
51            "fieldNames": [
52              "price",
53              "name",
54              "reviews"
55            ],
56            "isInterface": false
57          }
58        }
59      },
60      "apollo_telemetry::client_version": "",
61      "apollo_telemetry::subgraph_metrics_attributes": {},
62      "apollo_telemetry::client_name": ""
63    }
64  },
65  "uri": "https://reviews.demo.starstuff.dev/",
66  "method": "POST",
67  "serviceName": "reviews"
68}
69
```
#### `SubgraphResponse`

Click to expandJSON copy
```
1
2{
3  // Control properties
4  "version": 1,
5  "stage": "SubgraphResponse",
6  "id": "b7810c6f7f95640fd6c6c8781e3953c0",
7  "subgraphRequestId": "b5964998b2394b64a864ef802fb5a4b3",
8  "control": "continue",
9
10  // Data properties
11  "headers": {
12    "etag": [
13      "W/\"d3-7aayASjs0+e2c/TpiAYgEu/yyo0\""
14    ],
15    "via": [
16      "2 fly.io"
17    ],
18    "server": [
19      "Fly/90d459b3 (2023-03-07)"
20    ],
21    "date": [
22      "Thu, 09 Mar 2023 14:28:46 GMT"
23    ],
24    "x-powered-by": [
25      "Express"
26    ],
27    "x-ratelimit-limit": [
28      "10000000"
29    ],
30    "access-control-allow-origin": [
31      "*"
32    ],
33    "x-ratelimit-remaining": [
34      "9999478"
35    ],
36    "content-type": [
37      "application/json; charset=utf-8"
38    ],
39    "fly-request-id": [
40      "01GV3CCG5EM3ZNVZD2GH0B00E2-lhr"
41    ],
42    "x-ratelimit-reset": [
43      "1678374007"
44    ]
45  },
46  "body": {
47    "data": {
48      "_entities": [
49        {
50          "reviews": [
51            {
52              "body": "Love it!",
53              "id": "1"
54            },
55            {
56              "body": "Prefer something else.",
57              "id": "4"
58            }
59          ]
60        },
61        {
62          "reviews": [
63            {
64              "body": "Too expensive.",
65              "id": "2"
66            }
67          ]
68        },
69        {
70          "reviews": [
71            {
72              "body": "Could be better.",
73              "id": "3"
74            }
75          ]
76        }
77      ]
78    }
79  },
80  "context": {
81    "entries": {
82      "apollo_telemetry::usage_reporting": {
83        "statsReportKey": "# TopProducts\nquery TopProducts{topProducts{name price reviews{body id}}}",
84        "referencedFieldsByType": {
85          "Product": {
86            "fieldNames": [
87              "price",
88              "name",
89              "reviews"
90            ],
91            "isInterface": false
92          },
93          "Query": {
94            "fieldNames": [
95              "topProducts"
96            ],
97            "isInterface": false
98          },
99          "Review": {
100            "fieldNames": [
101              "body",
102              "id"
103            ],
104            "isInterface": false
105          }
106        }
107      },
108      "apollo_telemetry::client_version": "",
109      "apollo_telemetry::subgraph_metrics_attributes": {},
110      "apollo_telemetry::client_name": ""
111    }
112  },
113  "serviceName": "reviews",
114  "statusCode": 200
115}
116
```
### Property reference

| Property / Type | Description |
| --- | --- |
| **Control properties** | |
| `control``string | object` | Indicates whether the router should continue processing the current client request. In coprocessor request bodies from the router, this value is always the string value `continue`.In your coprocessor's response, you can instead return an *object* with the following format:JSON copy ``` 1{ "break": 400 } ``` If you do this, the router terminates the request-handling lifecycle and immediately responds to the client with the provided HTTP code and response [`body`](https://www.apollographql.com/docs/graphos/routing/customization/coprocessor#body) you specify.For details, see [Terminating a client request](https://www.apollographql.com/docs/graphos/routing/customization/coprocessor#terminating-a-client-request). |
| `id``string` | A unique ID corresponding to the client request associated with this coprocessor request.**Do not return a *different* value for this property.** If you do, the router treats the coprocessor request as if it failed. |
| `subgraphRequestId``string` | A unique ID corresponding to the subgraph request associated with this coprocessor request (only available at the `SubgraphRequest` and `SubgraphResponse` stages).**Do not return a *different* value for this property.** If you do, the router treats the coprocessor request as if it failed. |
| `stage``string` | Indicates which stage of the router's [request-handling lifecycle](https://www.apollographql.com/docs/graphos/routing/customization/rhai/#router-request-lifecycle) this coprocessor request corresponds to.This value is one of the following:  * `RouterRequest`: The `RouterService` has just received a client request. * `RouterResponse`: The `RouterService` is about to send response data to a client. * `SupergraphRequest`: The `SupergraphService` is about to send a GraphQL request. * `SupergraphResponse`: The `SupergraphService` has just received a GraphQL response. * `SubgraphRequest`: The `SubgraphService` is about to send a request to a subgraph. * `SubgraphResponse`: The `SubgraphService` has just received a subgraph response.  **Do not return a *different* value for this property.** If you do, the router treats the coprocessor request as if it failed. |
| `version``number` | Indicates which version of the coprocessor request protocol the router is using.Currently, this value is always `1`.**Do not return a *different* value for this property.** If you do, the router treats the coprocessor request as if it failed. |
| **Data properties** | |
| `body``string | object` | The body of the corresponding request or response.This field is populated when the underlying HTTP method is `POST`. If you are looking for operation data on `GET` requests, that info will be populated in the `path` parameter per the [GraphQL over HTTP spec](https://github.com/graphql/graphql-over-http/blob/main/spec/GraphQLOverHTTP.md#get).If your coprocessor [returns a *different* value](https://www.apollographql.com/docs/graphos/routing/customization/coprocessor#responding-to-coprocessor-requests) for `body`, the router replaces the existing body with that value. This is common when [terminating a client request](https://www.apollographql.com/docs/graphos/routing/customization/coprocessor#terminating-a-client-request).This field's type depends on the coprocessor request's [`stage`](https://www.apollographql.com/docs/graphos/routing/customization/coprocessor#stage):  * For `SubgraphService` stages, `body` is a JSON *object*. * For `SupergraphService` stages, `body` is a JSON *object*. * For `RouterService` stages, `body` is a JSON *string*.   + This is necessary to support handling [deferred queries](https://www.apollographql.com/docs/graphos/routing/customization/coprocessor#handling-deferred-query-responses).   + If you modify `body` during the `RouterRequest` stage, the new value must be a valid string serialization of a JSON object. If it isn't, the router detects that the body is malformed and returns an error to the client.  This field's structure depends on whether the coprocessor request corresponds to a request, a standard response, or a response "chunk" for a deferred query:  * **If a request,** `body` usually contains a `query` property containing the GraphQL query string. * **If a standard response,** `body` usually contains `data` and/or `errors` properties for the GraphQL operation result. * **If a response "chunk",** `body` contains `data` for *some* of the operation fields.  By default, the `RouterResponse` stage returns *redacted* errors within the `errors` field. To process subgraph errors manually in your coprocessor, enable [subgraph error inclusion](https://www.apollographql.com/docs/router/configuration/subgraph-error-inclusion). |
| `context``object` | An object representing the router's shared context for the corresponding client request.If your coprocessor [returns a *different* value](https://www.apollographql.com/docs/graphos/routing/customization/coprocessor#responding-to-coprocessor-requests) for `context`, the router replaces the existing context with that value. |
| `hasNext``bool` | When `stage` is `SupergraphResponse`, if present and `true` then there will be subsequent `SupergraphResponse` calls to the co-processor for each multi-part (`@defer`/subscriptions) response. |
| `headers``object` | An object mapping of all HTTP header names and values for the corresponding request or response.Ensure headers are handled like HTTP headers in general. For example, normalize header case before your coprocessor operates on them.If your coprocessor [returns a *different* value](https://www.apollographql.com/docs/graphos/routing/customization/coprocessor#responding-to-coprocessor-requests) for `headers`, the router replaces the existing headers with that value. The router discards any `content-length` headers sent by coprocessors because incorrect `content-length` values can lead to HTTP request failures. |
| `method``string` | The HTTP method that is used by the request. |
| `path``string` | The `RouterService` or `SupergraphService` path that this coprocessor request pertains to. |
| `sdl``string` | A string representation of the router's current supergraph schema.This value can be very large, so you should avoid including it in coprocessor requests if possible.The router ignores modifications to this value. |
| `serviceName``string` | The name of the subgraph that this coprocessor request pertains to.This value is present only for coprocessor requests from the router's `SubgraphService`.**Do not return a *different* value for this property.** If you do, the router treats the coprocessor request as if it failed. |
| `statusCode``number` | The HTTP status code returned with a response. |
| `uri``string` | When `stage` is `SubgraphRequest`, this is the full URI of the subgraph the router will query. |
| `query_plan``string` | When `stage` is `ExecutionRequest`, this contains the query plan for the client query. It cannot be modified by the coprocessor. |

## Responding to coprocessor requests

The router expects your coprocessor to respond with a `200` status code and a JSON body that matches the structure of the [request body](https://www.apollographql.com/docs/graphos/routing/customization/coprocessor#example-requests-by-stage).

In the response body, your coprocessor can return *modified values* for certain properties. By doing so, you can modify the remainder of the router's execution for the client request.

The router supports modifying the following properties from your coprocessor:

* [`control`](https://www.apollographql.com/docs/graphos/routing/customization/coprocessor#control)

  + Modify this property to immediately [terminate a client request](https://www.apollographql.com/docs/graphos/routing/customization/coprocessor#terminating-a-client-request).
* [`body`](https://www.apollographql.com/docs/graphos/routing/customization/coprocessor#body)
* [`headers`](https://www.apollographql.com/docs/graphos/routing/customization/coprocessor#headers)
* [`context`](https://www.apollographql.com/docs/graphos/routing/customization/coprocessor#context)

**caution****Do not** modify other [control properties](https://www.apollographql.com/docs/graphos/routing/customization/coprocessor#property-reference). Doing so can cause the client request to fail.

If you omit a property from your response body entirely, the router uses its existing value for that property.

### Terminating a client request

Every coprocessor request body includes a `control` property with the string value `continue`. If your coprocessor's response body *also* sets `control` to `continue`, the router continues processing the client request as usual.

Alternatively, your coprocessor's response body can set `control` to an *object* with a `break` property, like so:

JSON copy
```
1{
2  "control": { "break": 401 },
3  "body": {
4    "errors": [
5      {
6        "message": "Not authenticated.",
7        "extensions": {
8          "code": "ERR_UNAUTHENTICATED"
9        }
10      }
11    ]
12  }
13}
```

If the router receives an object with this format for `control`, it immediately terminates the request-handling lifecycle for the client request. It sends an HTTP response to the client with the following details:

* The HTTP status code is set to the value of the `break` property (`401` in the example above).
* The response body is the coprocessor's returned value for `body`.

  + The value of `body` should adhere to the standard GraphQL JSON response format (see the example above).
  + Alternatively, you can specify a string value for `body`. If you do, the router returns an error response with that string as the error's `message`.

The example response above sets the HTTP status code to `400`, which indicates a failed request.

You can *also* use this mechanism to immediately return a *successful* response:

JSON copy
```
1{
2  "control": { "break": 200 },
3  "body": {
4    "data": {
5      "currentUser": {
6        "name": "Ada Lovelace"
7      }
8    }
9  }
10}
```
**note**If you return a successful response, make sure the structure of the `data` property matches the structure expected by the client query.**tip**The `body` in the `RouterRequest` and `RouterResponse` stages is always a string, but you can still `break` with a GraphQL response if it's encoded as JSON.Examples of coprocessor responses for Router stagesJSON copy
```
1{
2  "control": { "break": 500 },
3  "body": "{ \"errors\": [ { \"message\": \"Something went wrong\", \"extensions\": { \"code\": \"INTERNAL_SERVER_ERRROR\" } } ] }"
4}
```
JSON copy
```
1{
2  "control": { "break": 200 },
3  "body": "{ \"data\": { \"currentUser\": { \"name\": \"Ada Lovelace\" } }"
4}
```
**note**If you return a successful response, make sure the structure of the `data` property matches the structure expected by the client query.
### Failed responses

If a request to a coprocessor results in a **failed response**, which is seperate from a **control break**, the router will return an error to the client making the supergraph request. The router considers all of the following scenarios to be a **failed response** from your coprocessor:

* Your coprocessor doesn't respond within the amount of time specified by the `timeout` key in your [configuration](https://www.apollographql.com/docs/graphos/routing/customization/coprocessor#typical-configuration) (default one second).
* Your coprocessor responds with a non-`2xx` HTTP code.
* Your coprocessor's response body doesn't match the JSON structure of the corresponding [request body](https://www.apollographql.com/docs/graphos/routing/customization/coprocessor#example-requests-by-stage).
* Your coprocessor's response body sets different values for [control properties](https://www.apollographql.com/docs/graphos/routing/customization/coprocessor#property-reference) that must not change, such as `stage` and `version`.

## Handling deferred query responses

GraphOS Router and Apollo Router Core support the incremental delivery of query response data via [the `@defer` directive](https://www.apollographql.com/docs/router/executing-operations/defer-support/):

For a single query with deferred fields, your router sends multiple "chunks" of response data to the client. If you enable coprocessor requests for the `RouterResponse` stage, your router sends a separate coprocessor request for *each chunk* it returns as part of a deferred query.

**Note the following about handling deferred response chunks:**

* The [`status_code`](https://www.apollographql.com/docs/graphos/routing/customization/coprocessor#status_code) and [`headers`](https://www.apollographql.com/docs/graphos/routing/customization/coprocessor#headers) fields are included only in the coprocessor request for any response's *first* chunk. These values can't change after the first chunk is returned to the client, so they're subsequently omitted.
* If your coprocessor modifes the response [`body`](https://www.apollographql.com/docs/graphos/routing/customization/coprocessor#body) for a response chunk, it must provide the new value as a *string*, *not* as an object. This is because response chunk bodies include multipart boundary information in addition to the actual serialized JSON response data. [See examples.](https://www.apollographql.com/docs/graphos/routing/customization/coprocessor#examples-of-deferred-response-chunks)

  + Many responses will not contain deferred streams and for these the body string can usually be fairly reliably transformed into a JSON object for easy manipulation within the coprocessor. Coprocessors should be carefully coded to allow for the presence of a body that is not a valid JSON object.
* Because the data is a JSON string at both `RouterRequest` and `RouterResponse`, it's entirely possible for a coprocessor to rewrite the body from invalid JSON content into valid JSON content. This is one of the primary use cases for `RouterRequest` body processing.

### Examples of deferred response chunks

The examples below illustrate the differences between the *first* chunk of a deferred response and all subsequent chunks:

#### First response chunk

The first response chunk includes `headers` and `statusCode` fields:

JSON copy
```
1{
2  "version": 1,
3  "stage": "RouterResponse",
4  "id": "8dee7fe947273640a5c2c7e1da90208c",
5  "sdl": "...", // String omitted due to length
6  "headers": {
7    "content-type": [
8      "multipart/mixed;boundary=\"graphql\";deferSpec=20220824"
9    ],
10    "vary": [
11      "origin"
12    ]
13  },
14  "body": "\r\n--graphql\r\ncontent-type: application/json\r\n\r\n{\"data\":{\"me\":{\"id\":\"1\"}},\"hasNext\":true}\r\n--graphql\r\n",
15  "context": {
16    "entries": {
17      "operation_kind": "query",
18      "apollo_telemetry::client_version": "",
19      "apollo_telemetry::client_name": "manual"
20    }
21  },
22  "statusCode": 200
23}
```
#### Subsequent response chunk

Subsequent response chunks omit the `headers` and `statusCode` fields:

JSON copy
```
1{
2  "version": 1,
3  "stage": "RouterResponse",
4  "id": "8dee7fe947273640a5c2c7e1da90208c",
5  "sdl": "...", // String omitted due to length
6  "body": "content-type: application/json\r\n\r\n{\"hasNext\":false,\"incremental\":[{\"data\":{\"name\":\"Ada Lovelace\"},\"path\":[\"me\"]}]}\r\n--graphql--\r\n",
7  "context": {
8    "entries": {
9      "operation_kind": "query",
10      "apollo_telemetry::client_version": "",
11      "apollo_telemetry::client_name": "manual"
12    }
13  }
14}
```
## Adding authorization claims via coprocessor

To use the [authorization directives](https://www.apollographql.com/docs/router/configuration/authorization#authorization-directives), a request needs to include **claims**the details of its authentication and scope. The most straightforward way to add claims is with [JWT authentication](https://www.apollographql.com/docs/router/configuration/authn-jwt). You can also add claims with a [`RouterService` or `SupergraphService` coprocessor](https://www.apollographql.com/docs/graphos/routing/customization/coprocessor#how-it-works) since they hook into the request lifecycle before the router applies authorization logic.

An example configuration of the router calling a coprocessor for authorization claims:

YAMLrouter.yaml copy
```
1coprocessor:
2  url: http://127.0.0.1:8081 # Required. Replace with the URL of your coprocessor's HTTP endpoint.
3  router: # By including this key, a coprocessor can hook into the `RouterService`. You can also use `SupergraphService` for authorization.
4    request: # By including this key, the `RouterService` sends a coprocessor request whenever it first receives a client request.
5      headers: false # These boolean properties indicate which request data to include in the coprocessor request. All are optional and false by default.
6      context: true # The authorization directives works with claims stored in the request's context
```

This configuration prompts the router to send an HTTP POST request to your coprocessor whenever it receives a client request. For example, your coprocessor may receive a request with this format:

JSON copy
```
1{
2    "version": 1,
3    "stage": "RouterRequest",
4    "control": "continue",
5    "id": "d0a8245df0efe8aa38a80dba1147fb2e",
6    "context": {
7      "entries": {
8        "accepts-json": true
9      }
10    }
11}
```

When your coprocessor receives this request from the router, it should add claims to the request's [`context`](https://www.apollographql.com/docs/graphos/routing/customization/coprocessor#context) and return them in the response to the router. Specifically, the coprocessor should add an entry with a claims object. The key must be `apollo_authentication::JWT::claims`, and the value should be the claims required by the authorization directives you intend to use. For example, if you want to use [`@requireScopes`](https://www.apollographql.com/docs/router/configuration/authorization#requiresscopes), the response may look something like this:

JSON copy
```
1{
2    "version": 1,
3    "stage": "RouterRequest",
4    "control": "continue",
5    "id": "d0a8245df0efe8aa38a80dba1147fb2e",
6    "context": {
7        "entries": {
8            "accepts-json": true,
9            "apollo_authentication::JWT::claims": {
10                "scope": "profile:read profile:write"
11            }
12        }
13    }
14}
```
## Additional resources

* See the Apollo Solutions ["Hello World" coprocessor](https://github.com/apollosolutions/example-coprocessor-helloworld)

   for an example of a coprocessor that simply logs the router's payload.
* See the following Apollo Solutions authorization and authentication examples:

  + [External authentication coprocessor example](https://github.com/apollosolutions/example-coprocessor-external-auth)
  + [Custom auth coprocessor example](https://github.com/apollosolutions/example-coprocessor-custom-auth-directive)
  + [`@policy` coprocessor example](https://github.com/apollosolutions/example-coprocessor-auth-policy)
* Use the Apollo Solutions [router extensibility load testing repository](https://github.com/apollosolutions/router-extensibility-load-testing)

   to load test coprocessors.

**note**The code in this repository is experimental and has been provided for reference purposes only. [PreviousWriting Native Rust Plugins](/docs/graphos/routing/customization/native-plugins)[NextCreating a Custom Apollo Router Core Binary](/docs/graphos/routing/customization/custom-binary)
## On this page

* [How it works](#how-it-works)
* [Multiple requests with SubgraphService](#multiple-requests-with-subgraphservice)
* [Setup](#setup)
* [Typical configuration](#typical-configuration)
* [Minimal configuration](#minimal-configuration)
* [Conditions](#conditions)
* [Client configuration](#client-configuration)
* [Coprocessor request format](#coprocessor-request-format)
* [Example requests by stage](#example-requests-by-stage)
* [Property reference](#property-reference)
* [Responding to coprocessor requests](#responding-to-coprocessor-requests)
* [Terminating a client request](#terminating-a-client-request)
* [Failed responses](#failed-responses)
* [Handling deferred query responses](#handling-deferred-query-responses)
* [Examples of deferred response chunks](#examples-of-deferred-response-chunks)
* [Adding authorization claims via coprocessor](#adding-authorization-claims-via-coprocessor)
* [Additional resources](#additional-resources)
   Give FeedbackFeedback  [Edit on GitHub](https://github.com/apollographql/router/blob/main/docs/source/routing/customization/coprocessor.mdx)   [Forums](https://community.apollographql.com/)

 2025 Apollo Graph Inc., d/b/a Apollo GraphQL.

[Privacy Policy](https://www.apollographql.com/privacy-policy)
## Company

* [About Apollo](https://www.apollographql.com/about-us)
* [Careers](https://www.apollographql.com/careers)
* [Partners](https://www.apollographql.com/partners)
## Resources

* [Blog](https://blog.apollographql.com)
* [Tutorials](https://www.apollographql.com/tutorials)
* [Content Library](https://www.apollographql.com/resources)
## Get in touch

* [Contact Sales](https://www.apollographql.com/contact-sales)
* [Contact Support](https://www.apollographql.com/support)
