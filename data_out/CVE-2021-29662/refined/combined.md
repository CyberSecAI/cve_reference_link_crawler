=== Content from sick.codes_d2f0c396_20250108_104838.html ===


* [Home](https://sick.codes/)
* [Releases](https://sick.codes/category/security/)
* [Submit Vuln](https://sick.codes/submit-vulnerability/)
* [Press](https://sick.codes/press-coverage/)
* [About](https://sick.codes/about/)
* [PGP](https://sick.codes/pgp-key/)
* [Contact](https://sick.codes/contact/)
  + [Contact](https://sick.codes/contact/)
  + [Submit Vuln](https://sick.codes/submit-vulnerability/)
  + [VDP](https://sick.codes/vdp/)
* [Tutorials](https://sick.codes/tutorials/)
  + [All Posts](https://sick.codes/tutorials/)
  + [Photoshop on Linux](https://sick.codes/how-to-install-100-working-photoshop-cs6-or-cc-on-ubuntu-debian-mint/)
  + [macOS on Linux](https://sick.codes/how-to-install-macos-virtual-machine-on-linux-arch-manjaro-catalina-mojave-or-high-sierra-xcode-working/)
* [Supporters](https://sick.codes/supporters/)
* [Projects](https://sick.codes/projects/)
* [Training](https://sick.codes/training/)

[![Sick Codes - Security Research, Hardware & Software Hacking, Consulting, Linux, IoT, Cloud, Embedded, Arch, Tweaks & Tips!](https://sick.codes/wp-content/uploads/2016/10/logo.png)](https://sick.codes/)

* [Home](https://sick.codes/)
* [Releases](https://sick.codes/category/security/)
* [Submit Vuln](https://sick.codes/submit-vulnerability/)
* [Press](https://sick.codes/press-coverage/)
* [About](https://sick.codes/about/)
* [PGP](https://sick.codes/pgp-key/)
* [Contact](https://sick.codes/contact/)
  + [Contact](https://sick.codes/contact/)
  + [Submit Vuln](https://sick.codes/submit-vulnerability/)
  + [VDP](https://sick.codes/vdp/)
* [Tutorials](https://sick.codes/tutorials/)
  + [All Posts](https://sick.codes/tutorials/)
  + [Photoshop on Linux](https://sick.codes/how-to-install-100-working-photoshop-cs6-or-cc-on-ubuntu-debian-mint/)
  + [macOS on Linux](https://sick.codes/how-to-install-macos-virtual-machine-on-linux-arch-manjaro-catalina-mojave-or-high-sierra-xcode-working/)
* [Supporters](https://sick.codes/supporters/)
* [Projects](https://sick.codes/projects/)
* [Training](https://sick.codes/training/)

No Result
 View All Result

[![Sick Codes - Security Research, Hardware & Software Hacking, Consulting, Linux, IoT, Cloud, Embedded, Arch, Tweaks & Tips!](https://sick.codes/wp-content/uploads/2016/10/logo.png)](https://sick.codes/)

* [Home](https://sick.codes/)
* [Releases](https://sick.codes/category/security/)
* [Submit Vuln](https://sick.codes/submit-vulnerability/)
* [Press](https://sick.codes/press-coverage/)
* [About](https://sick.codes/about/)
* [PGP](https://sick.codes/pgp-key/)
* [Contact](https://sick.codes/contact/)
  + [Contact](https://sick.codes/contact/)
  + [Submit Vuln](https://sick.codes/submit-vulnerability/)
  + [VDP](https://sick.codes/vdp/)
* [Tutorials](https://sick.codes/tutorials/)
  + [All Posts](https://sick.codes/tutorials/)
  + [Photoshop on Linux](https://sick.codes/how-to-install-100-working-photoshop-cs6-or-cc-on-ubuntu-debian-mint/)
  + [macOS on Linux](https://sick.codes/how-to-install-macos-virtual-machine-on-linux-arch-manjaro-catalina-mojave-or-high-sierra-xcode-working/)
* [Supporters](https://sick.codes/supporters/)
* [Projects](https://sick.codes/projects/)
* [Training](https://sick.codes/training/)

No Result
 View All Result

[![Sick Codes - Security Research, Hardware & Software Hacking, Consulting, Linux, IoT, Cloud, Embedded, Arch, Tweaks & Tips!](https://sick.codes/wp-content/uploads/2016/10/logo.png)](https://sick.codes/)

No Result
 View All Result

[Home](https://sick.codes)
[Security](https://sick.codes/category/security/)

# CVE-2021-29662 – Perl module Data::Validate::IP – Improper Input Validation of octal literals in Perl Data::Validate::IP v0.29 and below results in indeterminate SSRF & RFI vulnerabilities.

by
[Sick Codes](https://sick.codes/author/admin/)
[March 31, 2021 - Updated on April 8, 2021](https://sick.codes/sick-2021-018/)

in
[Security](https://sick.codes/category/security/)

 [1](https://sick.codes/sick-2021-018/#comments)

[![SICK-2021-018 PERL Data::Validate::IP](https://sick.codes/wp-content/themes/jnews/assets/img/jeg-empty.png)

SICK-2021-018 PERL Data::Validate::IP](https://sick.codes/wp-content/uploads/2021/03/SICK-2021-018-PERL-DataValidateIP.png)

### Title

Perl module Data::Validate::IP – Improper Input Validation of octal literals in Perl Data::Validate::IP v0.29 and below results in indeterminate SSRF & RFI vulnerabilities.

### CVE ID

CVE-2021-29662

### CVSS Score

7.5

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N

### Internal ID

SICK-2021-018

### Vendor

Perl (houseabsolute)

### Product

Perl distribution Data-Validate-IP

### Product Versions

0.29 and below

### Vulnerability Details

Improper input validation of octal strings in Perl’s Data::Validate::IP module allows remote unauthenticated attackers to perform indeterminate SSRF, RFI, and LFI attacks on many Perl applications that rely on Perl’s Data::Validate::IP to validate if an ipv4 address is\_private\_ipv4() or not. For example, an attacker can submit the input data: 012.0.0.1, which should be private (012 is 10 in decimal), however the module returns a false negative result, resulting in SSRF bypass techniques. For example, 0254.16.0.1 should be evaluated as 172.16.0.1, which is private, yet the module returns the incorrect response (false). An attacker submitting an IP address to a web or local application that relies on Data::Validate::IP to validate IP addresses as private or public will be able to bypass the validation provided by this module, resulting in a wide range of attack surfaces on dependencies of Perl’s Data::Validate::IP.

### Vendor Response

Patched

### Proof of Concept

```
<!-- // Authors:      sickcodes, Kelly Kaoudis -->
<!-- // License:      GPLv3+ -->

use Data::Validate::IP;

my $answer = " is private according to is_private_ipv4? ";

sub is_private {
    return is_private_ipv4($_[0]) ? "true" : "false";
}

my $dec_ip_string = '10.0.0.1';
my $is_private = is_private($dec_ip_string);
print "\n10.0.0.1 should be private";
print "\ninput: " . $dec_ip_string . $answer . $is_private . "\n";

my $oct_ip_string = '012.0.0.1';
my $is_oct_private = is_private($oct_ip_string);
print "\n" . $oct_ip_string . " should be private (012 is 10 in decimal)";
print "\ninput: " . $oct_ip_string . $answer . $is_oct_private . "\n";

my $oct_ip_string1 = '010.0.0.1';
my $is_oct_private1 = is_private($oct_ip_string1);
print "\n" . $oct_ip_string1 . " should not be private (010 is 8 in decimal)";
print "\ninput: " . $oct_ip_string1 . $answer . $is_oct_private1 . "\n";

my $dec_ip_string1 = '172.16.0.1';
my $is_private1 = is_private($dec_ip_string1);
print "\n" . $dec_ip_string1 . " should be private";
print "\ninput: " . $dec_ip_string1 . $answer . $is_private1 . "\n";

my $oct_ip_string2 = '0172.16.0.1';
my $is_oct_private2 = is_private($oct_ip_string2);
print "\n" . $oct_ip_string2 . " should not be private (0172 is 122)";
print "\ninput: " . $oct_ip_string2 . $answer . $is_oct_private2 . "\n";

my $oct_ip_string3 = '0254.16.0.1';
my $is_oct_private3 = is_private($oct_ip_string3);
print "\n" . $oct_ip_string3 . " should be private (0254 is 172)";
print "\ninput: " . $oct_ip_string3 . $answer . $is_oct_private3 . "\n";

my $dec_ip_string_2 = '192.168.0.1';
my $is_private2 = is_private($dec_ip_string_2);
print "\n" . $dec_ip_string_2 . " should be private";
print "\ninput: " . $dec_ip_string_2 . $answer . $is_private2 . "\n";

my $oct_ip_string4 = '0192.168.0.1';
my $is_oct_private4 = is_private($oct_ip_string4);
print "\n" . $oct_ip_string4 . " should be private (0192 in octal is 192 in decimal)";
print "\ninput: " . $oct_ip_string4 . $answer . $is_oct_private4 . "\n";

# for the following, c.f. https://github.com/frenchbread/private-ip/pull/2
my $oct_ip_string5 = '0000.0000.0000.0000';
my $is_oct_private5 = is_private($oct_ip_string5);
print "\n" . $oct_ip_string5 . " should be considered private, but is not";
print "\ninput: " . $oct_ip_string5 . $answer . $is_oct_private5 . "\n";

my $dec_ip_string_3 = '127.0.0.1';
my $is_private3 = is_private($dec_ip_string_3);
print "\n" . $dec_ip_string_3 . " should be considered private, but is not";
print "\ninput: " . $dec_ip_string_3 . $answer . $is_private3 . "\n";

my $oct_ip_string6 = '0127.0.0.1';
my $is_oct_private6 = is_private($oct_ip_string6);
print "\n" . $oct_ip_string6 . " should not be considered private (0127 in octal is 87 in decimal)";
print "\ninput: " . $oct_ip_string6 . $answer . $is_oct_private6 . "\n";

my $oct_ip_string7 = '0177.0.0.1';
my $is_oct_private7 = is_private($oct_ip_string7);
print "\n" . $oct_ip_string7 . " should be considered private, but is not (0177 is 127 in decimal)";
print "\ninput: " . $oct_ip_string7 . $answer . $is_oct_private7 . "\n";
```
#### Disclosure Timeline

* **2021-03-29** – Vendor patches similar vulnerability
* **2021-03-29** – Researchers discover additional bypasses
* **2021-03-29** – Vendor notified
* **2021-03-29** – CVE requested
* **2021-03-31** – CVE assigned CVE-2021-29662
* **2021-03-31** – CVE published

### Links

<https://github.com/houseabsolute/Data-Validate-IP/commit/3bba13c819d616514a75e089badd75002fd4f14e>

<https://github.com/houseabsolute/Data-Validate-IP>

<https://github.com/sickcodes/security/blob/master/advisories/SICK-2021-018.md>

<https://sick.codes/sick-2021-018/>

### Researchers

Dave Rolsky <https://github.com/houseabsolute/>

Victor Viale: <https://github.com/koroeskohr> || <https://twitter.com/koroeskohr>

Sick Codes: <https://github.com/sickcodes> || <https://twitter.com/sickcodes>

Kelly Kaoudis: <https://github.com/kaoudis> || <https://twitter.com/kaoudis>

John Jackson <https://www.twitter.com/johnjhacking>

Nick Sahler: <https://github.com/nicksahler> || <https://twitter.com/tensor_bodega>

Olivier Poitrey <https://github.com/rs> || <https://twitter.com/olivier_poitrey>

#### CVE Links

<https://sick.codes/sick-2021-018/>

<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-29662>

<https://nvd.nist.gov/view/vuln/detail?vulnId=CVE-2021-29662>

Next Post
[![How to mount images inside a docker container](https://sick.codes/wp-content/themes/jnews/assets/img/jeg-empty.png)](https://sick.codes/how-to-mount-devices-inside-docker-containers-losetup-loopback-iso-files/)
### [How To Mount Images or Devices Inside Docker Containers (losetup, loopback, ISO files, disk images, raw images, ext4, exfat, hfs, apfs)](https://sick.codes/how-to-mount-devices-inside-docker-containers-losetup-loopback-iso-files/)

[![John Deere Account Portal - Information Disclosure - Rate Limitless Username Enumeration Via Unauthenticated Availability Look-ups](https://sick.codes/wp-content/themes/jnews/assets/img/jeg-empty.png)](https://sick.codes/sick-2021-012/)
### [SICK-2021-012 - John Deere Account Portal - Information Disclosure - Rate Limitless Username Enumeration Via Unauthenticated Availability Look-ups.](https://sick.codes/sick-2021-012/)

[![John Deere Operations Center - Improper Authorization Allows Exposure of Sensitive Information to an Unauthorized Actor via Farming Equipment VIN API](https://sick.codes/wp-content/themes/jnews/assets/img/jeg-empty.png)](https://sick.codes/sick-2021-031/)
### [SICK-2021-031 - John Deere Operations Center - Improper Authorization Allows Exposure of Sensitive Information to an Unauthorized Actor via Farming Equipment VIN API - iOS 5.1.2 and below, Android 5.1.4 and below, Web App](https://sick.codes/sick-2021-031/)

### Comments 1

1. Pingback: [Vulnerabilidad en (Data) - CVE-2021-29662 - Información y Soluciones](https://vulnerability.app/data/cve-2021-29662-data/)

### Leave a Reply [Cancel reply](/sick-2021-018/#respond)

Your email address will not be published. Required fields are marked \*

Comment \*

Name

Email

Website

No Result
 View All Result

* [Home](https://sick.codes/)
* [Releases](https://sick.codes/category/security/)
* [Submit Vuln](https://sick.codes/submit-vulnerability/)
* [Press](https://sick.codes/press-coverage/)
* [About](https://sick.codes/about/)
* [PGP](https://sick.codes/pgp-key/)
* [Contact](https://sick.codes/contact/)
  + [Contact](https://sick.codes/contact/)
  + [Submit Vuln](https://sick.codes/submit-vulnerability/)
  + [VDP](https://sick.codes/vdp/)
* [Tutorials](https://sick.codes/tutorials/)
  + [All Posts](https://sick.codes/tutorials/)
  + [Photoshop on Linux](https://sick.codes/how-to-install-100-working-photoshop-cs6-or-cc-on-ubuntu-debian-mint/)
  + [macOS on Linux](https://sick.codes/how-to-install-macos-virtual-machine-on-linux-arch-manjaro-catalina-mojave-or-high-sierra-xcode-working/)
* [Supporters](https://sick.codes/supporters/)
* [Projects](https://sick.codes/projects/)
* [Training](https://sick.codes/training/)

© 2017-2021 [Sick.Codes](/ "Sick Codes")

#### [@sickcodes](https://github.com/sickcodes)

#### [@sickcodes](https://twitter.com/sickcodes)

#### [@sickcodes](https://www.linkedin.com/in/sickcodes)

#### [Discord Server](https://discord.com/invite/mx8pPw39Yg)

#### [sickcodes.slack.com](https://join.slack.com/t/sickcodes/shared_invite/zt-tsi4f7gy-wkh46eeQVUMq5j3Naf7RrA)

#### [t.me/sickcodeschat](https://t.me/sickcodeschat)

#### [./contact\_form](https://sick.codes/contact)



=== Content from github.com_3965b5bc_20250108_104836.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhouseabsolute%2FData-Validate-IP%2Fcommit%2F3bba13c819d616514a75e089badd75002fd4f14e)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhouseabsolute%2FData-Validate-IP%2Fcommit%2F3bba13c819d616514a75e089badd75002fd4f14e)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=houseabsolute%2FData-Validate-IP)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[houseabsolute](/houseabsolute)
/
**[Data-Validate-IP](/houseabsolute/Data-Validate-IP)**
Public

* [Notifications](/login?return_to=%2Fhouseabsolute%2FData-Validate-IP) You must be signed in to change notification settings
* [Fork
  2](/login?return_to=%2Fhouseabsolute%2FData-Validate-IP)
* [Star
   4](/login?return_to=%2Fhouseabsolute%2FData-Validate-IP)

* [Code](/houseabsolute/Data-Validate-IP)
* [Issues
  4](/houseabsolute/Data-Validate-IP/issues)
* [Pull requests
  0](/houseabsolute/Data-Validate-IP/pulls)
* [Actions](/houseabsolute/Data-Validate-IP/actions)
* [Wiki](/houseabsolute/Data-Validate-IP/wiki)
* [Security](/houseabsolute/Data-Validate-IP/security)
* [Insights](/houseabsolute/Data-Validate-IP/pulse)

Additional navigation options

* [Code](/houseabsolute/Data-Validate-IP)
* [Issues](/houseabsolute/Data-Validate-IP/issues)
* [Pull requests](/houseabsolute/Data-Validate-IP/pulls)
* [Actions](/houseabsolute/Data-Validate-IP/actions)
* [Wiki](/houseabsolute/Data-Validate-IP/wiki)
* [Security](/houseabsolute/Data-Validate-IP/security)
* [Insights](/houseabsolute/Data-Validate-IP/pulse)

## Commit

[Permalink](/houseabsolute/Data-Validate-IP/commit/3bba13c819d616514a75e089badd75002fd4f14e)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Update security note in docs to include mention of is\_ip() and friends

[Browse files](/houseabsolute/Data-Validate-IP/tree/3bba13c819d616514a75e089badd75002fd4f14e)
Browse the repository at this point in the history

* Loading branch information

[![@autarch](https://avatars.githubusercontent.com/u/50729?s=40&v=4)](/autarch)

[autarch](/houseabsolute/Data-Validate-IP/commits?author=autarch "View all commits by autarch")
committed
Mar 29, 2021

1 parent
[7793a30](/houseabsolute/Data-Validate-IP/commit/7793a30fe8ff2f3804fa4ca55a90cb5c2618fa61)

commit 3bba13c

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**15 additions**
and
**9 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* Changes
  [Changes](#diff-bbd4b6a86bc65b6ac8e79e97afc61499158edb40f7bb404c70637b46d80a7ad2)
* lib/Data/Validate

  + lib/Data/Validate/IP.pm
    [IP.pm](#diff-571071973a508ea29391c23f079fc4361fea776401b5c6e20598b72db43b2acb)

## There are no files selected for viewing

4 changes: 4 additions & 0 deletions

4
[Changes](#diff-bbd4b6a86bc65b6ac8e79e97afc61499158edb40f7bb404c70637b46d80a7ad2 "Changes")

Show comments

[View file](/houseabsolute/Data-Validate-IP/blob/3bba13c819d616514a75e089badd75002fd4f14e/Changes)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,5 +1,9 @@ |
|  |  | {{$NEXT}} |
|  |  |  |
|  |  | - Added some more details to the security docs to include mentions of the |
|  |  | is\_\*\_ip() functions too. |
|  |  |  |
|  |  |  |
|  |  | 0.29 2021-03-29 |
|  |  |  |
|  |  | - Fixed a typo in the POD. |
| Expand Down | |  |

20 changes: 11 additions & 9 deletions

20
[lib/Data/Validate/IP.pm](#diff-571071973a508ea29391c23f079fc4361fea776401b5c6e20598b72db43b2acb "lib/Data/Validate/IP.pm")

Show comments

[View file](/houseabsolute/Data-Validate-IP/blob/3bba13c819d616514a75e089badd75002fd4f14e/lib/Data/Validate/IP.pm)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -642,24 +642,26 @@ specific network or whether an address is public or private (reserved). |
|  |  |  |
|  |  | =head1 USAGE AND SECURITY RECOMMENDATIONS |
|  |  |  |
|  |  | It's important to understand that if C<is\_ipv4($ip)> or C<is\_ipv6($ip)> return |
|  |  | false, then all other validation functions for that IP address family will |
|  |  | I<also> return false. So for example, if C<is\_ipv4($ip)> is false, so are both |
|  |  | C<is\_private\_ipv4($ip)> I<and> C<is\_public\_ipv4($ip)>. |
|  |  | It's important to understand that if C<is\_ipv4($ip)>, C<is\_ipv6($ip)>, or |
|  |  | C<is\_ip($ip)> return false, then all other validation functions for that IP |
|  |  | address family will I<also> return false. So for example, if C<is\_ipv4($ip)> |
|  |  | returns false, then C<is\_private\_ipv4($ip)> I<and> C<is\_public\_ipv4($ip)> will |
|  |  | both also return false. |
|  |  |  |
|  |  | This means that simply calling C<is\_private\_ipv4($ip)> by itself is not |
|  |  | sufficient if you are dealing with untrusted input. You should always check |
|  |  | C<is\_ipv4($ip)> as well. |
|  |  | C<is\_ipv4($ip)> as well. This applies as well when using IPv6 functions or |
|  |  | generic functions like C<is\_private\_ip($ip)>. |
|  |  |  |
|  |  | There are security implications to this around certain oddly formed |
|  |  | addresses. Notably, an address like "010.0.0.1" is technically valid, but the |
|  |  | operating system will treat "010" as an octal number. That means that |
|  |  | "010.0.0.1" is equivalent to "8.0.0.1", I<not> "10.0.0.1". |
|  |  |  |
|  |  | However, this module's C<is\_ipv4($ip)> function will return false for |
|  |  | addresses like "010.0.0.1" which have octal components. And of course that |
|  |  | means that it also returns false for C<is\_private\_ipv4($ip)> I<and> |
|  |  | C<is\_public\_ipv4($ip)>. |
|  |  | However, this module's C<is\_ipv4($ip)> and C<is\_ip($ip)> functions will return |
|  |  | false for addresses like "010.0.0.1" which have octal components. And of |
|  |  | course that means that it also returns false for C<is\_private\_ipv4($ip)> |
|  |  | I<and> C<is\_public\_ipv4($ip)>. |
|  |  |  |
|  |  | =head1 FUNCTIONS |
|  |  |  |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 1 comment on commit `3bba13c`

[![@abergmann](https://avatars.githubusercontent.com/u/4102163?s=80&v=4)](/abergmann)

Copy link

### @abergmann **[abergmann](/abergmann)** commented on `[3bba13c](/houseabsolute/Data-Validate-IP/commit/3bba13c819d616514a75e089badd75002fd4f14e)` [Apr 7, 2021](#commitcomment-49195868)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

[CVE-2021-29662](https://nvd.nist.gov/vuln/detail/CVE-2021-29662) was assigned to this commit.

Sorry, something went wrong.

All reactions

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhouseabsolute%2FData-Validate-IP%2Fcommit%2F3bba13c819d616514a75e089badd75002fd4f14e) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_b06931c3_20250108_104835.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhouseabsolute%2FData-Validate-IP)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhouseabsolute%2FData-Validate-IP)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=houseabsolute%2FData-Validate-IP)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[houseabsolute](/houseabsolute)
/
**[Data-Validate-IP](/houseabsolute/Data-Validate-IP)**
Public

* [Notifications](/login?return_to=%2Fhouseabsolute%2FData-Validate-IP) You must be signed in to change notification settings
* [Fork
  2](/login?return_to=%2Fhouseabsolute%2FData-Validate-IP)
* [Star
   4](/login?return_to=%2Fhouseabsolute%2FData-Validate-IP)

IPv4 and IPv6 validation methods

[metacpan.org/release/Data-Validate-IP/](https://metacpan.org/release/Data-Validate-IP/ "https://metacpan.org/release/Data-Validate-IP/")

### License

[View license](/houseabsolute/Data-Validate-IP/blob/master/LICENSE)

[4
stars](/houseabsolute/Data-Validate-IP/stargazers) [2
forks](/houseabsolute/Data-Validate-IP/forks) [Branches](/houseabsolute/Data-Validate-IP/branches) [Tags](/houseabsolute/Data-Validate-IP/tags) [Activity](/houseabsolute/Data-Validate-IP/activity)
 [Star](/login?return_to=%2Fhouseabsolute%2FData-Validate-IP)

 [Notifications](/login?return_to=%2Fhouseabsolute%2FData-Validate-IP) You must be signed in to change notification settings

* [Code](/houseabsolute/Data-Validate-IP)
* [Issues
  4](/houseabsolute/Data-Validate-IP/issues)
* [Pull requests
  0](/houseabsolute/Data-Validate-IP/pulls)
* [Actions](/houseabsolute/Data-Validate-IP/actions)
* [Wiki](/houseabsolute/Data-Validate-IP/wiki)
* [Security](/houseabsolute/Data-Validate-IP/security)
* [Insights](/houseabsolute/Data-Validate-IP/pulse)

Additional navigation options

* [Code](/houseabsolute/Data-Validate-IP)
* [Issues](/houseabsolute/Data-Validate-IP/issues)
* [Pull requests](/houseabsolute/Data-Validate-IP/pulls)
* [Actions](/houseabsolute/Data-Validate-IP/actions)
* [Wiki](/houseabsolute/Data-Validate-IP/wiki)
* [Security](/houseabsolute/Data-Validate-IP/security)
* [Insights](/houseabsolute/Data-Validate-IP/pulse)

# houseabsolute/Data-Validate-IP

    master[Branches](/houseabsolute/Data-Validate-IP/branches)[Tags](/houseabsolute/Data-Validate-IP/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[169 Commits](/houseabsolute/Data-Validate-IP/commits/master/) | | |
| [bench](/houseabsolute/Data-Validate-IP/tree/master/bench "bench") | | [bench](/houseabsolute/Data-Validate-IP/tree/master/bench "bench") |  |  |
| [dev-bin](/houseabsolute/Data-Validate-IP/tree/master/dev-bin "dev-bin") | | [dev-bin](/houseabsolute/Data-Validate-IP/tree/master/dev-bin "dev-bin") |  |  |
| [git](/houseabsolute/Data-Validate-IP/tree/master/git "git") | | [git](/houseabsolute/Data-Validate-IP/tree/master/git "git") |  |  |
| [lib/Data/Validate](/houseabsolute/Data-Validate-IP/tree/master/lib/Data/Validate "This path skips through empty directories") | | [lib/Data/Validate](/houseabsolute/Data-Validate-IP/tree/master/lib/Data/Validate "This path skips through empty directories") |  |  |
| [t](/houseabsolute/Data-Validate-IP/tree/master/t "t") | | [t](/houseabsolute/Data-Validate-IP/tree/master/t "t") |  |  |
| [.gitignore](/houseabsolute/Data-Validate-IP/blob/master/.gitignore ".gitignore") | | [.gitignore](/houseabsolute/Data-Validate-IP/blob/master/.gitignore ".gitignore") |  |  |
| [.mailmap](/houseabsolute/Data-Validate-IP/blob/master/.mailmap ".mailmap") | | [.mailmap](/houseabsolute/Data-Validate-IP/blob/master/.mailmap ".mailmap") |  |  |
| [CODE\_OF\_CONDUCT.md](/houseabsolute/Data-Validate-IP/blob/master/CODE_OF_CONDUCT.md "CODE_OF_CONDUCT.md") | | [CODE\_OF\_CONDUCT.md](/houseabsolute/Data-Validate-IP/blob/master/CODE_OF_CONDUCT.md "CODE_OF_CONDUCT.md") |  |  |
| [CONTRIBUTING.md](/houseabsolute/Data-Validate-IP/blob/master/CONTRIBUTING.md "CONTRIBUTING.md") | | [CONTRIBUTING.md](/houseabsolute/Data-Validate-IP/blob/master/CONTRIBUTING.md "CONTRIBUTING.md") |  |  |
| [Changes](/houseabsolute/Data-Validate-IP/blob/master/Changes "Changes") | | [Changes](/houseabsolute/Data-Validate-IP/blob/master/Changes "Changes") |  |  |
| [LICENSE](/houseabsolute/Data-Validate-IP/blob/master/LICENSE "LICENSE") | | [LICENSE](/houseabsolute/Data-Validate-IP/blob/master/LICENSE "LICENSE") |  |  |
| [README.md](/houseabsolute/Data-Validate-IP/blob/master/README.md "README.md") | | [README.md](/houseabsolute/Data-Validate-IP/blob/master/README.md "README.md") |  |  |
| [azure-pipelines.yml](/houseabsolute/Data-Validate-IP/blob/master/azure-pipelines.yml "azure-pipelines.yml") | | [azure-pipelines.yml](/houseabsolute/Data-Validate-IP/blob/master/azure-pipelines.yml "azure-pipelines.yml") |  |  |
| [cpanfile](/houseabsolute/Data-Validate-IP/blob/master/cpanfile "cpanfile") | | [cpanfile](/houseabsolute/Data-Validate-IP/blob/master/cpanfile "cpanfile") |  |  |
| [dist.ini](/houseabsolute/Data-Validate-IP/blob/master/dist.ini "dist.ini") | | [dist.ini](/houseabsolute/Data-Validate-IP/blob/master/dist.ini "dist.ini") |  |  |
| [perlcriticrc](/houseabsolute/Data-Validate-IP/blob/master/perlcriticrc "perlcriticrc") | | [perlcriticrc](/houseabsolute/Data-Validate-IP/blob/master/perlcriticrc "perlcriticrc") |  |  |
| [perltidyrc](/houseabsolute/Data-Validate-IP/blob/master/perltidyrc "perltidyrc") | | [perltidyrc](/houseabsolute/Data-Validate-IP/blob/master/perltidyrc "perltidyrc") |  |  |
| [precious.toml](/houseabsolute/Data-Validate-IP/blob/master/precious.toml "precious.toml") | | [precious.toml](/houseabsolute/Data-Validate-IP/blob/master/precious.toml "precious.toml") |  |  |
| View all files | | |

## Repository files navigation

* README
* Code of conduct
* License
# NAME

Data::Validate::IP - IPv4 and IPv6 validation methods

# VERSION

version 0.31

# SYNOPSIS

```
use Data::Validate::IP qw(is_ipv4 is_ipv6);

my $suspect = '1.2.3.4';
if (is_ipv4($suspect)) {
    print "Looks like an IPv4 address";
}
else {
    print "Not an IPv4 address\n";
}

$suspect = '::1234';
if (is_ipv6($suspect)) {
    print "Looks like an IPv6 address";
}
else {
    print "Not an IPv6 address\n";
}

```

# DESCRIPTION

This module provides a number IP address validation subs that both validate and
untaint their input. This includes both basic validation (`is_ipv4()` and
`is_ipv6()`) and special cases like checking whether an address belongs to a
specific network or whether an address is public or private (reserved).

# USAGE AND SECURITY RECOMMENDATIONS

It's important to understand that if `is_ipv4($ip)`, `is_ipv6($ip)`, or
`is_ip($ip)` return false, then all other validation functions for that IP
address family will *also* return false. So for example, if `is_ipv4($ip)`
returns false, then `is_private_ipv4($ip)` *and* `is_public_ipv4($ip)` will
both also return false.

This means that simply calling `is_private_ipv4($ip)` by itself is not
sufficient if you are dealing with untrusted input. You should always check
`is_ipv4($ip)` as well. This applies as well when using IPv6 functions or
generic functions like `is_private_ip($ip)`.

There are security implications to this around certain oddly formed addresses.
Notably, an address like "010.0.0.1" is technically valid, but the operating
system will treat "010" as an octal number. That means that "010.0.0.1" is
equivalent to "8.0.0.1", *not* "10.0.0.1".

However, this module's `is_ipv4($ip)` and `is_ip($ip)` functions will return
false for addresses like "010.0.0.1" which have octal components. And of course
that means that it also returns false for `is_private_ipv4($ip)` *and*
`is_public_ipv4($ip)`.

# FUNCTIONS

All of the functions below are exported by default.

All functions return an untainted value if the test passes and undef if it
fails. In theory, this means that you should always check for a defined status
explicitly but in practice there are no valid IP addresses where the string
form evaluates to false in Perl.

Note that none of these functions actually attempt to test whether the given IP
address is routable from your device; they are purely semantic checks.

## is\_ipv4($ip), is\_ipv6($ip), is\_ip($ip)

These functions simply check whether the address is a valid IPv4 or IPv6
address.

## is\_innet\_ipv4($ip, $network)

This subroutine checks whether the address belongs to the given IPv4 network.
The `$network` argument can either be a string in CIDR notation like
"15.0.15.0/24" or a [NetAddr::IP](https://metacpan.org/pod/NetAddr%3A%3AIP) object.

This subroutine used to accept many more forms of network specifications
(anything [Net::Netmask](https://metacpan.org/pod/Net%3A%3ANetmask) accepts) but this has been deprecated.

## is\_unroutable\_ipv4($ip)

This subroutine checks whether the address belongs to any of several special
use IPv4 networks - `0.0.0.0/8`, `100.64.0.0/10`, `192.0.0.0/29`,
`198.18.0.0/15`, `240.0.0.0/4` - as defined by [RFC
5735](http://tools.ietf.org/html/rfc5735), [RFC
6333](http://tools.ietf.org/html/rfc6333), and [RFC
6958](http://tools.ietf.org/html/rfc6598).

Arguably, these should be broken down further but this subroutine will always
exist for backwards compatibility.

## is\_private\_ipv4($ip)

This subroutine checks whether the address belongs to any of the private IPv4
networks - `10.0.0.0/8`, `172.16.0.0/12`, `192.168.0.0/16` - as defined by
[RFC 5735](http://tools.ietf.org/html/rfc5735).

## is\_loopback\_ipv4($ip)

This subroutine checks whether the address belongs to the IPv4 loopback network
- `127.0.0.0/8` - as defined by [RFC
5735](http://tools.ietf.org/html/rfc5735).

## is\_linklocal\_ipv4($ip)

This subroutine checks whether the address belongs to the IPv4 link local
network - `169.254.0.0/16` - as defined by [RFC
5735](http://tools.ietf.org/html/rfc5735).

## is\_testnet\_ipv4($ip)

This subroutine checks whether the address belongs to any of the IPv4 TEST-NET
networks for use in documentation and example code - `192.0.2.0/24`,
`198.51.100.0/24`, and `203.0.113.0/24` - as defined by [RFC
5735](http://tools.ietf.org/html/rfc5735).

## is\_anycast\_ipv4($ip)

This subroutine checks whether the address belongs to the 6to4 relay anycast
network - `192.88.99.0/24` - as defined by [RFC
5735](http://tools.ietf.org/html/rfc5735).

## is\_multicast\_ipv4($ip)

This subroutine checks whether the address belongs to the IPv4 multicast
network - `224.0.0.0/4` - as defined by [RFC
5735](http://tools.ietf.org/html/rfc5735).

## is\_loopback\_ipv6($ip)

This subroutine checks whether the address is the IPv6 loopback address -
`::1/128` - as defined by [RFC 4291](http://tools.ietf.org/html/rfc4291).

## is\_ipv4\_mapped\_ipv6($ip)

This subroutine checks whether the address belongs to the IPv6 IPv4-mapped
address network - `::ffff:0:0/96` - as defined by [RFC
4291](http://tools.ietf.org/html/rfc4291).

## is\_discard\_ipv6($ip)

This subroutine checks whether the address belongs to the IPv6 discard prefix
network - `100::/64` - as defined by [RFC
6666](http://tools.ietf.org/html/rfc6666).

## is\_special\_ipv6($ip)

This subroutine checks whether the address belongs to the IPv6 special network
- `2001::/23` - as defined by [RFC 2928](http://tools.ietf.org/html/rfc2928).

## is\_teredo\_ipv6($ip)

This subroutine checks whether the address belongs to the IPv6 TEREDO network -
`2001::/32` - as defined by [RFC 4380](http://tools.ietf.org/html/rfc4380).

Note that this network is a subnet of the larger special network at
`2001::/23`.

## is\_orchid\_ipv6($ip)

This subroutine checks whether the address belongs to the IPv6 ORCHID network -
`2001::/32` - as defined by [RFC 4380](http://tools.ietf.org/html/rfc4380).

Note that this network is a subnet of the larger special network at
`2001::/23`.

This network is currently scheduled to be returned to the special pool in March
of 2014 unless the IETF extends its use. If that happens this subroutine will
continue to exist but will always return false.

## is\_documentation\_ipv6($ip)

This subroutine checks whether the address belongs to the IPv6 documentation
network - `2001:DB8::/32` - as defined by [RFC
3849](http://tools.ietf.org/html/rfc3849).

## is\_unspecified\_ipv6($ip)

This subroutine checks whether the address belongs to the IPv6 unspecified
network - `::0/128` - as defined by [RFC
4291](http://tools.ietf.org/html/rfc4291).. Note that the address in this subnet
is neither private nor public.

## is\_private\_ipv6($ip)

This subroutine checks whether the address belongs to the IPv6 private network
- `FC00::/7` - as defined by [RFC 4193](http://tools.ietf.org/html/rfc4193).

## is\_linklocal\_ipv6($ip)

This subroutine checks whether the address belongs to the IPv6 link-local
unicast network - `FE80::/10` - as defined by [RFC
4291](http://tools.ietf.org/html/rfc4291).

## is\_multicast\_ipv6($ip)

This subroutine checks whether the address belongs to the IPv6 multicast
network - `FF00::/8` - as defined by [RFC
4291](http://tools.ietf.org/html/rfc4291).

## is\_public\_ipv4($ip), is\_public\_ipv6($ip), is\_public\_ip($ip)

These subroutines check whether the given IP address belongs to any of the
special case networks defined previously. Note that this is **not** simply the
opposite of checking `is_private_ipv4()` or `is_private_ipv6()`. The private
networks are a subset of all the special case networks.

## is\_linklocal\_ip($ip)

This subroutine checks whether the address belongs to the IPv4 or IPv6
link-local unicast network.

## is\_loopback\_ip($ip)

This subroutine checks whether the address is the IPv4 or IPv6 loopback
address.

## is\_multicast\_ip($ip)

This subroutine checks whether the address belongs to the IPv4 or IPv6
multicast network.

## is\_private\_ip($ip)

This subroutine checks whether the address belongs to the IPv4 or IPv6 private
network.

# OBJECT-ORIENTED INTERFACE

This module can also be used as a class. You can call `Data::Validate::IP->new()` to get an object and then call any of the
validation subroutines as methods on that object. This is somewhat pointless
since the object will never contain any state but this interface is kept for
backwards compatibility.

# SEE ALSO

IPv4

**[RFC 5735] [RFC 1918]**

IPv6

**[RFC 2460] [RFC 4193] [RFC 4291] [RFC 6434]**

# ACKNOWLEDGEMENTS

Thanks to Richard Sonnen <`sonnen@richardsonnen.com`> for writing the
Data::Validate module.

Thanks to Matt Dainty <`matt@bodgit-n-scarper.com`> for adding the
`is_multicast_ipv4()` and `is_linklocal_ipv4()` code.

# BUGS

Please report any bugs or feature requests to
`bug-data-validate-ip@rt.cpan.org`, or through the web interface at
<http://rt.cpan.org>. I will be notified, and then you'll automatically be
notified of progress on your bug as I make changes.

Bugs may be submitted at <https://github.com/houseabsolute/Data-Validate-IP/issues>.

# SOURCE

The source code repository for Data-Validate-IP can be found at <https://github.com/houseabsolute/Data-Validate-IP>.

# AUTHORS

* Neil Neely neil@neely.cx
* Dave Rolsky autarch@urth.org

# CONTRIBUTOR

Gregory Oschwald goschwald@maxmind.com

# COPYRIGHT AND LICENSE

This software is copyright (c) 2022 by Neil Neely.

This is free software; you can redistribute it and/or modify it under
the same terms as the Perl 5 programming language system itself.

The full text of the license can be found in the
`LICENSE` file included with this distribution.

## About

IPv4 and IPv6 validation methods

[metacpan.org/release/Data-Validate-IP/](https://metacpan.org/release/Data-Validate-IP/ "https://metacpan.org/release/Data-Validate-IP/")

### Resources

[Readme](#readme-ov-file)
### License

[View license](#License-1-ov-file)
### Code of conduct

[Code of conduct](#coc-ov-file)

[Activity](/houseabsolute/Data-Validate-IP/activity)
[Custom properties](/houseabsolute/Data-Validate-IP/custom-properties)
### Stars

[**4**
stars](/houseabsolute/Data-Validate-IP/stargazers)
### Watchers

[**5**
watching](/houseabsolute/Data-Validate-IP/watchers)
### Forks

[**2**
forks](/houseabsolute/Data-Validate-IP/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fhouseabsolute%2FData-Validate-IP&report=houseabsolute+%28user%29)

## [Releases](/houseabsolute/Data-Validate-IP/releases)

[17
tags](/houseabsolute/Data-Validate-IP/tags)

## [Packages 0](/orgs/houseabsolute/packages?repo_name=Data-Validate-IP)

No packages published

## [Contributors 3](/houseabsolute/Data-Validate-IP/graphs/contributors)

## Languages

* [Perl
  98.4%](/houseabsolute/Data-Validate-IP/search?l=perl)
* [Shell
  1.6%](/houseabsolute/Data-Validate-IP/search?l=shell)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_27b9d6ce_20250108_104837.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsickcodes%2Fsecurity%2Fblob%2Fmaster%2Fadvisories%2FSICK-2021-018.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsickcodes%2Fsecurity%2Fblob%2Fmaster%2Fadvisories%2FSICK-2021-018.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=sickcodes%2Fsecurity)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[sickcodes](/sickcodes)
/
**[security](/sickcodes/security)**
Public

* [Notifications](/login?return_to=%2Fsickcodes%2Fsecurity) You must be signed in to change notification settings
* [Fork
  18](/login?return_to=%2Fsickcodes%2Fsecurity)
* [Star
   86](/login?return_to=%2Fsickcodes%2Fsecurity)

* [Code](/sickcodes/security)
* [Issues
  1](/sickcodes/security/issues)
* [Pull requests
  0](/sickcodes/security/pulls)
* [Actions](/sickcodes/security/actions)
* [Projects
  0](/sickcodes/security/projects)
* [Security](/sickcodes/security/security)
* [Insights](/sickcodes/security/pulse)

Additional navigation options

* [Code](/sickcodes/security)
* [Issues](/sickcodes/security/issues)
* [Pull requests](/sickcodes/security/pulls)
* [Actions](/sickcodes/security/actions)
* [Projects](/sickcodes/security/projects)
* [Security](/sickcodes/security/security)
* [Insights](/sickcodes/security/pulse)

## Files

 master
## Breadcrumbs

1. [security](/sickcodes/security/tree/master)
2. /[advisories](/sickcodes/security/tree/master/advisories)
/
# SICK-2021-018.md

 Blame  Blame
## Latest commit

## History

[History](/sickcodes/security/commits/master/advisories/SICK-2021-018.md)148 lines (102 loc) · 6.54 KB master
## Breadcrumbs

1. [security](/sickcodes/security/tree/master)
2. /[advisories](/sickcodes/security/tree/master/advisories)
/
# SICK-2021-018.md

Top
## File metadata and controls

* Preview
* Code
* Blame

148 lines (102 loc) · 6.54 KB[Raw](https://github.com/sickcodes/security/raw/refs/heads/master/advisories/SICK-2021-018.md)
### Title

Perl module Data::Validate::IP - Improper Input Validation of octal literals in Perl Data::Validate::IP v0.29 and below results in indeterminate SSRF & RFI vulnerabilities.

### CVE ID

CVE-2021-29662

### CVSS Score

7.5

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N

### Internal ID

SICK-2021-018

### Vendor

Perl (houseabsolute)

### Product

Perl distribution Data-Validate-IP

### Product Versions

0.29 and below

### Vulnerability Details

Improper input validation of octal strings in Perl’s Data::Validate::IP module allows remote unauthenticated attackers to perform indeterminate SSRF, RFI, and LFI attacks on many Perl applications that rely on Data::Validate::IP is\_private\_ipv4() to validate if an IPv4 address is within a private range or not. For example, an attacker can submit the input IP '012.0.0.1', which should be private (012 is 10 in decimal). However, the module returns a false negative result, resulting in a vector for SSRF, LFI, or RFI bypass techniques. As a further example, 0254.16.0.1 should be evaluated as 172.16.0.1, which is private, yet the module returns the incorrect response (false - public). An attacker submitting an IP address to a web or local application which relies on Data::Validate::IP to validate input IP addresses are either private OR public will be able to bypass the validation provided by this module, resulting in a wide range of attack surfaces on dependencies of Perl’s Data::Validate::IP.

### Vendor Response

Patched

### Proof of Concept

```
<!-- // Authors:      sickcodes, Kelly Kaoudis -->
<!-- // License:      GPLv3+ -->

use Data::Validate::IP;

my $answer = " is private according to is_private_ipv4? ";

sub is_private {
    return is_private_ipv4($_[0]) ? "true" : "false";
}

my $dec_ip_string = '10.0.0.1';
my $is_private = is_private($dec_ip_string);
print "\n10.0.0.1 should be private";
print "\ninput: " . $dec_ip_string . $answer . $is_private . "\n";

my $oct_ip_string = '012.0.0.1';
my $is_oct_private = is_private($oct_ip_string);
print "\n" . $oct_ip_string . " should be private (012 is 10 in decimal)";
print "\ninput: " . $oct_ip_string . $answer . $is_oct_private . "\n";

my $oct_ip_string1 = '010.0.0.1';
my $is_oct_private1 = is_private($oct_ip_string1);
print "\n" . $oct_ip_string1 . " should not be private (010 is 8 in decimal)";
print "\ninput: " . $oct_ip_string1 . $answer . $is_oct_private1 . "\n";

my $dec_ip_string1 = '172.16.0.1';
my $is_private1 = is_private($dec_ip_string1);
print "\n" . $dec_ip_string1 . " should be private";
print "\ninput: " . $dec_ip_string1 . $answer . $is_private1 . "\n";

my $oct_ip_string2 = '0172.16.0.1';
my $is_oct_private2 = is_private($oct_ip_string2);
print "\n" . $oct_ip_string2 . " should not be private (0172 is 122)";
print "\ninput: " . $oct_ip_string2 . $answer . $is_oct_private2 . "\n";

my $oct_ip_string3 = '0254.16.0.1';
my $is_oct_private3 = is_private($oct_ip_string3);
print "\n" . $oct_ip_string3 . " should be private (0254 is 172)";
print "\ninput: " . $oct_ip_string3 . $answer . $is_oct_private3 . "\n";

my $dec_ip_string_2 = '192.168.0.1';
my $is_private2 = is_private($dec_ip_string_2);
print "\n" . $dec_ip_string_2 . " should be private";
print "\ninput: " . $dec_ip_string_2 . $answer . $is_private2 . "\n";

my $oct_ip_string4 = '0192.168.0.1';
my $is_oct_private4 = is_private($oct_ip_string4);
print "\n" . $oct_ip_string4 . " should be private (0192 in octal is 192 in decimal)";
print "\ninput: " . $oct_ip_string4 . $answer . $is_oct_private4 . "\n";

# for the following, c.f. https://github.com/frenchbread/private-ip/pull/2
my $oct_ip_string5 = '0000.0000.0000.0000';
my $is_oct_private5 = is_private($oct_ip_string5);
print "\n" . $oct_ip_string5 . " should be considered private, but is not";
print "\ninput: " . $oct_ip_string5 . $answer . $is_oct_private5 . "\n";

my $dec_ip_string_3 = '127.0.0.1';
my $is_private3 = is_private($dec_ip_string_3);
print "\n" . $dec_ip_string_3 . " should be considered private, but is not";
print "\ninput: " . $dec_ip_string_3 . $answer . $is_private3 . "\n";

my $oct_ip_string6 = '0127.0.0.1';
my $is_oct_private6 = is_private($oct_ip_string6);
print "\n" . $oct_ip_string6 . " should not be considered private (0127 in octal is 87 in decimal)";
print "\ninput: " . $oct_ip_string6 . $answer . $is_oct_private6 . "\n";

my $oct_ip_string7 = '0177.0.0.1';
my $is_oct_private7 = is_private($oct_ip_string7);
print "\n" . $oct_ip_string7 . " should be considered private, but is not (0177 is 127 in decimal)";
print "\ninput: " . $oct_ip_string7 . $answer . $is_oct_private7 . "\n";

```

#### Disclosure Timeline

* **2021-03-29** - Vendor patches similar vulnerability
* **2021-03-29** - Researchers discover additional bypasses
* **2021-03-29** - Vendor notified
* **2021-03-29** - CVE requested
* **2021-03-31** - CVE assigned CVE-2021-29662
* **2021-03-31** - CVE published

### Links

<https://github.com/houseabsolute/Data-Validate-IP/commit/3bba13c819d616514a75e089badd75002fd4f14e>

<https://github.com/houseabsolute/Data-Validate-IP>

<https://github.com/sickcodes/security/blob/master/advisories/SICK-2021-018.md>

<https://sick.codes/sick-2021-018>

### Researchers

Dave Rolsky: <https://github.com/houseabsolute/>

Victor Viale: <https://github.com/koroeskohr> || <https://twitter.com/koroeskohr>

Sick Codes: <https://github.com/sickcodes> || <https://twitter.com/sickcodes>

Kelly Kaoudis: <https://github.com/kaoudis> || <https://twitter.com/kaoudis>

John Jackson <https://www.twitter.com/johnjhacking>

Nick Sahler: <https://github.com/nicksahler> || <https://twitter.com/tensor_bodega>

Olivier Poitrey <https://github.com/rs> || <https://twitter.com/olivier_poitrey>

#### CVE Links

<https://sick.codes/sick-2021-018>

<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-29662>

<https://nvd.nist.gov/view/vuln/detail?vulnId=CVE-2021-29662>

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from blog.urth.org_4360737e_20250108_104834.html ===
[House Absolute(ly Pointless)](/)

* [Home](https://blog.urth.org/)
* [Archives](https://blog.urth.org/posts/)
* [About](https://blog.urth.org/about)
XSearch[House Absolute(ly Pointless)](/)

* [Home](/)
* [Archives](/posts/)
* [About](/about)
# Security Issues in Perl IP Address distros

2021-03-29

*Edit on 2021-03-29 21:40(ish) UTC:* Added Net-Subnet (appears unaffected) and reordered the details
to match the list at the top of the post.

*Edit on 2021-03-30 14:50(ish) UTC:* Added Net-Works (appears unaffected).

*Edit on 2021-03-30 15:40(ish) UTC:* Added Net-CIDR (some functions are affected).

*Edit on 2021-03-31 01:05(ish) UTC:* Added Net-IPv4Addr (affected).

*Edit on 2021-04-05 01:21(ish) UTC:* Net-CIDR-Lite 0.22 contains a remediation.

*Edit on 2021-04-05 19:30(ish) UTC:* Net-IPAddress-Util 5.000 contains a remediation.

warning

**TLDR: Some Perl modules for working with IP addresses and netmasks have
bugs with potential security applications.** See below for more details on the bug and which modules
are affected.

* Net-IPv4Addr: Affected.
* Net-CIDR-Lite: Vulnerable before the 0.22 release. Upgrade now.
* Net-Netmask: Vulnerable before the 2.00000 release. Upgrade now.
* Net-IPAddress-Util: Vulnerable before the 5.000 release. Upgrade now.
* Data-Validate-IP: Depends on exactly how it’s used. See below for details.
* Net-CIDR: Depends on exactly how it’s used. See below for details.
* Socket: Appears unaffected.
* Net-DNS: Appears unaffected.
* NetAddr-IP: Appears unaffected.
* Net-Works: Appears unaffected.
* Net-Subnet: Appears unaffected.
* Net-Patricia: Appears unaffected.

Yesterday,
[a security issue with the NPM package `netmask` was published](https://sick.codes/universal-netmask-npm-package-used-by-270000-projects-vulnerable-to-octal-input-data-server-side-request-forgery-remote-file-inclusion-local-file-inclusion-and-more-cve-2021-28918/)[1](#fn:1).

The issue itself is pretty straightforward. Your OS will allow an IP address like `010.0.0.1` or a
netmask like `010.0.0.0/8`. That `010` is treated **as an octal number, not a base-10 number with a
leading zero!** That means that `010.0.0.1` is actually `8.0.0.1`. We can confirm this with `ping`:

| ``` 1 2  ``` | ``` ping 010.0.0.1 PING 010.0.0.1 (8.0.0.1) 56(84) bytes of data.  ``` |
| --- | --- |

But the NPM `netmask` package would treat this as `10.0.0.1`. This confusion means that an
application could be tricked into thinking a public IP - `8.0.0.1` - was part of a private subnet -
`10.0.0.0/8`. And conversely, you could trick it into thinking a private IP - `10.0.0.1` written as
`012.0.0.1` - was part of a public subnet - `12.0.0.1`.

This has security implications for any application that is trying to distinguish between public and
private IP addresses or networks for access control, firewalling, etc.

As I was reading about this I checked out
[the Git repo for the `netmask` package](https://github.com/rs/node-netmask). Its README says “This
module is highly inspired by Perl [Net::Netmask](http://search.cpan.org/dist/Net-Netmask/) module.”

And at that point I realized that it was quite possible that this affected Perl code as well! So I
started digging into this by looking at various CPAN modules for working with IP addresses,
networks, and netmasks.

Here’s the current state of CPAN modules, ordered roughly by their position in
[The River of CPAN](https://neilb.org/2015/04/20/river-of-cpan.html) (which basically means how many
modules depend on them).

## [`Net-IPv4Addr`](https://metacpan.org/release/Net-IPv4Addr)

warning**This distribution is affected by this issue. In addition, this module is
almost certainly no longer being maintained. Emails to the author bounce.**

This distribution has 4 direct dependents and 12 total dependents.

| ``` 1 2 3  ``` | ``` perl -MNet::IPv4Addr=:all -E 'say $_ for ipv4_network("010.0.0.1")' 10.0.0.0 8  ``` |
| --- | --- |

## [`Net-CIDR-Lite`](https://metacpan.org/release/Net-CIDR-Lite)

info**This distribution was vulnerable prior to its 0.22 release made on 2021-04-04.
Thanks to Stig Palmquist for taking this distro over and releasing a fix!**

This distribution has 24 direct dependents and 36 total dependents.

| ``` 1 2 3  ``` | ``` perl -MNet::CIDR::Lite -E 'my $c = Net::CIDR::Lite->new; $c->add("010.0.0.0/8"); say $_ for $c->list_range' Can't determine ip format at /home/autarch/.perlbrew/libs/perl-5.30.1@dev/lib/perl5/Net/CIDR/Lite.pm line 38. 	Net::CIDR::Lite::add(Net::CIDR::Lite=HASH(0x55fe55ade740), "010.0.0.0/8") called at -e line 1  ``` |
| --- | --- |

## [`Net-Netmask`](https://metacpan.org/release/Net-Netmask)

info**This distribution was vulnerable prior to its 2.0000 release earlier today.
Great job on the quick response, Joelle Maslak!**

This distribution has 22 direct dependents and 30 total dependents.

So for versions before 2.0000 we see this:

| ``` 1 2  ``` | ``` perl -MNet::Netmask -E 'say defined Net::Netmask->new2(q{010.0.0.0/8}) ? 1 : 0' 0  ``` |
| --- | --- |

Note the use of the `new2` constructor. The old `new` constructor cannot be changed to return
`undef` for backwards compatibility reasons. Fortunately, it’s probably not vulnerable in any
exploitable way, as it returns a 0-length subnet:

| ``` 1 2  ``` | ``` perl -MNet::Netmask -E 'say Net::Netmask->new(q{010.0.0.0/8})' 0.0.0.0/0  ``` |
| --- | --- |

## [`Net-IPAddress-Util`](https://metacpan.org/release/Net-IPAddress-Util)

info**This distribution was vulnerable prior to its 5.000 release made on
2021-04-04. Thanks to Paul W Bennett for the fix!**

This distribution has no dependents.

| ``` 1 2  ``` | ``` perl -MNet::IPAddress::Util=IP -E 'say IP(q{010.0.0.1})' 8.0.0.1  ``` |
| --- | --- |

## [`Data-Validate-IP`](https://metacpan.org/release/Data-Validate-IP)

info**This distribution doesn’t misparse octal numbers, but you could be affected
depending on exactly how your code uses this distro. See below for details.**

This distribution has 21 direct dependents and 60 total dependents.

This distribution returns false for any `is_*_ipv4` method that includes an octal number. So both
`is_private_ipv4('010.0.0.1')` and `is_public_ipv4('010.0.0.1')` return false. **Depending on how
you’re using this module, it’s *possible* that this could lead to bugs, including bugs with security
implications.**

I
[updated the documentation](https://metacpan.org/pod/Data%3A%3AValidate%3A%3AIP#USAGE-AND-SECURITY-RECOMMENDATIONS)
to explicitly recommend that you **always call `is_ipv4()` in addition to calling a method like
`is_private_ipv4()`**. The `is_ipv4()` method will always return false for IP addresses with octal
numbers.

While this isn’t strictly POSIX-correct, this seems like the safest behavior for a module like this.
It’s better to be too strict if this eliminates a potential footgun.

**If you are using this distribution, I highly encourage you to audit your use of it in a security
context!**

## [`Net-CIDR`](https://metacpan.org/release/Net-CIDR)

info**This distribution is affected, but it has a function to validate CIDR strings
that you should use before calling any other functions.**

This distribution has 17 direct dependents and 25 total dependents.

The distribution provides a number of functions for working with networks and IP addresses. Most of
these are not affected. However, two are:

| ```  1  2  3  4  5  6  7  8  9 10 11  ``` | ``` perl -MNet::CIDR -E 'say for Net::CIDR::addr2cidr("010.0.0.1")' 010.0.0.1/32 010.0.0.0/31 ... 010.0.0.0/8 10.0.0.0/7 8.0.0.0/6 ... perl -MNet::CIDR -E 'say Net::CIDR::cidrlookup("10.0.0.1", "010.0.0.0/8")' 1  ``` |
| --- | --- |

However, this distribution also contains a `cidrvalidate` function that will return false for any
CIDR string with a leading 0 in an octet. The documentation explicitly tells you to use this before
passing the data to other functions.

**If you are using this distribution, I highly encourage you to audit your use of it in a security
context!**

## [`Socket`](https://metacpan.org/release/Socket)

note**This distribution appears to be unaffected by this issue.**

This distribution has 275 direct dependents and 9,936 total dependents.

| ``` 1 2 3 4 5  ``` | ``` perl -MSocket -E 'say inet_ntoa(inet_aton(q{010.0.0.1}))' 8.0.0.1 perl -MSocket=inet_pton,inet_ntop,AF_INET -E 'say inet_ntop(AF_INET, inet_pton(AF_INET, q{010.0.0.1}))' Bad address length for Socket::inet_ntop on AF_INET; got 0, should be 4 at -e line 1.  ``` |
| --- | --- |

The `inet_pton()` function is just returning `undef` for this octal-formatted address.

## [`Net-DNS`](https://metacpan.org/release/Net-DNS)

note**This distribution appears to be unaffected by this issue.**

This distribution has 104 direct dependents and 561 total dependents.

If you try to resolve an IP address, it turns this into a reverse lookup, but it treats the IP as
text:

| ```  1  2  3  4  5  6  7  8  9 10 11  ``` | ``` perl ./demo/perldig 010.0.0.1 ;; Response received from 127.0.0.53 (40 octets) ;; HEADER SECTION ;;	id = 6342 ;;	qr = 1	aa = 0	tc = 0	rd = 1	opcode = QUERY ;;	ra = 1	z  = 0	ad = 0	cd = 0	rcode  = NXDOMAIN ;;	qdcount = 1	ancount = 0	nscount = 0	arcount = 0 ;;	do = 0 ;; QUESTION SECTION (1 record) ;; 1.0.0.010.in-addr.arpa.	IN	A  ``` |
| --- | --- |

So it’s not a useful answer, but it’s not looking up the *wrong* address.

## [`NetAddr-IP`](https://metacpan.org/release/NetAddr-IP)

note**This distribution appears to be unaffected by this issue.**

This distribution has 36 direct dependents and 110 total dependents.

| ``` 1 2  ``` | ``` perl -MNetAddr::IP -E 'say NetAddr::IP->new(q{010.0.0.024})' 8.0.0.20/32  ``` |
| --- | --- |

## [`Net-Works`](https://metacpan.org/release/Net-Works)

note**This distribution appears to be unaffected by this issue.**

This distribution has 3 direct dependents and 7 total dependents.

| ``` 1 2 3 4 5 6 7 8  ``` | ``` perl -MNet::Works::Network -E 'say Net::Works::Network->new_from_string(string => q{010.0.0.1/8})' 010.0.0.1/8 is not a valid IP network at /home/autarch/.perlbrew/libs/perl-5.30.1@dev/lib/perl5/Net/Works/Network.pm line 120. 	Net::Works::Network::new_from_string("Net::Works::Network", "string", "010.0.0.1/8") called at -e line 1 perl -MNet::Works::Address -E 'say Net::Works::Address->new_from_string(string => q{010.0.0.1})' 010.0.0.1 is not a valid IPv6 address at /home/autarch/.perlbrew/libs/perl-5.30.1@dev/lib/perl5/Net/Works/Util.pm line 70. 	Net::Works::Util::_validate_ip_string("010.0.0.1", 6) called at /home/autarch/.perlbrew/libs/perl-5.30.1@dev/lib/perl5/Net/Works/Address.pm line 74 	Net::Works::Address::new_from_string("Net::Works::Address", "string", "010.0.0.1") called at -e line 1  ``` |
| --- | --- |

Thanks to Stig Palmquist for checking this one and letting me know.

## [`Net-Subnet`](https://metacpan.org/release/Net-Subnet)

note**This distribution appears to be unaffected by this issue.**

This distribution has 3 direct dependents and 7 total dependents.

| ``` 1 2 3 4 5  ``` | ``` perl -MNet::Subnet -E 'my $m = subnet_matcher(q{10.0.0.0/8}); say $m->(q{012.0.0.1}) ? 1 : 0' 1 perl -MNet::Subnet -E 'my $m = subnet_matcher(q{012.0.0.0/8}); say $m->(q{10.0.0.1}) ? 1 : 0' 1  ``` |
| --- | --- |

## [`Net-Patricia`](https://metacpan.org/release/Net-Patricia)

note**This distribution appears to be unaffected by this issue.**

This distribution has 1 direct dependent and 1 total dependent.

| ``` 1 2 3 4 5  ``` | ``` perl -MNet::Patricia -E 'my $p = Net::Patricia->new; $p->add_string("010.0.0.0/8"); say $p->match_string("8.0.0.1") ? 1 : 0' 1 perl -MNet::Patricia -E 'my $p = Net::Patricia->new; $p->add_string("8.0.0.0/8"); say $p->match_string("010.0.0.1") ? 1 : 0' 1  ``` |
| --- | --- |

---

1. One of the most ridiculous URL paths I’ve ever seen. [↩︎](#fnref:1)
[Down the Golang nil Rabbit Hole
Next](/2021/03/27/down-the-golang-nil-rabbit-hole/)[API Design and the Recent IP Address Module Issues
Prev](/2021/04/03/api-design-and-the-recent-ip-address-module-issues/)

---

Found a typo? Fix it by [editing this page on GitHub](https://github.com/autarch/blog.urth.org/edit/master/content/posts/2021-03-29-security-issues-in-perl-ip-address-distros.md).

Comments?

Discuss this post on:

* [/r/perl](https://www.reddit.com/r/perl/comments/mfzxuh/security_issues_in_perl_ip_address_distros/)
* [/r/programming](https://www.reddit.com/r/programming/comments/mg0s73/security_issues_in_perl_ip_address_distros/)
* [Hacker News](https://news.ycombinator.com/item?id=26628827)

You can
also email me directly.

Powered by [Hugo](https://gohugo.io)
|
Theme - [Jane](https://github.com/xianmin/hugo-theme-jane)
©
2007 -
2024
Dave Rolsky

[This work](https://blog.urth.org/) by David Rolsky is licensed under [CC BY-SA 4.0![](https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1)![](https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1)![](https://mirrors.creativecommons.org/presskit/icons/sa.svg?ref=chooser-v1)](http://creativecommons.org/licenses/by-sa/4.0/?ref=chooser-v1)



=== Content from security.netapp.com_b523d049_20250108_104837.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
æ¥æ¬èª

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [CVE-2021-29662 Perl Vulnerability in NetApp Products](https://security.netapp.com/advisory/ntap-20210604-0002)

## CVE-2021-29662 Perl Vulnerability in NetApp Products

circle-check-alt

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close ×

#### Subscribe to NTAP-20210604-0002 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20210604-0002 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close ×

#### Unsubscribe from NTAP-20210604-0002 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20210604-0002 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20210604-0002
**Version:**
4.0

**Last updated:**
01/06/2022

**Status:**
Final.

**CVEs:** CVE-2021-29662

Overview
#### Summary

Multiple NetApp products incorporate Perl. Perl module Data::Validate::IP versions through 0.29 are susceptible to a vulnerability which when successfully exploited could lead to addition or modification of data.

#### Impact

Successful exploitation of this vulnerability could lead to addition or modification of data.

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2021-29662](https://nvd.nist.gov/vuln/detail/CVE-2021-29662) | 7.5 (HIGH) | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

Affected Products
#### Affected Products

* NetApp Cloud Backup (formerly AltaVault)
* SnapCenter

#### Products Not Affected

* 7-Mode Transition Tool
* AFF Baseboard Management Controller (BMC) - A700s
* ATTO FibreBridge - 6500N
* ATTO FibreBridge - 7500N
* ATTO FibreBridge - 7600N
* Active IQ Unified Manager for Linux
* Active IQ Unified Manager for Microsoft Windows
* Active IQ Unified Manager for VMware vSphere
* Active IQ mobile app
* Astra Trident
* Brocade Fabric Operating System Firmware
* Brocade SAN Navigator (SANnav)
* Cloud Insights Acquisition Unit
* Cloud Insights Telegraf Agent
* Cloud Manager
* Cloud Secure Agent
* Cloud Volumes ONTAP Mediator
* Clustered Data ONTAP
* Clustered Data ONTAP Antivirus Connector
* E-Series BIOS
* E-Series SANtricity OS Controller Software 11.x
* E-Series SANtricity Storage Manager
* E-Series SANtricity Web Services (REST API) for Web Services Proxy
* Element .NET SDK
* Element HealthTools
* Element JAVA SDK
* Element Plug-in for vCenter Server
* Element Python SDK
* FAS/AFF BIOS
* FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400
* FAS/AFF Baseboard Management Controller (BMC) - A250/500f
* FAS/AFF Baseboard Management Controller (BMC) - A320/C190/A220/FAS2720/FAS2750/A800
* Global File Cache
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* Inventory Collect Tool
* Management Services for Element Software and NetApp HCI
* MetroCluster Tiebreaker for clustered Data ONTAP
* NetApp Cloud Backup OST Plug-in (formerly AltaVault OST Plug-in)
* NetApp Converged Systems Advisor Agent
* NetApp E-Series Performance Analyzer
* NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H300E/H500E/H700E/H410S
* NetApp HCI Baseboard Management Controller (BMC) - H410C
* NetApp HCI Baseboard Management Controller (BMC) - H610C
* NetApp HCI Baseboard Management Controller (BMC) - H610S
* NetApp HCI Baseboard Management Controller (BMC) - H615C
* NetApp HCI Compute Node (Bootstrap OS)
* NetApp HCI Compute Node BIOS
* NetApp HCI Storage Node BIOS
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp SANtricity SMI-S Provider
* NetApp SMI-S Provider
* NetApp SolidFire & HCI Management Node
* NetApp SolidFire BIOS
* NetApp SolidFire Plug-in for vRealize Orchestrator (SolidFire vRO)
* NetApp SolidFire, Enterprise SDS & HCI Storage Node (Element Software)
* NetApp Storage Encryption
* NetApp VASA Provider for Clustered Data ONTAP 9.7 and above
* NetApp Virtual Desktop Service (VDS)
* NetApp XCP NFS
* NetApp XCP SMB
* ONTAP Mediator
* ONTAP Select Deploy administration utility
* OnCommand Insight
* OnCommand Workflow Automation
* Open Systems SnapVault Agent
* SANtricity Storage Plugin for vCenter
* SANtricity Unified Manager
* SAS Firmware
* SRA Plugin for Linux
* SRA Plugin for Windows
* Service Processor
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter Plug-in for VMware vSphere
* SnapDrive for Unix
* SnapManager for Exchange
* SnapManager for Hyper-V
* SnapManager for Oracle
* SnapManager for SAP
* SolidFire Storage Replication Adapter
* Storage Replication Adapter for Clustered Data ONTAP for VMware vSphere 9.7 and above
* Storage Services Connector
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID BIOS SG1000/SG100
* StorageGRID BIOS SG5660/SG5612/SG5760/SG5712
* StorageGRID BIOS SG6060/SGF6024
* StorageGRID Baseboard Management Controller (BMC)
* System Manager 9.x

Remediation
#### Software Versions and Fixes

NetApp's currently available patches are listed below.

| **Product** | **First Fixed in Release** |
| --- | --- |
| **SnapCenter** | <https://mysupport.netapp.com/site/products/all/details/snapcenter/downloads-tab/download/62018/4.5> |
| **NetApp Cloud Backup (formerly AltaVault)** | NetApp Cloud Backup (formerly AltaVault) has no plans to address this vulnerability. See the [EOA announcement](https://mysupport.netapp.com/info/communications/ECMLP2880179.html) for more information. |

#### Workarounds

None at this time.

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

**Technical Support**

Revision History
#### Status of This Notice

**Final.**

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20210604-0002>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20210604 | Initial Public Release |
| 2.0 | 20210623 | SnapCenter added to Software Versions and Fixes |
| 3.0 | 20211008 | SnapDrive for Unix moved to Products Not Affected |
| 4.0 | 20220106 | NetApp Cloud Backup (formerly AltaVault) moved to Won't Fix status, Final status |

This document is provided solely for informational purposes. All information is based upon NetAppâs current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. Â© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 ©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)


