=== Content from lists.debian.org_35b1326d_20250110_151651.html ===


---

[[Date Prev](msg00021.html)][[Date Next](msg00023.html)]
[[Thread Prev](msg00021.html)][[Thread Next](msg00023.html)]
[[Date Index](maillist.html#00022)]
[[Thread Index](threads.html#00022)]

# [SECURITY] [DLA 3769-1] thunderbird security update

---

* *To*: <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 3769-1] thunderbird security update
* *From*: Emilio Pozuelo Monfort <pochu@debian.org>
* *Date*: Sat, 23 Mar 2024 12:22:35 +0100
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20240323112235.30CF52A58EE%40andromeda)Â [20240323112235.30CF52A58EE@andromeda](msg00022.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3769-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>               Emilio Pozuelo Monfort
March 23, 2024                                <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : thunderbird
Version        : 1:115.9.0-1~deb10u1
CVE ID         : CVE-2023-5388 CVE-2024-0743 CVE-2024-1936 CVE-2024-2607
                 CVE-2024-2608 CVE-2024-2610 CVE-2024-2611 CVE-2024-2612
                 CVE-2024-2614 CVE-2024-2616

Multiple security issues were discovered in Thunderbird, which could
result in denial of service, the execution of arbitrary code or leaks
of encrypted email subjects.

For Debian 10 buster, these problems have been fixed in version
1:115.9.0-1~deb10u1.

We recommend that you upgrade your thunderbird packages.

For the detailed security status of thunderbird please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/thunderbird>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEcJymx+vmJZxd92Q+nUbEiOQ2gwIFAmX+u3gACgkQnUbEiOQ2
gwIQyA//fsFeM6KFIQR/Zi0u+vV9AV3VTP6hf1PgFtTJhtIDgiaqOvhqIqRa2Blm
8zf8J/p51ZJsQCCyurreS0uFqHL3fxKtRy75AprJ38xUz9z7xEWxX1QPuJmxn6+1
OT8uyg2qm6G6Jfw5ywsDmGzokes0s/qaQAVEw7a/QyGZ/xarbc+oXKeCRSavzPKu
xahmLH4PWYBo4FDfvCzENVO8Rh4S2yArSdZRIsXvbbQd4gq55M1kNULVi1be/iXn
sj/b+QqG+4tVJ46QZVWCY5fZBQ8Sn8fK+bxBOW/rfnLoroJd84y69Drj9rDv4FCy
Vrb1HK5Oc0fbUiZpv8NIV5H8zpQmeJ6al8elxRJ0J9YHAELiTkfPaysxMrlow2IR
F/fW/NjF/NDQplDQ1YGi+StKBJbfk+qTaCOVz6E0ASLzeMvcsilfmnVtbeOqfSzX
kiRssGjOXiqSYbtWhTIn5guG3ZLPugupvC6mBJnz+RbYq65iQRp+B0WdyuUe6gPl
/rRCY0Ie2V2x+0rDPrvLulRam+Zq4PEpT25hl0GMhxySfU+h3zjMZi/atwvNdoJG
7MOy7w4AFLGaJw6ejvdST/1fG97JhNBOIWFEyFypR4vufPYGYm4RRHHF26N/Ji3w
O33zs7OUdMOBmxAN3aH5+ZtIS8K2OyVuL+qMJPqFHmpu99TBNjw=
=aoyJ
-----END PGP SIGNATURE-----

```

---



=== Content from bugzilla.mozilla.org_7546c6ce_20250110_151645.html ===


![](/static/v20250108.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  Â·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summaryâ–¾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View â–¾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1880692)
* [XML](/show_bug.cgi?ctype=xml&id=1880692)

Closed
[Bug 1880692](/show_bug.cgi?id=1880692)
(CVE-2024-2608)

Opened 11 months ago
Closed 11 months ago

# Write beyond bounds caused by AppendEncodedAttributeValue() et al

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Write beyond bounds caused by AppendEncodedAttributeValue() et al

## Categories

### (Core :: DOM: Serializers, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
â–¾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20Serializers#DOM%3A%20Serializers)

DOM: Serializers
â–¾

Core :: DOM: Serializers
Bugs involving conversion to html or plaintext, either during saving or during copy/paste. This component is NOT for general copy/paste bugs, for bugs involving save dialogs or writing to files when saving, or for I18n-related bugs; only for problems with the actual text which is saved.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Serializers&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Serializers&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20Serializers)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

125 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Webcompat Priority | --- |
| Accessibility Severity | --- |
| a11y-review | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr115 | [124+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=124%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=verified) |
| firefox123 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox123&o1=equals&v1=wontfix) |
| firefox124 | [+](/buglist.cgi?f1=cf_tracking_firefox124&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox124&o1=equals&v1=verified) |
| firefox125 | [+](/buglist.cgi?f1=cf_tracking_firefox125&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | 124+ | verified |
| firefox-esr128 | --- | --- |
| firefox123 |  | wontfix |
| firefox124 | + | verified |
| firefox125 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: mozillabugs, Assigned: mccr8)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/0a70c84cd33dba0151fe15f2f8773137?d=mm&size=40)  [mccr8](/user_profile?user_id=406194)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/d5c63f9bd72a6704ada7f9ca71771d8b?d=mm&size=40)  [mozillabugs](/user_profile?user_id=608633)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/331afc283e18d6d28cb7ebb11b2cf5bb?d=mm&size=40)  [hsinyi](/user_profile?user_id=434964)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

10 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1512758](/show_bug.cgi?id=1512758 "VERIFIED FIXED - Write beyond bounds in StringBuilder::ToString()")

## Details

### (Keywords: csectype-intoverflow, reporter-external, sec-high, Whiteboard: [adv-main124+][adv-esr115.9+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2024-2608

[Keywords:](/describekeywords.cgi)

[csectype-intoverflow](/buglist.cgi?keywords=csectype-intoverflow&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main124+][adv-esr115.9+]

QA Whiteboard:

[qa-triaged]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a937117_1689 "11 months ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (6 files, 1 obsolete file)

| [ffbug\_2260.zip](/attachment.cgi?id=9380661)  [11 months ago](#c0)  [mozillabugs](/user_profile?user_id=608633)   679.76 KB, application/x-zip-compressed |  | [Details](/attachment.cgi?id=9380661&action=edit) |
| --- | --- | --- |
| [ffbug\_2260\_11.zip](/attachment.cgi?id=9380757)  [11 months ago](#c1)  [mozillabugs](/user_profile?user_id=608633)   680.16 KB, application/x-zip-compressed |  | [Details](/attachment.cgi?id=9380757&action=edit) |
| [Bug 1880692, part 2 - Use an estimate for encoded characters.](/attachment.cgi?id=9381124)  [11 months ago](#c7)  [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)   48 bytes, text/x-phabricator-request | diannaS : [approval-mozilla-beta+](#a1023902_690067 "11 months ago")  RyanVM : [approval-mozilla-esr115+](#c30 "11 months ago")  tjr : [sec-approval+](#a495517_578488 "11 months ago") | [Details](/attachment.cgi?id=9381124&action=edit) | [Review](/attachment.cgi?id=9381124) |
| [Bug 1880692, part 1 - Make StringBuilder::Unit::mLength specific to literals.](/attachment.cgi?id=9381857)  [11 months ago](#c12)  [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)   48 bytes, text/x-phabricator-request | diannaS : [approval-mozilla-beta+](#c27 "11 months ago")  RyanVM : [approval-mozilla-esr115+](#a1454742_75935 "11 months ago")  tjr : [sec-approval+](#c14 "11 months ago") | [Details](/attachment.cgi?id=9381857&action=edit) | [Review](/attachment.cgi?id=9381857) |
| [ffbug\_2260\_20.htm](/attachment.cgi?id=9382662)  [11 months ago](#c24)  [mozillabugs](/user_profile?user_id=608633)   16.56 KB, text/html |  | [Details](/attachment.cgi?id=9382662&action=edit) |
| [ffbug\_2260\_20\_worker.js](/attachment.cgi?id=9382663)  [11 months ago](#c25)  [mozillabugs](/user_profile?user_id=608633)   253 bytes, application/x-javascript |  | [Details](/attachment.cgi?id=9382663&action=edit) |
| [advisory.txt](/attachment.cgi?id=9391484)  [10 months ago](#c33)  [Tyson Smith [:tsmith]](/user_profile?user_id=486634)   275 bytes, text/plain |  | [Details](/attachment.cgi?id=9391484&action=edit) |

Show Obsolete

Bottom â†“
Tags â–¾

* Reset

Timeline â–¾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [mozillabugs](/user_profile?user_id=608633)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1880692#c0)â€¢ 11 months ago â€¢ [Edited](/page.cgi?id=comment-revisions.html&bug_id=1880692&comment_id=16800037 "6 revisions") |
|  | |

Attached file
[ffbug\_2260.zip](attachment.cgi?id=9380661) (obsolete)
â€” [Details](attachment.cgi?id=9380661&action=edit)

`AppendEncodedAttributeValue()`, `ExtraSpaceNeededForAttrEncoding()` and `AppendEncodedCharacters()` (`dom/base/nsContentUtils.cpp`) can experience integer overflows, causing underallocation of an output buffer and subsequent writes beyond bounds when `StringBuilder::ToString()` is called to obtain the resulting string. The write occurs in a content process, and is of arbitrary attacker-provided data arbitrarily intermixed with the repeated string `&quot;` or one of a few other escaped sequences. The length of the attacker-provided data and the length of the repeated strings must sum to >= `0x100000000`.

Attached is a POC that demonstrates the bugs in the context of `AppendEncodedAttributeValue()`.

The bugs are that the problem functions add `uint32_t` values -- in particular, lengths derived from strings that can be very long -- without checking for overflow. Lines 9360, 9370, and 9320, plus every instance of `extraSpaceNeeded += <something>` in `ExtraSpaceNeededForAttrEncoding()` and `AppendEncodedCharacters()` are vulnerable. (The following code is from `FIREFOX_122_0_RELEASE`):

```
    9326: static uint32_t ExtraSpaceNeededForAttrEncoding(const nsAString& aValue) {
    9327:   const char16_t* c = aValue.BeginReading();
    9328:   const char16_t* end = aValue.EndReading();
    9329:
    9330:   uint32_t extraSpaceNeeded = 0;
    9331:   while (c < end) {
    9332:     switch (*c) {
    9333:       case '"':
    9334:         extraSpaceNeeded += ArrayLength("&quot;") - 2;
    9335:         break;
    ... (similar for other escaped chars)
    9344:     }
    9345:     ++c;
    9346:   }
    9347:
    9348:   return extraSpaceNeeded;
    9349: }

    9351: static void AppendEncodedAttributeValue(const nsAttrValue& aValue,
    9352:                                         StringBuilder& aBuilder) {
    9353:   if (nsAtom* atom = aValue.GetStoredAtom()) {
    9354:     nsDependentAtomString atomStr(atom);
    9355:     uint32_t space = ExtraSpaceNeededForAttrEncoding(atomStr);
    9356:     if (!space) {
    ...
    9358:     } else {
    9359:       aBuilder.AppendWithAttrEncode(nsString(atomStr),
    9360:                                     atomStr.Length() + space);
    9361:     }
    9362:     return;
    9363:   }
    ...
    9366:   nsString str;
    9367:   aValue.ToString(str);
    9368:   uint32_t space = ExtraSpaceNeededForAttrEncoding(str);
    9369:   if (space) {
    9370:     aBuilder.AppendWithAttrEncode(std::move(str), str.Length() + space);
    9371:   } else {
    ...
    9373:   }
    9374: }

    9271: static void AppendEncodedCharacters(const nsTextFragment* aText,
    9272:                                     StringBuilder& aBuilder) {
    9273:   uint32_t extraSpaceNeeded = 0;
    9274:   uint32_t len = aText->GetLength();
    9275:   if (aText->Is2b()) {
    9276:     const char16_t* data = aText->Get2b();
    9277:     for (uint32_t i = 0; i < len; ++i) {
    9278:       const char16_t c = data[i];
    9279:       switch (c) {
    ...
    9289:         case 0x00A0:
    9290:           extraSpaceNeeded += ArrayLength("&nbsp;") - 2;
    9291:           break;
    9292:         default:
    9293:           break;
    9294:       }
    9295:     }
    9296:   } else {
    ... (similar for 1-byte characters)
    9317:   }
    9318:
    9319:   if (extraSpaceNeeded) {
    9320:     aBuilder.AppendWithEncode(aText, len + extraSpaceNeeded);
    ...
    9323:   }
    9324: }

```

Use the attached POC this way:

1. Unzip `ffbug_2260_11.zip`, yielding `ffbug_2260_11.htm` and `ffbug_2260_11_worker.js` .
2. Put these files on a webserver (I used a local webserver at `127.0.0.1`).
3. Start FF and attach a debugger to it.
4. Set a BP on `AppendEncodedAttributeValue()` line 9369.
5. Load `ffbug_2260_11.htm` in FF.
6. When the BP fires, examine `space` and notice that it's `0xd5552000`.
7. Examine `str.Length()` and notice that it's `0x2aaae040`, which, when added to `space` using 32-bit math, yields the overflowed quantity 0x40.
8. Step into `StringBuilder::AppendWithAttrEncode()` and notice that it adds a `Unit` having this length, also adding the same quantity to `StringBuilder::mLength`, which is the total length of the string that `StringBuilder::ToString` will attempt to allocate later.
9. Set a BP on `StringBuilder::ToString` lines 9125 (output buffer allocation) and 9145 (the `Unit::Type::StringWithEncode` case) and proceed.
10. When the buffer-allocation BP fires, notice that `mLength` is tiny (probably `0x50`); this is because of the overflow that occurred in step 7. (The small additional string length of `0x10` is for the other elements that surround the gigantic string in the POC).
11. Proceed. When the `StringWithEncode` BP fires, step into `EncodeAttrString()` and watch it write the attacker-provided data (and the escaped strings) far beyond the end of the output buffer allocated in step 10 (in my test, the buffer appeared to have `mCapacity` == `0x7b`).
12. Proceed. FF may crash copying the long string contents into the heap, or a different thread may malfunction or crash as it uses the data that `EncodeAttrString()` sprayed over the heap.

The POC uses a worker thread to illustrate what an attacker might do to stir the pot so that the heap-spraying is effective. In limited tests with an unoptimized x64 build without `_DEBUG`, only the `ToString()` thread crashes about 70% of the time, with both the `ToString()` thread and one or more other threads crashing most of the remainder. To see multiple crashes, proceed after the debugger pops up with the first thread's crash. Frequent crash locations are in `arena_t::ArenaRunRegAlloc()` on `mask = aRun->mRegionsMask[i];` in `WorkletThread::IsOnWorkletThread()` on `return ccjscx && ccjscx->GetAsWorkletJSContext();`, and in `GetCurrentThreadWorkerPrivate()` on `WorkerJSContext* workerjscx = ccjscx->GetAsWorkerJSContext();`

Flags: sec-bounty?

|  | [mozillabugs](/user_profile?user_id=608633)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1880692#a164056_608633)â€¢ 11 months ago |

[Attachment #9380661](/attachment.cgi?id=9380661&action=edit "ffbug_2260.zip") -
Attachment is obsolete: true

|  | [mozillabugs](/user_profile?user_id=608633)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1880692#c1)â€¢ 11 months ago |
|  | |

Attached file
[ffbug\_2260\_11.zip](attachment.cgi?id=9380757)
â€” [Details](attachment.cgi?id=9380757&action=edit)

|  | [Tyson Smith [:tsmith]](/user_profile?user_id=486634) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1880692#a267070_486634)â€¢ 11 months ago |

Group: core-security â†’ dom-core-security

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1880692#a315173_406194)â€¢ 11 months ago |

Keywords: [csectype-bounds](/buglist.cgi?keywords=csectype-bounds&resolution=---)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1880692#c2)â€¢ 11 months ago |
|  | |

I guess I'll make this csectype-intoverflow, as that's the underlying problem here, though it is interesting that I think this won't show up on UBSan because the overflow is on an unsigned int, so it is defined behavior.

Keywords: [csectype-bounds](/buglist.cgi?keywords=csectype-bounds&resolution=---) â†’ [csectype-intoverflow](/buglist.cgi?keywords=csectype-intoverflow&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1880692#a338636_406194)â€¢ 11 months ago |

Assignee: nobody â†’ continuation

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1880692#c3)â€¢ 11 months ago |
|  | |

The overflow issue in the string builder being used here was fixed in [bug 1512758](/show_bug.cgi?id=1512758 "VERIFIED FIXED - Write beyond bounds in StringBuilder::ToString()").

See Also: â†’ [1512758](/show_bug.cgi?id=1512758 "VERIFIED FIXED - Write beyond bounds in StringBuilder::ToString()")

|  | [mozillabugs](/user_profile?user_id=608633)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1880692#c4)â€¢ 11 months ago â€¢ [Edited](/page.cgi?id=comment-revisions.html&bug_id=1880692&comment_id=16804706 "2 revisions") |
|  | |

Not exactly. That overflow was due to `StringBuilder::mLength` overflowing, which was indeed fixed (by turning it into a `CheckedInt`). The problem here is that that various `len + extraSpaceNeeded` computations can overflow, as can the computations of `extraSpaceNeeded` itself. That's why this bug still exists in FF 122.0, as opposed to getting fixed in ~66.0.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1880692#c5)â€¢ 11 months ago |
|  | |

Sorry, I didn't mean the issue you reported here was fixed. I meant that a similar integer overflow in StringBuilder itself was fixed by that other bug.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1880692#c6)â€¢ 11 months ago |
|  | |

When I ran the test case locally on an unmodified debug build, I hit this assertion which looks like a failed bounds check:

Assertion failure: mPosition + len <= mHandle.Length(), at dom/base/nsContentUtils.cpp:9015

#01: (anonymous namespace)::StringBuilder::ToString(nsTSubstring<char16\_t>&) (dom/base/nsContentUtils.cpp:9169)

#02: nsContentUtils::SerializeNodeToMarkup(nsINode\*, bool, nsTSubstring<char16\_t>&) (obj-dbg.noindex/dist/include/mozilla/dom/NodeInfo.h:0)

I considered whether we should make this a release assert, but it looks like the whole point of [bug 1488697](/show_bug.cgi?id=1488697 "RESOLVED FIXED - StringBuilder::ToString should use BulkWrite") which added this bulk writer mechanism is to eliminate redundant checks, so I'll leave it alone.

Hopefully doing CheckedInt everywhere won't slow things down too much. We could avoid the checks in the inner loops of AppendEncodedCharacters and ExtraSpaceNeededForAttrEncoding by using an unchecked version if the worst case scenario (eg `5 * len`) won't overflow, but hopefully that's not necessary. I can try checking the microbenchmark linked to in [bug 1488697](/show_bug.cgi?id=1488697 "RESOLVED FIXED - StringBuilder::ToString should use BulkWrite"), though it is so old I don't know how relevant it will be now.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1880692#c7)â€¢ 11 months ago |
|  | |

Attached file
[Bug 1880692, part 2 - Use an estimate for encoded characters.](attachment.cgi?id=9381124)
â€” [Details](attachment.cgi?id=9381124&action=edit)

|  | [mozillabugs](/user_profile?user_id=608633)  Reporter |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1880692#c8)â€¢ 11 months ago |
|  | |

(In reply to Andrew McCreight [:mccr8] from [comment #6](/show_bug.cgi?id=1880692#c6 "VERIFIED FIXED - Write beyond bounds caused by AppendEncodedAttributeValue() et al"))

> When I ran the test case locally on an unmodified debug build, I hit this assertion which looks like a failed bounds check:
>
> Assertion failure: mPosition + len <= mHandle.Length(), at dom/base/nsContentUtils.cpp:9015
>
> #01: (anonymous namespace)::StringBuilder::ToString(nsTSubstring<char16\_t>&) (dom/base/nsContentUtils.cpp:9169)
>
> #02: nsContentUtils::SerializeNodeToMarkup(nsINode\*, bool, nsTSubstring<char16\_t>&) (obj-dbg.noindex/dist/include/mozilla/dom/NodeInfo.h:0)
>
> I considered whether we should make this a release assert, but it looks like the whole point of [bug 1488697](/show_bug.cgi?id=1488697 "RESOLVED FIXED - StringBuilder::ToString should use BulkWrite") which added this bulk writer mechanism is to eliminate redundant checks, so I'll leave it alone.

That would reduce this bug to a DoS bug, but those are undesireable too.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1880692#c9)â€¢ 11 months ago |
|  | |

Eh, if we crashes in that situation it wouldn't be too terrible. Your test case doesn't feel like something people are going to hit normally.

My patch is a fairly severe performance regression. When running <https://bug-81214-attachments.webkit.org/attachment.cgi?id=132034> locally in a MacOS non-PGO opt build without the patch, I get around 58ms for body.innerHTML and body.outerHTML (about what I see on Nightly in my regular browsing session). With my patch, it is more like 76ms for both. I'll assume that's not okay and try to do something clever.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1880692#c10)â€¢ 11 months ago |
|  | |

If I revert the CheckedInt changes for `extraSpaceNeeded`, that seems to fix the performance regression entirely, as you might expect. I'll see if I can come up with something tomorrow that bypasses the checking in the usual case.

|  | [mozillabugs](/user_profile?user_id=608633)  Reporter |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1880692#c11)â€¢ 11 months ago |
|  | |

(In reply to Andrew McCreight [:mccr8] from [comment #9](/show_bug.cgi?id=1880692#c9 "VERIFIED FIXED - Write beyond bounds caused by AppendEncodedAttributeValue() et al"))

> My patch is a fairly severe performance regression. When running <https://bug-81214-attachments.webkit.org/attachment.cgi?id=132034> locally in a MacOS non-PGO opt build without the patch, I get around 58ms for body.innerHTML and body.outerHTML (about what I see on Nightly in my regular browsing session). With my patch, it is more like 76ms for both. I'll assume that's not okay and try to do something clever.

That really surprises me. It maybe indicates that `CheckedInt` could use some performance work.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1880692#c12)â€¢ 11 months ago |
|  | |

Attached file
[Bug 1880692, part 1 - Make StringBuilder::Unit::mLength specific to literals.](attachment.cgi?id=9381857)
â€” [Details](attachment.cgi?id=9381857&action=edit)

That is the only case that uses it. This might save a bit of space

and avoids some useless stores. Idea by peterv.

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1880692#a427604_600971)â€¢ 11 months ago |

[Attachment #9381124](/attachment.cgi?id=9381124&action=edit "Bug 1880692, part 2 - Use an estimate for encoded characters.") -
Attachment description: Bug 1880692 - Used CheckedInt when appending encoded characters. â†’ Bug 1880692, part 2 - Use an estimate for encoded characters.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1880692#c13)â€¢ 11 months ago |
|  | |

Comment on [attachment 9381124](/attachment.cgi?id=9381124 "Bug 1880692, part 2 - Use an estimate for encoded characters.") [[details]](/attachment.cgi?id=9381124&action=edit "Bug 1880692, part 2 - Use an estimate for encoded characters.")

[Bug 1880692](/show_bug.cgi?id=1880692 "VERIFIED FIXED - Write beyond bounds caused by AppendEncodedAttributeValue() et al"), part 2 - Use an estimate for encoded characters.

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: It is probably easy to figure out how to get a buffer overflow if you look at the patch. (Technically this is a performance improvement so we could potentially land this in a cover bug with that excuse, but the addition of CheckedInt is probably a red flag if somebody was taking a close look at this patch.)
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which branches (beta, release, and/or ESR) are affected by this flaw, and do the release status flags reflect this affected/unaffected state correctly?**: all
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**: It looks like this code hasn't really changed since 114 ([bug 1830986](/show_bug.cgi?id=1830986 "RESOLVED FIXED - Improve performance of inner/outerHTML getters.")), so it shouldn't be an issue.
* **How likely is this patch to cause regressions; how much testing does it need?**: I think the main risk here is that this code is quite performance sensitive. The entire reason we have this odd code that led to a buffer overflow in the first place is due to performance tuning. My first patch slowed down a microbenchmark by a lot. The new patch speeds us up on the microbenchmark, but it does so by increasing memory usage a little bit. Hopefully that increase is not enough to matter.
* **Is the patch ready to land after security approval is given?**: Yes
* **Is Android affected?**: Yes
[Attachment #9381124](/attachment.cgi?id=9381124&action=edit "Bug 1880692, part 2 - Use an estimate for encoded characters.") -
Flags: sec-approval?

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1880692#a438201_406194)â€¢ 11 months ago |

[Attachment #9381857](/attachment.cgi?id=9381857&action=edit "Bug 1880692, part 1 - Make StringBuilder::Unit::mLength specific to literals.") -
Flags: sec-approval?

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1880692#c14)â€¢ 11 months ago |
|  | |

Comment on [attachment 9381857](/attachment.cgi?id=9381857 "Bug 1880692, part 1 - Make StringBuilder::Unit::mLength specific to literals.") [[details]](/attachment.cgi?id=9381857&action=edit "Bug 1880692, part 1 - Make StringBuilder::Unit::mLength specific to literals.")

[Bug 1880692](/show_bug.cgi?id=1880692 "VERIFIED FIXED - Write beyond bounds caused by AppendEncodedAttributeValue() et al"), part 1 - Make StringBuilder::Unit::mLength specific to literals.

Approved to land and uplift

[Attachment #9381857](/attachment.cgi?id=9381857&action=edit "Bug 1880692, part 1 - Make StringBuilder::Unit::mLength specific to literals.") -
Flags: sec-approval? â†’ sec-approval+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1880692#a495517_578488)â€¢ 11 months ago |

[Attachment #9381124](/attachment.cgi?id=9381124&action=edit "Bug 1880692, part 2 - Use an estimate for encoded characters.") -
Flags: sec-approval? â†’ sec-approval+

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1880692#c15)â€¢ 11 months ago |
|  | |

Pushed by amccreight@mozilla.com:
<https://hg.mozilla.org/integration/autoland/rev/866922425c5e>
part 1 - Make StringBuilder::Unit::mLength specific to literals. r=smaug
<https://hg.mozilla.org/integration/autoland/rev/9669232a5702>
part 2 - Use an estimate for encoded characters. r=smaug

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1880692#a504408_75935)â€¢ 11 months ago |

[status-firefox123](/buglist.cgi?f1=cf_status_firefox123&o1=isnotempty):
--- â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox123&o1=equals&v1=wontfix)
[status-firefox124](/buglist.cgi?f1=cf_status_firefox124&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox124&o1=equals&v1=affected)
[status-firefox125](/buglist.cgi?f1=cf_status_firefox125&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=affected)
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected)
[tracking-firefox124](/buglist.cgi?f1=cf_tracking_firefox124&o1=isnotempty):
--- â†’ [+](/buglist.cgi?f1=cf_tracking_firefox124&o1=equals&v1=%2B)
[tracking-firefox125](/buglist.cgi?f1=cf_tracking_firefox125&o1=isnotempty):
--- â†’ [+](/buglist.cgi?f1=cf_tracking_firefox125&o1=equals&v1=%2B)
[tracking-firefox-esr115](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=isnotempty):
--- â†’ [124+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=124%2B)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1880692#c16)â€¢ 11 months ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/866922425c5e>

<https://hg.mozilla.org/mozilla-central/rev/9669232a5702>

Group: dom-core-security â†’ core-security-releaseStatus: NEW â†’ RESOLVEDClosed: 11 months ago
[status-firefox125](/buglist.cgi?f1=cf_status_firefox125&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=affected) â†’ [fixed](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=fixed)Resolution: --- â†’ FIXEDTarget Milestone: --- â†’ 125 Branch

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1880692#c17)â€¢ 11 months ago |
|  | |

The patch landed in nightly and beta is affected.

:mccr8, is this bug important enough to require an uplift?

* If yes, please nominate the patch for beta approval.
* If no, please set `status-firefox124` to `wontfix`.

For more information, please visit [BugBot documentation](https://wiki.mozilla.org/BugBot#uplift_beta.py).

Flags: needinfo?(continuation)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1880692#c18)â€¢ 11 months ago |
|  | |

I'll put in an uplift request on Monday. I think we're still early in the cycle and a few more days might let any performance issues shake out.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1880692#c19)â€¢ 11 months ago |
|  | |

Here's a simplified version of the steps to reproduce from [comment 0](/show_bug.cgi?id=1880692#c0 "VERIFIED FIXED - Write beyond bounds caused by AppendEncodedAttributeValue() et al"). Basically I removed all of the debugger steps, which are not necessary for verification in my experience. (I did not actually go through the debugger steps myself, though the description was useful for understanding the issue.

1. Download the attachment `ffbug_2260_11.zip` and unzip it in a new directory, yielding `ffbug_2260_11.htm` and `ffbug_2260_11_worker.js`. Note that `ffbug_2260_11.htm` is around 683MB.
2. Start a webserver hosting these files. On MacOS, I did this by running `python3 -m http.server` in the directory I put the files from the previous step.
3. Start Firefox.
4. Load `ffbug_2260_11.htm` in Firefox. With the way I set up the webserver, I was able to do this by visiting `http://localhost:8000/ffbug_2260_11.htm`.

Expected behavior: the page loads, but nothing happens, resulting in a blank tab.

Actual behavior (unpatched): the tab crashes. This shouldn't take more than a few seconds.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1880692#c20)â€¢ 11 months ago |
|  | |

Comment on [attachment 9381857](/attachment.cgi?id=9381857 "Bug 1880692, part 1 - Make StringBuilder::Unit::mLength specific to literals.") [[details]](/attachment.cgi?id=9381857&action=edit "Bug 1880692, part 1 - Make StringBuilder::Unit::mLength specific to literals.")

[Bug 1880692](/show_bug.cgi?id=1880692 "VERIFIED FIXED - Write beyond bounds caused by AppendEncodedAttributeValue() et al"), part 1 - Make StringBuilder::Unit::mLength specific to literals.

### Beta/Release Uplift Approval Request

* **User impact if declined**: sec-high
* **Is this code covered by automated tests?**: Yes
* **Has the fix been verified in Nightly?**: No
* **Needs manual test from QE?**: Yes
* **If yes, steps to reproduce**: See [comment 19](/show_bug.cgi?id=1880692#c19 "VERIFIED FIXED - Write beyond bounds caused by AppendEncodedAttributeValue() et al"). It might be hard to verify on lower memory configurations, like 32-bit and Android, but the code is platform independent so I think it is okay to skip those if it is too difficult.
* **List of other uplifts needed**: none
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: This makes us use slightly more memory in some situations, but I don't think it'll matter in any realistic scenario.
* **String changes made/needed**: none
* **Is Android affected?**: Yes

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: sec-high
* **User impact if declined**: sec-high
* **Fix Landed on Version**: 125
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: This makes us use slightly more memory in some situations, but I don't think it'll matter in any realistic scenario.
Flags: needinfo?(continuation)
[Attachment #9381857](/attachment.cgi?id=9381857&action=edit "Bug 1880692, part 1 - Make StringBuilder::Unit::mLength specific to literals.") -
Flags: approval-mozilla-esr115?
[Attachment #9381857](/attachment.cgi?id=9381857&action=edit "Bug 1880692, part 1 - Make StringBuilder::Unit::mLength specific to literals.") -
Flags: approval-mozilla-beta?

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1880692#a838649_406194)â€¢ 11 months ago |

[Attachment #9381124](/attachment.cgi?id=9381124&action=edit "Bug 1880692, part 2 - Use an estimate for encoded characters.") -
Flags: approval-mozilla-esr115?Flags: qe-verify+

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1880692#c21)â€¢ 11 months ago |
|  | |

Comment on [attachment 9381124](/attachment.cgi?id=9381124 "Bug 1880692, part 2 - Use an estimate for encoded characters.") [[details]](/attachment.cgi?id=9381124&action=edit "Bug 1880692, part 2 - Use an estimate for encoded characters.")

[Bug 1880692](/show_bug.cgi?id=1880692 "VERIFIED FIXED - Write beyond bounds caused by AppendEncodedAttributeValue() et al"), part 2 - Use an estimate for encoded characters.

### Beta/Release Uplift Approval Request

* **User impact if declined**: (I got an error when trying to fill out the uplift request for beta before. See all of my previous answers.)
* **Is this code covered by automated tests?**: Yes
* **Has the fix been verified in Nightly?**: No
* **Needs manual test from QE?**: Yes
* **If yes, steps to reproduce**: see above
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: see above
* **String changes made/needed**: none
* **Is Android affected?**: Yes
[Attachment #9381124](/attachment.cgi?id=9381124&action=edit "Bug 1880692, part 2 - Use an estimate for encoded characters.") -
Flags: approval-mozilla-beta?

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1880692#c22)â€¢ 11 months ago |
|  | |

Would you mind putting together a version of your test case that dynamically constructs the attack string instead of including it inline? It would be nice to have a test case for this in-tree, but a 700MB test case is obviously a bit hard to deal with. Thanks.

Flags: needinfo?(mozillabugs)

|  | [mozillabugs](/user_profile?user_id=608633)  Reporter |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1880692#c23)â€¢ 11 months ago |
|  | |

(In reply to Andrew McCreight [:mccr8] from [comment #22](/show_bug.cgi?id=1880692#c22 "VERIFIED FIXED - Write beyond bounds caused by AppendEncodedAttributeValue() et al"))

> Would you mind putting together a version of your test case that dynamically constructs the attack string instead of including it inline? It would be nice to have a test case for this in-tree, but a 700MB test case is obviously a bit hard to deal with. Thanks.

Try the new attachments ffbug\_2060\_20.htm and ffbug\_2260\_20\_worker.js. This POC crashes other threads even more frequently than the previous version, probably because there's more JS running.

Flags: needinfo?(mozillabugs)

|  | [mozillabugs](/user_profile?user_id=608633)  Reporter |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1880692#c24)â€¢ 11 months ago |
|  | |

Attached file
[ffbug\_2260\_20.htm](attachment.cgi?id=9382662)
â€” [Details](attachment.cgi?id=9382662&action=edit)

|  | [mozillabugs](/user_profile?user_id=608633)  Reporter |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1880692#c25)â€¢ 11 months ago |
|  | |

Attached file
[ffbug\_2260\_20\_worker.js](attachment.cgi?id=9382663)
â€” [Details](attachment.cgi?id=9382663&action=edit)

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1880692#a908868_553429)â€¢ 11 months ago |

QA Whiteboard: [qa-triaged]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1880692#a937117_1689)â€¢ 11 months ago |

Flags: sec-bounty? â†’ sec-bounty+

|  | [Bogdan Maris, Desktop Test Engineering [PTO until 13 Jan]](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1880692#c26)â€¢ 11 months ago â€¢ [Edited](/page.cgi?id=comment-revisions.html&bug_id=1880692&comment_id=16820918 "1 revision") |
|  | |

Using old Nightly from 2024-02-20 and the steps provided in [comment 19](/show_bug.cgi?id=1880692#c19 "VERIFIED FIXED - Write beyond bounds caused by AppendEncodedAttributeValue() et al") I was able to reproduce the crash (<https://crash-stats.mozilla.org/report/index/4b6ebcd8-6dcf-436c-bd2d-774b50240228>).

Using latest Nightly 125.0a1 from today I was not able to get the crash anymore and the expected result from [comment 19](/show_bug.cgi?id=1880692#c19 "VERIFIED FIXED - Write beyond bounds caused by AppendEncodedAttributeValue() et al") is met "Expected behavior: the page loads, but nothing happens, resulting in a blank tab.". Testing was done on macOS 13.6, Windows 10 64bit and Ubuntu 22.04.

[status-firefox125](/buglist.cgi?f1=cf_status_firefox125&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=fixed) â†’ [verified](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=verified)

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1880692#c27)â€¢ 11 months ago |
|  | |

Comment on [attachment 9381857](/attachment.cgi?id=9381857 "Bug 1880692, part 1 - Make StringBuilder::Unit::mLength specific to literals.") [[details]](/attachment.cgi?id=9381857&action=edit "Bug 1880692, part 1 - Make StringBuilder::Unit::mLength specific to literals.")

[Bug 1880692](/show_bug.cgi?id=1880692 "VERIFIED FIXED - Write beyond bounds caused by AppendEncodedAttributeValue() et al"), part 1 - Make StringBuilder::Unit::mLength specific to literals.

Approved for 124.0b6

[Attachment #9381857](/attachment.cgi?id=9381857&action=edit "Bug 1880692, part 1 - Make StringBuilder::Unit::mLength specific to literals.") -
Flags: approval-mozilla-beta? â†’ approval-mozilla-beta+

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1880692#a1023902_690067)â€¢ 11 months ago |

[Attachment #9381124](/attachment.cgi?id=9381124&action=edit "Bug 1880692, part 2 - Use an estimate for encoded characters.") -
Flags: approval-mozilla-beta? â†’ approval-mozilla-beta+

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1880692#c28)â€¢ 11 months ago |
|  | |

Pushed by dsmith@mozilla.com:
<https://hg.mozilla.org/releases/mozilla-beta/rev/516d301d7194>
part 1 - Make StringBuilder::Unit::mLength specific to literals. r=smaug, a-dsmith
<https://hg.mozilla.org/releases/mozilla-beta/rev/0d288e36a43a>
part 2 - Use an estimate for encoded characters. r=smaug, a-dsmith

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1880692#a1037422_690067)â€¢ 11 months ago |

[status-firefox124](/buglist.cgi?f1=cf_status_firefox124&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox124&o1=equals&v1=affected) â†’ [fixed](/buglist.cgi?f1=cf_status_firefox124&o1=equals&v1=fixed)

|  | [Bogdan Maris, Desktop Test Engineering [PTO until 13 Jan]](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1880692#c29)â€¢ 11 months ago |
|  | |

(In reply to Bogdan Maris, Desktop QA from [comment #26](/show_bug.cgi?id=1880692#c26 "VERIFIED FIXED - Write beyond bounds caused by AppendEncodedAttributeValue() et al"))

> Using old Nightly from 2024-02-20 and the steps provided in [comment 19](/show_bug.cgi?id=1880692#c19 "VERIFIED FIXED - Write beyond bounds caused by AppendEncodedAttributeValue() et al") I was able to reproduce the crash (<https://crash-stats.mozilla.org/report/index/4b6ebcd8-6dcf-436c-bd2d-774b50240228>).
>
> Using latest Nightly 125.0a1 from today I was not able to get the crash anymore and the expected result from [comment 19](/show_bug.cgi?id=1880692#c19 "VERIFIED FIXED - Write beyond bounds caused by AppendEncodedAttributeValue() et al") is met "Expected behavior: the page loads, but nothing happens, resulting in a blank tab.". Testing was done on macOS 13.6, Windows 10 64bit and Ubuntu 22.04.

Same thing using the latest Beta 124 build from treeherder on the same OSs. Not marking as verified until ESR gets the fix as well when the time comes.

[status-firefox124](/buglist.cgi?f1=cf_status_firefox124&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox124&o1=equals&v1=fixed) â†’ [verified](/buglist.cgi?f1=cf_status_firefox124&o1=equals&v1=verified)Flags: qe-verify+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1880692#c30)â€¢ 10 months ago |
|  | |

Comment on [attachment 9381124](/attachment.cgi?id=9381124 "Bug 1880692, part 2 - Use an estimate for encoded characters.") [[details]](/attachment.cgi?id=9381124&action=edit "Bug 1880692, part 2 - Use an estimate for encoded characters.")

[Bug 1880692](/show_bug.cgi?id=1880692 "VERIFIED FIXED - Write beyond bounds caused by AppendEncodedAttributeValue() et al"), part 2 - Use an estimate for encoded characters.

Approved for 115.9esr.

[Attachment #9381124](/attachment.cgi?id=9381124&action=edit "Bug 1880692, part 2 - Use an estimate for encoded characters.") -
Flags: approval-mozilla-esr115? â†’ approval-mozilla-esr115+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1880692#a1454742_75935)â€¢ 10 months ago |

[Attachment #9381857](/attachment.cgi?id=9381857&action=edit "Bug 1880692, part 1 - Make StringBuilder::Unit::mLength specific to literals.") -
Flags: approval-mozilla-esr115? â†’ approval-mozilla-esr115+

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1880692#c31)â€¢ 10 months ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr115/rev/ab88c34b160c>
<https://hg.mozilla.org/releases/mozilla-esr115/rev/8986273499ef>

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1880692#a1454975_75935)â€¢ 10 months ago |

[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected) â†’ [fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed)

|  | [Bogdan Maris, Desktop Test Engineering [PTO until 13 Jan]](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1880692#c32)â€¢ 10 months ago |
|  | |

Also verified using the latest Firefox 115 ESR build from treeherder across platforms (Windows 10 64bit, macOS 13.6 and Ubuntu 22.04) that this is fixed.

Status: RESOLVED â†’ VERIFIED
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed) â†’ [verified](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=verified)

|  | [Tyson Smith [:tsmith]](/user_profile?user_id=486634) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1880692#a2249163_486634)â€¢ 10 months ago |

Whiteboard: [adv-main124+]

|  | [Tyson Smith [:tsmith]](/user_profile?user_id=486634) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1880692#a2251171_486634)â€¢ 10 months ago |

Whiteboard: [adv-main124+] â†’ [adv-main124+][adv-esr115.9+]

|  | [Tyson Smith [:tsmith]](/user_profile?user_id=486634) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1880692#c33)â€¢ 10 months ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9391484)
â€” [Details](attachment.cgi?id=9391484&action=edit)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1880692#a2654030_428608)â€¢ 10 months ago |

Alias: CVE-2024-2608

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1880692#a8968318_5898)â€¢ 7 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1880692#a18346692_1689)â€¢ 4 months ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1880692&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top â†‘

## Attachment

Hide Details

### General

Creator:  [mozillabugs](/user_profile?user_id=608633)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from lists.debian.org_e11c6c1b_20250110_151651.html ===


---

[[Date Prev](msg00027.html)][[Date Next](msg00029.html)]
[[Thread Prev](msg00027.html)][[Thread Next](msg00029.html)]
[[Date Index](maillist.html#00028)]
[[Thread Index](threads.html#00028)]

# [SECURITY] [DLA 3775-1] firefox-esr security update

---

* *To*: <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 3775-1] firefox-esr security update
* *From*: Emilio Pozuelo Monfort <pochu@debian.org>
* *Date*: Mon, 25 Mar 2024 16:40:17 +0100
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20240325154017.ADCA42A58F4%40andromeda)Â [20240325154017.ADCA42A58F4@andromeda](msg00028.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3775-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>               Emilio Pozuelo Monfort
March 25, 2024                                <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : firefox-esr
Version        : 115.9.1esr-1~deb10u1
CVE ID         : CVE-2023-5388 CVE-2024-0743 CVE-2024-2607 CVE-2024-2608
                 CVE-2024-2610 CVE-2024-2611 CVE-2024-2612 CVE-2024-2614
                 CVE-2024-2616 CVE-2024-29944

Multiple security issues have been found in the Mozilla Firefox web
browser, which could potentially result in the execution of arbitrary
code or information disclosure, bypass of content security policies or
spoofing.

For Debian 10 buster, these problems have been fixed in version
115.9.1esr-1~deb10u1.

We recommend that you upgrade your firefox-esr packages.

For the detailed security status of firefox-esr please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/firefox-esr>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEcJymx+vmJZxd92Q+nUbEiOQ2gwIFAmYBmt8ACgkQnUbEiOQ2
gwJwEhAAmyRjcvzEvVABt3uxa4OjpFBc9DX/4VCN3hGFYvNwwgs2ISdZefClY6ru
okS56UBLGArB6kCm7JEn2dbRTveEKSX5QMSuK8f8d3dttF6Prdb7iry0kbmNwG0B
VXD2MR2hue/LxGh69utkYMHAOdXFCOpq6h/qOq5RigoJY2Vj9Q2Y+XhHsTL6r5OX
V+ek5V8ndV0Ul6FIgxy/uLG2EU5yvF+aGMuWJhI3FJtOtwswHZ8kLB+oU/H0+zbJ
eZceFSM91CO89V1GrHUzex22RjH9qgYyYJp86Cn9SDYCbtxeF9gFBuSlJtznr5pt
sfzEiQS4GF4b1/P/V6lfmWZ7KwBSX4reSAodkJDbmMBGRBivYBLNjihVQaUROOM6
iKHEEcGqA1SQ1jJI/s466a5ElwAUAX3QWhDK/8C5kBhUceXtTFZdjlI6BdJYy7ev
EHXfhGRUiLOHFXa01nACuvyWCdkEfuUJm6MrBgXgtDKK63s0zpeSzVa5P3bThkAT
kBvZm8og2l5EpSu4zkLZZsNly4mDvPMNZY9fsAFlNyMHrICeU+YvpW1h7A8VkgYE
wzF3ePBQMRAbtCA56CW5Ck+eBWgDxUWFI32ozEc/hzuIffXyNYldI46MkIq/Y/39
J6f97aDmOXD/76GriYtND8CTTVCY2nYIt0ZPtxdr51B/8+NsEBw=
=6Jci
-----END PGP SIGNATURE-----

```

---



=== Content from www.mozilla.org_28015232_20250110_151653.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, weâ€™d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured â€” we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2024-14

## Security Vulnerabilities fixed in Thunderbird 115.9

Announced
March 19, 2024
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 115.9

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2024-0743: Crash in NSS TLS method](#CVE-2024-0743)

Reporter
John Schanck
Impact
high
##### Description

An unchecked return value in TLS handshake code could have caused a potentially exploitable crash.

##### References

* [Bug 1867408](https://bugzilla.mozilla.org/show_bug.cgi?id=1867408)

#### [#CVE-2024-2605: Windows Error Reporter could be used as a Sandbox escape vector](#CVE-2024-2605)

Reporter
goodbyeselene
Impact
high
##### Description

An attacker could have leveraged the Windows Error Reporter to run arbitrary code on the system escaping the sandbox. *Note:* This issue only affected Windows operating systems. Other operating systems are unaffected.

##### References

* [Bug 1872920](https://bugzilla.mozilla.org/show_bug.cgi?id=1872920)

#### [#CVE-2024-2607: JIT code failed to save return registers on Armv7-A](#CVE-2024-2607)

Reporter
Gary Kwong
Impact
high
##### Description

Return registers were overwritten which could have allowed an attacker to execute arbitrary code. *Note:* This issue only affected Armv7-A systems. Other operating systems are unaffected.

##### References

* [Bug 1879939](https://bugzilla.mozilla.org/show_bug.cgi?id=1879939)

#### [#CVE-2024-2608: Integer overflow could have led to out of bounds write](#CVE-2024-2608)

Reporter
Ronald Crane
Impact
high
##### Description

`AppendEncodedAttributeValue(), ExtraSpaceNeededForAttrEncoding()` and `AppendEncodedCharacters()` could have experienced integer overflows, causing underallocation of an output buffer leading to an out of bounds write.

##### References

* [Bug 1880692](https://bugzilla.mozilla.org/show_bug.cgi?id=1880692)

#### [#CVE-2024-2616: Improve handling of out-of-memory conditions in ICU](#CVE-2024-2616)

Reporter
Ryan VanderMeulen and Dan Minor
Impact
high
##### Description

To harden ICU against exploitation, the behavior for out-of-memory conditions was changed to crash instead of attempt to continue.

##### References

* [Bug 1846197](https://bugzilla.mozilla.org/show_bug.cgi?id=1846197)

#### [#CVE-2023-5388: NSS susceptible to timing attack against RSA decryption](#CVE-2023-5388)

Reporter
Hubert Kario
Impact
moderate
##### Description

NSS was susceptible to a timing side-channel attack when performing RSA decryption. This attack could potentially allow an attacker to recover the private data.

##### References

* [Bug 1780432](https://bugzilla.mozilla.org/show_bug.cgi?id=1780432)

#### [#CVE-2024-2610: Improper handling of html and body tags enabled CSP nonce leakage](#CVE-2024-2610)

Reporter
Georg Felber and Marco Squarcina (TU Wien)
Impact
moderate
##### Description

Using a markup injection an attacker could have stolen nonce values. This could have been used to bypass strict content security policies.

##### References

* [Bug 1871112](https://bugzilla.mozilla.org/show_bug.cgi?id=1871112)

#### [#CVE-2024-2611: Clickjacking vulnerability could have led to a user accidentally granting permissions](#CVE-2024-2611)

Reporter
Hafiizh
Impact
moderate
##### Description

A missing delay on when pointer lock was used could have allowed a malicious page to trick a user into granting permissions.

##### References

* [Bug 1876675](https://bugzilla.mozilla.org/show_bug.cgi?id=1876675)

#### [#CVE-2024-2612: Self referencing object could have potentially led to a use-after-free](#CVE-2024-2612)

Reporter
Ronald Crane
Impact
moderate
##### Description

If an attacker could find a way to trigger a particular code path in `SafeRefPtr`, it could have triggered a crash or potentially be leveraged to achieve code execution.

##### References

* [Bug 1879444](https://bugzilla.mozilla.org/show_bug.cgi?id=1879444)

#### [#CVE-2024-2614: Memory safety bugs fixed in Firefox 124, Firefox ESR 115.9, and Thunderbird 115.9](#CVE-2024-2614)

Reporter
Noah Lokocz, Kevin Brosnan, Ryan VanderMeulen and the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 123, Firefox ESR 115.8, and Thunderbird 115.8. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 124, Firefox ESR 115.9, and Thunderbird 115.9](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1685358%2C1861016%2C1880405%2C1881093)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporationâ€™s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are Â©1998â€“2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_1388573f_20250110_151651.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, weâ€™d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured â€” we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2024-12

## Security Vulnerabilities fixed in Firefox 124

Announced
March 19, 2024
Impact
high
Products
Firefox
Fixed in

* Firefox 124

#### [#CVE-2024-2605: Windows Error Reporter could be used as a Sandbox escape vector](#CVE-2024-2605)

Reporter
goodbyeselene
Impact
high
##### Description

An attacker could have leveraged the Windows Error Reporter to run arbitrary code on the system escaping the sandbox. *Note:* This issue only affected Windows operating systems. Other operating systems are unaffected.

##### References

* [Bug 1872920](https://bugzilla.mozilla.org/show_bug.cgi?id=1872920)

#### [#CVE-2024-2606: Mishandling of WASM register values](#CVE-2024-2606)

Reporter
P1umer
Impact
high
##### Description

Passing invalid data could have led to invalid wasm values being created, such as arbitrary integers turning into pointer values.

##### References

* [Bug 1879237](https://bugzilla.mozilla.org/show_bug.cgi?id=1879237)

#### [#CVE-2024-2607: JIT code failed to save return registers on Armv7-A](#CVE-2024-2607)

Reporter
Gary Kwong
Impact
high
##### Description

Return registers were overwritten which could have allowed an attacker to execute arbitrary code. *Note:* This issue only affected Armv7-A systems. Other operating systems are unaffected.

##### References

* [Bug 1879939](https://bugzilla.mozilla.org/show_bug.cgi?id=1879939)

#### [#CVE-2024-2608: Integer overflow could have led to out of bounds write](#CVE-2024-2608)

Reporter
Ronald Crane
Impact
high
##### Description

`AppendEncodedAttributeValue(), ExtraSpaceNeededForAttrEncoding()` and `AppendEncodedCharacters()` could have experienced integer overflows, causing underallocation of an output buffer leading to an out of bounds write.

##### References

* [Bug 1880692](https://bugzilla.mozilla.org/show_bug.cgi?id=1880692)

#### [#CVE-2023-5388: NSS susceptible to timing attack against RSA decryption](#CVE-2023-5388)

Reporter
Hubert Kario
Impact
moderate
##### Description

NSS was susceptible to a timing side-channel attack when performing RSA decryption. This attack could potentially allow an attacker to recover the private data.

##### References

* [Bug 1780432](https://bugzilla.mozilla.org/show_bug.cgi?id=1780432)

#### [#CVE-2024-2609: Permission prompt input delay could expire when not in focus](#CVE-2024-2609)

Reporter
Shaheen Fazim
Impact
moderate
##### Description

The permission prompt input delay could have expired while the window is not in focus, which made the prompt vulnerable to clickjacking by malicious websites.

##### References

* [Bug 1866100](https://bugzilla.mozilla.org/show_bug.cgi?id=1866100)

#### [#CVE-2024-2610: Improper handling of html and body tags enabled CSP nonce leakage](#CVE-2024-2610)

Reporter
Georg Felber and Marco Squarcina (TU Wien)
Impact
moderate
##### Description

Using a markup injection an attacker could have stolen nonce values. This could have been used to bypass strict content security policies.

##### References

* [Bug 1871112](https://bugzilla.mozilla.org/show_bug.cgi?id=1871112)

#### [#CVE-2024-2611: Clickjacking vulnerability could have led to a user accidentally granting permissions](#CVE-2024-2611)

Reporter
Hafiizh
Impact
moderate
##### Description

A missing delay on when pointer lock was used could have allowed a malicious page to trick a user into granting permissions.

##### References

* [Bug 1876675](https://bugzilla.mozilla.org/show_bug.cgi?id=1876675)

#### [#CVE-2024-2612: Self referencing object could have potentially led to a use-after-free](#CVE-2024-2612)

Reporter
Ronald Crane
Impact
moderate
##### Description

If an attacker could find a way to trigger a particular code path in `SafeRefPtr`, it could have triggered a crash or potentially be leveraged to achieve code execution.

##### References

* [Bug 1879444](https://bugzilla.mozilla.org/show_bug.cgi?id=1879444)

#### [#CVE-2024-2613: Improper handling of QUIC ACK frame data could have led to OOM](#CVE-2024-2613)

Reporter
Max Inden
Impact
low
##### Description

Data was not properly sanitized when decoding a QUIC ACK frame; this could have led to unrestricted memory consumption and a crash.

##### References

* [Bug 1875701](https://bugzilla.mozilla.org/show_bug.cgi?id=1875701)

#### [#CVE-2024-2614: Memory safety bugs fixed in Firefox 124, Firefox ESR 115.9, and Thunderbird 115.9](#CVE-2024-2614)

Reporter
Noah Lokocz, Kevin Brosnan, Ryan VanderMeulen and the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 123, Firefox ESR 115.8, and Thunderbird 115.8. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 124, Firefox ESR 115.9, and Thunderbird 115.9](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1685358%2C1861016%2C1880405%2C1881093)

#### [#CVE-2024-2615: Memory safety bugs fixed in Firefox 124](#CVE-2024-2615)

Reporter
Paul Bone and the Mozilla Fuzzing Team
Impact
critical
##### Description

Memory safety bugs present in Firefox 123. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 124](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1881074%2C1882438%2C1881650)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporationâ€™s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are Â©1998â€“2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_e4d1377b_20250110_151652.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, weâ€™d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured â€” we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2024-13

## Security Vulnerabilities fixed in Firefox ESR 115.9

Announced
March 19, 2024
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 115.9

#### [#CVE-2024-0743: Crash in NSS TLS method](#CVE-2024-0743)

Reporter
John Schanck
Impact
high
##### Description

An unchecked return value in TLS handshake code could have caused a potentially exploitable crash.

##### References

* [Bug 1867408](https://bugzilla.mozilla.org/show_bug.cgi?id=1867408)

#### [#CVE-2024-2605: Windows Error Reporter could be used as a Sandbox escape vector](#CVE-2024-2605)

Reporter
goodbyeselene
Impact
high
##### Description

An attacker could have leveraged the Windows Error Reporter to run arbitrary code on the system escaping the sandbox. *Note:* This issue only affected Windows operating systems. Other operating systems are unaffected.

##### References

* [Bug 1872920](https://bugzilla.mozilla.org/show_bug.cgi?id=1872920)

#### [#CVE-2024-2607: JIT code failed to save return registers on Armv7-A](#CVE-2024-2607)

Reporter
Gary Kwong
Impact
high
##### Description

Return registers were overwritten which could have allowed an attacker to execute arbitrary code. *Note:* This issue only affected Armv7-A systems. Other operating systems are unaffected.

##### References

* [Bug 1879939](https://bugzilla.mozilla.org/show_bug.cgi?id=1879939)

#### [#CVE-2024-2608: Integer overflow could have led to out of bounds write](#CVE-2024-2608)

Reporter
Ronald Crane
Impact
high
##### Description

`AppendEncodedAttributeValue(), ExtraSpaceNeededForAttrEncoding()` and `AppendEncodedCharacters()` could have experienced integer overflows, causing underallocation of an output buffer leading to an out of bounds write.

##### References

* [Bug 1880692](https://bugzilla.mozilla.org/show_bug.cgi?id=1880692)

#### [#CVE-2024-2616: Improve handling of out-of-memory conditions in ICU](#CVE-2024-2616)

Reporter
Ryan VanderMeulen and Dan Minor
Impact
high
##### Description

To harden ICU against exploitation, the behavior for out-of-memory conditions was changed to crash instead of attempt to continue.

##### References

* [Bug 1846197](https://bugzilla.mozilla.org/show_bug.cgi?id=1846197)

#### [#CVE-2023-5388: NSS susceptible to timing attack against RSA decryption](#CVE-2023-5388)

Reporter
Hubert Kario
Impact
moderate
##### Description

NSS was susceptible to a timing side-channel attack when performing RSA decryption. This attack could potentially allow an attacker to recover the private data.

##### References

* [Bug 1780432](https://bugzilla.mozilla.org/show_bug.cgi?id=1780432)

#### [#CVE-2024-2610: Improper handling of html and body tags enabled CSP nonce leakage](#CVE-2024-2610)

Reporter
Georg Felber and Marco Squarcina (TU Wien)
Impact
moderate
##### Description

Using a markup injection an attacker could have stolen nonce values. This could have been used to bypass strict content security policies.

##### References

* [Bug 1871112](https://bugzilla.mozilla.org/show_bug.cgi?id=1871112)

#### [#CVE-2024-2611: Clickjacking vulnerability could have led to a user accidentally granting permissions](#CVE-2024-2611)

Reporter
Hafiizh
Impact
moderate
##### Description

A missing delay on when pointer lock was used could have allowed a malicious page to trick a user into granting permissions.

##### References

* [Bug 1876675](https://bugzilla.mozilla.org/show_bug.cgi?id=1876675)

#### [#CVE-2024-2612: Self referencing object could have potentially led to a use-after-free](#CVE-2024-2612)

Reporter
Ronald Crane
Impact
moderate
##### Description

If an attacker could find a way to trigger a particular code path in `SafeRefPtr`, it could have triggered a crash or potentially be leveraged to achieve code execution.

##### References

* [Bug 1879444](https://bugzilla.mozilla.org/show_bug.cgi?id=1879444)

#### [#CVE-2024-2614: Memory safety bugs fixed in Firefox 124, Firefox ESR 115.9, and Thunderbird 115.9](#CVE-2024-2614)

Reporter
Noah Lokocz, Kevin Brosnan, Ryan VanderMeulen and the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 123, Firefox ESR 115.8, and Thunderbird 115.8. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 124, Firefox ESR 115.9, and Thunderbird 115.9](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1685358%2C1861016%2C1880405%2C1881093)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporationâ€™s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are Â©1998â€“2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


