Based on the provided content, here's an analysis of CVE-2024-8628:

**Root Cause of Vulnerability:**

*   The vulnerability is due to insufficient input sanitization and output escaping of user-supplied attributes within the 'post-meta' shortcode of the MailOptin plugin.

**Weaknesses/Vulnerabilities Present:**

*   **Stored Cross-Site Scripting (XSS):** The plugin fails to properly sanitize user inputs within the 'post-meta' shortcode which allows malicious JavaScript to be stored and executed in the context of the victim's browser when the page containing the malicious code is accessed.

**Impact of Exploitation:**

*   **Arbitrary Script Execution:** An attacker can inject malicious web scripts into pages. These scripts execute when a user accesses the compromised page.
*   **Potential for Various Attacks:** This allows the attacker to perform actions on behalf of the victim, such as redirecting users to malicious websites, stealing session cookies, or performing other unauthorized actions.
*   **Compromise of Confidentiality and Integrity:** Data can be viewed, modified or deleted by a malicious actor.

**Attack Vectors:**

*   **Shortcode Injection:** Attackers inject malicious JavaScript code within the attributes of the 'post-meta' shortcode.

**Required Attacker Capabilities/Position:**

*   **Authenticated Access:** The attacker needs to have at least contributor-level access to the WordPress site.
*   **Ability to Create/Edit Content:** The attacker must be able to create or edit content on the site where the shortcode is used.

**Additional Details:**

*   The vulnerable code is located in the `Shortcodes.php` file of the MailOptin plugin.
*   The vulnerability exists in versions up to and including 1.2.70.3.
*   The fix implemented in version 1.2.70.4 involves using `wp_kses_post` to sanitize the output.