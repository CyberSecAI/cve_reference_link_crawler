```
{
  "vulnerability": {
    "root_cause": "The s390 architecture does not support HWPOISON, MEMORY_FAILURE, or ARCH_HAS_COPY_MC. However, due to a change in how PTE_MARKER_SWAPIN_ERROR is handled, VM_FAULT_HWPOISON can occur in combination with PTE_MARKER_POISONED, leading to an unexpected BUG() in do_exception().",
    "weaknesses": [
      "Incorrect handling of VM_FAULT_HWPOISON on s390 architecture when it is not expected."
    ],
    "impact": "The kernel can trigger a BUG() due to unexpected fault flags during memory access, potentially leading to a denial of service.",
    "attack_vectors": "An attacker would need to trigger a memory fault that results in VM_FAULT_HWPOISON, possibly by manipulating memory in a way that sets PTE_MARKER_POISONED.",
    "required_capabilities": "The attacker would need the ability to trigger a memory fault leading to the described condition. This could involve manipulating memory through operations like swapping."
  },
  "patches": [
    {
      "commit_id": "a3aefb871222a9880602d1a44a558177b4143e3b",
      "description": "Treat VM_FAULT_HWPOISON the same as VM_FAULT_SIGBUS in do_exception(), similar to x86 when MEMORY_FAILURE is not configured. Also prints unexpected fault flags for easier debugging."
    },
    {
      "commit_id": "9e13767ccefdc4f8aa92514b592b60f6b54882ff",
        "description": "Treat VM_FAULT_HWPOISON the same as VM_FAULT_SIGBUS in do_exception(), similar to x86 when MEMORY_FAILURE is not configured. Also prints unexpected fault flags for easier debugging."
    },
   {
      "commit_id": "73a9260b7366d2906ec011e100319359fe2277d0",
        "description": "Treat VM_FAULT_HWPOISON the same as VM_FAULT_SIGBUS in do_exception(), similar to x86 when MEMORY_FAILURE is not configured. Also prints unexpected fault flags for easier debugging."
    },
    {
     "commit_id": "df39038cd89525d465c2c8827eb64116873f141a",
        "description": "Treat VM_FAULT_HWPOISON the same as VM_FAULT_SIGBUS in do_exception(), similar to x86 when MEMORY_FAILURE is not configured. Also prints unexpected fault flags for easier debugging."
    }
  ],
   "details": "The vulnerability arises due to an unexpected interaction between the memory management system and hardware poisoning flags on the s390 architecture. The core issue is that the s390 architecture lacks explicit support for HWPOISON but a code change in commit af19487f00f3 made it possible for VM_FAULT_HWPOISON flag to be set in conjunction with PTE_MARKER_POISONED even on systems that do not support HWPOISON, this causes kernel to hit BUG() in do_exception(). The fix involves treating the VM_FAULT_HWPOISON the same way as VM_FAULT_SIGBUS which is the intended behavior in such a case."
}
```