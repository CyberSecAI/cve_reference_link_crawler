<!DOCTYPE html>
<html lang='en'>
<head>
<title>ethtool: fail closed if we can't get max channel used in indirection tables - kernel/git/stable/linux.git - Linux kernel stable tree</title>
<meta name='generator' content='cgit 1.2.3-korg'/>
<meta name='robots' content='noindex, nofollow'/>
<link rel='stylesheet' type='text/css' href='/cgit-data/cgit.css'/>
<script type='text/javascript' src='/cgit-data/cgit.js'></script>
<link rel='shortcut icon' href='/favicon.ico'/>
<link rel='alternate' title='Atom feed' href='https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/atom/?h=master' type='application/atom+xml'/>
<link rel='vcs-git' href='git://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git' title='kernel/git/stable/linux.git Git repository'/>
<link rel='vcs-git' href='https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git' title='kernel/git/stable/linux.git Git repository'/>
<link rel='vcs-git' href='https://kernel.googlesource.com/pub/scm/linux/kernel/git/stable/linux.git' title='kernel/git/stable/linux.git Git repository'/>
</head>
<body>
<div id='cgit'><table id='header'>
<tr>
<td class='logo' rowspan='2'><a href='/'><img src='/cgit-data/cgit.png' alt='cgit logo'/></a></td>
<td class='main'><a href='/'>index</a> : <a href='/pub/scm/linux/kernel/git/stable/linux.git/'>kernel/git/stable/linux.git</a></td><td class='form'><form method='get'>
<input type='hidden' name='id' value='2899d58462ba868287d6ff3acad3675e7adf934f'/><select name='h' onchange='this.form.submit();'>
<option value='linux-2.6.11.y'>linux-2.6.11.y</option>
<option value='linux-2.6.12.y'>linux-2.6.12.y</option>
<option value='linux-2.6.13.y'>linux-2.6.13.y</option>
<option value='linux-2.6.14.y'>linux-2.6.14.y</option>
<option value='linux-2.6.15.y'>linux-2.6.15.y</option>
<option value='linux-2.6.16.y'>linux-2.6.16.y</option>
<option value='linux-2.6.17.y'>linux-2.6.17.y</option>
<option value='linux-2.6.18.y'>linux-2.6.18.y</option>
<option value='linux-2.6.19.y'>linux-2.6.19.y</option>
<option value='linux-2.6.20.y'>linux-2.6.20.y</option>
<option value='linux-2.6.21.y'>linux-2.6.21.y</option>
<option value='linux-2.6.22.y'>linux-2.6.22.y</option>
<option value='linux-2.6.23.y'>linux-2.6.23.y</option>
<option value='linux-2.6.24.y'>linux-2.6.24.y</option>
<option value='linux-2.6.25.y'>linux-2.6.25.y</option>
<option value='linux-2.6.26.y'>linux-2.6.26.y</option>
<option value='linux-2.6.27.y'>linux-2.6.27.y</option>
<option value='linux-2.6.28.y'>linux-2.6.28.y</option>
<option value='linux-2.6.29.y'>linux-2.6.29.y</option>
<option value='linux-2.6.30.y'>linux-2.6.30.y</option>
<option value='linux-2.6.31.y'>linux-2.6.31.y</option>
<option value='linux-2.6.32.y'>linux-2.6.32.y</option>
<option value='linux-2.6.33.y'>linux-2.6.33.y</option>
<option value='linux-2.6.34.y'>linux-2.6.34.y</option>
<option value='linux-2.6.35.y'>linux-2.6.35.y</option>
<option value='linux-2.6.36.y'>linux-2.6.36.y</option>
<option value='linux-2.6.37.y'>linux-2.6.37.y</option>
<option value='linux-2.6.38.y'>linux-2.6.38.y</option>
<option value='linux-2.6.39.y'>linux-2.6.39.y</option>
<option value='linux-3.0.y'>linux-3.0.y</option>
<option value='linux-3.1.y'>linux-3.1.y</option>
<option value='linux-3.10.y'>linux-3.10.y</option>
<option value='linux-3.11.y'>linux-3.11.y</option>
<option value='linux-3.12.y'>linux-3.12.y</option>
<option value='linux-3.13.y'>linux-3.13.y</option>
<option value='linux-3.14.y'>linux-3.14.y</option>
<option value='linux-3.15.y'>linux-3.15.y</option>
<option value='linux-3.16.y'>linux-3.16.y</option>
<option value='linux-3.17.y'>linux-3.17.y</option>
<option value='linux-3.18.y'>linux-3.18.y</option>
<option value='linux-3.19.y'>linux-3.19.y</option>
<option value='linux-3.2.y'>linux-3.2.y</option>
<option value='linux-3.3.y'>linux-3.3.y</option>
<option value='linux-3.4.y'>linux-3.4.y</option>
<option value='linux-3.5.y'>linux-3.5.y</option>
<option value='linux-3.6.y'>linux-3.6.y</option>
<option value='linux-3.7.y'>linux-3.7.y</option>
<option value='linux-3.8.y'>linux-3.8.y</option>
<option value='linux-3.9.y'>linux-3.9.y</option>
<option value='linux-4.0.y'>linux-4.0.y</option>
<option value='linux-4.1.y'>linux-4.1.y</option>
<option value='linux-4.10.y'>linux-4.10.y</option>
<option value='linux-4.11.y'>linux-4.11.y</option>
<option value='linux-4.12.y'>linux-4.12.y</option>
<option value='linux-4.13.y'>linux-4.13.y</option>
<option value='linux-4.14.y'>linux-4.14.y</option>
<option value='linux-4.15.y'>linux-4.15.y</option>
<option value='linux-4.16.y'>linux-4.16.y</option>
<option value='linux-4.17.y'>linux-4.17.y</option>
<option value='linux-4.18.y'>linux-4.18.y</option>
<option value='linux-4.19.y'>linux-4.19.y</option>
<option value='linux-4.2.y'>linux-4.2.y</option>
<option value='linux-4.20.y'>linux-4.20.y</option>
<option value='linux-4.3.y'>linux-4.3.y</option>
<option value='linux-4.4.y'>linux-4.4.y</option>
<option value='linux-4.5.y'>linux-4.5.y</option>
<option value='linux-4.6.y'>linux-4.6.y</option>
<option value='linux-4.7.y'>linux-4.7.y</option>
<option value='linux-4.8.y'>linux-4.8.y</option>
<option value='linux-4.9.y'>linux-4.9.y</option>
<option value='linux-5.0.y'>linux-5.0.y</option>
<option value='linux-5.1.y'>linux-5.1.y</option>
<option value='linux-5.10.y'>linux-5.10.y</option>
<option value='linux-5.11.y'>linux-5.11.y</option>
<option value='linux-5.12.y'>linux-5.12.y</option>
<option value='linux-5.13.y'>linux-5.13.y</option>
<option value='linux-5.14.y'>linux-5.14.y</option>
<option value='linux-5.15.y'>linux-5.15.y</option>
<option value='linux-5.16.y'>linux-5.16.y</option>
<option value='linux-5.17.y'>linux-5.17.y</option>
<option value='linux-5.18.y'>linux-5.18.y</option>
<option value='linux-5.19.y'>linux-5.19.y</option>
<option value='linux-5.2.y'>linux-5.2.y</option>
<option value='linux-5.3.y'>linux-5.3.y</option>
<option value='linux-5.4.y'>linux-5.4.y</option>
<option value='linux-5.5.y'>linux-5.5.y</option>
<option value='linux-5.6.y'>linux-5.6.y</option>
<option value='linux-5.7.y'>linux-5.7.y</option>
<option value='linux-5.8.y'>linux-5.8.y</option>
<option value='linux-5.9.y'>linux-5.9.y</option>
<option value='linux-6.0.y'>linux-6.0.y</option>
<option value='linux-6.1.y'>linux-6.1.y</option>
<option value='linux-6.10.y'>linux-6.10.y</option>
<option value='linux-6.11.y'>linux-6.11.y</option>
<option value='linux-6.12.y'>linux-6.12.y</option>
<option value='linux-6.2.y'>linux-6.2.y</option>
<option value='linux-6.3.y'>linux-6.3.y</option>
<option value='linux-6.4.y'>linux-6.4.y</option>
<option value='linux-6.5.y'>linux-6.5.y</option>
<option value='linux-6.6.y'>linux-6.6.y</option>
<option value='linux-6.7.y'>linux-6.7.y</option>
<option value='linux-6.8.y'>linux-6.8.y</option>
<option value='linux-6.9.y'>linux-6.9.y</option>
<option value='linux-rolling-lts'>linux-rolling-lts</option>
<option value='linux-rolling-stable'>linux-rolling-stable</option>
<option value='master' selected='selected'>master</option>
</select> <input type='submit' value='switch'/></form></td></tr>
<tr><td class='sub'>Linux kernel stable tree</td><td class='sub right'>Stable Group</td></tr></table>
<table class='tabs'><tr><td>
<a href='/pub/scm/linux/kernel/git/stable/linux.git/about/'>about</a><a href='/pub/scm/linux/kernel/git/stable/linux.git/'>summary</a><a href='/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=2899d58462ba868287d6ff3acad3675e7adf934f'>refs</a><a href='/pub/scm/linux/kernel/git/stable/linux.git/log/'>log</a><a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=2899d58462ba868287d6ff3acad3675e7adf934f'>tree</a><a class='active' href='/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2899d58462ba868287d6ff3acad3675e7adf934f'>commit</a><a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=2899d58462ba868287d6ff3acad3675e7adf934f'>diff</a><a href='/pub/scm/linux/kernel/git/stable/linux.git/stats/'>stats</a></td><td class='form'><form class='right' method='get' action='/pub/scm/linux/kernel/git/stable/linux.git/log/'>
<input type='hidden' name='id' value='2899d58462ba868287d6ff3acad3675e7adf934f'/><select name='qt'>
<option value='grep'>log msg</option>
<option value='author'>author</option>
<option value='committer'>committer</option>
<option value='range'>range</option>
</select>
<input class='txt' type='search' size='10' name='q' value=''/>
<input type='submit' value='search'/>
</form>
</td></tr></table>
<div class='content'><div class='cgit-panel'><b>diff options</b><form method='get'><input type='hidden' name='id' value='2899d58462ba868287d6ff3acad3675e7adf934f'/><table><tr><td colspan='2'/></tr><tr><td class='label'>context:</td><td class='ctrl'><select name='context' onchange='this.form.submit();'><option value='1'>1</option><option value='2'>2</option><option value='3' selected='selected'>3</option><option value='4'>4</option><option value='5'>5</option><option value='6'>6</option><option value='7'>7</option><option value='8'>8</option><option value='9'>9</option><option value='10'>10</option><option value='15'>15</option><option value='20'>20</option><option value='25'>25</option><option value='30'>30</option><option value='35'>35</option><option value='40'>40</option></select></td></tr><tr><td class='label'>space:</td><td class='ctrl'><select name='ignorews' onchange='this.form.submit();'><option value='0' selected='selected'>include</option><option value='1'>ignore</option></select></td></tr><tr><td class='label'>mode:</td><td class='ctrl'><select name='dt' onchange='this.form.submit();'><option value='0' selected='selected'>unified</option><option value='1'>ssdiff</option><option value='2'>stat only</option></select></td></tr><tr><td/><td class='ctrl'><noscript><input type='submit' value='reload'/></noscript></td></tr></table></form></div><table summary='commit info' class='commit-info'>
<tr><th>author</th><td>Jakub Kicinski &lt;kuba@kernel.org&gt;</td><td class='right'>2024-07-10 10:40:42 -0700</td></tr>
<tr><th>committer</th><td>Jakub Kicinski &lt;kuba@kernel.org&gt;</td><td class='right'>2024-07-11 14:41:41 -0700</td></tr>
<tr><th>commit</th><td colspan='2' class='oid'><a href='/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2899d58462ba868287d6ff3acad3675e7adf934f'>2899d58462ba868287d6ff3acad3675e7adf934f</a> (<a href='/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=2899d58462ba868287d6ff3acad3675e7adf934f'>patch</a>)</td></tr>
<tr><th>tree</th><td colspan='2' class='oid'><a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=2899d58462ba868287d6ff3acad3675e7adf934f'>d515db667d5280f1e8b0a5d904c0365e3d6639a7</a></td></tr>
<tr><th>parent</th><td colspan='2' class='oid'><a href='/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=7c8267275de6989a9b682a07d75e89395457ee01'>7c8267275de6989a9b682a07d75e89395457ee01</a> (<a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=2899d58462ba868287d6ff3acad3675e7adf934f&amp;id2=7c8267275de6989a9b682a07d75e89395457ee01'>diff</a>)</td></tr><tr><th>download</th><td colspan='2' class='oid'><a href='/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-2899d58462ba868287d6ff3acad3675e7adf934f.tar.gz'>linux-2899d58462ba868287d6ff3acad3675e7adf934f.tar.gz</a><br/></td></tr></table>
<div class='commit-subject'>ethtool: fail closed if we can't get max channel used in indirection tables</div><div class='commit-msg'>Commit 0d1b7d6c9274 ("bnxt: fix crashes when reducing ring count with
active RSS contexts") proves that allowing indirection table to contain
channels with out of bounds IDs may lead to crashes. Currently the
max channel check in the core gets skipped if driver can't fetch
the indirection table or when we can't allocate memory.

Both of those conditions should be extremely rare but if they do
happen we should try to be safe and fail the channel change.

Reviewed-by: Jacob Keller &lt;jacob.e.keller@intel.com&gt;
Link: <a href="https://patch.msgid.link/20240710174043.754664-2-kuba@kernel.org">https://patch.msgid.link/20240710174043.754664-2-kuba@kernel.org</a>
Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
</div><div class='diffstat-header'><a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=2899d58462ba868287d6ff3acad3675e7adf934f'>Diffstat</a></div><table summary='diffstat' class='diffstat'><tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/net/ethtool/channels.c?id=2899d58462ba868287d6ff3acad3675e7adf934f'>net/ethtool/channels.c</a></td><td class='right'>6</td><td class='graph'><table summary='file diffstat' width='26%'><tr><td class='add' style='width: 7.7%;'/><td class='rem' style='width: 15.4%;'/><td class='none' style='width: 76.9%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/net/ethtool/common.c?id=2899d58462ba868287d6ff3acad3675e7adf934f'>net/ethtool/common.c</a></td><td class='right'>26</td><td class='graph'><table summary='file diffstat' width='26%'><tr><td class='add' style='width: 57.7%;'/><td class='rem' style='width: 42.3%;'/><td class='none' style='width: 0.0%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/net/ethtool/common.h?id=2899d58462ba868287d6ff3acad3675e7adf934f'>net/ethtool/common.h</a></td><td class='right'>2</td><td class='graph'><table summary='file diffstat' width='26%'><tr><td class='add' style='width: 3.8%;'/><td class='rem' style='width: 3.8%;'/><td class='none' style='width: 92.3%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/net/ethtool/ioctl.c?id=2899d58462ba868287d6ff3acad3675e7adf934f'>net/ethtool/ioctl.c</a></td><td class='right'>4</td><td class='graph'><table summary='file diffstat' width='26%'><tr><td class='add' style='width: 3.8%;'/><td class='rem' style='width: 11.5%;'/><td class='none' style='width: 84.6%;'/></tr></table></td></tr>
</table><div class='diffstat-summary'>4 files changed, 19 insertions, 19 deletions</div><table summary='diff' class='diff'><tr><td><div class='head'>diff --git a/net/ethtool/channels.c b/net/ethtool/channels.c<br/>index 7b4bbd674bae77..cee188da54f85f 100644<br/>--- a/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ethtool/channels.c?id=7c8267275de6989a9b682a07d75e89395457ee01'>net/ethtool/channels.c</a><br/>+++ b/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ethtool/channels.c?id=2899d58462ba868287d6ff3acad3675e7adf934f'>net/ethtool/channels.c</a></div><div class='hunk'>@@ -171,11 +171,9 @@ ethnl_set_channels(struct ethnl_req_info *req_info, struct genl_info *info)</div><div class='ctx'> 	 */</div><div class='ctx'> 	if (ethtool_get_max_rxnfc_channel(dev, &amp;max_rxnfc_in_use))</div><div class='ctx'> 		max_rxnfc_in_use = 0;</div><div class='del'>-	if (!netif_is_rxfh_configured(dev) ||</div><div class='del'>-	    ethtool_get_max_rxfh_channel(dev, &amp;max_rxfh_in_use))</div><div class='del'>-		max_rxfh_in_use = 0;</div><div class='add'>+	max_rxfh_in_use = ethtool_get_max_rxfh_channel(dev);</div><div class='ctx'> 	if (channels.combined_count + channels.rx_count &lt;= max_rxfh_in_use) {</div><div class='del'>-		GENL_SET_ERR_MSG(info, "requested channel counts are too low for existing indirection table settings");</div><div class='add'>+		GENL_SET_ERR_MSG_FMT(info, "requested channel counts are too low for existing indirection table (%d)", max_rxfh_in_use);</div><div class='ctx'> 		return -EINVAL;</div><div class='ctx'> 	}</div><div class='ctx'> 	if (channels.combined_count + channels.rx_count &lt;= max_rxnfc_in_use) {</div><div class='head'>diff --git a/net/ethtool/common.c b/net/ethtool/common.c<br/>index 6b2a360dcdf069..8a62375ebd1f0a 100644<br/>--- a/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ethtool/common.c?id=7c8267275de6989a9b682a07d75e89395457ee01'>net/ethtool/common.c</a><br/>+++ b/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ethtool/common.c?id=2899d58462ba868287d6ff3acad3675e7adf934f'>net/ethtool/common.c</a></div><div class='hunk'>@@ -587,35 +587,39 @@ err_free_info:</div><div class='ctx'> 	return err;</div><div class='ctx'> }</div><div class='ctx'> </div><div class='del'>-int ethtool_get_max_rxfh_channel(struct net_device *dev, u32 *max)</div><div class='add'>+u32 ethtool_get_max_rxfh_channel(struct net_device *dev)</div><div class='ctx'> {</div><div class='ctx'> 	struct ethtool_rxfh_param rxfh = {};</div><div class='del'>-	u32 dev_size, current_max = 0;</div><div class='add'>+	u32 dev_size, current_max;</div><div class='ctx'> 	int ret;</div><div class='ctx'> </div><div class='add'>+	if (!netif_is_rxfh_configured(dev))</div><div class='add'>+		return 0;</div><div class='add'>+</div><div class='ctx'> 	if (!dev-&gt;ethtool_ops-&gt;get_rxfh_indir_size ||</div><div class='ctx'> 	    !dev-&gt;ethtool_ops-&gt;get_rxfh)</div><div class='del'>-		return -EOPNOTSUPP;</div><div class='add'>+		return 0;</div><div class='ctx'> 	dev_size = dev-&gt;ethtool_ops-&gt;get_rxfh_indir_size(dev);</div><div class='ctx'> 	if (dev_size == 0)</div><div class='del'>-		return -EOPNOTSUPP;</div><div class='add'>+		return 0;</div><div class='ctx'> </div><div class='ctx'> 	rxfh.indir = kcalloc(dev_size, sizeof(rxfh.indir[0]), GFP_USER);</div><div class='ctx'> 	if (!rxfh.indir)</div><div class='del'>-		return -ENOMEM;</div><div class='add'>+		return U32_MAX;</div><div class='ctx'> </div><div class='ctx'> 	ret = dev-&gt;ethtool_ops-&gt;get_rxfh(dev, &amp;rxfh);</div><div class='del'>-	if (ret)</div><div class='del'>-		goto out;</div><div class='add'>+	if (ret) {</div><div class='add'>+		current_max = U32_MAX;</div><div class='add'>+		goto out_free;</div><div class='add'>+	}</div><div class='ctx'> </div><div class='add'>+	current_max = 0;</div><div class='ctx'> 	while (dev_size--)</div><div class='ctx'> 		current_max = max(current_max, rxfh.indir[dev_size]);</div><div class='ctx'> </div><div class='del'>-	*max = current_max;</div><div class='del'>-</div><div class='del'>-out:</div><div class='add'>+out_free:</div><div class='ctx'> 	kfree(rxfh.indir);</div><div class='del'>-	return ret;</div><div class='add'>+	return current_max;</div><div class='ctx'> }</div><div class='ctx'> </div><div class='ctx'> int ethtool_check_ops(const struct ethtool_ops *ops)</div><div class='head'>diff --git a/net/ethtool/common.h b/net/ethtool/common.h<br/>index 28b8aaaf9bcb3c..b55705a9ad5aa0 100644<br/>--- a/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ethtool/common.h?id=7c8267275de6989a9b682a07d75e89395457ee01'>net/ethtool/common.h</a><br/>+++ b/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ethtool/common.h?id=2899d58462ba868287d6ff3acad3675e7adf934f'>net/ethtool/common.h</a></div><div class='hunk'>@@ -42,7 +42,7 @@ int __ethtool_get_link(struct net_device *dev);</div><div class='ctx'> bool convert_legacy_settings_to_link_ksettings(</div><div class='ctx'> 	struct ethtool_link_ksettings *link_ksettings,</div><div class='ctx'> 	const struct ethtool_cmd *legacy_settings);</div><div class='del'>-int ethtool_get_max_rxfh_channel(struct net_device *dev, u32 *max);</div><div class='add'>+u32 ethtool_get_max_rxfh_channel(struct net_device *dev);</div><div class='ctx'> int ethtool_get_max_rxnfc_channel(struct net_device *dev, u64 *max);</div><div class='ctx'> int __ethtool_get_ts_info(struct net_device *dev, struct ethtool_ts_info *info);</div><div class='ctx'> </div><div class='head'>diff --git a/net/ethtool/ioctl.c b/net/ethtool/ioctl.c<br/>index d72b0fec89af6d..615812ff89746f 100644<br/>--- a/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ethtool/ioctl.c?id=7c8267275de6989a9b682a07d75e89395457ee01'>net/ethtool/ioctl.c</a><br/>+++ b/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ethtool/ioctl.c?id=2899d58462ba868287d6ff3acad3675e7adf934f'>net/ethtool/ioctl.c</a></div><div class='hunk'>@@ -2049,9 +2049,7 @@ static noinline_for_stack int ethtool_set_channels(struct net_device *dev,</div><div class='ctx'> 	 * indirection table/rxnfc settings */</div><div class='ctx'> 	if (ethtool_get_max_rxnfc_channel(dev, &amp;max_rxnfc_in_use))</div><div class='ctx'> 		max_rxnfc_in_use = 0;</div><div class='del'>-	if (!netif_is_rxfh_configured(dev) ||</div><div class='del'>-	    ethtool_get_max_rxfh_channel(dev, &amp;max_rxfh_in_use))</div><div class='del'>-		max_rxfh_in_use = 0;</div><div class='add'>+	max_rxfh_in_use = ethtool_get_max_rxfh_channel(dev);</div><div class='ctx'> 	if (channels.combined_count + channels.rx_count &lt;=</div><div class='ctx'> 	    max_t(u64, max_rxnfc_in_use, max_rxfh_in_use))</div><div class='ctx'> 		return -EINVAL;</div></td></tr></table></div> <!-- class=content -->
<div class='footer'>generated by <a href='https://git.zx2c4.com/cgit/about/'>cgit 1.2.3-korg</a> (<a href='https://git-scm.com/'>git 2.43.0</a>) at 2025-01-10 17:15:37 +0000</div>
</div> <!-- id=cgit -->
</body>
</html>
