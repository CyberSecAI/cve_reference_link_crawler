Based on the provided content, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2024-2504

**Root Cause of Vulnerability:**
The vulnerability stems from insufficient input sanitization and output escaping within the Page Builder: Pagelayer plugin for WordPress. Specifically, user-supplied attributes are not properly processed, allowing for the injection of malicious web scripts. The vulnerability exists due to inadequate filtering of the 'attr' parameter.

**Weaknesses/Vulnerabilities Present:**
- Stored Cross-Site Scripting (XSS)
- Improper Neutralization of Input During Web Page Generation

**Impact of Exploitation:**
- Successful exploitation allows an attacker to inject arbitrary web scripts into pages created with the plugin.
- These injected scripts will execute whenever a user accesses the compromised page, potentially leading to:
    - Session hijacking
    - Cookie theft
    - Defacement
    - Redirection to malicious sites
    - Other malicious activities

**Attack Vectors:**
- The primary attack vector is through the 'attr' parameter when creating or editing pages using the Page Builder: Pagelayer plugin. An attacker with sufficient privileges can inject malicious JavaScript code within custom attributes.

**Required Attacker Capabilities/Position:**
- The attacker needs to be an authenticated user on the WordPress site.
- Contributor-level access or higher is required to exploit this vulnerability.
- The attacker must have the ability to create or edit pages using the vulnerable Pagelayer plugin.

**Additional Details:**
- The vulnerability exists in all versions of the Page Builder: Pagelayer plugin up to and including version 1.8.4.
- The fix was implemented in version 1.8.5 which includes a fix to sanitize custom attributes.
- The patch includes adding a list of disallowed attributes and matching them against user-supplied data to prevent XSS attacks. The disallowed attributes are now handled through a preg_match and the check now includes "on" prefix.