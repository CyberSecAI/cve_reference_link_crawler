```text
Root cause of vulnerability:
The vulnerability lies in the `fpm_stdio_child_said` function in `sapi/fpm/fpm/fpm_stdio.c`. This function is responsible for parsing and writing logs from worker processes. The issue stems from an incorrect calculation of the starting position (`start`) when handling the `FPM_STDIO_CMD_FLUSH` macro within the log data. When a partial `FPM_STDIO_CMD_FLUSH` sequence is encountered at the end of a buffer, the `cmd_pos` variable is used to track the number of matched characters. However, upon processing the subsequent buffer, the `start` position is incorrectly set to `cmd_pos` instead of `sizeof(FPM_STDIO_CMD_FLUSH) - cmd_pos`, causing either a partial inclusion of the `FPM_STDIO_CMD_FLUSH` sequence in logs, or a partial omission of the logs. Additionally, when a syslog is configured, null characters within the log message will prematurely terminate the log string due to the use of `strlen`.

Weaknesses/vulnerabilities present:
- Incorrect calculation of the starting position when handling the `FPM_STDIO_CMD_FLUSH` macro.
- Improper handling of null characters within log messages when using syslog.
- Potential log injection and log omission.

Impact of exploitation:
- Log pollution: Attackers can inject up to 4 characters of the `FPM_STDIO_CMD_FLUSH` macro into the logs.
- Log stripping: Attackers can remove up to 4 characters from logs.
- Log truncation: When using syslog, injecting a null character will truncate the log message, potentially omitting important information.
- The integrity of logs can be compromised.

Attack vectors:
The attack vector is local. It involves manipulating the data sent by PHP-FPM worker processes to the master process through the configured logging mechanism.

Required attacker capabilities/position:
- The attacker must have control over the data sent by a PHP-FPM worker process to the master process.
- The attacker requires low privileges.
- The attacker must be able to influence the length and content of worker's output and also insert null characters if a syslog is configured.
```