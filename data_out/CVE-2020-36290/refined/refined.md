- **Root cause of vulnerability:** The Livesearch macro in Confluence Server and Data Center does not properly sanitize user-supplied input when displaying page excerpts, leading to a stored XSS vulnerability.
- **Weaknesses/vulnerabilities present:** Stored Cross-Site Scripting (XSS).
- **Impact of exploitation:** Remote attackers with permission to edit a page or blog can inject arbitrary HTML or JavaScript code, which will be executed in the browsers of users who view the affected page. This can lead to various malicious activities, such as session hijacking, defacement, or unauthorized actions on behalf of the user.
- **Attack vectors:** By editing a Confluence page or blog, an attacker can insert malicious HTML or JavaScript code into the Livesearch macro's input. The malicious code will be stored and executed when other users view the page excerpt.
- **Required attacker capabilities/position:** The attacker needs to have permission to edit a page or blog in the Confluence instance.