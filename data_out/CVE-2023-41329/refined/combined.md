=== Content from wiremock.org_0a49b64d_20250111_180035.html ===


* [Docs](https://wiremock.org/docs)    [WireMock](https://wiremock.org/docs/)    [Mock API Templates](https://wiremock.org/docs/mock-api-templates)    [WireMock Cloud](https://docs.wiremock.io/getting-started/?utm_source=wiremock.org&utm_medium=masthead_doc-links&utm_campaign=2022_baseline)    [External Resources](https://wiremock.org/external-resources)    [WireMock 2.x (Archive)](https://wiremock.org/2.x/docs/)
* [Need Help?](https://wiremock.org/support)    [Q&A on Slack](https://slack.wiremock.org/)    [StackOverflow](https://stackoverflow.com/questions/tagged/wiremock)    [Commercial Options](https://wiremock.org/support/commercial)
* [Participate](https://wiremock.org/participate)    [Community Slack](https://slack.wiremock.org/)    [Contributor Guide](https://github.com/wiremock/community/blob/main/contributing/README.md)    [Our GitHub](https://github.com/wiremock/)    [This Website](https://github.com/wiremock/wiremock.org)    [Code of Conduct](https://github.com/wiremock/.github/blob/main/CODE_OF_CONDUCT.md)
* [Resources](https://wiremock.org/external-resources)    [Mock API Templates Library](https://library.wiremock.org/)    [WireMock Ecosystem](https://github.com/wiremock/ecosystem)    [Twitter](https://twitter.com/wiremockorg)    [Mastodon](https://fosstodon.org/%40wiremock)    [Slack Archive](https://community.wiremock.io/)    [External Resources](https://wiremock.org/external-resources)
  [Try WireMock Cloud](https://wiremock.io/product?utm_source=wiremock.org&utm_medium=masthead&utm_campaign=homepage_2022_baseline "WireMock Cloud")  Free forever. No credit card needed ![](https://wiremock.org/images/hamburgerMenuIcon.svg)  ![](https://wiremock.org/images/closeMenuIcon.svg)

* [Try WireMock Cloud](https://wiremock.io?utm_source=wiremock.org&utm_medium=masthead&utm_campaign=homepage_2022_baseline "WireMock Cloud")
* [Docs](https://wiremock.org/docs)
* [Need Help?](https://wiremock.org/support)
* [Participate](https://wiremock.org/participate)
* [Resources](https://wiremock.org/external-resources)
  [![Slack logo](https://wiremock.org/images/slack-logo-medium.png) Need help?](https://slack.wiremock.org/)

* [Getting started](https://wiremock.org/docs/overview)
  + [Overview](https://wiremock.org/docs/overview/)
  + [Quick Start: API Mocking with Java and JUnit 4](https://wiremock.org/docs/quickstart/java-junit/)
  + [Download and Installation](https://wiremock.org/docs/download-and-installation/)
  + [WireMock Tutorials](https://wiremock.org/docs/getting-started/)
  + [Frequently Asked Questions](https://wiremock.org/docs/faq/)
* [WireMock Standalone](https://wiremock.org/docs/standalone)
  + [Running in Docker](https://wiremock.org/docs/standalone/docker/)
  + [Running as a Standalone Process](https://wiremock.org/docs/standalone/java-jar/)
  + [Administration API](https://wiremock.org/docs/standalone/administration/)
* [Java Usage](https://wiremock.org/docs/solutions/jvm/)
  + [JUnit 5+ Jupiter](https://wiremock.org/docs/junit-jupiter/)
  + [JUnit 4 and Vintage](https://wiremock.org/docs/junit-extensions/)
  + [Plain Java](https://wiremock.org/docs/java-usage/)
  + [Java configuration](https://wiremock.org/docs/configuration/)
  + [Running without the HTTP Server](https://wiremock.org/docs/running-without-http-server/)
  + [Using WireMock with Jetty 12](https://wiremock.org/docs/jetty-12/)
* [Stubbing & Verifying](https://wiremock.org/docs/stubbing)
  + [Stubbing](https://wiremock.org/docs/stubbing/)
  + [Request Matching](https://wiremock.org/docs/request-matching/)
  + [Response Templating](https://wiremock.org/docs/response-templating/)
  + [Simulating Faults](https://wiremock.org/docs/simulating-faults/)
  + [Stateful Behaviour](https://wiremock.org/docs/stateful-behaviour/)
  + [Proxying](https://wiremock.org/docs/proxying/)
  + [Verifying](https://wiremock.org/docs/verifying/)
* [Mock API Template Library](https://wiremock.org/docs/mock-api-templates)
  + [WireMock API Templates Library](https://wiremock.org/docs/mock-api-templates/)
  + [Using Mock API Templates](https://wiremock.org/docs/mock-api-templates/usage/)
* [Record & Playback](https://wiremock.org/docs/record-playback/)
  + [Record and Playback](https://wiremock.org/docs/record-playback/)
* Protocols
  + [Webhooks and Callbacks](https://wiremock.org/docs/webhooks-and-callbacks/)
  + [Mocking gRPC services](https://wiremock.org/docs/grpc/)
  + [WireMock and GraphQL](https://wiremock.org/docs/solutions/graphql/)
  + [JSON Web Tokens (JWT)](https://wiremock.org/docs/jwt/)
  + [Serving HTTPS](https://wiremock.org/docs/https/)
* Integrations
  + [WireMock Spring Boot Integration](https://wiremock.org/docs/spring-boot/)
* Advanced use-cases
  + [Multi-domain Mocking](https://wiremock.org/docs/multi-domain-mocking/)
  + [Deploying into a servlet container](https://wiremock.org/docs/advanced/deploy-to-servlet-container/)
  + [WireMock on Java 1.7](https://wiremock.org/docs/advanced/java7/)
* [Extensibility](https://wiremock.org/docs/extending-wiremock/)
  + [Extending WireMock](https://wiremock.org/docs/extending-wiremock/)
  + [Filtering and Modifying Requests](https://wiremock.org/docs/extensibility/filtering-requests/)
  + [Transforming Responses](https://wiremock.org/docs/extensibility/transforming-responses/)
  + [Custom Matching](https://wiremock.org/docs/extensibility/custom-matching/)
  + [Listening for Serve Events](https://wiremock.org/docs/extensibility/listening-for-serve-events/)
  + [Admin API Extensions](https://wiremock.org/docs/extensibility/extending-the-admin-api/)
  + [Adding Template Helpers](https://wiremock.org/docs/extensibility/adding-template-helpers/)
  + [Adding Template Model Data](https://wiremock.org/docs/extensibility/adding-template-model-data/)
  + [Listening for Stub Changes](https://wiremock.org/docs/extensibility/listening-for-stub-changes/)
  + [Listening for Settings Changes](https://wiremock.org/docs/extensibility/listening-for-settings-changes/)
  + [Mappings Loader Extensions](https://wiremock.org/docs/extensibility/adding-mappings-loader/)
  + [Stub Metadata](https://wiremock.org/docs/stub-metadata/)
* Reference
  + [Admin API](https://wiremock.org/docs/standalone/admin-api-reference/)
  + [WireMock API Templates Library](https://wiremock.org/docs/mock-api-templates/)

1. [![](/images/logos/doc-sections/home.svg)](/)
2. [Documentation](/docs/)
3. Java configuration
# Java configuration

 [Centralize and scale your API mocks with WireMock Cloud.](https://www.wiremock.io?utm_source=oss-docs&utm_medium=oss-docs&utm_campaign=cloud-callouts-configuration&utm_id=cloud-callouts&utm_term=cloud-callouts-configuration)

Both `WireMockServer` and the `WireMockRule` take a configuration builder as the parameter to their constructor e.g.

```
import static com.github.tomakehurst.wiremock.core.WireMockConfiguration.options;

WireMockServer wm = new WireMockServer(options().port(2345));

@Rule
WireMockRule wm = new WireMockRule(options().port(2345));

```

Every option has a sensible default, so only options that you require an override for should be specified.

## Network ports and binding [#](#network-ports-and-binding)

```
// Statically set the HTTP port number. Defaults to 8080.
.port(8000)

// Statically set the HTTPS port number. Defaults to 8443.
.httpsPort(8001)

// Randomly assign the HTTP port on startup
.dynamicPort()

// Randomly asssign the HTTPS port on startup
.dynamicHttpsPort()

// Bind the WireMock server to this IP address locally. Defaults to the loopback adaptor.
.bindAddress("192.168.1.111")

```
## Jetty configuration [#](#jetty-configuration)

Typically it is only necessary to tweak these settings if you are doing performance testing under significant loads.

```
// Set the number of request handling threads in Jetty. Defaults to 10.
.containerThreads(5)

// Set the number of connection acceptor threads in Jetty. Defaults to 2.
.jettyAcceptors(4)

// Set the Jetty accept queue size. Defaults to Jetty's default of unbounded.
.jettyAcceptQueueSize(100)

 // Set the size of Jetty's header buffer (to avoid exceptions when very large request headers are sent). Defaults to 8192.
.jettyHeaderBufferSize(16834)

// Enable asynchronous request processing in Jetty. Recommended when using WireMock for performance testing with delays, as it allows much more efficient use of container threads and therefore higher throughput. Defaults to false.
.asynchronousResponseEnabled(true)

// Set the number of asynchronous response threads. Effective only with asynchronousResponseEnabled=true. Defaults to 10.
.asynchronousResponseThreads(10)

```
## HTTPS configuration [#](#https-configuration)

WireMock can accept HTTPS connections from clients, require a client to present a certificate for authentication, and pass a client certificate on to another service when proxying.

```
// Set the keystore containing the HTTPS certificate
.keystorePath("/path/to/https-certs-keystore.jks")

// Set the password to the keystore. Note: the behaviour of this changed in version 2.27.0.
// Previously this set Jetty's key manager password, whereas now it sets the keystore password value.
.keystorePassword("verysecret!")

// Set the password to the Jetty's key manager. Note: added in version 2.27.0.
.keyManagerPassword("donttell")

// Set the keystore type
.keystoreType("BKS")

// Require a client calling WireMock to present a client certificate
.needClientAuth(true)

// Path to the trust store containing the client certificate required in by the previous parameter
.trustStorePath("/path/to/trust-store.jks")

// The password to the trust store
.trustStorePassword("trustme")

```

WireMock uses the trust store for three purposes:

1. As a server, when requiring client auth, WireMock will trust the client if it presents a public certificate in this trust store
2. As a proxy, WireMock will use the private key & certificate in this key store to authenticate its http client with target servers that require client auth
3. As a proxy, WireMock will trust a target server if it presents a public certificate in this trust store

## HTTP/2 configuration [#](#http2-configuration)

HTTP/2 can be disabled separately for plain text (HTTP) and TLS (HTTPS):

```
// Disable HTTP/2 over HTTP
.http2PlainDisabled(true);

// Disable HTTP/2 over HTTPS
.http2TlsDisabled(true);

```
## Proxy settings [#](#proxy-settings)

```
// Set the timeout for requests to the proxy in milliseconds
.proxyTimeout(5000)

// Make WireMock behave as a forward proxy e.g. via browser proxy settings
.enableBrowserProxying(true)

// Send the Host header in the original request onwards to the system being proxied to
.preserveHostHeader(false)

// As of WireMock `3.7.0`, when in proxy mode, this option will transfer the original `User-Agent` header from the client to the proxied service.
.preserveUserAgentProxyHeader(true)

 // Override the Host header sent when reverse proxying to another system (this and the previous parameter are mutually exclusive)
.proxyHostHeader("my.otherdomain.com")

 // When reverse proxying, also route via the specified forward proxy (useful inside corporate firewalls)
.proxyVia("my.corporate.proxy", 8080)

// When proxying, path to a security store containing client private keys and trusted public certificates for communicating with a target server
.trustStorePath("/path/to/trust-store.jks")

// The password to the trust store
.trustStorePassword("trustme")

// When proxying, a key store containing a root Certificate Authority private key and certificate that can be used to sign generated certificates
.caKeystorePath("/path/to/ca-key-store.jks")

// The password to the CA key store
.caKeystorePassword("trustme")

// The type of the CA key store
.caKeystoreType("JKS")

// Which proxy encodings to proxy through to the target if the request contains an Accept-Encoding header
// By default this is null, which means the header is sent to the target unchanged
// If there is an Accept-Encoding header on the request, and it does not contain any of the supported proxy encodings, the header is not sent to the target.
.withSupportedProxyEncodings("gzip", "deflate")

```
## File locations [#](#file-locations)

WireMock, when started programmatically, will default to `src/test/resources` as a filesystem root if not configured otherwise.

```
// Set the root of the filesystem WireMock will look under for files and mappings
.usingFilesUnderDirectory("/path/to/files-and-mappings-root")

// Set a path within the classpath as the filesystem root
.usingFilesUnderClasspath("root/path/under/classpath")

```
## Request journal [#](#request-journal)

The request journal records requests received by WireMock. It is required by the verification features, so these will throw errors if it is disabled.

```
// Do not record received requests. Typically needed during load testing to avoid JVM heap exhaustion.
.disableRequestJournal()

// Limit the size of the request log (for the same reason as above).
.maxRequestJournalEntries(Optional.of(100))

```
## Template Cache [#](#template-cache)

When response templating is enabled, compiled template fragments are cached to improve performance. This setting allows you to configure the maximum number of entries to allow in the cache. As of WireMock `3.7.0`, this defaults to 1000 cache entries. Before WireMock `3.7.0` the default was unlimited

```
.withMaxTemplateCacheEntries(100)

```
## Notification (logging) [#](#notification-logging)

WireMock wraps all logging in its own `Notifier` interface. It ships with no-op, Slf4j and console (stdout) implementations.

```
// Provide an alternative notifier. The default logs to slf4j.
.notifier(new ConsoleNotifier(true))

```
## Gzip [#](#gzip)

Gzipping of responses can be disabled.

```
.gzipDisabled(true)

```
## Extensions [#](#extensions)

For details see [Extending WireMock](../extending-wiremock/).

```
// Add extensions
.extensions("com.mycorp.ExtensionOne", "com.mycorp.ExtensionTwo")

```
## Transfer encoding [#](#transfer-encoding)

By default WireMock will send all responses chunk encoded, meaning with a `Transfer-Encoding: chunked` header present and no `Content-Length` header.

This behaviour can be modified by setting a chunked encoding policy e.g.

```
.useChunkedTransferEncoding(Options.ChunkedEncodingPolicy.BODY_FILE)

```

Valid values are:

* `NEVER` - Never use chunked encoding. Warning: this will buffer all response bodies in order to calculate the size. This might put a lot of strain on the garbage collector if you’re using large response bodies.
* `BODY_FILE` - Use chunked encoding for body files but calculate a `Content-Length` for directly configured bodies.
* `ALWAYS` - Always use chunk encoding - the default.

## Cross-origin response headers (CORS) [#](#cross-origin-response-headers-cors)

WireMock always sends CORS headers with admin API responses, but not by default with stub responses. To enable automatic sending of CORS headers on stub responses, do the following:

```
.stubCorsEnabled(true)

```
## Limiting logged response body size [#](#limiting-logged-response-body-size)

By default, response bodies will be recorded in the journal in their entirety. This can result in out of memory errors when very large bodies are served so WireMock provides an option to limit the number of bytes of response bodies retained (truncating any that are larger).

```
.maxLoggedResponseSize(100000) // bytes

```
## Preventing proxying to and recording from specific target addresses [#](#preventing-proxying-to-and-recording-from-specific-target-addresses)

As a security measure WireMock can be configured to only permit proxying (and therefore recording) to certain addresses. This is achieved via a list of allowed address rules and a list of denied address rules, where the allowed list is evaluated first.

Each rule can be one of the following:

* A single IP address
* An IP address range in the e.g. `10.1.1.1-10.2.2.2`
* A hostname wildcard e.g. `dev-*.example.com`

The ruleset is built and applied as follows:

```
.limitProxyTargets(NetworkAddressRules.builder()
  .allow("192.168.56.42")
  .allow("192.0.1.1-192.168.254.1")
  .deny("*.acme.com")
  .build()
)

```
## Filename template [#](#filename-template)

WireMock can set up specific filename template format based on stub information. The main rule for set up specify stub metadata information in handlebar format. For instance for endpoint `PUT /hosts/{id}` and format `}-}.json` will be generated: `put-hosts-id.json` filename. Default template: `}-}-}.json`.

```
.filenameTemplate("}-}.json")

```

Note: starting from [3.0.0-beta-8](https://github.com/wiremock/wiremock/releases/tag/3.0.0-beta-8)

## Listening for raw traffic [#](#listening-for-raw-traffic)

If you would like to observe raw HTTP traffic to and from Jetty for debugging purposes you can use a `WiremockNetworkTrafficListener`.

One scenario where it can be useful is where Jetty alters the response from Wiremock before sending it to the client. (An example of that is where Jetty appends a –gzip postfix to the ETag response header if the response is gzipped.) Using WireMock’s request listener extension points in this case would not show those alterations.

To output all raw traffic to console use `ConsoleNotifyingWiremockNetworkTrafficListener`, for example:

```
.networkTrafficListener(new ConsoleNotifyingWiremockNetworkTrafficListener()));

```

If you would like to collect the traffic and for example add it to your acceptance test’s output, you can use the `CollectingNetworkTrafficListener`.

## HTTP Client [#](#http-client)

If you want to increase the proxying performance of wiremock you can enable Connection reuse and increse max Connections

```
// Maximum connections for Http Client
.maxHttpClientConnections(1000);
//Disable http connection reuse, `false` to enable
.disableConnectionReuse(true)

```
  [![](/images/logos/doc-sections/edit.svg) Improve this page](https://github.com/wiremock/wiremock.org/edit/main/_docs/configuration.md)   [![](/images/logos/doc-sections/bug.svg) Report an issue](https://github.com/wiremock/wiremock.org/issues/new?labels=bug&template=3-bug.yml&page=/docs/configuration/&title=Issue on Java configuration)   [![](/images/logos/doc-sections/slack.svg) Ask on Slack](http://slack.wiremock.org/)    ![](https://wiremock.org/images/shortLogo.png) © 2025

* [![](https://wiremock.org/images/githubIcon.svg)](http://github.com/wiremock)


=== Content from github.com_2cb191b6_20250111_180035.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwiremock%2Fwiremock%2Fsecurity%2Fadvisories%2FGHSA-pmxq-pj47-j8j4)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwiremock%2Fwiremock%2Fsecurity%2Fadvisories%2FGHSA-pmxq-pj47-j8j4)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=wiremock%2Fwiremock)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[wiremock](/wiremock)
/
**[wiremock](/wiremock/wiremock)**
Public

* [Notifications](/login?return_to=%2Fwiremock%2Fwiremock) You must be signed in to change notification settings
* [Fork
  1.4k](/login?return_to=%2Fwiremock%2Fwiremock)
* [Star
   6.4k](/login?return_to=%2Fwiremock%2Fwiremock)

* [Code](/wiremock/wiremock)
* [Issues
  388](/wiremock/wiremock/issues)
* [Pull requests
  49](/wiremock/wiremock/pulls)
* [Actions](/wiremock/wiremock/actions)
* [Projects
  3](/wiremock/wiremock/projects)
* [Security](/wiremock/wiremock/security)
* [Insights](/wiremock/wiremock/pulse)

Additional navigation options

* [Code](/wiremock/wiremock)
* [Issues](/wiremock/wiremock/issues)
* [Pull requests](/wiremock/wiremock/pulls)
* [Actions](/wiremock/wiremock/actions)
* [Projects](/wiremock/wiremock/projects)
* [Security](/wiremock/wiremock/security)
* [Insights](/wiremock/wiremock/pulse)

# Domain restrictions bypass via DNS Rebinding in WireMock and WireMock Studio webhooks, proxy and recorder modes

Low

[oleg-nenashev](/oleg-nenashev)
published
GHSA-pmxq-pj47-j8j4
Sep 6, 2023

## Package

maven

com.tomakehurst.wiremock:wiremock-jre8
([Maven](/advisories?query=ecosystem%3Amaven))

## Affected versions

< 2.35.1

## Patched versions

2.35.1

maven

com.tomakehurst.wiremock:wiremock-jre8-standalone
([Maven](/advisories?query=ecosystem%3Amaven))

< 2.35.1

2.35.1

maven

org.wiremock:wiremock
([Maven](/advisories?query=ecosystem%3Amaven))

< 3.0.3

3.0.3

maven

org.wiremock:wiremock-standalone
([Maven](/advisories?query=ecosystem%3Amaven))

< 3.0.3

3.0.3

pip

wiremock
([pip](/advisories?query=ecosystem%3Apip))

<2.6.1

2.6.1

docker

wiremock-studio
([Docker](/advisories?query=ecosystem%3Adocker))

2.32.0-17 and before

None

maven

wiremock-studio
([Maven](/advisories?query=ecosystem%3Amaven))

2.32.0-17 and before

None

docker

wiremock/wiremock
([Docker](/advisories?query=ecosystem%3Adocker))

2.x < 2.35.1-1, 3.x < 3.0.3-1

2.35.1-1, 3.0.3-1

## Description

### Impact

The proxy mode of WireMock, can be protected by the network restrictions configuration, as documented in [Preventing proxying to and recording from specific target addresses](https://wiremock.org/docs/configuration/#preventing-proxying-to-and-recording-from-specific-target-addresses). These restrictions can be configured using the domain names, and in such a case the configuration is vulnerable to the DNS rebinding attacks. A similar patch was applied in WireMock 3.0.0-beta-15 for the WireMock Webhook Extensions.

The root cause of the attack is a defect in the logic which allows for a race condition triggered by a DNS server whose address expires in between the initial validation and the outbound network request that might go to a domain that was supposed to be prohibited. Control over a DNS service is required to exploit this attack, so it has high execution complexity and limited impact.

### Affected versions

* WireMock 3,x until 3.0.3 (security patch), on default settings in environments with access to the network
* WireMock 2.x until 2.35.1 (security patch), on default settings in environments with access to the network
* Python WireMock until 2.6.1
* WireMock Studio - all versions, this proprietary product was discontinued in 2022

### Patches

* WireMock 3.0.3 + the 3.0.3-1 Docker image
* WireMock 2.35.1 + the 2.35.1-1 Docker image - backport to WireMock 2.x
* Python WireMock 2.6.1

### Workarounds

For WireMock:

* Option 1: Configure WireMock to use IP addresses instead of the domain names in the outbound URLs subject to DNS rebinding
* Option 2: Use external firewall rules to define the list of permitted destinations

For WireMock Studio: N/A. Switch to another distribution, there will be no fix provided. The vendor of former WireMock Studio recommends migration to [WireMock Cloud](https://www.wiremock.io/product)

### References

* [CVE-2023-41327](https://github.com/advisories/GHSA-hq8w-9w8w-pmx7 "CVE-2023-41327") - Related issue in the WireMock Webhooks Extension

### Severity

Low

3.9

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Adjacent

Attack complexity
High

Privileges required
High

User interaction
None

Scope
Unchanged

Confidentiality
Low

Integrity
Low

Availability
Low

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:A/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L

### CVE ID

CVE-2023-41329

### Weaknesses

[CWE-350](/advisories?query=cwe%3A350)

### Credits

* [![@W0rty](https://avatars.githubusercontent.com/u/63255997?s=40&v=4)](/W0rty)
  [W0rty](/W0rty)
  Reporter
* [![@numacanedo](https://avatars.githubusercontent.com/u/7563618?s=40&v=4)](/numacanedo)
  [numacanedo](/numacanedo)
  Finder
* [![@tomakehurst](https://avatars.githubusercontent.com/u/707169?s=40&v=4)](/tomakehurst)
  [tomakehurst](/tomakehurst)
  Remediation developer
* [![@Mahoney](https://avatars.githubusercontent.com/u/168448?s=40&v=4)](/Mahoney)
  [Mahoney](/Mahoney)
  Remediation developer
* [![@oleg-nenashev](https://avatars.githubusercontent.com/u/3000480?s=40&v=4)](/oleg-nenashev)
  [oleg-nenashev](/oleg-nenashev)
  Coordinator

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


