![Header banner](https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/660fca2e289a20ba0137147b_Research.webp)![Header banner](https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/660fca2e8e27621fab7d4c8a_Research%20(1).webp)[![Binarly logo with text 'Binarly'
](https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/660d4f979dbb18c2088ddda1_Group354.svg)](/)

* [Home](/)
* PlatformPlatform[Features](/features)[Packages](/packages)[Customers](/customers)
* REsearchREsearch[Advisories](/advisories)[All REsearch](/articles)[PKfail](/pkfail)[Lighttpd](/lighttpd)[XZ Backdoor](/blog/xz-utils-supply-chain-puzzle-binarly-ships-free-scanner-for-cve-2024-3094-backdoor)[LogoFAIL](/logofail)
* LearnLearn[All Resources](/learn)[Product Blog](/blog)[Videos](/video)[Free Detection Tools](/free-tools)[Reports](/reports)
* CompanyCompany[About Binarly](/about)[News](/news)[Press](/press)
* [Free scan](https://risk.binarly.io/)
* [Book a demo](/book-a-demo-old)
[Free scan](https://risk.binarly.io/)[Book a demo](/book-a-demo)Advisory ID:BRLY-2022-023
# [BRLY-2022-023] SMM memory corruption vulnerability in Software SMI handler

September 21, 2022Severity:HighCVSS Score8.2Public Disclosure Date:September 21, 2022CVE ID:

[CVE-2022-36448](https://nvd.nist.gov/vuln/detail/CVE-2022-36448)

## Summary

Binarly REsearch Team has discovered a SMM memory corruption vulnerability allowing a possible attacker to write fixed or predictable data to SMRAM. Exploiting this issue could lead to escalating privileges to SMM.![Vendors Affected Icon](https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/6698dd226326f191c074ad7b_Vendors.svg)
### Vendors Affected

FrameworkInsyde[Framework](/advisory-vendor/framework),[Insyde](/advisory-vendor/insyde),![Affected Products icon](https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/6698dd3fad8b6d927d1b45c4_Affected%20products.svg)
### Affected Products

No items found.
## Potential Impact

An attacker can exploit this vulnerability to elevate privileges from ring 0 to ring -2, execute arbitrary code in System Management Mode - an environment more privileged than operating system (OS) and completely isolated from it. Running arbitrary code in the SMM additionally bypasses SMM-based SPI flash protections against modifications, which can help an attacker to install a firmware backdoor/implant into the BIOS. Such a malicious firmware code in the BIOS could persist across operating system re-installs. Additionally, this vulnerability potentially could be used by threat actors to bypass security mechanisms provided by the UEFI firmware (for example, Secure Boot and some types of memory isolation for hypervisors).

## Summary

**Binarly REsearch Team** has discovered a SMM memory corruption vulnerability allowing a possible attacker to write fixed or predictable data to SMRAM. Exploiting this issue could lead to escalating privileges to SMM.

## Vulnerability Information

* BINARLY internal vulnerability identifier: BRLY-2022-023
* Insyde PSIRT assigned CVE identifier: CVE-2022-36448
* FwHunt rule: [BRLY-2022-023](https://github.com/binarly-io/FwHunt/blob/main/rules/Vulnerabilities/Insyde/BRLY-2022-023.yml)
* CVSS v3.1 8.2 High AV:L/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H

## Affected firmwares with confirmed impact by Binarly REsearch Team

| Fimware | Module name | Module SHA256 | File GUID |
| --- | --- | --- | --- |
| Framework\_Laptop\_12th\_Gen\_Intel\_Core\_capsule\_EFI\_signed\_allsku\_3.01.bin | PnpSmm | 26939c77c4803ba2589975403d41fc1ddc8d1ecf23e207a4dadba3038b6c6664 | cc1baa36-11eb-45cc-9adc-7565e273ac70 |

## Potential impact

An attacker can exploit this vulnerability to elevate privileges from ring 0 to ring -2, execute arbitrary code in System Management Mode - an environment more privileged than operating system (OS) and completely isolated from it. Running arbitrary code in the SMM additionally bypasses SMM-based SPI flash protections against modifications, which can help an attacker to install a firmware backdoor/implant into the BIOS. Such a malicious firmware code in the BIOS could persist across operating system re-installs. Additionally, this vulnerability potentially could be used by threat actors to bypass security mechanisms provided by the UEFI firmware (for example, Secure Boot and some types of memory isolation for hypervisors).

## Vulnerability description

The vulnerability exists in the Software SMI handler (`SwSmiInputValue = 0x47`) located at offset `0x3690` in the module.The pseudocode of the vulnerable handler is shown below:

```
EFI_STATUS __fastcall SwSmiHandler(
        EFI_HANDLE DispatchHandle,
        const void *Context,
        void *CommBuffer,
        UINTN *CommBufferSize)
{
  __int64 Ptr;
  __int16 Index;
  __int16 ResValue;
  UINTN Val;
  __int64 IhisiParamBufferValue;

  if ( ToGetIhisiParamBufferVar(&IhisiParamBufferValue, &Val, CommBuffer) >= EFI_SUCCESS )
  {
    Ptr = IhisiParamBufferValue;
    if ( *(IhisiParamBufferValue + 16) == 'BSI$' )
    {
      Index = *(*(IhisiParamBufferValue + 0x28) + 6);
      if ( (Index & 0xFFF8) == 80 )             // Index: 80, 81, 82, 83, 84, 85, 86, 87
        ResValue = (gFuncsTable[Index & 7])(*(IhisiParamBufferValue + 0x28));
      else
        ResValue = 0x82;
      *(Ptr + 8) = ResValue;
    }
  }
  return 0;
}
```

`IhisiParamBufferValue` will contain the NVRAM variable value:\* name: `IhisiParamBuffer`\* GUID: `92e59835-5f42-4e0b-9a84-47c7810ea806`\* DataSize: `8`

The `IhisiParamBuffer` variable contains an address that is not checked (except for the check for signature located at `IhisiParamBufferValue + 16`).

As you can see from the pseudocode, a predictable value can be written by address `IhisiParamBufferValue + 8`.This can lead to DOS or execution of arbitrary code in SMM.

## Disclosure timeline

This bug is subject to a 90 day disclosure deadline. After 90 days elapsed or a patch has been made broadly available (whichever is earlier), the bug report will become visible to the public.

| Disclosure Activity | Date |
| --- | --- |
| Framework PSIRT is notified | 2022-06-27 |
| Insyde PSIRT confirmed reported issue | 2022-07-19 |
| Insyde PSIRT assigned CVE number | 2022-07-25 |
| BINARLY public disclosure date | 2022-09-21 |

## Acknowledgements

**Binarly REsearch Team**

TagsSMM![](https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/65faef3e5a64d8387dca69cd_Group%204845.svg)
#### Related Advisories

No items found.![](https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/65faef3e5a64d8387dca69cd_Group%204845.svg)FWHuntSee if you are impacted now with our Firmware Vulnerability Scanner[Scan now![Arrow indicating link](https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/65f86908fed31c26610fe934_Group%20381.svg)](https://fwhunt.run/)![](https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/65f8528901f2494591983c76_Mask%20Group%20148%20(1).svg)[![Binarly logo with text 'Binarly'
](https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/660d4f979dbb18c2088ddda1_Group354.svg)](/)[![X logo](https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/6601b9591b951116fb5f47de_Subtraction%205.svg)](https://twitter.com/binarly_io?lang=en)[![linkedin logo](https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/6601b958f35f981e228095d6_Subtraction%204.svg)](https://www.linkedin.com/company/binarlyinc/)[![github logo](https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/6601b959b5a62bb6adb058a5_github-mark-white.svg)](https://github.com/binarly-io)[![youtube logo](https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/6601b95946e1fd610eef4f94_Subtraction%203.svg)](https://www.youtube.com/channel/UCpJ_uhTb4_NNoq3-02QfOsA)

* ###### Platform

  + [Features](/features)
  + [Packages](/packages)
  + [Customers](/customers)
* ###### REsearch

  + [Advisories](/advisories)
  + [All REsearch](/articles)
  + [PKfail](/pkfail)
  + [Lighttpd](/lighttpd)
  + [XZ Backdoor](/blog/xz-utils-supply-chain-puzzle-binarly-ships-free-scanner-for-cve-2024-3094-backdoor)
  + [LogoFAIL](/logofail)
* ###### Learn

  + [All Resources](/learn)
  + [Product Blog](/blog)
  + [Videos](/video)
  + [Free Detection Tools](/free-tools)
  + [Reports](/reports)
* ###### Company

  + [About Binarly](/about)
  + [News](/news)
  + [Press](/press)

* Copyright Â© 2024
* [Terms of use](/terms-of-use)
* [Cookie Policy](/cookie-policy)
* [Privacy Policy](/privacy-policy)
* [CCPA Privacy Notice](/ccpa-privacy-notice)
* [Security Commitments](/organizational-security)
[![Binarly logo with text 'Binarly'
](https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/660d4f979dbb18c2088ddda1_Group354.svg)](/)[![X logo](https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/6601b9591b951116fb5f47de_Subtraction%205.svg)](https://twitter.com/binarly_io?lang=en)[![linkedin logo](https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/6601b958f35f981e228095d6_Subtraction%204.svg)](https://www.linkedin.com/company/binarlyinc/)[![github logo](https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/6601b959b5a62bb6adb058a5_github-mark-white.svg)](https://github.com/binarly-io)[![youtube logo](https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/6601b95946e1fd610eef4f94_Subtraction%203.svg)](https://www.youtube.com/channel/UCpJ_uhTb4_NNoq3-02QfOsA)

* ###### Platform

  + Features
  + Packages
  + Customers
* ###### REsearch

  + Advisories
  + All REsearch
  + PKfail
  + Lighttpd
  + XZ Backdoor
  + LogoFAIL
* ###### Learn

  + All Resources
  + Product Blog
  + Videos
  + Free Detection Tools
  + Reports
* ###### Company

  + About Binarly
  + News
  + Press

* [Capabilities](/features)
* [Packages](/packages)
* [Customers](/customers)

* [REsearch](/articles)
* [Advisories](/advisories)
* [Free Tools](/free-tools)

* [About](/about)
* [News](/news)
* [Press](/press)

Copyright Â© 2024Â Â |Â Â [Terms of use](/terms-of-use)Â Â |Â Â [Cookie Policy](/cookie-policy)Â Â | [Privacy Policy](/privacy-policy)Â Â |Â Â [CCPA Privacy Notice](/ccpa-privacy-notice)

