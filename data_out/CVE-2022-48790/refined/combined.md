=== Content from git.kernel.org_f9152004_20250111_032820.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=70356b756a58704e5c8818cb09da5854af87e765)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=70356b756a58704e5c8818cb09da5854af87e765)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=70356b756a58704e5c8818cb09da5854af87e765)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=70356b756a58704e5c8818cb09da5854af87e765)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Sagi Grimberg <sagi@grimberg.me> | 2022-02-01 14:54:19 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2022-02-23 11:59:55 +0100 |
| commit | [70356b756a58704e5c8818cb09da5854af87e765](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=70356b756a58704e5c8818cb09da5854af87e765) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=70356b756a58704e5c8818cb09da5854af87e765)) | |
| tree | [c99df415ed06e3dae2fe615d955d1c134558d2ae](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=70356b756a58704e5c8818cb09da5854af87e765) | |
| parent | [89d2bd13252aaf905be73444d395ba25f9ac1e87](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=89d2bd13252aaf905be73444d395ba25f9ac1e87) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=70356b756a58704e5c8818cb09da5854af87e765&id2=89d2bd13252aaf905be73444d395ba25f9ac1e87)) | |
| download | [linux-70356b756a58704e5c8818cb09da5854af87e765.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-70356b756a58704e5c8818cb09da5854af87e765.tar.gz) | |

nvme: fix a possible use-after-free in controller reset during load[ Upstream commit 0fa0f99fc84e41057cbdd2efbfe91c6b2f47dd9d ]
Unlike .queue\_rq, in .submit\_async\_event drivers may not check the ctrl
readiness for AER submission. This may lead to a use-after-free
condition that was observed with nvme-tcp.
The race condition may happen in the following scenario:
1. driver executes its reset\_ctrl\_work
2. -> nvme\_stop\_ctrl - flushes ctrl async\_event\_work
3. ctrl sends AEN which is received by the host, which in turn
schedules AEN handling
4. teardown admin queue (which releases the queue socket)
5. AEN processed, submits another AER, calling the driver to submit
6. driver attempts to send the cmd
==> use-after-free
In order to fix that, add ctrl state check to validate the ctrl
is actually able to accept the AER submission.
This addresses the above race in controller resets because the driver
during teardown should:
1. change ctrl state to RESETTING
2. flush async\_event\_work (as well as other async work elements)
So after 1,2, any other AER command will find the
ctrl state to be RESETTING and bail out without submitting the AER.
Signed-off-by: Sagi Grimberg <sagi@grimberg.me>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=70356b756a58704e5c8818cb09da5854af87e765)

| -rw-r--r-- | [drivers/nvme/host/core.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/nvme/host/core.c?id=70356b756a58704e5c8818cb09da5854af87e765) | 9 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 8 insertions, 1 deletions

| diff --git a/drivers/nvme/host/core.c b/drivers/nvme/host/core.cindex a5b5a2305791db..6a9a42809f972a 100644--- a/[drivers/nvme/host/core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/nvme/host/core.c?id=89d2bd13252aaf905be73444d395ba25f9ac1e87)+++ b/[drivers/nvme/host/core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/nvme/host/core.c?id=70356b756a58704e5c8818cb09da5854af87e765)@@ -3896,7 +3896,14 @@ static void nvme\_async\_event\_work(struct work\_struct \*work) container\_of(work, struct nvme\_ctrl, async\_event\_work);  nvme\_aen\_uevent(ctrl);- ctrl->ops->submit\_async\_event(ctrl);++ /\*+ \* The transport drivers must guarantee AER submission here is safe by+ \* flushing ctrl async\_event\_work after changing the controller state+ \* from LIVE and before freeing the admin queue.+ \*/+ if (ctrl->state == NVME\_CTRL\_LIVE)+ ctrl->ops->submit\_async\_event(ctrl); }  static bool nvme\_ctrl\_pp\_status(struct nvme\_ctrl \*ctrl) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 03:26:57 +0000



=== Content from git.kernel.org_8a617edf_20250111_032818.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=0ead57ceb21bbf15963b4874c2ac67143455382f)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=0ead57ceb21bbf15963b4874c2ac67143455382f)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0ead57ceb21bbf15963b4874c2ac67143455382f)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=0ead57ceb21bbf15963b4874c2ac67143455382f)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Sagi Grimberg <sagi@grimberg.me> | 2022-02-01 14:54:19 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2022-02-23 12:00:59 +0100 |
| commit | [0ead57ceb21bbf15963b4874c2ac67143455382f](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0ead57ceb21bbf15963b4874c2ac67143455382f) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=0ead57ceb21bbf15963b4874c2ac67143455382f)) | |
| tree | [aa905da870f1d1c3f54ce5613c8c44997fdbd233](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=0ead57ceb21bbf15963b4874c2ac67143455382f) | |
| parent | [fe9ac3eaa2e387a5742b380b73a5a6bc237bf184](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=fe9ac3eaa2e387a5742b380b73a5a6bc237bf184) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=0ead57ceb21bbf15963b4874c2ac67143455382f&id2=fe9ac3eaa2e387a5742b380b73a5a6bc237bf184)) | |
| download | [linux-0ead57ceb21bbf15963b4874c2ac67143455382f.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-0ead57ceb21bbf15963b4874c2ac67143455382f.tar.gz) | |

nvme: fix a possible use-after-free in controller reset during load[ Upstream commit 0fa0f99fc84e41057cbdd2efbfe91c6b2f47dd9d ]
Unlike .queue\_rq, in .submit\_async\_event drivers may not check the ctrl
readiness for AER submission. This may lead to a use-after-free
condition that was observed with nvme-tcp.
The race condition may happen in the following scenario:
1. driver executes its reset\_ctrl\_work
2. -> nvme\_stop\_ctrl - flushes ctrl async\_event\_work
3. ctrl sends AEN which is received by the host, which in turn
schedules AEN handling
4. teardown admin queue (which releases the queue socket)
5. AEN processed, submits another AER, calling the driver to submit
6. driver attempts to send the cmd
==> use-after-free
In order to fix that, add ctrl state check to validate the ctrl
is actually able to accept the AER submission.
This addresses the above race in controller resets because the driver
during teardown should:
1. change ctrl state to RESETTING
2. flush async\_event\_work (as well as other async work elements)
So after 1,2, any other AER command will find the
ctrl state to be RESETTING and bail out without submitting the AER.
Signed-off-by: Sagi Grimberg <sagi@grimberg.me>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=0ead57ceb21bbf15963b4874c2ac67143455382f)

| -rw-r--r-- | [drivers/nvme/host/core.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/nvme/host/core.c?id=0ead57ceb21bbf15963b4874c2ac67143455382f) | 9 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 8 insertions, 1 deletions

| diff --git a/drivers/nvme/host/core.c b/drivers/nvme/host/core.cindex 99b5152482fe42..71c85c99e86c6c 100644--- a/[drivers/nvme/host/core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/nvme/host/core.c?id=fe9ac3eaa2e387a5742b380b73a5a6bc237bf184)+++ b/[drivers/nvme/host/core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/nvme/host/core.c?id=0ead57ceb21bbf15963b4874c2ac67143455382f)@@ -4259,7 +4259,14 @@ static void nvme\_async\_event\_work(struct work\_struct \*work) container\_of(work, struct nvme\_ctrl, async\_event\_work);  nvme\_aen\_uevent(ctrl);- ctrl->ops->submit\_async\_event(ctrl);++ /\*+ \* The transport drivers must guarantee AER submission here is safe by+ \* flushing ctrl async\_event\_work after changing the controller state+ \* from LIVE and before freeing the admin queue.+ \*/+ if (ctrl->state == NVME\_CTRL\_LIVE)+ ctrl->ops->submit\_async\_event(ctrl); }  static bool nvme\_ctrl\_pp\_status(struct nvme\_ctrl \*ctrl) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 03:26:55 +0000



=== Content from git.kernel.org_43f5512a_20250111_032821.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=9e956a2596ae276124ef0d96829c013dd0faf861)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=9e956a2596ae276124ef0d96829c013dd0faf861)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=9e956a2596ae276124ef0d96829c013dd0faf861)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=9e956a2596ae276124ef0d96829c013dd0faf861)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Sagi Grimberg <sagi@grimberg.me> | 2022-02-01 14:54:19 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2022-02-23 12:05:51 +0100 |
| commit | [9e956a2596ae276124ef0d96829c013dd0faf861](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=9e956a2596ae276124ef0d96829c013dd0faf861) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=9e956a2596ae276124ef0d96829c013dd0faf861)) | |
| tree | [81d9cac03bcb42344145a8634f130a5c995605d4](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=9e956a2596ae276124ef0d96829c013dd0faf861) | |
| parent | [1478f5f11add8b70287b0ace3e7dec34eed0f257](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=1478f5f11add8b70287b0ace3e7dec34eed0f257) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=9e956a2596ae276124ef0d96829c013dd0faf861&id2=1478f5f11add8b70287b0ace3e7dec34eed0f257)) | |
| download | [linux-9e956a2596ae276124ef0d96829c013dd0faf861.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-9e956a2596ae276124ef0d96829c013dd0faf861.tar.gz) | |

nvme: fix a possible use-after-free in controller reset during load[ Upstream commit 0fa0f99fc84e41057cbdd2efbfe91c6b2f47dd9d ]
Unlike .queue\_rq, in .submit\_async\_event drivers may not check the ctrl
readiness for AER submission. This may lead to a use-after-free
condition that was observed with nvme-tcp.
The race condition may happen in the following scenario:
1. driver executes its reset\_ctrl\_work
2. -> nvme\_stop\_ctrl - flushes ctrl async\_event\_work
3. ctrl sends AEN which is received by the host, which in turn
schedules AEN handling
4. teardown admin queue (which releases the queue socket)
5. AEN processed, submits another AER, calling the driver to submit
6. driver attempts to send the cmd
==> use-after-free
In order to fix that, add ctrl state check to validate the ctrl
is actually able to accept the AER submission.
This addresses the above race in controller resets because the driver
during teardown should:
1. change ctrl state to RESETTING
2. flush async\_event\_work (as well as other async work elements)
So after 1,2, any other AER command will find the
ctrl state to be RESETTING and bail out without submitting the AER.
Signed-off-by: Sagi Grimberg <sagi@grimberg.me>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=9e956a2596ae276124ef0d96829c013dd0faf861)

| -rw-r--r-- | [drivers/nvme/host/core.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/nvme/host/core.c?id=9e956a2596ae276124ef0d96829c013dd0faf861) | 9 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 8 insertions, 1 deletions

| diff --git a/drivers/nvme/host/core.c b/drivers/nvme/host/core.cindex 1af8a4513708a7..9a6586c69afe88 100644--- a/[drivers/nvme/host/core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/nvme/host/core.c?id=1478f5f11add8b70287b0ace3e7dec34eed0f257)+++ b/[drivers/nvme/host/core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/nvme/host/core.c?id=9e956a2596ae276124ef0d96829c013dd0faf861)@@ -4258,7 +4258,14 @@ static void nvme\_async\_event\_work(struct work\_struct \*work) container\_of(work, struct nvme\_ctrl, async\_event\_work);  nvme\_aen\_uevent(ctrl);- ctrl->ops->submit\_async\_event(ctrl);++ /\*+ \* The transport drivers must guarantee AER submission here is safe by+ \* flushing ctrl async\_event\_work after changing the controller state+ \* from LIVE and before freeing the admin queue.+ \*/+ if (ctrl->state == NVME\_CTRL\_LIVE)+ ctrl->ops->submit\_async\_event(ctrl); }  static bool nvme\_ctrl\_pp\_status(struct nvme\_ctrl \*ctrl) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 03:26:58 +0000



=== Content from git.kernel.org_f8ecd8a5_20250111_032822.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=a25e460fbb0340488d119fb2e28fe3f829b7417e)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=a25e460fbb0340488d119fb2e28fe3f829b7417e)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a25e460fbb0340488d119fb2e28fe3f829b7417e)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=a25e460fbb0340488d119fb2e28fe3f829b7417e)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Sagi Grimberg <sagi@grimberg.me> | 2022-02-01 14:54:19 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2022-02-23 11:58:38 +0100 |
| commit | [a25e460fbb0340488d119fb2e28fe3f829b7417e](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a25e460fbb0340488d119fb2e28fe3f829b7417e) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=a25e460fbb0340488d119fb2e28fe3f829b7417e)) | |
| tree | [9e7698a56b636153537f8b1fea795abde89fdf06](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=a25e460fbb0340488d119fb2e28fe3f829b7417e) | |
| parent | [a1a41571f06e2b66229738bd0c92c1d57dd793e2](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a1a41571f06e2b66229738bd0c92c1d57dd793e2) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=a25e460fbb0340488d119fb2e28fe3f829b7417e&id2=a1a41571f06e2b66229738bd0c92c1d57dd793e2)) | |
| download | [linux-a25e460fbb0340488d119fb2e28fe3f829b7417e.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-a25e460fbb0340488d119fb2e28fe3f829b7417e.tar.gz) | |

nvme: fix a possible use-after-free in controller reset during load[ Upstream commit 0fa0f99fc84e41057cbdd2efbfe91c6b2f47dd9d ]
Unlike .queue\_rq, in .submit\_async\_event drivers may not check the ctrl
readiness for AER submission. This may lead to a use-after-free
condition that was observed with nvme-tcp.
The race condition may happen in the following scenario:
1. driver executes its reset\_ctrl\_work
2. -> nvme\_stop\_ctrl - flushes ctrl async\_event\_work
3. ctrl sends AEN which is received by the host, which in turn
schedules AEN handling
4. teardown admin queue (which releases the queue socket)
5. AEN processed, submits another AER, calling the driver to submit
6. driver attempts to send the cmd
==> use-after-free
In order to fix that, add ctrl state check to validate the ctrl
is actually able to accept the AER submission.
This addresses the above race in controller resets because the driver
during teardown should:
1. change ctrl state to RESETTING
2. flush async\_event\_work (as well as other async work elements)
So after 1,2, any other AER command will find the
ctrl state to be RESETTING and bail out without submitting the AER.
Signed-off-by: Sagi Grimberg <sagi@grimberg.me>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=a25e460fbb0340488d119fb2e28fe3f829b7417e)

| -rw-r--r-- | [drivers/nvme/host/core.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/nvme/host/core.c?id=a25e460fbb0340488d119fb2e28fe3f829b7417e) | 9 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 8 insertions, 1 deletions

| diff --git a/drivers/nvme/host/core.c b/drivers/nvme/host/core.cindex e64310f2296f85..a0a805a5ab6b27 100644--- a/[drivers/nvme/host/core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/nvme/host/core.c?id=a1a41571f06e2b66229738bd0c92c1d57dd793e2)+++ b/[drivers/nvme/host/core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/nvme/host/core.c?id=a25e460fbb0340488d119fb2e28fe3f829b7417e)@@ -3463,7 +3463,14 @@ static void nvme\_async\_event\_work(struct work\_struct \*work) container\_of(work, struct nvme\_ctrl, async\_event\_work);  nvme\_aen\_uevent(ctrl);- ctrl->ops->submit\_async\_event(ctrl);++ /\*+ \* The transport drivers must guarantee AER submission here is safe by+ \* flushing ctrl async\_event\_work after changing the controller state+ \* from LIVE and before freeing the admin queue.+ \*/+ if (ctrl->state == NVME\_CTRL\_LIVE)+ ctrl->ops->submit\_async\_event(ctrl); }  static bool nvme\_ctrl\_pp\_status(struct nvme\_ctrl \*ctrl) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 03:27:00 +0000



=== Content from git.kernel.org_62edc855_20250111_032819.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=0fa0f99fc84e41057cbdd2efbfe91c6b2f47dd9d)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=0fa0f99fc84e41057cbdd2efbfe91c6b2f47dd9d)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0fa0f99fc84e41057cbdd2efbfe91c6b2f47dd9d)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=0fa0f99fc84e41057cbdd2efbfe91c6b2f47dd9d)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Sagi Grimberg <sagi@grimberg.me> | 2022-02-01 14:54:19 +0200 |
| --- | --- | --- |
| committer | Christoph Hellwig <hch@lst.de> | 2022-02-02 09:19:05 +0100 |
| commit | [0fa0f99fc84e41057cbdd2efbfe91c6b2f47dd9d](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0fa0f99fc84e41057cbdd2efbfe91c6b2f47dd9d) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=0fa0f99fc84e41057cbdd2efbfe91c6b2f47dd9d)) | |
| tree | [6b318c83b0aa3008d0895649b79bd79f3f4255f7](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=0fa0f99fc84e41057cbdd2efbfe91c6b2f47dd9d) | |
| parent | [b879f915bc48a18d4f4462729192435bb0f17052](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b879f915bc48a18d4f4462729192435bb0f17052) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=0fa0f99fc84e41057cbdd2efbfe91c6b2f47dd9d&id2=b879f915bc48a18d4f4462729192435bb0f17052)) | |
| download | [linux-0fa0f99fc84e41057cbdd2efbfe91c6b2f47dd9d.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-0fa0f99fc84e41057cbdd2efbfe91c6b2f47dd9d.tar.gz) | |

nvme: fix a possible use-after-free in controller reset during loadUnlike .queue\_rq, in .submit\_async\_event drivers may not check the ctrl
readiness for AER submission. This may lead to a use-after-free
condition that was observed with nvme-tcp.
The race condition may happen in the following scenario:
1. driver executes its reset\_ctrl\_work
2. -> nvme\_stop\_ctrl - flushes ctrl async\_event\_work
3. ctrl sends AEN which is received by the host, which in turn
schedules AEN handling
4. teardown admin queue (which releases the queue socket)
5. AEN processed, submits another AER, calling the driver to submit
6. driver attempts to send the cmd
==> use-after-free
In order to fix that, add ctrl state check to validate the ctrl
is actually able to accept the AER submission.
This addresses the above race in controller resets because the driver
during teardown should:
1. change ctrl state to RESETTING
2. flush async\_event\_work (as well as other async work elements)
So after 1,2, any other AER command will find the
ctrl state to be RESETTING and bail out without submitting the AER.
Signed-off-by: Sagi Grimberg <sagi@grimberg.me>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=0fa0f99fc84e41057cbdd2efbfe91c6b2f47dd9d)

| -rw-r--r-- | [drivers/nvme/host/core.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/nvme/host/core.c?id=0fa0f99fc84e41057cbdd2efbfe91c6b2f47dd9d) | 9 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 8 insertions, 1 deletions

| diff --git a/drivers/nvme/host/core.c b/drivers/nvme/host/core.cindex 5e0bfda04bd7b1..961a5f8a44d2aa 100644--- a/[drivers/nvme/host/core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/nvme/host/core.c?id=b879f915bc48a18d4f4462729192435bb0f17052)+++ b/[drivers/nvme/host/core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/nvme/host/core.c?id=0fa0f99fc84e41057cbdd2efbfe91c6b2f47dd9d)@@ -4253,7 +4253,14 @@ static void nvme\_async\_event\_work(struct work\_struct \*work) container\_of(work, struct nvme\_ctrl, async\_event\_work);  nvme\_aen\_uevent(ctrl);- ctrl->ops->submit\_async\_event(ctrl);++ /\*+ \* The transport drivers must guarantee AER submission here is safe by+ \* flushing ctrl async\_event\_work after changing the controller state+ \* from LIVE and before freeing the admin queue.+ \*/+ if (ctrl->state == NVME\_CTRL\_LIVE)+ ctrl->ops->submit\_async\_event(ctrl); }  static bool nvme\_ctrl\_pp\_status(struct nvme\_ctrl \*ctrl) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 03:26:56 +0000



=== Content from git.kernel.org_2aa4d451_20250111_032824.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=e043fb5a0336ee74614e26f0d9f36f1f5bb6d606)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=e043fb5a0336ee74614e26f0d9f36f1f5bb6d606)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e043fb5a0336ee74614e26f0d9f36f1f5bb6d606)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e043fb5a0336ee74614e26f0d9f36f1f5bb6d606)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Sagi Grimberg <sagi@grimberg.me> | 2022-02-01 14:54:19 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2022-02-23 12:03:06 +0100 |
| commit | [e043fb5a0336ee74614e26f0d9f36f1f5bb6d606](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e043fb5a0336ee74614e26f0d9f36f1f5bb6d606) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=e043fb5a0336ee74614e26f0d9f36f1f5bb6d606)) | |
| tree | [53e752611c9749ee12929b499df4e767b1a76554](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=e043fb5a0336ee74614e26f0d9f36f1f5bb6d606) | |
| parent | [64519c9e32ac548fd47cf16767f4b779a8cbdd14](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=64519c9e32ac548fd47cf16767f4b779a8cbdd14) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e043fb5a0336ee74614e26f0d9f36f1f5bb6d606&id2=64519c9e32ac548fd47cf16767f4b779a8cbdd14)) | |
| download | [linux-e043fb5a0336ee74614e26f0d9f36f1f5bb6d606.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-e043fb5a0336ee74614e26f0d9f36f1f5bb6d606.tar.gz) | |

nvme: fix a possible use-after-free in controller reset during load[ Upstream commit 0fa0f99fc84e41057cbdd2efbfe91c6b2f47dd9d ]
Unlike .queue\_rq, in .submit\_async\_event drivers may not check the ctrl
readiness for AER submission. This may lead to a use-after-free
condition that was observed with nvme-tcp.
The race condition may happen in the following scenario:
1. driver executes its reset\_ctrl\_work
2. -> nvme\_stop\_ctrl - flushes ctrl async\_event\_work
3. ctrl sends AEN which is received by the host, which in turn
schedules AEN handling
4. teardown admin queue (which releases the queue socket)
5. AEN processed, submits another AER, calling the driver to submit
6. driver attempts to send the cmd
==> use-after-free
In order to fix that, add ctrl state check to validate the ctrl
is actually able to accept the AER submission.
This addresses the above race in controller resets because the driver
during teardown should:
1. change ctrl state to RESETTING
2. flush async\_event\_work (as well as other async work elements)
So after 1,2, any other AER command will find the
ctrl state to be RESETTING and bail out without submitting the AER.
Signed-off-by: Sagi Grimberg <sagi@grimberg.me>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e043fb5a0336ee74614e26f0d9f36f1f5bb6d606)

| -rw-r--r-- | [drivers/nvme/host/core.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/nvme/host/core.c?id=e043fb5a0336ee74614e26f0d9f36f1f5bb6d606) | 9 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 8 insertions, 1 deletions

| diff --git a/drivers/nvme/host/core.c b/drivers/nvme/host/core.cindex f8dd664b2eda52..8aa92ebb8b7c18 100644--- a/[drivers/nvme/host/core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/nvme/host/core.c?id=64519c9e32ac548fd47cf16767f4b779a8cbdd14)+++ b/[drivers/nvme/host/core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/nvme/host/core.c?id=e043fb5a0336ee74614e26f0d9f36f1f5bb6d606)@@ -4187,7 +4187,14 @@ static void nvme\_async\_event\_work(struct work\_struct \*work) container\_of(work, struct nvme\_ctrl, async\_event\_work);  nvme\_aen\_uevent(ctrl);- ctrl->ops->submit\_async\_event(ctrl);++ /\*+ \* The transport drivers must guarantee AER submission here is safe by+ \* flushing ctrl async\_event\_work after changing the controller state+ \* from LIVE and before freeing the admin queue.+ \*/+ if (ctrl->state == NVME\_CTRL\_LIVE)+ ctrl->ops->submit\_async\_event(ctrl); }  static bool nvme\_ctrl\_pp\_status(struct nvme\_ctrl \*ctrl) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 03:27:01 +0000


