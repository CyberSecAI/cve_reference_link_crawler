=== Content from github.com_41a9a465_20250111_174926.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fethyca%2Ffides%2Fcommit%2F5989b5fa744c8d8c340963b895a054883549358a)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fethyca%2Ffides%2Fcommit%2F5989b5fa744c8d8c340963b895a054883549358a)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=ethyca%2Ffides)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ethyca](/ethyca)
/
**[fides](/ethyca/fides)**
Public

* [Notifications](/login?return_to=%2Fethyca%2Ffides) You must be signed in to change notification settings
* [Fork
  73](/login?return_to=%2Fethyca%2Ffides)
* [Star
   382](/login?return_to=%2Fethyca%2Ffides)

* [Code](/ethyca/fides)
* [Issues
  215](/ethyca/fides/issues)
* [Pull requests
  58](/ethyca/fides/pulls)
* [Actions](/ethyca/fides/actions)
* [Projects
  0](/ethyca/fides/projects)
* [Security](/ethyca/fides/security)
* [Insights](/ethyca/fides/pulse)

Additional navigation options

* [Code](/ethyca/fides)
* [Issues](/ethyca/fides/issues)
* [Pull requests](/ethyca/fides/pulls)
* [Actions](/ethyca/fides/actions)
* [Projects](/ethyca/fides/projects)
* [Security](/ethyca/fides/security)
* [Insights](/ethyca/fides/pulse)

## Commit

[Permalink](/ethyca/fides/commit/5989b5fa744c8d8c340963b895a054883549358a)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-p6p2-qq95-vq5h](https://github.com/advisories/GHSA-p6p2-qq95-vq5h "GHSA-p6p2-qq95-vq5h")

[Browse files](/ethyca/fides/tree/5989b5fa744c8d8c340963b895a054883549358a)
Browse the repository at this point in the history

```
* Removing custom connector template functions

* Updating connector template modal description

* Adding function upload tests
```

* Loading branch information

[![@galvana](https://avatars.githubusercontent.com/u/2092272?s=40&v=4)](/galvana)

[galvana](/ethyca/fides/commits?author=galvana "View all commits by galvana")
authored
Sep 5, 2023

1 parent
[993bf88](/ethyca/fides/commit/993bf883acf9d1261a2eee3d1fe3871089bd4b5f)

commit 5989b5f

 Show file tree

 Hide file tree

Showing
**9 changed files**
with
**43 additions**
and
**414 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* clients/admin-ui/src/features/connector-templates

  + clients/admin-ui/src/features/connector-templates/ConnectorTemplateUploadModal.tsx
    [ConnectorTemplateUploadModal.tsx](#diff-ae256e6298f8a61ab2be2c2fbd558fa836012548e930c2ab3083686a01087750)
* docker-compose.yml
  [docker-compose.yml](#diff-e45e45baeda1c1e73482975a664062aa56f20c03dd9d64a827aba57775bed0d3)
* requirements.txt
  [requirements.txt](#diff-4d7c51b1efe9043e44439a949dfd92e5827321b34082903477fd04876edb7552)
* src/fides

  + api

    - schemas/saas

      * src/fides/api/schemas/saas/connector\_template.py
        [connector\_template.py](#diff-81dad98e1f6642b0f0e7d72d06e5711a50d7b441d7acae9bd5a62ce4013ab12d)
    - service/connectors/saas

      * src/fides/api/service/connectors/saas/connector\_registry\_service.py
        [connector\_registry\_service.py](#diff-0fe5cf55fe704521632bdd7d629d5545aefe0315af6426ccdd4bf8befcb27e25)
  + config

    - src/fides/config/security\_settings.py
      [security\_settings.py](#diff-266d9dd9d802ccb83f4229827551166d3cb80dec4beb57be2f8dada17aa04227)
* tests/ops

  + api/v1/endpoints

    - tests/ops/api/v1/endpoints/test\_saas\_config\_endpoints.py
      [test\_saas\_config\_endpoints.py](#diff-4b1aa47e238a592c91626d193b5528760dfdd7bdba2dd883f8fcc2fc428b807d)
  + models

    - tests/ops/models/test\_custom\_connector\_template.py
      [test\_custom\_connector\_template.py](#diff-d816e1e3151540816a6ab97b20d0a7552fba18ff9561d1df0ccc4c508b817453)
  + service/connectors

    - tests/ops/service/connectors/test\_connector\_template\_loaders.py
      [test\_connector\_template\_loaders.py](#diff-f368095501a290afcc32e8a4a739bf1850aaca1ee3b4ba75b7220f8d3da63dfe)

## There are no files selected for viewing

3 changes: 1 addition & 2 deletions

3
[clients/admin-ui/src/features/connector-templates/ConnectorTemplateUploadModal.tsx](#diff-ae256e6298f8a61ab2be2c2fbd558fa836012548e930c2ab3083686a01087750 "clients/admin-ui/src/features/connector-templates/ConnectorTemplateUploadModal.tsx")

Show comments

[View file](/ethyca/fides/blob/5989b5fa744c8d8c340963b895a054883549358a/clients/admin-ui/src/features/connector-templates/ConnectorTemplateUploadModal.tsx)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -122,8 +122,7 @@ const ConnectorTemplateUploadModal: React.FC<RequestModalProps> = ({ |
|  |  | </Box> |
|  |  | <Text fontSize="sm" mt={4}> |
|  |  | An integration template zip file must include a SaaS config and |
|  |  | dataset, but may also contain an icon (.svg) and custom functions |
|  |  | (.py) as optional files. |
|  |  | dataset, but may also contain an icon (.svg) as an optional file. |
|  |  | </Text> |
|  |  | </ModalBody> |
|  |  | <ModalFooter> |
| Expand Down | |  |

1 change: 0 additions & 1 deletion

1
[docker-compose.yml](#diff-e45e45baeda1c1e73482975a664062aa56f20c03dd9d64a827aba57775bed0d3 "docker-compose.yml")

Show comments

[View file](/ethyca/fides/blob/5989b5fa744c8d8c340963b895a054883549358a/docker-compose.yml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -28,7 +28,6 @@ services: |
|  |  | FIDES\_\_DEV\_MODE: "True" |
|  |  | FIDES\_\_LOGGING\_\_COLORIZE: "True" |
|  |  | FIDES\_\_USER\_\_ANALYTICS\_OPT\_OUT: "True" |
|  |  | FIDES\_\_SECURITY\_\_ALLOW\_CUSTOM\_CONNECTOR\_FUNCTIONS: "True" |
|  |  | FIDES\_\_SECURITY\_\_BASTION\_SERVER\_HOST: ${FIDES\_\_SECURITY\_\_BASTION\_SERVER\_HOST-} |
|  |  | FIDES\_\_SECURITY\_\_BASTION\_SERVER\_SSH\_USERNAME: ${FIDES\_\_SECURITY\_\_BASTION\_SERVER\_SSH\_USERNAME-} |
|  |  | FIDES\_\_SECURITY\_\_BASTION\_SERVER\_SSH\_PRIVATE\_KEY: ${FIDES\_\_SECURITY\_\_BASTION\_SERVER\_SSH\_PRIVATE\_KEY-} |
| Expand Down | |  |

2 changes: 0 additions & 2 deletions

2
[requirements.txt](#diff-4d7c51b1efe9043e44439a949dfd92e5827321b34082903477fd04876edb7552 "requirements.txt")

Show comments

[View file](/ethyca/fides/blob/5989b5fa744c8d8c340963b895a054883549358a/requirements.txt)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,4 +1,3 @@ |
|  |  | AccessControl==6.0 |
|  |  | alembic==1.8.1 |
|  |  | APScheduler==3.9.1.post1 |
|  |  | asyncpg==0.27.0 |
| Expand Down  Expand Up | | @@ -42,7 +41,6 @@ pymssql==2.2.8 |
|  |  | python-jose[cryptography]==3.3.0 |
|  |  | pyyaml==6.0.1 |
|  |  | redis==3.5.3 |
|  |  | RestrictedPython==6.0.0 |
|  |  | rich-click==1.6.1 |
|  |  | sendgrid==6.9.7 |
|  |  | slowapi==0.1.8 |
| Expand Down | |  |

3 changes: 1 addition & 2 deletions

3
[src/fides/api/schemas/saas/connector\_template.py](#diff-81dad98e1f6642b0f0e7d72d06e5711a50d7b441d7acae9bd5a62ce4013ab12d "src/fides/api/schemas/saas/connector_template.py")

Show comments

[View file](/ethyca/fides/blob/5989b5fa744c8d8c340963b895a054883549358a/src/fides/api/schemas/saas/connector_template.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -13,13 +13,12 @@ |
|  |  | class ConnectorTemplate(BaseModel): |
|  |  | """ |
|  |  | A collection of artifacts that make up a complete |
|  |  | SaaS connector (SaaS config, dataset, icon, functions, etc.) |
|  |  | SaaS connector (SaaS config, dataset, icon, etc.) |
|  |  | """ |
|  |  |  |
|  |  | config: str |
|  |  | dataset: str |
|  |  | icon: Optional[str] |
|  |  | functions: Optional[str] |
|  |  | human\_readable: str |
|  |  |  |
|  |  | @validator("config") |
| Expand Down | |  |

108 changes: 4 additions & 104 deletions

108
[src/fides/api/service/connectors/saas/connector\_registry\_service.py](#diff-0fe5cf55fe704521632bdd7d629d5545aefe0315af6426ccdd4bf8befcb27e25 "src/fides/api/service/connectors/saas/connector_registry_service.py")

Show comments

[View file](/ethyca/fides/blob/5989b5fa744c8d8c340963b895a054883549358a/src/fides/api/service/connectors/saas/connector_registry_service.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,22 +1,17 @@ |
|  |  | # pylint: disable=protected-access |
|  |  | import os |
|  |  | from abc import ABC, abstractmethod |
|  |  | from ast import AST, AnnAssign |
|  |  | from operator import getitem |
|  |  | from typing import Any, Dict, Iterable, List, Optional, Tuple, Type |
|  |  | from typing import Dict, Iterable, List, Optional, Type |
|  |  | from zipfile import ZipFile |
|  |  |  |
|  |  | from AccessControl.ZopeGuards import safe\_builtins |
|  |  | from fideslang.models import Dataset |
|  |  | from loguru import logger |
|  |  | from packaging.version import Version |
|  |  | from packaging.version import parse as parse\_version |
|  |  | from RestrictedPython import compile\_restricted |
|  |  | from RestrictedPython.transformer import RestrictingNodeTransformer |
|  |  | from sqlalchemy.orm import Session |
|  |  |  |
|  |  | from fides.api.api.deps import get\_api\_session |
|  |  | from fides.api.common\_exceptions import FidesopsException, ValidationError |
|  |  | from fides.api.common\_exceptions import ValidationError |
|  |  | from fides.api.cryptography.cryptographic\_util import str\_to\_b64\_str |
|  |  | from fides.api.models.connectionconfig import ( |
|  |  | AccessLevel, |
| Expand All | | @@ -41,7 +36,6 @@ |
|  |  | replace\_version, |
|  |  | ) |
|  |  | from fides.api.util.unsafe\_file\_util import verify\_svg, verify\_zip |
|  |  | from fides.config import CONFIG |
|  |  |  |
|  |  |  |
|  |  | class ConnectorTemplateLoader(ABC): |
| Expand Down  Expand Up | | @@ -96,7 +90,6 @@ def \_load\_connector\_templates(self) -> None: |
|  |  | f"data/saas/dataset/{connector\_type}\_dataset.yml" |
|  |  | ), |
|  |  | icon=icon, |
|  |  | functions=None, |
|  |  | human\_readable=human\_readable, |
|  |  | ) |
|  |  | except Exception: |
| Expand Down  Expand Up | | @@ -151,24 +144,16 @@ def \_register\_template( |
|  |  | template: CustomConnectorTemplate, |
|  |  | ) -> None: |
|  |  | """ |
|  |  | Registers a custom connector template by converting it to a ConnectorTemplate, |
|  |  | registering any custom functions, and adding it to the loader's template dictionary. |
|  |  | Registers a custom connector template by converting it to a ConnectorTemplate |
|  |  | and adding it to the loader's template dictionary. |
|  |  | """ |
|  |  | connector\_template = ConnectorTemplate( |
|  |  | config=template.config, |
|  |  | dataset=template.dataset, |
|  |  | icon=template.icon, |
|  |  | functions=template.functions, |
|  |  | human\_readable=template.name, |
|  |  | ) |
|  |  |  |
|  |  | # register custom functions if available |
|  |  | if template.functions: |
|  |  | register\_custom\_functions(template.functions) |
|  |  | logger.info( |
|  |  | f"Loaded functions from the custom connector template '{template.key}'" |
|  |  | ) |
|  |  |  |
|  |  | # register the template in the loader's template dictionary |
|  |  | CustomConnectorTemplateLoader.get\_connector\_templates()[ |
|  |  | template.key |
| Expand Down  Expand Up | | @@ -220,13 +205,6 @@ def save\_template(cls, db: Session, zip\_file: ZipFile) -> None: |
|  |  | raise ValidationError( |
|  |  | "Multiple svg files found, only one is allowed." |
|  |  | ) |
|  |  | elif info.filename.endswith(".py"): |
|  |  | if not function\_contents: |
|  |  | function\_contents = file\_contents |
|  |  | else: |
|  |  | raise ValidationError( |
|  |  | "Multiple Python (.py) files found, only one is allowed." |
|  |  | ) |
|  |  |  |
|  |  | if not config\_contents: |
|  |  | raise ValidationError("Zip file does not contain a config.yml file.") |
| Expand Down  Expand Up | | @@ -266,7 +244,6 @@ def save\_template(cls, db: Session, zip\_file: ZipFile) -> None: |
|  |  | config=config\_contents, |
|  |  | dataset=dataset\_contents, |
|  |  | icon=icon\_contents, |
|  |  | functions=function\_contents, |
|  |  | replaceable=replaceable, |
|  |  | ) |
|  |  |  |
| Expand Down  Expand Up | | @@ -447,80 +424,3 @@ def update\_saas\_instance( |
|  |  | connection\_config.update\_saas\_config(db, SaaSConfig(\*\*config\_from\_template)) |
|  |  |  |
|  |  | upsert\_dataset\_config\_from\_template(db, connection\_config, template, template\_vals) |
|  |  |  |
|  |  |  |
|  |  | def register\_custom\_functions(script: str) -> None: |
|  |  | """ |
|  |  | Registers custom functions by executing the given script in a restricted environment. |
|  |  |  |
|  |  | The script is compiled and executed with RestrictedPython, which is designed to reduce |
|  |  | the risk of executing untrusted code. It provides a set of safe builtins to prevent |
|  |  | malicious or unintended behavior. |
|  |  |  |
|  |  | Args: |
|  |  | script (str): The Python script containing the custom functions to be registered. |
|  |  |  |
|  |  | Raises: |
|  |  | FidesopsException: If allow\_custom\_connector\_functions is disabled. |
|  |  | SyntaxError: If the script contains a syntax error or uses restricted language features. |
|  |  | Exception: If an exception occurs during the execution of the script. |
|  |  | """ |
|  |  |  |
|  |  | if CONFIG.security.allow\_custom\_connector\_functions: |
|  |  | restricted\_code = compile\_restricted( |
|  |  | script, "<string>", "exec", policy=CustomRestrictingNodeTransformer |
|  |  | ) |
|  |  | safe\_builtins["\_\_import\_\_"] = custom\_guarded\_import |
|  |  | safe\_builtins["\_getitem\_"] = getitem |
|  |  | safe\_builtins["staticmethod"] = staticmethod |
|  |  |  |
|  |  | # pylint: disable=exec-used |
|  |  | exec( |
|  |  | restricted\_code, |
|  |  | { |
|  |  | "\_\_metaclass\_\_": type, |
|  |  | "\_\_name\_\_": "restricted\_module", |
|  |  | "\_\_builtins\_\_": safe\_builtins, |
|  |  | }, |
|  |  | ) |
|  |  | else: |
|  |  | raise FidesopsException( |
|  |  | message="The import of connector templates with custom functions is disabled by the 'security.allow\_custom\_connector\_functions' setting." |
|  |  | ) |
|  |  |  |
|  |  |  |
|  |  | class CustomRestrictingNodeTransformer(RestrictingNodeTransformer): |
|  |  | """ |
|  |  | Custom node transformer class that extends RestrictedPython's RestrictingNodeTransformer |
|  |  | to allow the use of type annotations (AnnAssign) in restricted code. |
|  |  | """ |
|  |  |  |
|  |  | def visit\_AnnAssign(self, node: AnnAssign) -> AST: |
|  |  | return self.node\_contents\_visit(node) |
|  |  |  |
|  |  |  |
|  |  | def custom\_guarded\_import( |
|  |  | name: str, |
|  |  | \_globals: Optional[dict] = None, |
|  |  | \_locals: Optional[dict] = None, |
|  |  | fromlist: Optional[Tuple[str, ...]] = None, |
|  |  | level: int = 0, |
|  |  | ) -> Any: |
|  |  | """ |
|  |  | A custom import function that prevents the import of certain potentially unsafe modules. |
|  |  | """ |
|  |  | if name in [ |
|  |  | "os", |
|  |  | "sys", |
|  |  | "subprocess", |
|  |  | "shutil", |
|  |  | "socket", |
|  |  | "importlib", |
|  |  | "tempfile", |
|  |  | "glob", |
|  |  | ]: |
|  |  | # raising SyntaxError to be consistent with exceptions thrown from other guarded functions |
|  |  | raise SyntaxError(f"Import of '{name}' module is not allowed.") |
|  |  | if fromlist is None: |
|  |  | fromlist = () |
|  |  | return \_\_import\_\_(name, \_globals, \_locals, fromlist, level) |

4 changes: 0 additions & 4 deletions

4
[src/fides/config/security\_settings.py](#diff-266d9dd9d802ccb83f4229827551166d3cb80dec4beb57be2f8dada17aa04227 "src/fides/config/security_settings.py")

Show comments

[View file](/ethyca/fides/blob/5989b5fa744c8d8c340963b895a054883549358a/src/fides/config/security_settings.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -118,10 +118,6 @@ class SecuritySettings(FidesSettings): |
|  |  | default=432000, |
|  |  | description="The number of seconds that a pre-signed download URL when using S3 storage will be valid. The default is equal to 5 days.", |
|  |  | ) |
|  |  | allow\_custom\_connector\_functions: Optional[bool] = Field( |
|  |  | default=False, |
|  |  | description="Enables or disables the ability to import connector templates with custom functions. When enabled, custom functions which will be loaded in a restricted environment to minimize security risks.", |
|  |  | ) |
|  |  | enable\_audit\_log\_resource\_middleware: Optional[bool] = Field( |
|  |  | default=False, |
|  |  | description="Either enables the collection of audit log resource data or bypasses the middleware", |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `5989b5f`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fethyca%2Ffides%2Fcommit%2F5989b5fa744c8d8c340963b895a054883549358a) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_154da172_20250111_174927.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fethyca%2Ffides%2Fsecurity%2Fadvisories%2FGHSA-p6p2-qq95-vq5h)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fethyca%2Ffides%2Fsecurity%2Fadvisories%2FGHSA-p6p2-qq95-vq5h)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=ethyca%2Ffides)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ethyca](/ethyca)
/
**[fides](/ethyca/fides)**
Public

* [Notifications](/login?return_to=%2Fethyca%2Ffides) You must be signed in to change notification settings
* [Fork
  73](/login?return_to=%2Fethyca%2Ffides)
* [Star
   382](/login?return_to=%2Fethyca%2Ffides)

* [Code](/ethyca/fides)
* [Issues
  215](/ethyca/fides/issues)
* [Pull requests
  58](/ethyca/fides/pulls)
* [Actions](/ethyca/fides/actions)
* [Projects
  0](/ethyca/fides/projects)
* [Security](/ethyca/fides/security)
* [Insights](/ethyca/fides/pulse)

Additional navigation options

* [Code](/ethyca/fides)
* [Issues](/ethyca/fides/issues)
* [Pull requests](/ethyca/fides/pulls)
* [Actions](/ethyca/fides/actions)
* [Projects](/ethyca/fides/projects)
* [Security](/ethyca/fides/security)
* [Insights](/ethyca/fides/pulse)

# Remote Code Execution in Custom Integration Upload

High

[daveqnet](/daveqnet)
published
GHSA-p6p2-qq95-vq5h
Sep 6, 2023

## Package

pip

ethyca-fides
([pip](/advisories?query=ecosystem%3Apip))

## Affected versions

>= 2.11.0

## Patched versions

2.19.0

## Description

### Impact

The Fides webserver API allows custom integrations to be uploaded as a ZIP file. This ZIP file must contain YAML files, but Fides can be configured to also accept the inclusion of custom Python code in it. The custom code is executed in a restricted, sandboxed environment, but the sandbox can be bypassed to execute any arbitrary code.

The vulnerability allows the execution of arbitrary code on the target system within the context of the webserver python process owner on the webserver container, which by default is `root`, and leverage that access to attack underlying infrastructure and integrated systems.

This vulnerability affects Fides versions `2.11.0` through `2.18.0`.

Exploitation is limited to API clients with the `CONNECTOR_TEMPLATE_REGISTER` authorization scope. In the Fides Admin UI this scope is restricted to highly privileged users, specifically root users and users with the owner role.

Exploitation is only possible if the security configuration parameter `allow_custom_connector_functions` is enabled by the user deploying the Fides webserver container, either in `fides.toml` or by setting the env var `FIDES__SECURITY__ALLOW_CUSTOM_CONNECTOR_FUNCTIONS=True`. By default this configuration parameter is disabled.

### Patches

The vulnerability has been patched in Fides version `2.19.0`. Users are advised to upgrade to this version or later to secure their systems against this threat.

### Workarounds

Ensure that `allow_custom_connector_functions` in `fides.toml` and the `FIDES__SECURITY__ALLOW_CUSTOM_CONNECTOR_FUNCTIONS` are both either unset or explicit set to `False`.

### Severity

High

### CVE ID

CVE-2023-41319

### Weaknesses

[CWE-94](/advisories?query=cwe%3A94) [CWE-693](/advisories?query=cwe%3A693)

### Credits

* [![@grmpyninja](https://avatars.githubusercontent.com/u/23487759?s=40&v=4)](/grmpyninja)
  [grmpyninja](/grmpyninja)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


