
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FDozerMapper%2Fdozer%2Fissues%2F217)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FDozerMapper%2Fdozer%2Fissues%2F217)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fissues%2Fshow&source=header-repo&source_repo=DozerMapper%2Fdozer)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[DozerMapper](/DozerMapper)
/
**[dozer](/DozerMapper/dozer)**
Public

* [Notifications](/login?return_to=%2FDozerMapper%2Fdozer) You must be signed in to change notification settings
* [Fork
  481](/login?return_to=%2FDozerMapper%2Fdozer)
* [Star
   2.1k](/login?return_to=%2FDozerMapper%2Fdozer)

* [Code](/DozerMapper/dozer)
* [Issues
  6](/DozerMapper/dozer/issues)
* [Pull requests
  2](/DozerMapper/dozer/pulls)
* [Actions](/DozerMapper/dozer/actions)
* [Projects
  0](/DozerMapper/dozer/projects)
* [Wiki](/DozerMapper/dozer/wiki)
* [Security](/DozerMapper/dozer/security)
* [Insights](/DozerMapper/dozer/pulse)

Additional navigation options

* [Code](/DozerMapper/dozer)
* [Issues](/DozerMapper/dozer/issues)
* [Pull requests](/DozerMapper/dozer/pulls)
* [Actions](/DozerMapper/dozer/actions)
* [Projects](/DozerMapper/dozer/projects)
* [Wiki](/DozerMapper/dozer/wiki)
* [Security](/DozerMapper/dozer/security)
* [Insights](/DozerMapper/dozer/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FDozerMapper%2Fdozer%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FDozerMapper%2Fdozer%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Potential remote code execution via dozer's reflection-based type conversion #217

Closed

[dfj](/dfj) opened this issue
Dec 5, 2014
¬∑ 13 comments

Closed

# [Potential remote code execution via dozer's reflection-based type conversion](#top) #217

[dfj](/dfj) opened this issue
Dec 5, 2014
¬∑ 13 comments

Labels
[needs-triaging](/DozerMapper/dozer/labels/needs-triaging)
[possible-bug](/DozerMapper/dozer/labels/possible-bug)

## Comments

[![@dfj](https://avatars.githubusercontent.com/u/1059826?s=80&v=4)](/dfj)

Copy link

### **[dfj](/dfj)** commented [Dec 5, 2014](#issue-51064459)

| Dozer uses a reflection-based approach to type conversion. If dozer is used to map attacker-supplied object instances, then the attacker can provide a dynamic proxy that implements an interface matching what dozer expects, but then use an event handler to execute all methods in that interface. As soon as dozer tries to execute any getter/setter methods, they'll trigger the event handler. So if the attacker declares an event handler like:  EventHandler.create(Collection.class, new ProcessBuilder("/usr/bin/evince"), "start")  Evince will be run as soon as dozer tries to map that object.  The exploitable use case seems to be rather limited so far. There must either be an object being mapped to with a getter/setter method that matches a method in an interface on the server classpath, or a manual XML mapping that allows an attacker to force the issue. Apache Camel supports dozer, so this would be a feasible vector for processing attacker-supplied input. Camel may also allow an attacker to supply an XML mapping (I'm not sure if this is true or not), in which case this would be a pretty serious flaw (at least for Camel). There is, however, one remaining barrier to exploitation in a real-world scenario. How can an attacker provide a malicious proxy instance that survives serialization and deserialization, such that they could feasibly send it to a camel route (or other vulnerable endpoint)?  EventHandler is not serializable, and I couldn't easily find another InvocationHandler that was serializable and would permit this kind of attack. security@apache.org has been notified of this issue and has never replied.  For more details, including a PoC exploit, please see: <https://github.com/pentestingforfunandprofit/research/tree/master/dozer-rce> |
| --- |
| The text was updated successfully, but these errors were encountered: |

 üëç
3
 normuk, abilng, and s50600822 reacted with thumbs up emoji

All reactions

* üëç
  3 reactions

[![@dfj](https://avatars.githubusercontent.com/u/1059826?s=80&v=4)](/dfj)

Copy link

Author

### **[dfj](/dfj)** commented [Dec 14, 2014](#issuecomment-66913121)

| I now have a working exploit achieving RCE if a vulnerable copy of Spring exists on the server classpath; see the github link above. |
| --- |

All reactions

Sorry, something went wrong.

[![@garethahealy](https://avatars.githubusercontent.com/u/8656974?s=80&u=4506b32c4a9ba06371c2af3ad9a41e7a2bf8f504&v=4)](/garethahealy)

Copy link

Collaborator

### **[garethahealy](/garethahealy)** commented [Apr 5, 2017](#issuecomment-291863794)

| [@dfj](https://github.com/dfj) ; can you please provide more info, i.e.: how you would expect to remedy this issue. |
| --- |

All reactions

Sorry, something went wrong.

[![@normuk](https://avatars.githubusercontent.com/u/20976620?s=80&v=4)](/normuk)

Copy link

### **[normuk](/normuk)** commented [May 12, 2017](#issuecomment-301077608)

| I can't help too much, but there is a discussion on an xstream fix here.  <http://xstream.10960.n7.nabble.com/Security-Guidance-to-use-XStream-safely-td8614.html>  It had a similar issue. |
| --- |

All reactions

Sorry, something went wrong.

[![@garethahealy](https://avatars.githubusercontent.com/u/8656974?s=40&u=4506b32c4a9ba06371c2af3ad9a41e7a2bf8f504&v=4)](/garethahealy)
[garethahealy](/garethahealy)
added
[needs-triaging](/DozerMapper/dozer/labels/needs-triaging)
[possible-bug](/DozerMapper/dozer/labels/possible-bug)
labels
[May 31, 2017](#event-1104901886)

[![@hoomanb1](https://avatars.githubusercontent.com/u/3271380?s=80&u=453d322b0e3614dbe77776f593a58a27c0aeab5e&v=4)](/hoomanb1)

Copy link

### **[hoomanb1](/hoomanb1)** commented [Jan 5, 2018](#issuecomment-355464845)

| [@dfj](https://github.com/dfj) , I'm not quite sure if this could be a dozer issue. As far as I understand this, the poc seems to leverages JDK's dynamic proxy to create a malicious proxy object using DefaultAopProxyFactory. So at runtime as soon as a proxy object for that particular instance is created (L#101) the payload gets executed. This process goes on anytime this proxy object gets passed to various code based and eventually reaches dozer's execution point at (L#138). Due to the nature of the Corgi object being an executable proxy, as soon as mapper.map(...) gets called, again the payload gets executed. From then, while the mapping is being performed I can't seem to be able to see any payload execution happening! Am I missing anything here? |
| --- |

All reactions

Sorry, something went wrong.

[![@hoomanb1](https://avatars.githubusercontent.com/u/3271380?s=80&u=453d322b0e3614dbe77776f593a58a27c0aeab5e&v=4)](/hoomanb1)

Copy link

### **[hoomanb1](/hoomanb1)** commented [Jan 11, 2018](#issuecomment-356800263)

| I had a closer look at the poc and I think the serialization/deserialization of dynamic proxy is a little confusing as it does not seem to be related to dozer. If the malicious dynamic proxy object however, gets passed to mapper.map(..) it'll be executed, true. |
| --- |

All reactions

Sorry, something went wrong.

[![@Jos31fr](https://avatars.githubusercontent.com/u/43005575?s=80&v=4)](/Jos31fr)

Copy link

### **[Jos31fr](/Jos31fr)** commented [May 23, 2019](#issuecomment-495212912)

| Is it planned to fix anything? This is reported as a critical vulnerability in NVD database: <https://nvd.nist.gov/vuln/detail/CVE-2014-9515> |
| --- |

All reactions

Sorry, something went wrong.

[![@hohwille](https://avatars.githubusercontent.com/u/1923119?s=80&u=e805696921a0b35921f05c8e5dc6b7b427bc3818&v=4)](/hohwille)

Copy link

### **[hohwille](/hohwille)** commented [Jun 24, 2019](#issuecomment-504926283) ‚Ä¢ edited Loading

| Actually [CVE-2014-9515](https://github.com/advisories/GHSA-q79q-94j7-5mgg "CVE-2014-9515") is related to an old version of springframework while this has been fixed in spring ages ago. The only issue regarding dozer is that it calls arbitrary getters on a given input object. However, this applies to all bean mapping frameworks with such generic design. So the also applies for orika and many others. Claiming this a reasonable security vulnerability in dozer is IMHO unprofessional. You could also construct a dynamic proxy object that does something evil when the `run()` method is called and the pass this to an execution framework and claim that JDK is vulnerable to such security fraud. IMHO this is showing that sometimes CVEs are not always treaded reasonable. Once a CVE is on all these lists then the entire world is scared about using the according tool and if there is no fix they stop using it without questioning or understanding the actual problem. This is like conspiracy... |
| --- |

 üëç
5
 ser0l, jinsem, s50600822, royathan, and joerg-rade reacted with thumbs up emoji

All reactions

* üëç
  5 reactions

Sorry, something went wrong.

[![@Markimedes](https://avatars.githubusercontent.com/u/7154119?s=80&v=4)](/Markimedes)

Copy link

### **[Markimedes](/Markimedes)** commented [Sep 14, 2019](#issuecomment-531429571)

| I'm doing a review of dozer usage in my organization and our composition analysis tools flag dozer for [CVE-2014-9515](https://github.com/advisories/GHSA-q79q-94j7-5mgg "CVE-2014-9515").  If I understand correctly, the justification being given here is that attacker (user) controlled objects should not be passed to mapper.map? However, I don't see any warnings in the documentation, or guidelines for performing secure code reviews of software using dozer. Such warnings would be insufficient, but would indicate to me that dozer developers were concerned with their user's security.  From a security perspective, I'd be inclined to ask teams to simply not use dozer or other mapping tools and write their own setters/getters if this isn't addressed somehow. Convenience and security are always at odds. |
| --- |

All reactions

Sorry, something went wrong.

[![@security-prince](https://avatars.githubusercontent.com/u/5870952?s=80&u=d4218f7cbe0b0b452bab751a0f6117f574131e26&v=4)](/security-prince)

Copy link

### **[security-prince](/security-prince)** commented [Nov 6, 2019](#issuecomment-550241047)

| [@dfj](https://github.com/dfj) [@Markimedes](https://github.com/Markimedes) what is the mitigation you suggest to implement? This got flagged for me also while doing composition analysis |
| --- |

All reactions

Sorry, something went wrong.

[![@JSamir](https://avatars.githubusercontent.com/u/1304599?s=80&v=4)](/JSamir)

Copy link

### **[JSamir](/JSamir)** commented [Aug 10, 2020](#issuecomment-671393046)

| I am not quite sure if this issue is an actual issue based on the answers here... Could the maintainer please clarify this? Thanks :) |
| --- |

All reactions

Sorry, something went wrong.

[![@ser0l](https://avatars.githubusercontent.com/u/26906167?s=80&v=4)](/ser0l)

Copy link

### **[ser0l](/ser0l)** commented [Sep 25, 2020](#issuecomment-698909033) ‚Ä¢ edited Loading

| If I understand correctly, the justification being given here is that attacker (user) controlled objects should not be passed to mapper.map? However, I don't see any warnings in the documentation, or guidelines for performing secure code reviews of software using dozer. Such warnings would be insufficient, but would indicate to me that dozer developers were concerned with their user's security.  As far as I understand, the issue here is not Dozer's fault, but just the way reflection works. hohwille's comment is perfectly reasonable. I don't see why it would need a separate warning for it - it's just the basics of reflection.  This is only a vulnerability if you have another vulnerability in your system, which somehow lets a malicious object through - and the object exploits dozer's mappings to execute its code. The only way to foolproof against this is not to use reflection at all - for example, by using mapstruct for mappings - but marking a whole library with a critical security issue simply because it uses reflection is very weird. |
| --- |

All reactions

Sorry, something went wrong.

[![@dholiday](https://avatars.githubusercontent.com/u/49693669?s=80&u=45a70ce7059f3e8894a68232e88c58eccf59a731&v=4)](/dholiday)

Copy link

### **[dholiday](/dholiday)** commented [Mar 19, 2021](#issuecomment-802938809) ‚Ä¢ edited Loading

| hihi  I'm a security engineer who ended up here because this project got flagged by our dependency scanner. I've read through the discussion thread and it seems as though the consensus of the project maintainers is that the issue is not with Dozer inherently and that, as such, the issue will not be patched. May I ask that someone from the Dozer team contact the CVE-team at Mitre to initiate the dispute process? This way the CVE can get marked as 'vendor disputed' and thus will pop differently on everyone's vulnerability scan reports.  The CVE team at Mitre can be reached via [this form](https://cveform.mitre.org/).  ty!! |
| --- |

 üëç
2
 benDeMtp and danielthegray reacted with thumbs up emoji

All reactions

* üëç
  2 reactions

Sorry, something went wrong.

[![@garethahealy](https://avatars.githubusercontent.com/u/8656974?s=80&u=4506b32c4a9ba06371c2af3ad9a41e7a2bf8f504&v=4)](/garethahealy)

Copy link

Collaborator

### **[garethahealy](/garethahealy)** commented [Apr 7, 2021](#issuecomment-814897170)

| [@dholiday](https://github.com/dholiday) ; the project is not in an active state, I'd suggest you get your devs to migrate away from dozer to fix this warning. |
| --- |

 üëÄ
1
 felickz reacted with eyes emoji

All reactions

* üëÄ
  1 reaction

Sorry, something went wrong.

[![@garethahealy](https://avatars.githubusercontent.com/u/8656974?s=40&u=4506b32c4a9ba06371c2af3ad9a41e7a2bf8f504&v=4)](/garethahealy)
[garethahealy](/garethahealy)
closed this as [completed](/DozerMapper/dozer/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Apr 7, 2021](#event-4562379121)

[![@hohwille](https://avatars.githubusercontent.com/u/1923119?s=40&u=e805696921a0b35921f05c8e5dc6b7b427bc3818&v=4)](/hohwille)
[hohwille](/hohwille)
mentioned this issue
[Sep 22, 2023](#ref-issue-563978583)

[No indication if CVE-2014-9515 is solved
#786](/DozerMapper/dozer/issues/786)

Closed

[![@shelbyc](https://avatars.githubusercontent.com/u/5782553?s=40&v=4)](/shelbyc)
[shelbyc](/shelbyc)
mentioned this issue
[Jan 5, 2024](#ref-pullrequest-2055994404)

[[GHSA-q79q-94j7-5mgg] Dozer improperly uses a reflection-based approach to type...
github/advisory-database#3206](/github/advisory-database/pull/3206)
 Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FDozerMapper%2Fdozer%2Fissues%2F217)

Assignees

No one assigned

Labels

[needs-triaging](/DozerMapper/dozer/labels/needs-triaging)
[possible-bug](/DozerMapper/dozer/labels/possible-bug)

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

11 participants

[![@dfj](https://avatars.githubusercontent.com/u/1059826?s=52&v=4)](/dfj) [![@JSamir](https://avatars.githubusercontent.com/u/1304599?s=52&v=4)](/JSamir) [![@hohwille](https://avatars.githubusercontent.com/u/1923119?s=52&v=4)](/hohwille) [![@hoomanb1](https://avatars.githubusercontent.com/u/3271380?s=52&v=4)](/hoomanb1) [![@security-prince](https://avatars.githubusercontent.com/u/5870952?s=52&v=4)](/security-prince) [![@Markimedes](https://avatars.githubusercontent.com/u/7154119?s=52&v=4)](/Markimedes) [![@garethahealy](https://avatars.githubusercontent.com/u/8656974?s=52&v=4)](/garethahealy) [![@normuk](https://avatars.githubusercontent.com/u/20976620?s=52&v=4)](/normuk) [![@ser0l](https://avatars.githubusercontent.com/u/26906167?s=52&v=4)](/ser0l) [![@Jos31fr](https://avatars.githubusercontent.com/u/43005575?s=52&v=4)](/Jos31fr) [![@dholiday](https://avatars.githubusercontent.com/u/49693669?s=52&v=4)](/dholiday)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.

