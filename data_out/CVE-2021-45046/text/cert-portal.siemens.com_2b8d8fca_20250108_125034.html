Siemens Security Advisory by Siemens ProductCERT

SSA-479842: Apache Log4j Vulnerabilities - Impact to Siemens
Energy Sensformer / Sensgear (Platform, Basic and Advanced)

2021-12-21
Publication Date:
2021-12-23
Last Update:
Current Version:
V1.1
CVSS v3.1 Base Score: 10.0

SUMMARY

On 2021-12-09, a vulnerability in Apache Log4j (a logging tool used in many Java-based applications)
was disclosed, that could allow remote unauthenticated attackers to execute code on vulnerable systems.
The vulnerability is tracked as CVE-2021-44228 and is also known as “Log4Shell”.

On 2021-12-14 an additional denial of service vulnerability (CVE-2021-45046) was published rendering
the initial mitigations and ﬁx in version 2.15.0 as incomplete under certain non-default conﬁgurations.
Log4j versions 2.16.0 and 2.12.2 are supposed to ﬁx both vulnerabilities.

On 2021-12-17, CVE-2021-45046 was reclassiﬁed with an increased CVSS base score (from 3.7 to 9.0).
The potential impact of CVE-2021-45046 now includes - besides denial of service - also information
disclosure and local (and potential remote) code execution. Furthermore, one additional denial of service
vulnerability, CVE-2021-45105, was disclosed.

The Siemens Energy Sensformer / Sensgear cloud service was affected by these vulnerabilities and has
remediated them. No user actions are necessary.

AFFECTED PRODUCTS AND SOLUTION

Affected Product and Versions

Remediation

/ Sensgear Platform (6BK1602-

Sensformer
0AA12-0TP0):
All versions < V2.7.0

/ Sensgear Platform (6BK1602-

Sensformer
0AA22-0TP0):
All versions < V2.7.0

/ Sensgear Platform (6BK1602-

Sensformer
0AA32-0TP0):
All versions < V2.7.0

/ Sensgear Platform (6BK1602-

Sensformer
0AA42-0TP0):
All versions < V2.7.0

/ Sensgear Platform (6BK1602-

Sensformer
0AA52-0TP0):
All versions < V2.7.0

Vulnerabilities ﬁxed on central cloud service be-
tween 2021-12-10 (CVE-2021-44228) and 2021-
12-21 (CVE-2021-45105); no user actions neces-
sary

Vulnerabilities ﬁxed on central cloud service be-
tween 2021-12-10 (CVE-2021-44228) and 2021-
12-21 (CVE-2021-45105); no user actions neces-
sary

Vulnerabilities ﬁxed on central cloud service be-
tween 2021-12-10 (CVE-2021-44228) and 2021-
12-21 (CVE-2021-45105); no user actions neces-
sary

Vulnerabilities ﬁxed on central cloud service be-
tween 2021-12-10 (CVE-2021-44228) and 2021-
12-21 (CVE-2021-45105); no user actions neces-
sary

Vulnerabilities ﬁxed on central cloud service be-
tween 2021-12-10 (CVE-2021-44228) and 2021-
12-21 (CVE-2021-45105); no user actions neces-
sary

SSA-479842

© Siemens 2021

Page 1 of 3

Siemens Security Advisory by Siemens ProductCERT

WORKAROUNDS AND MITIGATIONS

Siemens has not identiﬁed any additional speciﬁc workarounds or mitigations. Please follow the General
Security Recommendations.

Product speciﬁc mitigations can be found in the section Affected Products and Solution.

GENERAL SECURITY RECOMMENDATIONS

Operators of critical power systems (e.g. TSOs or DSOs) worldwide are usually required by regulations to
build resilience into the power grids by applying multi-level redundant secondary protection schemes. It is
therefore recommended that the operators check whether appropriate resilient protection measures are
in place. The risk of cyber incidents impacting the grid’s reliability can thus be minimized by virtue of the
grid design.

Siemens strongly recommends applying the provided security updates using the corresponding tooling
and documented procedures made available with the product. If supported by the product, an automated
means to apply the security updates across multiple product instances may be used. Siemens strongly
recommends prior validation of any security update before being applied, and supervision by trained staff
of the update process in the target environment.

As a general security measure Siemens strongly recommends to protect network access with appropriate
mechanisms (e.g. ﬁrewalls, segmentation, VPN). It is advised to conﬁgure the environment according to
our operational guidelines in order to run the devices in a protected IT environment.

PRODUCT DESCRIPTION

Sensformer / Sensgear contains the necessary sensors for entering the most important operating
parameters – such as oil-level, temperature, LV winding current and GPS-positioning of a transformer.

VULNERABILITY CLASSIFICATION

The vulnerability classiﬁcation has been performed by using the CVSS scoring system in version 3.1
(CVSS v3.1) (https://www.ﬁrst.org/cvss/). The CVSS environmental score is speciﬁc to the customer’s
environment and will impact the overall CVSS score. The environmental score should therefore be
individually deﬁned by the customer to accomplish ﬁnal scoring.

An additional classiﬁcation has been performed using the CWE classiﬁcation, a community-developed list
of common software security weaknesses. This serves as a common language and as a baseline for
weakness identiﬁcation, mitigation, and prevention efforts. A detailed list of CWE classes can be found at:
https://cwe.mitre.org/.

Vulnerability CVE-2021-44228

Apache Log4j V2, versions < 2.15.0 do not protect JNDI features (as used in conﬁguration, log
messages, and parameters) against attacker controlled LDAP and other JNDI related endpoints.

An attacker who can control log messages or log message parameters could execute arbitrary code
loaded from LDAP servers when message lookup substitution is enabled.

CVSS v3.1 Base Score
CVSS Vector
CWE

10.0
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H/E:H/RL:O/RC:C
CWE-20: Improper Input Validation

SSA-479842

© Siemens 2021

Page 2 of 3

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2021-45046

The ﬁx to address CVE-2021-44228 was incomplete in certain non-default conﬁgurations, when
the logging conﬁguration uses a non-default Pattern Layout with a Context Lookup (for example,
${ctx:loginId}).

This could allow attackers with control over Thread Context Map (MDC) input data to craft malicious
input data using a JNDI Lookup pattern, resulting in an information leak and remote code execution in
some environments and local code execution in all environments.

CVSS v3.1 Base Score
CVSS Vector
CWE

9.0
CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-20: Improper Input Validation

Vulnerability CVE-2021-45105

Apache Log4j2 versions 2.0-alpha1 through 2.16.0 did not protect from uncontrolled recursion from
self-referential lookups, when the logging conﬁguration uses a non-default Pattern Layout with a
Context Lookup (for example, $${ctx:loginId}).

This could allow attackers with control over Thread Context Map (MDC) input data to craft malicious
input data that contains a recursive lookup, resulting in a denial of service condition.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-674: Uncontrolled Recursion

ADDITIONAL INFORMATION

For further inquiries on security vulnerabilities in Siemens products and solutions, please contact the
Siemens ProductCERT:

https://www.siemens.com/cert/advisories

HISTORY DATA

V1.0 (2021-12-21):
V1.1 (2021-12-23):

Publication Date
Included Sensgear, clariﬁed product name and summary

TERMS OF USE

Siemens Security Advisories are subject to the terms and conditions contained in Siemens’ underlying
license terms or other applicable agreements previously agreed to with Siemens (hereinafter "License
Terms"). To the extent applicable to information, software or documentation made available in or through
a Siemens Security Advisory, the Terms of Use of Siemens’ Global Website (https://www.siemens.com/
terms_of_use, hereinafter "Terms of Use"), in particular Sections 8-10 of the Terms of Use, shall apply
additionally. In case of conﬂicts, the License Terms shall prevail over the Terms of Use.

SSA-479842

© Siemens 2021

Page 3 of 3

