Page Menu[HomeMiraheze](/)

* SearchConfigure Global Search

[Log In](https://issue-tracker.miraheze.org/auth/start/?next=%2FT12670)[Create Task](/maniphest/task/edit/nocreate/) [Maniphest](/maniphest/)  T12670
# XSS in Special:DataDump's dump status outputClosed, Resolved[Public](/policy/explain/PHID-TASK-hd4lggmyada5diudvkte/view/)Actions

* [Edit Task](/maniphest/task/edit/12670/)
* Edit Related Tasks...
* [Create Subtask](/maniphest/task/subtask/12670/)
* [Edit Parent Tasks](/search/rel/task.has-parent/PHID-TASK-hd4lggmyada5diudvkte/)
* [Edit Subtasks](/search/rel/task.has-subtask/PHID-TASK-hd4lggmyada5diudvkte/)
* [Merge Duplicates In](/search/rel/task.merge-in/PHID-TASK-hd4lggmyada5diudvkte/)
* [Close As Duplicate](/search/rel/task.close-as-duplicate/PHID-TASK-hd4lggmyada5diudvkte/)
* Edit Related Objects...
* [Edit Commits](/search/rel/task.has-commit/PHID-TASK-hd4lggmyada5diudvkte/)
* [Edit Revisions](/search/rel/task.has-revision/PHID-TASK-hd4lggmyada5diudvkte/)
* Subscribe
* [Mute Notifications](/subscriptions/mute/PHID-TASK-hd4lggmyada5diudvkte/)
* [Flag For Later](/flag/edit/PHID-TASK-hd4lggmyada5diudvkte/)
* [Award Token](/token/give/PHID-TASK-hd4lggmyada5diudvkte/)

Assigned To

|  | [BlankEclair](/p/BlankEclair/) |
| --- | --- |

Authored By

|  | [BlankEclair](/p/BlankEclair/) |
| --- | --- |
| Oct 1 2024, 04:092024-10-01 04:09:15 (UTC+0) |

Tags

* [Security](/tag/security/) [(Backlog)](/project/board/58/)
* [DataDump](/tag/datadump/) [(Bugs)](/project/board/45/)
* [Technology-Team (MediaWiki)](/tag/technology-team_mediawiki/) [(Backlog)](/project/board/62/)
Referenced Files

|  | [F3933686: T12670.patch](/F3933686) |
| --- | --- |
| Oct 1 2024, 04:322024-10-01 04:32:42 (UTC+0) |

|  | [F3933582: 2024-10-01\_14-05.png](/F3933582) |
| --- | --- |
| Oct 1 2024, 04:092024-10-01 04:09:15 (UTC+0) |

Subscribers

|  | [Agent\_Isai](/p/Agent_Isai/) |
| --- | --- |

|  | [BlankEclair](/p/BlankEclair/) |
| --- | --- |

|  | [BrandonWM](/p/BrandonWM/) |
| --- | --- |

|  | [Universal\_Omega](/p/Universal_Omega/) |
| --- | --- |

|  | [Void](/p/Void/) |
| --- | --- |

# Description

With an existing dump, [http://mw142.icecone.internal/wiki/Special:DataDump?uselang=x-xss](http://mw142.icecone.internal/wiki/Special%3ADataDump?uselang=x-xss) (adjust URL as needed of course):

[![2024-10-01_14-05.png (976×1 px, 492 KB)](https://phorge-static.wikitide.net/file/data/4ky7gwe64kvusfk2dnvc/PHID-FILE-sqnmyh7u5erxfsxebx5x/preview-2024-10-01_14-05.png)](https://phorge-static.wikitide.net/file/data/uno3d7qqeqbxjlwuqdyb/PHID-FILE-rjjlwwgp7j73ybckxpm2/2024-10-01_14-05.png)

One use of unescaped interface messages: <https://github.com/miraheze/DataDump/blob/2c33334df4b31cf800b04dc9c9509f5008e98578/includes/DataDumpPager.php#L82-L94>

The alert is triggered twice, so there's probably somewhere else that's also not escaped

### Event Timeline

[BlankEclair](/p/BlankEclair/) created this task.[Oct 1 2024, 04:092024-10-01 04:09:15 (UTC+0)](#254169)[Herald](/herald/) added subscribers: [Agent\_Isai](/p/Agent_Isai/), [Universal\_Omega](/p/Universal_Omega/), [Void](/p/Void/).  · [View Herald Transcript](/herald/transcript/159486/)[Oct 1 2024, 04:092024-10-01 04:09:16 (UTC+0)](#254179)[BlankEclair](/p/BlankEclair/) moved this task from [Backlog](/project/board/45/) to [Bugs](/project/board/45/) on the [DataDump](/tag/datadump/) board.[Oct 1 2024, 04:092024-10-01 04:09:30 (UTC+0)](#254180)

[BlankEclair](/p/BlankEclair/) claimed this task.[Oct 1 2024, 04:302024-10-01 04:30:01 (UTC+0)](#254181)Comment Actions

Nope, looks like the x-xss language calls alert twice

[BlankEclair](/p/BlankEclair/) added a comment.[Oct 1 2024, 04:322024-10-01 04:32:42 (UTC+0)](#254184)Comment Actions

T12670.patch1 KB[Download](https://phorge-static.wikitide.net/file/download/3ifhj5p45maaxi2mxcpx/PHID-FILE-l2iick3roip75qnhgmkt/T12670.patch)

[BlankEclair](/p/BlankEclair/) added a comment.[Oct 2 2024, 09:272024-10-02 09:27:13 (UTC+0)](#254354)Comment Actions

Advisory: <https://github.com/miraheze/DataDump/security/advisories/GHSA-h8x8-24c7-r2rj>

[BlankEclair](/p/BlankEclair/) closed this task as Resolved.[Oct 2 2024, 09:352024-10-02 09:35:39 (UTC+0)](#254355)[BlankEclair](/p/BlankEclair/) changed the visibility from "[Custom Policy](/transactions/old/PHID-XACT-TASK-jvt7nycyjx5bg5x/)" to "Public (No Login Required)".[Oct 2 2024, 09:392024-10-02 09:39:02 (UTC+0)](#254356)[BlankEclair](/p/BlankEclair/) changed the edit policy from "[Custom Policy](/transactions/old/PHID-XACT-TASK-m26ujico6l6iw43/)" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-m26ujico6l6iw43/)".[Herald](/herald/) added a subscriber: [BrandonWM](/p/BrandonWM/).  · [View Herald Transcript](/herald/transcript/159556/)[Oct 2 2024, 09:392024-10-02 09:39:02 (UTC+0)](#254358)[Log In to Comment](/login/?next=%2FT12670)