- **Root cause of vulnerability**: The vulnerability stems from multiple out-of-bounds read issues within the `CLIPSP.SYS` driver when handling license data of type `0x1`. Specifically, the driver fails to properly validate the size of the data blob, leading to reads beyond the allocated buffer.
- **Weaknesses/vulnerabilities present**:
  - Out-of-bounds read vulnerability (CWE-125): Multiple instances of out-of-bounds reads occur due to missing size checks when processing a malformed type 0x1 license blob. The code dereferences pointers without verifying if they point to valid memory locations.
- **Impact of exploitation**:
  - Information disclosure: By exploiting these out-of-bounds read vulnerabilities, an attacker can potentially leak sensitive information from kernel memory. The leaked data can then be exposed to userland via the `ClipSpGetLicenseChallange` function, which uses the data read out-of-bounds to generate a challenge.
- **Attack vectors**:
  - A specially crafted license blob, with a tampered type `0x1` blob, is required to trigger the vulnerability.
  - The attack is triggered using the `NtQuerySystemInformation` function call with the `SystemPolicyInformation` class and `command_id`: 100 (`SPCallServerHandleUpdateLicense`).
- **Required attacker capabilities/position**:
  - The attacker needs to be able to call `NtQuerySystemInformation` with the `SystemPolicyInformation` class, suggesting the attack can be launched from userland.
  - The attacker needs to be able to supply a crafted license blob with a malformed type `0x1` entry, which might require bypassing signature verification on the license file.