The provided content details a SQL injection vulnerability in the `my-springsecurity-plus` project, specifically within the `/api/dept/build` endpoint.

**Root cause of vulnerability:**

*   The vulnerability stems from the use of `${}` to directly embed user-controlled input (`params.dataScope`) into SQL queries within the `DeptMapper.xml` file. This allows for SQL injection by manipulating the `dataScope` parameter.

**Weaknesses/vulnerabilities present:**

*   **SQL Injection:** The application is vulnerable to SQL injection due to the insecure concatenation of user-provided input into SQL queries. Specifically, the `dataScope` parameter is not properly sanitized, allowing attackers to inject arbitrary SQL code.
*   **Lack of Input Sanitization:** The application fails to properly sanitize or validate user inputs before incorporating them into SQL queries, which is the root cause of this vulnerability.

**Impact of exploitation:**

*   **Data Breach:** Attackers can potentially extract sensitive data from the database by injecting arbitrary SQL queries.
*   **Data Manipulation:** Attackers can modify or delete data within the database through SQL injection.
*   **Potential for Further Exploitation:** This can lead to unauthorized access or further system compromise if the application's user or database user permissions allow it.

**Attack vectors:**

*   **HTTP Request Parameter Manipulation:** The attack vector is through manipulating the `params.dataScope` parameter within the HTTP request to the `/api/dept/build` endpoint.
*   **Direct Parameter Injection:** The vulnerability is exploited by directly injecting malicious SQL code via the `dataScope` parameter.

**Required attacker capabilities/position:**

*   **Network Access:** The attacker needs to be able to send HTTP requests to the vulnerable endpoint `/api/dept/build`.
*   **Knowledge of Vulnerable Parameter:** The attacker needs to know to manipulate the `params.dataScope` parameter to inject SQL code.
*   **General web application knowledge:** The attacker needs an understanding of web application architecture, http requests, and SQL.
*   **Optional tools:** While not explicitly required, the exploit was demonstrated using `sqlmap`, an automated SQL injection tool.

**Additional Details:**

*   The issue was identified by Chaitin Security Research Lab.
*   The affected versions are before 2024.07.03.
*   The vulnerability can be exploited with a bool blind injection attack.
*   The provided proof-of-concept (POC) demonstrates how to use `sqlmap` to extract data.
*   The vulnerability is located in the `DeptMapper.xml`, `DeptDao.java`, and `DeptServiceImpl.java`, and is accessible through `deptDto` in the controller. The `params.dataScope` can be controlled via a `Map`.
*   The attacker can use something like `http://localhost:8088/api/dept/build?params%5B%22dataScope%22%5D=1` as a starting point to craft malicious injection strings.