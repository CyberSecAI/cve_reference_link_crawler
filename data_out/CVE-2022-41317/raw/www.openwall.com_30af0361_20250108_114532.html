<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>oss-security - Fwd: [ADVISORY] SQUID-2022:1 Exposure of Sensitive Information in
 Cache Manager</title>

<link href="/style.css" type="text/css" rel="stylesheet">
<style type="text/css">
.calendar { text-align: center; }
.ccell { background: #ccc; width: 5ex; padding: 2px; }

.cal_brief { text-align: center; }
.cal_brief td:first-child { background: inherit; }
.cal_brief td { background: #ccc; width: 5ex; padding: 2px; }
.cal_big { text-align: center; padding: 0; margin: 0; }
.cal_big td { padding: 0 2px; }
.cal_mon { text-align: center; }
.cal_mon th { font-size: small; padding: 0; margin: 0; }
.cal_mon td { background: #ccc; width: 5ex; height: 1.5em;
	padding: 2px; text-align: right; }
.cal_mon td[colspan] { background: inherit; }
.cal_mon sup { color: #F0F0F0; text-align: left; float: left;
	margin-top: -2pt; font-weight: bold; }
.cal_mon a { text-align: right; margin-left: -4em; float: right; }
</style>
</head>

<BODY bgcolor="#E0E0E0" text="black" link="blue" alink="red" vlink="navy">


<table bgcolor="#ffffff" width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>

<td>
<a href="/"><img class="logo" src="/logo.png" border="0" width="182" height="80" alt="Openwall"></a>
<td width="100%">
<div class="nav">
<ul>
<li><a href="/">Products</a>
<ul>
<li><a href="/Owl/">Openwall GNU/*/Linux &nbsp; <i>server OS</i></a>
<li><a href="/lkrg/">Linux Kernel Runtime Guard</a>
<li><a href="/john/">John the Ripper &nbsp; <i>password cracker</i></a>
<ul>
<li><a href="/john/">Free &amp; Open Source for any platform</a>
<li><a href="/john/cloud/">in the cloud</a>
<li><a href="/john/pro/linux/">Pro for Linux</a>
<li><a href="/john/pro/macosx/">Pro for macOS</a>
</ul>
<li><a href="/wordlists/">Wordlists &nbsp; <i>for password cracking</i></a>
<li><a href="/passwdqc/">passwdqc &nbsp; <i>policy enforcement</i></a>
<ul>
<li><a href="/passwdqc/">Free &amp; Open Source for Unix</a>
<li><a href="/passwdqc/windows/">Pro for Windows (Active Directory)</a>
</ul>
<li><a href="/yescrypt/">yescrypt &nbsp; <i>KDF &amp; password hashing</i></a>
<li><a href="/yespower/">yespower &nbsp; <i>Proof-of-Work (PoW)</i></a>
<li><a href="/crypt/">crypt_blowfish &nbsp; <i>password hashing</i></a>
<li><a href="/phpass/">phpass &nbsp; <i>ditto in PHP</i></a>
<li><a href="/tcb/">tcb &nbsp; <i>better password shadowing</i></a>
<li><a href="/pam/">Pluggable Authentication Modules</a>
<li><a href="/scanlogd/">scanlogd &nbsp; <i>port scan detector</i></a>
<li><a href="/popa3d/">popa3d &nbsp; <i>tiny POP3 daemon</i></a>
<li><a href="/blists/">blists &nbsp; <i>web interface to mailing lists</i></a>
<li><a href="/msulogin/">msulogin &nbsp; <i>single user mode login</i></a>
<li><a href="/php_mt_seed/">php_mt_seed &nbsp; <i>mt_rand() cracker</i></a>
</ul>
<li><a href="/services/">Services</a>
<li id="narrow-li-1"><a>Publications</a>
<ul>
<li><a href="/articles/">Articles</a>
<li><a href="/presentations/">Presentations</a>
</ul>
<li><a>Resources</a>
<ul>
<li><a href="/lists/">Mailing lists</a>
<li><a href="https://openwall.info/wiki/">Community wiki</a>
<li><a href="https://github.com/openwall">Source code repositories (GitHub)</a>
<li><a href="https://cvsweb.openwall.com">Source code repositories (CVSweb)</a>
<li><a href="/mirrors/">File archive &amp; mirrors</a>
<li><a href="/signatures/">How to verify digital signatures</a>
<li><a href="/ove/">OVE IDs</a>
</ul>
<li id="last-li"><a href="/news">What's new</a>
</ul>
</div>


</table>


<TABLE bgcolor="#B4D0DC" width="100%" border="0" cellspacing="0" cellpadding="1">
<TR><TD>
<TABLE width="100%" border="0" cellspacing="0" cellpadding="2">
<TR><TD bgcolor="#ECF8FF">
<a href="https://hashsuite.openwall.net">
Hash Suite - Windows password security audit tool. GUI, reports in PDF.</a>

</TABLE>
</TABLE>

<a href="../../../2022/09/22/10">[&lt;prev]</a> <a href="2">[next&gt;]</a> <a href=".">[day]</a> <a href="..">[month]</a> <a href="../..">[year]</a> <a href="../../..">[list]</a>
<pre style="white-space: pre-wrap">
Message-ID: &lt;c5c0fa6c-f24e-b23f-01c2-5efd648d4f02&#64;treenet.co.nz&gt;
Date: Fri, 23 Sep 2022 17:00:16 +1200
From: Amos Jeffries &lt;squid3&#64;...enet.co.nz&gt;
To: oss-security&#64;...ts.openwall.com
Subject: Fwd: [ADVISORY] SQUID-2022:1 Exposure of Sensitive Information in
 Cache Manager

_________________________________________________________________

     Squid Proxy Cache Security Update Advisory SQUID-2022:1
__________________________________________________________________

Advisory ID:       | SQUID-2022:1
Date:              | September 23, 2022
Summary:           | Exposure of Sensitive Information
                    | in Cache Manager
Affected versions: | Squid 4.15 -&gt; 4.17
                    | Squid 5.0.6 -&gt; 5.6
Fixed in version:  | Squid 5.7
__________________________________________________________________

&lt;<a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-41317" rel="nofollow">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-41317</a>&gt;
__________________________________________________________________

Problem Description:

  Due to inconsistent handling of internal URIs Squid is
  vulnerable to Exposure of Sensitive Information about clients
  using the proxy.

__________________________________________________________________

Severity:

  This problem allows a trusted client to directly access cache
  manager information bypassing the manager ACL protection.

  The available cache manager information contains records of
  internal network structure, client credentials, client identity
  and client traffic behaviour.

CVSS Score of 6.4
&lt;<a href="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N/E:F/RL:X/RC:C/CR:M/IR:X/AR:X/MAV:X/MAC:L/MPR:L/MUI:X/MS:X/MC:H/MI:X/MA:X&amp;version=3.1" rel="nofollow">https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N/E:F/RL:X/RC:C/CR:M/IR:X/AR:X/MAV:X/MAC:L/MPR:L/MUI:X/MS:X/MC:H/MI:X/MA:X&amp;version=3.1</a>&gt;

__________________________________________________________________

Updated Packages:

This bug is fixed by Squid version 5.7.

  In addition, patches addressing this problem for the stable
  releases can be found in our patch archives:

Squid 4:
  &lt;<a href="http://www.squid-cache.org/Versions/v4/changesets/SQUID-2022_1.patch" rel="nofollow">http://www.squid-cache.org/Versions/v4/changesets/SQUID-2022_1.patch</a>&gt;

Squid 5:
  &lt;<a href="http://www.squid-cache.org/Versions/v5/changesets/SQUID-2022_1.patch" rel="nofollow">http://www.squid-cache.org/Versions/v5/changesets/SQUID-2022_1.patch</a>&gt;

  If you are using a prepackaged version of Squid then please refer
  to the package vendor for availability information on updated
  packages.

__________________________________________________________________

Determining if your version is vulnerable:

  Squid older than 4.9 are not vulnerable.

  All Squid-4.9 up to and including 4.14 have not been tested, but
  should be assumed to be vulnerable.

  All Squid-4.15 up to and including 4.17 are vulnerable.

  All Squid-5.0.6 up to and including 5.6 are vulnerable.

__________________________________________________________________

Workaround:

   Add the following to squid.conf:

     acl manager url_regex +i ^[^:]+://[^/]+/squid-internal-mgr/

__________________________________________________________________

Contact details for the Squid project:

  For installation / upgrade support on binary packaged versions
  of Squid: Your first point of contact should be your binary
  package vendor.

  If you install and build Squid from the original Squid sources
  then the &lt;squid-users&#64;...ts.squid-cache.org&gt; mailing list is your
  primary support point. For subscription details see
  &lt;<a href="http://www.squid-cache.org/Support/mailing-lists.html" rel="nofollow">http://www.squid-cache.org/Support/mailing-lists.html</a>&gt;.

  For reporting of non-security bugs in the latest STABLE release
  the squid bugzilla database should be used
  &lt;<a href="http://bugs.squid-cache.org/" rel="nofollow">http://bugs.squid-cache.org/</a>&gt;.

  For reporting of security sensitive bugs send an email to the
  &lt;squid-bugs&#64;...ts.squid-cache.org&gt; mailing list. It's a closed
  list (though anyone can post) and security related bug reports
  are treated in confidence until the impact has been established.

__________________________________________________________________

Credits:

  This vulnerability was discovered by Mikhail Evdokimov
  (aka konata).

  Initial fix by Amos Jeffries of Treehouse Networks Ltd.

__________________________________________________________________

Revision history:

  2022-04-17 18:30:52 UTC Initial Report
  2022-08-08 11:01:47 UTC Initial Fix released
  2022-09-23 05:00:00 UTC Advisory Released
__________________________________________________________________
END

<span style="font-family: times;"><strong>Download attachment "</strong><a href="1/1" rel="nofollow" download>OpenPGP_0x00D863679420BDD3.asc</a><strong>" of type "</strong>application/pgp-keys<strong>" (3135 bytes)</strong></span>

<span style="font-family: times;"><strong>Download attachment "</strong><a href="1/2" rel="nofollow" download>OpenPGP_signature</a><strong>" of type "</strong>application/pgp-signature<strong>" (841 bytes)</strong></span>
</pre>
<p><a href="https://www.openwall.com/blists/">Powered by blists</a> - <a href="https://lists.openwall.net">more mailing lists</a>


<p>
Please check out the
<a href="https://oss-security.openwall.org/wiki/">
Open Source Software Security Wiki</a>, which is counterpart to this
<a href="https://oss-security.openwall.org/wiki/mailing-lists/oss-security">mailing list</a>.
<p>
Confused about <a href="/lists/">mailing lists</a> and their use?
<a href="https://en.wikipedia.org/wiki/Electronic_mailing_list">Read about mailing lists on Wikipedia</a>
and check out these
<a href="https://www.complang.tuwien.ac.at/anton/mail-news-errors.html">guidelines on proper formatting of your messages</a>.
<p>

</body>
</html>
