=== Content from github.com_c89fd9f7_20250111_000212.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmiraheze%2FManageWiki%2Fcommit%2F2ef0f50880d7695ca2874dc8dd515b2b9bbb02e5)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmiraheze%2FManageWiki%2Fcommit%2F2ef0f50880d7695ca2874dc8dd515b2b9bbb02e5)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=miraheze%2FManageWiki)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[miraheze](/miraheze)
/
**[ManageWiki](/miraheze/ManageWiki)**
Public

* [Notifications](/login?return_to=%2Fmiraheze%2FManageWiki) You must be signed in to change notification settings
* [Fork
  28](/login?return_to=%2Fmiraheze%2FManageWiki)
* [Star
   32](/login?return_to=%2Fmiraheze%2FManageWiki)

* [Code](/miraheze/ManageWiki)
* [Pull requests
  10](/miraheze/ManageWiki/pulls)
* [Actions](/miraheze/ManageWiki/actions)
* [Security](/miraheze/ManageWiki/security)
* [Insights](/miraheze/ManageWiki/pulse)

Additional navigation options

* [Code](/miraheze/ManageWiki)
* [Pull requests](/miraheze/ManageWiki/pulls)
* [Actions](/miraheze/ManageWiki/actions)
* [Security](/miraheze/ManageWiki/security)
* [Insights](/miraheze/ManageWiki/pulse)

## Commit

[Permalink](/miraheze/ManageWiki/commit/2ef0f50880d7695ca2874dc8dd515b2b9bbb02e5)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Escape some more interface messages

[Browse files](/miraheze/ManageWiki/tree/2ef0f50880d7695ca2874dc8dd515b2b9bbb02e5)
Browse the repository at this point in the history

* Loading branch information

[![@redbluegreenhat](https://avatars.githubusercontent.com/u/107424288?s=40&v=4)](/redbluegreenhat)

[redbluegreenhat](/miraheze/ManageWiki/commits?author=redbluegreenhat "View all commits by redbluegreenhat")
authored
Feb 9, 2024

1 parent
[886cc6b](/miraheze/ManageWiki/commit/886cc6b94587f1c7387caa26ca9fe612e01836a0)

commit 2ef0f50

Showing
**1 changed file**
with
**5 additions**
and
**5 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

10 changes: 5 additions & 5 deletions

10
[includes/FormFactory/ManageWikiFormFactoryBuilder.php](#diff-468197a8b7ba15a6f4d4cf8b2cc91ef7a4f5c957ce636fee27d9f5121d489756 "includes/FormFactory/ManageWikiFormFactoryBuilder.php")

Show comments

[View file](/miraheze/ManageWiki/blob/2ef0f50880d7695ca2874dc8dd515b2b9bbb02e5/includes/FormFactory/ManageWikiFormFactoryBuilder.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -670,16 +670,16 @@ private static function buildDescriptorPermissions( |
|  |  | $rowsBuilt = []; |
|  |  |  |
|  |  | foreach ( $groupData['allGroups'] as $group ) { |
|  |  | $rowsBuilt[UserGroupMembership::getGroupName( $group )] = $group; |
|  |  | $rowsBuilt[htmlspecialchars( UserGroupMembership::getGroupName( $group ) )] = $group; |
|  |  | } |
|  |  |  |
|  |  | $formDescriptor['group-matrix'] = [ |
|  |  | 'type' => 'checkmatrix', |
|  |  | 'columns' => [ |
|  |  | wfMessage( 'managewiki-permissions-addall' )->text() => 'wgAddGroups', |
|  |  | wfMessage( 'managewiki-permissions-removeall' )->text() => 'wgRemoveGroups', |
|  |  | wfMessage( 'managewiki-permissions-addself' )->text() => 'wgGroupsAddToSelf', |
|  |  | wfMessage( 'managewiki-permissions-removeself' )->text() => 'wgGroupsRemoveFromSelf' |
|  |  | wfMessage( 'managewiki-permissions-addall' )->escaped() => 'wgAddGroups', |
|  |  | wfMessage( 'managewiki-permissions-removeall' )->escaped() => 'wgRemoveGroups', |
|  |  | wfMessage( 'managewiki-permissions-addself' )->escaped() => 'wgGroupsAddToSelf', |
|  |  | wfMessage( 'managewiki-permissions-removeself' )->escaped() => 'wgGroupsRemoveFromSelf' |
|  |  | ], |
|  |  | 'rows' => $rowsBuilt, |
|  |  | 'section' => 'group', |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `2ef0f50`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmiraheze%2FManageWiki%2Fcommit%2F2ef0f50880d7695ca2874dc8dd515b2b9bbb02e5) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from issue-tracker.miraheze.org_faf26ccf_20250111_000215.html ===
Page Menu[HomeMiraheze](/)

* SearchConfigure Global Search

[Log In](https://issue-tracker.miraheze.org/auth/start/?next=%2FT11812)[Create Task](/maniphest/task/edit/nocreate/) [Maniphest](/maniphest/)  T11812
# Numerous confirmed XSS in ManageWikiClosed, Resolved[Public](/policy/explain/PHID-TASK-fuawayrvbphxpxxdl7em/view/)Actions

* [Edit Task](/maniphest/task/edit/11812/)
* Edit Related Tasks...
* [Create Subtask](/maniphest/task/subtask/11812/)
* [Edit Parent Tasks](/search/rel/task.has-parent/PHID-TASK-fuawayrvbphxpxxdl7em/)
* [Edit Subtasks](/search/rel/task.has-subtask/PHID-TASK-fuawayrvbphxpxxdl7em/)
* [Merge Duplicates In](/search/rel/task.merge-in/PHID-TASK-fuawayrvbphxpxxdl7em/)
* [Close As Duplicate](/search/rel/task.close-as-duplicate/PHID-TASK-fuawayrvbphxpxxdl7em/)
* Edit Related Objects...
* [Edit Commits](/search/rel/task.has-commit/PHID-TASK-fuawayrvbphxpxxdl7em/)
* [Edit Revisions](/search/rel/task.has-revision/PHID-TASK-fuawayrvbphxpxxdl7em/)
* Subscribe
* [Mute Notifications](/subscriptions/mute/PHID-TASK-fuawayrvbphxpxxdl7em/)
* [Flag For Later](/flag/edit/PHID-TASK-fuawayrvbphxpxxdl7em/)
* [Award Token](/token/give/PHID-TASK-fuawayrvbphxpxxdl7em/)

Assigned To

|  | [OrangeStar](/p/OrangeStar/) |
| --- | --- |

Authored By

|  | [Universal\_Omega](/p/Universal_Omega/) |
| --- | --- |
| Feb 7 2024, 17:452024-02-07 17:45:21 (UTC+0) |

Tags

* [Security](/tag/security/) [(Backlog)](/project/board/58/)
* [Technology-Team (MediaWiki)](/tag/technology-team_mediawiki/) [(Short Term)](/project/board/62/)
* [ManageWiki](/tag/managewiki/) [(Bugs)](/project/board/26/)
Referenced Files

|  | [F2714020: 0005-No-need-to-escape-this-one.patch](/F2714020) |
| --- | --- |
| Feb 8 2024, 10:252024-02-08 10:25:03 (UTC+0) |

|  | [F2714017: 0003-Revert-Attempt-at-fixing-the-permissions-XSS.patch](/F2714017) |
| --- | --- |
| Feb 8 2024, 10:202024-02-08 10:20:55 (UTC+0) |

|  | [F2714018: 0004-Fix-the-permissions-XSS.patch](/F2714018) |
| --- | --- |
| Feb 8 2024, 10:202024-02-08 10:20:55 (UTC+0) |

|  | [F2713442: 0002-Attempt-at-fixing-the-permissions-XSS.patch](/F2713442) |
| --- | --- |
| Feb 7 2024, 19:482024-02-07 19:48:14 (UTC+0) |

|  | [F2713428: 0001-Escape-some-i18n.patch](/F2713428) |
| --- | --- |
| Feb 7 2024, 19:342024-02-07 19:34:48 (UTC+0) |

|  | [F2713382: 0001-SECURITY-Escape-the-managewiki-requires-and-managewi.patch](/F2713382) |
| --- | --- |
| Feb 7 2024, 18:422024-02-07 18:42:54 (UTC+0) |

Subscribers

|  | [AmandaCath](/p/AmandaCath/) |
| --- | --- |

|  | [BrandonWM](/p/BrandonWM/) |
| --- | --- |

|  | [Joritochip](/p/Joritochip/) |
| --- | --- |

|  | [OrangeStar](/p/OrangeStar/) |
| --- | --- |

|  | [Paladox](/p/Paladox/) |
| --- | --- |

|  | [Reception123](/p/Reception123/) |
| --- | --- |

|  | [Universal\_Omega](/p/Universal_Omega/) |
| --- | --- |

|  | [Void](/p/Void/) |
| --- | --- |

# Description

See [https://meta.mirabeta.org/wiki/Special:ManageWiki/permissions/bureaucrat?uselang=x-xss](https://meta.mirabeta.org/wiki/Special%3AManageWiki/permissions/bureaucrat?uselang=x-xss)

WARNING: THAT WILL LAUNCH JAVASCRIPT ALERT MESSAGES IN YOUR BROWSER IF YOU HAVE JS ENABLED!
### Event Timeline

[Universal\_Omega](/p/Universal_Omega/) created this task.[Feb 7 2024, 17:452024-02-07 17:45:21 (UTC+0)](#236774)[Herald](/herald/) added a project: [Technology-Team (MediaWiki)](/tag/technology-team_mediawiki/).  · [View Herald Transcript](/herald/transcript/150217/)[Feb 7 2024, 17:452024-02-07 17:45:21 (UTC+0)](#236783)[Universal\_Omega](/p/Universal_Omega/) added a subscriber: [OrangeStar](/p/OrangeStar/).[Feb 7 2024, 17:462024-02-07 17:46:22 (UTC+0)](#236784)[Universal\_Omega](/p/Universal_Omega/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-5wk6a3xqpqjormf/)[Feb 7 2024, 17:492024-02-07 17:49:29 (UTC+0)](#236785)

[OrangeStar](/p/OrangeStar/) added a comment.[Feb 7 2024, 17:502024-02-07 17:50:25 (UTC+0)](#236786)Comment Actions

/extensions and /settings confirmed busted. /core doesn't give any alerts.

On /extensions, the alerts involve the managewiki-conflicts and managewiki-requires messages.

[OrangeStar](/p/OrangeStar/) added a comment.[Feb 7 2024, 18:292024-02-07 18:29:24 (UTC+0)](#236787)Comment Actions

<https://github.com/miraheze/ManageWiki/blob/75510297a32ed8881c98212f29001d226f0a833e/includes/FormFactory/ManageWikiFormFactoryBuilder.php#L269> where required and conflicting extensions are added to the form.

generated HTML, tidified.

```
<span class='oo-ui-fieldLayout-header'>
											<label for='ooui-php-30' class='oo-ui-labelElement-label'>&lt;script&gt;alert('managewiki-extension-name')&lt;/script&gt;"&gt;&lt;script&gt;alert('managewiki-extension-name')&lt;/script&gt;&lt;x y="(: <a class="external free" href="https://www.mediawiki.org/wiki/Special:MyLanguage/Extension:Cargo">https://www.mediawiki.org/wiki/Special:MyLanguage/Extension:Cargo</a>, &lt;script&gt;alert('cargo-extensionname')&lt;/script&gt;"&gt;&lt;script&gt;alert('cargo-extensionname')&lt;/script&gt;&lt;x y="()) </label>
											<label for='ooui-php-30' class='oo-ui-inline-help oo-ui-widget oo-ui-widget-enabled oo-ui-labelElement-label oo-ui-labelElement oo-ui-labelWidget'>
												<script>
													alert('managewiki-conflicts')
												</script>"> <script>
													alert('managewiki-conflicts')
												</script>
												<x y="() semanticmediawiki
													<br/>
													<script>alert('managewiki-requires')</script>">
													<script>
														alert('managewiki-requires')
													</script>
													<x y="(): Permissions - managewiki-restricted
														<br/> &lt;script&gt;alert('cargo-desc')&lt;/script&gt;" &gt;&lt;script&gt;alert('cargo-desc')&lt;/script&gt;&lt;x y="()
														<br/>Stewards: it is recommended to not enable this extension on wikis with more than
														<b>50,000</b> pages. This includes all pages,
														<b>not</b> only content pages. Please use discretion.
													</label>
												</span>
```

so it seems to be in our usage of labels for the extensions form. I would like to test some patches privately on mirabeta, not sure how possible that would be.

[OrangeStar](/p/OrangeStar/) added a comment.Edited · [Feb 7 2024, 18:422024-02-07 18:42:54 (UTC+0)](#236791)Comment Actions

Looking at meta.miraheze.org, that is indeed supposed to be the "label" (it is not actually a label HTML element)

Attaching my patch for the extensions subpage now, I think this should fix that at least.0001-SECURITY-Escape-the-managewiki-requires-and-managewi.patch1 KB[Download](https://phorge-static.wikitide.net/file/download/uz3ied6sp2r3jd2cbcvu/PHID-FILE-7gtzujdcqxabko2q7aey/0001-SECURITY-Escape-the-managewiki-requires-and-managewi.patch)

[OrangeStar](/p/OrangeStar/) added a comment.[Feb 7 2024, 18:582024-02-07 18:58:26 (UTC+0)](#236792)Comment Actions

Assuming that patch fixes that for the extensions subpage, I can more or less make a theory (the form descriptor is passed around through so many functions that it is hard to keep track).

See how we use HTML for the description of extensions in ManageWikiExtensions.php (at LS.php) ? That means raw mode is somewhere set for that element in the form descriptor. See this HTML from meta.miraheze.org:

```
<label for="ooui-php-367" class="oo-ui-inline-help oo-ui-widget oo-ui-widget-enabled oo-ui-labelElement-label oo-ui-labelElement oo-ui-labelWidget">Requires: Permissions - managewiki-restricted <br> Making your wiki more accessible - for machines <i>and</i> humans ( <a rel="nofollow" class="external text" href="https://www.semantic-mediawiki.org/wiki/Help:User_manual">online documentation</a>) <br>
	<br> Permanently "experimental" and may be removed with little to no prior notice. WARNING: Disabling this extension after it's already been enabled will clear all SemanticMediaWiki database tables as well. <br>
	<b>Note: <a href="https://meta.miraheze.org/wiki/Special:MyLanguage/Stewards" target="_blank">Stewards</a>, please ensure that a member of the <a href="https://meta.miraheze.org/wiki/Special:MyLanguage/Tech:SRE_Volunteers" target="_blank">Site Reliability Engineering</a> team is available and not mobile in order to run <a href="https://meta.miraheze.org/wiki/Tech:Semantic_MediaWiki" target="_blank">a series of commands</a> on mwtask181 after enabling this. </b>
</label>
```

Those interface messages are used in the label element! Since raw mode is set for this entry on the formdescriptor, and those i18n messages are included the content of this element, there we have our XSS vector.

Something very similar must be going on on the other subpages.

[OrangeStar](/p/OrangeStar/) claimed this task.[Feb 7 2024, 19:062024-02-07 19:06:25 (UTC+0)](#236793)Comment Actions

I think I know what is causing this, so I'll try to get this fixed tomorrow at the latest.

[OrangeStar](/p/OrangeStar/) added a comment.[Feb 7 2024, 19:092024-02-07 19:09:24 (UTC+0)](#236795)Comment Actions

Also, just to clarify my previous message.

IN the case of the extensions subpage, the vulnerability is that unescaped interface messages are being included in the help element of formdescriptor elements that have raw mode enabled.

[OrangeStar](/p/OrangeStar/) added a comment.Edited · [Feb 7 2024, 19:342024-02-07 19:34:48 (UTC+0)](#236807)Comment Actions

New patch superseding the other patch. Only thing missing is I think the XSS on the permissions subpage, which seems a bit more complex.

0001-Escape-some-i18n.patch2 KB[Download](https://phorge-static.wikitide.net/file/download/6ouigp3sg7pdz26psnki/PHID-FILE-74ljr6o3s6uuovoe2tcf/0001-Escape-some-i18n.patch)

[Universal\_Omega](/p/Universal_Omega/) added a comment.[Feb 7 2024, 19:472024-02-07 19:47:36 (UTC+0)](#236819)Comment Actions

Confirmed in Special:ManageWikiDefaultPermissions also

[OrangeStar](/p/OrangeStar/) added a comment.[Feb 7 2024, 19:482024-02-07 19:48:14 (UTC+0)](#236821)Comment Actions

0002-Attempt-at-fixing-the-permissions-XSS.patch1 KB[Download](https://phorge-static.wikitide.net/file/download/ontj6vn5qa7impqqkata/PHID-FILE-bav3hdovgxmrvkpqkkvh/0002-Attempt-at-fixing-the-permissions-XSS.patch)

[OrangeStar](/p/OrangeStar/) added a comment.[Feb 7 2024, 20:072024-02-07 20:07:02 (UTC+0)](#236822)Comment Actions

Yeah there's no way my last patch is right.

Thinking it must be from User::getRightDescription at the help key on the formdescriptor (which returns an interface message in ->text() mode), but then why does the alert pop twice with the same message? Or why does it pop at all? Best way to answer these questions is to merge some of these patches and test at mirabeta, which I'll do tomorrow since it is getting late here (UTC+1).

DO NOT MERGE my permissions XSS patch, but if anyone wants to test while I'm one, feel free to merge [F2713428](/F2713428) and test.

[Universal\_Omega](/p/Universal_Omega/) added a comment.[Feb 7 2024, 21:092024-02-07 21:09:47 (UTC+0)](#236823)Comment Actions

I think what we should do is allow raw messages in MWS to be defined in config, and if it is, add them to $wgRawHtmlMessages, which prevents true security vulnerabilities by not only require editinterface, but also the same rights to editsitecss/js which would mean absolutely no difference from Common.js, etc...

[OrangeStar](/p/OrangeStar/) added a comment.[Feb 8 2024, 09:342024-02-08 09:34:19 (UTC+0)](#236876)This comment was removed by [OrangeStar](/p/OrangeStar/).

[OrangeStar](/p/OrangeStar/) added a comment.[Feb 8 2024, 09:512024-02-08 09:51:56 (UTC+0)](#236877)Comment Actions

[@Universal\_Omega](/p/Universal_Omega/) You mean making the help messages in MWS.php, like <https://github.com/miraheze/mw-config/blob/master/ManageWikiSettings.php#L109>, interface messages? Because if so that looks like a complex rewrite. Also, all of those messages as well as managewiki-requires, managewiki-conflicts, and all the various right-\* messages from core that are also XSS vectors in the permissions subpage must be added to wgRawHtmlMessages. We can do that, if you want, but after this.

[Universal\_Omega](/p/Universal_Omega/) added a comment.[Feb 8 2024, 10:062024-02-08 10:06:57 (UTC+0)](#236878)Comment Actions

Adding all the messages that has an issue to wgRawHtmlMessages is a mitigation to this but it might be to complex with to many at this time.

[OrangeStar](/p/OrangeStar/) added a comment.[Feb 8 2024, 10:202024-02-08 10:20:55 (UTC+0)](#236880)Comment Actions

0004-Fix-the-permissions-XSS.patch969 B[Download](https://phorge-static.wikitide.net/file/download/vu5zjhsj46zzxxjohds6/PHID-FILE-phuvnc7tygcoaqscolrh/0004-Fix-the-permissions-XSS.patch)

0003-Revert-Attempt-at-fixing-the-permissions-XSS.patch1 KB[Download](https://phorge-static.wikitide.net/file/download/3u6haxgil4hntuqfa3mn/PHID-FILE-yrytblr4t6mz2fsly23h/0003-Revert-Attempt-at-fixing-the-permissions-XSS.patch)

[OrangeStar](/p/OrangeStar/) added a comment.[Feb 8 2024, 10:252024-02-08 10:25:03 (UTC+0)](#236882)Comment Actions

0005-No-need-to-escape-this-one.patch1 KB[Download](https://phorge-static.wikitide.net/file/download/gqgzfspnaelntbyeb4ba/PHID-FILE-nka2use2mk4vt4swq5ui/0005-No-need-to-escape-this-one.patch)

I think I'm good to go to squash all of these and make a PR.

[Universal\_Omega](/p/Universal_Omega/) added a comment.[Feb 8 2024, 10:272024-02-08 10:27:58 (UTC+0)](#236883)Comment Actions

Please do a security merge not a normal PR, should be fairly easy to do security with GitHub

[OrangeStar](/p/OrangeStar/) added a comment.[Feb 8 2024, 11:142024-02-08 11:14:01 (UTC+0)](#236894)Comment Actions

security advisory draft (<https://github.com/miraheze/ManageWiki/security/advisories/GHSA-42fh-6pcr-3j58>) is ready, all the changes have been made to the private fork if I'm not missing anything. Waiting for an SRE to review everything and give me the okay (or merge the changes themselves) so that they can double check my work and we can deploy the fixes to production as soon as possible.

[OrangeStar](/p/OrangeStar/) added a comment.[Feb 9 2024, 11:412024-02-09 11:41:58 (UTC+0)](#236966)Comment Actions

I'm going to create a new draft GHSA, GitHub got bugged and thinks there are no changes waiting to be merged from the private fork *sigh*.

[OrangeStar](/p/OrangeStar/) added a comment.[Feb 9 2024, 12:002024-02-09 12:00:47 (UTC+0)](#236967)Comment Actions

<https://github.com/miraheze/ManageWiki/security/advisories/GHSA-4jr2-jhfm-2r84>

[OrangeStar](/p/OrangeStar/) added a comment.[Feb 9 2024, 12:222024-02-09 12:22:24 (UTC+0)](#236968)Comment Actions

I've set confidentiality to high, since you could read private ManageWiki settings (for example, the Discord webhook for wikis using that extension) with XSS on those pages.

[OrangeStar](/p/OrangeStar/) removed [OrangeStar](/p/OrangeStar/) as the assignee of this task.[Feb 9 2024, 14:582024-02-09 14:58:09 (UTC+0)](#237014)Comment Actions

I just realized it will be better to just leave deploying the fixes to someone with access to mwtask181. Removing myself as assignee as my part is done, I think.

[OrangeStar](/p/OrangeStar/) claimed this task.[Feb 9 2024, 21:162024-02-09 21:16:46 (UTC+0)](#237120)

[OrangeStar](/p/OrangeStar/) added a comment.[Feb 9 2024, 21:312024-02-09 21:31:39 (UTC+0)](#237122)Comment Actions

Security advisory is now published. This task should be good for opening to the public now. For those reading this, we actually found some more XSS vectors when deploying the fixes to prod, so we actually have multiple patches in the GHSA for this one.

[OrangeStar](/p/OrangeStar/) closed this task as Resolved.[Feb 9 2024, 21:312024-02-09 21:31:50 (UTC+0)](#237123)[Universal\_Omega](/p/Universal_Omega/) changed the visibility from "[Custom Policy](/transactions/old/PHID-XACT-TASK-4lqjfvihvr2ijbi/)" to "Public (No Login Required)".[Feb 10 2024, 17:192024-02-10 17:19:36 (UTC+0)](#237233)[Herald](/herald/) added subscribers: [AmandaCath](/p/AmandaCath/), [BrandonWM](/p/BrandonWM/), [Joritochip](/p/Joritochip/).  · [View Herald Transcript](/herald/transcript/150469/)[Feb 10 2024, 17:192024-02-10 17:19:36 (UTC+0)](#237234)[Universal\_Omega](/p/Universal_Omega/) moved this task from [Backlog](/project/board/62/) to [Short Term](/project/board/62/) on the [Technology-Team (MediaWiki)](/tag/technology-team_mediawiki/) board.[Feb 10 2024, 17:192024-02-10 17:19:55 (UTC+0)](#237235)[Universal\_Omega](/p/Universal_Omega/) moved this task from [Backlog](/project/board/26/) to [Bugs](/project/board/26/) on the [ManageWiki](/tag/managewiki/) board.[Log In to Comment](/login/?next=%2FT11812)

=== Content from github.com_06264b96_20250111_000214.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmiraheze%2FManageWiki%2Fsecurity%2Fadvisories%2FGHSA-4jr2-jhfm-2r84)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmiraheze%2FManageWiki%2Fsecurity%2Fadvisories%2FGHSA-4jr2-jhfm-2r84)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=miraheze%2FManageWiki)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[miraheze](/miraheze)
/
**[ManageWiki](/miraheze/ManageWiki)**
Public

* [Notifications](/login?return_to=%2Fmiraheze%2FManageWiki) You must be signed in to change notification settings
* [Fork
  28](/login?return_to=%2Fmiraheze%2FManageWiki)
* [Star
   32](/login?return_to=%2Fmiraheze%2FManageWiki)

* [Code](/miraheze/ManageWiki)
* [Pull requests
  10](/miraheze/ManageWiki/pulls)
* [Actions](/miraheze/ManageWiki/actions)
* [Security](/miraheze/ManageWiki/security)
* [Insights](/miraheze/ManageWiki/pulse)

Additional navigation options

* [Code](/miraheze/ManageWiki)
* [Pull requests](/miraheze/ManageWiki/pulls)
* [Actions](/miraheze/ManageWiki/actions)
* [Security](/miraheze/ManageWiki/security)
* [Insights](/miraheze/ManageWiki/pulse)

# Cross-Site Scripting in the extensions, settings, permissions and namespaces subpages of Special:ManageWiki

Moderate

[redbluegreenhat](/redbluegreenhat)
published
GHSA-4jr2-jhfm-2r84
Feb 9, 2024

## Package

ManageWiki
(MediaWiki Extension)

## Affected versions

All before 886cc6b94587f1c7387caa26ca9fe612e01836a0

## Patched versions

Fully fixed in 6942e8b2c01dc33c2c41a471f91ef3f6ca726073

## Description

### Impact

Special:ManageWiki does not escape interface messages on the `columns` and `help` keys on the form descriptor.

Exploiting this on-wiki requires the `(editinterface)` right.

### Patches

**All of these must be applied in order to fully fix this vulnerability**

* <https://github.com/miraheze/ManageWiki/commit/886cc6b94587f1c7387caa26ca9fe612e01836a0.patch>
* <https://github.com/miraheze/ManageWiki/commit/2ef0f50880d7695ca2874dc8dd515b2b9bbb02e5.patch>
* <https://github.com/miraheze/ManageWiki/commit/6942e8b2c01dc33c2c41a471f91ef3f6ca726073.patch>

### Workarounds

None

### References

<https://issue-tracker.miraheze.org/T11812>

### For more information

If you have any questions or comments about this advisory:

* Open an issue on [our issue tracker](https://issue-tracker.miraheze.org/maniphest/task/edit/form/2/)
* Email us at security{{@}}miraheze.org

### Severity

Moderate

6.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
High

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
High

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:N

### CVE ID

CVE-2024-25109

### Weaknesses

[CWE-79](/advisories?query=cwe%3A79)

### Credits

* [![@redbluegreenhat](https://avatars.githubusercontent.com/u/107424288?s=40&v=4)](/redbluegreenhat)
  [redbluegreenhat](/redbluegreenhat)
  Remediation developer
* [![@Universal-Omega](https://avatars.githubusercontent.com/u/54654040?s=40&v=4)](/Universal-Omega)
  [Universal-Omega](/Universal-Omega)
  Reporter
* [![@AgentIsai](https://avatars.githubusercontent.com/u/43097272?s=40&v=4)](/AgentIsai)
  [AgentIsai](/AgentIsai)
  Finder

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_2c23dedd_20250111_000214.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmiraheze%2FManageWiki%2Fcommit%2F886cc6b94587f1c7387caa26ca9fe612e01836a0)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmiraheze%2FManageWiki%2Fcommit%2F886cc6b94587f1c7387caa26ca9fe612e01836a0)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=miraheze%2FManageWiki)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[miraheze](/miraheze)
/
**[ManageWiki](/miraheze/ManageWiki)**
Public

* [Notifications](/login?return_to=%2Fmiraheze%2FManageWiki) You must be signed in to change notification settings
* [Fork
  28](/login?return_to=%2Fmiraheze%2FManageWiki)
* [Star
   32](/login?return_to=%2Fmiraheze%2FManageWiki)

* [Code](/miraheze/ManageWiki)
* [Pull requests
  10](/miraheze/ManageWiki/pulls)
* [Actions](/miraheze/ManageWiki/actions)
* [Security](/miraheze/ManageWiki/security)
* [Insights](/miraheze/ManageWiki/pulse)

Additional navigation options

* [Code](/miraheze/ManageWiki)
* [Pull requests](/miraheze/ManageWiki/pulls)
* [Actions](/miraheze/ManageWiki/actions)
* [Security](/miraheze/ManageWiki/security)
* [Insights](/miraheze/ManageWiki/pulse)

## Commit

[Permalink](/miraheze/ManageWiki/commit/886cc6b94587f1c7387caa26ca9fe612e01836a0)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-4jr2-jhfm-2r84](https://github.com/miraheze/ManageWiki/security/advisories/GHSA-4jr2-jhfm-2r84 "GHSA-4jr2-jhfm-2r84")

[Browse files](/miraheze/ManageWiki/tree/886cc6b94587f1c7387caa26ca9fe612e01836a0)
Browse the repository at this point in the history

```
* Fix numerous XSS vulnerabilities

See security advisory

* Fix XSS on the namespace subpage
```

* Loading branch information

[![@redbluegreenhat](https://avatars.githubusercontent.com/u/107424288?s=40&v=4)](/redbluegreenhat)

[redbluegreenhat](/miraheze/ManageWiki/commits?author=redbluegreenhat "View all commits by redbluegreenhat")
authored
Feb 9, 2024

1 parent
[0a3417c](/miraheze/ManageWiki/commit/0a3417c53248e3d728d5e73e2feef12c5c6e87f0)

commit 886cc6b

Showing
**1 changed file**
with
**6 additions**
and
**6 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

12 changes: 6 additions & 6 deletions

12
[includes/FormFactory/ManageWikiFormFactoryBuilder.php](#diff-468197a8b7ba15a6f4d4cf8b2cc91ef7a4f5c957ce636fee27d9f5121d489756 "includes/FormFactory/ManageWikiFormFactoryBuilder.php")

Show comments

[View file](/miraheze/ManageWiki/blob/886cc6b94587f1c7387caa26ca9fe612e01836a0/includes/FormFactory/ManageWikiFormFactoryBuilder.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -276,8 +276,8 @@ private static function buildDescriptorExtensions( |
|  |  | $mwRequirements = $ext['requires'] ? ManageWikiRequirements::process( $ext['requires'], $extList, false, $wiki ) : true; |
|  |  |  |
|  |  | $help = []; |
|  |  | $conflictLabel = wfMessage( 'managewiki-conflicts' )->text(); |
|  |  | $requiresLabel = wfMessage( 'managewiki-requires' )->text(); |
|  |  | $conflictLabel = wfMessage( 'managewiki-conflicts' )->escaped(); |
|  |  | $requiresLabel = wfMessage( 'managewiki-requires' )->escaped(); |
|  |  |  |
|  |  | if ( $ext['conflicts'] ) { |
|  |  | $help[] = "{$conflictLabel} {$ext['conflicts']}<br/>"; |
| Expand Down  Expand Up | | @@ -380,7 +380,7 @@ private static function buildDescriptorSettings( |
|  |  | $help = ( $msgHelp->exists() ) ? $msgHelp->escaped() : $set['help']; |
|  |  | if ( $set['requires'] ) { |
|  |  | $requires = []; |
|  |  | $requiresLabel = wfMessage( 'managewiki-requires' )->text(); |
|  |  | $requiresLabel = wfMessage( 'managewiki-requires' )->escaped(); |
|  |  |  |
|  |  | foreach ( $set['requires'] as $require => $data ) { |
|  |  | if ( is\_array( $data ) ) { |
| Expand Down  Expand Up | | @@ -525,10 +525,10 @@ private static function buildDescriptorNamespaces( |
|  |  |  |
|  |  | $configs = ManageWikiTypes::process( $config, $disabled, false, 'namespaces', $a, $namespaceData['additional'][$key] ?? null, false, $a['overridedefault'], $a['type'] ); |
|  |  |  |
|  |  | $help = ( $msgHelp->exists() ) ? $msgHelp->text() : $a['help']; |
|  |  | $help = ( $msgHelp->exists() ) ? $msgHelp->escaped() : $a['help']; |
|  |  | if ( $a['requires'] ) { |
|  |  | $requires = []; |
|  |  | $requiresLabel = wfMessage( 'managewiki-requires' )->text(); |
|  |  | $requiresLabel = wfMessage( 'managewiki-requires' )->escaped(); |
|  |  |  |
|  |  | foreach ( $a['requires'] as $require => $data ) { |
|  |  | if ( is\_array( $data ) ) { |
| Expand Down  Expand Up | | @@ -660,7 +660,7 @@ private static function buildDescriptorPermissions( |
|  |  | $formDescriptor["right-{$perm}"] = [ |
|  |  | 'type' => 'check', |
|  |  | 'label' => $perm, |
|  |  | 'help' => User::getRightDescription( $perm ), |
|  |  | 'help' => htmlspecialchars( User::getRightDescription( $perm ) ), |
|  |  | 'section' => ( $assigned ) ? 'assigned' : 'unassigned', |
|  |  | 'default' => $assigned, |
|  |  | 'disabled' => !$ceMW |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `886cc6b`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmiraheze%2FManageWiki%2Fcommit%2F886cc6b94587f1c7387caa26ca9fe612e01836a0) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_98d7ad28_20250111_000213.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmiraheze%2FManageWiki%2Fcommit%2F6942e8b2c01dc33c2c41a471f91ef3f6ca726073)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmiraheze%2FManageWiki%2Fcommit%2F6942e8b2c01dc33c2c41a471f91ef3f6ca726073)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=miraheze%2FManageWiki)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[miraheze](/miraheze)
/
**[ManageWiki](/miraheze/ManageWiki)**
Public

* [Notifications](/login?return_to=%2Fmiraheze%2FManageWiki) You must be signed in to change notification settings
* [Fork
  28](/login?return_to=%2Fmiraheze%2FManageWiki)
* [Star
   32](/login?return_to=%2Fmiraheze%2FManageWiki)

* [Code](/miraheze/ManageWiki)
* [Pull requests
  10](/miraheze/ManageWiki/pulls)
* [Actions](/miraheze/ManageWiki/actions)
* [Security](/miraheze/ManageWiki/security)
* [Insights](/miraheze/ManageWiki/pulse)

Additional navigation options

* [Code](/miraheze/ManageWiki)
* [Pull requests](/miraheze/ManageWiki/pulls)
* [Actions](/miraheze/ManageWiki/actions)
* [Security](/miraheze/ManageWiki/security)
* [Insights](/miraheze/ManageWiki/pulse)

## Commit

[Permalink](/miraheze/ManageWiki/commit/6942e8b2c01dc33c2c41a471f91ef3f6ca726073)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Escape output

[Browse files](/miraheze/ManageWiki/tree/6942e8b2c01dc33c2c41a471f91ef3f6ca726073)
Browse the repository at this point in the history

```
See security advisory
```

* Loading branch information

[![@redbluegreenhat](https://avatars.githubusercontent.com/u/107424288?s=40&v=4)](/redbluegreenhat)

[redbluegreenhat](/miraheze/ManageWiki/commits?author=redbluegreenhat "View all commits by redbluegreenhat")
authored
Feb 9, 2024

1 parent
[2ef0f50](/miraheze/ManageWiki/commit/2ef0f50880d7695ca2874dc8dd515b2b9bbb02e5)

commit 6942e8b

Showing
**1 changed file**
with
**1 addition**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[includes/Helpers/ManageWikiTypes.php](#diff-54f717846bf5eda336f864127ac5ed9d32c57a65d7072c6ff39735e61bd15f61 "includes/Helpers/ManageWikiTypes.php")

Show comments

[View file](/miraheze/ManageWiki/blob/6942e8b2c01dc33c2c41a471f91ef3f6ca726073/includes/Helpers/ManageWikiTypes.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -330,7 +330,7 @@ private static function common( $config, $disabled, $groupList, $name, $options, |
|  |  | case 'usergroups': |
|  |  | $groups = []; |
|  |  | foreach ( (array)$groupList as $group ) { |
|  |  | $groups[UserGroupMembership::getGroupName( $group )] = $group; |
|  |  | $groups[htmlspecialchars( UserGroupMembership::getGroupName( $group ) )] = $group; |
|  |  | } |
|  |  |  |
|  |  | $configs = [ |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `6942e8b`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmiraheze%2FManageWiki%2Fcommit%2F6942e8b2c01dc33c2c41a471f91ef3f6ca726073) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


