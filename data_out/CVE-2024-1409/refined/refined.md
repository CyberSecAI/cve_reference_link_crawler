Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

*   The vulnerability stems from insufficient input sanitization and output escaping of user-supplied attributes within the `[reg-select-role]` shortcode of the ProfilePress plugin.

**Weaknesses/Vulnerabilities:**

*   **Stored Cross-Site Scripting (XSS):** The plugin fails to properly sanitize or escape user-provided input when rendering the `[reg-select-role]` shortcode. This allows malicious scripts to be injected and stored within the WordPress database.

**Impact of Exploitation:**

*   **Arbitrary Script Execution:** Successful exploitation allows an attacker to inject malicious JavaScript code into pages containing the vulnerable shortcode. This code will execute in the browsers of users accessing those pages.
*   **Potential for Account Takeover:** The injected script could potentially perform actions on behalf of the user, including stealing session cookies, redirecting users to malicious sites, or modifying page content.
*   **Data Manipulation:** An attacker could potentially use the XSS vulnerability to steal sensitive information or modify data within the context of the affected WordPress site.

**Attack Vectors:**

*   **Shortcode Injection:** Attackers inject malicious script via the attributes of the vulnerable `[reg-select-role]` shortcode. The shortcode is then placed into a post or page.

**Required Attacker Capabilities/Position:**

*   **Authentication:** The attacker needs to be an authenticated WordPress user with "contributor" level permissions or higher. This is because users with these permission levels can create or edit posts/pages.
*   **Access to post/page editor:** The attacker must be able to create or edit pages or posts to inject the shortcode.

**Additional Details from the provided content:**

*   The vulnerability affects all versions of the ProfilePress plugin up to and including version 4.15.0.
*   The vulnerability was fixed in version 4.15.1.
*   The fix involves sanitizing the attributes of the `[reg-select-role]` shortcode to prevent XSS attacks.
*   The vulnerability was discovered by Ngô Thiên An (ancorn\_) - VNPT-VCI.
*   The provided changelog shows the fix, indicating "Fixed XSS on registration form with user role select field."
*   Code changes in `FieldsShortcodeCallback.php` show the addition of a sanitization function and the use of that function before shortcode attributes are used. The code changes in `RegistrationFormBuilder.php` show the call to the new sanitization function.