

![](/static/v20250108.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1879093)
* [XML](/show_bug.cgi?ctype=xml&id=1879093)

Closed
[Bug 1879093](/show_bug.cgi?id=1879093)
(CVE-2024-4764)

Opened 11 months ago
Closed 9 months ago

# Firefox crashes with two open Meet tabs and taking my AirPods out

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Firefox crashes with two open Meet tabs and taking my AirPods out

## Categories

### (Core :: WebRTC: Audio/Video, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=WebRTC%3A%20Audio%2FVideo#WebRTC%3A%20Audio%2FVideo)

WebRTC: Audio/Video
▾

Core :: WebRTC: Audio/Video
Bugs in WebRTC audio and video capture, handling, echo cancellation, encoding, and playback
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=WebRTC%3A%20Audio%2FVideo&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=WebRTC%3A%20Audio%2FVideo&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=WebRTC%3A%20Audio%2FVideo)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Desktop

macOS

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

126 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |
| Accessibility Severity | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr115 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=unaffected) |
| firefox125 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=wontfix) |
| firefox126 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | unaffected |
| firefox-esr128 | --- | --- |
| firefox125 |  | wontfix |
| firefox126 |  | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: jib, Assigned: pehrsons)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/906f005aaa08b2d109a3fa9e1b83000d?d=mm&size=40)  [pehrsons](/user_profile?user_id=489889)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/9362a14d9b87a3935eb16cfc834ed51f?d=mm&size=40)  [jib](/user_profile?user_id=456498)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/9362a14d9b87a3935eb16cfc834ed51f?d=mm&size=40)  [jib](/user_profile?user_id=456498)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

5 people

## References

### (Blocks 1 open bug, Regression)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[1880244](/show_bug.cgi?id=1880244 "RESOLVED FIXED - With duplex streams, stream_init and stream_destroy are slow on Mac")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[meet](/show_bug.cgi?id=1431543 "NEW - [meta] Issues affecting Google Meet")

Dependency [tree](/showdependencytree.cgi?id=1879093&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1879093)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

[1670633](/show_bug.cgi?id=1670633 "RESOLVED FIXED - Intermittent audio or 'robotic voice' issues with aggregate device on Mac")

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1889245](/show_bug.cgi?id=1889245 "RESOLVED DUPLICATE - Crash in [@ _dispatch_semaphore_dispose.cold.1]")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-race, regression, sec-high, Whiteboard: [adv-main126+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2024-4764

[Keywords:](/describekeywords.cgi)

[csectype-race](/buglist.cgi?keywords=csectype-race&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main126+]

QA Whiteboard:

[post-critsmash-triage]

Has STR:

yes

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

[[@ \_dispatch\_semaphore\_dispose.cold.1 ]](https://crash-stats.mozilla.org/signature/?signature=_dispatch_semaphore_dispose.cold.1)

[[@ libdispatch.dylib@0x39b50 ]](https://crash-stats.mozilla.org/signature/?signature=libdispatch.dylib%400x39b50)

[[@ libdispatch.dylib@0x32e11 ]](https://crash-stats.mozilla.org/signature/?signature=libdispatch.dylib%400x32e11)

[[@ AudioDSP@0xcd3d ]](https://crash-stats.mozilla.org/signature/?signature=AudioDSP%400xcd3d)

[[@ AudioDSP@0x3ffb34 ]](https://crash-stats.mozilla.org/signature/?signature=AudioDSP%400x3ffb34)

[[@ AudioDSP@0x770498 ]](https://crash-stats.mozilla.org/signature/?signature=AudioDSP%400x770498)

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file)

| [advisory.txt](/attachment.cgi?id=9401126)  [8 months ago](#c11)  [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733)   180 bytes, text/plain |  | [Details](/attachment.cgi?id=9401126&action=edit) |
| --- | --- | --- |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Jan-Ivar Bruaroey [:jib] (needinfo? me)](/user_profile?user_id=456498)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1879093#c0)• 11 months ago |
|  | |

STR (require AirPods or possibly similar bluetooth headset):

1. Leave already-paired AirPods in their case
2. Go to <https://meet.google.com/>
3. Click New Meeting / Start an instant meeting
4. Allow camera and microphone and stay in the lobby
5. Duplicate the tab and repeat step 4 there.
6. Make macOS connect with the AirPods by taking them out of their case

Expected result: No crash

Actual result: Firefox crashes with [bp-e86fd0af-cf11-49db-883f-ad3010240206](https://crash-stats.mozilla.org/report/index/e86fd0af-cf11-49db-883f-ad3010240206)

If it doesn't crash in in step 6, put the airpods back in their case (sometimes crashes then) and repeat step 6.

Flags: needinfo?(apehrson)

|  | [Andreas Pehrson [:pehrsons]](/user_profile?user_id=489889)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1879093#c1)• 11 months ago |
|  | |

This involving two tabs should mean that we are recreating VoiceProcessingIO AudioUnits on two separate threads in the parent process. The cubeb-coreaudio-rs backend serializes operations per-stream. Maybe if we serialize them on the same thread it won't crash. I have some prior work for this so if I can reproduce I'll see how it helps.

Assignee: nobody → apehrsonStatus: NEW → ASSIGNED

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1879093#a11346_406194)• 11 months ago |

Group: core-security

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1879093#c2)• 11 months ago |
|  | |

Is this like a use after free then? Or is it being more or less safely caught?

Keywords: [csectype-race](/buglist.cgi?keywords=csectype-race&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Andreas Pehrson [:pehrsons]](/user_profile?user_id=489889)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1879093#c3)• 11 months ago |
|  | |

Based on the mac crash info in the report, this appears safely caught. But I don't think we can assume all paths from this STR will be safely caught. Adding some more crash signatures that are all from macOS 14.

In particular [[@ AudioDSP@0x3ffb34 ]](https://crash-stats.mozilla.org/signature/?product=Firefox&signature=AudioDSP%400x3ffb34) looks dead on like a UAF, and involves tearing down an audio unit. Step 6 in the STR would trigger that code path so might be a related failure mode here.

Crash Signature: [@ \_dispatch\_semaphore\_dispose.cold.1 ] → [@ \_dispatch\_semaphore\_dispose.cold.1 ]
[@ libdispatch.dylib@0x39b50 ]
[@ libdispatch.dylib@0x32e11 ]
[@ AudioDSP@0xcd3d ]
[@ AudioDSP@0x3ffb34 ]
[@ AudioDSP@0x770498 ]

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1879093#a434426_279663)• 11 months ago |

Severity: -- → S2

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1879093#a436147_279663)• 11 months ago |

Blocks: [meet](/show_bug.cgi?id=1431543 "NEW - [meta] Issues affecting Google Meet")

|  | [Andreas Pehrson [:pehrsons]](/user_profile?user_id=489889)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1879093#c4)• 11 months ago |
|  | |

[Bug 1880244](/show_bug.cgi?id=1880244 "RESOLVED FIXED - With duplex streams, stream_init and stream_destroy are slow on Mac") might help here, since it will make us create and destroy vpio audio units much less.

Depends on: [1880244](/show_bug.cgi?id=1880244 "RESOLVED FIXED - With duplex streams, stream_init and stream_destroy are slow on Mac")Flags: needinfo?(apehrson)

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1879093#c5)• 10 months ago |
|  | |

Patches being developed in the parent.

|  | [az [:az]](/user_profile?user_id=700434) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1879093#a4783070_700434)• 9 months ago |

Duplicate of this bug: [1889245](/show_bug.cgi?id=1889245 "RESOLVED DUPLICATE - Crash in [@ _dispatch_semaphore_dispose.cold.1]")

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1879093#c7)• 9 months ago |
|  | |

We're not sure if the parent bug's changes will fully address the crash signature here. Waiting to see as that work rolls out.

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1879093#c8)• 9 months ago |
|  | |

We think this is fixed in 126.

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1879093#c9)• 9 months ago |
|  | |

126 is looking clean. resolving.

Status: ASSIGNED → RESOLVEDClosed: 9 months agoResolution: --- → FIXED

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1879093#c10)• 8 months ago |
|  | |

Can you clarify the status of ESR115 for this bug given that this is rated sec-high?

Group: media-core-security → core-security-release
[status-firefox125](/buglist.cgi?f1=cf_status_firefox125&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=wontfix)
[status-firefox126](/buglist.cgi?f1=cf_status_firefox126&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=fixed)
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=%3F)Flags: needinfo?(apehrson)Target Milestone: --- → 126 Branch

|  | [Andreas Pehrson [:pehrsons]](/user_profile?user_id=489889)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1879093#a7327530_489889)• 8 months ago |

[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=%3F) → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=unaffected)Flags: needinfo?(apehrson)Keywords: [regression](/buglist.cgi?keywords=regression&resolution=---)Regressed by: [1670633](/show_bug.cgi?id=1670633 "RESOLVED FIXED - Intermittent audio or 'robotic voice' issues with aggregate device on Mac")

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1879093#a7744875_488993)• 8 months ago |

QA Whiteboard: [post-critsmash-triage]

|  | [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1879093#a7994210_486733)• 8 months ago |

Whiteboard: [adv-main126+]

|  | [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1879093#c11)• 8 months ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9401126)
— [Details](attachment.cgi?id=9401126&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1879093#a8048414_578488)• 8 months ago |

Alias: CVE-2024-4764

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1879093#a19399467_1689)• 4 months ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1879093&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review

