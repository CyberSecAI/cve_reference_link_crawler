=== Content from visionspace.com_7c05b3a3_20250110_154615.html ===


[Skip to content](#content_skip_link_anchor)
[Skip to footer](#footer_skip_link_anchor)
[![VisionSpace](//visionspace.com/wp-content/uploads/2024/07/cropped-VISIONSPACE_EYE_BLACK_HR-1.png)](https://visionspace.com/)

* Services
  + [Projects](https://visionspace.com/projects/)
  + [Consultancy](https://visionspace.com/services/consultancy/)
  + [Cybersecurity](https://visionspace.com/services/cybersecurity/)
  + [Programming](https://visionspace.com/services/programming/)
  + [Satellite Operations](https://visionspace.com/services/satellite-operations/)
* Products
  + [Karel](https://www.karel.ai/)
  + [ParleIoT](https://visionspace.com/our-services/product-parle-iot/)
  + [Pianista](https://visionspace.com/our-services/product-pianista/)
  + [SLE Provider](https://github.com/visionspacetec/sle-provider)
  + [VStart](http://vstart.io/)
* [Blog](https://visionspace.com/blog-standard/)
* About Us
  + [Branding](https://zeroheight.com/4836ffb25)
  + [Contacts](https://visionspace.com/contacts/)
  + [Our Team](https://visionspace.com/our-team/)
* [Careers](https://visionspace.corehr.hrcloud.com/vstg/#/jobs)
* [Login](https://groundflex.sharepoint.com/sites/visionspace)

![VisionSpace](//visionspace.com/wp-content/uploads/2024/07/cropped-VISIONSPACE_EYE_BLACK_HR-1.png)

[![VisionSpace](//visionspace.com/wp-content/uploads/2024/07/cropped-VISIONSPACE_EYE_BLACK_HR-1.png)](https://visionspace.com/)

![VisionSpace](//visionspace.com/wp-content/uploads/2024/07/cropped-VISIONSPACE_EYE_BLACK_HR-1.png)

[![VisionSpace](//visionspace.com/wp-content/uploads/2023/12/VISIONSPACE_EYE_WHITE.png)](https://visionspace.com/)
Close

* Services
  + [Projects](https://visionspace.com/projects/)
  + [Consultancy](https://visionspace.com/services/consultancy/)
  + [Cybersecurity](https://visionspace.com/services/cybersecurity/)
  + [Programming](https://visionspace.com/services/programming/)
  + [Satellite Operations](https://visionspace.com/services/satellite-operations/)
* Products
  + [Karel](https://www.karel.ai/)
  + [ParleIoT](https://visionspace.com/our-services/product-parle-iot/)
  + [Pianista](https://visionspace.com/our-services/product-pianista/)
  + [SLE Provider](https://github.com/visionspacetec/sle-provider)
  + [VStart](http://vstart.io/)
* [Blog](https://visionspace.com/blog-standard/)
* About Us
  + [Branding](https://zeroheight.com/4836ffb25)
  + [Contacts](https://visionspace.com/contacts/)
  + [Our Team](https://visionspace.com/our-team/)
* [Careers](https://visionspace.corehr.hrcloud.com/vstg/#/jobs)
* [Login](https://groundflex.sharepoint.com/sites/visionspace)

###### Have a Project?

info@website.com

###### Want to Work with Us?

[Send Brief](https://visionspace.com/contacts/)

###### Want to Buy Illustrations?

[Go to Shop](https://visionspace.com/shop/)

[Cybersecurity](https://visionspace.com/category/cyber/) [Space](https://visionspace.com/category/space/) [Technology](https://visionspace.com/category/technology/)
# How to crash a Spacecraft – DoS through Vulnerability in NASA CryptoLib v1.3.0

[By![](https://secure.gravatar.com/avatar/fa6dd76f1a53e40e0f9d64826f5607f3?s=56&d=mm&r=g)Andrzej Olchawa](https://visionspace.com/author/a-olchawa/)August 21, 2024

![](https://visionspace.com/wp-content/uploads/2024/08/crashing-cryptolib-1024x683.png)

*Written by:* [Ayman Boulaich](https://www.linkedin.com/in/aymanblh/),[Andy Olchawa](https://www.linkedin.com/in/andrzejolchawa/), [Milenko Starcik](https://www.linkedin.com/in/milenko-starcik-b7960b198/) @visionspace

[CryptoLib](https://github.com/nasa/CryptoLib), a software library developed by NASA, implements the [CCSDS](https://public.ccsds.org/) Space Data Link Security Protocol (SDLS) to secure communications between spacecraft running the [Core Flight System (cFS)](https://cfs.gsfc.nasa.gov/) and their corresponding ground stations. The library is essential in safeguarding the integrity and confidentiality of data exchanged during space missions.

Our vulnerability research team has identified out-of-bounds vulnerabilities within CryptoLib that, if exploited, can lead to a catastrophic crash in any software system dependent on it. To underscore the potential risks to space missions, we have created a Proof-of-Concept (PoC) exploit that demonstrates the impact of the vulnerabilities.

In this article, we begin with a demonstration (see Video 1) that showcases our PoC exploit successfully crashing both the cFS onboard a spacecraft and its ground station counterpart (COSMOS), as deployed within [NASA’s Operational Simulator for Small Satellites (NOS3)](https://www.nasa.gov/nasa-operational-simulation-for-small-satellites/). Following this demonstration, we dive into a detailed technical analysis of the vulnerabilities, exploring how they affect various subsystems within CryptoLib.

Public disclosures:

* CVE-2024-44910: Segmentation Fault on AOS frames
* CVE-2024-44912: Multiple Segmentation Fault on TM frames
* CVE-2024-44911: Segmentation Fault on TC frames

Video 1: Out-of-Bounds read in CryptoLib – PoC

## SPI Overview

The *Security Parameter Index (SPI)* is a transmitted value uniquely identifying the SA applicable to a Transfer Frame. All *Transfer Frames* having the same SPI on a physical channel share a single SA. The SPI can be considered a table index key to an SA database that stores all the managed information required by each of the SAs on a physical channel [5].

*Security Association (SA)* is a structure that defines a simplex (one-way), stateful cryptographic session for providing authentication, data integrity, replay protection, and/or data confidentiality at the receiving and sending ends.

To achieve this, CryptoLib uses an interface called *sa\_if* located in */src/sa/internal/sa\_interface\_inmemory.template.c*, which is loaded in memory in and has a function called *get\_sa\_from\_spi* that retrieves a SA pointer from a SPI.

Our assessment found that this function doesn’t check the SPI before retrieving the *SA* (see Figure 1).

![](https://visionspace.com/wp-content/uploads/2024/08/Picture1-1024x581.png)

So, if we can make the library call this function with a value outside the array range, we will retrieve an invalid pointer to the SA structure. If it is dereferenced to get one of his security parameters, a *segfault* will occur, crashing the program (see Figure 2).

![](https://visionspace.com/wp-content/uploads/2024/08/Picture2-1024x575.png)
## SegFault on AOS Frames

AOS is a data link layer protocol used by space missions and the one used for sending *AOS frames*. This protocol has been designed to meet the requirements of space missions for the efficient transfer of space application data of various types and characteristics over space-to-ground, ground-to-space, or space-to-space communications links (hereafter called space links) [2].

*SDLS-AOS* standard frame structure can be defined in Figure 3. The most important part of understanding the exploiting methodology is that there are two *Security Fields*, one for encryption and the other for authentication, respectively, and that the primary header is responsible for storing the *GVCID*.

![](https://visionspace.com/wp-content/uploads/2024/08/Picture3.png)

The *security header* is equivalent in every type of frame and consists of a 2-byte *SPI* followed by the *IV*, *SN*, and *PL* (optional) fields used for encryption/decryption. We are focusing on *SPI*, as we will see afterward that other header fields aren’t relevant for this research (see Figure 4).

![](https://visionspace.com/wp-content/uploads/2024/08/Picture4.png)

Figure 4: Security Header structure

Figure 5 shows a code from the *AOS decryption function* called *Crypto\_AOS\_ProcessSecurity* located in */src/core/crypto\_aos.c*. We can see that the value of *SPI* is not checked before calling the *get\_sa\_from\_spi* function (line 977).

![](https://visionspace.com/wp-content/uploads/2024/08/Picture5-1024x445.png)

Figure 5: *SPI* extraction from the input frame and *sa\_get\_from\_spi* call

A *segfault* should arise if we put an invalid index on the *AOS frame* and the *SA* pointer is dereferenced.

The only check done before getting the *SA pointer* is whether the *GVCID* is valid, so we must put a valid one on the primary header (see Figure 6 and Figure 7).

![](https://visionspace.com/wp-content/uploads/2024/08/Picture6-1024x77.png)

Figure 6: Bit math to retrieve the GVCID values from the input frame

As shown in Figure 7, the check is not directly made, but the *GVCID* values need to be valid to extract the managed parameters (line 942).

![](https://visionspace.com/wp-content/uploads/2024/08/Picture7-1024x335.png)

Figure 7: Retrieving the managed parameters with GVCID values

Figure 8 shows an example of how we can decrypt (line 52) a malicious *AOS frame* (line 47) that will cause a crash.

![](https://visionspace.com/wp-content/uploads/2024/08/Picture8.png)

Figure 8: Test case to demonstrate the program crash with crafted *AOS frame* with invalid *SPI*

Once executed, as demonstrated in Figure 9, the application crashes with a segmentation fault error. With the help of a debugger, we can see the exact line where the dereference is happening (see Figure 10 and Figure 11).

![](https://visionspace.com/wp-content/uploads/2024/08/Picture9-1024x144.png)

Figure 9: *Segmentation fault* arises when executing it

![](https://visionspace.com/wp-content/uploads/2024/08/Picture10-1024x90.png)

Figure 10: The debugger log shows the vulnerable line

![](https://visionspace.com/wp-content/uploads/2024/08/Picture11-1024x484.png)

Figure 11: Line where *sa\_ptr* is dereferenced

This is so harmful as a *segfault* can lead to a *Denial of Service* in one of the two communication ends, i.e., it can crash the software onboard and on the ground.

## Multiple SegFault on TM Frames

TM is a data link layer protocol used by space missions to send *TM frames*. This protocol has been designed to meet the requirements of space missions for the efficient transfer of space application data of various types and characteristics over space-to-ground, ground-to-space, or space-to-space communications links (hereafter called space links) [3].

*SDLS-TM* standard frame structure can be defined as in Figure 12.

![](https://visionspace.com/wp-content/uploads/2024/08/Picture12-1024x323.png)

Figure 12: *TM* frame structure

The structure is like the *AOS* example, with the only key difference being that we have an optional secondary header instead of an optional insert zone (We will recall this field in a later vulnerability).

### SegFault via SPI

Figure 13 shows code from the *TM decryption* function called *Crypto\_TM\_ProcessSecurity* located in */src/core/crypto\_tm.c*. We can see that the SPI is not checked before calling the *get\_sa\_from\_spi* function (line 1004).

![](https://visionspace.com/wp-content/uploads/2024/08/Picture13.png)

Figure 13: *SPI* extraction from the input frame and *sa\_get\_from\_spi* call

The *GVCID* is the only thing checked (line 952) before calling *sa\_get\_from\_spi*, so we have the same vulnerability as *AOS frames* (see Figure 14).

![](https://visionspace.com/wp-content/uploads/2024/08/Picture14.png)

Figure 14: Retrieving the managed parameters with *GVCID* values

By changing the config to treat the frame as a *TM frame*, we can trigger the same vulnerability but, this time, decrypting (line 51) a malicious *TM frame* (line 46) (see Figure 15 and Figure 16).

![](https://visionspace.com/wp-content/uploads/2024/08/Picture15.png)

Figure 15: Test case to demonstrate the program crash with crafted *TM frame* with invalid *SPI*

![](https://visionspace.com/wp-content/uploads/2024/08/Picture16.png)

Figure 16: *Segmentation fault* arises when executing it

![](https://visionspace.com/wp-content/uploads/2024/08/Picture17.png)

Figure 17: The debugger log shows the vulnerable line

![](https://visionspace.com/wp-content/uploads/2024/08/Picture18.png)

Figure 18: Line where *sa\_ptr* is dereferenced

### SegFault via Secondary Header

The *Transfer Frame Secondary Header* is optional; its presence or absence shall be signaled by the *Transfer Frame Secondary Header Flag* in the *Transfer Frame Primary Header Data Field Status* (see Figure 19 and Figure 20).

![](https://visionspace.com/wp-content/uploads/2024/08/Picture19.png)

Figure 19: TM frame Primary Header structure

![](https://visionspace.com/wp-content/uploads/2024/08/Picture20.png)

Figure 20: TM frame Primary Header Data Field Status structure

*Transfer Frame Secondary Header* field structure can be defined as in Figure 21.

![](https://visionspace.com/wp-content/uploads/2024/08/Picture21.png)

Figure 21: TM frame *Secondary Header* structure

The important thing here is the *Transfer Frame Secondary Header Length*, only by modifying the secondary header size the entire frame structure will change and if the secondary header data field size remains the same, we are able to change the SPI value, which is next to it, and then cause a *segfault*.

Now our payload looks like Figure 22, now we have a secondary header which his data field has 6 byte length but as we can see on the *Secondary Header Length* is only 4 bytes, changing the *SPI* value from 0x000C to 0xEEFF causing a *segfault* (see Figure 23).

![](https://visionspace.com/wp-content/uploads/2024/08/Picture22.png)

Figure 22: Test case to demonstrate the program crash with crafted TM frame with invalid Secondary Header Length

![](https://visionspace.com/wp-content/uploads/2024/08/Picture23.png)

Figure 23: Segmentation fault arises when executing it

## SegFault on TC Frames

TC is a data link layer protocol used by space missions and for sending TC frames. This protocol has been designed to meet the requirements of space missions for efficient transfer of space application data of various types and characteristics over space-to-ground, ground-to-space, or space-to-space communications links (hereafter called space links) [4].

*SDLS-TC* standard frame structure can be defined as in Figure 24. We don’t have a secondary header or insert zone in this case. Segment Header is the new field that takes 1 byte between Primary Header where *GVCID* is saved and *Security Header*. As we will see later, the structure doesn’t change the way to approach.

![](https://visionspace.com/wp-content/uploads/2024/08/Picture24-1024x317.png)

Figure 24: TC frame structure

Figure 25 shows code from the TC decryption function called *Crypto\_TC\_ProcessSecurity* located in /src/core/crypto\_tc.c. We can see that the SPI is not checked before calling the *get\_sa\_from\_spi* function (line 904).

![](https://visionspace.com/wp-content/uploads/2024/08/Picture25.png)

Figure 25: SPI extraction from the input frame and *sa\_get\_from\_spi* call

As the Gvcid is the only thing checked (line 882) before calling *sa\_get\_from\_spi*, we have the same vulnerability here as in AOS and TM frames (see Figure 26).

![](https://visionspace.com/wp-content/uploads/2024/08/Picture26.png)

Figure 26: Retrieving the managed parameters with GVCID values

By changing the configuration to treat the frame as a *TC frame*, we can trigger the same vulnerability, but this time decrypting (line 58) a malicious *TC frame*. The frame is complete this time as the length is checked (line 51) (see Figure 27 and Figure 28).

![](https://visionspace.com/wp-content/uploads/2024/08/Picture27.png)

Figure 27: Test case to demonstrate the program crash with crafted TC frame with invalid SPI

![](https://visionspace.com/wp-content/uploads/2024/08/Picture28.png)

Figure 28: Segmentation fault arises when executing it

Using the debugger to see where the dereference is done (see Figure 29), I realized that the triggered line differs from *TM* and *AOS* frames. That’s because a function checks the SA (see Figure 30) but does not check if it is valid. However, its security parameters are valid, and the *segfault* arises by making the dereference to check it (see Figure 31).

![](https://visionspace.com/wp-content/uploads/2024/08/Picture29-1024x71.png)

Figure 29: Debugger log shows the vulnerable line

![](https://visionspace.com/wp-content/uploads/2024/08/Picture30.png)

Figure 30: Function which validates SA parameters

![](https://visionspace.com/wp-content/uploads/2024/08/Picture31-1024x422.png)

Figure 31: Line where *sa\_ptr* is dereferenced

## Recommendations

Just checking if *SPI* is within the *SA* array length range before retrieving the *SA* pointer on the *get\_sa\_from\_spi()* function will be enough to remove this attack vector.

[1] [NASA CryptoLib](https://github.com/nasa/CryptoLib)
[2] [AOS Space Data Link Protocol](https://public.ccsds.org/Pubs/732x0b4.pdf)
[3] [TM Space Data Link Protocol](https://public.ccsds.org/Pubs/132x0b3.pdf)
[4] [TC Space Data Link Protocol](https://public.ccsds.org/Pubs/232x0b4c1.pdf)
[5] [SDLS](https://public.ccsds.org/Pubs/355x0b2.pdf)

[![VisionSpace](//visionspace.com/wp-content/uploads/2022/12/VISIONSPACE_WHITE.png)](https://visionspace.com/)

###### Germany

Robert-Bosch-Str 7

hello@visionspace.com

+49 (0) 6151 6292270

###### Portugal

Rua Arnaldo Sobral 49

info@visionspace.com

+351 233 094 826

###### Certifications

[![](https://visionspace.com/wp-content/uploads/2022/12/icon_ISO9001_1.png)](https://visionspace.com/wp-content/uploads/2024/07/DESTU_819943705_GenericCertificate_Final_until-11032027.pdf)

[![](https://visionspace.com/wp-content/uploads/2022/12/VISIONSPACE-PORTUGAL-516007432-Selo-TOP5-2023-150x150.png)](https://visionspace.com/wp-content/uploads/2024/07/VISIONSPACE-PORTUGAL-516007432-CERTIFICADO-TOP-5-2023.pdf)

![](https://visionspace.com/wp-content/uploads/2022/12/shutterstock_1846638856_w-1024x1024.png)

[VisionSpace Group](https://visionspace.com) © 2024. All rights reserved.

[![VisionSpace](https://visionspace.com/wp-content/uploads/2024/07/cropped-VISIONSPACE_EYE_BLACK_HR-1.png)](https://visionspace.com/)
Manage Consent

To provide the best experiences, we use technologies like cookies to store and/or access device information. Consenting to these technologies will allow us to process data such as browsing behavior or unique IDs on this site. Not consenting or withdrawing consent, may adversely affect certain features and functions.

Functional
Functional

Always active

The technical storage or access is strictly necessary for the legitimate purpose of enabling the use of a specific service explicitly requested by the subscriber or user, or for the sole purpose of carrying out the transmission of a communication over an electronic communications network.

Preferences
Preferences

The technical storage or access is necessary for the legitimate purpose of storing preferences that are not requested by the subscriber or user.

Statistics
Statistics

The technical storage or access that is used exclusively for statistical purposes.
The technical storage or access that is used exclusively for anonymous statistical purposes. Without a subpoena, voluntary compliance on the part of your Internet Service Provider, or additional records from a third party, information stored or retrieved for this purpose alone cannot usually be used to identify you.

Marketing
Marketing

The technical storage or access is required to create user profiles to send advertising, or to track the user on a website or across several websites for similar marketing purposes.

Manage options
Manage services
Manage {vendor\_count} vendors
[Read more about these purposes](https://cookiedatabase.org/tcf/purposes/)

Accept
Deny
View preferences
Save preferences
View preferences

{title}
{title}
{title}

Manage consent



=== Content from github.com_4cd15810_20250110_154615.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnasa%2FCryptoLib%2Fissues%2F268)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnasa%2FCryptoLib%2Fissues%2F268)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=nasa%2FCryptoLib)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[nasa](/nasa)
/
**[CryptoLib](/nasa/CryptoLib)**
Public

* [Notifications](/login?return_to=%2Fnasa%2FCryptoLib) You must be signed in to change notification settings
* [Fork
  29](/login?return_to=%2Fnasa%2FCryptoLib)
* [Star
   85](/login?return_to=%2Fnasa%2FCryptoLib)

* [Code](/nasa/CryptoLib)
* [Issues
  31](/nasa/CryptoLib/issues)
* [Pull requests
  2](/nasa/CryptoLib/pulls)
* [Actions](/nasa/CryptoLib/actions)
* [Projects
  1](/nasa/CryptoLib/projects)
* [Wiki](/nasa/CryptoLib/wiki)
* [Security](/nasa/CryptoLib/security)
* [Insights](/nasa/CryptoLib/pulse)

Additional navigation options

* [Code](/nasa/CryptoLib)
* [Issues](/nasa/CryptoLib/issues)
* [Pull requests](/nasa/CryptoLib/pulls)
* [Actions](/nasa/CryptoLib/actions)
* [Projects](/nasa/CryptoLib/projects)
* [Wiki](/nasa/CryptoLib/wiki)
* [Security](/nasa/CryptoLib/security)
* [Insights](/nasa/CryptoLib/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fnasa%2FCryptoLib%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fnasa%2FCryptoLib%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Out-of-Bounds reads on TM/TC/AOS Frames #268

Closed

[Donnie-Ice](/Donnie-Ice) opened this issue
Aug 5, 2024
· 0 comments
 · Fixed by [#269](https://github.com/nasa/CryptoLib/pull/269)

Closed

# [Out-of-Bounds reads on TM/TC/AOS Frames](#top) #268

[Donnie-Ice](/Donnie-Ice) opened this issue
Aug 5, 2024
· 0 comments
 · Fixed by [#269](https://github.com/nasa/CryptoLib/pull/269)

Assignees
[![@Donnie-Ice](https://avatars.githubusercontent.com/u/77851621?s=40&v=4)](/Donnie-Ice)

Labels
[bug](/nasa/CryptoLib/labels/bug)
Something isn't working

## Comments

[![@Donnie-Ice](https://avatars.githubusercontent.com/u/77851621?s=80&u=382f0c67f882d75bfd68c787ccca71f8f8be6aea&v=4)](/Donnie-Ice)

Copy link

Contributor

### **[Donnie-Ice](/Donnie-Ice)** commented [Aug 5, 2024](#issue-2448479893)

| It is possible to get a seg fault by first passing an invalid index to `sa_if->sa_get_from_spi(spi, &sa_ptr)`, then dereferencing the pointer in the `// Determine SA Service Type` code blocks in `crypto_aos.c`, `crypto_tc.c`, and `crypto_tm.c`.  To fix this, check if the SPI is within the SA array length before retrieving the SA pointer in `get_sa_from_spi()` |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@Donnie-Ice](https://avatars.githubusercontent.com/u/77851621?s=40&u=382f0c67f882d75bfd68c787ccca71f8f8be6aea&v=4)](/Donnie-Ice)
[Donnie-Ice](/Donnie-Ice)
added
the
[bug](/nasa/CryptoLib/labels/bug)
Something isn't working
label
[Aug 5, 2024](#event-13763841064)

[![@Donnie-Ice](https://avatars.githubusercontent.com/u/77851621?s=40&u=382f0c67f882d75bfd68c787ccca71f8f8be6aea&v=4)](/Donnie-Ice)
[Donnie-Ice](/Donnie-Ice)
self-assigned this
[Aug 5, 2024](#event-13763841125)

[![@jlucas9](https://avatars.githubusercontent.com/u/6588622?s=40&u=df4e0330f3ba059a86410d43838c2119e9817c71&v=4)](/jlucas9)
[jlucas9](/jlucas9)
added this to [CryptoLib Path Forward](/orgs/nasa/projects/16)
[Aug 5, 2024](#event-14782327114)

[Donnie-Ice](/Donnie-Ice)
added a commit
that referenced
this issue
[Aug 5, 2024](#ref-commit-13b3295)
[![@Donnie-Ice](https://avatars.githubusercontent.com/u/77851621?s=40&u=382f0c67f882d75bfd68c787ccca71f8f8be6aea&v=4)](/Donnie-Ice)

`[[](/nasa/CryptoLib/commit/13b329551bf40686ad9edf5607c53932ff8d1080 "[nasa/cryptolib#268] Added unit tests to confirm seg faults")[#268](https://github.com/nasa/CryptoLib/issues/268)[] Added unit tests to confirm seg faults](/nasa/CryptoLib/commit/13b329551bf40686ad9edf5607c53932ff8d1080 "[nasa/cryptolib#268] Added unit tests to confirm seg faults")`

`[13b3295](/nasa/CryptoLib/commit/13b329551bf40686ad9edf5607c53932ff8d1080)`

[Donnie-Ice](/Donnie-Ice)
added a commit
that referenced
this issue
[Aug 5, 2024](#ref-commit-54056e5)
[![@Donnie-Ice](https://avatars.githubusercontent.com/u/77851621?s=40&u=382f0c67f882d75bfd68c787ccca71f8f8be6aea&v=4)](/Donnie-Ice)

`[[](/nasa/CryptoLib/commit/54056e5c319632b72daf1d7b5c894223ba35eeac "[nasa/cryptolib#268] Added sa[spi] index check, prevents seg fault")[#268](https://github.com/nasa/CryptoLib/issues/268)[] Added sa[spi] index check, prevents seg fault](/nasa/CryptoLib/commit/54056e5c319632b72daf1d7b5c894223ba35eeac "[nasa/cryptolib#268] Added sa[spi] index check, prevents seg fault")`

`[54056e5](/nasa/CryptoLib/commit/54056e5c319632b72daf1d7b5c894223ba35eeac)`

[Donnie-Ice](/Donnie-Ice)
added a commit
that referenced
this issue
[Aug 5, 2024](#ref-commit-e9541dc)
[![@Donnie-Ice](https://avatars.githubusercontent.com/u/77851621?s=40&u=382f0c67f882d75bfd68c787ccca71f8f8be6aea&v=4)](/Donnie-Ice)

`[[](/nasa/CryptoLib/commit/e9541dc928f3e525f514df4ca39cfe5d0c27e9ba "[nasa/cryptolib#268] switched source branch to dev")[#268](https://github.com/nasa/CryptoLib/issues/268)[] switched source branch to dev](/nasa/CryptoLib/commit/e9541dc928f3e525f514df4ca39cfe5d0c27e9ba "[nasa/cryptolib#268] switched source branch to dev")`

`[e9541dc](/nasa/CryptoLib/commit/e9541dc928f3e525f514df4ca39cfe5d0c27e9ba)`

[Donnie-Ice](/Donnie-Ice)
added a commit
that referenced
this issue
[Aug 5, 2024](#ref-commit-391e764)
[![@Donnie-Ice](https://avatars.githubusercontent.com/u/77851621?s=40&u=382f0c67f882d75bfd68c787ccca71f8f8be6aea&v=4)](/Donnie-Ice)

`[[](/nasa/CryptoLib/commit/391e7648d40479dde82b55f347b6b1eef5602e90 "[nasa/cryptolib#268] Added another status check after Crypto_TC_Sanity_Validations")[#268](https://github.com/nasa/CryptoLib/issues/268)[] Added another status check after Crypto_TC_Sanity_Validations](/nasa/CryptoLib/commit/391e7648d40479dde82b55f347b6b1eef5602e90 "[nasa/cryptolib#268] Added another status check after Crypto_TC_Sanity_Validations")`

`[391e764](/nasa/CryptoLib/commit/391e7648d40479dde82b55f347b6b1eef5602e90)`

[![@Donnie-Ice](https://avatars.githubusercontent.com/u/77851621?s=40&u=382f0c67f882d75bfd68c787ccca71f8f8be6aea&v=4)](/Donnie-Ice)
[Donnie-Ice](/Donnie-Ice)
linked a pull request
[Aug 5, 2024](#event-13765748663)
that will
close
this issue

[268 oob read branch rebase
#269](/nasa/CryptoLib/pull/269)
 Merged

[Donnie-Ice](/Donnie-Ice)
added a commit
that referenced
this issue
[Aug 5, 2024](#ref-commit-83e2b45)
[![@Donnie-Ice](https://avatars.githubusercontent.com/u/77851621?s=40&u=382f0c67f882d75bfd68c787ccca71f8f8be6aea&v=4)](/Donnie-Ice)

`[[](/nasa/CryptoLib/commit/83e2b453d3422dc49ad0a6ff508f41483fa67eea "[nasa/cryptolib#268] Fix one-off index check")[#268](https://github.com/nasa/CryptoLib/issues/268)[] Fix one-off index check](/nasa/CryptoLib/commit/83e2b453d3422dc49ad0a6ff508f41483fa67eea "[nasa/cryptolib#268] Fix one-off index check")`

`[83e2b45](/nasa/CryptoLib/commit/83e2b453d3422dc49ad0a6ff508f41483fa67eea)`

[![@Donnie-Ice](https://avatars.githubusercontent.com/u/77851621?s=40&u=382f0c67f882d75bfd68c787ccca71f8f8be6aea&v=4)](/Donnie-Ice)
[Donnie-Ice](/Donnie-Ice)
closed this as [completed](/nasa/CryptoLib/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Aug 7, 2024](#event-13796373624)

[![@github-project-automation](https://avatars.githubusercontent.com/in/235829?s=40&v=4)](/apps/github-project-automation)
[github-project-automation](/apps/github-project-automation)
bot
moved this to **Done**
in [CryptoLib Path Forward](/orgs/nasa/projects/16)
[Aug 7, 2024](#event-14814020419)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fnasa%2FCryptoLib%2Fissues%2F268)

Assignees

[![@Donnie-Ice](https://avatars.githubusercontent.com/u/77851621?s=40&v=4)](/Donnie-Ice) [Donnie-Ice](/Donnie-Ice)

Labels

[bug](/nasa/CryptoLib/labels/bug)
Something isn't working

Projects

[CryptoLib Path Forward](/orgs/nasa/projects/16)

Archived in project

Milestone

No milestone

Development

Successfully merging a pull request may close this issue.

 [268 oob read branch rebase](/nasa/CryptoLib/pull/269)
 [nasa/CryptoLib](/nasa/CryptoLib)

1 participant

[![@Donnie-Ice](https://avatars.githubusercontent.com/u/77851621?s=52&v=4)](/Donnie-Ice)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


