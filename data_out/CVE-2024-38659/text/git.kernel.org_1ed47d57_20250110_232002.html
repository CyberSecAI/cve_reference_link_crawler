

| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=aee1955a1509a921c05c70dad5d6fc8563dfcb31)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=aee1955a1509a921c05c70dad5d6fc8563dfcb31)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=aee1955a1509a921c05c70dad5d6fc8563dfcb31)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=aee1955a1509a921c05c70dad5d6fc8563dfcb31)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Roded Zats <rzats@paloaltonetworks.com> | 2024-05-22 10:30:44 +0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-06-12 11:39:49 +0200 |
| commit | [aee1955a1509a921c05c70dad5d6fc8563dfcb31](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=aee1955a1509a921c05c70dad5d6fc8563dfcb31) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=aee1955a1509a921c05c70dad5d6fc8563dfcb31)) | |
| tree | [2fe02c1455edf42d2f9366ff711db55b89da5ce4](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=aee1955a1509a921c05c70dad5d6fc8563dfcb31) | |
| parent | [9dd7ecab89de40932c2aeaadc55f61e6368815f8](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=9dd7ecab89de40932c2aeaadc55f61e6368815f8) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=aee1955a1509a921c05c70dad5d6fc8563dfcb31&id2=9dd7ecab89de40932c2aeaadc55f61e6368815f8)) | |
| download | [linux-aee1955a1509a921c05c70dad5d6fc8563dfcb31.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-aee1955a1509a921c05c70dad5d6fc8563dfcb31.tar.gz) | |

enic: Validate length of nl attributes in enic\_set\_vf\_port[ Upstream commit e8021b94b0412c37bcc79027c2e382086b6ce449 ]
enic\_set\_vf\_port assumes that the nl attribute IFLA\_PORT\_PROFILE
is of length PORT\_PROFILE\_MAX and that the nl attributes
IFLA\_PORT\_INSTANCE\_UUID, IFLA\_PORT\_HOST\_UUID are of length PORT\_UUID\_MAX.
These attributes are validated (in the function do\_setlink in rtnetlink.c)
using the nla\_policy ifla\_port\_policy. The policy defines IFLA\_PORT\_PROFILE
as NLA\_STRING, IFLA\_PORT\_INSTANCE\_UUID as NLA\_BINARY and
IFLA\_PORT\_HOST\_UUID as NLA\_STRING. That means that the length validation
using the policy is for the max size of the attributes and not on exact
size so the length of these attributes might be less than the sizes that
enic\_set\_vf\_port expects. This might cause an out of bands
read access in the memcpys of the data of these
attributes in enic\_set\_vf\_port.
Fixes: f8bd909183ac ("net: Add ndo\_{set|get}\_vf\_port support for enic dynamic vnics")
Signed-off-by: Roded Zats <rzats@paloaltonetworks.com>
Link: [https://lore.kernel.org/r/20240522073044.33519-1-rzats@paloaltonetworks.com](https://lore.kernel.org/r/20240522073044.33519-1-rzats%40paloaltonetworks.com)
Signed-off-by: Paolo Abeni <pabeni@redhat.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=aee1955a1509a921c05c70dad5d6fc8563dfcb31)

| -rw-r--r-- | [drivers/net/ethernet/cisco/enic/enic\_main.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/ethernet/cisco/enic/enic_main.c?id=aee1955a1509a921c05c70dad5d6fc8563dfcb31) | 12 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 12 insertions, 0 deletions

| diff --git a/drivers/net/ethernet/cisco/enic/enic\_main.c b/drivers/net/ethernet/cisco/enic/enic\_main.cindex d266a87297a5e3..54798df8e2544c 100644--- a/[drivers/net/ethernet/cisco/enic/enic\_main.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/ethernet/cisco/enic/enic_main.c?id=9dd7ecab89de40932c2aeaadc55f61e6368815f8)+++ b/[drivers/net/ethernet/cisco/enic/enic\_main.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/ethernet/cisco/enic/enic_main.c?id=aee1955a1509a921c05c70dad5d6fc8563dfcb31)@@ -1117,18 +1117,30 @@ static int enic\_set\_vf\_port(struct net\_device \*netdev, int vf, pp->request = nla\_get\_u8(port[IFLA\_PORT\_REQUEST]);  if (port[IFLA\_PORT\_PROFILE]) {+ if (nla\_len(port[IFLA\_PORT\_PROFILE]) != PORT\_PROFILE\_MAX) {+ memcpy(pp, &prev\_pp, sizeof(\*pp));+ return -EINVAL;+ } pp->set |= ENIC\_SET\_NAME; memcpy(pp->name, nla\_data(port[IFLA\_PORT\_PROFILE]), PORT\_PROFILE\_MAX); }  if (port[IFLA\_PORT\_INSTANCE\_UUID]) {+ if (nla\_len(port[IFLA\_PORT\_INSTANCE\_UUID]) != PORT\_UUID\_MAX) {+ memcpy(pp, &prev\_pp, sizeof(\*pp));+ return -EINVAL;+ } pp->set |= ENIC\_SET\_INSTANCE; memcpy(pp->instance\_uuid, nla\_data(port[IFLA\_PORT\_INSTANCE\_UUID]), PORT\_UUID\_MAX); }  if (port[IFLA\_PORT\_HOST\_UUID]) {+ if (nla\_len(port[IFLA\_PORT\_HOST\_UUID]) != PORT\_UUID\_MAX) {+ memcpy(pp, &prev\_pp, sizeof(\*pp));+ return -EINVAL;+ } pp->set |= ENIC\_SET\_HOST; memcpy(pp->host\_uuid, nla\_data(port[IFLA\_PORT\_HOST\_UUID]), PORT\_UUID\_MAX); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 23:18:39 +0000

