=== Content from git.kernel.org_01a1b291_20250110_232001.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=7077c22f84f41974a711604a42fd0e0684232ee5)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=7077c22f84f41974a711604a42fd0e0684232ee5)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=7077c22f84f41974a711604a42fd0e0684232ee5)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=7077c22f84f41974a711604a42fd0e0684232ee5)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Roded Zats <rzats@paloaltonetworks.com> | 2024-05-22 10:30:44 +0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-06-12 11:03:56 +0200 |
| commit | [7077c22f84f41974a711604a42fd0e0684232ee5](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=7077c22f84f41974a711604a42fd0e0684232ee5) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=7077c22f84f41974a711604a42fd0e0684232ee5)) | |
| tree | [9b0bba1f05c0989ee6c185e309be15477538d935](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=7077c22f84f41974a711604a42fd0e0684232ee5) | |
| parent | [ce913fd361464fda94ab73e96d105a111f42d4c5](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ce913fd361464fda94ab73e96d105a111f42d4c5) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=7077c22f84f41974a711604a42fd0e0684232ee5&id2=ce913fd361464fda94ab73e96d105a111f42d4c5)) | |
| download | [linux-7077c22f84f41974a711604a42fd0e0684232ee5.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-7077c22f84f41974a711604a42fd0e0684232ee5.tar.gz) | |

enic: Validate length of nl attributes in enic\_set\_vf\_port[ Upstream commit e8021b94b0412c37bcc79027c2e382086b6ce449 ]
enic\_set\_vf\_port assumes that the nl attribute IFLA\_PORT\_PROFILE
is of length PORT\_PROFILE\_MAX and that the nl attributes
IFLA\_PORT\_INSTANCE\_UUID, IFLA\_PORT\_HOST\_UUID are of length PORT\_UUID\_MAX.
These attributes are validated (in the function do\_setlink in rtnetlink.c)
using the nla\_policy ifla\_port\_policy. The policy defines IFLA\_PORT\_PROFILE
as NLA\_STRING, IFLA\_PORT\_INSTANCE\_UUID as NLA\_BINARY and
IFLA\_PORT\_HOST\_UUID as NLA\_STRING. That means that the length validation
using the policy is for the max size of the attributes and not on exact
size so the length of these attributes might be less than the sizes that
enic\_set\_vf\_port expects. This might cause an out of bands
read access in the memcpys of the data of these
attributes in enic\_set\_vf\_port.
Fixes: f8bd909183ac ("net: Add ndo\_{set|get}\_vf\_port support for enic dynamic vnics")
Signed-off-by: Roded Zats <rzats@paloaltonetworks.com>
Link: [https://lore.kernel.org/r/20240522073044.33519-1-rzats@paloaltonetworks.com](https://lore.kernel.org/r/20240522073044.33519-1-rzats%40paloaltonetworks.com)
Signed-off-by: Paolo Abeni <pabeni@redhat.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=7077c22f84f41974a711604a42fd0e0684232ee5)

| -rw-r--r-- | [drivers/net/ethernet/cisco/enic/enic\_main.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/ethernet/cisco/enic/enic_main.c?id=7077c22f84f41974a711604a42fd0e0684232ee5) | 12 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 12 insertions, 0 deletions

| diff --git a/drivers/net/ethernet/cisco/enic/enic\_main.c b/drivers/net/ethernet/cisco/enic/enic\_main.cindex 29500d32e36265..2065c26f394db8 100644--- a/[drivers/net/ethernet/cisco/enic/enic\_main.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/ethernet/cisco/enic/enic_main.c?id=ce913fd361464fda94ab73e96d105a111f42d4c5)+++ b/[drivers/net/ethernet/cisco/enic/enic\_main.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/ethernet/cisco/enic/enic_main.c?id=7077c22f84f41974a711604a42fd0e0684232ee5)@@ -1117,18 +1117,30 @@ static int enic\_set\_vf\_port(struct net\_device \*netdev, int vf, pp->request = nla\_get\_u8(port[IFLA\_PORT\_REQUEST]);  if (port[IFLA\_PORT\_PROFILE]) {+ if (nla\_len(port[IFLA\_PORT\_PROFILE]) != PORT\_PROFILE\_MAX) {+ memcpy(pp, &prev\_pp, sizeof(\*pp));+ return -EINVAL;+ } pp->set |= ENIC\_SET\_NAME; memcpy(pp->name, nla\_data(port[IFLA\_PORT\_PROFILE]), PORT\_PROFILE\_MAX); }  if (port[IFLA\_PORT\_INSTANCE\_UUID]) {+ if (nla\_len(port[IFLA\_PORT\_INSTANCE\_UUID]) != PORT\_UUID\_MAX) {+ memcpy(pp, &prev\_pp, sizeof(\*pp));+ return -EINVAL;+ } pp->set |= ENIC\_SET\_INSTANCE; memcpy(pp->instance\_uuid, nla\_data(port[IFLA\_PORT\_INSTANCE\_UUID]), PORT\_UUID\_MAX); }  if (port[IFLA\_PORT\_HOST\_UUID]) {+ if (nla\_len(port[IFLA\_PORT\_HOST\_UUID]) != PORT\_UUID\_MAX) {+ memcpy(pp, &prev\_pp, sizeof(\*pp));+ return -EINVAL;+ } pp->set |= ENIC\_SET\_HOST; memcpy(pp->host\_uuid, nla\_data(port[IFLA\_PORT\_HOST\_UUID]), PORT\_UUID\_MAX); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 23:18:38 +0000



=== Content from git.kernel.org_66f09065_20250110_232001.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=3c0d36972edbe56fcf98899622d9b90ac9965227)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=3c0d36972edbe56fcf98899622d9b90ac9965227)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3c0d36972edbe56fcf98899622d9b90ac9965227)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3c0d36972edbe56fcf98899622d9b90ac9965227)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Roded Zats <rzats@paloaltonetworks.com> | 2024-05-22 10:30:44 +0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-06-16 13:32:28 +0200 |
| commit | [3c0d36972edbe56fcf98899622d9b90ac9965227](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3c0d36972edbe56fcf98899622d9b90ac9965227) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=3c0d36972edbe56fcf98899622d9b90ac9965227)) | |
| tree | [4455c49e46062853a3bdf6dd911c44eda470fafe](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=3c0d36972edbe56fcf98899622d9b90ac9965227) | |
| parent | [540d73a5c0521ef83af292ec0fe454c91f18fff7](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=540d73a5c0521ef83af292ec0fe454c91f18fff7) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3c0d36972edbe56fcf98899622d9b90ac9965227&id2=540d73a5c0521ef83af292ec0fe454c91f18fff7)) | |
| download | [linux-3c0d36972edbe56fcf98899622d9b90ac9965227.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-3c0d36972edbe56fcf98899622d9b90ac9965227.tar.gz) | |

enic: Validate length of nl attributes in enic\_set\_vf\_port[ Upstream commit e8021b94b0412c37bcc79027c2e382086b6ce449 ]
enic\_set\_vf\_port assumes that the nl attribute IFLA\_PORT\_PROFILE
is of length PORT\_PROFILE\_MAX and that the nl attributes
IFLA\_PORT\_INSTANCE\_UUID, IFLA\_PORT\_HOST\_UUID are of length PORT\_UUID\_MAX.
These attributes are validated (in the function do\_setlink in rtnetlink.c)
using the nla\_policy ifla\_port\_policy. The policy defines IFLA\_PORT\_PROFILE
as NLA\_STRING, IFLA\_PORT\_INSTANCE\_UUID as NLA\_BINARY and
IFLA\_PORT\_HOST\_UUID as NLA\_STRING. That means that the length validation
using the policy is for the max size of the attributes and not on exact
size so the length of these attributes might be less than the sizes that
enic\_set\_vf\_port expects. This might cause an out of bands
read access in the memcpys of the data of these
attributes in enic\_set\_vf\_port.
Fixes: f8bd909183ac ("net: Add ndo\_{set|get}\_vf\_port support for enic dynamic vnics")
Signed-off-by: Roded Zats <rzats@paloaltonetworks.com>
Link: [https://lore.kernel.org/r/20240522073044.33519-1-rzats@paloaltonetworks.com](https://lore.kernel.org/r/20240522073044.33519-1-rzats%40paloaltonetworks.com)
Signed-off-by: Paolo Abeni <pabeni@redhat.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3c0d36972edbe56fcf98899622d9b90ac9965227)

| -rw-r--r-- | [drivers/net/ethernet/cisco/enic/enic\_main.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/ethernet/cisco/enic/enic_main.c?id=3c0d36972edbe56fcf98899622d9b90ac9965227) | 12 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 12 insertions, 0 deletions

| diff --git a/drivers/net/ethernet/cisco/enic/enic\_main.c b/drivers/net/ethernet/cisco/enic/enic\_main.cindex 548d8095c0a797..b695f3f233286c 100644--- a/[drivers/net/ethernet/cisco/enic/enic\_main.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/ethernet/cisco/enic/enic_main.c?id=540d73a5c0521ef83af292ec0fe454c91f18fff7)+++ b/[drivers/net/ethernet/cisco/enic/enic\_main.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/ethernet/cisco/enic/enic_main.c?id=3c0d36972edbe56fcf98899622d9b90ac9965227)@@ -1117,18 +1117,30 @@ static int enic\_set\_vf\_port(struct net\_device \*netdev, int vf, pp->request = nla\_get\_u8(port[IFLA\_PORT\_REQUEST]);  if (port[IFLA\_PORT\_PROFILE]) {+ if (nla\_len(port[IFLA\_PORT\_PROFILE]) != PORT\_PROFILE\_MAX) {+ memcpy(pp, &prev\_pp, sizeof(\*pp));+ return -EINVAL;+ } pp->set |= ENIC\_SET\_NAME; memcpy(pp->name, nla\_data(port[IFLA\_PORT\_PROFILE]), PORT\_PROFILE\_MAX); }  if (port[IFLA\_PORT\_INSTANCE\_UUID]) {+ if (nla\_len(port[IFLA\_PORT\_INSTANCE\_UUID]) != PORT\_UUID\_MAX) {+ memcpy(pp, &prev\_pp, sizeof(\*pp));+ return -EINVAL;+ } pp->set |= ENIC\_SET\_INSTANCE; memcpy(pp->instance\_uuid, nla\_data(port[IFLA\_PORT\_INSTANCE\_UUID]), PORT\_UUID\_MAX); }  if (port[IFLA\_PORT\_HOST\_UUID]) {+ if (nla\_len(port[IFLA\_PORT\_HOST\_UUID]) != PORT\_UUID\_MAX) {+ memcpy(pp, &prev\_pp, sizeof(\*pp));+ return -EINVAL;+ } pp->set |= ENIC\_SET\_HOST; memcpy(pp->host\_uuid, nla\_data(port[IFLA\_PORT\_HOST\_UUID]), PORT\_UUID\_MAX); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 23:18:38 +0000



=== Content from git.kernel.org_7e1458da_20250110_231959.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=25571a12fbc8a1283bd8380d461267956fd426f7)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=25571a12fbc8a1283bd8380d461267956fd426f7)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=25571a12fbc8a1283bd8380d461267956fd426f7)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=25571a12fbc8a1283bd8380d461267956fd426f7)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Roded Zats <rzats@paloaltonetworks.com> | 2024-05-22 10:30:44 +0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-06-16 13:39:50 +0200 |
| commit | [25571a12fbc8a1283bd8380d461267956fd426f7](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=25571a12fbc8a1283bd8380d461267956fd426f7) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=25571a12fbc8a1283bd8380d461267956fd426f7)) | |
| tree | [9bb8355ae483db4dfd303454a962920c42d055fc](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=25571a12fbc8a1283bd8380d461267956fd426f7) | |
| parent | [e5138f43c97de3330f4eb58cbc21e9b226e2605e](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e5138f43c97de3330f4eb58cbc21e9b226e2605e) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=25571a12fbc8a1283bd8380d461267956fd426f7&id2=e5138f43c97de3330f4eb58cbc21e9b226e2605e)) | |
| download | [linux-25571a12fbc8a1283bd8380d461267956fd426f7.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-25571a12fbc8a1283bd8380d461267956fd426f7.tar.gz) | |

enic: Validate length of nl attributes in enic\_set\_vf\_port[ Upstream commit e8021b94b0412c37bcc79027c2e382086b6ce449 ]
enic\_set\_vf\_port assumes that the nl attribute IFLA\_PORT\_PROFILE
is of length PORT\_PROFILE\_MAX and that the nl attributes
IFLA\_PORT\_INSTANCE\_UUID, IFLA\_PORT\_HOST\_UUID are of length PORT\_UUID\_MAX.
These attributes are validated (in the function do\_setlink in rtnetlink.c)
using the nla\_policy ifla\_port\_policy. The policy defines IFLA\_PORT\_PROFILE
as NLA\_STRING, IFLA\_PORT\_INSTANCE\_UUID as NLA\_BINARY and
IFLA\_PORT\_HOST\_UUID as NLA\_STRING. That means that the length validation
using the policy is for the max size of the attributes and not on exact
size so the length of these attributes might be less than the sizes that
enic\_set\_vf\_port expects. This might cause an out of bands
read access in the memcpys of the data of these
attributes in enic\_set\_vf\_port.
Fixes: f8bd909183ac ("net: Add ndo\_{set|get}\_vf\_port support for enic dynamic vnics")
Signed-off-by: Roded Zats <rzats@paloaltonetworks.com>
Link: [https://lore.kernel.org/r/20240522073044.33519-1-rzats@paloaltonetworks.com](https://lore.kernel.org/r/20240522073044.33519-1-rzats%40paloaltonetworks.com)
Signed-off-by: Paolo Abeni <pabeni@redhat.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=25571a12fbc8a1283bd8380d461267956fd426f7)

| -rw-r--r-- | [drivers/net/ethernet/cisco/enic/enic\_main.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/ethernet/cisco/enic/enic_main.c?id=25571a12fbc8a1283bd8380d461267956fd426f7) | 12 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 12 insertions, 0 deletions

| diff --git a/drivers/net/ethernet/cisco/enic/enic\_main.c b/drivers/net/ethernet/cisco/enic/enic\_main.cindex d0a8f7106958bc..52bc164a1cfbc5 100644--- a/[drivers/net/ethernet/cisco/enic/enic\_main.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/ethernet/cisco/enic/enic_main.c?id=e5138f43c97de3330f4eb58cbc21e9b226e2605e)+++ b/[drivers/net/ethernet/cisco/enic/enic\_main.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/ethernet/cisco/enic/enic_main.c?id=25571a12fbc8a1283bd8380d461267956fd426f7)@@ -1117,18 +1117,30 @@ static int enic\_set\_vf\_port(struct net\_device \*netdev, int vf, pp->request = nla\_get\_u8(port[IFLA\_PORT\_REQUEST]);  if (port[IFLA\_PORT\_PROFILE]) {+ if (nla\_len(port[IFLA\_PORT\_PROFILE]) != PORT\_PROFILE\_MAX) {+ memcpy(pp, &prev\_pp, sizeof(\*pp));+ return -EINVAL;+ } pp->set |= ENIC\_SET\_NAME; memcpy(pp->name, nla\_data(port[IFLA\_PORT\_PROFILE]), PORT\_PROFILE\_MAX); }  if (port[IFLA\_PORT\_INSTANCE\_UUID]) {+ if (nla\_len(port[IFLA\_PORT\_INSTANCE\_UUID]) != PORT\_UUID\_MAX) {+ memcpy(pp, &prev\_pp, sizeof(\*pp));+ return -EINVAL;+ } pp->set |= ENIC\_SET\_INSTANCE; memcpy(pp->instance\_uuid, nla\_data(port[IFLA\_PORT\_INSTANCE\_UUID]), PORT\_UUID\_MAX); }  if (port[IFLA\_PORT\_HOST\_UUID]) {+ if (nla\_len(port[IFLA\_PORT\_HOST\_UUID]) != PORT\_UUID\_MAX) {+ memcpy(pp, &prev\_pp, sizeof(\*pp));+ return -EINVAL;+ } pp->set |= ENIC\_SET\_HOST; memcpy(pp->host\_uuid, nla\_data(port[IFLA\_PORT\_HOST\_UUID]), PORT\_UUID\_MAX); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 23:18:36 +0000



=== Content from git.kernel.org_1ed47d57_20250110_232002.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=aee1955a1509a921c05c70dad5d6fc8563dfcb31)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=aee1955a1509a921c05c70dad5d6fc8563dfcb31)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=aee1955a1509a921c05c70dad5d6fc8563dfcb31)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=aee1955a1509a921c05c70dad5d6fc8563dfcb31)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Roded Zats <rzats@paloaltonetworks.com> | 2024-05-22 10:30:44 +0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-06-12 11:39:49 +0200 |
| commit | [aee1955a1509a921c05c70dad5d6fc8563dfcb31](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=aee1955a1509a921c05c70dad5d6fc8563dfcb31) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=aee1955a1509a921c05c70dad5d6fc8563dfcb31)) | |
| tree | [2fe02c1455edf42d2f9366ff711db55b89da5ce4](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=aee1955a1509a921c05c70dad5d6fc8563dfcb31) | |
| parent | [9dd7ecab89de40932c2aeaadc55f61e6368815f8](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=9dd7ecab89de40932c2aeaadc55f61e6368815f8) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=aee1955a1509a921c05c70dad5d6fc8563dfcb31&id2=9dd7ecab89de40932c2aeaadc55f61e6368815f8)) | |
| download | [linux-aee1955a1509a921c05c70dad5d6fc8563dfcb31.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-aee1955a1509a921c05c70dad5d6fc8563dfcb31.tar.gz) | |

enic: Validate length of nl attributes in enic\_set\_vf\_port[ Upstream commit e8021b94b0412c37bcc79027c2e382086b6ce449 ]
enic\_set\_vf\_port assumes that the nl attribute IFLA\_PORT\_PROFILE
is of length PORT\_PROFILE\_MAX and that the nl attributes
IFLA\_PORT\_INSTANCE\_UUID, IFLA\_PORT\_HOST\_UUID are of length PORT\_UUID\_MAX.
These attributes are validated (in the function do\_setlink in rtnetlink.c)
using the nla\_policy ifla\_port\_policy. The policy defines IFLA\_PORT\_PROFILE
as NLA\_STRING, IFLA\_PORT\_INSTANCE\_UUID as NLA\_BINARY and
IFLA\_PORT\_HOST\_UUID as NLA\_STRING. That means that the length validation
using the policy is for the max size of the attributes and not on exact
size so the length of these attributes might be less than the sizes that
enic\_set\_vf\_port expects. This might cause an out of bands
read access in the memcpys of the data of these
attributes in enic\_set\_vf\_port.
Fixes: f8bd909183ac ("net: Add ndo\_{set|get}\_vf\_port support for enic dynamic vnics")
Signed-off-by: Roded Zats <rzats@paloaltonetworks.com>
Link: [https://lore.kernel.org/r/20240522073044.33519-1-rzats@paloaltonetworks.com](https://lore.kernel.org/r/20240522073044.33519-1-rzats%40paloaltonetworks.com)
Signed-off-by: Paolo Abeni <pabeni@redhat.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=aee1955a1509a921c05c70dad5d6fc8563dfcb31)

| -rw-r--r-- | [drivers/net/ethernet/cisco/enic/enic\_main.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/ethernet/cisco/enic/enic_main.c?id=aee1955a1509a921c05c70dad5d6fc8563dfcb31) | 12 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 12 insertions, 0 deletions

| diff --git a/drivers/net/ethernet/cisco/enic/enic\_main.c b/drivers/net/ethernet/cisco/enic/enic\_main.cindex d266a87297a5e3..54798df8e2544c 100644--- a/[drivers/net/ethernet/cisco/enic/enic\_main.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/ethernet/cisco/enic/enic_main.c?id=9dd7ecab89de40932c2aeaadc55f61e6368815f8)+++ b/[drivers/net/ethernet/cisco/enic/enic\_main.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/ethernet/cisco/enic/enic_main.c?id=aee1955a1509a921c05c70dad5d6fc8563dfcb31)@@ -1117,18 +1117,30 @@ static int enic\_set\_vf\_port(struct net\_device \*netdev, int vf, pp->request = nla\_get\_u8(port[IFLA\_PORT\_REQUEST]);  if (port[IFLA\_PORT\_PROFILE]) {+ if (nla\_len(port[IFLA\_PORT\_PROFILE]) != PORT\_PROFILE\_MAX) {+ memcpy(pp, &prev\_pp, sizeof(\*pp));+ return -EINVAL;+ } pp->set |= ENIC\_SET\_NAME; memcpy(pp->name, nla\_data(port[IFLA\_PORT\_PROFILE]), PORT\_PROFILE\_MAX); }  if (port[IFLA\_PORT\_INSTANCE\_UUID]) {+ if (nla\_len(port[IFLA\_PORT\_INSTANCE\_UUID]) != PORT\_UUID\_MAX) {+ memcpy(pp, &prev\_pp, sizeof(\*pp));+ return -EINVAL;+ } pp->set |= ENIC\_SET\_INSTANCE; memcpy(pp->instance\_uuid, nla\_data(port[IFLA\_PORT\_INSTANCE\_UUID]), PORT\_UUID\_MAX); }  if (port[IFLA\_PORT\_HOST\_UUID]) {+ if (nla\_len(port[IFLA\_PORT\_HOST\_UUID]) != PORT\_UUID\_MAX) {+ memcpy(pp, &prev\_pp, sizeof(\*pp));+ return -EINVAL;+ } pp->set |= ENIC\_SET\_HOST; memcpy(pp->host\_uuid, nla\_data(port[IFLA\_PORT\_HOST\_UUID]), PORT\_UUID\_MAX); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 23:18:39 +0000



=== Content from git.kernel.org_27cc27a9_20250110_232000.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=2b649d7e0cb42a660f0260ef25fd55fdc9c6c600)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=2b649d7e0cb42a660f0260ef25fd55fdc9c6c600)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2b649d7e0cb42a660f0260ef25fd55fdc9c6c600)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=2b649d7e0cb42a660f0260ef25fd55fdc9c6c600)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Roded Zats <rzats@paloaltonetworks.com> | 2024-05-22 10:30:44 +0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-06-16 13:23:37 +0200 |
| commit | [2b649d7e0cb42a660f0260ef25fd55fdc9c6c600](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2b649d7e0cb42a660f0260ef25fd55fdc9c6c600) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=2b649d7e0cb42a660f0260ef25fd55fdc9c6c600)) | |
| tree | [cca4c12fab1b0a774734cc505a440c9ca2eb3eaa](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=2b649d7e0cb42a660f0260ef25fd55fdc9c6c600) | |
| parent | [1ff116f68560a25656933d5a18e7619cb6773d8a](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=1ff116f68560a25656933d5a18e7619cb6773d8a) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=2b649d7e0cb42a660f0260ef25fd55fdc9c6c600&id2=1ff116f68560a25656933d5a18e7619cb6773d8a)) | |
| download | [linux-2b649d7e0cb42a660f0260ef25fd55fdc9c6c600.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-2b649d7e0cb42a660f0260ef25fd55fdc9c6c600.tar.gz) | |

enic: Validate length of nl attributes in enic\_set\_vf\_port[ Upstream commit e8021b94b0412c37bcc79027c2e382086b6ce449 ]
enic\_set\_vf\_port assumes that the nl attribute IFLA\_PORT\_PROFILE
is of length PORT\_PROFILE\_MAX and that the nl attributes
IFLA\_PORT\_INSTANCE\_UUID, IFLA\_PORT\_HOST\_UUID are of length PORT\_UUID\_MAX.
These attributes are validated (in the function do\_setlink in rtnetlink.c)
using the nla\_policy ifla\_port\_policy. The policy defines IFLA\_PORT\_PROFILE
as NLA\_STRING, IFLA\_PORT\_INSTANCE\_UUID as NLA\_BINARY and
IFLA\_PORT\_HOST\_UUID as NLA\_STRING. That means that the length validation
using the policy is for the max size of the attributes and not on exact
size so the length of these attributes might be less than the sizes that
enic\_set\_vf\_port expects. This might cause an out of bands
read access in the memcpys of the data of these
attributes in enic\_set\_vf\_port.
Fixes: f8bd909183ac ("net: Add ndo\_{set|get}\_vf\_port support for enic dynamic vnics")
Signed-off-by: Roded Zats <rzats@paloaltonetworks.com>
Link: [https://lore.kernel.org/r/20240522073044.33519-1-rzats@paloaltonetworks.com](https://lore.kernel.org/r/20240522073044.33519-1-rzats%40paloaltonetworks.com)
Signed-off-by: Paolo Abeni <pabeni@redhat.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=2b649d7e0cb42a660f0260ef25fd55fdc9c6c600)

| -rw-r--r-- | [drivers/net/ethernet/cisco/enic/enic\_main.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/ethernet/cisco/enic/enic_main.c?id=2b649d7e0cb42a660f0260ef25fd55fdc9c6c600) | 12 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 12 insertions, 0 deletions

| diff --git a/drivers/net/ethernet/cisco/enic/enic\_main.c b/drivers/net/ethernet/cisco/enic/enic\_main.cindex bfe0e820956cac..6ad1734d967770 100644--- a/[drivers/net/ethernet/cisco/enic/enic\_main.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/ethernet/cisco/enic/enic_main.c?id=1ff116f68560a25656933d5a18e7619cb6773d8a)+++ b/[drivers/net/ethernet/cisco/enic/enic\_main.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/ethernet/cisco/enic/enic_main.c?id=2b649d7e0cb42a660f0260ef25fd55fdc9c6c600)@@ -1152,18 +1152,30 @@ static int enic\_set\_vf\_port(struct net\_device \*netdev, int vf, pp->request = nla\_get\_u8(port[IFLA\_PORT\_REQUEST]);  if (port[IFLA\_PORT\_PROFILE]) {+ if (nla\_len(port[IFLA\_PORT\_PROFILE]) != PORT\_PROFILE\_MAX) {+ memcpy(pp, &prev\_pp, sizeof(\*pp));+ return -EINVAL;+ } pp->set |= ENIC\_SET\_NAME; memcpy(pp->name, nla\_data(port[IFLA\_PORT\_PROFILE]), PORT\_PROFILE\_MAX); }  if (port[IFLA\_PORT\_INSTANCE\_UUID]) {+ if (nla\_len(port[IFLA\_PORT\_INSTANCE\_UUID]) != PORT\_UUID\_MAX) {+ memcpy(pp, &prev\_pp, sizeof(\*pp));+ return -EINVAL;+ } pp->set |= ENIC\_SET\_INSTANCE; memcpy(pp->instance\_uuid, nla\_data(port[IFLA\_PORT\_INSTANCE\_UUID]), PORT\_UUID\_MAX); }  if (port[IFLA\_PORT\_HOST\_UUID]) {+ if (nla\_len(port[IFLA\_PORT\_HOST\_UUID]) != PORT\_UUID\_MAX) {+ memcpy(pp, &prev\_pp, sizeof(\*pp));+ return -EINVAL;+ } pp->set |= ENIC\_SET\_HOST; memcpy(pp->host\_uuid, nla\_data(port[IFLA\_PORT\_HOST\_UUID]), PORT\_UUID\_MAX); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 23:18:37 +0000



=== Content from git.kernel.org_c0475e56_20250110_232004.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=f6638e955ca00c489894789492776842e102af9c)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=f6638e955ca00c489894789492776842e102af9c)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f6638e955ca00c489894789492776842e102af9c)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f6638e955ca00c489894789492776842e102af9c)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Roded Zats <rzats@paloaltonetworks.com> | 2024-05-22 10:30:44 +0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-06-12 11:12:55 +0200 |
| commit | [f6638e955ca00c489894789492776842e102af9c](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f6638e955ca00c489894789492776842e102af9c) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=f6638e955ca00c489894789492776842e102af9c)) | |
| tree | [9875233a6308392fd57fe04a24592080ae156a9f](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=f6638e955ca00c489894789492776842e102af9c) | |
| parent | [07bbe6668e1ef86daf89dc8f062a0a72258cd6b1](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=07bbe6668e1ef86daf89dc8f062a0a72258cd6b1) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f6638e955ca00c489894789492776842e102af9c&id2=07bbe6668e1ef86daf89dc8f062a0a72258cd6b1)) | |
| download | [linux-f6638e955ca00c489894789492776842e102af9c.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-f6638e955ca00c489894789492776842e102af9c.tar.gz) | |

enic: Validate length of nl attributes in enic\_set\_vf\_port[ Upstream commit e8021b94b0412c37bcc79027c2e382086b6ce449 ]
enic\_set\_vf\_port assumes that the nl attribute IFLA\_PORT\_PROFILE
is of length PORT\_PROFILE\_MAX and that the nl attributes
IFLA\_PORT\_INSTANCE\_UUID, IFLA\_PORT\_HOST\_UUID are of length PORT\_UUID\_MAX.
These attributes are validated (in the function do\_setlink in rtnetlink.c)
using the nla\_policy ifla\_port\_policy. The policy defines IFLA\_PORT\_PROFILE
as NLA\_STRING, IFLA\_PORT\_INSTANCE\_UUID as NLA\_BINARY and
IFLA\_PORT\_HOST\_UUID as NLA\_STRING. That means that the length validation
using the policy is for the max size of the attributes and not on exact
size so the length of these attributes might be less than the sizes that
enic\_set\_vf\_port expects. This might cause an out of bands
read access in the memcpys of the data of these
attributes in enic\_set\_vf\_port.
Fixes: f8bd909183ac ("net: Add ndo\_{set|get}\_vf\_port support for enic dynamic vnics")
Signed-off-by: Roded Zats <rzats@paloaltonetworks.com>
Link: [https://lore.kernel.org/r/20240522073044.33519-1-rzats@paloaltonetworks.com](https://lore.kernel.org/r/20240522073044.33519-1-rzats%40paloaltonetworks.com)
Signed-off-by: Paolo Abeni <pabeni@redhat.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f6638e955ca00c489894789492776842e102af9c)

| -rw-r--r-- | [drivers/net/ethernet/cisco/enic/enic\_main.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/ethernet/cisco/enic/enic_main.c?id=f6638e955ca00c489894789492776842e102af9c) | 12 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 12 insertions, 0 deletions

| diff --git a/drivers/net/ethernet/cisco/enic/enic\_main.c b/drivers/net/ethernet/cisco/enic/enic\_main.cindex 37bd38d772e809..cccf0db2fb4e58 100644--- a/[drivers/net/ethernet/cisco/enic/enic\_main.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/ethernet/cisco/enic/enic_main.c?id=07bbe6668e1ef86daf89dc8f062a0a72258cd6b1)+++ b/[drivers/net/ethernet/cisco/enic/enic\_main.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/ethernet/cisco/enic/enic_main.c?id=f6638e955ca00c489894789492776842e102af9c)@@ -1117,18 +1117,30 @@ static int enic\_set\_vf\_port(struct net\_device \*netdev, int vf, pp->request = nla\_get\_u8(port[IFLA\_PORT\_REQUEST]);  if (port[IFLA\_PORT\_PROFILE]) {+ if (nla\_len(port[IFLA\_PORT\_PROFILE]) != PORT\_PROFILE\_MAX) {+ memcpy(pp, &prev\_pp, sizeof(\*pp));+ return -EINVAL;+ } pp->set |= ENIC\_SET\_NAME; memcpy(pp->name, nla\_data(port[IFLA\_PORT\_PROFILE]), PORT\_PROFILE\_MAX); }  if (port[IFLA\_PORT\_INSTANCE\_UUID]) {+ if (nla\_len(port[IFLA\_PORT\_INSTANCE\_UUID]) != PORT\_UUID\_MAX) {+ memcpy(pp, &prev\_pp, sizeof(\*pp));+ return -EINVAL;+ } pp->set |= ENIC\_SET\_INSTANCE; memcpy(pp->instance\_uuid, nla\_data(port[IFLA\_PORT\_INSTANCE\_UUID]), PORT\_UUID\_MAX); }  if (port[IFLA\_PORT\_HOST\_UUID]) {+ if (nla\_len(port[IFLA\_PORT\_HOST\_UUID]) != PORT\_UUID\_MAX) {+ memcpy(pp, &prev\_pp, sizeof(\*pp));+ return -EINVAL;+ } pp->set |= ENIC\_SET\_HOST; memcpy(pp->host\_uuid, nla\_data(port[IFLA\_PORT\_HOST\_UUID]), PORT\_UUID\_MAX); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 23:18:41 +0000



=== Content from git.kernel.org_1e3be909_20250110_232003.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=ca63fb7af9d3e531aa25f7ae187bfc6c7166ec2d)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=ca63fb7af9d3e531aa25f7ae187bfc6c7166ec2d)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ca63fb7af9d3e531aa25f7ae187bfc6c7166ec2d)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ca63fb7af9d3e531aa25f7ae187bfc6c7166ec2d)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Roded Zats <rzats@paloaltonetworks.com> | 2024-05-22 10:30:44 +0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-06-16 13:28:47 +0200 |
| commit | [ca63fb7af9d3e531aa25f7ae187bfc6c7166ec2d](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ca63fb7af9d3e531aa25f7ae187bfc6c7166ec2d) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=ca63fb7af9d3e531aa25f7ae187bfc6c7166ec2d)) | |
| tree | [54c2e655e459cfa2f5cf8cb713b62d794caa2c7b](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=ca63fb7af9d3e531aa25f7ae187bfc6c7166ec2d) | |
| parent | [165b25e3ee9333f7b04f8db43895beacb51582ed](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=165b25e3ee9333f7b04f8db43895beacb51582ed) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ca63fb7af9d3e531aa25f7ae187bfc6c7166ec2d&id2=165b25e3ee9333f7b04f8db43895beacb51582ed)) | |
| download | [linux-ca63fb7af9d3e531aa25f7ae187bfc6c7166ec2d.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-ca63fb7af9d3e531aa25f7ae187bfc6c7166ec2d.tar.gz) | |

enic: Validate length of nl attributes in enic\_set\_vf\_port[ Upstream commit e8021b94b0412c37bcc79027c2e382086b6ce449 ]
enic\_set\_vf\_port assumes that the nl attribute IFLA\_PORT\_PROFILE
is of length PORT\_PROFILE\_MAX and that the nl attributes
IFLA\_PORT\_INSTANCE\_UUID, IFLA\_PORT\_HOST\_UUID are of length PORT\_UUID\_MAX.
These attributes are validated (in the function do\_setlink in rtnetlink.c)
using the nla\_policy ifla\_port\_policy. The policy defines IFLA\_PORT\_PROFILE
as NLA\_STRING, IFLA\_PORT\_INSTANCE\_UUID as NLA\_BINARY and
IFLA\_PORT\_HOST\_UUID as NLA\_STRING. That means that the length validation
using the policy is for the max size of the attributes and not on exact
size so the length of these attributes might be less than the sizes that
enic\_set\_vf\_port expects. This might cause an out of bands
read access in the memcpys of the data of these
attributes in enic\_set\_vf\_port.
Fixes: f8bd909183ac ("net: Add ndo\_{set|get}\_vf\_port support for enic dynamic vnics")
Signed-off-by: Roded Zats <rzats@paloaltonetworks.com>
Link: [https://lore.kernel.org/r/20240522073044.33519-1-rzats@paloaltonetworks.com](https://lore.kernel.org/r/20240522073044.33519-1-rzats%40paloaltonetworks.com)
Signed-off-by: Paolo Abeni <pabeni@redhat.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ca63fb7af9d3e531aa25f7ae187bfc6c7166ec2d)

| -rw-r--r-- | [drivers/net/ethernet/cisco/enic/enic\_main.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/ethernet/cisco/enic/enic_main.c?id=ca63fb7af9d3e531aa25f7ae187bfc6c7166ec2d) | 12 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 12 insertions, 0 deletions

| diff --git a/drivers/net/ethernet/cisco/enic/enic\_main.c b/drivers/net/ethernet/cisco/enic/enic\_main.cindex 03c8af58050c96..892c4b5ff30363 100644--- a/[drivers/net/ethernet/cisco/enic/enic\_main.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/ethernet/cisco/enic/enic_main.c?id=165b25e3ee9333f7b04f8db43895beacb51582ed)+++ b/[drivers/net/ethernet/cisco/enic/enic\_main.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/ethernet/cisco/enic/enic_main.c?id=ca63fb7af9d3e531aa25f7ae187bfc6c7166ec2d)@@ -1152,18 +1152,30 @@ static int enic\_set\_vf\_port(struct net\_device \*netdev, int vf, pp->request = nla\_get\_u8(port[IFLA\_PORT\_REQUEST]);  if (port[IFLA\_PORT\_PROFILE]) {+ if (nla\_len(port[IFLA\_PORT\_PROFILE]) != PORT\_PROFILE\_MAX) {+ memcpy(pp, &prev\_pp, sizeof(\*pp));+ return -EINVAL;+ } pp->set |= ENIC\_SET\_NAME; memcpy(pp->name, nla\_data(port[IFLA\_PORT\_PROFILE]), PORT\_PROFILE\_MAX); }  if (port[IFLA\_PORT\_INSTANCE\_UUID]) {+ if (nla\_len(port[IFLA\_PORT\_INSTANCE\_UUID]) != PORT\_UUID\_MAX) {+ memcpy(pp, &prev\_pp, sizeof(\*pp));+ return -EINVAL;+ } pp->set |= ENIC\_SET\_INSTANCE; memcpy(pp->instance\_uuid, nla\_data(port[IFLA\_PORT\_INSTANCE\_UUID]), PORT\_UUID\_MAX); }  if (port[IFLA\_PORT\_HOST\_UUID]) {+ if (nla\_len(port[IFLA\_PORT\_HOST\_UUID]) != PORT\_UUID\_MAX) {+ memcpy(pp, &prev\_pp, sizeof(\*pp));+ return -EINVAL;+ } pp->set |= ENIC\_SET\_HOST; memcpy(pp->host\_uuid, nla\_data(port[IFLA\_PORT\_HOST\_UUID]), PORT\_UUID\_MAX); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 23:18:40 +0000



=== Content from git.kernel.org_c470791c_20250110_232003.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=e8021b94b0412c37bcc79027c2e382086b6ce449)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=e8021b94b0412c37bcc79027c2e382086b6ce449)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e8021b94b0412c37bcc79027c2e382086b6ce449)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e8021b94b0412c37bcc79027c2e382086b6ce449)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Roded Zats <rzats@paloaltonetworks.com> | 2024-05-22 10:30:44 +0300 |
| --- | --- | --- |
| committer | Paolo Abeni <pabeni@redhat.com> | 2024-05-27 11:18:01 +0200 |
| commit | [e8021b94b0412c37bcc79027c2e382086b6ce449](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e8021b94b0412c37bcc79027c2e382086b6ce449) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=e8021b94b0412c37bcc79027c2e382086b6ce449)) | |
| tree | [5e2720872cdc9e6558dae1623298f8fa339fe1da](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=e8021b94b0412c37bcc79027c2e382086b6ce449) | |
| parent | [0b4f5add9fa59bfd42c1030f572db2e4c395181b](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0b4f5add9fa59bfd42c1030f572db2e4c395181b) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e8021b94b0412c37bcc79027c2e382086b6ce449&id2=0b4f5add9fa59bfd42c1030f572db2e4c395181b)) | |
| download | [linux-e8021b94b0412c37bcc79027c2e382086b6ce449.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-e8021b94b0412c37bcc79027c2e382086b6ce449.tar.gz) | |

enic: Validate length of nl attributes in enic\_set\_vf\_portenic\_set\_vf\_port assumes that the nl attribute IFLA\_PORT\_PROFILE
is of length PORT\_PROFILE\_MAX and that the nl attributes
IFLA\_PORT\_INSTANCE\_UUID, IFLA\_PORT\_HOST\_UUID are of length PORT\_UUID\_MAX.
These attributes are validated (in the function do\_setlink in rtnetlink.c)
using the nla\_policy ifla\_port\_policy. The policy defines IFLA\_PORT\_PROFILE
as NLA\_STRING, IFLA\_PORT\_INSTANCE\_UUID as NLA\_BINARY and
IFLA\_PORT\_HOST\_UUID as NLA\_STRING. That means that the length validation
using the policy is for the max size of the attributes and not on exact
size so the length of these attributes might be less than the sizes that
enic\_set\_vf\_port expects. This might cause an out of bands
read access in the memcpys of the data of these
attributes in enic\_set\_vf\_port.
Fixes: f8bd909183ac ("net: Add ndo\_{set|get}\_vf\_port support for enic dynamic vnics")
Signed-off-by: Roded Zats <rzats@paloaltonetworks.com>
Link: [https://lore.kernel.org/r/20240522073044.33519-1-rzats@paloaltonetworks.com](https://lore.kernel.org/r/20240522073044.33519-1-rzats%40paloaltonetworks.com)
Signed-off-by: Paolo Abeni <pabeni@redhat.com>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e8021b94b0412c37bcc79027c2e382086b6ce449)

| -rw-r--r-- | [drivers/net/ethernet/cisco/enic/enic\_main.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/ethernet/cisco/enic/enic_main.c?id=e8021b94b0412c37bcc79027c2e382086b6ce449) | 12 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 12 insertions, 0 deletions

| diff --git a/drivers/net/ethernet/cisco/enic/enic\_main.c b/drivers/net/ethernet/cisco/enic/enic\_main.cindex f604119efc8098..5f26fc3ad65556 100644--- a/[drivers/net/ethernet/cisco/enic/enic\_main.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/ethernet/cisco/enic/enic_main.c?id=0b4f5add9fa59bfd42c1030f572db2e4c395181b)+++ b/[drivers/net/ethernet/cisco/enic/enic\_main.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/ethernet/cisco/enic/enic_main.c?id=e8021b94b0412c37bcc79027c2e382086b6ce449)@@ -1117,18 +1117,30 @@ static int enic\_set\_vf\_port(struct net\_device \*netdev, int vf, pp->request = nla\_get\_u8(port[IFLA\_PORT\_REQUEST]);  if (port[IFLA\_PORT\_PROFILE]) {+ if (nla\_len(port[IFLA\_PORT\_PROFILE]) != PORT\_PROFILE\_MAX) {+ memcpy(pp, &prev\_pp, sizeof(\*pp));+ return -EINVAL;+ } pp->set |= ENIC\_SET\_NAME; memcpy(pp->name, nla\_data(port[IFLA\_PORT\_PROFILE]), PORT\_PROFILE\_MAX); }  if (port[IFLA\_PORT\_INSTANCE\_UUID]) {+ if (nla\_len(port[IFLA\_PORT\_INSTANCE\_UUID]) != PORT\_UUID\_MAX) {+ memcpy(pp, &prev\_pp, sizeof(\*pp));+ return -EINVAL;+ } pp->set |= ENIC\_SET\_INSTANCE; memcpy(pp->instance\_uuid, nla\_data(port[IFLA\_PORT\_INSTANCE\_UUID]), PORT\_UUID\_MAX); }  if (port[IFLA\_PORT\_HOST\_UUID]) {+ if (nla\_len(port[IFLA\_PORT\_HOST\_UUID]) != PORT\_UUID\_MAX) {+ memcpy(pp, &prev\_pp, sizeof(\*pp));+ return -EINVAL;+ } pp->set |= ENIC\_SET\_HOST; memcpy(pp->host\_uuid, nla\_data(port[IFLA\_PORT\_HOST\_UUID]), PORT\_UUID\_MAX); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 23:18:40 +0000


