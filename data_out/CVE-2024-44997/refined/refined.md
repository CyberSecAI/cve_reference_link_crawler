The provided content relates to CVE-2024-44997.

**Root cause of vulnerability:**
A use-after-free vulnerability occurs in the `mtk_wed_setup_tc_block_cb` function. The `cb_priv` pointer, which is a pointer to a `mtk_wed_flow_block_priv` structure, is freed in `mtk_wed_setup_tc_block` without setting it to NULL. Subsequently, `mtk_wed_setup_tc_block_cb` attempts to dereference this freed pointer.

**Weaknesses/vulnerabilities present:**
- Use-after-free vulnerability: The `cb_priv` is freed and then used.

**Impact of exploitation:**
- Kernel panic: Accessing the freed memory results in a kernel panic, leading to a denial of service.

**Attack vectors:**
- Multiple AP interfaces on one band with WED (Wireless Ethernet Dispatch) enabled: Turning off the interface triggers the vulnerability.
- Traffic control (tc) offload: The vulnerability is triggered through the traffic control subsystem.

**Required attacker capabilities/position:**
- Ability to configure multiple AP interfaces on the affected device.
- Ability to enable and disable the network interfaces.
- Exploitation requires interaction with the traffic control subsystem.