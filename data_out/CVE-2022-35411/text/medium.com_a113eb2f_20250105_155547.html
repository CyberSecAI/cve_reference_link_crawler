[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F709c76690c30&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40elias.hohl%2Fremote-code-execution-0-day-in-rpc-py-709c76690c30&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40elias.hohl%2Fremote-code-execution-0-day-in-rpc-py-709c76690c30&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# Remote Code Execution 0-day in rpc.py

[![Elias Hohl](https://miro.medium.com/v2/resize:fill:88:88/1*nxGt_NshDaYQSvCTt14RaQ.png)](/%40elias.hohl?source=post_page---byline--709c76690c30--------------------------------)

[Elias Hohl](/%40elias.hohl?source=post_page---byline--709c76690c30--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd2ad5aa4f9df&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40elias.hohl%2Fremote-code-execution-0-day-in-rpc-py-709c76690c30&user=Elias+Hohl&userId=d2ad5aa4f9df&source=post_page-d2ad5aa4f9df--byline--709c76690c30---------------------post_header-----------)

2 min read·Jul 5, 2022

--

Listen

Share

![]()

There is an Unauthenticated Remote Code Execution vulnerability in <https://pypi.org/project/rpc.py/>. No specific configuration is required, it works with the scripts from the “examples” folder. Versions v0.4.2 to v0.6.0 (latest) are affected. The maintainer has not replied to my emails in a time frame of two weeks, so I decided to disclose the vulnerability. The package has around 150 stars on Github at the time of writing and is advertised in the official ASGI documentations: <https://asgi.readthedocs.io/en/latest/implementations.html>

The vulnerability was assigned CVE-2022–35411.

According to the rpc.py documentation: Currently supports three serializers, JSON, Pickle, Msgpack and CBOR. JSON is used by default. You can override the default `JSONSerializer` with parameters.

This is, however, not the whole truth. Looking at the code, one can see that this function somehow chooses the serializer according to the request headers:

The `get_serializer` function:

All we need to do is to pass the request header `serializer: pickle` and we can execute arbitrary code on the server by sending a malicious pickle payload.

The attack works against both `sync_server.py` and `async_server.py` from the “examples” folder.

The full exploit code can be found here:

[## GitHub - ehtec/rpcpy-exploit: Unauthenticated Remote Code Execution for rpc.py server

### You can't perform that action at this time. You signed in with another tab or window. You signed out in another tab or…

github.com](https://github.com/ehtec/rpcpy-exploit/?source=post_page-----709c76690c30--------------------------------)[Cybersecurity](/tag/cybersecurity?source=post_page-----709c76690c30--------------------------------)[Remote Code Execution](/tag/remote-code-execution?source=post_page-----709c76690c30--------------------------------)[Rpc](/tag/rpc?source=post_page-----709c76690c30--------------------------------)[Python](/tag/python?source=post_page-----709c76690c30--------------------------------)[Vulnerability](/tag/vulnerability?source=post_page-----709c76690c30--------------------------------)

--

--

[![Elias Hohl](https://miro.medium.com/v2/resize:fill:96:96/1*nxGt_NshDaYQSvCTt14RaQ.png)](/%40elias.hohl?source=post_page---post_author_info--709c76690c30--------------------------------)[![Elias Hohl](https://miro.medium.com/v2/resize:fill:128:128/1*nxGt_NshDaYQSvCTt14RaQ.png)](/%40elias.hohl?source=post_page---post_author_info--709c76690c30--------------------------------)Follow[## Written by Elias Hohl](/%40elias.hohl?source=post_page---post_author_info--709c76690c30--------------------------------)[27 Followers](/%40elias.hohl/followers?source=post_page---post_author_info--709c76690c30--------------------------------)·[2 Following](/%40elias.hohl/following?source=post_page---post_author_info--709c76690c30--------------------------------)

CEO CryptoSearchTools | IPhO Gold medalist & Austrian national trainer | Cybersecurity expert

Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----709c76690c30--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----709c76690c30--------------------------------)[About](/about?autoplay=1&source=post_page-----709c76690c30--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----709c76690c30--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----709c76690c30--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----709c76690c30--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----709c76690c30--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----709c76690c30--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----709c76690c30--------------------------------)[Teams](/business?source=post_page-----709c76690c30--------------------------------)

