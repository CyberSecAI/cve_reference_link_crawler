

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3135472%2Fultimate-store-kit%2Ftrunk%2Fincludes%2Fhelper.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/3106405/ultimate-store-kit/trunk/includes/helper.php "Changeset 3106405 for ultimate-store-kit/trunk/includes/helper.php")
* [Next Change](/changeset/3141022/ultimate-store-kit/trunk/includes/helper.php "Changeset 3141022 for ultimate-store-kit/trunk/includes/helper.php") →

---

# Changeset [3135472](/changeset/3135472 "Show full changeset") for [ultimate-store-kit/trunk/includes/helper.php](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
08/14/2024 10:46:36 AM
([5 months](/timeline?from=2024-08-14T10%3A46%3A36Z&precision=second "See timeline at 08/14/2024 10:46:36 AM") ago)

Author:
mohammaadfarid
Message:

readme.txt

File:

1 edited

* [ultimate-store-kit/trunk/includes/helper.php](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472 "Show entry in browser")
  (modified)
  ([55 diffs](#file0 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [ultimate-store-kit/trunk/includes/helper.php](/changeset/3135472/ultimate-store-kit/trunk/includes/helper.php "Show the changeset 3135472 restricted to ultimate-store-kit/trunk/includes/helper.php")

  | [r3106405](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L10 "Show revision 3106405 of this file in browser") | [r3135472](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L10 "Show revision 3135472 of this file in browser") |  |
  | --- | --- | --- |
  | 10 | 10 | \*/ |
  | 11 | 11 |  |
  | 12 |  | if (~~!defined('BDTUSK')~~) { |
  | 13 |  | define(~~'BDTUSK', ''~~); |
  |  | 12 | if ( ! defined( 'BDTUSK' ) ) { |
  |  | 13 | define( 'BDTUSK', '' ); |
  | 14 | 14 | } |
  | 15 | 15 |  |
  | 16 | 16 | //Add prefix for all widgets <span class="usk-widget-badge"></span> |
  | 17 |  | if (~~!defined('BDTUSK\_CP')~~) { |
  | 18 |  | define(~~'BDTUSK\_CP', '<span class="usk-widget-badge"></span>'~~); |
  |  | 17 | if ( ! defined( 'BDTUSK\_CP' ) ) { |
  |  | 18 | define( 'BDTUSK\_CP', '<span class="usk-widget-badge"></span>' ); |
  | 19 | 19 | } |
  | 20 | 20 |  |
  | 21 | 21 | //Add prefix for all widgets <span class="usk-widget-badge"></span> |
  | 22 |  | if (~~!defined('BDTUSK\_NC')~~) { |
  | 23 |  | define(~~'BDTUSK\_NC', '<span class="usk-new-control"></span>'~~); |
  |  | 22 | if ( ! defined( 'BDTUSK\_NC' ) ) { |
  |  | 23 | define( 'BDTUSK\_NC', '<span class="usk-new-control"></span>' ); |
  | 24 | 24 | } |
  | 25 | 25 |  |
  | 26 | 26 | // if you have any custom style |
  | 27 |  | if (~~!defined('BDTUSK\_SLUG')~~) { |
  | 28 |  | define(~~'BDTUSK\_SLUG', 'ultimate-store-kit'~~); |
  |  | 27 | if ( ! defined( 'BDTUSK\_SLUG' ) ) { |
  |  | 28 | define( 'BDTUSK\_SLUG', 'ultimate-store-kit' ); |
  | 29 | 29 | } |
  | 30 | 30 |  |
  | 31 | 31 | // set your own alias |
  | 32 |  | if (~~!defined('BDTUSK\_VER')~~) { |
  | 33 |  | define(~~'BDTUSK\_VER', 'Ultimate Store Kit'~~); |
  |  | 32 | if ( ! defined( 'BDTUSK\_VER' ) ) { |
  |  | 33 | define( 'BDTUSK\_VER', 'Ultimate Store Kit' ); |
  | 34 | 34 | } |
  | 35 | 35 |  |
  | 36 | 36 | // Set your own name for plugin |
  | 37 | 37 |  |
  | 38 |  | if (~~!defined('BDTUSK\_NAME')~~) { |
  | 39 |  | define(~~'BDTUSK\_NAME', 'Ultimate Store Kit'~~); |
  |  | 38 | if ( ! defined( 'BDTUSK\_NAME' ) ) { |
  |  | 39 | define( 'BDTUSK\_NAME', 'Ultimate Store Kit' ); |
  | 40 | 40 | } |
  | 41 | 41 |  |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L59) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L59) |  |
  | 59 | 59 | } |
  | 60 | 60 |  |
  | 61 |  | function ultimate\_store\_kit\_alert(~~$message, $type = 'warning', $close = true~~) { |
  | 62 |  | ?> |
  | 63 |  | <div class="usk-alert-<?php echo esc\_attr(~~'$type'~~); ?>" usk-alert> |
  | 64 |  | <?php if (~~$close~~) : ?> |
  |  | 61 | function ultimate\_store\_kit\_alert( $message, $type = 'warning', $close = true ) { |
  |  | 62 | ?> |
  |  | 63 | <div class="usk-alert-<?php echo esc\_attr( '$type' ); ?>" usk-alert> |
  |  | 64 | <?php if ( $close ) : ?> |
  | 65 | 65 | <a class="usk-alert-close" usk-close></a> |
  | 66 | 66 | <?php endif; ?> |
  | 67 |  | <?php echo wp\_kses\_post(~~$message~~); ?> |
  |  | 67 | <?php echo wp\_kses\_post( $message ); ?> |
  | 68 | 68 | </div> |
  | 69 | 69 | <?php |
  | 70 | 70 | } |
  | 71 | 71 |  |
  | 72 |  | function ultimate\_store\_kit\_get\_alert(~~$message, $type = 'warning', $close = true~~) { |
  |  | 72 | function ultimate\_store\_kit\_get\_alert( $message, $type = 'warning', $close = true ) { |
  | 73 | 73 |  |
  | 74 | 74 | $output = '<div class="usk-alert-' . $type . '" usk-alert>'; |
  | 75 |  | if (~~$close~~) : |
  |  | 75 | if ( $close ) : |
  | 76 | 76 | $output .= '<a class="usk-alert-close" usk-close></a>'; |
  | 77 | 77 | endif; |
  | 78 |  | $output .= wp\_kses\_post(~~$message~~); |
  |  | 78 | $output .= wp\_kses\_post( $message ); |
  | 79 | 79 | $output .= '</div>'; |
  | 80 | 80 |  |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L90) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L90) |  |
  | 90 | 90 | \*/ |
  | 91 | 91 |  |
  | 92 |  | function ultimate\_store\_kit\_get\_post\_types(~~$args = []~~) { |
  | 93 |  |  |
  | 94 |  | $post\_type\_args = [ |
  |  | 92 | function ultimate\_store\_kit\_get\_post\_types( $args = [] ) { |
  |  | 93 |  |
  |  | 94 | $post\_type\_args = [ |
  | 95 | 95 | 'show\_in\_nav\_menus' => true, |
  | 96 | 96 | ]; |
  | 97 | 97 |  |
  | 98 |  | if (~~!empty($args['post\_type'])~~) { |
  |  | 98 | if ( ! empty( $args['post\_type'] ) ) { |
  | 99 | 99 | $post\_type\_args['name'] = $args['post\_type']; |
  | 100 | 100 | } |
  | 101 | 101 |  |
  | 102 |  | $\_post\_types = get\_post\_types(~~$post\_type\_args, 'objects'~~); |
  | 103 |  |  |
  | 104 |  | $post\_types = [~~'0' => esc\_html\_\_('Select Type', 'ultimate-store-kit')~~]; |
  | 105 |  |  |
  | 106 |  | foreach (~~$\_post\_types as $post\_type => $object~~) { |
  | 107 |  | $post\_types[~~$post\_type~~] = $object->label; |
  |  | 102 | $\_post\_types = get\_post\_types( $post\_type\_args, 'objects' ); |
  |  | 103 |  |
  |  | 104 | $post\_types = [ '0' => esc\_html\_\_( 'Select Type', 'ultimate-store-kit' ) ]; |
  |  | 105 |  |
  |  | 106 | foreach ( $\_post\_types as $post\_type => $object ) { |
  |  | 107 | $post\_types[ $post\_type ] = $object->label; |
  | 108 | 108 | } |
  | 109 | 109 |  |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L141) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L141) |  |
  | 141 | 141 | // add\_action( 'init', 'bdt\_custom\_post\_type\_rest\_support', 25 ); |
  | 142 | 142 |  |
  | 143 |  | function ultimate\_store\_kit\_allow\_tags(~~$tag = null~~) { |
  | 144 |  | $tag\_allowed = wp\_kses\_allowed\_html(~~'post'~~); |
  | 145 |  |  |
  | 146 |  | $tag\_allowed['input'] ~~= [~~ |
  |  | 143 | function ultimate\_store\_kit\_allow\_tags( $tag = null ) { |
  |  | 144 | $tag\_allowed = wp\_kses\_allowed\_html( 'post' ); |
  |  | 145 |  |
  |  | 146 | $tag\_allowed['input']  = [ |
  | 147 | 147 | 'class'   => [], |
  | 148 | 148 | 'id'      => [], |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L152) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L152) |  |
  | 152 | 152 | 'type'    => [], |
  | 153 | 153 | ]; |
  | 154 |  | $tag\_allowed['select'] = [ |
  |  | 154 | $tag\_allowed['select'] = [ |
  | 155 | 155 | 'class'    => [], |
  | 156 | 156 | 'id'       => [], |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L160) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L160) |  |
  | 160 | 160 | 'type'     => [], |
  | 161 | 161 | ]; |
  | 162 |  | $tag\_allowed['option'] = [ |
  |  | 162 | $tag\_allowed['option'] = [ |
  | 163 | 163 | 'value'    => [], |
  | 164 | 164 | 'selected' => [], |
  | 165 | 165 | ]; |
  | 166 | 166 |  |
  | 167 |  | $tag\_allowed['title'] = [ |
  | 168 |  | 'a'      => [ |
  |  | 167 | $tag\_allowed['title'] = [ |
  |  | 168 | 'a'      => [ |
  | 169 | 169 | 'href'  => [], |
  | 170 | 170 | 'title' => [], |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L177) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L177) |  |
  | 177 | 177 | ]; |
  | 178 | 178 |  |
  | 179 |  | $tag\_allowed['text'] = [ |
  | 180 |  | 'a'      => [ |
  |  | 179 | $tag\_allowed['text'] = [ |
  |  | 180 | 'a'      => [ |
  | 181 | 181 | 'href'  => [], |
  | 182 | 182 | 'title' => [], |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L187) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L187) |  |
  | 187 | 187 | 'strong' => [], |
  | 188 | 188 | 'hr'     => [], |
  | 189 |  | 'i'      => [ |
  |  | 189 | 'i'      => [ |
  | 190 | 190 | 'class' => [], |
  | 191 | 191 | ], |
  | 192 |  | 'span'   => [ |
  |  | 192 | 'span'   => [ |
  | 193 | 193 | 'class' => [], |
  | 194 | 194 | ], |
  | 195 | 195 | ]; |
  | 196 | 196 |  |
  | 197 |  | $tag\_allowed['svg'] = [ |
  | 198 |  | 'svg'     => [ |
  |  | 197 | $tag\_allowed['svg'] = [ |
  |  | 198 | 'svg'     => [ |
  | 199 | 199 | 'version'     => [], |
  | 200 | 200 | 'xmlns'       => [], |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L207) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L207) |  |
  | 207 | 207 | ], |
  | 208 | 208 | 'g'       => [], |
  | 209 |  | 'path'    => [ |
  |  | 209 | 'path'    => [ |
  | 210 | 210 | 'class' => [], |
  | 211 | 211 | 'd'     => [], |
  | 212 | 212 | ], |
  | 213 |  | 'ellipse' => [ |
  |  | 213 | 'ellipse' => [ |
  | 214 | 214 | 'class' => [], |
  | 215 | 215 | 'cx'    => [], |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L218) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L218) |  |
  | 218 | 218 | 'ry'    => [], |
  | 219 | 219 | ], |
  | 220 |  | 'circle'  => [ |
  |  | 220 | 'circle'  => [ |
  | 221 | 221 | 'class' => [], |
  | 222 | 222 | 'cx'    => [], |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L224) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L224) |  |
  | 224 | 224 | 'r'     => [], |
  | 225 | 225 | ], |
  | 226 |  | 'rect'    => [ |
  |  | 226 | 'rect'    => [ |
  | 227 | 227 | 'x'         => [], |
  | 228 | 228 | 'y'         => [], |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L232) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L232) |  |
  | 232 | 232 | 'class'     => [], |
  | 233 | 233 | ], |
  | 234 |  | 'line'    => [ |
  |  | 234 | 'line'    => [ |
  | 235 | 235 | 'class' => [], |
  | 236 | 236 | 'x1'    => [], |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L243) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L243) |  |
  | 243 | 243 | ]; |
  | 244 | 244 |  |
  | 245 |  | if (~~$tag == null~~) { |
  |  | 245 | if ( $tag == null ) { |
  | 246 | 246 | return $tag\_allowed; |
  | 247 |  | } elseif (~~is\_array($tag)~~) { |
  |  | 247 | } elseif ( is\_array( $tag ) ) { |
  | 248 | 248 | $new\_tag\_allow = []; |
  | 249 | 249 |  |
  | 250 |  | foreach (~~$tag as $\_tag~~) { |
  | 251 |  | $new\_tag\_allow[~~$\_tag] = $tag\_allowed[$\_tag~~]; |
  |  | 250 | foreach ( $tag as $\_tag ) { |
  |  | 251 | $new\_tag\_allow[ $\_tag ] = $tag\_allowed[ $\_tag ]; |
  | 252 | 252 | } |
  | 253 | 253 |  |
  | 254 | 254 | return $new\_tag\_allow; |
  | 255 | 255 | } else { |
  | 256 |  | return isset(~~$tag\_allowed[$tag]) ? $tag\_allowed[$tag~~] : []; |
  |  | 256 | return isset( $tag\_allowed[ $tag ] ) ? $tag\_allowed[ $tag ] : []; |
  | 257 | 257 | } |
  | 258 | 258 | } |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L261) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L261) |  |
  | 261 | 261 | \* post pagination |
  | 262 | 262 | \*/ |
  | 263 |  | function ultimate\_store\_kit\_post\_pagination(~~$wp\_query~~) { |
  |  | 263 | function ultimate\_store\_kit\_post\_pagination( $wp\_query ) { |
  | 264 | 264 |  |
  | 265 | 265 | /\*\* Stop execution if there's only 1 page \*/ |
  | 266 | 266 |  |
  | 267 |  | if (~~$wp\_query->max\_num\_pages <= 1~~) { |
  |  | 267 | if ( $wp\_query->max\_num\_pages <= 1 ) { |
  | 268 | 268 | return; |
  | 269 | 269 | } |
  | 270 | 270 |  |
  | 271 |  | if (~~is\_front\_page()~~) { |
  | 272 |  | $paged = (~~get\_query\_var('page')) ? get\_query\_var('page'~~) : 1; |
  |  | 271 | if ( is\_front\_page() ) { |
  |  | 272 | $paged = ( get\_query\_var( 'page' ) ) ? get\_query\_var( 'page' ) : 1; |
  | 273 | 273 | } else { |
  | 274 |  | $paged = (~~get\_query\_var('paged')) ? get\_query\_var('paged'~~) : 1; |
  | 275 |  | } |
  | 276 |  |  |
  | 277 |  | $max = intval(~~$wp\_query->max\_num\_pages~~); |
  |  | 274 | $paged = ( get\_query\_var( 'paged' ) ) ? get\_query\_var( 'paged' ) : 1; |
  |  | 275 | } |
  |  | 276 |  |
  |  | 277 | $max = intval( $wp\_query->max\_num\_pages ); |
  | 278 | 278 |  |
  | 279 | 279 | /\*\* Add current page to the array \*/ |
  | 280 | 280 |  |
  | 281 |  | if (~~$paged >= 1~~) { |
  |  | 281 | if ( $paged >= 1 ) { |
  | 282 | 282 | $links[] = $paged; |
  | 283 | 283 | } |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L285) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L285) |  |
  | 285 | 285 | /\*\* Add the pages around the current page to the array \*/ |
  | 286 | 286 |  |
  | 287 |  | if (~~$paged >= 3~~) { |
  |  | 287 | if ( $paged >= 3 ) { |
  | 288 | 288 | $links[] = $paged - 1; |
  | 289 | 289 | $links[] = $paged - 2; |
  | 290 | 290 | } |
  | 291 | 291 |  |
  | 292 |  | if (~~($paged + 2) <= $max~~) { |
  |  | 292 | if ( ( $paged + 2 ) <= $max ) { |
  | 293 | 293 | $links[] = $paged + 2; |
  | 294 | 294 | $links[] = $paged + 1; |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L299) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L299) |  |
  | 299 | 299 | /\*\* Previous Post Link \*/ |
  | 300 | 300 |  |
  | 301 |  | if (~~get\_previous\_posts\_link()~~) { |
  | 302 |  | printf(~~'<li>%s</li>' . "\n", wp\_kses\_post(get\_previous\_posts\_link('<span class="usk-icon-arrow-left-5"></span>'))~~); |
  |  | 301 | if ( get\_previous\_posts\_link() ) { |
  |  | 302 | printf( '<li>%s</li>' . "\n", wp\_kses\_post( get\_previous\_posts\_link( '<span class="usk-icon-arrow-left-5"></span>' ) ) ); |
  | 303 | 303 | } |
  | 304 | 304 |  |
  | 305 | 305 | /\*\* Link to first page, plus ellipses if necessary \*/ |
  | 306 | 306 |  |
  | 307 |  | if (~~!in\_array(1, $links)~~) { |
  |  | 307 | if ( ! in\_array( 1, $links ) ) { |
  | 308 | 308 | $class = 1 == $paged ? ' class="current"' : ''; |
  | 309 | 309 |  |
  | 310 |  | printf(~~'<li%s><a href="%s" target="\_self">%s</a></li>' . "\n", wp\_kses\_post($class), esc\_url(get\_pagenum\_link(1)), '1'~~); |
  | 311 |  |  |
  | 312 |  | if (~~!in\_array(2, $links)~~) { |
  |  | 310 | printf( '<li%s><a href="%s" target="\_self">%s</a></li>' . "\n", wp\_kses\_post( $class ), esc\_url( get\_pagenum\_link( 1 ) ), '1' ); |
  |  | 311 |  |
  |  | 312 | if ( ! in\_array( 2, $links ) ) { |
  | 313 | 313 | echo '<li class="usk-pagination-dot-dot"><span>...</span></li>'; |
  | 314 | 314 | } |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L316) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L316) |  |
  | 316 | 316 |  |
  | 317 | 317 | /\*\* Link to current page, plus 2 pages in either direction if necessary \*/ |
  | 318 |  | sort(~~$links~~); |
  | 319 |  |  |
  | 320 |  | foreach (~~(array) $links as $link~~) { |
  |  | 318 | sort( $links ); |
  |  | 319 |  |
  |  | 320 | foreach ( (array) $links as $link ) { |
  | 321 | 321 | $class = $paged == $link ? ' class="usk-active"' : ''; |
  | 322 |  | printf(~~'<li%s><a href="%s" target="\_self">%s</a></li>' . "\n", wp\_kses\_post($class), esc\_url(get\_pagenum\_link($link)), esc\_html($link)~~); |
  |  | 322 | printf( '<li%s><a href="%s" target="\_self">%s</a></li>' . "\n", wp\_kses\_post( $class ), esc\_url( get\_pagenum\_link( $link ) ), esc\_html( $link ) ); |
  | 323 | 323 | } |
  | 324 | 324 |  |
  | 325 | 325 | /\*\* Link to last page, plus ellipses if necessary \*/ |
  | 326 | 326 |  |
  | 327 |  | if (~~!in\_array($max, $links)~~) { |
  | 328 |  |  |
  | 329 |  | if (~~!in\_array($max - 1, $links)~~) { |
  |  | 327 | if ( ! in\_array( $max, $links ) ) { |
  |  | 328 |  |
  |  | 329 | if ( ! in\_array( $max - 1, $links ) ) { |
  | 330 | 330 | echo '<li class="usk-pagination-dot-dot"><span>...</span></li>' . "\n"; |
  | 331 | 331 | } |
  | 332 | 332 |  |
  | 333 | 333 | $class = $paged == $max ? ' class="usk-active"' : ''; |
  | 334 |  | printf(~~'<li%s><a href="%s" target="\_self">%s</a></li>' . "\n", wp\_kses\_post($class), esc\_url(get\_pagenum\_link($max)), esc\_html($max)~~); |
  |  | 334 | printf( '<li%s><a href="%s" target="\_self">%s</a></li>' . "\n", wp\_kses\_post( $class ), esc\_url( get\_pagenum\_link( $max ) ), esc\_html( $max ) ); |
  | 335 | 335 | } |
  | 336 | 336 |  |
  | 337 | 337 | /\*\* Next Post Link \*/ |
  | 338 | 338 |  |
  | 339 |  | if (~~get\_next\_posts\_link()~~) { |
  | 340 |  | printf(~~'<li>%s</li>' . "\n", wp\_kses\_post(get\_next\_posts\_link('<span class="usk-icon-arrow-right-1"></span>'))~~); |
  |  | 339 | if ( get\_next\_posts\_link() ) { |
  |  | 340 | printf( '<li>%s</li>' . "\n", wp\_kses\_post( get\_next\_posts\_link( '<span class="usk-icon-arrow-right-1"></span>' ) ) ); |
  | 341 | 341 | } |
  | 342 | 342 |  |
  | 343 | 343 | echo '</ul>' . "\n"; |
  | 344 | 344 | } |
  | 345 |  |  |
  | 346 |  | function ultimate\_store\_kit\_template\_edit\_link($template\_id) { |
  | 347 |  |  |
  | 348 |  | if (Ultimate\_Store\_Kit\_Loader::elementor()->editor->is\_edit\_mode()) { |
  | 349 |  |  |
  | 350 |  | $final\_url = add\_query\_arg(['elementor' => ''], get\_permalink($template\_id)); |
  | 351 |  |  |
  | 352 |  | $output = sprintf('<a class="usk-elementor-template-edit-link" href="%s" title="%s" target="\_blank"><i class="usk-icon-edit"></i></a>', esc\_url($final\_url), esc\_html\_\_('Edit Template', 'ultimate-store-kit')); |
  |  | 345 | function ultimate\_store\_kit\_post\_pagination\_\_new( $wp\_query ) { |
  |  | 346 |  |
  |  | 347 | $page             = max( 1, get\_query\_var( 'paged' ), get\_query\_var( 'page' ) ); |
  |  | 348 | $page             = absint( empty( $\_GET['product-page'] ) ? $page : $\_GET['product-page'] ); |
  |  | 349 | $paged            = absint( $page ); |
  |  | 350 |  |
  |  | 351 | $current\_page\_url = strtok( get\_pagenum\_link( 1 ), '?' ); |
  |  | 352 |  |
  |  | 353 | /\*\* Stop execution if there's only 1 page \*/ |
  |  | 354 |  |
  |  | 355 | if ( $wp\_query->max\_num\_pages <= 1 ) { |
  |  | 356 | return; |
  |  | 357 | } |
  |  | 358 |  |
  |  | 359 | $max = intval( $wp\_query->max\_num\_pages ); |
  |  | 360 |  |
  |  | 361 | /\*\* Add current page to the array \*/ |
  |  | 362 |  |
  |  | 363 | if ( $paged >= 1 ) { |
  |  | 364 | $links[] = $paged; |
  |  | 365 | } |
  |  | 366 |  |
  |  | 367 | /\*\* Add the pages around the current page to the array \*/ |
  |  | 368 |  |
  |  | 369 | if ( $paged >= 3 ) { |
  |  | 370 | $links[] = $paged - 1; |
  |  | 371 | $links[] = $paged - 2; |
  |  | 372 | } |
  |  | 373 |  |
  |  | 374 | if ( ( $paged + 2 ) <= $max ) { |
  |  | 375 | $links[] = $paged + 2; |
  |  | 376 | $links[] = $paged + 1; |
  |  | 377 | } |
  |  | 378 |  |
  |  | 379 | echo '<ul class="usk-pagination">' . "\n"; |
  |  | 380 |  |
  |  | 381 | /\*\* Previous Post Link \*/ |
  |  | 382 |  |
  |  | 383 | if ( get\_previous\_posts\_link() ) { |
  |  | 384 | $prev\_page = $paged - 1; |
  |  | 385 |  |
  |  | 386 | if( $prev\_page < 1 ) { |
  |  | 387 | return; |
  |  | 388 | } |
  |  | 389 |  |
  |  | 390 | $class = $paged == $prev\_page ? ' class="current"' : ''; |
  |  | 391 |  |
  |  | 392 | printf( |
  |  | 393 | '<li%s><a href="%s" target="\_self">%s</a></li>' . "\n", |
  |  | 394 | wp\_kses\_post( $class ), |
  |  | 395 | esc\_url( add\_query\_arg( 'product-page', $prev\_page, $current\_page\_url ) ), |
  |  | 396 | '<span class="usk-icon-arrow-left-5"></span>' |
  |  | 397 | ); |
  |  | 398 | } |
  |  | 399 |  |
  |  | 400 | /\*\* Link to first page, plus ellipses if necessary \*/ |
  |  | 401 |  |
  |  | 402 | if ( ! in\_array( 1, $links ) ) { |
  |  | 403 | $class = 1 == $paged ? ' class="current"' : ''; |
  |  | 404 |  |
  |  | 405 | printf( |
  |  | 406 | '<li%s><a href="%s" target="\_self">%s</a></li>' . "\n", |
  |  | 407 | wp\_kses\_post( $class ), |
  |  | 408 | esc\_url( add\_query\_arg( 'product-page', '1', $current\_page\_url ) ), |
  |  | 409 | '1' |
  |  | 410 | ); |
  |  | 411 |  |
  |  | 412 | if ( ! in\_array( 2, $links ) ) { |
  |  | 413 | echo '<li class="usk-pagination-dot-dot"><span>...</span></li>'; |
  |  | 414 | } |
  |  | 415 | } |
  |  | 416 |  |
  |  | 417 | /\*\* Link to current page, plus 2 pages in either direction if necessary \*/ |
  |  | 418 | sort( $links ); |
  |  | 419 |  |
  |  | 420 | foreach ( (array) $links as $link ) { |
  |  | 421 | $class = $paged == $link ? ' class="usk-active"' : ''; |
  |  | 422 | printf( '<li%s><a href="%s" target="\_self">%s</a></li>' . "\n", |
  |  | 423 | wp\_kses\_post( $class ), |
  |  | 424 | esc\_url( add\_query\_arg( 'product-page', $link, $current\_page\_url ) ), |
  |  | 425 | esc\_html( $link ) ); |
  |  | 426 | } |
  |  | 427 |  |
  |  | 428 | /\*\* Link to last page, plus ellipses if necessary \*/ |
  |  | 429 |  |
  |  | 430 | if ( ! in\_array( $max, $links ) ) { |
  |  | 431 |  |
  |  | 432 | if ( ! in\_array( $max - 1, $links ) ) { |
  |  | 433 | echo '<li class="usk-pagination-dot-dot"><span>...</span></li>' . "\n"; |
  |  | 434 | } |
  |  | 435 |  |
  |  | 436 | $class = $paged == $max ? ' class="usk-active"' : ''; |
  |  | 437 | printf( |
  |  | 438 | '<li%s><a href="%s" target="\_self">%s</a></li>' . "\n", |
  |  | 439 | wp\_kses\_post( $class ), |
  |  | 440 | esc\_url( add\_query\_arg( 'product-page', $max, $current\_page\_url ) ), |
  |  | 441 | esc\_html( $max ) ); |
  |  | 442 | } |
  |  | 443 |  |
  |  | 444 | /\*\* Next Post Link \*/ |
  |  | 445 |  |
  |  | 446 | if ( get\_next\_posts\_link() ) { |
  |  | 447 | $next\_page = $paged + 1; |
  |  | 448 |  |
  |  | 449 | if( $next\_page > $max ) { |
  |  | 450 | return; |
  |  | 451 | } |
  |  | 452 |  |
  |  | 453 | printf( |
  |  | 454 | '<li%s><a href="%s" target="\_self">%s</a></li>' . "\n", |
  |  | 455 | wp\_kses\_post( $class ), |
  |  | 456 | esc\_url( add\_query\_arg( 'product-page', $next\_page, $current\_page\_url ) ), |
  |  | 457 | '<span class="usk-icon-arrow-right-1"></span>' |
  |  | 458 | ); |
  |  | 459 | } |
  |  | 460 |  |
  |  | 461 | echo '</ul>' . "\n"; |
  |  | 462 | } |
  |  | 463 |  |
  |  | 464 | function ultimate\_store\_kit\_template\_edit\_link( $template\_id ) { |
  |  | 465 |  |
  |  | 466 | if ( Ultimate\_Store\_Kit\_Loader::elementor()->editor->is\_edit\_mode() ) { |
  |  | 467 |  |
  |  | 468 | $final\_url = add\_query\_arg( [ 'elementor' => '' ], get\_permalink( $template\_id ) ); |
  |  | 469 |  |
  |  | 470 | $output = sprintf( '<a class="usk-elementor-template-edit-link" href="%s" title="%s" target="\_blank"><i class="usk-icon-edit"></i></a>', esc\_url( $final\_url ), esc\_html\_\_( 'Edit Template', 'ultimate-store-kit' ) ); |
  | 353 | 471 |  |
  | 354 | 472 | return $output; |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L356) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L474) |  |
  | 356 | 474 | } |
  | 357 | 475 |  |
  | 358 |  | function ultimate\_store\_kit\_iso\_time(~~$time~~) { |
  | 359 |  | $current\_offset  = (float) get\_option(~~'gmt\_offset'~~); |
  | 360 |  | $timezone\_string = get\_option(~~'timezone\_string'~~); |
  |  | 476 | function ultimate\_store\_kit\_iso\_time( $time ) { |
  |  | 477 | $current\_offset  = (float) get\_option( 'gmt\_offset' ); |
  |  | 478 | $timezone\_string = get\_option( 'timezone\_string' ); |
  | 361 | 479 |  |
  | 362 | 480 | // Create a UTC+- zone if no timezone string exists. |
  | 363 | 481 |  |
  | 364 | 482 | //if ( empty( $timezone\_string ) ) { |
  | 365 |  | if (~~0 === $current\_offset~~) { |
  |  | 483 | if ( 0 === $current\_offset ) { |
  | 366 | 484 | $timezone\_string = '+00:00'; |
  | 367 |  | } elseif (~~$current\_offset < 0~~) { |
  |  | 485 | } elseif ( $current\_offset < 0 ) { |
  | 368 | 486 | $timezone\_string = $current\_offset . ':00'; |
  | 369 | 487 | } else { |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L374) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L492) |  |
  | 374 | 492 |  |
  | 375 | 493 | $sub\_time   = []; |
  | 376 |  | $sub\_time   = explode(~~" ", $time~~); |
  |  | 494 | $sub\_time   = explode( " ", $time ); |
  | 377 | 495 | $final\_time = $sub\_time[0] . 'T' . $sub\_time[1] . ':00' . $timezone\_string; |
  | 378 | 496 |  |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L386) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L504) |  |
  | 386 | 504 | \* @return false|string |
  | 387 | 505 | \*/ |
  | 388 |  | function ultimate\_store\_kit\_currency\_format(~~$currency, $precision = 1~~) { |
  | 389 |  |  |
  | 390 |  | if (~~$currency > 0~~) { |
  | 391 |  |  |
  | 392 |  | if (~~$currency < 900~~) { |
  |  | 506 | function ultimate\_store\_kit\_currency\_format( $currency, $precision = 1 ) { |
  |  | 507 |  |
  |  | 508 | if ( $currency > 0 ) { |
  |  | 509 |  |
  |  | 510 | if ( $currency < 900 ) { |
  | 393 | 511 | // 0 - 900 |
  | 394 |  | $currency\_format = number\_format(~~$currency, $precision~~); |
  |  | 512 | $currency\_format = number\_format( $currency, $precision ); |
  | 395 | 513 | $suffix          = ''; |
  | 396 | 514 | } else |
  | 397 | 515 |  |
  | 398 |  | ~~if ($currency < 900000~~) { |
  | 399 |  | // 0.9k-850k |
  | 400 |  | ~~$currency\_format = number\_format($currency / 1000, $precision~~); |
  | 401 |  | $suffix          = 'K'; |
  | 402 |  | } else |
  | 403 |  |  |
  | 404 |  | ~~if ($currency < 900000000~~) { |
  | 405 |  | // 0.9m-850m |
  | 406 |  | ~~$currency\_format = number\_format($currency / 1000000, $precision~~); |
  | 407 |  | $suffix          = 'M'; |
  | 408 |  | } else |
  | 409 |  |  |
  | 410 |  | ~~if ($currency < 900000000000~~) { |
  | 411 |  | // 0.9b-850b |
  | 412 |  | ~~$currency\_format = number\_format($currency / 1000000000, $precision~~); |
  | 413 |  | $suffix          = 'B'; |
  | 414 |  | } else { |
  | 415 |  | // 0.9t+ |
  | 416 |  | ~~$currency\_format = number\_format($currency / 1000000000000, $precision~~); |
  | 417 |  | $suffix          = 'T'; |
  | 418 |  | } |
  |  | 516 | if ( $currency < 900000 ) { |
  |  | 517 | // 0.9k-850k |
  |  | 518 | $currency\_format = number\_format( $currency / 1000, $precision ); |
  |  | 519 | $suffix          = 'K'; |
  |  | 520 | } else |
  |  | 521 |  |
  |  | 522 | if ( $currency < 900000000 ) { |
  |  | 523 | // 0.9m-850m |
  |  | 524 | $currency\_format = number\_format( $currency / 1000000, $precision ); |
  |  | 525 | $suffix          = 'M'; |
  |  | 526 | } else |
  |  | 527 |  |
  |  | 528 | if ( $currency < 900000000000 ) { |
  |  | 529 | // 0.9b-850b |
  |  | 530 | $currency\_format = number\_format( $currency / 1000000000, $precision ); |
  |  | 531 | $suffix          = 'B'; |
  |  | 532 | } else { |
  |  | 533 | // 0.9t+ |
  |  | 534 | $currency\_format = number\_format( $currency / 1000000000000, $precision ); |
  |  | 535 | $suffix          = 'T'; |
  |  | 536 | } |
  | 419 | 537 |  |
  | 420 | 538 | // Remove unecessary zeroes after decimal. "1.0" -> "1"; "1.00" -> "1" |
  | 421 | 539 |  |
  | 422 | 540 | // Intentionally does not affect partials, eg "1.50" -> "1.50" |
  | 423 |  | if (~~$precision > 0~~) { |
  | 424 |  | $dotzero         = '.' . str\_repeat(~~'0', $precision~~); |
  | 425 |  | $currency\_format = str\_replace(~~$dotzero, '', $currency\_format~~); |
  |  | 541 | if ( $precision > 0 ) { |
  |  | 542 | $dotzero         = '.' . str\_repeat( '0', $precision ); |
  |  | 543 | $currency\_format = str\_replace( $dotzero, '', $currency\_format ); |
  | 426 | 544 | } |
  | 427 | 545 |  |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L438) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L556) |  |
  | 438 | 556 |  |
  | 439 | 557 | $menus = wp\_get\_nav\_menus(); |
  | 440 |  | $items = [~~0 => esc\_html\_\_('Select Menu', 'ultimate-store-kit')~~]; |
  | 441 |  | foreach (~~$menus as $menu~~) { |
  | 442 |  | $items[~~$menu->slug~~] = $menu->name; |
  |  | 558 | $items = [ 0 => esc\_html\_\_( 'Select Menu', 'ultimate-store-kit' ) ]; |
  |  | 559 | foreach ( $menus as $menu ) { |
  |  | 560 | $items[ $menu->slug ] = $menu->name; |
  | 443 | 561 | } |
  | 444 | 562 |  |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L455) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L573) |  |
  | 455 | 573 | \* @return mixed |
  | 456 | 574 | \*/ |
  | 457 |  | function ultimate\_store\_kit\_option(~~$option, $section, $default = ''~~) { |
  | 458 |  |  |
  | 459 |  | $options = get\_option(~~$section~~); |
  | 460 |  |  |
  | 461 |  | if (~~isset($options[$option])~~) { |
  | 462 |  | return $options[~~$option~~]; |
  |  | 575 | function ultimate\_store\_kit\_option( $option, $section, $default = '' ) { |
  |  | 576 |  |
  |  | 577 | $options = get\_option( $section ); |
  |  | 578 |  |
  |  | 579 | if ( isset( $options[ $option ] ) ) { |
  |  | 580 | return $options[ $option ]; |
  | 463 | 581 | } |
  | 464 | 582 |  |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L471) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L589) |  |
  | 471 | 589 | function ultimate\_store\_kit\_et\_options() { |
  | 472 | 590 |  |
  | 473 |  | $templates = Ultimate\_Store\_Kit\_Loader::elementor()->templates\_manager->get\_source(~~'local'~~)->get\_items(); |
  |  | 591 | $templates = Ultimate\_Store\_Kit\_Loader::elementor()->templates\_manager->get\_source( 'local' )->get\_items(); |
  | 474 | 592 | $types     = []; |
  | 475 | 593 |  |
  | 476 |  | if (~~empty($templates)~~) { |
  | 477 |  | $template\_options = [~~'0' => \_\_('Template Not Found!', 'ultimate-store-kit')~~]; |
  |  | 594 | if ( empty( $templates ) ) { |
  |  | 595 | $template\_options = [ '0' => \_\_( 'Template Not Found!', 'ultimate-store-kit' ) ]; |
  | 478 | 596 | } else { |
  | 479 |  | $template\_options = [~~'0' => \_\_('Select Template', 'ultimate-store-kit')~~]; |
  | 480 |  |  |
  | 481 |  | foreach (~~$templates as $template~~) { |
  | 482 |  | $template\_options[~~$template['template\_id']~~] = $template['title'] . ' (' . $template['type'] . ')'; |
  | 483 |  | $types[~~$template['template\_id']~~]            = $template['type']; |
  |  | 597 | $template\_options = [ '0' => \_\_( 'Select Template', 'ultimate-store-kit' ) ]; |
  |  | 598 |  |
  |  | 599 | foreach ( $templates as $template ) { |
  |  | 600 | $template\_options[ $template['template\_id'] ] = $template['title'] . ' (' . $template['type'] . ')'; |
  |  | 601 | $types[ $template['template\_id'] ]            = $template['type']; |
  | 484 | 602 | } |
  | 485 | 603 | } |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L496) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L614) |  |
  | 496 | 614 | $sidebar\_options = []; |
  | 497 | 615 |  |
  | 498 |  | if (~~!$wp\_registered\_sidebars~~) { |
  | 499 |  | $sidebar\_options[0] = esc\_html\_\_(~~'No sidebars were found', 'ultimate-store-kit'~~); |
  |  | 616 | if ( ! $wp\_registered\_sidebars ) { |
  |  | 617 | $sidebar\_options[0] = esc\_html\_\_( 'No sidebars were found', 'ultimate-store-kit' ); |
  | 500 | 618 | } else { |
  | 501 |  | $sidebar\_options[0] = esc\_html\_\_(~~'Select Sidebar', 'ultimate-store-kit'~~); |
  | 502 |  |  |
  | 503 |  | foreach (~~$wp\_registered\_sidebars as $sidebar\_id => $sidebar~~) { |
  | 504 |  | $sidebar\_options[~~$sidebar\_id~~] = $sidebar['name']; |
  |  | 619 | $sidebar\_options[0] = esc\_html\_\_( 'Select Sidebar', 'ultimate-store-kit' ); |
  |  | 620 |  |
  |  | 621 | foreach ( $wp\_registered\_sidebars as $sidebar\_id => $sidebar ) { |
  |  | 622 | $sidebar\_options[ $sidebar\_id ] = $sidebar['name']; |
  | 505 | 623 | } |
  | 506 | 624 | } |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L514) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L632) |  |
  | 514 | 632 | \* @return array of category |
  | 515 | 633 | \*/ |
  | 516 |  | function ultimate\_store\_kit\_get\_category(~~$taxonomy = 'product\_cat'~~) { |
  |  | 634 | function ultimate\_store\_kit\_get\_category( $taxonomy = 'product\_cat' ) { |
  | 517 | 635 |  |
  | 518 | 636 | $post\_options = []; |
  | 519 | 637 |  |
  | 520 |  | $post\_categories = get\_terms(~~[~~ |
  |  | 638 | $post\_categories = get\_terms( [ |
  | 521 | 639 | 'taxonomy'   => $taxonomy, |
  | 522 | 640 | 'hide\_empty' => false, |
  | 523 |  | ]); |
  | 524 |  |  |
  | 525 |  | if (~~is\_wp\_error($post\_categories)~~) { |
  |  | 641 | ] ); |
  |  | 642 |  |
  |  | 643 | if ( is\_wp\_error( $post\_categories ) ) { |
  | 526 | 644 | return $post\_options; |
  | 527 | 645 | } |
  | 528 | 646 |  |
  | 529 |  | if (~~false !== $post\_categories and is\_array($post\_categories)~~) { |
  | 530 |  | foreach (~~$post\_categories as $category~~) { |
  | 531 |  | $post\_options[~~$category->term\_id~~] = $category->name; |
  |  | 647 | if ( false !== $post\_categories and is\_array( $post\_categories ) ) { |
  |  | 648 | foreach ( $post\_categories as $category ) { |
  |  | 649 | $post\_options[ $category->term\_id ] = $category->name; |
  | 532 | 650 | } |
  | 533 | 651 | } |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L540) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L658) |  |
  | 540 | 658 | \* @return array of parent category |
  | 541 | 659 | \*/ |
  | 542 |  | function ultimate\_store\_kit\_get\_only\_parent\_cats(~~$taxonomy = 'category'~~) { |
  | 543 |  |  |
  | 544 |  | $parent\_categories = [~~'none' => \_\_('None', 'ultimate-store-kit')~~]; |
  | 545 |  | $args              = [~~'parent' => 0~~]; |
  | 546 |  | $parent\_cats       = get\_terms(~~$taxonomy, $args~~); |
  | 547 |  |  |
  | 548 |  | foreach (~~$parent\_cats as $parent\_cat~~) { |
  | 549 |  | $parent\_categories[~~$parent\_cat->term\_id] = ucfirst($parent\_cat->name~~); |
  |  | 660 | function ultimate\_store\_kit\_get\_only\_parent\_cats( $taxonomy = 'category' ) { |
  |  | 661 |  |
  |  | 662 | $parent\_categories = [ 'none' => \_\_( 'None', 'ultimate-store-kit' ) ]; |
  |  | 663 | $args              = [ 'parent' => 0 ]; |
  |  | 664 | $parent\_cats       = get\_terms( $taxonomy, $args ); |
  |  | 665 |  |
  |  | 666 | foreach ( $parent\_cats as $parent\_cat ) { |
  |  | 667 | $parent\_categories[ $parent\_cat->term\_id ] = ucfirst( $parent\_cat->name ); |
  | 550 | 668 | } |
  | 551 | 669 |  |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L558) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L676) |  |
  | 558 | 676 | \* @return array return all setting as array |
  | 559 | 677 | \*/ |
  | 560 |  | function ultimate\_store\_kit\_ajax\_settings(~~$settings~~) { |
  | 561 |  |  |
  | 562 |  | $required\_settings = [ |
  |  | 678 | function ultimate\_store\_kit\_ajax\_settings( $settings ) { |
  |  | 679 |  |
  |  | 680 | $required\_settings = [ |
  | 563 | 681 | 'show\_date'      => true, |
  | 564 | 682 | 'show\_comment'   => true, |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L573) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L691) |  |
  | 573 | 691 | ]; |
  | 574 | 692 |  |
  | 575 |  | foreach (~~$settings as $key => $value~~) { |
  | 576 |  | if (~~in\_array($key, $required\_settings)~~) { |
  | 577 |  | $required\_settings[~~$key~~] = $value; |
  |  | 693 | foreach ( $settings as $key => $value ) { |
  |  | 694 | if ( in\_array( $key, $required\_settings ) ) { |
  |  | 695 | $required\_settings[ $key ] = $value; |
  | 578 | 696 | } |
  | 579 | 697 | } |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L587) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L705) |  |
  | 587 | 705 | function ultimate\_store\_kit\_transition\_options() { |
  | 588 | 706 |  |
  | 589 |  | $transition\_options = [ |
  | 590 |  | ''                    => esc\_html\_\_(~~'None', 'ultimate-store-kit'~~), |
  | 591 |  | 'fade'                => esc\_html\_\_(~~'Fade', 'ultimate-store-kit'~~), |
  | 592 |  | 'scale-up'            => esc\_html\_\_(~~'Scale Up', 'ultimate-store-kit'~~), |
  | 593 |  | 'scale-down'          => esc\_html\_\_(~~'Scale Down', 'ultimate-store-kit'~~), |
  | 594 |  | 'slide-top'           => esc\_html\_\_(~~'Slide Top', 'ultimate-store-kit'~~), |
  | 595 |  | 'slide-bottom'        => esc\_html\_\_(~~'Slide Bottom', 'ultimate-store-kit'~~), |
  | 596 |  | 'slide-left'          => esc\_html\_\_(~~'Slide Left', 'ultimate-store-kit'~~), |
  | 597 |  | 'slide-right'         => esc\_html\_\_(~~'Slide Right', 'ultimate-store-kit'~~), |
  | 598 |  | 'slide-top-small'     => esc\_html\_\_(~~'Slide Top Small', 'ultimate-store-kit'~~), |
  | 599 |  | 'slide-bottom-small'  => esc\_html\_\_(~~'Slide Bottom Small', 'ultimate-store-kit'~~), |
  | 600 |  | 'slide-left-small'    => esc\_html\_\_(~~'Slide Left Small', 'ultimate-store-kit'~~), |
  | 601 |  | 'slide-right-small'   => esc\_html\_\_(~~'Slide Right Small', 'ultimate-store-kit'~~), |
  | 602 |  | 'slide-top-medium'    => esc\_html\_\_(~~'Slide Top Medium', 'ultimate-store-kit'~~), |
  | 603 |  | 'slide-bottom-medium' => esc\_html\_\_(~~'Slide Bottom Medium', 'ultimate-store-kit'~~), |
  | 604 |  | 'slide-left-medium'   => esc\_html\_\_(~~'Slide Left Medium', 'ultimate-store-kit'~~), |
  | 605 |  | 'slide-right-medium'  => esc\_html\_\_(~~'Slide Right Medium', 'ultimate-store-kit'~~), |
  |  | 707 | $transition\_options = [ |
  |  | 708 | ''                    => esc\_html\_\_( 'None', 'ultimate-store-kit' ), |
  |  | 709 | 'fade'                => esc\_html\_\_( 'Fade', 'ultimate-store-kit' ), |
  |  | 710 | 'scale-up'            => esc\_html\_\_( 'Scale Up', 'ultimate-store-kit' ), |
  |  | 711 | 'scale-down'          => esc\_html\_\_( 'Scale Down', 'ultimate-store-kit' ), |
  |  | 712 | 'slide-top'           => esc\_html\_\_( 'Slide Top', 'ultimate-store-kit' ), |
  |  | 713 | 'slide-bottom'        => esc\_html\_\_( 'Slide Bottom', 'ultimate-store-kit' ), |
  |  | 714 | 'slide-left'          => esc\_html\_\_( 'Slide Left', 'ultimate-store-kit' ), |
  |  | 715 | 'slide-right'         => esc\_html\_\_( 'Slide Right', 'ultimate-store-kit' ), |
  |  | 716 | 'slide-top-small'     => esc\_html\_\_( 'Slide Top Small', 'ultimate-store-kit' ), |
  |  | 717 | 'slide-bottom-small'  => esc\_html\_\_( 'Slide Bottom Small', 'ultimate-store-kit' ), |
  |  | 718 | 'slide-left-small'    => esc\_html\_\_( 'Slide Left Small', 'ultimate-store-kit' ), |
  |  | 719 | 'slide-right-small'   => esc\_html\_\_( 'Slide Right Small', 'ultimate-store-kit' ), |
  |  | 720 | 'slide-top-medium'    => esc\_html\_\_( 'Slide Top Medium', 'ultimate-store-kit' ), |
  |  | 721 | 'slide-bottom-medium' => esc\_html\_\_( 'Slide Bottom Medium', 'ultimate-store-kit' ), |
  |  | 722 | 'slide-left-medium'   => esc\_html\_\_( 'Slide Left Medium', 'ultimate-store-kit' ), |
  |  | 723 | 'slide-right-medium'  => esc\_html\_\_( 'Slide Right Medium', 'ultimate-store-kit' ), |
  | 606 | 724 | ]; |
  | 607 | 725 |  |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L611) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L729) |  |
  | 611 | 729 | // BDT Blend Type |
  | 612 | 730 | function ultimate\_store\_kit\_blend\_options() { |
  | 613 |  | $blend\_options = [ |
  | 614 |  | 'multiply'    => esc\_html\_\_(~~'Multiply', 'ultimate-store-kit'~~), |
  | 615 |  | 'screen'      => esc\_html\_\_(~~'Screen', 'ultimate-store-kit'~~), |
  | 616 |  | 'overlay'     => esc\_html\_\_(~~'Overlay', 'ultimate-store-kit'~~), |
  | 617 |  | 'darken'      => esc\_html\_\_(~~'Darken', 'ultimate-store-kit'~~), |
  | 618 |  | 'lighten'     => esc\_html\_\_(~~'Lighten', 'ultimate-store-kit'~~), |
  | 619 |  | 'color-dodge' => esc\_html\_\_(~~'Color-Dodge', 'ultimate-store-kit'~~), |
  | 620 |  | 'color-burn'  => esc\_html\_\_(~~'Color-Burn', 'ultimate-store-kit'~~), |
  | 621 |  | 'hard-light'  => esc\_html\_\_(~~'Hard-Light', 'ultimate-store-kit'~~), |
  | 622 |  | 'soft-light'  => esc\_html\_\_(~~'Soft-Light', 'ultimate-store-kit'~~), |
  | 623 |  | 'difference'  => esc\_html\_\_(~~'Difference', 'ultimate-store-kit'~~), |
  | 624 |  | 'exclusion'   => esc\_html\_\_(~~'Exclusion', 'ultimate-store-kit'~~), |
  | 625 |  | 'hue'         => esc\_html\_\_(~~'Hue', 'ultimate-store-kit'~~), |
  | 626 |  | 'saturation'  => esc\_html\_\_(~~'Saturation', 'ultimate-store-kit'~~), |
  | 627 |  | 'color'       => esc\_html\_\_(~~'Color', 'ultimate-store-kit'~~), |
  | 628 |  | 'luminosity'  => esc\_html\_\_(~~'Luminosity', 'ultimate-store-kit'~~), |
  |  | 731 | $blend\_options = [ |
  |  | 732 | 'multiply'    => esc\_html\_\_( 'Multiply', 'ultimate-store-kit' ), |
  |  | 733 | 'screen'      => esc\_html\_\_( 'Screen', 'ultimate-store-kit' ), |
  |  | 734 | 'overlay'     => esc\_html\_\_( 'Overlay', 'ultimate-store-kit' ), |
  |  | 735 | 'darken'      => esc\_html\_\_( 'Darken', 'ultimate-store-kit' ), |
  |  | 736 | 'lighten'     => esc\_html\_\_( 'Lighten', 'ultimate-store-kit' ), |
  |  | 737 | 'color-dodge' => esc\_html\_\_( 'Color-Dodge', 'ultimate-store-kit' ), |
  |  | 738 | 'color-burn'  => esc\_html\_\_( 'Color-Burn', 'ultimate-store-kit' ), |
  |  | 739 | 'hard-light'  => esc\_html\_\_( 'Hard-Light', 'ultimate-store-kit' ), |
  |  | 740 | 'soft-light'  => esc\_html\_\_( 'Soft-Light', 'ultimate-store-kit' ), |
  |  | 741 | 'difference'  => esc\_html\_\_( 'Difference', 'ultimate-store-kit' ), |
  |  | 742 | 'exclusion'   => esc\_html\_\_( 'Exclusion', 'ultimate-store-kit' ), |
  |  | 743 | 'hue'         => esc\_html\_\_( 'Hue', 'ultimate-store-kit' ), |
  |  | 744 | 'saturation'  => esc\_html\_\_( 'Saturation', 'ultimate-store-kit' ), |
  |  | 745 | 'color'       => esc\_html\_\_( 'Color', 'ultimate-store-kit' ), |
  |  | 746 | 'luminosity'  => esc\_html\_\_( 'Luminosity', 'ultimate-store-kit' ), |
  | 629 | 747 | ]; |
  | 630 | 748 |  |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L634) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L752) |  |
  | 634 | 752 | // BDT Position |
  | 635 | 753 | function ultimate\_store\_kit\_position() { |
  | 636 |  | $position\_options = [ |
  | 637 |  | ''              => esc\_html\_\_(~~'Default', 'ultimate-store-kit'~~), |
  | 638 |  | 'top-left'      => esc\_html\_\_(~~'Top Left', 'ultimate-store-kit'~~), |
  | 639 |  | 'top-center'    => esc\_html\_\_(~~'Top Center', 'ultimate-store-kit'~~), |
  | 640 |  | 'top-right'     => esc\_html\_\_(~~'Top Right', 'ultimate-store-kit'~~), |
  | 641 |  | 'center'        => esc\_html\_\_(~~'Center', 'ultimate-store-kit'~~), |
  | 642 |  | 'center-left'   => esc\_html\_\_(~~'Center Left', 'ultimate-store-kit'~~), |
  | 643 |  | 'center-right'  => esc\_html\_\_(~~'Center Right', 'ultimate-store-kit'~~), |
  | 644 |  | 'bottom-left'   => esc\_html\_\_(~~'Bottom Left', 'ultimate-store-kit'~~), |
  | 645 |  | 'bottom-center' => esc\_html\_\_(~~'Bottom Center', 'ultimate-store-kit'~~), |
  | 646 |  | 'bottom-right'  => esc\_html\_\_(~~'Bottom Right', 'ultimate-store-kit'~~), |
  |  | 754 | $position\_options = [ |
  |  | 755 | ''              => esc\_html\_\_( 'Default', 'ultimate-store-kit' ), |
  |  | 756 | 'top-left'      => esc\_html\_\_( 'Top Left', 'ultimate-store-kit' ), |
  |  | 757 | 'top-center'    => esc\_html\_\_( 'Top Center', 'ultimate-store-kit' ), |
  |  | 758 | 'top-right'     => esc\_html\_\_( 'Top Right', 'ultimate-store-kit' ), |
  |  | 759 | 'center'        => esc\_html\_\_( 'Center', 'ultimate-store-kit' ), |
  |  | 760 | 'center-left'   => esc\_html\_\_( 'Center Left', 'ultimate-store-kit' ), |
  |  | 761 | 'center-right'  => esc\_html\_\_( 'Center Right', 'ultimate-store-kit' ), |
  |  | 762 | 'bottom-left'   => esc\_html\_\_( 'Bottom Left', 'ultimate-store-kit' ), |
  |  | 763 | 'bottom-center' => esc\_html\_\_( 'Bottom Center', 'ultimate-store-kit' ), |
  |  | 764 | 'bottom-right'  => esc\_html\_\_( 'Bottom Right', 'ultimate-store-kit' ), |
  | 647 | 765 | ]; |
  | 648 | 766 |  |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L652) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L770) |  |
  | 652 | 770 | // BDT Thumbnavs Position |
  | 653 | 771 | function ultimate\_store\_kit\_thumbnavs\_position() { |
  | 654 |  | $position\_options = [ |
  | 655 |  | 'top-left'      => esc\_html\_\_(~~'Top Left', 'ultimate-store-kit'~~), |
  | 656 |  | 'top-center'    => esc\_html\_\_(~~'Top Center', 'ultimate-store-kit'~~), |
  | 657 |  | 'top-right'     => esc\_html\_\_(~~'Top Right', 'ultimate-store-kit'~~), |
  | 658 |  | 'center-left'   => esc\_html\_\_(~~'Center Left', 'ultimate-store-kit'~~), |
  | 659 |  | 'center-right'  => esc\_html\_\_(~~'Center Right', 'ultimate-store-kit'~~), |
  | 660 |  | 'bottom-left'   => esc\_html\_\_(~~'Bottom Left', 'ultimate-store-kit'~~), |
  | 661 |  | 'bottom-center' => esc\_html\_\_(~~'Bottom Center', 'ultimate-store-kit'~~), |
  | 662 |  | 'bottom-right'  => esc\_html\_\_(~~'Bottom Right', 'ultimate-store-kit'~~), |
  |  | 772 | $position\_options = [ |
  |  | 773 | 'top-left'      => esc\_html\_\_( 'Top Left', 'ultimate-store-kit' ), |
  |  | 774 | 'top-center'    => esc\_html\_\_( 'Top Center', 'ultimate-store-kit' ), |
  |  | 775 | 'top-right'     => esc\_html\_\_( 'Top Right', 'ultimate-store-kit' ), |
  |  | 776 | 'center-left'   => esc\_html\_\_( 'Center Left', 'ultimate-store-kit' ), |
  |  | 777 | 'center-right'  => esc\_html\_\_( 'Center Right', 'ultimate-store-kit' ), |
  |  | 778 | 'bottom-left'   => esc\_html\_\_( 'Bottom Left', 'ultimate-store-kit' ), |
  |  | 779 | 'bottom-center' => esc\_html\_\_( 'Bottom Center', 'ultimate-store-kit' ), |
  |  | 780 | 'bottom-right'  => esc\_html\_\_( 'Bottom Right', 'ultimate-store-kit' ), |
  | 663 | 781 | ]; |
  | 664 | 782 |  |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L667) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L785) |  |
  | 667 | 785 |  |
  | 668 | 786 | function ultimate\_store\_kit\_navigation\_position() { |
  | 669 |  | $position\_options = [ |
  | 670 |  | 'top-left'      => esc\_html\_\_(~~'Top Left', 'ultimate-store-kit'~~), |
  | 671 |  | 'top-center'    => esc\_html\_\_(~~'Top Center', 'ultimate-store-kit'~~), |
  | 672 |  | 'top-right'     => esc\_html\_\_(~~'Top Right', 'ultimate-store-kit'~~), |
  | 673 |  | 'center'        => esc\_html\_\_(~~'Center', 'ultimate-store-kit'~~), |
  | 674 |  | 'bottom-left'   => esc\_html\_\_(~~'Bottom Left', 'ultimate-store-kit'~~), |
  | 675 |  | 'bottom-center' => esc\_html\_\_(~~'Bottom Center', 'ultimate-store-kit'~~), |
  | 676 |  | 'bottom-right'  => esc\_html\_\_(~~'Bottom Right', 'ultimate-store-kit'~~), |
  |  | 787 | $position\_options = [ |
  |  | 788 | 'top-left'      => esc\_html\_\_( 'Top Left', 'ultimate-store-kit' ), |
  |  | 789 | 'top-center'    => esc\_html\_\_( 'Top Center', 'ultimate-store-kit' ), |
  |  | 790 | 'top-right'     => esc\_html\_\_( 'Top Right', 'ultimate-store-kit' ), |
  |  | 791 | 'center'        => esc\_html\_\_( 'Center', 'ultimate-store-kit' ), |
  |  | 792 | 'bottom-left'   => esc\_html\_\_( 'Bottom Left', 'ultimate-store-kit' ), |
  |  | 793 | 'bottom-center' => esc\_html\_\_( 'Bottom Center', 'ultimate-store-kit' ), |
  |  | 794 | 'bottom-right'  => esc\_html\_\_( 'Bottom Right', 'ultimate-store-kit' ), |
  | 677 | 795 | ]; |
  | 678 | 796 |  |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L681) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L799) |  |
  | 681 | 799 |  |
  | 682 | 800 | function ultimate\_store\_kit\_pagination\_position() { |
  | 683 |  | $position\_options = [ |
  | 684 |  | 'top-left'      => esc\_html\_\_(~~'Top Left', 'ultimate-store-kit'~~), |
  | 685 |  | 'top-center'    => esc\_html\_\_(~~'Top Center', 'ultimate-store-kit'~~), |
  | 686 |  | 'top-right'     => esc\_html\_\_(~~'Top Right', 'ultimate-store-kit'~~), |
  | 687 |  | 'bottom-left'   => esc\_html\_\_(~~'Bottom Left', 'ultimate-store-kit'~~), |
  | 688 |  | 'bottom-center' => esc\_html\_\_(~~'Bottom Center', 'ultimate-store-kit'~~), |
  | 689 |  | 'bottom-right'  => esc\_html\_\_(~~'Bottom Right', 'ultimate-store-kit'~~), |
  |  | 801 | $position\_options = [ |
  |  | 802 | 'top-left'      => esc\_html\_\_( 'Top Left', 'ultimate-store-kit' ), |
  |  | 803 | 'top-center'    => esc\_html\_\_( 'Top Center', 'ultimate-store-kit' ), |
  |  | 804 | 'top-right'     => esc\_html\_\_( 'Top Right', 'ultimate-store-kit' ), |
  |  | 805 | 'bottom-left'   => esc\_html\_\_( 'Bottom Left', 'ultimate-store-kit' ), |
  |  | 806 | 'bottom-center' => esc\_html\_\_( 'Bottom Center', 'ultimate-store-kit' ), |
  |  | 807 | 'bottom-right'  => esc\_html\_\_( 'Bottom Right', 'ultimate-store-kit' ), |
  | 690 | 808 | ]; |
  | 691 | 809 |  |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L695) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L813) |  |
  | 695 | 813 | // BDT Drop Position |
  | 696 | 814 | function ultimate\_store\_kit\_drop\_position() { |
  | 697 |  | $drop\_position\_options = [ |
  | 698 |  | 'bottom-left'    => esc\_html\_\_(~~'Bottom Left', 'ultimate-store-kit'~~), |
  | 699 |  | 'bottom-center'  => esc\_html\_\_(~~'Bottom Center', 'ultimate-store-kit'~~), |
  | 700 |  | 'bottom-right'   => esc\_html\_\_(~~'Bottom Right', 'ultimate-store-kit'~~), |
  | 701 |  | 'bottom-justify' => esc\_html\_\_(~~'Bottom Justify', 'ultimate-store-kit'~~), |
  | 702 |  | 'top-left'       => esc\_html\_\_(~~'Top Left', 'ultimate-store-kit'~~), |
  | 703 |  | 'top-center'     => esc\_html\_\_(~~'Top Center', 'ultimate-store-kit'~~), |
  | 704 |  | 'top-right'      => esc\_html\_\_(~~'Top Right', 'ultimate-store-kit'~~), |
  | 705 |  | 'top-justify'    => esc\_html\_\_(~~'Top Justify', 'ultimate-store-kit'~~), |
  | 706 |  | 'left-top'       => esc\_html\_\_(~~'Left Top', 'ultimate-store-kit'~~), |
  | 707 |  | 'left-center'    => esc\_html\_\_(~~'Left Center', 'ultimate-store-kit'~~), |
  | 708 |  | 'left-bottom'    => esc\_html\_\_(~~'Left Bottom', 'ultimate-store-kit'~~), |
  | 709 |  | 'right-top'      => esc\_html\_\_(~~'Right Top', 'ultimate-store-kit'~~), |
  | 710 |  | 'right-center'   => esc\_html\_\_(~~'Right Center', 'ultimate-store-kit'~~), |
  | 711 |  | 'right-bottom'   => esc\_html\_\_(~~'Right Bottom', 'ultimate-store-kit'~~), |
  |  | 815 | $drop\_position\_options = [ |
  |  | 816 | 'bottom-left'    => esc\_html\_\_( 'Bottom Left', 'ultimate-store-kit' ), |
  |  | 817 | 'bottom-center'  => esc\_html\_\_( 'Bottom Center', 'ultimate-store-kit' ), |
  |  | 818 | 'bottom-right'   => esc\_html\_\_( 'Bottom Right', 'ultimate-store-kit' ), |
  |  | 819 | 'bottom-justify' => esc\_html\_\_( 'Bottom Justify', 'ultimate-store-kit' ), |
  |  | 820 | 'top-left'       => esc\_html\_\_( 'Top Left', 'ultimate-store-kit' ), |
  |  | 821 | 'top-center'     => esc\_html\_\_( 'Top Center', 'ultimate-store-kit' ), |
  |  | 822 | 'top-right'      => esc\_html\_\_( 'Top Right', 'ultimate-store-kit' ), |
  |  | 823 | 'top-justify'    => esc\_html\_\_( 'Top Justify', 'ultimate-store-kit' ), |
  |  | 824 | 'left-top'       => esc\_html\_\_( 'Left Top', 'ultimate-store-kit' ), |
  |  | 825 | 'left-center'    => esc\_html\_\_( 'Left Center', 'ultimate-store-kit' ), |
  |  | 826 | 'left-bottom'    => esc\_html\_\_( 'Left Bottom', 'ultimate-store-kit' ), |
  |  | 827 | 'right-top'      => esc\_html\_\_( 'Right Top', 'ultimate-store-kit' ), |
  |  | 828 | 'right-center'   => esc\_html\_\_( 'Right Center', 'ultimate-store-kit' ), |
  |  | 829 | 'right-bottom'   => esc\_html\_\_( 'Right Bottom', 'ultimate-store-kit' ), |
  | 712 | 830 | ]; |
  | 713 | 831 |  |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L717) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L835) |  |
  | 717 | 835 | // Button Size |
  | 718 | 836 | function ultimate\_store\_kit\_button\_sizes() { |
  | 719 |  | $button\_sizes = [ |
  | 720 |  | 'xs' => esc\_html\_\_(~~'Extra Small', 'ultimate-store-kit'~~), |
  | 721 |  | 'sm' => esc\_html\_\_(~~'Small', 'ultimate-store-kit'~~), |
  | 722 |  | 'md' => esc\_html\_\_(~~'Medium', 'ultimate-store-kit'~~), |
  | 723 |  | 'lg' => esc\_html\_\_(~~'Large', 'ultimate-store-kit'~~), |
  | 724 |  | 'xl' => esc\_html\_\_(~~'Extra Large', 'ultimate-store-kit'~~), |
  |  | 837 | $button\_sizes = [ |
  |  | 838 | 'xs' => esc\_html\_\_( 'Extra Small', 'ultimate-store-kit' ), |
  |  | 839 | 'sm' => esc\_html\_\_( 'Small', 'ultimate-store-kit' ), |
  |  | 840 | 'md' => esc\_html\_\_( 'Medium', 'ultimate-store-kit' ), |
  |  | 841 | 'lg' => esc\_html\_\_( 'Large', 'ultimate-store-kit' ), |
  |  | 842 | 'xl' => esc\_html\_\_( 'Extra Large', 'ultimate-store-kit' ), |
  | 725 | 843 | ]; |
  | 726 | 844 |  |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L730) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L848) |  |
  | 730 | 848 | // Button Size |
  | 731 | 849 | function ultimate\_store\_kit\_heading\_size() { |
  | 732 |  | $heading\_sizes = [ |
  |  | 850 | $heading\_sizes = [ |
  | 733 | 851 | 'h1' => 'H1', |
  | 734 | 852 | 'h2' => 'H2', |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L744) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L862) |  |
  | 744 | 862 | // Title Tags |
  | 745 | 863 | function ultimate\_store\_kit\_title\_tags() { |
  | 746 |  | $title\_tags = [ |
  |  | 864 | $title\_tags = [ |
  | 747 | 865 | 'h1'   => 'H1', |
  | 748 | 866 | 'h2'   => 'H2', |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L763) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L881) |  |
  | 763 | 881 | $shape\_name = 'shape'; |
  | 764 | 882 | $extension  = '.svg'; |
  | 765 |  | $list       = [~~0 => esc\_html\_\_('Select Mask', 'ultimate-store-kit')~~]; |
  | 766 |  |  |
  | 767 |  | for (~~$i = 1; $i <= 20; $i++~~) { |
  | 768 |  | $list[~~$path . $shape\_name . '-' . $i . $extension] = ucwords($shape\_name . ' ' . $i~~); |
  |  | 883 | $list       = [ 0 => esc\_html\_\_( 'Select Mask', 'ultimate-store-kit' ) ]; |
  |  | 884 |  |
  |  | 885 | for ( $i = 1; $i <= 20; $i++ ) { |
  |  | 886 | $list[ $path . $shape\_name . '-' . $i . $extension ] = ucwords( $shape\_name . ' ' . $i ); |
  | 769 | 887 | } |
  | 770 | 888 |  |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L779) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L897) |  |
  | 779 | 897 | \* @return svg content |
  | 780 | 898 | \*/ |
  | 781 |  | function ultimate\_store\_kit\_svg\_icon(~~$icon~~) { |
  |  | 899 | function ultimate\_store\_kit\_svg\_icon( $icon ) { |
  | 782 | 900 |  |
  | 783 | 901 | $icon\_path = BDTUSK\_ASSETS\_PATH . "images/svg/{$icon}.svg"; |
  | 784 | 902 |  |
  | 785 |  | if (~~!file\_exists($icon\_path)~~) { |
  |  | 903 | if ( ! file\_exists( $icon\_path ) ) { |
  | 786 | 904 | return false; |
  | 787 | 905 | } |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L803) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L921) |  |
  | 803 | 921 | \* @return string |
  | 804 | 922 | \*/ |
  | 805 |  | function ultimate\_store\_kit\_parse\_csv(~~$csv, $delimiter = ';', $header = true~~) { |
  | 806 |  |  |
  | 807 |  | if (~~!is\_string($csv)~~) { |
  |  | 923 | function ultimate\_store\_kit\_parse\_csv( $csv, $delimiter = ';', $header = true ) { |
  |  | 924 |  |
  |  | 925 | if ( ! is\_string( $csv ) ) { |
  | 808 | 926 | return ''; |
  | 809 | 927 | } |
  | 810 | 928 |  |
  | 811 |  | if (~~!function\_exists('str\_getcsv')~~) { |
  |  | 929 | if ( ! function\_exists( 'str\_getcsv' ) ) { |
  | 812 | 930 | return $csv; |
  | 813 | 931 | } |
  | 814 | 932 |  |
  | 815 | 933 | $html    = ''; |
  | 816 |  | $rows    = explode(~~PHP\_EOL, $csv~~); |
  |  | 934 | $rows    = explode( PHP\_EOL, $csv ); |
  | 817 | 935 | $headRow = 1; |
  | 818 | 936 |  |
  | 819 |  | foreach (~~$rows as $row~~) { |
  | 820 |  |  |
  | 821 |  | if (~~$headRow == 1 and $header~~) { |
  |  | 937 | foreach ( $rows as $row ) { |
  |  | 938 |  |
  |  | 939 | if ( $headRow == 1 and $header ) { |
  | 822 | 940 | $html .= '<thead><tr>'; |
  | 823 | 941 | } else { |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L825) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L943) |  |
  | 825 | 943 | } |
  | 826 | 944 |  |
  | 827 |  | foreach (~~str\_getcsv($row, $delimiter) as $cell~~) { |
  | 828 |  |  |
  | 829 |  | $cell = trim(~~$cell~~); |
  |  | 945 | foreach ( str\_getcsv( $row, $delimiter ) as $cell ) { |
  |  | 946 |  |
  |  | 947 | $cell = trim( $cell ); |
  | 830 | 948 |  |
  | 831 | 949 | $html .= $header |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L834) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L952) |  |
  | 834 | 952 | } |
  | 835 | 953 |  |
  | 836 |  | if (~~$headRow == 1 and $header~~) { |
  |  | 954 | if ( $headRow == 1 and $header ) { |
  | 837 | 955 | $html .= '</tr></thead><tbody>'; |
  | 838 | 956 | } else { |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L847) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L965) |  |
  | 847 | 965 | } |
  | 848 | 966 |  |
  | 849 |  | function ultimate\_store\_kit\_dashboard\_link(~~$suffix = '#welcome'~~) { |
  | 850 |  | return add\_query\_arg(~~['page' => 'ultimate\_store\_kit\_options' . $suffix], admin\_url('admin.php')~~); |
  |  | 967 | function ultimate\_store\_kit\_dashboard\_link( $suffix = '#welcome' ) { |
  |  | 968 | return add\_query\_arg( [ 'page' => 'ultimate\_store\_kit\_options' . $suffix ], admin\_url( 'admin.php' ) ); |
  | 851 | 969 | } |
  | 852 | 970 |  |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L858) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L976) |  |
  | 858 | 976 | \* @return string return custom limited excerpt text |
  | 859 | 977 | \*/ |
  | 860 |  | function ultimate\_store\_kit\_custom\_excerpt(~~$limit = 25, $strip\_shortcode = false, $trail = ''~~) { |
  |  | 978 | function ultimate\_store\_kit\_custom\_excerpt( $limit = 25, $strip\_shortcode = false, $trail = '' ) { |
  | 861 | 979 |  |
  | 862 | 980 | $output = get\_the\_content(); |
  | 863 | 981 |  |
  | 864 |  | if (~~$limit~~) { |
  | 865 |  | $output = wp\_trim\_words(~~$output, $limit, $trail~~); |
  | 866 |  | } |
  | 867 |  |  |
  | 868 |  | if (~~$strip\_shortcode~~) { |
  | 869 |  | $output = strip\_shortcodes(~~$output~~); |
  | 870 |  | } |
  | 871 |  |  |
  | 872 |  | return wpautop(~~$output~~); |
  |  | 982 | if ( $limit ) { |
  |  | 983 | $output = wp\_trim\_words( $output, $limit, $trail ); |
  |  | 984 | } |
  |  | 985 |  |
  |  | 986 | if ( $strip\_shortcode ) { |
  |  | 987 | $output = strip\_shortcodes( $output ); |
  |  | 988 | } |
  |  | 989 |  |
  |  | 990 | return wpautop( $output ); |
  | 873 | 991 | } |
  | 874 | 992 |  |
  | 875 | 993 | function usk\_get\_order\_options() { |
  | 876 |  | $options = [ |
  | 877 |  | 'title'              => \_\_(~~'Title', 'ultimate-store-kit'~~), |
  | 878 |  | 'ID'                 => \_\_(~~'ID', 'ultimate-store-kit'~~), |
  | 879 |  | 'date'               => \_\_(~~'Date', 'ultimate-store-kit'~~), |
  | 880 |  | 'rand'               => \_\_(~~'Random', 'ultimate-store-kit'~~), |
  | 881 |  | '\_price'             => \_\_(~~'Product Price', 'ultimate-store-kit'~~), |
  | 882 |  | 'total\_sales'        => \_\_(~~'Top Seller', 'ultimate-store-kit'~~), |
  | 883 |  | 'comment\_count'      => \_\_(~~'Most Reviewed', 'ultimate-store-kit'~~), |
  | 884 |  | '\_wc\_average\_rating' => \_\_(~~'Top Rated', 'ultimate-store-kit'~~), |
  | 885 |  | ]; |
  | 886 |  |  |
  | 887 |  | return apply\_filters(~~'usk\_order\_options', $options~~); |
  |  | 994 | $options = [ |
  |  | 995 | 'title'              => \_\_( 'Title', 'ultimate-store-kit' ), |
  |  | 996 | 'ID'                 => \_\_( 'ID', 'ultimate-store-kit' ), |
  |  | 997 | 'date'               => \_\_( 'Date', 'ultimate-store-kit' ), |
  |  | 998 | 'rand'               => \_\_( 'Random', 'ultimate-store-kit' ), |
  |  | 999 | '\_price'             => \_\_( 'Product Price', 'ultimate-store-kit' ), |
  |  | 1000 | 'total\_sales'        => \_\_( 'Top Seller', 'ultimate-store-kit' ), |
  |  | 1001 | 'comment\_count'      => \_\_( 'Most Reviewed', 'ultimate-store-kit' ), |
  |  | 1002 | '\_wc\_average\_rating' => \_\_( 'Top Rated', 'ultimate-store-kit' ), |
  |  | 1003 | ]; |
  |  | 1004 |  |
  |  | 1005 | return apply\_filters( 'usk\_order\_options', $options ); |
  | 888 | 1006 | } |
  | 889 | 1007 |  |
  | 890 | 1008 | //wishlist |
  | 891 |  |  |
  | 892 |  | function ultimate\_store\_kit\_get\_wishlist($user\_id = 0) { |
  |  | 1009 | function ultimate\_store\_kit\_get\_wishlist( $user\_id = 0 ) { |
  | 893 | 1010 | $\_wishlist\_key = '\_ultimate\_store\_kit\_wishlist'; |
  | 894 | 1011 | $\_wishlist     = []; |
  | 895 |  | if (isset($\_COOKIE[$\_wishlist\_key])) { |
  | 896 |  | $\_wishlist = unserialize(stripslashes($\_COOKIE[sanitize\_text\_field($\_wishlist\_key)])); |
  | 897 |  | } |
  | 898 |  | return apply\_filters('ultimate\_store\_kit\_wishlist', array\_unique($\_wishlist)); |
  |  | 1012 |  |
  |  | 1013 | if ( isset( $\_COOKIE[ $\_wishlist\_key ] ) ) { |
  |  | 1014 | $cookie\_data  = stripslashes( $\_COOKIE[ $\_wishlist\_key ] ); |
  |  | 1015 | $decoded\_data = unserialize( $cookie\_data ); |
  |  | 1016 |  |
  |  | 1017 | if ( json\_last\_error() === JSON\_ERROR\_NONE && is\_array( $decoded\_data ) ) { |
  |  | 1018 | $\_wishlist = $decoded\_data; |
  |  | 1019 | } else { |
  |  | 1020 | // Handle JSON decoding error if necessary |
  |  | 1021 | $\_wishlist = []; |
  |  | 1022 | } |
  |  | 1023 | } |
  |  | 1024 |  |
  |  | 1025 | return apply\_filters( 'ultimate\_store\_kit\_wishlist', array\_unique( $\_wishlist ) ); |
  | 899 | 1026 | } |
  | 900 | 1027 |  |
  | 901 | 1028 | function usk\_get\_taxonomies() { |
  | 902 |  | $taxonomy\_list = get\_object\_taxonomies(~~'product'~~); |
  | 903 |  | $taxonomies    = [ |
  |  | 1029 | $taxonomy\_list = get\_object\_taxonomies( 'product' ); |
  |  | 1030 | $taxonomies    = [ |
  | 904 | 1031 | 'search'  => 'Search', |
  | 905 | 1032 | 'price'   => 'Price', |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L908) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L1035) |  |
  | 908 | 1035 | ]; |
  | 909 | 1036 |  |
  | 910 |  | foreach (~~$taxonomy\_list as $\_taxonomy~~) { |
  | 911 |  | $taxonomy = get\_taxonomy(~~$\_taxonomy~~); |
  | 912 |  |  |
  | 913 |  | if (~~$taxonomy->show\_ui~~) { |
  | 914 |  | $taxonomies[~~$\_taxonomy~~] = $taxonomy->label; |
  |  | 1037 | foreach ( $taxonomy\_list as $\_taxonomy ) { |
  |  | 1038 | $taxonomy = get\_taxonomy( $\_taxonomy ); |
  |  | 1039 |  |
  |  | 1040 | if ( $taxonomy->show\_ui ) { |
  |  | 1041 | $taxonomies[ $\_taxonomy ] = $taxonomy->label; |
  | 915 | 1042 | } |
  | 916 | 1043 | } |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L919) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L1046) |  |
  | 919 | 1046 | } |
  | 920 | 1047 |  |
  | 921 |  | function ultimate\_store\_kit\_hide\_on\_class(~~$selectors~~) { |
  |  | 1048 | function ultimate\_store\_kit\_hide\_on\_class( $selectors ) { |
  | 922 | 1049 | $element\_hide\_on = ''; |
  | 923 | 1050 |  |
  | 924 |  | if (~~!empty($selectors)~~) { |
  | 925 |  |  |
  | 926 |  | foreach (~~$selectors as $element~~) { |
  | 927 |  |  |
  | 928 |  | if (~~$element == 'desktop'~~) { |
  |  | 1051 | if ( ! empty( $selectors ) ) { |
  |  | 1052 |  |
  |  | 1053 | foreach ( $selectors as $element ) { |
  |  | 1054 |  |
  |  | 1055 | if ( $element == 'desktop' ) { |
  | 929 | 1056 | $element\_hide\_on .= ' usk-hide-desktop'; |
  | 930 | 1057 | } |
  | 931 | 1058 |  |
  | 932 |  | if (~~$element == 'tablet'~~) { |
  |  | 1059 | if ( $element == 'tablet' ) { |
  | 933 | 1060 | $element\_hide\_on .= ' usk-hide-tablet'; |
  | 934 | 1061 | } |
  | 935 | 1062 |  |
  | 936 |  | if (~~$element == 'mobile'~~) { |
  |  | 1063 | if ( $element == 'mobile' ) { |
  | 937 | 1064 | $element\_hide\_on .= ' usk-hide-mobile'; |
  | 938 | 1065 | } |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L943) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L1070) |  |
  | 943 | 1070 | } |
  | 944 | 1071 |  |
  | 945 |  | function ultimate\_store\_kit\_wc\_product\_quick\_view\_content(~~$product\_id~~) { |
  | 946 |  | wp\_verify\_nonce(~~'ajax-usk-quick-view-nonce', 'usk-quick-view-modal-sc'~~); |
  |  | 1072 | function ultimate\_store\_kit\_wc\_product\_quick\_view\_content( $product\_id ) { |
  |  | 1073 | wp\_verify\_nonce( 'ajax-usk-quick-view-nonce', 'usk-quick-view-modal-sc' ); |
  | 947 | 1074 | global $woocommerce; |
  | 948 | 1075 | global $post; |
  | 949 | 1076 |  |
  | 950 |  | if (~~intval($product\_id)~~) { |
  | 951 |  | $post      = get\_post(~~$product\_id~~); |
  |  | 1077 | if ( intval( $product\_id ) ) { |
  |  | 1078 | $post      = get\_post( $product\_id ); |
  | 952 | 1079 | $next\_post = get\_next\_post(); |
  | 953 | 1080 | $prev\_post = get\_previous\_post(); |
  | 954 | 1081 |  |
  | 955 |  | wp(~~'p=' . $product\_id . '&post\_type=product'~~); |
  |  | 1082 | wp( 'p=' . $product\_id . '&post\_type=product' ); |
  | 956 | 1083 | ob\_start(); |
  | 957 |  | ?> |
  |  | 1084 | ?> |
  | 958 | 1085 | <div class="usk-modal-page"> |
  | 959 | 1086 | <?php |
  | 960 | 1087 |  |
  | 961 |  | while (have\_posts()) : the\_post(); ?> |
  |  | 1088 | while ( have\_posts() ) : |
  |  | 1089 | the\_post(); ?> |
  | 962 | 1090 |  |
  | 963 | 1091 | <script> |
  | 964 |  | var url = '<?php echo esc\_url(~~plugins\_url('assets/js/prettyPhoto/jquery.prettyPhoto.init.js', WC\_PLUGIN\_FILE)~~); ?>'; |
  |  | 1092 | var url = '<?php echo esc\_url( plugins\_url( 'assets/js/prettyPhoto/jquery.prettyPhoto.init.js', WC\_PLUGIN\_FILE ) ); ?>'; |
  | 965 | 1093 | jQuery.getScript(url); |
  | 966 | 1094 | var wc\_add\_to\_cart\_variation\_params = { |
  | 967 | 1095 | "ajax\_url": "\/wp-admin\/admin-ajax.php" |
  | 968 | 1096 | }; |
  | 969 |  | jQuery.getScript("<?php echo esc\_url(~~$woocommerce->plugin\_url()~~); ?> '/assets/js/frontend/add-to-cart-variation.min.js'"); |
  |  | 1097 | jQuery.getScript("<?php echo esc\_url( $woocommerce->plugin\_url() ); ?> '/assets/js/frontend/add-to-cart-variation.min.js'"); |
  | 970 | 1098 | </script> |
  | 971 | 1099 | <div class="usk-modal-product"> |
  | 972 |  | <div id="product-<?php the\_ID(); ?>" <?php post\_class(~~'product'~~); ?>> |
  |  | 1100 | <div id="product-<?php the\_ID(); ?>" <?php post\_class( 'product' ); ?>> |
  | 973 | 1101 | <div class="usk-modal-image-wrapper"> |
  | 974 |  | <?php do\_action(~~'ultimate\_store\_kit\_quick\_florence\_grid\_view\_product\_images'~~); ?> |
  |  | 1102 | <?php do\_action( 'ultimate\_store\_kit\_quick\_florence\_grid\_view\_product\_images' ); ?> |
  | 975 | 1103 | <div class="usk-onsale"> |
  | 976 |  | <?php do\_action(~~'ultimate\_store\_kit\_wc\_product\_quick\_view\_product\_sale\_flash'~~); ?> |
  |  | 1104 | <?php do\_action( 'ultimate\_store\_kit\_wc\_product\_quick\_view\_product\_sale\_flash' ); ?> |
  | 977 | 1105 | </div> |
  | 978 | 1106 | </div> |
  | 979 | 1107 | <div class="usk-modal-content-box"> |
  | 980 |  | <a href="<?php echo esc\_url(~~get\_permalink()~~); ?>" class="usk-product-title"> |
  | 981 |  | <?php do\_action(~~'ultimate\_store\_kit\_quick\_view\_product\_title'~~); ?> |
  |  | 1108 | <a href="<?php echo esc\_url( get\_permalink() ); ?>" class="usk-product-title"> |
  |  | 1109 | <?php do\_action( 'ultimate\_store\_kit\_quick\_view\_product\_title' ); ?> |
  | 982 | 1110 | </a> |
  | 983 | 1111 | <div class="usk-rating"> |
  | 984 |  | <?php do\_action(~~'ultimate\_store\_kit\_quick\_view\_product\_single\_rating'~~); ?> |
  |  | 1112 | <?php do\_action( 'ultimate\_store\_kit\_quick\_view\_product\_single\_rating' ); ?> |
  | 985 | 1113 | </div> |
  | 986 | 1114 | <div class="usk-product-price"> |
  | 987 |  | <?php do\_action(~~'ultimate\_store\_kit\_quick\_view\_product\_single\_price'~~); ?> |
  |  | 1115 | <?php do\_action( 'ultimate\_store\_kit\_quick\_view\_product\_single\_price' ); ?> |
  | 988 | 1116 | </div> |
  | 989 | 1117 | <div class="usk-product-meta"> |
  | 990 | 1118 | <div class="usk-sku-wrapper"> |
  | 991 |  | <?php do\_action(~~'ultimate\_store\_kit\_quick\_view\_product\_single\_meta'~~); ?> |
  |  | 1119 | <?php do\_action( 'ultimate\_store\_kit\_quick\_view\_product\_single\_meta' ); ?> |
  | 992 | 1120 | </div> |
  | 993 | 1121 | </div> |
  | 994 | 1122 | <div class="usk-product-desc"> |
  | 995 |  | <?php do\_action(~~'ultimate\_store\_kit\_quick\_view\_product\_single\_excerpt'~~); ?> |
  |  | 1123 | <?php do\_action( 'ultimate\_store\_kit\_quick\_view\_product\_single\_excerpt' ); ?> |
  | 996 | 1124 | </div> |
  | 997 | 1125 |  |
  | 998 | 1126 | <div class="usk-quick-action-wrap"> |
  | 999 |  | <?php do\_action(~~'ultimate\_store\_kit\_quick\_view\_product\_single\_add\_to\_cart'~~); ?> |
  |  | 1127 | <?php do\_action( 'ultimate\_store\_kit\_quick\_view\_product\_single\_add\_to\_cart' ); ?> |
  | 1000 | 1128 | </div> |
  | 1001 | 1129 | </div> |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L1005) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L1133) |  |
  | 1005 | 1133 | </div> |
  | 1006 | 1134 |  |
  | 1007 |  | <?php echo ob\_get\_clean(); exit(); |
  |  | 1135 | <?php echo ob\_get\_clean(); |
  |  | 1136 | exit(); |
  | 1008 | 1137 | } |
  | 1009 | 1138 | } |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L1014) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L1143) |  |
  | 1014 | 1143 | <?php |
  | 1015 | 1144 |  |
  | 1016 |  | if (~~has\_post\_thumbnail()~~) { |
  | 1017 |  | $attachment\_count = count(~~$product->get\_gallery\_image\_ids()~~); |
  |  | 1145 | if ( has\_post\_thumbnail() ) { |
  |  | 1146 | $attachment\_count = count( $product->get\_gallery\_image\_ids() ); |
  | 1018 | 1147 | $gallery          = $attachment\_count > 0 ? '[product-gallery]' : ''; |
  | 1019 |  | $props            = wc\_get\_product\_attachment\_props(~~get\_post\_thumbnail\_id(), $post~~); |
  | 1020 |  | $image            = get\_the\_post\_thumbnail(~~$post->ID, apply\_filters('single\_product\_large\_thumbnail\_size', 'shop\_single'), [~~ |
  |  | 1148 | $props            = wc\_get\_product\_attachment\_props( get\_post\_thumbnail\_id(), $post ); |
  |  | 1149 | $image            = get\_the\_post\_thumbnail( $post->ID, apply\_filters( 'single\_product\_large\_thumbnail\_size', 'shop\_single' ), [ |
  | 1021 | 1150 | 'title' => $props['title'], |
  | 1022 | 1151 | 'alt'   => $props['alt'], |
  | 1023 |  | ]); |
  | 1024 |  | echo wp\_kses\_post(~~apply\_filters('woocommerce\_single\_product\_image\_html', sprintf('<a href="%s" itemprop="image" class="usk-product woocommerce-main-image zoom" title="%s" data-rel="prettyPhoto' . $gallery . '">%s</a>', $props['url'], $props['caption'], $image), $post->ID)~~); |
  |  | 1152 | ] ); |
  |  | 1153 | echo wp\_kses\_post( apply\_filters( 'woocommerce\_single\_product\_image\_html', sprintf( '<a href="%s" itemprop="image" class="usk-product woocommerce-main-image zoom" title="%s" data-rel="prettyPhoto' . $gallery . '">%s</a>', $props['url'], $props['caption'], $image ), $post->ID ) ); |
  | 1025 | 1154 | } else { |
  | 1026 |  | echo wp\_kses\_post(~~apply\_filters('woocommerce\_single\_product\_image\_html', sprintf('<img src="%s" alt="%s" />', wc\_placeholder\_img\_src(), esc\_html\_\_('Placeholder', 'ultimate-store-kit')), $post->ID)~~); |
  |  | 1155 | echo wp\_kses\_post( apply\_filters( 'woocommerce\_single\_product\_image\_html', sprintf( '<img src="%s" alt="%s" />', wc\_placeholder\_img\_src(), esc\_html\_\_( 'Placeholder', 'ultimate-store-kit' ) ), $post->ID ) ); |
  | 1027 | 1156 | } |
  | 1028 | 1157 |  |
  | 1029 | 1158 | $attachment\_ids = $product->get\_gallery\_image\_ids(); |
  | 1030 | 1159 |  |
  | 1031 |  | if (~~$attachment\_ids~~) : |
  |  | 1160 | if ( $attachment\_ids ) : |
  | 1032 | 1161 | $loop    = 0; |
  | 1033 |  | $columns = apply\_filters(~~'woocommerce\_product\_thumbnails\_columns', 3~~); |
  | 1034 |  | ?> |
  | 1035 |  | <div class="thumbnails columns-<?php echo esc\_attr(~~$columns~~); ?>"> |
  |  | 1162 | $columns = apply\_filters( 'woocommerce\_product\_thumbnails\_columns', 3 ); |
  |  | 1163 | ?> |
  |  | 1164 | <div class="thumbnails columns-<?php echo esc\_attr( $columns ); ?>"> |
  | 1036 | 1165 | <?php |
  | 1037 | 1166 |  |
  | 1038 |  | foreach (~~$attachment\_ids as $attachment\_id~~) { |
  | 1039 |  | $classes = [~~'thumbnail'~~]; |
  | 1040 |  |  |
  | 1041 |  | if (~~$loop === 0 || $loop % $columns === 0~~) { |
  |  | 1167 | foreach ( $attachment\_ids as $attachment\_id ) { |
  |  | 1168 | $classes = [ 'thumbnail' ]; |
  |  | 1169 |  |
  |  | 1170 | if ( $loop === 0 || $loop % $columns === 0 ) { |
  | 1042 | 1171 | $classes[] = 'first'; |
  | 1043 | 1172 | } |
  | 1044 | 1173 |  |
  | 1045 |  | if (~~($loop + 1) % $columns === 0~~) { |
  |  | 1174 | if ( ( $loop + 1 ) % $columns === 0 ) { |
  | 1046 | 1175 | $classes[] = 'last'; |
  | 1047 | 1176 | } |
  | 1048 | 1177 |  |
  | 1049 |  | $image\_link = wp\_get\_attachment\_url(~~$attachment\_id~~); |
  | 1050 |  |  |
  | 1051 |  | if (~~!$image\_link~~) { |
  |  | 1178 | $image\_link = wp\_get\_attachment\_url( $attachment\_id ); |
  |  | 1179 |  |
  |  | 1180 | if ( ! $image\_link ) { |
  | 1052 | 1181 | continue; |
  | 1053 | 1182 | } |
  | 1054 | 1183 |  |
  | 1055 |  | $image\_title   = esc\_attr(~~get\_the\_title($attachment\_id)~~); |
  | 1056 |  | $image\_caption = esc\_attr(~~get\_post\_field('post\_excerpt', $attachment\_id)~~); |
  | 1057 |  | $image         = wp\_get\_attachment\_image(~~$attachment\_id, apply\_filters('single\_product\_small\_thumbnail\_size', 'shop\_thumbnail'), 0, $attr = [~~ |
  |  | 1184 | $image\_title   = esc\_attr( get\_the\_title( $attachment\_id ) ); |
  |  | 1185 | $image\_caption = esc\_attr( get\_post\_field( 'post\_excerpt', $attachment\_id ) ); |
  |  | 1186 | $image         = wp\_get\_attachment\_image( $attachment\_id, apply\_filters( 'single\_product\_small\_thumbnail\_size', 'shop\_thumbnail' ), 0, $attr = [ |
  | 1058 | 1187 | 'title' => $image\_title, |
  | 1059 | 1188 | 'alt'   => $image\_title, |
  | 1060 |  | ]); |
  | 1061 |  | $image\_class = esc\_attr(~~implode(' ', $classes)~~); |
  | 1062 |  | echo wp\_kses\_post(~~apply\_filters('woocommerce\_single\_product\_image\_thumbnail\_html', sprintf('<a href="%s" class="%s" title="%s" >%s</a>', $image\_link, $image\_class, $image\_caption, $image), $attachment\_id, $post->ID, $image\_class)~~); |
  |  | 1189 | ] ); |
  |  | 1190 | $image\_class = esc\_attr( implode( ' ', $classes ) ); |
  |  | 1191 | echo wp\_kses\_post( apply\_filters( 'woocommerce\_single\_product\_image\_thumbnail\_html', sprintf( '<a href="%s" class="%s" title="%s" >%s</a>', $image\_link, $image\_class, $image\_caption, $image ), $attachment\_id, $post->ID, $image\_class ) ); |
  | 1063 | 1192 | $loop++; |
  | 1064 | 1193 | } |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L1068) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L1197) |  |
  | 1068 | 1197 | <?php endif; ?> |
  | 1069 | 1198 | </div> |
  | 1070 |  | <?php |
  |  | 1199 | <?php |
  | 1071 | 1200 | } |
  | 1072 | 1201 |  |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L1075) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L1204) |  |
  | 1075 | 1204 | \* License Validation |
  | 1076 | 1205 | \*/ |
  | 1077 |  | if (~~!function\_exists('usk\_license\_validation')~~) { |
  |  | 1206 | if ( ! function\_exists( 'usk\_license\_validation' ) ) { |
  | 1078 | 1207 | function usk\_license\_validation() { |
  | 1079 | 1208 |  |
  | 1080 |  | if (~~function\_exists('\_is\_usk\_pro\_activated') && false === \_is\_usk\_pro\_activated()~~) { |
  |  | 1209 | if ( function\_exists( '\_is\_usk\_pro\_activated' ) && false === \_is\_usk\_pro\_activated() ) { |
  | 1081 | 1210 | return false; |
  | 1082 | 1211 | } |
  | 1083 | 1212 |  |
  | 1084 |  | $license\_key ~~= trim(get\_option('ultimate\_post\_kit\_license\_key')~~); |
  | 1085 |  |  |
  | 1086 |  | if (~~isset($license\_key) && !empty($license\_key)~~) { |
  |  | 1213 | $license\_key = trim( get\_option( 'ultimate\_post\_kit\_license\_key' ) ); |
  |  | 1214 |  |
  |  | 1215 | if ( isset( $license\_key ) && ! empty( $license\_key ) ) { |
  | 1087 | 1216 | return true; |
  | 1088 | 1217 | } else { |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L1095) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L1224) |  |
  | 1095 | 1224 |  |
  | 1096 | 1225 |  |
  | 1097 |  | function usk\_get\_compare\_products(~~$user\_id = 0~~) { |
  |  | 1226 | function usk\_get\_compare\_products( $user\_id = 0 ) { |
  | 1098 | 1227 | $\_compare\_products\_key = '\_ultimate\_store\_kit\_compare\_products'; |
  | 1099 | 1228 | $\_compare\_products     = []; |
  | 1100 |  | if ($user\_id != 0) { |
  | 1101 |  | $\_compare\_products = get\_user\_meta($user\_id, $\_compare\_products\_key, true) ?: []; |
  | 1102 |  | } elseif (isset($\_COOKIE[$\_compare\_products\_key])) { |
  | 1103 |  | $\_compare\_products = unserialize(stripslashes($\_COOKIE[sanitize\_text\_field($\_compare\_products\_key)])); |
  | 1104 |  | } |
  | 1105 |  |  |
  | 1106 |  | return apply\_filters('ultimate\_store\_kit\_compare\_products', array\_unique($\_compare\_products)); |
  |  | 1229 | if ( $user\_id != 0 ) { |
  |  | 1230 | $\_compare\_products = get\_user\_meta( $user\_id, $\_compare\_products\_key, true ) ?: []; |
  |  | 1231 | } elseif ( isset( $\_COOKIE[ $\_compare\_products\_key ] ) ) { |
  |  | 1232 | //$\_compare\_products = unserialize(stripslashes($\_COOKIE[sanitize\_text\_field($\_compare\_products\_key)])); |
  |  | 1233 |  |
  |  | 1234 | $cookie\_value      = sanitize\_text\_field( $\_COOKIE[ $\_compare\_products\_key ] ); |
  |  | 1235 | $\_compare\_products = json\_decode( stripslashes( $cookie\_value ), true ); |
  |  | 1236 |  |
  |  | 1237 | // Check if JSON decoding failed |
  |  | 1238 | if ( ! is\_array( $\_compare\_products ) ) { |
  |  | 1239 | $\_compare\_products = []; |
  |  | 1240 | } |
  |  | 1241 | } |
  |  | 1242 |  |
  |  | 1243 | return apply\_filters( 'ultimate\_store\_kit\_compare\_products', array\_unique( $\_compare\_products ) ); |
  | 1107 | 1244 | } |
  | 1108 | 1245 |  |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L1110) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L1247) |  |
  | 1110 | 1247 | $count    = 0; |
  | 1111 | 1248 | $user\_id  = get\_current\_user\_id(); |
  | 1112 |  | $products = usk\_get\_compare\_products(~~$user\_id~~); |
  | 1113 |  | if (~~is\_array($products)~~) { |
  | 1114 |  | $count = count(~~$products~~); |
  |  | 1249 | $products = usk\_get\_compare\_products( $user\_id ); |
  |  | 1250 | if ( is\_array( $products ) ) { |
  |  | 1251 | $count = count( $products ); |
  | 1115 | 1252 | } |
  | 1116 | 1253 | return $count; |
  | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3106405#L1123) | […](/browser/ultimate-store-kit/trunk/includes/helper.php?rev=3135472#L1260) |  |
  | 1123 | 1260 | //} |
  | 1124 | 1261 |  |
  | 1125 |  | if (~~!function\_exists('ultimate\_store\_kit\_compare\_product\_page')~~) { |
  | 1126 |  | function ultimate\_store\_kit\_compare\_product\_page() { |
  | 1127 |  | ~~if($postId = intval(get\_option( 'bdt\_usk\_compare\_products\_page\_id' )))~~{ |
  | 1128 |  | ~~$post = get\_post($postId~~); |
  | 1129 |  | ~~if($post->post\_status == 'publish')~~{ |
  | 1130 |  | return $post->ID; |
  | 1131 |  | } |
  | 1132 |  | } |
  | 1133 |  | } |
  | 1134 |  | } |
  | 1135 |  |  |
  | 1136 |  | if (~~!function\_exists('ultimate\_store\_kit\_is\_compare\_product\_page')~~) { |
  |  | 1262 | if ( ! function\_exists( 'ultimate\_store\_kit\_compare\_product\_page' ) ) { |
  |  | 1263 | function ultimate\_store\_kit\_compare\_product\_page() { |
  |  | 1264 | if ( $postId = intval( get\_option( 'bdt\_usk\_compare\_products\_page\_id' ) ) ) { |
  |  | 1265 | $post = get\_post( $postId ); |
  |  | 1266 | if ( $post->post\_status == 'publish' ) { |
  |  | 1267 | return $post->ID; |
  |  | 1268 | } |
  |  | 1269 | } |
  |  | 1270 | } |
  |  | 1271 | } |
  |  | 1272 |  |
  |  | 1273 | if ( ! function\_exists( 'ultimate\_store\_kit\_is\_compare\_product\_page' ) ) { |
  | 1137 | 1274 | function ultimate\_store\_kit\_is\_compare\_product\_page() { |
  | 1138 |  | if ($page = ultimate\_store\_kit\_compare\_product\_page() ) { |
  | 1139 |  | return is\_page( $page->ID ); |
  | 1140 |  | } |
  | 1141 |  | } |
  | 1142 |  | } |
  |  | 1275 | if ( $page = ultimate\_store\_kit\_compare\_product\_page() ) { |
  |  | 1276 | // return is\_page( $page->ID ); |
  |  | 1277 | return is\_page( $page ); |
  |  | 1278 | } |
  |  | 1279 | } |
  |  | 1280 | } |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3135472)
* [Zip Archive](?format=zip&new=3135472)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

