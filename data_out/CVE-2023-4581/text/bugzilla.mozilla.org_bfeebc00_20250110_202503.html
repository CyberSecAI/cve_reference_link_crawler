

![](/static/v20250108.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1843758)
* [XML](/show_bug.cgi?ctype=xml&id=1843758)

Closed
[Bug 1843758](/show_bug.cgi?id=1843758)
(CVE-2023-4581)

Opened 1 years ago
Closed 1 years ago

# .xll file extension = A malicious attack using abusing the XLL File starts with the delivery of a malicious file with the extension "XLL"

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

.xll file extension = A malicious attack using abusing the XLL File starts with the delivery of a malicious file with the extension "XLL"

## Categories

### (Firefox :: File Handling, defect)

[Product:](/describecomponents.cgi?product=Firefox)

Firefox
▾

Firefox
For bugs in Firefox Desktop, the Mozilla Foundation's web browser. For Firefox user interface issues in menus, bookmarks, location bar, and preferences. Many Firefox bugs will either be filed here or in the [Core](https://bugzilla.mozilla.org/describecomponents.cgi?product=Core) product. Bugs for developer tools (F12) should be filed in the [DevTools](https://bugzilla.mozilla.org/describecomponents.cgi?product=DevTools) product. ([more info](https://wiki.mozilla.org/Modules/All#Firefox))
[See Open Bugs in This Product](/buglist.cgi?product=Firefox&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Firefox)
Watch This Product

[Component:](/describecomponents.cgi?product=Firefox&component=File%20Handling#File%20Handling)

File Handling
▾

Firefox :: File Handling
For issues dealing with helper applications, and guessing Content Types when they aren't specified/known (ftp:, file:, jar:, but generally not http:). This component does not cover: backend networking issues, such as those covered by Networking: FTP or Networking: File, nor does it cover the Download Manager which has its own component in the Toolkit product.
[See Open Bugs in This Component](/buglist.cgi?product=Firefox&component=File%20Handling&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Firefox&component=File%20Handling&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Firefox&component=File%20Handling)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

117 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Webcompat Priority | --- |
| a11y-review | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr102 | [117+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=117%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=verified) |
| firefox-esr115 | [117+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=117%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=verified) |
| firefox115 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=wontfix) |
| firefox116 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=wontfix) |
| firefox117 | [+](/buglist.cgi?f1=cf_tracking_firefox117&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox-esr102 | 117+ | verified |
| firefox-esr115 | 117+ | verified |
| firefox-esr128 | --- | --- |
| firefox115 |  | wontfix |
| firefox116 |  | wontfix |
| firefox117 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: Puf, Assigned: mak)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=40)  [mak](/user_profile?user_id=240353)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/6d06bb80f5c3ab73df0e30507caf881c?d=mm&size=40)  [Puf](/user_profile?user_id=687629)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=40)  [Gijs](/user_profile?user_id=159069)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

6 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (4 keywords, Whiteboard: [reporter-external] [client-bounty-form] [verif?] [adv-main117+] [adv-esr115.2+] [adv-esr102.15+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2023-4581

[Keywords:](/describekeywords.cgi)

[csectype-other](/buglist.cgi?keywords=csectype-other&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---),
[sec-vector](/buglist.cgi?keywords=sec-vector&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?] [adv-main117+] [adv-esr115.2+] [adv-esr102.15+]

QA Whiteboard:

[post-critsmash-triage][qa-triaged]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a1409287_1689 "1 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | blocking-fx-sync1.7 | ? |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (5 files, 2 obsolete files)

| [.xll Firefox Browser.mp4](/attachment.cgi?id=9344043)  [1 years ago](#c3)  [Umar Farooq [:Puf]](/user_profile?user_id=687629)   104.85 KB, video/mp4 |  | [Details](/attachment.cgi?id=9344043&action=edit) |
| --- | --- | --- |
| [Bug 1843758. r=gijs](/attachment.cgi?id=9345067)  [1 years ago](#c7)  [Marco Bonardo [:mak]](/user_profile?user_id=240353)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9345067&action=edit) | [Review](/attachment.cgi?id=9345067) |
| [Bug 1843758.](/attachment.cgi?id=9345794)  [1 years ago](#c10)  [Marco Bonardo [:mak]](/user_profile?user_id=240353)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9345794&action=edit) | [Review](/attachment.cgi?id=9345794) |
| [Bug 1843758.](/attachment.cgi?id=9345805)  [1 years ago](#c12)  [Marco Bonardo [:mak]](/user_profile?user_id=240353)   48 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-esr115+](#c20 "1 years ago") | [Details](/attachment.cgi?id=9345805&action=edit) | [Review](/attachment.cgi?id=9345805) |
| [Bug 1843758.](/attachment.cgi?id=9345966)  [1 years ago](#c14)  [Marco Bonardo [:mak]](/user_profile?user_id=240353)   48 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-esr102+](#c21 "1 years ago") | [Details](/attachment.cgi?id=9345966&action=edit) | [Review](/attachment.cgi?id=9345966) |
| [Bug 1843758.](/attachment.cgi?id=9345969)  [1 years ago](#c16)  [Marco Bonardo [:mak]](/user_profile?user_id=240353)   48 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-release-](#c0 "1 year ago") | [Details](/attachment.cgi?id=9345969&action=edit) | [Review](/attachment.cgi?id=9345969) |
| [advisory.txt](/attachment.cgi?id=9350229)  [1 year ago](#c27)  [June Wilde (she/her) [:jewilde]](/user_profile?user_id=626341)   255 bytes, text/plain |  | [Details](/attachment.cgi?id=9350229&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Umar Farooq [:Puf]](/user_profile?user_id=687629)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1843758#c0)• 1 years ago |
|  | |

Firefox Version: [116.0b5] + [117.0a1]

Operating System: [Windows 10] (64-bit)

.xll = An XLL file is an add-in used by Microsoft Excel

It is the Excel Add-In file, that provides a way to use third-party tools and functions within Microsoft Excel. The third-party code can be C/C++ .NET code inside the Excel environment. In fact, despite the Excel icon, the XLL file is a Dynamic Linked Library, a binary executable file.

Cisco Talos investigates another vector for introduction of malicious code to Microsoft Excel—malicious add-ins, specifically XLL files.

.xll Blocked In Outlook Attachment

This File is Already Blocklisted in Chrome & Edge Browsers

The researchers are saying this technique is Xll particularly dangerous because the victims only need one click to compromise their endpoints.

Ref : <https://www.bleepingcomputer.com/news/microsoft/microsoft-365-to-block-downloaded-excel-xll-add-ins-to-boost-security/>

This File is Already Blocklisted in Chrome & Edge Browsers

it's better to Add Popop Warning [ Executable files may contain viruses or other malicious code that could harm your computer]

To .xll file To Keep Safe System from malicious file/code

Flags: sec-bounty?

|  | [Umar Farooq [:Puf]](/user_profile?user_id=687629)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1843758#c1)• 1 years ago |
|  | |

`Step To Reproduce:`

1. Create .xll File.
2. Download Using Firefox Browser
3. Open File [No Warning] In Firefox Browser

|  | [Umar Farooq [:Puf]](/user_profile?user_id=687629)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1843758#c2)• 1 years ago |
|  | |

file\_types {

# DLL files built for excel.

extension: "xll"

platform\_settings {

platform: PLATFORM\_TYPE\_WINDOWS

danger\_level: ALLOW\_ON\_USER\_GESTURE

auto\_open\_hint: DISALLOW\_AUTO\_OPEN

}

}

|  | [Umar Farooq [:Puf]](/user_profile?user_id=687629)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1843758#c3)• 1 years ago |
|  | |

Attached video
[.xll Firefox Browser.mp4](attachment.cgi?id=9344043)
— [Details](attachment.cgi?id=9344043&action=edit)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843758#a269237_159069)• 1 years ago |

Component: Security → File HandlingFlags: needinfo?(gijskruitbosch+bugs)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1843758#c4)• 1 years ago |
|  | |

"xll" is in our safebrowsing download reputation checks, but of course that won't catch any kind of targeted or even low-volume malicious file.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1843758#c5)• 1 years ago |
|  | |

Confirmed that this is not in our executable list, if we decide that we need to police this. Supposedly MS is going to add a warning prompt for these to protect people, but 1) people won't update their Excell very quickly, and 2) A similar warning for Word macros didn't full help solve that problem. Maybe we do need to worry about these, also.

Status: UNCONFIRMED → NEWEver confirmed: true

|  | [Marco Bonardo [:mak]](/user_profile?user_id=240353)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843758#a360816_240353)• 1 years ago |

Assignee: nobody → makStatus: NEW → ASSIGNED

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1843758#c6)• 1 years ago |
|  | |

Clearing my needinfo given Marco has graciously agreed to pick this up (thank you!)

Flags: needinfo?(gijskruitbosch+bugs)

|  | [Marco Bonardo [:mak]](/user_profile?user_id=240353)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1843758#c7)• 1 years ago |
|  | |

Attached file
[Bug 1843758. r=gijs](attachment.cgi?id=9345067)
— [Details](attachment.cgi?id=9345067&action=edit)

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1843758#c8)• 1 years ago |
|  | |

Pushed by mak77@bonardo.net:
<https://hg.mozilla.org/integration/autoland/rev/22830af36f25>
r=Gijs

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1843758#c9)• 1 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/22830af36f25>

Group: firefox-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 1 years ago
[status-firefox117](/buglist.cgi?f1=cf_status_firefox117&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 117 Branch

|  | [Marco Bonardo [:mak]](/user_profile?user_id=240353)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1843758#c10)• 1 years ago |
|  | |

Attached file
[Bug 1843758.](attachment.cgi?id=9345794) (obsolete)
— [Details](attachment.cgi?id=9345794&action=edit)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843758#a872958_600971)• 1 years ago |

[Attachment #9345794](/attachment.cgi?id=9345794&action=edit "Bug 1843758.") -
Attachment description: WIP: Bug 1843758. → Bug 1843758.

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1843758#c11)• 1 years ago |
|  | |

# Uplift Approval Request

* **Needs manual QE test**: yes
* **Fix verified in Nightly**: no
* **Explanation of risk level**: adding to a blocklist
* **Risk associated with taking this patch**: low
* **String changes made/needed**: none
* **Steps to reproduce for manual QE testing**: Try downloading a xll file. If you can't find one easily, rename one in a local file explorer and drag to the tabstrip. Expected behaviour is that once downloaded there's a prompt when trying to open it, rather than it immediately opening Excel
* **Code covered by automated testing**: yes
* **User impact if declined**: sec-moderate
* **Is Android affected?**: no
Flags: qe-verify+

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843758#a873104_600971)• 1 years ago |

[Attachment #9345794](/attachment.cgi?id=9345794&action=edit "Bug 1843758.") -
Flags: approval-mozilla-beta?

|  | [Marco Bonardo [:mak]](/user_profile?user_id=240353)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1843758#c12)• 1 years ago |
|  | |

Attached file
[Bug 1843758.](attachment.cgi?id=9345805)
— [Details](attachment.cgi?id=9345805&action=edit)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1843758#c13)• 1 years ago |
|  | |

# Uplift Approval Request

* **User impact if declined**: sec-moderate
* **Is Android affected?**: no
* **Explanation of risk level**: just adding to a blocklist
* **Fix verified in Nightly**: no
* **Code covered by automated testing**: yes
* **String changes made/needed**: none
* **Risk associated with taking this patch**: low
* **Steps to reproduce for manual QE testing**: Try downloading a xll file. If you can't find one easily, rename one in a local file explorer and drag to the tabstrip. Expected behaviour is that once downloaded there's a prompt when trying to open it, rather than it immediately opening Excel
* **Needs manual QE test**: yes

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843758#a901719_75935)• 1 years ago |

[status-firefox115](/buglist.cgi?f1=cf_status_firefox115&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=wontfix)
[status-firefox116](/buglist.cgi?f1=cf_status_firefox116&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=wontfix)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=wontfix)
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected)
[tracking-firefox117](/buglist.cgi?f1=cf_tracking_firefox117&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox117&o1=equals&v1=%2B)
[tracking-firefox-esr115](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=isnotempty):
--- → [117+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=117%2B)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843758#a937591_600971)• 1 years ago |

[Attachment #9345794](/attachment.cgi?id=9345794&action=edit "Bug 1843758.") -
Attachment is obsolete: true
[Attachment #9345794](/attachment.cgi?id=9345794&action=edit "Bug 1843758.") -
Flags: approval-mozilla-beta?

|  | [Marco Bonardo [:mak]](/user_profile?user_id=240353)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1843758#c14)• 1 years ago |
|  | |

Attached file
[Bug 1843758.](attachment.cgi?id=9345966)
— [Details](attachment.cgi?id=9345966&action=edit)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1843758#c15)• 1 years ago |
|  | |

# Uplift Approval Request

* **Fix verified in Nightly**: no
* **Explanation of risk level**: adding to a blocklist
* **String changes made/needed**: none
* **Risk associated with taking this patch**: low
* **Code covered by automated testing**: yes
* **Steps to reproduce for manual QE testing**: Try downloading a xll file. If you can't find one easily, rename one in a local file explorer and drag to the tabstrip. Expected behaviour is that once downloaded there's a prompt when trying to open it, rather than it immediately opening Excel
* **Needs manual QE test**: yes
* **User impact if declined**: sec-moderate
* **Is Android affected?**: no

|  | [Marco Bonardo [:mak]](/user_profile?user_id=240353)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843758#a939005_240353)• 1 years ago |

[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[wontfix](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=wontfix) → [affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected)

|  | [Marco Bonardo [:mak]](/user_profile?user_id=240353)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1843758#c16)• 1 years ago |
|  | |

Attached file
[Bug 1843758.](attachment.cgi?id=9345969) (obsolete)
— [Details](attachment.cgi?id=9345969&action=edit)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1843758#c17)• 1 years ago |
|  | |

# Uplift Approval Request

* **User impact if declined**: sec-moderate - Can ride along an RC or dot
* **Is Android affected?**: no
* **String changes made/needed**: none
* **Risk associated with taking this patch**: low
* **Code covered by automated testing**: yes
* **Steps to reproduce for manual QE testing**: Try downloading a xll file. If you can't find one easily, rename one in a local file explorer and drag to the tabstrip. Expected behaviour is that once downloaded there's a prompt when trying to open it, rather than it immediately opening Excel
* **Fix verified in Nightly**: no
* **Explanation of risk level**: adding to a blocklist
* **Needs manual QE test**: yes

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843758#a982097_75935)• 1 years ago |

[tracking-firefox-esr102](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=isnotempty):
--- → [117+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=117%2B)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1843758#c18)• 1 years ago |
|  | |

Since this bug didn't have a rating it should have requested sec-approval before landing. Please see the guidelines at the "Approval Process" link in the yellow "security bug banner" above.

Keywords: [csectype-other](/buglist.cgi?keywords=csectype-other&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---),
[sec-vector](/buglist.cgi?keywords=sec-vector&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843758#a1409287_1689)• 1 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Marco Bonardo [:mak]](/user_profile?user_id=240353)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1843758#c19)• 1 years ago |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #18](/show_bug.cgi?id=1843758#c18 "VERIFIED FIXED - .xll file extension = A malicious attack using abusing the XLL File starts with the delivery of a malicious file with the extension \"XLL\""))

> Since this bug didn't have a rating it should have requested sec-approval before landing.

I'm sorry about that, it was my fault. I had the other similar recent bug in mind and didn't pay attention to the lack of rating here.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1843758#c20)• 1 years ago |
|  | |

Comment on [attachment 9345805](/attachment.cgi?id=9345805 "Bug 1843758.") [[details]](/attachment.cgi?id=9345805&action=edit "Bug 1843758.")

[Bug 1843758](/show_bug.cgi?id=1843758 "VERIFIED FIXED - .xll file extension = A malicious attack using abusing the XLL File starts with the delivery of a malicious file with the extension \"XLL\"").

Approved for 115.2esr.

[Attachment #9345805](/attachment.cgi?id=9345805&action=edit "Bug 1843758.") -
Flags: approval-mozilla-esr115+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1843758#c21)• 1 years ago |
|  | |

Comment on [attachment 9345966](/attachment.cgi?id=9345966 "Bug 1843758.") [[details]](/attachment.cgi?id=9345966&action=edit "Bug 1843758.")

[Bug 1843758](/show_bug.cgi?id=1843758 "VERIFIED FIXED - .xll file extension = A malicious attack using abusing the XLL File starts with the delivery of a malicious file with the extension \"XLL\"").

Approved for 102.15esr.

[Attachment #9345966](/attachment.cgi?id=9345966&action=edit "Bug 1843758.") -
Flags: approval-mozilla-esr102+

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1843758#c22)• 1 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr115/rev/c294f0f42afd>

|  | [Lando Automation](/user_profile?user_id=640478) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843758#a1574389_640478)• 1 years ago |

[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed)

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1843758#c23)• 1 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr102/rev/67d7740c999c>

|  | [Lando Automation](/user_profile?user_id=640478) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843758#a1574427_640478)• 1 years ago |

[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed)

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843758#a1620244_488993)• 1 years ago |

QA Whiteboard: [post-critsmash-triage]

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843758#a1641003_553429)• 1 years ago |

QA Whiteboard: [post-critsmash-triage] → [post-critsmash-triage][qa-triaged]

|  | [Bogdan Maris, Desktop Test Engineering [PTO until 13 Jan]](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1843758#c24)• 1 years ago |
|  | |

Reproduced the initial issue using an old Nightly build from 2023-07-16, verified that using latest Firefox Beta 117.0b3, latest Firefox 115esr and 102esr from treeherder on Windows 10 and Windows 11 that this is now fixed, we now display the notification after downloading and accessing a .xll file.

Is this fix only for Windows?

I am convinced that this is a Windows only fix but I had to check if this is also for Mac or Linux, I saw that Excel is also available for mac (no notification message for mac on the builds fixed here) but not sure if the format .xll is something for mac and if a malicious .xll on mac can do the same thing as on Windows so I had to ask.

[status-firefox117](/buglist.cgi?f1=cf_status_firefox117&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=verified)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=verified)
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=verified)Flags: needinfo?(mak)

|  | [Marco Bonardo [:mak]](/user_profile?user_id=240353)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1843758#c25)• 1 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1843758&comment_id=16524773 "1 revision") |
|  | |

It is technically possible to develop an .xll file for Excel on Linux (And I suspect Unix in general), but it requires specially crafted code for excel to load it. It's also a lot less likely for users on that platform to have Excel installed. So the impact would be not significant.

Also executable files definition on Unix systems is different, as it doesn't just depend on the file extension.

So I don't think it's worth spending time on those verifications on Unix.

Flags: needinfo?(mak)

|  | [Bogdan Maris, Desktop Test Engineering [PTO until 13 Jan]](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1843758#c26)• 1 years ago |
|  | |

(In reply to Marco Bonardo [:mak] from [comment #25](/show_bug.cgi?id=1843758#c25 "VERIFIED FIXED - .xll file extension = A malicious attack using abusing the XLL File starts with the delivery of a malicious file with the extension \"XLL\""))

> It is technically possible to develop an .xll file for Excel on Linux (And I suspect Unix in general), but it requires specially crafted code for excel to load it. It's also a lot less likely for users on that platform to have Excel installed. So the impact would be not significant.
>
> Also executable files definition on Unix systems is different, as it doesn't just depend on the file extension.
>
> So I don't think it's worth spending time on those verifications on Unix.

Thanks Marco for the info, based on the above I am going to close this as VERIFIED FIXED.

Status: RESOLVED → VERIFIEDFlags: qe-verify+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843758#a2878061_75935)• 1 year ago |

[Attachment #9345969](/attachment.cgi?id=9345969&action=edit "Bug 1843758.") -
Attachment is obsolete: true

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843758#a2878139_600971)• 1 year ago |

[Attachment #9345969](/attachment.cgi?id=9345969&action=edit "Bug 1843758.") -
Flags: approval-mozilla-release-

|  | [June Wilde (she/her) [:jewilde]](/user_profile?user_id=626341) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1843758#c27)• 1 year ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9350229)
— [Details](attachment.cgi?id=9350229&action=edit)

|  | [June Wilde (she/her) [:jewilde]](/user_profile?user_id=626341) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843758#a3439540_626341)• 1 year ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?] [adv-main117+] [adv-esr115.2+] [adv-esr102.15+]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843758#a14848452_1689)• 1 year ago |

Group: core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843758#a14854208_1689)• 1 year ago |

Alias: CVE-2023-4581

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843758#a27587462_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1843758&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Umar Farooq [:Puf]](/user_profile?user_id=687629)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review

