=== Content from www.wireshark.org_98ec33ab_20250110_144628.html ===

## wnpa-sec-2024-10 Â· SPRT dissector crash

## Summary

**Name:** SPRT dissector crash

**Docid:** wnpa-sec-2024-10

**Date:** July 10, 2024

**Affected versions:** 4.2.0 to 4.2.5, 4.0.0 to 4.0.15

**Fixed versions:** 4.2.6, 4.0.16

**References:**

[Wireshark issue 19559](https://gitlab.com/wireshark/wireshark/-/issues/19559).

[CVE-2024-8645](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-8645).

## Details

### Description

The SPRT dissector could crash.

## Impact

It may be possible to make Wireshark
crash

by injecting a malformed packet onto the wire or
by convincing
someone to read a malformed packet trace file.

## Resolution

Upgrade to Wireshark 4.2.6, 4.0.16 or later.



=== Content from gitlab.com_acebc077_20250110_144628.html ===


[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# SPRT parser crash

## Summary

We have a SIP/SDP call that negotiated SPRT (V.150) with payload 0x78 (and RTP version 0) on a UDP port that is originally carrying G.711 (RTP payload type 0, version 2). This works well, but after the SPRT session ends, the UDP port stays the same (as it was for both the original RTP and the SPRT), but the RTP stream goes back to payload type 0 version 2 (G.711 again) - but the packets are still being parsed by SPRT (even thought payload 0 was not negotiated for SPRT, and the G.711 then breaks the parser with an illegal memory access).

## Steps to reproduce

send G.711 RTP packets (payload 0 version 2) on the same port that was processing SPRT (payload not 0, and version 0).

## What is the current bug behavior?

Wireshark crashes

## What is the expected correct behavior?

RTP packets of RTP version 2, and possibly those with a changed PT should not be passed to the SPRT. Admittedly, there are some limitations, since we had to do 'decode as', and so it is only the port that is specified - but I think the RTP version 2 should not be parsed by SPRT - and if the SDP negotiation can be used to determine the payload type, that too should be used.

## Sample capture file

(If possible attach a sample capture file showing this issue)

## Relevant logs and/or screenshots

[![image](data:image/gif;base64...)](/-/project/7898047/uploads/5e0de9fa883785e63a27928b8f31a7f9/image.png)

...
\*\* (wireshark:19728) 11:13:35.126524 [Epan WARNING] -- Dissector bug, protocol SPRT, in packet 7802: STATUS\_ACCESS\_VIOLATION: dissector accessed an invalid memory address
\*\* (wireshark:19728) 11:13:35.127563 [Epan WARNING] -- Dissector bug, protocol SPRT, in packet 7806: STATUS\_ACCESS\_VIOLATION: dissector accessed an invalid memory address
...

## Build information

Numerous versions break including 4.0.4 and 3.6.6 - here is one:
Version 4.0.6 (v4.0.6-0-g[ac2f5a01](/wireshark/wireshark/-/commit/ac2f5a01286addcb34ffb204e1eeb5fd8ccdb85c "Build: 4.0.6")).

Compiled (64-bit) using Microsoft Visual Studio 2022 (VC++ 14.32, build 31332),
with GLib 2.72.3, with PCRE2, with zlib 1.2.12, with Qt 5.15.2, with libpcap,
with Lua 5.2.4, with GnuTLS 3.6.3 and PKCS [#11 (closed)](/wireshark/wireshark/-/issues/11 "protocol Messenger: message is truncated") support, with Gcrypt 1.10.1, with
Kerberos (MIT), with MaxMind, with nghttp2 1.46.0, with brotli, with LZ4, with
Zstandard, with Snappy, with libxml2 2.9.14, with libsmi 0.4.8, with
QtMultimedia, with automatic updates using WinSparkle 0.5.7, with AirPcap, with
SpeexDSP (using bundled resampler), with Minizip, with binary plugins.

Running on 64-bit Windows 10 (22H2), build 19045, with Intel(R) Core(TM)
i7-8750H CPU @ 2.20GHz (with SSE4.2), with 16235 MB of physical memory, with
GLib 2.72.3, with PCRE2 10.40 2022-04-14, with Qt 5.15.2, with Npcap version
1.71, based on libpcap version 1.10.2-PRE-GIT, with c-ares 1.18.1, with GnuTLS
3.6.3, with Gcrypt 1.10.1, with nghttp2 1.46.0, with brotli 1.0.9, with LZ4
1.9.3, with Zstandard 1.5.2, without AirPcap, with light display mode, without
HiDPI, with LC\_TYPE=English\_United States.utf8, binary plugins supported.

Edited Jan 02, 2024 by [vocal-daves](/vocal-daves)

To upload designs, you'll need to enable LFS and have an admin enable hashed storage. [More information](/help/user/project/issues/design_management.md#prerequisites)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


