<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                      "http://www.w3.org/TR/html4/loose.dtd">
<html>
  <head>
    <title>Bug 2769 &ndash; There is a  heap-use-after-free  in  t2p_writeproc function  in tiff2pdf.c line 405 (CVE-2017-17973)</title>


<link rel="Top" href="http://bugzilla.maptools.org/">

  

  


  
    <link rel="Show" title="Dependency Tree"
          href="showdependencytree.cgi?id=2769&amp;hide_resolved=1">
      <link rel="Show" title="Dependency Graph"
            href="showdependencygraph.cgi?id=2769">


      <link rel="Show" title="Bug Activity"
            href="show_activity.cgi?id=2769">
      <link rel="Show" title="Printer-Friendly Version"
            href="show_bug.cgi?format=multiple&amp;id=2769">


    

    
      <link href="skins/standard/global.css"
            rel="stylesheet"
            type="text/css">
      <link href="skins/standard/yui/calendar.css"
            rel="stylesheet"
            type="text/css">
      <link href="skins/standard/show_bug.css"
            rel="stylesheet"
            type="text/css">
    <!--[if IE]>
      
      <link href="skins/standard/IE-fixes.css"
            rel="stylesheet"
            type="text/css">
    <![endif]-->

    
        <link href="skins/standard/global.css"
              rel="stylesheet"
              title="Classic"
              type="text/css">
        <link href="skins/standard/yui/calendar.css"
              rel="stylesheet"
              title="Classic"
              type="text/css">
        <link href="skins/standard/show_bug.css"
              rel="stylesheet"
              title="Classic"
              type="text/css">
      <!--[if IE]>
        
        <link href="skins/standard/IE-fixes.css"
              rel="stylesheet"
              title="Classic"
              type="text/css">
      <![endif]-->

    
        
            <link href="skins/contrib/Dusk/global.css"
                  rel="alternate stylesheet"
                  title="Dusk"
                  type="text/css">
            <link href="skins/contrib/Dusk/yui/calendar.css"
                  rel="alternate stylesheet"
                  title="Dusk"
                  type="text/css">
            <link href="skins/contrib/Dusk/show_bug.css"
                  rel="alternate stylesheet"
                  title="Dusk"
                  type="text/css">
        <!--[if IE]>
          
          <link href="skins/contrib/Dusk/IE-fixes.css"
                rel="alternate stylesheet"
                title="Dusk"
                type="text/css">
        <![endif]-->

    

    
        <link href="skins/custom/global.css" rel="stylesheet" type="text/css">
        <link href="skins/custom/yui/calendar.css" rel="stylesheet" type="text/css">
        <link href="skins/custom/show_bug.css" rel="stylesheet" type="text/css">
    <!--[if IE]>
      
      <link href="skins/custom/IE-fixes.css"
            rel="stylesheet"
            type="text/css">
    <![endif]-->



        <script src="js/util.js" type="text/javascript"></script>
        <script src="js/field.js" type="text/javascript"></script>
        <script src="js/yui/yahoo-dom-event.js" type="text/javascript"></script>
        <script src="js/yui/calendar.js" type="text/javascript"></script>
        <script type="text/javascript">
          YAHOO.namespace('bugzilla');
          if( YAHOO.env.ua.gecko )
            YAHOO.util.Event._simpleRemove(window, "unload", YAHOO.util.Event._unload);
        </script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla" href="./search_plugin.cgi">
    <link rel="shortcut icon" href="images/favicon.ico" >
  </head>



  <body onload=""
        class="bugzilla-maptools-org bz_bug bz_status_RESOLVED bz_component_default bz_bug_2769">




<div id="header">
<table width="100%" border="0" cellpadding="0"
       cellspacing="0">
  <tr>
    <td>
      <img src="/images/banner_maptools_bugs.jpg">
  </td>
  </tr> 
</table>
<!--
<table border="0" cellspacing="0" cellpadding="0" id="titles">
<tr>
   <td id="title">
      <p>Bugzilla &ndash; Bug&nbsp;2769</p>
    </td>

    <td id="subtitle">
      <p class="subheader">There is a  heap-use-after-free  in  t2p_writeproc function  in tiff2pdf.c line 405 (CVE-2017-17973)</p>
    </td>

    <td id="information">
      <p class="header_addl_info">Last modified: 2019-08-16 12:46:34</p>
    </td>
</tr>
</table>
-->
<ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi">New</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input class="txt" type="text" id="quicksearch_top" name="quicksearch">
    <input class="btn" type="submit" value="Find" id="find_top"></form></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li></li>


      <li><span class="separator">| </span><a href="createaccount.cgi">New&nbsp;Account</a></li>
<li>
        <span class="separator">| </span>
        <a href="docs/en/html/bug_page.html" target="_blank">Help</a>
      </li>

      



      

        
      <li><span class="separator">| </span><a href="http://bugzilla.maptools.org/show_bug.cgi?id=2769&amp;GoAheadAndLogIn=1">Log&nbsp;In</a></li>
</ul>

</div>

<div id="bugzilla-body">

<div class="navigation">
  
  
  <i><font color="#777777">First</font></i>
  <i><font color="#777777">Last</font></i>
  <i><font color="#777777">Prev</font></i>
  <i><font color="#777777">Next</font></i>
  &nbsp;&nbsp;
  <i><font color="#777777">No search results available</font></i>
</div>
<script type="text/javascript">
  <!--
  
  /* Outputs a link to call replyToComment(); used to reduce HTML output */
  function addReplyLink(id, real_id) {
      /* XXX this should really be updated to use the DOM Core's
       * createElement, but finding a container isn't trivial.
       */
        document.write('[<a href="#add_comment" onclick="replyToComment(' + 
                       id + ',' + real_id + ');">reply<' + '/a>]');
  }

  /* Adds the reply text to the `comment' textarea */
  function replyToComment(id, real_id) {
      var prefix = "(In reply to comment #" + id + ")\n";
      var replytext = "";
        /* pre id="comment_name_N" */
        var text_elem = document.getElementById('comment_text_'+id);
        var text = getText(text_elem);

        /* make sure we split on all newlines -- IE or Moz use \r and \n
         * respectively.
         */
        text = text.split(/\r|\n/);

        for (var i=0; i < text.length; i++) {
            replytext += "> " + text[i] + "\n"; 
        }

        replytext = prefix + replytext + "\n";


      /* <textarea id="comment"> */
      var textarea = document.getElementById('comment');
      textarea.value += replytext;

      textarea.focus();
  }

  if (typeof Node == 'undefined') {
      /* MSIE doesn't define Node, so provide a compatibility object */
      window.Node = {
          TEXT_NODE: 3,
          ENTITY_REFERENCE_NODE: 5
      };
  }

  /* Concatenates all text from element's childNodes. This is used
   * instead of innerHTML because we want the actual text (and
   * innerText is non-standard).
   */
  function getText(element) {
      var child, text = "";
      for (var i=0; i < element.childNodes.length; i++) {
          child = element.childNodes[i];
          var type = child.nodeType;
          if (type == Node.TEXT_NODE || type == Node.ENTITY_REFERENCE_NODE) {
              text += child.nodeValue;
          } else {
              /* recurse into nodes of other types */
              text += getText(child);
          }
      }
      return text;
  }


  function updateCommentTagControl(checkbox, form) {
      if (checkbox.checked) {
          form.comment.className='bz_private';
      } else {
          form.comment.className='';
      }
  }

  //-->
  </script>

<form name="changeform" method="post" action="process_bug.cgi">

  <input type="hidden" name="delta_ts" value="2019-08-16 12:46:34">
  <input type="hidden" name="longdesclength" value="6">
  <input type="hidden" name="id" value="2769">
  <input type="hidden" name="token" value="1736517670-a044e6a204b1a66c6aba6e9cf3e71473">
<div class="bz_alias_short_desc_container">
    
     <a href="show_bug.cgi?id=2769">
        <b>Bug&nbsp;2769</b></a> - 
     <span id="summary_alias_container" class="bz_default_hidden"> 
      <span id="short_desc_nonedit_display">There is a  heap-use-after-free  in  t2p_writeproc function  in tiff2pdf.c line 405 (CVE-2017-17973)</span>
     </span>
  
       
    <div id="summary_alias_input">
      <table id="summary">  
        
        <tr>
          <td>
            <label accesskey="s" for="short_desc"><u>S</u>ummary</label>:
          </td>
          <td><span title="There is a  heap-use-after-free  in  t2p_writeproc function  in tiff2pdf.c line 405 (CVE-2017-17973)">There is a  heap-use-after-free  in  t2p_writeproc function  in tiff2pdf.c li...
        </span>
          </td>
        </tr>
      </table>
    </div>
  </div>
  <script type="text/javascript">
    hideAliasAndSummary('There is a  heap-use-after-free  in  t2p_writeproc function  in tiff2pdf.c line 405 (CVE-2017-17973)', '');
  </script>
  <table>
    <tr>
      
      <td id="bz_show_bug_column_1" class="bz_show_bug_column">     
        <table>
          <tr>
    <td class="field_label">
      <b><a href="page.cgi?id=fields.html#status">Status</a></b>:
    </td>
    <td id="bz_field_status">
      <span id="static_bug_status">RESOLVED
          WORKSFORME
      </span>
    </td>
  </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr>
      <td class="field_label">
        <label for="product" accesskey="p"><b><u>P</u>roduct</b></label>:
      </td><td>libtiff
  </td>
    </tr>
        
    
    
    <tr>
      <td class="field_label">
        <label for="component" accesskey="m">
          <b><a href="describecomponents.cgi?product=libtiff">
            Co<u>m</u>ponent</a>:
          </b>
        </label>
      </td><td>default
  </td>
    </tr>
    <tr>
      <td class="field_label">
        <label for="version"><b>Version</b></label>:
      </td>
<td>unspecified
  </td>
    </tr>
        
    
        
    <tr>
      <td class="field_label">
        <label for="rep_platform" accesskey="h"><b>Platform</b></label>:
      </td>
      <td>PC
       Linux
       <script type="text/javascript">
         assignToDefaultOnChange(['product', 'component']);
       </script>
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          
          <tr>
      <td class="field_label">
        <label for="priority" accesskey="i">
          <b><a href="page.cgi?id=fields.html#importance"><u>I</u>mportance</a></b></label>:
      </td>
      <td>P2 enhancement
      </td>
    </tr>

      <tr>
        <td class="field_label">
          <label for="target_milestone"><b>
            Target&nbsp;Milestone</b></label>:
        </td><td>---
  </td>
      </tr>            
          
          <tr>
      <td class="field_label">
        <b><a href="page.cgi?id=fields.html#assigned_to">Assigned To</a></b>:
      </td>
      <td><span class="vcard"><a class="email" href="mailto:warmerdam&#64;pobox.com" title="warmerdam&#64;pobox.com" ><span class="fn">Frank Warmerdam</span ></a></span>
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr>
    <td class="field_label">
      <label for="bug_file_loc" accesskey="u"><b>
          <u>U</u>RL</b></label>:
    </td>
    <td>
      <span id="bz_url_input_area">
          <a href=""></a>
      </span>
    </td>
  </tr>
  
    <tr>
      <td class="field_label">
        <label for="status_whiteboard" accesskey="w"><b><u>W</u>hiteboard</b></label>:
      </td><td colspan="2">  
  </td>
    </tr>
  
    <tr>
      <td class="field_label">
        <label for="keywords" accesskey="k">
          <b><a href="describekeywords.cgi"><u>K</u>eywords</a></b></label>:
      </td><td colspan="2">  
  </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          
          <tr><th class="field_label">
    <label for="dependson">Depends&nbsp;on</label>:
  </th>
  <td>    
    <span id="dependson_input_area">
    </span>
    
  </td>
  </tr>
  
  <tr><th class="field_label">
    <label for="blocked" accesskey="b"><u>B</u>locks</label>:
  </th>
  <td>    
    <span id="blocked_input_area">
    </span>
    
  </td>
  
  <tr>
    <th>&nbsp;</th>
  
    <td colspan="2" align="left" id="show_dependency_tree_or_graph">
      Show dependency <a href="showdependencytree.cgi?id=2769&amp;hide_resolved=1">tree</a>
  
        /&nbsp;<a href="showdependencygraph.cgi?id=2769">graph</a>
    </td>
  </tr>
          
        </table>
      </td>
      <td>
        <div class="bz_column_spacer">&nbsp;</div>
      </td>
      
      <td id="bz_show_bug_column_2" class="bz_show_bug_column">
        <table cellpadding="3" cellspacing="1">
        <tr>
    <td class="field_label">
      <b>Reported</b>:
    </td>
    <td>2017-12-29 04:20 by <span class="vcard"><a class="fn email" href="mailto:xiaosatianyu&#64;126.com">xiaosatianyu&#64;126.com</a></span>
    </td>
  </tr>
  
  <tr>
    <td class="field_label">
      <b> Modified</b>:
    </td>
    <td>2019-08-16 12:46 
      (<a href="show_activity.cgi?id=2769">History</a>)
    </td>
  
  </tr>
         
         <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr> 
         
         <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
         
                

        </table>
      </td>
    </tr>
    <tr>
      <td colspan="3">
          <hr id="bz_top_half_spacer">
      </td>
    </tr>
  </table>

  
  


<script type="text/javascript">
  <!--
  function toggle_display(link) {
    var table = document.getElementById("attachment_table");
    var rows = table.getElementsByTagName("tr");
    var originalHeight = table.offsetHeight; // Store current height for scrolling

    var toggle;
    if (link.innerHTML == "Show Obsolete") {
      toggle = ""; // This should be 'table-row', but IE 6 doesn't understand it.
      link.innerHTML = "Hide Obsolete";
    }
    else {
      toggle = "none";
      link.innerHTML = "Show Obsolete";
    }

    for (var i = 0; i < rows.length; i++) {
      if (rows[i].className.match('bz_tr_obsolete'))
        rows[i].style.display = toggle;
    }

    var newHeight = table.offsetHeight;
    window.scrollBy(0, newHeight - originalHeight);

    return false;
  }
  //-->
</script>

<br>
<table id="attachment_table" cellspacing="0" cellpadding="4">
  <tr>
    <th colspan="2" align="left">
      <a name="a0" id="a0">Attachments</a>
    </th>
  </tr>


      <tr class="
                 ">
        <td valign="top">
            <a name="a1" href="attachment.cgi?id=837"
               title="View the content of the attachment">
          <b>pod</b></a>

          <span class="bz_attach_extra_info">
              (3.93 KB,
                application/octet-stream)

            <br>
            <a href="#attach_837"
               title="Go to the comment associated with the attachment">2017-12-29 04:20</a>,

            <a href="mailto:xiaosatianyu&#64;126.com"
               title="Write an email to the creator of the attachment">xiaosatianyu&#64;126.com
            </a>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=837&amp;action=edit">Details</a>
        </td>
      </tr>

  <tr class="bz_attach_footer">
    <td colspan="2">
        <span class="bz_attach_view_hide">
        </span>
      <a href="attachment.cgi?bugid=2769&amp;action=enter">Add an attachment</a>
      (proposed patch, testcase, etc.)
    </td>
  </tr>
</table>
<br>




  <br>
  <table cellpadding="1" cellspacing="1">
    <tr>
      <td id="comment_status_commit">
        <!-- The table keeps the commit button aligned with the box. -->
        <a name="add_comment"></a>
          <fieldset>
            <legend>Note</legend>
            <p>
              You need to
              <a href="show_bug.cgi?id=2769&amp;GoAheadAndLogIn=1">log in</a>
              before you can comment on or make changes to this bug.
            </p>
          </fieldset>
        
        <hr>
        <div id="comments"><script type="text/javascript">
  <!--
  function updateCommentPrivacy(checkbox, id) {
    var comment_elem = document.getElementById('comment_text_'+id).parentNode;
    if (checkbox.checked) {
      if (!comment_elem.className.match('bz_private')) {
        comment_elem.className = comment_elem.className.concat(' bz_private');
      }
    }
    else {
      comment_elem.className =
        comment_elem.className.replace(/(\s*|^)bz_private(\s*|$)/, '$2');
    }
  }

  /* The functions below expand and collapse comments  */

  function toggle_comment_display(link, comment_id) {
    var comment = document.getElementById('comment_text_' + comment_id);
    var re = new RegExp(/\bcollapsed\b/);
    if (comment.className.match(re))
        expand_comment(link, comment);
    else
        collapse_comment(link, comment);
  }

  function toggle_all_comments(action) {
    var num_comments = 6;

    // If for some given ID the comment doesn't exist, this doesn't mean
    // there are no more comments, but that the comment is private and
    // the user is not allowed to view it.

    for (var id = 0; id < num_comments; id++) {
        var comment = document.getElementById('comment_text_' + id);
        if (!comment)
            continue;

        var link = document.getElementById('comment_link_' + id);
        if (action == 'collapse')
            collapse_comment(link, comment);
        else
            expand_comment(link, comment);
    }
  }

  function collapse_comment(link, comment) {
    link.innerHTML = "(+)";
    link.title = "Expand the comment.";
    comment.className = "collapsed";
  }

  function expand_comment(link, comment) {
    link.innerHTML = "(-)";
    link.title = "Collapse the comment";
    comment.className = "";
  }

  /* This way, we are sure that browsers which do not support JS
   * won't display this link  */

  function addCollapseLink(count) {
    document.write(' <a href="#" id="comment_link_' + count +
                   '" onclick="toggle_comment_display(this, ' +  count +
                   '); return false;" title="Collapse the comment.">(-)</a> ');
  }
  //-->
  </script>








<div class="bz_comment bz_first_comment">

      <span class="bz_first_comment_head">
        
        <i>
        <a name="c0" href="show_bug.cgi?id=2769#c0">Description</a> From
        <span class="vcard">
          <a class="fn email" href="mailto:xiaosatianyu&#64;126.com">xiaosatianyu&#64;126.com</a>
        </span>

        2017-12-29 04:20:20</i>

        
      </span>



<pre class="bz_comment_text" ><span class=""><a href="attachment.cgi?id=837" name="attach_837" title="pod">Created an attachment (id=837)</a> <a href="attachment.cgi?id=837&amp;action=edit" title="pod">[details]</a></span>
pod

There is a  heap-use-after-free  in  t2p_writeproc function  in tiff2pdf.c line
405.
=================================================================
==12652==ERROR: AddressSanitizer: heap-use-after-free on address 0x603000001510
at pc 0x000000470005 bp 0x7fffb2fb31d0 sp 0x7fffb2fb2980
READ of size 32 at 0x603000001510 thread T0
    #0 0x470004 in __interceptor_fwrite
/home/xiaosatianyu/workspace/git/LLVM/llvm/projects/compiler-rt/lib/asan/../sanitizer_common/sanitizer_common_interceptors.inc:1051
    #1 0x52d18a in t2p_writeproc
/home/xiaosatianyu/workspace/git/fuzz/for-new-CVE/benlibtiff/libtiff/tools/tiff2pdf.c:405:21
    #2 0x55a242 in t2pWriteFile
/home/xiaosatianyu/workspace/git/fuzz/for-new-CVE/benlibtiff/libtiff/tools/tiff2pdf.c:379:10
    #3 0x567bd8 in t2p_write_pdf_stream
/home/xiaosatianyu/workspace/git/fuzz/for-new-CVE/benlibtiff/libtiff/tools/tiff2pdf.c:3989:13
    #4 0x580218 in t2p_write_pdf_transfer_stream
/home/xiaosatianyu/workspace/git/fuzz/for-new-CVE/benlibtiff/libtiff/tools/tiff2pdf.c:5017:13
    #5 0x52fd08 in t2p_write_pdf
/home/xiaosatianyu/workspace/git/fuzz/for-new-CVE/benlibtiff/libtiff/tools/tiff2pdf.c:5497:16
    #6 0x52bd9b in main
/home/xiaosatianyu/workspace/git/fuzz/for-new-CVE/benlibtiff/libtiff/tools/tiff2pdf.c:808:2
    #7 0x7f285f27bf44 in __libc_start_main
/build/eglibc-SvCtMH/eglibc-2.19/csu/libc-start.c:287
    #8 0x41c8eb in _start (/home/binzhang/Desktop/tiff2pdf/tiff2pdf+0x41c8eb)

0x603000001510 is located 0 bytes inside of 32-byte region
[0x603000001510,0x603000001530)
freed by thread T0 here:
    #0 0x4f5290 in __interceptor_free
/home/xiaosatianyu/workspace/git/LLVM/llvm/projects/compiler-rt/lib/asan/asan_malloc_linux.cc:68
    #1 0x7bde10 in _TIFFfree
/home/xiaosatianyu/workspace/git/fuzz/for-new-CVE/benlibtiff/libtiff/libtiff/tif_unix.c:330:2
    #2 0x592a30 in TIFFFreeDirectory
/home/xiaosatianyu/workspace/git/fuzz/for-new-CVE/benlibtiff/libtiff/libtiff/tif_dir.c:1266:2
    #3 0x5cb5a2 in TIFFReadDirectory
/home/xiaosatianyu/workspace/git/fuzz/for-new-CVE/benlibtiff/libtiff/libtiff/tif_dirread.c:3563:2
    #4 0x5bea4a in TIFFSetDirectory
/home/xiaosatianyu/workspace/git/fuzz/for-new-CVE/benlibtiff/libtiff/libtiff/tif_dir.c:1622:10
    #5 0x5338e1 in t2p_read_tiff_init
/home/xiaosatianyu/workspace/git/fuzz/for-new-CVE/benlibtiff/libtiff/tools/tiff2pdf.c:1131:3
    #6 0x52e0cc in t2p_write_pdf
/home/xiaosatianyu/workspace/git/fuzz/for-new-CVE/benlibtiff/libtiff/tools/tiff2pdf.c:5431:2
    #7 0x52bd9b in main
/home/xiaosatianyu/workspace/git/fuzz/for-new-CVE/benlibtiff/libtiff/tools/tiff2pdf.c:808:2
    #8 0x7f285f27bf44 in __libc_start_main
/build/eglibc-SvCtMH/eglibc-2.19/csu/libc-start.c:287

previously allocated by thread T0 here:
    #0 0x4f55f6 in __interceptor_malloc
/home/xiaosatianyu/workspace/git/LLVM/llvm/projects/compiler-rt/lib/asan/asan_malloc_linux.cc:88
    #1 0x7bdc60 in _TIFFmalloc
/home/xiaosatianyu/workspace/git/fuzz/for-new-CVE/benlibtiff/libtiff/libtiff/tif_unix.c:316:10
    #2 0x590197 in setByteArray
/home/xiaosatianyu/workspace/git/fuzz/for-new-CVE/benlibtiff/libtiff/libtiff/tif_dir.c:54:19
    #3 0x590413 in _TIFFsetShortArray
/home/xiaosatianyu/workspace/git/fuzz/for-new-CVE/benlibtiff/libtiff/libtiff/tif_dir.c:66:7
    #4 0x5a2127 in _TIFFVSetField
/home/xiaosatianyu/workspace/git/fuzz/for-new-CVE/benlibtiff/libtiff/libtiff/tif_dir.c:457:4
    #5 0x7b71a0 in ZIPVSetField
/home/xiaosatianyu/workspace/git/fuzz/for-new-CVE/benlibtiff/libtiff/libtiff/tif_zip.c:375:10
    #6 0x777cc9 in PredictorVSetField
/home/xiaosatianyu/workspace/git/fuzz/for-new-CVE/benlibtiff/libtiff/libtiff/tif_predict.c:774:10
    #7 0x590984 in TIFFVSetField
/home/xiaosatianyu/workspace/git/fuzz/for-new-CVE/benlibtiff/libtiff/libtiff/tif_dir.c:854:6
    #8 0x590811 in TIFFSetField
/home/xiaosatianyu/workspace/git/fuzz/for-new-CVE/benlibtiff/libtiff/libtiff/tif_dir.c:798:11
    #9 0x5d0cec in TIFFReadDirectory
/home/xiaosatianyu/workspace/git/fuzz/for-new-CVE/benlibtiff/libtiff/libtiff/tif_dirread.c:3931:7
    #10 0x5bea4a in TIFFSetDirectory
/home/xiaosatianyu/workspace/git/fuzz/for-new-CVE/benlibtiff/libtiff/libtiff/tif_dir.c:1622:10
    #11 0x5338e1 in t2p_read_tiff_init
/home/xiaosatianyu/workspace/git/fuzz/for-new-CVE/benlibtiff/libtiff/tools/tiff2pdf.c:1131:3
    #12 0x52e0cc in t2p_write_pdf
/home/xiaosatianyu/workspace/git/fuzz/for-new-CVE/benlibtiff/libtiff/tools/tiff2pdf.c:5431:2
    #13 0x52bd9b in main
/home/xiaosatianyu/workspace/git/fuzz/for-new-CVE/benlibtiff/libtiff/tools/tiff2pdf.c:808:2
    #14 0x7f285f27bf44 in __libc_start_main
/build/eglibc-SvCtMH/eglibc-2.19/csu/libc-start.c:287

SUMMARY: AddressSanitizer: heap-use-after-free
/home/xiaosatianyu/workspace/git/LLVM/llvm/projects/compiler-rt/lib/asan/../sanitizer_common/sanitizer_common_interceptors.inc:1051
in __interceptor_fwrite
Shadow bytes around the buggy address:
  0x0c067fff8250: fd fd fa fa fd fd fd fd fa fa fd fd fd fd fa fa
  0x0c067fff8260: fd fd fd fd fa fa fd fd fd fd fa fa fd fd fd fd
  0x0c067fff8270: fa fa fd fd fd fd fa fa fd fd fd fd fa fa fd fd
  0x0c067fff8280: fd fd fa fa fd fd fd fd fa fa fd fd fd fd fa fa
  0x0c067fff8290: fd fd fd fd fa fa fd fd fd fa fa fa fd fd fd fd
=&gt;0x0c067fff82a0: fa fa[fd]fd fd fd fa fa fd fd fd fd fa fa fd fd
  0x0c067fff82b0: fd fd fa fa fd fd fd fd fa fa fd fd fd fd fa fa
  0x0c067fff82c0: fd fd fd fd fa fa fd fd fd fd fa fa fd fd fd fd
  0x0c067fff82d0: fa fa fd fd fd fd fa fa fd fd fd fd fa fa fd fd
  0x0c067fff82e0: fd fd fa fa fd fd fd fd fa fa fd fd fd fd fa fa
  0x0c067fff82f0: fd fd fd fd fa fa fd fd fd fd fa fa fd fd fd fd
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==12652==ABORTING</pre>
    </div>
  <div class="bz_comment">

      <span class="bz_comment_head">
        <span class="comment_rule">-------</span>
        <i>Comment
        <a name="c1" href="show_bug.cgi?id=2769#c1">#1</a> From
        <span class="vcard">
          <a class="fn email" href="mailto:carnil&#64;debian.org">Salvatore Bonaccorso</a>
        </span>

        2017-12-31 10:38:04</i>

        <span class="comment_rule">-------</span>
      </span>



<pre class="bz_comment_text" >This issue has been assigned CVE-2017-17973</pre>
    </div>
  <div class="bz_comment">

      <span class="bz_comment_head">
        <span class="comment_rule">-------</span>
        <i>Comment
        <a name="c2" href="show_bug.cgi?id=2769#c2">#2</a> From
        <span class="vcard">
          <a class="fn email" href="mailto:huzaifas&#64;redhat.com">Huzaifa Sidhpurwala</a>
        </span>

        2018-01-15 00:09:50</i>

        <span class="comment_rule">-------</span>
      </span>



<pre class="bz_comment_text" >I am not able to reproduce this on libtiff master, can you please specify what
version of libtiff was used for reproducing this?</pre>
    </div>
  <div class="bz_comment">

      <span class="bz_comment_head">
        <span class="comment_rule">-------</span>
        <i>Comment
        <a name="c3" href="show_bug.cgi?id=2769#c3">#3</a> From
        <span class="vcard">
          <a class="fn email" href="mailto:carnil&#64;debian.org">Salvatore Bonaccorso</a>
        </span>

        2018-01-27 03:44:27</i>

        <span class="comment_rule">-------</span>
      </span>



<pre class="bz_comment_text" >xiaosatianyu, can you give details on how one can reproduce the issue? I was
neither on master (as Huzaifa noted), nor on Release-v4-0-9 and Release-v4-0-8.</pre>
    </div>
  <div class="bz_comment">

      <span class="bz_comment_head">
        <span class="comment_rule">-------</span>
        <i>Comment
        <a name="c4" href="show_bug.cgi?id=2769#c4">#4</a> From
        <span class="vcard">
          <a class="fn email" href="mailto:carnil&#64;debian.org">Salvatore Bonaccorso</a>
        </span>

        2018-05-10 14:06:01</i>

        <span class="comment_rule">-------</span>
      </span>



<pre class="bz_comment_text" >xiaosatianyu, ping?</pre>
    </div>
  <div class="bz_comment">

      <span class="bz_comment_head">
        <span class="comment_rule">-------</span>
        <i>Comment
        <a name="c5" href="show_bug.cgi?id=2769#c5">#5</a> From
        <span class="vcard">
          <a class="fn email" href="mailto:even.rouault&#64;mines-paris.org">Even Rouault</a>
        </span>

        2019-08-16 12:46:34</i>

        <span class="comment_rule">-------</span>
      </span>



<pre class="bz_comment_text" >Cannot reproduce either. Closing</pre>
    </div>
        </div>
        
      </td>
    </tr>
  </table>
</form>

<hr>
<ul class="related_actions">
    <li><a href="show_bug.cgi?format=multiple&amp;id=2769">Format For Printing</a></li>
    <li>&nbsp;-&nbsp;<a href="show_bug.cgi?ctype=xml&amp;id=2769">XML</a></li>
    <li>&nbsp;-&nbsp;<a href="enter_bug.cgi?cloned_bug_id=2769">Clone This Bug</a></li>
    
    <li>&nbsp;-&nbsp;<a href="#">Top of page </a></li>
    </ul>        


<div class="navigation">
  
  
  <i><font color="#777777">First</font></i>
  <i><font color="#777777">Last</font></i>
  <i><font color="#777777">Prev</font></i>
  <i><font color="#777777">Next</font></i>
  &nbsp;&nbsp;
  <i><font color="#777777">No search results available</font></i>
</div>

<br>
</div>



<div id="footer">
  <div class="intro"></div>




<ul id="useful-links">
  <li id="links-actions">
    <div class="label">Actions: </div><ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi">New</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input class="txt" type="text" id="quicksearch_bottom" name="quicksearch">
    <input class="btn" type="submit" value="Find" id="find_bottom"></form></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li></li>


      <li><span class="separator">| </span><a href="createaccount.cgi">New&nbsp;Account</a></li>
<li>
        <span class="separator">| </span>
        <a href="docs/en/html/bug_page.html" target="_blank">Help</a>
      </li>

      



      

        
      <li><span class="separator">| </span><a href="http://bugzilla.maptools.org/show_bug.cgi?id=2769&amp;GoAheadAndLogIn=1">Log&nbsp;In</a></li>
</ul>
  </li>

  
    

  


  
</ul>

  <div class="outro"></div>
</div>

</body>
</html>