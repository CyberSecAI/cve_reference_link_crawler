

| [cgit logo](/) | [index](/) : [kernel/git/torvalds/linux.git](/pub/scm/linux/kernel/git/torvalds/linux.git/) | for-next master vsnprintf |
| --- | --- | --- |
| Linux kernel source tree | Linus Torvalds |

| [about](/pub/scm/linux/kernel/git/torvalds/linux.git/about/)[summary](/pub/scm/linux/kernel/git/torvalds/linux.git/)[refs](/pub/scm/linux/kernel/git/torvalds/linux.git/refs/?id=1d0688421449718c6c5f46e458a378c9b530ba18)[log](/pub/scm/linux/kernel/git/torvalds/linux.git/log/)[tree](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=1d0688421449718c6c5f46e458a378c9b530ba18)[commit](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=1d0688421449718c6c5f46e458a378c9b530ba18)[diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=1d0688421449718c6c5f46e458a378c9b530ba18)[stats](/pub/scm/linux/kernel/git/torvalds/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Soenke Huster <soenke.huster@eknoes.de> | 2021-10-20 10:14:44 +0200 |
| --- | --- | --- |
| committer | Marcel Holtmann <marcel@holtmann.org> | 2021-10-20 14:58:46 +0200 |
| commit | [1d0688421449718c6c5f46e458a378c9b530ba18](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=1d0688421449718c6c5f46e458a378c9b530ba18) ([patch](/pub/scm/linux/kernel/git/torvalds/linux.git/patch/?id=1d0688421449718c6c5f46e458a378c9b530ba18)) | |
| tree | [535a02cb841e8433ff20f436797d05fdf73b48f3](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=1d0688421449718c6c5f46e458a378c9b530ba18) | |
| parent | [b8f5482c9638915c19963f06d2f4094e276aaab6](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=b8f5482c9638915c19963f06d2f4094e276aaab6) ([diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=1d0688421449718c6c5f46e458a378c9b530ba18&id2=b8f5482c9638915c19963f06d2f4094e276aaab6)) | |
| download | [linux-1d0688421449718c6c5f46e458a378c9b530ba18.tar.gz](/pub/scm/linux/kernel/git/torvalds/linux.git/snapshot/linux-1d0688421449718c6c5f46e458a378c9b530ba18.tar.gz) | |

Bluetooth: virtio\_bt: fix memory leak in virtbt\_rx\_handle()On the reception of packets with an invalid packet type, the memory of
the allocated socket buffers is never freed. Add a default case that frees
these to avoid a memory leak.
Fixes: afd2daa26c7a ("Bluetooth: Add support for virtio transport driver")
Signed-off-by: Soenke Huster <soenke.huster@eknoes.de>
Signed-off-by: Marcel Holtmann <marcel@holtmann.org>
[Diffstat](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=1d0688421449718c6c5f46e458a378c9b530ba18)

| -rw-r--r-- | [drivers/bluetooth/virtio\_bt.c](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/drivers/bluetooth/virtio_bt.c?id=1d0688421449718c6c5f46e458a378c9b530ba18) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 3 insertions, 0 deletions

| diff --git a/drivers/bluetooth/virtio\_bt.c b/drivers/bluetooth/virtio\_bt.cindex 57908ce4fae856..076e4942a3f0ed 100644--- a/[drivers/bluetooth/virtio\_bt.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/drivers/bluetooth/virtio_bt.c?id=b8f5482c9638915c19963f06d2f4094e276aaab6)+++ b/[drivers/bluetooth/virtio\_bt.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/drivers/bluetooth/virtio_bt.c?id=1d0688421449718c6c5f46e458a378c9b530ba18)@@ -202,6 +202,9 @@ static void virtbt\_rx\_handle(struct virtio\_bluetooth \*vbt, struct sk\_buff \*skb) hci\_skb\_pkt\_type(skb) = pkt\_type; hci\_recv\_frame(vbt->hdev, skb); break;+ default:+ kfree\_skb(skb);+ break; } } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-08 13:46:40 +0000

