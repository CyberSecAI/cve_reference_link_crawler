

[Skip to content](#main-content)
Navigation menu

[![DEV Community](https://media2.dev.to/dynamic/image/quality=100/https://dev-to-uploads.s3.amazonaws.com/uploads/logos/resized_logo_UQww2soKuUsjaOGNB38o.png)](/)

Search

[Powered by
Search

Algolia](https://www.algolia.com/developers/?utm_source=devto&utm_medium=referral)

[Search](/search)
[Log in](/enter)

[Create account](/enter?state=new-user)

## DEV Community

Close

![](https://assets.dev.to/assets/heart-plus-active-9ea3b22f2bc311281db911d416166c5f430636e76b15cd5df6b3b841d830eefa.svg)

Add reaction

![](https://assets.dev.to/assets/sparkle-heart-5f9bee3767e18deb1bb725290cb151c25234768a0e9a2bd39370c382d02920cf.svg)

Like

![](https://assets.dev.to/assets/multi-unicorn-b44d6f8c23cdd00964192bedc38af3e82463978aa611b4365bd33a0f1f4f3e97.svg)

Unicorn

![](https://assets.dev.to/assets/exploding-head-daceb38d627e6ae9b730f36a1e390fca556a4289d5a41abb2c35068ad3e2c4b5.svg)

Exploding Head

![](https://assets.dev.to/assets/raised-hands-74b2099fd66a39f2d7eed9305ee0f4553df0eb7b4f11b01b6b1b499973048fe5.svg)

Raised Hands

![](https://assets.dev.to/assets/fire-f60e7a582391810302117f987b22a8ef04a2fe0df7e3258a5f49332df1cec71e.svg)

Fire

Jump to Comments

Save

Boost

More...

Copy link
Copy link

Copied to Clipboard

[Share to X](https://twitter.com/intent/tweet?text=%22Cleaning%20Your%20Git%20History%3A%20Safely%20Removing%20Sensitive%20Data%22%20by%20Balogh%20Botond%20%23DEVCommunity%20https%3A%2F%2Fdev.to%2Fbalogh08%2Fcleaning-your-git-history-safely-removing-sensitive-data-10i5)
[Share to LinkedIn](https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fdev.to%2Fbalogh08%2Fcleaning-your-git-history-safely-removing-sensitive-data-10i5&title=Cleaning%20Your%20Git%20History%3A%20Safely%20Removing%20Sensitive%20Data&summary=Table%20of%20Contents%20%20%20%20Introduction%20Understanding%20git%20filter-branch%20Step-by-Step%20Guide%20%20%20%20%20%20%20...&source=DEV%20Community)
[Share to Facebook](https://www.facebook.com/sharer.php?u=https%3A%2F%2Fdev.to%2Fbalogh08%2Fcleaning-your-git-history-safely-removing-sensitive-data-10i5)
[Share to Mastodon](https://toot.kytta.dev/?text=https%3A%2F%2Fdev.to%2Fbalogh08%2Fcleaning-your-git-history-safely-removing-sensitive-data-10i5)

Share Post via...

[Report Abuse](/report-abuse)

[![Cover image for Cleaning Your Git History: Safely Removing Sensitive Data](https://media2.dev.to/dynamic/image/width=1000,height=420,fit=cover,gravity=auto,format=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Fa8nhyrk4weqkmbonzxqq.png)](https://media2.dev.to/dynamic/image/width%3D1000%2Cheight%3D420%2Cfit%3Dcover%2Cgravity%3Dauto%2Cformat%3Dauto/https%3A//dev-to-uploads.s3.amazonaws.com/uploads/articles/a8nhyrk4weqkmbonzxqq.png)

[![Balogh Botond](https://media2.dev.to/dynamic/image/width=50,height=50,fit=cover,gravity=auto,format=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Fuser%2Fprofile_image%2F1104123%2F18231306-f6b2-4040-b5be-c87af0e3200f.jpeg)](/balogh08)

[Balogh Botond](/balogh08)

Posted on Dec 19, 2023
• Edited on Jul 24, 2024

![](https://assets.dev.to/assets/sparkle-heart-5f9bee3767e18deb1bb725290cb151c25234768a0e9a2bd39370c382d02920cf.svg)

![](https://assets.dev.to/assets/multi-unicorn-b44d6f8c23cdd00964192bedc38af3e82463978aa611b4365bd33a0f1f4f3e97.svg)

![](https://assets.dev.to/assets/exploding-head-daceb38d627e6ae9b730f36a1e390fca556a4289d5a41abb2c35068ad3e2c4b5.svg)

![](https://assets.dev.to/assets/raised-hands-74b2099fd66a39f2d7eed9305ee0f4553df0eb7b4f11b01b6b1b499973048fe5.svg)

![](https://assets.dev.to/assets/fire-f60e7a582391810302117f987b22a8ef04a2fe0df7e3258a5f49332df1cec71e.svg)

# Cleaning Your Git History: Safely Removing Sensitive Data

[#tutorial](/t/tutorial)
[#learning](/t/learning)
[#git](/t/git)

## Table of Contents

1. [Introduction](#introduction)
2. [Understanding git filter-branch](#git-filter-branch)
3. [Step-by-Step Guide](#step-by-step-guide)

## Introduction

While working on integrating third-party API into my project, I made a critical mistake in software development. I accidentally committed my `API keys` directly in a configuration file, rather than using a `.env` file that is part of the `.gitignore`. My repository was still `private`, but with plans to go public, I needed to remove this information from the git history.

How to remove the commits containing the sensitive information from my history? After some research, I decided to use the `git filter-branch` command. In the end, it worked as it was expected. I did not lose anything else from my git history only the commits related to the certain config file and the config file itself which I had to recreate with the help of a backup branch.

Whether you're a seasoned developer or new to the realm of version control, this guide will provide a clear, step-by-step approach to ensure to remove safely commits from a branch that are related to a specific file.

## Git filter-branch

About `git filter-branch`, it is a powerful and yet dangerous tool of git. It allows you to modify your commit history in various ways, such as changing commit messages, author details, or, as in my case, removing commits that contain sensitive information like API keys. It works by filtering the entire branch history, committing anew based on the changes you specify.

Please use it with caution. It can lead to data loss or discrepancies in your project's history. It's recommended to use this tool in a controlled environment (like a private repository) and ensure you have complete backups of your data before proceeding. Furthermore, if you're working in a team, coordinating with your colleagues is essential to avoid conflicts or data inconsistencies once the history is altered. Check the documentation and especially safety information before using it. [Git filter-branch documentation](https://git-scm.com/docs/git-filter-branch)

[![Dombledore meme](https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Fwdxi343wc9g50fag54k3.jpeg)](https://media2.dev.to/dynamic/image/width%3D800%2Cheight%3D%2Cfit%3Dscale-down%2Cgravity%3Dauto%2Cformat%3Dauto/https%3A//dev-to-uploads.s3.amazonaws.com/uploads/articles/wdxi343wc9g50fag54k3.jpeg)

## Step-by-Step Guide

The branch I was working on was named `secret_keys` in which I committed and pushed the `secret_key` in the `config.js` file. That’s where the trouble begins… I did not realise it for a while so many other commits had been pushed to the repo.

[![Commits to remove](https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Fzwaxhvrzwjs8kystpzb0.png)](https://media2.dev.to/dynamic/image/width%3D800%2Cheight%3D%2Cfit%3Dscale-down%2Cgravity%3Dauto%2Cformat%3Dauto/https%3A//dev-to-uploads.s3.amazonaws.com/uploads/articles/zwaxhvrzwjs8kystpzb0.png)

First, I added the `.env` to my `.gitignore` and pushed it to the repo. After that, I created the `.env` file which is not part of the version history, and added the secret key to that file from my `config.js` I referred to the `.env` file instead of hardcoding the secret key in the `config.js` file itself.

[![.env secret key](https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2F3ympjz9iuu1ptl86rik7.png)](https://media2.dev.to/dynamic/image/width%3D800%2Cheight%3D%2Cfit%3Dscale-down%2Cgravity%3Dauto%2Cformat%3Dauto/https%3A//dev-to-uploads.s3.amazonaws.com/uploads/articles/3ympjz9iuu1ptl86rik7.png)

In this situation, the secret key is available in the version control. I must get rid of this. Here comes the git filter-branch command. But first, let me create a backup branch for safety: `secret_key_backup`.

Then I opened a terminal in my project, and made sure that I was on the desired branch:

```

git checkout secret_keys

```
Enter fullscreen mode

Exit fullscreen mode

Output:

```

Switched to branch 'secret_keys'
Your branch is up to date with 'origin/secret_keys'.

```
Enter fullscreen mode

Exit fullscreen mode

Here you can see the main commits that must be removed for safety

[![Main commits to be removed](https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Fbhswiplq1378knobga3q.png)](https://media2.dev.to/dynamic/image/width%3D800%2Cheight%3D%2Cfit%3Dscale-down%2Cgravity%3Dauto%2Cformat%3Dauto/https%3A//dev-to-uploads.s3.amazonaws.com/uploads/articles/bhswiplq1378knobga3q.png)

Next, I ran the git filter-branch command:

```

git filter-branch --force --index-filter "git rm --cached --ignore-unmatch file_containing_secret_keys.js" --prune-empty --tag-name-filter cat -- branch_name_containing_commits_to_remove

```
Enter fullscreen mode

Exit fullscreen mode

* `git filter-branch`: Initiates the process of rewriting the git history.
* `--force`: Forces the rewrite of history, necessary if you've already run filter-branch before. Overrides the safety checks to prevent overwriting existing backups.
* `--index-filter`: Specifies a filter to rewrite the index at each revision.
* `"git rm --cached --ignore-unmatch file_containing_secret_keys.js"`: The command that `--index-filter` runs for each commit.
  + `git rm --cached`: Removes the specified file from the index (staging area) but not from the working directory.
  + `--ignore-unmatch`: Prevents errors if the file isn't found in a particular commit.
  + `file_containing_secret_keys.js`: The specific file you want to remove from your history.
* `--prune-empty`: Tells git filter-branch to remove commits that become empty after the filter has been applied.
* `--tag-name-filter cat`: This filter is applied to tag names that point to rewritten commits. `cat` just keeps the original tag name.
* `--`: Separator that clarifies the end of the options and the beginning of the branch specification.
* `branch_name_containing_commits_to_remove`: Specifies the branch whose history you want to rewrite.

This command is tailored to remove a specific file from the history of a given branch, eliminating all references to that file in your commits.

In my case:

```

git filter-branch --force --index-filter "git rm --cached --ignore-unmatch config.js" --prune-empty --tag-name-filter cat -- secret_keys

```
Enter fullscreen mode

Exit fullscreen mode

Output:

```

**WARNING**: git-filter-branch has a glut of gotchas generating mangled history rewrites. Hit Ctrl-C before proceeding to abort, then use an alternative filtering tool such as 'git filter-repo' (https://github.com/newren/git-filter-repo/) instead. See the filter-branch manual page for more details; to squelch this warning, set FILTER_BRANCH_SQUELCH_WARNING=1.

Proceeding with filter-branch...

Rewrite a3a48b09e282854c80bf4ad02a017e249e161fd8 (2/8) (0 seconds passed, remaining 0 predicted)    rm 'config.js'
Rewrite 6e788e83a338e45b348d93d682b32c816ee2fbff (3/8) (0 seconds passed, remaining 0 predicted)    rm 'config.js'
Rewrite 7a378a0145bce70bea213ca5f9062138544db5f2 (4/8) (0 seconds passed, remaining 0 predicted)    rm 'config.js'
Rewrite 0637c9659623644cfceb35be10f2a1fe5c468e04 (5/8) (0 seconds passed, remaining 0 predicted)    rm 'config.js'
Rewrite 6c421eb99adc6b987cff7f3cada31e9313638072 (6/8) (0 seconds passed, remaining 0 predicted)    rm 'config.js'
Rewrite 98001e5b97270efa4a8ab5bd0452be56dd76883d (7/8) (0 seconds passed, remaining 0 predicted)    rm 'config.js'
Rewrite 2ca4e161a4af2b8f38c46faf848fdbb3e550f23c (8/8) (0 seconds passed, remaining 0 predicted)    rm 'config.js'

Ref 'refs/heads/secret_keys' was rewritten.

```
Enter fullscreen mode

Exit fullscreen mode

[![Commits removed](https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Fjn0aoyekmnlb2niagg7z.png)](https://media2.dev.to/dynamic/image/width%3D800%2Cheight%3D%2Cfit%3Dscale-down%2Cgravity%3Dauto%2Cformat%3Dauto/https%3A//dev-to-uploads.s3.amazonaws.com/uploads/articles/jn0aoyekmnlb2niagg7z.png)

In the image, you can see 2 commits left, as the placeholder commits I made were related to the `config.js` so they were removed as well. If I pull the repo then I would get back to the previous state so the deleted commits can be retrieved from the repo at this point. It will create a merge commit which you could push back and then all your commits would be restored, but we want them to be deleted so do not do that unless you want to play around a bit.

To apply the modification, you need to force push:

```

git push origin branch_name_containing_commits_to_remove --force

```
Enter fullscreen mode

Exit fullscreen mode

Proceed with caution!

Once you force push this modification, there is **NO RETURN**!

[![No return from force push](https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2F8i7s73spe5bzb8h6fp23.jpeg)](https://media2.dev.to/dynamic/image/width%3D800%2Cheight%3D%2Cfit%3Dscale-down%2Cgravity%3Dauto%2Cformat%3Dauto/https%3A//dev-to-uploads.s3.amazonaws.com/uploads/articles/8i7s73spe5bzb8h6fp23.jpeg)

In my case:

```

git push origin secret_keys --force

```
Enter fullscreen mode

Exit fullscreen mode

Output:

```

Enumerating objects: 4, done.
Counting objects: 100% (4/4), done.
Delta compression using up to 8 threads
Compressing objects: 100% (2/2), done.
Writing objects: 100% (3/3), 293 bytes | 293.00 KiB/s, done.
Total 3 (delta 0), reused 0 (delta 0), pack-reused 0
To https://github.com/Balogh08/GitFilterBranch.git
 + 2ca4e16...e61bbd2 secret_keys -> secret_keys (forced update)

```
Enter fullscreen mode

Exit fullscreen mode

And abracadabra, the commits and the file which once contained the sensitive information are now removed.

[![Commits removed and pushed](https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Ftj6076pqehzjkx7s3n42.png)](https://media2.dev.to/dynamic/image/width%3D800%2Cheight%3D%2Cfit%3Dscale-down%2Cgravity%3Dauto%2Cformat%3Dauto/https%3A//dev-to-uploads.s3.amazonaws.com/uploads/articles/tj6076pqehzjkx7s3n42.png)

Next, we need to replace the file without the sensitive information. For this, we can use the backup branch to copy the content of `config.js` and create a new `config.js` in the branch without the sensitive commits. Then, paste the content from the backup branch. If you did not publish the backup branch, then you can easily delete it. However, if you published it, you must go through the same process with `git filter-branch` on the backup branch, but without creating a second backup for the backup. Simply deleting the branch from the remote repository is not safe enough, as the keys to the commits containing sensitive information would remain somewhere in the source control system.

What are your thoughts on this solution? What alternatives do you prefer, like `git filter-repo`? Let me know in the comments.

More about the author at [LUNitECH](//www.lunitech.hu)

The article was written with the help of existing documentation, ChatGPT, Grammarly, and other human beings.

## Top comments (0)

Subscribe

![pic](https://media2.dev.to/dynamic/image/width=256,height=,fit=scale-down,gravity=auto,format=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2F8j7kvp660rqzt99zui8e.png)

Personal
Trusted User

[Create template](/settings/response-templates)

Templates let you quickly answer FAQs or store snippets for re-use.

Submit
Preview
[Dismiss](/404.html)

[Code of Conduct](/code-of-conduct)
•
[Report abuse](/report-abuse)

Are you sure you want to hide this comment? It will become hidden in your post, but will still be visible via the comment's permalink.

Hide child comments as well

Confirm

For further actions, you may consider blocking this person and/or [reporting abuse](/report-abuse)

## Read next

[![resource_bunk_1077cab07da profile image](https://media2.dev.to/dynamic/image/width=100,height=100,fit=cover,gravity=auto,format=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Fuser%2Fprofile_image%2F2614356%2F92b7a5e7-7a57-46f4-a1ea-baa10434e6a1.png)
### New Income Stream with Notion Templates in 2025

Resource Bunk - Dec 27 '24](/resource_bunk_1077cab07da/new-income-stream-with-notion-templates-in-2025-5c57)
[![gauri1504 profile image](https://media2.dev.to/dynamic/image/width=100,height=100,fit=cover,gravity=auto,format=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Fuser%2Fprofile_image%2F1259691%2F31f86ea1-18c4-4ae8-adab-6eff9648baa0.jpg)
### Introduction to Amazon Bedrock: Building Generative AI Applications

Gauri Yadav - Jan 7](/gauri1504/introduction-to-amazon-bedrock-building-generative-ai-applications-g9k)
[![ebereplenty profile image](https://media2.dev.to/dynamic/image/width=100,height=100,fit=cover,gravity=auto,format=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Fuser%2Fprofile_image%2F313853%2Fbd1fb518-fbb7-46f7-9b42-84e74adc75b7.png)
### Building REST API Endpoints with Django REST Framework: A Step-by-Step Guide

NJOKU SAMSON EBERE - Dec 24 '24](/ebereplenty/building-rest-api-endpoints-with-django-rest-framework-a-step-by-step-guide-5g0e)
[![capcom6 profile image](https://media2.dev.to/dynamic/image/width=100,height=100,fit=cover,gravity=auto,format=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Fuser%2Fprofile_image%2F762977%2Ff0530be6-7977-42a9-9f17-1c15c032f944.png)
### tnfy.link - One more shortener?

capcom6 - Dec 24 '24](/capcom6/tnfylink-one-more-shortener-3ck7)

[![](https://media2.dev.to/dynamic/image/width=90,height=90,fit=cover,gravity=auto,format=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Fuser%2Fprofile_image%2F1104123%2F18231306-f6b2-4040-b5be-c87af0e3200f.jpeg)
Balogh Botond](/balogh08)

Follow

Web and mobile app developer.
In 2023, I transitioned from my previous role to pursue my passion in development, embracing full-time self-employment to further excel in web and mobile app development.

* Location

  Hungary
* Joined

  Jun 19, 2023

### More from [Balogh Botond](/balogh08)

[Facebook Authentication with Firebase in React Native (Android)
#reactnative
#firebase
#android
#tutorial](/balogh08/facebook-authentication-with-firebase-in-react-native-android-f1c)

Thank you to our Diamond Sponsor [Neon](https://neon.tech/) for supporting our community.

[DEV Community](/) — A constructive and inclusive social network for software developers. With you every step of your journey.

- [Home](/)
- [DEV++](/%2B%2B)
- [Podcasts](/pod)
- [Videos](/videos)
- [Tags](/tags)
- [DEV Help](/help)
- [Forem Shop](https://shop.forem.com/)
- [Advertise on DEV](/advertise)
- [DEV Challenges](/challenges)
- [DEV Showcase](/showcase)
- [About](/about)
- [Contact](/contact)
- [Free Postgres Database](/free-postgres-database-tier)
- [Guides](/guides)
- [Software comparisons](/software-comparisons)

- [Code of Conduct](/code-of-conduct)
- [Privacy Policy](/privacy)
- [Terms of use](/terms)

Built on [Forem](https://www.forem.com) — the [open source](https://dev.to/t/opensource) software that powers [DEV](https://dev.to) and other inclusive communities.

Made with love and [Ruby on Rails](https://dev.to/t/rails). DEV Community © 2016 - 2025.

![DEV Community](https://media2.dev.to/dynamic/image/width=190,height=,fit=scale-down,gravity=auto,format=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2F8j7kvp660rqzt99zui8e.png)

We're a place where coders share, stay up-to-date and grow their careers.

[Log in](/enter)
[Create account](/enter?state=new-user)

![](https://assets.dev.to/assets/sparkle-heart-5f9bee3767e18deb1bb725290cb151c25234768a0e9a2bd39370c382d02920cf.svg)
![](https://assets.dev.to/assets/multi-unicorn-b44d6f8c23cdd00964192bedc38af3e82463978aa611b4365bd33a0f1f4f3e97.svg)
![](https://assets.dev.to/assets/exploding-head-daceb38d627e6ae9b730f36a1e390fca556a4289d5a41abb2c35068ad3e2c4b5.svg)
![](https://assets.dev.to/assets/raised-hands-74b2099fd66a39f2d7eed9305ee0f4553df0eb7b4f11b01b6b1b499973048fe5.svg)
![](https://assets.dev.to/assets/fire-f60e7a582391810302117f987b22a8ef04a2fe0df7e3258a5f49332df1cec71e.svg)

