```
{
  "vulnerability": {
    "root_cause": "The descriptor list is a shared resource across all transmit queues, and the locking mechanism only protected concurrency within a given transmit queue. This allowed for multiple producers (transmit queues) to corrupt descriptors due to the SYSTEMPORT hardware re-arranging its internal descriptor list with a delay, when the driver writes to the WRITE_PORT_{HI,LO} registers.",
    "weaknesses": [
      "Insufficient locking mechanism",
      "Race condition"
    ],
    "impact": "Corrupted descriptors, leading to incorrect packet lengths, checksum calculation over incorrect packet length in UDP and TCP packets",
    "attack_vectors": "Multiple concurrent transmit queues",
    "required_capabilities": "Ability to use multiple transmit queues"
  },
  "fixes": [
    "Imposed a global serialization (using a spinlock) for all TX queues in the short section where the driver writes to the WRITE_PORT_{HI,LO} registers."
  ],
    "details": "The SYSTEMPORT hardware maintains an internal descriptor list that it re-arranges when the driver produces a new descriptor anytime it writes to the WRITE_PORT_{HI,LO} registers. There is some delay in the hardware to re-organize its descriptors, and concurrent TX queues can break this internal allocation scheme leading to incorrect data buffers being used for the length/status part of the descriptor."
}
```