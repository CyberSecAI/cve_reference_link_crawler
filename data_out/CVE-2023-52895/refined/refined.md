The provided content is related to a fix for a race condition in the Linux kernel's io_uring poll functionality, specifically concerning multishot poll requests. This fix is directly relevant to CVE-2023-52895, as it addresses a flaw in the handling of poll events that could lead to a buffer leak when reissuing a multishot armed poll request.

Here's a breakdown of the vulnerability and the fix:

**Root cause of vulnerability:**
- A race condition could occur when a poll event wakes up a request.
- For multishot requests, the kernel could spuriously re-issue the poll request, even though it's unnecessary.

**Weaknesses/vulnerabilities present:**
- Incorrect handling of multishot poll requests within the io_uring subsystem.
- Reissuing multishot requests directly, leading to potential buffer leaks.

**Impact of exploitation:**
- Memory leak of ring-provided buffers.
- Potential resource exhaustion and denial of service.

**Attack vectors:**
- Exploiting the race condition using io_uring with multishot poll requests.
- Triggering spurious wakeups and forcing unnecessary reissues.

**Required attacker capabilities/position:**
- Ability to create and execute io_uring requests.
- Understanding of the io_uring poll interface and its multishot capabilities.

**Technical Details**

The core of the vulnerability lies in the `io_poll_check_events` function within `io_uring/poll.c`.
Before the fix, the code would always attempt a reissue of the poll request if no result (`req->cqe.res`) was available, regardless of whether the request was a multishot one. This could result in reissuing multishot armed poll request and potential resource leaks.

The fix introduces a check to determine if the poll request is a multishot request by inspecting the `EPOLLONESHOT` flag (if the flag is not set, then it's a multishot request). If the request is a multishot request, the reissue is skipped to prevent the leak.

The fix prevents a potential resource leak by avoiding unnecessary reissues of multishot poll requests, thus resolving the race condition and the potential for buffer leaks.