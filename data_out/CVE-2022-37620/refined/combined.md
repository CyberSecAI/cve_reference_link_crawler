=== Content from github.com_0be02252_20250108_110320.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkangax%2Fhtml-minifier%2Fblob%2F51ce10f4daedb1de483ffbcccecc41be1c873da2%2Fsrc%2Fhtmlminifier.js)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkangax%2Fhtml-minifier%2Fblob%2F51ce10f4daedb1de483ffbcccecc41be1c873da2%2Fsrc%2Fhtmlminifier.js)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=kangax%2Fhtml-minifier)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[kangax](/kangax)
/
**[html-minifier](/kangax/html-minifier)**
Public

* [Notifications](/login?return_to=%2Fkangax%2Fhtml-minifier) You must be signed in to change notification settings
* [Fork
  576](/login?return_to=%2Fkangax%2Fhtml-minifier)
* [Star
   5k](/login?return_to=%2Fkangax%2Fhtml-minifier)

* [Code](/kangax/html-minifier)
* [Issues
  84](/kangax/html-minifier/issues)
* [Pull requests
  24](/kangax/html-minifier/pulls)
* [Actions](/kangax/html-minifier/actions)
* [Projects
  0](/kangax/html-minifier/projects)
* [Wiki](/kangax/html-minifier/wiki)
* [Security](/kangax/html-minifier/security)
* [Insights](/kangax/html-minifier/pulse)

Additional navigation options

* [Code](/kangax/html-minifier)
* [Issues](/kangax/html-minifier/issues)
* [Pull requests](/kangax/html-minifier/pulls)
* [Actions](/kangax/html-minifier/actions)
* [Projects](/kangax/html-minifier/projects)
* [Wiki](/kangax/html-minifier/wiki)
* [Security](/kangax/html-minifier/security)
* [Insights](/kangax/html-minifier/pulse)

## Files

 51ce10f
## Breadcrumbs

1. [html-minifier](/kangax/html-minifier/tree/51ce10f4daedb1de483ffbcccecc41be1c873da2)
2. /[src](/kangax/html-minifier/tree/51ce10f4daedb1de483ffbcccecc41be1c873da2/src)
/
# htmlminifier.js

 Blame  Blame
## Latest commit

## History

[History](/kangax/html-minifier/commits/51ce10f4daedb1de483ffbcccecc41be1c873da2/src/htmlminifier.js)1344 lines (1240 loc) · 44.8 KB 51ce10f
## Breadcrumbs

1. [html-minifier](/kangax/html-minifier/tree/51ce10f4daedb1de483ffbcccecc41be1c873da2)
2. /[src](/kangax/html-minifier/tree/51ce10f4daedb1de483ffbcccecc41be1c873da2/src)
/
# htmlminifier.js

Top
## File metadata and controls

* Code
* Blame

1344 lines (1240 loc) · 44.8 KB[Raw](https://github.com/kangax/html-minifier/raw/51ce10f4daedb1de483ffbcccecc41be1c873da2/src/htmlminifier.js)1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798991001011021031041051061071081091101111121131141151161171181191201211221231241251261271281291301311321331341351361371381391401411421431441451461471481491501511521531541551561571581591601611621631641651661671681691701711721731741751761771781791801811821831841851861871881891901911921931941951961971981992002012022032042052062072082092102112122132142152162172182192202212222232242252262272282292302312322332342352362372382392402412422432442452462472482492502512522532542552562572582592602612622632642652662672682692702712722732742752762772782792802812822832842852862872882892902912922932942952962972982993003013023033043053063073083093103113123133143153163173183193203213223233243253263273283293303313323333343353363373383393403413423433443453463473483493503513523533543553563573583593603613623633643653663673683693703713723733743753763773783793803813823833843853863873883893903913923933943953963973983994004014024034044054064074084094104114124134144154164174184194204214224234244254264274284294304314324334344354364374384394404414424434444454464474484494504514524534544554564574584594604614624634644654664674684694704714724734744754764774784794804814824834844854864874884894904914924934944954964974984995005015025035045055065075085095105115125135145155165175185195205215225235245255265275285295305315325335345355365375385395405415425435445455465475485495505515525535545555565575585595605615625635645655665675685695705715725735745755765775785795805815825835845855865875885895905915925935945955965975985996006016026036046056066076086096106116126136146156166176186196206216226236246256266276286296306316326336346356366376386396406416426436446456466476486496506516526536546556566576586596606616626636646656666676686696706716726736746756766776786796806816826836846856866876886896906916926936946956966976986997007017027037047057067077087097107117127137147157167177187197207217227237247257267277287297307317327337347357367377387397407417427437447457467477487497507517527537547557567577587597607617627637647657667677687697707717727737747757767777787797807817827837847857867877887897907917927937947957967977987998008018028038048058068078088098108118128138148158168178188198208218228238248258268278288298308318328338348358368378388398408418428438448458468478488498508518528538548558568578588598608618628638648658668678688698708718728738748758768778788798808818828838848858868878888898908918928938948958968978988999009019029039049059069079089099109119129139149159169179189199209219229239249259269279289299309319329339349359369379389399409419429439449459469479489499509519529539549559569579589599609619629639649659669679689699709719729739749759769779789799809819829839849859869879889899909919929939949959969979989991000'use strict';
var CleanCSS = require('clean-css');var decode = require('he').decode;var HTMLParser = require('./htmlparser').HTMLParser;var RelateUrl = require('relateurl');var TokenChain = require('./tokenchain');var UglifyJS = require('uglify-js');var utils = require('./utils');
function trimWhitespace(str) { return str && str.replace(/^[ \n\r\t\f]+/, '').replace(/[ \n\r\t\f]+$/, '');}
function collapseWhitespaceAll(str) { // Non-breaking space is specifically handled inside the replacer function here: return str && str.replace(/[ \n\r\t\f\xA0]+/g, function(spaces) { return spaces === '\t' ? '\t' : spaces.replace(/(^|\xA0+)[^\xA0]+/g, '$1 '); });}
function collapseWhitespace(str, options, trimLeft, trimRight, collapseAll) { var lineBreakBefore = '', lineBreakAfter = '';
 if (options.preserveLineBreaks) { str = str.replace(/^[ \n\r\t\f]\*?[\n\r][ \n\r\t\f]\*/, function() { lineBreakBefore = '\n'; return ''; }).replace(/[ \n\r\t\f]\*?[\n\r][ \n\r\t\f]\*$/, function() { lineBreakAfter = '\n'; return ''; }); }
 if (trimLeft) { // Non-breaking space is specifically handled inside the replacer function here: str = str.replace(/^[ \n\r\t\f\xA0]+/, function(spaces) { var conservative = !lineBreakBefore && options.conservativeCollapse; if (conservative && spaces === '\t') { return '\t'; } return spaces.replace(/^[^\xA0]+/, '').replace(/(\xA0+)[^\xA0]+/g, '$1 ') || (conservative ? ' ' : ''); }); }
 if (trimRight) { // Non-breaking space is specifically handled inside the replacer function here: str = str.replace(/[ \n\r\t\f\xA0]+$/, function(spaces) { var conservative = !lineBreakAfter && options.conservativeCollapse; if (conservative && spaces === '\t') { return '\t'; } return spaces.replace(/[^\xA0]+(\xA0+)/g, ' $1').replace(/[^\xA0]+$/, '') || (conservative ? ' ' : ''); }); }
 if (collapseAll) { // strip non space whitespace then compress spaces to one str = collapseWhitespaceAll(str); }
 return lineBreakBefore + str + lineBreakAfter;}
var createMapFromString = utils.createMapFromString;// non-empty tags that will maintain whitespace around themvar inlineTags = createMapFromString('a,abbr,acronym,b,bdi,bdo,big,button,cite,code,del,dfn,em,font,i,ins,kbd,label,mark,math,nobr,object,q,rp,rt,rtc,ruby,s,samp,select,small,span,strike,strong,sub,sup,svg,textarea,time,tt,u,var');// non-empty tags that will maintain whitespace within themvar inlineTextTags = createMapFromString('a,abbr,acronym,b,big,del,em,font,i,ins,kbd,mark,nobr,rp,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var');// self-closing tags that will maintain whitespace around themvar selfClosingInlineTags = createMapFromString('comment,img,input,wbr');
function collapseWhitespaceSmart(str, prevTag, nextTag, options) { var trimLeft = prevTag && !selfClosingInlineTags(prevTag); if (trimLeft && !options.collapseInlineTagWhitespace) { trimLeft = prevTag.charAt(0) === '/' ? !inlineTags(prevTag.slice(1)) : !inlineTextTags(prevTag); } var trimRight = nextTag && !selfClosingInlineTags(nextTag); if (trimRight && !options.collapseInlineTagWhitespace) { trimRight = nextTag.charAt(0) === '/' ? !inlineTextTags(nextTag.slice(1)) : !inlineTags(nextTag); } return collapseWhitespace(str, options, trimLeft, trimRight, prevTag && nextTag);}
function isConditionalComment(text) { return /^\[if\s[^\]]+]|\[endif]$/.test(text);}
function isIgnoredComment(text, options) { for (var i = 0, len = options.ignoreCustomComments.length; i < len; i++) { if (options.ignoreCustomComments[i].test(text)) { return true; } } return false;}
function isEventAttribute(attrName, options) { var patterns = options.customEventAttributes; if (patterns) { for (var i = patterns.length; i--;) { if (patterns[i].test(attrName)) { return true; } } return false; } return /^on[a-z]{3,}$/.test(attrName);}
function canRemoveAttributeQuotes(value) { // https://mathiasbynens.be/notes/unquoted-attribute-values return /^[^ \t\n\f\r"'`=<>]+$/.test(value);}
function attributesInclude(attributes, attribute) { for (var i = attributes.length; i--;) { if (attributes[i].name.toLowerCase() === attribute) { return true; } } return false;}
function isAttributeRedundant(tag, attrName, attrValue, attrs) { attrValue = attrValue ? trimWhitespace(attrValue.toLowerCase()) : '';
 return ( tag === 'script' && attrName === 'language' && attrValue === 'javascript' ||
 tag === 'form' && attrName === 'method' && attrValue === 'get' ||
 tag === 'input' && attrName === 'type' && attrValue === 'text' ||
 tag === 'script' && attrName === 'charset' && !attributesInclude(attrs, 'src') ||
 tag === 'a' && attrName === 'name' && attributesInclude(attrs, 'id') ||
 tag === 'area' && attrName === 'shape' && attrValue === 'rect' );}
// https://mathiasbynens.be/demo/javascript-mime-type// https://developer.mozilla.org/en/docs/Web/HTML/Element/script#attr-typevar executableScriptsMimetypes = utils.createMap([ 'text/javascript', 'text/ecmascript', 'text/jscript', 'application/javascript', 'application/x-javascript', 'application/ecmascript']);
function isScriptTypeAttribute(attrValue) { attrValue = trimWhitespace(attrValue.split(/;/, 2)[0]).toLowerCase(); return attrValue === '' || executableScriptsMimetypes(attrValue);}
function isExecutableScript(tag, attrs) { if (tag !== 'script') { return false; } for (var i = 0, len = attrs.length; i < len; i++) { var attrName = attrs[i].name.toLowerCase(); if (attrName === 'type') { return isScriptTypeAttribute(attrs[i].value); } } return true;}
function isStyleLinkTypeAttribute(attrValue) { attrValue = trimWhitespace(attrValue).toLowerCase(); return attrValue === '' || attrValue === 'text/css';}
function isStyleSheet(tag, attrs) { if (tag !== 'style') { return false; } for (var i = 0, len = attrs.length; i < len; i++) { var attrName = attrs[i].name.toLowerCase(); if (attrName === 'type') { return isStyleLinkTypeAttribute(attrs[i].value); } } return true;}
var isSimpleBoolean = createMapFromString('allowfullscreen,async,autofocus,autoplay,checked,compact,controls,declare,default,defaultchecked,defaultmuted,defaultselected,defer,disabled,enabled,formnovalidate,hidden,indeterminate,inert,ismap,itemscope,loop,multiple,muted,nohref,noresize,noshade,novalidate,nowrap,open,pauseonexit,readonly,required,reversed,scoped,seamless,selected,sortable,truespeed,typemustmatch,visible');var isBooleanValue = createMapFromString('true,false');
function isBooleanAttribute(attrName, attrValue) { return isSimpleBoolean(attrName) || attrName === 'draggable' && !isBooleanValue(attrValue);}
function isUriTypeAttribute(attrName, tag) { return ( /^(?:a|area|link|base)$/.test(tag) && attrName === 'href' || tag === 'img' && /^(?:src|longdesc|usemap)$/.test(attrName) || tag === 'object' && /^(?:classid|codebase|data|usemap)$/.test(attrName) || tag === 'q' && attrName === 'cite' || tag === 'blockquote' && attrName === 'cite' || (tag === 'ins' || tag === 'del') && attrName === 'cite' || tag === 'form' && attrName === 'action' || tag === 'input' && (attrName === 'src' || attrName === 'usemap') || tag === 'head' && attrName === 'profile' || tag === 'script' && (attrName === 'src' || attrName === 'for') );}
function isNumberTypeAttribute(attrName, tag) { return ( /^(?:a|area|object|button)$/.test(tag) && attrName === 'tabindex' || tag === 'input' && (attrName === 'maxlength' || attrName === 'tabindex') || tag === 'select' && (attrName === 'size' || attrName === 'tabindex') || tag === 'textarea' && /^(?:rows|cols|tabindex)$/.test(attrName) || tag === 'colgroup' && attrName === 'span' || tag === 'col' && attrName === 'span' || (tag === 'th' || tag === 'td') && (attrName === 'rowspan' || attrName === 'colspan') );}
function isLinkType(tag, attrs, value) { if (tag !== 'link') { return false; } for (var i = 0, len = attrs.length; i < len; i++) { if (attrs[i].name === 'rel' && attrs[i].value === value) { return true; } }}
function isMediaQuery(tag, attrs, attrName) { return attrName === 'media' && (isLinkType(tag, attrs, 'stylesheet') || isStyleSheet(tag, attrs));}
var srcsetTags = createMapFromString('img,source');
function isSrcset(attrName, tag) { return attrName === 'srcset' && srcsetTags(tag);}
function cleanAttributeValue(tag, attrName, attrValue, options, attrs) { if (isEventAttribute(attrName, options)) { attrValue = trimWhitespace(attrValue).replace(/^javascript:\s\*/i, ''); return options.minifyJS(attrValue, true); } else if (attrName === 'class') { attrValue = trimWhitespace(attrValue); if (options.sortClassName) { attrValue = options.sortClassName(attrValue); } else { attrValue = collapseWhitespaceAll(attrValue); } return attrValue; } else if (isUriTypeAttribute(attrName, tag)) { attrValue = trimWhitespace(attrValue); return isLinkType(tag, attrs, 'canonical') ? attrValue : options.minifyURLs(attrValue); } else if (isNumberTypeAttribute(attrName, tag)) { return trimWhitespace(attrValue); } else if (attrName === 'style') { attrValue = trimWhitespace(attrValue); if (attrValue) { if (/;$/.test(attrValue) && !/&#?[0-9a-zA-Z]+;$/.test(attrValue)) { attrValue = attrValue.replace(/\s\*;$/, ';'); } attrValue = options.minifyCSS(attrValue, 'inline'); } return attrValue; } else if (isSrcset(attrName, tag)) { // https://html.spec.whatwg.org/multipage/embedded-content.html#attr-img-srcset attrValue = trimWhitespace(attrValue).split(/\s+,\s\*|\s\*,\s+/).map(function(candidate) { var url = candidate; var descriptor = ''; var match = candidate.match(/\s+([1-9][0-9]\*w|[0-9]+(?:\.[0-9]+)?x)$/); if (match) { url = url.slice(0, -match[0].length); var num = +match[1].slice(0, -1); var suffix = match[1].slice(-1); if (num !== 1 || suffix !== 'x') { descriptor = ' ' + num + suffix; } } return options.minifyURLs(url) + descriptor; }).join(', '); } else if (isMetaViewport(tag, attrs) && attrName === 'content') { attrValue = attrValue.replace(/\s+/g, '').replace(/[0-9]+\.[0-9]+/g, function(numString) { // "0.90000" -> "0.9" // "1.0" -> "1" // "1.0001" -> "1.0001" (unchanged) return (+numString).toString(); }); } else if (isContentSecurityPolicy(tag, attrs) && attrName.toLowerCase() === 'content') { return collapseWhitespaceAll(attrValue); } else if (options.customAttrCollapse && options.customAttrCollapse.test(attrName)) { attrValue = attrValue.replace(/\n+|\r+|\s{2,}/g, ''); } else if (tag === 'script' && attrName === 'type') { attrValue = trimWhitespace(attrValue.replace(/\s\*;\s\*/g, ';')); } else if (isMediaQuery(tag, attrs, attrName)) { attrValue = trimWhitespace(attrValue); return options.minifyCSS(attrValue, 'media'); } return attrValue;}
function isMetaViewport(tag, attrs) { if (tag !== 'meta') { return false; } for (var i = 0, len = attrs.length; i < len; i++) { if (attrs[i].name === 'name' && attrs[i].value === 'viewport') { return true; } }}
function isContentSecurityPolicy(tag, attrs) { if (tag !== 'meta') { return false; } for (var i = 0, len = attrs.length; i < len; i++) { if (attrs[i].name.toLowerCase() === 'http-equiv' && attrs[i].value.toLowerCase() === 'content-security-policy') { return true; } }}
function ignoreCSS(id) { return '/\* clean-css ignore:start \*/' + id + '/\* clean-css ignore:end \*/';}
// Wrap CSS declarations for CleanCSS > 3.x// See https://github.com/jakubpawlowicz/clean-css/issues/418function wrapCSS(text, type) { switch (type) { case 'inline': return '\*{' + text + '}'; case 'media': return '@media ' + text + '{a{top:0}}'; default: return text; }}
function unwrapCSS(text, type) { var matches; switch (type) { case 'inline': matches = text.match(/^\\*\{([\s\S]\*)\}$/); break; case 'media': matches = text.match(/^@media ([\s\S]\*?)\s\*{[\s\S]\*}$/); break; } return matches ? matches[1] : text;}
function cleanConditionalComment(comment, options) { return options.processConditionalComments ? comment.replace(/^(\[if\s[^\]]+]>)([\s\S]\*?)(<!\[endif])$/, function(match, prefix, text, suffix) { return prefix + minify(text, options, true) + suffix; }) : comment;}
function processScript(text, options, currentAttrs) { for (var i = 0, len = currentAttrs.length; i < len; i++) { if (currentAttrs[i].name.toLowerCase() === 'type' && options.processScripts.indexOf(currentAttrs[i].value) > -1) { return minify(text, options); } } return text;}
// Tag omission rules from https://html.spec.whatwg.org/multipage/syntax.html#optional-tags// with the following deviations:// - retain <body> if followed by <noscript>// - </rb>, </rt>, </rtc>, </rp> & </tfoot> follow https://www.w3.org/TR/html5/syntax.html#optional-tags// - retain all tags which are adjacent to non-standard HTML tagsvar optionalStartTags = createMapFromString('html,head,body,colgroup,tbody');var optionalEndTags = createMapFromString('html,head,body,li,dt,dd,p,rb,rt,rtc,rp,optgroup,option,colgroup,caption,thead,tbody,tfoot,tr,td,th');var headerTags = createMapFromString('meta,link,script,style,template,noscript');var descriptionTags = createMapFromString('dt,dd');var pBlockTags = createMapFromString('address,article,aside,blockquote,details,div,dl,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,header,hgroup,hr,main,menu,nav,ol,p,pre,section,table,ul');var pInlineTags = createMapFromString('a,audio,del,ins,map,noscript,video');var rubyTags = createMapFromString('rb,rt,rtc,rp');var rtcTag = createMapFromString('rb,rtc,rp');var optionTag = createMapFromString('option,optgroup');var tableContentTags = createMapFromString('tbody,tfoot');var tableSectionTags = createMapFromString('thead,tbody,tfoot');var cellTags = createMapFromString('td,th');var topLevelTags = createMapFromString('html,head,body');var compactTags = createMapFromString('html,body');var looseTags = createMapFromString('head,colgroup,caption');var trailingTags = createMapFromString('dt,thead');var htmlTags = createMapFromString('a,abbr,acronym,address,applet,area,article,aside,audio,b,base,basefont,bdi,bdo,bgsound,big,blink,blockquote,body,br,button,canvas,caption,center,cite,code,col,colgroup,command,content,data,datalist,dd,del,details,dfn,dialog,dir,div,dl,dt,element,em,embed,fieldset,figcaption,figure,font,footer,form,frame,frameset,h1,h2,h3,h4,h5,h6,head,header,hgroup,hr,html,i,iframe,image,img,input,ins,isindex,kbd,keygen,label,legend,li,link,listing,main,map,mark,marquee,menu,menuitem,meta,meter,multicol,nav,nobr,noembed,noframes,noscript,object,ol,optgroup,option,output,p,param,picture,plaintext,pre,progress,q,rb,rp,rt,rtc,ruby,s,samp,script,section,select,shadow,small,source,spacer,span,strike,strong,style,sub,summary,sup,table,tbody,td,template,textarea,tfoot,th,thead,time,title,tr,track,tt,u,ul,var,video,wbr,xmp');
function canRemoveParentTag(optionalStartTag, tag) { switch (optionalStartTag) { case 'html': case 'head': return true; case 'body': return !headerTags(tag); case 'colgroup': return tag === 'col'; case 'tbody': return tag === 'tr'; } return false;}
function isStartTagMandatory(optionalEndTag, tag) { switch (tag) { case 'colgroup': return optionalEndTag === 'colgroup'; case 'tbody': return tableSectionTags(optionalEndTag); } return false;}
function canRemovePrecedingTag(optionalEndTag, tag) { switch (optionalEndTag) { case 'html': case 'head': case 'body': case 'colgroup': case 'caption': return true; case 'li': case 'optgroup': case 'tr': return tag === optionalEndTag; case 'dt': case 'dd': return descriptionTags(tag); case 'p': return pBlockTags(tag); case 'rb': case 'rt': case 'rp': return rubyTags(tag); case 'rtc': return rtcTag(tag); case 'option': return optionTag(tag); case 'thead': case 'tbody': return tableContentTags(tag); case 'tfoot': return tag === 'tbody'; case 'td': case 'th': return cellTags(tag); } return false;}
var reEmptyAttribute = new RegExp( '^(?:class|id|style|title|lang|dir|on(?:focus|blur|change|click|dblclick|mouse(' + '?:down|up|over|move|out)|key(?:press|down|up)))$');
function canDeleteEmptyAttribute(tag, attrName, attrValue, options) { var isValueEmpty = !attrValue || /^\s\*$/.test(attrValue); if (!isValueEmpty) { return false; } if (typeof options.removeEmptyAttributes === 'function') { return options.removeEmptyAttributes(attrName, tag); } return tag === 'input' && attrName === 'value' || reEmptyAttribute.test(attrName);}
function hasAttrName(name, attrs) { for (var i = attrs.length - 1; i >= 0; i--) { if (attrs[i].name === name) { return true; } } return false;}
function canRemoveElement(tag, attrs) { switch (tag) { case 'textarea': return false; case 'audio': case 'script': case 'video': if (hasAttrName('src', attrs)) { return false; } break; case 'iframe': if (hasAttrName('src', attrs) || hasAttrName('srcdoc', attrs)) { return false; } break; case 'object': if (hasAttrName('data', attrs)) { return false; } break; case 'applet': if (hasAttrName('code', attrs)) { return false; } break; } return true;}
function canCollapseWhitespace(tag) { return !/^(?:script|style|pre|textarea)$/.test(tag);}
function canTrimWhitespace(tag) { return !/^(?:pre|textarea)$/.test(tag);}
function normalizeAttr(attr, attrs, tag, options) { var attrName = options.name(attr.name), attrValue = attr.value;
 if (options.decodeEntities && attrValue) { attrValue = decode(attrValue, { isAttributeValue: true }); }
 if (options.removeRedundantAttributes && isAttributeRedundant(tag, attrName, attrValue, attrs) || options.removeScriptTypeAttributes && tag === 'script' && attrName === 'type' && isScriptTypeAttribute(attrValue) || options.removeStyleLinkTypeAttributes && (tag === 'style' || tag === 'link') && attrName === 'type' && isStyleLinkTypeAttribute(attrValue)) { return; }
 if (attrValue) { attrValue = cleanAttributeValue(tag, attrName, attrValue, options, attrs); }
 if (options.removeEmptyAttributes && canDeleteEmptyAttribute(tag, attrName, attrValue, options)) { return; }
 if (options.decodeEntities && attrValue) { attrValue = attrValue.replace(/&(#?[0-9a-zA-Z]+;)/g, '&amp;$1'); }
 return { attr: attr, name: attrName, value: attrValue };}
function buildAttr(normalized, hasUnarySlash, options, isLast, uidAttr) { var attrName = normalized.name, attrValue = normalized.value, attr = normalized.attr, attrQuote = attr.quote, attrFragment, emittedAttrValue;
 if (typeof attrValue !== 'undefined' && (!options.removeAttributeQuotes || ~attrValue.indexOf(uidAttr) || !canRemoveAttributeQuotes(attrValue))) { if (!options.preventAttributesEscaping) { if (typeof options.quoteCharacter === 'undefined') { var apos = (attrValue.match(/'/g) || []).length; var quot = (attrValue.match(/"/g) || []).length; attrQuote = apos < quot ? '\'' : '"'; } else { attrQuote = options.quoteCharacter === '\'' ? '\'' : '"'; } if (attrQuote === '"') { attrValue = attrValue.replace(/"/g, '&#34;'); } else { attrValue = attrValue.replace(/'/g, '&#39;'); } } emittedAttrValue = attrQuote + attrValue + attrQuote; if (!isLast && !options.removeTagWhitespace) { emittedAttrValue += ' '; } } // make sure trailing slash is not interpreted as HTML self-closing tag else if (isLast && !hasUnarySlash && !/\/$/.test(attrValue)) { emittedAttrValue = attrValue; } else { emittedAttrValue = attrValue + ' '; }
 if (typeof attrValue === 'undefined' || options.collapseBooleanAttributes && isBooleanAttribute(attrName.toLowerCase(), attrValue.toLowerCase())) { attrFragment = attrName; if (!isLast) { attrFragment += ' '; } } else { attrFragment = attrName + attr.customAssign + emittedAttrValue; }
 return attr.customOpen + attrFragment + attr.customClose;}
function identity(value) { return value;}
function processOptions(values) { var options = { name: function(name) { return name.toLowerCase(); }, canCollapseWhitespace: canCollapseWhitespace, canTrimWhitespace: canTrimWhitespace, html5: true, ignoreCustomComments: [/^!/], ignoreCustomFragments: [ /<%[\s\S]\*?%>/, /<\?[\s\S]\*?\?>/ ], includeAutoGeneratedTags: true, log: identity, minifyCSS: identity, minifyJS: identity, minifyURLs: identity }; Object.keys(values).forEach(function(key) { var value = values[key]; if (key === 'caseSensitive') { if (value) { options.name = identity; } } else if (key === 'log') { if (typeof value === 'function') { options.log = value; } } else if (key === 'minifyCSS' && typeof value !== 'function') { if (!value) { return; } if (typeof value !== 'object') { value = {}; } options.minifyCSS = function(text, type) { text = text.replace(/(url\s\*\(\s\*)("|'|)(.\*?)\2(\s\*\))/ig, function(match, prefix, quote, url, suffix) { return prefix + quote + options.minifyURLs(url) + quote + suffix; }); var cleanCssOutput = new CleanCSS(value).minify(wrapCSS(text, type)); if (cleanCssOutput.errors.length > 0) { cleanCssOutput.errors.forEach(options.log); return text; } return unwrapCSS(cleanCssOutput.styles, type); }; } else if (key === 'minifyJS' && typeof value !== 'function') { if (!value) { return; } if (typeof value !== 'object') { value = {}; } (value.parse || (value.parse = {})).bare\_returns = false; options.minifyJS = function(text, inline) { var start = text.match(/^\s\*<!--.\*/); var code = start ? text.slice(start[0].length).replace(/\n\s\*-->\s\*$/, '') : text; value.parse.bare\_returns = inline; var result = UglifyJS.minify(code, value); if (result.error) { options.log(result.error); return text; } return result.code.replace(/;$/, ''); }; } else if (key === 'minifyURLs' && typeof value !== 'function') { if (!value) { return; } if (typeof value === 'string') { value = { site: value }; } else if (typeof value !== 'object') { value = {}; } options.minifyURLs = function(text) { try { return RelateUrl.relate(text, value); } catch (err) { options.log(err); return text; } }; } else { options[key] = value; } }); return options;}
function uniqueId(value) { var id; do { id = Math.random().toString(36).replace(/^0\.[0-9]\*/, ''); } while (~value.indexOf(id)); return id;}
var specialContentTags = createMapFromString('script,style');
function createSortFns(value, options, uidIgnore, uidAttr) { var attrChains = options.sortAttributes && Object.create(null); var classChain = options.sortClassName && new TokenChain();
 function attrNames(attrs) { return attrs.map(function(attr) { return options.name(attr.name); }); }
 function shouldSkipUID(token, uid) { return !uid || token.indexOf(uid) === -1; }
 function shouldSkipUIDs(token) { return shouldSkipUID(token, uidIgnore) && shouldSkipUID(token, uidAttr); }
 function scan(input) { var currentTag, currentType; new HTMLParser(input, { start: function(tag, attrs) { if (attrChains) { if (!attrChains[tag]) { attrChains[tag] = new TokenChain(); } attrChains[tag].add(attrNames(attrs).filter(shouldSkipUIDs)); } for (var i = 0, len = attrs.length; i < len; i++) { var attr = attrs[i]; if (classChain && attr.value && options.name(attr.name) === 'class') { classChain.add(trimWhitespace(attr.value).split(/[ \t\n\f\r]+/).filter(shouldSkipUIDs)); } else if (options.processScripts && attr.name.toLowerCase() === 'type') { currentTag = tag; currentType = attr.value; } } }, end: function() { currentTag = ''; }, chars: function(text) { if (options.processScripts && specialContentTags(currentTag) && options.processScripts.indexOf(currentType) > -1) { scan(text); } } }); }
 var log = options.log; options.log = identity; options.sortAttributes = false; options.sortClassName = false; scan(minify(value, options)); options.log = log; if (attrChains) { var attrSorters = Object.create(null); for (var tag in attrChains) { attrSorters[tag] = attrChains[tag].createSorter(); } options.sortAttributes = function(tag, attrs) { var sorter = attrSorters[tag]; if (sorter) { var attrMap = Object.create(null); var names = attrNames(attrs); names.forEach(function(name, index) { (attrMap[name] || (attrMap[name] = [])).push(attrs[index]); }); sorter.sort(names).forEach(function(name, index) { attrs[index] = attrMap[name].shift(); }); } }; } if (classChain) { var sorter = classChain.createSorter(); options.sortClassName = function(value) { return sorter.sort(value.split(/[ \n\f\r]+/)).join(' '); }; }}
function minify(value, options, partialMarkup) { if (options.collapseWhitespace) { value = collapseWhitespace(value, options, true, true); }
 var buffer = [], charsPrevTag, currentChars = '', hasChars, currentTag = '', currentAttrs = [], stackNoTrimWhitespace = [], stackNoCollapseWhitespace = [], optionalStartTag = '', optionalEndTag = '', ignoredMarkupChunks = [], ignoredCustomMarkupChunks = [], uidIgnore, uidAttr, uidPattern;
 // temporarily replace ignored chunks with comments, // so that we don't have to worry what's there. // for all we care there might be // completely-horribly-broken-alien-non-html-emoj-cthulhu-filled content value = value.replace(/<!-- htmlmin:ignore -->([\s\S]\*?)<!-- htmlmin:ignore -->/g, function(match, group1) { if (!uidIgnore) { uidIgnore = uniqueId(value); var pattern = new RegExp('^' + uidIgnore + '([0-9]+)$'); if (options.ignoreCustomComments) { options.ignoreCustomComments = options.ignoreCustomComments.slice(); } else { options.ignoreCustomComments = []; } options.ignoreCustomComments.push(pattern); } var token = '<!--' + uidIgnore + ignoredMarkupChunks.length + '-->'; ignoredMarkupChunks.push(group1); return token; });
 var customFragments = options.ignoreCustomFragments.map(function(re) { return re.source; }); if (customFragments.length) { var reCustomIgnore = new RegExp('\\s\*(?:' + customFragments.join('|') + ')+\\s\*', 'g'); // temporarily replace custom ignored fragments with unique attributes value = value.replace(reCustomIgnore, function(match) { if (!uidAttr) { uidAttr = uniqueId(value); uidPattern = new RegExp('(\\s\*)' + uidAttr + '([0-9]+)' + uidAttr + '(\\s\*)', 'g'); if (options.minifyCSS) { options.minifyCSS = (function(fn) { return function(text, type) { text = text.replace(uidPattern, function(match, prefix, index) { var chunks = ignoredCustomMarkupChunks[+index]; return chunks[1] + uidAttr + index + uidAttr + chunks[2]; }); var ids = []; new CleanCSS().minify(wrapCSS(text, type)).warnings.forEach(function(warning) { var match = uidPattern.exec(warning); if (match) { var id = uidAttr + match[2] + uidAttr; text = text.replace(id, ignoreCSS(id)); ids.push(id); } }); text = fn(text, type); ids.forEach(function(id) { text = text.replace(ignoreCSS(id), id); }); return text; }; })(options.minifyCSS); } if (options.minifyJS) { options.minifyJS = (function(fn) { return function(text, type) { return fn(text.replace(uidPattern, function(match, prefix, index) { var chunks = ignoredCustomMarkupChunks[+index]; return chunks[1] + uidAttr + index + uidAttr + chunks[2]; }), type); }; })(options.minifyJS); } } var token = uidAttr + ignoredCustomMarkupChunks.length + uidAttr; ignoredCustomMarkupChunks.push(/^(\s\*)[\s\S]\*?(\s\*)$/.exec(match)); return '\t' + token + '\t'; }); }
 if (options.sortAttributes && typeof options.sortAttributes !== 'function' || options.sortClassName && typeof options.sortClassName !== 'function') { createSortFns(value, options, uidIgnore, uidAttr); }
 function \_canCollapseWhitespace(tag, attrs) { return options.canCollapseWhitespace(tag, attrs, canCollapseWhitespace); }
 function \_canTrimWhitespace(tag, attrs) { return options.canTrimWhitespace(tag, attrs, canTrimWhitespace); }
 function removeStartTag() { var index = buffer.length - 1; while (index > 0 && !/^<[^/!]/.test(buffer[index])) { index--; } buffer.length = Math.max(0, index); }
 function removeEndTag() { var index = buffer.length - 1; while (index > 0 && !/^<\//.test(buffer[index])) { index--; } buffer.length = Math.max(0, index); }
 // look for trailing whitespaces, bypass any inline tags function trimTrailingWhitespace(index, nextTag) { for (var endTag = null; index >= 0 && \_canTrimWhitespace(endTag); index--) { var str = buffer[index]; var match = str.match(/^<\/([\w:-]+)>$/); if (match) { endTag = match[1]; } else if (/>$/.test(str) || (buffer[index] = collapseWhitespaceSmart(str, null, nextTag, options))) { break; } } }
 // look for trailing whitespaces from previously processed text // which may not be trimmed due to a following comment or an empty // element which has now been removed function squashTrailingWhitespace(nextTag) { var charsIndex = buffer.length - 1; if (buffer.length > 1) { var item = buffer[buffer.length - 1]; if (/^(?:<!|$)/.test(item) && item.indexOf(uidIgnore) === -1) { charsIndex--; } } trimTrailingWhitespace(charsIndex, nextTag); }
 new HTMLParser(value, { partialMarkup: partialMarkup, continueOnParseError: options.continueOnParseError, customAttrAssign: options.customAttrAssign, customAttrSurround: options.customAttrSurround, html5: options.html5,
 start: function(tag, attrs, unary, unarySlash, autoGenerated) { if (tag.toLowerCase() === 'svg') { options = Object.create(options); options.caseSensitive = true; options.keepClosingSlash = true; options.name = identity; } tag = options.name(tag); currentTag = tag; charsPrevTag = tag; if (!inlineTextTags(tag)) { currentChars = ''; } hasChars = false;[View remainder of file in raw view](https://github.com/kangax/html-minifier/raw/51ce10f4daedb1de483ffbcccecc41be1c873da2/src/htmlminifier.js)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_2eab5f5c_20250108_110324.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkangax%2Fhtml-minifier%2Fissues%2F1135)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkangax%2Fhtml-minifier%2Fissues%2F1135)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=kangax%2Fhtml-minifier)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[kangax](/kangax)
/
**[html-minifier](/kangax/html-minifier)**
Public

* [Notifications](/login?return_to=%2Fkangax%2Fhtml-minifier) You must be signed in to change notification settings
* [Fork
  576](/login?return_to=%2Fkangax%2Fhtml-minifier)
* [Star
   5k](/login?return_to=%2Fkangax%2Fhtml-minifier)

* [Code](/kangax/html-minifier)
* [Issues
  84](/kangax/html-minifier/issues)
* [Pull requests
  24](/kangax/html-minifier/pulls)
* [Actions](/kangax/html-minifier/actions)
* [Projects
  0](/kangax/html-minifier/projects)
* [Wiki](/kangax/html-minifier/wiki)
* [Security](/kangax/html-minifier/security)
* [Insights](/kangax/html-minifier/pulse)

Additional navigation options

* [Code](/kangax/html-minifier)
* [Issues](/kangax/html-minifier/issues)
* [Pull requests](/kangax/html-minifier/pulls)
* [Actions](/kangax/html-minifier/actions)
* [Projects](/kangax/html-minifier/projects)
* [Wiki](/kangax/html-minifier/wiki)
* [Security](/kangax/html-minifier/security)
* [Insights](/kangax/html-minifier/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fkangax%2Fhtml-minifier%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fkangax%2Fhtml-minifier%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# CVE-2022-37620/ ReDoS found in htmlminifier.js #1135

Open

[secdevlpr26](/secdevlpr26) opened this issue
Oct 27, 2022
· 17 comments

Open

# [CVE-2022-37620/ ReDoS found in htmlminifier.js](#top) #1135

[secdevlpr26](/secdevlpr26) opened this issue
Oct 27, 2022
· 17 comments

## Comments

[![@secdevlpr26](https://avatars.githubusercontent.com/u/31366114?s=80&v=4)](/secdevlpr26)

Copy link

### **[secdevlpr26](/secdevlpr26)** commented [Oct 27, 2022](#issue-1426086378)

| A Regular Expression Denial of Service (ReDoS) flaw was found in kangax html-minifier 4.0.0 via the candidate variable in htmlminifier.js. The ReDoS vulnerability can be mitigated with several best practices described here: [https://snyk.io/blog/redos-and-catastrophic-backtracking/] |
| --- |
| The text was updated successfully, but these errors were encountered: |

 👍
23
 Harm-Nullix, verydevuser, pmilliotte, willieowens, michaeljauk, RubenStoesser, F21, kscharm, tuliogoiania, runderworld, and 13 more reacted with thumbs up emoji
 👀
6
 tuliogoiania, derTobsch, LenoM, jgmontoya, gnuletik, and naweka reacted with eyes emoji

All reactions

* 👍
  23 reactions
* 👀
  6 reactions

[![@michaeljauk](https://avatars.githubusercontent.com/u/18634867?s=80&u=df3f79b67fb944942562114d30542118e10d5626&v=4)](/michaeljauk)

Copy link

### **[michaeljauk](/michaeljauk)** commented [Nov 18, 2022](#issuecomment-1320472797)

| Is anyone willing to work on this? |
| --- |

 👍
7
 mashpie, ArielPrevu3D, qeleb, geiszla, LenoM, RMITBLOG, and aangindra reacted with thumbs up emoji
 👎
3
 deepakparamesh, shihyuho, and pimane reacted with thumbs down emoji

All reactions

* 👍
  7 reactions
* 👎
  3 reactions

Sorry, something went wrong.

[![@PavelBurya](https://avatars.githubusercontent.com/u/119487303?s=40&v=4)](/PavelBurya)
[PavelBurya](/PavelBurya)
mentioned this issue
[Nov 30, 2022](#ref-issue-1469263305)

[High Severity Vulnerability in html-minifier
mjmlio/mjml#2589](/mjmlio/mjml/issues/2589)

Open

[![@runderworld](https://avatars.githubusercontent.com/u/2746021?s=40&v=4)](/runderworld)
[runderworld](/runderworld)
mentioned this issue
[Jan 17, 2023](#ref-issue-1484860742)

[SECURITY: CVE-2022-37620
#1137](/kangax/html-minifier/issues/1137)

Open

[![@nigel12341](https://avatars.githubusercontent.com/u/17668318?s=40&v=4)](/nigel12341)
[nigel12341](/nigel12341)
mentioned this issue
[Feb 5, 2023](#ref-issue-1571585529)

[CVE-2022-37620 vulnerabilities in html-minifier package
ItzDerock/discord-html-transcripts#110](/ItzDerock/discord-html-transcripts/issues/110)

Closed

[![@blv-raulcatalan](https://avatars.githubusercontent.com/u/121115460?s=80&u=788079feb5f2850f8622d8f427da8e95670ea5a2&v=4)](/blv-raulcatalan)

Copy link

### **[blv-raulcatalan](/blv-raulcatalan)** commented [Mar 14, 2023](#issuecomment-1468433085)

| Any update on this? |
| --- |

All reactions

Sorry, something went wrong.

[![@rquadling](https://avatars.githubusercontent.com/u/12801?s=40&v=4)](/rquadling)
[rquadling](/rquadling)
mentioned this issue
[Mar 22, 2023](#ref-issue-1635632507)

[Html-minifier 4.0.0 has security issues
rquadling/grunt-html2js#128](/rquadling/grunt-html2js/issues/128)

Closed

[![@rquadling](https://avatars.githubusercontent.com/u/12801?s=80&v=4)](/rquadling)

Copy link

### **[rquadling](/rquadling)** commented [Mar 22, 2023](#issuecomment-1479517432) • edited Loading

| One of the lines referred to be the CVE has the following regex `\s+([1-9][0-9]*w|[0-9]+(?:\.[0-9]+)?x)$`  Would changing it to `\s+([1-9][0-9]*w|[0-9]+(?:\.[0-9]+|)x)$` be enough?  `\s+([1-9][0-9]*w|[0-9]+(?=(\.[0-9]+|))\2x)$` is another way that should stop the backtracking (based this upon <https://snyk.io/blog/redos-and-catastrophic-backtracking/>. |
| --- |

 👍
4
 pnesarajah, blv-raulcatalan, prajwalmr62, and Davilink reacted with thumbs up emoji

All reactions

* 👍
  4 reactions

Sorry, something went wrong.

[![@timbomckay](https://avatars.githubusercontent.com/u/784904?s=80&u=afd4d15c91497ceabdc261e72a2ed18cd2032823&v=4)](/timbomckay)

Copy link

### **[timbomckay](/timbomckay)** commented [Apr 10, 2023](#issuecomment-1502065386) • edited Loading

| I stumbled upon a fork of this maintained by terser: <https://www.npmjs.com/package/html-minifier-terser>  Probably the way to go. |
| --- |

 👍
2
 abniry and sahksas reacted with thumbs up emoji
 ❤️
2
 karlhorky and sahksas reacted with heart emoji
 🚀
5
 Yilmazzn, GeekCornerGH, derTobsch, karlhorky, and aangindra reacted with rocket emoji
 👀
1
 karlhorky reacted with eyes emoji

All reactions

* 👍
  2 reactions
* ❤️
  2 reactions
* 🚀
  5 reactions
* 👀
  1 reaction

Sorry, something went wrong.

[![@timbomckay](https://avatars.githubusercontent.com/u/784904?s=40&u=afd4d15c91497ceabdc261e72a2ed18cd2032823&v=4)](/timbomckay)
[timbomckay](/timbomckay)
mentioned this issue
[Apr 10, 2023](#ref-issue-1661101613)

[Update to Terser to Resolve ReDoS Vulnerability
asyncLiz/minify-html-literals#52](/asyncLiz/minify-html-literals/issues/52)

Closed

[![@johnhunter](https://avatars.githubusercontent.com/u/219160?s=40&v=4)](/johnhunter)
[johnhunter](/johnhunter)
mentioned this issue
[Jun 5, 2023](#ref-issue-1741813209)

[Security vulnerability in dependency html-minifier@4.0.0
meszaros-lajos-gyorgy/express-minify-html-2#3](/meszaros-lajos-gyorgy/express-minify-html-2/issues/3)

Closed

[![@uWottM8](https://avatars.githubusercontent.com/u/50047569?s=40&v=4)](/uWottM8)
[uWottM8](/uWottM8)
mentioned this issue
[Jun 15, 2023](#ref-issue-1758185341)

[ReDoS found in htmlminifier.js
ankitskvmdam/clean-jsdoc-theme#222](/ankitskvmdam/clean-jsdoc-theme/issues/222)

Closed

[![@Raxvis](https://avatars.githubusercontent.com/u/2748262?s=40&v=4)](/Raxvis)
[Raxvis](/Raxvis)
mentioned this issue
[Aug 8, 2023](#ref-issue-1841842745)

[Update to Terser to Resolve ReDoS Vulnerability
mjmlio/mjml#2722](/mjmlio/mjml/issues/2722)

Closed

[![@kevbarns](https://avatars.githubusercontent.com/u/22106329?s=40&v=4)](/kevbarns)
[kevbarns](/kevbarns)
mentioned this issue
[Jan 8, 2024](#ref-issue-2070195672)

[CVE-2022-37620 & switch to htmlnano
mjmlio/mjml#2802](/mjmlio/mjml/issues/2802)

Open

[![@TomaszG](https://avatars.githubusercontent.com/u/873114?s=40&v=4)](/TomaszG)
[TomaszG](/TomaszG)
mentioned this issue
[Jan 12, 2024](#ref-issue-2078344502)

[#CVE-2022-37620 in 1.10.3 (html-minifier@4.0.0 dependency)
nest-modules/mailer#1092](/nest-modules/mailer/issues/1092)

Closed

[curbengh](/curbengh)
added a commit
to curbengh/hexo-yam
that referenced
this issue
[Jan 28, 2024](#ref-commit-0bee9ad)
[![@curbengh](https://avatars.githubusercontent.com/u/43627182?s=40&u=28d137ff4797da597992f17376002619e80e32f5&v=4)](/curbengh)

`[refactor: switch html-minifier to html-minifier-terser](/curbengh/hexo-yam/commit/0bee9ada0efdf81aa8abd4fe192865c8614259be "refactor: switch html-minifier to html-minifier-terser

https://github.com/kangax/html-minifier/issues/1135")`
…

`[0bee9ad](/curbengh/hexo-yam/commit/0bee9ada0efdf81aa8abd4fe192865c8614259be)`

```
[kangax/html-minifier#1135](https://github.com/kangax/html-minifier/issues/1135)
```

[![@curbengh](https://avatars.githubusercontent.com/u/43627182?s=40&u=28d137ff4797da597992f17376002619e80e32f5&v=4)](/curbengh)
[curbengh](/curbengh)
mentioned this issue
[Jan 28, 2024](#ref-pullrequest-2104092815)

[refactor: switch html-minifier to html-minifier-terser
curbengh/hexo-yam#152](/curbengh/hexo-yam/pull/152)
 Merged

[![@daniluk4000](https://avatars.githubusercontent.com/u/10450717?s=40&v=4)](/daniluk4000)
[daniluk4000](/daniluk4000)
mentioned this issue
[Apr 23, 2024](#ref-issue-2259158935)

[Use html-minifier-terser instead of html-minifier for @nuxt/generator
nuxt/nuxt#26911](/nuxt/nuxt/issues/26911)

Closed

[![@zanodor](https://avatars.githubusercontent.com/u/110669301?s=40&v=4)](/zanodor)
[zanodor](/zanodor)
mentioned this issue
[Apr 23, 2024](#ref-issue-2259452392)

[404 Error on Index/Home file - Digital Garden Inaccessible
oleeskild/obsidian-digital-garden#583](/oleeskild/obsidian-digital-garden/issues/583)

Closed

[![@ynotdraw](https://avatars.githubusercontent.com/u/8069555?s=40&v=4)](/ynotdraw)
[ynotdraw](/ynotdraw)
mentioned this issue
[Apr 23, 2024](#ref-issue-2259578583)

[CVE-2022-37620: High Vulnerability with html-minifier
asyncLiz/minify-html-literals#56](/asyncLiz/minify-html-literals/issues/56)

Closed

[![@thewilkybarkid](https://avatars.githubusercontent.com/u/1784740?s=40&v=4)](/thewilkybarkid)
[thewilkybarkid](/thewilkybarkid)
mentioned this issue
[Apr 25, 2024](#ref-issue-2259212047)

[Dependency: html-minifier REDoS vulnerability
mjmlio/mjml#2856](/mjmlio/mjml/issues/2856)

Closed

[![@mashpie](https://avatars.githubusercontent.com/u/118508?s=40&v=4)](/mashpie)
[mashpie](/mashpie)
mentioned this issue
[Apr 28, 2024](#ref-issue-2267429847)

[CVE-2022-37620
uscreen/postal-mailer#79](/uscreen/postal-mailer/issues/79)

Open

[LeonEck](/LeonEck)
added a commit
to LeonEck/eck-autocomplete
that referenced
this issue
[Apr 30, 2024](#ref-commit-e37c869)
[![@LeonEck](https://avatars.githubusercontent.com/u/7900913?s=40&u=5c039444d41a6ab0c1210408c508959f85d0ba5a&v=4)](/LeonEck)

`[chore: 🤖 replace html-minifier with html-minifier-terser](/LeonEck/eck-autocomplete/commit/e37c869142426c0b869d2ed80f82604952244298 "chore: 🤖 replace html-minifier with html-minifier-terser

https://github.com/kangax/html-minifier/issues/1135#issuecomment-1502065386")`
…

`[e37c869](/LeonEck/eck-autocomplete/commit/e37c869142426c0b869d2ed80f82604952244298)`

```
[kangax/html-minifier#1135 (comment)](https://github.com/kangax/html-minifier/issues/1135#issuecomment-1502065386)
```

[![@littleblack111](https://avatars.githubusercontent.com/u/97672521?s=80&v=4)](/littleblack111)

Copy link

### **[littleblack111](/littleblack111)** commented [May 14, 2024](#issuecomment-2109347024)

| any updates? |
| --- |

All reactions

Sorry, something went wrong.

[![@timbomckay](https://avatars.githubusercontent.com/u/784904?s=80&u=afd4d15c91497ceabdc261e72a2ed18cd2032823&v=4)](/timbomckay)

Copy link

### **[timbomckay](/timbomckay)** commented [May 14, 2024](#issuecomment-2110516434)

| any updates?  [@littleblack111](https://github.com/littleblack111) as [mentioned above](https://github.com/kangax/html-minifier/issues/1135#issuecomment-1502065386), along with the slew of references to others switching, [html-minifier-terser](https://www.npmjs.com/package/html-minifier-terser) is probably the best solution. Aside from some repo adjustments this solution appears to be fairly abandoned, especially since the [package hasn't been updated in 5 years](https://www.npmjs.com/package/html-minifier), while `html-minified-terser` is maintained by [Terser](https://terser.org). |
| --- |

 👍
1
 rquadling reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@rquadling](https://avatars.githubusercontent.com/u/12801?s=80&v=4)](/rquadling)

Copy link

### **[rquadling](/rquadling)** commented [May 14, 2024](#issuecomment-2110717300)

| Now I've just got to remember what project I'm involved in that has this one as an issue! |
| --- |

 😄
1
 timbomckay reacted with laugh emoji

All reactions

* 😄
  1 reaction

Sorry, something went wrong.

[![@mattboll](https://avatars.githubusercontent.com/u/1690167?s=40&v=4)](/mattboll)
[mattboll](/mattboll)
mentioned this issue
[May 15, 2024](#ref-issue-2261709488)

[html-minifier high security vulnerability
antfu-collective/vite-ssg#397](/antfu-collective/vite-ssg/issues/397)

Open

[![@Hessah95](https://avatars.githubusercontent.com/u/53401891?s=80&u=78c84e88500234779863f817cedd876e001f8444&v=4)](/Hessah95)

Copy link

### **[Hessah95](/Hessah95)** commented [May 15, 2024](#issuecomment-2112287792)

| any update on this issue? |
| --- |

 👍
2
 LenoM and ina-lieder reacted with thumbs up emoji

All reactions

* 👍
  2 reactions

Sorry, something went wrong.

[![@timbomckay](https://avatars.githubusercontent.com/u/784904?s=80&u=afd4d15c91497ceabdc261e72a2ed18cd2032823&v=4)](/timbomckay)

Copy link

### **[timbomckay](/timbomckay)** commented [May 15, 2024](#issuecomment-2112483149)

| any update on this issue?  [@Hessah95](https://github.com/Hessah95) The comments in this thread point to another solution that's maintained. |
| --- |

All reactions

Sorry, something went wrong.

[![@Tpleme](https://avatars.githubusercontent.com/u/72796924?s=40&v=4)](/Tpleme)
[Tpleme](/Tpleme)
mentioned this issue
[Jul 17, 2024](#ref-issue-2413095438)

[[Bug] html-minifier high severity vulnerability
Thomascogez/nodemailer-mjml#268](/Thomascogez/nodemailer-mjml/issues/268)

Closed

[![@GeekyEggo](https://avatars.githubusercontent.com/u/1429781?s=40&v=4)](/GeekyEggo)
[GeekyEggo](/GeekyEggo)
mentioned this issue
[Aug 13, 2024](#ref-pullrequest-2463762624)

[fix(deps)!: switch to html-minifier-terser to address CVE-2022-37620 (fix #52, fix #56)
asyncLiz/minify-html-literals#57](/asyncLiz/minify-html-literals/pull/57)
 Merged

[![@cooljeanius](https://avatars.githubusercontent.com/u/1388660?s=40&v=4)](/cooljeanius)
[cooljeanius](/cooljeanius)
mentioned this issue
[Aug 17, 2024](#ref-issue-2471325927)

[Dependencies: switch from html-minifier to html-minifier-terser
kheina-com/Blue-Blocker#323](/kheina-com/Blue-Blocker/issues/323)

Closed

[![@borrelm](https://avatars.githubusercontent.com/u/118467327?s=40&v=4)](/borrelm)
[borrelm](/borrelm)
mentioned this issue
[Sep 4, 2024](#ref-issue-2505185965)

[Vulnerability : CVE-2022-37620
terser/html-minifier-terser#182](/terser/html-minifier-terser/issues/182)

Open

[![@AdrianKokot](https://avatars.githubusercontent.com/u/35179235?s=40&v=4)](/AdrianKokot)
[AdrianKokot](/AdrianKokot)
mentioned this issue
[Sep 13, 2024](#ref-issue-2524418518)

[[Bug] html-minifier vulnerability
ng-doc/ng-doc#206](/ng-doc/ng-doc/issues/206)

Closed

[![@mreishus](https://avatars.githubusercontent.com/u/937354?s=40&v=4)](/mreishus)
[mreishus](/mreishus)
mentioned this issue
[Sep 16, 2024](#ref-pullrequest-2529188064)

[replace html-minifier 4.0.0 with html-minifier-terser 7.2.0
Automattic/minifiers#34](/Automattic/minifiers/pull/34)
 Merged

[![@ra-dave](https://avatars.githubusercontent.com/u/24297299?s=80&v=4)](/ra-dave)

Copy link

### **[ra-dave](/ra-dave)** commented [Oct 6, 2024](#issuecomment-2395358744) • edited Loading

| html-minifier-terser latest version (7.2.0) still has the vulnerability? I just installed it and it says so. |
| --- |

 👍
1
 sidewayss reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@laurielim](https://avatars.githubusercontent.com/u/62180225?s=40&v=4)](/laurielim)
[laurielim](/laurielim)
mentioned this issue
[Oct 11, 2024](#ref-pullrequest-2582219147)

[Release 12.10.2024
laurielim/laurielim.github.io#20](/laurielim/laurielim.github.io/pull/20)
 Merged

[![@jonathan-durbin](https://avatars.githubusercontent.com/u/31511197?s=40&v=4)](/jonathan-durbin)
[jonathan-durbin](/jonathan-durbin)
mentioned this issue
[Oct 17, 2024](#ref-issue-2546238538)

[NPM Vulnerabilities
CodeStitchOfficial/Intermediate-Website-Kit-LESS#9](/CodeStitchOfficial/Intermediate-Website-Kit-LESS/issues/9)

Open

[![@marcoandre1](https://avatars.githubusercontent.com/u/31892221?s=40&u=93bf36a8ccedfee907670d7d8ee450924aaf4d47&v=4)](/marcoandre1)
[marcoandre1](/marcoandre1)
mentioned this issue
[Oct 19, 2024](#ref-issue-2598679884)

[Update html-minifier
marcoandre1/react-snap#22](/marcoandre1/react-snap/issues/22)

Closed

[![@marcoandre1](https://avatars.githubusercontent.com/u/31892221?s=80&u=93bf36a8ccedfee907670d7d8ee450924aaf4d47&v=4)](/marcoandre1)

Copy link

### **[marcoandre1](/marcoandre1)** commented [Oct 19, 2024](#issuecomment-2423568084)

| [@ra-dave](https://github.com/ra-dave) I first installed version 7.2.0 as well, but it broke my unit tests. I then went for version 5.1.1 which keeps my unit tests passing and it made the vulnerability go away. Of course, this only works if you don’t need the newest version. |
| --- |

All reactions

Sorry, something went wrong.

[![@DanielRuf](https://avatars.githubusercontent.com/u/827205?s=80&u=fa946f3ab4b4bdd2c7274a99715064519ed2c57c&v=4)](/DanielRuf)

Copy link

### **[DanielRuf](/DanielRuf)** commented [Nov 2, 2024](#issuecomment-2452952695) • edited Loading

| Can anyone provide a working proof of concept that confirms the issue can be actively exploited?  Also what would be the definitive solution here? |
| --- |

 👀
1
 yusancky reacted with eyes emoji

All reactions

* 👀
  1 reaction

Sorry, something went wrong.

[![@DanielRuf](https://avatars.githubusercontent.com/u/827205?s=80&u=fa946f3ab4b4bdd2c7274a99715064519ed2c57c&v=4)](/DanielRuf)

Copy link

### **[DanielRuf](/DanielRuf)** commented [Nov 3, 2024](#issuecomment-2453388023) • edited Loading

| It seems the CVE record differs from <https://security.snyk.io/vuln/SNYK-JS-HTMLMINIFIER-3091181>, which contains more details.  Not sure why this is the case. I will clarify with Snyk.  Edit: the `candidate` variable is not even used here, because the relevant code branch for srcset (`else if (isSrcset(attrName, tag)) {`) is not even executed in the PoC.  It seems the CVE description is more than misleading, at best incomplete and inaccurate. |
| --- |

All reactions

Sorry, something went wrong.

[![@DanielRuf](https://avatars.githubusercontent.com/u/827205?s=80&u=fa946f3ab4b4bdd2c7274a99715064519ed2c57c&v=4)](/DanielRuf)

Copy link

### **[DanielRuf](/DanielRuf)** commented [Nov 3, 2024](#issuecomment-2453405484) • edited Loading

| It seems the PoC is more complex than needed.  The code basically makes not much sense: `minify(attrName = '\t'.repeat(547703) + '.\t1x', tag = '\t'.repeat(547703) + '.\t1x' )`  It should be probably this:  `minify('\t'.repeat(547703) + '.\t1x', '\t'.repeat(547703) + '.\t1x' )`  Because the `minify` function has the following signature: `exports.minify = function(value, options) {`  The `options` parameter does not have an impact. Because when I leave the second parameter undefined, then `time node test.js` gives the same duration.  So the following PoC code is sufficient: `result = minify('\t'.repeat(54770) + '.\t1x' )`  The issue is in the following code part:  ```   var customFragments = options.ignoreCustomFragments.map(function(re) {     return re.source;   });   if (customFragments.length) {     var reCustomIgnore = new RegExp('\\s*(?:' + customFragments.join('|') + ')+\\s*', 'g');     // temporarily replace custom ignored fragments with unique attributes     value = value.replace(reCustomIgnore, function(match) {       if (!uidAttr) {         uidAttr = uniqueId(value);         uidPattern = new RegExp('(\\s*)' + uidAttr + '([0-9]+)' + uidAttr + '(\\s*)', 'g');         if (options.minifyCSS) {           options.minifyCSS = (function(fn) {             return function(text, type) {               text = text.replace(uidPattern, function(match, prefix, index) {                 var chunks = ignoredCustomMarkupChunks[+index];                 return chunks[1] + uidAttr + index + uidAttr + chunks[2];               });               var ids = [];               new CleanCSS().minify(wrapCSS(text, type)).warnings.forEach(function(warning) {                 var match = uidPattern.exec(warning);                 if (match) {                   var id = uidAttr + match[2] + uidAttr;                   text = text.replace(id, ignoreCSS(id));                   ids.push(id);                 }               });               text = fn(text, type);               ids.forEach(function(id) {                 text = text.replace(ignoreCSS(id), id);               });               return text;             };           })(options.minifyCSS);         }         if (options.minifyJS) {           options.minifyJS = (function(fn) {             return function(text, type) {               return fn(text.replace(uidPattern, function(match, prefix, index) {                 var chunks = ignoredCustomMarkupChunks[+index];                 return chunks[1] + uidAttr + index + uidAttr + chunks[2];               }), type);             };           })(options.minifyJS);         }       }       var token = uidAttr + ignoredCustomMarkupChunks.length + uidAttr;       ignoredCustomMarkupChunks.push(/^(\s*)[\s\S]*?(\s*)$/.exec(match));       return '\t' + token + '\t';     });   } ```  After checking further, the following line is the problem:  `var reCustomIgnore = new RegExp('\\s*(?:' + customFragments.join('|') + ')+\\s*', 'g');` which results in the following by default: `var reCustomIgnore = new RegExp('\\s*(?:<%[\\s\\S]*?%>|<\\?[\\s\\S]*?\\?>)+\\s*', 'g');`  The person whou found the problem, probably used <https://devina.io/redos-checker>, which also uses the same type of attack string:  [image](https://private-user-images.githubusercontent.com/827205/382568077-a83eb487-3a2a-47a6-b183-6ca764bd5275.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzYzMzQ1MDMsIm5iZiI6MTczNjMzNDIwMywicGF0aCI6Ii84MjcyMDUvMzgyNTY4MDc3LWE4M2ViNDg3LTNhMmEtNDdhNi1iMTgzLTZjYTc2NGJkNTI3NS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTA4JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDEwOFQxMTAzMjNaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT02YmYyZTliNzA1ZTFlZDM2NjE5OGYzZGE2OTViMzY0MzQwODM1OGQ1MGZmNDU2YjM0ZmJlMDY3ZjdjZTQxZTBkJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.1_nqrF9TqZnrw-JX7bmTnIJd8LCPE4_ZhYm8GY_RiUM)  **The problem** usage of `*` and `+` in `reCustomIgnore` without any upper bounds (`{0,50}, {1,50}`), which leads to catastrophic backtracking.  **Migitations**   * set `options.ignoreCustomFragments = [];` - this may break some minifications * set a global timeout in your script, which should be done in general in production (applies to any programming language to prevent the consumption of too many resources and to mitigate DoS), see for example <https://www.nearform.com/insights/using-abortsignal-in-node-js/> |
| --- |

 👍
1
 charsleysa reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@DanielRuf](https://avatars.githubusercontent.com/u/827205?s=80&u=fa946f3ab4b4bdd2c7274a99715064519ed2c57c&v=4)](/DanielRuf)

Copy link

### **[DanielRuf](/DanielRuf)** commented [Nov 3, 2024](#issuecomment-2453437884)

| For anyone asking, **html-minifier-terser is also affected**. So switching to it will not resolve this. You will just get less reported CVEs but you will also have a false-negative then. |
| --- |

 👍
3
 sidewayss, mashpie, and charsleysa reacted with thumbs up emoji

All reactions

* 👍
  3 reactions

Sorry, something went wrong.

[![@sidewayss](https://avatars.githubusercontent.com/u/15235202?s=80&v=4)](/sidewayss)

Copy link

### **[sidewayss](/sidewayss)** commented [Nov 3, 2024](#issuecomment-2453463626)

| And of course it affects all the other downstream packages, including these:   * **gulp-htmlmin** * **gulp-html-minifier-terser** * **gulp-htmlclean** |
| --- |

All reactions

Sorry, something went wrong.

[![@DanielRuf](https://avatars.githubusercontent.com/u/827205?s=40&u=fa946f3ab4b4bdd2c7274a99715064519ed2c57c&v=4)](/DanielRuf)
[DanielRuf](/DanielRuf)
mentioned this issue
[Nov 3, 2024](#ref-pullrequest-2277206700)

[Move from html-minifier to html-minifier-terser
focus-shift/urlaubsverwaltung-landingpage#731](/focus-shift/urlaubsverwaltung-landingpage/pull/731)
 Merged

[DanielRuf](/DanielRuf)
referenced
this issue
in Samat-Imamov/html-minifier-fixed
[Nov 3, 2024](#ref-commit-023f72b)
[![@Samat-Imamov](https://avatars.githubusercontent.com/u/31497046?s=40&v=4)](/Samat-Imamov)

`[Fix for](/Samat-Imamov/html-minifier-fixed/commit/023f72beccd2e494f8f903b99f963ef29e232ec1 "Fix for CVE-2022-37620") [CVE-2022-37620](https://github.com/advisories/GHSA-pfq8-rq6v-vf5m "CVE-2022-37620")`

`[023f72b](/Samat-Imamov/html-minifier-fixed/commit/023f72beccd2e494f8f903b99f963ef29e232ec1)`

[![@ananzh](https://avatars.githubusercontent.com/u/79961084?s=80&u=b00cbc700d5dd440d66fd5b410294c9ab99add62&v=4)](/ananzh)

Copy link

### **[ananzh](/ananzh)** commented [Dec 4, 2024](#issuecomment-2518692447)

| Hi any updates on the plan to fix this? |
| --- |

 👀
2
 yusancky and globalexport reacted with eyes emoji

All reactions

* 👀
  2 reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fkangax%2Fhtml-minifier%2Fissues%2F1135)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

12 participants

[![@rquadling](https://avatars.githubusercontent.com/u/12801?s=52&v=4)](/rquadling) [![@timbomckay](https://avatars.githubusercontent.com/u/784904?s=52&v=4)](/timbomckay) [![@DanielRuf](https://avatars.githubusercontent.com/u/827205?s=52&v=4)](/DanielRuf) [![@sidewayss](https://avatars.githubusercontent.com/u/15235202?s=52&v=4)](/sidewayss) [![@michaeljauk](https://avatars.githubusercontent.com/u/18634867?s=52&v=4)](/michaeljauk) [![@ra-dave](https://avatars.githubusercontent.com/u/24297299?s=52&v=4)](/ra-dave) [![@secdevlpr26](https://avatars.githubusercontent.com/u/31366114?s=52&v=4)](/secdevlpr26) [![@marcoandre1](https://avatars.githubusercontent.com/u/31892221?s=52&v=4)](/marcoandre1) [![@Hessah95](https://avatars.githubusercontent.com/u/53401891?s=52&v=4)](/Hessah95) [![@ananzh](https://avatars.githubusercontent.com/u/79961084?s=52&v=4)](/ananzh) [![@littleblack111](https://avatars.githubusercontent.com/u/97672521?s=52&v=4)](/littleblack111) [![@blv-raulcatalan](https://avatars.githubusercontent.com/u/121115460?s=52&v=4)](/blv-raulcatalan)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_e0d13923_20250108_110322.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkangax%2Fhtml-minifier%2Fblob%2F51ce10f4daedb1de483ffbcccecc41be1c873da2%2Fsrc%2Fhtmlminifier.js)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkangax%2Fhtml-minifier%2Fblob%2F51ce10f4daedb1de483ffbcccecc41be1c873da2%2Fsrc%2Fhtmlminifier.js)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=kangax%2Fhtml-minifier)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[kangax](/kangax)
/
**[html-minifier](/kangax/html-minifier)**
Public

* [Notifications](/login?return_to=%2Fkangax%2Fhtml-minifier) You must be signed in to change notification settings
* [Fork
  576](/login?return_to=%2Fkangax%2Fhtml-minifier)
* [Star
   5k](/login?return_to=%2Fkangax%2Fhtml-minifier)

* [Code](/kangax/html-minifier)
* [Issues
  84](/kangax/html-minifier/issues)
* [Pull requests
  24](/kangax/html-minifier/pulls)
* [Actions](/kangax/html-minifier/actions)
* [Projects
  0](/kangax/html-minifier/projects)
* [Wiki](/kangax/html-minifier/wiki)
* [Security](/kangax/html-minifier/security)
* [Insights](/kangax/html-minifier/pulse)

Additional navigation options

* [Code](/kangax/html-minifier)
* [Issues](/kangax/html-minifier/issues)
* [Pull requests](/kangax/html-minifier/pulls)
* [Actions](/kangax/html-minifier/actions)
* [Projects](/kangax/html-minifier/projects)
* [Wiki](/kangax/html-minifier/wiki)
* [Security](/kangax/html-minifier/security)
* [Insights](/kangax/html-minifier/pulse)

## Files

 51ce10f
## Breadcrumbs

1. [html-minifier](/kangax/html-minifier/tree/51ce10f4daedb1de483ffbcccecc41be1c873da2)
2. /[src](/kangax/html-minifier/tree/51ce10f4daedb1de483ffbcccecc41be1c873da2/src)
/
# htmlminifier.js

 Blame  Blame
## Latest commit

## History

[History](/kangax/html-minifier/commits/51ce10f4daedb1de483ffbcccecc41be1c873da2/src/htmlminifier.js)1344 lines (1240 loc) · 44.8 KB 51ce10f
## Breadcrumbs

1. [html-minifier](/kangax/html-minifier/tree/51ce10f4daedb1de483ffbcccecc41be1c873da2)
2. /[src](/kangax/html-minifier/tree/51ce10f4daedb1de483ffbcccecc41be1c873da2/src)
/
# htmlminifier.js

Top
## File metadata and controls

* Code
* Blame

1344 lines (1240 loc) · 44.8 KB[Raw](https://github.com/kangax/html-minifier/raw/51ce10f4daedb1de483ffbcccecc41be1c873da2/src/htmlminifier.js)1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798991001011021031041051061071081091101111121131141151161171181191201211221231241251261271281291301311321331341351361371381391401411421431441451461471481491501511521531541551561571581591601611621631641651661671681691701711721731741751761771781791801811821831841851861871881891901911921931941951961971981992002012022032042052062072082092102112122132142152162172182192202212222232242252262272282292302312322332342352362372382392402412422432442452462472482492502512522532542552562572582592602612622632642652662672682692702712722732742752762772782792802812822832842852862872882892902912922932942952962972982993003013023033043053063073083093103113123133143153163173183193203213223233243253263273283293303313323333343353363373383393403413423433443453463473483493503513523533543553563573583593603613623633643653663673683693703713723733743753763773783793803813823833843853863873883893903913923933943953963973983994004014024034044054064074084094104114124134144154164174184194204214224234244254264274284294304314324334344354364374384394404414424434444454464474484494504514524534544554564574584594604614624634644654664674684694704714724734744754764774784794804814824834844854864874884894904914924934944954964974984995005015025035045055065075085095105115125135145155165175185195205215225235245255265275285295305315325335345355365375385395405415425435445455465475485495505515525535545555565575585595605615625635645655665675685695705715725735745755765775785795805815825835845855865875885895905915925935945955965975985996006016026036046056066076086096106116126136146156166176186196206216226236246256266276286296306316326336346356366376386396406416426436446456466476486496506516526536546556566576586596606616626636646656666676686696706716726736746756766776786796806816826836846856866876886896906916926936946956966976986997007017027037047057067077087097107117127137147157167177187197207217227237247257267277287297307317327337347357367377387397407417427437447457467477487497507517527537547557567577587597607617627637647657667677687697707717727737747757767777787797807817827837847857867877887897907917927937947957967977987998008018028038048058068078088098108118128138148158168178188198208218228238248258268278288298308318328338348358368378388398408418428438448458468478488498508518528538548558568578588598608618628638648658668678688698708718728738748758768778788798808818828838848858868878888898908918928938948958968978988999009019029039049059069079089099109119129139149159169179189199209219229239249259269279289299309319329339349359369379389399409419429439449459469479489499509519529539549559569579589599609619629639649659669679689699709719729739749759769779789799809819829839849859869879889899909919929939949959969979989991000'use strict';
var CleanCSS = require('clean-css');var decode = require('he').decode;var HTMLParser = require('./htmlparser').HTMLParser;var RelateUrl = require('relateurl');var TokenChain = require('./tokenchain');var UglifyJS = require('uglify-js');var utils = require('./utils');
function trimWhitespace(str) { return str && str.replace(/^[ \n\r\t\f]+/, '').replace(/[ \n\r\t\f]+$/, '');}
function collapseWhitespaceAll(str) { // Non-breaking space is specifically handled inside the replacer function here: return str && str.replace(/[ \n\r\t\f\xA0]+/g, function(spaces) { return spaces === '\t' ? '\t' : spaces.replace(/(^|\xA0+)[^\xA0]+/g, '$1 '); });}
function collapseWhitespace(str, options, trimLeft, trimRight, collapseAll) { var lineBreakBefore = '', lineBreakAfter = '';
 if (options.preserveLineBreaks) { str = str.replace(/^[ \n\r\t\f]\*?[\n\r][ \n\r\t\f]\*/, function() { lineBreakBefore = '\n'; return ''; }).replace(/[ \n\r\t\f]\*?[\n\r][ \n\r\t\f]\*$/, function() { lineBreakAfter = '\n'; return ''; }); }
 if (trimLeft) { // Non-breaking space is specifically handled inside the replacer function here: str = str.replace(/^[ \n\r\t\f\xA0]+/, function(spaces) { var conservative = !lineBreakBefore && options.conservativeCollapse; if (conservative && spaces === '\t') { return '\t'; } return spaces.replace(/^[^\xA0]+/, '').replace(/(\xA0+)[^\xA0]+/g, '$1 ') || (conservative ? ' ' : ''); }); }
 if (trimRight) { // Non-breaking space is specifically handled inside the replacer function here: str = str.replace(/[ \n\r\t\f\xA0]+$/, function(spaces) { var conservative = !lineBreakAfter && options.conservativeCollapse; if (conservative && spaces === '\t') { return '\t'; } return spaces.replace(/[^\xA0]+(\xA0+)/g, ' $1').replace(/[^\xA0]+$/, '') || (conservative ? ' ' : ''); }); }
 if (collapseAll) { // strip non space whitespace then compress spaces to one str = collapseWhitespaceAll(str); }
 return lineBreakBefore + str + lineBreakAfter;}
var createMapFromString = utils.createMapFromString;// non-empty tags that will maintain whitespace around themvar inlineTags = createMapFromString('a,abbr,acronym,b,bdi,bdo,big,button,cite,code,del,dfn,em,font,i,ins,kbd,label,mark,math,nobr,object,q,rp,rt,rtc,ruby,s,samp,select,small,span,strike,strong,sub,sup,svg,textarea,time,tt,u,var');// non-empty tags that will maintain whitespace within themvar inlineTextTags = createMapFromString('a,abbr,acronym,b,big,del,em,font,i,ins,kbd,mark,nobr,rp,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var');// self-closing tags that will maintain whitespace around themvar selfClosingInlineTags = createMapFromString('comment,img,input,wbr');
function collapseWhitespaceSmart(str, prevTag, nextTag, options) { var trimLeft = prevTag && !selfClosingInlineTags(prevTag); if (trimLeft && !options.collapseInlineTagWhitespace) { trimLeft = prevTag.charAt(0) === '/' ? !inlineTags(prevTag.slice(1)) : !inlineTextTags(prevTag); } var trimRight = nextTag && !selfClosingInlineTags(nextTag); if (trimRight && !options.collapseInlineTagWhitespace) { trimRight = nextTag.charAt(0) === '/' ? !inlineTextTags(nextTag.slice(1)) : !inlineTags(nextTag); } return collapseWhitespace(str, options, trimLeft, trimRight, prevTag && nextTag);}
function isConditionalComment(text) { return /^\[if\s[^\]]+]|\[endif]$/.test(text);}
function isIgnoredComment(text, options) { for (var i = 0, len = options.ignoreCustomComments.length; i < len; i++) { if (options.ignoreCustomComments[i].test(text)) { return true; } } return false;}
function isEventAttribute(attrName, options) { var patterns = options.customEventAttributes; if (patterns) { for (var i = patterns.length; i--;) { if (patterns[i].test(attrName)) { return true; } } return false; } return /^on[a-z]{3,}$/.test(attrName);}
function canRemoveAttributeQuotes(value) { // https://mathiasbynens.be/notes/unquoted-attribute-values return /^[^ \t\n\f\r"'`=<>]+$/.test(value);}
function attributesInclude(attributes, attribute) { for (var i = attributes.length; i--;) { if (attributes[i].name.toLowerCase() === attribute) { return true; } } return false;}
function isAttributeRedundant(tag, attrName, attrValue, attrs) { attrValue = attrValue ? trimWhitespace(attrValue.toLowerCase()) : '';
 return ( tag === 'script' && attrName === 'language' && attrValue === 'javascript' ||
 tag === 'form' && attrName === 'method' && attrValue === 'get' ||
 tag === 'input' && attrName === 'type' && attrValue === 'text' ||
 tag === 'script' && attrName === 'charset' && !attributesInclude(attrs, 'src') ||
 tag === 'a' && attrName === 'name' && attributesInclude(attrs, 'id') ||
 tag === 'area' && attrName === 'shape' && attrValue === 'rect' );}
// https://mathiasbynens.be/demo/javascript-mime-type// https://developer.mozilla.org/en/docs/Web/HTML/Element/script#attr-typevar executableScriptsMimetypes = utils.createMap([ 'text/javascript', 'text/ecmascript', 'text/jscript', 'application/javascript', 'application/x-javascript', 'application/ecmascript']);
function isScriptTypeAttribute(attrValue) { attrValue = trimWhitespace(attrValue.split(/;/, 2)[0]).toLowerCase(); return attrValue === '' || executableScriptsMimetypes(attrValue);}
function isExecutableScript(tag, attrs) { if (tag !== 'script') { return false; } for (var i = 0, len = attrs.length; i < len; i++) { var attrName = attrs[i].name.toLowerCase(); if (attrName === 'type') { return isScriptTypeAttribute(attrs[i].value); } } return true;}
function isStyleLinkTypeAttribute(attrValue) { attrValue = trimWhitespace(attrValue).toLowerCase(); return attrValue === '' || attrValue === 'text/css';}
function isStyleSheet(tag, attrs) { if (tag !== 'style') { return false; } for (var i = 0, len = attrs.length; i < len; i++) { var attrName = attrs[i].name.toLowerCase(); if (attrName === 'type') { return isStyleLinkTypeAttribute(attrs[i].value); } } return true;}
var isSimpleBoolean = createMapFromString('allowfullscreen,async,autofocus,autoplay,checked,compact,controls,declare,default,defaultchecked,defaultmuted,defaultselected,defer,disabled,enabled,formnovalidate,hidden,indeterminate,inert,ismap,itemscope,loop,multiple,muted,nohref,noresize,noshade,novalidate,nowrap,open,pauseonexit,readonly,required,reversed,scoped,seamless,selected,sortable,truespeed,typemustmatch,visible');var isBooleanValue = createMapFromString('true,false');
function isBooleanAttribute(attrName, attrValue) { return isSimpleBoolean(attrName) || attrName === 'draggable' && !isBooleanValue(attrValue);}
function isUriTypeAttribute(attrName, tag) { return ( /^(?:a|area|link|base)$/.test(tag) && attrName === 'href' || tag === 'img' && /^(?:src|longdesc|usemap)$/.test(attrName) || tag === 'object' && /^(?:classid|codebase|data|usemap)$/.test(attrName) || tag === 'q' && attrName === 'cite' || tag === 'blockquote' && attrName === 'cite' || (tag === 'ins' || tag === 'del') && attrName === 'cite' || tag === 'form' && attrName === 'action' || tag === 'input' && (attrName === 'src' || attrName === 'usemap') || tag === 'head' && attrName === 'profile' || tag === 'script' && (attrName === 'src' || attrName === 'for') );}
function isNumberTypeAttribute(attrName, tag) { return ( /^(?:a|area|object|button)$/.test(tag) && attrName === 'tabindex' || tag === 'input' && (attrName === 'maxlength' || attrName === 'tabindex') || tag === 'select' && (attrName === 'size' || attrName === 'tabindex') || tag === 'textarea' && /^(?:rows|cols|tabindex)$/.test(attrName) || tag === 'colgroup' && attrName === 'span' || tag === 'col' && attrName === 'span' || (tag === 'th' || tag === 'td') && (attrName === 'rowspan' || attrName === 'colspan') );}
function isLinkType(tag, attrs, value) { if (tag !== 'link') { return false; } for (var i = 0, len = attrs.length; i < len; i++) { if (attrs[i].name === 'rel' && attrs[i].value === value) { return true; } }}
function isMediaQuery(tag, attrs, attrName) { return attrName === 'media' && (isLinkType(tag, attrs, 'stylesheet') || isStyleSheet(tag, attrs));}
var srcsetTags = createMapFromString('img,source');
function isSrcset(attrName, tag) { return attrName === 'srcset' && srcsetTags(tag);}
function cleanAttributeValue(tag, attrName, attrValue, options, attrs) { if (isEventAttribute(attrName, options)) { attrValue = trimWhitespace(attrValue).replace(/^javascript:\s\*/i, ''); return options.minifyJS(attrValue, true); } else if (attrName === 'class') { attrValue = trimWhitespace(attrValue); if (options.sortClassName) { attrValue = options.sortClassName(attrValue); } else { attrValue = collapseWhitespaceAll(attrValue); } return attrValue; } else if (isUriTypeAttribute(attrName, tag)) { attrValue = trimWhitespace(attrValue); return isLinkType(tag, attrs, 'canonical') ? attrValue : options.minifyURLs(attrValue); } else if (isNumberTypeAttribute(attrName, tag)) { return trimWhitespace(attrValue); } else if (attrName === 'style') { attrValue = trimWhitespace(attrValue); if (attrValue) { if (/;$/.test(attrValue) && !/&#?[0-9a-zA-Z]+;$/.test(attrValue)) { attrValue = attrValue.replace(/\s\*;$/, ';'); } attrValue = options.minifyCSS(attrValue, 'inline'); } return attrValue; } else if (isSrcset(attrName, tag)) { // https://html.spec.whatwg.org/multipage/embedded-content.html#attr-img-srcset attrValue = trimWhitespace(attrValue).split(/\s+,\s\*|\s\*,\s+/).map(function(candidate) { var url = candidate; var descriptor = ''; var match = candidate.match(/\s+([1-9][0-9]\*w|[0-9]+(?:\.[0-9]+)?x)$/); if (match) { url = url.slice(0, -match[0].length); var num = +match[1].slice(0, -1); var suffix = match[1].slice(-1); if (num !== 1 || suffix !== 'x') { descriptor = ' ' + num + suffix; } } return options.minifyURLs(url) + descriptor; }).join(', '); } else if (isMetaViewport(tag, attrs) && attrName === 'content') { attrValue = attrValue.replace(/\s+/g, '').replace(/[0-9]+\.[0-9]+/g, function(numString) { // "0.90000" -> "0.9" // "1.0" -> "1" // "1.0001" -> "1.0001" (unchanged) return (+numString).toString(); }); } else if (isContentSecurityPolicy(tag, attrs) && attrName.toLowerCase() === 'content') { return collapseWhitespaceAll(attrValue); } else if (options.customAttrCollapse && options.customAttrCollapse.test(attrName)) { attrValue = attrValue.replace(/\n+|\r+|\s{2,}/g, ''); } else if (tag === 'script' && attrName === 'type') { attrValue = trimWhitespace(attrValue.replace(/\s\*;\s\*/g, ';')); } else if (isMediaQuery(tag, attrs, attrName)) { attrValue = trimWhitespace(attrValue); return options.minifyCSS(attrValue, 'media'); } return attrValue;}
function isMetaViewport(tag, attrs) { if (tag !== 'meta') { return false; } for (var i = 0, len = attrs.length; i < len; i++) { if (attrs[i].name === 'name' && attrs[i].value === 'viewport') { return true; } }}
function isContentSecurityPolicy(tag, attrs) { if (tag !== 'meta') { return false; } for (var i = 0, len = attrs.length; i < len; i++) { if (attrs[i].name.toLowerCase() === 'http-equiv' && attrs[i].value.toLowerCase() === 'content-security-policy') { return true; } }}
function ignoreCSS(id) { return '/\* clean-css ignore:start \*/' + id + '/\* clean-css ignore:end \*/';}
// Wrap CSS declarations for CleanCSS > 3.x// See https://github.com/jakubpawlowicz/clean-css/issues/418function wrapCSS(text, type) { switch (type) { case 'inline': return '\*{' + text + '}'; case 'media': return '@media ' + text + '{a{top:0}}'; default: return text; }}
function unwrapCSS(text, type) { var matches; switch (type) { case 'inline': matches = text.match(/^\\*\{([\s\S]\*)\}$/); break; case 'media': matches = text.match(/^@media ([\s\S]\*?)\s\*{[\s\S]\*}$/); break; } return matches ? matches[1] : text;}
function cleanConditionalComment(comment, options) { return options.processConditionalComments ? comment.replace(/^(\[if\s[^\]]+]>)([\s\S]\*?)(<!\[endif])$/, function(match, prefix, text, suffix) { return prefix + minify(text, options, true) + suffix; }) : comment;}
function processScript(text, options, currentAttrs) { for (var i = 0, len = currentAttrs.length; i < len; i++) { if (currentAttrs[i].name.toLowerCase() === 'type' && options.processScripts.indexOf(currentAttrs[i].value) > -1) { return minify(text, options); } } return text;}
// Tag omission rules from https://html.spec.whatwg.org/multipage/syntax.html#optional-tags// with the following deviations:// - retain <body> if followed by <noscript>// - </rb>, </rt>, </rtc>, </rp> & </tfoot> follow https://www.w3.org/TR/html5/syntax.html#optional-tags// - retain all tags which are adjacent to non-standard HTML tagsvar optionalStartTags = createMapFromString('html,head,body,colgroup,tbody');var optionalEndTags = createMapFromString('html,head,body,li,dt,dd,p,rb,rt,rtc,rp,optgroup,option,colgroup,caption,thead,tbody,tfoot,tr,td,th');var headerTags = createMapFromString('meta,link,script,style,template,noscript');var descriptionTags = createMapFromString('dt,dd');var pBlockTags = createMapFromString('address,article,aside,blockquote,details,div,dl,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,header,hgroup,hr,main,menu,nav,ol,p,pre,section,table,ul');var pInlineTags = createMapFromString('a,audio,del,ins,map,noscript,video');var rubyTags = createMapFromString('rb,rt,rtc,rp');var rtcTag = createMapFromString('rb,rtc,rp');var optionTag = createMapFromString('option,optgroup');var tableContentTags = createMapFromString('tbody,tfoot');var tableSectionTags = createMapFromString('thead,tbody,tfoot');var cellTags = createMapFromString('td,th');var topLevelTags = createMapFromString('html,head,body');var compactTags = createMapFromString('html,body');var looseTags = createMapFromString('head,colgroup,caption');var trailingTags = createMapFromString('dt,thead');var htmlTags = createMapFromString('a,abbr,acronym,address,applet,area,article,aside,audio,b,base,basefont,bdi,bdo,bgsound,big,blink,blockquote,body,br,button,canvas,caption,center,cite,code,col,colgroup,command,content,data,datalist,dd,del,details,dfn,dialog,dir,div,dl,dt,element,em,embed,fieldset,figcaption,figure,font,footer,form,frame,frameset,h1,h2,h3,h4,h5,h6,head,header,hgroup,hr,html,i,iframe,image,img,input,ins,isindex,kbd,keygen,label,legend,li,link,listing,main,map,mark,marquee,menu,menuitem,meta,meter,multicol,nav,nobr,noembed,noframes,noscript,object,ol,optgroup,option,output,p,param,picture,plaintext,pre,progress,q,rb,rp,rt,rtc,ruby,s,samp,script,section,select,shadow,small,source,spacer,span,strike,strong,style,sub,summary,sup,table,tbody,td,template,textarea,tfoot,th,thead,time,title,tr,track,tt,u,ul,var,video,wbr,xmp');
function canRemoveParentTag(optionalStartTag, tag) { switch (optionalStartTag) { case 'html': case 'head': return true; case 'body': return !headerTags(tag); case 'colgroup': return tag === 'col'; case 'tbody': return tag === 'tr'; } return false;}
function isStartTagMandatory(optionalEndTag, tag) { switch (tag) { case 'colgroup': return optionalEndTag === 'colgroup'; case 'tbody': return tableSectionTags(optionalEndTag); } return false;}
function canRemovePrecedingTag(optionalEndTag, tag) { switch (optionalEndTag) { case 'html': case 'head': case 'body': case 'colgroup': case 'caption': return true; case 'li': case 'optgroup': case 'tr': return tag === optionalEndTag; case 'dt': case 'dd': return descriptionTags(tag); case 'p': return pBlockTags(tag); case 'rb': case 'rt': case 'rp': return rubyTags(tag); case 'rtc': return rtcTag(tag); case 'option': return optionTag(tag); case 'thead': case 'tbody': return tableContentTags(tag); case 'tfoot': return tag === 'tbody'; case 'td': case 'th': return cellTags(tag); } return false;}
var reEmptyAttribute = new RegExp( '^(?:class|id|style|title|lang|dir|on(?:focus|blur|change|click|dblclick|mouse(' + '?:down|up|over|move|out)|key(?:press|down|up)))$');
function canDeleteEmptyAttribute(tag, attrName, attrValue, options) { var isValueEmpty = !attrValue || /^\s\*$/.test(attrValue); if (!isValueEmpty) { return false; } if (typeof options.removeEmptyAttributes === 'function') { return options.removeEmptyAttributes(attrName, tag); } return tag === 'input' && attrName === 'value' || reEmptyAttribute.test(attrName);}
function hasAttrName(name, attrs) { for (var i = attrs.length - 1; i >= 0; i--) { if (attrs[i].name === name) { return true; } } return false;}
function canRemoveElement(tag, attrs) { switch (tag) { case 'textarea': return false; case 'audio': case 'script': case 'video': if (hasAttrName('src', attrs)) { return false; } break; case 'iframe': if (hasAttrName('src', attrs) || hasAttrName('srcdoc', attrs)) { return false; } break; case 'object': if (hasAttrName('data', attrs)) { return false; } break; case 'applet': if (hasAttrName('code', attrs)) { return false; } break; } return true;}
function canCollapseWhitespace(tag) { return !/^(?:script|style|pre|textarea)$/.test(tag);}
function canTrimWhitespace(tag) { return !/^(?:pre|textarea)$/.test(tag);}
function normalizeAttr(attr, attrs, tag, options) { var attrName = options.name(attr.name), attrValue = attr.value;
 if (options.decodeEntities && attrValue) { attrValue = decode(attrValue, { isAttributeValue: true }); }
 if (options.removeRedundantAttributes && isAttributeRedundant(tag, attrName, attrValue, attrs) || options.removeScriptTypeAttributes && tag === 'script' && attrName === 'type' && isScriptTypeAttribute(attrValue) || options.removeStyleLinkTypeAttributes && (tag === 'style' || tag === 'link') && attrName === 'type' && isStyleLinkTypeAttribute(attrValue)) { return; }
 if (attrValue) { attrValue = cleanAttributeValue(tag, attrName, attrValue, options, attrs); }
 if (options.removeEmptyAttributes && canDeleteEmptyAttribute(tag, attrName, attrValue, options)) { return; }
 if (options.decodeEntities && attrValue) { attrValue = attrValue.replace(/&(#?[0-9a-zA-Z]+;)/g, '&amp;$1'); }
 return { attr: attr, name: attrName, value: attrValue };}
function buildAttr(normalized, hasUnarySlash, options, isLast, uidAttr) { var attrName = normalized.name, attrValue = normalized.value, attr = normalized.attr, attrQuote = attr.quote, attrFragment, emittedAttrValue;
 if (typeof attrValue !== 'undefined' && (!options.removeAttributeQuotes || ~attrValue.indexOf(uidAttr) || !canRemoveAttributeQuotes(attrValue))) { if (!options.preventAttributesEscaping) { if (typeof options.quoteCharacter === 'undefined') { var apos = (attrValue.match(/'/g) || []).length; var quot = (attrValue.match(/"/g) || []).length; attrQuote = apos < quot ? '\'' : '"'; } else { attrQuote = options.quoteCharacter === '\'' ? '\'' : '"'; } if (attrQuote === '"') { attrValue = attrValue.replace(/"/g, '&#34;'); } else { attrValue = attrValue.replace(/'/g, '&#39;'); } } emittedAttrValue = attrQuote + attrValue + attrQuote; if (!isLast && !options.removeTagWhitespace) { emittedAttrValue += ' '; } } // make sure trailing slash is not interpreted as HTML self-closing tag else if (isLast && !hasUnarySlash && !/\/$/.test(attrValue)) { emittedAttrValue = attrValue; } else { emittedAttrValue = attrValue + ' '; }
 if (typeof attrValue === 'undefined' || options.collapseBooleanAttributes && isBooleanAttribute(attrName.toLowerCase(), attrValue.toLowerCase())) { attrFragment = attrName; if (!isLast) { attrFragment += ' '; } } else { attrFragment = attrName + attr.customAssign + emittedAttrValue; }
 return attr.customOpen + attrFragment + attr.customClose;}
function identity(value) { return value;}
function processOptions(values) { var options = { name: function(name) { return name.toLowerCase(); }, canCollapseWhitespace: canCollapseWhitespace, canTrimWhitespace: canTrimWhitespace, html5: true, ignoreCustomComments: [/^!/], ignoreCustomFragments: [ /<%[\s\S]\*?%>/, /<\?[\s\S]\*?\?>/ ], includeAutoGeneratedTags: true, log: identity, minifyCSS: identity, minifyJS: identity, minifyURLs: identity }; Object.keys(values).forEach(function(key) { var value = values[key]; if (key === 'caseSensitive') { if (value) { options.name = identity; } } else if (key === 'log') { if (typeof value === 'function') { options.log = value; } } else if (key === 'minifyCSS' && typeof value !== 'function') { if (!value) { return; } if (typeof value !== 'object') { value = {}; } options.minifyCSS = function(text, type) { text = text.replace(/(url\s\*\(\s\*)("|'|)(.\*?)\2(\s\*\))/ig, function(match, prefix, quote, url, suffix) { return prefix + quote + options.minifyURLs(url) + quote + suffix; }); var cleanCssOutput = new CleanCSS(value).minify(wrapCSS(text, type)); if (cleanCssOutput.errors.length > 0) { cleanCssOutput.errors.forEach(options.log); return text; } return unwrapCSS(cleanCssOutput.styles, type); }; } else if (key === 'minifyJS' && typeof value !== 'function') { if (!value) { return; } if (typeof value !== 'object') { value = {}; } (value.parse || (value.parse = {})).bare\_returns = false; options.minifyJS = function(text, inline) { var start = text.match(/^\s\*<!--.\*/); var code = start ? text.slice(start[0].length).replace(/\n\s\*-->\s\*$/, '') : text; value.parse.bare\_returns = inline; var result = UglifyJS.minify(code, value); if (result.error) { options.log(result.error); return text; } return result.code.replace(/;$/, ''); }; } else if (key === 'minifyURLs' && typeof value !== 'function') { if (!value) { return; } if (typeof value === 'string') { value = { site: value }; } else if (typeof value !== 'object') { value = {}; } options.minifyURLs = function(text) { try { return RelateUrl.relate(text, value); } catch (err) { options.log(err); return text; } }; } else { options[key] = value; } }); return options;}
function uniqueId(value) { var id; do { id = Math.random().toString(36).replace(/^0\.[0-9]\*/, ''); } while (~value.indexOf(id)); return id;}
var specialContentTags = createMapFromString('script,style');
function createSortFns(value, options, uidIgnore, uidAttr) { var attrChains = options.sortAttributes && Object.create(null); var classChain = options.sortClassName && new TokenChain();
 function attrNames(attrs) { return attrs.map(function(attr) { return options.name(attr.name); }); }
 function shouldSkipUID(token, uid) { return !uid || token.indexOf(uid) === -1; }
 function shouldSkipUIDs(token) { return shouldSkipUID(token, uidIgnore) && shouldSkipUID(token, uidAttr); }
 function scan(input) { var currentTag, currentType; new HTMLParser(input, { start: function(tag, attrs) { if (attrChains) { if (!attrChains[tag]) { attrChains[tag] = new TokenChain(); } attrChains[tag].add(attrNames(attrs).filter(shouldSkipUIDs)); } for (var i = 0, len = attrs.length; i < len; i++) { var attr = attrs[i]; if (classChain && attr.value && options.name(attr.name) === 'class') { classChain.add(trimWhitespace(attr.value).split(/[ \t\n\f\r]+/).filter(shouldSkipUIDs)); } else if (options.processScripts && attr.name.toLowerCase() === 'type') { currentTag = tag; currentType = attr.value; } } }, end: function() { currentTag = ''; }, chars: function(text) { if (options.processScripts && specialContentTags(currentTag) && options.processScripts.indexOf(currentType) > -1) { scan(text); } } }); }
 var log = options.log; options.log = identity; options.sortAttributes = false; options.sortClassName = false; scan(minify(value, options)); options.log = log; if (attrChains) { var attrSorters = Object.create(null); for (var tag in attrChains) { attrSorters[tag] = attrChains[tag].createSorter(); } options.sortAttributes = function(tag, attrs) { var sorter = attrSorters[tag]; if (sorter) { var attrMap = Object.create(null); var names = attrNames(attrs); names.forEach(function(name, index) { (attrMap[name] || (attrMap[name] = [])).push(attrs[index]); }); sorter.sort(names).forEach(function(name, index) { attrs[index] = attrMap[name].shift(); }); } }; } if (classChain) { var sorter = classChain.createSorter(); options.sortClassName = function(value) { return sorter.sort(value.split(/[ \n\f\r]+/)).join(' '); }; }}
function minify(value, options, partialMarkup) { if (options.collapseWhitespace) { value = collapseWhitespace(value, options, true, true); }
 var buffer = [], charsPrevTag, currentChars = '', hasChars, currentTag = '', currentAttrs = [], stackNoTrimWhitespace = [], stackNoCollapseWhitespace = [], optionalStartTag = '', optionalEndTag = '', ignoredMarkupChunks = [], ignoredCustomMarkupChunks = [], uidIgnore, uidAttr, uidPattern;
 // temporarily replace ignored chunks with comments, // so that we don't have to worry what's there. // for all we care there might be // completely-horribly-broken-alien-non-html-emoj-cthulhu-filled content value = value.replace(/<!-- htmlmin:ignore -->([\s\S]\*?)<!-- htmlmin:ignore -->/g, function(match, group1) { if (!uidIgnore) { uidIgnore = uniqueId(value); var pattern = new RegExp('^' + uidIgnore + '([0-9]+)$'); if (options.ignoreCustomComments) { options.ignoreCustomComments = options.ignoreCustomComments.slice(); } else { options.ignoreCustomComments = []; } options.ignoreCustomComments.push(pattern); } var token = '<!--' + uidIgnore + ignoredMarkupChunks.length + '-->'; ignoredMarkupChunks.push(group1); return token; });
 var customFragments = options.ignoreCustomFragments.map(function(re) { return re.source; }); if (customFragments.length) { var reCustomIgnore = new RegExp('\\s\*(?:' + customFragments.join('|') + ')+\\s\*', 'g'); // temporarily replace custom ignored fragments with unique attributes value = value.replace(reCustomIgnore, function(match) { if (!uidAttr) { uidAttr = uniqueId(value); uidPattern = new RegExp('(\\s\*)' + uidAttr + '([0-9]+)' + uidAttr + '(\\s\*)', 'g'); if (options.minifyCSS) { options.minifyCSS = (function(fn) { return function(text, type) { text = text.replace(uidPattern, function(match, prefix, index) { var chunks = ignoredCustomMarkupChunks[+index]; return chunks[1] + uidAttr + index + uidAttr + chunks[2]; }); var ids = []; new CleanCSS().minify(wrapCSS(text, type)).warnings.forEach(function(warning) { var match = uidPattern.exec(warning); if (match) { var id = uidAttr + match[2] + uidAttr; text = text.replace(id, ignoreCSS(id)); ids.push(id); } }); text = fn(text, type); ids.forEach(function(id) { text = text.replace(ignoreCSS(id), id); }); return text; }; })(options.minifyCSS); } if (options.minifyJS) { options.minifyJS = (function(fn) { return function(text, type) { return fn(text.replace(uidPattern, function(match, prefix, index) { var chunks = ignoredCustomMarkupChunks[+index]; return chunks[1] + uidAttr + index + uidAttr + chunks[2]; }), type); }; })(options.minifyJS); } } var token = uidAttr + ignoredCustomMarkupChunks.length + uidAttr; ignoredCustomMarkupChunks.push(/^(\s\*)[\s\S]\*?(\s\*)$/.exec(match)); return '\t' + token + '\t'; }); }
 if (options.sortAttributes && typeof options.sortAttributes !== 'function' || options.sortClassName && typeof options.sortClassName !== 'function') { createSortFns(value, options, uidIgnore, uidAttr); }
 function \_canCollapseWhitespace(tag, attrs) { return options.canCollapseWhitespace(tag, attrs, canCollapseWhitespace); }
 function \_canTrimWhitespace(tag, attrs) { return options.canTrimWhitespace(tag, attrs, canTrimWhitespace); }
 function removeStartTag() { var index = buffer.length - 1; while (index > 0 && !/^<[^/!]/.test(buffer[index])) { index--; } buffer.length = Math.max(0, index); }
 function removeEndTag() { var index = buffer.length - 1; while (index > 0 && !/^<\//.test(buffer[index])) { index--; } buffer.length = Math.max(0, index); }
 // look for trailing whitespaces, bypass any inline tags function trimTrailingWhitespace(index, nextTag) { for (var endTag = null; index >= 0 && \_canTrimWhitespace(endTag); index--) { var str = buffer[index]; var match = str.match(/^<\/([\w:-]+)>$/); if (match) { endTag = match[1]; } else if (/>$/.test(str) || (buffer[index] = collapseWhitespaceSmart(str, null, nextTag, options))) { break; } } }
 // look for trailing whitespaces from previously processed text // which may not be trimmed due to a following comment or an empty // element which has now been removed function squashTrailingWhitespace(nextTag) { var charsIndex = buffer.length - 1; if (buffer.length > 1) { var item = buffer[buffer.length - 1]; if (/^(?:<!|$)/.test(item) && item.indexOf(uidIgnore) === -1) { charsIndex--; } } trimTrailingWhitespace(charsIndex, nextTag); }
 new HTMLParser(value, { partialMarkup: partialMarkup, continueOnParseError: options.continueOnParseError, customAttrAssign: options.customAttrAssign, customAttrSurround: options.customAttrSurround, html5: options.html5,
 start: function(tag, attrs, unary, unarySlash, autoGenerated) { if (tag.toLowerCase() === 'svg') { options = Object.create(options); options.caseSensitive = true; options.keepClosingSlash = true; options.name = identity; } tag = options.name(tag); currentTag = tag; charsPrevTag = tag; if (!inlineTextTags(tag)) { currentChars = ''; } hasChars = false;[View remainder of file in raw view](https://github.com/kangax/html-minifier/raw/51ce10f4daedb1de483ffbcccecc41be1c873da2/src/htmlminifier.js)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_00ed070f_20250108_145339.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-pfq8-rq6v-vf5m)

**CVE-2022-37620**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-pfq8-rq6v-vf5m)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [GitHub Reviewed](/advisories?query=type%3Areviewed)
3. [CVE-2022-37620](/advisories/GHSA-pfq8-rq6v-vf5m)

## kangax html-minifier REDoS vulnerability

High severity

GitHub Reviewed

Published
Oct 31, 2022
to the GitHub Advisory Database
•
Updated Nov 4, 2024

[Vulnerability details](/advisories/GHSA-pfq8-rq6v-vf5m)
[Dependabot alerts
0](/advisories/GHSA-pfq8-rq6v-vf5m/dependabot)

## Package

npm

html-minifier
([npm](/advisories?query=ecosystem%3Anpm))

## Affected versions

<= 4.0.0

## Patched versions

None

## Description

A Regular Expression Denial of Service (ReDoS) flaw was found in kangax html-minifier 4.0.0 via the candidate variable in htmlminifier.js.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2022-37620>
* [kangax/html-minifier#1135](https://github.com/kangax/html-minifier/issues/1135)
* <https://github.com/kangax/html-minifier/blob/51ce10f4daedb1de483ffbcccecc41be1c873da2/src/htmlminifier.js#L1338>
* <https://github.com/kangax/html-minifier/blob/51ce10f4daedb1de483ffbcccecc41be1c873da2/src/htmlminifier.js#L294>

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2022-37620)
Oct 31, 2022

Published to the GitHub Advisory Database
Oct 31, 2022

Reviewed
Apr 22, 2024

Last updated
Nov 4, 2024

### Severity

High

8.7

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v4 base metrics

##### Exploitability Metrics

Attack Vector
Network

Attack Complexity
Low

Attack Requirements
None

Privileges Required
None

User interaction
None
##### Vulnerable System Impact Metrics

Confidentiality
None

Integrity
None

Availability
High
##### Subsequent System Impact Metrics

Confidentiality
None

Integrity
None

Availability
None

Learn more about base metrics

# CVSS v4 base metrics

##### Exploitability Metrics

Attack Vector:
This metric reflects the context by which vulnerability exploitation is possible. This metric value (and consequently the resulting severity) will be larger the more remote (logically, and physically) an attacker can be in order to exploit the vulnerable system. The assumption is that the number of potential attackers for a vulnerability that could be exploited from across a network is larger than the number of potential attackers that could exploit a vulnerability requiring physical access to a device, and therefore warrants a greater severity.

Attack Complexity:
This metric captures measurable actions that must be taken by the attacker to actively evade or circumvent existing built-in security-enhancing conditions in order to obtain a working exploit. These are conditions whose primary purpose is to increase security and/or increase exploit engineering complexity. A vulnerability exploitable without a target-specific variable has a lower complexity than a vulnerability that would require non-trivial customization. This metric is meant to capture security mechanisms utilized by the vulnerable system.

Attack Requirements:
This metric captures the prerequisite deployment and execution conditions or variables of the vulnerable system that enable the attack. These differ from security-enhancing techniques/technologies (ref Attack Complexity) as the primary purpose of these conditions is not to explicitly mitigate attacks, but rather, emerge naturally as a consequence of the deployment and execution of the vulnerable system.

Privileges Required:
This metric describes the level of privileges an attacker must possess prior to successfully exploiting the vulnerability. The method by which the attacker obtains privileged credentials prior to the attack (e.g., free trial accounts), is outside the scope of this metric. Generally, self-service provisioned accounts do not constitute a privilege requirement if the attacker can grant themselves privileges as part of the attack.

User interaction:
This metric captures the requirement for a human user, other than the attacker, to participate in the successful compromise of the vulnerable system. This metric determines whether the vulnerability can be exploited solely at the will of the attacker, or whether a separate user (or user-initiated process) must participate in some manner.
##### Vulnerable System Impact Metrics

Confidentiality:
This metric measures the impact to the confidentiality of the information managed by the VULNERABLE SYSTEM due to a successfully exploited vulnerability. Confidentiality refers to limiting information access and disclosure to only authorized users, as well as preventing access by, or disclosure to, unauthorized ones.

Integrity:
This metric measures the impact to integrity of a successfully exploited vulnerability. Integrity refers to the trustworthiness and veracity of information. Integrity of the VULNERABLE SYSTEM is impacted when an attacker makes unauthorized modification of system data. Integrity is also impacted when a system user can repudiate critical actions taken in the context of the system (e.g. due to insufficient logging).

Availability:
This metric measures the impact to the availability of the VULNERABLE SYSTEM resulting from a successfully exploited vulnerability. While the Confidentiality and Integrity impact metrics apply to the loss of confidentiality or integrity of data (e.g., information, files) used by the system, this metric refers to the loss of availability of the impacted system itself, such as a networked service (e.g., web, database, email). Since availability refers to the accessibility of information resources, attacks that consume network bandwidth, processor cycles, or disk space all impact the availability of a system.
##### Subsequent System Impact Metrics

Confidentiality:
This metric measures the impact to the confidentiality of the information managed by the SUBSEQUENT SYSTEM due to a successfully exploited vulnerability. Confidentiality refers to limiting information access and disclosure to only authorized users, as well as preventing access by, or disclosure to, unauthorized ones.

Integrity:
This metric measures the impact to integrity of a successfully exploited vulnerability. Integrity refers to the trustworthiness and veracity of information. Integrity of the SUBSEQUENT SYSTEM is impacted when an attacker makes unauthorized modification of system data. Integrity is also impacted when a system user can repudiate critical actions taken in the context of the system (e.g. due to insufficient logging).

Availability:
This metric measures the impact to the availability of the SUBSEQUENT SYSTEM resulting from a successfully exploited vulnerability. While the Confidentiality and Integrity impact metrics apply to the loss of confidentiality or integrity of data (e.g., information, files) used by the system, this metric refers to the loss of availability of the impacted system itself, such as a networked service (e.g., web, database, email). Since availability refers to the accessibility of information resources, attacks that consume network bandwidth, processor cycles, or disk space all impact the availability of a system.

 CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:N

### [EPSS score](https://www.first.org/epss/user-guide)

0.121%
 (47th percentile)

### Weaknesses

[CWE-400](/advisories?query=cwe%3A400) [CWE-1333](/advisories?query=cwe%3A1333)

### CVE ID

CVE-2022-37620

### GHSA ID

GHSA-pfq8-rq6v-vf5m

### Source code

[kangax/html-minifier](https://github.com/kangax/html-minifier)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-pfq8-rq6v-vf5m/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


