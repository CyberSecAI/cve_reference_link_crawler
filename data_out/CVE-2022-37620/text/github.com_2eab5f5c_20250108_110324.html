
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkangax%2Fhtml-minifier%2Fissues%2F1135)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkangax%2Fhtml-minifier%2Fissues%2F1135)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=kangax%2Fhtml-minifier)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[kangax](/kangax)
/
**[html-minifier](/kangax/html-minifier)**
Public

* [Notifications](/login?return_to=%2Fkangax%2Fhtml-minifier) You must be signed in to change notification settings
* [Fork
  576](/login?return_to=%2Fkangax%2Fhtml-minifier)
* [Star
   5k](/login?return_to=%2Fkangax%2Fhtml-minifier)

* [Code](/kangax/html-minifier)
* [Issues
  84](/kangax/html-minifier/issues)
* [Pull requests
  24](/kangax/html-minifier/pulls)
* [Actions](/kangax/html-minifier/actions)
* [Projects
  0](/kangax/html-minifier/projects)
* [Wiki](/kangax/html-minifier/wiki)
* [Security](/kangax/html-minifier/security)
* [Insights](/kangax/html-minifier/pulse)

Additional navigation options

* [Code](/kangax/html-minifier)
* [Issues](/kangax/html-minifier/issues)
* [Pull requests](/kangax/html-minifier/pulls)
* [Actions](/kangax/html-minifier/actions)
* [Projects](/kangax/html-minifier/projects)
* [Wiki](/kangax/html-minifier/wiki)
* [Security](/kangax/html-minifier/security)
* [Insights](/kangax/html-minifier/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fkangax%2Fhtml-minifier%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fkangax%2Fhtml-minifier%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# CVE-2022-37620/ ReDoS found in htmlminifier.js #1135

Open

[secdevlpr26](/secdevlpr26) opened this issue
Oct 27, 2022
¬∑ 17 comments

Open

# [CVE-2022-37620/ ReDoS found in htmlminifier.js](#top) #1135

[secdevlpr26](/secdevlpr26) opened this issue
Oct 27, 2022
¬∑ 17 comments

## Comments

[![@secdevlpr26](https://avatars.githubusercontent.com/u/31366114?s=80&v=4)](/secdevlpr26)

Copy link

### **[secdevlpr26](/secdevlpr26)** commented [Oct 27, 2022](#issue-1426086378)

| A Regular Expression Denial of Service (ReDoS) flaw was found in kangax html-minifier 4.0.0 via the candidate variable in htmlminifier.js. The ReDoS vulnerability can be mitigated with several best practices described here: [https://snyk.io/blog/redos-and-catastrophic-backtracking/] |
| --- |
| The text was updated successfully, but these errors were encountered: |

 üëç
23
 Harm-Nullix, verydevuser, pmilliotte, willieowens, michaeljauk, RubenStoesser, F21, kscharm, tuliogoiania, runderworld, and 13 more reacted with thumbs up emoji
 üëÄ
6
 tuliogoiania, derTobsch, LenoM, jgmontoya, gnuletik, and naweka reacted with eyes emoji

All reactions

* üëç
  23 reactions
* üëÄ
  6 reactions

[![@michaeljauk](https://avatars.githubusercontent.com/u/18634867?s=80&u=df3f79b67fb944942562114d30542118e10d5626&v=4)](/michaeljauk)

Copy link

### **[michaeljauk](/michaeljauk)** commented [Nov 18, 2022](#issuecomment-1320472797)

| Is anyone willing to work on this? |
| --- |

 üëç
7
 mashpie, ArielPrevu3D, qeleb, geiszla, LenoM, RMITBLOG, and aangindra reacted with thumbs up emoji
 üëé
3
 deepakparamesh, shihyuho, and pimane reacted with thumbs down emoji

All reactions

* üëç
  7 reactions
* üëé
  3 reactions

Sorry, something went wrong.

[![@PavelBurya](https://avatars.githubusercontent.com/u/119487303?s=40&v=4)](/PavelBurya)
[PavelBurya](/PavelBurya)
mentioned this issue
[Nov 30, 2022](#ref-issue-1469263305)

[High Severity Vulnerability in html-minifier
mjmlio/mjml#2589](/mjmlio/mjml/issues/2589)

Open

[![@runderworld](https://avatars.githubusercontent.com/u/2746021?s=40&v=4)](/runderworld)
[runderworld](/runderworld)
mentioned this issue
[Jan 17, 2023](#ref-issue-1484860742)

[SECURITY: CVE-2022-37620
#1137](/kangax/html-minifier/issues/1137)

Open

[![@nigel12341](https://avatars.githubusercontent.com/u/17668318?s=40&v=4)](/nigel12341)
[nigel12341](/nigel12341)
mentioned this issue
[Feb 5, 2023](#ref-issue-1571585529)

[CVE-2022-37620 vulnerabilities in html-minifier package
ItzDerock/discord-html-transcripts#110](/ItzDerock/discord-html-transcripts/issues/110)

Closed

[![@blv-raulcatalan](https://avatars.githubusercontent.com/u/121115460?s=80&u=788079feb5f2850f8622d8f427da8e95670ea5a2&v=4)](/blv-raulcatalan)

Copy link

### **[blv-raulcatalan](/blv-raulcatalan)** commented [Mar 14, 2023](#issuecomment-1468433085)

| Any update on this? |
| --- |

All reactions

Sorry, something went wrong.

[![@rquadling](https://avatars.githubusercontent.com/u/12801?s=40&v=4)](/rquadling)
[rquadling](/rquadling)
mentioned this issue
[Mar 22, 2023](#ref-issue-1635632507)

[Html-minifier 4.0.0 has security issues
rquadling/grunt-html2js#128](/rquadling/grunt-html2js/issues/128)

Closed

[![@rquadling](https://avatars.githubusercontent.com/u/12801?s=80&v=4)](/rquadling)

Copy link

### **[rquadling](/rquadling)** commented [Mar 22, 2023](#issuecomment-1479517432) ‚Ä¢ edited Loading

| One of the lines referred to be the CVE has the following regex `\s+([1-9][0-9]*w|[0-9]+(?:\.[0-9]+)?x)$`  Would changing it to `\s+([1-9][0-9]*w|[0-9]+(?:\.[0-9]+|)x)$` be enough?  `\s+([1-9][0-9]*w|[0-9]+(?=(\.[0-9]+|))\2x)$` is another way that should stop the backtracking (based this upon <https://snyk.io/blog/redos-and-catastrophic-backtracking/>. |
| --- |

 üëç
4
 pnesarajah, blv-raulcatalan, prajwalmr62, and Davilink reacted with thumbs up emoji

All reactions

* üëç
  4 reactions

Sorry, something went wrong.

[![@timbomckay](https://avatars.githubusercontent.com/u/784904?s=80&u=afd4d15c91497ceabdc261e72a2ed18cd2032823&v=4)](/timbomckay)

Copy link

### **[timbomckay](/timbomckay)** commented [Apr 10, 2023](#issuecomment-1502065386) ‚Ä¢ edited Loading

| I stumbled upon a fork of this maintained by terser: <https://www.npmjs.com/package/html-minifier-terser>  Probably the way to go. |
| --- |

 üëç
2
 abniry and sahksas reacted with thumbs up emoji
 ‚ù§Ô∏è
2
 karlhorky and sahksas reacted with heart emoji
 üöÄ
5
 Yilmazzn, GeekCornerGH, derTobsch, karlhorky, and aangindra reacted with rocket emoji
 üëÄ
1
 karlhorky reacted with eyes emoji

All reactions

* üëç
  2 reactions
* ‚ù§Ô∏è
  2 reactions
* üöÄ
  5 reactions
* üëÄ
  1 reaction

Sorry, something went wrong.

[![@timbomckay](https://avatars.githubusercontent.com/u/784904?s=40&u=afd4d15c91497ceabdc261e72a2ed18cd2032823&v=4)](/timbomckay)
[timbomckay](/timbomckay)
mentioned this issue
[Apr 10, 2023](#ref-issue-1661101613)

[Update to Terser to Resolve ReDoS Vulnerability
asyncLiz/minify-html-literals#52](/asyncLiz/minify-html-literals/issues/52)

Closed

[![@johnhunter](https://avatars.githubusercontent.com/u/219160?s=40&v=4)](/johnhunter)
[johnhunter](/johnhunter)
mentioned this issue
[Jun 5, 2023](#ref-issue-1741813209)

[Security vulnerability in dependency html-minifier@4.0.0
meszaros-lajos-gyorgy/express-minify-html-2#3](/meszaros-lajos-gyorgy/express-minify-html-2/issues/3)

Closed

[![@uWottM8](https://avatars.githubusercontent.com/u/50047569?s=40&v=4)](/uWottM8)
[uWottM8](/uWottM8)
mentioned this issue
[Jun 15, 2023](#ref-issue-1758185341)

[ReDoS found in htmlminifier.js
ankitskvmdam/clean-jsdoc-theme#222](/ankitskvmdam/clean-jsdoc-theme/issues/222)

Closed

[![@Raxvis](https://avatars.githubusercontent.com/u/2748262?s=40&v=4)](/Raxvis)
[Raxvis](/Raxvis)
mentioned this issue
[Aug 8, 2023](#ref-issue-1841842745)

[Update to Terser to Resolve ReDoS Vulnerability
mjmlio/mjml#2722](/mjmlio/mjml/issues/2722)

Closed

[![@kevbarns](https://avatars.githubusercontent.com/u/22106329?s=40&v=4)](/kevbarns)
[kevbarns](/kevbarns)
mentioned this issue
[Jan 8, 2024](#ref-issue-2070195672)

[CVE-2022-37620 & switch to htmlnano
mjmlio/mjml#2802](/mjmlio/mjml/issues/2802)

Open

[![@TomaszG](https://avatars.githubusercontent.com/u/873114?s=40&v=4)](/TomaszG)
[TomaszG](/TomaszG)
mentioned this issue
[Jan 12, 2024](#ref-issue-2078344502)

[#CVE-2022-37620 in 1.10.3 (html-minifier@4.0.0 dependency)
nest-modules/mailer#1092](/nest-modules/mailer/issues/1092)

Closed

[curbengh](/curbengh)
added a commit
to curbengh/hexo-yam
that referenced
this issue
[Jan 28, 2024](#ref-commit-0bee9ad)
[![@curbengh](https://avatars.githubusercontent.com/u/43627182?s=40&u=28d137ff4797da597992f17376002619e80e32f5&v=4)](/curbengh)

`[refactor: switch html-minifier to html-minifier-terser](/curbengh/hexo-yam/commit/0bee9ada0efdf81aa8abd4fe192865c8614259be "refactor: switch html-minifier to html-minifier-terser

https://github.com/kangax/html-minifier/issues/1135")`
‚Ä¶

`[0bee9ad](/curbengh/hexo-yam/commit/0bee9ada0efdf81aa8abd4fe192865c8614259be)`

```
[kangax/html-minifier#1135](https://github.com/kangax/html-minifier/issues/1135)
```

[![@curbengh](https://avatars.githubusercontent.com/u/43627182?s=40&u=28d137ff4797da597992f17376002619e80e32f5&v=4)](/curbengh)
[curbengh](/curbengh)
mentioned this issue
[Jan 28, 2024](#ref-pullrequest-2104092815)

[refactor: switch html-minifier to html-minifier-terser
curbengh/hexo-yam#152](/curbengh/hexo-yam/pull/152)
 Merged

[![@daniluk4000](https://avatars.githubusercontent.com/u/10450717?s=40&v=4)](/daniluk4000)
[daniluk4000](/daniluk4000)
mentioned this issue
[Apr 23, 2024](#ref-issue-2259158935)

[Use html-minifier-terser instead of html-minifier for @nuxt/generator
nuxt/nuxt#26911](/nuxt/nuxt/issues/26911)

Closed

[![@zanodor](https://avatars.githubusercontent.com/u/110669301?s=40&v=4)](/zanodor)
[zanodor](/zanodor)
mentioned this issue
[Apr 23, 2024](#ref-issue-2259452392)

[404 Error on Index/Home file - Digital Garden Inaccessible
oleeskild/obsidian-digital-garden#583](/oleeskild/obsidian-digital-garden/issues/583)

Closed

[![@ynotdraw](https://avatars.githubusercontent.com/u/8069555?s=40&v=4)](/ynotdraw)
[ynotdraw](/ynotdraw)
mentioned this issue
[Apr 23, 2024](#ref-issue-2259578583)

[CVE-2022-37620: High Vulnerability with html-minifier
asyncLiz/minify-html-literals#56](/asyncLiz/minify-html-literals/issues/56)

Closed

[![@thewilkybarkid](https://avatars.githubusercontent.com/u/1784740?s=40&v=4)](/thewilkybarkid)
[thewilkybarkid](/thewilkybarkid)
mentioned this issue
[Apr 25, 2024](#ref-issue-2259212047)

[Dependency: html-minifier REDoS vulnerability
mjmlio/mjml#2856](/mjmlio/mjml/issues/2856)

Closed

[![@mashpie](https://avatars.githubusercontent.com/u/118508?s=40&v=4)](/mashpie)
[mashpie](/mashpie)
mentioned this issue
[Apr 28, 2024](#ref-issue-2267429847)

[CVE-2022-37620
uscreen/postal-mailer#79](/uscreen/postal-mailer/issues/79)

Open

[LeonEck](/LeonEck)
added a commit
to LeonEck/eck-autocomplete
that referenced
this issue
[Apr 30, 2024](#ref-commit-e37c869)
[![@LeonEck](https://avatars.githubusercontent.com/u/7900913?s=40&u=5c039444d41a6ab0c1210408c508959f85d0ba5a&v=4)](/LeonEck)

`[chore: ü§ñ replace html-minifier with html-minifier-terser](/LeonEck/eck-autocomplete/commit/e37c869142426c0b869d2ed80f82604952244298 "chore: ü§ñ replace html-minifier with html-minifier-terser

https://github.com/kangax/html-minifier/issues/1135#issuecomment-1502065386")`
‚Ä¶

`[e37c869](/LeonEck/eck-autocomplete/commit/e37c869142426c0b869d2ed80f82604952244298)`

```
[kangax/html-minifier#1135 (comment)](https://github.com/kangax/html-minifier/issues/1135#issuecomment-1502065386)
```

[![@littleblack111](https://avatars.githubusercontent.com/u/97672521?s=80&v=4)](/littleblack111)

Copy link

### **[littleblack111](/littleblack111)** commented [May 14, 2024](#issuecomment-2109347024)

| any updates? |
| --- |

All reactions

Sorry, something went wrong.

[![@timbomckay](https://avatars.githubusercontent.com/u/784904?s=80&u=afd4d15c91497ceabdc261e72a2ed18cd2032823&v=4)](/timbomckay)

Copy link

### **[timbomckay](/timbomckay)** commented [May 14, 2024](#issuecomment-2110516434)

| any updates?  [@littleblack111](https://github.com/littleblack111) as [mentioned above](https://github.com/kangax/html-minifier/issues/1135#issuecomment-1502065386), along with the slew of references to others switching, [html-minifier-terser](https://www.npmjs.com/package/html-minifier-terser) is probably the best solution. Aside from some repo adjustments this solution appears to be fairly abandoned, especially since the [package hasn't been updated in 5 years](https://www.npmjs.com/package/html-minifier), while `html-minified-terser` is maintained by [Terser](https://terser.org). |
| --- |

 üëç
1
 rquadling reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@rquadling](https://avatars.githubusercontent.com/u/12801?s=80&v=4)](/rquadling)

Copy link

### **[rquadling](/rquadling)** commented [May 14, 2024](#issuecomment-2110717300)

| Now I've just got to remember what project I'm involved in that has this one as an issue! |
| --- |

 üòÑ
1
 timbomckay reacted with laugh emoji

All reactions

* üòÑ
  1 reaction

Sorry, something went wrong.

[![@mattboll](https://avatars.githubusercontent.com/u/1690167?s=40&v=4)](/mattboll)
[mattboll](/mattboll)
mentioned this issue
[May 15, 2024](#ref-issue-2261709488)

[html-minifier high security vulnerability
antfu-collective/vite-ssg#397](/antfu-collective/vite-ssg/issues/397)

Open

[![@Hessah95](https://avatars.githubusercontent.com/u/53401891?s=80&u=78c84e88500234779863f817cedd876e001f8444&v=4)](/Hessah95)

Copy link

### **[Hessah95](/Hessah95)** commented [May 15, 2024](#issuecomment-2112287792)

| any update on this issue? |
| --- |

 üëç
2
 LenoM and ina-lieder reacted with thumbs up emoji

All reactions

* üëç
  2 reactions

Sorry, something went wrong.

[![@timbomckay](https://avatars.githubusercontent.com/u/784904?s=80&u=afd4d15c91497ceabdc261e72a2ed18cd2032823&v=4)](/timbomckay)

Copy link

### **[timbomckay](/timbomckay)** commented [May 15, 2024](#issuecomment-2112483149)

| any update on this issue?  [@Hessah95](https://github.com/Hessah95) The comments in this thread point to another solution that's maintained. |
| --- |

All reactions

Sorry, something went wrong.

[![@Tpleme](https://avatars.githubusercontent.com/u/72796924?s=40&v=4)](/Tpleme)
[Tpleme](/Tpleme)
mentioned this issue
[Jul 17, 2024](#ref-issue-2413095438)

[[Bug] html-minifier high severity vulnerability
Thomascogez/nodemailer-mjml#268](/Thomascogez/nodemailer-mjml/issues/268)

Closed

[![@GeekyEggo](https://avatars.githubusercontent.com/u/1429781?s=40&v=4)](/GeekyEggo)
[GeekyEggo](/GeekyEggo)
mentioned this issue
[Aug 13, 2024](#ref-pullrequest-2463762624)

[fix(deps)!: switch to html-minifier-terser to address CVE-2022-37620 (fix #52, fix #56)
asyncLiz/minify-html-literals#57](/asyncLiz/minify-html-literals/pull/57)
 Merged

[![@cooljeanius](https://avatars.githubusercontent.com/u/1388660?s=40&v=4)](/cooljeanius)
[cooljeanius](/cooljeanius)
mentioned this issue
[Aug 17, 2024](#ref-issue-2471325927)

[Dependencies: switch from html-minifier to html-minifier-terser
kheina-com/Blue-Blocker#323](/kheina-com/Blue-Blocker/issues/323)

Closed

[![@borrelm](https://avatars.githubusercontent.com/u/118467327?s=40&v=4)](/borrelm)
[borrelm](/borrelm)
mentioned this issue
[Sep 4, 2024](#ref-issue-2505185965)

[Vulnerability : CVE-2022-37620
terser/html-minifier-terser#182](/terser/html-minifier-terser/issues/182)

Open

[![@AdrianKokot](https://avatars.githubusercontent.com/u/35179235?s=40&v=4)](/AdrianKokot)
[AdrianKokot](/AdrianKokot)
mentioned this issue
[Sep 13, 2024](#ref-issue-2524418518)

[[Bug] html-minifier vulnerability
ng-doc/ng-doc#206](/ng-doc/ng-doc/issues/206)

Closed

[![@mreishus](https://avatars.githubusercontent.com/u/937354?s=40&v=4)](/mreishus)
[mreishus](/mreishus)
mentioned this issue
[Sep 16, 2024](#ref-pullrequest-2529188064)

[replace html-minifier 4.0.0 with html-minifier-terser 7.2.0
Automattic/minifiers#34](/Automattic/minifiers/pull/34)
 Merged

[![@ra-dave](https://avatars.githubusercontent.com/u/24297299?s=80&v=4)](/ra-dave)

Copy link

### **[ra-dave](/ra-dave)** commented [Oct 6, 2024](#issuecomment-2395358744) ‚Ä¢ edited Loading

| html-minifier-terser latest version (7.2.0) still has the vulnerability? I just installed it and it says so. |
| --- |

 üëç
1
 sidewayss reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@laurielim](https://avatars.githubusercontent.com/u/62180225?s=40&v=4)](/laurielim)
[laurielim](/laurielim)
mentioned this issue
[Oct 11, 2024](#ref-pullrequest-2582219147)

[Release 12.10.2024
laurielim/laurielim.github.io#20](/laurielim/laurielim.github.io/pull/20)
 Merged

[![@jonathan-durbin](https://avatars.githubusercontent.com/u/31511197?s=40&v=4)](/jonathan-durbin)
[jonathan-durbin](/jonathan-durbin)
mentioned this issue
[Oct 17, 2024](#ref-issue-2546238538)

[NPM Vulnerabilities
CodeStitchOfficial/Intermediate-Website-Kit-LESS#9](/CodeStitchOfficial/Intermediate-Website-Kit-LESS/issues/9)

Open

[![@marcoandre1](https://avatars.githubusercontent.com/u/31892221?s=40&u=93bf36a8ccedfee907670d7d8ee450924aaf4d47&v=4)](/marcoandre1)
[marcoandre1](/marcoandre1)
mentioned this issue
[Oct 19, 2024](#ref-issue-2598679884)

[Update html-minifier
marcoandre1/react-snap#22](/marcoandre1/react-snap/issues/22)

Closed

[![@marcoandre1](https://avatars.githubusercontent.com/u/31892221?s=80&u=93bf36a8ccedfee907670d7d8ee450924aaf4d47&v=4)](/marcoandre1)

Copy link

### **[marcoandre1](/marcoandre1)** commented [Oct 19, 2024](#issuecomment-2423568084)

| [@ra-dave](https://github.com/ra-dave) I first installed version 7.2.0 as well, but it broke my unit tests. I then went for version 5.1.1 which keeps my unit tests passing and it made the vulnerability go away. Of course, this only works if you don‚Äôt need the newest version. |
| --- |

All reactions

Sorry, something went wrong.

[![@DanielRuf](https://avatars.githubusercontent.com/u/827205?s=80&u=fa946f3ab4b4bdd2c7274a99715064519ed2c57c&v=4)](/DanielRuf)

Copy link

### **[DanielRuf](/DanielRuf)** commented [Nov 2, 2024](#issuecomment-2452952695) ‚Ä¢ edited Loading

| Can anyone provide a working proof of concept that confirms the issue can be actively exploited?  Also what would be the definitive solution here? |
| --- |

 üëÄ
1
 yusancky reacted with eyes emoji

All reactions

* üëÄ
  1 reaction

Sorry, something went wrong.

[![@DanielRuf](https://avatars.githubusercontent.com/u/827205?s=80&u=fa946f3ab4b4bdd2c7274a99715064519ed2c57c&v=4)](/DanielRuf)

Copy link

### **[DanielRuf](/DanielRuf)** commented [Nov 3, 2024](#issuecomment-2453388023) ‚Ä¢ edited Loading

| It seems the CVE record differs from <https://security.snyk.io/vuln/SNYK-JS-HTMLMINIFIER-3091181>, which contains more details.  Not sure why this is the case. I will clarify with Snyk.  Edit: the `candidate` variable is not even used here, because the relevant code branch for srcset (`else if (isSrcset(attrName, tag)) {`) is not even executed in the PoC.  It seems the CVE description is more than misleading, at best incomplete and inaccurate. |
| --- |

All reactions

Sorry, something went wrong.

[![@DanielRuf](https://avatars.githubusercontent.com/u/827205?s=80&u=fa946f3ab4b4bdd2c7274a99715064519ed2c57c&v=4)](/DanielRuf)

Copy link

### **[DanielRuf](/DanielRuf)** commented [Nov 3, 2024](#issuecomment-2453405484) ‚Ä¢ edited Loading

| It seems the PoC is more complex than needed.  The code basically makes not much sense: `minify(attrName = '\t'.repeat(547703) + '.\t1x', tag = '\t'.repeat(547703) + '.\t1x' )`  It should be probably this:  `minify('\t'.repeat(547703) + '.\t1x', '\t'.repeat(547703) + '.\t1x' )`  Because the `minify` function has the following signature: `exports.minify = function(value, options) {`  The `options` parameter does not have an impact. Because when I leave the second parameter undefined, then `time node test.js` gives the same duration.  So the following PoC code is sufficient: `result = minify('\t'.repeat(54770) + '.\t1x' )`  The issue is in the following code part:  ```   var customFragments = options.ignoreCustomFragments.map(function(re) {     return re.source;   });   if (customFragments.length) {     var reCustomIgnore = new RegExp('\\s*(?:' + customFragments.join('|') + ')+\\s*', 'g');     // temporarily replace custom ignored fragments with unique attributes     value = value.replace(reCustomIgnore, function(match) {       if (!uidAttr) {         uidAttr = uniqueId(value);         uidPattern = new RegExp('(\\s*)' + uidAttr + '([0-9]+)' + uidAttr + '(\\s*)', 'g');         if (options.minifyCSS) {           options.minifyCSS = (function(fn) {             return function(text, type) {               text = text.replace(uidPattern, function(match, prefix, index) {                 var chunks = ignoredCustomMarkupChunks[+index];                 return chunks[1] + uidAttr + index + uidAttr + chunks[2];               });               var ids = [];               new CleanCSS().minify(wrapCSS(text, type)).warnings.forEach(function(warning) {                 var match = uidPattern.exec(warning);                 if (match) {                   var id = uidAttr + match[2] + uidAttr;                   text = text.replace(id, ignoreCSS(id));                   ids.push(id);                 }               });               text = fn(text, type);               ids.forEach(function(id) {                 text = text.replace(ignoreCSS(id), id);               });               return text;             };           })(options.minifyCSS);         }         if (options.minifyJS) {           options.minifyJS = (function(fn) {             return function(text, type) {               return fn(text.replace(uidPattern, function(match, prefix, index) {                 var chunks = ignoredCustomMarkupChunks[+index];                 return chunks[1] + uidAttr + index + uidAttr + chunks[2];               }), type);             };           })(options.minifyJS);         }       }       var token = uidAttr + ignoredCustomMarkupChunks.length + uidAttr;       ignoredCustomMarkupChunks.push(/^(\s*)[\s\S]*?(\s*)$/.exec(match));       return '\t' + token + '\t';     });   } ```  After checking further, the following line is the problem:  `var reCustomIgnore = new RegExp('\\s*(?:' + customFragments.join('|') + ')+\\s*', 'g');` which results in the following by default: `var reCustomIgnore = new RegExp('\\s*(?:<%[\\s\\S]*?%>|<\\?[\\s\\S]*?\\?>)+\\s*', 'g');`  The person whou found the problem, probably used <https://devina.io/redos-checker>, which also uses the same type of attack string:  [image](https://private-user-images.githubusercontent.com/827205/382568077-a83eb487-3a2a-47a6-b183-6ca764bd5275.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzYzMzQ1MDMsIm5iZiI6MTczNjMzNDIwMywicGF0aCI6Ii84MjcyMDUvMzgyNTY4MDc3LWE4M2ViNDg3LTNhMmEtNDdhNi1iMTgzLTZjYTc2NGJkNTI3NS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTA4JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDEwOFQxMTAzMjNaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT02YmYyZTliNzA1ZTFlZDM2NjE5OGYzZGE2OTViMzY0MzQwODM1OGQ1MGZmNDU2YjM0ZmJlMDY3ZjdjZTQxZTBkJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.1_nqrF9TqZnrw-JX7bmTnIJd8LCPE4_ZhYm8GY_RiUM)  **The problem** usage of `*` and `+` in `reCustomIgnore` without any upper bounds (`{0,50}, {1,50}`), which leads to catastrophic backtracking.  **Migitations**   * set `options.ignoreCustomFragments = [];` - this may break some minifications * set a global timeout in your script, which should be done in general in production (applies to any programming language to prevent the consumption of too many resources and to mitigate DoS), see for example <https://www.nearform.com/insights/using-abortsignal-in-node-js/> |
| --- |

 üëç
1
 charsleysa reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@DanielRuf](https://avatars.githubusercontent.com/u/827205?s=80&u=fa946f3ab4b4bdd2c7274a99715064519ed2c57c&v=4)](/DanielRuf)

Copy link

### **[DanielRuf](/DanielRuf)** commented [Nov 3, 2024](#issuecomment-2453437884)

| For anyone asking, **html-minifier-terser is also affected**. So switching to it will not resolve this. You will just get less reported CVEs but you will also have a false-negative then. |
| --- |

 üëç
3
 sidewayss, mashpie, and charsleysa reacted with thumbs up emoji

All reactions

* üëç
  3 reactions

Sorry, something went wrong.

[![@sidewayss](https://avatars.githubusercontent.com/u/15235202?s=80&v=4)](/sidewayss)

Copy link

### **[sidewayss](/sidewayss)** commented [Nov 3, 2024](#issuecomment-2453463626)

| And of course it affects all the other downstream packages, including these:   * **gulp-htmlmin** * **gulp-html-minifier-terser** * **gulp-htmlclean** |
| --- |

All reactions

Sorry, something went wrong.

[![@DanielRuf](https://avatars.githubusercontent.com/u/827205?s=40&u=fa946f3ab4b4bdd2c7274a99715064519ed2c57c&v=4)](/DanielRuf)
[DanielRuf](/DanielRuf)
mentioned this issue
[Nov 3, 2024](#ref-pullrequest-2277206700)

[Move from html-minifier to html-minifier-terser
focus-shift/urlaubsverwaltung-landingpage#731](/focus-shift/urlaubsverwaltung-landingpage/pull/731)
 Merged

[DanielRuf](/DanielRuf)
referenced
this issue
in Samat-Imamov/html-minifier-fixed
[Nov 3, 2024](#ref-commit-023f72b)
[![@Samat-Imamov](https://avatars.githubusercontent.com/u/31497046?s=40&v=4)](/Samat-Imamov)

`[Fix for](/Samat-Imamov/html-minifier-fixed/commit/023f72beccd2e494f8f903b99f963ef29e232ec1 "Fix for CVE-2022-37620") [CVE-2022-37620](https://github.com/advisories/GHSA-pfq8-rq6v-vf5m "CVE-2022-37620")`

`[023f72b](/Samat-Imamov/html-minifier-fixed/commit/023f72beccd2e494f8f903b99f963ef29e232ec1)`

[![@ananzh](https://avatars.githubusercontent.com/u/79961084?s=80&u=b00cbc700d5dd440d66fd5b410294c9ab99add62&v=4)](/ananzh)

Copy link

### **[ananzh](/ananzh)** commented [Dec 4, 2024](#issuecomment-2518692447)

| Hi any updates on the plan to fix this? |
| --- |

 üëÄ
2
 yusancky and globalexport reacted with eyes emoji

All reactions

* üëÄ
  2 reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fkangax%2Fhtml-minifier%2Fissues%2F1135)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

12 participants

[![@rquadling](https://avatars.githubusercontent.com/u/12801?s=52&v=4)](/rquadling) [![@timbomckay](https://avatars.githubusercontent.com/u/784904?s=52&v=4)](/timbomckay) [![@DanielRuf](https://avatars.githubusercontent.com/u/827205?s=52&v=4)](/DanielRuf) [![@sidewayss](https://avatars.githubusercontent.com/u/15235202?s=52&v=4)](/sidewayss) [![@michaeljauk](https://avatars.githubusercontent.com/u/18634867?s=52&v=4)](/michaeljauk) [![@ra-dave](https://avatars.githubusercontent.com/u/24297299?s=52&v=4)](/ra-dave) [![@secdevlpr26](https://avatars.githubusercontent.com/u/31366114?s=52&v=4)](/secdevlpr26) [![@marcoandre1](https://avatars.githubusercontent.com/u/31892221?s=52&v=4)](/marcoandre1) [![@Hessah95](https://avatars.githubusercontent.com/u/53401891?s=52&v=4)](/Hessah95) [![@ananzh](https://avatars.githubusercontent.com/u/79961084?s=52&v=4)](/ananzh) [![@littleblack111](https://avatars.githubusercontent.com/u/97672521?s=52&v=4)](/littleblack111) [![@blv-raulcatalan](https://avatars.githubusercontent.com/u/121115460?s=52&v=4)](/blv-raulcatalan)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.

