
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCERTCC%2FCVE-2021-44228_scanner)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCERTCC%2FCVE-2021-44228_scanner)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=CERTCC%2FCVE-2021-44228_scanner)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on May 13, 2024. It is now read-only.

[CERTCC](/CERTCC)
/
**[CVE-2021-44228\_scanner](/CERTCC/CVE-2021-44228_scanner)**
Public archive

* [Notifications](/login?return_to=%2FCERTCC%2FCVE-2021-44228_scanner) You must be signed in to change notification settings
* [Fork
  87](/login?return_to=%2FCERTCC%2FCVE-2021-44228_scanner)
* [Star
   344](/login?return_to=%2FCERTCC%2FCVE-2021-44228_scanner)

Scanners for Jar files that may be vulnerable to CVE-2021-44228

### License

[BSD-2-Clause license](/CERTCC/CVE-2021-44228_scanner/blob/main/LICENSE.md)

[344
stars](/CERTCC/CVE-2021-44228_scanner/stargazers) [87
forks](/CERTCC/CVE-2021-44228_scanner/forks) [Branches](/CERTCC/CVE-2021-44228_scanner/branches) [Tags](/CERTCC/CVE-2021-44228_scanner/tags) [Activity](/CERTCC/CVE-2021-44228_scanner/activity)
 [Star](/login?return_to=%2FCERTCC%2FCVE-2021-44228_scanner)

 [Notifications](/login?return_to=%2FCERTCC%2FCVE-2021-44228_scanner) You must be signed in to change notification settings

* [Code](/CERTCC/CVE-2021-44228_scanner)
* [Issues
  0](/CERTCC/CVE-2021-44228_scanner/issues)
* [Pull requests
  0](/CERTCC/CVE-2021-44228_scanner/pulls)
* [Actions](/CERTCC/CVE-2021-44228_scanner/actions)
* [Projects
  0](/CERTCC/CVE-2021-44228_scanner/projects)
* [Security](/CERTCC/CVE-2021-44228_scanner/security)
* [Insights](/CERTCC/CVE-2021-44228_scanner/pulse)

Additional navigation options

* [Code](/CERTCC/CVE-2021-44228_scanner)
* [Issues](/CERTCC/CVE-2021-44228_scanner/issues)
* [Pull requests](/CERTCC/CVE-2021-44228_scanner/pulls)
* [Actions](/CERTCC/CVE-2021-44228_scanner/actions)
* [Projects](/CERTCC/CVE-2021-44228_scanner/projects)
* [Security](/CERTCC/CVE-2021-44228_scanner/security)
* [Insights](/CERTCC/CVE-2021-44228_scanner/pulse)

# CERTCC/CVE-2021-44228\_scanner

    main[Branches](/CERTCC/CVE-2021-44228_scanner/branches)[Tags](/CERTCC/CVE-2021-44228_scanner/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[78 Commits](/CERTCC/CVE-2021-44228_scanner/commits/main/) | | |
| [LICENSE.md](/CERTCC/CVE-2021-44228_scanner/blob/main/LICENSE.md "LICENSE.md") | | [LICENSE.md](/CERTCC/CVE-2021-44228_scanner/blob/main/LICENSE.md "LICENSE.md") |  |  |
| [README.md](/CERTCC/CVE-2021-44228_scanner/blob/main/README.md "README.md") | | [README.md](/CERTCC/CVE-2021-44228_scanner/blob/main/README.md "README.md") |  |  |
| [checkjndi.ps1](/CERTCC/CVE-2021-44228_scanner/blob/main/checkjndi.ps1 "checkjndi.ps1") | | [checkjndi.ps1](/CERTCC/CVE-2021-44228_scanner/blob/main/checkjndi.ps1 "checkjndi.ps1") |  |  |
| [checkjndi.py](/CERTCC/CVE-2021-44228_scanner/blob/main/checkjndi.py "checkjndi.py") | | [checkjndi.py](/CERTCC/CVE-2021-44228_scanner/blob/main/checkjndi.py "checkjndi.py") |  |  |
| [checkjndi.sh](/CERTCC/CVE-2021-44228_scanner/blob/main/checkjndi.sh "checkjndi.sh") | | [checkjndi.sh](/CERTCC/CVE-2021-44228_scanner/blob/main/checkjndi.sh "checkjndi.sh") |  |  |
| [checkjndi\_ps1.png](/CERTCC/CVE-2021-44228_scanner/blob/main/checkjndi_ps1.png "checkjndi_ps1.png") | | [checkjndi\_ps1.png](/CERTCC/CVE-2021-44228_scanner/blob/main/checkjndi_ps1.png "checkjndi_ps1.png") |  |  |
| [checkjndi\_py.png](/CERTCC/CVE-2021-44228_scanner/blob/main/checkjndi_py.png "checkjndi_py.png") | | [checkjndi\_py.png](/CERTCC/CVE-2021-44228_scanner/blob/main/checkjndi_py.png "checkjndi_py.png") |  |  |
| [checkjndi\_sh.png](/CERTCC/CVE-2021-44228_scanner/blob/main/checkjndi_sh.png "checkjndi_sh.png") | | [checkjndi\_sh.png](/CERTCC/CVE-2021-44228_scanner/blob/main/checkjndi_sh.png "checkjndi_sh.png") |  |  |
| View all files | | |

## Repository files navigation

* README
* BSD-2-Clause license
* Security
# CVE-2021-44228\_scanner

Applications that are vulnerable to the log4j [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228) issue may be detectable by scanning jar, war, and ear files to search for the presence of `JndiLookup.class`.

Depending on the platform that you are investigating, the PowerShell or the Python3 script may make more sense to run. In both cases, the optional argument is the top-level directory that you would like to use to begin your search.

Any file discovered is worth investigation to determine if the application using it is vulnerable. For any `JndiLookup.class` that is present, log4j commonly includes the version in the jar file name. For example, a hit on `log4j-core-2.14.1.jar` would be indicative of a vulnerable application. Alternatively, `log4j-core-2.16.jar` may also produce a hit because the JndiLookup code is still present in the 2.16 version of log4j, but it is disabled by default. See [VU#930724](https://www.kb.cert.org/vuls/id/930724) for more details.

## Screenshots

For example, here is an invocation of the PowerShell version of the scanner:
[![checkjndi.ps1 execution on c:\](/CERTCC/CVE-2021-44228_scanner/raw/main/checkjndi_ps1.png "checkjndi.ps1 execution on c:\")](/CERTCC/CVE-2021-44228_scanner/blob/main/checkjndi_ps1.png)

Similarly, here is an invocation of the Python3 version:
[![checkjndi.py execution on c:\](/CERTCC/CVE-2021-44228_scanner/raw/main/checkjndi_py.png "checkjndi.py execution on c:\")](/CERTCC/CVE-2021-44228_scanner/blob/main/checkjndi_py.png)

Finally, here is an invocation of the Bash version:
[![checkjndi.sh execution on ~/in](/CERTCC/CVE-2021-44228_scanner/raw/main/checkjndi_sh.png "checkjndi.sh execution on ~/in")](/CERTCC/CVE-2021-44228_scanner/blob/main/checkjndi_sh.png)

## Interpreting results

Note that the Bash and Python versions of this script will by design limit scans to a single filesystem.
With the PowerShell version, locations to scan can be piped into the script to have control of what is checked. For example, to scan a list of paths conatined in a the file `paths.txt`:

```
get-content .\paths.txt | .\checkjndi.ps1

```

Let's look at the first hit on our Windows scan execution:

```
WARNING: C:\tmp\2.15\log4j-core-2.15.0.jar contains org/apache/logging/log4j/core/lookup/JndiLookup.class

```

Based on the jar name, this is a library from log4j 2.15. While this version of log4j fixes CVE-2021-44228, it still contained a flaw that is outlined as CVE-2021-45046. The impact of [CVE-2021-45046](https://nvd.nist.gov/vuln/detail/CVE-2021-45046) is a denial of service for only certain Java applications that use log4j 2.15. For Java applications that use log4j versions prior to 2.15 and that also fit the prerequisites for CVE-2021-45046 applying, the impact is RCE.

Let's look at the second hit:

```
C:\tmp\2.16\log4j-core-2.16.0.jar contains org/apache/logging/log4j/core/lookup/JndiLookup.class ** BUT APPEARS TO BE PATCHED **

```

This jar file contains a 2.16 version of log4j, which is not vulnerable to CVE-2021-44228. This result is reported for information purposes, which shows that a vendor has patched their product.

Let's look at the third hit:

```
WARNING: C:\tmp\ghidra_10.0_PUBLIC\Ghidra\Framework\Generic\lib\log4j-core-2.12.1.jar contains org/apache/logging/log4j/core/lookup/JndiLookup.class

```

Here we can see that Ghidra uses log4j version 2.12.1, and as such we should assume it to be vulnerable. And indeed, Ghidra versions before 10.1 are [vulnerable to CVE-2021-44228](https://github.com/NationalSecurityAgency/ghidra/releases/tag/Ghidra_10.1_build).

You should investigate any hits reported by either of these scripts, and confirm that either the log4j version is indeed the fixed 2.16 version, or reach out to your software vendor to obtain a fixed version of the software. Alternatively, [VU#930724](https://www.kb.cert.org/vuls/id/930724) has information about how `JndiLookup.class` can be removed from vulnerable jar files.

## Errors returned

The PowerShell version of the scanner has additional error reporting when files or directories cannot be investigated. In particular, any `Unable to scan` errors reporting `UnauthorizedAccessException` is indicative of a permission problem in accessing a directory and/or a file. Any `Unable to scan` errors reporting `InvalidDataException` is usually due to a corrupt archive.

## About

Scanners for Jar files that may be vulnerable to CVE-2021-44228

### Resources

[Readme](#readme-ov-file)
### License

[BSD-2-Clause license](#BSD-2-Clause-1-ov-file)
### Security policy

[Security policy](#security-ov-file)

[Activity](/CERTCC/CVE-2021-44228_scanner/activity)
[Custom properties](/CERTCC/CVE-2021-44228_scanner/custom-properties)
### Stars

[**344**
stars](/CERTCC/CVE-2021-44228_scanner/stargazers)
### Watchers

[**35**
watching](/CERTCC/CVE-2021-44228_scanner/watchers)
### Forks

[**87**
forks](/CERTCC/CVE-2021-44228_scanner/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FCERTCC%2FCVE-2021-44228_scanner&report=CERTCC+%28user%29)

## [Releases](/CERTCC/CVE-2021-44228_scanner/releases)

No releases published

## [Packages 0](/orgs/CERTCC/packages?repo_name=CVE-2021-44228_scanner)

No packages published

## [Contributors 6](/CERTCC/CVE-2021-44228_scanner/graphs/contributors)

## Languages

* [PowerShell
  42.4%](/CERTCC/CVE-2021-44228_scanner/search?l=powershell)
* [Shell
  29.6%](/CERTCC/CVE-2021-44228_scanner/search?l=shell)
* [Python
  28.0%](/CERTCC/CVE-2021-44228_scanner/search?l=python)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

