<!DOCTYPE html><html lang="en" prefix="og: http://ogp.me/ns#"><head><title>CVE-2021-44228 Impact of Log4j Vulnerabilities CVE-2021-44228, CVE-2021-45046, CVE-2021-45105, and CVE-2021-44832</title><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="keywords" content="psirt, PANW, PAN, CVE, Report Vulnerabilities, Palo Alto Networks"><meta name="og:site_name" content="Palo Alto Networks Product Security Assurance"><meta name="theme-color" content="#f0f8ff"><meta property="og:type" content="website"><link rel="apple-touch-icon" sizes="180x180" href="/icon-180x180.png"><link rel="icon" type="image/png" href="/icon-180x180.png" sizes="180x180"><link rel="shortcut icon" href="/favicon.ico"><link href="https://fonts.googleapis.com/css?family=Montserrat:700&amp;display=swap" rel="stylesheet"><link rel="stylesheet" href="/css/min.css"><script src="https://assets.adobedtm.com/9273d4aedcd2/fde2d38db50b/launch-4c3207301e79.min.js" async></script><meta name="description" content="Palo Alto Networks Security Advisory: CVE-2021-44228 Impact of Log4j Vulnerabilities CVE-2021-44228, CVE-2021-45046, CVE-2021-45105, and CVE-2021-44832 Apache Log4j Java library is vulnerable to a remote code execution vulnerability CVE-2021-44228, known as Log4Shell, and related vulnerabilities CVE-2021-45046, CVE-2021-45105, and CVE-2021-44832. Log4Shell allows remote unauthenticated attackers with the ability to inject text into log messages to execute arbitrary code loaded from malicious servers with the privileges of the process utilizing Log4j.

These products and services are not affected by Log4Shell: Bridgecrew, Cortex Data Lake, Cortex XDR agents, Cortex XSOAR, Cortex Xpanse, Enterprise Data Loss Prevention (DLP), Expedition, the GlobalProtect app, IoT Security, Okyo Garde, PAN-DB Private Cloud, PAN-OS software running on firewalls including VM and CN series, Prisma Access, Prisma Cloud, Prisma Cloud Compute, Prisma SD-WAN (CloudGenix), SaaS Security, Traps, User-ID Agent, WildFire Appliance (WF-500), and WildFire Cloud.  

We have determined that some configurations of Panorama appliances with PAN-OS 9.0, PAN-OS 9.1, and PAN-OS 10.0 are impacted by CVE-2021-44228 and CVE-2021-45046 through the use of Elasticsearch. Fixes were released on December 20, 2021 to address both vulnerabilities on impacted PAN-OS versions. Panorama appliances are not impacted by CVE-2021-45105 and CVE-2021-44832. 

NOTE: PAN-OS 8.1 and PAN-OS 10.1 versions for Panorama are not impacted by these issues. All versions of PAN-OS for firewalls and WildFire appliances are not affected.

These vulnerabilities impact Exact Data Matching (EDM) CLI application versions 1.0 - 2.0 provided by Enterprise Data Loss Prevention (DLP). Enterprise DLP is not affected by these issues.

The Palo Alto Networks Product Security Assurance team has completed evaluation of all products and services for these vulnerabilities. All cloud services with known possible impact have been remediated.

At this time, our guidance and criteria for impacted Panorama appliances remain the same for all related vulnerabilities. The Exact Data Matching (EDM) CLI application should now be upgraded to EDM CLI version 2.1 or later versions."><meta property="og:title" content="CVE-2021-44228 Impact of Log4j Vulnerabilities CVE-2021-44228, CVE-2021-45046, CVE-2021-45105, and CVE-2021-44832"><meta property="og:description" content="Apache Log4j Java library is vulnerable to a remote code execution vulnerability CVE-2021-44228, known as Log4Shell, and related vulnerabilities CVE-2021-45046, CVE-2021-45105, and CVE-2021-44832. Log..."><meta name="twitter:image" content="https://security.paloaltonetworks.com/CRITICAL.png"><meta property="og:image" content="https://security.paloaltonetworks.com/CRITICAL.png"><meta property="og:type" content="article"><meta property="article:publisher" content="Palo Alto Networks Product Security Assurance"><meta property="article:author" content="PAN PSIRT"><meta property="article:published_time" content="2021-12-10T21:45:00.000Z"><meta name="twitter:card" contet="summary"><meta name="twitter:label1" content="Severity"><meta name="twitter:data1" content="CRITICAL"><meta name="twitter:label2" content="Published"><meta name="twitter:data2" content="2021-12-10"></head><body id="body"><nav id="nav"><a class="ico logo tsz" href="https://www.paloaltonetworks.com"></a><input class="hid" id="menu" type="checkbox"><label class="rt ico menu nsz" for="menu" onclick></label><ul><li><a href="https://support.paloaltonetworks.com/support" target="_blank" nav-track="true" nav-track-breadcrumb="nav:support">Get support</a></li><li><a href="/">Security advisories</a></li><li><a href="/report">Report vulnerabilities</a></li><li><a href="/scope">Bug Bounty</a></li><li><a href="https://support.paloaltonetworks.com/SupportAccount/Preferences"><span class="ico eml"></span>
<span>Subscribe</span></a></li><li><a href="/rss.xml"><span class="ico rss"></span>
<span>RSS feed</span></a></li></ul></nav><div class="pad" id="content"><a href="/">Palo Alto Networks Security Advisories</a> /
<a href="">CVE-2021-44228</a><h2>CVE-2021-44228 Impact of Log4j Vulnerabilities CVE-2021-44228, CVE-2021-45046, CVE-2021-45105, and CVE-2021-44832</h2><div class="sa_summary"><div class="pad rnd bg-blu sa_cvss"><br><style>@keyframes rotate{0%{transform: rotate(0deg);} 100%{transform: rotate(297deg);} }</style><svg id="CVSSSVG" width="42mm" height="42mm" version="1.1" viewbox="0 0 42 42" xmlns="http://www.w3.org/2000/svg"><circle cx="21" cy="21" r="18.5" fill="#fff" fill-rule="evenodd" stroke="#000" stroke-width="1"></circle><g fill-rule="evenodd" shape-rendering="auto"><path d="m15.383 32.46-1.8893 3.5011c0.5329 0.26616 1.0775 0.5058 1.634 0.71365l1.2842-3.7672c-0.34867-0.13443-0.69246-0.28245-1.0289-0.44752z" fill="#00CC66"></path><path d="m27.258 32.107c-3.1418 1.7714-6.7034 2.0742-9.9002 1.1219l-1.2842 3.7651c4.2936 1.3207 9.1009 0.93103 13.285-1.4785z" fill="#dedede"></path><path d="m31.982 27.496c-0.94261 1.5912-2.245 2.9961-3.8731 4.0861l2.1001 3.4075c2.2361-1.4705 4.0115-3.4052 5.2772-5.6022z" fill="#FA582D"></path><path d="m35.515 12.642-3.4091 2.1006c2.1467 3.8069 2.1408 8.2319 0.35398 11.875l3.5011 1.8893c2.4288-4.8643 2.4604-10.818-0.44597-15.865z" fill="#FD911A"></path><path d="m11.792 7.0094c-7.3432 4.8289-9.7459 14.66-5.2968 22.366 1.5194 2.6317 3.6551 4.6912 6.119 6.1107l1.8914-3.5042c-1.824-1.0806-3.4064-2.6318-4.5465-4.6064-3.3873-5.8669-1.6124-13.247 3.9331-16.959z" fill="#BFCB1E"></path><path d="m21.353 4.2607c-2.9582-0.068747-5.9687 0.64401-8.7111 2.2231l2.1006 3.4091c5.8474-3.2966 13.152-1.5088 16.839 3.9992l3.4081-2.1001c-3.1076-4.7254-8.2855-7.407-13.637-7.5313z" fill="#FFCB06"></path></g><path d="m9.1779 41.476" fill="none" stroke="#000"></path><g fill="#b2b2b2" font-family="Montserrat,Arial" font-size="3px" font-weight="bold"><text x="15.7" y="32">0</text><text x="14.1" y="13.3">4</text><text x="29.2" y="17">7</text><text x="29.6" y="27">9</text><text x="24.6" y="31">10</text></g><g id="ndg"><path id="needle" d="m20.59 15.532-4.4675 16.877 9.1162-14.889-2.6053-0.33678z" fill="#000" transform="rotate(297 21 21)"></path><circle cx="21" cy="21" r="2" fill="#f5f5f5" stroke="#000"></circle></g></svg><br><a class="rnd tag CVSS CRITICAL" href="https://www.first.org/cvss/calculator/4.0#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H" title="CVSS-B: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H">Severity
9.8 ·
CRITICAL</a></div><div class="rnd pad1 bg-blu sa_vector v3"><div title="Worst: The vulnerable component is bound to the network stack and the set of possible attackers extends beyond the other options listed below, up to and including the entire Internet. Such a vulnerability is often termed “remotely exploitable” and can be thought of as an attack being exploitable at the protocol level one or more network hops away (e.g., across one or more routers)."><small>Attack Vector
</small><b>NETWORK</b></div><div title="Bad: An exploited vulnerability can only affect resources managed by the same security authority. In this case, the vulnerable component and the impacted component are either the same, or both are managed by the same security authority."><small>Scope
</small><b>UNCHANGED</b></div><div title="Worst: Specialized access conditions or extenuating circumstances do not exist. An attacker can expect repeatable success when attacking the vulnerable component."><small>Attack Complexity
</small><b>LOW</b></div><div title="Worst: There is a total loss of confidentiality, resulting in all resources within the impacted component being divulged to the attacker. Alternatively, access to only some restricted information is obtained, but the disclosed information presents a direct, serious impact. For example, an attacker steals the administrator's password, or private encryption keys of a web server."><small>Confidentiality Impact
</small><b>HIGH</b></div><div title="Worst: The attacker is unauthorized before the attack, and therefore does not require any access to settings or files of the vulnerable system to carry out an attack."><small>Privileges Required
</small><b>NONE</b></div><div title="Worst: There is a total loss of integrity or a complete loss of protection. For example, the attacker can modify any/all files protected by the impacted component. Alternatively, only some files can be modified, but malicious modification would present a direct, serious consequence to the impacted component."><small>Integrity Impact
</small><b>HIGH</b></div><div title="Worst: The vulnerable system can be exploited without interaction from any user."><small>User Interaction
</small><b>NONE</b></div><div title="Worst: There is a total loss of availability, resulting in the attacker being able to fully deny access to resources in the impacted component; this loss is either sustained (while the attacker continues to deliver the attack) or persistent (the condition persists even after the attack has completed). Alternatively, the attacker can deny some availability, but the loss of availability presents a direct, serious consequence to the impacted component (e.g., the attacker cannot disrupt existing connections, but can prevent new connections; the attacker can repeatedly exploit a vulnerability that, in each instance of a successful attack, leaks an only small amount of memory, but after repeated exploitation causes a service to become completely unavailable)."><small>Availability Impact
</small><b>HIGH</b></div></div><div class="rnd pad1 bg-blu sa_expand"><div class="sa_links pull_right"><span><a class="tag blue" href="https://www.cve.org/CVERecord?id=CVE-2021-44228" target="_blank" title="See CVE.org record">CVE</a>
<a class="tag orange" href="/json/CVE-2021-44228" title="Download the information in this advisory in CVE-JSON format">JSON</a>
<a class="tag csaf" href="/csaf/CVE-2021-44228" title="Download the information in this advisory in CSAF format">CSAF</a>
<a class="btn blue" href="/CVE-2021-44228" title="Permanent link to this advisory"><span class="ico link"></span></a>
<a class="btn" title="Share this advisory in email" href="mailto:?subject=CVE-2021-44228 Impact of Log4j Vulnerabilities CVE-2021-44228, CVE-2021-45046, CVE-2021-45105, and CVE-2021-44832&amp;body=CVE-2021-44228 Impact of Log4j Vulnerabilities CVE-2021-44228, CVE-2021-45046, CVE-2021-45105, and CVE-2021-44832%0A%0Ahttps://security.paloaltonetworks.com/CVE-2021-44228"><span class="ico eml"></span></a></span><div><span class="ico date"></span><small> Published
</small><b><span class="date-tt" data-date="2021-12-10T21:45:00.000Z">2021-12-10</span></b></div><div><span class="ico date"></span><small> Updated
</small><b><span class="date-tt" data-date="2022-01-22T02:30:00.000Z">2022-01-22</span></b></div><div><small>Reference
</small><b>PAN-184592</b></div><div title="This issue was found during external security research or testing."><small>Discovered
</small><b>externally</b></div></div></div></div><h3>Description</h3><p>Apache Log4j Java library is vulnerable to a remote code execution vulnerability CVE-2021-44228, known as Log4Shell, and related vulnerabilities CVE-2021-45046, CVE-2021-45105, and CVE-2021-44832. Log4Shell allows remote unauthenticated attackers with the ability to inject text into log messages to execute arbitrary code loaded from malicious servers with the privileges of the process utilizing Log4j.</p><p>These products and services are not affected by Log4Shell: Bridgecrew, Cortex Data Lake, Cortex XDR agents, Cortex XSOAR, Cortex Xpanse, Enterprise Data Loss Prevention (DLP), Expedition, the GlobalProtect app, IoT Security, Okyo Garde, PAN-DB Private Cloud, PAN-OS software running on firewalls including VM and CN series, Prisma Access, Prisma Cloud, Prisma Cloud Compute, Prisma SD-WAN (CloudGenix), SaaS Security, Traps, User-ID Agent, WildFire Appliance (WF-500), and WildFire Cloud.  </p><p>We have determined that some configurations of Panorama appliances with PAN-OS 9.0, PAN-OS 9.1, and PAN-OS 10.0 are impacted by CVE-2021-44228 and CVE-2021-45046 through the use of Elasticsearch. Fixes were released on December 20, 2021 to address both vulnerabilities on impacted PAN-OS versions. Panorama appliances are not impacted by CVE-2021-45105 and CVE-2021-44832. </p><p>NOTE: PAN-OS 8.1 and PAN-OS 10.1 versions for Panorama are not impacted by these issues. All versions of PAN-OS for firewalls and WildFire appliances are not affected.</p><p>These vulnerabilities impact Exact Data Matching (EDM) CLI application versions 1.0 - 2.0 provided by Enterprise Data Loss Prevention (DLP). Enterprise DLP is not affected by these issues.</p><p>The Palo Alto Networks Product Security Assurance team has completed evaluation of all products and services for these vulnerabilities. All cloud services with known possible impact have been remediated.</p><p>At this time, our guidance and criteria for impacted Panorama appliances remain the same for all related vulnerabilities. The Exact Data Matching (EDM) CLI application should now be upgraded to EDM CLI version 2.1 or later versions.</p><h3>Product Status</h3><table class="neat card"><colgroup><col><col class="affectedCol"></colgroup><tr><th>Versions</th><th>Affected</th><th>Unaffected</th></tr><tr><td>Bridgecrew</td><td>None</td><td>All</td></tr><tr><td>Cortex Data Lake</td><td>None</td><td>All</td></tr><tr><td>Cortex XDR Agent</td><td>None</td><td>All</td></tr><tr><td>Cortex XSOAR</td><td>None</td><td>All</td></tr><tr><td>Cortex Xpanse</td><td>None</td><td>All</td></tr><tr><td>Enterprise Data Loss Prevention</td><td>None</td><td>All</td></tr><tr><td>Exact Data Matching CLI  </td><td>&lt; 2.1</td><td>&gt;= 2.1</td></tr><tr><td>Expedition</td><td>None</td><td>All</td></tr><tr><td>GlobalProtect App</td><td>None</td><td>All</td></tr><tr><td>IoT Security</td><td>None</td><td>All</td></tr><tr><td>Okyo Garde</td><td>None</td><td>All</td></tr><tr><td>PAN-DB Private Cloud</td><td>None</td><td>All</td></tr><tr><td>PAN-OS</td><td>None on Firewall, WildFire</td><td>All on Firewall, WildFire</td></tr><tr><td>PAN-OS 10.1</td><td>None on Panorama</td><td>All on Panorama</td></tr><tr><td>PAN-OS 10.0</td><td>&lt; 10.0.8-h8 on Panorama</td><td>&gt;= 10.0.8-h8 on Panorama</td></tr><tr><td>PAN-OS 9.1</td><td>&lt; 9.1.12-h3 on Panorama</td><td>&gt;= 9.1.12-h3 on Panorama</td></tr><tr><td>PAN-OS 9.0</td><td>&lt; 9.0.15 on Panorama</td><td>&gt;= 9.0.15 on Panorama</td></tr><tr><td>PAN-OS 8.1</td><td>None on Panorama</td><td>All on Panorama</td></tr><tr><td>Prisma Cloud</td><td>None</td><td>All</td></tr><tr><td>Prisma Access</td><td>None</td><td>All</td></tr><tr><td>Prisma Cloud Compute</td><td>None</td><td>All</td></tr><tr><td>Prisma SD-WAN (CloudGenix)</td><td>None</td><td>All</td></tr><tr><td>SaaS Security</td><td>None</td><td>All</td></tr><tr><td>Traps</td><td>None</td><td>All</td></tr><tr><td>User-ID Agent</td><td>None</td><td>All</td></tr><tr><td>WildFire Appliance (WF-500)</td><td>None</td><td>All</td></tr><tr><td>WildFire Cloud</td><td>None</td><td>All</td></tr></table><h3>Required Configuration for Exposure</h3><p>Vulnerabilities CVE-2021-44228 and CVE-2021-45046 are applicable to Panorama hardware appliances and virtual appliances that have Elasticsearch software running. Appliances that are run in Panorama mode or Log Collector mode, and have also been part of a Collector Group, are impacted. You can determine if the appliance is part of a Collector Group by visiting 'Panorama &gt; Managed Collectors' from the web interface and verify that Elasticsearch is running on the appliance by checking the command ‘show system software status | match elasticsearch’ from the CLI.</p><p>Appliances running in Management Only mode or Legacy mode, including those used for Prisma Access, are not impacted.</p><h3>Severity:
CRITICAL</h3><p>CVSSv3.1
Base Score:
9.8 (<a href="https://www.first.org/cvss/calculator/4.0#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H">CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H</a>)</p><h3>Exploitation Status</h3><p>Palo Alto Networks is not aware of evidence showing the exploitation of these vulnerabilities against Panorama hardware appliances, Panorama virtual appliances, or the Exact Data Matching CLI application.</p><p>More information about the vulnerability's exploitation in the wild can be found in the Unit 42 threat brief: <a href="https://unit42.paloaltonetworks.com/apache-log4j-vulnerability-cve-2021-44228/" class="linkified" target="_blank">https://unit42.paloaltonetworks.com/apache-log4j-vulnerability-cve-2021-44228/</a></p><h3>Weakness Type</h3><p><a href="https://cwe.mitre.org/data/definitions/94" target="_blank" title="More at https://cwe.mitre.org/data/definitions/94">CWE-94 Improper Control of Generation of Code ('Code Injection')</a></p><h3>Solution</h3><p>These issues are fixed in PAN-OS 9.0.15, PAN-OS 9.1.12-h3, PAN-OS 10.0.8-h8, and all later PAN-OS versions for Panorama hardware and virtual appliances.</p><p>NOTE: Though PAN-OS 10.1 is not impacted by the these vulnerabilities, the responsible Log4j code was removed for additional assurance from PAN-OS 10.1 versions for Panorama appliances starting with PAN-OS 10.1.4.</p><p>If Panorama is running an impacted version of PAN-OS, and you would prefer to upgrade to PAN-OS 10.1, upgrade all appliances in affected Collector Groups to the latest PAN-OS 10.1 Preferred release (PAN-OS 10.1.3-h1 at time of publication) to remediate these issues.</p><p>NOTE: Prisma Access customers should refer to the Prisma Access and Panorama version compatibility document before upgrading Panorama: <a href="https://docs.paloaltonetworks.com/compatibility-matrix/prisma-access/prisma-access-and-panorama-version-compatibility.html" class="linkified" target="_blank">https://docs.paloaltonetworks.com/compatibility-matrix/prisma-access/prisma-access-and-panorama-version-compatibility.html</a></p><p>NOTE: Downgrading to PAN-OS 10.0 or earlier PAN-OS versions is not currently supported once Panorama is upgraded to PAN-OS 10.1. </p><p>Workarounds are available that eliminate the exposure for these older versions of Panorama until they can be upgraded to a fixed version.</p><p>For Enterprise Data Loss Prevention customers, these issues are fixed in Exact Data Matching (EDM) CLI application version 2.1 and all later EDM CLI versions.</p><p>No updates for other Palo Alto Networks products are required at this time.</p><p>Cortex XSOAR customers that have opted to deploy Elasticsearch in their environment should refer to the Elasticsearch announcement (ESA-2021-31) for remediation information. Elasticsearch 7.16 is not supported with Cortex XSOAR:</p><p><a href="https://discuss.elastic.co/t/apache-log4j2-remote-code-execution-rce-vulnerability-cve-2021-44228-esa-2021-31/291476" class="linkified" target="_blank">https://discuss.elastic.co/t/apache-log4j2-remote-code-execution-rce-vulnerability-cve-2021-44228-esa-2021-31/291476</a></p><p>Enable signatures for unique threat IDs 91991, 91994, 91995, 92001, and 92007 to block a number of known attacks against CVE-2021-44228 and CVE-2021-45046 across the network.</p><p>These signatures block the first stage of the attack. Suitable egress filtering is key to blocking the second stage of the attack. Use App-ID for ‘ldap’ and ‘rmi-iiop’ to block all LDAP and RMI to or from untrusted networks and unexpected sources.</p><p>SSL decryption needs to be enabled on the firewall to block known attacks over HTTPS.</p><p>Customers with log4j in their environments should upgrade or apply workarounds suggested by respective vendors, and not rely only on the Threat Prevention signatures.</p><p>See <a href="https://unit42.paloaltonetworks.com/apache-log4j-vulnerability-cve-2021-44228/" class="linkified" target="_blank">https://unit42.paloaltonetworks.com/apache-log4j-vulnerability-cve-2021-44228/</a> for more details on the Palo Alto Networks product capabilities to protect against attacks that exploit this issue.</p><h3>Workarounds and Mitigations</h3><p>For each Panorama hardware appliance and virtual appliance running in Panorama mode or Log Collector mode, that has also been part of a Collector Group, must be removed from their Collector Group in ‘Panorama &gt; Collector Group &gt; Custom-CG-Name &gt; General' from the web interface. Once affected appliances are removed from all groups, a Panorama commit and Collector Group push for all affected Collector Groups must be performed. The Collector Groups should not be deleted before performing the Collector Group push for the affected Collector Groups, else the Collector Group push will fail to remove the appliances.</p><p>NOTE: When this workaround is applied, logging and reporting features in Panorama will not work. All logs stored on the appliance will be lost once it is removed from the Collector Group.</p><p>Finally, all appliances that were part of the Collector Group need to be restarted to stop the use of Elasticsearch. This eliminates the exposure to CVE-2021-44228 and CVE-2021-45046.</p><p>You can restart the appliance by visiting ‘Panorama &gt; Operations &gt; Device Operations &gt; Reboot Panorama’  from the web interface or by using the command ‘request restart system’ from the CLI.</p><p>Once these steps are completed, you can verify that Elasticsearch has stopped and the appliance’s exposure to CVE-2021-44228 and CVE-2021-45046 has been removed, by running the command ‘show system software status | match elasticsearch’ from the CLI.</p><p>Managed PAN-OS firewalls can be configured to forward logs to other servers until Panorama log collection functionality is restored. Alternate Log Forwarding options are detailed here: <a href="https://docs.paloaltonetworks.com/pan-os/10-0/pan-os-web-interface-help/objects/objects-log-forwarding.html" class="linkified" target="_blank">https://docs.paloaltonetworks.com/pan-os/10-0/pan-os-web-interface-help/objects/objects-log-forwarding.html</a></p><p>Follow the security best practices listed in ‘Protecting Panorama and Log Collector Inbound and Outbound Communications’ to reduce the risk of successful exploitation of CVE-2021-44228 and CVE-2021-45046 on Panorama appliances: <a href="https://live.paloaltonetworks.com/t5/general-articles/protecting-panorama-and-log-collector-inbound-and-outbound/ta-p/454071" class="linkified" target="_blank">https://live.paloaltonetworks.com/t5/general-articles/protecting-panorama-and-log-collector-inbound-and-outbound/ta-p/454071</a></p><p>Additionally, use ACLs to limit network access to Panorama to only trusted users and trusted networks and IP addresses. Use App-ID for ‘ldap’ and ‘rmi-iiop’ to block all LDAP and RMI traffic to and from untrusted networks or unexpected sources.</p><p>No other workarounds or mitigations are available for Palo Alto Networks products at this time.</p><h3>Frequently Asked Questions</h3><div itemscope itemprop="mainEntity" itemtype="https://schema.org/Question"></div><h4 itemprop="name">Q.
Does Panorama use Log4j?</h4><blockquote itemscope itemprop="acceptedAnswer" itemtype="https://schema.org/Answer"><p><p>Panorama includes Elasticsearch, which uses the Log4j library.</p><p>Panorama devices and virtual appliances running on PAN-OS 9.0, PAN-OS 9.1, and PAN-OS 10.0 software include Elasticsearch 5.6.7 which uses Log4j 2.9.1. Only the Panorama versions listed as affected in this advisory are susceptible to RCE risks associated with Log4Shell vulnerabilities. Though the fixed versions of Panorama list the same versions of Log4J, the vulnerable Java class file has been removed from them.</p><p>Panorama with PAN-OS 8.1 includes Elasticsearch 2.2.2 with Log4j 1.2.17 and Panorama with PAN-OS 10.1 includes Elasticsearch 6.8.12 with Log4j 2.11.1. These do not have the security risks associated with Log4Shell.</p></p></blockquote><div itemscope itemprop="mainEntity" itemtype="https://schema.org/Question"></div><h4 itemprop="name">Q.
How was Log4j fixed in Panorama?</h4><blockquote itemscope itemprop="acceptedAnswer" itemtype="https://schema.org/Answer"><p>In fixed versions of PAN-OS for Panorama, the included Elasticsearch package was remediated through the deletion of the vulnerable Log4j JndiLookup class file. This solution is provided by Elasticsearch announcement (ESA-2021-31) and the Log4j Security Vulnerabilities Page as a complete remediation option for CVE-2021-44228 and CVE-2021-45046. Panorama appliances are not impacted by CVE-2021-45105 and CVE-2021-44832, requiring no specific fix.<br><br>NOTE: Though PAN-OS 10.1 is not impacted by these vulnerabilities, the JndiLookup.class was removed out of an abundance of caution in PAN-OS for Panorama appliances starting with PAN-OS 10.1.4.<br></p></blockquote><h3>Timeline</h3><div class="timeline"><div><label><span class="date-tt" data-date="2022-01-22T02:30:00.000Z">2022-01-22</span></label>
<span class="t">Panorama appliances are not impacted by CVE-2021-44832 and a new EDM CLI application fix is available</span></div><div><label><span class="date-tt" data-date="2021-12-30T00:30:00.000Z">2021-12-30</span></label>
<span class="t">Traps is confirmed to be unaffected</span></div><div><label><span class="date-tt" data-date="2021-12-29T01:00:00.000Z">2021-12-29</span></label>
<span class="t">Update for related vulnerability CVE-2021-44832</span></div><div><label><span class="date-tt" data-date="2021-12-22T23:30:00.000Z">2021-12-22</span></label>
<span class="t">Clarified how Log4j was fixed in FAQ. Added note about deletion of Log4j code in PAN-OS 10.1.4</span></div><div><label><span class="date-tt" data-date="2021-12-21T00:00:00.000Z">2021-12-21</span></label>
<span class="t">Fixes are available for impacted Panorama appliances. Updates around related vulnerability CVE-2021-45105</span></div><div><label><span class="date-tt" data-date="2021-12-18T03:00:00.000Z">2021-12-18</span></label>
<span class="t">Update for related vulnerability CVE-2021-45046. Guidance for impacted products remains the same</span></div><div><label><span class="date-tt" data-date="2021-12-18T00:00:00.000Z">2021-12-18</span></label>
<span class="t">Added confirmation that PAN-DB Private Cloud is unaffected</span></div><div><label><span class="date-tt" data-date="2021-12-17T06:45:00.000Z">2021-12-17</span></label>
<span class="t">Clarifications made for Panorama appliances. Exact Data Maching CLI application is confirmed to be affected</span></div><div><label><span class="date-tt" data-date="2021-12-16T22:20:00.000Z">2021-12-16</span></label>
<span class="t">Added ETAs for PAN-OS fixed versions and additional information</span></div><div><label><span class="date-tt" data-date="2021-12-16T17:30:00.000Z">2021-12-16</span></label>
<span class="t">Clarification that there is no evidence of active Panorama exploitation</span></div><div><label><span class="date-tt" data-date="2021-12-15T20:25:00.000Z">2021-12-15</span></label>
<span class="t">Some versions of Panorama are confirmed to be susceptible to remote code execution. Evaluation of all products and services is complete</span></div><div><label><span class="date-tt" data-date="2021-12-14T21:12:00.000Z">2021-12-14</span></label>
<span class="t">UserID-Agent is confirmed to be unaffected</span></div><div><label><span class="date-tt" data-date="2021-12-14T07:30:00.000Z">2021-12-14</span></label>
<span class="t">The impact of the vulnerability on Panorama hardware and virtual appliances is under investigation</span></div><div><label><span class="date-tt" data-date="2021-12-14T04:00:00.000Z">2021-12-14</span></label>
<span class="t">Prisma Access and Okyo Garde are confirmed to be unaffected. Context for Panorama's Log4j usage</span></div><div><label><span class="date-tt" data-date="2021-12-13T19:40:00.000Z">2021-12-13</span></label>
<span class="t">Product status and Threat Prevention coverage updates</span></div><div><label><span class="date-tt" data-date="2021-12-12T18:34:00.000Z">2021-12-12</span></label>
<span class="t">Bridgecrew is confirmed to be unaffected</span></div><div><label><span class="date-tt" data-date="2021-12-11T04:14:00.000Z">2021-12-11</span></label>
<span class="t">Panorama is confirmed to be unaffected (Update: 12/15: new information is available that changes this evaluation)</span></div><div><label><span class="date-tt" data-date="2021-12-11T00:00:00.000Z">2021-12-11</span></label>
<span class="t">WildFire Appliance (WF-500) is confirmed to be unaffected</span></div><div><label><span class="date-tt" data-date="2021-12-10T21:45:00.000Z">2021-12-10</span></label>
<span class="t">Initial publication</span></div></div><script>function localiseDates() {
  document.querySelectorAll("span[data-date]").forEach((elem) => {
    let localDate = new Date(elem.getAttribute("data-date"));
    let isoLocalDate = new Date(localDate.getTime() - localDate.getTimezoneOffset() * 60000).toISOString().slice(0, 10);
    elem.textContent = isoLocalDate;
    let fmtOpts = { dateStyle: "long", timeStyle: "long" };
    elem.setAttribute("title", new Intl.DateTimeFormat(undefined, fmtOpts).format(localDate));
  });
}

window.addEventListener("load", localiseDates);
</script></div><div class="footer"><a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of use</a><a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a><a href="https://paloaltonetworks.com/product-security-assurance">Product Security Assurance and Vulnerability Disclosure Policy</a><a href="/report">Report vulnerabilities</a><a href="https://support.paloaltonetworks.com/SupportAccount/Preferences">Manage subscriptions</a></div><div class="pad bg-blu"><div class="btop">© 2025 Palo Alto Networks, Inc. All rights reserved.</div></div></body></html>