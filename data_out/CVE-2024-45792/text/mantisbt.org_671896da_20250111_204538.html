
Toggle sidebar [MantisBT](/bugs//) Toggle user menu

* mantisbt

  + - [All Projects](/bugs/set_project.php?project_id=0)
    - [mantisbt](/bugs/set_project.php?project_id=1)
    - [Mylyn Connector](/bugs/set_project.php?project_id=20)
    - [Plugin - agileMantis](/bugs/set_project.php?project_id=25)
    - [Plugin - CsvImport](/bugs/set_project.php?project_id=11)
    - [Plugin - CustomerManagement](/bugs/set_project.php?project_id=21)
    - [Plugin - EmailReporting](/bugs/set_project.php?project_id=10)
    - [Plugin - FilterPageEdit](/bugs/set_project.php?project_id=15)
    - [Plugin - InlineColumnConfiguration](/bugs/set_project.php?project_id=14)
    - [Plugin - LinkedCustomFields](/bugs/set_project.php?project_id=16)
    - [Plugin - MantisTouchRedirect](/bugs/set_project.php?project_id=22)
    - [Plugin - RecurrCall](/bugs/set_project.php?project_id=6)
    - [Plugin - RelatedIssuesExport](/bugs/set_project.php?project_id=13)
    - [Plugin - Reminder](/bugs/set_project.php?project_id=7)
    - [Plugin - Tasks](/bugs/set_project.php?project_id=8)
    - [Plugin - Time Tracking](/bugs/set_project.php?project_id=18)
* anonymous
  + [RSS](https://mantisbt.org/bugs/issues_rss.php)
  + [Logout](/bugs/logout_page.php)

* [My View](/bugs/my_view_page.php)
* [View Issues](/bugs/view_all_bug_page.php)
* [Change Log](/bugs/changelog_page.php)
* [Roadmap](/bugs/roadmap_page.php)
* [Wiki](/bugs/wiki.php?type=project&id=1)
* [Repositories](/bugs/plugin.php?page=Source/index)

* Anonymous
[Login](/bugs/login_page.php?return=%2Fbugs%2Fview.php%3Fid%3D34640)
[Signup for a new account](/bugs/signup_page.php)

#### View Issue Details

[Wiki](wiki.php?id=34640)[Related Changesets](#changesets)[Jump to Notes](#bugnotes)

|  | | | | | |
| --- | --- | --- | --- | --- | --- |
| ID | Project | Category | View Status | Date Submitted | Last Update |
| --- | --- | --- | --- | --- | --- |
| 0034640 | mantisbt | security | public | 2024-09-12 07:10 | 2024-10-17 08:16 |
|  | | | | | |
|
| Reporter | [c\_schmitz](https://mantisbt.org/bugs/view_user_page.php?id=7280) | Assigned To | [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) |  | |
| Priority | high | Severity | major | Reproducibility | always |
| Status | closed | Resolution | fixed |  | |
| Product Version | 2.26.3 |  | | | |
| Target Version | 2.26.4 | Fixed in Version | 2.26.4 |  | |
|  | | | | | |
|
| Summary | 0034640: CVE-2024-45792: Insecure Direct Object References vulnerability with user profiles | | | | |
| Description | In the Mantis, users can create accounts and across many functionalities, define profiles. When attempting to update a profile entry, we discovered that the ‘profile\_id’ parameter could be manipulated to switch to a different post. This resulted, in a limited, informational only IDOR, allowing users to enumerate other users titles, without the ability to take any actions on the object.  To demonstrate this, we created two accounts and confirmed that user B could view the content created by user A. Additionally, we took screenshots of different user profiles for reference. | | | | |
| Steps To Reproduce | See attached PDF for a more detailed description. Please note that the PDF is not for public release. | | | | |
| Tags | No tags attached. | | | | |
|  | | | | | |
|

#### Relationships

[Relationship Graph](bug_relationship_graph.php?bug_id=34640&graph=relation)[Dependency Graph](bug_relationship_graph.php?bug_id=34640&graph=dependency)

| related to | [0034824](view.php?id=34824) | resolved | [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) | Multiple execution of the same query with Profile API functions |
| --- | --- | --- | --- | --- |
| related to | [0034826](view.php?id=34826) | resolved | [atrol](https://mantisbt.org/bugs/view_user_page.php?id=11111) | Error when clearing default profile |
| related to | [0034854](view.php?id=34854) | resolved | [atrol](https://mantisbt.org/bugs/view_user_page.php?id=11111) | Error when creating global profiles |

#### Activities

| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2024-09-12 09:37  developer    [~0069202](view.php?id=34640#c69202 "Direct link to note") | Hello Carsten, many thanks for the vulnerability report. I will have a closer look as soon as possible and get back to you.  To ensure the attachment remains confidential when this issue becomes public, I will move it to a new private bugnote  Question: the report mentions *Enumerating other users on the platform* but as far as I can tell it does not allow enumerating *users*, only the titles of other users' profiles. Or am I missing something ? |
| --- | --- |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2024-09-15 05:29  developer    [~0069223](view.php?id=34640#c69223 "Direct link to note") | Problem confirmed in latest master; has likely existed for many years (at least since 1.2.0, possibly before). |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2024-09-15 12:04  developer    [~0069224](view.php?id=34640#c69224 "Direct link to note") | GitHub Security advisory created: <https://github.com/mantisbt/mantisbt/security/advisories/GHSA-h5q3-fjp4-2x7r> and CVE ID requested.  [@c\_schmitz](https://mantisbt.org/bugs/view_user_page.php?id=7280) I credited you as reporter for this vulnerability; if anybody else needs to be credited, please let me know their GitHub user ID.  I will shortly push a patch to the advisory's private fork. Kindly review it and let me know your feedback. |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2024-09-17 02:36  developer    [~0069236](view.php?id=34640#c69236 "Direct link to note") | CVE-2024-45792 assigned |
|  | |

#### Related Changesets

| MantisBT: master 56bbd02d  2024-09-28 10:47  [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  Committer: [community](https://mantisbt.org/bugs/view_user_page.php?id=36846) [Details](/bugs/plugin.php?page=Source/view&id=27233) [Diff](https://github.com/mantisbt/mantisbt/commit/56bbd02dc1fb33a8de5898fd17dc3d698c847f55) | Merge commit from fork | | Affected Issues[0034640](/bugs/view.php?id=34640 "[closed] CVE-2024-45792: Insecure Direct Object References vulnerability with user profiles") |
| --- | --- | --- | --- |
| mod - account\_prof\_edit\_page.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/56bbd02dc1fb33a8de5898fd17dc3d698c847f55) [File](https://github.com/mantisbt/mantisbt/blob/56bbd02dc1fb33a8de5898fd17dc3d698c847f55/account_prof_edit_page.php) |
| mod - account\_prof\_update.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/56bbd02dc1fb33a8de5898fd17dc3d698c847f55) [File](https://github.com/mantisbt/mantisbt/blob/56bbd02dc1fb33a8de5898fd17dc3d698c847f55/account_prof_update.php) |
| mod - core/profile\_api.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/56bbd02dc1fb33a8de5898fd17dc3d698c847f55) [File](https://github.com/mantisbt/mantisbt/blob/56bbd02dc1fb33a8de5898fd17dc3d698c847f55/core/profile_api.php) |
| MantisBT: master-2.26 ef0f8202  2024-09-28 10:54  [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) [Details](/bugs/plugin.php?page=Source/view&id=27248) [Diff](https://github.com/mantisbt/mantisbt/commit/ef0f820284032350cc20a39ff9cb2010d5463b41) | Prevent unauthorized access to other users Profiles | | Affected Issues[0034640](/bugs/view.php?id=34640 "[closed] CVE-2024-45792: Insecure Direct Object References vulnerability with user profiles") |
| mod - account\_prof\_edit\_page.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/ef0f820284032350cc20a39ff9cb2010d5463b41) [File](https://github.com/mantisbt/mantisbt/blob/ef0f820284032350cc20a39ff9cb2010d5463b41/account_prof_edit_page.php) |
| mod - account\_prof\_update.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/ef0f820284032350cc20a39ff9cb2010d5463b41) [File](https://github.com/mantisbt/mantisbt/blob/ef0f820284032350cc20a39ff9cb2010d5463b41/account_prof_update.php) |
| mod - core/profile\_api.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/ef0f820284032350cc20a39ff9cb2010d5463b41) [File](https://github.com/mantisbt/mantisbt/blob/ef0f820284032350cc20a39ff9cb2010d5463b41/core/profile_api.php) |

**Powered by [MantisBT 2.28.0-dev-master-a94bae75d](https://www.mantisbt.org "bug tracking software")**

Copyright © 2000 - 2025 MantisBT Team
Contact administrator for assistance

[![Powered by Mantis Bug Tracker: a free and open source web based bug tracking system.](/bugs/images/mantis_logo.png)](https://www.mantisbt.org "Mantis Bug Tracker: a free and open source web based bug tracking system.")

 Page execution time: 0.1656 seconds

