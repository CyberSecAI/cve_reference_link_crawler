The provided content relates to CVE-2024-39478.

**Root Cause:**
The vulnerability stems from an attempt to `kfree` a stack-allocated buffer within the `starfive_rsa_enc_core` function in `drivers/crypto/starfive/jh7110-rsa.c`. The `rsa_data` buffer is allocated on the stack and is not intended to be freed via `kfree`.

**Weaknesses/Vulnerabilities:**
- Incorrect memory management: The code attempts to free a stack-allocated buffer using `kfree`, which is meant for heap-allocated memory.
- Use-after-free: The incorrect `kfree` call will lead to undefined behavior and can corrupt memory, especially when `rsa_data` is used in subsequent operations.

**Impact of Exploitation:**
- Undefined behavior: The most immediate impact is undefined behavior, potentially leading to crashes or other unpredictable actions.
- Memory corruption: The `kfree` on the stack will corrupt memory.
- System instability: System instability and potential security issues can arise due to memory corruption.

**Attack Vectors:**
- Triggering the `starfive_rsa_enc_core` function: This could be done via cryptographic operations that involve RSA encryption, by calling the affected driver.

**Required Attacker Capabilities/Position:**
- Ability to use the StarFive RSA cryptographic driver.
- Privileges that allow the attacker to perform the necessary cryptographic operations.

**Additional Information:**
- The commit message clarifies that "RSA text data uses variable length buffer allocated in software stack."
- The fix involves removing the `kfree(rctx->rsa_data)` line, thus preventing the incorrect memory deallocation.
- The vulnerability affects Linux kernel versions 6.7 and later.