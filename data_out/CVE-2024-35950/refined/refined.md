```
{
  "vulnerability": {
    "root_cause": "The modes[] array in the drm/client driver contains pointers to modes on the connectors' mode lists. These lists are protected by dev->mode_config.mutex. The modes[] array was not being protected by the same mutex, leading to a potential use-after-free or double-free.",
    "weaknesses": [
      "Use-after-free",
      "Double-free",
      "Race condition"
    ],
    "impact": "If a race condition occurs, where the mode list is modified while the modes[] array is being accessed, it can lead to memory corruption issues, such as use-after-free or double-free vulnerabilities. This can lead to denial of service or potentially arbitrary code execution.",
    "attack_vectors": "The vulnerability is triggered via the drm/client driver. The specific sequence involves accessing the modes[] array without holding the dev->mode_config.mutex, while another thread modifies the mode lists.",
    "required_attacker_capabilities": "An attacker would need the capability to trigger actions related to display mode setting, which could involve manipulating parameters passed to the drm/client driver. A local user with the ability to interact with the graphics system could potentially trigger this issue."
  },
  "patch": {
    "description": "The patch addresses the vulnerability by ensuring that the modes[] array is always protected by the dev->mode_config.mutex. This involves acquiring the mutex before accessing elements of the modes[] array and releasing it when done. This prevents race conditions and eliminates the possibility of use-after-free or double-free.",
    "changes": "The fix involves adding a lock/mutex around the section where modes are accessed to protect it from race conditions with other parts of the code that might free the modes. Specifically the following lines were added:\n`+    /* points to modes protected by mode_config.mutex */`\nand:\n`+ mutex_unlock(&dev->mode_config.mutex);`\nand the line `mutex_unlock(&dev->mode_config.mutex);` was moved to be after the call to `drm_client_pick_crtcs` and after `drm_client_modeset_release(client);`"
  },
    "cve_list": [
        "CVE-2024-35950"
    ],
  "additional_notes": "The provided content includes multiple commits that address the same issue, indicating that the fix was backported to various kernel versions. The issue was also tracked on the freedesktop.org gitlab instance. The Debian security advisory confirms that this CVE was addressed in their linux-5.10 package."
}
```