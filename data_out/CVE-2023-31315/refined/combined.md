=== Content from news.ycombinator.com_9dbd93c9_20250111_085024.html ===


| |  | **[Hacker News](news)** [new](newest) | [past](front) | [comments](newcomments) | <ask> | <show> | <jobs> | <submit> | [login](login?goto=item%3Fid%3D41475975) | | --- | --- | --- | |
| --- | --- | --- | --- |
|
| |  |  | [DEF Con 32 – AMD Sinkclose Universal Ring-2 Privilege Escalation (Not Redacted) [pdf]](https://media.defcon.org/DEF%20CON%2032/DEF%20CON%2032%20presentations/DEF%20CON%2032%20-%20Enrique%20Nissim%20Krzysztof%20Okupski%20-%20AMD%20Sinkclose%20Universal%20Ring-2%20Privilege%20Escalation.pdf) ([defcon.org](from?site=defcon.org)) | | --- | --- | --- | |  | | 195 points by [ruik](user?id=ruik) [4 months ago](item?id=41475975)  | [hide](hide?id=41475975&goto=item%3Fid%3D41475975) | [past](https://hn.algolia.com/?query=DEF%20Con%2032%20%E2%80%93%20AMD%20Sinkclose%20Universal%20Ring-2%20Privilege%20Escalation%20%28Not%20Redacted%29&type=story&dateRange=all&sort=byDate&storyText=false&prefix&page=0) | [favorite](fave?id=41475975&auth=4309ae813dfd18218d56b1c38afeefb97393d054) | [30 comments](item?id=41475975) |  | |  |  | [tux3](user?id=tux3) [4 months ago](item?id=41518847)   | [next](#41518946) [–]  I was confused by the title, by "Ring-2" it means "Ring -2" (minus two), which is "traditionally" SMM (System Management Mode), a horrible relic that lets your BIOS/UEFI silently steal the CPU from the OS to implement janky drivers or workarounds directly in the firmware (occasionally causing all sorts of mayhem). (Actual Ring 2 is very rarely seen, so perhaps I should have known!) | | --- | --- | --- | | | --- | --- | --- | --- | | |  |  | [kaoD](user?id=kaoD) [4 months ago](item?id=41521768)   | [parent](#41518847) | [next](#41518946) [–]  Wait, there are negative rings!? I'd like to learn more about this but it's not a very easy to search term. Any pointers? | | --- | --- | --- | | | |  |  | [ngneer](user?id=ngneer) [4 months ago](item?id=41522569)   | [root](#41518847) | [parent](#41521768) | [next](#41522015) [–]  Just terminology. Whenever a new higher-privileged entity is created, it is sometimes described as a negative ring. There was a time when people thought if we could put the secure code in a lower ring, then with it we could protect the rest of the system. With virtualization, the hypervisor is in ring -1, which is technically not a ring, but rather a mode called VMX root operation, post-VMXON. This enables things like the blue pill attack, where the hypervisor is itself presented with a false image of the underlying physical hardware, by a malicious layer. You can find the same pattern in ARM TrustZone, where the secure code is repeatedly broken. "if only we had ring -N" | | --- | --- | --- | | | |  |  | [dwoldrich](user?id=dwoldrich) [4 months ago](item?id=41526838)   | [root](#41518847) | [parent](#41522569) | [next](#41522015) [–]  Crazy complexity. Mind blown! | | --- | --- | --- | | | |  |  | [Dalewyn](user?id=Dalewyn) [4 months ago](item?id=41527097)   | [root](#41518847) | [parent](#41526838) | [next](#41537118) [–]  It's the same reason that the nominal thrust level on the Space Shuttle Main Engines is 104.5%[1]. No, not 100% (it was originally), 104.5%. Why? Because you don't go back and change all your rules and documentation following subsequent developments in the field, that causes unnecessary confusion and errors down the road. [1]: <https://en.wikipedia.org/wiki/RS-25#Engine_throttle/output> | | --- | --- | --- | | | |  |  | [ngneer](user?id=ngneer) [3 months ago](item?id=41537118)   | [root](#41518847) | [parent](#41526838) | [prev](#41527097) | [next](#41522015) [–]  Likewise. Engineers do not idle well. | | --- | --- | --- | | | |  |  | [hypeatei](user?id=hypeatei) [4 months ago](item?id=41522015)   | [root](#41518847) | [parent](#41521768) | [prev](#41522569) | [next](#41522282) [–]  Good article on negative rings: [https://medium.com/swlh/negative-rings-in-intel-architecture...](https://medium.com/swlh/negative-rings-in-intel-architecture-the-security-threats-youve-probably-never-heard-of-d725a4b6f831) | | --- | --- | --- | | | |  |  | [dooglius](user?id=dooglius) [4 months ago](item?id=41522282)   | [root](#41518847) | [parent](#41521768) | [prev](#41522015) | [next](#41521863) [–]  I don't think there actually are, in the sense that there isn't a register somewhere with these values that gets compared against, the way there is with rings 0-3. I've only heard this in the context of reverse engineers describing the layers of access that undocumented parts of a modern CPU system have, I think it's just a made-up analogy. There is presumably some proprietary documentation out there with more official names. | | --- | --- | --- | | | |  |  | [BearOso](user?id=BearOso) [4 months ago](item?id=41521863)   | [root](#41518847) | [parent](#41521768) | [prev](#41522282) | [next](#41521854) [–]  I can't imagine it's a standard thing. On X86 we have ring 0 and 3, with 1 and 2 never used and removed in newer CPUs. ARM has 3 or 4 privilege layers, but they're named differently. They probably just called it ring -2 because it's a couple layers below ring 0. | | --- | --- | --- | | | |  |  | [adrian\_b](user?id=adrian_b) [4 months ago](item?id=41522457)   | [root](#41518847) | [parent](#41521863) | [next](#41521951) [–]  Arm (Aarch64) Exception Level 0 corresponds to Ring 3 of x86. Arm (Aarch64) Exception Level 1 corresponds to Ring 0 of x86. Arm (Aarch64) Exception Level 2 corresponds to the Hypervisor level a.k.a. Ring -1 of x86. Arm (Aarch64) Exception Level 3 corresponds to the System Management Mode a.k.a. Ring -2 of x86. Fortunately, in Arm EL3 the same instruction set is used as in any other level, unlike in x86, where SMM uses the obsolete 16-bit 8086 ISA, so for compiling programs that will be executed in SMM you have to use a special tool set. Unfortunately, both the Arm EL3 and the x86 SMM allow the manufacturers of computing devices to do things that are either stupid or in direct contradiction with the interests of the owners of the devices and the owners may not be able to do anything to correct this, unless they can exploit vulnerabilities like the one that has now been patched by AMD. There are no valid arguments for the existence of SMM and EL3 and the fact that they are not forbidden by law is a disgrace for the computing industry. Arm EL3 has been created as an imitation of the Intel SMM. The Intel SMM has been created because Microsoft was too lazy to introduce the required power management functions in the Windows and MS-DOS operating systems, so they passed the task to the motherboard or laptop manufacturers, for which Intel has provided SMM, to enable this. | | --- | --- | --- | | | |  |  | [okanat](user?id=okanat) [4 months ago](item?id=41521951)   | [root](#41518847) | [parent](#41521863) | [prev](#41522457) | [next](#41524815) [–]  Ring -1 is the host system / virtual machine manager when the ring 0 OS is running as a VM. Ring -2 is more privileged than that since it can interrupt Ring -1 and can affect the execution of VM instructions. | | --- | --- | --- | | | |  |  | [colejohnson66](user?id=colejohnson66) [4 months ago](item?id=41524815)   | [root](#41518847) | [parent](#41521863) | [prev](#41521951) | [next](#41524729) [–]  Rings 1 and 2 are still very much present in your desktop x86 machine; Your OS just doesn't use them. *X86-S* will remove them, but no CPUs implement that reduced architecture, and Intel has made no public announcements about future generations that will. | | --- | --- | --- | | | |  |  | [numpad0](user?id=numpad0) [4 months ago](item?id=41524729)   | [root](#41518847) | [parent](#41521863) | [prev](#41524815) | [next](#41521854) [–]  Existing *super*visors use 0, so when x86 virtualization was invented they added -1 for *hyper*visors. and so... are the monitors running on ring -2 *ultra*visors? | | --- | --- | --- | | | |  |  | [veltas](user?id=veltas) [4 months ago](item?id=41521854)   | [root](#41518847) | [parent](#41521768) | [prev](#41521863) | [next](#41518946) [–]  It's called System Management Mode, it's in official Intel documentation for x86. | | --- | --- | --- | | | |  |  | [pella](user?id=pella) [4 months ago](item?id=41518946)   | [prev](#41518847) | [next](#41526612) [–]  AMD fix status: [https://www.amd.com/en/resources/product-security/bulletin/a...](https://www.amd.com/en/resources/product-security/bulletin/amd-sb-7014.html) <https://ubuntu.com/security/CVE-2023-31315> | | --- | --- | --- | | | |  |  | [edelbitter](user?id=edelbitter) [4 months ago](item?id=41524499)   | [parent](#41518946) | [next](#41526612) [–]  > Please refer to your OEM for the BIOS update specific to your product. Unless running hardware also used by powerful hosting providers (some of which care for security), these mitigation will not reach many systems. Checked a few "client" samples, seems like MSI has provided updated binary blobs, ASRock has provided some, Gigabyte has provided broken ones first and then backdated the new ones, ASUS (ROG/RUF/CSM) and Biostar customers are still waiting. | | --- | --- | --- | | | |  |  | [aftbit](user?id=aftbit) [4 months ago](item?id=41526562)   | [root](#41518946) | [parent](#41524499) | [next](#41526612) [–]  So wait, is this fixed in BIOS or microcode? [https://git.kernel.org/pub/scm/linux/kernel/git/firmware/lin...](https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/commit?id=091bd5adf19c7ab01214c64689952acb4833b21d) | | --- | --- | --- | | | |  |  | [yencabulator](user?id=yencabulator) [4 months ago](item?id=41526976)   | [root](#41518946) | [parent](#41526562) | [next](#41526612) [–]  Based on my reading of [https://www.amd.com/en/resources/product-security/bulletin/a...](https://www.amd.com/en/resources/product-security/bulletin/amd-sb-7014.html) there's a microcode fix for EPYC generations 1-4 that requires no downtime, everything else needs a firmware update. | | --- | --- | --- | | | |  |  | [Taniwha](user?id=Taniwha) [4 months ago](item?id=41526612)   | [prev](#41518946) | [next](#41521704) [–]  The paper asks "why does this feature exist?" - probably they haven't gone far enough back in history (note I've worked on x86 clones I understand this stuff in far too great a detail) Originally on x86 systems memory was in VERY short supply - SMM mode memory was the DRAM that the VGA window in low memory (0xa0000) overlaid - normal code couldn't access it because the video card claimed memory accesses to that range of addresses - so the north bridge when the CPU was in SMM mode switched data and instruction accesses to that range to go to DRAM rather than the VGA card .... that's great except remember that SMM mode was used for special setup stuff for laptops .... sometimes they need to be able to display on the screen .... that's what this special mode was originally for: so that SMM mode code can display on the screen (it's also likely why SMM mode graphics were so primitive, you're switching in and out of this mode for every pixel you write) | | --- | --- | --- | | | |  |  | [jandrese](user?id=jandrese) [4 months ago](item?id=41521704)   | [prev](#41526612) | [next](#41523758) [–]  Sometimes it's nice to see SMP causing headaches for the "bad" guys for a change. They did eventually work around it, but half of this paper is working around problems where the second core gets out of sync and crashes as soon as they tried to exploit the system. | | --- | --- | --- | | | |  |  | [cesarb](user?id=cesarb) [4 months ago](item?id=41524122)   | [parent](#41521704) | [next](#41524673) [–]  The most interesting part, to me, was that entering SMM pauses all cores at once, instead of doing the work in a single core like normal interrupts. That sounds like a performance killer, and I hope entering SMM is really rare in modern systems. | | --- | --- | --- | | | |  |  | [jandrese](user?id=jandrese) [4 months ago](item?id=41524309)   | [root](#41521704) | [parent](#41524122) | [next](#41524673) [–]  My information is pretty out of date, but when TPMs first arrived on the scene there was a fair bit of talk about using them as secure enclaves where you could do honest to god "trusted computing" with a fully verified stack on ordinary PC hardware. This largely didn't work out because TPMs were slow and every time you tried to do it you basically stalled out the rest of the machine, so once execution came back to the CPU everything was out of sync and all of the attached hardware like network cards and video cards crashed or froze. TPMs ended up only being useful as a place to store keys and occasionally cryptographically sign small amounts of data. That said, the SMM can probably be a little less intrusive if it needs to be. Like it doesn't have to freeze the cores if all it is doing is reading your bitcoin addresses and passphrase out of memory, just stalling the memory bus for a moment or two. | | --- | --- | --- | | | |  |  | [ein0p](user?id=ein0p) [4 months ago](item?id=41524673)   | [parent](#41521704) | [prev](#41524122) | [next](#41523758) [–]  These aren’t the “bad” guys. The “bad” guys are the people who put that backdoor in, deliberately or through lack of oversight. | | --- | --- | --- | | | |  |  | [transpute](user?id=transpute) [4 months ago](item?id=41523758)   | [prev](#41521704) | [next](#41519631) [–]  Android pKVM hypervisor tries to constrain vendor-specific Arm EL3 TrustZone (~x86 SMM Ring-2) on Pixel 7/8/9, <https://lkml.org/lkml/2022/11/16/1241> ```   pKVM's primary goal is to protect guest pages from a compromised host by enforcing access control restrictions using stage-2 page-tables. Sadly, this cannot prevent TrustZone from accessing non-secure memory, and a compromised host could, for example, perform a 'confused deputy' attack by asking TrustZone to use pages that have been donated to protected guests. This would effectively allow the host to have TrustZone exfiltrate guest secrets on its behalf, hence breaking the isolation that pKVM intends to provide..    FF-A provides (among other things) a set of memory management APIs allowing the Normal World to share, donate or lend pages with Secure. By monitoring these SMCs, pKVM can ensure that the pages that are shared, lent or donated to Secure by the host kernel are only pages that it owns.. the robustness of this approach relies on having all Secure Software on the device use the FF-A protocol for memory management transactions with the normal world, and not use vendor-specific SMCs that pKVM is unable to parse.  ``` On x86, SMM attestation was introduced by Intel (PPAM / Hardware Shield, 11+ gen) and AMD, [https://www.microsoft.com/en-us/security/blog/2020/11/12/sys...](https://www.microsoft.com/en-us/security/blog/2020/11/12/system-management-mode-deep-dive-how-smm-isolation-hardens-the-platform/) *> Because of its traditionally unfettered access to memory and device resources, SMM is a known vector of attack for gaining access to the OS and hardware.. One could have perfect code in SMM and still be affected by behavior like trampolining into secure kernel code.. Isolating SMM is implemented in three parts: OEMs implement a policy that states what they require access to; the chip vendor enforces this policy on SMIs; and the chip vendor reports compliance to this policy to the OS.* | | --- | --- | --- | | | |  |  | [HowardStark](user?id=HowardStark) [4 months ago](item?id=41519631)   | [prev](#41523758) | [next](#41523272) [–]  Is the recorded session available anywhere? Generally prefer the slides with the presenter walking us through them. | | --- | --- | --- | | | |  |  | [RockRobotRock](user?id=RockRobotRock) [4 months ago](item?id=41524426)   | [parent](#41519631) | [next](#41519820) [–]  magnet:?xt=urn:btih:6b0c446541294d6b4ac0cfd6cdedf48e20034ad4&dn=defcon-talks&tr=udp%3A%2F%2Ftracker.opentrackr.org%3A1337%2Fannounce&tr=udp%3A%2F%2Fopen.tracker.cl%3A1337%2Fannounce&tr=udp%3A%2F%2Fopen.demonii.com%3A1337%2Fannounce&tr=udp%3A%2F%2Fopen.stealth.si%3A80%2Fannounce&tr=udp%3A%2F%2Ftracker.torrent.eu.org%3A451%2Fannounce&tr=udp%3A%2F%2Fexplodie.org%3A6969%2Fannounce | | --- | --- | --- | | | |  |  | [colejohnson66](user?id=colejohnson66) [4 months ago](item?id=41519820)   | [parent](#41519631) | [prev](#41524426) | [next](#41526985) [–]  DEF CON recordings tend to take a while to appear. This one was supposedly recorded,[0] but I can't find it. [0]: <https://info.defcon.org/event/?id=54863> | | --- | --- | --- | | | |  |  | [yencabulator](user?id=yencabulator) [4 months ago](item?id=41526985)   | [parent](#41519631) | [prev](#41519820) | [next](#41523272) [–]  It *was* available live for a while. Defcon's video publishing kinda sucks. | | --- | --- | --- | | | |  |  | [paulmd](user?id=paulmd) [4 months ago](item?id=41523272)   | [prev](#41519631) [–]  it's funny that they have to debunk the "root is root, why would AMD patch this" that goes around every time there's a serious issue that allows guest-root escape from virtualized containers. the same thing happened with the ryzenfall/masterkey exploit, where people were just in utter denial there was an actual exploit there, because root is root! People literally spent more time talking about who released it and their background image than the actual exploit. AMD obvious cannot have exploits, that's only an intel thing. /s *"alleged" flaws" (rolls eyes) [https://old.reddit.com/r/Amd/comments/845w8e/alleged\_amd\_zen...](https://old.reddit.com/r/Amd/comments/845w8e/alleged_amd_zen_security_flaws_megathread/)* assassination attempt\* [https://old.reddit.com/r/hardware/comments/849paz/assassinat...](https://old.reddit.com/r/hardware/comments/849paz/assassination_attempt_on_amd_by_viceroy_research/) doxxing the researchers: [https://old.reddit.com/r/hardware/comments/845xks/some\_backg...](https://old.reddit.com/r/hardware/comments/845xks/some_background_information_on_the_new_amd/) [https://old.reddit.com/r/Amd/comments/84tftt/clarification\_a...](https://old.reddit.com/r/Amd/comments/84tftt/clarification_about_the_recent_vulnerabilities/) [https://old.reddit.com/r/Amd/comments/8589t2/cts\_labs\_clarif...](https://old.reddit.com/r/Amd/comments/8589t2/cts_labs_clarifications_on_ryzenfall_masterkey/) HN discussions were not much better, although tpacek is cool. <https://news.ycombinator.com/item?id=16576342> <https://news.ycombinator.com/item?id=16576516> <https://news.ycombinator.com/item?id=16597626> | | --- | --- | --- | | | |  |  | [paulmd](user?id=paulmd) [4 months ago](item?id=41527144)   | [parent](#41523272) [–]  PS: they did release technical details once the mitigations had been released etc. And these were released to tech researchers earlier, and proof of concepts were shown etc. <https://youtu.be/QuqefIZrRWc?t=1005> And, like, the fact that AMD released an urgent patch for it should kind of speak to the severity of the issue in the first place. AMD doesn't patch "sudo lets you do root things", obviously, so it *necessarily* must have been more than that, and this was obvious even at the time. But we have to go through this dance with literally every single AMD exploit. AMD has a *unpatched* exploit in all Zen3 and below processors that leaks data from kernel at a faster rate than meltdown did. It was discovered by the same researchers that discovered meltdown. AMD has chosen to leave that unpatched, and put out a weaselly deflection about "it doesn't cross address boundaries" but they also still refuse to turn KPTI on by default because it would hurt their benchmarks. And without KPTI there is no address boundary to cross, that's the weaselly part. AMD very craftily made it *sound* like they're saying there's not an issue, but in fact they are fully confirming the finding from the researcher, including the suggested mitigation (enabling KPTI), they just don't recommend that you do it. The statement is deliberately short to avoid inclusion of too many details that might dispel these misleading impressions. <https://www.usenix.org/system/files/sec22summer_lipp.pdf> [https://www.amd.com/en/resources/product-security/bulletin/a...](https://www.amd.com/en/resources/product-security/bulletin/amd-sb-1017.html) proof of concept: [https://github.com/amdprefetch/amd-prefetch-attacks/blob/mas...](https://github.com/amdprefetch/amd-prefetch-attacks/blob/master/case-studies/kaslr-break/main.c) tested a few months ago and it's still working: <https://news.ycombinator.com/item?id=40850526> This follows that same researcher (who previously discovered meltdown) uncovering a prior series of vulnerabilities in the cache ways predictor that *also* nullify KASLR... which AMD refused to patch because it "didn't leak actual data, only metadata"... the metadata being the page-table layouts. That one is still unpatched too - as the researchers note, AMD never actually mitigated this either, just more weasel words. [https://www.tomshardware.com/news/new-amd-side-channel-attac...](https://www.tomshardware.com/news/new-amd-side-channel-attacks-discovered-impacts-zen-architecture) <https://mlq.me/download/takeaway.pdf> (this one literally doesn't even seem to have a security bulletin page for itself so I guess they have fully shoved this one down the memory hole now, but here's the news item from wayback) [http://web.archive.org/web/20200325045817/https://www.amd.co...](http://web.archive.org/web/20200325045817/https%3A//www.amd.com/en/corporate/product-security) After 6+ years of watching the community defend this behavior, downplay exploits from their *favorite megacorporation*, etc, it just gets old. Not liking how CTS labs did it or whatever is fine. It doesn't mean there's not a serious exploit, and *so often* that is where people end up with these AMD exploits, they like AMD so much that they argue against the existence or significance of the exploit, attack the researchers or whine about research grants, etc. "Does this really deserve this CVE score" is a constant refrain in AMD vuln threads and it just gets so old. As tptacek noted... intel ME vulns are frontpage news and have people asking where they can buy a processor without ME in it. Literally nobody cares that AMD has had these vulnerabilities left open and unmitigated for years and years even though they're actually worse (as judged by the researcher who found *both* these issues and meltdown). People would have *flipped the fuck out* if Intel left meltdown unpatched and released misleading statements implying that it wasn't an issue etc. It is *wild* just how much AMD is playing on story-mode difficulty with the average enthusiast, and honestly most people don't even realize they're doing it. And that drives me nuts - just decide if security issues are a problem or not, and if the answer is "not" then let's just turn all the mitigations off and see how long they remain un-exploited. If we want to have the security version of the drug-assisted olympics then fine, there is value in having dragsters that just do the thing as quickly as possible, right? But the double-standard people apply to anything AMD is *crazy*. Talk about your "tyranny of low expectations". | | --- | --- | --- | | |
| |  | | --- |   [Guidelines](newsguidelines.html) | [FAQ](newsfaq.html) | [Lists](lists) | [API](https://github.com/HackerNews/API) | [Security](security.html) | [Legal](https://www.ycombinator.com/legal/) | [Apply to YC](https://www.ycombinator.com/apply/) | Contact Search: |



=== Content from www.darkreading.com_825b0cc7_20250111_085027.html ===
![Logo Informa](/build/_assets/informaLogoWhite-RZAE7EJI.png)

TechTarget and Informa Tech’s Digital Business Combine.TechTarget and Informa

## TechTarget and Informa Tech’s Digital Business Combine.

Together, we power an unparalleled network of 220+ online properties covering 10,000+ granular topics, serving an audience of 50+ million professionals with original, objective content from trusted sources. We help you gain critical insights and make more informed decisions across your business priorities.

[Black Hat News](/program/black-hat)[Omdia Cybersecurity](/program/omdia-cybersecurity)[Advertise](https://reg.darkreading.com/media-kit?kcode=drsitehd)[![Dark Reading Logo](https://eu-images.contentstack.com/v3/assets/blt6d90778a997de1cd/blte9ead971f13c662e/65437029846d7c040a6e588d/Logo_-_Dark_Reading.svg?width=476&auto=webp&quality=80&disable=upscale "Dark Reading Logo")](/)[Newsletter Sign-Up](https://dr-resources.darkreading.com/free/w_defa3135/prgm.cgi)[Newsletter Sign-Up](https://dr-resources.darkreading.com/free/w_defa3135/prgm.cgi)Cybersecurity Topics
#### Related Topics

* [Application Security](/application-security)
* [Cybersecurity Careers](/cybersecurity-operations/cybersecurity-careers)
* [Cloud Security](/cloud-security)
* [Cyber Risk](/cyber-risk)
* [Cyberattacks & Data Breaches](/cyberattacks-data-breaches)
* [Cybersecurity Analytics](/cybersecurity-analytics)
* [Cybersecurity Operations](/cybersecurity-operations)
* [Data Privacy](/cyber-risk/data-privacy)
* [Endpoint Security](/endpoint-security)
* [ICS/OT Security](/ics-ot-security)

* [Identity & Access Mgmt Security](/cybersecurity-operations/identity-access-management-security)
* [Insider Threats](/vulnerabilities-threats/insider-threats)
* [IoT](/ics-ot-security/iot)
* [Mobile Security](/endpoint-security/mobile-security)
* [Perimeter](/cybersecurity-operations/perimeter)
* [Physical Security](/cybersecurity-operations/physical-security)
* [Remote Workforce](/endpoint-security/remote-workforce)
* [Threat Intelligence](/threat-intelligence)
* [Vulnerabilities & Threats](/vulnerabilities-threats)
World
#### Related Topics

* [DR Global](/program/dr-global)
* [Middle East & Africa](/keyword/middle-east-africa)

* [Asia Pacific](/keyword/asia-pacific)
[See All](/program/dr-global)[The Edge](/program/the-edge)[DR Technology](/program/dr-technology)Events
#### Related Topics

* [Upcoming Events](/events)
* [Podcasts](/podcasts)

* [Webinars](/resources?types=Webinar)
[SEE ALL](/events)Resources
#### Related Topics

* [Library](/resources)
* [Newsletters](https://dr-resources.darkreading.com/free/w_defa3135/prgm.cgi)
* [Podcasts](/podcasts)
* [Reports](/resources?types=Report)
* [Videos](/videos)
* [Webinars](/resources?types=Webinar)

* [Whitepapers](/resources?types=Whitepaper)
* [Partner Perspectives](/keyword/partner-perspectives)
[SEE ALL](/resources)

* [Remote Workforce](/endpoint-security/remote-workforce)
* [Threat Intelligence](/threat-intelligence)
* [Vulnerabilities & Threats](/vulnerabilities-threats)
* [Endpoint Security](/endpoint-security)

# AMD Issues Updates for Silicon-Level 'SinkClose' Processor FlawAMD Issues Updates for Silicon-Level 'SinkClose' Processor Flaw

The vulnerability has been around for nearly 20 years and gives sophisticated attackers a way to bury virtually undetectable bootkits on devices with EPYC and Ryzen microprocessors.

[![Picture of Jai Vijayan, Contributing Writer](https://eu-images.contentstack.com/v3/assets/blt6d90778a997de1cd/blt1a674355ce57f27b/64f14f228727730c7f926217/Jai-Vijayan.jpeg?width=100&auto=webp&quality=80&disable=upscale "Picture of Jai Vijayan, Contributing Writer")](/author/jai-vijayan)[Jai Vijayan, Contributing Writer](/author/jai-vijayan)

August 12, 2024

4 Min Read![AMD logo on a trade show floor](https://eu-images.contentstack.com/v3/assets/blt6d90778a997de1cd/blt766079a26ab506e2/66ba61172463586736fb9000/amd_JHVEPhoto_shutterstock.jpg?width=1280&auto=webp&quality=95&format=jpg&disable=upscale "AMD logo on a trade show floor")Source: JHVEPhoto via Shutterstock

AMD has issued firmware updates to address a nearly two-decades-old silicon-level vulnerability it its EPYC data center processors and its line of Ryzen processors for PCs and embedded systems.

The flaw affects a component in the processor for protecting System Management Mode (SMM), an execution mode so protected in the processor that it is even more privileged than kernel-level mode. Researchers from IOActive who discovered the privilege escalation vulnerability described it as an "unpatchable" issue that, if exploited, would allow an attacker to implant malware on a system that would be almost impervious to removal attempts.

Hundreds of millions of devices worldwide currently have AMD chips that contain the vulnerability.

## The SinkClose Flaw

The "SinkClose" vulnerability, as IOActive researchers have dubbed it, is somewhat similar to "[Memory Sinkhole](https://www.blackhat.com/docs/us-15/materials/us-15-Domas-The-Memory-Sinkhole-Unleashing-An-x86-Design-Flaw-Allowing-Universal-Privilege-Escalation-wp.pdf)," an SMM-bypass vulnerability in Intel Sandy Bridge and prior processors that security researcher Christopher Domas disclosed at a Black Hat presentation in 2015. Domas has also uncovered [other hardware level vulnerabilities](https://www.darkreading.com/vulnerabilities-threats/hacker-unlocks-god-mode-and-shares-the-key-) in Intel chips.

"The vulnerability is nearly impossible to fix in computers that aren't configured correctly — which is the case for most systems," IOActive said in a statement. "In properly configured systems, the vulnerability could lead to malware infections — known as bootkits — that are nearly impossible to detect."

AMD itself has described the vulnerability as an issue that gives attackers who already have ring0 — or kernel level — access to an affected system a way to potentially modify the SMM even if SMM Lock, a feature for preventing unauthorized SMM modifications, is turned on. "Improper validation in a model specific register (MSR) could allow a malicious program with ring0 access to modify SMM configuration while SMM Lock is enabled, potentially leading to arbitrary code execution," [the chip vendor said](https://www.amd.com/en/resources/product-security/bulletin/amd-sb-7014.html).

SMM is a mode on AMD chips for [low-level system management functions](https://csrc.nist.gov/glossary/term/system_management_mode#:~:text=Definitions%3A,a%20segregated%20block%20of%20memory.). It only executes code from a segregated block of memory called system management random access memory, or SMRAM. AMD chips implement a memory controller called TSeg to protect access to SMRAM.

## SMM Bypass Attack

However, IOActive researchers Enrique Nissim and Krzysztof Okupski found a way to overcome these protections and get SMM to essentially execute code of their choice from outside the SMRAM. They did this by leveraging a feature called TClose that AMD incorporated into its chips for backward compatibility with a legacy memory management feature. Dumas' SinkHole flaw involved a similar legacy feature in Intel chips.

Nissim and Okupski determined an attacker could use the SinkClose flaw to drop malware deep enough — and persistent enough — inside a system to make it invisible to the operating system, the hypervisor, and to all endpoint detection mechanisms. In a talk at the DEF CON hacker conference on Aug. 10, the researchers described the vulnerability as something a remote attacker would be able to exploit. However, an adversary would need an in-depth understanding of AMD chip architecture — something that only a nation-state-level would likely possess — to be able to exploit it.

AMD itself has contended by way of background context that an attacker with the level of access required to exploit the SinkClose vulnerability would already have the ability to read, modify, erase, and snoop on everything on the computer. In addition, someone with operating system kernel-level access can also disable security mechanisms and prevent a computer from booting.

"This is akin to having the knowledge to break into a safe deposit box at the bank," AMD noted in an email to Dark Reading. "In the real world, to get to the box, a burglar must first get past the alarms, the guards, the vault door and its own locks, clearly not an easy task."

An attacker with the skills and knowledge to execute an SMM bypass attack could install malware of the sort IOActive has warned about. But it wouldn't be the first time attackers have deployed such malware, AMD said by way of background, pointing to the [Lojax firmware-level rootkit](https://www.darkreading.com/vulnerabilities-threats/russia-s-sednit-deploys-first-firmware-level-rootkit-in-the-wild) from 2018. "While this malware may be stealthy, it is not invisible or impossible to remediate."

"AMD has released mitigation options for its AMD EPYC datacenter products and AMD Ryzen PC products," the chipmaker said. "A full list of impacted products and mitigation options is available in our [product security bulletin](http://www.amd.com/productsecurity)."

## About the Author

[![Jai Vijayan, Contributing Writer](https://eu-images.contentstack.com/v3/assets/blt6d90778a997de1cd/blt1a674355ce57f27b/64f14f228727730c7f926217/Jai-Vijayan.jpeg?width=400&auto=webp&quality=80&disable=upscale "Jai Vijayan, Contributing Writer")](/author/jai-vijayan)[Jai Vijayan, Contributing Writer](/author/jai-vijayan)

Jai Vijayan is a seasoned technology reporter with over 20 years of experience in IT trade journalism. He was most recently a Senior Editor at Computerworld, where he covered information security and data privacy issues for the publication. Over the course of his 20-year career at Computerworld, Jai also covered a variety of other technology topics, including big data, Hadoop, Internet of Things, e-voting, and data analytics. Prior to Computerworld, Jai covered technology issues for The Economic Times in Bangalore, India. Jai has a Master's degree in Statistics and lives in Naperville, Ill.

[See more from Jai Vijayan, Contributing Writer](/author/jai-vijayan)Keep up with the latest cybersecurity threats, newly discovered vulnerabilities, data breach information, and emerging trends. Delivered daily or weekly right to your email inbox.[Subscribe](https://dr-resources.darkreading.com/free/w_defa3135/prgm.cgi)

You May Also Like

---

More InsightsWebinars

* [Securing Your Cloud Data Across the Attack Timeline](https://dr-resources.darkreading.com/c/pubRD.mpl?secure=1&sr=pp&_t=pp:&qf=w_rubr131&ch=SBX&cid=_upcoming_webinars_8.500001513&_mc=_upcoming_webinars_8.500001513)Jan 15, 2025
* [The Artificial Future Trend Micro Security Predictions for 2025](https://dr-resources.darkreading.com/c/pubRD.mpl?secure=1&sr=pp&_t=pp:&qf=w_tren86&ch=SBX&cid=_upcoming_webinars_8.500001514&_mc=_upcoming_webinars_8.500001514)Jan 16, 2025
* [Tips on Managing Cloud Security in a Hybrid Environment](https://dr-resources.darkreading.com/c/pubRD.mpl?secure=1&sr=pp&_t=pp:&qf=w_defa7708&ch=SBX&cid=_upcoming_webinars_8.500001516&_mc=_upcoming_webinars_8.500001516)Jan 29, 2025
* [How CISOs Navigate the Regulatory and Compliance Maze](https://dr-resources.darkreading.com/c/pubRD.mpl?secure=1&sr=pp&_t=pp:&qf=w_defa7709&ch=SBX&cid=_upcoming_webinars_8.500001515&_mc=_upcoming_webinars_8.500001515)Feb 26, 2025

[More Webinars](/resources?types=Webinar)
### Editor's Choice

["HIPAA Violation" written on a form, surrounded by medical supplies![](https://eu-images.contentstack.com/v3/assets/blt6d90778a997de1cd/bltdd6b0af588407936/677840dcdf4c25052769b491/HIPAA-MedStockPhotos-Alamy.jpg?width=700&auto=webp&quality=80&disable=upscale)](/vulnerabilities-threats/hipaa-security-rules-pull-no-punches)[Vulnerabilities & Threats](/vulnerabilities-threats)[New HIPAA Cybersecurity Rules Pull No Punches](/vulnerabilities-threats/hipaa-security-rules-pull-no-punches)[New HIPAA Cybersecurity Rules Pull No Punches](/vulnerabilities-threats/hipaa-security-rules-pull-no-punches)by[Nate Nelson, Contributing Writer](/author/nate-nelson)Jan 3, 20256 Min Read[Tencent's website homepage![](https://eu-images.contentstack.com/v3/assets/blt6d90778a997de1cd/blt8c247e4dead28202/677d7b6665e8ea50048e4d29/tencent1800_cyberstock_alamy.jpg?width=700&auto=webp&quality=80&disable=upscale)](/cybersecurity-operations/pentagon-chinese-gaming-giant-tencent-federal-ban)[Cybersecurity Operations](/cybersecurity-operations)[Pentagon Adds Chinese Gaming Giant Tencent to Federal Ban](/cybersecurity-operations/pentagon-chinese-gaming-giant-tencent-federal-ban)[Pentagon Adds Chinese Gaming Giant Tencent to Federal Ban](/cybersecurity-operations/pentagon-chinese-gaming-giant-tencent-federal-ban)by[Kristina Beek, Associate Editor, Dark Reading](/author/kristinabeek)Jan 7, 20251 Min Read[A hand about to press a large digital button marked AI on a screen![](https://eu-images.contentstack.com/v3/assets/blt6d90778a997de1cd/blt41dc5f14d8586e1e/675fd155828566e310714e06/genai_Anggalih_Prasetya_shutterstock.jpg?width=700&auto=webp&quality=80&disable=upscale)](/cyber-risk/6-ai-related-security-trends-watch-2025)[Cyber Risk](/cyber-risk)[6 AI-Related Security Trends to Watch in 2025](/cyber-risk/6-ai-related-security-trends-watch-2025)[6 AI-Related Security Trends to Watch in 2025](/cyber-risk/6-ai-related-security-trends-watch-2025)by[Jai Vijayan, Contributing Writer](/author/jai-vijayan)Dec 31, 20246 Min ReadReports

* [The State of Firewall Security: Challenges, Risks, and Solutions for Modern Networks](https://dr-resources.darkreading.com/c/pubRD.mpl?secure=1&sr=pp&_t=pp:&qf=w_tufi07&ch=SBX&cid=_analytics_7.300006029&_mc=_analytics_7.300006029)Jan 10, 2025
* [Industrial Networks in the Age of Digitalization](https://darkreading.tradepub.com/c/pubRD.mpl?secure=1&sr=pp&_t=pp:&qf=w_defa5682&ch=sbx&cid=_analytics_7.300006028&_mc=_analytics_7.300006028)Jan 6, 2025
* [Zero-Trust Adoption Driven by Data Protection, Cloud Access Control, and Regulatory Compliance Requirements](https://darkreading.tradepub.com/c/pubRD.mpl?secure=1&sr=pp&_t=pp:&qf=w_defa5681&ch=sbx&cid=_analytics_7.300006027&_mc=_analytics_7.300006027)Jan 6, 2025
* [Threat Hunting's Evolution: From On-Premises to the Cloud](https://dr-resources.darkreading.com/c/pubRD.mpl?secure=1&sr=pp&_t=pp:&qf=w_logr41&ch=sbx&cid=_analytics_7.300006026&_mc=_analytics_7.300006026)Jan 6, 2025
* [How Enterprises Secure Their Applications](https://dr-resources.darkreading.com/c/pubRD.mpl?secure=1&sr=pp&_t=pp:&qf=w_defa6150&ch=sbx&cid=_analytics_7.300006025&_mc=_analytics_7.300006025)Jan 6, 2025

[More Reports](/resources?types=Report)Webinars

* [Securing Your Cloud Data Across the Attack Timeline](https://dr-resources.darkreading.com/c/pubRD.mpl?secure=1&sr=pp&_t=pp:&qf=w_rubr131&ch=SBX&cid=_upcoming_webinars_8.500001513&_mc=_upcoming_webinars_8.500001513)Jan 15, 2025
* [The Artificial Future Trend Micro Security Predictions for 2025](https://dr-resources.darkreading.com/c/pubRD.mpl?secure=1&sr=pp&_t=pp:&qf=w_tren86&ch=SBX&cid=_upcoming_webinars_8.500001514&_mc=_upcoming_webinars_8.500001514)Jan 16, 2025
* [Tips on Managing Cloud Security in a Hybrid Environment](https://dr-resources.darkreading.com/c/pubRD.mpl?secure=1&sr=pp&_t=pp:&qf=w_defa7708&ch=SBX&cid=_upcoming_webinars_8.500001516&_mc=_upcoming_webinars_8.500001516)Jan 29, 2025
* [How CISOs Navigate the Regulatory and Compliance Maze](https://dr-resources.darkreading.com/c/pubRD.mpl?secure=1&sr=pp&_t=pp:&qf=w_defa7709&ch=SBX&cid=_upcoming_webinars_8.500001515&_mc=_upcoming_webinars_8.500001515)Feb 26, 2025

[More Webinars](/resources?types=Webinar)White Papers

* [Social Engineering: New Tricks, New Threats, New Defenses](https://dr-resources.darkreading.com/c/pubRD.mpl?secure=1&sr=pp&_t=pp:&qf=w_defa7688&ch=SBX&cid=_whitepaper_14.500005861&_mc=_whitepaper_14.500005861)
* [Delivering Incident Response Excellence: How Wipro enhances customer services with automated investigation and response](https://dr-resources.darkreading.com/c/pubRD.mpl?secure=1&sr=pp&_t=pp:&qf=w_defa7504&ch=SBX&cid=_whitepaper_14.500005853&_mc=_whitepaper_14.500005853)
* [From security alert to action: Accelerating incident response with automated investigations](https://dr-resources.darkreading.com/c/pubRD.mpl?secure=1&sr=pp&_t=pp:&qf=w_defa7505&ch=SBX&cid=_whitepaper_14.500005852&_mc=_whitepaper_14.500005852)
* [6 Key Requirements of Multicloud Security](https://dr-resources.darkreading.com/c/pubRD.mpl?secure=1&sr=pp&_t=pp:&qf=w_palo246&ch=SBX&cid=_whitepaper_14.500005833&_mc=_whitepaper_14.500005833)
* [The State of Cloud Native Security Report 2024](https://dr-resources.darkreading.com/c/pubRD.mpl?secure=1&sr=pp&_t=pp:&qf=w_palo245&ch=SBX&cid=_whitepaper_14.500005832&_mc=_whitepaper_14.500005832)

[More Whitepapers](/resources?types=Whitepaper)[![Logo](https://eu-images.contentstack.com/v3/assets/blt6d90778a997de1cd/blt6aed714e279eeb34/6542104467527c040a9b2014/Logo_-_Dark_Reading.svg?width=700&auto=webp&quality=80&disable=upscale "Logo")](/)
##### Discover More

[Black Hat](/program/black-hat)[Omdia](/program/omdia-cybersecurity)
##### Working With Us

[About Us](/about-us)[Advertise](/advertise)[Reprints](https://info.wrightsmedia.com/informa-licensing-reprints-request)
##### Join Us

[Newsletter Sign-Up](https://dr-resources.darkreading.com/free/w_defa3135/prgm.cgi)
##### Follow Us

[![Informa](https://eu-images.contentstack.com/v3/assets/blt6d90778a997de1cd/bltb3f56b75133715aa/674ee1ace1b5ac19f79ca74e/Informa_Logo_OneLine_Graduated_White_RGB.png?width=700&auto=webp&quality=80&disable=upscale "Informa")](https://www.informa.com)

Copyright © 2025. This website is owned and operated by Informa TechTarget, part of a global network that informs, influences and connects the world’s technology buyers and sellers. All copyright resides with them. Informa PLC’s registered office is 5 Howick Place, London SW1P 1WG. Registered in England and Wales. TechTarget, Inc.’s registered office is 275 Grove St. Newton, MA 02466.

[Home|](https://www.informatech.com/)[Cookie Policy|](/cookie-policy)[Privacy|](https://www.techtarget.com/privacy-policy/)[Terms of Use](https://www.informatech.com/terms-and-conditions/)


=== Content from www.amd.com_c9c0c52f_20250111_085025.html ===

[AMD Website Accessibility Statement](/en/site-notifications/accessibility-statement.html)

[![AMD Logo](/content/dam/code/images/header/amd-header-logo.svg "AMD Logo")](/en.html)

* Products
   Processors

   Accelerators

   Graphics

   Adaptive SoCs, FPGAs, & SOMs

   Software, Tools, & Apps

  [Processors](#headerMenu-c4add7cc9c-item-7fd7783542-collapse)

  ###### Servers

  + [EPYC](https://www.amd.com/en/products/processors/server/epyc.html)

  ###### Business Systems

  + [Laptops](https://www.amd.com/en/products/processors/laptop/ryzen-for-business.html)
  + [Desktops](https://www.amd.com/en/products/processors/ryzen-for-professionals.html)
  + [Ryzen AI for Business](https://www.amd.com/en/products/processors/business-systems/ryzen-ai.html)

  ###### Workstations

  + [Ryzen Threadripper](https://www.amd.com/en/products/processors/workstations/ryzen-threadripper.html)
  + [Ryzen PRO for Mobile Workstations](https://www.amd.com/en/products/processors/workstations/mobile.html)
  + [Ryzen](https://www.amd.com/en/products/processors/ryzen-for-creators.html)

  ###### Embedded

  + [EPYC and Ryzen](https://www.amd.com/en/products/embedded.html)
  + [Partner Ecosystem](https://www.amd.com/en/products/embedded/ecosystem.html)
  + [Industry Solutions](https://www.amd.com/en/products/embedded/solutions.html)

  ###### Personal Laptops

  + [AMD Advantage Premium](https://www.amd.com/en/gaming/laptops/advantage-premium.html)
  + [Ryzen with Radeon Graphics](https://www.amd.com/en/products/processors/laptop/ryzen.html)
  + [Athlon with Radeon Graphics](https://www.amd.com/en/products/processors/laptop/athlon.html)
  + [Ryzen AI for Consumer](https://www.amd.com/en/products/processors/consumer/ryzen-ai.html)

  ###### Personal Desktops

  + [AMD Advantage Premium](https://www.amd.com/en/gaming/desktops/advantage-premium.html)
  + [Ryzen](https://www.amd.com/en/products/processors/desktops/ryzen.html)
  + [Athlon with Radeon Graphics](https://www.amd.com/en/products/processors/desktops/athlon.html)

  ###### Handheld

  + [Ryzen Z Series](https://www.amd.com/en/products/processors/handhelds/ryzen-z-series.html)

  ###### Resources

  + [Data Center Blogs & Insights](https://www.amd.com/en/solutions/data-center/insights.html)
  + [Client & Data Center Tech Docs](https://www.amd.com/en/search/documentation/hub.html#sortCriteria=%40amd_release_date%20descending&f-amd_archive_status=Active&f-amd_audience=Technical)
  + [EPYC White Papers & Briefs](https://www.amd.com/en/search/documentation/hub.html#sortCriteria=%40amd_release_date%20descending&f-amd_document_type=Solution%20Briefs,Performance%20Briefs,White%20Papers,Product%20Briefs&f-amd_archive_status=Active&f-amd_product_brand=EPYC,Instinct&f-amd_form_factor=Servers)
  + [EPYC Tuning Guides](https://www.amd.com/en/search/documentation/hub.html#sortCriteria=%40amd_release_date%20descending&f-amd_document_type=Tuning%20Guides&f-amd_archive_status=Active&f-amd_product_brand=EPYC)
  + [Product Specifications](https://www.amd.com/en/products/specifications.html)

  [Accelerators](#headerMenu-c4add7cc9c-item-9a5ba2c03f-collapse)

  ###### GPU Accelerators

  + [Instinct Accelerators](https://www.amd.com/en/products/accelerators/instinct.html)
  + [Documentation](https://www.amd.com/en/search/documentation/hub.html#sortCriteria=%40amd_release_date%20descending&f-amd_product_type=Accelerators)
  + [Cloud Graphics](https://www.amd.com/en/products/accelerators/radeon-pro.html)

  ###### Adaptive Accelerators

  + [Alveo Data Center Accelerator Cards](https://www.amd.com/en/products/accelerators/alveo.html)
  + [Telco Accelerator Cards](https://www.amd.com/en/solutions/telco-and-networking/telco-accelerators.html)

  ###### DPU Accelerators

  + [Pensando Salina](https://www.amd.com/en/products/accelerators/pensando.html)
  + [Aruba CX 10000 with Pensando](https://www.amd.com/en/products/accelerators/pensando.html)

  ###### Ethernet Adapters

  + [Pensando Pollara 400](https://www.amd.com/en/products/accelerators/pensando.html)
  + [Alveo X3 Series](https://www.amd.com/en/products/accelerators/alveo/x3/a-x3522-p08g-pq-g.html)
  + [NIC X2 Series Offload](https://www.amd.com/en/products/ethernet-adapters.html)

  [Graphics](#headerMenu-c4add7cc9c-item-a162ccaef2-collapse)

  ###### Workstations

  + [Radeon PRO](https://www.amd.com/en/products/graphics/workstations.html)

  ###### Desktops

  + [AMD Advantage Premium](https://www.amd.com/en/gaming/desktops/advantage-premium.html)
  + [Radeon RX](https://www.amd.com/en/products/graphics/desktops/radeon.html)

  ###### Laptops

  + [AMD Advantage Premium](https://www.amd.com/en/gaming/laptops/advantage-premium.html)
  + [Radeon Mobile Graphics](https://www.amd.com/en/products/graphics/laptops/radeon.html)

  ###### Resources

  + [Product Specifications](https://www.amd.com/en/products/specifications.html)
  + [Documentation](https://gpuopen.com/learn/)

  [Adaptive SoCs, FPGAs, & SOMs](#headerMenu-c4add7cc9c-item-89a4ef27bd-collapse)

  ###### Adaptive SoCs & FPGAs

  + [Versal Portfolio](https://www.amd.com/en/products/adaptive-socs-and-fpgas/versal.html)
  + [SoC Portfolio](https://www.amd.com/en/products/adaptive-socs-and-fpgas/soc.html)
  + [FPGA Portfolio](https://www.amd.com/en/products/adaptive-socs-and-fpgas/fpga.html)
  + [Cost-Optimized Portfolio](https://www.amd.com/en/products/adaptive-socs-and-fpgas/cost-optimized-portfolio.html)

  ###### System-on-Modules (SOMs)

  + [SOM Overview](https://www.amd.com/en/products/system-on-modules.html)
  + [Kria SOMs](https://www.amd.com/en/products/system-on-modules/kria.html)
  + [KD240 Drives Starter Kit](https://www.amd.com/en/products/system-on-modules/kria/k24/kd240-drives-starter-kit.html)
  + [KV260 Vision AI Starter Kit](https://www.amd.com/en/products/system-on-modules/kria/k26/kv260-vision-starter-kit.html)
  + [KR260 Robotics Starter Kit](https://www.amd.com/en/products/system-on-modules/kria/k26/kr260-robotics-starter-kit.html)

  ###### Technologies

  + [AI Engine](https://www.amd.com/en/products/adaptive-socs-and-fpgas/technologies/ai-engine.html)
  + [Design Security](https://www.amd.com/en/products/adaptive-socs-and-fpgas/technologies/design-security.html)
  + [Digital Signal Processing](https://www.amd.com/en/products/adaptive-socs-and-fpgas/technologies/digital-signal-processing.html)
  + [Functional Safety](https://www.amd.com/en/products/adaptive-socs-and-fpgas/technologies/functional-safety.html)
  + [High Speed Serial](https://www.amd.com/en/products/adaptive-socs-and-fpgas/technologies/high-speed-serial.html)
  + [Memory Solutions](https://www.amd.com/en/products/adaptive-socs-and-fpgas/technologies/memory.html)
  + [Power Efficiency](https://www.amd.com/en/products/adaptive-socs-and-fpgas/technologies/power-efficiency.html)

  ###### Resources

  + [Intellectual Property](https://www.xilinx.com/products/intellectual-property.html)
  + [Design Hubs](https://docs.amd.com/p/design-hubs)
  + [Developer Hub](https://www.amd.com/en/developer/browse-by-product-type/adaptive-resources.html)
  + [Customer Training](https://learningcatalog-amd.netexam.com/)

  ###### Evaluation Boards & Kits

  + [Evaluation Boards](https://www.xilinx.com/products/boards-and-kits.html)
  + [Boards & Kits Accessories](https://www.xilinx.com/products/boards-and-kits/board-and-kit-accessories.html)

  [Software, Tools, & Apps](#headerMenu-c4add7cc9c-item-bdabeadece-collapse)

  ###### Processor Tools

  + [Ryzen Master Overclocking Utility](https://www.amd.com/en/products/software/ryzen-master.html)
  + [PRO Manageability / DMTF DASH](https://www.amd.com/en/products/processors/technologies/pro-technologies.html)
  + [StoreMI](https://www.amd.com/en/products/software/storemi.html)
  + [Ryzen AI Software](https://www.amd.com/en/products/software/ryzen-ai-software.html)
  + [Zen Software Studio](/en/developer/zen-software-studio.html)

  ###### Graphics Tools & Apps

  + [AMD Software: Adrenalin Edition](https://www.amd.com/en/products/software/adrenalin.html)
  + [AMD Software: PRO Edition](https://www.amd.com/en/products/processors/technologies/pro-technologies.html)
  + [FidelityFX](https://www.amd.com/en/products/graphics/technologies/fidelityfx.html)
  + [Radeon ProRender](https://www.amd.com/en/products/graphics/software/radeon-prorender.html)

  ###### Adaptive SoC & FPGA Tools

  + [Design Tools](https://www.amd.com/en/products/software/adaptive-socs-and-fpgas.html)
  + [Vivado Software](https://www.amd.com/en/products/software/adaptive-socs-and-fpgas/vivado.html)
  + [Vitis Software](https://www.amd.com/en/products/software/adaptive-socs-and-fpgas/vitis.html)
  + [Vitis Model Composer](https://www.amd.com/en/products/software/adaptive-socs-and-fpgas/vitis/vitis-model-composer.html)
  + [Vitis HLS](https://www.amd.com/en/products/software/adaptive-socs-and-fpgas/vitis/vitis-hls.html)
  + [Vitis AI](https://www.amd.com/en/products/software/vitis-ai.html)
  + [Embedded Software](https://www.amd.com/en/products/software/adaptive-socs-and-fpgas/embedded-software.html)
  + [Power Design Manager](https://www.amd.com/en/products/software/adaptive-socs-and-fpgas/power-design-manager.html)

  ###### Intellectual Property & Apps

  + [Pre-Built IP Cores](https://www.xilinx.com/products/intellectual-property.html)
  + [Alveo Accelerator App Store](https://www.amd.com/en/developer/resources/alveo-apps/all-apps.html)
  + [Kria SOM App Store](https://www.amd.com/en/developer/resources/kria-apps.html)

  ###### GPU Accelerator Tools & Apps

  + [ROCm Open Software](https://www.amd.com/en/products/software/rocm.html)
  + [Infinity Hub Software Containers](https://www.amd.com/en/developer/resources/infinity-hub.html)
* Solutions
   AI

   Industries

   Workloads

   Gaming

  [AI](#headerMenu-c13975b6ca-item-5f064e1f45-collapse)

  ###### Overview

  + [AI Solutions](/en/solutions/ai.html)
  + [Sovereign AI](https://www.amd.com/en/solutions/ai/sovereign-ai.html)
  + [Blogs](https://community.amd.com/t5/ai/bg-p/amd-ai)
  + [Case Studies](https://www.amd.com/en/resources/case-studies.html#q=AI)
  + [Press Releases](/en/newsroom/press-release-search.html#q=AI)

  ###### For Data Center & Cloud

  + [GPUÂ Accelerators](https://www.amd.com/en/products/accelerators/instinct/mi300.html)
  + [Adaptive Accelerators](https://www.xilinx.com/applications/data-center/v70.html)
  + [Adaptive SoCs for Data Center](https://www.amd.com/en/products/accelerators/alveo/v70.html)
  + [ServerÂ Processors](https://www.amd.com/en/products/processors/server/epyc/ai.html)

  ###### For Edge & Endpoints

  + [Ryzen AI for Business](https://www.amd.com/en/products/processors/business-systems/ryzen-ai.html)
  + [Ryzen AI for Consumer](https://www.amd.com/en/products/processors/consumer/ryzen-ai.html)
  + [Radeon Graphics Cards](https://www.amd.com/en/products/graphics/radeon-ai.html)
  + [Adaptive SoCsÂ forÂ Edge](https://www.amd.com/en/products/adaptive-socs-and-fpgas/versal/gen2/ai-edge-series.html)
  + [Adaptive SoCs for Embedded](https://www.amd.com/en/products/adaptive-socs-and-fpgas/soc.html)
  + [System-on-Modules (SOMs)](https://www.amd.com/en/products/system-on-modules/kria.html)

  ###### For Developers

  + [ROCm Developer Hub](https://www.amd.com/en/developer/resources/rocm-hub.html)
  + [Vitis AI DevelopmentÂ Platform](https://www.amd.com/en/products/software/vitis-ai.html)
  + [ZenDNNÂ Inference Libraries](https://www.amd.com/en/developer/zendnn.html)
  + [Ryzen AI Software](https://www.amd.com/en/developer/resources/ryzen-ai-software.html)

  [Industries](#headerMenu-c13975b6ca-item-473082234e-collapse)

  ###### Industries

  ###### Industries

  + [Aerospace & Defense](https://www.amd.com/en/solutions/aerospace-and-defense.html)
  + [Architecture, Engineering, & Construction](https://www.amd.com/en/solutions/architecture-engineering-and-construction.html)
  + [Automotive](/en/solutions/automotive.html)
  + [Broadcast & Pro AV](https://www.amd.com/en/solutions/broadcast-and-pro-av.html)
  + [Energy](https://www.amd.com/en/solutions/energy.html)

  ###### Industries

  + [Emulation & Prototyping](https://www.amd.com/en/solutions/emulation-prototyping.html)
  + [Financial Services](https://www.amd.com/en/solutions/financial-services.html)
  + [Healthcare](https://www.amd.com/en/solutions/healthcare.html)
  + [Home & Lifestyle](https://www.amd.com/en/solutions/home-and-lifestyle.html)
  + [Industrial & Vision](https://www.amd.com/en/solutions/industrial.html)

  ###### Industries

  + [Manufacturing](https://www.amd.com/en/solutions/manufacturing.html)
  + [Media & Entertainment](https://www.amd.com/en/solutions/media-and-entertainment.html)
  + [Product Design](https://www.amd.com/en/solutions/product-design.html)
  + [Public Sector](https://www.amd.com/en/solutions/public-sector.html)
  + [Retail & E-Commerce](https://www.amd.com/en/solutions/retail-and-ecommerce.html)

  ###### Industries

  + [Semiconductor](https://www.amd.com/en/solutions/semiconductor.html)
  + [Supercomputing & Research](https://www.amd.com/en/solutions/supercomputing-and-research.html)
  + [Telco & Networking](https://www.amd.com/en/solutions/telco-and-networking.html)
  + [Test & Measurement](https://www.amd.com/en/solutions/test-and-measurement.html)

  [Workloads](#headerMenu-c13975b6ca-item-7ace91741c-collapse)

  ###### Workloads

  + [AI](https://www.amd.com/en/solutions/ai.html)
  + [Cloud Computing](https://www.amd.com/en/solutions/data-center/cloud-computing.html)
  + [Database & Analytics](https://www.amd.com/en/solutions/database-and-analytics.html)

  + [Embedded Computing](https://www.amd.com/en/solutions/embedded-computing.html)
  + [HCI & Virtualization](https://www.amd.com/en/solutions/hci-and-virtualization.html)

  + [High Performance Computing](https://www.amd.com/en/solutions/high-performance-computing.html)
  + [Infrastructure Acceleration](https://www.amd.com/en/solutions/data-center/infrastructure-acceleration.html)

  [Gaming](#headerMenu-c13975b6ca-item-c7064786cc-collapse)

  ###### Gaming

  + [Gaming with AMD](https://www.amd.com/en/gaming.html)
  + [Featured Games](https://www.amd.com/en/gaming/featured-games.html)

  ###### Systems

  + [Advantage Gaming Systems](https://www.amd.com/en/gaming/advantage.html)
  + [Gaming Desktops](https://www.amd.com/en/gaming/desktops.html)
  + [Gaming Laptops](https://www.amd.com/en/gaming/laptops.html)
  + [Gaming Handhelds](https://www.amd.com/en/gaming/handhelds.html)

  ###### Technologies

  + [Smart Technologies](https://www.amd.com/en/gaming/technologies/smart-technologies.html)
  + [FidelityFX Super Resolution](https://www.amd.com/en/products/graphics/technologies/fidelityfx/super-resolution.html)
  + [FreeSync](https://www.amd.com/en/products/graphics/technologies/freesync.html)
  + [HYPR-RX](https://www.amd.com/en/products/software/adrenalin/hypr-rx.html)

  ###### Resources

  + [Red Team Community](https://community.amd.com/t5/red-team/ct-p/red-team)
  + [AMD Software: Adrenalin Edition](https://www.amd.com/en/products/software/adrenalin.html)
* Resources & Support
   Downloads

   Developer Resources

   Partner Resources

   Support

  [Downloads](#headerMenu-95dee59baf-item-f2931226c7-collapse)

  ###### EPYC Processors

  + [Client & Data Center Tech Docs](https://www.amd.com/en/search/documentation/hub.html#sortCriteria=%40amd_release_date%20descending&f-amd_archive_status=Active&f-amd_audience=Technical)
  + [EPYC White Papers & Briefs](https://www.amd.com/en/search/documentation/hub.html#sortCriteria=%40amd_release_date%20descending&f-amd_document_type=Solution%20Briefs,Performance%20Briefs,White%20Papers,Product%20Briefs&f-amd_archive_status=Active&f-amd_product_brand=EPYC,Instinct&f-amd_form_factor=Servers)
  + [EPYC Tuning Guides](https://www.amd.com/en/search/documentation/hub.html#sortCriteria=%40amd_release_date%20descending&f-amd_document_type=Tuning%20Guides&f-amd_archive_status=Active&f-amd_product_brand=EPYC)

  ###### Radeon Graphics & AMD Chipsets

  + [Drivers](https://www.amd.com/en/support/download/drivers.html)
  + [Radeon ProRender Plug-ins](https://www.amd.com/en/products/graphics/software/radeon-prorender.html)
  + [PRO Certified ISV Applications](https://www.amd.com/en/search/certified-drivers.html)

  ###### Adaptive SoCs & FPGAs

  + [Vivado Design Suite](https://www.xilinx.com/support/download/index.html/content/xilinx/en/downloadNav/vivado-design-tools.html)
  + [Vitis Software Platform](https://www.xilinx.com/support/download/index.html/content/xilinx/en/downloadNav/vitis.html)
  + [Vitis Accelerated Libraries](https://github.com/Xilinx/Vitis_Libraries)
  + [Vitis Embedded Platforms](https://www.xilinx.com/support/download/index.html/content/xilinx/en/downloadNav/embedded-platforms.html)
  + [PetaLinux Tools](https://www.xilinx.com/support/download/index.html/content/xilinx/en/downloadNav/embedded-design-tools.html)
  + [Adaptive SoCs & FPGAs](https://www.xilinx.com/support/download/index.html/content/xilinx/en/downloadNav/device-models.html)
  + [Package Pinout Files](https://www.xilinx.com/support/package-pinout-files.html)
  + [Power Design Manger](https://www.xilinx.com/support/download/index.html/content/xilinx/en/downloadNav/power-design-manager.html)

  ###### Alveo Accelerators & Kria SOMs

  + [Alveo Package Files](https://www.xilinx.com/support/download/index.html/content/xilinx/en/downloadNav/alveo.html)
  + [Alveo App Store](https://www.amd.com/en/developer/resources/alveo-apps/all-apps.html)
  + [Kria App Store](https://www.amd.com/en/developer/resources/kria-apps.html)

  ###### Ryzen Processors

  + [Ryzen Master Overclocking Utility](https://www.amd.com/en/products/software/ryzen-master.html)
  + [StoreMI](https://www.amd.com/en/products/software/storemi.html)
  + [PRO Manageability Tools for IT Administrators](https://www.amd.com/en/support/downloads/manageability-tools.html)

  ###### Ethernet Adapters

  + [NIC Software & Downloads](https://www.xilinx.com/support/download/nic-software-and-drivers.html)

  [Developer Resources](#headerMenu-95dee59baf-item-8126f0ed47-collapse)

  ###### Overview

  + [Developer Central](/en/developer.html)

  ###### Processors

  + [Zen Software Studio](/en/developer/zen-software-studio.html)
  + [EPYC Tuning Guides](https://www.amd.com/en/search/documentation/hub.html#sortCriteria=%40amd_release_date%20descending&f-amd_document_type=Tuning%20Guides&f-amd_archive_status=Active&f-amd_product_brand=EPYC)
  + [EPYC Whitepapers & Briefs](https://www.amd.com/en/search/documentation/hub.html#sortCriteria=%40amd_release_date%20descending&f-amd_document_type=Solution%20Briefs,Performance%20Briefs,White%20Papers,Product%20Briefs&f-amd_archive_status=Active&f-amd_product_brand=EPYC,Instinct&f-amd_form_factor=Servers)
  + [Ryzen AI Software](https://www.amd.com/en/developer/resources/ryzen-ai-software.html)

  ###### Accelerators

  + [ROCm Developer Hub](https://www.amd.com/en/developer/resources/rocm-hub.html)
  + [ROCm Documentation](https://rocm.docs.amd.com/en/latest/)
  + [Infinity Hub Software Containers](https://www.amd.com/en/developer/resources/infinity-hub.html)
  + [Pensando DPUs](https://www.amd.com/en/developer/browse-by-resource-type/software-tools.html#dpu-accelerators)

  ###### Adaptive SoCs, FPGAs, & SOMs

  + [Vivado Design Suite](https://www.amd.com/en/developer/resources/vivado.html)
  + [Vitis Software Developer Tools](https://www.amd.com/en/developer/resources/vitis.html)
  + [Vitis AI Developer Tools](https://www.amd.com/en/developer/resources/vitis-ai.html)
  + [Documentation](https://docs.amd.com/)
  + [Product Training](https://learningcatalog-amd.netexam.com/)
  + [Partner Solutions](https://www.xilinx.com/xilinx-partner-program/partner-solutions.html)

  ###### Graphics

  + [GPUOpen Open Source Tools](https://gpuopen.com/)
  + [Documentation](https://gpuopen.com/learn/)

  [Partner Resources](#headerMenu-95dee59baf-item-1866eb47aa-collapse)

  ###### Overview

  + [Partner Hub Home](https://www.amd.com/en/partner.html)

  Â

  Â

  ###### Resources by Market Segment

  + [For Data Center Marketing Partners](/en/partner/market/data-center-partner-marketing.html)
  + [For PC Marketing Partners](/en/partner/market/pc-marketing-partners.html)

  ###### Resources by Product

  + [AMD Instinct](/en/partner/browse-by-product/instinct-resources.html)
  + [EPYC](/en/partner/browse-by-product/epyc-resources.html)
  + [Ryzen PRO](/en/partner/browse-by-product/ryzen-pro-resources.html)
  + [Ryzen](/en/partner/browse-by-product/ryzen-resources.html)
  + [Ryzen Threadripper](/en/partner/browse-by-product/ryzen-threadripper-resources.html)
  + [Radeon PRO](/en/partner/browse-by-product/radeon-pro-resources.html)
  + [Radeon](/en/partner/browse-by-product/radeon-resources.html)

  ###### Resources by Type

  + [Partner Enablement Doc Hub](/en/partner/browse-by-resource/partner-enablement-doc-hub.html)
  + [Partner Insights Articles](/en/partner/browse-by-resource/partner-insights-articles.html)
  + [AMD Arena Training](/en/partner/browse-by-resource/amd-arena-training.html)
  + [Meet the Experts Webinars](/en/partner/browse-by-resource/meet-the-experts-webinars.html)
  + [Marketing Materials](/en/partner/browse-by-resource/marketing-materials.html)
  + [Partner FAQs](/en/partner/browse-by-resource/faqs.html)

  ###### About Our Partners

  + [Authorized Distributors](/en/partner/about-partners/authorized-distributors.html)
  + [Partner Motherboard Specifications](/en/partner/about-partners/motherboard-specifications.html)
  + [Partner Graphics Card Specifications](/en/partner/about-partners/graphics-card-specifications.html)

  [Support](#headerMenu-95dee59baf-item-498b9948f9-collapse)

  ###### AMD Global Support

  + [Support Home](https://www.amd.com/en/support.html)
  + [Technical Information Portal](https://docs.amd.com/)
  + [Warranty Services](https://www.amd.com/en/support/warranty.html)
  + [Product Specifications](https://www.amd.com/en/products/specifications.html)
  + [Product Security (PSIRT)](https://www.amd.com/en/resources/product-security.html)

  ###### Processors & Graphics

  + [Product Support](https://www.amd.com/en/forms/contact-us/support.html)
  + [Knowledge Base](https://www.amd.com/en/resources/support-articles/knowledge-base-search.html)
  + [Technical & Warranty Help](https://www.amd.com/en/support.html)
  + [Support Forums](https://community.amd.com/t5/support-forums/ct-p/supprtforums)
  + [Drivers & Software Downloads](https://www.amd.com/en/support/download/drivers.html)

  ###### Accelerators

  + [Alveo Product Support](https://adaptivesupport.amd.com/s/?language=en_US)
  + [Pensando Product Support](https://www.amd.com/en/support/accelerators/pensando.html)

  Â

  ###### Adaptive SoCs & FPGAs

  + [Product Support](https://adaptivesupport.amd.com/)
  + [Knowledge Base](https://adaptivesupport.amd.com/s/knowledge-base)
  + [Community Forums](https://adaptivesupport.amd.com/s/topiccatalog)
  + [Design Hubs](https://docs.amd.com/p/design-hubs)
  + [Product Return](https://www.xilinx.com/support/quality/product-return.html)
* Shop
   Shop AMD

  [Shop AMD](#headerMenu-2240f775fe-item-de1bf49851-collapse)

  ###### Gaming & Personal Computing

  + [Ryzen Processors](https://shop-us-en.amd.com/processors)
  + [Promotions & Bundles](https://shop-us-en.amd.com/amd-promotions/)
  + [Shop All](https://shop-us-en.amd.com/)

  ###### Adaptive & Embedded Computing

  + [System-on-Modules (SOMs)](https://shop-us-en.amd.com/adaptive-embedded-computing/system-on-modules/)
  + [Data Center Accelerator Cards](https://shop-us-en.amd.com/adaptive-embedded-computing/data-center-accelerator-cards/)
  + [Adaptive SoC & FPGA Evaluation Kits](https://shop-us-en.amd.com/adaptive-embedded-computing/soc-fpga-evaluation-kits/)

  ###### Get AMD Fan Gear

  + [Visit the Store](https://amdfanstore.com/)

  ###### Shop Our Retail Partners

  + [Ryzen Processors](/en/where-to-buy/processors/ryzen.html)
  + [Radeon Graphics Cards](https://www.amd.com/en/where-to-buy/graphics/radeon.html)
  + [Advantage Laptops](https://www.amd.com/en/gaming/laptops/advantage-premium.html)
  + [Advantage Desktops](https://www.amd.com/en/gaming/desktops/advantage-premium.html)
  + [Gaming Handhelds](https://www.amd.com/en/gaming/handhelds.html)

* + [My Account](https://account.amd.com/en/profile.html)
  + [Create Account](https://www.amd.com/en/registration/create-account.html)

* + [English](/en/resources/product-security/bulletin/amd-sb-7014.html)
  + [ç®ä½ä¸­æ](/zh-cn.html)
  + [ç¹é«ä¸­æ](/zh-tw.html)
  + [FranÃ§ais](/fr.html)
  + [Deutsch](/de.html)
  + [æ¥æ¬èª](/ja.html)
  + [íêµ­ì´](/ko.html)
  + [PortuguÃªs](/pt.html)
  + [EspaÃ±ol](/es.html)

ON THIS PAGE

* [Summary](#summary)
* [CVE Details](#cve)
* [Affected Products and Mitigation](#affected-products)
* [Acknowledgment](#acknowledgement)
* [Revisions](#revisions)

[Back to Security Bulletins and Briefs](/en/resources/product-security.html)
# SMM Lock Bypass

**AMD ID:â¯â¯**AMD-SB-7014

**Potential Impact:**Â Arbitrary Code Execution

**Severity:**Â High

## Summary

Researchers from IOActive have reported that it may be possible for an attacker with ring 0 access to modify the configuration of System Management Mode (SMM) even when SMM Lock is enabled.

## CVE Details

[Refer to Glossary for explanation of terms](/content/dam/amd/en/documents/resources/glossary-of-terms.pdf)

| **CVE** | **CVSS** | **CVE Description** |
| --- | --- | --- |
| CVE-2023-31315 | 7.5 (High) AV:L/AC:H/PR:H/UI:N/S:C/C:H/I:H/A:H | Improper validation in a model specific register (MSR) could allow a malicious program with ring0 access to modify SMM configuration while SMI lock is enabled, potentially leading to arbitrary code execution. |

## Affected Products and Mitigation

The Platform Initialization (PI) versions listed below have been or will be released to the Original Equipment Manufacturers (OEM) to mitigate these issues.Â  Please refer to your OEM for the BIOS update specific to your product.

###### **Data Center**

###### 1st Gen AMD EPYCâ¢Â Processors formerly codenamed "Naples"

AMD plans to release the Platform Initialization (PI)Â firmwareÂ versionÂ indicatedÂ below.Â

For some CVEs, there may be alternative mitigation options provided as noted in Mitigation Option 2, including microcode and/or other patches.

| **CVE** | | **Mitigation Option 1** | **Mitigation Option 2** | |
| --- | --- | --- | --- | --- |
| CVE-2023-31315 | 7.5 (High) | **Platform Initialization (PI)(Requires FW flash)** | **Î¼code (Hot loadable)** | |
| **Code Name** | **CPUID** | Naples PI 1.0.0.M (2024-06-06) | **Version** | |
| Naples | 0x00800F12 | 0x0800126F | 2024-05-03 |

###### **Â**

###### 2nd Gen AMD EPYCâ¢ ProcessorsÂ formerly codenamed "Rome"

AMD plans to release the Platform Initialization (PI)Â firmwareÂ versionÂ indicatedÂ below.Â

For some CVEs, there may be alternative mitigation options provided as noted in Mitigation Option 2, including microcode and/or other patches.

| **CVE** | | **Mitigation Option 1** | **Mitigation Option 2** | |
| --- | --- | --- | --- | --- |
| CVE-2023-31315 | 7.5 (High) | **Platform Initialization (PI) (Requires FW flash)** | **Î¼code (Hot loadable)** | |
| **Code Name** | **CPUID** | Rome PI 1.0.0.J (2024-06-20) | **Version** | |
| Rome | 0x00830F10 | 0x0830107C | 2024-05-03 |

###### **Â**

###### 3rd Gen AMD EPYCâ¢Â Processors formerly codenamed âMilan" and âMilan-Xâ

AMD plans to release the Platform Initialization (PI)Â firmwareÂ versionÂ indicatedÂ below.Â

For some CVEs, there may be alternative mitigation options provided as noted in Mitigation Option 2, including microcode and/or other patches.

| **CVE** | | **Mitigation Option 1** | **Mitigation Option 2** | |
| --- | --- | --- | --- | --- |
| CVE-2023-31315 | 7.5 (High) | **Platform****Initialization (PI)**  **(Requires FW flash)** | **Î¼code****(Hot loadable)** | |
| **Code Name** | **CPUID** | Milan PI 1.0.0.D (2024-07-11) | **Version** | |
| Milan | 0x00A00F11 | 0x0A0011D5 | 2024-05-03 |
| Milan-X | 0x00A00F12 | 0x0A001238 |

###### 4th Gen AMD EPYCâ¢ Processors formerly codenamed "Genoa", âGenoa-Xâ, âBergamoâ, and âSienaâ

AMD recommends updating to the Platform Initialization (PI)Â firmwareÂ versionÂ indicatedÂ below.Â

For some CVEs, there may be alternative mitigation options provided as noted in Mitigation Option 2, including microcode and/or other patches.

| **CVE** | | **Mitigation Option 1** | **Mitigation Option 2** | |
| --- | --- | --- | --- | --- |
| CVE-2023-31315 | 7.5 (High) | **Platform Initialization (PI)**  **(Requires FW flash)** | **Î¼code**  **(Hot loadable)** | |
| **Code Name** | **CPUID** | Genoa PI 1.0.0.C  (2024-04-04) | **Version** | |
| Genoa | 0x00A10F11 | 0x0A101148 | 2024-05-03 |
| Genoa-X | 0x00A10F12 | 0x0A101248 |
| Bergamo/Siena | 0x00AA0F02 | 0x0AA00215 |

**DATA CENTER GRAPHICS**

| **CVE** | **AMD Instinctâ¢ MI300A** |
| --- | --- |
| CVE-2023-31315 | MI300 SR5 PI  1.0.0.2  (2024-05-15) |

**EMBEDDED PROCESSORS**

| **Â**  **CVE** | **AMD EPYCâ¢ Embedded 3000** | **AMD EPYCâ¢Embedded 7002** | **AMD EPYCâ¢ Embedded 7003** | **AMD EPYCâ¢Embedded 9003** |
| --- | --- | --- | --- | --- |
| CVE-2023-31315 | SnowyOwl PI  1.1.0.D  (2024-10-30) | EmbRomePI-SP3  1.0.0.C  ((2024-10-30) | EmbMilanPI-SP3  1.0.0.9  ((2024-10-30) | EmbGenoaPI  1.0.0.7  (2024-07-15) |

| **CVE** | **AMD Ryzenâ¢Embedded R1000** | **AMD Ryzenâ¢ Embedded R2000** | **AMD Ryzenâ¢Embedded 5000** | **AMD Ryzenâ¢Embedded 7000** |
| --- | --- | --- | --- | --- |
| CVE-2023-31315 | EmbeddedPI-FP5  1.2.0.D  ((2024-09-18) | EmbeddedR2KPI-FP5  1.0.0.4  (2024-09-10) | EmbAM4PI  1.0.0.6  (2024-10- 09) | EmbeddedAM5PI  1.0.0.2  (2024-10-30) |

| **CVE** | **AMD Ryzenâ¢Embedded V1000** | | **AMD Ryzenâ¢Embedded V2000** | **AMD Ryzenâ¢Embedded V3000** |
| --- | --- | --- | --- | --- |
| All V1000 OPNs excluding YE1500C4T4MFH | YE1500C4T4MFH |
| CVE-2023-31315 | EmbeddedPI-FP5  1.2.0.D  (2024-09-18) | | EmbeddedPI-FP6  1.0.0.A  (2024-09-17) | EmbeddedPI-FP7r2  1.0.0.B  (2024-10-30) |

###### CLIENT

**DESKTOP**

| **CVE** | **AMD Ryzenâ¢ 3000 Series Desktop Processors**  **(Formerly codenamed)**  **âMatisseâ** | **AMD Ryzenâ¢ 5000 Series Desktop Processors**  **(Formerly codenamed)**  **âVermeerâ** | **AMD Athlonâ¢ 3000 Series Desktop Processors with Radeonâ¢ Graphics**  **(Formerly codenamed)**  **âPicassoâ AM4** | **AMD Ryzenâ¢ 5000 Series Desktop processor with Radeonâ¢ Graphics**  **(Formerly codenamed)**  **âCezanneâ** | **AMD Ryzenâ¢ 7000 Series Desktop Processors**  **(Formerly codenamed)**  **âRaphaelâ X3D** |
| --- | --- | --- | --- | --- | --- |
| CVE-2023-31315 | ComboAM4v2PI  1.2.0Cc  (2024-08-16)  Â  ComboAM4PI  1.0.0ba  (2024-08-16) | ComboAM4v2PI  1.2.0.cb  (2024-07-30) | ComboAM4PI  1.0.0.C  (2024-10-17) | ComboAM4v2PI  1.2.0.cb  (2024-07-30) | ComboAM5PI  1.2.0.1  (2024-08-07) |

| **CVE** | **AMD Ryzenâ¢ 2000 Series Desktop Processors**  **(Formerly codenamed)**  **âRaven Ridgeâ AM4** | **AMD Ryzenâ¢ 2000 Series Desktop Processors**  **(Formerly codenamed)**  **âPinnacle Ridgeâ** |
| --- | --- | --- |
| CVE-2023-31315 | ComboAM4PI  1.0.0.C  (2024-10-17) | ComboAM4PI  1.0.0.C  (2024-10-17) |

| **CVE** | **AMD Ryzenâ¢ 4000 Series Desktop Processors with Radeonâ¢ Graphics**  **(Formerly codenamed)**  **âRenoirâ AM4** | **AMD Ryzenâ¢ 8000 Series Processors with Radeonâ¢ Graphics**  **(Formerly codenamed)**  **âPhoenixâ AM5** |
| --- | --- | --- |
| CVE-2023-31315 | ComboAM4v2PI  1.2.0.cb  (2024-07-30) | ComboAM5PI  1.2.0.1  (2024-08-07) |

**HIGH END DESKTOP (HEDT)**

| **CVE** | **AMD Ryzenâ¢ Threadripperâ¢ 3000 Series Processors**  **(Formerly codenamed)**  **âCastle Peakâ HEDT** | **AMD Ryzenâ¢ Threadripperâ¢ 7000 Series Processors**  **(Formerly codenamed)**  **âStorm Peakâ** |
| --- | --- | --- |
| CVE-2023-31315 | CastlePeakPI-SP3r3  1.0.0.B  (2024-07-25) | StormPeakPI-SP6  1.1.0.0f  (2024-05-23)  StormPeakPI-SP6  1.0.0.1h  (2024-05-30) |

**WORKSTATION**

| **CVE** | **AMD Ryzenâ¢ Threadripperâ¢ PRO Processors**  **(Formerly codenamed)**  **âCastle Peakâ WS SP3** | **AMD Ryzenâ¢ Threadripperâ¢ PRO 3000WX Series Processors**  **(Formerly codenamed)**  **âChagallâ WS** |
| --- | --- | --- |
| CVE-2023-31315 | ChagallWSPI-sWRX8  1.0.0.8  (2024-07-22)  CastlePeakWSPI-sWRX8  1.0.0.D  (2024-07-26) | ChagallWSPI-sWRX8  1.0.0.8  (2024-07-22) |

**MOBILE - AMD Athlonâ¢ Series Processors**

| **CVE** | **AMD Athlonâ¢ 3000 Series Mobile Processors with Radeonâ¢ Graphics**  **(Formerly codenamed)**  **âDaliâ/âDaliâ ULP** | **AMD Athlonâ¢ 3000 Series Mobile Processors with Radeonâ¢ Graphics**  **(Formerly codenamed)**  **âPollockâ** |
| --- | --- | --- |
| CVE-2023-31315 | Picasso-FP5  1.0.1.2  (2024-08-06) | PollockPI-FT5  1.0.0.8  (2024-08-06) |

**MOBILE - AMD Ryzenâ¢ Series Processors**

| **CVE** | **AMD Ryzenâ¢ 3000 Series Mobile Processor with Radeonâ¢ Graphics**  **(Formerly codenamed)**  **âPicassoâ FP5** | **AMD Ryzenâ¢ 4000 Series Mobile Processors with Radeonâ¢ Graphics**  **(Formerly codenamed)**  **âRenoirâ FP6** | **AMD Ryzenâ¢ 5000 Series Mobile Processors with Radeonâ¢ Graphics**  **(Formerly codenamed)**  **âLucienneâ** | **AMD Ryzenâ¢ 5000 Series Mobile Processors with Radeonâ¢ Graphics**  **(Formerly codenamed)**  **âCezanneâ** | **AMD Ryzenâ¢ 7020 Series Processors with Radeonâ¢ Graphics**  **(Formerly codenamed)**  **âMendocinoâ FT6** |
| --- | --- | --- | --- | --- | --- |
| CVE-2023-31315 | Picasso-FP5  1.0.1.2  (2024-08-06) | RenoirPI-FP6  1.0.0.E  (2024-08-07) | CezannePI-FP6  1.0.1.1  (2024-07-31) | CezannePI-FP6  1.0.1.1  (2024-07-31) | MendocinoPI-FT6  1.0.0.7  (2024-08-01) |

| **CVE** | **AMD Ryzenâ¢ 6000 Series Processors with Radeonâ¢ Graphics**  **(Formerly codenamed)**  **"Rembrandt"** | **AMD Ryzenâ¢ 7035 Series Processors with Radeonâ¢ Graphics**  **(Formerly codenamed)**  **âRembrandt-Râ** | **AMD Ryzenâ¢ 5000 Series Processors with Radeonâ¢ Graphics**  **(Formerly codenamed)**  **âBarceloâ** | **AMD Ryzenâ¢ 7030 Series Mobile Processors with Radeonâ¢ Graphics**  **(Formerly codenamed)**  **âBarcelo-Râ** | **AMD Ryzenâ¢ 7040 Series Mobile Processors with Radeonâ¢ Graphics**  **(Formerly codenamed)**  **âPhoenixâ**  **FP7/FP7r2/FP8** | **AMD Ryzenâ¢ Series Mobile Processors with Radeonâ¢ Graphics**  **(Formerly codenamed)**  **âHawk Pointâ**  **FP7/FP7r2/FP8** | **AMD Ryzenâ¢ 7045 Series Mobile Processors**  **(Formerly codenamed)**  **âDragon Rangeâ** |
| --- | --- | --- | --- | --- | --- | --- | --- |
| CVE-2023-31315 | RembrandtPI-FP7  1.0.0.B  (2024-07-03) | RembrandtPI-FP7  1.0.0.B  (2024-07-03) | CezannePI-FP6  1.0.1.1  (2024-07-31) | CezannePI-FP6  1.0.1.1  (2024-07-31) | PhoenixPI-FP8-FP7  1.1.0.3  (2024-07-18) | PhoenixPI-FP8-FP7  1.1.0.3  (2024-07-18) | DragonRangeFL1  1.0.0.3e.  (2024-07-31) |

## Acknowledgement

AMD thanks Enrique Nissim and Krzysztof Okupski of IOActive for reporting this issue and engaging in coordinated vulnerability disclosure.

## Revisionsâ¯

| Revision Date | Description |
| --- | --- |
| 2024-11-07 | Updated mitigation for Embedded processors. |
| 2024-10-30 | Added AM4PI mitigation for âPicassoâ, âRaven Ridgeâ, âPinnacle Ridgeâ |
| 2024-08-20 | Added additional PI mitigation for âMatisseâ |
| 2024-08-19 | Update: Mitigation for âMatisseâ is now available |
| 2024-08-14 | âMatisseâ mitigation status has been updated to a target of 2024-08-20 |
| 2024-08-09 | Initial publication |

DISCLAIMER

The information contained herein is for informational purposes only and is subject to change without notice. While every precaution has been taken in the preparation of this document, it may contain technical inaccuracies, omissions and typographical errors, and AMD is under no obligation to update or otherwise correct this information. Advanced Micro Devices, Inc. makes no representations or warranties with respect to the accuracy or completeness of the contents of this document, and assumes no liability of any kind, including the implied warranties of noninfringement, merchantability or fitness for particular purposes, with respect to the operation or use of AMD hardware, software or other products described herein. Any computer system has risks of security vulnerabilities that cannot be completely prevented or mitigated. No license, including implied or arising by estoppel, to any intellectual property rights is granted by this document. Terms and limitations applicable to the purchase or use of AMDâs products are as set forth in a signed agreement between the parties or in AMD's Standard Terms and Conditions of Sale.

AMD, the AMD Arrow logo, EPYC, Instinct, Radeon, Ryzen, Threadripper and combinations thereof are trademarks of Advanced Micro Devices, Inc. CVE and the CVE logo are registered trademarks of The MITRE Corporation. Other product names used in this publication are for identification purposes only and may be trademarks of their respective companies.

Third party content may be licensed to you directly by the third party that owns the content and is not licensed to you by AMD. ALL LINKED THIRD-PARTY CONTENT IS PROVIDED âAS ISâ WITHOUT A WARRANTY OF ANY KIND. USE OF SUCH THIRD-PARTY CONTENT IS DONE AT YOUR SOLE DISCRETION AND UNDER NO CIRCUMSTANCES WILL AMD BE LIABLE TO YOU FOR ANY THIRD-PARTY CONTENT. YOU ASSUME ALL RISK AND ARE SOLELY RESPONSIBILITY FOR ANY DAMAGES THAT MAY ARISE FROM YOUR USE OF THIRD-PARTY CONTENT.

Â© 2024 Advanced Micro Devices, Inc. All rights reserved.

[Subscribe to the latest news from AMD](/en/preferences/sign-up.html)

* [Facebook](http://www.facebook.com/amd)
* [Instagram](https://www.instagram.com/amd)
* [Linkedin](https://www.linkedin.com/company/amd)
* [Twitch](https://www.twitch.tv/amd)
* [Twitter](https://twitter.com/amd)
* [Youtube](https://www.youtube.com/user/amd?sub_confirmation=1)
* [Subscriptions](https://www.amd.com/en/preferences.html)

###### [Company](#!)

* [About AMD](/en/corporate.html)
* [Management Team](/en/corporate/leadership.html)
* [Corporate Responsibility](/en/corporate/corporate-responsibility.html)
* [Careers](https://careers.amd.com/careers-home)
* [Contact Us](/en/corporate/contacts.html)

###### [News & Events](#!)

* [Newsroom](/en/newsroom.html)
* [Events](https://www.amd.com/en/corporate/events.html)
* [Media Library](/en/newsroom/media-library.html)

###### [Community](#!)

* [Developer Central](https://www.amd.com/en/developer.html)
* [Blogs](https://community.amd.com/t5/blogs/ct-p/amd-blogs)
* [Forums](https://community.amd.com/)
* [AI Forum](https://community.amd.com/t5/ai-discussions/bd-p/amd-ai-discussions)
* [Red Team](https://community.amd.com/t5/red-team/ct-p/red-team)

###### [Partners](#!)

* [AMD Partner Hub](https://www.amd.com/en/partner.html)
* [Authorized Distributors](/en/partner/about-partners/authorized-distributors.html)
* [AMD University Program](https://www.amd.com/en/corporate/university-program.html)

###### [Investors](#!)

* [Investor Relations](https://ir.amd.com/)
* [Financial Information](https://ir.amd.com/financial-information)
* [Board of Directors](https://ir.amd.com/leadership-governance/board-of-directors)
* [Governance Documents](https://ir.amd.com/leadership-governance/governance-documents)
* [SEC Filings](https://ir.amd.com/sec-filings)

* [Terms and Conditions](/en/legal/copyright.html)
* [Privacy](/en/legal/privacy.html)
* [Trademarks](/en/legal/trademarks.html)
* [Supply Chain Transparency](https://www.amd.com/content/dam/amd/en/documents/corporate/cr/supply-chain-transparency.pdf)
* [Fair & Open Competition](/en/legal/competition.html)
* [UK Tax Strategy](https://www.amd.com/content/dam/amd/en/documents/corporate/amd-uk-tax-strategy.pdf)
* [Cookies Policy](/en/legal/cookies.html)
* [Cookie Settings](#cookiessettings)

Â© 2025 Advanced Micro Devices, Inc.



=== Content from media.defcon.org_28780f53_20250111_085018.html ===
AMD Sinkclose
Universal SMM Privilege Escalation

Enrique Nissim
Krzysztof Okupski @exminium

@kiqueNissim

Outline

• Technical background

– Privilege levels and SMM security

– Remapping attacks

• Exploitation

– Exploit development

– Demo
• Attack paths
• Conclusions

©2024  IOActive, Inc. All Rights Reserved.

2

©2023  IOActive , Inc. All Righ ts Reserved.

3

SMM Introduction

©2024  IOActive, Inc. All Rights Reserved.

4

Introducing System Management Mode

• One of the most powerful execution modes in x86
o Full access to system and I/O device memory

o Access to the SPI flash (potential for persistence)

• Invisible to the rest of the system

o Hidden from the OS and Hypervisor

o EDRs cannot help here

©2024  IOActive, Inc. All Rights Reserved.

5

Privilege levels

Apps

OS

Hypervisor / VMM

SMM

©2024  IOActive, Inc. All Rights Reserved.

6

Ring 3

Apps

Ring 0

Firmware

OS Loader

OS

Ring -2

SMM

Boot-time

Run-time

©2024  IOActive, Inc. All Rights Reserved.

7

System Management Interrupts

• SMM is entered using a special
external interrupt called the
system-management interrupt
(SMI)

• After an SMI is received by the
processor, the processor saves
the processor state in a separate
address space, called System
Management RAM (SMRAM)

SW
SMI

SMM

OS

DRAM

©2024  IOActive, Inc. All Rights Reserved.

8

Previous research

• Blogs

– Exploring the security configuration of AMD platforms (2022)

– Adventures in the Platform Security Coordinated Disclosure Circus (2023)

– Back to the Future with Platform Security (2023)

– Exploring AMD Platform Secure Boot  (2023)

• Couple of CVEs

CVE-2023-20576

CVE-2023-20577

CVE-2023-20579

CVE-2023-20587

CVE-2023-20596

CVE-2023-31100

CVE-2023-28468

CVE-2023-2290

CVE-2023-5078

• Tooling: https://github.com/IOActive/Platbox

©2024  IOActive, Inc. All Rights Reserved.

9

SMM Security

©2024  IOActive, Inc. All Rights Reserved.

10

CPU
SMM

©2024  IOActive, Inc. All Rights Reserved.

Memory
Controller

SMRAM

DRAM

11

Memory
Controller

SMRAM

CPU
Normal mode

©2024  IOActive, Inc. All Rights Reserved.

- Execution disallowed
- Reads FFs
- Writes are discarded

DRAM

12

TSEG Region

• How does the memory controller protects SMRAM?

o At boot-time BIOS configures two registers to setup the TSEG Region

MSRC001_0112 SMM TSeg Base Address (SMMAddr)

Rsvd

TSEG Base

Reserved

63

39

17

  0

MSRC001_0113 SMM TSeg Mask (SMMMask)

Rsvd

TSEG Mask

Rsvd

Tm
Type
Dra m

Rsvd

Am
Type
Dra m

Rsvd

Tm
Type
IoWc

Am
Type
IoWc

TClose

AClose

TValid

AValid

63

 39

 17

4

3

2

 1

     0

©2024  IOActive, Inc. All Rights Reserved.

13

TSeg Base (SMMAddr)

TSeg Mask (SMMMask)

TSEG
Region

SMI Handlers

SMM Save State (CPUn)

...

SMM Save State (CPU0)

SMM Base + FE00h

SMM Entrypoint (CPUn)

...

SMM Entrypoint (CPU0)

SMM Base + 8000h

SMM Base (CPUn)

...

SMM Base (CPU0)

SMM Base (SMM_BASE)

Physical
Address Space

SMM Core

SMRAM

©2024  IOActive, Inc. All Rights Reserved.

14

Summary of SMRAM Registers

• MSRC001_0111 (SMM_BASE used for SMM base address)
• MSRC001_0112 (SMM TSeg Base Address (SMMAddr))
• MSRC001_0113 (SMM TSeg Mask (SMMMask))
• MSRC001_0015[SmmLock] (HWCR used for locking the config)

These need to be configured for each core

©2024  IOActive, Inc. All Rights Reserved.

15

Differences between AMD and Intel MSRs

• On Intel systems there are specific MSRs that are only accessible

while the processor is executing at SMM

o Example: IA32_SMBASE (SMM base register)

o Obtaining this value could be considered a leak

• On AMD all the MSRs that are related to the security of SMM are

accessible from ring 0

o Note that when SmmLock bit is set, accesibility does not imply the

configuration can be changed even from SMM

©2024  IOActive, Inc. All Rights Reserved.

16

Spotting the bug

©2024  IOActive, Inc. All Rights Reserved.

17

©2024  IOActive, Inc. All Rights Reserved.

18

©2024  IOActive, Inc. All Rights Reserved.

19

©2024  IOActive, Inc. All Rights Reserved.

20

MSR C001_0113 SMM TSeg Mask
(SMMMask)

©2024  IOActive, Inc. All Rights Reserved.

21

X86 goes to Harvard

FFFF_FFFFh

FF00_0000h

FEE0_0000h

FEC1_0000h

E000_0000h

Core 0
Normal mode

Data fetch

B000_0000h

Instruction fetch

AE00_0000h

4GB

SPI Flash

APIC

SPI Controller

PCIe ECAM

MMIO

TSEG

Memory

Device X

Device Y

Device Z

MMIO Space

SMRAM

0000_0000h

Physical Address
Space

DRAM

©2024  IOActive, Inc. All Rights Reserved.

22

X86 goes to Harvard

4GB

SPI Flash

APIC

SPI Controller

PCIe ECAM

MMIO

TSEG

Memory

FFFF_FFFFh

FF00_0000h

FEE0_0000h

FEC1_0000h

E000_0000h

B000_0000h

AE00_0000h

0000_0000h

Core 0
SMM

TClose OFF

Device X

Device Y

Device Z

MMIO Space

SMRAM

©2024  IOActive, Inc. All Rights Reserved.

23

Physical Address
Space

DRAM

X86 goes to Harvard

Core 0
SMM

FFFF_FFFFh

FF00_0000h

FEE0_0000h

FEC1_0000h

E000_0000h

B000_0000h

Instruction fetch

AE00_0000h

TClose OFF

0000_0000h

4GB

SPI Flash

APIC

SPI Controller

PCIe ECAM

MMIO

TSEG

Memory

Device X

Device Y

Device Z

MMIO Space

SMRAM

©2024  IOActive, Inc. All Rights Reserved.

24

Physical Address
Space

DRAM

X86 goes to Harvard

FFFF_FFFFh

FF00_0000h

FEE0_0000h

FEC1_0000h

E000_0000h

Core 0
SMM

Data fetch

B000_0000h

Instruction fetch

AE00_0000h

TClose OFF

4GB

SPI Flash

APIC

SPI Controller

PCIe ECAM

MMIO

TSEG

Memory

Device X

Device Y

Device Z

MMIO Space

SMRAM

0000_0000h

Physical Address
Space

DRAM

©2024  IOActive, Inc. All Rights Reserved.

25

X86 goes to Harvard

4GB

SPI Flash

APIC

SPI Controller

PCIe ECAM

MMIO

TSEG

Memory

FFFF_FFFFh

FF00_0000h

FEE0_0000h

FEC1_0000h

E000_0000h

B000_0000h

AE00_0000h

0000_0000h

Core 0
SMM

TClose ON

Device X

Device Y

Device Z

MMIO Space

SMRAM

©2024  IOActive, Inc. All Rights Reserved.

26

Physical Address
Space

DRAM

X86 goes to Harvard

Core 0
SMM

FFFF_FFFFh

FF00_0000h

FEE0_0000h

FEC1_0000h

E000_0000h

B000_0000h

Instruction fetch

AE00_0000h

TClose ON

4GB

SPI Flash

APIC

SPI Controller

PCIe ECAM

MMIO

TSEG

Memory

Device X

Device Y

Device Z

MMIO Space

SMRAM

0000_0000h

Physical Address
Space

DRAM

©2024  IOActive, Inc. All Rights Reserved.

27

X86 goes to Harvard

FFFF_FFFFh

FF00_0000h

FEE0_0000h

FEC1_0000h

E000_0000h

Core 0
SMM

Data fetch

B000_0000h

Instruction fetch

AE00_0000h

TClose ON

4GB

SPI Flash

APIC

SPI Controller

PCIe ECAM

MMIO

TSEG

Memory

Device X

Device Y

Device Z

MMIO Space

SMRAM

0000_0000h

Physical Address
Space

DRAM

©2024  IOActive, Inc. All Rights Reserved.

28

X86 goes to Harvard

FFFF_FFFFh

FF00_0000h

FEE0_0000h

FEC1_0000h

E000_0000h

Core 0
SMM

Data fetch

B000_0000h

Instruction fetch

AE00_0000h

TClose ON

4GB

SPI Flash

APIC

SPI Controller

PCIe ECAM

MMIO

TSEG

Memory

Attacker
Controlled

MMIO Space

SMRAM

Device X

Device Y

Device Z

0000_0000h

Physical Address
Space

DRAM

©2024  IOActive, Inc. All Rights Reserved.

29

Triggering the condition

©2024  IOActive, Inc. All Rights Reserved.

30

Why does this feature exist?

• This allows to re-use the physical address space
• We have yet to see a vendor using this feature

©2024  IOActive, Inc. All Rights Reserved.

31

When did this feature appear?

• First mentioned for AMD 0Fh processor families (2006)

• BIOS and Kernel Developer's Guide for AMD NPT

Family 0Fh Processors
https://www.amd.com/content/dam/amd/en/documents/a
rchived-tech-docs/programmer-references/32559.pdf

• It's been around for 18 years...

©2024  IOActive, Inc. All Rights Reserved.

32

Differences with the "Memory Sinkhole"

• Cristopher Domas presented the Memory Sinkhole attack in 2015

o Affected Intel Sandy Bridge and previous generations
o Remaps the APIC over the TSEG area
o Causes data fetches to go to MMIO instead of SMRAM

• Key differences:

o The memory sinkhole only affects the 4K portion where the APIC gets

mapped

o Sinkclose changes the behavior of the entire TSEG region

o Any device could be overlapped... right?

©2024  IOActive, Inc. All Rights Reserved.

33

Brainstorming attack ideas

©2024  IOActive, Inc. All Rights Reserved.

34

Attack idea

• Use a PCIe device with a BAR having register values such that

when overlapped with the SMM entry point, we could take control of
the execution

• There are multiple integrated devices in modern systems

• We can try re-mapping the PCI Base Address Register (BAR) from

one of them to make it overlap with SMRAM

• The registers for the device should become visible for the OS at the

TSEG location

©2024  IOActive, Inc. All Rights Reserved.

35

PCI BARs failed

©2024  IOActive, Inc. All Rights Reserved.

36

PCI BARs failed

Visible device registers

©2024  IOActive, Inc. All Rights Reserved.

37

PCI BARs failed

Visible device registers

Remap failed; registers are not
available

©2024  IOActive, Inc. All Rights Reserved.

38

PCI BARs failed

Visible device registers

Remap failed; registers are not
available

The BAR was indeed
moved from its original place

©2024  IOActive, Inc. All Rights Reserved.

39

PCI BARs failed

Visible device registers

Remap failed; registers are not
available

The BAR was indeed
moved from its original place

After restoration

©2024  IOActive, Inc. All Rights Reserved.

40

TOM - Top of Memory

• This register dictates where the MMIO region below 4G starts
• On Intel this register has a lock bit and cannot be modified when set
• There is no such lock in AMD :)

©2024  IOActive, Inc. All Rights Reserved.

41

Moving TOM down

4GB

TOM

TSEG_BASE

MMIO

TSEG

FFFFFFFFh

B0000000h

AE000000h

©2024  IOActive, Inc. All Rights Reserved.

42

Moving TOM down

4GB

TOM

TSEG_BASE

MMIO

TSEG

FFFFFFFFh

B0000000h

AE000000h

4GB

FFFFFFFFh

MMIO

TSEG

TSEG_BASE
TOM

AE000000h

©2024  IOActive, Inc. All Rights Reserved.

43

Moving TOM down

4GB

TOM

TSEG_BASE

MMIO

TSEG

FFFFFFFFh

B0000000h

AE000000h

4GB

FFFFFFFFh

MMIO

TSEG

TSEG_BASE
TOM

AE000000h

This worked in theory but not in practice...

©2024  IOActive, Inc. All Rights Reserved.

44

Memory routing priorities

©2024  IOActive, Inc. All Rights Reserved.

45

Memory routing priorities

©2024  IOActive, Inc. All Rights Reserved.

46

Memory routing priorities

©2024  IOActive, Inc. All Rights Reserved.

47

Memory routing priorities

©2024  IOActive, Inc. All Rights Reserved.

48

Memory routing priorities

©2024  IOActive, Inc. All Rights Reserved.

?

49

Analysis of the SMM entry point

SMM
Mode

Real mode
(16 bit)

Protected mode
(32 bit)

Long mode
(64 bit)

SMI handlers

©2023  IOActive, Inc. All Rights Reserved.

50

Global Descriptor Table (GDT)

jmp 0x8:0x1000

Descriptor N

Data Descriptor
Base: 0x00000000

Code Descriptor
Base: 0x00000000

Descriptor 0
(NULL)

GDT

Limit

Base

GDTR

©2024  IOActive, Inc. All Rights Reserved.

51

Global Descriptor Table (GDT)

jmp 0x8:0x1000

Descriptor N

Data Descriptor
Base: 0x00000000

Code Descriptor
Base: 0x00000000

Descriptor 0
(NULL)

GDT

Limit

Base

GDTR

©2024  IOActive, Inc. All Rights Reserved.

52

Global Descriptor Table (GDT)

jmp 0x8:0x1000

Descriptor N

Data Descriptor
Base: 0x00000000

Code Descriptor
Base: 0x00000000

Descriptor 0
(NULL)

GDT

Linear address
0x1000

Limit

Base

GDTR

©2024  IOActive, Inc. All Rights Reserved.

53

Analysis of the EDKII SMM entry point

©2024  IOActive, Inc. All Rights Reserved.

54

Analysis of the EDKII SMM entry point

SMM entry point + 0x4D

©2024  IOActive, Inc. All Rights Reserved.

55

Analysis of the EDKII SMM entry point

SMM entry point + 0x4D

©2024  IOActive, Inc. All Rights Reserved.

56

Analysis of the EDKII SMM entry point

SMM entry point + 0x4D

Loads GDTR

©2024  IOActive, Inc. All Rights Reserved.

57

Analysis of the EDKII SMM entry point

SMM entry point + 0x4D

Loads GDTR

Jumps to 32-bit (protected) code

©2024  IOActive, Inc. All Rights Reserved.

58

Analysis of the EDKII SMM entry point

SMM entry point + 0x4D

Loads GDTR

Jumps to 32-bit (protected) code

We need to control the BAR of the overlapped device at offset 0x4D

©2024  IOActive, Inc. All Rights Reserved.

59

Problems with the APIC

• The system becomes unstable when the APIC is moved

• The APIC registers are not useful for taking control at

the SMM entry point

©2024  IOActive, Inc. All Rights Reserved.

60

APIC Registers

Reserved region

Writes are discarded

©2024  IOActive, Inc. All Rights Reserved.

61

Introducing the SPI controller

©2024  IOActive, Inc. All Rights Reserved.

62

SPI controller

• Used to read / write / erase the SPI flash

• Key features:

o The BAR can be relocated over the SMM entry point
o Portions of the BAR are attacker-controlled
o Takes precedence over SMRAM when TClose is enabled

©2024  IOActive, Inc. All Rights Reserved.

63

SMI Handlers

SMM Save State (CPUn)

...

SMM Save State (CPU0)

SMM Entrypoint (CPUn)

...

Data fetch

Instruction fetch

Core 0
SMM

SMM Entrypoint (CPU0)

SPI BAR

SMM Base (CPUn)

...

SMM Base (CPU0)

SMM Core

SMRAM

MMIO

©2024  IOActive, Inc. All Rights Reserved.

64

©2024  IOActive, Inc. All Rights Reserved.

65

SPI BAR

• GDTR is loaded from offset 0x4D

• Controllable fields:

o 0x4C-50: FCH::LPCPCICFG::memoryrange
o 0x50-54: FCH::LPCPCICFG::rom_protect_0

©2024  IOActive, Inc. All Rights Reserved.

66

Debugging setup

©2024  IOActive, Inc. All Rights Reserved.

67

Debugging Setup

• BAR buffer

o PCI Squirrel with PCILeech firmware
o Used for persistent memory across boot cycles

• SMM backdoor

o Used for modifying code in SMM on-demand

©2024  IOActive, Inc. All Rights Reserved.

68

PCIe Squirrel

Power supply

M2 to PCI 4x
adapter

©2024  IOActive, Inc. All Rights Reserved.

69

Exploitation

©2024  IOActive, Inc. All Rights Reserved.

70

Attempt #1

©2024  IOActive, Inc. All Rights Reserved.

71

TSEG

Data fetch

Instruction fetch

SMM Entrypoint

1. Remap

Core 0
SMM

©2024  IOActive, Inc. All Rights Reserved.

DRAM

SPI BAR

MMIO

72

TSEG

Data fetch

Instruction fetch

SMM Entrypoint

1. Remap

Core 0
SMM

SPI BAR

2. Tweak

©2024  IOActive, Inc. All Rights Reserved.

DRAM

MMIO

73

TSEG

Data fetch

Instruction fetch

SMM Entrypoint

1. Remap

Core 0
SMM

©2024  IOActive, Inc. All Rights Reserved.

Payload

Fake GDT

DRAM

SPI BAR

2. Tweak

3. Map +
tweak

MMIO

74

TSEG

Data fetch

Instruction fetch

SMM Entrypoint

1. Remap

Core 0
SMM

©2024  IOActive, Inc. All Rights Reserved.

Payload

Fake GDT

DRAM

SPI BAR

2. Tweak

3. Map +
tweak

MMIO

75

TSEG

Data fetch

Instruction fetch

SMM Entrypoint

1. Remap

Core 0
SMM

Size: 0x100
Address: 0x00000000

GDTR

©2024  IOActive, Inc. All Rights Reserved.

Payload

Fake GDT

DRAM

SPI BAR

2. Tweak

3. Map +
tweak

MMIO

76

TSEG

Data fetch

Instruction fetch

SMM Entrypoint

1. Remap

Core 0
SMM

Size: 0x100
Address: 0x00000000

GDTR

©2024  IOActive, Inc. All Rights Reserved.

Payload

Fake GDT

DRAM

SPI BAR

2. Tweak

3. Map +
tweak

MMIO

77

TSEG

Data fetch

Instruction fetch

SMM Entrypoint

1. Remap

Core 0
SMM

Size: 0x100
Address: 0x00000000

GDTR

©2024  IOActive, Inc. All Rights Reserved.

Payload

Fake GDT

DRAM

SPI BAR

2. Tweak

3. Map +
tweak

MMIO

78

GDT far jmp wrap-around

jmp 0x8:0xaef4b053

Descriptor N

Descriptor 2

Descriptor 1
Base: 0x00000000

Descriptor 0

GDT

Linear address
0xaef4b053

Limit

Base

GDTR

©2024  IOActive, Inc. All Rights Reserved.

79

GDT far jmp wrap-around

jmp 0x8:0xaef4b053

Descriptor N

Descriptor 2

Descriptor 1
Base: 0x510b4fad

Descriptor 0

GDT

Linear address
0x00000000

Limit

Base

GDTR

©2024  IOActive, Inc. All Rights Reserved.

80

It worked, but the system crashed… why?

©2024  IOActive, Inc. All Rights Reserved.

81

The SMM save state

• The SMM save state is automatically saved upon

entering SMM and restored when leaving it
o With TClose enabled these writes are dropped
o The SMM save state from the last SMI is still there

• Solution: Trigger SMI twice

o Once without TClose to prime SMM save state
o Once with TClose to trigger bug

• Does not require overwriting SMM save state values

©2024  IOActive, Inc. All Rights Reserved.

82

Attempt #2

©2024  IOActive, Inc. All Rights Reserved.

83

The system crashed again... why?

©2024  IOActive, Inc. All Rights Reserved.

84

Enabling TClose

©2024  IOActive, Inc. All Rights Reserved.

85

Bingo...

©2024  IOActive, Inc. All Rights Reserved.

86

Symmetric Multi-Threading

• Physical cores are split into two logical cores (threads)

• Some resources are shared between logical cores

o SMM base MSR is separate but
o TSEG mask MSR is not

• Is it an issue if only one core goes into SMM at a time?

©2024  IOActive, Inc. All Rights Reserved.

87

SMIs explained

Normal mode

Normal mode

Normal mode

Normal mode

xor eax, eax
xor eax, eax

xor eax, eax
xor eax, eax

xor eax, eax
xor eax, eax

xor eax, eax
xor eax, eax

©2024  IOActive, Inc. All Rights Reserved.

88

SMIs explained

Normal mode

Normal mode

Normal mode

Normal mode

xor eax, eax
xor eax, eax
smi

xor eax, eax
xor eax, eax

xor eax, eax
xor eax, eax

xor eax, eax
xor eax, eax

©2024  IOActive, Inc. All Rights Reserved.

89

SMIs explained

Normal mode

Normal mode

Normal mode

Normal mode

xor eax, eax
xor eax, eax
smi

xor eax, eax
xor eax, eax

xor eax, eax
xor eax, eax

xor eax, eax
xor eax, eax

©2024  IOActive, Inc. All Rights Reserved.

90

SMIs explained

SMM mode

SMM mode

SMM mode

SMM mode

xor eax, eax
xor eax, eax
smi

xor eax, eax
xor eax, eax

xor eax, eax
xor eax, eax

xor eax, eax
xor eax, eax

mov bs, 0x804d
mov ax, cs:0xfdd8
...

mov bs, 0x804d
mov ax, cs:0xfdd8
...

mov bs, 0x804d
mov ax, cs:0xfdd8
...

mov bs, 0x804d
mov ax, cs:0xfdd8
...

©2024  IOActive, Inc. All Rights Reserved.

91

SMIs explained

• We assumed that SMIs are local, but they are global

• Initially we thought that:

– we could control exactly which core enters into SMM first

– each core would later reach the rendezvous routine and

– send Inter-Processor-Interrupts (IPI) to bring the rest of the cores into

SMM before continuing

• We were wrong: The I/O Hub sends the SMI to all cores at once

©2024  IOActive, Inc. All Rights Reserved.

92

Problem summarized

• SMIs make all cores go to SMM at the same time

• TClose is enabled on two logical cores at a time
o They will read 0xFFs since no device is mapped there
o Writes to SMM save state will be dropped

• This will make core 1 triple-fault and crash the system

©2024  IOActive, Inc. All Rights Reserved.

93

Tackling the problem

• We had:

o Control of data fetches on core 0
o No control of data fetches on core 1

• We tried many things to solve the problem:

o Finding another device to overlap with the SMM entry point
o Disabling Simultaneous Multi-Threading (SMT)
o Sending an INIT IPI / executing SKINIT to ignore SMIs
o Sending an SMI IPI to trigger an SMI on individual cores

©2024  IOActive, Inc. All Rights Reserved.

94

Running out of options

• Taking a step back:
o Our lgdt is the issue
o What happens if the GDTR is loaded all with FFs?

• Let's look into that...

©2024  IOActive, Inc. All Rights Reserved.

95

GDTR wrap-around

jmp 0x8:0xaef4b053

0xAED030C0

Limit

Base
0xAED030B8

GDTR

Descriptor N

Descriptor 2

Descriptor 1
Base: 0x00000000

Descriptor 0

GDT

Linear address
0xaef4b053

©2024  IOActive, Inc. All Rights Reserved.

96

GDTR wrap-around

jmp 0x8:0xaef4b053

0x00000007

Limit
0xFFFF

Base
0xFFFFFFFF

GDTR

Descriptor N

Descriptor 2

Descriptor 1

Descriptor 0

GDT

Linear address

©2024  IOActive, Inc. All Rights Reserved.

97

Wrap-arounds in x86

• The are two instances of wrap-arounds:

– The addition between GDT descriptor base and far jmp offset

can overflow

– The addition between the GDTR base and far jmp segment

selector can overflow

• We can use the same fake GDT for core 0 and 1
• Added bonus: No need for the SPI BAR remapping

©2024  IOActive, Inc. All Rights Reserved.

98

SMM save state (again)

• For core 0 we use the same technique as before
• For core 1 we:

o Need to bring core 1 into a known / controlled state
o We use kernel synchronization APIs to achieve that

▪ Deferred Procedure Calls (DPC) on Windows

▪ Symmetric Multi-Processing (SMP) on Linux

©2024  IOActive, Inc. All Rights Reserved.

99

Attempt #3

©2024  IOActive, Inc. All Rights Reserved.

10
0

TSEG

SMM Entrypoint 1

SMM Entrypoint 0

0xFF

0xFF

Core 1
SMM

Core 0
SMM

©2024  IOActive, Inc. All Rights Reserved.

10
1

DRAM

Core 1
SMM

Core 0
SMM

TSEG

SMM Entrypoint 1

SMM Entrypoint 0

Payload 1

Payload 0

Fake GDT
(1st byte truncated)

DRAM

0xFF

0xFF

1. Map + tweak

©2024  IOActive, Inc. All Rights Reserved.

10
2

Core 1
SMM

Core 0
SMM

TSEG

SMM Entrypoint 1

SMM Entrypoint 0

Payload 1

Payload 0

Fake GDT
(1st byte truncated)

DRAM

0xFF

0xFF

1. Map + tweak

©2024  IOActive, Inc. All Rights Reserved.

10
3

GDTR

Size: 0xFFFF
Address: 0xFFFFFFFF

Core 1
SMM

Core 0
SMM

TSEG

SMM Entrypoint 1

SMM Entrypoint 0

Payload 1

Payload 0

Fake GDT
(1st byte truncated)

DRAM

0xFF

0xFF

1. Map + tweak

©2024  IOActive, Inc. All Rights Reserved.

10
4

GDTR

Size: 0xFFFF
Address: 0xFFFFFFFF

Core 1
SMM

Core 0
SMM

TSEG

SMM Entrypoint 1

SMM Entrypoint 0

Payload 1

Payload 0

Fake GDT
(1st byte truncated)

DRAM

0xFF

0xFF

1. Map + tweak

©2024  IOActive, Inc. All Rights Reserved.

10
5

GDTR

Size: 0xFFFF
Address: 0xFFFFFFFF

Core 1
SMM

Core 0
SMM

TSEG

SMM Entrypoint 1

SMM Entrypoint 0

Payload 1

Payload 0

Fake GDT
(1st byte truncated)

DRAM

0xFF

0xFF

1. Map + tweak

©2024  IOActive, Inc. All Rights Reserved.

10
6

And it worked!

©2024  IOActive, Inc. All Rights Reserved.

10
7

Extra steps

• We can execute code in SMM but in protected mode

• Our payload performs the following steps:
o Reload the GDT to avoid IP misalignments
o Setup long mode (including page tables)
o Install an SMI handlers to avoid re-exploiting the issue

©2024  IOActive, Inc. All Rights Reserved.

10
8

DEMO

©2024  IOActive, Inc. All Rights Reserved.

10
9

INSERT VIDEO

©2023  IOActive , Inc. All Righ ts Reserved.

11
0

Next attack paths

• Next steps depend on the platform configuration

• The firmware is responsable for:

o Restricting access to the SPI flash (e.g. via ROM Armor)

o Verifying the firmware chain-of-trust (via Platform Secure Boot)

• If everything is enabled, we can at least break secure boot
• If not, there is potential for firmware implants

©2024  IOActive, Inc. All Rights Reserved.

11
1

Ring 3

Apps

Ring 0

FW
(SEC+PEI)

FW
(DXE)

OS Loader

OS

Load and
verify FW

Read / write SPI

Ring -2

AMD
Security
Processor

FW
(SMM)

Read / write SPI

FW

CFG

HDD

©2024  IOActive, Inc. All Rights Reserved.

11
2

Ring 3

Apps

Ring 0

FW
(SEC+PEI)

FW
(DXE)

OS Loader

OS

Load
without
verification

Read / write SPI

Ring -2

AMD
Security
Processor

FW
(SMM)

Read / write SPI

FW

CFG

HDD

©2024  IOActive, Inc. All Rights Reserved.

11
3

Ring 3

Apps

Ring 0

FW
(SEC+PEI)

FW
(DXE)

OS Loader

OS

Load and
verify FW

Ring -2

AMD
Security
Processor

FW
(SMM)

Read / write SPI

FW

CFG

HDD

©2024  IOActive, Inc. All Rights Reserved.

11
4

Ring 3

Apps

Ring 0

FW
(SEC+PEI)

FW
(DXE)

OS Loader

OS

Load
without
verification

Ring -2

AMD
Security
Processor

FW
(SMM)

Read / write SPI

FW

CFG

HDD

©2024  IOActive, Inc. All Rights Reserved.

11
5

Platform security (as of 2023)

Vendor

Model

PSB State

ROM Armor State

Acer

Acer

ASUS

Lenovo

Lenovo

Lenovo

Huawei

HP

Microsoft

MSI

Swift 3 SF314-42

Not configured

Not configured

TravelMate P414-41

Not configured

Configured

Strix G513QR

Thinkpad P16s

IdeaPad 1

Thinkpad T495s

Matebook D16

15s

Surface 4

Bravo 15

Not configured

Configured*

Not configured

Not configured

Not configured

Not configured

Configured

Not configured

Not configured

Not configured

Not configured

Not configured

Not configured

Unknown

Not configured

Not configured

©2024  IOActive, Inc. All Rights Reserved.

11
6

Platform security continued

• In previous research we discovered that the PSB can be

permanently disabled by burning specific fuses:

PSB Status​

Not Enabled​

Enabled​

Disabled​

PSB_EN​

CUSTOMER_KEY_LOCK​

0​

1​

0​

0​

1​

1​

• Once a system is compromised, doing this leaves it

vulnerable to firmware implants forever

©2024  IOActive, Inc. All Rights Reserved.

11
7

Outro

©2024  IOActive, Inc. All Rights Reserved.

11
8

Affected systems

• Pretty much all of them

o Ryzen series
o Ryzen Threadripper series
o EPYC series

• Total number of affected chips: 100s of millions

• AMD advisory AMD-SB-7014 published at​

https://www.amd.com/en/resources/product-security/bulletin/amd-
sb-7014.html

©2024  IOActive, Inc. All Rights Reserved.

11
9

Mitigations

• AMD:

o A microcode update is available

o Con: Might not cover all affected systems due to product EOL

• OEMs:

o Modify SMM entry point code to detect if TClose bit is enabled and abort

execution

o Can be done at the reference code level

o Con: Specific to one OEM or even specific systems

• Users:

o A hypervisor could be used to trap accesses on the TSEG mask MSR

©2024  IOActive, Inc. All Rights Reserved.

12
0

Timeline

Vulnerability reported
to AMD PSIRT
(30th Oct 2023)

Mitigations will be
developed
(11th Dec 2023)

DEFCON
(Today)

Assigned
CVE-2023-31315
(30th Nov 2023)

AMD publishes
advisory SB-7014
(9th Aug 2024)

©2024  IOActive, Inc. All Rights Reserved.

12
1

AMD's response

AMD thanks IOActive for identifying the vulnerability and working with AMD to
protect end-users.

AMD has identified and deployed mitigations for this vulnerability.  A full list of
impacted products and mitigation options is available in our product security
bulletin AMD-SB-7014 which may be found here:

https://www.amd.com/productsecurity

AMD welcomes collaboration with the security community and encourages
researchers to submit their findings to AMD PSIRT using the product security
page above.

©2024  IOActive, Inc. All Rights Reserved.

12
2

Conclusions

• The vulnerability has been around for nearly two decades

• The complexity of modern architectures plays in favor of attackers

• The flexibility of segmentation played a crucial role for exploitation

• Exploitation requires in-depth understanding of the architecture

• This issue can be exploited without requiring physical presence

Exploit code will be released soon

Stay tuned!

©2024  IOActive, Inc. All Rights Reserved.

12
3

Questions?

©2024  IOActive, Inc. All Rights Reserved.

12
4


