<!DOCTYPE html>
<html lang='en'>
<head>
<title>KVM: SEV-ES: rename guest_ins_data to sev_pio_data - kernel/git/torvalds/linux.git - Linux kernel source tree</title>
<meta name='generator' content='cgit 1.2.3-korg'/>
<meta name='robots' content='noindex, nofollow'/>
<link rel='stylesheet' type='text/css' href='/cgit-data/cgit.css'/>
<script type='text/javascript' src='/cgit-data/cgit.js'></script>
<link rel='shortcut icon' href='/favicon.ico'/>
<link rel='alternate' title='Atom feed' href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/atom/?h=master' type='application/atom+xml'/>
<link rel='vcs-git' href='git://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git' title='kernel/git/torvalds/linux.git Git repository'/>
<link rel='vcs-git' href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git' title='kernel/git/torvalds/linux.git Git repository'/>
<link rel='vcs-git' href='https://kernel.googlesource.com/pub/scm/linux/kernel/git/torvalds/linux.git' title='kernel/git/torvalds/linux.git Git repository'/>
</head>
<body>
<div id='cgit'><table id='header'>
<tr>
<td class='logo' rowspan='2'><a href='/'><img src='/cgit-data/cgit.png' alt='cgit logo'/></a></td>
<td class='main'><a href='/'>index</a> : <a href='/pub/scm/linux/kernel/git/torvalds/linux.git/'>kernel/git/torvalds/linux.git</a></td><td class='form'><form method='get'>
<input type='hidden' name='id' value='b599840'/><select name='h' onchange='this.form.submit();'>
<option value='for-next'>for-next</option>
<option value='master' selected='selected'>master</option>
<option value='vsnprintf'>vsnprintf</option>
</select> <input type='submit' value='switch'/></form></td></tr>
<tr><td class='sub'>Linux kernel source tree</td><td class='sub right'>Linus Torvalds</td></tr></table>
<table class='tabs'><tr><td>
<a href='/pub/scm/linux/kernel/git/torvalds/linux.git/about/'>about</a><a href='/pub/scm/linux/kernel/git/torvalds/linux.git/'>summary</a><a href='/pub/scm/linux/kernel/git/torvalds/linux.git/refs/?id=b599840'>refs</a><a href='/pub/scm/linux/kernel/git/torvalds/linux.git/log/'>log</a><a href='/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=b599840'>tree</a><a class='active' href='/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=b599840'>commit</a><a href='/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=b599840'>diff</a><a href='/pub/scm/linux/kernel/git/torvalds/linux.git/stats/'>stats</a></td><td class='form'><form class='right' method='get' action='/pub/scm/linux/kernel/git/torvalds/linux.git/log/'>
<input type='hidden' name='id' value='b599840'/><select name='qt'>
<option value='grep'>log msg</option>
<option value='author'>author</option>
<option value='committer'>committer</option>
<option value='range'>range</option>
</select>
<input class='txt' type='search' size='10' name='q' value=''/>
<input type='submit' value='search'/>
</form>
</td></tr></table>
<div class='content'><div class='cgit-panel'><b>diff options</b><form method='get'><input type='hidden' name='id' value='b599840'/><table><tr><td colspan='2'/></tr><tr><td class='label'>context:</td><td class='ctrl'><select name='context' onchange='this.form.submit();'><option value='1'>1</option><option value='2'>2</option><option value='3' selected='selected'>3</option><option value='4'>4</option><option value='5'>5</option><option value='6'>6</option><option value='7'>7</option><option value='8'>8</option><option value='9'>9</option><option value='10'>10</option><option value='15'>15</option><option value='20'>20</option><option value='25'>25</option><option value='30'>30</option><option value='35'>35</option><option value='40'>40</option></select></td></tr><tr><td class='label'>space:</td><td class='ctrl'><select name='ignorews' onchange='this.form.submit();'><option value='0' selected='selected'>include</option><option value='1'>ignore</option></select></td></tr><tr><td class='label'>mode:</td><td class='ctrl'><select name='dt' onchange='this.form.submit();'><option value='0' selected='selected'>unified</option><option value='1'>ssdiff</option><option value='2'>stat only</option></select></td></tr><tr><td/><td class='ctrl'><noscript><input type='submit' value='reload'/></noscript></td></tr></table></form></div><table summary='commit info' class='commit-info'>
<tr><th>author</th><td>Paolo Bonzini &lt;pbonzini@redhat.com&gt;</td><td class='right'>2021-10-12 10:22:34 -0400</td></tr>
<tr><th>committer</th><td>Paolo Bonzini &lt;pbonzini@redhat.com&gt;</td><td class='right'>2021-10-22 10:01:26 -0400</td></tr>
<tr><th>commit</th><td colspan='2' class='oid'><a href='/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=b5998402e3de429b5e5f9bdea08ddf77c5fd661e'>b5998402e3de429b5e5f9bdea08ddf77c5fd661e</a> (<a href='/pub/scm/linux/kernel/git/torvalds/linux.git/patch/?id=b5998402e3de429b5e5f9bdea08ddf77c5fd661e'>patch</a>)</td></tr>
<tr><th>tree</th><td colspan='2' class='oid'><a href='/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=b599840'>935d7b8f7b1800fba1437f4106659f828199c4f5</a></td></tr>
<tr><th>parent</th><td colspan='2' class='oid'><a href='/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=c8c340a9b4149fe5caa433f3b62463a1c8e07a46'>c8c340a9b4149fe5caa433f3b62463a1c8e07a46</a> (<a href='/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=b599840&amp;id2=c8c340a9b4149fe5caa433f3b62463a1c8e07a46'>diff</a>)</td></tr><tr><th>download</th><td colspan='2' class='oid'><a href='/pub/scm/linux/kernel/git/torvalds/linux.git/snapshot/linux-b599840.tar.gz'>linux-b599840.tar.gz</a><br/></td></tr></table>
<div class='commit-subject'>KVM: SEV-ES: rename guest_ins_data to sev_pio_data</div><div class='commit-msg'>We will be using this field for OUTS emulation as well, in case the
data that is pushed via OUTS spans more than one page.  In that case,
there will be a need to save the data pointer across exits to userspace.

So, change the name to something that refers to any kind of PIO.
Also spell out what it is used for, namely SEV-ES.

No functional change intended.

Cc: stable@vger.kernel.org
Fixes: 7ed9abfe8e9f ("KVM: SVM: Support string IO operations for an SEV-ES guest")
Reviewed-by: Maxim Levitsky &lt;mlevitsk@redhat.com&gt;
Signed-off-by: Paolo Bonzini &lt;pbonzini@redhat.com&gt;
</div><div class='diffstat-header'><a href='/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=b599840'>Diffstat</a></div><table summary='diffstat' class='diffstat'><tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/pub/scm/linux/kernel/git/torvalds/linux.git/diff/arch/x86/include/asm/kvm_host.h?id=b599840'>arch/x86/include/asm/kvm_host.h</a></td><td class='right'>2</td><td class='graph'><table summary='file diffstat' width='4%'><tr><td class='add' style='width: 25.0%;'/><td class='rem' style='width: 25.0%;'/><td class='none' style='width: 50.0%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/pub/scm/linux/kernel/git/torvalds/linux.git/diff/arch/x86/kvm/x86.c?id=b599840'>arch/x86/kvm/x86.c</a></td><td class='right'>4</td><td class='graph'><table summary='file diffstat' width='4%'><tr><td class='add' style='width: 50.0%;'/><td class='rem' style='width: 50.0%;'/><td class='none' style='width: 0.0%;'/></tr></table></td></tr>
</table><div class='diffstat-summary'>2 files changed, 3 insertions, 3 deletions</div><table summary='diff' class='diff'><tr><td><div class='head'>diff --git a/arch/x86/include/asm/kvm_host.h b/arch/x86/include/asm/kvm_host.h<br/>index f8f48a7ec577f6..6bed6c416c6c35 100644<br/>--- a/<a href='/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/include/asm/kvm_host.h?id=c8c340a9b4149fe5caa433f3b62463a1c8e07a46'>arch/x86/include/asm/kvm_host.h</a><br/>+++ b/<a href='/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/include/asm/kvm_host.h?id=b5998402e3de429b5e5f9bdea08ddf77c5fd661e'>arch/x86/include/asm/kvm_host.h</a></div><div class='hunk'>@@ -702,7 +702,7 @@ struct kvm_vcpu_arch {</div><div class='ctx'> </div><div class='ctx'> 	struct kvm_pio_request pio;</div><div class='ctx'> 	void *pio_data;</div><div class='del'>-	void *guest_ins_data;</div><div class='add'>+	void *sev_pio_data;</div><div class='ctx'> </div><div class='ctx'> 	u8 event_exit_inst_len;</div><div class='ctx'> </div><div class='head'>diff --git a/arch/x86/kvm/x86.c b/arch/x86/kvm/x86.c<br/>index 381384a5479069..379175b725a13a 100644<br/>--- a/<a href='/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/kvm/x86.c?id=c8c340a9b4149fe5caa433f3b62463a1c8e07a46'>arch/x86/kvm/x86.c</a><br/>+++ b/<a href='/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/kvm/x86.c?id=b5998402e3de429b5e5f9bdea08ddf77c5fd661e'>arch/x86/kvm/x86.c</a></div><div class='hunk'>@@ -12370,7 +12370,7 @@ EXPORT_SYMBOL_GPL(kvm_sev_es_mmio_read);</div><div class='ctx'> </div><div class='ctx'> static int complete_sev_es_emulated_ins(struct kvm_vcpu *vcpu)</div><div class='ctx'> {</div><div class='del'>-	memcpy(vcpu-&gt;arch.guest_ins_data, vcpu-&gt;arch.pio_data,</div><div class='add'>+	memcpy(vcpu-&gt;arch.sev_pio_data, vcpu-&gt;arch.pio_data,</div><div class='ctx'> 	       vcpu-&gt;arch.pio.count * vcpu-&gt;arch.pio.size);</div><div class='ctx'> 	vcpu-&gt;arch.pio.count = 0;</div><div class='ctx'> </div><div class='hunk'>@@ -12402,7 +12402,7 @@ static int kvm_sev_es_ins(struct kvm_vcpu *vcpu, unsigned int size,</div><div class='ctx'> 	if (ret) {</div><div class='ctx'> 		vcpu-&gt;arch.pio.count = 0;</div><div class='ctx'> 	} else {</div><div class='del'>-		vcpu-&gt;arch.guest_ins_data = data;</div><div class='add'>+		vcpu-&gt;arch.sev_pio_data = data;</div><div class='ctx'> 		vcpu-&gt;arch.complete_userspace_io = complete_sev_es_emulated_ins;</div><div class='ctx'> 	}</div><div class='ctx'> </div></td></tr></table></div> <!-- class=content -->
<div class='footer'>generated by <a href='https://git.zx2c4.com/cgit/about/'>cgit 1.2.3-korg</a> (<a href='https://git-scm.com/'>git 2.43.0</a>) at 2025-01-08 16:31:39 +0000</div>
</div> <!-- id=cgit -->
</body>
</html>
