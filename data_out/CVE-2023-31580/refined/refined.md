The provided content relates to CVE-2023-31580.

**Root cause of vulnerability:**
The `light-oauth2` library does not verify the validity of the digital certificate containing the public key used to validate JWT signatures. It directly uses the public key from the certificate without proper verification.

**Weaknesses/vulnerabilities present:**
- Lack of certificate verification in JWT signature validation.
- Use of public key from a certificate without checking its validity (revoked, expired or self-signed certificates).

**Impact of exploitation:**
- Attackers can forge JWTs using the private key corresponding to a revoked, expired, or self-signed certificate.
- Successful bypass of identity authentication or authorization mechanisms, leading to man-in-the-middle attacks.

**Attack vectors:**
- Exploitation involves crafting a malicious JWT signed with a private key corresponding to an invalid certificate (self-signed, revoked, or expired).

**Required attacker capabilities/position:**
- Attackers need to be able to generate a JWT and have control or access to a private key corresponding to an invalid certificate.
- The attacker does not need to be in a privileged network position to exploit the vulnerability; it is sufficient to be able to present a forged JWT to the vulnerable application.