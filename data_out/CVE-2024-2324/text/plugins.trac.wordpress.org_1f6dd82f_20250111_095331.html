

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%3Fnew%3D3069064%2540fileorganizer%252Ftrunk%26old%3D3010587%2540fileorganizer%252Ftrunk)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* [Reverse Diff](/changeset/3010587/fileorganizer/trunk?old=3069064&old_path=%2Ffileorganizer%2Ftrunk)

---

# Changes in [fileorganizer/trunk](/browser/fileorganizer/trunk?rev=3069064 "Show entry in browser") [[3010587:3069064]](/log/fileorganizer/trunk?rev=3069064&stop_rev=3010587 "Show revision log")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Location:
[fileorganizer/trunk](/browser/fileorganizer/trunk?rev=3069064)
Files:

4 edited

* [fileorganizer.php](/browser/fileorganizer/trunk/fileorganizer.php?rev=3069064 "Show entry in browser")
  (modified)
  ([1 diff](#file0 "Show differences"))
* [init.php](/browser/fileorganizer/trunk/init.php?rev=3069064 "Show entry in browser")
  (modified)
  ([2 diffs](#file1 "Show differences"))
* [main/ajax.php](/browser/fileorganizer/trunk/main/ajax.php?rev=3069064 "Show entry in browser")
  (modified)
  ([2 diffs](#file2 "Show differences"))
* [readme.txt](/browser/fileorganizer/trunk/readme.txt?rev=3069064 "Show entry in browser")
  (modified)
  ([2 diffs](#file3 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [fileorganizer/trunk/fileorganizer.php](/changeset/3069064/fileorganizer/trunk/fileorganizer.php?old=3010587&old_path=fileorganizer%2Ftrunk%2Ffileorganizer.php "Show the [3010587:3069064] differences restricted to fileorganizer/trunk/fileorganizer.php")

  | [r3010587](/browser/fileorganizer/trunk/fileorganizer.php?rev=3010587#L4 "Show revision 3010587 of this file in browser") | [r3069064](/browser/fileorganizer/trunk/fileorganizer.php?rev=3069064#L4 "Show revision 3069064 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | Plugin URI: https://wordpress.org/plugins/fileorganizer/ |
  | 5 | 5 | Description: FileOrganizer is a plugin that helps you to manage all files in your WordPress Site. |
  | 6 |  | Version: 1.0.~~6~~ |
  |  | 6 | Version: 1.0.7 |
  | 7 | 7 | Author: Softaculous Team |
  | 8 | 8 | Author URI: https://fileorganizer.net |
* ## [fileorganizer/trunk/init.php](/changeset/3069064/fileorganizer/trunk/init.php?old=3010587&old_path=fileorganizer%2Ftrunk%2Finit.php "Show the [3010587:3069064] differences restricted to fileorganizer/trunk/init.php")

  | [r3010587](/browser/fileorganizer/trunk/init.php?rev=3010587#L15 "Show revision 3010587 of this file in browser") | [r3069064](/browser/fileorganizer/trunk/init.php?rev=3069064#L15 "Show revision 3069064 of this file in browser") |  |
  | --- | --- | --- |
  | 15 | 15 | define('FILEORGANIZER\_URL', plugins\_url('', FILEORGANIZER\_FILE)); |
  | 16 | 16 | define('FILEORGANIZER\_BASE\_NAME', basename(FILEORGANIZER\_DIR)); |
  | 17 |  | define('FILEORGANIZER\_VERSION', '1.0.~~6~~'); |
  |  | 17 | define('FILEORGANIZER\_VERSION', '1.0.7'); |
  | 18 | 18 | define('FILEORGANIZER\_WP\_CONTENT\_DIR', defined('WP\_CONTENT\_FOLDERNAME') ? WP\_CONTENT\_FOLDERNAME : 'wp-content'); |
  | 19 | 19 | define('FILEORGANIZER\_DEV', file\_exists(dirname(\_\_FILE\_\_).'/dev.php') ? 1 : 0); |
  | […](/browser/fileorganizer/trunk/init.php?rev=3010587#L143) | […](/browser/fileorganizer/trunk/init.php?rev=3069064#L143) |  |
  | 143 | 143 |  |
  | 144 | 144 | // Add Settings Page |
  | 145 |  | add\_submenu\_page( 'fileorganizer', \_\_('Settings'), \_\_('Settings'), $manu\_capability, 'settings', 'fileorganizer\_settings\_handler'); |
  |  | 145 | add\_submenu\_page( 'fileorganizer', \_\_('Settings'), \_\_('Settings'), $manu\_capability, 'fileorganizer-settings', 'fileorganizer\_settings\_handler'); |
  | 146 | 146 |  |
  | 147 | 147 | if(defined('FILEORGANIZER\_PRO')){ |
* ## [fileorganizer/trunk/main/ajax.php](/changeset/3069064/fileorganizer/trunk/main/ajax.php?old=3010587&old_path=fileorganizer%2Ftrunk%2Fmain%2Fajax.php "Show the [3010587:3069064] differences restricted to fileorganizer/trunk/main/ajax.php")

  | [r3010587](/browser/fileorganizer/trunk/main/ajax.php?rev=3010587#L114 "Show revision 3010587 of this file in browser") | [r3069064](/browser/fileorganizer/trunk/main/ajax.php?rev=3069064#L114 "Show revision 3069064 of this file in browser") |  |
  | --- | --- | --- |
  | 114 | 114 | 'locale' => 'zh\_CN', |
  | 115 | 115 | 'debug' => false, |
  | 116 |  | 'roots' => $config |
  |  | 116 | 'roots' => $config, |
  |  | 117 | 'bind' => array( |
  |  | 118 | 'upload.presave' => function(&$path, &$name, $src, $elfinder, $volume) { |
  |  | 119 |  |
  |  | 120 | // Check if the file is an SVG |
  |  | 121 | if( |
  |  | 122 | mime\_content\_type($src) == 'image/svg+xml' || |
  |  | 123 | in\_array(pathinfo($name, PATHINFO\_EXTENSION), array('svg', 'svgz') ) |
  |  | 124 | ) { |
  |  | 125 | $content = file\_get\_contents($src); |
  |  | 126 |  |
  |  | 127 | $is\_xss = ''; |
  |  | 128 |  |
  |  | 129 | while(true){ |
  |  | 130 | $found = fileorganizer\_xss\_content($content); |
  |  | 131 |  |
  |  | 132 | if(strlen($found) > 0){ |
  |  | 133 | if( in\_array($found, array('svg', 'xml')) ){ |
  |  | 134 | $content = str\_replace($found, '', $content); |
  |  | 135 | continue; |
  |  | 136 | } |
  |  | 137 |  |
  |  | 138 | $is\_xss = $found; |
  |  | 139 | } |
  |  | 140 |  |
  |  | 141 | break; |
  |  | 142 | } |
  |  | 143 |  |
  |  | 144 | // Unfiltered\_html cap needs to be checked |
  |  | 145 | if(!current\_user\_can('unfiltered\_html') && strlen($is\_xss) > 0 ){ |
  |  | 146 | return array( 'error' => \_\_('Following not allowed content found ').' : -"'. $is\_xss .'" in file '.$name); |
  |  | 147 | } |
  |  | 148 |  |
  |  | 149 | } |
  |  | 150 |  |
  |  | 151 | return true; |
  |  | 152 | } |
  |  | 153 |  |
  |  | 154 | ) |
  | 117 | 155 | ); |
  | 118 | 156 |  |
  | […](/browser/fileorganizer/trunk/main/ajax.php?rev=3010587#L170) | […](/browser/fileorganizer/trunk/main/ajax.php?rev=3069064#L208) |  |
  | 170 | 208 | die('DONE'); |
  | 171 | 209 | } |
  |  | 210 |  |
  |  | 211 | // As per the JS specification |
  |  | 212 | function fileorganizer\_unescapeHTML($str){ |
  |  | 213 | $replace = [ |
  |  | 214 | '#93' => ']', |
  |  | 215 | '#91' => '[', |
  |  | 216 | //'#61' => '=', |
  |  | 217 | 'lt' => '<', |
  |  | 218 | 'gt' => '>', |
  |  | 219 | 'quot' => '"', |
  |  | 220 | //'amp' => '&', |
  |  | 221 | '#39' => '\'', |
  |  | 222 | '#92' => '\\' |
  |  | 223 | ]; |
  |  | 224 |  |
  |  | 225 | foreach($replace as $k => $v){ |
  |  | 226 | $str = str\_replace('&'.$k.';', $v, $str); |
  |  | 227 | } |
  |  | 228 | return $str; |
  |  | 229 | } |
  |  | 230 |  |
  |  | 231 | // Check for XSS codes in our shortcodes submitted |
  |  | 232 | function fileorganizer\_xss\_content($data){ |
  |  | 233 | $data = fileorganizer\_unescapeHTML($data); |
  |  | 234 | $data = preg\_split('/\s/', $data); |
  |  | 235 | $data = implode('', $data); |
  |  | 236 | //echo $data; |
  |  | 237 |  |
  |  | 238 | if(preg\_match('/["\']javascript\:/is', $data)){ |
  |  | 239 | return 'javascript'; |
  |  | 240 | } |
  |  | 241 |  |
  |  | 242 | if(preg\_match('/["\']vbscript\:/is', $data)){ |
  |  | 243 | return 'vbscript'; |
  |  | 244 | } |
  |  | 245 |  |
  |  | 246 | if(preg\_match('/\-moz\-binding\:/is', $data)){ |
  |  | 247 | return '-moz-binding'; |
  |  | 248 | } |
  |  | 249 |  |
  |  | 250 | if(preg\_match('/expression\(/is', $data)){ |
  |  | 251 | return 'expression'; |
  |  | 252 | } |
  |  | 253 |  |
  |  | 254 | if(preg\_match('/\<(iframe|frame|script|style|link|applet|embed|xml|svg|object|layer|ilayer|meta)/is', $data, $matches)){ |
  |  | 255 | return $matches[1]; |
  |  | 256 | } |
  |  | 257 |  |
  |  | 258 | // These events not start with on |
  |  | 259 | $not\_allowed = array('click', 'dblclick', 'mousedown', 'mousemove', 'mouseout', 'mouseover', 'mouseup', 'load', 'unload', 'change', 'submit', 'reset', 'select', 'blur', 'focus', 'keydown', 'keypress', 'keyup', 'afterprint', 'beforeprint', 'beforeunload', 'error', 'hashchange', 'message', 'offline', 'online', 'pagehide', 'pageshow', 'popstate', 'resize', 'storage', 'contextmenu', 'input', 'invalid', 'search', 'mousewheel', 'wheel', 'drag', 'dragend', 'dragenter', 'dragleave', 'dragover', 'dragstart', 'drop', 'scroll', 'copy', 'cut', 'paste', 'abort', 'canplay', 'canplaythrough', 'cuechange', 'durationchange', 'emptied', 'ended', 'loadeddata', 'loadedmetadata', 'loadstart', 'pause', 'play', 'playing', 'progress', 'ratechange', 'seeked', 'seeking', 'stalled', 'suspend', 'timeupdate', 'volumechange', 'waiting', 'toggle', 'animationstart', 'animationcancel', 'animationend', 'animationiteration', 'auxclick', 'beforeinput', 'beforematch', 'beforexrselect', 'compositionend', 'compositionstart', 'compositionupdate', 'contentvisibilityautostatechange', 'focusout', 'focusin', 'fullscreenchange', 'fullscreenerror', 'gotpointercapture', 'lostpointercapture', 'mouseenter', 'mouseleave', 'pointercancel', 'pointerdown', 'pointerenter', 'pointerleave', 'pointermove', 'pointerout', 'pointerover', 'pointerrawupdate', 'pointerup', 'scrollend', 'securitypolicyviolation', 'touchcancel', 'touchend', 'touchmove', 'touchstart', 'transitioncancel', 'transitionend', 'transitionrun', 'transitionstart', 'MozMousePixelScroll', 'DOMActivate', 'afterscriptexecute', 'beforescriptexecute', 'DOMMouseScroll', 'willreveal', 'gesturechange', 'gestureend', 'gesturestart', 'mouseforcechanged', 'mouseforcedown', 'mouseforceup', 'mouseforceup'); |
  |  | 260 |  |
  |  | 261 | $not\_allowed = implode('|', $not\_allowed); |
  |  | 262 |  |
  |  | 263 | if(preg\_match('/(on|onwebkit)+('.($not\_allowed).')=/is', $data, $matches)){ |
  |  | 264 | return $matches[1]+$matches[2]; |
  |  | 265 | } |
  |  | 266 |  |
  |  | 267 | return; |
  |  | 268 | } |
* ## [fileorganizer/trunk/readme.txt](/changeset/3069064/fileorganizer/trunk/readme.txt?old=3010587&old_path=fileorganizer%2Ftrunk%2Freadme.txt "Show the [3010587:3069064] differences restricted to fileorganizer/trunk/readme.txt")

  | [r3010587](/browser/fileorganizer/trunk/readme.txt?rev=3010587#L5 "Show revision 3010587 of this file in browser") | [r3069064](/browser/fileorganizer/trunk/readme.txt?rev=3069064#L5 "Show revision 3069064 of this file in browser") |  |
  | --- | --- | --- |
  | 5 | 5 | Tested up to: 6.4 |
  | 6 | 6 | Requires PHP: 5.5 |
  | 7 |  | Stable tag: 1.0.~~6~~ |
  |  | 7 | Stable tag: 1.0.7 |
  | 8 | 8 | License: LGPL v2.1 |
  | 9 | 9 | License URI: http://www.gnu.org/licenses/lgpl-2.1.html |
  | […](/browser/fileorganizer/trunk/readme.txt?rev=3010587#L51) | […](/browser/fileorganizer/trunk/readme.txt?rev=3069064#L51) |  |
  | 51 | 51 | == Changelog == |
  | 52 | 52 |  |
  |  | 53 | = 1.0.7 (Apr 11, 2024) = |
  |  | 54 | \* [Security-Fix] An XSS vulnerability has been fixed. Please upgrade to this version as soon as possible! |
  |  | 55 |  |
  | 53 | 56 | = 1.0.6 (Dec 15, 2023) = |
  | 54 |  | \* [Security-fix] There was a ~~nonce leakage in the promo~~ which has been fixed. |
  |  | 57 | \* [Security-fix] There was a privilege check failure which has been fixed. |
  | 55 | 58 |  |
  | 56 | 59 | = 1.0.5 (Nov 29, 2023) = |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3069064&old=3010587&new_path=%2Ffileorganizer%2Ftrunk&old_path=%2Ffileorganizer%2Ftrunk)
* [Zip Archive](?format=zip&new=3069064&old=3010587&new_path=%2Ffileorganizer%2Ftrunk&old_path=%2Ffileorganizer%2Ftrunk)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

