<!DOCTYPE html>
<html lang="en">

  <head>
    <title>Full disclosure: 0day vulnerability (backdoor) in firmware for Xiaongmai-based DVRs, NVRs and IP cameras &#x2F; Habr</title>
<meta property="fb:app_id" content="444736788986613">
<meta property="fb:pages" content="472597926099084">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@habr_eng">
<meta property="og:site_name" content="Habr">
<link href="https://habr.com/en/rss/post/486856/?fl=en" type="application/rss+xml" title rel="alternate" name="rss">
<link href="https://habr.com/en/articles/486856/" rel="canonical" data-hid="e3fa780">
<link rel="image_src" href="https://habrastorage.org/webt/r_/3d/ko/r_3dkof6_ydvswrt0m0pbe3pd4q.png" data-hid="2a79c45">
<meta property="og:title" content="Full disclosure: 0day vulnerability (backdoor) in firmware for Xiaongmai-based DVRs, NVRs and IP cameras">
<meta name="twitter:title" content="Full disclosure: 0day vulnerability (backdoor) in firmware for Xiaongmai-based DVRs, NVRs and IP cameras">
<meta name="aiturec:title" content="Full disclosure: 0day vulnerability (backdoor) in firmware for Xiaongmai-based DVRs, NVRs and IP cameras">
<meta name="description" content="This is a full disclosure of recent backdoor integrated into DVR/NVR devices built on top of HiSilicon SoC with Xiaongmai firmware. Described vulnerability allows attacker to gain root shell access...">
<meta itemprop="description" content="This is a full disclosure of recent backdoor integrated into DVR/NVR devices built on top of HiSilicon SoC with Xiaongmai firmware. Described vulnerability allows attacker to gain root shell access...">
<meta property="og:description" content="This is a full disclosure of recent backdoor integrated into DVR/NVR devices built on top of HiSilicon SoC with Xiaongmai firmware. Described vulnerability allows attacker to gain root shell access...">
<meta name="twitter:description" content="This is a full disclosure of recent backdoor integrated into DVR/NVR devices built on top of HiSilicon SoC with Xiaongmai firmware. Described vulnerability allows attacker to gain root shell access...">
<meta property="aiturec:description" content="This is a full disclosure of recent backdoor integrated into DVR/NVR devices built on top of HiSilicon SoC with Xiaongmai firmware. Described vulnerability allows attacker to gain root shell access...">
<meta itemprop="image" content="https://habrastorage.org/webt/r_/3d/ko/r_3dkof6_ydvswrt0m0pbe3pd4q.png">
<meta property="og:image" content="https://habrastorage.org/webt/r_/3d/ko/r_3dkof6_ydvswrt0m0pbe3pd4q.png">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<meta property="aiturec:image" content="https://habrastorage.org/webt/r_/3d/ko/r_3dkof6_ydvswrt0m0pbe3pd4q.png">
<meta name="twitter:image" content="https://habrastorage.org/webt/r_/3d/ko/r_3dkof6_ydvswrt0m0pbe3pd4q.png">
<meta property="vk:image" content="https://habrastorage.org/webt/r_/3d/ko/r_3dkof6_ydvswrt0m0pbe3pd4q.png?format=vk">
<meta property="vk:image" content="https://habrastorage.org/webt/r_/3d/ko/r_3dkof6_ydvswrt0m0pbe3pd4q.png?format=vk">
<meta property="aiturec:item_id" content="486856">
<meta property="aiturec:datetime" content="2020-02-04T13:48:41.000Z">
<meta content="https://habr.com/en/articles/486856/" property="og:url">
<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<meta name="keywords" content="hisilicon, dvr, nvr, ip camera, vulnerability, 0day, 0day-vulnerability, backdoor, telnet">
<script type="application/ld+json" data-hid="1e0f0a2">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/en\/articles\/486856\/"},"headline":"Full disclosure: 0day vulnerability (backdoor) in firmware for Xiaongmai-based DVRs, NVRs and IP cameras","datePublished":"2020-02-04T16:48:41+03:00","dateModified":"2020-02-21T13:44:26+03:00","author":{"@type":"Person","name":"Vladislav Yarmak"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"This is a full disclosure of recent backdoor integrated into DVR\/NVR devices built on top of HiSilicon SoC with Xiaongmai firmware. Described vulnerability...","url":"https:\/\/habr.com\/en\/articles\/486856\/#post-content-body","about":["h_it-infrastructure","h_video_tech","h_infosecurity","h_crypto","h_reverse-engineering","f_develop","f_admin","f_popsci"],"image":["https:\/\/habr.com\/share\/publication\/486856\/a9371801a5731c7ab88d874f195f2675\/","https:\/\/habrastorage.org\/webt\/r_\/3d\/ko\/r_3dkof6_ydvswrt0m0pbe3pd4q.png"]}</script>
    <meta charset="UTF-8">
    <meta name="viewport"
      content="width=device-width,initial-scale=1.0,viewport-fit=cover,maximum-scale=1,user-scalable=0">
    <meta name="referrer" content="unsafe-url">
    <style>
      /* cyrillic-ext */
      @font-face {
        font-family: 'Fira Sans';
        font-style: normal;
        font-weight: 400;
        font-display: swap;
        src: url(https://fonts.gstatic.com/s/firasans/v17/va9E4kDNxMZdWfMOD5VvmojLazX3dGTP.woff2) format('woff2');
        unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
      }

      /* cyrillic */
      @font-face {
        font-family: 'Fira Sans';
        font-style: normal;
        font-weight: 400;
        font-display: swap;
        src: url(https://fonts.gstatic.com/s/firasans/v17/va9E4kDNxMZdWfMOD5Vvk4jLazX3dGTP.woff2) format('woff2');
        unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
      }

      /* latin-ext */
      @font-face {
        font-family: 'Fira Sans';
        font-style: normal;
        font-weight: 400;
        font-display: swap;
        src: url(https://fonts.gstatic.com/s/firasans/v17/va9E4kDNxMZdWfMOD5VvmYjLazX3dGTP.woff2) format('woff2');
        unicode-range: U+0100-02AF, U+0304, U+0308, U+0329, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
      }

      /* latin */
      @font-face {
        font-family: 'Fira Sans';
        font-style: normal;
        font-weight: 400;
        font-display: swap;
        src: url(https://fonts.gstatic.com/s/firasans/v17/va9E4kDNxMZdWfMOD5Vvl4jLazX3dA.woff2) format('woff2');
        unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
      }

      /* cyrillic-ext */
      @font-face {
        font-family: 'Fira Sans';
        font-style: normal;
        font-weight: 500;
        font-display: swap;
        src: url(https://fonts.gstatic.com/s/firasans/v17/va9B4kDNxMZdWfMOD5VnZKveSxf6Xl7Gl3LX.woff2) format('woff2');
        unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
      }

      /* cyrillic */
      @font-face {
        font-family: 'Fira Sans';
        font-style: normal;
        font-weight: 500;
        font-display: swap;
        src: url(https://fonts.gstatic.com/s/firasans/v17/va9B4kDNxMZdWfMOD5VnZKveQhf6Xl7Gl3LX.woff2) format('woff2');
        unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
      }

      /* latin-ext */
      @font-face {
        font-family: 'Fira Sans';
        font-style: normal;
        font-weight: 500;
        font-display: swap;
        src: url(https://fonts.gstatic.com/s/firasans/v17/va9B4kDNxMZdWfMOD5VnZKveSBf6Xl7Gl3LX.woff2) format('woff2');
        unicode-range: U+0100-02AF, U+0304, U+0308, U+0329, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
      }

      /* latin */
      @font-face {
        font-family: 'Fira Sans';
        font-style: normal;
        font-weight: 500;
        font-display: swap;
        src: url(https://fonts.gstatic.com/s/firasans/v17/va9B4kDNxMZdWfMOD5VnZKveRhf6Xl7Glw.woff2) format('woff2');
        unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
      }

      /* cyrillic-ext */
      @font-face {
        font-family: 'Fira Sans';
        font-style: normal;
        font-weight: 700;
        font-display: swap;
        src: url(https://fonts.gstatic.com/s/firasans/v17/va9B4kDNxMZdWfMOD5VnLK3eSxf6Xl7Gl3LX.woff2) format('woff2');
        unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
      }

      /* cyrillic */
      @font-face {
        font-family: 'Fira Sans';
        font-style: normal;
        font-weight: 700;
        font-display: swap;
        src: url(https://fonts.gstatic.com/s/firasans/v17/va9B4kDNxMZdWfMOD5VnLK3eQhf6Xl7Gl3LX.woff2) format('woff2');
        unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
      }

      /* latin-ext */
      @font-face {
        font-family: 'Fira Sans';
        font-style: normal;
        font-weight: 700;
        font-display: swap;
        src: url(https://fonts.gstatic.com/s/firasans/v17/va9B4kDNxMZdWfMOD5VnLK3eSBf6Xl7Gl3LX.woff2) format('woff2');
        unicode-range: U+0100-02AF, U+0304, U+0308, U+0329, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
      }

      /* latin */
      @font-face {
        font-family: 'Fira Sans';
        font-style: normal;
        font-weight: 700;
        font-display: swap;
        src: url(https://fonts.gstatic.com/s/firasans/v17/va9B4kDNxMZdWfMOD5VnLK3eRhf6Xl7Glw.woff2) format('woff2');
        unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
      }
    </style>
    <link rel="preload" href="https://assets.habr.com/habr-web/css/theme/light-v1.css" as="style" media="(prefers-color-scheme: light)" /><link rel="preload" href="https://assets.habr.com/habr-web/css/theme/dark-v1.css" as="style" media="(prefers-color-scheme: dark)" /><link id="light-colors" rel="stylesheet" href="https://assets.habr.com/habr-web/css/theme/light-v1.css" media="(prefers-color-scheme: light)" /><link id="dark-colors" rel="stylesheet" href="https://assets.habr.com/habr-web/css/theme/dark-v1.css" media="(prefers-color-scheme: dark)" />
    <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/en-compiled.7a53a1f433710823ebc80e36c624418e.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({en: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script>
    <style>
      .grecaptcha-badge {
        visibility: hidden;
      }
    </style>
    <meta name="habr-version" content="2.221.0">
    
    <meta name="apple-mobile-web-app-status-bar-style" content="#303b44">
    <meta name="msapplication-TileColor" content="#629FBC">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="shortcut icon" type="image/png" sizes="16x16" href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png">
    <link rel="shortcut icon" type="image/png" sizes="32x32" href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png">
    <link rel="apple-touch-icon" type="image/png" sizes="76x76" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png">
    <link rel="apple-touch-icon" type="image/png" sizes="120x120" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png">
    <link rel="apple-touch-icon" type="image/png" sizes="152x152" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png">
    <link rel="apple-touch-icon" type="image/png" sizes="180x180" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png">
    <link rel="apple-touch-icon" type="image/png" sizes="256x256" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png">
    <link rel="mask-icon" color="#77a2b6" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg">
    <link crossorigin="use-credentials" href="/manifest.webmanifest" rel="manifest">
    <script async src="https://unpkg.com/pwacompat" crossorigin="anonymous"></script>
    <script>window.yaContextCb = window.yaContextCb || []</script>
    <script src="https://yandex.ru/ads/system/context.js" async></script>
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.04465f7c.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.da7fa5db.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/app.24cd0aa3.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/app.717c3c23.js" as="script"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.04465f7c.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.24cd0aa3.css"></head>
  <body>
    
    <div id="mount"><div id="app" data-async-called="true"><div class="tm-layout__wrapper"><!--[--><!----><div></div><!----><header class="tm-header" data-test-id="header"><div class="tm-page-width"><!--[--><div class="tm-header__container"><!----><span class="tm-header__logo-wrap"><a class="tm-header__logo tm-header__logo_hl-en tm-header__logo" href="/en/"><svg class="tm-svg-img tm-header__icon" height="16" width="16"><title>Habr</title><use xlink:href="/img/habr-logo-en.svg#logo"></use></svg></a><span style="display:none;" class="tm-header__beta-sign">β</span></span><!--[--><!----><a href="/en/sandbox/start/" class="tm-header__become-author-btn">How to become an author</a><!----><!----><!--]--><!----></div><!--]--></div></header><div class="tm-layout"><div class="tm-page-progress-bar"></div><div class="tm-base-layout__header_is-sticky tm-base-layout__header" data-menu-sticky="true"><div class="tm-page-width"><!--[--><div class="tm-base-layout__header-wrapper"><div class="tm-main-menu"><div class="tm-main-menu__section"><nav class="tm-main-menu__section-content"><!--[--><a class="tm-main-menu__item" data-test-id="main-menu-item" href="/en/feed/">My feed</a><!--]--><!--[--><a class="tm-main-menu__item" href="/en/articles/">All streams</a><!--]--><!--[--><!--[--><!--[--><a class="tm-main-menu__item" data-test-id="main-menu-item" href="/en/flows/develop/">Development</a><!--]--><!--]--><!--[--><!--[--><a class="tm-main-menu__item" data-test-id="main-menu-item" href="/en/flows/admin/">Admin</a><!--]--><!--]--><!--[--><!--[--><a class="tm-main-menu__item" data-test-id="main-menu-item" href="/en/flows/design/">Design</a><!--]--><!--]--><!--[--><!--[--><a class="tm-main-menu__item" data-test-id="main-menu-item" href="/en/flows/management/">Management</a><!--]--><!--]--><!--[--><!--[--><a class="tm-main-menu__item" data-test-id="main-menu-item" href="/en/flows/marketing/">Marketing</a><!--]--><!--]--><!--[--><!--[--><a class="tm-main-menu__item" data-test-id="main-menu-item" href="/en/flows/popsci/">PopSci</a><!--]--><!--]--><!--]--></nav></div></div><div class="tm-header-user-menu tm-base-layout__user-menu"><a href="/en/search/" class="tm-header-user-menu__item tm-header-user-menu__search" data-test-id="search-button"><svg class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark" height="24" width="24"><title>Search</title><use xlink:href="/img/megazord-v28.7909a852..svg#search"></use></svg></a><!----><!----><div class="tm-header-user-menu__item tm-header-user-menu__write"><div><svg class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_write tm-header-user-menu__icon_dark" height="24" width="24"><title>Write a publication</title><use xlink:href="/img/megazord-v28.7909a852..svg#write"></use></svg></div><!----></div><!--[--><div class="tm-header-user-menu__item"><button class="tm-header-user-menu__toggle" data-test-id="user-menu-settings"><svg class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_dark" height="24" width="24"><title>Settings</title><use xlink:href="/img/megazord-v28.7909a852..svg#page-settings"></use></svg></button></div><a href="https://habr.com/kek/v1/auth/habrahabr/?back=/en/articles/486856/&amp;hl=en" rel="nofollow" class="tm-header-user-menu__item"><!--[--><button class="btn btn_solid btn_small tm-header-user-menu__login" type="button"><!--[-->Login<!--]--></button><!--]--></a><!--]--><!----><!--teleport start--><!--teleport end--><!----></div></div><!--]--></div></div><!----><div class="tm-page-width"><!--[--><!--]--></div><main class="tm-layout__container"><div class="tm-page" hl="en" data-async-called="true"><div class="tm-page-width"><!--[--><!----><div class="tm-page__wrapper"><div class="tm-page__main_has-sidebar tm-page__main"><div class="pull-down"><!----><div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg class="tm-svg-img pull-down__icon pull-down__arrow" height="24" width="24"><title>Pull to refresh</title><use xlink:href="/img/megazord-v28.7909a852..svg#pull-arrow"></use></svg></div></div><!--[--><!--[--><div class="tm-adfox-banner__container"><div id="adfox_169815559787254866" class="tm-adfox-banner tm-adfox-banner_variant-narrow tm-adfox-banner"></div></div><div class="tm-article-presenter"><!--[--><!--]--><div class="tm-article-presenter__body" data-test-id="article-body"><div class="tm-misprint-area"><div class="tm-misprint-area__wrapper"><!--[--><article class="tm-article-presenter__content tm-article-presenter__content_narrow"><!--[--><div class="tm-article-presenter__header"><!--[--><!--]--><div class="tm-article-snippet tm-article-snippet tm-article-presenter__snippet"><!--[--><!--]--><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="/en/users/YourChief/" class="tm-user-info__userpic" data-test-id="user-info-pic" title="YourChief"><div class="tm-entity-image"><!--[--><img alt="" class="tm-entity-image__pic" height="24" src="https://assets.habr.com/habr-web/img/avatars/111.png" width="24"><!--]--></div></a><span class="tm-user-info__user tm-user-info__user_appearance-default" data-test-id="user-info-description"><a href="/en/users/YourChief/" class="tm-user-info__username">YourChief <!----></a><!--[--><span class="tm-article-datetime-published"><time datetime="2020-02-04T13:48:41.000Z" title="2020-02-04, 16:48"> Feb  4 2020 at 16:48</time></span><!--]--></span></span></div><!----></div><h1 class="tm-title tm-title_h1" lang="ru" data-test-id="articleTitle"><span>Full disclosure: 0day vulnerability (backdoor) in firmware for Xiaongmai-based DVRs, NVRs and IP cameras</span></h1><div class="tm-article-snippet__stats" data-test-id="articleStats"><!----><div class="tm-article-reading-time"><span class="tm-svg-icon__wrapper tm-article-reading-time__icon"><svg class="tm-svg-img tm-svg-icon" height="24" width="24"><title>Reading time</title><use xlink:href="/img/megazord-v28.7909a852..svg#clock"></use></svg></span><span class="tm-article-reading-time__label">6 min</span></div><span class="tm-icon-counter tm-data-icons__item"><svg class="tm-svg-img tm-icon-counter__icon" height="24" width="24"><title>Views</title><use xlink:href="/img/megazord-v28.7909a852..svg#counter-views"></use></svg><span class="tm-icon-counter__value">96K</span></span></div><div class="tm-publication-hubs__container" data-test-id="articleHubsList"><div class="tm-publication-hubs"><!--[--><span class="tm-publication-hub__link-container"><a href="/en/hubs/it-infrastructure/" class="tm-publication-hub__link"><!--[--><span>IT Infrastructure</span><span class="tm-article-snippet__profiled-hub" title="Core hub">*</span><!--]--></a></span><span class="tm-publication-hub__link-container"><a href="/en/hubs/video_tech/" class="tm-publication-hub__link"><!--[--><span>Video equipment</span><!----><!--]--></a></span><span class="tm-publication-hub__link-container"><a href="/en/hubs/infosecurity/" class="tm-publication-hub__link"><!--[--><span>Information Security</span><span class="tm-article-snippet__profiled-hub" title="Core hub">*</span><!--]--></a></span><span class="tm-publication-hub__link-container"><a href="/en/hubs/crypto/" class="tm-publication-hub__link"><!--[--><span>Cryptography</span><span class="tm-article-snippet__profiled-hub" title="Core hub">*</span><!--]--></a></span><span class="tm-publication-hub__link-container"><a href="/en/hubs/reverse-engineering/" class="tm-publication-hub__link"><!--[--><span>Reverse engineering</span><span class="tm-article-snippet__profiled-hub" title="Core hub">*</span><!--]--></a></span><!--]--></div></div><!----><!----><!----></div></div><!--[--><!----><div class="tm-article-body" data-gallery-root lang="en"><div><!--[--><!--]--></div><div id="post-content-body"><div><div class="article-formatted-body article-formatted-body article-formatted-body_version-1"><div xmlns="http://www.w3.org/1999/xhtml"><div style="text-align:center;"><img src="https://habrastorage.org/r/w1560/webt/r_/3d/ko/r_3dkof6_ydvswrt0m0pbe3pd4q.png" data-src="https://habrastorage.org/webt/r_/3d/ko/r_3dkof6_ydvswrt0m0pbe3pd4q.png"/></div><br/>
This is a full disclosure of recent backdoor integrated into DVR/NVR devices built on top of HiSilicon <abbr title="System on Chip">SoC</abbr> with Xiaongmai firmware. Described vulnerability allows attacker to gain root shell access and full control of device. Full disclosure format for this report has been chosen due to lack of trust to vendor. Proof of concept code is presented below.<br/>
<a name="habracut"></a><br/>
<h2>Previous work and historical context</h2><br/>
Earliest known versions of it had telnet access enabled with a static root password which can be recovered from firmware image with (relatively) little computation effort. This vulnerability was covered by <a href="https://habr.com/ru/post/173501/">previous author's article (in Russian)</a> in 2013. In 2017 Istvan Toth did a <a href="https://github.com/tothi/pwn-hisilicon-dvr" rel="nofollow">most comprehensive analysis</a> of DVR device's firmware. He also discovered remote code execution vulnerability in the built-in webserver and many other vulnerabilities. It's worth noting that disclosure was ignored by vendor.<br/>
<br/>
More recent firmware versions had telnet access and debug port (9527/tcp) disabled by default. Instead they had open port 9530/tcp which was used to accept special command to start telnet daemon and enable shell access with static password which is the same for all devices. Such case was covered by these articles:<br/>
<br/>
<ul>
<li><a href="https://www.cnblogs.com/mmseh/p/6537924.html" rel="nofollow">https://www.cnblogs.com/mmseh/p/6537924.html</a>, 2017 (in Chinese)</li>
<li><a href="https://habr.com/ru/post/332526/">https://habr.com/ru/post/332526/</a>, 2017 (in Russian, by Habr user <a href="https://habr.com/ru/users/centalt/" class="user_link">CentALT</a>)</li>
</ul><br/>
Most recent firmware versions have open port 9530/tcp listening for special commands, but require cryptographic challenge-response authentication for them to be committed. This is a subject of actual disclosure.<br/>
<br/>
<h2>Technical details</h2><br/>
Vulnerable DVR/NVR/IP camera devices under discussion are running Linux with minimal set of utilities provided by <a href="https://www.busybox.net/" rel="nofollow">busybox</a>, main video application <code>Sofia</code> and a small set of custom auxilary utilities responsible for support of device operation. Hardware has ARM-based CPU tens to hundreds megabytes of RAM.<br/>
<br/>
Device with vulnerable firmware has <code>macGuarder</code> or <code>dvrHelper</code> process running and accepting connections on TCP port 9530. Code and log strings suggest that <code>macGuarder</code> formerly was a separate process, but later it's functions were merged into <code>dvrHelper</code> process as a separate thread.<br/>
<br/>
It's worth noting that earlier versions of firmware had dvrHelper process compiled into busybox as additional applet. Taking into account busybox has GNU GPL license, it is possible that license violation takes place because dvrHelper software was distributed without source code.<br/>
<br/>
Successful backdoor activation process is following:<br/>
<br/>
<ol>
<li>Client opens connection to port TCP port 9530 of device and sends string <code>OpenTelnet:OpenOnce</code> prepended with byte indicating total message length. This step is last for previous versions of backdoor. Probably telnetd was already started if there no response after this step.</li>
<li>Server (device) anwers with string <code>randNum:XXXXXXXX</code> where <code>XXXXXXXX</code> is 8-digit random decimal number.</li>
<li>Client uses it's pre-shared key and constructs encryption key as concatenation of received random number and PSK.</li>
<li>Client encrypts random number with encryption key and sends it after string <code>randNum:</code>. Entire message is prepended with byte indicating total length of message.</li>
<li>Server loads same pre-shared key from file <code>/mnt/custom/TelnetOEMPasswd</code> or uses default key <code>2wj9fsa2</code> if file is missing.</li>
<li>Server performs encryption of random number and verifies result is identical with string from client. On success server sends string <code>verify:OK</code> or <code>verify:ERROR</code> otherwise.</li>
<li>Client encrypts string <code>Telnet:OpenOnce</code>, prepends it with total length byte, <code>CMD:</code> string and sends to server.</li>
<li>Server extracts and decryptes received command. If decryption result is equal to string <code>Telnet:OpenOnce</code> it responds with <code>Open:OK</code>, enables debug port 9527 and starts telnet daemon.</li>
</ol><br/>
Entire authentication process may resemble some sort of HMAC challenge-response authentication except it uses symmetric cipher instead of hash. This particular symmetric cipher resembles some variation of 3DES-EDE2 for keys longer than 8 bytes and similar to simple DES for shorter keys.<br/>
<br/>
It's easy to see that all clients need for successful authentication is knowledge of PSK (which is common and can be retrieved from firmware in plaintext) and implementation of that symmetric block cipher. Recovery of that symmetric cipher implementation is most difficult, but it was achieved during this research. Exploration and tests were conducted using this set of tools:<br/>
<br/>
<ul>
<li>Ghidra 9.1.1 from NSA (<a href="https://ghidra-sre.org/" rel="nofollow">https://ghidra-sre.org/</a>) — suite for binary executeble code inspection.</li>
<li>QEMU (more specifically qemu-user in Debian chroot — <a href="https://www.qemu.org/" rel="nofollow">https://www.qemu.org/</a>) — software which allows foreign architecture binaries (ARM) to be executed transparently on host.</li>
<li>Common GNU utilities and toolchain.</li>
</ul><br/>
Once telnet daemon activated, it's very likely it will accept one of following login/password pairs:<br/>
<div class="scrollable-table"><table>
<tr>
<th>Login</th>
<th>Password</th>
</tr>
<tr>
<td><code>root</code></td>
<td><code>xmhdipc</code></td>
</tr>
<tr>
<td><code>root</code></td>
<td><code>klv123</code></td>
</tr>
<tr>
<td><code>root</code></td>
<td><code>xc3511</code></td>
</tr>
<tr>
<td><code>root</code></td>
<td><code>123456</code></td>
</tr>
<tr>
<td><code>root</code></td>
<td><code>jvbzd</code></td>
</tr>
<tr>
<td><code>root</code></td>
<td><code>hi3518</code></td>
</tr>
</table></div><br/>
These passwords can be recovered from firmware as well by bruteforce of hash in <code>/etc/passwd</code> file. Modern consumer-grade GPGPU with <a href="https://hashcat.net/hashcat/" rel="nofollow">hashcat</a> is capable to find pre-image for hash in a matter of hours.<br/>
<br/>
Debug port 9527 accepts same login/password as Web UI and it also provides some shell access and functions to control the device. Speaking of Web UI accounts, attacker may reset password or grab password hashes from <code>/mnt/mtd/Config/Account*</code> files. Hash function was <a href="https://github.com/tothi/pwn-hisilicon-dvr#password-hash-function" rel="nofollow">described in previous research</a> by Istvan Toth.<br/>
<br/>
<h2>Affected devices</h2><br/>
Previous research has a good collection of brands affected: <a href="https://github.com/tothi/pwn-hisilicon-dvr#summary" rel="nofollow">https://github.com/tothi/pwn-hisilicon-dvr#summary</a>. There are dozens of brands and hundreds of models.<br/>
<br/>
Author of this report, reposing on survey across population of random IP addresses, estimates total number of vulnerable devices exposed via Internet somewhere between hundreds of thousands and millions.<br/>
<br/>
Probably, the easiest way to check whether your device is vulnerable is PoC code provided below.<br/>
<br/>
<h2>Testing vulnerability</h2><br/>
PoC code: <a href="https://github.com/Snawoot/hisilicon-dvr-telnet" rel="nofollow">https://github.com/Snawoot/hisilicon-dvr-telnet</a>.<br/>
<br/>
Building PoC program from source: run <code>make</code> in source directory.<br/>
<br/>
Usage: <code>./hs-dvr-telnet HOST PSK</code><br/>
<br/>
Most common PSK is default one: <code>2wj9fsa2</code>.<br/>
<br/>
Example session:<br/>
<br/>
<pre>
$ telnet 198.51.100.23
Trying 198.51.100.23...
telnet: Unable to connect to remote host: Connection refused
$ ./hs-dvr-telnet 198.51.100.23 2wj9fsa2
Sent OpenTelnet:OpenOnce command.
randNum:46930886
challenge=469308862wj9fsa2
verify:OK
Open:OK
$ telnet 198.51.100.23
Trying 198.51.100.23...
Connected to 198.51.100.23.
Escape character is '^]'.
LocalHost login: root
Password: 
</pre><br/>
<br/>
IP address in example above is an IP address from address block reserved for documentation by RFC5737.<br/>
<br/>
Device should be considered vulnerable if:<br/>
<br/>
<ul>
<li>Telnet port opens after <code>hs-dvr-telnet</code> run.</li>
<li>Device responds with challenge on <code>hs-dvr-telnet</code> inquiry. Even if verification fails due to wrong PSK, there exists correct PSK extractable from firmware.</li>
<li>hs-dvr-telnet stucks awaiting for response, but telnet port opens (this will happen with older firmware versions which require only <code>OpenTelnet:OpenOnce</code> command).</li>
</ul><br/>
<h2>Mitigation</h2><br/>
Taking into account earlier bogus fixes for that vulnerability (backdoor, actually) it is not practical to expect security fixes for firmware from vendor. Owners of such devices should consider switching to alternatives.<br/>
<br/>
However, if replacement is not possible, device owners should completely restrict network access to these devices to trusted users. Ports involved in this vulnerability is 23/tcp, 9530/tcp, 9527/tcp, but earlier researches indicate there is no confidence other services implementation is solid and doesn't contain <abbr title="Remote Code Execution">RCE</abbr> vulnerabilities.<br/>
<br/>
<h2>Subjects not covered by this research</h2><br/>
Code analysis revealed that authentication procedure on port 9530 decrypts «CMD» payload with arbitrary size (up to size of buffer read from socket at once) into a buffer on stack with fixed size of 32 bytes. Targeted exploitation of this overflow requires knowledge of PSK, therefore it's more practical to proceed normal way to gain access. On the other hand, garbage sent with CMD command may cause stack corruption and dvrHelper daemon failure. Possible effects of that (potential) failure wasn't explored because macGuarder/dvrHelper backdoor functionality appears strictly superior and straightforward approach.<br/>
<br/>
<b>UPDATE</b> (2020-02-05 02:10+00:00): Istvan Toth, author of <a href="https://github.com/tothi/pwn-hisilicon-dvr" rel="nofollow">previous research</a> on this subject, presented his own implementation of PoC program: <a href="https://github.com/tothi/hs-dvr-telnet" rel="nofollow">https://github.com/tothi/hs-dvr-telnet</a> Given implementation is written in pure Python code and implements symmetric cipher in more clear way. Also it outlines differences between 3DES cipher variant used by Xiongmai for backdoor authentication and original 3DES cipher. These differences can be expressed by this git commit: <a href="https://github.com/tothi/pyDes/commit/7a26fe09dc5b57b175c6439fbbf496414598a7a2" rel="nofollow">https://github.com/tothi/pyDes/commit/7a26fe09dc5b57b175c6439fbbf496414598a7a2</a>.<br/>
<br/>
<b>UPDATE</b> (2020-02-05 17:28+00:00): Other researchers and habr users had pointed out such vulnerability is restricted to devices based on Xiongmai (Hangzhou Xiongmai Technology Co, XMtech) software, including products of other vendors which ship products based on such software. At this moment HiSilicon can't be held responsible for backdoor in dvrHelper/macGuarder binary.<br/>
<br/>
<b>UPDATE</b> (2020-02-21 10:30+00:00): Xiaongmai acknowledged vulnerability and released a Security Advisory: <a href="http://www.xiongmaitech.com/en/index.php/news/info/12/68" rel="nofollow">link</a>, <a href="http://web.archive.org/web/20200221103130/http://www.xiongmaitech.com/en/index.php/news/info/12/68" rel="nofollow">archive 1</a>, <a href="https://archive.fo/foJ47" rel="nofollow">archive 2</a>. Body of actual article has been updated accordingly in order to reflect origin of vulnerability properly.</div></div></div><!----><!----></div><!----><!----></div><!--]--><!----><div class="tm-article-presenter__meta" data-test-id="article-meta-links"><div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Tags:</span><ul class="tm-separated-list__list"><!--[--><li class="tm-separated-list__item"><!--[--><a href="/en/search/?target_type=posts&amp;order=relevance&amp;q=[hisilicon]" class="tm-tags-list__link"><span>hisilicon</span></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a href="/en/search/?target_type=posts&amp;order=relevance&amp;q=[dvr]" class="tm-tags-list__link"><span>dvr</span></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a href="/en/search/?target_type=posts&amp;order=relevance&amp;q=[nvr]" class="tm-tags-list__link"><span>nvr</span></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a href="/en/search/?target_type=posts&amp;order=relevance&amp;q=[ip+camera]" class="tm-tags-list__link"><span>ip camera</span></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a href="/en/search/?target_type=posts&amp;order=relevance&amp;q=[vulnerability]" class="tm-tags-list__link"><span>vulnerability</span></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a href="/en/search/?target_type=posts&amp;order=relevance&amp;q=[0day]" class="tm-tags-list__link"><span>0day</span></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a href="/en/search/?target_type=posts&amp;order=relevance&amp;q=[0day-vulnerability]" class="tm-tags-list__link"><span>0day-vulnerability</span></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a href="/en/search/?target_type=posts&amp;order=relevance&amp;q=[backdoor]" class="tm-tags-list__link"><span>backdoor</span></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a href="/en/search/?target_type=posts&amp;order=relevance&amp;q=[telnet]" class="tm-tags-list__link"><span>telnet</span></a><!--]--></li><!--]--><!----></ul></div><div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Hubs:</span><ul class="tm-separated-list__list"><!--[--><li class="tm-separated-list__item"><!--[--><a href="/en/hubs/it-infrastructure/" class="tm-hubs-list__link"><!--[--><span>IT Infrastructure</span><!--]--></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a href="/en/hubs/video_tech/" class="tm-hubs-list__link"><!--[--><span>Video equipment</span><!--]--></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a href="/en/hubs/infosecurity/" class="tm-hubs-list__link"><!--[--><span>Information Security</span><!--]--></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a href="/en/hubs/crypto/" class="tm-hubs-list__link"><!--[--><span>Cryptography</span><!--]--></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a href="/en/hubs/reverse-engineering/" class="tm-hubs-list__link"><!--[--><span>Reverse engineering</span><!--]--></a><!--]--></li><!--]--><!----></ul></div></div><!----><!--]--></article><!--]--></div><!----></div><div style="" class="tm-article-sticky-panel" data-test-id="article-sticky-panel" data-async-called="true"><!--[--><div class="tm-data-icons tm-data-icons tm-data-icons_space-big tm-article-sticky-panel__icons" data-test-id="article-stats-icons"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-meter tm-article-rating__votes-switcher"><svg class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-article" height="24" width="24"><title>Total votes 13: ↑12 and ↓1</title><use xlink:href="/img/megazord-v28.7909a852..svg#counter-rating"></use></svg><span class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-article tm-votes-meter__value_rating tm-votes-meter__value" data-test-id="votes-meter-value" title="Total votes 13: ↑12 and ↓1">+17</span></div><!--teleport start--><!--teleport end--><!----></div><!----><!----><button class="bookmarks-button tm-data-icons__item" title="Add to bookmarks" type="button"><span class="tm-svg-icon__wrapper bookmarks-button__icon"><svg class="tm-svg-img tm-svg-icon" height="24" width="24"><title>Add to bookmarks</title><use xlink:href="/img/megazord-v28.7909a852..svg#counter-favorite"></use></svg></span><span class="bookmarks-button__counter" title="Users added publication to bookmarks">8</span></button><div class="tm-sharing tm-data-icons__item" title="Share"><button class="tm-sharing__button" type="button"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="tm-sharing__icon"><path fill="currentColor" d="M13.8 13.8V18l7.2-6.6L13.8 5v3.9C5 8.9 3 18.6 3 18.6c2.5-4.4 6-4.8 10.8-4.8z"></path></svg></button><!--teleport start--><!--teleport end--></div><div class="tm-article-comments-counter-link tm-data-icons__item" title="Read comments"><a href="/en/articles/486856/comments/" class="tm-article-comments-counter-link__link" data-test-id="counter-comments"><!--[--><svg class="tm-svg-img tm-article-comments-counter-link__icon" height="24" width="24"><title>Comments</title><use xlink:href="/img/megazord-v28.7909a852..svg#counter-comments"></use></svg><span class="tm-article-comments-counter-link__value">15</span><!--]--></a><!----></div><!--[--><!--[--><!--[--><!----><!--]--><!--]--><!--]--><div class="reactions-panel-wrapper"><!--[--><div class="reactions-panel" data-v-b6856ae4><div class="reactions" data-v-b6856ae4><!--[--><!--]--><!----></div><!----><div class="add" data-v-b6856ae4><button class="add-reaction-button" data-v-b6856ae4 data-v-8ae43288><div class="add-icon-wrapper" title="Reactions" data-v-8ae43288><svg xmlns="&lt;http://www.w3.org/2000/svg&gt;" viewbox="0 0 24 24" class="add-reaction-icon" data-v-8ae43288><path fill="currentColor" d="M20 1h-2v3h-3v2h3v3h2V6h3V4h-3V1zm-8 2c.338 0 .672.019 1 .055V5.07A7 7 0 1018.93 11h2.015A9 9 0 1112 3zm-2.5 8a1.5 1.5 0 100-3 1.5 1.5 0 000 3zM16 9.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM12 17c-2.05 0-4-1-4-3h8c0 2-1.95 3-4 3z"></path></svg></div></button></div><!----><!----></div><!--]--></div><!--teleport start--><!--teleport end--><!----></div><!----><!--]--></div></div><!--[--><!--]--><div class="tm-article-presenter__footer"><!--[--><!--[--><div class="tm-article-blocks"><!----><!--[--><section class="tm-block tm-block tm-block_spacing-bottom"><!----><!--[--><div class="tm-block__body tm-block__body tm-block__body_variant-balanced"><!--[--><div class="tm-article-author" data-test-id="article-author-info"><!--[--><!--]--><div class="tm-user-card tm-user-card tm-user-card_variant-article tm-article-author__user-card" data-async-called="true"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a href="/en/users/YourChief/" class="tm-user-card__userpic tm-user-card__userpic_size-40"><div class="tm-entity-image"><!--[--><img alt="" class="tm-entity-image__pic" src="https://assets.habr.com/habr-web/img/avatars/111.png"><!--]--></div></a><div class="tm-user-card__meta"><div class="tm-counter-container tm-karma tm-karma" title=" 292 votes "><div class="tm-counter-container__header"><!--[--><div class="karma-display positive" data-v-7635202e>124</div><!----><!--]--></div><div class="tm-counter-container__footer"><!--[--><div class="tm-karma__text">Karma</div><!--teleport start--><!--teleport end--><!--]--></div></div><div class="tm-counter-container" title="User`s rating"><div class="tm-counter-container__header"><!--[--><!--[--><!--]--><div class="tm-votes-lever tm-votes-lever tm-votes-lever_appearance-rating"><!----><div class="tm-votes-lever__score tm-votes-lever__score_appearance-rating tm-votes-lever__score"><!--[--><span><span class="tm-votes-lever__score-counter tm-votes-lever__score-counter_rating tm-votes-lever__score-counter" data-test-id="votes-score-counter">24.1</span></span><!--]--></div><!----></div><!--]--></div><div class="tm-counter-container__footer"><!--[--><span class="tm-rating__text tm-rating__text">Rating</span><!--]--></div></div></div></div></div><div class="tm-user-card__info tm-user-card__info_variant-article tm-user-card__info"><div class="tm-user-card__title tm-user-card__title_variant-article tm-user-card__title"><span class="tm-user-card__name tm-user-card__name_variant-article tm-user-card__name">Vladislav Yarmak</span><a href="/en/users/YourChief/" class="tm-user-card__nickname tm-user-card__nickname tm-user-card__nickname_variant-article"> @YourChief</a><!----></div><p class="tm-user-card__short-info tm-user-card__short-info_variant-article tm-user-card__short-info" data-test-id="user-card-speciality">11x engineer</p></div></div><div class="tm-user-card__buttons tm-user-card__buttons_variant-article tm-user-card__buttons"><!----><div class="tm-user-card__button"><div class="tm-button-follow tm-user-card__button-follow"><!----><button class="tm-button-follow__button tm-button-follow__button_big" data-test-id="follow-button" type="button">Follow</button></div></div><!----><div class="tm-user-card__button tm-user-card__button_write" data-test-id="user-card-conversations"><svg class="tm-svg-img tm-user-card__button-icon" height="16" width="16"><title>Send message</title><use xlink:href="/img/megazord-v28.7909a852..svg#mail"></use></svg></div><!----></div><!----></div><div class="tm-article-author__user-contacts" data-test-id="author-contacts"><!--[--><a class="tm-article-author__contact" data-test-id="author-contact-link" href="https://twitter.com/snawoot" rel="noopener" target="_blank">Twitter</a><a class="tm-article-author__contact" data-test-id="author-contact-link" href="https://github.com/Snawoot/" rel="noopener" target="_blank">Github</a><a class="tm-article-author__contact" data-test-id="author-contact-link" href="https://telegram.me/Snawoot" rel="noopener" target="_blank">Telegram</a><!--]--></div></div><!--]--></div><!--]--><!----></section><!----><!--[--><div class="tm-adfox-banner__container tm-page-article__banner"><div id="adfox_164725660339535756" class="tm-adfox-banner tm-adfox-banner_variant-leaderboard tm-adfox-banner"></div></div><!--]--><!--]--><div class="tm-article-blocks__comments"><div id="publication-comments" class="tm-article-page-comments"><div><!--[--><div class="tm-article-comments-counter-link tm-article-comments-counter-button"><a href="/en/articles/486856/comments/" class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style" data-test-id="counter-comments"><!--[--><svg class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted" height="24" width="24"><title>Comments</title><use xlink:href="/img/megazord-v28.7909a852..svg#counter-comments"></use></svg><span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted"> Comments 15 </span><!--]--></a><!----></div><!--]--></div></div></div><!--[--><!--[--><!--]--><section class="tm-block tm-block tm-block_spacing-bottom"><header class="tm-block__header tm-block__header tm-block__header_variant-borderless"><div class="tm-block__header-container"><h2 class="tm-block__title tm-block__title tm-block__title_variant-large">Articles</h2><!--[--><!--]--></div><!----></header><!--[--><div class="tm-block__body tm-block__body tm-block__body_variant-condensed-slim"><!--[--><!--[--><div class="tm-tabs tm-tabs"><div class=""><!--[--><span class="tm-tabs__tab-item"><button class="tm-tabs__tab-link tm-tabs__tab-link_active tm-tabs__tab-link_slim tm-tabs__tab-link">Top of the day</button></span><span class="tm-tabs__tab-item"><button class="tm-tabs__tab-link tm-tabs__tab-link_slim tm-tabs__tab-link">Similar articles</button></span><!--]--></div><!----></div><div class="similar-and-daily__tab-view"><div class="daily-articles-list"><ul class="tm-article-card-list"><!--[--><!--]--><div class="tm-bordered-card"><!----><!--[--><!--]--></div></ul><div class="daily-articles-block__button-container"><button class="btn btn_transparent btn_small tm-button tm-button_color-horizon" type="button"><!--[--><!--[-->Show the best of all time<!--]--><!--]--></button></div></div><!----></div><!--]--><!--]--></div><!--]--><!----></section><!--[--><div><div class="placeholder-wrapper"><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><div class="tm-placeholder-promo"><div class="tm-placeholder-promo__header"><div class="tm-placeholder__line tm-placeholder__line_promo-title"></div></div><div class="tm-placeholder-promo__body"><div class="tm-placeholder-promo__posts"><div class="tm-placeholder-promo__post"><div class="tm-placeholder-promo__image"></div><div class="tm-placeholder__line tm-placeholder__line_post-title"></div></div><div class="tm-placeholder-promo__post"><div class="tm-placeholder-promo__image"></div><div class="tm-placeholder__line tm-placeholder__line_post-title"></div></div><div class="tm-placeholder-promo__post"><div class="tm-placeholder-promo__image"></div><div class="tm-placeholder__line tm-placeholder__line_post-title"></div></div></div><div class="tm-placeholder-promo__dots"><div class="tm-placeholder-promo__dot"></div><div class="tm-placeholder-promo__dot"></div><div class="tm-placeholder-promo__dot"></div></div></div></div><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----></div></div><div class="placeholder-wrapper"><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><div class="tm-placeholder-inset tm-placeholder-questions"><div class="tm-placeholder-inset__header"><div class="tm-placeholder__line tm-placeholder__line_inset-header loads"></div></div><div class="tm-placeholder-inset__body"><ul class="tm-placeholder-list"><!--[--><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div><div class="tm-project-block-items__properties"><!--[--><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><!--]--></div></li><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div><div class="tm-project-block-items__properties"><!--[--><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><!--]--></div></li><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div><div class="tm-project-block-items__properties"><!--[--><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><!--]--></div></li><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div><div class="tm-project-block-items__properties"><!--[--><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><!--]--></div></li><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div><div class="tm-project-block-items__properties"><!--[--><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><!--]--></div></li><!--]--></ul></div><div class="tm-placeholder-inset__footer"><div class="tm-placeholder__line tm-placeholder__line_inset-footer loads"></div></div></div><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----></div><!--]--><!----><!--[--><!--]--><!--]--></div><!--]--><!--]--></div></div><!--]--><!--]--></div></div><div class="tm-page__sidebar"><!--[--><div class="tm-layout-sidebar"><div class="tm-layout-sidebar__placeholder_initial"></div><div class="tm-sexy-sidebar_initial tm-sexy-sidebar" style="margin-top:0px;"><!--[--><!--]--><!----><div class="tm-layout-sidebar__ads_initial tm-layout-sidebar__ads"><div class="tm-adfox-banner__container tm-layout-sidebar__banner tm-layout-sidebar__banner_top"><div id="adfox_164725680533065327" class="tm-adfox-banner tm-adfox-banner_variant-half-page tm-adfox-banner"></div></div></div><!--[--><!----><div data-async-called="true"></div><!----><!----><!--]--><div class="tm-adfox-banner__container tm-layout-sidebar__banner tm-layout-sidebar__banner_bottom"><div id="adfox_164725691003361602" class="tm-adfox-banner tm-adfox-banner_variant-medium-rectangle tm-adfox-banner"></div></div></div></div><!--]--></div></div><!----><!--]--></div><!----></div></main><!----></div><div class="tm-footer-menu"><div class="tm-page-width"><!--[--><div class="tm-footer-menu__container"><!--[--><div class="tm-footer-menu__block"><p class="tm-footer-menu__block-title">Your account</p><div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><!--[--><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr/?back=/en/articles/486856/&amp;hl=en" rel="nofollow" target="_self">Log in</a></li><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr-register/?back=/en/articles/486856/&amp;hl=en" rel="nofollow" target="_self">Sign up</a></li><!--]--></ul></div></div><div class="tm-footer-menu__block"><p class="tm-footer-menu__block-title">Sections</p><div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><!--[--><li class="tm-footer-menu__list-item"><a href="/en/articles/" class="footer-menu__item-link">Articles</a></li><li class="tm-footer-menu__list-item"><a href="/en/news/" class="footer-menu__item-link">News</a></li><li class="tm-footer-menu__list-item"><a href="/en/hubs/" class="footer-menu__item-link">Hubs</a></li><li class="tm-footer-menu__list-item"><a href="/en/users/" class="footer-menu__item-link">Authors</a></li><li class="tm-footer-menu__list-item"><a href="/en/sandbox/" class="footer-menu__item-link">Sandbox</a></li><!--]--></ul></div></div><div class="tm-footer-menu__block"><p class="tm-footer-menu__block-title">Information</p><div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><!--[--><li class="tm-footer-menu__list-item"><a href="/en/docs/help/" class="footer-menu__item-link">How it works</a></li><li class="tm-footer-menu__list-item"><a href="/en/docs/authors/codex/" class="footer-menu__item-link">For authors</a></li><li class="tm-footer-menu__list-item"><a href="/en/docs/companies/corpblogs/" class="footer-menu__item-link">For companies</a></li><li class="tm-footer-menu__list-item"><a href="/en/docs/docs/transparency/" class="footer-menu__item-link">Documents</a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement/?hl=en_US" target="_blank">Agreement</a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/?hl=en_US" target="_blank">Confidential</a></li><!--]--></ul></div></div><div class="tm-footer-menu__block"><p class="tm-footer-menu__block-title">Services</p><div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><!--[--><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/en/corporate-blogs/" target="_blank">Corporate blogs</a></li><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/en/advertising/" target="_blank">Advertising</a></li><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/en/native-special/" target="_blank">Native advertising</a></li><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/en/education-programs/" target="_blank">Education programs</a></li><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/en/hello-startup/" target="_blank">Startups</a></li><!--]--></ul></div></div><!--]--></div><!--]--></div></div><div class="tm-footer"><div class="tm-page-width"><!--[--><div class="tm-footer__container"><!----><div class="tm-footer__social"><!--[--><a class="tm-svg-icon__wrapper tm-social-icons__icon" href="https://www.facebook.com/habr.eng" rel="nofollow noopener noreferrer" target="_blank"><svg class="tm-svg-img tm-svg-icon" height="24" width="24"><title>Facebook</title><use xlink:href="/img/new-social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a class="tm-svg-icon__wrapper tm-social-icons__icon" href="https://twitter.com/habr_eng" rel="nofollow noopener noreferrer" target="_blank"><svg class="tm-svg-img tm-svg-icon" height="24" width="24"><title>Twitter</title><use xlink:href="/img/new-social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a class="tm-svg-icon__wrapper tm-social-icons__icon" href="https://t.me/habr_eng" rel="nofollow noopener noreferrer" target="_blank"><svg class="tm-svg-img tm-svg-icon" height="24" width="24"><title>Telegram</title><use xlink:href="/img/new-social-icons-sprite.svg#social-logo-telegram"></use></svg></a><!--]--></div><!--teleport start--><!--teleport end--><button class="tm-footer__link"><!----> Language settings</button><a href="/en/feedback/" class="tm-footer__link">Support</a><div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2025, </span><span class="tm-copyright__name"><a class="tm-copyright__link" href="https://company.habr.com/en/" rel="noopener" target="_blank">Habr</a></span></span></div></div><!--]--></div></div><!----><!--]--></div><!----></div><script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"486856":{"id":"486856","timePublished":"2020-02-04T13:48:41+00:00","isCorporative":false,"lang":"en","titleHtml":"Full disclosure: 0day vulnerability (backdoor) in firmware for Xiaongmai-based DVRs, NVRs and IP cameras","leadData":{"textHtml":"\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fr_\u002F3d\u002Fko\u002Fr_3dkof6_ydvswrt0m0pbe3pd4q.png\"\u003E\u003C\u002Fdiv\u003E\u003Cbr\u003E\r\nThis is a full disclosure of recent backdoor integrated into DVR\u002FNVR devices built on top of HiSilicon \u003Cabbr title=\"System on Chip\"\u003ESoC\u003C\u002Fabbr\u003E with Xiaongmai firmware. Described vulnerability allows attacker to gain root shell access and full control of device. Full disclosure format for this report has been chosen due to lack of trust to vendor. Proof of concept code is presented below.\u003Cbr\u003E","imageUrl":null,"buttonTextHtml":"Read more &rarr;","image":null},"editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"61749","alias":"YourChief","fullname":"Vladislav Yarmak","avatarUrl":null,"speciality":"11x engineer","scoreStats":{"score":124,"votesCount":292},"rating":24.1,"relatedData":null,"contacts":[{"title":"Twitter","url":"https:\u002F\u002Ftwitter.com\u002Fsnawoot","value":"snawoot","siteTitle":null,"favicon":null},{"title":"Github","url":"https:\u002F\u002Fgithub.com\u002FSnawoot\u002F","value":"Snawoot","siteTitle":null,"favicon":null},{"title":"Telegram","url":"https:\u002F\u002Ftelegram.me\u002FSnawoot","value":"Snawoot","siteTitle":null,"favicon":null}],"authorContacts":[{"title":"Twitter","url":"https:\u002F\u002Ftwitter.com\u002Fsnawoot","value":"snawoot","siteTitle":null,"favicon":null},{"title":"Github","url":"https:\u002F\u002Fgithub.com\u002FSnawoot\u002F","value":"Snawoot","siteTitle":null,"favicon":null},{"title":"Telegram","url":"https:\u002F\u002Ftelegram.me\u002FSnawoot","value":"Snawoot","siteTitle":null,"favicon":null}],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null},"donationsMethod":null,"isInBlacklist":null},"statistics":{"commentsCount":15,"favoritesCount":8,"readingCount":95519,"score":17,"votesCount":13,"votesCountPlus":12,"votesCountMinus":1},"hubs":[{"id":"6398","alias":"it-infrastructure","type":"collective","title":"IT Infrastructure","titleHtml":"IT Infrastructure","isProfiled":true,"relatedData":null},{"id":"21946","alias":"video_tech","type":"collective","title":"Video equipment","titleHtml":"Video equipment","isProfiled":false,"relatedData":null},{"id":"50","alias":"infosecurity","type":"collective","title":"Information Security","titleHtml":"Information Security","isProfiled":true,"relatedData":null},{"id":"118","alias":"crypto","type":"collective","title":"Cryptography","titleHtml":"Cryptography","isProfiled":true,"relatedData":null},{"id":"19011","alias":"reverse-engineering","type":"collective","title":"Reverse engineering","titleHtml":"Reverse engineering","isProfiled":true,"relatedData":null}],"flows":[{"id":"1","alias":"develop","title":"Development","titleHtml":"Development"},{"id":"6","alias":"admin","title":"Administrating","titleHtml":"Administrating"},{"id":"7","alias":"popsci","title":"PopSci","titleHtml":"PopSci"}],"relatedData":{"vote":null,"unreadCommentsCount":0,"bookmarked":false,"canComment":false,"canEdit":false,"canViewVotes":false,"votePlus":{"canVote":false,"isChargeEnough":false,"isKarmaEnough":false,"isVotingOver":true},"voteMinus":{"canVote":false,"isChargeEnough":false,"isKarmaEnough":false,"isVotingOver":true},"canModerateComments":false,"trackerSubscribed":false,"emailSubscribed":false},"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003E\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fwebt\u002Fr_\u002F3d\u002Fko\u002Fr_3dkof6_ydvswrt0m0pbe3pd4q.png\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fr_\u002F3d\u002Fko\u002Fr_3dkof6_ydvswrt0m0pbe3pd4q.png\"\u002F\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\nThis is a full disclosure of recent backdoor integrated into DVR\u002FNVR devices built on top of HiSilicon \u003Cabbr title=\"System on Chip\"\u003ESoC\u003C\u002Fabbr\u003E with Xiaongmai firmware. Described vulnerability allows attacker to gain root shell access and full control of device. Full disclosure format for this report has been chosen due to lack of trust to vendor. Proof of concept code is presented below.\u003Cbr\u002F\u003E\n\u003Ca name=\"habracut\"\u003E\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\n\u003Ch2\u003EPrevious work and historical context\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\nEarliest known versions of it had telnet access enabled with a static root password which can be recovered from firmware image with (relatively) little computation effort. This vulnerability was covered by \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F173501\u002F\"\u003Eprevious author's article (in Russian)\u003C\u002Fa\u003E in 2013. In 2017 Istvan Toth did a \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Ftothi\u002Fpwn-hisilicon-dvr\" rel=\"nofollow\"\u003Emost comprehensive analysis\u003C\u002Fa\u003E of DVR device's firmware. He also discovered remote code execution vulnerability in the built-in webserver and many other vulnerabilities. It's worth noting that disclosure was ignored by vendor.\u003Cbr\u002F\u003E\n\u003Cbr\u002F\u003E\nMore recent firmware versions had telnet access and debug port (9527\u002Ftcp) disabled by default. Instead they had open port 9530\u002Ftcp which was used to accept special command to start telnet daemon and enable shell access with static password which is the same for all devices. Such case was covered by these articles:\u003Cbr\u002F\u003E\n\u003Cbr\u002F\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca href=\"https:\u002F\u002Fwww.cnblogs.com\u002Fmmseh\u002Fp\u002F6537924.html\" rel=\"nofollow\"\u003Ehttps:\u002F\u002Fwww.cnblogs.com\u002Fmmseh\u002Fp\u002F6537924.html\u003C\u002Fa\u003E, 2017 (in Chinese)\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F332526\u002F\"\u003Ehttps:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F332526\u002F\u003C\u002Fa\u003E, 2017 (in Russian, by Habr user \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fusers\u002Fcentalt\u002F\" class=\"user_link\"\u003ECentALT\u003C\u002Fa\u003E)\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\nMost recent firmware versions have open port 9530\u002Ftcp listening for special commands, but require cryptographic challenge-response authentication for them to be committed. This is a subject of actual disclosure.\u003Cbr\u002F\u003E\n\u003Cbr\u002F\u003E\n\u003Ch2\u003ETechnical details\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\nVulnerable DVR\u002FNVR\u002FIP camera devices under discussion are running Linux with minimal set of utilities provided by \u003Ca href=\"https:\u002F\u002Fwww.busybox.net\u002F\" rel=\"nofollow\"\u003Ebusybox\u003C\u002Fa\u003E, main video application \u003Ccode\u003ESofia\u003C\u002Fcode\u003E and a small set of custom auxilary utilities responsible for support of device operation. Hardware has ARM-based CPU tens to hundreds megabytes of RAM.\u003Cbr\u002F\u003E\n\u003Cbr\u002F\u003E\nDevice with vulnerable firmware has \u003Ccode\u003EmacGuarder\u003C\u002Fcode\u003E or \u003Ccode\u003EdvrHelper\u003C\u002Fcode\u003E process running and accepting connections on TCP port 9530. Code and log strings suggest that \u003Ccode\u003EmacGuarder\u003C\u002Fcode\u003E formerly was a separate process, but later it's functions were merged into \u003Ccode\u003EdvrHelper\u003C\u002Fcode\u003E process as a separate thread.\u003Cbr\u002F\u003E\n\u003Cbr\u002F\u003E\nIt's worth noting that earlier versions of firmware had dvrHelper process compiled into busybox as additional applet. Taking into account busybox has GNU GPL license, it is possible that license violation takes place because dvrHelper software was distributed without source code.\u003Cbr\u002F\u003E\n\u003Cbr\u002F\u003E\nSuccessful backdoor activation process is following:\u003Cbr\u002F\u003E\n\u003Cbr\u002F\u003E\n\u003Col\u003E\n\u003Cli\u003EClient opens connection to port TCP port 9530 of device and sends string \u003Ccode\u003EOpenTelnet:OpenOnce\u003C\u002Fcode\u003E prepended with byte indicating total message length. This step is last for previous versions of backdoor. Probably telnetd was already started if there no response after this step.\u003C\u002Fli\u003E\n\u003Cli\u003EServer (device) anwers with string \u003Ccode\u003ErandNum:XXXXXXXX\u003C\u002Fcode\u003E where \u003Ccode\u003EXXXXXXXX\u003C\u002Fcode\u003E is 8-digit random decimal number.\u003C\u002Fli\u003E\n\u003Cli\u003EClient uses it's pre-shared key and constructs encryption key as concatenation of received random number and PSK.\u003C\u002Fli\u003E\n\u003Cli\u003EClient encrypts random number with encryption key and sends it after string \u003Ccode\u003ErandNum:\u003C\u002Fcode\u003E. Entire message is prepended with byte indicating total length of message.\u003C\u002Fli\u003E\n\u003Cli\u003EServer loads same pre-shared key from file \u003Ccode\u003E\u002Fmnt\u002Fcustom\u002FTelnetOEMPasswd\u003C\u002Fcode\u003E or uses default key \u003Ccode\u003E2wj9fsa2\u003C\u002Fcode\u003E if file is missing.\u003C\u002Fli\u003E\n\u003Cli\u003EServer performs encryption of random number and verifies result is identical with string from client. On success server sends string \u003Ccode\u003Everify:OK\u003C\u002Fcode\u003E or \u003Ccode\u003Everify:ERROR\u003C\u002Fcode\u003E otherwise.\u003C\u002Fli\u003E\n\u003Cli\u003EClient encrypts string \u003Ccode\u003ETelnet:OpenOnce\u003C\u002Fcode\u003E, prepends it with total length byte, \u003Ccode\u003ECMD:\u003C\u002Fcode\u003E string and sends to server.\u003C\u002Fli\u003E\n\u003Cli\u003EServer extracts and decryptes received command. If decryption result is equal to string \u003Ccode\u003ETelnet:OpenOnce\u003C\u002Fcode\u003E it responds with \u003Ccode\u003EOpen:OK\u003C\u002Fcode\u003E, enables debug port 9527 and starts telnet daemon.\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\u003Cbr\u002F\u003E\nEntire authentication process may resemble some sort of HMAC challenge-response authentication except it uses symmetric cipher instead of hash. This particular symmetric cipher resembles some variation of 3DES-EDE2 for keys longer than 8 bytes and similar to simple DES for shorter keys.\u003Cbr\u002F\u003E\n\u003Cbr\u002F\u003E\nIt's easy to see that all clients need for successful authentication is knowledge of PSK (which is common and can be retrieved from firmware in plaintext) and implementation of that symmetric block cipher. Recovery of that symmetric cipher implementation is most difficult, but it was achieved during this research. Exploration and tests were conducted using this set of tools:\u003Cbr\u002F\u003E\n\u003Cbr\u002F\u003E\n\u003Cul\u003E\n\u003Cli\u003EGhidra 9.1.1 from NSA (\u003Ca href=\"https:\u002F\u002Fghidra-sre.org\u002F\" rel=\"nofollow\"\u003Ehttps:\u002F\u002Fghidra-sre.org\u002F\u003C\u002Fa\u003E) — suite for binary executeble code inspection.\u003C\u002Fli\u003E\n\u003Cli\u003EQEMU (more specifically qemu-user in Debian chroot — \u003Ca href=\"https:\u002F\u002Fwww.qemu.org\u002F\" rel=\"nofollow\"\u003Ehttps:\u002F\u002Fwww.qemu.org\u002F\u003C\u002Fa\u003E) — software which allows foreign architecture binaries (ARM) to be executed transparently on host.\u003C\u002Fli\u003E\n\u003Cli\u003ECommon GNU utilities and toolchain.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\nOnce telnet daemon activated, it's very likely it will accept one of following login\u002Fpassword pairs:\u003Cbr\u002F\u003E\n\u003Cdiv class=\"scrollable-table\"\u003E\u003Ctable\u003E\n\u003Ctr\u003E\n\u003Cth\u003ELogin\u003C\u002Fth\u003E\n\u003Cth\u003EPassword\u003C\u002Fth\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd\u003E\u003Ccode\u003Eroot\u003C\u002Fcode\u003E\u003C\u002Ftd\u003E\n\u003Ctd\u003E\u003Ccode\u003Exmhdipc\u003C\u002Fcode\u003E\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd\u003E\u003Ccode\u003Eroot\u003C\u002Fcode\u003E\u003C\u002Ftd\u003E\n\u003Ctd\u003E\u003Ccode\u003Eklv123\u003C\u002Fcode\u003E\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd\u003E\u003Ccode\u003Eroot\u003C\u002Fcode\u003E\u003C\u002Ftd\u003E\n\u003Ctd\u003E\u003Ccode\u003Exc3511\u003C\u002Fcode\u003E\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd\u003E\u003Ccode\u003Eroot\u003C\u002Fcode\u003E\u003C\u002Ftd\u003E\n\u003Ctd\u003E\u003Ccode\u003E123456\u003C\u002Fcode\u003E\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd\u003E\u003Ccode\u003Eroot\u003C\u002Fcode\u003E\u003C\u002Ftd\u003E\n\u003Ctd\u003E\u003Ccode\u003Ejvbzd\u003C\u002Fcode\u003E\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd\u003E\u003Ccode\u003Eroot\u003C\u002Fcode\u003E\u003C\u002Ftd\u003E\n\u003Ctd\u003E\u003Ccode\u003Ehi3518\u003C\u002Fcode\u003E\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003C\u002Ftable\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\nThese passwords can be recovered from firmware as well by bruteforce of hash in \u003Ccode\u003E\u002Fetc\u002Fpasswd\u003C\u002Fcode\u003E file. Modern consumer-grade GPGPU with \u003Ca href=\"https:\u002F\u002Fhashcat.net\u002Fhashcat\u002F\" rel=\"nofollow\"\u003Ehashcat\u003C\u002Fa\u003E is capable to find pre-image for hash in a matter of hours.\u003Cbr\u002F\u003E\n\u003Cbr\u002F\u003E\nDebug port 9527 accepts same login\u002Fpassword as Web UI and it also provides some shell access and functions to control the device. Speaking of Web UI accounts, attacker may reset password or grab password hashes from \u003Ccode\u003E\u002Fmnt\u002Fmtd\u002FConfig\u002FAccount*\u003C\u002Fcode\u003E files. Hash function was \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Ftothi\u002Fpwn-hisilicon-dvr#password-hash-function\" rel=\"nofollow\"\u003Edescribed in previous research\u003C\u002Fa\u003E by Istvan Toth.\u003Cbr\u002F\u003E\n\u003Cbr\u002F\u003E\n\u003Ch2\u003EAffected devices\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\nPrevious research has a good collection of brands affected: \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Ftothi\u002Fpwn-hisilicon-dvr#summary\" rel=\"nofollow\"\u003Ehttps:\u002F\u002Fgithub.com\u002Ftothi\u002Fpwn-hisilicon-dvr#summary\u003C\u002Fa\u003E. There are dozens of brands and hundreds of models.\u003Cbr\u002F\u003E\n\u003Cbr\u002F\u003E\nAuthor of this report, reposing on survey across population of random IP addresses, estimates total number of vulnerable devices exposed via Internet somewhere between hundreds of thousands and millions.\u003Cbr\u002F\u003E\n\u003Cbr\u002F\u003E\nProbably, the easiest way to check whether your device is vulnerable is PoC code provided below.\u003Cbr\u002F\u003E\n\u003Cbr\u002F\u003E\n\u003Ch2\u003ETesting vulnerability\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\nPoC code: \u003Ca href=\"https:\u002F\u002Fgithub.com\u002FSnawoot\u002Fhisilicon-dvr-telnet\" rel=\"nofollow\"\u003Ehttps:\u002F\u002Fgithub.com\u002FSnawoot\u002Fhisilicon-dvr-telnet\u003C\u002Fa\u003E.\u003Cbr\u002F\u003E\n\u003Cbr\u002F\u003E\nBuilding PoC program from source: run \u003Ccode\u003Emake\u003C\u002Fcode\u003E in source directory.\u003Cbr\u002F\u003E\n\u003Cbr\u002F\u003E\nUsage: \u003Ccode\u003E.\u002Fhs-dvr-telnet HOST PSK\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E\n\u003Cbr\u002F\u003E\nMost common PSK is default one: \u003Ccode\u003E2wj9fsa2\u003C\u002Fcode\u003E.\u003Cbr\u002F\u003E\n\u003Cbr\u002F\u003E\nExample session:\u003Cbr\u002F\u003E\n\u003Cbr\u002F\u003E\n\u003Cpre\u003E\n$ telnet 198.51.100.23\nTrying 198.51.100.23...\ntelnet: Unable to connect to remote host: Connection refused\n$ .\u002Fhs-dvr-telnet 198.51.100.23 2wj9fsa2\nSent OpenTelnet:OpenOnce command.\nrandNum:46930886\nchallenge=469308862wj9fsa2\nverify:OK\nOpen:OK\n$ telnet 198.51.100.23\nTrying 198.51.100.23...\nConnected to 198.51.100.23.\nEscape character is '^]'.\nLocalHost login: root\nPassword: \n\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\n\u003Cbr\u002F\u003E\nIP address in example above is an IP address from address block reserved for documentation by RFC5737.\u003Cbr\u002F\u003E\n\u003Cbr\u002F\u003E\nDevice should be considered vulnerable if:\u003Cbr\u002F\u003E\n\u003Cbr\u002F\u003E\n\u003Cul\u003E\n\u003Cli\u003ETelnet port opens after \u003Ccode\u003Ehs-dvr-telnet\u003C\u002Fcode\u003E run.\u003C\u002Fli\u003E\n\u003Cli\u003EDevice responds with challenge on \u003Ccode\u003Ehs-dvr-telnet\u003C\u002Fcode\u003E inquiry. Even if verification fails due to wrong PSK, there exists correct PSK extractable from firmware.\u003C\u002Fli\u003E\n\u003Cli\u003Ehs-dvr-telnet stucks awaiting for response, but telnet port opens (this will happen with older firmware versions which require only \u003Ccode\u003EOpenTelnet:OpenOnce\u003C\u002Fcode\u003E command).\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\n\u003Ch2\u003EMitigation\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\nTaking into account earlier bogus fixes for that vulnerability (backdoor, actually) it is not practical to expect security fixes for firmware from vendor. Owners of such devices should consider switching to alternatives.\u003Cbr\u002F\u003E\n\u003Cbr\u002F\u003E\nHowever, if replacement is not possible, device owners should completely restrict network access to these devices to trusted users. Ports involved in this vulnerability is 23\u002Ftcp, 9530\u002Ftcp, 9527\u002Ftcp, but earlier researches indicate there is no confidence other services implementation is solid and doesn't contain \u003Cabbr title=\"Remote Code Execution\"\u003ERCE\u003C\u002Fabbr\u003E vulnerabilities.\u003Cbr\u002F\u003E\n\u003Cbr\u002F\u003E\n\u003Ch2\u003ESubjects not covered by this research\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\nCode analysis revealed that authentication procedure on port 9530 decrypts «CMD» payload with arbitrary size (up to size of buffer read from socket at once) into a buffer on stack with fixed size of 32 bytes. Targeted exploitation of this overflow requires knowledge of PSK, therefore it's more practical to proceed normal way to gain access. On the other hand, garbage sent with CMD command may cause stack corruption and dvrHelper daemon failure. Possible effects of that (potential) failure wasn't explored because macGuarder\u002FdvrHelper backdoor functionality appears strictly superior and straightforward approach.\u003Cbr\u002F\u003E\n\u003Cbr\u002F\u003E\n\u003Cb\u003EUPDATE\u003C\u002Fb\u003E (2020-02-05 02:10+00:00): Istvan Toth, author of \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Ftothi\u002Fpwn-hisilicon-dvr\" rel=\"nofollow\"\u003Eprevious research\u003C\u002Fa\u003E on this subject, presented his own implementation of PoC program: \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Ftothi\u002Fhs-dvr-telnet\" rel=\"nofollow\"\u003Ehttps:\u002F\u002Fgithub.com\u002Ftothi\u002Fhs-dvr-telnet\u003C\u002Fa\u003E Given implementation is written in pure Python code and implements symmetric cipher in more clear way. Also it outlines differences between 3DES cipher variant used by Xiongmai for backdoor authentication and original 3DES cipher. These differences can be expressed by this git commit: \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Ftothi\u002FpyDes\u002Fcommit\u002F7a26fe09dc5b57b175c6439fbbf496414598a7a2\" rel=\"nofollow\"\u003Ehttps:\u002F\u002Fgithub.com\u002Ftothi\u002FpyDes\u002Fcommit\u002F7a26fe09dc5b57b175c6439fbbf496414598a7a2\u003C\u002Fa\u003E.\u003Cbr\u002F\u003E\n\u003Cbr\u002F\u003E\n\u003Cb\u003EUPDATE\u003C\u002Fb\u003E (2020-02-05 17:28+00:00): Other researchers and habr users had pointed out such vulnerability is restricted to devices based on Xiongmai (Hangzhou Xiongmai Technology Co, XMtech) software, including products of other vendors which ship products based on such software. At this moment HiSilicon can't be held responsible for backdoor in dvrHelper\u002FmacGuarder binary.\u003Cbr\u002F\u003E\n\u003Cbr\u002F\u003E\n\u003Cb\u003EUPDATE\u003C\u002Fb\u003E (2020-02-21 10:30+00:00): Xiaongmai acknowledged vulnerability and released a Security Advisory: \u003Ca href=\"http:\u002F\u002Fwww.xiongmaitech.com\u002Fen\u002Findex.php\u002Fnews\u002Finfo\u002F12\u002F68\" rel=\"nofollow\"\u003Elink\u003C\u002Fa\u003E, \u003Ca href=\"http:\u002F\u002Fweb.archive.org\u002Fweb\u002F20200221103130\u002Fhttp:\u002F\u002Fwww.xiongmaitech.com\u002Fen\u002Findex.php\u002Fnews\u002Finfo\u002F12\u002F68\" rel=\"nofollow\"\u003Earchive 1\u003C\u002Fa\u003E, \u003Ca href=\"https:\u002F\u002Farchive.fo\u002FfoJ47\" rel=\"nofollow\"\u003Earchive 2\u003C\u002Fa\u003E. Body of actual article has been updated accordingly in order to reflect origin of vulnerability properly.\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"hisilicon"},{"titleHtml":"dvr"},{"titleHtml":"nvr"},{"titleHtml":"ip camera"},{"titleHtml":"vulnerability"},{"titleHtml":"0day"},{"titleHtml":"0day-vulnerability"},{"titleHtml":"backdoor"},{"titleHtml":"telnet"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fr_\u002F3d\u002Fko\u002Fr_3dkof6_ydvswrt0m0pbe3pd4q.png","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fr_\u002F3d\u002Fko\u002Fr_3dkof6_ydvswrt0m0pbe3pd4q.png","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fen\\\u002Farticles\\\u002F486856\\\u002F\"},\"headline\":\"Full disclosure: 0day vulnerability (backdoor) in firmware for Xiaongmai-based DVRs, NVRs and IP cameras\",\"datePublished\":\"2020-02-04T16:48:41+03:00\",\"dateModified\":\"2020-02-21T13:44:26+03:00\",\"author\":{\"@type\":\"Person\",\"name\":\"Vladislav Yarmak\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"This is a full disclosure of recent backdoor integrated into DVR\\\u002FNVR devices built on top of HiSilicon SoC with Xiaongmai firmware. Described vulnerability...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fen\\\u002Farticles\\\u002F486856\\\u002F#post-content-body\",\"about\":[\"h_it-infrastructure\",\"h_video_tech\",\"h_infosecurity\",\"h_crypto\",\"h_reverse-engineering\",\"f_develop\",\"f_admin\",\"f_popsci\"],\"image\":[\"https:\\\u002F\\\u002Fhabr.com\\\u002Fshare\\\u002Fpublication\\\u002F486856\\\u002Fa9371801a5731c7ab88d874f195f2675\\\u002F\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fr_\\\u002F3d\\\u002Fko\\\u002Fr_3dkof6_ydvswrt0m0pbe3pd4q.png\"]}","metaDescription":"This is a full disclosure of recent backdoor integrated into DVR\u002FNVR devices built on top of HiSilicon SoC with Xiaongmai firmware. Described vulnerability allows attacker to gain root shell access...","mainImageUrl":null,"amp":false,"customTrackerLinks":[]},"polls":[],"commentsEnabled":{"status":true,"reason":null},"rulesRemindEnabled":false,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"hasPinnedComments":false,"format":null,"banner":null,"multiwidget":null,"multiwidgetUuid":null,"readingTime":6,"complexity":null,"isEditorial":false}},"articlesIds":{},"isLoading":false,"pagesCount":{},"route":{},"reasonsList":null,"postReasonsList":null,"view":"cards","lastVisitedRoute":{},"ssrCommentsArticleIds":[""],"viewedPosts":[],"myFeedFilter":{"complexity":"all","score":"all","types":["articles","posts","news"]},"myFeedIsApplyFilters":false,"myFeedIsForce":false,"karma":{"userReasonsList":null}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"career":{"seoLandings":[],"hubs":""},"comments":{"articleComments":{},"articlePinnedComments":{},"searchCommentsResults":null,"pagesCount":null,"commentAccess":{},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":"","moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"multiwidgets":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"multiwidgetLoading":false,"vacancies":{},"companiesGalleries":{},"companiesBanners":{},"companiesLandingVacancies":{},"companiesTechnologies":{},"workplaceInfo":null},"companyAdmin":{"companyInfo":null,"companyInfoLoading":false,"faqArticles":null,"brandingPreviewImageUrl":null,"jivoStatus":0,"adminNotifications":null},"companyAdd":{"currentStep":"","stepsData":{},"uncompletedSteps":[],"isStepLoading":true,"isStepCommitting":false,"isInitialized":false,"agreementContent":""},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"pagesCount":0},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":true},"fixedBanner":{"isArticleStickyPanelVisible":false,"isArticleStickyPanelAtTheBottom":false,"isFixedBannerVisible":false,"isStickyPanelIconsHidden":false},"flows":{"flows":[{"alias":"develop","id":"1","route":{"name":"FLOW_PAGE","params":{"flowName":"develop","hl":"en"}}},{"alias":"admin","id":"6","route":{"name":"FLOW_PAGE","params":{"flowName":"admin","hl":"en"}}},{"alias":"design","id":"2","route":{"name":"FLOW_PAGE","params":{"flowName":"design","hl":"en"}}},{"alias":"management","id":"3","route":{"name":"FLOW_PAGE","params":{"flowName":"management","hl":"en"}}},{"alias":"marketing","id":"4","route":{"name":"FLOW_PAGE","params":{"flowName":"marketing","hl":"en"}}},{"alias":"popsci","id":"7","route":{"name":"FLOW_PAGE","params":{"flowName":"popsci","hl":"en"}}}],"updates":{}},"global":{"isPwa":false,"device":"desktop","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"en","hl":"en"},"info":{"welcomePage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"query":{},"pathname":"\u002Fen\u002Farticles\u002F486856\u002F","path":"\u002Fen\u002Farticles\u002F486856\u002F","href":"\u002Fen\u002Farticles\u002F486856\u002F"}},"me":{"user":null,"uuid":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null,"userUpdates":{"feeds":{"newPostsCount":null,"newThreadsCount":null,"newNewsCount":null,"newCount":null},"conversationUnreadCount":0}},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"onboarding":{"currentStep":null,"stepsData":{},"stepsErrors":{},"completedSteps":[],"isStepCommitting":false,"isCommitDisabled":true},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{"questions":"project-block-article"}},"promoData":{"isLoading":false,"hasLoaded":false,"featurer":null,"megaposts":null,"promoLinks":null,"promoPosts":null,"sticker":null},"publicationStatistics":{"statsInfo":{},"statsFunnels":{},"statsGraph":{},"defaultSuggest":{},"suggest":{},"timeTracker":{},"isTrackingActivity":false,"isUserActive":true},"pullRefresh":{"shouldRefresh":false},"reactions":{"reactionCounters":{"486856":{"publicationId":"486856","reactions":[],"totalCount":0}},"reactionPacks":[{"id":"2","customer":{"id":"1","title":"K2 Cloud","url":"https:\u002F\u002Fu.habr.com\u002Fk2cloud_mod1\u002F?erid=2VSb5xuLB12","logoUrl":"\u002Fimg\u002Fsponsors\u002Fk2Cloud.svg"},"title":"K2 Cloud","isAds":true,"isActive":true,"relatedData":{"isAllowed":false},"reactions":[{"id":"6","title":"Cool!","imageUrl":"\u002Fimg\u002Freactions\u002Fsunglasses.lottie","isActive":true},{"id":"7","title":"?","imageUrl":"\u002Fimg\u002Freactions\u002Fthinking_face.lottie","isActive":true},{"id":"8","title":"Fire","imageUrl":"\u002Fimg\u002Freactions\u002Ffire.lottie","isActive":true},{"id":"9","title":"Strongly!","imageUrl":"\u002Fimg\u002Freactions\u002Fmuscle.lottie","isActive":true},{"id":"10","title":"Melting","imageUrl":"\u002Fimg\u002Freactions\u002Fmelting_face.lottie","isActive":true}]},{"id":"1","customer":null,"title":"Default","isAds":false,"isActive":true,"relatedData":{"isAllowed":true},"reactions":[{"id":"1","title":"Like","imageUrl":"\u002Fimg\u002Freactions\u002Fheart_eyes.lottie","isActive":true},{"id":"2","title":"Joy","imageUrl":"\u002Fimg\u002Freactions\u002Fjoy.lottie","isActive":true},{"id":"3","title":"Wow!","imageUrl":"\u002Fimg\u002Freactions\u002Fopen_mouth.lottie","isActive":true},{"id":"4","title":"Cry","imageUrl":"\u002Fimg\u002Freactions\u002Fcry.lottie","isActive":true},{"id":"5","title":"Dislike","imageUrl":"\u002Fimg\u002Freactions\u002Fface_with_symbols_on_mouth.lottie","isActive":true}]}],"isReactionPacksLoading":false,"reactionsData":{},"reactionDataLoading":{}},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"search":{"searchQueryError":null},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":[],"similarListRefs":null},"ssr":{"error":null,"isDataLoaded":true,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"stories":{"stories":[]},"technotext":{"years":[],"technotextDocForNominees":null,"technotextDocForWinners":null,"technotextInfo":{},"technotextInfoLoading":false,"technotextWinners":{},"technotextWinnersLoading":false},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"userVotes":{"karmaVotesList":[],"karmaVotesPagesCount":null,"karmaVotesListLoading":false,"commentsVotesList":[],"commentsVotesPagesCount":null,"commentsVotesListLoading":false,"postsVotesList":[],"postsVotesPagesCount":null,"postsVotesListLoading":false,"userVotesList":[],"userVotesPagesCount":null,"userVotesListLoading":false},"users":{"authorRefs":{},"authorIds":{},"pagesCount":{},"authorProfiles":{},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"userSpecialization":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"notificationsLoading":false,"notificationsList":[],"notificationsPageCount":0,"pendingMarkNotificationsRead":[],"publicationsLoading":true,"publicationsList":[],"publicationsPageCount":0,"pendingDeletePublications":false,"pendingMarkPublicationsRead":false},"events":{"eventRefs":{},"eventIds":[],"pagesCount":0,"categories":[],"cities":[],"actualEvents":null,"currentEvent":null,"eventsFilter":{"city":"all","timeStarted":null,"timeEnded":null}},"wysiwyg":{"WYSIWYGRulesRefs":null}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="https://assets.habr.com/habr-web/js/chunk-vendors.da7fa5db.js" defer></script><script src="https://assets.habr.com/habr-web/js/app.717c3c23.js" defer></script></div>
    <div id="overlays"><!----><!--teleport anchor--><!----><!--teleport anchor--><!----><!--teleport anchor--><!----><!--teleport anchor--><!----><!--teleport anchor--><!----><!--teleport anchor--></div>
    
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-S28W1WC23F"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
    </script>
  
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

  </script>
  <noscript>
    <div>
      <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt="" />
    </div>
  </noscript>
    <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script>
  
    </body>

    </html>
