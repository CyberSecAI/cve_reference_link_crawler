=== Content from github.com_7a54513c_20250108_121735.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftothi%2Fhs-dvr-telnet)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftothi%2Fhs-dvr-telnet)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=tothi%2Fhs-dvr-telnet)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[tothi](/tothi)
/
**[hs-dvr-telnet](/tothi/hs-dvr-telnet)**
Public

* [Notifications](/login?return_to=%2Ftothi%2Fhs-dvr-telnet) You must be signed in to change notification settings
* [Fork
  24](/login?return_to=%2Ftothi%2Fhs-dvr-telnet)
* [Star
   52](/login?return_to=%2Ftothi%2Fhs-dvr-telnet)

open telnet port on modern HiSilicon devices

[52
stars](/tothi/hs-dvr-telnet/stargazers) [24
forks](/tothi/hs-dvr-telnet/forks) [Branches](/tothi/hs-dvr-telnet/branches) [Tags](/tothi/hs-dvr-telnet/tags) [Activity](/tothi/hs-dvr-telnet/activity)
 [Star](/login?return_to=%2Ftothi%2Fhs-dvr-telnet)

 [Notifications](/login?return_to=%2Ftothi%2Fhs-dvr-telnet) You must be signed in to change notification settings

* [Code](/tothi/hs-dvr-telnet)
* [Issues
  2](/tothi/hs-dvr-telnet/issues)
* [Pull requests
  0](/tothi/hs-dvr-telnet/pulls)
* [Actions](/tothi/hs-dvr-telnet/actions)
* [Projects
  0](/tothi/hs-dvr-telnet/projects)
* [Security](/tothi/hs-dvr-telnet/security)
* [Insights](/tothi/hs-dvr-telnet/pulse)

Additional navigation options

* [Code](/tothi/hs-dvr-telnet)
* [Issues](/tothi/hs-dvr-telnet/issues)
* [Pull requests](/tothi/hs-dvr-telnet/pulls)
* [Actions](/tothi/hs-dvr-telnet/actions)
* [Projects](/tothi/hs-dvr-telnet/projects)
* [Security](/tothi/hs-dvr-telnet/security)
* [Insights](/tothi/hs-dvr-telnet/pulse)

# tothi/hs-dvr-telnet

    master[Branches](/tothi/hs-dvr-telnet/branches)[Tags](/tothi/hs-dvr-telnet/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[4 Commits](/tothi/hs-dvr-telnet/commits/master/) | | |
| [README.md](/tothi/hs-dvr-telnet/blob/master/README.md "README.md") | | [README.md](/tothi/hs-dvr-telnet/blob/master/README.md "README.md") |  |  |
| [hs-dvr-telnet.py](/tothi/hs-dvr-telnet/blob/master/hs-dvr-telnet.py "hs-dvr-telnet.py") | | [hs-dvr-telnet.py](/tothi/hs-dvr-telnet/blob/master/hs-dvr-telnet.py "hs-dvr-telnet.py") |  |  |
| [requirements.txt](/tothi/hs-dvr-telnet/blob/master/requirements.txt "requirements.txt") | | [requirements.txt](/tothi/hs-dvr-telnet/blob/master/requirements.txt "requirements.txt") |  |  |
| View all files | | |

## Repository files navigation

* README
# hs-dvr-telnet.py

Python implementation using a
[slightly modified 3DES algorithm](https://github.com/tothi/pyDes)
for opening telnet interface on HiSilicon DVR devices with
advanced (encrypted) command parser.

Co-work with [Vladislav Yarmak](https://github.com/Snawoot)
([@snawoot](https://twitter.com/%40snawoot)).

Detailed analysis of this 0day backdoor by Vladislav is here:

<https://habr.com/en/post/486856/>

Recommended usage of this PoC:

```
git clone https://github.com/tothi/hs-dvr-telnet
cd hs-dvr-telnet
python -m venv venv
. ./venv/bin/activate
pip install -r requirements.txt
./hs-dvr-telnet.py
```

### vendor(?) reply

Huawei/HiSilicon released a "this is not ours"
[Security Notice](https://www.huawei.com/en/psirt/security-notices/2020/huawei-sn-20200205-01-hisilicon-en) about the backdoor.

At the moment, it seems the affected part of the firmware is
related to an OEM vendor (what is most likely
[Hangzhou Xiongmai Technology](http://www.xiongmaitech.com/en/index.php/product)).

## About

open telnet port on modern HiSilicon devices

### Resources

[Readme](#readme-ov-file)

[Activity](/tothi/hs-dvr-telnet/activity)
### Stars

[**52**
stars](/tothi/hs-dvr-telnet/stargazers)
### Watchers

[**7**
watching](/tothi/hs-dvr-telnet/watchers)
### Forks

[**24**
forks](/tothi/hs-dvr-telnet/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Ftothi%2Fhs-dvr-telnet&report=tothi+%28user%29)

## [Releases](/tothi/hs-dvr-telnet/releases)

No releases published

## [Packages 0](/users/tothi/packages?repo_name=hs-dvr-telnet)

No packages published

## Languages

* [Python
  100.0%](/tothi/hs-dvr-telnet/search?l=python)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.xiongmaitech.com_8808dbc0_20250108_121737.html ===

[![](http://www.xiongmaitech.com/en/static/web/img/logo.png?v=v2 )](http://www.xiongmaitech.com/en/index.php%20 "Hangzhou Xiongmai Technology Co.,LTD.
")

![](http://www.xiongmaitech.com/en/static/web/img/a1.png?v=v2 )
[Chinese](http://www.xiongmaitech.com/)![](http://www.xiongmaitech.com/en/static/web/img/header_icon1.png?v=v2 )[English](http://www.xiongmaitech.com/en/index.php%20)

* [HOME](http://www.xiongmaitech.com/en/index.php%20)
* [PRODUCTS](http://www.xiongmaitech.com/en/index.php/product%20)
  + [![](http://www.xiongmaitech.com/en/upload/2017/10/23/15087412247455jlmvt.png )![](http://www.xiongmaitech.com/en/static/web/img/product_b01.png?v=v2 )

    IP Camera Module](http://www.xiongmaitech.com/en/index.php/product/product-list/3%20)
  + [![](http://www.xiongmaitech.com/en/upload/2019/05/15/1557888298587847pvr.png )![](http://www.xiongmaitech.com/en/static/web/img/product_b01.png?v=v2 )

    Intelligent analysis module](http://www.xiongmaitech.com/en/index.php/product/product-list/185%20)
  + [![](http://www.xiongmaitech.com/en/upload/2021/06/19/16240810509952yfl0a.png )![](http://www.xiongmaitech.com/en/static/web/img/product_b01.png?v=v2 )

    Battery Camera Module](http://www.xiongmaitech.com/en/index.php/product/product-list/204%20)
  + [![](http://www.xiongmaitech.com/en/upload/2017/10/23/15087392941506azt74.png )![](http://www.xiongmaitech.com/en/static/web/img/product_b01.png?v=v2 )

    consumer module](http://www.xiongmaitech.com/en/index.php/product/product-list/190%20)
  + ![](http://www.xiongmaitech.com/en/static/web/img/product_b02.png?v=v2 )
  + [![](http://www.xiongmaitech.com/en/upload/2017/10/23/15087412753986ljyj3.png )![](http://www.xiongmaitech.com/en/static/web/img/product_b01.png?v=v2 )

    Panoramic VR](http://www.xiongmaitech.com/en/index.php/product/product-list/172%20)
  + [![](http://www.xiongmaitech.com/en/upload/2017/11/09/15102078930744efb0i.png )![](http://www.xiongmaitech.com/en/static/web/img/product_b01.png?v=v2 )

    WiFi Kit](http://www.xiongmaitech.com/en/index.php/product/product-list/177%20)
  + [![](http://www.xiongmaitech.com/en/upload/2015/10/26/144584083955742fpgm.png )![](http://www.xiongmaitech.com/en/static/web/img/product_b01.png?v=v2 )

    AHD Camera Module](http://www.xiongmaitech.com/en/index.php/product/product-list/1%20)
  + [![](http://www.xiongmaitech.com/en/upload/2017/05/11/14944834256698fsklp.png )![](http://www.xiongmaitech.com/en/static/web/img/product_b01.png?v=v2 )

    XVI&AHD Hybrid Camera Module](http://www.xiongmaitech.com/en/index.php/product/product-list/181%20)
  + ![](http://www.xiongmaitech.com/en/static/web/img/product_b02.png?v=v2 )
  + [![](http://www.xiongmaitech.com/en/upload/2015/10/20/144531892030010qoj1.png )![](http://www.xiongmaitech.com/en/static/web/img/product_b01.png?v=v2 )

    AF module](http://www.xiongmaitech.com/en/index.php/product/product-list/27%20)
  + [![](http://www.xiongmaitech.com/en/upload/2015/10/20/1445318556687952ok6.png )![](http://www.xiongmaitech.com/en/static/web/img/product_b01.png?v=v2 )

    NVR Board](http://www.xiongmaitech.com/en/index.php/product/product-list/4%20)
  + [![](http://www.xiongmaitech.com/en/upload/2015/10/26/1445840475460779oy9.png )![](http://www.xiongmaitech.com/en/static/web/img/product_b01.png?v=v2 )

    XVI/AHD DVR Board](http://www.xiongmaitech.com/en/index.php/product/product-list/2%20)
  + [![](http://www.xiongmaitech.com/en/upload/2018/04/23/152447139279161uhsu.png )![](http://www.xiongmaitech.com/en/static/web/img/product_b01.png?v=v2 )

    H.265 XVI DVR Board](http://www.xiongmaitech.com/en/index.php/product/product-list/206%20)
  + ![](http://www.xiongmaitech.com/en/static/web/img/product_b02.png?v=v2 )
  + [![](http://www.xiongmaitech.com/en/upload/2023/03/10/16784322811668hc7nf.png )![](http://www.xiongmaitech.com/en/static/web/img/product_b01.png?v=v2 )

    Dual-lens Camera Module](http://www.xiongmaitech.com/en/index.php/product/product-list/230%20)
* [NEWS](http://www.xiongmaitech.com/en/index.php/news/10%20)
  + [Press Release](http://www.xiongmaitech.com/en/index.php/news/10)
  + [Industry Trends](http://www.xiongmaitech.com/en/index.php/news/11)
  + [Events](http://www.xiongmaitech.com/en/index.php/news/12)
  ![](http://www.xiongmaitech.com/en/upload/2015/10/22/14454925389598wuq96.png )

  [《Himalaya Ladder》 is coming, xiongmai is the sponsor of dream.](http://www.xiongmaitech.com/en/index.php/news/info/10/31)
* [SUPPORT](http://www.xiongmaitech.com/en/index.php/service/down/13%20)
  + [Download](http://www.xiongmaitech.com/en/index.php/service/down/13)
    [Equipment firmware](http://www.xiongmaitech.com/en/index.php/service/down/13)
  + [Cyber Security](http://www.xiongmaitech.com/en/index.php/service/security/51)
    [Security Circular](http://www.xiongmaitech.com/en/index.php/service/security/51)
    [Vulnerability Reporting](http://www.xiongmaitech.com/en/index.php/service/security/52)
  ![](http://www.xiongmaitech.com/en/upload/2015/11/25/14484454871433x989n.jpg )

  [We provide high quality product ,edge technology and excellent service.](http://www.xiongmaitech.com/en/index.php/service)
* [ABOUT US](http://www.xiongmaitech.com/en/index.php/about/company/18%20)
  + [Company profile](http://www.xiongmaitech.com/en/index.php/about/company/18)[Company](http://www.xiongmaitech.com/en/index.php/about/company/18)[Company culture](http://www.xiongmaitech.com/en/index.php/about/company/19)[Development course](http://www.xiongmaitech.com/en/index.php/about/company/20)

  + [Contact us](http://www.xiongmaitech.com/en/index.php/about/contact/42)
    [Headquarters](http://www.xiongmaitech.com/en/index.php/about/contact/42)
    [XM Shenzhen](http://www.xiongmaitech.com/en/index.php/about/contact/5)
  ![](http://www.xiongmaitech.com/en/upload/2015/12/22/14507656003149anbpb.jpg )

  [Hangzhou Xiongmai Technology Co.,Ltd concentrates on security surveillance ,Video intelligent research and development.](http://www.xiongmaitech.com/en/index.php/about/company/18)

![](http://www.xiongmaitech.com/en/upload/2015/09/16/144237473972lc6y2.jpg )

* [Press Release](http://www.xiongmaitech.com/en/index.php/news/10)
* [Industry Trends](http://www.xiongmaitech.com/en/index.php/news/11)
* [Events](http://www.xiongmaitech.com/en/index.php/news/12)

### Security Advisory – Vulnerability of some XM product before year 2017

##### 2020/ 02/ 20

SA Number: XM-SN-EA60F402001

Initial Release Date : 2020-02-20

# Summary

Some deivce have open Telent port 9530, for debugging and diagnosing and technical support for our customers, attacker could use this 9530 port as a vulnerability.

# Software Versions and Fixes

Please contact our Technical Support Engineer for those below model for fixes, and update your devices.

![blob.png](http://www.xiongmaitech.com/en/upload/at/image/20200220/1582194838919597ln9U.png "1582194838919597ln9U.png")

# Impact

1.High Vulnerability for H.264 devices which firmware released early than May 2017.

2.Low Vulnerability for H.265 devices which firmware released after than May 2017.

3.No risks for devices without open 9530 Telnet Port.

# Vulnerability Scoring Detials

The vulnerability classification has been performed by using the CVSSv3 scoring system

(http//www.first.org/cvss/specification-document)

Base Score::9.8(AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

Temporal Score: 9.1(E:F/RL:O/RC:C)

# Obtaining Fixed Software

Customers please contact our XM Technical Support Engineer to request the upgrades.

# Source

This vulnerability was disclosed by Resercher Mr. Vladislav Yarmak

Very appreciated for Mr. Vladislav Yarmak for helping us to disclose this vulnerability, and the positive communication and guide to us, discuss with us for risks of this vulnerability and solutions, even more practical security advices！His suggestions are helping us to strengthen our security levels of our products in present and in future!

Again thanks for the dedication of Mr. Vladislav Yarmak!

We also appreciated the support from Huawei PSIRT to participate as coordinator for the coordinated vulnerability disclosure.

# Revision Histroy

2020-2-20 V1.0 INITIAL

The previous：[Statement of the third party IPC connect NETIP protocol](http://www.xiongmaitech.com/en/index.php/news/info/12/70 "Statement of the third party IPC connect NETIP protocol")

The next：[Statement](http://www.xiongmaitech.com/en/index.php/news/info/12/67 "Statement")

[Return list](http://www.xiongmaitech.com/en/index.php/news/12)

* ![](http://www.xiongmaitech.com/en/static/web/img/foot_icon1.png?v=v2 )

  Tel： +86-0571-23271188
* ![](http://www.xiongmaitech.com/en/static/web/img/foot_icon2.png?v=v2 )

  Email： oversea\_sales@xiongmaitech.com
* ![](http://www.xiongmaitech.com/en/static/web/img/foot_icon4.png?v=v2 )

  Address： Building No.9, Yinhu Innovation Center, Hangzhou, China

* [Product](http://www.xiongmaitech.com/en/index.php/product%20)
  [IP Camera Module](http://www.xiongmaitech.com/en/index.php/product/product-list/3%20)
  [Intelligent analysis module](http://www.xiongmaitech.com/en/index.php/product/product-list/185%20)
  [Battery Camera Module](http://www.xiongmaitech.com/en/index.php/product/product-list/204%20)
  [consumer module](http://www.xiongmaitech.com/en/index.php/product/product-list/190%20)
  [Panoramic VR](http://www.xiongmaitech.com/en/index.php/product/product-list/172%20)
  [more](http://www.xiongmaitech.com/en/index.php/product%20)
* [News](http://www.xiongmaitech.com/en/index.php/news/10%20)
  [Press Release](http://www.xiongmaitech.com/en/index.php/news/10%20)
  [Industry Trends](http://www.xiongmaitech.com/en/index.php/news/11%20)
  [Events](http://www.xiongmaitech.com/en/index.php/news/12%20)
* [Support](http://www.xiongmaitech.com/en/index.php/service/down/13%20)[DOWNLOAD](http://www.xiongmaitech.com/en/index.php/service/down/13)
* [About us](http://www.xiongmaitech.com/en/index.php/about/company/18%20)[Company profile](http://www.xiongmaitech.com/en/index.php/about/company/18)[Contact us](http://www.xiongmaitech.com/en/index.php/about/contact/42)

[SiteMap](http://www.xiongmaitech.com/sitemap.xml)
丨
[Hangzhou Jufeng Technology](http://www.jufenginfo.com/)
丨
[HiSilicon (Shanghai) Technologies](http://www.hisilicon.com/)
丨
[NEXTCHIP](http://www.nextchip.com/)
丨
[TEXAS Instruments](http://www.ti.com/)
丨

[XM Cloud](http://www.xmeye.net/index)

COPYRIGHT © 2015 XM RIGHTS RESERVED
Zhejiang ICP No.10052164-1
[Website construction：](http://www.bocweb.cn/ "博采网络")
[Broadcull network](http://www.bocweb.cn/ "博采网络")

![](http://www.xiongmaitech.com/en/static/web/img/sd_1.png?v=v2 )[![]()](http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=33018302000328)



=== Content from habr.com_f61eb05b_20250108_121735.html ===

[Habr](/en/)β[How to become an author](/en/sandbox/start/)[My feed](/en/feed/)[All streams](/en/articles/)[Development](/en/flows/develop/)[Admin](/en/flows/admin/)[Design](/en/flows/design/)[Management](/en/flows/management/)[Marketing](/en/flows/marketing/)[PopSci](/en/flows/popsci/)[Search](/en/search/)Write a publicationSettings[Login](https://habr.com/kek/v1/auth/habrahabr/?back=/en/articles/486856/&hl=en)Pull to refresh[![](https://assets.habr.com/habr-web/img/avatars/111.png)](/en/users/YourChief/ "YourChief")[YourChief](/en/users/YourChief/)  Feb 4 2020 at 16:48
# Full disclosure: 0day vulnerability (backdoor) in firmware for Xiaongmai-based DVRs, NVRs and IP cameras

Reading time6 minViews96K[IT Infrastructure\*](/en/hubs/it-infrastructure/)[Video equipment](/en/hubs/video_tech/)[Information Security\*](/en/hubs/infosecurity/)[Cryptography\*](/en/hubs/crypto/)[Reverse engineering\*](/en/hubs/reverse-engineering/)![](https://habrastorage.org/r/w1560/webt/r_/3d/ko/r_3dkof6_ydvswrt0m0pbe3pd4q.png)

This is a full disclosure of recent backdoor integrated into DVR/NVR devices built on top of HiSilicon SoC with Xiaongmai firmware. Described vulnerability allows attacker to gain root shell access and full control of device. Full disclosure format for this report has been chosen due to lack of trust to vendor. Proof of concept code is presented below.

## Previous work and historical context

Earliest known versions of it had telnet access enabled with a static root password which can be recovered from firmware image with (relatively) little computation effort. This vulnerability was covered by [previous author's article (in Russian)](https://habr.com/ru/post/173501/) in 2013. In 2017 Istvan Toth did a [most comprehensive analysis](https://github.com/tothi/pwn-hisilicon-dvr) of DVR device's firmware. He also discovered remote code execution vulnerability in the built-in webserver and many other vulnerabilities. It's worth noting that disclosure was ignored by vendor.

More recent firmware versions had telnet access and debug port (9527/tcp) disabled by default. Instead they had open port 9530/tcp which was used to accept special command to start telnet daemon and enable shell access with static password which is the same for all devices. Such case was covered by these articles:

* <https://www.cnblogs.com/mmseh/p/6537924.html>, 2017 (in Chinese)
* <https://habr.com/ru/post/332526/>, 2017 (in Russian, by Habr user [CentALT](https://habr.com/ru/users/centalt/))

Most recent firmware versions have open port 9530/tcp listening for special commands, but require cryptographic challenge-response authentication for them to be committed. This is a subject of actual disclosure.

## Technical details

Vulnerable DVR/NVR/IP camera devices under discussion are running Linux with minimal set of utilities provided by [busybox](https://www.busybox.net/), main video application `Sofia` and a small set of custom auxilary utilities responsible for support of device operation. Hardware has ARM-based CPU tens to hundreds megabytes of RAM.

Device with vulnerable firmware has `macGuarder` or `dvrHelper` process running and accepting connections on TCP port 9530. Code and log strings suggest that `macGuarder` formerly was a separate process, but later it's functions were merged into `dvrHelper` process as a separate thread.

It's worth noting that earlier versions of firmware had dvrHelper process compiled into busybox as additional applet. Taking into account busybox has GNU GPL license, it is possible that license violation takes place because dvrHelper software was distributed without source code.

Successful backdoor activation process is following:

1. Client opens connection to port TCP port 9530 of device and sends string `OpenTelnet:OpenOnce` prepended with byte indicating total message length. This step is last for previous versions of backdoor. Probably telnetd was already started if there no response after this step.
2. Server (device) anwers with string `randNum:XXXXXXXX` where `XXXXXXXX` is 8-digit random decimal number.
3. Client uses it's pre-shared key and constructs encryption key as concatenation of received random number and PSK.
4. Client encrypts random number with encryption key and sends it after string `randNum:`. Entire message is prepended with byte indicating total length of message.
5. Server loads same pre-shared key from file `/mnt/custom/TelnetOEMPasswd` or uses default key `2wj9fsa2` if file is missing.
6. Server performs encryption of random number and verifies result is identical with string from client. On success server sends string `verify:OK` or `verify:ERROR` otherwise.
7. Client encrypts string `Telnet:OpenOnce`, prepends it with total length byte, `CMD:` string and sends to server.
8. Server extracts and decryptes received command. If decryption result is equal to string `Telnet:OpenOnce` it responds with `Open:OK`, enables debug port 9527 and starts telnet daemon.

Entire authentication process may resemble some sort of HMAC challenge-response authentication except it uses symmetric cipher instead of hash. This particular symmetric cipher resembles some variation of 3DES-EDE2 for keys longer than 8 bytes and similar to simple DES for shorter keys.

It's easy to see that all clients need for successful authentication is knowledge of PSK (which is common and can be retrieved from firmware in plaintext) and implementation of that symmetric block cipher. Recovery of that symmetric cipher implementation is most difficult, but it was achieved during this research. Exploration and tests were conducted using this set of tools:

* Ghidra 9.1.1 from NSA (<https://ghidra-sre.org/>) — suite for binary executeble code inspection.
* QEMU (more specifically qemu-user in Debian chroot — <https://www.qemu.org/>) — software which allows foreign architecture binaries (ARM) to be executed transparently on host.
* Common GNU utilities and toolchain.

Once telnet daemon activated, it's very likely it will accept one of following login/password pairs:

| Login | Password |
| --- | --- |
| `root` | `xmhdipc` |
| `root` | `klv123` |
| `root` | `xc3511` |
| `root` | `123456` |
| `root` | `jvbzd` |
| `root` | `hi3518` |

These passwords can be recovered from firmware as well by bruteforce of hash in `/etc/passwd` file. Modern consumer-grade GPGPU with [hashcat](https://hashcat.net/hashcat/) is capable to find pre-image for hash in a matter of hours.

Debug port 9527 accepts same login/password as Web UI and it also provides some shell access and functions to control the device. Speaking of Web UI accounts, attacker may reset password or grab password hashes from `/mnt/mtd/Config/Account*` files. Hash function was [described in previous research](https://github.com/tothi/pwn-hisilicon-dvr#password-hash-function) by Istvan Toth.

## Affected devices

Previous research has a good collection of brands affected: <https://github.com/tothi/pwn-hisilicon-dvr#summary>. There are dozens of brands and hundreds of models.

Author of this report, reposing on survey across population of random IP addresses, estimates total number of vulnerable devices exposed via Internet somewhere between hundreds of thousands and millions.

Probably, the easiest way to check whether your device is vulnerable is PoC code provided below.

## Testing vulnerability

PoC code: <https://github.com/Snawoot/hisilicon-dvr-telnet>.

Building PoC program from source: run `make` in source directory.

Usage: `./hs-dvr-telnet HOST PSK`

Most common PSK is default one: `2wj9fsa2`.

Example session:

```

$ telnet 198.51.100.23
Trying 198.51.100.23...
telnet: Unable to connect to remote host: Connection refused
$ ./hs-dvr-telnet 198.51.100.23 2wj9fsa2
Sent OpenTelnet:OpenOnce command.
randNum:46930886
challenge=469308862wj9fsa2
verify:OK
Open:OK
$ telnet 198.51.100.23
Trying 198.51.100.23...
Connected to 198.51.100.23.
Escape character is '^]'.
LocalHost login: root
Password:

```

IP address in example above is an IP address from address block reserved for documentation by RFC5737.

Device should be considered vulnerable if:

* Telnet port opens after `hs-dvr-telnet` run.
* Device responds with challenge on `hs-dvr-telnet` inquiry. Even if verification fails due to wrong PSK, there exists correct PSK extractable from firmware.
* hs-dvr-telnet stucks awaiting for response, but telnet port opens (this will happen with older firmware versions which require only `OpenTelnet:OpenOnce` command).

## Mitigation

Taking into account earlier bogus fixes for that vulnerability (backdoor, actually) it is not practical to expect security fixes for firmware from vendor. Owners of such devices should consider switching to alternatives.

However, if replacement is not possible, device owners should completely restrict network access to these devices to trusted users. Ports involved in this vulnerability is 23/tcp, 9530/tcp, 9527/tcp, but earlier researches indicate there is no confidence other services implementation is solid and doesn't contain RCE vulnerabilities.

## Subjects not covered by this research

Code analysis revealed that authentication procedure on port 9530 decrypts «CMD» payload with arbitrary size (up to size of buffer read from socket at once) into a buffer on stack with fixed size of 32 bytes. Targeted exploitation of this overflow requires knowledge of PSK, therefore it's more practical to proceed normal way to gain access. On the other hand, garbage sent with CMD command may cause stack corruption and dvrHelper daemon failure. Possible effects of that (potential) failure wasn't explored because macGuarder/dvrHelper backdoor functionality appears strictly superior and straightforward approach.

**UPDATE** (2020-02-05 02:10+00:00): Istvan Toth, author of [previous research](https://github.com/tothi/pwn-hisilicon-dvr) on this subject, presented his own implementation of PoC program: <https://github.com/tothi/hs-dvr-telnet> Given implementation is written in pure Python code and implements symmetric cipher in more clear way. Also it outlines differences between 3DES cipher variant used by Xiongmai for backdoor authentication and original 3DES cipher. These differences can be expressed by this git commit: <https://github.com/tothi/pyDes/commit/7a26fe09dc5b57b175c6439fbbf496414598a7a2>.

**UPDATE** (2020-02-05 17:28+00:00): Other researchers and habr users had pointed out such vulnerability is restricted to devices based on Xiongmai (Hangzhou Xiongmai Technology Co, XMtech) software, including products of other vendors which ship products based on such software. At this moment HiSilicon can't be held responsible for backdoor in dvrHelper/macGuarder binary.

**UPDATE** (2020-02-21 10:30+00:00): Xiaongmai acknowledged vulnerability and released a Security Advisory: [link](http://www.xiongmaitech.com/en/index.php/news/info/12/68), [archive 1](http://web.archive.org/web/20200221103130/http%3A//www.xiongmaitech.com/en/index.php/news/info/12/68), [archive 2](https://archive.fo/foJ47). Body of actual article has been updated accordingly in order to reflect origin of vulnerability properly.Tags:

* [hisilicon](/en/search/?target_type=posts&order=relevance&q=[hisilicon])
* [dvr](/en/search/?target_type=posts&order=relevance&q=[dvr])
* [nvr](/en/search/?target_type=posts&order=relevance&q=[nvr])
* [ip camera](/en/search/?target_type=posts&order=relevance&q=[ip+camera])
* [vulnerability](/en/search/?target_type=posts&order=relevance&q=[vulnerability])
* [0day](/en/search/?target_type=posts&order=relevance&q=[0day])
* [0day-vulnerability](/en/search/?target_type=posts&order=relevance&q=[0day-vulnerability])
* [backdoor](/en/search/?target_type=posts&order=relevance&q=[backdoor])
* [telnet](/en/search/?target_type=posts&order=relevance&q=[telnet])
Hubs:

* [IT Infrastructure](/en/hubs/it-infrastructure/)
* [Video equipment](/en/hubs/video_tech/)
* [Information Security](/en/hubs/infosecurity/)
* [Cryptography](/en/hubs/crypto/)
* [Reverse engineering](/en/hubs/reverse-engineering/)
Total votes 13: ↑12 and ↓1+17Add to bookmarks8[Comments15](/en/articles/486856/comments/)[![](https://assets.habr.com/habr-web/img/avatars/111.png)](/en/users/YourChief/)124Karma24.1RatingVladislav Yarmak [@YourChief](/en/users/YourChief/)

11x engineer

FollowSend message[Twitter](https://twitter.com/snawoot)[Github](https://github.com/Snawoot/)[Telegram](https://telegram.me/Snawoot)[Comments Comments 15](/en/articles/486856/comments/)
## Articles

Top of the daySimilar articles

Show the best of all time

Your account

* [Log in](/kek/v1/auth/habrahabr/?back=/en/articles/486856/&hl=en)
* [Sign up](/kek/v1/auth/habrahabr-register/?back=/en/articles/486856/&hl=en)

Sections

* [Articles](/en/articles/)
* [News](/en/news/)
* [Hubs](/en/hubs/)
* [Authors](/en/users/)
* [Sandbox](/en/sandbox/)

Information

* [How it works](/en/docs/help/)
* [For authors](/en/docs/authors/codex/)
* [For companies](/en/docs/companies/corpblogs/)
* [Documents](/en/docs/docs/transparency/)
* [Agreement](https://account.habr.com/info/agreement/?hl=en_US)
* [Confidential](https://account.habr.com/info/confidential/?hl=en_US)

Services

* [Corporate blogs](https://company.habr.com/en/corporate-blogs/)
* [Advertising](https://company.habr.com/en/advertising/)
* [Native advertising](https://company.habr.com/en/native-special/)
* [Education programs](https://company.habr.com/en/education-programs/)
* [Startups](https://company.habr.com/en/hello-startup/)
[Facebook](https://www.facebook.com/habr.eng)[Twitter](https://twitter.com/habr_eng)[Telegram](https://t.me/habr_eng) Language settings[Support](/en/feedback/)© 2006–2025, [Habr](https://company.habr.com/en/)

![](https://mc.yandex.ru/watch/24049213)



=== Content from github.com_01558681_20250108_121734.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSnawoot%2Fhisilicon-dvr-telnet)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSnawoot%2Fhisilicon-dvr-telnet)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=Snawoot%2Fhisilicon-dvr-telnet)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on Jan 7, 2025. It is now read-only.

[Snawoot](/Snawoot)
/
**[hisilicon-dvr-telnet](/Snawoot/hisilicon-dvr-telnet)**
Public archive

* [Notifications](/login?return_to=%2FSnawoot%2Fhisilicon-dvr-telnet) You must be signed in to change notification settings
* [Fork
  72](/login?return_to=%2FSnawoot%2Fhisilicon-dvr-telnet)
* [Star
   134](/login?return_to=%2FSnawoot%2Fhisilicon-dvr-telnet)

PoC materials for article <https://habr.com/en/post/486856/>

### License

[MIT license](/Snawoot/hisilicon-dvr-telnet/blob/master/LICENSE)

[134
stars](/Snawoot/hisilicon-dvr-telnet/stargazers) [72
forks](/Snawoot/hisilicon-dvr-telnet/forks) [Branches](/Snawoot/hisilicon-dvr-telnet/branches) [Tags](/Snawoot/hisilicon-dvr-telnet/tags) [Activity](/Snawoot/hisilicon-dvr-telnet/activity)
 [Star](/login?return_to=%2FSnawoot%2Fhisilicon-dvr-telnet)

 [Notifications](/login?return_to=%2FSnawoot%2Fhisilicon-dvr-telnet) You must be signed in to change notification settings

* [Code](/Snawoot/hisilicon-dvr-telnet)
* [Issues
  0](/Snawoot/hisilicon-dvr-telnet/issues)
* [Pull requests
  0](/Snawoot/hisilicon-dvr-telnet/pulls)
* [Actions](/Snawoot/hisilicon-dvr-telnet/actions)
* [Projects
  0](/Snawoot/hisilicon-dvr-telnet/projects)
* [Security](/Snawoot/hisilicon-dvr-telnet/security)
* [Insights](/Snawoot/hisilicon-dvr-telnet/pulse)

Additional navigation options

* [Code](/Snawoot/hisilicon-dvr-telnet)
* [Issues](/Snawoot/hisilicon-dvr-telnet/issues)
* [Pull requests](/Snawoot/hisilicon-dvr-telnet/pulls)
* [Actions](/Snawoot/hisilicon-dvr-telnet/actions)
* [Projects](/Snawoot/hisilicon-dvr-telnet/projects)
* [Security](/Snawoot/hisilicon-dvr-telnet/security)
* [Insights](/Snawoot/hisilicon-dvr-telnet/pulse)

# Snawoot/hisilicon-dvr-telnet

    master[Branches](/Snawoot/hisilicon-dvr-telnet/branches)[Tags](/Snawoot/hisilicon-dvr-telnet/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[4 Commits](/Snawoot/hisilicon-dvr-telnet/commits/master/) | | |
| [.gitignore](/Snawoot/hisilicon-dvr-telnet/blob/master/.gitignore ".gitignore") | | [.gitignore](/Snawoot/hisilicon-dvr-telnet/blob/master/.gitignore ".gitignore") |  |  |
| [LICENSE](/Snawoot/hisilicon-dvr-telnet/blob/master/LICENSE "LICENSE") | | [LICENSE](/Snawoot/hisilicon-dvr-telnet/blob/master/LICENSE "LICENSE") |  |  |
| [Makefile](/Snawoot/hisilicon-dvr-telnet/blob/master/Makefile "Makefile") | | [Makefile](/Snawoot/hisilicon-dvr-telnet/blob/master/Makefile "Makefile") |  |  |
| [README.md](/Snawoot/hisilicon-dvr-telnet/blob/master/README.md "README.md") | | [README.md](/Snawoot/hisilicon-dvr-telnet/blob/master/README.md "README.md") |  |  |
| [hs-dvr-telnet.c](/Snawoot/hisilicon-dvr-telnet/blob/master/hs-dvr-telnet.c "hs-dvr-telnet.c") | | [hs-dvr-telnet.c](/Snawoot/hisilicon-dvr-telnet/blob/master/hs-dvr-telnet.c "hs-dvr-telnet.c") |  |  |
| View all files | | |

## Repository files navigation

* README
* MIT license
# hisilicon-dvr-telnet

PoC materials for article <https://habr.com/en/post/486856/>

---

❤️ ❤️ ❤️

You can say thanks to the author by donations to these wallets:

* ETH: `0xB71250010e8beC90C5f9ddF408251eBA9dD7320e`
* BTC:
  + Legacy: `1N89PRvG1CSsUk9sxKwBwudN6TjTPQ1N8a`
  + Segwit: `bc1qc0hcyxc000qf0ketv4r44ld7dlgmmu73rtlntw`

---

## About

PoC materials for article <https://habr.com/en/post/486856/>

### Topics

[shell](/topics/shell "Topic: shell")
[camera](/topics/camera "Topic: camera")
[exploit](/topics/exploit "Topic: exploit")
[telnet](/topics/telnet "Topic: telnet")
[nvr](/topics/nvr "Topic: nvr")
[exploits](/topics/exploits "Topic: exploits")
[poc](/topics/poc "Topic: poc")
[dvr](/topics/dvr "Topic: dvr")

### Resources

[Readme](#readme-ov-file)
### License

[MIT license](#MIT-1-ov-file)

[Activity](/Snawoot/hisilicon-dvr-telnet/activity)
### Stars

[**134**
stars](/Snawoot/hisilicon-dvr-telnet/stargazers)
### Watchers

[**9**
watching](/Snawoot/hisilicon-dvr-telnet/watchers)
### Forks

[**72**
forks](/Snawoot/hisilicon-dvr-telnet/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FSnawoot%2Fhisilicon-dvr-telnet&report=Snawoot+%28user%29)

## [Releases](/Snawoot/hisilicon-dvr-telnet/releases)

No releases published

## [Packages 0](/users/Snawoot/packages?repo_name=hisilicon-dvr-telnet)

No packages published

## Languages

* [C
  99.4%](/Snawoot/hisilicon-dvr-telnet/search?l=c)
* [Makefile
  0.6%](/Snawoot/hisilicon-dvr-telnet/search?l=makefile)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


