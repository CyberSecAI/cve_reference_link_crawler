[![](https://blog.be-hacktive.com/~gitbook/image?url=https%3A%2F%2F2918471917-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Forganizations%252F7TnzKNNuuNUncl49T8ib%252Fsites%252Fsite_63cRb%252Ficon%252Fz6OjsMhVanXqVSSZUoFt%252Fimage.png%3Falt%3Dmedia%26token%3Da3e50107-485a-463b-990d-bec848682cda&width=32&dpr=4&quality=100&sign=9c8683e9&sv=2)![](https://blog.be-hacktive.com/~gitbook/image?url=https%3A%2F%2F2918471917-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Forganizations%252F7TnzKNNuuNUncl49T8ib%252Fsites%252Fsite_63cRb%252Ficon%252Fz6OjsMhVanXqVSSZUoFt%252Fimage.png%3Falt%3Dmedia%26token%3Da3e50107-485a-463b-990d-bec848682cda&width=32&dpr=4&quality=100&sign=9c8683e9&sv=2)BE-Hacktive](/)English[English](https://blog.be-hacktive.com/eskooly-cve/cve-2024-27717-cross-site-request-forgery-csrf-in-eskooly-web-product-less-than-v3.0?fallback=true)[French](https://blog.be-hacktive.com/french/eskooly-cve/cve-2024-27717-cross-site-request-forgery-csrf-in-eskooly-web-product-less-than-v3.0?fallback=true)[Arabic](https://blog.be-hacktive.com/arabic/eskooly-cve/cve-2024-27717-cross-site-request-forgery-csrf-in-eskooly-web-product-less-than-v3.0?fallback=true)[HackTricks](https://blog.be-hacktive.com/)[Twitter](https://blog.be-hacktive.com/)[LinkedIn](https://blog.be-hacktive.com/)[Sponsor](https://blog.be-hacktive.com/)[Website](https://blog.be-hacktive.com/)More[HackTricks](https://blog.be-hacktive.com/)[Twitter](https://blog.be-hacktive.com/)[LinkedIn](https://blog.be-hacktive.com/)[Sponsor](https://blog.be-hacktive.com/)[Website](https://blog.be-hacktive.com/)Search...Ctrl +‚ÄÜKEnglish[English](https://blog.be-hacktive.com/eskooly-cve/cve-2024-27717-cross-site-request-forgery-csrf-in-eskooly-web-product-less-than-v3.0?fallback=true)[French](https://blog.be-hacktive.com/french/eskooly-cve/cve-2024-27717-cross-site-request-forgery-csrf-in-eskooly-web-product-less-than-v3.0?fallback=true)[Arabic](https://blog.be-hacktive.com/arabic/eskooly-cve/cve-2024-27717-cross-site-request-forgery-csrf-in-eskooly-web-product-less-than-v3.0?fallback=true)

* [BE-Hacktive](/)
* [About the author and the project](/a-propos-de-lauteur)
* [Table of contents](/table-des-matieres)
* [Contact](/contact)
* üé¨Synopsis
  + [Technology over time](/synopsis/la-technologie-dans-le-temps)
  + [Cybersecurity](/synopsis/cybersecurite)
  + [CVE](/synopsis/la-technologie-dans-le-temps-1)
* üèÜEskooly - CVE
  + [ESKOOLY](/eskooly-cve/eskooly)
  + [CVE-2024-27709 - SQL Injection in Eskooly Web Product v.3.0](/eskooly-cve/cve-2024-27709-sql-injection-in-eskooly-web-product-v.3.0)
  + [ESkooly - Broken Authentication](/eskooly-cve/eskooly-broken-authentication)
    - [CVE-2024-27710 - Privilege Escalation via Authentication Mechanism in Eskooly Web Product <= v3.0](/eskooly-cve/eskooly-broken-authentication/cve-2024-27710-privilege-escalation-via-authentication-mechanism-in-eskooly-web-product-less-than-v3)
    - [CVE-2024-27711 - User Enumeration via Sign-up Process in Eskooly Web Product <= v3.0](/eskooly-cve/eskooly-broken-authentication/cve-2024-27711-user-enumeration-via-sign-up-process-in-eskooly-web-product-less-than-v3.0)
    - [CVE-2024-27712 - User Enumeration via Account Settings in Eskooly Web Product <= v3.0](/eskooly-cve/eskooly-broken-authentication/cve-2024-27712-user-enumeration-via-account-settings-in-eskooly-web-product-less-than-v3.0)
  + [CVE-2024-27713 - Protection mechanism Failure in Eskooly Web Product <= v3.0](/eskooly-cve/cve-2024-27713-protection-mechanism-failure-in-eskooly-web-product-less-than-v3.0)
  + [CVE-2024-27715 - Inadequate Password Update Verification in Eskooly Web Product <= v3.0](/eskooly-cve/cve-2024-27715-inadequate-password-update-verification-in-eskooly-web-product-less-than-v3.0)
  + [CVE-2024-27716 - Cross-site Scripting (XSS) in Eskooly Web Product <= v3.0](/eskooly-cve/cve-2024-27716-cross-site-scripting-xss-in-eskooly-web-product-less-than-v3.0)
  + [CVE-2024-27717 - Cross-Site Request Forgery (CSRF) in Eskooly Web Product <= v3.0](/eskooly-cve/cve-2024-27717-cross-site-request-forgery-csrf-in-eskooly-web-product-less-than-v3.0)
* üö®Tip 1 - Raising awareness
  + [Phishing](/tip-1-raising-awareness/phishing)
    - [Phishing - Origins](/tip-1-raising-awareness/phishing/phishing-histoire)
    - [Phishing - Evolution](/tip-1-raising-awareness/phishing/evolution)
    - [Phishing - Statistics](/tip-1-raising-awareness/phishing/phishing-statistiques)
    - [Phishing - Techniques](/tip-1-raising-awareness/phishing/phishing-techniques)
    - [Phishing - Protection](/tip-1-raising-awareness/phishing/phishing-protection)
  + [Malware](/tip-1-raising-awareness/malware)
    - [Malware - Origines](/tip-1-raising-awareness/malware/malware-origines)
    - [Malware - Evolution](/tip-1-raising-awareness/malware/malware-evolution)
    - [Malware - Categories](/tip-1-raising-awareness/malware/malware-categories)
    - [Malware - Ransomware](/tip-1-raising-awareness/malware/malware-ransomware)
  + [Passwords](/tip-1-raising-awareness/passwords)
    - [Passwords - Origins](/tip-1-raising-awareness/passwords/passwords-origins)
    - [Passwords - Evolution of authentication](/tip-1-raising-awareness/passwords/passwords-evolution-of-authentication)
    - [Passwords - Statistics](/tip-1-raising-awareness/passwords/passwords-statistics)
    - [Passwords - Protect yourself](/tip-1-raising-awareness/passwords/passwords-protect-yourself)
* üß®Capsule 2 - Ethical Hacking
  + [Definition and Methodology](/capsule-2-ethical-hacking/definition-and-methodology)
* üß∞Capsule 3 - Tools
  + [Burp Suite](/capsule-3-tools/burp-suite)
    - [Installation](/capsule-3-tools/burp-suite/installation)
    - [Intercept HTTP traffic with Burp Proxy](/capsule-3-tools/burp-suite/intercept-http-traffic-with-burp-proxy)
    - [Define the perimeter](/capsule-3-tools/burp-suite/define-the-perimeter)
    - [Intruder et Repeater](/capsule-3-tools/burp-suite/intruder-et-repeater)
* Capsule 2 - Ethical Hacking
  + [Page 1](/capsule-2-ethical-hacking-1/page-1)
* üìñArticles
  + [Cybersecurity 2023: 5 major threats and how to protect yourself from them](/articles/cybersecurity-2023-5-major-threats-and-how-to-protect-yourself-from-them)
  + [Am I a victim of data leaks?](/articles/am-i-a-victim-of-data-leaks)
  + [LOG4J: The vulnerable bookstore that is shaking the planet](/articles/log4j-the-vulnerable-bookstore-that-is-shaking-the-planet)
  + [LOG4SHELL: COME, SEE, LIVE](/articles/log4shell-come-see-live)
  + [Protecting Your Child Online: Tips for Safer Internet Day](/articles/protecting-your-child-online-tips-for-safer-internet-day)
  + [ChatGPT: Revolution or threat?](/articles/chatgpt-revolution-or-threat)
  + [The FBI dismantles Raptor Train: A Chinese Botnet that Infected 260,000 IoT Devices Worldwide!](/articles/fbi-demonte-botnet-raptor-train-iot)
* üóûÔ∏èNews
  + [Active exploitation of TP-Link, Apache and Oracle vulnerabilities detected](/news/active-exploitation-of-tp-link-apache-and-oracle-vulnerabilities-detected)
  + [Microsoft stresses the urgency of patching Exchange servers locally](/news/microsoft-stresses-the-urgency-of-patching-exchange-servers-locally)
* üóûÔ∏èDaily Cyber News
  + [Cyber News - 15/01/2024](/daily-cyber-news/cyber-news-15-01-2024)
  + [Cyber News - 16/01/2024](/daily-cyber-news/cyber-news-16-01-2024)
  + [Cyber News - 17/01/2024](/daily-cyber-news/cyber-news-17-01-2024)
  + [Cyber News - 19/01/2024](/daily-cyber-news/cyber-news-19-01-2024)
  + [Cyber News - 22/01/2024](/daily-cyber-news/cyber-news-22-01-2024)
  + [Cyber News - 24/01/2024](/daily-cyber-news/cyber-news-24-01-2024)
  + [Cyber News - 25/01/2024](/daily-cyber-news/cyber-news-25-01-2024)
  + [Cyber News - 26/01/2024](/daily-cyber-news/cyber-news-26-01-2024)
  + [Cyber News - 29/01/2024](/daily-cyber-news/cyber-news-29-01-2024)
  + [Cyber News - 30/01/2024](/daily-cyber-news/cyber-news-30-01-2024)
  + [Cyber News - 31/01/2024](/daily-cyber-news/cyber-news-31-01-2024)
  + [Cyber News - 02/02/2024](/daily-cyber-news/cyber-news-02-02-2024)
  + [Cyber News - 05/02/2024](/daily-cyber-news/cyber-news-05-02-2024)
  + [Cyber News - 06/02/2024](/daily-cyber-news/cyber-news-06-02-2024)
  + [Cyber News - 08/02/2024](/daily-cyber-news/cyber-news-08-02-2024)
  + [Cyber News - 13/02/2024](/daily-cyber-news/cyber-news-13-02-2024)
  + [Cyber News - 14/02/2024](/daily-cyber-news/cyber-news-14-02-2024)
  + [Cyber News - 16/02/2024](/daily-cyber-news/cyber-news-16-02-2024)
  + [Cyber News - 19/02/2024](/daily-cyber-news/cyber-news-19-02-2024)

[Powered by GitBook](https://www.gitbook.com/?utm_source=content&utm_medium=trademark&utm_campaign=8bgvMbF6wy5EyGrkuyUO)On this page
## Introduction

Cross-Site Request Forgery (CSRF) vulnerabilities are a significant threat to web applications, allowing attackers to perform unauthorized actions on behalf of authenticated users. This post explores CVE-2024-27717, a critical CSRF vulnerability in Eskooly Free Online School Management Software v.3.0 that enables attackers to escalate privileges via the Token Handling component.

## Discovery of the Vulnerability

CVE-2024-27717 was discovered during a detailed security assessment of Eskooly's web application. The vulnerability was identified in the token handling mechanism, where the application fails to implement sufficient measures to protect against CSRF attacks.

### Related Findings

* Cross-site Request Forgery

### **Technical Details**

The vulnerability arises from the lack of anti-CSRF tokens and improper handling of user sessions. Specifically, the application does not use unique, unpredictable tokens in state-changing requests, allowing attackers to trick authenticated users into performing unintended actions.

### Example of Impact

The impact of CVE-2024-27717 includes:

* Unauthorized actions performed on behalf of authenticated users.
* Potential for attackers to escalate privileges and compromise user accounts.
* Increased risk of data breaches and unauthorized data manipulation.
* Compromise of sensitive user information and application integrity.

## Eskooly Application

2. Update the account and password

-> POST Request:

2. Craft the payload with the new mail and password

2. Send to admin and the victim triggered the attack

## Risk

### Impact

**High.**

The impact is high due to the nature of the actions that can be performed. Changing a user's password via CSRF can lock legitimate users out of their accounts and give attackers unauthorized access.

### Likelihood

**High.**

In this specific context, where a CSRF attack allows password updates or change email of the victim, the likelihood is high.

## Recommendation

It‚Äôs recommended to:

2. Implement Anti-CSRF Tokens: Use unique, unpredictable anti-CSRF tokens in all forms and state-changing requests. These tokens ensure that only requests originating from your own website are accepted, effectively blocking forged requests from other sites.
5. SameSite Cookie Attribute: Utilize the SameSite attribute in cookies to restrict their sending to only first-party contexts, reducing the risk of CSRF attacks.

## **References**

Copy
```
POST /bb/account.php HTTP/2
Host: eskooly.com
--SNIP--
--SNIP--
email=HERE@MAIL.COM&password=1&timezone=Asia%2FKarachi&currency=2&symbol=%24&changepassword=

```
[**CWE-352: Cross-Site Request Forgery (CSRF)**](https://cwe.mitre.org/data/definitions/352.html)[**OWASP Top Ten 2013 Category A8 - Cross-Site Request Forgery (CSRF)**](https://cwe.mitre.org/data/definitions/936.html)[**OWASP: Cross-Site Request Forgery Prevention Cheat Sheet**](https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html)

* [Introduction](#introduction)
* [Discovery of the Vulnerability](#discovery-of-the-vulnerability)
* [Related Findings](#related-findings)
* [Technical Details](#technical-details)
* [Example of Impact](#example-of-impact)
* [Eskooly Application](#eskooly-application)
* [Risk](#risk)
* [Impact](#impact)
* [Likelihood](#likelihood)
* [Recommendation](#recommendation)
* [References](#references)
[PreviousCVE-2024-27716 - Cross-site Scripting (XSS) in Eskooly Web Product <= v3.0](/eskooly-cve/cve-2024-27716-cross-site-scripting-xss-in-eskooly-web-product-less-than-v3.0)[NextPhishing](/tip-1-raising-awareness/phishing)

1. [üèÜEskooly - CVE](/eskooly-cve)
# CVE-2024-27717 - Cross-Site Request Forgery (CSRF) in Eskooly Web Product <= v3.0

![](https://blog.be-hacktive.com/~gitbook/image?url=https%3A%2F%2Fcontent.gitbook.com%2Fcontent%2F8bgvMbF6wy5EyGrkuyUO%2Fblobs%2FWzPlxrFKqN0lkIDILZLl%2Fimage.png&width=768&dpr=4&quality=100&sign=db4c143c&sv=2)![](https://blog.be-hacktive.com/~gitbook/image?url=https%3A%2F%2Fcontent.gitbook.com%2Fcontent%2F8bgvMbF6wy5EyGrkuyUO%2Fblobs%2FSlpRRmwDgniYTTLhN4gK%2Fimage.png&width=768&dpr=4&quality=100&sign=680a7a0e&sv=2)