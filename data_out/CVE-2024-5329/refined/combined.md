=== Content from wordpress.org_03458e04_20250110_125920.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[Plugin Directory](https://wordpress.org/plugins/)

Unlimited Elements For Elementor

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Funlimited-elements-for-elementor&locale=en_US)

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Funlimited-elements-for-elementor&locale=en_US)

Search plugins

![](https://ps.w.org/unlimited-elements-for-elementor/assets/banner-772x250.jpg?rev=3206933)
![](https://ps.w.org/unlimited-elements-for-elementor/assets/icon-256x256.gif?rev=3206933)
# Unlimited Elements For Elementor

By [Unlimited Elements](http://unlimited-elements.com)

[Download](https://downloads.wordpress.org/plugin/unlimited-elements-for-elementor.zip)

* [Details](https://wordpress.org/plugins/unlimited-elements-for-elementor/#description)
* [Reviews](https://wordpress.org/plugins/unlimited-elements-for-elementor/#reviews)
* [Installation](https://wordpress.org/plugins/unlimited-elements-for-elementor/#installation)
* [Development](https://wordpress.org/plugins/unlimited-elements-for-elementor/#developers)

[Support](https://wordpress.org/support/plugin/unlimited-elements-for-elementor/)

## Description

**Elementor** users, elevate your web design experience with **Unlimited Elements for Elementor**. An all in one plugin that instantly gives you the most advanced widgets and tools to make better Elementor websites faster. Take your WordPress website to the next level.

[View Elementor Widgets Demos](https://unlimited-elements.com/elementor-widgets/)

Browse our extensive collection of free widgets or upgrade to our pro version for access to over 200 additional unique drag and drop widgets for **Elementor**. Each widget provides a wide range of options to easily control every aspect. If you can’t find what you need, our **Widget Creator** Framework empowers you to create any widget you can imagine.

### Plugin Features

* [**Widget Library**](https://unlimited-elements.com/elementor-widgets/) Enhance the popular Elementor page builder with our user-friendly and innovative widget library. Simplify your website by finding everything you need in one place, without the need for multiple plugins.
* [**Widget Creator**](https://unlimited-elements.com/widget-creator/) Save valuable time by eliminating the need to search for numerous plugins and add-ons. Instead, create customized, professional widgets that perfectly align with your website requirements.
* [**Elementor Templates**](https://unlimited-elements.com/elementor-templates/) Effortlessly kickstart your web project with pre-designed templates. Say goodbye to endless searches for inspiration or starting from scratch. Get your project up and running in seconds with our collection of template kits.
* [**Loop Builder**](https://unlimited-elements.com/loop-builder-for-elementor/) Easily create dynamic Loop Items within the Elementor Theme Builder by utilizing any loop widget layout of your preference. Effortlessly populate the chosen widget with dynamic content to craft versatile and engaging Loop Items.
* [**Background Widgets**](https://unlimited-elements.com/background-widgets-for-elementor/) Elevate your web designs instantly with our user-friendly animated backgrounds available in our extensive widget library. Experience seamless integration and unleash your creativity like never before.
* [**Post Widgets & Filters**](https://unlimited-elements.com/post-widgets-filters-tools/) Easily create stunning post layouts with real-time filters. Improve the browsing experience for website visitors by helping them find the content they’re looking for. Effortlessly display posts using advanced criteria on your entire website.
* [**WooCommerce Widgets & Filters**](https://unlimited-elements.com/woo/) Create stunning product layouts with dynamic real-time filters. Showcase your products and categories in a wide array of interactive formats, such as grids, carousels, sliders, and more.
* [**Woo Widgets & Filters**](https://unlimited-elements.com/remote-control-widgets/) Unleash your creativity with advanced and customizable layouts. Take full control of your designs and make them truly unique using the remote controls. Stand out from the crowd with layouts that are both eye-catching and distinctive.
* [**Sync Between Widgets**](https://unlimited-elements.com/sync-widgets/) Elevate your web designs to new heights by seamlessly synchronizing multiple item-based widgets. This powerful feature empowers you to effortlessly create intricate and personalized layouts, taking your designs to the next level of sophistication.
* [**Multi-Source Galleries**](https://unlimited-elements.com/multi-source-galleries/) Empower your gallery showcase by effortlessly featuring Woo products, WordPress posts, Instagram feeds, and a variety of other sources, including various API integrations.
* [**Live Copy Paste**](https://unlimited-elements.com/live-copy-paste/) Copy and paste fully designed sections from the Unlimited Elements website directly to your website, saving you time and ensuring you can finish your web project as soon as possible.
* [**Mega Menu Builder**](https://unlimited-elements.com/mega-menu-widget-for-elementor/) Easily craft a distinctive Mega Menu for your website navigation by incorporating images, icons, links, and various Elementor widgets into unique menu layouts.
* [**Mega Slider Builder**](https://unlimited-elements.com/mega-slider-widget-for-elementor/) Easily turn any Elementor sections into slider slides. Now you can amaze your website visitors with jaw-dropping slider designs that look amazing on any device.
* [**Multi-Source Widgets**](https://unlimited-elements.com/multi-source/) Add content dynamically to item-based widgets effortlessly with support for ACF repeaters, JSON/CSV files, Woo Products, WordPress posts, users, menus, and a range of API integrations.
* [**Dynamic Popup Builder**](https://unlimited-elements.com/dynamic-post-popup-widget-for-elementor/) Dynamically create a popup to add a quick view of the post without leaving the page. Use an Elementor single post template to create the layout of the dynamic popup.
* [**Elementor Form Builder**](https://unlimited-elements.com/form-builder/) Build advanced forms effortlessly using the drag-and-drop form builder. Whether itвЂ™s a simple or complex form, our straightforward form widgets make it quick and easy to create forms, improving your workflow.
* [**Calculator Builder**](https://unlimited-elements.com/calculators/) Easily design professional calculators for any type of industry. Whether you need a loan calculator, mortgage calculator or business calculator, our powerful and intuitive drag and drop builder makes it easy to create complex calculators with ease.
* [**Elementor Filter Widgets**](https://unlimited-elements.com/filters/) Unlock the potential of the AJAX-based faceted filter system, seamlessly empowering you to craft diverse layouts with ease. Take control by applying multiple filters, ensuring a super-fast and dynamic filtering experience tailored to your website needs.

### Widget Library

Find everything you need in one convenient package and supercharge your **Elementor** website.

### Creative Widgets for Elementor

1. [Flip Box (Free)](https://unlimited-elements.com/flip-box-widget-for-elementor/)
2. [Icon Bullets (Free)](https://unlimited-elements.com/docs/icon-bullets/)
3. [Number Box (Free)](https://unlimited-elements.com/number-box-widget-widget-for-elementor/)
4. [Blob Shapes (Free)](https://unlimited-elements.com/blob-shape-widget-for-elementor/)
5. [SVG Animation (Free)](https://unlimited-elements.com/svg-animation-widget-for-elementor)
6. [Timeline Bullets (Free)](https://unlimited-elements.com/timeline-bullets-widget-for-elementor/)
7. [Lordicon: Animated Icons (Free)](https://unlimited-elements.com/lordicon-animated-icons-widget-for-elementor/)
8. [Animated Hamburger Icon (Free)](https://unlimited-elements.com/animated-hamburger-icon-for-elementor/)
9. [Image Shapes (Pro)](https://unlimited-elements.com/image-shapes-for-elementor-page-builder/)
10. [Hexagon Grid (Pro)](https://unlimited-elements.com/hexagon-grid-widget-for-elementor/)
11. [Custom Cursor (Pro)](https://unlimited-elements.com/custom-cursor-widget-for-elementor/)
12. [Scroll Sequence (Pro)](https://unlimited-elements.com/scroll-sequence-widget-for-elementor/)
13. [Icon Box Accordion (Pro)](https://unlimited-elements.com/icon-box-accordion-widget-for-elementor/)
14. [Morph Slider (Pro)](https://unlimited-elements.com/morph-slider-widget-for-elementor/)
15. [Scroll Image Reveal (Pro)](https://unlimited-elements.com/scroll-image-reveal-widget-for-elementor/)
16. [Icon Tabs (Pro)](https://unlimited-elements.com/icon-tabs-widget-for-elementor)
17. [Particle Image (Pro)](https://unlimited-elements.com/image-particle-widget-for-elementor/)
18. [Image Zoom Magnifier (Pro)](https://unlimited-elements.com/image-zoom-magnifier-widget-for-elementor/)
19. [Background Switcher (Pro)](https://unlimited-elements.com/background-switcher-widget-for-elementor/)
20. [Before After (Pro)](https://unlimited-elements.com/before-after-widget-for-elementor/)
21. [Shape Bullets (Pro)](https://unlimited-elements.com/shape-bullets-widget-for-elementor/)
22. [Flip Box Carousel (Pro)](https://unlimited-elements.com/flip-box-carousel-widget-for-elementor/)
23. [Rhombus Grid (Pro)](https://unlimited-elements.com/rhombus-grid-widget-for-elementor/)
24. [Icon Accordion (Pro)](https://unlimited-elements.com/icon-accordion-widget-for-elementor/)
25. [Image Accordion (Pro)](https://unlimited-elements.com/image-accordion-widget-for-elementor/)
26. [Christmas Icons (Pro)](https://unlimited-elements.com/christmas-icons-widget-for-elementor/)

### Tools for Elementor

1. [Contact Form 7 (Free)](https://unlimited-elements.com/contact-form-7-widget-for-elementor/)
2. [Image Tooltip (Free)](https://unlimited-elements.com/image-tooltip-widget-for-elementor/)
3. [Event Box (Free)](https://unlimited-elements.com/event-box-widget-for-elementor)
4. [Notification (Free)](https://unlimited-elements.com/notification-widget-for-elementor)
5. [Animated Mouse Scroll Icon (Free)](https://unlimited-elements.com/animated-mouse-scroll-icon-widget-for-elementor/)
6. [Toggle Dropdown (Pro)](https://unlimited-elements.com/toggle-dropdown-widget-for-elementor/)
7. [Age Verification (Pro)](https://unlimited-elements.com/age-verification-widget-for-elementor/)
8. [Calendar (Pro)](https://unlimited-elements.com/calendar-widget-for-elementor/)
9. [Smooth Scroll (Pro)](https://unlimited-elements.com/smooth-scroll-widget-for-elementor/)
10. [QR Code (Pro)](https://unlimited-elements.com/qr-code-widget-for-elementor/)
11. [360 Panorama Virtual Tour (Pro)](https://unlimited-elements.com/360-panorama-virtual-tour-widget-for-elementor/)
12. [Protected Content (Pro)](https://unlimited-elements.com/protected-content-widget-for-elementor/)
13. [Hotspots (Pro)](https://unlimited-elements.com/hotspots-for-elementor-page-builder/)
14. [Event List (Pro)](https://unlimited-elements.com/event-list-widget-for-elementor/)
15. [Weather (Pro)](https://unlimited-elements.com/weather-widget-for-elementor/)
16. [Job Listing (Pro)](https://unlimited-elements.com/job-listing-widget-for-elementor/)
17. [PDF Viewer (Pro)](https://unlimited-elements.com/pdf-viewer-widget-for-elementor/)
18. [Image Scroll (Pro)](https://unlimited-elements.com/image-scroll-widget-for-elementor/)
19. [Currency Converter (Pro)](https://unlimited-elements.com/currency-converter-widget-for-elementor/)
20. [360 Product Viewer (Pro)](https://unlimited-elements.com/360-product-viewer-widget-for-elementor/)
21. [Layers (Pro)](https://unlimited-elements.com/layers-widget-for-elementor/)
22. [Cookie Consent (Pro)](https://unlimited-elements.com/cookie-consent-widget-for-elementor/)

### Post Widgets for Elementor

1. [Post Tabs (Free)](https://unlimited-elements.com/post-tabs-for-elementor/)
2. [Post Accordion (Free)](https://unlimited-elements.com/post-accordion-widget-for-elementor/)
3. [Post Carousel Lite (Free)](https://unlimited-elements.com/post-carousel-lite-widget-for-elementor)
4. [Post Blocks (Free)](https://unlimited-elements.com/post-blocks-widget-for-elementor)
5. [Post List (Free)](https://unlimited-elements.com/post-list-widget-for-elementor)
6. [Post Ticker (Free)](https://unlimited-elements.com/post-news-ticker-widget-for-elementor)
7. [Tag Cloud (Pro)](https://unlimited-elements.com/tag-cloud-widget-for-elementor/)
8. [Post Horizontal Timeline (Pro)](https://unlimited-elements.com/post-horizontal-timeline-widget-for-elementor/)
9. [Author List (Pro)](https://unlimited-elements.com/elementor-author-list-widget/)
10. [Post Tile (Pro)](https://unlimited-elements.com/post-tiles-widget-for-elementor)
11. [Post Slider (Pro)](https://unlimited-elements.com/post-slider-widget-for-elementor/)
12. [Post Grid (Pro)](https://unlimited-elements.com/post-grid-widget-for-elementor/)
13. [Post Card Slider (Pro)](https://unlimited-elements.com/blog-card-slider-widget-for-elementor)
14. [Post Magazine Grid (Pro)](https://unlimited-elements.com/post-magazine-grid-widget-for-elementor/)
15. [Post Timeline (Pro)](https://unlimited-elements.com/post-timeline-widget-for-elementor/)
16. [Post Scroll (Pro)](https://unlimited-elements.com/post-scroll-widget-for-elementor)
17. [Taxonomy Terms (Pro)](https://unlimited-elements.com/taxonomy-terms-widget-for-elementor/)
18. [Post Carousel (Pro)](https://unlimited-elements.com/post-carousel-widget-for-elementor/)
19. [Masonry Post Grid (Pro)](https://unlimited-elements.com/masonry-post-grid-widget-for-elementor)

### Post Filters & Tools for Elementor

1. [Post Pagination (Free)](https://unlimited-elements.com/post-pagination-widget-for-elementor/)
2. [Post Navigation (Free)](https://unlimited-elements.com/post-navigation-widget-for-elementor/)
3. [AJAX Search (Pro)](https://unlimited-elements.com/ajax-search-widget-for-elementor/)
4. [Dynamic Post Popup (Pro)](https://unlimited-elements.com/dynamic-post-popup-widget-for-elementor/)
5. [Tabs Filter (Pro)](https://unlimited-elements.com/tabs-filter-widget-for-elementor/)
6. [Checkboxes Filter (Pro)](https://unlimited-elements.com/checkboxes-filter-widget-for-elementor/)
7. [Active Filters (Pro)](https://unlimited-elements.com/active-filters-widget-for-elementor/)
8. [Clear Filters (Pro)](https://unlimited-elements.com/clear-filters-widget-for-elementor/)
9. [Select Dropdown Filter (Pro)](https://unlimited-elements.com/select-dropdown-filter-widget-for-elementor/)
10. [Post Query Summary (Pro)](https://unlimited-elements.com/post-query-summary-widget-for-elementor/)
11. [Search Filter (Pro)](https://unlimited-elements.com/search-filter-widget-for-elementor/)
12. [Load More / Infinite Scroll (Pro)](https://unlimited-elements.com/load-more-infinite-scroll-widget-for-elementor/)
13. [Sorting Filter (Pro)](https://unlimited-elements.com/sorting-filter-widget-for-elementor/)
14. [Price Range Filter (Pro)](https://unlimited-elements.com/price-range-filter-widget-for-elementor/)
15. [Colors Swatches Filter (Pro)](https://unlimited-elements.com/color-swatches-filter-widget-for-elementor/)
16. [Off Canvas Filters (Pro)](https://unlimited-elements.com/off-canvas-filters-widget-for-elementor/)

### Form Builder for Elementor

1. [Text Field (Free)](https://unlimited-elements.com/form-builder/)
2. [Submit Button (Free)](https://unlimited-elements.com/form-builder/)
3. [Textarea Field (Free)](https://unlimited-elements.com/form-builder/)
4. [Slider Field (Pro)](https://unlimited-elements.com/form-builder/)
5. [Scale Field (Pro)](https://unlimited-elements.com/form-builder/)
6. [NPS Field (Pro)](https://unlimited-elements.com/form-builder/)
7. [Star Rating Field (Pro)](https://unlimited-elements.com/form-builder/)
8. [Multi Step Form (Pro)](https://unlimited-elements.com/form-builder/)
9. [Confirm Field (Pro)](https://unlimited-elements.com/form-builder/)
10. [Message Field (Pro)](https://unlimited-elements.com/form-builder/)
11. [Radio Button Field (Pro)](https://unlimited-elements.com/form-builder/)
12. [Phone Field (Pro)](https://unlimited-elements.com/form-builder/)
13. [Date Field (Pro)](https://unlimited-elements.com/form-builder/)
14. [Number Field (Pro)](https://unlimited-elements.com/form-builder/)
15. [Email Field (Pro)](https://unlimited-elements.com/form-builder/)
16. [File Field (Pro)](https://unlimited-elements.com/form-builder/)
17. [Checkbox Field (Pro)](https://unlimited-elements.com/form-builder/)
18. [Dropdown Field (Pro)](https://unlimited-elements.com/form-builder/)
19. [Likert Scale (Pro)](https://unlimited-elements.com/form-builder/)

### Woo Widgets for Elementor

1. [Woo Product List (Free)](https://unlimited-elements.com/woo-product-list-widget-for-elementor/)
2. [Woo Mini Cart (Pro)](https://unlimited-elements.com/woocommerce-mini-cart-widget-for-elementor/)
3. [Woo Product Grid (Pro)](https://unlimited-elements.com/woo-product-grid-widget-for-elementor/)
4. [Woo Product Carousel (Pro)](https://unlimited-elements.com/woocommerce-product-carousel-widget-for-elementor)
5. [Woo AJAX Search (Pro)](https://unlimited-elements.com/woo-ajax-search-widget-for-elementor/)
6. [Woo Category Grid (Pro)](https://unlimited-elements.com/woo-category-grid-for-elemenetor/)
7. [Woo Product Slider (Pro)](https://unlimited-elements.com/woo-product-slider-widget-for-elementor/)
8. [Woo Category Carousel (Pro)](https://unlimited-elements.com/woo-category-carousel-widget-for-elementor/)
9. [Quantity Increment Buttons (Pro)](https://unlimited-elements.com/quantity-increment-buttons-widget-for-elementor/)

### Marketing Widgets for Elementor

1. [Testimonial Box (Free)](https://unlimited-elements.com/box-testimonial-widget-for-elementor/)
2. [Testimonial Card (Free)](https://unlimited-elements.com/logo-card-testimonial-widget-for-elementor)
3. [Overlay Product Box (Free)](https://unlimited-elements.com/overlay-product-box-widget-for-elementor/)
4. [Business Hours (Free)](https://unlimited-elements.com/business-hours-widget-for-elementor)
5. [Timer Countdown (Free)](https://unlimited-elements.com/timer-countdowns-for-elementor-page-builder/)
6. [Call To Action Button (Free)](https://unlimited-elements.com/call-to-action-button-widget-for-elementor/)
7. [Statistic Counter (Free)](https://unlimited-elements.com/statistic-counter-widget-for-elementor/)
8. [Product Card (Free)](http://unlimited-elements.com/food-menu-box-widget-for-elementor/)
9. [Review Box (Free)](https://unlimited-elements.com/review-box-widget-for-elementor)
10. [List (Free)](https://unlimited-elements.com/list-widget-for-elementor/)
11. [Block Quote Box (Free)](https://unlimited-elements.com/block-quote-box-widget-for-elementor)
12. [Team Member Box (Free)](https://unlimited-elements.com/team-member-box-widget-for-elementor/)
13. [Price List (Free)](https://unlimited-elements.com/price-list-widget-for-elementor/)
14. [Pricing Table (Free)](https://unlimited-elements.com/pricing-table-widget-for-elementor/)
15. [Block Quote Carousel Box (Free)](https://unlimited-elements.com/block-quote-carousel-box-widget-for-elementor)
16. [Instagram Latest Image (Free)](https://unlimited-elements.com/latest-instagram-image-widget-for-elementor)
17. [Logo Grid (Free)](https://unlimited-elements.com/logo-grid-widget-for-elementor/)
18. [Block Quote Card (Free)](https://unlimited-elements.com/block-quote-card-widget-for-elementor/)
19. [Logo Card (Free)](https://unlimited-elements.com/logo-card-widget-for-elementor)
20. [Team Member Card (Free)](http://unlimited-elements.com/team-member-card-widget-for-elementor/)
21. [Product Box (Free)](https://unlimited-elements.com/product-box-widget-for-elementor/)
22. [Logo Marquee (Pro)](https://unlimited-elements.com/logo-marquee-widget-for-elementor)
23. [Product Bullets (Pro)](https://unlimited-elements.com/product-bullets-widget-for-elementor)
24. [Product Carousel (Pro)](https://unlimited-elements.com/product-carousel-widget-for-elementor)
25. [Telegram Chat (Pro)](https://unlimited-elements.com/telegram-chat-widget-for-elementor)
26. [Copy Coupon Code (Pro)](https://unlimited-elements.com/copy-coupon-code-widget-for-elementor)
27. [Instagram Box (Pro)](https://unlimited-elements.com/instagram-teaser-box-for-elementor/)
28. [Team Member Carousel (Pro)](http://unlimited-elements.com/team-member-carousel-widget-for-elementor/)
29. [Timer Countdown Banner (Pro)](https://unlimited-elements.com/timer-countdown-banner-widget-for-elementor)
30. [Review Carousel (Pro)](https://unlimited-elements.com/review-carousel-widget-for-elementor/)
31. [List Marquee (Pro)](https://unlimited-elements.com/list-marquee-widget-for-elementor/)
32. [Pricing Table Flip Box (Pro)](https://unlimited-elements.com/pricing-table-flip-box-widget-for-elementor/)
33. [Instagram Feed (Pro)](https://unlimited-elements.com/instagram-feed-widget-for-elementor/)
34. [Unlimited Google Maps (Pro)](https://unlimited-elements.com/google-maps-widget-for-elementor)
35. [Icon Mobile Menu (Pro)](https://unlimited-elements.com/icon-mobile-menu-for-elementor)
36. [Price Box (Pro)](https://unlimited-elements.com/price-box-widget-for-elementor/)
37. [Product Highlights (Pro)](https://unlimited-elements.com/product-highlights-widget-for-elementor/)
38. [Instagram Card (Pro)](https://unlimited-elements.com/instagram-card-widget-for-elementor/)
39. [Memory Game (Pro)](https://unlimited-elements.com/memory-game-widget-for-elementor/)
40. [Logo Carousel (Pro)](https://unlimited-elements.com/logo-carousel-widget-for-elementor/)
41. [Testimonial Carousel (Pro)](https://unlimited-elements.com/testimonial-carousel-widget-for-elementor/)
42. [Pricing Plans (Pro)](https://unlimited-elements.com/pricing-plans-widget-for-elementor)
43. [Team Member Sliding Effect (Pro)](https://unlimited-elements.com/team-member-sliding-effect-widget-for-elementor/)
44. [Team Member Grid (Pro)](http://unlimited-elements.com/team-member-grid-widget-for-elementor/)
45. [vCard (Pro)](https://unlimited-elements.com/vcard-widget-for-elementor/)
46. [Floating Chat Buttons (Pro)](https://unlimited-elements.com/floating-chat-buttons-widget-for-elementor)
47. [Block Quote Carousel (Pro)](https://unlimited-elements.com/block-quote-carousel-widget-for-elementor/)
48. [Instagram Metro Grid (Pro)](https://unlimited-elements.com/metro-instagram-widget-for-elementor)
49. [WhatsApp Chat (Pro)](https://unlimited-elements.com/whatsapp-chat-widget-for-elementor)
50. [Block Quote Slider (Pro)](https://unlimited-elements.com/block-quote-slider-widget-for-elementor)
51. [Team Member Icon Effect (Pro)](https://unlimited-elements.com/team-member-icon-effect-widget-for-elementor/)
52. [Badge (Pro)](https://unlimited-elements.com/badge-widget-for-elementor/)

### Loop Builder for Elementor

1. [Loop Grid (Pro)](https://unlimited-elements.com/loop-grid-widget-for-elementor/)
2. [Loop Carousel (Pro)](https://unlimited-elements.com/loop-carousel-widget-for-elementor/)
3. [Loop Tabs (Pro)](https://unlimited-elements.com/loop-tabs-widget-for-elementor/)
4. [Loop Accordion (Pro)](https://unlimited-elements.com/loop-accordion-widget-for-elementor/)
5. [Loop Slider (Pro)](https://unlimited-elements.com/loop-slider-widget-for-elementor/)
6. [Dynamic Popup Button (Pro)](https://unlimited-elements.com/loop-grid-widget-for-elementor/)

### Remote Control Widgets for Elementor

1. [Remote Arrows (Free)](https://unlimited-elements.com/remote-arrows-widget-for-elementor/)
2. [Remote Bullets (Free)](https://unlimited-elements.com/remote-bullets-widget-for-elementor/)
3. [Remote Counter (Free)](https://unlimited-elements.com/remote-counter-widget-for-elementor/)
4. [Remote Play Pause (Free)](https://unlimited-elements.com/remote-play-pause-widget-for-elementor/)
5. [Remote Tabs (Pro)](https://unlimited-elements.com/remote-tabs-widget-for-elementor)
6. [Remote Dropdown (Pro)](https://unlimited-elements.com/remote-dropdown-widget-for-elementor/)
7. [Remote Link (Pro)](https://unlimited-elements.com/remote-link-widget-for-elementor)
8. [Remote Item Navigation (Pro)](https://unlimited-elements.com/remote-item-navigation-widget-for-elementor/)
9. [Remote Scroll (Pro)](https://unlimited-elements.com/remote-scroll-widget-for-elementor/)

### Menu Widgets for Elementor

1. [WordPress Menu (Free)](https://unlimited-elements.com/wordpress-menu-widget-for-elementor/)
2. [Fullscreen Menu (Free)](https://unlimited-elements.com/fullscreen-menu-widget-for-elementor/)
3. [List Menu (Free)](https://unlimited-elements.com/list-menu-widget-for-elementor/)
4. [Mega Menu (Pro)](https://unlimited-elements.com/mega-menu-widget-for-elementor/)
5. [Mega Menu Inner Links (Pro)](https://unlimited-elements.com/mega-menu-inner-links-widget-for-elementor/)
6. [Side Menu (Pro)](http://unlimited-elements.com/side-menu-widget-for-elementor)
7. [Liquid Full Screen Menu (Pro)](https://unlimited-elements.com/liquid-fullscreen-menu-widget-for-elementor)
8. [One Page Scroll Navigation (Pro)](https://unlimited-elements.com/one-page-scroll-navigation-widget-for-elementor)
9. [Circle Menu (Pro)](http://unlimited-elements.com/circle-menu-widget-for-elementor)
10. [Accordion Menu (Pro)](https://unlimited-elements.com/accordion-menu-widget-for-elementor)

### Content Widgets for Elementor

1. [Content Tabs (Free)](https://unlimited-elements.com/content-tabs-widget-for-elementor/)
2. [Card Carousel (Free)](https://unlimited-elements.com/card-carousel-widget-for-elementor/)
3. [Content Accordion (Free)](https://unlimited-elements.com/content-accordion-widget-for-elementor/)
4. [Simple Popup (Free)](https://unlimited-elements.com/simple-popup-widget-for-elementor/)
5. [Expanding Content Cards (Pro)](https://unlimited-elements.com/expanding-content-cards-widget-for-elementor/)
6. [Unlimited Grid (Pro)](https://unlimited-elements.com/unlimited-grid-widget-for-elementor/)
7. [Toggle Box (Pro)](https://unlimited-elements.com/toggle-box-widget-for-elementor/)
8. [Unlimited Table (Pro)](http://unlimited-elements.com/unlimited-table-widget-for-elementor/)
9. [Content Switcher (Pro)](https://unlimited-elements.com/content-switcher-widget-for-elementor/)
10. [Content Slider (Pro)](https://unlimited-elements.com/content-slider-widget-for-elementor)
11. [Unfold Content (Pro)](https://unlimited-elements.com/unfold-content-widget-for-elementor/)
12. [Overlay Carousel (Pro)](https://unlimited-elements.com/overlay-carousel-widget-for-elementor)
13. [Mega Slider (Pro)](https://unlimited-elements.com/mega-slider-widget-for-elementor/)
14. [Swipe Carousel (Pro)](https://unlimited-elements.com/swipe-carousel-widget-for-elementor/)
15. [Unlimited Carousel (Pro)](https://unlimited-elements.com/unlimited-carousel-widget-for-elementor)
16. [Material Carousel (Pro)](https://unlimited-elements.com/material-carousel-widget-for-elementor/)
17. [Icon Carousel (Pro)](https://unlimited-elements.com/icon-carousel-widget-for-elementor/)
18. [Content Grid (Pro)](https://unlimited-elements.com/content-grid-widget-for-elementor/)
19. [Coverflow Carousel (Pro)](https://unlimited-elements.com/coverflow-carousel-widget-for-elementor/)
20. [Content Carousel (Pro)](https://unlimited-elements.com/content-carousel-widget-for-elementor/)
21. [Content Ticker (Pro)](https://unlimited-elements.com/content-ticker-widget-for-elementor/)

### Media Widgets for Elementor

1. [Slider Gallery (Free)](https://unlimited-elements.com/slider-gallery-widget-for-elementor/)
2. [Tile Gallery (Free)](https://unlimited-elements.com/tile-gallery-widget-for-elementor/)
3. [Compact Gallery (Free)](https://unlimited-elements.com/compact-gallery-widget-for-elementor/)
4. [Simple Slider (Free)](https://unlimited-elements.com/simple-slider-widget-for-elementor/)
5. [Random Image (Free)](https://unlimited-elements.com/random-image-widget-for-elementor/)
6. [Grid Gallery (Pro)](https://unlimited-elements.com/grid-gallery-widget-for-elementor/)
7. [Masonry Gallery (Pro)](https://unlimited-elements.com/masonry-gallery-widget-for-elementor/)
8. [Carousel Gallery (Pro)](https://unlimited-elements.com/carousel-gallery-widget-for-elementor/)
9. [Justified Image Carousel (Pro)](https://unlimited-elements.com/justified-image-carousel-widget-for-elementor/)
10. [Thumbnail Gallery (Pro)](https://unlimited-elements.com/thumbnail-gallery-widget-for-elementor/)
11. [Audio Playlist (Pro)](https://unlimited-elements.com/audio-playlist-widget-for-elementor)
12. [Portfolio Carousel (Pro)](https://unlimited-elements.com/portfolio-carousel-widget-for-elementor/)
13. [Audio Player (Pro)](https://unlimited-elements.com/audio-player-widget-for-elementor/)
14. [Thumbnail Slider (Pro)](https://unlimited-elements.com/thumbnail-slider-widget-for-elementor/)
15. [Image and Video Slider (Pro)](https://unlimited-elements.com/image-and-video-slider-widget-for-elementor/)
16. [Video Playlist (Pro)](https://unlimited-elements.com/video-playlist-widget-for-elementor/)

### Infographic Widgets for Elementor

1. [Unlimited Timeline (Free)](https://unlimited-elements.com/unlimited-timeline-widget-for-elementor)
2. [Linear Progress Bar (Free)](https://unlimited-elements.com/linear-progress-bar-widget-for-elementor)
3. [Pie chart (Free)](https://unlimited-elements.com/pie-chart-for-elementor)
4. [Line Chart (Free)](https://unlimited-elements.com/line-chart-widget-for-elementor/)
5. [Horizontal Timeline (Pro)](https://unlimited-elements.com/horizontal-timeline-widget-for-elementor/)
6. [Unlimited Charts (Pro)](https://unlimited-elements.com/unlimited-charts-widget-for-elementor)
7. [Interactive Circle Infographic (Pro)](https://unlimited-elements.com/interactive-circle-infographic-widget-for-elementor/)
8. [Funnel & Pyramid (Pro)](https://unlimited-elements.com/funnel-pyramid-widget-for-elementor/)
9. [Step Process (Pro)](https://unlimited-elements.com/step-process-widget-for-elementor)
10. [Circle Progress Bar (Pro)](https://unlimited-elements.com/circle-progress-bar-widget-for-elementor/)
11. [Semi Circle Progress Bar (Pro)](https://unlimited-elements.com/semi-circle-progress-bar-widget-for-elementor/)
12. [Vertical Progress Bar (Pro)](https://unlimited-elements.com/vertical-progress-bar-widget-for-elementor)

### Content Boxes for Elementor

1. [Icon Box (Free)](https://unlimited-elements.com/icon-box-widget-for-elementor/)
2. [Sliding Icon Box (Free)](https://unlimited-elements.com/sliding-icon-box-widget-for-elementor/)
3. [Image Zoom Content Box (Free)](https://unlimited-elements.com/image-zoom-content-box-widget-for-elementor/)
4. [Icon Card (Free)](https://unlimited-elements.com/material-footer-card-widget-for-elementor)
5. [Image Card (Free)](https://unlimited-elements.com/image-card-content-box-widget-for-elementor/)
6. [Icon Content Box (Free)](https://unlimited-elements.com/icon-content-box-widget-for-elementor)
7. [Twist Hover Icon Box (Free)](https://unlimited-elements.com/twist-hover-icon-box-widget-for-elementor/)
8. [Content Reveal on Hover (Free)](https://unlimited-elements.com/content-reveal-on-hover-widget-for-elementor/)
9. [Icon Number Box (Free)](https://unlimited-elements.com/icon-number-box-widget-for-elementor)
10. [Icon Image Content Box (Free)](https://unlimited-elements.com/icon-image-content-box-widget-for-elementor)
11. [Animated Border Content Box (Pro)](https://unlimited-elements.com/animated-border-content-box-widget-for-elementor)
12. [Content Box Sliding Effect (Pro)](https://unlimited-elements.com/sliding-content-box-widget-for-elementor/)
13. [Content Box Overlay (Pro)](https://unlimited-elements.com/content-box-overlay-widget-for-elementor/)
14. [Icon Box Content Reveal (Pro)](https://unlimited-elements.com/content-reveal-icon-box-widget-for-elementor/)
15. [Animated Border Icon Box (Pro)](https://unlimited-elements.com/animated-border-icon-box-widget-for-elementor/)
16. [Icon Box Hover Effect (Pro)](https://unlimited-elements.com/icon-box-hover-effect-widget-for-elementor/)
17. [Caption Reveal Content Box (Pro)](https://unlimited-elements.com/caption-reveal-content-box-widget-for-elementor)
18. [Animated Icon Box (Pro)](https://unlimited-elements.com/animated-icon-box-widget-for-elementor/)
19. [Overlay Icon Box (Pro)](https://unlimited-elements.com/solid-color-overlay-icon-box-widget-for-elementor)

### Hover Effects for Elementor

1. [Rollover Image Effect (Free)](https://unlimited-elements.com/rollover-image-effect-widget-for-elementor/)
2. [Link Hover Effects (Free)](https://unlimited-elements.com/link-hover-effects/)
3. [Icon Hover Effects (Free)](https://unlimited-elements.com/icon-hover-effects-widget-for-elementor/)
4. [Creative Button Hovers (Free)](https://unlimited-elements.com/creative-button-hover-widget-for-elementor/)
5. [Caption Hover Effects (Free)](https://unlimited-elements.com/caption-hover-effects-widget-for-elementor/)
6. [Banner Hover Effects (Pro)](https://unlimited-elements.com/banner-hover-effects-widget-for-elementor/)
7. [iHover Effects (Pro)](https://unlimited-elements.com/ihover-effects-widget-for-elementor/)
8. [Border Link Hover Effects (Pro)](https://unlimited-elements.com/border-link-hover-effects-widget-for-elementor/)

### Button Widgets for Elementor

1. [Dark Mode (Free)](https://unlimited-elements.com/dark-mode-widget-for-elementor/)
2. [Rotating Social Icons (Free)](https://unlimited-elements.com/rotating-social-icon-button-widgets-for-elementor)
3. [Button Group (Free)](https://unlimited-elements.com/button-group-widget-for-elementor/)
4. [Toggle Text Button (Free)](https://unlimited-elements.com/toggle-text-button-widget-for-elementor/)
5. [Multi Line Button (Free)](https://unlimited-elements.com/multi-line-button-widget-for-elementor/)
6. [Underline Animated Button (Free)](https://unlimited-elements.com/underline-animated-button-widget-for-elementor/)
7. [Social Icons With Label (Free)](https://unlimited-elements.com/label-social-icon-button-widgets-for-elementor)
8. [Gradient Button (Free)](https://unlimited-elements.com/gradient-button-widget-for-elementor/)
9. [Overlay Button (Free)](https://unlimited-elements.com/overlay-button-widget-for-elementor/)
10. [Square to Circle Social Icons (Free)](https://unlimited-elements.com/square-to-circle-social-icon-button-widgets-for-elementor)
11. [Parallelogram Button (Free)](https://unlimited-elements.com/parellogram-button-widget-for-elementor/)
12. [3d Social Icon Buttons (Free)](https://unlimited-elements.com/3d-social-icon-buttons-widget-for-elementor)
13. [Video Play Button (Free)](https://unlimited-elements.com/video-play-button-popup-widget-for-elementor/)
14. [Scroll To Top (Free)](unlimited-elements.com/scroll-to-top-widget-for-elementor)
15. [Social Icons Glare Effect (Free)](https://unlimited-elements.com/social-icons-glare-effect-widget-for-elementor/)
16. [Glare Button Effect (Pro)](https://unlimited-elements.com/glare-effect-button-widget-for-elementor/)
17. [Gradient Hover Effect Button (Pro)](https://unlimited-elements.com/gradient-hover-effect-button-widget-for-elementor/)
18. [Button Icon Hover Effect (Pro)](https://unlimited-elements.com/icon-hover-effect-button-widget-for-elementor/)
19. [Liquid Button (Pro)](https://unlimited-elements.com/liquid-button-widget-for-elementor/)
20. [Dropdown Button (Pro)](https://unlimited-elements.com/dropdown-button-widget-for-elementor/)
21. [Social Icons With Circle Fill Effect (Pro)](https://unlimited-elements.com/circle-fill-social-icon-button-widgets-for-elementor)
22. [Border Button Effect (Pro)](https://unlimited-elements.com/border-button-effect-widget-for-elementor/)
23. [Icon Pointer Button (Pro)](https://unlimited-elements.com/icon-pointer-button-widget-for-elementor/)
24. [Simple Artistic Button (Pro)](https://unlimited-elements.com/simple-artistic-button-widget-for-elementor/)
25. [Gradient Border Button (Pro)](https://unlimited-elements.com/gradient-border-button-widget-for-elementor)
26. [Underline Link Hover Effect (Pro)](http://unlimited-elements.com/underline-link-hover-effect-widget-for-elementor)
27. [Neon Glowing Button Effect (Pro)](https://unlimited-elements.com/neon-glowing-button-effect-widget-for-elementor/)
28. [Shape Social Icons (Pro)](https://unlimited-elements.com/shapes-social-icons-widgets-for-elementor/)
29. [Christmas Button (Pro)](https://unlimited-elements.com/christmas-button-widget-for-elementor)

### Typography for Elementor

1. [Text Rotator (Free)](https://unlimited-elements.com/text-rotator-for-elementor-page-builder/)
2. [3D Text (Free)](https://unlimited-elements.com/3d-text-effect-for-elementor/)
3. [Gradient Underline Text Effect (Free)](https://unlimited-elements.com/gradient-underline-text-effect-widget-for-elementor/)
4. [Dual Color Heading (Free)](https://unlimited-elements.com/dual-color-heading-widget-for-elementor/)
5. [Stroke Text Effect (Free)](https://unlimited-elements.com/stroke-text-effect-widget-for-elementor/)
6. [Gradient Text Effect (Free)](https://unlimited-elements.com/gradient-text-effect-for-elementor/)
7. [Text Marquee Effect (Free)](https://unlimited-elements.com/text-marquee-for-elementor/)
8. [Annotation (Pro)](https://unlimited-elements.com/annotation-widget-for-elementor/)
9. [Animated Split Text (Pro)](https://unlimited-elements.com/animated-split-text-widget-for-elementor/)
10. [Scroll Text Reveal (Pro)](https://unlimited-elements.com/scroll-reveal-text-widget-for-elementor/)
11. [Futuristic Typing Text Effect (Pro)](https://unlimited-elements.com/futuristic-typing-text-effect-widget-for-elementor/)
12. [Sideways Vertical Text (Pro)](https://unlimited-elements.com/sideways-vertical-text-widget-for-elementor)
13. [Image Background Text Effect (Pro)](https://unlimited-elements.com/image-background-text-effect-widget-for-elementor/)
14. [Typewriter Text Effect (Pro)](https://unlimited-elements.com/typewriter-text-effect-for-elementor/)
15. [Side Line Heading (Pro)](https://unlimited-elements.com/side-line-heading-widget-for-elementor/)
16. [Christmas Text (Pro)](https://unlimited-elements.com/christmas-text-widget-for-elementor)

### Separators and Dividers for Elementor

1. [Unlimited Separator Divider (Free)](https://unlimited-elements.com/unlimited-separator-divider-widgets-for-elementor/)
2. [Line Diamond Separator (Free)](https://unlimited-elements.com/separator-and-dividers-widgets-for-elementor/)
3. [Line Text Divider (Free)](https://unlimited-elements.com/separator-and-dividers-widgets-for-elementor/)
4. [Triangle Separator (Pro)](https://unlimited-elements.com/separator-and-dividers-widgets-for-elementor/)
5. [Zigzag Wave Seperator (Pro)](https://unlimited-elements.com/separator-and-dividers-widgets-for-elementor/)
6. [Three Icons Separator (Pro)](https://unlimited-elements.com/separator-and-dividers-widgets-for-elementor/)
7. [Animated Wave Separator (Pro)](https://unlimited-elements.com/separator-and-dividers-widgets-for-elementor/)
8. [Christmas Candy Separator (Pro)](https://unlimited-elements.com/separator-and-dividers-widgets-for-elementor/)
9. [Christmas Lights (Pro)](https://unlimited-elements.com/christmas-lights-widget-for-elementor/)

### Hero Widgets for Elementor

1. [Title Hero (Free)](https://unlimited-elements.com/title-hero-widget-for-elementor)
2. [Box Hero (Free)](https://unlimited-elements.com/box-hero-widget-for-elementor/)
3. [Split Hero (Free)](https://unlimited-elements.com/split-hero-widget-for-elementor)
4. [Transparent Split Hero (Free)](https://unlimited-elements.com/transparent-split-hero-widget-for-elementor)
5. [Border Hero (Free)](https://unlimited-elements.com/border-hero-widget-for-elementor)
6. [Video Hero (Pro)](https://unlimited-elements.com/video-hero-widget-for-elementor/)
7. [Split Video Hero (Pro)](https://unlimited-elements.com/split-video-hero-widget-for-elementor)
8. [Diagonal Hero (Pro)](https://unlimited-elements.com/diagonal-hero-widget-for-elementor/)
9. [Quote Hero (Pro)](https://unlimited-elements.com/quote-hero-widget-for-elementor)
10. [Persona Hero (Pro)](https://unlimited-elements.com/persona-hero-widget-for-elementor)
11. [Service Box Hero (Pro)](https://unlimited-elements.com/service-box-hero-widget-for-elementor)
12. [Solid Color Hero (Pro)](https://unlimited-elements.com/solid-color-hero-widget-for-elementor)

### Background Widgets for Elementor

1. [Animated Gradient Background (Free)](https://unlimited-elements.com/animated-gradient-background-widget-for-elementor/)
2. [Bubble Float (Free)](https://unlimited-elements.com/bubble-float-background-for-elementor/)
3. [Diamond Pattern (Free)](https://unlimited-elements.com/diamond-pattern-background-for-elementor/)
4. [Clouds (Free)](https://unlimited-elements.com/clouds-background-for-elementor/)
5. [Snow Flakes Background (Free)](https://unlimited-elements.com/elementor-snow-flakes-background/)
6. [Alternating Colors (Free)](https://unlimited-elements.com/alternating-colors-background-for-elementor/)
7. [Retro Blocks (Free)](https://unlimited-elements.com/retro-blocks-background-for-elementor/)
8. [Moving Stripes (Free)](https://unlimited-elements.com/moving-stripes-elementor-background/)
9. [Wave Animation (Free)](https://unlimited-elements.com/waves-animation-background-for-elementor/)
10. [Fireworks Background (Pro)](https://unlimited-elements.com/fireworks-background-widget-for-elementor/)
11. [Confetti Background (Pro)](https://unlimited-elements.com/elementor-confetti-background/)
12. [Parallax Background (Pro)](https://unlimited-elements.com/parallax-background-widget-for-elementor/)
13. [Blob Animation (Pro)](https://unlimited-elements.com/elementor-blob-animation-background/)
14. [Animated Squares (Pro)](https://unlimited-elements.com/elementor-animated-squares-background/)
15. [Background Slider (Pro)](https://unlimited-elements.com/elementor-section-backgrounds/)
16. [Sliding Diagonals (Pro)](https://unlimited-elements.com/elementor-sliding-diagonals-background/)
17. [Particles Background (Pro)](https://unlimited-elements.com/particles-background-widget-for-elementor/)
18. [Smoke Background Effect (Pro)](https://unlimited-elements.com/smoke-background-effect-widget-for-elementor/)
19. [Snow Background (Pro)](https://unlimited-elements.com/snow-background-widget-for-elementor/)
20. [Masks & Patterns Background (Pro)](https://unlimited-elements.com/mask-and-pattern-background-widget-for-elementor/)
21. [Shooting Lights (Pro)](https://unlimited-elements.com/shooting-lights-background-for-elementor/)
22. [Bokeh (Pro)](https://unlimited-elements.com/bokeh-background-for-elementor/)
23. [Huge Shapes (Pro)](https://unlimited-elements.com/elementor-huge-shapes-background/)
24. [Random Background (Pro)](https://unlimited-elements.com/random-background-widget-for-elementor/)
25. [Morph Background Slider (Pro)](https://unlimited-elements.com/morph-background-slider-widget-for-elementor/)
26. [Animated Ripples (Pro)](https://unlimited-elements.com/animated-ripples-elementor-background/)
27. [Stars Background (Pro)](https://unlimited-elements.com/star-particles-background-for-elementor/)

### Integrations

Unlimited Elements empowers you to connect with popular integrations, streamlining your website building process. Use the tools you love by effortlessly incorporating data directly into Elementor widgets.

* ACF
* Toolset
* PODS
* Woo
* Instagram
* Google Sheets
* Google Calendar
* Google Reviews
* YouTube
* Vimeo
* Wistia
* ExchangeRate API
* OpenWeather API

### JOIN OUR GROWING COMMUNITY

* [Facebook Page](https://www.facebook.com/Unlimited-Elements-411166266392225/)
* [Youtube Channel](https://www.youtube.com/channel/UCNYLnevs1ewIxKQqPiat0xQ)
* [Facebook Group](https://www.facebook.com/groups/468327430642626/?source_id=411166266392225)
* [Support](https://unitecms.ticksy.com)

## Screenshots

* [![](https://ps.w.org/unlimited-elements-for-elementor/assets/screenshot-1.jpg?rev=3034669)](https://ps.w.org/unlimited-elements-for-elementor/assets/screenshot-1.jpg?rev=3034669)
* [![](https://ps.w.org/unlimited-elements-for-elementor/assets/screenshot-2.jpg?rev=3034669)](https://ps.w.org/unlimited-elements-for-elementor/assets/screenshot-2.jpg?rev=3034669)
* [![](https://ps.w.org/unlimited-elements-for-elementor/assets/screenshot-3.jpg?rev=3034669)](https://ps.w.org/unlimited-elements-for-elementor/assets/screenshot-3.jpg?rev=3034669)
* [![](https://ps.w.org/unlimited-elements-for-elementor/assets/screenshot-4.jpg?rev=3034669)](https://ps.w.org/unlimited-elements-for-elementor/assets/screenshot-4.jpg?rev=3034669)
* [![](https://ps.w.org/unlimited-elements-for-elementor/assets/screenshot-5.jpg?rev=3034669)](https://ps.w.org/unlimited-elements-for-elementor/assets/screenshot-5.jpg?rev=3034669)
* [![](https://ps.w.org/unlimited-elements-for-elementor/assets/screenshot-6.jpg?rev=3034669)](https://ps.w.org/unlimited-elements-for-elementor/assets/screenshot-6.jpg?rev=3034669)

## Installation

Note : This plugin works with Elementor. Make sure you have [Elementor](https://wordpress.org/plugins/elementor/) installed.

1. Upload the plugin folder to the `/wp-content/plugins/` directory, or install the plugin through the WordPress plugins screen directly.
2. Activate the plugin through the ‘Plugins’ screen in WordPress
3. Navigate to Unlimited Elements in the WordPress side menu and install the widget you want by hovering over it and clicking install.

## FAQ

### Can I use the plugin without Elementor?

No. You cannot use the plugin without Elementor since it’s an addon for Elementor.

### Does the plugin work with any theme?

Absolutely! The plugin will work with any theme where Elementor works.

### What if I update to the Premium version after using the Free version?

Your existing elements/content will work with the premium version. So you wonГўв‚¬в„ўt lose your any of your hard work.

### Can I get a refund?

If you are not happy with your purchase at anytime just contact us and we will refund 100% of your money no questions asked.

### Do you offer a renewals discount?

Yes, you get 25% discount for all annual plan automatic renewals. The renewal price will never be increased so long as the subscription is not cancelled.

### How do I install and activate the ‘Unlimited Elements for Elementor’ plugin on WordPress?

To install the ‘Unlimited Elements’ plugin on your WordPress site, access your WordPress Dashboard and go to Plugins -> Add New. In the search box, enter ‘Unlimited Elements.’ Locate the plugin in the search results and click on the ‘Install Now’ button. Once the installation is finished, click on the ‘Activate’ button, and ‘Unlimited Elements for Elementor’ will be successfully activated on your WordPress site.

### Do I need to know code to use Unlimited Elements?

No, you do not need to know code to leverage the widgets and other tools provided by the Unlimited Elements plugin. It is designed to be user-friendly, allowing you to enhance your Elementor experience without any coding expertise. However, for users familiar with code, the plugin offers the added advantage of a widget creator, enabling the creation of custom Elementor widgets for a more tailored and advanced design experience.

### Is my site secure with Unlimited Elements?

Yes, Unlimited Elements is a secure plugin. The plugin is regularly updated to adhere to common security standards, ensuring a secure environment for your website.

### What types of filters does Unlimited Elements provide?

Unlimited Elements offers a variety of filter types, including search filters, dropdowns, tabs filters, checkboxes filters, and WooCommerce-related filters, providing a diverse range of options for dynamic and versatile website filtering.

### Are the filters compatible with any post type or WooCommerce products?

Yes, all the filters provided by Unlimited Elements are live Ajax filters, ensuring dynamic and seamless filtering experiences. They are compatible with any post type, including custom post types, and WooCommerce products, offering versatile functionality for a wide range of content on your website. Utilize specific WooCommerce filters to enhance the shopping experience for your customers, such as the price range slider filter and color swatches filter for products with different colors.

### Can I use Unlimited Elements to display custom post types in my widgets?

Yes, Unlimited Elements supports showcasing custom post types with advanced query selection and seamless connection to any filter from the UE library. This allows for tailored and dynamic content presentation on your website using the plugin’s versatile features.

### What are multi-source widgets in Unlimited Elements?

Multi-source widgets in Unlimited Elements enable the population of item-based widgets with various dynamic source types. These widgets can be populated using sources like ACF repeater fields, WooCommerce products, custom post types, Instagram feeds, and various API integrations. This versatility allows for the seamless integration of diverse content into widgets, enhancing the flexibility and functionality of your website elements.

### Should I use Remote Control Widgets or the Sync Widgets function in Unlimited Elements?

The choice depends on your design preferences. If you want complete control, go for Remote Control Widgets. For synchronized layouts, choose Sync Widgets. They can also be used together for even more powerful customization options in Unlimited Elements.

## Reviews

![](https://secure.gravatar.com/avatar/fcc228f3e55b8dcfd09cb6d2e64e893d13beeb8b7f3a2bdef51f9179c7b0a5e6?s=60&d=retro&r=g)
### [Exceptional Support](https://wordpress.org/support/topic/exceptional-support-67/)

[niceegh77](https://profiles.wordpress.org/niceegh77/ "Posts by niceegh77")
January 6, 2025

I initially purchased the Unlimited Elements plugin because of its wide array of amazing widgets, which significantly enhance the design possibilities in Elementor.
While working on my new website, I encountered an issue with the Date Picker widget and reached out to their support team. I was impressed by how promptly they responded to my inquiry. However, after some communication, I learned that the widget did not include the specific functionality I needed.
To my surprise, on 02 January, right after the New Year holiday, I received an update from Denys at Unlimited Elements. He informed me that they had added the exact function I needed to the Date Picker widget! This unexpected and thoughtful update not only resolved my issue but also made my website design project achievable.
A million thanks to Denys and the Unlimited Elements team for going above and beyond. Your dedication to improving the plugin and supporting your users is truly commendable. Highly recommended!

![](https://secure.gravatar.com/avatar/6a5a154e3839a7cce3a8a9060ba7c8560cc264633bbdae3c952e78a5561dc31f?s=60&d=retro&r=g)
### [Fullscreen Menu Widget](https://wordpress.org/support/topic/fullscreen-menu-widget/)

[mstudioIL](https://profiles.wordpress.org/mstudioil/ "Posts by mstudioIL")
December 17, 2024
2 replies

I was looking for Fullscreen Menu Widget and found some other plugins, but not of them is good as yours, I will check the other widgets and hope they will also amazing

![](https://secure.gravatar.com/avatar/2a1384e3b341758b571956550bcee4c3a8a962efe1da6e9e45f7adb3f59191e8?s=60&d=retro&r=g)
### [Excellent for Custom Elementor Widgets](https://wordpress.org/support/topic/excellent-for-custom-elementor-widgets/)

[jddean123](https://profiles.wordpress.org/jddean123/ "Posts by jddean123")
December 12, 2024

This is an excellent plugin that includes a ton of included widgets that can easily extend the functionality of your WordPress site. The best part is you can modify any of these pre-made widgets to add any range of functionality you want OR build out your own custom widgets using Twig templating code.
As a developer that isn’t usually involved in the daily management of the sites, this is wonderful because I am now able to quickly build out custom widgets for my clients with easily adjustable customizability accessible by the client when editing a page/post in the Elementor editor, just like any other Elementor widget.

![](https://secure.gravatar.com/avatar/e4c17704e597efc5d385d31a9dae264d805336b85bc7b4802f5e8cb4ccf6ec28?s=60&d=retro&r=g)
### [The best elementor addition you can find on the market](https://wordpress.org/support/topic/the-best-elementor-addition-you-can-find-on-the-market/)

[Mike Masters](https://profiles.wordpress.org/eumikemasters/ "Posts by Mike Masters")
December 7, 2024

If you are a professional web designer working with elementor then this will be one of the handiest tools you will come across on the market…First, the plugin is really lightweight, and instead of including all of its features inside the initial plugin, it includes a sort of gallery (like the WordPress plugin gallery) where you can install only the widgets you need.
Then because they have a widget for every occasion and each of their widgets is highly customizable making it the perfect elementor addition, with one of the richest widget galleries for anything you may need.
Most importantly, their dev team and customer support are fast, experienced, and professional making it easy to communicate and resolve issues in times of need, especially if your delivery result depends on their widgets’ capabilities and customizability.They literally gave me a custom update for one of their widgets before everyone else got that update, so I could deliver a better result for my client, I don’t know if it can get any better than that.

![](https://secure.gravatar.com/avatar/9519d5ed3fe8f59371d3fe23cf190a9d0b4669c323909468e1b467f987e01b02?s=60&d=retro&r=g)
### [Best Widget, with even better support.](https://wordpress.org/support/topic/best-widget-with-even-better-support/)

[oreffa](https://profiles.wordpress.org/oreffa/ "Posts by oreffa")
December 5, 2024

I normally don’t write any reviews, but it would truly be a sin to not let the world know about how great the plugin is.
Moreover, the support is beyond exceptional, not only with simple things but also with further customizing the widgets.
10/10, would recommend.

![](https://secure.gravatar.com/avatar/b8f985adbd22f680a07aae3088040d9f4aec40ebe07b6e96586f8b3abb2a5201?s=60&d=retro&r=g)
### [Thank You Amit Keren!](https://wordpress.org/support/topic/thank-you-amit-keren/)

[msbfrnj](https://profiles.wordpress.org/msbfrnj/ "Posts by msbfrnj")
December 5, 2024

Thanks so much for your help!Brenda

[Read all 443 reviews](https://wordpress.org/support/plugin/unlimited-elements-for-elementor/reviews/)
## Contributors & Developers

“Unlimited Elements For Elementor” is open source software. The following people have contributed to this plugin.

Contributors

* ![](https://secure.gravatar.com/avatar/0535541050c9e077abf1ff751779374564acd829deef156c4d6de037f41673d9?s=32&d=mm&r=g) [Unlimited Elements](https://profiles.wordpress.org/unitecms/)
* ![](https://secure.gravatar.com/avatar/23af65046b5828266fdefc7f5f459693a1ef83ea34ae74f72fa5f493367001e8?s=32&d=mm&r=g) [valiano](https://profiles.wordpress.org/valiano/)
* ![](https://secure.gravatar.com/avatar/2f8ff59be5828a7df045c397757885deeda41c99b8a7bf1d8050105ce5ff41f9?s=32&d=mm&r=g) [iritmega](https://profiles.wordpress.org/iritmega/)
* ![](https://secure.gravatar.com/avatar/566dc8bcc6085b5dd38e8bbbd01df18e57d6b0f97bd00fe7f44055ad05a22618?s=32&d=mm&r=g) [amitkeren](https://profiles.wordpress.org/amitkeren/)
* ![](https://secure.gravatar.com/avatar/08e053ba5a58ed740d5a0abb8cc6d7aa430f43436ea317655249abd716959a49?s=32&d=mm&r=g) [Adarsh Pawar](https://profiles.wordpress.org/axmusic/)
* ![](https://secure.gravatar.com/avatar/a8fa402c1d48477b4ff77f381ec443b53c169a3649b3f457475fbd97cd38192e?s=32&d=mm&r=g) [Freemius](https://profiles.wordpress.org/freemius/)

“Unlimited Elements For Elementor” has been translated into 6 locales. Thank you to [the translators](https://translate.wordpress.org/projects/wp-plugins/unlimited-elements-for-elementor/contributors) for their contributions.

[Translate “Unlimited Elements For Elementor” into your language.](https://translate.wordpress.org/projects/wp-plugins/unlimited-elements-for-elementor)

### Interested in development?

[Browse the code](https://plugins.trac.wordpress.org/browser/unlimited-elements-for-elementor/), check out the [SVN repository](https://plugins.svn.wordpress.org/unlimited-elements-for-elementor/), or subscribe to the [development log](https://plugins.trac.wordpress.org/log/unlimited-elements-for-elementor/) by [RSS](https://plugins.trac.wordpress.org/log/unlimited-elements-for-elementor/?limit=100&mode=stop_on_copy&format=rss).

## Changelog

#### 1.5.135 – 2024-12-29

\*Fix: fixed small php bug in date convert function

\*Fix: fixed wp\_filesystem php bugs

#### 1.5.134 – 2024-12-27

* Fix – fixed version text display
* Change – Improved performance by dramatically reduce number of convertStdClassToArray function calls

#### 1.5.133 – 2024-12-25

* Fix: fixed a small php bug that was avoid plugin activation

#### 1.5.132 – 2024-12-22

Plugin Changes:

* Feature: added rss single settings
* Feature: added simple repeater setting
* Fix: fixed some small php bug in form submissions php file
* Fix: small php error in calendar API
* Fix: bug fix: fixed some pagination php bug

Widgets Changes:

* Feature: AJAX Search (Pro) – Added "With Type" option that allows setting a custom width for the Results element.
* Feature: Scroll Sequence (Pro) – Made the "Field of View" option responsive, allowing users to customize the setting for different devices and screen sizes, enhancing flexibility and user experience
* Feature: Post Ticker (Free) – Added "Enable Post Link In Title" option, allowing users to make the post title clickable and link it to the post.
* Feature: Border Link Hover Effects (Pro) – Added Padding option to Link elements, allowing users to adjust the space between the border and the text for better customization.
* Feature: Custom Cursor (Pro) – Created log: Added support for Elementor Popups, enabling seamless integration and functionality within popup designs.
* Feature: Before After (Pro) – Added support for Elementor Swiper Carousel, enabling seamless integration and enhanced functionality for creating advanced and customizable carousel sliders within Elementor.
* Feature: Overlay Carousel (Pro) – Added Slide Transition option, allowing users to customize the transition effects between slides for a smoother and more visually appealing experience.
* Feature: Date Field (Pro) – Added Min Date option, allowing users to set a minimum selectable date for improved date input control and validation.
* Feature: WordPress Menu (Free) – Added the "Close on Body Click" option, allowing users to configure the widget to automatically close when clicking anywhere outside of it, enhancing usability and ensuring a smoother interaction experience.
* Feature: Content Carousel (Pro) – Added the "Button Hover Style" option, providing users with the ability to customize the hover effect for buttons, allowing for greater design flexibility and improved visual interactivity.
* Change: Timer Countdown Banner (Pro) – Enhanced the banner functionality by introducing options for inline or fixed positioning, a close button with cookie support, a "Show After Scroll" feature to display the banner only after the user scrolls, and the ability to add a graphic element for improved customization.
* Fix: Team Member Carousel (Pro) – Fixed issue where the Button was not working when Source was set to Items.
* Fix: Woo Mini Cart (Pro) – Fixed issue where incrementing the product quantity in the Mini Cart widget was not working correctly in some cases.
* Fix: Stacking Cards (Pro) – Fixed issue where the Button Hover Style option was not working correctly, ensuring proper functionality and expected styling behavior.
* Fix: Creative Button Hovers (Free) – Transferred CSS styles from an external file to the general widgets CSS file. This improvement helps prevent overriding issues with other widgets and ensures better compatibility and styling consistency.
* Fix: Unlimited Google Maps (Pro) – Fixed issue where the Map widget did not display the location pin when the "Show Info Window" option was disabled.
* Fix: Toggle Dropdown (Pro) – Fixed an issue where icons were not displaying correctly.
* Fix: Content Carousel (Pro) – Fixed an issue where the "Button Hover Animation" option was not functioning correctly, ensuring smooth and consistent hover animations for buttons.
* Fix: Author List (Pro) – Fixed an issue where HTML tags were incorrectly displayed as visible text in text elements, ensuring proper rendering and a cleaner user interface.
* Fix: Step Process (Pro) – Added the "alt" attribute to images, improving accessibility and enhancing SEO compliance.

[See changelog for all versions.](https://unlimited-elements.com/change-log/)

## Meta

* Version **1.5.135**
* Last updated **2 weeks ago**
* Active installations **200,000+**
* WordPress version **3.5 or higher**
* Tested up to **6.7.1**
* Languages
  See all 7

  Close

  [Chinese (China)](https://cn.wordpress.org/plugins/unlimited-elements-for-elementor/), [Dutch](https://nl.wordpress.org/plugins/unlimited-elements-for-elementor/), [English (US)](https://wordpress.org/plugins/unlimited-elements-for-elementor/), [Italian](https://it.wordpress.org/plugins/unlimited-elements-for-elementor/), [Russian](https://ru.wordpress.org/plugins/unlimited-elements-for-elementor/), [Spanish (Chile)](https://cl.wordpress.org/plugins/unlimited-elements-for-elementor/), and [Spanish (Spain)](https://es.wordpress.org/plugins/unlimited-elements-for-elementor/).

  [Translate into your language](https://translate.wordpress.org/projects/wp-plugins/unlimited-elements-for-elementor)
* Tags [addons](https://wordpress.org/plugins/tags/addons/)[elementor](https://wordpress.org/plugins/tags/elementor/)[elementor addons](https://wordpress.org/plugins/tags/elementor-addons/)[elementor templates](https://wordpress.org/plugins/tags/elementor-templates/)[elementor widget](https://wordpress.org/plugins/tags/elementor-widget/)[elementor widgets](https://wordpress.org/plugins/tags/elementor-widgets/)[elements](https://wordpress.org/plugins/tags/elements/)
* [Advanced View](https://wordpress.org/plugins/unlimited-elements-for-elementor/advanced/)

## Ratings

4.9 out of 5 stars.

* [422 5-star reviews
  5 stars

  422](https://wordpress.org/support/plugin/unlimited-elements-for-elementor/reviews/?filter=5)
* [4 4-star reviews
  4 stars

  4](https://wordpress.org/support/plugin/unlimited-elements-for-elementor/reviews/?filter=4)
* [3 3-star reviews
  3 stars

  3](https://wordpress.org/support/plugin/unlimited-elements-for-elementor/reviews/?filter=3)
* [3 2-star reviews
  2 stars

  3](https://wordpress.org/support/plugin/unlimited-elements-for-elementor/reviews/?filter=2)
* [11 1-star reviews
  1 star

  11](https://wordpress.org/support/plugin/unlimited-elements-for-elementor/reviews/?filter=1)

[Add my review](https://wordpress.org/support/plugin/unlimited-elements-for-elementor/reviews/#new-post)

[See all reviews](https://wordpress.org/support/plugin/unlimited-elements-for-elementor/reviews/)

## Contributors

* ![](https://secure.gravatar.com/avatar/0535541050c9e077abf1ff751779374564acd829deef156c4d6de037f41673d9?s=32&d=mm&r=g) [Unlimited Elements](https://profiles.wordpress.org/unitecms/)
* ![](https://secure.gravatar.com/avatar/23af65046b5828266fdefc7f5f459693a1ef83ea34ae74f72fa5f493367001e8?s=32&d=mm&r=g) [valiano](https://profiles.wordpress.org/valiano/)
* ![](https://secure.gravatar.com/avatar/2f8ff59be5828a7df045c397757885deeda41c99b8a7bf1d8050105ce5ff41f9?s=32&d=mm&r=g) [iritmega](https://profiles.wordpress.org/iritmega/)
* ![](https://secure.gravatar.com/avatar/566dc8bcc6085b5dd38e8bbbd01df18e57d6b0f97bd00fe7f44055ad05a22618?s=32&d=mm&r=g) [amitkeren](https://profiles.wordpress.org/amitkeren/)
* ![](https://secure.gravatar.com/avatar/08e053ba5a58ed740d5a0abb8cc6d7aa430f43436ea317655249abd716959a49?s=32&d=mm&r=g) [Adarsh Pawar](https://profiles.wordpress.org/axmusic/)
* ![](https://secure.gravatar.com/avatar/a8fa402c1d48477b4ff77f381ec443b53c169a3649b3f457475fbd97cd38192e?s=32&d=mm&r=g) [Freemius](https://profiles.wordpress.org/freemius/)
## Support

Issues resolved in last two months:

9 out of 11

[View support forum](https://wordpress.org/support/plugin/unlimited-elements-for-elementor/)

## Donate

Would you like to support the advancement of this plugin?

[Donate to this plugin](http://unlimited-elements.com/)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_3acc0a6b_20250110_125921.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Unlimited Elements For Elementor (Free Widgets, Addons, Templates) <= 1.5.109 - Authenticated (Contributor+) Blind SQL Injection via data[addonID] Parameter

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Unlimited Elements For Elementor (Free Widgets, Addons, Templates) <= 1.5.109 - Authenticated (Contributor+) Blind SQL Injection via data[addonID] Parameter

8.8

**Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

| CVE | [CVE-2024-5329](https://www.cve.org/CVERecord?id=CVE-2024-5329) |
| --- | --- |
| CVSS | 8.8 (High) |
| Publicly Published | June 5, 2024 |
| Last Updated | June 6, 2024 |
| Researcher | [shaman0x01 - Shaman Red Team](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/khayal-farzaliyev) |

### Description

The Unlimited Elements For Elementor (Free Widgets, Addons, Templates) plugin for WordPress is vulnerable to blind SQL Injection via the ‘data[addonID]’ parameter in all versions up to, and including, 1.5.109 due to insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query. This makes it possible for authenticated attackers, with Contributor-level access and above, to append additional SQL queries into already existing queries that can be used to extract sensitive information from the database.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_addons.class.php#L999)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset/3097249/#file6)
* [wordpress.org](https://wordpress.org/plugins/unlimited-elements-for-elementor/#developers)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Funlimited-elements-for-elementor%2Funlimited-elements-for-elementor-free-widgets-addons-templates-15109-authenticated-contributor-blind-sql-injection-via-dataaddonid-parameter&t=Unlimited%20Elements%20For%20Elementor%20%28Free%20Widgets%2C%20Addons%2C%20Templates%29%20%3C%3D%201.5.109%20-%20Authenticated%20%28Contributor%2B%29%20Blind%20SQL%20Injection%20via%20data%5BaddonID%5D%20Parameter "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Funlimited-elements-for-elementor%2Funlimited-elements-for-elementor-free-widgets-addons-templates-15109-authenticated-contributor-blind-sql-injection-via-dataaddonid-parameter&text=Unlimited%20Elements%20For%20Elementor%20%28Free%20Widgets%2C%20Addons%2C%20Templates%29%20%3C%3D%201.5.109%20-%20Authenticated%20%28Contributor%2B%29%20Blind%20SQL%20Injection%20via%20data%5BaddonID%5D%20Parameter "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Funlimited-elements-for-elementor%2Funlimited-elements-for-elementor-free-widgets-addons-templates-15109-authenticated-contributor-blind-sql-injection-via-dataaddonid-parameter "LinkedIn")
Email

## Vulnerability Details for Unlimited Elements For Elementor

#### [Unlimited Elements For Elementor](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/unlimited-elements-for-elementor)

| Software Type | Plugin |
| --- | --- |
| Software Slug | unlimited-elements-for-elementor [(view on wordpress.org)](https://wordpress.org/plugins/unlimited-elements-for-elementor) |
| Patched? | Yes |
| Remediation | Update to version 1.5.110, or a newer patched version |
| Affected Version | * <= 1.5.109 |
| Patched Version | * 1.5.110 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from plugins.trac.wordpress.org_9dddedc0_20250110_125749.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Funlimited-elements-for-elementor%2Ftrunk%2Finc_php%2Funitecreator_addons.class.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_addons.class.php?rev=3212472 "Revision 3212472")
* Next Revision →
* [Blame](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_addons.class.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_addons.class.php)

---

# [source:](/browser?order=name "Go to repository root") [unlimited-elements-for-elementor](/browser/unlimited-elements-for-elementor?order=name "View unlimited-elements-for-elementor")/[trunk](/browser/unlimited-elements-for-elementor/trunk?order=name "View trunk")/[inc\_php](/browser/unlimited-elements-for-elementor/trunk/inc_php?order=name "View inc_php")/[unitecreator\_addons.class.php](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_addons.class.php?order=name "View unitecreator_addons.class.php")

View diff against:

View revision:

| [Last change](/changeset/3214436/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_addons.class.php "View differences") on this file was [3214436](/changeset/3214436/ "View changeset 3214436"), checked in by unitecms, [12 days ago](/timeline?from=2024-12-29T13%3A00%3A29Z&precision=second "See timeline at 12/29/2024 01:00:29 PM") |
| --- |
| update version to 1.5.135 |
| **File size:** 42.7 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\*\* |
| [3](#L3) | \* @package Unlimited Elements |
| [4](#L4) | \* @author unlimited-elements.com |
| [5](#L5) | \* @copyright (C) 2021 Unlimited Elements, All Rights Reserved. |
| [6](#L6) | \* @license GNU/GPLv3 http://www.gnu.org/licenses/gpl-3.0.html |
| [7](#L7) | \* \*/ |
| [8](#L8) | defined('UNLIMITED\_ELEMENTS\_INC') or die('Restricted access'); |
| [9](#L9) |  |
| [10](#L10) | class UniteCreatorAddons extends UniteElementsBaseUC{ |
| [11](#L11) |  |
| [12](#L12) | protected function a\_STATIC\_METHODS(){ |
| [13](#L13) | } |
| [14](#L14) |  |
| [15](#L15) | /\*\* |
| [16](#L16) | \* get addons thumbnails |
| [17](#L17) | \*/ |
| [18](#L18) | public function getArrAddonPreviewUrls($arrAddons, $keyType){ |
| [19](#L19) |  |
| [20](#L20) | $arrPreviews = array(); |
| [21](#L21) |  |
| [22](#L22) | foreach($arrAddons as $addon){ |
| [23](#L23) | switch($keyType){ |
| [24](#L24) | case "title": |
| [25](#L25) | $key = $addon->getTitle(); |
| [26](#L26) | break; |
| [27](#L27) | default: |
| [28](#L28) | $key = $addon->getName(); |
| [29](#L29) | break; |
| [30](#L30) | } |
| [31](#L31) |  |
| [32](#L32) | $urlPreview = $addon->getPreviewImageUrl(); |
| [33](#L33) |  |
| [34](#L34) | if(empty($urlPreview)) |
| [35](#L35) | continue; |
| [36](#L36) |  |
| [37](#L37) | $urlPreview = HelperUC::URLtoAssetsRelative($urlPreview); |
| [38](#L38) |  |
| [39](#L39) | $arrPreviews[$key] = $urlPreview; |
| [40](#L40) | } |
| [41](#L41) |  |
| [42](#L42) | return ($arrPreviews); |
| [43](#L43) | } |
| [44](#L44) |  |
| [45](#L45) |  |
| [46](#L46) | /\*\* |
| [47](#L47) | \* get active filter where string |
| [48](#L48) | \*/ |
| [49](#L49) | public static function getFilterActiveWhere($filterActive = null, $prefix = null, $addonType = ""){ |
| [50](#L50) |  |
| [51](#L51) | if($filterActive === null) |
| [52](#L52) | $filterActive = UniteCreatorManagerAddons::getStateFilterActive($addonType); |
| [53](#L53) |  |
| [54](#L54) | $where = ""; |
| [55](#L55) |  |
| [56](#L56) | //set active fitler where |
| [57](#L57) | switch($filterActive){ |
| [58](#L58) | case "active": |
| [59](#L59) | $where = "is\_active=1"; |
| [60](#L60) | break; |
| [61](#L61) | case "not\_active": |
| [62](#L62) | $where = "is\_active=0"; |
| [63](#L63) | break; |
| [64](#L64) | } |
| [65](#L65) |  |
| [66](#L66) | if(!empty($where) && !empty($prefix)) |
| [67](#L67) | $where = $prefix . "." . $where; |
| [68](#L68) |  |
| [69](#L69) | return ($where); |
| [70](#L70) | } |
| [71](#L71) |  |
| [72](#L72) | protected function a\_\_\_\_\_\_GETTERS\_\_\_\_\_\_\_\_\_(){ |
| [73](#L73) | } |
| [74](#L74) |  |
| [75](#L75) | /\*\* |
| [76](#L76) | \* |
| [77](#L77) | \* get items by id's |
| [78](#L78) | \*/ |
| [79](#L79) | private function getAddonsByIDs($addonIDs){ |
| [80](#L80) |  |
| [81](#L81) | $strAddons = implode(",", $addonIDs); |
| [82](#L82) |  |
| [83](#L83) | UniteFunctionsUC::validateIDsList($strAddons,"addons id's"); |
| [84](#L84) |  |
| [85](#L85) | $tableAddons = GlobalsUC::$table\_addons; |
| [86](#L86) | $sql = "select \* from {$tableAddons} where id in({$strAddons})"; |
| [87](#L87) | $arrAddons = $this->db->fetchSql($sql); |
| [88](#L88) |  |
| [89](#L89) | return ($arrAddons); |
| [90](#L90) | } |
| [91](#L91) |  |
| [92](#L92) | /\*\* |
| [93](#L93) | \* get html of categories and items. |
| [94](#L94) | \*/ |
| [95](#L95) | protected function getCatsAndAddonsHtml($catID, $type, $data = null, $parentID = null){ |
| [96](#L96) |  |
| [97](#L97) | $objManager = UniteCreatorManager::getObjManagerByAddonType($type, $data); |
| [98](#L98) |  |
| [99](#L99) | $options = array(); |
| [100](#L100) | if(!empty($parentID)) |
| [101](#L101) | $options["parent\_id"] = $parentID; |
| [102](#L102) |  |
| [103](#L103) | $response = $objManager->getCatsAndAddonsHtml($catID, "", false, $options); |
| [104](#L104) |  |
| [105](#L105) | return ($response); |
| [106](#L106) | } |
| [107](#L107) |  |
| [108](#L108) | /\*\* |
| [109](#L109) | \* |
| [110](#L110) | \* get layouts array |
| [111](#L111) | \*/ |
| [112](#L112) | public function getArrAddonsShort($order = "", $params = array(), $addonType = null){ |
| [113](#L113) |  |
| [114](#L114) | if(empty($params)) |
| [115](#L115) | $params = array(); |
| [116](#L116) |  |
| [117](#L117) | if(!empty($addonType)) |
| [118](#L118) | $params["addontype"] = $addonType; |
| [119](#L119) |  |
| [120](#L120) | $arrWhere = array(); |
| [121](#L121) |  |
| [122](#L122) | $filterNames = UniteFunctionsUC::getVal($params, "filter\_names"); |
| [123](#L123) | if(!empty($filterNames)){ |
| [124](#L124) | $strNames = "'" . implode("','", $filterNames) . "'"; |
| [125](#L125) | $arrWhere[] = "name in ($strNames)"; |
| [126](#L126) | } |
| [127](#L127) |  |
| [128](#L128) | $addonType = UniteFunctionsUC::getVal($params, "addontype"); |
| [129](#L129) |  |
| [130](#L130) | $filterActive = UniteFunctionsUC::getVal($params, "filter\_active"); |
| [131](#L131) | if(!empty($filterActive)) |
| [132](#L132) | $arrWhere[] = self::getFilterActiveWhere($filterActive, null, $addonType); |
| [133](#L133) |  |
| [134](#L134) | $arrWhere[] = $this->db->getSqlAddonType($addonType); |
| [135](#L135) |  |
| [136](#L136) | $where = ""; |
| [137](#L137) | if(!empty($arrWhere)) |
| [138](#L138) | $where = implode(" and ", $arrWhere); |
| [139](#L139) |  |
| [140](#L140) | $response = $this->db->fetch(GlobalsUc::$table\_addons, $where, $order); |
| [141](#L141) |  |
| [142](#L142) |  |
| [143](#L143) | return ($response); |
| [144](#L144) | } |
| [145](#L145) |  |
| [146](#L146) |  |
| [147](#L147) | /\*\* |
| [148](#L148) | \* get addons list with name / title |
| [149](#L149) | \*/ |
| [150](#L150) | public function getArrAddonsNameTitle($order = "", $params = array(), $addonType = null, $isAlias = false){ |
| [151](#L151) |  |
| [152](#L152) | $arrAddons = $this->getArrAddonsShort($order, $params, $addonType); |
| [153](#L153) |  |
| [154](#L154) | $field = "name"; |
| [155](#L155) | if($isAlias == true) |
| [156](#L156) | $field = "alias"; |
| [157](#L157) |  |
| [158](#L158) | $arrAssoc = UniteFunctionsUC::arrayToAssoc($arrAddons, $field, "title"); |
| [159](#L159) |  |
| [160](#L160) | return ($arrAssoc); |
| [161](#L161) | } |
| [162](#L162) |  |
| [163](#L163) | /\*\* |
| [164](#L164) | \* |
| [165](#L165) | \* get addons array |
| [166](#L166) | \*/ |
| [167](#L167) | public function getArrAddons($order = "", $params = array(), $addonType = null){ |
| [168](#L168) |  |
| [169](#L169) | if(empty($params)) |
| [170](#L170) | $params = array(); |
| [171](#L171) |  |
| [172](#L172) | $response = $this->getArrAddonsShort($order, $params, $addonType); |
| [173](#L173) |  |
| [174](#L174) | $arrAddons = array(); |
| [175](#L175) | foreach($response as $record){ |
| [176](#L176) | $objAddon = new UniteCreatorAddon(); |
| [177](#L177) | $objAddon->initByDBRecord($record); |
| [178](#L178) | $arrAddons[] = $objAddon; |
| [179](#L179) | } |
| [180](#L180) |  |
| [181](#L181) | return ($arrAddons); |
| [182](#L182) | } |
| [183](#L183) |  |
| [184](#L184) | /\*\* |
| [185](#L185) | \* |
| [186](#L186) | \* get category items |
| [187](#L187) | \*/ |
| [188](#L188) | public function getCatAddons($catID, $isShort = false, $filterActive = null, $addonType = null, $includeImages = false, $extra = array()){ |
| [189](#L189) |  |
| [190](#L190) | $arrWhere = array(); |
| [191](#L191) |  |
| [192](#L192) | if(is\_numeric($catID)) |
| [193](#L193) | $catID = (int)$catID; |
| [194](#L194) |  |
| [195](#L195) | if($catID === null) |
| [196](#L196) | $catID = "all"; |
| [197](#L197) |  |
| [198](#L198) | //get catID where |
| [199](#L199) | if($catID === "all"){ |
| [200](#L200) | $arrWhere = array(); |
| [201](#L201) | }elseif(is\_numeric($catID)){ |
| [202](#L202) | $catID = (int)$catID; |
| [203](#L203) | $arrWhere[] = "catid=$catID"; |
| [204](#L204) | }else{      //multiple - array of id's |
| [205](#L205) |  |
| [206](#L206) | if(is\_array($catID) == false) |
| [207](#L207) | UniteFunctionsUC::throwError("catIDs could be array or number"); |
| [208](#L208) |  |
| [209](#L209) | $strCats = implode(",", $catID); |
| [210](#L210) | $strCats = $this->db->escape($strCats);    //for any case |
| [211](#L211) | $arrWhere[] = "catid in($strCats)"; |
| [212](#L212) | } |
| [213](#L213) |  |
| [214](#L214) | $whereFilterActive = self::getFilterActiveWhere($filterActive, null, $addonType); |
| [215](#L215) | if(!empty($whereFilterActive)) |
| [216](#L216) | $arrWhere[] = $whereFilterActive; |
| [217](#L217) |  |
| [218](#L218) | //set addon type - if specific category - no need |
| [219](#L219) | if(is\_numeric($catID) == false || empty($catID) || $catID === "all") |
| [220](#L220) | $arrWhere[] = $this->db->getSqlAddonType($addonType); |
| [221](#L221) |  |
| [222](#L222) | $filterSearch = UniteFunctionsUC::getVal($extra, "filter\_search"); |
| [223](#L223) | $filterSearch = trim($filterSearch); |
| [224](#L224) |  |
| [225](#L225) | if(!empty($filterSearch)){ |
| [226](#L226) | $filterSearch = $this->db->escape($filterSearch); |
| [227](#L227) | $filterSearch = strtolower($filterSearch); |
| [228](#L228) |  |
| [229](#L229) | $arrWhere[] = "title like '%$filterSearch%'"; |
| [230](#L230) | } |
| [231](#L231) |  |
| [232](#L232) | $where = ""; |
| [233](#L233) | if(!empty($arrWhere)) |
| [234](#L234) | $where = implode(" and ", $arrWhere); |
| [235](#L235) |  |
| [236](#L236) | $records = $this->db->fetch(GlobalsUC::$table\_addons, $where, "catid, ordering"); |
| [237](#L237) |  |
| [238](#L238) | $arrAddons = array(); |
| [239](#L239) | foreach($records as $record){ |
| [240](#L240) | $objAddon = new UniteCreatorAddon(); |
| [241](#L241) | $objAddon->initByDBRecord($record); |
| [242](#L242) |  |
| [243](#L243) | if($isShort == true){ |
| [244](#L244) | $arrAddons[] = $objAddon->getArrShort($includeImages); |
| [245](#L245) | }else{ |
| [246](#L246) | $arrAddons[] = $objAddon; |
| [247](#L247) | } |
| [248](#L248) | } |
| [249](#L249) |  |
| [250](#L250) | return ($arrAddons); |
| [251](#L251) | } |
| [252](#L252) |  |
| [253](#L253) | /\*\* |
| [254](#L254) | \* remove non found categories |
| [255](#L255) | \* with 0 addons or if title not match |
| [256](#L256) | \*/ |
| [257](#L257) | private function getAddonsWidthCategories\_removeEmptyCats($arrCatsAssoc, $searchString){ |
| [258](#L258) |  |
| [259](#L259) | if(empty($searchString)) |
| [260](#L260) | return ($arrCatsAssoc); |
| [261](#L261) |  |
| [262](#L262) | foreach($arrCatsAssoc as $catTitle => $arrCat){ |
| [263](#L263) | $isTitleMatch = UniteFunctionsUC::isStringContains($catTitle, $searchString); |
| [264](#L264) | $arrAddons = UniteFunctionsUC::getVal($arrCat, "addons"); |
| [265](#L265) |  |
| [266](#L266) | if(empty($arrAddons)) |
| [267](#L267) | $arrAddons = array(); |
| [268](#L268) |  |
| [269](#L269) | $numAddons = count($arrAddons); |
| [270](#L270) |  |
| [271](#L271) | if($numAddons == 0 && $isTitleMatch == false) |
| [272](#L272) | unset($arrCatsAssoc[$catTitle]); |
| [273](#L273) | } |
| [274](#L274) |  |
| [275](#L275) | return ($arrCatsAssoc); |
| [276](#L276) | } |
| [277](#L277) |  |
| [278](#L278) | /\*\* |
| [279](#L279) | \* get addons by categories |
| [280](#L280) | \* $publishedCatOnly - get only from published ones |
| [281](#L281) | \*/ |
| [282](#L282) | public function getAddonsWidthCategories($publishedCatOnly = true, $isShort = false, $type = "", $extra = null){ |
| [283](#L283) |  |
| [284](#L284) | $getCatObjects = UniteFunctionsUC::getVal($extra, "get\_cat\_objects"); |
| [285](#L285) | $getCatObjects = UniteFunctionsUC::strToBool($getCatObjects); |
| [286](#L286) |  |
| [287](#L287) | $objCats = new UniteCreatorCategories(); |
| [288](#L288) |  |
| [289](#L289) | if($getCatObjects == true) |
| [290](#L290) | $arrCats = $objCats->getCatRecordsWithAddType("uncategorized", $type); |
| [291](#L291) | else |
| [292](#L292) | $arrCats = $objCats->getCatsShort("uncategorized", $type); |
| [293](#L293) |  |
| [294](#L294) | $arrIDs = array\_keys($arrCats); |
| [295](#L295) |  |
| [296](#L296) | $arrCatsAssoc = array(); |
| [297](#L297) |  |
| [298](#L298) | //prepare structure |
| [299](#L299) | foreach($arrCats as $catID => $record){ |
| [300](#L300) | //if it's record |
| [301](#L301) | if(is\_array($record)) |
| [302](#L302) | $title = $record["title"]; |
| [303](#L303) | else |
| [304](#L304) | $title = $record; |
| [305](#L305) |  |
| [306](#L306) | $cat = array(); |
| [307](#L307) | $cat["id"] = $catID; |
| [308](#L308) | $cat["title"] = $title; |
| [309](#L309) | $cat["type"] = $type; |
| [310](#L310) |  |
| [311](#L311) | //add cat object |
| [312](#L312) | if($getCatObjects == true && !empty($catID)){ |
| [313](#L313) | $objCat = new UniteCreatorCategory(); |
| [314](#L314) | $objCat->initByRecord($record); |
| [315](#L315) | $cat["objcat"] = $objCat; |
| [316](#L316) | } |
| [317](#L317) |  |
| [318](#L318) | $cat["addons"] = array(); |
| [319](#L319) |  |
| [320](#L320) | $arrCatsAssoc[$title] = $cat; |
| [321](#L321) | } |
| [322](#L322) |  |
| [323](#L323) | $filterActive = null; |
| [324](#L324) | if($publishedCatOnly == true) |
| [325](#L325) | $filterActive = "active"; |
| [326](#L326) |  |
| [327](#L327) | $arrAdons = array(); |
| [328](#L328) | if(!empty($arrCatsAssoc)) |
| [329](#L329) | $arrAdons = $this->getCatAddons(null, false, $filterActive, $type, false, $extra); |
| [330](#L330) |  |
| [331](#L331) | //put addons to category |
| [332](#L332) | foreach($arrAdons as $addon){ |
| [333](#L333) | $addonCatTitle = $addon->getCatTitle(); |
| [334](#L334) | $addonCatID = $addon->getCatID(); |
| [335](#L335) |  |
| [336](#L336) | $addonCatID = (int)$addonCatID; |
| [337](#L337) |  |
| [338](#L338) | $name = $addon->getName(); |
| [339](#L339) |  |
| [340](#L340) | if($isShort == true){ |
| [341](#L341) | $addonForInsert = $addon->getArrShort(true); |
| [342](#L342) | $addonForInsert["name"] = $addon->getNameByType(); |
| [343](#L343) | }else |
| [344](#L344) | $addonForInsert = $addon; |
| [345](#L345) |  |
| [346](#L346) | $insertKey = $addonCatTitle; |
| [347](#L347) | if($addonCatID === 0) |
| [348](#L348) | $insertKey = HelperUC::getText("uncategorized"); |
| [349](#L349) |  |
| [350](#L350) | //skip addons without category |
| [351](#L351) | if(empty($insertKey)) |
| [352](#L352) | continue; |
| [353](#L353) |  |
| [354](#L354) | $arrCatsAssoc[$insertKey]["addons"][$name] = $addonForInsert; |
| [355](#L355) | } |
| [356](#L356) |  |
| [357](#L357) | //in case of search, filter empty categories |
| [358](#L358) | $filterSearch = UniteFunctionsUC::getVal($extra, "filter\_search"); |
| [359](#L359) | if(!empty($filterSearch)) |
| [360](#L360) | $arrCatsAssoc = $this->getAddonsWidthCategories\_removeEmptyCats($arrCatsAssoc, $filterSearch); |
| [361](#L361) |  |
| [362](#L362) | return ($arrCatsAssoc); |
| [363](#L363) | } |
| [364](#L364) |  |
| [365](#L365) | /\*\* |
| [366](#L366) | \* get addons with categories by comfortable format |
| [367](#L367) | \*/ |
| [368](#L368) | public function getAddonsWidthCategoriesShort($publishedCatOnly = true, $type = ""){ |
| [369](#L369) |  |
| [370](#L370) | $arrCats = $this->getAddonsWidthCategories($publishedCatOnly, true, $type); |
| [371](#L371) |  |
| [372](#L372) | return $arrCats; |
| [373](#L373) | } |
| [374](#L374) |  |
| [375](#L375) | /\*\* |
| [376](#L376) | \* check if addon exists by name |
| [377](#L377) | \*/ |
| [378](#L378) | public function isAddonExistsByName($name, $addonType = null){ |
| [379](#L379) |  |
| [380](#L380) | $name = $this->db->escape($name); |
| [381](#L381) |  |
| [382](#L382) | if(empty($addonType)) |
| [383](#L383) | $where = "name='{$name}'"; |
| [384](#L384) | else{ |
| [385](#L385) | $where = "alias='{$name}'"; |
| [386](#L386) | $where .= " and " . $this->db->getSqlAddonType($addonType); |
| [387](#L387) | } |
| [388](#L388) |  |
| [389](#L389) | $response = $this->db->fetch(GlobalsUC::$table\_addons, $where); |
| [390](#L390) |  |
| [391](#L391) | return (!empty($response)); |
| [392](#L392) | } |
| [393](#L393) |  |
| [394](#L394) | /\*\* |
| [395](#L395) | \* get addon type from data |
| [396](#L396) | \*/ |
| [397](#L397) | public function getAddonTypeFromData($data){ |
| [398](#L398) |  |
| [399](#L399) | $type = UniteFunctionsUC::getVal($data, "addontype"); |
| [400](#L400) |  |
| [401](#L401) | if(empty($type)) |
| [402](#L402) | $type = UniteFunctionsUC::getVal($data, "type"); |
| [403](#L403) |  |
| [404](#L404) | HelperUC::runProviderFunc("validateDataAddonsType", $type, $data); |
| [405](#L405) |  |
| [406](#L406) | return ($type); |
| [407](#L407) | } |
| [408](#L408) |  |
| [409](#L409) | /\*\* |
| [410](#L410) | \* |
| [411](#L411) | \* get max order from categories list |
| [412](#L412) | \*/ |
| [413](#L413) | public function getMaxOrder($catID){ |
| [414](#L414) |  |
| [415](#L415) | UniteFunctionsUC::validateNotEmpty($catID, "category id"); |
| [416](#L416) |  |
| [417](#L417) | UniteFunctionsUC::validateNumeric($catID, "category id"); |
| [418](#L418) |  |
| [419](#L419) | $tableAddons = GlobalsUC::$table\_addons; |
| [420](#L420) | $query = "select MAX(ordering) as maxorder from {$tableAddons} where catid={$catID}"; |
| [421](#L421) |  |
| [422](#L422) | $rows = $this->db->fetchSql($query); |
| [423](#L423) |  |
| [424](#L424) | $maxOrder = 0; |
| [425](#L425) | if(count($rows) > 0) |
| [426](#L426) | $maxOrder = $rows[0]["maxorder"]; |
| [427](#L427) |  |
| [428](#L428) | if(!is\_numeric($maxOrder)) |
| [429](#L429) | $maxOrder = 0; |
| [430](#L430) |  |
| [431](#L431) | return ($maxOrder); |
| [432](#L432) | } |
| [433](#L433) |  |
| [434](#L434) | /\*\* |
| [435](#L435) | \* get number of addons by category |
| [436](#L436) | \*/ |
| [437](#L437) | public function getNumAddons($catID = null, $filterActive = null, UniteCreatorAddonType $objTypeName = null){ |
| [438](#L438) |  |
| [439](#L439) | $tableAddons = GlobalsUC::$table\_addons; |
| [440](#L440) | $addonType = $objTypeName->typeName; |
| [441](#L441) |  |
| [442](#L442) | $arrWhere = array(); |
| [443](#L443) | if(!empty($filterActive)){ |
| [444](#L444) | $whereActive = self::getFilterActiveWhere($filterActive, "a", $addonType); |
| [445](#L445) | if(!empty($whereActive)) |
| [446](#L446) | $arrWhere[] = $whereActive; |
| [447](#L447) | } |
| [448](#L448) |  |
| [449](#L449) | if($objTypeName->isBasicType == true) |
| [450](#L450) | $addonType = null; |
| [451](#L451) |  |
| [452](#L452) | $arrWhere[] = $this->db->getSqlAddonType($addonType); |
| [453](#L453) |  |
| [454](#L454) | //all addons |
| [455](#L455) | if($catID === null){ |
| [456](#L456) | $query = "select count(\*) as num\_addons from {$tableAddons}"; |
| [457](#L457) | }else{ |
| [458](#L458) |  |
| [459](#L459) | UniteFunctionsUC::validateNumeric($catID,"Category ID"); |
| [460](#L460) |  |
| [461](#L461) | $query = "select count(\*) as num\_addons from {$tableAddons} as a"; |
| [462](#L462) | $arrWhere[] = "a.catid=$catID"; |
| [463](#L463) | } |
| [464](#L464) |  |
| [465](#L465) | if(!empty($arrWhere)) |
| [466](#L466) | $query .= " where " . implode(" and ", $arrWhere); |
| [467](#L467) |  |
| [468](#L468) | $response = $this->db->fetchSql($query); |
| [469](#L469) |  |
| [470](#L470) | if(empty($response)) |
| [471](#L471) | UniteFunctionsUC::throwError("Can't get number of zero addons"); |
| [472](#L472) |  |
| [473](#L473) | $numAddons = $response[0]["num\_addons"]; |
| [474](#L474) |  |
| [475](#L475) | return ($numAddons); |
| [476](#L476) | } |
| [477](#L477) |  |
| [478](#L478) | /\*\* |
| [479](#L479) | \* get addon output, for the editor |
| [480](#L480) | \*/ |
| [481](#L481) | public function getAddonOutput($objAddon, $options = array()){ |
| [482](#L482) |  |
| [483](#L483) | $isWrap = UniteFunctionsUC::getVal($options, "wrap", false); |
| [484](#L484) | $includeSelectors = UniteFunctionsUC::getVal($options, "selectors", false); |
| [485](#L485) | $rootId = UniteFunctionsUC::getVal($options, "root\_id"); |
| [486](#L486) |  |
| [487](#L487) | $params = array( |
| [488](#L488) | "wrap\_js\_timeout" => $isWrap, |
| [489](#L489) | "add\_selectors\_css" => $includeSelectors, |
| [490](#L490) | "root\_id" => $rootId, |
| [491](#L491) | ); |
| [492](#L492) |  |
| [493](#L493) | $cacheOutput = false; |
| [494](#L494) | if(GlobalsProviderUC::$isInsideEditor == true) |
| [495](#L495) | $cacheOutput = true; |
| [496](#L496) |  |
| [497](#L497) | if($cacheOutput == true){ |
| [498](#L498) | UniteFunctionsUC::obStart(); |
| [499](#L499) | } |
| [500](#L500) |  |
| [501](#L501) | $objOutput = new UniteCreatorOutput(); |
| [502](#L502) | $objOutput->setProcessType(UniteCreatorParamsProcessor::PROCESS\_TYPE\_OUTPUT\_BACK); |
| [503](#L503) | $objOutput->checkOutputDebug($objAddon); |
| [504](#L504) | $objOutput->initByAddon($objAddon); |
| [505](#L505) |  |
| [506](#L506) | $htmlBefore = null; |
| [507](#L507) |  |
| [508](#L508) | if($cacheOutput == true){ |
| [509](#L509) | $htmlBefore = ob\_get\_contents(); |
| [510](#L510) | ob\_end\_clean(); |
| [511](#L511) | } |
| [512](#L512) |  |
| [513](#L513) | $html = $objOutput->getHtmlBody(true, false, true, $params); |
| [514](#L514) |  |
| [515](#L515) |  |
| [516](#L516) | if(!empty($htmlBefore)){ |
| [517](#L517) | $html = $htmlBefore.$html; |
| [518](#L518) | } |
| [519](#L519) |  |
| [520](#L520) | $includes = $objOutput->getProcessedIncludes(true); |
| [521](#L521) | $outputId = $objOutput->getWidgetID(); |
| [522](#L522) |  |
| [523](#L523) | $arr = array(); |
| [524](#L524) | $arr["html"] = $html; |
| [525](#L525) | $arr["includes"] = $includes; |
| [526](#L526) |  |
| [527](#L527) | if($includeSelectors === true) |
| [528](#L528) | $arr["output\_id"] = $outputId; |
| [529](#L529) |  |
| [530](#L530) | return $arr; |
| [531](#L531) | } |
| [532](#L532) |  |
| [533](#L533) | /\*\* |
| [534](#L534) | \* check addon global variables |
| [535](#L535) | \*/ |
| [536](#L536) | private function checkInitAddonGlobalVars($addonData){ |
| [537](#L537) |  |
| [538](#L538) | //set edit mode |
| [539](#L539) | $source = UniteFunctionsUC::getVal($addonData, "source"); |
| [540](#L540) | if($source == "editor") |
| [541](#L541) | GlobalsProviderUC::$isInsideEditor = true; |
| [542](#L542) |  |
| [543](#L543) | $platform = UniteFunctionsUC::getVal($addonData, "platform"); |
| [544](#L544) | if($platform == "gutenberg") |
| [545](#L545) | GlobalsProviderUC::$renderPlatform = GlobalsProviderUC::RENDER\_PLATFORM\_GUTENBERG; |
| [546](#L546) |  |
| [547](#L547) | } |
| [548](#L548) |  |
| [549](#L549) |  |
| [550](#L550) | /\*\* |
| [551](#L551) | \* get addon output data |
| [552](#L552) | \*/ |
| [553](#L553) | public function getAddonOutputData($addonData, $isWrap = false){ |
| [554](#L554) |  |
| [555](#L555) | $this->checkInitAddonGlobalVars($addonData); |
| [556](#L556) |  |
| [557](#L557) | $objAddon = $this->prepareAddonByData($addonData, true); |
| [558](#L558) |  |
| [559](#L559) | $rootId = UniteFunctionsUC::getVal($addonData, "root\_id"); |
| [560](#L560) | $includeSelectors = UniteFunctionsUC::getVal($addonData, "selectors"); |
| [561](#L561) | $includeSelectors = UniteFunctionsUC::strToBool($includeSelectors); |
| [562](#L562) |  |
| [563](#L563) | $outputOptions = array( |
| [564](#L564) | "root\_id" => $rootId, |
| [565](#L565) | "selectors" => $includeSelectors, |
| [566](#L566) | "wrap"=>$isWrap |
| [567](#L567) | ); |
| [568](#L568) |  |
| [569](#L569) | $output = $this->getAddonOutput($objAddon, $outputOptions); |
| [570](#L570) |  |
| [571](#L571) | return($output); |
| [572](#L572) | } |
| [573](#L573) |  |
| [574](#L574) |  |
| [575](#L575) | /\*\* |
| [576](#L576) | \* get addon config html by data |
| [577](#L577) | \*/ |
| [578](#L578) | public function getAddonConfigHTML($data){ |
| [579](#L579) |  |
| [580](#L580) | $objAddon = $this->initAddonByData($data); |
| [581](#L581) |  |
| [582](#L582) | //init addon config |
| [583](#L583) | $addonConfig = new UniteCreatorAddonConfig(); |
| [584](#L584) | $addonConfig->setStartAddon($objAddon); |
| [585](#L585) |  |
| [586](#L586) | $html = $addonConfig->getHtmlFrame(); |
| [587](#L587) |  |
| [588](#L588) | $response = array(); |
| [589](#L589) | $response["html\_config"] = $html; |
| [590](#L590) |  |
| [591](#L591) | //get output data on live mode |
| [592](#L592) | $getOutputData = UniteFunctionsUC::getVal($data, "getcontent"); |
| [593](#L593) | $getOutputData = UniteFunctionsUC::strToBool($getOutputData); |
| [594](#L594) | if($getOutputData == true){ |
| [595](#L595) | $outputData = $this->getLayoutAddonOutputData($data); |
| [596](#L596) | $response["output"] = $outputData; |
| [597](#L597) | } |
| [598](#L598) |  |
| [599](#L599) | return ($response); |
| [600](#L600) | } |
| [601](#L601) |  |
| [602](#L602) | /\*\* |
| [603](#L603) | \* get item settings html |
| [604](#L604) | \*/ |
| [605](#L605) | public function getAddonSettingsHTMLFromData($data){ |
| [606](#L606) |  |
| [607](#L607) | $this->checkInitAddonGlobalVars($data); |
| [608](#L608) |  |
| [609](#L609) | $objAddon = $this->initAddonByData($data); |
| [610](#L610) |  |
| [611](#L611) | //remember the addon for use inside the settings classes (used for multisource) |
| [612](#L612) | GlobalsProviderUC::$activeAddonForSettings = $objAddon; |
| [613](#L613) |  |
| [614](#L614) | $html = $objAddon->getHtmlConfig(false, true); |
| [615](#L615) |  |
| [616](#L616) | return ($html); |
| [617](#L617) | } |
| [618](#L618) |  |
| [619](#L619) | /\*\* |
| [620](#L620) | \* get addon editor data |
| [621](#L621) | \* including addon config, and output if needed |
| [622](#L622) | \*/ |
| [623](#L623) | public function getAddonEditorData($data){ |
| [624](#L624) |  |
| [625](#L625) | $objAddon = $this->initAddonByData($data); |
| [626](#L626) |  |
| [627](#L627) | $addonType = $objAddon->getType(); |
| [628](#L628) |  |
| [629](#L629) | $arrData = array(); |
| [630](#L630) | $arrData["addontype"] = $addonType; |
| [631](#L631) | $arrData["name"] = $objAddon->getName(); |
| [632](#L632) |  |
| [633](#L633) | $arrExtra = array(); |
| [634](#L634) | $arrExtra["title"] = $objAddon->getTitle(); |
| [635](#L635) | $arrExtra["url\_icon"] = $objAddon->getUrlIcon(); |
| [636](#L636) | $arrExtra["admin\_labels"] = $objAddon->getAdminLabels(); |
| [637](#L637) | $arrExtra["has\_items"] = $objAddon->isHasItems(); |
| [638](#L638) | $arrExtra["num\_items"] = $objAddon->getNumItems(); |
| [639](#L639) | $arrExtra["id"] = $objAddon->getID(); |
| [640](#L640) |  |
| [641](#L641) | $objAddon->setIsInsideGrid(); |
| [642](#L642) | $arrExtra["html\_settings"] = $objAddon->getHtmlConfig(false, true); |
| [643](#L643) |  |
| [644](#L644) | $arrData["extra"] = $arrExtra; |
| [645](#L645) |  |
| [646](#L646) | $returnOutput = UniteFunctionsUC::getVal($data, "return\_output"); |
| [647](#L647) | $returnOutput = UniteFunctionsUC::strToBool($returnOutput); |
| [648](#L648) | if($returnOutput == true){ |
| [649](#L649) | $objLayoutOutput = new UniteCreatorLayoutOutput(); |
| [650](#L650) | $objLayoutOutput->setAddonType($addonType); |
| [651](#L651) | $arrData["output"] = $objLayoutOutput->getAddonOutput($objAddon); |
| [652](#L652) | } |
| [653](#L653) |  |
| [654](#L654) | return ($arrData); |
| [655](#L655) | } |
| [656](#L656) |  |
| [657](#L657) | /\*\* |
| [658](#L658) | \* get item settings html |
| [659](#L659) | \*/ |
| [660](#L660) | public function getAddonItemsSettingsHTMLFromData($data){ |
| [661](#L661) |  |
| [662](#L662) | $addonID = UniteFunctionsUC::getVal($data, "addonid"); |
| [663](#L663) |  |
| [664](#L664) | $addon = new UniteCreatorAddon(); |
| [665](#L665) | $addon->initByID($addonID); |
| [666](#L666) |  |
| [667](#L667) | $html = $addon->getHtmlItemConfig(); |
| [668](#L668) |  |
| [669](#L669) | return ($html); |
| [670](#L670) | } |
| [671](#L671) |  |
| [672](#L672) | /\*\* |
| [673](#L673) | \* check if needed helper editor on admin addon output |
| [674](#L674) | \*/ |
| [675](#L675) | public function isHelperEditorNeeded(UniteCreatorAddon $addon){ |
| [676](#L676) |  |
| [677](#L677) | $hasItems = $addon->isHasItems(); |
| [678](#L678) | if($hasItems == false) |
| [679](#L679) | return (false); |
| [680](#L680) |  |
| [681](#L681) | $isItemsEditorExists = $addon->isEditorItemsAttributeExists(); |
| [682](#L682) | if($isItemsEditorExists == false) |
| [683](#L683) | return (false); |
| [684](#L684) |  |
| [685](#L685) | $isMainEditorExists = $addon->isEditorMainAttributeExists(); |
| [686](#L686) | if($isMainEditorExists == true) |
| [687](#L687) | return (false); |
| [688](#L688) |  |
| [689](#L689) | return (true); |
| [690](#L690) | } |
| [691](#L691) |  |
| [692](#L692) | /\*\* |
| [693](#L693) | \* prepare addon by data |
| [694](#L694) | \*/ |
| [695](#L695) | public function prepareAddonByData($addonData, $isForOutput = false){ |
| [696](#L696) |  |
| [697](#L697) | $addonName = UniteFunctionsUC::getVal($addonData, "name"); |
| [698](#L698) | $addonType = UniteFunctionsUC::getVal($addonData, "addontype"); |
| [699](#L699) |  |
| [700](#L700) | $addonID = UniteFunctionsUC::getVal($addonData, "id"); |
| [701](#L701) |  |
| [702](#L702) | //init addon |
| [703](#L703) | $objAddon = new UniteCreatorAddon(); |
| [704](#L704) |  |
| [705](#L705) | if(empty($addonName) && !empty($addonID) && is\_numeric($addonID)){ |
| [706](#L706) | //  init by id |
| [707](#L707) |  |
| [708](#L708) | $objAddon->initByID($addonID); |
| [709](#L709) | }else{ |
| [710](#L710) | //  init by name or alias and type |
| [711](#L711) |  |
| [712](#L712) | if(empty($addonType)) |
| [713](#L713) | $objAddon->initByName($addonName); |
| [714](#L714) | else |
| [715](#L715) | $objAddon->initByAlias($addonName, $addonType); |
| [716](#L716) | } |
| [717](#L717) |  |
| [718](#L718) | $elementorSettings = UniteFunctionsUC::getVal($addonData, "elementor\_settings"); |
| [719](#L719) |  |
| [720](#L720) | //init by elementor settings |
| [721](#L721) | if(!empty($elementorSettings)){ |
| [722](#L722) | $objIntegrate = new UniteCreatorElementorIntegrate(); |
| [723](#L723) | $objIntegrate->includePluginFiles(); |
| [724](#L724) |  |
| [725](#L725) | $objWidget = new UniteCreatorElementorBackgroundWidget(); |
| [726](#L726) |  |
| [727](#L727) | $objAddon = $objWidget->setAddonSettingsFromElementorSettings($objAddon, $elementorSettings); |
| [728](#L728) | }else{    //init by blox settings |
| [729](#L729) |  |
| [730](#L730) | $arrSettings = UniteFunctionsUC::getVal($addonData, "settings"); |
| [731](#L731) |  |
| [732](#L732) | if(is\_string($arrSettings)) |
| [733](#L733) | $arrSettings = UniteFunctionsUC::decodeContent($arrSettings); |
| [734](#L734) |  |
| [735](#L735) | if(!empty($arrSettings)){ |
| [736](#L736) |  |
| [737](#L737) | if(isset($arrSettings["uc\_items"])){ |
| [738](#L738) |  |
| [739](#L739) | $arrItems = UniteFunctionsUC::getVal($arrSettings, "uc\_items"); |
| [740](#L740) | if(empty($arrItems)) |
| [741](#L741) | $arrItems = array(); |
| [742](#L742) |  |
| [743](#L743) | $objAddon->setArrItems($arrItems); |
| [744](#L744) |  |
| [745](#L745) | unset($arrSettings["uc\_items"]); |
| [746](#L746) | } |
| [747](#L747) |  |
| [748](#L748) | $objAddon->setParamsValues($arrSettings); |
| [749](#L749) | }else{ |
| [750](#L750) | //set addon data |
| [751](#L751) | $arrConfig = UniteFunctionsUC::getVal($addonData, "config"); |
| [752](#L752) | if(!empty($arrConfig)) |
| [753](#L753) | $objAddon->setParamsValues($arrConfig); |
| [754](#L754) |  |
| [755](#L755) | $arrItems = UniteFunctionsUC::getVal($addonData, "items"); |
| [756](#L756) | if(!empty($arrItems)) |
| [757](#L757) | $objAddon->setArrItems($arrItems); |
| [758](#L758) |  |
| [759](#L759) | $arrFonts = UniteFunctionsUC::getVal($addonData, "fonts"); |
| [760](#L760) | if(!empty($arrFonts)) |
| [761](#L761) | $objAddon->setArrFonts($arrFonts); |
| [762](#L762) | } |
| [763](#L763) | } |
| [764](#L764) |  |
| [765](#L765) | return ($objAddon); |
| [766](#L766) | } |
| [767](#L767) |  |
| [768](#L768) | protected function a\_\_\_\_\_\_\_\_\_\_\_\_SETTERS\_\_\_\_\_\_\_\_\_\_(){ |
| [769](#L769) | } |
| [770](#L770) |  |
| [771](#L771) | /\*\* |
| [772](#L772) | \* |
| [773](#L773) | \* delete addons |
| [774](#L774) | \*/ |
| [775](#L775) | private function deleteAddons($arrAddons){ |
| [776](#L776) |  |
| [777](#L777) | //sanitize |
| [778](#L778) | $addons = array(); |
| [779](#L779) |  |
| [780](#L780) | foreach($arrAddons as $key => $addonID){ |
| [781](#L781) |  |
| [782](#L782) | $addon = new UniteCreatorAddon(); |
| [783](#L783) | $addon->initByID($addonID); |
| [784](#L784) |  |
| [785](#L785) | $addons[] = $addon; |
| [786](#L786) | $arrAddons[$key] = $addon->getID(); |
| [787](#L787) | } |
| [788](#L788) |  |
| [789](#L789) | UniteProviderFunctionsUC::doAction("uc\_before\_delete\_widgets", $arrAddons); |
| [790](#L790) |  |
| [791](#L791) | $strAddonIDs = implode(",", $arrAddons); |
| [792](#L792) | $this->db->delete(GlobalsUC::$table\_addons, "id in($strAddonIDs)"); |
| [793](#L793) |  |
| [794](#L794) | foreach($addons as $addon){ |
| [795](#L795) | $addon->triggerAfterDeleteAction(); |
| [796](#L796) | } |
| [797](#L797) | } |
| [798](#L798) |  |
| [799](#L799) | /\*\* |
| [800](#L800) | \* |
| [801](#L801) | \* save items order |
| [802](#L802) | \*/ |
| [803](#L803) | private function saveAddonsOrder($arrAddonIDs){ |
| [804](#L804) |  |
| [805](#L805) | //get items assoc |
| [806](#L806) | $arrAddons = $this->getAddonsByIDs($arrAddonIDs); |
| [807](#L807) | $arrAddons = UniteFunctionsUC::arrayToAssoc($arrAddons, "id"); |
| [808](#L808) |  |
| [809](#L809) | $order = 0; |
| [810](#L810) | foreach($arrAddonIDs as $addonID){ |
| [811](#L811) | $order++; |
| [812](#L812) |  |
| [813](#L813) | $arrAddon = UniteFunctionsUC::getVal($arrAddons, $addonID); |
| [814](#L814) | if(!empty($arrAddon) && $arrAddon["ordering"] == $order) |
| [815](#L815) | continue; |
| [816](#L816) |  |
| [817](#L817) | $arrUpdate = array(); |
| [818](#L818) | $arrUpdate["ordering"] = $order; |
| [819](#L819) | $this->db->update(GlobalsUC::$table\_addons, $arrUpdate, array("id" => $addonID)); |
| [820](#L820) |  |
| [821](#L821) | } |
| [822](#L822) | } |
| [823](#L823) |  |
| [824](#L824) | /\*\* |
| [825](#L825) | \* |
| [826](#L826) | \* copy items to some category |
| [827](#L827) | \*/ |
| [828](#L828) | private function copyAddons($arrAddonIDs, $catID){ |
| [829](#L829) |  |
| [830](#L830) | $category = new UniteCreatorCategories(); |
| [831](#L831) | $category->validateCatExist($catID); |
| [832](#L832) |  |
| [833](#L833) | foreach($arrAddonIDs as $addonID){ |
| [834](#L834) | $this->copyAddon($addonID, $catID); |
| [835](#L835) | } |
| [836](#L836) | } |
| [837](#L837) |  |
| [838](#L838) | /\*\* |
| [839](#L839) | \* migrate addons from some type to blox |
| [840](#L840) | \* copy the addon, skip if exists, remove the type |
| [841](#L841) | \*/ |
| [842](#L842) | public function migrateAddonsFromType($addonType){ |
| [843](#L843) |  |
| [844](#L844) | dmp("migrate function disabled"); |
| [845](#L845) | exit(); |
| [846](#L846) |  |
| [847](#L847) | if(empty($addonType)) |
| [848](#L848) | return (false); |
| [849](#L849) |  |
| [850](#L850) | $arrAddons = $this->getArrAddons("", array(), $addonType); |
| [851](#L851) |  |
| [852](#L852) | foreach($arrAddons as $addon){ |
| [853](#L853) | $alias = $addon->getAlias(); |
| [854](#L854) | if(empty($alias)) |
| [855](#L855) | continue; |
| [856](#L856) |  |
| [857](#L857) | $title = $addon->getTitle(); |
| [858](#L858) |  |
| [859](#L859) | $isExists = $this->isAddonExistsByName($alias); |
| [860](#L860) | if($isExists == true) |
| [861](#L861) | continue; |
| [862](#L862) |  |
| [863](#L863) | $duplicatedID = $addon->duplicate(); |
| [864](#L864) | if(empty($duplicatedID)) |
| [865](#L865) | continue; |
| [866](#L866) |  |
| [867](#L867) | $addonDuplicated = new UniteCreatorAddon(); |
| [868](#L868) | $addonDuplicated->initByID($duplicatedID); |
| [869](#L869) | $addonDuplicated->convertToType(GlobalsUC::ADDON\_TYPE\_REGULAR\_ADDON, $alias, $title); |
| [870](#L870) | } |
| [871](#L871) | } |
| [872](#L872) |  |
| [873](#L873) | /\*\* |
| [874](#L874) | \* migrate addons from type to type |
| [875](#L875) | \*/ |
| [876](#L876) | public function migrateAddonsToType($typeFrom, $typeTo){ |
| [877](#L877) |  |
| [878](#L878) | $arrAddons = $this->getArrAddons("", array(), $typeFrom); |
| [879](#L879) |  |
| [880](#L880) | $arrLog = array(); |
| [881](#L881) | $arrLog[] = "num addons: " . count($arrAddons); |
| [882](#L882) |  |
| [883](#L883) | foreach($arrAddons as $addon){ |
| [884](#L884) | $title = $addon->getTitle(); |
| [885](#L885) |  |
| [886](#L886) | $converted = $addon->convertToType($typeTo); |
| [887](#L887) |  |
| [888](#L888) | if($converted == true) |
| [889](#L889) | $arrLog[] = "$title converted"; |
| [890](#L890) | else |
| [891](#L891) | $arrLog[] = "$title skipped"; |
| [892](#L892) | } |
| [893](#L893) |  |
| [894](#L894) | return ($arrLog); |
| [895](#L895) | } |
| [896](#L896) |  |
| [897](#L897) | /\*\* |
| [898](#L898) | \* |
| [899](#L899) | \* move multiple items to some category |
| [900](#L900) | \*/ |
| [901](#L901) | private function moveAddons($arrAddonIDs, $catID){ |
| [902](#L902) |  |
| [903](#L903) | $category = new UniteCreatorCategories(); |
| [904](#L904) | $category->validateCatExist($catID); |
| [905](#L905) |  |
| [906](#L906) | foreach($arrAddonIDs as $addonID){ |
| [907](#L907) | $this->moveAddon($addonID, $catID); |
| [908](#L908) | } |
| [909](#L909) | } |
| [910](#L910) |  |
| [911](#L911) | /\*\* |
| [912](#L912) | \* |
| [913](#L913) | \* move addons to some category by change category id |
| [914](#L914) | \*/ |
| [915](#L915) | private function moveAddon($addonID, $catID){ |
| [916](#L916) |  |
| [917](#L917) | $addonID = (int)$addonID; |
| [918](#L918) | $catID = (int)$catID; |
| [919](#L919) |  |
| [920](#L920) | $arrUpdate = array(); |
| [921](#L921) | $arrUpdate["catid"] = $catID; |
| [922](#L922) | $this->db->update(GlobalsUC::$table\_addons, $arrUpdate, array("id" => $addonID)); |
| [923](#L923) | } |
| [924](#L924) |  |
| [925](#L925) | /\*\* |
| [926](#L926) | \* |
| [927](#L927) | \* duplciate addons within same category |
| [928](#L928) | \*/ |
| [929](#L929) | private function duplicateAddons($arrAddonIDs, $catID){ |
| [930](#L930) |  |
| [931](#L931) | foreach($arrAddonIDs as $addonID){ |
| [932](#L932) | $addon = new UniteCreatorAddon(); |
| [933](#L933) | $addon->initByID($addonID); |
| [934](#L934) | $addon->duplicate(); |
| [935](#L935) | } |
| [936](#L936) | } |
| [937](#L937) |  |
| [938](#L938) | /\*\* |
| [939](#L939) | \* create addon from data |
| [940](#L940) | \*/ |
| [941](#L941) | public function createFromData($data){ |
| [942](#L942) |  |
| [943](#L943) | $objAddon = new UniteCreatorAddon(); |
| [944](#L944) | $id = $objAddon->add($data); |
| [945](#L945) |  |
| [946](#L946) | return ($id); |
| [947](#L947) | } |
| [948](#L948) |  |
| [949](#L949) | /\*\* |
| [950](#L950) | \* create addon from manager |
| [951](#L951) | \*/ |
| [952](#L952) | public function createFromManager($data){ |
| [953](#L953) |  |
| [954](#L954) | $title = UniteFunctionsUC::getVal($data, "title"); |
| [955](#L955) | $name = UniteFunctionsUC::getVal($data, "name"); |
| [956](#L956) | $description = UniteFunctionsUC::getVal($data, "description"); |
| [957](#L957) | $catID = UniteFunctionsUC::getVal($data, "catid"); |
| [958](#L958) | $parentID = UniteFunctionsUC::getVal($data, "parent\_id"); |
| [959](#L959) |  |
| [960](#L960) | $addonType = $this->getAddonTypeFromData($data); |
| [961](#L961) | $objAddonType = UniteCreatorAddonType::getAddonTypeObject($addonType); |
| [962](#L962) |  |
| [963](#L963) | $objManager = UniteCreatorManager::getObjManagerByAddonType($addonType, $data); |
| [964](#L964) | $isLayout = $objManager->getIsLayoutType(); |
| [965](#L965) |  |
| [966](#L966) | if($isLayout == false){ |
| [967](#L967) | $objAddon = new UniteCreatorAddon(); |
| [968](#L968) | $newAddonID = $objAddon->addSmall($title, $name, $description, $catID, $addonType); |
| [969](#L969) | $urlAddon = HelperUC::getViewUrl\_EditAddon($newAddonID); |
| [970](#L970) | $htmlItem = $objManager->getAddonAdminHtml($objAddon); |
| [971](#L971) | }else{ |
| [972](#L972) | //add layout |
| [973](#L973) |  |
| [974](#L974) | $objLayout = new UniteCreatorLayout(); |
| [975](#L975) | $objLayout->setLayoutType($addonType); |
| [976](#L976) |  |
| [977](#L977) | $params = array(); |
| [978](#L978) | if(!empty($parentID)) |
| [979](#L979) | $params["parent\_id"] = $parentID; |
| [980](#L980) |  |
| [981](#L981) | $newLayoutID = $objLayout->createSmall($title, $name, $description, $catID, $params); |
| [982](#L982) | $urlAddon = HelperUC::getViewUrl\_Layout($newLayoutID); |
| [983](#L983) |  |
| [984](#L984) | $htmlItem = $objManager->getAddonAdminHtml($objLayout); |
| [985](#L985) | } |
| [986](#L986) |  |
| [987](#L987) | $objCats = new UniteCreatorCategories(); |
| [988](#L988) | $htmlCatList = $objCats->getHtmlCatList($catID, $objAddonType); |
| [989](#L989) |  |
| [990](#L990) | $output = array(); |
| [991](#L991) | $output["htmlItem"] = $htmlItem; |
| [992](#L992) | $output["htmlCats"] = $htmlCatList; |
| [993](#L993) | $output["url\_addon"] = $urlAddon; |
| [994](#L994) |  |
| [995](#L995) | return ($output); |
| [996](#L996) | } |
| [997](#L997) |  |
| [998](#L998) | /\*\* |
| [999](#L999) | \* update addon from data |
| [1000](#L1000) | \*/ |
| [1001](#L1001) | public function updateAddonFromData($data){ |
| [1002](#L1002) |  |
| [1003](#L1003) | $addonData = UniteFunctionsUC::getVal($data, "addon\_data"); |
| [1004](#L1004) |  |
| [1005](#L1005) | if(!empty($addonData)) |
| [1006](#L1006) | $data = UniteFunctionsUC::decodeContent($addonData); |
| [1007](#L1007) |  |
| [1008](#L1008) | $addonID = UniteFunctionsUC::getVal($data, "id"); |
| [1009](#L1009) |  |
| [1010](#L1010) | $objAddon = new UniteCreatorAddon(); |
| [1011](#L1011) | $objAddon->initByID($addonID); |
| [1012](#L1012) | $objAddon->update($data); |
| [1013](#L1013) | } |
| [1014](#L1014) |  |
| [1015](#L1015) | /\*\* |
| [1016](#L1016) | \* duplicate addon from data |
| [1017](#L1017) | \*/ |
| [1018](#L1018) | public function duplicateAddonFromData($data){ |
| [1019](#L1019) |  |
| [1020](#L1020) | $addonID = UniteFunctionsUC::getVal($data, "addonID"); |
| [1021](#L1021) |  |
| [1022](#L1022) | $objAddon = new UniteCreatorAddon(); |
| [1023](#L1023) | $objAddon->initByID($addonID); |
| [1024](#L1024) |  |
| [1025](#L1025) | $response = $objAddon->duplicate(true); |
| [1026](#L1026) |  |
| [1027](#L1027) | $htmlRow = HelperHtmlUC::getTableAddonsRow($response["id"], $response["title"]); |
| [1028](#L1028) |  |
| [1029](#L1029) | return ($htmlRow); |
| [1030](#L1030) | } |
| [1031](#L1031) |  |
| [1032](#L1032) | /\*\* |
| [1033](#L1033) | \* import addon from library |
| [1034](#L1034) | \*/ |
| [1035](#L1035) | public function importAddonFromLibrary($data){ |
| [1036](#L1036) |  |
| [1037](#L1037) | $path = UniteFunctionsUC::getVal($data, "path"); |
| [1038](#L1038) | if(empty($path)) |
| [1039](#L1039) | UniteFunctionsUC::throwError("Empty Path"); |
| [1040](#L1040) |  |
| [1041](#L1041) | $library = new UniteCreatorLibrary(); |
| [1042](#L1042) | $addonData = $library->getPluginDataByPath($path); |
| [1043](#L1043) |  |
| [1044](#L1044) | $objAddon = new UniteCreatorAddon(); |
| [1045](#L1045) | $addonID = $objAddon->add($addonData); |
| [1046](#L1046) | $title = $objAddon->getTitle(true); |
| [1047](#L1047) |  |
| [1048](#L1048) | $htmlRow = HelperHtmlUC::getTableAddonsRow($addonID, $title); |
| [1049](#L1049) |  |
| [1050](#L1050) | return ($htmlRow); |
| [1051](#L1051) | } |
| [1052](#L1052) |  |
| [1053](#L1053) | /\*\* |
| [1054](#L1054) | \* delete addon from imput data |
| [1055](#L1055) | \*/ |
| [1056](#L1056) | public function deleteAddonFromData($data){ |
| [1057](#L1057) |  |
| [1058](#L1058) | $addonID = UniteFunctionsUC::getVal($data, "addonID"); |
| [1059](#L1059) | UniteFunctionsUC::validateNotEmpty($addonID, "Widget ID"); |
| [1060](#L1060) |  |
| [1061](#L1061) | UniteFunctionsUC::validateNumeric($addonID,"widget id"); |
| [1062](#L1062) |  |
| [1063](#L1063) | $addon = new UniteCreatorAddon(); |
| [1064](#L1064) | $addon->initByID($addonID); |
| [1065](#L1065) |  |
| [1066](#L1066) | $addonID = (int)$addonID; |
| [1067](#L1067) |  |
| [1068](#L1068) | $this->db->delete(GlobalsUC::$table\_addons, "id={$addonID}"); |
| [1069](#L1069) |  |
| [1070](#L1070) | $addon->triggerAfterDeleteAction(); |
| [1071](#L1071) | } |
| [1072](#L1072) |  |
| [1073](#L1073) | /\*\* |
| [1074](#L1074) | \* update item title |
| [1075](#L1075) | \*/ |
| [1076](#L1076) | public function updateAddonTitleFromData($data){ |
| [1077](#L1077) |  |
| [1078](#L1078) | $itemID = $data["itemID"]; |
| [1079](#L1079) | $title = $data["title"]; |
| [1080](#L1080) | $name = $data["name"]; |
| [1081](#L1081) | $description = $data["description"]; |
| [1082](#L1082) |  |
| [1083](#L1083) | $addonType = $this->getAddonTypeFromData($data); |
| [1084](#L1084) | $isLayout = HelperUC::isLayoutAddonType($addonType); |
| [1085](#L1085) |  |
| [1086](#L1086) | if($isLayout == false){ |
| [1087](#L1087) | $addon = new UniteCreatorAddon(); |
| [1088](#L1088) | $addon->initByID($itemID); |
| [1089](#L1089) | $addon->updateNameTitle($name, $title, $description); |
| [1090](#L1090) | }else{ |
| [1091](#L1091) | $objLayout = new UniteCreatorLayout(); |
| [1092](#L1092) | $objLayout->initByID($itemID); |
| [1093](#L1093) | $objLayout->updateTitle($title); |
| [1094](#L1094) | $objLayout->updateParam("description", $description); |
| [1095](#L1095) |  |
| [1096](#L1096) | //check update isfree param |
| [1097](#L1097) | if(isset($data["isfree"])){ |
| [1098](#L1098) | $isFree = UniteFunctionsUC::getVal($data, "isfree"); |
| [1099](#L1099) | $isFree = UniteFunctionsUC::strToBool($isFree); |
| [1100](#L1100) |  |
| [1101](#L1101) | $objLayout->updateParam("isfree", $isFree); |
| [1102](#L1102) | } |
| [1103](#L1103) | } |
| [1104](#L1104) | } |
| [1105](#L1105) |  |
| [1106](#L1106) | /\*\* |
| [1107](#L1107) | \* update items activation from data |
| [1108](#L1108) | \* |
| [1109](#L1109) | \* @param $data |
| [1110](#L1110) | \*/ |
| [1111](#L1111) | public function activateAddonsFromData($data){ |
| [1112](#L1112) |  |
| [1113](#L1113) | $arrIDs = UniteFunctionsUC::getVal($data, "addons\_ids"); |
| [1114](#L1114) | if(is\_array($arrIDs) == false) |
| [1115](#L1115) | return (false); |
| [1116](#L1116) |  |
| [1117](#L1117) | if(empty($arrIDs)) |
| [1118](#L1118) | return (fale); |
| [1119](#L1119) |  |
| [1120](#L1120) | $strIDs = implode(",", $arrIDs); |
| [1121](#L1121) |  |
| [1122](#L1122) | UniteFunctionsUC::validateIDsList($strIDs, "id's list"); |
| [1123](#L1123) |  |
| [1124](#L1124) | $isActive = UniteFunctionsUC::getVal($data, "is\_active"); |
| [1125](#L1125) | $isActive = (int)UniteFunctionsUC::strToBool($isActive); |
| [1126](#L1126) |  |
| [1127](#L1127) | $tableAddons = GlobalsUC::$table\_addons; |
| [1128](#L1128) | $query = "update {$tableAddons} set is\_active={$isActive} where id in($strIDs)"; |
| [1129](#L1129) |  |
| [1130](#L1130) | $this->db->runSql($query); |
| [1131](#L1131) | } |
| [1132](#L1132) |  |
| [1133](#L1133) | /\*\* |
| [1134](#L1134) | \* remove items from data |
| [1135](#L1135) | \*/ |
| [1136](#L1136) | public function removeAddonsFromData($data){ |
| [1137](#L1137) |  |
| [1138](#L1138) | $catID = UniteFunctionsUC::getVal($data, "catid"); |
| [1139](#L1139) | $type = $this->getAddonTypeFromData($data); |
| [1140](#L1140) | $parentID = UniteFunctionsUC::getVal($data, "parentID"); |
| [1141](#L1141) | $parentID = (int)$parentID; |
| [1142](#L1142) |  |
| [1143](#L1143) | $addonsIDs = UniteFunctionsUC::getVal($data, "arrAddonsIDs"); |
| [1144](#L1144) |  |
| [1145](#L1145) | if(HelperUC::isLayoutAddonType($type) == false){    //delete addons |
| [1146](#L1146) | $this->deleteAddons($addonsIDs); |
| [1147](#L1147) | }else{    //delete layouts |
| [1148](#L1148) |  |
| [1149](#L1149) | $objLayouts = new UniteCreatorLayouts(); |
| [1150](#L1150) | $objLayouts->deleteLayouts($addonsIDs); |
| [1151](#L1151) | } |
| [1152](#L1152) |  |
| [1153](#L1153) | $response = $this->getCatsAndAddonsHtml($catID, $type, $data, $parentID); |
| [1154](#L1154) |  |
| [1155](#L1155) | return ($response); |
| [1156](#L1156) | } |
| [1157](#L1157) |  |
| [1158](#L1158) | /\*\* |
| [1159](#L1159) | \* |
| [1160](#L1160) | \* save items order from data |
| [1161](#L1161) | \*/ |
| [1162](#L1162) | public function saveOrderFromData($data){ |
| [1163](#L1163) |  |
| [1164](#L1164) | $addonType = $this->getAddonTypeFromData($data); |
| [1165](#L1165) | $isLayout = HelperUC::isLayoutAddonType($addonType); |
| [1166](#L1166) |  |
| [1167](#L1167) | $addonsIDs = UniteFunctionsUC::getVal($data, "addons\_order"); |
| [1168](#L1168) |  |
| [1169](#L1169) | UniteFunctionsUC::validateIDsList($addonsIDs,"addons\_order"); |
| [1170](#L1170) |  |
| [1171](#L1171) | if(empty($addonsIDs)) |
| [1172](#L1172) | return (false); |
| [1173](#L1173) |  |
| [1174](#L1174) | if($isLayout == false) |
| [1175](#L1175) | $this->saveAddonsOrder($addonsIDs); |
| [1176](#L1176) | else{ |
| [1177](#L1177) | $objLayouts = new UniteCreatorLayouts(); |
| [1178](#L1178) | $objLayouts->updateOrdering($addonsIDs); |
| [1179](#L1179) | } |
| [1180](#L1180) | } |
| [1181](#L1181) |  |
| [1182](#L1182) | /\*\* |
| [1183](#L1183) | \* |
| [1184](#L1184) | \* copy / move addons to some category |
| [1185](#L1185) | \* |
| [1186](#L1186) | \* @param $data |
| [1187](#L1187) | \*/ |
| [1188](#L1188) | public function moveAddonsFromData($data){ |
| [1189](#L1189) |  |
| [1190](#L1190) | $targetCatID = UniteFunctionsUC::getVal($data, "targetCatID"); |
| [1191](#L1191) | $selectedCatID = UniteFunctionsUC::getVal($data, "selectedCatID"); |
| [1192](#L1192) | $targetParentID = UniteFunctionsUC::getVal($data, "parentID"); |
| [1193](#L1193) | $targetParentID = (int)$targetParentID; |
| [1194](#L1194) |  |
| [1195](#L1195) | $type = $this->getAddonTypeFromData($data); |
| [1196](#L1196) | $isLayouts = HelperUC::isLayoutAddonType($type); |
| [1197](#L1197) |  |
| [1198](#L1198) | $arrAddonIDs = UniteFunctionsUC::getVal($data, "arrAddonIDs"); |
| [1199](#L1199) |  |
| [1200](#L1200) | UniteFunctionsUC::validateNotEmpty($targetCatID, "category id"); |
| [1201](#L1201) | UniteFunctionsUC::validateNotEmpty($arrAddonIDs, "addon id's"); |
| [1202](#L1202) |  |
| [1203](#L1203) | if($isLayouts == false)    //addons |
| [1204](#L1204) | $this->moveAddons($arrAddonIDs, $targetCatID); |
| [1205](#L1205) | else{ |
| [1206](#L1206) | $objLayouts = new UniteCreatorLayouts(); |
| [1207](#L1207) | $objLayouts->moveLayouts($arrAddonIDs, $targetCatID, $targetParentID); |
| [1208](#L1208) | } |
| [1209](#L1209) |  |
| [1210](#L1210) | $repsonse = $this->getCatsAndAddonsHtml($selectedCatID, $type, $data, $targetParentID); |
| [1211](#L1211) |  |
| [1212](#L1212) | return ($repsonse); |
| [1213](#L1213) | } |
| [1214](#L1214) |  |
| [1215](#L1215) | /\*\* |
| [1216](#L1216) | \* duplicate items |
| [1217](#L1217) | \*/ |
| [1218](#L1218) | public function duplicateAddonsFromData($data){ |
| [1219](#L1219) |  |
| [1220](#L1220) | $catID = UniteFunctionsUC::getVal($data, "catID"); |
| [1221](#L1221) | $arrIDs = UniteFunctionsUC::getVal($data, "arrIDs"); |
| [1222](#L1222) | $parentID = UniteFunctionsUC::getVal($data, "parentID"); |
| [1223](#L1223) |  |
| [1224](#L1224) | $type = $this->getAddonTypeFromData($data); |
| [1225](#L1225) |  |
| [1226](#L1226) | $isLayouts = HelperUC::isLayoutAddonType($type); |
| [1227](#L1227) |  |
| [1228](#L1228) | if($isLayouts == false) |
| [1229](#L1229) | $this->duplicateAddons($arrIDs, $catID); |
| [1230](#L1230) | else{ |
| [1231](#L1231) | $objLayouts = new UniteCreatorLayouts(); |
| [1232](#L1232) | $objLayouts->duplicateLayouts($arrIDs, $catID); |
| [1233](#L1233) | } |
| [1234](#L1234) |  |
| [1235](#L1235) | $response = $this->getCatsAndAddonsHtml($catID, $type, $data, $parentID); |
| [1236](#L1236) |  |
| [1237](#L1237) | return ($response); |
| [1238](#L1238) | } |
| [1239](#L1239) |  |
| [1240](#L1240) | /\*\* |
| [1241](#L1241) | \* shift addons in category from some order (more then the order). |
| [1242](#L1242) | \*/ |
| [1243](#L1243) | public function shiftOrder($catID, $order){ |
| [1244](#L1244) |  |
| [1245](#L1245) | $tableAddons = GlobalsUC::$table\_addons; |
| [1246](#L1246) |  |
| [1247](#L1247) | $query = "update $tableAddons set ordering = ordering+1 where catid={$catID} and ordering > {$order}"; |
| [1248](#L1248) |  |
| [1249](#L1249) | $this->db->runSql($query); |
| [1250](#L1250) | } |
| [1251](#L1251) |  |
| [1252](#L1252) | /\*\* |
| [1253](#L1253) | \* init addon by data |
| [1254](#L1254) | \*/ |
| [1255](#L1255) | public function initAddonByData($data){ |
| [1256](#L1256) |  |
| [1257](#L1257) | if(is\_string($data)){ |
| [1258](#L1258) | $data = json\_decode($data, true); |
| [1259](#L1259) | } |
| [1260](#L1260) |  |
| [1261](#L1261) | $addonID = UniteFunctionsUC::getVal($data, "id"); |
| [1262](#L1262) | $addonName = UniteFunctionsUC::getVal($data, "name"); |
| [1263](#L1263) | $arrConfig = UniteFunctionsUC::getVal($data, "config"); |
| [1264](#L1264) | $arrItemsData = UniteFunctionsUC::getVal($data, "items"); |
| [1265](#L1265) | $addonType = UniteFunctionsUC::getVal($data, "addontype"); |
| [1266](#L1266) | $arrFonts = UniteFunctionsUC::getVal($data, "fonts"); |
| [1267](#L1267) | $arrOptions = UniteFunctionsUC::getVal($data, "options"); |
| [1268](#L1268) |  |
| [1269](#L1269) | $isInsideGrid = UniteFunctionsUC::getVal($data, "is\_inside\_grid"); |
| [1270](#L1270) | $isInsideGrid = UniteFunctionsUC::strToBool($isInsideGrid); |
| [1271](#L1271) |  |
| [1272](#L1272) | $objAddon = new UniteCreatorAddon(); |
| [1273](#L1273) |  |
| [1274](#L1274) | if(!empty($addonID)) |
| [1275](#L1275) | $objAddon->initByID($addonID); |
| [1276](#L1276) | else{ |
| [1277](#L1277) | if(!empty($addonType)) |
| [1278](#L1278) | $objAddon->initByAlias($addonName, $addonType); |
| [1279](#L1279) | else |
| [1280](#L1280) | $objAddon->initByName($addonName); |
| [1281](#L1281) | } |
| [1282](#L1282) |  |
| [1283](#L1283) | $objAddon->setParamsValues($arrConfig); |
| [1284](#L1284) |  |
| [1285](#L1285) | if(is\_array($arrItemsData)) |
| [1286](#L1286) | $objAddon->setArrItems($arrItemsData); |
| [1287](#L1287) |  |
| [1288](#L1288) | if(!empty($arrFonts) && is\_array($arrFonts)) |
| [1289](#L1289) | $objAddon->setArrFonts($arrFonts); |
| [1290](#L1290) |  |
| [1291](#L1291) | if($isInsideGrid == true) |
| [1292](#L1292) | $objAddon->setIsInsideGrid(); |
| [1293](#L1293) |  |
| [1294](#L1294) | return ($objAddon); |
| [1295](#L1295) | } |
| [1296](#L1296) |  |
| [1297](#L1297) | /\*\* |
| [1298](#L1298) | \* show preview by data |
| [1299](#L1299) | \*/ |
| [1300](#L1300) | public function showAddonPreviewFromData($data){ |
| [1301](#L1301) |  |
| [1302](#L1302) | try{ |
| [1303](#L1303) | $objAddon = $this->initAddonByData($data); |
| [1304](#L1304) |  |
| [1305](#L1305) | $objOutput = new UniteCreatorOutput(); |
| [1306](#L1306) | $objOutput->setPreviewAddonMode(); |
| [1307](#L1307) |  |
| [1308](#L1308) | $objOutput->initByAddon($objAddon); |
| [1309](#L1309) | $objOutput->putPreviewHtml(); |
| [1310](#L1310) | }catch(Exception $e){ |
| [1311](#L1311) | $message = $e->getMessage(); |
| [1312](#L1312) |  |
| [1313](#L1313) | $errorMessage = HelperUC::getHtmlErrorMessage($message, GlobalsUC::$SHOW\_TRACE\_FRONT); |
| [1314](#L1314) |  |
| [1315](#L1315) | echo UniteProviderFunctionsUC::escCombinedHtml($errorMessage); |
| [1316](#L1316) | } |
| [1317](#L1317) |  |
| [1318](#L1318) | exit(); |
| [1319](#L1319) | } |
| [1320](#L1320) |  |
| [1321](#L1321) | /\*\* |
| [1322](#L1322) | \* save test addon data to some slot |
| [1323](#L1323) | \*/ |
| [1324](#L1324) | public function saveTestAddonData($data, $slot = 1){ |
| [1325](#L1325) |  |
| [1326](#L1326) | $addonID = UniteFunctionsUC::getVal($data, "id"); |
| [1327](#L1327) |  |
| [1328](#L1328) | if(!empty($addonID)){ |
| [1329](#L1329) | $config = UniteFunctionsUC::getVal($data, "settings\_values", array()); |
| [1330](#L1330) | $items = UniteFunctionsUC::getVal($config, "uc\_items", array()); |
| [1331](#L1331) | $fonts = ""; |
| [1332](#L1332) |  |
| [1333](#L1333) | unset($config["uc\_items"]); |
| [1334](#L1334) |  |
| [1335](#L1335) | $objAddon = new UniteCreatorAddon(); |
| [1336](#L1336) | $objAddon->initByID($addonID); |
| [1337](#L1337) | }else{ |
| [1338](#L1338) | $addonName = UniteFunctionsUC::getVal($data, "name"); |
| [1339](#L1339) | $addontype = UniteFunctionsUC::getVal($data, "addontype"); |
| [1340](#L1340) |  |
| [1341](#L1341) | $config = UniteFunctionsUC::getVal($data, "config", array()); |
| [1342](#L1342) | $items = UniteFunctionsUC::getVal($data, "items", array()); |
| [1343](#L1343) | $fonts = UniteFunctionsUC::getVal($data, "fonts"); |
| [1344](#L1344) |  |
| [1345](#L1345) | $objAddon = new UniteCreatorAddon(); |
| [1346](#L1346) | $objAddon->initByMixed($addonName, $addontype); |
| [1347](#L1347) | } |
| [1348](#L1348) |  |
| [1349](#L1349) | $objAddon->saveTestSlotData($slot, $config, $items, $fonts); |
| [1350](#L1350) | } |
| [1351](#L1351) |  |
| [1352](#L1352) | /\*\* |
| [1353](#L1353) | \* save addon defaults from data |
| [1354](#L1354) | \*/ |
| [1355](#L1355) | public function saveAddonDefaultsFromData($data){ |
| [1356](#L1356) |  |
| [1357](#L1357) | $this->saveTestAddonData($data, 2); |
| [1358](#L1358) | } |
| [1359](#L1359) |  |
| [1360](#L1360) | /\*\* |
| [1361](#L1361) | \* get test addon data |
| [1362](#L1362) | \*/ |
| [1363](#L1363) | public function getTestAddonData($data){ |
| [1364](#L1364) |  |
| [1365](#L1365) | $objAddon = $this->initAddonByData($data); |
| [1366](#L1366) |  |
| [1367](#L1367) | $slotNum = UniteFunctionsUC::getVal($data, "slotnum"); |
| [1368](#L1368) | $isCombine = UniteFunctionsUC::getVal($data, "combine"); |
| [1369](#L1369) | $isCombine = UniteFunctionsUC::strToBool($isCombine); |
| [1370](#L1370) |  |
| [1371](#L1371) | $data = $objAddon->getTestData($slotNum); |
| [1372](#L1372) |  |
| [1373](#L1373) | if($isCombine === true){ |
| [1374](#L1374) | $config = UniteFunctionsUC::getVal($data, "config", array()); |
| [1375](#L1375) | $items = UniteFunctionsUC::getVal($data, "items"); |
| [1376](#L1376) |  |
| [1377](#L1377) | if(!empty($items)) |
| [1378](#L1378) | $config["uc\_items"] = $items; |
| [1379](#L1379) |  |
| [1380](#L1380) | $output = array("settings\_values" => $config); |
| [1381](#L1381) |  |
| [1382](#L1382) | return $output; |
| [1383](#L1383) | } |
| [1384](#L1384) |  |
| [1385](#L1385) | return $data; |
| [1386](#L1386) | } |
| [1387](#L1387) |  |
| [1388](#L1388) | /\*\* |
| [1389](#L1389) | \* delete test addon data |
| [1390](#L1390) | \* |
| [1391](#L1391) | \* @param $data |
| [1392](#L1392) | \*/ |
| [1393](#L1393) | public function deleteTestAddonData($data){ |
| [1394](#L1394) |  |
| [1395](#L1395) | $objAddon = $this->initAddonByData($data); |
| [1396](#L1396) | $slotNum = UniteFunctionsUC::getVal($data, "slotnum"); |
| [1397](#L1397) |  |
| [1398](#L1398) | $slotNum = (int)$slotNum; |
| [1399](#L1399) |  |
| [1400](#L1400) | $objAddon->clearTestDataSlot($slotNum); |
| [1401](#L1401) | } |
| [1402](#L1402) |  |
| [1403](#L1403) | /\*\* |
| [1404](#L1404) | \* export addon |
| [1405](#L1405) | \*/ |
| [1406](#L1406) | public function exportAddon($data){ |
| [1407](#L1407) |  |
| [1408](#L1408) | $addonType = $this->getAddonTypeFromData($data); |
| [1409](#L1409) | $isLayout = HelperUC::isLayoutAddonType($addonType); |
| [1410](#L1410) |  |
| [1411](#L1411) | try{ |
| [1412](#L1412) | if($isLayout == false){ |
| [1413](#L1413) | $addon = $this->initAddonByData($data); |
| [1414](#L1414) | $exporter = new UniteCreatorExporter(); |
| [1415](#L1415) | $exporter->initByAddon($addon); |
| [1416](#L1416) | $exporter->export(); |
| [1417](#L1417) | }else{ |
| [1418](#L1418) | $layoutID = UniteFunctionsUC::getVal($data, "id"); |
| [1419](#L1419) |  |
| [1420](#L1420) | $objLayout = new UniteCreatorLayout(); |
| [1421](#L1421) | $objLayout->initByID($layoutID); |
| [1422](#L1422) |  |
| [1423](#L1423) | $objExporter = new UniteCreatorLayoutsExporter(); |
| [1424](#L1424) | $objExporter->initByLayout($objLayout); |
| [1425](#L1425) | $objExporter->export(); |
| [1426](#L1426) | } |
| [1427](#L1427) | }catch(Exception $e){ |
| [1428](#L1428) | $message = "Export error: " . $e->getMessage(); |
| [1429](#L1429) | echo esc\_html($message); |
| [1430](#L1430) | } |
| [1431](#L1431) |  |
| [1432](#L1432) | $message = "Export error:item not exported"; |
| [1433](#L1433) | echo esc\_html($message); |
| [1434](#L1434) | exit(); |
| [1435](#L1435) | } |
| [1436](#L1436) |  |
| [1437](#L1437) | /\*\* |
| [1438](#L1438) | \* export category addons |
| [1439](#L1439) | \*/ |
| [1440](#L1440) | public function exportCatAddons($data, $exportType = ""){ |
| [1441](#L1441) |  |
| [1442](#L1442) | try{ |
| [1443](#L1443) | $catID = UniteFunctionsUC::getVal($data, "catid"); |
| [1444](#L1444) | UniteFunctionsUC::validateNotEmpty($catID); |
| [1445](#L1445) |  |
| [1446](#L1446) | $objCats = new UniteCreatorCategories(); |
| [1447](#L1447) | $objCats->validateCatExist($catID); |
| [1448](#L1448) |  |
| [1449](#L1449) | $exporter = new UniteCreatorExporter(); |
| [1450](#L1450) | $exporter->exportCatAddons($catID, $exportType); |
| [1451](#L1451) | }catch(Exception $e){ |
| [1452](#L1452) | $message = "Export category addons error: " . $e->getMessage(); |
| [1453](#L1453) | echo esc\_html($message); |
| [1454](#L1454) | } |
| [1455](#L1455) |  |
| [1456](#L1456) | $message = "Export category addons error: addons not exported"; |
| [1457](#L1457) | echo esc\_html($message); |
| [1458](#L1458) | exit(); |
| [1459](#L1459) | } |
| [1460](#L1460) |  |
| [1461](#L1461) | /\*\* |
| [1462](#L1462) | \* import addons |
| [1463](#L1463) | \*/ |
| [1464](#L1464) | public function importAddons($data){ |
| [1465](#L1465) |  |
| [1466](#L1466) | $catID = UniteFunctionsUC::getVal($data, "catid"); |
| [1467](#L1467) | $addonType = $this->getAddonTypeFromData($data); |
| [1468](#L1468) | $isLayout = HelperUC::isLayoutAddonType($addonType); |
| [1469](#L1469) |  |
| [1470](#L1470) | $isOverwrite = UniteFunctionsUC::getVal($data, "isoverwrite"); |
| [1471](#L1471) | $isOverwrite = UniteFunctionsUC::strToBool($isOverwrite); |
| [1472](#L1472) |  |
| [1473](#L1473) | $importType = UniteFunctionsUC::getVal($data, "importtype"); |
| [1474](#L1474) |  |
| [1475](#L1475) | switch($importType){ |
| [1476](#L1476) | case "autodetect": |
| [1477](#L1477) | $forceToCat = false; |
| [1478](#L1478) | break; |
| [1479](#L1479) | case "specific": |
| [1480](#L1480) | $forceToCat = true; |
| [1481](#L1481) | break; |
| [1482](#L1482) | default: |
| [1483](#L1483) | UniteFunctionsUC::throwError("Wrong type: $importType"); |
| [1484](#L1484) | break; |
| [1485](#L1485) | } |
| [1486](#L1486) |  |
| [1487](#L1487) | if(empty($catID)) |
| [1488](#L1488) | $catID = null; |
| [1489](#L1489) |  |
| [1490](#L1490) | $arrTempFile = UniteFunctionsUC::getVal($\_FILES, "file"); |
| [1491](#L1491) |  |
| [1492](#L1492) | //---- addon ----- |
| [1493](#L1493) |  |
| [1494](#L1494) | if($isLayout == false){ |
| [1495](#L1495) | $exporter = new UniteCreatorExporter(); |
| [1496](#L1496) | $exporter->setMustImportAddonType($addonType); |
| [1497](#L1497) |  |
| [1498](#L1498) | $importLog = $exporter->import($catID, $arrTempFile, $isOverwrite, $forceToCat); |
| [1499](#L1499) |  |
| [1500](#L1500) | $catID = $exporter->getImportedCatID(); |
| [1501](#L1501) | }else{ |
| [1502](#L1502) | //----- layout ------- |
| [1503](#L1503) |  |
| [1504](#L1504) | $arrParams = array(); |
| [1505](#L1505) | if(!empty($forceToCat)) |
| [1506](#L1506) | $arrParams["force\_to\_cat"] = $catID; |
| [1507](#L1507) |  |
| [1508](#L1508) | if($addonType == GlobalsUnlimitedElements::ADDONSTYPE\_ELEMENTOR\_TEMPLATE){ |
| [1509](#L1509) | $exporterLayouts = new UniteCreatorLayoutsExporterElementor(); |
| [1510](#L1510) | $exporterLayouts->importElementorLayoutNew($arrTempFile, $isOverwrite, $data); |
| [1511](#L1511) | }else{ |
| [1512](#L1512) | $exporterLayouts = new UniteCreatorLayoutsExporter(); |
| [1513](#L1513) | $exporterLayouts->import($arrTempFile, null, $isOverwrite, $arrParams); |
| [1514](#L1514) | } |
| [1515](#L1515) |  |
| [1516](#L1516) | $importLog = $exporterLayouts->getLogText(); |
| [1517](#L1517) | } |
| [1518](#L1518) |  |
| [1519](#L1519) | $response = $this->getCatsAndAddonsHtml($catID, $addonType, $data); |
| [1520](#L1520) | $response["import\_log"] = $importLog; |
| [1521](#L1521) |  |
| [1522](#L1522) | return ($response); |
| [1523](#L1523) | } |
| [1524](#L1524) |  |
| [1525](#L1525) | /\*\* |
| [1526](#L1526) | \* add addon changelog |
| [1527](#L1527) | \*/ |
| [1528](#L1528) | public function addAddonChangelog($data){ |
| [1529](#L1529) |  |
| [1530](#L1530) | try{ |
| [1531](#L1531) | $addonId = UniteFunctionsUC::getVal($data, "addon\_id"); |
| [1532](#L1532) | $type = UniteFunctionsUC::getVal($data, "type"); |
| [1533](#L1533) | $text = UniteFunctionsUC::getVal($data, "text"); |
| [1534](#L1534) |  |
| [1535](#L1535) | UniteFunctionsUC::validateNotEmpty($addonId, "addon id"); |
| [1536](#L1536) | UniteFunctionsUC::validateNotEmpty($type, "type"); |
| [1537](#L1537) | UniteFunctionsUC::validateNotEmpty($text, "text"); |
| [1538](#L1538) |  |
| [1539](#L1539) | $changelog = new UniteCreatorAddonChangelog(); |
| [1540](#L1540) | $changelog->addChangelog($addonId, $type, $text); |
| [1541](#L1541) | }catch(Exception $e){ |
| [1542](#L1542) | $message = "Add changelog error: " . $e->getMessage(); |
| [1543](#L1543) | echo esc\_html($message); |
| [1544](#L1544) | exit(); |
| [1545](#L1545) | } |
| [1546](#L1546) | } |
| [1547](#L1547) |  |
| [1548](#L1548) | /\*\* |
| [1549](#L1549) | \* update addon changelog |
| [1550](#L1550) | \*/ |
| [1551](#L1551) | public function updateAddonChangelog($data){ |
| [1552](#L1552) |  |
| [1553](#L1553) | try{ |
| [1554](#L1554) | $id = UniteFunctionsUC::getVal($data, "id"); |
| [1555](#L1555) | $type = UniteFunctionsUC::getVal($data, "type"); |
| [1556](#L1556) | $text = UniteFunctionsUC::getVal($data, "text"); |
| [1557](#L1557) |  |
| [1558](#L1558) | UniteFunctionsUC::validateNotEmpty($id, "id"); |
| [1559](#L1559) | UniteFunctionsUC::validateNotEmpty($type, "type"); |
| [1560](#L1560) | UniteFunctionsUC::validateNotEmpty($text, "text"); |
| [1561](#L1561) |  |
| [1562](#L1562) | $changelog = new UniteCreatorAddonChangelog(); |
| [1563](#L1563) |  |
| [1564](#L1564) | $changelog->updateChangelog($id, array( |
| [1565](#L1565) | "type" => $type, |
| [1566](#L1566) | "text" => $text, |
| [1567](#L1567) | )); |
| [1568](#L1568) | }catch(Exception $e){ |
| [1569](#L1569) | $message = "Update changelog error: " . $e->getMessage(); |
| [1570](#L1570) | echo esc\_html($message); |
| [1571](#L1571) | exit(); |
| [1572](#L1572) | } |
| [1573](#L1573) | } |
| [1574](#L1574) |  |
| [1575](#L1575) | /\*\* |
| [1576](#L1576) | \* delete addon changelog |
| [1577](#L1577) | \*/ |
| [1578](#L1578) | public function deleteAddonChangelog($data){ |
| [1579](#L1579) |  |
| [1580](#L1580) | try{ |
| [1581](#L1581) | $id = UniteFunctionsUC::getVal($data, "id"); |
| [1582](#L1582) |  |
| [1583](#L1583) | UniteFunctionsUC::validateNotEmpty($id, "id"); |
| [1584](#L1584) |  |
| [1585](#L1585) | $changelog = new UniteCreatorAddonChangelog(); |
| [1586](#L1586) | $changelog->deleteChangelog($id); |
| [1587](#L1587) | }catch(Exception $e){ |
| [1588](#L1588) | $message = "Delete changelog error: " . $e->getMessage(); |
| [1589](#L1589) | echo esc\_html($message); |
| [1590](#L1590) | exit(); |
| [1591](#L1591) | } |
| [1592](#L1592) | } |
| [1593](#L1593) |  |
| [1594](#L1594) | /\*\* |
| [1595](#L1595) | \* create addon revision |
| [1596](#L1596) | \*/ |
| [1597](#L1597) | public function createAddonRevision($data){ |
| [1598](#L1598) |  |
| [1599](#L1599) | try{ |
| [1600](#L1600) | $addon = $this->initAddonByData($data); |
| [1601](#L1601) |  |
| [1602](#L1602) | $revisioner = new UniteCreatorAddonRevisioner(); |
| [1603](#L1603) | $revisioner->createAddonRevision($addon); |
| [1604](#L1604) | }catch(Exception $e){ |
| [1605](#L1605) | $message = "Create addon revision error: " . $e->getMessage(); |
| [1606](#L1606) | echo esc\_html($message); |
| [1607](#L1607) | exit(); |
| [1608](#L1608) | } |
| [1609](#L1609) | } |
| [1610](#L1610) |  |
| [1611](#L1611) | /\*\* |
| [1612](#L1612) | \* restore addon revision |
| [1613](#L1613) | \*/ |
| [1614](#L1614) | public function restoreAddonRevision($data){ |
| [1615](#L1615) |  |
| [1616](#L1616) | try{ |
| [1617](#L1617) | $addon = $this->initAddonByData($data); |
| [1618](#L1618) | $revisionId = UniteFunctionsUC::getVal($data, "revision\_id"); |
| [1619](#L1619) |  |
| [1620](#L1620) | $revisioner = new UniteCreatorAddonRevisioner(); |
| [1621](#L1621) | $importLog = $revisioner->restoreAddonRevision($addon, $revisionId); |
| [1622](#L1622) |  |
| [1623](#L1623) | $response = array(); |
| [1624](#L1624) | $response["import\_log"] = $importLog; |
| [1625](#L1625) |  |
| [1626](#L1626) | return $response; |
| [1627](#L1627) | }catch(Exception $e){ |
| [1628](#L1628) | $message = "Restore addon revision error: " . $e->getMessage(); |
| [1629](#L1629) | echo esc\_html($message); |
| [1630](#L1630) | exit(); |
| [1631](#L1631) | } |
| [1632](#L1632) | } |
| [1633](#L1633) |  |
| [1634](#L1634) | /\*\* |
| [1635](#L1635) | \* download addon revision |
| [1636](#L1636) | \*/ |
| [1637](#L1637) | public function downloadAddonRevision($data){ |
| [1638](#L1638) |  |
| [1639](#L1639) | try{ |
| [1640](#L1640) | $addon = $this->initAddonByData($data); |
| [1641](#L1641) | $revisionId = UniteFunctionsUC::getVal($data, "revision\_id"); |
| [1642](#L1642) |  |
| [1643](#L1643) | $revisioner = new UniteCreatorAddonRevisioner(); |
| [1644](#L1644) | $revisioner->downloadAddonRevision($addon, $revisionId); |
| [1645](#L1645) | }catch(Exception $e){ |
| [1646](#L1646) | $message = "Download addon revision error: " . $e->getMessage(); |
| [1647](#L1647) | echo esc\_html($message); |
| [1648](#L1648) | exit(); |
| [1649](#L1649) | } |
| [1650](#L1650) | } |
| [1651](#L1651) |  |
| [1652](#L1652) | /\*\* |
| [1653](#L1653) | \* update addon from catalog |
| [1654](#L1654) | \*/ |
| [1655](#L1655) | public function updateAddonFromCatalogFromData($data){ |
| [1656](#L1656) |  |
| [1657](#L1657) | $widgetName = UniteFunctionsUC::getVal($data, "widget\_name"); |
| [1658](#L1658) |  |
| [1659](#L1659) | $objAddon = new UniteCreatorAddon(); |
| [1660](#L1660) |  |
| [1661](#L1661) | $addonID = null; |
| [1662](#L1662) |  |
| [1663](#L1663) | if(!empty($widgetName)){ |
| [1664](#L1664) | $alias = str\_replace("ucaddon\_", "", $widgetName); |
| [1665](#L1665) |  |
| [1666](#L1666) | $objAddon->initByAlias($alias, GlobalsUC::ADDON\_TYPE\_ELEMENTOR); |
| [1667](#L1667) | }else{    //init by id |
| [1668](#L1668) |  |
| [1669](#L1669) | $addonID = UniteFunctionsUC::getVal($data, "id"); |
| [1670](#L1670) | $addonID = (int)$addonID; |
| [1671](#L1671) |  |
| [1672](#L1672) | $objAddon->initByID($addonID); |
| [1673](#L1673) | } |
| [1674](#L1674) |  |
| [1675](#L1675) | $installData = array(); |
| [1676](#L1676) |  |
| [1677](#L1677) | $installData["name"] = $objAddon->getAlias(); |
| [1678](#L1678) | $installData["cat"] = $objAddon->getCatTitle(); |
| [1679](#L1679) | $installData["type"] = $objAddon->getType(); |
| [1680](#L1680) |  |
| [1681](#L1681) | $webAPI = new UniteCreatorWebAPI(); |
| [1682](#L1682) |  |
| [1683](#L1683) | $webAPI->checkUpdateCatalog(true); |
| [1684](#L1684) | $webAPI->installCatalogAddonFromData($installData); |
| [1685](#L1685) |  |
| [1686](#L1686) | if(empty($addonID)) |
| [1687](#L1687) | return (null); |
| [1688](#L1688) |  |
| [1689](#L1689) | $urlRedirect = HelperUC::getViewUrl\_EditAddon($addonID); |
| [1690](#L1690) |  |
| [1691](#L1691) | return ($urlRedirect); |
| [1692](#L1692) | } |
| [1693](#L1693) |  |
| [1694](#L1694) | /\*\* |
| [1695](#L1695) | \* update bulk params in addons from data |
| [1696](#L1696) | \* return bulk dialog html |
| [1697](#L1697) | \*/ |
| [1698](#L1698) | public function updateAddonsBulkFromData($data){ |
| [1699](#L1699) |  |
| [1700](#L1700) | $paramType = UniteFunctionsUC::getVal($data, "param\_type"); |
| [1701](#L1701) | $paramData = UniteFunctionsUC::getVal($data, "param\_data"); |
| [1702](#L1702) | $paramName = UniteFunctionsUC::getVal($paramData, "name"); |
| [1703](#L1703) |  |
| [1704](#L1704) | $sourceAddonID = UniteFunctionsUC::getVal($data, "addon\_id"); |
| [1705](#L1705) | $targetAddonIDs = UniteFunctionsUC::getVal($data, "addon\_ids"); |
| [1706](#L1706) | $action = UniteFunctionsUC::getVal($data, "action\_bulk"); |
| [1707](#L1707) |  |
| [1708](#L1708) | $position = UniteFunctionsUC::getVal($data, "param\_position"); |
| [1709](#L1709) |  |
| [1710](#L1710) | //get position in addon |
| [1711](#L1711) |  |
| [1712](#L1712) | $objAddon = new UniteCreatorAddon(); |
| [1713](#L1713) | $objAddon->initByID($sourceAddonID); |
| [1714](#L1714) |  |
| [1715](#L1715) | $isMain = ($paramType == "main"); |
| [1716](#L1716) |  |
| [1717](#L1717) | if(empty($position)) |
| [1718](#L1718) | $position = $objAddon->getParamPosition($paramName, $isMain); |
| [1719](#L1719) |  |
| [1720](#L1720) | //clear category data |
| [1721](#L1721) | unset($paramData["\_\_attr\_catid\_\_"]); |
| [1722](#L1722) |  |
| [1723](#L1723) | //update addons |
| [1724](#L1724) |  |
| [1725](#L1725) | foreach($targetAddonIDs as $addonID){ |
| [1726](#L1726) | $objTargetAddon = new UniteCreatorAddon(); |
| [1727](#L1727) | $objTargetAddon->initByID($addonID); |
| [1728](#L1728) |  |
| [1729](#L1729) | switch($action){ |
| [1730](#L1730) | case "update": |
| [1731](#L1731) | $objTargetAddon->addUpdateParam\_updateDB($paramData, $isMain, $position); |
| [1732](#L1732) | break; |
| [1733](#L1733) | case "delete": |
| [1734](#L1734) | $objTargetAddon->deleteParam\_updateDB($paramName, $isMain); |
| [1735](#L1735) | break; |
| [1736](#L1736) | default: |
| [1737](#L1737) | UniteFunctionsUC::throwError("Wrong bulk action: $action"); |
| [1738](#L1738) | break; |
| [1739](#L1739) | } |
| [1740](#L1740) | } |
| [1741](#L1741) | } |
| [1742](#L1742) |  |
| [1743](#L1743) | /\*\* |
| [1744](#L1744) | \* install addons from catalog if not exists |
| [1745](#L1745) | \*/ |
| [1746](#L1746) | public function installMultipleAddons($arrAddonNames, $addonType){ |
| [1747](#L1747) |  |
| [1748](#L1748) | if(empty($addonType)) |
| [1749](#L1749) | return ("installMultipleAddons - addonType is empty"); |
| [1750](#L1750) |  |
| [1751](#L1751) | if(empty($arrAddonNames)) |
| [1752](#L1752) | return ("installMultipleAddons - no addons found"); |
| [1753](#L1753) |  |
| [1754](#L1754) | $numAddons = count($arrAddonNames); |
| [1755](#L1755) |  |
| [1756](#L1756) | if($numAddons > 25) |
| [1757](#L1757) | UniteFunctionsUC::throwError("Too much widgets to install: $numAddons"); |
| [1758](#L1758) |  |
| [1759](#L1759) | $webAPI = new UniteCreatorWebAPI(); |
| [1760](#L1760) |  |
| [1761](#L1761) | $strLog = ""; |
| [1762](#L1762) |  |
| [1763](#L1763) | foreach($arrAddonNames as $alias){ |
| [1764](#L1764) | $isExists = $this->isAddonExistsByName($alias, $addonType); |
| [1765](#L1765) |  |
| [1766](#L1766) | if(!empty($strLog)) |
| [1767](#L1767) | $strLog .= "\n"; |
| [1768](#L1768) |  |
| [1769](#L1769) | if($isExists == true){ |
| [1770](#L1770) | $strLog .= "Skipped widget install: $alias"; |
| [1771](#L1771) | continue; |
| [1772](#L1772) | } |
| [1773](#L1773) |  |
| [1774](#L1774) | $strLog .= $webAPI->installCatalogAddonByName($alias, $addonType); |
| [1775](#L1775) | } |
| [1776](#L1776) |  |
| [1777](#L1777) | return ($strLog); |
| [1778](#L1778) | } |
| [1779](#L1779) |  |
| [1780](#L1780) | } |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_addons.class.php?format=txt)
* [Original Format](/export/3220213/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_addons.class.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_9e16d160_20250110_125920.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3097249)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Changeset](/changeset/3097248 "Changeset 3097248")
* [Next Changeset](/changeset/3097250 "Changeset 3097250") →

---

# Changeset 3097249

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
06/04/2024 09:37:59 AM
([7 months](/timeline?from=2024-06-04T09%3A37%3A59Z&precision=second "See timeline at 06/04/2024 09:37:59 AM") ago)

Author:
unitecms
Message:

update to 1.5.110 version.

Location:
[unlimited-elements-for-elementor/trunk](/browser/unlimited-elements-for-elementor/trunk?rev=3097249)
Files:

2 added
34 edited

* [assets\_libraries/filters/ue\_filters.js](/browser/unlimited-elements-for-elementor/trunk/assets_libraries/filters/ue_filters.js?rev=3097249 "Show entry in browser")
  (modified)
  ([1 diff](#file0 "Show differences"))
* [assets\_libraries/remote/ue-remote-controls.js](/browser/unlimited-elements-for-elementor/trunk/assets_libraries/remote/ue-remote-controls.js?rev=3097249 "Show entry in browser")
  (modified)
  ([12 diffs](#file1 "Show differences"))
* [inc\_php/framework/include\_framework.php](/browser/unlimited-elements-for-elementor/trunk/inc_php/framework/include_framework.php?rev=3097249 "Show entry in browser")
  (modified)
  ([1 diff](#file2 "Show differences"))
* [inc\_php/framework/settings.class.php](/browser/unlimited-elements-for-elementor/trunk/inc_php/framework/settings.class.php?rev=3097249 "Show entry in browser")
  (modified)
  ([3 diffs](#file3 "Show differences"))
* [inc\_php/layouts/unitecreator\_layout.class.php](/browser/unlimited-elements-for-elementor/trunk/inc_php/layouts/unitecreator_layout.class.php?rev=3097249 "Show entry in browser")
  (modified)
  ([3 diffs](#file4 "Show differences"))
* [inc\_php/unitecreator\_actions.class.php](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_actions.class.php?rev=3097249 "Show entry in browser")
  (modified)
  ([1 diff](#file5 "Show differences"))
* [inc\_php/unitecreator\_addon.class.php](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_addon.class.php?rev=3097249 "Show entry in browser")
  (modified)
  ([1 diff](#file6 "Show differences"))
* [inc\_php/unitecreator\_addons.class.php](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_addons.class.php?rev=3097249 "Show entry in browser")
  (modified)
  ([2 diffs](#file7 "Show differences"))
* [inc\_php/unitecreator\_categories.class.php](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_categories.class.php?rev=3097249 "Show entry in browser")
  (modified)
  ([1 diff](#file8 "Show differences"))
* [inc\_php/unitecreator\_filters\_process.class.php](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3097249 "Show entry in browser")
  (modified)
  ([38 diffs](#file9 "Show differences"))
* [inc\_php/unitecreator\_form.class.php](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_form.class.php?rev=3097249 "Show entry in browser")
  (modified)
  ([1 diff](#file10 "Show differences"))
* [inc\_php/unitecreator\_globals.class.php](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_globals.class.php?rev=3097249 "Show entry in browser")
  (modified)
  ([1 diff](#file11 "Show differences"))
* [inc\_php/unitecreator\_helperhtml.class.php](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_helperhtml.class.php?rev=3097249 "Show entry in browser")
  (modified)
  ([1 diff](#file12 "Show differences"))
* [inc\_php/unitecreator\_params\_processor.class.php](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_params_processor.class.php?rev=3097249 "Show entry in browser")
  (modified)
  ([3 diffs](#file13 "Show differences"))
* [inc\_php/unitecreator\_web\_api.class.php](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_web_api.class.php?rev=3097249 "Show entry in browser")
  (modified)
  ([1 diff](#file14 "Show differences"))
* [js/admin.js](/browser/unlimited-elements-for-elementor/trunk/js/admin.js?rev=3097249 "Show entry in browser")
  (modified)
  ([1 diff](#file15 "Show differences"))
* [provider/assets/gutenberg\_integrate.js](/browser/unlimited-elements-for-elementor/trunk/provider/assets/gutenberg_integrate.js?rev=3097249 "Show entry in browser")
  (modified)
  ([2 diffs](#file16 "Show differences"))
* [provider/core/unlimited\_elements/elementor/elementor\_integrate.class.php](/browser/unlimited-elements-for-elementor/trunk/provider/core/unlimited_elements/elementor/elementor_integrate.class.php?rev=3097249 "Show entry in browser")
  (modified)
  ([1 diff](#file17 "Show differences"))
* [provider/core/unlimited\_elements/elementor/elementor\_widget.class.php](/browser/unlimited-elements-for-elementor/trunk/provider/core/unlimited_elements/elementor/elementor_widget.class.php?rev=3097249 "Show entry in browser")
  (modified)
  ([1 diff](#file18 "Show differences"))
* [provider/core/unlimited\_elements/globals.class.php](/browser/unlimited-elements-for-elementor/trunk/provider/core/unlimited_elements/globals.class.php?rev=3097249 "Show entry in browser")
  (modified)
  ([4 diffs](#file19 "Show differences"))
* [provider/core/unlimited\_elements/helper\_provider\_core.class.php](/browser/unlimited-elements-for-elementor/trunk/provider/core/unlimited_elements/helper_provider_core.class.php?rev=3097249 "Show entry in browser")
  (modified)
  ([2 diffs](#file20 "Show differences"))
* [provider/core/unlimited\_elements/provider\_core\_admin.class.php](/browser/unlimited-elements-for-elementor/trunk/provider/core/unlimited_elements/provider_core_admin.class.php?rev=3097249 "Show entry in browser")
  (modified)
  ([1 diff](#file21 "Show differences"))
* [provider/core/unlimited\_elements/settings/elementor.xml](/browser/unlimited-elements-for-elementor/trunk/provider/core/unlimited_elements/settings/elementor.xml?rev=3097249 "Show entry in browser")
  (added)
* [provider/core/unlimited\_elements/settings/general\_settings\_el.xml](/browser/unlimited-elements-for-elementor/trunk/provider/core/unlimited_elements/settings/general_settings_el.xml?rev=3097249 "Show entry in browser")
  (modified)
  ([1 diff](#file23 "Show differences"))
* [provider/core/unlimited\_elements/settings/gutenberg.xml](/browser/unlimited-elements-for-elementor/trunk/provider/core/unlimited_elements/settings/gutenberg.xml?rev=3097249 "Show entry in browser")
  (added)
* [provider/functions\_wordpress.class.php](/browser/unlimited-elements-for-elementor/trunk/provider/functions_wordpress.class.php?rev=3097249 "Show entry in browser")
  (modified)
  ([2 diffs](#file25 "Show differences"))
* [provider/gutenberg\_integrate.class.php](/browser/unlimited-elements-for-elementor/trunk/provider/gutenberg_integrate.class.php?rev=3097249 "Show entry in browser")
  (modified)
  ([8 diffs](#file26 "Show differences"))
* [provider/include\_provider\_after.php](/browser/unlimited-elements-for-elementor/trunk/provider/include_provider_after.php?rev=3097249 "Show entry in browser")
  (modified)
  ([1 diff](#file27 "Show differences"))
* [provider/provider\_alt\_loader.php](/browser/unlimited-elements-for-elementor/trunk/provider/provider_alt_loader.php?rev=3097249 "Show entry in browser")
  (modified)
  ([1 diff](#file28 "Show differences"))
* [provider/provider\_helper.class.php](/browser/unlimited-elements-for-elementor/trunk/provider/provider_helper.class.php?rev=3097249 "Show entry in browser")
  (modified)
  ([4 diffs](#file29 "Show differences"))
* [provider/provider\_params\_processor.class.php](/browser/unlimited-elements-for-elementor/trunk/provider/provider_params_processor.class.php?rev=3097249 "Show entry in browser")
  (modified)
  ([3 diffs](#file30 "Show differences"))
* [readme.txt](/browser/unlimited-elements-for-elementor/trunk/readme.txt?rev=3097249 "Show entry in browser")
  (modified)
  ([2 diffs](#file31 "Show differences"))
* [release\_log.txt](/browser/unlimited-elements-for-elementor/trunk/release_log.txt?rev=3097249 "Show entry in browser")
  (modified)
  ([1 diff](#file32 "Show differences"))
* [settings/layout\_addon\_container\_settings.xml](/browser/unlimited-elements-for-elementor/trunk/settings/layout_addon_container_settings.xml?rev=3097249 "Show entry in browser")
  (modified)
  ([1 diff](#file33 "Show differences"))
* [unlimited\_elements.php](/browser/unlimited-elements-for-elementor/trunk/unlimited_elements.php?rev=3097249 "Show entry in browser")
  (modified)
  ([1 diff](#file34 "Show differences"))
* [views/layouts.php](/browser/unlimited-elements-for-elementor/trunk/views/layouts.php?rev=3097249 "Show entry in browser")
  (modified)
  ([1 diff](#file35 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [unlimited-elements-for-elementor/trunk/assets\_libraries/filters/ue\_filters.js](/changeset/3097249/unlimited-elements-for-elementor/trunk/assets_libraries/filters/ue_filters.js "Show the changeset 3097249 restricted to unlimited-elements-for-elementor/trunk/assets_libraries/filters/ue_filters.js")

  | [r3094530](/browser/unlimited-elements-for-elementor/trunk/assets_libraries/filters/ue_filters.js?rev=3094530#L3212 "Show revision 3094530 of this file in browser") | [r3097249](/browser/unlimited-elements-for-elementor/trunk/assets_libraries/filters/ue_filters.js?rev=3097249#L3212 "Show revision 3097249 of this file in browser") |  |
  | --- | --- | --- |
  | 3212 | 3212 |  |
  | 3213 | 3213 | var urlAddition = "ucfrontajaxaction=getfiltersdata&layoutid="+layoutID+"&elid="+widgetID; |
  | 3214 |  |  |
  |  | 3214 |  |
  | 3215 | 3215 | urlAjax = addUrlParam(urlAjax, urlAddition); |
  | 3216 | 3216 |  |
* ## [unlimited-elements-for-elementor/trunk/assets\_libraries/remote/ue-remote-controls.js](/changeset/3097249/unlimited-elements-for-elementor/trunk/assets_libraries/remote/ue-remote-controls.js "Show the changeset 3097249 restricted to unlimited-elements-for-elementor/trunk/assets_libraries/remote/ue-remote-controls.js")

  | [r3094530](/browser/unlimited-elements-for-elementor/trunk/assets_libraries/remote/ue-remote-controls.js?rev=3094530#L1809 "Show revision 3094530 of this file in browser") | [r3097249](/browser/unlimited-elements-for-elementor/trunk/assets_libraries/remote/ue-remote-controls.js?rev=3097249#L1809 "Show revision 3097249 of this file in browser") |  |
  | --- | --- | --- |
  | 1809 | 1809 | \*/ |
  | 1810 | 1810 | this.setAction = function(action, objElement, allowMultiple){ |
  | 1811 |  |  |
  |  | 1811 |  |
  | 1812 | 1812 | if(g\_vars.trace\_debug == true){ |
  | 1813 | 1813 | trace("set action: "+action); |
  | […](/browser/unlimited-elements-for-elementor/trunk/assets_libraries/remote/ue-remote-controls.js?rev=3094530#L1834) | […](/browser/unlimited-elements-for-elementor/trunk/assets_libraries/remote/ue-remote-controls.js?rev=3097249#L1834) |  |
  | 1834 | 1834 |  |
  | 1835 | 1835 | if(allowMultiple !== true) |
  | 1836 |  | if(linkedAction) |
  |  | 1836 | if(linkedAction){ |
  |  | 1837 |  |
  |  | 1838 | trace("not allow multiple action: "+action); |
  |  | 1839 |  |
  | 1837 | 1840 | return(false); |
  |  | 1841 | } |
  | 1838 | 1842 |  |
  | 1839 | 1843 | objElement.data("uc-action", action); |
  | […](/browser/unlimited-elements-for-elementor/trunk/assets_libraries/remote/ue-remote-controls.js?rev=3094530#L1861) | […](/browser/unlimited-elements-for-elementor/trunk/assets_libraries/remote/ue-remote-controls.js?rev=3097249#L1865) |  |
  | 1861 | 1865 |  |
  | 1862 | 1866 | var isEditorMode = isInsideEditor(); |
  | 1863 |  |  |
  |  | 1867 |  |
  | 1864 | 1868 | //in editor mode check debug every second |
  | 1865 | 1869 |  |
  | […](/browser/unlimited-elements-for-elementor/trunk/assets_libraries/remote/ue-remote-controls.js?rev=3094530#L2356) | […](/browser/unlimited-elements-for-elementor/trunk/assets_libraries/remote/ue-remote-controls.js?rev=3097249#L2360) |  |
  | 2356 | 2360 | \*/ |
  | 2357 | 2361 | function isInsideEditor(){ |
  | 2358 |  |  |
  |  | 2362 |  |
  | 2359 | 2363 | if(g\_vars.is\_editor !== null) |
  | 2360 | 2364 | return g\_vars.is\_editor; |
  |  | 2365 |  |
  |  | 2366 | //check for gutenberg |
  |  | 2367 |  |
  |  | 2368 | if(typeof g\_ucAdmin !== "undefined"){ |
  |  | 2369 | g\_vars.is\_editor = true; |
  |  | 2370 | return(true); |
  |  | 2371 | } |
  |  | 2372 |  |
  | 2361 | 2373 |  |
  | 2362 | 2374 | if (window.parent === window.top) { |
  | […](/browser/unlimited-elements-for-elementor/trunk/assets_libraries/remote/ue-remote-controls.js?rev=3094530#L2373) | […](/browser/unlimited-elements-for-elementor/trunk/assets_libraries/remote/ue-remote-controls.js?rev=3097249#L2385) |  |
  | 2373 | 2385 | } |
  | 2374 | 2386 |  |
  | 2375 |  | ~~// check for gutenberg~~ |
  | 2376 |  | ~~if (typeof window.parent.wp !== "undefined" && typeof window.parent.wp.blocks !== "undefined") {~~ |
  | 2377 |  | ~~g\_vars.is\_editor = true;~~ |
  | 2378 |  | ~~return true;~~ |
  | 2379 |  | ~~}~~ |
  | 2380 |  |  |
  | 2381 | 2387 | g\_vars.is\_editor = false; |
  | 2382 | 2388 |  |
  | […](/browser/unlimited-elements-for-elementor/trunk/assets_libraries/remote/ue-remote-controls.js?rev=3094530#L2400) | […](/browser/unlimited-elements-for-elementor/trunk/assets_libraries/remote/ue-remote-controls.js?rev=3097249#L2406) |  |
  | 2400 | 2406 | \*/ |
  | 2401 | 2407 | function checkWidgetInsideEditor(){ |
  | 2402 |  |  |
  |  | 2408 |  |
  | 2403 | 2409 | //check for disconnect |
  | 2404 | 2410 | try{ |
  | […](/browser/unlimited-elements-for-elementor/trunk/assets_libraries/remote/ue-remote-controls.js?rev=3094530#L2455) | […](/browser/unlimited-elements-for-elementor/trunk/assets_libraries/remote/ue-remote-controls.js?rev=3097249#L2461) |  |
  | 2455 | 2461 | this.onWidgetInit = function(widgetID, func, options){ |
  | 2456 | 2462 |  |
  | 2457 |  |  |
  | 2458 | 2463 | try{ |
  | 2459 |  |  |
  |  | 2464 |  |
  |  | 2465 | if(g\_vars.is\_inited == true) |
  |  | 2466 | return(false); |
  |  | 2467 |  |
  | 2460 | 2468 | if(g\_vars.trace\_debug == true){ |
  | 2461 | 2469 | trace("on widget init"); |
  | […](/browser/unlimited-elements-for-elementor/trunk/assets_libraries/remote/ue-remote-controls.js?rev=3094530#L2479) | […](/browser/unlimited-elements-for-elementor/trunk/assets_libraries/remote/ue-remote-controls.js?rev=3097249#L2487) |  |
  | 2479 | 2487 |  |
  | 2480 | 2488 | if(g\_vars.is\_inited == false){ |
  | 2481 |  |  |
  |  | 2489 |  |
  | 2482 | 2490 | if(g\_vars.trace\_debug == true){ |
  | 2483 | 2491 | trace(widgetID+" not inited yet, waiting for parent init"); |
  | […](/browser/unlimited-elements-for-elementor/trunk/assets_libraries/remote/ue-remote-controls.js?rev=3094530#L2509) | […](/browser/unlimited-elements-for-elementor/trunk/assets_libraries/remote/ue-remote-controls.js?rev=3097249#L2517) |  |
  | 2509 | 2517 |  |
  | 2510 | 2518 | onWidgetReady(); |
  | 2511 |  |  |
  | 2512 |  | g\_vars.funcOnInit(g\_objWidget); |
  | 2513 |  |  |
  |  | 2519 |  |
  |  | 2520 | if(g\_vars.funcOnInit){ |
  |  | 2521 |  |
  |  | 2522 | g\_vars.is\_inited = true; |
  |  | 2523 | g\_vars.funcOnInit(g\_objWidget); |
  |  | 2524 | } |
  |  | 2525 |  |
  | 2514 | 2526 | }catch(message){ |
  | 2515 | 2527 |  |
  | […](/browser/unlimited-elements-for-elementor/trunk/assets_libraries/remote/ue-remote-controls.js?rev=3094530#L2538) | […](/browser/unlimited-elements-for-elementor/trunk/assets_libraries/remote/ue-remote-controls.js?rev=3097249#L2550) |  |
  | 2538 | 2550 |  |
  | 2539 | 2551 | //if under template switcher - modify sync id |
  | 2540 |  |  |
  |  | 2552 |  |
  | 2541 | 2553 | if(g\_vars.trace\_debug == true){ |
  | 2542 | 2554 | trace("Start parent sync"); |
  | […](/browser/unlimited-elements-for-elementor/trunk/assets_libraries/remote/ue-remote-controls.js?rev=3094530#L2556) | […](/browser/unlimited-elements-for-elementor/trunk/assets_libraries/remote/ue-remote-controls.js?rev=3097249#L2568) |  |
  | 2556 | 2568 |  |
  | 2557 | 2569 | var isEditorMode = isInsideEditor(); |
  | 2558 |  |  |
  |  | 2570 |  |
  | 2559 | 2571 | objSync.setOptions(syncID, isEditorMode); |
  | 2560 | 2572 |  |
  | […](/browser/unlimited-elements-for-elementor/trunk/assets_libraries/remote/ue-remote-controls.js?rev=3094530#L2763) | […](/browser/unlimited-elements-for-elementor/trunk/assets_libraries/remote/ue-remote-controls.js?rev=3097249#L2775) |  |
  | 2763 | 2775 |  |
  | 2764 | 2776 | jQuery(document).on("uc-remote-parent-init",function(event, objParent, optionsAPI){ |
  | 2765 |  |  |
  |  | 2777 |  |
  | 2766 | 2778 | var objRemote = new UERemoteWidgets(); |
  | 2767 | 2779 | objRemote.onParentInit(objParent, optionsAPI); |
  | 2768 |  |  |
  |  | 2780 |  |
  | 2769 | 2781 | }); |
  | 2770 | 2782 |  |
* ## [unlimited-elements-for-elementor/trunk/inc\_php/framework/include\_framework.php](/changeset/3097249/unlimited-elements-for-elementor/trunk/inc_php/framework/include_framework.php "Show the changeset 3097249 restricted to unlimited-elements-for-elementor/trunk/inc_php/framework/include_framework.php")

  | [r3071404](/browser/unlimited-elements-for-elementor/trunk/inc_php/framework/include_framework.php?rev=3071404#L43 "Show revision 3071404 of this file in browser") | [r3097249](/browser/unlimited-elements-for-elementor/trunk/inc_php/framework/include_framework.php?rev=3097249#L43 "Show revision 3097249 of this file in browser") |  |
  | --- | --- | --- |
  | 43 | 43 | require\_once $folderIncludes . 'table.class.php'; |
  | 44 | 44 | require\_once $folderIncludes . 'font\_manager.class.php'; |
  | 45 |  | ~~require\_once $folderIncludes . 'shapes.class.php';~~ |
  | 46 | 45 | require\_once $folderIncludes . 'services.class.php'; |
  | 47 | 46 |  |
* ## [unlimited-elements-for-elementor/trunk/inc\_php/framework/settings.class.php](/changeset/3097249/unlimited-elements-for-elementor/trunk/inc_php/framework/settings.class.php "Show the changeset 3097249 restricted to unlimited-elements-for-elementor/trunk/inc_php/framework/settings.class.php")

  | [r3094530](/browser/unlimited-elements-for-elementor/trunk/inc_php/framework/settings.class.php?rev=3094530#L1324 "Show revision 3094530 of this file in browser") | [r3097249](/browser/unlimited-elements-for-elementor/trunk/inc_php/framework/settings.class.php?rev=3097249#L1324 "Show revision 3097249 of this file in browser") |  |
  | --- | --- | --- |
  | 1324 | 1324 | public function loadXMLFile($filepath, $loadedSettingsType = null){ |
  | 1325 | 1325 |  |
  | 1326 |  |  |
  | 1327 | 1326 | $obj = UniteFunctionsUC::loadXMLFile($filepath); |
  | 1328 |  |  |
  |  | 1327 |  |
  | 1329 | 1328 | if(empty($obj)) |
  | 1330 | 1329 | UniteFunctionsUC::throwError("Wrong xml file format: $filepath"); |
  | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/framework/settings.class.php?rev=3094530#L1364) | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/framework/settings.class.php?rev=3097249#L1363) |  |
  | 1364 | 1363 | $sapParams["nodraw"] = UniteFunctionsUC::strToBool($nodraw); |
  | 1365 | 1364 | } |
  | 1366 |  |  |
  | 1367 |  | UniteFunctionsUC::validateNotEmpty($sapName,"~~sapName~~"); |
  | 1368 |  |  |
  |  | 1365 |  |
  |  | 1366 | UniteFunctionsUC::validateNotEmpty($sapName,"name in fieldset attributes: $sapLabel"); |
  |  | 1367 |  |
  | 1369 | 1368 | if(!empty($loadFrom)){ |
  | 1370 |  |  |
  |  | 1369 |  |
  | 1371 | 1370 | $this->addExternalSettings($loadFrom, $loadParam, $loadedSettingsType); |
  | 1372 | 1371 | continue; |
  | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/framework/settings.class.php?rev=3094530#L1687) | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/framework/settings.class.php?rev=3097249#L1686) |  |
  | 1687 | 1686 | private function addExternalSettings($filename, $loadParam = null, $loadType = null){ |
  | 1688 | 1687 |  |
  | 1689 |  | $filepathSettings = GlobalsUC::$pathSettings."{$filename}.xml"; |
  | 1690 |  |  |
  |  | 1688 | $filepathSettings = GlobalsUnlimitedElements::$pathPluginSettings."{$filename}.xml"; |
  |  | 1689 |  |
  |  | 1690 | if(file\_exists($filepathSettings) == false) |
  |  | 1691 | $filepathSettings = GlobalsUC::$pathSettings."{$filename}.xml"; |
  |  | 1692 |  |
  | 1691 | 1693 | if(file\_exists($filepathSettings) == false) |
  | 1692 | 1694 | UniteFunctionsUC::throwError("The file: {$filename}.xml don't found in settings folder"); |
* ## [unlimited-elements-for-elementor/trunk/inc\_php/layouts/unitecreator\_layout.class.php](/changeset/3097249/unlimited-elements-for-elementor/trunk/inc_php/layouts/unitecreator_layout.class.php "Show the changeset 3097249 restricted to unlimited-elements-for-elementor/trunk/inc_php/layouts/unitecreator_layout.class.php")

  | [r3023498](/browser/unlimited-elements-for-elementor/trunk/inc_php/layouts/unitecreator_layout.class.php?rev=3023498#L16 "Show revision 3023498 of this file in browser") | [r3097249](/browser/unlimited-elements-for-elementor/trunk/inc_php/layouts/unitecreator_layout.class.php?rev=3097249#L16 "Show revision 3097249 of this file in browser") |  |
  | --- | --- | --- |
  | 16 | 16 | protected $addonType = null, $arrAllOptionsCache = null; |
  | 17 | 17 | protected $extraParams = array();   //extra params for link generate etc |
  | 18 |  | protected $~~objShapes, $~~layoutType, $isTemplate = false, $objLayouts; |
  |  | 18 | protected $layoutType, $isTemplate = false, $objLayouts; |
  | 19 | 19 | protected $objLayoutType; |
  | 20 | 20 |  |
  | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/layouts/unitecreator_layout.class.php?rev=3023498#L32) | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/layouts/unitecreator_layout.class.php?rev=3097249#L32) |  |
  | 32 | 32 | public function \_\_construct(){ |
  | 33 | 33 |  |
  | 34 |  | ~~$this->objShapes = new UniteShapeManagerUC();~~ |
  | 35 | 34 | $this->objLayouts = new UniteCreatorLayouts(); |
  | 36 | 35 |  |
  | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/layouts/unitecreator_layout.class.php?rev=3023498#L1737) | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/layouts/unitecreator_layout.class.php?rev=3097249#L1736) |  |
  | 1737 | 1736 | \*/ |
  | 1738 | 1737 | public function modifySettings\_collectSpecialAddonNames($settings, $elementType){ |
  | 1739 |  |  |
  | 1740 |  | $nameTop = $this->objShapes->getShapeDividerNameFromSettings($settings, "top"); |
  | 1741 |  | if(!empty($nameTop)) |
  | 1742 |  | $this->arrAddonNames[$nameTop."\_".GlobalsUC::ADDON\_TYPE\_SHAPE\_DEVIDER] = GlobalsUC::ADDON\_TYPE\_SHAPE\_DEVIDER; |
  | 1743 |  |  |
  | 1744 |  | $nameBottom = $this->objShapes->getShapeDividerNameFromSettings($settings, "bottom"); |
  | 1745 |  | if(!empty($nameBottom)) |
  | 1746 |  | $this->arrAddonNames[$nameBottom."\_".GlobalsUC::ADDON\_TYPE\_SHAPE\_DEVIDER] = GlobalsUC::ADDON\_TYPE\_SHAPE\_DEVIDER; |
  | 1747 |  |  |
  |  | 1738 |  |
  | 1748 | 1739 |  |
  | 1749 | 1740 | $bgAddonName = $this->getBGAddonNameFromSettings($settings); |
* ## [unlimited-elements-for-elementor/trunk/inc\_php/unitecreator\_actions.class.php](/changeset/3097249/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_actions.class.php "Show the changeset 3097249 restricted to unlimited-elements-for-elementor/trunk/inc_php/unitecreator_actions.class.php")

  | [r3076456](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_actions.class.php?rev=3076456#L584 "Show revision 3076456 of this file in browser") | [r3097249](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_actions.class.php?rev=3097249#L584 "Show revision 3097249 of this file in browser") |  |
  | --- | --- | --- |
  | 584 | 584 |  |
  | 585 | 585 | break; |
  | 586 |  | ~~case "get\_shapes\_css":~~ |
  | 587 |  |  |
  | 588 |  | ~~$objShapes = new UniteShapeManagerUC();~~ |
  | 589 |  | ~~$objShapes->outputCssShapes();~~ |
  | 590 |  | ~~exit;~~ |
  | 591 |  | ~~break;~~ |
  | 592 | 586 | case "save\_screenshot": |
  | 593 | 587 |  |
* ## [unlimited-elements-for-elementor/trunk/inc\_php/unitecreator\_addon.class.php](/changeset/3097249/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_addon.class.php "Show the changeset 3097249 restricted to unlimited-elements-for-elementor/trunk/inc_php/unitecreator_addon.class.php")

  | [r3094530](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_addon.class.php?rev=3094530#L219 "Show revision 3094530 of this file in browser") | [r3097249](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_addon.class.php?rev=3097249#L219 "Show revision 3097249 of this file in browser") |  |
  | --- | --- | --- |
  | 219 | 219 |  |
  | 220 | 220 | UniteFunctionsUC::validateNotEmpty($id, "widget id"); |
  | 221 |  |  |
  |  | 221 |  |
  |  | 222 | UniteFunctionsUC::validateNumeric($id,"widget id"); |
  |  | 223 |  |
  | 222 | 224 | $id = (int)$id; |
  | 223 | 225 |  |
* ## [unlimited-elements-for-elementor/trunk/inc\_php/unitecreator\_addons.class.php](/changeset/3097249/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_addons.class.php "Show the changeset 3097249 restricted to unlimited-elements-for-elementor/trunk/inc_php/unitecreator_addons.class.php")

  | [r3090199](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_addons.class.php?rev=3090199#L722 "Show revision 3090199 of this file in browser") | [r3097249](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_addons.class.php?rev=3097249#L722 "Show revision 3097249 of this file in browser") |  |
  | --- | --- | --- |
  | 722 | 722 |  |
  | 723 | 723 | foreach($arrAddons as $key => $addonID){ |
  |  | 724 |  |
  | 724 | 725 | $addon = new UniteCreatorAddon(); |
  | 725 | 726 | $addon->initByID($addonID); |
  | 726 |  |  |
  |  | 727 |  |
  | 727 | 728 | $addons[] = $addon; |
  | 728 | 729 | $arrAddons[$key] = $addon->getID(); |
  | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_addons.class.php?rev=3090199#L996) | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_addons.class.php?rev=3097249#L997) |  |
  | 996 | 997 | \*/ |
  | 997 | 998 | public function deleteAddonFromData($data){ |
  | 998 |  |  |
  |  | 999 |  |
  | 999 | 1000 | $addonID = UniteFunctionsUC::getVal($data, "addonID"); |
  | 1000 | 1001 | UniteFunctionsUC::validateNotEmpty($addonID, "Widget ID"); |
  | 1001 | 1002 |  |
  |  | 1003 | UniteFunctionsUC::validateNumeric($addonID,"widget id"); |
  |  | 1004 |  |
  | 1002 | 1005 | $addon = new UniteCreatorAddon(); |
  | 1003 | 1006 | $addon->initByID($addonID); |
  | 1004 |  |  |
  |  | 1007 |  |
  |  | 1008 | $addonID = (int)$addonID; |
  |  | 1009 |  |
  | 1005 | 1010 | $this->db->delete(GlobalsUC::$table\_addons, "id={$addonID}"); |
  | 1006 |  |  |
  |  | 1011 |  |
  | 1007 | 1012 | $addon->triggerAfterDeleteAction(); |
  | 1008 | 1013 | } |
* ## [unlimited-elements-for-elementor/trunk/inc\_php/unitecreator\_categories.class.php](/changeset/3097249/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_categories.class.php "Show the changeset 3097249 restricted to unlimited-elements-for-elementor/trunk/inc_php/unitecreator_categories.class.php")

  | [r2541303](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_categories.class.php?rev=2541303#L853 "Show revision 2541303 of this file in browser") | [r3097249](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_categories.class.php?rev=3097249#L853 "Show revision 3097249 of this file in browser") |  |
  | --- | --- | --- |
  | 853 | 853 | private function remove($catID){ |
  | 854 | 854 |  |
  |  | 855 | $catID = UniteFunctionsUC::validateNumeric($catID,"category id"); |
  |  | 856 |  |
  | 855 | 857 | $catID = (int)$catID; |
  | 856 | 858 |  |
* ## [unlimited-elements-for-elementor/trunk/inc\_php/unitecreator\_filters\_process.class.php](/changeset/3097249/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php "Show the changeset 3097249 restricted to unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php")

  | [r3094530](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3094530#L3 "Show revision 3094530 of this file in browser") | [r3097249](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3097249#L3 "Show revision 3097249 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | \* @package Unlimited Elements |
  | 4 | 4 | \* @author unlimited-elements.com |
  | 5 |  | \* @copyright (C) 2021 Unlimited Elements, All Rights Reserved. |
  |  | 5 | \* @copyright (C) 2021 Unlimited Elements, All Rights Reserved. |
  | 6 | 6 | \* @license GNU/GPLv3 http://www.gnu.org/licenses/gpl-3.0.html |
  | 7 | 7 | \* \*/ |
  | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3094530#L11) | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3097249#L11) |  |
  | 11 | 11 |  |
  | 12 | 12 | const DEBUG\_MAIN\_QUERY = false; |
  | 13 |  |  |
  |  | 13 |  |
  | 14 | 14 | const DEBUG\_FILTER = false; |
  | 15 | 15 |  |
  | 16 | 16 | const DEBUG\_PARSED\_TERMS = false; |
  | 17 |  |  |
  |  | 17 |  |
  | 18 | 18 | private static $showDebug = false; |
  | 19 |  |  |
  |  | 19 |  |
  | 20 | 20 | private static $filters = null; |
  | 21 | 21 | private static $arrInputFiltersCache = null; |
  | 22 | 22 | private static $arrFiltersAssocCache = null; |
  | 23 |  | private static $currentTermCache = null; |
  |  | 23 | private static $currentTermCache = null; |
  | 24 | 24 | private static $isModeInit = false; |
  | 25 |  |  |
  |  | 25 |  |
  | 26 | 26 | private static $isGutenberg = false; |
  | 27 | 27 | private static $platform = false; |
  | 28 | 28 | private static $objGutenberg = null; |
  | 29 |  |  |
  |  | 29 |  |
  | 30 | 30 | private static $isScriptAdded = false; |
  | 31 | 31 | private static $isFilesAdded = false; |
  | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3094530#L34) | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3097249#L34) |  |
  | 34 | 34 | private static $isModeReplace = false; |
  | 35 | 35 | private static $numTotalPosts; |
  | 36 |  |  |
  |  | 36 |  |
  | 37 | 37 | private static $originalQueryVars = null; |
  | 38 | 38 | private $contentWidgetsDebug = array(); |
  | 39 |  | private static $lastArgs = null; |
  |  | 39 | private static $lastArgs = null; |
  | 40 | 40 | private static $isUnderAjaxSearch = false; |
  | 41 | 41 | public static $isUnderAjax = false; |
  | 42 | 42 | private static $showEchoDebug = false; |
  | 43 |  |  |
  |  | 43 |  |
  | 44 | 44 | private $hasSelectedByRequest = false; |
  | 45 | 45 | private $hasSelectedTerm = false; |
  | 46 |  |  |
  | 47 |  |  |
  |  | 46 |  |
  |  | 47 |  |
  | 48 | 48 | const TYPE\_TABS = "tabs"; |
  | 49 | 49 | const TYPE\_SELECT = "select"; |
  | 50 | 50 | const TYPE\_CHECKBOX = "checkbox"; |
  | 51 |  |  |
  |  | 51 |  |
  | 52 | 52 | const ROLE\_CHILD = "child"; |
  | 53 | 53 | const ROLE\_TERM\_CHILD = "term\_child"; |
  | 54 |  |  |
  |  | 54 |  |
  | 55 | 55 | private function \_\_\_\_\_\_\_SORT\_FILTER\_WIDGET\_DATA\_\_\_\_\_\_\_\_\_\_(){} |
  | 56 |  |  |
  |  | 56 |  |
  | 57 | 57 | /\*\* |
  | 58 | 58 | \* get sort filter data |
  | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3094530#L61) | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3097249#L61) |  |
  | 61 | 61 | \*/ |
  | 62 | 62 | public static function getSortFilterData($filterType, $params){ |
  | 63 |  |  |
  |  | 63 |  |
  | 64 | 64 | //get fields |
  | 65 |  |  |
  |  | 65 |  |
  | 66 | 66 | $arrFields = UniteFunctionsUC::getVal($params, "fields"); |
  | 67 |  |  |
  |  | 67 |  |
  | 68 | 68 | $arrFields = UniteFunctionsUC::getVal($arrFields, "fields\_fields"); |
  | 69 |  |  |
  | 70 |  |  |
  |  | 69 |  |
  |  | 70 |  |
  | 71 | 71 | if(empty($arrFields)) |
  | 72 | 72 | $arrFields = array( |
  | 73 | 73 | array("title"=>"Default","type"=>"default"), |
  | 74 | 74 | ); |
  | 75 |  |  |
  |  | 75 |  |
  | 76 | 76 | $isForWooProducts = false; |
  | 77 | 77 | if($filterType == "woo") |
  | 78 | 78 | $isForWooProducts = true; |
  | 79 |  |  |
  |  | 79 |  |
  | 80 | 80 | $arrWooTypes = array("sale\_price","sales","rating"); |
  | 81 |  |  |
  |  | 81 |  |
  | 82 | 82 | $output = array(); |
  | 83 |  |  |
  |  | 83 |  |
  | 84 | 84 | $isEnableMeta = UniteFunctionsUC::getVal($params, "enable\_meta"); |
  | 85 | 85 | $isEnableMeta = UniteFunctionsUC::strToBool($isEnableMeta); |
  | 86 |  |  |
  |  | 86 |  |
  | 87 | 87 | //find if the meta enabled - old way |
  | 88 |  |  |
  |  | 88 |  |
  | 89 | 89 | if($isEnableMeta == true){ |
  | 90 | 90 | $metaName = UniteFunctionsUC::getVal($params, "meta\_name"); |
  | 91 |  |  |
  |  | 91 |  |
  | 92 | 92 | $metaName = trim($metaName); |
  | 93 |  |  |
  |  | 93 |  |
  | 94 | 94 | if(empty($metaName)) |
  | 95 | 95 | $isEnableMeta = false; |
  | 96 | 96 | } |
  | 97 |  |  |
  |  | 97 |  |
  | 98 | 98 | foreach($arrFields as $field){ |
  | 99 |  |  |
  |  | 99 |  |
  | 100 | 100 | $title = UniteFunctionsUC::getVal($field, "title"); |
  | 101 | 101 | $type = UniteFunctionsUC::getVal($field, "type"); |
  | 102 |  |  |
  |  | 102 |  |
  | 103 | 103 | //disable meta if not selected |
  | 104 |  |  |
  |  | 104 |  |
  | 105 | 105 | $typeForOutput = null; |
  | 106 |  |  |
  |  | 106 |  |
  | 107 | 107 | if($type == "meta"){ |
  | 108 |  |  |
  |  | 108 |  |
  | 109 | 109 | $fieldMetaName = UniteFunctionsUC::getVal($field, "meta\_name"); |
  | 110 | 110 | $fieldMetaType = UniteFunctionsUC::getVal($field, "meta\_type"); |
  | 111 |  |  |
  |  | 111 |  |
  | 112 | 112 | if(empty($fieldMetaName) && $isEnableMeta == true){ |
  | 113 | 113 | $fieldMetaName = $metaName; |
  | 114 | 114 | } |
  | 115 |  |  |
  |  | 115 |  |
  | 116 | 116 | if(empty($fieldMetaName)) |
  | 117 | 117 | continue; |
  | 118 |  |  |
  |  | 118 |  |
  | 119 | 119 | if(empty($fieldMetaType)) |
  | 120 | 120 | continue; |
  | 121 | 121 |  |
  | 122 | 122 | $fieldMetaName = trim($fieldMetaName); |
  | 123 |  |  |
  |  | 123 |  |
  | 124 | 124 | $typeForOutput = "meta\_\_{$fieldMetaName}\_\_{$fieldMetaType}"; |
  | 125 | 125 | } |
  | 126 |  |  |
  |  | 126 |  |
  | 127 | 127 | //filter woo types |
  | 128 | 128 | if($isForWooProducts == false&& in\_array($type, $arrWooTypes) == true) |
  | 129 | 129 | continue; |
  | 130 |  |  |
  |  | 130 |  |
  | 131 | 131 | if(!empty($typeForOutput)) |
  | 132 | 132 | $type = $typeForOutput; |
  | 133 |  |  |
  |  | 133 |  |
  | 134 | 134 | $output[$type] = $title; |
  | 135 | 135 | } |
  | 136 |  |  |
  | 137 |  |  |
  |  | 136 |  |
  |  | 137 |  |
  | 138 | 138 | return($output); |
  | 139 | 139 | } |
  | 140 |  |  |
  | 141 |  |  |
  | 142 |  |  |
  | 143 |  |  |
  |  | 140 |  |
  |  | 141 |  |
  |  | 142 |  |
  |  | 143 |  |
  | 144 | 144 | /\*\* |
  | 145 | 145 | \* get fitler url from the given slugs |
  | 146 | 146 | \*/ |
  | 147 | 147 | private function getUrlFilter\_term($term, $taxonomyName){ |
  | 148 |  |  |
  |  | 148 |  |
  | 149 | 149 | $key = "filter-term"; |
  | 150 |  |  |
  |  | 150 |  |
  | 151 | 151 | $taxPrefix = $taxonomyName."--"; |
  | 152 |  |  |
  |  | 152 |  |
  | 153 | 153 | if($taxonomyName == "category"){ |
  | 154 | 154 | $taxPrefix = ""; |
  | 155 | 155 | $key="filter-category"; |
  | 156 | 156 | } |
  | 157 |  |  |
  |  | 157 |  |
  | 158 | 158 | $slug = $term->slug; |
  | 159 | 159 |  |
  | 160 | 160 | $value = $taxPrefix.$slug; |
  | 161 |  |  |
  |  | 161 |  |
  | 162 | 162 | $urlAddition = "{$key}=".urlencode($value); |
  | 163 |  |  |
  |  | 163 |  |
  | 164 | 164 | $urlCurrent = GlobalsUC::$current\_page\_url; |
  | 165 |  |  |
  |  | 165 |  |
  | 166 | 166 | $url = UniteFunctionsUC::addUrlParams($urlCurrent, $urlAddition); |
  | 167 |  |  |
  |  | 167 |  |
  | 168 | 168 | return($url); |
  | 169 | 169 | } |
  | 170 |  |  |
  |  | 170 |  |
  | 171 | 171 | /\*\* |
  | 172 | 172 | \* check if the term is acrive |
  | 173 | 173 | \*/ |
  | 174 | 174 | private function isTermActive($term, $arrActiveFilters = null){ |
  | 175 |  |  |
  |  | 175 |  |
  | 176 | 176 | if(empty($term)) |
  | 177 | 177 | return(false); |
  | 178 |  |  |
  |  | 178 |  |
  | 179 | 179 | if($arrActiveFilters === null) |
  | 180 | 180 | $arrActiveFilters = $this->getRequestFilters(); |
  | 181 |  |  |
  |  | 181 |  |
  | 182 | 182 | if(empty($arrActiveFilters)) |
  | 183 | 183 | return(false); |
  | 184 |  |  |
  |  | 184 |  |
  | 185 | 185 | $taxonomy = $term->taxonomy; |
  | 186 |  |  |
  |  | 186 |  |
  | 187 | 187 | $selectedTermID = UniteFunctionsUC::getVal($arrActiveFilters, $taxonomy); |
  | 188 |  |  |
  |  | 188 |  |
  | 189 | 189 | if(empty($selectedTermID)) |
  | 190 | 190 | return(false); |
  | 191 |  |  |
  |  | 191 |  |
  | 192 | 192 | if($selectedTermID === $term->term\_id) |
  | 193 | 193 | return(true); |
  | 194 |  |  |
  |  | 194 |  |
  | 195 | 195 | return(false); |
  | 196 | 196 | } |
  | 197 |  |  |
  |  | 197 |  |
  | 198 | 198 | /\*\* |
  | 199 | 199 | \* get current term by query vars |
  | 200 | 200 | \*/ |
  | 201 | 201 | private function getCurrentTermByQueryVars($queryVars){ |
  | 202 |  |  |
  |  | 202 |  |
  | 203 | 203 | if(is\_array($queryVars) == false) |
  | 204 | 204 | return(null); |
  | 205 |  |  |
  |  | 205 |  |
  | 206 | 206 | if(empty($queryVars)) |
  | 207 | 207 | return(null); |
  | 208 |  |  |
  |  | 208 |  |
  | 209 | 209 | if(count($queryVars) > 1) |
  | 210 | 210 | return(null); |
  | 211 |  |  |
  |  | 211 |  |
  | 212 | 212 | $postType = null; |
  | 213 | 213 | if(isset($queryVars["post\_type"])){ |
  | 214 |  |  |
  |  | 214 |  |
  | 215 | 215 | $postType = $queryVars["post\_type"]; |
  | 216 | 216 | unset($queryVars["post\_type"]); |
  | 217 | 217 | } |
  | 218 |  |  |
  |  | 218 |  |
  | 219 | 219 | $args = array(); |
  | 220 | 220 | if(!empty($postType)) |
  | 221 | 221 | $args["post\_type"] = $postType; |
  | 222 |  |  |
  |  | 222 |  |
  | 223 | 223 | if(!empty($queryVars)){ |
  | 224 | 224 | $taxonomy = null; |
  | 225 | 225 | $slug = null; |
  | 226 |  |  |
  |  | 226 |  |
  | 227 | 227 | foreach($queryVars as $queryTax=>$querySlug){ |
  | 228 |  |  |
  |  | 228 |  |
  | 229 | 229 | $taxonomy = $queryTax; |
  | 230 | 230 | $slug = $querySlug; |
  | 231 | 231 | } |
  | 232 |  |  |
  |  | 232 |  |
  | 233 | 233 | $args = array(); |
  | 234 | 234 | $args["taxonomy"] = $taxonomy; |
  | 235 |  | $args["slug"] = $slug; |
  | 236 |  | } |
  | 237 |  |  |
  | 238 |  |  |
  |  | 235 | $args["slug"] = $slug; |
  |  | 236 | } |
  |  | 237 |  |
  |  | 238 |  |
  | 239 | 239 | $arrTerms = get\_terms($args); |
  | 240 |  |  |
  |  | 240 |  |
  | 241 | 241 | $isError = is\_wp\_error($arrTerms); |
  | 242 |  |  |
  |  | 242 |  |
  | 243 | 243 | if($isError == true){ |
  | 244 | 244 | if(self::$showDebug == true){ |
  | 245 |  |  |
  |  | 245 |  |
  | 246 | 246 | dmp("error get terms"); |
  | 247 | 247 | dmp($args); |
  | 248 | 248 | dmp($arrTerms); |
  | 249 | 249 | } |
  | 250 |  |  |
  |  | 250 |  |
  | 251 | 251 | UniteFunctionsUC::throwError("cannot get the terms"); |
  | 252 | 252 | } |
  | 253 |  |  |
  |  | 253 |  |
  | 254 | 254 | if(empty($arrTerms)) |
  | 255 | 255 | return(null); |
  | 256 |  |  |
  |  | 256 |  |
  | 257 | 257 | $term = $arrTerms[0]; |
  | 258 |  |  |
  |  | 258 |  |
  | 259 | 259 | return($term); |
  | 260 | 260 | } |
  | 261 |  |  |
  | 262 |  |  |
  |  | 261 |  |
  |  | 262 |  |
  | 263 | 263 | /\*\* |
  | 264 | 264 | \* get current term |
  | 265 | 265 | \*/ |
  | 266 | 266 | private function getCurrentTerm(){ |
  | 267 |  |  |
  |  | 267 |  |
  | 268 | 268 | if(!empty(self::$currentTermCache)) |
  | 269 | 269 | return(self::$currentTermCache); |
  | 270 |  |  |
  |  | 270 |  |
  | 271 | 271 | if(is\_archive() == false) |
  | 272 | 272 | return(null); |
  | 273 |  |  |
  |  | 273 |  |
  | 274 | 274 | if(!empty(self::$originalQueryVars)){ |
  | 275 |  |  |
  |  | 275 |  |
  | 276 | 276 | $currentTerm = $this->getCurrentTermByQueryVars(self::$originalQueryVars); |
  | 277 | 277 | }else{ |
  | 278 | 278 | $currentTerm = get\_queried\_object(); |
  | 279 |  |  |
  | 280 |  |  |
  | 281 |  |  |
  |  | 279 |  |
  |  | 280 |  |
  |  | 281 |  |
  | 282 | 282 | if($currentTerm instanceof WP\_Term == false) |
  | 283 | 283 | $currentTerm = null; |
  | 284 | 284 | } |
  | 285 |  |  |
  |  | 285 |  |
  | 286 | 286 | self::$currentTermCache = $currentTerm; |
  | 287 |  |  |
  |  | 287 |  |
  | 288 | 288 | return($currentTerm); |
  | 289 | 289 | } |
  | 290 |  |  |
  |  | 290 |  |
  | 291 | 291 | private function \_\_\_\_\_\_\_PARSE\_INPUT\_FILTERS\_\_\_\_\_\_\_\_\_\_(){} |
  | 292 |  |  |
  |  | 292 |  |
  | 293 | 293 | /\*\* |
  | 294 | 294 | \* get request array |
  | 295 | 295 | \*/ |
  | 296 | 296 | private function getArrRequest(){ |
  | 297 |  |  |
  |  | 297 |  |
  | 298 | 298 | $request = $\_GET; |
  | 299 | 299 | if(!empty($\_POST)) |
  | 300 | 300 | $request = array\_merge($request, $\_POST); |
  | 301 |  |  |
  |  | 301 |  |
  | 302 | 302 | return($request); |
  | 303 | 303 | } |
  | 304 |  |  |
  | 305 |  |  |
  |  | 304 |  |
  |  | 305 |  |
  | 306 | 306 |  |
  | 307 | 307 | /\*\* |
  | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3094530#L309) | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3097249#L309) |  |
  | 309 | 309 | \*/ |
  | 310 | 310 | private function parseStrTerms\_groups($strValues){ |
  | 311 |  |  |
  |  | 311 |  |
  | 312 | 312 | preg\_match\_all('/\|(.\*?)\|/', $strValues, $matches); |
  | 313 | 313 |  |
  | 314 | 314 | if(empty($matches)) |
  | 315 | 315 | return(array()); |
  | 316 |  |  |
  |  | 316 |  |
  | 317 | 317 | $arrGroups = $matches[0]; |
  | 318 | 318 | $arrGroupValues = $matches[1]; |
  | 319 |  |  |
  |  | 319 |  |
  | 320 | 320 | $arrReplace = array(); |
  | 321 |  |  |
  |  | 321 |  |
  | 322 | 322 | //break into groups |
  | 323 |  |  |
  |  | 323 |  |
  | 324 | 324 | foreach($arrGroups as $index => $group){ |
  | 325 |  |  |
  |  | 325 |  |
  | 326 | 326 | $strReplace = "group".($index+1)."\_".UniteFunctionsUC::getRandomString(); |
  | 327 |  |  |
  |  | 327 |  |
  | 328 | 328 | $strGroupValues = $arrGroupValues[$index]; |
  | 329 |  |  |
  |  | 329 |  |
  | 330 | 330 | $arrReplace[$strReplace] = $strGroupValues; |
  | 331 |  |  |
  |  | 331 |  |
  | 332 | 332 | $strValues = str\_replace($group, $strReplace, $strValues); |
  | 333 | 333 | } |
  | 334 |  |  |
  |  | 334 |  |
  | 335 | 335 | //get the array |
  | 336 |  |  |
  |  | 336 |  |
  | 337 | 337 | $arrValues = $this->parseStrTerms\_values($strValues); |
  | 338 |  |  |
  |  | 338 |  |
  | 339 | 339 | foreach($arrValues as $key => $value){ |
  | 340 |  |  |
  |  | 340 |  |
  | 341 | 341 | if(isset($arrReplace[$value])){ |
  | 342 |  |  |
  |  | 342 |  |
  | 343 | 343 | $strGroupValue = $arrReplace[$value]; |
  | 344 |  |  |
  |  | 344 |  |
  | 345 | 345 | $arrGroupValue = $this->parseStrTerms\_values($strGroupValue); |
  | 346 |  |  |
  |  | 346 |  |
  | 347 | 347 | $arrGroupValue["relation"] = "OR"; |
  | 348 |  |  |
  |  | 348 |  |
  | 349 | 349 | if(count($arrGroupValue) == 1) |
  | 350 | 350 | $arrGroupValue = $arrGroupValue[0]; |
  | 351 |  |  |
  |  | 351 |  |
  | 352 | 352 | $arrValues[$key] = $arrGroupValue; |
  | 353 | 353 | } |
  | 354 |  |  |
  | 355 |  | } |
  | 356 |  |  |
  |  | 354 |  |
  |  | 355 | } |
  |  | 356 |  |
  | 357 | 357 | $arrValues["relation"] = "AND"; |
  | 358 |  |  |
  |  | 358 |  |
  | 359 | 359 | return($arrValues); |
  | 360 | 360 | } |
  | 361 |  |  |
  | 362 |  |  |
  | 363 |  |  |
  |  | 361 |  |
  |  | 362 |  |
  |  | 363 |  |
  | 364 | 364 | /\*\* |
  | 365 | 365 | \* parse the values |
  | 366 | 366 | \*/ |
  | 367 | 367 | private function parseStrTerms\_values($strValues){ |
  | 368 |  |  |
  |  | 368 |  |
  | 369 | 369 | //get the groups instead |
  | 370 |  |  |
  |  | 370 |  |
  | 371 | 371 | if(strpos($strValues,"|") !== false){ |
  | 372 |  |  |
  |  | 372 |  |
  | 373 | 373 | $arrValues = $this->parseStrTerms\_groups($strValues); |
  | 374 |  |  |
  |  | 374 |  |
  | 375 | 375 | return($arrValues); |
  | 376 | 376 | } |
  | 377 |  |  |
  |  | 377 |  |
  | 378 | 378 | $arrValues = explode(".", $strValues); |
  | 379 |  |  |
  |  | 379 |  |
  | 380 | 380 | $isTermsAnd = false; |
  | 381 | 381 | foreach($arrValues as $valueKey=>$value){ |
  | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3094530#L385) | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3097249#L385) |  |
  | 385 | 385 | } |
  | 386 | 386 | } |
  | 387 |  |  |
  |  | 387 |  |
  | 388 | 388 | if($isTermsAnd == true) |
  | 389 | 389 | $arrValues["relation"] = "AND"; |
  | 390 |  |  |
  |  | 390 |  |
  | 391 | 391 | return($arrValues); |
  | 392 | 392 | } |
  | 393 |  |  |
  | 394 |  |  |
  |  | 393 |  |
  |  | 394 |  |
  | 395 | 395 | /\*\* |
  | 396 | 396 | \* parse filters string |
  | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3094530#L399) | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3097249#L399) |  |
  | 399 | 399 |  |
  | 400 | 400 | $arrUrlKeys = $this->getUrlPartsKeys(); |
  | 401 |  |  |
  |  | 401 |  |
  | 402 | 402 | $taxSapSign = UniteFunctionsUC::getVal($arrUrlKeys, "tax\_sap","~"); |
  | 403 |  |  |
  |  | 403 |  |
  | 404 | 404 | $strFilters = trim($strFilters); |
  | 405 |  |  |
  |  | 405 |  |
  | 406 | 406 | $arrFilters = explode(";", $strFilters); |
  | 407 |  |  |
  |  | 407 |  |
  | 408 | 408 | //fill the terms |
  | 409 | 409 | $arrTerms = array(); |
  | 410 |  |  |
  |  | 410 |  |
  | 411 | 411 | foreach($arrFilters as $strFilter){ |
  | 412 |  |  |
  |  | 412 |  |
  | 413 | 413 | $arrFilter = explode($taxSapSign, $strFilter); |
  | 414 |  |  |
  |  | 414 |  |
  | 415 | 415 | if(count($arrFilter) != 2) |
  | 416 | 416 | continue; |
  | 417 |  |  |
  |  | 417 |  |
  | 418 | 418 | $key = $arrFilter[0]; |
  | 419 | 419 | $strValues = $arrFilter[1]; |
  | 420 |  |  |
  |  | 420 |  |
  | 421 | 421 | $arrValues = $this->parseStrTerms\_values($strValues); |
  | 422 |  |  |
  |  | 422 |  |
  | 423 | 423 | $arrTerms[$key] = $arrValues; |
  | 424 |  |  |
  | 425 |  | } |
  | 426 |  |  |
  | 427 |  |  |
  |  | 424 |  |
  |  | 425 | } |
  |  | 426 |  |
  |  | 427 |  |
  | 428 | 428 | //show debug terms |
  | 429 |  |  |
  |  | 429 |  |
  | 430 | 430 | if(self::DEBUG\_PARSED\_TERMS == true){ |
  | 431 |  |  |
  |  | 431 |  |
  | 432 | 432 | dmp("parsed terms"); |
  | 433 | 433 | dmp($arrTerms); |
  | 434 | 434 | exit(); |
  | 435 | 435 | } |
  | 436 |  |  |
  | 437 |  |  |
  |  | 436 |  |
  |  | 437 |  |
  | 438 | 438 | $arrOutput = array(); |
  | 439 |  |  |
  |  | 439 |  |
  | 440 | 440 | if(!empty($arrTerms)) |
  | 441 | 441 | $arrOutput[self::TYPE\_TABS] = $arrTerms; |
  | 442 |  |  |
  | 443 |  |  |
  |  | 442 |  |
  |  | 443 |  |
  | 444 | 444 | return($arrOutput); |
  | 445 | 445 | } |
  | 446 |  |  |
  |  | 446 |  |
  | 447 | 447 | /\*\* |
  | 448 | 448 | \* get orderby input filter |
  | 449 | 449 | \*/ |
  | 450 | 450 | private function getArrInputFilters\_getOrderby($arrOutput, $request){ |
  | 451 |  |  |
  |  | 451 |  |
  | 452 | 452 | $orderby = UniteFunctionsUC::getVal($request, "ucorderby"); |
  | 453 | 453 | $orderby = UniteProviderFunctionsUC::sanitizeVar($orderby, UniteFunctionsUC::SANITIZE\_KEY); |
  | 454 |  |  |
  |  | 454 |  |
  | 455 | 455 | if(empty($orderby)) |
  | 456 | 456 | return($arrOutput); |
  | 457 |  |  |
  |  | 457 |  |
  | 458 | 458 | //check if valid |
  | 459 | 459 | $arrOrderby = UniteFunctionsWPUC::getArrSortBy(true); |
  | 460 |  |  |
  |  | 460 |  |
  | 461 | 461 | if($orderby == "id") |
  | 462 | 462 | $orderby = "ID"; |
  | 463 |  |  |
  |  | 463 |  |
  | 464 | 464 | if(is\_string($orderby) && isset($arrOrderby[$orderby])) |
  | 465 | 465 | $arrOutput["orderby"] = $orderby; |
  | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3094530#L467) | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3097249#L467) |  |
  | 467 | 467 | //meta old name |
  | 468 | 468 | if($orderby == "meta"){ |
  | 469 |  |  |
  |  | 469 |  |
  | 470 | 470 | $orderbyMeta = UniteFunctionsUC::getVal($request, "ucorderby\_meta"); |
  | 471 | 471 | $orderbyMeta = UniteProviderFunctionsUC::sanitizeVar($orderbyMeta, UniteFunctionsUC::SANITIZE\_KEY); |
  | 472 |  |  |
  |  | 472 |  |
  | 473 | 473 | $orderbyMetaType = UniteFunctionsUC::getVal($request, "ucorderby\_metatype"); |
  | 474 | 474 | $orderbyMetaType = UniteProviderFunctionsUC::sanitizeVar($orderbyMetaType, UniteFunctionsUC::SANITIZE\_KEY); |
  | 475 |  |  |
  |  | 475 |  |
  | 476 | 476 | if(!empty($orderbyMeta)){ |
  | 477 | 477 | $arrOutput["orderby"] = $orderby; |
  | 478 | 478 | $arrOutput["orderby\_metaname"] = $orderbyMeta; |
  | 479 | 479 | } |
  | 480 |  |  |
  |  | 480 |  |
  | 481 | 481 | if(!empty($orderbyMetaType)) |
  | 482 | 482 | $arrOutput["orderby\_metatype"] = $orderbyMetaType; |
  | 483 |  |  |
  |  | 483 |  |
  | 484 | 484 | } |
  | 485 | 485 |  |
  | 486 | 486 | //meta new way |
  | 487 |  |  |
  |  | 487 |  |
  | 488 | 488 | if(strpos($orderby, "meta\_\_") === false) |
  | 489 | 489 | return($arrOutput); |
  | 490 |  |  |
  |  | 490 |  |
  | 491 | 491 | $arrMeta = explode("\_\_", $orderby); |
  | 492 | 492 |  |
  | 493 | 493 | if(count($arrMeta) != 3) |
  | 494 | 494 | return($arrOutput); |
  | 495 |  |  |
  |  | 495 |  |
  | 496 | 496 | $orderby = $arrMeta[0]; |
  | 497 | 497 | $metaName = $arrMeta[1]; |
  | 498 | 498 | $metaType = $arrMeta[2]; |
  | 499 |  |  |
  |  | 499 |  |
  | 500 | 500 | if($orderby != "meta") |
  | 501 | 501 | return($arrOutput); |
  | 502 |  |  |
  |  | 502 |  |
  | 503 | 503 | $arrOutput["orderby"] = $orderby; |
  | 504 | 504 | $arrOutput["orderby\_metaname"] = $metaName; |
  | 505 | 505 | $arrOutput["orderby\_metatype"] = $metaType; |
  | 506 |  |  |
  | 507 |  |  |
  |  | 506 |  |
  |  | 507 |  |
  | 508 | 508 | return($arrOutput); |
  | 509 | 509 | } |
  | 510 |  |  |
  | 511 |  |  |
  |  | 510 |  |
  |  | 511 |  |
  | 512 | 512 | /\*\* |
  | 513 | 513 | \* get filters array from input |
  | 514 | 514 | \*/ |
  | 515 | 515 | private function getArrInputFilters(){ |
  | 516 |  |  |
  |  | 516 |  |
  | 517 | 517 | if(!empty(self::$arrInputFiltersCache)) |
  | 518 | 518 | return(self::$arrInputFiltersCache); |
  | 519 |  |  |
  |  | 519 |  |
  | 520 | 520 | $request = $this->getArrRequest(); |
  | 521 |  |  |
  |  | 521 |  |
  | 522 | 522 | $strTerms = UniteFunctionsUC::getVal($request, "ucterms"); |
  | 523 |  |  |
  |  | 523 |  |
  | 524 | 524 | $arrOutput = array(); |
  | 525 |  |  |
  |  | 525 |  |
  | 526 | 526 | //parse filters |
  | 527 |  |  |
  |  | 527 |  |
  | 528 | 528 | if(!empty($strTerms)){ |
  | 529 | 529 | if(self::$showDebug == true) |
  | 530 | 530 | dmp("input filters found: $strTerms"); |
  | 531 |  |  |
  |  | 531 |  |
  | 532 | 532 | $arrOutput = $this->parseStrTerms($strTerms); |
  | 533 | 533 | } |
  | 534 |  |  |
  |  | 534 |  |
  | 535 | 535 | //page |
  | 536 |  |  |
  |  | 536 |  |
  | 537 | 537 | $page = UniteFunctionsUC::getVal($request, "ucpage"); |
  | 538 | 538 | $page = (int)$page; |
  | 539 |  |  |
  |  | 539 |  |
  | 540 | 540 | if(!empty($page)) |
  | 541 | 541 | $arrOutput["page"] = $page; |
  | 542 |  |  |
  |  | 542 |  |
  | 543 | 543 | //offset |
  | 544 | 544 | $offset = UniteFunctionsUC::getVal($request, "ucoffset"); |
  | 545 | 545 | $offset = (int)$offset; |
  | 546 |  |  |
  |  | 546 |  |
  | 547 | 547 | if(!empty($offset)) |
  | 548 | 548 | $arrOutput["offset"] = $offset; |
  | 549 |  |  |
  |  | 549 |  |
  | 550 | 550 | //num items |
  | 551 |  |  |
  |  | 551 |  |
  | 552 | 552 | $numItems = UniteFunctionsUC::getVal($request, "uccount"); |
  | 553 | 553 | $numItems = (int)$numItems; |
  | 554 |  |  |
  |  | 554 |  |
  | 555 | 555 | if(!empty($numItems)) |
  | 556 | 556 | $arrOutput["num\_items"] = $numItems; |
  | 557 |  |  |
  |  | 557 |  |
  | 558 | 558 | //search |
  | 559 | 559 | $search = UniteFunctionsUC::getVal($request, "ucs"); |
  | 560 |  |  |
  |  | 560 |  |
  | 561 | 561 | if(!empty($search)) |
  | 562 | 562 | $arrOutput["search"] = $search; |
  | 563 |  |  |
  |  | 563 |  |
  | 564 | 564 | //price |
  | 565 |  |  |
  |  | 565 |  |
  | 566 | 566 | $priceFrom = UniteFunctionsUC::getVal($request, "ucpricefrom"); |
  | 567 | 567 | $priceTo = UniteFunctionsUC::getVal($request, "ucpriceto"); |
  | 568 |  |  |
  |  | 568 |  |
  | 569 | 569 | if(!empty($priceFrom)) |
  | 570 | 570 | $arrOutput["price\_from"] = $priceFrom; |
  | 571 |  |  |
  |  | 571 |  |
  | 572 | 572 | if(!empty($priceTo)) |
  | 573 | 573 | $arrOutput["price\_to"] = $priceTo; |
  | 574 |  |  |
  | 575 |  |  |
  |  | 574 |  |
  |  | 575 |  |
  | 576 | 576 | //exclude |
  | 577 | 577 | $exclude = UniteFunctionsUC::getVal($request, "ucexclude"); |
  | 578 | 578 | $exclude = UniteProviderFunctionsUC::sanitizeVar($exclude, UniteFunctionsUC::SANITIZE\_TEXT\_FIELD); |
  | 579 |  |  |
  |  | 579 |  |
  | 580 | 580 | if(!empty($exclude)){ |
  | 581 |  |  |
  |  | 581 |  |
  | 582 | 582 | $isValid = UniteFunctionsUC::isValidIDsList($exclude); |
  | 583 |  |  |
  |  | 583 |  |
  | 584 | 584 | if($isValid == true) |
  | 585 | 585 | $arrOutput["exclude"] = $exclude; |
  | 586 | 586 | } |
  | 587 |  |  |
  |  | 587 |  |
  | 588 | 588 | //orderby |
  | 589 |  |  |
  |  | 589 |  |
  | 590 | 590 | $arrOutput = $this->getArrInputFilters\_getOrderby($arrOutput, $request); |
  | 591 |  |  |
  | 592 |  |  |
  |  | 591 |  |
  |  | 592 |  |
  | 593 | 593 | //orderdir |
  | 594 |  |  |
  |  | 594 |  |
  | 595 | 595 | $orderDir = UniteFunctionsUC::getVal($request, "ucorderdir"); |
  | 596 |  |  |
  |  | 596 |  |
  | 597 | 597 | if($orderDir == "asc" || $orderDir == "desc") |
  | 598 | 598 | $arrOutput["orderdir"] = $orderDir; |
  | 599 |  |  |
  | 600 |  |  |
  |  | 599 |  |
  |  | 600 |  |
  | 601 | 601 | self::$arrInputFiltersCache = $arrOutput; |
  | 602 |  |  |
  | 603 |  |  |
  |  | 602 |  |
  |  | 603 |  |
  | 604 | 604 | return($arrOutput); |
  | 605 | 605 | } |
  | 606 |  |  |
  | 607 |  |  |
  | 608 |  |  |
  |  | 606 |  |
  |  | 607 |  |
  |  | 608 |  |
  | 609 | 609 | /\*\* |
  | 610 | 610 | \* get filters arguments |
  | 611 | 611 | \*/ |
  | 612 | 612 | public function getRequestFilters(){ |
  | 613 |  |  |
  |  | 613 |  |
  | 614 | 614 | if(self::$filters !== null) |
  | 615 | 615 | return(self::$filters); |
  | 616 |  |  |
  |  | 616 |  |
  | 617 | 617 | self::$filters = array(); |
  | 618 |  |  |
  |  | 618 |  |
  | 619 | 619 | $arrInputFilters = $this->getArrInputFilters(); |
  | 620 |  |  |
  |  | 620 |  |
  | 621 | 621 | if(empty($arrInputFilters)) |
  | 622 | 622 | return(self::$filters); |
  | 623 |  |  |
  |  | 623 |  |
  | 624 | 624 | $arrTerms = UniteFunctionsUC::getVal($arrInputFilters, self::TYPE\_TABS); |
  | 625 |  |  |
  |  | 625 |  |
  | 626 | 626 | if(!empty($arrTerms)) |
  | 627 | 627 | self::$filters["terms"] = $arrTerms; |
  | 628 |  |  |
  |  | 628 |  |
  | 629 | 629 | //get the page |
  | 630 |  |  |
  |  | 630 |  |
  | 631 | 631 | $page = UniteFunctionsUC::getVal($arrInputFilters, "page"); |
  | 632 |  |  |
  |  | 632 |  |
  | 633 | 633 | if(!empty($page) && is\_numeric($page)) |
  | 634 | 634 | self::$filters["page"] = $page; |
  | 635 |  |  |
  |  | 635 |  |
  | 636 | 636 | //get the offset |
  | 637 |  |  |
  |  | 637 |  |
  | 638 | 638 | $offset = UniteFunctionsUC::getVal($arrInputFilters, "offset"); |
  | 639 |  |  |
  |  | 639 |  |
  | 640 | 640 | if(!empty($offset) && is\_numeric($offset)) |
  | 641 | 641 | self::$filters["offset"] = $offset; |
  | 642 |  |  |
  | 643 |  |  |
  |  | 642 |  |
  |  | 643 |  |
  | 644 | 644 | //get num items |
  | 645 | 645 | $numItems = UniteFunctionsUC::getVal($arrInputFilters, "num\_items"); |
  | 646 |  |  |
  |  | 646 |  |
  | 647 | 647 | if(!empty($numItems) && is\_numeric($numItems)) |
  | 648 | 648 | self::$filters["num\_items"] = $numItems; |
  | 649 |  |  |
  |  | 649 |  |
  | 650 | 650 | //get search |
  | 651 | 651 | $search = UniteFunctionsUC::getVal($arrInputFilters, "search"); |
  | 652 |  |  |
  |  | 652 |  |
  | 653 | 653 | if(!empty($search)) |
  | 654 | 654 | self::$filters["search"] = $search; |
  | 655 |  |  |
  |  | 655 |  |
  | 656 | 656 | //get exclude |
  | 657 | 657 | $exclude = UniteFunctionsUC::getVal($arrInputFilters, "exclude"); |
  | 658 |  |  |
  |  | 658 |  |
  | 659 | 659 | if(!empty($exclude)) |
  | 660 | 660 | self::$filters["exclude"] = $exclude; |
  | 661 |  |  |
  |  | 661 |  |
  | 662 | 662 | //get orderby |
  | 663 | 663 | $orderby = UniteFunctionsUC::getVal($arrInputFilters, "orderby"); |
  | 664 |  |  |
  |  | 664 |  |
  | 665 | 665 | if(!empty($orderby)){ |
  | 666 |  |  |
  |  | 666 |  |
  | 667 | 667 | self::$filters["orderby"] = $orderby; |
  | 668 |  |  |
  |  | 668 |  |
  | 669 | 669 | if($orderby == "meta"){ |
  | 670 | 670 | self::$filters["orderby\_metaname"] = UniteFunctionsUC::getVal($arrInputFilters, "orderby\_metaname"); |
  | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3094530#L672) | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3097249#L672) |  |
  | 672 | 672 | } |
  | 673 | 673 | } |
  | 674 |  |  |
  |  | 674 |  |
  | 675 | 675 | //get orderdir |
  | 676 | 676 | $orderdir = UniteFunctionsUC::getVal($arrInputFilters, "orderdir"); |
  | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3094530#L678) | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3097249#L678) |  |
  | 678 | 678 | if(!empty($orderdir)) |
  | 679 | 679 | self::$filters["orderdir"] = $orderdir; |
  | 680 |  |  |
  |  | 680 |  |
  | 681 | 681 | //price |
  | 682 |  |  |
  |  | 682 |  |
  | 683 | 683 | $priceFrom = UniteFunctionsUC::getVal($arrInputFilters, "price\_from"); |
  | 684 | 684 | $priceTo = UniteFunctionsUC::getVal($arrInputFilters, "price\_to"); |
  | 685 |  |  |
  |  | 685 |  |
  | 686 | 686 | if(!empty($priceFrom) && is\_numeric($priceFrom)) |
  | 687 | 687 | self::$filters["price\_from"] = $priceFrom; |
  | 688 |  |  |
  |  | 688 |  |
  | 689 | 689 | if(!empty($priceTo) && is\_numeric($priceTo)) |
  | 690 | 690 | self::$filters["price\_to"] = $priceTo; |
  | 691 |  |  |
  | 692 |  |  |
  |  | 691 |  |
  |  | 692 |  |
  | 693 | 693 | return(self::$filters); |
  | 694 | 694 | } |
  | 695 |  |  |
  | 696 |  |  |
  |  | 695 |  |
  |  | 696 |  |
  | 697 | 697 | private function \_\_\_\_\_\_\_FILTER\_ARGS\_\_\_\_\_\_\_\_\_\_(){} |
  | 698 |  |  |
  | 699 |  |  |
  |  | 698 |  |
  |  | 699 |  |
  | 700 | 700 | /\*\* |
  | 701 | 701 | \* get offset |
  | 702 | 702 | \*/ |
  | 703 | 703 | private function processRequestFilters\_setPaging($args, $page, $numItems){ |
  | 704 |  |  |
  | 705 |  | if(empty($page)) |
  |  | 704 |  |
  |  | 705 | if(empty($page)) |
  | 706 | 706 | return(null); |
  | 707 |  |  |
  |  | 707 |  |
  | 708 | 708 | $perPage = UniteFunctionsUC::getVal($args, "posts\_per\_page"); |
  | 709 |  |  |
  |  | 709 |  |
  | 710 | 710 | if(empty($perPage)) |
  | 711 | 711 | return($args); |
  | 712 |  |  |
  |  | 712 |  |
  | 713 | 713 | $offset = null; |
  | 714 | 714 | $postsPerPage = null; |
  | 715 |  |  |
  |  | 715 |  |
  | 716 | 716 | //set posts per page and offset |
  | 717 | 717 | if(!empty($numItems) && $page > 1){ |
  | 718 |  |  |
  |  | 718 |  |
  | 719 | 719 | if($page == 2) |
  | 720 | 720 | $offset = $perPage; |
  | 721 | 721 | else if($page > 2) |
  | 722 | 722 | $offset = $perPage+($page-2)\*$numItems; |
  | 723 |  |  |
  |  | 723 |  |
  | 724 | 724 | $postsPerPage = $numItems; |
  | 725 |  |  |
  |  | 725 |  |
  | 726 | 726 | }else{  //no num items |
  | 727 | 727 | $offset = ($page-1)\*$perPage; |
  | 728 | 728 | } |
  | 729 |  |  |
  |  | 729 |  |
  | 730 | 730 | if(!empty($offset)) |
  | 731 | 731 | $args["offset"] = $offset; |
  | 732 |  |  |
  |  | 732 |  |
  | 733 | 733 | if(!empty($postsPerPage)) |
  | 734 | 734 | $args["posts\_per\_page"] = $postsPerPage; |
  | 735 |  |  |
  |  | 735 |  |
  | 736 | 736 | return($args); |
  | 737 | 737 | } |
  | 738 |  |  |
  |  | 738 |  |
  | 739 | 739 | /\*\* |
  | 740 | 740 | \* get tax query from terms array |
  | 741 | 741 | \*/ |
  | 742 | 742 | private function getTaxQuery($arrTax){ |
  | 743 |  |  |
  |  | 743 |  |
  | 744 | 744 | $arrQuery = array(); |
  | 745 |  |  |
  |  | 745 |  |
  | 746 | 746 | foreach($arrTax as $taxonomy=>$arrTerms){ |
  | 747 |  |  |
  |  | 747 |  |
  | 748 | 748 | $relation = UniteFunctionsUC::getVal($arrTerms, "relation"); |
  | 749 |  |  |
  |  | 749 |  |
  | 750 | 750 | if($relation == "AND"){     //multiple |
  | 751 |  |  |
  |  | 751 |  |
  | 752 | 752 | unset($arrTerms["relation"]); |
  | 753 |  |  |
  |  | 753 |  |
  | 754 | 754 | foreach($arrTerms as $term){ |
  | 755 |  |  |
  |  | 755 |  |
  | 756 | 756 | $item = array(); |
  | 757 | 757 | $item["taxonomy"] = $taxonomy; |
  | 758 | 758 | $item["field"] = "slug"; |
  | 759 | 759 | $item["terms"] = $term; |
  | 760 |  |  |
  |  | 760 |  |
  | 761 | 761 | $arrQuery[] = $item; |
  | 762 | 762 | } |
  | 763 |  |  |
  |  | 763 |  |
  | 764 | 764 | }else{      //single  (or) |
  | 765 |  |  |
  |  | 765 |  |
  | 766 | 766 | $item = array(); |
  | 767 | 767 | $item["taxonomy"] = $taxonomy; |
  | 768 | 768 | $item["field"] = "slug"; |
  | 769 | 769 | $item["terms"] = $arrTerms; |
  | 770 |  |  |
  |  | 770 |  |
  | 771 | 771 | $arrQuery[] = $item; |
  | 772 | 772 | } |
  | 773 |  |  |
  | 774 |  | } |
  | 775 |  |  |
  |  | 773 |  |
  |  | 774 | } |
  |  | 775 |  |
  | 776 | 776 | $arrQuery["relation"] = "AND"; |
  | 777 |  |  |
  |  | 777 |  |
  | 778 | 778 | return($arrQuery); |
  | 779 | 779 | } |
  | 780 |  |  |
  |  | 780 |  |
  | 781 | 781 | /\*\* |
  | 782 | 782 | \* remove "not in" tax query |
  | 783 | 783 | \*/ |
  | 784 | 784 | private function keepNotInTaxQuery($arrTaxQuery){ |
  | 785 |  |  |
  |  | 785 |  |
  | 786 | 786 | if(empty($arrTaxQuery)) |
  | 787 | 787 | return(null); |
  | 788 |  |  |
  |  | 788 |  |
  | 789 | 789 | $arrNew = array(); |
  | 790 |  |  |
  |  | 790 |  |
  | 791 | 791 | foreach($arrTaxQuery as $tax){ |
  | 792 |  |  |
  |  | 792 |  |
  | 793 | 793 | if(isset($tax["operator"])){ |
  | 794 | 794 | $arrNew[] = $tax; |
  | 795 | 795 | continue; |
  | 796 | 796 | } |
  | 797 |  |  |
  |  | 797 |  |
  | 798 | 798 | $operator = UniteFunctionsUC::getVal($tax, "operator"); |
  | 799 | 799 | if($operator == "NOT IN") |
  | 800 | 800 | $arrNew[] = $tax; |
  | 801 | 801 | } |
  | 802 |  |  |
  |  | 802 |  |
  | 803 | 803 | return($arrNew); |
  | 804 | 804 | } |
  | 805 |  |  |
  | 806 |  |  |
  |  | 805 |  |
  |  | 806 |  |
  | 807 | 807 | /\*\* |
  | 808 | 808 | \* set arguments tax query, merge with existing if avaliable |
  | 809 | 809 | \*/ |
  | 810 | 810 | private function setArgsTaxQuery($args, $arrTaxQuery){ |
  | 811 |  |  |
  |  | 811 |  |
  | 812 | 812 | if(empty($arrTaxQuery)) |
  | 813 | 813 | return($args); |
  | 814 |  |  |
  |  | 814 |  |
  | 815 | 815 | $existingTaxQuery = UniteFunctionsUC::getVal($args, "tax\_query"); |
  | 816 |  |  |
  |  | 816 |  |
  | 817 | 817 | //if replace terms mode - just delete the existing tax query |
  | 818 | 818 | if(self::$isModeReplace == true){ |
  | 819 | 819 | $existingTaxQuery = $this->keepNotInTaxQuery($existingTaxQuery); |
  | 820 | 820 | } |
  | 821 |  |  |
  |  | 821 |  |
  | 822 | 822 | if(empty($existingTaxQuery)){ |
  | 823 |  |  |
  |  | 823 |  |
  | 824 | 824 | $args["tax\_query"] = $arrTaxQuery; |
  | 825 |  |  |
  |  | 825 |  |
  | 826 | 826 | return($args); |
  | 827 | 827 | } |
  | 828 |  |  |
  |  | 828 |  |
  | 829 | 829 | $newTaxQuery = array( |
  | 830 |  | $existingTaxQuery, |
  |  | 830 | $existingTaxQuery, |
  | 831 | 831 | $arrTaxQuery |
  | 832 | 832 | ); |
  | 833 |  |  |
  |  | 833 |  |
  | 834 | 834 | $newTaxQuery["relation"] = "AND"; |
  | 835 |  |  |
  | 836 |  |  |
  |  | 835 |  |
  |  | 836 |  |
  | 837 | 837 | $args["tax\_query"] = $newTaxQuery; |
  | 838 |  |  |
  |  | 838 |  |
  | 839 | 839 | return($args); |
  | 840 | 840 | } |
  | 841 |  |  |
  | 842 |  |  |
  |  | 841 |  |
  |  | 842 |  |
  | 843 | 843 | /\*\* |
  | 844 | 844 | \* process request filters |
  | 845 | 845 | \*/ |
  | 846 | 846 | public function processRequestFilters($args, $isFilterable, $isMainQuery = false){ |
  | 847 |  |  |
  |  | 847 |  |
  | 848 | 848 | //allow all ajax, forbid under request and not filterable. |
  | 849 |  |  |
  |  | 849 |  |
  | 850 | 850 | if($isFilterable == false) |
  | 851 | 851 | return($args); |
  | 852 |  |  |
  |  | 852 |  |
  | 853 | 853 | $arrFilters = $this->getRequestFilters(); |
  | 854 |  |  |
  |  | 854 |  |
  | 855 | 855 | $arrMetaQuery = array(); |
  | 856 |  |  |
  |  | 856 |  |
  | 857 | 857 | //---- set offset and count ---- |
  | 858 |  |  |
  |  | 858 |  |
  | 859 | 859 | $page = UniteFunctionsUC::getVal($arrFilters, "page"); |
  | 860 | 860 | $numItems = UniteFunctionsUC::getVal($arrFilters, "num\_items"); |
  | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3094530#L866) | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3097249#L866) |  |
  | 866 | 866 | $priceFrom = UniteFunctionsUC::getVal($arrFilters, "price\_from"); |
  | 867 | 867 | $priceTo = UniteFunctionsUC::getVal($arrFilters, "price\_to"); |
  | 868 |  |  |
  | 869 |  |  |
  |  | 868 |  |
  |  | 869 |  |
  | 870 | 870 | if(!empty($page)) |
  | 871 | 871 | $args = $this->processRequestFilters\_setPaging($args, $page, $numItems); |
  | 872 |  |  |
  |  | 872 |  |
  | 873 | 873 | //set paging by offset |
  | 874 | 874 | if(!empty($offset)) |
  | 875 | 875 | $args["offset"] = $offset; |
  | 876 |  |  |
  |  | 876 |  |
  | 877 | 877 | if(!empty($numItems)) |
  | 878 | 878 | $args["posts\_per\_page"] = $numItems; |
  | 879 |  |  |
  |  | 879 |  |
  | 880 | 880 | //search |
  | 881 | 881 | if(!empty($search) && $search != "\_all\_"){ |
  | 882 | 882 | $args["s"] = $search; |
  | 883 | 883 | } |
  | 884 |  |  |
  |  | 884 |  |
  | 885 | 885 | //orderby |
  | 886 | 886 | if(!empty($orderby) && $orderby != "default"){ |
  | 887 |  |  |
  |  | 887 |  |
  | 888 | 888 | $args["orderby"] = $orderby; |
  | 889 |  |  |
  |  | 889 |  |
  | 890 | 890 | if($orderby == "meta"){ |
  | 891 |  |  |
  |  | 891 |  |
  | 892 | 892 | $metaName = UniteFunctionsUC::getVal($arrFilters, "orderby\_metaname"); |
  | 893 | 893 | $metaType = UniteFunctionsUC::getVal($arrFilters, "orderby\_metatype"); |
  | 894 |  |  |
  |  | 894 |  |
  | 895 | 895 | if(!empty($metaName)){ |
  | 896 |  |  |
  |  | 896 |  |
  | 897 | 897 | if($metaType == "number") |
  | 898 | 898 | $args["orderby"] = "meta\_value\_num"; |
  | 899 | 899 | else |
  | 900 | 900 | $args["orderby"] = "meta\_value"; |
  | 901 |  |  |
  |  | 901 |  |
  | 902 | 902 | $args["meta\_key"] = $metaName; |
  | 903 |  |  |
  |  | 903 |  |
  | 904 | 904 | } |
  | 905 |  |  |
  | 906 |  | } |
  | 907 |  |  |
  |  | 905 |  |
  |  | 906 | } |
  |  | 907 |  |
  | 908 | 908 | if($orderby == UniteFunctionsWPUC::SORTBY\_PRICE){ |
  | 909 | 909 | $args["orderby"] = "meta\_value\_num"; |
  | 910 | 910 | $args["meta\_key"] = "\_price"; |
  | 911 | 911 | } |
  | 912 |  |  |
  |  | 912 |  |
  | 913 | 913 | if($orderby == UniteFunctionsWPUC::SORTBY\_SALE\_PRICE){ |
  | 914 | 914 | $args["orderby"] = "meta\_value\_num"; |
  | 915 | 915 | $args["meta\_key"] = "\_sale\_price"; |
  | 916 | 916 | } |
  | 917 |  |  |
  | 918 |  | } |
  | 919 |  |  |
  |  | 917 |  |
  |  | 918 | } |
  |  | 919 |  |
  | 920 | 920 | //orderdir |
  | 921 | 921 | if(!empty($orderdir) && $orderdir != "default"){ |
  | 922 | 922 | $args["order"] = strtoupper($orderdir); |
  | 923 | 923 | } |
  | 924 |  |  |
  | 925 |  |  |
  |  | 924 |  |
  |  | 925 |  |
  | 926 | 926 | $arrTerms = UniteFunctionsUC::getVal($arrFilters, "terms"); |
  | 927 | 927 | if(!empty($arrTerms)){ |
  | 928 |  |  |
  |  | 928 |  |
  | 929 | 929 | //combine the tax queries |
  | 930 | 930 | $arrTaxQuery = $this->getTaxQuery($arrTerms); |
  | 931 |  |  |
  |  | 931 |  |
  | 932 | 932 | if(!empty($arrTaxQuery)) |
  | 933 | 933 | $args = $this->setArgsTaxQuery($args, $arrTaxQuery); |
  | 934 | 934 | } |
  | 935 |  |  |
  |  | 935 |  |
  | 936 | 936 | //exclude |
  | 937 | 937 | if(!empty($exclude)){ |
  | 938 |  |  |
  |  | 938 |  |
  | 939 | 939 | $arrExclude = explode(",", $exclude); |
  | 940 |  |  |
  |  | 940 |  |
  | 941 | 941 | $arrExclude = array\_unique($arrExclude); |
  | 942 |  |  |
  |  | 942 |  |
  | 943 | 943 | $arrNotIn = UniteFunctionsUC::getVal($args, "post\_\_not\_in"); |
  | 944 |  |  |
  |  | 944 |  |
  | 945 | 945 | if(empty($arrNotIn)) |
  | 946 | 946 | $arrNotIn = array(); |
  | 947 |  |  |
  |  | 947 |  |
  | 948 | 948 | $arrNotIn = array\_merge($arrNotIn, $arrExclude); |
  | 949 |  |  |
  |  | 949 |  |
  | 950 | 950 | $args["post\_\_not\_in"] = $arrExclude; |
  | 951 |  |  |
  | 952 |  | } |
  | 953 |  |  |
  |  | 951 |  |
  |  | 952 | } |
  |  | 953 |  |
  | 954 | 954 | //supress all filters |
  | 955 | 955 | if(self::$isUnderAjaxSearch == true){ |
  | 956 |  |  |
  |  | 956 |  |
  | 957 | 957 | $args["suppress\_filters"] = true; |
  | 958 |  |  |
  |  | 958 |  |
  | 959 | 959 | //delete all filters in case of ajax search |
  | 960 |  |  |
  |  | 960 |  |
  | 961 | 961 | UniteCreatorAjaxSeach::supressThirdPartyFilters(); |
  | 962 |  |  |
  | 963 |  | } |
  | 964 |  |  |
  |  | 962 |  |
  |  | 963 | } |
  |  | 964 |  |
  | 965 | 965 | //Woo Prices |
  | 966 |  |  |
  |  | 966 |  |
  | 967 | 967 | if(!empty($priceFrom)){ |
  | 968 |  |  |
  |  | 968 |  |
  | 969 | 969 | $arrMetaQuery[] = array( |
  | 970 | 970 | 'key' => '\_price', |
  | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3094530#L974) | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3097249#L974) |  |
  | 974 | 974 | ); |
  | 975 | 975 | } |
  | 976 |  |  |
  |  | 976 |  |
  | 977 | 977 | if(!empty($priceTo)){ |
  | 978 |  |  |
  |  | 978 |  |
  | 979 | 979 | $arrMetaQuery[] = array( |
  | 980 | 980 | 'key' => '\_price', |
  | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3094530#L985) | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3097249#L985) |  |
  | 985 | 985 | } |
  | 986 | 986 |  |
  | 987 |  |  |
  |  | 987 |  |
  | 988 | 988 | //set the meta query |
  | 989 |  |  |
  |  | 989 |  |
  | 990 | 990 | if(!empty($arrMetaQuery)){ |
  | 991 |  |  |
  |  | 991 |  |
  | 992 | 992 | $arrExistingMeta = UniteFunctionsUC::getVal($args, "meta\_query",array()); |
  | 993 |  |  |
  |  | 993 |  |
  | 994 | 994 | $args["meta\_query"] = array\_merge($arrExistingMeta, $arrMetaQuery); |
  | 995 | 995 | } |
  | 996 | 996 |  |
  | 997 |  |  |
  |  | 997 |  |
  | 998 | 998 | if(self::$showDebug == true){ |
  | 999 |  |  |
  |  | 999 |  |
  | 1000 | 1000 | dmp("args:"); |
  | 1001 | 1001 | dmp($args); |
  | 1002 |  |  |
  |  | 1002 |  |
  | 1003 | 1003 | dmp("filters:"); |
  | 1004 | 1004 | dmp($arrFilters); |
  | 1005 | 1005 | } |
  | 1006 |  |  |
  |  | 1006 |  |
  | 1007 | 1007 | return($args); |
  | 1008 | 1008 | } |
  | 1009 | 1009 |  |
  | 1010 |  |  |
  |  | 1010 |  |
  | 1011 | 1011 | private function \_\_\_\_\_\_\_AJAX\_\_\_\_\_\_\_\_\_\_(){} |
  | 1012 |  |  |
  |  | 1012 |  |
  | 1013 | 1013 | /\*\* |
  | 1014 | 1014 | \* get addon post list name |
  | 1015 | 1015 | \*/ |
  | 1016 | 1016 | private function getAddonPostListName($addon){ |
  | 1017 |  |  |
  |  | 1017 |  |
  | 1018 | 1018 | $paramPostList = $addon->getParamByType(UniteCreatorDialogParam::PARAM\_POSTS\_LIST); |
  | 1019 |  |  |
  |  | 1019 |  |
  | 1020 | 1020 | $postListName = UniteFunctionsUC::getVal($paramPostList, "name"); |
  | 1021 |  |  |
  |  | 1021 |  |
  | 1022 | 1022 | return($postListName); |
  | 1023 | 1023 | } |
  | 1024 |  |  |
  | 1025 |  |  |
  |  | 1024 |  |
  |  | 1025 |  |
  | 1026 | 1026 | /\*\* |
  | 1027 | 1027 | \* validate if the addon ajax ready |
  | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3094530#L1029) | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3097249#L1029) |  |
  | 1029 | 1029 | \*/ |
  | 1030 | 1030 | private function validateAddonAjaxReady($addon, $arrSettingsValues){ |
  | 1031 |  |  |
  |  | 1031 |  |
  | 1032 | 1032 | $paramPostList = $addon->getParamByType(UniteCreatorDialogParam::PARAM\_POSTS\_LIST); |
  | 1033 |  |  |
  |  | 1033 |  |
  | 1034 | 1034 | $paramListing = $addon->getListingParamForOutput(); |
  | 1035 |  |  |
  |  | 1035 |  |
  | 1036 | 1036 | if(empty($paramPostList) && !empty($paramListing)) |
  | 1037 | 1037 | $paramPostList = $paramListing; |
  | 1038 |  |  |
  |  | 1038 |  |
  | 1039 | 1039 | if(empty($paramPostList)) |
  | 1040 | 1040 | UniteFunctionsUC::throwError("Widget not ready for ajax"); |
  | 1041 |  |  |
  |  | 1041 |  |
  | 1042 | 1042 | $postListName = UniteFunctionsUC::getVal($paramPostList, "name"); |
  | 1043 |  |  |
  |  | 1043 |  |
  | 1044 | 1044 | //check for ajax search |
  | 1045 | 1045 | $options = $addon->getOptions(); |
  | 1046 | 1046 | $special = UniteFunctionsUC::getVal($options, "special"); |
  | 1047 |  |  |
  |  | 1047 |  |
  | 1048 | 1048 | if($special === "ajax\_search") |
  | 1049 | 1049 | return($postListName); |
  | 1050 |  |  |
  | 1051 |  |  |
  |  | 1050 |  |
  |  | 1051 |  |
  | 1052 | 1052 | $isAjaxReady = UniteFunctionsUC::getVal($arrSettingsValues, $postListName."\_isajax"); |
  | 1053 | 1053 | $isAjaxReady = UniteFunctionsUC::strToBool($isAjaxReady); |
  | 1054 |  |  |
  |  | 1054 |  |
  | 1055 | 1055 | if($isAjaxReady == false) |
  | 1056 | 1056 | UniteFunctionsUC::throwError("The ajax is not ready for this widget"); |
  | 1057 |  |  |
  |  | 1057 |  |
  | 1058 | 1058 | return($postListName); |
  | 1059 | 1059 | } |
  | 1060 |  |  |
  | 1061 |  |  |
  |  | 1060 |  |
  |  | 1061 |  |
  | 1062 | 1062 | /\*\* |
  | 1063 | 1063 | \* process the html output - convert all the links, remove the query part |
  | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3094530#L1066) | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3097249#L1066) |  |
  | 1066 | 1066 |  |
  | 1067 | 1067 | $currentUrl = GlobalsUC::$current\_page\_url; |
  | 1068 |  |  |
  |  | 1068 |  |
  | 1069 | 1069 | $arrUrl = parse\_url($currentUrl); |
  | 1070 |  |  |
  |  | 1070 |  |
  | 1071 | 1071 | $query = "?".UniteFunctionsUC::getVal($arrUrl, "query"); |
  | 1072 |  |  |
  |  | 1072 |  |
  | 1073 | 1073 | $html = str\_replace($query, "", $html); |
  | 1074 |  |  |
  |  | 1074 |  |
  | 1075 | 1075 | $query = str\_replace("&", "&#038;", $query); |
  | 1076 |  |  |
  |  | 1076 |  |
  | 1077 | 1077 | $html = str\_replace($query, "", $html); |
  | 1078 | 1078 |  |
  | 1079 | 1079 | return($html); |
  | 1080 | 1080 | } |
  | 1081 |  |  |
  |  | 1081 |  |
  | 1082 | 1082 | /\*\* |
  | 1083 | 1083 | \* modify settings values before set to addon |
  | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3094530#L1085) | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3097249#L1085) |  |
  | 1085 | 1085 | \*/ |
  | 1086 | 1086 | private function modifySettingsValues($arrSettingsValues, $postListName){ |
  | 1087 |  |  |
  |  | 1087 |  |
  | 1088 | 1088 | $paginationType = UniteFunctionsUC::getVal($arrSettingsValues, "pagination\_type"); |
  | 1089 |  |  |
  |  | 1089 |  |
  | 1090 | 1090 | if(!empty($paginationType)) |
  | 1091 | 1091 | $arrSettingsValues[$postListName."\_pagination\_type"] = $paginationType; |
  | 1092 | 1092 |  |
  | 1093 |  | return($arrSettingsValues); |
  | 1094 |  | } |
  |  | 1093 | return($arrSettingsValues); |
  |  | 1094 | } |
  |  | 1095 |  |
  |  | 1096 |  |
  |  | 1097 | /\*\* |
  |  | 1098 | \* get content element html |
  |  | 1099 | \*/ |
  |  | 1100 | private function getContentWidgetHtml($arrContent, $elementID, $isGrid = true){ |
  | 1095 | 1101 |  |
  | 1096 |  |  |
  | 1097 |  | ~~/\*\*~~ |
  | 1098 |  | ~~\* get content element html~~ |
  | 1099 |  | ~~\*/~~ |
  | 1100 |  | ~~private function getContentWidgetHtml($arrContent, $elementID, $isGrid = true){~~ |
  | 1101 |  |  |
  | 1102 | 1102 | if(self::$isGutenberg == false) |
  | 1103 | 1103 | $arrElement = HelperProviderCoreUC\_EL::getArrElementFromContent($arrContent, $elementID); |
  | 1104 | 1104 | else |
  | 1105 |  | $arrElement = self::$objGutenberg->getBlockByRootI~~D~~($arrContent, $elementID); |
  |  | 1105 | $arrElement = self::$objGutenberg->getBlockByRootId($arrContent, $elementID); |
  | 1106 | 1106 |  |
  | 1107 | 1107 | if(empty($arrElement)){ |
  | 1108 |  |  |
  |  | 1108 |  |
  | 1109 | 1109 | UniteFunctionsUC::throwError(self::$platform." Widget with id: $elementID not found"); |
  | 1110 | 1110 | } |
  | 1111 |  |  |
  | 1112 |  |  |
  |  | 1111 |  |
  |  | 1112 |  |
  | 1113 | 1113 | //Elementor Validations |
  | 1114 |  |  |
  |  | 1114 |  |
  | 1115 | 1115 | if(self::$isGutenberg == false){ |
  | 1116 |  |  |
  |  | 1116 |  |
  | 1117 | 1117 | $type = UniteFunctionsUC::getVal($arrElement, "elType"); |
  | 1118 |  |  |
  |  | 1118 |  |
  | 1119 | 1119 | if($type != "widget") |
  | 1120 | 1120 | UniteFunctionsUC::throwError("The element is not a widget"); |
  | 1121 |  |  |
  |  | 1121 |  |
  | 1122 | 1122 | $widgetType = UniteFunctionsUC::getVal($arrElement, "widgetType"); |
  | 1123 |  |  |
  |  | 1123 |  |
  | 1124 | 1124 | if(strpos($widgetType, "ucaddon\_") === false){ |
  | 1125 |  |  |
  |  | 1125 |  |
  | 1126 | 1126 | if($widgetType == "global") |
  | 1127 | 1127 | UniteFunctionsUC::throwError("Ajax filtering doesn't work with global widgets. Please change the grid to regular widget."); |
  | 1128 |  |  |
  |  | 1128 |  |
  | 1129 | 1129 | UniteFunctionsUC::throwError("Cannot output widget content for widget: $widgetType"); |
  | 1130 | 1130 | } |
  | 1131 |  |  |
  | 1132 |  | } |
  | 1133 |  |  |
  |  | 1131 |  |
  |  | 1132 | } |
  |  | 1133 |  |
  | 1134 | 1134 | //get settings values |
  | 1135 |  |  |
  |  | 1135 |  |
  | 1136 | 1136 | if(self::$isGutenberg == false) |
  | 1137 | 1137 | $arrSettingsValues = UniteFunctionsUC::getVal($arrElement, "settings"); |
  | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3094530#L1139) | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3097249#L1139) |  |
  | 1139 | 1139 | $arrSettingsValues = self::$objGutenberg->getSettingsFromBlock($arrElement); |
  | 1140 | 1140 |  |
  | 1141 |  |  |
  |  | 1141 |  |
  | 1142 | 1142 | //init addon |
  | 1143 |  |  |
  |  | 1143 |  |
  | 1144 | 1144 | $addon = new UniteCreatorAddon(); |
  | 1145 |  |  |
  |  | 1145 |  |
  | 1146 | 1146 | if(self::$isGutenberg == false){        //init in elementor |
  | 1147 |  |  |
  |  | 1147 |  |
  | 1148 | 1148 | $widgetName = str\_replace("ucaddon\_", "", $widgetType); |
  | 1149 | 1149 | $addon->initByAlias($widgetName, GlobalsUC::ADDON\_TYPE\_ELEMENTOR); |
  | 1150 |  |  |
  |  | 1150 |  |
  | 1151 | 1151 | }else{      //init in gutenberg |
  | 1152 |  |  |
  |  | 1152 |  |
  | 1153 | 1153 | $blockName = UniteFunctionsUC::getVal($arrElement, "blockName"); |
  | 1154 | 1154 | $addon->initByBlockName($blockName, GlobalsUC::ADDON\_TYPE\_ELEMENTOR); |
  | 1155 | 1155 | } |
  | 1156 |  |  |
  | 1157 |  |  |
  |  | 1156 |  |
  |  | 1157 |  |
  | 1158 | 1158 | //make a check that ajax option is on in this widget |
  | 1159 |  |  |
  |  | 1159 |  |
  | 1160 | 1160 | if($isGrid == true){ |
  | 1161 |  |  |
  |  | 1161 |  |
  | 1162 | 1162 | $postListName = $this->validateAddonAjaxReady($addon, $arrSettingsValues); |
  | 1163 |  |  |
  |  | 1163 |  |
  | 1164 | 1164 | $arrSettingsValues = $this->modifySettingsValues($arrSettingsValues, $postListName); |
  | 1165 | 1165 | } |
  | 1166 |  |  |
  |  | 1166 |  |
  | 1167 | 1167 | $addon->setParamsValues($arrSettingsValues); |
  | 1168 |  |  |
  | 1169 |  |  |
  |  | 1168 |  |
  |  | 1169 |  |
  | 1170 | 1170 | //init the ajax search object to modify the post search list, if available |
  | 1171 | 1171 | if(GlobalsProviderUC::$isUnderAjaxSearch){ |
  | 1172 |  |  |
  |  | 1172 |  |
  | 1173 | 1173 | $objAjaxSearch = new UniteCreatorAjaxSeach(); |
  | 1174 | 1174 | $objAjaxSearch->initCustomAjaxSeach($addon); |
  | 1175 | 1175 | } |
  | 1176 |  |  |
  |  | 1176 |  |
  | 1177 | 1177 | //------ get the html output |
  | 1178 |  |  |
  |  | 1178 |  |
  | 1179 | 1179 | //collect the debug html |
  | 1180 | 1180 | if(self::$showDebug == false) |
  | 1181 | 1181 | ob\_start(); |
  | 1182 |  |  |
  |  | 1182 |  |
  | 1183 | 1183 | $objOutput = new UniteCreatorOutput(); |
  | 1184 |  |  |
  |  | 1184 |  |
  | 1185 | 1185 | $isDebugFromGet = HelperUC::hasPermissionsFromQuery("ucfieldsdebug"); |
  | 1186 |  |  |
  |  | 1186 |  |
  | 1187 | 1187 | if($isDebugFromGet == true) |
  | 1188 | 1188 | $objOutput->showDebugData(true); |
  | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3094530#L1191) | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3097249#L1191) |  |
  | 1191 | 1191 |  |
  | 1192 | 1192 | if($isDebugFromGet == true){ |
  | 1193 |  |  |
  |  | 1193 |  |
  | 1194 | 1194 | HelperProviderUC::showLastQueryPosts(); |
  | 1195 |  |  |
  |  | 1195 |  |
  | 1196 | 1196 | dmp("End Here"); |
  | 1197 | 1197 | exit(); |
  | 1198 | 1198 | } |
  | 1199 |  |  |
  |  | 1199 |  |
  | 1200 | 1200 | if(self::$showDebug == false){ |
  | 1201 | 1201 | $htmlDebug = ob\_get\_contents(); |
  | 1202 |  |  |
  |  | 1202 |  |
  | 1203 | 1203 | ob\_end\_clean(); |
  | 1204 | 1204 | } |
  | 1205 | 1205 |  |
  | 1206 |  |  |
  |  | 1206 |  |
  | 1207 | 1207 | $output = array(); |
  | 1208 |  |  |
  |  | 1208 |  |
  | 1209 | 1209 | //get only items |
  | 1210 | 1210 | if($isGrid == true){ |
  | 1211 |  |  |
  |  | 1211 |  |
  | 1212 | 1212 | $arrHtml = $objOutput->getHtmlItems(); |
  | 1213 |  |  |
  |  | 1213 |  |
  | 1214 | 1214 | $output["html"] = UniteFunctionsUC::getVal($arrHtml, "html\_items1"); |
  | 1215 | 1215 | $output["html2"] = UniteFunctionsUC::getVal($arrHtml, "html\_items2"); |
  | 1216 |  |  |
  |  | 1216 |  |
  | 1217 | 1217 | $output["uc\_id"] = $objOutput->getWidgetID(); |
  | 1218 |  |  |
  | 1219 |  |  |
  |  | 1218 |  |
  |  | 1219 |  |
  | 1220 | 1220 | }else{      //not a grid - output of html template |
  | 1221 | 1221 |  |
  | 1222 | 1222 | $htmlBody = $objOutput->getHtmlOnly(); |
  | 1223 |  |  |
  |  | 1223 |  |
  | 1224 | 1224 | $htmlBody = $this->processAjaxHtmlOutput($htmlBody); |
  | 1225 |  |  |
  |  | 1225 |  |
  | 1226 | 1226 | $output["html"] = $htmlBody; |
  | 1227 | 1227 | } |
  | 1228 |  |  |
  | 1229 |  |  |
  |  | 1228 |  |
  |  | 1229 |  |
  | 1230 | 1230 | if(!empty($htmlDebug)) |
  | 1231 | 1231 | $output["html\_debug"] = $htmlDebug; |
  | 1232 |  |  |
  |  | 1232 |  |
  | 1233 | 1233 | return($output); |
  | 1234 | 1234 | } |
  | 1235 |  |  |
  | 1236 |  |  |
  |  | 1235 |  |
  |  | 1236 |  |
  | 1237 | 1237 | /\*\* |
  | 1238 | 1238 | \* get content widgets html |
  | 1239 | 1239 | \*/ |
  | 1240 | 1240 | private function getContentWidgetsHTML($arrContent, $strIDs, $isGrid = false){ |
  | 1241 |  |  |
  |  | 1241 |  |
  | 1242 | 1242 | if(empty($strIDs)) |
  | 1243 | 1243 | return(null); |
  | 1244 |  |  |
  |  | 1244 |  |
  | 1245 | 1245 | $arrIDs = explode(",", $strIDs); |
  | 1246 |  |  |
  |  | 1246 |  |
  | 1247 | 1247 | $arrHTML = array(); |
  | 1248 |  |  |
  |  | 1248 |  |
  | 1249 | 1249 | $this->contentWidgetsDebug = array(); |
  | 1250 |  |  |
  |  | 1250 |  |
  | 1251 | 1251 | foreach($arrIDs as $elementID){ |
  | 1252 |  |  |
  |  | 1252 |  |
  | 1253 | 1253 | $output = $this->getContentWidgetHtml($arrContent, $elementID, $isGrid); |
  | 1254 |  |  |
  |  | 1254 |  |
  | 1255 | 1255 | $htmlDebug = UniteFunctionsUC::getVal($output, "html\_debug"); |
  | 1256 |  |  |
  |  | 1256 |  |
  | 1257 | 1257 | $html = UniteFunctionsUC::getVal($output, "html"); |
  | 1258 | 1258 | $html2 = UniteFunctionsUC::getVal($output, "html2"); |
  | 1259 |  |  |
  |  | 1259 |  |
  | 1260 | 1260 | //collect the debug |
  | 1261 | 1261 | if(!empty($htmlDebug)) |
  | 1262 | 1262 | $this->contentWidgetsDebug[$elementID] = $htmlDebug; |
  | 1263 |  |  |
  |  | 1263 |  |
  | 1264 | 1264 | if($isGrid == false){ |
  | 1265 | 1265 | $arrHTML[$elementID] = $html; |
  | 1266 | 1266 | continue; |
  | 1267 | 1267 | } |
  | 1268 |  |  |
  |  | 1268 |  |
  | 1269 | 1269 | //if case of grid |
  | 1270 |  |  |
  | 1271 |  |  |
  |  | 1270 |  |
  |  | 1271 |  |
  | 1272 | 1272 | $arrOutput = array(); |
  | 1273 | 1273 | $arrOutput["html\_items"] = $html; |
  | 1274 |  |  |
  |  | 1274 |  |
  | 1275 | 1275 | if(!empty($html2)) |
  | 1276 | 1276 | $arrOutput["html\_items2"] = $html2; |
  | 1277 |  |  |
  |  | 1277 |  |
  | 1278 | 1278 | $arrHTML[$elementID] = $arrOutput; |
  | 1279 |  |  |
  | 1280 |  | } |
  | 1281 |  |  |
  |  | 1279 |  |
  |  | 1280 | } |
  |  | 1281 |  |
  | 1282 | 1282 | return($arrHTML); |
  | 1283 | 1283 | } |
  | 1284 | 1284 |  |
  | 1285 |  |  |
  |  | 1285 |  |
  | 1286 | 1286 | /\*\* |
  | 1287 | 1287 | \* get init filtres taxonomy request |
  | 1288 | 1288 | \*/ |
  | 1289 | 1289 | private function getInitFiltersTaxRequest($request, $strTestIDs){ |
  | 1290 |  |  |
  |  | 1290 |  |
  | 1291 | 1291 | if(strpos($request, "WHERE 1=2") !== false) |
  | 1292 | 1292 | return(null); |
  | 1293 |  |  |
  |  | 1293 |  |
  | 1294 | 1294 | $posLimit = strpos($request, "LIMIT"); |
  | 1295 |  |  |
  |  | 1295 |  |
  | 1296 | 1296 | if($posLimit){ |
  | 1297 | 1297 | $request = substr($request, 0, $posLimit-1); |
  | 1298 | 1298 | $request = trim($request); |
  | 1299 | 1299 | } |
  | 1300 |  |  |
  |  | 1300 |  |
  | 1301 | 1301 | //remove the calc found rows |
  | 1302 |  |  |
  |  | 1302 |  |
  | 1303 | 1303 | $request = str\_replace("SQL\_CALC\_FOUND\_ROWS", "", $request); |
  | 1304 |  |  |
  |  | 1304 |  |
  | 1305 | 1305 | $prefix = UniteProviderFunctionsUC::$tablePrefix; |
  | 1306 |  |  |
  |  | 1306 |  |
  | 1307 | 1307 | $request = str\_replace($prefix."posts.\*", $prefix."posts.id", $request); |
  | 1308 |  |  |
  | 1309 |  | //wrap it in get term id's request |
  | 1310 |  |  |
  |  | 1308 |  |
  |  | 1309 | //wrap it in get term id's request |
  |  | 1310 |  |
  | 1311 | 1311 | $arrTermIDs = explode(",", $strTestIDs); |
  | 1312 |  |  |
  |  | 1312 |  |
  | 1313 | 1313 | if(empty($arrTermIDs)) |
  | 1314 | 1314 | return(null); |
  | 1315 |  |  |
  |  | 1315 |  |
  | 1316 | 1316 | $selectTerms = ""; |
  | 1317 | 1317 | $selectTop = ""; |
  | 1318 |  |  |
  |  | 1318 |  |
  | 1319 | 1319 | $query = "SELECT \n"; |
  | 1320 |  |  |
  |  | 1320 |  |
  | 1321 | 1321 | foreach($arrTermIDs as $termID){ |
  | 1322 |  |  |
  |  | 1322 |  |
  | 1323 | 1323 | if(!empty($selectTerms)){ |
  | 1324 | 1324 | $selectTerms .= ",\n"; |
  | 1325 | 1325 | $selectTop .= ",\n"; |
  | 1326 | 1326 | } |
  | 1327 |  |  |
  |  | 1327 |  |
  | 1328 | 1328 | $name = "term\_$termID"; |
  | 1329 |  |  |
  |  | 1329 |  |
  | 1330 | 1330 | $selectTerms .= "SUM(if(tt.`parent` = $termID OR tt.`term\_id` = $termID, 1, 0)) AS $name"; |
  | 1331 |  |  |
  |  | 1331 |  |
  | 1332 | 1332 | $selectTop .= "SUM(if($name > 0, 1, 0)) as $name"; |
  | 1333 |  |  |
  | 1334 |  | } |
  | 1335 |  |  |
  |  | 1333 |  |
  |  | 1334 | } |
  |  | 1335 |  |
  | 1336 | 1336 | $query .= $selectTerms; |
  | 1337 |  |  |
  |  | 1337 |  |
  | 1338 | 1338 | $sql = " |
  | 1339 | 1339 | FROM `{$prefix}posts` p |
  | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3094530#L1343) | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3097249#L1343) |  |
  | 1343 | 1343 | ({$request}) \n |
  | 1344 | 1344 | GROUP BY p.`id`"; |
  | 1345 |  |  |
  |  | 1345 |  |
  | 1346 | 1346 | $query .= $sql; |
  | 1347 |  |  |
  |  | 1347 |  |
  | 1348 | 1348 | $fullQuery = "SELECT $selectTop from($query) as summary"; |
  | 1349 | 1349 |  |
  | 1350 |  |  |
  |  | 1350 |  |
  | 1351 | 1351 | return($fullQuery); |
  | 1352 | 1352 | } |
  | 1353 |  |  |
  | 1354 |  |  |
  |  | 1353 |  |
  |  | 1354 |  |
  | 1355 | 1355 |  |
  | 1356 | 1356 | /\*\* |
  | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3094530#L1358) | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3097249#L1358) |  |
  | 1358 | 1358 | \*/ |
  | 1359 | 1359 | private function modifyFoundTermsIDs($arrFoundTermIDs){ |
  | 1360 |  |  |
  |  | 1360 |  |
  | 1361 | 1361 | if(isset($arrFoundTermIDs[0])) |
  | 1362 | 1362 | $arrFoundTermIDs = $arrFoundTermIDs[0]; |
  | 1363 |  |  |
  |  | 1363 |  |
  | 1364 | 1364 | $arrTermsAssoc = array(); |
  | 1365 |  |  |
  |  | 1365 |  |
  | 1366 | 1366 | foreach($arrFoundTermIDs as $strID=>$count){ |
  | 1367 | 1367 |  |
  | 1368 | 1368 | $termID = str\_replace("term\_", "", $strID); |
  | 1369 |  |  |
  |  | 1369 |  |
  | 1370 | 1370 | $arrTermsAssoc[$termID] = $count; |
  | 1371 | 1371 | } |
  | 1372 |  |  |
  |  | 1372 |  |
  | 1373 | 1373 | return($arrTermsAssoc); |
  | 1374 | 1374 | } |
  | 1375 |  |  |
  | 1376 |  |  |
  |  | 1375 |  |
  |  | 1376 |  |
  | 1377 | 1377 | /\*\* |
  | 1378 | 1378 | \* get widget ajax data |
  | 1379 | 1379 | \*/ |
  | 1380 | 1380 | private function putWidgetGridFrontAjaxData(){ |
  | 1381 |  |  |
  |  | 1381 |  |
  | 1382 | 1382 | //validate by response code |
  | 1383 |  |  |
  |  | 1383 |  |
  | 1384 | 1384 | $responseCode = http\_response\_code(); |
  | 1385 |  |  |
  |  | 1385 |  |
  | 1386 | 1386 | if($responseCode != 200){ |
  | 1387 | 1387 | http\_response\_code(200); |
  | 1388 | 1388 | UniteFunctionsUC::throwError("Request not allowed, please make sure the ajax is allowed for the ajax grid"); |
  | 1389 | 1389 | } |
  | 1390 |  |  |
  |  | 1390 |  |
  | 1391 | 1391 | //init widget by post id and element id |
  | 1392 |  |  |
  |  | 1392 |  |
  | 1393 | 1393 | self::$platform = UniteFunctionsUC::getPostGetVariable("platform","",UniteFunctionsUC::SANITIZE\_TEXT\_FIELD); |
  | 1394 |  |  |
  |  | 1394 |  |
  | 1395 | 1395 | self::$isGutenberg = (self::$platform == "gutenberg"); |
  | 1396 |  |  |
  | 1397 |  |  |
  |  | 1396 |  |
  |  | 1397 |  |
  | 1398 | 1398 | $layoutID = UniteFunctionsUC::getPostGetVariable("layoutid","",UniteFunctionsUC::SANITIZE\_KEY); |
  | 1399 | 1399 | $elementID = UniteFunctionsUC::getPostGetVariable("elid","",UniteFunctionsUC::SANITIZE\_KEY); |
  | 1400 |  |  |
  |  | 1400 |  |
  | 1401 | 1401 | $addElIDs = UniteFunctionsUC::getPostGetVariable("addelids","",UniteFunctionsUC::SANITIZE\_TEXT\_FIELD); |
  | 1402 | 1402 | $syncIDs = UniteFunctionsUC::getPostGetVariable("syncelids","",UniteFunctionsUC::SANITIZE\_TEXT\_FIELD);   //additional grids |
  | 1403 |  |  |
  |  | 1403 |  |
  | 1404 | 1404 | $isModeFiltersInit = UniteFunctionsUC::getPostGetVariable("modeinit","",UniteFunctionsUC::SANITIZE\_TEXT\_FIELD); |
  | 1405 | 1405 | $isModeFiltersInit = UniteFunctionsUC::strToBool($isModeFiltersInit); |
  | 1406 |  |  |
  |  | 1406 |  |
  | 1407 | 1407 | self::$isModeInit = $isModeFiltersInit; |
  | 1408 |  |  |
  |  | 1408 |  |
  | 1409 | 1409 | $testTermIDs = UniteFunctionsUC::getPostGetVariable("testtermids","",UniteFunctionsUC::SANITIZE\_TEXT\_FIELD); |
  | 1410 | 1410 | UniteFunctionsUC::validateIDsList($testTermIDs); |
  | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3094530#L1413) | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3097249#L1413) |  |
  | 1413 | 1413 | $isModeReplace = UniteFunctionsUC::getPostGetVariable("ucreplace","",UniteFunctionsUC::SANITIZE\_TEXT\_FIELD); |
  | 1414 | 1414 | $isModeReplace = UniteFunctionsUC::strToBool($isModeReplace); |
  | 1415 |  |  |
  |  | 1415 |  |
  | 1416 | 1416 | GlobalsProviderUC::$isUnderAjax = true; |
  | 1417 |  |  |
  |  | 1417 |  |
  | 1418 | 1418 | self::$isModeReplace = $isModeReplace; |
  | 1419 |  |  |
  |  | 1419 |  |
  | 1420 | 1420 | //if($isModeFiltersInit == true) |
  | 1421 | 1421 | //GlobalsProviderUC::$skipRunPostQueryOnce = true; |
  | 1422 |  |  |
  |  | 1422 |  |
  | 1423 | 1423 | if(self::$isGutenberg == false) |
  | 1424 | 1424 | $arrContent = HelperProviderCoreUC\_EL::getElementorContentByPostID($layoutID); |
  | 1425 | 1425 | else{   //gutenberg |
  | 1426 |  |  |
  |  | 1426 |  |
  | 1427 | 1427 | self::$objGutenberg = new UniteCreatorGutenbergIntegrate(); |
  | 1428 |  |  |
  |  | 1428 |  |
  | 1429 | 1429 | $arrContent = self::$objGutenberg->getPostBlocks($layoutID); |
  | 1430 | 1430 | } |
  | 1431 |  |  |
  |  | 1431 |  |
  | 1432 | 1432 | if(empty($arrContent)) |
  | 1433 | 1433 | UniteFunctionsUC::throwError(self::$platform." content not found"); |
  | 1434 |  |  |
  |  | 1434 |  |
  | 1435 | 1435 | //run the post query |
  | 1436 | 1436 | $arrHtmlWidget = $this->getContentWidgetHtml($arrContent, $elementID); |
  | 1437 |  |  |
  |  | 1437 |  |
  | 1438 | 1438 | if(empty(GlobalsProviderUC::$lastPostQuery)) |
  | 1439 | 1439 | self::$numTotalPosts = 0; |
  | 1440 | 1440 | else |
  | 1441 | 1441 | self::$numTotalPosts = GlobalsProviderUC::$lastPostQuery->found\_posts; |
  | 1442 |  |  |
  |  | 1442 |  |
  | 1443 | 1443 | //find the term id's for test (find or not in the current posts query) |
  | 1444 | 1444 | if(!empty($testTermIDs)){ |
  | 1445 |  |  |
  |  | 1445 |  |
  | 1446 | 1446 | if(self::$showDebug == true) |
  | 1447 | 1447 | dmp("---- Test Not Empty Terms----"); |
  | 1448 |  |  |
  |  | 1448 |  |
  | 1449 | 1449 | $args = GlobalsProviderUC::$lastQueryArgs; |
  | 1450 |  |  |
  |  | 1450 |  |
  | 1451 | 1451 | if(self::$showDebug == true){ |
  | 1452 | 1452 | dmp("--- Last Query Args:"); |
  | 1453 | 1453 | dmp($args); |
  | 1454 | 1454 | } |
  | 1455 |  |  |
  |  | 1455 |  |
  | 1456 | 1456 | $query = new WP\_Query($args); |
  | 1457 |  |  |
  |  | 1457 |  |
  | 1458 | 1458 | $request = $query->request; |
  | 1459 |  |  |
  |  | 1459 |  |
  | 1460 | 1460 | $taxRequest = $this->getInitFiltersTaxRequest($request, $testTermIDs); |
  | 1461 |  |  |
  |  | 1461 |  |
  | 1462 | 1462 | if(self::$showDebug == true){ |
  | 1463 |  |  |
  |  | 1463 |  |
  | 1464 | 1464 | dmp("---- Terms request: "); |
  | 1465 | 1465 | dmp($taxRequest); |
  | 1466 | 1466 | } |
  | 1467 |  |  |
  |  | 1467 |  |
  | 1468 | 1468 | $arrFoundTermIDs = array(); |
  | 1469 |  |  |
  |  | 1469 |  |
  | 1470 | 1470 | if(!empty($taxRequest)){ |
  | 1471 |  |  |
  |  | 1471 |  |
  | 1472 | 1472 | $db = HelperUC::getDB(); |
  | 1473 | 1473 | try{ |
  | 1474 |  |  |
  |  | 1474 |  |
  | 1475 | 1475 | $arrFoundTermIDs = $db->fetchSql($taxRequest); |
  | 1476 | 1476 | $arrFoundTermIDs = $this->modifyFoundTermsIDs($arrFoundTermIDs); |
  | 1477 |  |  |
  |  | 1477 |  |
  | 1478 | 1478 | }catch(Exception $e){ |
  | 1479 | 1479 | //just leave it empty |
  | 1480 | 1480 | } |
  | 1481 | 1481 | } |
  | 1482 |  |  |
  | 1483 |  |  |
  |  | 1482 |  |
  |  | 1483 |  |
  | 1484 | 1484 | if(self::$showDebug == true){ |
  | 1485 |  |  |
  |  | 1485 |  |
  | 1486 | 1486 | dmp("--- result - terms with num posts"); |
  | 1487 | 1487 | dmp($arrFoundTermIDs); |
  | 1488 | 1488 | } |
  | 1489 |  |  |
  |  | 1489 |  |
  | 1490 | 1490 | //set the test term id's for the output |
  | 1491 |  | GlobalsProviderUC::$arrTestTermIDs = $arrFoundTermIDs; |
  | 1492 |  | } |
  | 1493 |  |  |
  |  | 1491 | GlobalsProviderUC::$arrTestTermIDs = $arrFoundTermIDs; |
  |  | 1492 | } |
  |  | 1493 |  |
  | 1494 | 1494 | $htmlGridItems = UniteFunctionsUC::getVal($arrHtmlWidget, "html"); |
  | 1495 | 1495 | $htmlGridItems2 = UniteFunctionsUC::getVal($arrHtmlWidget, "html2"); |
  | 1496 |  |  |
  |  | 1496 |  |
  | 1497 | 1497 | //replace widget id |
  | 1498 |  | $widgetHTMLID = UniteFunctionsUC::getVal($arrHtmlWidget, "uc\_id"); |
  | 1499 |  |  |
  |  | 1498 | $widgetHTMLID = UniteFunctionsUC::getVal($arrHtmlWidget, "uc\_id"); |
  |  | 1499 |  |
  | 1500 | 1500 | if(!empty($widgetHTMLID)){ |
  | 1501 |  |  |
  |  | 1501 |  |
  | 1502 | 1502 | $htmlGridItems = str\_replace($widgetHTMLID, "%uc\_widget\_id%", $htmlGridItems); |
  | 1503 | 1503 | $htmlGridItems2 = str\_replace($widgetHTMLID, "%uc\_widget\_id%", $htmlGridItems2); |
  | 1504 | 1504 | } |
  | 1505 |  |  |
  |  | 1505 |  |
  | 1506 | 1506 | $htmlDebug = UniteFunctionsUC::getVal($arrHtmlWidget, "html\_debug"); |
  | 1507 |  |  |
  |  | 1507 |  |
  | 1508 | 1508 | $addWidgetsHTML = $this->getContentWidgetsHTML($arrContent, $addElIDs); |
  | 1509 |  |  |
  |  | 1509 |  |
  | 1510 | 1510 | $syncWidgetsHTML = $this->getContentWidgetsHTML($arrContent, $syncIDs, true); |
  | 1511 | 1511 |  |
  | 1512 |  |  |
  |  | 1512 |  |
  | 1513 | 1513 | //output the html |
  | 1514 |  | $outputData = array(); |
  | 1515 |  |  |
  |  | 1514 | $outputData = array(); |
  |  | 1515 |  |
  | 1516 | 1516 | if(!empty($htmlDebug)) |
  | 1517 | 1517 | $outputData["html\_debug"] = $htmlDebug; |
  | 1518 |  |  |
  |  | 1518 |  |
  | 1519 | 1519 | if($isModeFiltersInit == false){ |
  | 1520 | 1520 | $outputData["html\_items"] = $htmlGridItems; |
  | 1521 |  |  |
  |  | 1521 |  |
  | 1522 | 1522 | $htmlGridItems2 = trim($htmlGridItems2); |
  | 1523 |  |  |
  |  | 1523 |  |
  | 1524 | 1524 | if(!empty($htmlGridItems2)) |
  | 1525 | 1525 | $outputData["html\_items2"] = $htmlGridItems2; |
  | 1526 |  |  |
  | 1527 |  | } |
  | 1528 |  |  |
  |  | 1526 |  |
  |  | 1527 | } |
  |  | 1528 |  |
  | 1529 | 1529 | if(!empty($addWidgetsHTML)) |
  | 1530 | 1530 | $outputData["html\_widgets"] = $addWidgetsHTML; |
  | 1531 |  |  |
  |  | 1531 |  |
  | 1532 | 1532 | if(!empty($syncWidgetsHTML)) |
  | 1533 | 1533 | $outputData["html\_sync\_widgets"] = $syncWidgetsHTML; |
  | 1534 |  |  |
  |  | 1534 |  |
  | 1535 | 1535 | if(!empty($this->contentWidgetsDebug)) |
  | 1536 | 1536 | $outputData["html\_widgets\_debug"] = $this->contentWidgetsDebug; |
  | 1537 |  |  |
  |  | 1537 |  |
  | 1538 | 1538 | //add query data |
  | 1539 |  |  |
  |  | 1539 |  |
  | 1540 | 1540 | $arrQueryData = HelperUC::$operations->getLastQueryData(); |
  | 1541 |  |  |
  |  | 1541 |  |
  | 1542 | 1542 | $strQueryPostIDs = HelperUC::$operations->getLastQueryPostIDs(); |
  | 1543 |  |  |
  |  | 1543 |  |
  | 1544 | 1544 | $outputData["query\_data"] = $arrQueryData; |
  | 1545 | 1545 | $outputData["query\_ids"] = $strQueryPostIDs; |
  | 1546 |  |  |
  | 1547 |  |  |
  |  | 1546 |  |
  |  | 1547 |  |
  | 1548 | 1548 | if(self::$showEchoDebug == true){ |
  | 1549 | 1549 |  |
  | 1550 | 1550 | dmp("The posts: "); |
  | 1551 |  |  |
  |  | 1551 |  |
  | 1552 | 1552 | HelperUC::$operations->putPostsCustomFieldsDebug(GlobalsProviderUC::$lastPostQuery->posts); |
  | 1553 |  |  |
  |  | 1553 |  |
  | 1554 | 1554 | dmp("showing the debug"); |
  | 1555 |  |  |
  |  | 1555 |  |
  | 1556 | 1556 | exit(); |
  | 1557 | 1557 | } |
  | 1558 |  |  |
  |  | 1558 |  |
  | 1559 | 1559 | HelperUC::ajaxResponseData($outputData); |
  | 1560 |  |  |
  |  | 1560 |  |
  | 1561 | 1561 | } |
  | 1562 | 1562 |  |
  | 1563 | 1563 | private function \_\_\_\_\_\_\_DYNAMIC\_POPUP\_\_\_\_\_\_\_\_\_\_(){} |
  | 1564 |  |  |
  |  | 1564 |  |
  | 1565 | 1565 | /\*\* |
  | 1566 | 1566 | \* put dynamic popup cache |
  | 1567 | 1567 | \*/ |
  | 1568 | 1568 | private function putDynamicPopupCache(){ |
  | 1569 |  |  |
  |  | 1569 |  |
  | 1570 | 1570 | $postID = 10767; |
  | 1571 |  |  |
  |  | 1571 |  |
  | 1572 | 1572 | $templateID = 9532; |
  | 1573 |  |  |
  |  | 1573 |  |
  | 1574 | 1574 | $widgetID = "max111"; |
  | 1575 |  |  |
  |  | 1575 |  |
  | 1576 | 1576 | $post = get\_post($postID); |
  | 1577 |  |  |
  |  | 1577 |  |
  | 1578 | 1578 | $template = get\_post($templateID); |
  | 1579 |  |  |
  |  | 1579 |  |
  | 1580 | 1580 | //dmp($template);exit(); |
  | 1581 |  |  |
  |  | 1581 |  |
  | 1582 | 1582 | HelperProviderCoreUC\_EL::putListingItemTemplate\_post($post, $templateID, $widgetID); |
  | 1583 |  |  |
  | 1584 |  |  |
  | 1585 |  |  |
  |  | 1583 |  |
  |  | 1584 |  |
  |  | 1585 |  |
  | 1586 | 1586 | dmp("dynamic popup cache"); |
  | 1587 | 1587 | exit(); |
  | 1588 |  |  |
  | 1589 |  | } |
  | 1590 |  |  |
  |  | 1588 |  |
  |  | 1589 | } |
  |  | 1590 |  |
  | 1591 | 1591 | private function \_\_\_\_\_\_\_AJAX\_SEARCH\_\_\_\_\_\_\_\_\_\_(){} |
  | 1592 |  |  |
  |  | 1592 |  |
  | 1593 | 1593 | /\*\* |
  | 1594 | 1594 | \* before custom posts query |
  | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3094530#L1596) | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3097249#L1596) |  |
  | 1596 | 1596 | \*/ |
  | 1597 | 1597 | public function onBeforeCustomPostsQuery($query){ |
  | 1598 |  |  |
  |  | 1598 |  |
  | 1599 | 1599 | if(GlobalsProviderUC::$isUnderAjaxSearch == false) |
  | 1600 | 1600 | return(false); |
  | 1601 |  |  |
  |  | 1601 |  |
  | 1602 | 1602 | global $wp\_the\_query; |
  | 1603 | 1603 | $wp\_the\_query = $query; |
  | 1604 | 1604 | } |
  | 1605 |  |  |
  | 1606 |  |  |
  |  | 1605 |  |
  |  | 1606 |  |
  | 1607 | 1607 | /\*\* |
  | 1608 | 1608 | \* ajax search |
  | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3094530#L1611) | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3097249#L1611) |  |
  | 1611 | 1611 |  |
  | 1612 | 1612 | self::$isUnderAjaxSearch = true; |
  | 1613 |  |  |
  |  | 1613 |  |
  | 1614 | 1614 | $responseCode = http\_response\_code(); |
  | 1615 |  |  |
  |  | 1615 |  |
  | 1616 | 1616 | if($responseCode != 200) |
  | 1617 | 1617 | http\_response\_code(200); |
  | 1618 |  |  |
  |  | 1618 |  |
  | 1619 | 1619 | define("UE\_AJAX\_SEARCH\_ACTIVE", true); |
  | 1620 |  |  |
  |  | 1620 |  |
  | 1621 | 1621 | $layoutID = UniteFunctionsUC::getPostGetVariable("layoutid","",UniteFunctionsUC::SANITIZE\_KEY); |
  | 1622 | 1622 | $elementID = UniteFunctionsUC::getPostGetVariable("elid","",UniteFunctionsUC::SANITIZE\_KEY); |
  | 1623 |  |  |
  |  | 1623 |  |
  | 1624 | 1624 | $arrContent = HelperProviderCoreUC\_EL::getElementorContentByPostID($layoutID); |
  | 1625 |  |  |
  |  | 1625 |  |
  | 1626 | 1626 | if(empty($arrContent)) |
  | 1627 | 1627 | UniteFunctionsUC::throwError("Elementor content not found"); |
  | 1628 |  |  |
  |  | 1628 |  |
  | 1629 | 1629 | //run the post query |
  | 1630 | 1630 | GlobalsProviderUC::$isUnderAjaxSearch = true; |
  | 1631 |  |  |
  |  | 1631 |  |
  | 1632 | 1632 | //for outside filters - check that under ajax |
  | 1633 |  |  |
  |  | 1633 |  |
  | 1634 | 1634 | $arrHtmlWidget = $this->getContentWidgetHtml($arrContent, $elementID); |
  | 1635 |  |  |
  |  | 1635 |  |
  | 1636 | 1636 | GlobalsProviderUC::$isUnderAjaxSearch = false; |
  | 1637 |  |  |
  |  | 1637 |  |
  | 1638 | 1638 | $htmlGridItems = UniteFunctionsUC::getVal($arrHtmlWidget, "html"); |
  | 1639 | 1639 | $htmlGridItems2 = UniteFunctionsUC::getVal($arrHtmlWidget, "html2"); |
  | 1640 |  |  |
  |  | 1640 |  |
  | 1641 | 1641 | $htmlDebug = UniteFunctionsUC::getVal($arrHtmlWidget, "html\_debug"); |
  | 1642 |  |  |
  |  | 1642 |  |
  | 1643 | 1643 | //output the html |
  | 1644 |  | $outputData = array(); |
  | 1645 |  |  |
  |  | 1644 | $outputData = array(); |
  |  | 1645 |  |
  | 1646 | 1646 | if(!empty($htmlDebug)) |
  | 1647 | 1647 | $outputData["html\_debug"] = $htmlDebug; |
  | 1648 |  |  |
  |  | 1648 |  |
  | 1649 | 1649 | $outputData["html\_items"] = $htmlGridItems; |
  | 1650 |  |  |
  |  | 1650 |  |
  | 1651 | 1651 | $htmlGridItems2 = trim($htmlGridItems2); |
  | 1652 |  |  |
  |  | 1652 |  |
  | 1653 | 1653 | if(!empty($htmlGridItems2)) |
  | 1654 | 1654 | $outputData["html\_items2"] = $htmlGridItems2; |
  | 1655 |  |  |
  | 1656 |  |  |
  |  | 1655 |  |
  |  | 1656 |  |
  | 1657 | 1657 | HelperUC::ajaxResponseData($outputData); |
  | 1658 | 1658 | } |
  | 1659 |  |  |
  |  | 1659 |  |
  | 1660 | 1660 | private function \_\_\_\_\_\_\_WIDGET\_\_\_\_\_\_\_\_\_\_(){} |
  | 1661 |  |  |
  | 1662 |  |  |
  |  | 1661 |  |
  |  | 1662 |  |
  | 1663 | 1663 | /\*\* |
  | 1664 | 1664 | \* include the filters js files |
  | 1665 | 1665 | \*/ |
  | 1666 | 1666 | private function includeJSFiles(){ |
  | 1667 |  |  |
  |  | 1667 |  |
  | 1668 | 1668 | if(self::$isFilesAdded == true) |
  | 1669 | 1669 | return(false); |
  | 1670 |  |  |
  |  | 1670 |  |
  | 1671 | 1671 | UniteProviderFunctionsUC::addAdminJQueryInclude(); |
  | 1672 |  |  |
  |  | 1672 |  |
  | 1673 | 1673 | $urlFiltersJS = GlobalsUC::$url\_assets\_libraries."filters/ue\_filters.js"; |
  | 1674 |  | HelperUC::addScriptAbsoluteUrl\_widget($urlFiltersJS, "ue\_filters"); |
  | 1675 |  |  |
  |  | 1674 | HelperUC::addScriptAbsoluteUrl\_widget($urlFiltersJS, "ue\_filters"); |
  |  | 1675 |  |
  | 1676 | 1676 | self::$isFilesAdded = true; |
  | 1677 | 1677 | } |
  | 1678 |  |  |
  |  | 1678 |  |
  | 1679 | 1679 | /\*\* |
  | 1680 | 1680 | \* put custom scripts |
  | 1681 | 1681 | \*/ |
  | 1682 | 1682 | private function putCustomJsScripts(){ |
  | 1683 |  |  |
  |  | 1683 |  |
  | 1684 | 1684 | if(self::$isScriptAdded == true) |
  | 1685 | 1685 | return(false); |
  | 1686 |  |  |
  |  | 1686 |  |
  | 1687 | 1687 | self::$isScriptAdded = true; |
  | 1688 |  |  |
  |  | 1688 |  |
  | 1689 | 1689 | $arrData = $this->getFiltersJSData(); |
  | 1690 |  |  |
  |  | 1690 |  |
  | 1691 | 1691 | $strData = UniteFunctionsUC::jsonEncodeForClientSide($arrData); |
  | 1692 |  |  |
  |  | 1692 |  |
  | 1693 | 1693 | $script = "/\* Unlimited Elements Filters \*/ \n"; |
  | 1694 | 1694 | $script .= "window.g\_strFiltersData = {$strData};"; |
  | 1695 |  |  |
  |  | 1695 |  |
  | 1696 | 1696 | UniteProviderFunctionsUC::printCustomScript($script); |
  | 1697 | 1697 | } |
  | 1698 |  |  |
  |  | 1698 |  |
  | 1699 | 1699 | /\*\* |
  | 1700 | 1700 | \* put custom style |
  | 1701 | 1701 | \*/ |
  | 1702 | 1702 | private function putCustomStyle(){ |
  | 1703 |  |  |
  |  | 1703 |  |
  | 1704 | 1704 | if(self::$isStyleAdded == true) |
  | 1705 | 1705 | return(false); |
  | 1706 |  |  |
  |  | 1706 |  |
  | 1707 | 1707 | self::$isStyleAdded = true; |
  | 1708 |  |  |
  |  | 1708 |  |
  | 1709 | 1709 | $style = " |
  | 1710 | 1710 | .uc-ajax-loading{ |
  | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3094530#L1712) | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3097249#L1712) |  |
  | 1712 | 1712 | } |
  | 1713 | 1713 | "; |
  | 1714 |  |  |
  |  | 1714 |  |
  | 1715 | 1715 | UniteProviderFunctionsUC::printCustomStyle($style); |
  | 1716 | 1716 | } |
  | 1717 |  |  |
  | 1718 |  |  |
  |  | 1717 |  |
  |  | 1718 |  |
  | 1719 | 1719 | /\*\* |
  | 1720 | 1720 | \* include the client side scripts |
  | 1721 | 1721 | \*/ |
  | 1722 | 1722 | private function includeClientSideScripts(){ |
  | 1723 |  |  |
  |  | 1723 |  |
  | 1724 | 1724 | $isInsideEditor = GlobalsProviderUC::$isInsideEditor; |
  | 1725 |  |  |
  |  | 1725 |  |
  | 1726 | 1726 | if($isInsideEditor == true) |
  | 1727 | 1727 | return(false); |
  | 1728 |  |  |
  |  | 1728 |  |
  | 1729 | 1729 | $this->includeJSFiles(); |
  | 1730 |  |  |
  |  | 1730 |  |
  | 1731 | 1731 | $this->putCustomJsScripts(); |
  | 1732 |  |  |
  |  | 1732 |  |
  | 1733 | 1733 | $this->putCustomStyle(); |
  | 1734 |  |  |
  | 1735 |  | } |
  | 1736 |  |  |
  | 1737 |  |  |
  | 1738 |  |  |
  |  | 1734 |  |
  |  | 1735 | } |
  |  | 1736 |  |
  |  | 1737 |  |
  |  | 1738 |  |
  | 1739 | 1739 | /\*\* |
  | 1740 | 1740 | \* get active archive terms |
  | 1741 | 1741 | \*/ |
  | 1742 | 1742 | private function getActiveArchiveTerms($taxonomy){ |
  | 1743 |  |  |
  |  | 1743 |  |
  | 1744 | 1744 | if(is\_archive() == false) |
  | 1745 | 1745 | return(null); |
  | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3094530#L1749) | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3097249#L1749) |  |
  | 1749 | 1749 | if(empty($currentTerm)) |
  | 1750 | 1750 | return(null); |
  | 1751 |  |  |
  |  | 1751 |  |
  | 1752 | 1752 | if($currentTerm instanceof WP\_Term == false) |
  | 1753 | 1753 | return(null); |
  | 1754 |  |  |
  |  | 1754 |  |
  | 1755 | 1755 | $termID = $currentTerm->term\_id; |
  | 1756 |  |  |
  |  | 1756 |  |
  | 1757 | 1757 | $args = array(); |
  | 1758 | 1758 | $args["taxonomy"] = $taxonomy; |
  | 1759 | 1759 | $args["parent"] = $termID; |
  | 1760 |  |  |
  |  | 1760 |  |
  | 1761 | 1761 | $arrTerms = get\_terms($args); |
  | 1762 |  |  |
  |  | 1762 |  |
  | 1763 | 1763 | return($arrTerms); |
  | 1764 | 1764 | } |
  | 1765 |  |  |
  | 1766 |  |  |
  | 1767 |  |  |
  |  | 1765 |  |
  |  | 1766 |  |
  |  | 1767 |  |
  | 1768 | 1768 | /\*\* |
  | 1769 | 1769 | \* add values to settings from data |
  | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3094530#L1771) | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3097249#L1771) |  |
  | 1771 | 1771 | \*/ |
  | 1772 | 1772 | public function addWidgetFilterableVarsFromData($data, $dataPosts, $postListName, $arrPostIDs = null){ |
  | 1773 |  |  |
  |  | 1773 |  |
  | 1774 | 1774 | //check if ajax related |
  | 1775 | 1775 | $isAjax = UniteFunctionsUC::getVal($dataPosts, $postListName."\_isajax"); |
  | 1776 | 1776 | $isAjax = UniteFunctionsUC::strToBool($isAjax); |
  | 1777 |  |  |
  |  | 1777 |  |
  | 1778 | 1778 | $addClass = ""; |
  | 1779 | 1779 | $strAttributes = ""; |
  | 1780 |  |  |
  |  | 1780 |  |
  | 1781 | 1781 | //avoid duplicates handle |
  | 1782 |  |  |
  |  | 1782 |  |
  | 1783 | 1783 | if(!empty($arrPostIDs)){ |
  | 1784 |  |  |
  |  | 1784 |  |
  | 1785 | 1785 | $addClass = " uc-avoid-duplicates"; |
  | 1786 |  |  |
  |  | 1786 |  |
  | 1787 | 1787 | $strPostIDs = implode(",", $arrPostIDs); |
  | 1788 | 1788 | $strAttributes = " data-postids='$strPostIDs'"; |
  | 1789 |  |  |
  | 1790 |  | } |
  | 1791 |  |  |
  |  | 1789 |  |
  |  | 1790 | } |
  |  | 1791 |  |
  | 1792 | 1792 | if($isAjax == false){ |
  | 1793 |  |  |
  |  | 1793 |  |
  | 1794 | 1794 | $data["uc\_filtering\_attributes"] = $strAttributes; |
  | 1795 | 1795 | $data["uc\_filtering\_addclass"] = $addClass; |
  | 1796 |  |  |
  |  | 1796 |  |
  | 1797 | 1797 | return($data); |
  | 1798 | 1798 | } |
  | 1799 |  |  |
  | 1800 |  |  |
  |  | 1799 |  |
  |  | 1800 |  |
  | 1801 | 1801 | //all ajax related |
  | 1802 |  |  |
  |  | 1802 |  |
  | 1803 | 1803 | $addClass .= " uc-filterable-grid"; |
  | 1804 |  |  |
  |  | 1804 |  |
  | 1805 | 1805 | $filterBehavoiur = UniteFunctionsUC::getVal($dataPosts, $postListName."\_ajax\_seturl"); |
  | 1806 |  |  |
  |  | 1806 |  |
  | 1807 | 1807 | $strAttributes .= " data-ajax='true' "; |
  | 1808 |  |  |
  |  | 1808 |  |
  | 1809 | 1809 | if(!empty($filterBehavoiur)) |
  | 1810 | 1810 | $strAttributes .= " data-filterbehave='$filterBehavoiur' "; |
  | 1811 |  |  |
  |  | 1811 |  |
  | 1812 | 1812 | //add ajax group |
  | 1813 |  |  |
  |  | 1813 |  |
  | 1814 | 1814 | $filterGroup = UniteFunctionsUC::getVal($dataPosts, $postListName."\_filtering\_group"); |
  | 1815 |  |  |
  |  | 1815 |  |
  | 1816 | 1816 | if(!empty($filterGroup)){ |
  | 1817 | 1817 | $filterGroup = esc\_attr($filterGroup); |
  | 1818 | 1818 | $strAttributes .= " data-filtergroup='$filterGroup' "; |
  | 1819 | 1819 | } |
  | 1820 |  |  |
  | 1821 |  |  |
  |  | 1820 |  |
  |  | 1821 |  |
  | 1822 | 1822 | //add last query |
  | 1823 | 1823 | $arrQueryData = HelperUC::$operations->getLastQueryData(); |
  | 1824 | 1824 |  |
  | 1825 | 1825 | $jsonQueryData = UniteFunctionsUC::jsonEncodeForHtmlData($arrQueryData); |
  | 1826 |  |  |
  |  | 1826 |  |
  | 1827 | 1827 | $strAttributes .= " querydata='$jsonQueryData'"; |
  | 1828 |  |  |
  |  | 1828 |  |
  | 1829 | 1829 | $this->includeClientSideScripts(); |
  | 1830 |  |  |
  |  | 1830 |  |
  | 1831 | 1831 | $data["uc\_filtering\_attributes"] = $strAttributes; |
  | 1832 | 1832 | $data["uc\_filtering\_addclass"] = $addClass; |
  | 1833 |  |  |
  |  | 1833 |  |
  | 1834 | 1834 | return($data); |
  | 1835 | 1835 | } |
  | 1836 |  |  |
  |  | 1836 |  |
  | 1837 | 1837 | /\*\* |
  | 1838 | 1838 | \* add widget variables |
  | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3094530#L1840) | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3097249#L1840) |  |
  | 1840 | 1840 | \*/ |
  | 1841 | 1841 | public function addWidgetFilterableVariables($data, $addon, $arrPostIDs = array()){ |
  | 1842 |  |  |
  |  | 1842 |  |
  | 1843 | 1843 | $param = $addon->getParamByType(UniteCreatorDialogParam::PARAM\_POSTS\_LIST); |
  | 1844 |  |  |
  |  | 1844 |  |
  | 1845 | 1845 | if(empty($param)) |
  | 1846 | 1846 | return($data); |
  | 1847 |  |  |
  |  | 1847 |  |
  | 1848 | 1848 | $postListName = UniteFunctionsUC::getVal($param, "name"); |
  | 1849 |  |  |
  |  | 1849 |  |
  | 1850 | 1850 | $dataPosts = UniteFunctionsUC::getVal($data, $postListName); |
  | 1851 |  |  |
  |  | 1851 |  |
  | 1852 | 1852 | $data = $this->addWidgetFilterableVarsFromData($data, $dataPosts, $postListName, $arrPostIDs); |
  | 1853 |  |  |
  |  | 1853 |  |
  | 1854 | 1854 | return($data); |
  | 1855 | 1855 | } |
  | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3094530#L1857) | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3097249#L1857) |  |
  | 1857 | 1857 | /\*\* |
  | 1858 | 1858 | \* default sign is "~" |
  | 1859 |  | \* |
  |  | 1859 | \* |
  | 1860 | 1860 | \*/ |
  | 1861 | 1861 | private function getUrlPartsKeys(){ |
  | 1862 |  |  |
  |  | 1862 |  |
  | 1863 | 1863 | $arrParts = array(); |
  | 1864 | 1864 | $arrParts["tax\_sap"] = apply\_filters("ue\_filters\_url\_key\_\_taxonomy\_sap","~"); |
  | 1865 |  |  |
  |  | 1865 |  |
  | 1866 | 1866 | return($arrParts); |
  | 1867 | 1867 | } |
  | 1868 |  |  |
  |  | 1868 |  |
  | 1869 | 1869 | /\*\* |
  | 1870 | 1870 | \* get filters attributes |
  | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3094530#L1872) | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3097249#L1872) |  |
  | 1872 | 1872 | \*/ |
  | 1873 | 1873 | private function getFiltersJSData(){ |
  | 1874 |  |  |
  |  | 1874 |  |
  | 1875 | 1875 | $urlBase = UniteFunctionsUC::getBaseUrl(GlobalsUC::$current\_page\_url, true);        //strip pagination |
  | 1876 |  |  |
  |  | 1876 |  |
  | 1877 | 1877 | //include some common url filters |
  | 1878 | 1878 | $orderby = UniteFunctionsUC::getGetVar("orderby","",UniteFunctionsUC::SANITIZE\_TEXT\_FIELD); |
  | 1879 |  |  |
  |  | 1879 |  |
  | 1880 | 1880 | if(!empty($orderby)){ |
  | 1881 | 1881 | $orderby = urlencode($orderby); |
  | 1882 | 1882 | $urlBase = UniteFunctionsUC::addUrlParams($urlBase, "orderby=$orderby"); |
  | 1883 | 1883 | } |
  | 1884 |  |  |
  |  | 1884 |  |
  | 1885 | 1885 | //include the search if exists |
  | 1886 |  |  |
  |  | 1886 |  |
  | 1887 | 1887 | $search = UniteFunctionsUC::getGetVar("s","",UniteFunctionsUC::SANITIZE\_TEXT\_FIELD); |
  | 1888 |  |  |
  |  | 1888 |  |
  | 1889 | 1889 | if(empty($search)){ |
  | 1890 | 1890 | $search = null; |
  | 1891 |  |  |
  |  | 1891 |  |
  | 1892 | 1892 | if(isset($\_GET["s"]) && $\_GET["s"] == "") |
  | 1893 | 1893 | $search = ""; |
  | 1894 | 1894 | } |
  | 1895 |  |  |
  | 1896 |  |  |
  |  | 1895 |  |
  | 1897 | 1896 | if($search !== null){ |
  | 1898 | 1897 | $search = urlencode($search); |
  | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3094530#L1911) | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3097249#L1910) |  |
  | 1911 | 1910 |  |
  | 1912 | 1911 | //debug client url |
  | 1913 |  |  |
  |  | 1912 |  |
  | 1914 | 1913 | $isDebug = UniteFunctionsUC::getGetVar("ucfiltersdebug","",UniteFunctionsUC::SANITIZE\_TEXT\_FIELD); |
  | 1915 | 1914 | $isDebug = UniteFunctionsUC::strToBool($isDebug); |
  | 1916 |  |  |
  |  | 1915 |  |
  | 1917 | 1916 | //get url parts |
  | 1918 | 1917 | $arrUrlKeys = $this->getUrlPartsKeys(); |
  | 1919 |  |  |
  |  | 1918 |  |
  | 1920 | 1919 | //get current filters |
  | 1921 |  |  |
  |  | 1920 |  |
  | 1922 | 1921 | $arrData = array(); |
  | 1923 | 1922 | $arrData["platform"] = GlobalsProviderUC::$renderPlatform; |
  | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3094530#L1926) | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3097249#L1925) |  |
  | 1926 | 1925 | $arrData["urlkeys"] = $arrUrlKeys; |
  | 1927 | 1926 | $arrData["postid"] = get\_the\_id(); |
  | 1928 |  |  |
  | 1929 |  |  |
  |  | 1927 |  |
  |  | 1928 |  |
  | 1930 | 1929 | if($isDebug == true) |
  | 1931 | 1930 | $arrData["debug"] = true; |
  | 1932 |  |  |
  |  | 1931 |  |
  | 1933 | 1932 | return($arrData); |
  | 1934 | 1933 | } |
  | 1935 |  |  |
  | 1936 |  |  |
  |  | 1934 |  |
  |  | 1935 |  |
  | 1937 | 1936 | private function \_\_\_\_\_MODIFY\_PARAMS\_PROCESS\_TERMS\_\_\_\_\_\_\_(){} |
  | 1938 |  |  |
  | 1939 |  |  |
  |  | 1937 |  |
  |  | 1938 |  |
  | 1940 | 1939 | /\*\* |
  | 1941 | 1940 | \* check if term selected by request |
  | 1942 | 1941 | \*/ |
  | 1943 | 1942 | private function isTermSelectedByRequest($term, $selectedTerms){ |
  | 1944 |  |  |
  |  | 1943 |  |
  | 1945 | 1944 | $taxonomy = UniteFunctionsUC::getVal($term, "taxonomy"); |
  | 1946 |  |  |
  |  | 1945 |  |
  | 1947 | 1946 | if(empty($taxonomy)) |
  | 1948 | 1947 | return(false); |
  | 1949 |  |  |
  |  | 1948 |  |
  | 1950 | 1949 | $arrSlugs = UniteFunctionsUC::getVal($selectedTerms, $taxonomy); |
  | 1951 |  |  |
  |  | 1950 |  |
  | 1952 | 1951 | if(empty($arrSlugs)) |
  | 1953 | 1952 | return(false); |
  | 1954 | 1953 |  |
  | 1955 | 1954 | $slug = UniteFunctionsUC::getVal($term, "slug"); |
  | 1956 |  |  |
  |  | 1955 |  |
  | 1957 | 1956 | $found = in\_array($slug, $arrSlugs); |
  | 1958 |  |  |
  |  | 1957 |  |
  | 1959 | 1958 | return($found); |
  | 1960 | 1959 | } |
  | 1961 |  |  |
  | 1962 |  |  |
  |  | 1960 |  |
  |  | 1961 |  |
  | 1963 | 1962 | /\*\* |
  | 1964 | 1963 | \* modify selected by request |
  | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3094530#L1967) | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3097249#L1966) |  |
  | 1967 | 1966 |  |
  | 1968 | 1967 | $this->hasSelectedByRequest = false; |
  | 1969 |  |  |
  |  | 1968 |  |
  | 1970 | 1969 | $selectedTerms = null; |
  | 1971 | 1970 | $selectedTermIDs = null; |
  | 1972 |  |  |
  |  | 1971 |  |
  | 1973 | 1972 | //if mode init - get selected id's from request |
  | 1974 | 1973 | if(self::$isModeInit == true){ |
  | 1975 |  |  |
  |  | 1974 |  |
  | 1976 | 1975 | $strSelectedTermIDs = UniteFunctionsUC::getPostGetVariable("ucinitselectedterms","",UniteFunctionsUC::SANITIZE\_TEXT\_FIELD); |
  | 1977 |  |  |
  |  | 1976 |  |
  | 1978 | 1977 | if(empty($strSelectedTermIDs)) |
  | 1979 | 1978 | return($arrTerms); |
  | 1980 |  |  |
  |  | 1979 |  |
  | 1981 | 1980 | UniteFunctionsUC::validateIDsList($strSelectedTermIDs,"selected terms"); |
  | 1982 |  |  |
  |  | 1981 |  |
  | 1983 | 1982 | $selectedTermIDs = explode(",", $strSelectedTermIDs); |
  | 1984 |  |  |
  |  | 1983 |  |
  | 1985 | 1984 | if(empty($selectedTermIDs)) |
  | 1986 | 1985 | return($arrTerms); |
  | 1987 |  |  |
  |  | 1986 |  |
  | 1988 | 1987 | }else{ |
  | 1989 |  |  |
  |  | 1988 |  |
  | 1990 | 1989 | $arrRequest = $this->getRequestFilters(); |
  | 1991 |  |  |
  |  | 1990 |  |
  | 1992 | 1991 | if(empty($arrRequest)) |
  | 1993 | 1992 | return($arrTerms); |
  | 1994 |  |  |
  |  | 1993 |  |
  | 1995 | 1994 | $selectedTerms = UniteFunctionsUC::getVal($arrRequest, "terms"); |
  | 1996 |  |  |
  |  | 1995 |  |
  | 1997 | 1996 | if(empty($selectedTerms)) |
  | 1998 | 1997 | return($arrTerms); |
  | 1999 |  |  |
  | 2000 |  | } |
  | 2001 |  |  |
  | 2002 |  |  |
  |  | 1998 |  |
  |  | 1999 | } |
  |  | 2000 |  |
  |  | 2001 |  |
  | 2003 | 2002 | $arrSelected = array(); |
  | 2004 |  |  |
  |  | 2003 |  |
  | 2005 | 2004 | foreach($arrTerms as $index => $term){ |
  | 2006 |  |  |
  |  | 2005 |  |
  | 2007 | 2006 | if(!empty($selectedTerms)) |
  | 2008 | 2007 | $isSelected = $this->isTermSelectedByRequest($term, $selectedTerms); |
  | 2009 | 2008 | else{ |
  | 2010 |  |  |
  |  | 2009 |  |
  | 2011 | 2010 | $termID = UniteFunctionsUC::getVal($term, "id"); |
  | 2012 | 2011 | if(empty($termID)) |
  | 2013 | 2012 | continue; |
  | 2014 |  |  |
  |  | 2013 |  |
  | 2015 | 2014 | $isSelected = in\_array($termID, $selectedTermIDs); |
  | 2016 | 2015 | } |
  | 2017 |  |  |
  |  | 2016 |  |
  | 2018 | 2017 | if($isSelected == false) |
  | 2019 | 2018 | continue; |
  | 2020 | 2019 |  |
  | 2021 |  |  |
  |  | 2020 |  |
  | 2022 | 2021 | $arrSelected["term\_".$index] = true; |
  | 2023 | 2022 | } |
  | 2024 |  |  |
  |  | 2023 |  |
  | 2025 | 2024 | if(empty($arrSelected)) |
  | 2026 | 2025 | return($arrTerms); |
  | 2027 |  |  |
  |  | 2026 |  |
  | 2028 | 2027 | $this->hasSelectedByRequest = true; |
  | 2029 |  |  |
  |  | 2028 |  |
  | 2030 | 2029 | //modify the selected |
  | 2031 |  |  |
  |  | 2030 |  |
  | 2032 | 2031 | foreach($arrTerms as $index => $term){ |
  | 2033 |  |  |
  |  | 2032 |  |
  | 2034 | 2033 | $isSelected = UniteFunctionsUC::getVal($arrSelected, "term\_".$index); |
  | 2035 |  |  |
  |  | 2034 |  |
  | 2036 | 2035 | if($isSelected == true){ |
  | 2037 | 2036 | $term["iscurrent"] = true; |
  | 2038 | 2037 | $term["isselected"] = true; |
  | 2039 |  |  |
  |  | 2038 |  |
  | 2040 | 2039 | }else{ |
  | 2041 |  |  |
  |  | 2040 |  |
  | 2042 | 2041 | $term["iscurrent"] = false; |
  | 2043 | 2042 | $term["isselected"] = false; |
  | 2044 | 2043 | $term["class\_selected"] = ""; |
  | 2045 | 2044 | } |
  | 2046 |  |  |
  |  | 2045 |  |
  | 2047 | 2046 | $arrTerms[$index] = $term; |
  | 2048 | 2047 | } |
  | 2049 |  |  |
  |  | 2048 |  |
  | 2050 | 2049 | return($arrTerms); |
  | 2051 | 2050 | } |
  | 2052 |  |  |
  | 2053 |  |  |
  |  | 2051 |  |
  |  | 2052 |  |
  | 2054 | 2053 | /\*\* |
  | 2055 | 2054 | \* modify filters - add first item |
  | 2056 | 2055 | \*/ |
  | 2057 | 2056 | private function modifyOutputTerms\_addFirstItem($arrTerms, $data, $filterType){ |
  | 2058 |  |  |
  |  | 2057 |  |
  | 2059 | 2058 | //don't add first item if no terms, if no terms, no "all" as well |
  | 2060 |  |  |
  |  | 2059 |  |
  | 2061 | 2060 | if(empty($arrTerms)) |
  | 2062 | 2061 | return(array()); |
  | 2063 |  |  |
  |  | 2062 |  |
  | 2064 | 2063 | $addFirst = UniteFunctionsUC::getVal($data, "add\_first"); |
  | 2065 | 2064 | $addFirst = UniteFunctionsUC::strToBool($addFirst); |
  | 2066 |  |  |
  |  | 2065 |  |
  | 2067 | 2066 | if($addFirst == false) |
  | 2068 | 2067 | return($arrTerms); |
  | 2069 |  |  |
  | 2070 |  |  |
  |  | 2068 |  |
  |  | 2069 |  |
  | 2071 | 2070 | $text = UniteFunctionsUC::getVal($data, "first\_item\_text", \_\_("All","unlimited-elements-for-elementor")); |
  | 2072 |  |  |
  |  | 2071 |  |
  | 2073 | 2072 | $firstTerm = array(); |
  | 2074 | 2073 | $firstTerm["index"] = 0; |
  | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3094530#L2078) | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3097249#L2077) |  |
  | 2078 | 2077 | $firstTerm["parent\_id"] = ""; |
  | 2079 | 2078 | $firstTerm["taxonomy"] = ""; |
  | 2080 |  |  |
  |  | 2079 |  |
  | 2081 | 2080 | $firstTerm["addclass"] = " uc-item-all"; |
  | 2082 |  |  |
  |  | 2081 |  |
  | 2083 | 2082 | if(!empty(self::$numTotalPosts)) |
  | 2084 | 2083 | $firstTerm["num\_posts"] = self::$numTotalPosts; |
  | 2085 |  |  |
  |  | 2084 |  |
  | 2086 | 2085 | array\_unshift($arrTerms, $firstTerm); |
  | 2087 |  |  |
  |  | 2086 |  |
  | 2088 | 2087 | return($arrTerms); |
  | 2089 | 2088 | } |
  | 2090 |  |  |
  | 2091 |  |  |
  |  | 2089 |  |
  |  | 2090 |  |
  | 2092 | 2091 | /\*\* |
  | 2093 | 2092 | \* modify the selected - first selected from options |
  | 2094 | 2093 | \*/ |
  | 2095 | 2094 | private function modifyOutputTerms\_modifySelected($arrTerms, $data, $filterType){ |
  | 2096 |  |  |
  |  | 2095 |  |
  | 2097 | 2096 | if(empty($arrTerms)) |
  | 2098 | 2097 | return($arrTerms); |
  | 2099 |  |  |
  |  | 2098 |  |
  | 2100 | 2099 | $isSelectFirst = UniteFunctionsUC::getVal($data, "select\_first"); |
  | 2101 | 2100 | $isSelectFirst = UniteFunctionsUC::strToBool($isSelectFirst); |
  | 2102 |  |  |
  |  | 2101 |  |
  | 2103 | 2102 | if($filterType == self::TYPE\_SELECT) |
  | 2104 | 2103 | $isSelectFirst = true; |
  | 2105 |  |  |
  |  | 2104 |  |
  | 2106 | 2105 | if($filterType == self::TYPE\_TABS){ |
  | 2107 |  |  |
  |  | 2106 |  |
  | 2108 | 2107 | $role = UniteFunctionsUC::getVal($data, "filter\_role"); |
  | 2109 |  |  |
  |  | 2108 |  |
  | 2110 | 2109 | if(strpos($role,"child") !== false) |
  | 2111 | 2110 | $isSelectFirst = false; |
  | 2112 | 2111 | } |
  | 2113 |  |  |
  |  | 2112 |  |
  | 2114 | 2113 | if($isSelectFirst == false) |
  | 2115 |  | return($arrTerms); |
  | 2116 |  |  |
  |  | 2114 | return($arrTerms); |
  |  | 2115 |  |
  | 2117 | 2116 | $numSelectedTab = UniteFunctionsUC::getVal($data, "selected\_tab\_number"); |
  | 2118 | 2117 | if(empty($numSelectedTab)) |
  | 2119 | 2118 | $numSelectedTab = 1; |
  | 2120 |  |  |
  |  | 2119 |  |
  | 2121 | 2120 | //correct selected tab |
  | 2122 |  |  |
  |  | 2121 |  |
  | 2123 | 2122 | $numTerms = count($arrTerms); |
  | 2124 |  |  |
  |  | 2123 |  |
  | 2125 | 2124 | if($isSelectFirst == true && $numSelectedTab > $numTerms) |
  | 2126 | 2125 | $numSelectedTab = 1; |
  | 2127 |  |  |
  |  | 2126 |  |
  | 2128 | 2127 | $firstNotHiddenIndex = null; |
  | 2129 |  |  |
  |  | 2128 |  |
  | 2130 | 2129 | $hasSelectedTerm = false; |
  | 2131 |  |  |
  |  | 2130 |  |
  | 2132 | 2131 | foreach($arrTerms as $index => $term){ |
  | 2133 |  |  |
  |  | 2132 |  |
  | 2134 | 2133 | //set the index |
  | 2135 | 2134 | $numTab = ($index + 1); |
  | 2136 |  |  |
  |  | 2135 |  |
  | 2137 | 2136 | $term["index"] = $index; |
  | 2138 |  |  |
  |  | 2137 |  |
  | 2139 | 2138 | //check if hidden |
  | 2140 |  |  |
  |  | 2139 |  |
  | 2141 | 2140 | $isHidden = UniteFunctionsUC::getVal($term, "hidden"); |
  | 2142 | 2141 | $isHidden = UniteFunctionsUC::strToBool($isHidden); |
  | 2143 |  |  |
  |  | 2142 |  |
  | 2144 | 2143 | if($isHidden == true) |
  | 2145 | 2144 | continue; |
  | 2146 |  |  |
  |  | 2145 |  |
  | 2147 | 2146 | if($firstNotHiddenIndex === null) |
  | 2148 | 2147 | $firstNotHiddenIndex = $index; |
  | 2149 |  |  |
  |  | 2148 |  |
  | 2150 | 2149 | if($numTab == $numSelectedTab){ |
  | 2151 | 2150 | $term["isselected"] = true; |
  | 2152 | 2151 | $hasSelected = true; |
  | 2153 | 2152 | } |
  | 2154 |  |  |
  |  | 2153 |  |
  | 2155 | 2154 | $arrTerms[$index] = $term; |
  | 2156 | 2155 | } |
  | 2157 |  |  |
  |  | 2156 |  |
  | 2158 | 2157 | if($hasSelected == true) |
  | 2159 | 2158 | return($arrTerms); |
  | 2160 |  |  |
  |  | 2159 |  |
  | 2161 | 2160 | if($firstNotHiddenIndex === null) |
  | 2162 | 2161 | return($arrTerms); |
  | 2163 |  |  |
  |  | 2162 |  |
  | 2164 | 2163 | if($filterType != self::TYPE\_SELECT) |
  | 2165 | 2164 | return($arrTerms); |
  | 2166 |  |  |
  |  | 2165 |  |
  | 2167 | 2166 | //make sure the first item selected in select filter |
  | 2168 | 2167 | if($isSelectFirst == true) |
  | 2169 | 2168 | $arrTerms[$firstNotHiddenIndex]["isselected"] = true; |
  | 2170 |  |  |
  | 2171 |  |  |
  |  | 2169 |  |
  |  | 2170 |  |
  | 2172 | 2171 | return($arrTerms); |
  | 2173 | 2172 | } |
  | 2174 |  |  |
  | 2175 |  |  |
  | 2176 |  | /\*\* |
  | 2177 |  | \* modify the terms for init after |
  |  | 2173 |  |
  |  | 2174 |  |
  |  | 2175 | /\*\* |
  |  | 2176 | \* modify the terms for init after |
  | 2178 | 2177 | \*/ |
  | 2179 | 2178 | private function modifyOutputTerms\_setNumPosts($arrTerms){ |
  | 2180 |  |  |
  |  | 2179 |  |
  | 2181 | 2180 | if(GlobalsProviderUC::$arrTestTermIDs === null) |
  | 2182 | 2181 | return($arrTerms); |
  | 2183 |  |  |
  |  | 2182 |  |
  | 2184 | 2183 | $arrParentNumPosts = array(); |
  | 2185 |  |  |
  |  | 2184 |  |
  | 2186 | 2185 | $arrPostNums = GlobalsProviderUC::$arrTestTermIDs; |
  | 2187 |  |  |
  |  | 2186 |  |
  | 2188 | 2187 | foreach($arrTerms as $key => $term){ |
  | 2189 |  |  |
  |  | 2188 |  |
  | 2190 | 2189 | $termID = UniteFunctionsUC::getVal($term, "id"); |
  | 2191 |  |  |
  |  | 2190 |  |
  | 2192 | 2191 | $termFound = array\_key\_exists($termID, $arrPostNums); |
  | 2193 |  |  |
  |  | 2192 |  |
  | 2194 | 2193 | $numPosts = 0; |
  | 2195 |  |  |
  |  | 2194 |  |
  | 2196 | 2195 | if($termFound){ |
  | 2197 | 2196 | $numPosts = $arrPostNums[$termID]; |
  | 2198 | 2197 | } |
  | 2199 |  |  |
  |  | 2198 |  |
  | 2200 | 2199 | //add parent id if exists |
  | 2201 | 2200 | $parentID = UniteFunctionsUC::getVal($term, "parent\_id"); |
  | 2202 |  |  |
  |  | 2201 |  |
  | 2203 | 2202 | //set the number of posts |
  | 2204 | 2203 | $term["num\_posts"] = $numPosts; |
  | 2205 |  |  |
  |  | 2204 |  |
  | 2206 | 2205 | if(!empty($term["num\_products"])) |
  | 2207 | 2206 | $term["num\_products"] = $numPosts; |
  | 2208 |  |  |
  |  | 2207 |  |
  | 2209 | 2208 | $isHidden = !$termFound; |
  | 2210 |  |  |
  |  | 2209 |  |
  | 2211 | 2210 | if($numPosts == 0) |
  | 2212 | 2211 | $isHidden = true; |
  | 2213 |  |  |
  |  | 2212 |  |
  | 2214 | 2213 | $htmlAttributes = ""; |
  | 2215 | 2214 | $htmlAttributesNew = ""; |
  | 2216 |  |  |
  |  | 2215 |  |
  | 2217 | 2216 | if($isHidden == true){ |
  | 2218 | 2217 | $htmlAttributes = "hidden='hidden' style='display:none'"; |
  | 2219 | 2218 | $htmlAttributesNew = "hidden='hidden' ";    //no style |
  | 2220 |  |  |
  |  | 2219 |  |
  | 2221 | 2220 | $addClass = UniteFunctionsUC::getVal($term, "addclass"); |
  | 2222 | 2221 | $addClass .= " uc-item-hidden"; |
  | 2223 |  |  |
  |  | 2222 |  |
  | 2224 | 2223 | $term["addclass"] = $addClass; |
  | 2225 | 2224 | } |
  | 2226 |  |  |
  |  | 2225 |  |
  | 2227 | 2226 | $term["hidden"] = $isHidden; |
  | 2228 | 2227 | $term["html\_attributes"] = $htmlAttributes; |
  | 2229 | 2228 | $term["html\_attributes2"] = $htmlAttributesNew; |
  | 2230 |  |  |
  | 2231 |  | $arrTerms[$key] = $term; |
  | 2232 |  | } |
  | 2233 |  |  |
  | 2234 |  |  |
  |  | 2229 |  |
  |  | 2230 | $arrTerms[$key] = $term; |
  |  | 2231 | } |
  |  | 2232 |  |
  |  | 2233 |  |
  | 2235 | 2234 | return($arrTerms); |
  | 2236 | 2235 | } |
  | 2237 |  |  |
  | 2238 |  |  |
  |  | 2236 |  |
  |  | 2237 |  |
  | 2239 | 2238 | /\*\* |
  | 2240 | 2239 | \* modify limit loaded items |
  | 2241 | 2240 | \*/ |
  | 2242 | 2241 | private function modifyOutputTerms\_tabs\_modifyLimitGrayed($arrTerms, $limitGrayedItems){ |
  | 2243 |  |  |
  |  | 2242 |  |
  | 2244 | 2243 | if(empty($limitGrayedItems)) |
  | 2245 | 2244 | return($arrTerms); |
  | 2246 |  |  |
  |  | 2245 |  |
  | 2247 | 2246 | $numTerms = count($arrTerms); |
  | 2248 |  |  |
  |  | 2247 |  |
  | 2249 | 2248 | if($numTerms < $limitGrayedItems) |
  | 2250 | 2249 | return($arrTerms); |
  | 2251 |  |  |
  |  | 2250 |  |
  | 2252 | 2251 | foreach($arrTerms as $index => $term){ |
  | 2253 |  |  |
  |  | 2252 |  |
  | 2254 | 2253 | if($index < $limitGrayedItems) |
  | 2255 | 2254 | continue; |
  | 2256 |  |  |
  |  | 2255 |  |
  | 2257 | 2256 | $addClass = UniteFunctionsUC::getVal($term, "addclass"); |
  | 2258 | 2257 | $addClass .= " uc-hide-loading-item"; |
  | 2259 |  |  |
  |  | 2258 |  |
  | 2260 | 2259 | $term["addclass"] = $addClass; |
  | 2261 |  |  |
  |  | 2260 |  |
  | 2262 | 2261 | $arrTerms[$index] = $term; |
  | 2263 | 2262 | } |
  | 2264 |  |  |
  | 2265 |  |  |
  | 2266 |  | return($arrTerms); |
  | 2267 |  | } |
  | 2268 |  |  |
  |  | 2263 |  |
  |  | 2264 |  |
  |  | 2265 | return($arrTerms); |
  |  | 2266 | } |
  |  | 2267 |  |
  | 2269 | 2268 | /\*\* |
  | 2270 | 2269 | \* set selected class by options |
  | 2271 | 2270 | \*/ |
  | 2272 | 2271 | private function modifyOutputTerms\_setSelectedClass($arrTerms, $filterType){ |
  | 2273 |  |  |
  |  | 2272 |  |
  | 2274 | 2273 | if(empty($arrTerms)) |
  | 2275 | 2274 | return($arrTerms); |
  | 2276 |  |  |
  |  | 2275 |  |
  | 2277 | 2276 | foreach($arrTerms as $index => $term){ |
  | 2278 |  |  |
  |  | 2277 |  |
  | 2279 | 2278 | $isSelected = UniteFunctionsUC::getVal($term, "isselected"); |
  | 2280 | 2279 | $isSelected = UniteFunctionsUC::strToBool($isSelected); |
  | 2281 |  |  |
  |  | 2280 |  |
  | 2282 | 2281 | if($isSelected == false) |
  | 2283 | 2282 | continue; |
  | 2284 |  |  |
  |  | 2283 |  |
  | 2285 | 2284 | //hidden can't be selected |
  | 2286 |  |  |
  |  | 2285 |  |
  | 2287 | 2286 | $isHidden = UniteFunctionsUC::getVal($term, "hidden"); |
  | 2288 | 2287 | $isHidden = UniteFunctionsUC::strToBool($isHidden); |
  | 2289 |  |  |
  |  | 2288 |  |
  | 2290 | 2289 | if($isHidden == true) |
  | 2291 | 2290 | continue; |
  | 2292 |  |  |
  |  | 2291 |  |
  | 2293 | 2292 | $class = UniteFunctionsUC::getVal($term, "addclass",""); |
  | 2294 | 2293 | $class .= " uc-selected"; |
  | 2295 |  |  |
  |  | 2294 |  |
  | 2296 | 2295 | $term["addclass"] = $class; |
  | 2297 |  |  |
  |  | 2296 |  |
  | 2298 | 2297 | //set select attribute |
  | 2299 | 2298 | switch($filterType){ |
  | 2300 | 2299 | case self::TYPE\_SELECT: |
  | 2301 |  |  |
  |  | 2300 |  |
  | 2302 | 2301 | $htmlAttributes = UniteFunctionsUC::getVal($term, "html\_attributes"); |
  | 2303 |  |  |
  |  | 2302 |  |
  | 2304 | 2303 | if(empty($htmlAttributes)) |
  | 2305 | 2304 | $htmlAttributes = ""; |
  | 2306 |  |  |
  |  | 2305 |  |
  | 2307 | 2306 | $htmlAttributes .= " selected"; |
  | 2308 |  |  |
  |  | 2307 |  |
  | 2309 | 2308 | $term["html\_attributes"] = $htmlAttributes; |
  | 2310 |  |  |
  |  | 2309 |  |
  | 2311 | 2310 | break; |
  | 2312 | 2311 | case self::TYPE\_CHECKBOX: |
  | 2313 |  |  |
  |  | 2312 |  |
  | 2314 | 2313 | $term["html\_attributes\_input"] = " checked"; |
  | 2315 |  |  |
  |  | 2314 |  |
  | 2316 | 2315 | break; |
  | 2317 | 2316 | } |
  | 2318 |  |  |
  |  | 2317 |  |
  | 2319 | 2318 | //set hasSelected - true, only if there are some selected slug |
  | 2320 |  |  |
  |  | 2319 |  |
  | 2321 | 2320 | $selectedSlug = UniteFunctionsUC::getVal($term, "slug"); |
  | 2322 |  |  |
  |  | 2321 |  |
  | 2323 | 2322 | if(!empty($selectedSlug)) |
  | 2324 | 2323 | $this->hasSelectedTerm = true; |
  | 2325 |  |  |
  |  | 2324 |  |
  | 2326 | 2325 | $arrTerms[$index] = $term; |
  | 2327 |  |  |
  | 2328 |  | } |
  | 2329 |  |  |
  | 2330 |  |  |
  |  | 2326 |  |
  |  | 2327 | } |
  |  | 2328 |  |
  |  | 2329 |  |
  | 2331 | 2330 | return($arrTerms); |
  | 2332 | 2331 | } |
  | 2333 |  |  |
  | 2334 |  |  |
  |  | 2332 |  |
  |  | 2333 |  |
  | 2335 | 2334 | /\*\* |
  | 2336 | 2335 | \* check if filter should be hidden, if selected items avaliable |
  | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3094530#L2338) | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3097249#L2337) |  |
  | 2338 | 2337 | \*/ |
  | 2339 | 2338 | private function modifyOutputTerms\_isFilterHidden($data, $arrTerms, $isUnderAjax){ |
  | 2340 |  |  |
  |  | 2339 |  |
  | 2341 | 2340 | if($isUnderAjax == false) |
  | 2342 | 2341 | return(false); |
  | 2343 |  |  |
  |  | 2342 |  |
  | 2344 | 2343 | $role = UniteFunctionsUC::getVal($data, "filter\_role"); |
  | 2345 |  |  |
  |  | 2344 |  |
  | 2346 | 2345 | if($role != "child") |
  | 2347 | 2346 | return(false); |
  | 2348 |  |  |
  |  | 2347 |  |
  | 2349 | 2348 | if(empty($arrTerms)) |
  | 2350 | 2349 | return(true); |
  | 2351 |  |  |
  |  | 2350 |  |
  | 2352 | 2351 | //get number of not hidden items |
  | 2353 |  |  |
  |  | 2352 |  |
  | 2354 | 2353 | $numItems = 0; |
  | 2355 |  |  |
  |  | 2354 |  |
  | 2356 | 2355 | foreach($arrTerms as $term){ |
  | 2357 |  |  |
  |  | 2356 |  |
  | 2358 | 2357 | $isHidden = UniteFunctionsUC::getVal($term, "hidden"); |
  | 2359 | 2358 | $isHidden = UniteFunctionsUC::strToBool($isHidden); |
  | 2360 |  |  |
  |  | 2359 |  |
  | 2361 | 2360 | if($isHidden == true) |
  | 2362 | 2361 | continue; |
  | 2363 |  |  |
  |  | 2362 |  |
  | 2364 | 2363 | $numItems++; |
  | 2365 | 2364 | } |
  | 2366 |  |  |
  |  | 2365 |  |
  | 2367 | 2366 | if($numItems > 1) |
  | 2368 | 2367 | return(false); |
  | 2369 |  |  |
  |  | 2368 |  |
  | 2370 | 2369 | $firstItem = $arrTerms[0]; |
  | 2371 |  |  |
  |  | 2370 |  |
  | 2372 | 2371 | $slug = UniteFunctionsUC::getVal($firstItem, "slug"); |
  | 2373 |  |  |
  |  | 2372 |  |
  | 2374 | 2373 | $isAllItem = empty($slug); |
  | 2375 |  |  |
  |  | 2374 |  |
  | 2376 | 2375 | //if there is only "all" item, it should be hidden as well |
  | 2377 |  |  |
  |  | 2376 |  |
  | 2378 | 2377 | if($isAllItem == true) |
  | 2379 |  | return(true); |
  | 2380 |  |  |
  | 2381 |  | return(false); |
  | 2382 |  | } |
  | 2383 |  |  |
  |  | 2378 | return(true); |
  |  | 2379 |  |
  |  | 2380 | return(false); |
  |  | 2381 | } |
  |  | 2382 |  |
  | 2384 | 2383 | /\*\* |
  | 2385 | 2384 | \* get data attributes |
  | 2386 | 2385 | \*/ |
  | 2387 | 2386 | private function modifyOutputTerms\_getDataAttributes($arrTerms, $filterType){ |
  | 2388 |  |  |
  |  | 2387 |  |
  | 2389 | 2388 | foreach($arrTerms as $index => $term){ |
  | 2390 |  |  |
  |  | 2389 |  |
  | 2391 | 2390 | $termID = UniteFunctionsUC::getVal($term, "id"); |
  | 2392 |  |  |
  |  | 2391 |  |
  | 2393 | 2392 | if(empty($termID)) |
  | 2394 | 2393 | continue; |
  | 2395 |  |  |
  |  | 2394 |  |
  | 2396 | 2395 | $title = UniteFunctionsUC::getVal($term, "name"); |
  | 2397 | 2396 | $slug = UniteFunctionsUC::getVal($term, "slug"); |
  | 2398 | 2397 | $taxonomy = UniteFunctionsUC::getVal($term, "taxonomy"); |
  | 2399 |  |  |
  |  | 2398 |  |
  | 2400 | 2399 | $type = "term"; |
  | 2401 |  |  |
  |  | 2400 |  |
  | 2402 | 2401 | $title = esc\_attr($title); |
  | 2403 | 2402 | $slug = esc\_attr($slug); |
  | 2404 | 2403 | $taxonomy = esc\_attr($taxonomy); |
  | 2405 |  |  |
  |  | 2404 |  |
  | 2406 | 2405 | $key = "{$type}|{$taxonomy}|{$slug}"; |
  | 2407 |  |  |
  |  | 2406 |  |
  | 2408 | 2407 | $htmlData = " data-id=\"$termID\" data-type=\"$type\" data-slug=\"$slug\" data-taxonomy=\"$taxonomy\" data-title=\"{$title}\" data-key=\"{$key}\" "; |
  | 2409 |  |  |
  |  | 2408 |  |
  | 2410 | 2409 | $term["html\_data"] = $htmlData; |
  | 2411 |  |  |
  |  | 2410 |  |
  | 2412 | 2411 | $arrTerms[$index] = $term; |
  | 2413 | 2412 | } |
  | 2414 |  |  |
  |  | 2413 |  |
  | 2415 | 2414 | return($arrTerms); |
  | 2416 | 2415 | } |
  | 2417 |  |  |
  | 2418 |  |  |
  | 2419 |  |  |
  |  | 2416 |  |
  |  | 2417 |  |
  |  | 2418 |  |
  | 2420 | 2419 | /\*\* |
  | 2421 | 2420 | \* get editor filter arguments |
  | 2422 | 2421 | \*/ |
  | 2423 | 2422 | public function addEditorFilterArguments($data, $typeArg){ |
  | 2424 |  |  |
  |  | 2423 |  |
  | 2425 | 2424 | $filterType = self::TYPE\_TABS; |
  | 2426 |  |  |
  |  | 2425 |  |
  | 2427 | 2426 | switch($typeArg){ |
  | 2428 | 2427 | case "type\_select": |
  | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3094530#L2433) | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3097249#L2432) |  |
  | 2433 | 2432 | break; |
  | 2434 | 2433 | } |
  | 2435 |  |  |
  | 2436 |  |  |
  |  | 2434 |  |
  |  | 2435 |  |
  | 2437 | 2436 | //add the filter related js and css includes |
  | 2438 | 2437 | $this->includeClientSideScripts(); |
  | 2439 |  |  |
  |  | 2438 |  |
  | 2440 | 2439 | $isInitAfter = UniteFunctionsUC::getVal($data, "init\_after"); |
  | 2441 | 2440 | $isInitAfter = UniteFunctionsUC::strToBool($isInitAfter); |
  | 2442 |  |  |
  |  | 2441 |  |
  | 2443 | 2442 | $isReplaceTerms = UniteFunctionsUC::getVal($data, "replace\_terms"); |
  | 2444 | 2443 | $isReplaceTerms = UniteFunctionsUC::strToBool($isReplaceTerms); |
  | 2445 |  |  |
  |  | 2444 |  |
  | 2446 | 2445 | $limitGrayedItems = UniteFunctionsUC::getVal($data, "load\_limit\_grayed"); |
  | 2447 | 2446 | $limitGrayedItems = (int)$limitGrayedItems; |
  | 2448 |  |  |
  |  | 2447 |  |
  | 2449 | 2448 | $filterRole = UniteFunctionsUC::getVal($data, "filter\_role"); |
  | 2450 |  | if($filterRole == "single") |
  |  | 2449 | if($filterRole == "single") |
  | 2451 | 2450 | $filterRole = ""; |
  | 2452 |  |  |
  |  | 2451 |  |
  | 2453 | 2452 | $attributes = ""; |
  | 2454 | 2453 | $style = ""; |
  | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3094530#L2456) | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3097249#L2455) |  |
  | 2456 | 2455 | $addClassItem = ""; |
  | 2457 | 2456 | $isFirstLoad = true;        //not in ajax, or with init after (also first load) |
  | 2458 |  |  |
  |  | 2457 |  |
  | 2459 | 2458 | $connectGroup = UniteFunctionsUC::getVal($data, "connect\_group"); |
  | 2460 |  |  |
  |  | 2459 |  |
  | 2461 | 2460 | if($connectGroup == "auto") |
  | 2462 | 2461 | $connectGroup = null; |
  | 2463 |  |  |
  |  | 2462 |  |
  | 2464 | 2463 | $isInsideEditor = GlobalsProviderUC::$isInsideEditor; |
  | 2465 |  |  |
  |  | 2464 |  |
  | 2466 | 2465 | $isUnderAjax = self::$isUnderAjax; |
  | 2467 |  |  |
  |  | 2466 |  |
  | 2468 | 2467 | if($isUnderAjax == true) |
  | 2469 | 2468 | $isFirstLoad = false; |
  | 2470 |  |  |
  |  | 2469 |  |
  | 2471 | 2470 | if($isInitAfter == true){ |
  | 2472 |  |  |
  |  | 2471 |  |
  | 2473 | 2472 | $attributes = " data-initafter=\"true\""; |
  | 2474 |  |  |
  |  | 2473 |  |
  | 2475 | 2474 | if($isUnderAjax == false && $isInsideEditor == false){ |
  | 2476 | 2475 | $addClassItem = " uc-filter-item-hidden"; |
  | 2477 | 2476 | $addClass .= " uc-filter-initing"; |
  | 2478 | 2477 | } |
  | 2479 |  |  |
  |  | 2478 |  |
  | 2480 | 2479 | $isFirstLoad = true; |
  | 2481 | 2480 | } |
  | 2482 |  |  |
  |  | 2481 |  |
  | 2483 | 2482 | if($filterRole == self::ROLE\_TERM\_CHILD){ |
  | 2484 |  |  |
  |  | 2483 |  |
  | 2485 | 2484 | $termID = UniteFunctionsUC::getVal($data, "child\_termid"); |
  | 2486 |  |  |
  |  | 2485 |  |
  | 2487 | 2486 | if(!empty($termID)) |
  | 2488 | 2487 | $attributes .= " data-childterm=\"$termID\""; |
  | 2489 |  |  |
  | 2490 |  | } |
  | 2491 |  |  |
  |  | 2488 |  |
  |  | 2489 | } |
  |  | 2490 |  |
  | 2492 | 2491 | if(!empty($connectGroup)) |
  | 2493 | 2492 | $attributes .= " data-connectgroup=\"$connectGroup\""; |
  | 2494 |  |  |
  | 2495 |  |  |
  |  | 2493 |  |
  |  | 2494 |  |
  | 2496 | 2495 | if($isInsideEditor == true) |
  | 2497 | 2496 | $isFirstLoad = true; |
  | 2498 |  |  |
  |  | 2497 |  |
  | 2499 | 2498 | //main filter |
  | 2500 |  |  |
  |  | 2499 |  |
  | 2501 | 2500 | if(!empty($filterRole)) |
  | 2502 | 2501 | $attributes .= " data-role=\"{$filterRole}\""; |
  | 2503 |  |  |
  |  | 2502 |  |
  | 2504 | 2503 | if($isReplaceTerms == true) |
  | 2505 | 2504 | $attributes .= " data-replace-mode=\"true\""; |
  | 2506 |  |  |
  | 2507 |  |  |
  |  | 2505 |  |
  |  | 2506 |  |
  | 2508 | 2507 | //modify terms |
  | 2509 |  |  |
  |  | 2508 |  |
  | 2510 | 2509 | $arrTerms = UniteFunctionsUC::getVal($data, "taxonomy"); |
  | 2511 |  |  |
  |  | 2510 |  |
  | 2512 | 2511 | //modify the hidden as well |
  | 2513 |  |  |
  |  | 2512 |  |
  | 2514 | 2513 | $arrTerms = $this->modifyOutputTerms\_setNumPosts($arrTerms, $isInitAfter, $isFirstLoad); |
  | 2515 |  |  |
  |  | 2514 |  |
  | 2516 | 2515 | //modify the selected class - add first |
  | 2517 | 2516 | $arrTerms = $this->modifyOutputTerms\_addFirstItem($arrTerms, $data, $filterType); |
  | 2518 |  |  |
  |  | 2517 |  |
  | 2519 | 2518 | //modify the selected class |
  | 2520 | 2519 | $arrTerms = $this->modifyOutputTerms\_modifySelected($arrTerms, $data,$filterType); |
  | 2521 |  |  |
  |  | 2520 |  |
  | 2522 | 2521 | $arrTerms = $this->modifyOutputTerms\_modifySelectedByRequest($arrTerms); |
  | 2523 |  |  |
  |  | 2522 |  |
  | 2524 | 2523 | $isFilterHidden = false; |
  | 2525 |  |  |
  |  | 2524 |  |
  | 2526 | 2525 | switch($filterType){ |
  | 2527 | 2526 | case self::TYPE\_TABS: |
  | 2528 | 2527 | case self::TYPE\_CHECKBOX: |
  | 2529 |  |  |
  |  | 2528 |  |
  | 2530 | 2529 | if($isInitAfter == true && !empty($limitGrayedItems) && $isUnderAjax == false) |
  | 2531 | 2530 | $arrTerms = $this->modifyOutputTerms\_tabs\_modifyLimitGrayed($arrTerms, $limitGrayedItems); |
  | 2532 |  |  |
  |  | 2531 |  |
  | 2533 | 2532 | $isFilterHidden = $this->modifyOutputTerms\_isFilterHidden($data, $arrTerms, $isUnderAjax); |
  | 2534 |  |  |
  |  | 2533 |  |
  | 2535 | 2534 | break; |
  | 2536 | 2535 | case self::TYPE\_SELECT: |
  | 2537 |  |  |
  |  | 2536 |  |
  | 2538 | 2537 | //modify if hidden |
  | 2539 |  |  |
  |  | 2538 |  |
  | 2540 | 2539 | $isFilterHidden = $this->modifyOutputTerms\_isFilterHidden($data, $arrTerms, $isUnderAjax); |
  | 2541 | 2540 | break; |
  | 2542 | 2541 | } |
  | 2543 |  |  |
  | 2544 |  |  |
  |  | 2542 |  |
  |  | 2543 |  |
  | 2545 | 2544 | $arrTerms = $this->modifyOutputTerms\_setSelectedClass($arrTerms, $filterType); |
  | 2546 |  |  |
  |  | 2545 |  |
  | 2547 | 2546 | $arrTerms = $this->modifyOutputTerms\_getDataAttributes($arrTerms, $filterType); |
  | 2548 |  |  |
  | 2549 |  |  |
  | 2550 |  | //hide child filter at start |
  | 2551 |  |  |
  | 2552 |  | if(strpos($filterRole,"child") !== false && |
  | 2553 |  | $isUnderAjax == false && |
  |  | 2547 |  |
  |  | 2548 |  |
  |  | 2549 | //hide child filter at start |
  |  | 2550 |  |
  |  | 2551 | if(strpos($filterRole,"child") !== false && |
  |  | 2552 | $isUnderAjax == false && |
  | 2554 | 2553 | $isInsideEditor == false){ |
  | 2555 |  |  |
  |  | 2554 |  |
  | 2556 | 2555 | $addClass .= " uc-filter-initing uc-initing-filter-hidden"; |
  | 2557 | 2556 | } |
  | 2558 |  |  |
  |  | 2557 |  |
  | 2559 | 2558 | if($this->hasSelectedTerm == true) |
  | 2560 | 2559 | $addClass .= " uc-has-selected"; |
  | 2561 |  |  |
  |  | 2560 |  |
  | 2562 | 2561 | if($isFilterHidden) |
  | 2563 | 2562 | $addClass .= " uc-filter-hidden"; |
  | 2564 |  |  |
  |  | 2563 |  |
  | 2565 | 2564 | $data["filter\_isajax"] = $isUnderAjax?"yes":"no"; |
  | 2566 | 2565 | $data["filter\_attributes"] = $attributes; |
  | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3094530#L2569) | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3097249#L2568) |  |
  | 2569 | 2568 | $data["filter\_addclass\_item"] = $addClassItem; |
  | 2570 | 2569 | $data["filter\_first\_load"] = $isFirstLoad?"yes":"no"; |
  | 2571 |  |  |
  |  | 2570 |  |
  | 2572 | 2571 | $data["taxonomy"] = $arrTerms; |
  | 2573 |  |  |
  | 2574 |  |  |
  |  | 2572 |  |
  |  | 2573 |  |
  | 2575 | 2574 | return($data); |
  | 2576 | 2575 | } |
  | 2577 |  |  |
  | 2578 |  |  |
  |  | 2576 |  |
  |  | 2577 |  |
  | 2579 | 2578 | private function \_\_\_\_\_\_\_MAIN\_\_\_\_\_\_\_\_\_\_(){} |
  | 2580 |  |  |
  | 2581 |  |  |
  |  | 2579 |  |
  |  | 2580 |  |
  | 2582 | 2581 | /\*\* |
  | 2583 | 2582 | \* show the main query debug |
  | 2584 | 2583 | \*/ |
  | 2585 | 2584 | private function showMainQueryDebug(){ |
  | 2586 |  |  |
  |  | 2585 |  |
  | 2587 | 2586 | global $wp\_query; |
  | 2588 |  |  |
  |  | 2587 |  |
  | 2589 | 2588 | $args = $wp\_query->query\_vars; |
  | 2590 |  |  |
  |  | 2589 |  |
  | 2591 | 2590 | $argsForDebug = UniteFunctionsWPUC::cleanQueryArgsForDebug($args); |
  | 2592 |  |  |
  |  | 2591 |  |
  | 2593 | 2592 | dmp("MAIN QUERY DEBUG"); |
  | 2594 |  |  |
  |  | 2593 |  |
  | 2595 | 2594 | dmp($argsForDebug); |
  | 2596 |  |  |
  | 2597 |  | } |
  | 2598 |  |  |
  |  | 2595 |  |
  |  | 2596 | } |
  |  | 2597 |  |
  | 2599 | 2598 | /\*\* |
  | 2600 | 2599 | \* is ajax request |
  | 2601 | 2600 | \*/ |
  | 2602 | 2601 | public function isFrontAjaxRequest(){ |
  | 2603 |  |  |
  |  | 2602 |  |
  | 2604 | 2603 | if(self::$isAjaxCache !== null) |
  | 2605 | 2604 | return(self::$isAjaxCache); |
  | 2606 |  |  |
  |  | 2605 |  |
  | 2607 | 2606 | $frontAjaxAction = UniteFunctionsUC::getPostGetVariable("ucfrontajaxaction","",UniteFunctionsUC::SANITIZE\_KEY); |
  | 2608 |  |  |
  |  | 2607 |  |
  | 2609 | 2608 | if($frontAjaxAction == "getfiltersdata"){ |
  | 2610 | 2609 | self::$isAjaxCache = true; |
  | 2611 | 2610 | return(true); |
  | 2612 | 2611 | } |
  | 2613 |  |  |
  |  | 2612 |  |
  | 2614 | 2613 | self::$isAjaxCache = false; |
  | 2615 |  |  |
  |  | 2614 |  |
  | 2616 | 2615 | return(false); |
  | 2617 | 2616 | } |
  | 2618 |  |  |
  |  | 2617 |  |
  | 2619 | 2618 | /\*\* |
  | 2620 | 2619 | \* just return true |
  | 2621 | 2620 | \*/ |
  | 2622 | 2621 | public function pluginProtection\_ezCacheHideComment(){ |
  | 2623 |  |  |
  |  | 2622 |  |
  | 2624 | 2623 | return(true); |
  | 2625 | 2624 | } |
  | 2626 |  |  |
  | 2627 |  |  |
  |  | 2625 |  |
  |  | 2626 |  |
  | 2628 | 2627 | /\*\* |
  | 2629 | 2628 | \* run some cross plugin protections |
  | 2630 | 2629 | \*/ |
  | 2631 | 2630 | private function runSomeCrossPluginProtections(){ |
  | 2632 |  |  |
  |  | 2631 |  |
  | 2633 | 2632 | add\_filter("wp\_bost\_hide\_cache\_time\_comment",array($this, "pluginProtection\_ezCacheHideComment")); |
  | 2634 |  |  |
  | 2635 |  | } |
  | 2636 |  |  |
  |  | 2633 |  |
  |  | 2634 | } |
  |  | 2635 |  |
  | 2637 | 2636 | /\*\* |
  | 2638 | 2637 | \* set if show debug or not |
  | 2639 | 2638 | \*/ |
  | 2640 | 2639 | private function setShowDebug(){ |
  | 2641 |  |  |
  |  | 2640 |  |
  | 2642 | 2641 | if(self::DEBUG\_FILTER == true){ |
  | 2643 | 2642 | self::$showDebug = true; |
  | 2644 | 2643 | return(false); |
  | 2645 | 2644 | } |
  | 2646 |  |  |
  |  | 2645 |  |
  | 2647 | 2646 | //set debug only for logged in users |
  | 2648 |  |  |
  |  | 2647 |  |
  | 2649 | 2648 | $isDebug = UniteFunctionsUC::getGetVar("ucfiltersdebug","",UniteFunctionsUC::SANITIZE\_TEXT\_FIELD); |
  | 2650 | 2649 | $isDebug = UniteFunctionsUC::strToBool($isDebug); |
  | 2651 |  |  |
  |  | 2650 |  |
  | 2652 | 2651 | if($isDebug == true){ |
  | 2653 |  |  |
  |  | 2652 |  |
  | 2654 | 2653 | $hasPermissions = UniteFunctionsWPUC::isCurrentUserHasPermissions(); |
  | 2655 |  |  |
  |  | 2654 |  |
  | 2656 | 2655 | if($hasPermissions == true){ |
  | 2657 | 2656 | self::$showEchoDebug = true; |
  | 2658 | 2657 | self::$showDebug = true; |
  | 2659 |  |  |
  |  | 2658 |  |
  | 2660 | 2659 | dmp("SHOW DEBUG, logged in user"); |
  | 2661 | 2660 | } |
  | 2662 |  |  |
  | 2663 |  | } |
  | 2664 |  |  |
  | 2665 |  | } |
  | 2666 |  |  |
  | 2667 |  | /\*\* |
  | 2668 |  | \* check and set display errors by general option |
  |  | 2661 |  |
  |  | 2662 | } |
  |  | 2663 |  |
  |  | 2664 | } |
  |  | 2665 |  |
  |  | 2666 | /\*\* |
  |  | 2667 | \* check and set display errors by general option |
  | 2669 | 2668 | s    \*/ |
  | 2670 | 2669 | private function checkSetErrorsReporting(){ |
  | 2671 |  |  |
  |  | 2670 |  |
  | 2672 | 2671 | $setDisplayErrors = HelperProviderCoreUC\_EL::getGeneralSetting("enable\_display\_errors\_ajax"); |
  | 2673 | 2672 | $setDisplayErrors = UniteFunctionsUC::strToBool($setDisplayErrors); |
  | 2674 |  |  |
  |  | 2673 |  |
  | 2675 | 2674 | if($setDisplayErrors == true){ |
  | 2676 |  |  |
  |  | 2675 |  |
  | 2677 | 2676 | ini\_set("display\_errors", "on"); |
  | 2678 | 2677 | error\_reporting(E\_ALL); |
  | 2679 | 2678 | } |
  | 2680 |  |  |
  | 2681 |  | } |
  | 2682 |  |  |
  | 2683 |  |  |
  |  | 2679 |  |
  |  | 2680 | } |
  |  | 2681 |  |
  |  | 2682 |  |
  | 2684 | 2683 | /\*\* |
  | 2685 | 2684 | \* test the request filter |
  | 2686 | 2685 | \*/ |
  | 2687 | 2686 | public function operateAjaxResponse(){ |
  | 2688 |  |  |
  |  | 2687 |  |
  | 2689 | 2688 | if(self::DEBUG\_MAIN\_QUERY == true){ |
  | 2690 | 2689 | $this->showMainQueryDebug(); |
  | 2691 | 2690 | exit(); |
  | 2692 | 2691 | } |
  | 2693 |  |  |
  |  | 2692 |  |
  | 2694 | 2693 | $frontAjaxAction = UniteFunctionsUC::getPostGetVariable("ucfrontajaxaction","",UniteFunctionsUC::SANITIZE\_KEY); |
  | 2695 |  |  |
  |  | 2694 |  |
  | 2696 | 2695 | if(empty($frontAjaxAction)) |
  | 2697 | 2696 | return(false); |
  | 2698 |  |  |
  |  | 2697 |  |
  | 2699 | 2698 | $this->runSomeCrossPluginProtections(); |
  | 2700 |  |  |
  |  | 2699 |  |
  | 2701 | 2700 | $this->setShowDebug(); |
  | 2702 |  |  |
  |  | 2701 |  |
  | 2703 | 2702 | $this->checkSetErrorsReporting(); |
  | 2704 | 2703 |  |
  | 2705 | 2704 | self::$isUnderAjax = true; |
  | 2706 |  |  |
  |  | 2705 |  |
  | 2707 | 2706 | try{ |
  | 2708 |  |  |
  |  | 2707 |  |
  | 2709 | 2708 | switch($frontAjaxAction){ |
  | 2710 | 2709 | case "getfiltersdata": |
  | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3094530#L2715) | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_filters_process.class.php?rev=3097249#L2714) |  |
  | 2715 | 2714 | break; |
  | 2716 | 2715 | case "submitform": |
  | 2717 |  |  |
  |  | 2716 |  |
  | 2718 | 2717 | $form = new UniteCreatorForm(); |
  | 2719 | 2718 | $form->submitFormFront(); |
  | 2720 |  |  |
  |  | 2719 |  |
  | 2721 | 2720 | break; |
  | 2722 | 2721 | case "removefromcart": |
  | 2723 |  |  |
  |  | 2722 |  |
  | 2724 | 2723 | $objWoo = UniteCreatorWooIntegrate::getInstance(); |
  | 2725 |  |  |
  |  | 2724 |  |
  | 2726 | 2725 | $objWoo->removeFromCartFromData(); |
  | 2727 |  |  |
  |  | 2726 |  |
  | 2728 | 2727 | break; |
  | 2729 | 2728 | case "updatecartquantity": |
  | 2730 |  |  |
  |  | 2729 |  |
  | 2731 | 2730 | $objWoo = UniteCreatorWooIntegrate::getInstance(); |
  | 2732 |  |  |
  |  | 2731 |  |
  | 2733 | 2732 | $objWoo->updateCartQuantityFromData(); |
  | 2734 | 2733 | break; |
  | 2735 | 2734 | case "getcartdata": |
  | 2736 |  |  |
  |  | 2735 |  |
  | 2737 | 2736 | $objWoo = UniteCreatorWooIntegrate::getInstance(); |
  | 2738 | 2737 | $objWoo->outputCartFragments(); |
  | 2739 |  |  |
  |  | 2738 |  |
  | 2740 | 2739 | break; |
  | 2741 | 2740 | case "dynamicpopupcache": |
  | 2742 |  |  |
  |  | 2741 |  |
  | 2743 | 2742 | $this->putDynamicPopupCache(); |
  | 2744 |  |  |
  |  | 2743 |  |
  | 2745 | 2744 | break; |
  | 2746 | 2745 | case "custom": |
  | 2747 |  |  |
  |  | 2746 |  |
  | 2748 | 2747 | do\_action("uc\_custom\_front\_ajax\_action"); |
  | 2749 |  |  |
  |  | 2748 |  |
  | 2750 | 2749 | //if not catch - will throw error |
  | 2751 |  |  |
  |  | 2750 |  |
  | 2752 | 2751 | default: |
  | 2753 | 2752 | UniteFunctionsUC::throwError("wrong front ajax action: $frontAjaxAction"); |
  | 2754 | 2753 | break; |
  | 2755 | 2754 | } |
  | 2756 |  |  |
  |  | 2755 |  |
  | 2757 | 2756 | }catch(Exception $e){ |
  | 2758 |  |  |
  |  | 2757 |  |
  | 2759 | 2758 | $message = $e->getMessage(); |
  | 2760 |  |  |
  |  | 2759 |  |
  | 2761 | 2760 | HelperUC::ajaxResponseError($message); |
  | 2762 |  |  |
  | 2763 |  | } |
  | 2764 |  |  |
  | 2765 |  | } |
  | 2766 |  |  |
  | 2767 |  |  |
  |  | 2761 |  |
  |  | 2762 | } |
  |  | 2763 |  |
  |  | 2764 | } |
  |  | 2765 |  |
  |  | 2766 |  |
  | 2768 | 2767 | /\*\* |
  | 2769 | 2768 | \* init wordpress front filters |
  | 2770 | 2769 | \*/ |
  | 2771 | 2770 | public function initWPFrontFilters(){ |
  | 2772 |  |  |
  |  | 2771 |  |
  | 2773 | 2772 | if(is\_admin() == true) |
  | 2774 | 2773 | return(false); |
  | 2775 |  |  |
  |  | 2774 |  |
  | 2776 | 2775 | add\_action("wp", array($this, "operateAjaxResponse")); |
  | 2777 |  |  |
  |  | 2776 |  |
  | 2778 | 2777 | add\_action("ue\_before\_custom\_posts\_query", array($this, "onBeforeCustomPostsQuery")); |
  | 2779 | 2778 | //add\_action("ue\_after\_custom\_posts\_query", array($this, "onAfterCustomPostsQuery")); |
  | 2780 |  |  |
  | 2781 |  |  |
  | 2782 |  | } |
  | 2783 |  |  |
  | 2784 |  |  |
  |  | 2779 |  |
  |  | 2780 |  |
  |  | 2781 | } |
  |  | 2782 |  |
  |  | 2783 |  |
  | 2785 | 2784 | } |
* ## [unlimited-elements-for-elementor/trunk/inc\_php/unitecreator\_form.class.php](/changeset/3097249/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_form.class.php "Show the changeset 3097249 restricted to unlimited-elements-for-elementor/trunk/inc_php/unitecreator_form.class.php")

  | [r3094530](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_form.class.php?rev=3094530#L212 "Show revision 3094530 of this file in browser") | [r3097249](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_form.class.php?rev=3097249#L212 "Show revision 3097249 of this file in browser") |  |
  | --- | --- | --- |
  | 212 | 212 |  |
  | 213 | 213 | $postContent = HelperProviderCoreUC\_EL::getElementorContentByPostID($postId); |
  | 214 |  |  |
  |  | 214 |  |
  | 215 | 215 | if(empty($postContent)) |
  | 216 | 216 | UniteFunctionsUC::throwError("Form elementor content not found."); |
* ## [unlimited-elements-for-elementor/trunk/inc\_php/unitecreator\_globals.class.php](/changeset/3097249/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_globals.class.php "Show the changeset 3097249 restricted to unlimited-elements-for-elementor/trunk/inc_php/unitecreator_globals.class.php")

  | [r3094530](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_globals.class.php?rev=3094530#L259 "Show revision 3094530 of this file in browser") | [r3097249](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_globals.class.php?rev=3097249#L259 "Show revision 3097249 of this file in browser") |  |
  | --- | --- | --- |
  | 259 | 259 |  |
  | 260 | 260 | //dmp("init globals"); |
  | 261 |  |  |
  |  | 261 |  |
  | 262 | 262 | UniteProviderFunctionsUC::doAction(UniteCreatorFilters::ACTION\_AFTER\_INIT\_GLOBALS); |
  | 263 |  |  |
  |  | 263 |  |
  | 264 | 264 | if(self::$is\_admin){ |
  | 265 | 265 |  |
* ## [unlimited-elements-for-elementor/trunk/inc\_php/unitecreator\_helperhtml.class.php](/changeset/3097249/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_helperhtml.class.php "Show the changeset 3097249 restricted to unlimited-elements-for-elementor/trunk/inc_php/unitecreator_helperhtml.class.php")

  | [r3094530](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_helperhtml.class.php?rev=3094530#L201 "Show revision 3094530 of this file in browser") | [r3097249](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_helperhtml.class.php?rev=3097249#L201 "Show revision 3097249 of this file in browser") |  |
  | --- | --- | --- |
  | 201 | 201 | $js .= self::TAB2.'var g\_ucElIcons = '.$jsonElementorIcons.';'.self::BR; |
  | 202 | 202 |  |
  | 203 |  |  |
  | 204 |  | ~~//output shapes~~ |
  | 205 |  | ~~/\*~~ |
  | 206 |  | ~~$objShapes = new UniteShapeManagerUC();~~ |
  | 207 |  | ~~$jsonShapes = $objShapes->getJsonShapes();~~ |
  | 208 |  | ~~$js .= self::TAB2.'var g\_ucArrSvgShapes = '.$jsonShapes.';'.self::BR;~~ |
  | 209 |  | ~~\*/~~ |
  | 210 | 203 |  |
  | 211 | 204 | //get nonce |
* ## [unlimited-elements-for-elementor/trunk/inc\_php/unitecreator\_params\_processor.class.php](/changeset/3097249/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_params_processor.class.php "Show the changeset 3097249 restricted to unlimited-elements-for-elementor/trunk/inc_php/unitecreator_params_processor.class.php")

  | [r3076447](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_params_processor.class.php?rev=3076447#L1107 "Show revision 3076447 of this file in browser") | [r3097249](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_params_processor.class.php?rev=3097249#L1107 "Show revision 3097249 of this file in browser") |  |
  | --- | --- | --- |
  | 1107 | 1107 |  |
  | 1108 | 1108 |  |
  | 1109 |  | ~~private function z\_\_\_\_\_\_\_\_SHAPE\_\_\_\_\_\_\_\_(){}~~ |
  | 1110 |  |  |
  | 1111 |  |  |
  | 1112 |  | ~~/\*\*~~ |
  | 1113 |  | ~~\* get the shape addon~~ |
  | 1114 |  | ~~\*/~~ |
  | 1115 |  | ~~private function getProcessedParamsValue\_shapeOutput($data, $value, $param){~~ |
  | 1116 |  |  |
  | 1117 |  | ~~$paramName = UniteFunctionsUC::getVal($param, "name");~~ |
  | 1118 |  |  |
  | 1119 |  | ~~$shapeData = "";~~ |
  | 1120 |  |  |
  | 1121 |  | ~~if(empty($value)){~~ |
  | 1122 |  | ~~$data[$paramName] = "";~~ |
  | 1123 |  | ~~return($data);~~ |
  | 1124 |  | ~~}~~ |
  | 1125 |  |  |
  | 1126 |  | ~~if(empty($this->objShapes))~~ |
  | 1127 |  | ~~$this->objShapes = new UniteShapeManagerUC();~~ |
  | 1128 |  |  |
  | 1129 |  | ~~$svgContent = $this->objShapes->getShapeSVGContent($value);~~ |
  | 1130 |  | ~~$data[$paramName] = $svgContent;~~ |
  | 1131 |  |  |
  | 1132 |  | ~~return($data);~~ |
  | 1133 |  | ~~}~~ |
  | 1134 |  |  |
  | 1135 |  |  |
  | 1136 |  | ~~/\*\*~~ |
  | 1137 |  | ~~\* addon picker output~~ |
  | 1138 |  | ~~\*/~~ |
  | 1139 |  | ~~private function getProcessedParamsValue\_addonPickerOutput($data, $value, $param){~~ |
  | 1140 |  |  |
  | 1141 |  | ~~$addonType = UniteFunctionsUC::getVal($param, "addon\_type");~~ |
  | 1142 |  |  |
  | 1143 |  | ~~switch($addonType){~~ |
  | 1144 |  | ~~case GlobalsUC::ADDON\_TYPE\_SHAPES:~~ |
  | 1145 |  | ~~$data = $this->getProcessedParamsValue\_shapeOutput($data, $value, $param);~~ |
  | 1146 |  | ~~break;~~ |
  | 1147 |  | ~~}~~ |
  | 1148 |  |  |
  | 1149 |  | ~~return($data);~~ |
  | 1150 |  | ~~}~~ |
  | 1151 |  |  |
  | 1152 | 1109 |  |
  | 1153 | 1110 | private function z\_\_\_\_\_\_\_\_\_INSTAGRAM\_\_\_\_\_\_\_\_\_(){} |
  | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_params_processor.class.php?rev=3076447#L1927) | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_params_processor.class.php?rev=3097249#L1884) |  |
  | 1927 | 1884 | $data[$name] = $this->getGoogleMapOutput($value, $name, $param); |
  | 1928 | 1885 | break; |
  | 1929 |  | ~~case UniteCreatorDialogParam::PARAM\_SHAPE:~~ |
  | 1930 |  | ~~$data = $this->getProcessedParamsValue\_shapeOutput($data, $value, $param);~~ |
  | 1931 |  | ~~break;~~ |
  | 1932 |  | ~~case UniteCreatorDialogParam::PARAM\_ADDONPICKER:~~ |
  | 1933 |  | ~~$data = $this->getProcessedParamsValue\_addonPickerOutput($data, $value, $param);~~ |
  | 1934 |  | ~~break;~~ |
  | 1935 | 1886 | } |
  | 1936 | 1887 |  |
  | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_params_processor.class.php?rev=3076447#L2160) | […](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_params_processor.class.php?rev=3097249#L2111) |  |
  | 2160 | 2111 | \*/ |
  | 2161 | 2112 | public function getProcessedItemsData($arrItems, $processType, $forTemplate = true, $filterType = null){ |
  | 2162 |  |  |
  |  | 2113 |  |
  | 2163 | 2114 | $this->validateInited(); |
  | 2164 | 2115 | self::validateProcessType($processType); |
* ## [unlimited-elements-for-elementor/trunk/inc\_php/unitecreator\_web\_api.class.php](/changeset/3097249/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_web_api.class.php "Show the changeset 3097249 restricted to unlimited-elements-for-elementor/trunk/inc_php/unitecreator_web_api.class.php")

  | [r3034661](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_web_api.class.php?rev=3034661#L1418 "Show revision 3034661 of this file in browser") | [r3097249](/browser/unlimited-elements-for-elementor/trunk/inc_php/unitecreator_web_api.class.php?rev=3097249#L1418 "Show revision 3097249 of this file in browser") |  |
  | --- | --- | --- |
  | 1418 | 1418 | protected function getImportedAddonData($addonType, $addonID){ |
  | 1419 | 1419 |  |
  | 1420 |  | if($addonType != GlobalsUC::ADDON\_TYPE\_SHAPE\_DEVIDER) |
  | 1421 |  | return(array()); |
  | 1422 |  |  |
  | 1423 |  | $objShapes = new UniteShapeManagerUC(); |
  | 1424 |  | $shapeBGContent = $objShapes->getShapeBGContentBYAddonID($addonID); |
  | 1425 |  |  |
  | 1426 |  | $data = array(); |
  | 1427 |  | $data["shape\_content"] = $shapeBGContent; |
  | 1428 |  |  |
  | 1429 |  | return($data); |
  |  | 1420 |  |
  |  | 1421 | return(array()); |
  | 1430 | 1422 | } |
  | 1431 | 1423 |  |
* ## [unlimited-elements-for-elementor/trunk/js/admin.js](/changeset/3097249/unlimited-elements-for-elementor/trunk/js/admin.js "Show the changeset 3097249 restricted to unlimited-elements-for-elementor/trunk/js/admin.js")

  | [r3071404](/browser/unlimited-elements-for-elementor/trunk/js/admin.js?rev=3071404#L2682 "Show revision 3071404 of this file in browser") | [r3097249](/browser/unlimited-elements-for-elementor/trunk/js/admin.js?rev=3097249#L2682 "Show revision 3097249 of this file in browser") |  |
  | --- | --- | --- |
  | 2682 | 2682 | if(!g\_ucAdmin) |
  | 2683 | 2683 | g\_ucAdmin = new UniteAdminUC(); |
  | 2684 |  |  |
  |  | 2684 |  |
  | 2685 | 2685 | g\_ucAdmin.globalInit(); |
  | 2686 | 2686 |  |
* ## [unlimited-elements-for-elementor/trunk/provider/assets/gutenberg\_integrate.js](/changeset/3097249/unlimited-elements-for-elementor/trunk/provider/assets/gutenberg_integrate.js "Show the changeset 3097249 restricted to unlimited-elements-for-elementor/trunk/provider/assets/gutenberg_integrate.js")

  | [r3094530](/browser/unlimited-elements-for-elementor/trunk/provider/assets/gutenberg_integrate.js?rev=3094530#L182 "Show revision 3094530 of this file in browser") | [r3097249](/browser/unlimited-elements-for-elementor/trunk/provider/assets/gutenberg_integrate.js?rev=3097249#L182 "Show revision 3097249 of this file in browser") |  |
  | --- | --- | --- |
  | 182 | 182 | } |
  | 183 | 183 |  |
  | 184 |  | if (!settingsContent) |
  |  | 184 | var settings = getSettings(); |
  |  | 185 |  |
  |  | 186 | if (!settings) |
  | 185 | 187 | return; // wait for the settings |
  | 186 | 188 |  |
  | […](/browser/unlimited-elements-for-elementor/trunk/provider/assets/gutenberg_integrate.js?rev=3094530#L195) | […](/browser/unlimited-elements-for-elementor/trunk/provider/assets/gutenberg_integrate.js?rev=3097249#L197) |  |
  | 195 | 197 | id: props.attributes.\_id, |
  | 196 | 198 | root\_id: props.attributes.\_rootId, |
  | 197 |  | settings: ~~getSettings()~~, |
  |  | 199 | settings: settings, |
  | 198 | 200 | selectors: true, |
  | 199 | 201 | }, function (response) { |
* ## [unlimited-elements-for-elementor/trunk/provider/core/unlimited\_elements/elementor/elementor\_integrate.class.php](/changeset/3097249/unlimited-elements-for-elementor/trunk/provider/core/unlimited_elements/elementor/elementor_integrate.class.php "Show the changeset 3097249 restricted to unlimited-elements-for-elementor/trunk/provider/core/unlimited_elements/elementor/elementor_integrate.class.php")

  | [r3094530](/browser/unlimited-elements-for-elementor/trunk/provider/core/unlimited_elements/elementor/elementor_integrate.class.php?rev=3094530#L1704 "Show revision 3094530 of this file in browser") | [r3097249](/browser/unlimited-elements-for-elementor/trunk/provider/core/unlimited_elements/elementor/elementor_integrate.class.php?rev=3097249#L1704 "Show revision 3097249 of this file in browser") |  |
  | --- | --- | --- |
  | 1704 | 1704 | if($isEnabled == false) |
  | 1705 | 1705 | return(false); |
  | 1706 |  |  |
  |  | 1706 |  |
  | 1707 | 1707 | $isPreviewOption = UniteFunctionsUC::getGetVar("elementor-preview", "", UniteFunctionsUC::SANITIZE\_KEY); |
  | 1708 | 1708 |  |
* ## [unlimited-elements-for-elementor/trunk/provider/core/unlimited\_elements/elementor/elementor\_widget.class.php](/changeset/3097249/unlimited-elements-for-elementor/trunk/provider/core/unlimited_elements/elementor/elementor_widget.class.php "Show the changeset 3097249 restricted to unlimited-elements-for-elementor/trunk/provider/core/unlimited_elements/elementor/elementor_widget.class.php")

  | [r3094530](/browser/unlimited-elements-for-elementor/trunk/provider/core/unlimited_elements/elementor/elementor_widget.class.php?rev=3094530#L2092 "Show revision 3094530 of this file in browser") | [r3097249](/browser/unlimited-elements-for-elementor/trunk/provider/core/unlimited_elements/elementor/elementor_widget.class.php?rev=3097249#L2092 "Show revision 3097249 of this file in browser") |  |
  | --- | --- | --- |
  | 2092 | 2092 | if(empty($arrItems)) |
  | 2093 | 2093 | $arrItems = array(); |
  | 2094 |  |  |
  |  | 2094 |  |
  | 2095 | 2095 | $arrDefaults = array(); |
  | 2096 | 2096 |  |
* ## [unlimited-elements-for-elementor/trunk/provider/core/unlimited\_elements/globals.class.php](/changeset/3097249/unlimited-elements-for-elementor/trunk/provider/core/unlimited_elements/globals.class.php "Show the changeset 3097249 restricted to unlimited-elements-for-elementor/trunk/provider/core/unlimited_elements/globals.class.php")

  | [r3094530](/browser/unlimited-elements-for-elementor/trunk/provider/core/unlimited_elements/globals.class.php?rev=3094530#L94 "Show revision 3094530 of this file in browser") | [r3097249](/browser/unlimited-elements-for-elementor/trunk/provider/core/unlimited_elements/globals.class.php?rev=3097249#L94 "Show revision 3097249 of this file in browser") |  |
  | --- | --- | --- |
  | 94 | 94 | public static $pluginTitleCurrent; |
  | 95 | 95 |  |
  |  | 96 | public static $pathPlugin; |
  |  | 97 | public static $pathPluginSettings; |
  |  | 98 |  |
  | 96 | 99 |  |
  | 97 | 100 | /\*\* |
  | […](/browser/unlimited-elements-for-elementor/trunk/provider/core/unlimited_elements/globals.class.php?rev=3094530#L99) | […](/browser/unlimited-elements-for-elementor/trunk/provider/core/unlimited_elements/globals.class.php?rev=3097249#L102) |  |
  | 99 | 102 | \*/ |
  | 100 | 103 | public static function initGlobals(){ |
  |  | 104 |  |
  |  | 105 | self::$pluginTitleCurrent = self::PLUGIN\_TITLE; |
  |  | 106 |  |
  |  | 107 | self::$urlTemplatesList = admin\_url("edit.php?post\_type=elementor\_library&tabs\_group=library"); |
  |  | 108 |  |
  |  | 109 | self::$urlAccount = admin\_url("admin.php?page=unlimitedelements-account"); |
  |  | 110 |  |
  |  | 111 | UniteProviderFunctionsUC::addAction('admin\_init', array("GlobalsUnlimitedElements", 'initAdminNotices')); |
  |  | 112 |  |
  |  | 113 | if(GlobalsUC::$is\_admin == true && HelperUC::hasPermissionsFromQuery("showadminnotices")) |
  |  | 114 | self::$debugAdminNotices = true; |
  |  | 115 |  |
  |  | 116 | //set paths |
  |  | 117 |  |
  |  | 118 | self::$pathPlugin = dirname(\_\_FILE\_\_)."/"; |
  |  | 119 |  |
  |  | 120 | self::$pathPlugin = UniteFunctionsUC::pathToUnix(self::$pathPlugin); |
  |  | 121 |  |
  |  | 122 | self::$pathPluginSettings = self::$pathPlugin."settings/"; |
  |  | 123 |  |
  |  | 124 | } |
  |  | 125 |  |
  |  | 126 |  |
  |  | 127 | /\*\* |
  |  | 128 | \* init after loaded |
  |  | 129 | \*/ |
  |  | 130 | public static function initAfterPluginsLoaded(){ |
  | 101 | 131 |  |
  | 102 | 132 | if(defined("UE\_ENABLE\_GUTENBERG\_SUPPORT")){ |
  | […](/browser/unlimited-elements-for-elementor/trunk/provider/core/unlimited_elements/globals.class.php?rev=3094530#L106) | […](/browser/unlimited-elements-for-elementor/trunk/provider/core/unlimited_elements/globals.class.php?rev=3097249#L136) |  |
  | 106 | 136 | if(GlobalsUC::$inDev == true && defined("UE\_DISABLE\_ELEMENTOR\_SUPPORT")){ |
  | 107 | 137 | self::$enableElementorSupport = false; |
  | 108 |  |  |
  |  | 138 |  |
  | 109 | 139 | if(self::$enableElementorSupport == false && self::$enableGutenbergSupport == true) |
  | 110 | 140 | self::$isGutenbergOnly = true; |
  | 111 |  |  |
  | 112 | 141 | } |
  | 113 |  |  |
  | 114 |  | ~~self::$pluginTitleCurrent = self::PLUGIN\_TITLE;~~ |
  | 115 | 142 |  |
  | 116 | 143 | if(self::$isGutenbergOnly == true){ |
  | […](/browser/unlimited-elements-for-elementor/trunk/provider/core/unlimited_elements/globals.class.php?rev=3094530#L119) | […](/browser/unlimited-elements-for-elementor/trunk/provider/core/unlimited_elements/globals.class.php?rev=3097249#L146) |  |
  | 119 | 146 | } |
  | 120 | 147 |  |
  | 121 |  | ~~self::$urlTemplatesList = admin\_url("edit.php?post\_type=elementor\_library&tabs\_group=library");~~ |
  | 122 |  |  |
  | 123 |  | ~~self::$urlAccount = admin\_url("admin.php?page=unlimitedelements-account");~~ |
  | 124 |  |  |
  | 125 |  | ~~UniteProviderFunctionsUC::addAction('admin\_init', array("GlobalsUnlimitedElements", 'initAdminNotices'));~~ |
  | 126 |  |  |
  | 127 | 148 | if(self::$enableGutenbergSupport == true) |
  | 128 | 149 | self::initGutenbergIntegration(); |
  | 129 |  |  |
  | 130 |  | if(GlobalsUC::$is\_admin == true && HelperUC::hasPermissionsFromQuery("showadminnotices")) |
  | 131 |  | self::$debugAdminNotices = true; |
  | 132 |  |  |
  |  | 150 |  |
  | 133 | 151 | } |
  | 134 |  |  |
  |  | 152 |  |
  |  | 153 |  |
  | 135 | 154 | /\*\* |
  | 136 | 155 | \* init the admin notices |
* ## [unlimited-elements-for-elementor/trunk/provider/core/unlimited\_elements/helper\_provider\_core.class.php](/changeset/3097249/unlimited-elements-for-elementor/trunk/provider/core/unlimited_elements/helper_provider_core.class.php "Show the changeset 3097249 restricted to unlimited-elements-for-elementor/trunk/provider/core/unlimited_elements/helper_provider_core.class.php")

  | [r3094530](/browser/unlimited-elements-for-elementor/trunk/provider/core/unlimited_elements/helper_provider_core.class.php?rev=3094530#L606 "Show revision 3094530 of this file in browser") | [r3097249](/browser/unlimited-elements-for-elementor/trunk/provider/core/unlimited_elements/helper_provider_core.class.php?rev=3097249#L606 "Show revision 3097249 of this file in browser") |  |
  | --- | --- | --- |
  | 606 | 606 | \*/ |
  | 607 | 607 | public static function getPostContent($postID, $content=""){ |
  | 608 |  |  |
  |  | 608 |  |
  | 609 | 609 | if(empty($postID)) |
  | 610 | 610 | return(false); |
  | […](/browser/unlimited-elements-for-elementor/trunk/provider/core/unlimited_elements/helper_provider_core.class.php?rev=3094530#L1250) | […](/browser/unlimited-elements-for-elementor/trunk/provider/core/unlimited_elements/helper_provider_core.class.php?rev=3097249#L1250) |  |
  | 1250 | 1250 |  |
  | 1251 | 1251 | self::$urlCore = GlobalsUC::$urlPlugin.$pathRelative; |
  | 1252 |  |  |
  |  | 1252 |  |
  | 1253 | 1253 | self::$filepathGeneralSettings = self::$pathCore."settings/general\_settings\_el.xml"; |
  | 1254 | 1254 |  |
* ## [unlimited-elements-for-elementor/trunk/provider/core/unlimited\_elements/provider\_core\_admin.class.php](/changeset/3097249/unlimited-elements-for-elementor/trunk/provider/core/unlimited_elements/provider_core_admin.class.php "Show the changeset 3097249 restricted to unlimited-elements-for-elementor/trunk/provider/core/unlimited_elements/provider_core_admin.class.php")

  | [r3094530](/browser/unlimited-elements-for-elementor/trunk/provider/core/unlimited_elements/provider_core_admin.class.php?rev=3094530#L21 "Show revision 3094530 of this file in browser") | [r3097249](/browser/unlimited-elements-for-elementor/trunk/provider/core/unlimited_elements/provider_core_admin.class.php?rev=3097249#L21 "Show revision 3097249 of this file in browser") |  |
  | --- | --- | --- |
  | 21 | 21 | ? GlobalsUnlimitedElements::VIEW\_DASHBOARD |
  | 22 | 22 | : GlobalsUnlimitedElements::VIEW\_ADDONS\_ELEMENTOR; |
  | 23 |  |  |
  |  | 23 |  |
  | 24 | 24 | $this->arrAllowedViews = array( |
  | 25 | 25 | "addons\_elementor", |
* ## [unlimited-elements-for-elementor/trunk/provider/core/unlimited\_elements/settings/general\_settings\_el.xml](/changeset/3097249/unlimited-elements-for-elementor/trunk/provider/core/unlimited_elements/settings/general_settings_el.xml "Show the changeset 3097249 restricted to unlimited-elements-for-elementor/trunk/provider/core/unlimited_elements/settings/general_settings_el.xml")

  | [r3094530](/browser/unlimited-elements-for-elementor/trunk/provider/core/unlimited_elements/settings/general_settings_el.xml?rev=3094530#L3 "Show revision 3094530 of this file in browser") | [r3097249](/browser/unlimited-elements-for-elementor/trunk/provider/core/unlimited_elements/settings/general_settings_el.xml?rev=3097249#L3 "Show revision 3097249 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | <fields> |
  | 4 | 4 |  |
  | 5 |  | <fieldset name="elementor" label="Widgets for Elementor"> |
  | 6 |  |  |
  | 7 |  | <field name="el\_enable" |
  | 8 |  | type="boolean" |
  | 9 |  | default="true" |
  | 10 |  | label="&lt;b&gt;Enable Unlimited Elements&lt;/b&gt;" |
  | 11 |  | description="If disabled, the Unlimited Elements will not appear in the Elementor Page Builder"> |
  | 12 |  | </field> |
  | 13 |  |  |
  | 14 |  | <field type="bulk\_control\_start" |
  | 15 |  | parent="el\_enable" |
  | 16 |  | ctype="show" |
  | 17 |  | value="true" |
  | 18 |  | /> |
  | 19 |  |  |
  | 20 |  |  |
  | 21 |  | <field name="css\_includes\_to" |
  | 22 |  | type="list" |
  | 23 |  | default="body" |
  | 24 |  | label="       Include Css Files To" |
  | 25 |  | description="Choose where to include css files"> |
  | 26 |  | <option value="body" text="Body Before Widget HTML" /> |
  | 27 |  | <option value="footer" text="Footer" /> |
  | 28 |  | </field> |
  | 29 |  |  |
  | 30 |  |  |
  | 31 |  | <field name="enable\_import\_export" |
  | 32 |  | type="boolean" |
  | 33 |  | default="true" |
  | 34 |  | label="       Show Import and Export Buttons In Templates" |
  | 35 |  | description="Show special import and export buttons (import and export with images) in elementor saved templates screen"> |
  | 36 |  | </field> |
  | 37 |  |  |
  | 38 |  |  |
  | 39 |  | <field name="enable\_backgrounds" |
  | 40 |  | type="boolean" |
  | 41 |  | default="true" |
  | 42 |  | label="       Enable Background Widgets" |
  | 43 |  | description="Enable background widgets for elementor sections"> |
  | 44 |  | </field> |
  | 45 |  |  |
  | 46 |  | <field name="enable\_panel\_previews" |
  | 47 |  | type="boolean" |
  | 48 |  | default="true" |
  | 49 |  | label="       Show Elementor Panel Widgets Previews" |
  | 50 |  | description="Show preview images of widget boxes in elementor editor side panel"> |
  | 51 |  | </field> |
  | 52 |  |  |
  | 53 |  | <field type="bulk\_control\_end" /> |
  | 54 |  |  |
  | 55 |  | </fieldset> |
  | 56 |  |  |
  |  | 5 | <fieldset name="elementor" label="Widgets for Elementor" loadfrom="elementor" load\_condition="elementor\_enabled"></fieldset> |
  |  | 6 |  |
  |  | 7 | <!-- |
  |  | 8 | <fieldset name="gutenberg" label="Blocks for Gutenberg" loadfrom="gutenberg" load\_condition="gutenberg\_enabled"></fieldset> |
  |  | 9 | --> |
  |  | 10 |  |
  | 57 | 11 | <fieldset name="widgets" label="Widgets"> |
  | 58 | 12 |  |
* ## [unlimited-elements-for-elementor/trunk/provider/functions\_wordpress.class.php](/changeset/3097249/unlimited-elements-for-elementor/trunk/provider/functions_wordpress.class.php "Show the changeset 3097249 restricted to unlimited-elements-for-elementor/trunk/provider/functions_wordpress.class.php")

  | [r3094530](/browser/unlimited-elements-for-elementor/trunk/provider/functions_wordpress.class.php?rev=3094530#L2780 "Show revision 3094530 of this file in browser") | [r3097249](/browser/unlimited-elements-for-elementor/trunk/provider/functions_wordpress.class.php?rev=3097249#L2780 "Show revision 3097249 of this file in browser") |  |
  | --- | --- | --- |
  | 2780 | 2780 | if(empty($post)) |
  | 2781 | 2781 | return (""); |
  | 2782 |  |  |
  | 2783 |  | //UniteFunctionsUC::showTrace(); |
  | 2784 |  | //dmp($post); |
  | 2785 |  |  |
  |  | 2782 |  |
  | 2786 | 2783 | $postID = $post->ID; |
  | 2787 | 2784 |  |
  | […](/browser/unlimited-elements-for-elementor/trunk/provider/functions_wordpress.class.php?rev=3094530#L2790) | […](/browser/unlimited-elements-for-elementor/trunk/provider/functions_wordpress.class.php?rev=3097249#L2787) |  |
  | 2790 | 2787 | if(isset(self::$cachePostContent[$postID])) |
  | 2791 | 2788 | return (self::$cachePostContent[$postID]); |
  | 2792 |  |  |
  | 2793 |  | self::$cachePostContent[$postID] = $post->post\_content; |
  | 2794 |  |  |
  |  | 2789 |  |
  | 2795 | 2790 | $isEditMode = GlobalsProviderUC::$isInsideEditor; |
  | 2796 |  |  |
  |  | 2791 |  |
  | 2797 | 2792 | if($isEditMode == false) |
  | 2798 | 2793 | $content = get\_the\_content(null, false, $post); |
* ## [unlimited-elements-for-elementor/trunk/provider/gutenberg\_integrate.class.php](/changeset/3097249/unlimited-elements-for-elementor/trunk/provider/gutenberg_integrate.class.php "Show the changeset 3097249 restricted to unlimited-elements-for-elementor/trunk/provider/gutenberg_integrate.class.php")

  | [r3085242](/browser/unlimited-elements-for-elementor/trunk/provider/gutenberg_integrate.class.php?rev=3085242#L20 "Show revision 3085242 of this file in browser") | [r3097249](/browser/unlimited-elements-for-elementor/trunk/provider/gutenberg_integrate.class.php?rev=3097249#L20 "Show revision 3097249 of this file in browser") |  |
  | --- | --- | --- |
  | 20 | 20 | \*/ |
  | 21 | 21 | public function \_\_construct(){ |
  | 22 |  |  |
  | 23 | 22 | } |
  | 24 | 23 |  |
  | […](/browser/unlimited-elements-for-elementor/trunk/provider/gutenberg_integrate.class.php?rev=3085242#L95) | […](/browser/unlimited-elements-for-elementor/trunk/provider/gutenberg_integrate.class.php?rev=3097249#L94) |  |
  | 95 | 94 | $categories[] = array( |
  | 96 | 95 | 'slug' => GlobalsUnlimitedElements::PLUGIN\_NAME, |
  | 97 |  | 'title' => ~~\_\_('Elementor Widgets', 'unlimited-elements-for-elementor')~~, |
  |  | 96 | 'title' => GlobalsUnlimitedElements::PLUGIN\_TITLE\_GUTENBERG, |
  | 98 | 97 | ); |
  | 99 |  |  |
  |  | 98 |  |
  | 100 | 99 | return $categories; |
  | 101 | 100 | } |
  | […](/browser/unlimited-elements-for-elementor/trunk/provider/gutenberg_integrate.class.php?rev=3085242#L123) | […](/browser/unlimited-elements-for-elementor/trunk/provider/gutenberg_integrate.class.php?rev=3097249#L122) |  |
  | 123 | 122 | \*/ |
  | 124 | 123 | public function renderBlock($attributes){ |
  | 125 |  |  |
  |  | 124 |  |
  | 126 | 125 | GlobalsProviderUC::$renderPlatform = GlobalsProviderUC::RENDER\_PLATFORM\_GUTENBERG; |
  | 127 |  |  |
  |  | 126 |  |
  | 128 | 127 | $data = array( |
  | 129 | 128 | 'id' => $attributes['\_id'], |
  | […](/browser/unlimited-elements-for-elementor/trunk/provider/gutenberg_integrate.class.php?rev=3085242#L132) | […](/browser/unlimited-elements-for-elementor/trunk/provider/gutenberg_integrate.class.php?rev=3097249#L131) |  |
  | 132 | 131 | 'selectors' => true, |
  | 133 | 132 | ); |
  | 134 |  |  |
  |  | 133 |  |
  | 135 | 134 | $addonsManager = new UniteCreatorAddons(); |
  | 136 | 135 | $addonData = $addonsManager->getAddonOutputData($data); |
  | […](/browser/unlimited-elements-for-elementor/trunk/provider/gutenberg_integrate.class.php?rev=3085242#L183) | […](/browser/unlimited-elements-for-elementor/trunk/provider/gutenberg_integrate.class.php?rev=3097249#L182) |  |
  | 183 | 182 | } |
  | 184 | 183 |  |
  | 185 |  |  |
  | 186 | 184 | /\*\* |
  | 187 | 185 | \* Get the Gutenberg blocks. |
  | […](/browser/unlimited-elements-for-elementor/trunk/provider/gutenberg_integrate.class.php?rev=3085242#L190) | […](/browser/unlimited-elements-for-elementor/trunk/provider/gutenberg_integrate.class.php?rev=3097249#L188) |  |
  | 190 | 188 | \*/ |
  | 191 | 189 | private function getBlocks(){ |
  | 192 |  |  |
  |  | 190 |  |
  | 193 | 191 | if(empty(self::$blocks) === true){ |
  | 194 | 192 | $addonsOrder = ''; |
  | […](/browser/unlimited-elements-for-elementor/trunk/provider/gutenberg_integrate.class.php?rev=3085242#L197) | […](/browser/unlimited-elements-for-elementor/trunk/provider/gutenberg_integrate.class.php?rev=3097249#L195) |  |
  | 197 | 195 | $addonsManager = new UniteCreatorAddons(); |
  | 198 | 196 | $addons = $addonsManager->getArrAddons($addonsOrder, $addonsParams, $addonsType); |
  | 199 |  |  |
  |  | 197 |  |
  | 200 | 198 | foreach($addons as $addon){ |
  | 201 |  |  |
  | 202 | 199 | $name = $addon->getBlockName(); |
  | 203 |  |  |
  |  | 200 |  |
  | 204 | 201 | self::$blocks[$name] = array( |
  | 205 | 202 | 'name' => $name, |
  | […](/browser/unlimited-elements-for-elementor/trunk/provider/gutenberg_integrate.class.php?rev=3085242#L249) | […](/browser/unlimited-elements-for-elementor/trunk/provider/gutenberg_integrate.class.php?rev=3097249#L246) |  |
  | 249 | 246 | \* Get the parsed Gutenberg blocks. |
  | 250 | 247 | \* |
  | 251 |  | \* @return array |
  | 252 |  | \*/ |
  | 253 |  | public function getParsedBlocks($postID = null){ |
  | 254 |  |  |
  | 255 |  | $post = get\_post($postID); |
  | 256 |  |  |
  |  | 248 | \* @param int|null $postId |
  |  | 249 | \* |
  |  | 250 | \* @return array |
  |  | 251 | \*/ |
  |  | 252 | public function getPostBlocks($postId = null){ |
  |  | 253 |  |
  |  | 254 | $post = get\_post($postId); |
  |  | 255 | $blocks = parse\_blocks($post->post\_content); |
  |  | 256 |  |
  |  | 257 | return $blocks; |
  |  | 258 | } |
  |  | 259 |  |
  |  | 260 | /\*\* |
  |  | 261 | \* Get the existing parsed Gutenberg blocks. |
  |  | 262 | \* |
  |  | 263 | \* @return array |
  |  | 264 | \*/ |
  |  | 265 | public function getParsedBlocks(){ |
  |  | 266 |  |
  |  | 267 | $parsedBlocks = $this->getPostBlocks(); |
  | 257 | 268 | $existingBlocks = $this->getBlocks(); |
  | 258 |  | $parsedBlocks = parse\_blocks($post->post\_content); |
  |  | 269 | $blocks = $this->extractParsedBlocks($parsedBlocks, $existingBlocks); |
  |  | 270 |  |
  |  | 271 | return $blocks; |
  |  | 272 | } |
  |  | 273 |  |
  |  | 274 | /\*\* |
  |  | 275 | \* Get block by root identifier. |
  |  | 276 | \* |
  |  | 277 | \* @param array $content |
  |  | 278 | \* @param int $rootId |
  |  | 279 | \* |
  |  | 280 | \* @return array|null |
  |  | 281 | \*/ |
  |  | 282 | public function getBlockByRootId($content, $rootId){ |
  |  | 283 |  |
  |  | 284 | if(empty($content) === true) |
  |  | 285 | return null; |
  |  | 286 |  |
  |  | 287 | if(is\_array($content) === false) |
  |  | 288 | return null; |
  |  | 289 |  |
  |  | 290 | if(empty($rootId) === true) |
  |  | 291 | return null; |
  |  | 292 |  |
  |  | 293 | foreach($content as $block){ |
  |  | 294 | if(isset($block['blockName']) === false) |
  |  | 295 | continue; |
  |  | 296 |  |
  |  | 297 | $blockAttributes = UniteFunctionsUC::getVal($block, 'attrs'); |
  |  | 298 | $blockRootId = UniteFunctionsUC::getVal($blockAttributes, '\_rootId'); |
  |  | 299 |  |
  |  | 300 | if($rootId === $blockRootId) |
  |  | 301 | return $block; |
  |  | 302 |  |
  |  | 303 | $innerBlocks = UniteFunctionsUC::getVal($block, 'innerBlocks'); |
  |  | 304 |  |
  |  | 305 | if(empty($innerBlocks) === false && is\_array($innerBlocks) === true){ |
  |  | 306 | $innerBlock = $this->getBlockByRootId($innerBlocks, $rootId); |
  |  | 307 |  |
  |  | 308 | if(empty($innerBlock) === false) |
  |  | 309 | return $innerBlock; |
  |  | 310 | } |
  |  | 311 | } |
  |  | 312 |  |
  |  | 313 | return null; |
  |  | 314 | } |
  |  | 315 |  |
  |  | 316 | /\*\* |
  |  | 317 | \* Get settings from the given block. |
  |  | 318 | \* |
  |  | 319 | \* @param array $block |
  |  | 320 | \* |
  |  | 321 | \* @return array |
  |  | 322 | \*/ |
  |  | 323 | public function getSettingsFromBlock($block){ |
  |  | 324 |  |
  |  | 325 | $attributes = UniteFunctionsUC::getVal($block, 'attrs', array()); |
  |  | 326 | $data = UniteFunctionsUC::getVal($attributes, 'data', null); |
  |  | 327 |  |
  |  | 328 | if(empty($data) === true) |
  |  | 329 | return array(); |
  |  | 330 |  |
  |  | 331 | $settings = UniteFunctionsUC::jsonDecode($data); |
  |  | 332 |  |
  |  | 333 | return $settings; |
  |  | 334 | } |
  |  | 335 |  |
  |  | 336 | /\*\* |
  |  | 337 | \* Extract the existing parsed Gutenberg blocks. |
  |  | 338 | \* |
  |  | 339 | \* @param array $parsedBlocks |
  |  | 340 | \* @param array $existingBlocks |
  |  | 341 | \* |
  |  | 342 | \* @return array |
  |  | 343 | \*/ |
  |  | 344 | private function extractParsedBlocks($parsedBlocks, $existingBlocks){ |
  |  | 345 |  |
  | 259 | 346 | $blocks = array(); |
  | 260 |  |  |
  |  | 347 |  |
  | 261 | 348 | foreach($parsedBlocks as $block){ |
  | 262 | 349 | $name = $block['blockName']; |
  | 263 | 350 |  |
  | 264 |  | if(empty($existingBlocks[$name]) === false) |
  |  | 351 | if(empty($existingBlocks[$name]) === false){ |
  | 265 | 352 | $blocks[] = array( |
  | 266 | 353 | 'name' => $name, |
  | 267 | 354 | 'html' => render\_block($block), |
  | 268 | 355 | ); |
  |  | 356 | } |
  |  | 357 |  |
  |  | 358 | $innerBlocks = UniteFunctionsUC::getVal($block, 'innerBlocks'); |
  |  | 359 |  |
  |  | 360 | if(empty($innerBlocks) === false && is\_array($innerBlocks) === true){ |
  |  | 361 | $blocks = array\_merge($blocks, $this->extractParsedBlocks($innerBlocks, $existingBlocks)); |
  |  | 362 | } |
  | 269 | 363 | } |
  | 270 | 364 |  |
  | 271 | 365 | return $blocks; |
  | 272 | 366 | } |
  | 273 |  |  |
  | 274 |  | ~~/\*\*~~ |
  | 275 |  | ~~\* get post blocks~~ |
  | 276 |  | ~~\*/~~ |
  | 277 |  | ~~public function getPostBlocks($postID){~~ |
  | 278 |  |  |
  | 279 |  | ~~$post = get\_post($postID);~~ |
  | 280 |  |  |
  | 281 |  | ~~$arrBlocks = parse\_blocks($post->post\_content);~~ |
  | 282 |  |  |
  | 283 |  | ~~return($arrBlocks);~~ |
  | 284 |  | ~~}~~ |
  | 285 |  |  |
  | 286 |  |  |
  | 287 |  | ~~/\*\*~~ |
  | 288 |  | ~~\* get block by root id~~ |
  | 289 |  | ~~\*/~~ |
  | 290 |  | ~~public function getBlockByRootID($arrContent, $rootID){~~ |
  | 291 |  |  |
  | 292 |  | ~~if(empty($arrContent))~~ |
  | 293 |  | ~~return(null);~~ |
  | 294 |  |  |
  | 295 |  | ~~if(is\_array($arrContent) == false)~~ |
  | 296 |  | ~~return(null);~~ |
  | 297 |  |  |
  | 298 |  | ~~if(empty($rootID))~~ |
  | 299 |  | ~~return(null);~~ |
  | 300 |  |  |
  | 301 |  | ~~foreach($arrContent as $block){~~ |
  | 302 |  |  |
  | 303 |  | ~~if(isset($block["blockName"]) == false)~~ |
  | 304 |  | ~~continue;~~ |
  | 305 |  |  |
  | 306 |  | ~~$attributes = UniteFunctionsUC::getVal($block, "attrs");~~ |
  | 307 |  |  |
  | 308 |  | ~~$blockRootID = UniteFunctionsUC::getVal($attributes, "\_rootId");~~ |
  | 309 |  |  |
  | 310 |  | ~~if($rootID === $blockRootID)~~ |
  | 311 |  | ~~return($block);~~ |
  | 312 |  |  |
  | 313 |  | ~~$innerBlocks = UniteFunctionsUC::getVal($block, "innerBlocks");~~ |
  | 314 |  |  |
  | 315 |  | ~~if(!empty($innerBlocks) && is\_array($innerBlocks)){~~ |
  | 316 |  |  |
  | 317 |  | ~~$innerBlock = $this->getBlockByRootID($innerBlocks, $rootID);~~ |
  | 318 |  |  |
  | 319 |  | ~~if(!empty($innerBlock))~~ |
  | 320 |  | ~~return($innerBlock);~~ |
  | 321 |  | ~~}~~ |
  | 322 |  |  |
  | 323 |  | ~~}~~ |
  | 324 |  |  |
  | 325 |  | ~~return(null);~~ |
  | 326 |  | ~~}~~ |
  | 327 |  |  |
  | 328 |  | ~~/\*\*~~ |
  | 329 |  | ~~\* get settings from block~~ |
  | 330 |  | ~~\*/~~ |
  | 331 |  | ~~public function getSettingsFromBlock($arrBlock){~~ |
  | 332 |  |  |
  | 333 |  | ~~$attributes = UniteFunctionsUC::getVal($arrBlock, "attrs");~~ |
  | 334 |  |  |
  | 335 |  | ~~if(empty($attributes))~~ |
  | 336 |  | ~~return(array());~~ |
  | 337 |  |  |
  | 338 |  | ~~$data = UniteFunctionsUC::getVal($attributes, "data");~~ |
  | 339 |  |  |
  | 340 |  | ~~$arrSettings = UniteFunctionsUC::jsonDecode($data);~~ |
  | 341 |  |  |
  | 342 |  | ~~return($arrSettings);~~ |
  | 343 |  | ~~}~~ |
  | 344 |  |  |
  | 345 | 367 |  |
  | 346 | 368 | } |
* ## [unlimited-elements-for-elementor/trunk/provider/include\_provider\_after.php](/changeset/3097249/unlimited-elements-for-elementor/trunk/provider/include_provider_after.php "Show the changeset 3097249 restricted to unlimited-elements-for-elementor/trunk/provider/include_provider_after.php")

  | [r2093023](/browser/unlimited-elements-for-elementor/trunk/provider/include_provider_after.php?rev=2093023#L4 "Show revision 2093023 of this file in browser") | [r3097249](/browser/unlimited-elements-for-elementor/trunk/provider/include_provider_after.php?rev=3097249#L4 "Show revision 3097249 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 |  |
  | 5 | 5 | HelperProviderUC::registerPlugins(); |
  |  | 6 |  |
* ## [unlimited-elements-for-elementor/trunk/provider/provider\_alt\_loader.php](/changeset/3097249/unlimited-elements-for-elementor/trunk/provider/provider_alt_loader.php "Show the changeset 3097249 restricted to unlimited-elements-for-elementor/trunk/provider/provider_alt_loader.php")

  | [r2948512](/browser/unlimited-elements-for-elementor/trunk/provider/provider_alt_loader.php?rev=2948512#L43 "Show revision 2948512 of this file in browser") | [r3097249](/browser/unlimited-elements-for-elementor/trunk/provider/provider_alt_loader.php?rev=3097249#L43 "Show revision 3097249 of this file in browser") |  |
  | --- | --- | --- |
  | 43 | 43 |  |
  | 44 | 44 | HelperUC::validatePluginStartup(); |
  | 45 |  |  |
  |  | 45 |  |
  | 46 | 46 | require\_once  GlobalsUC::$pathProvider."core/provider\_main\_file.php"; |
  | 47 | 47 |  |
* ## [unlimited-elements-for-elementor/trunk/provider/provider\_helper.class.php](/changeset/3097249/unlimited-elements-for-elementor/trunk/provider/provider_helper.class.php "Show the changeset 3097249 restricted to unlimited-elements-for-elementor/trunk/provider/provider_helper.class.php")

  | [r3094530](/browser/unlimited-elements-for-elementor/trunk/provider/provider_helper.class.php?rev=3094530#L478 "Show revision 3094530 of this file in browser") | [r3097249](/browser/unlimited-elements-for-elementor/trunk/provider/provider_helper.class.php?rev=3097249#L478 "Show revision 3097249 of this file in browser") |  |
  | --- | --- | --- |
  | 478 | 478 | \*/ |
  | 479 | 479 | public static function onPluginsLoaded(){ |
  |  | 480 |  |
  |  | 481 | GlobalsUC::initAfterPluginsLoaded(); |
  |  | 482 |  |
  |  | 483 | GlobalsUnlimitedElements::initAfterPluginsLoaded(); |
  | 480 | 484 |  |
  | 481 | 485 | load\_plugin\_textdomain("unlimited-elements-for-elementor", false, GlobalsUC::$pathWPLanguages); |
  | 482 |  |  |
  | 483 |  | ~~GlobalsUC::initAfterPluginsLoaded();~~ |
  | 484 | 486 |  |
  | 485 | 487 | UniteCreatorWooIntegrate::initActions(); |
  | […](/browser/unlimited-elements-for-elementor/trunk/provider/provider_helper.class.php?rev=3094530#L558) | […](/browser/unlimited-elements-for-elementor/trunk/provider/provider_helper.class.php?rev=3097249#L560) |  |
  | 558 | 560 | \*/ |
  | 559 | 561 | public static function onPluginsLoadedCallPlugins(){ |
  | 560 |  |  |
  |  | 562 |  |
  | 561 | 563 | do\_action("addon\_library\_register\_plugins"); |
  | 562 | 564 |  |
  | […](/browser/unlimited-elements-for-elementor/trunk/provider/provider_helper.class.php?rev=3094530#L582) | […](/browser/unlimited-elements-for-elementor/trunk/provider/provider_helper.class.php?rev=3097249#L584) |  |
  | 582 | 584 |  |
  | 583 | 585 | add\_action("plugins\_loaded", array("HelperProviderUC","onPluginsLoadedCallPlugins")); |
  | 584 |  |  |
  |  | 586 |  |
  | 585 | 587 | } |
  | 586 | 588 |  |
  | […](/browser/unlimited-elements-for-elementor/trunk/provider/provider_helper.class.php?rev=3094530#L930) | […](/browser/unlimited-elements-for-elementor/trunk/provider/provider_helper.class.php?rev=3097249#L932) |  |
  | 930 | 932 | \*/ |
  | 931 | 933 | public static function isBackgroundsEnabled(){ |
  | 932 |  |  |
  |  | 934 |  |
  | 933 | 935 | if(GlobalsUnlimitedElements::$enableElementorSupport == false) |
  | 934 | 936 | return(false); |
* ## [unlimited-elements-for-elementor/trunk/provider/provider\_params\_processor.class.php](/changeset/3097249/unlimited-elements-for-elementor/trunk/provider/provider_params_processor.class.php "Show the changeset 3097249 restricted to unlimited-elements-for-elementor/trunk/provider/provider_params_processor.class.php")

  | [r3090199](/browser/unlimited-elements-for-elementor/trunk/provider/provider_params_processor.class.php?rev=3090199#L777 "Show revision 3090199 of this file in browser") | [r3097249](/browser/unlimited-elements-for-elementor/trunk/provider/provider_params_processor.class.php?rev=3097249#L777 "Show revision 3097249 of this file in browser") |  |
  | --- | --- | --- |
  | 777 | 777 | $arrData["post\_type"] = UniteFunctionsUC::getVal($arrPost, "post\_type"); |
  | 778 | 778 |  |
  | 779 |  | $content = UniteFunctionsWPUC::getPostContent($post); |
  | 780 |  |  |
  |  | 779 | $password = $post->post\_password; |
  |  | 780 | if(!empty($password)) |
  |  | 781 | $content = ""; |
  |  | 782 | else |
  |  | 783 | $content = UniteFunctionsWPUC::getPostContent($post); |
  |  | 784 |  |
  |  | 785 |  |
  | 781 | 786 | $arrData["content"] = $content; |
  | 782 |  |  |
  |  | 787 |  |
  | 783 | 788 | $link = UniteFunctionsWPUC::getPermalink($post); |
  | 784 | 789 |  |
  | […](/browser/unlimited-elements-for-elementor/trunk/provider/provider_params_processor.class.php?rev=3090199#L863) | […](/browser/unlimited-elements-for-elementor/trunk/provider/provider_params_processor.class.php?rev=3097249#L868) |  |
  | 863 | 868 |  |
  | 864 | 869 | $exceprt = UniteFunctionsUC::getVal($arrPost, "post\_excerpt"); |
  | 865 |  |  |
  |  | 870 |  |
  | 866 | 871 | $intro = $exceprt; |
  | 867 | 872 | $introFull = ""; |
  | […](/browser/unlimited-elements-for-elementor/trunk/provider/provider_params_processor.class.php?rev=3090199#L883) | […](/browser/unlimited-elements-for-elementor/trunk/provider/provider_params_processor.class.php?rev=3097249#L888) |  |
  | 883 | 888 | $arrData["intro"] = $intro; |
  | 884 | 889 | $arrData["intro\_full"] = $introFull; |
  | 885 |  |  |
  |  | 890 |  |
  | 886 | 891 | //put data |
  | 887 | 892 | $strDate = UniteFunctionsUC::getVal($arrPost, "post\_date"); |
* ## [unlimited-elements-for-elementor/trunk/readme.txt](/changeset/3097249/unlimited-elements-for-elementor/trunk/readme.txt "Show the changeset 3097249 restricted to unlimited-elements-for-elementor/trunk/readme.txt")

  | [r3094530](/browser/unlimited-elements-for-elementor/trunk/readme.txt?rev=3094530#L4 "Show revision 3094530 of this file in browser") | [r3097249](/browser/unlimited-elements-for-elementor/trunk/readme.txt?rev=3097249#L4 "Show revision 3097249 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | Tags: elementor, elements, addons, elementor addons, elementor widget, page builder, builder, visual editor, wordpress page builder, elementor |
  | 5 | 5 | Requires at least: 3.5 |
  | 6 |  | Tested up to: 6.5 |
  |  | 6 | Tested up to: 6.5.3 |
  | 7 | 7 | Stable tag: 1.0 |
  | 8 | 8 | License: GPLv2 or later |
  | […](/browser/unlimited-elements-for-elementor/trunk/readme.txt?rev=3094530#L867) | […](/browser/unlimited-elements-for-elementor/trunk/readme.txt?rev=3097249#L867) |  |
  | 867 | 867 |  |
  | 868 | 868 | == Changelog == |
  |  | 869 |  |
  |  | 870 | version 1.5.110: 2024-06-04 |
  |  | 871 |  |
  |  | 872 | Plugin Changes: |
  |  | 873 |  |
  |  | 874 | \* Fix: remote arrows was sendin next/prev commands twice |
  |  | 875 | \* Fix: fix some password protected content related security issue |
  |  | 876 | \* Fix: fix some sql security small issue |
  |  | 877 |  |
  |  | 878 |  |
  |  | 879 | Widgets Changes: |
  |  | 880 |  |
  |  | 881 | \* Feature: Email Field (Pro) - Added Asterisk Size option, allowing customization of asterisk size for better design flexibility and emphasis. |
  |  | 882 | \* Feature: Phone Field (Pro) - Added Asterisk Size option, allowing customization of asterisk size for better design flexibility and emphasis. |
  |  | 883 | \* Feature: Event List (Pro) - Added Timezone option, ensuring that expired and upcoming events are counted according to the specified timezone for accurate event scheduling and display. |
  |  | 884 | \* Feature: Number Field (Pro) - Added "Limit Number of Digits" option, allowing users to restrict the number of digits displayed for better control and readability of numerical data. |
  |  | 885 | \* Feature: Phone Field (Pro) - Added "Limit Number of Digits" option, allowing users to restrict the number of digits displayed for better control and readability of numerical data. |
  |  | 886 | \* Feature: Transparent Split Hero (Free) - Added options to enable or disable widget contents like title, subtitle, etc., and introduced an option to add an image or logo for greater customization and flexibility. |
  |  | 887 | \* Feature: Unlimited Charts (Pro) - Added Line Chart Background Color option, allowing customization of the background color for line charts to enhance visual appeal. |
  |  | 888 | \* Fix: Submit Button (Free) - Added validation function for the phone field to ensure correct email format and improve data accuracy. |
  |  | 889 | \* Fix: Mega Menu (Pro) - Added fix for layout issue that sometimes occurs after page load, ensuring consistent and stable page rendering. |
  |  | 890 | \* Fix: Post Carousel (Pro) - Set padding to 0 in Nav Dots to avoid default CSS overrides, ensuring consistent and desired styling. |
  |  | 891 | \* Fix: Semi Circle Progress Bar (Pro) - Added support for Mega Slider widget, enabling the creation and display of Semi Circle Progress Bar widget in interactive sliders for enhanced content presentation. |
  |  | 892 | \* Fix: Floating Chat Buttons (Pro) - Fixed Pulse Animation Grabber Type issue, ensuring correct animation behavior and improved visual effects. |
  |  | 893 | \* Fix: Content Tabs (Free) - Added a small delay before widget initialization to ensure the Content Tabs widget works properly within other widgets, improving overall functionality and integration. |
  |  | 894 | \* Fix: Remote Tabs (Pro) - Changed selector for padding option to resolve issue where link was not clicked when tab was clicked, improving click response accuracy. |
  |  | 895 |  |
  | 869 | 896 |  |
  | 870 | 897 |  |
* ## [unlimited-elements-for-elementor/trunk/release\_log.txt](/changeset/3097249/unlimited-elements-for-elementor/trunk/release_log.txt "Show the changeset 3097249 restricted to unlimited-elements-for-elementor/trunk/release_log.txt")

  | [r3094530](/browser/unlimited-elements-for-elementor/trunk/release_log.txt?rev=3094530#L1 "Show revision 3094530 of this file in browser") | [r3097249](/browser/unlimited-elements-for-elementor/trunk/release_log.txt?rev=3097249#L1 "Show revision 3097249 of this file in browser") |  |
  | --- | --- | --- |
  |  | 1 |  |
  |  | 2 |  |
  |  | 3 | version 1.5.110: |
  |  | 4 |  |
  |  | 5 | \* Fix: remote arrows was sendin next/prev commands twice |
  |  | 6 | \* Fix: fix some password protected content related security issue |
  |  | 7 | \* Fix: fix some sql security small issue |
  | 1 | 8 |  |
  | 2 | 9 |  |
* ## [unlimited-elements-for-elementor/trunk/settings/layout\_addon\_container\_settings.xml](/changeset/3097249/unlimited-elements-for-elementor/trunk/settings/layout_addon_container_settings.xml "Show the changeset 3097249 restricted to unlimited-elements-for-elementor/trunk/settings/layout_addon_container_settings.xml")

  | [r2063047](/browser/unlimited-elements-for-elementor/trunk/settings/layout_addon_container_settings.xml?rev=2063047#L79 "Show revision 2063047 of this file in browser") | [r3097249](/browser/unlimited-elements-for-elementor/trunk/settings/layout_addon_container_settings.xml?rev=3097249#L79 "Show revision 3097249 of this file in browser") |  |
  | --- | --- | --- |
  | 79 | 79 | </fieldset> |
  | 80 | 80 |  |
  | 81 |  | <fieldset name="background" label="Background" loadfrom="background"></fieldset> |
  | 82 |  |  |
  |  | 81 | <fieldset name="background" label="Background" loadfrom="background"></fieldset> |
  |  | 82 |  |
  | 83 | 83 | <fieldset name="common\_hidden" loadfrom="common\_hidden"></fieldset> |
  | 84 | 84 |  |
* ## [unlimited-elements-for-elementor/trunk/unlimited\_elements.php](/changeset/3097249/unlimited-elements-for-elementor/trunk/unlimited_elements.php "Show the changeset 3097249 restricted to unlimited-elements-for-elementor/trunk/unlimited_elements.php")

  | [r3090199](/browser/unlimited-elements-for-elementor/trunk/unlimited_elements.php?rev=3090199#L5 "Show revision 3090199 of this file in browser") | [r3097249](/browser/unlimited-elements-for-elementor/trunk/unlimited_elements.php?rev=3097249#L5 "Show revision 3097249 of this file in browser") |  |
  | --- | --- | --- |
  | 5 | 5 | \* Description: Unlimited Elements - Huge Widgets Pack for Elementor Website Builder, with html/css/js widget creator and editor |
  | 6 | 6 | \* Author: Unlimited Elements |
  | 7 |  | \* Version: 1.5.1~~08~~ |
  |  | 7 | \* Version: 1.5.110 |
  | 8 | 8 | \* Author URI: http://unlimited-elements.com |
  | 9 | 9 | \* Text Domain: unlimited-elements-for-elementor |
  | 10 | 10 | \* Domain Path: /languages |
  | 11 | 11 | \* |
  | 12 |  | \* Tested up to: 6.5 |
  | 13 |  | \* Elementor tested up to: 3.21.~~2~~ |
  | 14 |  | \* Elementor Pro tested up to: 3.21.~~0~~ |
  |  | 12 | \* Tested up to: 6.5.3 |
  |  | 13 | \* Elementor tested up to: 3.21.8 |
  |  | 14 | \* Elementor Pro tested up to: 3.21.3 |
  | 15 | 15 | \*/ |
  | 16 | 16 |  |
* ## [unlimited-elements-for-elementor/trunk/views/layouts.php](/changeset/3097249/unlimited-elements-for-elementor/trunk/views/layouts.php "Show the changeset 3097249 restricted to unlimited-elements-for-elementor/trunk/views/layouts.php")

  | [r3094530](/browser/unlimited-elements-for-elementor/trunk/views/layouts.php?rev=3094530#L7 "Show revision 3094530 of this file in browser") | [r3097249](/browser/unlimited-elements-for-elementor/trunk/views/layouts.php?rev=3097249#L7 "Show revision 3097249 of this file in browser") |  |
  | --- | --- | --- |
  | 7 | 7 | \* \*/ |
  | 8 | 8 | defined('UNLIMITED\_ELEMENTS\_INC') or die('Restricted access'); |
  |  | 9 |  |
  | 9 | 10 |  |
  | 10 | 11 | require HelperUC::getPathViewObject("layouts\_view.class"); |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3097249)
* [Zip Archive](?format=zip&new=3097249)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


