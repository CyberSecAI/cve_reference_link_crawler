The provided content relates to CVE-2021-47376.

**Root cause of vulnerability:**
The vulnerability arises from a missing size check in the `check_btf_line` function within the Linux kernel's BPF verifier. Specifically, the `nr_linfo` value, representing the number of line info entries, is not validated to ensure it doesn't cause an integer overflow when multiplied by the size of a `bpf_line_info` structure. This can lead to an oversized allocation attempt via `kvcalloc`.

**Weaknesses/vulnerabilities present:**
- Integer overflow: The lack of a check on `nr_linfo` before multiplying it with `sizeof(struct bpf_line_info)` can lead to an integer overflow, resulting in a smaller-than-expected allocation size.
- Oversized allocation: When an integer overflow occurs, `kvcalloc` might be called with a much smaller size than intended, but it still attempts to allocate memory based on the (overflowed) result, potentially leading to a heap overflow.

**Impact of exploitation:**
- Kernel crash: An oversized allocation can lead to a kernel panic or unexpected behavior due to memory corruption.
- Potential arbitrary code execution: In more severe scenarios, heap overflows can be exploited to gain control of the kernel.

**Attack vectors:**
- A malicious user with the ability to load BPF programs can create a crafted BPF program with a very large value for the `line_info_cnt`, causing the integer overflow and the subsequent vulnerability during the verification process.

**Required attacker capabilities/position:**
- The attacker needs the capability to load BPF programs into the kernel.
- The attacker does not need to be root, but must have the CAP_BPF capability.