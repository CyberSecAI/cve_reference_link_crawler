

* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D2270717)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D2270717)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D2270717)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 2270717

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 2270717**](show_bug.cgi?id=2270717)
(CVE-2024-3056)
- [CVE-2024-3056](https://access.redhat.com/security/cve/CVE-2024-3056) podman: kernel: containers in shared IPC namespace are vulnerable to denial of service attack

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2024-3056 podman: kernel: containers in shared IPC namespace are vulnerab...

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | NEW | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2024-3056 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | medium | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [2302003](show_bug.cgi?id=2302003 "NEW - CVE-2024-3056 podman: containers in shared IPC namespace are vulnerable to denial of service attack [fedora-all]") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [2270713](show_bug.cgi?id=2270713) | | TreeView+ | [depends on](buglist.cgi?bug_id=2270717&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=2270717&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2024-03-21 14:56 UTC by Robb Gatica | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2024-10-16 04:09 UTC ([History](show_activity.cgi?id=2270717)) | | [CC List:](page.cgi?id=fields.html#cclist) | 56 users (show)  acaringi allarkin aquini askrabec bhu chwhite cye cyin dan.cermak dbohanno debarbos dfreiber drow dvlasenk esandeen ezulian gscrivan hkrzesin jarod jburrell jdenham jfaracco jlelli joe.lawrence jshortt jstancek jwyatt kcarcia ldoskova lgoncalv llong lzampier mheon mleitner mmilgram mstowell nmurray ptalbert rparrazo rrobaina rvrbovsk rysulliv scweaver security-response-team sidakwo sukulkar tglozar tsweeney tyberry vkumar wcosta williams wmealing ycote ykopkova zhijwang | | Fixed In Version: |  | | | Doc Type: | If docs needed, set a value | | | Doc Text: | A flaw was found in Podman. This issue may allow an attacker to create a specially crafted container that, when configured to share the same IPC with at least one other container, can create a large number of IPC resources in /dev/shm. The malicious container will continue to exhaust resources until it is out-of-memory (OOM) killed. While the malicious container's cgroup will be removed, the IPC resources it created are not. Those resources are tied to the IPC namespace that will not be removed until all containers using it are stopped, and one non-malicious container is holding the namespace open. The malicious container is restarted, either automatically or by attacker control, repeating the process and increasing the amount of memory consumed. With a container configured to restart always, such as `podman run --restart=always`, this can result in a memory-based denial of service of the system. | | | Clone Of: |  | | | Environment: |  | | | Last Closed: |  | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=2270717#c0)  Robb Gatica    2024-03-21 14:56:42 UTC  ``` Summary: We received a report of an attack vector on containers which share an IPC namespace (definitely Podman, but likely also applicable to Kubernetes, Docker, and other container runtimes). At least two containers are configured with a shared IPC namespace and a cgroup limiting memory. One of those containers is malicious, and contains a binary which creates a large number of IPC resources in /dev/shm, and continues doing so until it is OOM killed. The malicious container is now dead, its cgroup removed, but the IPC resources it created are not; they are tied to the IPC namespace that will not be removed until all containers using it are stopped, and one non-malicious container is holding the namespace open. The malicious container is restarted (either automatically or by attacker control), repeating the process and increasing the amount of memory consumed. With a container configured to restart always (e.g. `podman run --restart=always`) this results in a memory-based denial of service of the system.  Podman Version: Version 5.0.0-dev and before   ```  [Comment 11](show_bug.cgi?id=2270717#c11)  Giuseppe Scrivano    2024-04-29 12:44:14 UTC  ``` the issue is that the allocated memory is assigned to the container cgroup that has a memory limit, if that limit is hit the kernel refuses to allocate more.  But if the container exits, the shared memory is not freed and it is still allocated to the first cgroup, that is not accessible anymore from user space (but it seems to be still referenced internally in the kernel).  When the container exits, we create a new one, that uses the same cgroup name and it also has a limit set.  In this way the container can be restarted multiple times and each restart can leak memory since the cgroup seems to not be freed internally.  I've not looked into the code, so this analysis is only based on my observations from user space, it might be completely wrong :-)  If I am not wrong, then I think the sensible thing to do in this case would be to migrate the memory allocated to the cgroup that was destroyed to another cgroup using that same IPC.  In this way from userspace we can avoid the issue by making sure each cgroup has a limit set, and that there are no leaks once a cgroup is deleted.  I think we should add "Waiman Long <llong>" to the conversation.  It seems I am not allowed to do it   ```  [Comment 12](show_bug.cgi?id=2270717#c12)  Anten Skrabec    2024-05-02 19:28:21 UTC  ``` Added llong to CC list   ```  [Comment 13](show_bug.cgi?id=2270717#c13)  Waiman Long    2024-05-08 02:25:53 UTC  ``` (In reply to Giuseppe Scrivano from [comment #11](show_bug.cgi?id=2270717#c11)) > the issue is that the allocated memory is assigned to the container cgroup > that has a memory limit, if that limit is hit the kernel refuses to allocate > more. >  > But if the container exits, the shared memory is not freed and it is still > allocated to the first cgroup, that is not accessible anymore from user > space (but it seems to be still referenced internally in the kernel). >  > When the container exits, we create a new one, that uses the same cgroup > name and it also has a limit set. >  > In this way the container can be restarted multiple times and each restart > can leak memory since the cgroup seems to not be freed internally. >  > I've not looked into the code, so this analysis is only based on my > observations from user space, it might be completely wrong :-) >  > If I am not wrong, then I think the sensible thing to do in this case would > be to migrate the memory allocated to the cgroup that was destroyed to > another cgroup using that same IPC.  In this way from userspace we can avoid > the issue by making sure each cgroup has a limit set, and that there are no > leaks once a cgroup is deleted. >  > I think we should add "Waiman Long <llong>" to the conversation.  > It seems I am not allowed to do it  There is actually upstream discussion about this specific problem. In the case of shared memory, memory ownership is assigned to the memory cgroup of the first process that uses it. References to that shared memory can be present in other memory cgroups. When the owning cgroup has exited all its processes and to be destroyed, it remained in the zombie state because of the additional references to the shared memory.  AFAIK, there was no consensus on the best way forward the last time I checked. I need to check again to see if there is progress on this issue.   ```  [Comment 17](show_bug.cgi?id=2270717#c17)  Alex    2024-07-31 10:34:31 UTC  ``` Created podman tracking bugs for this issue:  Affects: fedora-all [[bug 2302003](show_bug.cgi?id=2302003 "NEW - CVE-2024-3056 podman: containers in shared IPC namespace are vulnerable to denial of service attack [fedora-all]")]   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=2270717&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)

