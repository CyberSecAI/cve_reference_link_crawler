The provided content relates to CVE-2024-25715.

**Root Cause of Vulnerability:**
The vulnerability arises from insufficient validation of the `redirect_uri` parameter during the OAuth 2.0 and OpenID Connect authorization flows. Specifically, the code was not properly checking if the provided `redirect_uri` exactly matches one of the allowed redirect URIs configured for the client.

**Weaknesses/Vulnerabilities Present:**
- **Open Redirection:** The primary issue is the possibility of an open redirection attack. An attacker could craft a malicious `redirect_uri` that, if not properly validated, would redirect the user to an attacker-controlled website after authentication.
- **Inconsistent Redirect URI validation:** The code uses different approaches in different parts of the code for redirect URI validation.

**Impact of Exploitation:**
- **Phishing:** An attacker could redirect users to a phishing page, potentially stealing their credentials or other sensitive information.
- **Data Exfiltration:** By controlling the redirect URI, the attacker could potentially intercept authorization codes or access tokens.
- **Bypass Security Measures:** Open redirect vulnerabilities can sometimes be chained with other vulnerabilities to gain unauthorized access.

**Attack Vectors:**
- A malicious actor can manipulate the `redirect_uri` parameter during the authorization request.
- The attacker must have a valid client_id, and must be able to get the user to click the crafted malicious link.

**Required Attacker Capabilities/Position:**
- The attacker needs to be able to craft a malicious URL that includes an arbitrary `redirect_uri` parameter.
- The attacker needs a valid `client_id`.
- No special position on the network is needed.
- The attacker must convince a user to use the crafted URL.

**Details from the provided content:**
- The commit `5923938` addresses PKCE downgrade and open redirection issues by changing the `validate_code_challenge` function to receive the `oauth2_config` struct as parameter. Also changes the logic to handle the case where the client is not required to be authenticated with its password. It also changes the logic that handles the redirect to the login page, so it now returns a 403 if the `scope` parameter is missing.
- The commit `c91c015` focuses on enforcing the open redirection fix. It modifies the code to use `json_array_has_string` for redirect URI validation, ensuring that the provided `redirect_uri` exactly matches one of the allowed URIs configured for the client. It also fixes a bug where the redirect_uri was not validated, which resulted in an open redirect vulnerability.
- The fix changes the logic from the usage of `o_strcmp` within a loop to using `json_array_has_string`, this enforces that only exact matches of the redirect URI are considered valid.