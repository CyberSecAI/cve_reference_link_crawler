
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2F4nNns%2FcveAdd%2Fblob%2Fdeveloper%2Ffastcms%25E6%25A8%25A1%25E7%2589%2588%25E6%25B3%25A8%25E5%2585%25A5%2Ffastcms%2520template%2520injection%2520vulnerability.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2F4nNns%2FcveAdd%2Fblob%2Fdeveloper%2Ffastcms%25E6%25A8%25A1%25E7%2589%2588%25E6%25B3%25A8%25E5%2585%25A5%2Ffastcms%2520template%2520injection%2520vulnerability.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=4nNns%2FcveAdd)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[4nNns](/4nNns)
/
**[cveAdd](/4nNns/cveAdd)**
Public

* [Notifications](/login?return_to=%2F4nNns%2FcveAdd) You must be signed in to change notification settings
* [Fork
  1](/login?return_to=%2F4nNns%2FcveAdd)
* [Star
   0](/login?return_to=%2F4nNns%2FcveAdd)

* [Code](/4nNns/cveAdd)
* [Issues
  0](/4nNns/cveAdd/issues)
* [Pull requests
  0](/4nNns/cveAdd/pulls)
* [Actions](/4nNns/cveAdd/actions)
* [Projects
  0](/4nNns/cveAdd/projects)
* [Security](/4nNns/cveAdd/security)
* [Insights](/4nNns/cveAdd/pulse)

Additional navigation options

* [Code](/4nNns/cveAdd)
* [Issues](/4nNns/cveAdd/issues)
* [Pull requests](/4nNns/cveAdd/pulls)
* [Actions](/4nNns/cveAdd/actions)
* [Projects](/4nNns/cveAdd/projects)
* [Security](/4nNns/cveAdd/security)
* [Insights](/4nNns/cveAdd/pulse)

## Files

 developer
## Breadcrumbs

1. [cveAdd](/4nNns/cveAdd/tree/developer)
2. /[fastcms模版注入](/4nNns/cveAdd/tree/developer/fastcms%E6%A8%A1%E7%89%88%E6%B3%A8%E5%85%A5)
/
# fastcms template injection vulnerability.md

 Blame  Blame
## Latest commit

## History

[History](/4nNns/cveAdd/commits/developer/fastcms%E6%A8%A1%E7%89%88%E6%B3%A8%E5%85%A5/fastcms%20template%20injection%20vulnerability.md)47 lines (30 loc) · 2.63 KB developer
## Breadcrumbs

1. [cveAdd](/4nNns/cveAdd/tree/developer)
2. /[fastcms模版注入](/4nNns/cveAdd/tree/developer/fastcms%E6%A8%A1%E7%89%88%E6%B3%A8%E5%85%A5)
/
# fastcms template injection vulnerability.md

Top
## File metadata and controls

* Preview
* Code
* Blame

47 lines (30 loc) · 2.63 KB[Raw](https://github.com/4nNns/cveAdd/raw/refs/heads/developer/fastcms%E6%A8%A1%E7%89%88%E6%B3%A8%E5%85%A5/fastcms%20template%20injection%20vulnerability.md)
## fastcms template injection vulnerability

Fastcms is built with a complete CMS station building system
Fastcms is fully integrated into the WeChat ecosystem and is the cornerstone of all WeChat marketing plug-ins
Fastcms can be dynamically hot plugged based on jar and zip packages
Fastcms carries out plug-in development based on SpringBoot, which has strong extensibility, freeing you from bloated projects
The fastcms background management system can edit the template file, so that we can edit a template file with malicious command execution, and realize remote command execution vulnerability by accessing the front-end page.
This vulnerability can be used to execute server system commands and obtain system information.
Vulnerability address: <http://ip:8080/fastcms.html#/template/edit>
Code download address: <https://gitee.com/dianbuapp_admin/fastcms.git>
Vulnerability location: After logging into the system, the template  Edit  Access this template.

### Exploit

Log in to the background system, click Template  Edit to edit the template HTML file, such as editing index Html A malicious template file that can execute the "cat/etc/passwd" command.

[![1](/4nNns/cveAdd/raw/developer/fastcms%E6%A8%A1%E7%89%88%E6%B3%A8%E5%85%A5/pic/1.png)](/4nNns/cveAdd/blob/developer/fastcms%E6%A8%A1%E7%89%88%E6%B3%A8%E5%85%A5/pic/1.png)

After setting, you can directly access this column to directly execute commands.

[![1](/4nNns/cveAdd/raw/developer/fastcms%E6%A8%A1%E7%89%88%E6%B3%A8%E5%85%A5/pic/2.png)](/4nNns/cveAdd/blob/developer/fastcms%E6%A8%A1%E7%89%88%E6%B3%A8%E5%85%A5/pic/2.png)

Other commands can be executed by modifying the form of execution command.

### Code audit process

Track new templates and save template interfaces. File path: src/main/java/com/cms/controller/admin/TemplateController Java lines 49 and 58.

[![1](/4nNns/cveAdd/raw/developer/fastcms%E6%A8%A1%E7%89%88%E6%B3%A8%E5%85%A5/pic/6.png)](/4nNns/cveAdd/blob/developer/fastcms%E6%A8%A1%E7%89%88%E6%B3%A8%E5%85%A5/pic/6.png)

Go to the pom.xml file to determine that the template engine introduced is Freemaker.

[![1](/4nNns/cveAdd/raw/developer/fastcms%E6%A8%A1%E7%89%88%E6%B3%A8%E5%85%A5/pic/7.png)](/4nNns/cveAdd/blob/developer/fastcms%E6%A8%A1%E7%89%88%E6%B3%A8%E5%85%A5/pic/7.png)

Since it is Freemarker, let's find out in the code whether there is blacklist filtering for some sensitive functions when the template is declared, such as Execute and other methods. Found src/main/java/com/cms/utils/TemplateUtils Java analyzes whether the content of this Java class is filtered.

[![1](/4nNns/cveAdd/raw/developer/fastcms%E6%A8%A1%E7%89%88%E6%B3%A8%E5%85%A5/pic/8.png)](/4nNns/cveAdd/blob/developer/fastcms%E6%A8%A1%E7%89%88%E6%B3%A8%E5%85%A5/pic/8.png)

In the process of reading and writing, the content of the template is not filtered, so it can be determined that there is a Freemarker template injection vulnerability.
Payload is as follows:

```
<#assign value="freemarker.template.utility.Execute"?new()>${value("open -a Calculator")}
<#assign value="freemarker.template.utility.ObjectConstructor"?new()>${value("java.lang.ProcessBuilder","open -a Calculator").start()}
<#assign value="freemarker.template.utility.JythonRuntime"?new()><@value>import os;os.system("open -a Calculator")
```

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

