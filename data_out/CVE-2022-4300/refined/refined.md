The provided content describes a template injection vulnerability in Fastcms.

**Root cause of vulnerability:**
The root cause is the lack of proper sanitization or filtering of user-supplied template content before it's processed by the Freemarker template engine. This allows an attacker to inject malicious Freemarker directives into the template, which will then be executed by the server.

**Weaknesses/vulnerabilities present:**
- **Template Injection:** The core vulnerability is the ability to inject arbitrary code into a template used by the application.
- **Lack of Input Sanitization:** The application does not filter or sanitize the template content, allowing for malicious code execution.
- **Freemarker Template Engine:** The use of Freemarker without proper security considerations enables exploitation.

**Impact of exploitation:**
- **Remote Code Execution (RCE):** Successful exploitation allows the attacker to execute arbitrary system commands on the server.
- **System Information Disclosure:** The attacker can obtain sensitive system information by executing commands like `cat /etc/passwd`.
- **Full System Compromise:** The vulnerability can potentially lead to full system compromise by the attacker.

**Attack vectors:**
- The attacker needs access to the Fastcms administrative interface.
- The attacker edits template files through the admin panel.

**Required attacker capabilities/position:**
- The attacker needs to be an authenticated user with access to the template editing functionality in the Fastcms administration panel.
- The attacker needs to understand how to construct malicious payloads for the Freemarker template engine.

**More Details:**
The content provides a detailed explanation of how to identify and exploit the vulnerability, including:
- Vulnerability location: /template/edit.
- Code download address.
- Step-by-step instructions for exploitation: Log in to the background system, click Template -> Edit to edit the template HTML file, insert malicious code, then accessing the page.
- Code audit process: Tracking template creation and saving to determine the lack of sanitization, and identifying freemarker as the template engine.
- Sample payloads: Demonstrates how to use Freemarker's `Execute`, `ObjectConstructor`, and `JythonRuntime` to execute system commands.