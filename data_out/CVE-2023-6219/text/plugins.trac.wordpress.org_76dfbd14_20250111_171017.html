

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3001484%2Fbookingpress-appointment-booking%2Ftrunk%2Fcore%2Fclasses%2Fclass.bookingpress_settings.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/2988921/bookingpress-appointment-booking/trunk/core/classes/class.bookingpress_settings.php "Changeset 2988921 for bookingpress-appointment-booking/trunk/core/classes/class.bookingpress_settings.php")
* [Next Change](/changeset/3007195/bookingpress-appointment-booking/trunk/core/classes/class.bookingpress_settings.php "Changeset 3007195 for bookingpress-appointment-booking/trunk/core/classes/class.bookingpress_settings.php") →

---

# Changeset [3001484](/changeset/3001484 "Show full changeset") for [bookingpress-appointment-booking/trunk/core/classes/class.bookingpress\_settings.php](/browser/bookingpress-appointment-booking/trunk/core/classes/class.bookingpress_settings.php?rev=3001484 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
11/25/2023 08:58:53 AM
([14 months](/timeline?from=2023-11-25T08%3A58%3A53Z&precision=second "See timeline at 11/25/2023 08:58:53 AM") ago)

Author:
reputeinfosystems
Message:
# 1.0.77

* Fixed: Reply to Name & From Name displays wrong characters in email with different languages with Google/Gmail APIs
* Fixed: Front-end Booking Calendar translation not proper in some language(s)
* Update: Georgian language translation update for the Booking Calendar
* Other minor bug fixes

File:

1 edited

* [bookingpress-appointment-booking/trunk/core/classes/class.bookingpress\_settings.php](/browser/bookingpress-appointment-booking/trunk/core/classes/class.bookingpress_settings.php?rev=3001484 "Show entry in browser")
  (modified)
  ([2 diffs](#file0 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [bookingpress-appointment-booking/trunk/core/classes/class.bookingpress\_settings.php](/changeset/3001484/bookingpress-appointment-booking/trunk/core/classes/class.bookingpress_settings.php "Show the changeset 3001484 restricted to bookingpress-appointment-booking/trunk/core/classes/class.bookingpress_settings.php")

  | [r2988921](/browser/bookingpress-appointment-booking/trunk/core/classes/class.bookingpress_settings.php?rev=2988921#L1355 "Show revision 2988921 of this file in browser") | [r3001484](/browser/bookingpress-appointment-booking/trunk/core/classes/class.bookingpress_settings.php?rev=3001484#L1355 "Show revision 3001484 of this file in browser") |  |
  | --- | --- | --- |
  | 1355 | 1355 | $bookingpress\_fileupload\_obj->allowed\_ext        = array(); |
  | 1356 | 1356 |  |
  | 1357 |  | $file\_name                = current\_time('timestamp') . '\_' . ~~isset($\_FILES['file']['name']) ? sanitize\_file\_name($\_FILES['file']['name']) : ''~~; |
  |  | 1357 | $file\_name                = current\_time('timestamp') . '\_' . (isset($\_FILES['file']['name']) ? sanitize\_file\_name($\_FILES['file']['name']) : ''); |
  | 1358 | 1358 | $upload\_dir               = BOOKINGPRESS\_TMP\_IMAGES\_DIR . '/'; |
  | 1359 | 1359 | $upload\_url               = BOOKINGPRESS\_TMP\_IMAGES\_URL . '/'; |
  | […](/browser/bookingpress-appointment-booking/trunk/core/classes/class.bookingpress_settings.php?rev=2988921#L2906) | […](/browser/bookingpress-appointment-booking/trunk/core/classes/class.bookingpress_settings.php?rev=3001484#L2906) |  |
  | 2906 | 2906 | foreach ( $bookingpress\_save\_settings\_data as $bookingpress\_setting\_key => $bookingpress\_setting\_val ) { |
  | 2907 | 2907 | if ($bookingpress\_setting\_key == 'company\_avatar\_url' && ! empty($bookingpress\_setting\_val) ) { |
  | 2908 |  | $bookingpress\_avatar\_url        = $bookingpress\_setting\_val; |
  | 2909 |  | $bookingpress\_upload\_image\_name = isset($\_POST['company\_avatar\_img']) ? sanitize\_file\_name($\_POST['company\_avatar\_img']) : ''; // phpcs:ignore WordPress.Security.NonceVerification |
  | 2910 |  |  |
  | 2911 |  | $upload\_dir                 = BOOKINGPRESS\_UPLOAD\_DIR . '/'; |
  | 2912 |  | $bookingpress\_new\_file\_name = current\_time('timestamp') . '\_' . $bookingpress\_upload\_image\_name; |
  | 2913 |  | $upload\_path                = $upload\_dir . $bookingpress\_new\_file\_name; |
  | 2914 |  |  |
  | 2915 |  | $bookingpress\_upload\_res = new bookingpress\_fileupload\_class( $bookingpress\_avatar\_url, true ); |
  | 2916 |  |  |
  | 2917 |  | $bookingpress\_upload\_res->bookingpress\_process\_upload( $upload\_path ); |
  | 2918 |  |  |
  | 2919 |  | $bookingpress\_setting\_val = BOOKINGPRESS\_UPLOAD\_URL . '/' . $bookingpress\_new\_file\_name; |
  | 2920 |  |  |
  | 2921 |  | $bookingpress\_file\_name\_arr = explode('/', $bookingpress\_avatar\_url); |
  | 2922 |  | $bookingpress\_file\_name     = $bookingpress\_file\_name\_arr[ count($bookingpress\_file\_name\_arr) - 1 ]; |
  | 2923 |  | if( file\_exists( BOOKINGPRESS\_TMP\_IMAGES\_DIR . '/' . $bookingpress\_file\_name ) ){ |
  | 2924 |  | @unlink(BOOKINGPRESS\_TMP\_IMAGES\_DIR . '/' . $bookingpress\_file\_name); |
  | 2925 |  | } |
  |  | 2908 |  |
  |  | 2909 | $bookingpress\_avatar\_url        = $bookingpress\_setting\_val; |
  |  | 2910 | $bookingpress\_upload\_image\_name = isset($\_POST['company\_avatar\_img']) ? sanitize\_file\_name($\_POST['company\_avatar\_img']) : ''; // phpcs:ignore WordPress.Security.NonceVerification |
  |  | 2911 |  |
  |  | 2912 | $upload\_dir                 = BOOKINGPRESS\_UPLOAD\_DIR . '/'; |
  |  | 2913 | $bookingpress\_new\_file\_name = current\_time('timestamp') . '\_' . $bookingpress\_upload\_image\_name; |
  |  | 2914 | $upload\_path                = $upload\_dir . $bookingpress\_new\_file\_name; |
  |  | 2915 |  |
  |  | 2916 | $bookingpress\_upload\_res = new bookingpress\_fileupload\_class( $bookingpress\_avatar\_url, true ); |
  |  | 2917 | $bookingpress\_upload\_res->check\_cap          = true; |
  |  | 2918 | $bookingpress\_upload\_res->check\_nonce        = true; |
  |  | 2919 | $bookingpress\_upload\_res->nonce\_data         = isset($\_REQUEST['\_wpnonce']) ? sanitize\_text\_field($\_REQUEST['\_wpnonce']) : ''; |
  |  | 2920 | $bookingpress\_upload\_res->nonce\_action       = 'bpa\_wp\_nonce'; |
  |  | 2921 | $bookingpress\_upload\_res->check\_only\_image   = true; |
  |  | 2922 | $bookingpress\_upload\_res->check\_specific\_ext = false; |
  |  | 2923 | $bookingpress\_upload\_res->allowed\_ext        = array(); |
  |  | 2924 | $upload\_response = $bookingpress\_upload\_res->bookingpress\_process\_upload( $upload\_path ); |
  |  | 2925 |  |
  |  | 2926 | if( true == $upload\_response ){ |
  |  | 2927 | $bookingpress\_setting\_val = BOOKINGPRESS\_UPLOAD\_URL . '/' . $bookingpress\_new\_file\_name; |
  |  | 2928 |  |
  |  | 2929 | $bookingpress\_file\_name\_arr = explode('/', $bookingpress\_avatar\_url); |
  |  | 2930 | $bookingpress\_file\_name     = $bookingpress\_file\_name\_arr[ count($bookingpress\_file\_name\_arr) - 1 ]; |
  |  | 2931 | if( file\_exists( BOOKINGPRESS\_TMP\_IMAGES\_DIR . '/' . $bookingpress\_file\_name ) ){ |
  |  | 2932 | @unlink(BOOKINGPRESS\_TMP\_IMAGES\_DIR . '/' . $bookingpress\_file\_name); |
  |  | 2933 | } |
  |  | 2934 | } else { |
  |  | 2935 | continue; |
  |  | 2936 | } |
  | 2926 | 2937 | } |
  | 2927 | 2938 |  |
  | 2928 |  | $bookingpress\_res = $BookingPress->bookingpress\_update\_settings($bookingpress\_setting\_key, $bookingpress\_setting\_type, $bookingpress\_setting\_val); |
  | 2929 |  | array\_push($bookingpress\_response\_arr, $bookingpress\_res); |
  |  | 2939 | $bpa\_prevent\_setting\_update = apply\_filters( 'bookingpress\_restrict\_saving\_settings\_data', false, $bookingpress\_setting\_key ); |
  |  | 2940 |  |
  |  | 2941 | if( false == $bpa\_prevent\_setting\_update ){ |
  |  | 2942 | $bookingpress\_res = $BookingPress->bookingpress\_update\_settings($bookingpress\_setting\_key, $bookingpress\_setting\_type, $bookingpress\_setting\_val); |
  |  | 2943 | array\_push($bookingpress\_response\_arr, $bookingpress\_res); |
  |  | 2944 | } |
  | 2930 | 2945 | } |
  | 2931 | 2946 |  |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3001484)
* [Zip Archive](?format=zip&new=3001484)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

