```
{
  "CVE-2024-42472": {
    "Description": "A vulnerability in Flatpak allows a malicious or compromised Flatpak app using persistent directories to read and write files in locations it would not normally have access to. When `persistent=subdir` is used, the application sees an empty home directory with a writeable subdirectory `subdir`. This directory is a bind mount to `~/.var/app/$APPID/subdir`. If the source directory is replaced by a symlink, then the next time the app is started, the bind mount will follow the symlink and mount whatever it points to into the sandbox.",
    "Root cause": "The vulnerability arises from the fact that Flatpak did not properly validate the target of the bind mount for persistent directories, allowing a symlink to be placed there, leading to a sandbox escape.",
    "Weaknesses": [
      "Improper handling of symbolic links in persistent directory mounts.",
       "Time-of-check/time-of-use race condition when mounting persistent directories"
    ],
    "Impact": "A malicious or compromised Flatpak application can gain read and write access to files outside of its sandbox, leading to a compromise of data integrity and confidentiality. For example, an application could gain access to sensitive data like SSH keys, even if it is not designed to have such access.",
    "Attack vectors": "An attacker can exploit this vulnerability by replacing the persistent directory with a symbolic link that points to a sensitive location on the host filesystem. When the application is started, the bind mount will follow the symlink, granting the application access to the targeted directory.",
    "Required attacker capabilities/position": "The attacker needs to have the ability to modify the application's persistent storage directory, which is typically located within the user's home directory. This could be achieved if the application itself is malicious or if the application's persistent storage has been compromised."
  }
}
```