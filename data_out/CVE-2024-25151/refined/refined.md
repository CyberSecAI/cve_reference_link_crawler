**Root cause of vulnerability:**

The Calendar module in Liferay Portal and Liferay DXP does not properly sanitize user-supplied data within the default notification email template. Specifically, the title of a calendar event and a user's name are not escaped before being included in the email.

**Weaknesses/vulnerabilities present:**

*   **Cross-Site Scripting (XSS):** The lack of input sanitization allows attackers to inject arbitrary web scripts into the notification emails.
*   **Content Spoofing:** By injecting HTML, attackers can potentially modify the appearance of the email content.

**Impact of exploitation:**

*   Depending on the mail client's capabilities, a successful attack can lead to content spoofing, where the email appears to be legitimate but is actually malicious.
*   XSS attacks are possible if the mail client renders HTML and executes scripts. This could potentially be used to steal user data or perform malicious actions on behalf of the user.

**Attack vectors:**

*   The attacker injects malicious code into a calendar event's title or their own user name.
*   When a notification email is generated by the calendar module (triggered, for example, by a new event or a change to an event), the malicious payload is included in the email.
*   The victim receives the email, and if their mail client processes the HTML content, the malicious script or HTML payload is executed.

**Required attacker capabilities/position:**

*   The attacker must be an authenticated user within the Liferay Portal or DXP instance.
*   The attacker needs the ability to create or modify calendar events.
*   The attacker needs the ability to modify their own user name, if that vector is chosen.