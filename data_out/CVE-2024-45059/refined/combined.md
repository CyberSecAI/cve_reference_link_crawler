=== Content from portswigger.net_3c5b5654_20250111_071447.html ===


[Login](/users)

Products

Solutions

[Research](/research)
[Academy](/web-security)
Support

Company

[Customers](/customers)
[About](/about)
[Blog](/blog)
[Careers](/careers)
[Legal](/legal)
[Contact](/contact)
[Resellers](/support/reseller-faqs)

[My account](/users/youraccount)
[Customers](/customers)
[About](/about)
[Blog](/blog)
[Careers](/careers)
[Legal](/legal)
[Contact](/contact)
[Resellers](/support/reseller-faqs)
[![Burp Suite Enterprise Edition](/content/images/svg/icons/enterprise.svg)
**Burp Suite Enterprise Edition**
The enterprise-enabled dynamic web vulnerability scanner.](/burp/enterprise)
[![Burp Suite Professional](/content/images/svg/icons/professional.svg)
**Burp Suite Professional**
The world's #1 web penetration testing toolkit.](/burp/pro)
[![Burp Suite Community Edition](/content/images/svg/icons/community.svg)
**Burp Suite Community Edition**
The best manual tools to start web security testing.](/burp/communitydownload)
[![Dastardly, from Burp Suite](/mega-nav/images/dastardly.svg)
**Dastardly, from Burp Suite**
Free, lightweight web application security scanning for CI/CD.](/burp/dastardly)
[View all product editions](/burp)

[**Burp Scanner**

Burp Suite's web vulnerability scanner

![Burp Suite's web vulnerability scanner'](/mega-nav/images/burp-suite-scanner.jpg)](/burp/vulnerability-scanner)

[**Attack surface visibility**
Improve security posture, prioritize manual testing, free up time.](/solutions/attack-surface-visibility)
[**CI-driven scanning**
More proactive security - find and fix vulnerabilities earlier.](/solutions/ci-driven-scanning)
[**Application security testing**
See how our software enables the world to secure the web.](/solutions)
[**DevSecOps**
Catch critical bugs; ship more secure software, more quickly.](/solutions/devsecops)
[**Penetration testing**
Accelerate penetration testing - find more bugs, more quickly.](/solutions/penetration-testing)
[**Automated scanning**
Scale dynamic scanning. Reduce risk. Save time/money.](/solutions/automated-security-testing)
[**Bug bounty hunting**
Level up your hacking and earn more bug bounties.](/solutions/bug-bounty-hunting)
[**Compliance**
Enhance security monitoring to comply with confidence.](/solutions/compliance)

[View all solutions](/solutions)

[**Product comparison**

What's the difference between Pro and Enterprise Edition?

![Burp Suite Professional vs Burp Suite Enterprise Edition](/mega-nav/images/burp-suite.jpg)](/burp/enterprise/resources/enterprise-edition-vs-professional)

[**Support Center**
Get help and advice from our experts on all things Burp.](/support)
[**Documentation**
Tutorials and guides for Burp Suite.](/burp/documentation)
[**Get Started - Professional**
Get started with Burp Suite Professional.](/burp/documentation/desktop/getting-started)
[**Get Started - Enterprise**
Get started with Burp Suite Enterprise Edition.](/burp/documentation/enterprise/getting-started)
[**User Forum**
Get your questions answered in the User Forum.](https://forum.portswigger.net/)
[**Downloads**
Download the latest version of Burp Suite.](/burp/releases)

[Visit the Support Center](/support)

[**Downloads**

Download the latest version of Burp Suite.

![The latest version of Burp Suite software for download](/mega-nav/images/latest-burp-suite-software-download.jpg)](/burp/releases)

Academy home

* [Dashboard](https://portswigger.net/web-security/index.html)
* [Learning paths](https://portswigger.net/web-security/learning-paths)
* Latest topics

  [Web cache deception](/web-security/web-cache-deception)
  [Web LLM attacks](/web-security/llm-attacks)
  [API testing](/web-security/api-testing)
  [NoSQL injection](/web-security/nosql-injection)
  [Race conditions](/web-security/race-conditions)
  [View all topics](/web-security/all-topics)
* All content

  [All labs](/web-security/all-labs)
  [All topics](/web-security/all-topics)
  [Mystery labs](/web-security/mystery-lab-challenge)
* Hall of Fame

  [Leaderboard](https://portswigger.net/web-security/hall-of-fame)
  [Interview - Kamil Vavra](https://portswigger.net/web-security/getting-started/kamil-vavra/index.html)
  [Interview - Johnny Villarreal](https://portswigger.net/web-security/getting-started/johnny-villarreal/index.html)
  [Interview - Andres Rauschecker](https://portswigger.net/web-security/getting-started/andres-rauschecker/index.html)
* [Get started](https://portswigger.net/web-security/getting-started/index.html)
* Get certified

  [Get certified](https://portswigger.net/web-security/certification/index.html)
  [How to prepare](https://portswigger.net/web-security/certification/how-to-prepare/index.html)
  [How it works](https://portswigger.net/web-security/certification/how-it-works/index.html)
  [Practice exam](https://portswigger.net/web-security/certification/practice-exam/index.html)
  [Exam hints and guidance](https://portswigger.net/web-security/certification/exam-hints-and-guidance/index.html)
  [What the exam involves](https://portswigger.net/web-security/certification/how-it-works/index.html#what-the-exam-involves)
  [FAQs](https://portswigger.net/web-security/certification/frequently-asked-questions/index.html)
  [Validate your certification](https://portswigger.net/web-security/certification#validate-your-certification)

[Back to all topics](/web-security/all-topics)

### SQL injection

* [What is SQL injection?](/web-security/sql-injection#what-is-sql-injection-sqli)
* [What is the impact of SQL injection?](/web-security/sql-injection#what-is-the-impact-of-a-successful-sql-injection-attack)
* [Detecting SQL injection vulnerabilities](/web-security/sql-injection#how-to-detect-sql-injection-vulnerabilities)

  + [In different parts of the query](/web-security/sql-injection#sql-injection-in-different-parts-of-the-query)
  + [In different contexts](/web-security/sql-injection#sql-injection-in-different-contexts)
* [Examples of SQL injection](/web-security/sql-injection#sql-injection-examples)

  + [Retrieving hidden data](/web-security/sql-injection#retrieving-hidden-data)
  + [Subverting application logic](/web-security/sql-injection#subverting-application-logic)
  + [Retrieving data from other tables](/web-security/sql-injection#retrieving-data-from-other-database-tables)
  + [Examining the database](/web-security/sql-injection#examining-the-database)
  + [Blind SQL injection](/web-security/sql-injection#blind-sql-injection-vulnerabilities)
  + [Second-order SQL injection](/web-security/sql-injection#second-order-sql-injection)
* [Examining the database](/web-security/sql-injection/examining-the-database)

  + [Querying the type and version](/web-security/sql-injection/examining-the-database#querying-the-database-type-and-version)
  + [Listing the contents](/web-security/sql-injection/examining-the-database#listing-the-contents-of-the-database)
* [UNION attacks](/web-security/sql-injection/union-attacks)

  + [Determining the number of columns](/web-security/sql-injection/union-attacks#determining-the-number-of-columns-required)
  + [Finding columns with a useful data type](/web-security/sql-injection/union-attacks#finding-columns-with-a-useful-data-type)
  + [Retrieving interesting data](/web-security/sql-injection/union-attacks#using-a-sql-injection-union-attack-to-retrieve-interesting-data)
  + [Retrieving multiple values in a single column](/web-security/sql-injection/union-attacks#retrieving-multiple-values-within-a-single-column)
* [Blind SQL injection](/web-security/sql-injection/blind)

  + [What is blind SQL injection?](/web-security/sql-injection/blind#what-is-blind-sql-injection)
  + [Triggering conditional responses](/web-security/sql-injection/blind#exploiting-blind-sql-injection-by-triggering-conditional-responses)
  + [Error-based SQL injection](/web-security/sql-injection/blind#error-based-sql-injection)

    - [Inferring information using conditional errors](/web-security/sql-injection/blind#exploiting-blind-sql-injection-by-triggering-conditional-errors)
    - [Extracting data via verbose error messages](/web-security/sql-injection/blind#extracting-sensitive-data-via-verbose-sql-error-messages)
  + [Triggering time delays](/web-security/sql-injection/blind#exploiting-blind-sql-injection-by-triggering-time-delays)
  + [Out-of-band (OAST) techniques](/web-security/sql-injection/blind#exploiting-blind-sql-injection-using-out-of-band-oast-techniques)
  + [Preventing blind SQL injection](/web-security/sql-injection/blind#how-to-prevent-blind-sql-injection-attacks)
* [How to prevent SQL injection](/web-security/sql-injection#how-to-prevent-sql-injection)
* [SQL injection cheat sheet](/web-security/sql-injection/cheat-sheet)
* [View all SQL injection labs](/web-security/all-labs#sql-injection)

* [Web Security Academy](/web-security)
* [SQL injection](/web-security/sql-injection)

# SQL injection

In this section, we explain:

* What SQL injection (SQLi) is.
* How to find and exploit different types of SQLi vulnerabilities.
* How to prevent SQLi.

![SQL injection](/web-security/images/sql-injection.svg)
#### Labs

If you're familiar with the basic concepts behind SQLi vulnerabilities and want to practice exploiting them on some realistic, deliberately vulnerable targets, you can access labs in this topic from the link below.

* [View all SQL injection labs](/web-security/all-labs#sql-injection)
## What is SQL injection (SQLi)?

SQL injection (SQLi) is a web security vulnerability that allows an attacker to interfere with the queries that an application makes to its database. This can allow an attacker to view data that they are not normally able to retrieve. This might include data that belongs to other users, or any other data that the application can access. In many cases, an attacker can modify or delete this data, causing persistent changes to the application's content or behavior.

In some situations, an attacker can escalate a SQL injection attack to compromise the underlying server or other back-end infrastructure. It can also enable them to perform denial-of-service attacks.

## What is the impact of a successful SQL injection attack?

A successful SQL injection attack can result in unauthorized access to sensitive data, such as:

* Passwords.
* Credit card details.
* Personal user information.

SQL injection attacks have been used in many high-profile data breaches over the years. These have caused reputational damage and regulatory fines. In some cases, an attacker can obtain a persistent backdoor into an organization's systems, leading to a long-term compromise that can go unnoticed for an extended period.

## How to detect SQL injection vulnerabilities

You can detect SQL injection manually using a systematic set of tests against every entry point in the application. To do this, you would typically submit:

* The single quote character `'` and look for errors or other anomalies.
* Some SQL-specific syntax that evaluates to the base (original) value of the entry point, and to a different value, and look for systematic differences in the application responses.
* Boolean conditions such as `OR 1=1` and `OR 1=2`, and look for differences in the application's responses.
* Payloads designed to trigger time delays when executed within a SQL query, and look for differences in the time taken to respond.
* OAST payloads designed to trigger an out-of-band network interaction when executed within a SQL query, and monitor any resulting interactions.

Alternatively, you can find the majority of SQL injection vulnerabilities quickly and reliably using Burp Scanner.

## SQL injection in different parts of the query

Most SQL injection vulnerabilities occur within the `WHERE` clause of a `SELECT` query. Most experienced testers are familiar with this type of SQL injection.

However, SQL injection vulnerabilities can occur at any location within the query, and within different query types. Some other common locations where SQL injection arises are:

* In `UPDATE` statements, within the updated values or the `WHERE` clause.
* In `INSERT` statements, within the inserted values.
* In `SELECT` statements, within the table or column name.
* In `SELECT` statements, within the `ORDER BY` clause.

## SQL injection examples

There are lots of SQL injection vulnerabilities, attacks, and techniques, that occur in different situations. Some common SQL injection examples include:

* [Retrieving hidden data](/web-security/sql-injection#retrieving-hidden-data), where you can modify a SQL query to return additional results.
* [Subverting application logic](/web-security/sql-injection#subverting-application-logic), where you can change a query to interfere with the application's logic.
* [UNION attacks](/web-security/sql-injection/union-attacks), where you can retrieve data from different database tables.
* [Blind SQL injection](/web-security/sql-injection/blind), where the results of a query you control are not returned in the application's responses.

## Retrieving hidden data

Imagine a shopping application that displays products in different categories. When the user clicks on the **Gifts** category, their browser requests the URL:

`https://insecure-website.com/products?category=Gifts`

This causes the application to make a SQL query to retrieve details of the relevant products from the database:

`SELECT * FROM products WHERE category = 'Gifts' AND released = 1`

This SQL query asks the database to return:

* all details (`*`)
* from the `products` table
* where the `category` is `Gifts`
* and `released` is `1`.

The restriction `released = 1` is being used to hide products that are not released. We could assume for unreleased products, `released = 0`.

The application doesn't implement any defenses against SQL injection attacks. This means an attacker can construct the following attack, for example:

`https://insecure-website.com/products?category=Gifts'--`

This results in the SQL query:

`SELECT * FROM products WHERE category = 'Gifts'--' AND released = 1`

Crucially, note that `--` is a comment indicator in SQL. This means that the rest of the query is interpreted as a comment, effectively removing it. In this example, this means the query no longer includes `AND released = 1`. As a result, all products are displayed, including those that are not yet released.

You can use a similar attack to cause the application to display all the products in any category, including categories that they don't know about:

`https://insecure-website.com/products?category=Gifts'+OR+1=1--`

This results in the SQL query:

`SELECT * FROM products WHERE category = 'Gifts' OR 1=1--' AND released = 1`

The modified query returns all items where either the `category` is `Gifts`, or `1` is equal to `1`. As `1=1` is always true, the query returns all items.

#### Warning

Take care when injecting the condition `OR 1=1` into a SQL query. Even if it appears to be harmless in the context you're injecting into, it's common for applications to use data from a single request in multiple different queries. If your condition reaches an `UPDATE` or `DELETE` statement, for example, it can result in an accidental loss of data.

LAB
APPRENTICE
[SQL injection vulnerability in WHERE clause allowing retrieval of hidden data](/web-security/sql-injection/lab-retrieve-hidden-data)

## Subverting application logic

Imagine an application that lets users log in with a username and password. If a user submits the username `wiener` and the password `bluecheese`, the application checks the credentials by performing the following SQL query:

`SELECT * FROM users WHERE username = 'wiener' AND password = 'bluecheese'`

If the query returns the details of a user, then the login is successful. Otherwise, it is rejected.

In this case, an attacker can log in as any user without the need for a password. They can do this using the SQL comment sequence `--` to remove the password check from the `WHERE` clause of the query. For example, submitting the username `administrator'--` and a blank password results in the following query:

`SELECT * FROM users WHERE username = 'administrator'--' AND password = ''`

This query returns the user whose `username` is `administrator` and successfully logs the attacker in as that user.

LAB
APPRENTICE
[SQL injection vulnerability allowing login bypass](/web-security/sql-injection/lab-login-bypass)

## Retrieving data from other database tables

In cases where the application responds with the results of a SQL query, an attacker can use a SQL injection vulnerability to retrieve data from other tables within the database. You can use the `UNION` keyword to execute an additional `SELECT` query and append the results to the original query.

For example, if an application executes the following query containing the user input `Gifts`:

`SELECT name, description FROM products WHERE category = 'Gifts'`

An attacker can submit the input:

`' UNION SELECT username, password FROM users--`

This causes the application to return all usernames and passwords along with the names and descriptions of products.

#### Read more

* [SQL injection UNION attacks](/web-security/sql-injection/union-attacks)
## Blind SQL injection vulnerabilities

Many instances of SQL injection are blind vulnerabilities. This means that the application does not return the results of the SQL query or the details of any database errors within its responses. Blind vulnerabilities can still be exploited to access unauthorized data, but the techniques involved are generally more complicated and difficult to perform.

The following techniques can be used to exploit blind SQL injection vulnerabilities, depending on the nature of the vulnerability and the database involved:

* You can change the logic of the query to trigger a detectable difference in the application's response depending on the truth of a single condition. This might involve injecting a new condition into some Boolean logic, or conditionally triggering an error such as a divide-by-zero.
* You can conditionally trigger a time delay in the processing of the query. This enables you to infer the truth of the condition based on the time that the application takes to respond.
* You can trigger an out-of-band network interaction, using OAST techniques. This technique is extremely powerful and works in situations where the other techniques do not. Often, you can directly exfiltrate data via the out-of-band channel. For example, you can place the data into a DNS lookup for a domain that you control.

#### Read more

* [Blind SQL injection](/web-security/sql-injection/blind)
## Second-order SQL injection

First-order SQL injection occurs when the application processes user input from an HTTP request and incorporates the input into a SQL query in an unsafe way.

Second-order SQL injection occurs when the application takes user input from an HTTP request and stores it for future use. This is usually done by placing the input into a database, but no vulnerability occurs at the point where the data is stored. Later, when handling a different HTTP request, the application retrieves the stored data and incorporates it into a SQL query in an unsafe way. For this reason, second-order SQL injection is also known as stored SQL injection.

![Second-order SQL injection](/web-security/images/second-order-sql-injection.svg)

Second-order SQL injection often occurs in situations where developers are aware of SQL injection vulnerabilities, and so safely handle the initial placement of the input into the database. When the data is later processed, it is deemed to be safe, since it was previously placed into the database safely. At this point, the data is handled in an unsafe way, because the developer wrongly deems it to be trusted.

## Examining the database

Some core features of the SQL language are implemented in the same way across popular database platforms, and so many ways of detecting and exploiting SQL injection vulnerabilities work identically on different types of database.

However, there are also many differences between common databases. These mean that some techniques for detecting and exploiting SQL injection work differently on different platforms. For example:

* Syntax for string concatenation.
* Comments.
* Batched (or stacked) queries.
* Platform-specific APIs.
* Error messages.

#### Read more

[SQL injection cheat sheet](/web-security/sql-injection/cheat-sheet)

After you identify a SQL injection vulnerability, it's often useful to obtain information about the database. This information can help you to exploit the vulnerability.

You can query the version details for the database. Different methods work for different database types. This means that if you find a particular method that works, you can infer the database type. For example, on Oracle you can execute:

`SELECT * FROM v$version`

You can also identify what database tables exist, and the columns they contain. For example, on most databases you can execute the following query to list the tables:

`SELECT * FROM information_schema.tables`
#### Read more

* [Examining the database in SQL injection attacks](/web-security/sql-injection/examining-the-database)
* [SQL injection cheat sheet](/web-security/sql-injection/cheat-sheet)
## SQL injection in different contexts

In the previous labs, you used the query string to inject your malicious SQL payload. However, you can perform SQL injection attacks using any controllable input that is processed as a SQL query by the application. For example, some websites take input in JSON or XML format and use this to query the database.

These different formats may provide different ways for you to [obfuscate attacks](/web-security/essential-skills/obfuscating-attacks-using-encodings#obfuscation-via-xml-encoding) that are otherwise blocked due to WAFs and other defense mechanisms. Weak implementations often look for common SQL injection keywords within the request, so you may be able to bypass these filters by encoding or escaping characters in the prohibited keywords. For example, the following XML-based SQL injection uses an XML escape sequence to encode the `S` character in `SELECT`:

`<stockCheck>
<productId>123</productId>
<storeId>999 &#x53;ELECT * FROM information_schema.tables</storeId>
</stockCheck>`

This will be decoded server-side before being passed to the SQL interpreter.

LAB
PRACTITIONER
[SQL injection with filter bypass via XML encoding](/web-security/sql-injection/lab-sql-injection-with-filter-bypass-via-xml-encoding)

## How to prevent SQL injection

You can prevent most instances of SQL injection using parameterized queries instead of string concatenation within the query. These parameterized queries are also know as "prepared statements".

The following code is vulnerable to SQL injection because the user input is concatenated directly into the query:

`String query = "SELECT * FROM products WHERE category = '"+ input + "'";
Statement statement = connection.createStatement();
ResultSet resultSet = statement.executeQuery(query);`

You can rewrite this code in a way that prevents the user input from interfering with the query structure:

`PreparedStatement statement = connection.prepareStatement("SELECT * FROM products WHERE category = ?");
statement.setString(1, input);
ResultSet resultSet = statement.executeQuery();`

You can use parameterized queries for any situation where untrusted input appears as data within the query, including the `WHERE` clause and values in an `INSERT` or `UPDATE` statement. They can't be used to handle untrusted input in other parts of the query, such as table or column names, or the `ORDER BY` clause. Application functionality that places untrusted data into these parts of the query needs to take a different approach, such as:

* Whitelisting permitted input values.
* Using different logic to deliver the required behavior.

For a parameterized query to be effective in preventing SQL injection, the string that is used in the query must always be a hard-coded constant. It must never contain any variable data from any origin. Do not be tempted to decide case-by-case whether an item of data is trusted, and continue using string concatenation within the query for cases that are considered safe. It's easy to make mistakes about the possible origin of data, or for changes in other code to taint trusted data.

#### Read more

* [Find SQL injection vulnerabilities using Burp Suite's web vulnerability scanner](/burp/vulnerability-scanner)

## Register for free to track your learning progress

![The benefits of working through PortSwigger's Web Security Academy](/content/images/vulnerabilities/web-security-academy-footer.png)

* Practise exploiting vulnerabilities on realistic targets.
* Record your progression from Apprentice to Expert.
* See where you rank in our Hall of Fame.

REGISTER

As we use reCAPTCHA, you need to be able to access Google's servers to use this function.

Already got an account?
[Login here](https://portswigger.net/users)

Want to track your progress and have a more personalized learning experience? (It's free!)

[Sign up](/users/register)
[Login](/users?returnurl=%2fweb-security%2fsql-injection)

![Try Burp Suite for Free](/content/images/logos/burp-suite-icon.svg)
#### Find SQL injection vulnerabilities using Burp Suite

[Try for free](https://portswigger.net/burp)

Burp Suite

[Web vulnerability scanner](/burp/vulnerability-scanner)
[Burp Suite Editions](/burp)
[Release Notes](/burp/releases)

Vulnerabilities

[Cross-site scripting (XSS)](/web-security/cross-site-scripting)
[SQL injection](/web-security/sql-injection)
[Cross-site request forgery](/web-security/csrf)
[XML external entity injection](/web-security/xxe)
[Directory traversal](/web-security/file-path-traversal)
[Server-side request forgery](/web-security/ssrf)

Customers

[Organizations](/organizations)
[Testers](/testers)
[Developers](/developers)

Company

[About](/about)
[Careers](/careers)
[Contact](/about/contact)
[Legal](/legal)
[Privacy Notice](/privacy)

Insights

[Web Security Academy](/web-security)
[Blog](/blog)
[Research](/research)

[![PortSwigger Logo](/content/images/logos/portswigger-logo.svg)](/)
 [Follow us](https://twitter.com/Burp_Suite)

© 2025 PortSwigger Ltd.



=== Content from cheatsheetseries.owasp.org_d8877584_20250111_071446.html ===


[Skip to content](#sql-injection-prevention-cheat-sheet)

[![logo](../assets/OWASP_Logo.svg)](../index.html "OWASP Cheat Sheet Series")

OWASP Cheat Sheet Series

SQL Injection Prevention

Initializing search

[OWASP/CheatSheetSeries](https://github.com/OWASP/CheatSheetSeries "Go to repository")

[![logo](../assets/OWASP_Logo.svg)](../index.html "OWASP Cheat Sheet Series")
OWASP Cheat Sheet Series

[OWASP/CheatSheetSeries](https://github.com/OWASP/CheatSheetSeries "Go to repository")

* [Introduction](../index.html)
* [Index Alphabetical](../Glossary.html)
* [Index ASVS](../IndexASVS.html)
* [Index MASVS](../IndexMASVS.html)
* [Index Proactive Controls](../IndexProactiveControls.html)
* [Index Top 10](../IndexTopTen.html)
* Cheatsheets

  Cheatsheets
  + [AJAX Security](AJAX_Security_Cheat_Sheet.html)
  + [Abuse Case](Abuse_Case_Cheat_Sheet.html)
  + [Access Control](Access_Control_Cheat_Sheet.html)
  + [Attack Surface Analysis](Attack_Surface_Analysis_Cheat_Sheet.html)
  + [Authentication](Authentication_Cheat_Sheet.html)
  + [Authorization](Authorization_Cheat_Sheet.html)
  + [Authorization Testing Automation](Authorization_Testing_Automation_Cheat_Sheet.html)
  + [Bean Validation](Bean_Validation_Cheat_Sheet.html)
  + [Browser Extension Vulnerabilities](Browser_Extension_Vulnerabilities_Cheat_Sheet.html)
  + [C-Based Toolchain Hardening](C-Based_Toolchain_Hardening_Cheat_Sheet.html)
  + [CI CD Security](CI_CD_Security_Cheat_Sheet.html)
  + [Choosing and Using Security Questions](Choosing_and_Using_Security_Questions_Cheat_Sheet.html)
  + [Clickjacking Defense](Clickjacking_Defense_Cheat_Sheet.html)
  + [Content Security Policy](Content_Security_Policy_Cheat_Sheet.html)
  + [Credential Stuffing Prevention](Credential_Stuffing_Prevention_Cheat_Sheet.html)
  + [Cross-Site Request Forgery Prevention](Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html)
  + [Cross Site Scripting Prevention](Cross_Site_Scripting_Prevention_Cheat_Sheet.html)
  + [Cryptographic Storage](Cryptographic_Storage_Cheat_Sheet.html)
  + [DOM Clobbering Prevention](DOM_Clobbering_Prevention_Cheat_Sheet.html)
  + [DOM based XSS Prevention](DOM_based_XSS_Prevention_Cheat_Sheet.html)
  + [Database Security](Database_Security_Cheat_Sheet.html)
  + [Denial of Service](Denial_of_Service_Cheat_Sheet.html)
  + [Deserialization](Deserialization_Cheat_Sheet.html)
  + [Django REST Framework](Django_REST_Framework_Cheat_Sheet.html)
  + [Django Security](Django_Security_Cheat_Sheet.html)
  + [Docker Security](Docker_Security_Cheat_Sheet.html)
  + [DotNet Security](DotNet_Security_Cheat_Sheet.html)
  + [Error Handling](Error_Handling_Cheat_Sheet.html)
  + [File Upload](File_Upload_Cheat_Sheet.html)
  + [Forgot Password](Forgot_Password_Cheat_Sheet.html)
  + [GraphQL](GraphQL_Cheat_Sheet.html)
  + [HTML5 Security](HTML5_Security_Cheat_Sheet.html)
  + [HTTP Headers](HTTP_Headers_Cheat_Sheet.html)
  + [HTTP Strict Transport Security](HTTP_Strict_Transport_Security_Cheat_Sheet.html)
  + [Infrastructure as Code Security](Infrastructure_as_Code_Security_Cheat_Sheet.html)
  + [Injection Prevention](Injection_Prevention_Cheat_Sheet.html)
  + [Injection Prevention in Java](Injection_Prevention_in_Java_Cheat_Sheet.html)
  + [Input Validation](Input_Validation_Cheat_Sheet.html)
  + [Insecure Direct Object Reference Prevention](Insecure_Direct_Object_Reference_Prevention_Cheat_Sheet.html)
  + [JAAS](JAAS_Cheat_Sheet.html)
  + [JSON Web Token for Java](JSON_Web_Token_for_Java_Cheat_Sheet.html)
  + [Java Security](Java_Security_Cheat_Sheet.html)
  + [Key Management](Key_Management_Cheat_Sheet.html)
  + [Kubernetes Security](Kubernetes_Security_Cheat_Sheet.html)
  + [LDAP Injection Prevention](LDAP_Injection_Prevention_Cheat_Sheet.html)
  + [Laravel](Laravel_Cheat_Sheet.html)
  + [Legacy Application Management](Legacy_Application_Management_Cheat_Sheet.html)
  + [Logging](Logging_Cheat_Sheet.html)
  + [Logging Vocabulary](Logging_Vocabulary_Cheat_Sheet.html)
  + [Mass Assignment](Mass_Assignment_Cheat_Sheet.html)
  + [Microservices Security](Microservices_Security_Cheat_Sheet.html)
  + [Microservices based Security Arch Doc](Microservices_based_Security_Arch_Doc_Cheat_Sheet.html)
  + [Mobile Application Security](Mobile_Application_Security_Cheat_Sheet.html)
  + [Multifactor Authentication](Multifactor_Authentication_Cheat_Sheet.html)
  + [NPM Security](NPM_Security_Cheat_Sheet.html)
  + [Network Segmentation](Network_Segmentation_Cheat_Sheet.html)
  + [NodeJS Docker](NodeJS_Docker_Cheat_Sheet.html)
  + [Nodejs Security](Nodejs_Security_Cheat_Sheet.html)
  + [OAuth2](OAuth2_Cheat_Sheet.html)
  + [OS Command Injection Defense](OS_Command_Injection_Defense_Cheat_Sheet.html)
  + [PHP Configuration](PHP_Configuration_Cheat_Sheet.html)
  + [Password Storage](Password_Storage_Cheat_Sheet.html)
  + [Pinning](Pinning_Cheat_Sheet.html)
  + [Prototype Pollution Prevention](Prototype_Pollution_Prevention_Cheat_Sheet.html)
  + [Query Parameterization](Query_Parameterization_Cheat_Sheet.html)
  + [REST Assessment](REST_Assessment_Cheat_Sheet.html)
  + [REST Security](REST_Security_Cheat_Sheet.html)
  + [Ruby on Rails](Ruby_on_Rails_Cheat_Sheet.html)
  + [SAML Security](SAML_Security_Cheat_Sheet.html)
  + SQL Injection Prevention

    [SQL Injection Prevention](SQL_Injection_Prevention_Cheat_Sheet.html)

    Table of contents
    - [Introduction](#introduction)
    - [What Is a SQL Injection Attack?](#what-is-a-sql-injection-attack)
    - [Anatomy of A Typical SQL Injection Vulnerability](#anatomy-of-a-typical-sql-injection-vulnerability)
    - [Primary Defenses](#primary-defenses)
      * [Defense Option 1: Prepared Statements (with Parameterized Queries)](#defense-option-1-prepared-statements-with-parameterized-queries)
        + [Safe Java Prepared Statement Example](#safe-java-prepared-statement-example)
        + [Safe C# .NET Prepared Statement Example](#safe-c-net-prepared-statement-example)
        + [Hibernate Query Language (HQL) Prepared Statement (Named Parameters) Example](#hibernate-query-language-hql-prepared-statement-named-parameters-example)
        + [Other Examples of Safe Prepared Statements](#other-examples-of-safe-prepared-statements)
      * [Defense Option 2: Stored Procedures](#defense-option-2-stored-procedures)
        + [Safe Approach to Stored Procedures](#safe-approach-to-stored-procedures)
        + [When Stored Procedures Can Increase Risk](#when-stored-procedures-can-increase-risk)
        + [Safe Java Stored Procedure Example](#safe-java-stored-procedure-example)
        + [Safe VB .NET Stored Procedure Example](#safe-vb-net-stored-procedure-example)
      * [Defense Option 3: Allow-list Input Validation](#defense-option-3-allow-list-input-validation)
        + [Sample Of Safe Table Name Validation](#sample-of-safe-table-name-validation)
        + [Safest Use Of Dynamic SQL Generation (DISCOURAGED)](#safest-use-of-dynamic-sql-generation-discouraged)
        + [Sample of Safer Dynamic Query Generation (DISCOURAGED)](#sample-of-safer-dynamic-query-generation-discouraged)
      * [Defense Option 4: STRONGLY DISCOURAGED: Escaping All User-Supplied Input](#defense-option-4-strongly-discouraged-escaping-all-user-supplied-input)
    - [Additional Defenses](#additional-defenses)
      * [Least Privilege](#least-privilege)
        + [Minimizing Application and OS Privileges](#minimizing-application-and-os-privileges)
        + [Details Of Least Privilege When Developing](#details-of-least-privilege-when-developing)
        + [Least Admin Privileges For Multiple DBs](#least-admin-privileges-for-multiple-dbs)
        + [Enhancing Least Privilege with SQL Views](#enhancing-least-privilege-with-sql-views)
      * [Allow-list Input Validation](#allow-list-input-validation)
    - [Related Articles](#related-articles)
  + [Secrets Management](Secrets_Management_Cheat_Sheet.html)
  + [Secure Cloud Architecture](Secure_Cloud_Architecture_Cheat_Sheet.html)
  + [Secure Product Design](Secure_Product_Design_Cheat_Sheet.html)
  + [Securing Cascading Style Sheets](Securing_Cascading_Style_Sheets_Cheat_Sheet.html)
  + [Server Side Request Forgery Prevention](Server_Side_Request_Forgery_Prevention_Cheat_Sheet.html)
  + [Session Management](Session_Management_Cheat_Sheet.html)
  + [Software Supply Chain Security](Software_Supply_Chain_Security_Cheat_Sheet.html)
  + [Symfony](Symfony_Cheat_Sheet.html)
  + [TLS Cipher String](TLS_Cipher_String_Cheat_Sheet.html)
  + [Third Party Javascript Management](Third_Party_Javascript_Management_Cheat_Sheet.html)
  + [Threat Modeling](Threat_Modeling_Cheat_Sheet.html)
  + [Transaction Authorization](Transaction_Authorization_Cheat_Sheet.html)
  + [Transport Layer Protection](Transport_Layer_Protection_Cheat_Sheet.html)
  + [Transport Layer Security](Transport_Layer_Security_Cheat_Sheet.html)
  + [Unvalidated Redirects and Forwards](Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html)
  + [User Privacy Protection](User_Privacy_Protection_Cheat_Sheet.html)
  + [Virtual Patching](Virtual_Patching_Cheat_Sheet.html)
  + [Vulnerability Disclosure](Vulnerability_Disclosure_Cheat_Sheet.html)
  + [Vulnerable Dependency Management](Vulnerable_Dependency_Management_Cheat_Sheet.html)
  + [Web Service Security](Web_Service_Security_Cheat_Sheet.html)
  + [XML External Entity Prevention](XML_External_Entity_Prevention_Cheat_Sheet.html)
  + [XML Security](XML_Security_Cheat_Sheet.html)
  + [XSS Filter Evasion](XSS_Filter_Evasion_Cheat_Sheet.html)
  + [XS Leaks](XS_Leaks_Cheat_Sheet.html)

Table of contents

* [Introduction](#introduction)
* [What Is a SQL Injection Attack?](#what-is-a-sql-injection-attack)
* [Anatomy of A Typical SQL Injection Vulnerability](#anatomy-of-a-typical-sql-injection-vulnerability)
* [Primary Defenses](#primary-defenses)
  + [Defense Option 1: Prepared Statements (with Parameterized Queries)](#defense-option-1-prepared-statements-with-parameterized-queries)
    - [Safe Java Prepared Statement Example](#safe-java-prepared-statement-example)
    - [Safe C# .NET Prepared Statement Example](#safe-c-net-prepared-statement-example)
    - [Hibernate Query Language (HQL) Prepared Statement (Named Parameters) Example](#hibernate-query-language-hql-prepared-statement-named-parameters-example)
    - [Other Examples of Safe Prepared Statements](#other-examples-of-safe-prepared-statements)
  + [Defense Option 2: Stored Procedures](#defense-option-2-stored-procedures)
    - [Safe Approach to Stored Procedures](#safe-approach-to-stored-procedures)
    - [When Stored Procedures Can Increase Risk](#when-stored-procedures-can-increase-risk)
    - [Safe Java Stored Procedure Example](#safe-java-stored-procedure-example)
    - [Safe VB .NET Stored Procedure Example](#safe-vb-net-stored-procedure-example)
  + [Defense Option 3: Allow-list Input Validation](#defense-option-3-allow-list-input-validation)
    - [Sample Of Safe Table Name Validation](#sample-of-safe-table-name-validation)
    - [Safest Use Of Dynamic SQL Generation (DISCOURAGED)](#safest-use-of-dynamic-sql-generation-discouraged)
    - [Sample of Safer Dynamic Query Generation (DISCOURAGED)](#sample-of-safer-dynamic-query-generation-discouraged)
  + [Defense Option 4: STRONGLY DISCOURAGED: Escaping All User-Supplied Input](#defense-option-4-strongly-discouraged-escaping-all-user-supplied-input)
* [Additional Defenses](#additional-defenses)
  + [Least Privilege](#least-privilege)
    - [Minimizing Application and OS Privileges](#minimizing-application-and-os-privileges)
    - [Details Of Least Privilege When Developing](#details-of-least-privilege-when-developing)
    - [Least Admin Privileges For Multiple DBs](#least-admin-privileges-for-multiple-dbs)
    - [Enhancing Least Privilege with SQL Views](#enhancing-least-privilege-with-sql-views)
  + [Allow-list Input Validation](#allow-list-input-validation)
* [Related Articles](#related-articles)

# SQL Injection Prevention Cheat Sheet[¶](#sql-injection-prevention-cheat-sheet "Permanent link")

## Introduction[¶](#introduction "Permanent link")

This cheat sheet will help you prevent SQL injection flaws in your applications. It will define what SQL injection is, explain where those flaws occur, and provide four options for defending against SQL injection attacks. [SQL Injection](https://owasp.org/www-community/attacks/SQL_Injection) attacks are common because:

1. SQL Injection vulnerabilities are very common, and
2. The application's database is a frequent target for attackers because it typically contains interesting/critical data.

## What Is a SQL Injection Attack?[¶](#what-is-a-sql-injection-attack "Permanent link")

Attackers can use SQL injection on an application if it has dynamic database queries that use string concatenation and user supplied input. To avoid SQL injection flaws, developers need to:

1. Stop writing dynamic queries with string concatenation or
2. Prevent malicious SQL input from being included in executed queries.

There are simple techniques for preventing SQL injection vulnerabilities and they can be used with practically any kind of programming language and any type of database. While XML databases can have similar problems (e.g., XPath and XQuery injection), these techniques can be used to protect them as well.

## Anatomy of A Typical SQL Injection Vulnerability[¶](#anatomy-of-a-typical-sql-injection-vulnerability "Permanent link")

A common SQL injection flaw in Java is below. Because its unvalidated "customerName" parameter is simply appended to the query, an attacker can enter SQL code into that query and the application would take the attacker's code and execute it on the database.

```
String query = "SELECT account_balance FROM user_data WHERE user_name = "
             + request.getParameter("customerName");
try {
    Statement statement = connection.createStatement( ... );
    ResultSet results = statement.executeQuery( query );
}

...

```
## Primary Defenses[¶](#primary-defenses "Permanent link")

* **Option 1: Use of Prepared Statements (with Parameterized Queries)**
* **Option 2: Use of Properly Constructed Stored Procedures**
* **Option 3: Allow-list Input Validation**
* **Option 4: STRONGLY DISCOURAGED: Escaping All User Supplied Input**

### Defense Option 1: Prepared Statements (with Parameterized Queries)[¶](#defense-option-1-prepared-statements-with-parameterized-queries "Permanent link")

When developers are taught how to write database queries, they should be told to use prepared statements with variable binding (aka parameterized queries). Prepared statements are simple to write and easier to understand than dynamic queries, and parameterized queries force the developer to define all SQL code first and pass in each parameter to the query later.

If database queries use this coding style, the database will always distinguish between code and data, regardless of what user input is supplied. Also, prepared statements ensure that an attacker cannot change the intent of a query, even if SQL commands are inserted by an attacker.

#### Safe Java Prepared Statement Example[¶](#safe-java-prepared-statement-example "Permanent link")

In the safe Java example below, if an attacker were to enter the userID as `tom' or '1'='1`, the parameterized query would look for a username that literally matches the entire string `tom' or '1'='1`. Thus, the database would be protected against injections of malicious SQL code.

The following code example uses a `PreparedStatement`, Java's implementation of a parameterized query, to execute the same database query.

```
// This should REALLY be validated too
String custname = request.getParameter("customerName");
// Perform input validation to detect attacks
String query = "SELECT account_balance FROM user_data WHERE user_name = ? ";
PreparedStatement pstmt = connection.prepareStatement( query );
pstmt.setString( 1, custname);
ResultSet results = pstmt.executeQuery( );

```
#### Safe C# .NET Prepared Statement Example[¶](#safe-c-net-prepared-statement-example "Permanent link")

In .NET, the creation and execution of the query doesn't change. Just pass the parameters to the query using the `Parameters.Add()` call as shown below.

```
String query = "SELECT account_balance FROM user_data WHERE user_name = ?";
try {
  OleDbCommand command = new OleDbCommand(query, connection);
  command.Parameters.Add(new OleDbParameter("customerName", CustomerName Name.Text));
  OleDbDataReader reader = command.ExecuteReader();
  // …
} catch (OleDbException se) {
  // error handling
}

```

While we have shown examples in Java and .NET, practically all other languages (including Cold Fusion and Classic ASP) support parameterized query interfaces. Even SQL abstraction layers, like the [Hibernate Query Language](http://hibernate.org/) (HQL) with the same type of injection problems (called [HQL Injection](http://cwe.mitre.org/data/definitions/564.html)) support parameterized queries as well:

#### Hibernate Query Language (HQL) Prepared Statement (Named Parameters) Example[¶](#hibernate-query-language-hql-prepared-statement-named-parameters-example "Permanent link")

```
// This is an unsafe HQL statement
Query unsafeHQLQuery = session.createQuery("from Inventory where productID='"+userSuppliedParameter+"'");
// Here is a safe version of the same query using named parameters
Query safeHQLQuery = session.createQuery("from Inventory where productID=:productid");
safeHQLQuery.setParameter("productid", userSuppliedParameter);

```
#### Other Examples of Safe Prepared Statements[¶](#other-examples-of-safe-prepared-statements "Permanent link")

If you need examples of prepared queries/parameterized languages, including Ruby, PHP, Cold Fusion, Perl, and Rust, see the [Query Parameterization Cheat Sheet](Query_Parameterization_Cheat_Sheet.html) or this [site](http://bobby-tables.com/).

Generally, developers like prepared statements because all the SQL code stays within the application, which makes applications relatively database independent.

### Defense Option 2: Stored Procedures[¶](#defense-option-2-stored-procedures "Permanent link")

Though stored procedures are not always safe from SQL injection, developers can use certain standard stored procedure programming constructs. This approach has the same effect as using parameterized queries, as long as the stored procedures are implemented safely (which is the norm for most stored procedure languages).

#### Safe Approach to Stored Procedures[¶](#safe-approach-to-stored-procedures "Permanent link")

If stored procedures are needed, the safest approach to using them requires the developer to build SQL statements with parameters that are automatically parameterized, unless the developer does something largely out of the norm. The difference between prepared statements and stored procedures is that the SQL code for a stored procedure is defined and stored in the database itself, then called from the application. Since prepared statements and safe stored procedures are equally effective in preventing SQL injection, your organization should choose the approach that makes the most sense for you.

#### When Stored Procedures Can Increase Risk[¶](#when-stored-procedures-can-increase-risk "Permanent link")

Occasionally, stored procedures can increase risk when a system is attacked. For example, on MS SQL Server, you have three main default roles: `db_datareader`, `db_datawriter` and `db_owner`. Before stored procedures came into use, DBAs would give `db_datareader` or `db_datawriter` rights to the webservice's user, depending on the requirements.

However, stored procedures require execute rights, a role not available by default. In some setups where user management has been centralized, but is limited to those 3 roles, web apps would have to run as `db_owner` so stored procedures could work. Naturally, that means that if a server is breached, the attacker has full rights to the database, where previously, they might only have had read-access.

#### Safe Java Stored Procedure Example[¶](#safe-java-stored-procedure-example "Permanent link")

The following code example uses Java's implementation of the stored procedure interface (`CallableStatement`) to execute the same database query. The `sp_getAccountBalance` stored procedure has to be predefined in the database and use the same functionality as the query above.

```
// This should REALLY be validated
String custname = request.getParameter("customerName");
try {
  CallableStatement cs = connection.prepareCall("{call sp_getAccountBalance(?)}");
  cs.setString(1, custname);
  ResultSet results = cs.executeQuery();
  // … result set handling
} catch (SQLException se) {
  // … logging and error handling
}

```
#### Safe VB .NET Stored Procedure Example[¶](#safe-vb-net-stored-procedure-example "Permanent link")

The following code example uses a `SqlCommand`, .NET's implementation of the stored procedure interface, to execute the same database query. The `sp_getAccountBalance` stored procedure must be predefined in the database and use the same functionality as the query defined above.

```
 Try
   Dim command As SqlCommand = new SqlCommand("sp_getAccountBalance", connection)
   command.CommandType = CommandType.StoredProcedure
   command.Parameters.Add(new SqlParameter("@CustomerName", CustomerName.Text))
   Dim reader As SqlDataReader = command.ExecuteReader()
   '...
 Catch se As SqlException
   'error handling
 End Try

```
### Defense Option 3: Allow-list Input Validation[¶](#defense-option-3-allow-list-input-validation "Permanent link")

If you are faced with parts of SQL queries that can't use bind variables, such as table names, column names, or sort order indicators (ASC or DESC), input validation or query redesign is the most appropriate defense. When table or column names are needed, ideally those values come from the code and not from user parameters.

#### Sample Of Safe Table Name Validation[¶](#sample-of-safe-table-name-validation "Permanent link")

WARNING: Using user parameter values to target table or column names is a symptom of poor design and a full rewrite should be considered if time allows. If that is not possible, developers should map the parameter values to the legal/expected table or column names to make sure unvalidated user input doesn't end up in the query.

In the example below, since `tableName` is identified as one of the legal and expected values for a table name in this query, it can be directly appended to the SQL query. Keep in mind that generic table validation functions can lead to data loss if table names are used in queries where they are not expected.

```
String tableName;
switch(PARAM):
  case "Value1": tableName = "fooTable";
                 break;
  case "Value2": tableName = "barTable";
                 break;
  ...
  default      : throw new InputValidationException("unexpected value provided"
                                                  + " for table name");

```
#### Safest Use Of Dynamic SQL Generation (DISCOURAGED)[¶](#safest-use-of-dynamic-sql-generation-discouraged "Permanent link")

When we say a stored procedure is "implemented safely," that means it does not include any unsafe dynamic SQL generation. Developers do not usually generate dynamic SQL inside stored procedures. However, it can be done, but should be avoided.

If it can't be avoided, the stored procedure must use input validation or proper escaping, as described in this article, to make sure that all user supplied input to the stored procedure can't be used to inject SQL code into the dynamically generated query. Auditors should always look for uses of `sp_execute`, `execute` or `exec` within SQL Server stored procedures. Similar audit guidelines are necessary for similar functions for other vendors.

#### Sample of Safer Dynamic Query Generation (DISCOURAGED)[¶](#sample-of-safer-dynamic-query-generation-discouraged "Permanent link")

For something simple like a sort order, it is best if the user supplied input is converted to a boolean, and then that boolean is used to select the safe value to append to the query. This is a very standard need in dynamic query creation.

For example:

```
public String someMethod(boolean sortOrder) {
 String SQLquery = "some SQL ... order by Salary " + (sortOrder ? "ASC" : "DESC");`
 ...

```

Any time user input can be converted to a non-String, like a date, numeric, boolean, enumerated type, etc. before it is appended to a query, or used to select a value to append to the query, this ensures it is safe to do so.

Input validation is also recommended as a secondary defense in ALL cases, even when using bind variables as discussed earlier in this article. More techniques on how to implement strong input validation is described in the [Input Validation Cheat Sheet](Input_Validation_Cheat_Sheet.html).

### Defense Option 4: STRONGLY DISCOURAGED: Escaping All User-Supplied Input[¶](#defense-option-4-strongly-discouraged-escaping-all-user-supplied-input "Permanent link")

In this approach, the developer will escape all user input before putting it in a query. It is very database specific in its implementation. This methodology is frail compared to other defenses, and we CANNOT guarantee that this option will prevent all SQL injections in all situations.

If an application is built from scratch or requires low risk tolerance, it should be built or re-written using parameterized queries, stored procedures, or some kind of Object Relational Mapper (ORM) that builds your queries for you.

## Additional Defenses[¶](#additional-defenses "Permanent link")

Beyond adopting one of the four primary defenses, we also recommend adopting all of these additional defenses to provide defense in depth. These additional defenses are:

* **Least Privilege**
* **Allow-list Input Validation**

### Least Privilege[¶](#least-privilege "Permanent link")

To minimize the potential damage of a successful SQL injection attack, you should minimize the privileges assigned to every database account in your environment. Start from the ground up to determine what access rights your application accounts require, rather than trying to figure out what access rights you need to take away.

Make sure that accounts that only need read access are only granted read access to the tables they need access to. DO NOT ASSIGN DBA OR ADMIN TYPE ACCESS TO YOUR APPLICATION ACCOUNTS. We understand that this is easy, and everything just "works" when you do it this way, but it is very dangerous.

#### Minimizing Application and OS Privileges[¶](#minimizing-application-and-os-privileges "Permanent link")

SQL injection is not the only threat to your database data. Attackers can simply change the parameter values from one of the legal values they are presented with, to a value that is unauthorized for them, but the application itself might be authorized to access. As such, minimizing the privileges granted to your application will reduce the likelihood of such unauthorized access attempts, even when an attacker is not trying to use SQL injection as part of their exploit.

While you are at it, you should minimize the privileges of the operating system account that the DBMS runs under. Don't run your DBMS as root or system! Most DBMSs run out of the box with a very powerful system account. For example, MySQL runs as system on Windows by default! Change the DBMS's OS account to something more appropriate, with restricted privileges.

#### Details Of Least Privilege When Developing[¶](#details-of-least-privilege-when-developing "Permanent link")

If an account only needs access to portions of a table, consider creating a view that limits access to that portion of the data and assigning the account access to the view instead of the underlying table. Rarely, if ever, grant create or delete access to database accounts.

If you adopt a policy where you use stored procedures everywhere, and don't allow application accounts to directly execute their own queries, then restrict those accounts to only be able to execute the stored procedures they need. Don't grant them any rights directly to the tables in the database.

#### Least Admin Privileges For Multiple DBs[¶](#least-admin-privileges-for-multiple-dbs "Permanent link")

The designers of web applications should avoid using the same owner/admin account in the web applications to connect to the database. Different DB users should be used for different web applications.

In general, each separate web application that requires access to the database should have a designated database user account that the application will use to connect to the DB. That way, the designer of the application can have good granularity in the access control, thus reducing the privileges as much as possible. Each DB user will then have select access to only what it needs, and write-access as needed.

As an example, a login page requires read access to the username and password fields of a table, but no write access of any form (no insert, update, or delete). However, the sign-up page certainly requires insert privilege to that table; this restriction can only be enforced if these web apps use different DB users to connect to the database.

#### Enhancing Least Privilege with SQL Views[¶](#enhancing-least-privilege-with-sql-views "Permanent link")

You can use SQL views to further increase the granularity of access by limiting the read access to specific fields of a table or joins of tables. It could have additional benefits.

For example, if the system is required (perhaps due to some specific legal requirements) to store the passwords of the users, instead of salted-hashed passwords, the designer could use views to compensate for this limitation. They could revoke all access to the table (from all DB users except the owner/admin) and create a view that outputs the hash of the password field and not the field itself.

Any SQL injection attack that succeeds in stealing DB information will be restricted to stealing the hash of the passwords (could even be a keyed hash), since no DB user for any of the web applications has access to the table itself.

### Allow-list Input Validation[¶](#allow-list-input-validation "Permanent link")

In addition to being a primary defense when nothing else is possible (e.g., when a bind variable isn't legal), input validation can also be a secondary defense used to detect unauthorized input before it is passed to the SQL query. For more information please see the [Input Validation Cheat Sheet](Input_Validation_Cheat_Sheet.html). Proceed with caution here. Validated data is not necessarily safe to insert into SQL queries via string building.

## Related Articles[¶](#related-articles "Permanent link")

**SQL Injection Attack Cheat Sheets**:

The following articles describe how to exploit different kinds of SQL injection vulnerabilities on various platforms (that this article was created to help you avoid):

* [SQL Injection Cheat Sheet](https://www.netsparker.com/blog/web-security/sql-injection-cheat-sheet/)
* Bypassing WAF's with SQLi - [SQL Injection Bypassing WAF](https://owasp.org/www-community/attacks/SQL_Injection_Bypassing_WAF)

**Description of SQL Injection Vulnerabilities**:

* OWASP article on [SQL Injection](https://owasp.org/www-community/attacks/SQL_Injection) Vulnerabilities
* OWASP article on [Blind\_SQL\_Injection](https://owasp.org/www-community/attacks/Blind_SQL_Injection) Vulnerabilities

**How to Avoid SQL Injection Vulnerabilities**:

* [OWASP Developers Guide](https://github.com/OWASP/DevGuide) article on how to avoid SQL injection vulnerabilities
* OWASP Cheat Sheet that provides [numerous language specific examples of parameterized queries using both Prepared Statements and Stored Procedures](Query_Parameterization_Cheat_Sheet.html)
* [The Bobby Tables site (inspired by the XKCD webcomic) has numerous examples in different languages of parameterized Prepared Statements and Stored Procedures](http://bobby-tables.com/)

**How to Review Code for SQL Injection Vulnerabilities**:

* [OWASP Code Review Guide](https://wiki.owasp.org/index.php/Category%3AOWASP_Code_Review_Project) article on how to [Review Code for SQL Injection](https://wiki.owasp.org/index.php/Reviewing_Code_for_SQL_Injection) Vulnerabilities

**How to Test for SQL Injection Vulnerabilities**:

* [OWASP Testing Guide](https://owasp.org/www-project-web-security-testing-guide) article on how to [Test for SQL Injection](https://owasp.org/www-project-web-security-testing-guide/stable/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05-Testing_for_SQL_Injection.html) Vulnerabilities

©Copyright  - Cheat Sheets Series Team - This work is licensed under [Creative Commons Attribution-ShareAlike 4.0 International](https://creativecommons.org/licenses/by-sa/4.0/).

Made with
[Material for MkDocs](https://squidfunk.github.io/mkdocs-material/)



=== Content from github.com_19d5f079_20250111_071447.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fportabilis%2Fi-educar%2Fcommit%2F7824b95745fa2da6476b9901041d9c854bf52ffe)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fportabilis%2Fi-educar%2Fcommit%2F7824b95745fa2da6476b9901041d9c854bf52ffe)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=portabilis%2Fi-educar)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[portabilis](/portabilis)
/
**[i-educar](/portabilis/i-educar)**
Public

* [Notifications](/login?return_to=%2Fportabilis%2Fi-educar) You must be signed in to change notification settings
* [Fork
  456](/login?return_to=%2Fportabilis%2Fi-educar)
* [Star
   620](/login?return_to=%2Fportabilis%2Fi-educar)

* [Code](/portabilis/i-educar)
* [Issues
  4](/portabilis/i-educar/issues)
* [Pull requests
  2](/portabilis/i-educar/pulls)
* [Actions](/portabilis/i-educar/actions)
* [Wiki](/portabilis/i-educar/wiki)
* [Security](/portabilis/i-educar/security)
* [Insights](/portabilis/i-educar/pulse)

Additional navigation options

* [Code](/portabilis/i-educar)
* [Issues](/portabilis/i-educar/issues)
* [Pull requests](/portabilis/i-educar/pulls)
* [Actions](/portabilis/i-educar/actions)
* [Wiki](/portabilis/i-educar/wiki)
* [Security](/portabilis/i-educar/security)
* [Insights](/portabilis/i-educar/pulse)

## Commit

[Permalink](/portabilis/i-educar/commit/7824b95745fa2da6476b9901041d9c854bf52ffe)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Muda local da sanitização

[Browse files](/portabilis/i-educar/tree/7824b95745fa2da6476b9901041d9c854bf52ffe)
Browse the repository at this point in the history

* Loading branch information

[![@edineivaldameri](https://avatars.githubusercontent.com/u/99054215?s=40&v=4)](/edineivaldameri)

[edineivaldameri](/portabilis/i-educar/commits?author=edineivaldameri "View all commits by edineivaldameri")
committed
Aug 21, 2024

1 parent
[701a1b0](/portabilis/i-educar/commit/701a1b0b6cdd24414be8e71ecd3e7a67596672ab)

commit 7824b95

Showing
**1 changed file**
with
**2 additions**
and
**2 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

4 changes: 2 additions & 2 deletions

4
[ieducar/intranet/include/clsCampos.inc.php](#diff-c1504abfa6baa67ad630caee2625eb93b97e046c6f63e289cc2b6d18e06c0c44 "ieducar/intranet/include/clsCampos.inc.php")

Show comments

[View file](/portabilis/i-educar/blob/7824b95745fa2da6476b9901041d9c854bf52ffe/ieducar/intranet/include/clsCampos.inc.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1255,8 +1255,6 @@ classe = (classe == \'formmdtd\')? \'formlttd tr\_\' + This.nome : \'formmdtd tr\_ |
|  |  | $adicionador\_complemento\_campo = ''; |
|  |  | $campo\_valor = $componente[3] ?? null; |
|  |  |  |
|  |  | $campo\_valor = is\_string($campo\_valor) ? htmlspecialchars($campo\_valor, ENT\_QUOTES) : null; |
|  |  |  |
|  |  | $nome .= $adicionador\_complemento\_campo; |
|  |  | $expressao\_regular = $componente[2]; |
|  |  |  |
| Expand Down  Expand Up | | @@ -1437,6 +1435,8 @@ classe = (classe == \'formmdtd\')? \'formlttd tr\_\' + This.nome : \'formmdtd tr\_ |
|  |  | $evento = ''; |
|  |  | } |
|  |  |  |
|  |  | $campo\_valor = ! is\_null($campo\_valor) ? htmlspecialchars($campo\_valor, ENT\_QUOTES) : null; |
|  |  |  |
|  |  | $retorno .= "<input class='{$class}' type='text' name=\"{$nome}\" id=\"{$nome}\" value=\"{$campo\_valor}\" size=\"{$componente[4]}\" maxlength=\"{$componente[5]}\" {$evento} {$disabled}> {$componente[7]}"; |
|  |  | break; |
|  |  |  |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `7824b95`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fportabilis%2Fi-educar%2Fcommit%2F7824b95745fa2da6476b9901041d9c854bf52ffe) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_9fd48440_20250111_071447.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fportabilis%2Fi-educar%2Fsecurity%2Fadvisories%2FGHSA-2v4w-7xqr-hxmr)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fportabilis%2Fi-educar%2Fsecurity%2Fadvisories%2FGHSA-2v4w-7xqr-hxmr)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=portabilis%2Fi-educar)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[portabilis](/portabilis)
/
**[i-educar](/portabilis/i-educar)**
Public

* [Notifications](/login?return_to=%2Fportabilis%2Fi-educar) You must be signed in to change notification settings
* [Fork
  456](/login?return_to=%2Fportabilis%2Fi-educar)
* [Star
   620](/login?return_to=%2Fportabilis%2Fi-educar)

* [Code](/portabilis/i-educar)
* [Issues
  4](/portabilis/i-educar/issues)
* [Pull requests
  2](/portabilis/i-educar/pulls)
* [Actions](/portabilis/i-educar/actions)
* [Wiki](/portabilis/i-educar/wiki)
* [Security](/portabilis/i-educar/security)
* [Insights](/portabilis/i-educar/pulse)

Additional navigation options

* [Code](/portabilis/i-educar)
* [Issues](/portabilis/i-educar/issues)
* [Pull requests](/portabilis/i-educar/pulls)
* [Actions](/portabilis/i-educar/actions)
* [Wiki](/portabilis/i-educar/wiki)
* [Security](/portabilis/i-educar/security)
* [Insights](/portabilis/i-educar/pulse)

# SQL Injection Autenticado

High

[edersoares](/edersoares)
published
GHSA-2v4w-7xqr-hxmr
Aug 28, 2024

## Package

i-Educar
(Portábilis)

## Affected versions

2.9

## Patched versions

None

## Description

### Resumo

A criação de uma query SQL a partir de uma concatenação de um parâmetro GET controlado pelo usuário permite que um atacante manipule a query.

### Detalhes

O arquivo **ieducar/intranet/funcionario\_vinculo\_det.php**, na **linha 17**, recebe o parâmetro GET **cod\_func**, o qual é concatenado à query que será realizada, permitindo que um atacante consiga manipulá-la:

[![image](https://private-user-images.githubusercontent.com/152667761/359292687-3ab90528-71f3-456f-aa66-8b8a326d3f2c.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1Nzk5ODcsIm5iZiI6MTczNjU3OTY4NywicGF0aCI6Ii8xNTI2Njc3NjEvMzU5MjkyNjg3LTNhYjkwNTI4LTcxZjMtNDU2Zi1hYTY2LThiOGEzMjZkM2YyYy5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTExJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMVQwNzE0NDdaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1mYzNkZDY0OGMwMDQ4MWJlZDJiMzNiYmFkMGE2Y2VhNTBhZTA2YjI5YjA4NDcyYTljNjdmMzE5N2FkYzJkODk3JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.w01uaUolqn8okow0ncA3VVqq--reYgPHqJlm5ht3Dcs)](https://private-user-images.githubusercontent.com/152667761/359292687-3ab90528-71f3-456f-aa66-8b8a326d3f2c.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1Nzk5ODcsIm5iZiI6MTczNjU3OTY4NywicGF0aCI6Ii8xNTI2Njc3NjEvMzU5MjkyNjg3LTNhYjkwNTI4LTcxZjMtNDU2Zi1hYTY2LThiOGEzMjZkM2YyYy5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTExJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMVQwNzE0NDdaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1mYzNkZDY0OGMwMDQ4MWJlZDJiMzNiYmFkMGE2Y2VhNTBhZTA2YjI5YjA4NDcyYTljNjdmMzE5N2FkYzJkODk3JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.w01uaUolqn8okow0ncA3VVqq--reYgPHqJlm5ht3Dcs)

### PoC

Podemos utilizar o [sqlmap](https://github.com/sqlmapproject/sqlmap) para exploração facilitada dessa vulnerabilidade:

```
sqlmap -u "http://localhost/intranet/funcionario_vinculo_det.php?cod_func=1" --cookie "i_educar_session=<cookie_sessao>" -p cod_func --risk 3 --level 5 --dbms postgres  --threads 10 --dbs
```

[![image](https://private-user-images.githubusercontent.com/152667761/359293221-d5a0fad9-2760-4fef-aa0a-ff4f83fe3c13.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1Nzk5ODcsIm5iZiI6MTczNjU3OTY4NywicGF0aCI6Ii8xNTI2Njc3NjEvMzU5MjkzMjIxLWQ1YTBmYWQ5LTI3NjAtNGZlZi1hYTBhLWZmNGY4M2ZlM2MxMy5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTExJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMVQwNzE0NDdaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT03MDQ5ZTc0NTZiZGY4MWY1NDczNmVmYjFjNzZiOGMzOGZiZjNjN2M3MTQ0NmU1MDIxMDgzMzE1ZTUzZTdjNzE5JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.kh7gYq12W0SQaJmb1L2nv_yh3mGAMOBbC0oMA2Ekq8Q)](https://private-user-images.githubusercontent.com/152667761/359293221-d5a0fad9-2760-4fef-aa0a-ff4f83fe3c13.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1Nzk5ODcsIm5iZiI6MTczNjU3OTY4NywicGF0aCI6Ii8xNTI2Njc3NjEvMzU5MjkzMjIxLWQ1YTBmYWQ5LTI3NjAtNGZlZi1hYTBhLWZmNGY4M2ZlM2MxMy5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTExJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMVQwNzE0NDdaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT03MDQ5ZTc0NTZiZGY4MWY1NDczNmVmYjFjNzZiOGMzOGZiZjNjN2M3MTQ0NmU1MDIxMDgzMzE1ZTUzZTdjNzE5JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.kh7gYq12W0SQaJmb1L2nv_yh3mGAMOBbC0oMA2Ekq8Q)

### Impacto

A exploração bem-sucedida dessa falha permite que um atacante tenha acesso completo e irrestrito ao banco de dados, com um usuário web com permissionamento mínimo. Isso pode implicar na obtenção de informações de usuários, como e-mails, hashes de senha, etc

### Mitigação

A utilização de prepared statements é necessária para mitigação completa desse tipo de vulnerabilidade. Tentativas como substituição ou blacklist podem não ser tão efetivas e não são recomendadas.

### Referências

* <https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html>
* <https://portswigger.net/web-security/sql-injection>

### Severity

High

8.8

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
Low

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

### CVE ID

CVE-2024-45059

### Weaknesses

[CWE-89](/advisories?query=cwe%3A89)

### Credits

* [![@0xbhsu](https://avatars.githubusercontent.com/u/152667761?s=40&v=4)](/0xbhsu)
  [0xbhsu](/0xbhsu)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


