
Commit Information:
------------------
Author: Sergey Nikolaienkov  1679998951 +0200
Date: Android Build Coastguard Worker  1691687573 +0000
Bug ID: Bug: 262244882
Commit Message:
--------------
Fix path traversal vulnerabilities in MediaProviderCanonicalize filepath provided by the caller when hanling SCAN\_FILE\_CALLmethod call in MediaProvider.Additionally, make sure to check access permission in SCAN\_FILE\_CALL(using enforceCallingPermissionInternal()).Preemptively canonicalize Files provided as an arguments to the publicAPI methods in ModernMediaScanner (scanFile(), scanDirectory() andonDirectoryDirty()) to prevent path traversal attacks.Bug: 262244882Test: atest MediaProviderTests(cherry picked from https://googleplex-android-review.googlesource.com/q/commit:5bb32d7fba00b9e53c7e20ae8acaf6f84a8b2e8d)Merged-In: I61e77d69ae857984b819fa0ea27bec5c26a34842Change-Id: I61e77d69ae857984b819fa0ea27bec5c26a34842
