- **Root cause of vulnerability**: The `IdentitiesController` allows binding `extern_uid`s for arbitrary providers without proper validation, which can be abused to pre-occupy identities.
- **Weaknesses/vulnerabilities present**: Improper access control, insecure binding of external identities to user accounts.
- **Impact of exploitation**: An attacker can pre-occupy an `extern_uid` (e.g., a Google OAuth2 ID) by binding it to an attacker-controlled GitLab account. When the legitimate owner of that `extern_uid` attempts to sign up with the same provider, they will be linked to the attacker's account instead, potentially without realizing it. The attacker would gain access to the victim's pre-occupied account.
- **Attack vectors**: An attacker needs a GitLab account and the knowledge of a target's `extern_uid`.
- **Required attacker capabilities/position**: The attacker needs to be a valid GitLab user and know the `extern_uid` of the target.