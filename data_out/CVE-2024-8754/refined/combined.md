=== Content from gitlab.com_61bb4582_20250110_165355.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# IdentitiesController allows linking of arbitrary unclaimed provider identities

### Summary

The [IdentitiesController](https://gitlab.com/gitlab-org/gitlab/blob/97b6b1962c592510760409cefda572d849aa321b/app/controllers/user_settings/identities_controller.rb) introduced as part of [a security fix](https://gitlab.com/gitlab-org/security/gitlab/-/merge_requests/3971) allows to bind `extern_uid`s for arbitrary providers.

This issue was even [discussed in the MR](https://gitlab.com/gitlab-org/security/gitlab/-/merge_requests/3971#note_1875665846) however it was not deemed impactful enough to be prevented.

The reasoning in the original security MR was along the lines of:

> the errant identity would actually open their own account up to compromise

However this issue can be used to pre-occupy `extern_uid`s so as an attacker I would create a dedicated account on gitlab.com and bind a target `extern_uid` e.g. with the `google_oauth2` provider to that account. When now the owner behind the `extern_uid` tries to sign up with Google
it will end up in the pre-occupied account and maybe not even realize that this is not a newly created account, while the attacker still has access to it.

cc: [@truegreg](/truegreg "Greg Alfaro") [@rshambhuni](/rshambhuni "Rohit Shambhuni") [@dblessing](/dblessing "Drew Blessing") [@atevans](/atevans "Andrew Evans")

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


