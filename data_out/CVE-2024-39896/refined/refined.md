Based on the provided content, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2024-39896

**Root Cause of Vulnerability:**
- The vulnerability arises from the way Directus handles authentication attempts when both SSO and local authentication are enabled. When a user attempts to log in using the regular login form (or API) with an email address that is already associated with an SSO provider, the system throws a specific error message indicating that the user belongs to another provider. This differs from the generic "invalid credentials" error for non-existent or non-SSO users, thus enabling user enumeration.

**Weaknesses/Vulnerabilities Present:**
- **Account Enumeration:** The system provides specific error messages that can be used to differentiate between valid SSO users and invalid email addresses. This allows an attacker to systematically determine which email addresses are registered as SSO users on the Directus instance.
- **Information Disclosure:** The error message reveals whether a specific email is a registered SSO user, exposing sensitive information.

**Impact of Exploitation:**
- **User Enumeration:** An attacker can identify valid SSO user accounts on a Directus instance. This can be used in targeted phishing attacks, credential stuffing, or other social engineering tactics.
- **Potential for further attacks:** Knowing valid usernames makes it easier to carry out brute-force or password spraying attacks, as the attacker now has a list of potential valid users.

**Attack Vectors:**
- **Network:** The vulnerability can be exploited remotely over a network.
- **Login Form/API:** Attackers can trigger the vulnerability by attempting to log in through the regular login form or through the API.

**Required Attacker Capabilities/Position:**
- **No privileges required:** The attacker does not need any prior authentication or special privileges.
- **No user interaction:** The attack can be carried out without any user interaction.
- The attacker needs to be able to send login requests to the Directus instance

**Additional Information:**
- The vulnerability is present in Directus versions >= 9.11.
- It's fixed in version 10.13.0.
- The fix included an explicit provider check and removal of user suspended errors in the authentication service.
- A workaround is to disable local logins if only using SSO `AUTH_DISABLE_DEFAULT="true"`
- The vulnerability was introduced as a feature in [#13184](https://github.com/directus/directus/pull/13184)
- The vulnerability is classified as CWE-200 (Information Exposure).
- CVSS v3 score: 7.5
- CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N