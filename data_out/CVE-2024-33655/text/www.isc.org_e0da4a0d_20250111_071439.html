

[![ISC](/images/logo.png)](/)

* PRODUCTS
  + [![](/images/bind9.png)BIND 9](/bind)
  + [![](/images/kea.png)Kea](/kea)
  + [![](/images/stork80x.png)Stork](/stork)
  + [![](/images/dhcp.png)ISC DHCP](/dhcp)
* SUPPORT
  + [Software Support](/support)
  + [Advance Security Notification](/asn)
  + [Consulting and Training](/technicalservices)
  + [ISCâs Security Vulnerability Policy](https://kb.isc.org/docs/aa-00861)
  + [ISCâs Software Support Policy and Version Numbering](https://kb.isc.org/docs/aa-00896)
  + [ISCâs Knowledgebase](https://kb.isc.org)
  + [Report a Bug](/reportbug)
  + [Login for Support](https://support.isc.org/)
* COMMUNITY
  + [User Mailing Lists](/mailinglists)
  + [F-Root](/f-root)
  + [Organizations We Support](/governance)
  + [Other Software](/othersoftware)
  + [Presentations](/presentations)
  + [RFCs](/rfcs)
* ABOUT ISC
  + [Blog](/blogs)
  + [Mission & History](/about)
  + [Our Team](/team)
  + [Work for ISC](/careers)
  + [Buy Kea Hooks](/shop)
  + [ISC's Swag Store](https://shop.isc.org/)
  + [Get a Quote](/contact)

[DOWNLOADS](/download)

# Rate Limits in BIND 9 Effective vs. DNSBomb Vulnerability

## BIND 9 is Unaffected by the DNSBomb

We have been researching and testing a DNS vulnerability report called the DNSBomb ([CVE-2024-33655](https://nvd.nist.gov/vuln/detail/CVE-2024-33655)). After extensive testing, we have concluded that this technique does not pose a significant threat to BIND 9 operators. Our testing showed that with recommended configurations:

* The packet amplification factor for the client(s) is 1x (i.e. none).
* The novel part of this attack – spreading out the queries over time, and then tricking the resolver into responding within a short time window – is already sufficiently mitigated by existing limits that are in place.

### The DNSBomb Attack

The DNSBomb attack was described by [Xiang Li](https://lixiang521.com) from Tsinghua University [NISL Lab](https://netsec.ccert.edu.cn/chs/) and responsibly disclosed to multiple DNS software development teams for assessment. This is a pulsing denial-of-service attack (PDOS) that leverages features such as query rate limits, query timeouts, and maximum response size settings to create timed floods of responses using a maliciously designed authority and a vulnerable recursive resolver. Their attack also incorporates response amplification, by using specially-crafted zones on the authority to return large responses.

There are three critical steps to construct the DNSBomb attack:

1. Accumulating DNS queries (by extending the timeout window to delay responses artificially)
2. Amplifying responses (using query aggregation on the authoritative server and domains specially crafted to return large answers)
3. Collecting and “pulsing” responses to the target resolver in large batches

### Testing the Limits in BIND 9

After testing some variants of this attack vs BIND 9, we found multiple ways to limit or reduce the impact of DNSBomb on BIND 9 resolvers. Most of these are configured by default, but there are also rate limits that can be configured to further reduce the effectiveness of this attack.

These limits are effective against the DNSBomb attack:

* `clients-per-query` / `max-clients-per-query` are set by default to 10 and 100, respectively. They limit the total number of outstanding clients (requests) for any single query. In the worst case, there can be 100 outstanding requests.
* `recursive-clients` is configured by default to 1000. This limits the total number of outstanding requests. After reaching 90% of this limit (i.e. 900 requests by default), the oldest requests are dropped and can no longer contribute to the effectiveness of this attack.
* `responses-per-second` is a rate limit which can be configured to further mitigate this attack. It limits the number of UDP responses for a particular query per network segment.

### Notes on the Amplification Factor

[Amplification attacks](https://www.cloudflare.com/learning/ddos/dns-amplification-ddos-attack/) are a common problem in the DNS. DNS responses are typically much larger than the corresponding queries, so the main difference between regular query/response patterns and abusive ones is the amplification factor. Wide variations in query volume can be seen under normal operation, so we look for amplification factors of at least two orders of magnitude when considering whether an amplifier is actually a potent attack vector.

Here’s the worst case scenario for a resolver with a default configuration under the DNSBomb attack:

* The attacker (spoofing the victim’s address) sends 1000 packets over time (up to 10 seconds), while the authoritative server (under the attacker’s control) withholds the answer for that amount of time.
* Once the attacker’s authoritative server responds, the resolver answers all outstanding queries for the attacker’s domain.
* Assuming the answer is crafted to utilize the maximum packet size that will be transmitted over UDP, each answer could be 1232 bytes long. For 1000 outstanding queries, the total amount of data sent could be up to 12 MB sent within a very short time window.

The paper argues that this means a significant bandwidth amplification factor. While that may be true under ideal conditions, this attack doesn’t scale. Due to the recursive-clients limit (which defaults to 1000), any new requests will cause the oldest ones to be dropped, no longer contributing to the bandwidth amplification factor.

In other words, if the attacker sent 10k or 100k packets instead, the short data burst on the victim’s side would still be just 12 MB of data.

In real-world conditions, the attack is likely to be even less efficient, since the full impact would require that the attacker be the only client using this resolver and thus be able to utilize the entire recursive-clients limit for itself. If there are other clients, they’re likely using at least some of this quota, making the attack even less effective.

### References

* ISC’s BIND 9 GitLab issue [#4398](https://gitlab.isc.org/isc-projects/bind9/-/issues/4398). This issue will be hidden until the original reporter’s technical paper is published, currently planned for May 22, 2024 at the [IEEE Symposium on Security and Privacy](https://sp2024.ieee-security.org/program.html).
* The reporter, Xiang Li’s, homepage: <https://lixiang521.com/>
* Network and Information Security Laboratory, Tsinghua University: <https://netsec.ccert.edu.cn/>
* ISC’s [Software Defect and Security Vulnerability Disclosure Policy](https://kb.isc.org/docs/aa-00861)
* ISC’s [CVSS Scoring Guidelines](https://kb.isc.org/docs/isc-cvss-scoring-guidelines)
* The [BIND 9 Administrator Reference Manual](https://bind9.readthedocs.io/en/latest/chapter7.html) includes a section on deploying BIND securely. We assume these best practices are followed in assessing vulnerabilities.

###### AUTHOR

![author](/images/author/NoPhoto.jpg)
Posted by:
Nicki KÅÄ±ÌÅ¾ek

###### TAGS

* [BIND](/tags/bind)
* [Security](/tags/security)

###### CATEGORIES

- [BIND](/categories/bind)
- [Open Source](/categories/open-source)
- [Security](/categories/security)

###### PUBLISHED

01 May 2024

###### FOLLOW

## Recent Posts

What's New from ISC

![](/images/blog/net.jpg)

![](/images/blog/net.jpg)

Next post: [Kea 2.6.0 Released](/blogs/kea-2-6-0/)

Previous post: [BIND 9.16 Branch is approaching EOL](/blogs/2024-bind-9.16-eol/)

#### Software

* [Stork Graphical Management for Kea DHCP](/stork/)
* [BIND 9](/bind/)
* [Kea DHCP](/kea/)
* [ISC DHCP](/dhcp/)

#### Technical Resources

* [ISC Technical Knowledgebase](https://kb.isc.org)
* [BIND 9 Security Vulnerability Matrix](https://kb.isc.org/docs/aa-00913)
* [Source Repository](https://gitlab.isc.org/isc-projects)
* [EDNS Compliance Test Tool](https://ednscomp.isc.org)
* [ISC Software Licenses](/licenses)
* [DNS Tools](/dns-tools)
* [ISC DHCP Tools](/dhcp-tools)
* [Kea & IPv6 Tools](/kea-tools)
* [US Government Resources](/usgovt)

#### Other ISC Services

* [F-Root](/f-root)

#### Our Company

* [Blog](/blogs)
* [Contact](/contact)
* [Privacy Policy](/privacy)
* [Code of Conduct](/conductreporting)
* [ISCâs Mission](/about)
* [Work for ISC](/careers)
* [ISC's Swag Store](https://internet-systems-consortium.myshopify.com/)
* [RSS Feed](/index.xml)

[![ISC](/images/logo.png)](/)

##### ADDRESS

PO Box 360
 Newmarket, NH 03857 USA

##### CONTACT

* Email: info@isc.org
* Phone: +1 650 423 1300

Â© Internet Systems Consortium, Inc.

