<!DOCTYPE html>
<html lang="en">
<head>
    <title>NLnet Labs -       Unbound - Security Advisories

</title>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
<!-- Favicons START -->
<link rel="shortcut icon" href="/extra/favicons/favicon.ico" />
<link rel="icon" type="image/x-icon" href="/extra/favicons/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="/extra/favicons/Mark-NLnet-Labs-180px.png" />
<link rel="icon" type="image/png" href="/extra/favicons/favicon-196x196.png" sizes="196x196" />
<!-- Favicons END -->




<meta name="description" content="We take security very seriously. If you have found a security issue in Unbound, please submit a security report. Unbounded name compression could lead to Denial of Service Date:2024-10-03 CVE:CVE-2024-8508 Credit:Toshifumi Sakaguchi Affects:Unbound up to and including version 1.21.0 Not affected:Other versions Severity â¦" />
<meta name="keywords" content="NLnet Labs, NLnetLabs, Open Netlabs, OpenNetlabs, DNS, DNSSEC, name server, nameserver, resolver, Unbound, NSD, OpenDNSSEC, LDNS, getDNS, infosec, open source, Krill, Routinator, RPKI, BGPSEC, ROA" />
<!-- facebook open graph tags -->
<meta property="og:site_name" content="NLnet Labs" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://nlnetlabs.nl/projects/unbound/security-advisories/" />
<meta property="og:title" content="Unbound - Security Advisories" />
<meta property="og:image" content="https://nlnetlabs.nl/static/logos/NLnetLabs/Mark_NLnet_Labs.png" />
<meta property="og:description" content="We take security very seriously. If you have found a security issue in Unbound, please submit a security report. Unbounded name compression could lead to Denial of Service Date:2024-10-03 CVE:CVE-2024-8508 Credit:Toshifumi Sakaguchi Affects:Unbound up to and including version 1.21.0 Not affected:Other versions Severity â¦" />
<!-- twitter card tags additive with the og: tags -->
<meta name="twitter:card" content="summary">
<meta name="twitter:url" content="https://nlnetlabs.nl/projects/unbound/security-advisories/">
<meta name="twitter:title" content="Unbound - Security Advisories">
<meta name="twitter:description" content="We take security very seriously. If you have found a security issue in Unbound, please submit a security report. Unbounded name compression could lead to Denial of Service Date:2024-10-03 CVE:CVE-2024-8508 Credit:Toshifumi Sakaguchi Affects:Unbound up to and including version 1.21.0 Not affected:Other versions Severity â¦">
<meta name="twitter:site" content="@nlnetlabs">
<meta name="twitter:domain" content="nlnetlabs.nl">
<meta name="twitter:image:src" content="https://nlnetlabs.nl/static/logos/NLnetLabs/Mark_NLnet_Labs.png">
<meta name="twitter:creator" content="@nlnetlabs"><link rel="stylesheet" href="https://use.typekit.net/cxt3dey.css">
<link rel="stylesheet" href="/theme/css/custom.css" />
<link href="https://use.fontawesome.com/releases/v5.0.11/css/all.css" rel="stylesheet">
<script defer src="https://use.fontawesome.com/releases/v5.0.11/js/all.js"></script>
  <link href="https://nlnetlabs.nl/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="NLnet Labs Atom Feed" />
  <link href="https://nlnetlabs.nl/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="NLnet Labs RSS Feed" />

</head>

<body class="ie11-no-flex ">

<header id="banner" class="">
  <nav class="navbar navbar-expand-md navbar-light border-bottom box-shadow">
    <a class="navbar-brand" href="/">
      <img src="/static/logos/NLnetLabs/Logo_NLnet_Labs_cropped.svg" width="200" class="d-inline-block align-center img-fluid" alt="Home">
      <span class="sr-only">NLnet Labs</span>
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
      <div class="navbar-nav">
        <div class="nav-item dropdown">
            <a class="nav-item nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Software</a>
            <div class="dropdown-menu">
              <div class="sub-title">DNS</div>
              <a class="dropdown-item  " href="/projects/unbound/about/" >
                Unbound
              </a>
              <a class="dropdown-item  " href="/projects/nsd/about/" >
                NSD
              </a>
              <a class="dropdown-item  external-link" href="https://www.opendnssec.org" target="_blank">
                OpenDNSSEC
              </a>
              <a class="dropdown-item  " href="/projects/ldns/about/" >
                ldns
              </a>
              <a class="dropdown-item  " href="/projects/domain/about/" >
                domain
              </a>
              <div class="sub-title">Routing</div>
              <a class="dropdown-item  " href="/projects/routing/krill/" >
                Krill
              </a>
              <a class="dropdown-item  " href="/projects/routing/routinator/" >
                Routinator
              </a>
              <a class="dropdown-item  " href="/projects/routing/rtrtr/" >
                RTRTR
              </a>
              <a class="dropdown-item  " href="/projects/routing/rotonda/" >
                Rotonda
              </a>
            </div>
        </div>
        <div class="nav-item dropdown">
            <a class="nav-item nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Support</a>
            <div class="dropdown-menu">
              <a class="dropdown-item  " href="/support/software-support-policy/" >
                Support Policy
              </a>
              <a class="dropdown-item  " href="/support/mailing-lists/" >
                Mailing Lists
              </a>
              <a class="dropdown-item  " href="/support/security-advisories/" >
                Security Advisories
              </a>
              <div class="dropdown-divider"></div>
              <a class="dropdown-item  " href="/services/contracts/" >
                Support Contracts
              </a>
              <a class="dropdown-item  " href="/services/consultancy/" >
                Consultancy
              </a>
            </div>
        </div>
        <div class="nav-item dropdown">
            <a class="nav-item nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Documentation</a>
            <div class="dropdown-menu">
              <div class="sub-title">DNS</div>
              <a class="dropdown-item  external-link" href="https://unbound.docs.nlnetlabs.nl/" target="_blank">
                Unbound
              </a>
              <a class="dropdown-item  external-link" href="https://nsd.docs.nlnetlabs.nl/" target="_blank">
                NSD
              </a>
              <a class="dropdown-item  " href="/documentation/ldns/" >
                ldns
              </a>
              <div class="sub-title">Routing</div>
              <a class="dropdown-item  external-link" href="https://krill.docs.nlnetlabs.nl/" target="_blank">
                Krill
              </a>
              <a class="dropdown-item  external-link" href="https://routinator.docs.nlnetlabs.nl/" target="_blank">
                Routinator
              </a>
              <a class="dropdown-item  external-link" href="https://rtrtr.docs.nlnetlabs.nl/" target="_blank">
                RTRTR
              </a>
              <a class="dropdown-item  external-link" href="https://rotonda.docs.nlnetlabs.nl/" target="_blank">
                Rotonda
              </a>
            </div>
        </div>
        <div class="nav-item dropdown">
            <a class="nav-item nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Community</a>
            <div class="dropdown-menu">
              <a class="dropdown-item  " href="/community/IETF" >
                Standardisation
              </a>
              <a class="dropdown-item  " href="/community/operations" >
                Operations
              </a>
              <a class="dropdown-item  " href="/community/policy" >
                Policy
              </a>
              <a class="dropdown-item  " href="/community/presentations" >
                Presentations
              </a>
              <a class="dropdown-item  " href="/community/publications" >
                Publications
              </a>
            </div>
        </div>
        <div class="nav-item dropdown">
            <a class="nav-item nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Research</a>
            <div class="dropdown-menu">
              <a class="dropdown-item  " href="/research/about/" >
                Research Vision
              </a>
              <a class="dropdown-item  " href="/research/projects/" >
                Projects
              </a>
              <a class="dropdown-item  " href="/research/collaborations/" >
                Collaborations
              </a>
              <a class="dropdown-item  " href="/research/publications/" >
                Publications
              </a>
              <a class="dropdown-item  " href="/research/student-projects" >
                Student Projects
              </a>
              <a class="dropdown-item  " href="/research/other/" >
                Other Activities
              </a>
            </div>
        </div>
        <a class="nav-item nav-link  " href="/about/" >
          About
        </a>
        <a class="nav-item nav-link  " href="/sponsors/" >
          Sponsors
        </a>
        <a class="nav-item nav-link  external-link" href="https://blog.nlnetlabs.nl/" target="_blank">
          Blog
        </a>
      </div>
      <a href="/funding/" class="d-md-none donate-button">Support Us</a>
    </div>
    <a href="/funding/" class="d-none d-md-inline-block donate-button">Support Us</a>
  </nav>
</header>
<div class="container p-3 mt-3">
<div class="row ">

<section id="content" class="col main-content">

<div class="m-0 p-0 mb-3">
  <h1><small class="font-weight-bold">UNBOUND</small></h1>
    <ul class="list-inline">
      <li class="list-inline-item">
        <a href="/projects/unbound/about/">About</a>
        </li>
      <li class="list-inline-item">
        <a href="/projects/unbound/download/">Download</a>
        </li>
      <li class="list-inline-item">
        <a href="/projects/unbound/support/">Support</a>
        </li>
      <li class="list-inline-item">
        <a href="/projects/unbound/rfc-compliance/">RFC Compliance</a>
        </li>
      <li class="list-inline-item">
          Security Advisories
        </li>
    </ul>
  <div class="border border-black page-title-underbar"></div>
</div>
<p class="lead">We take security very seriously. If you have found a security issue in
Unbound, please <a class="reference external" href="/security-report/">submit a security report</a>.</p>
<hr class="docutils"/>
<div class="section" id="unbounded-name-compression-could-lead-to-denial-of-service">
<h2>Unbounded name compression could lead to Denial of Service</h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody>
<tr class="field"><th class="field-name">Date:</th><td class="field-body">2024-10-03</td>
</tr>
<tr class="field"><th class="field-name">CVE:</th><td class="field-body"><a class="reference external" href="/downloads/unbound/CVE-2024-8508.txt">CVE-2024-8508</a></td>
</tr>
<tr class="field"><th class="field-name">Credit:</th><td class="field-body">Toshifumi Sakaguchi</td>
</tr>
<tr class="field"><th class="field-name">Affects:</th><td class="field-body">Unbound up to and including version 1.21.0</td>
</tr>
<tr class="field"><th class="field-name">Not affected:</th><td class="field-body">Other versions</td>
</tr>
<tr class="field"><th class="field-name">Severity:</th><td class="field-body">Medium (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L)</td>
</tr>
<tr class="field"><th class="field-name">Impact:</th><td class="field-body">Possibility of DoS in orchestrated attacks</td>
</tr>
<tr class="field"><th class="field-name">Solution:</th><td class="field-body">Download patched version of Unbound, or apply the patch manually</td>
</tr>
</tbody>
</table>
<p>Malicious upstreams responses with very large RRsets can cause Unbound
to spend a considerable time applying name compression to downstream
replies. This can lead to degraded performance and eventually denial of
service in well orchestrated attacks.</p>
<p>The vulnerability can be exploited by a malicious actor querying Unbound
for the specially crafted contents of a malicious zone with very large
RRsets.
Before Unbound replies to the query it will try to apply name
compression which was an unbounded operation that could lock the CPU
until the whole packet was complete.</p>
<p>Unbound version 1.21.1 introduces a hard limit on the number of name
compression calculations it is willing to do per packet.
Packets that need more compression will result in semi-compressed
packets or truncated packets, even on TCP for huge messages, to avoid
locking the CPU for long.</p>
<p>This change should not affect normal DNS traffic.</p>
<p><a class="reference external" href="/projects/unbound/download/#unbound-1-21-1">Unbound 1.21.1</a> contains a patch.
If you cannot upgrade you can also apply
<a class="reference external" href="/downloads/unbound/patch_CVE-2024-8508.diff">the patch</a>
manually.
To do this, apply the patch on the Unbound source directory with
<tt class="docutils literal">patch <span class="pre">-p1</span> &lt; <span class="pre">patch_CVE-2024-8508.diff</span></tt> and then run
<tt class="docutils literal">make install</tt> to install Unbound.</p>
</div>
<hr class="docutils"/>
<div class="section" id="unbound-vulnerable-to-the-dnsbomb-pulsing-dos-amplification-attack">
<h2>Unbound vulnerable to the "DNSBomb" pulsing DoS amplification attack</h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody>
<tr class="field"><th class="field-name">Date:</th><td class="field-body">2024-05-08</td>
</tr>
<tr class="field"><th class="field-name">CVE:</th><td class="field-body"><a class="reference external" href="/downloads/unbound/CVE-2024-33655.txt">CVE-2024-33655</a></td>
</tr>
<tr class="field"><th class="field-name">Credit:</th><td class="field-body">Xiang Li (Network and Information Security Lab, Tsinghua University)</td>
</tr>
<tr class="field"><th class="field-name">Affects:</th><td class="field-body">Unbound up to and including version 1.19.3</td>
</tr>
<tr class="field"><th class="field-name">Not affected:</th><td class="field-body">Other versions</td>
</tr>
<tr class="field"><th class="field-name">Severity:</th><td class="field-body">Low</td>
</tr>
<tr class="field"><th class="field-name">Impact:</th><td class="field-body">Possibility of participation in the pulsing DoS amplification attack</td>
</tr>
<tr class="field"><th class="field-name">Solution:</th><td class="field-body">Download patched version of Unbound, or apply the patch manually</td>
</tr>
</tbody>
</table>
<p>The DNSBomb attack, via specially timed DNS queries and answers, can
cause a Denial of Service on resolvers and spoofed targets.</p>
<p>Unbound itself is not vulnerable for DoS, rather it can be used to take
part in a pulsing DoS amplification attack.</p>
<p>The DNSBomb attack works by sending low-rate spoofed queries for a
malicious zone to Unbound. By controlling the delay of the malicious
authoritative answers, Unbound slowly accumulates pending answers for
the spoofed addresses. When the authoritative answers become available
to Unbound at the same time, Unbound starts serving all the accumulated
queries. This results into large-sized, concentrated response bursts
to the spoofed addresses.</p>
<p>From version 1.20.0 on, Unbound introduces a couple of configuration
options to help mitigate the impact.
Their complete description can be found in the included manpages but
they are also briefly listed here together with their current default
values for convenience:</p>
<ul>
<li><p class="first">discard-timeout: 1900</p>
<p>After 1900 ms a reply to the client will be dropped.
Unbound would still work on the query but refrain from replying in
order to not accumulate a huge number of "old" replies.
Legitimate clients retry on timeouts.</p>
</li>
<li><p class="first">wait-limit: 1000 / wait-limit-cookie: 10000</p>
<p>Limits the amount of client queries that require recursion
(cache-hits are not counted) per IP address. More recursive queries
than the allowed limit are dropped. Clients with a valid EDNS Cookie
can have a different limit, higher by default.
wait-limit: 0 disables all wait limits.</p>
</li>
<li><p class="first">wait-limit-netblock / wait-limit-cookie-netblock</p>
<p>These do not have a default value but they can fine grain
configuration for specific netblocks. With or without EDNS Cookies.</p>
</li>
</ul>
<p>The options above are trying to shrink the DNSBomb window so that the
impact of the DoS from Unbound is significantly lower than it used to be
and making the attack, and Unbound's participation, less tempting for
attackers.</p>
<p><a class="reference external" href="/projects/unbound/download/#unbound-1-20-0">Unbound 1.20.0</a> contains a patch.
If you cannot upgrade you can also apply
<a class="reference external" href="/downloads/unbound/patch_CVE-2024-33655.diff">the patch</a>
manually.
To do this, apply the patch on the Unbound source directory with
<tt class="docutils literal">patch <span class="pre">-p1</span> &lt; <span class="pre">patch_CVE-2024-33655.diff</span></tt> and then run
<tt class="docutils literal">make install</tt> to install Unbound.</p>
</div>
<hr class="docutils"/>
<div class="section" id="denial-of-service-when-trimming-ede-text-on-positive-replies">
<h2>Denial of service when trimming EDE text on positive replies</h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody>
<tr class="field"><th class="field-name">Date:</th><td class="field-body">2024-03-07</td>
</tr>
<tr class="field"><th class="field-name">CVE:</th><td class="field-body"><a class="reference external" href="/downloads/unbound/CVE-2024-1931.txt">CVE-2024-1931</a></td>
</tr>
<tr class="field"><th class="field-name">Credit:</th><td class="field-body">Fredrik Pettai and Patrik Lundin from SUNET</td>
</tr>
<tr class="field"><th class="field-name">Affects:</th><td class="field-body">Unbound version 1.18.0 up to and including version 1.19.1</td>
</tr>
<tr class="field"><th class="field-name">Not affected:</th><td class="field-body">Other versions, or 'ede: no' configurations</td>
</tr>
<tr class="field"><th class="field-name">Severity:</th><td class="field-body">High (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H)</td>
</tr>
<tr class="field"><th class="field-name">Impact:</th><td class="field-body">Denial of service when a vulnerable code path leads to an infinite loop</td>
</tr>
<tr class="field"><th class="field-name">Solution:</th><td class="field-body">Download patched version of Unbound, or use 'ede: no' (default), or apply the patch manually</td>
</tr>
</tbody>
</table>
<p>Unbound 1.18.0 introduced a feature that removes EDE records from
responses with size higher than the client's advertised buffer size.
Before removing all the EDE records however, it would try to see if
trimming the extra text fields on those records would result in an
acceptable size while still retaining the EDE codes.
Due to an unchecked condition, the code that trims the text of the EDE
records could loop indefinitely.
This happens when Unbound would reply with attached EDE information on a
positive reply and the client's buffer size is smaller than the needed
space to include EDE records.</p>
<p>The vulnerability can only be triggered when the 'ede: yes' option is
used; non default configuration.</p>
<p>From version 1.19.2 on, the code is fixed to avoid looping indefinitely.</p>
<p><a class="reference external" href="/projects/unbound/download/#unbound-1-19-2">Unbound 1.19.2</a> contains a patch.
If you cannot upgrade you can also apply
<a class="reference external" href="/downloads/unbound/patch_CVE-2024-1931.diff">the patch</a>
manually.
To do this, apply the patch on the Unbound source directory with
<tt class="docutils literal">patch <span class="pre">-p1</span> &lt; <span class="pre">patch_CVE-2024-1931.diff</span></tt> and then run
<tt class="docutils literal">make install</tt> to install Unbound.</p>
</div>
<hr class="docutils"/>
<div class="section" id="dnssec-verification-complexity-can-be-exploited-to-exhaust-cpu-resources-and-stall-dns-resolvers">
<h2>DNSSEC verification complexity can be exploited to exhaust CPU resources and stall DNS resolvers</h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody>
<tr class="field"><th class="field-name">Date:</th><td class="field-body">2024-02-13</td>
</tr>
<tr class="field"><th class="field-name">CVE:</th><td class="field-body"><a class="reference external" href="/downloads/unbound/CVE-2023-50387_CVE-2023-50868.txt">CVE-2023-50387</a></td>
</tr>
<tr class="field"><th class="field-name">Credit:</th><td class="field-body">Elias Heftrig, Haya Schulmann, Niklas Vogel, and Michael Waidner from the German National Research Center for Applied Cybersecurity ATHENE</td>
</tr>
<tr class="field"><th class="field-name">Affects:</th><td class="field-body">Unbound up to and including version 1.19.0</td>
</tr>
<tr class="field"><th class="field-name">Not affected:</th><td class="field-body">Other versions</td>
</tr>
<tr class="field"><th class="field-name">Severity:</th><td class="field-body">High</td>
</tr>
<tr class="field"><th class="field-name">Impact:</th><td class="field-body">DNSSEC validation can lead to DoS in trivially orchestrated attacks</td>
</tr>
<tr class="field"><th class="field-name">Solution:</th><td class="field-body">Download patched version of Unbound, or apply the patch manually</td>
</tr>
</tbody>
</table>
<p>A DNSSEC validation vulnerability has been discovered in various DNSSEC
validating software. The vulnerability has an assigned number of CVE-2023-50387
and is referred here as the KeyTrap vulnerability.</p>
<p>The KeyTrap vulnerability works by using a combination of Keys (also colliding
Keys), Signatures and number of RRSETs on a malicious zone.
Answers from that zone can force a DNSSEC validator down a very CPU intensive
and time costly validation path.</p>
<p>It can force Unbound to spend an enormous time (comparative to regular
traffic) validating a single specially crafted DNSSEC response while everything
else is on hold for that thread. A trivially orchestrated attack could render
all threads busy with such responses leading to denial of service.</p>
<p>From version 1.19.1 on, Unbound introduces suspension on DNSSEC response
validations that seem to require more attempts than Unbound is willing to make
per response validation run. Suspension means that Unbound will continue with
other work before resuming a suspended validation offering CPU time between
validation resumptions to other tasks. There is a backoff timer when
suspending which is further influenced by the number of suspends already used
and the amount of work currently in Unbound.</p>
<p>The introduced builtin limits in Unbound are:</p>
<ul class="simple">
<li>Max 4 DNSSEC key collissions are allowed when building chain of trust.
More than that without a secure key treats the delegation as bogus.</li>
<li>8 validation attempts per RRSET (combination of keys + signatures).
If more are needed and Unbound has yet to find a valid signature
the RRSET is treated as bogus.</li>
<li>More than 8 validation attempts per answer will suspend validation.</li>
<li>The limit of total suspensions is 16 after which the query will error
out. Any completed RRSET validations populate the cache for use in
future queries.</li>
</ul>
<p>While under attack Unbound could show higher CPU load because of the needed
validations but the suspend strategy would guarantee the CPU is not locked on
any particular validation task.</p>
<p><a class="reference external" href="/projects/unbound/download/#unbound-1-19-1">Unbound 1.19.1</a> contains a patch.
If you cannot upgrade you can also apply
<a class="reference external" href="/downloads/unbound/patch_CVE-2023-50387_CVE-2023-50868.diff">the patch</a>
manually.
To do this, apply the patch on the Unbound source directory with
<tt class="docutils literal">patch <span class="pre">-p1</span> &lt; <span class="pre">patch_CVE-2023-50387_CVE-2023-50868.diff</span></tt> and then run
<tt class="docutils literal">make install</tt> to install Unbound.</p>
<p><em>This is a shared patch with CVE-2023-50868 below</em></p>
</div>
<hr class="docutils"/>
<div class="section" id="nsec3-closest-encloser-proof-can-exhaust-cpu">
<h2>NSEC3 closest encloser proof can exhaust CPU</h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody>
<tr class="field"><th class="field-name">Date:</th><td class="field-body">2024-02-13</td>
</tr>
<tr class="field"><th class="field-name">CVE:</th><td class="field-body"><a class="reference external" href="/downloads/unbound/CVE-2023-50387_CVE-2023-50868.txt">CVE-2023-50868</a></td>
</tr>
<tr class="field"><th class="field-name">Credit:</th><td class="field-body">Petr Å paÄek from ISC</td>
</tr>
<tr class="field"><th class="field-name">Affects:</th><td class="field-body">Unbound up to and including version 1.19.0</td>
</tr>
<tr class="field"><th class="field-name">Not affected:</th><td class="field-body">Other versions</td>
</tr>
<tr class="field"><th class="field-name">Severity:</th><td class="field-body">High</td>
</tr>
<tr class="field"><th class="field-name">Impact:</th><td class="field-body">DNSSEC validation can lead to DoS in trivially orchestrated attacks</td>
</tr>
<tr class="field"><th class="field-name">Solution:</th><td class="field-body">Download patched version of Unbound, or apply the patch manually</td>
</tr>
</tbody>
</table>
<p>A DNSSEC validation vulnerability has been discovered in various DNSSEC
validating software. The vulnerability has an assigned number of CVE-2023-50868
and is referred here as the NSEC3 vulnerability.</p>
<p>The NSEC3 vulnerability uses specially crafted responses on a malicious zone
with multiple NSEC3 RRSETs to force a DNSSEC validator down a very CPU
intensive and time costly NSEC3 hash calculation path.</p>
<p>It can force Unbound to spend an enormous time (comparative to regular
traffic) validating a single specially crafted DNSSEC response while everything
else is on hold for that thread. A trivially orchestrated attack could render
all threads busy with such responses leading to denial of service.</p>
<p>From version 1.19.1 on, Unbound introduces suspension on DNSSEC response
validations that seem to require more attempts than Unbound is willing to make
per response validation run. Suspension means that Unbound will continue with
other work before resuming a suspended validation offering CPU time between
validation resumptions to other tasks. There is a backoff timer when
suspending which is further influenced by the number of suspends already used
and the amount of work currently in Unbound.</p>
<p>The introduced builtin limits for the NSEC3 vulnerability in Unbound are:</p>
<ul class="simple">
<li>8 NSEC3 hash calculations are allowed before suspension. More than that will
suspend validation.</li>
<li>The limit of total suspensions is 16 after which the query will error
out. Any completed RRSET validations populate the cache for use in
future queries.</li>
</ul>
<p>While under attack Unbound could show higher CPU load because of the needed
validations but the suspend strategy would guarantee the CPU is not locked on
any particular validation task.</p>
<p><a class="reference external" href="/projects/unbound/download/#unbound-1-19-1">Unbound 1.19.1</a> contains a patch.
If you cannot upgrade you can also apply
<a class="reference external" href="/downloads/unbound/patch_CVE-2023-50387_CVE-2023-50868.diff">the patch</a>
manually.
To do this, apply the patch on the Unbound source directory with
<tt class="docutils literal">patch <span class="pre">-p1</span> &lt; <span class="pre">patch_CVE-2023-50387_CVE-2023-50868.diff</span></tt> and then run
<tt class="docutils literal">make install</tt> to install Unbound.</p>
<p><em>This is a shared patch with CVE-2023-50387 above</em></p>
</div>
<hr class="docutils"/>
<div class="section" id="non-responsive-delegation-attack">
<h2>Non-Responsive Delegation Attack</h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody>
<tr class="field"><th class="field-name">Date:</th><td class="field-body">2022-09-21</td>
</tr>
<tr class="field"><th class="field-name">CVE:</th><td class="field-body"><a class="reference external" href="/downloads/unbound/CVE-2022-3204.txt">CVE-2022-3204</a></td>
</tr>
<tr class="field"><th class="field-name">Credit:</th><td class="field-body">Yehuda Afek (Tel-Aviv University), Anat Bremler-Barr &amp; Shani Stajnrod (Reichman University)</td>
</tr>
<tr class="field"><th class="field-name">Affects:</th><td class="field-body">Unbound up to and including version 1.16.2</td>
</tr>
<tr class="field"><th class="field-name">Not affected:</th><td class="field-body">Other versions</td>
</tr>
<tr class="field"><th class="field-name">Severity:</th><td class="field-body">Medium</td>
</tr>
<tr class="field"><th class="field-name">Impact:</th><td class="field-body">Possibility of DoS in orchestrated attacks</td>
</tr>
<tr class="field"><th class="field-name">Solution:</th><td class="field-body">Download patched version of Unbound, or apply the patch manually</td>
</tr>
</tbody>
</table>
<p>A vulnerability named 'Non-Responsive Delegation Attack' (NRDelegation Attack)
has been discovered in various DNS resolving software. The NRDelegation Attack
works by having a malicious delegation with a considerable number of non
responsive nameservers. The attack starts by querying a resolver for a record
that relies on those unresponsive nameservers.</p>
<p>The attack can cause a resolver to spend a lot of time/resources resolving
records under a malicious delegation point where a considerable number of
unresponsive NS records reside. It can trigger high CPU usage in some resolver
implementations that continually look in the cache for resolved NS records in
that delegation. This can lead to degraded performance and eventually denial
of service in orchestrated attacks.</p>
<p>Unbound does not suffer from high CPU usage, but resources are still needed for
resolving the malicious delegation. Unbound will keep trying to resolve the
record until hard limits are reached. Based on the nature of the attack and the
replies, different limits could be reached.</p>
<p>From version 1.16.3 on, Unbound introduces fixes for better performance when
under load, by cutting opportunistic queries for nameserver discovery and
DNSKEY prefetching and limiting the number of times a delegation point can
issue a cache lookup for missing records.</p>
<p><a class="reference external" href="/projects/unbound/download/#unbound-1-16-3">Unbound 1.16.3</a> contains a patch.
If you cannot upgrade you can also apply
<a class="reference external" href="/downloads/unbound/patch_CVE-2022-3204.diff">the patch</a>
manually.
To do this, apply the patch on the Unbound source directory with
<tt class="docutils literal">patch <span class="pre">-p1</span> &lt; <span class="pre">patch_CVE-2022-3204.diff</span></tt> and then run
<tt class="docutils literal">make install</tt> to install Unbound.</p>
</div>
<hr class="docutils"/>
<div class="section" id="novel-ghost-domain-names-attack-by-updating-almost-expired-delegation-information">
<h2>Novel "ghost domain names" attack by updating almost expired delegation information</h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody>
<tr class="field"><th class="field-name">Date:</th><td class="field-body">2022-08-01</td>
</tr>
<tr class="field"><th class="field-name">CVE:</th><td class="field-body"><a class="reference external" href="/downloads/unbound/CVE-2022-30698_CVE-2022-30699.txt">CVE-2022-30699</a></td>
</tr>
<tr class="field"><th class="field-name">Credit:</th><td class="field-body">Xiang Li (Network and Information Security Lab, Tsinghua University)</td>
</tr>
<tr class="field"><th class="field-name">Affects:</th><td class="field-body">Unbound up to and including version 1.16.1</td>
</tr>
<tr class="field"><th class="field-name">Not affected:</th><td class="field-body">Other versions</td>
</tr>
<tr class="field"><th class="field-name">Severity:</th><td class="field-body">Medium</td>
</tr>
<tr class="field"><th class="field-name">Impact:</th><td class="field-body">Remote attackers can trigger continued resolvability of revoked domain names</td>
</tr>
<tr class="field"><th class="field-name">Solution:</th><td class="field-body">Download patched version of Unbound, or apply the patch manually</td>
</tr>
</tbody>
</table>
<p>NLnet Labs Unbound, up to and including version 1.16.1, is vulnerable to a
novel type of the "ghost domain names" attack. The vulnerability works by
targeting an Unbound instance. Unbound is queried for a rogue domain name when
the cached delegation information is about to expire. The rogue nameserver
delays the response so that the cached delegation information is expired. Upon
receiving the delayed answer containing the delegation information, Unbound
overwrites the now expired entries. This action can be repeated when the
delegation information is about to expire making the rogue delegation
information ever-updating. From version 1.16.2 on, Unbound stores the start
time for a query and uses that to decide if the cached delegation information
can be overwritten.</p>
<p><a class="reference external" href="/projects/unbound/download/#unbound-1-16-2">Unbound 1.16.2</a> contains a patch.
If you cannot upgrade you can also apply
<a class="reference external" href="/downloads/unbound/patch_CVE-2022-30698_CVE-2022-30699.diff">the patch</a>
manually.
To do this, apply the patch on the Unbound source directory with
<tt class="docutils literal">patch <span class="pre">-p1</span> &lt; <span class="pre">patch_CVE-2022-30698_CVE-2022-30699.diff</span></tt> and then run
<tt class="docutils literal">make install</tt> to install Unbound.</p>
<p><em>This is a shared patch with CVE-2022-30698 below</em></p>
</div>
<hr class="docutils"/>
<div class="section" id="novel-ghost-domain-names-attack-by-introducing-subdomain-delegations">
<h2>Novel "ghost domain names" attack by introducing subdomain delegations</h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody>
<tr class="field"><th class="field-name">Date:</th><td class="field-body">2022-08-01</td>
</tr>
<tr class="field"><th class="field-name">CVE:</th><td class="field-body"><a class="reference external" href="/downloads/unbound/CVE-2022-30698_CVE-2022-30699.txt">CVE-2022-30698</a></td>
</tr>
<tr class="field"><th class="field-name">Credit:</th><td class="field-body">Xiang Li (Network and Information Security Lab, Tsinghua University)</td>
</tr>
<tr class="field"><th class="field-name">Affects:</th><td class="field-body">Unbound up to and including version 1.16.1</td>
</tr>
<tr class="field"><th class="field-name">Not affected:</th><td class="field-body">Other versions</td>
</tr>
<tr class="field"><th class="field-name">Severity:</th><td class="field-body">Medium</td>
</tr>
<tr class="field"><th class="field-name">Impact:</th><td class="field-body">Remote attackers can trigger continued resolvability of revoked domain names</td>
</tr>
<tr class="field"><th class="field-name">Solution:</th><td class="field-body">Download patched version of Unbound, or apply the patch manually</td>
</tr>
</tbody>
</table>
<p>NLnet Labs Unbound, up to and including version 1.16.1 is vulnerable to a novel
type of the "ghost domain names" attack. The vulnerability works by targeting
an Unbound instance. Unbound is queried for a subdomain of a rogue domain name.
The rogue nameserver returns delegation information for the subdomain that
updates Unbound's delegation cache. This action can be repeated before expiry
of the delegation information by querying Unbound for a second level subdomain
which the rogue nameserver provides new delegation information. Since Unbound
is a child-centric resolver, the ever-updating child delegation information can
keep a rogue domain name resolvable long after revocation. From version 1.16.2
on, Unbound checks the validity of parent delegation records before using
cached delegation information.</p>
<p><a class="reference external" href="/projects/unbound/download/#unbound-1-16-2">Unbound 1.16.2</a> contains a patch.
If you cannot upgrade you can also apply
<a class="reference external" href="/downloads/unbound/patch_CVE-2022-30698_CVE-2022-30699.diff">the patch</a>
manually.
To do this, apply the patch on the Unbound source directory with
<tt class="docutils literal">patch <span class="pre">-p1</span> &lt; <span class="pre">patch_CVE-2022-30698_CVE-2022-30699.diff</span></tt> and then run
<tt class="docutils literal">make install</tt> to install Unbound.</p>
<p><em>This is a shared patch with CVE-2022-30699 above</em></p>
</div>
<hr class="docutils"/>
<div class="section" id="local-symlink-attack">
<h2>Local symlink attack</h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody>
<tr class="field"><th class="field-name">Date:</th><td class="field-body">2020-12-01</td>
</tr>
<tr class="field"><th class="field-name">CVE:</th><td class="field-body"><a class="reference external" href="/downloads/unbound/CVE-2020-28935.txt">CVE-2020-28935</a></td>
</tr>
<tr class="field"><th class="field-name">Credit:</th><td class="field-body">Mason Loring Bliss</td>
</tr>
<tr class="field"><th class="field-name">Affects:</th><td class="field-body">Unbound up to and including version 1.12.0</td>
</tr>
<tr class="field"><th class="field-name">Not affected:</th><td class="field-body">Other versions</td>
</tr>
<tr class="field"><th class="field-name">Severity:</th><td class="field-body">Low</td>
</tr>
<tr class="field"><th class="field-name">Impact:</th><td class="field-body">Denial of Service</td>
</tr>
<tr class="field"><th class="field-name">Solution:</th><td class="field-body">Download patched version of Unbound, or apply the patch manually</td>
</tr>
</tbody>
</table>
<p>Unbound when writing and later chown'ing the PID file would not check if an
existing file was a symlink.
This is a local vulnerability that could create a Denial of Service of the
system Unbound is running on. It requires an attacker having access to the
limited permission user Unbound runs as and point through the symlink to a
critical file on the system.</p>
<p><a class="reference external" href="/projects/unbound/download/#unbound-1-13-0">Unbound 1.13.0</a> contains a patch.
If you cannot upgrade you can also apply
<a class="reference external" href="/downloads/unbound/patch_cve-2020-28935_unbound.diff">the patch</a> manually.
To do this, apply the patch on the Unbound source directory with
<tt class="docutils literal">patch <span class="pre">-p1</span> &lt; <span class="pre">patch_cve-2020-28935_unbound.diff</span></tt> and then run <tt class="docutils literal">make install</tt>
to install Unbound.</p>
</div>
<hr class="docutils"/>
<div class="section" id="vulnerability-in-domain-parse">
<h2>Vulnerability in Domain Parse</h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody>
<tr class="field"><th class="field-name">Date:</th><td class="field-body">2020-05-19</td>
</tr>
<tr class="field"><th class="field-name">CVE:</th><td class="field-body"><a class="reference external" href="/downloads/unbound/CVE-2020-12662_2020-12663.txt">CVE-2020-12663</a></td>
</tr>
<tr class="field"><th class="field-name">Credit:</th><td class="field-body">OSS-Fuzz project</td>
</tr>
<tr class="field"><th class="field-name">Affects:</th><td class="field-body">Unbound up to and including version 1.10.0</td>
</tr>
<tr class="field"><th class="field-name">Not affected:</th><td class="field-body">Other versions</td>
</tr>
<tr class="field"><th class="field-name">Severity:</th><td class="field-body">Medium</td>
</tr>
<tr class="field"><th class="field-name">Impact:</th><td class="field-body">Unbound is unresponsive</td>
</tr>
<tr class="field"><th class="field-name">Solution:</th><td class="field-body">Download patched version of Unbound, or apply the patch manually</td>
</tr>
</tbody>
</table>
<p>Fuzzing of the Unbound code made us aware of issues in the parser of
received answers. Malformed answers received from upstream servers can
result in Unbound entering an infinite loop and thereby becoming
unresponsive. When compiled with --enable-debug it is also possible to
trigger an assertion, resulting in Unbound to crash.</p>
<p><a class="reference external" href="/projects/unbound/download/#unbound-1-10-1">Unbound 1.10.1</a> contains a patch.
If you cannot upgrade you can also apply
<a class="reference external" href="/downloads/unbound/patch_cve_2020-12662_2020-12663.diff">the patch</a>
manually.
To do this, apply the patch on Unbound source directory with
<tt class="docutils literal">patch <span class="pre">-p1</span> &lt; filename</tt>, then run <tt class="docutils literal">make install</tt> to install Unbound.</p>
</div>
<hr class="docutils"/>
<div class="section" id="nxnsattack">
<h2>NXNSAttack</h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody>
<tr class="field"><th class="field-name">Date:</th><td class="field-body">2020-05-19</td>
</tr>
<tr class="field"><th class="field-name">CVE:</th><td class="field-body"><a class="reference external" href="/downloads/unbound/CVE-2020-12662_2020-12663.txt">CVE-2020-12662</a></td>
</tr>
<tr class="field"><th class="field-name">Credit:</th><td class="field-body">Lior Shafir, Yehuda Afek, and Anat Bremler-Barr from Tel Aviv University</td>
</tr>
<tr class="field"><th class="field-name">Affects:</th><td class="field-body">Unbound up to and including version 1.10.0</td>
</tr>
<tr class="field"><th class="field-name">Not affected:</th><td class="field-body">Other versions</td>
</tr>
<tr class="field"><th class="field-name">Severity:</th><td class="field-body">Medium</td>
</tr>
<tr class="field"><th class="field-name">Impact:</th><td class="field-body">Unbound performs amplification</td>
</tr>
<tr class="field"><th class="field-name">Solution:</th><td class="field-body">Download patched version of Unbound, or apply the patch manually</td>
</tr>
</tbody>
</table>
<p>Researchers from Tel Aviv University discovered an issue in Unbound and
other DNS resolvers that makes it possible to have a single incoming
query result in a large number of outgoing queries. This amplification
makes it possible for Unbound to be used in a denial of service
attack. The researchers discovering this called this attack the NXNSattack.</p>
<p>This attack makes use of cache bypassing using random subdomains in the
NSDNAME in NS records. When these delegation records are received during
iteration, and the answer does not contain glue records, a resolver has
to send out a query to the get the IP address for one of the names. When
this query fails (for example because the random name does not exist) a
resolver will try the next one. A large set of NS records with random
names can result in a large number of outgoing queries going to the same
target. More details about this attack will be available in the research
paper.</p>
<p><a class="reference external" href="/projects/unbound/download/#unbound-1-10-1">Unbound 1.10.1</a> contains a patch.
If you cannot upgrade you can also apply <a class="reference external" href="/downloads/unbound/patch_cve_2020-12662_2020-12663.diff">the patch</a> manually.
To do this, apply the patch on Unbound source directory with <tt class="docutils literal">patch <span class="pre">-p1</span> &lt; filename</tt>, then run <tt class="docutils literal">make install</tt> to install Unbound.</p>
</div>
<hr class="docutils"/>
<div class="section" id="vulnerability-in-ipsec-module">
<h2>Vulnerability in IPSEC module</h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody>
<tr class="field"><th class="field-name">Date:</th><td class="field-body">2019-11-19</td>
</tr>
<tr class="field"><th class="field-name">CVE:</th><td class="field-body"><a class="reference external" href="/downloads/unbound/CVE-2019-18934.txt">CVE-2019-18934</a></td>
</tr>
<tr class="field"><th class="field-name">Credit:</th><td class="field-body">X41 D-Sec</td>
</tr>
<tr class="field"><th class="field-name">Affects:</th><td class="field-body">Unbound 1.6.4 up to and including version 1.9.4</td>
</tr>
<tr class="field"><th class="field-name">Not affected:</th><td class="field-body">Other versions</td>
</tr>
<tr class="field"><th class="field-name">Severity:</th><td class="field-body">Critical</td>
</tr>
<tr class="field"><th class="field-name">Impact:</th><td class="field-body">Shell code execution after a specially crafted answer</td>
</tr>
<tr class="field"><th class="field-name">Solution:</th><td class="field-body">Download patched version of Unbound, or apply the patch manually</td>
</tr>
</tbody>
</table>
<p>Due to unsanitized characters passed to the <tt class="docutils literal"><span class="pre">ipsecmod-hook</span></tt> shell command,
it is possible for Unbound to allow shell code execution from a
specially crafted IPSECKEY answer.</p>
<p>This issue can only be triggered when <em>all</em> of the below conditions are met:</p>
<ul class="simple">
<li>unbound was compiled with <tt class="docutils literal"><span class="pre">--enable-ipsecmod</span></tt> support, and</li>
<li>ipsecmod is enabled and used in the configuration (either in the
configuration file or using <tt class="docutils literal"><span class="pre">unbound-control</span></tt>), and</li>
<li>a domain is part of the <tt class="docutils literal"><span class="pre">ipsecmod-whitelist</span></tt> (if ipsecmod-whitelist is
used), and</li>
<li>unbound receives an A/AAAA query for a domain that has an A/AAAA
record(s) <em>and</em> an IPSECKEY record(s) available.</li>
</ul>
<p>The shell code execution can then happen if either the qname or the
gateway field of the IPSECKEY (when gateway type == 3) contain a
specially crafted domain name.</p>
<p><a class="reference external" href="/projects/unbound/download/#unbound-1-9-5">Unbound 1.9.5</a> contains a patch.
If you cannot upgrade you can also apply <a class="reference external" href="/downloads/unbound/patch_cve_2019-18934.diff">the patch</a> manually.
To do this, apply the patch on Unbound source directory with <tt class="docutils literal">patch <span class="pre">-p1</span> &lt; filename</tt>, then run <tt class="docutils literal">make install</tt> to install Unbound.</p>
</div>
<hr class="docutils"/>
<div class="section" id="vulnerability-in-parsing-notify-queries">
<h2>Vulnerability in parsing NOTIFY queries</h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody>
<tr class="field"><th class="field-name">Date:</th><td class="field-body">2019-10-03</td>
</tr>
<tr class="field"><th class="field-name">CVE:</th><td class="field-body"><a class="reference external" href="/downloads/unbound/CVE-2019-16866.txt">CVE-2019-16866</a></td>
</tr>
<tr class="field"><th class="field-name">Credit:</th><td class="field-body">X41 D-Sec</td>
</tr>
<tr class="field"><th class="field-name">Affects:</th><td class="field-body">Unbound 1.7.1 up to and including version 1.9.3</td>
</tr>
<tr class="field"><th class="field-name">Not affected:</th><td class="field-body">Other versions</td>
</tr>
<tr class="field"><th class="field-name">Severity:</th><td class="field-body">Medium</td>
</tr>
<tr class="field"><th class="field-name">Impact:</th><td class="field-body">Crash after receiving a specially crafted query</td>
</tr>
<tr class="field"><th class="field-name">Solution:</th><td class="field-body">Download patched version of Unbound, or apply the patch manually</td>
</tr>
</tbody>
</table>
<p>Due to an error in parsing NOTIFY queries, it is possible for Unbound to
continue processing malformed queries and may ultimately result in a
pointer dereference in uninitialized memory. This results in a crash of
the Unbound daemon.</p>
<p><a class="reference external" href="/projects/unbound/download/#unbound-1-9-4">Unbound 1.9.4</a> contains a patch. If you cannot upgrade you can also apply <a class="reference external" href="/downloads/unbound/patch_cve_2019-16866.diff">the patch</a> manually. To do this, apply the patch on Unbound source directory with <tt class="docutils literal">patch <span class="pre">-p0</span> &lt; filename</tt>, then run <tt class="docutils literal">make install</tt> to install Unbound.</p>
</div>
<hr class="docutils"/>
<div class="section" id="vulnerability-in-the-processing-of-wildcard-synthesized-nsec-records">
<h2>Vulnerability in the processing of wildcard synthesized NSEC records</h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody>
<tr class="field"><th class="field-name">Date:</th><td class="field-body">2018-01-23</td>
</tr>
<tr class="field"><th class="field-name">CVE:</th><td class="field-body"><a class="reference external" href="/downloads/unbound/CVE-2017-15105.txt">CVE-2017-15105</a></td>
</tr>
<tr class="field"><th class="field-name">Credit:</th><td class="field-body">Ralph Dolmans (NLnet Labs), Karst Koymans (University of Amsterdam)</td>
</tr>
<tr class="field"><th class="field-name">Affects:</th><td class="field-body">Unbound 1.6.7 and earlier versions</td>
</tr>
<tr class="field"><th class="field-name">Not affected:</th><td class="field-body">Other versions</td>
</tr>
<tr class="field"><th class="field-name">Severity:</th><td class="field-body">Medium</td>
</tr>
<tr class="field"><th class="field-name">Impact:</th><td class="field-body">The wildcard NSEC record can be used to prove the non-existence (NXDOMAIN answer) of an existing wildcard record</td>
</tr>
<tr class="field"><th class="field-name">Solution:</th><td class="field-body">Download patched version of Unbound, or apply the patch manually</td>
</tr>
</tbody>
</table>
<p>We discovered a vulnerability in the processing of wildcard synthesized NSEC records. While synthesis of NSEC records is allowed by RFC4592, these synthesized owner names should not be used in the NSEC processing. This does, however, happen in Unbound 1.6.7 and earlier versions.</p>
<p><a class="reference external" href="/projects/unbound/download/#unbound-1-6-8">Unbound 1.6.8</a> contains a patch. If you cannot upgrade you can also apply <a class="reference external" href="/downloads/unbound/patch_cve_2017_15105.diff">the patch</a> manually. To do this, apply the patch on Unbound source directory with <tt class="docutils literal">patch <span class="pre">-p0</span> &lt; filename</tt>, then run <tt class="docutils literal">make install</tt> to install Unbound.</p>
<p>A special thanks goes out to Karst Koymans (University of Amsterdam) for sparking the discovery of this vulnerability by Ralph Dolmans (NLnet Labs).</p>
</div>
<hr class="docutils"/>
<div class="section" id="ghost-domain-names-attack">
<h2>Ghost domain names attack</h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody>
<tr class="field"><th class="field-name">Date:</th><td class="field-body">2012-02-17</td>
</tr>
<tr class="field"><th class="field-name">CVE:</th><td class="field-body">CVE-2012-1192</td>
</tr>
<tr class="field"><th class="field-name">Credit:</th><td class="field-body">ISC</td>
</tr>
<tr class="field"><th class="field-name">Affects:</th><td class="field-body">Unbound 1.4.11 and earlier versions</td>
</tr>
<tr class="field"><th class="field-name">Not affected:</th><td class="field-body">Other versions</td>
</tr>
<tr class="field"><th class="field-name">Severity:</th><td class="field-body">Medium</td>
</tr>
<tr class="field"><th class="field-name">Impact:</th><td class="field-body">Remote attackers can trigger continued resolvability of revoked domain names</td>
</tr>
<tr class="field"><th class="field-name">Solution:</th><td class="field-body">Upgrade to a newer version of Unbound</td>
</tr>
</tbody>
</table>
<p>The resolver in Unbound before 1.4.11 overwrites cached server names and TTL values in NS records during the processing of a response to an A record query, which allows remote attackers to trigger continued resolvability of revoked domain names via a "ghost domain names" attack. To resolve this issue, upgrade to a newer version of Unbound.</p>
</div>
<hr class="docutils"/>
<div class="section" id="incorrect-proof-processing-for-nsec3-signed-zone">
<h2>Incorrect proof processing for NSEC3-signed zone</h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody>
<tr class="field"><th class="field-name">Date:</th><td class="field-body">2011-12-20</td>
</tr>
<tr class="field"><th class="field-name">CVE:</th><td class="field-body">CVE-2011-4869</td>
</tr>
<tr class="field"><th class="field-name">Affects:</th><td class="field-body">Unbound 1.4.13p2 and earlier versions</td>
</tr>
<tr class="field"><th class="field-name">Not affected:</th><td class="field-body">Other versions</td>
</tr>
<tr class="field"><th class="field-name">Severity:</th><td class="field-body">Medium</td>
</tr>
<tr class="field"><th class="field-name">Impact:</th><td class="field-body">Denial of service (daemon crash)</td>
</tr>
<tr class="field"><th class="field-name">Exploit:</th><td class="field-body">DNS servers can send a malformed response that lacks expected NSEC3 records</td>
</tr>
<tr class="field"><th class="field-name">Solution:</th><td class="field-body">Upgrade to a newer version of Unbound</td>
</tr>
</tbody>
</table>
<p>validator/val_nsec3.c in Unbound before 1.4.13p2 does not properly perform proof processing for NSEC3-signed zones, which allows remote DNS servers to cause a denial of service (daemon crash) via a malformed response that lacks expected NSEC3 records, a different vulnerability than CVE-2011-4528.</p>
<p><a class="reference external" href="/projects/unbound/download/#unbound-1-4-14">Unbound 1.4.14</a> contains a patch, but 1.4.14rc1 is vulnerable. If you cannot upgrade you can also apply a patch. For unbound version 1.4.0 - 1.4.13, apply <a class="reference external" href="/downloads/unbound/patch_CVE-2011-4528_unbound_140-1413.diff">this patch</a> and for version 1.0.1 - 1.3.4 use <a class="reference external" href="/downloads/unbound/patch_CVE-2011-4528_unbound_101-134.diff">this patch</a>. To do this, apply the patch on Unbound source directory with <tt class="docutils literal">patch <span class="pre">-p0</span> &lt; filename</tt>, then run <tt class="docutils literal">make install</tt> to install Unbound.</p>
</div>
<hr class="docutils"/>
<div class="section" id="processing-of-duplicate-cname-records-in-a-signed-zone">
<h2>Processing of duplicate CNAME records in a signed zone</h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody>
<tr class="field"><th class="field-name">Date:</th><td class="field-body">2011-12-20</td>
</tr>
<tr class="field"><th class="field-name">CVE:</th><td class="field-body"><a class="reference external" href="/downloads/unbound/CVE-2011-4528.txt">CVE-2011-4528</a></td>
</tr>
<tr class="field"><th class="field-name">Affects:</th><td class="field-body">Unbound 1.4.13p2 and earlier versions</td>
</tr>
<tr class="field"><th class="field-name">Not affected:</th><td class="field-body">Other versions</td>
</tr>
<tr class="field"><th class="field-name">Severity:</th><td class="field-body">Medium</td>
</tr>
<tr class="field"><th class="field-name">Impact:</th><td class="field-body">Denial of service (daemon crash)</td>
</tr>
<tr class="field"><th class="field-name">Exploit:</th><td class="field-body">Remotely send a crafted response</td>
</tr>
<tr class="field"><th class="field-name">Solution:</th><td class="field-body">Upgrade to a newer version of Unbound</td>
</tr>
</tbody>
</table>
<p>Unbound crashes when confronted with a non-standard response from a server for a domain. This domain produces duplicate RRs from a certain type and is DNSSEC signed.  Unbound also crashes when confronted with a query that eventually, and under specific circumstances, resolves to a domain that misses expected NSEC3 records.</p>
<p><a class="reference external" href="/projects/unbound/download/#unbound-1-4-14">Unbound 1.4.14</a> contains a patch, but 1.4.14rc1 is vulnerable. If you cannot upgrade you can also apply a patch. For unbound version 1.4.0 - 1.4.13, apply <a class="reference external" href="/downloads/unbound/patch_CVE-2011-4528_unbound_140-1413.diff">this patch</a> and for version 1.0.1 - 1.3.4 use <a class="reference external" href="/downloads/unbound/patch_CVE-2011-4528_unbound_101-134.diff">this patch</a>. To do this, apply the patch on Unbound source directory with <tt class="docutils literal">patch <span class="pre">-p0</span> &lt; filename</tt>, then run <tt class="docutils literal">make install</tt> to install Unbound.</p>
</div>

</section>

<aside class="sidepanel">
  <div class="sticky">

    <div class="section" id="logo">
    <p><img alt="Unbound logo" class="visible-on-sidebar" src="https://nlnetlabs.nl/static/logos/Unbound/Unbound_FC_Shaded_cropped.svg" style="height: 60px;"></p>
    </div>


    <div class="section" id="most-recent-version">
      <h2>Most Recent Version</h2>
      <p><a href="/downloads/unbound/unbound-1.22.0.tar.gz">Unbound 1.22.0</a> (.tar.gz)</p>
    </div>

    <div class="section" id="change-log">
      <h2>Change Log</h2>
      <p><a href="/projects/unbound/download/#unbound-1-22-0">Unbound 1.22.0</a></p>
    </div>

    <div class="section" id="documentation">
      <h2>Documentation</h2>
      <p><a href="https://unbound.docs.nlnetlabs.nl/">User Guide, manual pages and tutorials</a></p>
    </div>

    <div class="section" id="source-code">
      <h2>Source Code</h2>
      <p><a href="https://github.com/NLnetLabs/unbound">Browse GitHub Repository</a></p>
    </div>


    <div class="section" id="mailing-list">
      <h2>Mailing List</h2>
      <p><a href="https://lists.nlnetlabs.nl/mailman/listinfo/unbound-users">unbound-users</a></p>
    </div>

    <div class="section" id="bug-reporting">
      <h2>Bug Reporting</h2>
      <p><a href="https://github.com/NLnetLabs/unbound/issues">GitHub issues</a></p>
    </div>
    
    <div class="section" id="sponsor">
      <iframe src="https://github.com/sponsors/NLnetLabs/button" title="Sponsor
      NLnetLabs" height="35" width="116" style="border: 0;"></iframe>
    </div>
  </div>
</aside>
</div>
</div>

<footer id="footer" class="mt-auto pt-3 pb-1 bg-black text-white border-top border-primary">
  <div class="container">
    <div class="row">
      <div class="col-12 col-sm-10 mb-3">
        <div class="container-fluid">
          <div class="row">
            <div class="col sr-only"><h2>Further navigation</h2></div>
            <div class="d-md-none col-12">
              <nav>
                <ul class="list-inline">
                <li class="list-inline-item"><a href="/news/" >News</a>
                  </li>                  <li class="list-inline-item"><a href="/people/" >People</a>
                  </li>                  <li class="list-inline-item"><a href="/careers/culture/" >Careers</a>
                  </li>                  <li class="list-inline-item"><a href="/organisation/" >OurÂ Organisation</a>
                  </li>                  <li class="list-inline-item"><a href="/conduct/" >Code of Conduct</a>
                  </li>                  <li class="list-inline-item"><a href="/privacy-and-cookie-statement/" >PrivacyÂ Statement</a>
                  </li>                  <li class="list-inline-item"><a href="/security-report/" >Submit Security Report</a>
                  </li>                  </ul>
              </nav>
            </div>
            <div class="d-none d-md-block col-12 col-md-3">
              <nav>
                <ul class="list-unstyled">
                  <li><a href="/news/" >News</a></li>
                  <li><a href="/people/" >People</a></li>
                  <li><a href="/careers/culture/" >Careers</a></li>
                  <li><a href="/organisation/" >OurÂ Organisation</a></li>
                  <li><a href="/conduct/" >Code of Conduct</a></li>
                  <li><a href="/privacy-and-cookie-statement/" >PrivacyÂ Statement</a></li>
                  <li><a href="/security-report/" >Submit Security Report</a></li>
                </ul>
              </nav>
            </div>
            <div class="col-12 col-md-3 mb-3 pt-1">
              <a title="masdoton" rel="me" href="https://fosstodon.org/@nlnetlabs" aria-label="mastodon"><span class="fab fa-mastodon fa-2x"></span></a>
              <a title="github" href="https://github.com/NLnetLabs" aria-label="github"><span class="fab fa-github fa-2x"></span></a>
              <a title="docker" href="https://hub.docker.com/u/nlnetlabs/" aria-label="docker"><span class="fab fa-docker fa-2x"></span></a>
              <a title="linkedin" href="https://www.linkedin.com/company/92855/" aria-label="linkedin"><span class="fab fa-linkedin fa-2x"></span></a>
            </div>
            <div class="col-12 col-md-6">
              <address>
                Stichting NLnet Labs
                <br />
                Science Park 400, 1098 XH Amsterdam, The Netherlands
              </address>
              <p>
                General contact address: <a href="mailto:labs@nlnetlabs.nl">labs@nlnetlabs.nl</a>
                <br />
                For product support please use our <a href="/support/mailing-lists/">mailing lists.</a>
              </p>
              <p>
                NLnet Labs is a non-profit Public Benefit Organisation (<i>Algemeen Nut Beogende Instelling</i> or ANBI). 
              </p>
            </div>
            <div class="w-100"></div>
            <div class="col offset-md-6">
              &copy;&nbsp;2025&nbsp;Stichting NLnet Labs
            </div>
          </div>
        </div>
      </div>
      <div class="to-the-top">
        <a href="#"><img src="/static/icons/go_to_the_top.png" height="60" alt="go to the top"></a>
      </div>
    </div>
  </div>
</footer>

<script src="/theme/js/jquery-3.2.1.min.js"></script>
<script src="/theme/js/bootstrap.min.js"></script>
<script src="/static/js/analytics.js"></script>
</body>
</html>