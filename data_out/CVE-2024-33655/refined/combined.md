=== Content from www.isc.org_e0da4a0d_20250111_071439.html ===


[![ISC](/images/logo.png)](/)

* PRODUCTS
  + [![](/images/bind9.png)BIND 9](/bind)
  + [![](/images/kea.png)Kea](/kea)
  + [![](/images/stork80x.png)Stork](/stork)
  + [![](/images/dhcp.png)ISC DHCP](/dhcp)
* SUPPORT
  + [Software Support](/support)
  + [Advance Security Notification](/asn)
  + [Consulting and Training](/technicalservices)
  + [ISCâs Security Vulnerability Policy](https://kb.isc.org/docs/aa-00861)
  + [ISCâs Software Support Policy and Version Numbering](https://kb.isc.org/docs/aa-00896)
  + [ISCâs Knowledgebase](https://kb.isc.org)
  + [Report a Bug](/reportbug)
  + [Login for Support](https://support.isc.org/)
* COMMUNITY
  + [User Mailing Lists](/mailinglists)
  + [F-Root](/f-root)
  + [Organizations We Support](/governance)
  + [Other Software](/othersoftware)
  + [Presentations](/presentations)
  + [RFCs](/rfcs)
* ABOUT ISC
  + [Blog](/blogs)
  + [Mission & History](/about)
  + [Our Team](/team)
  + [Work for ISC](/careers)
  + [Buy Kea Hooks](/shop)
  + [ISC's Swag Store](https://shop.isc.org/)
  + [Get a Quote](/contact)

[DOWNLOADS](/download)

# Rate Limits in BIND 9 Effective vs. DNSBomb Vulnerability

## BIND 9 is Unaffected by the DNSBomb

We have been researching and testing a DNS vulnerability report called the DNSBomb ([CVE-2024-33655](https://nvd.nist.gov/vuln/detail/CVE-2024-33655)). After extensive testing, we have concluded that this technique does not pose a significant threat to BIND 9 operators. Our testing showed that with recommended configurations:

* The packet amplification factor for the client(s) is 1x (i.e. none).
* The novel part of this attack – spreading out the queries over time, and then tricking the resolver into responding within a short time window – is already sufficiently mitigated by existing limits that are in place.

### The DNSBomb Attack

The DNSBomb attack was described by [Xiang Li](https://lixiang521.com) from Tsinghua University [NISL Lab](https://netsec.ccert.edu.cn/chs/) and responsibly disclosed to multiple DNS software development teams for assessment. This is a pulsing denial-of-service attack (PDOS) that leverages features such as query rate limits, query timeouts, and maximum response size settings to create timed floods of responses using a maliciously designed authority and a vulnerable recursive resolver. Their attack also incorporates response amplification, by using specially-crafted zones on the authority to return large responses.

There are three critical steps to construct the DNSBomb attack:

1. Accumulating DNS queries (by extending the timeout window to delay responses artificially)
2. Amplifying responses (using query aggregation on the authoritative server and domains specially crafted to return large answers)
3. Collecting and “pulsing” responses to the target resolver in large batches

### Testing the Limits in BIND 9

After testing some variants of this attack vs BIND 9, we found multiple ways to limit or reduce the impact of DNSBomb on BIND 9 resolvers. Most of these are configured by default, but there are also rate limits that can be configured to further reduce the effectiveness of this attack.

These limits are effective against the DNSBomb attack:

* `clients-per-query` / `max-clients-per-query` are set by default to 10 and 100, respectively. They limit the total number of outstanding clients (requests) for any single query. In the worst case, there can be 100 outstanding requests.
* `recursive-clients` is configured by default to 1000. This limits the total number of outstanding requests. After reaching 90% of this limit (i.e. 900 requests by default), the oldest requests are dropped and can no longer contribute to the effectiveness of this attack.
* `responses-per-second` is a rate limit which can be configured to further mitigate this attack. It limits the number of UDP responses for a particular query per network segment.

### Notes on the Amplification Factor

[Amplification attacks](https://www.cloudflare.com/learning/ddos/dns-amplification-ddos-attack/) are a common problem in the DNS. DNS responses are typically much larger than the corresponding queries, so the main difference between regular query/response patterns and abusive ones is the amplification factor. Wide variations in query volume can be seen under normal operation, so we look for amplification factors of at least two orders of magnitude when considering whether an amplifier is actually a potent attack vector.

Here’s the worst case scenario for a resolver with a default configuration under the DNSBomb attack:

* The attacker (spoofing the victim’s address) sends 1000 packets over time (up to 10 seconds), while the authoritative server (under the attacker’s control) withholds the answer for that amount of time.
* Once the attacker’s authoritative server responds, the resolver answers all outstanding queries for the attacker’s domain.
* Assuming the answer is crafted to utilize the maximum packet size that will be transmitted over UDP, each answer could be 1232 bytes long. For 1000 outstanding queries, the total amount of data sent could be up to 12 MB sent within a very short time window.

The paper argues that this means a significant bandwidth amplification factor. While that may be true under ideal conditions, this attack doesn’t scale. Due to the recursive-clients limit (which defaults to 1000), any new requests will cause the oldest ones to be dropped, no longer contributing to the bandwidth amplification factor.

In other words, if the attacker sent 10k or 100k packets instead, the short data burst on the victim’s side would still be just 12 MB of data.

In real-world conditions, the attack is likely to be even less efficient, since the full impact would require that the attacker be the only client using this resolver and thus be able to utilize the entire recursive-clients limit for itself. If there are other clients, they’re likely using at least some of this quota, making the attack even less effective.

### References

* ISC’s BIND 9 GitLab issue [#4398](https://gitlab.isc.org/isc-projects/bind9/-/issues/4398). This issue will be hidden until the original reporter’s technical paper is published, currently planned for May 22, 2024 at the [IEEE Symposium on Security and Privacy](https://sp2024.ieee-security.org/program.html).
* The reporter, Xiang Li’s, homepage: <https://lixiang521.com/>
* Network and Information Security Laboratory, Tsinghua University: <https://netsec.ccert.edu.cn/>
* ISC’s [Software Defect and Security Vulnerability Disclosure Policy](https://kb.isc.org/docs/aa-00861)
* ISC’s [CVSS Scoring Guidelines](https://kb.isc.org/docs/isc-cvss-scoring-guidelines)
* The [BIND 9 Administrator Reference Manual](https://bind9.readthedocs.io/en/latest/chapter7.html) includes a section on deploying BIND securely. We assume these best practices are followed in assessing vulnerabilities.

###### AUTHOR

![author](/images/author/NoPhoto.jpg)
Posted by:
Nicki KÅÄ±ÌÅ¾ek

###### TAGS

* [BIND](/tags/bind)
* [Security](/tags/security)

###### CATEGORIES

- [BIND](/categories/bind)
- [Open Source](/categories/open-source)
- [Security](/categories/security)

###### PUBLISHED

01 May 2024

###### FOLLOW

## Recent Posts

What's New from ISC

![](/images/blog/net.jpg)

![](/images/blog/net.jpg)

Next post: [Kea 2.6.0 Released](/blogs/kea-2-6-0/)

Previous post: [BIND 9.16 Branch is approaching EOL](/blogs/2024-bind-9.16-eol/)

#### Software

* [Stork Graphical Management for Kea DHCP](/stork/)
* [BIND 9](/bind/)
* [Kea DHCP](/kea/)
* [ISC DHCP](/dhcp/)

#### Technical Resources

* [ISC Technical Knowledgebase](https://kb.isc.org)
* [BIND 9 Security Vulnerability Matrix](https://kb.isc.org/docs/aa-00913)
* [Source Repository](https://gitlab.isc.org/isc-projects)
* [EDNS Compliance Test Tool](https://ednscomp.isc.org)
* [ISC Software Licenses](/licenses)
* [DNS Tools](/dns-tools)
* [ISC DHCP Tools](/dhcp-tools)
* [Kea & IPv6 Tools](/kea-tools)
* [US Government Resources](/usgovt)

#### Other ISC Services

* [F-Root](/f-root)

#### Our Company

* [Blog](/blogs)
* [Contact](/contact)
* [Privacy Policy](/privacy)
* [Code of Conduct](/conductreporting)
* [ISCâs Mission](/about)
* [Work for ISC](/careers)
* [ISC's Swag Store](https://internet-systems-consortium.myshopify.com/)
* [RSS Feed](/index.xml)

[![ISC](/images/logo.png)](/)

##### ADDRESS

PO Box 360
 Newmarket, NH 03857 USA

##### CONTACT

* Email: info@isc.org
* Phone: +1 650 423 1300

Â© Internet Systems Consortium, Inc.



=== Content from lists.fedoraproject.org_26fe76c7_20250111_071435.html ===


[![Fedora Mailing-Lists](/static/logo-hyperkitty-fedora.png)](/archives/ "Fedora Mailing-Lists")

[Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/3TBXPRJ2Q235YUZKYDRWOSYNDFBJQWJ3/)
[Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/3TBXPRJ2Q235YUZKYDRWOSYNDFBJQWJ3/)

* [Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/3TBXPRJ2Q235YUZKYDRWOSYNDFBJQWJ3/)
* [Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/3TBXPRJ2Q235YUZKYDRWOSYNDFBJQWJ3/)

* [Manage this list](/admin/lists/package-announce.lists.fedoraproject.org/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

### 2025

* [January](/archives/list/package-announce%40lists.fedoraproject.org/2025/1/)

### 2024

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2024/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2024/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2024/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2024/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2024/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2024/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2024/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2024/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2024/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2024/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2024/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2024/1/)

### 2023

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2023/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2023/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2023/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2023/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2023/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2023/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2023/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2023/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2023/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2023/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2023/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2023/1/)

### 2022

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2022/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2022/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2022/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2022/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2022/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2022/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2022/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2022/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2022/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2022/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2022/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2022/1/)

### 2021

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2021/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2021/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2021/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2021/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2021/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2021/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2021/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2021/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2021/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2021/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2021/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2021/1/)

### 2020

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2020/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2020/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2020/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2020/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2020/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2020/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2020/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2020/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2020/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2020/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2020/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2020/1/)

### 2019

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2019/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2019/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2019/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2019/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2019/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2019/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2019/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2019/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2019/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2019/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2019/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2019/1/)

### 2018

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2018/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2018/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2018/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2018/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2018/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2018/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2018/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2018/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2018/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2018/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2018/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2018/1/)

### 2017

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2017/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2017/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2017/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2017/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2017/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2017/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2017/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2017/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2017/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2017/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2017/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2017/1/)

### 2016

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2016/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2016/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2016/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2016/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2016/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2016/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2016/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2016/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2016/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2016/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2016/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2016/1/)

### 2015

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2015/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2015/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2015/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2015/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2015/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2015/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2015/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2015/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2015/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2015/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2015/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2015/1/)

### 2014

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2014/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2014/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2014/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2014/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2014/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2014/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2014/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2014/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2014/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2014/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2014/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2014/1/)

### 2013

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2013/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2013/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2013/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2013/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2013/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2013/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2013/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2013/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2013/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2013/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2013/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2013/1/)

### 2012

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2012/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2012/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2012/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2012/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2012/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2012/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2012/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2012/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2012/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2012/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2012/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2012/1/)

### 2011

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2011/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2011/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2011/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2011/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2011/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2011/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2011/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2011/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2011/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2011/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2011/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2011/1/)

### 2010

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2010/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2010/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2010/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2010/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2010/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2010/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2010/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2010/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2010/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2010/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2010/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2010/1/)

### 2009

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2009/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2009/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2009/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2009/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2009/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2009/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2009/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2009/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2009/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2009/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2009/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2009/1/)

### 2008

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2008/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2008/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2008/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2008/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2008/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2008/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2008/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2008/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2008/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2008/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2008/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2008/1/)

### 2007

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2007/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2007/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2007/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2007/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2007/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2007/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2007/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2007/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2007/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2007/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2007/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2007/1/)

### 2006

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2006/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2006/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2006/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2006/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2006/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2006/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2006/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2006/5/)

[List overview](/archives/list/package-announce%40lists.fedoraproject.org/)

[Download](/archives/list/package-announce%40lists.fedoraproject.org/export/package-announce%40lists.fedoraproject.org-3TBXPRJ2Q235YUZKYDRWOSYNDFBJQWJ3.mbox.gz?message=3TBXPRJ2Q235YUZKYDRWOSYNDFBJQWJ3 "This message in gzipped mbox format")

[thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/3TBXPRJ2Q235YUZKYDRWOSYNDFBJQWJ3/#3TBXPRJ2Q235YUZKYDRWOSYNDFBJQWJ3)

# [SECURITY] Fedora 40 Update: unbound-1.20.0-1.fc40

![](https://seccdn.libravatar.org/avatar/be256568dfce45c1862b55e6cf3f2726.jpg?s=120&d=retro&r=g)

[updates＠fedoraproject.org](/archives/users/3d8bb2e4c1d843beb492d4f8a7c44761/ "See the profile for updates＠fedoraproject.org")

23 May
2024

23 May
'24

1:09 a.m.

--------------------------------------------------------------------------------
Fedora Update Notification
FEDORA-2024-68626e0eb5
2024-05-23 01:08:07.997401
--------------------------------------------------------------------------------

Name : unbound
Product : Fedora 40
Version : 1.20.0
Release : 1.fc40
URL : <https://nlnetlabs.nl/projects/unbound/>
Summary : Validating, recursive, and caching DNS(SEC) resolver
Description :
Unbound is a validating, recursive, and caching DNS(SEC) resolver.

The C implementation of Unbound is developed and maintained by NLnet
Labs. It is based on ideas and algorithms taken from a java prototype
developed by Verisign labs, Nominet, Kirei and ep.net.

Unbound is designed as a set of modular components, so that also
DNSSEC (secure DNS) validation and stub-resolvers (that do not run
as a server, but are linked into an application) are easily possible.

--------------------------------------------------------------------------------
Update Information:

Unbound 1.20.0
<https://github.com/NLnetLabs/unbound/releases/tag/release-1.20.0>
DNSBomb limitation fixes
--------------------------------------------------------------------------------
ChangeLog:

\* Fri May 10 2024 Petr Men����k pemensik@redhat.com - 1.20.0-1
- Update to 1.20.0
\* Fri May 10 2024 Petr Men����k pemensik@redhat.com - 1.19.3-7
- Ensure group access correction reaches also updated configs
\* Mon Apr 15 2024 Petr Men����k pemensik@redhat.com - 1.19.3-6
- Prevent executable bit on configuration files
\* Mon Apr 15 2024 Petr Men����k pemensik@redhat.com - 1.19.3-5
- Always regenerate config parser
\* Mon Apr 15 2024 Petr Men����k pemensik@redhat.com - 1.19.3-4
- Correct python3.12 warning
\* Mon Apr 15 2024 Petr Men����k pemensik@redhat.com - 1.19.3-3
- Use newer swig m4 configuration
\* Mon Apr 15 2024 Petr Men����k pemensik@redhat.com - 1.19.3-2
- Harden autoconf re-generation
--------------------------------------------------------------------------------
References:

[ 1 ] Bug #2279944 - CVE-2024-33655 unbound: DNSBomb vulnerability [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=2279944>
--------------------------------------------------------------------------------

This update can be installed with the "dnf" update program. Use
su -c 'dnf upgrade --advisory FEDORA-2024-68626e0eb5' at the command
line. For more information, refer to the dnf documentation available at
<http://dnf.readthedocs.io/en/latest/command_ref.html#upgrade-command-label>

All packages are signed with the Fedora Project GPG key. More details on the
GPG keys used by the Fedora Project can be found at
<https://fedoraproject.org/keys>
--------------------------------------------------------------------------------

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Back to the thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/3TBXPRJ2Q235YUZKYDRWOSYNDFBJQWJ3/#3TBXPRJ2Q235YUZKYDRWOSYNDFBJQWJ3)

[Back to the list](/archives/list/package-announce%40lists.fedoraproject.org/)

Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.7.



=== Content from sp2024.ieee-security.org_7d88b71e_20250111_071437.html ===


S & P

* [Home](index.html)
* Program
  + [Program (Compact)](program-compact.html)
  + [Program](program.html)
  + [Accepted Papers](accepted-papers.html)
  + [Posters](posters.html)
  + [Short Talks](program-shorttalks.html)
  + [Proceedings](https://www.computer.org/csdl/proceedings/sp/2024/1RjE8VKKk1y)
  + [Symposium Presenter Information](presenters.html)
  + [Awards](awards.html)
* Call For...
  + [Papers](cfpapers.html)

  + [Posters](cfposters.html)
  + [Short Talks](cftalks.html)
  + [Workshops](cfworkshops.html)
  + [Donors](cfdonors.html)
* Attend
  + [Venue Info](venue.html)
  + [Registration](https://na.eventscloud.com/ereg/index.php?eventid=782083&)
  + [Student Travel Grants](travelgrants.html)
  + [Attendee Code of Conduct](codeofconduct.html)
* [Workshops](workshops.html)

* [Twitter](https://twitter.com/ieeessp)
* [Facebook](https://www.facebook.com/ieeessp)
* [LinkedIn](http://www.linkedin.com/groups?gid=7403306)
* [Contact](contact.html)
* About
  + [Past Conferences](past.html)
  + [Conference Organizers](organizers.html)
  + [Technical Committee](https://www.ieee-security.org/index.html)

MAY 20-23, 2024
AT THE
HILTON SAN FRANCISCO UNION SQUARE,
SAN FRANCISCO, CA

45th IEEE Symposium on
Security and Privacy

Sponsored by the [IEEE Computer Society Technical
Committee on Security and Privacy](http://ieee-security.org/) in cooperation with the [International Association for Cryptologic Research](http://www.iacr.org)

Accepted Papers

# Accepted Papers

Proceedings are available [here](https://www.computer.org/csdl/proceedings/sp/2024/1RjE8VKKk1y).

[![IEEE](images/logo-ieee.jpg)](http://www.ieee.org)
[![IEEE Computer Society](images/logo-ieee-cs.png)](http://www.computer.org)
[![IEEE Technical Committee on Security and Privacy](images/trojan.png)](http://www.ieee-security.org)



=== Content from nlnetlabs.nl_fefb99fe_20250111_071437.html ===

[![Home](/static/logos/NLnetLabs/Logo_NLnet_Labs_cropped.svg)
NLnet Labs](/)

Software
DNS
[Unbound](/projects/unbound/about/)
[NSD](/projects/nsd/about/)
[OpenDNSSEC](https://www.opendnssec.org)
[ldns](/projects/ldns/about/)
[domain](/projects/domain/about/)
Routing
[Krill](/projects/routing/krill/)
[Routinator](/projects/routing/routinator/)
[RTRTR](/projects/routing/rtrtr/)
[Rotonda](/projects/routing/rotonda/)

Support
[Support Policy](/support/software-support-policy/)
[Mailing Lists](/support/mailing-lists/)
[Security Advisories](/support/security-advisories/)

[Support Contracts](/services/contracts/)
[Consultancy](/services/consultancy/)

Documentation
DNS
[Unbound](https://unbound.docs.nlnetlabs.nl/)
[NSD](https://nsd.docs.nlnetlabs.nl/)
[ldns](/documentation/ldns/)
Routing
[Krill](https://krill.docs.nlnetlabs.nl/)
[Routinator](https://routinator.docs.nlnetlabs.nl/)
[RTRTR](https://rtrtr.docs.nlnetlabs.nl/)
[Rotonda](https://rotonda.docs.nlnetlabs.nl/)

Community
[Standardisation](/community/IETF)
[Operations](/community/operations)
[Policy](/community/policy)
[Presentations](/community/presentations)
[Publications](/community/publications)

Research
[Research Vision](/research/about/)
[Projects](/research/projects/)
[Collaborations](/research/collaborations/)
[Publications](/research/publications/)
[Student Projects](/research/student-projects)
[Other Activities](/research/other/)

[About](/about/)
[Sponsors](/sponsors/)
[Blog](https://blog.nlnetlabs.nl/)

[Support Us](/funding/)

[Support Us](/funding/)

# UNBOUND

* [About](/projects/unbound/about/)
* [Download](/projects/unbound/download/)
* [Support](/projects/unbound/support/)
* [RFC Compliance](/projects/unbound/rfc-compliance/)
* Security Advisories

We take security very seriously. If you have found a security issue in
Unbound, please [submit a security report](/security-report/).

---

## Unbounded name compression could lead to Denial of Service

| Date: | 2024-10-03 |
| --- | --- |
| CVE: | [CVE-2024-8508](/downloads/unbound/CVE-2024-8508.txt) |
| Credit: | Toshifumi Sakaguchi |
| Affects: | Unbound up to and including version 1.21.0 |
| Not affected: | Other versions |
| Severity: | Medium (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L) |
| Impact: | Possibility of DoS in orchestrated attacks |
| Solution: | Download patched version of Unbound, or apply the patch manually |

Malicious upstreams responses with very large RRsets can cause Unbound
to spend a considerable time applying name compression to downstream
replies. This can lead to degraded performance and eventually denial of
service in well orchestrated attacks.

The vulnerability can be exploited by a malicious actor querying Unbound
for the specially crafted contents of a malicious zone with very large
RRsets.
Before Unbound replies to the query it will try to apply name
compression which was an unbounded operation that could lock the CPU
until the whole packet was complete.

Unbound version 1.21.1 introduces a hard limit on the number of name
compression calculations it is willing to do per packet.
Packets that need more compression will result in semi-compressed
packets or truncated packets, even on TCP for huge messages, to avoid
locking the CPU for long.

This change should not affect normal DNS traffic.

[Unbound 1.21.1](/projects/unbound/download/#unbound-1-21-1) contains a patch.
If you cannot upgrade you can also apply
[the patch](/downloads/unbound/patch_CVE-2024-8508.diff)
manually.
To do this, apply the patch on the Unbound source directory with
patch -p1 < patch\_CVE-2024-8508.diff and then run
make install to install Unbound.

---

## Unbound vulnerable to the "DNSBomb" pulsing DoS amplification attack

| Date: | 2024-05-08 |
| --- | --- |
| CVE: | [CVE-2024-33655](/downloads/unbound/CVE-2024-33655.txt) |
| Credit: | Xiang Li (Network and Information Security Lab, Tsinghua University) |
| Affects: | Unbound up to and including version 1.19.3 |
| Not affected: | Other versions |
| Severity: | Low |
| Impact: | Possibility of participation in the pulsing DoS amplification attack |
| Solution: | Download patched version of Unbound, or apply the patch manually |

The DNSBomb attack, via specially timed DNS queries and answers, can
cause a Denial of Service on resolvers and spoofed targets.

Unbound itself is not vulnerable for DoS, rather it can be used to take
part in a pulsing DoS amplification attack.

The DNSBomb attack works by sending low-rate spoofed queries for a
malicious zone to Unbound. By controlling the delay of the malicious
authoritative answers, Unbound slowly accumulates pending answers for
the spoofed addresses. When the authoritative answers become available
to Unbound at the same time, Unbound starts serving all the accumulated
queries. This results into large-sized, concentrated response bursts
to the spoofed addresses.

From version 1.20.0 on, Unbound introduces a couple of configuration
options to help mitigate the impact.
Their complete description can be found in the included manpages but
they are also briefly listed here together with their current default
values for convenience:

* discard-timeout: 1900

  After 1900 ms a reply to the client will be dropped.
  Unbound would still work on the query but refrain from replying in
  order to not accumulate a huge number of "old" replies.
  Legitimate clients retry on timeouts.
* wait-limit: 1000 / wait-limit-cookie: 10000

  Limits the amount of client queries that require recursion
  (cache-hits are not counted) per IP address. More recursive queries
  than the allowed limit are dropped. Clients with a valid EDNS Cookie
  can have a different limit, higher by default.
  wait-limit: 0 disables all wait limits.
* wait-limit-netblock / wait-limit-cookie-netblock

  These do not have a default value but they can fine grain
  configuration for specific netblocks. With or without EDNS Cookies.

The options above are trying to shrink the DNSBomb window so that the
impact of the DoS from Unbound is significantly lower than it used to be
and making the attack, and Unbound's participation, less tempting for
attackers.

[Unbound 1.20.0](/projects/unbound/download/#unbound-1-20-0) contains a patch.
If you cannot upgrade you can also apply
[the patch](/downloads/unbound/patch_CVE-2024-33655.diff)
manually.
To do this, apply the patch on the Unbound source directory with
patch -p1 < patch\_CVE-2024-33655.diff and then run
make install to install Unbound.

---

## Denial of service when trimming EDE text on positive replies

| Date: | 2024-03-07 |
| --- | --- |
| CVE: | [CVE-2024-1931](/downloads/unbound/CVE-2024-1931.txt) |
| Credit: | Fredrik Pettai and Patrik Lundin from SUNET |
| Affects: | Unbound version 1.18.0 up to and including version 1.19.1 |
| Not affected: | Other versions, or 'ede: no' configurations |
| Severity: | High (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H) |
| Impact: | Denial of service when a vulnerable code path leads to an infinite loop |
| Solution: | Download patched version of Unbound, or use 'ede: no' (default), or apply the patch manually |

Unbound 1.18.0 introduced a feature that removes EDE records from
responses with size higher than the client's advertised buffer size.
Before removing all the EDE records however, it would try to see if
trimming the extra text fields on those records would result in an
acceptable size while still retaining the EDE codes.
Due to an unchecked condition, the code that trims the text of the EDE
records could loop indefinitely.
This happens when Unbound would reply with attached EDE information on a
positive reply and the client's buffer size is smaller than the needed
space to include EDE records.

The vulnerability can only be triggered when the 'ede: yes' option is
used; non default configuration.

From version 1.19.2 on, the code is fixed to avoid looping indefinitely.

[Unbound 1.19.2](/projects/unbound/download/#unbound-1-19-2) contains a patch.
If you cannot upgrade you can also apply
[the patch](/downloads/unbound/patch_CVE-2024-1931.diff)
manually.
To do this, apply the patch on the Unbound source directory with
patch -p1 < patch\_CVE-2024-1931.diff and then run
make install to install Unbound.

---

## DNSSEC verification complexity can be exploited to exhaust CPU resources and stall DNS resolvers

| Date: | 2024-02-13 |
| --- | --- |
| CVE: | [CVE-2023-50387](/downloads/unbound/CVE-2023-50387_CVE-2023-50868.txt) |
| Credit: | Elias Heftrig, Haya Schulmann, Niklas Vogel, and Michael Waidner from the German National Research Center for Applied Cybersecurity ATHENE |
| Affects: | Unbound up to and including version 1.19.0 |
| Not affected: | Other versions |
| Severity: | High |
| Impact: | DNSSEC validation can lead to DoS in trivially orchestrated attacks |
| Solution: | Download patched version of Unbound, or apply the patch manually |

A DNSSEC validation vulnerability has been discovered in various DNSSEC
validating software. The vulnerability has an assigned number of CVE-2023-50387
and is referred here as the KeyTrap vulnerability.

The KeyTrap vulnerability works by using a combination of Keys (also colliding
Keys), Signatures and number of RRSETs on a malicious zone.
Answers from that zone can force a DNSSEC validator down a very CPU intensive
and time costly validation path.

It can force Unbound to spend an enormous time (comparative to regular
traffic) validating a single specially crafted DNSSEC response while everything
else is on hold for that thread. A trivially orchestrated attack could render
all threads busy with such responses leading to denial of service.

From version 1.19.1 on, Unbound introduces suspension on DNSSEC response
validations that seem to require more attempts than Unbound is willing to make
per response validation run. Suspension means that Unbound will continue with
other work before resuming a suspended validation offering CPU time between
validation resumptions to other tasks. There is a backoff timer when
suspending which is further influenced by the number of suspends already used
and the amount of work currently in Unbound.

The introduced builtin limits in Unbound are:

* Max 4 DNSSEC key collissions are allowed when building chain of trust.
  More than that without a secure key treats the delegation as bogus.
* 8 validation attempts per RRSET (combination of keys + signatures).
  If more are needed and Unbound has yet to find a valid signature
  the RRSET is treated as bogus.
* More than 8 validation attempts per answer will suspend validation.
* The limit of total suspensions is 16 after which the query will error
  out. Any completed RRSET validations populate the cache for use in
  future queries.

While under attack Unbound could show higher CPU load because of the needed
validations but the suspend strategy would guarantee the CPU is not locked on
any particular validation task.

[Unbound 1.19.1](/projects/unbound/download/#unbound-1-19-1) contains a patch.
If you cannot upgrade you can also apply
[the patch](/downloads/unbound/patch_CVE-2023-50387_CVE-2023-50868.diff)
manually.
To do this, apply the patch on the Unbound source directory with
patch -p1 < patch\_CVE-2023-50387\_CVE-2023-50868.diff and then run
make install to install Unbound.

*This is a shared patch with CVE-2023-50868 below*

---

## NSEC3 closest encloser proof can exhaust CPU

| Date: | 2024-02-13 |
| --- | --- |
| CVE: | [CVE-2023-50868](/downloads/unbound/CVE-2023-50387_CVE-2023-50868.txt) |
| Credit: | Petr Å paÄek from ISC |
| Affects: | Unbound up to and including version 1.19.0 |
| Not affected: | Other versions |
| Severity: | High |
| Impact: | DNSSEC validation can lead to DoS in trivially orchestrated attacks |
| Solution: | Download patched version of Unbound, or apply the patch manually |

A DNSSEC validation vulnerability has been discovered in various DNSSEC
validating software. The vulnerability has an assigned number of CVE-2023-50868
and is referred here as the NSEC3 vulnerability.

The NSEC3 vulnerability uses specially crafted responses on a malicious zone
with multiple NSEC3 RRSETs to force a DNSSEC validator down a very CPU
intensive and time costly NSEC3 hash calculation path.

It can force Unbound to spend an enormous time (comparative to regular
traffic) validating a single specially crafted DNSSEC response while everything
else is on hold for that thread. A trivially orchestrated attack could render
all threads busy with such responses leading to denial of service.

From version 1.19.1 on, Unbound introduces suspension on DNSSEC response
validations that seem to require more attempts than Unbound is willing to make
per response validation run. Suspension means that Unbound will continue with
other work before resuming a suspended validation offering CPU time between
validation resumptions to other tasks. There is a backoff timer when
suspending which is further influenced by the number of suspends already used
and the amount of work currently in Unbound.

The introduced builtin limits for the NSEC3 vulnerability in Unbound are:

* 8 NSEC3 hash calculations are allowed before suspension. More than that will
  suspend validation.
* The limit of total suspensions is 16 after which the query will error
  out. Any completed RRSET validations populate the cache for use in
  future queries.

While under attack Unbound could show higher CPU load because of the needed
validations but the suspend strategy would guarantee the CPU is not locked on
any particular validation task.

[Unbound 1.19.1](/projects/unbound/download/#unbound-1-19-1) contains a patch.
If you cannot upgrade you can also apply
[the patch](/downloads/unbound/patch_CVE-2023-50387_CVE-2023-50868.diff)
manually.
To do this, apply the patch on the Unbound source directory with
patch -p1 < patch\_CVE-2023-50387\_CVE-2023-50868.diff and then run
make install to install Unbound.

*This is a shared patch with CVE-2023-50387 above*

---

## Non-Responsive Delegation Attack

| Date: | 2022-09-21 |
| --- | --- |
| CVE: | [CVE-2022-3204](/downloads/unbound/CVE-2022-3204.txt) |
| Credit: | Yehuda Afek (Tel-Aviv University), Anat Bremler-Barr & Shani Stajnrod (Reichman University) |
| Affects: | Unbound up to and including version 1.16.2 |
| Not affected: | Other versions |
| Severity: | Medium |
| Impact: | Possibility of DoS in orchestrated attacks |
| Solution: | Download patched version of Unbound, or apply the patch manually |

A vulnerability named 'Non-Responsive Delegation Attack' (NRDelegation Attack)
has been discovered in various DNS resolving software. The NRDelegation Attack
works by having a malicious delegation with a considerable number of non
responsive nameservers. The attack starts by querying a resolver for a record
that relies on those unresponsive nameservers.

The attack can cause a resolver to spend a lot of time/resources resolving
records under a malicious delegation point where a considerable number of
unresponsive NS records reside. It can trigger high CPU usage in some resolver
implementations that continually look in the cache for resolved NS records in
that delegation. This can lead to degraded performance and eventually denial
of service in orchestrated attacks.

Unbound does not suffer from high CPU usage, but resources are still needed for
resolving the malicious delegation. Unbound will keep trying to resolve the
record until hard limits are reached. Based on the nature of the attack and the
replies, different limits could be reached.

From version 1.16.3 on, Unbound introduces fixes for better performance when
under load, by cutting opportunistic queries for nameserver discovery and
DNSKEY prefetching and limiting the number of times a delegation point can
issue a cache lookup for missing records.

[Unbound 1.16.3](/projects/unbound/download/#unbound-1-16-3) contains a patch.
If you cannot upgrade you can also apply
[the patch](/downloads/unbound/patch_CVE-2022-3204.diff)
manually.
To do this, apply the patch on the Unbound source directory with
patch -p1 < patch\_CVE-2022-3204.diff and then run
make install to install Unbound.

---

## Novel "ghost domain names" attack by updating almost expired delegation information

| Date: | 2022-08-01 |
| --- | --- |
| CVE: | [CVE-2022-30699](/downloads/unbound/CVE-2022-30698_CVE-2022-30699.txt) |
| Credit: | Xiang Li (Network and Information Security Lab, Tsinghua University) |
| Affects: | Unbound up to and including version 1.16.1 |
| Not affected: | Other versions |
| Severity: | Medium |
| Impact: | Remote attackers can trigger continued resolvability of revoked domain names |
| Solution: | Download patched version of Unbound, or apply the patch manually |

NLnet Labs Unbound, up to and including version 1.16.1, is vulnerable to a
novel type of the "ghost domain names" attack. The vulnerability works by
targeting an Unbound instance. Unbound is queried for a rogue domain name when
the cached delegation information is about to expire. The rogue nameserver
delays the response so that the cached delegation information is expired. Upon
receiving the delayed answer containing the delegation information, Unbound
overwrites the now expired entries. This action can be repeated when the
delegation information is about to expire making the rogue delegation
information ever-updating. From version 1.16.2 on, Unbound stores the start
time for a query and uses that to decide if the cached delegation information
can be overwritten.

[Unbound 1.16.2](/projects/unbound/download/#unbound-1-16-2) contains a patch.
If you cannot upgrade you can also apply
[the patch](/downloads/unbound/patch_CVE-2022-30698_CVE-2022-30699.diff)
manually.
To do this, apply the patch on the Unbound source directory with
patch -p1 < patch\_CVE-2022-30698\_CVE-2022-30699.diff and then run
make install to install Unbound.

*This is a shared patch with CVE-2022-30698 below*

---

## Novel "ghost domain names" attack by introducing subdomain delegations

| Date: | 2022-08-01 |
| --- | --- |
| CVE: | [CVE-2022-30698](/downloads/unbound/CVE-2022-30698_CVE-2022-30699.txt) |
| Credit: | Xiang Li (Network and Information Security Lab, Tsinghua University) |
| Affects: | Unbound up to and including version 1.16.1 |
| Not affected: | Other versions |
| Severity: | Medium |
| Impact: | Remote attackers can trigger continued resolvability of revoked domain names |
| Solution: | Download patched version of Unbound, or apply the patch manually |

NLnet Labs Unbound, up to and including version 1.16.1 is vulnerable to a novel
type of the "ghost domain names" attack. The vulnerability works by targeting
an Unbound instance. Unbound is queried for a subdomain of a rogue domain name.
The rogue nameserver returns delegation information for the subdomain that
updates Unbound's delegation cache. This action can be repeated before expiry
of the delegation information by querying Unbound for a second level subdomain
which the rogue nameserver provides new delegation information. Since Unbound
is a child-centric resolver, the ever-updating child delegation information can
keep a rogue domain name resolvable long after revocation. From version 1.16.2
on, Unbound checks the validity of parent delegation records before using
cached delegation information.

[Unbound 1.16.2](/projects/unbound/download/#unbound-1-16-2) contains a patch.
If you cannot upgrade you can also apply
[the patch](/downloads/unbound/patch_CVE-2022-30698_CVE-2022-30699.diff)
manually.
To do this, apply the patch on the Unbound source directory with
patch -p1 < patch\_CVE-2022-30698\_CVE-2022-30699.diff and then run
make install to install Unbound.

*This is a shared patch with CVE-2022-30699 above*

---

## Local symlink attack

| Date: | 2020-12-01 |
| --- | --- |
| CVE: | [CVE-2020-28935](/downloads/unbound/CVE-2020-28935.txt) |
| Credit: | Mason Loring Bliss |
| Affects: | Unbound up to and including version 1.12.0 |
| Not affected: | Other versions |
| Severity: | Low |
| Impact: | Denial of Service |
| Solution: | Download patched version of Unbound, or apply the patch manually |

Unbound when writing and later chown'ing the PID file would not check if an
existing file was a symlink.
This is a local vulnerability that could create a Denial of Service of the
system Unbound is running on. It requires an attacker having access to the
limited permission user Unbound runs as and point through the symlink to a
critical file on the system.

[Unbound 1.13.0](/projects/unbound/download/#unbound-1-13-0) contains a patch.
If you cannot upgrade you can also apply
[the patch](/downloads/unbound/patch_cve-2020-28935_unbound.diff) manually.
To do this, apply the patch on the Unbound source directory with
patch -p1 < patch\_cve-2020-28935\_unbound.diff and then run make install
to install Unbound.

---

## Vulnerability in Domain Parse

| Date: | 2020-05-19 |
| --- | --- |
| CVE: | [CVE-2020-12663](/downloads/unbound/CVE-2020-12662_2020-12663.txt) |
| Credit: | OSS-Fuzz project |
| Affects: | Unbound up to and including version 1.10.0 |
| Not affected: | Other versions |
| Severity: | Medium |
| Impact: | Unbound is unresponsive |
| Solution: | Download patched version of Unbound, or apply the patch manually |

Fuzzing of the Unbound code made us aware of issues in the parser of
received answers. Malformed answers received from upstream servers can
result in Unbound entering an infinite loop and thereby becoming
unresponsive. When compiled with --enable-debug it is also possible to
trigger an assertion, resulting in Unbound to crash.

[Unbound 1.10.1](/projects/unbound/download/#unbound-1-10-1) contains a patch.
If you cannot upgrade you can also apply
[the patch](/downloads/unbound/patch_cve_2020-12662_2020-12663.diff)
manually.
To do this, apply the patch on Unbound source directory with
patch -p1 < filename, then run make install to install Unbound.

---

## NXNSAttack

| Date: | 2020-05-19 |
| --- | --- |
| CVE: | [CVE-2020-12662](/downloads/unbound/CVE-2020-12662_2020-12663.txt) |
| Credit: | Lior Shafir, Yehuda Afek, and Anat Bremler-Barr from Tel Aviv University |
| Affects: | Unbound up to and including version 1.10.0 |
| Not affected: | Other versions |
| Severity: | Medium |
| Impact: | Unbound performs amplification |
| Solution: | Download patched version of Unbound, or apply the patch manually |

Researchers from Tel Aviv University discovered an issue in Unbound and
other DNS resolvers that makes it possible to have a single incoming
query result in a large number of outgoing queries. This amplification
makes it possible for Unbound to be used in a denial of service
attack. The researchers discovering this called this attack the NXNSattack.

This attack makes use of cache bypassing using random subdomains in the
NSDNAME in NS records. When these delegation records are received during
iteration, and the answer does not contain glue records, a resolver has
to send out a query to the get the IP address for one of the names. When
this query fails (for example because the random name does not exist) a
resolver will try the next one. A large set of NS records with random
names can result in a large number of outgoing queries going to the same
target. More details about this attack will be available in the research
paper.

[Unbound 1.10.1](/projects/unbound/download/#unbound-1-10-1) contains a patch.
If you cannot upgrade you can also apply [the patch](/downloads/unbound/patch_cve_2020-12662_2020-12663.diff) manually.
To do this, apply the patch on Unbound source directory with patch -p1 < filename, then run make install to install Unbound.

---

## Vulnerability in IPSEC module

| Date: | 2019-11-19 |
| --- | --- |
| CVE: | [CVE-2019-18934](/downloads/unbound/CVE-2019-18934.txt) |
| Credit: | X41 D-Sec |
| Affects: | Unbound 1.6.4 up to and including version 1.9.4 |
| Not affected: | Other versions |
| Severity: | Critical |
| Impact: | Shell code execution after a specially crafted answer |
| Solution: | Download patched version of Unbound, or apply the patch manually |

Due to unsanitized characters passed to the ipsecmod-hook shell command,
it is possible for Unbound to allow shell code execution from a
specially crafted IPSECKEY answer.

This issue can only be triggered when *all* of the below conditions are met:

* unbound was compiled with --enable-ipsecmod support, and
* ipsecmod is enabled and used in the configuration (either in the
  configuration file or using unbound-control), and
* a domain is part of the ipsecmod-whitelist (if ipsecmod-whitelist is
  used), and
* unbound receives an A/AAAA query for a domain that has an A/AAAA
  record(s) *and* an IPSECKEY record(s) available.

The shell code execution can then happen if either the qname or the
gateway field of the IPSECKEY (when gateway type == 3) contain a
specially crafted domain name.

[Unbound 1.9.5](/projects/unbound/download/#unbound-1-9-5) contains a patch.
If you cannot upgrade you can also apply [the patch](/downloads/unbound/patch_cve_2019-18934.diff) manually.
To do this, apply the patch on Unbound source directory with patch -p1 < filename, then run make install to install Unbound.

---

## Vulnerability in parsing NOTIFY queries

| Date: | 2019-10-03 |
| --- | --- |
| CVE: | [CVE-2019-16866](/downloads/unbound/CVE-2019-16866.txt) |
| Credit: | X41 D-Sec |
| Affects: | Unbound 1.7.1 up to and including version 1.9.3 |
| Not affected: | Other versions |
| Severity: | Medium |
| Impact: | Crash after receiving a specially crafted query |
| Solution: | Download patched version of Unbound, or apply the patch manually |

Due to an error in parsing NOTIFY queries, it is possible for Unbound to
continue processing malformed queries and may ultimately result in a
pointer dereference in uninitialized memory. This results in a crash of
the Unbound daemon.

[Unbound 1.9.4](/projects/unbound/download/#unbound-1-9-4) contains a patch. If you cannot upgrade you can also apply [the patch](/downloads/unbound/patch_cve_2019-16866.diff) manually. To do this, apply the patch on Unbound source directory with patch -p0 < filename, then run make install to install Unbound.

---

## Vulnerability in the processing of wildcard synthesized NSEC records

| Date: | 2018-01-23 |
| --- | --- |
| CVE: | [CVE-2017-15105](/downloads/unbound/CVE-2017-15105.txt) |
| Credit: | Ralph Dolmans (NLnet Labs), Karst Koymans (University of Amsterdam) |
| Affects: | Unbound 1.6.7 and earlier versions |
| Not affected: | Other versions |
| Severity: | Medium |
| Impact: | The wildcard NSEC record can be used to prove the non-existence (NXDOMAIN answer) of an existing wildcard record |
| Solution: | Download patched version of Unbound, or apply the patch manually |

We discovered a vulnerability in the processing of wildcard synthesized NSEC records. While synthesis of NSEC records is allowed by RFC4592, these synthesized owner names should not be used in the NSEC processing. This does, however, happen in Unbound 1.6.7 and earlier versions.

[Unbound 1.6.8](/projects/unbound/download/#unbound-1-6-8) contains a patch. If you cannot upgrade you can also apply [the patch](/downloads/unbound/patch_cve_2017_15105.diff) manually. To do this, apply the patch on Unbound source directory with patch -p0 < filename, then run make install to install Unbound.

A special thanks goes out to Karst Koymans (University of Amsterdam) for sparking the discovery of this vulnerability by Ralph Dolmans (NLnet Labs).

---

## Ghost domain names attack

| Date: | 2012-02-17 |
| --- | --- |
| CVE: | CVE-2012-1192 |
| Credit: | ISC |
| Affects: | Unbound 1.4.11 and earlier versions |
| Not affected: | Other versions |
| Severity: | Medium |
| Impact: | Remote attackers can trigger continued resolvability of revoked domain names |
| Solution: | Upgrade to a newer version of Unbound |

The resolver in Unbound before 1.4.11 overwrites cached server names and TTL values in NS records during the processing of a response to an A record query, which allows remote attackers to trigger continued resolvability of revoked domain names via a "ghost domain names" attack. To resolve this issue, upgrade to a newer version of Unbound.

---

## Incorrect proof processing for NSEC3-signed zone

| Date: | 2011-12-20 |
| --- | --- |
| CVE: | CVE-2011-4869 |
| Affects: | Unbound 1.4.13p2 and earlier versions |
| Not affected: | Other versions |
| Severity: | Medium |
| Impact: | Denial of service (daemon crash) |
| Exploit: | DNS servers can send a malformed response that lacks expected NSEC3 records |
| Solution: | Upgrade to a newer version of Unbound |

validator/val\_nsec3.c in Unbound before 1.4.13p2 does not properly perform proof processing for NSEC3-signed zones, which allows remote DNS servers to cause a denial of service (daemon crash) via a malformed response that lacks expected NSEC3 records, a different vulnerability than CVE-2011-4528.

[Unbound 1.4.14](/projects/unbound/download/#unbound-1-4-14) contains a patch, but 1.4.14rc1 is vulnerable. If you cannot upgrade you can also apply a patch. For unbound version 1.4.0 - 1.4.13, apply [this patch](/downloads/unbound/patch_CVE-2011-4528_unbound_140-1413.diff) and for version 1.0.1 - 1.3.4 use [this patch](/downloads/unbound/patch_CVE-2011-4528_unbound_101-134.diff). To do this, apply the patch on Unbound source directory with patch -p0 < filename, then run make install to install Unbound.

---

## Processing of duplicate CNAME records in a signed zone

| Date: | 2011-12-20 |
| --- | --- |
| CVE: | [CVE-2011-4528](/downloads/unbound/CVE-2011-4528.txt) |
| Affects: | Unbound 1.4.13p2 and earlier versions |
| Not affected: | Other versions |
| Severity: | Medium |
| Impact: | Denial of service (daemon crash) |
| Exploit: | Remotely send a crafted response |
| Solution: | Upgrade to a newer version of Unbound |

Unbound crashes when confronted with a non-standard response from a server for a domain. This domain produces duplicate RRs from a certain type and is DNSSEC signed. Unbound also crashes when confronted with a query that eventually, and under specific circumstances, resolves to a domain that misses expected NSEC3 records.

[Unbound 1.4.14](/projects/unbound/download/#unbound-1-4-14) contains a patch, but 1.4.14rc1 is vulnerable. If you cannot upgrade you can also apply a patch. For unbound version 1.4.0 - 1.4.13, apply [this patch](/downloads/unbound/patch_CVE-2011-4528_unbound_140-1413.diff) and for version 1.0.1 - 1.3.4 use [this patch](/downloads/unbound/patch_CVE-2011-4528_unbound_101-134.diff). To do this, apply the patch on Unbound source directory with patch -p0 < filename, then run make install to install Unbound.

![Unbound logo](https://nlnetlabs.nl/static/logos/Unbound/Unbound_FC_Shaded_cropped.svg)

## Most Recent Version

[Unbound 1.22.0](/downloads/unbound/unbound-1.22.0.tar.gz) (.tar.gz)

## Change Log

[Unbound 1.22.0](/projects/unbound/download/#unbound-1-22-0)

## Documentation

[User Guide, manual pages and tutorials](https://unbound.docs.nlnetlabs.nl/)

## Source Code

[Browse GitHub Repository](https://github.com/NLnetLabs/unbound)

## Mailing List

[unbound-users](https://lists.nlnetlabs.nl/mailman/listinfo/unbound-users)

## Bug Reporting

[GitHub issues](https://github.com/NLnetLabs/unbound/issues)

## Further navigation

* [News](/news/)
* [People](/people/)
* [Careers](/careers/culture/)
* [OurÂ Organisation](/organisation/)
* [Code of Conduct](/conduct/)
* [PrivacyÂ Statement](/privacy-and-cookie-statement/)
* [Submit Security Report](/security-report/)

* [News](/news/)
* [People](/people/)
* [Careers](/careers/culture/)
* [OurÂ Organisation](/organisation/)
* [Code of Conduct](/conduct/)
* [PrivacyÂ Statement](/privacy-and-cookie-statement/)
* [Submit Security Report](/security-report/)

Stichting NLnet Labs

Science Park 400, 1098 XH Amsterdam, The Netherlands

General contact address: labs@nlnetlabs.nl

For product support please use our [mailing lists.](/support/mailing-lists/)

NLnet Labs is a non-profit Public Benefit Organisation (*Algemeen Nut Beogende Instelling* or ANBI).

© 2025 Stichting NLnet Labs

![go to the top](/static/icons/go_to_the_top.png)



=== Content from nlnetlabs.nl_b66a02b6_20250111_071437.html ===
The CVE number for this vulnerability is CVE-2024-33655.
A novel pulsing DoS attack named "DNSBomb" has been discovered to
affect various DNS resolving software.
Since the attack does not make Unbound vulnerable, rather Unbound could
be used to take part in a DoS attack, we are using the industry-wide
CVE numbering and categorizing the vulnerability with a LOW severity
for Unbound.
== Summary
The DNSBomb attack, via specially timed DNS queries and answers, can
cause a Denial of Service on resolvers and spoofed targets.
Unbound itself is not vulnerable for DoS, rather it can be used to take
part in a pulsing DoS amplification attack.
Unbound 1.20.0 includes fixes so the impact of the DoS from Unbound is
significantly lower than it used to be and making the attack, and
Unbound's participation, less tempting for attackers.
== Affected products
Unbound up to and including 1.19.3.
== Description
The DNSBomb attack works by sending low-rate spoofed queries for a
malicious zone to Unbound. By controlling the delay of the malicious
authoritative answers, Unbound slowly accumulates pending answers for
the spoofed addresses. When the authoritative answers become available
to Unbound at the same time, Unbound starts serving all the accumulated
queries. This results into large-sized, concentrated response bursts
to the spoofed addresses.
From version 1.20.0 on, Unbound introduces a couple of configuration
options to help mitigate the impact.
Their complete description can be found in the included manpages but
they are also briefly listed here together with their default values for
convenience:
\* discard-timeout: 1900
After 1900 ms a reply to the client will be dropped.
Unbound would still work on the query but refrain from replying in
order to not accumulate a huge number of "old" replies.
Legitimate clients retry on timeouts.
\* wait-limit: 1000
wait-limit-cookie: 10000
Limits the amount of client queries that require recursion
(cache-hits are not counted) per IP address. More recursive queries
than the allowed limit are dropped. Clients with a valid EDNS Cookie
can have a different limit, higher by default.
wait-limit: 0 disables all wait limits.
\* wait-limit-netblock
wait-limit-cookie-netblock
These do not have a default value but they can fine grain
configuration for specific netblocks. With or without EDNS Cookies.
The options above are trying to shrink the DNSBomb window so that the
impact of the DoS from Unbound is significantly lower than it used to be
and making the attack, and Unbound's participation, less tempting for
attackers.
== Mitigation
=== Downloading patched version
Unbound 1.20.0 is released with the patch
https://nlnetlabs.nl/downloads/unbound/unbound-1.20.0.tar.gz
=== Applying the patch manually
For Unbound 1.19.3 the patch is:
https://nlnetlabs.nl/downloads/unbound/patch\_CVE-2024-33655.diff
Apply the patch on the Unbound source directory with:
patch -p1 < patch\_CVE-2024-33655.diff
then run 'make install' to install Unbound.
The patch is tested to work on Unbound 1.19.3.
== Acknowledgements
We would like to thank Xiang Li from the Network and Information
Security Lab of Tsinghua University for discovering and disclosing the
attack.


=== Content from lists.fedoraproject.org_938a75bc_20250111_071435.html ===


[![Fedora Mailing-Lists](/static/logo-hyperkitty-fedora.png)](/archives/ "Fedora Mailing-Lists")

[Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/QITY2QBX2OCBTZIXD2A5ES62STFIA4AL/)
[Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/QITY2QBX2OCBTZIXD2A5ES62STFIA4AL/)

* [Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/QITY2QBX2OCBTZIXD2A5ES62STFIA4AL/)
* [Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/QITY2QBX2OCBTZIXD2A5ES62STFIA4AL/)

* [Manage this list](/admin/lists/package-announce.lists.fedoraproject.org/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

### 2025

* [January](/archives/list/package-announce%40lists.fedoraproject.org/2025/1/)

### 2024

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2024/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2024/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2024/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2024/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2024/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2024/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2024/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2024/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2024/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2024/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2024/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2024/1/)

### 2023

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2023/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2023/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2023/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2023/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2023/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2023/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2023/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2023/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2023/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2023/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2023/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2023/1/)

### 2022

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2022/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2022/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2022/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2022/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2022/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2022/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2022/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2022/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2022/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2022/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2022/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2022/1/)

### 2021

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2021/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2021/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2021/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2021/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2021/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2021/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2021/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2021/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2021/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2021/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2021/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2021/1/)

### 2020

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2020/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2020/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2020/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2020/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2020/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2020/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2020/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2020/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2020/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2020/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2020/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2020/1/)

### 2019

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2019/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2019/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2019/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2019/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2019/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2019/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2019/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2019/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2019/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2019/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2019/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2019/1/)

### 2018

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2018/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2018/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2018/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2018/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2018/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2018/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2018/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2018/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2018/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2018/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2018/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2018/1/)

### 2017

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2017/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2017/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2017/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2017/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2017/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2017/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2017/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2017/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2017/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2017/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2017/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2017/1/)

### 2016

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2016/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2016/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2016/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2016/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2016/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2016/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2016/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2016/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2016/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2016/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2016/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2016/1/)

### 2015

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2015/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2015/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2015/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2015/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2015/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2015/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2015/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2015/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2015/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2015/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2015/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2015/1/)

### 2014

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2014/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2014/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2014/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2014/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2014/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2014/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2014/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2014/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2014/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2014/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2014/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2014/1/)

### 2013

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2013/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2013/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2013/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2013/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2013/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2013/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2013/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2013/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2013/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2013/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2013/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2013/1/)

### 2012

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2012/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2012/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2012/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2012/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2012/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2012/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2012/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2012/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2012/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2012/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2012/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2012/1/)

### 2011

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2011/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2011/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2011/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2011/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2011/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2011/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2011/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2011/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2011/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2011/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2011/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2011/1/)

### 2010

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2010/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2010/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2010/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2010/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2010/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2010/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2010/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2010/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2010/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2010/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2010/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2010/1/)

### 2009

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2009/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2009/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2009/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2009/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2009/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2009/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2009/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2009/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2009/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2009/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2009/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2009/1/)

### 2008

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2008/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2008/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2008/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2008/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2008/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2008/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2008/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2008/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2008/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2008/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2008/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2008/1/)

### 2007

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2007/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2007/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2007/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2007/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2007/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2007/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2007/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2007/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2007/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2007/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2007/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2007/1/)

### 2006

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2006/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2006/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2006/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2006/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2006/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2006/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2006/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2006/5/)

[List overview](/archives/list/package-announce%40lists.fedoraproject.org/)

[Download](/archives/list/package-announce%40lists.fedoraproject.org/export/package-announce%40lists.fedoraproject.org-QITY2QBX2OCBTZIXD2A5ES62STFIA4AL.mbox.gz?message=QITY2QBX2OCBTZIXD2A5ES62STFIA4AL "This message in gzipped mbox format")

[thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/QITY2QBX2OCBTZIXD2A5ES62STFIA4AL/#QITY2QBX2OCBTZIXD2A5ES62STFIA4AL)

# [SECURITY] Fedora 39 Update: unbound-1.20.0-1.fc39

![](https://seccdn.libravatar.org/avatar/be256568dfce45c1862b55e6cf3f2726.jpg?s=120&d=retro&r=g)

[updates＠fedoraproject.org](/archives/users/3d8bb2e4c1d843beb492d4f8a7c44761/ "See the profile for updates＠fedoraproject.org")

22 May
2024

22 May
'24

8:14 p.m.

--------------------------------------------------------------------------------
Fedora Update Notification
FEDORA-2024-9df760819c
2024-05-23 01:13:35.069545
--------------------------------------------------------------------------------

Name : unbound
Product : Fedora 39
Version : 1.20.0
Release : 1.fc39
URL : <https://nlnetlabs.nl/projects/unbound/>
Summary : Validating, recursive, and caching DNS(SEC) resolver
Description :
Unbound is a validating, recursive, and caching DNS(SEC) resolver.

The C implementation of Unbound is developed and maintained by NLnet
Labs. It is based on ideas and algorithms taken from a java prototype
developed by Verisign labs, Nominet, Kirei and ep.net.

Unbound is designed as a set of modular components, so that also
DNSSEC (secure DNS) validation and stub-resolvers (that do not run
as a server, but are linked into an application) are easily possible.

--------------------------------------------------------------------------------
Update Information:

Unbound 1.20.0
<https://github.com/NLnetLabs/unbound/releases/tag/release-1.20.0>
DNSBomb limitation fixes
--------------------------------------------------------------------------------
ChangeLog:

\* Fri May 10 2024 Petr Men����k pemensik@redhat.com - 1.20.0-1
- Update to 1.20.0
--------------------------------------------------------------------------------
References:

[ 1 ] Bug #2279944 - CVE-2024-33655 unbound: DNSBomb vulnerability [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=2279944>
--------------------------------------------------------------------------------

This update can be installed with the "dnf" update program. Use
su -c 'dnf upgrade --advisory FEDORA-2024-9df760819c' at the command
line. For more information, refer to the dnf documentation available at
<http://dnf.readthedocs.io/en/latest/command_ref.html#upgrade-command-label>

All packages are signed with the Fedora Project GPG key. More details on the
GPG keys used by the Fedora Project can be found at
<https://fedoraproject.org/keys>
--------------------------------------------------------------------------------

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Back to the thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/QITY2QBX2OCBTZIXD2A5ES62STFIA4AL/#QITY2QBX2OCBTZIXD2A5ES62STFIA4AL)

[Back to the list](/archives/list/package-announce%40lists.fedoraproject.org/)

Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.7.



=== Content from datatracker.ietf.org_b4efd235_20250111_071430.html ===


* Light
* Dark
* Auto

[RFC 1035

Internet Standard](/doc/rfc1035/)

|  | Title |  | Domain names - implementation and specification |
| --- | --- | --- | --- |
| Document | Document type |  | RFC - Internet Standard  November 1987  [View errata](https://www.rfc-editor.org/errata_search.php?rfc=1035 "Click to view errata.") [Report errata](https://www.rfc-editor.org/errata.php#reportnew "Click to report an error in the document.") Updated by [RFC 1101](/doc/html/rfc1101 "DNS encoding of network names and other types"), [RFC 1183](/doc/html/rfc1183 "New DNS RR Definitions"), [RFC 1348](/doc/html/rfc1348 "DNS NSAP RRs"), [RFC 8490](/doc/html/rfc8490 "DNS Stateful Operations"), [RFC 8482](/doc/html/rfc8482 "Providing Minimal-Sized Responses to DNS Queries That Have QTYPE=ANY"), [RFC 8767](/doc/html/rfc8767 "Serving Stale Data to Improve DNS Resiliency"), [RFC 2308](/doc/html/rfc2308 "Negative Caching of DNS Queries (DNS NCACHE)"), [RFC 2137](/doc/html/rfc2137 "Secure Domain Name System Dynamic Update"), [RFC 2181](/doc/html/rfc2181 "Clarifications to the DNS Specification"), [RFC 1982](/doc/html/rfc1982 "Serial Number Arithmetic"), [RFC 2136](/doc/html/rfc2136 "Dynamic Updates in the Domain Name System (DNS UPDATE)"), [RFC 1996](/doc/html/rfc1996 "A Mechanism for Prompt Notification of Zone Changes (DNS NOTIFY)"), [RFC 1995](/doc/html/rfc1995 "Incremental Zone Transfer in DNS"), [RFC 1876](/doc/html/rfc1876 "A Means for Expressing Location Information in the Domain Name System"), [RFC 2065](/doc/html/rfc2065 "Domain Name System Security Extensions"), [RFC 4034](/doc/html/rfc4034 "Resource Records for the DNS Security Extensions"), [RFC 4035](/doc/html/rfc4035 "Protocol Modifications for the DNS Security Extensions"), [RFC 4343](/doc/html/rfc4343 "Domain Name System (DNS) Case Insensitivity Clarification"), [RFC 5966](/doc/html/rfc5966 "DNS Transport over TCP - Implementation Requirements"), [RFC 6604](/doc/html/rfc6604 "xNAME RCODE and Status Bits Clarification"), [RFC 2535](/doc/html/rfc2535 "Domain Name System Security Extensions"), [RFC 2673](/doc/html/rfc2673 "Binary Labels in the Domain Name System"), [RFC 2845](/doc/html/rfc2845 "Secret Key Transaction Authentication for DNS (TSIG)"), [RFC 5936](/doc/html/rfc5936 "DNS Zone Transfer Protocol (AXFR)"), [RFC 3425](/doc/html/rfc3425 "Obsoleting IQUERY"), [RFC 3658](/doc/html/rfc3658 "Delegation Signer (DS) Resource Record (RR)"), [RFC 4033](/doc/html/rfc4033 "DNS Security Introduction and Requirements"), [RFC 7766](/doc/html/rfc7766 "DNS Transport over TCP - Implementation Requirements"), [RFC 9619](/doc/html/rfc9619 "In the DNS, QDCOUNT Is (Usually) One") Obsoletes [RFC 882](/doc/html/rfc882 "Domain names: Concepts and facilities"), [RFC 883](/doc/html/rfc883 "Domain names: Implementation specification"), [RFC 973](/doc/html/rfc973 "Domain system changes and observations") |
| --- | --- | --- | --- |
|  | Select version |  | * [RFC 1035](/doc/html/rfc1035) |
|  | Authors |  | Email authors |
|  | RFC stream |  | Legacy |
|  | Other formats |  | [txt](https://www.rfc-editor.org/rfc/rfc1035.txt) [html](https://www.rfc-editor.org/rfc/rfc1035.html) [pdf](https://www.rfc-editor.org/rfc/pdfrfc/rfc1035.txt.pdf) [w/errata](https://www.rfc-editor.org/rfc/inline-errata/rfc1035.html) [bibtex](/doc/rfc1035/bibtex/) |
|  | Additional resources |  | Mailing list discussion |
|  |  |  | [Report a bug](https://github.com/ietf-tools/datatracker/issues/new/choose) |

```
Network Working Group                                     P. Mockapetris
Request for Comments: 1035                                           ISI
                                                           November 1987
Obsoletes: RFCs [882](/doc/html/rfc882), [883](/doc/html/rfc883), [973](/doc/html/rfc973)

            DOMAIN NAMES - IMPLEMENTATION AND SPECIFICATION

[1](#section-1). STATUS OF THIS MEMO

This RFC describes the details of the domain system and protocol, and
assumes that the reader is familiar with the concepts discussed in a
companion RFC, "Domain Names - Concepts and Facilities" [[RFC-1034](/doc/html/rfc1034)].

The domain system is a mixture of functions and data types which are an
official protocol and functions and data types which are still
experimental.  Since the domain system is intentionally extensible, new
data types and experimental behavior should always be expected in parts
of the system beyond the official protocol.  The official protocol parts
include standard queries, responses and the Internet class RR data
formats (e.g., host addresses).  Since the previous RFC set, several
definitions have changed, so some previous definitions are obsolete.

Experimental or obsolete features are clearly marked in these RFCs, and
such information should be used with caution.

The reader is especially cautioned not to depend on the values which
appear in examples to be current or complete, since their purpose is
primarily pedagogical.  Distribution of this memo is unlimited.

                           Table of Contents

  1. STATUS OF THIS MEMO                                              1
  2. INTRODUCTION                                                     3
      2.1. Overview                                                   3
      2.2. Common configurations                                      4
      2.3. Conventions                                                7
          2.3.1. Preferred name syntax                                7
          2.3.2. Data Transmission Order                              8
          2.3.3. Character Case                                       9
          2.3.4. Size limits                                         10
  3. DOMAIN NAME SPACE AND RR DEFINITIONS                            10
      3.1. Name space definitions                                    10
      3.2. RR definitions                                            11
          3.2.1. Format                                              11
          3.2.2. TYPE values                                         12
          3.2.3. QTYPE values                                        12
          3.2.4. CLASS values                                        13

Mockapetris                                                     [Page 1]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

          3.2.5. QCLASS values                                       13
      3.3. Standard RRs                                              13
          3.3.1. CNAME RDATA format                                  14
          3.3.2. HINFO RDATA format                                  14
          3.3.3. MB RDATA format (EXPERIMENTAL)                      14
          3.3.4. MD RDATA format (Obsolete)                          15
          3.3.5. MF RDATA format (Obsolete)                          15
          3.3.6. MG RDATA format (EXPERIMENTAL)                      16
          3.3.7. MINFO RDATA format (EXPERIMENTAL)                   16
          3.3.8. MR RDATA format (EXPERIMENTAL)                      17
          3.3.9. MX RDATA format                                     17
          3.3.10. NULL RDATA format (EXPERIMENTAL)                   17
          3.3.11. NS RDATA format                                    18
          3.3.12. PTR RDATA format                                   18
          3.3.13. SOA RDATA format                                   19
          3.3.14. TXT RDATA format                                   20
      3.4. ARPA Internet specific RRs                                20
          3.4.1. A RDATA format                                      20
          3.4.2. WKS RDATA format                                    21
      3.5. IN-ADDR.ARPA domain                                       22
      3.6. Defining new types, classes, and special namespaces       24
  4. MESSAGES                                                        25
      4.1. Format                                                    25
          4.1.1. Header section format                               26
          4.1.2. Question section format                             28
          4.1.3. Resource record format                              29
          4.1.4. Message compression                                 30
      4.2. Transport                                                 32
          4.2.1. UDP usage                                           32
          4.2.2. TCP usage                                           32
  5. MASTER FILES                                                    33
      5.1. Format                                                    33
      5.2. Use of master files to define zones                       35
      5.3. Master file example                                       36
  6. NAME SERVER IMPLEMENTATION                                      37
      6.1. Architecture                                              37
          6.1.1. Control                                             37
          6.1.2. Database                                            37
          6.1.3. Time                                                39
      6.2. Standard query processing                                 39
      6.3. Zone refresh and reload processing                        39
      6.4. Inverse queries (Optional)                                40
          6.4.1. The contents of inverse queries and responses       40
          6.4.2. Inverse query and response example                  41
          6.4.3. Inverse query processing                            42

Mockapetris                                                     [Page 2]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

      6.5. Completion queries and responses                          42
  7. RESOLVER IMPLEMENTATION                                         43
      7.1. Transforming a user request into a query                  43
      7.2. Sending the queries                                       44
      7.3. Processing responses                                      46
      7.4. Using the cache                                           47
  8. MAIL SUPPORT                                                    47
      8.1. Mail exchange binding                                     48
      8.2. Mailbox binding (Experimental)                            48
  9. REFERENCES and BIBLIOGRAPHY                                     50
  Index                                                              54

[2](#section-2). INTRODUCTION

[2.1](#section-2.1). Overview

The goal of domain names is to provide a mechanism for naming resources
in such a way that the names are usable in different hosts, networks,
protocol families, internets, and administrative organizations.

From the user's point of view, domain names are useful as arguments to a
local agent, called a resolver, which retrieves information associated
with the domain name.  Thus a user might ask for the host address or
mail information associated with a particular domain name.  To enable
the user to request a particular type of information, an appropriate
query type is passed to the resolver with the domain name.  To the user,
the domain tree is a single information space; the resolver is
responsible for hiding the distribution of data among name servers from
the user.

From the resolver's point of view, the database that makes up the domain
space is distributed among various name servers.  Different parts of the
domain space are stored in different name servers, although a particular
data item will be stored redundantly in two or more name servers.  The
resolver starts with knowledge of at least one name server.  When the
resolver processes a user query it asks a known name server for the
information; in return, the resolver either receives the desired
information or a referral to another name server.  Using these
referrals, resolvers learn the identities and contents of other name
servers.  Resolvers are responsible for dealing with the distribution of
the domain space and dealing with the effects of name server failure by
consulting redundant databases in other servers.

Name servers manage two kinds of data.  The first kind of data held in
sets called zones; each zone is the complete database for a particular
"pruned" subtree of the domain space.  This data is called
authoritative.  A name server periodically checks to make sure that its
zones are up to date, and if not, obtains a new copy of updated zones

Mockapetris                                                     [Page 3]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

from master files stored locally or in another name server.  The second
kind of data is cached data which was acquired by a local resolver.
This data may be incomplete, but improves the performance of the
retrieval process when non-local data is repeatedly accessed.  Cached
data is eventually discarded by a timeout mechanism.

This functional structure isolates the problems of user interface,
failure recovery, and distribution in the resolvers and isolates the
database update and refresh problems in the name servers.

[2.2](#section-2.2). Common configurations

A host can participate in the domain name system in a number of ways,
depending on whether the host runs programs that retrieve information
from the domain system, name servers that answer queries from other
hosts, or various combinations of both functions.  The simplest, and
perhaps most typical, configuration is shown below:

                 Local Host                        |  Foreign
                                                   |
    +---------+               +----------+         |  +--------+
    |         | user queries  |          |queries  |  |        |
    |  User   |-------------->|          |---------|->|Foreign |
    | Program |               | Resolver |         |  |  Name  |
    |         |<--------------|          |<--------|--| Server |
    |         | user responses|          |responses|  |        |
    +---------+               +----------+         |  +--------+
                                |     A            |
                cache additions |     | references |
                                V     |            |
                              +----------+         |
                              |  cache   |         |
                              +----------+         |

User programs interact with the domain name space through resolvers; the
format of user queries and user responses is specific to the host and
its operating system.  User queries will typically be operating system
calls, and the resolver and its cache will be part of the host operating
system.  Less capable hosts may choose to implement the resolver as a
subroutine to be linked in with every program that needs its services.
Resolvers answer user queries with information they acquire via queries
to foreign name servers and the local cache.

Note that the resolver may have to make several queries to several
different foreign name servers to answer a particular user query, and
hence the resolution of a user query may involve several network
accesses and an arbitrary amount of time.  The queries to foreign name
servers and the corresponding responses have a standard format described

Mockapetris                                                     [Page 4]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

in this memo, and may be datagrams.

Depending on its capabilities, a name server could be a stand alone
program on a dedicated machine or a process or processes on a large
timeshared host.  A simple configuration might be:

                 Local Host                        |  Foreign
                                                   |
      +---------+                                  |
     /         /|                                  |
    +---------+ |             +----------+         |  +--------+
    |         | |             |          |responses|  |        |
    |         | |             |   Name   |---------|->|Foreign |
    |  Master |-------------->|  Server  |         |  |Resolver|
    |  files  | |             |          |<--------|--|        |
    |         |/              |          | queries |  +--------+
    +---------+               +----------+         |

Here a primary name server acquires information about one or more zones
by reading master files from its local file system, and answers queries
about those zones that arrive from foreign resolvers.

The DNS requires that all zones be redundantly supported by more than
one name server.  Designated secondary servers can acquire zones and
check for updates from the primary server using the zone transfer
protocol of the DNS.  This configuration is shown below:

                 Local Host                        |  Foreign
                                                   |
      +---------+                                  |
     /         /|                                  |
    +---------+ |             +----------+         |  +--------+
    |         | |             |          |responses|  |        |
    |         | |             |   Name   |---------|->|Foreign |
    |  Master |-------------->|  Server  |         |  |Resolver|
    |  files  | |             |          |<--------|--|        |
    |         |/              |          | queries |  +--------+
    +---------+               +----------+         |
                                A     |maintenance |  +--------+
                                |     +------------|->|        |
                                |      queries     |  |Foreign |
                                |                  |  |  Name  |
                                +------------------|--| Server |
                             maintenance responses |  +--------+

In this configuration, the name server periodically establishes a
virtual circuit to a foreign name server to acquire a copy of a zone or
to check that an existing copy has not changed.  The messages sent for

Mockapetris                                                     [Page 5]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

these maintenance activities follow the same form as queries and
responses, but the message sequences are somewhat different.

The information flow in a host that supports all aspects of the domain
name system is shown below:

                 Local Host                        |  Foreign
                                                   |
    +---------+               +----------+         |  +--------+
    |         | user queries  |          |queries  |  |        |
    |  User   |-------------->|          |---------|->|Foreign |
    | Program |               | Resolver |         |  |  Name  |
    |         |<--------------|          |<--------|--| Server |
    |         | user responses|          |responses|  |        |
    +---------+               +----------+         |  +--------+
                                |     A            |
                cache additions |     | references |
                                V     |            |
                              +----------+         |
                              |  Shared  |         |
                              | database |         |
                              +----------+         |
                                A     |            |
      +---------+     refreshes |     | references |
     /         /|               |     V            |
    +---------+ |             +----------+         |  +--------+
    |         | |             |          |responses|  |        |
    |         | |             |   Name   |---------|->|Foreign |
    |  Master |-------------->|  Server  |         |  |Resolver|
    |  files  | |             |          |<--------|--|        |
    |         |/              |          | queries |  +--------+
    +---------+               +----------+         |
                                A     |maintenance |  +--------+
                                |     +------------|->|        |
                                |      queries     |  |Foreign |
                                |                  |  |  Name  |
                                +------------------|--| Server |
                             maintenance responses |  +--------+

The shared database holds domain space data for the local name server
and resolver.  The contents of the shared database will typically be a
mixture of authoritative data maintained by the periodic refresh
operations of the name server and cached data from previous resolver
requests.  The structure of the domain data and the necessity for
synchronization between name servers and resolvers imply the general
characteristics of this database, but the actual format is up to the
local implementor.

Mockapetris                                                     [Page 6]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

Information flow can also be tailored so that a group of hosts act
together to optimize activities.  Sometimes this is done to offload less
capable hosts so that they do not have to implement a full resolver.
This can be appropriate for PCs or hosts which want to minimize the
amount of new network code which is required.  This scheme can also
allow a group of hosts can share a small number of caches rather than
maintaining a large number of separate caches, on the premise that the
centralized caches will have a higher hit ratio.  In either case,
resolvers are replaced with stub resolvers which act as front ends to
resolvers located in a recursive server in one or more name servers
known to perform that service:

                   Local Hosts                     |  Foreign
                                                   |
    +---------+                                    |
    |         | responses                          |
    | Stub    |<--------------------+              |
    | Resolver|                     |              |
    |         |----------------+    |              |
    +---------+ recursive      |    |              |
                queries        |    |              |
                               V    |              |
    +---------+ recursive     +----------+         |  +--------+
    |         | queries       |          |queries  |  |        |
    | Stub    |-------------->| Recursive|---------|->|Foreign |
    | Resolver|               | Server   |         |  |  Name  |
    |         |<--------------|          |<--------|--| Server |
    +---------+ responses     |          |responses|  |        |
                              +----------+         |  +--------+
                              |  Central |         |
                              |   cache  |         |
                              +----------+         |

In any case, note that domain components are always replicated for
reliability whenever possible.

[2.3](#section-2.3). Conventions

The domain system has several conventions dealing with low-level, but
fundamental, issues.  While the implementor is free to violate these
conventions WITHIN HIS OWN SYSTEM, he must observe these conventions in
ALL behavior observed from other hosts.

[2.3.1](#section-2.3.1). Preferred name syntax

The DNS specifications attempt to be as general as possible in the rules
for constructing domain names.  The idea is that the name of any
existing object can be expressed as a domain name with minimal changes.

Mockapetris                                                     [Page 7]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

However, when assigning a domain name for an object, the prudent user
will select a name which satisfies both the rules of the domain system
and any existing rules for the object, whether these rules are published
or implied by existing programs.

For example, when naming a mail domain, the user should satisfy both the
rules of this memo and those in [RFC-822](/doc/html/rfc822).  When creating a new host name,
the old rules for HOSTS.TXT should be followed.  This avoids problems
when old software is converted to use domain names.

The following syntax will result in fewer problems with many

applications that use domain names (e.g., mail, TELNET).

<domain> ::= <subdomain> | " "

<subdomain> ::= <label> | <subdomain> "." <label>

<label> ::= <letter> [ [ <ldh-str> ] <let-dig> ]

<ldh-str> ::= <let-dig-hyp> | <let-dig-hyp> <ldh-str>

<let-dig-hyp> ::= <let-dig> | "-"

<let-dig> ::= <letter> | <digit>

<letter> ::= any one of the 52 alphabetic characters A through Z in
upper case and a through z in lower case

<digit> ::= any one of the ten digits 0 through 9

Note that while upper and lower case letters are allowed in domain
names, no significance is attached to the case.  That is, two names with
the same spelling but different case are to be treated as if identical.

The labels must follow the rules for ARPANET host names.  They must
start with a letter, end with a letter or digit, and have as interior
characters only letters, digits, and hyphen.  There are also some
restrictions on the length.  Labels must be 63 characters or less.

For example, the following strings identify hosts in the Internet:

A.ISI.EDU XX.LCS.MIT.EDU SRI-NIC.ARPA

[2.3.2](#section-2.3.2). Data Transmission Order

The order of transmission of the header and data described in this
document is resolved to the octet level.  Whenever a diagram shows a

Mockapetris                                                     [Page 8]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

group of octets, the order of transmission of those octets is the normal
order in which they are read in English.  For example, in the following
diagram, the octets are transmitted in the order they are numbered.

     0                   1
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |       1       |       2       |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |       3       |       4       |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |       5       |       6       |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Whenever an octet represents a numeric quantity, the left most bit in
the diagram is the high order or most significant bit.  That is, the bit
labeled 0 is the most significant bit.  For example, the following
diagram represents the value 170 (decimal).

     0 1 2 3 4 5 6 7
    +-+-+-+-+-+-+-+-+
    |1 0 1 0 1 0 1 0|
    +-+-+-+-+-+-+-+-+

Similarly, whenever a multi-octet field represents a numeric quantity
the left most bit of the whole field is the most significant bit.  When
a multi-octet quantity is transmitted the most significant octet is
transmitted first.

[2.3.3](#section-2.3.3). Character Case

For all parts of the DNS that are part of the official protocol, all
comparisons between character strings (e.g., labels, domain names, etc.)
are done in a case-insensitive manner.  At present, this rule is in
force throughout the domain system without exception.  However, future
additions beyond current usage may need to use the full binary octet
capabilities in names, so attempts to store domain names in 7-bit ASCII
or use of special bytes to terminate labels, etc., should be avoided.

When data enters the domain system, its original case should be
preserved whenever possible.  In certain circumstances this cannot be
done.  For example, if two RRs are stored in a database, one at x.y and
one at X.Y, they are actually stored at the same place in the database,
and hence only one casing would be preserved.  The basic rule is that
case can be discarded only when data is used to define structure in a
database, and two names are identical when compared in a case
insensitive manner.

Mockapetris                                                     [Page 9]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

Loss of case sensitive data must be minimized.  Thus while data for x.y
and X.Y may both be stored under a single location x.y or X.Y, data for
a.x and B.X would never be stored under A.x, A.X, b.x, or b.X.  In
general, this preserves the case of the first label of a domain name,
but forces standardization of interior node labels.

Systems administrators who enter data into the domain database should
take care to represent the data they supply to the domain system in a
case-consistent manner if their system is case-sensitive.  The data
distribution system in the domain system will ensure that consistent
representations are preserved.

[2.3.4](#section-2.3.4). Size limits

Various objects and parameters in the DNS have size limits.  They are
listed below.  Some could be easily changed, others are more
fundamental.

labels          63 octets or less

names           255 octets or less

TTL             positive values of a signed 32 bit number.

UDP messages    512 octets or less

[3](#section-3). DOMAIN NAME SPACE AND RR DEFINITIONS

[3.1](#section-3.1). Name space definitions

Domain names in messages are expressed in terms of a sequence of labels.
Each label is represented as a one octet length field followed by that
number of octets.  Since every domain name ends with the null label of
the root, a domain name is terminated by a length byte of zero.  The
high order two bits of every length octet must be zero, and the
remaining six bits of the length field limit the label to 63 octets or
less.

To simplify implementations, the total length of a domain name (i.e.,
label octets and label length octets) is restricted to 255 octets or
less.

Although labels can contain any 8 bit values in octets that make up a
label, it is strongly recommended that labels follow the preferred
syntax described elsewhere in this memo, which is compatible with
existing host naming conventions.  Name servers and resolvers must
compare labels in a case-insensitive manner (i.e., A=a), assuming ASCII
with zero parity.  Non-alphabetic codes must match exactly.

Mockapetris                                                    [Page 10]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

[3.2](#section-3.2). RR definitions

[3.2.1](#section-3.2.1). Format

All RRs have the same top level format shown below:

                                    1  1  1  1  1  1
      0  1  2  3  4  5  6  7  8  9  0  1  2  3  4  5
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                                               |
    /                                               /
    /                      NAME                     /
    |                                               |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                      TYPE                     |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                     CLASS                     |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                      TTL                      |
    |                                               |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                   RDLENGTH                    |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--|
    /                     RDATA                     /
    /                                               /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+

where:

NAME            an owner name, i.e., the name of the node to which this
                resource record pertains.

TYPE            two octets containing one of the RR TYPE codes.

CLASS           two octets containing one of the RR CLASS codes.

TTL             a 32 bit signed integer that specifies the time interval
                that the resource record may be cached before the source
                of the information should again be consulted.  Zero
                values are interpreted to mean that the RR can only be
                used for the transaction in progress, and should not be
                cached.  For example, SOA records are always distributed
                with a zero TTL to prohibit caching.  Zero values can
                also be used for extremely volatile data.

RDLENGTH        an unsigned 16 bit integer that specifies the length in
                octets of the RDATA field.

Mockapetris                                                    [Page 11]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

RDATA           a variable length string of octets that describes the
                resource.  The format of this information varies
                according to the TYPE and CLASS of the resource record.

[3.2.2](#section-3.2.2). TYPE values

TYPE fields are used in resource records.  Note that these types are a
subset of QTYPEs.

TYPE            value and meaning

A               1 a host address

NS              2 an authoritative name server

MD              3 a mail destination (Obsolete - use MX)

MF              4 a mail forwarder (Obsolete - use MX)

CNAME           5 the canonical name for an alias

SOA             6 marks the start of a zone of authority

MB              7 a mailbox domain name (EXPERIMENTAL)

MG              8 a mail group member (EXPERIMENTAL)

MR              9 a mail rename domain name (EXPERIMENTAL)

NULL            10 a null RR (EXPERIMENTAL)

WKS             11 a well known service description

PTR             12 a domain name pointer

HINFO           13 host information

MINFO           14 mailbox or mail list information

MX              15 mail exchange

TXT             16 text strings

[3.2.3](#section-3.2.3). QTYPE values

QTYPE fields appear in the question part of a query.  QTYPES are a
superset of TYPEs, hence all TYPEs are valid QTYPEs.  In addition, the
following QTYPEs are defined:

Mockapetris                                                    [Page 12]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

AXFR            252 A request for a transfer of an entire zone

MAILB           253 A request for mailbox-related records (MB, MG or MR)

MAILA           254 A request for mail agent RRs (Obsolete - see MX)

*               255 A request for all records

[3.2.4](#section-3.2.4). CLASS values

CLASS fields appear in resource records.  The following CLASS mnemonics
and values are defined:

IN              1 the Internet

CS              2 the CSNET class (Obsolete - used only for examples in
                some obsolete RFCs)

CH              3 the CHAOS class

HS              4 Hesiod [Dyer 87]

[3.2.5](#section-3.2.5). QCLASS values

QCLASS fields appear in the question section of a query.  QCLASS values
are a superset of CLASS values; every CLASS is a valid QCLASS.  In
addition to CLASS values, the following QCLASSes are defined:

*               255 any class

[3.3](#section-3.3). Standard RRs

The following RR definitions are expected to occur, at least
potentially, in all classes.  In particular, NS, SOA, CNAME, and PTR
will be used in all classes, and have the same format in all classes.
Because their RDATA format is known, all domain names in the RDATA
section of these RRs may be compressed.

<domain-name> is a domain name represented as a series of labels, and
terminated by a label with zero length.  <character-string> is a single
length octet followed by that number of characters.  <character-string>
is treated as binary information, and can be up to 256 characters in
length (including the length octet).

Mockapetris                                                    [Page 13]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

[3.3.1](#section-3.3.1). CNAME RDATA format

    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    /                     CNAME                     /
    /                                               /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+

where:

CNAME           A <domain-name> which specifies the canonical or primary
                name for the owner.  The owner name is an alias.

CNAME RRs cause no additional section processing, but name servers may
choose to restart the query at the canonical name in certain cases.  See
the description of name server logic in [[RFC-1034](/doc/html/rfc1034)] for details.

[3.3.2](#section-3.3.2). HINFO RDATA format

    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    /                      CPU                      /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    /                       OS                      /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+

where:

CPU             A <character-string> which specifies the CPU type.

OS              A <character-string> which specifies the operating
                system type.

Standard values for CPU and OS can be found in [[RFC-1010](/doc/html/rfc1010 "\"Assigned Numbers\"")].

HINFO records are used to acquire general information about a host.  The
main use is for protocols such as FTP that can use special procedures
when talking between machines or operating systems of the same type.

[3.3.3](#section-3.3.3). MB RDATA format (EXPERIMENTAL)

    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    /                   MADNAME                     /
    /                                               /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+

where:

MADNAME         A <domain-name> which specifies a host which has the
                specified mailbox.

Mockapetris                                                    [Page 14]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

MB records cause additional section processing which looks up an A type
RRs corresponding to MADNAME.

[3.3.4](#section-3.3.4). MD RDATA format (Obsolete)

    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    /                   MADNAME                     /
    /                                               /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+

where:

MADNAME         A <domain-name> which specifies a host which has a mail
                agent for the domain which should be able to deliver
                mail for the domain.

MD records cause additional section processing which looks up an A type
record corresponding to MADNAME.

MD is obsolete.  See the definition of MX and [[RFC-974](/doc/html/rfc974 "\"Mail routing and the domain system\"")] for details of
the new scheme.  The recommended policy for dealing with MD RRs found in
a master file is to reject them, or to convert them to MX RRs with a
preference of 0.

[3.3.5](#section-3.3.5). MF RDATA format (Obsolete)

    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    /                   MADNAME                     /
    /                                               /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+

where:

MADNAME         A <domain-name> which specifies a host which has a mail
                agent for the domain which will accept mail for
                forwarding to the domain.

MF records cause additional section processing which looks up an A type
record corresponding to MADNAME.

MF is obsolete.  See the definition of MX and [[RFC-974](/doc/html/rfc974 "\"Mail routing and the domain system\"")] for details ofw
the new scheme.  The recommended policy for dealing with MD RRs found in
a master file is to reject them, or to convert them to MX RRs with a
preference of 10.

Mockapetris                                                    [Page 15]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

[3.3.6](#section-3.3.6). MG RDATA format (EXPERIMENTAL)

    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    /                   MGMNAME                     /
    /                                               /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+

where:

MGMNAME         A <domain-name> which specifies a mailbox which is a
                member of the mail group specified by the domain name.

MG records cause no additional section processing.

[3.3.7](#section-3.3.7). MINFO RDATA format (EXPERIMENTAL)

    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    /                    RMAILBX                    /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    /                    EMAILBX                    /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+

where:

RMAILBX         A <domain-name> which specifies a mailbox which is
                responsible for the mailing list or mailbox.  If this
                domain name names the root, the owner of the MINFO RR is
                responsible for itself.  Note that many existing mailing
                lists use a mailbox X-request for the RMAILBX field of
                mailing list X, e.g., Msgroup-request for Msgroup.  This
                field provides a more general mechanism.

EMAILBX         A <domain-name> which specifies a mailbox which is to
                receive error messages related to the mailing list or
                mailbox specified by the owner of the MINFO RR (similar
                to the ERRORS-TO: field which has been proposed).  If
                this domain name names the root, errors should be
                returned to the sender of the message.

MINFO records cause no additional section processing.  Although these
records can be associated with a simple mailbox, they are usually used
with a mailing list.

Mockapetris                                                    [Page 16]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

[3.3.8](#section-3.3.8). MR RDATA format (EXPERIMENTAL)

    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    /                   NEWNAME                     /
    /                                               /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+

where:

NEWNAME         A <domain-name> which specifies a mailbox which is the
                proper rename of the specified mailbox.

MR records cause no additional section processing.  The main use for MR
is as a forwarding entry for a user who has moved to a different
mailbox.

[3.3.9](#section-3.3.9). MX RDATA format

    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                  PREFERENCE                   |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    /                   EXCHANGE                    /
    /                                               /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+

where:

PREFERENCE      A 16 bit integer which specifies the preference given to
                this RR among others at the same owner.  Lower values
                are preferred.

EXCHANGE        A <domain-name> which specifies a host willing to act as
                a mail exchange for the owner name.

MX records cause type A additional section processing for the host
specified by EXCHANGE.  The use of MX RRs is explained in detail in
[[RFC-974](/doc/html/rfc974 "\"Mail routing and the domain system\"")].

[3.3.10](#section-3.3.10). NULL RDATA format (EXPERIMENTAL)

    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    /                  <anything>                   /
    /                                               /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+

Anything at all may be in the RDATA field so long as it is 65535 octets
or less.

Mockapetris                                                    [Page 17]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

NULL records cause no additional section processing.  NULL RRs are not
allowed in master files.  NULLs are used as placeholders in some
experimental extensions of the DNS.

[3.3.11](#section-3.3.11). NS RDATA format

    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    /                   NSDNAME                     /
    /                                               /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+

where:

NSDNAME         A <domain-name> which specifies a host which should be
                authoritative for the specified class and domain.

NS records cause both the usual additional section processing to locate
a type A record, and, when used in a referral, a special search of the
zone in which they reside for glue information.

The NS RR states that the named host should be expected to have a zone
starting at owner name of the specified class.  Note that the class may
not indicate the protocol family which should be used to communicate
with the host, although it is typically a strong hint.  For example,
hosts which are name servers for either Internet (IN) or Hesiod (HS)
class information are normally queried using IN class protocols.

[3.3.12](#section-3.3.12). PTR RDATA format

    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    /                   PTRDNAME                    /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+

where:

PTRDNAME        A <domain-name> which points to some location in the
                domain name space.

PTR records cause no additional section processing.  These RRs are used
in special domains to point to some other location in the domain space.
These records are simple data, and don't imply any special processing
similar to that performed by CNAME, which identifies aliases.  See the
description of the IN-ADDR.ARPA domain for an example.

Mockapetris                                                    [Page 18]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

[3.3.13](#section-3.3.13). SOA RDATA format

    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    /                     MNAME                     /
    /                                               /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    /                     RNAME                     /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                    SERIAL                     |
    |                                               |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                    REFRESH                    |
    |                                               |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                     RETRY                     |
    |                                               |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                    EXPIRE                     |
    |                                               |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                    MINIMUM                    |
    |                                               |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+

where:

MNAME           The <domain-name> of the name server that was the
                original or primary source of data for this zone.

RNAME           A <domain-name> which specifies the mailbox of the
                person responsible for this zone.

SERIAL          The unsigned 32 bit version number of the original copy
                of the zone.  Zone transfers preserve this value.  This
                value wraps and should be compared using sequence space
                arithmetic.

REFRESH         A 32 bit time interval before the zone should be
                refreshed.

RETRY           A 32 bit time interval that should elapse before a
                failed refresh should be retried.

EXPIRE          A 32 bit time value that specifies the upper limit on
                the time interval that can elapse before the zone is no
                longer authoritative.

Mockapetris                                                    [Page 19]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

MINIMUM         The unsigned 32 bit minimum TTL field that should be
                exported with any RR from this zone.

SOA records cause no additional section processing.

All times are in units of seconds.

Most of these fields are pertinent only for name server maintenance
operations.  However, MINIMUM is used in all query operations that
retrieve RRs from a zone.  Whenever a RR is sent in a response to a
query, the TTL field is set to the maximum of the TTL field from the RR
and the MINIMUM field in the appropriate SOA.  Thus MINIMUM is a lower
bound on the TTL field for all RRs in a zone.  Note that this use of
MINIMUM should occur when the RRs are copied into the response and not
when the zone is loaded from a master file or via a zone transfer.  The
reason for this provison is to allow future dynamic update facilities to
change the SOA RR with known semantics.

[3.3.14](#section-3.3.14). TXT RDATA format

    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    /                   TXT-DATA                    /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+

where:

TXT-DATA        One or more <character-string>s.

TXT RRs are used to hold descriptive text.  The semantics of the text
depends on the domain where it is found.

[3.4](#section-3.4). Internet specific RRs

[3.4.1](#section-3.4.1). A RDATA format

    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                    ADDRESS                    |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+

where:

ADDRESS         A 32 bit Internet address.

Hosts that have multiple Internet addresses will have multiple A
records.

Mockapetris                                                    [Page 20]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

A records cause no additional section processing.  The RDATA section of
an A line in a master file is an Internet address expressed as four
decimal numbers separated by dots without any imbedded spaces (e.g.,
"10.2.0.52" or "192.0.5.6").

[3.4.2](#section-3.4.2). WKS RDATA format

    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                    ADDRESS                    |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |       PROTOCOL        |                       |
    +--+--+--+--+--+--+--+--+                       |
    |                                               |
    /                   <BIT MAP>                   /
    /                                               /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+

where:

ADDRESS         An 32 bit Internet address

PROTOCOL        An 8 bit IP protocol number

<BIT MAP>       A variable length bit map.  The bit map must be a
                multiple of 8 bits long.

The WKS record is used to describe the well known services supported by
a particular protocol on a particular internet address.  The PROTOCOL
field specifies an IP protocol number, and the bit map has one bit per
port of the specified protocol.  The first bit corresponds to port 0,
the second to port 1, etc.  If the bit map does not include a bit for a
protocol of interest, that bit is assumed zero.  The appropriate values
and mnemonics for ports and protocols are specified in [[RFC-1010](/doc/html/rfc1010 "\"Assigned Numbers\"")].

For example, if PROTOCOL=TCP (6), the 26th bit corresponds to TCP port
[25](#section-25) (SMTP).  If this bit is set, a SMTP server should be listening on TCP
port 25; if zero, SMTP service is not supported on the specified
address.

The purpose of WKS RRs is to provide availability information for
servers for TCP and UDP.  If a server supports both TCP and UDP, or has
multiple Internet addresses, then multiple WKS RRs are used.

WKS RRs cause no additional section processing.

In master files, both ports and protocols are expressed using mnemonics
or decimal numbers.

Mockapetris                                                    [Page 21]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

[3.5](#section-3.5). IN-ADDR.ARPA domain

The Internet uses a special domain to support gateway location and
Internet address to host mapping.  Other classes may employ a similar
strategy in other domains.  The intent of this domain is to provide a
guaranteed method to perform host address to host name mapping, and to
facilitate queries to locate all gateways on a particular network in the
Internet.

Note that both of these services are similar to functions that could be
performed by inverse queries; the difference is that this part of the
domain name space is structured according to address, and hence can
guarantee that the appropriate data can be located without an exhaustive
search of the domain space.

The domain begins at IN-ADDR.ARPA and has a substructure which follows
the Internet addressing structure.

Domain names in the IN-ADDR.ARPA domain are defined to have up to four
labels in addition to the IN-ADDR.ARPA suffix.  Each label represents
one octet of an Internet address, and is expressed as a character string
for a decimal value in the range 0-255 (with leading zeros omitted
except in the case of a zero octet which is represented by a single
zero).

Host addresses are represented by domain names that have all four labels
specified.  Thus data for Internet address 10.2.0.52 is located at
domain name 52.0.2.10.IN-ADDR.ARPA.  The reversal, though awkward to
read, allows zones to be delegated which are exactly one network of
address space.  For example, 10.IN-ADDR.ARPA can be a zone containing
data for the ARPANET, while 26.IN-ADDR.ARPA can be a separate zone for
MILNET.  Address nodes are used to hold pointers to primary host names
in the normal domain space.

Network numbers correspond to some non-terminal nodes at various depths
in the IN-ADDR.ARPA domain, since Internet network numbers are either 1,
2, or 3 octets.  Network nodes are used to hold pointers to the primary
host names of gateways attached to that network.  Since a gateway is, by
definition, on more than one network, it will typically have two or more
network nodes which point at it.  Gateways will also have host level
pointers at their fully qualified addresses.

Both the gateway pointers at network nodes and the normal host pointers
at full address nodes use the PTR RR to point back to the primary domain
names of the corresponding hosts.

For example, the IN-ADDR.ARPA domain will contain information about the
ISI gateway between net 10 and 26, an MIT gateway from net 10 to MIT's

Mockapetris                                                    [Page 22]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

net 18, and hosts A.ISI.EDU and MULTICS.MIT.EDU.  Assuming that ISI
gateway has addresses 10.2.0.22 and 26.0.0.103, and a name MILNET-
GW.ISI.EDU, and the MIT gateway has addresses 10.0.0.77 and 18.10.0.4
and a name GW.LCS.MIT.EDU, the domain database would contain:

    10.IN-ADDR.ARPA.           PTR MILNET-GW.ISI.EDU.
    10.IN-ADDR.ARPA.           PTR GW.LCS.MIT.EDU.
    18.IN-ADDR.ARPA.           PTR GW.LCS.MIT.EDU.
    26.IN-ADDR.ARPA.           PTR MILNET-GW.ISI.EDU.
    22.0.2.10.IN-ADDR.ARPA.    PTR MILNET-GW.ISI.EDU.
    103.0.0.26.IN-ADDR.ARPA.   PTR MILNET-GW.ISI.EDU.
    77.0.0.10.IN-ADDR.ARPA.    PTR GW.LCS.MIT.EDU.
    4.0.10.18.IN-ADDR.ARPA.    PTR GW.LCS.MIT.EDU.
    103.0.3.26.IN-ADDR.ARPA.   PTR A.ISI.EDU.
    6.0.0.10.IN-ADDR.ARPA.     PTR MULTICS.MIT.EDU.

Thus a program which wanted to locate gateways on net 10 would originate
a query of the form QTYPE=PTR, QCLASS=IN, QNAME=10.IN-ADDR.ARPA.  It
would receive two RRs in response:

    10.IN-ADDR.ARPA.           PTR MILNET-GW.ISI.EDU.
    10.IN-ADDR.ARPA.           PTR GW.LCS.MIT.EDU.

The program could then originate QTYPE=A, QCLASS=IN queries for MILNET-
GW.ISI.EDU. and GW.LCS.MIT.EDU. to discover the Internet addresses of
these gateways.

A resolver which wanted to find the host name corresponding to Internet
host address 10.0.0.6 would pursue a query of the form QTYPE=PTR,
QCLASS=IN, QNAME=6.0.0.10.IN-ADDR.ARPA, and would receive:

    6.0.0.10.IN-ADDR.ARPA.     PTR MULTICS.MIT.EDU.

Several cautions apply to the use of these services:
   - Since the IN-ADDR.ARPA special domain and the normal domain
     for a particular host or gateway will be in different zones,
     the possibility exists that that the data may be inconsistent.

   - Gateways will often have two names in separate domains, only
     one of which can be primary.

   - Systems that use the domain database to initialize their
     routing tables must start with enough gateway information to
     guarantee that they can access the appropriate name server.

   - The gateway data only reflects the existence of a gateway in a
     manner equivalent to the current HOSTS.TXT file.  It doesn't
     replace the dynamic availability information from GGP or EGP.

Mockapetris                                                    [Page 23]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

[3.6](#section-3.6). Defining new types, classes, and special namespaces

The previously defined types and classes are the ones in use as of the
date of this memo.  New definitions should be expected.  This section
makes some recommendations to designers considering additions to the
existing facilities.  The mailing list NAMEDROPPERS@SRI-NIC.ARPA is the
forum where general discussion of design issues takes place.

In general, a new type is appropriate when new information is to be
added to the database about an existing object, or we need new data
formats for some totally new object.  Designers should attempt to define
types and their RDATA formats that are generally applicable to all
classes, and which avoid duplication of information.  New classes are
appropriate when the DNS is to be used for a new protocol, etc which
requires new class-specific data formats, or when a copy of the existing
name space is desired, but a separate management domain is necessary.

New types and classes need mnemonics for master files; the format of the
master files requires that the mnemonics for type and class be disjoint.

TYPE and CLASS values must be a proper subset of QTYPEs and QCLASSes
respectively.

The present system uses multiple RRs to represent multiple values of a
type rather than storing multiple values in the RDATA section of a
single RR.  This is less efficient for most applications, but does keep
RRs shorter.  The multiple RRs assumption is incorporated in some
experimental work on dynamic update methods.

The present system attempts to minimize the duplication of data in the
database in order to insure consistency.  Thus, in order to find the
address of the host for a mail exchange, you map the mail domain name to
a host name, then the host name to addresses, rather than a direct
mapping to host address.  This approach is preferred because it avoids
the opportunity for inconsistency.

In defining a new type of data, multiple RR types should not be used to
create an ordering between entries or express different formats for
equivalent bindings, instead this information should be carried in the
body of the RR and a single type used.  This policy avoids problems with
caching multiple types and defining QTYPEs to match multiple types.

For example, the original form of mail exchange binding used two RR
types one to represent a "closer" exchange (MD) and one to represent a
"less close" exchange (MF).  The difficulty is that the presence of one
RR type in a cache doesn't convey any information about the other
because the query which acquired the cached information might have used
a QTYPE of MF, MD, or MAILA (which matched both).  The redesigned

Mockapetris                                                    [Page 24]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

service used a single type (MX) with a "preference" value in the RDATA
section which can order different RRs.  However, if any MX RRs are found
in the cache, then all should be there.

[4](#section-4). MESSAGES

[4.1](#section-4.1). Format

All communications inside of the domain protocol are carried in a single
format called a message.  The top level format of message is divided
into 5 sections (some of which are empty in certain cases) shown below:

    +---------------------+
    |        Header       |
    +---------------------+
    |       Question      | the question for the name server
    +---------------------+
    |        Answer       | RRs answering the question
    +---------------------+
    |      Authority      | RRs pointing toward an authority
    +---------------------+
    |      Additional     | RRs holding additional information
    +---------------------+

The header section is always present.  The header includes fields that
specify which of the remaining sections are present, and also specify
whether the message is a query or a response, a standard query or some
other opcode, etc.

The names of the sections after the header are derived from their use in
standard queries.  The question section contains fields that describe a
question to a name server.  These fields are a query type (QTYPE), a
query class (QCLASS), and a query domain name (QNAME).  The last three
sections have the same format: a possibly empty list of concatenated
resource records (RRs).  The answer section contains RRs that answer the
question; the authority section contains RRs that point toward an
authoritative name server; the additional records section contains RRs
which relate to the query, but are not strictly answers for the
question.

Mockapetris                                                    [Page 25]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

[4.1.1](#section-4.1.1). Header section format

The header contains the following fields:

                                    1  1  1  1  1  1
      0  1  2  3  4  5  6  7  8  9  0  1  2  3  4  5
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                      ID                       |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |QR|   Opcode  |AA|TC|RD|RA|   Z    |   RCODE   |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                    QDCOUNT                    |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                    ANCOUNT                    |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                    NSCOUNT                    |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                    ARCOUNT                    |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+

where:

ID              A 16 bit identifier assigned by the program that
                generates any kind of query.  This identifier is copied
                the corresponding reply and can be used by the requester
                to match up replies to outstanding queries.

QR              A one bit field that specifies whether this message is a
                query (0), or a response (1).

OPCODE          A four bit field that specifies kind of query in this
                message.  This value is set by the originator of a query
                and copied into the response.  The values are:

                0               a standard query (QUERY)

                1               an inverse query (IQUERY)

                2               a server status request (STATUS)

                3-15            reserved for future use

AA              Authoritative Answer - this bit is valid in responses,
                and specifies that the responding name server is an
                authority for the domain name in question section.

                Note that the contents of the answer section may have
                multiple owner names because of aliases.  The AA bit

Mockapetris                                                    [Page 26]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

                corresponds to the name which matches the query name, or
                the first owner name in the answer section.

TC              TrunCation - specifies that this message was truncated
                due to length greater than that permitted on the
                transmission channel.

RD              Recursion Desired - this bit may be set in a query and
                is copied into the response.  If RD is set, it directs
                the name server to pursue the query recursively.
                Recursive query support is optional.

RA              Recursion Available - this be is set or cleared in a
                response, and denotes whether recursive query support is
                available in the name server.

Z               Reserved for future use.  Must be zero in all queries
                and responses.

RCODE           Response code - this 4 bit field is set as part of
                responses.  The values have the following
                interpretation:

                0               No error condition

                1               Format error - The name server was
                                unable to interpret the query.

                2               Server failure - The name server was
                                unable to process this query due to a
                                problem with the name server.

                3               Name Error - Meaningful only for
                                responses from an authoritative name
                                server, this code signifies that the
                                domain name referenced in the query does
                                not exist.

                4               Not Implemented - The name server does
                                not support the requested kind of query.

                5               Refused - The name server refuses to
                                perform the specified operation for
                                policy reasons.  For example, a name
                                server may not wish to provide the
                                information to the particular requester,
                                or a name server may not wish to perform
                                a particular operation (e.g., zone

Mockapetris                                                    [Page 27]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

                                transfer) for particular data.

                6-15            Reserved for future use.

QDCOUNT         an unsigned 16 bit integer specifying the number of
                entries in the question section.

ANCOUNT         an unsigned 16 bit integer specifying the number of
                resource records in the answer section.

NSCOUNT         an unsigned 16 bit integer specifying the number of name
                server resource records in the authority records
                section.

ARCOUNT         an unsigned 16 bit integer specifying the number of
                resource records in the additional records section.

[4.1.2](#section-4.1.2). Question section format

The question section is used to carry the "question" in most queries,
i.e., the parameters that define what is being asked.  The section
contains QDCOUNT (usually 1) entries, each of the following format:

                                    1  1  1  1  1  1
      0  1  2  3  4  5  6  7  8  9  0  1  2  3  4  5
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                                               |
    /                     QNAME                     /
    /                                               /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                     QTYPE                     |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                     QCLASS                    |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+

where:

QNAME           a domain name represented as a sequence of labels, where
                each label consists of a length octet followed by that
                number of octets.  The domain name terminates with the
                zero length octet for the null label of the root.  Note
                that this field may be an odd number of octets; no
                padding is used.

QTYPE           a two octet code which specifies the type of the query.
                The values for this field include all codes valid for a
                TYPE field, together with some more general codes which
                can match more than one type of RR.

Mockapetris                                                    [Page 28]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

QCLASS          a two octet code that specifies the class of the query.
                For example, the QCLASS field is IN for the Internet.

[4.1.3](#section-4.1.3). Resource record format

The answer, authority, and additional sections all share the same
format: a variable number of resource records, where the number of
records is specified in the corresponding count field in the header.
Each resource record has the following format:
                                    1  1  1  1  1  1
      0  1  2  3  4  5  6  7  8  9  0  1  2  3  4  5
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                                               |
    /                                               /
    /                      NAME                     /
    |                                               |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                      TYPE                     |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                     CLASS                     |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                      TTL                      |
    |                                               |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                   RDLENGTH                    |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--|
    /                     RDATA                     /
    /                                               /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+

where:

NAME            a domain name to which this resource record pertains.

TYPE            two octets containing one of the RR type codes.  This
                field specifies the meaning of the data in the RDATA
                field.

CLASS           two octets which specify the class of the data in the
                RDATA field.

TTL             a 32 bit unsigned integer that specifies the time
                interval (in seconds) that the resource record may be
                cached before it should be discarded.  Zero values are
                interpreted to mean that the RR can only be used for the
                transaction in progress, and should not be cached.

Mockapetris                                                    [Page 29]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

RDLENGTH        an unsigned 16 bit integer that specifies the length in
                octets of the RDATA field.

RDATA           a variable length string of octets that describes the
                resource.  The format of this information varies
                according to the TYPE and CLASS of the resource record.
                For example, the if the TYPE is A and the CLASS is IN,
                the RDATA field is a 4 octet ARPA Internet address.

[4.1.4](#section-4.1.4). Message compression

In order to reduce the size of messages, the domain system utilizes a
compression scheme which eliminates the repetition of domain names in a
message.  In this scheme, an entire domain name or a list of labels at
the end of a domain name is replaced with a pointer to a prior occurance
of the same name.

The pointer takes the form of a two octet sequence:

    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    | 1  1|                OFFSET                   |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+

The first two bits are ones.  This allows a pointer to be distinguished
from a label, since the label must begin with two zero bits because
labels are restricted to 63 octets or less.  (The 10 and 01 combinations
are reserved for future use.)  The OFFSET field specifies an offset from
the start of the message (i.e., the first octet of the ID field in the
domain header).  A zero offset specifies the first byte of the ID field,
etc.

The compression scheme allows a domain name in a message to be
represented as either:

   - a sequence of labels ending in a zero octet

   - a pointer

   - a sequence of labels ending with a pointer

Pointers can only be used for occurances of a domain name where the
format is not class specific.  If this were not the case, a name server
or resolver would be required to know the format of all RRs it handled.
As yet, there are no such cases, but they may occur in future RDATA
formats.

If a domain name is contained in a part of the message subject to a
length field (such as the RDATA section of an RR), and compression is

Mockapetris                                                    [Page 30]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

used, the length of the compressed name is used in the length
calculation, rather than the length of the expanded name.

Programs are free to avoid using pointers in messages they generate,
although this will reduce datagram capacity, and may cause truncation.
However all programs are required to understand arriving messages that
contain pointers.

For example, a datagram might need to use the domain names F.ISI.ARPA,
FOO.F.ISI.ARPA, ARPA, and the root.  Ignoring the other fields of the
message, these domain names might be represented as:

       +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    20 |           1           |           F           |
       +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    22 |           3           |           I           |
       +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    24 |           S           |           I           |
       +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    26 |           4           |           A           |
       +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    28 |           R           |           P           |
       +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    30 |           A           |           0           |
       +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+

       +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    40 |           3           |           F           |
       +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    42 |           O           |           O           |
       +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    44 | 1  1|                20                       |
       +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+

       +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    64 | 1  1|                26                       |
       +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+

       +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    92 |           0           |                       |
       +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+

The domain name for F.ISI.ARPA is shown at offset 20.  The domain name
FOO.F.ISI.ARPA is shown at offset 40; this definition uses a pointer to
concatenate a label for FOO to the previously defined F.ISI.ARPA.  The
domain name ARPA is defined at offset 64 using a pointer to the ARPA
component of the name F.ISI.ARPA at 20; note that this pointer relies on
ARPA being the last label in the string at 20.  The root domain name is

Mockapetris                                                    [Page 31]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

defined by a single octet of zeros at 92; the root domain name has no
labels.

[4.2](#section-4.2). Transport

The DNS assumes that messages will be transmitted as datagrams or in a
byte stream carried by a virtual circuit.  While virtual circuits can be
used for any DNS activity, datagrams are preferred for queries due to
their lower overhead and better performance.  Zone refresh activities
must use virtual circuits because of the need for reliable transfer.

The Internet supports name server access using TCP [[RFC-793](/doc/html/rfc793 "\"Transmission Control Protocol\"")] on server
port 53 (decimal) as well as datagram access using UDP [[RFC-768](/doc/html/rfc768 "\"User Datagram Protocol\"")] on UDP
port 53 (decimal).

[4.2.1](#section-4.2.1). UDP usage

Messages sent using UDP user server port 53 (decimal).

Messages carried by UDP are restricted to 512 bytes (not counting the IP
or UDP headers).  Longer messages are truncated and the TC bit is set in
the header.

UDP is not acceptable for zone transfers, but is the recommended method
for standard queries in the Internet.  Queries sent using UDP may be
lost, and hence a retransmission strategy is required.  Queries or their
responses may be reordered by the network, or by processing in name
servers, so resolvers should not depend on them being returned in order.

The optimal UDP retransmission policy will vary with performance of the
Internet and the needs of the client, but the following are recommended:

   - The client should try other servers and server addresses
     before repeating a query to a specific address of a server.

   - The retransmission interval should be based on prior
     statistics if possible.  Too aggressive retransmission can
     easily slow responses for the community at large.  Depending
     on how well connected the client is to its expected servers,
     the minimum retransmission interval should be 2-5 seconds.

More suggestions on server selection and retransmission policy can be
found in the resolver section of this memo.

[4.2.2](#section-4.2.2). TCP usage

Messages sent over TCP connections use server port 53 (decimal).  The
message is prefixed with a two byte length field which gives the message

Mockapetris                                                    [Page 32]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

length, excluding the two byte length field.  This length field allows
the low-level processing to assemble a complete message before beginning
to parse it.

Several connection management policies are recommended:

   - The server should not block other activities waiting for TCP
     data.

   - The server should support multiple connections.

   - The server should assume that the client will initiate
     connection closing, and should delay closing its end of the
     connection until all outstanding client requests have been
     satisfied.

   - If the server needs to close a dormant connection to reclaim
     resources, it should wait until the connection has been idle
     for a period on the order of two minutes.  In particular, the
     server should allow the SOA and AXFR request sequence (which
     begins a refresh operation) to be made on a single connection.
     Since the server would be unable to answer queries anyway, a
     unilateral close or reset may be used instead of a graceful
     close.

[5](#section-5). MASTER FILES

Master files are text files that contain RRs in text form.  Since the
contents of a zone can be expressed in the form of a list of RRs a
master file is most often used to define a zone, though it can be used
to list a cache's contents.  Hence, this section first discusses the
format of RRs in a master file, and then the special considerations when
a master file is used to create a zone in some name server.

[5.1](#section-5.1). Format

The format of these files is a sequence of entries.  Entries are
predominantly line-oriented, though parentheses can be used to continue
a list of items across a line boundary, and text literals can contain
CRLF within the text.  Any combination of tabs and spaces act as a
delimiter between the separate items that make up an entry.  The end of
any line in the master file can end with a comment.  The comment starts
with a ";" (semicolon).

The following entries are defined:

    <blank>[<comment>]

Mockapetris                                                    [Page 33]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

    $ORIGIN <domain-name> [<comment>]

    $INCLUDE <file-name> [<domain-name>] [<comment>]

    <domain-name><rr> [<comment>]

    <blank><rr> [<comment>]

Blank lines, with or without comments, are allowed anywhere in the file.

Two control entries are defined: $ORIGIN and $INCLUDE.  $ORIGIN is
followed by a domain name, and resets the current origin for relative
domain names to the stated name.  $INCLUDE inserts the named file into
the current file, and may optionally specify a domain name that sets the
relative domain name origin for the included file.  $INCLUDE may also
have a comment.  Note that a $INCLUDE entry never changes the relative
origin of the parent file, regardless of changes to the relative origin
made within the included file.

The last two forms represent RRs.  If an entry for an RR begins with a
blank, then the RR is assumed to be owned by the last stated owner.  If
an RR entry begins with a <domain-name>, then the owner name is reset.

<rr> contents take one of the following forms:

    [<TTL>] [<class>] <type> <RDATA>

    [<class>] [<TTL>] <type> <RDATA>

The RR begins with optional TTL and class fields, followed by a type and
RDATA field appropriate to the type and class.  Class and type use the
standard mnemonics, TTL is a decimal integer.  Omitted class and TTL
values are default to the last explicitly stated values.  Since type and
class mnemonics are disjoint, the parse is unique.  (Note that this
order is different from the order used in examples and the order used in
the actual RRs; the given order allows easier parsing and defaulting.)

<domain-name>s make up a large share of the data in the master file.
The labels in the domain name are expressed as character strings and
separated by dots.  Quoting conventions allow arbitrary characters to be
stored in domain names.  Domain names that end in a dot are called
absolute, and are taken as complete.  Domain names which do not end in a
dot are called relative; the actual domain name is the concatenation of
the relative part with an origin specified in a $ORIGIN, $INCLUDE, or as
an argument to the master file loading routine.  A relative name is an
error when no origin is available.

Mockapetris                                                    [Page 34]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

<character-string> is expressed in one or two ways: as a contiguous set
of characters without interior spaces, or as a string beginning with a "
and ending with a ".  Inside a " delimited string any character can
occur, except for a " itself, which must be quoted using \ (back slash).

Because these files are text files several special encodings are
necessary to allow arbitrary data to be loaded.  In particular:

                of the root.

@               A free standing @ is used to denote the current origin.

\X              where X is any character other than a digit (0-9), is
                used to quote that character so that its special meaning
                does not apply.  For example, "\." can be used to place
                a dot character in a label.

\DDD            where each D is a digit is the octet corresponding to
                the decimal number described by DDD.  The resulting
                octet is assumed to be text and is not checked for
                special meaning.

( )             Parentheses are used to group data that crosses a line
                boundary.  In effect, line terminations are not
                recognized within parentheses.

;               Semicolon is used to start a comment; the remainder of
                the line is ignored.

[5.2](#section-5.2). Use of master files to define zones

When a master file is used to load a zone, the operation should be
suppressed if any errors are encountered in the master file.  The
rationale for this is that a single error can have widespread
consequences.  For example, suppose that the RRs defining a delegation
have syntax errors; then the server will return authoritative name
errors for all names in the subzone (except in the case where the
subzone is also present on the server).

Several other validity checks that should be performed in addition to
insuring that the file is syntactically correct:

   1. All RRs in the file should have the same class.

   2. Exactly one SOA RR should be present at the top of the zone.

   3. If delegations are present and glue information is required,
      it should be present.

Mockapetris                                                    [Page 35]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

   4. Information present outside of the authoritative nodes in the
      zone should be glue information, rather than the result of an
      origin or similar error.

[5.3](#section-5.3). Master file example

The following is an example file which might be used to define the
ISI.EDU zone.and is loaded with an origin of ISI.EDU:

@   IN  SOA     VENERA      Action\.domains (
                                 20     ; SERIAL
                                 7200   ; REFRESH
                                 600    ; RETRY
                                 3600000; EXPIRE
                                 60)    ; MINIMUM

        NS      A.ISI.EDU.
        NS      VENERA
        NS      VAXA
        MX      10      VENERA
        MX      20      VAXA

A       A       26.3.0.103

VENERA  A       10.1.0.52
        A       128.9.0.32

VAXA    A       10.2.0.27
        A       128.9.0.33

$INCLUDE <SUBSYS>ISI-MAILBOXES.TXT

Where the file <SUBSYS>ISI-MAILBOXES.TXT is:

    MOE     MB      A.ISI.EDU.
    LARRY   MB      A.ISI.EDU.
    CURLEY  MB      A.ISI.EDU.
    STOOGES MG      MOE
            MG      LARRY
            MG      CURLEY

Note the use of the \ character in the SOA RR to specify the responsible
person mailbox "Action.domains@E.ISI.EDU".

Mockapetris                                                    [Page 36]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

[6](#section-6). NAME SERVER IMPLEMENTATION

[6.1](#section-6.1). Architecture

The optimal structure for the name server will depend on the host
operating system and whether the name server is integrated with resolver
operations, either by supporting recursive service, or by sharing its
database with a resolver.  This section discusses implementation
considerations for a name server which shares a database with a
resolver, but most of these concerns are present in any name server.

[6.1.1](#section-6.1.1). Control

A name server must employ multiple concurrent activities, whether they
are implemented as separate tasks in the host's OS or multiplexing
inside a single name server program.  It is simply not acceptable for a
name server to block the service of UDP requests while it waits for TCP
data for refreshing or query activities.  Similarly, a name server
should not attempt to provide recursive service without processing such
requests in parallel, though it may choose to serialize requests from a
single client, or to regard identical requests from the same client as
duplicates.  A name server should not substantially delay requests while
it reloads a zone from master files or while it incorporates a newly
refreshed zone into its database.

[6.1.2](#section-6.1.2). Database

While name server implementations are free to use any internal data
structures they choose, the suggested structure consists of three major
parts:

   - A "catalog" data structure which lists the zones available to
     this server, and a "pointer" to the zone data structure.  The
     main purpose of this structure is to find the nearest ancestor
     zone, if any, for arriving standard queries.

   - Separate data structures for each of the zones held by the
     name server.

   - A data structure for cached data. (or perhaps separate caches
     for different classes)

All of these data structures can be implemented an identical tree
structure format, with different data chained off the nodes in different
parts: in the catalog the data is pointers to zones, while in the zone
and cache data structures, the data will be RRs.  In designing the tree
framework the designer should recognize that query processing will need
to traverse the tree using case-insensitive label comparisons; and that

Mockapetris                                                    [Page 37]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

in real data, a few nodes have a very high branching factor (100-1000 or
more), but the vast majority have a very low branching factor (0-1).

One way to solve the case problem is to store the labels for each node
in two pieces: a standardized-case representation of the label where all
ASCII characters are in a single case, together with a bit mask that
denotes which characters are actually of a different case.  The
branching factor diversity can be handled using a simple linked list for
a node until the branching factor exceeds some threshold, and
transitioning to a hash structure after the threshold is exceeded.  In
any case, hash structures used to store tree sections must insure that
hash functions and procedures preserve the casing conventions of the
DNS.

The use of separate structures for the different parts of the database
is motivated by several factors:

   - The catalog structure can be an almost static structure that
     need change only when the system administrator changes the
     zones supported by the server.  This structure can also be
     used to store parameters used to control refreshing
     activities.

   - The individual data structures for zones allow a zone to be
     replaced simply by changing a pointer in the catalog.  Zone
     refresh operations can build a new structure and, when
     complete, splice it into the database via a simple pointer
     replacement.  It is very important that when a zone is
     refreshed, queries should not use old and new data
     simultaneously.

   - With the proper search procedures, authoritative data in zones
     will always "hide", and hence take precedence over, cached
     data.

   - Errors in zone definitions that cause overlapping zones, etc.,
     may cause erroneous responses to queries, but problem
     determination is simplified, and the contents of one "bad"
     zone can't corrupt another.

   - Since the cache is most frequently updated, it is most
     vulnerable to corruption during system restarts.  It can also
     become full of expired RR data.  In either case, it can easily
     be discarded without disturbing zone data.

A major aspect of database design is selecting a structure which allows
the name server to deal with crashes of the name server's host.  State
information which a name server should save across system crashes

Mockapetris                                                    [Page 38]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

includes the catalog structure (including the state of refreshing for
each zone) and the zone data itself.

[6.1.3](#section-6.1.3). Time

Both the TTL data for RRs and the timing data for refreshing activities
depends on 32 bit timers in units of seconds.  Inside the database,
refresh timers and TTLs for cached data conceptually "count down", while
data in the zone stays with constant TTLs.

A recommended implementation strategy is to store time in two ways:  as
a relative increment and as an absolute time.  One way to do this is to
use positive 32 bit numbers for one type and negative numbers for the
other.  The RRs in zones use relative times; the refresh timers and
cache data use absolute times.  Absolute numbers are taken with respect
to some known origin and converted to relative values when placed in the
response to a query.  When an absolute TTL is negative after conversion
to relative, then the data is expired and should be ignored.

[6.2](#section-6.2). Standard query processing

The major algorithm for standard query processing is presented in
[[RFC-1034](/doc/html/rfc1034)].

When processing queries with QCLASS=*, or some other QCLASS which
matches multiple classes, the response should never be authoritative
unless the server can guarantee that the response covers all classes.

When composing a response, RRs which are to be inserted in the
additional section, but duplicate RRs in the answer or authority
sections, may be omitted from the additional section.

When a response is so long that truncation is required, the truncation
should start at the end of the response and work forward in the
datagram.  Thus if there is any data for the authority section, the
answer section is guaranteed to be unique.

The MINIMUM value in the SOA should be used to set a floor on the TTL of
data distributed from a zone.  This floor function should be done when
the data is copied into a response.  This will allow future dynamic
update protocols to change the SOA MINIMUM field without ambiguous
semantics.

[6.3](#section-6.3). Zone refresh and reload processing

In spite of a server's best efforts, it may be unable to load zone data
from a master file due to syntax errors, etc., or be unable to refresh a
zone within the its expiration parameter.  In this case, the name server

Mockapetris                                                    [Page 39]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

should answer queries as if it were not supposed to possess the zone.

If a master is sending a zone out via AXFR, and a new version is created
during the transfer, the master should continue to send the old version
if possible.  In any case, it should never send part of one version and
part of another.  If completion is not possible, the master should reset
the connection on which the zone transfer is taking place.

[6.4](#section-6.4). Inverse queries (Optional)

Inverse queries are an optional part of the DNS.  Name servers are not
required to support any form of inverse queries.  If a name server
receives an inverse query that it does not support, it returns an error
response with the "Not Implemented" error set in the header.  While
inverse query support is optional, all name servers must be at least
able to return the error response.

[6.4.1](#section-6.4.1). The contents of inverse queries and responses          Inverse
queries reverse the mappings performed by standard query operations;
while a standard query maps a domain name to a resource, an inverse
query maps a resource to a domain name.  For example, a standard query
might bind a domain name to a host address; the corresponding inverse
query binds the host address to a domain name.

Inverse queries take the form of a single RR in the answer section of
the message, with an empty question section.  The owner name of the
query RR and its TTL are not significant.  The response carries
questions in the question section which identify all names possessing
the query RR WHICH THE NAME SERVER KNOWS.  Since no name server knows
about all of the domain name space, the response can never be assumed to
be complete.  Thus inverse queries are primarily useful for database
management and debugging activities.  Inverse queries are NOT an
acceptable method of mapping host addresses to host names; use the IN-
ADDR.ARPA domain instead.

Where possible, name servers should provide case-insensitive comparisons
for inverse queries.  Thus an inverse query asking for an MX RR of
"Venera.isi.edu" should get the same response as a query for
"VENERA.ISI.EDU"; an inverse query for HINFO RR "IBM-PC UNIX" should
produce the same result as an inverse query for "IBM-pc unix".  However,
this cannot be guaranteed because name servers may possess RRs that
contain character strings but the name server does not know that the
data is character.

When a name server processes an inverse query, it either returns:

   1. zero, one, or multiple domain names for the specified
      resource as QNAMEs in the question section

Mockapetris                                                    [Page 40]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

   2. an error code indicating that the name server doesn't support
      inverse mapping of the specified resource type.

When the response to an inverse query contains one or more QNAMEs, the
owner name and TTL of the RR in the answer section which defines the
inverse query is modified to exactly match an RR found at the first
QNAME.

RRs returned in the inverse queries cannot be cached using the same
mechanism as is used for the replies to standard queries.  One reason
for this is that a name might have multiple RRs of the same type, and
only one would appear.  For example, an inverse query for a single
address of a multiply homed host might create the impression that only
one address existed.

[6.4.2](#section-6.4.2). Inverse query and response example          The overall structure
of an inverse query for retrieving the domain name that corresponds to
Internet address 10.1.0.52 is shown below:

                         +-----------------------------------------+
           Header        |          OPCODE=IQUERY, ID=997          |
                         +-----------------------------------------+
          Question       |                 <empty>                 |
                         +-----------------------------------------+
           Answer        |        <anyname> A IN 10.1.0.52         |
                         +-----------------------------------------+
          Authority      |                 <empty>                 |
                         +-----------------------------------------+
         Additional      |                 <empty>                 |
                         +-----------------------------------------+

This query asks for a question whose answer is the Internet style
address 10.1.0.52.  Since the owner name is not known, any domain name
can be used as a placeholder (and is ignored).  A single octet of zero,
signifying the root, is usually used because it minimizes the length of
the message.  The TTL of the RR is not significant.  The response to
this query might be:

Mockapetris                                                    [Page 41]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

                         +-----------------------------------------+
           Header        |         OPCODE=RESPONSE, ID=997         |
                         +-----------------------------------------+
          Question       |QTYPE=A, QCLASS=IN, QNAME=VENERA.ISI.EDU |
                         +-----------------------------------------+
           Answer        |  VENERA.ISI.EDU  A IN 10.1.0.52         |
                         +-----------------------------------------+
          Authority      |                 <empty>                 |
                         +-----------------------------------------+
         Additional      |                 <empty>                 |
                         +-----------------------------------------+

Note that the QTYPE in a response to an inverse query is the same as the
TYPE field in the answer section of the inverse query.  Responses to
inverse queries may contain multiple questions when the inverse is not
unique.  If the question section in the response is not empty, then the
RR in the answer section is modified to correspond to be an exact copy
of an RR at the first QNAME.

[6.4.3](#section-6.4.3). Inverse query processing

Name servers that support inverse queries can support these operations
through exhaustive searches of their databases, but this becomes
impractical as the size of the database increases.  An alternative
approach is to invert the database according to the search key.

For name servers that support multiple zones and a large amount of data,
the recommended approach is separate inversions for each zone.  When a
particular zone is changed during a refresh, only its inversions need to
be redone.

Support for transfer of this type of inversion may be included in future
versions of the domain system, but is not supported in this version.

[6.5](#section-6.5). Completion queries and responses

The optional completion services described in [RFC-882](/doc/html/rfc882) and [RFC-883](/doc/html/rfc883) have
been deleted.  Redesigned services may become available in the future.

Mockapetris                                                    [Page 42]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

[7](#section-7). RESOLVER IMPLEMENTATION

The top levels of the recommended resolver algorithm are discussed in
[[RFC-1034](/doc/html/rfc1034)].  This section discusses implementation details assuming the
database structure suggested in the name server implementation section
of this memo.

[7.1](#section-7.1). Transforming a user request into a query

The first step a resolver takes is to transform the client's request,
stated in a format suitable to the local OS, into a search specification
for RRs at a specific name which match a specific QTYPE and QCLASS.
Where possible, the QTYPE and QCLASS should correspond to a single type
and a single class, because this makes the use of cached data much
simpler.  The reason for this is that the presence of data of one type
in a cache doesn't confirm the existence or non-existence of data of
other types, hence the only way to be sure is to consult an
authoritative source.  If QCLASS=* is used, then authoritative answers
won't be available.

Since a resolver must be able to multiplex multiple requests if it is to
perform its function efficiently, each pending request is usually
represented in some block of state information.  This state block will
typically contain:

   - A timestamp indicating the time the request began.
     The timestamp is used to decide whether RRs in the database
     can be used or are out of date.  This timestamp uses the
     absolute time format previously discussed for RR storage in
     zones and caches.  Note that when an RRs TTL indicates a
     relative time, the RR must be timely, since it is part of a
     zone.  When the RR has an absolute time, it is part of a
     cache, and the TTL of the RR is compared against the timestamp
     for the start of the request.

     Note that using the timestamp is superior to using a current
     time, since it allows RRs with TTLs of zero to be entered in
     the cache in the usual manner, but still used by the current
     request, even after intervals of many seconds due to system
     load, query retransmission timeouts, etc.

   - Some sort of parameters to limit the amount of work which will
     be performed for this request.

     The amount of work which a resolver will do in response to a
     client request must be limited to guard against errors in the
     database, such as circular CNAME references, and operational
     problems, such as network partition which prevents the

Mockapetris                                                    [Page 43]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

     resolver from accessing the name servers it needs.  While
     local limits on the number of times a resolver will retransmit
     a particular query to a particular name server address are
     essential, the resolver should have a global per-request
     counter to limit work on a single request.  The counter should
     be set to some initial value and decremented whenever the
     resolver performs any action (retransmission timeout,
     retransmission, etc.)  If the counter passes zero, the request
     is terminated with a temporary error.

     Note that if the resolver structure allows one request to
     start others in parallel, such as when the need to access a
     name server for one request causes a parallel resolve for the
     name server's addresses, the spawned request should be started
     with a lower counter.  This prevents circular references in
     the database from starting a chain reaction of resolver
     activity.

   - The SLIST data structure discussed in [[RFC-1034](/doc/html/rfc1034)].

     This structure keeps track of the state of a request if it
     must wait for answers from foreign name servers.

[7.2](#section-7.2). Sending the queries

As described in [[RFC-1034](/doc/html/rfc1034)], the basic task of the resolver is to
formulate a query which will answer the client's request and direct that
query to name servers which can provide the information.  The resolver
will usually only have very strong hints about which servers to ask, in
the form of NS RRs, and may have to revise the query, in response to
CNAMEs, or revise the set of name servers the resolver is asking, in
response to delegation responses which point the resolver to name
servers closer to the desired information.  In addition to the
information requested by the client, the resolver may have to call upon
its own services to determine the address of name servers it wishes to
contact.

In any case, the model used in this memo assumes that the resolver is
multiplexing attention between multiple requests, some from the client,
and some internally generated.  Each request is represented by some
state information, and the desired behavior is that the resolver
transmit queries to name servers in a way that maximizes the probability
that the request is answered, minimizes the time that the request takes,
and avoids excessive transmissions.  The key algorithm uses the state
information of the request to select the next name server address to
query, and also computes a timeout which will cause the next action
should a response not arrive.  The next action will usually be a
transmission to some other server, but may be a temporary error to the

Mockapetris                                                    [Page 44]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

client.

The resolver always starts with a list of server names to query (SLIST).
This list will be all NS RRs which correspond to the nearest ancestor
zone that the resolver knows about.  To avoid startup problems, the
resolver should have a set of default servers which it will ask should
it have no current NS RRs which are appropriate.  The resolver then adds
to SLIST all of the known addresses for the name servers, and may start
parallel requests to acquire the addresses of the servers when the
resolver has the name, but no addresses, for the name servers.

To complete initialization of SLIST, the resolver attaches whatever
history information it has to the each address in SLIST.  This will
usually consist of some sort of weighted averages for the response time
of the address, and the batting average of the address (i.e., how often
the address responded at all to the request).  Note that this
information should be kept on a per address basis, rather than on a per
name server basis, because the response time and batting average of a
particular server may vary considerably from address to address.  Note
also that this information is actually specific to a resolver address /
server address pair, so a resolver with multiple addresses may wish to
keep separate histories for each of its addresses.  Part of this step
must deal with addresses which have no such history; in this case an
expected round trip time of 5-10 seconds should be the worst case, with
lower estimates for the same local network, etc.

Note that whenever a delegation is followed, the resolver algorithm
reinitializes SLIST.

The information establishes a partial ranking of the available name
server addresses.  Each time an address is chosen and the state should
be altered to prevent its selection again until all other addresses have
been tried.  The timeout for each transmission should be 50-100% greater
than the average predicted value to allow for variance in response.

Some fine points:

   - The resolver may encounter a situation where no addresses are
     available for any of the name servers named in SLIST, and
     where the servers in the list are precisely those which would
     normally be used to look up their own addresses.  This
     situation typically occurs when the glue address RRs have a
     smaller TTL than the NS RRs marking delegation, or when the
     resolver caches the result of a NS search.  The resolver
     should detect this condition and restart the search at the
     next ancestor zone, or alternatively at the root.

Mockapetris                                                    [Page 45]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

   - If a resolver gets a server error or other bizarre response
     from a name server, it should remove it from SLIST, and may
     wish to schedule an immediate transmission to the next
     candidate server address.

[7.3](#section-7.3). Processing responses

The first step in processing arriving response datagrams is to parse the
response.  This procedure should include:

   - Check the header for reasonableness.  Discard datagrams which
     are queries when responses are expected.

   - Parse the sections of the message, and insure that all RRs are
     correctly formatted.

   - As an optional step, check the TTLs of arriving data looking
     for RRs with excessively long TTLs.  If a RR has an
     excessively long TTL, say greater than 1 week, either discard
     the whole response, or limit all TTLs in the response to 1
     week.

The next step is to match the response to a current resolver request.
The recommended strategy is to do a preliminary matching using the ID
field in the domain header, and then to verify that the question section
corresponds to the information currently desired.  This requires that
the transmission algorithm devote several bits of the domain ID field to
a request identifier of some sort.  This step has several fine points:

   - Some name servers send their responses from different
     addresses than the one used to receive the query.  That is, a
     resolver cannot rely that a response will come from the same
     address which it sent the corresponding query to.  This name
     server bug is typically encountered in UNIX systems.

   - If the resolver retransmits a particular request to a name
     server it should be able to use a response from any of the
     transmissions.  However, if it is using the response to sample
     the round trip time to access the name server, it must be able
     to determine which transmission matches the response (and keep
     transmission times for each outgoing message), or only
     calculate round trip times based on initial transmissions.

   - A name server will occasionally not have a current copy of a
     zone which it should have according to some NS RRs.  The
     resolver should simply remove the name server from the current
     SLIST, and continue.

Mockapetris                                                    [Page 46]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

[7.4](#section-7.4). Using the cache

In general, we expect a resolver to cache all data which it receives in
responses since it may be useful in answering future client requests.
However, there are several types of data which should not be cached:

   - When several RRs of the same type are available for a
     particular owner name, the resolver should either cache them
     all or none at all.  When a response is truncated, and a
     resolver doesn't know whether it has a complete set, it should
     not cache a possibly partial set of RRs.

   - Cached data should never be used in preference to
     authoritative data, so if caching would cause this to happen
     the data should not be cached.

   - The results of an inverse query should not be cached.

   - The results of standard queries where the QNAME contains "*"
     labels if the data might be used to construct wildcards.  The
     reason is that the cache does not necessarily contain existing
     RRs or zone boundary information which is necessary to
     restrict the application of the wildcard RRs.

   - RR data in responses of dubious reliability.  When a resolver
     receives unsolicited responses or RR data other than that
     requested, it should discard it without caching it.  The basic
     implication is that all sanity checks on a packet should be
     performed before any of it is cached.

In a similar vein, when a resolver has a set of RRs for some name in a
response, and wants to cache the RRs, it should check its cache for
already existing RRs.  Depending on the circumstances, either the data
in the response or the cache is preferred, but the two should never be
combined.  If the data in the response is from authoritative data in the
answer section, it is always preferred.

[8](#section-8). MAIL SUPPORT

The domain system defines a standard for mapping mailboxes into domain
names, and two methods for using the mailbox information to derive mail
routing information.  The first method is called mail exchange binding
and the other method is mailbox binding.  The mailbox encoding standard
and mail exchange binding are part of the DNS official protocol, and are
the recommended method for mail routing in the Internet.  Mailbox
binding is an experimental feature which is still under development and
subject to change.

Mockapetris                                                    [Page 47]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

The mailbox encoding standard assumes a mailbox name of the form
"<local-part>@<mail-domain>".  While the syntax allowed in each of these
sections varies substantially between the various mail internets, the
preferred syntax for the ARPA Internet is given in [[RFC-822](/doc/html/rfc822)].

The DNS encodes the <local-part> as a single label, and encodes the
<mail-domain> as a domain name.  The single label from the <local-part>
is prefaced to the domain name from <mail-domain> to form the domain
name corresponding to the mailbox.  Thus the mailbox HOSTMASTER@SRI-
NIC.ARPA is mapped into the domain name HOSTMASTER.SRI-NIC.ARPA.  If the
<local-part> contains dots or other special characters, its
representation in a master file will require the use of backslash
quoting to ensure that the domain name is properly encoded.  For
example, the mailbox Action.domains@ISI.EDU would be represented as
Action\.domains.ISI.EDU.

[8.1](#section-8.1). Mail exchange binding

Mail exchange binding uses the <mail-domain> part of a mailbox
specification to determine where mail should be sent.  The <local-part>
is not even consulted.  [[RFC-974](/doc/html/rfc974 "\"Mail routing and the domain system\"")] specifies this method in detail, and
should be consulted before attempting to use mail exchange support.

One of the advantages of this method is that it decouples mail
destination naming from the hosts used to support mail service, at the
cost of another layer of indirection in the lookup function.  However,
the addition layer should eliminate the need for complicated "%", "!",
etc encodings in <local-part>.

The essence of the method is that the <mail-domain> is used as a domain
name to locate type MX RRs which list hosts willing to accept mail for
<mail-domain>, together with preference values which rank the hosts
according to an order specified by the administrators for <mail-domain>.

In this memo, the <mail-domain> ISI.EDU is used in examples, together
with the hosts VENERA.ISI.EDU and VAXA.ISI.EDU as mail exchanges for
ISI.EDU.  If a mailer had a message for Mockapetris@ISI.EDU, it would
route it by looking up MX RRs for ISI.EDU.  The MX RRs at ISI.EDU name
VENERA.ISI.EDU and VAXA.ISI.EDU, and type A queries can find the host
addresses.

[8.2](#section-8.2). Mailbox binding (Experimental)

In mailbox binding, the mailer uses the entire mail destination
specification to construct a domain name.  The encoded domain name for
the mailbox is used as the QNAME field in a QTYPE=MAILB query.

Several outcomes are possible for this query:

Mockapetris                                                    [Page 48]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

   1. The query can return a name error indicating that the mailbox
      does not exist as a domain name.

      In the long term, this would indicate that the specified
      mailbox doesn't exist.  However, until the use of mailbox
      binding is universal, this error condition should be
      interpreted to mean that the organization identified by the
      global part does not support mailbox binding.  The
      appropriate procedure is to revert to exchange binding at
      this point.

   2. The query can return a Mail Rename (MR) RR.

      The MR RR carries new mailbox specification in its RDATA
      field.  The mailer should replace the old mailbox with the
      new one and retry the operation.

   3. The query can return a MB RR.

      The MB RR carries a domain name for a host in its RDATA
      field.  The mailer should deliver the message to that host
      via whatever protocol is applicable, e.g., b,SMTP.

   4. The query can return one or more Mail Group (MG) RRs.

      This condition means that the mailbox was actually a mailing
      list or mail group, rather than a single mailbox.  Each MG RR
      has a RDATA field that identifies a mailbox that is a member
      of the group.  The mailer should deliver a copy of the
      message to each member.

   5. The query can return a MB RR as well as one or more MG RRs.

      This condition means the the mailbox was actually a mailing
      list.  The mailer can either deliver the message to the host
      specified by the MB RR, which will in turn do the delivery to
      all members, or the mailer can use the MG RRs to do the
      expansion itself.

In any of these cases, the response may include a Mail Information
(MINFO) RR.  This RR is usually associated with a mail group, but is
legal with a MB.  The MINFO RR identifies two mailboxes.  One of these
identifies a responsible person for the original mailbox name.  This
mailbox should be used for requests to be added to a mail group, etc.
The second mailbox name in the MINFO RR identifies a mailbox that should
receive error messages for mail failures.  This is particularly
appropriate for mailing lists when errors in member names should be
reported to a person other than the one who sends a message to the list.

Mockapetris                                                    [Page 49]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

New fields may be added to this RR in the future.

[9](#section-9). REFERENCES and BIBLIOGRAPHY

[Dyer 87]       S. Dyer, F. Hsu, "Hesiod", Project Athena
                Technical Plan - Name Service, April 1987, version 1.9.

                Describes the fundamentals of the Hesiod name service.

[IEN-116]       J. Postel, "Internet Name Server", IEN-116,
                USC/Information Sciences Institute, August 1979.

                A name service obsoleted by the Domain Name System, but
                still in use.

[Quarterman 86] J. Quarterman, and J. Hoskins, "Notable Computer Networks",
                Communications of the ACM, October 1986, volume 29, number
                10.

[RFC-742]       K. Harrenstien, "NAME/FINGER", [RFC-742](/doc/html/rfc742), Network
                Information Center, SRI International, December 1977.

[RFC-768]       J. Postel, "User Datagram Protocol", [RFC-768](/doc/html/rfc768),
                USC/Information Sciences Institute, August 1980.

[RFC-793]       J. Postel, "Transmission Control Protocol", [RFC-793](/doc/html/rfc793),
                USC/Information Sciences Institute, September 1981.

[RFC-799]       D. Mills, "Internet Name Domains", [RFC-799](/doc/html/rfc799), COMSAT,
                September 1981.

                Suggests introduction of a hierarchy in place of a flat
                name space for the Internet.

[RFC-805]       J. Postel, "Computer Mail Meeting Notes", [RFC-805](/doc/html/rfc805),
                USC/Information Sciences Institute, February 1982.

[RFC-810]       E. Feinler, K. Harrenstien, Z. Su, and V. White, "DOD
                Internet Host Table Specification", [RFC-810](/doc/html/rfc810), Network
                Information Center, SRI International, March 1982.

                Obsolete.  See [RFC-952](/doc/html/rfc952).

[RFC-811]       K. Harrenstien, V. White, and E. Feinler, "Hostnames
                Server", [RFC-811](/doc/html/rfc811), Network Information Center, SRI
                International, March 1982.

Mockapetris                                                    [Page 50]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

                Obsolete.  See [RFC-953](/doc/html/rfc953).

[RFC-812]       K. Harrenstien, and V. White, "NICNAME/WHOIS", [RFC-812](/doc/html/rfc812),
                Network Information Center, SRI International, March
                1982.

[RFC-819]       Z. Su, and J. Postel, "The Domain Naming Convention for
                Internet User Applications", [RFC-819](/doc/html/rfc819), Network
                Information Center, SRI International, August 1982.

                Early thoughts on the design of the domain system.
                Current implementation is completely different.

[RFC-821]       J. Postel, "Simple Mail Transfer Protocol", [RFC-821](/doc/html/rfc821),
                USC/Information Sciences Institute, August 1980.

[RFC-830]       Z. Su, "A Distributed System for Internet Name Service",
                [RFC-830](/doc/html/rfc830), Network Information Center, SRI International,
                October 1982.

                Early thoughts on the design of the domain system.
                Current implementation is completely different.

[RFC-882]       P. Mockapetris, "Domain names - Concepts and
                Facilities," [RFC-882](/doc/html/rfc882), USC/Information Sciences
                Institute, November 1983.

                Superceeded by this memo.

[RFC-883]       P. Mockapetris, "Domain names - Implementation and
                Specification," [RFC-883](/doc/html/rfc883), USC/Information Sciences
                Institute, November 1983.

                Superceeded by this memo.

[RFC-920]       J. Postel and J. Reynolds, "Domain Requirements",
                [RFC-920](/doc/html/rfc920), USC/Information Sciences Institute,
                October 1984.

                Explains the naming scheme for top level domains.

[RFC-952]       K. Harrenstien, M. Stahl, E. Feinler, "DoD Internet Host
                Table Specification", [RFC-952](/doc/html/rfc952), SRI, October 1985.

                Specifies the format of HOSTS.TXT, the host/address
                table replaced by the DNS.

Mockapetris                                                    [Page 51]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

[RFC-953]       K. Harrenstien, M. Stahl, E. Feinler, "HOSTNAME Server",
                [RFC-953](/doc/html/rfc953), SRI, October 1985.

                This RFC contains the official specification of the
                hostname server protocol, which is obsoleted by the DNS.
                This TCP based protocol accesses information stored in
                the [RFC-952](/doc/html/rfc952) format, and is used to obtain copies of the
                host table.

[RFC-973]       P. Mockapetris, "Domain System Changes and
                Observations", [RFC-973](/doc/html/rfc973), USC/Information Sciences
                Institute, January 1986.

                Describes changes to [RFC-882](/doc/html/rfc882) and [RFC-883](/doc/html/rfc883) and reasons for
                them.

[RFC-974]       C. Partridge, "Mail routing and the domain system",
                [RFC-974](/doc/html/rfc974), CSNET CIC BBN Labs, January 1986.

                Describes the transition from HOSTS.TXT based mail
                addressing to the more powerful MX system used with the
                domain system.

[RFC-1001]      NetBIOS Working Group, "Protocol standard for a NetBIOS
                service on a TCP/UDP transport: Concepts and Methods",
                [RFC-1001](/doc/html/rfc1001), March 1987.

                This RFC and [RFC-1002](/doc/html/rfc1002) are a preliminary design for
                NETBIOS on top of TCP/IP which proposes to base NetBIOS
                name service on top of the DNS.

[RFC-1002]      NetBIOS Working Group, "Protocol standard for a NetBIOS
                service on a TCP/UDP transport: Detailed
                Specifications", [RFC-1002](/doc/html/rfc1002), March 1987.

[RFC-1010]      J. Reynolds, and J. Postel, "Assigned Numbers", [RFC-1010](/doc/html/rfc1010),
                USC/Information Sciences Institute, May 1987.

                Contains socket numbers and mnemonics for host names,
                operating systems, etc.

[RFC-1031]      W. Lazear, "MILNET Name Domain Transition", [RFC-1031](/doc/html/rfc1031),
                November 1987.

                Describes a plan for converting the MILNET to the DNS.

[RFC-1032]      M. Stahl, "Establishing a Domain - Guidelines for
                Administrators", [RFC-1032](/doc/html/rfc1032), November 1987.

Mockapetris                                                    [Page 52]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

                Describes the registration policies used by the NIC to
                administer the top level domains and delegate subzones.

[RFC-1033]      M. Lottor, "Domain Administrators Operations Guide",
                [RFC-1033](/doc/html/rfc1033), November 1987.

                A cookbook for domain administrators.

[Solomon 82]    M. Solomon, L. Landweber, and D. Neuhengen, "The CSNET
                Name Server", Computer Networks, vol 6, nr 3, July 1982.

                Describes a name service for CSNET which is independent
                from the DNS and DNS use in the CSNET.

Mockapetris                                                    [Page 53]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

Index

          *   13

          ;   33, 35

          <character-string>   35
          <domain-name>   34

          @   35

          \   35

          A   12

          Byte order   8

          CH   13
          Character case   9
          CLASS   11
          CNAME   12
          Completion   42
          CS   13

          Hesiod   13
          HINFO   12
          HS   13

          IN   13
          IN-ADDR.ARPA domain   22
          Inverse queries   40

          Mailbox names   47
          MB   12
          MD   12
          MF   12
          MG   12
          MINFO   12
          MINIMUM   20
          MR   12
          MX   12

          NS   12
          NULL   12

          Port numbers   32
          Primary server   5
          PTR   12, 18

Mockapetris                                                    [Page 54]
```

---

```

[RFC 1035](/doc/html/rfc1035)        Domain Implementation and Specification    November 1987

          QCLASS   13
          QTYPE   12

          RDATA   12
          RDLENGTH  11

          Secondary server   5
          SOA   12
          Stub resolvers   7

          TCP   32
          TXT   12
          TYPE   11

          UDP   32

          WKS   12

Mockapetris                                                    [Page 55]

```

[Datatracker](/doc/rfc1035/)

RFC 1035

RFC
- Internet Standard

* Info
* Contents
* Prefs

| Document | Document type |  | RFC - Internet Standard  November 1987  [View errata](https://www.rfc-editor.org/errata_search.php?rfc=1035 "Click to view errata.") [Report errata](https://www.rfc-editor.org/errata.php#reportnew "Click to report an error in the document.") Updated by [RFC 1101](/doc/html/rfc1101 "DNS encoding of network names and other types"), [RFC 1183](/doc/html/rfc1183 "New DNS RR Definitions"), [RFC 1348](/doc/html/rfc1348 "DNS NSAP RRs"), [RFC 8490](/doc/html/rfc8490 "DNS Stateful Operations"), [RFC 8482](/doc/html/rfc8482 "Providing Minimal-Sized Responses to DNS Queries That Have QTYPE=ANY"), [RFC 8767](/doc/html/rfc8767 "Serving Stale Data to Improve DNS Resiliency"), [RFC 2308](/doc/html/rfc2308 "Negative Caching of DNS Queries (DNS NCACHE)"), [RFC 2137](/doc/html/rfc2137 "Secure Domain Name System Dynamic Update"), [RFC 2181](/doc/html/rfc2181 "Clarifications to the DNS Specification"), [RFC 1982](/doc/html/rfc1982 "Serial Number Arithmetic"), [RFC 2136](/doc/html/rfc2136 "Dynamic Updates in the Domain Name System (DNS UPDATE)"), [RFC 1996](/doc/html/rfc1996 "A Mechanism for Prompt Notification of Zone Changes (DNS NOTIFY)"), [RFC 1995](/doc/html/rfc1995 "Incremental Zone Transfer in DNS"), [RFC 1876](/doc/html/rfc1876 "A Means for Expressing Location Information in the Domain Name System"), [RFC 2065](/doc/html/rfc2065 "Domain Name System Security Extensions"), [RFC 4034](/doc/html/rfc4034 "Resource Records for the DNS Security Extensions"), [RFC 4035](/doc/html/rfc4035 "Protocol Modifications for the DNS Security Extensions"), [RFC 4343](/doc/html/rfc4343 "Domain Name System (DNS) Case Insensitivity Clarification"), [RFC 5966](/doc/html/rfc5966 "DNS Transport over TCP - Implementation Requirements"), [RFC 6604](/doc/html/rfc6604 "xNAME RCODE and Status Bits Clarification"), [RFC 2535](/doc/html/rfc2535 "Domain Name System Security Extensions"), [RFC 2673](/doc/html/rfc2673 "Binary Labels in the Domain Name System"), [RFC 2845](/doc/html/rfc2845 "Secret Key Transaction Authentication for DNS (TSIG)"), [RFC 5936](/doc/html/rfc5936 "DNS Zone Transfer Protocol (AXFR)"), [RFC 3425](/doc/html/rfc3425 "Obsoleting IQUERY"), [RFC 3658](/doc/html/rfc3658 "Delegation Signer (DS) Resource Record (RR)"), [RFC 4033](/doc/html/rfc4033 "DNS Security Introduction and Requirements"), [RFC 7766](/doc/html/rfc7766 "DNS Transport over TCP - Implementation Requirements"), [RFC 9619](/doc/html/rfc9619 "In the DNS, QDCOUNT Is (Usually) One") Obsoletes [RFC 882](/doc/html/rfc882 "Domain names: Concepts and facilities"), [RFC 883](/doc/html/rfc883 "Domain names: Implementation specification"), [RFC 973](/doc/html/rfc973 "Domain system changes and observations") |
| --- | --- | --- | --- |
|  | Select version |  | * [RFC 1035](/doc/html/rfc1035) |
|  | Authors |  | Email authors |
|  | RFC stream |  | Legacy |
|  | Other formats |  | [txt](https://www.rfc-editor.org/rfc/rfc1035.txt) [html](https://www.rfc-editor.org/rfc/rfc1035.html) [pdf](https://www.rfc-editor.org/rfc/pdfrfc/rfc1035.txt.pdf) [w/errata](https://www.rfc-editor.org/rfc/inline-errata/rfc1035.html) [bibtex](/doc/rfc1035/bibtex/) |
|  | Additional resources |  | Mailing list discussion |

[Report a datatracker bug](https://github.com/ietf-tools/datatracker/issues/new/choose)

Show sidebar by default

Yes

No

Tab to show by default

Info

Contents

HTMLization configuration

HTMLize the plaintext

Plaintextify the HTML

Maximum font size

Page dependencies

Inline

Reference

Citation links

 Go to reference section

Go to linked document

![](//analytics.ietf.org/piwik.php?idsite=7)



=== Content from github.com_7290d8fb_20250111_071433.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FTechnitiumSoftware%2FDnsServer%2Fblob%2Fmaster%2FCHANGELOG.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FTechnitiumSoftware%2FDnsServer%2Fblob%2Fmaster%2FCHANGELOG.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=TechnitiumSoftware%2FDnsServer)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[TechnitiumSoftware](/TechnitiumSoftware)
/
**[DnsServer](/TechnitiumSoftware/DnsServer)**
Public

* [Notifications](/login?return_to=%2FTechnitiumSoftware%2FDnsServer) You must be signed in to change notification settings
* [Fork
  444](/login?return_to=%2FTechnitiumSoftware%2FDnsServer)
* [Star
   4.8k](/login?return_to=%2FTechnitiumSoftware%2FDnsServer)

* [Code](/TechnitiumSoftware/DnsServer)
* [Issues
  92](/TechnitiumSoftware/DnsServer/issues)
* [Pull requests
  2](/TechnitiumSoftware/DnsServer/pulls)
* [Discussions](/TechnitiumSoftware/DnsServer/discussions)
* [Actions](/TechnitiumSoftware/DnsServer/actions)
* [Projects
  0](/TechnitiumSoftware/DnsServer/projects)
* [Security](/TechnitiumSoftware/DnsServer/security)
* [Insights](/TechnitiumSoftware/DnsServer/pulse)

Additional navigation options

* [Code](/TechnitiumSoftware/DnsServer)
* [Issues](/TechnitiumSoftware/DnsServer/issues)
* [Pull requests](/TechnitiumSoftware/DnsServer/pulls)
* [Discussions](/TechnitiumSoftware/DnsServer/discussions)
* [Actions](/TechnitiumSoftware/DnsServer/actions)
* [Projects](/TechnitiumSoftware/DnsServer/projects)
* [Security](/TechnitiumSoftware/DnsServer/security)
* [Insights](/TechnitiumSoftware/DnsServer/pulse)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from alas.aws.amazon.com_581b4014_20250111_071430.html ===

[**Amazon Linux Security Center**](/)

* [Amazon Linux 1](/index.html)
* [Amazon Linux 2](/alas2.html)
* [Amazon Linux 2023](/alas2023.html)
* [Announcements](/announcements.html)
* [FAQs](/faqs.html)

# ALAS-2024-1934

---

**Amazon Linux 1 Security Advisory:** ALAS-2024-1934

**Advisory Release Date:** 2024-05-09 17:43 Pacific

**Advisory Updated Date:** 2024-05-15 19:29 Pacific

**Severity:**

Important

**References:**
[CVE-2024-33655](/cve/html/CVE-2024-33655.html)

[FAQs regarding Amazon Linux ALAS/CVE Severity](../../faqs.html)

---

**Issue Overview:**

An issue was discovered in some DNS recursive resolvers that allows remote attackers to cause a denial of service using a maliciously designed authority and response amplification. (CVE-2024-33655)

**Affected Packages:**

unbound

**Issue Correction:**

Run *yum update unbound* to update your system.

**New Packages:**
```
i686:
    unbound-python-1.6.6-1.6.amzn1.i686
    unbound-debuginfo-1.6.6-1.6.amzn1.i686
    unbound-1.6.6-1.6.amzn1.i686
    unbound-libs-1.6.6-1.6.amzn1.i686
    unbound-devel-1.6.6-1.6.amzn1.i686

src:
    unbound-1.6.6-1.6.amzn1.src

x86_64:
    unbound-1.6.6-1.6.amzn1.x86_64
    unbound-libs-1.6.6-1.6.amzn1.x86_64
    unbound-devel-1.6.6-1.6.amzn1.x86_64
    unbound-debuginfo-1.6.6-1.6.amzn1.x86_64
    unbound-python-1.6.6-1.6.amzn1.x86_64

```

### Additional References

Red Hat: [CVE-2024-33655](https://access.redhat.com/security/cve/CVE-2024-33655)

Mitre: [CVE-2024-33655](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-33655)

CVE description copyright © 2023
[The MITRE Corporation](https://cve.mitre.org/about/termsofuse.html)

CVE description copyright © 2023 Red Hat, Inc. Per
<https://access.redhat.com/security/data>,
RedHat's CVE report is licensed under
[CC BY 4.0](https://creativecommons.org/licenses/by/4.0/).

[Privacy](https://aws.amazon.com/privacy/) |
[Site terms apply, and downloading this site or portions of it is permitted](https://aws.amazon.com/terms/) |
Cookie preferences |
© 2023, Amazon Web Services, Inc. or its affiliates. All rights reserved.



=== Content from meterpreter.org_e5e4182e_20250111_071436.html ===
[Skip to content](#content)

[Penetration Testing Tools](https://meterpreter.org/ "Penetration Testing Tools | Home page")

* Search for:

* [Home](https://meterpreter.org)* [Data Forensics](https://meterpreter.org/category/data-forensics-incident-response/)* [Ethical Hacking](https://meterpreter.org/category/exploitation-ethical-hacking/)* [Mobile Hacking](https://meterpreter.org/category/android-ios-mobile-hacking/)* [Network Attacks](https://meterpreter.org/category/network-attacks/)* [Vulnerability Assessment](https://meterpreter.org/category/vulnerability-assessment/)* [Web AppSec](https://meterpreter.org/category/web-appsec/)* [OSINT](https://meterpreter.org/category/osint-open-source-intelligence/)* [Code Assessment](https://meterpreter.org/category/code-assessment/)* [Malware Offense](https://meterpreter.org/category/malware-offense/)* [IoT](https://meterpreter.org/category/internet-of-things/)* [Cryptography](https://meterpreter.org/category/cryptography/)* [Arsenal Lab](https://meterpreter.org/category/arsenal-lab/)* [Hardware/Embedded](https://meterpreter.org/category/hardware-embedded/)* [Malware Defense](https://meterpreter.org/category/malware-defense/)* [Network Defense](https://meterpreter.org/category/network-defense/)* [Reverse Engineering](https://meterpreter.org/category/reverse-engineering/)* [Smart Grid/Industrial Security](https://meterpreter.org/category/smart-grid-industrial-security/)

* [Home](https://meterpreter.org)* [Data Forensics](https://meterpreter.org/category/data-forensics-incident-response/)* [Ethical Hacking](https://meterpreter.org/category/exploitation-ethical-hacking/)* [Mobile Hacking](https://meterpreter.org/category/android-ios-mobile-hacking/)* [Network Attacks](https://meterpreter.org/category/network-attacks/)* [Vulnerability Assessment](https://meterpreter.org/category/vulnerability-assessment/)* [Web AppSec](https://meterpreter.org/category/web-appsec/)* [OSINT](https://meterpreter.org/category/osint-open-source-intelligence/)* [Code Assessment](https://meterpreter.org/category/code-assessment/)* [Malware Offense](https://meterpreter.org/category/malware-offense/)* [IoT](https://meterpreter.org/category/internet-of-things/)* [Cryptography](https://meterpreter.org/category/cryptography/)* [Arsenal Lab](https://meterpreter.org/category/arsenal-lab/)* [Hardware/Embedded](https://meterpreter.org/category/hardware-embedded/)* [Malware Defense](https://meterpreter.org/category/malware-defense/)* [Network Defense](https://meterpreter.org/category/network-defense/)* [Reverse Engineering](https://meterpreter.org/category/reverse-engineering/)* [Smart Grid/Industrial Security](https://meterpreter.org/category/smart-grid-industrial-security/)
Search for:

[Penetration Testing Tools](https://meterpreter.org/ "Penetration Testing Tools | Home page")

* [Vulnerability](https://meterpreter.org/category/information-security/vulnerability/)
# Researchers Uncover ‘DNSBomb’ – A New PDoS Attack Exploiting Legitimate DNS Features

by [ddos](https://meterpreter.org/author/ddos/ "Posts by ddos")
·
May 29, 2024

Scientists have unveiled the details of a powerful and efficient new technique called the “pulsing denial-of-service” (PDoS) attack, which leverages DNS queries and responses to achieve an attack amplification factor of 20,000 times.

The attack, known as DNSBomb (CVE-2024-33655), exploits legitimate DNS features such as query rate limiting, response timeouts, query aggregation, and maximum response size settings. These mechanisms enable the creation of synchronized response streams using a specially designed authoritative server and a vulnerable recursive DNS resolver.

![DNSBomb](data:image/gif;base64...)

**Mechanism of the DNSBomb Attack**

Experts explain that DNSBomb utilizes numerous widely implemented DNS mechanisms to accumulate queries sent at a low rate, increase their size in responses, and concentrate all responses into short, high-volume bursts to simultaneously overwhelm target systems.

**Attack Strategy**

The attack model involves IP spoofing multiple DNS queries to a domain controlled by the attacker and delaying responses to aggregate numerous replies. The objective of DNSBomb is to overwhelm the victim with periodic bursts of amplified traffic that are difficult to detect.

**Presentation of Findings and Protective Measures**

The research findings were [presented](https://sp2024.ieee-security.org/accepted-papers.html) at the 45th IEEE Symposium on Security and Privacy held last week in San Francisco, and previously at GEEKCON 2023 in Shanghai in October 2023.

The Internet Systems Consortium (ISC), which develops and maintains the BIND software suite, [stated](https://www.isc.org/blogs/2024-dnsbomb/) that their software is not [vulnerable](https://meterpreter.org/category/information-security/vulnerability/) to DNSBomb. Additionally, existing mitigation measures are sufficiently effective in minimizing the risks.

Share

Tags: [CVE-2024-33655](https://meterpreter.org/tag/cve-2024-33655/)[DNSBomb](https://meterpreter.org/tag/dnsbomb/)

Follow:

* **Next story**[CVE-2024-27842: macOS Sonoma Kernel Privilege Escalation, PoC Published](https://meterpreter.org/cve-2024-27842-macos-sonoma-kernel-privilege-escalation-poc-published/)* **Previous story**[CatDDoS Botnet Wreaks Havoc: 80+ Vulnerabilities Exploited](https://meterpreter.org/catddos-botnet-wreaks-havoc-80-vulnerabilities-exploited/)

### Search

**MAKE THE WEBSITE ONLINE**
[![](https://img.buymeacoffee.com/button-api/?text=Buy me a coffee&emoji=&slug=ddos&button_colour=BD5FFF&font_colour=ffffff&font_family=Cookie&outline_colour=000000&coffee_colour=FFDD00)](https://www.buymeacoffee.com/ddos)
###

* [Popular Posts](#tab-popular-4 "Popular Posts")* [Tags](#tab-tags-4 "Tags")

* [![analyzing web server logs](data:image/gif;base64...)](https://meterpreter.org/oste-web-log-analyzer-automate-the-process-of-analyzing-web-server-logs/)

  [Data Forensics](https://meterpreter.org/category/data-forensics-incident-response/)

  [OSTE-Web-Log-Analyzer: automate the process of analyzing web server logs](https://meterpreter.org/oste-web-log-analyzer-automate-the-process-of-analyzing-web-server-logs/)

  January 11, 2025

  * [![Impacket](data:image/gif;base64...)](https://meterpreter.org/impacket-collection-of-python-classes-for-working-with-network-protocols/)

    [Ethical Hacking](https://meterpreter.org/category/exploitation-ethical-hacking/) / [Network Attacks](https://meterpreter.org/category/network-attacks/)

    [Impacket: collection of Python classes for working with network protocols](https://meterpreter.org/impacket-collection-of-python-classes-for-working-with-network-protocols/)

    December 12, 2024

    * [![Cloud Security Testing Tool](data:image/gif;base64...)](https://meterpreter.org/halberd-multi-cloud-attack-tool/)

      [Ethical Hacking](https://meterpreter.org/category/exploitation-ethical-hacking/)

      [Halberd: Multi-Cloud Attack Tool](https://meterpreter.org/halberd-multi-cloud-attack-tool/)

      December 12, 2024

      * [![hunting platform](data:image/gif;base64...)](https://meterpreter.org/saferwall-collaborative-and-streamlined-threat-analysis-at-scale/)

        [Malware Defense](https://meterpreter.org/category/malware-defense/)

        [saferwall: Collaborative and Streamlined Threat Analysis at Scale](https://meterpreter.org/saferwall-collaborative-and-streamlined-threat-analysis-at-scale/)

        December 13, 2024

        * [![NETwork Manager](data:image/gif;base64...)](https://meterpreter.org/networkmanager-managing-networks-troubleshoot-network-problems/)

          [Network Defense](https://meterpreter.org/category/network-defense/)

          [NETworkManager: managing networks/troubleshoot network problems](https://meterpreter.org/networkmanager-managing-networks-troubleshoot-network-problems/)

          December 13, 2024

* [Amazon](https://meterpreter.org/tag/amazon/)
  [AMD](https://meterpreter.org/tag/amd/)
  [Android](https://meterpreter.org/tag/android/)
  [Apple](https://meterpreter.org/tag/apple/)
  [ARM](https://meterpreter.org/tag/arm/)
  [Artificial intelligence](https://meterpreter.org/tag/artificial-intelligence/)
  [ASRock](https://meterpreter.org/tag/asrock/)
  [Asus](https://meterpreter.org/tag/asus/)
  [ChatGPT](https://meterpreter.org/tag/chatgpt/)
  [chrome](https://meterpreter.org/tag/chrome/)
  [facebook](https://meterpreter.org/tag/facebook/)
  [Firefox](https://meterpreter.org/tag/firefox/)
  [Gigabyte](https://meterpreter.org/tag/gigabyte/)
  [Github](https://meterpreter.org/tag/github/)
  [google](https://meterpreter.org/tag/google/)
  [Google Chrome](https://meterpreter.org/tag/google-chrome/)
  [hacker](https://meterpreter.org/tag/hacker/)
  [Huawei](https://meterpreter.org/tag/huawei/)
  [Intel](https://meterpreter.org/tag/intel/)
  [Lenovo](https://meterpreter.org/tag/lenovo/)
  [LG](https://meterpreter.org/tag/lg/)
  [Linux](https://meterpreter.org/tag/linux/)
  [Linux Kernel](https://meterpreter.org/tag/linux-kernel/)
  [MediaTek](https://meterpreter.org/tag/mediatek/)
  [Meta](https://meterpreter.org/tag/meta/)
  [Microsoft](https://meterpreter.org/tag/microsoft/)
  [microsoft edge](https://meterpreter.org/tag/microsoft-edge/)
  [MSI](https://meterpreter.org/tag/msi/)
  [Nvidia](https://meterpreter.org/tag/nvidia/)
  [OpenAI](https://meterpreter.org/tag/openai/)
  [PlayStation 5](https://meterpreter.org/tag/playstation-5/)
  [Qualcomm](https://meterpreter.org/tag/qualcomm/)
  [ransomware](https://meterpreter.org/tag/ransomware/)
  [Samsung](https://meterpreter.org/tag/samsung/)
  [SK Hynix](https://meterpreter.org/tag/sk-hynix/)
  [Sony](https://meterpreter.org/tag/sony/)
  [Steam Deck](https://meterpreter.org/tag/steam-deck/)
  [TSMC](https://meterpreter.org/tag/tsmc/)
  [vulnerability](https://meterpreter.org/tag/vulnerability/)
  [windows](https://meterpreter.org/tag/windows/)
  [Windows 7](https://meterpreter.org/tag/windows-7/)
  [Windows 10](https://meterpreter.org/tag/windows-10/)
  [Windows 10X](https://meterpreter.org/tag/windows-10x/)
  [Windows 11](https://meterpreter.org/tag/windows-11/)
  [Xbox](https://meterpreter.org/tag/xbox/)

**Reward**
### Brilliantly

SAFE!

[meterpreter.org](https://sur.ly/i/meterpreter.org/)
### Content & Links

Verified by [Sur.ly](https://sur.ly)

2022

* [Home](https://meterpreter.org/)* [About Us](https://meterpreter.org/about-us/)* [Contact Us](https://meterpreter.org/contact-us-2/)* [DMCA NOTICE](https://meterpreter.org/dmca-notice/)* [Privacy Policy](https://meterpreter.org/privacy-policy/)

Penetration Testing Tools © 2025. All Rights Reserved.

x

=== Content from gitlab.isc.org_20122c33_20250111_071434.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Register](/users/sign_up)

# Report: New DNS-based Pulsing DoS Attack (DNSBomb) of BIND

| Quick Links | 🔗 |
| --- | --- |
| Incident Manager: | [@tkrizek](/tkrizek "Tom Krizek") |
| Deputy Incident Manager: | [@ebf](/ebf "Everett Fulton") |
| Public Disclosure Date: | YYYY-MM-DD |
| CVSS Score: | TBD |
| Security Advisory: | TBD |
| Mattermost Channel: | [CVE-YYYY-NNNN: DNSBomb](https://mattermost.isc.org/isc/channels/cve-dnsbomb) |
| Support Ticket: | N/A |
| Release Checklist: | TBD |

💡 **Click [here](https://gitlab.isc.org/isc-private/isc-wiki/-/wikis/Security-Incident-Handling-Checklist-Explanations) (internal resource) for general information about the security incident handling process.**

### Earlier Than T-5

* [🔗](https://gitlab.isc.org/isc-private/isc-wiki/-/wikis/Security-Incident-Handling-Checklist-Explanations#pick-a-deputy-incident-manager) **(IM)** Pick a Deputy Incident Manager
* [🔗](https://gitlab.isc.org/isc-private/isc-wiki/-/wikis/Security-Incident-Handling-Checklist-Explanations#respond-to-the-bug-reporter) **(IM)** Respond to the bug reporter
* [🔗](https://gitlab.isc.org/isc-private/isc-wiki/-/wikis/Security-Incident-Handling-Checklist-Explanations#ensure-there-are-no-public-merge-requests-which-inadvertently-disclose-the-issue) **(SwEng)** Ensure there are no public merge requests which inadvertently disclose the issue
* [🔗](https://gitlab.isc.org/isc-private/isc-wiki/-/wikis/Security-Incident-Handling-Checklist-Explanations#assign-a-cve-identifier) **(IM)** Assign a CVE identifier
* [🔗](https://gitlab.isc.org/isc-private/isc-wiki/-/wikis/Security-Incident-Handling-Checklist-Explanations#update-this-issue-with-the-assigned-cve-identifier-and-the-cvss-score) **(SwEng)** Update this issue with the assigned CVE identifier and the CVSS score
* [🔗](https://gitlab.isc.org/isc-private/isc-wiki/-/wikis/Security-Incident-Handling-Checklist-Explanations#determine-the-range-of-product-versions-affected-including-the-subscription-edition) **(SwEng)** Determine the range of product versions affected (including the Subscription Edition)
* [🔗](https://gitlab.isc.org/isc-private/isc-wiki/-/wikis/Security-Incident-Handling-Checklist-Explanations#determine-whether-workarounds-for-the-problem-exist) **(SwEng)** Determine whether workarounds for the problem exist
* [🔗](https://gitlab.isc.org/isc-private/isc-wiki/-/wikis/Security-Incident-Handling-Checklist-Explanations#if-necessary-coordinate-with-other-parties) **(SwEng)** If necessary, coordinate with other parties
* [🔗](https://gitlab.isc.org/isc-private/isc-wiki/-/wikis/Security-Incident-Handling-Checklist-Explanations#prepare-earliest-notification-text-and-hand-it-off-to-marketing) **(Support)** Prepare "earliest" notification text and hand it off to Marketing
* [🔗](https://gitlab.isc.org/isc-private/isc-wiki/-/wikis/Security-Incident-Handling-Checklist-Explanations#update-earliest-notification-document-in-sf-portal-and-send-bulk-email-to-earliest-customers) **(Marketing)** Update "earliest" notification document in SF portal and send bulk email to earliest customers
* [🔗](https://gitlab.isc.org/isc-private/isc-wiki/-/wikis/Security-Incident-Handling-Checklist-Explanations#create-a-merge-request-for-the-security-advisory-and-include-all-readily-available-information-in-it) **(Support)** Create a merge request for the Security Advisory and include all readily available information in it
* [🔗](https://gitlab.isc.org/isc-private/isc-wiki/-/wikis/Security-Incident-Handling-Checklist-Explanations#prepare-a-private-merge-request-containing-a-system-test-reproducing-the-problem) **(SwEng)** Prepare a private merge request containing a system test reproducing the problem
* [🔗](https://gitlab.isc.org/isc-private/isc-wiki/-/wikis/Security-Incident-Handling-Checklist-Explanations#notify-support-when-a-reproducer-is-ready) **(SwEng)** Notify Support when a reproducer is ready
* [🔗](https://gitlab.isc.org/isc-private/isc-wiki/-/wikis/Security-Incident-Handling-Checklist-Explanations#prepare-a-detailed-explanation-of-the-code-flow-triggering-the-problem) **(SwEng)** Prepare a detailed explanation of the code flow triggering the problem
* [🔗](https://gitlab.isc.org/isc-private/isc-wiki/-/wikis/Security-Incident-Handling-Checklist-Explanations#prepare-a-private-merge-request-with-the-fix) **(SwEng)** Prepare a private merge request with the fix
* [🔗](https://gitlab.isc.org/isc-private/isc-wiki/-/wikis/Security-Incident-Handling-Checklist-Explanations#ensure-the-merge-request-with-the-fix-is-reviewed-and-has-no-outstanding-discussions) **(SwEng)** Ensure the merge request with the fix is reviewed and has no outstanding discussions
* [🔗](https://gitlab.isc.org/isc-private/isc-wiki/-/wikis/Security-Incident-Handling-Checklist-Explanations#review-the-documentation-changes-introduced-by-the-merge-request-with-the-fix) **(Support)** Review the documentation changes introduced by the merge request with the fix
* [🔗](https://gitlab.isc.org/isc-private/isc-wiki/-/wikis/Security-Incident-Handling-Checklist-Explanations#prepare-backports-of-the-merge-request-addressing-the-problem-for-all-affected-and-still-maintained-branches-of-a-given-product) **(SwEng)** Prepare backports of the merge request addressing the problem for all affected (and still maintained) branches of a given product
* [🔗](https://gitlab.isc.org/isc-private/isc-wiki/-/wikis/Security-Incident-Handling-Checklist-Explanations#finish-preparing-the-security-advisory) **(Support)** Finish preparing the Security Advisory
* [🔗](https://gitlab.isc.org/isc-private/isc-wiki/-/wikis/Security-Incident-Handling-Checklist-Explanations#create-or-update-the-private-issue-containing-links-to-fixes-reproducers-for-all-cves-fixed-in-a-given-release-cycle) **(QA)** Create (or update) the private issue containing links to fixes & reproducers for all CVEs fixed in a given release cycle
* [🔗](https://gitlab.isc.org/isc-private/isc-wiki/-/wikis/Security-Incident-Handling-Checklist-Explanations#bind-9-only-reserve-a-block-of-changes-placeholders-once-the-complete-set-of-vulnerabilities-fixed-in-a-given-release-cycle-is-determined) **(QA)** (BIND 9 only) Reserve a block of `CHANGES` placeholders once the complete set of vulnerabilities fixed in a given release cycle is determined
* [🔗](https://gitlab.isc.org/isc-private/isc-wiki/-/wikis/Security-Incident-Handling-Checklist-Explanations#merge-the-cve-fixes-in-cve-identifier-order) **(QA)** Merge the CVE fixes in CVE identifier order
* [🔗](https://gitlab.isc.org/isc-private/isc-wiki/-/wikis/Security-Incident-Handling-Checklist-Explanations#prepare-a-standalone-patch-for-the-last-stable-release-of-each-affected-and-still-maintained-product-branch) **(QA)** Prepare a standalone patch for the last stable release of each affected (and still maintained) product branch
* [🔗](https://gitlab.isc.org/isc-private/isc-wiki/-/wikis/Security-Incident-Handling-Checklist-Explanations#prepare-asn-releases-as-outlined-in-the-release-checklist) **(QA)** Prepare ASN releases (as outlined in the Release Checklist)

### At T-5

* [🔗](https://gitlab.isc.org/isc-private/isc-wiki/-/wikis/Security-Incident-Handling-Checklist-Explanations#update-the-text-on-the-t-5-from-the-printing-press-project-and-earliest-asn-documents-in-the-sf-portal) **(Marketing)** Update the text on the T-5 (from the Printing Press project) and "earliest" ASN documents in the SF portal
* [🔗](https://gitlab.isc.org/isc-private/isc-wiki/-/wikis/Security-Incident-Handling-Checklist-Explanations#bind-9-only-update-the-bind-s-information-document-in-sf-with-download-links-to-the-new-versions) **(Marketing)** (BIND 9 only) Update the BIND -S information document in SF with download links to the new versions
* [🔗](https://gitlab.isc.org/isc-private/isc-wiki/-/wikis/Security-Incident-Handling-Checklist-Explanations#bulk-email-eligible-customers-to-check-the-sf-portal) **(Marketing)** Bulk email eligible customers to check the SF portal
* [🔗](https://gitlab.isc.org/isc-private/isc-wiki/-/wikis/Security-Incident-Handling-Checklist-Explanations#bind-9-only-send-a-pre-announcement-email-to-the-bind-announce-mailing-list-to-alert-users-that-the-upcoming-release-will-include-security-fixes) **(Marketing)** (BIND 9 only) Send a pre-announcement email to the *bind-announce* mailing list to alert users that the upcoming release will include security fixes

### At T-1

* [🔗](https://gitlab.isc.org/isc-private/isc-wiki/-/wikis/Security-Incident-Handling-Checklist-Explanations#send-notifications-to-os-packagers) **(First IM)** Send notifications to OS packagers

### On the Day of Public Disclosure

* [🔗](https://gitlab.isc.org/isc-private/isc-wiki/-/wikis/Security-Incident-Handling-Checklist-Explanations#grant-qa-marketing-clearance-to-proceed-with-public-release) **(IM)** Grant QA & Marketing clearance to proceed with public release
* [🔗](https://gitlab.isc.org/isc-private/isc-wiki/-/wikis/Security-Incident-Handling-Checklist-Explanations#publish-the-releases-as-outlined-in-the-release-checklist) **(QA/Marketing)** Publish the releases (as outlined in the release checklist)
* [🔗](https://gitlab.isc.org/isc-private/isc-wiki/-/wikis/Security-Incident-Handling-Checklist-Explanations#bind-9-only-add-the-new-cves-to-the-vulnerability-matrix-in-the-knowledge-base) **(Support)** (BIND 9 only) Add the new CVEs to the vulnerability matrix in the Knowledge Base
* [🔗](https://gitlab.isc.org/isc-private/isc-wiki/-/wikis/Security-Incident-Handling-Checklist-Explanations#bump-document-version-for-the-security-advisory-and-publish-it-in-the-knowledge-base) **(Support)** Bump Document Version for the Security Advisory and publish it in the Knowledge Base
* [🔗](https://gitlab.isc.org/isc-private/isc-wiki/-/wikis/Security-Incident-Handling-Checklist-Explanations#send-notification-emails-to-third-parties) **(First IM)** Send notification emails to third parties
* [🔗](https://gitlab.isc.org/isc-private/isc-wiki/-/wikis/Security-Incident-Handling-Checklist-Explanations#advise-mitre-about-the-disclosed-cves) **(First IM)** Advise MITRE about the disclosed CVEs
* [🔗](https://gitlab.isc.org/isc-private/isc-wiki/-/wikis/Security-Incident-Handling-Checklist-Explanations#merge-the-security-advisory-merge-request) **(First IM)** Merge the Security Advisory merge request
* [🔗](https://gitlab.isc.org/isc-private/isc-wiki/-/wikis/Security-Incident-Handling-Checklist-Explanations#inform-original-reporter-if-external-that-the-security-disclosure-process-is-complete) **(IM)** Inform original reporter (if external) that the security disclosure process is complete
* [🔗](https://gitlab.isc.org/isc-private/isc-wiki/-/wikis/Security-Incident-Handling-Checklist-Explanations#update-the-sf-portal-to-clear-the-asn) **(Marketing)** Update the SF portal to clear the ASN
* [🔗](https://gitlab.isc.org/isc-private/isc-wiki/-/wikis/Security-Incident-Handling-Checklist-Explanations#email-asn-recipients-that-the-embargo-is-lifted) **(Marketing)** Email ASN recipients that the embargo is lifted

### After Public Disclosure

* [🔗](https://gitlab.isc.org/isc-private/isc-wiki/-/wikis/Security-Incident-Handling-Checklist-Explanations#merge-a-regression-test-reproducing-the-bug-into-all-affected-and-still-maintained-branches) **(QA)** Merge a regression test reproducing the bug into all affected (and still maintained) branches

---

# Report: New DNS-based Pulsing DoS Attack (DNSBomb)

By Xiang Li [1] from Network and Information Security Laboratory, Tsinghua University [2]

## Paper - confidential

[dnsbomb-li-sp14summer.pdf](/-/project/1/uploads/b650d3a2fcd4adce73c925d28b10d5cd/dnsbomb-li-sp14summer.pdf)

## Overview

We found a new DNS vulnerability that can be exploited to perform a new pulsing DoS attack, named the **DNSBomb** attack.

DNSBomb exploits multiple widely-implemented DNS mechanisms to accumulate DNS queries that are sent at a low rate, amplify queries into large-sized responses, and concentrate all DNS responses into a short, high-volume periodic pulsing burst to simultaneously overwhelm target systems.

The effects of an exploit would be widespread and highly impactful, as our small-scale experiments show that the peak pulse magnitude can approach 8.7Gb/s and the bandwidth amplification factor can exceed 20,000x. Besides, DNSBomb conforms to defacto DNS specifications and best practices and exploits current mitigation patches of "birthday paradox"-based DNS cache poisoning attacks.

## Pulsing DoS Attack

[![pdos](data:image/gif;base64...)](/isc-projects/bind9/-/blob/main/./pdos.png)

Figure 1. Concept of the Pulsing DoS Attack.

Traditional DoS attacks function by continuously flooding a target with superfluous requests, exhausting the available resources. Such classic hyper-volumetric DoS attacks, however, are simple to detect due to continual high volume of traffic.

To make DoS attacks more covert and effective, consequently, Kuzmanovic and Knightly first proposed the Pulsing DoS (**PDoS**) attack in 2003 [3]. Unlike its continuous counterpart, a PDoS attack is characterized by intermittent traffic bursts aimed at periodically overwhelming the target and a low average traffic rate during the period. This pulsating approach is analogous to a pulse beat, which resonates at the target’s weakest points, causing perturbations that can lead to temporary or even permanent system failure.

As shown on the right of Figure 1, the PDoS attack differs from traditional traffic flooding attacks that send the attacking traffic continuously by constructing the traffic pulse with a magnitude of *M* and lasting a time window of *W* at a period of *P*.

Previous pulsing attacks leveraged latency-based methods to concentrate traffic. However, *these PDoS attacks either yield a small amplification factor (e.g., 10 of [4]) or require a large pulse period (1,800s of [5]), neither of which are practical and powerful enough to apply.*

## Vulnerability Details

We find that *the inherent availability-guaranteeing, security-protecting, and reliability-enhancing DNS mechanisms can be exploited to accumulate, amplify, and concentrate attack traffic with a much larger time window.* All of these features contribute to the presence of the DNSBomb vulnerability.

Specifically, first, we employ the availability-guaranteeing DNS mechanism *timeout* to ensure a long period for accumulating queries, e.g., between 1s and 15s, which is greater than the maximum path latency. Second, by leveraging the security-protecting DNS mechanism *query aggregation* on the same domain, we can amplify a small-sized DNS query packet into a large-sized response packet with minimal overload (only one query will be sent to the authoritative server). Third, by delicately delaying the response, we are able to manipulate resolvers to simultaneously return all responses with the reliability-enhancing DNS mechanism *response fast-returning*.

Rather than leveraging different query path latencies of global DNS resolvers, DNSBomb delicately combines both DNS queries and responses with multiple operational DNS resolution mechanisms and could achieve a bandwidth amplification factor of over *20K*.

Inherently, we demonstrate that *the availability-guaranteeing, security-protecting, and reliability-enhancing DNS mechanisms can be exploited to accumulate, amplify, and concentrate attack traffic.*

We find that the combination of DNS query and response opens long-overlooked attack surfaces to launch new practical-and-powerful PDoS attacks. Especially, the timeout and fast-returning mechanisms provide sufficient time to accumulate attack traffic fast.

## DNSBomb Attack

[![dnsbomb](data:image/gif;base64...)](/isc-projects/bind9/-/blob/main/./dnsbomb.png)

Figure 2. Threat Model of the DNSBomb Attack.

As illustrated in Figure 2, there are three critical steps to construct the DNSBomb attack: *accumulating DNS queries* (step ➀), *amplifying DNS queries into responses* (step ➁), and *concentrating DNS responses to the target* (step ➂).

The core concept of the DNSBomb attack is analogous to Goku’s signature ***Kamehameha*** technique (a blast wave attack) in the Dragon Ball series [6]. The Kamehameha is formed when cupped hands are drawn to the user’s side to gather energy (**step ➀: Ka-me**) and the energy is enhanced into a large force ball between cupped hands (step **➁: Ha-me**). The hands are then thrust forward in order to release a streaming, powerful beam of energy (**step ➂: HA!!!**).

Similarly, DNSBomb first accumulates sufficient DNS queries to collect bomb energy (Ka-me), then amplifies each query into a larger response for enhancing energy (Ha-me), and finally concentrates them into a powerful missile of energy directed at the target server (HA!!!).

Since attackers can control the accumulating time to collect enough traffic (bomb countdown) and cause concentrated traffic to explode like a bomb, *we refer to our newly proposed PDoS attack as the* **DNSBomb** attack.

**➀ Ka-me:** Accumulating DNS Queries. The first phase is accumulating as many DNS queries as possible at a very low rate on the exploitable resolver before responses returning (step ❶). To achieve this goal, we employ the availability-guaranteeing DNS mechanism *timeout* to ensure a long period for sending queries. The timeout window, for instance, can range from hundreds of milliseconds to tens of seconds, allowing for enough accumulating time. Furthermore, we will show how the *IP defragmentation timeout* mechanism can be integrated to increase the accumulating time.

**➁ Ha-me:** Amplifying DNS Queries into Responses. The second phase is to amplify a small DNS query packet into a larger response packet (step ❷). To accomplish this, we use our controlled domain and return large-sized responses in accordance with the resolver’s capability. In addition, by exploiting the security-protecting DNS mechanism *query aggregation* on the same domain name, we significantly reduce our nameserver’s overload from tens of thousands of accumulated queries to just a few (or even one) queries.

**➂ HA!!!:** Concentrating DNS Responses. After accumulating numerous queries and amplifying them into larger responses, in the third phase, by delicately holding responses until nearing timeout in our own nameserver (step ❸), we can manipulate resolvers to simultaneously return all responses corresponding to each query (step ❹). Specifically, due to the reliability-enhancing DNS mechanism *response fast-returning* that the packet should be transmitted as soon as possible, all responses will be concentrated and then sent to the target server in a short amount of time, producing a powerful pulsing DoS traffic.

## Threat Surface

Table 1. Software and tested attack features.

| Software | Version |
| --- | --- |
| BIND | All versions are vulnerable |
| `Query rate-limit` | 130 |
| `Query timeout` | 10s |
| `Number of queries to Auth.` | 6 |
| `Max. response size to client` | 1,232B |
| `1k-response-returning time` | 8ms |

To demonstrate the attack result, we analyzed and tested several attack features that impact the DNSBomb attack, including:

* `Query rate-limit`: the number of client queries that can be accumulated. If more queries can be accumulated, the pulsing traffic will be large.
* `Query timeout`: the time that these queries are accumulated. If the timeout is large, this means that attackers can send packets as a low rate by distributing packets among the timeout period.
* `Number of queries to Auth.`: the number of queries sent to the authoritative server. If the number is small, this means that the attacker's cost of receiving traffic on the nameserver side can be minimal.
* `Max. response size to client`: the size of a response sent to the client. If the size is large, the pulsing traffic will be large.
* `1k-response-returning time`: the time used by the resolver to returning 1k response to the client. If the time is small or the returning speed is fast, the pulsing magnitude will be high.

## PoC

In this test, we performed the DNSBomb attack in the following steps and settings.

We installed tested software on local machines and all of them are linked to a local network with a 10Gb/s network bandwidth.

* Step 1: We send 1k queries to the tested resolver for one same domain and distribute the 1k queries among the `Query timeout` period.
* Step 2: Upon receiving the first query, the resolver will request our own nameserver for responses. The number of request is only `Number of queries to Auth.`.
* Step 3: The nameserver holds the query from the resolver until nearing the `Query timeout` and returns a large-sized response according to the `Max. response size` value.
* Step 4: After receiving the response, the resolver will return all 1k response to the client within the `1k-response-returning time`.

Then we calculated the traffic bandwidth of attacker-side (the query we sent to the resolver) and victim-side (the response the resolver sent to the client). The amplification factor is `traffic bandwidth of victim-side/traffic bandwidth of attacker-side`.

The exploitation result is shown in Table 2.

Table 2. DNSBomb experiment results (We use a 10ms time window to calculate the network bandwidth.).

| Software | Victim-side | Attacker-side | Amplification factor |
| --- | --- | --- | --- |
| BIND | 140.6Kb/s | 92.5Mb/s | 673.9x |

The attack traffic flow is showed in Figure 3.

[![software](data:image/gif;base64...)](/isc-projects/bind9/-/blob/main/./bind-1232.png)

Figure 3. Traffic flow under the DNSBomb Attack.

## Real-world Impact

[![attack](data:image/gif;base64...)](/isc-projects/bind9/-/blob/main/./attack.png)

Figure 4. DNSBomb Attack Results on Different Servers.

We conducted controlled real-world experiments to evaluate how the DNSBomb attack DoS target servers or degrade the RoQ of services. First, we measure the network bandwidth occupation of DNSBomb, then use it to attack three types of servers, including a DNS resolver and HTTP/2- and HTTP/3-based websites.

* Figure 4a shows that the normal bandwidth decreases from 958.8Mb/s to 0.0b/s when the pulsing traffic arrives at the 10s and lasts for about 50ms.
* Results in Figure 4b indicate that the usual query latency ranges from 50 to 250ms and does not exceed 750ms. Under the DNSBomb attack, however, the client can never receive a valid response (1s latency).
* Figure 4c displays that the normal HTTP request time cost is only less than 3ms. Once the DNSBomb pulsing traffic arrives, the request response from TCP port 80 (under attack) is returned at a cost of over 750ms or is lost entirely.
* As illustrated in Figure 4d, when the pulsing traffic occurs, the request response increases by 2,000% from 2ms to 41ms.

We also demonstrated the attack impact in GEEKCON 2023 and exploited it to DoS a livestream server. Results showed that the users could hardly watch a fluent live.

> **Note:** *we did not disclose the software name or vendor name to keep it from being exploited. We just said that one anonymous software was being leveraged. What we did after found this vulnerability is try report it to affected vendors.*

## Mitigation

The DNSBomb attack is made possible by the inherent DNS resolution mechanisms for guaranteeing availability, protecting security, and enhancing reliability, instead of a classic vulnerability. Therefore, to mitigate DNSBomb, vendors have to compromise by reducing some resolution performance and standardize their implementations. Specifically:

* The `Query rate-limit` should also be restricted to a small value such as AdGuard’s 100.
* The `Query timeout` should be reduced to a modest value like Google’s 1.5s.
* The `Max. response size to client` should be standardized to 1,232B.
* The `Response-returning speed` should be small or equal to the `Query timeout` (that will degrade the performance).
* The resolver should return some error messages in advance before receiving the response from the nameserver instead of accumulating more queries.

To demonstrate the effect of our recommended mitigation solutions, against one anonymous software, we conduct 6 experiments with different restrictions, including the base (no restrictions with 1,000 queries as before), `Query rate-limit` set to 1s, `Query rate-limit` set to 100, `Max. response size to client` set to 1,232B, `1k-response-returning time` set to `Query timeout`, and all restrictions set.

Results in Table 3 indicate that the `response time` restriction has the best defensive effect, since it is the key to concentrating responses. In contrast, the `Query rate-limit` restriction is the worst (attackers could coordinate more resolvers or different queried domains). Additionally, the `Query timeout` and `Max. response size to client` restrictions can reduce the amplification factor to some degree.

Table 3. DNSBomb amplification factors under different mitigation solutions.

| Software | Base | Timeout | Rate-limit | Pkt. Size | Res. Time | All |
| --- | --- | --- | --- | --- | --- | --- |
| BIND | 673.9x | 122.5x | 1,347.8x | 673.9x | 13.5x | 47.2x |

## Reference

[1] Xiang Li's homepage: <https://lixiang521.com/>.

[2] Network and Information Security Laboratory, Tsinghua University. <https://netsec.ccert.edu.cn/>

[3] Aleksandar Kuzmanovic and Edward W Knightly. Low-Rate TCP-Targeted Denial of Service Attacks: The Shrew vs. the Mice and Elephants. In *Proceedings of the 2003 Annual conference of the ACM Special Interest Group on Data Communication on the applications, technologies, architectures, and protocols for computer communication (SIGCOMM '03)*, 2003.

[4] Ryan Rasti, Mukul Murthy, Nicholas Weaver, and Vern Paxson. Temporal Lensing and Its Application in Pulsing Denial-of-Service Attacks. In Proceedings of 2015 IEEE Symposium on Security and Privacy (S&P '15), 2015.

[5] Run Guo, Jianjun Chen, Yihang Wang, Keran Mu, Baojun Liu, Xiang Li, Chao Zhang, Haixin Duan, and Jianping Wu. Temporal CDN-Convex Lens: A CDN-Assisted Practical Pulsing DDoS Attack. In *Proceedings of the 32nd USENIX Security Symposium (USENIX Security '23)*, 2023.

[6] Fandom. Dragon Ball Wiki. <https://dragonball.fandom.com/wiki/Kamehameha>, 2023.

[Report\_-*New\_DNS-based\_Pulsing\_DoS\_Attack*-\_BIND.pdf](/-/project/1/uploads/70c30b17972670a4deb25bdab19f590d/Report_-_New_DNS-based_Pulsing_DoS_Attack_-_BIND.pdf)

Edited Feb 26, 2024 by [Petr Špaček](/pspacek)

To upload designs, you'll need to enable LFS and have an admin enable hashed storage. [More information](/help/user/project/issues/design_management.md#prerequisites)

Assignee
Loading

Time tracking
Loading



=== Content from github.com_ae6fd216_20250111_071432.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNLnetLabs%2Funbound%2Fcommit%2Fc3206f4568f60c486be6d165b1f2b5b254fea3de)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNLnetLabs%2Funbound%2Fcommit%2Fc3206f4568f60c486be6d165b1f2b5b254fea3de)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=NLnetLabs%2Funbound)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[NLnetLabs](/NLnetLabs)
/
**[unbound](/NLnetLabs/unbound)**
Public

* [Notifications](/login?return_to=%2FNLnetLabs%2Funbound) You must be signed in to change notification settings
* [Fork
  366](/login?return_to=%2FNLnetLabs%2Funbound)
* [Star
   3.2k](/login?return_to=%2FNLnetLabs%2Funbound)

* [Code](/NLnetLabs/unbound)
* [Issues
  285](/NLnetLabs/unbound/issues)
* [Pull requests
  38](/NLnetLabs/unbound/pulls)
* [Actions](/NLnetLabs/unbound/actions)
* [Projects
  2](/NLnetLabs/unbound/projects)
* [Security](/NLnetLabs/unbound/security)
* [Insights](/NLnetLabs/unbound/pulse)

Additional navigation options

* [Code](/NLnetLabs/unbound)
* [Issues](/NLnetLabs/unbound/issues)
* [Pull requests](/NLnetLabs/unbound/pulls)
* [Actions](/NLnetLabs/unbound/actions)
* [Projects](/NLnetLabs/unbound/projects)
* [Security](/NLnetLabs/unbound/security)
* [Insights](/NLnetLabs/unbound/pulse)

## Commit

[Permalink](/NLnetLabs/unbound/commit/c3206f4568f60c486be6d165b1f2b5b254fea3de)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

- Fix for the DNSBomb vulnerability [CVE-2024-33655](https://github.com/advisories/GHSA-2xh4-pf7v-vh6h "CVE-2024-33655"). Thanks to Xiang Li

[Browse files](/NLnetLabs/unbound/tree/c3206f4568f60c486be6d165b1f2b5b254fea3de)
Browse the repository at this point in the history

```
  from the Network and Information Security Lab of Tsinghua University
  for reporting it.
```

* Loading branch information

[![@wcawijngaards](https://avatars.githubusercontent.com/u/5220559?s=40&v=4)](/wcawijngaards)

[wcawijngaards](/NLnetLabs/unbound/commits?author=wcawijngaards "View all commits by wcawijngaards")
committed
May 1, 2024

1 parent
[9abed3f](/NLnetLabs/unbound/commit/9abed3fc8336d5f7688058c5675b7162ffa9d67e)

commit c3206f4

 Show file tree

 Hide file tree

Showing
**20 changed files**
with
**412 additions**
and
**3 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* doc

  + doc/Changelog
    [Changelog](#diff-4244fa301bd80b0a8f553ce0751fb0fcde1a45ee9dee71db85135cffde8ac712)
  + doc/example.conf.in
    [example.conf.in](#diff-2e824197ecb0cafe24f8e1709182a66d5d7eef05fb6b6c30d5ae26731216acda)
  + doc/unbound.conf.5.in
    [unbound.conf.5.in](#diff-cc411cb8e62411fdf002d2c96043cd76e762116c4245cee26afed7243911a74c)
* services

  + cache

    - services/cache/infra.c
      [infra.c](#diff-d26592e90ec2c46ba79ab9a423c810e21859b0634d58ddd346bde51900bd005a)
    - services/cache/infra.h
      [infra.h](#diff-11e5ceded6984a5c46e6a3ea05c2e0648ae822eba95af713aae31c4e0f7b8f02)
  + services/mesh.c
    [mesh.c](#diff-d34d1bee4eb8d766981c922da42deac783dcc90f1eccdb1e3e480b7039e9014e)
* testdata

  + testdata/cachedb\_expired\_client\_timeout.crpl
    [cachedb\_expired\_client\_timeout.crpl](#diff-55ff038e4e5c13d0a7de7104301d282c6cc2857096435bdca452081699415bbf)
  + testdata/cachedb\_subnet\_expired.crpl
    [cachedb\_subnet\_expired.crpl](#diff-44910cd5da3dfd7b2f0153040bfedd14a4a2708c2cbebbcb99f13d5004bda111)
  + doh\_downstream.tdir

    - testdata/doh\_downstream.tdir/doh\_downstream.conf
      [doh\_downstream.conf](#diff-01584461aa118abc57935434484c55cfff750c20ff5ec437bb8d62eded4358c9)
  + doh\_downstream\_notls.tdir

    - testdata/doh\_downstream\_notls.tdir/doh\_downstream\_notls.conf
      [doh\_downstream\_notls.conf](#diff-ce8c29bcf9d1d3b1d53ce5c62a56cbb0fbc4d545166a462c92f87fe1a90cb762)
  + doh\_downstream\_post.tdir

    - testdata/doh\_downstream\_post.tdir/doh\_downstream\_post.conf
      [doh\_downstream\_post.conf](#diff-44bf3f5a363abc674e54a457eb0dd99460f6af154e6f8822950faada5ca1560f)
  + fwd\_three\_service.tdir

    - testdata/fwd\_three\_service.tdir/fwd\_three\_service.conf
      [fwd\_three\_service.conf](#diff-7fb26694157862cf9d5aa82bd2cf81c6fab7fc748a87442318c847677d7cddde)
  + testdata/iter\_ghost\_timewindow.rpl
    [iter\_ghost\_timewindow.rpl](#diff-3eb1445c3c911cbff12755cd3e389fc4c271a6026065f51f8b213a36229e1703)
  + ssl\_req\_order.tdir

    - testdata/ssl\_req\_order.tdir/ssl\_req\_order.conf
      [ssl\_req\_order.conf](#diff-6a042c047570034060270cbd1dc2768a288d6d20e2fc3e510458762eeb83c65a)
  + tcp\_req\_order.tdir

    - testdata/tcp\_req\_order.tdir/tcp\_req\_order.conf
      [tcp\_req\_order.conf](#diff-dd770a925e77b5ae6a15de57c4fabfb2d015ffd09c43e1805abd6e9e926518f5)
  + tcp\_sigpipe.tdir

    - testdata/tcp\_sigpipe.tdir/tcp\_sigpipe.conf
      [tcp\_sigpipe.conf](#diff-f3f5a47baa5639a9eb2c05dd24e4c34473257259fc469ac38edcce97fd50fb0d)
* util

  + util/config\_file.c
    [config\_file.c](#diff-e03103d131c8cadc069580da76c051fdc00d1f7d16680f0d5a0db1632eb3ca5f)
  + util/config\_file.h
    [config\_file.h](#diff-645b322cdc9fc36626e25d6c305b14e33d5044c7bbbdadac93a2554ac29a53c8)
  + util/configlexer.lex
    [configlexer.lex](#diff-15d2afe74ae990b9cb9bcd36326bbbb3d5fcbee36d37c8c24fc025e8e31658b4)
  + util/configparser.y
    [configparser.y](#diff-7dae51bf100ba61c713fb29b512d36b8c31cca7a7a1a1390f7e4b5133cb6aa9a)

## There are no files selected for viewing

5 changes: 5 additions & 0 deletions

5
[doc/Changelog](#diff-4244fa301bd80b0a8f553ce0751fb0fcde1a45ee9dee71db85135cffde8ac712 "doc/Changelog")

Show comments

[View file](/NLnetLabs/unbound/blob/c3206f4568f60c486be6d165b1f2b5b254fea3de/doc/Changelog)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,3 +1,8 @@ |
|  |  | 1 May 2024: Wouter |
|  |  | - Fix for the DNSBomb vulnerability CVE-2024-33655. Thanks to Xiang Li |
|  |  | from the Network and Information Security Lab of Tsinghua University |
|  |  | for reporting it. |
|  |  |  |
|  |  | 29 April 2024: Yorgos |
|  |  | - Cleanup unnecessary strdup calls for EDE strings. |
|  |  |  |
| Expand Down | |  |

15 changes: 15 additions & 0 deletions

15
[doc/example.conf.in](#diff-2e824197ecb0cafe24f8e1709182a66d5d7eef05fb6b6c30d5ae26731216acda "doc/example.conf.in")

Show comments

[View file](/NLnetLabs/unbound/blob/c3206f4568f60c486be6d165b1f2b5b254fea3de/doc/example.conf.in)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -191,6 +191,21 @@ server: |
|  |  | # are behind a slow satellite link, to eg. 1128. |
|  |  | # unknown-server-time-limit: 376 |
|  |  |  |
|  |  | # msec before recursion replies are dropped. The work item continues. |
|  |  | # discard-timeout: 1900 |
|  |  |  |
|  |  | # Max number of replies waiting for recursion per IP address. |
|  |  | # wait-limit: 1000 |
|  |  |  |
|  |  | # Max replies waiting for recursion for IP address with cookie. |
|  |  | # wait-limit-cookie: 10000 |
|  |  |  |
|  |  | # Apart from the default, the wait limit can be set for a netblock. |
|  |  | # wait-limit-netblock: 192.0.2.0/24 50000 |
|  |  |  |
|  |  | # Apart from the default, the wait limit with cookie can be adjusted. |
|  |  | # wait-limit-cookie-netblock: 192.0.2.0/24 50000 |
|  |  |  |
|  |  | # the amount of memory to use for the RRset cache. |
|  |  | # plain value in bytes or you can append k, m or G. default is "4Mb". |
|  |  | # rrset-cache-size: 4m |
| Expand Down | |  |

30 changes: 30 additions & 0 deletions

30
[doc/unbound.conf.5.in](#diff-cc411cb8e62411fdf002d2c96043cd76e762116c4245cee26afed7243911a74c "doc/unbound.conf.5.in")

Show comments

[View file](/NLnetLabs/unbound/blob/c3206f4568f60c486be6d165b1f2b5b254fea3de/doc/unbound.conf.5.in)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -302,6 +302,36 @@ Increase this if you are behind a slow satellite link, to eg. 1128. |
|  |  | That would then avoid re\-querying every initial query because it times out. |
|  |  | Default is 376 msec. |
|  |  | .TP |
|  |  | .B discard\-timeout: \fI<msec> |
|  |  | The wait time in msec where recursion requests are dropped. This is |
|  |  | to stop a large number of replies from accumulating. They receive |
|  |  | no reply, the work item continues to recurse. It is nice to be a bit |
|  |  | larger than serve\-expired\-client\-timeout if that is enabled. |
|  |  | A value of 1900 msec is suggested. The value 0 disables it. |
|  |  | Default 1900 msec. |
|  |  | .TP |
|  |  | .B wait\-limit: \fI<number> |
|  |  | The number of replies that can wait for recursion, for an IP address. |
|  |  | This makes a ratelimit per IP address of waiting replies for recursion. |
|  |  | It stops very large amounts of queries waiting to be returned to one |
|  |  | destination. The value 0 disables wait limits. Default is 1000. |
|  |  | .TP |
|  |  | .B wait\-limit\-cookie: \fI<number> |
|  |  | The number of replies that can wait for recursion, for an IP address |
|  |  | that sent the query with a valid DNS cookie. Since the cookie validates |
|  |  | the client address, the limit can be higher. Default is 10000. |
|  |  | .TP |
|  |  | .B wait\-limit\-netblock: \fI<netblock> <number> |
|  |  | The wait limit for the netblock. If not given the wait\-limit value is |
|  |  | used. The most specific netblock is used to determine the limit. Useful for |
|  |  | overriding the default for a specific, group or individual, server. |
|  |  | The value -1 disables wait limits for the netblock. |
|  |  | .TP |
|  |  | .B wait\-limit\-cookie\-netblock: \fI<netblock> <number> |
|  |  | The wait limit for the netblock, when the query has a DNS cookie. |
|  |  | If not given, the wait\-limit\-cookie value is used. |
|  |  | The value -1 disables wait limits for the netblock. |
|  |  | .TP |
|  |  | .B so\-rcvbuf: \fI<number> |
|  |  | If not 0, then set the SO\_RCVBUF socket option to get more buffer |
|  |  | space on UDP port 53 incoming queries. So that short spikes on busy |
| Expand Down | |  |

170 changes: 168 additions & 2 deletions

170
[services/cache/infra.c](#diff-d26592e90ec2c46ba79ab9a423c810e21859b0634d58ddd346bde51900bd005a "services/cache/infra.c")

Show comments

[View file](/NLnetLabs/unbound/blob/c3206f4568f60c486be6d165b1f2b5b254fea3de/services/cache/infra.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -234,6 +234,81 @@ setup\_domain\_limits(struct infra\_cache\* infra, struct config\_file\* cfg) |
|  |  | return 1; |
|  |  | } |
|  |  |  |
|  |  | /\*\* find or create element in wait limit netblock tree \*/ |
|  |  | static struct wait\_limit\_netblock\_info\* |
|  |  | wait\_limit\_netblock\_findcreate(struct infra\_cache\* infra, char\* str, |
|  |  | int cookie) |
|  |  | { |
|  |  | rbtree\_type\* tree; |
|  |  | struct sockaddr\_storage addr; |
|  |  | int net; |
|  |  | socklen\_t addrlen; |
|  |  | struct wait\_limit\_netblock\_info\* d; |
|  |  |  |
|  |  | if(!netblockstrtoaddr(str, 0, &addr, &addrlen, &net)) { |
|  |  | log\_err("cannot parse wait limit netblock '%s'", str); |
|  |  | return 0; |
|  |  | } |
|  |  |  |
|  |  | /\* can we find it? \*/ |
|  |  | if(cookie) |
|  |  | tree = &infra->wait\_limits\_cookie\_netblock; |
|  |  | else |
|  |  | tree = &infra->wait\_limits\_netblock; |
|  |  | d = (struct wait\_limit\_netblock\_info\*)addr\_tree\_find(tree, &addr, |
|  |  | addrlen, net); |
|  |  | if(d) |
|  |  | return d; |
|  |  |  |
|  |  | /\* create it \*/ |
|  |  | d = (struct wait\_limit\_netblock\_info\*)calloc(1, sizeof(\*d)); |
|  |  | if(!d) |
|  |  | return NULL; |
|  |  | d->limit = -1; |
|  |  | if(!addr\_tree\_insert(tree, &d->node, &addr, addrlen, net)) { |
|  |  | log\_err("duplicate element in domainlimit tree"); |
|  |  | free(d); |
|  |  | return NULL; |
|  |  | } |
|  |  | return d; |
|  |  | } |
|  |  |  |
|  |  |  |
|  |  | /\*\* insert wait limit information into lookup tree \*/ |
|  |  | static int |
|  |  | infra\_wait\_limit\_netblock\_insert(struct infra\_cache\* infra, |
|  |  | struct config\_file\* cfg) |
|  |  | { |
|  |  | struct config\_str2list\* p; |
|  |  | struct wait\_limit\_netblock\_info\* d; |
|  |  | for(p = cfg->wait\_limit\_netblock; p; p = p->next) { |
|  |  | d = wait\_limit\_netblock\_findcreate(infra, p->str, 0); |
|  |  | if(!d) |
|  |  | return 0; |
|  |  | d->limit = atoi(p->str2); |
|  |  | } |
|  |  | for(p = cfg->wait\_limit\_cookie\_netblock; p; p = p->next) { |
|  |  | d = wait\_limit\_netblock\_findcreate(infra, p->str, 1); |
|  |  | if(!d) |
|  |  | return 0; |
|  |  | d->limit = atoi(p->str2); |
|  |  | } |
|  |  | return 1; |
|  |  | } |
|  |  |  |
|  |  | /\*\* setup wait limits tree (0 on failure) \*/ |
|  |  | static int |
|  |  | setup\_wait\_limits(struct infra\_cache\* infra, struct config\_file\* cfg) |
|  |  | { |
|  |  | addr\_tree\_init(&infra->wait\_limits\_netblock); |
|  |  | addr\_tree\_init(&infra->wait\_limits\_cookie\_netblock); |
|  |  | if(!infra\_wait\_limit\_netblock\_insert(infra, cfg)) |
|  |  | return 0; |
|  |  | addr\_tree\_init\_parents(&infra->wait\_limits\_netblock); |
|  |  | addr\_tree\_init\_parents(&infra->wait\_limits\_cookie\_netblock); |
|  |  | return 1; |
|  |  | } |
|  |  |  |
|  |  | struct infra\_cache\* |
|  |  | infra\_create(struct config\_file\* cfg) |
|  |  | { |
| Expand Down  Expand Up | | @@ -267,6 +342,10 @@ infra\_create(struct config\_file\* cfg) |
|  |  | infra\_delete(infra); |
|  |  | return NULL; |
|  |  | } |
|  |  | if(!setup\_wait\_limits(infra, cfg)) { |
|  |  | infra\_delete(infra); |
|  |  | return NULL; |
|  |  | } |
|  |  | infra\_ip\_ratelimit = cfg->ip\_ratelimit; |
|  |  | infra->client\_ip\_rates = slabhash\_create(cfg->ip\_ratelimit\_slabs, |
|  |  | INFRA\_HOST\_STARTSIZE, cfg->ip\_ratelimit\_size, &ip\_rate\_sizefunc, |
| Expand All | | @@ -287,6 +366,12 @@ static void domain\_limit\_free(rbnode\_type\* n, void\* ATTR\_UNUSED(arg)) |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | /\*\* delete wait\_limit\_netblock\_info entries \*/ |
|  |  | static void wait\_limit\_netblock\_del(rbnode\_type\* n, void\* ATTR\_UNUSED(arg)) |
|  |  | { |
|  |  | free(n); |
|  |  | } |
|  |  |  |
|  |  | void |
|  |  | infra\_delete(struct infra\_cache\* infra) |
|  |  | { |
| Expand All | | @@ -296,6 +381,10 @@ infra\_delete(struct infra\_cache\* infra) |
|  |  | slabhash\_delete(infra->domain\_rates); |
|  |  | traverse\_postorder(&infra->domain\_limits, domain\_limit\_free, NULL); |
|  |  | slabhash\_delete(infra->client\_ip\_rates); |
|  |  | traverse\_postorder(&infra->wait\_limits\_netblock, |
|  |  | wait\_limit\_netblock\_del, NULL); |
|  |  | traverse\_postorder(&infra->wait\_limits\_cookie\_netblock, |
|  |  | wait\_limit\_netblock\_del, NULL); |
|  |  | free(infra); |
|  |  | } |
|  |  |  |
| Expand Down  Expand Up | | @@ -880,7 +969,8 @@ static void infra\_create\_ratedata(struct infra\_cache\* infra, |
|  |  |  |
|  |  | /\*\* create rate data item for ip address \*/ |
|  |  | static void infra\_ip\_create\_ratedata(struct infra\_cache\* infra, |
|  |  | struct sockaddr\_storage\* addr, socklen\_t addrlen, time\_t timenow) |
|  |  | struct sockaddr\_storage\* addr, socklen\_t addrlen, time\_t timenow, |
|  |  | int mesh\_wait) |
|  |  | { |
|  |  | hashvalue\_type h = hash\_addr(addr, addrlen, 0); |
|  |  | struct ip\_rate\_key\* k = (struct ip\_rate\_key\*)calloc(1, sizeof(\*k)); |
| Expand All | | @@ -898,6 +988,7 @@ static void infra\_ip\_create\_ratedata(struct infra\_cache\* infra, |
|  |  | k->entry.data = d; |
|  |  | d->qps[0] = 1; |
|  |  | d->timestamp[0] = timenow; |
|  |  | d->mesh\_wait = mesh\_wait; |
|  |  | slabhash\_insert(infra->client\_ip\_rates, h, &k->entry, d, NULL); |
|  |  | } |
|  |  |  |
| Expand Down  Expand Up | | @@ -1121,6 +1212,81 @@ int infra\_ip\_ratelimit\_inc(struct infra\_cache\* infra, |
|  |  | } |
|  |  |  |
|  |  | /\* create \*/ |
|  |  | infra\_ip\_create\_ratedata(infra, addr, addrlen, timenow); |
|  |  | infra\_ip\_create\_ratedata(infra, addr, addrlen, timenow, 0); |
|  |  | return 1; |
|  |  | } |
|  |  |  |
|  |  | int infra\_wait\_limit\_allowed(struct infra\_cache\* infra, struct comm\_reply\* rep, |
|  |  | int cookie\_valid, struct config\_file\* cfg) |
|  |  | { |
|  |  | struct lruhash\_entry\* entry; |
|  |  | if(cfg->wait\_limit == 0) |
|  |  | return 1; |
|  |  |  |
|  |  | entry = infra\_find\_ip\_ratedata(infra, &rep->client\_addr, |
|  |  | rep->client\_addrlen, 0); |
|  |  | if(entry) { |
|  |  | rbtree\_type\* tree; |
|  |  | struct wait\_limit\_netblock\_info\* w; |
|  |  | struct rate\_data\* d = (struct rate\_data\*)entry->data; |
|  |  | int mesh\_wait = d->mesh\_wait; |
|  |  | lock\_rw\_unlock(&entry->lock); |
|  |  |  |
|  |  | /\* have the wait amount, check how much is allowed \*/ |
|  |  | if(cookie\_valid) |
|  |  | tree = &infra->wait\_limits\_cookie\_netblock; |
|  |  | else tree = &infra->wait\_limits\_netblock; |
|  |  | w = (struct wait\_limit\_netblock\_info\*)addr\_tree\_lookup(tree, |
|  |  | &rep->client\_addr, rep->client\_addrlen); |
|  |  | if(w) { |
|  |  | if(w->limit != -1 && mesh\_wait > w->limit) |
|  |  | return 0; |
|  |  | } else { |
|  |  | /\* if there is no IP netblock specific information, |
|  |  | \* use the configured value. \*/ |
|  |  | if(mesh\_wait > (cookie\_valid?cfg->wait\_limit\_cookie: |
|  |  | cfg->wait\_limit)) |
|  |  | return 0; |
|  |  | } |
|  |  | } |
|  |  | return 1; |
|  |  | } |
|  |  |  |
|  |  | void infra\_wait\_limit\_inc(struct infra\_cache\* infra, struct comm\_reply\* rep, |
|  |  | time\_t timenow, struct config\_file\* cfg) |
|  |  | { |
|  |  | struct lruhash\_entry\* entry; |
|  |  | if(cfg->wait\_limit == 0) |
|  |  | return; |
|  |  |  |
|  |  | /\* Find it \*/ |
|  |  | entry = infra\_find\_ip\_ratedata(infra, &rep->client\_addr, |
|  |  | rep->client\_addrlen, 1); |
|  |  | if(entry) { |
|  |  | struct rate\_data\* d = (struct rate\_data\*)entry->data; |
|  |  | d->mesh\_wait++; |
|  |  | lock\_rw\_unlock(&entry->lock); |
|  |  | return; |
|  |  | } |
|  |  |  |
|  |  | /\* Create it \*/ |
|  |  | infra\_ip\_create\_ratedata(infra, &rep->client\_addr, |
|  |  | rep->client\_addrlen, timenow, 1); |
|  |  | } |
|  |  |  |
|  |  | void infra\_wait\_limit\_dec(struct infra\_cache\* infra, struct comm\_reply\* rep, |
|  |  | struct config\_file\* cfg) |
|  |  | { |
|  |  | struct lruhash\_entry\* entry; |
|  |  | if(cfg->wait\_limit == 0) |
|  |  | return; |
|  |  |  |
|  |  | entry = infra\_find\_ip\_ratedata(infra, &rep->client\_addr, |
|  |  | rep->client\_addrlen, 1); |
|  |  | if(entry) { |
|  |  | struct rate\_data\* d = (struct rate\_data\*)entry->data; |
|  |  | if(d->mesh\_wait > 0) |
|  |  | d->mesh\_wait--; |
|  |  | lock\_rw\_unlock(&entry->lock); |
|  |  | } |
|  |  | } |

28 changes: 28 additions & 0 deletions

28
[services/cache/infra.h](#diff-11e5ceded6984a5c46e6a3ea05c2e0648ae822eba95af713aae31c4e0f7b8f02 "services/cache/infra.h")

Show comments

[View file](/NLnetLabs/unbound/blob/c3206f4568f60c486be6d165b1f2b5b254fea3de/services/cache/infra.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -122,6 +122,10 @@ struct infra\_cache { |
|  |  | rbtree\_type domain\_limits; |
|  |  | /\*\* hash table with query rates per client ip: ip\_rate\_key, ip\_rate\_data \*/ |
|  |  | struct slabhash\* client\_ip\_rates; |
|  |  | /\*\* tree of addr\_tree\_node, with wait\_limit\_netblock\_info information \*/ |
|  |  | rbtree\_type wait\_limits\_netblock; |
|  |  | /\*\* tree of addr\_tree\_node, with wait\_limit\_netblock\_info information \*/ |
|  |  | rbtree\_type wait\_limits\_cookie\_netblock; |
|  |  | }; |
|  |  |  |
|  |  | /\*\* ratelimit, unless overridden by domain\_limits, 0 is off \*/ |
| Expand Down  Expand Up | | @@ -184,10 +188,22 @@ struct rate\_data { |
|  |  | /\*\* what the timestamp is of the qps array members, counter is |
|  |  | \* valid for that timestamp. Usually now and now-1. \*/ |
|  |  | time\_t timestamp[RATE\_WINDOW]; |
|  |  | /\*\* the number of queries waiting in the mesh \*/ |
|  |  | int mesh\_wait; |
|  |  | }; |
|  |  |  |
|  |  | #define ip\_rate\_data rate\_data |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Data to store the configuration per netblock for the wait limit |
|  |  | \*/ |
|  |  | struct wait\_limit\_netblock\_info { |
|  |  | /\*\* The addr tree node, this must be first. \*/ |
|  |  | struct addr\_tree\_node node; |
|  |  | /\*\* the limit on the amount \*/ |
|  |  | int limit; |
|  |  | }; |
|  |  |  |
|  |  | /\*\* infra host cache default hash lookup size \*/ |
|  |  | #define INFRA\_HOST\_STARTSIZE 32 |
|  |  | /\*\* bytes per zonename reserved in the hostcache, dnamelen(zonename.com.) \*/ |
| Expand Down  Expand Up | | @@ -474,4 +490,16 @@ void ip\_rate\_delkeyfunc(void\* d, void\* arg); |
|  |  | /\* delete data \*/ |
|  |  | #define ip\_rate\_deldatafunc rate\_deldatafunc |
|  |  |  |
|  |  | /\*\* See if the IP address can have another reply in the wait limit \*/ |
|  |  | int infra\_wait\_limit\_allowed(struct infra\_cache\* infra, struct comm\_reply\* rep, |
|  |  | int cookie\_valid, struct config\_file\* cfg); |
|  |  |  |
|  |  | /\*\* Increment number of waiting replies for IP \*/ |
|  |  | void infra\_wait\_limit\_inc(struct infra\_cache\* infra, struct comm\_reply\* rep, |
|  |  | time\_t timenow, struct config\_file\* cfg); |
|  |  |  |
|  |  | /\*\* Decrement number of waiting replies for IP \*/ |
|  |  | void infra\_wait\_limit\_dec(struct infra\_cache\* infra, struct comm\_reply\* rep, |
|  |  | struct config\_file\* cfg); |
|  |  |  |
|  |  | #endif /\* SERVICES\_CACHE\_INFRA\_H \*/ |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `c3206f4`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNLnetLabs%2Funbound%2Fcommit%2Fc3206f4568f60c486be6d165b1f2b5b254fea3de) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


