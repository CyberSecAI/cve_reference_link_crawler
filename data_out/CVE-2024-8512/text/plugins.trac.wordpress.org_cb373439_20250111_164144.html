

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3175640)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Changeset](/changeset/3175639 "Changeset 3175639")
* [Next Changeset](/changeset/3175641 "Changeset 3175641") →

---

# Changeset 3175640

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
10/25/2024 12:22:27 PM
([3 months](/timeline?from=2024-10-25T12%3A22%3A27Z&precision=second "See timeline at 10/25/2024 12:22:27 PM") ago)

Author:
w3speedster
Message:

Security issue Fixed

Location:
[w3speedster-wp](/browser/w3speedster-wp?rev=3175640)
Files:

88 added
5 edited

* [tags/7.27](/browser/w3speedster-wp/tags/7.27?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/README.md](/browser/w3speedster-wp/tags/7.27/README.md?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/admin](/browser/w3speedster-wp/tags/7.27/admin?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/admin/admin-init.php](/browser/w3speedster-wp/tags/7.27/admin/admin-init.php?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/admin/admin.php](/browser/w3speedster-wp/tags/7.27/admin/admin.php?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/admin/includes](/browser/w3speedster-wp/tags/7.27/admin/includes?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/admin/includes/cache.php](/browser/w3speedster-wp/tags/7.27/admin/includes/cache.php?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/admin/includes/cdn.php](/browser/w3speedster-wp/tags/7.27/admin/includes/cdn.php?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/admin/includes/code-editor.php](/browser/w3speedster-wp/tags/7.27/admin/includes/code-editor.php?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/admin/includes/css.php](/browser/w3speedster-wp/tags/7.27/admin/includes/css.php?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/admin/includes/exclusions.php](/browser/w3speedster-wp/tags/7.27/admin/includes/exclusions.php?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/admin/includes/general.php](/browser/w3speedster-wp/tags/7.27/admin/includes/general.php?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/admin/includes/hooks.php](/browser/w3speedster-wp/tags/7.27/admin/includes/hooks.php?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/admin/includes/html-cache.php](/browser/w3speedster-wp/tags/7.27/admin/includes/html-cache.php?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/admin/includes/import-export.php](/browser/w3speedster-wp/tags/7.27/admin/includes/import-export.php?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/admin/includes/js.php](/browser/w3speedster-wp/tags/7.27/admin/includes/js.php?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/admin/includes/opt-img.php](/browser/w3speedster-wp/tags/7.27/admin/includes/opt-img.php?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/admin/includes/tabs.php](/browser/w3speedster-wp/tags/7.27/admin/includes/tabs.php?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/admin/includes/w3-custom-code.php](/browser/w3speedster-wp/tags/7.27/admin/includes/w3-custom-code.php?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/admin/includes/webvital-logs.php](/browser/w3speedster-wp/tags/7.27/admin/includes/webvital-logs.php?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets](/browser/w3speedster-wp/tags/7.27/assets?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/css](/browser/w3speedster-wp/tags/7.27/assets/css?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/css/admin-style.css](/browser/w3speedster-wp/tags/7.27/assets/css/admin-style.css?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/css/admin.css](/browser/w3speedster-wp/tags/7.27/assets/css/admin.css?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/css/bootstrap.min.css](/browser/w3speedster-wp/tags/7.27/assets/css/bootstrap.min.css?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/css/font-awesome.min.css](/browser/w3speedster-wp/tags/7.27/assets/css/font-awesome.min.css?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/css/jquery-ui.css](/browser/w3speedster-wp/tags/7.27/assets/css/jquery-ui.css?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/css/jquery.dataTables.min.css](/browser/w3speedster-wp/tags/7.27/assets/css/jquery.dataTables.min.css?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/css/select2.min.css](/browser/w3speedster-wp/tags/7.27/assets/css/select2.min.css?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/fonts](/browser/w3speedster-wp/tags/7.27/assets/fonts?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/fonts/fontawesome-webfont.woff2](/browser/w3speedster-wp/tags/7.27/assets/fonts/fontawesome-webfont.woff2?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/fonts/glyphicons-halflings-regular.woff2](/browser/w3speedster-wp/tags/7.27/assets/fonts/glyphicons-halflings-regular.woff2?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/images](/browser/w3speedster-wp/tags/7.27/assets/images?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/images/bg-speedup.jpg](/browser/w3speedster-wp/tags/7.27/assets/images/bg-speedup.jpg?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/images/blank-3x4.png](/browser/w3speedster-wp/tags/7.27/assets/images/blank-3x4.png?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/images/blank-4x3.png](/browser/w3speedster-wp/tags/7.27/assets/images/blank-4x3.png?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/images/blank-h.png](/browser/w3speedster-wp/tags/7.27/assets/images/blank-h.png?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/images/blank-p.png](/browser/w3speedster-wp/tags/7.27/assets/images/blank-p.png?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/images/blank-square.png](/browser/w3speedster-wp/tags/7.27/assets/images/blank-square.png?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/images/blank.mp3](/browser/w3speedster-wp/tags/7.27/assets/images/blank.mp3?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/images/blank.mp4](/browser/w3speedster-wp/tags/7.27/assets/images/blank.mp4?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/images/blank.png](/browser/w3speedster-wp/tags/7.27/assets/images/blank.png?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/images/blank.pngw3.webp](/browser/w3speedster-wp/tags/7.27/assets/images/blank.pngw3.webp?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/images/cache-icon.png](/browser/w3speedster-wp/tags/7.27/assets/images/cache-icon.png?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/images/caches-icon.webp](/browser/w3speedster-wp/tags/7.27/assets/images/caches-icon.webp?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/images/css-h.png](/browser/w3speedster-wp/tags/7.27/assets/images/css-h.png?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/images/css-icon.webp](/browser/w3speedster-wp/tags/7.27/assets/images/css-icon.webp?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/images/custom-code-icon1.webp](/browser/w3speedster-wp/tags/7.27/assets/images/custom-code-icon1.webp?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/images/datepicker](/browser/w3speedster-wp/tags/7.27/assets/images/datepicker?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/images/datepicker/ui-bg\_glass\_100\_fdf5ce\_1x400.png](/browser/w3speedster-wp/tags/7.27/assets/images/datepicker/ui-bg_glass_100_fdf5ce_1x400.png?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/images/datepicker/ui-bg\_gloss-wave\_35\_f6a828\_500x100.png](/browser/w3speedster-wp/tags/7.27/assets/images/datepicker/ui-bg_gloss-wave_35_f6a828_500x100.png?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/images/datepicker/ui-icons\_ffffff\_256x240.png](/browser/w3speedster-wp/tags/7.27/assets/images/datepicker/ui-icons_ffffff_256x240.png?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/images/exclusions-icon1.webp](/browser/w3speedster-wp/tags/7.27/assets/images/exclusions-icon1.webp?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/images/general-setting-icn.png](/browser/w3speedster-wp/tags/7.27/assets/images/general-setting-icn.png?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/images/general-setting-icon.webp](/browser/w3speedster-wp/tags/7.27/assets/images/general-setting-icon.webp?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/images/html\_caches-icon1.webp](/browser/w3speedster-wp/tags/7.27/assets/images/html_caches-icon1.webp?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/images/image-icon.webp](/browser/w3speedster-wp/tags/7.27/assets/images/image-icon.webp?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/images/img-optimzation-icn.png](/browser/w3speedster-wp/tags/7.27/assets/images/img-optimzation-icn.png?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/images/import-export-icon.png](/browser/w3speedster-wp/tags/7.27/assets/images/import-export-icon.png?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/images/import-export-icon.webp](/browser/w3speedster-wp/tags/7.27/assets/images/import-export-icon.webp?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/images/js-flat-js-dashboard.png](/browser/w3speedster-wp/tags/7.27/assets/images/js-flat-js-dashboard.png?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/images/js-icon.webp](/browser/w3speedster-wp/tags/7.27/assets/images/js-icon.webp?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/images/loader-gif.gif](/browser/w3speedster-wp/tags/7.27/assets/images/loader-gif.gif?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/images/logs-icon.webp](/browser/w3speedster-wp/tags/7.27/assets/images/logs-icon.webp?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/images/php-hook.webp](/browser/w3speedster-wp/tags/7.27/assets/images/php-hook.webp?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/images/w3-logo.png](/browser/w3speedster-wp/tags/7.27/assets/images/w3-logo.png?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/images/w3speedster-icon.webp](/browser/w3speedster-wp/tags/7.27/assets/images/w3speedster-icon.webp?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/js](/browser/w3speedster-wp/tags/7.27/assets/js?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/js/bootstrap.min.js](/browser/w3speedster-wp/tags/7.27/assets/js/bootstrap.min.js?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/js/img-lazyload.js](/browser/w3speedster-wp/tags/7.27/assets/js/img-lazyload.js?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/js/jquery-ui.js](/browser/w3speedster-wp/tags/7.27/assets/js/jquery-ui.js?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/js/jquery.dataTables.min.js](/browser/w3speedster-wp/tags/7.27/assets/js/jquery.dataTables.min.js?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/js/prefixfree.min.js](/browser/w3speedster-wp/tags/7.27/assets/js/prefixfree.min.js?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/js/script-load.min.js](/browser/w3speedster-wp/tags/7.27/assets/js/script-load.min.js?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/js/select2.min.js](/browser/w3speedster-wp/tags/7.27/assets/js/select2.min.js?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/js/w3-admin-core.js](/browser/w3speedster-wp/tags/7.27/assets/js/w3-admin-core.js?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/assets/js/web-vitals.iife.js](/browser/w3speedster-wp/tags/7.27/assets/js/web-vitals.iife.js?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/check.php](/browser/w3speedster-wp/tags/7.27/check.php?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/includes](/browser/w3speedster-wp/tags/7.27/includes?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/includes/core.php](/browser/w3speedster-wp/tags/7.27/includes/core.php?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/includes/css-optimize.php](/browser/w3speedster-wp/tags/7.27/includes/css-optimize.php?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/includes/css-response.php](/browser/w3speedster-wp/tags/7.27/includes/css-response.php?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/includes/html-optimize.php](/browser/w3speedster-wp/tags/7.27/includes/html-optimize.php?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/includes/image-optimize.php](/browser/w3speedster-wp/tags/7.27/includes/image-optimize.php?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/includes/init.php](/browser/w3speedster-wp/tags/7.27/includes/init.php?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/includes/js-optimize.php](/browser/w3speedster-wp/tags/7.27/includes/js-optimize.php?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/includes/jsmin.php](/browser/w3speedster-wp/tags/7.27/includes/jsmin.php?rev=3175640 "Show entry in browser")
  (added)
* [tags/7.27/w3speedster.php](/browser/w3speedster-wp/tags/7.27/w3speedster.php?rev=3175640 "Show entry in browser")
  (added)
* [trunk/README.md](/browser/w3speedster-wp/trunk/README.md?rev=3175640 "Show entry in browser")
  (modified)
  ([1 diff](#file88 "Show differences"))
* [trunk/admin/includes/tabs.php](/browser/w3speedster-wp/trunk/admin/includes/tabs.php?rev=3175640 "Show entry in browser")
  (modified)
  ([1 diff](#file89 "Show differences"))
* [trunk/includes/init.php](/browser/w3speedster-wp/trunk/includes/init.php?rev=3175640 "Show entry in browser")
  (modified)
  ([1 diff](#file90 "Show differences"))
* [trunk/includes/js-optimize.php](/browser/w3speedster-wp/trunk/includes/js-optimize.php?rev=3175640 "Show entry in browser")
  (modified)
  ([1 diff](#file91 "Show differences"))
* [trunk/w3speedster.php](/browser/w3speedster-wp/trunk/w3speedster.php?rev=3175640 "Show entry in browser")
  (modified)
  ([4 diffs](#file92 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [w3speedster-wp/trunk/README.md](/changeset/3175640/w3speedster-wp/trunk/README.md "Show the changeset 3175640 restricted to w3speedster-wp/trunk/README.md")

  | [r3175011](/browser/w3speedster-wp/trunk/README.md?rev=3175011#L1 "Show revision 3175011 of this file in browser") | [r3175640](/browser/w3speedster-wp/trunk/README.md?rev=3175640#L1 "Show revision 3175640 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | === W3SPEEDSTER === |
  | 2 | 2 | Contributors: W3speedster |
  | 3 |  | Stable tag: 7.2~~6~~ |
  |  | 3 | Stable tag: 7.27 |
  | 4 | 4 | Tags: website speed, page speed, lazy loading, css minification, js minification |
  | 5 |  | Version: 7.2~~6~~ |
  |  | 5 | Version: 7.27 |
  | 6 | 6 | Tested up to: 6.6.2 |
  | 7 | 7 | License: GPLv2 or later |
* ## [w3speedster-wp/trunk/admin/includes/tabs.php](/changeset/3175640/w3speedster-wp/trunk/admin/includes/tabs.php "Show the changeset 3175640 restricted to w3speedster-wp/trunk/admin/includes/tabs.php")

  | [r3175011](/browser/w3speedster-wp/trunk/admin/includes/tabs.php?rev=3175011#L39 "Show revision 3175011 of this file in browser") | [r3175640](/browser/w3speedster-wp/trunk/admin/includes/tabs.php?rev=3175640#L39 "Show revision 3175640 of this file in browser") |  |
  | --- | --- | --- |
  | 39 | 39 | <?php $admin->translate('Clear Cache'); ?> |
  | 40 | 40 | </a></li> |
  | 41 |  | ~~<li class="w3\_hooks<?php echo $tab == 'hooks' ? ' active' : ''; ?>"><a data-toggle="tab"~~ |
  | 42 |  | ~~data-section="hooks" href="javascript:void(0)">~~ |
  | 43 |  | ~~<?php $admin->translate('Hooks'); ?>~~ |
  | 44 |  | ~~</a></li>~~ |
  | 45 | 41 | <li class="w3\_webvitals\_log<?php echo $tab == 'webvitalslogs' ? ' active' : ''; ?>"><a data-toggle="tab" |
  | 46 | 42 | data-section="webvitalslogs" href="javascript:void(0)"> |
* ## [w3speedster-wp/trunk/includes/init.php](/changeset/3175640/w3speedster-wp/trunk/includes/init.php "Show the changeset 3175640 restricted to w3speedster-wp/trunk/includes/init.php")

  | [r3175120](/browser/w3speedster-wp/trunk/includes/init.php?rev=3175120#L602 "Show revision 3175120 of this file in browser") | [r3175640](/browser/w3speedster-wp/trunk/includes/init.php?rev=3175640#L602 "Show revision 3175640 of this file in browser") |  |
  | --- | --- | --- |
  | 602 | 602 | $code = stripcslashes($code); |
  | 603 | 603 | // @codingStandardsIgnoreLine |
  | 604 |  | ~~safe\_eval("$code");~~ |
  | 605 |  |  |
  | 606 |  |  |
  | 607 | 604 | return $args[0]; |
  | 608 | 605 | } |
* ## [w3speedster-wp/trunk/includes/js-optimize.php](/changeset/3175640/w3speedster-wp/trunk/includes/js-optimize.php "Show the changeset 3175640 restricted to w3speedster-wp/trunk/includes/js-optimize.php")

  | [r3175120](/browser/w3speedster-wp/trunk/includes/js-optimize.php?rev=3175120#L170 "Show revision 3175120 of this file in browser") | [r3175640](/browser/w3speedster-wp/trunk/includes/js-optimize.php?rev=3175640#L170 "Show revision 3175640 of this file in browser") |  |
  | --- | --- | --- |
  | 170 | 170 | $url\_array['path'] = $this->removeDotPathSegments($url\_array['path']); |
  | 171 | 171 | } |
  |  | 172 |  |
  | 172 | 173 | if(!$this->w3IsExternal($script\_obj['src']) && $this->w3Endswith($url\_array['path'], '.js') && $exclude\_js != 1 && $exclude\_js != 3){ |
  | 173 | 174 | $old\_path = $url\_array['path']; |
  | 174 |  | if(file\_exists($this->add\_settings['document\_root'].$url\_array['path'])){ |
  |  | 175 | if(file\_exists($this->add\_settings['document\_root'].$url\_array['path'])){ |
  | 175 | 176 | $url\_array['path'] = $this->w3CreateFileCacheJs($url\_array['path']); |
  | 176 |  | }else{ |
  | 177 |  | $url\_array['path'] = $script\_obj['src']; |
  | 178 |  | } |
  | 179 |  | $script\_obj['src'] = $this->add\_settings['site\_url'].$url\_array['path']; |
  | 180 |  | } |
  |  | 177 | $script\_obj['src'] = $this->add\_settings['site\_url'].$url\_array['path']; |
  |  | 178 | } |
  |  | 179 | } |
  | 181 | 180 | if($exclude\_js){ |
  | 182 | 181 | if( $exclude\_js == 3 || $exclude\_js == 1){ |
* ## [w3speedster-wp/trunk/w3speedster.php](/changeset/3175640/w3speedster-wp/trunk/w3speedster.php "Show the changeset 3175640 restricted to w3speedster-wp/trunk/w3speedster.php")

  | [r3175167](/browser/w3speedster-wp/trunk/w3speedster.php?rev=3175167#L7 "Show revision 3175167 of this file in browser") | [r3175640](/browser/w3speedster-wp/trunk/w3speedster.php?rev=3175640#L7 "Show revision 3175640 of this file in browser") |  |
  | --- | --- | --- |
  | 7 | 7 | Description: Speedup the site with good scores on google page speed test and Gtmetrix |
  | 8 | 8 |  |
  | 9 |  | Version: 7.2~~6~~ |
  |  | 9 | Version: 7.27 |
  | 10 | 10 |  |
  | 11 | 11 | Author: W3speedster |
  | […](/browser/w3speedster-wp/trunk/w3speedster.php?rev=3175167#L34) | […](/browser/w3speedster-wp/trunk/w3speedster.php?rev=3175640#L34) |  |
  | 34 | 34 | define("W3SPEEDSTER\_WP\_CONTENT\_BASENAME", basename(W3SPEEDSTER\_WP\_CONTENT\_DIR)); |
  | 35 | 35 | } |
  | 36 |  | define( 'W3SPEEDSTER\_PLUGIN\_VERSION', '7.2~~6~~' ); |
  |  | 36 | define( 'W3SPEEDSTER\_PLUGIN\_VERSION', '7.27' ); |
  | 37 | 37 | define( 'W3SPEEDSTER\_DIR', plugin\_dir\_path( \_\_FILE\_\_ ) ); |
  | 38 | 38 | define( 'W3SPEEDSTER\_PLUGIN\_FILE', \_\_FILE\_\_ ); |
  | […](/browser/w3speedster-wp/trunk/w3speedster.php?rev=3175167#L687) | […](/browser/w3speedster-wp/trunk/w3speedster.php?rev=3175640#L687) |  |
  | 687 | 687 | add\_action( 'wp\_ajax\_fn\_w3\_optimize\_media\_image', 'fnW3OptimizeMediaImageCallback'); |
  | 688 | 688 | add\_action( 'wp\_ajax\_w3speedsterActivateLicenseKey', 'w3speedsterActivateLicenseKey' ); |
  | 689 |  | ~~add\_action( 'wp\_ajax\_hookBeforeStartOptimization', 'hookBeforeStartOptimization' );~~ |
  | 690 | 689 | add\_action('admin\_enqueue\_scripts', 'w3SpeedsterAdminEnqueScript'); |
  | 691 | 690 | if(!empty($\_GET['page']) && $\_GET['page'] == 'w3\_speedster'){ |
  | […](/browser/w3speedster-wp/trunk/w3speedster.php?rev=3175167#L788) | […](/browser/w3speedster-wp/trunk/w3speedster.php?rev=3175640#L787) |  |
  | 788 | 787 | function w3speedsterPluginUpdateMessage(){ |
  | 789 | 788 | echo esc\_html(\_\_('License key will be required to update the plugin. To get a key, contact')) . ' <a rel="noopener noreferrer" href="https://w3speedster.com">' . esc\_html\_\_('here') . '</a>.'; |
  | 790 |  | ~~}~~ |
  | 791 |  |  |
  | 792 |  |  |
  | 793 |  | ~~function hookBeforeStartOptimization() {~~ |
  | 794 |  | ~~if ( isset($\_POST['\_wpnonce'] ) && wp\_verify\_nonce( $\_POST['\_wpnonce'],'hook\_callback') ) {~~ |
  | 795 |  | ~~$data = json\_decode(stripslashes($\_POST['script']));~~ |
  | 796 |  | ~~foreach ($data as $singleHook) {~~ |
  | 797 |  | ~~$num = 3;~~ |
  | 798 |  | ~~register\_shutdown\_function(function () use ($data,$num) {~~ |
  | 799 |  | ~~$error = error\_get\_last();~~ |
  | 800 |  |  |
  | 801 |  | ~~if ($error !== null && in\_array($error['type'], [E\_ERROR, E\_PARSE, E\_CORE\_ERROR, E\_COMPILE\_ERROR])) {~~ |
  | 802 |  | ~~// Handle the fatal error~~ |
  | 803 |  | ~~$responseData = array(~~ |
  | 804 |  | ~~'error' => "Fatal error occurred: {$error['message']}",~~ |
  | 805 |  | ~~'additional\_data' => $data[$num]->hookKey~~ |
  | 806 |  | ~~);~~ |
  | 807 |  | ~~echo wp\_json\_encode($responseData);~~ |
  | 808 |  | ~~exit;~~ |
  | 809 |  | ~~}~~ |
  | 810 |  |  |
  | 811 |  | ~~});~~ |
  | 812 |  | ~~$script = !empty($singleHook->value) ? preg\_replace('/[^\x20-\x7E]/', '', $singleHook->value) : '';~~ |
  | 813 |  | ~~try {~~ |
  | 814 |  | ~~$test = 1;~~ |
  | 815 |  | ~~$response = safe\_eval("$script");~~ |
  | 816 |  | ~~if(!empty($response['error'])){~~ |
  | 817 |  | ~~$parseErrorData = array($singleHook->hookKey, $response);~~ |
  | 818 |  | ~~echo wp\_json\_encode($parseErrorData);~~ |
  | 819 |  | ~~exit;~~ |
  | 820 |  | ~~}~~ |
  | 821 |  | ~~} catch (ParseError $p) {~~ |
  | 822 |  | ~~// Handle parse error~~ |
  | 823 |  | ~~$parseErrorData = array($singleHook->hookKey, ['error' => "Parse error occurred: {$p->getMessage()}"]);~~ |
  | 824 |  | ~~echo wp\_json\_encode($parseErrorData);~~ |
  | 825 |  | ~~exit;~~ |
  | 826 |  | ~~} catch (Exception $e) {~~ |
  | 827 |  | ~~// Handle other exceptions~~ |
  | 828 |  | ~~$exceptionError = array($singleHook->hookKey, ['error' => $e->getMessage()]);~~ |
  | 829 |  | ~~echo wp\_json\_encode($exceptionError);~~ |
  | 830 |  | ~~exit;~~ |
  | 831 |  | ~~}~~ |
  | 832 |  |  |
  | 833 |  | ~~}~~ |
  | 834 |  | ~~exit;~~ |
  | 835 |  | ~~}~~ |
  | 836 |  | ~~}~~ |
  | 837 |  | ~~function extractPhpFunctions($code) {~~ |
  | 838 |  | ~~$pattern = '/\b([a-zA-Z\_][a-zA-Z0-9\_]\*)\s\*\(/';~~ |
  | 839 |  | ~~preg\_match\_all($pattern, $code, $matches);~~ |
  | 840 |  | ~~return array\_unique($matches[1]);~~ |
  | 841 |  | ~~}~~ |
  | 842 |  | ~~function safe\_eval($expression) {~~ |
  | 843 |  | ~~$allowedFunctions = ['strpos', 'str\_replace','preg\_match','preg\_replace','preg\_match\_all','strlen','if','wp\_is\_mobile'];~~ |
  | 844 |  | ~~$tokens = extractPhpFunctions($expression);~~ |
  | 845 |  | ~~foreach ($tokens as $token) {~~ |
  | 846 |  | ~~if (!is\_numeric($token) && !in\_array($token, $allowedFunctions)) {~~ |
  | 847 |  | ~~throw new Exception("Use of function '$token' is not allowed.");~~ |
  | 848 |  | ~~$parseErrorData = array('error' => "Use of function '$token' is not allowed.");~~ |
  | 849 |  | ~~return $parseErrorData;~~ |
  | 850 |  | ~~}~~ |
  | 851 |  | ~~}~~ |
  | 852 |  | ~~// @codingStandardsIgnoreLine~~ |
  | 853 |  | ~~return eval($expression);~~ |
  | 854 | 789 | } |
  | 855 | 790 |  |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3175640)
* [Zip Archive](?format=zip&new=3175640)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

