=== Content from www.openwall.com_d49e3298_20250110_211138.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux ¬† *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper ¬† *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists ¬† *for password cracking*](/wordlists/)+ [passwdqc ¬† *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt ¬† *KDF & password hashing*](/yescrypt/)+ [yespower ¬† *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish ¬† *password hashing*](/crypt/)+ [phpass ¬† *ditto in PHP*](/phpass/)+ [tcb ¬† *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd ¬† *port scan detector*](/scanlogd/)+ [popa3d ¬† *tiny POP3 daemon*](/popa3d/)+ [blists ¬† *web interface to mailing lists*](/blists/)+ [msulogin ¬† *single user mode login*](/msulogin/)+ [php\_mt\_seed ¬† *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](../../../2024/03/04/2) [[next>]](../../../2024/03/06/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <CAM+3YVrDT7mYEVbxzpzwqm=dA-dtBr5Ob3b5ge4NGYfobXVCYg@mail.gmail.com>
Date: Tue, 5 Mar 2024 11:40:42 +0100
From: Marco Ivaldi <raptor@...eadbeef.info>
To: fulldisclosure@...lists.org, oss-security@...ts.openwall.com,
	submissions@...ketstormsecurity.com
Subject: HNS-2024-05 - HN Security Advisory - Multiple vulnerabilities in
 RT-Thread RTOS

Hi,

Please find attached a security advisory that describes multiple
vulnerabilities we discovered in RT-Thread RTOS.

* Title: Multiple vulnerabilities in RT-Thread RTOS
* OS: RT-Thread <= 5.0.2
* Author: Marco Ivaldi <marco.ivaldi@...ecurity.it>
* Date: 2024-03-05
* CVE IDs and advisory URLs:
  * CVE-2024-24334 - <https://github.com/RT-Thread/rt-thread/issues/8282>
  * CVE-2024-24335 - <https://github.com/RT-Thread/rt-thread/issues/8271>
  * CVE-2024-25388 - <https://github.com/RT-Thread/rt-thread/issues/8285>
  * CVE-2024-25389 - <https://github.com/RT-Thread/rt-thread/issues/8283>
  * CVE-2024-25390 - <https://github.com/RT-Thread/rt-thread/issues/8286>
  * CVE-2024-25391 - <https://github.com/RT-Thread/rt-thread/issues/8287>
  * CVE-2024-25392 - <https://github.com/RT-Thread/rt-thread/issues/8290>
  * CVE-2024-25393 - <https://github.com/RT-Thread/rt-thread/issues/8288>
  * CVE-2024-25394 - <https://github.com/RT-Thread/rt-thread/issues/8291>
  * CVE-2024-25395 - <https://github.com/RT-Thread/rt-thread/issues/8289>
  * <https://github.com/RT-Thread/rt-thread/issues/8292>
* Vendor URL: <https://www.rt-thread.io/>

The advisory is also available at:
<https://github.com/hnsecurity/vulns/blob/main/HNS-2024-05-rt-thread.txt>

For additional information, please refer to our vulnerability writeup:
<https://security.humanativaspa.it/multiple-vulnerabilities-in-rt-thread-rtos>

Regards,

--
Marco Ivaldi
<https://0xdeadbeef.info/>
"When cryptography is outlawed, bayl bhgynjf jvyy unir cevinpl."

View attachment "[HNS-2024-05-rt-thread.txt](1/1)" of type "text/plain" (36067 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from github.com_39b92762_20250110_211139.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FRT-Thread%2Frt-thread%2Fissues%2F8288)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FRT-Thread%2Frt-thread%2Fissues%2F8288)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=RT-Thread%2Frt-thread)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[RT-Thread](/RT-Thread)
/
**[rt-thread](/RT-Thread/rt-thread)**
Public

* [Notifications](/login?return_to=%2FRT-Thread%2Frt-thread) You must be signed in to change notification settings
* [Fork
  5.1k](/login?return_to=%2FRT-Thread%2Frt-thread)
* [Star
   10.7k](/login?return_to=%2FRT-Thread%2Frt-thread)

* [Code](/RT-Thread/rt-thread)
* [Issues
  300](/RT-Thread/rt-thread/issues)
* [Pull requests
  57](/RT-Thread/rt-thread/pulls)
* [Discussions](/RT-Thread/rt-thread/discussions)
* [Actions](/RT-Thread/rt-thread/actions)
* [Projects
  0](/RT-Thread/rt-thread/projects)
* [Wiki](/RT-Thread/rt-thread/wiki)
* [Security](/RT-Thread/rt-thread/security)
* [Insights](/RT-Thread/rt-thread/pulse)

Additional navigation options

* [Code](/RT-Thread/rt-thread)
* [Issues](/RT-Thread/rt-thread/issues)
* [Pull requests](/RT-Thread/rt-thread/pulls)
* [Discussions](/RT-Thread/rt-thread/discussions)
* [Actions](/RT-Thread/rt-thread/actions)
* [Projects](/RT-Thread/rt-thread/projects)
* [Wiki](/RT-Thread/rt-thread/wiki)
* [Security](/RT-Thread/rt-thread/security)
* [Insights](/RT-Thread/rt-thread/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FRT-Thread%2Frt-thread%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FRT-Thread%2Frt-thread%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Stack buffer overflow in RT-Thread AT server #8288

Closed

[0xdea](/0xdea) opened this issue
Nov 24, 2023
¬∑ 4 comments

Closed

# [Stack buffer overflow in RT-Thread AT server](#top) #8288

[0xdea](/0xdea) opened this issue
Nov 24, 2023
¬∑ 4 comments

## Comments

[![@0xdea](https://avatars.githubusercontent.com/u/30093440?s=80&u=4ae154c14edfe0e1c580870fd72bd965b6105762&v=4)](/0xdea)

Copy link

### **[0xdea](/0xdea)** commented [Nov 24, 2023](#issue-2009616487)

| Hi,  I would like to report another potential vulnerability in the current version of RT-Thread. Please let me know if you plan to ask for a CVE ID in case the vulnerability is confirmed. I'm available if you need further clarifications. Potential stack buffer overflow in RT-Thread AT serverSummary I spotted a potential stack buffer overflow vulnerability at the following location in the RT-Thread AT server source code: <https://github.com/RT-Thread/rt-thread/blob/master/components/net/at/src/at_server.c#L410> Details Lack of length check in the `at_cmd_get_name()` function could lead to a stack buffer overflow at the marked line:  ``` #ifdef AT_USING_SERVER ... static rt_err_t at_cmd_get_name(const char *cmd_buffer, char *cmd_name) {     rt_size_t cmd_name_len = 0, i = 0;      RT_ASSERT(cmd_name);     RT_ASSERT(cmd_buffer);      for (i = 0; i < strlen(cmd_buffer); i++)     {         if (*(cmd_buffer + i) == AT_CMD_QUESTION_MARK || *(cmd_buffer + i) == AT_CMD_EQUAL_MARK                 || *(cmd_buffer + i) == AT_CMD_CR                 || (*(cmd_buffer + i) >= AT_CMD_CHAR_0 && *(cmd_buffer + i) <= AT_CMD_CHAR_9))         {             cmd_name_len = i;             rt_memcpy(cmd_name, cmd_buffer, cmd_name_len); /* VULN: cmd_buffer is AT_SERVER_RECV_BUFF_LEN bytes (256), while cmd_name is only AT_CMD_NAME_LEN bytes (16); therefore, it might be possible to overflow past the cmd_name buffer with a carefully crafted cmd_buffer */             *(cmd_name + cmd_name_len) = '\0';              return RT_EOK;         }     }      return -RT_ERROR; } ``` Impact If the unchecked input above is confirmed to be attacker-controlled and crossing a security boundary, the impact of the reported buffer overflow vulnerability could range from denial of service to arbitrary code execution. |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@0xdea](https://avatars.githubusercontent.com/u/30093440?s=80&u=4ae154c14edfe0e1c580870fd72bd965b6105762&v=4)](/0xdea)

Copy link

Author

### **[0xdea](/0xdea)** commented [Dec 24, 2023](#issuecomment-1868469025)

| Hi, it's been one month since I reported this vulnerability, and I wanted to ask if you have any update. As standard practice, I plan to request a CVE ID for every confirmed vulnerability. I also intend to publish an advisory by February at the latest, unless there's a specific reason to postpone. Thanks! |
| --- |

All reactions

Sorry, something went wrong.

[yangpengya](/yangpengya)
added a commit
to yangpengya/rt-thread
that referenced
this issue
[Dec 24, 2023](#ref-commit-713cf9b)
[![@yangpengya](https://avatars.githubusercontent.com/u/53293497?s=40&u=e75090fb937c9feee0dd102c14213269ca69868f&v=4)](/yangpengya)

`[RT-Thread#8288](https://github.com/RT-Thread/rt-thread/issues/8288)`

`[713cf9b](/yangpengya/rt-thread/commit/713cf9b45f274ef5d202cc9fb9c5a5889aa0098a)`

[![@0xdea](https://avatars.githubusercontent.com/u/30093440?s=40&u=4ae154c14edfe0e1c580870fd72bd965b6105762&v=4)](/0xdea)
[0xdea](/0xdea)
changed the title
~~Potential stack buffer overflow in RT-Thread AT server~~
Stack buffer overflow in RT-Thread AT server
[Feb 2, 2024](#event-11684001673)

[![@0xdea](https://avatars.githubusercontent.com/u/30093440?s=80&u=4ae154c14edfe0e1c580870fd72bd965b6105762&v=4)](/0xdea)

Copy link

Author

### **[0xdea](/0xdea)** commented [Feb 8, 2024](#issuecomment-1933501301)

| Hi there, [CVE-2024-25393](https://github.com/advisories/GHSA-mq3q-f49j-4fjg "CVE-2024-25393") was assigned to this vulnerability. I'm planning to publish my security advisory and writeup on March 5th. Thanks. |
| --- |

All reactions

Sorry, something went wrong.

[![@mysterywolf](https://avatars.githubusercontent.com/u/34888354?s=80&u=d033f87c7e9d7278ab2a9e273abe9ca0dfd6403d&v=4)](/mysterywolf)

Copy link

Member

### **[mysterywolf](/mysterywolf)** commented [Feb 18, 2024](#issuecomment-1951454594)

| Hi so sorry for the late reply, I just review some issues. Yes you can, and thanks for the bug report! |
| --- |

 üëç
1
 0xdea reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@0xdea](https://avatars.githubusercontent.com/u/30093440?s=80&u=4ae154c14edfe0e1c580870fd72bd965b6105762&v=4)](/0xdea)

Copy link

Author

### **[0xdea](/0xdea)** commented [Feb 19, 2024](#issuecomment-1951883464)

| You're welcome, happy to help! Thank you for your feedback. |
| --- |

All reactions

Sorry, something went wrong.

[![@mysterywolf](https://avatars.githubusercontent.com/u/34888354?s=40&u=d033f87c7e9d7278ab2a9e273abe9ca0dfd6403d&v=4)](/mysterywolf)
[mysterywolf](/mysterywolf)
closed this as [completed](/RT-Thread/rt-thread/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Feb 19, 2024](#event-11852698773)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FRT-Thread%2Frt-thread%2Fissues%2F8288)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

2 participants

[![@0xdea](https://avatars.githubusercontent.com/u/30093440?s=52&v=4)](/0xdea) [![@mysterywolf](https://avatars.githubusercontent.com/u/34888354?s=52&v=4)](/mysterywolf)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from security.humanativaspa.it_0d3c2bd9_20250110_211141.html ===


[![Humanativa](https://security.humanativaspa.it/sec/wp-content/themes/master-am/images/hn-security-logo.png)](https://security.humanativaspa.it/)

* + [Home](https://security.humanativaspa.it/ "Home")
  + [About Us](https://security.humanativaspa.it/#aboutus "About Us")
  + [Services](https://security.humanativaspa.it/#services "Services")
  + [Blog](https://security.humanativaspa.it/category/news/ "Blog")

Contacts

### Contacts

If you're looking to fortify your security and take your defenses to the next level, contact us at info@hnsecurity.it to explore how HN Security can help safeguard your digital assets.

Posted on [5 March 2024](https://security.humanativaspa.it/multiple-vulnerabilities-in-rt-thread-rtos/) Marco Ivaldi
### Multiple vulnerabilities in RT-Thread RTOS

> *‚ÄúSecurity is in the mind of the programmer and in the mind of the designer.*
>
> *Not so much in the code.‚Äù*
>
> *‚Äî Alisa Esage*

### Summary

Welcome to another episode in [my journey](https://security.humanativaspa.it/ost2-zephyr-rtos-and-a-bunch-of-cves/) as a glorified static analysis tool for real-time operating systems!

This time, our target of choice is [RT-Thread](https://www.rt-thread.io/), an open-source, community-based **real-time operating system (RTOS)**. RT-Thread can be used in sensing nodes, wireless connection chips, and many other resource-constrained scenarios. It is also widely applied in gateways, IPC, smart speakers, and other high-performance **IoT applications**.

I reviewed RT-Thread‚Äôs [source code](https://github.com/RT-Thread/rt-thread) hosted on GitHub and identified multiple¬†**security vulnerabilities** that may cause memory corruption and security feature bypass. Their impacts range from **denial of service**¬†to potential¬†**arbitrary code execution**.

During the source code review I also audited the [lwIP](https://savannah.nongnu.org/projects/lwip/) and [TinyDir](https://github.com/cxong/tinydir) codebases on which some RT-Thread functionalities depend, and found [some](https://git.savannah.nongnu.org/cgit/lwip.git/commit/?id=ee1523630a81fffa6b7d93dd0c7a6191de5856cd) [additional](https://git.savannah.nongnu.org/cgit/lwip.git/commit/?id=b413b040936f48d4cd9ed632ac579542c710efae) [vulnerabilities](https://github.com/cxong/tinydir/security/advisories/GHSA-jf5r-wgf4-qhxf) that were subsequently fixed by the respective maintainers.

My detailed¬†**advisories** are available here:

* <https://github.com/hnsecurity/vulns/blob/main/HNS-2024-05-rt-thread.txt>
* <https://github.com/hnsecurity/vulns/blob/main/HNS-2023-04-tinydir.txt>

### Background

After my [recent vulnerability disclosures](https://security.humanativaspa.it/ost2-zephyr-rtos-and-a-bunch-of-cves/), I decided to keep assisting open-source projects in the IoT space in finding and fixing security vulnerabilities by **reviewing their source code**. RT-Thread was selected as a target of interest. Other RTOSes will be featured in future [advisories](https://github.com/hnsecurity/vulns) and writeups. So, [stay tuned](https://security.humanativaspa.it/tag/iot/).

During this review, I made use of my [Semgrep C/C++ ruleset](https://security.humanativaspa.it/semgrep-ruleset-for-c-c-vulnerability-research/)¬†to identify hotspots in code on which to focus my attention. I also took advantage of this opportunity to¬†[improve and update](https://security.humanativaspa.it/big-update-to-my-semgrep-c-cpp-ruleset/)¬†the ruleset.

### Vulnerabilities

The¬†**vulnerabilities**¬†resulting from my source code review are:

* [CVE-2024-24335](https://github.com/RT-Thread/rt-thread/issues/8271) ‚Äì Buffer overflow in RT-Thread dfs\_v2 romfs filesystem
* [CVE-2024-24334](https://github.com/RT-Thread/rt-thread/issues/8282) ‚Äì Heap buffer overflows in RT-Thread dfs\_v2 dfs\_file
* [CVE-2024-25389](https://github.com/RT-Thread/rt-thread/issues/8283) ‚Äì Weak random source in RT-Thread rt\_random driver
* [CVE-2024-25388](https://github.com/RT-Thread/rt-thread/issues/8285) ‚Äì Heap buffer overflow in RT-Thread wlan driver
* [CVE-2024-25390](https://github.com/RT-Thread/rt-thread/issues/8286) ‚Äì Heap buffer overflows in RT-Thread finsh
* [CVE-2024-25391](https://github.com/RT-Thread/rt-thread/issues/8287) ‚Äì Stack buffer overflow in RT-Thread IPC
* [CVE-2024-25393](https://github.com/RT-Thread/rt-thread/issues/8288) ‚Äì Stack buffer overflow in RT-Thread AT server
* [CVE-2024-25395](https://github.com/RT-Thread/rt-thread/issues/8289) ‚Äì Static buffer overflow in RT-Thread rt-link utility
* [CVE-2024-25392](https://github.com/RT-Thread/rt-thread/issues/8290) ‚Äì Out-of-bounds static array access in RT-Thread var\_export utility
* [CVE-2024-25394](https://github.com/RT-Thread/rt-thread/issues/8291) ‚Äì Multiple vulnerabilities in RT-Thread ymodem utility
* Use of [outdated](https://git.savannah.nongnu.org/cgit/lwip.git/commit/?id=ee1523630a81fffa6b7d93dd0c7a6191de5856cd) [lwIP](https://git.savannah.nongnu.org/cgit/lwip.git/commit/?id=b413b040936f48d4cd9ed632ac579542c710efae) and [TinyDir](https://github.com/hnsecurity/vulns/blob/main/HNS-2023-04-tinydir.txt) dependencies in RT-Thread

For additional information about these¬†**vulnerabilities**¬†and their¬†**fixes**, please refer to the detailed¬†[advisory](https://github.com/hnsecurity/vulns/blob/main/HNS-2024-05-rt-thread.txt).

Since a few months, I‚Äôve started to consistently keep track of my research efforts using the excellent [Be Focused](https://xwavesoft.com/be-focused-pro-for-iphone-ipad-mac-os-x.html) pomodoro timer app. Therefore, I know that it took me about **32 hours** to complete this project (not including the time spent for the disclosure process).

![](https://security.humanativaspa.it/sec/wp-content/uploads/2024/01/Screenshot-2024-01-27-at-11.09.29.png)

A nice graph that shows I was busy dealing with other stuff between September and October

### Disclosure and fixes

I reported the vulnerabilities discussed in this article to RT-Thread in November 2023, by opening [issues](https://github.com/search?o=desc&q=author%3A0xdea+rt-thread&s=created&type=issues) on GitHub [as directed](https://github.com/RT-Thread/rt-thread/issues/8250) by the maintainers. Following my [request](https://www.cve.org/ReportRequest/ReportRequestForNonCNAs), MITRE assigned **CVE IDs** to all vulnerabilities in February 2024.

RT-Thread developers have fixed some of the vulnerabilities discussed in this advisory. However, some of the reported vulnerabilities are still open. Even though not all vulnerabilities were fixed, I decided to go ahead with public disclosure after about 90 days since the initial reports. This decision was taken mainly based on the fact that the **vulnerability reports were already publicly accessible** as GitHub issues.

The detailed coordinated disclosure **timeline** follows:

* 2023-11-12: Asked on GitHub how to report potential security issues.
* 2023-11-13: RT-Thread founder replied to open issues directly on GitHub.
* 2023-11-20: Opened the first issue on GitHub.
* 2023-11-24: First vulnerability fixed; reported some other vulnerabilities.
* 2023-11-28: Second (and third) vulnerability fixed.
* 2023-12-24: Asked maintainers for updates.
* 2024-01-17: Requested the first batch of CVE IDs from MITRE.
* 2024-01-26: Informed maintainers of plan to publish advisory in February.
* 2024-02-02: Requested the second batch of CVE IDs from MITRE.
* 2024-02-07: CVE IDs for all reported vulnerabilities assigned by MITRE.
* 2024-02-08: Communicated CVE IDs and new 2024-03-05 publication date.
* 2024-02-18: Maintainers acknowledge publication date and inform about new fixes.
* 2024-03-05: Published advisory and writeup.

Please check the official RT-Thread channels for further information about fixes.

### Acknowledgments

I would like to thank RT-Thread, lwIP, and TinyDir developers for the time dedicated to triaging the reported vulnerabilities. I would also like to thank MITRE for assigning CVE IDs upon my request.

### Plug

You should submit an article to [Phrack](http://phrack.org/)! Clicky-clicky üßë‚Äçüíª

> You should write an article for Phrack #71 !! I hear it's coming out by summer time. üëÄ
>
> Let's open the windows and get some phresh air back into the scene.
>
> If you've got a story to tell, you should send it in by April 1st and keep the vibe going. üôÇ<https://t.co/Zc77uUWgvR> [pic.twitter.com/Q44xnCkug0](https://t.co/Q44xnCkug0)
>
> ‚Äî Battle Programmer Yuu (@netspooky) [January 11, 2024](https://twitter.com/netspooky/status/1745260034966126946?ref_src=twsrc%5Etfw)

# Blog Categories * [Articles](https://security.humanativaspa.it/category/articles/) * [Events](https://security.humanativaspa.it/category/events/) * [Exploits](https://security.humanativaspa.it/category/exploits/) * [News](https://security.humanativaspa.it/category/news/) * [Servizi](https://security.humanativaspa.it/category/servizi/) * [Tools](https://security.humanativaspa.it/category/tools/) * [Vulnerabilities](https://security.humanativaspa.it/category/vulnerabilities/)

## Tags

[0day](https://security.humanativaspa.it/tag/0day/%20)
[active directory](https://security.humanativaspa.it/tag/active-directory/%20)
[advisory](https://security.humanativaspa.it/tag/advisory/%20)
[analytics](https://security.humanativaspa.it/tag/analytics/%20)
[android](https://security.humanativaspa.it/tag/android/%20)
[apache](https://security.humanativaspa.it/tag/apache/%20)
[ARM](https://security.humanativaspa.it/tag/arm/%20)
[assemblies](https://security.humanativaspa.it/tag/assemblies/%20)
[atdcm64a](https://security.humanativaspa.it/tag/atdcm64a/%20)
[attacks](https://security.humanativaspa.it/tag/attacks/%20)
[authentication](https://security.humanativaspa.it/tag/authentication/%20)
[azure rtos](https://security.humanativaspa.it/tag/azure-rtos/%20)
[bindiff](https://security.humanativaspa.it/tag/bindiff/%20)
[brida](https://security.humanativaspa.it/tag/brida/%20)
[Burp Suite](https://security.humanativaspa.it/tag/burp-suite/%20)
[Bus Pirate](https://security.humanativaspa.it/tag/bus-pirate/%20)
[business](https://security.humanativaspa.it/tag/business/%20)
[BUSSide](https://security.humanativaspa.it/tag/busside/%20)
[c/c++](https://security.humanativaspa.it/tag/c-c/%20)
[c2](https://security.humanativaspa.it/tag/c2/%20)
[code review](https://security.humanativaspa.it/tag/code-review/%20)
[cracking](https://security.humanativaspa.it/tag/cracking/%20)
[cve-2021-22205](https://security.humanativaspa.it/tag/cve-2021-22205/%20)
[CVE-2022-0342](https://security.humanativaspa.it/tag/cve-2022-0342/%20)
[CVE-2022-2030](https://security.humanativaspa.it/tag/cve-2022-2030/%20)
[cve-2022-26531](https://security.humanativaspa.it/tag/cve-2022-26531/%20)
[cve-2022-26532](https://security.humanativaspa.it/tag/cve-2022-26532/%20)
[cve-2022-46285](https://security.humanativaspa.it/tag/cve-2022-46285/%20)
[cve-2023-24039](https://security.humanativaspa.it/tag/cve-2023-24039/%20)
[cve-2023-24040](https://security.humanativaspa.it/tag/cve-2023-24040/%20)
[DevSecCon](https://security.humanativaspa.it/tag/devseccon/%20)
[disassembly](https://security.humanativaspa.it/tag/disassembly/%20)
[dll](https://security.humanativaspa.it/tag/dll/%20)
[dynamic analysis](https://security.humanativaspa.it/tag/dynamic-analysis/%20)
[EL](https://security.humanativaspa.it/tag/el/%20)
[EL Injection](https://security.humanativaspa.it/tag/el-injection/%20)
[exploit](https://security.humanativaspa.it/tag/exploit/%20)
[exploit development](https://security.humanativaspa.it/tag/exploit-development/%20)
[Extender](https://security.humanativaspa.it/tag/extender/%20)
[Extender course](https://security.humanativaspa.it/tag/extender-course/%20)
[Extending Burp Suite](https://security.humanativaspa.it/tag/extending-burp-suite/%20)
[fault injection](https://security.humanativaspa.it/tag/fault-injection/%20)
[firmware](https://security.humanativaspa.it/tag/firmware/%20)
[foreverday](https://security.humanativaspa.it/tag/foreverday/%20)
[format string](https://security.humanativaspa.it/tag/format-string/%20)
[frida](https://security.humanativaspa.it/tag/frida/%20)
[ghidra](https://security.humanativaspa.it/tag/ghidra/%20)
[ghidra2frida](https://security.humanativaspa.it/tag/ghidra2frida/%20)
[gitlab](https://security.humanativaspa.it/tag/gitlab/%20)
[golang](https://security.humanativaspa.it/tag/golang/%20)
[groovy](https://security.humanativaspa.it/tag/groovy/%20)
[Hack In Paris](https://security.humanativaspa.it/tag/hack-in-paris/%20)
[hacking](https://security.humanativaspa.it/tag/hacking/%20)
[HackRF](https://security.humanativaspa.it/tag/hackrf/%20)
[hardware](https://security.humanativaspa.it/tag/hardware/%20)
[hn security](https://security.humanativaspa.it/tag/hn-security/%20)
[I2C](https://security.humanativaspa.it/tag/i2c/%20)
[ida](https://security.humanativaspa.it/tag/ida/%20)
[incident response](https://security.humanativaspa.it/tag/incident-response/%20)
[infiltrate](https://security.humanativaspa.it/tag/infiltrate/%20)
[Instrumentation](https://security.humanativaspa.it/tag/instrumentation/%20)
[interview](https://security.humanativaspa.it/tag/interview/%20)
[iOS](https://security.humanativaspa.it/tag/ios/%20)
[iot](https://security.humanativaspa.it/tag/iot/%20)
[Java](https://security.humanativaspa.it/tag/java/%20)
[Java Applet](https://security.humanativaspa.it/tag/java-applet/%20)
[Java Deserialization Scanner](https://security.humanativaspa.it/tag/java-deserialization-scanner/%20)
[Java Serialization](https://security.humanativaspa.it/tag/java-serialization/%20)
[Keil](https://security.humanativaspa.it/tag/keil/%20)
[keycloak](https://security.humanativaspa.it/tag/keycloak/%20)
[kotlin](https://security.humanativaspa.it/tag/kotlin/%20)
[log4j](https://security.humanativaspa.it/tag/log4j/%20)
[maven](https://security.humanativaspa.it/tag/maven/%20)
[metasploit](https://security.humanativaspa.it/tag/metasploit/%20)
[meterpreter](https://security.humanativaspa.it/tag/meterpreter/%20)
[mimikatz](https://security.humanativaspa.it/tag/mimikatz/%20)
[minidump](https://security.humanativaspa.it/tag/minidump/%20)
[mips](https://security.humanativaspa.it/tag/mips/%20)
[mobile](https://security.humanativaspa.it/tag/mobile/%20)
[Montoya API](https://security.humanativaspa.it/tag/montoya-api/%20)
[offensive security](https://security.humanativaspa.it/tag/offensive-security/%20)
[oldschool](https://security.humanativaspa.it/tag/oldschool/%20)
[open source](https://security.humanativaspa.it/tag/open-source/%20)
[OpenSSH](https://security.humanativaspa.it/tag/openssh/%20)
[passwords](https://security.humanativaspa.it/tag/passwords/%20)
[penetration test](https://security.humanativaspa.it/tag/penetration-test/%20)
[pentest](https://security.humanativaspa.it/tag/pentest/%20)
[php](https://security.humanativaspa.it/tag/php/%20)
[Phrack](https://security.humanativaspa.it/tag/phrack/%20)
[podcast](https://security.humanativaspa.it/tag/podcast/%20)
[pom.xml](https://security.humanativaspa.it/tag/pom-xml/%20)
[protobuf](https://security.humanativaspa.it/tag/protobuf/%20)
[pseudocode](https://security.humanativaspa.it/tag/pseudocode/%20)
[radio](https://security.humanativaspa.it/tag/radio/%20)
[ransomware](https://security.humanativaspa.it/tag/ransomware/%20)
[RCE](https://security.humanativaspa.it/tag/rce/%20)
[red teaming](https://security.humanativaspa.it/tag/red-teaming/%20)
[research](https://security.humanativaspa.it/tag/research/%20)
[reverse engineering](https://security.humanativaspa.it/tag/reverse-engineering/%20)
[riot](https://security.humanativaspa.it/tag/riot/%20)
[romhack](https://security.humanativaspa.it/tag/romhack/%20)
[rt-thread](https://security.humanativaspa.it/tag/rt-thread/%20)
[rust](https://security.humanativaspa.it/tag/rust/%20)
[saleae](https://security.humanativaspa.it/tag/saleae/%20)
[Security Manager](https://security.humanativaspa.it/tag/security-manager/%20)
[seemposium](https://security.humanativaspa.it/tag/seemposium/%20)
[semgrep](https://security.humanativaspa.it/tag/semgrep/%20)
[Serialization](https://security.humanativaspa.it/tag/serialization/%20)
[shellcode](https://security.humanativaspa.it/tag/shellcode/%20)
[single sign-on](https://security.humanativaspa.it/tag/single-sign-on/%20)
[sliver](https://security.humanativaspa.it/tag/sliver/%20)
[solaris](https://security.humanativaspa.it/tag/solaris/%20)
[source code analysis](https://security.humanativaspa.it/tag/source-code-analysis/%20)
[sparc](https://security.humanativaspa.it/tag/sparc/%20)
[static analysis](https://security.humanativaspa.it/tag/static-analysis/%20)
[statistics](https://security.humanativaspa.it/tag/statistics/%20)
[tactical exploitation](https://security.humanativaspa.it/tag/tactical-exploitation/%20)
[Template Injection](https://security.humanativaspa.it/tag/template-injection/%20)
[threadx](https://security.humanativaspa.it/tag/threadx/%20)
[threat intelligence](https://security.humanativaspa.it/tag/threat-intelligence/%20)
[Tutorial](https://security.humanativaspa.it/tag/tutorial/%20)
[UART](https://security.humanativaspa.it/tag/uart/%20)
[Universal Radio Hacker](https://security.humanativaspa.it/tag/universal-radio-hacker/%20)
[vulnerability research](https://security.humanativaspa.it/tag/vulnerability-research/%20)
[web](https://security.humanativaspa.it/tag/web/%20)
[weggli](https://security.humanativaspa.it/tag/weggli/%20)
[whitebox](https://security.humanativaspa.it/tag/whitebox/%20)
[windows](https://security.humanativaspa.it/tag/windows/%20)
[x86](https://security.humanativaspa.it/tag/x86/%20)
[xamarin](https://security.humanativaspa.it/tag/xamarin/%20)
[yii](https://security.humanativaspa.it/tag/yii/%20)
[ysoserial](https://security.humanativaspa.it/tag/ysoserial/%20)
[zephyr](https://security.humanativaspa.it/tag/zephyr/%20)
[zyxel](https://security.humanativaspa.it/tag/zyxel/%20)

## Post navigation

[Previous: Seemposium Podcast interview](https://security.humanativaspa.it/seemposium-podcast-interview/)[Next: Frida on Java applications and applets in 2024](https://security.humanativaspa.it/frida-on-java-applets-in-2024/)

###### Legal and Administrative

Viale Oceano Pacifico, 66

00144 Rome (Italy)

###### [www.humanativaspa.it](https://humanativaspa.it)

Copyright ¬© 2021-2025 HN Security S.r.l.

[Privacy Policy](https://humanativaspa.it/en/privacy-policy/)

We use cookies on our website to give you the most relevant experience by remembering your preferences and repeat visits. By clicking ‚ÄúAccept‚Äù, you consent to the use of ALL the cookies.Cookie settingsACCEPTManage consent

Close

#### Privacy Overview

This website uses cookies to improve your experience while you navigate through the website. Out of these, the cookies that are categorized as necessary are stored on your browser as they are essential for the working of basic functionalities of the website. We also use third-party cookies that help us analyze and understand how you use this website. These cookies will be stored in your browser only with your consent. You also have the option to opt-out of these cookies. But opting out of some of these cookies may affect your browsing experience.

Necessary

Necessary

Always Enabled

Necessary cookies are absolutely essential for the website to function properly. These cookies ensure basic functionalities and security features of the website, anonymously.

| Cookie | Duration | Description |
| --- | --- | --- |
| cookielawinfo-checbox-analytics | 11 months | This cookie is set by GDPR Cookie Consent plugin. The cookie is used to store the user consent for the cookies in the category "Analytics". |
| cookielawinfo-checbox-functional | 11 months | The cookie is set by GDPR cookie consent to record the user consent for the cookies in the category "Functional". |
| cookielawinfo-checbox-others | 11 months | This cookie is set by GDPR Cookie Consent plugin. The cookie is used to store the user consent for the cookies in the category "Other. |
| cookielawinfo-checkbox-necessary | 11 months | This cookie is set by GDPR Cookie Consent plugin. The cookies is used to store the user consent for the cookies in the category "Necessary". |
| cookielawinfo-checkbox-performance | 11 months | This cookie is set by GDPR Cookie Consent plugin. The cookie is used to store the user consent for the cookies in the category "Performance". |
| viewed\_cookie\_policy | 11 months | The cookie is set by the GDPR Cookie Consent plugin and is used to store whether or not user has consented to the use of cookies. It does not store any personal data. |

Functional

Functional

Functional cookies help to perform certain functionalities like sharing the content of the website on social media platforms, collect feedbacks, and other third-party features.

Performance

Performance

Performance cookies are used to understand and analyze the key performance indexes of the website which helps in delivering a better user experience for the visitors.

Analytics

Analytics

Analytical cookies are used to understand how visitors interact with the website. These cookies help provide information on metrics the number of visitors, bounce rate, traffic source, etc.

Advertisement

Advertisement

Advertisement cookies are used to provide visitors with relevant ads and marketing campaigns. These cookies track visitors across websites and collect information to provide customized ads.

Others

Others

Other uncategorized cookies are those that are being analyzed and have not been classified into a category as yet.

SAVE & ACCEPT



=== Content from seclists.org_e2c54fd9_20250110_211141.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](27)
[By Date](date.html#28)
[![Next](/images/right-icon-16x16.png)](29)

[![Previous](/images/left-icon-16x16.png)](27)
[By Thread](index.html#28)
[![Next](/images/right-icon-16x16.png)](29)

![](/shared/images/nst-icons.svg#search)

# HNS-2024-05 - HN Security Advisory - Multiple vulnerabilities in RT-Thread RTOS

---

*From*: Marco Ivaldi <raptor () 0xdeadbeef info>

*Date*: Tue, 5 Mar 2024 11:40:42 +0100

---

```
Hi,

Please find attached a security advisory that describes multiple
vulnerabilities we discovered in RT-Thread RTOS.

* Title: Multiple vulnerabilities in RT-Thread RTOS
* OS: RT-Thread <= 5.0.2
* Author: Marco Ivaldi <marco.ivaldi () hnsecurity it>
* Date: 2024-03-05
* CVE IDs and advisory URLs:
  * CVE-2024-24334 - <https://github.com/RT-Thread/rt-thread/issues/8282>
  * CVE-2024-24335 - <https://github.com/RT-Thread/rt-thread/issues/8271>
  * CVE-2024-25388 - <https://github.com/RT-Thread/rt-thread/issues/8285>
  * CVE-2024-25389 - <https://github.com/RT-Thread/rt-thread/issues/8283>
  * CVE-2024-25390 - <https://github.com/RT-Thread/rt-thread/issues/8286>
  * CVE-2024-25391 - <https://github.com/RT-Thread/rt-thread/issues/8287>
  * CVE-2024-25392 - <https://github.com/RT-Thread/rt-thread/issues/8290>
  * CVE-2024-25393 - <https://github.com/RT-Thread/rt-thread/issues/8288>
  * CVE-2024-25394 - <https://github.com/RT-Thread/rt-thread/issues/8291>
  * CVE-2024-25395 - <https://github.com/RT-Thread/rt-thread/issues/8289>
  * <https://github.com/RT-Thread/rt-thread/issues/8292>
* Vendor URL: <https://www.rt-thread.io/>

The advisory is also available at:
<https://github.com/hnsecurity/vulns/blob/main/HNS-2024-05-rt-thread.txt>

For additional information, please refer to our vulnerability writeup:
<https://security.humanativaspa.it/multiple-vulnerabilities-in-rt-thread-rtos>

Regards,

--
Marco Ivaldi
<https://0xdeadbeef.info/>
"When cryptography is outlawed, bayl bhgynjf jvyy unir cevinpl."

```

**Attachment:
[HNS-2024-05-rt-thread.txt](att-28/HNS-2024-05-rt-thread.txt)**

*Description:*

```
_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <https://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](27)
[By Date](date.html#28)
[![Next](/images/right-icon-16x16.png)](29)

[![Previous](/images/left-icon-16x16.png)](27)
[By Thread](index.html#28)
[![Next](/images/right-icon-16x16.png)](29)

### Current thread:

* **HNS-2024-05 - HN Security Advisory - Multiple vulnerabilities in RT-Thread RTOS** *Marco Ivaldi (Mar 13)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from github.com_ca0cd592_20250110_211140.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhnsecurity%2Fvulns%2Fblob%2Fmain%2FHNS-2024-05-rt-thread.txt)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhnsecurity%2Fvulns%2Fblob%2Fmain%2FHNS-2024-05-rt-thread.txt)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=hnsecurity%2Fvulns)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[hnsecurity](/hnsecurity)
/
**[vulns](/hnsecurity/vulns)**
Public

* [Notifications](/login?return_to=%2Fhnsecurity%2Fvulns) You must be signed in to change notification settings
* [Fork
  2](/login?return_to=%2Fhnsecurity%2Fvulns)
* [Star
   21](/login?return_to=%2Fhnsecurity%2Fvulns)

* [Code](/hnsecurity/vulns)
* [Issues
  0](/hnsecurity/vulns/issues)
* [Pull requests
  0](/hnsecurity/vulns/pulls)
* [Actions](/hnsecurity/vulns/actions)
* [Projects
  0](/hnsecurity/vulns/projects)
* [Security](/hnsecurity/vulns/security)
* [Insights](/hnsecurity/vulns/pulse)

Additional navigation options

* [Code](/hnsecurity/vulns)
* [Issues](/hnsecurity/vulns/issues)
* [Pull requests](/hnsecurity/vulns/pulls)
* [Actions](/hnsecurity/vulns/actions)
* [Projects](/hnsecurity/vulns/projects)
* [Security](/hnsecurity/vulns/security)
* [Insights](/hnsecurity/vulns/pulse)

## Files

¬†main
## Breadcrumbs

1. [vulns](/hnsecurity/vulns/tree/main)
/
# HNS-2024-05-rt-thread.txt

Copy path Blame  Blame
## Latest commit

## History

[History](/hnsecurity/vulns/commits/main/HNS-2024-05-rt-thread.txt)1117 lines (924 loc) ¬∑ 35.2 KB¬†main
## Breadcrumbs

1. [vulns](/hnsecurity/vulns/tree/main)
/
# HNS-2024-05-rt-thread.txt

Top
## File metadata and controls

* Code
* Blame

1117 lines (924 loc) ¬∑ 35.2 KB[Raw](https://github.com/hnsecurity/vulns/raw/refs/heads/main/HNS-2024-05-rt-thread.txt)1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798991001011021031041051061071081091101111121131141151161171181191201211221231241251261271281291301311321331341351361371381391401411421431441451461471481491501511521531541551561571581591601611621631641651661671681691701711721731741751761771781791801811821831841851861871881891901911921931941951961971981992002012022032042052062072082092102112122132142152162172182192202212222232242252262272282292302312322332342352362372382392402412422432442452462472482492502512522532542552562572582592602612622632642652662672682692702712722732742752762772782792802812822832842852862872882892902912922932942952962972982993003013023033043053063073083093103113123133143153163173183193203213223233243253263273283293303313323333343353363373383393403413423433443453463473483493503513523533543553563573583593603613623633643653663673683693703713723733743753763773783793803813823833843853863873883893903913923933943953963973983994004014024034044054064074084094104114124134144154164174184194204214224234244254264274284294304314324334344354364374384394404414424434444454464474484494504514524534544554564574584594604614624634644654664674684694704714724734744754764774784794804814824834844854864874884894904914924934944954964974984995005015025035045055065075085095105115125135145155165175185195205215225235245255265275285295305315325335345355365375385395405415425435445455465475485495505515525535545555565575585595605615625635645655665675685695705715725735745755765775785795805815825835845855865875885895905915925935945955965975985996006016026036046056066076086096106116126136146156166176186196206216226236246256266276286296306316326336346356366376386396406416426436446456466476486496506516526536546556566576586596606616626636646656666676686696706716726736746756766776786796806816826836846856866876886896906916926936946956966976986997007017027037047057067077087097107117127137147157167177187197207217227237247257267277287297307317327337347357367377387397407417427437447457467477487497507517527537547557567577587597607617627637647657667677687697707717727737747757767777787797807817827837847857867877887897907917927937947957967977987998008018028038048058068078088098108118128138148158168178188198208218228238248258268278288298308318328338348358368378388398408418428438448458468478488498508518528538548558568578588598608618628638648658668678688698708718728738748758768778788798808818828838848858868878888898908918928938948958968978988999009019029039049059069079089099109119129139149159169179189199209219229239249259269279289299309319329339349359369379389399409419429439449459469479489499509519529539549559569579589599609619629639649659669679689699709719729739749759769779789799809819829839849859869879889899909919929939949959969979989991000--[ HNS-2024-05 - HN Security Advisory - https://security.humanativaspa.it/
\* Title: Multiple vulnerabilities in RT-Thread RTOS\* OS: RT-Thread <= 5.0.2\* Author: Marco Ivaldi <marco.ivaldi@hnsecurity.it>\* Date: 2024-03-05\* CVE IDs and advisory URLs: \* CVE-2024-24334 - https://github.com/RT-Thread/rt-thread/issues/8282 \* CVE-2024-24335 - https://github.com/RT-Thread/rt-thread/issues/8271 \* CVE-2024-25388 - https://github.com/RT-Thread/rt-thread/issues/8285 \* CVE-2024-25389 - https://github.com/RT-Thread/rt-thread/issues/8283 \* CVE-2024-25390 - https://github.com/RT-Thread/rt-thread/issues/8286 \* CVE-2024-25391 - https://github.com/RT-Thread/rt-thread/issues/8287 \* CVE-2024-25392 - https://github.com/RT-Thread/rt-thread/issues/8290 \* CVE-2024-25393 - https://github.com/RT-Thread/rt-thread/issues/8288 \* CVE-2024-25394 - https://github.com/RT-Thread/rt-thread/issues/8291 \* CVE-2024-25395 - https://github.com/RT-Thread/rt-thread/issues/8289 \* https://github.com/RT-Thread/rt-thread/issues/8292\* Vendor URL: https://www.rt-thread.io/
--[ 0 - Table of contents
1 - Summary2 - Background3 - Vulnerabilities 3.1 - CVE-2024-24335 - Buffer overflow in RT-Thread dfs\_v2 romfs filesystem 3.2 - CVE-2024-24334 - Heap buffer overflows in RT-Thread dfs\_v2 dfs\_file 3.3 - CVE-2024-25389 - Weak random source in RT-Thread rt\_random driver 3.4 - CVE-2024-25388 - Heap buffer overflow in RT-Thread wlan driver 3.5 - CVE-2024-25390 - Heap buffer overflows in RT-Thread finsh 3.6 - CVE-2024-25391 - Stack buffer overflow in RT-Thread IPC 3.7 - CVE-2024-25393 - Stack buffer overflow in RT-Thread AT server 3.8 - CVE-2024-25395 - Static buffer overflow in RT-Thread rt-link utility 3.9 - CVE-2024-25392 - Out-of-bounds static array access in RT-Thread var\_export utility 3.10 - CVE-2024-25394 - Multiple vulnerabilities in RT-Thread ymodem utility 3.11 - Use of outdated lwIP and TinyDir dependencies in RT-Thread4 - Affected products5 - Remediation6 - Disclosure timeline7 - Acknowledgments8 - References
--[ 1 - Summary
"Security is in the mind of the programmer and in the mind of the designer.Not so much in the code."  -- Alisa Esage
RT-Thread [1] is an open-source, community-based real-time operating system(RTOS). RT-Thread can be used in sensing nodes, wireless connection chips,and many other resource-constrained scenarios. It is also widely applied ingateways, IPC, smart speakers, and other high-performance IoT applications.
We reviewed RT-Thread's source code hosted on GitHub [2] and identifiedmultiple security vulnerabilities that may cause memory corruption andsecurity feature bypass. Their impacts range from denial of service topotential arbitrary code execution.
We also audited the lwIP [3] and TinyDir [4] codebases on which someRT-Thread functionalities depend, and found some additional vulnerabilitiesthat were subsequently fixed by the respective maintainers.
--[ 2 - Background
After our recent vulnerability disclosures [5] in the IoT space, we decidedto keep assisting open-source projects in finding and fixing securityvulnerabilities by reviewing their source code. RT-Thread was selected as atarget of interest. Other RTOSes will be featured in future advisories andwriteups.
During this review, we made use of our Semgrep C/C++ ruleset [6] toidentify hotspots in code on which to focus our attention. We also tookadvantage of this opportunity to improve and update the ruleset [7].
--[ 3 - Vulnerabilities
The vulnerabilities resulting from our source code review are brieflydescribed in the following sections.
--[ 3.1 - CVE-2024-24335 - Buffer overflow in RT-Thread dfs\_v2 romfs filesystem
We spotted a buffer overflow vulnerability at the following location in theRT-Thread dfs\_v2 romfs filesystem source code:
\* /components/dfs/dfs\_v2/filesystems/romfs/dfs\_romfs.c
Lack of length check in the `dfs\_romfs\_getdents()` function could lead to abuffer overflow at the marked line:```cstatic int dfs\_romfs\_getdents(struct dfs\_file \*file, struct dirent \*dirp, uint32\_t count){ rt\_size\_t index; const char \*name; struct dirent \*d; struct romfs\_dirent \*dirent, \*sub\_dirent;
 dirent = (struct romfs\_dirent \*)file->vnode->data; if (check\_dirent(dirent) != 0) { return -EIO; } RT\_ASSERT(dirent->type == ROMFS\_DIRENT\_DIR);
 /\* enter directory \*/ dirent = (struct romfs\_dirent \*)dirent->data;
 /\* make integer count \*/ count = (count / sizeof(struct dirent)); if (count == 0) { return -EINVAL; }
 index = 0; for (index = 0; index < count && file->fpos < file->vnode->size; index++) { d = dirp + index;
 sub\_dirent = &dirent[file->fpos]; name = sub\_dirent->name;
 /\* fill dirent \*/ if (sub\_dirent->type == ROMFS\_DIRENT\_DIR) d->d\_type = DT\_DIR; else d->d\_type = DT\_REG;
 d->d\_namlen = rt\_strlen(name); d->d\_reclen = (rt\_uint16\_t)sizeof(struct dirent); rt\_strncpy(d->d\_name, name, rt\_strlen(name) + 1); /\* VULN: buffer overflow if rt\_strlen(name) is larger than sizeof(d->d\_name) due to missing length check \*/
 /\* move to next position \*/ ++ file->fpos; }
 return index \* sizeof(struct dirent);}```
Note: dfs\_v1 romfs in /components/dfs/dfs\_v1/filesystems/romfs/dfs\_romfs.cis not affected, because the string copy operation is implementeddifferently:```c len = rt\_strlen(name); RT\_ASSERT(len <= RT\_UINT8\_MAX); d->d\_namlen = (rt\_uint8\_t)len; d->d\_reclen = (rt\_uint16\_t)sizeof(struct dirent); rt\_strncpy(d->d\_name, name, DFS\_PATH\_MAX);```
Even if the assertion is compiled-out in production code, `len` is not usedfor the copy operation anyway. Therefore, unless `DFS\_PATH\_MAX` is largerthan `sizeof(d->d\_name)`, this code should be safe.
Fixes:https://github.com/RT-Thread/rt-thread/pull/8278
See also:https://github.com/RT-Thread/rt-thread/issues/8271
--[ 3.2 - CVE-2024-24334 - Heap buffer overflows in RT-Thread dfs\_v2 dfs\_file
We spotted some heap buffer overflow vulnerabilities at the followinglocation in the RT-Thread dfs\_v2 dfs\_file source code:
\* /components/dfs/dfs\_v2/src/dfs\_file.c
Lack of length check in the the `dfs\_nolink\_path()` function could lead toheap buffer overflows at the marked lines:```cstatic char \*dfs\_nolink\_path(struct dfs\_mnt \*\*mnt, char \*fullpath, int mode){ int index = 0; char \*path = RT\_NULL; char link\_fn[DFS\_PATH\_MAX] = {0}; struct dfs\_dentry \*dentry = RT\_NULL;
 path = (char \*)rt\_malloc((DFS\_PATH\_MAX \* 2) + 1); // path + syslink + \0 if (!path) { return path; }
 if (\*mnt && fullpath) { int i = 0; char \*fp = fullpath;
 while (\*fp != '\0') { fp++; i++; if (\*fp == '/') { rt\_memcpy(path + index, fp - i, i); /\* VULN: if fullpath has components large enough so that i+index becomes larger than DFS\_PATH\_MAX\*2+1, we could overflow past the path buffer \*/ path[index + i] = '\0';
 dentry = dfs\_dentry\_lookup(\*mnt, path, 0); if (dentry && dentry->vnode->type == FT\_SYMLINK) { int ret = -1;
 if ((\*mnt)->fs\_ops->readlink) { if (dfs\_is\_mounted((\*mnt)) == 0) { ret = (\*mnt)->fs\_ops->readlink(dentry, link\_fn, DFS\_PATH\_MAX); } }
 if (ret > 0) { int len = rt\_strlen(link\_fn); if (link\_fn[0] == '/') { rt\_memcpy(path, link\_fn, len); index = len; } else { path[index] = '/'; index++; rt\_memcpy(path + index, link\_fn, len); /\* VULN: len can be DFS\_PATH\_MAX; if index can become larger than DFS\_PATH\_MAX+1, we can overflow past the path buffer \*/ index += len; } path[index] = '\0'; \*mnt = dfs\_mnt\_lookup(path); } else { rt\_kprintf("link error: %s\n", path); } } else { index += i; } dfs\_dentry\_unref(dentry); i = 0; } }
 if (i) { rt\_memcpy(path + index, fp - i, i); /\* VULN: if fullpath has components large enough so that i+index becomes larger than DFS\_PATH\_MAX\*2+1, we could overflow past the path buffer \*/ path[index + i] = '\0';
 if (mode) { dentry = dfs\_dentry\_lookup(\*mnt, path, 0); if (dentry && dentry->vnode->type == FT\_SYMLINK) { int ret = -1;
 if ((\*mnt)->fs\_ops->readlink) { if (dfs\_is\_mounted((\*mnt)) == 0) { ret = (\*mnt)->fs\_ops->readlink(dentry, link\_fn, DFS\_PATH\_MAX); } }
 if (ret > 0) { int len = rt\_strlen(link\_fn); if (link\_fn[0] == '/') { rt\_memcpy(path, link\_fn, len); index = len; } else { path[index] = '/'; index++; rt\_memcpy(path + index, link\_fn, len); /\* VULN: len can be DFS\_PATH\_MAX; if index can become larger than DFS\_PATH\_MAX+1, we can overflow past the path buffer \*/ index += len; } path[index] = '\0'; \*mnt = dfs\_mnt\_lookup(path); } else { rt\_kprintf("link error: %s\n", path); }
 char \*\_fullpath = dfs\_normalize\_path(RT\_NULL, path); if (\_fullpath) { strncpy(path, \_fullpath, DFS\_PATH\_MAX); rt\_free(\_fullpath); } } dfs\_dentry\_unref(dentry); } } } else { rt\_free(path); path = RT\_NULL; }
 //rt\_kprintf("%s: %s => %s\n", \_\_FUNCTION\_\_, fullpath, path);
 return path;}```
Fixes:https://github.com/RT-Thread/rt-thread/pull/8305
See also:https://github.com/RT-Thread/rt-thread/issues/8282
--[ 3.3 - CVE-2024-25389 - Weak random source in RT-Thread rt\_random driver
We noticed a weak random source at the following location in the RT-Threadrt\_random driver source code:
\* /components/drivers/misc/rt\_random.c
Weak random generator in the the `calc\_random()` function:```cstatic rt\_uint16\_t calc\_random(void){ seed = 214013L \* seed + 2531011L; return (seed >> 16) & 0x7FFF; /\* return bits 16~30 \*/}
static rt\_ssize\_t random\_read(rt\_device\_t dev, rt\_off\_t pos, void \*buffer, rt\_size\_t size){ rt\_uint16\_t rand = calc\_random(); /\* VULN: weak random source \*/ ssize\_t ret = sizeof(rand); rt\_memcpy(buffer, &rand, ret); return ret;}```
See also:https://github.com/RT-Thread/rt-thread/issues/8283
--[ 3.4 - CVE-2024-25388 - Heap buffer overflow in RT-Thread wlan driver
We spotted a heap buffer overflow vulnerability at the following locationin the RT-Thread wlan driver source code:
\* /components/drivers/wlan/wlan\_mgnt.c
Since `len` is a signed integer in the `rt\_wlan\_send\_to\_thread()` function,a small negative value could lead to a buffer overflow at the marked lines:```c#ifdef RT\_WLAN\_WORK\_THREAD\_ENABLE...static rt\_err\_t rt\_wlan\_send\_to\_thread(rt\_wlan\_event\_t event, void \*buff, int len){ struct rt\_wlan\_msg \*msg;
 RT\_WLAN\_LOG\_D("F:%s is run event:%d", \_\_FUNCTION\_\_, event);
 /\* Event packing \*/ msg = rt\_malloc(sizeof(struct rt\_wlan\_msg) + len); /\* VULN: if len is a small negative number, this would result in an under-allocation \*/ if (msg == RT\_NULL) { RT\_WLAN\_LOG\_E("wlan mgnt send msg err! No memory"); return -RT\_ENOMEM; } rt\_memset(msg, 0, sizeof(struct rt\_wlan\_msg) + len); msg->event = event; if (len != 0) { msg->buff = (void \*)&msg[1]; rt\_memcpy(msg->buff, buff, len); /\* VULN: the small negative number would become a large unsigned size, and we would have a wild memcpy and a heap buffer overflow \*/ msg->len = len; }
 /\* send event to wlan thread \*/ if (rt\_wlan\_workqueue\_dowork(rt\_wlan\_mgnt\_work, msg) != RT\_EOK) { rt\_free(msg); RT\_WLAN\_LOG\_E("wlan mgnt do work fail"); return -RT\_ERROR; } return RT\_EOK;}```
See also:https://github.com/RT-Thread/rt-thread/issues/8285
--[ 3.5 - CVE-2024-25390 - Heap buffer overflows in RT-Thread finsh
We spotted some heap buffer overflow vulnerabilities at the followinglocations in the RT-Thread finsh source code:
\* /components/finsh/msh\_file.c\* /components/finsh/msh.c
Unbounded `rt\_sprintf()` in the `directory\_delete\_for\_msh()` function couldlead to a heap buffer overflow at the marked line:```cstatic void directory\_delete\_for\_msh(const char \*pathname, char f, char v){ DIR \*dir = NULL; struct dirent \*dirent = NULL; char \*full\_path;
 if (pathname == RT\_NULL) return;
 full\_path = (char \*)rt\_malloc(DFS\_PATH\_MAX); if (full\_path == RT\_NULL) return;
 dir = opendir(pathname); if (dir == RT\_NULL) { if (f == 0) { rt\_kprintf("cannot remove '%s'\n", pathname); } rt\_free(full\_path); return; }
 while (1) { dirent = readdir(dir); if (dirent == RT\_NULL) break; if (rt\_strcmp(".", dirent->d\_name) != 0 && rt\_strcmp("..", dirent->d\_name) != 0) { rt\_sprintf(full\_path, "%s/%s", pathname, dirent->d\_name); /\* VULN: full\_path is DFS\_PATH\_MAX bytes (only 256 bytes), potentially not enough to accommodate pathname + dirent->d\_name \*/ if (dirent->d\_type != DT\_DIR) { if (unlink(full\_path) != 0) { if (f == 0) rt\_kprintf("cannot remove '%s'\n", full\_path); } else if (v) { rt\_kprintf("removed '%s'\n", full\_path); } } else { directory\_delete\_for\_msh(full\_path, f, v); } } } closedir(dir); rt\_free(full\_path); if (rmdir(pathname) != 0) { if (f == 0) rt\_kprintf("cannot remove '%s'\n", pathname); } else if (v) { rt\_kprintf("removed directory '%s'\n", pathname); }}```
Unbounded `rt\_sprintf()` in the `directory\_setattr()` function could leadto a heap buffer overflow at the marked line:```cstatic void directory\_setattr(const char \*pathname, struct dfs\_attr \*attr, char f, char v){ DIR \*dir = NULL; struct dirent \*dirent = NULL; char \*full\_path;
 if (pathname == RT\_NULL) return;
 full\_path = (char \*)rt\_malloc(DFS\_PATH\_MAX); if (full\_path == RT\_NULL) return;
 dir = opendir(pathname); if (dir == RT\_NULL) { if (f == 0) { rt\_kprintf("cannot open '%s'\n", pathname); } rt\_free(full\_path); return; }
 while (1) { dirent = readdir(dir); if (dirent == RT\_NULL) break; if (rt\_strcmp(".", dirent->d\_name) != 0 && rt\_strcmp("..", dirent->d\_name) != 0) { rt\_sprintf(full\_path, "%s/%s", pathname, dirent->d\_name); /\* VULN: full\_path is DFS\_PATH\_MAX bytes (only 256 bytes), potentially not enough to accommodate pathname + dirent->d\_name \*/ if (dirent->d\_type == DT\_REG) { if (dfs\_file\_setattr(full\_path, attr) != 0) { if (f == 0) { rt\_kprintf("'%s' setattr failed, no such file or directory\n", full\_path); } } else if (v) { rt\_kprintf("'%s' setattr 0x%X\n", full\_path, attr->st\_mode); } } else if (dirent->d\_type == DT\_DIR) { directory\_setattr(full\_path, attr, f, v); } } } closedir(dir); rt\_free(full\_path); if (dfs\_file\_setattr(pathname, attr) != 0) { if (f == 0) { rt\_kprintf("'%s' setattr failed, no such file or directory\n", pathname); } } else if (v) { rt\_kprintf("'%s' setattr 0x%X\n", pathname, attr->st\_mode); }}```
Unbounded `strcpy()` in the `msh\_auto\_complete\_path()` function could leadto a heap buffer overflow at the marked line:```c#ifdef DFS\_USING\_POSIXvoid msh\_auto\_complete\_path(char \*path){ DIR \*dir = RT\_NULL; struct dirent \*dirent = RT\_NULL; char \*full\_path, \*ptr, \*index;
 if (!path) return;
 full\_path = (char \*)rt\_malloc(256); if (full\_path == RT\_NULL) return; /\* out of memory \*/
 if (\*path != '/') { getcwd(full\_path, 256); if (full\_path[rt\_strlen(full\_path) - 1] != '/') strcat(full\_path, "/"); } else \*full\_path = '\0';
 index = RT\_NULL; ptr = path; for (;;) { if (\*ptr == '/') index = ptr + 1; if (!\*ptr) break;
 ptr ++; } if (index == RT\_NULL) index = path;
 if (index != RT\_NULL) { char \*dest = index;
 /\* fill the parent path \*/ ptr = full\_path; while (\*ptr) ptr ++;
 for (index = path; index != dest;) \*ptr++ = \*index++; \*ptr = '\0';
 dir = opendir(full\_path); if (dir == RT\_NULL) /\* open directory failed! \*/ { rt\_free(full\_path); return; }
 /\* restore the index position \*/ index = dest; }
 /\* auto complete the file or directory name \*/ if (\*index == '\0') /\* display all of files and directories \*/ { for (;;) { dirent = readdir(dir); if (dirent == RT\_NULL) break;
 rt\_kprintf("%s\n", dirent->d\_name); } } else { int multi = 0; rt\_size\_t length, min\_length;
 min\_length = 0; for (;;) { dirent = readdir(dir); if (dirent == RT\_NULL) break;
 /\* matched the prefix string \*/ if (strncmp(index, dirent->d\_name, rt\_strlen(index)) == 0) { multi ++; if (min\_length == 0) { min\_length = rt\_strlen(dirent->d\_name); /\* save dirent name \*/ strcpy(full\_path, dirent->d\_name); /\* VULN: if sizeof(dirent->d\_name) > 256, we could overflow past the full\_path buffer \*/ }
 length = str\_common(dirent->d\_name, full\_path);
 if (length < min\_length) { min\_length = length; } } }
 if (min\_length) { if (multi > 1) { /\* list the candidate \*/ rewinddir(dir);
 for (;;) { dirent = readdir(dir); if (dirent == RT\_NULL) break;
 if (strncmp(index, dirent->d\_name, rt\_strlen(index)) == 0) rt\_kprintf("%s\n", dirent->d\_name); } }
 length = index - path; rt\_memcpy(index, full\_path, min\_length); path[length + min\_length] = '\0';
 /\* try to locate folder \*/ if (multi == 1) { struct stat buffer = {0}; if ((stat(path, &buffer) == 0)) { if (S\_ISDIR(buffer.st\_mode)) { strcat(path, "/"); } else if (S\_ISLNK(buffer.st\_mode)) { DIR \*dir = opendir(path); if (dir) { closedir(dir); strcat(path, "/"); } } } } } }
 closedir(dir); rt\_free(full\_path);}#endif /\* DFS\_USING\_POSIX \*/```
Fixes:https://github.com/RT-Thread/rt-thread/pull/8305
See also:https://github.com/RT-Thread/rt-thread/issues/8286
--[ 3.6 - CVE-2024-25391 - Stack buffer overflow in RT-Thread IPC
We spotted a stack buffer overflow vulnerability at the following locationin the RT-Thread IPC source code:
\* /components/libc/posix/ipc/mqueue.c
Unbounded `rt\_sprintf()` in the `mq\_unlink()` function could lead to astack buffer overflow at the marked line:```cint mq\_unlink(const char \*name){ if(\*name == '/') { name++; } const char \*mq\_path = "/dev/mqueue/"; char mq\_name[RT\_NAME\_MAX + 12] = {0}; rt\_sprintf(mq\_name, "%s%s", mq\_path, name); /\* VULN: stack buffer overflow \*/ return unlink(mq\_name);}```
Note: the mq\_open() function in /components/libc/posix/ipc/mqueue.cimplements bound checking:```c int len = rt\_strlen(name); if (len > RT\_NAME\_MAX) { rt\_set\_errno(ENAMETOOLONG); return (mqd\_t)(-1); }```
See also:https://github.com/RT-Thread/rt-thread/issues/8287
--[ 3.7 - CVE-2024-25393 - Stack buffer overflow in RT-Thread AT server
We spotted a stack buffer overflow vulnerability at the following locationin the RT-Thread AT server source code:
\* /components/net/at/src/at\_server.c
Lack of length check in the `at\_cmd\_get\_name()` function could lead to astack buffer overflow at the marked line:```c#ifdef AT\_USING\_SERVER...static rt\_err\_t at\_cmd\_get\_name(const char \*cmd\_buffer, char \*cmd\_name){ rt\_size\_t cmd\_name\_len = 0, i = 0;
 RT\_ASSERT(cmd\_name); RT\_ASSERT(cmd\_buffer);
 for (i = 0; i < strlen(cmd\_buffer); i++) { if (\*(cmd\_buffer + i) == AT\_CMD\_QUESTION\_MARK || \*(cmd\_buffer + i) == AT\_CMD\_EQUAL\_MARK || \*(cmd\_buffer + i) == AT\_CMD\_CR || (\*(cmd\_buffer + i) >= AT\_CMD\_CHAR\_0 && \*(cmd\_buffer + i) <= AT\_CMD\_CHAR\_9)) { cmd\_name\_len = i; rt\_memcpy(cmd\_name, cmd\_buffer, cmd\_name\_len); /\* VULN: cmd\_buffer is AT\_SERVER\_RECV\_BUFF\_LEN bytes (256), while cmd\_name is only AT\_CMD\_NAME\_LEN bytes (16); therefore, it might be possible to overflow past the cmd\_name buffer with a carefully crafted cmd\_buffer \*/ \*(cmd\_name + cmd\_name\_len) = '\0';
 return RT\_EOK; } }
 return -RT\_ERROR;}```
Fixes:https://github.com/RT-Thread/rt-thread/commit/a8d5a645f2e26af67c8fe94e2c7f1726ae05cca7
See also:https://github.com/RT-Thread/rt-thread/issues/8288
--[ 3.8 - CVE-2024-25395 - Static buffer overflow in RT-Thread rt-link utility
We spotted a static buffer overflow vulnerability at the following locationin the RT-Thread rt-link utility source code:
\* /components/utilities/rt-link/src/rtlink.c
Lack of length check in the `frame\_send()` function could lead to a staticbuffer overflow at the marked line:```cstatic rt\_ssize\_t frame\_send(struct rt\_link\_frame \*frame){ rt\_size\_t length = 0; rt\_uint8\_t \*data = RT\_NULL;
 rt\_memset(rt\_link\_scb->sendbuffer, 0, sizeof(rt\_link\_scb->sendbuffer)); data = rt\_link\_scb->sendbuffer; length = RT\_LINK\_HEAD\_LENGTH; if (frame->head.crc) { length += RT\_LINK\_CRC\_LENGTH; } if (frame->head.extend) { length += RT\_LINK\_EXTEND\_LENGTH; }
 length += frame->data\_len; frame->head.length = frame->data\_len; rt\_memcpy(data, &frame->head, RT\_LINK\_HEAD\_LENGTH); data = data + RT\_LINK\_HEAD\_LENGTH; if (frame->head.extend) { rt\_memcpy(data, &frame->extend, RT\_LINK\_EXTEND\_LENGTH); data = data + RT\_LINK\_EXTEND\_LENGTH; } if (frame->attribute == RT\_LINK\_SHORT\_DATA\_FRAME || frame->attribute == RT\_LINK\_LONG\_DATA\_FRAME) { rt\_memcpy(data, frame->real\_data, frame->data\_len); /\* VULN: static buffer overflow, if frame->data\_len > 1024 - 4 (it's a rt\_uint16\_t so at least in theory can be up to 65535) \*/ data = data + frame->data\_len; } if (frame->head.crc) { frame->crc = rt\_link\_scb->calculate\_crc(RT\_FALSE, rt\_link\_scb->sendbuffer, length - RT\_LINK\_CRC\_LENGTH); rt\_memcpy(data, &frame->crc, RT\_LINK\_CRC\_LENGTH); }
 LOG\_D("frame send seq(%d) len(%d) attr:(%d), crc:(0x%08x).", frame->head.sequence, length, frame->attribute, frame->crc); return rt\_link\_hw\_send(rt\_link\_scb->sendbuffer, length);}```
See also:https://github.com/RT-Thread/rt-thread/issues/8289
--[ 3.9 - CVE-2024-25392 - Out-of-bounds static array access in RT-Thread var\_export utility
We spotted a potential out-of-bounds static array access at the followinglocation in the RT-Thread var\_export utility source code:
\* /components/utilities/var\_export/var\_export.c
Improper size check due to the use of `RT\_ASSERT()` in the`var\_export\_init()` function at the marked line, which if compiled out inproduction code could lead to multiple out-of-bounds `ve\_exporter\_tab`static array accesses in the next lines:```cint var\_export\_init(void){ /\* initialize the var export table.\*/#if defined(\_\_ARMCC\_VERSION) /\* for ARM C Compiler \*/ ve\_exporter\_table = &\_\_ve\_table\_start + 1; ve\_exporter\_num = &\_\_ve\_table\_end - &\_\_ve\_table\_start;#elif defined (\_\_IAR\_SYSTEMS\_ICC\_\_) /\* for IAR Compiler \*/ ve\_exporter\_table = &\_\_ve\_table\_start + 1; ve\_exporter\_num = &\_\_ve\_table\_end - &\_\_ve\_table\_start - 1;#elif defined (\_\_GNUC\_\_) /\* for GCC Compiler \*/ extern const int \_\_ve\_table\_start; extern const int \_\_ve\_table\_end; ve\_exporter\_table = (const ve\_exporter\_t \*)&\_\_ve\_table\_start; ve\_exporter\_num = (const ve\_exporter\_t \*)&\_\_ve\_table\_end - ve\_exporter\_table;#elif defined (\_MSC\_VER) /\* for MS VC++ compiler \*/ unsigned int \*ptr\_begin = (unsigned int \*)&\_\_ve\_table\_start; unsigned int \*ptr\_end = (unsigned int \*)&\_\_ve\_table\_end; static ve\_exporter\_t ve\_exporter\_tab[2048]; static char \_\_vexp\_strbuf1[1024]; static char \_\_vexp\_strbuf2[1024]; ve\_exporter\_t ve\_exporter\_temp; rt\_size\_t index\_i, index\_j;
 /\* past the three members in first ptr\_begin \*/ ptr\_begin += (sizeof(struct ve\_exporter) / sizeof(unsigned int)); while (\*ptr\_begin == 0) ptr\_begin++; do ptr\_end--; while (\*ptr\_end == 0);
 /\* Find var objects in custom segments to solve the problem of holes in objects in different files \*/ ve\_exporter\_num = ve\_init\_find\_obj(ptr\_begin, ptr\_end, ve\_exporter\_tab);
 /\* check if the ve\_exporter\_num is out of bounds \*/ RT\_ASSERT(ve\_exporter\_num < (sizeof(ve\_exporter\_tab) / sizeof(ve\_exporter\_t))); /\* VULN: size check is implemented via assertion \*/
 /\* bubble sort algorithms \*/ for (index\_i = 0; index\_i < (ve\_exporter\_num - 1); index\_i++) { for (index\_j = 0; index\_j < ((ve\_exporter\_num - 1) - index\_i); index\_j++) { /\* splice ve\_exporter's module and ve\_exporter's identifier into a complete string \*/ rt\_snprintf(\_\_vexp\_strbuf1, sizeof(\_\_vexp\_strbuf1), "%s%s", ve\_exporter\_tab[index\_j].module, ve\_exporter\_tab[index\_j].identifier); rt\_snprintf(\_\_vexp\_strbuf2, sizeof(\_\_vexp\_strbuf2), "%s%s", ve\_exporter\_tab[index\_j + 1].module, ve\_exporter\_tab[index\_j + 1].identifier); if (rt\_strcmp(\_\_vexp\_strbuf1, \_\_vexp\_strbuf2) > 0) { ve\_exporter\_temp = ve\_exporter\_tab[index\_j]; ve\_exporter\_tab[index\_j] = ve\_exporter\_tab[index\_j + 1]; ve\_exporter\_tab[index\_j + 1] = ve\_exporter\_temp; } } }
 ve\_exporter\_table = ve\_exporter\_tab;#endif /\* \_\_ARMCC\_VERSION \*/
 return ve\_exporter\_num;}```
See also:https://github.com/RT-Thread/rt-thread/issues/8290
--[ 3.10 - CVE-2024-25394 - Multiple vulnerabilities in RT-Thread ymodem utility
We spotted some potential vulnerabilities at the following location in theRT-Thread ymodem utility source code:
\* /components/utilities/ymodem/ry\_sy.c
Unbounded `rt\_sprintf()` in the `\_rym\_send\_begin()` function could lead toa buffer overflow at the marked line:```cstatic enum rym\_code \_rym\_send\_begin( struct rym\_ctx \*ctx, rt\_uint8\_t \*buf, rt\_size\_t len){ struct custom\_ctx \*cctx = (struct custom\_ctx \*)ctx; struct stat file\_buf; char insert\_0 = '\0'; rt\_err\_t err;
 cctx->fd = open(cctx->fpath, O\_RDONLY); if (cctx->fd < 0) { err = rt\_get\_errno(); rt\_kprintf("error open file: %d\n", err); return RYM\_ERR\_FILE; } rt\_memset(buf, 0, len); err = stat(cctx->fpath, &file\_buf); if (err != RT\_EOK) { rt\_kprintf("error open file.\n"); return RYM\_ERR\_FILE; }
 const char \*fdst = \_get\_path\_lastname(cctx->fpath); if(fdst != cctx->fpath) { fdst = dfs\_normalize\_path(RT\_NULL, fdst); if (fdst == RT\_NULL) { return RYM\_ERR\_FILE; } }
 rt\_sprintf((char \*)buf, "%s%c%d", fdst, insert\_0, file\_buf.st\_size); /\* VULN: if we can make fdst large enough, there's no bound checking \*/
 return RYM\_CODE\_SOH;}```
Lack of NUL-termination in the `rym\_download\_file()` function at the markedline:```cstatic rt\_err\_t rym\_download\_file(rt\_device\_t idev,const char \*file\_path){ rt\_err\_t res; struct custom\_ctx \*ctx = rt\_calloc(1, sizeof(\*ctx));
 if (!ctx) { rt\_kprintf("rt\_malloc failed\n"); return -RT\_ENOMEM; } ctx->fd = -1; rt\_strncpy(ctx->fpath, file\_path, DFS\_PATH\_MAX); /\* VULN: unterm if file\_path is at least DFS\_PATH\_MAX bytes (comes from argv); it might cause infoleak or memory corruption \*/ RT\_ASSERT(idev); res = rym\_recv\_on\_device(&ctx->parent, idev, RT\_DEVICE\_OFLAG\_RDWR | RT\_DEVICE\_FLAG\_INT\_RX, \_rym\_recv\_begin, \_rym\_recv\_data, \_rym\_recv\_end, 1000); rt\_free(ctx);
 return res;}```
Lack of NUL-termination in the `rym\_upload\_file()` function at the marked line:[View remainder of file in raw view](https://github.com/hnsecurity/vulns/raw/refs/heads/main/HNS-2024-05-rt-thread.txt)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


