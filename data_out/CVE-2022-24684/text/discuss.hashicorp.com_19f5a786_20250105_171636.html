

![HashiCorp Discuss](data:image/svg;base64...)
Loading

[HashiCorp Discuss](/)

# [HCSEC-2022-04 - Nomad Spread Job Stanza May Trigger Panic in Servers](/t/hcsec-2022-04-nomad-spread-job-stanza-may-trigger-panic-in-servers/35562)

[Security](/c/security/52)

[security-nomad](https://discuss.hashicorp.com/tag/security-nomad)

[jfinnigan](https://discuss.hashicorp.com/u/jfinnigan)

February 11, 2022, 1:18am

1

**Bulletin ID:** HCSEC-2022-04

**Affected Products / Versions:** Nomad and Nomad Enterprise 0.9.0 through 1.0.17, 1.1.11, and 1.2.5; fixed in 1.0.18, 1.1.12, and 1.2.6.

**Publication Date:** February 10, 2022

**Summary**

Nomad and Nomad Enterprise (“Nomad”) allows operators with job-submit capabilities to use the spread stanza in a way such that it can cause panic in Nomad servers. This vulnerability, CVE-2022-24684, was fixed in Nomad 1.0.18, 1.1.12, and 1.2.6.

**Background**

The [spread](https://www.nomadproject.io/docs/job-specification/spread) stanza within a Nomad job allows operators to increase the failure tolerance of their applications by specifying a node attribute that allocations should be spread over.

**Details**

It was observed that Nomad’s spread and update stanzas can be combined in such a way that it can cause panic in Nomad servers. Nomad’s logic has been modified to no longer allow this attack.

**Remediation**

Customers should evaluate the risk associated with this issue and consider upgrading to Nomad or Nomad Enterprise 1.0.18, 1.1.12, and 1.2.6, or newer. Please refer to [Upgrading Nomad](https://www.nomadproject.io/docs/upgrade) for general guidance and version-specific upgrade notes.

**Acknowledgement**

This issue was identified by an external party who reported it to HashiCorp.

*We deeply appreciate any effort to coordinate disclosure of security vulnerabilities. For information about security at HashiCorp and the reporting of security vulnerabilities, please see [Security at HashiCorp](https://hashicorp.com/security).*

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [HCSEC-2022-22 - Nomad Panics On Job Submission With Bad Artifact Stanza Source URL](https://discuss.hashicorp.com/t/hcsec-2022-22-nomad-panics-on-job-submission-with-bad-artifact-stanza-source-url/45420)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 5733 | October 10, 2022 |
| [HCSEC-2022-14 - Nomad Impacted by go-getter Vulnerabilities](https://discuss.hashicorp.com/t/hcsec-2022-14-nomad-impacted-by-go-getter-vulnerabilities/39932)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 6839 | May 24, 2022 |
| [HCSEC-2021-26 - Nomad Denial Of Service Via Submission Of Incomplete Job Specification Using Consul Mesh Gateway & Host Network](https://discuss.hashicorp.com/t/hcsec-2021-26-nomad-denial-of-service-via-submission-of-incomplete-job-specification-using-consul-mesh-gateway-host-network/30311)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 6568 | October 5, 2021 |
| [HCSEC-2020-21 - Nomad File Sandbox Escape via Template and Artifact Stanzas](https://discuss.hashicorp.com/t/hcsec-2020-21-nomad-file-sandbox-escape-via-template-and-artifact-stanzas/18106)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 4244 | November 25, 2020 |
| [HCSEC-2022-03 - Nomad Malformed Job Parsing Results in Excessive CPU Usage](https://discuss.hashicorp.com/t/hcsec-2022-03-nomad-malformed-job-parsing-results-in-excessive-cpu-usage/35561)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 7152 | February 11, 2022 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](https://meta.discourse.org/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled

