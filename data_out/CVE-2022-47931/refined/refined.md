The content is related to CVE-2022-47931.

**Root cause of vulnerability:**
The SHA256 hash function (referred to as SHA512_256 in the implementation) and its variants used a "$" separator when concatenating input values. This can lead to hash collisions if the input values also contain the "$" character.

**Weaknesses/vulnerabilities present:**
- Hash collisions due to the use of a simple separator ("$") during the concatenation of input values before hashing.
- SHA256/SHA512_256 not behaving like a random oracle due to the hash collisions.

**Impact of exploitation:**
- An attacker can craft malicious parameters leading to the potential compromise of shared secrets.
- Unauthorized access to sensitive data or manipulation of transactions.
- Disruption of the integrity and trustworthiness of the system.

**Attack vectors:**
- Crafting malicious input values that cause hash collisions.

**Required attacker capabilities/position:**
- Ability to manipulate inputs to the hash function.
- No specific privilege or position mentioned.

**Additional details:**
The vulnerability is located in the implementation of the SHA256 hash function where it concatenates input values with a “$” separator. This function is used in the computation of `V_i` in Round 1 of the “Auxiliary Info & Key Refresh in Three Rounds” protocol. The fix involves replacing the "$" separator with a unique delimiter and using length-prefixed encoding for input values.