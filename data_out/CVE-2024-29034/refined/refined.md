```
{
  "vulnerability_details": {
    "root_cause": "The vulnerability arises because the `carrierwave` library, when uploading files to object storage like Amazon S3, does not properly sanitize the `Content-Type` header, allowing multiple values separated by commas. This bypasses the `content_type_allowlist` and allows an attacker to set a malicious `Content-Type`.",
    "weaknesses": [
      "Improper input validation of the `Content-Type` header.",
      "Bypass of the content type allowlist due to the handling of comma separated values.",
      "Potential Cross-Site Scripting (XSS) vulnerability."
    ],
    "impact": "An attacker can set a malicious `Content-Type` header, potentially leading to XSS when a victim's browser interprets the manipulated Content-Type.",
    "attack_vectors": "By providing a crafted `Content-Type` header with multiple comma-separated values when uploading a file to object storage.",
    "required_capabilities": "Attacker needs to be able to upload files and manipulate the `Content-Type` header during the upload process. Low privileges are sufficient."
  },
  "additional_details": {
    "patches": "The vulnerability is addressed by upgrading `carrierwave` to versions 3.0.7 or 2.2.6. These versions introduce a fix that uses `Marcel::MimeType.for` to correctly parse the Content-Type, preventing the bypass.",
    "workarounds": "A monkey patch is provided to parse the `Content-Type` using `Marcel::MimeType.for` as a workaround for older versions. The patch is different for `carrierwave` versions 3.x and 2.x.",
    "cvss_metrics": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:N/A:N.  Attack vector is network, attack complexity is low, low privileges are needed, user interaction is required, scope is changed, confidentiality impact is high, with no integrity or availability impact.",
     "cwe": "No CWE is listed"
  }
}
```