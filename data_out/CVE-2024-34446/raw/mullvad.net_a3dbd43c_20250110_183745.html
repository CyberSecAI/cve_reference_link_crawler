<!doctype html>
<html lang="en" dir="ltr" class="no-js">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="/favicon.ico" sizes="any" />
    <link rel="icon" href="../../favicon.svg" type="image/svg+xml" />
    <link rel="apple-touch-icon" sizes="180x180" href="../../apple-touch-icon.png" />
    <link rel="manifest" href="../../manifest.json" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#192e45" />

    
		<link href="../../_app/immutable/assets/2.o-dAB9xP.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/index.BSq50-E-.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/BButton.BK1rhPs3.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/cms.DsqcTn_C.css" rel="stylesheet"><title>DNS traffic can leak outside the VPN tunnel on Android | Mullvad VPN</title><!-- HEAD_svelte-h2j8qd_START --><meta property="og:title" content="DNS traffic can leak outside the VPN tunnel on Android | Mullvad VPN"><meta property="og:description" name="description" content="We were recently made aware of multiple potential DNS leaks on Android. They stem from bugs in Android itself, and only affect certain apps."><meta property="og:image" content="https://mullvad.net/press/MullvadVPN_logo_Round_RGB_Color_positive.png"><meta property="og:site_name" content="Mullvad VPN"><meta property="og:type" content="website"><meta property="og:url" content="https://mullvad.net/en/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://mullvad.net/en/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android"><link rel="alternate" hreflang="ar" href="https://mullvad.net/ar/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android"><link rel="alternate" hreflang="da" href="https://mullvad.net/da/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android"><link rel="alternate" hreflang="de" href="https://mullvad.net/de/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android"><link rel="alternate" hreflang="en" href="https://mullvad.net/en/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android"><link rel="alternate" hreflang="es" href="https://mullvad.net/es/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android"><link rel="alternate" hreflang="fa" href="https://mullvad.net/fa/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android"><link rel="alternate" hreflang="fi" href="https://mullvad.net/fi/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android"><link rel="alternate" hreflang="fr" href="https://mullvad.net/fr/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android"><link rel="alternate" hreflang="it" href="https://mullvad.net/it/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android"><link rel="alternate" hreflang="ja" href="https://mullvad.net/ja/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android"><link rel="alternate" hreflang="ko" href="https://mullvad.net/ko/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android"><link rel="alternate" hreflang="nl" href="https://mullvad.net/nl/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android"><link rel="alternate" hreflang="no" href="https://mullvad.net/no/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android"><link rel="alternate" hreflang="pl" href="https://mullvad.net/pl/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android"><link rel="alternate" hreflang="pt" href="https://mullvad.net/pt/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android"><link rel="alternate" hreflang="ru" href="https://mullvad.net/ru/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android"><link rel="alternate" hreflang="sv" href="https://mullvad.net/sv/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android"><link rel="alternate" hreflang="th" href="https://mullvad.net/th/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android"><link rel="alternate" hreflang="tr" href="https://mullvad.net/tr/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android"><link rel="alternate" hreflang="zh-hans" href="https://mullvad.net/zh-hans/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android"><link rel="alternate" hreflang="zh-hant" href="https://mullvad.net/zh-hant/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android"> <link rel="alternate" hreflang="x-default" href="https://mullvad.net/en/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android"><!-- HEAD_svelte-h2j8qd_END --><!-- HEAD_svelte-1dn4tje_START --><!-- HTML_TAG_START -->
      <script type="application/ld+json">
      {"@context":"https://schema.org","@type":"BlogPosting","headline":"DNS traffic can leak outside the VPN tunnel on Android","description":"","keywords":["Privacy","App"],"datePublished":"2024-05-03T12:43:30.052367Z"}
    </script>
<!-- HTML_TAG_END --><!-- HEAD_svelte-1dn4tje_END -->

    <!-- Feeds -->
    <link
      rel="alternate"
      href="https://mullvad.net/blog/feed/atom/"
      type="application/atom+xml"
      title="Atom 0.3"
    />
    <link
      rel="alternate"
      href="https://mullvad.net/blog/feed/rss/"
      type="application/rss+xml"
      title="RSS"
    />

    <!--
    /**
    * @license
    * MyFonts Webfont Build ID 589797
    *
    * The fonts listed in this notice are subject to the End User License
    * Agreement(s) entered into by the website owner. All other parties are
    * explicitly restricted from using the Licensed Webfonts(s).
    *
    * You may obtain a valid license from one of MyFonts official sites.
    * http://www.fonts.com
    * http://www.myfonts.com
    * http://www.linotype.com
    *
    */
    -->
    <style>
      noscript {
        color: #fff;
        position: absolute;
        top: 6px;
        display: grid;
        place-items: center;
        width: 100%;
      }
    </style>
  </head>
  <body data-sveltekit-preload-data="hover">
    <noscript>This site needs Javascript for some functionality to work properly</noscript>
    <div style="display: contents">     <a href="#main" class="svelte-977a0k">Skip to main content</a>  <div class="wrapper svelte-awwzf1" data-cy="connection-bar" role="banner">Â </div> <div class="wrapper svelte-1j2ijdh"><nav aria-label="Primary" class="svelte-1j2ijdh"><div class="logo-wrapper svelte-1j2ijdh"><a href="/en/" class="logo svelte-1j2ijdh"><img src="/_app/immutable/assets/logo.Ba5MUFAA.svg" alt="Mullvad logo, to the homepage" width="150" height="40" class="svelte-1j2ijdh"></a></div> <ul class="navbar-menu svelte-1j2ijdh"><li class="svelte-1j2ijdh"><a href="/en/about" class="svelte-1j2ijdh">About</a></li> <li class="svelte-1j2ijdh"> <a class="has-submenu svelte-1j2ijdh" href="#">Products</a> <ul class="svelte-1j2ijdh"><li class="svelte-1j2ijdh"><a href="/en/vpn" class="svelte-1j2ijdh">VPN</a></li> <li class="svelte-1j2ijdh"><a href="/en/browser" class="svelte-1j2ijdh">Browser</a></li> <li class="svelte-1j2ijdh"><a href="https://leta.mullvad.net" class="svelte-1j2ijdh">Search</a></li> <li class="svelte-1j2ijdh"><a href="/en/help/dns-over-https-and-dns-over-tls" class="svelte-1j2ijdh">Encrypted DNS</a></li> <li class="svelte-1j2ijdh"><a href="/en/help/mullvad-browser-extension" class="svelte-1j2ijdh">Browser Extension</a></li></ul></li> <li class="svelte-1j2ijdh"><a aria-current="page" href="/en/blog" class="svelte-1j2ijdh">Blog</a></li> <li class="svelte-1j2ijdh"><a href="/en/pricing" class="svelte-1j2ijdh">Pricing</a></li> <li class="svelte-1j2ijdh"><a href="/en/servers" class="svelte-1j2ijdh">Servers</a></li> <li class="svelte-1j2ijdh"><a href="/en/download" class="svelte-1j2ijdh">Downloads</a></li> <li class="svelte-1j2ijdh"><a href="/en/help" class="svelte-1j2ijdh">Help</a></li></ul> <div class="account-menu svelte-1j2ijdh">  <a data-sveltekit-preload-data="off" href="/en/account" class="svelte-1j2ijdh">Account</a>  <a href="/en/account/create" class="warning md button svelte-2352pg">Get started </a></div></nav> </div> <div class="modal-overlay svelte-1nebqmw" aria-hidden="true"></div> <main id="main" class="svelte-1nebqmw"> <div class="cms"><article class="container narrow"> <h1>DNS traffic can leak outside the VPN tunnel on Android</h1> <p><time datetime="2024-05-03T12:43:30.052Z">May 3, 2024</time> <a class="tag" href="/en/blog/tag/privacy">Privacy</a>Â <a class="tag" href="/en/blog/tag/app">App</a>Â </p>  <div><!-- HTML_TAG_START --><p>We were recently made aware of multiple potential DNS leaks on Android. They stem from bugs in Android itself, and only affect certain apps.</p>
<p>On Monday 22 of April we became aware of a <a href="https://www.reddit.com/r/mullvadvpn/comments/1c9p96y/dns_leak_with_block_connections_without_vpn_on/">user report on Reddit</a> of a <a href="https://en.wikipedia.org/wiki/DNS_leak">DNS leak</a>. The report detailed how the user managed to leak DNS queries when disabling and enabling VPN while having &ldquo;Block connections without VPN&rdquo; on. We immediately started an internal investigation that could confirm the issue. The investigation also led to more findings of scenarios that can cause DNS leaks on Android.</p>
<h3>Findings</h3>
<p>Identified scenarios where the Android OS can leak DNS traffic:</p>
<ul>
<li>If a VPN is active without any DNS server configured.</li>
<li>For a short period of time while a VPN app is re-configuring the tunnel or is being force stopped/crashes.</li>
</ul>
<p>The leaks seem to be limited to direct calls to the C function <code>getaddrinfo</code>. Apps that use this way to resolve domain names cause leaks in the scenarios listed above. We have not found any leaks from apps that only use Android API:s such as <a href="https://developer.android.com/reference/android/net/DnsResolver" rel="nofollow">DnsResolver</a>. The Chrome browser is an example of an app that can use <code>getaddrinfo</code> <a href="https://source.chromium.org/chromium/chromium/src/+/main:android_webview/browser/aw_pac_processor.cc;l=197;drc=133b2d903fa57cfda1317bc589b349cf4c284b7c" rel="nofollow">directly</a>.</p>
<p>The above applies regardless of whether <em>Always-on VPN</em> and <em>Block connections without VPN</em> is enabled or not, which is not expected OS behavior and should therefore be fixed upstream in the OS.</p>
<p>We&rsquo;ve been able to confirm that these leaks occur in multiple versions of Android, including the latest version (Android 14).</p>
<h3>Improvements</h3>
<p>Our app currently does not set any DNS server in its blocking state. When our app fails to set up a tunnel in a way that is not recoverable, it enters the blocking state. In this state it stops traffic from leaving the device. However, it does not set any DNS server in this state, and as a result the above described DNS leaks can happen. We will work around the OS bug by setting a bogus DNS server for now. You can expect a release with this fix soon.</p>
<p>The leak during tunnel reconnects is harder for us to mitigate in our app. We are still looking for solutions. We can potentially minimize the amount of times a tunnel re-configuration happens, but we currently don&rsquo;t think this leak can be fully prevented.</p>
<p>It should be made clear that these workarounds should not be needed in any VPN app. Nor is it wrong for an app to use <code>getaddrinfo</code> to resolve domain names. Instead, these issues should be addressed in the OS in order to protect all Android users regardless of which apps they use.</p>
<p>We have reported <a href="https://issuetracker.google.com/issues/337961996" rel="nofollow">the issues and suggested improvements</a> to Google and hope that they will address this quickly.</p>
<h3>Steps to reproduce</h3>
<p>The following steps reproduce the second scenario above, where a VPN user changes the tunnel configuration, e.g. switching to another server or changing DNS server.</p>
<p>Here we use the WireGuard app since it has become a reference Android VPN implementation. It should be noted that the leaks can probably be reproduced with any other Android VPN app also. We use Chrome to trigger the leaks since it is one of the apps we have confirmed uses <code>getaddrinfo</code>.</p>
<ol>
<li>Download <a href="/media/uploads/2024/05/03/spam_get_requests.html">spam_get_requests.html</a></li>
<li>Install the WireGuard app &amp; Chrome</li>
<li>Import <a href="/media/uploads/2024/05/03/wg1.conf">wg1.conf</a>, <a href="/media/uploads/2024/05/03/wg2.conf">wg2.conf</a> into WireGuard</li>
<li>Enable the wg1 tunnel in the WireGuard app and allow the VPN permission</li>
<li>In Android VPN Settings enable &ldquo;Always-on VPN&rdquo; &amp; &ldquo;Block connections without VPN&rdquo; for WireGuard</li>
<li>Start capturing data on your router by using e.g <code>tcpdump</code><br><code>$ tcpdump -i &lt;INTERFACE&gt; host &lt;IP of android device&gt;</code></li>
<li>Split the screen to show both WireGuard &amp; Chrome side by side</li>
<li>Open <code>spam_get_requests.html</code> with Chrome &amp; press &ldquo;Start&rdquo;</li>
<li>Toggle back and fourth between wg1 and wg2 in the WireGuard app until you see the leaks in the next step.</li>
<li>Observe DNS traffic similar to this on the router:
<pre>11:50:27.816359 IP Pixel-Tablet.lan.53353 &gt; OpenWrt.lan.53: 11200+ A? 307lf5rgn6-19282-11-50-27-519z.mullvad.test.lan. (65)<br>11:50:27.816359 IP Pixel-Tablet.lan.48267 &gt; OpenWrt.lan.53: 44347+ A? 307lf5rgn6-19284-11-50-27-579z.mullvad.test.lan. (65)<br>11:50:27.816396 IP Pixel-Tablet.lan.16747 &gt; OpenWrt.lan.53: 44584+ A? 307lf5rgn6-19289-11-50-27-729z.mullvad.test. (61)<br>11:50:27.816458 IP OpenWrt.lan.53 &gt; Pixel-Tablet.lan.53353: 11200 NXDomain 0/0/0 (65)<br>11:50:27.816476 IP Pixel-Tablet.lan.45727 &gt; OpenWrt.lan.53: 40503+ A? 307lf5rgn6-19290-11-50-27-759z.mullvad.test. (61)<br>11:50:27.816542 IP OpenWrt.lan.53 &gt; Pixel-Tablet.lan.48267: 44347 NXDomain 0/0/0 (65)<br>11:50:27.816588 IP Pixel-Tablet.lan.43821 &gt; OpenWrt.lan.53: 36295+ A? 307lf5rgn6-19291-11-50-27-789z.mullvad.test. (61) 
11:50:27.816625 IP OpenWrt.lan.53 &gt; Pixel-Tablet.lan.16747: 44584 NXDomain 0/0/0 (61)</pre>
</li>
</ol>
<p>Since &ldquo;Block connections without VPN&rdquo; was active, nothing except encrypted WireGuard traffic should have left the device, but here we see plaintext DNS leaving the device.</p>
<h3>Conclusions and recommendations</h3>
<p>DNS leaks may have serious privacy implications for users, and can be used to derive users' approximate location or find out what websites and services a user uses.</p>
<p>These finding also shows once again that &ldquo;Block connections without VPN&rdquo; does not live up to its name (or documentation) and that it has multiple flaws. Apps may still leak DNS traffic during the conditions mentioned above, and as <a href="/en/blog/android-leaks-connectivity-check-traffic">previously reported</a> it still leaks connection check traffic.</p>
<p>Depending on your threat model this might mean that you should avoid using Android altogether for anything sensitive, or employ other mitigations to prevent the leaks. We aim to partially mitigate these problems in our app, so make sure to keep the app up-to-date.</p><!-- HTML_TAG_END --></div></article></div></main> <footer class="svelte-182rj3l"><div><h2 class="svelte-182rj3l" data-svelte-h="svelte-hmk3fx">Mullvad</h2> <nav aria-label="Secondary"><ul class="svelte-182rj3l"><li class="svelte-182rj3l"><a href="/en/about" class="svelte-182rj3l">About</a> </li><li class="svelte-182rj3l"><a href="/en/help" class="svelte-182rj3l">Help</a> </li><li class="svelte-182rj3l"><a href="/en/servers" class="svelte-182rj3l">Servers</a> </li><li class="svelte-182rj3l"><a href="/en/pricing" class="svelte-182rj3l">Pricing</a> </li><li class="svelte-182rj3l"><a href="/en/blog" class="svelte-182rj3l">Blog</a> </li> <li class="svelte-182rj3l"><a href="/en/vpn" class="svelte-182rj3l">Mullvad VPN</a></li> <li class="svelte-182rj3l"><a href="/en/browser" class="svelte-182rj3l">Mullvad Browser</a></li> <li class="svelte-182rj3l"><a href="/en/why-privacy-matters" class="svelte-182rj3l">Why privacy matters</a> </li><li class="svelte-182rj3l"><a href="/en/why-mullvad-vpn" class="svelte-182rj3l">Why Mullvad VPN?</a> </li><li class="svelte-182rj3l"><a href="/en/vpn/what-is-vpn" class="svelte-182rj3l">What is a VPN?</a> </li><li class="svelte-182rj3l"><a href="/en/download" class="svelte-182rj3l">Downloads</a> </li><li class="svelte-182rj3l"><a href="/en/chatcontrol" class="svelte-182rj3l">Stop chat control</a> </li><li class="svelte-182rj3l"><a href="/en/press" class="svelte-182rj3l">Press</a> </li> <li class="svelte-182rj3l"><a href="https://www.mullvad.careers/" target="_blank" rel="noreferrer" class="centered svelte-182rj3l">Jobs <svg width="1em" height="1em" viewBox="0 0 512 512"><path fill="currentColor" d="M432 320h-32a16 16 0 0 0-16 16v112H64V128h144a16 16 0 0 0 16-16V80a16 16 0 0 0-16-16H48a48 48 0 0 0-48 48v352a48 48 0 0 0 48 48h352a48 48 0 0 0 48-48V336a16 16 0 0 0-16-16ZM488 0H360c-21.37 0-32.05 25.91-17 41l35.73 35.73L135 320.37a24 24 0 0 0 0 34L157.67 377a24 24 0 0 0 34 0l243.61-243.68L471 169c15 15 41 4.5 41-17V24a24 24 0 0 0-24-24Z"></path></svg></a></li></ul></nav></div> <div><h2 class="svelte-182rj3l">Policies</h2> <nav aria-label="Policies"><ul class="svelte-182rj3l"><li class="svelte-182rj3l"><a href="/en/policies" class="svelte-182rj3l">Policies</a> </li><li class="svelte-182rj3l"><a href="/en/open-source" class="svelte-182rj3l">Open source</a> </li><li class="svelte-182rj3l"><a href="/en/help/privacy-policy" class="svelte-182rj3l">Privacy policy</a> </li><li class="svelte-182rj3l"><a href="/en/help/cookie-policy" class="svelte-182rj3l">Cookies</a> </li><li class="svelte-182rj3l"><a href="/en/help/terms-service" class="svelte-182rj3l">Terms of service</a> </li><li class="svelte-182rj3l"><a href="/en/help/partnerships-and-resellers" class="svelte-182rj3l">Partnerships and resellers</a> </li><li class="svelte-182rj3l"><a href="/en/help/policy-reviews-advertising-and-affiliates" class="svelte-182rj3l">Reviews, ads and affiliates</a> </li><li class="svelte-182rj3l"><a href="/en/help/how-report-bug-or-vulnerability" class="svelte-182rj3l">Reporting a bug or vulnerability</a> </li></ul></nav></div> <div><h2 class="svelte-182rj3l">Address</h2> <address class="svelte-182rj3l"><p class="svelte-182rj3l" data-svelte-h="svelte-i07v64">Mullvad VPN AB</p> <p class="svelte-182rj3l" data-svelte-h="svelte-kt8wju">Box 53049</p> <p class="svelte-182rj3l" data-svelte-h="svelte-r8h7ew">400 14 Gothenburg</p> <p class="svelte-182rj3l" data-svelte-h="svelte-b84ib4">Sweden</p> <p class="svelte-182rj3l"><a href="mailto:support@mullvadvpn.net" class="svelte-182rj3l"><svg width="1em" height="1em" viewBox="0 0 512 512"><path fill="currentColor" d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7c22.4 17.4 52.1 39.5 154.1 113.6c21.1 15.4 56.7 47.8 92.2 47.6c35.7.3 72-32.8 92.3-47.6c102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4c132.7-96.3 142.8-104.7 173.4-128.7c5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9c30.6 23.9 40.7 32.4 173.4 128.7c16.8 12.2 50.2 41.8 73.4 41.4z"></path></svg>
          support@mullvadvpn.net</a></p></address> <ul class="icon-list svelte-182rj3l"><li class="svelte-182rj3l"><a href="/static/gpg/mullvadvpn-support-mail.asc" class="svelte-182rj3l"><svg width="1em" height="1em" viewBox="0 0 512 512"><path fill="currentColor" d="M512 176.001C512 273.203 433.202 352 336 352c-11.22 0-22.19-1.062-32.827-3.069l-24.012 27.014A23.999 23.999 0 0 1 261.223 384H224v40c0 13.255-10.745 24-24 24h-40v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24v-78.059c0-6.365 2.529-12.47 7.029-16.971l161.802-161.802C163.108 213.814 160 195.271 160 176C160 78.798 238.797.001 335.999 0C433.488-.001 512 78.511 512 176.001zM336 128c0 26.51 21.49 48 48 48s48-21.49 48-48s-21.49-48-48-48s-48 21.49-48 48z"></path></svg> GPG key</a></li> <li class="svelte-182rj3l"><a class="onion-link svelte-182rj3l" href="http://o54hon2e2vj6c7m3aqqu6uyece65by3vgoxxhlqlsvkmacw6a7m7kiad.onion" target="_blank" rel="noreferrer"><svg width="1em" height="1em" viewBox="0 0 180 180" fill="currentColor"><path d="M90.1846205,163.631147 L90.1846205,152.721073 C124.743583,152.621278 152.726063,124.581416 152.726063,89.9975051 C152.726063,55.4160892 124.743583,27.3762266 90.1846205,27.2764318 L90.1846205,16.366358 C130.768698,16.4686478 163.633642,49.3909741 163.633642,89.9975051 C163.633642,130.606531 130.768698,163.531352 90.1846205,163.631147 Z M90.1846205,125.444642 C109.677053,125.342352 125.454621,109.517381 125.454621,89.9975051 C125.454621,70.4801242 109.677053,54.6551533 90.1846205,54.5528636 L90.1846205,43.6452847 C115.704663,43.7450796 136.364695,64.4550091 136.364695,89.9975051 C136.364695,115.542496 115.704663,136.252426 90.1846205,136.35222 L90.1846205,125.444642 Z M90.1846205,70.9167267 C100.640628,71.0165216 109.090758,79.5165493 109.090758,89.9975051 C109.090758,100.480956 100.640628,108.980984 90.1846205,109.080778 L90.1846205,70.9167267 Z M0,89.9975051 C0,139.705328 40.2921772,180 90,180 C139.705328,180 180,139.705328 180,89.9975051 C180,40.2921772 139.705328,0 90,0 C40.2921772,0 0,40.2921772 0,89.9975051 Z"></path></svg> Onion service</a></li></ul></div> <div><h2 class="svelte-182rj3l">Follow us</h2> <nav aria-label="Social" class="svelte-182rj3l"><ul class="icon-list svelte-182rj3l"><li class="svelte-182rj3l"><a href="https://www.x.com/mullvadnet" rel="me nofollow" target="_blank" class="svelte-182rj3l"><svg xmlns="http://www.w3.org/2000/svg" width="0.88em" height="1em" viewBox="0 0 448 512"><path fill="currentColor" d="M64 32C28.7 32 0 60.7 0 96v320c0 35.3 28.7 64 64 64h320c35.3 0 64-28.7 64-64V96c0-35.3-28.7-64-64-64H64zm297.1 84L257.3 234.6L379.4 396h-95.6L209 298.1L123.3 396H75.8l111-126.9L69.7 116h98l67.7 89.5l78.2-89.5h47.5zm-37.8 251.6L153.4 142.9h-28.3l171.8 224.7h26.3z"></path></svg>
            @mullvadnet</a></li> <li class="svelte-182rj3l"><a href="https://mastodon.online/@mullvadnet" rel="me nofollow" target="_blank" class="svelte-182rj3l"><svg width="0.88em" height="1em" viewBox="0 0 448 512"><path fill="currentColor" d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7c-62.52-28.7-228.56-28.4-290.48 0c0 0-63.72 28.5-63.72 125.7c0 115.7-6.6 259.4 105.63 289.1c40.51 10.7 75.32 13 103.33 11.4c50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.54 102.54 0 0 1-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7c56.12-6.7 105-41.3 111.23-72.9c9.8-49.8 9-121.5 9-121.5zm-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175c25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5l11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1c23.71 27.3 18.4 53 18.4 175z"></path></svg>
            @mullvadnet</a></li> <li class="svelte-182rj3l"><a href="https://www.youtube.com/c/MullvadVPNNet" rel="me nofollow" target="_blank" class="svelte-182rj3l"><svg width="0.88em" height="1em" viewBox="0 0 448 512"><path fill="currentColor" d="m186.8 202.1l95.2 54.1l-95.2 54.1V202.1zM448 80v352c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V80c0-26.5 21.5-48 48-48h352c26.5 0 48 21.5 48 48zm-42 176.3s0-59.6-7.6-88.2c-4.2-15.8-16.5-28.2-32.2-32.4C337.9 128 224 128 224 128s-113.9 0-142.2 7.7c-15.7 4.2-28 16.6-32.2 32.4c-7.6 28.5-7.6 88.2-7.6 88.2s0 59.6 7.6 88.2c4.2 15.8 16.5 27.7 32.2 31.9C110.1 384 224 384 224 384s113.9 0 142.2-7.7c15.7-4.2 28-16.1 32.2-31.9c7.6-28.5 7.6-88.1 7.6-88.1z"></path></svg>
            Mullvad VPN</a></li> <li class="svelte-182rj3l"><a href="https://github.com/mullvad" rel="me nofollow" target="_blank" class="svelte-182rj3l"><svg width="0.88em" height="1em" viewBox="0 0 448 512"><path fill="currentColor" d="M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zM277.3 415.7c-8.4 1.5-11.5-3.7-11.5-8c0-5.4.2-33 .2-55.3c0-15.6-5.2-25.5-11.3-30.7c37-4.1 76-9.2 76-73.1c0-18.2-6.5-27.3-17.1-39c1.7-4.3 7.4-22-1.7-45c-13.9-4.3-45.7 17.9-45.7 17.9c-13.2-3.7-27.5-5.6-41.6-5.6c-14.1 0-28.4 1.9-41.6 5.6c0 0-31.8-22.2-45.7-17.9c-9.1 22.9-3.5 40.6-1.7 45c-10.6 11.7-15.6 20.8-15.6 39c0 63.6 37.3 69 74.3 73.1c-4.8 4.3-9.1 11.7-10.6 22.3c-9.5 4.3-33.8 11.7-48.3-13.9c-9.1-15.8-25.5-17.1-25.5-17.1c-16.2-.2-1.1 10.2-1.1 10.2c10.8 5 18.4 24.2 18.4 24.2c9.7 29.7 56.1 19.7 56.1 19.7c0 13.9.2 36.5.2 40.6c0 4.3-3 9.5-11.5 8c-66-22.1-112.2-84.9-112.2-158.3c0-91.8 70.2-161.5 162-161.5S388 165.6 388 257.4c.1 73.4-44.7 136.3-110.7 158.3zm-98.1-61.1c-1.9.4-3.7-.4-3.9-1.7c-.2-1.5 1.1-2.8 3-3.2c1.9-.2 3.7.6 3.9 1.9c.3 1.3-1 2.6-3 3zm-9.5-.9c0 1.3-1.5 2.4-3.5 2.4c-2.2.2-3.7-.9-3.7-2.4c0-1.3 1.5-2.4 3.5-2.4c1.9-.2 3.7.9 3.7 2.4zm-13.7-1.1c-.4 1.3-2.4 1.9-4.1 1.3c-1.9-.4-3.2-1.9-2.8-3.2c.4-1.3 2.4-1.9 4.1-1.5c2 .6 3.3 2.1 2.8 3.4zm-12.3-5.4c-.9 1.1-2.8.9-4.3-.6c-1.5-1.3-1.9-3.2-.9-4.1c.9-1.1 2.8-.9 4.3.6c1.3 1.3 1.8 3.3.9 4.1zm-9.1-9.1c-.9.6-2.6 0-3.7-1.5s-1.1-3.2 0-3.9c1.1-.9 2.8-.2 3.7 1.3c1.1 1.5 1.1 3.3 0 4.1zm-6.5-9.7c-.9.9-2.4.4-3.5-.6c-1.1-1.3-1.3-2.8-.4-3.5c.9-.9 2.4-.4 3.5.6c1.1 1.3 1.3 2.8.4 3.5zm-6.7-7.4c-.4.9-1.7 1.1-2.8.4c-1.3-.6-1.9-1.7-1.5-2.6c.4-.6 1.5-.9 2.8-.4c1.3.7 1.9 1.8 1.5 2.6z"></path></svg>
            mullvad</a></li></ul></nav> <h2 class="svelte-182rj3l">Language</h2> <div class="selector svelte-1ka9qva" data-cy="language-select"><button aria-haspopup="true" aria-controls="dropdown-menu" type="button" class="svelte-1ka9qva"><span class="dropdown-button-label svelte-1ka9qva"><svg xmlns="http://www.w3.org/2000/svg" width="0.97em" height="1em" viewBox="0 0 496 512"><path fill="currentColor" d="M248 8C111.03 8 0 119.03 0 256s111.03 248 248 248s248-111.03 248-248S384.97 8 248 8zm82.29 357.6c-3.9 3.88-7.99 7.95-11.31 11.28c-2.99 3-5.1 6.7-6.17 10.71c-1.51 5.66-2.73 11.38-4.77 16.87l-17.39 46.85c-13.76 3-28 4.69-42.65 4.69v-27.38c1.69-12.62-7.64-36.26-22.63-51.25c-6-6-9.37-14.14-9.37-22.63v-32.01c0-11.64-6.27-22.34-16.46-27.97c-14.37-7.95-34.81-19.06-48.81-26.11c-11.48-5.78-22.1-13.14-31.65-21.75l-.8-.72a114.792 114.792 0 0 1-18.06-20.74c-9.38-13.77-24.66-36.42-34.59-51.14c20.47-45.5 57.36-82.04 103.2-101.89l24.01 12.01C203.48 89.74 216 82.01 216 70.11v-11.3c7.99-1.29 16.12-2.11 24.39-2.42l28.3 28.3c6.25 6.25 6.25 16.38 0 22.63L264 112l-10.34 10.34c-3.12 3.12-3.12 8.19 0 11.31l4.69 4.69c3.12 3.12 3.12 8.19 0 11.31l-8 8a8.008 8.008 0 0 1-5.66 2.34h-8.99c-2.08 0-4.08.81-5.58 2.27l-9.92 9.65a8.008 8.008 0 0 0-1.58 9.31l15.59 31.19c2.66 5.32-1.21 11.58-7.15 11.58h-5.64c-1.93 0-3.79-.7-5.24-1.96l-9.28-8.06a16.017 16.017 0 0 0-15.55-3.1l-31.17 10.39a11.95 11.95 0 0 0-8.17 11.34c0 4.53 2.56 8.66 6.61 10.69l11.08 5.54c9.41 4.71 19.79 7.16 30.31 7.16s22.59 27.29 32 32h66.75c8.49 0 16.62 3.37 22.63 9.37l13.69 13.69a30.503 30.503 0 0 1 8.93 21.57a46.536 46.536 0 0 1-13.72 32.98zM417 274.25c-5.79-1.45-10.84-5-14.15-9.97l-17.98-26.97a23.97 23.97 0 0 1 0-26.62l19.59-29.38c2.32-3.47 5.5-6.29 9.24-8.15l12.98-6.49C440.2 193.59 448 223.87 448 256c0 8.67-.74 17.16-1.82 25.54L417 274.25z"></path></svg>English</span> <svg xmlns="http://www.w3.org/2000/svg" width="0.63em" height="1em" viewBox="0 0 320 512"><path fill="currentColor" d="M143 352.3L7 216.3c-9.4-9.4-9.4-24.6 0-33.9l22.6-22.6c9.4-9.4 24.6-9.4 33.9 0l96.4 96.4l96.4-96.4c9.4-9.4 24.6-9.4 33.9 0l22.6 22.6c9.4 9.4 9.4 24.6 0 33.9l-136 136c-9.2 9.4-24.4 9.4-33.8 0z"></path></svg></button> <ul class="dropdown svelte-1ka9qva" id="dropdown-menu" data-cy="language-menu"><li><a href="/en/setlocale/ar?page=/en/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android" data-sveltekit-preload-data="off" class="svelte-1ka9qva">Ø§ÙØ¹Ø±Ø¨ÙÙØ©</a> </li><li><a href="/en/setlocale/da?page=/en/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android" data-sveltekit-preload-data="off" class="svelte-1ka9qva">Dansk</a> </li><li><a href="/en/setlocale/de?page=/en/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android" data-sveltekit-preload-data="off" class="svelte-1ka9qva">Deutsch</a> </li><li><a href="/en/setlocale/en?page=/en/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android" data-sveltekit-preload-data="off" class="svelte-1ka9qva active">English</a> </li><li><a href="/en/setlocale/es?page=/en/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android" data-sveltekit-preload-data="off" class="svelte-1ka9qva">EspaÃ±ol</a> </li><li><a href="/en/setlocale/fa?page=/en/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android" data-sveltekit-preload-data="off" class="svelte-1ka9qva">ÙØ§Ø±Ø³Û</a> </li><li><a href="/en/setlocale/fi?page=/en/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android" data-sveltekit-preload-data="off" class="svelte-1ka9qva">Suomi</a> </li><li><a href="/en/setlocale/fr?page=/en/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android" data-sveltekit-preload-data="off" class="svelte-1ka9qva">FranÃ§ais</a> </li><li><a href="/en/setlocale/it?page=/en/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android" data-sveltekit-preload-data="off" class="svelte-1ka9qva">Italiano</a> </li><li><a href="/en/setlocale/ja?page=/en/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android" data-sveltekit-preload-data="off" class="svelte-1ka9qva">æ¥æ¬èª</a> </li><li><a href="/en/setlocale/ko?page=/en/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android" data-sveltekit-preload-data="off" class="svelte-1ka9qva">íêµ­ì´</a> </li><li><a href="/en/setlocale/nl?page=/en/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android" data-sveltekit-preload-data="off" class="svelte-1ka9qva">Nederlands</a> </li><li><a href="/en/setlocale/no?page=/en/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android" data-sveltekit-preload-data="off" class="svelte-1ka9qva">Norsk</a> </li><li><a href="/en/setlocale/pl?page=/en/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android" data-sveltekit-preload-data="off" class="svelte-1ka9qva">Polski</a> </li><li><a href="/en/setlocale/pt?page=/en/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android" data-sveltekit-preload-data="off" class="svelte-1ka9qva">PortuguÃªs</a> </li><li><a href="/en/setlocale/ru?page=/en/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android" data-sveltekit-preload-data="off" class="svelte-1ka9qva">Ð ÑÑÑÐºÐ¸Ð¹</a> </li><li><a href="/en/setlocale/sv?page=/en/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android" data-sveltekit-preload-data="off" class="svelte-1ka9qva">Svenska</a> </li><li><a href="/en/setlocale/th?page=/en/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android" data-sveltekit-preload-data="off" class="svelte-1ka9qva">à¸ à¸²à¸©à¸²à¹à¸à¸¢</a> </li><li><a href="/en/setlocale/tr?page=/en/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android" data-sveltekit-preload-data="off" class="svelte-1ka9qva">TÃ¼rkÃ§e</a> </li><li><a href="/en/setlocale/zh-hans?page=/en/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android" data-sveltekit-preload-data="off" class="svelte-1ka9qva">ç®ä½ä¸­æ</a> </li><li><a href="/en/setlocale/zh-hant?page=/en/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android" data-sveltekit-preload-data="off" class="svelte-1ka9qva">ç¹é«ä¸­æ</a> </li></ul> </div></div> </footer>  
			
			<script nonce="HyWehfIKvBziZcblhfiFkw==">
				{
					__sveltekit_p9ba9h = {
						base: new URL("../..", location).pathname.slice(0, -1),
						env: {"PUBLIC_CONNCHECK_URL":"am.i.mullvad.net","PUBLIC_ONION_ENABLED_PAYMENTS":"bitcoin,bitcoincash,monero,cash,voucher","PUBLIC_STRIPE_PK":"pk_live_b1GfXgTHZdUWAxjCVLovCNiS00DbtkXpS8","PUBLIC_BROWSER_DOWNLOAD_URL":"https://cdn.mullvad.net","PUBLIC_PAYPAL_CLIENT_ID":"Acu_ChEo8kkLvOoeLDoJVreFAkWpZe5jZuqUnTrlcucGgCN9sIt_Bzby6q9vgQAU-D4TZfPR1BhUS9wR","PUBLIC_ORIGIN":"https://mullvad.net","PUBLIC_HCAPTCHA_SITEKEY":"6acaff7a-c9e1-467a-8106-e9290bda294a","PUBLIC_LET_IT_SNOW":"false","PUBLIC_PAYPAL_URL_V2":"https://www.paypal.com/sdk/js","PUBLIC_APP_DOWNLOAD_URL":"https://cdn.mullvad.net/app"}
					};

					const element = document.currentScript.parentElement;

					Promise.all([
						import("../../_app/immutable/entry/start.ClmqlsD0.js"),
						import("../../_app/immutable/entry/app.NAPL7alM.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 2, 12, 106],
							data: [null,{"type":"data","data":{locale:"en",me:void 0,settings:void 0,metadata:void 0,statusMessages:[]},"uses":{"route":1}},{"type":"data","data":{postsArchive:[{year:"2025",count:2},{year:"2024",count:29},{year:"2023",count:27},{year:"2022",count:31},{year:"2021",count:52},{year:"2020",count:54},{year:"2019",count:58},{year:"2018",count:59},{year:"2017",count:52},{year:"2016",count:24},{year:"2015",count:24},{year:"2014",count:6},{year:"2013",count:9},{year:"2012",count:5},{year:"2011",count:7},{year:"2010",count:11}],tags:[{name:"News",slug:"news"},{name:"Features",slug:"features"},{name:"Privacy",slug:"privacy"},{name:"Mullvad community",slug:"mullvad-community"},{name:"System Transparency",slug:"system-transparency"},{name:"Inside Mullvad",slug:"inside-mullvad"},{name:"Privacy tips",slug:"privacy-tips"},{name:"External audits",slug:"audits"},{name:"App",slug:"app"},{name:"Browser",slug:"browser"},{name:"Security",slug:"security"},{name:"DNS",slug:"dns"}],query:""},"uses":{"search_params":["q"]}},{"type":"data","data":{post:{title:"DNS traffic can leak outside the VPN tunnel on Android",slug:"dns-traffic-can-leak-outside-the-vpn-tunnel-on-android",pub_date:"2024-05-03T12:43:30.052367Z",description:"",image:null,excerpt:"We were recently made aware of multiple potential DNS leaks on Android. They stem from bugs in Android itself, and only affect certain apps.",body:"\u003Cp>We were recently made aware of multiple potential DNS leaks on Android. They stem from bugs in Android itself, and only affect certain apps.\u003C/p>\r\n\u003Cp>On Monday 22 of April we became aware of a \u003Ca href=\"https://www.reddit.com/r/mullvadvpn/comments/1c9p96y/dns_leak_with_block_connections_without_vpn_on/\">user report on Reddit\u003C/a> of a \u003Ca href=\"https://en.wikipedia.org/wiki/DNS_leak\">DNS leak\u003C/a>. The report detailed how the user managed to leak DNS queries when disabling and enabling VPN while having &ldquo;Block connections without VPN&rdquo; on. We immediately started an internal investigation that could confirm the issue. The investigation also led to more findings of scenarios that can cause DNS leaks on Android.\u003C/p>\r\n\u003Ch3>Findings\u003C/h3>\r\n\u003Cp>Identified scenarios where the Android OS can leak DNS traffic:\u003C/p>\r\n\u003Cul>\r\n\u003Cli>If a VPN is active without any DNS server configured.\u003C/li>\r\n\u003Cli>For a short period of time while a VPN app is re-configuring the tunnel or is being force stopped/crashes.\u003C/li>\r\n\u003C/ul>\r\n\u003Cp>The leaks seem to be limited to direct calls to the C function \u003Ccode>getaddrinfo\u003C/code>. Apps that use this way to resolve domain names cause leaks in the scenarios listed above. We have not found any leaks from apps that only use Android API:s such as \u003Ca href=\"https://developer.android.com/reference/android/net/DnsResolver\" rel=\"nofollow\">DnsResolver\u003C/a>. The Chrome browser is an example of an app that can use \u003Ccode>getaddrinfo\u003C/code> \u003Ca href=\"https://source.chromium.org/chromium/chromium/src/+/main:android_webview/browser/aw_pac_processor.cc;l=197;drc=133b2d903fa57cfda1317bc589b349cf4c284b7c\" rel=\"nofollow\">directly\u003C/a>.\u003C/p>\r\n\u003Cp>The above applies regardless of whether \u003Cem>Always-on VPN\u003C/em> and \u003Cem>Block connections without VPN\u003C/em> is enabled or not, which is not expected OS behavior and should therefore be fixed upstream in the OS.\u003C/p>\r\n\u003Cp>We&rsquo;ve been able to confirm that these leaks occur in multiple versions of Android, including the latest version (Android 14).\u003C/p>\r\n\u003Ch3>Improvements\u003C/h3>\r\n\u003Cp>Our app currently does not set any DNS server in its blocking state. When our app fails to set up a tunnel in a way that is not recoverable, it enters the blocking state. In this state it stops traffic from leaving the device. However, it does not set any DNS server in this state, and as a result the above described DNS leaks can happen. We will work around the OS bug by setting a bogus DNS server for now. You can expect a release with this fix soon.\u003C/p>\r\n\u003Cp>The leak during tunnel reconnects is harder for us to mitigate in our app. We are still looking for solutions. We can potentially minimize the amount of times a tunnel re-configuration happens, but we currently don&rsquo;t think this leak can be fully prevented.\u003C/p>\r\n\u003Cp>It should be made clear that these workarounds should not be needed in any VPN app. Nor is it wrong for an app to use \u003Ccode>getaddrinfo\u003C/code> to resolve domain names. Instead, these issues should be addressed in the OS in order to protect all Android users regardless of which apps they use.\u003C/p>\r\n\u003Cp>We have reported \u003Ca href=\"https://issuetracker.google.com/issues/337961996\" rel=\"nofollow\">the issues and suggested improvements\u003C/a> to Google and hope that they will address this quickly.\u003C/p>\r\n\u003Ch3>Steps to reproduce\u003C/h3>\r\n\u003Cp>The following steps reproduce the second scenario above, where a VPN user changes the tunnel configuration, e.g. switching to another server or changing DNS server.\u003C/p>\r\n\u003Cp>Here we use the WireGuard app since it has become a reference Android VPN implementation. It should be noted that the leaks can probably be reproduced with any other Android VPN app also. We use Chrome to trigger the leaks since it is one of the apps we have confirmed uses \u003Ccode>getaddrinfo\u003C/code>.\u003C/p>\r\n\u003Col>\r\n\u003Cli>Download \u003Ca href=\"/media/uploads/2024/05/03/spam_get_requests.html\">spam_get_requests.html\u003C/a>\u003C/li>\r\n\u003Cli>Install the WireGuard app &amp; Chrome\u003C/li>\r\n\u003Cli>Import \u003Ca href=\"/media/uploads/2024/05/03/wg1.conf\">wg1.conf\u003C/a>, \u003Ca href=\"/media/uploads/2024/05/03/wg2.conf\">wg2.conf\u003C/a> into WireGuard\u003C/li>\r\n\u003Cli>Enable the wg1 tunnel in the WireGuard app and allow the VPN permission\u003C/li>\r\n\u003Cli>In Android VPN Settings enable &ldquo;Always-on VPN&rdquo; &amp; &ldquo;Block connections without VPN&rdquo; for WireGuard\u003C/li>\r\n\u003Cli>Start capturing data on your router by using e.g \u003Ccode>tcpdump\u003C/code>\u003Cbr>\u003Ccode>$ tcpdump -i &lt;INTERFACE&gt; host &lt;IP of android device&gt;\u003C/code>\u003C/li>\r\n\u003Cli>Split the screen to show both WireGuard &amp; Chrome side by side\u003C/li>\r\n\u003Cli>Open \u003Ccode>spam_get_requests.html\u003C/code> with Chrome &amp; press &ldquo;Start&rdquo;\u003C/li>\r\n\u003Cli>Toggle back and fourth between wg1 and wg2 in the WireGuard app until you see the leaks in the next step.\u003C/li>\r\n\u003Cli>Observe DNS traffic similar to this on the router:\r\n\u003Cpre>11:50:27.816359 IP Pixel-Tablet.lan.53353 &gt; OpenWrt.lan.53: 11200+ A? 307lf5rgn6-19282-11-50-27-519z.mullvad.test.lan. (65)\u003Cbr>11:50:27.816359 IP Pixel-Tablet.lan.48267 &gt; OpenWrt.lan.53: 44347+ A? 307lf5rgn6-19284-11-50-27-579z.mullvad.test.lan. (65)\u003Cbr>11:50:27.816396 IP Pixel-Tablet.lan.16747 &gt; OpenWrt.lan.53: 44584+ A? 307lf5rgn6-19289-11-50-27-729z.mullvad.test. (61)\u003Cbr>11:50:27.816458 IP OpenWrt.lan.53 &gt; Pixel-Tablet.lan.53353: 11200 NXDomain 0/0/0 (65)\u003Cbr>11:50:27.816476 IP Pixel-Tablet.lan.45727 &gt; OpenWrt.lan.53: 40503+ A? 307lf5rgn6-19290-11-50-27-759z.mullvad.test. (61)\u003Cbr>11:50:27.816542 IP OpenWrt.lan.53 &gt; Pixel-Tablet.lan.48267: 44347 NXDomain 0/0/0 (65)\u003Cbr>11:50:27.816588 IP Pixel-Tablet.lan.43821 &gt; OpenWrt.lan.53: 36295+ A? 307lf5rgn6-19291-11-50-27-789z.mullvad.test. (61) \r\n11:50:27.816625 IP OpenWrt.lan.53 &gt; Pixel-Tablet.lan.16747: 44584 NXDomain 0/0/0 (61)\u003C/pre>\r\n\u003C/li>\r\n\u003C/ol>\r\n\u003Cp>Since &ldquo;Block connections without VPN&rdquo; was active, nothing except encrypted WireGuard traffic should have left the device, but here we see plaintext DNS leaving the device.\u003C/p>\r\n\u003Ch3>Conclusions and recommendations\u003C/h3>\r\n\u003Cp>DNS leaks may have serious privacy implications for users, and can be used to derive users' approximate location or find out what websites and services a user uses.\u003C/p>\r\n\u003Cp>These finding also shows once again that &ldquo;Block connections without VPN&rdquo; does not live up to its name (or documentation) and that it has multiple flaws. Apps may still leak DNS traffic during the conditions mentioned above, and as \u003Ca href=\"/en/blog/android-leaks-connectivity-check-traffic\">previously reported\u003C/a> it still leaks connection check traffic.\u003C/p>\r\n\u003Cp>Depending on your threat model this might mean that you should avoid using Android altogether for anything sensitive, or employ other mitigations to prevent the leaks. We aim to partially mitigate these problems in our app, so make sure to keep the app up-to-date.\u003C/p>",tags:[{name:"Privacy",slug:"privacy"},{name:"App",slug:"app"}]}},"uses":{"params":["slug"]}}],
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
  </body>
</html>
