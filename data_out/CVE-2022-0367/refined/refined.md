```
{
  "vulnerability_details": {
    "root_cause": "A copy-paste error in the sanity check within the `modbus_reply` function when handling `MODBUS_FC_WRITE_AND_READ_REGISTERS` requests. The code was only validating the read address offset, but not the write address offset, which could lead to out-of-bounds access.",
    "weaknesses": [
      "Heap-based buffer overflow",
      "Insufficient input validation"
    ],
    "impact": "A heap-based buffer overflow can lead to a denial-of-service (crash) or memory corruption. This could allow an attacker to potentially execute arbitrary code.",
    "attack_vectors": "The vulnerability is triggered by sending a crafted Modbus request with the function code `MODBUS_FC_WRITE_AND_READ_REGISTERS` to the server. Specifically, the crafted request will have an invalid address offset for writing, that is outside of the allowed mapping range, which is not properly validated.",
     "required_capabilities": "An attacker needs to be able to send network packets to a vulnerable Modbus server to trigger this vulnerability. This could be a network connection with direct access to the server, or another access vector such as a compromised device on the same network."
  },
  "additional_details": {
    "affected_function": "`modbus_reply` function",
    "affected_protocol": "Modbus TCP",
    "vulnerable_function_code": "MODBUS_FC_WRITE_AND_READ_REGISTERS",
    "poc_details": [
       "A base64 encoded payload `A90AAAAN/xcBYgABAIQAAQLXEQ==` was provided as a proof of concept to trigger the crash",
        "Another base64 encoded payload `/+AAHwBa/xcBYAAgAV4AAQIQNAAADf8PABAAAw==` also triggers the vulnerability"
        ],
    "fix_details": "The fix involves ensuring that both the read and write address offsets are checked against the mapping range, correcting the copy-paste error.",
     "related_issue": "This vulnerability was reported earlier in issue #499 before being reported again as issue #614"
  }
}
```