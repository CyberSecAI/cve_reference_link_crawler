=== Content from skypoc.wordpress.com_3d981cad_20250111_160735.html ===

[コンテンツへスキップ](#content)
[![ギカク](https://skypoc.wordpress.com/wp-content/uploads/2023/09/cropped-czj5l300402x.png)](https://skypoc.wordpress.com/)

[ギカク](https://skypoc.wordpress.com/)

ペンテストと脆弱性診断Blog

メニュー

* [Home](https://skypoc.wordpress.com)
* [About me](https://skypoc.wordpress.com/about-me/)
* [ペネトレーションテスト](https://skypoc.wordpress.com/category/%E3%83%9A%E3%83%8D%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%83%86%E3%82%B9%E3%83%88/)
* [経験メモ](https://skypoc.wordpress.com/category/%E7%B5%8C%E9%A8%93%E3%83%A1%E3%83%A2/)
* [Bug Hunt](https://skypoc.wordpress.com/category/bug-hunt/)
* [CTF](https://skypoc.wordpress.com/category/ctf/)
* [CVE](https://skypoc.wordpress.com/category/cve/)
* [PoC](https://skypoc.wordpress.com/category/poc/)

# 【CVE-2023-4847】【CVE-2023-4848】SourceCodester Simple Book Catalog App v1.0 has multiple vulnerabilities

[Gi](https://skypoc.wordpress.com/author/skypoc/ "Gi の投稿")
[CVE](https://skypoc.wordpress.com/category/cve/)
2023年9月4日2023年9月30日
2 Minutes
## Update

**Update 2023/09/10**

The vulnerability has been included and approved for public disclosure by MITRE.

[CVE Record：CVE-2023-4847](https://www.cve.org/CVERecord?id=CVE-2023-4847)

[NVD-CVE-2023-4847](https://nvd.nist.gov/vuln/detail/CVE-2023-4847)

[CVE Record：CVE-2023-4848](https://www.cve.org/CVERecord?id=CVE-2023-4848)

[NVD-CVE-2023-4848](https://nvd.nist.gov/vuln/detail/CVE-2023-4848)

Vuln\_Author: WEI（ギカク）

The program is built using the xmapp-php8.2.4 version

# Simple Book Catalog App

This project used a basic [**CRUD (Create, Read, Update and Delete)**](https://www.sourcecodester.com/php/16768/php-crud-using-pdo-connection-free-source-code.html) that has [**image upload**](https://www.sourcecodester.com/php/16782/php-crud-contact-manager-app-image-free-source-code.html) for books.

**Overview of the App:**

The PHP Book Catalog App is a web-based application designed to help users manage and organize their collection of books. The app allows users to perform the following tasks:

1. **Add Books:** Users can add new books to the catalog by providing details such as book title, author, category, image, and abstract.
2. **Update Books:** Users have the ability to update book information, including title, author, category, and more. They can also upload a new book cover image.
3. **Delete Books:** Books that are no longer needed in the collection can be easily removed from the catalog.
4. **Search Books:** The app provides a search functionality that allows users to search for books by title. This feature simplifies the process of finding specific books in a large collection.

## Stored XSS

Stored XSS vulnerability exists in add\_book.php and update\_book.php

![](https://skypoc.wordpress.com/wp-content/uploads/2023/09/jj45fdyx402x.png?w=1024)

Although there are some validations in the code for uploaded image files (such as checking file type, size, and existence), no form of validation or cleaning is performed on other values obtained from $\_POST variables (such as book\_title, book\_author, etc.)

Trying to insert unobfuscated XSS payloads in book\_title and book\_author

```
<script>alert(/xss/)</script>
```
![](https://skypoc.wordpress.com/wp-content/uploads/2023/09/3.png?w=1024)

Click Update Book and return to the home page

![](https://skypoc.wordpress.com/wp-content/uploads/2023/09/1-1.png?w=1024)
![](https://skypoc.wordpress.com/wp-content/uploads/2023/09/2.png?w=1024)

**Refreshing the homepage, the XSS payload is still executed, confirming the Stored XSS** **vulnerability**

**This is attributed to [CWE-79](https://cwe.mitre.org/data/definitions/79.html)**

## SQL Injection

SQL Injection is a type of security vulnerability that enables attackers to interfere with the queries that an application makes to its database. It occurs when an application includes unsafe user input within a query. The attacker can then manipulate the query, leading to unauthorized data access, data modification, or even data deletion.

SQL vulnerability exists in delete\_book.php, and the developer did not filter or validate the delete parameter.

![](https://skypoc.wordpress.com/wp-content/uploads/2023/09/mqfm3mn3402x-1.png?w=1024)
```

<?php
include('../conn/conn.php');

if (isset($_GET['delete'])) {
    $bookID = $_GET['delete'];

    // Retrieve the book image filename
    $stmt = $conn->prepare("SELECT `book_image` FROM `tbl_book` WHERE `tbl_book_id` = ?");
    $stmt->execute([$bookID]);
    $row = $stmt->fetch();

    $bookImage = $row['book_image'];

    // Delete the book from the database
    $stmt = $conn->prepare("DELETE FROM `tbl_book` WHERE `tbl_book_id` = ?");
    $stmt->execute([$bookID]);

    // Delete the associated image file
    if (!empty($bookImage)) {
        $imagePath = "../image/" . $bookImage;
        if (file_exists($imagePath)) {
            unlink($imagePath);
        }
    }

    // Redirect to the page where you want to display the updated book list
    header("Location: http://localhost/book-catalog-app/index.php");
    exit();
}
?>

```

Unsanitized input from a database flows into unlink, where it is used as a path. This may result in a Path Traversal vulnerability and allow an attacker to delete arbitrary files.

**This is attributed to [CWE-23](https://cwe.mitre.org/data/definitions/23.html)**

![](https://skypoc.wordpress.com/wp-content/uploads/2023/09/i4fkhz5q402x.png?w=1024)

It can be seen that there is no verification or filtering of the delete parameter in the code.

![](https://skypoc.wordpress.com/wp-content/uploads/2023/09/4.png?w=1024)

Construct a malicious code that controls the delete parameter to delete the entire tbl\_book table

```
1; DROP TABLE tbl_book;
```
![](https://skypoc.wordpress.com/wp-content/uploads/2023/09/11.png?w=1024)

The entire tbl\_book table was deleted in its entirety, confirming the existence of a SQL injection vulnerability

**This is attributed to** [CWE-89](https://cwe.mitre.org/data/definitions/89.html)

### 共享此文章：

* [Twitter](https://skypoc.wordpress.com/2023/09/04/sourcecodester-simple-book-catalog-app-v1-0-has-multiple-vulnerabilities/?share=twitter "クリックして Twitter で共有")
* [Facebook](https://skypoc.wordpress.com/2023/09/04/sourcecodester-simple-book-catalog-app-v1-0-has-multiple-vulnerabilities/?share=facebook "Facebook で共有するにはクリックしてください")
いいね 読み込み中…

**公開済み**
2023年9月4日2023年9月30日

## 投稿ナビゲーション

[Previous Post 【CVE-2023-4749】Open Source AMPLE Inventory Management System has a File Inclusion Vulnerability](https://skypoc.wordpress.com/2023/09/03/%E3%80%90code-audit%E3%80%91open-source-ample-inventory-management-system-v1-0-by-mayuri_k-has-a-file-inclusion-vulnerability/)[Next Post 【CVE-2023-4864】【CVE-2023-4865】SourceCodester Take-Note App v1.0 has Multiple Vulnerabilities](https://skypoc.wordpress.com/2023/09/05/sourcecodester-take-note-app-v1-0-has-multiple-vulnerabilities/)

[WordPress.com ホスティングサイト](https://wordpress.com/ja/?ref=footer_custom_powered).

* リブログ
* 登録
  開始日

  + [![](https://skypoc.wordpress.com/wp-content/uploads/2024/11/cropped-jmq4ccvq402x.png?w=50) ギカク](https://skypoc.wordpress.com)

  登録する

  + WordPress.com のアカウントをすでにお持ちですか ? [今すぐログイン](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fskypoc.wordpress.com%2F2023%2F09%2F04%2Fsourcecodester-simple-book-catalog-app-v1-0-has-multiple-vulnerabilities%2F&signup_flow=account)
* プライバシー
* + [![](https://skypoc.wordpress.com/wp-content/uploads/2024/11/cropped-jmq4ccvq402x.png?w=50) ギカク](https://skypoc.wordpress.com)
  + [カスタマイズ](https://skypoc.wordpress.com/wp-admin/customize.php?url=https%3A%2F%2Fskypoc.wordpress.com%2F2023%2F09%2F04%2Fsourcecodester-simple-book-catalog-app-v1-0-has-multiple-vulnerabilities%2F)
  + 登録
    開始日
  + [登録](https://wordpress.com/start/)
  + [ログイン](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fskypoc.wordpress.com%2F2023%2F09%2F04%2Fsourcecodester-simple-book-catalog-app-v1-0-has-multiple-vulnerabilities%2F&signup_flow=account)
  + [短縮リンクをコピー](https://wp.me/pcbw4P-rv)
  + [このコンテンツを報告](https://wordpress.com/abuse/?report_url=https://skypoc.wordpress.com/2023/09/04/sourcecodester-simple-book-catalog-app-v1-0-has-multiple-vulnerabilities/)
  + [Reader で投稿を表示](https://wordpress.com/read/blogs/180060947/posts/1705)
  + [購読管理](https://subscribe.wordpress.com/)
  + このバーを折りたたむ

##

##

コメントを読み込み中…

コメントを投稿するにはログインしてください。

###

%d

![](https://pixel.wp.com/b.gif?v=noscript)
WordPress.com で次のようなサイトをデザイン[始めてみよう](https://wordpress.com/start/ja?ref=marketing_bar)


