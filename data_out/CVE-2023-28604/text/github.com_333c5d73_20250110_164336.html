
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsitegeist%2Ffluid-components%2Fblob%2Fmaster%2FDocumentation%2FXssIssue.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsitegeist%2Ffluid-components%2Fblob%2Fmaster%2FDocumentation%2FXssIssue.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=sitegeist%2Ffluid-components)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[sitegeist](/sitegeist)
/
**[fluid-components](/sitegeist/fluid-components)**
Public

* [Notifications](/login?return_to=%2Fsitegeist%2Ffluid-components) You must be signed in to change notification settings
* [Fork
  21](/login?return_to=%2Fsitegeist%2Ffluid-components)
* [Star
   53](/login?return_to=%2Fsitegeist%2Ffluid-components)

* [Code](/sitegeist/fluid-components)
* [Issues
  14](/sitegeist/fluid-components/issues)
* [Pull requests
  8](/sitegeist/fluid-components/pulls)
* [Actions](/sitegeist/fluid-components/actions)
* [Security](/sitegeist/fluid-components/security)
* [Insights](/sitegeist/fluid-components/pulse)

Additional navigation options

* [Code](/sitegeist/fluid-components)
* [Issues](/sitegeist/fluid-components/issues)
* [Pull requests](/sitegeist/fluid-components/pulls)
* [Actions](/sitegeist/fluid-components/actions)
* [Security](/sitegeist/fluid-components/security)
* [Insights](/sitegeist/fluid-components/pulse)

## Files

 master
## Breadcrumbs

1. [fluid-components](/sitegeist/fluid-components/tree/master)
2. /[Documentation](/sitegeist/fluid-components/tree/master/Documentation)
/
# XssIssue.md

Copy path Blame  Blame
## Latest commit

## History

[History](/sitegeist/fluid-components/commits/master/Documentation/XssIssue.md)167 lines (125 loc) · 6.49 KB master
## Breadcrumbs

1. [fluid-components](/sitegeist/fluid-components/tree/master)
2. /[Documentation](/sitegeist/fluid-components/tree/master/Documentation)
/
# XssIssue.md

Top
## File metadata and controls

* Preview
* Code
* Blame

167 lines (125 loc) · 6.49 KB[Raw](https://github.com/sitegeist/fluid-components/raw/refs/heads/master/Documentation/XssIssue.md)
# Mitigating XSS Issues with Fluid Components 3.5

All versions of Fluid Components before 3.5 were susceptible to Cross-Site Scripting. Version 3.5 of the extension
fixes this issue. Due to the nature of the problem, some changes in your project's Fluid templates might be necessary
to prevent unwanted double-escaping of HTML markup.

## When do you need to take action?

In the following edge case, the behavior of the extension changes and you need to adjust your template files:

* Your component uses the predefined `{content}` parameter AND
* Your component allows HTML markup in the `{content}` parameter by applying `f:format.raw()` before output AND
* You pass a variable containing HTML markup to the component's `{content}` parameter without using `f:format.raw()`, `f:format.html()` or similar.

## Finding potential issues

The extension contains a CLI tool that can help you in finding potential escaping issues in your templates. The tool
picks up template files in all installed extensions (`ext/*/Resources/Private/**/*.html`) automatically, checks all
available components and highlights component calls where changes might be necessary. The tool can be executed via CLI:

```
vendor/bin/typo3 fluidcomponents:checkContentEscaping

```

You get a list of potential issues in your template files, for example:

> public/typo3conf/ext/sitepackage/Resources/Private/Extensions/GridElements/Templates/Accordion.html:
>
> Component "public/typo3conf/ext/sitepackage/Resources/Private/Components/Organism/Accordion/Accordion.html" expects raw html content, but was called with potentially escaped variables: {data.tx\_gridelements\_view\_column\_10}

In this case, you would need to add `f:format.raw()` to the described variable, as described below.

Please note that the tool might also show false positives where you don't need to change anything, for example:

> public/typo3conf/ext/sitepackage/Resources/Private/Components/Organism/NewsArticle/NewsArticle.html:
>
> Component "public/typo3conf/ext/sitepackage/Resources/Private/Components/Molecule/Featurebar/Featurebar.html" expects raw html content, but was called with potentially escaped variables: {datePublished}

This can be safely ignored because `{datePublished}` shouldn't contain HTML markup and thus can be escaped.

## Fixing double escaping in your templates

Quote Component:

```
<fc:component>
    <fc:param name="author" type="string" />
    <fc:renderer>
        <blockquote>
            {content -> f:format.raw()}
            <figcaption>{author}</figcaption>
        </blockquote>
    </fc:renderer>
</fc:component>
```

### Adjustments Necessary

In the following examples you need to adjust your template to prevent double escaping of the HTML.

**⚠️ Please make sure to always check if the variable only contains *safe* HTML markup and no direct user input as this could lead to XSS issues!**

General example:

```
<f:variable name="variableContainingHtmlMarkup">some text with <b>html markup</b></f:variable>
<!-- this doesn't work anymore: -->
<my:quote author="Jane Doe">This is a quote that uses a {variableContainingHtmlMarkup}.</my:quote>
<!-- needs to be changed to: -->
<my:quote author="Jane Doe">This is a quote that uses a {variableContainingHtmlMarkup -> f:format.raw()}.</my:quote>
```

This is an example of the issue for a template which uses data processed by gridelements:

```
<!-- this doesn't work anymore: -->
<my:quote author="Jane Doe" content="{data.tx_gridelements_view_column_10}" />
<!-- needs to be changed to: -->
<my:quote author="Jane Doe" content="{data.tx_gridelements_view_column_10 -> f:format.raw()}" />
```

It can also happen with custom content elements that deal with RTE fields:

```
<!-- this doesn't work anymore: -->
<my:quote author="Jane Doe" content="{data.bodytext}" />
<!-- needs to be changed to: -->
<my:quote author="Jane Doe" content="{data.bodytext -> f:format.html()}" />
```

### No Adjustments Necessary

The following examples are fine and don't need to be changed:

```
<my:quote author="Jane Doe">This is a simple quote without any HTML markup</my:quote>
```

```
<my:quote author="Jane Doe">This is a simple quote with <b>some HTML markup</b></my:quote>
```

```
<my:quote author="Jane Doe">This is a quote that uses <my:fancyText>another component</my:fancyText></my:quote>
```

```
<my:quote author="Jane Doe">This is a quote that uses {rteContent -> f:format.html()}.</my:quote>
```

```
<f:variable name="variableWithoutHtmlMarkup">just some text</f:variable>
<my:quote author="Jane Doe">This is a quote that uses a {variableWithoutHtmlMarkup}.</my:quote>
```

```
<f:variable name="variableContainingHtmlMarkup">some text with <b>html markup</b></f:variable>
<my:quote author="Jane Doe">This is a quote that uses a {variableContainingHtmlMarkup -> f:format.raw()}.</my:quote>
```

## Using the new Slot feature

This change isn't strictly necessary to update to the new version, but is advisable because it can make the usage of external
markup more visible and explicit in your components. Developers are motivated to think about the source of a variable and
the potential XSS issues that can be triggered by rendering external markup.

The following quality rules should be set for your components:

* `f:format.raw()`, `f:format.html()` and similar ViewHelpers should **never** be used inside a component, but rather in the
  template calling the component (where you know if the markup is safe)
* `content` that can't contain HTML should be escaped by using the default variable syntax: `{content}`
* `content` that can contain HTML must be rendered using the `fc:slot()` ViewHelper
* To check for the existence of `content`, use the default variable syntax: `<f:if condition="{content}">...`
* other parameters that can contain HTML must be of type `Slot` and must be rendered with `fc:slot()` as well

Improved Quote component:

```
<fc:component>
    <fc:param name="author" type="string" />
    <fc:param name="cite" type="Slot" />
    <fc:renderer>
        <blockquote>
            <fc:slot />
            <figcaption>
                {author},
                <cite><fc:slot name="cite" /></cite>
            </figcaption>
        </blockquote>
    </fc:renderer>
</fc:component>
```

Examples:

```
<my:quote author="Jane Doe" cite="<a href='https://example.com'>Example.com</a>">
    This is a <b>quote example</b>.
</my:quote>
```

```
<f:variable name="cite"><a href="https://example.com">Example.com</a></f:variable>
<my:quote author="Jane Doe" cite="{cite -> f:format.raw()}">
    This is a <b>quote example</b>.
</my:quote>
```

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

