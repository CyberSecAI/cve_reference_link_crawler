
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgeoserver%2Fgeoserver%2Fsecurity%2Fadvisories%2FGHSA-j59v-vgcr-hxvf)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgeoserver%2Fgeoserver%2Fsecurity%2Fadvisories%2FGHSA-j59v-vgcr-hxvf)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=geoserver%2Fgeoserver)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[geoserver](/geoserver)
/
**[geoserver](/geoserver/geoserver)**
Public

* [Notifications](/login?return_to=%2Fgeoserver%2Fgeoserver) You must be signed in to change notification settings
* [Fork
  2.2k](/login?return_to=%2Fgeoserver%2Fgeoserver)
* [Star
   3.9k](/login?return_to=%2Fgeoserver%2Fgeoserver)

* [Code](/geoserver/geoserver)
* [Pull requests
  15](/geoserver/geoserver/pulls)
* [Actions](/geoserver/geoserver/actions)
* [Projects
  0](/geoserver/geoserver/projects)
* [Wiki](/geoserver/geoserver/wiki)
* [Security](/geoserver/geoserver/security)
* [Insights](/geoserver/geoserver/pulse)

Additional navigation options

* [Code](/geoserver/geoserver)
* [Pull requests](/geoserver/geoserver/pulls)
* [Actions](/geoserver/geoserver/actions)
* [Projects](/geoserver/geoserver/projects)
* [Wiki](/geoserver/geoserver/wiki)
* [Security](/geoserver/geoserver/security)
* [Insights](/geoserver/geoserver/pulse)

# GeoServer's Server Status shows sensitive environmental variables and Java properties

Moderate

[jodygarnett](/jodygarnett)
published
GHSA-j59v-vgcr-hxvf
Jul 1, 2024

## Package

maven

org.geoserver.web:gs-main
([Maven](/advisories?query=ecosystem%3Amaven))

## Affected versions

>2.10.0,<2.24.4
>2.10.0,<2.25.1

## Patched versions

2.24.4
2.25.1

maven

org.geoserver.web:gs-web-app
([Maven](/advisories?query=ecosystem%3Amaven))

>2.10.0,<2.24.4
>2.10.0,<2.25.1

2.24.4
2.25.1

## Description

GeoServer's Server Status page and REST API (at `/geoserver/rest/about/status`) lists *all* environment variables and Java properties to *any* GeoServer user with administrative rights as part of those modules' status message.

These variables/properties can also contain sensitive information, such as database passwords or API keys/tokens, for example:

* Data stores defined with [parameterized catalog settings](https://docs.geoserver.org/latest/en/user/datadirectory/configtemplate.html) (`-DALLOW_ENV_PARAMETRIZATION=true`) which need a password or access key.
* GeoServer's official Docker image [uses environment variables to configure PostgreSQL JNDI resources, including credentials](https://github.com/geoserver/docker/blob/master/README.md#how-to-enable-a-postgresql-jndi-resource) (`POSTGRES_HOST`, `POSTGRES_USERNAME`, `POSTGRES_PASSWORD`)

Additionally, many community-developed GeoServer container images `export` other credentials from their start-up scripts as environment variables to the GeoServer (`java`) process, such as:

* GeoServer `admin` and master (`root`) passwords
* Tomcat management application password
* HTTPS/TLS certificate key store password
* AWS S3 bucket access keys

The precise scope of the issue depends on which container image is used and how it is configured.

Note

Some container images allow passing secrets as files (eg: `POSTGRES_PASSWORD_FILE`), or randomly generating passwords on start-up. While this is promoted as best-practice[1](#user-content-fn-secret-files-48c424b6b3ae95461610846a8bfd6a98), if its start-up script [`export`s these as environment variables](https://www.gnu.org/software/bash/manual/html_node/Bourne-Shell-Builtins.html#index-export) to GeoServer, they are **also** impacted by this issue.

### Impact

The “about status” API endpoint (at `/geoserver/rest/about/status`) which powers the Server Status page is only available to administrators.

Depending on the operating environment, administrators might have legitimate access to credentials in other ways, but this issue defeats more sophisticated controls (like break-glass access to secrets or role accounts).

By default, GeoServer only allows same-origin authenticated API access. This limits the scope for a third-party attacker to use an administrator’s credentials to gain access to credentials (ie: requires XSS).

We were unable to determine any other conditions under which the GeoServer REST API may be available more broadly.

### Fixes / remediation

GeoServer 2.24.4 and 2.25.1 hide **all** environment variables and Java system properties *by default*, with *no further action required by GeoServer administrators*.

[There are new settings to allow an administrator to display these again](https://docs.geoserver.org/latest/en/user/production/config.html#showing-environment-variables-and-java-system-properties) – effectively **reverting** this security fix. We strongly recommend administrators leave these settings as-is, and use alternative mechanisms to access environment variables (instructions below).

If you're using GeoServer in a container runtime (such as Docker or Kubernetes) or from some other distributor's packages, you'll need to wait for the maintainer to update the version of GeoServer used in their image.

Warning

If you run GeoServer with [parameterized catalog settings](https://docs.geoserver.org/latest/en/user/datadirectory/configtemplate.html) (`-DALLOW_ENV_PARAMETRIZATION=true`), a GeoServer administrator could use this to access any environment variable or Java property by including it in some field which is rendered by the UI (such as the description field), **even with this fix**.

### Advice for container / Docker image maintainers

Update container images to use GeoServer 2.24.4 or 2.25.1 to get the bug fix.

Please leave environment variables and Java system properties hidden by default. If you provide the option to re-enable it, [communicate the impact and risks](https://docs.geoserver.org/latest/en/user/production/config.html#showing-environment-variables-and-java-system-properties) so that users can make an informed choice.

Container images should practice "defence in depth", to limit the impact when it is configured to show environment variables and/or properties:

* Pass secrets to the container as either:

  + files which are only readable by the GeoServer process/UID, or,
  + references (identifiers) to a secret stored in a cloud provider's metadata or secret management service
* Pass secrets to GeoServer by generating configuration files as part of your start-up scripts, rather than passing variables/properties or relying on [parameterized catalog settings](https://docs.geoserver.org/latest/en/user/datadirectory/configtemplate.html).
* Ensure any configuration files with secrets are not readable by other users.
* Clear all environment variables which contain secrets *before* starting GeoServer.

  *Alternatively:* start up GeoServer with *only* the environment variables it needs, and no secrets.
* **Don't** pass secrets as command-line flags – these are shown in `ps` to all users!

### Alternatives for displaying GeoServer's environment variables

* **On Linux,** you can get all environment variables [set at *start-up time*](https://unix.stackexchange.com/a/70636) for a running process with:

  ```
  tr '\0' '\n' < /proc/${GEOSERVER_PID}/environ
  ```
* **On Windows,** [SysInternals' Process Explorer](https://learn.microsoft.com/en-us/sysinternals/downloads/process-explorer) can show running processes' environment variables.
* Current versions of **macOS** do not allow arbitrary access to other running processes' environment variables. Disabling these restrictions (on a macOS level) would significantly reduce the overall security of the system.

## Footnotes

1. [Docker Compose: How to use secrets in Docker Compose](https://docs.docker.com/compose/use-secrets/), [Docker Swarm: Build support for Docker Secrets into your images](https://docs.docker.com/engine/swarm/secrets/#build-support-for-docker-secrets-into-your-images) [↩](#user-content-fnref-secret-files-48c424b6b3ae95461610846a8bfd6a98)

### Severity

Moderate

4.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
High

User interaction
Required

Scope
Unchanged

Confidentiality
High

Integrity
None

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:U/C:H/I:N/A:N

### CVE ID

CVE-2024-34696

### Weaknesses

[CWE-200](/advisories?query=cwe%3A200)

### Credits

* [![@miceg](https://avatars.githubusercontent.com/u/164135984?s=40&v=4)](/miceg)
  [miceg](/miceg)
  Reporter
* [![@jodygarnett](https://avatars.githubusercontent.com/u/629681?s=40&v=4)](/jodygarnett)
  [jodygarnett](/jodygarnett)
  Remediation reviewer

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

