The provided content discusses a stored Cross-Site Scripting (XSS) vulnerability found in Rukovoditel version 3.5.2.

**Root cause of vulnerability:**
The vulnerability stems from insufficient sanitization of the `user_photo` parameter when updating user profiles or during registration. This allows an attacker to inject malicious JavaScript code into the application.

**Weaknesses/vulnerabilities present:**
- Stored XSS vulnerability due to lack of input sanitization on the `user_photo` parameter.
- The vulnerability exists in multiple locations: user profile editing ("My Page"), user registration process, and the admin panel's user overview page.

**Impact of exploitation:**
- The injected JavaScript payload can be executed in the victim's browser when they view affected pages.
- This can lead to:
  - Theft of administrative cookies, potentially granting attackers full control over the application.
  - Redirection of users to attacker-controlled websites, which could be used for phishing attacks or malware distribution.

**Attack vectors:**
- The attacker can exploit the vulnerability by crafting a malicious payload within the `user_photo` parameter during user profile updates or registration.

**Required attacker capabilities/position:**
- The attacker needs to be an authenticated user of the application (or be able to register an account).
- The attacker needs to craft a malicious payload and insert it in `user_photo` parameter
- The attacker needs to be able to trigger the execution of the stored XSS payload (e.g. by visiting a page where the payload is rendered). This can be done via editing profile or registering user and having an admin view their profile.