The provided content relates to CVE-2021-47515.

**Root cause of the vulnerability:**
When an IPv4 packet is encapsulated within an outer IPv6+SRH header, the `seg6_do_srh_encap` function clears the IPv6 socket control block using `memset`. This action unintentionally erases the receiving interface index (iif) which was previously set for the IPv4 packet. The IPv6 and IPv4 socket control blocks share the same memory area, so clearing the IPv6 block overwrites the IPv4 iif information.

**Weaknesses/vulnerabilities:**
- The vulnerability stems from the unintended side effect of clearing the IPv6 socket control block, leading to the loss of the receiving interface index.
- Specifically, the `memset` operation in `seg6_do_srh_encap` which was introduced in commit ef489749aae5 to clear IPv6 socket control block, caused the iif to be lost because it shares the same memory area as IPv4 socket control block.
- The missing interface index can lead to a NULL pointer dereference under certain conditions, particularly when commit 0857d6f8c759 ("ipv6: When forwarding count rx stats on the orig netdev") is applied.

**Impact of exploitation:**
- A NULL pointer dereference can occur, leading to a denial-of-service condition, and potentially other issues.

**Attack vectors:**
- An attacker would need to send a crafted IPv4 packet that triggers the encapsulation by `seg6_do_srh_encap`.

**Required attacker capabilities/position:**
- The attacker needs to be in a position to send network packets to the vulnerable system.
- The attacker must also be able to send a specific kind of IPv4 packet that will be encapsulated in an IPv6+SRH header.