
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftensorflow%2Ftensorflow%2Fblob%2Ff3b9bf4c3c0597563b289c0512e98d4ce81f886e%2Ftensorflow%2Fcore%2Fkernels%2Fsparse%2Fsparse_tensor_to_csr_sparse_matrix_op.cc)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftensorflow%2Ftensorflow%2Fblob%2Ff3b9bf4c3c0597563b289c0512e98d4ce81f886e%2Ftensorflow%2Fcore%2Fkernels%2Fsparse%2Fsparse_tensor_to_csr_sparse_matrix_op.cc)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=tensorflow%2Ftensorflow)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[tensorflow](/tensorflow)
/
**[tensorflow](/tensorflow/tensorflow)**
Public

* [Notifications](/login?return_to=%2Ftensorflow%2Ftensorflow) You must be signed in to change notification settings
* [Fork
  74.4k](/login?return_to=%2Ftensorflow%2Ftensorflow)
* [Star
   187k](/login?return_to=%2Ftensorflow%2Ftensorflow)

* [Code](/tensorflow/tensorflow)
* [Issues
  834](/tensorflow/tensorflow/issues)
* [Pull requests
  5k+](/tensorflow/tensorflow/pulls)
* [Actions](/tensorflow/tensorflow/actions)
* [Projects
  2](/tensorflow/tensorflow/projects)
* [Security](/tensorflow/tensorflow/security)
* [Insights](/tensorflow/tensorflow/pulse)

Additional navigation options

* [Code](/tensorflow/tensorflow)
* [Issues](/tensorflow/tensorflow/issues)
* [Pull requests](/tensorflow/tensorflow/pulls)
* [Actions](/tensorflow/tensorflow/actions)
* [Projects](/tensorflow/tensorflow/projects)
* [Security](/tensorflow/tensorflow/security)
* [Insights](/tensorflow/tensorflow/pulse)

## Files

 f3b9bf4
## Breadcrumbs

1. [tensorflow](/tensorflow/tensorflow/tree/f3b9bf4c3c0597563b289c0512e98d4ce81f886e)
2. /[tensorflow](/tensorflow/tensorflow/tree/f3b9bf4c3c0597563b289c0512e98d4ce81f886e/tensorflow)
3. /[core](/tensorflow/tensorflow/tree/f3b9bf4c3c0597563b289c0512e98d4ce81f886e/tensorflow/core)
4. /[kernels](/tensorflow/tensorflow/tree/f3b9bf4c3c0597563b289c0512e98d4ce81f886e/tensorflow/core/kernels)
5. /[sparse](/tensorflow/tensorflow/tree/f3b9bf4c3c0597563b289c0512e98d4ce81f886e/tensorflow/core/kernels/sparse)
/
# sparse\_tensor\_to\_csr\_sparse\_matrix\_op.cc

 Blame  Blame
## Latest commit

## History

[History](/tensorflow/tensorflow/commits/f3b9bf4c3c0597563b289c0512e98d4ce81f886e/tensorflow/core/kernels/sparse/sparse_tensor_to_csr_sparse_matrix_op.cc)361 lines (309 loc) · 13.8 KB f3b9bf4
## Breadcrumbs

1. [tensorflow](/tensorflow/tensorflow/tree/f3b9bf4c3c0597563b289c0512e98d4ce81f886e)
2. /[tensorflow](/tensorflow/tensorflow/tree/f3b9bf4c3c0597563b289c0512e98d4ce81f886e/tensorflow)
3. /[core](/tensorflow/tensorflow/tree/f3b9bf4c3c0597563b289c0512e98d4ce81f886e/tensorflow/core)
4. /[kernels](/tensorflow/tensorflow/tree/f3b9bf4c3c0597563b289c0512e98d4ce81f886e/tensorflow/core/kernels)
5. /[sparse](/tensorflow/tensorflow/tree/f3b9bf4c3c0597563b289c0512e98d4ce81f886e/tensorflow/core/kernels/sparse)
/
# sparse\_tensor\_to\_csr\_sparse\_matrix\_op.cc

Top
## File metadata and controls

* Code
* Blame

361 lines (309 loc) · 13.8 KB[Raw](https://github.com/tensorflow/tensorflow/raw/f3b9bf4c3c0597563b289c0512e98d4ce81f886e/tensorflow/core/kernels/sparse/sparse_tensor_to_csr_sparse_matrix_op.cc)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361/\* Copyright 2019 The TensorFlow Authors. All Rights Reserved.
Licensed under the Apache License, Version 2.0 (the "License");you may not use this file except in compliance with the License.You may obtain a copy of the License at
 http://www.apache.org/licenses/LICENSE-2.0
Unless required by applicable law or agreed to in writing, softwaredistributed under the License is distributed on an "AS IS" BASIS,WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.See the License for the specific language governing permissions andlimitations under the License.==============================================================================\*/
#define EIGEN\_USE\_THREADS
#if GOOGLE\_CUDA || TENSORFLOW\_USE\_ROCM#define EIGEN\_USE\_GPU#endif
#include "third\_party/eigen3/unsupported/Eigen/CXX11/Tensor"#include "tensorflow/core/framework/op.h"#include "tensorflow/core/framework/op\_kernel.h"#include "tensorflow/core/framework/tensor\_reference.h"#include "tensorflow/core/framework/tensor\_shape.h"#include "tensorflow/core/framework/tensor\_types.h"#include "tensorflow/core/framework/variant\_op\_registry.h"#include "tensorflow/core/kernels/dense\_update\_functor.h"#include "tensorflow/core/kernels/fill\_functor.h"#include "tensorflow/core/kernels/sparse/kernels.h"#include "tensorflow/core/kernels/sparse/sparse\_matrix.h"
#if GOOGLE\_CUDA || TENSORFLOW\_USE\_ROCM#include "tensorflow/core/common\_runtime/gpu/gpu\_event\_mgr.h"#include "tensorflow/core/util/cuda\_sparse.h"#include "tensorflow/core/util/gpu\_solvers.h"#endif
#if GOOGLE\_CUDA#include "tensorflow/stream\_executor/cuda/cuda\_activation.h"using ::perftools::gputools::cuda::ScopedActivateExecutorContext;#elif TENSORFLOW\_USE\_ROCM#include "tensorflow/stream\_executor/rocm/rocm\_activation.h"using ::perftools::gputools::rocm::ScopedActivateExecutorContext;#endif
namespace tensorflow {
typedef Eigen::ThreadPoolDevice CPUDevice;typedef Eigen::GpuDevice GPUDevice;
// Op to convert SparseTensors to CSR SparseMatrices on the CPU.// Takes a SparseTensor of rank 2 or (if batched) 3 as the input. The// SparseTensor's indices must be present in the canonical, row-major ordering.//// Returns a (batched) CSR SparseMatrix with the same dense shape and non-zero// values.template <typename T>class SparseTensorToCSRSparseMatrixCPUOp : public OpKernel { public: explicit SparseTensorToCSRSparseMatrixCPUOp(OpKernelConstruction\* c) : OpKernel(c) {}
 void Compute(OpKernelContext\* ctx) final { const Tensor& indices = ctx->input(0); const Tensor& values = ctx->input(1); const Tensor& dense\_shape = ctx->input(2); const int rank = dense\_shape.NumElements(); OP\_REQUIRES(ctx, rank == 2 || rank == 3, errors::InvalidArgument("SparseTensor must have rank 2 or 3; ", "but indices has rank: ", rank)); auto dense\_shape\_vec = dense\_shape.vec<int64\_t>(); const int64\_t batch\_size = (rank == 2) ? 1 : dense\_shape\_vec(0); const int64\_t num\_rows = dense\_shape\_vec((rank == 2) ? 0 : 1); const int64\_t total\_nnz = values.NumElements();
 // Allocate output Tensors. TensorShape batch\_ptr\_shape; OP\_REQUIRES\_OK( ctx, TensorShape::BuildTensorShape({batch\_size + 1}, &batch\_ptr\_shape)); Tensor batch\_ptr(cpu\_allocator(), DT\_INT32, batch\_ptr\_shape); TensorShape csr\_col\_ind\_shape; OP\_REQUIRES\_OK( ctx, TensorShape::BuildTensorShape({total\_nnz}, &csr\_col\_ind\_shape)); Tensor csr\_col\_ind(cpu\_allocator(), DT\_INT32, csr\_col\_ind\_shape); TensorShape csr\_row\_ind\_shape; OP\_REQUIRES\_OK(ctx, TensorShape::BuildTensorShape( {(num\_rows + 1) \* batch\_size}, &csr\_row\_ind\_shape)); Tensor csr\_row\_ptr(cpu\_allocator(), DT\_INT32, csr\_row\_ind\_shape);
 // Fill the row pointers with zeros. functor::SetZeroFunctor<CPUDevice, int32> set\_zero; set\_zero(ctx->eigen\_device<CPUDevice>(), csr\_row\_ptr.flat<int32>());
 // Convert from COO to CSR format. functor::SparseTensorToCSRSparseMatrixCPUFunctor coo\_to\_csr; OP\_REQUIRES\_OK( ctx, coo\_to\_csr(batch\_size, num\_rows, indices.template matrix<int64\_t>(), batch\_ptr.vec<int32>(), csr\_row\_ptr.vec<int32>(), csr\_col\_ind.vec<int32>()));
 // Create the CSRSparseMatrix object from its component Tensors and prepare // the Variant output Tensor. CSRSparseMatrix output\_csr\_matrix; OP\_REQUIRES\_OK( ctx, CSRSparseMatrix::CreateCSRSparseMatrix( DataTypeToEnum<T>::value, dense\_shape, batch\_ptr, csr\_row\_ptr, csr\_col\_ind, values, &output\_csr\_matrix)); Tensor\* output\_csr\_matrix\_tensor; AllocatorAttributes cpu\_alloc; cpu\_alloc.set\_on\_host(true); OP\_REQUIRES\_OK( ctx, ctx->allocate\_output(0, TensorShape({}), &output\_csr\_matrix\_tensor, cpu\_alloc)); output\_csr\_matrix\_tensor->scalar<Variant>()() = std::move(output\_csr\_matrix); }};
#if GOOGLE\_CUDA || TENSORFLOW\_USE\_ROCM
template <typename Device, typename T>class SparseTensorToCSRSparseMatrixGPUOp : public AsyncOpKernel { public: explicit SparseTensorToCSRSparseMatrixGPUOp(OpKernelConstruction\* c) : AsyncOpKernel(c) {}
 void ComputeAsync(OpKernelContext\* c, DoneCallback done) final { auto stream = c->op\_device\_context()->stream(); const Device& d = c->eigen\_device<Device>();
 const Tensor& indices\_t = c->input(0); const Tensor& values\_t = c->input(1); const Tensor& dense\_shape\_t = c->input(2); const int rank = dense\_shape\_t.NumElements(); OP\_REQUIRES\_ASYNC( c, rank == 2 || rank == 3, errors::InvalidArgument("sparse tensor must have rank == 2 or 3; ", "but indices has ", rank, " columns"), done); auto dense\_shape = dense\_shape\_t.vec<int64\_t>(); const int64\_t batch\_size = (rank == 2) ? 1 : dense\_shape(0); const int64\_t rows = dense\_shape((rank == 2) ? 0 : 1); const int64\_t cols = dense\_shape((rank == 2) ? 1 : 2);
 ScratchSpace<int32> nnz\_per\_batch\_host(c, batch\_size, /\*on\_host\*/ true);
 Tensor nnz\_per\_batch\_device\_t; if (rank == 2) { // Simple case. nnz\_per\_batch\_host.mutable\_data()[0] = indices\_t.dim\_size(0); } else { OP\_REQUIRES\_OK\_ASYNC(c, c->allocate\_temp(DT\_INT32, TensorShape({batch\_size}), &nnz\_per\_batch\_device\_t), done); auto nnz\_per\_batch\_device = nnz\_per\_batch\_device\_t.vec<int32>();
 functor::CalculateNNZPerBatchMatrixFromIndices<Device> calculate\_nnz\_from\_indices; auto indices = indices\_t.matrix<int64\_t>(); OP\_REQUIRES\_OK\_ASYNC( c, calculate\_nnz\_from\_indices(c, indices, nnz\_per\_batch\_device), done);
 perftools::gputools::DeviceMemoryBase nnz\_per\_batch\_device\_ptr( static\_cast<void\*>(nnz\_per\_batch\_device.data()));
 OP\_REQUIRES\_ASYNC( c, stream ->ThenMemcpy(nnz\_per\_batch\_host.mutable\_data() /\*host\_dst\*/, nnz\_per\_batch\_device\_ptr /\*gpu\_src\*/, batch\_size \* sizeof(int32) /\*size\*/) .ok(), errors::Internal("SparseTensorToSparseMatrixGPUOp: failed to copy " "nnz\_per\_batch from device"), done); }
 TensorReference nnz\_per\_batch\_device\_ref(nnz\_per\_batch\_device\_t); auto convert\_to\_csr = [this, c, batch\_size, nnz\_per\_batch\_host, nnz\_per\_batch\_device\_ref, stream, &d, &values\_t, &indices\_t, &dense\_shape\_t, dense\_shape, rows, cols, rank, done]() { // The data has been copied out of the nnz\_per\_batch\_device // tensor by the time we get here; we can unreference it. nnz\_per\_batch\_device\_ref.Unref();
 auto nnz\_per\_batch = nnz\_per\_batch\_host.tensor().vec<int32>();
 // Ensure that within the callback, the proper GPU settings are // configured. ScopedActivateExecutorContext scoped\_activation{stream->parent()}; Tensor batch\_ptr\_t(cpu\_allocator(), DT\_INT32, TensorShape({batch\_size + 1}));
 auto batch\_ptr = batch\_ptr\_t.vec<int32>(); auto indices = indices\_t.matrix<int64\_t>();
 batch\_ptr(0) = 0; for (int i = 0; i < batch\_size; ++i) { batch\_ptr(i + 1) = batch\_ptr(i) + nnz\_per\_batch(i); } int total\_nnz = batch\_ptr(batch\_size); OP\_REQUIRES\_ASYNC( c, total\_nnz == values\_t.NumElements(), errors::Internal("nnz returned by " "CalculateNNZPerBatchMatrixFromInd" "ices != len(values): ", total\_nnz, " vs. ", values\_t.NumElements()), done);
 Tensor coo\_col\_ind\_t; Tensor csr\_row\_ptr\_t; Tensor csr\_values\_t = values\_t;
 Tensor coo\_row\_ind\_t; OP\_REQUIRES\_OK\_ASYNC( c, c->allocate\_temp(DT\_INT32, TensorShape({total\_nnz}), &coo\_row\_ind\_t), done); OP\_REQUIRES\_OK\_ASYNC( c, c->allocate\_temp(DT\_INT32, TensorShape({total\_nnz}), &coo\_col\_ind\_t), done); OP\_REQUIRES\_OK\_ASYNC( c, c->allocate\_temp(DT\_INT32, TensorShape({batch\_size \* (rows + 1)}), &csr\_row\_ptr\_t), done);
 auto coo\_row\_ind = coo\_row\_ind\_t.vec<int32>(); auto coo\_col\_ind = coo\_col\_ind\_t.vec<int32>(); auto csr\_row\_ptr = csr\_row\_ptr\_t.vec<int32>();
 // Convert SparseTensor rep to coo row ind, coo col ind. if (total\_nnz > 0) { functor::SparseTensorToCOOSparseMatrix<Device> st\_to\_coo; st\_to\_coo(d, dense\_shape, indices, coo\_row\_ind, coo\_col\_ind); }
 // Set all csr row pointers to zero, so that when iterating over // batches converting coo to csr, we do not have to perform an // unaligned SetZero for any nnz == 0 minibatches. coo2csr has // a bug if you have empty coo rows. // TODO(ebrevdo): File bug w/ nvidia so coo2csr can handle // zero-element input coo rows. functor::SetZeroFunctor<Device, int32> set\_zero; set\_zero(d, csr\_row\_ptr\_t.flat<int32>());
 functor::COOSparseMatrixToCSRSparseMatrix<Device> coo\_to\_csr; for (int i = 0; i < batch\_size; ++i) { int nnz\_i = batch\_ptr(i + 1) - batch\_ptr(i); if (nnz\_i == 0) { // This is an empty minibatch; no call to coo2csr: it's // handled by the SetZero above. } else { // Convert coo to csr. auto coo\_row\_ind\_i = TTypes<int32>::UnalignedVec(&coo\_row\_ind(batch\_ptr(i)), nnz\_i); auto csr\_row\_ptr\_i = TTypes<int32>::UnalignedVec( &csr\_row\_ptr((rows + 1) \* i), rows + 1); OP\_REQUIRES\_OK\_ASYNC( c, coo\_to\_csr(c, rows, cols, coo\_row\_ind\_i, csr\_row\_ptr\_i), done); } }
 CSRSparseMatrix matrix; OP\_REQUIRES\_OK\_ASYNC( c, CSRSparseMatrix::CreateCSRSparseMatrix( values\_t.dtype(), dense\_shape\_t, batch\_ptr\_t, csr\_row\_ptr\_t, coo\_col\_ind\_t, csr\_values\_t, &matrix), done); Tensor\* matrix\_t; AllocatorAttributes cpu\_alloc; cpu\_alloc.set\_on\_host(true); OP\_REQUIRES\_OK\_ASYNC( c, c->allocate\_output(0, TensorShape({}), &matrix\_t, cpu\_alloc), done); matrix\_t->scalar<Variant>()() = std::move(matrix);
 done(); };
 if (rank == 2) { convert\_to\_csr(); } else { // Launch the GPU kernel to count nnz entries, then call convert\_to\_csr. c->device()->tensorflow\_gpu\_device\_info()->event\_mgr->ThenExecute( stream, convert\_to\_csr); } }};
namespace functor {
template <>Status CalculateNNZPerBatchMatrixFromIndices<GPUDevice>::operator()( OpKernelContext\* c, TTypes<int64\_t>::ConstMatrix indices, TTypes<int32>::Vec nnz\_per\_batch);extern template struct CalculateNNZPerBatchMatrixFromIndices<GPUDevice>;
template <>struct SparseTensorToCOOSparseMatrix<GPUDevice> { void operator()(const GPUDevice& d, TTypes<int64\_t>::ConstVec host\_dense\_shape, TTypes<int64\_t>::ConstMatrix indices, TTypes<int>::Vec coo\_row\_ind, TTypes<int>::Vec coo\_col\_ind);};extern template struct SparseTensorToCOOSparseMatrix<GPUDevice>;
template <>struct COOSparseMatrixToCSRSparseMatrix<GPUDevice> { Status operator()(OpKernelContext\* c, const int rows, const int cols, TTypes<int>::UnalignedVec coo\_row\_ind, TTypes<int>::UnalignedVec csr\_row\_ptr) { GpuSparse cuda\_sparse(c); TF\_RETURN\_IF\_ERROR(cuda\_sparse.Initialize()); return cuda\_sparse.Coo2csr(coo\_row\_ind.data(), /\*nnz\*/ coo\_row\_ind.size(), /\*m == rows of A\*/ rows, csr\_row\_ptr.data()); }};extern template struct COOSparseMatrixToCSRSparseMatrix<GPUDevice>;
} // namespace functor
#define REGISTER\_GPU(T) \ REGISTER\_KERNEL\_BUILDER(Name("SparseTensorToCSRSparseMatrix") \ .Device(DEVICE\_GPU) \ .TypeConstraint<T>("T") \ .HostMemory("dense\_shape"), \ SparseTensorToCSRSparseMatrixGPUOp<GPUDevice, T>);
REGISTER\_GPU(float)REGISTER\_GPU(double)REGISTER\_GPU(complex64)REGISTER\_GPU(complex128)
#undef REGISTER\_GPU
#endif // GOOGLE\_CUDA || TENSORFLOW\_USE\_ROCM
#define REGISTER\_CPU(T) \ REGISTER\_KERNEL\_BUILDER(Name("SparseTensorToCSRSparseMatrix") \ .Device(DEVICE\_CPU) \ .TypeConstraint<T>("T"), \ SparseTensorToCSRSparseMatrixCPUOp<T>);
REGISTER\_CPU(float)REGISTER\_CPU(double)REGISTER\_CPU(complex64)REGISTER\_CPU(complex128)
#undef REGISTER\_CPU
} // namespace tensorflow

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

