=== Content from medium.com_7cd3d14e_20250111_204759.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F3649c7cca092&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40cristiansindile%2Fformula-injection-in-glpi-cve-2024-27756-3649c7cca092&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40cristiansindile%2Fformula-injection-in-glpi-cve-2024-27756-3649c7cca092&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# Formula Injection in GLPI (CVE-2024–27756)

[![Cristian Sindile](https://miro.medium.com/v2/resize:fill:88:88/1*A8qFx-BI0d3AlAJYArfEyA.jpeg)](/%40cristiansindile?source=post_page---byline--3649c7cca092--------------------------------)

[Cristian Sindile](/%40cristiansindile?source=post_page---byline--3649c7cca092--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F98f48d1d7b97&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40cristiansindile%2Fformula-injection-in-glpi-cve-2024-27756-3649c7cca092&user=Cristian+Sindile&userId=98f48d1d7b97&source=post_page-98f48d1d7b97--byline--3649c7cca092---------------------post_header-----------)

3 min read·Mar 1, 2024

--

Listen

Share

During a penetration testing assessment, I discovered an instance of GLPI open source service management software ([glpi-project.org](https://glpi-project.org/)). Despite not finding any public vulnerabilities, I decided to take a closer look at the application in a black box manner, and discovered that the application lacks sanitization and escaping when exporting to CSV or SLK (Excel Symbolic Link) files.

The exploitation of the vulnerability is trivial. An attacker with a technician level account (Can create new assets or edit existing ones) can create an asset with a malicious title, such as ***=(1+1)*** which would not be escaped or sanitized in any way when other users export the assets to CSV or SLK files.

This can lead to sophisticated client side remote code execution (RCE) attacks, where everyone using the software and exporting data to a spreadsheet becomes highly vulnerable.

In some cases, depending on the software used to handle the spreadsheets, can be used to perform local file inclusion (LFI) attacks, or cross-spreadsheet data exfiltration.

![]()

Image 0 — Creating a New Malicious Asset

After the asset is added, let’s see what it looks like in the main asset view.

![]()

Image 1 —The New Malicious Asset

After the new asset is added with a malicious title, it’s time to export it to a spreadsheet type file.

![]()

Image 2 — Exporting to CSV or SLK

Now, let’s open the file and see how our input looks in an open-source spreadsheet editor.

![]()

Image 3 — Formula Injection Successful

As observed, the formula is automatically interpreted and calculated which proves the vulnerability. Next, let’s see if it also works in Microsoft Excel.

![]()

Image 4 — Excel Formula Injection

Now that we can see it works, let’s try to make something a bit more impactful, such as a client side RCE payload. This requires DDE’s to be enabled on the target, but on some older systems, a simple prompt and 2 clicks are all it takes to infect a target. Meaning that a proper phishing payload could prove very, very effective.

![]()

Image 5 — Client Side RCE

This vulnerability appears to affect all current versions of GLPI service management software. Version 10 seems to have made exploitation trickier, whereas in version 9 it was a piece of cake.

> Vulnerability Name: Formula Injection.
>
> Vulnerability Description: An issue in GLPI v.10.0.12 and before allows a remote attacker to execute arbitrary code via a crafted script to the title field.
>
> Affected Codebase: GLPI =< 10.0.12.
>
> Attack Vector: To exploit this, an attacker needs a low privilege account on the GLPI instance, to add a malicious object in the database, containing a CSV injection payload.
>
> CVE ID: CVE-2024–27756.
>
> Date of Publishing: 1st of March, 2023.

[Security](/tag/security?source=post_page-----3649c7cca092--------------------------------)[Cve](/tag/cve?source=post_page-----3649c7cca092--------------------------------)[Vulnerability](/tag/vulnerability?source=post_page-----3649c7cca092--------------------------------)[Penetration Testing](/tag/penetration-testing?source=post_page-----3649c7cca092--------------------------------)[Glpi](/tag/glpi?source=post_page-----3649c7cca092--------------------------------)

--

--

[![Cristian Sindile](https://miro.medium.com/v2/resize:fill:96:96/1*A8qFx-BI0d3AlAJYArfEyA.jpeg)](/%40cristiansindile?source=post_page---post_author_info--3649c7cca092--------------------------------)[![Cristian Sindile](https://miro.medium.com/v2/resize:fill:128:128/1*A8qFx-BI0d3AlAJYArfEyA.jpeg)](/%40cristiansindile?source=post_page---post_author_info--3649c7cca092--------------------------------)Follow[## Written by Cristian Sindile](/%40cristiansindile?source=post_page---post_author_info--3649c7cca092--------------------------------)[1 Follower](/%40cristiansindile/followers?source=post_page---post_author_info--3649c7cca092--------------------------------)·[0 Following](/%40cristiansindile/following?source=post_page---post_author_info--3649c7cca092--------------------------------)

OSCP Certified Penetration Tester - TTÜ Cyber Security Engineering Student - Security Researcher

Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----3649c7cca092--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----3649c7cca092--------------------------------)[About](/about?autoplay=1&source=post_page-----3649c7cca092--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----3649c7cca092--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----3649c7cca092--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----3649c7cca092--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----3649c7cca092--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----3649c7cca092--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----3649c7cca092--------------------------------)[Teams](/business?source=post_page-----3649c7cca092--------------------------------)


