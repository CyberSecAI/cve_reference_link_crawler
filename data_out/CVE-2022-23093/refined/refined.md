- **Root cause of vulnerability:** The `pr_pack()` function in `ping(8)` copies received IP and ICMP headers into stack buffers without considering the presence of IP option headers. When IP options are present in either the response or quoted packet, the function overflows the destination buffer.
- **Weaknesses/vulnerabilities present:** Stack buffer overflow in the `pr_pack()` function of the `ping(8)` utility.
- **Impact of exploitation:** A remote host can trigger the memory safety bug, causing the `ping` program to crash. The `ping` process runs in a capability mode sandbox, which limits the impact.
- **Attack vectors:** Sending specially crafted ICMP packets with IP options to the vulnerable host, triggering the buffer overflow in `ping` when processing the response.
- **Required attacker capabilities/position:** The attacker needs to be able to send network packets to the vulnerable host to trigger the vulnerability.