=== Content from packetstormsecurity.com_4ea39eec_20250111_050138.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from github.com_96e63789_20250111_050140.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FBoidCMS%2FBoidCMS%2Fissues%2F27)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FBoidCMS%2FBoidCMS%2Fissues%2F27)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=BoidCMS%2FBoidCMS)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[BoidCMS](/BoidCMS)
/
**[BoidCMS](/BoidCMS/BoidCMS)**
Public

* [Notifications](/login?return_to=%2FBoidCMS%2FBoidCMS) You must be signed in to change notification settings
* [Fork
  6](/login?return_to=%2FBoidCMS%2FBoidCMS)
* [Star
   53](/login?return_to=%2FBoidCMS%2FBoidCMS)

* [Code](/BoidCMS/BoidCMS)
* [Issues
  0](/BoidCMS/BoidCMS/issues)
* [Pull requests
  0](/BoidCMS/BoidCMS/pulls)
* [Discussions](/BoidCMS/BoidCMS/discussions)
* [Actions](/BoidCMS/BoidCMS/actions)
* [Projects
  0](/BoidCMS/BoidCMS/projects)
* [Security](/BoidCMS/BoidCMS/security)
* [Insights](/BoidCMS/BoidCMS/pulse)

Additional navigation options

* [Code](/BoidCMS/BoidCMS)
* [Issues](/BoidCMS/BoidCMS/issues)
* [Pull requests](/BoidCMS/BoidCMS/pulls)
* [Discussions](/BoidCMS/BoidCMS/discussions)
* [Actions](/BoidCMS/BoidCMS/actions)
* [Projects](/BoidCMS/BoidCMS/projects)
* [Security](/BoidCMS/BoidCMS/security)
* [Insights](/BoidCMS/BoidCMS/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FBoidCMS%2FBoidCMS%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FBoidCMS%2FBoidCMS%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# [VULNERABILITY] Authenticated file upload vulnerability - [leading to shell command execution] #27

Closed

[1337kid](/1337kid) opened this issue
Jul 13, 2023
· 9 comments
 · Fixed by [#28](https://github.com/BoidCMS/BoidCMS/pull/28)

Closed

# [[VULNERABILITY] Authenticated file upload vulnerability - [leading to shell command execution]](#top) #27

[1337kid](/1337kid) opened this issue
Jul 13, 2023
· 9 comments
 · Fixed by [#28](https://github.com/BoidCMS/BoidCMS/pull/28)

Assignees
[![@shoaiyb](https://avatars.githubusercontent.com/u/75518689?s=40&v=4)](/shoaiyb)

Labels
[bug](/BoidCMS/BoidCMS/labels/bug)
Something isn't working
[dev branch](/BoidCMS/BoidCMS/labels/dev%20branch)
Available in the development branch (ready for testing and review)
[fixed](/BoidCMS/BoidCMS/labels/fixed)
This issue has been resolved
[help wanted](/BoidCMS/BoidCMS/labels/help%20wanted)
Extra attention is needed
[high priority](/BoidCMS/BoidCMS/labels/high%20priority)
The issue or pull request requires immediate attention
[in progress](/BoidCMS/BoidCMS/labels/in%20progress)
Work is currently underway on the issue or pull request

## Comments

[![@1337kid](https://avatars.githubusercontent.com/u/45532566?s=80&u=f4e8aa83e7e965630365692662ea1a3dbe6103de&v=4)](/1337kid)

Copy link

### **[1337kid](/1337kid)** commented [Jul 13, 2023](#issue-1802608596)

| Overview By default, an authenticated user cannot upload a PHP file due to mime type checks but it can be bypassed by adding a GIF header at the beginning of the PHP file. **"finfo"** considers a PHP file with GIF header as a GIF file instead of PHP.  ``` // shell.php GIF89a; <?php system($_GET["cmd"]); ?> ```  The above PHP code can be uploaded, bypassing mime type checks. Command execution  Possible fix Add a file extension checking mechanism to prevent upload of PHP file ..etc |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@shoaiyb](https://avatars.githubusercontent.com/u/75518689?s=40&u=b8bb1b9ef69b40112d405049b8dec34a5d21f16a&v=4)](/shoaiyb)
[shoaiyb](/shoaiyb)
added
[bug](/BoidCMS/BoidCMS/labels/bug)
Something isn't working
[help wanted](/BoidCMS/BoidCMS/labels/help%20wanted)
Extra attention is needed
labels
[Jul 14, 2023](#event-9822035553)

[![@shoaiyb](https://avatars.githubusercontent.com/u/75518689?s=80&u=b8bb1b9ef69b40112d405049b8dec34a5d21f16a&v=4)](/shoaiyb)

Copy link

Collaborator

### **[shoaiyb](/shoaiyb)** commented [Jul 14, 2023](#issuecomment-1636069112)

| Hey there,  Thanks for reaching out and bringing this issue to my attention.  This issue initially seemed like a self-attack to me when I was first writing the code, but now I am convinced that an innocent authenticated user could potentially upload the file.  I have identified two to three possible ways to reproduce this issue, including using [.htaccess](http://blog.serverbuddies.com/disable-script-execution-using-htaccess/), the [PHP runtime configuration](http://docs.php.net/manual/en/apache.configuration.php#ini.engine), and the file extension checking.  I have tested all these methods, and they all worked for me. However, I'm unsure about the best approach or whether they will work on every installation.   ---   The extension checking mechanism will prevent any type of file without extension from being uploaded, including text files. The file extension will be the same as the file name if it has no extension. So, unless the file name is in the list of whitelisted extensions, it will never be uploaded.  ``` $extension = explode( '.', $basename ); $extension = strtolower( end( $extension ) ); $extensions = $this->_l( 'media_extension',   array(     // Extensions whitelist   ) ); if ( ! in_array( $extension, $extensions ) ) {   $msg = 'File extension not allowed';   return false; } ```  However, I have considered files without extensions and thought about checking if a file is a plain text file and allowing the upload that way.  ``` $extension = explode( '.', $basename ); $extension = strtolower( end( $extension ) ); $extensions = $this->_l( 'media_extension',   array(     // Extensions whitelist   ) ); if ( ! in_array( $extension, $extensions ) ) {   if ( $extension !== $basename || 'text/plain' !== $type ) {     $msg = 'File extension not allowed';     return false;   } } ```  ---   Disabling script execution using `.htaccess` is more of a blacklisting approach rather than whitelisting, so there is no guarantee that the blacklisted scripts are the only scripts that can be uploaded.  ``` AddHandler cgi-script .php .pl .jsp .asp .sh .cgi Options -ExecCGI ```  --- |
| --- |

All reactions

Sorry, something went wrong.

[![@shoaiyb](https://avatars.githubusercontent.com/u/75518689?s=40&u=b8bb1b9ef69b40112d405049b8dec34a5d21f16a&v=4)](/shoaiyb)
[shoaiyb](/shoaiyb)
added
[high priority](/BoidCMS/BoidCMS/labels/high%20priority)
The issue or pull request requires immediate attention
[in progress](/BoidCMS/BoidCMS/labels/in%20progress)
Work is currently underway on the issue or pull request
labels
[Jul 14, 2023](#event-9823744717)

[![@1337kid](https://avatars.githubusercontent.com/u/45532566?s=80&u=f4e8aa83e7e965630365692662ea1a3dbe6103de&v=4)](/1337kid)

Copy link

Author

### **[1337kid](/1337kid)** commented [Jul 14, 2023](#issuecomment-1636132476)

| The one with extension whitelist looks fine. If the user indeed wants to upload codes, an extension changing mechanism can be induced. For example: script.php to script.php.txt or script\_php.txt |
| --- |

 👍
1
 shoaiyb reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@shoaiyb](https://avatars.githubusercontent.com/u/75518689?s=80&u=b8bb1b9ef69b40112d405049b8dec34a5d21f16a&v=4)](/shoaiyb)

Copy link

Collaborator

### **[shoaiyb](/shoaiyb)** commented [Jul 14, 2023](#issuecomment-1636148314)

| The one with extension whitelist looks fine. If the user indeed wants to upload codes, an extension changing mechanism can be induced. For example: script.php to script.php.txt or script\_php.txt  Do you agree with the "checking if a file is a plain text file and allowing the upload" way? |
| --- |

All reactions

Sorry, something went wrong.

[![@1337kid](https://avatars.githubusercontent.com/u/45532566?s=80&u=f4e8aa83e7e965630365692662ea1a3dbe6103de&v=4)](/1337kid)

Copy link

Author

### **[1337kid](/1337kid)** commented [Jul 14, 2023](#issuecomment-1636150318)

| Yes, I agree with that. It's a good idea. |
| --- |

All reactions

Sorry, something went wrong.

[![@shoaiyb](https://avatars.githubusercontent.com/u/75518689?s=80&u=b8bb1b9ef69b40112d405049b8dec34a5d21f16a&v=4)](/shoaiyb)

Copy link

Collaborator

### **[shoaiyb](/shoaiyb)** commented [Jul 14, 2023](#issuecomment-1636172905) • edited Loading

| Yes, I agree with that. It's a good idea.  Good 👍 The fix will soon be at the `develop` branch for additional testing.  One more thing, can you please take a look and see if any of the default [allowed MIME types](https://boidcms.github.io/#/media/allowed) should be removed? |
| --- |

All reactions

Sorry, something went wrong.

[![@1337kid](https://avatars.githubusercontent.com/u/45532566?s=80&u=f4e8aa83e7e965630365692662ea1a3dbe6103de&v=4)](/1337kid)

Copy link

Author

### **[1337kid](/1337kid)** commented [Jul 14, 2023](#issuecomment-1636178271)

| Alright 👍 Lemme check the mime types |
| --- |

All reactions

Sorry, something went wrong.

[![@1337kid](https://avatars.githubusercontent.com/u/45532566?s=80&u=f4e8aa83e7e965630365692662ea1a3dbe6103de&v=4)](/1337kid)

Copy link

Author

### **[1337kid](/1337kid)** commented [Jul 14, 2023](#issuecomment-1636196093) • edited Loading

| One more thing, can you please take a look and see if any of the default [allowed MIME types](https://boidcms.github.io/#/media/allowed) should be removed?  A PHP file with random bytes on the first line will get uploaded. example:  ``` // file.php asdfghj34567yhjndtetstetlhbkERFVj65678; <?php system($_GET['cmd']); ?> ```  This file will bypass mime type checks. I think this file is categorized as `application/octet-stream` by finfo due to random data at the beginning. Btw, there is no point in removing `application/octet-stream` . Any file with random data will be considered as `application/octet-stream` and file need not be an executable. Adding an extension whitelist is the better choice. |
| --- |

 👍
1
 shoaiyb reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@shoaiyb](https://avatars.githubusercontent.com/u/75518689?s=80&u=b8bb1b9ef69b40112d405049b8dec34a5d21f16a&v=4)](/shoaiyb)

Copy link

Collaborator

### **[shoaiyb](/shoaiyb)** commented [Jul 14, 2023](#issuecomment-1636381797)

| Yeah, the extension checking will also fix that.  Anyway, below are the extension to be whitelisted:  ``` avi avif css doc docx flv gif htm html ico jpeg jpg kdbx m4a mkv mov mp3 mp4 mpg ods odt ogg ogv pdf png ppt pptx psd rar svg txt xls xlsx webm webp wmv zip  ``` |
| --- |

All reactions

Sorry, something went wrong.

[shoaiyb](/shoaiyb)
added a commit
that referenced
this issue
[Jul 14, 2023](#ref-commit-6a2eb22)
[![@shoaiyb](https://avatars.githubusercontent.com/u/75518689?s=40&u=b8bb1b9ef69b40112d405049b8dec34a5d21f16a&v=4)](/shoaiyb)

`[Fix to VUL:](/BoidCMS/BoidCMS/commit/6a2eb225f7ad8353a75a8648dc90f3e1ba2d9dac "Fix to VUL: #27 by @1337kid") [#27](https://github.com/BoidCMS/BoidCMS/issues/27) [by](/BoidCMS/BoidCMS/commit/6a2eb225f7ad8353a75a8648dc90f3e1ba2d9dac "Fix to VUL: #27 by @1337kid") [@1337kid](https://github.com/1337kid)`

`[6a2eb22](/BoidCMS/BoidCMS/commit/6a2eb225f7ad8353a75a8648dc90f3e1ba2d9dac)`

[![@shoaiyb](https://avatars.githubusercontent.com/u/75518689?s=40&u=b8bb1b9ef69b40112d405049b8dec34a5d21f16a&v=4)](/shoaiyb)
[shoaiyb](/shoaiyb)
added
the
[dev branch](/BoidCMS/BoidCMS/labels/dev%20branch)
Available in the development branch (ready for testing and review)
label
[Jul 14, 2023](#event-9825748704)

[![@shoaiyb](https://avatars.githubusercontent.com/u/75518689?s=40&u=b8bb1b9ef69b40112d405049b8dec34a5d21f16a&v=4)](/shoaiyb)
[shoaiyb](/shoaiyb)
self-assigned this
[Jul 14, 2023](#event-9825758185)

[![@1337kid](https://avatars.githubusercontent.com/u/45532566?s=80&u=f4e8aa83e7e965630365692662ea1a3dbe6103de&v=4)](/1337kid)

Copy link

Author

### **[1337kid](/1337kid)** commented [Jul 15, 2023](#issuecomment-1636596938)

| The whitelist looks clean. 👍 |
| --- |

All reactions

Sorry, something went wrong.

[![@shoaiyb](https://avatars.githubusercontent.com/u/75518689?s=40&u=b8bb1b9ef69b40112d405049b8dec34a5d21f16a&v=4)](/shoaiyb)
[shoaiyb](/shoaiyb)
linked a pull request
[Jul 15, 2023](#event-9829535222)
that will
close
this issue

[v2.0.0
#17](/BoidCMS/BoidCMS/pull/17)
 Merged

[![@shoaiyb](https://avatars.githubusercontent.com/u/75518689?s=40&u=b8bb1b9ef69b40112d405049b8dec34a5d21f16a&v=4)](/shoaiyb)
[shoaiyb](/shoaiyb)
removed a link to a pull request
[Jul 15, 2023](#event-9829541343)

[v2.0.0
#17](/BoidCMS/BoidCMS/pull/17)
 Merged

[![@shoaiyb](https://avatars.githubusercontent.com/u/75518689?s=40&u=b8bb1b9ef69b40112d405049b8dec34a5d21f16a&v=4)](/shoaiyb)
[shoaiyb](/shoaiyb)
closed this as [completed](/BoidCMS/BoidCMS/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Jul 15, 2023](#event-9830094336)

[![@shoaiyb](https://avatars.githubusercontent.com/u/75518689?s=40&u=b8bb1b9ef69b40112d405049b8dec34a5d21f16a&v=4)](/shoaiyb)
[shoaiyb](/shoaiyb)
linked a pull request
[Jul 15, 2023](#event-9830100522)
that will
close
this issue

[Fix for vulnerability #27 implemented
#28](/BoidCMS/BoidCMS/pull/28)
 Merged

[shoaiyb](/shoaiyb)
added a commit
that referenced
this issue
[Jul 15, 2023](#ref-commit-2519f20)
[![@shoaiyb](https://avatars.githubusercontent.com/u/75518689?s=40&u=b8bb1b9ef69b40112d405049b8dec34a5d21f16a&v=4)](/shoaiyb)

`[Fix for vulnerability](/BoidCMS/BoidCMS/commit/2519f20258089285a362928ac3b80e5a40bbc879 "Fix for vulnerability #27 implemented (#28)

* Fix to VUL: #27 by @1337kid

* Extensive fix for file upload vulnerability") [#27](https://github.com/BoidCMS/BoidCMS/issues/27) [implemented (](/BoidCMS/BoidCMS/commit/2519f20258089285a362928ac3b80e5a40bbc879 "Fix for vulnerability #27 implemented (#28)

* Fix to VUL: #27 by @1337kid

* Extensive fix for file upload vulnerability")[#28](https://github.com/BoidCMS/BoidCMS/pull/28)[)](/BoidCMS/BoidCMS/commit/2519f20258089285a362928ac3b80e5a40bbc879 "Fix for vulnerability #27 implemented (#28)

* Fix to VUL: #27 by @1337kid

* Extensive fix for file upload vulnerability")`
…

`[2519f20](/BoidCMS/BoidCMS/commit/2519f20258089285a362928ac3b80e5a40bbc879)`

```
* Fix to VUL: [#27](https://github.com/BoidCMS/BoidCMS/issues/27) by [@1337kid](https://github.com/1337kid)

* Extensive fix for file upload vulnerability
```

[![@shoaiyb](https://avatars.githubusercontent.com/u/75518689?s=40&u=b8bb1b9ef69b40112d405049b8dec34a5d21f16a&v=4)](/shoaiyb)
[shoaiyb](/shoaiyb)
added
the
[fixed](/BoidCMS/BoidCMS/labels/fixed)
This issue has been resolved
label
[Jul 15, 2023](#event-9830104582)

[![@jheysel-r7](https://avatars.githubusercontent.com/u/23320005?s=40&v=4)](/jheysel-r7)
[jheysel-r7](/jheysel-r7)
mentioned this issue
[Feb 22, 2024](#ref-pullrequest-2131219616)

[Add module for BoidCMS Authenticated RCE CVE-2023-38836
rapid7/metasploit-framework#18827](/rapid7/metasploit-framework/pull/18827)
 Merged

6 tasks

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FBoidCMS%2FBoidCMS%2Fissues%2F27)

Assignees

[![@shoaiyb](https://avatars.githubusercontent.com/u/75518689?s=40&v=4)](/shoaiyb) [shoaiyb](/shoaiyb)

Labels

[bug](/BoidCMS/BoidCMS/labels/bug)
Something isn't working
[dev branch](/BoidCMS/BoidCMS/labels/dev%20branch)
Available in the development branch (ready for testing and review)
[fixed](/BoidCMS/BoidCMS/labels/fixed)
This issue has been resolved
[help wanted](/BoidCMS/BoidCMS/labels/help%20wanted)
Extra attention is needed
[high priority](/BoidCMS/BoidCMS/labels/high%20priority)
The issue or pull request requires immediate attention
[in progress](/BoidCMS/BoidCMS/labels/in%20progress)
Work is currently underway on the issue or pull request

Projects

None yet

Milestone

No milestone

Development

Successfully merging a pull request may close this issue.

 [Fix for vulnerability #27 implemented](/BoidCMS/BoidCMS/pull/28)
 [BoidCMS/BoidCMS](/BoidCMS/BoidCMS)

2 participants

[![@1337kid](https://avatars.githubusercontent.com/u/45532566?s=52&v=4)](/1337kid) [![@shoaiyb](https://avatars.githubusercontent.com/u/75518689?s=52&v=4)](/shoaiyb)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


