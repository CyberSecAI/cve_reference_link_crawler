=== Content from medium.com_e71771a4_20250111_003503.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F70cced459202&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40kobbycyber%2Fterratec-dmx-6fire-usb-unquoted-service-path-cve-2024-31804-70cced459202&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40kobbycyber%2Fterratec-dmx-6fire-usb-unquoted-service-path-cve-2024-31804-70cced459202&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# Terratec dmx\_6fire usb — Unquoted Service Path v.1.23.0.02(CVE-2024–31804)

[![ALFA TECH](https://miro.medium.com/v2/da:true/resize:fill:88:88/0*mL8Jn_eUHsIcD4Cp)](/%40kobbycyber?source=post_page---byline--70cced459202--------------------------------)

[ALFA TECH](/%40kobbycyber?source=post_page---byline--70cced459202--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F36646e0c8421&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40kobbycyber%2Fterratec-dmx-6fire-usb-unquoted-service-path-cve-2024-31804-70cced459202&user=ALFA+TECH&userId=36646e0c8421&source=post_page-36646e0c8421--byline--70cced459202---------------------post_header-----------)

3 min read·Apr 10, 2024

--

Listen

Share

Title: Terratec DMX\_6Fire USB — Unquoted Service Path Vulnerability (CVE-2024–31804)

![]()![]()

\*\*Introduction:\*\*

Recently, I uncovered a significant vulnerability in the Terratec DMX\_6Fire USB audio interface, a popular device among music producers and enthusiasts. This vulnerability, identified as an Unquoted Service Path (CVE-2024–31804), poses a serious security risk to users of this device and highlights the importance of diligent security practices in the development and deployment of hardware and software.

\*\*Overview of the Vulnerability:\*\*

The Unquoted Service Path vulnerability arises from a flaw in the way the Terratec DMX\_6Fire USB software is installed and executed on Windows operating systems. Specifically, the installation process fails to enclose the file paths of certain services within quotation marks, leaving them susceptible to manipulation by malicious actors.

\*\*Potential Impact:\*\*

Exploiting this vulnerability could allow an attacker to execute arbitrary code with elevated privileges on a target system. By manipulating the file paths of the affected services, an attacker could substitute malicious executable files for legitimate ones, leading to unauthorized access, data theft, or further system compromise.

\*\*Risk Mitigation:\*\*

While Terratec has not yet released an official patch to address this vulnerability, users can take several steps to mitigate the risk:

1. \*\*Update and Patch Management:\*\* Stay informed about any updates or patches released by Terratec for the DMX\_6Fire USB software. Install these updates promptly to mitigate the risk of exploitation.

2. \*\*Security Software:\*\* Deploy reputable antivirus and antimalware solutions that can detect and block suspicious activities, including attempts to exploit the Unquoted Service Path vulnerability.

3. \*\*User Permissions:\*\* Limit user privileges on systems running the Terratec DMX\_6Fire USB software to minimize the impact of potential attacks.

4. \*\*Firewall Configuration:\*\* Configure firewalls to restrict inbound and outbound network traffic, preventing unauthorized communication with malicious entities.

5. \*\*Regular Audits:\*\* Conduct regular security audits of systems and devices to identify and address potential vulnerabilities proactively.

\*\*Reporting and Disclosure:\*\*

I have attempted to contact Terratec regarding this vulnerability, but unfortunately, I have not received a response. It’s worth noting that Terratec is no longer producing the audio card that utilizes this software, and the software itself has been discontinued. Given this situation, it’s imperative for users to take proactive measures to secure their systems, such as discontinuing the use of the affected software or implementing additional security measures to mitigate the risk of exploitation

* \*Proof:\*\*

C:\Users\Astra>sc qc “ttdmx6firesvc”
> {SC] QueryServiceConfig SUCCESS
>
> SERVICE\_NAME: ttdmx6firesvc
> TYPE : 10 WIN32\_OWN\_PROCESS
> START\_TYPE : 2 AUTO\_START
> ERROR\_CONTROL : 1 NORMAL
> BINARY\_PATH\_NAME : C:\Program Files\TerraTec\DMX6FireUSB\ttdmx6firesvc.exe -service
> LOAD\_ORDER\_GROUP : PlugPlay
> TAG : 0
> DISPLAY\_NAME : DMX6Fire Control
> DEPENDENCIES : eventlog
> : PlugPlay
> SERVICE\_START\_NAME : LocalSystem

\*\*Conclusion:\*\*

The Unquoted Service Path vulnerability in the Terratec DMX\_6Fire USB audio interface underscores the importance of robust security measures in hardware and software development. By promptly addressing vulnerabilities and implementing rigorous security practices, manufacturers can enhance the safety and integrity of their products, safeguarding users against potential threats.

As users, it is crucial to remain vigilant, stay informed about security risks, and adopt proactive measures to mitigate the impact of potential vulnerabilities. Together, through collaboration and diligence, we can enhance the security posture of the digital ecosystem and protect against emerging threats.

Stay safe, stay informed, and prioritize security in all your digital endeavors.

— -
This post aims to inform users about the vulnerability, provide guidance on mitigating the risk, and emphasize the importance of security in technology products.

[Security Research](/tag/security-research?source=post_page-----70cced459202--------------------------------)[Vulnerability Management](/tag/vulnerability-management?source=post_page-----70cced459202--------------------------------)[Hacking](/tag/hacking?source=post_page-----70cced459202--------------------------------)

--

--

[![ALFA TECH](https://miro.medium.com/v2/resize:fill:96:96/0*mL8Jn_eUHsIcD4Cp)](/%40kobbycyber?source=post_page---post_author_info--70cced459202--------------------------------)[![ALFA TECH](https://miro.medium.com/v2/resize:fill:128:128/0*mL8Jn_eUHsIcD4Cp)](/%40kobbycyber?source=post_page---post_author_info--70cced459202--------------------------------)Follow[## Written by ALFA TECH](/%40kobbycyber?source=post_page---post_author_info--70cced459202--------------------------------)0 Followers·[2 Following](/%40kobbycyber/following?source=post_page---post_author_info--70cced459202--------------------------------)Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----70cced459202--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----70cced459202--------------------------------)[About](/about?autoplay=1&source=post_page-----70cced459202--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----70cced459202--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----70cced459202--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----70cced459202--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----70cced459202--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----70cced459202--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----70cced459202--------------------------------)[Teams](/business?source=post_page-----70cced459202--------------------------------)



=== Content from www.exploit-db.com_61769a6c_20250111_003504.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# Terratec dmx\_6fire USB - Unquoted Service Path

#### EDB-ID:

###### 51977

#### CVE:

###### [2024-31804](https://nvd.nist.gov/vuln/detail/CVE-2024-31804)

---

**EDB Verified:**

#### Author:

###### [Joseph Kwabena Fiagbor](/?author=12155)

#### Type:

###### [local](/?type=local)

---

#### Platform:

###### [Windows\_x86-64](/?platform=windows_x86-64)

#### Date:

###### 2024-04-12

---

**Vulnerable App:**

```
# Exploit Title:  Terratec dmx_6fire USB - Unquoted Service Path
# Google Dork: null
# Date: 4/10/2024
# Exploit Author: Joseph Kwabena Fiagbor
# Vendor Homepage: https://dmx-6fire-24-96-controlpanel.software.informer.com/download/
# Software Link:
# Version: v.1.23.0.02
# Tested on: windows 7-11
# CVE : CVE-2024-31804

1. Description:

The Terratec dmx_6fire usb installs as a service with an unquoted service
path running
with SYSTEM privileges.
This could potentially allow an authorized but non-privileged local
user to execute arbitrary code with elevated privileges on the system.

2. Proof

> C:\Users\Astra>sc qc "ttdmx6firesvc"
> {SC] QueryServiceConfig SUCCESS
>
> SERVICE_NAME: ttdmx6firesvc
>         TYPE               : 10  WIN32_OWN_PROCESS
>         START_TYPE         : 2   AUTO_START
>         ERROR_CONTROL      : 1   NORMAL
>         BINARY_PATH_NAME   : C:\Program Files\TerraTec\DMX6FireUSB\ttdmx6firesvc.exe -service
>         LOAD_ORDER_GROUP   : PlugPlay
>         TAG                : 0
>         DISPLAY_NAME       : DMX6Fire Control
>         DEPENDENCIES       : eventlog
>                            : PlugPlay
>         SERVICE_START_NAME : LocalSystem
>
>

```

**Tags:**

**Advisory/Source:**
Link

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

×

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as “Google Hacking” was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny’s talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term “Googledork” to refer
to “a foolish or inept person as revealed by Google“. This was meant to draw attention to
the fact that this was not a “Google problem” but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term “dork” became shorthand for a search query that located sensitive
information and “dorks” were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

×

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

×

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search



=== Content from www.ired.team_453d0262_20250111_003505.html ===
[![](https://www.ired.team/~gitbook/image?url=https%3A%2F%2F386337598-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-legacy-files%2Fo%2Fspaces%252F-LFEMnER3fywgFHoroYn%252Favatar.png%3Fgeneration%3D1536436814766237%26alt%3Dmedia&width=32&dpr=4&quality=100&sign=29a0b597&sv=2)![](https://www.ired.team/~gitbook/image?url=https%3A%2F%2F386337598-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-legacy-files%2Fo%2Fspaces%252F-LFEMnER3fywgFHoroYn%252Favatar.png%3Fgeneration%3D1536436814766237%26alt%3Dmedia&width=32&dpr=4&quality=100&sign=29a0b597&sv=2)Red Team Notes](/)Search...Ctrl + K

* [What is ired.team notes?](/)
* Pinned
  + [Pentesting Cheatsheets](/offensive-security-experiments/offensive-security-cheetsheets)
    - [SQL Injection & XSS Playground](/offensive-security-experiments/offensive-security-cheetsheets/sql-injection-xss-playground)
  + [Active Directory & Kerberos Abuse](/offensive-security-experiments/active-directory-kerberos-abuse)
    - [From Domain Admin to Enterprise Admin](/offensive-security-experiments/active-directory-kerberos-abuse/child-domain-da-to-ea-in-parent-domain)
    - [Kerberoasting](/offensive-security-experiments/active-directory-kerberos-abuse/t1208-kerberoasting)
    - [Kerberos: Golden Tickets](/offensive-security-experiments/active-directory-kerberos-abuse/kerberos-golden-tickets)
    - [Kerberos: Silver Tickets](/offensive-security-experiments/active-directory-kerberos-abuse/kerberos-silver-tickets)
    - [AS-REP Roasting](/offensive-security-experiments/active-directory-kerberos-abuse/as-rep-roasting-using-rubeus-and-hashcat)
    - [Kerberoasting: Requesting RC4 Encrypted TGS when AES is Enabled](/offensive-security-experiments/active-directory-kerberos-abuse/kerberoasting-requesting-rc4-encrypted-tgs-when-aes-is-enabled)
    - [Kerberos Unconstrained Delegation](/offensive-security-experiments/active-directory-kerberos-abuse/domain-compromise-via-unrestricted-kerberos-delegation)
    - [Kerberos Constrained Delegation](/offensive-security-experiments/active-directory-kerberos-abuse/abusing-kerberos-constrained-delegation)
    - [Kerberos Resource-based Constrained Delegation: Computer Object Takeover](/offensive-security-experiments/active-directory-kerberos-abuse/resource-based-constrained-delegation-ad-computer-object-take-over-and-privilged-code-execution)
    - [Domain Compromise via DC Print Server and Kerberos Delegation](/offensive-security-experiments/active-directory-kerberos-abuse/domain-compromise-via-dc-print-server-and-kerberos-delegation)
    - [DCShadow - Becoming a Rogue Domain Controller](/offensive-security-experiments/active-directory-kerberos-abuse/t1207-creating-rogue-domain-controllers-with-dcshadow)
    - [DCSync: Dump Password Hashes from Domain Controller](/offensive-security-experiments/active-directory-kerberos-abuse/dump-password-hashes-from-domain-controller-with-dcsync)
    - [PowerView: Active Directory Enumeration](/offensive-security-experiments/active-directory-kerberos-abuse/active-directory-enumeration-with-powerview)
    - [Abusing Active Directory ACLs/ACEs](/offensive-security-experiments/active-directory-kerberos-abuse/abusing-active-directory-acls-aces)
    - [Privileged Accounts and Token Privileges](/offensive-security-experiments/active-directory-kerberos-abuse/privileged-accounts-and-token-privileges)
    - [From DnsAdmins to SYSTEM to Domain Compromise](/offensive-security-experiments/active-directory-kerberos-abuse/from-dnsadmins-to-system-to-domain-compromise)
    - [Pass the Hash with Machine$ Accounts](/offensive-security-experiments/active-directory-kerberos-abuse/pass-the-hash-with-machine-accounts)
    - [BloodHound with Kali Linux: 101](/offensive-security-experiments/active-directory-kerberos-abuse/abusing-active-directory-with-bloodhound-on-kali-linux)
    - [Backdooring AdminSDHolder for Persistence](/offensive-security-experiments/active-directory-kerberos-abuse/how-to-abuse-and-backdoor-adminsdholder-to-obtain-domain-admin-persistence)
    - [Active Directory Enumeration with AD Module without RSAT or Admin Privileges](/offensive-security-experiments/active-directory-kerberos-abuse/active-directory-enumeration-with-ad-module-without-rsat-or-admin-privileges)
    - [Enumerating AD Object Permissions with dsacls](/offensive-security-experiments/active-directory-kerberos-abuse/using-dsacls-to-check-ad-object-permissions)
    - [Active Directory Password Spraying](/offensive-security-experiments/active-directory-kerberos-abuse/active-directory-password-spraying)
    - [Active Directory Lab with Hyper-V and PowerShell](/offensive-security-experiments/active-directory-kerberos-abuse/active-directory-lab-with-hyper-v-and-powershell)
    - [ADCS + PetitPotam NTLM Relay: Obtaining krbtgt Hash with Domain Controller Machine Certificate](/offensive-security-experiments/active-directory-kerberos-abuse/adcs-%2B-petitpotam-ntlm-relay-obtaining-krbtgt-hash-with-domain-controller-machine-certificate)
    - [From Misconfigured Certificate Template to Domain Admin](/offensive-security-experiments/active-directory-kerberos-abuse/from-misconfigured-certificate-template-to-domain-admin)
    - [Shadow Credentials](/offensive-security-experiments/active-directory-kerberos-abuse/shadow-credentials)
    - [Abusing Trust Account$: Accessing Resources on a Trusted Domain from a Trusting Domain](/offensive-security-experiments/active-directory-kerberos-abuse/abusing-trust-accountusd-accessing-resources-on-a-trusted-domain-from-a-trusting-domain)
* offensive security
  + [Red Team Infrastructure](/offensive-security/red-team-infrastructure)
    - [HTTP Forwarders / Relays](/offensive-security/red-team-infrastructure/redirectors-forwarders)
    - [SMTP Forwarders / Relays](/offensive-security/red-team-infrastructure/smtp)
    - [Phishing with Modlishka Reverse HTTP Proxy](/offensive-security/red-team-infrastructure/how-to-setup-modliska-reverse-http-proxy-for-phishing)
    - [Automating Red Team Infrastructure with Terraform](/offensive-security/red-team-infrastructure/automating-red-team-infrastructure-with-terraform)
    - [Cobalt Strike 101](/offensive-security/red-team-infrastructure/cobalt-strike-101-installation-and-interesting-commands)
    - [Powershell Empire 101](/offensive-security/red-team-infrastructure/powershell-empire-101)
    - [Spiderfoot 101 with Kali using Docker](/offensive-security/red-team-infrastructure/spiderfoot-101-with-kali-using-docker)
  + [Initial Access](/offensive-security/initial-access)
    - [Password Spraying Outlook Web Access: Remote Shell](/offensive-security/initial-access/password-spraying-outlook-web-access-remote-shell)
    - [Phishing with MS Office](/offensive-security/initial-access/phishing-with-ms-office)
      * [Phishing: XLM / Macro 4.0](/offensive-security/initial-access/phishing-with-ms-office/phishing-xlm-macro-4.0)
      * [T1173: Phishing - DDE](/offensive-security/initial-access/phishing-with-ms-office/t1173-dde)
      * [T1137: Phishing - Office Macros](/offensive-security/initial-access/phishing-with-ms-office/t1137-office-vba-macros)
      * [Phishing: OLE + LNK](/offensive-security/initial-access/phishing-with-ms-office/phishing-ole-%2B-lnk)
      * [Phishing: Embedded Internet Explorer](/offensive-security/initial-access/phishing-with-ms-office/phishing-embedded-internet-explorer)
      * [Phishing: .SLK Excel](/offensive-security/initial-access/phishing-with-ms-office/phishing-.slk-excel)
      * [Phishing: Replacing Embedded Video with Bogus Payload](/offensive-security/initial-access/phishing-with-ms-office/phishing-replacing-embedded-video-with-bogus-payload)
      * [Inject Macros from a Remote Dotm Template](/offensive-security/initial-access/phishing-with-ms-office/inject-macros-from-a-remote-dotm-template-docx-with-macros)
      * [Bypassing Parent Child / Ancestry Detections](/offensive-security/initial-access/phishing-with-ms-office/bypassing-malicious-macro-detections-by-defeating-child-parent-process-relationships)
      * [Phishing: Embedded HTML Forms](/offensive-security/initial-access/phishing-with-ms-office/phishing-embedded-html-forms)
    - [Phishing with GoPhish and DigitalOcean](/offensive-security/initial-access/phishing-with-gophish-and-digitalocean)
    - [Forced Authentication](/offensive-security/initial-access/t1187-forced-authentication)
    - [NetNTLMv2 hash stealing using Outlook](/offensive-security/initial-access/netntlmv2-hash-stealing-using-outlook)
  + [Code Execution](/offensive-security/code-execution)
    - [regsvr32](/offensive-security/code-execution/t1117-regsvr32-aka-squiblydoo)
    - [MSHTA](/offensive-security/code-execution/t1170-mshta-code-execution)
    - [Control Panel Item](/offensive-security/code-execution/t1196-control-panel-item-code-execution)
    - [Executing Code as a Control Panel Item through an Exported Cplapplet Function](/offensive-security/code-execution/executing-code-in-control-panel-item-through-an-exported-cplapplet-function)
    - [Code Execution through Control Panel Add-ins](/offensive-security/code-execution/code-execution-through-control-panel-add-ins)
    - [CMSTP](/offensive-security/code-execution/t1191-cmstp-code-execution)
    - [InstallUtil](/offensive-security/code-execution/t1118-installutil)
    - [Using MSBuild to Execute Shellcode in C#](/offensive-security/code-execution/using-msbuild-to-execute-shellcode-in-c)
    - [Forfiles Indirect Command Execution](/offensive-security/code-execution/t1202-forfiles-indirect-command-execution)
    - [Application Whitelisting Bypass with WMIC and XSL](/offensive-security/code-execution/application-whitelisting-bypass-with-wmic-and-xsl)
    - [Powershell Without Powershell.exe](/offensive-security/code-execution/powershell-without-powershell)
    - [Powershell Constrained Language Mode Bypass](/offensive-security/code-execution/powershell-constrained-language-mode-bypass)
    - [Forcing Iexplore.exe to Load a Malicious DLL via COM Abuse](/offensive-security/code-execution/forcing-iexplore.exe-to-load-a-malicious-dll-via-com-abuse)
    - [pubprn.vbs Signed Script Code Execution](/offensive-security/code-execution/t1216-signed-script-ce)
  + [Code & Process Injection](/offensive-security/code-injection-process-injection)
    - [CreateRemoteThread Shellcode Injection](/offensive-security/code-injection-process-injection/process-injection)
    - [DLL Injection](/offensive-security/code-injection-process-injection/dll-injection)
    - [Reflective DLL Injection](/offensive-security/code-injection-process-injection/reflective-dll-injection)
    - [Shellcode Reflective DLL Injection](/offensive-security/code-injection-process-injection/reflective-shellcode-dll-injection)
    - [Process Doppelganging](/offensive-security/code-injection-process-injection/process-doppelganging)
    - [Loading and Executing Shellcode From PE Resources](/offensive-security/code-injection-process-injection/loading-and-executing-shellcode-from-portable-executable-resources)
    - [Process Hollowing and Portable Executable Relocations](/offensive-security/code-injection-process-injection/process-hollowing-and-pe-image-relocations)
    - [APC Queue Code Injection](/offensive-security/code-injection-process-injection/apc-queue-code-injection)
    - [Early Bird APC Queue Code Injection](/offensive-security/code-injection-process-injection/early-bird-apc-queue-code-injection)
    - [Shellcode Execution in a Local Process with QueueUserAPC and NtTestAlert](/offensive-security/code-injection-process-injection/shellcode-execution-in-a-local-process-with-queueuserapc-and-nttestalert)
    - [Shellcode Execution through Fibers](/offensive-security/code-injection-process-injection/executing-shellcode-with-createfiber)
    - [Shellcode Execution via CreateThreadpoolWait](/offensive-security/code-injection-process-injection/shellcode-execution-via-createthreadpoolwait)
    - [Local Shellcode Execution without Windows APIs](/offensive-security/code-injection-process-injection/local-shellcode-execution-without-windows-apis)
    - [Injecting to Remote Process via Thread Hijacking](/offensive-security/code-injection-process-injection/injecting-to-remote-process-via-thread-hijacking)
    - [SetWindowHookEx Code Injection](/offensive-security/code-injection-process-injection/setwindowhookex-code-injection)
    - [Finding Kernel32 Base and Function Addresses in Shellcode](/offensive-security/code-injection-process-injection/finding-kernel32-base-and-function-addresses-in-shellcode)
    - [Executing Shellcode with Inline Assembly in C/C++](/offensive-security/code-injection-process-injection/executing-shellcode-with-inline-assembly-in-c-c%2B%2B)
    - [Writing Custom Shellcode Encoders and Decoders](/offensive-security/code-injection-process-injection/writing-custom-shellcode-encoders-and-decoders)
    - [Backdooring PE Files with Shellcode](/offensive-security/code-injection-process-injection/backdooring-portable-executables-pe-with-shellcode)
    - [NtCreateSection + NtMapViewOfSection Code Injection](/offensive-security/code-injection-process-injection/ntcreatesection-%2B-ntmapviewofsection-code-injection)
    - [AddressOfEntryPoint Code Injection without VirtualAllocEx RWX](/offensive-security/code-injection-process-injection/addressofentrypoint-code-injection-without-virtualallocex-rwx)
    - [Module Stomping for Shellcode Injection](/offensive-security/code-injection-process-injection/modulestomping-dll-hollowing-shellcode-injection)
    - [PE Injection: Executing PEs inside Remote Processes](/offensive-security/code-injection-process-injection/pe-injection-executing-pes-inside-remote-processes)
    - [API Monitoring and Hooking for Offensive Tooling](/offensive-security/code-injection-process-injection/api-monitoring-and-hooking-for-offensive-tooling)
    - [Windows API Hooking](/offensive-security/code-injection-process-injection/how-to-hook-windows-api-using-c%2B%2B)
    - [Import Adress Table (IAT) Hooking](/offensive-security/code-injection-process-injection/import-adress-table-iat-hooking)
    - [DLL Injection via a Custom .NET Garbage Collector](/offensive-security/code-injection-process-injection/injecting-dll-via-custom-.net-garbage-collector-environment-variable-complus_gcname)
    - [Writing and Compiling Shellcode in C](/offensive-security/code-injection-process-injection/writing-and-compiling-shellcode-in-c)
    - [Injecting .NET Assembly to an Unmanaged Process](/offensive-security/code-injection-process-injection/injecting-and-executing-.net-assemblies-to-unmanaged-process)
    - [Binary Exploitation](/offensive-security/code-injection-process-injection/binary-exploitation)
      * [32-bit Stack-based Buffer Overflow](/offensive-security/code-injection-process-injection/binary-exploitation/stack-based-buffer-overflow)
      * [64-bit Stack-based Buffer Overflow](/offensive-security/code-injection-process-injection/binary-exploitation/64-bit-stack-based-buffer-overflow)
      * [Return-to-libc / ret2libc](/offensive-security/code-injection-process-injection/binary-exploitation/return-to-libc-ret2libc)
      * [ROP Chaining: Return Oriented Programming](/offensive-security/code-injection-process-injection/binary-exploitation/rop-chaining-return-oriented-programming)
      * [SEH Based Buffer Overflow](/offensive-security/code-injection-process-injection/binary-exploitation/seh-based-buffer-overflow)
      * [Format String Bug](/offensive-security/code-injection-process-injection/binary-exploitation/format-string-bug)
  + [Defense Evasion](/offensive-security/defense-evasion)
    - [AV Bypass with Metasploit Templates and Custom Binaries](/offensive-security/defense-evasion/av-bypass-with-metasploit-templates)
    - [Evading Windows Defender with 1 Byte Change](/offensive-security/defense-evasion/evading-windows-defender-using-classic-c-shellcode-launcher-with-1-byte-change)
    - [Bypassing Windows Defender: One TCP Socket Away From Meterpreter and Beacon Sessions](/offensive-security/defense-evasion/bypassing-windows-defender-one-tcp-socket-away-from-meterpreter-and-cobalt-strike-beacon)
    - [Bypassing Cylance and other AVs/EDRs by Unhooking Windows APIs](/offensive-security/defense-evasion/bypassing-cylance-and-other-avs-edrs-by-unhooking-windows-apis)
    - [Windows API Hashing in Malware](/offensive-security/defense-evasion/windows-api-hashing-in-malware)
    - [Detecting Hooked Syscalls](/offensive-security/defense-evasion/detecting-hooked-syscall-functions)
    - [Calling Syscalls Directly from Visual Studio to Bypass AVs/EDRs](/offensive-security/defense-evasion/using-syscalls-directly-from-visual-studio-to-bypass-avs-edrs)
    - [Retrieving ntdll Syscall Stubs from Disk at Run-time](/offensive-security/defense-evasion/retrieving-ntdll-syscall-stubs-at-run-time)
    - [Full DLL Unhooking with C++](/offensive-security/defense-evasion/how-to-unhook-a-dll-using-c%2B%2B)
    - [Enumerating RWX Protected Memory Regions for Code Injection](/offensive-security/defense-evasion/finding-all-rwx-protected-memory-regions)
    - [Disabling Windows Event Logs by Suspending EventLog Service Threads](/offensive-security/defense-evasion/disabling-windows-event-logs-by-suspending-eventlog-service-threads)
    - [Obfuscated Powershell Invocations](/offensive-security/defense-evasion/t1027-obfuscated-powershell-invocations)
    - [Masquerading Processes in Userland via \_PEB](/offensive-security/defense-evasion/masquerading-processes-in-userland-through-_peb)
    - [Commandline Obfusaction](/offensive-security/defense-evasion/commandline-obfusaction)
    - [File Smuggling with HTML and JavaScript](/offensive-security/defense-evasion/file-smuggling-with-html-and-javascript)
    - [Timestomping](/offensive-security/defense-evasion/t1099-timestomping)
    - [Alternate Data Streams](/offensive-security/defense-evasion/t1096-alternate-data-streams)
    - [Hidden Files](/offensive-security/defense-evasion/t1158-hidden-files)
    - [Encode/Decode Data with Certutil](/offensive-security/defense-evasion/t1140-encode-decode-data-with-certutil)
    - [Downloading Files with Certutil](/offensive-security/defense-evasion/downloading-file-with-certutil)
    - [Packed Binaries](/offensive-security/defense-evasion/t1045-software-packing-upx)
    - [Unloading Sysmon Driver](/offensive-security/defense-evasion/unloading-sysmon-driver)
    - [Bypassing IDS Signatures with Simple Reverse Shells](/offensive-security/defense-evasion/bypassing-ids-signatures-with-simple-reverse-shells)
    - [Preventing 3rd Party DLLs from Injecting into your Malware](/offensive-security/defense-evasion/preventing-3rd-party-dlls-from-injecting-into-your-processes)
    - [ProcessDynamicCodePolicy: Arbitrary Code Guard (ACG)](/offensive-security/defense-evasion/acg-arbitrary-code-guard-processdynamiccodepolicy)
    - [Parent Process ID (PPID) Spoofing](/offensive-security/defense-evasion/parent-process-id-ppid-spoofing)
    - [Executing C# Assemblies from Jscript and wscript with DotNetToJscript](/offensive-security/defense-evasion/executing-csharp-assemblies-from-jscript-and-wscript-with-dotnettojscript)
  + [Enumeration and Discovery](/offensive-security/enumeration-and-discovery)
    - [Windows Event IDs and Others for Situational Awareness](/offensive-security/enumeration-and-discovery/windows-event-ids-for-situational-awareness)
    - [Enumerating COM Objects and their Methods](/offensive-security/enumeration-and-discovery/enumerating-com-objects-and-their-methods)
    - [Enumerating Users without net, Services without sc and Scheduled Tasks without schtasks](/offensive-security/enumeration-and-discovery/enumerating-users-without-net-services-without-sc-and-scheduled-tasks-without-schtasks)
    - [Enumerating Windows Domains with rpcclient through SocksProxy == Bypassing Command Line Logging](/offensive-security/enumeration-and-discovery/enumerating-windows-domains-using-rpcclient-through-socksproxy-bypassing-command-line-logging)
    - [Dump Global Address List (GAL) from OWA](/offensive-security/enumeration-and-discovery/dumping-gal-global-address-list-from-outlook-web-application)
    - [Application Window Discovery](/offensive-security/enumeration-and-discovery/t1010-application-window-discovery)
    - [Account Discovery & Enumeration](/offensive-security/enumeration-and-discovery/t1087-account-discovery)
    - [Using COM to Enumerate Hostname, Username, Domain, Network Drives](/offensive-security/enumeration-and-discovery/using-com-to-enumerate-hostname-username-domain-network-drives)
    - [Detecting Sysmon on the Victim Host](/offensive-security/enumeration-and-discovery/detecting-sysmon-on-the-victim-host)
  + [Privilege Escalation](/offensive-security/privilege-escalation)
    - [Primary Access Token Manipulation](/offensive-security/privilege-escalation/t1134-access-token-manipulation)
    - [Windows NamedPipes 101 + Privilege Escalation](/offensive-security/privilege-escalation/windows-namedpipes-privilege-escalation)
    - [DLL Hijacking](/offensive-security/privilege-escalation/t1038-dll-hijacking)
    - [WebShells](/offensive-security/privilege-escalation/t1108-redundant-access)
    - [Image File Execution Options Injection](/offensive-security/privilege-escalation/t1183-image-file-execution-options-injection)
    - [Unquoted Service Paths](/offensive-security/privilege-escalation/unquoted-service-paths)
    - [Pass The Hash: Privilege Escalation with Invoke-WMIExec](/offensive-security/privilege-escalation/pass-the-hash-privilege-escalation-with-invoke-wmiexec)
    - [Environment Variable $Path Interception](/offensive-security/privilege-escalation/environment-variable-path-interception)
    - [Weak Service Permissions](/offensive-security/privilege-escalation/weak-service-permissions)
  + [Credential Access & Dumping](/offensive-security/credential-access-and-credential-dumping)
    - [Dumping Credentials from Lsass Process Memory with Mimikatz](/offensive-security/credential-access-and-credential-dumping/dumping-credentials-from-lsass.exe-process-memory)
    - [Dumping Lsass Without Mimikatz](/offensive-security/credential-access-and-credential-dumping/dump-credentials-from-lsass-process-without-mimikatz)
    - [Dumping Lsass without Mimikatz with MiniDumpWriteDump](/offensive-security/credential-access-and-credential-dumping/dumping-lsass-passwords-without-mimikatz-minidumpwritedump-av-signature-bypass)
    - [Dumping Hashes from SAM via Registry](/offensive-security/credential-access-and-credential-dumping/dumping-hashes-from-sam-registry)
    - [Dumping SAM via esentutl.exe](/offensive-security/credential-access-and-credential-dumping/dumping-sam-via-esentutl.exe)
    - [Dumping LSA Secrets](/offensive-security/credential-access-and-credential-dumping/dumping-lsa-secrets)
    - [Dumping and Cracking mscash - Cached Domain Credentials](/offensive-security/credential-access-and-credential-dumping/dumping-and-cracking-mscash-cached-domain-credentials)
    - [Dumping Domain Controller Hashes Locally and Remotely](/offensive-security/credential-access-and-credential-dumping/ntds.dit-enumeration)
    - [Dumping Domain Controller Hashes via wmic and Vssadmin Shadow Copy](/offensive-security/credential-access-and-credential-dumping/dumping-domain-controller-hashes-via-wmic-and-shadow-copy-using-vssadmin)
    - [Network vs Interactive Logons](/offensive-security/credential-access-and-credential-dumping/network-vs-interactive-logons)
    - [Reading DPAPI Encrypted Secrets with Mimikatz and C++](/offensive-security/credential-access-and-credential-dumping/reading-dpapi-encrypted-secrets-with-mimikatz-and-c%2B%2B)
    - [Credentials in Registry](/offensive-security/credential-access-and-credential-dumping/t1214-credentials-in-registry)
    - [Password Filter](/offensive-security/credential-access-and-credential-dumping/t1174-password-filter-dll)
    - [Forcing WDigest to Store Credentials in Plaintext](/offensive-security/credential-access-and-credential-dumping/forcing-wdigest-to-store-credentials-in-plaintext)
    - [Dumping Delegated Default Kerberos and NTLM Credentials w/o Touching Lsass](/offensive-security/credential-access-and-credential-dumping/dumping-delegated-default-kerberos-and-ntlm-credentials-without-touching-lsass)
    - [Intercepting Logon Credentials via Custom Security Support Provider and Authentication Packages](/offensive-security/credential-access-and-credential-dumping/intercepting-logon-credentials-via-custom-security-support-provider-and-authentication-package)
    - [Pulling Web Application Passwords by Hooking HTML Input Fields](/offensive-security/credential-access-and-credential-dumping/stealing-web-application-credentials-by-hooking-input-fields)
    - [Intercepting Logon Credentials by Hooking msv1\_0!SpAcceptCredentials](/offensive-security/credential-access-and-credential-dumping/intercepting-logon-credentials-by-hooking-msv1_0-spacceptcredentials)
    - [Credentials Collection via CredUIPromptForCredentials](/offensive-security/credential-access-and-credential-dumping/credentials-collection-via-creduipromptforcredentials)
  + [Lateral Movement](/offensive-security/lateral-movement)
    - [WinRM for Lateral Movement](/offensive-security/lateral-movement/t1028-winrm-for-lateral-movement)
    - [WinRS for Lateral Movement](/offensive-security/lateral-movement/winrs-for-lateral-movement)
    - [WMI for Lateral Movement](/offensive-security/lateral-movement/t1047-wmi-for-lateral-movement)
    - [RDP Hijacking for Lateral Movement with tscon](/offensive-security/lateral-movement/t1076-rdp-hijacking-for-lateral-movement)
    - [Shared Webroot](/offensive-security/lateral-movement/t1051-shared-webroot)
    - [Lateral Movement via DCOM](/offensive-security/lateral-movement/t1175-distributed-component-object-model)
    - [WMI + MSI Lateral Movement](/offensive-security/lateral-movement/wmi-%2B-msi-lateral-movement)
    - [Lateral Movement via Service Configuration Manager](/offensive-security/lateral-movement/lateral-movement-abusing-service-configuration-manager)
    - [Lateral Movement via SMB Relaying](/offensive-security/lateral-movement/lateral-movement-via-smb-relaying-by-abusing-lack-of-smb-signing)
    - [WMI + NewScheduledTaskAction Lateral Movement](/offensive-security/lateral-movement/wmi-via-newscheduledtask)
    - [WMI + PowerShell Desired State Configuration Lateral Movement](/offensive-security/lateral-movement/wmi-%2B-powershell-desired-state-configuration-lateral-movement)
    - [Simple TCP Relaying with NetCat](/offensive-security/lateral-movement/simple-tcp-relaying-with-netcat)
    - [Empire Shells with NetNLTMv2 Relaying](/offensive-security/lateral-movement/empire-shells-with-netnltmv2-relaying)
    - [Lateral Movement with Psexec](/offensive-security/lateral-movement/lateral-movement-with-psexec)
    - [From Beacon to Interactive RDP Session](/offensive-security/lateral-movement/from-beacon-to-interactive-remote-desktop-rdp-session)
    - [SSH Tunnelling / Port Forwarding](/offensive-security/lateral-movement/ssh-tunnelling-port-forwarding)
    - [Lateral Movement via WMI Event Subscription](/offensive-security/lateral-movement/lateral-movement-via-wmi-events)
    - [Lateral Movement via DLL Hijacking](/offensive-security/lateral-movement/lateral-movement-via-dll-hijacking)
    - [Lateral Movement over headless RDP with SharpRDP](/offensive-security/lateral-movement/lateral-movement-over-headless-rdp-with-sharprdp)
    - [Man-in-the-Browser via Chrome Extension](/offensive-security/lateral-movement/man-in-the-browser-via-chrome-extension)
    - [ShadowMove: Lateral Movement by Duplicating Existing Sockets](/offensive-security/lateral-movement/shadowmove-lateral-movement-by-stealing-duplicating-existing-connected-sockets)
  + [Persistence](/offensive-security/persistence)
    - [DLL Proxying for Persistence](/offensive-security/persistence/dll-proxying-for-persistence)
    - [Schtask](/offensive-security/persistence/t1053-schtask)
    - [Service Execution](/offensive-security/persistence/t1035-service-execution)
    - [Sticky Keys](/offensive-security/persistence/t1015-sethc)
    - [Create Account](/offensive-security/persistence/t1136-create-account)
    - [AddMonitor()](/offensive-security/persistence/t1013-addmonitor)
    - [NetSh Helper DLL](/offensive-security/persistence/t1128-netsh-helper-dll)
    - [Abusing Windows Managent Instrumentation](/offensive-security/persistence/t1084-abusing-windows-managent-instrumentation)
      * [WMI as a Data Storage](/offensive-security/persistence/t1084-abusing-windows-managent-instrumentation/wmi-data-storage)
    - [Windows Logon Helper](/offensive-security/persistence/windows-logon-helper)
    - [Hijacking Default File Extension](/offensive-security/persistence/hijacking-default-file-extension)
    - [Persisting in svchost.exe with a Service DLL](/offensive-security/persistence/persisting-in-svchost.exe-with-a-service-dll-servicemain)
    - [Modifying .lnk Shortcuts](/offensive-security/persistence/modifying-.lnk-shortcuts)
    - [Screensaver Hijack](/offensive-security/persistence/t1180-screensaver-hijack)
    - [Application Shimming](/offensive-security/persistence/t1138-application-shimming)
    - [BITS Jobs](/offensive-security/persistence/t1197-bits-jobs)
    - [COM Hijacking](/offensive-security/persistence/t1122-com-hijacking)
    - [SIP & Trust Provider Hijacking](/offensive-security/persistence/t1198-trust-provider-hijacking)
    - [Hijacking Time Providers](/offensive-security/persistence/t1209-hijacking-time-providers)
    - [Installing Root Certificate](/offensive-security/persistence/t1130-install-root-certificate)
    - [Powershell Profile Persistence](/offensive-security/persistence/powershell-profile-persistence)
    - [RID Hijacking](/offensive-security/persistence/rid-hijacking)
    - [Word Library Add-Ins](/offensive-security/persistence/word-library-add-ins)
    - [Office Templates](/offensive-security/persistence/office-templates)
  + [Exfiltration](/offensive-security/exfiltration)
    - [Powershell Payload Delivery via DNS using Invoke-PowerCloud](/offensive-security/exfiltration/payload-delivery-via-dns-using-invoke-powercloud)
* reversing, forensics & misc
  + [Internals](/miscellaneous-reversing-forensics/windows-kernel-internals)
    - [Configuring Kernel Debugging Environment with kdnet and WinDBG Preview](/miscellaneous-reversing-forensics/windows-kernel-internals/configuring-kernel-debugging-environment-with-kdnet-and-windbg-preview)
    - [Compiling a Simple Kernel Driver, DbgPrint, DbgView](/miscellaneous-reversing-forensics/windows-kernel-internals/compiling-first-kernel-driver-kdprint-dbgprint-and-debugview)
    - [Loading Windows Kernel Driver for Debugging](/miscellaneous-reversing-forensics/windows-kernel-internals/loading-a-windows-kernel-driver-osr-driver-loader-debugging-with-source-code)
    - [Subscribing to Process Creation, Thread Creation and Image Load Notifications from a Kernel Driver](/miscellaneous-reversing-forensics/windows-kernel-internals/subscribing-to-process-creation-thread-creation-and-image-load-notifications-from-a-kernel-driver)
    - [Listing Open Handles and Finding Kernel Object Addresses](/miscellaneous-reversing-forensics/windows-kernel-internals/get-all-open-handles-and-kernel-object-address-from-userland)
    - [Sending Commands From Your Userland Program to Your Kernel Driver using IOCTL](/miscellaneous-reversing-forensics/windows-kernel-internals/sending-commands-from-userland-to-your-kernel-driver-using-ioctl)
    - [Windows Kernel Drivers 101](/miscellaneous-reversing-forensics/windows-kernel-internals/windows-kernel-drivers-101)
    - [Windows x64 Calling Convention: Stack Frame](/miscellaneous-reversing-forensics/windows-kernel-internals/windows-x64-calling-convention-stack-frame)
    - [Linux x64 Calling Convention: Stack Frame](/miscellaneous-reversing-forensics/windows-kernel-internals/linux-x64-calling-convention-stack-frame)
    - [System Service Descriptor Table - SSDT](/miscellaneous-reversing-forensics/windows-kernel-internals/glimpse-into-ssdt-in-windows-x64-kernel)
    - [Interrupt Descriptor Table - IDT](/miscellaneous-reversing-forensics/windows-kernel-internals/interrupt-descriptor-table-idt)
    - [Token Abuse for Privilege Escalation in Kernel](/miscellaneous-reversing-forensics/windows-kernel-internals/how-kernel-exploits-abuse-tokens-for-privilege-escalation)
    - [Manipulating ActiveProcessLinks to Hide Processes in Userland](/miscellaneous-reversing-forensics/windows-kernel-internals/manipulating-activeprocesslinks-to-unlink-processes-in-userland)
    - [ETW: Event Tracing for Windows 101](/miscellaneous-reversing-forensics/windows-kernel-internals/etw-event-tracing-for-windows-101)
    - [Exploring Injected Threads](/miscellaneous-reversing-forensics/windows-kernel-internals/get-injectedthread)
    - [Parsing PE File Headers with C++](/miscellaneous-reversing-forensics/windows-kernel-internals/pe-file-header-parser-in-c%2B%2B)
    - [Instrumenting Windows APIs with Frida](/miscellaneous-reversing-forensics/windows-kernel-internals/instrumenting-windows-apis-with-frida)
    - [Exploring Process Environment Block](/miscellaneous-reversing-forensics/windows-kernel-internals/exploring-process-environment-block)
    - [Writing a Custom Bootloader](/miscellaneous-reversing-forensics/windows-kernel-internals/writing-a-custom-bootloader)
  + [Cloud](/miscellaneous-reversing-forensics/cloud)
    - [AWS Accounts, Users, Groups, Roles, Policies](/miscellaneous-reversing-forensics/cloud/aws-accounts-users-groups-roles-policies)
  + [Neo4j](/miscellaneous-reversing-forensics/neo4j)
  + [Dump Virtual Box Memory](/miscellaneous-reversing-forensics/dump-virtual-box-memory)
  + [AES Encryption Using Crypto++ .lib in Visual Studio C++](/miscellaneous-reversing-forensics/aes-encryption-example-using-cryptopp-.lib-in-visual-studio-c%2B%2B)
  + [Reversing Password Checking Routine](/miscellaneous-reversing-forensics/reversing-password-checking-routine)

[Powered by GitBook](https://www.gitbook.com/?utm_source=content&utm_medium=trademark&utm_campaign=-LFEMnER3fywgFHoroYn)On this page

Last updated 5 years ago

Sometimes it is possible to escalate privileges by abusing misconfigured services. Specifically, this is possible if path to the service binary is not wrapped in quotes and there are spaces in the path.. This stems from the way Windows handles `CreateProcess` API calls:

> If you are using a long file name that contains a space, use quoted strings to indicate where the file name ends and the arguments begin; otherwise, the file name is ambiguous. For example, consider the string "c:\program files\sub dir\program name". This string can be interpreted in a number of ways. The system tries to interpret the possibilities in the following order:
>
> **c:\program.exe** **c:\program files\sub.exe** **c:\program files\sub dir\program.exec:\program files\sub dir\program name.exe...**

## Enumeration

Let's scan the system `ws01` for any potentially misconfigured services - those services that do not have their binary paths wrapped in quotes:

One service is returned:

The above suggests that if we can drop our binary to `c:\program.exe`, we may be able to stop/start the `VulnerableSvc` and get our binary at `c:\program.exe` to run with NT\System privileges:

## Execution

Let's try exploiting the weakness in by droping a meterpreter binary to c:\program.exe and starting the vulnerable service `VulnerableSvc`. Doing so gives us a meterpreter session with `nt authority\system` privileges:

* [Enumeration](#enumeration)
* [Execution](#execution)
[PreviousImage File Execution Options Injection](/offensive-security/privilege-escalation/t1183-image-file-execution-options-injection)[NextPass The Hash: Privilege Escalation with Invoke-WMIExec](/offensive-security/privilege-escalation/pass-the-hash-privilege-escalation-with-invoke-wmiexec)

1. [offensive security](/offensive-security)
3. [Privilege Escalation](/offensive-security/privilege-escalation)
# Unquoted Service Paths

<https://docs.microsoft.com/en-us/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa>attacker@victimCopy
```
cmd /c wmic service get name,displayname,pathname,startmode |findstr /i "auto" |findstr /i /v "c:\windows\\" |findstr /i /v """
```
![](https://www.ired.team/~gitbook/image?url=https%3A%2F%2F386337598-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-legacy-files%2Fo%2Fassets%252F-LFEMnER3fywgFHoroYn%252F-LfM2XGR03lHeUEWDQsy%252F-LfM7NxQ8k1qCsEwzDzH%252FAnnotation%25202019-05-20%2520222415.png%3Falt%3Dmedia%26token%3D9fbd9ade-6eaf-46ca-9e6a-9c8b9ffee8a7&width=768&dpr=4&quality=100&sign=8284eb99&sv=2)![](https://www.ired.team/~gitbook/image?url=https%3A%2F%2F386337598-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-legacy-files%2Fo%2Fassets%252F-LFEMnER3fywgFHoroYn%252F-LfM2XGR03lHeUEWDQsy%252F-LfM5y-Nsau-yXlm12Rq%252FAnnotation%25202019-05-20%2520221801.png%3Falt%3Dmedia%26token%3D648550d8-d410-46e1-95a8-4522354810d4&width=768&dpr=4&quality=100&sign=d31b1ff3&sv=2)![](https://www.ired.team/~gitbook/image?url=https%3A%2F%2F386337598-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-legacy-files%2Fo%2Fassets%252F-LFEMnER3fywgFHoroYn%252F-LfM9GD5Ts95nbRdGxgB%252F-LfM9tBY9rwoQiyK9pjg%252Fvulnservice.gif%3Falt%3Dmedia%26token%3D7ceb6260-1661-4637-be72-89de8825f959&width=768&dpr=4&quality=100&sign=cc833afe&sv=2)
