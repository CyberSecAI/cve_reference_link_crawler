

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%3Fnew%3D3128705%2540form-vibes%26old%3D3128705%2540form-vibes)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/3115327/form-vibes "Changeset 3115327 for form-vibes")
* [Next Change](/changeset/3128710/form-vibes "Changeset 3128710 for form-vibes") →

---

# Changeset [3128705](/changeset/3128705 "Show full changeset") for [form-vibes](/browser/form-vibes?rev=3128705 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
07/31/2024 11:10:53 AM
([5 months](/timeline?from=2024-07-31T11%3A10%3A53Z&precision=second "See timeline at 07/31/2024 11:10:53 AM") ago)

Author:
wpvibes
Message:

trunk updated

Location:
[form-vibes/trunk](/browser/form-vibes/trunk?rev=3128705)
Files:

5 edited

* [inc/bootstrap.php](/browser/form-vibes/trunk/inc/bootstrap.php?rev=3128705 "Show entry in browser")
  (modified)
  ([2 diffs](#file0 "Show differences"))
* [inc/classes/db-tables.php](/browser/form-vibes/trunk/inc/classes/db-tables.php?rev=3128705 "Show entry in browser")
  (modified)
  ([1 diff](#file1 "Show differences"))
* [inc/classes/export.php](/browser/form-vibes/trunk/inc/classes/export.php?rev=3128705 "Show entry in browser")
  (modified)
  ([3 diffs](#file2 "Show differences"))
* [inc/classes/permissions.php](/browser/form-vibes/trunk/inc/classes/permissions.php?rev=3128705 "Show entry in browser")
  (modified)
  ([2 diffs](#file3 "Show differences"))
* [readme.txt](/browser/form-vibes/trunk/readme.txt?rev=3128705 "Show entry in browser")
  (modified)
  ([2 diffs](#file4 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [form-vibes/trunk/inc/bootstrap.php](/changeset/3128705/form-vibes/trunk/inc/bootstrap.php "Show the changeset 3128705 restricted to form-vibes/trunk/inc/bootstrap.php")

  | [r3115288](/browser/form-vibes/trunk/inc/bootstrap.php?rev=3115288#L153 "Show revision 3115288 of this file in browser") | [r3128705](/browser/form-vibes/trunk/inc/bootstrap.php?rev=3128705#L153 "Show revision 3128705 of this file in browser") |  |
  | --- | --- | --- |
  | 153 | 153 | self::$capabilities = Capabilities::instance(); |
  | 154 | 154 | add\_filter( 'formvibes/global/settings', [ $this, 'set\_table\_size\_limits' ] ); |
  | 155 |  | ~~//$this->insert\_random\_post();~~ |
  | 156 | 155 | } |
  | 157 | 156 |  |
  | […](/browser/form-vibes/trunk/inc/bootstrap.php?rev=3115288#L434) | […](/browser/form-vibes/trunk/inc/bootstrap.php?rev=3128705#L433) |  |
  | 434 | 433 | } |
  | 435 | 434 | } |
  | 436 |  |  |
  | 437 |  | ~~function get\_random\_data($count){~~ |
  | 438 |  |  |
  | 439 |  | ~~$data = wp\_remote\_get('https://randomuser.me/api/?results='.$count);~~ |
  | 440 |  | ~~$users = json\_decode($data['body'])->results;~~ |
  | 441 |  | ~~return $users;~~ |
  | 442 |  | ~~}~~ |
  | 443 |  |  |
  | 444 |  |  |
  | 445 |  | ~~function insert\_random\_post(){~~ |
  | 446 |  | ~~// die('insert random post');~~ |
  | 447 |  | ~~global $wpdb;~~ |
  | 448 |  | ~~$begin = new \DateTime('2022-05-01');~~ |
  | 449 |  | ~~$end = new \DateTime('2024-5-13');~~ |
  | 450 |  | ~~$interval = \DateInterval::createFromDateString('1 day');~~ |
  | 451 |  | ~~$period = new \DatePeriod($begin, $interval, $end);~~ |
  | 452 |  |  |
  | 453 |  | ~~$plugin = 'cf7';~~ |
  | 454 |  | ~~$formId = '4369';~~ |
  | 455 |  |  |
  | 456 |  | ~~foreach ($period as $dt) {~~ |
  | 457 |  | ~~//echo 'period';~~ |
  | 458 |  | ~~//echo $dt->format("Y-m-d 10:20:23\n"). '<br/>';~~ |
  | 459 |  | ~~$entryCount = rand(0,10);~~ |
  | 460 |  | ~~if($entryCount > 0){~~ |
  | 461 |  | ~~// echo 'inserting '.$entryCount.'<br/>';~~ |
  | 462 |  | ~~//get ranom api data~~ |
  | 463 |  | ~~$users = $this->get\_random\_data($entryCount);~~ |
  | 464 |  |  |
  | 465 |  | ~~foreach ( $users as $user ) {~~ |
  | 466 |  | ~~$h = rand(0,16);~~ |
  | 467 |  | ~~$m = rand(0,29);~~ |
  | 468 |  | ~~$s = rand(0,60);~~ |
  | 469 |  | ~~$userData['form\_plugin'] = $plugin;~~ |
  | 470 |  | ~~$userData['form\_id'] = $formId;~~ |
  | 471 |  | ~~$userData['url'] = 'http://wpforms.local/elementor-forms/';~~ |
  | 472 |  | ~~$userData['captured'] = $dt->format("Y-m-d ".$h.":".$m.":".$s."");~~ |
  | 473 |  | ~~$userData['captured\_gmt'] = $dt->format("Y-m-d ".$h.":".$m.":".$s."");~~ |
  | 474 |  | ~~$userData['user\_agent'] = '';~~ |
  | 475 |  | ~~$wpdb->insert(~~ |
  | 476 |  | ~~$wpdb->prefix . 'fv\_enteries',~~ |
  | 477 |  | ~~$userData~~ |
  | 478 |  | ~~);~~ |
  | 479 |  |  |
  | 480 |  | ~~$insert\_id = $wpdb->insert\_id;~~ |
  | 481 |  |  |
  | 482 |  | ~~$formData = [];~~ |
  | 483 |  |  |
  | 484 |  | ~~$formData['your-name'] = $user->name->first.' '.$user->name->last;~~ |
  | 485 |  | ~~$formData['your-subject'] = $user->location->city;~~ |
  | 486 |  | ~~$formData['your-email'] = $user->email;~~ |
  | 487 |  | ~~// $formData['phone'] = $user->phone;~~ |
  | 488 |  | ~~$formData['your-message '] = $user->location->city.', '.$user->location->state.', '.$user->location->country;~~ |
  | 489 |  | ~~$formData['fv\_form\_id'] = $formId;~~ |
  | 490 |  | ~~$formData['IP'] = '192.168.94.1';~~ |
  | 491 |  | ~~$formData['fv\_plugin'] = $plugin;~~ |
  | 492 |  |  |
  | 493 |  | ~~//print\_r($formData);~~ |
  | 494 |  | ~~foreach ( $formData as $key => $value ) {~~ |
  | 495 |  | ~~echo 'entry id: '.$insert\_id.' key: '.$key.' value: '.$value.'<br/>';~~ |
  | 496 |  | ~~$wpdb->insert(~~ |
  | 497 |  | ~~$wpdb->prefix . 'fv\_entry\_meta',~~ |
  | 498 |  | ~~[~~ |
  | 499 |  | ~~'data\_id' => $insert\_id,~~ |
  | 500 |  | ~~'meta\_key'  => $key,~~ |
  | 501 |  | ~~'meta\_value'  => $value,~~ |
  | 502 |  | ~~]~~ |
  | 503 |  | ~~);~~ |
  | 504 |  | ~~// update\_post\_meta( $insert\_id, $key, $value );~~ |
  | 505 |  | ~~}~~ |
  | 506 |  | ~~}~~ |
  | 507 |  | ~~}~~ |
  | 508 |  | ~~}~~ |
  | 509 |  | ~~echo "Entry Saved";~~ |
  | 510 |  | ~~//echo 'from '. $preFromDate. ' to '. $preToDate;~~ |
  | 511 |  | ~~//die('----');~~ |
  | 512 |  | ~~}~~ |
  | 513 |  |  |
  | 514 |  |  |
  | 515 |  |  |
  | 516 | 435 |  |
  | 517 | 436 | } |
* ## [form-vibes/trunk/inc/classes/db-tables.php](/changeset/3128705/form-vibes/trunk/inc/classes/db-tables.php "Show the changeset 3128705 restricted to form-vibes/trunk/inc/classes/db-tables.php")

  | [r2746174](/browser/form-vibes/trunk/inc/classes/db-tables.php?rev=2746174#L95 "Show revision 2746174 of this file in browser") | [r3128705](/browser/form-vibes/trunk/inc/classes/db-tables.php?rev=3128705#L95 "Show revision 3128705 of this file in browser") |  |
  | --- | --- | --- |
  | 95 | 95 | $db\_version\_update = false; |
  | 96 | 96 | } |
  |  | 97 |  |
  |  | 98 | // Secure Code |
  |  | 99 | // if ( $wpdb->get\_var( $wpdb->prepare( "SHOW TABLES LIKE %s", $table\_name ) ) !== $table\_name ) { |
  |  | 100 | //  $db\_version\_update = false; |
  |  | 101 | // } |
  |  | 102 |  |
  | 97 | 103 | if ( $wpdb->get\_var( "SHOW TABLES LIKE '{$wpdb->prefix}fv\_entry\_meta'" ) === null ) { |
  | 98 | 104 | $db\_version\_update = false; |
* ## [form-vibes/trunk/inc/classes/export.php](/changeset/3128705/form-vibes/trunk/inc/classes/export.php "Show the changeset 3128705 restricted to form-vibes/trunk/inc/classes/export.php")

  | [r2746174](/browser/form-vibes/trunk/inc/classes/export.php?rev=2746174#L40 "Show revision 2746174 of this file in browser") | [r3128705](/browser/form-vibes/trunk/inc/classes/export.php?rev=3128705#L40 "Show revision 3128705 of this file in browser") |  |
  | --- | --- | --- |
  | 40 | 40 | \*/ |
  | 41 | 41 | public function fv\_export\_csv() { |
  | 42 |  | if ( isset( $\_POST['btnExport'] ) ) { |
  | 43 |  |  |
  |  | 42 | if(isset( $\_POST['btnExport'])){ |
  |  | 43 | if (!Permissions::check\_permission( Permissions::$CAP\_EXPORT ) ) { |
  |  | 44 | die( 'Sorry, you are not allowed to do this action!' ); |
  |  | 45 | return; |
  |  | 46 | } |
  | 44 | 47 | if ( ! wp\_verify\_nonce( $\_POST['fv\_nonce'], 'fv\_ajax\_nonce' ) ) { |
  | 45 | 48 | die( 'Sorry, your nonce did not verify!' ); |
  | 46 | 49 | } |
  | 47 |  |  |
  | 48 | 50 | $params = (array) json\_decode( stripslashes( $\_REQUEST['fv\_export\_data'] ) ); |
  | 49 |  |  |
  | 50 | 51 | new Export( $params ); |
  | 51 |  | } |
  |  | 52 | } |
  | 52 | 53 | } |
  | 53 | 54 |  |
  | […](/browser/form-vibes/trunk/inc/classes/export.php?rev=2746174#L61) | […](/browser/form-vibes/trunk/inc/classes/export.php?rev=3128705#L62) |  |
  | 61 | 62 | \*/ |
  | 62 | 63 | private function export\_file( $params ) { |
  |  | 64 | if ( Utils::is\_pro() && ! Permissions::check\_permission( Permissions::$CAP\_EXPORT ) ) { |
  |  | 65 | die( 'Sorry, you are not allowed to do this action!' ); |
  |  | 66 | } |
  |  | 67 |  |
  | 63 | 68 | $fv\_settings = get\_option( 'fvSettings' ); |
  | 64 | 69 |  |
  | […](/browser/form-vibes/trunk/inc/classes/export.php?rev=2746174#L72) | […](/browser/form-vibes/trunk/inc/classes/export.php?rev=3128705#L77) |  |
  | 72 | 77 | $name                    = apply\_filters( 'formvibes/quickexport/filename', $name, $params ); |
  | 73 | 78 | $download\_type           = $params['download\_type']; |
  | 74 |  | $fv\_export\_selected\_rows = $params['fv\_export\_selected\_rows']; |
  |  | 79 | //$fv\_export\_selected\_rows = $params['fv\_export\_selected\_rows']; |
  | 75 | 80 |  |
  | 76 | 81 | $params['data\_return\_type'] = [ |
* ## [form-vibes/trunk/inc/classes/permissions.php](/changeset/3128705/form-vibes/trunk/inc/classes/permissions.php "Show the changeset 3128705 restricted to form-vibes/trunk/inc/classes/permissions.php")

  | [r2746174](/browser/form-vibes/trunk/inc/classes/permissions.php?rev=2746174#L96 "Show revision 2746174 of this file in browser") | [r3128705](/browser/form-vibes/trunk/inc/classes/permissions.php?rev=3128705#L96 "Show revision 3128705 of this file in browser") |  |
  | --- | --- | --- |
  | 96 | 96 | } |
  | 97 | 97 |  |
  | 98 |  | $can = user\_can( $user\_id, $permission ); |
  | 99 |  |  |
  | 100 |  | if ( user\_can( $user\_id, 'administrator' ) ) { |
  | 101 |  | // user is admin |
  |  | 98 | if ( user\_can( $user\_id, 'administrator' )) { |
  |  | 99 | // user is admins |
  | 102 | 100 | return true; |
  | 103 | 101 | } |
  | 104 | 102 |  |
  | 105 |  | if ( $can ) { |
  | 106 |  | return true; |
  |  | 103 | if(Utils::is\_pro()){ |
  |  | 104 | $can = user\_can( $user\_id, $permission ); |
  |  | 105 | if ( $can ) { |
  |  | 106 | return true; |
  |  | 107 | } |
  |  | 108 | }else{ |
  |  | 109 | return false; |
  | 107 | 110 | } |
  | 108 |  |  |
  |  | 111 |  |
  | 109 | 112 | return false; |
  | 110 | 113 | } |
  |  | 114 |  |
  |  | 115 |  |
  | 111 | 116 |  |
  | 112 | 117 | /\*\* |
  | […](/browser/form-vibes/trunk/inc/classes/permissions.php?rev=2746174#L149) | […](/browser/form-vibes/trunk/inc/classes/permissions.php?rev=3128705#L154) |  |
  | 149 | 154 | return true; |
  | 150 | 155 | } |
  | 151 |  |  |
  | 152 | 156 | return false; |
  | 153 | 157 | } |
* ## [form-vibes/trunk/readme.txt](/changeset/3128705/form-vibes/trunk/readme.txt "Show the changeset 3128705 restricted to form-vibes/trunk/readme.txt")

  | [r3115327](/browser/form-vibes/trunk/readme.txt?rev=3115327#L4 "Show revision 3115327 of this file in browser") | [r3128705](/browser/form-vibes/trunk/readme.txt?rev=3128705#L4 "Show revision 3128705 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | Requires at least: 5.0 |
  | 5 | 5 | Requires PHP: 7.4 |
  | 6 |  | Tested up to: 6.~~5~~ |
  |  | 6 | Tested up to: 6.6 |
  | 7 | 7 | Stable tag: 1.4.11 |
  | 8 | 8 | License: GPLv2 or later |
  | […](/browser/form-vibes/trunk/readme.txt?rev=3115327#L114) | […](/browser/form-vibes/trunk/readme.txt?rev=3128705#L114) |  |
  | 114 | 114 |  |
  | 115 | 115 | == Changelog == |
  |  | 116 | = 1.4.12 = |
  |  | 117 | \* Fixed: User role permissions validation check added. |
  | 116 | 118 |  |
  | 117 | 119 | = 1.4.11 = |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3128705)
* [Zip Archive](?format=zip&new=3128705)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

