<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Upgrade &mdash; Indico 3.3.5 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=8b0c0732"></script>
        <script src="../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex/" />
    <link rel="search" title="Search" href="../../search/" />
    <link rel="next" title="Upgrade Indico from 1.2" href="../upgrade_legacy/" />
    <link rel="prev" title="Apache" href="../production/deb/apache/" /> 
<script async type="text/javascript" src="/_/static/javascript/readthedocs-addons.js"></script><meta name="readthedocs-project-slug" content="indico" /><meta name="readthedocs-version-slug" content="stable" /><meta name="readthedocs-resolver-filename" content="/installation/upgrade/" /><meta name="readthedocs-http-status" content="200" /></head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../" class="icon icon-home">
            Indico
          </a>
              <div class="version">
                3.3.5
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../">Installation guides</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../production/">Production</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Upgrade</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#upgrading-between-3-x-versions">Upgrading between 3.x versions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#upgrading-from-3-x-to-3-3">Upgrading from 3.x to 3.3</a></li>
<li class="toctree-l3"><a class="reference internal" href="#upgrading-from-2-x-to-3-x">Upgrading from 2.x to 3.x</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#upgrading-from-2-x-to-3-x-in-place">Upgrading from 2.x to 3.x in-place</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../upgrade_legacy/">Migration from 1.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/">Development</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plugins/">Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../translations/">Translations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pdf_generation/">PDF Generation</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../config/">Configuration</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../building/">Building</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../search-engine/">Search</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../plugins/">Indico plugins</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../http-api/">HTTP API</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../translations/">Translating Indico</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/">API reference</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../changelog/">Changelog</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contact/">Contact</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../">Indico</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../">Installation guides</a></li>
      <li class="breadcrumb-item active">Upgrade</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/installation/upgrade.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="upgrade">
<h1>Upgrade<a class="headerlink" href="#upgrade" title="Link to this heading">¶</a></h1>
<p>It is important to keep your Indico instance up to date to have the
latest bug fixes and features.  Upgrading can be done with almost no
user-facing downtime.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When upgrading a production system it is highly recommended to
create a database backup before starting.</p>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>If you are upgrading from Indico v3.2.x or older to v3.3 or newer, make sure to
fully read and understand the <a class="reference internal" href="#upgrade-3-to-33"><span class="std std-ref">Upgrading from 3.x to 3.3</span></a>
guide before starting with any of the upgrade steps below.</p>
</div>
<section id="upgrading-between-3-x-versions">
<span id="upgrade-3-to-3"></span><h2>Upgrading between 3.x versions<a class="headerlink" href="#upgrading-between-3-x-versions" title="Link to this heading">¶</a></h2>
<p>First of all, stop the Celery worker.  To do so, run this as <em>root</em>:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>systemctl<span class="w"> </span>stop<span class="w"> </span>indico-celery.service
</pre></div>
</div>
<p>Now switch to the <em>indico</em> user and activate the virtualenv:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>su<span class="w"> </span>-<span class="w"> </span>indico
<span class="nb">source</span><span class="w"> </span>~/.venv/bin/activate
</pre></div>
</div>
<p>If you use Alma/Rocky, update your PATH to avoid errors in case the new
Indico version needs to install an updated version of the PostgreSQL client
library (psycopg2). If you use a different Postgres version, you need to
adapt the command accordingly:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$PATH</span><span class="s2">:/usr/pgsql-16/bin&quot;</span>
</pre></div>
</div>
<p id="upgrade-3-to-3-indico">You are now ready to install the latest version of Indico:</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Are you upgrading from Indico v3.2.x or older to v3.3 or newer? Then you have
to jump to the <a class="reference internal" href="#upgrade-3-to-33"><span class="std std-ref">Upgrading from 3.x to 3.3</span></a> guide now!</p>
</div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>-U<span class="w"> </span>indico
</pre></div>
</div>
<p id="upgrade-3-to-3-plugins">If you installed the official plugins, update them too:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>-U<span class="w"> </span>indico-plugins
</pre></div>
</div>
<p>It is a good idea to ensure you are using the latest recommended Python version:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>indico<span class="w"> </span>setup<span class="w"> </span>upgrade-python
</pre></div>
</div>
<p>Some versions may include database schema upgrades.  Make sure to
perform them immediately after upgrading.  If there are no schema
changes, the command will simply do nothing.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>indico<span class="w"> </span>db<span class="w"> </span>upgrade
indico<span class="w"> </span>db<span class="w"> </span>--all-plugins<span class="w"> </span>upgrade
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Some database structure changes require an <em>exclusive lock</em> on
some tables in the database.  Unless you have very high activity
on your instance, this lock can be acquired quickly, but if the
upgrade command seems to hang for more than a few seconds, you can
restart uWSGI by running <code class="docutils literal notranslate"><span class="pre">systemctl</span> <span class="pre">restart</span> <span class="pre">uwsgi.service</span></code> as
<em>root</em> (in a separate shell, i.e. don’t abort the upgrade command!)
which will ensure nothing is accessing Indico for a moment.</p>
</div>
<p>Unless you just restarted uWSGI, it is now time to reload it so the new
version is actually used:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>touch<span class="w"> </span>~/web/indico.wsgi
</pre></div>
</div>
<p>Also start the Celery worker again (once again, as <em>root</em>):</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>systemctl<span class="w"> </span>start<span class="w"> </span>indico-celery.service
</pre></div>
</div>
</section>
<section id="upgrading-from-3-x-to-3-3">
<span id="upgrade-3-to-33"></span><h2>Upgrading from 3.x to 3.3<a class="headerlink" href="#upgrading-from-3-x-to-3-3" title="Link to this heading">¶</a></h2>
<p>When updating to Indico v3.3 you need to perform some extra steps since the required Python
version has been raised from Python 3.9 to Python 3.12.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>If you are still using <strong>CentOS 7</strong> (or 8), you are required to <strong>update your operating
system</strong> to version <strong>9</strong> - your system is not only too old, but also going end-of-life
in the middle of 2024. Since CentOS no longer exists in its original form, we recommend
using <strong>AlmaLinux 9</strong> or <strong>Rocky Linux 9</strong>. You can find guides on the internet on how
to do such an upgrade in-place (we never tried this!), but it is almost certainly easier
to just use a new VM and migrate your Indico installations to that one.</p>
<p>If you are using an older <strong>Debian</strong> (Buster or Bullseye) or <strong>Ubuntu</strong> (Focal) release,
switching to the latest one is also highly recommended - we no longer test on older releases,
and things may be broken. Upgrading in-place is possible, but our same advice applies here:
We never tried this and cannot help you with it; migrating to a new VM is almost certainly
the easier and safer option.</p>
<p>Please also read the <a class="reference internal" href="#upgrade-2-to-3"><span class="std std-ref">2.x to 3.x</span></a> guide below which explains how to
migrate your Indico data to a new system.</p>
</div>
<p>The general <a class="reference internal" href="#upgrade-3-to-3"><span class="std std-ref">upgrade guide between 3.x versions</span></a> above still applies,
you just need to perform some additional steps. Anything below assumes you are on a supported
Linux distribution (or know exactly what you’re doing).</p>
<p>Before the <a class="reference internal" href="#upgrade-3-to-3-indico"><span class="std std-ref">Indico upgrade step</span></a> (<code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-U</span> <span class="pre">indico</span></code>),
you need to install the required Python version:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>indico<span class="w"> </span>setup<span class="w"> </span>upgrade-python<span class="w"> </span>--force-version<span class="w"> </span><span class="m">3</span>.12
</pre></div>
</div>
<p>Confirm both the warning about the requested version not being within the spec (which is based
on the previous Indico version) and the warning about having to re-install packages with <kbd class="kbd docutils literal notranslate">Y</kbd>.</p>
<p>Now you just need to install the <em>setuptools</em> package and then continue with installing the
new Indico version and updating the symlink for the static assets:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>setuptools
pip<span class="w"> </span>install<span class="w"> </span>-U<span class="w"> </span>indico
indico<span class="w"> </span>setup<span class="w"> </span>create-symlinks<span class="w"> </span>~/web/
</pre></div>
</div>
<p>You can now resume the regular upgrade guide <a class="reference internal" href="#upgrade-3-to-3-plugins"><span class="std std-ref">right after the</span></a>
<code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-U</span> <span class="pre">indico</span></code> step.</p>
</section>
<section id="upgrading-from-2-x-to-3-x">
<span id="upgrade-2-to-3"></span><h2>Upgrading from 2.x to 3.x<a class="headerlink" href="#upgrading-from-2-x-to-3-x" title="Link to this heading">¶</a></h2>
<p>The upgrade from 2.x to 3.x is a major change since Indico now requires
Python 3. We also strongly recommend upgrading your database to PostgreSQL 16
or newer (PostgreSQL 13 is the minimum required version we still test with).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As of Indico 3.2, the upgrade <strong>will fail</strong> on Postgres 10 and older.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you are using any custom plugins they will most likely no longer work and
need to be updated. Contact the developers of these plugins to see whether they
already have a version compatible with Python 3 and Indico 3.</p>
</div>
<p>Due to the significant changes in the environment, we recommend using a <strong>freshly
installed server/VM</strong> with the latest long-term-supported version of your preferred
Linux distribution.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In case you are using CentOS 7, please note that CentOS 7 is soon reaching its
end-of-life date (mid 2024), and Indico v3.3 is no longer compatible with this
very old distribution. Please use Alma/Rocky 9, or the latest Debian/Ubuntu LTS
release instead.</p>
</div>
<p>When following the <a class="reference internal" href="../production/#install-prod"><span class="std std-ref">production installation guide</span></a>, there
are a few places where you need to do something differently:</p>
<ul class="simple">
<li><p>Instead of running <code class="docutils literal notranslate"><span class="pre">indico</span> <span class="pre">db</span> <span class="pre">prepare</span></code>, restore a dump of your old Postgres
database</p></li>
<li><p>You still need to run <code class="docutils literal notranslate"><span class="pre">indico</span> <span class="pre">setup</span> <span class="pre">wizard</span></code> to create some of the directories,
but compare the generated config file with your old one and update any settings
you may have changed manually (e.g. for LDAP or SSO authentication)</p></li>
<li><p>You need to perform the database structure upgrades just like during any other
Indico upgrade: <code class="docutils literal notranslate"><span class="pre">indico</span> <span class="pre">db</span> <span class="pre">upgrade</span></code> and <code class="docutils literal notranslate"><span class="pre">indico</span> <span class="pre">db</span> <span class="pre">--all-plugins</span> <span class="pre">upgrade</span></code></p></li>
<li><p>Copy the contents of the <code class="docutils literal notranslate"><span class="pre">/opt/indico/archive</span></code> folder from your old instance and
ensure owner, group and permissions are correct. This step is critical as this folder
contains all the files uploaded to Indico</p></li>
</ul>
<p>If you need any help with the upgrade or encounter any issues, please open a thread
in <a class="reference external" href="https://talk.getindico.io/">our forum</a>.</p>
<section id="upgrading-from-2-x-to-3-x-in-place">
<h3>Upgrading from 2.x to 3.x in-place<a class="headerlink" href="#upgrading-from-2-x-to-3-x-in-place" title="Link to this heading">¶</a></h3>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you are not experienced with Linux system administration, we highly recommend
you to either ask someone from your IT department for assistance and/or follow our
recommendation of using a new server/VM to install Indico v3.</p>
</div>
<p>In case you prefer to perform the upgrade in place on your existing server, you will
need to compare the installation guides of 2.3 and 3.x and apply the differences
manually.  This should be fairly easy for someone with Linux system administration
experience, but here are some important points:</p>
<ul class="simple">
<li><p>Create a backup of both your Postgres database and <code class="docutils literal notranslate"><span class="pre">/opt/indico/archive</span></code></p></li>
<li><p>Stop, disable and and uninstall uWSGI and delete the old config file. To support
the latest Python version uWSGI is now installed into the Indico virtual environment
using <code class="docutils literal notranslate"><span class="pre">pip</span></code></p></li>
<li><p>Delete the <code class="docutils literal notranslate"><span class="pre">~/.venv</span></code> folder of the Indico user and recreate it using the commands
from the setup guide</p></li>
<li><p>Make sure to update your webserver config to use the more modern TLS defaults</p></li>
</ul>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../production/deb/apache/" class="btn btn-neutral float-left" title="Apache" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../upgrade_legacy/" class="btn btn-neutral float-right" title="Upgrade Indico from 1.2" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Indico Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>