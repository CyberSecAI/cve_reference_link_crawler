- **Root cause of vulnerability:** The `opartmultihtmlblock` module and its sub-modules did not properly sanitize user-provided input in the `body_text` and `body_text_rude` fields before storing it in the database or displaying it in user browsers. Specifically, it failed to prevent the injection of malicious scripts.
- **Weaknesses/vulnerabilities present:**
  - Stored Cross-Site Scripting (XSS) vulnerability (CWE-79)
  - Type 2 XSS (Stored XSS)
  - Lack of input sanitization in HTML fields (`body_text`, `body_text_rude`)
- **Impact of exploitation:**
    -  Hijacking payment modules
    -  Redirecting users to another website
    -  Technical and personal data leaks
    -  Execution of arbitrary web scripts in user browsers
    -  Malicious code injection into the payment page (observed in the wild)
- **Attack vectors:** Network
- **Required attacker capabilities/position:**
    - Authenticated access to the PrestaShop back office with high privileges.
    - Ability to edit module configurations.
    - User interaction is required for the XSS to execute.

**Additional Information:**
- The vulnerability is a Back-to-Front (B2F) type where malicious code is injected via the admin interface and executed on the front-end.
- The vulnerability was exploited by compromised admin accounts to inject malicious code into the payment page using the `displayBanner` hook from `multihtmlblockmessageheader` submodule.
- The provided patch sanitizes the admin form using `isCleanHtml`, removes iframes and sanitizes strings saved in the database before display, removing javascript tags and inline js events.
- The advisory recommends upgrading the module and enabling 2FA for backoffice logins.