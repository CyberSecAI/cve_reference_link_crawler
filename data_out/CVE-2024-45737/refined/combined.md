=== Content from research.splunk.com_6a313b1e_20250111_071201.html ===

[![Splunk Security Content Logo](https://research.splunk.com/images/logo.svg)](https://research.splunk.com/)

* [Analytic Stories](https://research.splunk.com/stories/)
* [Detections](https://research.splunk.com/detections/)
* [Playbooks](https://research.splunk.com/playbooks/)
* [Data Sources](https://research.splunk.com/sources/)
* [Blog](https://www.splunk.com/en_us/blog/author/secmrkt-research.html)
* [About](http://splunk.com/threat-research)
* [![GitHub Repo](https://research.splunk.com/images/GitHubMarkLight.svg)](https://github.com/splunk/security_content)

## Table of Contents

* + [Description](#description)
  + [Search](#search)
  + [Data Source](#data-source)
  + [Macros Used](#macros-used)
  + [Annotations](#annotations)
  + [Default Configuration](#default-configuration)
  + [Implementation](#implementation)
  + [Known False Positives](#known-false-positives)
  + [Associated Analytic Story](#associated-analytic-story)
  + [Risk Based Analytics (RBA)](#risk-based-analytics-rba)
  + [References](#references)
  + [Detection Testing](#detection-testing)

# Detection: Splunk Disable KVStore via CSRF Enabling Maintenance Mode

Updated Date: 2024-10-16
ID: 34bac267-a89b-4bd7-a072-a48eef1f15b8
Author: Rod Soto
[Type: TTP](#default-configuration)
[Product: Splunk Enterprise Security](https://www.splunk.com/en_us/products/enterprise-security.html)
### Description

In Splunk Enterprise versions below 9.3.1, 9.2.3, and 9.1.6 and Splunk Cloud Platform versions below 9.2.2403.108, 9.1.2312.204, and 9.1.2308.211, a low-privileged user that does not hold the âadminâ or âpowerâ Splunk roles could change the maintenance mode state of App Key Value Store (KVStore) through a Cross-Site Request Forgery (CSRF).

### Search

```
1`splunkda` method=GET uri_path IN ("/services*", /"servicesNS*") AND uri_path = "*kvstore/maintenance/change" AND uri_query IN ("*mode=t*", "*mode=1*")
2| stats count min(_time) as firstTime max(_time) as lastTime by user host uri clientip
3| `security_content_ctime(firstTime)`
4| `security_content_ctime(lastTime)`
5| `splunk_disable_kvstore_via_csrf_enabling_maintenance_mode_filter`

```
### Data Source

| Name | Platform | Sourcetype | Source |
| --- | --- | --- | --- |
| [Splunk](/sources/d8a2c791-460b-4756-a8e5-ecade77b21e3) | Splunk icon [Splunk](/platform/splunk) | `'splunkd_ui_access'` | `'splunkd_ui_access.log'` |

### Macros Used

| Name | Value |
| --- | --- |
| [security\_content\_ctime](https://github.com/splunk/security_content/blob/develop/macros/security_content_ctime.yml) | `convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)` |
| splunk\_disable\_kvstore\_via\_csrf\_enabling\_maintenance\_mode\_filter | `search *` |

`splunk_disable_kvstore_via_csrf_enabling_maintenance_mode_filter` is an empty macro by default. It allows the user to filter out any results (false positives) without editing the SPL.
### Annotations

- MITRE ATT&CK

+ Kill Chain Phases

+ NIST

+ CIS

- Threat Actors

| ID | Technique | Tactic |
| --- | --- | --- |
| [T1489](https://attack.mitre.org/techniques/T1489/) | Service Stop | Impact |

KillChainPhase.ACTIONS\_ON\_OBJECTIVES

NistCategory.DE\_CM

Cis18Value.CIS\_10

Indrik Spider
LAPSUS$
Lazarus Group
Sandworm Team
Wizard Spider

### Default Configuration

This detection is configured by default in Splunk Enterprise Security to run with the following settings:

| Setting | Value |
| --- | --- |
| Disabled | true |
| Cron Schedule | `0 * * * *` |
| Earliest Time | `-70m@m` |
| Latest Time | `-10m@m` |
| Schedule Window | `auto` |
| Creates Notable | Yes |
| Rule Title | `%name%` |
| Rule Description | `%description%` |
| Notable Event Fields | user, dest |
| Creates Risk Event | True |

This configuration file applies to all detections of type TTP. These detections will use Risk Based Alerting and generate Notable Events.
### Implementation

Requires access to internal indexes and web service enabled.

### Known False Positives

This search will produce false positives, operator must verify the context of access and the use of GET request against KVStore specifiying maintenance mode, especially non admin users.

### Associated Analytic Story

* [Splunk Vulnerabilities](/stories/splunk_vulnerabilities/)

### Risk Based Analytics (RBA)

| Risk Message | Risk Score | Impact | Confidence |
| --- | --- | --- | --- |
| Potential CSRF attack against $user$ and $host$ by placing KVStore into Maintenance Mode. | 25 | 50 | 50 |

The Risk Score is calculated by the following formula: Risk Score = (Impact \* Confidence/100). Initial Confidence and Impact is set by the analytic author.
### References

* <https://advisory.splunk.com/advisories/SVD-2024-1007>

### Detection Testing

| Test Type | Status | Dataset | Source | Sourcetype |
| --- | --- | --- | --- | --- |
| Validation | â [Passing](https://github.com/splunk/security_content/actions/workflows/build.yml) | N/A | N/A | N/A |
| Unit | â [Passing](https://github.com/splunk/security_content/actions/workflows/build.yml) | N/A | `N/A` | `N/A` |
| Integration | â Passing | N/A | `N/A` | `N/A` |

Replay any dataset to Splunk Enterprise by using our [`replay.py`](https://github.com/splunk/attack_data#using-replaypy) tool or the [UI](https://github.com/splunk/attack_data#using-ui).
Alternatively you can replay a dataset into a [Splunk Attack Range](https://github.com/splunk/attack_range#replay-dumps-into-attack-range-splunk-server)

---

Source: [GitHub](https://github.com/splunk/security_content/tree/develop/detections/application/splunk_disable_kvstore_via_csrf_enabling_maintenance_mode.yml) |
Version: **2**

[Detection: Splunk Digital Certificates Lack of Encryption](https://research.splunk.com/application/386a7ebc-737b-48cf-9ca8-5405459ed508/ "Detection: Splunk Digital Certificates Lack of Encryption")

[Detection: Splunk DoS via Malformed S2S Request](https://research.splunk.com/application/fc246e56-953b-40c1-8634-868f9e474cbd/ "Detection: Splunk DoS via Malformed S2S Request")

Â© 2005 - 2024 Splunk LLC All rights reserved.



=== Content from advisory.splunk.com_3a93337c_20250111_071200.html ===
 [![ ](/assets/img/logo.svg)](https://www.splunk.com/)

* [Home](/)
* [Report a Vulnerability](/report)
* [FAQs](/faqs)
* [Mailing List](https://www.splunk.com/en_us/form/splunk-security-advisories-notification.html)

 Toggle menu

* [Home](/)
* [Report a Vulnerability](/report)
* [FAQs](/faqs)
* [Mailing List](https://www.splunk.com/en_us/form/splunk-security-advisories-notification.html)
# Maintenance mode state change of App Key Value Store (KVStore) through Cross-Site Request Forgery (CSRF)

**Advisory ID:** SVD-2024-1007

**CVE ID:** [CVE-2024-45737](https://www.cve.org/CVERecord?id=CVE-2024-45737)

**Published:** 2024-10-14

**Last Update:** 2024-10-14

**CVSSv3.1 Score:** 4.3, Medium

**CVSSv3.1 Vector:** [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L)

**CWE:** [CWE-352](https://cwe.mitre.org/data/definitions/352.html)

**Bug ID:** VULN-15375

## Description

In Splunk Enterprise versions below 9.3.1, 9.2.3, and 9.1.6 and Splunk Cloud Platform versions below 9.2.2403.108, and 9.1.2312.204, a low-privileged user that does not hold the “admin” or “power” Splunk roles could change the maintenance mode state of App Key Value Store (KVStore) through a Cross-Site Request Forgery (CSRF).

## Solution

Upgrade Splunk Enterprise to versions 9.3.1, 9.2.3, 9.1.6, or higher.

Splunk is actively monitoring and patching Splunk Cloud Platform instances.

## Product Status

| Product | Version | Component | Affected Version | Fix Version |
| --- | --- | --- | --- | --- |
| Splunk Enterprise | 9.3 | Splunk Web | 9.3.0 | 9.3.1 |
| Splunk Enterprise | 9.2 | Splunk Web | 9.2.0 to 9.2.2 | 9.2.3 |
| Splunk Enterprise | 9.1 | Splunk Web | 9.1.0 to 9.1.5 | 9.1.6 |
| Splunk Cloud Platform | 9.2.2403 | Splunk Web | 9.2.2403.102 to 9.2.2403.107 | 9.2.2403.108 |
| Splunk Cloud Platform | 9.1.2312 | Splunk Web | Below 9.1.2312.204 | 9.1.2312.204 |

## Mitigations and Workarounds

The vulnerability affects instances with [Splunk Web](https://docs.splunk.com/Documentation/Splunk/latest/Security/DisableunnecessarySplunkcomponents) turned on. You could turn Splunk Web off as a possible workaround. See [Disable unnecessary Splunk Enterprise components](https://docs.splunk.com/Documentation/Splunk/latest/Security/DisableunnecessarySplunkcomponents) and the [web.conf](https://docs.splunk.com/Documentation/Splunk/latest/Admin/Webconf) configuration specification file for more information on turning Splunk Web off.

## Detections

* [Splunk Disable KVStore via CSRF Enabling Maintenance Mode](https://research.splunk.com/application/34bac267-a89b-4bd7-a072-a48eef1f15b8/)

## Severity

Splunk rates this vulnerability as a 4.3, Medium, with a CVSSv3.1 vector of CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L.

If the Splunk Enterprise instance does not run Splunk Web, there should be no impact and the severity would be informational.

## Acknowledgments

Anton (therceman)

* Email
* [RSS Feed](/feed.xml)
* [Support](https://login.splunk.com/page/sso_redirect?type=portal)
© 2005 - 2025 Splunk Inc. All rights reserved.[Legal](https://www.splunk.com/en_us/legal.html)     [Privacy     [Website Terms of Use](https://www.splunk.com/en_us/legal/terms/terms-of-use.html)](https://www.splunk.com/en_us/legal/privacy/privacy-policy.html)
