Based on the provided information, here's a breakdown of the vulnerability described in CVE-2023-30186:

**Root Cause:**

The vulnerability stems from a use-after-free condition within the `CNativeControl` class of the ONLYOFFICE Document Server's Docbuilder component, which is used to execute Javascript code. This component uses a v8 engine and exposes custom JS objects like "Native Engine" which has function callbacks implemented in C++. The specific functions at the heart of this issue are `Save_Alloc` and `Save_ReAlloc`.

**Weaknesses/Vulnerabilities Present:**

- **Use-After-Free:** The core issue is that the `Save_ReAlloc` function deallocates memory pointed to by `m_pSaveBinary` but doesn't invalidate the corresponding Javascript ArrayBuffer object created from this memory. The v8::ArrayBuffer object is created using  `CJSContext::createUint8Array`. This leaves a dangling pointer. Subsequent access to the ArrayBuffer will lead to the use-after-free vulnerability.
- **Lack of validation:** There is no validation of the arguments pos and len in `Save_ReAlloc`, making the memory corruption vulnerabilities possible (CVE-2023-30187)

**Impact of Exploitation:**

- **Memory corruption:** An attacker can manipulate the freed memory via the dangling pointer in the ArrayBuffer. This can lead to arbitrary code execution, denial of service, information leaks.

**Attack Vectors:**

- **Remote Attack:** The vulnerability can be triggered by sending a request to the `/docbuilder` API route with a crafted JavaScript file hosted on an attacker-controlled server. The `url` parameter points to the attacker's remote server.
- **JWT Token Required (From v7.2 onwards):** From version 7.2 onwards, an attacker needs a valid JWT token to access the `/docbuilder` route. However, as legitimate users of the DocumentServer require JWT tokens, an attacker can simply be one of the users.

**Required Attacker Capabilities/Position:**

- **Network Access:** An attacker needs to be able to send HTTP requests to the ONLYOFFICE Document Server.
- **JWT Token (From v7.2):** The attacker needs to obtain a JWT token to access the vulnerable `/docbuilder` API endpoint.
- **Controlled JavaScript File:** The attacker needs to host a malicious JavaScript file on a server they control.

**Technical Details:**

1.  **`Save_Alloc`:** This function allocates a chunk of memory of arbitrary size and initializes it with `0xff`.
2.  **`Save_ReAlloc`:** This function reallocates memory, freeing the existing chunk at `m_pSaveBinary` and allocating a new chunk of memory. A portion of the old memory is copied to the newly allocated memory if `pos` is set to a value less than or equal to the size of the original buffer. If `pos` is larger than the original buffer size, a heap buffer overflow is triggered (CVE-2023-30187).
3.  **`CJSContext::createUint8Array`:** This function creates a v8::ArrayBuffer object, which is used to expose the allocated memory to Javascript. The buffer is based on the chunk allocated by `Save_Alloc` or `Save_ReAlloc`. This is where the dangling pointer remains.
4.  **Exploitation Sequence:**
    *   The attacker uses `Save_Alloc` to allocate a memory buffer.
    *   The attacker creates a JavaScript `Uint8Array` view on the allocated buffer.
    *   The attacker calls `Save_ReAlloc`, which frees the original buffer but the `Uint8Array` still points to it.
    *   The attacker manipulates the `Uint8Array` view to access the freed memory, leading to the use-after-free.

**Additional Information from the provided content:**

*   The provided patch removes the vulnerable functionality by modifying the `DesktopEditor/doctrenderer/embed/jsc/jsc_NativeControl.mm` file and disables `Save_AllocNative` and `Save_ReAllocNative`.
*   The github commit diff shows the changes made in the code to remove the vulnerable functionality.
*   The vulnerability exists in ONLYOFFICE Document Server versions 4.0.3 through 7.3.2.

In summary, CVE-2023-30186 is a use-after-free vulnerability in ONLYOFFICE's Docbuilder component that allows a remote attacker to potentially execute code or cause a denial of service by crafting a malicious JavaScript file and sending it to a vulnerable API endpoint.