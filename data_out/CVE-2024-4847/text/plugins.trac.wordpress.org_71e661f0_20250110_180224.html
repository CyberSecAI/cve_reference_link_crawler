

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3086107)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Changeset](/changeset/3086106 "Changeset 3086106")
* [Next Changeset](/changeset/3086108 "Changeset 3086108") →

---

# Changeset 3086107

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
05/13/2024 09:00:35 PM
([8 months](/timeline?from=2024-05-13T21%3A00%3A35Z&precision=second "See timeline at 05/13/2024 09:00:35 PM") ago)

Author:
alttextai
Message:

Sanitize queries

Location:
[alttext-ai/trunk](/browser/alttext-ai/trunk?rev=3086107)
Files:

6 edited

* [README.txt](/browser/alttext-ai/trunk/README.txt?rev=3086107 "Show entry in browser")
  (modified)
  ([2 diffs](#file0 "Show differences"))
* [admin/class-atai-settings.php](/browser/alttext-ai/trunk/admin/class-atai-settings.php?rev=3086107 "Show entry in browser")
  (modified)
  ([1 diff](#file1 "Show differences"))
* [admin/js/admin.js](/browser/alttext-ai/trunk/admin/js/admin.js?rev=3086107 "Show entry in browser")
  (modified)
  ([1 diff](#file2 "Show differences"))
* [atai.php](/browser/alttext-ai/trunk/atai.php?rev=3086107 "Show entry in browser")
  (modified)
  ([2 diffs](#file3 "Show differences"))
* [includes/class-atai-attachment.php](/browser/alttext-ai/trunk/includes/class-atai-attachment.php?rev=3086107 "Show entry in browser")
  (modified)
  ([10 diffs](#file4 "Show differences"))
* [includes/class-atai-utility.php](/browser/alttext-ai/trunk/includes/class-atai-utility.php?rev=3086107 "Show entry in browser")
  (modified)
  ([1 diff](#file5 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [alttext-ai/trunk/README.txt](/changeset/3086107/alttext-ai/trunk/README.txt "Show the changeset 3086107 restricted to alttext-ai/trunk/README.txt")

  | [r3082790](/browser/alttext-ai/trunk/README.txt?rev=3082790#L6 "Show revision 3082790 of this file in browser") | [r3086107](/browser/alttext-ai/trunk/README.txt?rev=3086107#L6 "Show revision 3086107 of this file in browser") |  |
  | --- | --- | --- |
  | 6 | 6 | Requires at least: 4.7 |
  | 7 | 7 | Tested up to: 6.5 |
  | 8 |  | Stable tag: 1.~~4.9~~ |
  |  | 8 | Stable tag: 1.5.0 |
  | 9 | 9 | License: GPLv2 or later |
  | 10 | 10 | License URI: http://www.gnu.org/licenses/gpl-2.0.html |
  | […](/browser/alttext-ai/trunk/README.txt?rev=3082790#L65) | […](/browser/alttext-ai/trunk/README.txt?rev=3086107#L65) |  |
  | 65 | 65 |  |
  | 66 | 66 | == Changelog == |
  |  | 67 | = 1.5.0 = |
  |  | 68 | Sanitize DB queries |
  |  | 69 |  |
  | 67 | 70 | = 1.4.9 = |
  | 68 | 71 | Minify JS |
* ## [alttext-ai/trunk/admin/class-atai-settings.php](/changeset/3086107/alttext-ai/trunk/admin/class-atai-settings.php "Show the changeset 3086107 restricted to alttext-ai/trunk/admin/class-atai-settings.php")

  | [r3076089](/browser/alttext-ai/trunk/admin/class-atai-settings.php?rev=3076089#L337 "Show revision 3076089 of this file in browser") | [r3086107](/browser/alttext-ai/trunk/admin/class-atai-settings.php?rev=3086107#L337 "Show revision 3086107 of this file in browser") |  |
  | --- | --- | --- |
  | 337 | 337 | 'atai\_timeout', |
  | 338 | 338 | array( |
  | 339 |  | 'default'           => '~~15~~', |
  |  | 339 | 'default'           => '20', |
  | 340 | 340 | ) |
  | 341 | 341 | ); |
* ## [alttext-ai/trunk/admin/js/admin.js](/changeset/3086107/alttext-ai/trunk/admin/js/admin.js "Show the changeset 3086107 restricted to alttext-ai/trunk/admin/js/admin.js")

  | [r3082790](/browser/alttext-ai/trunk/admin/js/admin.js?rev=3082790#L1 "Show revision 3082790 of this file in browser") | [r3086107](/browser/alttext-ai/trunk/admin/js/admin.js?rev=3086107#L1 "Show revision 3086107 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | !function(){"use strict";const{\_\_:e,sprintf:t}=wp.i18n;function a(){jQuery.ajax({type:"post",dataType:"json",data:{action:"atai\_bulk\_generate",security:wp\_atai.security\_bulk\_generate,posts\_per\_page:window.atai.postsPerPage,last\_post\_id:window.atai.lastPostId,keywords:window.atai.bulkGenerateKeywords,negativeKeywords:window.atai.bulkGenerateNegativeKeywords,mode:window.atai.bulkGenerateMode,onlyAttached:window.atai.bulkGenerateOnlyAttached,onlyNew:window.atai.bulkGenerateOnlyNew,batchId:window.atai.bulkGenerateBatchId},url:wp\_atai.ajax\_url,success:function(t){window.atai.progressCurrent+=t.process\_count,window.atai.progressSuccessful+=t.success\_count,window.atai.lastPostId=t.last\_post\_id,window.atai.progressBarEl.data("current",window.atai.progressCurrent),window.atai.progressCurrentEl.text(window.atai.progressCurrent),window.atai.progressSuccessfulEl.text(window.atai.progressSuccessful);const n=100\*window.atai.progressCurrent/window.atai.progressMax;window.atai.progressBarEl.css("width",n+"%"),window.atai.progressPercent.text(n.toFixed(2)+"%"),t.recursive?a():(window.atai.progressButtonCancel.hide(),window.atai.progressBarWrapper.hide(),window.atai.progressButtonFinished.show(),window.atai.progressHeading.text(e("Update complete!","alttext-ai")),window.atai.redirectUrl=t?.redirect\_url)},error:function(t){console.log(t),window.atai.progressButtonCancel.hide(),window.atai.progressBarWrapper.hide(),window.atai.progressButtonFinished.show(),window.atai.progressHeading.text(e("The update was stopped due to a server error. Restart the update to pick up where it left off.","alttext-ai"))}})}function n(e){return e.split(",").map((function(e){return e.trim()})).filter((function(e){return e.length>0})).slice(0,6)}function i(e){e=e.replace(/[[]/,"\\[").replace(/[\]]/,"\\]");let t=new RegExp("[\\?&]"+e+"=([^&#]\*)").exec(window.location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))}function r(e,t,a){let n=document.getElementById(e),i=document.getElementById(t);if(i&&i.remove(),n){let e=s(t,a,"modal");return ~~n.appendChild(e),!0}return!1}function s(t,a,i){const r=new URL(window.location.href);r.searchParams.set("atai\_action","generate");const s=document.createElement("div");s.id=t;const o=document.createElement("a");o.id=t+"-anchor",o.href=r,o.className="button-secondary button-large";const c=document.createElement("div");c.id=t+"-checkbox-wrapper";const d=document.createElement("input");d.type="checkbox",d.id=t+"-keywords-checkbox",d.name="atai-generate-button-keywords-checkbox";const l=document.createElement("label");l.htmlFor="atai-generate-button-keywords-checkbox",l.innerText="Add SEO keywords";const u=document.createElement("div");u.id=t+"-textfield-wrapper",u.style.display="none";const p=document.createElement("input");p.type="text",p.id=t+"-textfield",p.name="atai-generate-button-keywords",p.size=40,c.appendChild(d),c.appendChild(l),u.appendChild(p),d.addEventListener("change",(function(){this.checked?(u.style.display="block",p.setSelectionRange(0,0),p.focus()):u.style.display="none"}));wp\_atai.can\_user\_upload\_files&&"error"!==(e=>{let t="error";return jQuery.ajax({type:"post",dataType:"json",async:!1,data:{action:"atai\_check\_image\_eligibility",security:wp\_atai.security\_check\_attachment\_eligibility,attachment\_id:e},url:wp\_atai.ajax\_url,success:function(e){t=e.status}}),t})(a)||(o.classList.add("disabled"),d.disabled=!0),o.title=e("AltText.ai: Update alt text for this single image","alttext-ai"),o.onclick=function(){this.classList.add("disabled");let t=this.querySelector("span");t&&(t.innerText=e("Processing...","alttext-ai"))};const w=document.createElement("img");w.src=wp\_atai.icon\_button\_generate,w.alt=e("Update Alt Text with AltText.ai","alttext-ai"),o.appendChild(w);const g=document.createElement("span");g.innerText=e("Update Alt Text","alttext-ai"),o.appendChild(g),s.appendChild(o),s.appendChild(c),s.appendChild(u);const y=document.createElement("span");return y.classList.add("atai-update-notice"),s.appendChild(y),o.addEventListener("click",(async function(t){t.preventDefault(),wp\_atai.has\_api\_key||(window.location.href=wp\_atai.settings\_page\_url+"&api\_key\_missing=1");const r="single"==i?document.getElementById("title"):document.querySelector('[data-setting="title"] input'),s="single"==i?document.getElementById("attachment\_caption"):document.querySelector('[data-setting="caption"] textarea'),c="single"==i?document.getElementById("attachment\_content"):document.querySelector('[data-setting="description"] textarea'),l="single"==i?document.getElementById("attachment\_alt"):document.querySelector('[data-setting="alt"] textarea'),u=d.checked?n(p.value):[];y&&(y.innerText="",y.classList.remove("atai-update-notice--success","atai-update-notice--error"));const w=await function(t,a=[]){return t?new Promise(((e,n)=>{jQuery.ajax({type:"post",dataType:"json",data:{action:"atai\_single\_generate",security:wp\_atai.security\_single\_generate,attachment\_id:t,keywords:a},url:wp\_atai.ajax\_url,success:function(t){e(t)},error:function(e){n(new Error("AJAX request failed"))}})})):Promise.reject(new Error(e("Attachment ID is missing","alttext-ai")))}(a,u);if("success"===w.status)l.value=w.alt\_text,"yes"===wp\_atai.should\_update\_title&&(r.value=w.alt\_text,"single"==i&&r.previousElementSibling.classList.add("screen-reader-text")),"yes"===wp\_atai.should\_update\_caption&&(s.value=w.alt\_text),"yes"===wp\_atai.should\_update\_description&&(c.value=w.alt\_text),y.innerText=e("Updated","alttext-ai"),y.classList.add("atai-update-notice--success"),setTimeout((()=>{y.classList.remove("atai-update-notice--success")}),3e3);else{let t=e("Unable to generate alt text. Check error logs for details.","alttext-ai");w?.message&&(t=w.message),y.innerText=t,y.classList.add("atai-update-notice--error")}o.classList.remove("disabled"),o.querySelector("span").innerText=e("Update Alt Text","alttext-ai")})),s}window.atai=window.atai||{postsPerPage:1,lastPostId:0,intervals:{},redirectUrl:""},jQuery("[data-edit-history-trigger]").on("click",(async function(){const t=this,a=t.dataset.attachmentId,n=document.getElementById("edit-history-input-"+a).value.replace(/\n/g,"");t.disabled=!0;const i=await function(t,a=""){return t?new Promise(((e,n)=>{jQuery.ajax({type:"post",dataType:"json",data:{action:"atai\_edit\_history",security:wp\_atai.security\_edit\_history,attachment\_id:t,alt\_text:a},url:wp\_atai.ajax\_url,success:function(t){e(t)},error:function(e){n(new Error("AJAX request failed"))}})})):Promise.reject(new Error(e("Attachment ID is missing","alttext-ai")))}(a,n);"success"!==i.status&&alert(e("Unable to update alt text for this image.","alttext-ai"));const r=document.getElementById("edit-history-success-"+a);r.classList.remove("hidden"),setTimeout((()=>{r.classList.add("hidden")}),2e3),t.disabled=!1})),jQuery("[data-bulk-generate-start]").on("click",(function(){const t=i("atai\_action")||"normal",r=i("atai\_batch\_id")||0;"bulk-select-generate"!==t||r||alert(e("Invalid batch ID","alttext-ai")),window.atai.bulkGenerateKeywords=n(jQuery("[data-bulk-generate-keywords]").val()??""),window.atai.bulkGenerateNegativeKeywords=n(jQuery("[data-bulk-generate-negative-keywords]").val()??""),window.atai.progressWrapperEl=jQuery("[data-bulk-generate-progress-wrapper]"),window.atai.progressHeading=jQuery("[data-bulk-generate-progress-heading]"),window.atai.progressBarWrapper=jQuery("[data-bulk-generate-progress-bar-wrapper]"),window.atai.progressBarEl=jQuery("[data-bulk-generate-progress-bar]"),window.atai.progressPercent=jQuery("[data-bulk-generate-progress-percent]"),window.atai.progressCurrentEl=jQuery("[data-bulk-generate-progress-current]"),window.atai.progressCurrent=window.atai.progressBarEl.data("current"),window.atai.progressSuccessfulEl=jQuery("[data-bulk-generate-progress-successful]"),window.atai.progressSuccessful=window.atai.progressBarEl.data("successful"),window.atai.progressMax=window.atai.progressBarEl.data("max"),window.atai.progressButtonCancel=jQuery("[data-bulk-generate-cancel]"),window.atai.progressButtonFinished=jQuery("[data-bulk-generate-finished]"),"bulk-select-generate"===t?(window.atai.bulkGenerateMode="bulk-select",window.atai.bulkGenerateBatchId=r):(window.atai.bulkGenerateMode=jQuery("[data-bulk-generate-mode-all]").is(":checked")?"all":"missing",window.atai.bulkGenerateOnlyAttached=jQuery("[data-bulk-generate-only-attached]").is(":checked")?"1":"0",window.atai.bulkGenerateOnlyNew=jQuery("[data-bulk-generate-only-new]").is(":checked")?"1":"0"),jQuery("#bulk-generate-form").hide(),window.atai.progressWrapperEl.show(),a()})),jQuery("[data-bulk-generate-mode-all]").on("change",(function(){window.location.href=this.dataset.url})),jQuery("[data-bulk-generate-only-attached]").on("change",(function(){window.location.href=this.dataset.url})),jQuery("[data-bulk-generate-only-new]").on("change",(function(){window.location.href=this.dataset.url})),jQuery("[data-post-bulk-generate]").on("click",(async function(t){if("#atai-bulk-generate"!==this.getAttribute("href"))return;if(t.preventDefault(),function(){try{if(window.wp&&wp.data&&wp.blocks)return wp.data.select("core/editor").isEditedPostDirty()}catch(e){return console.error("Error checking Gutenberg post dirty status: ",e),!0}return!0}()){if(!confirm(e("[AltText.ai] Make sure to save any changes before proceeding -- any unsaved changes will be lost. Are you sure you want to continue?","alttext-ai")))return}const a=document.getElementById("post\_ID")?.value,i=this.querySelector("span"),r=this.nextElementSibling,s=i.innerText,o=document.querySelector("[data-post-bulk-generate-overwrite]")?.checked||!1,c=document.querySelector("[data-post-bulk-generate-process-external]")?.checked||!1,d=document.querySelector("[data-post-bulk-generate-keywords-checkbox]"),l=document.querySelector("[data-post-bulk-generate-keywords]"),u=d?.checked?n(l?.value):[];if(!a)return r.innerText=e("This is not a valid post.","alttext-ai"),void r.classList.add("atai-update-notice--error");this.classList.add("disabled"),i.innerText=e("Processing...","alttext-ai");const p=await function(t,a=!1,n=!1,i=[]){return t?new Promise(((r,s)=>{jQuery.ajax({type:"post",dataType:"json",data:{action:"atai\_enrich\_post\_content",security:wp\_atai.security\_enrich\_post\_content,post\_id:t,overwrite:a,process\_external:n,keywords:i},url:wp\_atai.ajax\_url,success:function(e){r(e)},error:function(t){s(new Error(e("AJAX request failed","alttext-ai")))}})})):Promise.reject(new Error(e("Post ID is missing","alttext-ai")))}(a,o,c,u);if(p.success)window.location.reload();else{let t=e("Unable to generate alt text. Check error logs for details.","alttext-ai");r.innerText=t,r.classList.add("atai-update-notice--error")}this.classList.remove("disabled"),i.innerText=s})),document.addEventListener("DOMContentLoaded",(()=>{wp?.blocks&&jQuery.ajax({url:wp\_atai.ajax\_url,type:"GET",data:{action:"atai\_check\_enrich\_post\_content\_transient",security:wp\_atai.security\_enrich\_post\_content\_transient},success:function(e){e?.success&&wp.data.dispatch("core/notices").createNotice("success",e.data.message,{isDismissible:!0})}})})),jQuery('[name="handle\_api\_key"]').on("click",(function(){"Clear API Key"===this.value&&jQuery('[name="atai\_api\_key"]').val("")})),jQuery(".notice--atai.is-dismissible").on("click",".notice-dismiss",(function(){jQuery.ajax(wp\_atai.ajax\_url,{type:"POST",data:{action:"atai\_expire\_insufficient\_credits\_notice",security:wp\_atai.security\_insufficient\_credits\_notice}})})),document.addEventListener("DOMContentLoaded",(async()=>{const e=window.location.href.includes("post.php")&&jQuery("body").hasClass("post-type-attachment"),t=window.location.href.includes("post-new.php")||window.location.href.includes("post.php")&&!jQuery("body").hasClass("post-type-attachment"),a=window.location.href.includes("upload.php");let n=null,o="atai-generate-button",c="alt-text-description";if(e){if(n=i("post"),!n)return!1;if(n=parseInt(n,10),!n)return;let e=document.getElementById(c);if(e){let t=s(o,n,"single");e.appendChild(t)}}else{if(!a&&!t)return!1;if(n=i("item"),jQuery(document).on("click","ul.attachments li.attachment",(function(){let e=jQuery(this);e.attr("data-id")&&(n=parseInt(e.attr("data-id"),10),n&&r(c,o,n))})),document.addEventListener("click",(function(e){if(!e.target.matches(".media-modal .right, .media-modal .left"))return;const t=new URLSearchParams(window.location.search);n=t.get("item"),n&&r(c,o,n)})),!n)return!1;if(n){let e=0;window.atai.intervals.singleModal=setInterval((()=>{if(e++,e>20)return void clearInterval(interval);if(n=parseInt(n,10),!n)return;r(c,o,n)&&clearInterval(window.atai.intervals.singleModal)}),5~~00)}}}))}(); |
  |  | 1 | !function(){"use strict";const{\_\_:e,sprintf:t}=wp.i18n;function a(){jQuery.ajax({type:"post",dataType:"json",data:{action:"atai\_bulk\_generate",security:wp\_atai.security\_bulk\_generate,posts\_per\_page:window.atai.postsPerPage,last\_post\_id:window.atai.lastPostId,keywords:window.atai.bulkGenerateKeywords,negativeKeywords:window.atai.bulkGenerateNegativeKeywords,mode:window.atai.bulkGenerateMode,onlyAttached:window.atai.bulkGenerateOnlyAttached,onlyNew:window.atai.bulkGenerateOnlyNew,batchId:window.atai.bulkGenerateBatchId},url:wp\_atai.ajax\_url,success:function(t){window.atai.progressCurrent+=t.process\_count,window.atai.progressSuccessful+=t.success\_count,window.atai.lastPostId=t.last\_post\_id,window.atai.progressBarEl.data("current",window.atai.progressCurrent),window.atai.progressCurrentEl.text(window.atai.progressCurrent),window.atai.progressSuccessfulEl.text(window.atai.progressSuccessful);const n=100\*window.atai.progressCurrent/window.atai.progressMax;window.atai.progressBarEl.css("width",n+"%"),window.atai.progressPercent.text(n.toFixed(2)+"%"),t.recursive?a():(window.atai.progressButtonCancel.hide(),window.atai.progressBarWrapper.hide(),window.atai.progressButtonFinished.show(),window.atai.progressHeading.text(e("Update complete!","alttext-ai")),window.atai.redirectUrl=t?.redirect\_url)},error:function(t){console.log(t),window.atai.progressButtonCancel.hide(),window.atai.progressBarWrapper.hide(),window.atai.progressButtonFinished.show(),window.atai.progressHeading.text(e("The update was stopped due to a server error. Restart the update to pick up where it left off.","alttext-ai"))}})}function n(e){return e.split(",").map((function(e){return e.trim()})).filter((function(e){return e.length>0})).slice(0,6)}function i(e){e=e.replace(/[[]/,"\\[").replace(/[\]]/,"\\]");let t=new RegExp("[\\?&]"+e+"=([^&#]\*)").exec(window.location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))}function r(e,t,a){let n=document.getElementById(e),i=document.getElementById(t);if(i&&i.remove(),n){let e=s(t,a,"modal");return e.className=n.className,n.parentNode.replaceChild(e,n),!0}return!1}function s(t,a,i){const r=new URL(window.location.href);r.searchParams.set("atai\_action","generate");const s=document.createElement("div");s.id=t;const o=document.createElement("a");o.id=t+"-anchor",o.href=r,o.className="button-secondary button-large";const d=document.createElement("div");d.id=t+"-checkbox-wrapper";const c=document.createElement("input");c.type="checkbox",c.id=t+"-keywords-checkbox",c.name="atai-generate-button-keywords-checkbox";const l=document.createElement("label");l.htmlFor="atai-generate-button-keywords-checkbox",l.innerText="Add SEO keywords";const u=document.createElement("div");u.id=t+"-textfield-wrapper",u.style.display="none";const p=document.createElement("input");p.type="text",p.id=t+"-textfield",p.name="atai-generate-button-keywords",p.size=40,d.appendChild(c),d.appendChild(l),u.appendChild(p),c.addEventListener("change",(function(){this.checked?(u.style.display="block",p.setSelectionRange(0,0),p.focus()):u.style.display="none"}));wp\_atai.can\_user\_upload\_files&&"error"!==(e=>{let t="error";return jQuery.ajax({type:"post",dataType:"json",async:!1,data:{action:"atai\_check\_image\_eligibility",security:wp\_atai.security\_check\_attachment\_eligibility,attachment\_id:e},url:wp\_atai.ajax\_url,success:function(e){t=e.status}}),t})(a)||(o.classList.add("disabled"),c.disabled=!0),o.title=e("AltText.ai: Update alt text for this single image","alttext-ai"),o.onclick=function(){this.classList.add("disabled");let t=this.querySelector("span");t&&(t.innerText=e("Processing...","alttext-ai"))};const w=document.createElement("img");w.src=wp\_atai.icon\_button\_generate,w.alt=e("Update Alt Text with AltText.ai","alttext-ai"),o.appendChild(w);const g=document.createElement("span");g.innerText=e("Update Alt Text","alttext-ai"),o.appendChild(g),s.appendChild(o),s.appendChild(d),s.appendChild(u);const y=document.createElement("span");return y.classList.add("atai-update-notice"),s.appendChild(y),o.addEventListener("click",(async function(t){t.preventDefault(),wp\_atai.has\_api\_key||(window.location.href=wp\_atai.settings\_page\_url+"&api\_key\_missing=1");const r="single"==i?document.getElementById("title"):document.querySelector('[data-setting="title"] input'),s="single"==i?document.getElementById("attachment\_caption"):document.querySelector('[data-setting="caption"] textarea'),d="single"==i?document.getElementById("attachment\_content"):document.querySelector('[data-setting="description"] textarea'),l="single"==i?document.getElementById("attachment\_alt"):document.querySelector('[data-setting="alt"] textarea'),u=c.checked?n(p.value):[];y&&(y.innerText="",y.classList.remove("atai-update-notice--success","atai-update-notice--error"));const w=await function(t,a=[]){return t?new Promise(((e,n)=>{jQuery.ajax({type:"post",dataType:"json",data:{action:"atai\_single\_generate",security:wp\_atai.security\_single\_generate,attachment\_id:t,keywords:a},url:wp\_atai.ajax\_url,success:function(t){e(t)},error:function(e){n(new Error("AJAX request failed"))}})})):Promise.reject(new Error(e("Attachment ID is missing","alttext-ai")))}(a,u);if("success"===w.status)l.value=w.alt\_text,"yes"===wp\_atai.should\_update\_title&&(r.value=w.alt\_text,"single"==i&&r.previousElementSibling.classList.add("screen-reader-text")),"yes"===wp\_atai.should\_update\_caption&&(s.value=w.alt\_text),"yes"===wp\_atai.should\_update\_description&&(d.value=w.alt\_text),y.innerText=e("Updated","alttext-ai"),y.classList.add("atai-update-notice--success"),setTimeout((()=>{y.classList.remove("atai-update-notice--success")}),3e3);else{let t=e("Unable to generate alt text. Check error logs for details.","alttext-ai");w?.message&&(t=w.message),y.innerText=t,y.classList.add("atai-update-notice--error")}o.classList.remove("disabled"),o.querySelector("span").innerText=e("Update Alt Text","alttext-ai")})),s}window.atai=window.atai||{postsPerPage:1,lastPostId:0,intervals:{},redirectUrl:""},jQuery("[data-edit-history-trigger]").on("click",(async function(){const t=this,a=t.dataset.attachmentId,n=document.getElementById("edit-history-input-"+a).value.replace(/\n/g,"");t.disabled=!0;const i=await function(t,a=""){return t?new Promise(((e,n)=>{jQuery.ajax({type:"post",dataType:"json",data:{action:"atai\_edit\_history",security:wp\_atai.security\_edit\_history,attachment\_id:t,alt\_text:a},url:wp\_atai.ajax\_url,success:function(t){e(t)},error:function(e){n(new Error("AJAX request failed"))}})})):Promise.reject(new Error(e("Attachment ID is missing","alttext-ai")))}(a,n);"success"!==i.status&&alert(e("Unable to update alt text for this image.","alttext-ai"));const r=document.getElementById("edit-history-success-"+a);r.classList.remove("hidden"),setTimeout((()=>{r.classList.add("hidden")}),2e3),t.disabled=!1})),jQuery("[data-bulk-generate-start]").on("click",(function(){const t=i("atai\_action")||"normal",r=i("atai\_batch\_id")||0;"bulk-select-generate"!==t||r||alert(e("Invalid batch ID","alttext-ai")),window.atai.bulkGenerateKeywords=n(jQuery("[data-bulk-generate-keywords]").val()??""),window.atai.bulkGenerateNegativeKeywords=n(jQuery("[data-bulk-generate-negative-keywords]").val()??""),window.atai.progressWrapperEl=jQuery("[data-bulk-generate-progress-wrapper]"),window.atai.progressHeading=jQuery("[data-bulk-generate-progress-heading]"),window.atai.progressBarWrapper=jQuery("[data-bulk-generate-progress-bar-wrapper]"),window.atai.progressBarEl=jQuery("[data-bulk-generate-progress-bar]"),window.atai.progressPercent=jQuery("[data-bulk-generate-progress-percent]"),window.atai.progressCurrentEl=jQuery("[data-bulk-generate-progress-current]"),window.atai.progressCurrent=window.atai.progressBarEl.data("current"),window.atai.progressSuccessfulEl=jQuery("[data-bulk-generate-progress-successful]"),window.atai.progressSuccessful=window.atai.progressBarEl.data("successful"),window.atai.progressMax=window.atai.progressBarEl.data("max"),window.atai.progressButtonCancel=jQuery("[data-bulk-generate-cancel]"),window.atai.progressButtonFinished=jQuery("[data-bulk-generate-finished]"),"bulk-select-generate"===t?(window.atai.bulkGenerateMode="bulk-select",window.atai.bulkGenerateBatchId=r):(window.atai.bulkGenerateMode=jQuery("[data-bulk-generate-mode-all]").is(":checked")?"all":"missing",window.atai.bulkGenerateOnlyAttached=jQuery("[data-bulk-generate-only-attached]").is(":checked")?"1":"0",window.atai.bulkGenerateOnlyNew=jQuery("[data-bulk-generate-only-new]").is(":checked")?"1":"0"),jQuery("#bulk-generate-form").hide(),window.atai.progressWrapperEl.show(),a()})),jQuery("[data-bulk-generate-mode-all]").on("change",(function(){window.location.href=this.dataset.url})),jQuery("[data-bulk-generate-only-attached]").on("change",(function(){window.location.href=this.dataset.url})),jQuery("[data-bulk-generate-only-new]").on("change",(function(){window.location.href=this.dataset.url})),jQuery("[data-post-bulk-generate]").on("click",(async function(t){if("#atai-bulk-generate"!==this.getAttribute("href"))return;if(t.preventDefault(),function(){try{if(window.wp&&wp.data&&wp.blocks)return wp.data.select("core/editor").isEditedPostDirty()}catch(e){return console.error("Error checking Gutenberg post dirty status: ",e),!0}return!0}()){if(!confirm(e("[AltText.ai] Make sure to save any changes before proceeding -- any unsaved changes will be lost. Are you sure you want to continue?","alttext-ai")))return}const a=document.getElementById("post\_ID")?.value,i=this.querySelector("span"),r=this.nextElementSibling,s=i.innerText,o=document.querySelector("[data-post-bulk-generate-overwrite]")?.checked||!1,d=document.querySelector("[data-post-bulk-generate-process-external]")?.checked||!1,c=document.querySelector("[data-post-bulk-generate-keywords-checkbox]"),l=document.querySelector("[data-post-bulk-generate-keywords]"),u=c?.checked?n(l?.value):[];if(!a)return r.innerText=e("This is not a valid post.","alttext-ai"),void r.classList.add("atai-update-notice--error");this.classList.add("disabled"),i.innerText=e("Processing...","alttext-ai");const p=await function(t,a=!1,n=!1,i=[]){return t?new Promise(((r,s)=>{jQuery.ajax({type:"post",dataType:"json",data:{action:"atai\_enrich\_post\_content",security:wp\_atai.security\_enrich\_post\_content,post\_id:t,overwrite:a,process\_external:n,keywords:i},url:wp\_atai.ajax\_url,success:function(e){r(e)},error:function(t){s(new Error(e("AJAX request failed","alttext-ai")))}})})):Promise.reject(new Error(e("Post ID is missing","alttext-ai")))}(a,o,d,u);if(p.success)window.location.reload();else{let t=e("Unable to generate alt text. Check error logs for details.","alttext-ai");r.innerText=t,r.classList.add("atai-update-notice--error")}this.classList.remove("disabled"),i.innerText=s})),document.addEventListener("DOMContentLoaded",(()=>{wp?.blocks&&jQuery.ajax({url:wp\_atai.ajax\_url,type:"GET",data:{action:"atai\_check\_enrich\_post\_content\_transient",security:wp\_atai.security\_enrich\_post\_content\_transient},success:function(e){e?.success&&wp.data.dispatch("core/notices").createNotice("success",e.data.message,{isDismissible:!0})}})})),jQuery('[name="handle\_api\_key"]').on("click",(function(){"Clear API Key"===this.value&&jQuery('[name="atai\_api\_key"]').val("")})),jQuery(".notice--atai.is-dismissible").on("click",".notice-dismiss",(function(){jQuery.ajax(wp\_atai.ajax\_url,{type:"POST",data:{action:"atai\_expire\_insufficient\_credits\_notice",security:wp\_atai.security\_insufficient\_credits\_notice}})})),document.addEventListener("DOMContentLoaded",(async()=>{const e=window.location.href.includes("post.php")&&jQuery("body").hasClass("post-type-attachment"),t=window.location.href.includes("post-new.php")||window.location.href.includes("post.php")&&!jQuery("body").hasClass("post-type-attachment"),a=window.location.href.includes("upload.php");let n=null,o="atai-generate-button";if(e){if(n=i("post"),!n)return!1;if(n=parseInt(n,10),!n)return;let e=document.getElementsByClassName("attachment-alt-text")[0];if(e){let t=s(o,n,"single");setTimeout((()=>{!function(e,t){if(e.hasChildNodes()){for(const a of e.childNodes)if("BUTTON"==a.nodeName)return void e.replaceChild(t,a);e.appendChild(t)}else e.appendChild(t)}(e,t)}),200)}}else{if(!a&&!t)return!1;if(n=i("item"),jQuery(document).on("click","ul.attachments li.attachment",(function(){let e=jQuery(this);e.attr("data-id")&&(n=parseInt(e.attr("data-id"),10),n&&r("alt-text-description",o,n))})),document.addEventListener("click",(function(e){if(!e.target.matches(".media-modal .right, .media-modal .left"))return;const t=new URLSearchParams(window.location.search);n=t.get("item"),n&&r("alt-text-description",o,n)})),!n)return!1;if(n){let e=0;window.atai.intervals.singleModal=setInterval((()=>{if(e++,e>30)return void clearInterval(window.atai.intervals.singleModal);if(n=parseInt(n,10),!n)return void clearInterval(window.atai.intervals.singleModal);r("alt-text-description",o,n)&&clearInterval(window.atai.intervals.singleModal)}),200)}}}))}(); |
* ## [alttext-ai/trunk/atai.php](/changeset/3086107/alttext-ai/trunk/atai.php "Show the changeset 3086107 restricted to alttext-ai/trunk/atai.php")

  | [r3082790](/browser/alttext-ai/trunk/atai.php?rev=3082790#L16 "Show revision 3082790 of this file in browser") | [r3086107](/browser/alttext-ai/trunk/atai.php?rev=3086107#L16 "Show revision 3086107 of this file in browser") |  |
  | --- | --- | --- |
  | 16 | 16 | \* Plugin URI:        https://alttext.ai/product |
  | 17 | 17 | \* Description:       Automatically generate image alt text with AltText.ai. |
  | 18 |  | \* Version:           1.~~4.9~~ |
  |  | 18 | \* Version:           1.5.0 |
  | 19 | 19 | \* Author:            AltText.ai |
  | 20 | 20 | \* Author URI:        https://alttext.ai |
  | […](/browser/alttext-ai/trunk/atai.php?rev=3082790#L33) | […](/browser/alttext-ai/trunk/atai.php?rev=3086107#L33) |  |
  | 33 | 33 | \* Current plugin version. |
  | 34 | 34 | \*/ |
  | 35 |  | define( 'ATAI\_VERSION', '1.~~4.9~~' ); |
  |  | 35 | define( 'ATAI\_VERSION', '1.5.0' ); |
  | 36 | 36 |  |
  | 37 | 37 | /\*\* |
* ## [alttext-ai/trunk/includes/class-atai-attachment.php](/changeset/3086107/alttext-ai/trunk/includes/class-atai-attachment.php "Show the changeset 3086107 restricted to alttext-ai/trunk/includes/class-atai-attachment.php")

  | [r3074350](/browser/alttext-ai/trunk/includes/class-atai-attachment.php?rev=3074350#L239 "Show revision 3074350 of this file in browser") | [r3086107](/browser/alttext-ai/trunk/includes/class-atai-attachment.php?rev=3086107#L239 "Show revision 3086107 of this file in browser") |  |
  | --- | --- | --- |
  | 239 | 239 | ON image\_posts.post\_parent = parent\_posts.id |
  | 240 | 240 | WHERE |
  | 241 |  | image\_posts.id = ~~{$attachment\_id}~~ |
  |  | 241 | image\_posts.id = %d |
  | 242 | 242 | AND |
  | 243 | 243 | parent\_posts.post\_type = 'product' |
  | […](/browser/alttext-ai/trunk/includes/class-atai-attachment.php?rev=3074350#L246) | […](/browser/alttext-ai/trunk/includes/class-atai-attachment.php?rev=3086107#L246) |  |
  | 246 | 246 | SQL; |
  | 247 | 247 |  |
  | 248 |  | $product\_title\_data = $wpdb->get\_results( $~~find\_product\_title\_sql~~ ); |
  |  | 248 | $product\_title\_data = $wpdb->get\_results( $wpdb->prepare($find\_product\_title\_sql, $attachment\_id) ); |
  | 249 | 249 |  |
  | 250 | 250 | if ( count( $product\_title\_data ) == 0 || strlen( $product\_title\_data[0]->product\_title ) == 0 ) { |
  | […](/browser/alttext-ai/trunk/includes/class-atai-attachment.php?rev=3074350#L310) | […](/browser/alttext-ai/trunk/includes/class-atai-attachment.php?rev=3086107#L310) |  |
  | 310 | 310 |  |
  | 311 | 311 | // Attempt to get the related post ID directly from WordPress based on the attachment: |
  | 312 |  | $fetch\_post\_sql = "select post\_parent from {$wpdb->posts} where ID = ~~{$attachment\_id}~~"; |
  | 313 |  | $post\_results = $wpdb->get\_results( $~~fetch\_post\_sql~~ ); |
  |  | 312 | $fetch\_post\_sql = "select post\_parent from {$wpdb->posts} where ID = %d"; |
  |  | 313 | $post\_results = $wpdb->get\_results( $wpdb->prepare($fetch\_post\_sql, $attachment\_id) ); |
  | 314 | 314 |  |
  | 315 | 315 | if ( count( $post\_results ) > 0 ) { |
  | […](/browser/alttext-ai/trunk/includes/class-atai-attachment.php?rev=3074350#L392) | […](/browser/alttext-ai/trunk/includes/class-atai-attachment.php?rev=3086107#L392) |  |
  | 392 | 392 | // If post ID is null, we may still be able to get it directly from the Yoast data for this attachment: |
  | 393 | 393 | if ( ! $post\_id ) { |
  | 394 |  | $yoast\_post\_sql = "select post\_id from {$wpdb->prefix}yoast\_seo\_links where target\_post\_id = ~~{$attachment\_id}~~"; |
  | 395 |  | $results = $wpdb->get\_results( $~~yoast\_post\_sql~~ ); |
  |  | 394 | $yoast\_post\_sql = "select post\_id from {$wpdb->prefix}yoast\_seo\_links where target\_post\_id = %d"; |
  |  | 395 | $results = $wpdb->get\_results( $wpdb->prepare($yoast\_post\_sql, $attachment\_id) ); |
  | 396 | 396 |  |
  | 397 | 397 | if ( count( $results ) > 0 ) { |
  | […](/browser/alttext-ai/trunk/includes/class-atai-attachment.php?rev=3074350#L409) | […](/browser/alttext-ai/trunk/includes/class-atai-attachment.php?rev=3086107#L409) |  |
  | 409 | 409 | from {$wpdb->postmeta} |
  | 410 | 410 | where meta\_key = '\_yoast\_wpseo\_focuskw' |
  | 411 |  | and post\_id = ~~{$post\_id};~~ |
  |  | 411 | and post\_id = %d |
  | 412 | 412 | SQL; |
  | 413 | 413 |  |
  | 414 |  | $keywords = $wpdb->get\_results( $~~keyword\_sql~~ ); |
  |  | 414 | $keywords = $wpdb->get\_results( $wpdb->prepare($keyword\_sql, $post\_id) ); |
  | 415 | 415 |  |
  | 416 | 416 | if ( count( $keywords ) == 0 || strlen( $keywords[0]->focus\_keywords ) == 0 ) { |
  | […](/browser/alttext-ai/trunk/includes/class-atai-attachment.php?rev=3074350#L425) | […](/browser/alttext-ai/trunk/includes/class-atai-attachment.php?rev=3086107#L425) |  |
  | 425 | 425 | from {$wpdb->postmeta} |
  | 426 | 426 | where meta\_key = '\_yoast\_wpseo\_focuskeywords' |
  | 427 |  | and post\_id = ~~{$post\_id};~~ |
  |  | 427 | and post\_id = %d |
  | 428 | 428 | SQL; |
  | 429 | 429 |  |
  | 430 |  | $keywords = $wpdb->get\_results( $~~keyword\_sql~~ ); |
  |  | 430 | $keywords = $wpdb->get\_results( $wpdb->prepare($keyword\_sql, $post\_id) ); |
  | 431 | 431 |  |
  | 432 | 432 | if ( count( $keywords ) > 0 ) { |
  | […](/browser/alttext-ai/trunk/includes/class-atai-attachment.php?rev=3074350#L516) | […](/browser/alttext-ai/trunk/includes/class-atai-attachment.php?rev=3086107#L516) |  |
  | 516 | 516 | from {$wpdb->postmeta} |
  | 517 | 517 | where meta\_key = 'rank\_math\_focus\_keyword' |
  | 518 |  | and post\_id = ~~{$post\_id};~~ |
  |  | 518 | and post\_id = %d |
  | 519 | 519 | SQL; |
  | 520 | 520 |  |
  | 521 |  | $keywords = $wpdb->get\_results( $~~keyword\_sql~~ ); |
  |  | 521 | $keywords = $wpdb->get\_results( $wpdb->prepare($keyword\_sql, $post\_id) ); |
  | 522 | 522 |  |
  | 523 | 523 | if ( count( $keywords ) == 0 || strlen( $keywords[0]->focus\_keywords ) == 0 ) { |
  | […](/browser/alttext-ai/trunk/includes/class-atai-attachment.php?rev=3074350#L556) | […](/browser/alttext-ai/trunk/includes/class-atai-attachment.php?rev=3086107#L556) |  |
  | 556 | 556 | from {$wpdb->postmeta} |
  | 557 | 557 | where meta\_key = '\_seopress\_analysis\_target\_kw' |
  | 558 |  | and post\_id = ~~{$post\_id};~~ |
  |  | 558 | and post\_id = %d |
  | 559 | 559 | SQL; |
  | 560 | 560 |  |
  | 561 |  | $keywords = $wpdb->get\_results( $~~keyword\_sql~~ ); |
  |  | 561 | $keywords = $wpdb->get\_results( $wpdb->prepare($keyword\_sql, $post\_id) ); |
  | 562 | 562 |  |
  | 563 | 563 | if ( count( $keywords ) == 0 || strlen( $keywords[0]->focus\_keywords ) == 0 ) { |
  | […](/browser/alttext-ai/trunk/includes/class-atai-attachment.php?rev=3074350#L625) | […](/browser/alttext-ai/trunk/includes/class-atai-attachment.php?rev=3086107#L625) |  |
  | 625 | 625 | select COALESCE(post\_title, '') as title |
  | 626 | 626 | from {$wpdb->posts} |
  | 627 |  | where ID = (select post\_parent from {$wpdb->posts} where ID = ~~{$attachment\_id}~~); |
  |  | 627 | where ID = (select post\_parent from {$wpdb->posts} where ID = %d); |
  | 628 | 628 | SQL; |
  | 629 | 629 |  |
  | 630 |  | $keyword\_source = $wpdb->get\_results( $~~keyword\_sql~~ ); |
  |  | 630 | $keyword\_source = $wpdb->get\_results( $wpdb->prepare($keyword\_sql, $attachment\_id) ); |
  | 631 | 631 | if ( count( $keyword\_source ) == 0 || strlen( $keyword\_source[0]->title ) == 0 ) { |
  | 632 | 632 | return; |
  | […](/browser/alttext-ai/trunk/includes/class-atai-attachment.php?rev=3074350#L674) | […](/browser/alttext-ai/trunk/includes/class-atai-attachment.php?rev=3086107#L674) |  |
  | 674 | 674 |  |
  | 675 | 675 | global $wpdb; |
  | 676 |  | $post\_id = ~~$\_REQUEST['post\_id'] ?? 0~~; |
  | 677 |  | $last\_post\_id = ~~$\_REQUEST['last\_post\_id'] ?? 0~~; |
  | 678 |  | $query\_limit = $\_REQUEST['posts\_per\_page'] ?~~?~~ 1; |
  |  | 676 | $post\_id = intval($\_REQUEST['post\_id']); |
  |  | 677 | $last\_post\_id = intval($\_REQUEST['last\_post\_id']); |
  |  | 678 | $query\_limit = $\_REQUEST['posts\_per\_page'] ? intval($\_REQUEST['posts\_per\_page']) : 1; |
  | 679 | 679 | $keywords = $\_REQUEST['keywords'] ?? []; |
  | 680 | 680 | $negative\_keywords = $\_REQUEST['negativeKeywords'] ?? []; |
* ## [alttext-ai/trunk/includes/class-atai-utility.php](/changeset/3086107/alttext-ai/trunk/includes/class-atai-utility.php "Show the changeset 3086107 restricted to alttext-ai/trunk/includes/class-atai-utility.php")

  | [r3079660](/browser/alttext-ai/trunk/includes/class-atai-utility.php?rev=3079660#L233 "Show revision 3079660 of this file in browser") | [r3086107](/browser/alttext-ai/trunk/includes/class-atai-utility.php?rev=3086107#L233 "Show revision 3086107 of this file in browser") |  |
  | --- | --- | --- |
  | 233 | 233 | inner join {$wpdb->term\_taxonomy} tt on tt.term\_id = terms.term\_id |
  | 234 | 234 | inner join {$wpdb->term\_relationships} tr on tr.term\_taxonomy\_id = tt.term\_taxonomy\_id |
  | 235 |  | where tr.object\_id = ~~{$attachment\_id}~~ |
  |  | 235 | where tr.object\_id = %d |
  | 236 | 236 | and tt.taxonomy = 'language'; |
  | 237 | 237 | SQL; |
  | 238 | 238 |  |
  | 239 |  | $lang\_data = $wpdb->get\_results( $~~language\_sql~~ ); |
  |  | 239 | $lang\_data = $wpdb->get\_results( $wpdb->prepare($language\_sql, $attachment\_id) ); |
  | 240 | 240 | $language = NULL; |
  | 241 | 241 |  |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3086107)
* [Zip Archive](?format=zip&new=3086107)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

