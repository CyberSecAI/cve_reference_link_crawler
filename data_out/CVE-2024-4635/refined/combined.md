=== Content from www.wordfence.com_5a3b8374_20250111_191624.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Menu Icons by ThemeIsle <= 0.13.13 - Authenticated (Author+) Stored Cross-Site Scripting via SVG Upload

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Menu Icons by ThemeIsle <= 0.13.13 - Authenticated (Author+) Stored Cross-Site Scripting via SVG Upload

6.4

**Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N)

| CVE | [CVE-2024-4635](https://www.cve.org/CVERecord?id=CVE-2024-4635) |
| --- | --- |
| CVSS | 6.4 (Medium) |
| Publicly Published | May 15, 2024 |
| Last Updated | May 16, 2024 |
| Researcher | [wesley (wcraft)](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/wesley-jhon) |

### Description

The Menu Icons by ThemeIsle plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the ‘add\_mime\_type’ function in versions up to, and including, 0.13.13 due to insufficient input sanitization and output escaping. This makes it possible for authenticated attackers, with author-level permissions and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/menu-icons/tags/0.13.13/vendor/codeinwp/icon-picker/includes/types/svg.php#L69)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset/3086753/)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fmenu-icons%2Fmenu-icons-by-themeisle-01313-authenticated-author-stored-cross-site-scripting-via-svg-upload&t=Menu%20Icons%20by%20ThemeIsle%20%3C%3D%200.13.13%20-%20Authenticated%20%28Author%2B%29%20Stored%20Cross-Site%20Scripting%20via%20SVG%20Upload "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fmenu-icons%2Fmenu-icons-by-themeisle-01313-authenticated-author-stored-cross-site-scripting-via-svg-upload&text=Menu%20Icons%20by%20ThemeIsle%20%3C%3D%200.13.13%20-%20Authenticated%20%28Author%2B%29%20Stored%20Cross-Site%20Scripting%20via%20SVG%20Upload "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fmenu-icons%2Fmenu-icons-by-themeisle-01313-authenticated-author-stored-cross-site-scripting-via-svg-upload "LinkedIn")
Email

## Vulnerability Details for Menu Icons by ThemeIsle

#### [Menu Icons by ThemeIsle](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/menu-icons)

| Software Type | Plugin |
| --- | --- |
| Software Slug | menu-icons [(view on wordpress.org)](https://wordpress.org/plugins/menu-icons) |
| Patched? | Yes |
| Remediation | Update to version 0.13.14, or a newer patched version |
| Affected Version | * <= 0.13.13 |
| Patched Version | * 0.13.14 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from plugins.trac.wordpress.org_e5e7e42b_20250111_191621.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fmenu-icons%2Ftags%2F0.13.13%2Fvendor%2Fcodeinwp%2Ficon-picker%2Fincludes%2Ftypes%2Fsvg.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← Previous Revision
* [Next Revision](/browser/menu-icons/trunk/vendor/codeinwp/icon-picker/includes/types/svg.php?rev=3086753 "Revision 3086753") →
* [Blame](/browser/menu-icons/trunk/vendor/codeinwp/icon-picker/includes/types/svg.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/menu-icons/tags/0.13.13/vendor/codeinwp/icon-picker/includes/types/svg.php)

---

# [source:](/browser?order=name "Go to repository root") [menu-icons](/browser/menu-icons?order=name "View menu-icons")/[tags](/browser/menu-icons/tags?order=name "View tags")/[0.13.13](/browser/menu-icons/tags/0.13.13?order=name "View 0.13.13")/[vendor](/browser/menu-icons/tags/0.13.13/vendor?order=name "View vendor")/[codeinwp](/browser/menu-icons/tags/0.13.13/vendor/codeinwp?order=name "View codeinwp")/[icon-picker](/browser/menu-icons/tags/0.13.13/vendor/codeinwp/icon-picker?order=name "View icon-picker")/[includes](/browser/menu-icons/tags/0.13.13/vendor/codeinwp/icon-picker/includes?order=name "View includes")/[types](/browser/menu-icons/tags/0.13.13/vendor/codeinwp/icon-picker/includes/types?order=name "View types")/[svg.php](/browser/menu-icons/tags/0.13.13/vendor/codeinwp/icon-picker/includes/types/svg.php?order=name "View svg.php")

View diff against:

View revision:

| [Last change](/changeset/1990980/menu-icons/trunk/vendor/codeinwp/icon-picker/includes/types/svg.php "View differences") on this file was [1990980](/changeset/1990980/ "View changeset 1990980"), checked in by codeinwp, [6 years ago](/timeline?from=2018-12-10T16%3A26%3A44Z&precision=second "See timeline at 12/10/2018 04:26:44 PM") |
| --- |
| Release v0.11.4 |
| **File size:** 2.3 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\*\* |
| [3](#L3) | \* SVG icon handler |
| [4](#L4) | \* |
| [5](#L5) | \* @package Icon\_Picker |
| [6](#L6) | \* @author  Dzikri Aziz <kvcrvt@gmail.com> |
| [7](#L7) | \*/ |
| [8](#L8) |  |
| [9](#L9) | require\_once dirname( \_\_FILE\_\_ ) . '/image.php'; |
| [10](#L10) |  |
| [11](#L11) | /\*\* |
| [12](#L12) | \* Image icon |
| [13](#L13) | \* |
| [14](#L14) | \*/ |
| [15](#L15) | class Icon\_Picker\_Type\_Svg extends Icon\_Picker\_Type\_Image { |
| [16](#L16) |  |
| [17](#L17) | /\*\* |
| [18](#L18) | \* Icon type ID |
| [19](#L19) | \* |
| [20](#L20) | \* @since  0.1.0 |
| [21](#L21) | \* @access protected |
| [22](#L22) | \* @var    string |
| [23](#L23) | \*/ |
| [24](#L24) | protected $id = 'svg'; |
| [25](#L25) |  |
| [26](#L26) | /\*\* |
| [27](#L27) | \* Template ID |
| [28](#L28) | \* |
| [29](#L29) | \* @since  0.1.0 |
| [30](#L30) | \* @access protected |
| [31](#L31) | \* @var    string |
| [32](#L32) | \*/ |
| [33](#L33) | protected $template\_id = 'svg'; |
| [34](#L34) |  |
| [35](#L35) | /\*\* |
| [36](#L36) | \* Mime type |
| [37](#L37) | \* |
| [38](#L38) | \* @since  0.1.0 |
| [39](#L39) | \* @access protected |
| [40](#L40) | \* @var    string |
| [41](#L41) | \*/ |
| [42](#L42) | protected $mime\_type = 'image/svg+xml'; |
| [43](#L43) |  |
| [44](#L44) |  |
| [45](#L45) | /\*\* |
| [46](#L46) | \* Constructor |
| [47](#L47) | \* |
| [48](#L48) | \* @since 0.1.0 |
| [49](#L49) | \* @param array $args Misc. arguments. |
| [50](#L50) | \*/ |
| [51](#L51) | public function \_\_construct( $args = array() ) { |
| [52](#L52) | $this->name = \_\_( 'SVG', 'icon-picker' ); |
| [53](#L53) |  |
| [54](#L54) | parent::\_\_construct( $args ); |
| [55](#L55) | add\_filter( 'upload\_mimes', array( $this, '\_add\_mime\_type' ) ); |
| [56](#L56) | } |
| [57](#L57) |  |
| [58](#L58) |  |
| [59](#L59) | /\*\* |
| [60](#L60) | \* Add SVG support |
| [61](#L61) | \* |
| [62](#L62) | \* @since   0.1.0 |
| [63](#L63) | \* @wp\_hook filter upload\_mimes |
| [64](#L64) | \* @link    https://codex.wordpress.org/Plugin\_API/Filter\_Reference/upload\_mimes |
| [65](#L65) | \* @author  Ethan Clevenger (GitHub: ethanclevenger91; email: ethan.c.clevenger@gmail.com) |
| [66](#L66) | \* |
| [67](#L67) | \* @return  array |
| [68](#L68) | \*/ |
| [69](#L69) | public function \_add\_mime\_type( array $mimes ) { |
| [70](#L70) | if ( ! isset( $mimes['svg'] ) ) { |
| [71](#L71) | $mimes['svg'] = $this->mime\_type; |
| [72](#L72) | } |
| [73](#L73) |  |
| [74](#L74) | return $mimes; |
| [75](#L75) | } |
| [76](#L76) |  |
| [77](#L77) |  |
| [78](#L78) | /\*\* |
| [79](#L79) | \* Get extra properties data |
| [80](#L80) | \* |
| [81](#L81) | \* @since  0.1.0 |
| [82](#L82) | \* @access protected |
| [83](#L83) | \* @return array |
| [84](#L84) | \*/ |
| [85](#L85) | protected function get\_props\_data() { |
| [86](#L86) | return array( |
| [87](#L87) | 'mimeTypes' => array( $this->mime\_type ), |
| [88](#L88) | ); |
| [89](#L89) | } |
| [90](#L90) |  |
| [91](#L91) |  |
| [92](#L92) | /\*\* |
| [93](#L93) | \* Media templates |
| [94](#L94) | \* |
| [95](#L95) | \* @since  0.1.0 |
| [96](#L96) | \* @return array |
| [97](#L97) | \*/ |
| [98](#L98) | public function get\_templates() { |
| [99](#L99) | $templates = array( |
| [100](#L100) | 'icon' => '<img src="{{ data.url }}" class="\_icon" />', |
| [101](#L101) | 'item' => sprintf( |
| [102](#L102) | '<div class="attachment-preview js--select-attachment svg-icon"> |
| [103](#L103) | <div class="thumbnail"> |
| [104](#L104) | <div class="centered"> |
| [105](#L105) | <img src="{{ data.url }}" alt="{{ data.alt }}" class="\_icon \_{{data.type}}" /> |
| [106](#L106) | </div> |
| [107](#L107) | </div> |
| [108](#L108) | </div> |
| [109](#L109) | <a class="check" href="#" title="%s"><div class="media-modal-icon"></div></a>', |
| [110](#L110) | esc\_attr\_\_( 'Deselect', 'menu-icons' ) |
| [111](#L111) | ), |
| [112](#L112) | ); |
| [113](#L113) |  |
| [114](#L114) | /\*\* |
| [115](#L115) | \* Filter media templates |
| [116](#L116) | \* |
| [117](#L117) | \* @since 0.1.0 |
| [118](#L118) | \* @param array $templates Media templates. |
| [119](#L119) | \*/ |
| [120](#L120) | $templates = apply\_filters( 'icon\_picker\_svg\_media\_templates', $templates ); |
| [121](#L121) |  |
| [122](#L122) | return $templates; |
| [123](#L123) | } |
| [124](#L124) | } |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/menu-icons/tags/0.13.13/vendor/codeinwp/icon-picker/includes/types/svg.php?format=txt)
* [Original Format](/export/3220810/menu-icons/tags/0.13.13/vendor/codeinwp/icon-picker/includes/types/svg.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_9fea22f9_20250111_191623.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3086753)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Changeset](/changeset/3086752 "Changeset 3086752")
* [Next Changeset](/changeset/3086754 "Changeset 3086754") →

---

# Changeset 3086753

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
05/14/2024 10:43:20 PM
([8 months](/timeline?from=2024-05-14T22%3A43%3A20Z&precision=second "See timeline at 05/14/2024 10:43:20 PM") ago)

Author:
themeisle
Message:

Update to version 0.13.14 from GitHub

Location:
[menu-icons](/browser/menu-icons?rev=3086753)
Files:

42 added
20 edited
1 copied

* [tags/0.13.14](/browser/menu-icons/tags/0.13.14?rev=3086753 "Show entry in browser")
  (copied)
  *(copied from [menu-icons/trunk](/browser/menu-icons/trunk?rev=3072875 "Show original file (revision 3086752)"))*
* [tags/0.13.14/CHANGELOG.md](/browser/menu-icons/tags/0.13.14/CHANGELOG.md?rev=3086753 "Show entry in browser")
  (modified)
  ([1 diff](#file1 "Show differences"))
* [tags/0.13.14/menu-icons.php](/browser/menu-icons/tags/0.13.14/menu-icons.php?rev=3086753 "Show entry in browser")
  (modified)
  ([2 diffs](#file2 "Show differences"))
* [tags/0.13.14/readme.txt](/browser/menu-icons/tags/0.13.14/readme.txt?rev=3086753 "Show entry in browser")
  (modified)
  ([1 diff](#file3 "Show differences"))
* [tags/0.13.14/vendor/codeinwp/icon-picker/includes/types/svg.php](/browser/menu-icons/tags/0.13.14/vendor/codeinwp/icon-picker/includes/types/svg.php?rev=3086753 "Show entry in browser")
  (modified)
  ([2 diffs](#file4 "Show differences"))
* [tags/0.13.14/vendor/composer/autoload\_classmap.php](/browser/menu-icons/tags/0.13.14/vendor/composer/autoload_classmap.php?rev=3086753 "Show entry in browser")
  (modified)
  ([1 diff](#file5 "Show differences"))
* [tags/0.13.14/vendor/composer/autoload\_psr4.php](/browser/menu-icons/tags/0.13.14/vendor/composer/autoload_psr4.php?rev=3086753 "Show entry in browser")
  (modified)
  ([1 diff](#file6 "Show differences"))
* [tags/0.13.14/vendor/composer/autoload\_real.php](/browser/menu-icons/tags/0.13.14/vendor/composer/autoload_real.php?rev=3086753 "Show entry in browser")
  (modified)
  ([1 diff](#file7 "Show differences"))
* [tags/0.13.14/vendor/composer/autoload\_static.php](/browser/menu-icons/tags/0.13.14/vendor/composer/autoload_static.php?rev=3086753 "Show entry in browser")
  (modified)
  ([2 diffs](#file8 "Show differences"))
* [tags/0.13.14/vendor/composer/installed.json](/browser/menu-icons/tags/0.13.14/vendor/composer/installed.json?rev=3086753 "Show entry in browser")
  (modified)
  ([3 diffs](#file9 "Show differences"))
* [tags/0.13.14/vendor/composer/installed.php](/browser/menu-icons/tags/0.13.14/vendor/composer/installed.php?rev=3086753 "Show entry in browser")
  (modified)
  ([4 diffs](#file10 "Show differences"))
* [tags/0.13.14/vendor/composer/platform\_check.php](/browser/menu-icons/tags/0.13.14/vendor/composer/platform_check.php?rev=3086753 "Show entry in browser")
  (added)
* [tags/0.13.14/vendor/enshrined](/browser/menu-icons/tags/0.13.14/vendor/enshrined?rev=3086753 "Show entry in browser")
  (added)
* [tags/0.13.14/vendor/enshrined/svg-sanitize](/browser/menu-icons/tags/0.13.14/vendor/enshrined/svg-sanitize?rev=3086753 "Show entry in browser")
  (added)
* [tags/0.13.14/vendor/enshrined/svg-sanitize/LICENSE](/browser/menu-icons/tags/0.13.14/vendor/enshrined/svg-sanitize/LICENSE?rev=3086753 "Show entry in browser")
  (added)
* [tags/0.13.14/vendor/enshrined/svg-sanitize/README.md](/browser/menu-icons/tags/0.13.14/vendor/enshrined/svg-sanitize/README.md?rev=3086753 "Show entry in browser")
  (added)
* [tags/0.13.14/vendor/enshrined/svg-sanitize/src](/browser/menu-icons/tags/0.13.14/vendor/enshrined/svg-sanitize/src?rev=3086753 "Show entry in browser")
  (added)
* [tags/0.13.14/vendor/enshrined/svg-sanitize/src/ElementReference](/browser/menu-icons/tags/0.13.14/vendor/enshrined/svg-sanitize/src/ElementReference?rev=3086753 "Show entry in browser")
  (added)
* [tags/0.13.14/vendor/enshrined/svg-sanitize/src/ElementReference/Resolver.php](/browser/menu-icons/tags/0.13.14/vendor/enshrined/svg-sanitize/src/ElementReference/Resolver.php?rev=3086753 "Show entry in browser")
  (added)
* [tags/0.13.14/vendor/enshrined/svg-sanitize/src/ElementReference/Subject.php](/browser/menu-icons/tags/0.13.14/vendor/enshrined/svg-sanitize/src/ElementReference/Subject.php?rev=3086753 "Show entry in browser")
  (added)
* [tags/0.13.14/vendor/enshrined/svg-sanitize/src/ElementReference/Usage.php](/browser/menu-icons/tags/0.13.14/vendor/enshrined/svg-sanitize/src/ElementReference/Usage.php?rev=3086753 "Show entry in browser")
  (added)
* [tags/0.13.14/vendor/enshrined/svg-sanitize/src/Exceptions](/browser/menu-icons/tags/0.13.14/vendor/enshrined/svg-sanitize/src/Exceptions?rev=3086753 "Show entry in browser")
  (added)
* [tags/0.13.14/vendor/enshrined/svg-sanitize/src/Exceptions/NestingException.php](/browser/menu-icons/tags/0.13.14/vendor/enshrined/svg-sanitize/src/Exceptions/NestingException.php?rev=3086753 "Show entry in browser")
  (added)
* [tags/0.13.14/vendor/enshrined/svg-sanitize/src/Helper.php](/browser/menu-icons/tags/0.13.14/vendor/enshrined/svg-sanitize/src/Helper.php?rev=3086753 "Show entry in browser")
  (added)
* [tags/0.13.14/vendor/enshrined/svg-sanitize/src/Sanitizer.php](/browser/menu-icons/tags/0.13.14/vendor/enshrined/svg-sanitize/src/Sanitizer.php?rev=3086753 "Show entry in browser")
  (added)
* [tags/0.13.14/vendor/enshrined/svg-sanitize/src/data](/browser/menu-icons/tags/0.13.14/vendor/enshrined/svg-sanitize/src/data?rev=3086753 "Show entry in browser")
  (added)
* [tags/0.13.14/vendor/enshrined/svg-sanitize/src/data/AllowedAttributes.php](/browser/menu-icons/tags/0.13.14/vendor/enshrined/svg-sanitize/src/data/AllowedAttributes.php?rev=3086753 "Show entry in browser")
  (added)
* [tags/0.13.14/vendor/enshrined/svg-sanitize/src/data/AllowedTags.php](/browser/menu-icons/tags/0.13.14/vendor/enshrined/svg-sanitize/src/data/AllowedTags.php?rev=3086753 "Show entry in browser")
  (added)
* [tags/0.13.14/vendor/enshrined/svg-sanitize/src/data/AttributeInterface.php](/browser/menu-icons/tags/0.13.14/vendor/enshrined/svg-sanitize/src/data/AttributeInterface.php?rev=3086753 "Show entry in browser")
  (added)
* [tags/0.13.14/vendor/enshrined/svg-sanitize/src/data/TagInterface.php](/browser/menu-icons/tags/0.13.14/vendor/enshrined/svg-sanitize/src/data/TagInterface.php?rev=3086753 "Show entry in browser")
  (added)
* [tags/0.13.14/vendor/enshrined/svg-sanitize/src/data/XPath.php](/browser/menu-icons/tags/0.13.14/vendor/enshrined/svg-sanitize/src/data/XPath.php?rev=3086753 "Show entry in browser")
  (added)
* [tags/0.13.14/vendor/enshrined/svg-sanitize/src/svg-scanner.php](/browser/menu-icons/tags/0.13.14/vendor/enshrined/svg-sanitize/src/svg-scanner.php?rev=3086753 "Show entry in browser")
  (added)
* [trunk/CHANGELOG.md](/browser/menu-icons/trunk/CHANGELOG.md?rev=3086753 "Show entry in browser")
  (modified)
  ([1 diff](#file32 "Show differences"))
* [trunk/menu-icons.php](/browser/menu-icons/trunk/menu-icons.php?rev=3086753 "Show entry in browser")
  (modified)
  ([2 diffs](#file33 "Show differences"))
* [trunk/readme.txt](/browser/menu-icons/trunk/readme.txt?rev=3086753 "Show entry in browser")
  (modified)
  ([1 diff](#file34 "Show differences"))
* [trunk/vendor/codeinwp/icon-picker/includes/types/svg.php](/browser/menu-icons/trunk/vendor/codeinwp/icon-picker/includes/types/svg.php?rev=3086753 "Show entry in browser")
  (modified)
  ([2 diffs](#file35 "Show differences"))
* [trunk/vendor/composer/autoload\_classmap.php](/browser/menu-icons/trunk/vendor/composer/autoload_classmap.php?rev=3086753 "Show entry in browser")
  (modified)
  ([1 diff](#file36 "Show differences"))
* [trunk/vendor/composer/autoload\_psr4.php](/browser/menu-icons/trunk/vendor/composer/autoload_psr4.php?rev=3086753 "Show entry in browser")
  (modified)
  ([1 diff](#file37 "Show differences"))
* [trunk/vendor/composer/autoload\_real.php](/browser/menu-icons/trunk/vendor/composer/autoload_real.php?rev=3086753 "Show entry in browser")
  (modified)
  ([1 diff](#file38 "Show differences"))
* [trunk/vendor/composer/autoload\_static.php](/browser/menu-icons/trunk/vendor/composer/autoload_static.php?rev=3086753 "Show entry in browser")
  (modified)
  ([2 diffs](#file39 "Show differences"))
* [trunk/vendor/composer/installed.json](/browser/menu-icons/trunk/vendor/composer/installed.json?rev=3086753 "Show entry in browser")
  (modified)
  ([3 diffs](#file40 "Show differences"))
* [trunk/vendor/composer/installed.php](/browser/menu-icons/trunk/vendor/composer/installed.php?rev=3086753 "Show entry in browser")
  (modified)
  ([4 diffs](#file41 "Show differences"))
* [trunk/vendor/composer/platform\_check.php](/browser/menu-icons/trunk/vendor/composer/platform_check.php?rev=3086753 "Show entry in browser")
  (added)
* [trunk/vendor/enshrined](/browser/menu-icons/trunk/vendor/enshrined?rev=3086753 "Show entry in browser")
  (added)
* [trunk/vendor/enshrined/svg-sanitize](/browser/menu-icons/trunk/vendor/enshrined/svg-sanitize?rev=3086753 "Show entry in browser")
  (added)
* [trunk/vendor/enshrined/svg-sanitize/LICENSE](/browser/menu-icons/trunk/vendor/enshrined/svg-sanitize/LICENSE?rev=3086753 "Show entry in browser")
  (added)
* [trunk/vendor/enshrined/svg-sanitize/README.md](/browser/menu-icons/trunk/vendor/enshrined/svg-sanitize/README.md?rev=3086753 "Show entry in browser")
  (added)
* [trunk/vendor/enshrined/svg-sanitize/src](/browser/menu-icons/trunk/vendor/enshrined/svg-sanitize/src?rev=3086753 "Show entry in browser")
  (added)
* [trunk/vendor/enshrined/svg-sanitize/src/ElementReference](/browser/menu-icons/trunk/vendor/enshrined/svg-sanitize/src/ElementReference?rev=3086753 "Show entry in browser")
  (added)
* [trunk/vendor/enshrined/svg-sanitize/src/ElementReference/Resolver.php](/browser/menu-icons/trunk/vendor/enshrined/svg-sanitize/src/ElementReference/Resolver.php?rev=3086753 "Show entry in browser")
  (added)
* [trunk/vendor/enshrined/svg-sanitize/src/ElementReference/Subject.php](/browser/menu-icons/trunk/vendor/enshrined/svg-sanitize/src/ElementReference/Subject.php?rev=3086753 "Show entry in browser")
  (added)
* [trunk/vendor/enshrined/svg-sanitize/src/ElementReference/Usage.php](/browser/menu-icons/trunk/vendor/enshrined/svg-sanitize/src/ElementReference/Usage.php?rev=3086753 "Show entry in browser")
  (added)
* [trunk/vendor/enshrined/svg-sanitize/src/Exceptions](/browser/menu-icons/trunk/vendor/enshrined/svg-sanitize/src/Exceptions?rev=3086753 "Show entry in browser")
  (added)
* [trunk/vendor/enshrined/svg-sanitize/src/Exceptions/NestingException.php](/browser/menu-icons/trunk/vendor/enshrined/svg-sanitize/src/Exceptions/NestingException.php?rev=3086753 "Show entry in browser")
  (added)
* [trunk/vendor/enshrined/svg-sanitize/src/Helper.php](/browser/menu-icons/trunk/vendor/enshrined/svg-sanitize/src/Helper.php?rev=3086753 "Show entry in browser")
  (added)
* [trunk/vendor/enshrined/svg-sanitize/src/Sanitizer.php](/browser/menu-icons/trunk/vendor/enshrined/svg-sanitize/src/Sanitizer.php?rev=3086753 "Show entry in browser")
  (added)
* [trunk/vendor/enshrined/svg-sanitize/src/data](/browser/menu-icons/trunk/vendor/enshrined/svg-sanitize/src/data?rev=3086753 "Show entry in browser")
  (added)
* [trunk/vendor/enshrined/svg-sanitize/src/data/AllowedAttributes.php](/browser/menu-icons/trunk/vendor/enshrined/svg-sanitize/src/data/AllowedAttributes.php?rev=3086753 "Show entry in browser")
  (added)
* [trunk/vendor/enshrined/svg-sanitize/src/data/AllowedTags.php](/browser/menu-icons/trunk/vendor/enshrined/svg-sanitize/src/data/AllowedTags.php?rev=3086753 "Show entry in browser")
  (added)
* [trunk/vendor/enshrined/svg-sanitize/src/data/AttributeInterface.php](/browser/menu-icons/trunk/vendor/enshrined/svg-sanitize/src/data/AttributeInterface.php?rev=3086753 "Show entry in browser")
  (added)
* [trunk/vendor/enshrined/svg-sanitize/src/data/TagInterface.php](/browser/menu-icons/trunk/vendor/enshrined/svg-sanitize/src/data/TagInterface.php?rev=3086753 "Show entry in browser")
  (added)
* [trunk/vendor/enshrined/svg-sanitize/src/data/XPath.php](/browser/menu-icons/trunk/vendor/enshrined/svg-sanitize/src/data/XPath.php?rev=3086753 "Show entry in browser")
  (added)
* [trunk/vendor/enshrined/svg-sanitize/src/svg-scanner.php](/browser/menu-icons/trunk/vendor/enshrined/svg-sanitize/src/svg-scanner.php?rev=3086753 "Show entry in browser")
  (added)

### Legend:

Unmodified
Added
Removed

* ## [menu-icons/tags/0.13.14/CHANGELOG.md](/changeset/3086753/menu-icons/tags/0.13.14/CHANGELOG.md "Show the changeset 3086753 restricted to menu-icons/tags/0.13.14/CHANGELOG.md")

  | [r3072875](/browser/menu-icons/trunk/CHANGELOG.md?rev=3072875#L1 "Show revision 3072875 of this file in browser") | [r3086753](/browser/menu-icons/tags/0.13.14/CHANGELOG.md?rev=3086753#L1 "Show revision 3086753 of this file in browser") |  |
  | --- | --- | --- |
  |  | 1 | ##### [Version 0.13.14](https://github.com/codeinwp/wp-menu-icons/compare/v0.13.13...v0.13.14) (2024-05-14) |
  |  | 2 |  |
  |  | 3 | - Enhanced security |
  |  | 4 |  |
  | 1 | 5 | ##### [Version 0.13.13](https://github.com/codeinwp/wp-menu-icons/compare/v0.13.12...v0.13.13) (2024-04-18) |
  | 2 | 6 |  |
* ## [menu-icons/tags/0.13.14/menu-icons.php](/changeset/3086753/menu-icons/tags/0.13.14/menu-icons.php "Show the changeset 3086753 restricted to menu-icons/tags/0.13.14/menu-icons.php")

  | [r3072875](/browser/menu-icons/trunk/menu-icons.php?rev=3072875#L12 "Show revision 3072875 of this file in browser") | [r3086753](/browser/menu-icons/tags/0.13.14/menu-icons.php?rev=3086753#L12 "Show revision 3086753 of this file in browser") |  |
  | --- | --- | --- |
  | 12 | 12 | \* Plugin URI:  https://github.com/Codeinwp/wp-menu-icons |
  | 13 | 13 | \* Description: Spice up your navigation menus with pretty icons, easily. |
  | 14 |  | \* Version:     0.13.1~~3~~ |
  |  | 14 | \* Version:     0.13.14 |
  | 15 | 15 | \* Author:      ThemeIsle |
  | 16 | 16 | \* Author URI:  https://themeisle.com |
  | […](/browser/menu-icons/trunk/menu-icons.php?rev=3072875#L30) | […](/browser/menu-icons/tags/0.13.14/menu-icons.php?rev=3086753#L30) |  |
  | 30 | 30 | const DISMISS\_NOTICE = 'menu-icons-dismiss-notice'; |
  | 31 | 31 |  |
  | 32 |  | const VERSION = '0.13.1~~3~~'; |
  |  | 32 | const VERSION = '0.13.14'; |
  | 33 | 33 |  |
  | 34 | 34 | /\*\* |
* ## [menu-icons/tags/0.13.14/readme.txt](/changeset/3086753/menu-icons/tags/0.13.14/readme.txt "Show the changeset 3086753 restricted to menu-icons/tags/0.13.14/readme.txt")

  | [r3072875](/browser/menu-icons/trunk/readme.txt?rev=3072875#L226 "Show revision 3072875 of this file in browser") | [r3086753](/browser/menu-icons/tags/0.13.14/readme.txt?rev=3086753#L226 "Show revision 3086753 of this file in browser") |  |
  | --- | --- | --- |
  | 226 | 226 | == Changelog == |
  | 227 | 227 |  |
  |  | 228 | ##### [Version 0.13.14](https://github.com/codeinwp/wp-menu-icons/compare/v0.13.13...v0.13.14) (2024-05-14) |
  |  | 229 |  |
  |  | 230 | - Enhanced security |
  |  | 231 |  |
  |  | 232 |  |
  |  | 233 |  |
  |  | 234 |  |
  | 228 | 235 | ##### [Version 0.13.13](https://github.com/codeinwp/wp-menu-icons/compare/v0.13.12...v0.13.13) (2024-04-18) |
  | 229 | 236 |  |
* ## [menu-icons/tags/0.13.14/vendor/codeinwp/icon-picker/includes/types/svg.php](/changeset/3086753/menu-icons/tags/0.13.14/vendor/codeinwp/icon-picker/includes/types/svg.php "Show the changeset 3086753 restricted to menu-icons/tags/0.13.14/vendor/codeinwp/icon-picker/includes/types/svg.php")

  | [r1990980](/browser/menu-icons/trunk/vendor/codeinwp/icon-picker/includes/types/svg.php?rev=1990980#L7 "Show revision 1990980 of this file in browser") | [r3086753](/browser/menu-icons/tags/0.13.14/vendor/codeinwp/icon-picker/includes/types/svg.php?rev=3086753#L7 "Show revision 3086753 of this file in browser") |  |
  | --- | --- | --- |
  | 7 | 7 | \*/ |
  | 8 | 8 |  |
  |  | 9 | use enshrined\svgSanitize\Sanitizer; |
  |  | 10 |  |
  | 9 | 11 | require\_once dirname( \_\_FILE\_\_ ) . '/image.php'; |
  | 10 | 12 |  |
  | […](/browser/menu-icons/trunk/vendor/codeinwp/icon-picker/includes/types/svg.php?rev=1990980#L54) | […](/browser/menu-icons/tags/0.13.14/vendor/codeinwp/icon-picker/includes/types/svg.php?rev=3086753#L56) |  |
  | 54 | 56 | parent::\_\_construct( $args ); |
  | 55 | 57 | add\_filter( 'upload\_mimes', array( $this, '\_add\_mime\_type' ) ); |
  |  | 58 | add\_filter( 'wp\_handle\_upload\_prefilter', array( $this, '\_check\_svg\_and\_sanitize' ) ); |
  |  | 59 | } |
  |  | 60 |  |
  |  | 61 | /\*\* |
  |  | 62 | \* Sanitize the SVG |
  |  | 63 | \* |
  |  | 64 | \* @param string $file Temp file path. |
  |  | 65 | \* |
  |  | 66 | \* @return bool|int |
  |  | 67 | \*/ |
  |  | 68 | protected function sanitize\_svg( $file ) { |
  |  | 69 | // We can ignore the phpcs warning here as we're reading and writing to the Temp file. |
  |  | 70 | $dirty = file\_get\_contents( $file ); // phpcs:ignore |
  |  | 71 |  |
  |  | 72 | // Is the SVG gzipped? If so we try and decode the string. |
  |  | 73 | $is\_zipped = $this->is\_gzipped( $dirty ); |
  |  | 74 | if ( $is\_zipped && ( ! function\_exists( 'gzdecode' ) || ! function\_exists( 'gzencode' ) ) ) { |
  |  | 75 | return false; |
  |  | 76 | } |
  |  | 77 |  |
  |  | 78 | if ( $is\_zipped ) { |
  |  | 79 | $dirty = gzdecode( $dirty ); |
  |  | 80 |  |
  |  | 81 | // If decoding fails, bail as we're not secure. |
  |  | 82 | if ( false === $dirty ) { |
  |  | 83 | return false; |
  |  | 84 | } |
  |  | 85 | } |
  |  | 86 |  |
  |  | 87 | $sanitizer = new Sanitizer(); |
  |  | 88 | $clean     = $sanitizer->sanitize( $dirty ); |
  |  | 89 |  |
  |  | 90 | if ( false === $clean ) { |
  |  | 91 | return false; |
  |  | 92 | } |
  |  | 93 |  |
  |  | 94 | // If we were gzipped, we need to re-zip. |
  |  | 95 | if ( $is\_zipped ) { |
  |  | 96 | $clean = gzencode( $clean ); |
  |  | 97 | } |
  |  | 98 |  |
  |  | 99 | // We can ignore the phpcs warning here as we're reading and writing to the Temp file. |
  |  | 100 | file\_put\_contents( $file, $clean ); // phpcs:ignore |
  |  | 101 |  |
  |  | 102 | return true; |
  |  | 103 | } |
  |  | 104 |  |
  |  | 105 | /\*\* |
  |  | 106 | \* Check if the contents are gzipped |
  |  | 107 | \* |
  |  | 108 | \* @see http://www.gzip.org/zlib/rfc-gzip.html#member-format |
  |  | 109 | \* |
  |  | 110 | \* @param string $contents Content to check. |
  |  | 111 | \* |
  |  | 112 | \* @return bool |
  |  | 113 | \*/ |
  |  | 114 | protected function is\_gzipped( $contents ) { |
  |  | 115 | // phpcs:disable Generic.Strings.UnnecessaryStringConcat.Found |
  |  | 116 | if ( function\_exists( 'mb\_strpos' ) ) { |
  |  | 117 | return 0 === mb\_strpos( $contents, "\x1f" . "\x8b" . "\x08" ); |
  |  | 118 | } else { |
  |  | 119 | return 0 === strpos( $contents, "\x1f" . "\x8b" . "\x08" ); |
  |  | 120 | } |
  |  | 121 | // phpcs:enable |
  |  | 122 | } |
  |  | 123 |  |
  |  | 124 | /\*\* |
  |  | 125 | \* Check if the file is an SVG, if so handle appropriately and sanitize. |
  |  | 126 | \* |
  |  | 127 | \* @param array $file An array of data for a single file. |
  |  | 128 | \* |
  |  | 129 | \* @return void |
  |  | 130 | \*/ |
  |  | 131 | public function \_check\_svg\_and\_sanitize( $file ) { |
  |  | 132 | // Ensure we have a proper file path before processing. |
  |  | 133 | if ( ! isset( $file['tmp\_name'] ) ) { |
  |  | 134 | return $file; |
  |  | 135 | } |
  |  | 136 |  |
  |  | 137 | $file\_name   = isset( $file['name'] ) ? $file['name'] : ''; |
  |  | 138 | $wp\_filetype = wp\_check\_filetype\_and\_ext( $file['tmp\_name'], $file\_name ); |
  |  | 139 | $type        = ! empty( $wp\_filetype['type'] ) ? $wp\_filetype['type'] : ''; |
  |  | 140 |  |
  |  | 141 | if ( 'image/svg+xml' === $type ) { |
  |  | 142 | if ( ! current\_user\_can( 'upload\_files' ) ) { |
  |  | 143 | $file['error'] = \_\_( |
  |  | 144 | 'Sorry, you are not allowed to upload files.', |
  |  | 145 | 'icon-picker' |
  |  | 146 | ); |
  |  | 147 |  |
  |  | 148 | return $file; |
  |  | 149 | } |
  |  | 150 |  |
  |  | 151 | if ( ! $this->sanitize\_svg( $file['tmp\_name'] ) ) { |
  |  | 152 | $file['error'] = \_\_( |
  |  | 153 | "Sorry, this file couldn't be sanitized so for security reasons wasn't uploaded", |
  |  | 154 | 'icon-picker' |
  |  | 155 | ); |
  |  | 156 | } |
  |  | 157 | } |
  |  | 158 |  |
  |  | 159 | return $file; |
  | 56 | 160 | } |
  | 57 | 161 |  |
* ## [menu-icons/tags/0.13.14/vendor/composer/autoload\_classmap.php](/changeset/3086753/menu-icons/tags/0.13.14/vendor/composer/autoload_classmap.php "Show the changeset 3086753 restricted to menu-icons/tags/0.13.14/vendor/composer/autoload_classmap.php")

  | [r2732729](/browser/menu-icons/trunk/vendor/composer/autoload_classmap.php?rev=2732729#L8 "Show revision 2732729 of this file in browser") | [r3086753](/browser/menu-icons/tags/0.13.14/vendor/composer/autoload_classmap.php?rev=3086753#L8 "Show revision 3086753 of this file in browser") |  |
  | --- | --- | --- |
  | 8 | 8 | return array( |
  | 9 | 9 | 'Composer\\InstalledVersions' => $vendorDir . '/composer/InstalledVersions.php', |
  |  | 10 | 'enshrined\\svgSanitize\\ElementReference\\Resolver' => $vendorDir . '/enshrined/svg-sanitize/src/ElementReference/Resolver.php', |
  |  | 11 | 'enshrined\\svgSanitize\\ElementReference\\Subject' => $vendorDir . '/enshrined/svg-sanitize/src/ElementReference/Subject.php', |
  |  | 12 | 'enshrined\\svgSanitize\\ElementReference\\Usage' => $vendorDir . '/enshrined/svg-sanitize/src/ElementReference/Usage.php', |
  |  | 13 | 'enshrined\\svgSanitize\\Exceptions\\NestingException' => $vendorDir . '/enshrined/svg-sanitize/src/Exceptions/NestingException.php', |
  |  | 14 | 'enshrined\\svgSanitize\\Helper' => $vendorDir . '/enshrined/svg-sanitize/src/Helper.php', |
  |  | 15 | 'enshrined\\svgSanitize\\Sanitizer' => $vendorDir . '/enshrined/svg-sanitize/src/Sanitizer.php', |
  |  | 16 | 'enshrined\\svgSanitize\\data\\AllowedAttributes' => $vendorDir . '/enshrined/svg-sanitize/src/data/AllowedAttributes.php', |
  |  | 17 | 'enshrined\\svgSanitize\\data\\AllowedTags' => $vendorDir . '/enshrined/svg-sanitize/src/data/AllowedTags.php', |
  |  | 18 | 'enshrined\\svgSanitize\\data\\AttributeInterface' => $vendorDir . '/enshrined/svg-sanitize/src/data/AttributeInterface.php', |
  |  | 19 | 'enshrined\\svgSanitize\\data\\TagInterface' => $vendorDir . '/enshrined/svg-sanitize/src/data/TagInterface.php', |
  |  | 20 | 'enshrined\\svgSanitize\\data\\XPath' => $vendorDir . '/enshrined/svg-sanitize/src/data/XPath.php', |
  | 10 | 21 | ); |
* ## [menu-icons/tags/0.13.14/vendor/composer/autoload\_psr4.php](/changeset/3086753/menu-icons/tags/0.13.14/vendor/composer/autoload_psr4.php "Show the changeset 3086753 restricted to menu-icons/tags/0.13.14/vendor/composer/autoload_psr4.php")

  | [r2732729](/browser/menu-icons/trunk/vendor/composer/autoload_psr4.php?rev=2732729#L7 "Show revision 2732729 of this file in browser") | [r3086753](/browser/menu-icons/tags/0.13.14/vendor/composer/autoload_psr4.php?rev=3086753#L7 "Show revision 3086753 of this file in browser") |  |
  | --- | --- | --- |
  | 7 | 7 |  |
  | 8 | 8 | return array( |
  |  | 9 | 'enshrined\\svgSanitize\\' => array($vendorDir . '/enshrined/svg-sanitize/src'), |
  | 9 | 10 | ); |
* ## [menu-icons/tags/0.13.14/vendor/composer/autoload\_real.php](/changeset/3086753/menu-icons/tags/0.13.14/vendor/composer/autoload_real.php "Show the changeset 3086753 restricted to menu-icons/tags/0.13.14/vendor/composer/autoload_real.php")

  | [r3012213](/browser/menu-icons/trunk/vendor/composer/autoload_real.php?rev=3012213#L22 "Show revision 3012213 of this file in browser") | [r3086753](/browser/menu-icons/tags/0.13.14/vendor/composer/autoload_real.php?rev=3086753#L22 "Show revision 3086753 of this file in browser") |  |
  | --- | --- | --- |
  | 22 | 22 | return self::$loader; |
  | 23 | 23 | } |
  |  | 24 |  |
  |  | 25 | require \_\_DIR\_\_ . '/platform\_check.php'; |
  | 24 | 26 |  |
  | 25 | 27 | spl\_autoload\_register(array('ComposerAutoloaderInite0e064cdd82a4be104872380c8a68791', 'loadClassLoader'), true, true); |
* ## [menu-icons/tags/0.13.14/vendor/composer/autoload\_static.php](/changeset/3086753/menu-icons/tags/0.13.14/vendor/composer/autoload_static.php "Show the changeset 3086753 restricted to menu-icons/tags/0.13.14/vendor/composer/autoload_static.php")

  | [r3012213](/browser/menu-icons/trunk/vendor/composer/autoload_static.php?rev=3012213#L14 "Show revision 3012213 of this file in browser") | [r3086753](/browser/menu-icons/tags/0.13.14/vendor/composer/autoload_static.php?rev=3086753#L14 "Show revision 3086753 of this file in browser") |  |
  | --- | --- | --- |
  | 14 | 14 | ); |
  | 15 | 15 |  |
  |  | 16 | public static $prefixLengthsPsr4 = array ( |
  |  | 17 | 'e' => |
  |  | 18 | array ( |
  |  | 19 | 'enshrined\\svgSanitize\\' => 22, |
  |  | 20 | ), |
  |  | 21 | ); |
  |  | 22 |  |
  |  | 23 | public static $prefixDirsPsr4 = array ( |
  |  | 24 | 'enshrined\\svgSanitize\\' => |
  |  | 25 | array ( |
  |  | 26 | 0 => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src', |
  |  | 27 | ), |
  |  | 28 | ); |
  |  | 29 |  |
  | 16 | 30 | public static $classMap = array ( |
  | 17 | 31 | 'Composer\\InstalledVersions' => \_\_DIR\_\_ . '/..' . '/composer/InstalledVersions.php', |
  |  | 32 | 'enshrined\\svgSanitize\\ElementReference\\Resolver' => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src/ElementReference/Resolver.php', |
  |  | 33 | 'enshrined\\svgSanitize\\ElementReference\\Subject' => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src/ElementReference/Subject.php', |
  |  | 34 | 'enshrined\\svgSanitize\\ElementReference\\Usage' => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src/ElementReference/Usage.php', |
  |  | 35 | 'enshrined\\svgSanitize\\Exceptions\\NestingException' => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src/Exceptions/NestingException.php', |
  |  | 36 | 'enshrined\\svgSanitize\\Helper' => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src/Helper.php', |
  |  | 37 | 'enshrined\\svgSanitize\\Sanitizer' => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src/Sanitizer.php', |
  |  | 38 | 'enshrined\\svgSanitize\\data\\AllowedAttributes' => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src/data/AllowedAttributes.php', |
  |  | 39 | 'enshrined\\svgSanitize\\data\\AllowedTags' => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src/data/AllowedTags.php', |
  |  | 40 | 'enshrined\\svgSanitize\\data\\AttributeInterface' => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src/data/AttributeInterface.php', |
  |  | 41 | 'enshrined\\svgSanitize\\data\\TagInterface' => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src/data/TagInterface.php', |
  |  | 42 | 'enshrined\\svgSanitize\\data\\XPath' => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src/data/XPath.php', |
  | 18 | 43 | ); |
  | 19 | 44 |  |
  | […](/browser/menu-icons/trunk/vendor/composer/autoload_static.php?rev=3012213#L21) | […](/browser/menu-icons/tags/0.13.14/vendor/composer/autoload_static.php?rev=3086753#L46) |  |
  | 21 | 46 | { |
  | 22 | 47 | return \Closure::bind(function () use ($loader) { |
  |  | 48 | $loader->prefixLengthsPsr4 = ComposerStaticInite0e064cdd82a4be104872380c8a68791::$prefixLengthsPsr4; |
  |  | 49 | $loader->prefixDirsPsr4 = ComposerStaticInite0e064cdd82a4be104872380c8a68791::$prefixDirsPsr4; |
  | 23 | 50 | $loader->classMap = ComposerStaticInite0e064cdd82a4be104872380c8a68791::$classMap; |
  | 24 | 51 |  |
* ## [menu-icons/tags/0.13.14/vendor/composer/installed.json](/changeset/3086753/menu-icons/tags/0.13.14/vendor/composer/installed.json "Show the changeset 3086753 restricted to menu-icons/tags/0.13.14/vendor/composer/installed.json")

  | [r3072875](/browser/menu-icons/trunk/vendor/composer/installed.json?rev=3072875#L54 "Show revision 3072875 of this file in browser") | [r3086753](/browser/menu-icons/tags/0.13.14/vendor/composer/installed.json?rev=3086753#L54 "Show revision 3086753 of this file in browser") |  |
  | --- | --- | --- |
  | 54 | 54 | "type": "git", |
  | 55 | 55 | "url": "https://github.com/Codeinwp/icon-picker.git", |
  | 56 |  | "reference": "~~0c60ce3a41653e41a20e710c4d5a6a2104c85020~~" |
  | 57 |  | }, |
  | 58 |  | "dist": { |
  | 59 |  | "type": "zip", |
  | 60 |  | "url": "https://api.github.com/repos/Codeinwp/icon-picker/zipball/~~0c60ce3a41653e41a20e710c4d5a6a2104c85020~~", |
  | 61 |  | "reference": "~~0c60ce3a41653e41a20e710c4d5a6a2104c85020~~", |
  |  | 56 | "reference": "8efc2e400231ad7d4af94ff9270cd5b50248d4c9" |
  |  | 57 | }, |
  |  | 58 | "dist": { |
  |  | 59 | "type": "zip", |
  |  | 60 | "url": "https://api.github.com/repos/Codeinwp/icon-picker/zipball/8efc2e400231ad7d4af94ff9270cd5b50248d4c9", |
  |  | 61 | "reference": "8efc2e400231ad7d4af94ff9270cd5b50248d4c9", |
  | 62 | 62 | "shasum": "" |
  | 63 | 63 | }, |
  | 64 | 64 | "require": { |
  | 65 |  | "composer/installers": "~1.0" |
  |  | 65 | "composer/installers": "~1.0", |
  |  | 66 | "enshrined/svg-sanitize": "^0.18.0" |
  | 66 | 67 | }, |
  | 67 | 68 | "require-dev": { |
  | 68 | 69 | "wp-coding-standards/wpcs": "^0.10.0" |
  | 69 | 70 | }, |
  | 70 |  | "time": "2021-05-05T18:52:26+00:00", |
  |  | 71 | "time": "2024-05-13T08:27:15+00:00", |
  |  | 72 | "default-branch": true, |
  | 71 | 73 | "type": "wordpress-plugin", |
  | 72 | 74 | "installation-source": "dist", |
  | […](/browser/menu-icons/trunk/vendor/composer/installed.json?rev=3072875#L87) | […](/browser/menu-icons/tags/0.13.14/vendor/composer/installed.json?rev=3086753#L89) |  |
  | 87 | 89 | "wordpress" |
  | 88 | 90 | ], |
  |  | 91 | "support": { |
  |  | 92 | "source": "https://github.com/Codeinwp/icon-picker/tree/master" |
  |  | 93 | }, |
  | 89 | 94 | "install-path": "../codeinwp/icon-picker" |
  | 90 | 95 | }, |
  | […](/browser/menu-icons/trunk/vendor/composer/installed.json?rev=3072875#L165) | […](/browser/menu-icons/tags/0.13.14/vendor/composer/installed.json?rev=3086753#L170) |  |
  | 165 | 170 | ], |
  | 166 | 171 | "install-path": "../codeinwp/themeisle-sdk" |
  |  | 172 | }, |
  |  | 173 | { |
  |  | 174 | "name": "enshrined/svg-sanitize", |
  |  | 175 | "version": "0.18.0", |
  |  | 176 | "version\_normalized": "0.18.0.0", |
  |  | 177 | "source": { |
  |  | 178 | "type": "git", |
  |  | 179 | "url": "https://github.com/darylldoyle/svg-sanitizer.git", |
  |  | 180 | "reference": "6a2c069dab3843ca4d887ff09c972fc7033888d0" |
  |  | 181 | }, |
  |  | 182 | "dist": { |
  |  | 183 | "type": "zip", |
  |  | 184 | "url": "https://api.github.com/repos/darylldoyle/svg-sanitizer/zipball/6a2c069dab3843ca4d887ff09c972fc7033888d0", |
  |  | 185 | "reference": "6a2c069dab3843ca4d887ff09c972fc7033888d0", |
  |  | 186 | "shasum": "" |
  |  | 187 | }, |
  |  | 188 | "require": { |
  |  | 189 | "ext-dom": "\*", |
  |  | 190 | "ext-libxml": "\*", |
  |  | 191 | "php": "^5.6 || ^7.0 || ^8.0" |
  |  | 192 | }, |
  |  | 193 | "require-dev": { |
  |  | 194 | "phpunit/phpunit": "^5.7 || ^6.5 || ^8.5" |
  |  | 195 | }, |
  |  | 196 | "time": "2024-02-22T17:51:05+00:00", |
  |  | 197 | "type": "library", |
  |  | 198 | "installation-source": "dist", |
  |  | 199 | "autoload": { |
  |  | 200 | "psr-4": { |
  |  | 201 | "enshrined\\svgSanitize\\": "src" |
  |  | 202 | } |
  |  | 203 | }, |
  |  | 204 | "notification-url": "https://packagist.org/downloads/", |
  |  | 205 | "license": [ |
  |  | 206 | "GPL-2.0-or-later" |
  |  | 207 | ], |
  |  | 208 | "authors": [ |
  |  | 209 | { |
  |  | 210 | "name": "Daryll Doyle", |
  |  | 211 | "email": "daryll@enshrined.co.uk" |
  |  | 212 | } |
  |  | 213 | ], |
  |  | 214 | "description": "An SVG sanitizer for PHP", |
  |  | 215 | "support": { |
  |  | 216 | "issues": "https://github.com/darylldoyle/svg-sanitizer/issues", |
  |  | 217 | "source": "https://github.com/darylldoyle/svg-sanitizer/tree/0.18.0" |
  |  | 218 | }, |
  |  | 219 | "install-path": "../enshrined/svg-sanitize" |
  | 167 | 220 | } |
  | 168 | 221 | ], |
* ## [menu-icons/tags/0.13.14/vendor/composer/installed.php](/changeset/3086753/menu-icons/tags/0.13.14/vendor/composer/installed.php "Show the changeset 3086753 restricted to menu-icons/tags/0.13.14/vendor/composer/installed.php")

  | [r3072875](/browser/menu-icons/trunk/vendor/composer/installed.php?rev=3072875#L2 "Show revision 3072875 of this file in browser") | [r3086753](/browser/menu-icons/tags/0.13.14/vendor/composer/installed.php?rev=3086753#L2 "Show revision 3086753 of this file in browser") |  |
  | --- | --- | --- |
  | 2 | 2 | 'root' => array( |
  | 3 | 3 | 'name' => 'codeinwp/wp-menu-icons', |
  | 4 |  | 'pretty\_version' => 'v0.13.1~~3~~', |
  | 5 |  | 'version' => '0.13.1~~3~~.0', |
  | 6 |  | 'reference' => '~~1d9b7a1bc87b0942bb633546596245b44c1dd15e~~', |
  |  | 4 | 'pretty\_version' => 'v0.13.14', |
  |  | 5 | 'version' => '0.13.14.0', |
  |  | 6 | 'reference' => 'a7c071a7be5a809a8379624381d823e2d9b20e50', |
  | 7 | 7 | 'type' => 'wordpress-plugin', |
  | 8 | 8 | 'install\_path' => \_\_DIR\_\_ . '/../../', |
  | […](/browser/menu-icons/trunk/vendor/composer/installed.php?rev=3072875#L23) | […](/browser/menu-icons/tags/0.13.14/vendor/composer/installed.php?rev=3086753#L23) |  |
  | 23 | 23 | 'pretty\_version' => 'dev-master', |
  | 24 | 24 | 'version' => 'dev-master', |
  | 25 |  | 'reference' => '~~0c60ce3a41653e41a20e710c4d5a6a2104c85020~~', |
  |  | 25 | 'reference' => '8efc2e400231ad7d4af94ff9270cd5b50248d4c9', |
  | 26 | 26 | 'type' => 'wordpress-plugin', |
  | 27 | 27 | 'install\_path' => \_\_DIR\_\_ . '/../codeinwp/icon-picker', |
  | 28 |  | 'aliases' => array(), |
  |  | 28 | 'aliases' => array( |
  |  | 29 | 0 => '9999999-dev', |
  |  | 30 | ), |
  | 29 | 31 | 'dev\_requirement' => false, |
  | 30 | 32 | ), |
  | […](/browser/menu-icons/trunk/vendor/composer/installed.php?rev=3072875#L48) | […](/browser/menu-icons/tags/0.13.14/vendor/composer/installed.php?rev=3086753#L50) |  |
  | 48 | 50 | ), |
  | 49 | 51 | 'codeinwp/wp-menu-icons' => array( |
  | 50 |  | 'pretty\_version' => 'v0.13.1~~3~~', |
  | 51 |  | 'version' => '0.13.1~~3~~.0', |
  | 52 |  | 'reference' => '~~1d9b7a1bc87b0942bb633546596245b44c1dd15e~~', |
  |  | 52 | 'pretty\_version' => 'v0.13.14', |
  |  | 53 | 'version' => '0.13.14.0', |
  |  | 54 | 'reference' => 'a7c071a7be5a809a8379624381d823e2d9b20e50', |
  | 53 | 55 | 'type' => 'wordpress-plugin', |
  | 54 | 56 | 'install\_path' => \_\_DIR\_\_ . '/../../', |
  | […](/browser/menu-icons/trunk/vendor/composer/installed.php?rev=3072875#L62) | […](/browser/menu-icons/tags/0.13.14/vendor/composer/installed.php?rev=3086753#L64) |  |
  | 62 | 64 | ), |
  | 63 | 65 | ), |
  |  | 66 | 'enshrined/svg-sanitize' => array( |
  |  | 67 | 'pretty\_version' => '0.18.0', |
  |  | 68 | 'version' => '0.18.0.0', |
  |  | 69 | 'reference' => '6a2c069dab3843ca4d887ff09c972fc7033888d0', |
  |  | 70 | 'type' => 'library', |
  |  | 71 | 'install\_path' => \_\_DIR\_\_ . '/../enshrined/svg-sanitize', |
  |  | 72 | 'aliases' => array(), |
  |  | 73 | 'dev\_requirement' => false, |
  |  | 74 | ), |
  | 64 | 75 | ), |
  | 65 | 76 | ); |
* ## [menu-icons/trunk/CHANGELOG.md](/changeset/3086753/menu-icons/trunk/CHANGELOG.md "Show the changeset 3086753 restricted to menu-icons/trunk/CHANGELOG.md")

  | [r3072875](/browser/menu-icons/trunk/CHANGELOG.md?rev=3072875#L1 "Show revision 3072875 of this file in browser") | [r3086753](/browser/menu-icons/trunk/CHANGELOG.md?rev=3086753#L1 "Show revision 3086753 of this file in browser") |  |
  | --- | --- | --- |
  |  | 1 | ##### [Version 0.13.14](https://github.com/codeinwp/wp-menu-icons/compare/v0.13.13...v0.13.14) (2024-05-14) |
  |  | 2 |  |
  |  | 3 | - Enhanced security |
  |  | 4 |  |
  | 1 | 5 | ##### [Version 0.13.13](https://github.com/codeinwp/wp-menu-icons/compare/v0.13.12...v0.13.13) (2024-04-18) |
  | 2 | 6 |  |
* ## [menu-icons/trunk/menu-icons.php](/changeset/3086753/menu-icons/trunk/menu-icons.php "Show the changeset 3086753 restricted to menu-icons/trunk/menu-icons.php")

  | [r3072875](/browser/menu-icons/trunk/menu-icons.php?rev=3072875#L12 "Show revision 3072875 of this file in browser") | [r3086753](/browser/menu-icons/trunk/menu-icons.php?rev=3086753#L12 "Show revision 3086753 of this file in browser") |  |
  | --- | --- | --- |
  | 12 | 12 | \* Plugin URI:  https://github.com/Codeinwp/wp-menu-icons |
  | 13 | 13 | \* Description: Spice up your navigation menus with pretty icons, easily. |
  | 14 |  | \* Version:     0.13.1~~3~~ |
  |  | 14 | \* Version:     0.13.14 |
  | 15 | 15 | \* Author:      ThemeIsle |
  | 16 | 16 | \* Author URI:  https://themeisle.com |
  | […](/browser/menu-icons/trunk/menu-icons.php?rev=3072875#L30) | […](/browser/menu-icons/trunk/menu-icons.php?rev=3086753#L30) |  |
  | 30 | 30 | const DISMISS\_NOTICE = 'menu-icons-dismiss-notice'; |
  | 31 | 31 |  |
  | 32 |  | const VERSION = '0.13.1~~3~~'; |
  |  | 32 | const VERSION = '0.13.14'; |
  | 33 | 33 |  |
  | 34 | 34 | /\*\* |
* ## [menu-icons/trunk/readme.txt](/changeset/3086753/menu-icons/trunk/readme.txt "Show the changeset 3086753 restricted to menu-icons/trunk/readme.txt")

  | [r3072875](/browser/menu-icons/trunk/readme.txt?rev=3072875#L226 "Show revision 3072875 of this file in browser") | [r3086753](/browser/menu-icons/trunk/readme.txt?rev=3086753#L226 "Show revision 3086753 of this file in browser") |  |
  | --- | --- | --- |
  | 226 | 226 | == Changelog == |
  | 227 | 227 |  |
  |  | 228 | ##### [Version 0.13.14](https://github.com/codeinwp/wp-menu-icons/compare/v0.13.13...v0.13.14) (2024-05-14) |
  |  | 229 |  |
  |  | 230 | - Enhanced security |
  |  | 231 |  |
  |  | 232 |  |
  |  | 233 |  |
  |  | 234 |  |
  | 228 | 235 | ##### [Version 0.13.13](https://github.com/codeinwp/wp-menu-icons/compare/v0.13.12...v0.13.13) (2024-04-18) |
  | 229 | 236 |  |
* ## [menu-icons/trunk/vendor/codeinwp/icon-picker/includes/types/svg.php](/changeset/3086753/menu-icons/trunk/vendor/codeinwp/icon-picker/includes/types/svg.php "Show the changeset 3086753 restricted to menu-icons/trunk/vendor/codeinwp/icon-picker/includes/types/svg.php")

  | [r1990980](/browser/menu-icons/trunk/vendor/codeinwp/icon-picker/includes/types/svg.php?rev=1990980#L7 "Show revision 1990980 of this file in browser") | [r3086753](/browser/menu-icons/trunk/vendor/codeinwp/icon-picker/includes/types/svg.php?rev=3086753#L7 "Show revision 3086753 of this file in browser") |  |
  | --- | --- | --- |
  | 7 | 7 | \*/ |
  | 8 | 8 |  |
  |  | 9 | use enshrined\svgSanitize\Sanitizer; |
  |  | 10 |  |
  | 9 | 11 | require\_once dirname( \_\_FILE\_\_ ) . '/image.php'; |
  | 10 | 12 |  |
  | […](/browser/menu-icons/trunk/vendor/codeinwp/icon-picker/includes/types/svg.php?rev=1990980#L54) | […](/browser/menu-icons/trunk/vendor/codeinwp/icon-picker/includes/types/svg.php?rev=3086753#L56) |  |
  | 54 | 56 | parent::\_\_construct( $args ); |
  | 55 | 57 | add\_filter( 'upload\_mimes', array( $this, '\_add\_mime\_type' ) ); |
  |  | 58 | add\_filter( 'wp\_handle\_upload\_prefilter', array( $this, '\_check\_svg\_and\_sanitize' ) ); |
  |  | 59 | } |
  |  | 60 |  |
  |  | 61 | /\*\* |
  |  | 62 | \* Sanitize the SVG |
  |  | 63 | \* |
  |  | 64 | \* @param string $file Temp file path. |
  |  | 65 | \* |
  |  | 66 | \* @return bool|int |
  |  | 67 | \*/ |
  |  | 68 | protected function sanitize\_svg( $file ) { |
  |  | 69 | // We can ignore the phpcs warning here as we're reading and writing to the Temp file. |
  |  | 70 | $dirty = file\_get\_contents( $file ); // phpcs:ignore |
  |  | 71 |  |
  |  | 72 | // Is the SVG gzipped? If so we try and decode the string. |
  |  | 73 | $is\_zipped = $this->is\_gzipped( $dirty ); |
  |  | 74 | if ( $is\_zipped && ( ! function\_exists( 'gzdecode' ) || ! function\_exists( 'gzencode' ) ) ) { |
  |  | 75 | return false; |
  |  | 76 | } |
  |  | 77 |  |
  |  | 78 | if ( $is\_zipped ) { |
  |  | 79 | $dirty = gzdecode( $dirty ); |
  |  | 80 |  |
  |  | 81 | // If decoding fails, bail as we're not secure. |
  |  | 82 | if ( false === $dirty ) { |
  |  | 83 | return false; |
  |  | 84 | } |
  |  | 85 | } |
  |  | 86 |  |
  |  | 87 | $sanitizer = new Sanitizer(); |
  |  | 88 | $clean     = $sanitizer->sanitize( $dirty ); |
  |  | 89 |  |
  |  | 90 | if ( false === $clean ) { |
  |  | 91 | return false; |
  |  | 92 | } |
  |  | 93 |  |
  |  | 94 | // If we were gzipped, we need to re-zip. |
  |  | 95 | if ( $is\_zipped ) { |
  |  | 96 | $clean = gzencode( $clean ); |
  |  | 97 | } |
  |  | 98 |  |
  |  | 99 | // We can ignore the phpcs warning here as we're reading and writing to the Temp file. |
  |  | 100 | file\_put\_contents( $file, $clean ); // phpcs:ignore |
  |  | 101 |  |
  |  | 102 | return true; |
  |  | 103 | } |
  |  | 104 |  |
  |  | 105 | /\*\* |
  |  | 106 | \* Check if the contents are gzipped |
  |  | 107 | \* |
  |  | 108 | \* @see http://www.gzip.org/zlib/rfc-gzip.html#member-format |
  |  | 109 | \* |
  |  | 110 | \* @param string $contents Content to check. |
  |  | 111 | \* |
  |  | 112 | \* @return bool |
  |  | 113 | \*/ |
  |  | 114 | protected function is\_gzipped( $contents ) { |
  |  | 115 | // phpcs:disable Generic.Strings.UnnecessaryStringConcat.Found |
  |  | 116 | if ( function\_exists( 'mb\_strpos' ) ) { |
  |  | 117 | return 0 === mb\_strpos( $contents, "\x1f" . "\x8b" . "\x08" ); |
  |  | 118 | } else { |
  |  | 119 | return 0 === strpos( $contents, "\x1f" . "\x8b" . "\x08" ); |
  |  | 120 | } |
  |  | 121 | // phpcs:enable |
  |  | 122 | } |
  |  | 123 |  |
  |  | 124 | /\*\* |
  |  | 125 | \* Check if the file is an SVG, if so handle appropriately and sanitize. |
  |  | 126 | \* |
  |  | 127 | \* @param array $file An array of data for a single file. |
  |  | 128 | \* |
  |  | 129 | \* @return void |
  |  | 130 | \*/ |
  |  | 131 | public function \_check\_svg\_and\_sanitize( $file ) { |
  |  | 132 | // Ensure we have a proper file path before processing. |
  |  | 133 | if ( ! isset( $file['tmp\_name'] ) ) { |
  |  | 134 | return $file; |
  |  | 135 | } |
  |  | 136 |  |
  |  | 137 | $file\_name   = isset( $file['name'] ) ? $file['name'] : ''; |
  |  | 138 | $wp\_filetype = wp\_check\_filetype\_and\_ext( $file['tmp\_name'], $file\_name ); |
  |  | 139 | $type        = ! empty( $wp\_filetype['type'] ) ? $wp\_filetype['type'] : ''; |
  |  | 140 |  |
  |  | 141 | if ( 'image/svg+xml' === $type ) { |
  |  | 142 | if ( ! current\_user\_can( 'upload\_files' ) ) { |
  |  | 143 | $file['error'] = \_\_( |
  |  | 144 | 'Sorry, you are not allowed to upload files.', |
  |  | 145 | 'icon-picker' |
  |  | 146 | ); |
  |  | 147 |  |
  |  | 148 | return $file; |
  |  | 149 | } |
  |  | 150 |  |
  |  | 151 | if ( ! $this->sanitize\_svg( $file['tmp\_name'] ) ) { |
  |  | 152 | $file['error'] = \_\_( |
  |  | 153 | "Sorry, this file couldn't be sanitized so for security reasons wasn't uploaded", |
  |  | 154 | 'icon-picker' |
  |  | 155 | ); |
  |  | 156 | } |
  |  | 157 | } |
  |  | 158 |  |
  |  | 159 | return $file; |
  | 56 | 160 | } |
  | 57 | 161 |  |
* ## [menu-icons/trunk/vendor/composer/autoload\_classmap.php](/changeset/3086753/menu-icons/trunk/vendor/composer/autoload_classmap.php "Show the changeset 3086753 restricted to menu-icons/trunk/vendor/composer/autoload_classmap.php")

  | [r2732729](/browser/menu-icons/trunk/vendor/composer/autoload_classmap.php?rev=2732729#L8 "Show revision 2732729 of this file in browser") | [r3086753](/browser/menu-icons/trunk/vendor/composer/autoload_classmap.php?rev=3086753#L8 "Show revision 3086753 of this file in browser") |  |
  | --- | --- | --- |
  | 8 | 8 | return array( |
  | 9 | 9 | 'Composer\\InstalledVersions' => $vendorDir . '/composer/InstalledVersions.php', |
  |  | 10 | 'enshrined\\svgSanitize\\ElementReference\\Resolver' => $vendorDir . '/enshrined/svg-sanitize/src/ElementReference/Resolver.php', |
  |  | 11 | 'enshrined\\svgSanitize\\ElementReference\\Subject' => $vendorDir . '/enshrined/svg-sanitize/src/ElementReference/Subject.php', |
  |  | 12 | 'enshrined\\svgSanitize\\ElementReference\\Usage' => $vendorDir . '/enshrined/svg-sanitize/src/ElementReference/Usage.php', |
  |  | 13 | 'enshrined\\svgSanitize\\Exceptions\\NestingException' => $vendorDir . '/enshrined/svg-sanitize/src/Exceptions/NestingException.php', |
  |  | 14 | 'enshrined\\svgSanitize\\Helper' => $vendorDir . '/enshrined/svg-sanitize/src/Helper.php', |
  |  | 15 | 'enshrined\\svgSanitize\\Sanitizer' => $vendorDir . '/enshrined/svg-sanitize/src/Sanitizer.php', |
  |  | 16 | 'enshrined\\svgSanitize\\data\\AllowedAttributes' => $vendorDir . '/enshrined/svg-sanitize/src/data/AllowedAttributes.php', |
  |  | 17 | 'enshrined\\svgSanitize\\data\\AllowedTags' => $vendorDir . '/enshrined/svg-sanitize/src/data/AllowedTags.php', |
  |  | 18 | 'enshrined\\svgSanitize\\data\\AttributeInterface' => $vendorDir . '/enshrined/svg-sanitize/src/data/AttributeInterface.php', |
  |  | 19 | 'enshrined\\svgSanitize\\data\\TagInterface' => $vendorDir . '/enshrined/svg-sanitize/src/data/TagInterface.php', |
  |  | 20 | 'enshrined\\svgSanitize\\data\\XPath' => $vendorDir . '/enshrined/svg-sanitize/src/data/XPath.php', |
  | 10 | 21 | ); |
* ## [menu-icons/trunk/vendor/composer/autoload\_psr4.php](/changeset/3086753/menu-icons/trunk/vendor/composer/autoload_psr4.php "Show the changeset 3086753 restricted to menu-icons/trunk/vendor/composer/autoload_psr4.php")

  | [r2732729](/browser/menu-icons/trunk/vendor/composer/autoload_psr4.php?rev=2732729#L7 "Show revision 2732729 of this file in browser") | [r3086753](/browser/menu-icons/trunk/vendor/composer/autoload_psr4.php?rev=3086753#L7 "Show revision 3086753 of this file in browser") |  |
  | --- | --- | --- |
  | 7 | 7 |  |
  | 8 | 8 | return array( |
  |  | 9 | 'enshrined\\svgSanitize\\' => array($vendorDir . '/enshrined/svg-sanitize/src'), |
  | 9 | 10 | ); |
* ## [menu-icons/trunk/vendor/composer/autoload\_real.php](/changeset/3086753/menu-icons/trunk/vendor/composer/autoload_real.php "Show the changeset 3086753 restricted to menu-icons/trunk/vendor/composer/autoload_real.php")

  | [r3012213](/browser/menu-icons/trunk/vendor/composer/autoload_real.php?rev=3012213#L22 "Show revision 3012213 of this file in browser") | [r3086753](/browser/menu-icons/trunk/vendor/composer/autoload_real.php?rev=3086753#L22 "Show revision 3086753 of this file in browser") |  |
  | --- | --- | --- |
  | 22 | 22 | return self::$loader; |
  | 23 | 23 | } |
  |  | 24 |  |
  |  | 25 | require \_\_DIR\_\_ . '/platform\_check.php'; |
  | 24 | 26 |  |
  | 25 | 27 | spl\_autoload\_register(array('ComposerAutoloaderInite0e064cdd82a4be104872380c8a68791', 'loadClassLoader'), true, true); |
* ## [menu-icons/trunk/vendor/composer/autoload\_static.php](/changeset/3086753/menu-icons/trunk/vendor/composer/autoload_static.php "Show the changeset 3086753 restricted to menu-icons/trunk/vendor/composer/autoload_static.php")

  | [r3012213](/browser/menu-icons/trunk/vendor/composer/autoload_static.php?rev=3012213#L14 "Show revision 3012213 of this file in browser") | [r3086753](/browser/menu-icons/trunk/vendor/composer/autoload_static.php?rev=3086753#L14 "Show revision 3086753 of this file in browser") |  |
  | --- | --- | --- |
  | 14 | 14 | ); |
  | 15 | 15 |  |
  |  | 16 | public static $prefixLengthsPsr4 = array ( |
  |  | 17 | 'e' => |
  |  | 18 | array ( |
  |  | 19 | 'enshrined\\svgSanitize\\' => 22, |
  |  | 20 | ), |
  |  | 21 | ); |
  |  | 22 |  |
  |  | 23 | public static $prefixDirsPsr4 = array ( |
  |  | 24 | 'enshrined\\svgSanitize\\' => |
  |  | 25 | array ( |
  |  | 26 | 0 => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src', |
  |  | 27 | ), |
  |  | 28 | ); |
  |  | 29 |  |
  | 16 | 30 | public static $classMap = array ( |
  | 17 | 31 | 'Composer\\InstalledVersions' => \_\_DIR\_\_ . '/..' . '/composer/InstalledVersions.php', |
  |  | 32 | 'enshrined\\svgSanitize\\ElementReference\\Resolver' => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src/ElementReference/Resolver.php', |
  |  | 33 | 'enshrined\\svgSanitize\\ElementReference\\Subject' => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src/ElementReference/Subject.php', |
  |  | 34 | 'enshrined\\svgSanitize\\ElementReference\\Usage' => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src/ElementReference/Usage.php', |
  |  | 35 | 'enshrined\\svgSanitize\\Exceptions\\NestingException' => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src/Exceptions/NestingException.php', |
  |  | 36 | 'enshrined\\svgSanitize\\Helper' => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src/Helper.php', |
  |  | 37 | 'enshrined\\svgSanitize\\Sanitizer' => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src/Sanitizer.php', |
  |  | 38 | 'enshrined\\svgSanitize\\data\\AllowedAttributes' => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src/data/AllowedAttributes.php', |
  |  | 39 | 'enshrined\\svgSanitize\\data\\AllowedTags' => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src/data/AllowedTags.php', |
  |  | 40 | 'enshrined\\svgSanitize\\data\\AttributeInterface' => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src/data/AttributeInterface.php', |
  |  | 41 | 'enshrined\\svgSanitize\\data\\TagInterface' => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src/data/TagInterface.php', |
  |  | 42 | 'enshrined\\svgSanitize\\data\\XPath' => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src/data/XPath.php', |
  | 18 | 43 | ); |
  | 19 | 44 |  |
  | […](/browser/menu-icons/trunk/vendor/composer/autoload_static.php?rev=3012213#L21) | […](/browser/menu-icons/trunk/vendor/composer/autoload_static.php?rev=3086753#L46) |  |
  | 21 | 46 | { |
  | 22 | 47 | return \Closure::bind(function () use ($loader) { |
  |  | 48 | $loader->prefixLengthsPsr4 = ComposerStaticInite0e064cdd82a4be104872380c8a68791::$prefixLengthsPsr4; |
  |  | 49 | $loader->prefixDirsPsr4 = ComposerStaticInite0e064cdd82a4be104872380c8a68791::$prefixDirsPsr4; |
  | 23 | 50 | $loader->classMap = ComposerStaticInite0e064cdd82a4be104872380c8a68791::$classMap; |
  | 24 | 51 |  |
* ## [menu-icons/trunk/vendor/composer/installed.json](/changeset/3086753/menu-icons/trunk/vendor/composer/installed.json "Show the changeset 3086753 restricted to menu-icons/trunk/vendor/composer/installed.json")

  | [r3072875](/browser/menu-icons/trunk/vendor/composer/installed.json?rev=3072875#L54 "Show revision 3072875 of this file in browser") | [r3086753](/browser/menu-icons/trunk/vendor/composer/installed.json?rev=3086753#L54 "Show revision 3086753 of this file in browser") |  |
  | --- | --- | --- |
  | 54 | 54 | "type": "git", |
  | 55 | 55 | "url": "https://github.com/Codeinwp/icon-picker.git", |
  | 56 |  | "reference": "~~0c60ce3a41653e41a20e710c4d5a6a2104c85020~~" |
  | 57 |  | }, |
  | 58 |  | "dist": { |
  | 59 |  | "type": "zip", |
  | 60 |  | "url": "https://api.github.com/repos/Codeinwp/icon-picker/zipball/~~0c60ce3a41653e41a20e710c4d5a6a2104c85020~~", |
  | 61 |  | "reference": "~~0c60ce3a41653e41a20e710c4d5a6a2104c85020~~", |
  |  | 56 | "reference": "8efc2e400231ad7d4af94ff9270cd5b50248d4c9" |
  |  | 57 | }, |
  |  | 58 | "dist": { |
  |  | 59 | "type": "zip", |
  |  | 60 | "url": "https://api.github.com/repos/Codeinwp/icon-picker/zipball/8efc2e400231ad7d4af94ff9270cd5b50248d4c9", |
  |  | 61 | "reference": "8efc2e400231ad7d4af94ff9270cd5b50248d4c9", |
  | 62 | 62 | "shasum": "" |
  | 63 | 63 | }, |
  | 64 | 64 | "require": { |
  | 65 |  | "composer/installers": "~1.0" |
  |  | 65 | "composer/installers": "~1.0", |
  |  | 66 | "enshrined/svg-sanitize": "^0.18.0" |
  | 66 | 67 | }, |
  | 67 | 68 | "require-dev": { |
  | 68 | 69 | "wp-coding-standards/wpcs": "^0.10.0" |
  | 69 | 70 | }, |
  | 70 |  | "time": "2021-05-05T18:52:26+00:00", |
  |  | 71 | "time": "2024-05-13T08:27:15+00:00", |
  |  | 72 | "default-branch": true, |
  | 71 | 73 | "type": "wordpress-plugin", |
  | 72 | 74 | "installation-source": "dist", |
  | […](/browser/menu-icons/trunk/vendor/composer/installed.json?rev=3072875#L87) | […](/browser/menu-icons/trunk/vendor/composer/installed.json?rev=3086753#L89) |  |
  | 87 | 89 | "wordpress" |
  | 88 | 90 | ], |
  |  | 91 | "support": { |
  |  | 92 | "source": "https://github.com/Codeinwp/icon-picker/tree/master" |
  |  | 93 | }, |
  | 89 | 94 | "install-path": "../codeinwp/icon-picker" |
  | 90 | 95 | }, |
  | […](/browser/menu-icons/trunk/vendor/composer/installed.json?rev=3072875#L165) | […](/browser/menu-icons/trunk/vendor/composer/installed.json?rev=3086753#L170) |  |
  | 165 | 170 | ], |
  | 166 | 171 | "install-path": "../codeinwp/themeisle-sdk" |
  |  | 172 | }, |
  |  | 173 | { |
  |  | 174 | "name": "enshrined/svg-sanitize", |
  |  | 175 | "version": "0.18.0", |
  |  | 176 | "version\_normalized": "0.18.0.0", |
  |  | 177 | "source": { |
  |  | 178 | "type": "git", |
  |  | 179 | "url": "https://github.com/darylldoyle/svg-sanitizer.git", |
  |  | 180 | "reference": "6a2c069dab3843ca4d887ff09c972fc7033888d0" |
  |  | 181 | }, |
  |  | 182 | "dist": { |
  |  | 183 | "type": "zip", |
  |  | 184 | "url": "https://api.github.com/repos/darylldoyle/svg-sanitizer/zipball/6a2c069dab3843ca4d887ff09c972fc7033888d0", |
  |  | 185 | "reference": "6a2c069dab3843ca4d887ff09c972fc7033888d0", |
  |  | 186 | "shasum": "" |
  |  | 187 | }, |
  |  | 188 | "require": { |
  |  | 189 | "ext-dom": "\*", |
  |  | 190 | "ext-libxml": "\*", |
  |  | 191 | "php": "^5.6 || ^7.0 || ^8.0" |
  |  | 192 | }, |
  |  | 193 | "require-dev": { |
  |  | 194 | "phpunit/phpunit": "^5.7 || ^6.5 || ^8.5" |
  |  | 195 | }, |
  |  | 196 | "time": "2024-02-22T17:51:05+00:00", |
  |  | 197 | "type": "library", |
  |  | 198 | "installation-source": "dist", |
  |  | 199 | "autoload": { |
  |  | 200 | "psr-4": { |
  |  | 201 | "enshrined\\svgSanitize\\": "src" |
  |  | 202 | } |
  |  | 203 | }, |
  |  | 204 | "notification-url": "https://packagist.org/downloads/", |
  |  | 205 | "license": [ |
  |  | 206 | "GPL-2.0-or-later" |
  |  | 207 | ], |
  |  | 208 | "authors": [ |
  |  | 209 | { |
  |  | 210 | "name": "Daryll Doyle", |
  |  | 211 | "email": "daryll@enshrined.co.uk" |
  |  | 212 | } |
  |  | 213 | ], |
  |  | 214 | "description": "An SVG sanitizer for PHP", |
  |  | 215 | "support": { |
  |  | 216 | "issues": "https://github.com/darylldoyle/svg-sanitizer/issues", |
  |  | 217 | "source": "https://github.com/darylldoyle/svg-sanitizer/tree/0.18.0" |
  |  | 218 | }, |
  |  | 219 | "install-path": "../enshrined/svg-sanitize" |
  | 167 | 220 | } |
  | 168 | 221 | ], |
* ## [menu-icons/trunk/vendor/composer/installed.php](/changeset/3086753/menu-icons/trunk/vendor/composer/installed.php "Show the changeset 3086753 restricted to menu-icons/trunk/vendor/composer/installed.php")

  | [r3072875](/browser/menu-icons/trunk/vendor/composer/installed.php?rev=3072875#L2 "Show revision 3072875 of this file in browser") | [r3086753](/browser/menu-icons/trunk/vendor/composer/installed.php?rev=3086753#L2 "Show revision 3086753 of this file in browser") |  |
  | --- | --- | --- |
  | 2 | 2 | 'root' => array( |
  | 3 | 3 | 'name' => 'codeinwp/wp-menu-icons', |
  | 4 |  | 'pretty\_version' => 'v0.13.1~~3~~', |
  | 5 |  | 'version' => '0.13.1~~3~~.0', |
  | 6 |  | 'reference' => '~~1d9b7a1bc87b0942bb633546596245b44c1dd15e~~', |
  |  | 4 | 'pretty\_version' => 'v0.13.14', |
  |  | 5 | 'version' => '0.13.14.0', |
  |  | 6 | 'reference' => 'a7c071a7be5a809a8379624381d823e2d9b20e50', |
  | 7 | 7 | 'type' => 'wordpress-plugin', |
  | 8 | 8 | 'install\_path' => \_\_DIR\_\_ . '/../../', |
  | […](/browser/menu-icons/trunk/vendor/composer/installed.php?rev=3072875#L23) | […](/browser/menu-icons/trunk/vendor/composer/installed.php?rev=3086753#L23) |  |
  | 23 | 23 | 'pretty\_version' => 'dev-master', |
  | 24 | 24 | 'version' => 'dev-master', |
  | 25 |  | 'reference' => '~~0c60ce3a41653e41a20e710c4d5a6a2104c85020~~', |
  |  | 25 | 'reference' => '8efc2e400231ad7d4af94ff9270cd5b50248d4c9', |
  | 26 | 26 | 'type' => 'wordpress-plugin', |
  | 27 | 27 | 'install\_path' => \_\_DIR\_\_ . '/../codeinwp/icon-picker', |
  | 28 |  | 'aliases' => array(), |
  |  | 28 | 'aliases' => array( |
  |  | 29 | 0 => '9999999-dev', |
  |  | 30 | ), |
  | 29 | 31 | 'dev\_requirement' => false, |
  | 30 | 32 | ), |
  | […](/browser/menu-icons/trunk/vendor/composer/installed.php?rev=3072875#L48) | […](/browser/menu-icons/trunk/vendor/composer/installed.php?rev=3086753#L50) |  |
  | 48 | 50 | ), |
  | 49 | 51 | 'codeinwp/wp-menu-icons' => array( |
  | 50 |  | 'pretty\_version' => 'v0.13.1~~3~~', |
  | 51 |  | 'version' => '0.13.1~~3~~.0', |
  | 52 |  | 'reference' => '~~1d9b7a1bc87b0942bb633546596245b44c1dd15e~~', |
  |  | 52 | 'pretty\_version' => 'v0.13.14', |
  |  | 53 | 'version' => '0.13.14.0', |
  |  | 54 | 'reference' => 'a7c071a7be5a809a8379624381d823e2d9b20e50', |
  | 53 | 55 | 'type' => 'wordpress-plugin', |
  | 54 | 56 | 'install\_path' => \_\_DIR\_\_ . '/../../', |
  | […](/browser/menu-icons/trunk/vendor/composer/installed.php?rev=3072875#L62) | […](/browser/menu-icons/trunk/vendor/composer/installed.php?rev=3086753#L64) |  |
  | 62 | 64 | ), |
  | 63 | 65 | ), |
  |  | 66 | 'enshrined/svg-sanitize' => array( |
  |  | 67 | 'pretty\_version' => '0.18.0', |
  |  | 68 | 'version' => '0.18.0.0', |
  |  | 69 | 'reference' => '6a2c069dab3843ca4d887ff09c972fc7033888d0', |
  |  | 70 | 'type' => 'library', |
  |  | 71 | 'install\_path' => \_\_DIR\_\_ . '/../enshrined/svg-sanitize', |
  |  | 72 | 'aliases' => array(), |
  |  | 73 | 'dev\_requirement' => false, |
  |  | 74 | ), |
  | 64 | 75 | ), |
  | 65 | 76 | ); |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3086753)
* [Zip Archive](?format=zip&new=3086753)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


