
Commit Information:
------------------
Author: Hai Shalom  1677798056 +0000
Date: Android Build Coastguard Worker  1680741525 +0000
Bug ID: Bug: 267633332 Bug: 251910611 Bug: 250574778
Commit Message:
--------------
[TOFU] Implement a secure TOFU flowImplement a secure TOFU flow for supporting devices, andnotifications about insecure connections in non-supportingdevices, when insecure configurations are not allowed.Handle the case where insecure enterprise configurations areallowed in the new and secure TOFU flow. In this mode, do notdisconnect the network, do not load certificates, and do notnotify the user about anything.Display the correct certificate information in the dialog,remove the email and 8-octet signature from the TOFU dialog, andreplace with user verifiable information: certificate expirationdate (locale adjusted) and a SHA-256 fingerprint of the servercertificate which is locally generated.Network admins can calculate the fingerprint of their servercertificate and publish the result to their users, using:openssl x509 -in server-cert.pem -noout -fingerprint -sha256Updated-Overlayable: TRUEUpdated-PDD: TRUEBug: 267633332Bug: 251910611Bug: 250574778Test: atest ClientModeImplTest InsecureEapNetworkHandlerTestTest: atest WifiConfigManagerTestTest: Integration test on R, and T devices with overlay settingof insecure networks allowed and not allowed, and with newconfigs and insecure (Do not validate) configs made with R.Test: Functional test, UI verification with multiple locales(cherry picked from https://googleplex-android-review.googlesource.com/q/commit:a5227527411bc24e6e2c6276f16559c7305b6783)Merged-In: I5cac12cd8c52a8a9425e98dad0fb90893f53e374Change-Id: I5cac12cd8c52a8a9425e98dad0fb90893f53e374
