<!DOCTYPE html>
<html lang='en'>
<head>
<title>bpf: Replace ARG_XXX_OR_NULL with ARG_XXX | PTR_MAYBE_NULL - kernel/git/torvalds/linux.git - Linux kernel source tree</title>
<meta name='generator' content='cgit 1.2.3-korg'/>
<meta name='robots' content='noindex, nofollow'/>
<link rel='stylesheet' type='text/css' href='/cgit-data/cgit.css'/>
<script type='text/javascript' src='/cgit-data/cgit.js'></script>
<link rel='shortcut icon' href='/favicon.ico'/>
<link rel='alternate' title='Atom feed' href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/atom/?h=master' type='application/atom+xml'/>
<link rel='vcs-git' href='git://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git' title='kernel/git/torvalds/linux.git Git repository'/>
<link rel='vcs-git' href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git' title='kernel/git/torvalds/linux.git Git repository'/>
<link rel='vcs-git' href='https://kernel.googlesource.com/pub/scm/linux/kernel/git/torvalds/linux.git' title='kernel/git/torvalds/linux.git Git repository'/>
</head>
<body>
<div id='cgit'><table id='header'>
<tr>
<td class='logo' rowspan='2'><a href='/'><img src='/cgit-data/cgit.png' alt='cgit logo'/></a></td>
<td class='main'><a href='/'>index</a> : <a href='/pub/scm/linux/kernel/git/torvalds/linux.git/'>kernel/git/torvalds/linux.git</a></td><td class='form'><form method='get'>
<input type='hidden' name='id' value='48946bd6a5d695c50b34546864b79c1f910a33c1'/><select name='h' onchange='this.form.submit();'>
<option value='for-next'>for-next</option>
<option value='master' selected='selected'>master</option>
<option value='vsnprintf'>vsnprintf</option>
</select> <input type='submit' value='switch'/></form></td></tr>
<tr><td class='sub'>Linux kernel source tree</td><td class='sub right'>Linus Torvalds</td></tr></table>
<table class='tabs'><tr><td>
<a href='/pub/scm/linux/kernel/git/torvalds/linux.git/about/'>about</a><a href='/pub/scm/linux/kernel/git/torvalds/linux.git/'>summary</a><a href='/pub/scm/linux/kernel/git/torvalds/linux.git/refs/?id=48946bd6a5d695c50b34546864b79c1f910a33c1'>refs</a><a href='/pub/scm/linux/kernel/git/torvalds/linux.git/log/'>log</a><a href='/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=48946bd6a5d695c50b34546864b79c1f910a33c1'>tree</a><a class='active' href='/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=48946bd6a5d695c50b34546864b79c1f910a33c1'>commit</a><a href='/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=48946bd6a5d695c50b34546864b79c1f910a33c1'>diff</a><a href='/pub/scm/linux/kernel/git/torvalds/linux.git/stats/'>stats</a></td><td class='form'><form class='right' method='get' action='/pub/scm/linux/kernel/git/torvalds/linux.git/log/'>
<input type='hidden' name='id' value='48946bd6a5d695c50b34546864b79c1f910a33c1'/><select name='qt'>
<option value='grep'>log msg</option>
<option value='author'>author</option>
<option value='committer'>committer</option>
<option value='range'>range</option>
</select>
<input class='txt' type='search' size='10' name='q' value=''/>
<input type='submit' value='search'/>
</form>
</td></tr></table>
<div class='content'><div class='cgit-panel'><b>diff options</b><form method='get'><input type='hidden' name='id' value='48946bd6a5d695c50b34546864b79c1f910a33c1'/><table><tr><td colspan='2'/></tr><tr><td class='label'>context:</td><td class='ctrl'><select name='context' onchange='this.form.submit();'><option value='1'>1</option><option value='2'>2</option><option value='3' selected='selected'>3</option><option value='4'>4</option><option value='5'>5</option><option value='6'>6</option><option value='7'>7</option><option value='8'>8</option><option value='9'>9</option><option value='10'>10</option><option value='15'>15</option><option value='20'>20</option><option value='25'>25</option><option value='30'>30</option><option value='35'>35</option><option value='40'>40</option></select></td></tr><tr><td class='label'>space:</td><td class='ctrl'><select name='ignorews' onchange='this.form.submit();'><option value='0' selected='selected'>include</option><option value='1'>ignore</option></select></td></tr><tr><td class='label'>mode:</td><td class='ctrl'><select name='dt' onchange='this.form.submit();'><option value='0' selected='selected'>unified</option><option value='1'>ssdiff</option><option value='2'>stat only</option></select></td></tr><tr><td/><td class='ctrl'><noscript><input type='submit' value='reload'/></noscript></td></tr></table></form></div><table summary='commit info' class='commit-info'>
<tr><th>author</th><td>Hao Luo &lt;haoluo@google.com&gt;</td><td class='right'>2021-12-16 16:31:45 -0800</td></tr>
<tr><th>committer</th><td>Alexei Starovoitov &lt;ast@kernel.org&gt;</td><td class='right'>2021-12-18 12:47:24 -0800</td></tr>
<tr><th>commit</th><td colspan='2' class='oid'><a href='/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=48946bd6a5d695c50b34546864b79c1f910a33c1'>48946bd6a5d695c50b34546864b79c1f910a33c1</a> (<a href='/pub/scm/linux/kernel/git/torvalds/linux.git/patch/?id=48946bd6a5d695c50b34546864b79c1f910a33c1'>patch</a>)</td></tr>
<tr><th>tree</th><td colspan='2' class='oid'><a href='/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=48946bd6a5d695c50b34546864b79c1f910a33c1'>d3862adb9cf035077ed58618c807cd930e2d70d8</a></td></tr>
<tr><th>parent</th><td colspan='2' class='oid'><a href='/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=d639b9d13a39cf15639cbe6e8b2c43eb60148a73'>d639b9d13a39cf15639cbe6e8b2c43eb60148a73</a> (<a href='/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=48946bd6a5d695c50b34546864b79c1f910a33c1&amp;id2=d639b9d13a39cf15639cbe6e8b2c43eb60148a73'>diff</a>)</td></tr><tr><th>download</th><td colspan='2' class='oid'><a href='/pub/scm/linux/kernel/git/torvalds/linux.git/snapshot/linux-48946bd6a5d695c50b34546864b79c1f910a33c1.tar.gz'>linux-48946bd6a5d695c50b34546864b79c1f910a33c1.tar.gz</a><br/></td></tr></table>
<div class='commit-subject'>bpf: Replace ARG_XXX_OR_NULL with ARG_XXX | PTR_MAYBE_NULL</div><div class='commit-msg'>We have introduced a new type to make bpf_arg composable, by
reserving high bits of bpf_arg to represent flags of a type.

One of the flags is PTR_MAYBE_NULL which indicates a pointer
may be NULL. When applying this flag to an arg_type, it means
the arg can take NULL pointer. This patch switches the
qualified arg_types to use this flag. The arg_types changed
in this patch include:

1. ARG_PTR_TO_MAP_VALUE_OR_NULL
2. ARG_PTR_TO_MEM_OR_NULL
3. ARG_PTR_TO_CTX_OR_NULL
4. ARG_PTR_TO_SOCKET_OR_NULL
5. ARG_PTR_TO_ALLOC_MEM_OR_NULL
6. ARG_PTR_TO_STACK_OR_NULL

This patch does not eliminate the use of these arg_types, instead
it makes them an alias to the 'ARG_XXX | PTR_MAYBE_NULL'.

Signed-off-by: Hao Luo &lt;haoluo@google.com&gt;
Signed-off-by: Alexei Starovoitov &lt;ast@kernel.org&gt;
Link: <a href="https://lore.kernel.org/bpf/20211217003152.48334-3-haoluo@google.com">https://lore.kernel.org/bpf/20211217003152.48334-3-haoluo@google.com</a>
</div><div class='diffstat-header'><a href='/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=48946bd6a5d695c50b34546864b79c1f910a33c1'>Diffstat</a></div><table summary='diffstat' class='diffstat'><tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/pub/scm/linux/kernel/git/torvalds/linux.git/diff/include/linux/bpf.h?id=48946bd6a5d695c50b34546864b79c1f910a33c1'>include/linux/bpf.h</a></td><td class='right'>15</td><td class='graph'><table summary='file diffstat' width='39%'><tr><td class='add' style='width: 23.1%;'/><td class='rem' style='width: 15.4%;'/><td class='none' style='width: 61.5%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/pub/scm/linux/kernel/git/torvalds/linux.git/diff/kernel/bpf/verifier.c?id=48946bd6a5d695c50b34546864b79c1f910a33c1'>kernel/bpf/verifier.c</a></td><td class='right'>39</td><td class='graph'><table summary='file diffstat' width='39%'><tr><td class='add' style='width: 35.9%;'/><td class='rem' style='width: 64.1%;'/><td class='none' style='width: 0.0%;'/></tr></table></td></tr>
</table><div class='diffstat-summary'>2 files changed, 23 insertions, 31 deletions</div><table summary='diff' class='diff'><tr><td><div class='head'>diff --git a/include/linux/bpf.h b/include/linux/bpf.h<br/>index 41bb3687cc8524..765bd7cc427251 100644<br/>--- a/<a href='/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/linux/bpf.h?id=d639b9d13a39cf15639cbe6e8b2c43eb60148a73'>include/linux/bpf.h</a><br/>+++ b/<a href='/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/linux/bpf.h?id=48946bd6a5d695c50b34546864b79c1f910a33c1'>include/linux/bpf.h</a></div><div class='hunk'>@@ -331,13 +331,11 @@ enum bpf_arg_type {</div><div class='ctx'> 	ARG_PTR_TO_MAP_KEY,	/* pointer to stack used as map key */</div><div class='ctx'> 	ARG_PTR_TO_MAP_VALUE,	/* pointer to stack used as map value */</div><div class='ctx'> 	ARG_PTR_TO_UNINIT_MAP_VALUE,	/* pointer to valid memory used to store a map value */</div><div class='del'>-	ARG_PTR_TO_MAP_VALUE_OR_NULL,	/* pointer to stack used as map value or NULL */</div><div class='ctx'> </div><div class='ctx'> 	/* the following constraints used to prototype bpf_memcmp() and other</div><div class='ctx'> 	 * functions that access data on eBPF program stack</div><div class='ctx'> 	 */</div><div class='ctx'> 	ARG_PTR_TO_MEM,		/* pointer to valid memory (stack, packet, map value) */</div><div class='del'>-	ARG_PTR_TO_MEM_OR_NULL, /* pointer to valid memory or NULL */</div><div class='ctx'> 	ARG_PTR_TO_UNINIT_MEM,	/* pointer to memory does not need to be initialized,</div><div class='ctx'> 				 * helper function must fill all bytes or clear</div><div class='ctx'> 				 * them in error case.</div><div class='hunk'>@@ -347,26 +345,31 @@ enum bpf_arg_type {</div><div class='ctx'> 	ARG_CONST_SIZE_OR_ZERO,	/* number of bytes accessed from memory or 0 */</div><div class='ctx'> </div><div class='ctx'> 	ARG_PTR_TO_CTX,		/* pointer to context */</div><div class='del'>-	ARG_PTR_TO_CTX_OR_NULL,	/* pointer to context or NULL */</div><div class='ctx'> 	ARG_ANYTHING,		/* any (initialized) argument is ok */</div><div class='ctx'> 	ARG_PTR_TO_SPIN_LOCK,	/* pointer to bpf_spin_lock */</div><div class='ctx'> 	ARG_PTR_TO_SOCK_COMMON,	/* pointer to sock_common */</div><div class='ctx'> 	ARG_PTR_TO_INT,		/* pointer to int */</div><div class='ctx'> 	ARG_PTR_TO_LONG,	/* pointer to long */</div><div class='ctx'> 	ARG_PTR_TO_SOCKET,	/* pointer to bpf_sock (fullsock) */</div><div class='del'>-	ARG_PTR_TO_SOCKET_OR_NULL,	/* pointer to bpf_sock (fullsock) or NULL */</div><div class='ctx'> 	ARG_PTR_TO_BTF_ID,	/* pointer to in-kernel struct */</div><div class='ctx'> 	ARG_PTR_TO_ALLOC_MEM,	/* pointer to dynamically allocated memory */</div><div class='del'>-	ARG_PTR_TO_ALLOC_MEM_OR_NULL,	/* pointer to dynamically allocated memory or NULL */</div><div class='ctx'> 	ARG_CONST_ALLOC_SIZE_OR_ZERO,	/* number of allocated bytes requested */</div><div class='ctx'> 	ARG_PTR_TO_BTF_ID_SOCK_COMMON,	/* pointer to in-kernel sock_common or bpf-mirrored bpf_sock */</div><div class='ctx'> 	ARG_PTR_TO_PERCPU_BTF_ID,	/* pointer to in-kernel percpu type */</div><div class='ctx'> 	ARG_PTR_TO_FUNC,	/* pointer to a bpf program function */</div><div class='del'>-	ARG_PTR_TO_STACK_OR_NULL,	/* pointer to stack or NULL */</div><div class='add'>+	ARG_PTR_TO_STACK,	/* pointer to stack */</div><div class='ctx'> 	ARG_PTR_TO_CONST_STR,	/* pointer to a null terminated read-only string */</div><div class='ctx'> 	ARG_PTR_TO_TIMER,	/* pointer to bpf_timer */</div><div class='ctx'> 	__BPF_ARG_TYPE_MAX,</div><div class='ctx'> </div><div class='add'>+	/* Extended arg_types. */</div><div class='add'>+	ARG_PTR_TO_MAP_VALUE_OR_NULL	= PTR_MAYBE_NULL | ARG_PTR_TO_MAP_VALUE,</div><div class='add'>+	ARG_PTR_TO_MEM_OR_NULL		= PTR_MAYBE_NULL | ARG_PTR_TO_MEM,</div><div class='add'>+	ARG_PTR_TO_CTX_OR_NULL		= PTR_MAYBE_NULL | ARG_PTR_TO_CTX,</div><div class='add'>+	ARG_PTR_TO_SOCKET_OR_NULL	= PTR_MAYBE_NULL | ARG_PTR_TO_SOCKET,</div><div class='add'>+	ARG_PTR_TO_ALLOC_MEM_OR_NULL	= PTR_MAYBE_NULL | ARG_PTR_TO_ALLOC_MEM,</div><div class='add'>+	ARG_PTR_TO_STACK_OR_NULL	= PTR_MAYBE_NULL | ARG_PTR_TO_STACK,</div><div class='add'>+</div><div class='ctx'> 	/* This must be the last entry. Its purpose is to ensure the enum is</div><div class='ctx'> 	 * wide enough to hold the higher bits reserved for bpf_type_flag.</div><div class='ctx'> 	 */</div><div class='head'>diff --git a/kernel/bpf/verifier.c b/kernel/bpf/verifier.c<br/>index 07d7d6124a18b4..6095a75c111851 100644<br/>--- a/<a href='/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/bpf/verifier.c?id=d639b9d13a39cf15639cbe6e8b2c43eb60148a73'>kernel/bpf/verifier.c</a><br/>+++ b/<a href='/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/bpf/verifier.c?id=48946bd6a5d695c50b34546864b79c1f910a33c1'>kernel/bpf/verifier.c</a></div><div class='hunk'>@@ -475,14 +475,9 @@ static bool arg_type_may_be_refcounted(enum bpf_arg_type type)</div><div class='ctx'> 	return type == ARG_PTR_TO_SOCK_COMMON;</div><div class='ctx'> }</div><div class='ctx'> </div><div class='del'>-static bool arg_type_may_be_null(enum bpf_arg_type type)</div><div class='add'>+static bool type_may_be_null(u32 type)</div><div class='ctx'> {</div><div class='del'>-	return type == ARG_PTR_TO_MAP_VALUE_OR_NULL ||</div><div class='del'>-	       type == ARG_PTR_TO_MEM_OR_NULL ||</div><div class='del'>-	       type == ARG_PTR_TO_CTX_OR_NULL ||</div><div class='del'>-	       type == ARG_PTR_TO_SOCKET_OR_NULL ||</div><div class='del'>-	       type == ARG_PTR_TO_ALLOC_MEM_OR_NULL ||</div><div class='del'>-	       type == ARG_PTR_TO_STACK_OR_NULL;</div><div class='add'>+	return type &amp; PTR_MAYBE_NULL;</div><div class='ctx'> }</div><div class='ctx'> </div><div class='ctx'> /* Determine whether the function releases some resources allocated by another</div><div class='hunk'>@@ -5016,9 +5011,8 @@ static int process_timer_func(struct bpf_verifier_env *env, int regno,</div><div class='ctx'> </div><div class='ctx'> static bool arg_type_is_mem_ptr(enum bpf_arg_type type)</div><div class='ctx'> {</div><div class='del'>-	return type == ARG_PTR_TO_MEM ||</div><div class='del'>-	       type == ARG_PTR_TO_MEM_OR_NULL ||</div><div class='del'>-	       type == ARG_PTR_TO_UNINIT_MEM;</div><div class='add'>+	return base_type(type) == ARG_PTR_TO_MEM ||</div><div class='add'>+	       base_type(type) == ARG_PTR_TO_UNINIT_MEM;</div><div class='ctx'> }</div><div class='ctx'> </div><div class='ctx'> static bool arg_type_is_mem_size(enum bpf_arg_type type)</div><div class='hunk'>@@ -5155,31 +5149,26 @@ static const struct bpf_reg_types *compatible_reg_types[__BPF_ARG_TYPE_MAX] = {</div><div class='ctx'> 	[ARG_PTR_TO_MAP_KEY]		= &amp;map_key_value_types,</div><div class='ctx'> 	[ARG_PTR_TO_MAP_VALUE]		= &amp;map_key_value_types,</div><div class='ctx'> 	[ARG_PTR_TO_UNINIT_MAP_VALUE]	= &amp;map_key_value_types,</div><div class='del'>-	[ARG_PTR_TO_MAP_VALUE_OR_NULL]	= &amp;map_key_value_types,</div><div class='ctx'> 	[ARG_CONST_SIZE]		= &amp;scalar_types,</div><div class='ctx'> 	[ARG_CONST_SIZE_OR_ZERO]	= &amp;scalar_types,</div><div class='ctx'> 	[ARG_CONST_ALLOC_SIZE_OR_ZERO]	= &amp;scalar_types,</div><div class='ctx'> 	[ARG_CONST_MAP_PTR]		= &amp;const_map_ptr_types,</div><div class='ctx'> 	[ARG_PTR_TO_CTX]		= &amp;context_types,</div><div class='del'>-	[ARG_PTR_TO_CTX_OR_NULL]	= &amp;context_types,</div><div class='ctx'> 	[ARG_PTR_TO_SOCK_COMMON]	= &amp;sock_types,</div><div class='ctx'> #ifdef CONFIG_NET</div><div class='ctx'> 	[ARG_PTR_TO_BTF_ID_SOCK_COMMON]	= &amp;btf_id_sock_common_types,</div><div class='ctx'> #endif</div><div class='ctx'> 	[ARG_PTR_TO_SOCKET]		= &amp;fullsock_types,</div><div class='del'>-	[ARG_PTR_TO_SOCKET_OR_NULL]	= &amp;fullsock_types,</div><div class='ctx'> 	[ARG_PTR_TO_BTF_ID]		= &amp;btf_ptr_types,</div><div class='ctx'> 	[ARG_PTR_TO_SPIN_LOCK]		= &amp;spin_lock_types,</div><div class='ctx'> 	[ARG_PTR_TO_MEM]		= &amp;mem_types,</div><div class='del'>-	[ARG_PTR_TO_MEM_OR_NULL]	= &amp;mem_types,</div><div class='ctx'> 	[ARG_PTR_TO_UNINIT_MEM]		= &amp;mem_types,</div><div class='ctx'> 	[ARG_PTR_TO_ALLOC_MEM]		= &amp;alloc_mem_types,</div><div class='del'>-	[ARG_PTR_TO_ALLOC_MEM_OR_NULL]	= &amp;alloc_mem_types,</div><div class='ctx'> 	[ARG_PTR_TO_INT]		= &amp;int_ptr_types,</div><div class='ctx'> 	[ARG_PTR_TO_LONG]		= &amp;int_ptr_types,</div><div class='ctx'> 	[ARG_PTR_TO_PERCPU_BTF_ID]	= &amp;percpu_btf_ptr_types,</div><div class='ctx'> 	[ARG_PTR_TO_FUNC]		= &amp;func_ptr_types,</div><div class='del'>-	[ARG_PTR_TO_STACK_OR_NULL]	= &amp;stack_ptr_types,</div><div class='add'>+	[ARG_PTR_TO_STACK]		= &amp;stack_ptr_types,</div><div class='ctx'> 	[ARG_PTR_TO_CONST_STR]		= &amp;const_str_ptr_types,</div><div class='ctx'> 	[ARG_PTR_TO_TIMER]		= &amp;timer_types,</div><div class='ctx'> };</div><div class='hunk'>@@ -5193,7 +5182,7 @@ static int check_reg_type(struct bpf_verifier_env *env, u32 regno,</div><div class='ctx'> 	const struct bpf_reg_types *compatible;</div><div class='ctx'> 	int i, j;</div><div class='ctx'> </div><div class='del'>-	compatible = compatible_reg_types[arg_type];</div><div class='add'>+	compatible = compatible_reg_types[base_type(arg_type)];</div><div class='ctx'> 	if (!compatible) {</div><div class='ctx'> 		verbose(env, "verifier internal error: unsupported arg type %d\n", arg_type);</div><div class='ctx'> 		return -EFAULT;</div><div class='hunk'>@@ -5274,15 +5263,14 @@ static int check_func_arg(struct bpf_verifier_env *env, u32 arg,</div><div class='ctx'> 		return -EACCES;</div><div class='ctx'> 	}</div><div class='ctx'> </div><div class='del'>-	if (arg_type == ARG_PTR_TO_MAP_VALUE ||</div><div class='del'>-	    arg_type == ARG_PTR_TO_UNINIT_MAP_VALUE ||</div><div class='del'>-	    arg_type == ARG_PTR_TO_MAP_VALUE_OR_NULL) {</div><div class='add'>+	if (base_type(arg_type) == ARG_PTR_TO_MAP_VALUE ||</div><div class='add'>+	    base_type(arg_type) == ARG_PTR_TO_UNINIT_MAP_VALUE) {</div><div class='ctx'> 		err = resolve_map_arg_type(env, meta, &amp;arg_type);</div><div class='ctx'> 		if (err)</div><div class='ctx'> 			return err;</div><div class='ctx'> 	}</div><div class='ctx'> </div><div class='del'>-	if (register_is_null(reg) &amp;&amp; arg_type_may_be_null(arg_type))</div><div class='add'>+	if (register_is_null(reg) &amp;&amp; type_may_be_null(arg_type))</div><div class='ctx'> 		/* A NULL register has a SCALAR_VALUE type, so skip</div><div class='ctx'> 		 * type checking.</div><div class='ctx'> 		 */</div><div class='hunk'>@@ -5351,10 +5339,11 @@ skip_type_check:</div><div class='ctx'> 		err = check_helper_mem_access(env, regno,</div><div class='ctx'> 					      meta-&gt;map_ptr-&gt;key_size, false,</div><div class='ctx'> 					      NULL);</div><div class='del'>-	} else if (arg_type == ARG_PTR_TO_MAP_VALUE ||</div><div class='del'>-		   (arg_type == ARG_PTR_TO_MAP_VALUE_OR_NULL &amp;&amp;</div><div class='del'>-		    !register_is_null(reg)) ||</div><div class='del'>-		   arg_type == ARG_PTR_TO_UNINIT_MAP_VALUE) {</div><div class='add'>+	} else if (base_type(arg_type) == ARG_PTR_TO_MAP_VALUE ||</div><div class='add'>+		   base_type(arg_type) == ARG_PTR_TO_UNINIT_MAP_VALUE) {</div><div class='add'>+		if (type_may_be_null(arg_type) &amp;&amp; register_is_null(reg))</div><div class='add'>+			return 0;</div><div class='add'>+</div><div class='ctx'> 		/* bpf_map_xxx(..., map_ptr, ..., value) call:</div><div class='ctx'> 		 * check [value, value + map-&gt;value_size) validity</div><div class='ctx'> 		 */</div></td></tr></table></div> <!-- class=content -->
<div class='footer'>generated by <a href='https://git.zx2c4.com/cgit/about/'>cgit 1.2.3-korg</a> (<a href='https://git-scm.com/'>git 2.43.0</a>) at 2025-01-05 16:27:56 +0000</div>
</div> <!-- id=cgit -->
</body>
</html>
