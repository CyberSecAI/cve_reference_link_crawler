=== Content from blog.trailofbits.com_ec591e22_20250111_120457.html ===

# [Trail of Bits Blog](https://blog.trailofbits.com/ "Trail of Bits Blog")

##

# Menu

[Skip to content](#content "Skip to content")

* [Home](https://blog.trailofbits.com/)

# Security flaws in an SSO plugin for Caddy

* Post
* [September 18, 2023](https://blog.trailofbits.com/2023/09/18/security-flaws-in-an-sso-plugin-for-caddy/ "8:00 am")
* [Leave a comment](https://blog.trailofbits.com/2023/09/18/security-flaws-in-an-sso-plugin-for-caddy/#respond)

*By Maciej Domanski, Travis Peters, and David Pokora*

We identified 10 security vulnerabilities within the [caddy-security plugin](https://github.com/greenpau/caddy-security) for the [Caddy](https://github.com/caddyserver/caddy) web server that could enable a variety of high-severity attacks in web applications, including client-side code execution, OAuth replay attacks, and unauthorized access to resources.

During our evaluation, Caddy was deployed as a reverse proxy to provide access to several of our internal services. We explored a plugin configuration that would allow us to handle authentication and authorization with our Google SSO so that we didn’t have to implement this on a per-app basis.

In this blog post, we will briefly explore the security vulnerabilities we identified in the caddy-security plugin and discuss their potential impact. As with our typical security assessments, for each issue we identified, we present a recommendation for immediately fixing the issue, as well as long-term, more strategic advice for preventing similar issues and improving the overall security posture.

As security experts, our goal is not only to identify vulnerabilities in specific software but also to contribute to the larger community by sharing our recommendations for fixing these problems. We believe that these recommendations can help developers overcome similar challenges in other SSO systems and improve their security.

## Caddy Background

[Caddy](https://caddyserver.com/) (a.k.a. Caddy Server or Caddy 2) is a modern, open-source web server written in Golang that is designed to be easy to use and highly configurable. Caddy is built to streamline the process of hosting web applications while prioritizing security and performance. It aims to reduce the complexity associated with configuring and deploying web servers.

The caddy-security plugin is a middleware plugin for the Caddy web server. It provides various security-related functionalities to enhance the overall security posture of web applications. Some of the key features offered by the caddy-security plugin include an authentication plugin for implementing Form-Based, Basic, Local, LDAP, OpenID Connect, OAuth 2.0, SAML Authentication, and an authorization plugin for HTTP request authorization based on JWT/PASETO tokens.

## Findings

### Issue #1: Reflected Cross-Site Scripting (XSS)

*Severity: High*

Reflected XSS occurs when an application includes untrusted data in the HTML response sent to the user’s browser. In this case, the provided `/admin%22%3E%3Cscript%3Ealert(document.domain)%3C/script%3E/admin/login` or `/settings/mfa/delete/<img%20src=x%20onerror=alert(document.domain)>` API calls trigger an alert. An attacker can exploit this vulnerability to execute arbitrary JavaScript code within the target user’s browser, potentially leading to further attacks such as session hijacking.

To immediately address this issue, strategically treat all string values as potentially untrustworthy, regardless of their source, and escape them properly (using the `safehtml/template` package that generates output-safe HTML).

In addition to that remediation, we also suggest a few different ways to improve defense in depth:

* Extend unit tests with potentially malicious XSS payloads. Refer to the [Cross-site scripting (XSS) cheat sheet](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet) for various attack vectors.
* Consider using the Active Scanner from Burp Suite Professional in a testing environment for all API calls. Additionally, use the [scanning with a live task](https://portswigger.net/burp/documentation/desktop/automated-scanning/live-tasks) strategy to have underlying requests scanned automatically when interacting with the web interface.
* Expand the caddy-security documentation to promote security headers—especially the Content Security Policy (CSP) header that controls which resources can be loaded by the browser, limiting the impact of potential XSS attacks.

### Issue #2: Insecure Randomness

*Severity: High*

The caddy-security plugin uses the `math/rand` Golang library with a seed based on the Unix timestamp to generate strings for three security-critical contexts in the application, which could possibly be predicted via a brute-force search. Attackers could use the potentially predictable nonce value used for authentication purposes in the OAuth flow to conduct OAuth replay attacks. In addition, insecure randomness is used while generating multifactor authentication (MFA) secrets and creating API keys in the database package.

To immediately mitigate this vulnerability, use a cryptographically secure random number generator for generating the random strings. Golang’s library `crypto/rand` is designed for secure random number generation.

In addition to that fix, we recommend considering the following long-term recommendations:

* Review the application for other instances where the `math/rand` package is used for secure context. Create secure wrapping functions and use them throughout the code to serve a cryptographically secure string with the requested length.
* Avoid duplicating code. Having a single function, such as `secureRandomString`, rather than multiple duplicate functions makes it easier to audit and verify the system’s security. It also prevents future changes to the codebase from reintroducing issues.
* Implement Semgrep in the CI/CD. The `math-random-used` Semgrep rule will catch instances where `math/rand` is used. Refer to our [Testing Handbook on Semgrep](https://appsec.guide/docs/static-analysis/semgrep/) for more information.
* Read textbooks such as *Real World Cryptography*, as it is a great resource for practical cryptographic considerations.

### Issue #3: IP Spoofing via X-Forwarded-For Header

*Severity: Medium*

By manipulating the `X-Forwarded-For` header, an attacker can spoof an IP address used in the user `identity` module (`/whoami` API endpoint). This could lead to unauthorized access if the system trusts this spoofed IP address.

To resolve this vulnerability, reimplement the application to not rely on user-provided headers when obtaining a user’s IP address. If user-provided headers are required (e.g., `X-Forwarded-For` for logging purposes), ensure the header is properly validated (i.e., the value is consistent with IP address format through regular expression) or sanitized (to avoid [CRLF log injection attacks](https://owasp.org/www-community/vulnerabilities/CRLF_Injection), for example).

In addition to this immediate fix, we recommend considering these long-term recommendations:

* Implement appropriate checks for potential IP spoofing and `X-` headers on the unit testing level. Consider [other headers that can rewrite IP sources](https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/special-http-headers#headers-to-change-location).
* Cover the IP spoofing scenarios and user-provided header processing in Golang’s native fuzz tests.
* Use the dynamic testing approach with Burp Suite Professional and the [Param Miner](https://portswigger.net/bappstore/17d2949a985c4b7ca092728dba871943) extension to identify the processing of hidden headers.
* Expand the caddy-security documentation to increase user awareness of this type of threat; show an example of misconfiguration, how to resolve, and how to test it.

### Issue #4: Referer-Based Header XSS

*Severity: Medium*

An XSS vulnerability can be triggered by rewriting the `Referer` header. Although the `Referer` header is sanitized by escaping some characters that can allow XSS (e.g., [`&`], [`<`], [`>`], [`"`], [`'`]), it does not account for the attack based on the JavaScript URL scheme (e.g., `javascript:alert(document.domain)//` payload). Exploiting this vulnerability may not be trivial, but it could lead to the execution of malicious scripts in the context of the target user’s browser, compromising user sessions.

The mitigation for this issue is identical to issue #1.

### Issue #5: Open Redirection Vulnerability

*Severity: Medium*

When a logged-in user clicks on a specially crafted link with a `redirect_url` parameter, the user can be redirected to an external website. The user must take an action, such as clicking on a portal button or using the browser’s back button, to trigger the redirection. This could lead to phishing attacks, where an attacker tricks users into visiting a malicious website by crafting a convincing URL.

To mitigate this vulnerability, perform proper `redirect_url` parameter validation to ensure that the redirection URLs are allowed only within the same domain or from trusted sources.

In addition, we also recommend the following long-term fixes:

* Implement robust unit tests with different bypassing scenarios of `redirect_url` parameter validation. Refer to the potential [URL Format Bypasses](https://book.hacktricks.xyz/pentesting-web/ssrf-server-side-request-forgery/url-format-bypass). Keep in mind that different components can use different URI parsers, which can lead to [parsing confusion](https://snyk.io/blog/url-confusion-vulnerabilities/).
* Use Burp Suite Professional with a scanner with both these settings enabled:
  + Audit coverage – maximum: to use the most extensive set of payload variations and insertion point options
  + Audit coverage – thorough: to try more payload variations

### Issue #6: X-Forwarded-Host Header Manipulation

*Severity: Medium*

The caddy-security plugin processes the `X-Forwarded-Host` header, which could lead to various security vulnerabilities (web cache poisoning, business logic flaws, routing-based server-side request forgery [SSRF], and classic server-side vulnerabilities). Additionally, the caddy-security plugin generates QR codes based on this header, which extends the attack surface.

To mitigate this issue, do not rely on the `Host` and `X-Forwarded-Host` headers in the caddy-security plugin logic. Instead, use the current domain manually specified in the configuration file to generate a QR code.

In addition, we recommend the following:

* Use Burp Suite Professional with the Param Miner extension to identify the processing of hidden headers.
* Extend the caddy-security documentation to increase user awareness of the [HTTP `Host` header attacks](https://portswigger.net/web-security/host-header/exploiting).

### Issue #7: X-Forwarded-Proto Header Manipulation

*Severity: Low*

The processing of the `X-Forwarded-Proto` header results in redirection to the injected protocol. While this scenario may have limited impact, improper handling of such headers could result in unpredictable security risks, such as bypass of security mechanisms or confusion in handling TLS.

To address this issue, do not rely on the `X-Forwarded-Proto` header. If it is required, validate the value of the `X-Forwarded-Proto` header against an allowlist of accepted protocols (e.g., HTTP/HTTPS) and reject unexpected values.

In addition, consider the long-term recommendations from issue #3.

### Issue #8: 2FA Bypass by Brute-Forcing Verification Codes

*Severity: Low*

The current implementation of the application’s two-factor authentication (2FA) lacks sufficient protection against brute-force attacks. Although the application blocks the user after several failed attempts to provide 2FA codes, attackers can bypass this blocking mechanism by automating the application’s full multistep 2FA process.

To address this issue effectively, enforce a minimum six-digit code length in the MFA configuration. Additionally, to reduce the risk of automated brute-forcing, implement an account locking mechanism that triggers after a specified number of invalid 2FA code attempts. Finally, enforce reauthentication for critical actions involving sensitive account information or security settings. For actions such as changing passwords or disabling 2FA, users should be required to reauthenticate, either with their password or a 2FA token. An exception can be made for reauthentication if the user has logged in within the last 10 minutes. Check out [Getting 2FA Right in 2019](https://blog.trailofbits.com/2019/06/20/getting-2fa-right-in-2019/) at the Trail of Bits Blog for more information.

### Issue #9: Lack of User Session Invalidation on Logout

*Severity: Low*

The caddy-security plugin lacks proper user session invalidation upon clicking the “Sign Out” button; user sessions remain valid even after requests are sent to `/logout` and `/oauth2/google/logout`. Attackers who gain access to an active but supposedly logged-out session can perform unauthorized actions on behalf of the user.

To address this issue, review the sign-out process to identify the cause of the unexpected behavior. Ensure that the `/oauth2/google/logout` endpoint correctly terminates the user session and invalidates the associated tokens.

For more defense in depth, use the [OWASP Application Security Verification Standard (V3 Session Management)](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x12-V3-Session-management.md#v3-session-management) to check whether the implementation handles sessions securely.

### Issue #10: Multiple Panics when Parsing Caddyfile

*Severity: Low*

Multiple parsing functions do not validate whether their input values are `nil` before attempting to access elements, which can lead to a panic (`index` `out` `of` `range`). Panics during the parsing of a Caddyfile may not be perceived as immediate vulnerabilities, but they could indicate improperly enforced security controls (e.g., insufficient data validation), which could lead to issues in other code paths.

To address these issues, integrate `nil` checks for input values before element access across all relevant functions.

To prevent similar issues of this type, add Golang’s native fuzz tests for Caddyfile parsing functions.

## Golang Security for the Community

We *love* writing and reviewing Golang codebases at Trail of Bits. Indeed, we are constantly working on Golang-related [(Semgrep) resources](https://appsec.guide/docs/static-analysis/semgrep/), [rules](https://github.com/trailofbits/semgrep-rules/tree/main/go), and [blog posts](https://blog.trailofbits.com/?s=go&submit=Search) and look forward to any opportunity to take on pet audits (like this) and [client projects](https://github.com/trailofbits/publications#security-reviews) where we examine Golang codebases.

Our aim in publishing our findings is to help protect others who may consider implementing a solution similar to the one we explored and to help them make informed decisions about their security infrastructure.

If you’re actively implementing a codebase in Golang or have questions, concerns, or other recommendations on open-source software you think we should look at, please [contact us](https://www.trailofbits.com/contact/).

## Coordinated Disclosure Timeline

As part of the disclosure process, we reported the vulnerabilities to the caddy-security plugin maintainers first. The timeline of disclosure is provided below:

* + August 7, 2023: We reported our findings to the caddy-security plugin maintainers.
  + August 23, 2023: The caddy-security plugin maintainers confirmed that there were no near-term plans to act on the reported vulnerabilities.
  + September 18, 2023: The disclosure blog post was released and issues were filed with the original project repository.

### Share this:

* [Twitter](https://blog.trailofbits.com/2023/09/18/security-flaws-in-an-sso-plugin-for-caddy/?share=twitter "Click to share on Twitter")
* [LinkedIn](https://blog.trailofbits.com/2023/09/18/security-flaws-in-an-sso-plugin-for-caddy/?share=linkedin "Click to share on LinkedIn")
* [Reddit](https://blog.trailofbits.com/2023/09/18/security-flaws-in-an-sso-plugin-for-caddy/?share=reddit "Click to share on Reddit")
* [Telegram](https://blog.trailofbits.com/2023/09/18/security-flaws-in-an-sso-plugin-for-caddy/?share=telegram "Click to share on Telegram")
* [Facebook](https://blog.trailofbits.com/2023/09/18/security-flaws-in-an-sso-plugin-for-caddy/?share=facebook "Click to share on Facebook")
* [Pocket](https://blog.trailofbits.com/2023/09/18/security-flaws-in-an-sso-plugin-for-caddy/?share=pocket "Click to share on Pocket")
* Email
* [Print](https://blog.trailofbits.com/2023/09/18/security-flaws-in-an-sso-plugin-for-caddy/#print "Click to print")
### Like this:

Like Loading...
### *Related*

By Trail of Bits

Posted in [Attacks](https://blog.trailofbits.com/category/attacks/), [Audits](https://blog.trailofbits.com/category/audits/), [Dynamic Analysis](https://blog.trailofbits.com/category/dynamic-analysis/), [Exploits](https://blog.trailofbits.com/category/exploits/), [Go](https://blog.trailofbits.com/category/go/), [Mitigations](https://blog.trailofbits.com/category/mitigations/), [Program Analysis](https://blog.trailofbits.com/category/program-analysis/), [Semgrep](https://blog.trailofbits.com/category/semgrep/), [Static Analysis](https://blog.trailofbits.com/category/static-analysis/), [Vulnerability Disclosure](https://blog.trailofbits.com/category/vulnerability-disclosure/)

# Post navigation

[← Holy Macroni! A recipe for progressive language enhancement](https://blog.trailofbits.com/2023/09/11/holy-macroni-a-recipe-for-progressive-language-enhancement/) [Don’t overextend your Oblivious Transfer →](https://blog.trailofbits.com/2023/09/20/dont-overextend-your-oblivious-transfer/)

### Leave a Reply[Cancel reply](/2023/09/18/security-flaws-in-an-sso-plugin-for-caddy/#respond)

Search

# About Us

Since 2012, Trail of Bits has helped secure some of the world’s most targeted organizations and products. We combine high-­end security research with a real­ world attacker mentality to reduce risk and fortify code.

Read more at [www.trailofbits.com](https://www.trailofbits.com)

# Subscribe via RSS

[![RSS feed](https://blog.trailofbits.com/wp-content/plugins/jetpack/images/rss/red-small.png) RSS - Posts](https://blog.trailofbits.com/feed/ "Subscribe to posts")

# Recent Posts

* [Auditing the Ruby ecosystem’s central package repository](https://blog.trailofbits.com/2024/12/11/auditing-the-ruby-ecosystems-central-package-repository/)
* [35 more Semgrep rules: infrastructure, supply chain, and Ruby](https://blog.trailofbits.com/2024/12/09/35-more-semgrep-rules-infrastructure-supply-chain-and-ruby/)
* [Evaluating Solidity support in AI coding assistants](https://blog.trailofbits.com/2024/11/19/evaluating-solidity-support-in-ai-coding-assistants/)
* [Attestations: A new generation of signatures on PyPI](https://blog.trailofbits.com/2024/11/14/attestations-a-new-generation-of-signatures-on-pypi/)
* [Killing Filecoin nodes](https://blog.trailofbits.com/2024/11/13/killing-filecoin-nodes/)
* [Fuzzing between the lines in popular barcode software](https://blog.trailofbits.com/2024/10/31/fuzzing-between-the-lines-in-popular-barcode-software/)
* [A deep dive into Linux’s new mseal syscall](https://blog.trailofbits.com/2024/10/25/a-deep-dive-into-linuxs-new-mseal-syscall/)
* [Auditing Gradio 5, Hugging Face’s ML GUI framework](https://blog.trailofbits.com/2024/10/10/auditing-gradio-5-hugging-faces-ml-gui-framework/)
* [Securing the software supply chain with the SLSA framework](https://blog.trailofbits.com/2024/10/01/securing-the-software-supply-chain-with-the-slsa-framework/)
* [A few notes on AWS Nitro Enclaves: Attack surface](https://blog.trailofbits.com/2024/09/24/notes-on-aws-nitro-enclaves-attack-surface/)
* [Announcing the Trail of Bits and Semgrep partnership](https://blog.trailofbits.com/2024/09/19/announcing-the-trail-of-bits-and-semgrep-partnership/)
* [Inside DEF CON: Michael Brown on how AI/ML is revolutionizing cybersecurity](https://blog.trailofbits.com/2024/09/17/inside-def-con-michael-brown-on-how-ai-ml-is-revolutionizing-cybersecurity/)
* [Friends don’t let friends reuse nonces](https://blog.trailofbits.com/2024/09/13/friends-dont-let-friends-reuse-nonces/)
* [Sanitize your C++ containers: ASan annotations step-by-step](https://blog.trailofbits.com/2024/09/10/sanitize-your-c-containers-asan-annotations-step-by-step/)
* [“Unstripping” binaries: Restoring debugging information in GDB with Pwndbg](https://blog.trailofbits.com/2024/09/06/unstripping-binaries-restoring-debugging-information-in-gdb-with-pwndbg/)
# Yearly Archive

* [2023](https://blog.trailofbits.com/2023)
* [2022](https://blog.trailofbits.com/2022)
* [2021](https://blog.trailofbits.com/2021)
* [2020](https://blog.trailofbits.com/2020)
* [2019](https://blog.trailofbits.com/2019)
* [2018](https://blog.trailofbits.com/2018)
* [2017](https://blog.trailofbits.com/2017)
* [2016](https://blog.trailofbits.com/2016)
* [2015](https://blog.trailofbits.com/2015)
* [2014](https://blog.trailofbits.com/2014)
* [2013](https://blog.trailofbits.com/2013)
* [2012](https://blog.trailofbits.com/2012)

# Categories

* [AIxCC](https://blog.trailofbits.com/category/aixcc/) (6)
* [Apple](https://blog.trailofbits.com/category/apple/) (13)
* [Application Security](https://blog.trailofbits.com/category/application-security/) (15)
* [Artificial Intelligence](https://blog.trailofbits.com/category/artificial-intelligence/) (1)
* [Attacks](https://blog.trailofbits.com/category/attacks/) (13)
* [Audits](https://blog.trailofbits.com/category/audits/) (11)
* [Authentication](https://blog.trailofbits.com/category/authentication/) (6)
* [Binary Ninja](https://blog.trailofbits.com/category/binary-ninja/) (15)
* [Blockchain](https://blog.trailofbits.com/category/blockchain/) (69)
* [C/C++](https://blog.trailofbits.com/category/c-c/) (1)
* [Capture the Flag](https://blog.trailofbits.com/category/capture-the-flag/) (11)
* [Careers](https://blog.trailofbits.com/category/careers/) (2)
* [CodeQL](https://blog.trailofbits.com/category/codeql/) (6)
* [Compilers](https://blog.trailofbits.com/category/compilers/) (30)
* [Conferences](https://blog.trailofbits.com/category/conferences/) (33)
* [Confidential Computing](https://blog.trailofbits.com/category/confidential-computing/) (1)
* [Containers](https://blog.trailofbits.com/category/containers/) (3)
* [Cryptography](https://blog.trailofbits.com/category/cryptography/) (68)
* [Crytic](https://blog.trailofbits.com/category/crytic/) (4)
* [Cyber Grand Challenge](https://blog.trailofbits.com/category/cyber-grand-challenge/) (8)
* [DARPA](https://blog.trailofbits.com/category/darpa/) (25)
* [Design Review](https://blog.trailofbits.com/category/design-review/) (1)
* [Dynamic Analysis](https://blog.trailofbits.com/category/dynamic-analysis/) (14)
* [eBPF](https://blog.trailofbits.com/category/ebpf/) (6)
* [Echidna](https://blog.trailofbits.com/category/echidna/) (1)
* [Ecosystem Security](https://blog.trailofbits.com/category/ecosystem-security/) (5)
* [Education](https://blog.trailofbits.com/category/education/) (17)
* [Empire Hacking](https://blog.trailofbits.com/category/empire-hacking/) (7)
* [Engineering Practice](https://blog.trailofbits.com/category/engineering-practice/) (16)
* [Events](https://blog.trailofbits.com/category/events/) (8)
* [Exploits](https://blog.trailofbits.com/category/exploits/) (30)
* [Fuzzing](https://blog.trailofbits.com/category/fuzzing/) (45)
* [Go](https://blog.trailofbits.com/category/go/) (8)
* [Guides](https://blog.trailofbits.com/category/guides/) (15)
* [Internship Projects](https://blog.trailofbits.com/category/internship-projects/) (38)
* [Invariant Development](https://blog.trailofbits.com/category/invariant-development/) (1)
* [iVerify](https://blog.trailofbits.com/category/iverify/) (5)
* [Kubernetes](https://blog.trailofbits.com/category/kubernetes/) (3)
* [Linux](https://blog.trailofbits.com/category/linux/) (8)
* [LLVM](https://blog.trailofbits.com/category/llvm/) (4)
* [Machine Learning](https://blog.trailofbits.com/category/machine-learning/) (27)
* [Malware](https://blog.trailofbits.com/category/malware/) (7)
* [Manticore](https://blog.trailofbits.com/category/manticore/) (17)
* [McSema](https://blog.trailofbits.com/category/mcsema/) (11)
* [Memory Safety](https://blog.trailofbits.com/category/memory-safety/) (2)
* [Meta](https://blog.trailofbits.com/category/meta/) (12)
* [Mitigations](https://blog.trailofbits.com/category/mitigations/) (11)
* [MLIR](https://blog.trailofbits.com/category/mlir/) (2)
* [Open Source](https://blog.trailofbits.com/category/open-source/) (14)
* [osquery](https://blog.trailofbits.com/category/osquery/) (23)
* [Paper Review](https://blog.trailofbits.com/category/paper-review/) (11)
* [People](https://blog.trailofbits.com/category/people/) (6)
* [Podcast](https://blog.trailofbits.com/category/podcast/) (1)
* [Policy](https://blog.trailofbits.com/category/policy/) (11)
* [Press Release](https://blog.trailofbits.com/category/press-release/) (30)
* [Privacy](https://blog.trailofbits.com/category/privacy/) (9)
* [Products](https://blog.trailofbits.com/category/products/) (8)
* [Program Analysis](https://blog.trailofbits.com/category/program-analysis/) (18)
* [Recruitment](https://blog.trailofbits.com/category/recruitment/) (1)
* [Remote Work](https://blog.trailofbits.com/category/remote-work/) (1)
* [Research Practice](https://blog.trailofbits.com/category/research-practice/) (30)
* [Reversing](https://blog.trailofbits.com/category/reversing/) (16)
* [Rust](https://blog.trailofbits.com/category/rust/) (7)
* [SafeDocs](https://blog.trailofbits.com/category/safedocs/) (1)
* [Semgrep](https://blog.trailofbits.com/category/semgrep/) (9)
* [Sinter](https://blog.trailofbits.com/category/sinter/) (1)
* [Slither](https://blog.trailofbits.com/category/slither/) (4)
* [Sponsorships](https://blog.trailofbits.com/category/sponsorships/) (12)
* [Static Analysis](https://blog.trailofbits.com/category/static-analysis/) (34)
* [Supply Chain](https://blog.trailofbits.com/category/supply-chain/) (3)
* [Symbolic Execution](https://blog.trailofbits.com/category/symbolic-execution/) (18)
* [Testing Handbook](https://blog.trailofbits.com/category/testing-handbook/) (5)
* [Threshold Signatures](https://blog.trailofbits.com/category/threshold-signatures/) (1)
* [Tool Release](https://blog.trailofbits.com/category/tool-release/) (5)
* [Training](https://blog.trailofbits.com/category/training/) (3)
* [Uncategorized](https://blog.trailofbits.com/category/uncategorized/) (33)
* [VAST](https://blog.trailofbits.com/category/vast/) (2)
* [Vulnerability Disclosure](https://blog.trailofbits.com/category/vulnerability-disclosure/) (20)
* [Windows](https://blog.trailofbits.com/category/windows/) (3)
* [Working at Trail of Bits](https://blog.trailofbits.com/category/working-at-trail-of-bits/) (2)
* [Year in Review](https://blog.trailofbits.com/category/year-in-review/) (6)
* [Zero Knowledge](https://blog.trailofbits.com/category/zero-knowledge/) (11)
[My Tweets](https://twitter.com/trailofbits)

## Discover more from Trail of Bits Blog

Subscribe now to keep reading and get access to the full archive.

Type your email…

Subscribe

Continue reading

%d



=== Content from security.snyk.io_e3e38d9c_20250111_120500.html ===
[![Homepage](/_nuxt/header-logo.Dk_X-iWD.svg)](/)

2. [Snyk Vulnerability Database](/vuln)
3. [Go](/vuln/golang)
4. github.com/greenpau/caddy-security
# Insecure Randomness The advisory has been revoked - it doesn't affect any version of package [github.com/greenpau/caddy-security  (opens in a new tab)](/package/golang/github.com/greenpau/caddy-security)

---

### Threat Intelligence

Exploit Maturity

Snyk has a proof-of-concept or detailed explanation of how to exploit this vulnerability.

Proof of conceptEPSS

The probability is the direct output of the EPSS model, and conveys an overall sense of the threat of
exploitation in the wild. The percentile measures the EPSS probability relative to all known EPSS scores.
Note: This data is updated daily, relying on the latest available EPSS model version.
Check out the EPSS
[documentation](https://www.first.org/epss/articles/prob_percentile_bins)
for more details.

**0.05% (18th percentile)**
### Do your applications use this vulnerable package?

In a few clicks we can analyze your entire application and see what components are vulnerable in your application, and suggest you quick fixes.

[Test your applications](https://app.snyk.io/login?cta=sign-up&loc=banner&page=vuln-vuln)
### Snyk Learn

Learn about Insecure Randomness vulnerabilities in an interactive lesson.

 [Start learning](https://learn.snyk.io/lesson/insecure-randomness/)

* Snyk ID**SNYK-GOLANG-GITHUBCOMGREENPAUCADDYSECURITY-6248275**
* published**16 Feb 2024**
* disclosed**18 Sept 2023**
* credit**Maciej Domanski, Travis Peters, David Pokora**

[Report a new vulnerability](https://snyk.io/vulnerability-disclosure/) [Found a mistake?](https://support.snyk.io/s/contactsupport)
#### Introduced: 18 Sep 2023

[CVE-2024-21495  (opens in a new tab)](https://www.cve.org/CVERecord?id=CVE-2024-21495) Common Vulnerabilities and Exposures (CVE) are common identifiers for publicly known security vulnerabilities[CWE-330  (opens in a new tab)](https://cwe.mitre.org/data/definitions/330.html) Common Weakness Enumeration (CWE) is a category system for software weaknesses First added by Snyk
## Amendment

This was deemed not a vulnerability.

## Overview

[github.com/greenpau/caddy-security](https://pkg.go.dev/github.com/greenpau/caddy-security) is a Security App and Plugin for Caddy v2.

Affected versions of this package are vulnerable to Insecure Randomness due to using an insecure random number generation library which could possibly be predicted via a brute-force search. Attackers could use the potentially predictable nonce value used for authentication purposes in the OAuth flow to conduct OAuth replay attacks. In addition, insecure randomness is used while generating multifactor authentication (MFA) secrets and creating API keys in the database package.

## References

* [Blog post](https://blog.trailofbits.com/2023/09/18/security-flaws-in-an-sso-plugin-for-caddy/)
* [Github Commit](https://github.com/greenpau/go-authcrunch/commit/ecd3725baf2683eb1519bb3c81ae41085fbf7dc2)
* [Github Issue](https://github.com/greenpau/caddy-security/issues/265)
### Product

* [Snyk Open Source](https://snyk.io/product/open-source-security-management/)
* [Snyk Code](https://snyk.io/product/snyk-code/)
* [Snyk Container](https://snyk.io/product/container-vulnerability-management/)
* [Snyk Infrastructure as Code](https://snyk.io/product/infrastructure-as-code-security/)
* [Snyk AppRisk](https://snyk.io/product/snyk-apprisk/)
### Resources

* [Vulnerability DB](https://security.snyk.io/)
* [Documentation](https://docs.snyk.io/)
* [Disclosed Vulnerabilities](/disclosed-vulnerabilities)
* [Blog](https://snyk.io/blog/)
* [FAQs](https://support.snyk.io/)
### Company

* [About](https://snyk.io/about)
* [Jobs](https://snyk.io/careers/)
* Contact
* [Policies](https://snyk.io/policies/terms-of-service/)
* [Do Not Sell My Personal Information](https://preferences.snyk.io/dont_sell)
### Contact Us

* Support
* [Report a new vuln](https://snyk.io/vulnerability-disclosure)
* [Events](https://snyk.io/events)
### Find us online

### Track our development

[![DevSecOps Community Podcast](data:image/svg+xml;base64...)](https://www.devseccon.com/the-secure-developer-podcast/)

© 2025 Snyk Limited

Registered in England and Wales. Company number: 09677925

Registered address: Highlands House, Basingstoke Road, Spencers Wood, Reading, Berkshire, RG7 1NT.



=== Content from github.com_dc3a2311_20250111_120458.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgreenpau%2Fcaddy-security%2Fissues%2F265)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgreenpau%2Fcaddy-security%2Fissues%2F265)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=greenpau%2Fcaddy-security)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[greenpau](/greenpau)
/
**[caddy-security](/greenpau/caddy-security)**
Public

* [Notifications](/login?return_to=%2Fgreenpau%2Fcaddy-security) You must be signed in to change notification settings
* [Fork
  75](/login?return_to=%2Fgreenpau%2Fcaddy-security)
* [Star
   1.6k](/login?return_to=%2Fgreenpau%2Fcaddy-security)

* [Code](/greenpau/caddy-security)
* [Issues
  167](/greenpau/caddy-security/issues)
* [Pull requests
  2](/greenpau/caddy-security/pulls)
* [Actions](/greenpau/caddy-security/actions)
* [Security](/greenpau/caddy-security/security)
* [Insights](/greenpau/caddy-security/pulse)

Additional navigation options

* [Code](/greenpau/caddy-security)
* [Issues](/greenpau/caddy-security/issues)
* [Pull requests](/greenpau/caddy-security/pulls)
* [Actions](/greenpau/caddy-security/actions)
* [Security](/greenpau/caddy-security/security)
* [Insights](/greenpau/caddy-security/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fgreenpau%2Fcaddy-security%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fgreenpau%2Fcaddy-security%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Insecure Randomness #265

Closed

[ahpaleus](/ahpaleus) opened this issue
Sep 19, 2023
· 6 comments

Closed

# [Insecure Randomness](#top) #265

[ahpaleus](/ahpaleus) opened this issue
Sep 19, 2023
· 6 comments

Assignees
[![@greenpau](https://avatars.githubusercontent.com/u/3826416?s=40&v=4)](/greenpau)

Labels
[security](/greenpau/caddy-security/labels/security)

## Comments

[![@ahpaleus](https://avatars.githubusercontent.com/u/38883201?s=80&u=c796cd02e1b2615a0544402c430e580a3d5ff760&v=4)](/ahpaleus)

Copy link

### **[ahpaleus](/ahpaleus)** commented [Sep 19, 2023](#issue-1902581538)

| *Severity: High*  The caddy-security plugin uses the math/rand Golang library with a seed based on the Unix timestamp to generate strings for three security-critical contexts in the application, which could possibly be predicted via a brute-force search. Attackers could use the potentially predictable nonce value used for authentication purposes in the OAuth flow to conduct OAuth replay attacks. In addition, insecure randomness is used while generating multifactor authentication (MFA) secrets and creating API keys in the database package.   * <https://github.com/greenpau/go-authcrunch/blob/a6e434247876ad0b01940ac2947f17ca32a714bf/pkg/idp/oauth/authenticate.go#L204-L204> * <https://github.com/greenpau/go-authcrunch/blob/a6e434247876ad0b01940ac2947f17ca32a714bf/pkg/authn/handle_http_login.go#L193-L193>   To immediately mitigate this vulnerability, use a cryptographically secure random number generator for generating the random strings. Golang’s library crypto/rand is designed for secure random number generation.  In addition to that fix, we recommend considering the following long-term recommendations:   * Review the application for other instances where the math/rand package is used for secure context. Create secure wrapping functions and use them throughout the code to serve a cryptographically secure string with the requested length. * Avoid duplicating code. Having a single function, such as secureRandomString, rather than multiple duplicate functions makes it easier to audit and verify the system’s security. It also prevents future changes to the codebase from reintroducing issues. * Implement Semgrep in the CI/CD. The math-random-used Semgrep rule will catch instances where math/rand is used. Refer to our [Testing Handbook on Semgrep](https://appsec.guide/docs/static-analysis/semgrep/) for more information. * Read textbooks such as Real World Cryptography, as it is a great resource for practical cryptographic considerations.   More information about our public disclosure:   * <https://blog.trailofbits.com/2023/09/18/security-flaws-in-an-sso-plugin-for-caddy/> |
| --- |
| The text was updated successfully, but these errors were encountered: |

 ❤️
1
 ptman reacted with heart emoji

All reactions

* ❤️
  1 reaction

[![@st3fan](https://avatars.githubusercontent.com/u/28052?s=80&u=9179ebbd67123d4b696e961d6cdf787165f80713&v=4)](/st3fan)

Copy link

### **[st3fan](/st3fan)** commented [Sep 21, 2023](#issuecomment-1728638353)

| [@greenpau](https://github.com/greenpau) let me know if you accept contributions for this issue. I was reading the `util` code in `go-authcrunch` and I think it is relatively simple to convert it to use `crypto/rand` instead. I'm happy to give that a shot. |
| --- |

All reactions

Sorry, something went wrong.

[![@greenpau](https://avatars.githubusercontent.com/u/3826416?s=80&u=d4ea13bb3b14f67228e14cb058ba72f1f900979d&v=4)](/greenpau)

Copy link

Owner

### **[greenpau](/greenpau)** commented [Sep 21, 2023](#issuecomment-1728683231)

| [@st3fan](https://github.com/st3fan) , please do! 😄 thank you for the offer! |
| --- |

All reactions

Sorry, something went wrong.

[![@gedw99](https://avatars.githubusercontent.com/u/53147028?s=80&v=4)](/gedw99)

Copy link

### **[gedw99](/gedw99)** commented [Nov 9, 2023](#issuecomment-1803994994)

| Thos looks like a simple fix. Is anyone working on it ? |
| --- |

All reactions

Sorry, something went wrong.

[![@greenpau](https://avatars.githubusercontent.com/u/3826416?s=80&u=d4ea13bb3b14f67228e14cb058ba72f1f900979d&v=4)](/greenpau)

Copy link

Owner

### **[greenpau](/greenpau)** commented [Nov 9, 2023](#issuecomment-1804347879)

| [@gedw99](https://github.com/gedw99) , feel free to contribute! |
| --- |

All reactions

Sorry, something went wrong.

[![@greenpau](https://avatars.githubusercontent.com/u/3826416?s=40&u=d4ea13bb3b14f67228e14cb058ba72f1f900979d&v=4)](/greenpau)
[greenpau](/greenpau)
self-assigned this
[Dec 2, 2023](#event-11129113481)

[![@greenpau](https://avatars.githubusercontent.com/u/3826416?s=40&u=d4ea13bb3b14f67228e14cb058ba72f1f900979d&v=4)](/greenpau)
[greenpau](/greenpau)
added
the
[security](/greenpau/caddy-security/labels/security)
label
[Dec 2, 2023](#event-11129113725)

[greenpau](/greenpau)
added a commit
to greenpau/go-authcrunch
that referenced
this issue
[Dec 2, 2023](#ref-commit-ecd3725)
[![@greenpau](https://avatars.githubusercontent.com/u/3826416?s=40&u=d4ea13bb3b14f67228e14cb058ba72f1f900979d&v=4)](/greenpau)

`[security: addresses insecure randomness finding](/greenpau/go-authcrunch/commit/ecd3725baf2683eb1519bb3c81ae41085fbf7dc2 "security: addresses insecure randomness finding

See also: https://github.com/greenpau/caddy-security/issues/265")`
…

`[ecd3725](/greenpau/go-authcrunch/commit/ecd3725baf2683eb1519bb3c81ae41085fbf7dc2)`

```
See also: [greenpau/caddy-security#265](https://github.com/greenpau/caddy-security/issues/265)
```

[![@greenpau](https://avatars.githubusercontent.com/u/3826416?s=80&u=d4ea13bb3b14f67228e14cb058ba72f1f900979d&v=4)](/greenpau)

Copy link

Owner

### **[greenpau](/greenpau)** commented [Dec 2, 2023](#issuecomment-1837197472)

| [@ahpaleus](https://github.com/ahpaleus) , please see if the fix addresses your concerns. |
| --- |

All reactions

Sorry, something went wrong.

[![@greenpau](https://avatars.githubusercontent.com/u/3826416?s=80&u=d4ea13bb3b14f67228e14cb058ba72f1f900979d&v=4)](/greenpau)

Copy link

Owner

### **[greenpau](/greenpau)** commented [Dec 9, 2023](#issuecomment-1848429031)

| No activity. Closing. |
| --- |

All reactions

Sorry, something went wrong.

[![@greenpau](https://avatars.githubusercontent.com/u/3826416?s=40&u=d4ea13bb3b14f67228e14cb058ba72f1f900979d&v=4)](/greenpau)
[greenpau](/greenpau)
closed this as [completed](/greenpau/caddy-security/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Dec 9, 2023](#event-11200712825)

[![@GoVulnBot](https://avatars.githubusercontent.com/u/96493708?s=40&v=4)](/GoVulnBot)
[GoVulnBot](/GoVulnBot)
mentioned this issue
[Feb 17, 2024](#ref-issue-2139867322)

[x/vulndb: potential Go vuln in github.com/greenpau/caddy-security: CVE-2024-21495
golang/vulndb#2565](/golang/vulndb/issues/2565)

Closed

[![@FiloSottile](https://avatars.githubusercontent.com/u/1225294?s=40&v=4)](/FiloSottile)
[FiloSottile](/FiloSottile)
mentioned this issue
[Apr 26, 2024](#ref-issue-2265495604)

[crypto/rand: add func Text
golang/go#67057](/golang/go/issues/67057)

Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fgreenpau%2Fcaddy-security%2Fissues%2F265)

Assignees

[![@greenpau](https://avatars.githubusercontent.com/u/3826416?s=40&v=4)](/greenpau) [greenpau](/greenpau)

Labels

[security](/greenpau/caddy-security/labels/security)

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

4 participants

[![@st3fan](https://avatars.githubusercontent.com/u/28052?s=52&v=4)](/st3fan) [![@greenpau](https://avatars.githubusercontent.com/u/3826416?s=52&v=4)](/greenpau) [![@ahpaleus](https://avatars.githubusercontent.com/u/38883201?s=52&v=4)](/ahpaleus) [![@gedw99](https://avatars.githubusercontent.com/u/53147028?s=52&v=4)](/gedw99)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_f3d4c2df_20250111_120459.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgreenpau%2Fgo-authcrunch%2Fcommit%2Fecd3725baf2683eb1519bb3c81ae41085fbf7dc2)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgreenpau%2Fgo-authcrunch%2Fcommit%2Fecd3725baf2683eb1519bb3c81ae41085fbf7dc2)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=greenpau%2Fgo-authcrunch)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[greenpau](/greenpau)
/
**[go-authcrunch](/greenpau/go-authcrunch)**
Public

* [Notifications](/login?return_to=%2Fgreenpau%2Fgo-authcrunch) You must be signed in to change notification settings
* [Fork
  52](/login?return_to=%2Fgreenpau%2Fgo-authcrunch)
* [Star
   42](/login?return_to=%2Fgreenpau%2Fgo-authcrunch)

* [Code](/greenpau/go-authcrunch)
* [Issues
  11](/greenpau/go-authcrunch/issues)
* [Pull requests
  4](/greenpau/go-authcrunch/pulls)
* [Actions](/greenpau/go-authcrunch/actions)
* [Security](/greenpau/go-authcrunch/security)
* [Insights](/greenpau/go-authcrunch/pulse)

Additional navigation options

* [Code](/greenpau/go-authcrunch)
* [Issues](/greenpau/go-authcrunch/issues)
* [Pull requests](/greenpau/go-authcrunch/pulls)
* [Actions](/greenpau/go-authcrunch/actions)
* [Security](/greenpau/go-authcrunch/security)
* [Insights](/greenpau/go-authcrunch/pulse)

## Commit

[Permalink](/greenpau/go-authcrunch/commit/ecd3725baf2683eb1519bb3c81ae41085fbf7dc2)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

security: addresses insecure randomness finding

[Browse files](/greenpau/go-authcrunch/tree/ecd3725baf2683eb1519bb3c81ae41085fbf7dc2)
Browse the repository at this point in the history

```
See also: [greenpau/caddy-security#265](https://github.com/greenpau/caddy-security/issues/265)
```

* Loading branch information

[![@greenpau](https://avatars.githubusercontent.com/u/3826416?s=40&v=4)](/greenpau)

[greenpau](/greenpau/go-authcrunch/commits?author=greenpau "View all commits by greenpau")
committed
Dec 2, 2023

1 parent
[e626f47](/greenpau/go-authcrunch/commit/e626f47f4b47792b8edab8ebfbe75ae7aa44d8ac)

commit ecd3725

 Show file tree

 Hide file tree

Showing
**9 changed files**
with
**71 additions**
and
**85 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* Makefile
  [Makefile](#diff-76ed074a9305c04054cdebb9e9aad2d818052b07091de1f20cad0bbac34ffb52)
* internal/tests

  + internal/tests/random.go
    [random.go](#diff-c36fd36664f6a240031d33a781e31dd562eb12b611b5a768fa12d903a5d6156f)
* pkg

  + identity

    - pkg/identity/api\_key.go
      [api\_key.go](#diff-d0d99a3e8866715e1a9aca5c6d410dd134787023d90cb99d7998ebc5d1c5402e)
    - pkg/identity/api\_key\_test.go
      [api\_key\_test.go](#diff-90c398ba6781f750102b9b446a12345336c38e820fbb6e3848eb86c40f756c4b)
    - pkg/identity/database.go
      [database.go](#diff-e4aeac1e553a4c90256098feeba281ed30f845b88f1a8c8eaf644c4a8f6e3a40)
    - pkg/identity/mfa\_token.go
      [mfa\_token.go](#diff-da9019048d311aaed070db03383f8e82a1e15ecc543f7a90983f43fc5c84082a)
    - pkg/identity/public\_key.go
      [public\_key.go](#diff-b07ef0ae91bf0f22ec5b199a58ed6b149bd75feb3f34671b6e49afcec2ba37bc)
    - pkg/identity/random.go
      [random.go](#diff-2001a3db9277ce74c851468fc01e40f8020a741c63340634a990adb74f93f35b)
  + util

    - pkg/util/random.go
      [random.go](#diff-cc1b29f85e2be9d2747df497dd4e4eb80e6ee58417ae75926194ece458ff49d8)

## There are no files selected for viewing

4 changes: 3 additions & 1 deletion

4
[Makefile](#diff-76ed074a9305c04054cdebb9e9aad2d818052b07091de1f20cad0bbac34ffb52 "Makefile")

Show comments

[View file](/greenpau/go-authcrunch/blob/ecd3725baf2683eb1519bb3c81ae41085fbf7dc2/Makefile)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -102,7 +102,9 @@ clean: |
|  |  | qtest: covdir |
|  |  | @echo "Perform quick tests ..." |
|  |  | @#time richgo test -v -coverprofile=.coverage/coverage.out internal/tag/\*.go |
|  |  | @#time richgo test -v -coverprofile=.coverage/coverage.out internal/testutils/\*.go |
|  |  | @#time richgo test $(VERBOSE) $(TEST) -coverprofile=.coverage/coverage.out ./pkg/util/data/... |
|  |  | @time richgo test $(VERBOSE) $(TEST) -coverprofile=.coverage/coverage.out ./pkg/util/... |
|  |  | @#time richgo test $(VERBOSE) $(TEST) -coverprofile=.coverage/coverage.out -run TestNewConfig ./\*.go |
|  |  | @#time richgo test $(VERBOSE) $(TEST) -coverprofile=.coverage/coverage.out -run TestNewServer ./\*.go |
|  |  | @#time richgo test $(VERBOSE) $(TEST) -coverprofile=.coverage/coverage.out ./pkg/registry/... |
| Expand Down  Expand Up | | @@ -147,7 +149,7 @@ qtest: covdir |
|  |  | @#time richgo test $(VERBOSE) $(TEST) -coverprofile=.coverage/coverage.out ./pkg/authproxy/... |
|  |  | @#time richgo test $(VERBOSE) $(TEST) -coverprofile=.coverage/coverage.out ./pkg/identity/... |
|  |  | @#time richgo test $(VERBOSE) $(TEST) -coverprofile=.coverage/coverage.out ./pkg/authn/backends/... |
|  |  | @time richgo test $(VERBOSE) $(TEST) -coverprofile=.coverage/coverage.out -run NewAPIKey ./pkg/identity/... |
|  |  | @#time richgo test $(VERBOSE) $(TEST) -coverprofile=.coverage/coverage.out -run NewAPIKey ./pkg/identity/... |
|  |  | @go tool cover -html=.coverage/coverage.out -o .coverage/coverage.html |
|  |  | @#go tool cover -func=.coverage/coverage.out | grep -v "100.0" |
|  |  | @go tool cover -func=.coverage/coverage.out |
| Expand Down | |  |

24 changes: 19 additions & 5 deletions

24
[internal/tests/random.go](#diff-c36fd36664f6a240031d33a781e31dd562eb12b611b5a768fa12d903a5d6156f "internal/tests/random.go")

Show comments

[View file](/greenpau/go-authcrunch/blob/ecd3725baf2683eb1519bb3c81ae41085fbf7dc2/internal/tests/random.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -15,8 +15,10 @@ |
|  |  | package tests |
|  |  |  |
|  |  | import ( |
|  |  | "crypto/rand" |
|  |  | "github.com/google/uuid" |
|  |  | "math/rand" |
|  |  | "io" |
|  |  | mathrand "math/rand" |
|  |  | "strings" |
|  |  | ) |
|  |  |  |
| Expand All | | @@ -28,12 +30,24 @@ func NewID() string { |
|  |  | // NewRandomString returns a random string. |
|  |  | func NewRandomString(length int) string { |
|  |  | chars := []rune("abcdefghijklmnopqrstuvwxyz0123456789") |
|  |  | charsLen := byte(36) |
|  |  |  |
|  |  | if length == 0 { |
|  |  | length = 32 |
|  |  | } |
|  |  | var b strings.Builder |
|  |  | for i := 0; i < length; i++ { |
|  |  | b.WriteRune(chars[rand.Intn(len(chars))]) |
|  |  |  |
|  |  | b := make([]byte, length) |
|  |  | if \_, err := io.ReadFull(rand.Reader, b); err != nil { |
|  |  | var sb strings.Builder |
|  |  | for i := 0; i < length; i++ { |
|  |  | sb.WriteRune(chars[mathrand.Intn(len(chars))]) |
|  |  | } |
|  |  | return sb.String() |
|  |  | } |
|  |  | return b.String() |
|  |  |  |
|  |  | for i, char := range b { |
|  |  | b[i] = byte(chars[char%charsLen]) |
|  |  | } |
|  |  |  |
|  |  | return string(b) |
|  |  | } |

3 changes: 2 additions & 1 deletion

3
[pkg/identity/api\_key.go](#diff-d0d99a3e8866715e1a9aca5c6d410dd134787023d90cb99d7998ebc5d1c5402e "pkg/identity/api_key.go")

Show comments

[View file](/greenpau/go-authcrunch/blob/ecd3725baf2683eb1519bb3c81ae41085fbf7dc2/pkg/identity/api_key.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -17,6 +17,7 @@ package identity |
|  |  | import ( |
|  |  | "github.com/greenpau/go-authcrunch/pkg/errors" |
|  |  | "github.com/greenpau/go-authcrunch/pkg/requests" |
|  |  | "github.com/greenpau/go-authcrunch/pkg/util" |
|  |  | "golang.org/x/crypto/bcrypt" |
|  |  | "time" |
|  |  | ) |
| Expand Down  Expand Up | | @@ -80,7 +81,7 @@ func NewAPIKey(r \*requests.Request) (\*APIKey, error) { |
|  |  | } |
|  |  | p := &APIKey{ |
|  |  | Comment: r.Key.Comment, |
|  |  | ID: GetRandomString(40), |
|  |  | ID: util.GetRandomString(40), |
|  |  | Prefix: r.Key.Prefix, |
|  |  | Payload: r.Key.Payload, |
|  |  | Usage: r.Key.Usage, |
| Expand Down | |  |

11 changes: 6 additions & 5 deletions

11
[pkg/identity/api\_key\_test.go](#diff-90c398ba6781f750102b9b446a12345336c38e820fbb6e3848eb86c40f756c4b "pkg/identity/api_key_test.go")

Show comments

[View file](/greenpau/go-authcrunch/blob/ecd3725baf2683eb1519bb3c81ae41085fbf7dc2/pkg/identity/api_key_test.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -21,6 +21,7 @@ import ( |
|  |  | "github.com/greenpau/go-authcrunch/internal/tests" |
|  |  | "github.com/greenpau/go-authcrunch/pkg/errors" |
|  |  | "github.com/greenpau/go-authcrunch/pkg/requests" |
|  |  | "github.com/greenpau/go-authcrunch/pkg/util" |
|  |  | ) |
|  |  |  |
|  |  | func TestNewAPIKey(t \*testing.T) { |
| Expand All | | @@ -37,7 +38,7 @@ func TestNewAPIKey(t \*testing.T) { |
|  |  | Key: requests.Key{ |
|  |  | Usage: "api", |
|  |  | Comment: "jsmith-api-key", |
|  |  | Payload: GetRandomStringFromRange(54, 72), |
|  |  | Payload: util.GetRandomStringFromRange(54, 72), |
|  |  | }, |
|  |  | }, |
|  |  | want: map[string]interface{}{ |
| Expand All | | @@ -53,7 +54,7 @@ func TestNewAPIKey(t \*testing.T) { |
|  |  | Usage: "api", |
|  |  | Comment: "jsmith-api-key", |
|  |  | Disabled: true, |
|  |  | Payload: GetRandomStringFromRange(54, 72), |
|  |  | Payload: util.GetRandomStringFromRange(54, 72), |
|  |  | }, |
|  |  | }, |
|  |  | want: map[string]interface{}{ |
| Expand Down  Expand Up | | @@ -91,7 +92,7 @@ func TestNewAPIKey(t \*testing.T) { |
|  |  | req: &requests.Request{ |
|  |  | Key: requests.Key{ |
|  |  | Comment: "jsmith-api-key", |
|  |  | Payload: GetRandomStringFromRange(54, 72), |
|  |  | Payload: util.GetRandomStringFromRange(54, 72), |
|  |  | Disabled: true, |
|  |  | }, |
|  |  | }, |
| Expand All | | @@ -104,7 +105,7 @@ func TestNewAPIKey(t \*testing.T) { |
|  |  | Key: requests.Key{ |
|  |  | Usage: "foo", |
|  |  | Comment: "jsmith-api-key", |
|  |  | Payload: GetRandomStringFromRange(54, 72), |
|  |  | Payload: util.GetRandomStringFromRange(54, 72), |
|  |  | Disabled: true, |
|  |  | }, |
|  |  | }, |
| Expand All | | @@ -116,7 +117,7 @@ func TestNewAPIKey(t \*testing.T) { |
|  |  | req: &requests.Request{ |
|  |  | Key: requests.Key{ |
|  |  | Usage: "api", |
|  |  | Payload: GetRandomStringFromRange(54, 72), |
|  |  | Payload: util.GetRandomStringFromRange(54, 72), |
|  |  | Disabled: true, |
|  |  | }, |
|  |  | }, |
| Expand Down | |  |

3 changes: 2 additions & 1 deletion

3
[pkg/identity/database.go](#diff-e4aeac1e553a4c90256098feeba281ed30f845b88f1a8c8eaf644c4a8f6e3a40 "pkg/identity/database.go")

Show comments

[View file](/greenpau/go-authcrunch/blob/ecd3725baf2683eb1519bb3c81ae41085fbf7dc2/pkg/identity/database.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -20,6 +20,7 @@ import ( |
|  |  | "github.com/greenpau/go-authcrunch/internal/utils" |
|  |  | "github.com/greenpau/go-authcrunch/pkg/errors" |
|  |  | "github.com/greenpau/go-authcrunch/pkg/requests" |
|  |  | "github.com/greenpau/go-authcrunch/pkg/util" |
|  |  | "github.com/greenpau/versioned" |
|  |  | "io/ioutil" |
|  |  | "os" |
| Expand Down  Expand Up | | @@ -566,7 +567,7 @@ func (db \*Database) AddAPIKey(r \*requests.Request) error { |
|  |  | if err != nil { |
|  |  | return errors.ErrAddAPIKey.WithArgs(r.Key.Usage, err) |
|  |  | } |
|  |  | s := GetRandomStringFromRange(72, 96) |
|  |  | s := util.GetRandomStringFromRange(72, 96) |
|  |  | failCount := 0 |
|  |  | for { |
|  |  | hk, err := NewPassword(s) |
| Expand Down | |  |

3 changes: 2 additions & 1 deletion

3
[pkg/identity/mfa\_token.go](#diff-da9019048d311aaed070db03383f8e82a1e15ecc543f7a90983f43fc5c84082a "pkg/identity/mfa_token.go")

Show comments

[View file](/greenpau/go-authcrunch/blob/ecd3725baf2683eb1519bb3c81ae41085fbf7dc2/pkg/identity/mfa_token.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -36,6 +36,7 @@ import ( |
|  |  |  |
|  |  | "github.com/greenpau/go-authcrunch/pkg/errors" |
|  |  | "github.com/greenpau/go-authcrunch/pkg/requests" |
|  |  | "github.com/greenpau/go-authcrunch/pkg/util" |
|  |  | ) |
|  |  |  |
|  |  | // MfaTokenBundle is a collection of public keys. |
| Expand Down  Expand Up | | @@ -99,7 +100,7 @@ func (b \*MfaTokenBundle) Size() int { |
|  |  | // NewMfaToken returns an instance of MfaToken. |
|  |  | func NewMfaToken(req \*requests.Request) (\*MfaToken, error) { |
|  |  | p := &MfaToken{ |
|  |  | ID: GetRandomString(40), |
|  |  | ID: util.GetRandomString(40), |
|  |  | CreatedAt: time.Now().UTC(), |
|  |  | Parameters: make(map[string]string), |
|  |  | Flags: make(map[string]bool), |
| Expand Down | |  |

3 changes: 2 additions & 1 deletion

3
[pkg/identity/public\_key.go](#diff-b07ef0ae91bf0f22ec5b199a58ed6b149bd75feb3f34671b6e49afcec2ba37bc "pkg/identity/public_key.go")

Show comments

[View file](/greenpau/go-authcrunch/blob/ecd3725baf2683eb1519bb3c81ae41085fbf7dc2/pkg/identity/public_key.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -24,6 +24,7 @@ import ( |
|  |  | "fmt" |
|  |  | "github.com/greenpau/go-authcrunch/pkg/errors" |
|  |  | "github.com/greenpau/go-authcrunch/pkg/requests" |
|  |  | "github.com/greenpau/go-authcrunch/pkg/util" |
|  |  | "golang.org/x/crypto/openpgp" |
|  |  | "golang.org/x/crypto/ssh" |
|  |  | "strconv" |
| Expand Down  Expand Up | | @@ -87,7 +88,7 @@ func (b \*PublicKeyBundle) Size() int { |
|  |  | func NewPublicKey(r \*requests.Request) (\*PublicKey, error) { |
|  |  | p := &PublicKey{ |
|  |  | Comment: r.Key.Comment, |
|  |  | ID: GetRandomString(40), |
|  |  | ID: util.GetRandomString(40), |
|  |  | Payload: r.Key.Payload, |
|  |  | Usage: r.Key.Usage, |
|  |  | CreatedAt: time.Now().UTC(), |
| Expand Down | |  |

55 changes: 0 additions & 55 deletions

55
[pkg/identity/random.go](#diff-2001a3db9277ce74c851468fc01e40f8020a741c63340634a990adb74f93f35b "pkg/identity/random.go")

Show comments

[View file](/greenpau/go-authcrunch/blob/e626f47f4b47792b8edab8ebfbe75ae7aa44d8ac/pkg/identity/random.go)
Edit file

Delete file

Load diff

This file was deleted.

Oops, something went wrong.

Retry

50 changes: 35 additions & 15 deletions

50
[pkg/util/random.go](#diff-cc1b29f85e2be9d2747df497dd4e4eb80e6ee58417ae75926194ece458ff49d8 "pkg/util/random.go")

Show comments

[View file](/greenpau/go-authcrunch/blob/ecd3725baf2683eb1519bb3c81ae41085fbf7dc2/pkg/util/random.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -15,9 +15,12 @@ |
|  |  | package util |
|  |  |  |
|  |  | import ( |
|  |  | "crypto/rand" |
|  |  | "encoding/base32" |
|  |  | "math/rand" |
|  |  | "time" |
|  |  | "io" |
|  |  | // "math" |
|  |  | "math/big" |
|  |  | mathrand "math/rand" |
|  |  | "unicode" |
|  |  | ) |
|  |  |  |
| Expand All | | @@ -33,15 +36,32 @@ var charsetTable = &unicode.RangeTable{ |
|  |  | LatinOffset: 1, |
|  |  | } |
|  |  |  |
|  |  | var seed \*rand.Rand = rand.New( |
|  |  | rand.NewSource(time.Now().UnixNano()), |
|  |  | ) |
|  |  | func genRandInt(i int) uint32 { |
|  |  | n, err := rand.Int(rand.Reader, big.NewInt(int64(i))) |
|  |  | if err != nil { |
|  |  | return uint32(mathrand.Intn(i)) |
|  |  | } |
|  |  | //if n.Uint64() > math.MaxUint32+1 { |
|  |  | // return uint32(n.Uint64() & uint32(0xFFFFFFFF)) |
|  |  | //} |
|  |  | return uint32(n.Uint64()) |
|  |  | } |
|  |  |  |
|  |  | func gen(length int, charset string) string { |
|  |  | func gen(length uint32, charset string) string { |
|  |  | charsetLen := byte(len(charset)) |
|  |  | b := make([]byte, length) |
|  |  | for i := range b { |
|  |  | b[i] = charset[seed.Intn(len(charset))] |
|  |  | if \_, err := io.ReadFull(rand.Reader, b); err != nil { |
|  |  | // for i uint32 := 0; i < length; i++ { |
|  |  | for i := uint32(0); i < length; { |
|  |  | b[i] = charset[mathrand.Intn(len(charset))] |
|  |  | } |
|  |  | return string(b) |
|  |  | } |
|  |  |  |
|  |  | for i, char := range b { |
|  |  | b[i] = byte(charset[char%charsetLen]) |
|  |  | } |
|  |  |  |
|  |  | return string(b) |
|  |  | } |
|  |  |  |
| Expand All | | @@ -50,17 +70,17 @@ func GetRandomString(i int) string { |
|  |  | if i < 1 { |
|  |  | i = 40 |
|  |  | } |
|  |  | return gen(i, charset) |
|  |  | return gen(uint32(i), charset) |
|  |  | } |
|  |  |  |
|  |  | // GetRandomStringFromRange generates random string of a random length. The |
|  |  | // random lenght is bounded by a and b. |
|  |  | func GetRandomStringFromRange(a, b int) string { |
|  |  | var i int |
|  |  | var i uint32 |
|  |  | if a > b { |
|  |  | i = rand.Intn(a-b) + b |
|  |  | i = genRandInt(a-b) + uint32(b) |
|  |  | } else { |
|  |  | i = rand.Intn(b-a) + a |
|  |  | i = genRandInt(b-a) + uint32(a) |
|  |  | } |
|  |  | return gen(i, charset) |
|  |  | } |
| Expand All | | @@ -75,11 +95,11 @@ func GetRandomEncodedStringFromRange(a, b int) string { |
|  |  | // GetRandomStringFromRangeWithCharset generates random string of a random length. The |
|  |  | // random lenght is bounded by a and b. The charset is provided. |
|  |  | func GetRandomStringFromRangeWithCharset(a, b int, cs string) string { |
|  |  | var i int |
|  |  | var i uint32 |
|  |  | if a > b { |
|  |  | i = rand.Intn(a-b) + b |
|  |  | i = genRandInt(a-b) + uint32(b) |
|  |  | } else { |
|  |  | i = rand.Intn(b-a) + a |
|  |  | i = genRandInt(b-a) + uint32(a) |
|  |  | } |
|  |  | return gen(i, cs) |
|  |  | } |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `ecd3725`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgreenpau%2Fgo-authcrunch%2Fcommit%2Fecd3725baf2683eb1519bb3c81ae41085fbf7dc2) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


