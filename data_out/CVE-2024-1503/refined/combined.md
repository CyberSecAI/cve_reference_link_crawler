=== Content from plugins.trac.wordpress.org_ea3409c4_20250111_112421.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Ftutor%2Ftrunk%2Fclasses%2FAdmin.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/tutor/trunk/classes/Admin.php?rev=3098465 "Revision 3098465")
* Next Revision →
* [Blame](/browser/tutor/trunk/classes/Admin.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/tutor/trunk/classes/Admin.php)

---

# [source:](/browser?order=name "Go to repository root") [tutor](/browser/tutor?order=name "View tutor")/[trunk](/browser/tutor/trunk?order=name "View trunk")/[classes](/browser/tutor/trunk/classes?order=name "View classes")/[Admin.php](/browser/tutor/trunk/classes/Admin.php?order=name "View Admin.php")

View diff against:

View revision:

| [Last change](/changeset/3192885/tutor/trunk/classes/Admin.php "View differences") on this file was [3192885](/changeset/3192885/ "View changeset 3192885"), checked in by themeum, [7 weeks ago](/timeline?from=2024-11-20T08%3A17%3A14Z&precision=second "See timeline at 11/20/2024 08:17:14 AM") |
| --- |
| Updated to 3.0.0 |
| **File size:** 21.4 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\*\* |
| [3](#L3) | \* Manage admin menu and plugin related logic |
| [4](#L4) | \* |
| [5](#L5) | \* @package Tutor |
| [6](#L6) | \* @author Themeum <support@themeum.com> |
| [7](#L7) | \* @link https://themeum.com |
| [8](#L8) | \* @since 1.0.0 |
| [9](#L9) | \*/ |
| [10](#L10) |  |
| [11](#L11) | namespace TUTOR; |
| [12](#L12) |  |
| [13](#L13) | use Tutor\Ecommerce\OrderController; |
| [14](#L14) | use Tutor\Helpers\HttpHelper; |
| [15](#L15) | use TUTOR\Input; |
| [16](#L16) | use Tutor\Traits\JsonResponse; |
| [17](#L17) |  |
| [18](#L18) | if ( ! defined( 'ABSPATH' ) ) { |
| [19](#L19) | exit; |
| [20](#L20) | } |
| [21](#L21) |  |
| [22](#L22) | /\*\* |
| [23](#L23) | \* Admin Class |
| [24](#L24) | \* |
| [25](#L25) | \* @since 1.0.0 |
| [26](#L26) | \*/ |
| [27](#L27) | class Admin { |
| [28](#L28) | use JsonResponse; |
| [29](#L29) |  |
| [30](#L30) | /\*\* |
| [31](#L31) | \* Constructor |
| [32](#L32) | \* |
| [33](#L33) | \* @since 1.0.0 |
| [34](#L34) | \* @return void |
| [35](#L35) | \*/ |
| [36](#L36) | public function \_\_construct() { |
| [37](#L37) |  |
| [38](#L38) | add\_action( 'admin\_notices', array( $this, 'show\_unstable\_version\_admin\_notice' ) ); |
| [39](#L39) |  |
| [40](#L40) | add\_action( 'admin\_menu', array( $this, 'register\_menu' ) ); |
| [41](#L41) | // Force activate menu for necessary. |
| [42](#L42) | add\_filter( 'parent\_file', array( $this, 'parent\_menu\_active' ) ); |
| [43](#L43) | add\_filter( 'submenu\_file', array( $this, 'submenu\_file\_active' ), 10, 2 ); |
| [44](#L44) |  |
| [45](#L45) | add\_action( 'admin\_init', array( $this, 'filter\_posts\_for\_instructors' ) ); |
| [46](#L46) | add\_action( 'load-post.php', array( $this, 'check\_if\_current\_users\_post' ) ); |
| [47](#L47) |  |
| [48](#L48) | add\_filter( 'plugin\_action\_links\_' . plugin\_basename( TUTOR\_FILE ), array( $this, 'plugin\_action\_links' ) ); |
| [49](#L49) |  |
| [50](#L50) | // Plugin Row Meta. |
| [51](#L51) | add\_filter( 'plugin\_row\_meta', array( $this, 'plugin\_row\_meta' ), 10, 2 ); |
| [52](#L52) |  |
| [53](#L53) | // Admin Footer Text. |
| [54](#L54) | add\_filter( 'admin\_footer\_text', array( $this, 'admin\_footer\_text' ), 1 ); |
| [55](#L55) | // Register Course Widget. |
| [56](#L56) | add\_action( 'widgets\_init', array( $this, 'register\_course\_widget' ) ); |
| [57](#L57) |  |
| [58](#L58) | // Handle flash toast message for redirect\_to util helper. |
| [59](#L59) | add\_action( 'admin\_head', array( new Utils(), 'handle\_flash\_message' ), 999 ); |
| [60](#L60) | // add\_action( 'tutor\_after\_settings\_menu', '\TUTOR\WhatsNew::whats\_new\_menu', 11 ); |
| [61](#L61) |  |
| [62](#L62) | add\_action( 'admin\_bar\_menu', array( $this, 'add\_toolbar\_items' ), 100 ); |
| [63](#L63) |  |
| [64](#L64) | add\_action( 'wp\_ajax\_tutor\_do\_not\_show\_feature\_page', array( $this, 'handle\_do\_not\_show\_feature\_page' ) ); |
| [65](#L65) | } |
| [66](#L66) |  |
| [67](#L67) | /\*\* |
| [68](#L68) | \* Show unstable version notice. |
| [69](#L69) | \* |
| [70](#L70) | \* @since 3.0.0 |
| [71](#L71) | \* |
| [72](#L72) | \* @return void |
| [73](#L73) | \*/ |
| [74](#L74) | public function show\_unstable\_version\_admin\_notice() { |
| [75](#L75) | $version = tutor\_utils()->extract\_version\_details( TUTOR\_VERSION ); |
| [76](#L76) | if ( ! $version->is\_stable ) { |
| [77](#L77) | /\* translators: %s: version name \*/ |
| [78](#L78) | $message = sprintf( \_\_( 'You\'re currently using Tutor LMS %s. To ensure stability, please do not use it on a live site.', 'tutor' ), '<strong>' . $version->version . '</strong>' ); |
| [79](#L79) | ?> |
| [80](#L80) | <div class="notice notice-warning"> |
| [81](#L81) | <p><strong><?php esc\_html\_e( 'Warning!', 'tutor' ); ?></strong></p> |
| [82](#L82) | <p><?php echo wp\_kses\_post( $message ); ?></p> |
| [83](#L83) | </div> |
| [84](#L84) | <?php |
| [85](#L85) | } |
| [86](#L86) | } |
| [87](#L87) |  |
| [88](#L88) | /\*\* |
| [89](#L89) | \* Register admin menus |
| [90](#L90) | \* |
| [91](#L91) | \* @since 1.0.0 |
| [92](#L92) | \* @return void |
| [93](#L93) | \*/ |
| [94](#L94) | public function register\_menu() { |
| [95](#L95) | $has\_pro = tutor()->has\_pro; |
| [96](#L96) |  |
| [97](#L97) | $unanswered\_questions = tutor\_utils()->unanswered\_question\_count(); |
| [98](#L98) | $unanswered\_bubble    = ''; |
| [99](#L99) | if ( $unanswered\_questions ) { |
| [100](#L100) | $unanswered\_bubble = '<span class="update-plugins count-' . $unanswered\_questions . '"><span class="plugin-count">' . $unanswered\_questions . '</span></span>'; |
| [101](#L101) | } |
| [102](#L102) |  |
| [103](#L103) | $course\_post\_type = tutor()->course\_post\_type; |
| [104](#L104) |  |
| [105](#L105) | $pro\_text = ''; |
| [106](#L106) | if ( $has\_pro ) { |
| [107](#L107) | $pro\_text = ' ' . \_\_( 'Pro', 'tutor' ); |
| [108](#L108) | } |
| [109](#L109) |  |
| [110](#L110) | $enable\_course\_marketplace = (bool) tutor\_utils()->get\_option( 'enable\_course\_marketplace' ); |
| [111](#L111) |  |
| [112](#L112) | $welcome = Tutor\_Setup::is\_welcome\_page\_visited(); |
| [113](#L113) |  |
| [114](#L114) | $root\_page = array( $this, 'tutor\_course\_list' ); |
| [115](#L115) | if ( false === $welcome && Input::has( 'page' ) && 'tutor' === Input::get( 'page' ) && Input::has( 'welcome' ) ) { |
| [116](#L116) | $root\_page = array( $this, 'welcome\_page' ); |
| [117](#L117) | } |
| [118](#L118) |  |
| [119](#L119) | $icon\_base64\_uri = 'data:image/svg+xml;base64,' . base64\_encode( '<svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 1139"><defs/><path fill-rule="evenodd" clip-rule="evenodd" d="M341.652 622.4c-23.412 0-43.222-19.8-43.222-43.2v-99c0-23.4 19.81-43.2 43.222-43.2 23.412 0 43.222 19.8 43.222 43.2v99c0 23.4-18.009 43.2-43.222 43.2 1.801 0 1.801 0 0 0zM655.01 622.4c-23.412 0-43.222-18-43.222-43.2v-99c0-23.4 19.81-43.2 43.222-43.2 23.412 0 43.222 19.8 43.222 43.2v99c0 25.2-19.81 43.2-43.222 43.2z" fill="#9DA2A8"/><path fill-rule="evenodd" clip-rule="evenodd" d="M255.204 406.4c18.009-37.8 54.028-63 95.449-63 61.231 1.8 108.055 52.2 106.254 113.4v203.4c3.602 21.6 23.412 37.8 45.023 34.2 18.009-1.8 32.416-16.2 34.217-34.2V455c-1.801-61.2 46.824-111.6 106.254-113.4 39.621 0 75.639 21.6 93.648 59.4 68.435 133.2 14.407 295.2-117.06 363.6C487.523 833 325.44 779 258.806 647.6c-39.62-75.6-39.62-165.6-3.602-241.2zM426.291 140h151.277v59.4c-25.212-5.4-52.226-9-77.439-9-25.213 0-50.426 3.6-75.639 7.2l1.801-57.6zm414.211 388.8c0-122.4-66.634-235.8-172.888-295.2V140h64.833c25.213 0 45.023-19.8 45.023-45s-21.611-45-45.023-45H271.413C246.2 51.8 226.39 71.6 226.39 96.8c0 25.2 19.81 45 45.023 45h66.633v91.8c-163.883 90-230.517 298.8-135.068 459 3.602 5.4-3.602-5.4 0 0C338.046 930.2 687.424 948.2 802.683 950c10.805 0 19.81-3.6 27.014-10.8 7.203-7.2 10.805-18 10.805-27V528.8z" fill="#9DA2A8"/></svg>' ); |
| [120](#L120) | $menu\_position   = 2; |
| [121](#L121) |  |
| [122](#L122) | add\_menu\_page( |
| [123](#L123) | \_\_( 'Tutor LMS', 'tutor' ) . $pro\_text, |
| [124](#L124) | \_\_( 'Tutor LMS', 'tutor' ) . $pro\_text, |
| [125](#L125) | 'manage\_tutor\_instructor', |
| [126](#L126) | 'tutor', |
| [127](#L127) | $root\_page, |
| [128](#L128) | $icon\_base64\_uri, |
| [129](#L129) | $menu\_position |
| [130](#L130) | ); |
| [131](#L131) |  |
| [132](#L132) | // Added @since v2.0.0. |
| [133](#L133) | add\_submenu\_page( 'tutor', \_\_( 'Courses', 'tutor' ), \_\_( 'Courses', 'tutor' ), 'manage\_tutor\_instructor', 'tutor', array( $this, 'tutor\_course\_list' ) ); |
| [134](#L134) |  |
| [135](#L135) | if ( '3.0.0' !== get\_option( 'tutor-new-feature' ) ) { |
| [136](#L136) | add\_submenu\_page( 'tutor', \_\_( 'What\'s New in 3.0', 'tutor' ), sprintf( '<span class="tutor-new-feature tutor-text-orange">%s</span>', \_\_( 'What\'s New in 3.0', 'tutor' ) ), 'manage\_tutor', 'tutor-new-feature', array( $this, 'feature\_promotion\_page' ) ); |
| [137](#L137) | } |
| [138](#L138) |  |
| [139](#L139) | // Ecommerce menu @since 3.0.0. |
| [140](#L140) | do\_action( 'tutor\_after\_courses\_admin\_menu' ); |
| [141](#L141) |  |
| [142](#L142) | add\_submenu\_page( 'tutor', \_\_( 'Create Course', 'tutor' ), \_\_( '<span class="tutor-create-course">Create Course</span>', 'tutor' ), 'manage\_tutor\_instructor', 'create-course', '\_\_return\_true' ); |
| [143](#L143) |  |
| [144](#L144) | // Extendable action hook @since 2.2.0. |
| [145](#L145) | do\_action( 'tutor\_after\_courses\_menu' ); |
| [146](#L146) |  |
| [147](#L147) | add\_submenu\_page( 'tutor', \_\_( 'Categories', 'tutor' ), \_\_( 'Categories', 'tutor' ), 'manage\_tutor', 'edit-tags.php?taxonomy=course-category&post\_type=' . $course\_post\_type, null ); |
| [148](#L148) |  |
| [149](#L149) | add\_submenu\_page( 'tutor', \_\_( 'Tags', 'tutor' ), \_\_( 'Tags', 'tutor' ), 'manage\_tutor', 'edit-tags.php?taxonomy=course-tag&post\_type=' . $course\_post\_type, null ); |
| [150](#L150) |  |
| [151](#L151) | add\_submenu\_page( 'tutor', \_\_( 'Students', 'tutor' ), \_\_( 'Students', 'tutor' ), 'manage\_tutor', Students\_List::STUDENTS\_LIST\_PAGE, array( $this, 'tutor\_students' ) ); |
| [152](#L152) |  |
| [153](#L153) | if ( $enable\_course\_marketplace ) { |
| [154](#L154) | add\_submenu\_page( 'tutor', \_\_( 'Instructors', 'tutor' ), \_\_( 'Instructors', 'tutor' ), 'manage\_tutor', Instructors\_List::INSTRUCTOR\_LIST\_PAGE, array( $this, 'tutor\_instructors' ) ); |
| [155](#L155) | } |
| [156](#L156) |  |
| [157](#L157) | add\_submenu\_page( 'tutor', \_\_( 'Announcements', 'tutor' ), \_\_( 'Announcements', 'tutor' ), 'manage\_tutor\_instructor', 'tutor\_announcements', array( $this, 'tutor\_announcements' ) ); |
| [158](#L158) |  |
| [159](#L159) | add\_submenu\_page( 'tutor', \_\_( 'Q&A', 'tutor' ), \_\_( 'Q&A ', 'tutor' ) . $unanswered\_bubble, 'manage\_tutor\_instructor', Question\_Answers\_List::QUESTION\_ANSWER\_PAGE, array( $this, 'question\_answer' ) ); |
| [160](#L160) |  |
| [161](#L161) | add\_submenu\_page( 'tutor', \_\_( 'Quiz Attempts', 'tutor' ), \_\_( 'Quiz Attempts', 'tutor' ), 'manage\_tutor\_instructor', Quiz\_Attempts\_List::QUIZ\_ATTEMPT\_PAGE, array( $this, 'quiz\_attempts' ) ); |
| [162](#L162) |  |
| [163](#L163) | if ( $enable\_course\_marketplace ) { |
| [164](#L164) | add\_submenu\_page( 'tutor', \_\_( 'Withdraw Requests', 'tutor' ), \_\_( 'Withdraw Requests', 'tutor' ), 'manage\_tutor', Withdraw\_Requests\_List::WITHDRAW\_REQUEST\_LIST\_PAGE, array( $this, 'withdraw\_requests' ) ); |
| [165](#L165) | } |
| [166](#L166) |  |
| [167](#L167) | add\_submenu\_page( 'tutor', \_\_( 'Addons', 'tutor' ), \_\_( 'Addons', 'tutor' ), 'manage\_tutor', 'tutor-addons', array( $this, 'enable\_disable\_addons' ) ); |
| [168](#L168) |  |
| [169](#L169) | do\_action( 'tutor\_admin\_register' ); |
| [170](#L170) |  |
| [171](#L171) | add\_submenu\_page( 'tutor', \_\_( 'Tools', 'tutor' ), \_\_( 'Tools', 'tutor' ), 'manage\_tutor', 'tutor-tools', array( new \TUTOR\Tools\_V2(), 'load\_tools\_page' ) ); |
| [172](#L172) |  |
| [173](#L173) | add\_submenu\_page( 'tutor', \_\_( 'Settings', 'tutor' ), \_\_( 'Settings', 'tutor' ), 'manage\_tutor', 'tutor\_settings', array( new \TUTOR\Options\_V2(), 'load\_settings\_page' ) ); |
| [174](#L174) |  |
| [175](#L175) | do\_action( 'tutor\_after\_settings\_menu' ); |
| [176](#L176) |  |
| [177](#L177) | if ( ! $has\_pro ) { |
| [178](#L178) | add\_submenu\_page( 'tutor', \_\_( 'Upgrade to Pro', 'tutor' ), sprintf( '<span class="tutor-get-pro-text">%s</span>', \_\_( 'Upgrade to Pro', 'tutor' ) ), 'manage\_options', 'tutor-get-pro', array( $this, 'tutor\_get\_pro' ) ); |
| [179](#L179) | } |
| [180](#L180) | } |
| [181](#L181) |  |
| [182](#L182) | /\*\* |
| [183](#L183) | \* Welcome page opt-out |
| [184](#L184) | \* |
| [185](#L185) | \* @since 3.0.0 |
| [186](#L186) | \*/ |
| [187](#L187) | public function handle\_do\_not\_show\_feature\_page() { |
| [188](#L188) | tutor\_utils()->check\_nonce(); |
| [189](#L189) |  |
| [190](#L190) | if ( ! User::is\_admin() ) { |
| [191](#L191) | $this->json\_response( |
| [192](#L192) | tutor\_utils()->error\_message(), |
| [193](#L193) | null, |
| [194](#L194) | HttpHelper::STATUS\_BAD\_REQUEST |
| [195](#L195) | ); |
| [196](#L196) | } |
| [197](#L197) |  |
| [198](#L198) | update\_option( 'tutor-new-feature', '3.0.0' ); |
| [199](#L199) | $this->json\_response( \_\_( 'Success', 'tutor' ) ); |
| [200](#L200) | } |
| [201](#L201) |  |
| [202](#L202) | /\*\* |
| [203](#L203) | \* Show Feature Promotion Page for Free User. |
| [204](#L204) | \* |
| [205](#L205) | \* @since 2.2.0 |
| [206](#L206) | \* |
| [207](#L207) | \* @return void |
| [208](#L208) | \*/ |
| [209](#L209) | public function feature\_promotion\_page() { |
| [210](#L210) | include tutor()->path . 'views/pages/welcome.php'; |
| [211](#L211) | // include tutor()->path . 'views/pages/feature-promotion.php'; |
| [212](#L212) | } |
| [213](#L213) |  |
| [214](#L214) | /\*\* |
| [215](#L215) | \* Show students page |
| [216](#L216) | \* |
| [217](#L217) | \* @since 1.0.0 |
| [218](#L218) | \* @return void |
| [219](#L219) | \*/ |
| [220](#L220) | public function tutor\_students() { |
| [221](#L221) | include tutor()->path . 'views/pages/students.php'; |
| [222](#L222) | } |
| [223](#L223) |  |
| [224](#L224) | /\*\* |
| [225](#L225) | \* Show instructor page |
| [226](#L226) | \* |
| [227](#L227) | \* @since 1.0.0 |
| [228](#L228) | \* @return void |
| [229](#L229) | \*/ |
| [230](#L230) | public function tutor\_instructors() { |
| [231](#L231) | include tutor()->path . 'views/pages/instructors.php'; |
| [232](#L232) | } |
| [233](#L233) |  |
| [234](#L234) | /\*\* |
| [235](#L235) | \* Show announcements page |
| [236](#L236) | \* |
| [237](#L237) | \* @since 1.0.0 |
| [238](#L238) | \* @return void |
| [239](#L239) | \*/ |
| [240](#L240) | public function tutor\_announcements() { |
| [241](#L241) | include tutor()->path . 'views/pages/announcements.php'; |
| [242](#L242) | } |
| [243](#L243) |  |
| [244](#L244) | /\*\* |
| [245](#L245) | \* Show Q&A page |
| [246](#L246) | \* |
| [247](#L247) | \* @since 1.0.0 |
| [248](#L248) | \* @return void |
| [249](#L249) | \*/ |
| [250](#L250) | public function question\_answer() { |
| [251](#L251) | include tutor()->path . 'views/pages/question\_answer.php'; |
| [252](#L252) | } |
| [253](#L253) |  |
| [254](#L254) | /\*\* |
| [255](#L255) | \* Show quiz attempts page |
| [256](#L256) | \* |
| [257](#L257) | \* @since 1.0.0 |
| [258](#L258) | \* @return void |
| [259](#L259) | \*/ |
| [260](#L260) | public function quiz\_attempts() { |
| [261](#L261) | include tutor()->path . 'views/pages/quiz\_attempts.php'; |
| [262](#L262) | } |
| [263](#L263) |  |
| [264](#L264) | /\*\* |
| [265](#L265) | \* Show the withdraw requests table |
| [266](#L266) | \* |
| [267](#L267) | \* @since 1.2.0 |
| [268](#L268) | \* @return void |
| [269](#L269) | \*/ |
| [270](#L270) | public function withdraw\_requests() { |
| [271](#L271) | include tutor()->path . 'views/pages/withdraw\_requests.php'; |
| [272](#L272) | } |
| [273](#L273) |  |
| [274](#L274) | /\*\* |
| [275](#L275) | \* Enable or disable addons |
| [276](#L276) | \* |
| [277](#L277) | \* @since 1.0.0 |
| [278](#L278) | \* @return void |
| [279](#L279) | \*/ |
| [280](#L280) | public function enable\_disable\_addons() { |
| [281](#L281) |  |
| [282](#L282) | if ( defined( 'TUTOR\_PRO\_VERSION' ) ) { |
| [283](#L283) | include tutor()->path . 'views/pages/enable\_disable\_addons.php'; |
| [284](#L284) | } else { |
| [285](#L285) | include tutor()->path . 'views/pages/tutor-pro-addons.php'; |
| [286](#L286) | } |
| [287](#L287) | } |
| [288](#L288) |  |
| [289](#L289) | /\*\* |
| [290](#L290) | \* Tutor tools page (OLD) |
| [291](#L291) | \* |
| [292](#L292) | \* @since 1.0.0 |
| [293](#L293) | \* @return void |
| [294](#L294) | \*/ |
| [295](#L295) | public function tutor\_tools\_old() { |
| [296](#L296) | $tutor\_admin\_tools\_page = Input::get( 'tutor\_admin\_tools\_page' ); |
| [297](#L297) | if ( $tutor\_admin\_tools\_page ) { |
| [298](#L298) | include apply\_filters( 'tutor\_admin\_tools\_page', tutor()->path . "views/pages/{$tutor\_admin\_tools\_page}.php", $tutor\_admin\_tools\_page ); |
| [299](#L299) | } else { |
| [300](#L300) | $pages = apply\_filters( |
| [301](#L301) | 'tutor\_tool\_pages', |
| [302](#L302) | array( |
| [303](#L303) | 'tutor\_pages' => array( 'title' => \_\_( 'Tutor Pages', 'tutor' ) ), |
| [304](#L304) | 'status'      => \_\_( 'Status', 'tutor' ), |
| [305](#L305) | ) |
| [306](#L306) | ); |
| [307](#L307) |  |
| [308](#L308) | $current\_page   = 'tutor\_pages'; |
| [309](#L309) | $requested\_page = Input::get( 'sub\_page' ); |
| [310](#L310) | if ( $requested\_page ) { |
| [311](#L311) | $current\_page = $requested\_page; |
| [312](#L312) | } |
| [313](#L313) |  |
| [314](#L314) | $current\_page = str\_replace( '/', '', $current\_page ); |
| [315](#L315) | $current\_page = str\_replace( '.', '', $current\_page ); |
| [316](#L316) | $current\_page = str\_replace( '\\', '', $current\_page ); |
| [317](#L317) | $current\_page = trim( $current\_page ); |
| [318](#L318) |  |
| [319](#L319) | include tutor()->path . 'views/pages/tools.php'; |
| [320](#L320) | } |
| [321](#L321) | } |
| [322](#L322) |  |
| [323](#L323) | /\*\* |
| [324](#L324) | \* Show pro upgrade page |
| [325](#L325) | \* |
| [326](#L326) | \* @since 1.0.0 |
| [327](#L327) | \* @return void |
| [328](#L328) | \*/ |
| [329](#L329) | public function tutor\_get\_pro() { |
| [330](#L330) | include tutor()->path . 'views/pages/get-pro.php'; |
| [331](#L331) | } |
| [332](#L332) |  |
| [333](#L333) | /\*\* |
| [334](#L334) | \* Parent menu active |
| [335](#L335) | \* |
| [336](#L336) | \* @since 1.0.0 |
| [337](#L337) | \* |
| [338](#L338) | \* @param string $parent\_file parent file. |
| [339](#L339) | \* @return string |
| [340](#L340) | \*/ |
| [341](#L341) | public function parent\_menu\_active( $parent\_file ) { |
| [342](#L342) | $taxonomy = Input::get( 'taxonomy' ); |
| [343](#L343) | if ( 'course-category' === $taxonomy || 'course-tag' === $taxonomy ) { |
| [344](#L344) | return 'tutor'; |
| [345](#L345) | } |
| [346](#L346) |  |
| [347](#L347) | return $parent\_file; |
| [348](#L348) | } |
| [349](#L349) |  |
| [350](#L350) | /\*\* |
| [351](#L351) | \* Sub-menu active |
| [352](#L352) | \* |
| [353](#L353) | \* @since 1.0.0 |
| [354](#L354) | \* |
| [355](#L355) | \* @param string $submenu\_file submenu file. |
| [356](#L356) | \* @param string $parent\_file parent file. |
| [357](#L357) | \* |
| [358](#L358) | \* @return string |
| [359](#L359) | \*/ |
| [360](#L360) | public function submenu\_file\_active( $submenu\_file, $parent\_file ) { |
| [361](#L361) | $taxonomy         = Input::get( 'taxonomy' ); |
| [362](#L362) | $course\_post\_type = tutor()->course\_post\_type; |
| [363](#L363) |  |
| [364](#L364) | if ( 'course-category' === $taxonomy ) { |
| [365](#L365) | return 'edit-tags.php?taxonomy=course-category&post\_type=' . $course\_post\_type; |
| [366](#L366) | } |
| [367](#L367) | if ( 'course-tag' === $taxonomy ) { |
| [368](#L368) | return 'edit-tags.php?taxonomy=course-tag&post\_type=' . $course\_post\_type; |
| [369](#L369) | } |
| [370](#L370) |  |
| [371](#L371) | return $submenu\_file; |
| [372](#L372) | } |
| [373](#L373) |  |
| [374](#L374) | /\*\* |
| [375](#L375) | \* Filter posts for instructor |
| [376](#L376) | \* |
| [377](#L377) | \* @since 1.0.0 |
| [378](#L378) | \* @return void |
| [379](#L379) | \*/ |
| [380](#L380) | public function filter\_posts\_for\_instructors() { |
| [381](#L381) | if ( ! current\_user\_can( 'administrator' ) && current\_user\_can( tutor()->instructor\_role ) ) { |
| [382](#L382) | @remove\_menu\_page( 'edit-comments.php' ); // Comments. |
| [383](#L383) | add\_filter( 'posts\_clauses\_request', array( $this, 'posts\_clauses\_request' ) ); |
| [384](#L384) | } |
| [385](#L385) | } |
| [386](#L386) |  |
| [387](#L387) | /\*\* |
| [388](#L388) | \* Request for posts clauses |
| [389](#L389) | \* |
| [390](#L390) | \* @since 1.0.0 |
| [391](#L391) | \* |
| [392](#L392) | \* @param mixed $clauses clauses. |
| [393](#L393) | \* @return mixed |
| [394](#L394) | \*/ |
| [395](#L395) | public function posts\_clauses\_request( $clauses ) { |
| [396](#L396) |  |
| [397](#L397) | if ( ! is\_admin() || ( ! Input::has( 'post\_type' ) || Input::get( 'post\_type' ) != tutor()->course\_post\_type ) || tutor\_utils()->has\_user\_role( array( 'administrator', 'editor' ) ) ) { |
| [398](#L398) | return $clauses; |
| [399](#L399) | } |
| [400](#L400) |  |
| [401](#L401) | // Need multi instructor check. |
| [402](#L402) | global $wpdb; |
| [403](#L403) |  |
| [404](#L404) | $user\_id = get\_current\_user\_id(); |
| [405](#L405) |  |
| [406](#L406) | $get\_assigned\_courses\_ids = $wpdb->get\_col( $wpdb->prepare( "SELECT meta\_value from {$wpdb->usermeta} WHERE meta\_key = '\_tutor\_instructor\_course\_id' AND user\_id = %d", $user\_id ) ); |
| [407](#L407) | $own\_courses              = is\_array( $get\_assigned\_courses\_ids ) ? $get\_assigned\_courses\_ids : array(); |
| [408](#L408) |  |
| [409](#L409) | $in\_query\_pre   = count( $own\_courses ) ? implode( ',', $own\_courses ) : null; |
| [410](#L410) | $in\_query\_where = $in\_query\_pre ? " OR {$wpdb->posts}.ID IN({$in\_query\_pre})" : ''; |
| [411](#L411) |  |
| [412](#L412) | $course\_post\_type    = tutor()->course\_post\_type; |
| [413](#L413) | $custom\_author\_query = "  AND ({$wpdb->posts}.post\_type!='{$course\_post\_type}' OR {$wpdb->posts}.post\_author = {$user\_id}) {$in\_query\_where}"; |
| [414](#L414) |  |
| [415](#L415) | $clauses['where'] .= $custom\_author\_query; |
| [416](#L416) |  |
| [417](#L417) | return $clauses; |
| [418](#L418) | } |
| [419](#L419) |  |
| [420](#L420) | /\*\* |
| [421](#L421) | \* Prevent unauthorised course/lesson edit page by direct URL |
| [422](#L422) | \* |
| [423](#L423) | \* @since 1.0.0 |
| [424](#L424) | \* @return void |
| [425](#L425) | \*/ |
| [426](#L426) | public function check\_if\_current\_users\_post() { |
| [427](#L427) | if ( current\_user\_can( 'administrator' ) || ! current\_user\_can( tutor()->instructor\_role ) ) { |
| [428](#L428) | return; |
| [429](#L429) | } |
| [430](#L430) |  |
| [431](#L431) | if ( ! empty( Input::get( 'post' ) ) ) { |
| [432](#L432) | $get\_post\_id      = Input::get( 'post', Input::TYPE\_INT ); |
| [433](#L433) | $get\_post         = get\_post( $get\_post\_id ); |
| [434](#L434) | $tutor\_post\_types = array( tutor()->course\_post\_type, tutor()->lesson\_post\_type ); |
| [435](#L435) |  |
| [436](#L436) | $current\_user = get\_current\_user\_id(); |
| [437](#L437) |  |
| [438](#L438) | if ( in\_array( $get\_post->post\_type, $tutor\_post\_types ) && $get\_post->post\_author != $current\_user ) { |
| [439](#L439) | global $wpdb; |
| [440](#L440) |  |
| [441](#L441) | $get\_assigned\_courses\_ids = (int) $wpdb->get\_var( |
| [442](#L442) | $wpdb->prepare( |
| [443](#L443) | "SELECT user\_id |
| [444](#L444) | from {$wpdb->usermeta} |
| [445](#L445) | WHERE user\_id = %d AND meta\_key = '\_tutor\_instructor\_course\_id' AND meta\_value = %d ", |
| [446](#L446) | $current\_user, |
| [447](#L447) | $get\_post\_id |
| [448](#L448) | ) |
| [449](#L449) | ); |
| [450](#L450) |  |
| [451](#L451) | if ( ! $get\_assigned\_courses\_ids ) { |
| [452](#L452) | wp\_die( esc\_html\_\_( 'Permission Denied', 'tutor' ) ); |
| [453](#L453) | } |
| [454](#L454) | } |
| [455](#L455) | } |
| [456](#L456) | } |
| [457](#L457) |  |
| [458](#L458) | /\*\* |
| [459](#L459) | \* Scan template files |
| [460](#L460) | \* |
| [461](#L461) | \* @since 1.0.0 |
| [462](#L462) | \* |
| [463](#L463) | \* @param string $template\_path template file path. |
| [464](#L464) | \* @return array |
| [465](#L465) | \*/ |
| [466](#L466) | public static function scan\_template\_files( $template\_path = null ) { |
| [467](#L467) | if ( ! $template\_path ) { |
| [468](#L468) | $template\_path = tutor()->path . 'templates/'; |
| [469](#L469) | } |
| [470](#L470) |  |
| [471](#L471) | $files  = @scandir($template\_path); // @codingStandardsIgnoreLine. |
| [472](#L472) | $result = array(); |
| [473](#L473) |  |
| [474](#L474) | if ( ! empty( $files ) ) { |
| [475](#L475) | foreach ( $files as $key => $value ) { |
| [476](#L476) | if ( ! in\_array( $value, array( '.', '..', '.DS\_Store' ), true ) ) { |
| [477](#L477) | if ( is\_dir( $template\_path . DIRECTORY\_SEPARATOR . $value ) ) { |
| [478](#L478) | $sub\_files = self::scan\_template\_files( $template\_path . DIRECTORY\_SEPARATOR . $value ); |
| [479](#L479) | foreach ( $sub\_files as $sub\_file ) { |
| [480](#L480) | $result[] = $value . DIRECTORY\_SEPARATOR . $sub\_file; |
| [481](#L481) | } |
| [482](#L482) | } else { |
| [483](#L483) | $result[] = $value; |
| [484](#L484) | } |
| [485](#L485) | } |
| [486](#L486) | } |
| [487](#L487) | } |
| [488](#L488) | return $result; |
| [489](#L489) | } |
| [490](#L490) |  |
| [491](#L491) | /\*\* |
| [492](#L492) | \* Get Template overridden files |
| [493](#L493) | \* |
| [494](#L494) | \* @since 1.0.0 |
| [495](#L495) | \* @return array |
| [496](#L496) | \*/ |
| [497](#L497) | public static function template\_overridden\_files() { |
| [498](#L498) | $template\_files = self::scan\_template\_files(); |
| [499](#L499) |  |
| [500](#L500) | $override\_files = array(); |
| [501](#L501) | foreach ( $template\_files as $file ) { |
| [502](#L502) | $file\_path = null; |
| [503](#L503) | if ( file\_exists( trailingslashit( get\_stylesheet\_directory() ) . tutor()->template\_path . $file ) ) { |
| [504](#L504) | $file\_path = $file; |
| [505](#L505) | } elseif ( file\_exists( trailingslashit( get\_template\_directory() ) . tutor()->template\_path . $file ) ) { |
| [506](#L506) | $file\_path = $file; |
| [507](#L507) | } |
| [508](#L508) |  |
| [509](#L509) | if ( $file\_path ) { |
| [510](#L510) | $override\_files[] = str\_replace( WP\_CONTENT\_DIR . '/themes/', '', $file\_path ); |
| [511](#L511) | } |
| [512](#L512) | } |
| [513](#L513) |  |
| [514](#L514) | return $override\_files; |
| [515](#L515) | } |
| [516](#L516) |  |
| [517](#L517) | /\*\* |
| [518](#L518) | \* Plugin activation link |
| [519](#L519) | \* |
| [520](#L520) | \* @since 1.0.0 |
| [521](#L521) | \* |
| [522](#L522) | \* @param array $actions action list. |
| [523](#L523) | \* @return array |
| [524](#L524) | \*/ |
| [525](#L525) | public function plugin\_action\_links( $actions ) { |
| [526](#L526) | $has\_pro = tutor()->has\_pro; |
| [527](#L527) |  |
| [528](#L528) | if ( ! $has\_pro ) { |
| [529](#L529) | $actions['tutor\_pro\_link'] = |
| [530](#L530) | '<a href="https://tutorlms.com/pricing?utm\_source=tutor\_plugin\_action\_link&utm\_medium=wordpress\_dashboard&utm\_campaign=go\_premium" target="\_blank"> |
| [531](#L531) | <span style="color: #ff7742; font-weight: bold;">' . |
| [532](#L532) | \_\_( 'Upgrade to Pro', 'wp-megamenu' ) . |
| [533](#L533) | '</span> |
| [534](#L534) | </a>'; |
| [535](#L535) | } |
| [536](#L536) |  |
| [537](#L537) | $actions['settings'] = '<a href="admin.php?page=tutor\_settings">' . \_\_( 'Settings', 'tutor' ) . '</a>'; |
| [538](#L538) |  |
| [539](#L539) | return $actions; |
| [540](#L540) | } |
| [541](#L541) |  |
| [542](#L542) | /\*\* |
| [543](#L543) | \* Add plugin meta data in WP plugins list page |
| [544](#L544) | \* |
| [545](#L545) | \* @since 1.0.0 |
| [546](#L546) | \* |
| [547](#L547) | \* @param array  $plugin\_meta plugin meta data. |
| [548](#L548) | \* @param string $plugin\_file plugin file. |
| [549](#L549) | \* |
| [550](#L550) | \* @return array |
| [551](#L551) | \*/ |
| [552](#L552) | public function plugin\_row\_meta( $plugin\_meta, $plugin\_file ) { |
| [553](#L553) |  |
| [554](#L554) | if ( tutor()->basename === $plugin\_file ) { |
| [555](#L555) | $plugin\_meta[] = sprintf( |
| [556](#L556) | '<a href="%s">%s</a>', |
| [557](#L557) | esc\_url( 'https://docs.themeum.com/tutor-lms/?utm\_source=tutor&utm\_medium=plugins\_installation\_list&utm\_campaign=plugin\_docs\_link' ), |
| [558](#L558) | \_\_( '<strong style="color: #03bd24">Documentation</strong>', 'tutor' ) |
| [559](#L559) | ); |
| [560](#L560) | $plugin\_meta[] = sprintf( |
| [561](#L561) | '<a href="%s">%s</a>', |
| [562](#L562) | esc\_url( 'https://www.themeum.com/contact-us/?utm\_source=tutor&utm\_medium=plugins\_installation\_list&utm\_campaign=plugin\_support\_link' ), |
| [563](#L563) | \_\_( '<strong style="color: #03bd24">Get Support</strong>', 'tutor' ) |
| [564](#L564) | ); |
| [565](#L565) | } |
| [566](#L566) |  |
| [567](#L567) | return $plugin\_meta; |
| [568](#L568) | } |
| [569](#L569) |  |
| [570](#L570) | /\*\* |
| [571](#L571) | \* Add footer text only on tutor pages |
| [572](#L572) | \* |
| [573](#L573) | \* @since 1.0.0 |
| [574](#L574) | \* |
| [575](#L575) | \* @param string $footer\_text footer text. |
| [576](#L576) | \* @return string |
| [577](#L577) | \*/ |
| [578](#L578) | public function admin\_footer\_text( $footer\_text ) { |
| [579](#L579) | $current\_screen = get\_current\_screen(); |
| [580](#L580) |  |
| [581](#L581) | /\*\* |
| [582](#L582) | \* We are making sure that this message will be only on Tutor Admin page |
| [583](#L583) | \*/ |
| [584](#L584) | if ( apply\_filters( 'tutor\_display\_admin\_footer\_text', ( tutor\_utils()->array\_get( 'parent\_base', $current\_screen ) === 'tutor' ) ) ) { |
| [585](#L585) | $footer\_text = sprintf( |
| [586](#L586) | /\* translators: %s: plugin name \*/ |
| [587](#L587) | \_\_( 'If you like %1$s please leave us a %2$s rating. A huge thanks in advance!', 'tutor' ), |
| [588](#L588) | sprintf( '<strong>%s</strong>', esc\_html\_\_( 'Tutor LMS', 'tutor' ) ), |
| [589](#L589) | '<a href="https://wordpress.org/support/plugin/tutor/reviews?rate=5#new-post" target="\_blank" class="tutor-rating-link">&#9733;&#9733;&#9733;&#9733;&#9733;</a>' |
| [590](#L590) | ); |
| [591](#L591) | } |
| [592](#L592) |  |
| [593](#L593) | return $footer\_text; |
| [594](#L594) | } |
| [595](#L595) |  |
| [596](#L596) | /\*\* |
| [597](#L597) | \* Register course widget |
| [598](#L598) | \* |
| [599](#L599) | \* @since 1.0.0 |
| [600](#L600) | \* @return void |
| [601](#L601) | \*/ |
| [602](#L602) | public function register\_course\_widget() { |
| [603](#L603) | register\_widget( 'Tutor\Course\_Widget' ); |
| [604](#L604) | } |
| [605](#L605) |  |
| [606](#L606) | /\*\* |
| [607](#L607) | \* Tutor Course List |
| [608](#L608) | \* |
| [609](#L609) | \* @since 2.0.0 |
| [610](#L610) | \* @return void |
| [611](#L611) | \*/ |
| [612](#L612) | public function tutor\_course\_list() { |
| [613](#L613) | include tutor()->path . 'views/pages/course-list.php'; |
| [614](#L614) | } |
| [615](#L615) |  |
| [616](#L616) | /\*\* |
| [617](#L617) | \* Orders view page |
| [618](#L618) | \* |
| [619](#L619) | \* @since 3.0.0 |
| [620](#L620) | \* |
| [621](#L621) | \* @return void |
| [622](#L622) | \*/ |
| [623](#L623) | public function orders\_view() { |
| [624](#L624) | $current\_page = Input::get( 'page' ); |
| [625](#L625) | $action       = Input::get( 'action' ); |
| [626](#L626) |  |
| [627](#L627) | if ( OrderController::PAGE\_SLUG === $current\_page && 'edit' === $action ) { |
| [628](#L628) | ?> |
| [629](#L629) | <div class="tutor-admin-wrap tutor-order-details-wrapper"> |
| [630](#L630) | <div id="tutor-order-details-root"> |
| [631](#L631) | </div> |
| [632](#L632) | </div> |
| [633](#L633) | <?php |
| [634](#L634) | return; |
| [635](#L635) | } |
| [636](#L636) |  |
| [637](#L637) | include tutor()->path . 'views/pages/ecommerce/order-list.php'; |
| [638](#L638) | } |
| [639](#L639) |  |
| [640](#L640) | /\*\* |
| [641](#L641) | \* Coupons view page |
| [642](#L642) | \* |
| [643](#L643) | \* @since 3.0.0 |
| [644](#L644) | \* |
| [645](#L645) | \* @return void |
| [646](#L646) | \*/ |
| [647](#L647) | public function coupons\_view() { |
| [648](#L648) | $action = Input::get( 'action' ); |
| [649](#L649) | if ( in\_array( $action, array( 'add\_new', 'edit' ) ) ) { |
| [650](#L650) | ?> |
| [651](#L651) | <div class="tutor-admin-wrap"> |
| [652](#L652) | <div id="tutor-coupon-root"> |
| [653](#L653) | </div> |
| [654](#L654) | </div> |
| [655](#L655) | <?php |
| [656](#L656) | return; |
| [657](#L657) | } |
| [658](#L658) | include tutor()->path . 'views/pages/ecommerce/coupon-list.php'; |
| [659](#L659) | } |
| [660](#L660) |  |
| [661](#L661) | /\*\* |
| [662](#L662) | \* Show welcome page |
| [663](#L663) | \* |
| [664](#L664) | \* @since 1.0.0 |
| [665](#L665) | \* @return void |
| [666](#L666) | \*/ |
| [667](#L667) | public function welcome\_page() { |
| [668](#L668) | Tutor\_Setup::mark\_as\_visited(); |
| [669](#L669) | include tutor()->path . 'views/pages/welcome.php'; |
| [670](#L670) | exit; |
| [671](#L671) | } |
| [672](#L672) |  |
| [673](#L673) | /\*\* |
| [674](#L674) | \* Add toolbar items |
| [675](#L675) | \* |
| [676](#L676) | \* @since 1.4.6 |
| [677](#L677) | \* |
| [678](#L678) | \* @param \WP\_Admin\_Bar $admin\_bar admin bar object. |
| [679](#L679) | \* |
| [680](#L680) | \* @return mixed |
| [681](#L681) | \*/ |
| [682](#L682) | public function add\_toolbar\_items( \WP\_Admin\_Bar $admin\_bar ) { |
| [683](#L683) | global $post; |
| [684](#L684) |  |
| [685](#L685) | $course\_id        = Input::get( 'post', 0, Input::TYPE\_INT ); |
| [686](#L686) | $course\_post\_type = tutor()->course\_post\_type; |
| [687](#L687) |  |
| [688](#L688) | if ( ! tutor\_utils()->can\_user\_edit\_course( get\_current\_user\_id(), $course\_id ) ) { |
| [689](#L689) | return $admin\_bar; |
| [690](#L690) | } |
| [691](#L691) |  |
| [692](#L692) | if ( $admin\_bar->get\_node( 'new-courses' ) ) { |
| [693](#L693) | $args                = $admin\_bar->get\_node( 'new-courses' ); |
| [694](#L694) | $args->href          = '#'; |
| [695](#L695) | $args->meta['class'] = 'tutor-create-new-course'; |
| [696](#L696) | $admin\_bar->add\_node( $args ); |
| [697](#L697) | } |
| [698](#L698) |  |
| [699](#L699) | if ( |
| [700](#L700) | ( is\_admin() && $post && $course\_id && $post->post\_type === $course\_post\_type ) || |
| [701](#L701) | ( ! is\_admin() && is\_single() && $post && $course\_post\_type === $post->post\_type ) |
| [702](#L702) | ) { |
| [703](#L703) |  |
| [704](#L704) | $admin\_bar->add\_menu( |
| [705](#L705) | array( |
| [706](#L706) | 'id'    => 'edit', |
| [707](#L707) | 'title' => \_\_( 'Edit with Course Builder', 'tutor' ), |
| [708](#L708) | 'href'  => tutor\_utils()->course\_edit\_link( $post->ID ), |
| [709](#L709) | 'meta'  => array( |
| [710](#L710) | 'title'  => \_\_( 'Edit with Course Builder', 'tutor' ), |
| [711](#L711) | 'target' => '\_blank', |
| [712](#L712) | ), |
| [713](#L713) | ) |
| [714](#L714) | ); |
| [715](#L715) | } |
| [716](#L716) |  |
| [717](#L717) | return $admin\_bar; |
| [718](#L718) | } |
| [719](#L719) | } |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/tutor/trunk/classes/Admin.php?format=txt)
* [Original Format](/export/3220666/tutor/trunk/classes/Admin.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_062712d5_20250111_112422.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Tutor LMS – eLearning and online course solution <= 2.6.1 - Cross-Site Request Forgery to Plugin Deactivation and Data Erase

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Tutor LMS – eLearning and online course solution <= 2.6.1 - Cross-Site Request Forgery to Plugin Deactivation and Data Erase

4.3

**Cross-Site Request Forgery (CSRF)**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N)

| CVE | [CVE-2024-1503](https://www.cve.org/CVERecord?id=CVE-2024-1503) |
| --- | --- |
| CVSS | 4.3 (Medium) |
| Publicly Published | March 12, 2024 |
| Last Updated | March 12, 2024 |
| Researcher | [Lucio Sá](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/lucio-sa) |

### Description

The Tutor LMS – eLearning and online course solution plugin for WordPress is vulnerable to Cross-Site Request Forgery in all versions up to, and including, 2.6.1. This is due to missing or incorrect nonce validation on the erase\_tutor\_data() function. This makes it possible for unauthenticated attackers to deactivate the plugin and erase all data via a forged request granted they can trick a site administrator into performing an action such as clicking on a link. This requires the "Erase upon uninstallation" option to be enabled.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/tutor/trunk/classes/Admin.php#L465)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Ftutor%2Ftutor-lms-elearning-and-online-course-solution-261-cross-site-request-forgery-to-plugin-deactivation-and-data-erase&t=Tutor%20LMS%20%E2%80%93%20eLearning%20and%20online%20course%20solution%20%3C%3D%202.6.1%20-%20Cross-Site%20Request%20Forgery%20to%20Plugin%20Deactivation%20and%20Data%20Erase "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Ftutor%2Ftutor-lms-elearning-and-online-course-solution-261-cross-site-request-forgery-to-plugin-deactivation-and-data-erase&text=Tutor%20LMS%20%E2%80%93%20eLearning%20and%20online%20course%20solution%20%3C%3D%202.6.1%20-%20Cross-Site%20Request%20Forgery%20to%20Plugin%20Deactivation%20and%20Data%20Erase "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Ftutor%2Ftutor-lms-elearning-and-online-course-solution-261-cross-site-request-forgery-to-plugin-deactivation-and-data-erase "LinkedIn")
Email

## Vulnerability Details for Tutor LMS – eLearning and online course solution

#### [Tutor LMS – eLearning and online course solution](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/tutor)

| Software Type | Plugin |
| --- | --- |
| Software Slug | tutor [(view on wordpress.org)](https://wordpress.org/plugins/tutor) |
| Patched? | Yes |
| Remediation | Update to version 2.6.2, or a newer patched version |
| Affected Version | * <= 2.6.1 |
| Patched Version | * 2.6.2 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation


