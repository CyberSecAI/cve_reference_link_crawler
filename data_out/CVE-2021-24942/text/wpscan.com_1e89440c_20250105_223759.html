

[Skip to content](#wp--skip-link--target)

* [Features](https://a8cteam5105.wordpress.com/features/)
* [Pricing](https://a8cteam5105.wordpress.com/pricing/)
* Solutions
  + [Status](https://status.wpscan.com/)
  + [API Details](/api)
  + [CLI Scanner](https://a8cteam5105.wordpress.com/wordpress-cli-scanner/)
* Vulnerabilities
  + [Themes](/themes)
  + [WordPress](/wordpresses)
  + [Plugins](/plugins)
  + [Stats](/statistics)
  + [Submit Vulnerabilities](/submit)
  + [Leaderboard](/leaderboard)
* Resources
  + [Blog](/blog)
  + [Enterprise Features](https://a8cteam5105.wordpress.com/enterprise-customers-features/)
  + [How to Install WPScan](https://a8cteam5105.wordpress.com/how-to-install-wpscan/)
  + [WPScan Glossary](/wpscan-glossary)
  + [2024 Website Threat Report](https://wpscan.com/2023-website-threat-report/)

Search

## WordPress Plugin Vulnerabilities

# Menu Item Visibility Control <= 0.5 - Admin+ Arbitrary PHP Code Execution

### Description

The plugin doesn't sanitize and validate the "Visibility logic" option for WordPress menu items, which could allow highly privileged users to execute arbitrary PHP code even in a hardened environment.

### Proof of Concept

1. As an admin, go to "Appearance -> Menus" and create a menu with some items of your choice.
2. In the "Menu structure" click on any item (the arrow down on the right of 'Page') and locate "Visibility logic" field.
3. Add the following code in the field: file\_put\_contents('/var/www/hacked.php', '<?php echo "failed"; ?>')
4. After saving changes and navigating to the menu's location, the visibility logic triggers executing our payload.

### Affects Plugins

[![Plugin icon](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/plugin-icon.svg)

menu-items-visibility-control](https://a8cteam5105.wordpress.com/plugin/menu-items-visibility-control/)

![](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/x-icon.svg)
No known fix

### References

CVE
[CVE-2021-24942](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-24942)

### Classification

Type
RCE

OWASP top 10
[A1: Injection](https://www.owasp.org/index.php/Top_10-2017_A1-Injection)

CWE
[CWE-94](https://cwe.mitre.org/data/definitions/94.html)

CVSS
[6.6 (medium)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:L)

### Miscellaneous

Original Researcher
bl4derunner

Submitter
Anton Sarsadskikh

Verified
Yes

WPVDB ID
[eaa28832-74c1-4cd5-9b0f-02338e23b418](https://a8cteam5105.wordpress.com/vulnerability/eaa28832-74c1-4cd5-9b0f-02338e23b418/)

### Timeline

Publicly Published
2022-11-29 (about 2 years ago)

Added
2022-11-29 (about 2 years ago)

Last Updated
2022-11-29 (about 2 years ago)

### Other

Published
Title

Published
2024-04-05
Title
[Advanced Order Export For WooCommerce < 3.4.5 - Shop Manager+ Remote Code Execution](https://a8cteam5105.wordpress.com/vulnerability/9e1bc030-8327-43a7-b872-70159b53a05d/)

Published
2024-01-03
Title
[LearnPress < 4.2.5.8 - Unauthenticated Command Injection](https://a8cteam5105.wordpress.com/vulnerability/909580f4-1306-4e61-ac7d-e7a2eb0961f8/)

Published
2024-02-26
Title
[Slivery Extender <= 1.0.2 - Authenticated(Contributor+) Remote Code Execution via shortcode](https://a8cteam5105.wordpress.com/vulnerability/a0dcb2a7-29a7-4eca-9a11-2c010b1f63bd/)

Published
2024-09-24
Title
[Special Text Boxes < 6.2.5 - Unauthenticated Arbitrary Shortcode Execution](https://a8cteam5105.wordpress.com/vulnerability/2a2407fe-3743-47dc-8fd0-52f3043de376/)

Published
2019-03-25
Title
[Social Warfare <= 3.5.2 - Unauthenticated Remote Code Execution (RCE)](https://a8cteam5105.wordpress.com/vulnerability/7b412469-cc03-4899-b397-38580ced5618/)

![](https://wpscan.com/wp-content/uploads/2023/10/wpscan-logo-dark.png?w=246)

### Vulnerabilities

* [WordPress](/wordpresses)
* [Plugins](/plugins)
* [Themes](/themes)
* [Our Stats](https://a8cteam5105.wordpress.com/statistics/)
* [Submit vulnerabilities](https://a8cteam5105.wordpress.com/submit/)

#### About

* [How it works](/features)
* [Pricing](/pricing)
* [WordPress plugin](https://wordpress.org/plugins/wpscan/)
* [Blog](/blog)
* [Contact](/contact)

#### For Developers

* [Status](https://status.wpscan.com/)
* [API details](/api)
* [CLI scanner](/wordpress-cli-scanner)

#### Other

* [Privacy](https://automattic.com/privacy/)
* [Terms of service](/terms)
* [Submission terms](/submission-terms/)
* [Disclosure policy](/vulnerability-disclosure-policy)
* [Privacy Notice for California Users](https://automattic.com/privacy/#california-consumer-privacy-act-ccpa)

---

![](https://wpscan.com/wp-content/uploads/2023/08/frame-1323.png?w=48)

In partnership with [Jetpack](https://jetpack.com/)

* [GitHub](https://github.com/wpscanteam/wpscan/)
* [Twitter](https://twitter.com/_wpscan_)
* [Facebook](https://www.facebook.com/WPScan)

---

An

![](https://wpscan.com/wp-content/uploads/2023/08/autpmattic-logo.png?w=298)

endeavor

[Work With Us](https://automattic.com/work-with-us/)

[Press](https://automattic.com/press/)

* Subscribe
  Subscribed

  + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)

  Join 30,406 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
* Privacy
* + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)
  + [Edit Site](https://a8cteam5105.wordpress.com/wp-admin/site-editor.php?postType=wp_template&postId=a8c/wpscan//index)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wpscan.com)
  + [View site in Reader](https://wordpress.com/read/feeds/156197069)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

![](https://pixel.wp.com/b.gif?v=noscript)
