

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%3Fnew%3D3146287%2540newsletters-lite%26old%3D3146287%2540newsletters-lite)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/3139267/newsletters-lite "Changeset 3139267 for newsletters-lite")
* [Next Change](/changeset/3146297/newsletters-lite "Changeset 3146297 for newsletters-lite") →

---

# Changeset [3146287](/changeset/3146287 "Show full changeset") for [newsletters-lite](/browser/newsletters-lite?rev=3146287 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
09/04/2024 07:43:29 AM
([4 months](/timeline?from=2024-09-04T07%3A43%3A29Z&precision=second "See timeline at 09/04/2024 07:43:29 AM") ago)

Author:
mohsenr1
Message:

v 4.9.3

Location:
[newsletters-lite/trunk](/browser/newsletters-lite/trunk?rev=3146287)
Files:

3 edited

* [readme.txt](/browser/newsletters-lite/trunk/readme.txt?rev=3146287 "Show entry in browser")
  (modified)
  ([2 diffs](#file0 "Show differences"))
* [wp-mailinglist-plugin.php](/browser/newsletters-lite/trunk/wp-mailinglist-plugin.php?rev=3146287 "Show entry in browser")
  (modified)
  ([1 diff](#file1 "Show differences"))
* [wp-mailinglist.php](/browser/newsletters-lite/trunk/wp-mailinglist.php?rev=3146287 "Show entry in browser")
  (modified)
  ([3 diffs](#file2 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [newsletters-lite/trunk/readme.txt](/changeset/3146287/newsletters-lite/trunk/readme.txt "Show the changeset 3146287 restricted to newsletters-lite/trunk/readme.txt")

  | [r3139266](/browser/newsletters-lite/trunk/readme.txt?rev=3139266#L5 "Show revision 3139266 of this file in browser") | [r3146287](/browser/newsletters-lite/trunk/readme.txt?rev=3146287#L5 "Show revision 3146287 of this file in browser") |  |
  | --- | --- | --- |
  | 5 | 5 | Requires at least: 3.8 |
  | 6 | 6 | Tested up to: 6.6.1 |
  | 7 |  | Stable tag: 4.9.9.~~2~~ |
  |  | 7 | Stable tag: 4.9.9.3 |
  | 8 | 8 | License: GPLv2 or later |
  | 9 | 9 | License URI: https://www.gnu.org/licenses/gpl-2.0.html |
  | […](/browser/newsletters-lite/trunk/readme.txt?rev=3139266#L224) | […](/browser/newsletters-lite/trunk/readme.txt?rev=3146287#L224) |  |
  | 224 | 224 |  |
  | 225 | 225 | See all <a href="https://tribulant.com/docs/wordpress-mailing-list-plugin/31/#doc6">releases and full changelogs</a> in our docs. |
  |  | 226 |  |
  |  | 227 | = 4.9.9.3 = |
  |  | 228 | \* FIX: Vulnerability authenticated privilege escalation. |
  | 226 | 229 |  |
  | 227 | 230 | = 4.9.9.2 = |
* ## [newsletters-lite/trunk/wp-mailinglist-plugin.php](/changeset/3146287/newsletters-lite/trunk/wp-mailinglist-plugin.php "Show the changeset 3146287 restricted to newsletters-lite/trunk/wp-mailinglist-plugin.php")

  | [r3139266](/browser/newsletters-lite/trunk/wp-mailinglist-plugin.php?rev=3139266#L9 "Show revision 3139266 of this file in browser") | [r3146287](/browser/newsletters-lite/trunk/wp-mailinglist-plugin.php?rev=3146287#L9 "Show revision 3146287 of this file in browser") |  |
  | --- | --- | --- |
  | 9 | 9 | var $plugin\_base; |
  | 10 | 10 | var $pre = 'wpml'; |
  | 11 |  | var $version = '4.9.9.~~2~~'; |
  |  | 11 | var $version = '4.9.9.3'; |
  | 12 | 12 | var $dbversion = '1.2.3'; |
  | 13 | 13 | var $debugging = false;         //set to "true" to turn on debugging |
* ## [newsletters-lite/trunk/wp-mailinglist.php](/changeset/3146287/newsletters-lite/trunk/wp-mailinglist.php "Show the changeset 3146287 restricted to newsletters-lite/trunk/wp-mailinglist.php")

  | [r3139266](/browser/newsletters-lite/trunk/wp-mailinglist.php?rev=3139266#L3 "Show revision 3139266 of this file in browser") | [r3146287](/browser/newsletters-lite/trunk/wp-mailinglist.php?rev=3146287#L3 "Show revision 3146287 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | /\* |
  | 4 | 4 | Plugin Name: Newsletters |
  | 5 |  | Plugin URI: https://tribulant.com/plugins/view/1/~~wordpress-newsletter-plugin~~ |
  | 6 |  | Version: 4.9.9.~~2~~ |
  |  | 5 | Plugin URI: https://tribulant.com/plugins/view/1/ |
  |  | 6 | Version: 4.9.9.3 |
  | 7 | 7 | Description: This newsletter software by Tribulant allows users to subscribe to multiple mailing lists on your WordPress website. Send newsletters manually or from posts, manage newsletter templates, view a complete history with tracking, import/export subscribers, accept paid subscriptions and much more. Remove limits by buying PRO. Once purchased, to avoid future issues, remove this version and install and use the paid version in its stead. No data will be lost. |
  | 8 | 8 | Author: Tribulant |
  | […](/browser/newsletters-lite/trunk/wp-mailinglist.php?rev=3139266#L3248) | […](/browser/newsletters-lite/trunk/wp-mailinglist.php?rev=3146287#L3248) |  |
  | 3248 | 3248 | } |
  | 3249 | 3249 |  |
  |  | 3250 |  |
  |  | 3251 |  |
  |  | 3252 |  |
  | 3250 | 3253 | global $Db, $Field; |
  | 3251 | 3254 | $Db -> model = $Field -> model; |
  | […](/browser/newsletters-lite/trunk/wp-mailinglist.php?rev=3139266#L3270) | […](/browser/newsletters-lite/trunk/wp-mailinglist.php?rev=3146287#L3273) |  |
  | 3270 | 3273 | } |
  | 3271 | 3274 |  |
  | 3272 |  | $option = $\_POST['wp\_screen\_options']['option']; |
  | 3273 |  | $value  = $\_POST['wp\_screen\_options']['value']; |
  |  | 3275 | $option = sanitize\_key($\_POST['wp\_screen\_options']['option']); |
  |  | 3276 | $value  = sanitize\_text\_field($\_POST['wp\_screen\_options']['value']); |
  |  | 3277 |  |
  |  | 3278 | // List of critical user meta keys that should never be modified directly |
  |  | 3279 | $forbidden\_options = array( |
  |  | 3280 | 'wp\_capabilities',    // Prevents changing user roles |
  |  | 3281 | 'user\_level',         // Prevents changing user levels |
  |  | 3282 | 'wp\_user\_level',      // WordPress specific user level |
  |  | 3283 | 'admin\_color',        // Prevents changing admin color scheme |
  |  | 3284 | ); |
  |  | 3285 |  |
  |  | 3286 | //Whitelist of allowed options |
  |  | 3287 | $allowed\_options = array( |
  |  | 3288 | 'newsletters\_history\_perpage' |
  |  | 3289 | ); |
  |  | 3290 |  |
  |  | 3291 |  |
  |  | 3292 | // Check if the option is in the allowed list |
  |  | 3293 | if (!in\_array($option, $allowed\_options, true)) { |
  |  | 3294 | return $current; // Abort if the option is not allowed |
  |  | 3295 | } |
  |  | 3296 |  |
  |  | 3297 | // Additional check to make sure only numeric values are allowed for pagination settings |
  |  | 3298 | if ($option === 'newsletters\_history\_perpage' && !is\_numeric($value)) { |
  |  | 3299 | return $current; // Abort if the value is not a valid number |
  |  | 3300 | } |
  |  | 3301 |  |
  |  | 3302 | // Ensure the option starts with the 'newsletters\_' prefix |
  |  | 3303 | if (strpos($option, 'newsletters\_') !== 0) { |
  |  | 3304 | return $current; // Abort if the option does not start with the 'newsletters\_' prefix |
  |  | 3305 | } |
  |  | 3306 |  |
  |  | 3307 | // Check if the option is forbidden |
  |  | 3308 | if (in\_array($option, $forbidden\_options, true)) { |
  |  | 3309 | return $current; // Abort if the option is in the forbidden list |
  |  | 3310 | } |
  |  | 3311 |  |
  |  | 3312 | // Ensure the user has permission to change this option |
  |  | 3313 | if (!current\_user\_can('edit\_user', $user->ID)) { |
  |  | 3314 | return $current; // Abort if the user does not have sufficient permissions |
  |  | 3315 | } |
  | 3274 | 3316 |  |
  | 3275 | 3317 | if ( sanitize\_key( $option ) !== $option ) { |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3146287)
* [Zip Archive](?format=zip&new=3146287)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

