

| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=bccebf64701735533c8db37773eeacc6566cc8ec)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=bccebf64701735533c8db37773eeacc6566cc8ec)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=bccebf64701735533c8db37773eeacc6566cc8ec)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=bccebf64701735533c8db37773eeacc6566cc8ec)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Florian Westphal <fw@strlen.de> | 2024-02-19 16:58:04 +0100 |
| --- | --- | --- |
| committer | Pablo Neira Ayuso <pablo@netfilter.org> | 2024-02-22 00:14:54 +0100 |
| commit | [bccebf64701735533c8db37773eeacc6566cc8ec](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=bccebf64701735533c8db37773eeacc6566cc8ec) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=bccebf64701735533c8db37773eeacc6566cc8ec)) | |
| tree | [944245466e377ff05502e58159cdbd588df00d86](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=bccebf64701735533c8db37773eeacc6566cc8ec) | |
| parent | [40b9385dd8e6a0515e1c9cd06a277483556b7286](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=40b9385dd8e6a0515e1c9cd06a277483556b7286) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=bccebf64701735533c8db37773eeacc6566cc8ec&id2=40b9385dd8e6a0515e1c9cd06a277483556b7286)) | |
| download | [linux-bccebf64701735533c8db37773eeacc6566cc8ec.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-bccebf64701735533c8db37773eeacc6566cc8ec.tar.gz) | |

netfilter: nf\_tables: set dormant flag on hook register failureWe need to set the dormant flag again if we fail to register
the hooks.
During memory pressure hook registration can fail and we end up
with a table marked as active but no registered hooks.
On table/base chain deletion, nf\_tables will attempt to unregister
the hook again which yields a warn splat from the nftables core.
Reported-and-tested-by: syzbot+de4025c006ec68ac56fc@syzkaller.appspotmail.com
Fixes: 179d9ba5559a ("netfilter: nf\_tables: fix table flag updates")
Signed-off-by: Florian Westphal <fw@strlen.de>
Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=bccebf64701735533c8db37773eeacc6566cc8ec)

| -rw-r--r-- | [net/netfilter/nf\_tables\_api.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/netfilter/nf_tables_api.c?id=bccebf64701735533c8db37773eeacc6566cc8ec) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 0 deletions

| diff --git a/net/netfilter/nf\_tables\_api.c b/net/netfilter/nf\_tables\_api.cindex f8e3f70c35bd55..90038d778f373f 100644--- a/[net/netfilter/nf\_tables\_api.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/netfilter/nf_tables_api.c?id=40b9385dd8e6a0515e1c9cd06a277483556b7286)+++ b/[net/netfilter/nf\_tables\_api.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/netfilter/nf_tables_api.c?id=bccebf64701735533c8db37773eeacc6566cc8ec)@@ -1251,6 +1251,7 @@ static int nf\_tables\_updtable(struct nft\_ctx \*ctx) return 0;  err\_register\_hooks:+ ctx->table->flags |= NFT\_TABLE\_F\_DORMANT; nft\_trans\_destroy(trans); return ret; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 15:03:02 +0000

