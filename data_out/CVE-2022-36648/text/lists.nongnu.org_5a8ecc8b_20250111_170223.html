

| | **qemu-devel** | | --- | |
| --- | --- |

[[Top](../)][[All Lists](/archive/html)]

[Advanced](/archive/cgi-bin/namazu.cgi?idxname=qemu-devel)

---

[[Date Prev](msg04468.html)][[Date Next](msg04470.html)][[Thread Prev](msg04409.html)][[Thread Next](msg04472.html)][[Date Index](index.html#04469)][[Thread Index](threads.html#04469)]

## [PATCH] hw/net/rocker: avoid NULL pointer dereference in of\_dpa\_cmd\_add\_

---

| **From**: | Mauro Matteo Cascella |
| --- | --- |

| **Subject**: | [PATCH] hw/net/rocker: avoid NULL pointer dereference in of\_dpa\_cmd\_add\_l2\_flood |
| **Date**: | Fri, 24 Jun 2022 16:39:12 +0200 |

---

```
rocker_tlv_parse_nested could return early because of no group ids in
the group_tlvs. In such case tlvs is NULL; tlvs[i + 1] in the next
for-loop will deref the NULL pointer.

Signed-off-by: Mauro Matteo Cascella <mcascell@redhat.com>
Reported-by: <arayz_w@icloud.com>
---
 hw/net/rocker/rocker_of_dpa.c | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/hw/net/rocker/rocker_of_dpa.c b/hw/net/rocker/rocker_of_dpa.c
index b3b8c5bb6d..1611b79227 100644
--- a/hw/net/rocker/rocker_of_dpa.c
+++ b/hw/net/rocker/rocker_of_dpa.c
@@ -2039,6 +2039,11 @@ static int of_dpa_cmd_add_l2_flood(OfDpa *of_dpa,
OfDpaGroup *group,
     rocker_tlv_parse_nested(tlvs, group->l2_flood.group_count,
                             group_tlvs[ROCKER_TLV_OF_DPA_GROUP_IDS]);

+    if (!tlvs) {
+        err = -ROCKER_EINVAL;
+        goto err_out;
+    }
+
     for (i = 0; i < group->l2_flood.group_count; i++) {
         group->l2_flood.group_ids[i] = rocker_tlv_get_le32(tlvs[i + 1]);
     }
--
2.35.3

```

---

reply via email to

---

| [Prev in Thread] | **Current Thread** | [Next in Thread] |
| --- | --- | --- |

* **[PATCH] hw/net/rocker: avoid NULL pointer dereference in of\_dpa\_cmd\_add\_l2\_flood**,
  *Mauro Matteo Cascella*Â **<=**

---

* Prev by Date:
  **[Re: [PATCH v7 10/18] jobs: rename static functions called with job\_mutex held](msg04468.html)**
* Next by Date:
  **[[PATCH v8 1/4] tests/vm: do not specify -bios option](msg04470.html)**
* Previous by thread:
  **[[PATCH v2 00/54] PS2 device QOMification - part 1](msg04409.html)**
* Next by thread:
  **[[PATCH v8 0/4] cutils: Introduce bundle mechanism](msg04472.html)**
* Index(es):
  + [**Date**](index.html#04469)
  + [**Thread**](threads.html#04469)

