=== Content from www.wireshark.org_b69b48ec_20250111_082104.html ===

## wnpa-sec-2023-22 Â· iSCSI dissector crash

## Summary

**Name:** iSCSI dissector crash

**Docid:** wnpa-sec-2023-22

**Date:** July 12, 2023

**Affected versions:** 4.0.0 to 4.0.6, 3.6.0 to 3.6.15

**Fixed versions:** 4.0.7, 3.6.16

**References:**

[Wireshark issue 19164](https://gitlab.com/wireshark/wireshark/-/issues/19164).

[CVE-2023-3649](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-3649).

## Details

### Description

The iSCSI dissector could crash.

## Impact

It may be possible to make Wireshark
crash

by injecting a malformed packet onto the wire or
by convincing
someone to read a malformed packet trace file.

## Resolution

Upgrade to Wireshark 4.0.7, 3.6.16 or later.



=== Content from gitlab.com_4beb0423_20250111_082104.html ===


[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Fuzz job crash output: fuzz-2023-06-23-7013.pcap

Problems have been found with the following capture file:

<https://www.wireshark.org/download/automated/captures/fuzz-2023-06-23-7013.pcap.gz>

stderr:

```
Branch: master
Input file: /var/menagerie/menagerie/14887-z.pcap.gz
CI job name: ASan Menagerie Fuzz, ID: 4527831769
CI job URL: https://gitlab.com/wireshark/wireshark/-/jobs/4527831769
Return value: 0
Dissector bug: 0
Date and time: Fri Jun 23 10:16:27 UTC 2023

Commits in the last 48 hours:
22dcdbc3af5 Qt: Manually connect some "Statistics" menu actions
b96e2e20754 Convert epan/crypt to C99 types
4d8bad0dcb9 Update a comment. [skip ci]
0445dd4db93 Reassembly: Clarify comments to use streaming reassembly func
1a272886be3 USB: Dissect Binary Device Object Store descriptor
24eeead63eb packet-cql.c: implement few auth related message dissection
efbca7715cc tshark: Fix the check on UN*X for writing to a pipe and dissecting
568536d53c7 http2: add SETTINGS_NO_RFC7540_PRIORITIES of RFC9218
f11450a5876 tools: Relax dup filter check for stat
32369941b32 pfcp: translate Quota Validity Time to human readable time string
8d7cc70a035 Add "-G dissectors" to TShark, to dump the registered dissectors.
40fdce4118f opensafety: Fix bad malloc pattern
ad216159737 dfilter: Fix an error message
60203c3db30 capture: Use win32strerror on windows
aa895db3810 UI: Remove leftover GTK+ recent settings
38fa97a4e83 tshark: Move a debug message later
ff31939869d SMB2: Add updated TreeConnectResponse ShareFlag Isolated_Transport
62be2fc961a release-notes: IPv6 dissector supports dissecting APN6 option now.
0acc81714d5 WSUG: example for curly braces around math expression
a78006ebc50 http: fix Dead Store found by Clang Analyzer
ee88d734f89 rtps: fix Dead Store found by Clang Analyzer
facff670676 Use `register_dissector()` for more protocols
7e07c29b09f print: Fix a check for hf_text_only

Build host information:
Linux 5.19.0-42-generic #43~22.04.1-Ubuntu SMP PREEMPT_DYNAMIC Fri Apr 21 16:51:08 UTC 2 x86_64
Distributor ID:	Ubuntu
Description:	Ubuntu 22.04.2 LTS
Release:	22.04
Codename:	jammy

Command and args: /builds/wireshark/wireshark/_install/bin/tshark -2 --log-fatal-domains=UTF-8  -nVxr
Running as user "root" and group "root". This could be dangerous.
=================================================================
==68767==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x6060012be13d at pc 0x5556e29db4b2 bp 0x7ffc7542d1d0 sp 0x7ffc7542c998
READ of size 9 at 0x6060012be13d thread T0
    #0 0x5556e29db4b1 in __interceptor_strchr (/builds/wireshark/wireshark/_install/bin/tshark+0x664b1) (BuildId: 96a665263f2af24405a98783579dbde0b74831e7)
    #1 0x7f3c503997f4 in iscsi_dissect_TargetAddress /builds/wireshark/wireshark/epan/dissectors/packet-iscsi.c:532:19
    #2 0x7f3c503994fc in addTextKeys /builds/wireshark/wireshark/epan/dissectors/packet-iscsi.c:615:13
    #3 0x7f3c503992c2 in handleDataSegmentAsTextKeys /builds/wireshark/wireshark/epan/dissectors/packet-iscsi.c:699:22
    #4 0x7f3c50396267 in dissect_iscsi_pdu /builds/wireshark/wireshark/epan/dissectors/packet-iscsi.c:1309:18
    #5 0x7f3c50391d30 in dissect_iscsi /builds/wireshark/wireshark/epan/dissectors/packet-iscsi.c:2504:9
    #6 0x7f3c5038f5da in dissect_iscsi_handle /builds/wireshark/wireshark/epan/dissectors/packet-iscsi.c:2522:12
    #7 0x7f3c528c35da in call_dissector_through_handle /builds/wireshark/wireshark/epan/packet.c:833:9
    #8 0x7f3c528b81b1 in call_dissector_work /builds/wireshark/wireshark/epan/packet.c:924:9
    #9 0x7f3c528bfde0 in call_dissector_only /builds/wireshark/wireshark/epan/packet.c:3423:8
    #10 0x7f3c5287032e in try_conversation_call_dissector_helper /builds/wireshark/wireshark/epan/conversation.c:1593:11
    #11 0x7f3c5286fdaa in try_conversation_dissector /builds/wireshark/wireshark/epan/conversation.c:1627:13
    #12 0x7f3c510dc51c in decode_tcp_ports /builds/wireshark/wireshark/epan/dissectors/packet-tcp.c:7278:9
    #13 0x7f3c510e5513 in process_tcp_payload /builds/wireshark/wireshark/epan/dissectors/packet-tcp.c:7442:13
    #14 0x7f3c510e275e in desegment_tcp /builds/wireshark/wireshark/epan/dissectors/packet-tcp.c:4423:9
    #15 0x7f3c510dedc1 in dissect_tcp_payload /builds/wireshark/wireshark/epan/dissectors/packet-tcp.c:7515:9
    #16 0x7f3c510f33ad in dissect_tcp /builds/wireshark/wireshark/epan/dissectors/packet-tcp.c:8603:17
    #17 0x7f3c528c35da in call_dissector_through_handle /builds/wireshark/wireshark/epan/packet.c:833:9
    #18 0x7f3c528b81b1 in call_dissector_work /builds/wireshark/wireshark/epan/packet.c:924:9
    #19 0x7f3c528b7be3 in dissector_try_uint_new /builds/wireshark/wireshark/epan/packet.c:1527:8
    #20 0x7f3c5030a6ee in ip_try_dissect /builds/wireshark/wireshark/epan/dissectors/packet-ip.c:1819:7
    #21 0x7f3c5030fb41 in dissect_ip_v4 /builds/wireshark/wireshark/epan/dissectors/packet-ip.c:2325:10
    #22 0x7f3c528c35da in call_dissector_through_handle /builds/wireshark/wireshark/epan/packet.c:833:9
    #23 0x7f3c528b81b1 in call_dissector_work /builds/wireshark/wireshark/epan/packet.c:924:9
    #24 0x7f3c528b7be3 in dissector_try_uint_new /builds/wireshark/wireshark/epan/packet.c:1527:8
    #25 0x7f3c528b8472 in dissector_try_uint /builds/wireshark/wireshark/epan/packet.c:1551:9
    #26 0x7f3c4feaf693 in dissect_ethertype /builds/wireshark/wireshark/epan/dissectors/packet-ethertype.c:296:21
    #27 0x7f3c528c35da in call_dissector_through_handle /builds/wireshark/wireshark/epan/packet.c:833:9
    #28 0x7f3c528b81b1 in call_dissector_work /builds/wireshark/wireshark/epan/packet.c:924:9
    #29 0x7f3c528bfde0 in call_dissector_only /builds/wireshark/wireshark/epan/packet.c:3423:8
    #30 0x7f3c528b4674 in call_dissector_with_data /builds/wireshark/wireshark/epan/packet.c:3436:8
    #31 0x7f3c4feac2dc in dissect_eth_common /builds/wireshark/wireshark/epan/dissectors/packet-eth.c:596:5
    #32 0x7f3c4feaae27 in dissect_eth /builds/wireshark/wireshark/epan/dissectors/packet-eth.c:902:5
    #33 0x7f3c528c35da in call_dissector_through_handle /builds/wireshark/wireshark/epan/packet.c:833:9
    #34 0x7f3c528b81b1 in call_dissector_work /builds/wireshark/wireshark/epan/packet.c:924:9
    #35 0x7f3c528bfde0 in call_dissector_only /builds/wireshark/wireshark/epan/packet.c:3423:8
    #36 0x7f3c4ff4fb79 in dissect_frame /builds/wireshark/wireshark/epan/dissectors/packet-frame.c:1293:6
    #37 0x7f3c528c35da in call_dissector_through_handle /builds/wireshark/wireshark/epan/packet.c:833:9
    #38 0x7f3c528b81b1 in call_dissector_work /builds/wireshark/wireshark/epan/packet.c:924:9
    #39 0x7f3c528bfde0 in call_dissector_only /builds/wireshark/wireshark/epan/packet.c:3423:8
    #40 0x7f3c528b4674 in call_dissector_with_data /builds/wireshark/wireshark/epan/packet.c:3436:8
    #41 0x7f3c528b3e53 in dissect_record /builds/wireshark/wireshark/epan/packet.c:637:3
    #42 0x7f3c52884e88 in epan_dissect_run /builds/wireshark/wireshark/epan/epan.c:622:2
    #43 0x5556e2aac643 in process_packet_first_pass /builds/wireshark/wireshark/tshark.c:3118:9
    #44 0x5556e2aaa3b7 in process_cap_file_first_pass /builds/wireshark/wireshark/tshark.c:3265:13
    #45 0x5556e2aa53b7 in process_cap_file /builds/wireshark/wireshark/tshark.c:3778:29
    #46 0x5556e2a9e74d in main /builds/wireshark/wireshark/tshark.c:2291:22
    #47 0x7f3c474c7d8f  (/lib/x86_64-linux-gnu/libc.so.6+0x29d8f) (BuildId: 69389d485a9793dbe873f0ea2c93e02efaa9aa3d)
    #48 0x7f3c474c7e3f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x29e3f) (BuildId: 69389d485a9793dbe873f0ea2c93e02efaa9aa3d)
    #49 0x5556e29c1744 in _start (/builds/wireshark/wireshark/_install/bin/tshark+0x4c744) (BuildId: 96a665263f2af24405a98783579dbde0b74831e7)

0x6060012be13d is located 0 bytes to the right of 61-byte region [0x6060012be100,0x6060012be13d)
allocated by thread T0 here:
    #0 0x5556e2a4716e in malloc (/builds/wireshark/wireshark/_install/bin/tshark+0xd216e) (BuildId: 96a665263f2af24405a98783579dbde0b74831e7)
    #1 0x7f3c47724738 in g_malloc (/lib/x86_64-linux-gnu/libglib-2.0.so.0+0x5e738) (BuildId: 137458a0f7846a084270bf5bb03df075a578db6d)
    #2 0x7f3c47d25f5f in wmem_strict_alloc /builds/wireshark/wireshark/wsutil/wmem/wmem_allocator_strict.c:81:46
    #3 0x7f3c47d1d229 in wmem_alloc /builds/wireshark/wireshark/wsutil/wmem/wmem_core.c:44:12
    #4 0x7f3c47d30843 in wmem_strdup /builds/wireshark/wireshark/wsutil/wmem/wmem_strutl.c:32:27
    #5 0x7f3c503996db in iscsi_dissect_TargetAddress /builds/wireshark/wireshark/epan/dissectors/packet-iscsi.c:522:19
    #6 0x7f3c503994fc in addTextKeys /builds/wireshark/wireshark/epan/dissectors/packet-iscsi.c:615:13
    #7 0x7f3c503992c2 in handleDataSegmentAsTextKeys /builds/wireshark/wireshark/epan/dissectors/packet-iscsi.c:699:22
    #8 0x7f3c50396267 in dissect_iscsi_pdu /builds/wireshark/wireshark/epan/dissectors/packet-iscsi.c:1309:18
    #9 0x7f3c50391d30 in dissect_iscsi /builds/wireshark/wireshark/epan/dissectors/packet-iscsi.c:2504:9
    #10 0x7f3c5038f5da in dissect_iscsi_handle /builds/wireshark/wireshark/epan/dissectors/packet-iscsi.c:2522:12
    #11 0x7f3c528c35da in call_dissector_through_handle /builds/wireshark/wireshark/epan/packet.c:833:9
    #12 0x7f3c528b81b1 in call_dissector_work /builds/wireshark/wireshark/epan/packet.c:924:9
    #13 0x7f3c528bfde0 in call_dissector_only /builds/wireshark/wireshark/epan/packet.c:3423:8
    #14 0x7f3c5287032e in try_conversation_call_dissector_helper /builds/wireshark/wireshark/epan/conversation.c:1593:11
    #15 0x7f3c5286fdaa in try_conversation_dissector /builds/wireshark/wireshark/epan/conversation.c:1627:13
    #16 0x7f3c510dc51c in decode_tcp_ports /builds/wireshark/wireshark/epan/dissectors/packet-tcp.c:7278:9
    #17 0x7f3c510e5513 in process_tcp_payload /builds/wireshark/wireshark/epan/dissectors/packet-tcp.c:7442:13
    #18 0x7f3c510e275e in desegment_tcp /builds/wireshark/wireshark/epan/dissectors/packet-tcp.c:4423:9
    #19 0x7f3c510dedc1 in dissect_tcp_payload /builds/wireshark/wireshark/epan/dissectors/packet-tcp.c:7515:9
    #20 0x7f3c510f33ad in dissect_tcp /builds/wireshark/wireshark/epan/dissectors/packet-tcp.c:8603:17
    #21 0x7f3c528c35da in call_dissector_through_handle /builds/wireshark/wireshark/epan/packet.c:833:9
    #22 0x7f3c528b81b1 in call_dissector_work /builds/wireshark/wireshark/epan/packet.c:924:9
    #23 0x7f3c528b7be3 in dissector_try_uint_new /builds/wireshark/wireshark/epan/packet.c:1527:8
    #24 0x7f3c5030a6ee in ip_try_dissect /builds/wireshark/wireshark/epan/dissectors/packet-ip.c:1819:7
    #25 0x7f3c5030fb41 in dissect_ip_v4 /builds/wireshark/wireshark/epan/dissectors/packet-ip.c:2325:10
    #26 0x7f3c528c35da in call_dissector_through_handle /builds/wireshark/wireshark/epan/packet.c:833:9
    #27 0x7f3c528b81b1 in call_dissector_work /builds/wireshark/wireshark/epan/packet.c:924:9
    #28 0x7f3c528b7be3 in dissector_try_uint_new /builds/wireshark/wireshark/epan/packet.c:1527:8
    #29 0x7f3c528b8472 in dissector_try_uint /builds/wireshark/wireshark/epan/packet.c:1551:9

SUMMARY: AddressSanitizer: heap-buffer-overflow (/builds/wireshark/wireshark/_install/bin/tshark+0x664b1) (BuildId: 96a665263f2af24405a98783579dbde0b74831e7) in __interceptor_strchr
Shadow bytes around the buggy address:
  0x0c0c8024fbd0: 00 00 00 00 fa fa fa fa 00 00 00 00 00 00 00 fa
  0x0c0c8024fbe0: fa fa fa fa fd fd fd fd fd fd fd fa fa fa fa fa
  0x0c0c8024fbf0: 00 00 00 00 00 00 00 07 fa fa fa fa 00 00 00 00
  0x0c0c8024fc00: 00 00 00 00 fa fa fa fa 00 00 00 00 00 00 00 00
  0x0c0c8024fc10: fa fa fa fa 00 00 00 00 00 00 00 00 fa fa fa fa
=>0x0c0c8024fc20: 00 00 00 00 00 00 00[05]fa fa fa fa fa fa fa fa
  0x0c0c8024fc30: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c0c8024fc40: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c0c8024fc50: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c0c8024fc60: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c0c8024fc70: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==68767==ABORTING

fuzz-test.sh stderr:
Running as user "root" and group "root". This could be dangerous.
capinfos: Unknown packet encapsulation 0 in frame 1 of file "/var/menagerie/menagerie/16761-suite_capture.case_dumpcap_pcapng_sections.test_dumpcap_pcapng_multi_in_multi_out.sections_rb_d31ea6_00002_20181126125927.pcapng"
capinfos: Unknown packet encapsulation 0 in frame 2 of file "/var/menagerie/menagerie/16761-suite_capture.case_dumpcap_pcapng_sections.test_dumpcap_pcapng_multi_in_multi_out.sections_rb_d31ea6_00002_20181126125927.pcapng"
capinfos: Unknown packet encapsulation 0 in frame 3 of file "/var/menagerie/menagerie/16761-suite_capture.case_dumpcap_pcapng_sections.test_dumpcap_pcapng_multi_in_multi_out.sections_rb_d31ea6_00002_20181126125927.pcapng"
capinfos: Unknown packet encapsulation 0 in frame 4 of file "/var/menagerie/menagerie/16761-suite_capture.case_dumpcap_pcapng_sections.test_dumpcap_pcapng_multi_in_multi_out.sections_rb_d31ea6_00002_20181126125927.pcapng"
capinfos: Unknown packet encapsulation 0 in frame 5 of file "/var/menagerie/menagerie/16761-suite_capture.case_dumpcap_pcapng_sections.test_dumpcap_pcapng_multi_in_multi_out.sections_rb_d31ea6_00002_20181126125927.pcapng"
capinfos: Unknown packet encapsulation 0 in frame 6 of file "/var/menagerie/menagerie/16761-suite_capture.case_dumpcap_pcapng_sections.test_dumpcap_pcapng_multi_in_multi_out.sections_rb_d31ea6_00002_20181126125927.pcapng"
capinfos: Unknown packet encapsulation 0 in frame 7 of file "/var/menagerie/menagerie/16761-suite_capture.case_dumpcap_pcapng_sections.test_dumpcap_pcapng_multi_in_multi_out.sections_rb_d31ea6_00002_20181126125927.pcapng"
capinfos: Unknown packet encapsulation 0 in frame 8 of file "/var/menagerie/menagerie/16761-suite_capture.case_dumpcap_pcapng_sections.test_dumpcap_pcapng_multi_in_multi_out.sections_rb_d31ea6_00002_20181126125927.pcapng"
capinfos: Unknown packet encapsulation 0 in frame 9 of file "/var/menagerie/menagerie/16761-suite_capture.case_dumpcap_pcapng_sections.test_dumpcap_pcapng_multi_in_multi_out.sections_rb_d31ea6_00002_20181126125927.pcapng"
capinfos: Unknown packet encapsulation 0 in frame 10 of file "/var/menagerie/menagerie/16761-suite_capture.case_dumpcap_pcapng_sections.test_dumpcap_pcapng_multi_in_multi_out.sections_rb_d31ea6_00002_20181126125927.pcapng"
capinfos: Unknown packet encapsulation 0 in frame 11 of file "/var/menagerie/menagerie/16761-suite_capture.case_dumpcap_pcapng_sections.test_dumpcap_pcapng_multi_in_multi_out.sections_rb_d31ea6_00002_20181126125927.pcapng"
capinfos: Unknown packet encapsulation 0 in frame 12 of file "/var/menagerie/menagerie/16761-suite_capture.case_dumpcap_pcapng_sections.test_dumpcap_pcapng_multi_in_multi_out.sections_rb_d31ea6_00002_20181126125927.pcapng"
capinfos: Unknown packet encapsulation 0 in frame 13 of file "/var/menagerie/menagerie/16761-suite_capture.case_dumpcap_pcapng_sections.test_dumpcap_pcapng_multi_in_multi_out.sections_rb_d31ea6_00002_20181126125927.pcapng"
capinfos: Unknown packet encapsulation 0 in frame 14 of file "/var/menagerie/menagerie/16761-suite_capture.case_dumpcap_pcapng_sections.test_dumpcap_pcapng_multi_in_multi_out.sections_rb_d31ea6_00002_20181126125927.pcapng"
capinfos: Unknown packet encapsulation 0 in frame 15 of file "/var/menagerie/menagerie/16761-suite_capture.case_dumpcap_pcapng_sections.test_dumpcap_pcapng_multi_in_multi_out.sections_rb_d31ea6_00002_20181126125927.pcapng"
capinfos: Unknown packet encapsulation 0 in frame 16 of file "/var/menagerie/menagerie/16761-suite_capture.case_dumpcap_pcapng_sections.test_dumpcap_pcapng_multi_in_multi_out.sections_rb_d31ea6_00002_20181126125927.pcapng"
capinfos: Unknown packet encapsulation 0 in frame 17 of file "/var/menagerie/menagerie/16761-suite_capture.case_dumpcap_pcapng_sections.test_dumpcap_pcapng_multi_in_multi_out.sections_rb_d31ea6_00002_20181126125927.pcapng"
capinfos: Unknown packet encapsulation 0 in frame 18 of file "/var/menagerie/menagerie/16761-suite_capture.case_dumpcap_pcapng_sections.test_dumpcap_pcapng_multi_in_multi_out.sections_rb_d31ea6_00002_20181126125927.pcapng"
capinfos: Unknown packet encapsulation 0 in frame 19 of file "/var/menagerie/menagerie/16761-suite_capture.case_dumpcap_pcapng_sections.test_dumpcap_pcapng_multi_in_multi_out.sections_rb_d31ea6_00002_20181126125927.pcapng"
capinfos: Unknown packet encapsulation 0 in frame 20 of file "/var/menagerie/menagerie/16761-suite_capture.case_dumpcap_pcapng_sections.test_dumpcap_pcapng_multi_in_multi_out.sections_rb_d31ea6_00002_20181126125927.pcapng"
```

*no debug trace*

To upload designs, you'll need to enable LFS and have an admin enable hashed storage. [More information](/help/user/project/issues/design_management.md#prerequisites)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


