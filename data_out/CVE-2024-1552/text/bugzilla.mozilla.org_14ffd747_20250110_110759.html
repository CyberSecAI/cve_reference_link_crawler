

![](/static/v20250108.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1874502)
* [XML](/show_bug.cgi?ctype=xml&id=1874502)

Closed
[Bug 1874502](/show_bug.cgi?id=1874502)
(CVE-2024-1552)

Opened 1 year ago
Closed 1 year ago

# Assertion failure: dest.isDouble(), at jit/arm/MacroAssembler-arm.cpp:195

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Assertion failure: dest.isDouble(), at jit/arm/MacroAssembler-arm.cpp:195

## Categories

### (Core :: JavaScript Engine, defect, P1)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=JavaScript%20Engine#JavaScript%20Engine)

JavaScript Engine
▾

Core :: JavaScript Engine
The interpreter engine for the core JavaScript language, independent of the browser's object model. File ONLY core JavaScript language bugs in this category. For bugs involving browser objects such as "window" and "document", use the "DOM" component. For bugs involving calls between JavaScript and C++, use the "XPConnect" component.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=JavaScript%20Engine)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86

Linux

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

123 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| a11y-review | --- |
| Performance Impact | --- |
| Accessibility Severity | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr115 | [123+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=123%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed) |
| firefox121 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=wontfix) |
| firefox122 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox122&o1=equals&v1=wontfix) |
| firefox123 | [+](/buglist.cgi?f1=cf_tracking_firefox123&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox123&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | 123+ | fixed |
| firefox-esr128 | --- | --- |
| firefox121 |  | wontfix |
| firefox122 |  | wontfix |
| firefox123 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: gkw, Assigned: iain)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/1243fc5f2c1c56a2f77ca1be38837e68?d=mm&size=40)  [iain](/user_profile?user_id=623993)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](extensions/Gravatar/web/default.jpg)  [gkw](/user_profile?user_id=132034)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/4fe52ee1503aecf7b6c976b8eb7c1753?d=mm&size=40)  [willyelm](/user_profile?user_id=714609)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

7 people

## References

### (Blocks 1 open bug, Regression)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[gkw-js-fuzzing](/show_bug.cgi?id=1890610 "NEW - [meta] Gary JavaScript engine Fuzzing")

Dependency [tree](/showdependencytree.cgi?id=1874502&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1874502)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

[1523941](/show_bug.cgi?id=1523941 "RESOLVED FIXED - Enforce Scratch{Double,Float32}Scope throughout the pipeline")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (4 keywords, Whiteboard: [adv-main123+][adv-esr115.8+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2024-1552

[Keywords:](/describekeywords.cgi)

[regression](/buglist.cgi?keywords=regression&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main123+][adv-esr115.8+]

QA Whiteboard:

[post-critsmash-triage]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a939943_1689 "1 year ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | [in-testsuite](#a338293_75935 "1 year ago") | + |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | in-testsuite | + |
| --- | --- | --- |
| [avaida](/user_profile?user_id=488993) | [qe-verify](#a1066643_488993 "1 year ago") | - |
| --- | --- | --- |
| [avaida](/user_profile?user_id=488993) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files)

| [debug shell stack](/attachment.cgi?id=9372654)  [1 year ago](#c0)  [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)   5.53 KB, text/plain |  | [Details](/attachment.cgi?id=9372654&action=edit) |
| --- | --- | --- |
| [Bug 1874502: Use ScratchDoubleScope in moveValue r=jandem](/attachment.cgi?id=9372669)  [1 year ago](#c3)  [Iain Ireland [:iain]](/user_profile?user_id=623993)   48 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-esr115+](#c11 "11 months ago") | [Details](/attachment.cgi?id=9372669&action=edit) | [Review](/attachment.cgi?id=9372669) |
| [advisory.txt](/attachment.cgi?id=9380030)  [11 months ago](#c13)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   227 bytes, text/plain |  | [Details](/attachment.cgi?id=9380030&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1874502#c0)• 1 year ago |
|  | |

Attached file
[debug shell stack](attachment.cgi?id=9372654)
— [Details](attachment.cgi?id=9372654&action=edit)

```
function f(x) {
  Math.fround(function () {
    x;
  });
}
for (let j = 0; j < 29; j++) {
  f(Math.fround(1));
}

```
```
Assertion failure: dest.isDouble(), at /home/gen32gx500/trees/mozilla-central/js/src/jit/arm/MacroAssembler-arm.cpp:195
#01: ???[/home/gen32gx500/shell-cache/js-dbg-32-armsim32-linux-x86_64-734e2e027196/js-dbg-32-armsim32-linux-x86_64-734e2e027196 +0x2731ee3]
#02: ???[/home/gen32gx500/shell-cache/js-dbg-32-armsim32-linux-x86_64-734e2e027196/js-dbg-32-armsim32-linux-x86_64-734e2e027196 +0x274e9ad]
#03: ???[/home/gen32gx500/shell-cache/js-dbg-32-armsim32-linux-x86_64-734e2e027196/js-dbg-32-armsim32-linux-x86_64-734e2e027196 +0x26fbd29]
#04: ???[/home/gen32gx500/shell-cache/js-dbg-32-armsim32-linux-x86_64-734e2e027196/js-dbg-32-armsim32-linux-x86_64-734e2e027196 +0x290a2fe]
#05: ???[/home/gen32gx500/shell-cache/js-dbg-32-armsim32-linux-x86_64-734e2e027196/js-dbg-32-armsim32-linux-x86_64-734e2e027196 +0x296abb1]
#06: ???[/home/gen32gx500/shell-cache/js-dbg-32-armsim32-linux-x86_64-734e2e027196/js-dbg-32-armsim32-linux-x86_64-734e2e027196 +0x29b42c2]
#07: ???[/home/gen32gx500/shell-cache/js-dbg-32-armsim32-linux-x86_64-734e2e027196/js-dbg-32-armsim32-linux-x86_64-734e2e027196 +0x29b56d5]
#08: ???[/home/gen32gx500/shell-cache/js-dbg-32-armsim32-linux-x86_64-734e2e027196/js-dbg-32-armsim32-linux-x86_64-734e2e027196 +0x29b62de]
#09: ???[/home/gen32gx500/shell-cache/js-dbg-32-armsim32-linux-x86_64-734e2e027196/js-dbg-32-armsim32-linux-x86_64-734e2e027196 +0x29b6c47]
#10: ???[/home/gen32gx500/shell-cache/js-dbg-32-armsim32-linux-x86_64-734e2e027196/js-dbg-32-armsim32-linux-x86_64-734e2e027196 +0x2763d65]
#11: ???[/home/gen32gx500/shell-cache/js-dbg-32-armsim32-linux-x86_64-734e2e027196/js-dbg-32-armsim32-linux-x86_64-734e2e027196 +0x2760d57]
#12: ???[/home/gen32gx500/shell-cache/js-dbg-32-armsim32-linux-x86_64-734e2e027196/js-dbg-32-armsim32-linux-x86_64-734e2e027196 +0x27696ab]
#13: ???[/home/gen32gx500/shell-cache/js-dbg-32-armsim32-linux-x86_64-734e2e027196/js-dbg-32-armsim32-linux-x86_64-734e2e027196 +0x2769c70]
#14: ???[/home/gen32gx500/shell-cache/js-dbg-32-armsim32-linux-x86_64-734e2e027196/js-dbg-32-armsim32-linux-x86_64-734e2e027196 +0x25d2b87]
#15: ???[/home/gen32gx500/shell-cache/js-dbg-32-armsim32-linux-x86_64-734e2e027196/js-dbg-32-armsim32-linux-x86_64-734e2e027196 +0x1a5b0d6]
#16: ???[/home/gen32gx500/shell-cache/js-dbg-32-armsim32-linux-x86_64-734e2e027196/js-dbg-32-armsim32-linux-x86_64-734e2e027196 +0x1a55073]
#17: ???[/home/gen32gx500/shell-cache/js-dbg-32-armsim32-linux-x86_64-734e2e027196/js-dbg-32-armsim32-linux-x86_64-734e2e027196 +0x1a54b9f]
#18: ???[/home/gen32gx500/shell-cache/js-dbg-32-armsim32-linux-x86_64-734e2e027196/js-dbg-32-armsim32-linux-x86_64-734e2e027196 +0x1a57e1c]
#19: ???[/home/gen32gx500/shell-cache/js-dbg-32-armsim32-linux-x86_64-734e2e027196/js-dbg-32-armsim32-linux-x86_64-734e2e027196 +0x1a5828a]
#20: ???[/home/gen32gx500/shell-cache/js-dbg-32-armsim32-linux-x86_64-734e2e027196/js-dbg-32-armsim32-linux-x86_64-734e2e027196 +0x1bdecb8]
#21: JS_ExecuteScript(JSContext*, JS::Handle<JSScript*>)[/home/gen32gx500/shell-cache/js-dbg-32-armsim32-linux-x86_64-734e2e027196/js-dbg-32-armsim32-linux-x86_64-734e2e027196 +0x1bdee98]
#22: ???[/home/gen32gx500/shell-cache/js-dbg-32-armsim32-linux-x86_64-734e2e027196/js-dbg-32-armsim32-linux-x86_64-734e2e027196 +0x1994677]
#23: ???[/home/gen32gx500/shell-cache/js-dbg-32-armsim32-linux-x86_64-734e2e027196/js-dbg-32-armsim32-linux-x86_64-734e2e027196 +0x1993767]
#24: ???[/home/gen32gx500/shell-cache/js-dbg-32-armsim32-linux-x86_64-734e2e027196/js-dbg-32-armsim32-linux-x86_64-734e2e027196 +0x1953758]
#25: ???[/home/gen32gx500/shell-cache/js-dbg-32-armsim32-linux-x86_64-734e2e027196/js-dbg-32-armsim32-linux-x86_64-734e2e027196 +0x194d636]
Segmentation fault

```
```
The first bad revision is:
changeset:   https://hg.mozilla.org/mozilla-central/rev/ee6468bab0dd
user:        Jan de Mooij
date:        Wed Apr 05 11:37:15 2023 +0000
summary:     Bug 1826078 part 4 - Optimize GC barriers for stores to MNewCallObject. r=iain

```

Run with `--fuzzing-safe --no-threads --fast-warmup`, compile with `PKG_CONFIG_PATH=/usr/lib/x86_64-linux-gnu/pkgconfig 'CC="clang -msse2 -mfpmath=sse"' 'CXX="clang++ -msse2 -mfpmath=sse"' AR=ar sh ../configure --host=x86_64-pc-linux-gnu --target=i686-pc-linux --enable-simulator=arm --enable-debug --enable-debug-symbols --with-ccache --enable-gczeal --enable-rust-simd --disable-tests`, tested on m-c rev 734e2e027196.

Jan/Iain, is [bug 1826078](/show_bug.cgi?id=1826078 "RESOLVED FIXED - Emit bytecode to copy aliased arguments to the call object") a likely regressor? Setting s-s just in case.

Flags: sec-bounty?Flags: needinfo?(jdemooij)Flags: needinfo?(iireland)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1874502#c1)• 1 year ago |
|  | |

Set release status flags based on info from the regressing [bug 1826078](/show_bug.cgi?id=1826078 "RESOLVED FIXED - Emit bytecode to copy aliased arguments to the call object")

[status-firefox121](/buglist.cgi?f1=cf_status_firefox121&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=affected)
[status-firefox122](/buglist.cgi?f1=cf_status_firefox122&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox122&o1=equals&v1=affected)
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1874502#a5044_406194)• 1 year ago |

Group: core-security → javascript-core-security

|  | [Iain Ireland [:iain]](/user_profile?user_id=623993)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1874502#c2)• 1 year ago |
|  | |

I can reproduce this locally.

The bug is silly and trivial:

In [this code in moveValue](https://searchfox.org/mozilla-central/rev/f465027ef4d334dbc9ad270718c8a5e8045e7a2b/js/src/jit/arm/MacroAssembler-arm.cpp#4645-4651):

```
ScratchFloat32Scope scratch(*this);
  FloatRegister freg = reg.fpu();
  if (type == MIRType::Float32) {
    convertFloat32ToDouble(freg, scratch);
    freg = scratch;
  }
  ma_vxfer(freg, dest.payloadReg(), dest.typeReg());

```

convertFloat32ToDouble expects the destination register to be a double, but we are instead using the float32 scratch register. We must not enter this block in any of our tests, because it will fail every time. The fix is to use ScratchDoubleScope instead.

In non-debug builds, It looks like we actually end up generating the same code for the convertFloat32ToDouble, but slightly different code for the ma\_vxfer below. Specifically, we want:

```
eeb7fae0      vcvt f64.f32 d15, s1
ec524b1f      vmov r4, r2, d15

```

but we generate

```
eeb7fae0      vcvt f64.f32 d15, s1
ec524a1f      vmov r4, r2, s30,s31

```

Coming into this code, the single-precision FPR s1 contains some number. After this code, r4 and r2 contain a JS::Value. We want them to contain a the double-precision representation of s1. In the buggy case, they instead contain whatever happened to be in s30 and s31.

Most of the time, that will result in r4/r2 safely encoding a DoubleValue. The only case in which it would not is if it encodes a NaN, in which case it could be interpreted as any arbitrary Value, potentially opening us up to type confusion. To do so, all 11 exponent bits must be set. This implies that the corresponding bits in s30 must be set. Since there are only 8 exponent bits in a 32-bit float, A) s30 would have to be a NaN itself, and B) the 3 most significant bits of the payload of s30 must be set.

I can't think of any way to accomplish B. There are very few ways for JS code to manipulate the float32 registers. With some very delicate massaging of the register allocator, it might be possible to get a 32-bit NaN in s30 using (eg) `Math.fround(0) / Math.fround(0)`, but that will generate the default hardware NaN, with all payload bits set to 0.

So I think this is *probably* not exploitable, but it's possible I'm missing something. It's probably safest to keep it closed for now, at least until someone has had a chance to double-check my work.

This was introduced by [bug 1523941](/show_bug.cgi?id=1523941 "RESOLVED FIXED - Enforce Scratch{Double,Float32}Scope throughout the pipeline"), although it might not have been reachable before [bug 1826078](/show_bug.cgi?id=1826078 "RESOLVED FIXED - Emit bytecode to copy aliased arguments to the call object").

Severity: -- → S3Flags: needinfo?(iireland)Keywords: [sec-low](/buglist.cgi?keywords=sec-low&resolution=---)Priority: -- → P1Regressed by: [1523941](/show_bug.cgi?id=1523941 "RESOLVED FIXED - Enforce Scratch{Double,Float32}Scope throughout the pipeline")
No longer regressed by: [1826078](/show_bug.cgi?id=1826078 "RESOLVED FIXED - Emit bytecode to copy aliased arguments to the call object")

|  | [Iain Ireland [:iain]](/user_profile?user_id=623993)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1874502#c3)• 1 year ago |
|  | |

Attached file
[Bug 1874502: Use ScratchDoubleScope in moveValue r=jandem](attachment.cgi?id=9372669)
— [Details](attachment.cgi?id=9372669&action=edit)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1874502#a10237_600971)• 1 year ago |

Assignee: nobody → iirelandStatus: NEW → ASSIGNED

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1874502#a148668_695136)• 1 year ago |

[status-firefox121](/buglist.cgi?f1=cf_status_firefox121&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=wontfix)

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1874502#c4)• 1 year ago |
|  | |

Pushed by iireland@mozilla.com:
<https://hg.mozilla.org/integration/autoland/rev/974c389fc056>
Use ScratchDoubleScope in moveValue r=jandem

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1874502#c5)• 1 year ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/974c389fc056>

Group: javascript-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 1 year ago
[status-firefox123](/buglist.cgi?f1=cf_status_firefox123&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox123&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox123&o1=equals&v1=fixed)Resolution: --- → FIXED

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1874502#a312764_695136)• 1 year ago |

[status-firefox122](/buglist.cgi?f1=cf_status_firefox122&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox122&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox122&o1=equals&v1=wontfix)
[tracking-firefox-esr115](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=isnotempty):
--- → [123+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=123%2B)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1874502#a338293_75935)• 1 year ago |

[tracking-firefox123](/buglist.cgi?f1=cf_tracking_firefox123&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox123&o1=equals&v1=%2B)Flags: needinfo?(jdemooij) → in-testsuite+Target Milestone: --- → 123 Branch

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1874502#a939943_1689)• 1 year ago |

Flags: sec-bounty? → sec-bounty+

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1874502#c6)• 1 year ago |
|  | |

Gary: We're awarding an amount of the lower end of the spectrum for bug bounty, given Ian's assessment that this is likely not exploitable. We would reconsider if you can bring evidence that indicates we've been wrong.

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1874502#a1066643_488993)• 1 year ago |

QA Whiteboard: [post-critsmash-triage]Flags: qe-verify-

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1874502#c7)• 11 months ago |
|  | |

Please nominate this for ESR approval when you get a chance. It grafts cleanly.

Flags: needinfo?(iireland)

|  | [Iain Ireland [:iain]](/user_profile?user_id=623993)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1874502#c8)• 11 months ago |
|  | |

Comment on [attachment 9372669](/attachment.cgi?id=9372669 "Bug 1874502: Use ScratchDoubleScope in moveValue r=jandem") [[details]](/attachment.cgi?id=9372669&action=edit "Bug 1874502: Use ScratchDoubleScope in moveValue r=jandem")

[Bug 1874502](/show_bug.cgi?id=1874502 "RESOLVED FIXED - Assertion failure: dest.isDouble(), at jit/arm/MacroAssembler-arm.cpp:195"): Use ScratchDoubleScope in moveValue r=jandem

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: We think this bug is unlikely to be exploitable, but the patch is small and well understood.
* **User impact if declined**: Incorrect code generation in a weird case. Small chance that we've missed an avenue of exploitation. Only occurs on 32-bit Arm devices.
* **Fix Landed on Version**: 123
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: It's a one-line patch fixing an obvious bug in a cold code path.

### Beta/Release Uplift Approval Request

* **User impact if declined**: Incorrect code generation in a weird case. Small chance that we've missed an avenue of exploitation. Only occurs on 32-bit Arm devices.
* **Is this code covered by automated tests?**: Yes
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: No
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: It's a one-line patch fixing an obvious bug in a cold code path.
* **String changes made/needed**: None
* **Is Android affected?**: Yes
Flags: needinfo?(iireland)
[Attachment #9372669](/attachment.cgi?id=9372669&action=edit "Bug 1874502: Use ScratchDoubleScope in moveValue r=jandem") -
Flags: approval-mozilla-esr115?
[Attachment #9372669](/attachment.cgi?id=9372669&action=edit "Bug 1874502: Use ScratchDoubleScope in moveValue r=jandem") -
Flags: approval-mozilla-beta?

|  | [Iain Ireland [:iain]](/user_profile?user_id=623993)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1874502#c9)• 11 months ago |
|  | |

Not sure if we also want this in beta/release, so I added those requests just in case.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1874502#c10)• 11 months ago |
|  | |

Comment on [attachment 9372669](/attachment.cgi?id=9372669 "Bug 1874502: Use ScratchDoubleScope in moveValue r=jandem") [[details]](/attachment.cgi?id=9372669&action=edit "Bug 1874502: Use ScratchDoubleScope in moveValue r=jandem")

[Bug 1874502](/show_bug.cgi?id=1874502 "RESOLVED FIXED - Assertion failure: dest.isDouble(), at jit/arm/MacroAssembler-arm.cpp:195"): Use ScratchDoubleScope in moveValue r=jandem

This landed during the last cycle, so it's already on track to ship in the 123 release.

[Attachment #9372669](/attachment.cgi?id=9372669&action=edit "Bug 1874502: Use ScratchDoubleScope in moveValue r=jandem") -
Flags: approval-mozilla-beta?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1874502#c11)• 11 months ago |
|  | |

Comment on [attachment 9372669](/attachment.cgi?id=9372669 "Bug 1874502: Use ScratchDoubleScope in moveValue r=jandem") [[details]](/attachment.cgi?id=9372669&action=edit "Bug 1874502: Use ScratchDoubleScope in moveValue r=jandem")

[Bug 1874502](/show_bug.cgi?id=1874502 "RESOLVED FIXED - Assertion failure: dest.isDouble(), at jit/arm/MacroAssembler-arm.cpp:195"): Use ScratchDoubleScope in moveValue r=jandem

Approved for 115.8esr.

[Attachment #9372669](/attachment.cgi?id=9372669&action=edit "Bug 1874502: Use ScratchDoubleScope in moveValue r=jandem") -
Flags: approval-mozilla-esr115? → approval-mozilla-esr115+

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1874502#c12)• 11 months ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr115/rev/4aebdf426218>

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1874502#a2344427_75935)• 11 months ago |

[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1874502#a2758507_578488)• 11 months ago |

Whiteboard: [adv-main123+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1874502#a2760803_578488)• 11 months ago |

Whiteboard: [adv-main123+] → [adv-main123+][adv-esr115.8+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1874502#c13)• 11 months ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9380030)
— [Details](attachment.cgi?id=9380030&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1874502#a2922550_578488)• 11 months ago |

Alias: CVE-2024-1552

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1874502#a7587875_132034)• 9 months ago |

Blocks: [gkw-js-fuzzing](/show_bug.cgi?id=1890610 "NEW - [meta] Gary JavaScript engine Fuzzing")

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1874502#a11995562_5898)• 7 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1874502#a21373457_1689)• 4 months ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1874502&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review

