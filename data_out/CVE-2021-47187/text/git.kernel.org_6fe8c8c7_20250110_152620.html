

| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=118c826ef8b43efe0fda8faf419673707ee8c5e5)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=118c826ef8b43efe0fda8faf419673707ee8c5e5)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=118c826ef8b43efe0fda8faf419673707ee8c5e5)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=118c826ef8b43efe0fda8faf419673707ee8c5e5)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | AngeloGioacchino Del Regno <angelogioacchino.delregno@somainline.org> | 2021-09-01 20:31:21 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-11-25 09:48:25 +0100 |
| commit | [118c826ef8b43efe0fda8faf419673707ee8c5e5](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=118c826ef8b43efe0fda8faf419673707ee8c5e5) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=118c826ef8b43efe0fda8faf419673707ee8c5e5)) | |
| tree | [cc2777bd1c4d5b8e0271bd0dcac7bacc60b9c4f9](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=118c826ef8b43efe0fda8faf419673707ee8c5e5) | |
| parent | [30a3826f7fa9035bfac6cc3b741758b2111e5936](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=30a3826f7fa9035bfac6cc3b741758b2111e5936) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=118c826ef8b43efe0fda8faf419673707ee8c5e5&id2=30a3826f7fa9035bfac6cc3b741758b2111e5936)) | |
| download | [linux-118c826ef8b43efe0fda8faf419673707ee8c5e5.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-118c826ef8b43efe0fda8faf419673707ee8c5e5.tar.gz) | |

arm64: dts: qcom: msm8998: Fix CPU/L2 idle state latency and residency[ Upstream commit 3f1dcaff642e75c1d2ad03f783fa8a3b1f56dd50 ]
The entry/exit latency and minimum residency in state for the idle
states of MSM8998 were ..bad: first of all, for all of them the
timings were written for CPU sleep but the min-residency-us param
was miscalculated (supposedly, while porting this from downstream);
Then, the power collapse states are setting PC on both the CPU
cluster \*and\* the L2 cache, which have different timings: in the
specific case of L2 the times are higher so these ones should be
taken into account instead of the CPU ones.
This parameter misconfiguration was not giving particular issues
because on MSM8998 there was no CPU scaling at all, so cluster/L2
power collapse was rarely (if ever) hit.
When CPU scaling is enabled, though, the wrong timings will produce
SoC unstability shown to the user as random, apparently error-less,
sudden reboots and/or lockups.
This set of parameters are stabilizing the SoC when CPU scaling is
ON and when power collapse is frequently hit.
Signed-off-by: AngeloGioacchino Del Regno <angelogioacchino.delregno@somainline.org>
Signed-off-by: Bjorn Andersson <bjorn.andersson@linaro.org>
Link: [https://lore.kernel.org/r/20210901183123.1087392-3-angelogioacchino.delregno@somainline.org](https://lore.kernel.org/r/20210901183123.1087392-3-angelogioacchino.delregno%40somainline.org)
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=118c826ef8b43efe0fda8faf419673707ee8c5e5)

| -rw-r--r-- | [arch/arm64/boot/dts/qcom/msm8998.dtsi](/pub/scm/linux/kernel/git/stable/linux.git/diff/arch/arm64/boot/dts/qcom/msm8998.dtsi?id=118c826ef8b43efe0fda8faf419673707ee8c5e5) | 20 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 12 insertions, 8 deletions

| diff --git a/arch/arm64/boot/dts/qcom/msm8998.dtsi b/arch/arm64/boot/dts/qcom/msm8998.dtsiindex 34039b5c80175e..5a221cfc41387e 100644--- a/[arch/arm64/boot/dts/qcom/msm8998.dtsi](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/arm64/boot/dts/qcom/msm8998.dtsi?id=30a3826f7fa9035bfac6cc3b741758b2111e5936)+++ b/[arch/arm64/boot/dts/qcom/msm8998.dtsi](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/arm64/boot/dts/qcom/msm8998.dtsi?id=118c826ef8b43efe0fda8faf419673707ee8c5e5)@@ -308,38 +308,42 @@ LITTLE\_CPU\_SLEEP\_0: cpu-sleep-0-0 { compatible = "arm,idle-state"; idle-state-name = "little-retention";+ /\* CPU Retention (C2D), L2 Active \*/ arm,psci-suspend-param = <0x00000002>; entry-latency-us = <81>; exit-latency-us = <86>;- min-residency-us = <200>;+ min-residency-us = <504>; };  LITTLE\_CPU\_SLEEP\_1: cpu-sleep-0-1 { compatible = "arm,idle-state"; idle-state-name = "little-power-collapse";+ /\* CPU + L2 Power Collapse (C3, D4) \*/ arm,psci-suspend-param = <0x40000003>;- entry-latency-us = <273>;- exit-latency-us = <612>;- min-residency-us = <1000>;+ entry-latency-us = <814>;+ exit-latency-us = <4562>;+ min-residency-us = <9183>; local-timer-stop; };  BIG\_CPU\_SLEEP\_0: cpu-sleep-1-0 { compatible = "arm,idle-state"; idle-state-name = "big-retention";+ /\* CPU Retention (C2D), L2 Active \*/ arm,psci-suspend-param = <0x00000002>; entry-latency-us = <79>; exit-latency-us = <82>;- min-residency-us = <200>;+ min-residency-us = <1302>; };  BIG\_CPU\_SLEEP\_1: cpu-sleep-1-1 { compatible = "arm,idle-state"; idle-state-name = "big-power-collapse";+ /\* CPU + L2 Power Collapse (C3, D4) \*/ arm,psci-suspend-param = <0x40000003>;- entry-latency-us = <336>;- exit-latency-us = <525>;- min-residency-us = <1000>;+ entry-latency-us = <724>;+ exit-latency-us = <2027>;+ min-residency-us = <9419>; local-timer-stop; }; }; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 15:24:57 +0000

