
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpytorch%2Fpytorch%2Fissues%2F88868)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpytorch%2Fpytorch%2Fissues%2F88868)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=pytorch%2Fpytorch)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[pytorch](/pytorch)
/
**[pytorch](/pytorch/pytorch)**
Public

* [Notifications](/login?return_to=%2Fpytorch%2Fpytorch) You must be signed in to change notification settings
* [Fork
  23.1k](/login?return_to=%2Fpytorch%2Fpytorch)
* [Star
   85.6k](/login?return_to=%2Fpytorch%2Fpytorch)

* [Code](/pytorch/pytorch)
* [Issues
  5k+](/pytorch/pytorch/issues)
* [Pull requests
  1.1k](/pytorch/pytorch/pulls)
* [Actions](/pytorch/pytorch/actions)
* [Projects
  12](/pytorch/pytorch/projects)
* [Wiki](/pytorch/pytorch/wiki)
* [Security](/pytorch/pytorch/security)
* [Insights](/pytorch/pytorch/pulse)

Additional navigation options

* [Code](/pytorch/pytorch)
* [Issues](/pytorch/pytorch/issues)
* [Pull requests](/pytorch/pytorch/pulls)
* [Actions](/pytorch/pytorch/actions)
* [Projects](/pytorch/pytorch/projects)
* [Wiki](/pytorch/pytorch/wiki)
* [Security](/pytorch/pytorch/security)
* [Insights](/pytorch/pytorch/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fpytorch%2Fpytorch%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fpytorch%2Fpytorch%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# `torch.jit.annotations.parse_type_line` is not safe (command injection) even it seems already deprecated. #88868

Closed

[Lyutoon](/Lyutoon) opened this issue
Nov 11, 2022
· 16 comments

Closed

# [`torch.jit.annotations.parse_type_line` is not safe (command injection) even it seems already deprecated.](#top) #88868

[Lyutoon](/Lyutoon) opened this issue
Nov 11, 2022
· 16 comments

Assignees
[![@malfet](https://avatars.githubusercontent.com/u/2453524?s=40&v=4)](/malfet)

Labels
[high priority](/pytorch/pytorch/labels/high%20priority)
[oncall: jit](/pytorch/pytorch/labels/oncall%3A%20jit)
Add this issue/PR to JIT oncall triage queue
[topic: security](/pytorch/pytorch/labels/topic%3A%20security)
[triaged](/pytorch/pytorch/labels/triaged)
This issue has been looked at a team member, and triaged and prioritized into an appropriate module

Milestone
[1.13.1](/pytorch/pytorch/milestone/34 "1.13.1")

## Comments

[![@Lyutoon](https://avatars.githubusercontent.com/u/57178900?s=80&u=333840d0116ae758b4e2a59f213bf863bcb0efac&v=4)](/Lyutoon)

Copy link

### **[Lyutoon](/Lyutoon)** commented [Nov 11, 2022](#issue-1444898821) • edited by pytorch-bot bot Loading

| 🐛 Describe the bug In `torch.jit.annotations`, it looks like there are some functions that are deprecated, but still retain code, which may lead to some backdoors, especially since some of these functions still use eval while implementing. But now I'm not sure if there are some features (jit decorator) in some version of pytorch are still using this function `parse_type_line` or `get_signature` which calls `parse_type_line`, if so, it can cause RCE, if not, maybe someone can also leave a backdoor by calling this function while writing code and share it to the people.  ``` import torch  torch.jit.annotations.parse_type_line('# type: __import__("os").system("ls") -> 234', None, 1)  ``` Versions master  cc [@ezyang](https://github.com/ezyang) [@gchanan](https://github.com/gchanan) [@zou3519](https://github.com/zou3519) [@EikanWang](https://github.com/EikanWang) [@jgong5](https://github.com/jgong5) [@wenzhe-nrv](https://github.com/wenzhe-nrv) [@sanchitintel](https://github.com/sanchitintel) |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@malfet](https://avatars.githubusercontent.com/u/2453524?s=40&v=4)](/malfet)
[malfet](/malfet)
added
[triage review](/pytorch/pytorch/labels/triage%20review)
[topic: security](/pytorch/pytorch/labels/topic%3A%20security)
labels
[Nov 11, 2022](#event-7795400166)

[![@malfet](https://avatars.githubusercontent.com/u/2453524?s=80&v=4)](/malfet)

Copy link

Contributor

### **[malfet](/malfet)** commented [Nov 14, 2022](#issuecomment-1314140058) • edited Loading

| Marking for triage review(and not assigning `oncall: jit` yet otherwise it will disappear to the void) to discuss what to do with those kinds of security issues, which, in my opinion, is pretty minor: if one have an access to local Python runtime they can do anything they want. |
| --- |

All reactions

Sorry, something went wrong.

[![@Lyutoon](https://avatars.githubusercontent.com/u/57178900?s=80&u=333840d0116ae758b4e2a59f213bf863bcb0efac&v=4)](/Lyutoon)

Copy link

Author

### **[Lyutoon](/Lyutoon)** commented [Nov 14, 2022](#issuecomment-1314151854) • edited Loading

| Marking for triage review(and not assigning `oncall: jit` yet otherwise it will disappear to the void) to discuss what to do with those kinds of security issues, which is in my opinion is pretty minor: if one have an access to local Python runtime they can do anything they want.  Yes, this seems not a very urgent bug, but we still need to pay attention to these dangerouse functions such as `eval`. And in `CVE-2022-0845`, this bug is also caused by using `eval` to parse the args so it leads to code injection, and it seems also must have an access to local python. To be honest, I don't know how people think about these kind of problems, but we need to pay more attention :p. So we need a discuss about it whether it can be considered as a big security problem. |
| --- |

All reactions

Sorry, something went wrong.

[![@malfet](https://avatars.githubusercontent.com/u/2453524?s=40&v=4)](/malfet)
[malfet](/malfet)
added
the
[high priority](/pytorch/pytorch/labels/high%20priority)
label
[Nov 14, 2022](#event-7806939203)

[![@malfet](https://avatars.githubusercontent.com/u/2453524?s=40&v=4)](/malfet)
[malfet](/malfet)
self-assigned this
[Nov 14, 2022](#event-7806939511)

[![@malfet](https://avatars.githubusercontent.com/u/2453524?s=80&v=4)](/malfet)

Copy link

Contributor

### **[malfet](/malfet)** commented [Nov 14, 2022](#issuecomment-1314194550)

| We should have a doc marking unsafe function and safe versions of the same. And also, probably should not use eval, if possible. |
| --- |

All reactions

Sorry, something went wrong.

[![@albanD](https://avatars.githubusercontent.com/u/6359743?s=40&u=a16baafdb56425ca87d72608c747d53cc3de6fd2&v=4)](/albanD)
[albanD](/albanD)
added
[oncall: jit](/pytorch/pytorch/labels/oncall%3A%20jit)
Add this issue/PR to JIT oncall triage queue
and removed
[triage review](/pytorch/pytorch/labels/triage%20review)
labels
[Nov 14, 2022](#event-7806953965)

[![@malfet](https://avatars.githubusercontent.com/u/2453524?s=40&v=4)](/malfet)
[malfet](/malfet)
added
[triage review](/pytorch/pytorch/labels/triage%20review)
and removed
[triage review](/pytorch/pytorch/labels/triage%20review)
labels
[Nov 14, 2022](#event-7806954973)

[![@Lyutoon](https://avatars.githubusercontent.com/u/57178900?s=80&u=333840d0116ae758b4e2a59f213bf863bcb0efac&v=4)](/Lyutoon)

Copy link

Author

### **[Lyutoon](/Lyutoon)** commented [Nov 14, 2022](#issuecomment-1314204637)

| We should have a doc marking unsafe function and safe versions of the same. And also, probably should not use eval, if possible.  That's right, there was also a cve (<https://github.com/tensorflow/tensorflow/blob/master/tensorflow/security/advisory/tfsa-2022-060.md>) in tensorflow that used `eval` in `saved_model_cli` and caused code injection. Also I've found that PaddlePaddle has also `eval` problems (<https://github.com/PaddlePaddle/Paddle/blob/develop/security/advisory/pdsa-2022-002.md>). But sometimes, if we do not use `eval`, the code will become much more complex. Maybe developers can just add a critical check about the parameters of the function to avoid this problem easily (if possible). |
| --- |

All reactions

Sorry, something went wrong.

[![@malfet](https://avatars.githubusercontent.com/u/2453524?s=40&v=4)](/malfet)
[malfet](/malfet)
added
the
[triaged](/pytorch/pytorch/labels/triaged)
This issue has been looked at a team member, and triaged and prioritized into an appropriate module
label
[Nov 17, 2022](#event-7830058313)

[![@malfet](https://avatars.githubusercontent.com/u/2453524?s=80&v=4)](/malfet)

Copy link

Contributor

### **[malfet](/malfet)** commented [Nov 17, 2022](#issuecomment-1318045583)

| It seems reasonable, that valid type annotations should not have any funciton/method calls, so splitting it into `compile` (which is safe)->error on function calls->`eval` would secure the deprecated codebase without overcomplicating deprecated code too much |
| --- |

 👍
1
 Lyutoon reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@malfet](https://avatars.githubusercontent.com/u/2453524?s=40&v=4)](/malfet)
[malfet](/malfet)
mentioned this issue
[Nov 17, 2022](#ref-pullrequest-1452755562)

[[JIT][Security] Do not blindly eval input string
#89189](/pytorch/pytorch/pull/89189)
 Closed

[![@pytorchmergebot](https://avatars.githubusercontent.com/u/97764156?s=40&u=088b606990ce89d2c126e1762165677ecad185e1&v=4)](/pytorchmergebot)
[pytorchmergebot](/pytorchmergebot)
closed this as [completed](/pytorch/pytorch/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
in
`[767f6aa](/pytorch/pytorch/commit/767f6aa49fe20a2766b9843d01e3b7f7793df6a3)`
[Nov 17, 2022](#event-7838220895)

[![@roywei](https://avatars.githubusercontent.com/u/8022184?s=80&u=dcec6877a44fbd7ee3361ec680ec1017e7b6d033&v=4)](/roywei)

Copy link

### **[roywei](/roywei)** commented [Nov 29, 2022](#issuecomment-1331326519)

| Hi guys, is there any plan to release this patch to torch 1.12.x and 1.13.x? any ETAs? thanks! |
| --- |

 👍
2
 igygi and LourencoVazPato reacted with thumbs up emoji

All reactions

* 👍
  2 reactions

Sorry, something went wrong.

[![@roywei](https://avatars.githubusercontent.com/u/8022184?s=40&u=dcec6877a44fbd7ee3361ec680ec1017e7b6d033&v=4)](/roywei)
[roywei](/roywei)
mentioned this issue
[Nov 29, 2022](#ref-issue-1468528885)

[[v.1.13.1] Release Tracker
#89855](/pytorch/pytorch/issues/89855)

Closed

[![@seemethere](https://avatars.githubusercontent.com/u/1700823?s=80&u=ff3f02b52090e9730ab694329715be95805dc5c4&v=4)](/seemethere)

Copy link

Member

### **[seemethere](/seemethere)** commented [Nov 30, 2022](#issuecomment-1332460032)

| Hi guys, is there any plan to release this patch to torch 1.12.x and 1.13.x? any ETAs? thanks!  We don't currently have any plans to do continued releases for 1.12.x but given the security implications of this this patch *will* be included in the next patch release for 1.13.x |
| --- |

 👍
1
 roywei reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@seemethere](https://avatars.githubusercontent.com/u/1700823?s=40&u=ff3f02b52090e9730ab694329715be95805dc5c4&v=4)](/seemethere)
[seemethere](/seemethere)
added this to the [1.13.1](/pytorch/pytorch/milestone/34) milestone
[Nov 30, 2022](#event-7924029903)

[atalman](/atalman)
pushed a commit
to atalman/pytorch
that referenced
this issue
[Nov 30, 2022](#ref-commit-78cad99)
[![@malfet](https://avatars.githubusercontent.com/u/2453524?s=40&v=4)](/malfet) [![@atalman](https://avatars.githubusercontent.com/u/7563158?s=40&v=4)](/atalman)

`[[JIT][Security] Do not blindly eval input string (](/atalman/pytorch/commit/78cad998e505b667d25ac42f8aaa24409f5031e1 "[JIT][Security] Do not blindly eval input string (#89189)

Introduce `_eval_no_call` method, that evaluates statement only if it
does not contain any calls(done by examining the bytecode), thus preventing command injection exploit

Added simple unit test to check for that
`torch.jit.annotations.get_signature` would not result in calling random
code.

Although, this code path exists for Python-2 compatibility, and perhaps
should be simply removed.

Fixes https://github.com/pytorch/pytorch/issues/88868

Pull Request resolved: https://github.com/pytorch/pytorch/pull/89189
Approved by: https://github.com/suo")[pytorch#89189](https://github.com/pytorch/pytorch/pull/89189)[)](/atalman/pytorch/commit/78cad998e505b667d25ac42f8aaa24409f5031e1 "[JIT][Security] Do not blindly eval input string (#89189)

Introduce `_eval_no_call` method, that evaluates statement only if it
does not contain any calls(done by examining the bytecode), thus preventing command injection exploit

Added simple unit test to check for that
`torch.jit.annotations.get_signature` would not result in calling random
code.

Although, this code path exists for Python-2 compatibility, and perhaps
should be simply removed.

Fixes https://github.com/pytorch/pytorch/issues/88868

Pull Request resolved: https://github.com/pytorch/pytorch/pull/89189
Approved by: https://github.com/suo")`
…

`[78cad99](/atalman/pytorch/commit/78cad998e505b667d25ac42f8aaa24409f5031e1)`

```
Introduce `_eval_no_call` method, that evaluates statement only if it
does not contain any calls(done by examining the bytecode), thus preventing command injection exploit

Added simple unit test to check for that
`torch.jit.annotations.get_signature` would not result in calling random
code.

Although, this code path exists for Python-2 compatibility, and perhaps
should be simply removed.

Fixes [pytorch#88868](https://github.com/pytorch/pytorch/issues/88868)

Pull Request resolved: [pytorch#89189](https://github.com/pytorch/pytorch/pull/89189)
Approved by: <https://github.com/suo>
```

[![@atalman](https://avatars.githubusercontent.com/u/7563158?s=40&u=c2f7e1176434abb5e838e8f5c68493edb1f1e54f&v=4)](/atalman)
[atalman](/atalman)
mentioned this issue
[Nov 30, 2022](#ref-pullrequest-1469984438)

[[JIT][Security] Do not blindly eval input string (#89189)
#89925](/pytorch/pytorch/pull/89925)
 Merged

[malfet](/malfet)
added a commit
that referenced
this issue
[Nov 30, 2022](#ref-commit-74a9ca9)
[![@atalman](https://avatars.githubusercontent.com/u/7563158?s=40&u=c2f7e1176434abb5e838e8f5c68493edb1f1e54f&v=4)](/atalman) [![@malfet](https://avatars.githubusercontent.com/u/2453524?s=40&v=4)](/malfet)

`[[JIT][Security] Do not blindly eval input string (](/pytorch/pytorch/commit/74a9ca993bd79f8131829e9c946657fa9a1d05ef "[JIT][Security] Do not blindly eval input string (#89189) (#89925)

Introduce `_eval_no_call` method, that evaluates statement only if it
does not contain any calls(done by examining the bytecode), thus preventing command injection exploit

Added simple unit test to check for that
`torch.jit.annotations.get_signature` would not result in calling random
code.

Although, this code path exists for Python-2 compatibility, and perhaps
should be simply removed.

Fixes https://github.com/pytorch/pytorch/issues/88868

Pull Request resolved: https://github.com/pytorch/pytorch/pull/89189
Approved by: https://github.com/suo

Co-authored-by: Nikita Shulga <nshulga@meta.com>")[#89189](https://github.com/pytorch/pytorch/pull/89189)[) (](/pytorch/pytorch/commit/74a9ca993bd79f8131829e9c946657fa9a1d05ef "[JIT][Security] Do not blindly eval input string (#89189) (#89925)

Introduce `_eval_no_call` method, that evaluates statement only if it
does not contain any calls(done by examining the bytecode), thus preventing command injection exploit

Added simple unit test to check for that
`torch.jit.annotations.get_signature` would not result in calling random
code.

Although, this code path exists for Python-2 compatibility, and perhaps
should be simply removed.

Fixes https://github.com/pytorch/pytorch/issues/88868

Pull Request resolved: https://github.com/pytorch/pytorch/pull/89189
Approved by: https://github.com/suo

Co-authored-by: Nikita Shulga <nshulga@meta.com>")[#89925](https://github.com/pytorch/pytorch/pull/89925)[)](/pytorch/pytorch/commit/74a9ca993bd79f8131829e9c946657fa9a1d05ef "[JIT][Security] Do not blindly eval input string (#89189) (#89925)

Introduce `_eval_no_call` method, that evaluates statement only if it
does not contain any calls(done by examining the bytecode), thus preventing command injection exploit

Added simple unit test to check for that
`torch.jit.annotations.get_signature` would not result in calling random
code.

Although, this code path exists for Python-2 compatibility, and perhaps
should be simply removed.

Fixes https://github.com/pytorch/pytorch/issues/88868

Pull Request resolved: https://github.com/pytorch/pytorch/pull/89189
Approved by: https://github.com/suo

Co-authored-by: Nikita Shulga <nshulga@meta.com>")`
…

`[74a9ca9](/pytorch/pytorch/commit/74a9ca993bd79f8131829e9c946657fa9a1d05ef)`

```
Introduce `_eval_no_call` method, that evaluates statement only if it
does not contain any calls(done by examining the bytecode), thus preventing command injection exploit

Added simple unit test to check for that
`torch.jit.annotations.get_signature` would not result in calling random
code.

Although, this code path exists for Python-2 compatibility, and perhaps
should be simply removed.

Fixes [#88868](https://github.com/pytorch/pytorch/issues/88868)

Pull Request resolved: [#89189](https://github.com/pytorch/pytorch/pull/89189)
Approved by: <https://github.com/suo>

Co-authored-by: Nikita Shulga <nshulga@meta.com>
```

[![@Vatshank](https://avatars.githubusercontent.com/u/7770148?s=40&v=4)](/Vatshank)
[Vatshank](/Vatshank)
mentioned this issue
[Dec 2, 2022](#ref-pullrequest-1473338238)

[[pytorch] [trcomp] Updated binaries with CVE fix for PT.12 SM Training Compiler
aws/deep-learning-containers#2478](/aws/deep-learning-containers/pull/2478)
 Merged

18 tasks

[![@NicolasGensollen](https://avatars.githubusercontent.com/u/2639645?s=40&v=4)](/NicolasGensollen)
[NicolasGensollen](/NicolasGensollen)
mentioned this issue
[Dec 5, 2022](#ref-issue-1475948306)

[Vulnerability in PyTorch until release 1.13.1
aramis-lab/clinicadl#358](/aramis-lab/clinicadl/issues/358)

Open

[![@bendeaton](https://avatars.githubusercontent.com/u/540540?s=80&u=567ca44ffdfd8a7f15f47efbc7e4975b704527cc&v=4)](/bendeaton)

Copy link

### **[bendeaton](/bendeaton)** commented [Dec 5, 2022](#issuecomment-1338190237)

| Can someone explain in more detail what the actual vulnerability is and how to determine whether a given code base actually uses the offending code?  The Pytorch/jit docs ([link](https://pytorch.org/docs/stable/jit.html#migrating-to-pytorch-1-2-recursive-scripting-api)) note that “Python 3 type hints can be used in place of `torch.jit.annotate`” ; does this imply that it’s possible to ameliorate the vulnerability by fully type-hinting all user functions compiled by jit, and if so how can these functions be identified?  Does this vulnerability apply only to compiled functions using Pytorch, or does it extend to things that could be injected into an inference request to trigger the privilege escalation issue? |
| --- |

All reactions

Sorry, something went wrong.

[![@ezyang](https://avatars.githubusercontent.com/u/13564?s=80&v=4)](/ezyang)

Copy link

Contributor

### **[ezyang](/ezyang)** commented [Dec 5, 2022](#issuecomment-1338252251)

| I believe the vulnerability is, if someone crafts a malicious Python file, and then you compile it TorchScript, it can trigger arbitrary code execution. That being said, I'm not really sure what your threat model is, since you probably already have problems if you're compiling arbitrary malicious Python code with TorchScript? |
| --- |

 👍
2
 malfet and guokaiSama reacted with thumbs up emoji

All reactions

* 👍
  2 reactions

Sorry, something went wrong.

[![@ardell](https://avatars.githubusercontent.com/u/90694?s=80&u=147ade7a96caa787612e1fdca169dcebbc6c3477&v=4)](/ardell)

Copy link

### **[ardell](/ardell)** commented [Dec 5, 2022](#issuecomment-1338268765)

| That was my assessment as well, based on a cursory read of the issue and the docs I could find.  It does seem confusing that the CVSS score lists the attack vector as "Network", attack complexity as "Low", and privileges required as "None" if this vulnerability requires compiling the malicious python code to TorchScript.  The CVSS makes it seem like someone could trigger the vulnerability via (for example) a maliciously-crafted inference request (without any arbitrary code compilation) -- which would certainly be a critical security vulnerability. I'm interested in ruling that out if possible, especially while we wait for a patched version to be released... |
| --- |

All reactions

Sorry, something went wrong.

[![@ezyang](https://avatars.githubusercontent.com/u/13564?s=80&v=4)](/ezyang)

Copy link

Contributor

### **[ezyang](/ezyang)** commented [Dec 6, 2022](#issuecomment-1338633468)

| Definite not via user controlled tensor inputs. There is no vector for type annotations there |
| --- |

All reactions

Sorry, something went wrong.

[![@malfet](https://avatars.githubusercontent.com/u/2453524?s=80&v=4)](/malfet)

Copy link

Contributor

### **[malfet](/malfet)** commented [Dec 6, 2022](#issuecomment-1338682873)

| I guess the problem here is that `torch.jit.annotations.parse_type_line` looks like a public API, which means that dev can use it in their code to extract function annotation and arbitrary code execution feels like a very unexpected side-effect of calling such function. |
| --- |

All reactions

Sorry, something went wrong.

[![@abustamante-coveo](https://avatars.githubusercontent.com/u/91753112?s=80&u=c6761cfa315a0f5e28fbaf244cbed612eb5a400c&v=4)](/abustamante-coveo)

Copy link

### **[abustamante-coveo](/abustamante-coveo)** commented [Dec 6, 2022](#issuecomment-1339488600)

| hello, is there an ETA on 1.13.1? |
| --- |

All reactions

Sorry, something went wrong.

[![@malfet](https://avatars.githubusercontent.com/u/2453524?s=80&v=4)](/malfet)

Copy link

Contributor

### **[malfet](/malfet)** commented [Dec 6, 2022](#issuecomment-1339715032)

| [@abustamante-coveo](https://github.com/abustamante-coveo) tentatively Dec 15th, see [#89855](https://github.com/pytorch/pytorch/issues/89855) |
| --- |

 👍
1
 abustamante-coveo reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[kulinseth](/kulinseth)
pushed a commit
to kulinseth/pytorch
that referenced
this issue
[Dec 10, 2022](#ref-commit-e9b5d8f)
[![@malfet](https://avatars.githubusercontent.com/u/2453524?s=40&v=4)](/malfet) [![@kulinseth](https://avatars.githubusercontent.com/u/453004?s=40&v=4)](/kulinseth)

`[[JIT][Security] Do not blindly eval input string (](/kulinseth/pytorch/commit/e9b5d8f74ca2969cab8bb9f6cd65053dde90689b "[JIT][Security] Do not blindly eval input string (#89189)

Introduce `_eval_no_call` method, that evaluates statement only if it
does not contain any calls(done by examining the bytecode), thus preventing command injection exploit

Added simple unit test to check for that
`torch.jit.annotations.get_signature` would not result in calling random
code.

Although, this code path exists for Python-2 compatibility, and perhaps
should be simply removed.

Fixes https://github.com/pytorch/pytorch/issues/88868

Pull Request resolved: https://github.com/pytorch/pytorch/pull/89189
Approved by: https://github.com/suo")[pytorch#89189](https://github.com/pytorch/pytorch/pull/89189)[)](/kulinseth/pytorch/commit/e9b5d8f74ca2969cab8bb9f6cd65053dde90689b "[JIT][Security] Do not blindly eval input string (#89189)

Introduce `_eval_no_call` method, that evaluates statement only if it
does not contain any calls(done by examining the bytecode), thus preventing command injection exploit

Added simple unit test to check for that
`torch.jit.annotations.get_signature` would not result in calling random
code.

Although, this code path exists for Python-2 compatibility, and perhaps
should be simply removed.

Fixes https://github.com/pytorch/pytorch/issues/88868

Pull Request resolved: https://github.com/pytorch/pytorch/pull/89189
Approved by: https://github.com/suo")`
…

`[e9b5d8f](/kulinseth/pytorch/commit/e9b5d8f74ca2969cab8bb9f6cd65053dde90689b)`

```
Introduce `_eval_no_call` method, that evaluates statement only if it
does not contain any calls(done by examining the bytecode), thus preventing command injection exploit

Added simple unit test to check for that
`torch.jit.annotations.get_signature` would not result in calling random
code.

Although, this code path exists for Python-2 compatibility, and perhaps
should be simply removed.

Fixes [pytorch#88868](https://github.com/pytorch/pytorch/issues/88868)

Pull Request resolved: [pytorch#89189](https://github.com/pytorch/pytorch/pull/89189)
Approved by: <https://github.com/suo>
```

[![@dhrubo-os](https://avatars.githubusercontent.com/u/109556906?s=40&v=4)](/dhrubo-os)
[dhrubo-os](/dhrubo-os)
mentioned this issue
[Dec 12, 2022](#ref-issue-1473349191)

[CVE-2022-45907 (High) detected in torch-1.12.1-cp37-cp37m-manylinux1\_x86\_64.whl, torch-1.13.0-cp37-cp37m-manylinux1\_x86\_64.whl - autoclosed
opensearch-project/opensearch-py-ml#49](/opensearch-project/opensearch-py-ml/issues/49)

Closed

[![@abustamante-coveo](https://avatars.githubusercontent.com/u/91753112?s=80&u=c6761cfa315a0f5e28fbaf244cbed612eb5a400c&v=4)](/abustamante-coveo)

Copy link

### **[abustamante-coveo](/abustamante-coveo)** commented [Dec 16, 2022](#issuecomment-1355112484)

| hello, Snyk still marks torch as having a critical vulnerability even after the 1.13.1 patch. Was this vulnerability supposed to be patched on that version? |
| --- |

 👍
3
 vikcher, eaidova, and completerevolution reacted with thumbs up emoji

All reactions

* 👍
  3 reactions

Sorry, something went wrong.

[![@vikcher](https://avatars.githubusercontent.com/u/4031535?s=80&v=4)](/vikcher)

Copy link

### **[vikcher](/vikcher)** commented [Dec 16, 2022](#issuecomment-1355607144)

| hello, Snyk still marks torch as having a critical vulnerability even after the 1.13.1 patch. Was this vulnerability supposed to be patched on that version?  Looks like their vulnerability database is not updated after the fix. It shows that the fix is pushed but not published: <https://security.snyk.io/vuln/SNYK-PYTHON-TORCH-3149871> |
| --- |

All reactions

Sorry, something went wrong.

This was referenced Jan 5, 2023

[[WIP][DO NOT MERGE] Update version of torch, lightning, transformers in multimodal
autogluon/autogluon#2479](/autogluon/autogluon/pull/2479)
 Closed

[Update torch to 1.13.1+
autogluon/autogluon#2627](/autogluon/autogluon/issues/2627)

Closed

[![@i-chvets](https://avatars.githubusercontent.com/u/113444075?s=40&v=4)](/i-chvets)
[i-chvets](/i-chvets)
mentioned this issue
[Jan 25, 2023](#ref-issue-1555728480)

[Update images to address CVEs 24.01.23
canonical/notebook-operators#109](/canonical/notebook-operators/issues/109)

Closed

[![@ganler](https://avatars.githubusercontent.com/u/38074777?s=40&v=4)](/ganler)
[ganler](/ganler)
mentioned this issue
[Feb 8, 2023](#ref-issue-1516914684)

[[Crash] `torch.searchsorted` with out-of-bound sorter
#91606](/pytorch/pytorch/issues/91606)

Closed

[![@saitcakmak](https://avatars.githubusercontent.com/u/9263852?s=40&v=4)](/saitcakmak)
[saitcakmak](/saitcakmak)
mentioned this issue
[Feb 14, 2023](#ref-issue-1583672497)

[Raise torch lower version bound to `>=1.13.1` (CVE-2022-45907)
pytorch/botorch#1673](/pytorch/botorch/issues/1673)

Closed

[![@jongwook](https://avatars.githubusercontent.com/u/266841?s=40&v=4)](/jongwook)
[jongwook](/jongwook)
mentioned this issue
[Mar 6, 2023](#ref-issue-1612174768)

[Pytorch 1.7 contains vulnerability that is fixed in upgraded version
openai/CLIP#333](/openai/CLIP/issues/333)

Open

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fpytorch%2Fpytorch%2Fissues%2F88868)

Assignees

[![@malfet](https://avatars.githubusercontent.com/u/2453524?s=40&v=4)](/malfet) [malfet](/malfet)

Labels

[high priority](/pytorch/pytorch/labels/high%20priority)
[oncall: jit](/pytorch/pytorch/labels/oncall%3A%20jit)
Add this issue/PR to JIT oncall triage queue
[topic: security](/pytorch/pytorch/labels/topic%3A%20security)
[triaged](/pytorch/pytorch/labels/triaged)
This issue has been looked at a team member, and triaged and prioritized into an appropriate module

Projects

None yet

Milestone

 [**1.13.1**](/pytorch/pytorch/milestone/34 "1.13.1")

Development

Successfully merging a pull request may close this issue.

 [[JIT][Security] Do not blindly eval input string](/pytorch/pytorch/pull/89189)
 [pytorch/pytorch](/pytorch/pytorch)

10 participants

[![@ezyang](https://avatars.githubusercontent.com/u/13564?s=52&v=4)](/ezyang) [![@ardell](https://avatars.githubusercontent.com/u/90694?s=52&v=4)](/ardell) [![@bendeaton](https://avatars.githubusercontent.com/u/540540?s=52&v=4)](/bendeaton) [![@seemethere](https://avatars.githubusercontent.com/u/1700823?s=52&v=4)](/seemethere) [![@malfet](https://avatars.githubusercontent.com/u/2453524?s=52&v=4)](/malfet) [![@vikcher](https://avatars.githubusercontent.com/u/4031535?s=52&v=4)](/vikcher) [![@albanD](https://avatars.githubusercontent.com/u/6359743?s=52&v=4)](/albanD) [![@roywei](https://avatars.githubusercontent.com/u/8022184?s=52&v=4)](/roywei) [![@Lyutoon](https://avatars.githubusercontent.com/u/57178900?s=52&v=4)](/Lyutoon) [![@abustamante-coveo](https://avatars.githubusercontent.com/u/91753112?s=52&v=4)](/abustamante-coveo)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

