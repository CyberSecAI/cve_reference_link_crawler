

search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#567764

## MySQL for Windows is vulnerable to privilege escalation due to OPENSSLDIR location

#### Vulnerability Note VU#567764

Original Release Date: 2021-04-20 | Last Revised: 2021-04-22

---

### Overview

MySQL for Windows contains a privilege escalation vulnerability due to the use of an `OPENSSLDIR` variable that specifies a location where an unprivileged Windows user can create files.

### Description

**CVE-2021-2307**

MySQL includes an OpenSSL component that specifies an `OPENSSLDIR` variable as a subdirectory of `/build_area/`. On the Windows platform, this path is interpreted as `C:\build_area`. MySQL contains a privileged service that uses this OpenSSL component. Because unprivileged Windows users can create subdirectories off of the system root, a user can create the appropriate path to a specially-crafted `openssl.cnf` file to achieve arbitrary code execution with SYSTEM privileges.

### Impact

By placing a specially-crafted `openssl.cnf` in a `C:\build_area` subdirectory, an unprivileged user may be able to execute arbitrary code with SYSTEM privileges on a Windows system with the vulnerable MySQL software installed.

### Solution

#### Apply an update

This vulnerability is [addressed](https://www.oracle.com/security-alerts/cpuapr2021.html) in the MySQL Windows installer version 8.0.24 and 5.7.34.

#### Create a C:\build\_area directory

In cases where an update cannot be installed, this vulnerability can be mitigated by creating a `C:\build_area` directory and restricting ACLs to prevent unprivileged users from being able to write to this location.

### Acknowledgements

This vulnerability was reported by Will Dormann of the CERT/CC.

This document was written by Will Dormann.

### Vendor Information

567764
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

### [Oracle Corporation](#Oracle%20Corporation) Affected

Notified:  2020-11-12
Updated: 2021-04-20

| **CVE-2021-2307** | Affected |
| --- | --- |

#### Vendor Statement

We have not received a statement from the vendor.

#### References

* <https://www.oracle.com/security-alerts/cpuapr2021.html>

### References

* <https://www.oracle.com/security-alerts/cpuapr2021.html>

### Other Information

| **CVE IDs:** | [CVE-2021-2307](http://web.nvd.nist.gov/vuln/detail/CVE-2021-2307) |
| --- | --- |
| **Date Public:** | 2021-04-20 |
| **Date First Published:** | 2021-04-20 |
| **Date Last Updated:** | 2021-04-22 12:08 UTC |
| **Document Revision:** | 2 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800

