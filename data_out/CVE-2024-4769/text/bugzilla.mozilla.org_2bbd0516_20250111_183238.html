

![](/static/v20250108.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1886108)
* [XML](/show_bug.cgi?ctype=xml&id=1886108)

Closed
[Bug 1886108](/show_bug.cgi?id=1886108)
(CVE-2024-4769)

Opened 10 months ago
Closed 9 months ago

# Detect Content Script of Cross-Origin using worker load-error messages

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Detect Content Script of Cross-Origin using worker load-error messages

## Categories

### (Core :: DOM: Workers, defect, P3)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20Workers#DOM%3A%20Workers)

DOM: Workers
▾

Core :: DOM: Workers
This component covers the [Web Workers](https://developer.mozilla.org/En/DOM/Worker) implementation in Gecko.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Workers&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Workers&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20Workers)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P3

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

126 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Accessibility Severity | --- |
| Webcompat Priority | --- |
| a11y-review | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr115 | [126+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=126%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed) |
| firefox124 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox124&o1=equals&v1=wontfix) |
| firefox125 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=wontfix) |
| firefox126 | [+](/buglist.cgi?f1=cf_tracking_firefox126&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | 126+ | fixed |
| firefox-esr128 | --- | --- |
| firefox124 |  | wontfix |
| firefox125 |  | wontfix |
| firefox126 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: fazim.pentester, Assigned: asuth)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/75b1e0d00a677e73b24efe34917fa1e9?d=mm&size=40)  [asuth](/user_profile?user_id=151407)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/4894f6e6dda807a548d66213399b6dff?d=mm&size=40)  [fazim.pentester](/user_profile?user_id=720428)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/2b84b1a415615d22d7afc6554020d164?d=mm&size=40)  [jjalkanen](/user_profile?user_id=689836)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

7 people

## References

### (Blocks 1 open bug)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[xs-leaks](/show_bug.cgi?id=1742425 "NEW - [meta] XS-Leaks")

Dependency [tree](/showdependencytree.cgi?id=1886108&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1886108)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[CVE-2022-22760](/show_bug.cgi?id=1740985 "VERIFIED FIXED - Detecting whether the content-type of a cross-origin resource is application/javascript through importScripts"), [1896700](/show_bug.cgi?id=1896700 "NEW - Detect Content Script of Cross-Origin Using Script Load Error")

## Details

### (4 keywords, Whiteboard: [reporter-external] [client-bounty-form] [verif?] [adv-main126+] [adv-ESR115.11+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2024-4769

[Keywords:](/describekeywords.cgi)

[csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?] [adv-main126+] [adv-ESR115.11+]

QA Whiteboard:

[post-critsmash-triage]

Has STR:

yes

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a2457928_1689 "10 months ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | [in-testsuite](#a2457928_1689 "9 months ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | in-testsuite | + |
| --- | --- | --- |
| [avaida](/user_profile?user_id=488993) | [qe-verify](#a2496370_488993 "9 months ago") | - |
| --- | --- | --- |
| [avaida](/user_profile?user_id=488993) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (5 files)

| [poc.html](/attachment.cgi?id=9391942)  [10 months ago](#c0)  [Shaheen Fazim](/user_profile?user_id=720428)   2.68 KB, text/html |  | [Details](/attachment.cgi?id=9391942&action=edit) |
| --- | --- | --- |
| [demo.png](/attachment.cgi?id=9391943)  [10 months ago](#c1)  [Shaheen Fazim](/user_profile?user_id=720428)   135.19 KB, image/png |  | [Details](/attachment.cgi?id=9391943&action=edit) |
| [Bug 1886108 - Normalize error messages. r=#dom-workers!](/attachment.cgi?id=9395920)  [9 months ago](#c7)  [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9395920&action=edit) | [Review](/attachment.cgi?id=9395920) |
| [Bug 1886108 - Normalize error messages. ESR115](/attachment.cgi?id=9397454)  [9 months ago](#c12)  [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)   48 bytes, text/x-phabricator-request | phab-bot : [approval-mozilla-esr115+](#a4166581_600971 "9 months ago") | [Details](/attachment.cgi?id=9397454&action=edit) | [Review](/attachment.cgi?id=9397454) |
| [advisory.txt](/attachment.cgi?id=9401105)  [8 months ago](#c23)  [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733)   343 bytes, text/plain |  | [Details](/attachment.cgi?id=9401105&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1886108#c0)• 10 months ago |
|  | |

Attached file
[poc.html](attachment.cgi?id=9391942)
— [Details](attachment.cgi?id=9391942&action=edit)

On Firefox browser, a site could still detect content across cross-origin whether it is application/javascript using error messages. This is because of different variations of error messages. For example, if application/javascript is detected, Firefox produces the error: `NetworkError: WorkerGlobalScope.importScripts: Failed to load worker script at https://www.google-analytics.com/ (nsresult = 0x80530013).` If not, it produces the error: `NetworkError: A network error occurred.`

Steps to Reproduce:

1. Download the file `poc.html`.
2. Open `poc.html` in a Firefox browser, then copy and paste `https://www.google-analytics.com/analytics.js` into the input field and click "check" to see if it is detected. Repeat with just `https://www.google-analytics.com` to see not detected.
Flags: sec-bounty?

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1886108#c1)• 10 months ago |
|  | |

Attached image
[demo.png](attachment.cgi?id=9391943)
— [Details](attachment.cgi?id=9391943&action=edit)

This issue is the same as [CVE-2022-22760](https://www.cve.org/CVERecord?id=CVE-2022-22760).

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1886108#a290_720428)• 10 months ago |

See Also: → [CVE-2022-22760](/show_bug.cgi?id=1740985 "VERIFIED FIXED - Detecting whether the content-type of a cross-origin resource is application/javascript through importScripts")

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1886108#a17936_159069)• 10 months ago |

Group: firefox-core-security → core-securityComponent: Security → DOM: WorkersProduct: Firefox → Core

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1886108#a17951_159069)• 10 months ago |

Group: core-security → dom-core-security

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1886108#c2)• 10 months ago |
|  | |

Hmm, <https://searchfox.org/mozilla-central/rev/b73676a106c1655030bb876fd5e0a6825aee6044/dom/workers/ScriptLoader.cpp#1851>

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1886108#c3)• 10 months ago |
|  | |

Yeah, [fetch a classic worker-imported script](https://html.spec.whatwg.org/multipage/webappapis.html#fetch-a-classic-worker-imported-script) step 7 is clear we should be throwing a NetworkError and although it's okay for us to report something more detailed for devtools to surface to the user, the NetworkError should not be surfacing something differentiable to content.

<https://phabricator.services.mozilla.com/D147314> introduced `ReportErrorToConsole` which somewhat obscures that it's propagating an ErrorResult which will be surfaced to content, but that didn't change the error handling itself.

By inspection, the problem here seems to be that if we have an `NS_ERROR_DOM_NETWORK_ERR` coming in we will take [the default branch which produces an error string that tunnels the nsresult](https://searchfox.org/mozilla-central/rev/b73676a106c1655030bb876fd5e0a6825aee6044/dom/workers/ScriptLoader.cpp#1888-1896)

```
default:
  // For lack of anything better, go ahead and throw a NetworkError here.
  // We don't want to throw a JS exception, because for toplevel script
  // loads that would get squelched.
  aRv.ThrowNetworkError(nsPrintfCString(
      "Failed to load worker script at %s (nsresult = 0x%" PRIx32 ")",
      NS_ConvertUTF16toUTF8(aScriptURL).get(),
      static_cast<uint32_t>(aLoadResult)));
  return;

```

But in the other cases where we return `NS_ERROR_DOM_NETWORK_ERR` we [will let ErrorResult do its thing](https://searchfox.org/mozilla-central/rev/b73676a106c1655030bb876fd5e0a6825aee6044/dom/workers/ScriptLoader.cpp#1859-1863):

```
case NS_ERROR_FILE_NOT_FOUND:
case NS_ERROR_NOT_AVAILABLE:
case NS_ERROR_CORRUPTED_CONTENT:
  aRv.Throw(NS_ERROR_DOM_NETWORK_ERR);
  break;

```

In terms of the ErrorResult, I think the right course of action is to:

* Also explicitly name `NS_ERROR_DOM_NETWORK_ERR` for us throwing `NS_ERROR_DOM_NETWORK_ERR`.
* Turn the default branch also into us throwing `NS_ERROR_DOM_NETWORK_ERR`.

Considerations here would be:

* Should we be doing more to log the specific nsresult to the console for devtool purposes (but invisible to content). I think the answer is no. The network panel will provide significantly more useful data or console errors reported by earlier stages in the pipeline. We're also in the process of cleaning up the console error reporting for workers and potentially the script loader, so I don't think we want the complexity for an error code that's generally going to be opaque and useless to users.
Assignee: nobody → bugmailSeverity: -- → S3Status: NEW → ASSIGNEDPriority: -- → P3

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1886108#c4)• 10 months ago |
|  | |

This is a variant of [bug 1748503](/show_bug.cgi?id=1748503 "VERIFIED FIXED - Detecting whether a URL is blocked (by Tracking Protection or an extension) or not through importScripts")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1886108#c5)• 10 months ago |
|  | |

(In reply to Olli Pettay [:smaug][bugs@pettay.fi] from [comment #4](/show_bug.cgi?id=1886108#c4 "RESOLVED FIXED - Detect Content Script of Cross-Origin using worker load-error messages"))

> This is a variant of [bug 1748503](/show_bug.cgi?id=1748503 "VERIFIED FIXED - Detecting whether a URL is blocked (by Tracking Protection or an extension) or not through importScripts")

Is it? It seems to be almost the same testcase as [bug 1740985](/show_bug.cgi?id=1740985 "VERIFIED FIXED - Detecting whether the content-type of a cross-origin resource is application/javascript through importScripts"). Did that get un-fixed at some point?

Blocks: [xs-leaks](/show_bug.cgi?id=1742425 "NEW - [meta] XS-Leaks")Keywords: [csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1886108#c6)• 10 months ago |
|  | |

Well, all these are related. Dealing with the errors.

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1886108#c7)• 9 months ago |
|  | |

Attached file
[Bug 1886108 - Normalize error messages. r=#dom-workers!](attachment.cgi?id=9395920)
— [Details](attachment.cgi?id=9395920&action=edit)

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1886108#c8)• 9 months ago |
|  | |

Pushed by bugmail@asutherland.org:
<https://hg.mozilla.org/integration/autoland/rev/577863693061>
Normalize error messages. r=dom-worker-reviewers,smaug

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1886108#c9)• 9 months ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/577863693061>

Group: dom-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 9 months ago
[status-firefox126](/buglist.cgi?f1=cf_status_firefox126&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 126 Branch

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1886108#a2108885_75935)• 9 months ago |

[status-firefox124](/buglist.cgi?f1=cf_status_firefox124&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox124&o1=equals&v1=wontfix)
[status-firefox125](/buglist.cgi?f1=cf_status_firefox125&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=wontfix)
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected)
[tracking-firefox126](/buglist.cgi?f1=cf_tracking_firefox126&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox126&o1=equals&v1=%2B)
[tracking-firefox-esr115](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=isnotempty):
--- → [126+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=126%2B)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1886108#a2457928_1689)• 9 months ago |

Has STR: --- → yesFlags: sec-bounty?Flags: sec-bounty+Flags: in-testsuite+Keywords: [testcase](/buglist.cgi?keywords=testcase&resolution=---)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1886108#c10)• 9 months ago |
|  | |

CCing Luan Herrera who found the original bug.

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1886108#a2496370_488993)• 9 months ago |

QA Whiteboard: [post-critsmash-triage]Flags: qe-verify-

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1886108#c11)• 9 months ago |
|  | |

:asuth could you please add an esr115 uplift request?

It doesn't graft cleanly to esr115 if you could also attach a rebased patch

Flags: needinfo?(bugmail)

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1886108#c12)• 9 months ago |
|  | |

Attached file
[Bug 1886108 - Normalize error messages. ESR115](attachment.cgi?id=9397454)
— [Details](attachment.cgi?id=9397454&action=edit)

Original Revision: <https://phabricator.services.mozilla.com/D207104>

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1886108#a2637613_600971)• 9 months ago |

[Attachment #9397454](/attachment.cgi?id=9397454&action=edit "Bug 1886108 - Normalize error messages. ESR115") -
Flags: approval-mozilla-esr115?

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1886108#c13)• 9 months ago |
|  | |

### esr115 Uplift Approval Request

* **User impact if declined**: sec-mod security side channel
* **Code covered by automated testing**: yes
* **Fix verified in Nightly**: yes
* **Needs manual QE test**: no
* **Steps to reproduce for manual QE testing**: n/a
* **Risk associated with taking this patch**: Minimal
* **Explanation of risk level**: Change in error message string
* **String changes made/needed**: The error messages are not localized
* **Is Android affected?**: yes

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1886108#a2786286_600971)• 9 months ago |

[Attachment #9397454](/attachment.cgi?id=9397454&action=edit "Bug 1886108 - Normalize error messages. ESR115") -
Flags: approval-mozilla-esr115? → approval-mozilla-esr115+

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1886108#c14)• 9 months ago |
|  | |

### esr115 Uplift Approval Request

* **User impact if declined**: sec-mod security side channel
* **Code covered by automated testing**: yes
* **Fix verified in Nightly**: yes
* **Needs manual QE test**: no
* **Steps to reproduce for manual QE testing**: n/a
* **Risk associated with taking this patch**: Minimal
* **Explanation of risk level**: Change in error message string
* **String changes made/needed**: The error messages are not localized
* **Is Android affected?**: yes

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1886108#a2958288_695136)• 9 months ago |

[Attachment #9397454](/attachment.cgi?id=9397454&action=edit "Bug 1886108 - Normalize error messages. ESR115") -
Flags: approval-mozilla-esr115+ → approval-mozilla-esr115?

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1886108#c15)• 9 months ago |
|  | |

:asuth flagging that there's an issue with your uplift request.

Not sure how you created it, the patch is not the same as the revision that landed in central.

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1886108#c16)• 9 months ago |
|  | |

(In reply to Donal Meehan [:dmeehan] from [comment #15](/show_bug.cgi?id=1886108#c15 "RESOLVED FIXED - Detect Content Script of Cross-Origin using worker load-error messages"))

> :asuth flagging that there's an issue with your uplift request.
>
> Not sure how you created it, the patch is not the same as the revision that landed in central.

Is the issue that it's not the same as what's on central, or did it fail to apply? As per the comments in <https://phabricator.services.mozilla.com/D207920> it was clear the test changes would not cleanly uplift to ESR115 so I manually edited the diff to drop the test hunks, leaving only the fix hunk.

Flags: needinfo?(bugmail)

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1886108#c17)• 9 months ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1886108&comment_id=16903090 "1 revision") |
|  | |

> Diff does not have proper author information in Phabricator. See the Lando FAQ for help with this error.

This is the error I'm seeing on Lando when trying to land it.

> A diff without commit information detected in revision D207920.

This is the error I see when I import the phabricator patch locally

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1886108#c18)• 9 months ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1886108&comment_id=16903115 "1 revision") |
|  | |

:asuth some additional info on issues with the Phabricator revision.

The initial revision was created with <https://phabricator.services.mozilla.com/differential/diff/create/>

Please use moz-phab client to submit patches so we can land using Lando.

Internal Slack thread

<https://mozilla.slack.com/archives/C04LGP7428J/p1713620269432339>

Flags: needinfo?(bugmail)

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1886108#c19)• 9 months ago |
|  | |

Interesting, thank you. It seems like there's an asymmetry where "download raw diff" strips the commit message (and requisite metadata) but "update diff" is expected to include that commit message / metadata. I'll roundtrip it through moz-phab; I was prepping for travel and the moz-phab process is rather more involved. (Leaving needinfo until I resolve this.)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1886108#a4145067_600971)• 8 months ago |

[Attachment #9397454](/attachment.cgi?id=9397454&action=edit "Bug 1886108 - Normalize error messages. ESR115") -
Attachment description: Bug 1886108 - Normalize error messages. r=#dom-workers! → Bug 1886108 - Normalize error messages. ESR115

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1886108#c20)• 8 months ago |
|  | |

I cherry-picked the patch locally to an esr115 checkout handling the test conflicts, built, tested that the existing test did not get mad, and then altered the phab metadata in the commit-message to point it at the existing uplift phab request at <https://phabricator.services.mozilla.com/D207920> (so moz-phab would know where to put it) and then used moz-phab to submit the update which should hopefully be okay now? That said, I did use "moz-phab submit" because I was concerned that using "moz-phab uplift" would create a new uplift request and differential revision; the docs at <https://wiki.mozilla.org/index.php?title=Release_Management/Requesting_an_Uplift#Requesting_Uplift_using_moz-phab> and <https://github.com/mozilla-conduit/review?tab=readme-ov-file#submitting-an-uplift-request> do not make it clear if the "uplift" command is idempotent or not and how one would update an already submitted uplift request.

Flags: needinfo?(bugmail)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1886108#a4166581_600971)• 8 months ago |

[Attachment #9397454](/attachment.cgi?id=9397454&action=edit "Bug 1886108 - Normalize error messages. ESR115") -
Flags: approval-mozilla-esr115? → approval-mozilla-esr115+

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1886108#c21)• 8 months ago |
|  | |

### esr115 Uplift Approval Request

* **User impact if declined**: sec-mod security side channel
* **Code covered by automated testing**: yes
* **Fix verified in Nightly**: yes
* **Needs manual QE test**: no
* **Steps to reproduce for manual QE testing**: n/a
* **Risk associated with taking this patch**: Minimal
* **Explanation of risk level**: Change in error message string
* **String changes made/needed**: The error messages are not localized
* **Is Android affected?**: yes

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1886108#c22)• 8 months ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr115/rev/98dee93cf461>

|  | [Lando Automation](/user_profile?user_id=640478) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1886108#a4167163_640478)• 8 months ago |

[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed)

|  | [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1886108#a4454433_486733)• 8 months ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?] [adv-main126+] [adv-ESR115.11+]

|  | [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1886108#c23)• 8 months ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9401105)
— [Details](attachment.cgi?id=9401105&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1886108#a4528861_578488)• 8 months ago |

Alias: CVE-2024-4769

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1886108#a4871322_720428)• 8 months ago |

See Also: → [1896700](/show_bug.cgi?id=1896700 "NEW - Detect Content Script of Cross-Origin Using Script Load Error")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1886108#a4891468_1689)• 8 months ago |

Summary: Detect Content Script of Cross-Origin Using Error Messages → Detect Content Script of Cross-Origin using worker load-error messages

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1886108#a6259781_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1886108#a15879867_1689)• 4 months ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1886108&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Shaheen Fazim](/user_profile?user_id=720428)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review

