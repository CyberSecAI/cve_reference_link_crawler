=== Content from lists.debian.org_09d8e427_20250111_183238.html ===


---

[[Date Prev](msg00011.html)][[Date Next](msg00013.html)]
[[Thread Prev](msg00011.html)][[Thread Next](msg00013.html)]
[[Date Index](maillist.html#00012)]
[[Thread Index](threads.html#00012)]

# [SECURITY] [DLA 3817-1] thunderbird security update

---

* *To*: <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 3817-1] thunderbird security update
* *From*: Emilio Pozuelo Monfort <pochu@debian.org>
* *Date*: Mon, 20 May 2024 10:14:55 +0200
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20240520081455.236B22AE29F%40andromeda)Â [20240520081455.236B22AE29F@andromeda](msg00012.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3817-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>               Emilio Pozuelo Monfort
May 20, 2024                                  <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : thunderbird
Version        : 1:115.11.0-1~deb10u1
CVE ID         : CVE-2024-4367 CVE-2024-4767 CVE-2024-4768 CVE-2024-4769
                 CVE-2024-4770 CVE-2024-4777

Multiple security issues were discovered in Thunderbird, which could
result in denial of service or the execution of arbitrary code.

For Debian 10 buster, these problems have been fixed in version
1:115.11.0-1~deb10u1.

We recommend that you upgrade your thunderbird packages.

For the detailed security status of thunderbird please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/thunderbird>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEcJymx+vmJZxd92Q+nUbEiOQ2gwIFAmZLBnwACgkQnUbEiOQ2
gwJl/RAAsyI2RUHJ/+UF9LZ2PqYGa5zI8o9nFTc4C9T1H5p3LVTx+4jOIa/xryDY
h7c/Z0fJx0T49bsWNVGgrYnGAIWqEcAReJpZmHwPp0wt4r6IOOxAwrkcHGI6qSXG
Mrw0nmA+j0dqocIbD8WnV55jCj/rffuhG2C2UZKtO8q3b6U98mG9GjKv53dx0CN7
znX+R8hYDLuKLlGJENIP+Wq+CLIRvC5N9oA7clob4j30tFLSrNjPfP+/ShOKmPil
r3AJOwRsshEAabRHSUhYhcGNPYy6GiP4OklCcoGdYqZ0rHZor/0guwAdszl1QFJV
1HRlM67BKHn5aP0h3re9quyJ8Ex3dTleCLfBT7lKzhv1dJxywox73QfjmB5tr2ez
4xVJNQwcI+QFSJHYY2Ft606TufzpcjKzhfdnrezEk2Zvkl4fN3vAmN8o5p7W3rUG
fRwfvKR2WHJnXFP067G3C5rG2IYQHnoM3Fry9tjp91MANRWXHG0z7j6YZF6+Desm
3F1wZLyS252kcnuP0krXJNoI97UJ5mkVE0Q6wVtXsUQmGqxJ392S/X6whYHJ59Wl
BnCIZjPqofY7AcdhfNEKNPrA9M+jQw2rs4EUy3+BDexu+aEAyjsSPpirvFo4FmX+
5WyhDOOZbzP91rnABwPGytLmMwuMKaoUxVI5MwGeDt2vlNARo/U=
=r4Qc
-----END PGP SIGNATURE-----

```

---



=== Content from www.mozilla.org_0af25c4f_20250111_183239.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, weâ€™d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured â€” we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2024-21

## Security Vulnerabilities fixed in Firefox 126

Announced
May 14, 2024
Impact
high
Products
Firefox
Fixed in

* Firefox 126

*Updated November 6, 2024 to add CVE-2024-10941 which was fixed in Firefox 126 but not included in the original advisory.*

#### [#CVE-2024-4764: Use-after-free when audio input connected with multiple consumers](#CVE-2024-4764)

Reporter
Jan-Ivar Bruaroey
Impact
high
##### Description

Multiple WebRTC threads could have claimed a newly connected audio input leading to use-after-free.

##### References

* [Bug 1879093](https://bugzilla.mozilla.org/show_bug.cgi?id=1879093)

#### [#CVE-2024-4367: Arbitrary JavaScript execution in PDF.js](#CVE-2024-4367)

Reporter
Thomas Rinsma of Codean Labs
Impact
high
##### Description

A type check was missing when handling fonts in PDF.js, which would allow arbitrary JavaScript execution in the PDF.js context.

##### References

* [Bug 1893645](https://bugzilla.mozilla.org/show_bug.cgi?id=1893645)

#### [#CVE-2024-4765: Web application manifests could have been overwritten via hash collision](#CVE-2024-4765)

Reporter
Dana Keeler
Impact
moderate
##### Description

Web application manifests were stored by using an insecure MD5 hash which allowed for a hash collision to overwrite another application's manifest. This could have been exploited to run arbitrary code in another application's context.
*This issue only affects Firefox for Android. Other versions of Firefox are unaffected.*

##### References

* [Bug 1871109](https://bugzilla.mozilla.org/show_bug.cgi?id=1871109)

#### [#CVE-2024-4766: Fullscreen notification could have been obscured on Firefox for Android](#CVE-2024-4766)

Reporter
Hafiizh
Impact
moderate
##### Description

Different techniques existed to obscure the fullscreen notification in Firefox for Android. These could have led to potential user confusion and spoofing attacks.
*This bug only affects Firefox for Android. Other versions of Firefox are unaffected.*

##### References

* [Bug 1871214](https://bugzilla.mozilla.org/show_bug.cgi?id=1871214)
* [Bug 1871217](https://bugzilla.mozilla.org/show_bug.cgi?id=1871217)

#### [#CVE-2024-4767: IndexedDB files retained in private browsing mode](#CVE-2024-4767)

Reporter
Kim Do Hun via Tor Browser
Impact
moderate
##### Description

If the `browser.privatebrowsing.autostart` preference is enabled, IndexedDB files were not properly deleted when the window was closed. This preference is disabled by default in Firefox.

##### References

* [Bug 1878577](https://bugzilla.mozilla.org/show_bug.cgi?id=1878577)

#### [#CVE-2024-4768: Potential permissions request bypass via clickjacking](#CVE-2024-4768)

Reporter
Hafiizh
Impact
moderate
##### Description

A bug in popup notifications' interaction with WebAuthn made it easier for an attacker to trick a user into granting permissions.

##### References

* [Bug 1886082](https://bugzilla.mozilla.org/show_bug.cgi?id=1886082)

#### [#CVE-2024-4769: Cross-origin responses could be distinguished between script and non-script content-types](#CVE-2024-4769)

Reporter
Shaheen Fazim
Impact
moderate
##### Description

When importing resources using Web Workers, error messages would distinguish the difference between `application/javascript` responses and non-script responses. This could have been abused to learn information cross-origin.

##### References

* [Bug 1886108](https://bugzilla.mozilla.org/show_bug.cgi?id=1886108)

#### [#CVE-2024-4770: Use-after-free could occur when printing to PDF](#CVE-2024-4770)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

When saving a page to PDF, certain font styles could have led to a potential use-after-free crash.

##### References

* [Bug 1893270](https://bugzilla.mozilla.org/show_bug.cgi?id=1893270)

#### [#CVE-2024-4771: Failed allocation could lead to use-after-free](#CVE-2024-4771)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

A memory allocation check was missing which would lead to a use-after-free if the allocation failed. This could have triggered a crash or potentially be leveraged to achieve code execution.

##### References

* [Bug 1893891](https://bugzilla.mozilla.org/show_bug.cgi?id=1893891)

#### [#CVE-2024-4772: Use of insecure rand() function to generate nonce](#CVE-2024-4772)

Reporter
Hanno BÃ¶ck
Impact
low
##### Description

An HTTP digest authentication nonce value was generated using `rand()` which could lead to predictable values.

##### References

* [Bug 1870579](https://bugzilla.mozilla.org/show_bug.cgi?id=1870579)

#### [#CVE-2024-4773: URL bar could be cleared after network error](#CVE-2024-4773)

Reporter
Islam
Impact
low
##### Description

When a network error occurred during page load, the prior content could have remained in view with a blank URL bar. This could have been used to obfuscate a spoofed web site.

##### References

* [Bug 1875248](https://bugzilla.mozilla.org/show_bug.cgi?id=1875248)

#### [#CVE-2024-4774: Undefined behavior in ShmemCharMapHashEntry()](#CVE-2024-4774)

Reporter
Ronald Crane
Impact
low
##### Description

The `ShmemCharMapHashEntry()` code was susceptible to potentially undefined behavior by bypassing the move semantics for one of its data members.

##### References

* [Bug 1886598](https://bugzilla.mozilla.org/show_bug.cgi?id=1886598)

#### [#CVE-2024-4775: Invalid memory access in the built-in profiler](#CVE-2024-4775)

Reporter
Lukas Bernhard
Impact
low
##### Description

An iterator stop condition was missing when handling WASM code in the built-in profiler, potentially leading to invalid memory access and undefined behavior. *Note:* This issue only affects the application when the profiler is running.

##### References

* [Bug 1887332](https://bugzilla.mozilla.org/show_bug.cgi?id=1887332)

#### [#CVE-2024-4776: Window may remain disabled after file dialog is shown in full-screen](#CVE-2024-4776)

Reporter
Raphael
Impact
low
##### Description

A file dialog shown while in full-screen mode could have resulted in the window remaining disabled.

##### References

* [Bug 1887343](https://bugzilla.mozilla.org/show_bug.cgi?id=1887343)

#### [#CVE-2024-10941: Browser crash from invalid URI](#CVE-2024-10941)

Reporter
Anthony De Los Santos
Impact
low
##### Description

A malicious website could have included an iframe with an malformed URI resulting in a non-exploitable browser crash.

##### References

* [Bug 1880879](https://bugzilla.mozilla.org/show_bug.cgi?id=1880879)
* [Bug 1887614](https://bugzilla.mozilla.org/show_bug.cgi?id=1887614)

#### [#CVE-2024-4777: Memory safety bugs fixed in Firefox 126, Firefox ESR 115.11, and Thunderbird 115.11](#CVE-2024-4777)

Reporter
Daniel Holbert and the Mozilla Fuzzing Team
Impact
moderate
##### Description

Memory safety bugs present in Firefox 125, Firefox ESR 115.10, and Thunderbird 115.10. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 126, Firefox ESR 115.11, and Thunderbird 115.11](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1878199%2C1893340)

#### [#CVE-2024-4778: Memory safety bugs fixed in Firefox 126](#CVE-2024-4778)

Reporter
Mozilla Fuzzing Team
Impact
moderate
##### Description

Memory safety bugs present in Firefox 125. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 126](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1838834%2C1889291%2C1889595%2C1890204%2C1891545)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporationâ€™s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are Â©1998â€“2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from lists.debian.org_7a57585d_20250111_183238.html ===


---

[[Date Prev](msg00009.html)][[Date Next](msg00011.html)]
[[Thread Prev](msg00009.html)][[Thread Next](msg00011.html)]
[[Date Index](maillist.html#00010)]
[[Thread Index](threads.html#00010)]

# [SECURITY] [DLA 3815-1] firefox-esr security update

---

* *To*: <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 3815-1] firefox-esr security update
* *From*: Emilio Pozuelo Monfort <pochu@debian.org>
* *Date*: Thu, 16 May 2024 09:16:17 +0200
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20240516071617.BBD6C2AC952%40andromeda)Â [20240516071617.BBD6C2AC952@andromeda](msg00010.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3815-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>               Emilio Pozuelo Monfort
May 16, 2024                                  <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : firefox-esr
Version        : 115.11.0esr-1~deb10u1
CVE ID         : CVE-2024-4367 CVE-2024-4767 CVE-2024-4768 CVE-2024-4769
                 CVE-2024-4770 CVE-2024-4777

Multiple security issues have been found in the Mozilla Firefox web
browser, which could potentially result in the execution of arbitrary
code or clickjacking.

For Debian 10 buster, these problems have been fixed in version
115.11.0esr-1~deb10u1.

We recommend that you upgrade your firefox-esr packages.

For the detailed security status of firefox-esr please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/firefox-esr>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEcJymx+vmJZxd92Q+nUbEiOQ2gwIFAmZFsrkACgkQnUbEiOQ2
gwIwtQ/+LedFNznXvmGjWnQH6pXvjPj9xB2jrnfTM/B0E+7Wz0ZqkB71nWMIKTCP
oQaNBvug0IjSJ4/Qs5ekgu70h1UJpP7lpAIQwuzu2if+t1Az5mJXZU7zxqL8CGN9
dFwJd5J0nsZEfxkR4G2Q20QlUMOLtvbWvlEw0VQll59XZDMv+Y+2Ej55bz67rqn+
3FqGsYQakWLl1lxMH1LuHdjg2WyAb4zwMPhE0ILVD6yBridjo1ulPL0BF9MDnTtQ
U5T8Vr2X/RReiLlQHcJSWxl+jWfLiLEj20mQ2fANQBEEGt5eU5kjJjYA9X+WTq85
J9SR05StfAT5GpbzaV0AR5yV7d6dlPIg6WS6J/356MWpEhtR2xwcrzyGX6r6n4dP
6MEAlxeOi2vhdRZ+xqftMoIPS1UinHCewUtXmoUgH9SaisZGajtdR2aoGBuN90Tm
mctfKOdc+5siriOKD5+8oVk0pq1O4+IK5IZ3bKAhc3BkNmkJnGcb8z4LJfSGGxI3
RFPfsQqDpK7irie7teSXfNOyUDDgNV72ZrinMRP0tzoDZOuuy1VsnEXhIi8tW7n5
bIAHrz1/0W7/08R3OZ2yO7Ki1FR7lU4fdbiGZTGfnxfzYz4EPuu8Hd8C3QlxsDsF
VSBkXY642X0NV/ivgKmgUlmOyPqTRDLZptF2Ee15EgobZV2nQH4=
=RES1
-----END PGP SIGNATURE-----

```

---



=== Content from bugzilla.mozilla.org_2bbd0516_20250111_183238.html ===


![](/static/v20250108.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  Â·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summaryâ–¾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View â–¾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1886108)
* [XML](/show_bug.cgi?ctype=xml&id=1886108)

Closed
[Bug 1886108](/show_bug.cgi?id=1886108)
(CVE-2024-4769)

Opened 10 months ago
Closed 9 months ago

# Detect Content Script of Cross-Origin using worker load-error messages

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Detect Content Script of Cross-Origin using worker load-error messages

## Categories

### (Core :: DOM: Workers, defect, P3)

[Product:](/describecomponents.cgi?product=Core)

Core
â–¾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20Workers#DOM%3A%20Workers)

DOM: Workers
â–¾

Core :: DOM: Workers
This component covers the [Web Workers](https://developer.mozilla.org/En/DOM/Worker) implementation in Gecko.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Workers&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Workers&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20Workers)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P3

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

126 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Accessibility Severity | --- |
| Webcompat Priority | --- |
| a11y-review | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr115 | [126+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=126%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed) |
| firefox124 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox124&o1=equals&v1=wontfix) |
| firefox125 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=wontfix) |
| firefox126 | [+](/buglist.cgi?f1=cf_tracking_firefox126&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | 126+ | fixed |
| firefox-esr128 | --- | --- |
| firefox124 |  | wontfix |
| firefox125 |  | wontfix |
| firefox126 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: fazim.pentester, Assigned: asuth)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/75b1e0d00a677e73b24efe34917fa1e9?d=mm&size=40)  [asuth](/user_profile?user_id=151407)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/4894f6e6dda807a548d66213399b6dff?d=mm&size=40)  [fazim.pentester](/user_profile?user_id=720428)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/2b84b1a415615d22d7afc6554020d164?d=mm&size=40)  [jjalkanen](/user_profile?user_id=689836)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

7 people

## References

### (Blocks 1 open bug)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[xs-leaks](/show_bug.cgi?id=1742425 "NEW - [meta] XS-Leaks")

Dependency [tree](/showdependencytree.cgi?id=1886108&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1886108)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[CVE-2022-22760](/show_bug.cgi?id=1740985 "VERIFIED FIXED - Detecting whether the content-type of a cross-origin resource is application/javascript through importScripts"), [1896700](/show_bug.cgi?id=1896700 "NEW - Detect Content Script of Cross-Origin Using Script Load Error")

## Details

### (4 keywords, Whiteboard: [reporter-external] [client-bounty-form] [verif?] [adv-main126+] [adv-ESR115.11+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2024-4769

[Keywords:](/describekeywords.cgi)

[csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?] [adv-main126+] [adv-ESR115.11+]

QA Whiteboard:

[post-critsmash-triage]

Has STR:

yes

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a2457928_1689 "10 months ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | [in-testsuite](#a2457928_1689 "9 months ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | in-testsuite | + |
| --- | --- | --- |
| [avaida](/user_profile?user_id=488993) | [qe-verify](#a2496370_488993 "9 months ago") | - |
| --- | --- | --- |
| [avaida](/user_profile?user_id=488993) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (5 files)

| [poc.html](/attachment.cgi?id=9391942)  [10 months ago](#c0)  [Shaheen Fazim](/user_profile?user_id=720428)   2.68 KB, text/html |  | [Details](/attachment.cgi?id=9391942&action=edit) |
| --- | --- | --- |
| [demo.png](/attachment.cgi?id=9391943)  [10 months ago](#c1)  [Shaheen Fazim](/user_profile?user_id=720428)   135.19 KB, image/png |  | [Details](/attachment.cgi?id=9391943&action=edit) |
| [Bug 1886108 - Normalize error messages. r=#dom-workers!](/attachment.cgi?id=9395920)  [9 months ago](#c7)  [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9395920&action=edit) | [Review](/attachment.cgi?id=9395920) |
| [Bug 1886108 - Normalize error messages. ESR115](/attachment.cgi?id=9397454)  [9 months ago](#c12)  [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)   48 bytes, text/x-phabricator-request | phab-bot : [approval-mozilla-esr115+](#a4166581_600971 "9 months ago") | [Details](/attachment.cgi?id=9397454&action=edit) | [Review](/attachment.cgi?id=9397454) |
| [advisory.txt](/attachment.cgi?id=9401105)  [8 months ago](#c23)  [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733)   343 bytes, text/plain |  | [Details](/attachment.cgi?id=9401105&action=edit) |

Bottom â†“
Tags â–¾

* Reset

Timeline â–¾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1886108#c0)â€¢ 10 months ago |
|  | |

Attached file
[poc.html](attachment.cgi?id=9391942)
â€” [Details](attachment.cgi?id=9391942&action=edit)

On Firefox browser, a site could still detect content across cross-origin whether it is application/javascript using error messages. This is because of different variations of error messages. For example, if application/javascript is detected, Firefox produces the error: `NetworkError: WorkerGlobalScope.importScripts: Failed to load worker script at https://www.google-analytics.com/ (nsresult = 0x80530013).` If not, it produces the error: `NetworkError: A network error occurred.`

Steps to Reproduce:

1. Download the file `poc.html`.
2. Open `poc.html` in a Firefox browser, then copy and paste `https://www.google-analytics.com/analytics.js` into the input field and click "check" to see if it is detected. Repeat with just `https://www.google-analytics.com` to see not detected.
Flags: sec-bounty?

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1886108#c1)â€¢ 10 months ago |
|  | |

Attached image
[demo.png](attachment.cgi?id=9391943)
â€” [Details](attachment.cgi?id=9391943&action=edit)

This issue is the same as [CVE-2022-22760](https://www.cve.org/CVERecord?id=CVE-2022-22760).

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1886108#a290_720428)â€¢ 10 months ago |

See Also: â†’ [CVE-2022-22760](/show_bug.cgi?id=1740985 "VERIFIED FIXED - Detecting whether the content-type of a cross-origin resource is application/javascript through importScripts")

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1886108#a17936_159069)â€¢ 10 months ago |

Group: firefox-core-security â†’ core-securityComponent: Security â†’ DOM: WorkersProduct: Firefox â†’ Core

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1886108#a17951_159069)â€¢ 10 months ago |

Group: core-security â†’ dom-core-security

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1886108#c2)â€¢ 10 months ago |
|  | |

Hmm, <https://searchfox.org/mozilla-central/rev/b73676a106c1655030bb876fd5e0a6825aee6044/dom/workers/ScriptLoader.cpp#1851>

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1886108#c3)â€¢ 10 months ago |
|  | |

Yeah, [fetch a classic worker-imported script](https://html.spec.whatwg.org/multipage/webappapis.html#fetch-a-classic-worker-imported-script) step 7 is clear we should be throwing a NetworkError and although it's okay for us to report something more detailed for devtools to surface to the user, the NetworkError should not be surfacing something differentiable to content.

<https://phabricator.services.mozilla.com/D147314> introduced `ReportErrorToConsole` which somewhat obscures that it's propagating an ErrorResult which will be surfaced to content, but that didn't change the error handling itself.

By inspection, the problem here seems to be that if we have an `NS_ERROR_DOM_NETWORK_ERR` coming in we will take [the default branch which produces an error string that tunnels the nsresult](https://searchfox.org/mozilla-central/rev/b73676a106c1655030bb876fd5e0a6825aee6044/dom/workers/ScriptLoader.cpp#1888-1896)

```
default:
  // For lack of anything better, go ahead and throw a NetworkError here.
  // We don't want to throw a JS exception, because for toplevel script
  // loads that would get squelched.
  aRv.ThrowNetworkError(nsPrintfCString(
      "Failed to load worker script at %s (nsresult = 0x%" PRIx32 ")",
      NS_ConvertUTF16toUTF8(aScriptURL).get(),
      static_cast<uint32_t>(aLoadResult)));
  return;

```

But in the other cases where we return `NS_ERROR_DOM_NETWORK_ERR` we [will let ErrorResult do its thing](https://searchfox.org/mozilla-central/rev/b73676a106c1655030bb876fd5e0a6825aee6044/dom/workers/ScriptLoader.cpp#1859-1863):

```
case NS_ERROR_FILE_NOT_FOUND:
case NS_ERROR_NOT_AVAILABLE:
case NS_ERROR_CORRUPTED_CONTENT:
  aRv.Throw(NS_ERROR_DOM_NETWORK_ERR);
  break;

```

In terms of the ErrorResult, I think the right course of action is to:

* Also explicitly name `NS_ERROR_DOM_NETWORK_ERR` for us throwing `NS_ERROR_DOM_NETWORK_ERR`.
* Turn the default branch also into us throwing `NS_ERROR_DOM_NETWORK_ERR`.

Considerations here would be:

* Should we be doing more to log the specific nsresult to the console for devtool purposes (but invisible to content). I think the answer is no. The network panel will provide significantly more useful data or console errors reported by earlier stages in the pipeline. We're also in the process of cleaning up the console error reporting for workers and potentially the script loader, so I don't think we want the complexity for an error code that's generally going to be opaque and useless to users.
Assignee: nobody â†’ bugmailSeverity: -- â†’ S3Status: NEW â†’ ASSIGNEDPriority: -- â†’ P3

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1886108#c4)â€¢ 10 months ago |
|  | |

This is a variant of [bug 1748503](/show_bug.cgi?id=1748503 "VERIFIED FIXED - Detecting whether a URL is blocked (by Tracking Protection or an extension) or not through importScripts")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1886108#c5)â€¢ 10 months ago |
|  | |

(In reply to Olli Pettay [:smaug][bugs@pettay.fi] from [comment #4](/show_bug.cgi?id=1886108#c4 "RESOLVED FIXED - Detect Content Script of Cross-Origin using worker load-error messages"))

> This is a variant of [bug 1748503](/show_bug.cgi?id=1748503 "VERIFIED FIXED - Detecting whether a URL is blocked (by Tracking Protection or an extension) or not through importScripts")

Is it? It seems to be almost the same testcase as [bug 1740985](/show_bug.cgi?id=1740985 "VERIFIED FIXED - Detecting whether the content-type of a cross-origin resource is application/javascript through importScripts"). Did that get un-fixed at some point?

Blocks: [xs-leaks](/show_bug.cgi?id=1742425 "NEW - [meta] XS-Leaks")Keywords: [csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1886108#c6)â€¢ 10 months ago |
|  | |

Well, all these are related. Dealing with the errors.

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1886108#c7)â€¢ 9 months ago |
|  | |

Attached file
[Bug 1886108 - Normalize error messages. r=#dom-workers!](attachment.cgi?id=9395920)
â€” [Details](attachment.cgi?id=9395920&action=edit)

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1886108#c8)â€¢ 9 months ago |
|  | |

Pushed by bugmail@asutherland.org:
<https://hg.mozilla.org/integration/autoland/rev/577863693061>
Normalize error messages. r=dom-worker-reviewers,smaug

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1886108#c9)â€¢ 9 months ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/577863693061>

Group: dom-core-security â†’ core-security-releaseStatus: ASSIGNED â†’ RESOLVEDClosed: 9 months ago
[status-firefox126](/buglist.cgi?f1=cf_status_firefox126&o1=isnotempty):
--- â†’ [fixed](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=fixed)Resolution: --- â†’ FIXEDTarget Milestone: --- â†’ 126 Branch

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1886108#a2108885_75935)â€¢ 9 months ago |

[status-firefox124](/buglist.cgi?f1=cf_status_firefox124&o1=isnotempty):
--- â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox124&o1=equals&v1=wontfix)
[status-firefox125](/buglist.cgi?f1=cf_status_firefox125&o1=isnotempty):
--- â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=wontfix)
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected)
[tracking-firefox126](/buglist.cgi?f1=cf_tracking_firefox126&o1=isnotempty):
--- â†’ [+](/buglist.cgi?f1=cf_tracking_firefox126&o1=equals&v1=%2B)
[tracking-firefox-esr115](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=isnotempty):
--- â†’ [126+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=126%2B)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1886108#a2457928_1689)â€¢ 9 months ago |

Has STR: --- â†’ yesFlags: sec-bounty?Flags: sec-bounty+Flags: in-testsuite+Keywords: [testcase](/buglist.cgi?keywords=testcase&resolution=---)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1886108#c10)â€¢ 9 months ago |
|  | |

CCing Luan Herrera who found the original bug.

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1886108#a2496370_488993)â€¢ 9 months ago |

QA Whiteboard: [post-critsmash-triage]Flags: qe-verify-

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1886108#c11)â€¢ 9 months ago |
|  | |

:asuth could you please add an esr115 uplift request?

It doesn't graft cleanly to esr115 if you could also attach a rebased patch

Flags: needinfo?(bugmail)

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1886108#c12)â€¢ 9 months ago |
|  | |

Attached file
[Bug 1886108 - Normalize error messages. ESR115](attachment.cgi?id=9397454)
â€” [Details](attachment.cgi?id=9397454&action=edit)

Original Revision: <https://phabricator.services.mozilla.com/D207104>

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1886108#a2637613_600971)â€¢ 9 months ago |

[Attachment #9397454](/attachment.cgi?id=9397454&action=edit "Bug 1886108 - Normalize error messages. ESR115") -
Flags: approval-mozilla-esr115?

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1886108#c13)â€¢ 9 months ago |
|  | |

### esr115 Uplift Approval Request

* **User impact if declined**: sec-mod security side channel
* **Code covered by automated testing**: yes
* **Fix verified in Nightly**: yes
* **Needs manual QE test**: no
* **Steps to reproduce for manual QE testing**: n/a
* **Risk associated with taking this patch**: Minimal
* **Explanation of risk level**: Change in error message string
* **String changes made/needed**: The error messages are not localized
* **Is Android affected?**: yes

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1886108#a2786286_600971)â€¢ 9 months ago |

[Attachment #9397454](/attachment.cgi?id=9397454&action=edit "Bug 1886108 - Normalize error messages. ESR115") -
Flags: approval-mozilla-esr115? â†’ approval-mozilla-esr115+

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1886108#c14)â€¢ 9 months ago |
|  | |

### esr115 Uplift Approval Request

* **User impact if declined**: sec-mod security side channel
* **Code covered by automated testing**: yes
* **Fix verified in Nightly**: yes
* **Needs manual QE test**: no
* **Steps to reproduce for manual QE testing**: n/a
* **Risk associated with taking this patch**: Minimal
* **Explanation of risk level**: Change in error message string
* **String changes made/needed**: The error messages are not localized
* **Is Android affected?**: yes

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1886108#a2958288_695136)â€¢ 9 months ago |

[Attachment #9397454](/attachment.cgi?id=9397454&action=edit "Bug 1886108 - Normalize error messages. ESR115") -
Flags: approval-mozilla-esr115+ â†’ approval-mozilla-esr115?

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1886108#c15)â€¢ 9 months ago |
|  | |

:asuth flagging that there's an issue with your uplift request.

Not sure how you created it, the patch is not the same as the revision that landed in central.

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1886108#c16)â€¢ 9 months ago |
|  | |

(In reply to Donal Meehan [:dmeehan] from [comment #15](/show_bug.cgi?id=1886108#c15 "RESOLVED FIXED - Detect Content Script of Cross-Origin using worker load-error messages"))

> :asuth flagging that there's an issue with your uplift request.
>
> Not sure how you created it, the patch is not the same as the revision that landed in central.

Is the issue that it's not the same as what's on central, or did it fail to apply? As per the comments in <https://phabricator.services.mozilla.com/D207920> it was clear the test changes would not cleanly uplift to ESR115 so I manually edited the diff to drop the test hunks, leaving only the fix hunk.

Flags: needinfo?(bugmail)

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1886108#c17)â€¢ 9 months ago â€¢ [Edited](/page.cgi?id=comment-revisions.html&bug_id=1886108&comment_id=16903090 "1 revision") |
|  | |

> Diff does not have proper author information in Phabricator. See the Lando FAQ for help with this error.

This is the error I'm seeing on Lando when trying to land it.

> A diff without commit information detected in revision D207920.

This is the error I see when I import the phabricator patch locally

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1886108#c18)â€¢ 9 months ago â€¢ [Edited](/page.cgi?id=comment-revisions.html&bug_id=1886108&comment_id=16903115 "1 revision") |
|  | |

:asuth some additional info on issues with the Phabricator revision.

The initial revision was created with <https://phabricator.services.mozilla.com/differential/diff/create/>

Please use moz-phab client to submit patches so we can land using Lando.

Internal Slack thread

<https://mozilla.slack.com/archives/C04LGP7428J/p1713620269432339>

Flags: needinfo?(bugmail)

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1886108#c19)â€¢ 9 months ago |
|  | |

Interesting, thank you. It seems like there's an asymmetry where "download raw diff" strips the commit message (and requisite metadata) but "update diff" is expected to include that commit message / metadata. I'll roundtrip it through moz-phab; I was prepping for travel and the moz-phab process is rather more involved. (Leaving needinfo until I resolve this.)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1886108#a4145067_600971)â€¢ 8 months ago |

[Attachment #9397454](/attachment.cgi?id=9397454&action=edit "Bug 1886108 - Normalize error messages. ESR115") -
Attachment description: Bug 1886108 - Normalize error messages. r=#dom-workers! â†’ Bug 1886108 - Normalize error messages. ESR115

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1886108#c20)â€¢ 8 months ago |
|  | |

I cherry-picked the patch locally to an esr115 checkout handling the test conflicts, built, tested that the existing test did not get mad, and then altered the phab metadata in the commit-message to point it at the existing uplift phab request at <https://phabricator.services.mozilla.com/D207920> (so moz-phab would know where to put it) and then used moz-phab to submit the update which should hopefully be okay now? That said, I did use "moz-phab submit" because I was concerned that using "moz-phab uplift" would create a new uplift request and differential revision; the docs at <https://wiki.mozilla.org/index.php?title=Release_Management/Requesting_an_Uplift#Requesting_Uplift_using_moz-phab> and <https://github.com/mozilla-conduit/review?tab=readme-ov-file#submitting-an-uplift-request> do not make it clear if the "uplift" command is idempotent or not and how one would update an already submitted uplift request.

Flags: needinfo?(bugmail)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1886108#a4166581_600971)â€¢ 8 months ago |

[Attachment #9397454](/attachment.cgi?id=9397454&action=edit "Bug 1886108 - Normalize error messages. ESR115") -
Flags: approval-mozilla-esr115? â†’ approval-mozilla-esr115+

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1886108#c21)â€¢ 8 months ago |
|  | |

### esr115 Uplift Approval Request

* **User impact if declined**: sec-mod security side channel
* **Code covered by automated testing**: yes
* **Fix verified in Nightly**: yes
* **Needs manual QE test**: no
* **Steps to reproduce for manual QE testing**: n/a
* **Risk associated with taking this patch**: Minimal
* **Explanation of risk level**: Change in error message string
* **String changes made/needed**: The error messages are not localized
* **Is Android affected?**: yes

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1886108#c22)â€¢ 8 months ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr115/rev/98dee93cf461>

|  | [Lando Automation](/user_profile?user_id=640478) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1886108#a4167163_640478)â€¢ 8 months ago |

[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected) â†’ [fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed)

|  | [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1886108#a4454433_486733)â€¢ 8 months ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] â†’ [reporter-external] [client-bounty-form] [verif?] [adv-main126+] [adv-ESR115.11+]

|  | [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1886108#c23)â€¢ 8 months ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9401105)
â€” [Details](attachment.cgi?id=9401105&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1886108#a4528861_578488)â€¢ 8 months ago |

Alias: CVE-2024-4769

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1886108#a4871322_720428)â€¢ 8 months ago |

See Also: â†’ [1896700](/show_bug.cgi?id=1896700 "NEW - Detect Content Script of Cross-Origin Using Script Load Error")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1886108#a4891468_1689)â€¢ 8 months ago |

Summary: Detect Content Script of Cross-Origin Using Error Messages â†’ Detect Content Script of Cross-Origin using worker load-error messages

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1886108#a6259781_5898)â€¢ 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1886108#a15879867_1689)â€¢ 4 months ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1886108&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top â†‘

## Attachment

Hide Details

### General

Creator:  [Shaheen Fazim](/user_profile?user_id=720428)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_3621e25b_20250111_183240.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, weâ€™d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured â€” we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2024-23

## Security Vulnerabilities fixed in Thunderbird 115.11

Announced
May 15, 2024
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 115.11

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2024-4367: Arbitrary JavaScript execution in PDF.js](#CVE-2024-4367)

Reporter
Thomas Rinsma of Codean Labs
Impact
high
##### Description

A type check was missing when handling fonts in PDF.js, which would allow arbitrary JavaScript execution in the PDF.js context.

##### References

* [Bug 1893645](https://bugzilla.mozilla.org/show_bug.cgi?id=1893645)

#### [#CVE-2024-4767: IndexedDB files retained in private browsing mode](#CVE-2024-4767)

Reporter
Kim Do Hun via Tor Browser
Impact
moderate
##### Description

If the `browser.privatebrowsing.autostart` preference is enabled, IndexedDB files were not properly deleted when the window was closed. This preference is disabled by default in Thunderbird.

##### References

* [Bug 1878577](https://bugzilla.mozilla.org/show_bug.cgi?id=1878577)

#### [#CVE-2024-4768: Potential permissions request bypass via clickjacking](#CVE-2024-4768)

Reporter
Hafiizh
Impact
moderate
##### Description

A bug in popup notifications' interaction with WebAuthn made it easier for an attacker to trick a user into granting permissions.

##### References

* [Bug 1886082](https://bugzilla.mozilla.org/show_bug.cgi?id=1886082)

#### [#CVE-2024-4769: Cross-origin responses could be distinguished between script and non-script content-types](#CVE-2024-4769)

Reporter
Shaheen Fazim
Impact
moderate
##### Description

When importing resources using Web Workers, error messages would distinguish the difference between `application/javascript` responses and non-script responses. This could have been abused to learn information cross-origin.

##### References

* [Bug 1886108](https://bugzilla.mozilla.org/show_bug.cgi?id=1886108)

#### [#CVE-2024-4770: Use-after-free could occur when printing to PDF](#CVE-2024-4770)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

When saving a page to PDF, certain font styles could have led to a potential use-after-free crash.

##### References

* [Bug 1893270](https://bugzilla.mozilla.org/show_bug.cgi?id=1893270)

#### [#CVE-2024-4777: Memory safety bugs fixed in Firefox 126, Firefox ESR 115.11, and Thunderbird 115.11](#CVE-2024-4777)

Reporter
Daniel Holbert and the Mozilla Fuzzing Team
Impact
moderate
##### Description

Memory safety bugs present in Firefox 125, Firefox ESR 115.10, and Thunderbird 115.10. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 126, Firefox ESR 115.11, and Thunderbird 115.11](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1878199%2C1893340)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporationâ€™s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are Â©1998â€“2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_5d512764_20250111_183239.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, weâ€™d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured â€” we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2024-22

## Security Vulnerabilities fixed in Firefox ESR 115.11

Announced
May 14, 2024
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 115.11

#### [#CVE-2024-4367: Arbitrary JavaScript execution in PDF.js](#CVE-2024-4367)

Reporter
Thomas Rinsma of Codean Labs
Impact
high
##### Description

A type check was missing when handling fonts in PDF.js, which would allow arbitrary JavaScript execution in the PDF.js context.

##### References

* [Bug 1893645](https://bugzilla.mozilla.org/show_bug.cgi?id=1893645)

#### [#CVE-2024-4767: IndexedDB files retained in private browsing mode](#CVE-2024-4767)

Reporter
Kim Do Hun via Tor Browser
Impact
moderate
##### Description

If the `browser.privatebrowsing.autostart` preference is enabled, IndexedDB files were not properly deleted when the window was closed. This preference is disabled by default in Firefox.

##### References

* [Bug 1878577](https://bugzilla.mozilla.org/show_bug.cgi?id=1878577)

#### [#CVE-2024-4768: Potential permissions request bypass via clickjacking](#CVE-2024-4768)

Reporter
Hafiizh
Impact
moderate
##### Description

A bug in popup notifications' interaction with WebAuthn made it easier for an attacker to trick a user into granting permissions.

##### References

* [Bug 1886082](https://bugzilla.mozilla.org/show_bug.cgi?id=1886082)

#### [#CVE-2024-4769: Cross-origin responses could be distinguished between script and non-script content-types](#CVE-2024-4769)

Reporter
Shaheen Fazim
Impact
moderate
##### Description

When importing resources using Web Workers, error messages would distinguish the difference between `application/javascript` responses and non-script responses. This could have been abused to learn information cross-origin.

##### References

* [Bug 1886108](https://bugzilla.mozilla.org/show_bug.cgi?id=1886108)

#### [#CVE-2024-4770: Use-after-free could occur when printing to PDF](#CVE-2024-4770)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

When saving a page to PDF, certain font styles could have led to a potential use-after-free crash.

##### References

* [Bug 1893270](https://bugzilla.mozilla.org/show_bug.cgi?id=1893270)

#### [#CVE-2024-4777: Memory safety bugs fixed in Firefox 126, Firefox ESR 115.11, and Thunderbird 115.11](#CVE-2024-4777)

Reporter
Daniel Holbert and the Mozilla Fuzzing Team
Impact
moderate
##### Description

Memory safety bugs present in Firefox 125, Firefox ESR 115.10, and Thunderbird 115.10. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 126, Firefox ESR 115.11, and Thunderbird 115.11](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1878199%2C1893340)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporationâ€™s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are Â©1998â€“2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


