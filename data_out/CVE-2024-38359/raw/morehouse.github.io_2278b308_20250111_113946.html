<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>DoS: LND Onion Bomb &#8211; Matt Morehouse</title>
<meta name="description" content="Discussion of an OOM bug in LND that can be exploited for DoS">
<meta name="keywords" content="lightning, security, dos, lnd">



<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="DoS: LND Onion Bomb">
<meta property="og:description" content="Discussion of an OOM bug in LND that can be exploited for DoS">
<meta property="og:url" content="https://morehouse.github.io/lightning/lnd-onion-bomb/">
<meta property="og:site_name" content="Matt Morehouse">
<meta property="og:image" content="https://morehouse.github.io/images/lnd_onion_bomb_header.png">






<link rel="canonical" href="https://morehouse.github.io/lightning/lnd-onion-bomb/">
<link href="https://morehouse.github.io/feed.xml" type="application/atom+xml" rel="alternate" title="Matt Morehouse Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no"/>

<!-- For all browsers -->
<link rel="stylesheet" href="https://morehouse.github.io/assets/css/main.css">
<link rel="stylesheet" href="https://morehouse.github.io/assets/css/jquery.mmenu.all.css">
<link rel="stylesheet" href="https://morehouse.github.io/assets/css/jquery.floating-social-share.min.css">
<!-- Webfonts -->
<link href="//fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script type="text/javascript" src="https://morehouse.github.io/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="https://morehouse.github.io/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="https://morehouse.github.io/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="https://morehouse.github.io/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://morehouse.github.io/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://morehouse.github.io/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://morehouse.github.io/images/apple-touch-icon-144x144-precomposed.png">




</head>

<body id="post" class="feature">

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->



<div class="header-menu header-menu-top">
    <ul class="header-item-container">
      <li class="header-item-title header-toggle "><a href="#menu"><h2><i class="fa fa-bars"></i></h2></a></li>
      <li class="header-item-title">
        <a href="https://morehouse.github.io/">
          
            <img class="logo" src="https://morehouse.github.io/images/bitcoin_logo.png" alt="Matt Morehouse">
          
          <a href="https://morehouse.github.io/" class="title"> Matt Morehouse</a>
        </a>
      </li>
      
        
        

        
          <li class="header-item "><a href="https://github.com/morehouse" target="_blank"><h3 class="fa fa-github fa-fw"></h3></a></li>
        
      
        
        

        
            
                <li class="header-item "><a href="https://morehouse.github.io/donate"><h3>Donate</h3></a></li>
            
        
      
        
        

        
            
                <li class="header-item "><a href="https://morehouse.github.io/about"><h3>About</h3></a></li>
            
        
      
        
        

        
            
                <li class="header-item "><a href="https://morehouse.github.io/"><h3>Home</h3></a></li>
            
        
      
      <li class="header-item"><a href="https://morehouse.github.io/search"><h3><i class="fa fa-search"></i></h3></a></li>
    </ul>
  </div>
<div class="entry-header">
  <div class="header-title">
    <div class="header-title-wrap">
      <h1>DoS: LND Onion Bomb</h1>
      
        <h2><span class="entry-date date published updated"><time datetime="2024-06-18T00:00:00-05:00">June 18, 2024</time></span></h2>
      

      
          <p class="entry-reading-time">
            &nbsp;
          </p><!-- /.entry-reading-time -->
      
    </div><!-- /.header-title-wrap -->
  </div><!-- /.header-title -->
</div><!-- /.entry-header -->


<nav id="menu" style="display: none">
  <ul>
    
      
        <li><a href="https://morehouse.github.io/"><h3>Home</h3></a></li>
      
    
      
        <li><a href="https://morehouse.github.io/about"><h3>About</h3></a></li>
      
    
      
        <li><a href="https://morehouse.github.io/donate"><h3>Donate</h3></a></li>
      
    
      
        <li><a href="https://morehouse.github.iohttps://github.com/morehouse"><h3>GitHub</h3></a></li>
      
    
  </ul>
</nav>




<div id="main" role="main">
  <article class="hentry">
    <div class="entry-content">
        
            <div class="entry-image-index">
              <img src="https://morehouse.github.io/images/lnd_onion_bomb_header.png" alt="DoS: LND Onion Bomb">
              
            </div>
        
      <h1 class="post-title entry-title">DoS: LND Onion Bomb</h1>
      <p>LND versions prior to 0.17.0 are vulnerable to a DoS attack where malicious onion packets cause the node to instantly run out of memory (OOM) and crash.
If you are running an LND release older than this, your funds are at risk!
Update to at least <a href="https://github.com/lightningnetwork/lnd/releases/tag/v0.17.0-beta">0.17.0</a> to protect your node.</p>

<h1 id="severity">Severity</h1>

<p>It is critical that users update to at least LND 0.17.0 for several reasons.</p>

<ul>
  <li>The attack is cheap and easy to carry out and will keep the victim offline for as long as it lasts.</li>
  <li>The source of the attack is concealed via onion routing.  The attacker does not need to connect directly to the victim.</li>
  <li>Prior to LND 0.17.0, all nodes are vulnerable.  The fix was not backported to the LND 0.16.x series or earlier.</li>
</ul>

<h1 id="the-vulnerability">The Vulnerability</h1>

<p>The Lightning Network uses <a href="https://en.wikipedia.org/wiki/Onion_routing">onion routing</a> to provide senders and receivers of payments some degree of privacy.
Each node along a payment route receives an <em>onion packet</em> from the previous node, containing forwarding instructions for the next node on the route.
The onion packet is encrypted by the initiator of the payment, so that each node can only read its own forwarding instructions.</p>

<p>Once a node has “peeled off” its layer of encryption from the onion packet, it can extract its forwarding instructions according to the format <a href="https://github.com/lightning/bolts/blob/master/04-onion-routing.md#packet-structure">specified</a> in the LN protocol:</p>

<table rules="groups">
  <thead>
    <tr>
      <th style="text-align: left">Field Name</th>
      <th style="text-align: left">Size</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">length</code></td>
      <td style="text-align: left">1-9 bytes</td>
      <td style="text-align: left">The length of the <code class="language-plaintext highlighter-rouge">payload</code> field, encoded as <a href="https://github.com/lightning/bolts/blob/master/01-messaging.md#appendix-a-bigsize-test-vectors">BigSize</a>.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">payload</code></td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">length</code> bytes</td>
      <td style="text-align: left">The forwarding instructions.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">hmac</code></td>
      <td style="text-align: left">32 bytes</td>
      <td style="text-align: left">The HMAC to use for the forwarded onion packet.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">next_onion</code></td>
      <td style="text-align: left">remaining bytes</td>
      <td style="text-align: left">The onion packet to forward.</td>
    </tr>
  </tbody>
</table>

<p>Prior to LND 0.17.0, the <a href="https://github.com/lightningnetwork/lightning-onion/blob/ca23184850a16cd14d27619f3afdae543b3857a9/path.go#L231-L281">code</a> that extracts these instructions is essentially:</p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">// Decode unpacks an encoded HopPayload from the passed reader into the</span>
<span class="c">// target HopPayload.</span>
<span class="k">func</span> <span class="p">(</span><span class="n">hp</span> <span class="o">*</span><span class="n">HopPayload</span><span class="p">)</span> <span class="n">Decode</span><span class="p">(</span><span class="n">r</span> <span class="n">io</span><span class="o">.</span><span class="n">Reader</span><span class="p">)</span> <span class="kt">error</span> <span class="p">{</span>
    <span class="n">bufReader</span> <span class="o">:=</span> <span class="n">bufio</span><span class="o">.</span><span class="n">NewReader</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

    <span class="k">var</span> <span class="n">b</span> <span class="p">[</span><span class="m">8</span><span class="p">]</span><span class="kt">byte</span>
    <span class="n">varInt</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">ReadVarInt</span><span class="p">(</span><span class="n">bufReader</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">err</span>
    <span class="p">}</span>

    <span class="n">payloadSize</span> <span class="o">:=</span> <span class="kt">uint32</span><span class="p">(</span><span class="n">varInt</span><span class="p">)</span>

    <span class="c">// Now that we know the payload size, we'll create a new buffer to</span>
    <span class="c">// read it out in full.</span>
    <span class="n">hp</span><span class="o">.</span><span class="n">Payload</span> <span class="o">=</span> <span class="nb">make</span><span class="p">([]</span><span class="kt">byte</span><span class="p">,</span> <span class="n">payloadSize</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">_</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">io</span><span class="o">.</span><span class="n">ReadFull</span><span class="p">(</span><span class="n">bufReader</span><span class="p">,</span> <span class="n">hp</span><span class="o">.</span><span class="n">Payload</span><span class="p">[</span><span class="o">:</span><span class="p">]);</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">err</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="n">_</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">io</span><span class="o">.</span><span class="n">ReadFull</span><span class="p">(</span><span class="n">bufReader</span><span class="p">,</span> <span class="n">hp</span><span class="o">.</span><span class="n">HMAC</span><span class="p">[</span><span class="o">:</span><span class="p">]);</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">err</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="no">nil</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Note the absence of a bounds check on <code class="language-plaintext highlighter-rouge">payloadSize</code>!</p>

<p>Regardless of the actual payload size, <strong>LND allocates memory for whatever <code class="language-plaintext highlighter-rouge">length</code> is encoded in the onion packet up to <code class="language-plaintext highlighter-rouge">UINT32_MAX</code> (4 GB).</strong></p>

<h1 id="the-dos-attack">The DoS Attack</h1>

<p>It is trivial for an attacker to craft an onion packet that contains an encoded <code class="language-plaintext highlighter-rouge">length</code> of <code class="language-plaintext highlighter-rouge">UINT32_MAX</code> for the victim’s forwarding instructions.
If the victim’s node has less than 4 GB of memory available, it will OOM crash instantly upon receiving the attacker’s packet.</p>

<p>However, if the victim’s node has more than 4 GB of memory available, it is able to recover from the malicious packet.
The victim’s node will temporarily allocate 4 GB, but the Go garbage collector will quickly reclaim that memory after decoding fails.</p>

<p><em>So nodes with more than 4 GB of RAM are safe, right?</em></p>

<p>Not quite.
The attacker can send many malicious packets simultaneously.
If the victim processes enough malicious packets before the garbage collector kicks in, an OOM will still occur.
And since LND decodes onion packets <em>in parallel</em>, it is not difficult for an attacker to beat the garbage collector.
In my experiments I was able to consistently crash nodes with up to 128 GB of RAM in just a few seconds.</p>

<h1 id="the-fix">The Fix</h1>

<p>A bounds check on the encoded <code class="language-plaintext highlighter-rouge">length</code> field was concealed in a large refactoring <a href="https://github.com/lightningnetwork/lightning-onion/commit/6afc43f3fc983ae37685812de027d0747e136b8f">commit</a> and included in LND <a href="https://github.com/lightningnetwork/lnd/releases/tag/v0.17.0-beta">0.17.0</a>.
The fixed code is essentially:</p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">// Decode unpacks an encoded HopPayload from the passed reader into the</span>
<span class="c">// target HopPayload.</span>
<span class="k">func</span> <span class="p">(</span><span class="n">hp</span> <span class="o">*</span><span class="n">HopPayload</span><span class="p">)</span> <span class="n">Decode</span><span class="p">(</span><span class="n">r</span> <span class="n">io</span><span class="o">.</span><span class="n">Reader</span><span class="p">)</span> <span class="kt">error</span> <span class="p">{</span>
    <span class="n">bufReader</span> <span class="o">:=</span> <span class="n">bufio</span><span class="o">.</span><span class="n">NewReader</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

    <span class="n">payloadSize</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">tlvPayloadSize</span><span class="p">(</span><span class="n">bufReader</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">err</span>
    <span class="p">}</span>

    <span class="c">// Now that we know the payload size, we'll create a new buffer to</span>
    <span class="c">// read it out in full.</span>
    <span class="n">hp</span><span class="o">.</span><span class="n">Payload</span> <span class="o">=</span> <span class="nb">make</span><span class="p">([]</span><span class="kt">byte</span><span class="p">,</span> <span class="n">payloadSize</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">_</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">io</span><span class="o">.</span><span class="n">ReadFull</span><span class="p">(</span><span class="n">bufReader</span><span class="p">,</span> <span class="n">hp</span><span class="o">.</span><span class="n">Payload</span><span class="p">[</span><span class="o">:</span><span class="p">]);</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">err</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="n">_</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">io</span><span class="o">.</span><span class="n">ReadFull</span><span class="p">(</span><span class="n">bufReader</span><span class="p">,</span> <span class="n">hp</span><span class="o">.</span><span class="n">HMAC</span><span class="p">[</span><span class="o">:</span><span class="p">]);</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">err</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="no">nil</span>
<span class="p">}</span>

<span class="c">// tlvPayloadSize uses the passed reader to extract the payload length</span>
<span class="c">// encoded as a var-int.</span>
<span class="k">func</span> <span class="n">tlvPayloadSize</span><span class="p">(</span><span class="n">r</span> <span class="n">io</span><span class="o">.</span><span class="n">Reader</span><span class="p">)</span> <span class="p">(</span><span class="kt">uint16</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">var</span> <span class="n">b</span> <span class="p">[</span><span class="m">8</span><span class="p">]</span><span class="kt">byte</span>
    <span class="n">varInt</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">ReadVarInt</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="k">return</span> <span class="m">0</span><span class="p">,</span> <span class="n">err</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">varInt</span> <span class="o">&gt;</span> <span class="n">math</span><span class="o">.</span><span class="n">MaxUint16</span> <span class="p">{</span>
        <span class="k">return</span> <span class="m">0</span><span class="p">,</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Errorf</span><span class="p">(</span><span class="s">"payload size of %d is larger than the "</span><span class="o">+</span>
            <span class="s">"maximum allowed size of %d"</span><span class="p">,</span> <span class="n">varInt</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">MaxUint16</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="kt">uint16</span><span class="p">(</span><span class="n">varInt</span><span class="p">),</span> <span class="no">nil</span>
<span class="p">}</span>
</code></pre></div></div>

<p>This new code reduces the maximum amount of memory LND will allocate when decoding an onion packet from 4 GB to 64 KB, which is enough to fully mitigate the DoS attack.</p>

<h1 id="discovery">Discovery</h1>

<p>A simple <a href="https://github.com/lightningnetwork/lnd/commit/9c51bea7906060bbf7b8dc23cab7d542a610eb10">fuzz test</a> for onion packet encoding and decoding revealed this vulnerability.</p>

<h2 id="timeline">Timeline</h2>

<ul>
  <li><strong>2023-06-20:</strong> Vulnerability discovered and disclosed to Lightning Labs.</li>
  <li><strong>2023-08-23:</strong> Fix <a href="https://github.com/lightningnetwork/lightning-onion/pull/57">merged</a>.</li>
  <li><strong>2023-10-03:</strong> LND 0.17.0 released containing the fix.</li>
  <li><strong>2024-05-16:</strong> Laolu gives the OK to disclose publicly once LND 0.18.0 is released and has some uptake.</li>
  <li><strong>2024-05-30:</strong> LND 0.18.0 released.</li>
  <li><strong>2024-06-18:</strong> Public disclosure.</li>
</ul>

<h1 id="prevention">Prevention</h1>

<p>This vulnerability was found in less than a minute of fuzz testing.
If basic fuzz tests had been written at the time the original onion decoding functions were introduced, the bug would have been caught before it was merged.</p>

<p>In general any function that processes untrusted inputs is a strong candidate for fuzz testing, and often these fuzz tests are <em>easier</em> to write than traditional unit tests.
A minimal fuzz test that detects this particular vulnerability is exceedingly simple:</p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">func</span> <span class="n">FuzzHopPayload</span><span class="p">(</span><span class="n">f</span> <span class="o">*</span><span class="n">testing</span><span class="o">.</span><span class="n">F</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">f</span><span class="o">.</span><span class="n">Fuzz</span><span class="p">(</span><span class="k">func</span><span class="p">(</span><span class="n">t</span> <span class="o">*</span><span class="n">testing</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">data</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">)</span> <span class="p">{</span>
        <span class="c">// Hop payloads larger than 1300 bytes violate the spec and never</span>
        <span class="c">// reach the decoding step in practice.</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&gt;</span> <span class="m">1300</span> <span class="p">{</span>
            <span class="k">return</span>
        <span class="p">}</span>

        <span class="k">var</span> <span class="n">hopPayload</span> <span class="n">sphinx</span><span class="o">.</span><span class="n">HopPayload</span>
        <span class="n">hopPayload</span><span class="o">.</span><span class="n">Decode</span><span class="p">(</span><span class="n">bytes</span><span class="o">.</span><span class="n">NewReader</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
    <span class="p">})</span>
<span class="p">}</span>
</code></pre></div></div>

<h1 id="takeaways">Takeaways</h1>

<ul>
  <li>Write fuzz tests for all APIs that consume untrusted inputs.</li>
  <li>Update your LND nodes to at least 0.17.0.</li>
</ul>

      <footer class="entry-meta">
        <span class="entry-tags"><a href="https://morehouse.github.io/tags#lightning" title="Pages tagged lightning" class="tag"><span class="term">lightning</span></a><a href="https://morehouse.github.io/tags#security" title="Pages tagged security" class="tag"><span class="term">security</span></a><a href="https://morehouse.github.io/tags#dos" title="Pages tagged dos" class="tag"><span class="term">dos</span></a><a href="https://morehouse.github.io/tags#lnd" title="Pages tagged lnd" class="tag"><span class="term">lnd</span></a></span>
        <span>Updated on <span class="entry-date date updated"><time datetime="2024-06-18">June 18, 2024</time></span></span>
        
        <span class="author vcard"><span class="fn">Matt Morehouse</span></span>
        <div class="social-share">
  <ul class="socialcount socialcount-small inline-list">
    <li class="facebook"><a href="https://www.facebook.com/sharer/sharer.php?u=https://morehouse.github.io/lightning/lnd-onion-bomb/" title="Share on Facebook"><span class="count"><i class="fa fa-facebook-square"></i> Like</span></a></li>
    <li class="twitter"><a href="https://twitter.com/intent/tweet?text=https://morehouse.github.io/lightning/lnd-onion-bomb/" title="Share on Twitter"><span class="count"><i class="fa fa-twitter-square"></i> Tweet</span></a></li>
  </ul>
</div><!-- /.social-share -->

      </footer>
    </div><!-- /.entry-content -->
    <div class="read-more">
  <div class="read-more-header">
    <a href="https://morehouse.github.io" class="read-more-btn">About the Author</a>
  </div><!-- /.read-more-header -->
  <div class="read-more-content author-info">
    <h3>Matt Morehouse</h3>
    <div class="author-container">
      <img class="author-img" src="https://morehouse.github.io/images/avatar.png" alt="Matt Morehouse" />
      <div class="author-bio">Software engineer working to improve the security and stability of the Bitcoin Lightning Network.</div>
    </div>
    <div class="author-share">
      <!--ul class="list-inline social-buttons">
        
          <li><a href="https://github.com/morehouse" target="_blank"><i class="fa fa-github fa-fw"></i></a></li>
        
      </ul-->
      
        <a aria-label="Follow @morehouse on GitHub" data-style="mega" href="https://github.com/morehouse" class="github-button">Follow @morehouse</a>
      
      <br>
      
    </div>
  </div>
</div>

    
    <div class="read-more">
  
    <div class="read-more-header">
      <a href="https://morehouse.github.io/lightning/cln-channel-open-race/" class="read-more-btn">Read More</a>
    </div><!-- /.read-more-header -->
    <div class="read-more-content">
      <h3><a href="https://morehouse.github.io/lightning/cln-channel-open-race/" title="DoS: Channel Open Race in CLN">DoS: Channel Open Race in CLN</a></h3>
      <p>Discussion of a race condition in CLN that can be exploited for DoS <a href="https://morehouse.github.io/lightning/cln-channel-open-race/">Continue reading</a></p>
    </div><!-- /.read-more-content -->
  
  <div class="read-more-list">
    
      <div class="list-item">
        <h4><a href="https://morehouse.github.io/lightning/cln-invoice-parsing/" title="Invoice Parsing Bugs in CLN">Invoice Parsing Bugs in CLN</a></h4>
        <span>Published on December 08, 2023</span>
      </div><!-- /.list-item -->
    
      <div class="list-item">
        <h4><a href="https://morehouse.github.io/lightning/fake-channel-dos/" title="DoS: Fake Lightning Channels">DoS: Fake Lightning Channels</a></h4>
        <span>Published on August 23, 2023</span>
      </div><!-- /.list-item -->
    
  </div><!-- /.read-more-list -->
</div><!-- /.read-more -->
  </article>
</div><!-- /#main -->

<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript">window.jQuery || document.write('<script type="text/javascript" src="https://morehouse.github.io/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script type="text/javascript" src="https://morehouse.github.io/assets/js/scripts.min.js"></script>
<script type="text/javascript" async defer id="github-bjs" src="https://buttons.github.io/buttons.js"></script>
<script type="text/javascript">!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>










<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2024 Matt Morehouse. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using the <a href="http://github.com/aron-bordin/neo-hpstr-jekyll-theme" rel="nofollow">Neo-HPSTR Theme</a>.</span>

  </footer>
</div><!-- /.footer-wrapper -->

</body>
</html>
