```
{
  "cve": "CVE-2024-27417",
  "related_content": [
    {
      "description": "The provided content describes a vulnerability in the Linux kernel's IPv6 implementation, specifically in the `inet6_rtm_getaddr` function. This function is used to retrieve IPv6 address information via netlink messages. The vulnerability arises when a user-space program provides a `IFA_TARGET_NETNSID` attribute, but omits the `IFA_ADDRESS` and `IFA_LOCAL` attributes. This scenario leads to `inet6_rtm_getaddr` returning -EINVAL, but with an increased reference count for the `struct net` object, which can lead to a memory leak. This patch addresses the leak by ensuring proper cleanup with a goto statement.",
      "vulnerability_details": {
        "root_cause": "The vulnerability is caused by the `inet6_rtm_getaddr` function not properly handling the case where a user-space program specifies `IFA_TARGET_NETNSID` but omits `IFA_ADDRESS` and `IFA_LOCAL`, resulting in a `struct net` refcount leak.",
        "weaknesses": [
          "Memory leak due to incorrect refcount management."
        ],
        "impact": "The memory leak could eventually cause the system to run out of memory and result in a denial of service.",
        "attack_vectors": "A local user can trigger the vulnerability by sending a specially crafted netlink message to the kernel that requests address information using the `RTM_GETADDR` command, including `IFA_TARGET_NETNSID` but omitting `IFA_ADDRESS` and `IFA_LOCAL` attributes.",
        "required_capabilities": "The attacker needs to be a local user able to send netlink messages."
      },
       "affected_code": "net/ipv6/addrconf.c"
    }
  ],
  "summary": "The Linux kernel's `inet6_rtm_getaddr` function was leaking `struct net` refcount when `IFA_TARGET_NETNSID` was provided without `IFA_ADDRESS` and `IFA_LOCAL` attributes. This has been addressed by using a goto statement to ensure proper cleanup."
}
```