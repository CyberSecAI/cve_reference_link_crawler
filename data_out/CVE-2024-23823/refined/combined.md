=== Content from github.com_8b9dbd5d_20250110_132619.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fvantage6%2Fvantage6%2Fsecurity%2Fadvisories%2FGHSA-4946-85pr-fvxh)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fvantage6%2Fvantage6%2Fsecurity%2Fadvisories%2FGHSA-4946-85pr-fvxh)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=vantage6%2Fvantage6)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[vantage6](/vantage6)
/
**[vantage6](/vantage6/vantage6)**
Public

* [Notifications](/login?return_to=%2Fvantage6%2Fvantage6) You must be signed in to change notification settings
* [Fork
  11](/login?return_to=%2Fvantage6%2Fvantage6)
* [Star
   31](/login?return_to=%2Fvantage6%2Fvantage6)

* [Code](/vantage6/vantage6)
* [Issues
  239](/vantage6/vantage6/issues)
* [Pull requests
  9](/vantage6/vantage6/pulls)
* [Actions](/vantage6/vantage6/actions)
* [Projects
  2](/vantage6/vantage6/projects)
* [Security](/vantage6/vantage6/security)
* [Insights](/vantage6/vantage6/pulse)

Additional navigation options

* [Code](/vantage6/vantage6)
* [Issues](/vantage6/vantage6/issues)
* [Pull requests](/vantage6/vantage6/pulls)
* [Actions](/vantage6/vantage6/actions)
* [Projects](/vantage6/vantage6/projects)
* [Security](/vantage6/vantage6/security)
* [Insights](/vantage6/vantage6/pulse)

# CORS settings overly permissive

Low

[bartvanb](/bartvanb)
published
GHSA-4946-85pr-fvxh
Mar 14, 2024

## Package

pip

vantage6
([pip](/advisories?query=ecosystem%3Apip))

## Affected versions

< 4.2.1

## Patched versions

None

## Description

### Impact

The vantage6 server has no restrictions on CORS settings. It should be possible for people to set the allowed origins of the server.

The impact is limited because v6 does not use session cookies

### Patches

No

### Workarounds

No

### Severity

Low

### CVE ID

CVE-2024-23823

### Weaknesses

[CWE-942](/advisories?query=cwe%3A942)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_7e0fdc16_20250110_132618.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fvantage6%2Fvantage6%2Fcommit%2F70bb4e1d889230a841eb364d6c03accd7dd01a41)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fvantage6%2Fvantage6%2Fcommit%2F70bb4e1d889230a841eb364d6c03accd7dd01a41)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=vantage6%2Fvantage6)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[vantage6](/vantage6)
/
**[vantage6](/vantage6/vantage6)**
Public

* [Notifications](/login?return_to=%2Fvantage6%2Fvantage6) You must be signed in to change notification settings
* [Fork
  11](/login?return_to=%2Fvantage6%2Fvantage6)
* [Star
   31](/login?return_to=%2Fvantage6%2Fvantage6)

* [Code](/vantage6/vantage6)
* [Issues
  239](/vantage6/vantage6/issues)
* [Pull requests
  9](/vantage6/vantage6/pulls)
* [Actions](/vantage6/vantage6/actions)
* [Projects
  2](/vantage6/vantage6/projects)
* [Security](/vantage6/vantage6/security)
* [Insights](/vantage6/vantage6/pulse)

Additional navigation options

* [Code](/vantage6/vantage6)
* [Issues](/vantage6/vantage6/issues)
* [Pull requests](/vantage6/vantage6/pulls)
* [Actions](/vantage6/vantage6/actions)
* [Projects](/vantage6/vantage6/projects)
* [Security](/vantage6/vantage6/security)
* [Insights](/vantage6/vantage6/pulse)

## Commit

[Permalink](/vantage6/vantage6/commit/70bb4e1d889230a841eb364d6c03accd7dd01a41)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-4946-85pr-fvxh](https://github.com/advisories/GHSA-4946-85pr-fvxh "GHSA-4946-85pr-fvxh")

[Browse files](/vantage6/vantage6/tree/70bb4e1d889230a841eb364d6c03accd7dd01a41)
Browse the repository at this point in the history

```
Implement server configuration option to specification of allowed CORS origins
```

* Loading branch information

[![@bartvanb](https://avatars.githubusercontent.com/u/10533678?s=40&v=4)](/bartvanb)

[bartvanb](/vantage6/vantage6/commits?author=bartvanb "View all commits by bartvanb")
authored
Mar 7, 2024

2 parents
[a6de8bb](/vantage6/vantage6/commit/a6de8bbff10bd38f630a8b346de86476ae3d8244)
+
[1bf1603](/vantage6/vantage6/commit/1bf1603c223bb799637695d269d5f2e4431c60e6)

commit 70bb4e1

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**59 additions**
and
**15 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* docs/server/yaml

  + docs/server/yaml/server\_config.yaml
    [server\_config.yaml](#diff-c5720e32f3f4181a3aabed389bbf49df0e0477ca51469a18605a9f06577d5d08)
* vantage6-server/vantage6/server

  + vantage6-server/vantage6/server/\_\_init\_\_.py
    [\_\_init\_\_.py](#diff-4014e6578e3d972b74bc3a6e5536ad94de12cd089f917fa5c05d43d075790bd6)

## There are no files selected for viewing

26 changes: 16 additions & 10 deletions

26
[docs/server/yaml/server\_config.yaml](#diff-c5720e32f3f4181a3aabed389bbf49df0e0477ca51469a18605a9f06577d5d08 "docs/server/yaml/server_config.yaml")

Show comments

[View file](/vantage6/vantage6/blob/70bb4e1d889230a841eb364d6c03accd7dd01a41/docs/server/yaml/server_config.yaml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -43,29 +43,28 @@ jwt\_secret\_key: super-secret-key! # recommended but optional |
|  |  |  |
|  |  | # Settings for the logger |
|  |  | logging: |
|  |  |  |
|  |  | # Controls the logging output level. Could be one of the following |
|  |  | # levels: CRITICAL, ERROR, WARNING, INFO, DEBUG, NOTSET |
|  |  | level:  DEBUG |
|  |  | level: DEBUG |
|  |  |  |
|  |  | # Filename of the log-file, used by RotatingFileHandler |
|  |  | file:  test.log |
|  |  | file: test.log |
|  |  |  |
|  |  | # Whether the output is shown in the console or not |
|  |  | use\_console:  True |
|  |  | use\_console: True |
|  |  |  |
|  |  | # The number of log files that are kept, used by RotatingFileHandler |
|  |  | backup\_count: 5 |
|  |  |  |
|  |  | # Size in kB of a single log file, used by RotatingFileHandler |
|  |  | max\_size:  1024 |
|  |  | max\_size: 1024 |
|  |  |  |
|  |  | # format: input for logging.Formatter, |
|  |  | format:  "%(asctime)s - %(name)-14s - %(levelname)-8s - %(message)s" |
|  |  | datefmt:  "%Y-%m-%d %H:%M:%S" |
|  |  | format: "%(asctime)s - %(name)-14s - %(levelname)-8s - %(message)s" |
|  |  | datefmt: "%Y-%m-%d %H:%M:%S" |
|  |  |  |
|  |  | # (optional) set the individual log levels per logger name, for example |
|  |  | # mute some loggers that are too verbose. |
|  |  | # (optional) set the individual log levels per logger name, for example |
|  |  | # mute some loggers that are too verbose. |
|  |  | loggers: |
|  |  | - name: urllib3 |
|  |  | level: warning |
| Expand All | | @@ -82,7 +81,6 @@ logging: |
|  |  |  |
|  |  | # Additional debug flags |
|  |  | debug: |
|  |  |  |
|  |  | # Set to `true` to enable debug mode for the socketio server |
|  |  | socketio: false |
|  |  |  |
| Expand Down  Expand Up | | @@ -171,3 +169,11 @@ password\_policy: |
|  |  | # number of minutes to wait between emails that alert a user that someone is |
|  |  | # trying to log in to their account. Default is 60. |
|  |  | between\_email\_blocked\_login\_minutes: 60 |
|  |  |  |
|  |  | # set up with which origins the server should allow CORS requests. The default |
|  |  | # is to allow all origins. If you want to restrict this, you can specify a list |
|  |  | # of origins here. Below are examples to allow requests from the Cotopaxi UI, and |
|  |  | # port 3456 on localhost |
|  |  | cors\_allowed\_origins: |
|  |  | - https://portal.cotopaxi.vantage6.ai |
|  |  | - http://localhost:3456 |

48 changes: 43 additions & 5 deletions

48
[vantage6-server/vantage6/server/\_\_init\_\_.py](#diff-4014e6578e3d972b74bc3a6e5536ad94de12cd089f917fa5c05d43d075790bd6 "vantage6-server/vantage6/server/__init__.py")

Show comments

[View file](/vantage6/vantage6/blob/70bb4e1d889230a841eb364d6c03accd7dd01a41/vantage6-server/vantage6/server/__init__.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -5,6 +5,7 @@ |
|  |  | through the API the server hosts. Finally, it also communicates with |
|  |  | authenticated nodes and users via the socketIO server that is run here. |
|  |  | """ |
|  |  |  |
|  |  | # -\*- coding: utf-8 -\*- |
|  |  | import os |
|  |  | from gevent import monkey |
| Expand Down  Expand Up | | @@ -35,6 +36,7 @@ |
|  |  | Response, |
|  |  | ) |
|  |  | from flask\_cors import CORS |
|  |  | from flask\_cors.core import probably\_regex |
|  |  | from flask\_jwt\_extended import JWTManager |
|  |  | from flask\_marshmallow import Marshmallow |
|  |  | from flask\_restful import Api |
| Expand Down  Expand Up | | @@ -108,8 +110,14 @@ def \_\_init\_\_(self, ctx: ServerContext) -> None: |
|  |  | # Setup Principal, granular API access manegement |
|  |  | self.principal = Principal(self.app, use\_sessions=False) |
|  |  |  |
|  |  | # Enable cross-origin resource sharing |
|  |  | self.cors = CORS(self.app) |
|  |  | # Enable cross-origin resource sharing. Note that Flask-CORS interprets |
|  |  | # the origins as regular expressions. |
|  |  | cors\_allowed\_origins = self.ctx.config.get("cors\_allowed\_origins", "\*") |
|  |  | self.\_warn\_if\_cors\_regex(cors\_allowed\_origins) |
|  |  | self.cors = CORS( |
|  |  | self.app, |
|  |  | resources={r"/\*": {"origins": cors\_allowed\_origins}}, |
|  |  | ) |
|  |  |  |
|  |  | # SWAGGER documentation |
|  |  | self.swagger = Swagger(self.app, template=swagger\_template) |
| Expand Down  Expand Up | | @@ -138,6 +146,35 @@ def \_\_init\_\_(self, ctx: ServerContext) -> None: |
|  |  |  |
|  |  | log.info("Initialization done") |
|  |  |  |
|  |  | @staticmethod |
|  |  | def \_warn\_if\_cors\_regex(origins: str | list[str]) -> None: |
|  |  | """ |
|  |  | Give a warning if CORS origins are regular expressions. This will not work |
|  |  | properly for socket events (Flask-SocketIO checks for string equality and does |
|  |  | not use regex). |
|  |  |  |
|  |  | Note that we are using the `probably\_regex` function from Flask-CORS to check |
|  |  | if the origins are probably regular expressions - the Flask implementation for |
|  |  | determining if it is a regex is a bit hacky (see |
|  |  | https://github.com/corydolphin/flask-cors/blob/3.0.10/flask\_cors/core.py#L275-L285) |
|  |  | and Flask-CORS doesn't currently offer an opt out of regex's altogether. |
|  |  |  |
|  |  | Parameters |
|  |  | ---------- |
|  |  | origins: str | list[str] |
|  |  | The origins to check |
|  |  | """ |
|  |  | if isinstance(origins, str): |
|  |  | origins = [origins] |
|  |  |  |
|  |  | for origin in origins: |
|  |  | if probably\_regex(origin): |
|  |  | log.warning( |
|  |  | "CORS origin '%s' is a regular expression. Socket events sent from " |
|  |  | "this origin will not be handled properly.", |
|  |  | origin, |
|  |  | ) |
|  |  |  |
|  |  | def setup\_socket\_connection(self) -> SocketIO: |
|  |  | """ |
|  |  | Setup a socket connection. If a message queue is defined, connect the |
| Expand All | | @@ -149,21 +186,22 @@ def setup\_socket\_connection(self) -> SocketIO: |
|  |  | SocketIO |
|  |  | SocketIO object |
|  |  | """ |
|  |  |  |
|  |  | msg\_queue = self.ctx.config.get("rabbitmq", {}).get("uri") |
|  |  | if msg\_queue: |
|  |  | log.debug(f"Connecting to msg queue: {msg\_queue}") |
|  |  |  |
|  |  | debug\_mode = self.debug.get("socketio", False) |
|  |  | if debug\_mode: |
|  |  | log.debug("SocketIO debug mode enabled") |
|  |  |  |
|  |  | cors\_settings = self.ctx.config.get("cors\_allowed\_origins", "\*") |
|  |  | try: |
|  |  | socketio = SocketIO( |
|  |  | self.app, |
|  |  | async\_mode="gevent\_uwsgi", |
|  |  | message\_queue=msg\_queue, |
|  |  | ping\_timeout=60, |
|  |  | cors\_allowed\_origins="\*", |
|  |  | cors\_allowed\_origins=cors\_settings, |
|  |  | logger=debug\_mode, |
|  |  | engineio\_logger=debug\_mode, |
|  |  | ) |
| Expand All | | @@ -179,7 +217,7 @@ def setup\_socket\_connection(self) -> SocketIO: |
|  |  | self.app, |
|  |  | message\_queue=msg\_queue, |
|  |  | ping\_timeout=60, |
|  |  | cors\_allowed\_origins="\*", |
|  |  | cors\_allowed\_origins=cors\_settings, |
|  |  | logger=debug\_mode, |
|  |  | engineio\_logger=debug\_mode, |
|  |  | ) |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `70bb4e1`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fvantage6%2Fvantage6%2Fcommit%2F70bb4e1d889230a841eb364d6c03accd7dd01a41) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


